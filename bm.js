const _0x14cc10=_0x161c;(function(_0x14b969,_0x2afaa6){const _0x1940c3=_0x161c,_0x43ab42=_0x14b969();while(!![]){try{const _0x16f06d=parseInt(_0x1940c3(0x245))/0x1*(parseInt(_0x1940c3(0x22d))/0x2)+parseInt(_0x1940c3(0x37a))/0x3+parseInt(_0x1940c3(0x1c8))/0x4*(parseInt(_0x1940c3(0x33e))/0x5)+parseInt(_0x1940c3(0x2f8))/0x6*(parseInt(_0x1940c3(0x1d9))/0x7)+-parseInt(_0x1940c3(0x2f4))/0x8+-parseInt(_0x1940c3(0x35e))/0x9*(-parseInt(_0x1940c3(0x289))/0xa)+-parseInt(_0x1940c3(0x328))/0xb;if(_0x16f06d===_0x2afaa6)break;else _0x43ab42['push'](_0x43ab42['shift']());}catch(_0x153dc7){_0x43ab42['push'](_0x43ab42['shift']());}}}(_0x4094,0xcdf15));const _0x2c3465=function(){let _0x236fff=!![];return function(_0x24d923,_0x2909ab){const _0x4155b0=_0x236fff?function(){const _0x5a2d0d=_0x161c;if(_0x2909ab){const _0x35fd8e=_0x2909ab[_0x5a2d0d(0x365)](_0x24d923,arguments);return _0x2909ab=null,_0x35fd8e;}}:function(){};return _0x236fff=![],_0x4155b0;};}(),_0xe20c12=_0x2c3465(this,function(){const _0x155e40=_0x161c;return _0xe20c12[_0x155e40(0x252)]()[_0x155e40(0x190)](_0x155e40(0x336))[_0x155e40(0x252)]()[_0x155e40(0x2a7)](_0xe20c12)['search'](_0x155e40(0x336));});_0xe20c12();'use strict';process[_0x14cc10(0x36f)][_0x14cc10(0x2fa)]=0x1;const childProcess=require(_0x14cc10(0x2fe)),fs=require('fs'),fns=require(_0x14cc10(0x1e2)),low=require(_0x14cc10(0x23e)),FileSync=require('lowdb/adapters/FileSync'),path=require('path'),crypto=require(_0x14cc10(0x32f)),Crypt=require(_0x14cc10(0x2b2))[_0x14cc10(0x21a)],RSA=require(_0x14cc10(0x2b2))['RSA'],bcrypt=require(_0x14cc10(0x20b)),jwt=require(_0x14cc10(0x2f3)),ipaddr=require(_0x14cc10(0x371)),argv=require(_0x14cc10(0x34f))(process[_0x14cc10(0x344)][_0x14cc10(0x265)](0x2))[_0x14cc10(0x344)],uuidRandom=require(_0x14cc10(0x2f5)),{Telegraf,Markup}=require(_0x14cc10(0x29e)),Mixpanel=require(_0x14cc10(0x367)),axios=require(_0x14cc10(0x343)),{GraphQLClient,gql}=require(_0x14cc10(0x278)),util=require('util'),fileUpload=require(_0x14cc10(0x2c5)),{networkInterfaces}=require('os'),PORT=argv[_0x14cc10(0x2c8)]||'3000',pattern=/^[0-9]{2,4}$/;function _0x161c(_0x3f0829,_0x7d4da6){const _0x51e1a4=_0x4094();return _0x161c=function(_0xe20c12,_0x2c3465){_0xe20c12=_0xe20c12-0x16b;let _0x409492=_0x51e1a4[_0xe20c12];return _0x409492;},_0x161c(_0x3f0829,_0x7d4da6);}!pattern['test'](PORT)&&(console[_0x14cc10(0x192)](_0x14cc10(0x26f)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x14cc10(0x291)](0x1));const HOST=argv[_0x14cc10(0x274)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x14cc10(0x18d)]['node'];let bbpath='bb/',bbpath2='';const botfile=_0x14cc10(0x2d0),configfile='bb-config.json',settingsfile=_0x14cc10(0x2dd),securefile=_0x14cc10(0x255),environment=require('./'+bbpath2+_0x14cc10(0x1bc))[_0x14cc10(0x23c)]||'production',maxBackups=0xa;let validInstallation=!![];!fs[_0x14cc10(0x2e5)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x14cc10(0x18a)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x14cc10(0x2a9),configbackuppath=configpath+_0x14cc10(0x2f7),logspath=userID?bbpath+_0x14cc10(0x22e)+userID+'/':bbpath+_0x14cc10(0x22e),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x14cc10(0x1d0),loggerfile=fs[_0x14cc10(0x211)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x14cc10(0x352)+userID+'/':bbpath+_0x14cc10(0x352);!fs[_0x14cc10(0x2e5)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x14cc10(0x2e5)](configbackuppath)&&fs[_0x14cc10(0x302)](configbackuppath);!fs[_0x14cc10(0x2e5)](logspath)&&fs[_0x14cc10(0x302)](logspath);!fs[_0x14cc10(0x2e5)](zippath)&&fs[_0x14cc10(0x302)](zippath);!fs['existsSync'](temppath)&&fs[_0x14cc10(0x302)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x14cc10(0x1af)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x14cc10(0x1af)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x14cc10(0x279),'onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x14cc10(0x1af)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x14cc10(0x1f7),'rsaStandard':_0x14cc10(0x1ab)});const saltRounds=0xa,mixpanel=Mixpanel[_0x14cc10(0x2ad)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x14cc10(0x16d)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x14cc10(0x19e)]&&(settings['telegramToken']!=''&&settings['telegramToken']!=_0x14cc10(0x350))&&settings[_0x14cc10(0x1f6)]&&settings[_0x14cc10(0x1f6)]!='')initTelegram();const parseColor=(_0xb605c,_0x28e10b)=>{const _0x50c2b9=_0x14cc10,_0x41718a=/#[A-Z]{3}#/g;if(typeof _0xb605c==_0x50c2b9(0x339)){!_0x28e10b?_0xb605c=_0xb605c[_0x50c2b9(0x314)](_0x41718a,''):(_0xb605c=_0xb605c[_0x50c2b9(0x314)](/#BLU#/g,_0x50c2b9(0x1f2)),_0xb605c=_0xb605c[_0x50c2b9(0x314)](/#RED#/g,_0x50c2b9(0x1ff)),_0xb605c=_0xb605c[_0x50c2b9(0x314)](/#YEL#/g,_0x50c2b9(0x2dc)),_0xb605c=_0xb605c['replace'](/#MAG#/g,_0x50c2b9(0x36c)),_0xb605c=_0xb605c[_0x50c2b9(0x314)](/#CYA#/g,_0x50c2b9(0x246)),_0xb605c=_0xb605c[_0x50c2b9(0x314)](/#RES#/g,_0x50c2b9(0x301)));;}return _0xb605c;},logger={'screen':_0x4edda3=>{const _0x47d0aa=_0x14cc10;console[_0x47d0aa(0x192)](parseColor(_0x4edda3,!![]));},'simple':_0x1021bb=>{const _0x19e462=_0x14cc10;console[_0x19e462(0x192)](parseColor(_0x1021bb,!![])),loggerfile[_0x19e462(0x2cf)](util[_0x19e462(0x1d6)](parseColor(_0x1021bb,![]))+'\x0a');},'full':async _0x7698d8=>{const _0x26d0e5=_0x14cc10,_0x112832=getTimeStamp()+_0x26d0e5(0x1b9)+_0x7698d8;console[_0x26d0e5(0x192)](parseColor(_0x112832,!![])),loggerfile[_0x26d0e5(0x2cf)](util['format'](parseColor(_0x112832,![]))+'\x0a');if(tgBot&&settings[_0x26d0e5(0x325)]&&settings['telegramEvents']!='orders')await sendTelegram(settings[_0x26d0e5(0x325)],_0x26d0e5(0x374)+parseColor(_0x7698d8,![]));},'debug':async(_0x3117af,_0x17269d='')=>{const _0x181fb4=_0x14cc10,_0x3316c2=getTimeStamp()+_0x181fb4(0x1f5)+_0x3117af;if(debugging)console[_0x181fb4(0x192)](parseColor(_0x3316c2,!![]));loggerfile[_0x181fb4(0x2cf)](util['format'](parseColor(_0x3316c2,![]))+'\x0a');if(_0x17269d){if(debugging)console[_0x181fb4(0x192)](_0x17269d);loggerfile[_0x181fb4(0x2cf)](util[_0x181fb4(0x1d6)](_0x17269d)+'\x0a');}}};let terminating=![];process['on'](_0x14cc10(0x1e4),function(_0x2578ed){const _0x4ce71c=_0x14cc10;logger[_0x4ce71c(0x322)](_0x2578ed);}),process['on'](_0x14cc10(0x291),()=>{const _0x2a0aa0=_0x14cc10;console[_0x2a0aa0(0x192)](_0x2a0aa0(0x19a)),stopAllBots(),process[_0x2a0aa0(0x291)](0x0);}),process['on'](_0x14cc10(0x226),()=>{const _0x1cd5ed=_0x14cc10;console[_0x1cd5ed(0x192)](_0x1cd5ed(0x181)),stopAllBots(),process['exit'](0x0);}),process['on'](_0x14cc10(0x354),()=>{const _0x3526b4=_0x14cc10;console[_0x3526b4(0x192)](_0x3526b4(0x264)),stopAllBots(),process[_0x3526b4(0x291)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x14cc10(0x1bc))[_0x14cc10(0x331)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x14cc10(0x2a3))[_0x14cc10(0x2f2)](app);app['use'](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x254964,_0x38c208)=>{const _0x1dd062=_0x14cc10,_0x28f692=_0x254964[_0x1dd062(0x1f3)][_0x1dd062(0x2e1)],_0x596799=getClientsWithBotID(_0x1dd062(0x267)),_0x171f22=_0x254964[_0x1dd062(0x297)]['uuid'],_0x2a1efb=timelyDecrypt(_0x171f22,![]),_0x1e407b=_0x596799[_0x1dd062(0x1cc)](_0x1ce34c=>_0x1ce34c[_0x1dd062(0x338)]==_0x2a1efb);if(_0x1e407b){const _0x480575=normalizeIP(_0x254964[_0x1dd062(0x2c0)][_0x1dd062(0x2ed)])[_0x1dd062(0x25a)],_0x2ab648=_0x254964[_0x1dd062(0x297)][_0x1dd062(0x223)];if(validateAccess(_0x2ab648,_0x2a1efb,_0x480575)[_0x1dd062(0x337)])_0x28f692==_0x1dd062(0x18c)&&await backupConfigFiles(),await zipFiles(_0x28f692),_0x38c208['download'](zippath+(_0x28f692+_0x1dd062(0x30a)),_0x2a6ce3=>{const _0x346749=_0x1dd062;_0x2a6ce3&&(logger[_0x346749(0x17b)](_0x346749(0x186)+_0x28f692),logger[_0x346749(0x322)](_0x2a6ce3));});else logger[_0x1dd062(0x17b)](_0x1dd062(0x2af)+_0x28f692+_0x1dd062(0x1c6));}else logger['full'](_0x1dd062(0x2af)+_0x28f692+_0x1dd062(0x1bb));}),app['post']('/upload-backup',async(_0x5c6f87,_0x3913e7)=>{const _0x1c049b=_0x14cc10,_0x40c37f=getClientsWithBotID(_0x1c049b(0x267)),_0x395dbf=_0x5c6f87[_0x1c049b(0x297)][_0x1c049b(0x338)],_0xd975dc=timelyDecrypt(_0x395dbf,![]),_0x55c5a2=_0x40c37f['find'](_0x2c703f=>_0x2c703f['uuid']==_0xd975dc);logger[_0x1c049b(0x24d)](_0x1c049b(0x26a));if(_0x55c5a2){const _0x23f069=normalizeIP(_0x5c6f87[_0x1c049b(0x2c0)]['remoteAddress'])['store'],_0x1ca574=_0x5c6f87[_0x1c049b(0x297)]['tkn'];if(validateAccess(_0x1ca574,_0xd975dc,_0x23f069)[_0x1c049b(0x337)]){if(_0x5c6f87[_0x1c049b(0x230)]){const _0x599116=_0x5c6f87[_0x1c049b(0x230)]['backupfile'];await _0x599116['mv'](temppath+_0x599116[_0x1c049b(0x290)]),_0x3913e7[_0x1c049b(0x1c7)]({'status':!![],'message':_0x1c049b(0x2ba)});const _0x326451=getBotsWithMode();_0x326451[_0x1c049b(0x2be)]>0x0?confirmRestore(temppath,_0x599116[_0x1c049b(0x290)]):unzipFile(temppath,_0x599116[_0x1c049b(0x290)]);}}else logger['full'](_0x1c049b(0x16c));}else logger[_0x1c049b(0x17b)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x14cc10(0x2f6)](express[_0x14cc10(0x221)](path[_0x14cc10(0x31b)](__dirname,bbpath2,_0x14cc10(0x308)))),app[_0x14cc10(0x2f6)](express['static'](path[_0x14cc10(0x31b)](__dirname,bbpath2,_0x14cc10(0x260)))),app['get']('/',function(_0x236550,_0x493774){const _0x1a1ede=_0x14cc10;_0x493774[_0x1a1ede(0x1db)](path[_0x1a1ede(0x31b)](__dirname,bbpath2,_0x1a1ede(0x308),_0x1a1ede(0x2cd)));}),app[_0x14cc10(0x2e6)](_0x14cc10(0x2d8),function(_0x1756fa,_0x31c6cf){const _0x5a0804=_0x14cc10;_0x31c6cf[_0x5a0804(0x1db)](path[_0x5a0804(0x31b)](__dirname,bbpath2,_0x5a0804(0x260),_0x5a0804(0x2cd)));}),app[_0x14cc10(0x2e6)](_0x14cc10(0x176),(_0x1905e8,_0x43cc17)=>{const _0x285256=_0x14cc10;_0x43cc17[_0x285256(0x1db)](path[_0x285256(0x31b)](__dirname,bbpath2,_0x285256(0x260),'index.html'));}),app[_0x14cc10(0x2e6)](_0x14cc10(0x312),(_0x3f3e40,_0x2b7406)=>{const _0x3cb715=_0x14cc10;_0x2b7406[_0x3cb715(0x1db)](path[_0x3cb715(0x31b)](__dirname,bbpath2,_0x3cb715(0x260),_0x3cb715(0x2cd)));}),app[_0x14cc10(0x2e6)](_0x14cc10(0x259),(_0x54bf46,_0x16a413)=>{const _0x864a5b=_0x14cc10;_0x16a413[_0x864a5b(0x1db)](path[_0x864a5b(0x31b)](__dirname,bbpath2,_0x864a5b(0x260),'index.html'));}),app[_0x14cc10(0x2e6)](_0x14cc10(0x178),(_0x1ce71c,_0x5e6960)=>{const _0x4d9756=_0x14cc10;_0x5e6960[_0x4d9756(0x1db)](path[_0x4d9756(0x31b)](__dirname,bbpath2,'build','index.html'));}),app['get'](_0x14cc10(0x333),(_0x4b989c,_0x1e2806)=>{const _0x1ec147=_0x14cc10;_0x1e2806[_0x1ec147(0x1db)](path[_0x1ec147(0x31b)](__dirname,bbpath2,_0x1ec147(0x260),_0x1ec147(0x2cd)));}),app['get'](_0x14cc10(0x242),(_0x79b1ab,_0x1a76f6)=>{const _0x5f0e0e=_0x14cc10;_0x1a76f6[_0x5f0e0e(0x1db)](path[_0x5f0e0e(0x31b)](__dirname,bbpath2,_0x5f0e0e(0x260),'index.html'));});if(HOST)http[_0x14cc10(0x2ce)](PORT,HOST);else http[_0x14cc10(0x2ce)](PORT);const io=require(_0x14cc10(0x1a0))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x2d04fb=_0x14cc10;let _0x2e39a6=_0x2d04fb(0x1c0);const _0x11039f=networkInterfaces(),_0x527240={};for(const _0x2e384f of Object['keys'](_0x11039f)){for(const _0x511d53 of _0x11039f[_0x2e384f]){if((_0x511d53[_0x2d04fb(0x2e0)]==_0x2d04fb(0x183)||_0x511d53[_0x2d04fb(0x2e0)]==0x4)&&!_0x511d53[_0x2d04fb(0x2cc)]){const _0x25b511=ipaddr[_0x2d04fb(0x2d9)](_0x511d53[_0x2d04fb(0x1cf)])['range']();_0x25b511!=_0x2d04fb(0x2da)&&(!_0x527240[_0x2e384f]&&(_0x527240[_0x2e384f]=[]),_0x527240[_0x2e384f][_0x2d04fb(0x25d)](_0x511d53['address']),_0x2e39a6=_0x511d53[_0x2d04fb(0x1cf)]);}}}return{'serverip':_0x2e39a6,'netinterfaces':_0x527240};}async function startServer(){const _0x172c38=_0x14cc10,{serverip:_0x4f4ed4,netinterfaces:_0x66adb4}=getServerIP();logger[_0x172c38(0x322)](''),logger[_0x172c38(0x322)](_0x172c38(0x21d)),await logger[_0x172c38(0x17b)](_0x172c38(0x2b6)+serverversion+_0x172c38(0x238)+(environment=='staging'?_0x172c38(0x2ec):'')+'\x0a'+(_0x172c38(0x271)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x172c38(0x35b)+_0x4f4ed4+':'+PORT+_0x172c38(0x349))),logger[_0x172c38(0x322)](_0x172c38(0x21d));if(config[_0x172c38(0x2be)]!=0x0)for(const _0x371554 of config){const _0x21e597=_0x371554['mode']==_0x172c38(0x323)?'a':'m';if(_0x371554[_0x172c38(0x30c)]==_0x172c38(0x2bd)||_0x371554[_0x172c38(0x30c)]==_0x172c38(0x357))await logger[_0x172c38(0x17b)](_0x172c38(0x37b)+_0x21e597+_0x172c38(0x189)+_0x371554[_0x172c38(0x2fb)]+_0x172c38(0x351)+_0x371554['botname']),startBot([_0x371554[_0x172c38(0x2fb)],userID],{'cwd':bbpath},function(_0x48176f){const _0x3f8e8e=_0x172c38;if(_0x48176f)logger[_0x3f8e8e(0x17b)](_0x48176f);});else(_0x371554[_0x172c38(0x30c)]==_0x172c38(0x235)||_0x371554[_0x172c38(0x30c)]=='new-disabled')&&await logger['full'](_0x172c38(0x207)+_0x21e597+')\x20\x20\x20|\x20Bot\x20'+_0x371554[_0x172c38(0x2fb)]+_0x172c38(0x351)+_0x371554[_0x172c38(0x1e3)]);}else!newBot&&logger['simple'](_0x172c38(0x1da));if(newBot)addBot();logger[_0x172c38(0x322)](_0x172c38(0x21d)),logger['simple'](''),await logger[_0x172c38(0x24d)]('Node.js\x20v'+nodeversion),await logger[_0x172c38(0x24d)]('Network\x20Interfaces:',_0x66adb4);}function startSocket(){const _0xe2f735=_0x14cc10;io['on'](_0xe2f735(0x315),_0x4ea874=>{const _0x27adb1=_0xe2f735;let _0x548151,_0x42ab91,_0x51e930,_0x5aaca5,_0x20745c;const _0x1f1e6e=_0x4ea874[_0x27adb1(0x16f)]['headers'][_0x27adb1(0x2a8)];_0x42ab91=_0x1f1e6e['match'](/bot[0-9]{3}/);if(_0x42ab91)_0x51e930=_0x42ab91[0x0][_0x27adb1(0x258)](/[0-9]{3}/);if(_0x51e930)_0x548151=_0x51e930[0x0];else _0x548151='botmanager';const _0x4521ef=_0x4ea874[_0x27adb1(0x16f)][_0x27adb1(0x2a4)]['encryptedUuid'];if(!_0x4521ef)_0x4ea874[_0x27adb1(0x1bd)]('status',{'publicKey':secure[_0x27adb1(0x201)]});else{_0x5aaca5=timelyDecrypt(_0x4521ef,![]);if(!_0x5aaca5)_0x4ea874[_0x27adb1(0x1bd)]('status',{'publicKey':secure[_0x27adb1(0x201)]});else{_0x20745c=normalizeIP(_0x4ea874['conn'][_0x27adb1(0x2ed)])['store'];if(!devices[_0x5aaca5])devices[_0x5aaca5]={'uuid':_0x5aaca5,'access':{'token':null}};devices[_0x5aaca5]['ip']=_0x20745c;const _0x1be0f8=addClient(_0x4ea874['id'],_0x5aaca5,_0x548151);setAccess(_0x1be0f8),emitMessages(),_0x4ea874['on'](_0x27adb1(0x334),_0x33946f=>{const _0x316eac=_0x27adb1,_0x1fffda=timelyDecrypt(_0x33946f[_0x316eac(0x300)]);if(_0x1fffda){_0x33946f={'username':_0x33946f['username'],'password':_0x1fffda},devices[_0x5aaca5]['access']=validateCredentials(_0x33946f,_0x5aaca5);if(devices[_0x5aaca5][_0x316eac(0x292)]['allow']==![]&&devices[_0x5aaca5][_0x316eac(0x292)][_0x316eac(0x24c)]==_0x316eac(0x2db))_0x4ea874[_0x316eac(0x1bd)](_0x316eac(0x30c),{'access':devices[_0x5aaca5][_0x316eac(0x292)]}),loginAccess2FA(_0x5aaca5,_0x20745c);else{if(devices[_0x5aaca5][_0x316eac(0x292)]['allow']==![]&&devices[_0x5aaca5]['access'][_0x316eac(0x24c)]==_0x316eac(0x1c9))_0x4ea874[_0x316eac(0x1bd)]('status',{'access':devices[_0x5aaca5][_0x316eac(0x292)]});else devices[_0x5aaca5][_0x316eac(0x292)][_0x316eac(0x337)]&&devices[_0x5aaca5][_0x316eac(0x292)][_0x316eac(0x24c)]==_0x316eac(0x294)&&(getClientsWithUuid(_0x5aaca5)['forEach'](_0x3e4eae=>{setAccess(_0x3e4eae);}),logger['debug'](_0x316eac(0x2c7)+_0x5aaca5[_0x316eac(0x265)](-0x8)),setTokenRefresh(_0x5aaca5),setSessionTimeout('login',_0x5aaca5));}}else logger['full'](_0x316eac(0x360));}),_0x4ea874['on'](_0x27adb1(0x1a2),()=>{resetPassword();}),_0x4ea874['on'](_0x27adb1(0x361),_0x577373=>{removeClient(_0x4ea874['id']);}),_0x548151=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5760f2){const _0x3ca2df=_0x14cc10;if(_0x5760f2!=_0x3ca2df(0x267)&&config[_0x3ca2df(0x172)]!=''){if(pid[_0x5760f2])pid[_0x5760f2]['send']({'function':_0x3ca2df(0x200),'args':null});}_0x5760f2!=_0x3ca2df(0x267)&&broadcastToBots(_0x3ca2df(0x2ee),JSON[_0x3ca2df(0x23d)](config));}function reloadBotManager(){const _0x208b85=_0x14cc10;getClientsWithBotID(_0x208b85(0x267))[_0x208b85(0x219)](_0x8dc8a8=>{const _0x513c1c=_0x208b85;getSocket(_0x8dc8a8['id'])[_0x513c1c(0x1bd)](_0x513c1c(0x30c),{'access':{'allow':![],'reason':_0x513c1c(0x203),'token':null}});});}function getSocket(_0x38fa51){const _0x1d7baa=_0x14cc10;return io[_0x1d7baa(0x2b8)][_0x1d7baa(0x2b8)]['get'](_0x38fa51);}function setAccess(_0x2fe90b){const _0x2df427=_0x14cc10,_0x20e754=getSocket(_0x2fe90b['id']),_0x4acdc3=_0x2fe90b[_0x2df427(0x338)],_0x43a86e=_0x2fe90b['bot'];devices[_0x4acdc3][_0x2df427(0x292)]=validateAccess(devices[_0x4acdc3]['access']['token'],_0x4acdc3),logger[_0x2df427(0x24d)](_0x2df427(0x193)+devices[_0x4acdc3][_0x2df427(0x292)][_0x2df427(0x24c)]+_0x2df427(0x32d)+_0x2fe90b['id'][_0x2df427(0x265)](-0x8)+'\x20|\x20user:\x20...'+_0x4acdc3['slice'](-0x8)),_0x20e754[_0x2df427(0x31b)](_0x4acdc3);if(devices[_0x4acdc3]['access'][_0x2df427(0x337)]){_0x20e754[_0x2df427(0x31b)](_0x43a86e);if(_0x43a86e=='botmanager')initializeSocketBotManager(_0x20e754);else initializeSocketBot(_0x20e754);initClient(_0x43a86e);}devices[_0x4acdc3][_0x2df427(0x292)]['token']&&devices[_0x4acdc3][_0x2df427(0x292)][_0x2df427(0x24c)]==_0x2df427(0x1ac)&&setSessionTimeout(_0x2df427(0x1ed),_0x4acdc3),devices[_0x4acdc3][_0x2df427(0x292)]['token']&&devices[_0x4acdc3]['access'][_0x2df427(0x24c)]==_0x2df427(0x1fb)&&setSessionTimeout(_0x2df427(0x334),_0x4acdc3),_0x20e754[_0x2df427(0x1bd)](_0x2df427(0x30c),{'status':_0x2fe90b[_0x2df427(0x29c)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4acdc3][_0x2df427(0x292)],'externalip':devices[_0x4acdc3]['ip'],'publicKey':secure[_0x2df427(0x201)],'userid':settings[_0x2df427(0x1b8)],'validInstallation':validInstallation}),devices[_0x4acdc3][_0x2df427(0x292)][_0x2df427(0x337)]==![]&&devices[_0x4acdc3][_0x2df427(0x292)][_0x2df427(0x24c)]==_0x2df427(0x209)&&temporaryAccess2FA(_0x4acdc3,devices[_0x4acdc3]['ip']);}function setSessionTimeout(_0x3ac6a7,_0x109e9f){const _0x476083=_0x14cc10;let _0x36c01c;if(_0x3ac6a7==_0x476083(0x334))_0x36c01c=loginExpiry*0x3c*0x3e8;else _0x36c01c=devices[_0x109e9f][_0x476083(0x262)][_0x476083(0x247)]*0x3c*0x3e8-(new Date()[_0x476083(0x272)]()-devices[_0x109e9f][_0x476083(0x262)][_0x476083(0x33a)]);if(devices[_0x109e9f][_0x476083(0x25c)])clearTimeout(devices[_0x109e9f][_0x476083(0x25c)]);devices[_0x109e9f][_0x476083(0x25c)]=setTimeout(()=>{const _0x3b3ea8=_0x476083;if(devices[_0x109e9f][_0x3b3ea8(0x37e)])clearTimeout(devices[_0x109e9f][_0x3b3ea8(0x37e)]);removeSocketListeners(_0x109e9f),addBlacklist(_0x109e9f),devices[_0x109e9f]['telegramIpApproval']=null,devices[_0x109e9f][_0x3b3ea8(0x36e)]=null,devices[_0x109e9f]['access'][_0x3b3ea8(0x379)]=null,logger['debug'](_0x3b3ea8(0x231)+_0x109e9f[_0x3b3ea8(0x265)](-0x8)),devices[_0x109e9f][_0x3b3ea8(0x292)]=validateAccess(devices[_0x109e9f][_0x3b3ea8(0x292)]['token'],_0x109e9f),!(devices[_0x109e9f][_0x3b3ea8(0x292)][_0x3b3ea8(0x337)]&&devices[_0x109e9f][_0x3b3ea8(0x292)][_0x3b3ea8(0x24c)]==_0x3b3ea8(0x2d6))&&(_0x3ac6a7==_0x3b3ea8(0x334)?io['to'](_0x109e9f)[_0x3b3ea8(0x1bd)](_0x3b3ea8(0x30c),{'access':{'allow':![],'reason':_0x3b3ea8(0x32e),'token':null}}):io['to'](_0x109e9f)['emit']('status',{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x109e9f][_0x3b3ea8(0x292)][_0x3b3ea8(0x379)]=null;},_0x36c01c);}function setTokenRefresh(_0x26091d){const _0x2e593f=_0x14cc10;if(devices[_0x26091d][_0x2e593f(0x37e)])clearTimeout(devices[_0x26091d][_0x2e593f(0x37e)]);devices[_0x26091d][_0x2e593f(0x37e)]=setTimeout(()=>{const _0x49b1c3=_0x2e593f;getClientsWithUuid(_0x26091d)['length']!=0x0?(devices[_0x26091d]['access']=refreshToken(_0x26091d),io['to'](_0x26091d)[_0x49b1c3(0x1bd)]('status',{'status':_0x49b1c3(0x220),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x26091d][_0x49b1c3(0x292)],'externalip':devices[_0x26091d]['ip'],'publicKey':secure[_0x49b1c3(0x201)],'validInstallation':validInstallation}),setTokenRefresh(_0x26091d)):clearTimeout(devices[_0x26091d][_0x49b1c3(0x37e)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0xdd9e12){const _0x48256b=_0x14cc10,_0x426bd6=getClient(_0xdd9e12['id'])[_0x48256b(0x338)];_0xdd9e12[_0x48256b(0x1bd)]('bots',config),_0xdd9e12[_0x48256b(0x1bd)](_0x48256b(0x19c),cleanSettings()),_0xdd9e12['on']('add-bot',_0x3f0ae0=>{const _0x9e5d26=_0x48256b;if(validateAccess(_0x3f0ae0,_0x426bd6)['allow'])addBot();else logger[_0x9e5d26(0x17b)](_0x9e5d26(0x1ba));}),_0xdd9e12['on'](_0x48256b(0x2d7),(_0x5f13f0,_0x303de9)=>{const _0x152174=_0x48256b;if(validateAccess(_0x303de9,_0x426bd6)[_0x152174(0x337)])toggleBot(_0x5f13f0['botID'],_0x5f13f0[_0x152174(0x30c)],_0x5f13f0['live']);else logger[_0x152174(0x17b)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0xdd9e12['on'](_0x48256b(0x21b),(_0x4cd209,_0x1550fd)=>{const _0x5cc51e=_0x48256b;if(validateAccess(_0x1550fd,_0x426bd6)[_0x5cc51e(0x337)])toggleBotMode(_0x4cd209);else logger[_0x5cc51e(0x17b)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0xdd9e12['on'](_0x48256b(0x208),(_0x1c9a4d,_0x79eb31)=>{const _0x590c4f=_0x48256b;if(validateAccess(_0x79eb31,_0x426bd6)[_0x590c4f(0x337)])deleteBot(_0x1c9a4d);else logger['full'](_0x590c4f(0x1a4));}),_0xdd9e12['on'](_0x48256b(0x2df),(_0x32cf38,_0x45fef0)=>{if(validateAccess(_0x45fef0,_0x426bd6)['allow'])storeSettings(_0x32cf38,!![]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0xdd9e12['on'](_0x48256b(0x1cb),_0x4b4a19=>{const _0x6b76b3=_0x48256b;if(validateAccess(_0x4b4a19,_0x426bd6)['allow'])updateBB(_0x6b76b3(0x251));else logger['full'](_0x6b76b3(0x287));}),_0xdd9e12['on'](_0x48256b(0x1eb),_0x53f358=>{const _0x33879a=_0x48256b;if(validateAccess(_0x53f358,_0x426bd6)[_0x33879a(0x337)])updateBB(_0x33879a(0x216));else logger[_0x33879a(0x17b)](_0x33879a(0x180));}),_0xdd9e12['on'](_0x48256b(0x33f),_0x5e8b03=>{const _0x138fd4=_0x48256b;if(validateAccess(_0x5e8b03,_0x426bd6)[_0x138fd4(0x337)]){const _0x2b3c4b=getClient(_0xdd9e12['id']);if(_0x2b3c4b)getBackupFiles(_0x2b3c4b[_0x138fd4(0x338)]);else logger[_0x138fd4(0x17b)](_0x138fd4(0x2e9));}else logger[_0x138fd4(0x17b)](_0x138fd4(0x175));}),_0xdd9e12['on'](_0x48256b(0x320),(_0x1506f8,_0x278191)=>{const _0x4436b7=_0x48256b;if(validateAccess(_0x278191,_0x426bd6)[_0x4436b7(0x337)])restoreBackupFile(_0x1506f8);else logger[_0x4436b7(0x17b)](_0x4436b7(0x1d8));}),_0xdd9e12['on'](_0x48256b(0x1e5),_0x9ddcc4=>{const _0x4ccc1c=_0x48256b;if(validateAccess(_0x9ddcc4,_0x426bd6)[_0x4ccc1c(0x337)])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0xdd9e12['on']('confirm-message',(_0x4fb20a,_0x2479d1)=>{const _0x40d50c=_0x48256b;if(validateAccess(_0x2479d1,_0x426bd6)[_0x40d50c(0x337)])confirmMessage(_0x4fb20a);else logger[_0x40d50c(0x17b)](_0x40d50c(0x353));}),_0xdd9e12['on'](_0x48256b(0x222),_0x3500c0=>{const _0x5a9aaa=_0x48256b;if(validateAccess(_0x3500c0,_0x426bd6)['allow']){if(devices[_0x426bd6][_0x5a9aaa(0x37e)])clearTimeout(devices[_0x426bd6][_0x5a9aaa(0x37e)]);if(devices[_0x426bd6][_0x5a9aaa(0x25c)])clearTimeout(devices[_0x426bd6]['pidExpireLogin']);removeSocketListeners(getClient(_0xdd9e12['id'])[_0x5a9aaa(0x338)]),addBlacklist(_0x426bd6),devices[_0x426bd6][_0x5a9aaa(0x262)]=null,devices[_0x426bd6][_0x5a9aaa(0x36e)]=null,devices[_0x426bd6]['access']['token']=null,logger[_0x5a9aaa(0x24d)](_0x5a9aaa(0x243)+_0x426bd6[_0x5a9aaa(0x265)](-0x8)),io['to'](getClient(_0xdd9e12['id'])[_0x5a9aaa(0x338)])[_0x5a9aaa(0x1bd)](_0x5a9aaa(0x30c),{'access':{'allow':![],'reason':_0x5a9aaa(0x22f),'token':null}});}else logger[_0x5a9aaa(0x17b)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x1beaa5){const _0x10a448=_0x14cc10,_0x8460e4=getClient(_0x1beaa5['id'])[_0x10a448(0x303)],_0x33cc14=getClient(_0x1beaa5['id'])[_0x10a448(0x338)];_0x1beaa5['on']('get-logs',(_0x55b9d1,_0x4b8a57)=>{const _0x3527b7=_0x10a448;if(validateAccess(_0x4b8a57,_0x33cc14)[_0x3527b7(0x337)]){if(pid[_0x8460e4])pid[_0x8460e4][_0x3527b7(0x1c7)]({'function':_0x3527b7(0x378),'args':_0x55b9d1});}else logger[_0x3527b7(0x17b)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x1beaa5['on']('delete-alerts',(_0x545aac,_0x3824a0)=>{const _0x1c2bfe=_0x10a448;if(validateAccess(_0x3824a0,_0x33cc14)[_0x1c2bfe(0x337)]){if(pid[_0x8460e4])pid[_0x8460e4][_0x1c2bfe(0x1c7)]({'function':_0x1c2bfe(0x30b),'args':_0x545aac});}else logger[_0x1c2bfe(0x17b)](_0x1c2bfe(0x2f0));}),_0x1beaa5['on'](_0x10a448(0x332),(_0x224232,_0x2669d0)=>{const _0x551617=_0x10a448;if(validateAccess(_0x2669d0,_0x33cc14)[_0x551617(0x337)]){if(pid[_0x8460e4])pid[_0x8460e4][_0x551617(0x1c7)]({'function':_0x551617(0x1f1),'args':_0x224232});}else logger[_0x551617(0x17b)](_0x551617(0x20f));}),_0x1beaa5['on'](_0x10a448(0x184),(_0x1ee6c4,_0x4a9fe9)=>{const _0x416cb8=_0x10a448;if(validateAccess(_0x4a9fe9,_0x33cc14)[_0x416cb8(0x337)]){if(pid[_0x8460e4])pid[_0x8460e4][_0x416cb8(0x1c7)]({'function':_0x416cb8(0x1b3),'args':_0x1ee6c4});}else logger['full'](_0x416cb8(0x317));}),_0x1beaa5['on']('store-headless',(_0x5ca4e3,_0x9fbce0)=>{const _0xa31341=_0x10a448;if(validateAccess(_0x9fbce0,_0x33cc14)[_0xa31341(0x337)]){if(pid[_0x8460e4])pid[_0x8460e4]['send']({'function':_0xa31341(0x2f1),'args':_0x5ca4e3});}else logger[_0xa31341(0x17b)](_0xa31341(0x257));}),_0x1beaa5['on'](_0x10a448(0x1e0),(_0x300be2,_0x413c07)=>{const _0x3d736b=_0x10a448;if(validateAccess(_0x413c07,_0x33cc14)[_0x3d736b(0x337)]){if(pid[_0x8460e4])pid[_0x8460e4]['send']({'function':_0x3d736b(0x26e),'args':_0x300be2});}else logger[_0x3d736b(0x17b)](_0x3d736b(0x2e8));}),_0x1beaa5['on'](_0x10a448(0x2ab),_0x1d927b=>{const _0x34b130=_0x10a448;if(validateAccess(_0x1d927b,_0x33cc14)[_0x34b130(0x337)]){if(pid[_0x8460e4])pid[_0x8460e4]['send']({'function':_0x34b130(0x35a),'args':null});}else logger[_0x34b130(0x17b)](_0x34b130(0x285));}),_0x1beaa5['on'](_0x10a448(0x170),_0x3bb666=>{const _0x4c12f9=_0x10a448;if(validateAccess(_0x3bb666,_0x33cc14)[_0x4c12f9(0x337)]){if(pid[_0x8460e4])pid[_0x8460e4][_0x4c12f9(0x1c7)]({'function':'getStartingBalances','args':null});}else logger[_0x4c12f9(0x17b)](_0x4c12f9(0x305));}),_0x1beaa5['on'](_0x10a448(0x24a),(_0x5c06b0,_0x46c6a5)=>{const _0x37aa29=_0x10a448;if(validateAccess(_0x46c6a5,_0x33cc14)[_0x37aa29(0x337)]){if(pid[_0x8460e4])pid[_0x8460e4]['send']({'function':'placeOrder','args':_0x5c06b0});}else logger[_0x37aa29(0x17b)](_0x37aa29(0x380));}),_0x1beaa5['on'](_0x10a448(0x2b9),_0x54e3b2=>{const _0x570a91=_0x10a448;if(validateAccess(_0x54e3b2,_0x33cc14)[_0x570a91(0x337)]){if(pid[_0x8460e4])pid[_0x8460e4][_0x570a91(0x1c7)]({'function':_0x570a91(0x2e3),'args':null});}else logger['full'](_0x570a91(0x33c));}),_0x1beaa5['on'](_0x10a448(0x1fd),_0x6539b2=>{const _0x16bb32=_0x10a448;if(validateAccess(_0x6539b2,_0x33cc14)[_0x16bb32(0x337)]){if(pid[_0x8460e4])pid[_0x8460e4]['send']({'function':'showConfig','args':null});}else logger[_0x16bb32(0x17b)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x1beaa5['on'](_0x10a448(0x1cb),_0x1ccddc=>{const _0x585390=_0x10a448;if(validateAccess(_0x1ccddc,_0x33cc14)['allow'])updateBB(_0x585390(0x251));else logger[_0x585390(0x17b)](_0x585390(0x287));}),_0x1beaa5['on'](_0x10a448(0x1e5),_0x41246c=>{const _0x20f678=_0x10a448;if(validateAccess(_0x41246c,_0x33cc14)[_0x20f678(0x337)])getMessages();else logger[_0x20f678(0x17b)](_0x20f678(0x29b));}),_0x1beaa5['on'](_0x10a448(0x1ca),(_0x491ad8,_0xe1b5e9)=>{const _0x5e460f=_0x10a448;if(validateAccess(_0xe1b5e9,_0x33cc14)['allow'])confirmMessage(_0x491ad8);else logger[_0x5e460f(0x17b)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x1beaa5['on'](_0x10a448(0x222),_0x23d4e0=>{const _0x43d729=_0x10a448;if(validateAccess(_0x23d4e0,_0x33cc14)[_0x43d729(0x337)]){if(devices[_0x33cc14][_0x43d729(0x37e)])clearTimeout(devices[_0x33cc14][_0x43d729(0x37e)]);if(devices[_0x33cc14][_0x43d729(0x25c)])clearTimeout(devices[_0x33cc14]['pidExpireLogin']);removeSocketListeners(getClient(_0x1beaa5['id'])[_0x43d729(0x338)]),addBlacklist(_0x33cc14),devices[_0x33cc14][_0x43d729(0x262)]=null,devices[_0x33cc14]['telegram2FaApproval']=null,devices[_0x33cc14][_0x43d729(0x292)]['token']=null,logger[_0x43d729(0x24d)](_0x43d729(0x243)+_0x33cc14[_0x43d729(0x265)](-0x8)),io['to'](getClient(_0x1beaa5['id'])[_0x43d729(0x338)])[_0x43d729(0x1bd)]('status',{'access':{'allow':![],'reason':_0x43d729(0x22f),'token':null}});}else logger[_0x43d729(0x17b)](_0x43d729(0x2c6));});}function removeSocketListeners(_0x211573){const _0x102cbb=_0x14cc10;getClientsWithUuid(_0x211573)[_0x102cbb(0x219)](_0x5b9b35=>{const _0x514eb4=_0x102cbb;getSocket(_0x5b9b35['id'])[_0x514eb4(0x269)]();});}function cleanSettings(){const _0x4eae02=_0x14cc10;let _0x2fd4ff=settings;return settings[_0x4eae02(0x19e)]&&settings[_0x4eae02(0x19e)]!=''&&(_0x2fd4ff={..._0x2fd4ff,'telegramToken':_0x4eae02(0x233)}),settings[_0x4eae02(0x28e)]&&settings['bbPassword']!=''&&(_0x2fd4ff={..._0x2fd4ff,'bbPassword':'************'}),(settings['bbPassword']&&settings['bbPassword']=='***'||settings['telegramToken']&&settings[_0x4eae02(0x19e)]==_0x4eae02(0x350))&&(_0x2fd4ff={..._0x2fd4ff,'restored':{'password':settings['bbPassword']=='***','telegram':settings[_0x4eae02(0x19e)]==_0x4eae02(0x350)}}),_0x2fd4ff;}async function updateBB(_0x5396ec){const _0x19127=_0x14cc10;await backupConfigFiles(),installingUpdate=!![],config[_0x19127(0x219)](_0x16bde6=>{restartBot(_0x16bde6['botID']);});if(_0x5396ec==_0x19127(0x251))process[_0x19127(0x1c7)]({'update':!![],'environment':environment},_0x88a879=>{});else _0x5396ec==_0x19127(0x216)&&process[_0x19127(0x1c7)]({'reinstall':!![],'environment':environment},_0xf89683=>{});}function startBot(_0x503634,_0x1fcd36,_0x322e54){const _0x6af208=_0x14cc10;if(debugging)_0x503634[_0x6af208(0x25d)]('-d');let _0x56efa3=![];const _0x5759b2=_0x503634[0x0];_0x1fcd36={..._0x1fcd36,'stdio':[_0x6af208(0x1c5),'inherit','inherit',_0x6af208(0x377)]},pid[_0x5759b2]=childProcess[_0x6af208(0x1f0)](botfile,_0x503634,_0x1fcd36),pid[_0x5759b2]['on'](_0x6af208(0x213),_0x27a8e2=>{const _0x213318=_0x6af208;switch(Object['keys'](_0x27a8e2)[0x0]){case _0x213318(0x1e3):updateBotName(_0x5759b2,_0x27a8e2[_0x213318(0x1e3)]);break;case _0x213318(0x2f9):updateBotManager();break;case'status':updateStatus(_0x5759b2,_0x27a8e2[_0x213318(0x30c)]);break;case _0x213318(0x2ef):updateLive(_0x5759b2,_0x27a8e2[_0x213318(0x2ef)]);break;case _0x213318(0x27a):updateLive(_0x5759b2,_0x27a8e2[_0x213318(0x27a)]),io['to'](_0x5759b2)[_0x213318(0x1bd)]('status',{'access':{'allow':![],'reason':_0x213318(0x203),'token':null}});break;case'stop':_0x27a8e2[_0x213318(0x2bc)]==_0x213318(0x376)&&restartBot(_0x5759b2);_0x27a8e2['stop']==_0x213318(0x358)&&toggleBot(_0x5759b2,'disabled',_0x213318(0x1b1));break;case'telegram':sendTelegramBot(_0x5759b2,_0x27a8e2[_0x213318(0x1f4)]);break;case _0x213318(0x37d):sendTelegramMsg(_0x27a8e2[_0x213318(0x37d)]);break;case _0x213318(0x1de):io['to'](_0x5759b2)[_0x213318(0x1bd)](_0x27a8e2[_0x213318(0x1de)],_0x27a8e2[_0x213318(0x30d)]);break;}}),pid[_0x5759b2]['on']('error',function(_0x272376){if(_0x56efa3)return;_0x56efa3=!![],_0x322e54(_0x272376);}),pid[_0x5759b2]['on'](_0x6af208(0x291),async function(_0xcdda07){const _0x17acd7=_0x6af208;if(terminating)return;if(installingUpdate){logger[_0x17acd7(0x24d)]('Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process'),io['close']();return;}if(_0x56efa3)return;_0x56efa3=!![],_0x322e54(null);const _0x53a15b=dbConfig[_0x17acd7(0x2e6)](_0x17acd7(0x2ee))['find']({'botID':_0x5759b2})[_0x17acd7(0x2bb)]();_0x53a15b&&(_0x53a15b[_0x17acd7(0x30c)]==_0x17acd7(0x2bd)||_0x53a15b['status']==_0x17acd7(0x357))&&(await sleep(0x3e8),updateLive(_0x5759b2,_0x17acd7(0x1b1)),logger[_0x17acd7(0x17b)](_0x17acd7(0x2d3)+_0x5759b2),startBot([_0x5759b2,userID],{'cwd':bbpath},function(_0x49b39a){if(_0x49b39a)logger['full'](_0x49b39a);}));});}function stopBot(_0x48635c){const _0x3f46af=_0x14cc10;getClientsWithBotID(_0x48635c)['forEach'](_0x6db9da=>{getSocket(_0x6db9da['id'])['disconnect'](!![]),removeClient(_0x6db9da['id']);}),pid[_0x48635c]&&(pid[_0x48635c][_0x3f46af(0x358)](),pid[_0x48635c]=null);}function stopAllBots(){const _0x54ec92=_0x14cc10;terminating=!![];const _0x2afcd9=getEnabledBots();_0x2afcd9[_0x54ec92(0x219)](_0x8544d0=>{const _0x17718d=_0x54ec92;stopBot(_0x8544d0[_0x17718d(0x2fb)]);});}function restartBot(_0x3baf1d){const _0x342cb6=_0x14cc10;if(pid[_0x3baf1d])pid[_0x3baf1d][_0x342cb6(0x358)]();}function addBot(){const _0x52697c=_0x14cc10;let _0x15c4cf;for(let _0x2e5830=0x1;_0x2e5830<0x3e9;_0x2e5830++){_0x15c4cf=_0x2e5830[_0x52697c(0x252)]()[_0x52697c(0x35c)](0x3,'0');let _0x33858d=config[_0x52697c(0x1cc)](_0x381f94=>_0x381f94[_0x52697c(0x2fb)]==_0x15c4cf);if(!_0x33858d)break;}if(_0x15c4cf===_0x52697c(0x18f)){logger[_0x52697c(0x17b)](_0x52697c(0x2b7));return;}logger[_0x52697c(0x17b)](_0x52697c(0x1aa)+_0x15c4cf),dbConfig[_0x52697c(0x2e6)](_0x52697c(0x2ee))[_0x52697c(0x25d)]({'botID':_0x15c4cf,'botname':_0x52697c(0x2c9)+_0x15c4cf,'status':_0x52697c(0x357),'live':''})['write'](),startBot([_0x15c4cf,userID],{'cwd':bbpath},function(_0x3b9882){const _0x46f23e=_0x52697c;if(_0x3b9882)logger[_0x46f23e(0x17b)](_0x3b9882);}),config=getConfiguration(),io['to'](_0x52697c(0x267))[_0x52697c(0x1bd)]('bots',config),broadcastToBots(_0x52697c(0x2ee),JSON['stringify'](config));}function deleteBot(_0x276336){const _0xdd82a6=_0x14cc10;getClientsWithBotID(_0x276336)[_0xdd82a6(0x219)](_0x4f2eb1=>{getSocket(_0x4f2eb1['id'])['disconnect'](!![]),removeClient(_0x4f2eb1['id']);}),dbConfig['get'](_0xdd82a6(0x2ee))['remove']({'botID':_0x276336})[_0xdd82a6(0x2cf)](),logger['full']('Deleted\x20Bot\x20'+_0x276336),stopBot(_0x276336);try{if(fs[_0xdd82a6(0x2e5)](path[_0xdd82a6(0x31b)](configpath,_0xdd82a6(0x1f9)+_0x276336+_0xdd82a6(0x307))))fs[_0xdd82a6(0x355)](path[_0xdd82a6(0x31b)](configpath,_0xdd82a6(0x1f9)+_0x276336+_0xdd82a6(0x307)));if(fs[_0xdd82a6(0x2e5)](path[_0xdd82a6(0x31b)](configpath,_0xdd82a6(0x1f9)+_0x276336+_0xdd82a6(0x28c))))fs[_0xdd82a6(0x355)](path[_0xdd82a6(0x31b)](configpath,'bot-'+_0x276336+_0xdd82a6(0x28c)));if(fs[_0xdd82a6(0x2e5)](path['join'](configpath,_0xdd82a6(0x1f9)+_0x276336+_0xdd82a6(0x2a2))))fs[_0xdd82a6(0x355)](path[_0xdd82a6(0x31b)](configpath,'bot-'+_0x276336+_0xdd82a6(0x2a2)));if(fs[_0xdd82a6(0x2e5)](path[_0xdd82a6(0x31b)](configpath,_0xdd82a6(0x1f9)+_0x276336+_0xdd82a6(0x373))))fs[_0xdd82a6(0x355)](path['join'](configpath,_0xdd82a6(0x1f9)+_0x276336+'-results.json'));}catch(_0x53ccb3){if(_0x53ccb3)logger['full'](_0xdd82a6(0x24b),_0x53ccb3);}config=getConfiguration(),io['to']('botmanager')[_0xdd82a6(0x1bd)](_0xdd82a6(0x2ee),config),broadcastToBots(_0xdd82a6(0x2ee),JSON[_0xdd82a6(0x23d)](config));}function toggleBot(_0x11a18e,_0x307bcb,_0x4ea89d){const _0x3eb787=_0x14cc10;dbConfig[_0x3eb787(0x2e6)](_0x3eb787(0x2ee))['find']({'botID':_0x11a18e})[_0x3eb787(0x195)]({'status':_0x307bcb})[_0x3eb787(0x195)]({'live':_0x4ea89d})[_0x3eb787(0x2cf)]();if(_0x307bcb==_0x3eb787(0x2bd)||_0x307bcb==_0x3eb787(0x357))logger[_0x3eb787(0x17b)](_0x3eb787(0x293)+_0x11a18e),startBot([_0x11a18e,userID],{'cwd':bbpath},function(_0xe5999b){const _0xf353d=_0x3eb787;if(_0xe5999b)logger[_0xf353d(0x17b)](_0xe5999b);});else(_0x307bcb==_0x3eb787(0x235)||_0x307bcb=='new-disabled')&&(logger[_0x3eb787(0x17b)](_0x3eb787(0x250)+_0x11a18e),stopBot(_0x11a18e));config=getConfiguration(),io['to'](_0x3eb787(0x267))[_0x3eb787(0x1bd)]('bots',config),broadcastToBots(_0x3eb787(0x2ee),JSON[_0x3eb787(0x23d)](config));}function toggleStatus(_0x862925){const _0xaa8f16=_0x14cc10;let _0x3ecb9d=dbConfig[_0xaa8f16(0x2e6)](_0xaa8f16(0x2ee))['find']({'botID':_0x862925})[_0xaa8f16(0x2bb)](),_0x3f6599;if(_0x3ecb9d[_0xaa8f16(0x30c)]==='enabled')_0x3f6599=_0xaa8f16(0x235);else{if(_0x3ecb9d[_0xaa8f16(0x30c)]===_0xaa8f16(0x357))_0x3f6599=_0xaa8f16(0x202);else{if(_0x3ecb9d[_0xaa8f16(0x30c)]===_0xaa8f16(0x202))_0x3f6599='new';else{if(_0x3ecb9d[_0xaa8f16(0x30c)]===_0xaa8f16(0x235))_0x3f6599=_0xaa8f16(0x2bd);}}}return _0x3f6599;}function updateStatus(_0xc6eed4,_0x41859e){const _0x143bf1=_0x14cc10;dbConfig['get'](_0x143bf1(0x2ee))[_0x143bf1(0x1cc)]({'botID':_0xc6eed4})[_0x143bf1(0x195)]({'status':_0x41859e})[_0x143bf1(0x2cf)](),config=getConfiguration(),io['to'](_0x143bf1(0x267))[_0x143bf1(0x1bd)](_0x143bf1(0x2ee),config),broadcastToBots(_0x143bf1(0x2ee),JSON[_0x143bf1(0x23d)](config));}function updateLive(_0x2b7e28,_0x242d2b){const _0x5b4543=_0x14cc10;dbConfig[_0x5b4543(0x2e6)](_0x5b4543(0x2ee))['find']({'botID':_0x2b7e28})[_0x5b4543(0x195)]({'live':_0x242d2b})[_0x5b4543(0x2cf)](),config=getConfiguration(),io['to'](_0x5b4543(0x267))['emit']('bots',config),broadcastToBots(_0x5b4543(0x2ee),JSON[_0x5b4543(0x23d)](config));}function updateBotName(_0xbefb4e,_0xb94217){const _0x4c1ad3=_0x14cc10;dbConfig[_0x4c1ad3(0x2e6)]('bots')[_0x4c1ad3(0x1cc)]({'botID':_0xbefb4e})[_0x4c1ad3(0x195)]({'botname':_0xb94217})[_0x4c1ad3(0x2cf)](),config=getConfiguration(),io['to']('botmanager')[_0x4c1ad3(0x1bd)]('bots',config),broadcastToBots(_0x4c1ad3(0x2ee),JSON[_0x4c1ad3(0x23d)](config));}function updateBotManager(){const _0x477667=_0x14cc10;config=getConfiguration(),io['to'](_0x477667(0x267))[_0x477667(0x1bd)](_0x477667(0x2ee),config),broadcastToBots(_0x477667(0x2ee),JSON[_0x477667(0x23d)](config));}function toggleBotMode(_0x57d718){const _0x38ae6b=_0x14cc10;if(pid[_0x57d718])pid[_0x57d718][_0x38ae6b(0x1c7)]({'function':_0x38ae6b(0x1a5),'args':null});else{const _0x12b15a=configpath+_0x38ae6b(0x1f9)+_0x57d718+_0x38ae6b(0x307),_0x54e7ea=fs[_0x38ae6b(0x266)](_0x12b15a),_0x5b568c=JSON[_0x38ae6b(0x2d9)](_0x54e7ea),_0x5d9b38=_0x5b568c['bot'][0x0][_0x38ae6b(0x2c1)];_0x5b568c['bot'][0x0][_0x38ae6b(0x2c1)]=!_0x5d9b38;const _0x48e621=JSON[_0x38ae6b(0x23d)](_0x5b568c,null,0x2);fs[_0x38ae6b(0x2c4)](_0x12b15a,_0x48e621),config=getConfiguration(),io['to'](_0x38ae6b(0x267))[_0x38ae6b(0x1bd)](_0x38ae6b(0x2ee),config),broadcastToBots(_0x38ae6b(0x2ee),JSON[_0x38ae6b(0x23d)](config));}}function validateTelegram(_0x236cf0){const _0x164abb=_0x14cc10;if(_0x236cf0['from'][_0x164abb(0x204)]!=settings[_0x164abb(0x1f6)]&&'@'+_0x236cf0[_0x164abb(0x1c3)]['username']!=settings['telegramUsername']||_0x236cf0[_0x164abb(0x236)]['id']!=settings[_0x164abb(0x325)])return sendTelegram(_0x236cf0[_0x164abb(0x236)]['id'],_0x164abb(0x171),{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0x53ae41=_0x14cc10;if(tgBot)tgBot[_0x53ae41(0x2bc)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0xe737d6=_0x53ae41(0x359);_0xe737d6+='\x0a',_0xe737d6+=_0x53ae41(0x28f),_0xe737d6+=_0x53ae41(0x1fe),_0xe737d6+=_0x53ae41(0x282),_0xe737d6+='/restart\x20-\x20restart\x20bot(s)\x0a',_0xe737d6+=_0x53ae41(0x364),_0xe737d6+=_0x53ae41(0x1d5),_0xe737d6+=_0x53ae41(0x173),_0xe737d6+=_0x53ae41(0x1e7),_0xe737d6+=_0x53ae41(0x26b),_0xe737d6+=_0x53ae41(0x17d),_0xe737d6+=_0x53ae41(0x1a6),_0xe737d6+=_0x53ae41(0x298),_0xe737d6+=_0x53ae41(0x329),_0xe737d6+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x117bbe=_0x53ae41(0x1df);_0x117bbe+='\x0a',_0x117bbe+=_0xe737d6,tgBot[_0x53ae41(0x1ce)]((_0x396012,_0x18e648)=>{const _0x4f7ff7=_0x53ae41;logger['simple'](getTimeStamp()+_0x4f7ff7(0x375)),logger[_0x4f7ff7(0x24d)](_0x4f7ff7(0x363),_0x396012);}),tgBot['use'](async(_0x798a98,_0x4b09ae)=>{const _0x3cfda3=_0x53ae41;if(!(!settings[_0x3cfda3(0x325)]&&_0x798a98[_0x3cfda3(0x251)][_0x3cfda3(0x213)][_0x3cfda3(0x2fd)]==_0x3cfda3(0x1dc))){if(!validateTelegram(_0x798a98))return;}_0x4b09ae();}),tgBot['command'](_0x53ae41(0x1b5),async _0x17b16d=>{const _0x11f3a0=_0x53ae41;if(!settings['telegramChatId'])updateSetting(_0x11f3a0(0x325),_0x17b16d[_0x11f3a0(0x236)]['id']);updateSetting('telegramEnabled',!![]);if(!validateTelegram(_0x17b16d))return;await sendTelegram(_0x17b16d['chat']['id'],_0x117bbe);}),tgBot[_0x53ae41(0x362)](_0x53ae41(0x2b0),async _0x3a9386=>{const _0x213324=_0x53ae41;updateSetting(_0x213324(0x28b),!![]),await sendTelegram(_0x3a9386[_0x213324(0x236)]['id'],'Notifications\x20enabled');}),tgBot[_0x53ae41(0x362)]('disable',async _0xdcae3e=>{const _0x5789b3=_0x53ae41;await sendTelegram(_0xdcae3e['chat']['id'],_0x5789b3(0x2ca)),updateSetting(_0x5789b3(0x28b),![]);}),tgBot[_0x53ae41(0x362)](_0x53ae41(0x16e),async _0x26200a=>{const _0x448d1c=_0x53ae41,_0x137535=Markup[_0x448d1c(0x31e)]([Markup[_0x448d1c(0x36a)][_0x448d1c(0x348)](_0x448d1c(0x20e),_0x448d1c(0x35d)),Markup[_0x448d1c(0x36a)][_0x448d1c(0x348)](_0x448d1c(0x31c),_0x448d1c(0x284)),Markup['button'][_0x448d1c(0x348)](_0x448d1c(0x368),_0x448d1c(0x191))]);_0x26200a[_0x448d1c(0x18e)](_0x448d1c(0x19f),_0x137535);}),tgBot[_0x53ae41(0x17a)](_0x53ae41(0x35d),async _0x4a2696=>{const _0x56e617=_0x53ae41;_0x4a2696[_0x56e617(0x227)](),updateSetting(_0x56e617(0x311),_0x56e617(0x1a1)),updateSetting(_0x56e617(0x28b),!![]),await sendTelegram(_0x4a2696['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0x53ae41(0x17a)](_0x53ae41(0x284),async _0x20fbdf=>{const _0xf5a671=_0x53ae41;_0x20fbdf['editMessageReplyMarkup'](),updateSetting(_0xf5a671(0x311),'alerts'),updateSetting(_0xf5a671(0x28b),!![]),await sendTelegram(_0x20fbdf[_0xf5a671(0x236)]['id'],_0xf5a671(0x347));}),tgBot[_0x53ae41(0x17a)](_0x53ae41(0x191),async _0x36c33c=>{const _0x48e181=_0x53ae41;_0x36c33c[_0x48e181(0x227)](),updateSetting(_0x48e181(0x311),'all'),updateSetting(_0x48e181(0x28b),!![]),await sendTelegram(_0x36c33c[_0x48e181(0x236)]['id'],_0x48e181(0x34d));}),tgBot[_0x53ae41(0x362)](_0x53ae41(0x30c),async _0x4c965e=>{const _0x17effe=_0x53ae41,_0x585f11=getBotsWithMode();let _0x328cd0=_0x17effe(0x326);config[_0x17effe(0x219)](_0x31992a=>{const _0x5d5762=_0x17effe,_0x1a2023=_0x585f11[_0x5d5762(0x1cc)](_0x3171ad=>_0x3171ad[_0x5d5762(0x2fb)]==_0x31992a['botID'])[_0x5d5762(0x1b4)];_0x328cd0+=_0x5d5762(0x2c9)+_0x31992a[_0x5d5762(0x2fb)]+':\x20'+_0x31992a[_0x5d5762(0x30c)]+_0x5d5762(0x351)+_0x1a2023+_0x5d5762(0x351)+_0x31992a[_0x5d5762(0x2ef)]+'\x0a';}),_0x328cd0+='\x0a',_0x328cd0+=_0x17effe(0x224),_0x328cd0+=!settings[_0x17effe(0x28b)]?_0x17effe(0x20a):_0x17effe(0x1d4),_0x328cd0+=settings['telegramEnabled']?settings[_0x17effe(0x311)]==_0x17effe(0x2bf)?_0x17effe(0x345):_0x17effe(0x32a)+settings[_0x17effe(0x311)]+_0x17effe(0x324):'',await sendTelegram(_0x4c965e[_0x17effe(0x236)]['id'],_0x328cd0,{'parse_mode':_0x17effe(0x26d)});}),tgBot[_0x53ae41(0x362)](_0x53ae41(0x376),async _0x40a0c8=>{const _0x4b110b=_0x53ae41,_0x5c5c90=getEnabledBots();if(_0x5c5c90[_0x4b110b(0x2be)]==0x0)await sendTelegram(_0x40a0c8[_0x4b110b(0x236)]['id'],_0x4b110b(0x31f));else{if(_0x5c5c90[_0x4b110b(0x2be)]>0x1)_0x5c5c90[_0x4b110b(0x25d)]({'botID':_0x4b110b(0x2bf)});let _0x441965=[],_0x37cae1=[];const _0x15fd9c=_0x5c5c90[_0x4b110b(0x2be)]%0x4==0x0||_0x5c5c90[_0x4b110b(0x2be)]%0x4==0x3||_0x5c5c90[_0x4b110b(0x2be)]%0x3==0x1?0x4:0x3;let _0x59b275=0x0;_0x5c5c90[_0x4b110b(0x219)]((_0x188ce2,_0x563616)=>{const _0x590e22=_0x4b110b;if(_0x563616%_0x15fd9c==0x0)_0x37cae1=[];_0x37cae1[_0x590e22(0x25d)](Markup[_0x590e22(0x36a)]['callback'](_0x188ce2[_0x590e22(0x2fb)]=='all'?_0x590e22(0x256):_0x590e22(0x2c9)+_0x188ce2[_0x590e22(0x2fb)],_0x590e22(0x229)+_0x188ce2['botID'])),_0x563616%_0x15fd9c==0x0&&(_0x441965[_0x59b275]=_0x37cae1,_0x59b275++);});const _0x114af0=Markup[_0x4b110b(0x31e)](_0x441965);_0x40a0c8[_0x4b110b(0x18e)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x114af0);}}),tgBot[_0x53ae41(0x17a)](/restart_(.+)/,async _0x536af7=>{const _0x1f84dc=_0x53ae41,_0x1b1e00=_0x536af7[_0x1f84dc(0x258)][0x1];_0x536af7[_0x1f84dc(0x227)](),_0x1b1e00=='all'?config[_0x1f84dc(0x219)](_0x23d06e=>{const _0x53d36a=_0x1f84dc;restartBot(_0x23d06e[_0x53d36a(0x2fb)]);}):restartBot(_0x1b1e00);}),tgBot[_0x53ae41(0x362)]('on',async _0x1ff80c=>{const _0x157f3d=_0x53ae41,_0x265e06=getDisabledBots();if(_0x265e06[_0x157f3d(0x2be)]==0x0)await sendTelegram(_0x1ff80c[_0x157f3d(0x236)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x265e06[_0x157f3d(0x2be)]>0x1)_0x265e06[_0x157f3d(0x25d)]({'botID':_0x157f3d(0x2bf)});let _0x310294=[],_0x172699=[];const _0x2f0ddb=_0x265e06[_0x157f3d(0x2be)]%0x4==0x0||_0x265e06[_0x157f3d(0x2be)]%0x4==0x3||_0x265e06[_0x157f3d(0x2be)]%0x3==0x1?0x4:0x3;let _0x59e767=0x0;_0x265e06[_0x157f3d(0x219)]((_0x4cad6f,_0x14f0a0)=>{const _0x56190e=_0x157f3d;if(_0x14f0a0%_0x2f0ddb==0x0)_0x172699=[];_0x172699[_0x56190e(0x25d)](Markup[_0x56190e(0x36a)]['callback'](_0x4cad6f[_0x56190e(0x2fb)]==_0x56190e(0x2bf)?_0x56190e(0x256):_0x56190e(0x2c9)+_0x4cad6f['botID'],_0x56190e(0x2ae)+_0x4cad6f[_0x56190e(0x2fb)])),_0x14f0a0%_0x2f0ddb==0x0&&(_0x310294[_0x59e767]=_0x172699,_0x59e767++);});const _0x5a8e91=Markup[_0x157f3d(0x31e)](_0x310294);_0x1ff80c[_0x157f3d(0x18e)](_0x157f3d(0x1a7),_0x5a8e91);}}),tgBot[_0x53ae41(0x17a)](/on_(.+)/,async _0x599b11=>{const _0x250eaa=_0x53ae41,_0x4b61e3=_0x599b11[_0x250eaa(0x258)][0x1];_0x599b11[_0x250eaa(0x227)]();if(_0x4b61e3=='all'){const _0x40d7c6=getDisabledBots();await sendTelegram(_0x599b11[_0x250eaa(0x236)]['id'],_0x250eaa(0x197)),_0x40d7c6['forEach'](_0x3bc8e9=>{const _0x3b3f7c=_0x250eaa;if(_0x3bc8e9[_0x3b3f7c(0x2fb)]!=_0x3b3f7c(0x2bf))toggleBot(_0x3bc8e9['botID'],toggleStatus(_0x3bc8e9[_0x3b3f7c(0x2fb)]),'stopped');});}else await sendTelegram(_0x599b11[_0x250eaa(0x236)]['id'],_0x250eaa(0x217)+_0x4b61e3),toggleBot(_0x4b61e3,toggleStatus(_0x4b61e3),'stopped');}),tgBot['command']('off',async _0x3dd716=>{const _0x1a3be9=_0x53ae41,_0x432d86=getEnabledBots();if(_0x432d86[_0x1a3be9(0x2be)]==0x0)await sendTelegram(_0x3dd716[_0x1a3be9(0x236)]['id'],_0x1a3be9(0x31f));else{if(_0x432d86[_0x1a3be9(0x2be)]>0x1)_0x432d86['push']({'botID':_0x1a3be9(0x2bf)});let _0x573ae6=[],_0x1371bd=[];const _0x3e6502=_0x432d86[_0x1a3be9(0x2be)]%0x4==0x0||_0x432d86[_0x1a3be9(0x2be)]%0x4==0x3||_0x432d86['length']%0x3==0x1?0x4:0x3;let _0x132f0a=0x0;_0x432d86[_0x1a3be9(0x219)]((_0x3bd575,_0x257a51)=>{const _0xe45fae=_0x1a3be9;if(_0x257a51%_0x3e6502==0x0)_0x1371bd=[];_0x1371bd[_0xe45fae(0x25d)](Markup[_0xe45fae(0x36a)][_0xe45fae(0x348)](_0x3bd575[_0xe45fae(0x2fb)]==_0xe45fae(0x2bf)?_0xe45fae(0x256):'Bot\x20'+_0x3bd575[_0xe45fae(0x2fb)],'off_'+_0x3bd575[_0xe45fae(0x2fb)])),_0x257a51%_0x3e6502==0x0&&(_0x573ae6[_0x132f0a]=_0x1371bd,_0x132f0a++);});const _0xdca5a3=Markup[_0x1a3be9(0x31e)](_0x573ae6);_0x3dd716[_0x1a3be9(0x18e)](_0x1a3be9(0x304),_0xdca5a3);}}),tgBot[_0x53ae41(0x17a)](/off_(.+)/,async _0x47b13c=>{const _0x5d2a68=_0x53ae41,_0x12b0a1=_0x47b13c[_0x5d2a68(0x258)][0x1];_0x47b13c[_0x5d2a68(0x227)]();if(_0x12b0a1==_0x5d2a68(0x2bf)){const _0x50a258=getEnabledBots();await sendTelegram(_0x47b13c[_0x5d2a68(0x236)]['id'],_0x5d2a68(0x1e6)),_0x50a258[_0x5d2a68(0x219)](_0x196472=>{const _0x34d671=_0x5d2a68;if(_0x196472[_0x34d671(0x2fb)]!=_0x34d671(0x2bf))toggleBot(_0x196472[_0x34d671(0x2fb)],toggleStatus(_0x196472[_0x34d671(0x2fb)]),_0x34d671(0x1b1));});}else await sendTelegram(_0x47b13c[_0x5d2a68(0x236)]['id'],_0x5d2a68(0x2a6)+_0x12b0a1),toggleBot(_0x12b0a1,toggleStatus(_0x12b0a1),_0x5d2a68(0x1b1));}),tgBot['command'](_0x53ae41(0x2b4),async _0x59b128=>{const _0x5c45fb=_0x53ae41,_0x1ea947=getEnabledBots();if(_0x1ea947[_0x5c45fb(0x2be)]==0x0)await sendTelegram(_0x59b128[_0x5c45fb(0x236)]['id'],_0x5c45fb(0x31f));else{if(_0x1ea947['length']>0x1){let _0xb04331=[],_0x2ec067=[];const _0x46f8f1=_0x1ea947['length']%0x4==0x0||_0x1ea947[_0x5c45fb(0x2be)]%0x4==0x3||_0x1ea947[_0x5c45fb(0x2be)]%0x3==0x1?0x4:0x3;let _0x3e6abd=0x0;_0x1ea947['forEach']((_0x58c75f,_0x135e11)=>{const _0x5f45ef=_0x5c45fb;if(_0x135e11%_0x46f8f1==0x0)_0x2ec067=[];_0x2ec067[_0x5f45ef(0x25d)](Markup[_0x5f45ef(0x36a)][_0x5f45ef(0x348)](_0x5f45ef(0x2c9)+_0x58c75f[_0x5f45ef(0x2fb)],_0x5f45ef(0x286)+_0x58c75f[_0x5f45ef(0x2fb)])),_0x135e11%_0x46f8f1==0x0&&(_0xb04331[_0x3e6abd]=_0x2ec067,_0x3e6abd++);});const _0x55477a=Markup[_0x5c45fb(0x31e)](_0xb04331);_0x59b128['reply'](_0x5c45fb(0x306),_0x55477a);}else{const _0x4b2b41=_0x1ea947[0x0]['botID'];if(pid[_0x4b2b41])pid[_0x4b2b41][_0x5c45fb(0x1c7)]({'function':_0x5c45fb(0x2e2),'args':null});}}}),tgBot[_0x53ae41(0x17a)](/metrics_(.+)/,async _0x1db8f1=>{const _0x35ab31=_0x53ae41,_0x145c12=_0x1db8f1['match'][0x1];_0x1db8f1[_0x35ab31(0x227)]();if(pid[_0x145c12])pid[_0x145c12][_0x35ab31(0x1c7)]({'function':'sendMetricsTelegram','args':null});}),tgBot['command']('portfolio',async _0x47e8f8=>{const _0x150ea7=_0x53ae41,_0x10a693=getEnabledBots();if(_0x10a693[_0x150ea7(0x2be)]==0x0)await sendTelegram(_0x47e8f8['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x10a693[_0x150ea7(0x2be)]>0x1){let _0x452307=[],_0x4276c2=[];const _0x599f5c=_0x10a693[_0x150ea7(0x2be)]%0x4==0x0||_0x10a693['length']%0x4==0x3||_0x10a693[_0x150ea7(0x2be)]%0x3==0x1?0x4:0x3;let _0x25f237=0x0;_0x10a693[_0x150ea7(0x219)]((_0x1820af,_0x3528ff)=>{const _0x2c3524=_0x150ea7;if(_0x3528ff%_0x599f5c==0x0)_0x4276c2=[];_0x4276c2[_0x2c3524(0x25d)](Markup[_0x2c3524(0x36a)][_0x2c3524(0x348)]('Bot\x20'+_0x1820af['botID'],_0x2c3524(0x2cb)+_0x1820af[_0x2c3524(0x2fb)])),_0x3528ff%_0x599f5c==0x0&&(_0x452307[_0x25f237]=_0x4276c2,_0x25f237++);});const _0x26dce4=Markup[_0x150ea7(0x31e)](_0x452307);_0x47e8f8['reply']('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x26dce4);}else{const _0x3fd57d=_0x10a693[0x0][_0x150ea7(0x2fb)];if(pid[_0x3fd57d])pid[_0x3fd57d][_0x150ea7(0x1c7)]({'function':_0x150ea7(0x1a3),'args':null});}}}),tgBot[_0x53ae41(0x17a)](/portfolio_(.+)/,async _0x1907d1=>{const _0x317c98=_0x53ae41,_0x28dea0=_0x1907d1['match'][0x1];_0x1907d1[_0x317c98(0x227)]();if(pid[_0x28dea0])pid[_0x28dea0][_0x317c98(0x1c7)]({'function':'sendPortfolioTelegram','args':null});}),tgBot['command']('update',async _0xd4317f=>{const _0x493bbc=_0x53ae41;await getMessages();if(!updateAvailable)await sendTelegram(_0xd4317f['chat']['id'],_0x493bbc(0x29f));else{if(!validInstallation)await sendTelegram(_0xd4317f[_0x493bbc(0x236)]['id'],_0x493bbc(0x188));else{const _0x235ff7=Markup[_0x493bbc(0x31e)]([Markup[_0x493bbc(0x36a)]['callback'](_0x493bbc(0x268),_0x493bbc(0x185)),Markup[_0x493bbc(0x36a)][_0x493bbc(0x348)]('No',_0x493bbc(0x25e))]);_0xd4317f[_0x493bbc(0x18e)](_0x493bbc(0x21f),_0x235ff7);}}}),tgBot[_0x53ae41(0x17a)](/update_(.+)/,async _0x3432ac=>{const _0x1c50b6=_0x53ae41,_0x19f172=_0x3432ac[_0x1c50b6(0x258)][0x1];_0x3432ac[_0x1c50b6(0x227)](),_0x19f172=='yes'&&(await sendTelegram(_0x3432ac[_0x1c50b6(0x236)]['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB('update')),_0x19f172=='no'&&await sendTelegram(_0x3432ac[_0x1c50b6(0x236)]['id'],_0x1c50b6(0x27f));}),tgBot['command'](_0x53ae41(0x216),async _0x433207=>{const _0x315de7=_0x53ae41;if(!validInstallation)await sendTelegram(_0x433207[_0x315de7(0x236)]['id'],_0x315de7(0x234));else{const _0xe25fed=Markup[_0x315de7(0x31e)]([Markup[_0x315de7(0x36a)][_0x315de7(0x348)](_0x315de7(0x268),_0x315de7(0x2d1)),Markup[_0x315de7(0x36a)]['callback']('No',_0x315de7(0x36b))]);_0x433207['reply'](_0x315de7(0x27e),_0xe25fed);}}),tgBot['action'](/reinstall_(.+)/,async _0x5bd661=>{const _0x437ccc=_0x53ae41,_0x5154b9=_0x5bd661[_0x437ccc(0x258)][0x1];_0x5bd661[_0x437ccc(0x227)](),_0x5154b9==_0x437ccc(0x1b6)&&(await sendTelegram(_0x5bd661[_0x437ccc(0x236)]['id'],_0x437ccc(0x218)),updateBB(_0x437ccc(0x216))),_0x5154b9=='no'&&await sendTelegram(_0x5bd661[_0x437ccc(0x236)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot['command'](_0x53ae41(0x179),async _0xd3c697=>{const _0x535e99=_0x53ae41,_0x38cf1d=getBotsWithMode();if(_0x38cf1d['length']==0x0)await sendTelegram(_0xd3c697[_0x535e99(0x236)]['id'],_0x535e99(0x31f));else{let _0x5f1be1=[],_0x70b4a9=[];const _0x577c9c=0x2;let _0xcfb7ba=0x0;_0x38cf1d['forEach']((_0x416fd2,_0x32d873)=>{const _0x16e3b4=_0x535e99;if(_0x32d873%_0x577c9c==0x0)_0x70b4a9=[];_0x70b4a9[_0x16e3b4(0x25d)](Markup[_0x16e3b4(0x36a)][_0x16e3b4(0x348)]('Bot\x20'+_0x416fd2[_0x16e3b4(0x2fb)]+'\x20('+_0x416fd2[_0x16e3b4(0x1b4)]+')',_0x16e3b4(0x2aa)+_0x416fd2['botID'])),_0x32d873%_0x577c9c==0x0&&(_0x5f1be1[_0xcfb7ba]=_0x70b4a9,_0xcfb7ba++);});const _0x161bf9=Markup[_0x535e99(0x31e)](_0x5f1be1);_0xd3c697['reply'](_0x535e99(0x1f8),_0x161bf9);}}),tgBot['action'](/toggle_(.+)/,async _0x5e6886=>{const _0x1eacf0=_0x53ae41,_0x32d732=_0x5e6886[_0x1eacf0(0x258)][0x1];_0x5e6886[_0x1eacf0(0x227)]();const _0x47cf6b=getBotsWithMode(),_0x4a6e93=_0x47cf6b[_0x1eacf0(0x1cc)](_0x514e33=>_0x514e33[_0x1eacf0(0x2fb)]==_0x32d732),_0x3012fd=_0x4a6e93[_0x1eacf0(0x1b4)]==_0x1eacf0(0x323)?_0x1eacf0(0x1b0):_0x1eacf0(0x323);await sendTelegram(_0x5e6886[_0x1eacf0(0x236)]['id'],_0x1eacf0(0x1d7)+_0x32d732+_0x1eacf0(0x356)+_0x3012fd+_0x1eacf0(0x25b)),toggleBotMode(_0x32d732);}),tgBot[_0x53ae41(0x362)](_0x53ae41(0x2ff),async _0x237aa1=>{const _0xdee92d=_0x53ae41;let _0x827317='';config[_0xdee92d(0x219)](_0xc1c9f3=>{const _0x3d84c4=_0xdee92d;_0x827317+=_0x3d84c4(0x2c9)+_0xc1c9f3[_0x3d84c4(0x2fb)]+':\x20'+_0xc1c9f3[_0x3d84c4(0x1e3)]+'\x0a';}),await sendTelegram(_0x237aa1[_0xdee92d(0x236)]['id'],_0x827317,{'parse_mode':'HTML'});}),tgBot['command'](_0x53ae41(0x281),async _0xcdba8=>{const _0x5fe0d8=_0x53ae41;await sendTelegram(_0xcdba8[_0x5fe0d8(0x236)]['id'],_0xe737d6);}),process[_0x53ae41(0x2c3)](_0x53ae41(0x354),()=>tgBot[_0x53ae41(0x2bc)](_0x53ae41(0x354))),process[_0x53ae41(0x2c3)](_0x53ae41(0x226),()=>tgBot['stop'](_0x53ae41(0x226))),tgBot[_0x53ae41(0x261)]();}}function disableTelegram(){const _0x136b6e=_0x14cc10;tgBot&&tgBot[_0x136b6e(0x2bc)]();}async function sendTelegram(_0x7cd60a,_0x3184aa,_0x192d9c){const _0x4e5b8e=_0x14cc10;try{await tgBot[_0x4e5b8e(0x1f4)][_0x4e5b8e(0x21c)](_0x7cd60a,_0x3184aa,_0x192d9c);}catch(_0x597b44){console[_0x4e5b8e(0x192)](_0x4e5b8e(0x1be),_0x597b44);}}async function sendTelegramBot(_0x581da0,_0x262516){const _0x5bae74=_0x14cc10;if(settings[_0x5bae74(0x28b)]){if(settings[_0x5bae74(0x311)]==_0x5bae74(0x2bf)||(_0x262516[_0x5bae74(0x2e1)]==_0x5bae74(0x1dd)||_0x262516[_0x5bae74(0x2e1)]==_0x5bae74(0x29d)||_0x262516[_0x5bae74(0x2e1)]=='success')&&settings[_0x5bae74(0x311)]==_0x5bae74(0x34b)||_0x262516[_0x5bae74(0x2e1)]==_0x5bae74(0x174)&&settings[_0x5bae74(0x311)]=='orders'){if(tgBot&&settings[_0x5bae74(0x325)]){if(_0x262516[_0x5bae74(0x321)])await sendTelegram(settings[_0x5bae74(0x325)],_0x262516['botname']+_0x5bae74(0x372)+_0x262516[_0x5bae74(0x273)]);else await sendTelegram(settings['telegramChatId'],_0x5bae74(0x2c9)+_0x581da0+'\x20>\x20'+_0x262516[_0x5bae74(0x273)]);}}}}async function sendTelegramMsg(_0x5acbf3,_0x5528ac='HTML'){const _0xd54fc6=_0x14cc10;return settings[_0xd54fc6(0x28b)]&&tgBot&&settings[_0xd54fc6(0x325)]?(await sendTelegram(settings[_0xd54fc6(0x325)],_0x5acbf3,{'parse_mode':_0x5528ac}),!![]):![];}function getDeviceWithIp(_0x6115ac){const _0x3629a3=_0x14cc10;return devices[_0x3629a3(0x1cc)](_0x4a9e31=>_0x4a9e31['ip']===_0x6115ac);}async function temporaryAccess2FA(_0x5af3eb,_0x24f82a){const _0x4e7d2c=_0x14cc10;let _0xe3fe30=new Date(),_0x42d949=![];if(lastIpApproval){if(_0xe3fe30-lastIpApproval<0x1388)_0x42d949=!![];}lastIpApproval=new Date();if(_0x42d949)return;if(tgBot&&settings[_0x4e7d2c(0x325)]){const _0x3a9b3e=uuidRandom();tmpStorage[_0x3a9b3e]={'uuid':_0x5af3eb,'externalip':_0x24f82a};const _0x5d0e5b=Markup[_0x4e7d2c(0x31e)]([Markup[_0x4e7d2c(0x36a)][_0x4e7d2c(0x348)](_0x4e7d2c(0x27c),'tempaccess_5_'+_0x3a9b3e),Markup[_0x4e7d2c(0x36a)][_0x4e7d2c(0x348)]('15\x20min',_0x4e7d2c(0x2b5)+_0x3a9b3e),Markup[_0x4e7d2c(0x36a)][_0x4e7d2c(0x348)](_0x4e7d2c(0x33b),_0x4e7d2c(0x346)+_0x3a9b3e),Markup[_0x4e7d2c(0x36a)][_0x4e7d2c(0x348)](_0x4e7d2c(0x340),_0x4e7d2c(0x19b)+_0x3a9b3e)]);await sendTelegram(settings[_0x4e7d2c(0x325)],_0x4e7d2c(0x23a)+normalizeIP(_0x24f82a)[_0x4e7d2c(0x2a5)]+'\x20?',_0x5d0e5b),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x40baed=>{const _0x5e0c2a=_0x4e7d2c,_0x1dcdc4=_0x40baed[_0x5e0c2a(0x258)][0x1],_0x1f4557=_0x40baed[_0x5e0c2a(0x258)][0x2],{uuid:_0x498753,externalip:_0x2ddb6b}=tmpStorage[_0x1f4557];delete tmpStorage[_0x1f4557],_0x40baed[_0x5e0c2a(0x227)](),devices[_0x498753][_0x5e0c2a(0x262)]={'clientip':_0x2ddb6b,'timestamp':new Date()[_0x5e0c2a(0x272)](),'expiry':_0x1dcdc4},_0x1dcdc4!=_0x5e0c2a(0x340)?(await sendTelegram(_0x40baed[_0x5e0c2a(0x236)]['id'],_0x5e0c2a(0x277)+_0x1dcdc4+_0x5e0c2a(0x2b1),{'parse_mode':_0x5e0c2a(0x26d)}),io['to'](_0x498753)[_0x5e0c2a(0x1bd)](_0x5e0c2a(0x30c),{'access':{'allow':![],'reason':_0x5e0c2a(0x203),'token':null}})):(await sendTelegram(_0x40baed[_0x5e0c2a(0x236)]['id'],_0x5e0c2a(0x1d3)),io['to'](_0x498753)[_0x5e0c2a(0x1bd)](_0x5e0c2a(0x30c),{'access':{'allow':![],'reason':_0x5e0c2a(0x237),'token':null}}));});}}async function loginAccess2FA(_0x3ef734,_0x3d6928){const _0x2abe27=_0x14cc10;if(tgBot&&settings['telegramChatId']){const _0x319d87=uuidRandom();tmpStorage[_0x319d87]={'uuid':_0x3ef734,'externalip':_0x3d6928};const _0x2edbfd=Markup[_0x2abe27(0x31e)]([Markup['button'][_0x2abe27(0x348)](_0x2abe27(0x31a),_0x2abe27(0x316)+loginExpiry+'_'+_0x319d87),Markup[_0x2abe27(0x36a)]['callback'](_0x2abe27(0x340),_0x2abe27(0x295)+_0x319d87)]);await sendTelegram(settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x3d6928)[_0x2abe27(0x2a5)]+'\x20?',_0x2edbfd),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x18b3b1=>{const _0x59d979=_0x2abe27,_0x281963=_0x18b3b1[_0x59d979(0x258)][0x1],_0x33596e=_0x18b3b1[_0x59d979(0x258)][0x2],{uuid:_0x505976,externalip:_0xf43dc7}=tmpStorage[_0x33596e];delete tmpStorage[_0x33596e],_0x18b3b1[_0x59d979(0x227)](),devices[_0x505976][_0x59d979(0x36e)]={'clientip':_0xf43dc7,'timestamp':new Date()[_0x59d979(0x272)](),'expiry':_0x281963},_0x281963!=_0x59d979(0x340)?(await sendTelegram(_0x18b3b1[_0x59d979(0x236)]['id'],_0x59d979(0x1c4),{'parse_mode':_0x59d979(0x26d)}),io['to'](_0x505976)[_0x59d979(0x1bd)](_0x59d979(0x30c),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x18b3b1['chat']['id'],'Login\x20rejected'),io['to'](_0x505976)[_0x59d979(0x1bd)](_0x59d979(0x30c),{'access':{'allow':![],'reason':_0x59d979(0x2ac),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1b1735=_0x14cc10;return dbConfig[_0x1b1735(0x2e6)]('bots')[_0x1b1735(0x1ec)](_0x1b1735(0x2fb))[_0x1b1735(0x241)]({'status':_0x1b1735(0x2bd)})[_0x1b1735(0x2bb)]()||[];}function getDisabledBots(){const _0x162d21=_0x14cc10;return dbConfig[_0x162d21(0x2e6)](_0x162d21(0x2ee))[_0x162d21(0x1ec)](_0x162d21(0x2fb))[_0x162d21(0x241)]({'status':'disabled'})[_0x162d21(0x2bb)]()||[];}function getBotAttributes(_0x46c3e9){const _0x63758d=_0x14cc10;let _0x47627d={};const _0x447361=configpath+_0x63758d(0x1f9)+_0x46c3e9+_0x63758d(0x307),_0xad71a=fs[_0x63758d(0x2e5)](_0x447361);if(_0xad71a){const _0xd3064b=fs[_0x63758d(0x266)](_0x447361);try{const _0x5a6c76=JSON[_0x63758d(0x2d9)](_0xd3064b),_0x479f06=_0x5a6c76?_0x5a6c76[_0x63758d(0x303)][0x0][_0x63758d(0x2c1)]:![];_0x47627d[_0x63758d(0x1b4)]=_0x479f06?_0x63758d(0x323):_0x63758d(0x1b0),_0x47627d['botname']=_0x5a6c76?_0x5a6c76['bot'][0x0]['botname']:_0x63758d(0x2c9)+_0x46c3e9;}catch(_0x46f205){_0x47627d[_0x63758d(0x1b4)]=_0x63758d(0x1b0),_0x47627d[_0x63758d(0x1e3)]='Bot\x20'+_0x46c3e9;}}else _0x47627d[_0x63758d(0x1b4)]='manual',_0x47627d[_0x63758d(0x1e3)]=_0x63758d(0x2c9)+_0x46c3e9;return _0x47627d;}function getBotsWithMode(){const _0x15b2e4=_0x14cc10,_0x23df08=dbConfig['get'](_0x15b2e4(0x2ee))['sortBy']('botID')[_0x15b2e4(0x2bb)]()||[];return _0x23df08[_0x15b2e4(0x219)](_0x5dbf4d=>{const _0x3c8dfe=_0x15b2e4;let _0x1b2327=getBotAttributes(_0x5dbf4d[_0x3c8dfe(0x2fb)]);_0x5dbf4d[_0x3c8dfe(0x1b4)]=_0x1b2327[_0x3c8dfe(0x1b4)];}),_0x23df08;}function getBotExchanges(){const _0x30278c=_0x14cc10;let _0x1b3522=[];const _0x5c7d87=dbConfig[_0x30278c(0x2e6)]('bots')[_0x30278c(0x1ec)]('botID')[_0x30278c(0x2bb)]()||[];_0x5c7d87[_0x30278c(0x219)](_0x1ff582=>{const _0xf1512b=_0x30278c;if(_0x1ff582[_0xf1512b(0x30c)]==_0xf1512b(0x2bd)){const _0x58dd88=configpath+'bot-'+_0x1ff582[_0xf1512b(0x2fb)]+_0xf1512b(0x307),_0x1a04ee=fs[_0xf1512b(0x2e5)](_0x58dd88);let _0x318dd9;if(_0x1a04ee){const _0xa071ed=fs['readFileSync'](_0x58dd88);try{const _0x1e7c58=JSON[_0xf1512b(0x2d9)](_0xa071ed);_0x318dd9=_0x1e7c58?_0x1e7c58[_0xf1512b(0x303)][0x0][_0xf1512b(0x249)]:null;}catch(_0x14f321){}}if(_0x318dd9)_0x1b3522[_0xf1512b(0x25d)](_0x318dd9);}});const _0x3e47b5=[...new Set(_0x1b3522)]['sort']();return _0x3e47b5;}function _0x4094(){const _0x4a671f=['sendMessage','-----------------------------------------------------------------------------------','verify','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','connected','static','logout','tkn','<b>Telegram\x20Bot\x20Status:</b>\x0a','backup-full','SIGTERM','editMessageReplyMarkup','settings.','restart_','node-zip','map','whitelist','2bGMKKw','logs/','logged\x20out','files','Session\x20expired\x20for\x20user\x20...','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','************','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','disabled','chat','temporary\x20access\x20rejected','#RES#\x20','whitelistEnabled','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','running','environment','stringify','lowdb','set','max','filter','/:bot/support','Logged\x20out\x20user\x20...','alias','1051949Xnkgds','\x1b[36m','expiry','output-000.log','exchange','place-order','Error\x20while\x20deleting\x20config\x20files:\x20','reason','debug','generate','blacklist','Disabled\x20Bot\x20','update','toString','track','Token\x20blacklisted','bb-secure.json','All\x20bots','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','match','/:bot/coins','store','\x20mode','pidExpireLogin','push','update_no','::1','build','launch','telegramIpApproval','isValid','BM\x20received\x20sigint\x20signal','slice','readFileSync','botmanager','Yes','removeAllListeners','Backup\x20file\x20uploaded','/status\x20-\x20show\x20bot(s)\x20status\x0a','bbvReceive','HTML','storeFiat','Error:\x20Invalid\x20argument\x20','test','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','getTime','event','host','lastmsgtelegram','toIPv4MappedAddress','Access\x20enabled\x20for\x20','graphql-request','0.0.0','started','isDirectory','5\x20min','copyFileSync','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','backup-files','help','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','randomBytes','config_alerts','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','metrics_','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','compareSync','570ZfokHs','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','telegramEnabled','-events.json','statSync','bbPassword','/enable\x20-\x20enable\x20notifications\x0a','name','exit','access','Enabled\x20Bot\x20','login\x20token\x20generated','login2fa_reject_','output-002.log','headers','/update\x20-\x20update\x20Balance\x20Bot\x0a','Restore\x20process\x20confirmed','kind','Unauthorized\x20attempt\x20to\x20get\x20messages','server','warning','telegraf','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Invalid\x20username\x20or\x20IP\x20address','apiSecret','-performance.json','http','auth','show','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','constructor','referer','config/','toggle_','reset-history','2FA\x20login\x20rejected','init','on_','Unauthorized\x20attempt\x20to\x20download\x20','enable','\x20minutes','hybrid-crypto-js','f2aRequired','metrics','tempaccess_15_','Starting\x20#RED#Balance\x20Bot\x20v','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','sockets','cancel-loading','File\x20uploaded','value','stop','enabled','length','all','socket','headless','loginRequired','once','writeFileSync','express-fileupload','Unauthorized\x20attempt\x20to\x20log\x20out','Logged\x20in\x20user\x20...','port','Bot\x20','Notifications\x20disabled','portfolio_','internal','index.html','listen','write','bot.js','reinstall_yes','remove','Restarting\x20Bot\x20','backup-full.zip','timeshift','login\x20not\x20required','update-bot','/:bot','parse','private','2FA\x20login\x20required','\x1b[33m','bb-settings.json','secure','store-settings','family','type','sendMetricsTelegram','cancelLoading','hasOwnProperty','existsSync','get','secret','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','getMonth','apiPassword','(staging)','remoteAddress','bots','live','Unauthorized\x20attempt\x20to\x20delete\x20alerts','storeHeadless','createServer','jsonwebtoken','4335088irTKRI','uuid-random','use','backup/','132aCVRgj','updatebotmanager','NTBA_FIX_319','botID','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','text','child_process','names','password','\x1b[0m','mkdirSync','bot','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','-config.json','build2','generateKeyPairAsync','.zip','deleteHistoryAlerts','status','args','Restore\x20process\x20aborted','lastmsgemitted','sign','telegramEvents','/:bot/performance','127.0.0.1','replace','connection','login2fa_','Unauthorized\x20attempt\x20to\x20store\x20configuration','bbvNew','output-001.log','accept','join','Alerts','hashSync','inlineKeyboard','No\x20bots\x20running\x20right\x20now','restore-backup-file','showname','simple','auto','\x20only\x0a','telegramChatId','<b>Balance\x20Bot\x20Status:</b>\x0a','readdirSync','29041353TPrMlH','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Notifications\x20types:\x20','temporaryAccessAllowed','title','\x20|\x20client:\x20...','access\x20timeout','crypto','file','version','get-portfolio','/:bot/configuration','login','https://api.ipify.org?format=json','(((.+)+)+)+$','allow','uuid','string','timestamp','30\x20min','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','privateKey','880455npdYSt','get-backup-files','reject','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','messages','axios','argv','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','tempaccess_30_','Ok,\x20will\x20send\x20alert\x20notifications\x20only','callback','#RES#\x20if\x20running\x20on\x20server','endsWith','alerts','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','yargs/yargs','***','\x20|\x20','temp/','Unauthorized\x20attempt\x20to\x20confirm\x20message','SIGINT','unlinkSync','\x20to\x20','new','kill','You\x20can\x20use\x20the\x20following\x20commands:\x0a','resetHistory','=>\x20Go\x20to\x20#CYA#http://','padStart','config_orders','187983oEcCEC','notification','Unauthorized\x20login\x20attempt\x20(timeout)','disconnect','command','Telegraf\x20error:','/on\x20-\x20start\x20bot(s)\x0a','apply','bbUsername','mixpanel','All','isIPv4MappedAddress','button','reinstall_no','\x1b[35m','getSeconds','telegram2FaApproval','env','getUTCHours','ipaddr.js','\x20>\x20','-results.json','Bot\x20Mgr\x20>\x20',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','restart','ipc','emitHistory','token','419664WvTViA','Starting\x20(','ipv6','telegrammsg','pidRefreshToken','randomFillSync','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','startsWith','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','api-eu.mixpanel.com','config','handshake','get-starting-balances','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','apiKey','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','order','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','/:bot/portfolio','resetpw_no','/:bot/history','toggle','action','full','*$1*','/metrics\x20-\x20show\x20bot\x20performance\x0a','Password\x20reset\x20rejected','backup-full@','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','BM\x20received\x20sigterm\x20signal','add','IPv4','store-configuration','update_yes','Failed\x20to\x20download\x20','Backup\x20file\x20unzipped\x20and\x20stored','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update',')\x20|\x20Bot\x20','clients','restore_yes_','backup','versions','reply','1000','search','config_all','log','Setting\x20access:\x20','toIPv4Address','assign','number','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','entries','getDate','BM\x20received\x20exit\x20signal','tempaccess_reject_','settings','success','telegramToken','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','socket.io','orders','reset-password','sendPortfolioTelegram','Unauthorized\x20attempt\x20to\x20delete\x20bot','toggleBotMode','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','::ffff:127.0.0.1','latestversion','Starting\x20new\x20bot\x20|\x20Bot\x20','RSA-OAEP','temporary\x20token\x20generated','exp','onepagemode','defaults','manual','stopped','DEFLATE','storeConfiguration','mode','start','yes','Invalid\x20IP\x20address','userid',':\x20Bot\x20Mgr\x20>\x20','Unauthorized\x20attempt\x20to\x20add\x20bot','\x20(2)','version.json','emit','Telegram\x20error:','getHours','[ip-address]','getFullYear','temporary\x20access\x20not\x20allowed','from','Login\x20accepted','inherit','\x20(1)','send','24oXmHZg','invalid\x20credentials','confirm-message','update-bb','find','cloneDeep','catch','address','zip/','min','Markdown','Temporary\x20access\x20rejected','Notifications\x20enabled\x0a','/off\x20-\x20stop\x20bot(s)\x0a','format','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','186648JaaQff','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','sendFile','/start','error','function','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','store-fiat','_data','date-fns','botname','uncaughtException','get-messages','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','/names\x20-\x20show\x20bot\x20names\x0a','clientip','split','keys','reinstall-bb','sortBy','2FA','getMinutes','User\x20has\x20been\x20validated','fork','getPortfolio','\x1b[34m','params','telegram',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','telegramUsername','sha256','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','bot-','sort','2FA\x20login\x20token\x20generated','Restore\x20backup\x20file\x20','show-config','/disable\x20-\x20disable\x20notifications\x0a','\x1b[31m','initclient','publicKey','new-disabled','reload','username','rmSync','resetpw_yes','Idling\x20(','delete-bot','2FA\x20required','Notifications\x20disabled\x0a','bcryptjs','size','No\x20authentication\x20token','Orders','Unauthorized\x20attempt\x20to\x20get\x20portfolio','decrypt','createWriteStream','then','message','login\x20required','binary','reinstall','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Starting\x20Balance\x20Bot\x20reinstallation','forEach','Crypt','toggle-bot-mode'];_0x4094=function(){return _0x4a671f;};return _0x4094();}async function initUser(){const _0x38da0a=_0x14cc10;if(!settings['userid']){const _0x395faa=uuidRandom();mixpanel[_0x38da0a(0x244)](_0x395faa),updateSetting(_0x38da0a(0x1b8),_0x395faa);}}async function initSecure(){const _0x45a8b5=_0x14cc10;let _0x3ba007=getSecure();if(!_0x3ba007[_0x45a8b5(0x2e4)](_0x45a8b5(0x2e7))){let _0x38a863=await generateKeys();_0x3ba007[_0x45a8b5(0x201)]=_0x38a863[_0x45a8b5(0x201)],_0x3ba007['privateKey']=_0x38a863[_0x45a8b5(0x33d)],_0x3ba007[_0x45a8b5(0x2e7)]=crypto[_0x45a8b5(0x283)](0x20)[_0x45a8b5(0x252)]('hex');;storeSecure(_0x3ba007);}}function getSettings(){const _0xda7c41=_0x14cc10;return dbSettings[_0xda7c41(0x2e6)](_0xda7c41(0x19c))[_0xda7c41(0x2bb)]()||{};}function getSecure(){const _0x10d550=_0x14cc10;return dbSecure[_0x10d550(0x2e6)](_0x10d550(0x2de))[_0x10d550(0x2bb)]()||{};}function getBlacklist(){const _0x37a230=_0x14cc10;return dbSecure['get'](_0x37a230(0x24f))['value']()||[];}function broadcastToBots(_0x370d82,_0xf50f61){const _0x36ffc5=_0x14cc10;config[_0x36ffc5(0x219)](_0x382faa=>{const _0x1c19f3=_0x36ffc5;if(_0x382faa[_0x1c19f3(0x30c)]==_0x1c19f3(0x2bd)&&_0x382faa[_0x1c19f3(0x2ef)]=='running'||_0x382faa[_0x1c19f3(0x30c)]==_0x1c19f3(0x357)&&_0x382faa[_0x1c19f3(0x2ef)]==_0x1c19f3(0x23b)){if(pid[_0x382faa[_0x1c19f3(0x2fb)]])pid[_0x382faa[_0x1c19f3(0x2fb)]]['send']({[_0x370d82]:_0xf50f61});}});}function storeSettings(_0x1fea36,_0x2b5492=![]){const _0x4c7fd5=_0x14cc10;_0x1fea36={...settings,..._0x1fea36};if(_0x2b5492&&_0x1fea36['bbPassword']!=_0x4c7fd5(0x233)&&_0x1fea36[_0x4c7fd5(0x28e)]!=_0x4c7fd5(0x350)&&_0x1fea36['bbPassword']!=''){const _0x32d012=crypt['decrypt'](secure['privateKey'],_0x1fea36['bbPassword'])['message']['split']('@')[0x0],_0x49b713=bcrypt[_0x4c7fd5(0x31d)](_0x32d012,saltRounds);_0x1fea36={..._0x1fea36,'bbPassword':_0x49b713};}if(_0x2b5492&&_0x1fea36['telegramToken']!=_0x4c7fd5(0x233)&&_0x1fea36[_0x4c7fd5(0x19e)]!=_0x4c7fd5(0x350)&&_0x1fea36[_0x4c7fd5(0x19e)]!=''){const _0x5670fa=crypt[_0x4c7fd5(0x210)](secure[_0x4c7fd5(0x33d)],_0x1fea36[_0x4c7fd5(0x19e)])[_0x4c7fd5(0x213)][_0x4c7fd5(0x1e9)]('@')[0x0];_0x1fea36={..._0x1fea36,'telegramToken':_0x5670fa};}const _0x5e90be=_0x1fea36[_0x4c7fd5(0x19e)]!=_0x4c7fd5(0x233)&&_0x1fea36[_0x4c7fd5(0x19e)]!=settings[_0x4c7fd5(0x19e)]||_0x1fea36['telegramUsername']!=settings[_0x4c7fd5(0x1f6)],_0x46b4b7=_0x1fea36[_0x4c7fd5(0x19e)]==''||_0x1fea36[_0x4c7fd5(0x1f6)]=='';_0x5e90be&&(_0x1fea36['telegramChatId']=null,_0x1fea36[_0x4c7fd5(0x311)]=_0x4c7fd5(0x2bf));for(const [_0xf05014,_0x23e239]of Object[_0x4c7fd5(0x198)](_0x1fea36)){if(_0xf05014==_0x4c7fd5(0x19e)&&_0x23e239=='************'){_0x1fea36[_0x4c7fd5(0x19e)]=settings[_0x4c7fd5(0x19e)];continue;};if(_0xf05014==_0x4c7fd5(0x28e)&&_0x23e239=='************'){_0x1fea36[_0x4c7fd5(0x28e)]=settings[_0x4c7fd5(0x28e)];continue;};dbSettings['set']('settings.'+_0xf05014,_0x23e239)[_0x4c7fd5(0x2cf)]();}settings=_0x1fea36,io['to'](_0x4c7fd5(0x267))[_0x4c7fd5(0x1bd)](_0x4c7fd5(0x19c),cleanSettings()),broadcastToBots(_0x4c7fd5(0x2d5),settings[_0x4c7fd5(0x2d5)]),broadcastToBots('onepagemode',settings[_0x4c7fd5(0x1ae)]);if(_0x5e90be&&!_0x46b4b7)initTelegram();if(_0x5e90be&&_0x46b4b7)disableTelegram();getAllClients()[_0x4c7fd5(0x219)](_0x803a9b=>{const _0x1ad755=_0x4c7fd5;getSocket(_0x803a9b['id'])[_0x1ad755(0x1bd)](_0x1ad755(0x30c),{'access':{'allow':![],'reason':_0x1ad755(0x203),'token':null}});});}function updateSetting(_0x5772da,_0xc3f67a){const _0x2f84a9=_0x14cc10;dbSettings[_0x2f84a9(0x23f)](_0x2f84a9(0x228)+_0x5772da,_0xc3f67a)[_0x2f84a9(0x2cf)](),settings=getSettings(),io['to'](_0x2f84a9(0x267))[_0x2f84a9(0x1bd)](_0x2f84a9(0x19c),cleanSettings());}function storeSecure(_0x2dceb1){const _0x19cc5a=_0x14cc10;dbSecure[_0x19cc5a(0x2e6)](_0x19cc5a(0x2de))[_0x19cc5a(0x25d)](_0x2dceb1)[_0x19cc5a(0x2cf)](),secure=_0x2dceb1;}function addBlacklist(_0x5c10aa){const _0x486f5b=_0x14cc10;cleanBlacklist();let _0x189241;devices[_0x5c10aa]['telegramIpApproval']?_0x189241=Math[_0x486f5b(0x240)](devices[_0x5c10aa][_0x486f5b(0x262)][_0x486f5b(0x247)],loginExpiry):_0x189241=loginExpiry,dbSecure[_0x486f5b(0x2e6)](_0x486f5b(0x24f))['push']({'expiry':new Date()[_0x486f5b(0x272)]()+_0x189241*0x3c*0x3e8,'token':devices[_0x5c10aa][_0x486f5b(0x292)][_0x486f5b(0x379)]})[_0x486f5b(0x2cf)](),blacklist=dbSecure[_0x486f5b(0x2e6)](_0x486f5b(0x24f))[_0x486f5b(0x2bb)]();}function cleanBlacklist(){const _0x118656=_0x14cc10;let _0x33863e=dbSecure[_0x118656(0x2e6)]('blacklist')[_0x118656(0x1cd)]()[_0x118656(0x2bb)](),_0x2f00ec=new Date()[_0x118656(0x272)]();_0x33863e['forEach'](_0x4b93f9=>{const _0x33af2a=_0x118656;_0x4b93f9[_0x33af2a(0x247)]<_0x2f00ec&&dbSecure[_0x33af2a(0x2e6)](_0x33af2a(0x24f))[_0x33af2a(0x2d2)]({'expiry':_0x4b93f9[_0x33af2a(0x247)]})[_0x33af2a(0x2cf)]();});}function initStates(){let _0x255b46=getConfiguration();_0x255b46['forEach'](_0xc8fc7e=>{_0xc8fc7e['live']='stopped';}),storeConfiguration(_0x255b46);}function onKeys(){const _0x3b8413=new RSA();return new Promise(_0x18659b=>{const _0x1cad05=_0x161c;_0x3b8413[_0x1cad05(0x309)]()[_0x1cad05(0x212)](_0x123d8a=>{_0x18659b(_0x123d8a);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x19af1d=_0x14cc10;let _0x1c8775=getSettings(),_0x374f92=![];!_0x1c8775['hasOwnProperty'](_0x19af1d(0x275))&&(_0x1c8775[_0x19af1d(0x275)]=0x0,_0x374f92=!![]);!_0x1c8775[_0x19af1d(0x2e4)]('lastmsgemitted')&&(_0x1c8775[_0x19af1d(0x30f)]=0x0,_0x374f92=!![]);!_0x1c8775['hasOwnProperty'](_0x19af1d(0x1a9))&&(_0x1c8775[_0x19af1d(0x1a9)]='0.0.0',_0x374f92=!![]);!_0x1c8775[_0x19af1d(0x2e4)](_0x19af1d(0x1ae))&&(_0x1c8775[_0x19af1d(0x1ae)]=![],_0x374f92=!![]);if(_0x374f92)storeSettings(_0x1c8775);try{fs[_0x19af1d(0x327)](configbackuppath,{'withFileTypes':!![]})[_0x19af1d(0x219)](_0x1dce95=>{const _0x1f79e5=_0x19af1d;if(!_0x1dce95['isDirectory']()){if(!_0x1dce95[_0x1f79e5(0x290)][_0x1f79e5(0x16b)](_0x1f79e5(0x17f)))fs['unlinkSync'](configbackuppath+_0x1dce95[_0x1f79e5(0x290)]);}else fs[_0x1f79e5(0x205)](configbackuppath+_0x1dce95[_0x1f79e5(0x290)],{'recursive':!![]});});}catch(_0x3d74e9){logger['debug']('Error\x20removing\x20old\x20backup\x20files:',_0x3d74e9);}}function storeConfiguration(_0x1e65f3){const _0x4eaa4b=_0x14cc10;dbConfig[_0x4eaa4b(0x2e6)]('bots')['remove']()[_0x4eaa4b(0x2cf)](),dbConfig[_0x4eaa4b(0x2e6)](_0x4eaa4b(0x2ee))[_0x4eaa4b(0x25d)](..._0x1e65f3)[_0x4eaa4b(0x2cf)](),config=_0x1e65f3;}async function resetPassword(){const _0x22f764=_0x14cc10;if(tgBot&&settings['telegramChatId']){const _0x6e5862=Markup['inlineKeyboard']([Markup[_0x22f764(0x36a)][_0x22f764(0x348)](_0x22f764(0x1b6),_0x22f764(0x206)),Markup[_0x22f764(0x36a)][_0x22f764(0x348)]('no',_0x22f764(0x177))]);await sendTelegram(settings[_0x22f764(0x325)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x6e5862),tgBot[_0x22f764(0x17a)](/resetpw_(.+)/,async _0x43fdf9=>{const _0x58a39c=_0x22f764,_0x3daf00=_0x43fdf9[_0x58a39c(0x258)][0x1];_0x43fdf9[_0x58a39c(0x227)]();if(_0x3daf00!='no'){const _0x7d9983=0xf,_0x5f023a='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x347f08=Array[_0x58a39c(0x1c3)](crypto[_0x58a39c(0x37f)](new Uint32Array(_0x7d9983)))[_0x58a39c(0x22b)](_0x566860=>_0x5f023a[_0x566860%_0x5f023a[_0x58a39c(0x2be)]])['join'](''),_0x3b2cef=bcrypt[_0x58a39c(0x31d)](_0x347f08,saltRounds);storeSettings({'bbPassword':_0x3b2cef}),await sendTelegram(_0x43fdf9[_0x58a39c(0x236)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x347f08,{'parse_mode':_0x58a39c(0x26d)});}else await sendTelegram(_0x43fdf9['chat']['id'],_0x58a39c(0x17e));});}}async function confirmRestore(_0x14750c,_0x3e0e38){const _0x434b62=_0x14cc10;io['to'](_0x434b62(0x267))['emit'](_0x434b62(0x35f),_0x434b62(0x34c),_0x434b62(0x19d));if(tgBot&&settings[_0x434b62(0x325)]){const _0x2156b1=uuidRandom();tmpStorage[_0x2156b1]={'path':_0x14750c,'filename':_0x3e0e38};const _0x448123=Markup[_0x434b62(0x31e)]([Markup[_0x434b62(0x36a)][_0x434b62(0x348)](_0x434b62(0x1b6),_0x434b62(0x18b)+_0x2156b1),Markup[_0x434b62(0x36a)][_0x434b62(0x348)]('no','restore_no_'+_0x2156b1)]);await sendTelegram(settings[_0x434b62(0x325)],_0x434b62(0x341),_0x448123),tgBot[_0x434b62(0x17a)](/restore_(.+)_(.+)/,async _0x18c723=>{const _0x436884=_0x434b62,_0x98788f=_0x18c723[_0x436884(0x258)][0x1],_0x46d54e=_0x18c723[_0x436884(0x258)][0x2],{path:_0xc3f4b0,filename:_0x9a6b03}=tmpStorage[_0x46d54e];delete tmpStorage[_0x46d54e],_0x18c723[_0x436884(0x227)](),_0x98788f==_0x436884(0x1b6)?(logger[_0x436884(0x24d)](_0x436884(0x299)),await sendTelegram(_0x18c723[_0x436884(0x236)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x436884(0x26d)}),unzipFile(_0xc3f4b0,_0x9a6b03)):(logger[_0x436884(0x24d)](_0x436884(0x30e)),await sendTelegram(_0x18c723[_0x436884(0x236)]['id'],_0x436884(0x30e)));});}}function getServerTime(){const _0x51131e=_0x14cc10,_0x36e1b5=new Date();return _0x36e1b5[_0x51131e(0x1c1)]()+'/'+(_0x36e1b5['getMonth']()+0x1)[_0x51131e(0x252)]()[_0x51131e(0x35c)](0x2,'0')+'/'+_0x36e1b5[_0x51131e(0x199)]()[_0x51131e(0x252)]()[_0x51131e(0x35c)](0x2,'0')+'\x20'+_0x36e1b5[_0x51131e(0x1bf)]()[_0x51131e(0x252)]()[_0x51131e(0x35c)](0x2,'0')+':'+_0x36e1b5[_0x51131e(0x1ee)]()[_0x51131e(0x252)]()['padStart'](0x2,'0')+':'+_0x36e1b5[_0x51131e(0x36d)]()[_0x51131e(0x252)]()[_0x51131e(0x35c)](0x2,'0');}function getTimeStamp(){const _0x278c60=_0x14cc10,_0x57f68c=shiftedTime();return _0x57f68c[_0x278c60(0x1c1)]()+'/'+(_0x57f68c[_0x278c60(0x2ea)]()+0x1)[_0x278c60(0x252)]()[_0x278c60(0x35c)](0x2,'0')+'/'+_0x57f68c[_0x278c60(0x199)]()[_0x278c60(0x252)]()[_0x278c60(0x35c)](0x2,'0')+'\x20'+_0x57f68c[_0x278c60(0x1bf)]()[_0x278c60(0x252)]()[_0x278c60(0x35c)](0x2,'0')+':'+_0x57f68c[_0x278c60(0x1ee)]()[_0x278c60(0x252)]()['padStart'](0x2,'0')+':'+_0x57f68c[_0x278c60(0x36d)]()[_0x278c60(0x252)]()[_0x278c60(0x35c)](0x2,'0');}function getCleanTimeStamp(){const _0x53c6f9=_0x14cc10,_0xcfdc63=shiftedTime();return _0xcfdc63[_0x53c6f9(0x1c1)]()+(_0xcfdc63[_0x53c6f9(0x2ea)]()+0x1)[_0x53c6f9(0x252)]()[_0x53c6f9(0x35c)](0x2,'0')+_0xcfdc63[_0x53c6f9(0x199)]()[_0x53c6f9(0x252)]()[_0x53c6f9(0x35c)](0x2,'0')+'-'+_0xcfdc63[_0x53c6f9(0x1bf)]()[_0x53c6f9(0x252)]()[_0x53c6f9(0x35c)](0x2,'0')+_0xcfdc63[_0x53c6f9(0x1ee)]()[_0x53c6f9(0x252)]()[_0x53c6f9(0x35c)](0x2,'0')+_0xcfdc63[_0x53c6f9(0x36d)]()[_0x53c6f9(0x252)]()[_0x53c6f9(0x35c)](0x2,'0');}function shiftedTime(){const _0x59cca4=_0x14cc10,_0x57be52=new Date();let _0x58acf2=_0x57be52;if(settings[_0x59cca4(0x2d5)]&&settings[_0x59cca4(0x2d5)]!==0x0)_0x58acf2=fns[_0x59cca4(0x182)](_0x57be52,{'hours':settings[_0x59cca4(0x2d5)]});return _0x58acf2;}function startScheduler(){const _0x3a87d3=_0x14cc10,_0x10e021=new Date()[_0x3a87d3(0x370)](),_0x4eea93=shiftedTime()[_0x3a87d3(0x1bf)]();_0x4eea93==0x4&&backupConfigFiles();_0x4eea93==0x0&&rotateLogFiles();_0x10e021%0x6==0x0&&triggerAnalytics();_0x10e021%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0xad9089){const _0x1f9b86=_0x14cc10;logger[_0x1f9b86(0x24d)](_0x1f9b86(0x1fc)+_0xad9089);const _0x401ae8=getBotsWithMode();_0x401ae8[_0x1f9b86(0x2be)]>0x0?confirmRestore(configbackuppath,_0xad9089):unzipFile(configbackuppath,_0xad9089);}async function getBackupFiles(_0x31a4b1=null){const _0x3a8270=_0x14cc10;let _0x2ac7d1=[],_0x3fb185=fs[_0x3a8270(0x327)](configbackuppath,{'withFileTypes':!![]});_0x3fb185[_0x3a8270(0x1fa)]((_0x3def44,_0x931c4f)=>_0x3def44[_0x3a8270(0x290)]<_0x931c4f[_0x3a8270(0x290)]?0x1:_0x931c4f['name']<_0x3def44[_0x3a8270(0x290)]?-0x1:0x0),_0x3fb185['forEach'](_0x27b926=>{const _0x4ca21b=_0x3a8270;if(!_0x27b926[_0x4ca21b(0x27b)]()&&_0x27b926[_0x4ca21b(0x290)][_0x4ca21b(0x16b)](_0x4ca21b(0x17f))&&_0x27b926[_0x4ca21b(0x290)][_0x4ca21b(0x34a)]('.zip')){const _0x33fc94=formatDate(fs[_0x4ca21b(0x28d)](configbackuppath+_0x27b926[_0x4ca21b(0x290)])['mtime']);_0x2ac7d1[_0x4ca21b(0x25d)]({'name':_0x27b926['name'],'mtime':_0x33fc94});}});if(_0x31a4b1)io['to'](_0x31a4b1)[_0x3a8270(0x1bd)](_0x3a8270(0x280),_0x2ac7d1);else return _0x2ac7d1;}async function backupConfigFiles(){const _0x5d10df=_0x14cc10;await zipFiles(_0x5d10df(0x225));const _0x150363=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x5d10df(0x2d4),configbackuppath+(_0x5d10df(0x17f)+_0x150363+_0x5d10df(0x30a)));let _0x2db461=fs[_0x5d10df(0x327)](configbackuppath,{'withFileTypes':!![]});_0x2db461[_0x5d10df(0x1fa)]((_0x41d5b8,_0x43beeb)=>_0x41d5b8[_0x5d10df(0x290)]<_0x43beeb[_0x5d10df(0x290)]?0x1:_0x43beeb[_0x5d10df(0x290)]<_0x41d5b8['name']?-0x1:0x0),_0x2db461['length']>maxBackups&&fs[_0x5d10df(0x355)](configbackuppath+_0x2db461[_0x2db461[_0x5d10df(0x2be)]-0x1][_0x5d10df(0x290)]);}function rotateLogFiles(){const _0x30c150=_0x14cc10,_0x1636af=fs[_0x30c150(0x28d)](logspath+_0x30c150(0x248)),_0x17aad2=_0x1636af[_0x30c150(0x20c)]/0x400;if(_0x17aad2>0x64){let _0x2e9178=fs[_0x30c150(0x327)](logspath,{'withFileTypes':!![]});_0x2e9178[_0x30c150(0x1fa)]((_0x9d8b84,_0x3d52b6)=>_0x9d8b84[_0x30c150(0x290)]<_0x3d52b6[_0x30c150(0x290)]?0x1:_0x3d52b6['name']<_0x9d8b84['name']?-0x1:0x0),_0x2e9178[_0x30c150(0x219)](_0x1645e1=>{const _0x2825a8=_0x30c150;if(_0x1645e1[_0x2825a8(0x290)]==_0x2825a8(0x296))fs['copyFileSync'](logspath+_0x1645e1['name'],logspath+'output-003.log');if(_0x1645e1[_0x2825a8(0x290)]==_0x2825a8(0x319))fs[_0x2825a8(0x27d)](logspath+_0x1645e1[_0x2825a8(0x290)],logspath+_0x2825a8(0x296));_0x1645e1[_0x2825a8(0x290)]==_0x2825a8(0x248)&&(fs[_0x2825a8(0x27d)](logspath+_0x1645e1[_0x2825a8(0x290)],logspath+_0x2825a8(0x319)),fs[_0x2825a8(0x2c4)](logspath+_0x1645e1[_0x2825a8(0x290)],''));});}}async function zipFiles(_0x15e89d){const _0x3b383c=_0x14cc10;let _0x57b55e;if(_0x15e89d=='logs')_0x57b55e=logspath;if(_0x15e89d==_0x3b383c(0x18c))_0x57b55e=configpath;if(_0x15e89d==_0x3b383c(0x225))_0x57b55e=configpath;let _0x26619f=fs['readdirSync'](_0x57b55e,{'withFileTypes':!![]});const _0x522d2b=new require('node-zip')();_0x26619f[_0x3b383c(0x219)](_0x2b4894=>{const _0x4407d3=_0x3b383c;if(!_0x2b4894['isDirectory']()){let _0x4277bd=fs['readFileSync'](_0x57b55e+_0x2b4894[_0x4407d3(0x290)]);if(_0x15e89d==_0x4407d3(0x18c)){const _0x365619=/^bot-[0-9]{3}-config.json$/,_0x36cd6f=_0x365619[_0x4407d3(0x270)](_0x2b4894[_0x4407d3(0x290)]);if(_0x36cd6f){const _0x4214ea=JSON[_0x4407d3(0x2d9)](_0x4277bd);if(_0x4214ea[_0x4407d3(0x303)][0x0]){_0x4214ea[_0x4407d3(0x303)][0x0][_0x4407d3(0x172)]=_0x4407d3(0x350),_0x4214ea[_0x4407d3(0x303)][0x0][_0x4407d3(0x2a1)]=_0x4407d3(0x350);if(_0x4214ea['bot'][0x0]['apiPassword'])_0x4214ea[_0x4407d3(0x303)][0x0][_0x4407d3(0x2eb)]=_0x4407d3(0x350);}_0x4277bd=JSON['stringify'](_0x4214ea,null,0x2);}if(_0x2b4894[_0x4407d3(0x290)]==_0x4407d3(0x2dd)){const _0x12d9d0=JSON[_0x4407d3(0x2d9)](_0x4277bd);if(_0x12d9d0[_0x4407d3(0x19c)][_0x4407d3(0x2c2)])_0x12d9d0[_0x4407d3(0x19c)][_0x4407d3(0x2c2)]=![];if(_0x12d9d0['settings']['bbPassword'])_0x12d9d0[_0x4407d3(0x19c)][_0x4407d3(0x28e)]=_0x4407d3(0x350);if(_0x12d9d0['settings'][_0x4407d3(0x19e)])_0x12d9d0[_0x4407d3(0x19c)][_0x4407d3(0x19e)]='***';if(_0x12d9d0[_0x4407d3(0x19c)][_0x4407d3(0x325)])_0x12d9d0[_0x4407d3(0x19c)][_0x4407d3(0x325)]=null;_0x4277bd=JSON[_0x4407d3(0x23d)](_0x12d9d0,null,0x2);}if(_0x2b4894[_0x4407d3(0x290)]!=_0x4407d3(0x255))_0x522d2b[_0x4407d3(0x330)](_0x2b4894[_0x4407d3(0x290)],_0x4277bd);}else _0x522d2b[_0x4407d3(0x330)](_0x2b4894[_0x4407d3(0x290)],_0x4277bd);}});const _0xb58089=_0x522d2b[_0x3b383c(0x24e)]({'base64':![],'compression':_0x3b383c(0x1b2)});fs['writeFileSync'](zippath+(_0x15e89d+_0x3b383c(0x30a)),_0xb58089,_0x3b383c(0x215));}async function unzipFile(_0x310464,_0x31446e){const _0x258306=_0x14cc10;fs[_0x258306(0x327)](configpath,{'withFileTypes':!![]})[_0x258306(0x219)](_0x194ba3=>{const _0x114bad=_0x258306;if(!_0x194ba3['isDirectory']())fs[_0x114bad(0x205)](configpath+_0x194ba3[_0x114bad(0x290)]);});const _0x41cafe=fs[_0x258306(0x266)](_0x310464+_0x31446e,_0x258306(0x215)),_0x5d8456=new require(_0x258306(0x22a))(_0x41cafe,{'base64':![],'checkCRC32':!![]});Object[_0x258306(0x1ea)](_0x5d8456['files'])[_0x258306(0x219)](_0x319890=>{const _0x1c7849=_0x258306,_0x142c3b=_0x5d8456[_0x1c7849(0x230)][_0x319890];fs[_0x1c7849(0x2c4)](configpath+_0x142c3b[_0x1c7849(0x290)],_0x142c3b[_0x1c7849(0x1e1)]);}),fs[_0x258306(0x327)](temppath,{'withFileTypes':!![]})[_0x258306(0x219)](_0x5eb74e=>{const _0x566b85=_0x258306;if(!_0x5eb74e[_0x566b85(0x27b)]())fs['rmSync'](temppath+_0x5eb74e[_0x566b85(0x290)]);}),logger['debug'](_0x258306(0x187)),process[_0x258306(0x1c7)]({'restore':!![]},_0x5c919a=>{});}async function getPublicIp(){const _0x314a4a=_0x14cc10;try{const _0x370da0=await axios[_0x314a4a(0x2e6)](_0x314a4a(0x335));publicip=_0x370da0['data']['ip'];}catch(_0x59d43a){}}async function triggerAnalytics(){const _0x3a2e58=_0x14cc10;if(!publicip)await getPublicIp();const _0xec95f6=getBotsWithMode();let _0x1f8695=0x0;_0xec95f6[_0x3a2e58(0x219)](_0x221fa4=>{const _0x114227=_0x3a2e58;if(_0x221fa4['status']===_0x114227(0x2bd))_0x1f8695++;});const _0x50f03d=getBotExchanges();mixpanel[_0x3a2e58(0x253)]('Server',{'distinct_id':settings[_0x3a2e58(0x1b8)],'ip':publicip,'version':serverversion,'numbots':_0xec95f6[_0x3a2e58(0x2be)],'numbotsenabled':_0x1f8695,'exchanges':_0x50f03d,'environment':environment});}async function getMessages(){const _0x51e7e9=_0x14cc10,_0x34d3f8=_0x51e7e9(0x232),_0x3c7a74=new GraphQLClient(_0x34d3f8),_0x27bb86={'authorization':_0x51e7e9(0x2fc)},_0x35c29f=serverversion['split']('.'),_0x583936=_0x35c29f[0x0]+'.'+_0x35c29f[0x1],_0x1db1d3=Math[_0x51e7e9(0x1d1)](settings[_0x51e7e9(0x275)],settings[_0x51e7e9(0x30f)]),_0x20c547={'last':parseInt(_0x1db1d3),'bbm':_0x583936},_0x44f806=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x3129a8;try{_0x3129a8=await _0x3c7a74['request'](_0x44f806,_0x20c547,_0x27bb86);}catch(_0x5cc052){}if(_0x3129a8&&_0x3129a8[_0x51e7e9(0x342)]){let _0x159495=settings[_0x51e7e9(0x275)];newMessages=[];for(const _0x492fae of _0x3129a8[_0x51e7e9(0x342)]){newMessages[_0x51e7e9(0x25d)](_0x492fae);let _0x4802d7=![];_0x492fae[_0x51e7e9(0x318)]&&(updateSetting('latestversion',_0x492fae[_0x51e7e9(0x318)]),_0x4802d7=isNewerVersion(serverversion,_0x492fae[_0x51e7e9(0x318)])||serverversion==_0x492fae['bbvNew']);if(!_0x4802d7&&_0x492fae[_0x51e7e9(0x196)]>_0x159495){if(_0x492fae[_0x51e7e9(0x26c)]==='any'||serverversion[_0x51e7e9(0x16b)](_0x492fae['bbvReceive'])){let _0x3291fe=''+_0x492fae[_0x51e7e9(0x32c)]+'\x0a\x0a'+_0x492fae[_0x51e7e9(0x213)];const _0x311187=await sendTelegramMsg(toTelegramMarkdown(_0x3291fe),_0x51e7e9(0x1d2));if(_0x311187)_0x159495=_0x492fae[_0x51e7e9(0x196)];}}}updateAvailable=isNewerVersion(settings[_0x51e7e9(0x1a9)],serverversion),updateSetting(_0x51e7e9(0x275),_0x159495),emitMessages();}}function emitMessages(){const _0x1498c6=_0x14cc10,_0x1f5451=settings[_0x1498c6(0x30f)];let _0x57fc08=[];newMessages[_0x1498c6(0x219)](_0xa13553=>{const _0x43d824=_0x1498c6;_0xa13553[_0x43d824(0x196)]>_0x1f5451&&_0x57fc08[_0x43d824(0x25d)](_0xa13553);}),_0x57fc08[_0x1498c6(0x2be)]>0x0&&getAllClients()[_0x1498c6(0x219)](_0x1a41cd=>{const _0x394358=_0x1498c6;getSocket(_0x1a41cd['id'])[_0x394358(0x1bd)](_0x394358(0x213),_0x57fc08);});}function confirmMessage(_0x2f08c6){const _0x5954aa=_0x14cc10;updateSetting(_0x5954aa(0x30f),Number(_0x2f08c6));}function isNewerVersion(_0x26e59d,_0x2d6eaf){const _0x521469=_0x14cc10,_0x3cef5c=_0x2d6eaf[_0x521469(0x1e9)]('.'),_0x3bee6d=_0x26e59d['split']('.');for(var _0x58a1df=0x0;_0x58a1df<_0x3bee6d[_0x521469(0x2be)];_0x58a1df++){const _0x223d42=~~_0x3bee6d[_0x58a1df],_0x211572=~~_0x3cef5c[_0x58a1df];if(_0x223d42>_0x211572)return!![];if(_0x223d42<_0x211572)return![];}return![];}function toTelegramMarkdown(_0x28d11e){const _0x1a68c1=_0x14cc10,_0x59cf71=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x633369=/\*{2}(.+?)\*{2}/gim;return _0x28d11e=_0x28d11e[_0x1a68c1(0x314)](_0x59cf71,'$1_$2_$3')[_0x1a68c1(0x314)](_0x633369,_0x1a68c1(0x17c)),_0x28d11e;}async function validateConfigFile(){const _0x4e4544=_0x14cc10,_0x18f0b6=dbConfig[_0x4e4544(0x2e6)](_0x4e4544(0x2ee))[_0x4e4544(0x1ec)](_0x4e4544(0x2fb))[_0x4e4544(0x2bb)]()||[];if(_0x18f0b6[_0x4e4544(0x2be)]==0x0){let _0x48cc67=0x0,_0x49e259=[];const _0x36a161=/^bot-([0-9]{3})-config.json$/,_0x3ea3fa=fs[_0x4e4544(0x327)](configpath);_0x3ea3fa[_0x4e4544(0x219)](_0x1329f7=>{const _0x495e59=_0x4e4544,_0x2bd9b4=_0x36a161['exec'](_0x1329f7);if(_0x2bd9b4){const _0x1dc341=_0x2bd9b4[0x1];let _0x1ea192=getBotAttributes(_0x1dc341);_0x49e259[_0x495e59(0x25d)]({'botID':_0x1dc341,'botname':_0x1ea192[_0x495e59(0x1e3)],'status':_0x495e59(0x235),'live':_0x495e59(0x1b1)}),_0x48cc67++;}}),_0x48cc67!=0x0&&(dbConfig[_0x4e4544(0x2e6)]('bots')['assign'](_0x49e259)[_0x4e4544(0x2cf)](),config=_0x49e259,restoredConfigFile=_0x48cc67);}}async function restoreConfigNotify(_0x17b695){const _0x894f42=_0x14cc10;let _0x2a55ab;if(restoredConfigFile==0x1)_0x2a55ab=_0x894f42(0x34e);else _0x2a55ab=_0x894f42(0x28a);if(_0x17b695)io['to']('botmanager')[_0x894f42(0x1bd)](_0x894f42(0x35f),_0x2a55ab);else{logger['simple'](_0x894f42(0x21d)),logger[_0x894f42(0x322)](_0x2a55ab),logger[_0x894f42(0x322)](_0x894f42(0x21d)),logger['simple']('');if(tgBot&&settings['telegramChatId']&&settings[_0x894f42(0x311)]!=_0x894f42(0x1a1))await sendTelegram(settings[_0x894f42(0x325)],_0x894f42(0x374)+_0x2a55ab);}}function validateCredentials(_0x5b710b,_0x5b62a3){const _0x46391b=_0x14cc10;if(_0x5b710b[_0x46391b(0x204)]==settings[_0x46391b(0x366)]&&bcrypt[_0x46391b(0x288)](_0x5b710b[_0x46391b(0x300)],settings[_0x46391b(0x28e)])){if(settings[_0x46391b(0x2b3)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x56cc08=generateLoginToken(_0x5b62a3);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x56cc08};}}else return{'allow':![],'reason':_0x46391b(0x1c9),'token':null};}function refreshToken(_0x48883a){const _0x3ac2ea=_0x14cc10,_0x4dcd99=generateLoginToken(_0x48883a);return{'allow':!![],'reason':_0x3ac2ea(0x294),'token':_0x4dcd99};}function validateAccess(_0x206889,_0xe818d0,_0x57352c){const _0x128987=_0x14cc10,_0x3635c4=_0x57352c?_0x57352c:devices[_0xe818d0]['ip'];let _0x5ab0dd;const _0x4ed3a2=_0x42c6d9=>{const _0xe8077a=_0x161c;if(settings['loginRequired']){if(settings['f2aRequired']){if(telegram2FaApproved(_0xe818d0)){const _0x44a07e=generateLoginToken(_0xe818d0);return{'allow':!![],'reason':_0xe8077a(0x1fb),'token':_0x44a07e};}else return{'allow':![],'reason':_0xe8077a(0x214),'token':null};}else return _0x5ab0dd=validToken(_0x42c6d9,_0xe818d0),_0x5ab0dd[_0xe8077a(0x2e4)](_0xe8077a(0x19d))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x42c6d9}:{'allow':![],'reason':_0xe8077a(0x214),'token':null};}else return{'allow':!![],'reason':_0xe8077a(0x2d6),'token':null};};if(settings[_0x128987(0x239)]){let _0x46a1d2=[...settings[_0x128987(0x22c)],_0x128987(0x25f),_0x128987(0x1a8),_0x128987(0x313)];if(_0x46a1d2['includes'](_0x3635c4))return _0x4ed3a2(_0x206889);else{_0x5ab0dd=validToken(_0x206889,_0xe818d0);if(_0x5ab0dd['hasOwnProperty']('success'))return _0x4ed3a2(_0x206889);else{if(telegramIpApproved(_0xe818d0)){const _0x58a2a5=generateToken(_0xe818d0);return _0x5ab0dd=_0x4ed3a2(_0x206889),_0x5ab0dd[_0x128987(0x337)]?{'allow':!![],'reason':_0x128987(0x1ac),'token':_0x58a2a5}:_0x5ab0dd;}else return settings[_0x128987(0x32b)]?{'allow':![],'reason':_0x128987(0x209),'token':null}:{'allow':![],'reason':_0x128987(0x1c2),'token':null};}}}else return _0x4ed3a2(_0x206889);}function timelyDecrypt(_0x4a4526,_0x469c04=!![]){const _0x853ecf=_0x14cc10;if(_0x4a4526)try{const _0xfd10e1=crypt[_0x853ecf(0x210)](secure[_0x853ecf(0x33d)],_0x4a4526)['message'],_0x30f8f8=_0xfd10e1[_0x853ecf(0x1e9)]('@')[0x0],_0x483565=_0xfd10e1[_0x853ecf(0x1e9)]('@')[0x1],_0x115d9a=new Date()[_0x853ecf(0x272)]();if(_0x469c04){if(_0x115d9a-_0x483565<maxSecretAge*0x3e8)return _0x30f8f8;else return![];}else return _0x30f8f8;}catch(_0x3e4652){return![];}else return![];}const validToken=(_0x2085c8,_0x2b954b)=>{const _0x16dec6=_0x14cc10,_0x3960b4=devices[_0x2b954b]['ip'];if(!_0x2085c8)return{'error':_0x16dec6(0x20d)};for(let _0xd1216f of blacklist){if(_0xd1216f[_0x16dec6(0x379)]==_0x2085c8)return{'error':_0x16dec6(0x254)};}let _0x4700b1;try{_0x4700b1=jwt[_0x16dec6(0x21e)](_0x2085c8,secure[_0x16dec6(0x2e7)]+_0x2b954b);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x4700b1[_0x16dec6(0x2e4)]('clientip')&&!_0x4700b1['hasOwnProperty']('username')||!_0x4700b1[_0x16dec6(0x2e4)](_0x16dec6(0x1ad)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x4700b1[_0x16dec6(0x2e4)]('username')&&_0x4700b1['hasOwnProperty'](_0x16dec6(0x1e8))){const {clientip:_0x572d7f}=_0x4700b1;return _0x3960b4==_0x572d7f?{'success':_0x16dec6(0x1ef)}:{'error':_0x16dec6(0x1b7)};}else{if(_0x4700b1[_0x16dec6(0x2e4)](_0x16dec6(0x204))&&_0x4700b1[_0x16dec6(0x2e4)]('clientip')){const {username:_0x2f2827,clientip:_0x349c17}=_0x4700b1;return settings['bbUsername']==_0x2f2827&&_0x3960b4==_0x349c17?{'success':_0x16dec6(0x1ef)}:{'error':_0x16dec6(0x2a0)};}}},generateLoginToken=_0x51c81d=>{const _0x5e41a3=_0x14cc10;if(_0x51c81d){const _0x43a626=devices[_0x51c81d]['ip'];return jwt[_0x5e41a3(0x310)]({'username':settings[_0x5e41a3(0x366)],'clientip':_0x43a626},secure['secret']+_0x51c81d,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x89f310=>{const _0x574d6b=_0x14cc10;if(_0x89f310){const _0x30cf24=devices[_0x89f310]['ip'];return jwt[_0x574d6b(0x310)]({'clientip':_0x30cf24},secure[_0x574d6b(0x2e7)]+_0x89f310,{'expiresIn':devices[_0x89f310][_0x574d6b(0x262)]['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x3d4173=>{const _0x5d2da4=_0x14cc10;let _0x15d5c7=![];return devices[_0x3d4173][_0x5d2da4(0x262)]&&devices[_0x3d4173][_0x5d2da4(0x262)][_0x5d2da4(0x247)]!='reject'&&(_0x15d5c7=devices[_0x3d4173][_0x5d2da4(0x262)][_0x5d2da4(0x1e8)]==devices[_0x3d4173]['ip']&&new Date()['getTime']()-devices[_0x3d4173]['telegramIpApproval'][_0x5d2da4(0x33a)]<devices[_0x3d4173][_0x5d2da4(0x262)]['expiry']*0x3c*0x3e8),_0x15d5c7;},telegram2FaApproved=_0x1d213a=>{const _0xe23136=_0x14cc10;let _0x35fad5=![];return devices[_0x1d213a][_0xe23136(0x36e)]&&devices[_0x1d213a][_0xe23136(0x36e)][_0xe23136(0x247)]!=_0xe23136(0x340)&&(_0x35fad5=devices[_0x1d213a][_0xe23136(0x36e)][_0xe23136(0x1e8)]==devices[_0x1d213a]['ip']&&new Date()[_0xe23136(0x272)]()-devices[_0x1d213a][_0xe23136(0x36e)][_0xe23136(0x33a)]<devices[_0x1d213a][_0xe23136(0x36e)][_0xe23136(0x247)]*0x3c*0x3e8),_0x35fad5;},normalizeIP=_0x522897=>{const _0x5317af=_0x14cc10;let _0x3f13bd=null,_0x3ca6ad=null;if(ipaddr[_0x5317af(0x263)](_0x522897)){const _0x1fd86c=ipaddr[_0x5317af(0x2d9)](_0x522897);_0x1fd86c[_0x5317af(0x29a)]()===_0x5317af(0x37c)?(_0x1fd86c[_0x5317af(0x369)]()&&(_0x3f13bd=_0x1fd86c[_0x5317af(0x194)]()['toString']()),_0x3ca6ad=_0x1fd86c[_0x5317af(0x252)]()):(_0x3f13bd=_0x1fd86c[_0x5317af(0x252)](),_0x3ca6ad=_0x1fd86c[_0x5317af(0x276)]()['toString']());}return{'show':_0x3f13bd?_0x3f13bd:_0x3ca6ad,'store':_0x3ca6ad};};function formatDate(_0x3a2a4b){const _0x2a9939=_0x14cc10;return _0x3a2a4b[_0x2a9939(0x1c1)]()+'/'+(_0x3a2a4b[_0x2a9939(0x2ea)]()+0x1)[_0x2a9939(0x252)]()[_0x2a9939(0x35c)](0x2,'0')+'/'+_0x3a2a4b[_0x2a9939(0x199)]()[_0x2a9939(0x252)]()[_0x2a9939(0x35c)](0x2,'0')+'\x20'+_0x3a2a4b['getHours']()[_0x2a9939(0x252)]()[_0x2a9939(0x35c)](0x2,'0')+':'+_0x3a2a4b['getMinutes']()['toString']()[_0x2a9939(0x35c)](0x2,'0')+':'+_0x3a2a4b['getSeconds']()['toString']()[_0x2a9939(0x35c)](0x2,'0');}function sleep(_0x2ecba7){return new Promise(_0x36466e=>setTimeout(_0x36466e,_0x2ecba7));}