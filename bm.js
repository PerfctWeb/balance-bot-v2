const _0x53bb91=_0x3d0b;(function(_0x420b0b,_0x20b1c6){const _0xdb9b0e=_0x3d0b,_0x556151=_0x420b0b();while(!![]){try{const _0x41e470=parseInt(_0xdb9b0e(0x208))/0x1*(parseInt(_0xdb9b0e(0x3f6))/0x2)+parseInt(_0xdb9b0e(0x37a))/0x3*(-parseInt(_0xdb9b0e(0x218))/0x4)+parseInt(_0xdb9b0e(0x3f9))/0x5+parseInt(_0xdb9b0e(0x313))/0x6*(-parseInt(_0xdb9b0e(0x2b6))/0x7)+parseInt(_0xdb9b0e(0x369))/0x8*(parseInt(_0xdb9b0e(0x293))/0x9)+-parseInt(_0xdb9b0e(0x3f7))/0xa*(-parseInt(_0xdb9b0e(0x1f8))/0xb)+-parseInt(_0xdb9b0e(0x377))/0xc*(parseInt(_0xdb9b0e(0x383))/0xd);if(_0x41e470===_0x20b1c6)break;else _0x556151['push'](_0x556151['shift']());}catch(_0x13fe2b){_0x556151['push'](_0x556151['shift']());}}}(_0x42a8,0x1fffd));const _0x1c808a=function(){let _0x5a57d5=!![];return function(_0x49032b,_0x1190b8){const _0x36f181=_0x5a57d5?function(){const _0xe91e25=_0x3d0b;if(_0x1190b8){const _0x4a540f=_0x1190b8[_0xe91e25(0x3dd)](_0x49032b,arguments);return _0x1190b8=null,_0x4a540f;}}:function(){};return _0x5a57d5=![],_0x36f181;};}(),_0x3f46a8=_0x1c808a(this,function(){const _0x403dfc=_0x3d0b;return _0x3f46a8[_0x403dfc(0x329)]()['search'](_0x403dfc(0x3b2))['toString']()[_0x403dfc(0x348)](_0x3f46a8)[_0x403dfc(0x26e)]('(((.+)+)+)+$');});_0x3f46a8();'use strict';process['env'][_0x53bb91(0x246)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x53bb91(0x1f4)),low=require('lowdb'),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x53bb91(0x1fe)),crypto=require('crypto'),forge=require(_0x53bb91(0x3de)),bcrypt=require(_0x53bb91(0x29d)),jwt=require('jsonwebtoken'),ipaddr=require(_0x53bb91(0x379)),argv=require(_0x53bb91(0x25c))(process[_0x53bb91(0x209)][_0x53bb91(0x294)](0x2))[_0x53bb91(0x209)],uuidRandom=require(_0x53bb91(0x24c)),{Telegraf,Markup}=require(_0x53bb91(0x265)),Mixpanel=require('mixpanel'),axios=require(_0x53bb91(0x367)),{GraphQLClient,gql}=require(_0x53bb91(0x2be)),util=require(_0x53bb91(0x215)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require(_0x53bb91(0x282)),PORT=argv[_0x53bb91(0x239)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x53bb91(0x2e5)](PORT)&&(console[_0x53bb91(0x290)](_0x53bb91(0x229)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x53bb91(0x22d)](0x1));const HOST=argv['host']||null,userID=argv[_0x53bb91(0x35d)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x53bb91(0x398)];let bbpath=_0x53bb91(0x3c5),bbpath2='';const botfile=_0x53bb91(0x333),configfile=_0x53bb91(0x3d4),settingsfile=_0x53bb91(0x257),securefile=_0x53bb91(0x347),environment=require('./'+bbpath2+_0x53bb91(0x248))[_0x53bb91(0x3ef)]||_0x53bb91(0x3df),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x53bb91(0x250)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x53bb91(0x2e6));let configpath=userID?bbpath+_0x53bb91(0x289)+userID+'/':bbpath+'config/';const configbackuppath=configpath+_0x53bb91(0x258),logspath=userID?bbpath+_0x53bb91(0x353)+userID+'/':bbpath+_0x53bb91(0x353),zippath=userID?bbpath+_0x53bb91(0x2ec)+userID+'/':bbpath+_0x53bb91(0x2ec),loggerfile=fs[_0x53bb91(0x2f0)](logspath+_0x53bb91(0x33c),{'flags':'a'}),temppath=userID?bbpath+_0x53bb91(0x388)+userID+'/':bbpath+_0x53bb91(0x388);!fs[_0x53bb91(0x250)](configpath)&&fs[_0x53bb91(0x34a)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x53bb91(0x34a)](configbackuppath);!fs[_0x53bb91(0x250)](logspath)&&fs['mkdirSync'](logspath);!fs['existsSync'](zippath)&&fs[_0x53bb91(0x34a)](zippath);!fs[_0x53bb91(0x250)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x53bb91(0x2c6)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x53bb91(0x31b),'onepagemode':![],'marketcapApi':''}})[_0x53bb91(0x2cd)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x53bb91(0x2c6)]({'secure':{},'blacklist':[]})[_0x53bb91(0x2cd)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x53bb91(0x33d)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x53bb91(0x301)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x53bb91(0x3d6)]&&(settings[_0x53bb91(0x3d6)]!=''&&settings[_0x53bb91(0x3d6)]!=_0x53bb91(0x1e8))&&settings['telegramUsername']&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x1bc6ac,_0xfbb5d6)=>{const _0x1cb100=_0x53bb91,_0x2a7f6e=/#[A-Z]{3}#/g;if(typeof _0x1bc6ac==_0x1cb100(0x387)){!_0xfbb5d6?_0x1bc6ac=_0x1bc6ac[_0x1cb100(0x281)](_0x2a7f6e,''):(_0x1bc6ac=_0x1bc6ac[_0x1cb100(0x281)](/#BLU#/g,_0x1cb100(0x3d9)),_0x1bc6ac=_0x1bc6ac[_0x1cb100(0x281)](/#RED#/g,_0x1cb100(0x30e)),_0x1bc6ac=_0x1bc6ac['replace'](/#YEL#/g,_0x1cb100(0x200)),_0x1bc6ac=_0x1bc6ac['replace'](/#MAG#/g,_0x1cb100(0x20c)),_0x1bc6ac=_0x1bc6ac[_0x1cb100(0x281)](/#CYA#/g,_0x1cb100(0x283)),_0x1bc6ac=_0x1bc6ac[_0x1cb100(0x281)](/#RES#/g,'\x1b[0m'));;}return _0x1bc6ac;},logger={'screen':_0x1836a5=>{const _0x190362=_0x53bb91;console[_0x190362(0x290)](parseColor(_0x1836a5,!![]));},'simple':_0x55e0fb=>{const _0x31eb38=_0x53bb91;console['log'](parseColor(_0x55e0fb,!![])),loggerfile[_0x31eb38(0x2cd)](util[_0x31eb38(0x2fe)](parseColor(_0x55e0fb,![]))+'\x0a');},'full':async _0xa80b19=>{const _0x1927b0=_0x53bb91,_0x464bf4=getTimeStamp()+_0x1927b0(0x2cf)+_0xa80b19;console[_0x1927b0(0x290)](parseColor(_0x464bf4,!![])),loggerfile['write'](util[_0x1927b0(0x2fe)](parseColor(_0x464bf4,![]))+'\x0a');if(tgBot&&settings[_0x1927b0(0x351)]&&settings[_0x1927b0(0x23a)]!=_0x1927b0(0x219))await sendTelegram(settings['telegramChatId'],_0x1927b0(0x3c0)+parseColor(_0xa80b19,![]));},'debug':async(_0x27e17d,_0x22d150='')=>{const _0x4a39df=_0x53bb91,_0x435a6f=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x27e17d;if(debugging)console[_0x4a39df(0x290)](parseColor(_0x435a6f,!![]));loggerfile[_0x4a39df(0x2cd)](util['format'](parseColor(_0x435a6f,![]))+'\x0a');if(_0x22d150){if(debugging)console[_0x4a39df(0x290)](_0x22d150);loggerfile[_0x4a39df(0x2cd)](util[_0x4a39df(0x2fe)](_0x22d150)+'\x0a');}}};let terminating=![];process['on'](_0x53bb91(0x27a),function(_0xdf3ca9){const _0x4c360b=_0x53bb91;_0xdf3ca9['toString']()[_0x4c360b(0x235)](_0x4c360b(0x210))?(logger[_0x4c360b(0x27f)](_0x4c360b(0x308)+_0xdf3ca9[_0x4c360b(0x239)]+_0x4c360b(0x36f)),process[_0x4c360b(0x2a4)]({'terminate':!![]},_0x344f57=>{})):logger[_0x4c360b(0x27f)](_0xdf3ca9);}),process['on']('exit',()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x53bb91(0x2f8),()=>{stopAllBots(),process['exit'](0x0);}),process['on']('SIGINT',()=>{const _0x53bbde=_0x53bb91;stopAllBots(),process[_0x53bbde(0x22d)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x53bb91(0x29b)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x53bb91(0x275)),app=express(),http=require(_0x53bb91(0x38a))[_0x53bb91(0x365)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x53bb91(0x3e2)](_0x53bb91(0x31c),async(_0x4b0cf1,_0x5eea2c)=>{const _0x394012=_0x53bb91,_0x53b84b=_0x4b0cf1[_0x394012(0x392)][_0x394012(0x3b4)],_0x5dace9=getClientsWithBotID(_0x394012(0x222)),_0xaeef5c=_0x4b0cf1[_0x394012(0x3ac)][_0x394012(0x3d8)],_0x239104=timelyDecrypt(_0xaeef5c,![]),_0x4bdc03=_0x5dace9[_0x394012(0x1fd)](_0x6e9ba6=>_0x6e9ba6[_0x394012(0x3d8)]==_0x239104);if(_0x4bdc03){const _0xbe9f73=normalizeIP(_0x4b0cf1[_0x394012(0x300)]['remoteAddress'])[_0x394012(0x25a)],_0x56e46b=_0x4b0cf1[_0x394012(0x3ac)]['tkn'];if(validateAccess(_0x56e46b,_0x239104,_0xbe9f73)[_0x394012(0x359)])_0x53b84b=='backup'&&await backupConfigFiles(),await zipFiles(_0x53b84b),_0x5eea2c[_0x394012(0x3f5)](zippath+(_0x53b84b+_0x394012(0x36d)),_0x1af589=>{const _0x4bb526=_0x394012;_0x1af589&&(logger[_0x4bb526(0x37b)](_0x4bb526(0x317)+_0x53b84b),logger['simple'](_0x1af589));});else logger['full'](_0x394012(0x39f)+_0x53b84b+_0x394012(0x39b));}else logger[_0x394012(0x37b)](_0x394012(0x39f)+_0x53b84b+'\x20(2)');}),app['post']('/upload-backup',async(_0x29d6d4,_0x3a8f27)=>{const _0x5b59d2=_0x53bb91,_0x4d3d07=getClientsWithBotID(_0x5b59d2(0x222)),_0x596903=_0x29d6d4[_0x5b59d2(0x3ac)][_0x5b59d2(0x3d8)],_0x3357cc=timelyDecrypt(_0x596903,![]),_0x148725=_0x4d3d07[_0x5b59d2(0x1fd)](_0x24f491=>_0x24f491[_0x5b59d2(0x3d8)]==_0x3357cc);logger['debug'](_0x5b59d2(0x35c));if(_0x148725){const _0x11a4b7=normalizeIP(_0x29d6d4[_0x5b59d2(0x300)][_0x5b59d2(0x3d5)])[_0x5b59d2(0x25a)],_0x3ad837=_0x29d6d4[_0x5b59d2(0x3ac)]['tkn'];if(validateAccess(_0x3ad837,_0x3357cc,_0x11a4b7)[_0x5b59d2(0x359)]){if(_0x29d6d4[_0x5b59d2(0x323)]){const _0x573864=_0x29d6d4['files'][_0x5b59d2(0x2c9)];await _0x573864['mv'](temppath+_0x573864[_0x5b59d2(0x3fd)]),_0x3a8f27[_0x5b59d2(0x2a4)]({'status':!![],'message':'File\x20uploaded'});const _0x165ae7=getBotsWithMode();_0x165ae7[_0x5b59d2(0x3b8)]>0x0?confirmRestore(temppath,_0x573864['name']):unzipFile(temppath,_0x573864[_0x5b59d2(0x3fd)]);}}else logger[_0x5b59d2(0x37b)](_0x5b59d2(0x3bf));}else logger['full'](_0x5b59d2(0x3ed));}),app[_0x53bb91(0x3a0)](express[_0x53bb91(0x2db)](path[_0x53bb91(0x2de)](__dirname,bbpath2,'build2'))),app['use'](express[_0x53bb91(0x2db)](path['join'](__dirname,bbpath2,_0x53bb91(0x296)))),app[_0x53bb91(0x3e2)]('/',function(_0x3e5078,_0x3da549){const _0x51a60e=_0x53bb91;_0x3da549[_0x51a60e(0x3af)](path[_0x51a60e(0x2de)](__dirname,bbpath2,_0x51a60e(0x34d),_0x51a60e(0x27c)));}),app[_0x53bb91(0x3e2)](_0x53bb91(0x331),function(_0x35e21e,_0x322ce4){const _0x464796=_0x53bb91;_0x322ce4[_0x464796(0x3af)](path['join'](__dirname,bbpath2,_0x464796(0x296),_0x464796(0x27c)));}),app['get']('/:bot/portfolio',(_0x1e07a9,_0x68fa67)=>{const _0x296d7b=_0x53bb91;_0x68fa67['sendFile'](path[_0x296d7b(0x2de)](__dirname,bbpath2,_0x296d7b(0x296),_0x296d7b(0x27c)));}),app[_0x53bb91(0x3e2)](_0x53bb91(0x20d),(_0x4c8cae,_0x1a6356)=>{const _0x44735a=_0x53bb91;_0x1a6356[_0x44735a(0x3af)](path['join'](__dirname,bbpath2,_0x44735a(0x296),_0x44735a(0x27c)));}),app[_0x53bb91(0x3e2)](_0x53bb91(0x344),(_0x44e1c2,_0x114c08)=>{const _0x4f4ae0=_0x53bb91;_0x114c08[_0x4f4ae0(0x3af)](path[_0x4f4ae0(0x2de)](__dirname,bbpath2,'build','index.html'));}),app[_0x53bb91(0x3e2)](_0x53bb91(0x20a),(_0x2d5d1f,_0x10b5d4)=>{const _0x898025=_0x53bb91;_0x10b5d4[_0x898025(0x3af)](path[_0x898025(0x2de)](__dirname,bbpath2,'build','index.html'));}),app[_0x53bb91(0x3e2)](_0x53bb91(0x3f1),(_0x38891b,_0x5b8ef2)=>{const _0x85b806=_0x53bb91;_0x5b8ef2[_0x85b806(0x3af)](path[_0x85b806(0x2de)](__dirname,bbpath2,_0x85b806(0x296),_0x85b806(0x27c)));}),app['get'](_0x53bb91(0x2c3),(_0x4236bf,_0x41f32a)=>{const _0x62cd8f=_0x53bb91;_0x41f32a[_0x62cd8f(0x3af)](path[_0x62cd8f(0x2de)](__dirname,bbpath2,_0x62cd8f(0x296),_0x62cd8f(0x27c)));});if(HOST)http[_0x53bb91(0x23e)](PORT,HOST);else http[_0x53bb91(0x23e)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x2064d5=_0x53bb91;let _0x22d6d0='[ip-address]';const _0x3cb75c=networkInterfaces(),_0x406db3={};for(const _0x1aab1a of Object[_0x2064d5(0x22c)](_0x3cb75c)){for(const _0x2a9909 of _0x3cb75c[_0x1aab1a]){if((_0x2a9909[_0x2064d5(0x332)]==_0x2064d5(0x3e8)||_0x2a9909[_0x2064d5(0x332)]==0x4)&&!_0x2a9909[_0x2064d5(0x337)]){const _0x6a4087=ipaddr[_0x2064d5(0x2a1)](_0x2a9909['address'])[_0x2064d5(0x279)]();_0x6a4087!=_0x2064d5(0x395)&&(!_0x406db3[_0x1aab1a]&&(_0x406db3[_0x1aab1a]=[]),_0x406db3[_0x1aab1a][_0x2064d5(0x320)](_0x2a9909['address']),_0x22d6d0=_0x2a9909[_0x2064d5(0x399)]);}}}return{'serverip':_0x22d6d0,'netinterfaces':_0x406db3};}async function startServer(){const _0x5e8960=_0x53bb91,{serverip:_0xa26ceb,netinterfaces:_0xdb9aed}=getServerIP();logger['simple'](''),logger['simple']('-----------------------------------------------------------------------------------'),await logger[_0x5e8960(0x37b)](_0x5e8960(0x3e5)+serverversion+_0x5e8960(0x38e)+(environment==_0x5e8960(0x2fd)?'(staging)':'')+'\x0a'+(_0x5e8960(0x21c)+PORT+_0x5e8960(0x3b1))+(_0x5e8960(0x324)+_0xa26ceb+':'+PORT+_0x5e8960(0x3cd))),logger['simple'](_0x5e8960(0x2f2));if(config['length']!=0x0)for(const _0x435632 of config){const _0x1df3c0=_0x435632['mode']=='auto'?'a':'m';if(_0x435632[_0x5e8960(0x207)]==_0x5e8960(0x297)||_0x435632[_0x5e8960(0x207)]=='new')await logger[_0x5e8960(0x37b)](_0x5e8960(0x287)+_0x1df3c0+_0x5e8960(0x2ad)+_0x435632[_0x5e8960(0x389)]+_0x5e8960(0x2bb)+_0x435632[_0x5e8960(0x230)]),startBot([_0x435632[_0x5e8960(0x389)],userID],{'cwd':bbpath},function(_0x5dda58){if(_0x5dda58)logger['full'](_0x5dda58);});else(_0x435632[_0x5e8960(0x207)]=='disabled'||_0x435632[_0x5e8960(0x207)]==_0x5e8960(0x3d3))&&await logger[_0x5e8960(0x37b)]('Idling\x20('+_0x1df3c0+_0x5e8960(0x3e9)+_0x435632[_0x5e8960(0x389)]+_0x5e8960(0x2bb)+_0x435632[_0x5e8960(0x230)]);}else!newBot&&logger[_0x5e8960(0x27f)](_0x5e8960(0x2b4));if(newBot)addBot();logger[_0x5e8960(0x27f)](_0x5e8960(0x2f2)),logger['simple'](''),await logger['debug'](_0x5e8960(0x1f7)+nodeversion),await logger[_0x5e8960(0x2e0)](_0x5e8960(0x22a),_0xdb9aed);}function startSocket(){const _0x4cf6b8=_0x53bb91;io['on'](_0x4cf6b8(0x3c2),_0x3caaa1=>{const _0x32ecb9=_0x4cf6b8;let _0x50ea0c,_0x4dccf3,_0x240682,_0x33cc19,_0xaed3e;const _0x33428d=_0x3caaa1[_0x32ecb9(0x35e)][_0x32ecb9(0x3ac)][_0x32ecb9(0x36c)];_0x4dccf3=_0x33428d[_0x32ecb9(0x270)](/bot[0-9]{3}/);if(_0x4dccf3)_0x240682=_0x4dccf3[0x0][_0x32ecb9(0x270)](/[0-9]{3}/);if(_0x240682)_0x50ea0c=_0x240682[0x0];else _0x50ea0c=_0x32ecb9(0x222);const _0x2497c2=_0x3caaa1[_0x32ecb9(0x35e)][_0x32ecb9(0x343)]['encryptedUuid'];if(!_0x2497c2)_0x3caaa1[_0x32ecb9(0x3f8)](_0x32ecb9(0x207),{'publicKey':secure['publicKey']});else{_0x33cc19=timelyDecrypt(_0x2497c2,![]);if(!_0x33cc19)_0x3caaa1[_0x32ecb9(0x3f8)](_0x32ecb9(0x207),{'publicKey':secure[_0x32ecb9(0x32f)]});else{_0xaed3e=normalizeIP(_0x3caaa1[_0x32ecb9(0x1fb)][_0x32ecb9(0x3d5)])[_0x32ecb9(0x25a)];if(!devices[_0x33cc19])devices[_0x33cc19]={'uuid':_0x33cc19,'access':{'token':null}};devices[_0x33cc19]['ip']=_0xaed3e;const _0x19a768=addClient(_0x3caaa1['id'],_0x33cc19,_0x50ea0c);setAccess(_0x19a768),emitMessages(),_0x3caaa1['on'](_0x32ecb9(0x2e7),_0x4205a9=>{const _0x55d094=_0x32ecb9,_0x5b817a=timelyDecrypt(_0x4205a9['password'],!![],_0x55d094(0x368));if(_0x5b817a){_0x4205a9={'username':_0x4205a9[_0x55d094(0x2c4)],'password':_0x5b817a},devices[_0x33cc19][_0x55d094(0x3e4)]=validateCredentials(_0x4205a9,_0x33cc19);if(devices[_0x33cc19][_0x55d094(0x3e4)][_0x55d094(0x359)]==![]&&devices[_0x33cc19][_0x55d094(0x3e4)][_0x55d094(0x1f0)]==_0x55d094(0x3c9))_0x3caaa1[_0x55d094(0x3f8)](_0x55d094(0x207),{'access':devices[_0x33cc19][_0x55d094(0x3e4)]}),loginAccess2FA(_0x33cc19,_0xaed3e);else{if(devices[_0x33cc19][_0x55d094(0x3e4)][_0x55d094(0x359)]==![]&&devices[_0x33cc19][_0x55d094(0x3e4)]['reason']==_0x55d094(0x21a))_0x3caaa1[_0x55d094(0x3f8)](_0x55d094(0x207),{'access':devices[_0x33cc19][_0x55d094(0x3e4)]});else devices[_0x33cc19][_0x55d094(0x3e4)][_0x55d094(0x359)]&&devices[_0x33cc19][_0x55d094(0x3e4)][_0x55d094(0x1f0)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x33cc19)[_0x55d094(0x2b5)](_0x3a53e5=>{setAccess(_0x3a53e5);}),logger[_0x55d094(0x2e0)](_0x55d094(0x2d7)+_0x33cc19[_0x55d094(0x294)](-0x8)),setTokenRefresh(_0x33cc19),setSessionTimeout('login',_0x33cc19));}}else logger[_0x55d094(0x37b)](_0x55d094(0x3b0));}),_0x3caaa1['on'](_0x32ecb9(0x212),()=>{resetPassword();}),_0x3caaa1['on'](_0x32ecb9(0x256),_0xd03be9=>{removeClient(_0x3caaa1['id']);}),_0x50ea0c==_0x32ecb9(0x222)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x2cad19){const _0x3bbda1=_0x53bb91;if(_0x2cad19!=_0x3bbda1(0x222)&&config['apiKey']!=''){if(pid[_0x2cad19])pid[_0x2cad19][_0x3bbda1(0x2a4)]({'function':_0x3bbda1(0x3e3),'args':null});}_0x2cad19!=_0x3bbda1(0x222)&&broadcastToBots(_0x3bbda1(0x2c0),JSON[_0x3bbda1(0x242)](config));}function reloadBotManager(){const _0x328fbc=_0x53bb91;getClientsWithBotID('botmanager')[_0x328fbc(0x2b5)](_0x2c9ed9=>{const _0x21951e=_0x328fbc;getSocket(_0x2c9ed9['id'])[_0x21951e(0x3f8)](_0x21951e(0x207),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x37153e){const _0x4c11da=_0x53bb91,_0x42352c=io['_nsps'][_0x4c11da(0x3e2)]('/');return _0x42352c[_0x4c11da(0x340)][_0x4c11da(0x3e2)](_0x37153e);}function setAccess(_0x342653){const _0x4a6edc=_0x53bb91,_0xe30081=getSocket(_0x342653['id']),_0x13ddef=_0x342653[_0x4a6edc(0x3d8)],_0x3c052e=_0x342653['bot'];devices[_0x13ddef]['access']=validateAccess(devices[_0x13ddef][_0x4a6edc(0x3e4)]['token'],_0x13ddef),logger[_0x4a6edc(0x2e0)](_0x4a6edc(0x327)+devices[_0x13ddef]['access'][_0x4a6edc(0x1f0)]+_0x4a6edc(0x241)+_0x342653['id'][_0x4a6edc(0x294)](-0x8)+_0x4a6edc(0x397)+_0x13ddef['slice'](-0x8)),_0xe30081['join'](_0x13ddef);if(devices[_0x13ddef][_0x4a6edc(0x3e4)][_0x4a6edc(0x359)]){_0xe30081[_0x4a6edc(0x2de)](_0x3c052e);if(_0x3c052e=='botmanager')initializeSocketBotManager(_0xe30081);else initializeSocketBot(_0xe30081);initClient(_0x3c052e);}devices[_0x13ddef][_0x4a6edc(0x3e4)][_0x4a6edc(0x224)]&&devices[_0x13ddef][_0x4a6edc(0x3e4)]['reason']==_0x4a6edc(0x2f6)&&setSessionTimeout(_0x4a6edc(0x3c6),_0x13ddef),devices[_0x13ddef][_0x4a6edc(0x3e4)][_0x4a6edc(0x224)]&&devices[_0x13ddef][_0x4a6edc(0x3e4)][_0x4a6edc(0x1f0)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x4a6edc(0x2e7),_0x13ddef),_0xe30081[_0x4a6edc(0x3f8)](_0x4a6edc(0x207),{'status':_0x342653[_0x4a6edc(0x20b)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x13ddef]['access'],'externalip':devices[_0x13ddef]['ip'],'publicKey':secure[_0x4a6edc(0x32f)],'userid':settings[_0x4a6edc(0x376)],'validInstallation':validInstallation}),devices[_0x13ddef]['access'][_0x4a6edc(0x359)]==![]&&devices[_0x13ddef][_0x4a6edc(0x3e4)][_0x4a6edc(0x1f0)]==_0x4a6edc(0x3d0)&&temporaryAccess2FA(_0x13ddef,devices[_0x13ddef]['ip']);}function setSessionTimeout(_0x5be8f4,_0x1f533d){const _0x56edea=_0x53bb91;let _0x584c12;if(_0x5be8f4==_0x56edea(0x2e7))_0x584c12=loginExpiry*0x3c*0x3e8;else _0x584c12=devices[_0x1f533d][_0x56edea(0x34c)][_0x56edea(0x3ec)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x1f533d][_0x56edea(0x34c)][_0x56edea(0x29c)]);if(devices[_0x1f533d]['pidExpireLogin'])clearTimeout(devices[_0x1f533d][_0x56edea(0x34b)]);devices[_0x1f533d][_0x56edea(0x34b)]=setTimeout(()=>{const _0x1ad110=_0x56edea;if(devices[_0x1f533d][_0x1ad110(0x33e)])clearTimeout(devices[_0x1f533d]['pidRefreshToken']);removeSocketListeners(_0x1f533d),addBlacklist(_0x1f533d),devices[_0x1f533d][_0x1ad110(0x34c)]=null,devices[_0x1f533d][_0x1ad110(0x349)]=null,devices[_0x1f533d][_0x1ad110(0x3e4)][_0x1ad110(0x224)]=null,logger[_0x1ad110(0x2e0)]('Session\x20expired\x20for\x20user\x20...'+_0x1f533d[_0x1ad110(0x294)](-0x8)),devices[_0x1f533d][_0x1ad110(0x3e4)]=validateAccess(devices[_0x1f533d][_0x1ad110(0x3e4)][_0x1ad110(0x224)],_0x1f533d),!(devices[_0x1f533d]['access'][_0x1ad110(0x359)]&&devices[_0x1f533d][_0x1ad110(0x3e4)][_0x1ad110(0x1f0)]==_0x1ad110(0x303))&&(_0x5be8f4=='login'?io['to'](_0x1f533d)[_0x1ad110(0x3f8)](_0x1ad110(0x207),{'access':{'allow':![],'reason':_0x1ad110(0x3fb),'token':null}}):io['to'](_0x1f533d)[_0x1ad110(0x3f8)](_0x1ad110(0x207),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x1f533d][_0x1ad110(0x3e4)][_0x1ad110(0x224)]=null;},_0x584c12);}function setTokenRefresh(_0x102a4a){const _0x4529da=_0x53bb91;if(devices[_0x102a4a][_0x4529da(0x33e)])clearTimeout(devices[_0x102a4a][_0x4529da(0x33e)]);devices[_0x102a4a][_0x4529da(0x33e)]=setTimeout(()=>{const _0x30dace=_0x4529da;getClientsWithUuid(_0x102a4a)['length']!=0x0?(devices[_0x102a4a][_0x30dace(0x3e4)]=refreshToken(_0x102a4a),io['to'](_0x102a4a)['emit'](_0x30dace(0x207),{'status':_0x30dace(0x32e),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x102a4a][_0x30dace(0x3e4)],'externalip':devices[_0x102a4a]['ip'],'publicKey':secure[_0x30dace(0x32f)],'validInstallation':validInstallation}),setTokenRefresh(_0x102a4a)):clearTimeout(devices[_0x102a4a][_0x30dace(0x33e)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x33d8c5){const _0x25690d=_0x53bb91,_0x56788b=getClient(_0x33d8c5['id'])[_0x25690d(0x3d8)];_0x33d8c5[_0x25690d(0x3f8)](_0x25690d(0x2c0),config),_0x33d8c5[_0x25690d(0x3f8)](_0x25690d(0x217),cleanSettings()),_0x33d8c5['on'](_0x25690d(0x233),_0x178161=>{if(validateAccess(_0x178161,_0x56788b)['allow'])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x33d8c5['on'](_0x25690d(0x311),(_0x5180e2,_0x45a906)=>{const _0xe1a953=_0x25690d;if(validateAccess(_0x45a906,_0x56788b)[_0xe1a953(0x359)])toggleBot(_0x5180e2[_0xe1a953(0x389)],_0x5180e2[_0xe1a953(0x207)],_0x5180e2[_0xe1a953(0x204)]);else logger['full'](_0xe1a953(0x28a));}),_0x33d8c5['on'](_0x25690d(0x227),(_0x4214e8,_0x52796f)=>{const _0x3318f4=_0x25690d;if(validateAccess(_0x52796f,_0x56788b)[_0x3318f4(0x359)])toggleBotMode(_0x4214e8);else logger[_0x3318f4(0x37b)](_0x3318f4(0x28a));}),_0x33d8c5['on']('delete-bot',(_0x5d6e97,_0x51dd66)=>{const _0x2578e3=_0x25690d;if(validateAccess(_0x51dd66,_0x56788b)[_0x2578e3(0x359)])deleteBot(_0x5d6e97);else logger[_0x2578e3(0x37b)](_0x2578e3(0x2a2));}),_0x33d8c5['on']('store-settings',(_0x12dd8c,_0x46b436)=>{const _0x2743ef=_0x25690d;if(validateAccess(_0x46b436,_0x56788b)[_0x2743ef(0x359)])storeSettings(_0x12dd8c,!![]);else logger['full'](_0x2743ef(0x2a7));}),_0x33d8c5['on']('update-bb',_0x24b86a=>{const _0xc2bc9e=_0x25690d;if(validateAccess(_0x24b86a,_0x56788b)[_0xc2bc9e(0x359)])updateBB('update');else logger[_0xc2bc9e(0x37b)](_0xc2bc9e(0x39d));}),_0x33d8c5['on'](_0x25690d(0x3f2),_0x2ff716=>{const _0x55456a=_0x25690d;if(validateAccess(_0x2ff716,_0x56788b)[_0x55456a(0x359)])updateBB(_0x55456a(0x3c3));else logger[_0x55456a(0x37b)](_0x55456a(0x299));}),_0x33d8c5['on']('get-backup-files',_0xa344da=>{const _0x265d9b=_0x25690d;if(validateAccess(_0xa344da,_0x56788b)[_0x265d9b(0x359)]){const _0x361136=getClient(_0x33d8c5['id']);if(_0x361136)getBackupFiles(_0x361136[_0x265d9b(0x3d8)]);else logger[_0x265d9b(0x37b)](_0x265d9b(0x268));}else logger[_0x265d9b(0x37b)](_0x265d9b(0x3b5));}),_0x33d8c5['on'](_0x25690d(0x2a6),(_0x55e184,_0x55521d)=>{const _0x396b73=_0x25690d;if(validateAccess(_0x55521d,_0x56788b)[_0x396b73(0x359)])restoreBackupFile(_0x55e184);else logger[_0x396b73(0x37b)](_0x396b73(0x362));}),_0x33d8c5['on'](_0x25690d(0x244),_0x406ba4=>{const _0x4b8fdd=_0x25690d;if(validateAccess(_0x406ba4,_0x56788b)[_0x4b8fdd(0x359)])getMessages();else logger[_0x4b8fdd(0x37b)](_0x4b8fdd(0x3f0));}),_0x33d8c5['on']('confirm-message',(_0xfdbb20,_0x43a629)=>{const _0x45913c=_0x25690d;if(validateAccess(_0x43a629,_0x56788b)[_0x45913c(0x359)])confirmMessage(_0xfdbb20);else logger[_0x45913c(0x37b)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x33d8c5['on']('logout',_0x2688be=>{const _0x3c49de=_0x25690d;if(validateAccess(_0x2688be,_0x56788b)['allow']){if(devices[_0x56788b][_0x3c49de(0x33e)])clearTimeout(devices[_0x56788b]['pidRefreshToken']);if(devices[_0x56788b]['pidExpireLogin'])clearTimeout(devices[_0x56788b][_0x3c49de(0x34b)]);removeSocketListeners(getClient(_0x33d8c5['id'])[_0x3c49de(0x3d8)]),addBlacklist(_0x56788b),devices[_0x56788b][_0x3c49de(0x34c)]=null,devices[_0x56788b]['telegram2FaApproval']=null,devices[_0x56788b][_0x3c49de(0x3e4)][_0x3c49de(0x224)]=null,logger[_0x3c49de(0x2e0)](_0x3c49de(0x2b0)+_0x56788b['slice'](-0x8)),io['to'](getClient(_0x33d8c5['id'])[_0x3c49de(0x3d8)])['emit'](_0x3c49de(0x207),{'access':{'allow':![],'reason':_0x3c49de(0x298),'token':null}});}else logger[_0x3c49de(0x37b)](_0x3c49de(0x2dd));});}function initializeSocketBot(_0x2e54bf){const _0x9882ce=_0x53bb91,_0x30817e=getClient(_0x2e54bf['id'])[_0x9882ce(0x3e0)],_0x3b9825=getClient(_0x2e54bf['id'])['uuid'];_0x2e54bf['on'](_0x9882ce(0x2d3),(_0x322b87,_0x13cca4)=>{const _0x3c206c=_0x9882ce;if(validateAccess(_0x13cca4,_0x3b9825)[_0x3c206c(0x359)]){if(pid[_0x30817e])pid[_0x30817e][_0x3c206c(0x2a4)]({'function':_0x3c206c(0x307),'args':_0x322b87});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x2e54bf['on'](_0x9882ce(0x336),(_0x52e27f,_0x884ee9)=>{const _0x48d5e4=_0x9882ce;if(validateAccess(_0x884ee9,_0x3b9825)[_0x48d5e4(0x359)]){if(pid[_0x30817e])pid[_0x30817e][_0x48d5e4(0x2a4)]({'function':_0x48d5e4(0x253),'args':_0x52e27f});}else logger[_0x48d5e4(0x37b)](_0x48d5e4(0x30f));}),_0x2e54bf['on']('get-portfolio',(_0x16424d,_0x1648aa)=>{const _0x1246a3=_0x9882ce;if(validateAccess(_0x1648aa,_0x3b9825)[_0x1246a3(0x359)]){if(pid[_0x30817e])pid[_0x30817e][_0x1246a3(0x2a4)]({'function':_0x1246a3(0x24e),'args':_0x16424d});}else logger['full'](_0x1246a3(0x3b3));}),_0x2e54bf['on'](_0x9882ce(0x305),(_0x522533,_0x5a3c08)=>{const _0x4e3e0b=_0x9882ce;if(validateAccess(_0x5a3c08,_0x3b9825)[_0x4e3e0b(0x359)]){if(pid[_0x30817e])pid[_0x30817e][_0x4e3e0b(0x2a4)]({'function':'storeConfiguration','args':_0x522533});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x2e54bf['on'](_0x9882ce(0x3cc),(_0x372540,_0x3f988f)=>{const _0x13620b=_0x9882ce;if(validateAccess(_0x3f988f,_0x3b9825)[_0x13620b(0x359)]){if(pid[_0x30817e])pid[_0x30817e][_0x13620b(0x2a4)]({'function':_0x13620b(0x334),'args':_0x372540});}else logger[_0x13620b(0x37b)](_0x13620b(0x3c8));}),_0x2e54bf['on'](_0x9882ce(0x2a0),(_0x335054,_0x2863a8)=>{const _0x41aafa=_0x9882ce;if(validateAccess(_0x2863a8,_0x3b9825)[_0x41aafa(0x359)]){if(pid[_0x30817e])pid[_0x30817e][_0x41aafa(0x2a4)]({'function':'storeFiat','args':_0x335054});}else logger[_0x41aafa(0x37b)](_0x41aafa(0x29e));}),_0x2e54bf['on'](_0x9882ce(0x328),_0x49b3d2=>{const _0x1c86ca=_0x9882ce;if(validateAccess(_0x49b3d2,_0x3b9825)[_0x1c86ca(0x359)]){if(pid[_0x30817e])pid[_0x30817e]['send']({'function':'resetHistory','args':null});}else logger['full'](_0x1c86ca(0x288));}),_0x2e54bf['on'](_0x9882ce(0x240),_0x3822b5=>{const _0x207cee=_0x9882ce;if(validateAccess(_0x3822b5,_0x3b9825)['allow']){if(pid[_0x30817e])pid[_0x30817e][_0x207cee(0x2a4)]({'function':_0x207cee(0x22e),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x2e54bf['on'](_0x9882ce(0x260),(_0x12207a,_0x23b968)=>{const _0x372155=_0x9882ce;if(validateAccess(_0x23b968,_0x3b9825)[_0x372155(0x359)]){if(pid[_0x30817e])pid[_0x30817e][_0x372155(0x2a4)]({'function':'placeOrder','args':_0x12207a});}else logger['full'](_0x372155(0x314));}),_0x2e54bf['on'](_0x9882ce(0x274),_0x2cddf8=>{const _0x4ce8bd=_0x9882ce;if(validateAccess(_0x2cddf8,_0x3b9825)[_0x4ce8bd(0x359)]){if(pid[_0x30817e])pid[_0x30817e][_0x4ce8bd(0x2a4)]({'function':_0x4ce8bd(0x252),'args':null});}else logger['full'](_0x4ce8bd(0x2fc));}),_0x2e54bf['on'](_0x9882ce(0x1f2),_0x33de4e=>{const _0x4ca613=_0x9882ce;if(validateAccess(_0x33de4e,_0x3b9825)[_0x4ca613(0x359)]){if(pid[_0x30817e])pid[_0x30817e][_0x4ca613(0x2a4)]({'function':_0x4ca613(0x2ff),'args':null});}else logger[_0x4ca613(0x37b)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x2e54bf['on'](_0x9882ce(0x2e9),_0x15e059=>{const _0x12218e=_0x9882ce;if(validateAccess(_0x15e059,_0x3b9825)[_0x12218e(0x359)])updateBB('update');else logger[_0x12218e(0x37b)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x2e54bf['on'](_0x9882ce(0x244),_0x86b60e=>{const _0x10333c=_0x9882ce;if(validateAccess(_0x86b60e,_0x3b9825)[_0x10333c(0x359)])getMessages();else logger[_0x10333c(0x37b)](_0x10333c(0x3f0));}),_0x2e54bf['on'](_0x9882ce(0x33f),(_0x15c185,_0x5bc477)=>{const _0x3fdfe7=_0x9882ce;if(validateAccess(_0x5bc477,_0x3b9825)[_0x3fdfe7(0x359)])confirmMessage(_0x15c185);else logger[_0x3fdfe7(0x37b)](_0x3fdfe7(0x2b1));}),_0x2e54bf['on'](_0x9882ce(0x277),_0x515c55=>{const _0x408793=_0x9882ce;if(validateAccess(_0x515c55,_0x3b9825)['allow']){if(devices[_0x3b9825][_0x408793(0x33e)])clearTimeout(devices[_0x3b9825][_0x408793(0x33e)]);if(devices[_0x3b9825][_0x408793(0x34b)])clearTimeout(devices[_0x3b9825]['pidExpireLogin']);removeSocketListeners(getClient(_0x2e54bf['id'])[_0x408793(0x3d8)]),addBlacklist(_0x3b9825),devices[_0x3b9825][_0x408793(0x34c)]=null,devices[_0x3b9825][_0x408793(0x349)]=null,devices[_0x3b9825][_0x408793(0x3e4)][_0x408793(0x224)]=null,logger[_0x408793(0x2e0)](_0x408793(0x2b0)+_0x3b9825['slice'](-0x8)),io['to'](getClient(_0x2e54bf['id'])['uuid'])['emit'](_0x408793(0x207),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x408793(0x37b)](_0x408793(0x2dd));});}function removeSocketListeners(_0xd2b8c4){const _0x2c7787=_0x53bb91;getClientsWithUuid(_0xd2b8c4)[_0x2c7787(0x2b5)](_0x2095c1=>{const _0x1fa78d=_0x2c7787;getSocket(_0x2095c1['id'])[_0x1fa78d(0x267)]();});}function cleanSettings(){const _0x58fe1e=_0x53bb91;let _0x51f9af=settings;return settings[_0x58fe1e(0x3d6)]&&settings[_0x58fe1e(0x3d6)]!=''&&(_0x51f9af={..._0x51f9af,'telegramToken':_0x58fe1e(0x231)}),settings['bbPassword']&&settings[_0x58fe1e(0x38b)]!=''&&(_0x51f9af={..._0x51f9af,'bbPassword':_0x58fe1e(0x231)}),settings[_0x58fe1e(0x291)]&&settings[_0x58fe1e(0x291)]!=''&&(_0x51f9af={..._0x51f9af,'marketcapApi':_0x58fe1e(0x231)}),(settings[_0x58fe1e(0x38b)]&&settings['bbPassword']==_0x58fe1e(0x1e8)||settings['telegramToken']&&settings['telegramToken']==_0x58fe1e(0x1e8)||settings[_0x58fe1e(0x291)]&&settings[_0x58fe1e(0x291)]==_0x58fe1e(0x1e8))&&(_0x51f9af={..._0x51f9af,'restored':{'password':settings[_0x58fe1e(0x38b)]==_0x58fe1e(0x1e8),'telegram':settings[_0x58fe1e(0x3d6)]=='***','marketcap':settings[_0x58fe1e(0x291)]=='***'}}),_0x51f9af;}async function updateBB(_0x2fdccd){const _0x3ea6e1=_0x53bb91;await backupConfigFiles(),installingUpdate=!![],config[_0x3ea6e1(0x2b5)](_0x358201=>{const _0x218508=_0x3ea6e1;restartBot(_0x358201[_0x218508(0x389)]);});if(_0x2fdccd==_0x3ea6e1(0x2d6))process[_0x3ea6e1(0x2a4)]({'update':!![],'environment':environment},_0x182e20=>{});else _0x2fdccd==_0x3ea6e1(0x3c3)&&process[_0x3ea6e1(0x2a4)]({'reinstall':!![],'environment':environment},_0x4f1b71=>{});}function _0x3d0b(_0x263eff,_0xd91cb8){const _0x584f6a=_0x42a8();return _0x3d0b=function(_0x3f46a8,_0x1c808a){_0x3f46a8=_0x3f46a8-0x1e7;let _0x42a87=_0x584f6a[_0x3f46a8];return _0x42a87;},_0x3d0b(_0x263eff,_0xd91cb8);}function startBot(_0xbeed56,_0x47bbc0,_0x3a3db2){const _0x348828=_0x53bb91;if(debugging)_0xbeed56[_0x348828(0x320)]('-d');let _0x2d5a17=![];const _0x345d4e=_0xbeed56[0x0];_0x47bbc0={..._0x47bbc0,'stdio':[_0x348828(0x1f6),'inherit',_0x348828(0x1f6),'ipc']},pid[_0x345d4e]=childProcess[_0x348828(0x306)](botfile,_0xbeed56,_0x47bbc0),pid[_0x345d4e]['on'](_0x348828(0x37d),_0xf81588=>{const _0x59d2bc=_0x348828;switch(Object[_0x59d2bc(0x22c)](_0xf81588)[0x0]){case _0x59d2bc(0x230):updateBotName(_0x345d4e,_0xf81588[_0x59d2bc(0x230)]);break;case _0x59d2bc(0x32c):updateBotManager();break;case _0x59d2bc(0x207):updateStatus(_0x345d4e,_0xf81588[_0x59d2bc(0x207)]);break;case _0x59d2bc(0x204):updateLive(_0x345d4e,_0xf81588['live']);break;case _0x59d2bc(0x390):updateLive(_0x345d4e,_0xf81588['started']),io['to'](_0x345d4e)[_0x59d2bc(0x3f8)](_0x59d2bc(0x207),{'access':{'allow':![],'reason':_0x59d2bc(0x2a5),'token':null}});break;case'stop':_0xf81588[_0x59d2bc(0x269)]==_0x59d2bc(0x28c)&&restartBot(_0x345d4e);_0xf81588[_0x59d2bc(0x269)]==_0x59d2bc(0x2e4)&&toggleBot(_0x345d4e,_0x59d2bc(0x364),'stopped');break;case _0x59d2bc(0x371):sendTelegramBot(_0x345d4e,_0xf81588[_0x59d2bc(0x371)]);break;case _0x59d2bc(0x325):sendTelegramMsg(_0xf81588[_0x59d2bc(0x325)]);break;case'function':io['to'](_0x345d4e)[_0x59d2bc(0x3f8)](_0xf81588[_0x59d2bc(0x2cc)],_0xf81588[_0x59d2bc(0x355)]);break;}}),pid[_0x345d4e]['on']('error',function(_0x4373d8){if(_0x2d5a17)return;_0x2d5a17=!![],_0x3a3db2(_0x4373d8);}),pid[_0x345d4e]['on'](_0x348828(0x22d),async function(_0x3e2af5){const _0x142d69=_0x348828;if(terminating)return;if(installingUpdate){logger[_0x142d69(0x2e0)]('Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process'),io[_0x142d69(0x226)]();return;}if(_0x2d5a17)return;_0x2d5a17=!![],_0x3a3db2(null);const _0x4b1ab6=dbConfig['get'](_0x142d69(0x2c0))[_0x142d69(0x1fd)]({'botID':_0x345d4e})[_0x142d69(0x356)]();_0x4b1ab6&&(_0x4b1ab6['status']==_0x142d69(0x297)||_0x4b1ab6[_0x142d69(0x207)]==_0x142d69(0x31f))&&(await sleep(0x3e8),updateLive(_0x345d4e,_0x142d69(0x1ee)),logger[_0x142d69(0x37b)]('Restarting\x20Bot\x20'+_0x345d4e),startBot([_0x345d4e,userID],{'cwd':bbpath},function(_0x53c7e7){if(_0x53c7e7)logger['full'](_0x53c7e7);}));});}function stopBot(_0x3e8c02){const _0x2a65fa=_0x53bb91;getClientsWithBotID(_0x3e8c02)[_0x2a65fa(0x2b5)](_0x215a83=>{const _0xd69c05=_0x2a65fa;getSocket(_0x215a83['id'])[_0xd69c05(0x256)](!![]),removeClient(_0x215a83['id']);}),pid[_0x3e8c02]&&(pid[_0x3e8c02][_0x2a65fa(0x2e4)](),pid[_0x3e8c02]=null);}function stopAllBots(){terminating=!![];const _0x39308e=getEnabledBots();_0x39308e['forEach'](_0x1106ec=>{const _0xb42102=_0x3d0b;stopBot(_0x1106ec[_0xb42102(0x389)]);});}function restartBot(_0x127343){if(pid[_0x127343])pid[_0x127343]['kill']();}function addBot(){const _0x20d581=_0x53bb91;let _0x17a628;for(let _0x311140=0x1;_0x311140<0x3e9;_0x311140++){_0x17a628=_0x311140[_0x20d581(0x329)]()['padStart'](0x3,'0');let _0x4448e9=config[_0x20d581(0x1fd)](_0x4be0f8=>_0x4be0f8[_0x20d581(0x389)]==_0x17a628);if(!_0x4448e9)break;}if(_0x17a628===_0x20d581(0x27d)){logger[_0x20d581(0x37b)](_0x20d581(0x33b));return;}logger[_0x20d581(0x37b)](_0x20d581(0x302)+_0x17a628),dbConfig[_0x20d581(0x3e2)](_0x20d581(0x2c0))[_0x20d581(0x320)]({'botID':_0x17a628,'botname':_0x20d581(0x271)+_0x17a628,'status':_0x20d581(0x31f),'live':''})[_0x20d581(0x2cd)](),startBot([_0x17a628,userID],{'cwd':bbpath},function(_0x590586){const _0x509f73=_0x20d581;if(_0x590586)logger[_0x509f73(0x37b)](_0x590586);}),config=getConfiguration(),io['to']('botmanager')[_0x20d581(0x3f8)](_0x20d581(0x2c0),config),broadcastToBots(_0x20d581(0x2c0),JSON[_0x20d581(0x242)](config));}function deleteBot(_0x362ba3){const _0x1c5060=_0x53bb91;getClientsWithBotID(_0x362ba3)['forEach'](_0x5f39b5=>{const _0x112ab6=_0x3d0b;getSocket(_0x5f39b5['id'])[_0x112ab6(0x256)](!![]),removeClient(_0x5f39b5['id']);}),dbConfig[_0x1c5060(0x3e2)](_0x1c5060(0x2c0))[_0x1c5060(0x312)]({'botID':_0x362ba3})[_0x1c5060(0x2cd)](),logger[_0x1c5060(0x37b)](_0x1c5060(0x21d)+_0x362ba3),stopBot(_0x362ba3);try{if(fs['existsSync'](path[_0x1c5060(0x2de)](configpath,_0x1c5060(0x2ce)+_0x362ba3+'-config.json')))fs[_0x1c5060(0x2b8)](path[_0x1c5060(0x2de)](configpath,_0x1c5060(0x2ce)+_0x362ba3+_0x1c5060(0x3c7)));if(fs['existsSync'](path[_0x1c5060(0x2de)](configpath,_0x1c5060(0x2ce)+_0x362ba3+_0x1c5060(0x36e))))fs[_0x1c5060(0x2b8)](path['join'](configpath,'bot-'+_0x362ba3+'-events.json'));if(fs[_0x1c5060(0x250)](path['join'](configpath,_0x1c5060(0x2ce)+_0x362ba3+_0x1c5060(0x3ba))))fs[_0x1c5060(0x2b8)](path[_0x1c5060(0x2de)](configpath,_0x1c5060(0x2ce)+_0x362ba3+_0x1c5060(0x3ba)));if(fs[_0x1c5060(0x250)](path[_0x1c5060(0x2de)](configpath,_0x1c5060(0x2ce)+_0x362ba3+_0x1c5060(0x3db))))fs['unlinkSync'](path[_0x1c5060(0x2de)](configpath,_0x1c5060(0x2ce)+_0x362ba3+'-results.json'));}catch(_0x2fa7dd){if(_0x2fa7dd)logger[_0x1c5060(0x37b)](_0x1c5060(0x3f4),_0x2fa7dd);}config=getConfiguration(),io['to'](_0x1c5060(0x222))[_0x1c5060(0x3f8)](_0x1c5060(0x2c0),config),broadcastToBots(_0x1c5060(0x2c0),JSON[_0x1c5060(0x242)](config));}function _0x42a8(){const _0xe016f=['::ffff:127.0.0.1','messages','get-logs','create','tempaccess_reject_','update','Logged\x20in\x20user\x20...','rmSync','auto','backup-full@','static','writeFileSync','Unauthorized\x20attempt\x20to\x20log\x20out','join','Login\x20accepted','debug','yes','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','config','kill','test','clients','login','restore_yes_','update-bb','randomBytes','readFileSync','zip/','sendMessage','verify','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','createWriteStream','\x20to\x20','-----------------------------------------------------------------------------------','from','isDirectory','Restore\x20process\x20aborted','temporary\x20token\x20generated','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','SIGTERM','apiSecret','event','bbvNew','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','staging','format','showConfig','socket','api-eu.mixpanel.com','Starting\x20new\x20bot\x20|\x20Bot\x20','login\x20not\x20required','\x20>\x20','store-configuration','fork','emitHistory','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','resetpw_yes','error','Notifications\x20types:\x20','Server','login\x20required','\x1b[31m','Unauthorized\x20attempt\x20to\x20delete\x20alerts','kind','update-bot','remove','223386pIzECJ','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','file','telegramEnabled','Failed\x20to\x20download\x20','clientip','size','Notifications\x20enabled\x0a','0.0.0','/download/:type','loginRequired','reinstall_yes','new','push','getDate','portfolio_','files','=>\x20Go\x20to\x20#CYA#http://','telegrammsg','off','Setting\x20access:\x20','reset-history','toString','getMinutes','Invalid\x20IP\x20address','updatebotmanager','startsWith','connected','publicKey','showname','/:bot','family','bot.js','storeHeadless','output-001.log','delete-alerts','internal','/help\x20-\x20show\x20available\x20commands\x0a','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Ok,\x20will\x20send\x20order\x20notifications\x20only','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','/output-000.log','init','pidRefreshToken','confirm-message','sockets','hasOwnProperty','sort','auth','/:bot/coins','resetpw_no','track','bb-secure.json','constructor','telegram2FaApproval','mkdirSync','pidExpireLogin','telegramIpApproval','build2','restore_no_','*$1*','output-003.log','telegramChatId','temporary\x20access\x20not\x20allowed','logs/','Error\x20details:','args','value','metrics_','Access\x20enabled\x20for\x20','allow','pki','running','Backup\x20file\x20uploaded','user','handshake','/enable\x20-\x20enable\x20notifications\x0a','publicKeyToPem','alerts','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Backup\x20file\x20unzipped\x20and\x20stored','disabled','createServer','bbUsername','axios','|@|','24wHfOhW','lastmsgemitted','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','referer','.zip','-events.json','#RES#','min','telegram','action','$1_$2_$3','accept','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','userid','1416RGLJMt','catch','ipaddr.js','6EeYcLr','full','You\x20can\x20use\x20the\x20following\x20commands:\x0a','message','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','No\x20bots\x20running\x20right\x20now','filter','reject','sendPortfolioTelegram','15158wBCZaV','chat','button','Markdown','string','temp/','botID','http','bbPassword','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Starting\x20Balance\x20Bot\x20reinstallation','#RES#\x20','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','started','assign','params','order','<b>Balance\x20Bot\x20Status:</b>\x0a','private','add','\x20|\x20user:\x20...','node','address','config_orders','\x20(1)','toggle','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Unauthorized\x20attempt\x20to\x20download\x20','use','sortBy','Telegram\x20error:','async','secret','latestversion','Notifications\x20disabled\x0a','privateKeyFromPem','DEFLATE','/status\x20-\x20show\x20bot(s)\x20status\x0a','sha256','Invalid\x20username\x20or\x20IP\x20address','headers','config_all','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','sendFile','Unauthorized\x20login\x20attempt\x20(timeout)','#RES#\x20if\x20running\x20locally\x0a','(((.+)+)+)+$','Unauthorized\x20attempt\x20to\x20get\x20portfolio','type','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','length','binary','-performance.json','/disable\x20-\x20disable\x20notifications\x0a','sendMetricsTelegram','generateAsync','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Bot\x20Mgr\x20>\x20','endsWith','connection','reinstall','help','bb/','2FA','-config.json','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','2FA\x20login\x20required','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','BCT','store-headless','#RES#\x20if\x20running\x20on\x20server','copyFileSync','All\x20bots','2FA\x20required','CoinMarketCap\x20API\x20key\x20validated','config_alerts','new-disabled','bb-config.json','remoteAddress','telegramToken','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','uuid','\x1b[34m','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','-results.json','timeshift','apply','node-forge','production','bot','rsa','get','initclient','access','Starting\x20#RED#Balance\x20Bot\x20v','getHours','alias','IPv4',')\x20\x20\x20|\x20Bot\x20','Allow\x20login\x20from\x20IP\x20address\x20','logs','expiry','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','output-000.log','environment','Unauthorized\x20attempt\x20to\x20get\x20messages','/:bot/configuration','reinstall-bb','show','Error\x20while\x20deleting\x20config\x20files:\x20','download','73130VcFbSq','631370SbQXDc','emit','274020TSjluW','randomFillSync','access\x20timeout','warning','name','/names\x20-\x20show\x20bot\x20names\x0a','hashSync','***','exp',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','headless','Enabled\x20Bot\x20','privateKey','stopped','padStart','reason','/update\x20-\x20update\x20Balance\x20Bot\x0a','show-config','/off\x20-\x20stop\x20bot(s)\x0a','date-fns','Password\x20reset\x20rejected','inherit','Node.js\x20v','33DCppAq','settings.','readdirSync','conn','title','find','path','15\x20min','\x1b[33m','toIPv4Address','isIPv4MappedAddress','f2aRequired','live','ETH','getSeconds','status','3ESRKjA','argv','/:bot/history','server','\x1b[35m','/:bot/performance','backup','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','address\x20already\x20in\x20use','output-002.log','reset-password','Token\x20blacklisted','Yes','util','Starting\x20Balance\x20Bot\x20update','settings','458160RIoUNH','orders','invalid\x20credentials','::1','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Deleted\x20Bot\x20','whitelistEnabled','Notifications\x20enabled','login\x20token\x20valid','Ok,\x20will\x20send\x20alert\x20notifications\x20only','botmanager','Password\x20has\x20been\x20reset\x20to:\x20','token','mtime','close','toggle-bot-mode','login\x20token\x20generated','Error:\x20Invalid\x20argument\x20','Network\x20Interfaces:','launch','keys','exit','getStartingBalances','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','botname','************','ipv6','add-bot','metrics','includes','portfolio','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Login\x20rejected','port','telegramEvents','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','login2fa_','listen','30\x20min','get-starting-balances','\x20|\x20client:\x20...','stringify','loadAsync','get-messages','https://api.ipify.org?format=json','NTBA_FIX_319','Telegraf\x20error:','version.json','all','data','restart_','uuid-random','\x20-\x20','getPortfolio','HTML','existsSync','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','cancelLoading','deleteHistoryAlerts','/start','generateKeyPair','disconnect','bb-settings.json','backup/','command','store','blacklist','yargs/yargs','callback','secure','once','place-order','onepagemode','map','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','/restart\x20-\x20restart\x20bot(s)\x0a','telegraf','SIGINT','removeAllListeners','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','stop','getTime','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','backup-full','\x20mode','search','number','match','Bot\x20','toggle_','lastmsgtelegram','cancel-loading','express','tempaccess_30_','logout','mode','range','uncaughtException','any','index.html','1000','whitelist','simple','reply','replace','jszip','\x1b[36m','\x20minutes','sign','User\x20has\x20been\x20validated','Starting\x20(','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','config/','Unauthorized\x20attempt\x20to\x20update\x20bot','telegramUsername','restart','set','getUTCHours','Your\x20installation\x20is\x20already\x20up\x20to\x20date','log','marketcapApi','success','654867EKGNsG','slice','statSync','build','enabled','logged\x20out','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','version','timestamp','bcryptjs','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','isValid','store-fiat','parse','Unauthorized\x20attempt\x20to\x20delete\x20bot','split','send','reload','restore-backup-file','Unauthorized\x20attempt\x20to\x20update\x20settings','Orders','notification','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','bbvReceive','off_',')\x20|\x20Bot\x20','manual','password','Logged\x20out\x20user\x20...','Unauthorized\x20attempt\x20to\x20confirm\x20message','getMonth','getFullYear','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','forEach','14ZZJsCI','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','unlinkSync','status\x20code\x20401','Alerts','\x20|\x20','Temporary\x20access\x20rejected','code','graphql-request','Error\x20removing\x20old\x20backup\x20files:','bots','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','inlineKeyboard','/:bot/support','username','All','defaults','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','<b>Telegram\x20Bot\x20Status:</b>\x0a','backupfile','editMessageReplyMarkup','reinstall_no','function','write','bot-',':\x20Bot\x20Mgr\x20>\x20','apiPassword'];_0x42a8=function(){return _0xe016f;};return _0x42a8();}function toggleBot(_0x126160,_0x3c5e24,_0x43e06e){const _0x4a6fec=_0x53bb91;dbConfig['get'](_0x4a6fec(0x2c0))[_0x4a6fec(0x1fd)]({'botID':_0x126160})[_0x4a6fec(0x391)]({'status':_0x3c5e24})['assign']({'live':_0x43e06e})[_0x4a6fec(0x2cd)]();if(_0x3c5e24==_0x4a6fec(0x297)||_0x3c5e24==_0x4a6fec(0x31f))logger['full'](_0x4a6fec(0x1ec)+_0x126160),startBot([_0x126160,userID],{'cwd':bbpath},function(_0x4981f4){const _0x18eb6d=_0x4a6fec;if(_0x4981f4)logger[_0x18eb6d(0x37b)](_0x4981f4);});else(_0x3c5e24==_0x4a6fec(0x364)||_0x3c5e24=='new-disabled')&&(logger[_0x4a6fec(0x37b)]('Disabled\x20Bot\x20'+_0x126160),stopBot(_0x126160));config=getConfiguration(),io['to'](_0x4a6fec(0x222))[_0x4a6fec(0x3f8)](_0x4a6fec(0x2c0),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleStatus(_0x47c2e4){const _0x544296=_0x53bb91;let _0x356d90=dbConfig[_0x544296(0x3e2)](_0x544296(0x2c0))['find']({'botID':_0x47c2e4})[_0x544296(0x356)](),_0x18e7a7;if(_0x356d90[_0x544296(0x207)]===_0x544296(0x297))_0x18e7a7=_0x544296(0x364);else{if(_0x356d90[_0x544296(0x207)]===_0x544296(0x31f))_0x18e7a7=_0x544296(0x3d3);else{if(_0x356d90['status']==='new-disabled')_0x18e7a7=_0x544296(0x31f);else{if(_0x356d90['status']===_0x544296(0x364))_0x18e7a7=_0x544296(0x297);}}}return _0x18e7a7;}function updateStatus(_0x1d8d5c,_0x412172){const _0x25dad7=_0x53bb91;dbConfig[_0x25dad7(0x3e2)](_0x25dad7(0x2c0))[_0x25dad7(0x1fd)]({'botID':_0x1d8d5c})[_0x25dad7(0x391)]({'status':_0x412172})[_0x25dad7(0x2cd)](),config=getConfiguration(),io['to'](_0x25dad7(0x222))[_0x25dad7(0x3f8)]('bots',config),broadcastToBots(_0x25dad7(0x2c0),JSON[_0x25dad7(0x242)](config));}function updateLive(_0x3c65cb,_0x15ce53){const _0x4d7da8=_0x53bb91;dbConfig[_0x4d7da8(0x3e2)](_0x4d7da8(0x2c0))[_0x4d7da8(0x1fd)]({'botID':_0x3c65cb})['assign']({'live':_0x15ce53})[_0x4d7da8(0x2cd)](),config=getConfiguration(),io['to'](_0x4d7da8(0x222))['emit'](_0x4d7da8(0x2c0),config),broadcastToBots(_0x4d7da8(0x2c0),JSON[_0x4d7da8(0x242)](config));}function updateBotName(_0x37dbf7,_0x183b8c){const _0x1ba5a4=_0x53bb91;dbConfig[_0x1ba5a4(0x3e2)](_0x1ba5a4(0x2c0))[_0x1ba5a4(0x1fd)]({'botID':_0x37dbf7})[_0x1ba5a4(0x391)]({'botname':_0x183b8c})[_0x1ba5a4(0x2cd)](),config=getConfiguration(),io['to'](_0x1ba5a4(0x222))[_0x1ba5a4(0x3f8)](_0x1ba5a4(0x2c0),config),broadcastToBots(_0x1ba5a4(0x2c0),JSON[_0x1ba5a4(0x242)](config));}function updateBotManager(){const _0x243b30=_0x53bb91;config=getConfiguration(),io['to']('botmanager')[_0x243b30(0x3f8)](_0x243b30(0x2c0),config),broadcastToBots(_0x243b30(0x2c0),JSON[_0x243b30(0x242)](config));}function toggleBotMode(_0x372687){const _0x1291f1=_0x53bb91;if(pid[_0x372687])pid[_0x372687][_0x1291f1(0x2a4)]({'function':'toggleBotMode','args':null});else{const _0x35b4a5=configpath+'bot-'+_0x372687+_0x1291f1(0x3c7),_0x400760=fs[_0x1291f1(0x2eb)](_0x35b4a5),_0x506730=JSON[_0x1291f1(0x2a1)](_0x400760),_0xbc7495=_0x506730[_0x1291f1(0x3e0)][0x0][_0x1291f1(0x1eb)];_0x506730['bot'][0x0][_0x1291f1(0x1eb)]=!_0xbc7495;const _0xdcbd72=JSON['stringify'](_0x506730,null,0x2);fs[_0x1291f1(0x2dc)](_0x35b4a5,_0xdcbd72),config=getConfiguration(),io['to'](_0x1291f1(0x222))[_0x1291f1(0x3f8)](_0x1291f1(0x2c0),config),broadcastToBots(_0x1291f1(0x2c0),JSON[_0x1291f1(0x242)](config));}}function validateTelegram(_0x2365bf){const _0x21fab5=_0x53bb91;if(_0x2365bf['from'][_0x21fab5(0x2c4)]!=settings[_0x21fab5(0x28b)]&&'@'+_0x2365bf[_0x21fab5(0x2f3)][_0x21fab5(0x2c4)]!=settings[_0x21fab5(0x28b)]||_0x2365bf[_0x21fab5(0x384)]['id']!=settings[_0x21fab5(0x351)])return sendTelegram(_0x2365bf['chat']['id'],_0x21fab5(0x36b),{'parse_mode':_0x21fab5(0x24f)}),![];return!![];}async function initTelegram(){const _0x5491a0=_0x53bb91;if(tgBot)tgBot[_0x5491a0(0x269)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x5491a0(0x3d6)]);let _0x11df78=_0x5491a0(0x37c);_0x11df78+='\x0a',_0x11df78+=_0x5491a0(0x35f),_0x11df78+=_0x5491a0(0x3bb),_0x11df78+=_0x5491a0(0x2b7),_0x11df78+=_0x5491a0(0x264),_0x11df78+='/on\x20-\x20start\x20bot(s)\x0a',_0x11df78+=_0x5491a0(0x1f3),_0x11df78+=_0x5491a0(0x2f7),_0x11df78+=_0x5491a0(0x3fe),_0x11df78+=_0x5491a0(0x3a9),_0x11df78+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x11df78+=_0x5491a0(0x3b7),_0x11df78+=_0x5491a0(0x1f1),_0x11df78+=_0x5491a0(0x375),_0x11df78+=_0x5491a0(0x338);let _0x630770=_0x5491a0(0x3b6);_0x630770+='\x0a',_0x630770+=_0x11df78,tgBot[_0x5491a0(0x378)]((_0x2a0051,_0x139b8a)=>{const _0x535998=_0x5491a0;logger[_0x535998(0x27f)](getTimeStamp()+_0x535998(0x1ea)),logger[_0x535998(0x2e0)](_0x535998(0x247),_0x2a0051);}),tgBot[_0x5491a0(0x3a0)](async(_0x3a038f,_0x454919)=>{const _0x5d661f=_0x5491a0;if(!(!settings[_0x5d661f(0x351)]&&_0x3a038f['update'][_0x5d661f(0x37d)]['text']==_0x5d661f(0x254))){if(!validateTelegram(_0x3a038f))return;}_0x454919();}),tgBot['command']('start',async _0x1ba5d1=>{const _0x5e47be=_0x5491a0;if(!settings[_0x5e47be(0x351)])updateSetting('telegramChatId',_0x1ba5d1[_0x5e47be(0x384)]['id']);updateSetting(_0x5e47be(0x316),!![]);if(!validateTelegram(_0x1ba5d1))return;await sendTelegram(_0x1ba5d1[_0x5e47be(0x384)]['id'],_0x630770);}),tgBot[_0x5491a0(0x259)]('enable',async _0x21f009=>{const _0x395967=_0x5491a0;updateSetting(_0x395967(0x316),!![]),await sendTelegram(_0x21f009[_0x395967(0x384)]['id'],_0x395967(0x21f));}),tgBot[_0x5491a0(0x259)]('disable',async _0x400a07=>{const _0x483a8e=_0x5491a0;await sendTelegram(_0x400a07[_0x483a8e(0x384)]['id'],'Notifications\x20disabled'),updateSetting(_0x483a8e(0x316),![]);}),tgBot[_0x5491a0(0x259)](_0x5491a0(0x2e3),async _0x28d4c8=>{const _0x398080=_0x5491a0,_0x2961e3=Markup[_0x398080(0x2c2)]([Markup[_0x398080(0x385)][_0x398080(0x25d)](_0x398080(0x2a8),_0x398080(0x39a)),Markup[_0x398080(0x385)][_0x398080(0x25d)](_0x398080(0x2ba),_0x398080(0x3d2)),Markup[_0x398080(0x385)]['callback'](_0x398080(0x2c5),_0x398080(0x3ad))]);_0x28d4c8[_0x398080(0x280)](_0x398080(0x2e2),_0x2961e3);}),tgBot[_0x5491a0(0x372)](_0x5491a0(0x39a),async _0x857a01=>{const _0x4f4346=_0x5491a0;_0x857a01[_0x4f4346(0x2ca)](),updateSetting(_0x4f4346(0x23a),_0x4f4346(0x219)),updateSetting(_0x4f4346(0x316),!![]),await sendTelegram(_0x857a01[_0x4f4346(0x384)]['id'],_0x4f4346(0x33a));}),tgBot['action'](_0x5491a0(0x3d2),async _0x4fc689=>{const _0x1958d1=_0x5491a0;_0x4fc689[_0x1958d1(0x2ca)](),updateSetting(_0x1958d1(0x23a),_0x1958d1(0x361)),updateSetting(_0x1958d1(0x316),!![]),await sendTelegram(_0x4fc689['chat']['id'],_0x1958d1(0x221));}),tgBot[_0x5491a0(0x372)](_0x5491a0(0x3ad),async _0x5ad0fd=>{const _0x38fc23=_0x5491a0;_0x5ad0fd[_0x38fc23(0x2ca)](),updateSetting(_0x38fc23(0x23a),_0x38fc23(0x249)),updateSetting(_0x38fc23(0x316),!![]),await sendTelegram(_0x5ad0fd[_0x38fc23(0x384)]['id'],_0x38fc23(0x39e));}),tgBot[_0x5491a0(0x259)]('status',async _0x20a895=>{const _0x39d3c1=_0x5491a0,_0x121115=getBotsWithMode();let _0x53a943=_0x39d3c1(0x394);config['forEach'](_0x385e02=>{const _0x47dc4a=_0x39d3c1,_0x2f46f9=_0x121115[_0x47dc4a(0x1fd)](_0x44ec47=>_0x44ec47[_0x47dc4a(0x389)]==_0x385e02['botID'])[_0x47dc4a(0x278)];_0x53a943+=_0x47dc4a(0x271)+_0x385e02[_0x47dc4a(0x389)]+':\x20'+_0x385e02['status']+'\x20|\x20'+_0x2f46f9+_0x47dc4a(0x2bb)+_0x385e02[_0x47dc4a(0x204)]+'\x0a';}),_0x53a943+='\x0a',_0x53a943+=_0x39d3c1(0x2c8),_0x53a943+=!settings[_0x39d3c1(0x316)]?_0x39d3c1(0x3a6):_0x39d3c1(0x31a),_0x53a943+=settings['telegramEnabled']?settings['telegramEvents']==_0x39d3c1(0x249)?_0x39d3c1(0x38f):_0x39d3c1(0x30b)+settings[_0x39d3c1(0x23a)]+'\x20only\x0a':'',await sendTelegram(_0x20a895['chat']['id'],_0x53a943,{'parse_mode':_0x39d3c1(0x24f)});}),tgBot['command']('restart',async _0x452546=>{const _0x253fb6=_0x5491a0,_0x3fbc6d=getEnabledBots();if(_0x3fbc6d[_0x253fb6(0x3b8)]==0x0)await sendTelegram(_0x452546[_0x253fb6(0x384)]['id'],_0x253fb6(0x37f));else{if(_0x3fbc6d[_0x253fb6(0x3b8)]>0x1)_0x3fbc6d['push']({'botID':'all'});let _0x2aff48=[],_0x4ba58d=[];const _0x1e2e1f=_0x3fbc6d['length']%0x4==0x0||_0x3fbc6d['length']%0x4==0x3||_0x3fbc6d[_0x253fb6(0x3b8)]%0x3==0x1?0x4:0x3;let _0x41e3d2=0x0;_0x3fbc6d[_0x253fb6(0x2b5)]((_0x1cb580,_0x219aaf)=>{const _0x189ac6=_0x253fb6;if(_0x219aaf%_0x1e2e1f==0x0)_0x4ba58d=[];_0x4ba58d['push'](Markup[_0x189ac6(0x385)][_0x189ac6(0x25d)](_0x1cb580['botID']==_0x189ac6(0x249)?'All\x20bots':_0x189ac6(0x271)+_0x1cb580['botID'],_0x189ac6(0x24b)+_0x1cb580['botID'])),_0x219aaf%_0x1e2e1f==0x0&&(_0x2aff48[_0x41e3d2]=_0x4ba58d,_0x41e3d2++);});const _0x150b34=Markup[_0x253fb6(0x2c2)](_0x2aff48);_0x452546[_0x253fb6(0x280)](_0x253fb6(0x38c),_0x150b34);}}),tgBot[_0x5491a0(0x372)](/restart_(.+)/,async _0x5a5083=>{const _0x41d672=_0x5491a0,_0x235418=_0x5a5083[_0x41d672(0x270)][0x1];_0x5a5083[_0x41d672(0x2ca)](),_0x235418==_0x41d672(0x249)?config[_0x41d672(0x2b5)](_0x6ee55d=>{const _0x10bf32=_0x41d672;restartBot(_0x6ee55d[_0x10bf32(0x389)]);}):restartBot(_0x235418);}),tgBot[_0x5491a0(0x259)]('on',async _0x1270f9=>{const _0x111f49=_0x5491a0,_0x353675=getDisabledBots();if(_0x353675['length']==0x0)await sendTelegram(_0x1270f9[_0x111f49(0x384)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x353675['length']>0x1)_0x353675['push']({'botID':_0x111f49(0x249)});let _0x823ac9=[],_0x5b9aa5=[];const _0x236adf=_0x353675[_0x111f49(0x3b8)]%0x4==0x0||_0x353675[_0x111f49(0x3b8)]%0x4==0x3||_0x353675['length']%0x3==0x1?0x4:0x3;let _0x405fbe=0x0;_0x353675[_0x111f49(0x2b5)]((_0x424224,_0x295662)=>{const _0x320e86=_0x111f49;if(_0x295662%_0x236adf==0x0)_0x5b9aa5=[];_0x5b9aa5[_0x320e86(0x320)](Markup['button'][_0x320e86(0x25d)](_0x424224[_0x320e86(0x389)]=='all'?'All\x20bots':'Bot\x20'+_0x424224[_0x320e86(0x389)],'on_'+_0x424224[_0x320e86(0x389)])),_0x295662%_0x236adf==0x0&&(_0x823ac9[_0x405fbe]=_0x5b9aa5,_0x405fbe++);});const _0x3f7236=Markup[_0x111f49(0x2c2)](_0x823ac9);_0x1270f9[_0x111f49(0x280)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x3f7236);}}),tgBot[_0x5491a0(0x372)](/on_(.+)/,async _0x5eda67=>{const _0x3bc034=_0x5491a0,_0x4fbd79=_0x5eda67[_0x3bc034(0x270)][0x1];_0x5eda67[_0x3bc034(0x2ca)]();if(_0x4fbd79==_0x3bc034(0x249)){const _0x30beae=getDisabledBots();await sendTelegram(_0x5eda67[_0x3bc034(0x384)]['id'],_0x3bc034(0x2ef)),_0x30beae[_0x3bc034(0x2b5)](_0x385074=>{const _0xdb22e=_0x3bc034;if(_0x385074[_0xdb22e(0x389)]!=_0xdb22e(0x249))toggleBot(_0x385074['botID'],toggleStatus(_0x385074[_0xdb22e(0x389)]),_0xdb22e(0x1ee));});}else await sendTelegram(_0x5eda67['chat']['id'],_0x3bc034(0x251)+_0x4fbd79),toggleBot(_0x4fbd79,toggleStatus(_0x4fbd79),_0x3bc034(0x1ee));}),tgBot[_0x5491a0(0x259)](_0x5491a0(0x326),async _0x519b09=>{const _0x37263b=_0x5491a0,_0x367a06=getEnabledBots();if(_0x367a06[_0x37263b(0x3b8)]==0x0)await sendTelegram(_0x519b09[_0x37263b(0x384)]['id'],_0x37263b(0x37f));else{if(_0x367a06[_0x37263b(0x3b8)]>0x1)_0x367a06[_0x37263b(0x320)]({'botID':_0x37263b(0x249)});let _0x4daf8a=[],_0x173e5c=[];const _0x516a70=_0x367a06[_0x37263b(0x3b8)]%0x4==0x0||_0x367a06[_0x37263b(0x3b8)]%0x4==0x3||_0x367a06[_0x37263b(0x3b8)]%0x3==0x1?0x4:0x3;let _0x59a1b8=0x0;_0x367a06[_0x37263b(0x2b5)]((_0x5bdfa3,_0x257450)=>{const _0x45facb=_0x37263b;if(_0x257450%_0x516a70==0x0)_0x173e5c=[];_0x173e5c[_0x45facb(0x320)](Markup[_0x45facb(0x385)][_0x45facb(0x25d)](_0x5bdfa3['botID']==_0x45facb(0x249)?_0x45facb(0x3cf):_0x45facb(0x271)+_0x5bdfa3[_0x45facb(0x389)],_0x45facb(0x2ac)+_0x5bdfa3[_0x45facb(0x389)])),_0x257450%_0x516a70==0x0&&(_0x4daf8a[_0x59a1b8]=_0x173e5c,_0x59a1b8++);});const _0x98fc94=Markup[_0x37263b(0x2c2)](_0x4daf8a);_0x519b09[_0x37263b(0x280)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x98fc94);}}),tgBot[_0x5491a0(0x372)](/off_(.+)/,async _0x161123=>{const _0x31acbc=_0x5491a0,_0x2bf7ee=_0x161123[_0x31acbc(0x270)][0x1];_0x161123[_0x31acbc(0x2ca)]();if(_0x2bf7ee==_0x31acbc(0x249)){const _0x4e3498=getEnabledBots();await sendTelegram(_0x161123[_0x31acbc(0x384)]['id'],_0x31acbc(0x3ca)),_0x4e3498[_0x31acbc(0x2b5)](_0x203cb2=>{const _0x14cba0=_0x31acbc;if(_0x203cb2[_0x14cba0(0x389)]!=_0x14cba0(0x249))toggleBot(_0x203cb2['botID'],toggleStatus(_0x203cb2[_0x14cba0(0x389)]),'stopped');});}else await sendTelegram(_0x161123[_0x31acbc(0x384)]['id'],_0x31acbc(0x2c7)+_0x2bf7ee),toggleBot(_0x2bf7ee,toggleStatus(_0x2bf7ee),_0x31acbc(0x1ee));}),tgBot[_0x5491a0(0x259)](_0x5491a0(0x234),async _0x1cba7d=>{const _0x2c0e0e=_0x5491a0,_0x39509f=getEnabledBots();if(_0x39509f[_0x2c0e0e(0x3b8)]==0x0)await sendTelegram(_0x1cba7d['chat']['id'],_0x2c0e0e(0x37f));else{if(_0x39509f['length']>0x1){let _0x10a884=[],_0x56ec2e=[];const _0x1e625e=_0x39509f[_0x2c0e0e(0x3b8)]%0x4==0x0||_0x39509f['length']%0x4==0x3||_0x39509f[_0x2c0e0e(0x3b8)]%0x3==0x1?0x4:0x3;let _0xa6f586=0x0;_0x39509f['forEach']((_0x437740,_0x65ef09)=>{const _0x29bf2c=_0x2c0e0e;if(_0x65ef09%_0x1e625e==0x0)_0x56ec2e=[];_0x56ec2e['push'](Markup[_0x29bf2c(0x385)][_0x29bf2c(0x25d)](_0x29bf2c(0x271)+_0x437740[_0x29bf2c(0x389)],_0x29bf2c(0x357)+_0x437740['botID'])),_0x65ef09%_0x1e625e==0x0&&(_0x10a884[_0xa6f586]=_0x56ec2e,_0xa6f586++);});const _0x4cd0fc=Markup[_0x2c0e0e(0x2c2)](_0x10a884);_0x1cba7d[_0x2c0e0e(0x280)](_0x2c0e0e(0x37e),_0x4cd0fc);}else{const _0x21dbec=_0x39509f[0x0][_0x2c0e0e(0x389)];if(pid[_0x21dbec])pid[_0x21dbec]['send']({'function':_0x2c0e0e(0x3bc),'args':null});}}}),tgBot[_0x5491a0(0x372)](/metrics_(.+)/,async _0x4940a9=>{const _0x3ee01d=_0x5491a0,_0x5d642c=_0x4940a9['match'][0x1];_0x4940a9['editMessageReplyMarkup']();if(pid[_0x5d642c])pid[_0x5d642c][_0x3ee01d(0x2a4)]({'function':_0x3ee01d(0x3bc),'args':null});}),tgBot[_0x5491a0(0x259)](_0x5491a0(0x236),async _0x3f36bc=>{const _0x72fd7b=_0x5491a0,_0x12b16c=getEnabledBots();if(_0x12b16c[_0x72fd7b(0x3b8)]==0x0)await sendTelegram(_0x3f36bc[_0x72fd7b(0x384)]['id'],_0x72fd7b(0x37f));else{if(_0x12b16c[_0x72fd7b(0x3b8)]>0x1){let _0x1b8fae=[],_0x243d58=[];const _0x7fcd8e=_0x12b16c[_0x72fd7b(0x3b8)]%0x4==0x0||_0x12b16c[_0x72fd7b(0x3b8)]%0x4==0x3||_0x12b16c['length']%0x3==0x1?0x4:0x3;let _0x3afb37=0x0;_0x12b16c['forEach']((_0x50510d,_0x3d584f)=>{const _0x37bef8=_0x72fd7b;if(_0x3d584f%_0x7fcd8e==0x0)_0x243d58=[];_0x243d58[_0x37bef8(0x320)](Markup[_0x37bef8(0x385)][_0x37bef8(0x25d)](_0x37bef8(0x271)+_0x50510d[_0x37bef8(0x389)],_0x37bef8(0x322)+_0x50510d['botID'])),_0x3d584f%_0x7fcd8e==0x0&&(_0x1b8fae[_0x3afb37]=_0x243d58,_0x3afb37++);});const _0x496e47=Markup['inlineKeyboard'](_0x1b8fae);_0x3f36bc['reply']('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x496e47);}else{const _0x2bde15=_0x12b16c[0x0][_0x72fd7b(0x389)];if(pid[_0x2bde15])pid[_0x2bde15][_0x72fd7b(0x2a4)]({'function':_0x72fd7b(0x382),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x574d9a=>{const _0x166711=_0x5491a0,_0x484b00=_0x574d9a[_0x166711(0x270)][0x1];_0x574d9a[_0x166711(0x2ca)]();if(pid[_0x484b00])pid[_0x484b00][_0x166711(0x2a4)]({'function':_0x166711(0x382),'args':null});}),tgBot['command'](_0x5491a0(0x2d6),async _0x39a789=>{const _0x2eec1d=_0x5491a0;await getMessages();if(!updateAvailable)await sendTelegram(_0x39a789['chat']['id'],_0x2eec1d(0x28f));else{if(!validInstallation)await sendTelegram(_0x39a789['chat']['id'],_0x2eec1d(0x2c1));else{const _0x425441=Markup[_0x2eec1d(0x2c2)]([Markup['button'][_0x2eec1d(0x25d)]('Yes','update_yes'),Markup[_0x2eec1d(0x385)][_0x2eec1d(0x25d)]('No','update_no')]);_0x39a789[_0x2eec1d(0x280)](_0x2eec1d(0x23c),_0x425441);}}}),tgBot[_0x5491a0(0x372)](/update_(.+)/,async _0xf55575=>{const _0x2407d4=_0x5491a0,_0x594783=_0xf55575[_0x2407d4(0x270)][0x1];_0xf55575['editMessageReplyMarkup'](),_0x594783=='yes'&&(await sendTelegram(_0xf55575[_0x2407d4(0x384)]['id'],_0x2407d4(0x216)),updateBB(_0x2407d4(0x2d6))),_0x594783=='no'&&await sendTelegram(_0xf55575[_0x2407d4(0x384)]['id'],_0x2407d4(0x237));}),tgBot[_0x5491a0(0x259)](_0x5491a0(0x3c3),async _0x4523c1=>{const _0x4b56fb=_0x5491a0;if(!validInstallation)await sendTelegram(_0x4523c1[_0x4b56fb(0x384)]['id'],_0x4b56fb(0x3ae));else{const _0x3f62d9=Markup['inlineKeyboard']([Markup[_0x4b56fb(0x385)][_0x4b56fb(0x25d)](_0x4b56fb(0x214),_0x4b56fb(0x31e)),Markup[_0x4b56fb(0x385)]['callback']('No',_0x4b56fb(0x2cb))]);_0x4523c1[_0x4b56fb(0x280)](_0x4b56fb(0x339),_0x3f62d9);}}),tgBot[_0x5491a0(0x372)](/reinstall_(.+)/,async _0x1cd8d9=>{const _0x6f4308=_0x5491a0,_0x63f1a7=_0x1cd8d9['match'][0x1];_0x1cd8d9[_0x6f4308(0x2ca)](),_0x63f1a7==_0x6f4308(0x2e1)&&(await sendTelegram(_0x1cd8d9[_0x6f4308(0x384)]['id'],_0x6f4308(0x38d)),updateBB('reinstall')),_0x63f1a7=='no'&&await sendTelegram(_0x1cd8d9['chat']['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x5491a0(0x259)](_0x5491a0(0x39c),async _0x1860c9=>{const _0x5bb09e=_0x5491a0,_0x241f8a=getBotsWithMode();if(_0x241f8a['length']==0x0)await sendTelegram(_0x1860c9[_0x5bb09e(0x384)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x51f81c=[],_0x185408=[];const _0x237fce=0x2;let _0xbf8d82=0x0;_0x241f8a[_0x5bb09e(0x2b5)]((_0x22e175,_0x3a1b76)=>{const _0xdef642=_0x5bb09e;if(_0x3a1b76%_0x237fce==0x0)_0x185408=[];_0x185408[_0xdef642(0x320)](Markup[_0xdef642(0x385)]['callback'](_0xdef642(0x271)+_0x22e175[_0xdef642(0x389)]+'\x20('+_0x22e175[_0xdef642(0x278)]+')',_0xdef642(0x272)+_0x22e175['botID'])),_0x3a1b76%_0x237fce==0x0&&(_0x51f81c[_0xbf8d82]=_0x185408,_0xbf8d82++);});const _0x468703=Markup[_0x5bb09e(0x2c2)](_0x51f81c);_0x1860c9[_0x5bb09e(0x280)](_0x5bb09e(0x26b),_0x468703);}}),tgBot[_0x5491a0(0x372)](/toggle_(.+)/,async _0x400d56=>{const _0x19e15b=_0x5491a0,_0x118d99=_0x400d56['match'][0x1];_0x400d56[_0x19e15b(0x2ca)]();const _0x817e8a=getBotsWithMode(),_0x3504b2=_0x817e8a['find'](_0x50f444=>_0x50f444[_0x19e15b(0x389)]==_0x118d99),_0x3a33bb=_0x3504b2[_0x19e15b(0x278)]=='auto'?_0x19e15b(0x2ae):_0x19e15b(0x2d9);await sendTelegram(_0x400d56['chat']['id'],_0x19e15b(0x3be)+_0x118d99+_0x19e15b(0x2f1)+_0x3a33bb+_0x19e15b(0x26d)),toggleBotMode(_0x118d99);}),tgBot['command']('names',async _0x27786e=>{const _0x3a5600=_0x5491a0;let _0x383a1d='';config[_0x3a5600(0x2b5)](_0x186baa=>{const _0x27fd2c=_0x3a5600;_0x383a1d+=_0x27fd2c(0x271)+_0x186baa['botID']+':\x20'+_0x186baa['botname']+'\x0a';}),await sendTelegram(_0x27786e['chat']['id'],_0x383a1d,{'parse_mode':_0x3a5600(0x24f)});}),tgBot[_0x5491a0(0x259)](_0x5491a0(0x3c4),async _0x3dc74d=>{const _0x1d51e0=_0x5491a0;await sendTelegram(_0x3dc74d[_0x1d51e0(0x384)]['id'],_0x11df78);}),process[_0x5491a0(0x25f)](_0x5491a0(0x266),()=>tgBot[_0x5491a0(0x269)](_0x5491a0(0x266))),process[_0x5491a0(0x25f)]('SIGTERM',()=>tgBot[_0x5491a0(0x269)]('SIGTERM')),tgBot[_0x5491a0(0x22b)]();}}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x4c4ef7,_0x2d1218,_0x375299){const _0x1ca351=_0x53bb91;_0x375299={..._0x375299,'disable_web_page_preview':!![]};try{await tgBot[_0x1ca351(0x371)][_0x1ca351(0x2ed)](_0x4c4ef7,_0x2d1218,_0x375299);}catch(_0x591bf3){console[_0x1ca351(0x290)](_0x1ca351(0x3a2),_0x591bf3);}}async function sendTelegramBot(_0xfcad2b,_0x556137){const _0x2cb15d=_0x53bb91;if(settings[_0x2cb15d(0x316)]){if(settings['telegramEvents']=='all'||(_0x556137[_0x2cb15d(0x3b4)]==_0x2cb15d(0x30a)||_0x556137[_0x2cb15d(0x3b4)]==_0x2cb15d(0x3fc)||_0x556137[_0x2cb15d(0x3b4)]==_0x2cb15d(0x292))&&settings['telegramEvents']==_0x2cb15d(0x361)||_0x556137[_0x2cb15d(0x3b4)]==_0x2cb15d(0x393)&&settings[_0x2cb15d(0x23a)]==_0x2cb15d(0x219)){if(tgBot&&settings[_0x2cb15d(0x351)]){if(_0x556137[_0x2cb15d(0x330)])await sendTelegram(settings['telegramChatId'],_0x556137['botname']+_0x2cb15d(0x304)+_0x556137['event']);else await sendTelegram(settings['telegramChatId'],_0x2cb15d(0x271)+_0xfcad2b+'\x20>\x20'+_0x556137[_0x2cb15d(0x2fa)]);}}}}async function sendTelegramMsg(_0x481107,_0x10c75c='HTML'){const _0x5155d7=_0x53bb91;return settings[_0x5155d7(0x316)]&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x5155d7(0x351)],_0x481107,{'parse_mode':_0x10c75c}),!![]):![];}function getDeviceWithIp(_0x2cf52a){return devices['find'](_0x2b058c=>_0x2b058c['ip']===_0x2cf52a);}async function temporaryAccess2FA(_0x461282,_0x2e3b15){const _0x325717=_0x53bb91;let _0x49bf53=new Date(),_0x2ab1d5=![];if(lastIpApproval){if(_0x49bf53-lastIpApproval<0x1388)_0x2ab1d5=!![];}lastIpApproval=new Date();if(_0x2ab1d5)return;if(tgBot&&settings['telegramChatId']){const _0x23d467=uuidRandom();tmpStorage[_0x23d467]={'uuid':_0x461282,'externalip':_0x2e3b15};const _0x2618be=Markup[_0x325717(0x2c2)]([Markup[_0x325717(0x385)][_0x325717(0x25d)]('5\x20min','tempaccess_5_'+_0x23d467),Markup[_0x325717(0x385)][_0x325717(0x25d)](_0x325717(0x1ff),'tempaccess_15_'+_0x23d467),Markup[_0x325717(0x385)][_0x325717(0x25d)](_0x325717(0x23f),_0x325717(0x276)+_0x23d467),Markup['button']['callback']('reject',_0x325717(0x2d5)+_0x23d467)]);await sendTelegram(settings[_0x325717(0x351)],_0x325717(0x263)+normalizeIP(_0x2e3b15)[_0x325717(0x3f3)]+'\x20?',_0x2618be),tgBot[_0x325717(0x372)](/tempaccess_(.+)_(.+)/,async _0x51eed7=>{const _0x63c5af=_0x325717,_0x488bd0=_0x51eed7['match'][0x1],_0x4ebe4b=_0x51eed7[_0x63c5af(0x270)][0x2],{uuid:_0x3acb18,externalip:_0x1729ad}=tmpStorage[_0x4ebe4b];delete tmpStorage[_0x4ebe4b],_0x51eed7[_0x63c5af(0x2ca)](),devices[_0x3acb18]['telegramIpApproval']={'clientip':_0x1729ad,'timestamp':new Date()['getTime'](),'expiry':_0x488bd0},_0x488bd0!=_0x63c5af(0x381)?(await sendTelegram(_0x51eed7['chat']['id'],_0x63c5af(0x358)+_0x488bd0+_0x63c5af(0x284),{'parse_mode':_0x63c5af(0x24f)}),io['to'](_0x3acb18)[_0x63c5af(0x3f8)](_0x63c5af(0x207),{'access':{'allow':![],'reason':_0x63c5af(0x2a5),'token':null}})):(await sendTelegram(_0x51eed7[_0x63c5af(0x384)]['id'],_0x63c5af(0x2bc)),io['to'](_0x3acb18)[_0x63c5af(0x3f8)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0x5e5209,_0x168895){const _0xbee536=_0x53bb91;if(tgBot&&settings[_0xbee536(0x351)]){const _0x199e21=uuidRandom();tmpStorage[_0x199e21]={'uuid':_0x5e5209,'externalip':_0x168895};const _0x12c25d=Markup[_0xbee536(0x2c2)]([Markup[_0xbee536(0x385)][_0xbee536(0x25d)](_0xbee536(0x374),_0xbee536(0x23d)+loginExpiry+'_'+_0x199e21),Markup[_0xbee536(0x385)][_0xbee536(0x25d)](_0xbee536(0x381),'login2fa_reject_'+_0x199e21)]);await sendTelegram(settings[_0xbee536(0x351)],_0xbee536(0x3ea)+normalizeIP(_0x168895)[_0xbee536(0x3f3)]+'\x20?',_0x12c25d),tgBot[_0xbee536(0x372)](/login2fa_(.+)_(.+)/,async _0x6be1d7=>{const _0x51d55e=_0xbee536,_0x8b8cef=_0x6be1d7['match'][0x1],_0x29af8e=_0x6be1d7['match'][0x2],{uuid:_0x1cfafc,externalip:_0x3becdf}=tmpStorage[_0x29af8e];delete tmpStorage[_0x29af8e],_0x6be1d7['editMessageReplyMarkup'](),devices[_0x1cfafc]['telegram2FaApproval']={'clientip':_0x3becdf,'timestamp':new Date()[_0x51d55e(0x26a)](),'expiry':_0x8b8cef},_0x8b8cef!=_0x51d55e(0x381)?(await sendTelegram(_0x6be1d7[_0x51d55e(0x384)]['id'],_0x51d55e(0x2df),{'parse_mode':_0x51d55e(0x24f)}),io['to'](_0x1cfafc)[_0x51d55e(0x3f8)]('status',{'access':{'allow':![],'reason':_0x51d55e(0x2a5),'token':null}})):(await sendTelegram(_0x6be1d7[_0x51d55e(0x384)]['id'],_0x51d55e(0x238)),io['to'](_0x1cfafc)[_0x51d55e(0x3f8)]('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x506d62=_0x53bb91;return dbConfig['get'](_0x506d62(0x2c0))['sortBy'](_0x506d62(0x389))['filter']({'status':_0x506d62(0x297)})['value']()||[];}function getDisabledBots(){const _0xa7f0f2=_0x53bb91;return dbConfig['get']('bots')[_0xa7f0f2(0x3a1)](_0xa7f0f2(0x389))[_0xa7f0f2(0x380)]({'status':_0xa7f0f2(0x364)})[_0xa7f0f2(0x356)]()||[];}function getBotAttributes(_0x9d1731){const _0x4620c6=_0x53bb91;let _0x52e8e2={};const _0x157024=configpath+_0x4620c6(0x2ce)+_0x9d1731+_0x4620c6(0x3c7),_0x3c8199=fs[_0x4620c6(0x250)](_0x157024);if(_0x3c8199){const _0x10e3eb=fs[_0x4620c6(0x2eb)](_0x157024);try{const _0x29e86c=JSON[_0x4620c6(0x2a1)](_0x10e3eb),_0x3c6f96=_0x29e86c?_0x29e86c[_0x4620c6(0x3e0)][0x0]['headless']:![];_0x52e8e2[_0x4620c6(0x278)]=_0x3c6f96?'auto':_0x4620c6(0x2ae),_0x52e8e2[_0x4620c6(0x230)]=_0x29e86c?_0x29e86c['bot'][0x0][_0x4620c6(0x230)]:_0x4620c6(0x271)+_0x9d1731;}catch(_0x282bda){_0x52e8e2[_0x4620c6(0x278)]=_0x4620c6(0x2ae),_0x52e8e2['botname']=_0x4620c6(0x271)+_0x9d1731;}}else _0x52e8e2[_0x4620c6(0x278)]=_0x4620c6(0x2ae),_0x52e8e2[_0x4620c6(0x230)]=_0x4620c6(0x271)+_0x9d1731;return _0x52e8e2;}function getBotsWithMode(){const _0x518732=_0x53bb91,_0x47c8ae=dbConfig[_0x518732(0x3e2)]('bots')[_0x518732(0x3a1)](_0x518732(0x389))[_0x518732(0x356)]()||[];return _0x47c8ae[_0x518732(0x2b5)](_0x2a366b=>{const _0x18b123=_0x518732;let _0x378e18=getBotAttributes(_0x2a366b[_0x18b123(0x389)]);_0x2a366b[_0x18b123(0x278)]=_0x378e18[_0x18b123(0x278)];}),_0x47c8ae;}function getBotExchanges(){const _0xead3a6=_0x53bb91;let _0x21667b=[];const _0x593376=dbConfig[_0xead3a6(0x3e2)](_0xead3a6(0x2c0))['sortBy'](_0xead3a6(0x389))['value']()||[];_0x593376[_0xead3a6(0x2b5)](_0x524c96=>{const _0x2b262d=_0xead3a6;if(_0x524c96['status']==_0x2b262d(0x297)){const _0x28c265=configpath+_0x2b262d(0x2ce)+_0x524c96[_0x2b262d(0x389)]+_0x2b262d(0x3c7),_0x55bb2b=fs[_0x2b262d(0x250)](_0x28c265);let _0x123365;if(_0x55bb2b){const _0x4e7545=fs[_0x2b262d(0x2eb)](_0x28c265);try{const _0x28d71d=JSON['parse'](_0x4e7545);_0x123365=_0x28d71d?_0x28d71d[_0x2b262d(0x3e0)][0x0]['exchange']:null;}catch(_0xc7c15){}}if(_0x123365)_0x21667b[_0x2b262d(0x320)](_0x123365);}});const _0xc7a5da=[...new Set(_0x21667b)][_0xead3a6(0x342)]();return _0xc7a5da;}async function initUser(){const _0x3b69b0=_0x53bb91;if(!settings['userid']){const _0x263592=uuidRandom();mixpanel[_0x3b69b0(0x3e7)](_0x263592),updateSetting(_0x3b69b0(0x376),_0x263592);}}async function initSecure(){const _0x34253b=_0x53bb91;let _0x2ada5a=getSecure();if(!_0x2ada5a[_0x34253b(0x341)](_0x34253b(0x3a4))){let _0xdbc603=await generateKeys();_0x2ada5a[_0x34253b(0x32f)]=_0xdbc603['publicKey'],_0x2ada5a[_0x34253b(0x1ed)]=_0xdbc603[_0x34253b(0x1ed)],_0x2ada5a['secret']=crypto[_0x34253b(0x2ea)](0x20)[_0x34253b(0x329)]('hex');;storeSecure(_0x2ada5a);}}function getSettings(){const _0x3d89f2=_0x53bb91;return dbSettings['get'](_0x3d89f2(0x217))[_0x3d89f2(0x356)]()||{};}function getSecure(){const _0x1b2956=_0x53bb91;return dbSecure['get'](_0x1b2956(0x25e))['value']()||{};}function getBlacklist(){const _0x25075d=_0x53bb91;return dbSecure[_0x25075d(0x3e2)]('blacklist')[_0x25075d(0x356)]()||[];}function broadcastToBots(_0x422da5,_0x1d75bd){config['forEach'](_0x295b3f=>{const _0x576ce6=_0x3d0b;if(_0x295b3f[_0x576ce6(0x207)]==_0x576ce6(0x297)&&_0x295b3f[_0x576ce6(0x204)]==_0x576ce6(0x35b)||_0x295b3f[_0x576ce6(0x207)]==_0x576ce6(0x31f)&&_0x295b3f[_0x576ce6(0x204)]==_0x576ce6(0x35b)){if(pid[_0x295b3f['botID']])pid[_0x295b3f[_0x576ce6(0x389)]]['send']({[_0x422da5]:_0x1d75bd});}});}async function storeSettings(_0x71feac,_0x181a12=![]){const _0x38becc=_0x53bb91;_0x71feac={...settings,..._0x71feac};if(_0x181a12&&_0x71feac['bbPassword']!=_0x38becc(0x231)&&_0x71feac[_0x38becc(0x38b)]!=_0x38becc(0x1e8)&&_0x71feac[_0x38becc(0x38b)]!=''){const _0x3bcaae=decryptRSA(secure[_0x38becc(0x1ed)],_0x71feac['bbPassword'])[_0x38becc(0x2a3)](_0x38becc(0x368))[0x0],_0x4334b7=bcrypt['hashSync'](_0x3bcaae,saltRounds);_0x71feac={..._0x71feac,'bbPassword':_0x4334b7};}if(_0x181a12&&_0x71feac[_0x38becc(0x3d6)]!=_0x38becc(0x231)&&_0x71feac[_0x38becc(0x3d6)]!=_0x38becc(0x1e8)&&_0x71feac[_0x38becc(0x3d6)]!=''){const _0x183557=decryptRSA(secure['privateKey'],_0x71feac[_0x38becc(0x3d6)])[_0x38becc(0x2a3)](_0x38becc(0x368))[0x0];_0x71feac={..._0x71feac,'telegramToken':_0x183557};}if(_0x181a12&&_0x71feac['marketcapApi']!=_0x38becc(0x231)&&_0x71feac[_0x38becc(0x291)]!=_0x38becc(0x1e8)&&_0x71feac[_0x38becc(0x291)]!=''){const _0x59296e=decryptRSA(secure['privateKey'],_0x71feac[_0x38becc(0x291)])[_0x38becc(0x2a3)](_0x38becc(0x368))[0x0];_0x71feac={..._0x71feac,'marketcapApi':_0x59296e};}const _0xf908a1=_0x71feac[_0x38becc(0x3d6)]!='************'&&_0x71feac[_0x38becc(0x3d6)]!=settings['telegramToken']||_0x71feac[_0x38becc(0x28b)]!=settings[_0x38becc(0x28b)],_0x535c55=_0x71feac[_0x38becc(0x3d6)]==''||_0x71feac['telegramUsername']=='',_0x436d11=_0x71feac[_0x38becc(0x291)]&&_0x71feac[_0x38becc(0x291)]!=_0x38becc(0x231)&&_0x71feac[_0x38becc(0x291)]!=settings[_0x38becc(0x3d6)];_0xf908a1&&(_0x71feac[_0x38becc(0x351)]=null,_0x71feac[_0x38becc(0x23a)]=_0x38becc(0x249));for(const [_0x556fc8,_0x537200]of Object['entries'](_0x71feac)){if(_0x556fc8==_0x38becc(0x3d6)&&_0x537200==_0x38becc(0x231)){_0x71feac[_0x38becc(0x3d6)]=settings[_0x38becc(0x3d6)];continue;};if(_0x556fc8==_0x38becc(0x38b)&&_0x537200==_0x38becc(0x231)){_0x71feac[_0x38becc(0x38b)]=settings[_0x38becc(0x38b)];continue;};if(_0x556fc8==_0x38becc(0x291)&&_0x537200=='************'){_0x71feac[_0x38becc(0x291)]=settings[_0x38becc(0x291)];continue;};dbSettings[_0x38becc(0x28d)](_0x38becc(0x1f9)+_0x556fc8,_0x537200)[_0x38becc(0x2cd)]();}settings=_0x71feac,io['to']('botmanager')['emit']('settings',cleanSettings()),broadcastToBots(_0x38becc(0x3dc),settings[_0x38becc(0x3dc)]),broadcastToBots(_0x38becc(0x261),settings[_0x38becc(0x261)]),broadcastToBots(_0x38becc(0x291),settings[_0x38becc(0x291)]);if(_0xf908a1&&!_0x535c55)initTelegram();if(_0xf908a1&&_0x535c55)disableTelegram();getAllClients()['forEach'](_0x5a9f88=>{const _0x26c718=_0x38becc;getSocket(_0x5a9f88['id'])[_0x26c718(0x3f8)](_0x26c718(0x207),{'access':{'allow':![],'reason':_0x26c718(0x2a5),'token':null}});}),_0x436d11&&(await sleep(0xbb8),testMarketcapApi(_0x71feac['marketcapApi']));}async function testMarketcapApi(_0x11c8cf){const _0xdcbdad=_0x53bb91,_0x5de8ae=[_0xdcbdad(0x3cb),_0xdcbdad(0x205)];try{await axios[_0xdcbdad(0x3e2)]('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0x11c8cf},'params':{'symbol':_0x5de8ae['toString']()}});}catch(_0x31e7df){_0x31e7df[_0xdcbdad(0x329)]()[_0xdcbdad(0x235)](_0xdcbdad(0x2b9))?(io['to'](_0xdcbdad(0x222))[_0xdcbdad(0x3f8)](_0xdcbdad(0x2a9),_0xdcbdad(0x22f)),logger[_0xdcbdad(0x37b)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to'](_0xdcbdad(0x222))['emit']('notification',_0xdcbdad(0x23b)),logger['full'](_0xdcbdad(0x23b)),logger[_0xdcbdad(0x2e0)](_0xdcbdad(0x354),_0x31e7df['toString']()+_0xdcbdad(0x24d)+_0x31e7df[_0xdcbdad(0x2bd)]));return;}logger[_0xdcbdad(0x2e0)](_0xdcbdad(0x3d1));}function updateSetting(_0x2d0353,_0x1d1535){const _0x169548=_0x53bb91;dbSettings[_0x169548(0x28d)](_0x169548(0x1f9)+_0x2d0353,_0x1d1535)[_0x169548(0x2cd)](),settings=getSettings(),io['to'](_0x169548(0x222))[_0x169548(0x3f8)](_0x169548(0x217),cleanSettings());}function storeSecure(_0x1e126c){const _0x419d77=_0x53bb91;dbSecure[_0x419d77(0x3e2)](_0x419d77(0x25e))[_0x419d77(0x320)](_0x1e126c)['write'](),secure=_0x1e126c;}function addBlacklist(_0x4c50a9){const _0x365771=_0x53bb91;cleanBlacklist();let _0x2d0b78;devices[_0x4c50a9][_0x365771(0x34c)]?_0x2d0b78=Math['max'](devices[_0x4c50a9][_0x365771(0x34c)][_0x365771(0x3ec)],loginExpiry):_0x2d0b78=loginExpiry,dbSecure['get']('blacklist')[_0x365771(0x320)]({'expiry':new Date()[_0x365771(0x26a)]()+_0x2d0b78*0x3c*0x3e8,'token':devices[_0x4c50a9][_0x365771(0x3e4)][_0x365771(0x224)]})[_0x365771(0x2cd)](),blacklist=dbSecure[_0x365771(0x3e2)](_0x365771(0x25b))[_0x365771(0x356)]();}function cleanBlacklist(){const _0x5b7053=_0x53bb91;let _0xb5edce=dbSecure[_0x5b7053(0x3e2)](_0x5b7053(0x25b))['cloneDeep']()[_0x5b7053(0x356)](),_0x39391f=new Date()[_0x5b7053(0x26a)]();_0xb5edce[_0x5b7053(0x2b5)](_0x5bd29f=>{const _0x2d1a2b=_0x5b7053;_0x5bd29f[_0x2d1a2b(0x3ec)]<_0x39391f&&dbSecure['get'](_0x2d1a2b(0x25b))[_0x2d1a2b(0x312)]({'expiry':_0x5bd29f['expiry']})[_0x2d1a2b(0x2cd)]();});}function initStates(){const _0x1521bd=_0x53bb91;let _0x339277=getConfiguration();_0x339277[_0x1521bd(0x2b5)](_0x45030c=>{const _0x625325=_0x1521bd;_0x45030c[_0x625325(0x204)]='stopped';}),storeConfiguration(_0x339277);}async function generateKeys(){const _0x109da3=_0x53bb91,_0x203a70=forge[_0x109da3(0x35a)][_0x109da3(0x3e1)][_0x109da3(0x255)]({'bits':0x1000,'e':0x10001}),_0x27040d=forge[_0x109da3(0x35a)]['privateKeyToPem'](_0x203a70[_0x109da3(0x1ed)]),_0x56b88b=forge['pki'][_0x109da3(0x360)](_0x203a70[_0x109da3(0x32f)]);return{'privateKey':_0x27040d,'publicKey':_0x56b88b};}async function oneTimeMigration(){const _0x1dc646=_0x53bb91;let _0x16fa5e=getSettings(),_0x38b464=![];!_0x16fa5e[_0x1dc646(0x341)]('lastmsgtelegram')&&(_0x16fa5e[_0x1dc646(0x273)]=0x0,_0x38b464=!![]);!_0x16fa5e[_0x1dc646(0x341)](_0x1dc646(0x36a))&&(_0x16fa5e[_0x1dc646(0x36a)]=0x0,_0x38b464=!![]);!_0x16fa5e['hasOwnProperty'](_0x1dc646(0x3a5))&&(_0x16fa5e[_0x1dc646(0x3a5)]='0.0.0',_0x38b464=!![]);!_0x16fa5e['hasOwnProperty'](_0x1dc646(0x261))&&(_0x16fa5e[_0x1dc646(0x261)]=![],_0x38b464=!![]);!_0x16fa5e[_0x1dc646(0x341)]('marketcapApi')&&(_0x16fa5e[_0x1dc646(0x291)]='',_0x38b464=!![]);if(_0x38b464)storeSettings(_0x16fa5e);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x1dc646(0x2b5)](_0x2d6118=>{const _0x151765=_0x1dc646;if(!_0x2d6118['isDirectory']()){if(!_0x2d6118[_0x151765(0x3fd)][_0x151765(0x32d)](_0x151765(0x2da)))fs['unlinkSync'](configbackuppath+_0x2d6118['name']);}else fs['rmSync'](configbackuppath+_0x2d6118[_0x151765(0x3fd)],{'recursive':!![]});});}catch(_0xaea1d6){logger['debug'](_0x1dc646(0x2bf),_0xaea1d6);}}function storeConfiguration(_0x56ed52){const _0x4e6cf9=_0x53bb91;dbConfig['get'](_0x4e6cf9(0x2c0))[_0x4e6cf9(0x312)]()[_0x4e6cf9(0x2cd)](),dbConfig[_0x4e6cf9(0x3e2)]('bots')['push'](..._0x56ed52)['write'](),config=_0x56ed52;}async function resetPassword(){const _0x293672=_0x53bb91;if(tgBot&&settings[_0x293672(0x351)]){const _0x328860=Markup[_0x293672(0x2c2)]([Markup['button'][_0x293672(0x25d)](_0x293672(0x2e1),_0x293672(0x309)),Markup[_0x293672(0x385)][_0x293672(0x25d)]('no',_0x293672(0x345))]);await sendTelegram(settings[_0x293672(0x351)],_0x293672(0x2aa),_0x328860),tgBot['action'](/resetpw_(.+)/,async _0x41a788=>{const _0x90ad63=_0x293672,_0x2959ac=_0x41a788[_0x90ad63(0x270)][0x1];_0x41a788[_0x90ad63(0x2ca)]();if(_0x2959ac!='no'){const _0x260d8e=0xf,_0x55d7e0=_0x90ad63(0x20f),_0x521d36=Array[_0x90ad63(0x2f3)](crypto[_0x90ad63(0x3fa)](new Uint32Array(_0x260d8e)))[_0x90ad63(0x262)](_0x3a5d19=>_0x55d7e0[_0x3a5d19%_0x55d7e0[_0x90ad63(0x3b8)]])[_0x90ad63(0x2de)](''),_0x54ce0e=bcrypt[_0x90ad63(0x1e7)](_0x521d36,saltRounds);storeSettings({'bbPassword':_0x54ce0e}),await sendTelegram(_0x41a788[_0x90ad63(0x384)]['id'],_0x90ad63(0x223)+_0x521d36,{'parse_mode':_0x90ad63(0x24f)});}else await sendTelegram(_0x41a788['chat']['id'],_0x90ad63(0x1f5));});}}async function confirmRestore(_0x153387,_0xe72c36){const _0x2e2702=_0x53bb91;io['to']('botmanager')[_0x2e2702(0x3f8)](_0x2e2702(0x2a9),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x2e2702(0x292));if(tgBot&&settings['telegramChatId']){const _0x30ea9c=uuidRandom();tmpStorage[_0x30ea9c]={'path':_0x153387,'filename':_0xe72c36};const _0x247b04=Markup[_0x2e2702(0x2c2)]([Markup[_0x2e2702(0x385)]['callback'](_0x2e2702(0x2e1),_0x2e2702(0x2e8)+_0x30ea9c),Markup[_0x2e2702(0x385)]['callback']('no',_0x2e2702(0x34e)+_0x30ea9c)]);await sendTelegram(settings[_0x2e2702(0x351)],_0x2e2702(0x3d7),_0x247b04),tgBot[_0x2e2702(0x372)](/restore_(.+)_(.+)/,async _0x557c92=>{const _0x504a8f=_0x2e2702,_0x45827a=_0x557c92[_0x504a8f(0x270)][0x1],_0x3469b6=_0x557c92[_0x504a8f(0x270)][0x2],{path:_0x13acaa,filename:_0x3f9678}=tmpStorage[_0x3469b6];delete tmpStorage[_0x3469b6],_0x557c92[_0x504a8f(0x2ca)](),_0x45827a==_0x504a8f(0x2e1)?(logger[_0x504a8f(0x2e0)]('Restore\x20process\x20confirmed'),await sendTelegram(_0x557c92[_0x504a8f(0x384)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x504a8f(0x24f)}),unzipFile(_0x13acaa,_0x3f9678)):(logger[_0x504a8f(0x2e0)](_0x504a8f(0x2f5)),await sendTelegram(_0x557c92[_0x504a8f(0x384)]['id'],_0x504a8f(0x2f5)));});}}function getServerTime(){const _0x30d373=_0x53bb91,_0x572e25=new Date();return _0x572e25['getFullYear']()+'/'+(_0x572e25[_0x30d373(0x2b2)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x572e25[_0x30d373(0x321)]()[_0x30d373(0x329)]()[_0x30d373(0x1ef)](0x2,'0')+'\x20'+_0x572e25[_0x30d373(0x3e6)]()[_0x30d373(0x329)]()[_0x30d373(0x1ef)](0x2,'0')+':'+_0x572e25[_0x30d373(0x32a)]()['toString']()[_0x30d373(0x1ef)](0x2,'0')+':'+_0x572e25['getSeconds']()[_0x30d373(0x329)]()[_0x30d373(0x1ef)](0x2,'0');}function getTimeStamp(){const _0x25f66f=_0x53bb91,_0x144f88=shiftedTime();return _0x144f88[_0x25f66f(0x2b3)]()+'/'+(_0x144f88[_0x25f66f(0x2b2)]()+0x1)[_0x25f66f(0x329)]()['padStart'](0x2,'0')+'/'+_0x144f88[_0x25f66f(0x321)]()[_0x25f66f(0x329)]()[_0x25f66f(0x1ef)](0x2,'0')+'\x20'+_0x144f88[_0x25f66f(0x3e6)]()[_0x25f66f(0x329)]()[_0x25f66f(0x1ef)](0x2,'0')+':'+_0x144f88['getMinutes']()['toString']()['padStart'](0x2,'0')+':'+_0x144f88[_0x25f66f(0x206)]()['toString']()[_0x25f66f(0x1ef)](0x2,'0');}function getCleanTimeStamp(){const _0x3f16c9=_0x53bb91,_0x391264=shiftedTime();return _0x391264['getFullYear']()+(_0x391264[_0x3f16c9(0x2b2)]()+0x1)['toString']()[_0x3f16c9(0x1ef)](0x2,'0')+_0x391264[_0x3f16c9(0x321)]()[_0x3f16c9(0x329)]()[_0x3f16c9(0x1ef)](0x2,'0')+'-'+_0x391264['getHours']()['toString']()['padStart'](0x2,'0')+_0x391264['getMinutes']()[_0x3f16c9(0x329)]()[_0x3f16c9(0x1ef)](0x2,'0')+_0x391264['getSeconds']()[_0x3f16c9(0x329)]()[_0x3f16c9(0x1ef)](0x2,'0');}function shiftedTime(){const _0xcfb108=_0x53bb91,_0x413312=new Date();let _0x39351b=_0x413312;if(settings[_0xcfb108(0x3dc)]&&settings[_0xcfb108(0x3dc)]!==0x0)_0x39351b=fns[_0xcfb108(0x396)](_0x413312,{'hours':settings[_0xcfb108(0x3dc)]});return _0x39351b;}async function startScheduler(){const _0x55d749=_0x53bb91,_0x22368f=new Date()[_0x55d749(0x28e)](),_0x13451c=shiftedTime()[_0x55d749(0x3e6)]();_0x13451c==0x4&&backupConfigFiles(),_0x13451c==0x0&&rotateLogFiles(),_0x22368f%0x6==0x0&&triggerAnalytics(),_0x22368f%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x5b5bf0){const _0x2b9e06=_0x53bb91;logger[_0x2b9e06(0x2e0)]('Restore\x20backup\x20file\x20'+_0x5b5bf0);const _0xea5af9=getBotsWithMode();_0xea5af9[_0x2b9e06(0x3b8)]>0x0?confirmRestore(configbackuppath,_0x5b5bf0):unzipFile(configbackuppath,_0x5b5bf0);}async function getBackupFiles(_0x48180c=null){const _0x1f305f=_0x53bb91;let _0x54d1fe=[],_0x5687cc=fs[_0x1f305f(0x1fa)](configbackuppath,{'withFileTypes':!![]});_0x5687cc['sort']((_0x10c094,_0x4791ff)=>_0x10c094[_0x1f305f(0x3fd)]<_0x4791ff[_0x1f305f(0x3fd)]?0x1:_0x4791ff[_0x1f305f(0x3fd)]<_0x10c094['name']?-0x1:0x0),_0x5687cc[_0x1f305f(0x2b5)](_0x2a23d6=>{const _0x18e572=_0x1f305f;if(!_0x2a23d6['isDirectory']()&&_0x2a23d6[_0x18e572(0x3fd)][_0x18e572(0x32d)](_0x18e572(0x2da))&&_0x2a23d6[_0x18e572(0x3fd)][_0x18e572(0x3c1)](_0x18e572(0x36d))){const _0x308bb7=formatDate(fs['statSync'](configbackuppath+_0x2a23d6[_0x18e572(0x3fd)])[_0x18e572(0x225)]);_0x54d1fe['push']({'name':_0x2a23d6['name'],'mtime':_0x308bb7});}});if(_0x48180c)io['to'](_0x48180c)['emit']('backup-files',_0x54d1fe);else return _0x54d1fe;}async function backupConfigFiles(){const _0x38a79f=_0x53bb91;await zipFiles(_0x38a79f(0x26c));const _0xe511f4=getCleanTimeStamp();fs[_0x38a79f(0x3ce)](zippath+'backup-full.zip',configbackuppath+(_0x38a79f(0x2da)+_0xe511f4+_0x38a79f(0x36d)));let _0x5eddb5=fs[_0x38a79f(0x1fa)](configbackuppath,{'withFileTypes':!![]});_0x5eddb5[_0x38a79f(0x342)]((_0x130e25,_0x2debcf)=>_0x130e25['name']<_0x2debcf[_0x38a79f(0x3fd)]?0x1:_0x2debcf['name']<_0x130e25['name']?-0x1:0x0),_0x5eddb5[_0x38a79f(0x3b8)]>maxBackups&&fs[_0x38a79f(0x2b8)](configbackuppath+_0x5eddb5[_0x5eddb5[_0x38a79f(0x3b8)]-0x1][_0x38a79f(0x3fd)]);}function rotateLogFiles(){const _0x406f9e=_0x53bb91,_0xe5db7a=fs[_0x406f9e(0x295)](logspath+_0x406f9e(0x3ee)),_0x48b169=_0xe5db7a[_0x406f9e(0x319)]/0x400;if(_0x48b169>0x64){let _0x256945=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x256945['sort']((_0x4a9ac1,_0x2c469b)=>_0x4a9ac1[_0x406f9e(0x3fd)]<_0x2c469b[_0x406f9e(0x3fd)]?0x1:_0x2c469b['name']<_0x4a9ac1['name']?-0x1:0x0),_0x256945['forEach'](_0x555ea7=>{const _0x1f4c37=_0x406f9e;if(_0x555ea7[_0x1f4c37(0x3fd)]==_0x1f4c37(0x211))fs['copyFileSync'](logspath+_0x555ea7[_0x1f4c37(0x3fd)],logspath+_0x1f4c37(0x350));if(_0x555ea7[_0x1f4c37(0x3fd)]==_0x1f4c37(0x335))fs['copyFileSync'](logspath+_0x555ea7[_0x1f4c37(0x3fd)],logspath+_0x1f4c37(0x211));_0x555ea7[_0x1f4c37(0x3fd)]==_0x1f4c37(0x3ee)&&(fs[_0x1f4c37(0x3ce)](logspath+_0x555ea7[_0x1f4c37(0x3fd)],logspath+_0x1f4c37(0x335)),fs['writeFileSync'](logspath+_0x555ea7['name'],''));});}}async function zipFiles(_0xc26d60){const _0x429753=_0x53bb91;let _0x1e7d34;if(_0xc26d60==_0x429753(0x3eb))_0x1e7d34=logspath;if(_0xc26d60=='backup')_0x1e7d34=configpath;if(_0xc26d60==_0x429753(0x26c))_0x1e7d34=configpath;let _0xbf3078=fs[_0x429753(0x1fa)](_0x1e7d34,{'withFileTypes':!![]});const _0x4bab3b=new JSZip();_0xbf3078['forEach'](_0x3e3078=>{const _0x149c90=_0x429753;if(!_0x3e3078[_0x149c90(0x2f4)]()){let _0x4f9017=fs[_0x149c90(0x2eb)](_0x1e7d34+_0x3e3078[_0x149c90(0x3fd)]);if(_0xc26d60==_0x149c90(0x20e)){const _0x663183=/^bot-[0-9]{3}-config.json$/,_0x3d96cb=_0x663183['test'](_0x3e3078[_0x149c90(0x3fd)]);if(_0x3d96cb){const _0x99cee0=JSON['parse'](_0x4f9017);if(_0x99cee0[_0x149c90(0x3e0)][0x0]){_0x99cee0[_0x149c90(0x3e0)][0x0]['apiKey']=_0x149c90(0x1e8),_0x99cee0[_0x149c90(0x3e0)][0x0][_0x149c90(0x2f9)]=_0x149c90(0x1e8);if(_0x99cee0[_0x149c90(0x3e0)][0x0][_0x149c90(0x2d0)])_0x99cee0[_0x149c90(0x3e0)][0x0]['apiPassword']=_0x149c90(0x1e8);}_0x4f9017=JSON[_0x149c90(0x242)](_0x99cee0,null,0x2);}if(_0x3e3078[_0x149c90(0x3fd)]==_0x149c90(0x257)){const _0x3ac200=JSON[_0x149c90(0x2a1)](_0x4f9017);if(_0x3ac200[_0x149c90(0x217)][_0x149c90(0x31d)])_0x3ac200[_0x149c90(0x217)][_0x149c90(0x31d)]=![];if(_0x3ac200[_0x149c90(0x217)]['bbPassword'])_0x3ac200[_0x149c90(0x217)][_0x149c90(0x38b)]=_0x149c90(0x1e8);if(_0x3ac200[_0x149c90(0x217)]['telegramToken'])_0x3ac200[_0x149c90(0x217)][_0x149c90(0x3d6)]=_0x149c90(0x1e8);if(_0x3ac200[_0x149c90(0x217)][_0x149c90(0x351)])_0x3ac200[_0x149c90(0x217)]['telegramChatId']=null;if(_0x3ac200[_0x149c90(0x217)][_0x149c90(0x291)])_0x3ac200[_0x149c90(0x217)][_0x149c90(0x291)]=_0x149c90(0x1e8);_0x4f9017=JSON[_0x149c90(0x242)](_0x3ac200,null,0x2);}if(_0x3e3078[_0x149c90(0x3fd)]!=_0x149c90(0x347))_0x4bab3b[_0x149c90(0x315)](_0x3e3078['name'],_0x4f9017);}else _0x4bab3b['file'](_0x3e3078['name'],_0x4f9017);}});const _0x1f93ca=await _0x4bab3b[_0x429753(0x3bd)]({'type':_0x429753(0x387),'base64':![],'compression':_0x429753(0x3a8)});fs['writeFileSync'](zippath+(_0xc26d60+_0x429753(0x36d)),_0x1f93ca,_0x429753(0x3b9));}async function unzipFile(_0x1fdd41,_0x442a90){const _0x4467a5=_0x53bb91;fs[_0x4467a5(0x1fa)](configpath,{'withFileTypes':!![]})[_0x4467a5(0x2b5)](_0x1b611f=>{const _0x4be32c=_0x4467a5;if(!_0x1b611f[_0x4be32c(0x2f4)]())fs[_0x4be32c(0x2d8)](configpath+_0x1b611f[_0x4be32c(0x3fd)]);});const _0x285a66=fs['readFileSync'](_0x1fdd41+_0x442a90,_0x4467a5(0x3b9)),_0x28a746=await JSZip[_0x4467a5(0x243)](_0x285a66,{'base64':![],'checkCRC32':!![]});for(const _0x3b1fba of Object[_0x4467a5(0x22c)](_0x28a746[_0x4467a5(0x323)])){const _0x5653c9=_0x28a746[_0x4467a5(0x323)][_0x3b1fba],_0x16efe4=await _0x5653c9[_0x4467a5(0x3a3)](_0x4467a5(0x387));fs['writeFileSync'](configpath+_0x5653c9[_0x4467a5(0x3fd)],_0x16efe4);}fs[_0x4467a5(0x1fa)](temppath,{'withFileTypes':!![]})[_0x4467a5(0x2b5)](_0x1d99d0=>{const _0x2f32bf=_0x4467a5;if(!_0x1d99d0[_0x2f32bf(0x2f4)]())fs[_0x2f32bf(0x2d8)](temppath+_0x1d99d0[_0x2f32bf(0x3fd)]);}),logger[_0x4467a5(0x2e0)](_0x4467a5(0x363)),process[_0x4467a5(0x2a4)]({'restore':!![]},_0x134ec5=>{});}async function getPublicIp(){const _0x3e49e8=_0x53bb91;try{const _0x5b1eda=await axios[_0x3e49e8(0x3e2)](_0x3e49e8(0x245));publicip=_0x5b1eda[_0x3e49e8(0x24a)]['ip'];}catch(_0xc31ecd){}}async function triggerAnalytics(){const _0x483ebf=_0x53bb91;if(!publicip)await getPublicIp();const _0x3fa1ed=getBotsWithMode();let _0x5ceea5=0x0;_0x3fa1ed[_0x483ebf(0x2b5)](_0x251121=>{const _0x2d9ea5=_0x483ebf;if(_0x251121['status']===_0x2d9ea5(0x297))_0x5ceea5++;});const _0x456eb9=getBotExchanges();mixpanel[_0x483ebf(0x346)](_0x483ebf(0x30c),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x3fa1ed[_0x483ebf(0x3b8)],'numbotsenabled':_0x5ceea5,'exchanges':_0x456eb9,'environment':environment});}async function getMessages(){const _0x5226fb=_0x53bb91,_0x1c7453=_0x5226fb(0x3da),_0x4f3ac0=new GraphQLClient(_0x1c7453),_0x5592dd={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x33a609=serverversion[_0x5226fb(0x2a3)]('.'),_0x4c2658=_0x33a609[0x0]+'.'+_0x33a609[0x1],_0x26c00c=Math[_0x5226fb(0x370)](settings['lastmsgtelegram'],settings[_0x5226fb(0x36a)]),_0x1f7bd9={'last':parseInt(_0x26c00c),'bbm':_0x4c2658},_0x652d2b=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x5a1911;try{_0x5a1911=await _0x4f3ac0['request'](_0x652d2b,_0x1f7bd9,_0x5592dd);}catch(_0xa8b868){}if(_0x5a1911&&_0x5a1911[_0x5226fb(0x2d2)]){let _0x58b516=settings[_0x5226fb(0x273)];newMessages=[];for(const _0x2b49fe of _0x5a1911[_0x5226fb(0x2d2)]){newMessages[_0x5226fb(0x320)](_0x2b49fe);let _0x365705=![];_0x2b49fe[_0x5226fb(0x2fb)]&&(updateSetting(_0x5226fb(0x3a5),_0x2b49fe[_0x5226fb(0x2fb)]),_0x365705=isNewerVersion(serverversion,_0x2b49fe['bbvNew'])||serverversion==_0x2b49fe[_0x5226fb(0x2fb)]);if(!_0x365705&&_0x2b49fe[_0x5226fb(0x26f)]>_0x58b516){if(_0x2b49fe[_0x5226fb(0x2ab)]===_0x5226fb(0x27b)||serverversion[_0x5226fb(0x32d)](_0x2b49fe[_0x5226fb(0x2ab)])){let _0x2ba09c=''+_0x2b49fe[_0x5226fb(0x1fc)]+'\x0a\x0a'+_0x2b49fe[_0x5226fb(0x37d)];const _0x16a0f3=await sendTelegramMsg(toTelegramMarkdown(_0x2ba09c),_0x5226fb(0x386));if(_0x16a0f3)_0x58b516=_0x2b49fe['number'];}}}updateAvailable=isNewerVersion(settings[_0x5226fb(0x3a5)],serverversion),updateSetting('lastmsgtelegram',_0x58b516),emitMessages();}}function emitMessages(){const _0x3abce1=_0x53bb91,_0x185a96=settings['lastmsgemitted'];let _0x2150af=[];newMessages['forEach'](_0x704dc2=>{const _0xfcfcef=_0x3d0b;_0x704dc2[_0xfcfcef(0x26f)]>_0x185a96&&_0x2150af[_0xfcfcef(0x320)](_0x704dc2);}),_0x2150af[_0x3abce1(0x3b8)]>0x0&&getAllClients()[_0x3abce1(0x2b5)](_0x404fa9=>{const _0x2ca20d=_0x3abce1;getSocket(_0x404fa9['id'])[_0x2ca20d(0x3f8)](_0x2ca20d(0x37d),_0x2150af);});}function confirmMessage(_0x13e856){const _0x1edb1b=_0x53bb91;updateSetting(_0x1edb1b(0x36a),Number(_0x13e856));}function isNewerVersion(_0x49816d,_0x54986e){const _0x400573=_0x53bb91,_0x3df0eb=_0x54986e[_0x400573(0x2a3)]('.'),_0x442f62=_0x49816d['split']('.');for(var _0x21b4e1=0x0;_0x21b4e1<_0x442f62[_0x400573(0x3b8)];_0x21b4e1++){const _0x17d83e=~~_0x442f62[_0x21b4e1],_0x143f43=~~_0x3df0eb[_0x21b4e1];if(_0x17d83e>_0x143f43)return!![];if(_0x17d83e<_0x143f43)return![];}return![];}function toTelegramMarkdown(_0x165b26){const _0x30504f=_0x53bb91,_0x2e269b=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x17727d=/\*{2}(.+?)\*{2}/gim;return _0x165b26=_0x165b26[_0x30504f(0x281)](_0x2e269b,_0x30504f(0x373))['replace'](_0x17727d,_0x30504f(0x34f)),_0x165b26;}async function validateConfigFile(){const _0x1db461=_0x53bb91,_0x4616e8=dbConfig[_0x1db461(0x3e2)]('bots')[_0x1db461(0x3a1)]('botID')['value']()||[];if(_0x4616e8[_0x1db461(0x3b8)]==0x0){let _0x2ff652=0x0,_0x1fee69=[];const _0x1c98ae=/^bot-([0-9]{3})-config.json$/,_0x37a858=fs[_0x1db461(0x1fa)](configpath);_0x37a858[_0x1db461(0x2b5)](_0x3e14c5=>{const _0x15da0c=_0x1db461,_0x4f015a=_0x1c98ae['exec'](_0x3e14c5);if(_0x4f015a){const _0x1eda4c=_0x4f015a[0x1];let _0x441cc2=getBotAttributes(_0x1eda4c);_0x1fee69[_0x15da0c(0x320)]({'botID':_0x1eda4c,'botname':_0x441cc2['botname'],'status':_0x15da0c(0x364),'live':_0x15da0c(0x1ee)}),_0x2ff652++;}}),_0x2ff652!=0x0&&(dbConfig[_0x1db461(0x3e2)](_0x1db461(0x2c0))[_0x1db461(0x391)](_0x1fee69)[_0x1db461(0x2cd)](),config=_0x1fee69,restoredConfigFile=_0x2ff652);}}async function restoreConfigNotify(_0x28ee34){const _0xe3df1=_0x53bb91;let _0x55f5f1;if(restoredConfigFile==0x1)_0x55f5f1=_0xe3df1(0x29a);else _0x55f5f1='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x28ee34)io['to'](_0xe3df1(0x222))[_0xe3df1(0x3f8)](_0xe3df1(0x2a9),_0x55f5f1);else{logger[_0xe3df1(0x27f)](_0xe3df1(0x2f2)),logger['simple'](_0x55f5f1),logger['simple'](_0xe3df1(0x2f2)),logger[_0xe3df1(0x27f)]('');if(tgBot&&settings[_0xe3df1(0x351)]&&settings[_0xe3df1(0x23a)]!='orders')await sendTelegram(settings[_0xe3df1(0x351)],_0xe3df1(0x3c0)+_0x55f5f1);}}function decryptRSA(_0x5b5c46,_0xe88b9c){const _0x8f8807=_0x53bb91,_0xdaa5a4=forge[_0x8f8807(0x35a)][_0x8f8807(0x3a7)](_0x5b5c46),_0x2c53c0=_0xdaa5a4['decrypt'](forge['util']['decode64'](_0xe88b9c),'RSA-OAEP',{'md':forge['md']['sha256'][_0x8f8807(0x2d4)](),'mgf1':{'md':forge['md'][_0x8f8807(0x3aa)][_0x8f8807(0x2d4)]()}});return _0x2c53c0;}function validateCredentials(_0x5509dd,_0x11a5f2){const _0x523902=_0x53bb91;if(_0x5509dd['username']==settings[_0x523902(0x366)]&&bcrypt['compareSync'](_0x5509dd[_0x523902(0x2af)],settings[_0x523902(0x38b)])){if(settings[_0x523902(0x203)])return{'allow':![],'reason':_0x523902(0x3c9),'token':null};else{const _0x2c57b9=generateLoginToken(_0x11a5f2);return{'allow':!![],'reason':_0x523902(0x228),'token':_0x2c57b9};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x29676c){const _0x534767=generateLoginToken(_0x29676c);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x534767};}function validateAccess(_0x25ac7d,_0x29df9c,_0x134034){const _0x1dfb30=_0x53bb91,_0x329098=_0x134034?_0x134034:devices[_0x29df9c]['ip'];let _0x4d1dd1;const _0x440cfb=_0x1da9d9=>{const _0x4a8d02=_0x3d0b;if(settings['loginRequired']){if(settings[_0x4a8d02(0x203)]){if(telegram2FaApproved(_0x29df9c)){const _0x51f280=generateLoginToken(_0x29df9c);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x51f280};}else return{'allow':![],'reason':_0x4a8d02(0x30d),'token':null};}else return _0x4d1dd1=validToken(_0x1da9d9,_0x29df9c),_0x4d1dd1[_0x4a8d02(0x341)](_0x4a8d02(0x292))?{'allow':!![],'reason':_0x4a8d02(0x220),'token':_0x1da9d9}:{'allow':![],'reason':_0x4a8d02(0x30d),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x1dfb30(0x21e)]){let _0x267e5c=[...settings[_0x1dfb30(0x27e)],_0x1dfb30(0x21b),_0x1dfb30(0x2d1),'127.0.0.1'];if(_0x267e5c[_0x1dfb30(0x235)](_0x329098))return _0x440cfb(_0x25ac7d);else{_0x4d1dd1=validToken(_0x25ac7d,_0x29df9c);if(_0x4d1dd1[_0x1dfb30(0x341)](_0x1dfb30(0x292)))return _0x440cfb(_0x25ac7d);else{if(telegramIpApproved(_0x29df9c)){const _0x3f216f=generateToken(_0x29df9c);return _0x4d1dd1=_0x440cfb(_0x25ac7d),_0x4d1dd1[_0x1dfb30(0x359)]?{'allow':!![],'reason':_0x1dfb30(0x2f6),'token':_0x3f216f}:_0x4d1dd1;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x1dfb30(0x3d0),'token':null}:{'allow':![],'reason':_0x1dfb30(0x352),'token':null};}}}else return _0x440cfb(_0x25ac7d);}function timelyDecrypt(_0x597080,_0x5a735d,_0x34ccb2='@'){const _0x3070a0=_0x53bb91;if(_0x597080)try{const _0x30dd43=decryptRSA(secure[_0x3070a0(0x1ed)],_0x597080),_0x52f97c=_0x30dd43['split'](_0x34ccb2)[0x0],_0x5ee0b9=_0x30dd43[_0x3070a0(0x2a3)](_0x34ccb2)[0x1],_0x4af0b4=new Date()[_0x3070a0(0x26a)]();if(_0x5a735d){if(_0x4af0b4-_0x5ee0b9<maxSecretAge*0x3e8)return _0x52f97c;else return![];}else return _0x52f97c;}catch(_0x200a69){return![];}else return![];}const validToken=(_0x1397dd,_0xe464e)=>{const _0x43e955=_0x53bb91,_0x3e8615=devices[_0xe464e]['ip'];if(!_0x1397dd)return{'error':'No\x20authentication\x20token'};for(let _0x1615d3 of blacklist){if(_0x1615d3[_0x43e955(0x224)]==_0x1397dd)return{'error':_0x43e955(0x213)};}let _0x42fe25;try{_0x42fe25=jwt[_0x43e955(0x2ee)](_0x1397dd,secure[_0x43e955(0x3a4)]+_0xe464e);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x42fe25[_0x43e955(0x341)](_0x43e955(0x318))&&!_0x42fe25[_0x43e955(0x341)](_0x43e955(0x2c4))||!_0x42fe25[_0x43e955(0x341)](_0x43e955(0x1e9)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x42fe25[_0x43e955(0x341)](_0x43e955(0x2c4))&&_0x42fe25[_0x43e955(0x341)](_0x43e955(0x318))){const {clientip:_0x2e9095}=_0x42fe25;return _0x3e8615==_0x2e9095?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x43e955(0x32b)};}else{if(_0x42fe25[_0x43e955(0x341)](_0x43e955(0x2c4))&&_0x42fe25['hasOwnProperty']('clientip')){const {username:_0x5f1e7c,clientip:_0x3cb5e7}=_0x42fe25;return settings['bbUsername']==_0x5f1e7c&&_0x3e8615==_0x3cb5e7?{'success':_0x43e955(0x286)}:{'error':_0x43e955(0x3ab)};}}},generateLoginToken=_0x32d469=>{const _0x22433a=_0x53bb91;if(_0x32d469){const _0x179703=devices[_0x32d469]['ip'];return jwt[_0x22433a(0x285)]({'username':settings[_0x22433a(0x366)],'clientip':_0x179703},secure['secret']+_0x32d469,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x28d5b5=>{const _0x3100f3=_0x53bb91;if(_0x28d5b5){const _0x3caed9=devices[_0x28d5b5]['ip'];return jwt[_0x3100f3(0x285)]({'clientip':_0x3caed9},secure['secret']+_0x28d5b5,{'expiresIn':devices[_0x28d5b5][_0x3100f3(0x34c)]['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x2aa376=>{const _0x534e3f=_0x53bb91;let _0x5540df=![];return devices[_0x2aa376][_0x534e3f(0x34c)]&&devices[_0x2aa376]['telegramIpApproval'][_0x534e3f(0x3ec)]!='reject'&&(_0x5540df=devices[_0x2aa376]['telegramIpApproval'][_0x534e3f(0x318)]==devices[_0x2aa376]['ip']&&new Date()[_0x534e3f(0x26a)]()-devices[_0x2aa376]['telegramIpApproval'][_0x534e3f(0x29c)]<devices[_0x2aa376][_0x534e3f(0x34c)][_0x534e3f(0x3ec)]*0x3c*0x3e8),_0x5540df;},telegram2FaApproved=_0x40c414=>{const _0x1a697e=_0x53bb91;let _0x7c168e=![];return devices[_0x40c414][_0x1a697e(0x349)]&&devices[_0x40c414][_0x1a697e(0x349)][_0x1a697e(0x3ec)]!=_0x1a697e(0x381)&&(_0x7c168e=devices[_0x40c414]['telegram2FaApproval']['clientip']==devices[_0x40c414]['ip']&&new Date()['getTime']()-devices[_0x40c414][_0x1a697e(0x349)]['timestamp']<devices[_0x40c414][_0x1a697e(0x349)][_0x1a697e(0x3ec)]*0x3c*0x3e8),_0x7c168e;},normalizeIP=_0x2979af=>{const _0x12b34e=_0x53bb91;let _0x1dadfe=null,_0x104a85=null;if(ipaddr[_0x12b34e(0x29f)](_0x2979af)){const _0x257055=ipaddr[_0x12b34e(0x2a1)](_0x2979af);_0x257055[_0x12b34e(0x310)]()===_0x12b34e(0x232)?(_0x257055[_0x12b34e(0x202)]()&&(_0x1dadfe=_0x257055[_0x12b34e(0x201)]()['toString']()),_0x104a85=_0x257055[_0x12b34e(0x329)]()):(_0x1dadfe=_0x257055[_0x12b34e(0x329)](),_0x104a85=_0x257055['toIPv4MappedAddress']()['toString']());}return{'show':_0x1dadfe?_0x1dadfe:_0x104a85,'store':_0x104a85};};function formatDate(_0x461a60){const _0x18201d=_0x53bb91;return _0x461a60[_0x18201d(0x2b3)]()+'/'+(_0x461a60[_0x18201d(0x2b2)]()+0x1)[_0x18201d(0x329)]()[_0x18201d(0x1ef)](0x2,'0')+'/'+_0x461a60[_0x18201d(0x321)]()[_0x18201d(0x329)]()[_0x18201d(0x1ef)](0x2,'0')+'\x20'+_0x461a60['getHours']()[_0x18201d(0x329)]()['padStart'](0x2,'0')+':'+_0x461a60[_0x18201d(0x32a)]()[_0x18201d(0x329)]()[_0x18201d(0x1ef)](0x2,'0')+':'+_0x461a60['getSeconds']()[_0x18201d(0x329)]()[_0x18201d(0x1ef)](0x2,'0');}function sleep(_0x54df9d){return new Promise(_0x581b96=>setTimeout(_0x581b96,_0x54df9d));}