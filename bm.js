const _0x5cada0=_0x16b2;function _0x1b69(){const _0x3604f8=['telegram','Password\x20reset\x20rejected','Invalid\x20authentication\x20token\x20(2)','versions','f2aRequired','telegramIpApproval','chat','replace','Unauthorized\x20attempt\x20to\x20get\x20messages','Backup\x20file\x20uploaded','privateKey','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','password','/:bot/history','running','Restore\x20process\x20aborted','close','telegraf','write','node','randomFillSync','onepagemode','toIPv4MappedAddress','config/','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Invalid\x20authentication\x20token\x20(1)','map','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','sockets','compareSync','Unauthorized\x20attempt\x20to\x20download\x20','portfolio','Login\x20rejected','address','NTBA_FIX_319','-config.json','lastmsgtelegram','Restore\x20process\x20confirmed','filter','zip/','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','lowdb','\x20|\x20client:\x20...','No\x20bots\x20running\x20right\x20now','tempaccess_5_','\x20|\x20','toggle_','bbvReceive','parse','storeHeadless','Enabled\x20Bot\x20','getDate','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','6414CtQYlc','manual','args','apply','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','command','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','copyFileSync','once','temporary\x20access\x20timeout','_data',',\x20must\x20be\x20a\x204\x20digit\x20number','stop','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','::1','2FA\x20required','username','\x1b[34m','graphql-request','uncaughtException','clientip','ipc','-----------------------------------------------------------------------------------','notification','Unauthorized\x20attempt\x20to\x20store\x20configuration','storeFiat','backup-full','Alerts','action','settings','Disabled\x20Bot\x20','bcryptjs','data','sha256','init','temp/','allow','login\x20token\x20valid','getTime','latestversion','output-002.log','All','remoteAddress','private','names','isIPv4MappedAddress','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','initclient','Starting\x20#RED#Balance\x20Bot\x20v','type','getMonth','keys','statSync','/upload-backup','binary','Starting\x20Balance\x20Bot\x20reinstallation','Unauthorized\x20attempt\x20to\x20update\x20bot','telegramUsername','new','decrypt','botID','reinstall','static','referer','jsonwebtoken','get-portfolio','/off\x20-\x20stop\x20bot(s)\x0a','deleteHistoryAlerts','sendPortfolioTelegram',':\x20Bot\x20Mgr\x20>\x20','push','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','81cZyeaY','log','2FA\x20login\x20required','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','download','string','secure','port','any','telegramToken','bbUsername','loginRequired','hex','/:bot','\x1b[35m','bbvNew','alerts','backup','::ffff:127.0.0.1','post','login\x20token\x20generated','storeConfiguration','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Unauthorized\x20attempt\x20to\x20update\x20settings','version','\x20>\x20','Access\x20enabled\x20for\x20','telegramChatId','telegramEnabled','endsWith','/:bot/portfolio','reset-password','pidRefreshToken','full','30\x20min','live','User\x20has\x20been\x20validated','\x20(2)','params','access','internal','Logged\x20in\x20user\x20...','Unauthorized\x20attempt\x20to\x20log\x20out','messages','/start','stopped','resetpw_yes','/help\x20-\x20show\x20available\x20commands\x0a',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','login\x20not\x20required','button','writeFileSync','-events.json','telegramEvents','start','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','\x20mode','generateKeyPairAsync','match','join','restart','value','bot-','yes','Bot\x20','You\x20can\x20use\x20the\x20following\x20commands:\x0a','whitelist','Temporary\x20access\x20rejected','existsSync','track','cloneDeep','Bot\x20Mgr\x20>\x20','/status\x20-\x20show\x20bot(s)\x20status\x0a','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','disable','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','bb-config.json','login\x20required','path','delete-bot','remove','readFileSync','119928LDkylb','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','update','132656cIlJre','sort','function','format','unlinkSync','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','event','sortBy',')\x20\x20\x20|\x20Bot\x20',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','/enable\x20-\x20enable\x20notifications\x0a','on_','userid','from','Starting\x20(','temporary\x20token\x20generated','hashSync','login','sendMetricsTelegram','apiPassword','reply','0.0.0','message','2865950egOlvR','1000','store-configuration','hasOwnProperty','add','Unauthorized\x20attempt\x20to\x20show\x20configuration','kind','sign','config','15\x20min','launch','max','status','disconnect','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','RSA-OAEP','expiry','Node.js\x20v','SIGINT','express-fileupload','timeshift','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','5\x20min','split','(((.+)+)+)+$','util','reinstall_yes','get-backup-files','.zip','Markdown','login2fa_reject_','entries','success','exit','mkdirSync','conn','forEach','search','host','getHours','/metrics\x20-\x20show\x20bot\x20performance\x0a','2FA\x20login\x20token\x20generated','Notifications\x20enabled','createServer','node-zip','show-config','update-bb','bb-settings.json','toggle','listen','All\x20bots\x20running\x20right\x20now','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','botmanager','new-disabled','Setting\x20access:\x20','axios','mode','includes','Error\x20removing\x20old\x20backup\x20files:','58472mLgJkD','/names\x20-\x20show\x20bot\x20names\x0a','add-bot','getStartingBalances','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Allow\x20login\x20from\x20IP\x20address\x20','argv','store','All\x20bots','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','-results.json','all','temporary\x20access\x20not\x20allowed','1015NhHtFe','range','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','update-bot','inherit','Unauthorized\x20attempt\x20to\x20get\x20events','metrics_','bot','logout','tempaccess_15_','place-order','\x1b[36m','Idling\x20(','output-000.log','set','socket.io','alias','lastmsgemitted','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','files','Token\x20blacklisted','tkn','30VEsUYT','isDirectory','date-fns','/output-000.log','Invalid\x20username\x20or\x20IP\x20address','help','version.json','env','tempaccess_30_','stringify','fork','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','getFullYear','toggle-bot-mode','Starting\x20Balance\x20Bot\x20update','headers','Error:\x20Invalid\x20argument\x20','Restoring\x20bot(s)\x20from\x20backup','emit','uuid','/:bot/configuration','logs/','reject','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','No\x20authentication\x20token','backup-files','disabled','\x20minutes','get','isValid','Session\x20expired\x20for\x20user\x20...','express','store-settings','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','bbPassword','\x1b[33m','apiKey','name','temporary\x20access\x20rejected','portfolio_','config_all','config_orders','build','readdirSync','Login\x20accepted','reload','send','***','removeAllListeners','telegram2FaApproval','************','mixpanel','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','restart_','Crypt','config_alerts','reinstall-bb','pidExpireLogin','ipv6','hybrid-crypto-js','staging','3000','getMinutes','invalid\x20credentials','startsWith','\x1b[31m','use','blacklist','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','telegrammsg','headless','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Restore\x20backup\x20file\x20','size','\x20(1)','918470agCNqZ','backup-full.zip','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','get-starting-balances','2FA','callback','settings.','access\x20timeout','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','logs','off_','file','verify','getSeconds','<b>Telegram\x20Bot\x20Status:</b>\x0a','enabled','output-001.log','https://api.ipify.org?format=json','logged\x20out','build2','secret','Server','SIGTERM','simple','DEFLATE','accept','show','Deleted\x20Bot\x20','Unauthorized\x20attempt\x20to\x20confirm\x20message','Notifications\x20enabled\x0a','Password\x20has\x20been\x20reset\x20to:\x20','127.0.0.1','ipaddr.js','token','defaults','toIPv4Address','connected','placeOrder','bot.js','/restart\x20-\x20restart\x20bot(s)\x0a','File\x20uploaded','index.html','getUTCHours','backup-full@','crypto','inlineKeyboard','reinstall_no','RSA','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Unauthorized\x20login\x20attempt\x20(timeout)','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','delete-alerts','Restarting\x20Bot\x20','Starting\x20new\x20bot\x20|\x20Bot\x20','botname','http','debug','sendFile','#RES#\x20if\x20running\x20on\x20server','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','error','slice','HTML','6b67f3d61ee94b8f5c80b4affef4c4d9','rmSync','updatebotmanager','$1_$2_$3','length','\x20|\x20user:\x20...','Unauthorized\x20attempt\x20to\x20delete\x20alerts','sendMessage','apiSecret','bots','Notifications\x20disabled\x0a','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','get-messages','editMessageReplyMarkup','padStart','#RES#\x20if\x20running\x20locally\x0a','-performance.json','handshake','order','confirm-message','kill','getPortfolio','cancelLoading','started','auto','11SqBKxS','get-logs','=>\x20Go\x20to\x20#CYA#http://','bb-secure.json','off','showConfig','restore_yes_','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Telegram\x20error:','test','timestamp','assign','toString','number','#RES#\x20','<b>Balance\x20Bot\x20Status:</b>\x0a','publicKey','family','orders','update_no','/:bot/performance','/disable\x20-\x20disable\x20notifications\x0a','IPv4','exchange','output-003.log','restore_no_','reason','toggleBotMode','451414xOwCbu','find','/update\x20-\x20update\x20Balance\x20Bot\x0a','title','bb/'];_0x1b69=function(){return _0x3604f8;};return _0x1b69();}(function(_0x17ca78,_0x3f4dda){const _0x3160c6=_0x16b2,_0x3b38a4=_0x17ca78();while(!![]){try{const _0x221014=-parseInt(_0x3160c6(0x28c))/0x1+-parseInt(_0x3160c6(0x1b6))/0x2+-parseInt(_0x3160c6(0x307))/0x3*(-parseInt(_0x3160c6(0x290))/0x4)+parseInt(_0x3160c6(0x352))/0x5+parseInt(_0x3160c6(0x1f1))/0x6*(-parseInt(_0x3160c6(0x2f1))/0x7)+-parseInt(_0x3160c6(0x2e2))/0x8*(parseInt(_0x3160c6(0x239))/0x9)+-parseInt(_0x3160c6(0x2a7))/0xa*(-parseInt(_0x3160c6(0x19a))/0xb);if(_0x221014===_0x3f4dda)break;else _0x3b38a4['push'](_0x3b38a4['shift']());}catch(_0x1bff17){_0x3b38a4['push'](_0x3b38a4['shift']());}}}(_0x1b69,0x397f4));const _0x5a26aa=function(){let _0x4c3d3d=!![];return function(_0x5e7ff3,_0x2c8576){const _0x47d446=_0x4c3d3d?function(){const _0x5a9d0a=_0x16b2;if(_0x2c8576){const _0x25c87c=_0x2c8576[_0x5a9d0a(0x1f4)](_0x5e7ff3,arguments);return _0x2c8576=null,_0x25c87c;}}:function(){};return _0x4c3d3d=![],_0x47d446;};}(),_0x1085c6=_0x5a26aa(this,function(){const _0x2053be=_0x16b2;return _0x1085c6['toString']()[_0x2053be(0x2cc)](_0x2053be(0x2bf))['toString']()['constructor'](_0x1085c6)[_0x2053be(0x2cc)]('(((.+)+)+)+$');});_0x1085c6();'use strict';process[_0x5cada0(0x30e)][_0x5cada0(0x1de)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x5cada0(0x309)),low=require(_0x5cada0(0x1e5)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x5cada0(0x288)),crypto=require(_0x5cada0(0x37f)),Crypt=require('hybrid-crypto-js')[_0x5cada0(0x33d)],RSA=require(_0x5cada0(0x342))[_0x5cada0(0x382)],bcrypt=require(_0x5cada0(0x210)),jwt=require(_0x5cada0(0x231)),ipaddr=require(_0x5cada0(0x373)),argv=require('yargs/yargs')(process['argv'][_0x5cada0(0x17f)](0x2))[_0x5cada0(0x2ea)],uuidRandom=require('uuid-random'),{Telegraf,Markup}=require(_0x5cada0(0x1cd)),Mixpanel=require(_0x5cada0(0x33a)),axios=require(_0x5cada0(0x2de)),{GraphQLClient,gql}=require(_0x5cada0(0x203)),util=require(_0x5cada0(0x2c0)),fileUpload=require(_0x5cada0(0x2ba)),{networkInterfaces}=require('os'),PORT=argv[_0x5cada0(0x240)]||_0x5cada0(0x344),pattern=/^[0-9]{2,4}$/;!pattern[_0x5cada0(0x1a3)](PORT)&&(console[_0x5cada0(0x23a)](_0x5cada0(0x317)+PORT+_0x5cada0(0x1fc)),process[_0x5cada0(0x2c8)](0x1));const HOST=argv[_0x5cada0(0x2cd)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x5cada0(0x1be)][_0x5cada0(0x1cf)];let bbpath=_0x5cada0(0x1ba),bbpath2='';const botfile=_0x5cada0(0x379),configfile=_0x5cada0(0x286),settingsfile=_0x5cada0(0x2d6),securefile=_0x5cada0(0x19d),environment=require('./'+bbpath2+_0x5cada0(0x30d))['environment']||'production',maxBackups=0xa;let validInstallation=!![];!fs[_0x5cada0(0x27d)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x5cada0(0x1d3),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x5cada0(0x31c)+userID+'/':bbpath+_0x5cada0(0x31c),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x5cada0(0x1e3),loggerfile=fs['createWriteStream'](logspath+_0x5cada0(0x30a),{'flags':'a'}),temppath=userID?bbpath+_0x5cada0(0x214)+userID+'/':bbpath+_0x5cada0(0x214);!fs['existsSync'](configpath)&&fs['mkdirSync'](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x5cada0(0x2c9)](configbackuppath);!fs[_0x5cada0(0x27d)](logspath)&&fs['mkdirSync'](logspath);!fs['existsSync'](zippath)&&fs['mkdirSync'](zippath);!fs[_0x5cada0(0x27d)](temppath)&&fs[_0x5cada0(0x2c9)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x5cada0(0x375)]({'bots':[]})[_0x5cada0(0x1ce)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x5cada0(0x375)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x5cada0(0x2a5),'onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x5cada0(0x375)]({'secure':{},'blacklist':[]})[_0x5cada0(0x1ce)]();let crypt=new Crypt({'md':_0x5cada0(0x212),'rsaStandard':_0x5cada0(0x2b6)});const saltRounds=0xa,mixpanel=Mixpanel[_0x5cada0(0x213)](_0x5cada0(0x181),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings[_0x5cada0(0x242)]!=''&&settings[_0x5cada0(0x242)]!='***')&&settings[_0x5cada0(0x22a)]&&settings[_0x5cada0(0x22a)]!='')initTelegram();const parseColor=(_0x21d1a0,_0x18ea82)=>{const _0x268629=_0x5cada0,_0x3c0b3f=/#[A-Z]{3}#/g;if(typeof _0x21d1a0==_0x268629(0x23e)){!_0x18ea82?_0x21d1a0=_0x21d1a0['replace'](_0x3c0b3f,''):(_0x21d1a0=_0x21d1a0[_0x268629(0x1c2)](/#BLU#/g,_0x268629(0x202)),_0x21d1a0=_0x21d1a0[_0x268629(0x1c2)](/#RED#/g,_0x268629(0x348)),_0x21d1a0=_0x21d1a0[_0x268629(0x1c2)](/#YEL#/g,_0x268629(0x32a)),_0x21d1a0=_0x21d1a0[_0x268629(0x1c2)](/#MAG#/g,_0x268629(0x247)),_0x21d1a0=_0x21d1a0['replace'](/#CYA#/g,_0x268629(0x2fc)),_0x21d1a0=_0x21d1a0[_0x268629(0x1c2)](/#RES#/g,'\x1b[0m'));;}return _0x21d1a0;},logger={'screen':_0x300bc6=>{console['log'](parseColor(_0x300bc6,!![]));},'simple':_0x40a4ee=>{const _0x2cff40=_0x5cada0;console[_0x2cff40(0x23a)](parseColor(_0x40a4ee,!![])),loggerfile[_0x2cff40(0x1ce)](util[_0x2cff40(0x293)](parseColor(_0x40a4ee,![]))+'\x0a');},'full':async _0x5890aa=>{const _0x1f8af3=_0x5cada0,_0x1132a9=getTimeStamp()+_0x1f8af3(0x236)+_0x5890aa;console[_0x1f8af3(0x23a)](parseColor(_0x1132a9,!![])),loggerfile[_0x1f8af3(0x1ce)](util[_0x1f8af3(0x293)](parseColor(_0x1132a9,![]))+'\x0a');if(tgBot&&settings[_0x1f8af3(0x254)]&&settings[_0x1f8af3(0x26e)]!='orders')await sendTelegram(settings['telegramChatId'],_0x1f8af3(0x280)+parseColor(_0x5890aa,![]));},'debug':async(_0xd79fa2,_0x10bad0='')=>{const _0xc434b=_0x5cada0,_0x567013=getTimeStamp()+_0xc434b(0x269)+_0xd79fa2;if(debugging)console[_0xc434b(0x23a)](parseColor(_0x567013,!![]));loggerfile[_0xc434b(0x1ce)](util[_0xc434b(0x293)](parseColor(_0x567013,![]))+'\x0a');if(_0x10bad0){if(debugging)console['log'](_0x10bad0);loggerfile[_0xc434b(0x1ce)](util['format'](_0x10bad0)+'\x0a');}}};let terminating=![];process['on'](_0x5cada0(0x204),function(_0x48648d){const _0x3be1c1=_0x5cada0;logger[_0x3be1c1(0x36a)](_0x48648d);}),process['on'](_0x5cada0(0x2c8),()=>{stopAllBots();}),process['on']('SIGINT',()=>{stopAllBots();});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x5cada0(0x30d))[_0x5cada0(0x251)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];function _0x16b2(_0x31e532,_0xeac3e7){const _0x38a16b=_0x1b69();return _0x16b2=function(_0x1085c6,_0x5a26aa){_0x1085c6=_0x1085c6-0x173;let _0x1b69f2=_0x38a16b[_0x1085c6];return _0x1b69f2;},_0x16b2(_0x31e532,_0xeac3e7);}const express=require(_0x5cada0(0x326)),app=express(),http=require(_0x5cada0(0x179))[_0x5cada0(0x2d2)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x5cada0(0x323)]('/download/:type',async(_0x22b179,_0x4e96a4)=>{const _0x3d8ae0=_0x5cada0,_0x5ecb26=_0x22b179[_0x3d8ae0(0x25f)][_0x3d8ae0(0x222)],_0x1657fd=getClientsWithBotID(_0x3d8ae0(0x2db)),_0x5d3dca=_0x22b179[_0x3d8ae0(0x316)][_0x3d8ae0(0x31a)],_0x11ef37=timelyDecrypt(_0x5d3dca,![]),_0x351833=_0x1657fd[_0x3d8ae0(0x1b7)](_0x52d2c5=>_0x52d2c5[_0x3d8ae0(0x31a)]==_0x11ef37);if(_0x351833){const _0x416eed=normalizeIP(_0x22b179['socket'][_0x3d8ae0(0x21b)])[_0x3d8ae0(0x2eb)],_0x2e3dbe=_0x22b179[_0x3d8ae0(0x316)]['tkn'];if(validateAccess(_0x2e3dbe,_0x11ef37,_0x416eed)['allow'])_0x5ecb26==_0x3d8ae0(0x24a)&&await backupConfigFiles(),await zipFiles(_0x5ecb26),_0x4e96a4[_0x3d8ae0(0x23d)](zippath+(_0x5ecb26+'.zip'),_0x1f4bad=>{const _0x4c48e3=_0x3d8ae0;_0x1f4bad&&(logger[_0x4c48e3(0x25a)]('Failed\x20to\x20download\x20'+_0x5ecb26),logger[_0x4c48e3(0x36a)](_0x1f4bad));});else logger[_0x3d8ae0(0x25a)](_0x3d8ae0(0x1da)+_0x5ecb26+_0x3d8ae0(0x351));}else logger[_0x3d8ae0(0x25a)](_0x3d8ae0(0x1da)+_0x5ecb26+_0x3d8ae0(0x25e));}),app[_0x5cada0(0x24c)](_0x5cada0(0x226),async(_0x1be333,_0x27f4e4)=>{const _0x54fd62=_0x5cada0,_0x297454=getClientsWithBotID('botmanager'),_0x110379=_0x1be333[_0x54fd62(0x316)][_0x54fd62(0x31a)],_0x351165=timelyDecrypt(_0x110379,![]),_0x5c4457=_0x297454[_0x54fd62(0x1b7)](_0xade98e=>_0xade98e[_0x54fd62(0x31a)]==_0x351165);logger[_0x54fd62(0x17a)](_0x54fd62(0x1c4));if(_0x5c4457){const _0x1d1b1c=normalizeIP(_0x1be333['socket']['remoteAddress'])['store'],_0x51f36b=_0x1be333['headers'][_0x54fd62(0x306)];if(validateAccess(_0x51f36b,_0x351165,_0x1d1b1c)[_0x54fd62(0x215)]){if(_0x1be333[_0x54fd62(0x304)]){const _0x2ac185=_0x1be333['files']['backupfile'];await _0x2ac185['mv'](temppath+_0x2ac185['name']),_0x27f4e4[_0x54fd62(0x335)]({'status':!![],'message':_0x54fd62(0x37b)});const _0x5f1874=getBotsWithMode();_0x5f1874[_0x54fd62(0x185)]>0x0?confirmRestore(temppath,_0x2ac185[_0x54fd62(0x32c)]):unzipFile(temppath,_0x2ac185[_0x54fd62(0x32c)]);}}else logger[_0x54fd62(0x25a)](_0x54fd62(0x23c));}else logger[_0x54fd62(0x25a)](_0x54fd62(0x173));}),app[_0x5cada0(0x349)](express[_0x5cada0(0x22f)](path['join'](__dirname,bbpath2,_0x5cada0(0x366)))),app[_0x5cada0(0x349)](express[_0x5cada0(0x22f)](path['join'](__dirname,bbpath2,_0x5cada0(0x331)))),app[_0x5cada0(0x323)]('/',function(_0x1762df,_0xd18a6c){const _0x5a8edb=_0x5cada0;_0xd18a6c[_0x5a8edb(0x17b)](path[_0x5a8edb(0x274)](__dirname,bbpath2,'build2',_0x5a8edb(0x37c)));}),app[_0x5cada0(0x323)](_0x5cada0(0x246),function(_0x30e6f5,_0x371561){const _0x1b2183=_0x5cada0;_0x371561[_0x1b2183(0x17b)](path[_0x1b2183(0x274)](__dirname,bbpath2,_0x1b2183(0x331),_0x1b2183(0x37c)));}),app['get'](_0x5cada0(0x257),(_0x13b51f,_0x44acd2)=>{const _0x37af85=_0x5cada0;_0x44acd2[_0x37af85(0x17b)](path[_0x37af85(0x274)](__dirname,bbpath2,_0x37af85(0x331),_0x37af85(0x37c)));}),app[_0x5cada0(0x323)](_0x5cada0(0x1ae),(_0x4fb6b7,_0x559002)=>{const _0x428d27=_0x5cada0;_0x559002[_0x428d27(0x17b)](path[_0x428d27(0x274)](__dirname,bbpath2,_0x428d27(0x331),_0x428d27(0x37c)));}),app[_0x5cada0(0x323)]('/:bot/coins',(_0x5824e5,_0x307695)=>{const _0x3bb710=_0x5cada0;_0x307695[_0x3bb710(0x17b)](path['join'](__dirname,bbpath2,_0x3bb710(0x331),_0x3bb710(0x37c)));}),app[_0x5cada0(0x323)](_0x5cada0(0x1c9),(_0x5a8cc2,_0x248240)=>{const _0x39edda=_0x5cada0;_0x248240[_0x39edda(0x17b)](path[_0x39edda(0x274)](__dirname,bbpath2,_0x39edda(0x331),_0x39edda(0x37c)));}),app['get'](_0x5cada0(0x31b),(_0x4ceb71,_0x52ac3b)=>{const _0x3fc4e8=_0x5cada0;_0x52ac3b[_0x3fc4e8(0x17b)](path['join'](__dirname,bbpath2,_0x3fc4e8(0x331),_0x3fc4e8(0x37c)));}),app['get']('/:bot/support',(_0x389e87,_0x4b589b)=>{const _0x119005=_0x5cada0;_0x4b589b[_0x119005(0x17b)](path[_0x119005(0x274)](__dirname,bbpath2,_0x119005(0x331),_0x119005(0x37c)));});if(HOST)http['listen'](PORT,HOST);else http[_0x5cada0(0x2d8)](PORT);const io=require(_0x5cada0(0x300))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1491e5=_0x5cada0;let _0xf4ac17='[ip-address]';const _0x5f2390=networkInterfaces(),_0x102664={};for(const _0x57f9b8 of Object[_0x1491e5(0x224)](_0x5f2390)){for(const _0x36e332 of _0x5f2390[_0x57f9b8]){if((_0x36e332[_0x1491e5(0x1ab)]==_0x1491e5(0x1b0)||_0x36e332[_0x1491e5(0x1ab)]==0x4)&&!_0x36e332[_0x1491e5(0x261)]){const _0x489d8c=ipaddr[_0x1491e5(0x1ec)](_0x36e332[_0x1491e5(0x1dd)])[_0x1491e5(0x2f2)]();_0x489d8c!=_0x1491e5(0x21c)&&(!_0x102664[_0x57f9b8]&&(_0x102664[_0x57f9b8]=[]),_0x102664[_0x57f9b8][_0x1491e5(0x237)](_0x36e332[_0x1491e5(0x1dd)]),_0xf4ac17=_0x36e332['address']);}}}return{'serverip':_0xf4ac17,'netinterfaces':_0x102664};}async function startServer(){const _0x53d52a=_0x5cada0,{serverip:_0x4322be,netinterfaces:_0x56aceb}=getServerIP();logger[_0x53d52a(0x36a)](''),logger['simple'](_0x53d52a(0x207)),await logger[_0x53d52a(0x25a)](_0x53d52a(0x221)+serverversion+_0x53d52a(0x1a8)+(environment==_0x53d52a(0x343)?'(staging)':'')+'\x0a'+(_0x53d52a(0x238)+PORT+_0x53d52a(0x190))+(_0x53d52a(0x19c)+_0x4322be+':'+PORT+_0x53d52a(0x17c))),logger[_0x53d52a(0x36a)]('-----------------------------------------------------------------------------------');if(config[_0x53d52a(0x185)]!=0x0)for(const _0x2e2f2f of config){const _0x1d91e4=_0x2e2f2f[_0x53d52a(0x2df)]==_0x53d52a(0x199)?'a':'m';if(_0x2e2f2f['status']==_0x53d52a(0x362)||_0x2e2f2f['status']==_0x53d52a(0x22b))await logger['full'](_0x53d52a(0x29e)+_0x1d91e4+')\x20|\x20Bot\x20'+_0x2e2f2f['botID']+_0x53d52a(0x1e9)+_0x2e2f2f['botname']),startBot([_0x2e2f2f[_0x53d52a(0x22d)],userID],{'cwd':bbpath},function(_0x55d016){if(_0x55d016)logger['full'](_0x55d016);});else(_0x2e2f2f['status']==_0x53d52a(0x321)||_0x2e2f2f[_0x53d52a(0x2b3)]=='new-disabled')&&await logger[_0x53d52a(0x25a)](_0x53d52a(0x2fd)+_0x1d91e4+_0x53d52a(0x298)+_0x2e2f2f['botID']+'\x20|\x20'+_0x2e2f2f[_0x53d52a(0x178)]);}else!newBot&&logger[_0x53d52a(0x36a)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x53d52a(0x36a)](_0x53d52a(0x207)),logger['simple'](''),await logger['debug'](_0x53d52a(0x2b8)+nodeversion),await logger[_0x53d52a(0x17a)]('Network\x20Interfaces:',_0x56aceb);}function startSocket(){io['on']('connection',_0x14dd39=>{const _0x59072c=_0x16b2;let _0x1fc6fe,_0x191406,_0x417eef,_0x2d020c,_0x2ca823;const _0x1b1f2d=_0x14dd39['handshake'][_0x59072c(0x316)][_0x59072c(0x230)];_0x191406=_0x1b1f2d[_0x59072c(0x273)](/bot[0-9]{3}/);if(_0x191406)_0x417eef=_0x191406[0x0][_0x59072c(0x273)](/[0-9]{3}/);if(_0x417eef)_0x1fc6fe=_0x417eef[0x0];else _0x1fc6fe=_0x59072c(0x2db);const _0xf37c0d=_0x14dd39[_0x59072c(0x192)]['auth']['encryptedUuid'];if(!_0xf37c0d)_0x14dd39[_0x59072c(0x319)](_0x59072c(0x2b3),{'publicKey':secure[_0x59072c(0x1aa)]});else{_0x2d020c=timelyDecrypt(_0xf37c0d,![]);if(!_0x2d020c)_0x14dd39[_0x59072c(0x319)]('status',{'publicKey':secure[_0x59072c(0x1aa)]});else{_0x2ca823=normalizeIP(_0x14dd39[_0x59072c(0x2ca)][_0x59072c(0x21b)])[_0x59072c(0x2eb)];if(!devices[_0x2d020c])devices[_0x2d020c]={'uuid':_0x2d020c,'access':{'token':null}};devices[_0x2d020c]['ip']=_0x2ca823;const _0x65c642=addClient(_0x14dd39['id'],_0x2d020c,_0x1fc6fe);setAccess(_0x65c642),emitMessages(),_0x14dd39['on'](_0x59072c(0x2a1),_0x5b5bb1=>{const _0x57a12b=_0x59072c,_0x51b56e=timelyDecrypt(_0x5b5bb1[_0x57a12b(0x1c8)]);if(_0x51b56e){_0x5b5bb1={'username':_0x5b5bb1[_0x57a12b(0x201)],'password':_0x51b56e},devices[_0x2d020c][_0x57a12b(0x260)]=validateCredentials(_0x5b5bb1,_0x2d020c);if(devices[_0x2d020c][_0x57a12b(0x260)]['allow']==![]&&devices[_0x2d020c][_0x57a12b(0x260)][_0x57a12b(0x1b4)]==_0x57a12b(0x23b))_0x14dd39[_0x57a12b(0x319)](_0x57a12b(0x2b3),{'access':devices[_0x2d020c]['access']}),loginAccess2FA(_0x2d020c,_0x2ca823);else{if(devices[_0x2d020c][_0x57a12b(0x260)][_0x57a12b(0x215)]==![]&&devices[_0x2d020c][_0x57a12b(0x260)][_0x57a12b(0x1b4)]==_0x57a12b(0x346))_0x14dd39[_0x57a12b(0x319)](_0x57a12b(0x2b3),{'access':devices[_0x2d020c][_0x57a12b(0x260)]});else devices[_0x2d020c][_0x57a12b(0x260)][_0x57a12b(0x215)]&&devices[_0x2d020c][_0x57a12b(0x260)]['reason']==_0x57a12b(0x24d)&&(getClientsWithUuid(_0x2d020c)['forEach'](_0x28cd3d=>{setAccess(_0x28cd3d);}),logger[_0x57a12b(0x17a)](_0x57a12b(0x262)+_0x2d020c[_0x57a12b(0x17f)](-0x8)),setTokenRefresh(_0x2d020c),setSessionTimeout('login',_0x2d020c));}}else logger['full'](_0x57a12b(0x384));}),_0x14dd39['on'](_0x59072c(0x258),()=>{resetPassword();}),_0x14dd39['on']('disconnect',_0x3858fb=>{removeClient(_0x14dd39['id']);}),_0x1fc6fe=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x2c342d){const _0x114f4d=_0x5cada0;if(_0x2c342d!=_0x114f4d(0x2db)&&config[_0x114f4d(0x32b)]!=''){if(pid[_0x2c342d])pid[_0x2c342d][_0x114f4d(0x335)]({'function':_0x114f4d(0x220),'args':null});}_0x2c342d!='botmanager'&&broadcastToBots(_0x114f4d(0x18a),JSON[_0x114f4d(0x310)](config));}function reloadBotManager(){const _0x111ea5=_0x5cada0;getClientsWithBotID(_0x111ea5(0x2db))[_0x111ea5(0x2cb)](_0x42f1e5=>{const _0x3ed747=_0x111ea5;getSocket(_0x42f1e5['id'])['emit'](_0x3ed747(0x2b3),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x37633d){const _0x5d8860=_0x5cada0;return io[_0x5d8860(0x1d8)][_0x5d8860(0x1d8)][_0x5d8860(0x323)](_0x37633d);}function setAccess(_0x1b716d){const _0xfe53e7=_0x5cada0,_0x455a16=getSocket(_0x1b716d['id']),_0x2c89ea=_0x1b716d[_0xfe53e7(0x31a)],_0x30b763=_0x1b716d[_0xfe53e7(0x2f8)];devices[_0x2c89ea][_0xfe53e7(0x260)]=validateAccess(devices[_0x2c89ea][_0xfe53e7(0x260)][_0xfe53e7(0x374)],_0x2c89ea),logger[_0xfe53e7(0x17a)](_0xfe53e7(0x2dd)+devices[_0x2c89ea][_0xfe53e7(0x260)][_0xfe53e7(0x1b4)]+_0xfe53e7(0x1e6)+_0x1b716d['id'][_0xfe53e7(0x17f)](-0x8)+_0xfe53e7(0x186)+_0x2c89ea[_0xfe53e7(0x17f)](-0x8)),_0x455a16[_0xfe53e7(0x274)](_0x2c89ea);if(devices[_0x2c89ea][_0xfe53e7(0x260)]['allow']){_0x455a16[_0xfe53e7(0x274)](_0x30b763);if(_0x30b763==_0xfe53e7(0x2db))initializeSocketBotManager(_0x455a16);else initializeSocketBot(_0x455a16);initClient(_0x30b763);}devices[_0x2c89ea][_0xfe53e7(0x260)][_0xfe53e7(0x374)]&&devices[_0x2c89ea][_0xfe53e7(0x260)]['reason']==_0xfe53e7(0x29f)&&setSessionTimeout(_0xfe53e7(0x356),_0x2c89ea),devices[_0x2c89ea][_0xfe53e7(0x260)][_0xfe53e7(0x374)]&&devices[_0x2c89ea]['access']['reason']==_0xfe53e7(0x2d0)&&setSessionTimeout(_0xfe53e7(0x2a1),_0x2c89ea),_0x455a16[_0xfe53e7(0x319)](_0xfe53e7(0x2b3),{'status':_0x1b716d['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2c89ea]['access'],'externalip':devices[_0x2c89ea]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0xfe53e7(0x29c)],'validInstallation':validInstallation}),devices[_0x2c89ea][_0xfe53e7(0x260)][_0xfe53e7(0x215)]==![]&&devices[_0x2c89ea][_0xfe53e7(0x260)][_0xfe53e7(0x1b4)]==_0xfe53e7(0x200)&&temporaryAccess2FA(_0x2c89ea,devices[_0x2c89ea]['ip']);}function setSessionTimeout(_0x4ea394,_0x9a99a6){const _0x16e31c=_0x5cada0;let _0x384fe4;if(_0x4ea394==_0x16e31c(0x2a1))_0x384fe4=loginExpiry*0x3c*0x3e8;else _0x384fe4=devices[_0x9a99a6]['telegramIpApproval'][_0x16e31c(0x2b7)]*0x3c*0x3e8-(new Date()[_0x16e31c(0x217)]()-devices[_0x9a99a6][_0x16e31c(0x1c0)]['timestamp']);if(devices[_0x9a99a6]['pidExpireLogin'])clearTimeout(devices[_0x9a99a6][_0x16e31c(0x340)]);devices[_0x9a99a6][_0x16e31c(0x340)]=setTimeout(()=>{const _0x4c03e1=_0x16e31c;if(devices[_0x9a99a6][_0x4c03e1(0x259)])clearTimeout(devices[_0x9a99a6][_0x4c03e1(0x259)]);removeSocketListeners(_0x9a99a6),addBlacklist(_0x9a99a6),devices[_0x9a99a6][_0x4c03e1(0x1c0)]=null,devices[_0x9a99a6][_0x4c03e1(0x338)]=null,devices[_0x9a99a6][_0x4c03e1(0x260)]['token']=null,logger[_0x4c03e1(0x17a)](_0x4c03e1(0x325)+_0x9a99a6[_0x4c03e1(0x17f)](-0x8)),devices[_0x9a99a6][_0x4c03e1(0x260)]=validateAccess(devices[_0x9a99a6]['access'][_0x4c03e1(0x374)],_0x9a99a6),!(devices[_0x9a99a6]['access'][_0x4c03e1(0x215)]&&devices[_0x9a99a6]['access'][_0x4c03e1(0x1b4)]==_0x4c03e1(0x26a))&&(_0x4ea394==_0x4c03e1(0x2a1)?io['to'](_0x9a99a6)[_0x4c03e1(0x319)](_0x4c03e1(0x2b3),{'access':{'allow':![],'reason':_0x4c03e1(0x359),'token':null}}):io['to'](_0x9a99a6)[_0x4c03e1(0x319)](_0x4c03e1(0x2b3),{'access':{'allow':![],'reason':_0x4c03e1(0x1fa),'token':null}})),devices[_0x9a99a6][_0x4c03e1(0x260)][_0x4c03e1(0x374)]=null;},_0x384fe4);}function setTokenRefresh(_0x361e63){const _0x5ef556=_0x5cada0;if(devices[_0x361e63][_0x5ef556(0x259)])clearTimeout(devices[_0x361e63][_0x5ef556(0x259)]);devices[_0x361e63][_0x5ef556(0x259)]=setTimeout(()=>{const _0x4da56a=_0x5ef556;getClientsWithUuid(_0x361e63)[_0x4da56a(0x185)]!=0x0?(devices[_0x361e63]['access']=refreshToken(_0x361e63),io['to'](_0x361e63)['emit'](_0x4da56a(0x2b3),{'status':_0x4da56a(0x377),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x361e63]['access'],'externalip':devices[_0x361e63]['ip'],'publicKey':secure[_0x4da56a(0x1aa)],'validInstallation':validInstallation}),setTokenRefresh(_0x361e63)):clearTimeout(devices[_0x361e63][_0x4da56a(0x259)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3987ac){const _0xb7e1a4=_0x5cada0,_0xf9926d=getClient(_0x3987ac['id'])[_0xb7e1a4(0x31a)];_0x3987ac[_0xb7e1a4(0x319)](_0xb7e1a4(0x18a),config),_0x3987ac[_0xb7e1a4(0x319)](_0xb7e1a4(0x20e),cleanSettings()),_0x3987ac['on'](_0xb7e1a4(0x2e4),_0x5342fe=>{const _0x48746e=_0xb7e1a4;if(validateAccess(_0x5342fe,_0xf9926d)[_0x48746e(0x215)])addBot();else logger[_0x48746e(0x25a)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x3987ac['on'](_0xb7e1a4(0x2f4),(_0x6a7126,_0x41fa4e)=>{const _0x367497=_0xb7e1a4;if(validateAccess(_0x41fa4e,_0xf9926d)[_0x367497(0x215)])toggleBot(_0x6a7126[_0x367497(0x22d)],_0x6a7126[_0x367497(0x2b3)],_0x6a7126[_0x367497(0x25c)]);else logger['full'](_0x367497(0x229));}),_0x3987ac['on'](_0xb7e1a4(0x314),(_0xb07046,_0x319955)=>{const _0x43c7fd=_0xb7e1a4;if(validateAccess(_0x319955,_0xf9926d)[_0x43c7fd(0x215)])toggleBotMode(_0xb07046);else logger[_0x43c7fd(0x25a)](_0x43c7fd(0x229));}),_0x3987ac['on'](_0xb7e1a4(0x289),(_0x4138d6,_0x346413)=>{const _0x52ec7a=_0xb7e1a4;if(validateAccess(_0x346413,_0xf9926d)[_0x52ec7a(0x215)])deleteBot(_0x4138d6);else logger[_0x52ec7a(0x25a)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x3987ac['on'](_0xb7e1a4(0x327),(_0x210d01,_0x4cb75e)=>{const _0x21f941=_0xb7e1a4;if(validateAccess(_0x4cb75e,_0xf9926d)[_0x21f941(0x215)])storeSettings(_0x210d01,!![]);else logger[_0x21f941(0x25a)](_0x21f941(0x250));}),_0x3987ac['on'](_0xb7e1a4(0x2d5),_0x1867b7=>{const _0x174e38=_0xb7e1a4;if(validateAccess(_0x1867b7,_0xf9926d)[_0x174e38(0x215)])updateBB('update');else logger[_0x174e38(0x25a)](_0x174e38(0x295));}),_0x3987ac['on'](_0xb7e1a4(0x33f),_0x28004e=>{const _0x177370=_0xb7e1a4;if(validateAccess(_0x28004e,_0xf9926d)[_0x177370(0x215)])updateBB(_0x177370(0x22e));else logger[_0x177370(0x25a)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x3987ac['on'](_0xb7e1a4(0x2c2),_0x508d3a=>{const _0x48ada0=_0xb7e1a4;if(validateAccess(_0x508d3a,_0xf9926d)[_0x48ada0(0x215)]){const _0x3c0aa4=getClient(_0x3987ac['id']);if(_0x3c0aa4)getBackupFiles(_0x3c0aa4[_0x48ada0(0x31a)]);else logger[_0x48ada0(0x25a)](_0x48ada0(0x28d));}else logger[_0x48ada0(0x25a)](_0x48ada0(0x174));}),_0x3987ac['on']('restore-backup-file',(_0x52af29,_0x5d8d6f)=>{const _0xaf750a=_0xb7e1a4;if(validateAccess(_0x5d8d6f,_0xf9926d)[_0xaf750a(0x215)])restoreBackupFile(_0x52af29);else logger[_0xaf750a(0x25a)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x3987ac['on'](_0xb7e1a4(0x18d),_0x850925=>{if(validateAccess(_0x850925,_0xf9926d)['allow'])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x3987ac['on'](_0xb7e1a4(0x194),(_0xa42ab0,_0x321d87)=>{const _0x2b8ded=_0xb7e1a4;if(validateAccess(_0x321d87,_0xf9926d)[_0x2b8ded(0x215)])confirmMessage(_0xa42ab0);else logger[_0x2b8ded(0x25a)](_0x2b8ded(0x36f));}),_0x3987ac['on'](_0xb7e1a4(0x2f9),_0x83c7a3=>{const _0x26addd=_0xb7e1a4;if(validateAccess(_0x83c7a3,_0xf9926d)[_0x26addd(0x215)]){if(devices[_0xf9926d][_0x26addd(0x259)])clearTimeout(devices[_0xf9926d][_0x26addd(0x259)]);if(devices[_0xf9926d][_0x26addd(0x340)])clearTimeout(devices[_0xf9926d][_0x26addd(0x340)]);removeSocketListeners(getClient(_0x3987ac['id'])[_0x26addd(0x31a)]),addBlacklist(_0xf9926d),devices[_0xf9926d][_0x26addd(0x1c0)]=null,devices[_0xf9926d][_0x26addd(0x338)]=null,devices[_0xf9926d][_0x26addd(0x260)][_0x26addd(0x374)]=null,logger[_0x26addd(0x17a)]('Logged\x20out\x20user\x20...'+_0xf9926d[_0x26addd(0x17f)](-0x8)),io['to'](getClient(_0x3987ac['id'])[_0x26addd(0x31a)])[_0x26addd(0x319)](_0x26addd(0x2b3),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x26addd(0x25a)](_0x26addd(0x263));});}function initializeSocketBot(_0x537a40){const _0x5f19d6=_0x5cada0,_0x3caff2=getClient(_0x537a40['id'])['bot'],_0x1f0c24=getClient(_0x537a40['id'])[_0x5f19d6(0x31a)];_0x537a40['on'](_0x5f19d6(0x19b),(_0x5e332f,_0x1ce3c1)=>{const _0x5df4fc=_0x5f19d6;if(validateAccess(_0x1ce3c1,_0x1f0c24)[_0x5df4fc(0x215)]){if(pid[_0x3caff2])pid[_0x3caff2][_0x5df4fc(0x335)]({'function':'emitHistory','args':_0x5e332f});}else logger[_0x5df4fc(0x25a)](_0x5df4fc(0x2f6));}),_0x537a40['on'](_0x5f19d6(0x175),(_0x471737,_0x1528ce)=>{const _0x4aeeb4=_0x5f19d6;if(validateAccess(_0x1528ce,_0x1f0c24)[_0x4aeeb4(0x215)]){if(pid[_0x3caff2])pid[_0x3caff2][_0x4aeeb4(0x335)]({'function':_0x4aeeb4(0x234),'args':_0x471737});}else logger[_0x4aeeb4(0x25a)](_0x4aeeb4(0x187));}),_0x537a40['on'](_0x5f19d6(0x232),(_0x4451c5,_0x27563b)=>{const _0x3975e9=_0x5f19d6;if(validateAccess(_0x27563b,_0x1f0c24)[_0x3975e9(0x215)]){if(pid[_0x3caff2])pid[_0x3caff2][_0x3975e9(0x335)]({'function':_0x3975e9(0x196),'args':_0x4451c5});}else logger[_0x3975e9(0x25a)](_0x3975e9(0x34e));}),_0x537a40['on'](_0x5f19d6(0x2a9),(_0x5ac7c0,_0x3ce389)=>{const _0x4478c3=_0x5f19d6;if(validateAccess(_0x3ce389,_0x1f0c24)[_0x4478c3(0x215)]){if(pid[_0x3caff2])pid[_0x3caff2][_0x4478c3(0x335)]({'function':_0x4478c3(0x24e),'args':_0x5ac7c0});}else logger[_0x4478c3(0x25a)](_0x4478c3(0x209));}),_0x537a40['on']('store-headless',(_0x3309b5,_0x22a913)=>{const _0x3063d8=_0x5f19d6;if(validateAccess(_0x22a913,_0x1f0c24)['allow']){if(pid[_0x3caff2])pid[_0x3caff2][_0x3063d8(0x335)]({'function':_0x3063d8(0x1ed),'args':_0x3309b5});}else logger[_0x3063d8(0x25a)](_0x3063d8(0x1fe));}),_0x537a40['on']('store-fiat',(_0x3fe44c,_0x247e3c)=>{const _0x40831b=_0x5f19d6;if(validateAccess(_0x247e3c,_0x1f0c24)[_0x40831b(0x215)]){if(pid[_0x3caff2])pid[_0x3caff2][_0x40831b(0x335)]({'function':_0x40831b(0x20a),'args':_0x3fe44c});}else logger[_0x40831b(0x25a)](_0x40831b(0x2e8));}),_0x537a40['on']('reset-history',_0xabeefb=>{const _0x31e1d2=_0x5f19d6;if(validateAccess(_0xabeefb,_0x1f0c24)[_0x31e1d2(0x215)]){if(pid[_0x3caff2])pid[_0x3caff2][_0x31e1d2(0x335)]({'function':'resetHistory','args':null});}else logger[_0x31e1d2(0x25a)](_0x31e1d2(0x1c6));}),_0x537a40['on'](_0x5f19d6(0x355),_0x7625e0=>{const _0x8fcc68=_0x5f19d6;if(validateAccess(_0x7625e0,_0x1f0c24)[_0x8fcc68(0x215)]){if(pid[_0x3caff2])pid[_0x3caff2]['send']({'function':_0x8fcc68(0x2e5),'args':null});}else logger['full'](_0x8fcc68(0x383));}),_0x537a40['on'](_0x5f19d6(0x2fb),(_0x44e753,_0x32c6e6)=>{const _0x12f27e=_0x5f19d6;if(validateAccess(_0x32c6e6,_0x1f0c24)[_0x12f27e(0x215)]){if(pid[_0x3caff2])pid[_0x3caff2][_0x12f27e(0x335)]({'function':_0x12f27e(0x378),'args':_0x44e753});}else logger[_0x12f27e(0x25a)](_0x12f27e(0x2e7));}),_0x537a40['on']('cancel-loading',_0x5cabc6=>{const _0x807584=_0x5f19d6;if(validateAccess(_0x5cabc6,_0x1f0c24)['allow']){if(pid[_0x3caff2])pid[_0x3caff2]['send']({'function':_0x807584(0x197),'args':null});}else logger[_0x807584(0x25a)](_0x807584(0x1c7));}),_0x537a40['on'](_0x5f19d6(0x2d4),_0x37b352=>{const _0x2e2b5f=_0x5f19d6;if(validateAccess(_0x37b352,_0x1f0c24)[_0x2e2b5f(0x215)]){if(pid[_0x3caff2])pid[_0x3caff2]['send']({'function':_0x2e2b5f(0x19f),'args':null});}else logger[_0x2e2b5f(0x25a)](_0x2e2b5f(0x2ac));}),_0x537a40['on'](_0x5f19d6(0x2d5),_0x4f4767=>{const _0x583614=_0x5f19d6;if(validateAccess(_0x4f4767,_0x1f0c24)['allow'])updateBB(_0x583614(0x28f));else logger[_0x583614(0x25a)](_0x583614(0x295));}),_0x537a40['on']('get-messages',_0x4634d4=>{const _0x5e4c17=_0x5f19d6;if(validateAccess(_0x4634d4,_0x1f0c24)[_0x5e4c17(0x215)])getMessages();else logger[_0x5e4c17(0x25a)](_0x5e4c17(0x1c3));}),_0x537a40['on'](_0x5f19d6(0x194),(_0x49aaa3,_0x167f73)=>{const _0x267e68=_0x5f19d6;if(validateAccess(_0x167f73,_0x1f0c24)[_0x267e68(0x215)])confirmMessage(_0x49aaa3);else logger[_0x267e68(0x25a)](_0x267e68(0x36f));}),_0x537a40['on'](_0x5f19d6(0x2f9),_0x5a4166=>{const _0x266b0d=_0x5f19d6;if(validateAccess(_0x5a4166,_0x1f0c24)[_0x266b0d(0x215)]){if(devices[_0x1f0c24][_0x266b0d(0x259)])clearTimeout(devices[_0x1f0c24]['pidRefreshToken']);if(devices[_0x1f0c24][_0x266b0d(0x340)])clearTimeout(devices[_0x1f0c24][_0x266b0d(0x340)]);removeSocketListeners(getClient(_0x537a40['id'])['uuid']),addBlacklist(_0x1f0c24),devices[_0x1f0c24][_0x266b0d(0x1c0)]=null,devices[_0x1f0c24][_0x266b0d(0x338)]=null,devices[_0x1f0c24][_0x266b0d(0x260)][_0x266b0d(0x374)]=null,logger[_0x266b0d(0x17a)]('Logged\x20out\x20user\x20...'+_0x1f0c24[_0x266b0d(0x17f)](-0x8)),io['to'](getClient(_0x537a40['id'])[_0x266b0d(0x31a)])[_0x266b0d(0x319)](_0x266b0d(0x2b3),{'access':{'allow':![],'reason':_0x266b0d(0x365),'token':null}});}else logger['full'](_0x266b0d(0x263));});}function removeSocketListeners(_0x862fbc){getClientsWithUuid(_0x862fbc)['forEach'](_0x389c66=>{const _0x1f943f=_0x16b2;getSocket(_0x389c66['id'])[_0x1f943f(0x337)]();});}function cleanSettings(){const _0x20b3fc=_0x5cada0;let _0x19ed24=settings;return settings['telegramToken']&&settings['telegramToken']!=''&&(_0x19ed24={..._0x19ed24,'telegramToken':_0x20b3fc(0x339)}),settings[_0x20b3fc(0x329)]&&settings['bbPassword']!=''&&(_0x19ed24={..._0x19ed24,'bbPassword':_0x20b3fc(0x339)}),(settings[_0x20b3fc(0x329)]&&settings['bbPassword']=='***'||settings[_0x20b3fc(0x242)]&&settings[_0x20b3fc(0x242)]==_0x20b3fc(0x336))&&(_0x19ed24={..._0x19ed24,'restored':{'password':settings[_0x20b3fc(0x329)]=='***','telegram':settings[_0x20b3fc(0x242)]=='***'}}),_0x19ed24;}async function updateBB(_0x4b109d){const _0x2333c0=_0x5cada0;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x2e206d=>{restartBot(_0x2e206d['botID']);});if(_0x4b109d==_0x2333c0(0x28f))process[_0x2333c0(0x335)]({'update':!![],'environment':environment},_0x500f1b=>{});else _0x4b109d==_0x2333c0(0x22e)&&process[_0x2333c0(0x335)]({'reinstall':!![],'environment':environment},_0x9e745f=>{});}function startBot(_0x4d3bcf,_0x350485,_0xd396ed){const _0x28f0c4=_0x5cada0;if(debugging)_0x4d3bcf['push']('-d');let _0x11ce28=![];const _0x46eea3=_0x4d3bcf[0x0];_0x350485={..._0x350485,'stdio':[_0x28f0c4(0x2f5),_0x28f0c4(0x2f5),_0x28f0c4(0x2f5),_0x28f0c4(0x206)]},pid[_0x46eea3]=childProcess[_0x28f0c4(0x311)](botfile,_0x4d3bcf,_0x350485),pid[_0x46eea3]['on'](_0x28f0c4(0x2a6),_0x165553=>{const _0x52ee27=_0x28f0c4;switch(Object[_0x52ee27(0x224)](_0x165553)[0x0]){case _0x52ee27(0x178):updateBotName(_0x46eea3,_0x165553[_0x52ee27(0x178)]);break;case _0x52ee27(0x183):updateBotManager();break;case'status':updateStatus(_0x46eea3,_0x165553[_0x52ee27(0x2b3)]);break;case _0x52ee27(0x25c):updateLive(_0x46eea3,_0x165553[_0x52ee27(0x25c)]);break;case _0x52ee27(0x198):updateLive(_0x46eea3,_0x165553[_0x52ee27(0x198)]),io['to'](_0x46eea3)[_0x52ee27(0x319)](_0x52ee27(0x2b3),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x52ee27(0x1fd):_0x165553[_0x52ee27(0x1fd)]==_0x52ee27(0x275)&&restartBot(_0x46eea3);_0x165553[_0x52ee27(0x1fd)]=='kill'&&toggleBot(_0x46eea3,_0x52ee27(0x321),_0x52ee27(0x266));break;case _0x52ee27(0x1bb):sendTelegramBot(_0x46eea3,_0x165553['telegram']);break;case _0x52ee27(0x34c):sendTelegramMsg(_0x165553[_0x52ee27(0x34c)]);break;case _0x52ee27(0x292):io['to'](_0x46eea3)[_0x52ee27(0x319)](_0x165553['function'],_0x165553[_0x52ee27(0x1f3)]);break;}}),pid[_0x46eea3]['on'](_0x28f0c4(0x17e),function(_0x3cfdd4){if(_0x11ce28)return;_0x11ce28=!![],_0xd396ed(_0x3cfdd4);}),pid[_0x46eea3]['on'](_0x28f0c4(0x2c8),async function(_0x1a8612){const _0x2a6885=_0x28f0c4;if(terminating)return;if(installingUpdate){logger[_0x2a6885(0x17a)]('Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process'),io[_0x2a6885(0x1cc)]();return;}if(_0x11ce28)return;_0x11ce28=!![],_0xd396ed(null);const _0x529197=dbConfig['get'](_0x2a6885(0x18a))['find']({'botID':_0x46eea3})[_0x2a6885(0x276)]();_0x529197&&(_0x529197[_0x2a6885(0x2b3)]==_0x2a6885(0x362)||_0x529197[_0x2a6885(0x2b3)]==_0x2a6885(0x22b))&&(await sleep(0x3e8),updateLive(_0x46eea3,_0x2a6885(0x266)),logger[_0x2a6885(0x25a)](_0x2a6885(0x176)+_0x46eea3),startBot([_0x46eea3,userID],{'cwd':bbpath},function(_0xbf8dde){const _0x349eea=_0x2a6885;if(_0xbf8dde)logger[_0x349eea(0x25a)](_0xbf8dde);}));});}function stopBot(_0x471b33){const _0x234d01=_0x5cada0;getClientsWithBotID(_0x471b33)['forEach'](_0x45b56d=>{const _0x5c1b44=_0x16b2;getSocket(_0x45b56d['id'])[_0x5c1b44(0x2b4)](!![]),removeClient(_0x45b56d['id']);}),pid[_0x471b33]&&(pid[_0x471b33][_0x234d01(0x195)](),pid[_0x471b33]=null);}function stopAllBots(){terminating=!![];const _0x2e6b26=getEnabledBots();_0x2e6b26['forEach'](_0x5a584d=>{const _0xa60a57=_0x16b2;stopBot(_0x5a584d[_0xa60a57(0x22d)]);});}function restartBot(_0x249f0f){const _0x42c8f2=_0x5cada0;if(pid[_0x249f0f])pid[_0x249f0f][_0x42c8f2(0x195)]();}function addBot(){const _0x2e4471=_0x5cada0;let _0x17c6b2;for(let _0x368ff9=0x1;_0x368ff9<0x3e9;_0x368ff9++){_0x17c6b2=_0x368ff9['toString']()[_0x2e4471(0x18f)](0x3,'0');let _0x729e9d=config[_0x2e4471(0x1b7)](_0xd4600a=>_0xd4600a[_0x2e4471(0x22d)]==_0x17c6b2);if(!_0x729e9d)break;}if(_0x17c6b2===_0x2e4471(0x2a8)){logger[_0x2e4471(0x25a)](_0x2e4471(0x328));return;}logger[_0x2e4471(0x25a)](_0x2e4471(0x177)+_0x17c6b2),dbConfig['get'](_0x2e4471(0x18a))['push']({'botID':_0x17c6b2,'botname':_0x2e4471(0x279)+_0x17c6b2,'status':_0x2e4471(0x22b),'live':''})[_0x2e4471(0x1ce)](),startBot([_0x17c6b2,userID],{'cwd':bbpath},function(_0x3bd483){const _0x4395d8=_0x2e4471;if(_0x3bd483)logger[_0x4395d8(0x25a)](_0x3bd483);}),config=getConfiguration(),io['to'](_0x2e4471(0x2db))[_0x2e4471(0x319)]('bots',config),broadcastToBots(_0x2e4471(0x18a),JSON[_0x2e4471(0x310)](config));}function deleteBot(_0xf470e3){const _0x460f35=_0x5cada0;getClientsWithBotID(_0xf470e3)[_0x460f35(0x2cb)](_0x1332a2=>{const _0x1b9c6a=_0x460f35;getSocket(_0x1332a2['id'])[_0x1b9c6a(0x2b4)](!![]),removeClient(_0x1332a2['id']);}),dbConfig[_0x460f35(0x323)]('bots')[_0x460f35(0x28a)]({'botID':_0xf470e3})[_0x460f35(0x1ce)](),logger[_0x460f35(0x25a)](_0x460f35(0x36e)+_0xf470e3),stopBot(_0xf470e3);try{if(fs[_0x460f35(0x27d)](path['join'](configpath,_0x460f35(0x277)+_0xf470e3+'-config.json')))fs[_0x460f35(0x294)](path[_0x460f35(0x274)](configpath,'bot-'+_0xf470e3+_0x460f35(0x1df)));if(fs[_0x460f35(0x27d)](path[_0x460f35(0x274)](configpath,_0x460f35(0x277)+_0xf470e3+_0x460f35(0x26d))))fs[_0x460f35(0x294)](path['join'](configpath,_0x460f35(0x277)+_0xf470e3+_0x460f35(0x26d)));if(fs['existsSync'](path[_0x460f35(0x274)](configpath,_0x460f35(0x277)+_0xf470e3+_0x460f35(0x191))))fs[_0x460f35(0x294)](path[_0x460f35(0x274)](configpath,_0x460f35(0x277)+_0xf470e3+_0x460f35(0x191)));if(fs[_0x460f35(0x27d)](path[_0x460f35(0x274)](configpath,_0x460f35(0x277)+_0xf470e3+_0x460f35(0x2ee))))fs['unlinkSync'](path[_0x460f35(0x274)](configpath,_0x460f35(0x277)+_0xf470e3+_0x460f35(0x2ee)));}catch(_0xc7d393){if(_0xc7d393)logger['full']('Error\x20while\x20deleting\x20config\x20files:\x20',_0xc7d393);}config=getConfiguration(),io['to'](_0x460f35(0x2db))[_0x460f35(0x319)](_0x460f35(0x18a),config),broadcastToBots('bots',JSON[_0x460f35(0x310)](config));}function toggleBot(_0x29f24a,_0x25e96c,_0x584ed8){const _0x5251b2=_0x5cada0;dbConfig[_0x5251b2(0x323)]('bots')[_0x5251b2(0x1b7)]({'botID':_0x29f24a})['assign']({'status':_0x25e96c})['assign']({'live':_0x584ed8})['write']();if(_0x25e96c=='enabled'||_0x25e96c==_0x5251b2(0x22b))logger[_0x5251b2(0x25a)](_0x5251b2(0x1ee)+_0x29f24a),startBot([_0x29f24a,userID],{'cwd':bbpath},function(_0x3736ba){if(_0x3736ba)logger['full'](_0x3736ba);});else(_0x25e96c==_0x5251b2(0x321)||_0x25e96c==_0x5251b2(0x2dc))&&(logger['full'](_0x5251b2(0x20f)+_0x29f24a),stopBot(_0x29f24a));config=getConfiguration(),io['to'](_0x5251b2(0x2db))[_0x5251b2(0x319)](_0x5251b2(0x18a),config),broadcastToBots('bots',JSON[_0x5251b2(0x310)](config));}function toggleStatus(_0x53b796){const _0x32967a=_0x5cada0;let _0x42ba71=dbConfig[_0x32967a(0x323)](_0x32967a(0x18a))[_0x32967a(0x1b7)]({'botID':_0x53b796})[_0x32967a(0x276)](),_0x2a013a;if(_0x42ba71['status']===_0x32967a(0x362))_0x2a013a=_0x32967a(0x321);else{if(_0x42ba71[_0x32967a(0x2b3)]===_0x32967a(0x22b))_0x2a013a=_0x32967a(0x2dc);else{if(_0x42ba71[_0x32967a(0x2b3)]===_0x32967a(0x2dc))_0x2a013a='new';else{if(_0x42ba71[_0x32967a(0x2b3)]==='disabled')_0x2a013a='enabled';}}}return _0x2a013a;}function updateStatus(_0x17ca82,_0x591849){const _0x150f05=_0x5cada0;dbConfig['get'](_0x150f05(0x18a))['find']({'botID':_0x17ca82})[_0x150f05(0x1a5)]({'status':_0x591849})[_0x150f05(0x1ce)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x150f05(0x18a),config),broadcastToBots(_0x150f05(0x18a),JSON[_0x150f05(0x310)](config));}function updateLive(_0x3e2964,_0x4a7544){const _0x1a148e=_0x5cada0;dbConfig[_0x1a148e(0x323)]('bots')[_0x1a148e(0x1b7)]({'botID':_0x3e2964})['assign']({'live':_0x4a7544})[_0x1a148e(0x1ce)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x1a148e(0x18a),config),broadcastToBots(_0x1a148e(0x18a),JSON[_0x1a148e(0x310)](config));}function updateBotName(_0x56a6b0,_0x32fea8){const _0x363097=_0x5cada0;dbConfig[_0x363097(0x323)]('bots')[_0x363097(0x1b7)]({'botID':_0x56a6b0})[_0x363097(0x1a5)]({'botname':_0x32fea8})[_0x363097(0x1ce)](),config=getConfiguration(),io['to'](_0x363097(0x2db))[_0x363097(0x319)](_0x363097(0x18a),config),broadcastToBots(_0x363097(0x18a),JSON['stringify'](config));}function updateBotManager(){const _0x5669b6=_0x5cada0;config=getConfiguration(),io['to'](_0x5669b6(0x2db))['emit'](_0x5669b6(0x18a),config),broadcastToBots('bots',JSON[_0x5669b6(0x310)](config));}function toggleBotMode(_0x42bfa7){const _0x493c55=_0x5cada0;if(pid[_0x42bfa7])pid[_0x42bfa7]['send']({'function':_0x493c55(0x1b5),'args':null});else{const _0x4d336f=configpath+'bot-'+_0x42bfa7+_0x493c55(0x1df),_0x6d7331=fs[_0x493c55(0x28b)](_0x4d336f),_0x3076bb=JSON[_0x493c55(0x1ec)](_0x6d7331),_0x1deeda=_0x3076bb[_0x493c55(0x2f8)][0x0]['headless'];_0x3076bb['bot'][0x0]['headless']=!_0x1deeda;const _0x24cf85=JSON['stringify'](_0x3076bb,null,0x2);fs[_0x493c55(0x26c)](_0x4d336f,_0x24cf85),config=getConfiguration(),io['to'](_0x493c55(0x2db))['emit'](_0x493c55(0x18a),config),broadcastToBots('bots',JSON['stringify'](config));}}function validateTelegram(_0x2dbdd5){const _0xe617bf=_0x5cada0;if(_0x2dbdd5['from'][_0xe617bf(0x201)]!=settings[_0xe617bf(0x22a)]&&'@'+_0x2dbdd5[_0xe617bf(0x29d)]['username']!=settings[_0xe617bf(0x22a)]||_0x2dbdd5[_0xe617bf(0x1c1)]['id']!=settings[_0xe617bf(0x254)])return sendTelegram(_0x2dbdd5[_0xe617bf(0x1c1)]['id'],_0xe617bf(0x24f),{'parse_mode':_0xe617bf(0x180)}),![];return!![];}async function initTelegram(){const _0x45b6fd=_0x5cada0;if(tgBot)tgBot[_0x45b6fd(0x1fd)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x45b6fd(0x242)]);let _0x48f87c=_0x45b6fd(0x27a);_0x48f87c+='\x0a',_0x48f87c+=_0x45b6fd(0x29a),_0x48f87c+=_0x45b6fd(0x1af),_0x48f87c+=_0x45b6fd(0x35a),_0x48f87c+=_0x45b6fd(0x37a),_0x48f87c+='/on\x20-\x20start\x20bot(s)\x0a',_0x48f87c+=_0x45b6fd(0x233),_0x48f87c+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x48f87c+=_0x45b6fd(0x2e3),_0x48f87c+=_0x45b6fd(0x281),_0x48f87c+=_0x45b6fd(0x2cf),_0x48f87c+=_0x45b6fd(0x34b),_0x48f87c+=_0x45b6fd(0x1b8),_0x48f87c+=_0x45b6fd(0x35b),_0x48f87c+=_0x45b6fd(0x268);let _0x123399='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x123399+='\x0a',_0x123399+=_0x48f87c,tgBot['catch']((_0x49df91,_0x3c6023)=>{const _0x2b1b33=_0x45b6fd;logger[_0x2b1b33(0x36a)](getTimeStamp()+_0x2b1b33(0x299)),logger[_0x2b1b33(0x17a)]('Telegraf\x20error:',_0x49df91);}),tgBot[_0x45b6fd(0x349)](async(_0x55aa17,_0x148d07)=>{const _0x93dd7c=_0x45b6fd;if(!(!settings[_0x93dd7c(0x254)]&&_0x55aa17[_0x93dd7c(0x28f)][_0x93dd7c(0x2a6)]['text']==_0x93dd7c(0x265))){if(!validateTelegram(_0x55aa17))return;}_0x148d07();}),tgBot[_0x45b6fd(0x1f6)](_0x45b6fd(0x26f),async _0x5e1c5e=>{const _0x4658f8=_0x45b6fd;if(!settings[_0x4658f8(0x254)])updateSetting(_0x4658f8(0x254),_0x5e1c5e[_0x4658f8(0x1c1)]['id']);updateSetting(_0x4658f8(0x255),!![]);if(!validateTelegram(_0x5e1c5e))return;await sendTelegram(_0x5e1c5e['chat']['id'],_0x123399);}),tgBot[_0x45b6fd(0x1f6)]('enable',async _0x281f83=>{const _0x5633dd=_0x45b6fd;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x281f83[_0x5633dd(0x1c1)]['id'],_0x5633dd(0x2d1));}),tgBot[_0x45b6fd(0x1f6)](_0x45b6fd(0x284),async _0x1cfa42=>{const _0x2dbcd6=_0x45b6fd;await sendTelegram(_0x1cfa42[_0x2dbcd6(0x1c1)]['id'],'Notifications\x20disabled'),updateSetting(_0x2dbcd6(0x255),![]);}),tgBot[_0x45b6fd(0x1f6)](_0x45b6fd(0x2af),async _0x1dd21e=>{const _0x3505d0=_0x45b6fd,_0x27a7e1=Markup[_0x3505d0(0x380)]([Markup[_0x3505d0(0x26b)][_0x3505d0(0x357)]('Orders',_0x3505d0(0x330)),Markup['button'][_0x3505d0(0x357)](_0x3505d0(0x20c),_0x3505d0(0x33e)),Markup[_0x3505d0(0x26b)][_0x3505d0(0x357)](_0x3505d0(0x21a),'config_all')]);_0x1dd21e[_0x3505d0(0x2a4)](_0x3505d0(0x270),_0x27a7e1);}),tgBot[_0x45b6fd(0x20d)](_0x45b6fd(0x330),async _0x40c0ce=>{const _0x5e0060=_0x45b6fd;_0x40c0ce[_0x5e0060(0x18e)](),updateSetting('telegramEvents','orders'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x40c0ce['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot['action'](_0x45b6fd(0x33e),async _0x42c26e=>{const _0x5cfe46=_0x45b6fd;_0x42c26e['editMessageReplyMarkup'](),updateSetting(_0x5cfe46(0x26e),'alerts'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x42c26e[_0x5cfe46(0x1c1)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0x45b6fd(0x20d)](_0x45b6fd(0x32f),async _0xa6209e=>{const _0x47e721=_0x45b6fd;_0xa6209e[_0x47e721(0x18e)](),updateSetting('telegramEvents',_0x47e721(0x2ef)),updateSetting(_0x47e721(0x255),!![]),await sendTelegram(_0xa6209e[_0x47e721(0x1c1)]['id'],_0x47e721(0x18c));}),tgBot['command'](_0x45b6fd(0x2b3),async _0x197a5b=>{const _0x440a9a=_0x45b6fd,_0x208d5d=getBotsWithMode();let _0x5d2a0a=_0x440a9a(0x1a9);config[_0x440a9a(0x2cb)](_0x52a0ec=>{const _0x1f708d=_0x440a9a,_0x3c534e=_0x208d5d['find'](_0x3befdc=>_0x3befdc['botID']==_0x52a0ec[_0x1f708d(0x22d)])[_0x1f708d(0x2df)];_0x5d2a0a+=_0x1f708d(0x279)+_0x52a0ec['botID']+':\x20'+_0x52a0ec[_0x1f708d(0x2b3)]+_0x1f708d(0x1e9)+_0x3c534e+_0x1f708d(0x1e9)+_0x52a0ec['live']+'\x0a';}),_0x5d2a0a+='\x0a',_0x5d2a0a+=_0x440a9a(0x361),_0x5d2a0a+=!settings[_0x440a9a(0x255)]?_0x440a9a(0x18b):_0x440a9a(0x370),_0x5d2a0a+=settings[_0x440a9a(0x255)]?settings[_0x440a9a(0x26e)]==_0x440a9a(0x2ef)?_0x440a9a(0x312):'Notifications\x20types:\x20'+settings['telegramEvents']+'\x20only\x0a':'',await sendTelegram(_0x197a5b[_0x440a9a(0x1c1)]['id'],_0x5d2a0a,{'parse_mode':_0x440a9a(0x180)});}),tgBot['command']('restart',async _0x489ee9=>{const _0x6a59fc=_0x45b6fd,_0x354c9d=getEnabledBots();if(_0x354c9d['length']==0x0)await sendTelegram(_0x489ee9[_0x6a59fc(0x1c1)]['id'],_0x6a59fc(0x1e7));else{if(_0x354c9d['length']>0x1)_0x354c9d[_0x6a59fc(0x237)]({'botID':_0x6a59fc(0x2ef)});let _0x7792a1=[],_0x327afd=[];const _0x5f2d55=_0x354c9d[_0x6a59fc(0x185)]%0x4==0x0||_0x354c9d[_0x6a59fc(0x185)]%0x4==0x3||_0x354c9d[_0x6a59fc(0x185)]%0x3==0x1?0x4:0x3;let _0x57f417=0x0;_0x354c9d[_0x6a59fc(0x2cb)]((_0x37aba9,_0x226e3a)=>{const _0x506fb8=_0x6a59fc;if(_0x226e3a%_0x5f2d55==0x0)_0x327afd=[];_0x327afd['push'](Markup['button'][_0x506fb8(0x357)](_0x37aba9[_0x506fb8(0x22d)]==_0x506fb8(0x2ef)?'All\x20bots':_0x506fb8(0x279)+_0x37aba9['botID'],_0x506fb8(0x33c)+_0x37aba9[_0x506fb8(0x22d)])),_0x226e3a%_0x5f2d55==0x0&&(_0x7792a1[_0x57f417]=_0x327afd,_0x57f417++);});const _0x21bbb5=Markup[_0x6a59fc(0x380)](_0x7792a1);_0x489ee9[_0x6a59fc(0x2a4)](_0x6a59fc(0x28e),_0x21bbb5);}}),tgBot[_0x45b6fd(0x20d)](/restart_(.+)/,async _0x28baca=>{const _0x203a8f=_0x45b6fd,_0x5794ba=_0x28baca[_0x203a8f(0x273)][0x1];_0x28baca[_0x203a8f(0x18e)](),_0x5794ba=='all'?config['forEach'](_0xc45020=>{restartBot(_0xc45020['botID']);}):restartBot(_0x5794ba);}),tgBot['command']('on',async _0x167c04=>{const _0x57f52f=_0x45b6fd,_0x297726=getDisabledBots();if(_0x297726[_0x57f52f(0x185)]==0x0)await sendTelegram(_0x167c04[_0x57f52f(0x1c1)]['id'],_0x57f52f(0x2d9));else{if(_0x297726['length']>0x1)_0x297726['push']({'botID':_0x57f52f(0x2ef)});let _0x4a686a=[],_0x370434=[];const _0x18e43c=_0x297726[_0x57f52f(0x185)]%0x4==0x0||_0x297726[_0x57f52f(0x185)]%0x4==0x3||_0x297726[_0x57f52f(0x185)]%0x3==0x1?0x4:0x3;let _0x1b24d4=0x0;_0x297726['forEach']((_0x4ee5ef,_0x17cc97)=>{const _0x5b730c=_0x57f52f;if(_0x17cc97%_0x18e43c==0x0)_0x370434=[];_0x370434['push'](Markup[_0x5b730c(0x26b)][_0x5b730c(0x357)](_0x4ee5ef[_0x5b730c(0x22d)]==_0x5b730c(0x2ef)?_0x5b730c(0x2ec):_0x5b730c(0x279)+_0x4ee5ef['botID'],_0x5b730c(0x29b)+_0x4ee5ef['botID'])),_0x17cc97%_0x18e43c==0x0&&(_0x4a686a[_0x1b24d4]=_0x370434,_0x1b24d4++);});const _0x30226f=Markup[_0x57f52f(0x380)](_0x4a686a);_0x167c04[_0x57f52f(0x2a4)](_0x57f52f(0x1f0),_0x30226f);}}),tgBot['action'](/on_(.+)/,async _0x54c194=>{const _0x338f25=_0x45b6fd,_0x395e08=_0x54c194['match'][0x1];_0x54c194[_0x338f25(0x18e)]();if(_0x395e08==_0x338f25(0x2ef)){const _0x5dd5b2=getDisabledBots();await sendTelegram(_0x54c194[_0x338f25(0x1c1)]['id'],_0x338f25(0x33b)),_0x5dd5b2[_0x338f25(0x2cb)](_0x5f5143=>{const _0x58b439=_0x338f25;if(_0x5f5143[_0x58b439(0x22d)]!=_0x58b439(0x2ef))toggleBot(_0x5f5143[_0x58b439(0x22d)],toggleStatus(_0x5f5143[_0x58b439(0x22d)]),_0x58b439(0x266));});}else await sendTelegram(_0x54c194[_0x338f25(0x1c1)]['id'],_0x338f25(0x2bc)+_0x395e08),toggleBot(_0x395e08,toggleStatus(_0x395e08),_0x338f25(0x266));}),tgBot['command'](_0x45b6fd(0x19e),async _0x7506e=>{const _0x3e4f6b=_0x45b6fd,_0x5ebd2a=getEnabledBots();if(_0x5ebd2a[_0x3e4f6b(0x185)]==0x0)await sendTelegram(_0x7506e[_0x3e4f6b(0x1c1)]['id'],_0x3e4f6b(0x1e7));else{if(_0x5ebd2a[_0x3e4f6b(0x185)]>0x1)_0x5ebd2a[_0x3e4f6b(0x237)]({'botID':_0x3e4f6b(0x2ef)});let _0x43be86=[],_0x585cc2=[];const _0x223031=_0x5ebd2a['length']%0x4==0x0||_0x5ebd2a['length']%0x4==0x3||_0x5ebd2a[_0x3e4f6b(0x185)]%0x3==0x1?0x4:0x3;let _0x4833a9=0x0;_0x5ebd2a[_0x3e4f6b(0x2cb)]((_0x2ef7ac,_0x56b840)=>{const _0x56d5fd=_0x3e4f6b;if(_0x56b840%_0x223031==0x0)_0x585cc2=[];_0x585cc2[_0x56d5fd(0x237)](Markup[_0x56d5fd(0x26b)][_0x56d5fd(0x357)](_0x2ef7ac['botID']=='all'?_0x56d5fd(0x2ec):_0x56d5fd(0x279)+_0x2ef7ac[_0x56d5fd(0x22d)],_0x56d5fd(0x35d)+_0x2ef7ac[_0x56d5fd(0x22d)])),_0x56b840%_0x223031==0x0&&(_0x43be86[_0x4833a9]=_0x585cc2,_0x4833a9++);});const _0x5ef857=Markup[_0x3e4f6b(0x380)](_0x43be86);_0x7506e[_0x3e4f6b(0x2a4)](_0x3e4f6b(0x1f7),_0x5ef857);}}),tgBot[_0x45b6fd(0x20d)](/off_(.+)/,async _0x55cd45=>{const _0x40e7dd=_0x45b6fd,_0x496fcd=_0x55cd45['match'][0x1];_0x55cd45[_0x40e7dd(0x18e)]();if(_0x496fcd==_0x40e7dd(0x2ef)){const _0x2fcd7e=getEnabledBots();await sendTelegram(_0x55cd45[_0x40e7dd(0x1c1)]['id'],_0x40e7dd(0x2da)),_0x2fcd7e[_0x40e7dd(0x2cb)](_0x1116fb=>{const _0x1bf18d=_0x40e7dd;if(_0x1116fb[_0x1bf18d(0x22d)]!='all')toggleBot(_0x1116fb[_0x1bf18d(0x22d)],toggleStatus(_0x1116fb[_0x1bf18d(0x22d)]),_0x1bf18d(0x266));});}else await sendTelegram(_0x55cd45[_0x40e7dd(0x1c1)]['id'],_0x40e7dd(0x354)+_0x496fcd),toggleBot(_0x496fcd,toggleStatus(_0x496fcd),_0x40e7dd(0x266));}),tgBot[_0x45b6fd(0x1f6)]('metrics',async _0x3be752=>{const _0x5926a6=_0x45b6fd,_0x3476a7=getEnabledBots();if(_0x3476a7['length']==0x0)await sendTelegram(_0x3be752[_0x5926a6(0x1c1)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x3476a7['length']>0x1){let _0x3a4137=[],_0x37124a=[];const _0x574504=_0x3476a7[_0x5926a6(0x185)]%0x4==0x0||_0x3476a7['length']%0x4==0x3||_0x3476a7[_0x5926a6(0x185)]%0x3==0x1?0x4:0x3;let _0xf5433a=0x0;_0x3476a7[_0x5926a6(0x2cb)]((_0x2610d0,_0xb8cd91)=>{const _0x4dc758=_0x5926a6;if(_0xb8cd91%_0x574504==0x0)_0x37124a=[];_0x37124a[_0x4dc758(0x237)](Markup[_0x4dc758(0x26b)]['callback'](_0x4dc758(0x279)+_0x2610d0[_0x4dc758(0x22d)],_0x4dc758(0x2f7)+_0x2610d0[_0x4dc758(0x22d)])),_0xb8cd91%_0x574504==0x0&&(_0x3a4137[_0xf5433a]=_0x37124a,_0xf5433a++);});const _0x51a8ab=Markup[_0x5926a6(0x380)](_0x3a4137);_0x3be752[_0x5926a6(0x2a4)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x51a8ab);}else{const _0x53ab66=_0x3476a7[0x0][_0x5926a6(0x22d)];if(pid[_0x53ab66])pid[_0x53ab66]['send']({'function':_0x5926a6(0x2a2),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x1e084a=>{const _0x435137=_0x45b6fd,_0x1a61a9=_0x1e084a[_0x435137(0x273)][0x1];_0x1e084a[_0x435137(0x18e)]();if(pid[_0x1a61a9])pid[_0x1a61a9][_0x435137(0x335)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x45b6fd(0x1f6)](_0x45b6fd(0x1db),async _0x3b6e17=>{const _0x1d6c79=_0x45b6fd,_0x4e502c=getEnabledBots();if(_0x4e502c[_0x1d6c79(0x185)]==0x0)await sendTelegram(_0x3b6e17['chat']['id'],_0x1d6c79(0x1e7));else{if(_0x4e502c[_0x1d6c79(0x185)]>0x1){let _0x1f7db7=[],_0xf91889=[];const _0x1c5548=_0x4e502c[_0x1d6c79(0x185)]%0x4==0x0||_0x4e502c['length']%0x4==0x3||_0x4e502c['length']%0x3==0x1?0x4:0x3;let _0x2bbe95=0x0;_0x4e502c['forEach']((_0x5ae540,_0x2e5da3)=>{const _0xe6ef41=_0x1d6c79;if(_0x2e5da3%_0x1c5548==0x0)_0xf91889=[];_0xf91889[_0xe6ef41(0x237)](Markup[_0xe6ef41(0x26b)][_0xe6ef41(0x357)](_0xe6ef41(0x279)+_0x5ae540[_0xe6ef41(0x22d)],_0xe6ef41(0x32e)+_0x5ae540[_0xe6ef41(0x22d)])),_0x2e5da3%_0x1c5548==0x0&&(_0x1f7db7[_0x2bbe95]=_0xf91889,_0x2bbe95++);});const _0x347182=Markup['inlineKeyboard'](_0x1f7db7);_0x3b6e17[_0x1d6c79(0x2a4)](_0x1d6c79(0x303),_0x347182);}else{const _0x28c9e6=_0x4e502c[0x0]['botID'];if(pid[_0x28c9e6])pid[_0x28c9e6][_0x1d6c79(0x335)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x45b6fd(0x20d)](/portfolio_(.+)/,async _0x52e6f3=>{const _0x52dcfb=_0x45b6fd,_0xd2914f=_0x52e6f3[_0x52dcfb(0x273)][0x1];_0x52e6f3['editMessageReplyMarkup']();if(pid[_0xd2914f])pid[_0xd2914f][_0x52dcfb(0x335)]({'function':_0x52dcfb(0x235),'args':null});}),tgBot['command'](_0x45b6fd(0x28f),async _0x3c280c=>{const _0x42f0ab=_0x45b6fd;await getMessages();if(!updateAvailable)await sendTelegram(_0x3c280c[_0x42f0ab(0x1c1)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x3c280c['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x183ea3=Markup['inlineKeyboard']([Markup[_0x42f0ab(0x26b)]['callback']('Yes','update_yes'),Markup[_0x42f0ab(0x26b)][_0x42f0ab(0x357)]('No',_0x42f0ab(0x1ad))]);_0x3c280c['reply'](_0x42f0ab(0x2f3),_0x183ea3);}}}),tgBot[_0x45b6fd(0x20d)](/update_(.+)/,async _0x5e1d5f=>{const _0x4cecae=_0x45b6fd,_0x38da55=_0x5e1d5f['match'][0x1];_0x5e1d5f[_0x4cecae(0x18e)](),_0x38da55==_0x4cecae(0x278)&&(await sendTelegram(_0x5e1d5f[_0x4cecae(0x1c1)]['id'],_0x4cecae(0x315)),updateBB(_0x4cecae(0x28f))),_0x38da55=='no'&&await sendTelegram(_0x5e1d5f[_0x4cecae(0x1c1)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot['command'](_0x45b6fd(0x22e),async _0x231ecc=>{const _0x46a89b=_0x45b6fd;if(!validInstallation)await sendTelegram(_0x231ecc[_0x46a89b(0x1c1)]['id'],_0x46a89b(0x17d));else{const _0x1ee336=Markup[_0x46a89b(0x380)]([Markup[_0x46a89b(0x26b)][_0x46a89b(0x357)]('Yes',_0x46a89b(0x2c1)),Markup[_0x46a89b(0x26b)]['callback']('No',_0x46a89b(0x381))]);_0x231ecc[_0x46a89b(0x2a4)](_0x46a89b(0x2b5),_0x1ee336);}}),tgBot[_0x45b6fd(0x20d)](/reinstall_(.+)/,async _0x329350=>{const _0x87b295=_0x45b6fd,_0x4378c4=_0x329350[_0x87b295(0x273)][0x1];_0x329350[_0x87b295(0x18e)](),_0x4378c4==_0x87b295(0x278)&&(await sendTelegram(_0x329350['chat']['id'],_0x87b295(0x228)),updateBB(_0x87b295(0x22e))),_0x4378c4=='no'&&await sendTelegram(_0x329350[_0x87b295(0x1c1)]['id'],_0x87b295(0x31e));}),tgBot[_0x45b6fd(0x1f6)](_0x45b6fd(0x2d7),async _0x138885=>{const _0x3f78b9=_0x45b6fd,_0x4157d0=getBotsWithMode();if(_0x4157d0[_0x3f78b9(0x185)]==0x0)await sendTelegram(_0x138885[_0x3f78b9(0x1c1)]['id'],_0x3f78b9(0x1e7));else{let _0x4557f8=[],_0xa65c88=[];const _0x4d9518=0x2;let _0x5c755b=0x0;_0x4157d0[_0x3f78b9(0x2cb)]((_0x554f6c,_0x4e1c3d)=>{const _0x3cd6ba=_0x3f78b9;if(_0x4e1c3d%_0x4d9518==0x0)_0xa65c88=[];_0xa65c88['push'](Markup[_0x3cd6ba(0x26b)]['callback'](_0x3cd6ba(0x279)+_0x554f6c[_0x3cd6ba(0x22d)]+'\x20('+_0x554f6c['mode']+')',_0x3cd6ba(0x1ea)+_0x554f6c[_0x3cd6ba(0x22d)])),_0x4e1c3d%_0x4d9518==0x0&&(_0x4557f8[_0x5c755b]=_0xa65c88,_0x5c755b++);});const _0x2c805e=Markup[_0x3f78b9(0x380)](_0x4557f8);_0x138885['reply'](_0x3f78b9(0x283),_0x2c805e);}}),tgBot['action'](/toggle_(.+)/,async _0x393bbf=>{const _0x46fefa=_0x45b6fd,_0xb8464f=_0x393bbf['match'][0x1];_0x393bbf['editMessageReplyMarkup']();const _0x225180=getBotsWithMode(),_0x29ef1b=_0x225180[_0x46fefa(0x1b7)](_0x1a5abf=>_0x1a5abf[_0x46fefa(0x22d)]==_0xb8464f),_0x1fb5a9=_0x29ef1b[_0x46fefa(0x2df)]==_0x46fefa(0x199)?_0x46fefa(0x1f2):'auto';await sendTelegram(_0x393bbf[_0x46fefa(0x1c1)]['id'],_0x46fefa(0x1d4)+_0xb8464f+'\x20to\x20'+_0x1fb5a9+_0x46fefa(0x271)),toggleBotMode(_0xb8464f);}),tgBot['command'](_0x45b6fd(0x21d),async _0x426e7c=>{const _0x50d665=_0x45b6fd;let _0x56a8eb='';config[_0x50d665(0x2cb)](_0x36a63e=>{const _0x32e6eb=_0x50d665;_0x56a8eb+=_0x32e6eb(0x279)+_0x36a63e[_0x32e6eb(0x22d)]+':\x20'+_0x36a63e[_0x32e6eb(0x178)]+'\x0a';}),await sendTelegram(_0x426e7c['chat']['id'],_0x56a8eb,{'parse_mode':_0x50d665(0x180)});}),tgBot[_0x45b6fd(0x1f6)](_0x45b6fd(0x30c),async _0x1cbb79=>{await sendTelegram(_0x1cbb79['chat']['id'],_0x48f87c);}),process[_0x45b6fd(0x1f9)](_0x45b6fd(0x2b9),()=>tgBot[_0x45b6fd(0x1fd)](_0x45b6fd(0x2b9))),process['once'](_0x45b6fd(0x369),()=>tgBot[_0x45b6fd(0x1fd)](_0x45b6fd(0x369))),tgBot[_0x45b6fd(0x2b1)]();}}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x3a7fe4,_0x50b362,_0x34da3a){const _0x282df1=_0x5cada0;try{await tgBot[_0x282df1(0x1bb)][_0x282df1(0x188)](_0x3a7fe4,_0x50b362,_0x34da3a);}catch(_0x33e05f){console[_0x282df1(0x23a)](_0x282df1(0x1a2),_0x33e05f);}}async function sendTelegramBot(_0x26b5fa,_0x37ea93){const _0x4be888=_0x5cada0;if(settings[_0x4be888(0x255)]){if(settings[_0x4be888(0x26e)]==_0x4be888(0x2ef)||(_0x37ea93[_0x4be888(0x222)]==_0x4be888(0x17e)||_0x37ea93[_0x4be888(0x222)]=='warning'||_0x37ea93[_0x4be888(0x222)]=='success')&&settings[_0x4be888(0x26e)]==_0x4be888(0x249)||_0x37ea93[_0x4be888(0x222)]==_0x4be888(0x193)&&settings['telegramEvents']==_0x4be888(0x1ac)){if(tgBot&&settings[_0x4be888(0x254)]){if(_0x37ea93['showname'])await sendTelegram(settings[_0x4be888(0x254)],_0x37ea93[_0x4be888(0x178)]+_0x4be888(0x252)+_0x37ea93[_0x4be888(0x296)]);else await sendTelegram(settings[_0x4be888(0x254)],_0x4be888(0x279)+_0x26b5fa+_0x4be888(0x252)+_0x37ea93[_0x4be888(0x296)]);}}}}async function sendTelegramMsg(_0x28a1e7,_0x3e30c1=_0x5cada0(0x180)){const _0x2fe184=_0x5cada0;return settings[_0x2fe184(0x255)]&&tgBot&&settings[_0x2fe184(0x254)]?(await sendTelegram(settings[_0x2fe184(0x254)],_0x28a1e7,{'parse_mode':_0x3e30c1}),!![]):![];}function getDeviceWithIp(_0x52059a){const _0x59d95c=_0x5cada0;return devices[_0x59d95c(0x1b7)](_0x590ee1=>_0x590ee1['ip']===_0x52059a);}async function temporaryAccess2FA(_0x1071ed,_0x329e85){const _0x178845=_0x5cada0;let _0x3b8b8b=new Date(),_0xfe9f9c=![];if(lastIpApproval){if(_0x3b8b8b-lastIpApproval<0x1388)_0xfe9f9c=!![];}lastIpApproval=new Date();if(_0xfe9f9c)return;if(tgBot&&settings[_0x178845(0x254)]){const _0x4067af=uuidRandom();tmpStorage[_0x4067af]={'uuid':_0x1071ed,'externalip':_0x329e85};const _0x4b5be1=Markup['inlineKeyboard']([Markup[_0x178845(0x26b)]['callback'](_0x178845(0x2bd),_0x178845(0x1e8)+_0x4067af),Markup[_0x178845(0x26b)][_0x178845(0x357)](_0x178845(0x2b0),_0x178845(0x2fa)+_0x4067af),Markup[_0x178845(0x26b)][_0x178845(0x357)](_0x178845(0x25b),_0x178845(0x30f)+_0x4067af),Markup[_0x178845(0x26b)][_0x178845(0x357)](_0x178845(0x31d),'tempaccess_reject_'+_0x4067af)]);await sendTelegram(settings[_0x178845(0x254)],_0x178845(0x2ed)+normalizeIP(_0x329e85)[_0x178845(0x36d)]+'\x20?',_0x4b5be1),tgBot[_0x178845(0x20d)](/tempaccess_(.+)_(.+)/,async _0x122b4d=>{const _0x1418d6=_0x178845,_0x55bb4f=_0x122b4d['match'][0x1],_0x304edb=_0x122b4d['match'][0x2],{uuid:_0x74d8c0,externalip:_0x4c0d92}=tmpStorage[_0x304edb];delete tmpStorage[_0x304edb],_0x122b4d[_0x1418d6(0x18e)](),devices[_0x74d8c0]['telegramIpApproval']={'clientip':_0x4c0d92,'timestamp':new Date()[_0x1418d6(0x217)](),'expiry':_0x55bb4f},_0x55bb4f!=_0x1418d6(0x31d)?(await sendTelegram(_0x122b4d[_0x1418d6(0x1c1)]['id'],_0x1418d6(0x253)+_0x55bb4f+_0x1418d6(0x322),{'parse_mode':_0x1418d6(0x180)}),io['to'](_0x74d8c0)[_0x1418d6(0x319)](_0x1418d6(0x2b3),{'access':{'allow':![],'reason':_0x1418d6(0x334),'token':null}})):(await sendTelegram(_0x122b4d[_0x1418d6(0x1c1)]['id'],_0x1418d6(0x27c)),io['to'](_0x74d8c0)[_0x1418d6(0x319)](_0x1418d6(0x2b3),{'access':{'allow':![],'reason':_0x1418d6(0x32d),'token':null}}));});}}async function loginAccess2FA(_0x31f001,_0x576482){const _0x4a9c11=_0x5cada0;if(tgBot&&settings[_0x4a9c11(0x254)]){const _0x2157a8=uuidRandom();tmpStorage[_0x2157a8]={'uuid':_0x31f001,'externalip':_0x576482};const _0x23c24c=Markup['inlineKeyboard']([Markup[_0x4a9c11(0x26b)][_0x4a9c11(0x357)](_0x4a9c11(0x36c),'login2fa_'+loginExpiry+'_'+_0x2157a8),Markup[_0x4a9c11(0x26b)][_0x4a9c11(0x357)](_0x4a9c11(0x31d),_0x4a9c11(0x2c5)+_0x2157a8)]);await sendTelegram(settings[_0x4a9c11(0x254)],_0x4a9c11(0x2e9)+normalizeIP(_0x576482)[_0x4a9c11(0x36d)]+'\x20?',_0x23c24c),tgBot[_0x4a9c11(0x20d)](/login2fa_(.+)_(.+)/,async _0x111402=>{const _0x37dd9a=_0x4a9c11,_0x219893=_0x111402[_0x37dd9a(0x273)][0x1],_0x8ca250=_0x111402[_0x37dd9a(0x273)][0x2],{uuid:_0x54360c,externalip:_0x420c2f}=tmpStorage[_0x8ca250];delete tmpStorage[_0x8ca250],_0x111402[_0x37dd9a(0x18e)](),devices[_0x54360c][_0x37dd9a(0x338)]={'clientip':_0x420c2f,'timestamp':new Date()['getTime'](),'expiry':_0x219893},_0x219893!=_0x37dd9a(0x31d)?(await sendTelegram(_0x111402[_0x37dd9a(0x1c1)]['id'],_0x37dd9a(0x333),{'parse_mode':_0x37dd9a(0x180)}),io['to'](_0x54360c)[_0x37dd9a(0x319)]('status',{'access':{'allow':![],'reason':_0x37dd9a(0x334),'token':null}})):(await sendTelegram(_0x111402['chat']['id'],_0x37dd9a(0x1dc)),io['to'](_0x54360c)[_0x37dd9a(0x319)](_0x37dd9a(0x2b3),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3ba832=_0x5cada0;return dbConfig[_0x3ba832(0x323)](_0x3ba832(0x18a))[_0x3ba832(0x297)](_0x3ba832(0x22d))['filter']({'status':_0x3ba832(0x362)})['value']()||[];}function getDisabledBots(){const _0x307513=_0x5cada0;return dbConfig[_0x307513(0x323)](_0x307513(0x18a))[_0x307513(0x297)](_0x307513(0x22d))[_0x307513(0x1e2)]({'status':_0x307513(0x321)})[_0x307513(0x276)]()||[];}function getBotAttributes(_0x3e2ded){const _0x26da9b=_0x5cada0;let _0x79207d={};const _0x222a9e=configpath+_0x26da9b(0x277)+_0x3e2ded+_0x26da9b(0x1df),_0x3161f5=fs['existsSync'](_0x222a9e);if(_0x3161f5){const _0x28a9f1=fs['readFileSync'](_0x222a9e);try{const _0x5513b7=JSON['parse'](_0x28a9f1),_0xa7a4b=_0x5513b7?_0x5513b7[_0x26da9b(0x2f8)][0x0][_0x26da9b(0x34d)]:![];_0x79207d[_0x26da9b(0x2df)]=_0xa7a4b?_0x26da9b(0x199):_0x26da9b(0x1f2),_0x79207d['botname']=_0x5513b7?_0x5513b7[_0x26da9b(0x2f8)][0x0][_0x26da9b(0x178)]:_0x26da9b(0x279)+_0x3e2ded;}catch(_0x1a3d03){_0x79207d[_0x26da9b(0x2df)]=_0x26da9b(0x1f2),_0x79207d['botname']=_0x26da9b(0x279)+_0x3e2ded;}}else _0x79207d[_0x26da9b(0x2df)]='manual',_0x79207d[_0x26da9b(0x178)]='Bot\x20'+_0x3e2ded;return _0x79207d;}function getBotsWithMode(){const _0x2e88c1=_0x5cada0,_0x349737=dbConfig[_0x2e88c1(0x323)](_0x2e88c1(0x18a))[_0x2e88c1(0x297)](_0x2e88c1(0x22d))[_0x2e88c1(0x276)]()||[];return _0x349737[_0x2e88c1(0x2cb)](_0xb47bfa=>{const _0x31cda1=_0x2e88c1;let _0xc4ddb5=getBotAttributes(_0xb47bfa[_0x31cda1(0x22d)]);_0xb47bfa['mode']=_0xc4ddb5[_0x31cda1(0x2df)];}),_0x349737;}function getBotExchanges(){const _0x3b1475=_0x5cada0;let _0x3ee301=[];const _0x279b2a=dbConfig[_0x3b1475(0x323)](_0x3b1475(0x18a))[_0x3b1475(0x297)]('botID')[_0x3b1475(0x276)]()||[];_0x279b2a[_0x3b1475(0x2cb)](_0x4486c1=>{const _0x50473c=_0x3b1475;if(_0x4486c1['status']==_0x50473c(0x362)){const _0x259df8=configpath+'bot-'+_0x4486c1[_0x50473c(0x22d)]+_0x50473c(0x1df),_0x2f6816=fs['existsSync'](_0x259df8);let _0x3c7e4b;if(_0x2f6816){const _0xfabff9=fs[_0x50473c(0x28b)](_0x259df8);try{const _0x3ae68f=JSON[_0x50473c(0x1ec)](_0xfabff9);_0x3c7e4b=_0x3ae68f?_0x3ae68f[_0x50473c(0x2f8)][0x0][_0x50473c(0x1b1)]:null;}catch(_0x4ffb62){}}if(_0x3c7e4b)_0x3ee301[_0x50473c(0x237)](_0x3c7e4b);}});const _0x30ab5e=[...new Set(_0x3ee301)][_0x3b1475(0x291)]();return _0x30ab5e;}async function initUser(){const _0x230c4f=_0x5cada0;if(!settings[_0x230c4f(0x29c)]){const _0x104c07=uuidRandom();mixpanel[_0x230c4f(0x301)](_0x104c07),updateSetting(_0x230c4f(0x29c),_0x104c07);}}async function initSecure(){const _0x587eaf=_0x5cada0;let _0x519790=getSecure();if(!_0x519790[_0x587eaf(0x2aa)](_0x587eaf(0x367))){let _0x207dbe=await generateKeys();_0x519790['publicKey']=_0x207dbe[_0x587eaf(0x1aa)],_0x519790[_0x587eaf(0x1c5)]=_0x207dbe[_0x587eaf(0x1c5)],_0x519790[_0x587eaf(0x367)]=crypto['randomBytes'](0x20)['toString'](_0x587eaf(0x245));;storeSecure(_0x519790);}}function getSettings(){const _0x4aa723=_0x5cada0;return dbSettings[_0x4aa723(0x323)](_0x4aa723(0x20e))['value']()||{};}function getSecure(){const _0xb1c84d=_0x5cada0;return dbSecure[_0xb1c84d(0x323)]('secure')[_0xb1c84d(0x276)]()||{};}function getBlacklist(){const _0x5a3f8d=_0x5cada0;return dbSecure[_0x5a3f8d(0x323)](_0x5a3f8d(0x34a))['value']()||[];}function broadcastToBots(_0x41331f,_0x3ddbfc){config['forEach'](_0x438594=>{const _0x2e7486=_0x16b2;if(_0x438594[_0x2e7486(0x2b3)]=='enabled'&&_0x438594[_0x2e7486(0x25c)]=='running'||_0x438594[_0x2e7486(0x2b3)]==_0x2e7486(0x22b)&&_0x438594[_0x2e7486(0x25c)]==_0x2e7486(0x1ca)){if(pid[_0x438594[_0x2e7486(0x22d)]])pid[_0x438594[_0x2e7486(0x22d)]][_0x2e7486(0x335)]({[_0x41331f]:_0x3ddbfc});}});}function storeSettings(_0x5c3049,_0x4e3558=![]){const _0x46246b=_0x5cada0;_0x5c3049={...settings,..._0x5c3049};if(_0x4e3558&&_0x5c3049['bbPassword']!=_0x46246b(0x339)&&_0x5c3049['bbPassword']!=_0x46246b(0x336)&&_0x5c3049[_0x46246b(0x329)]!=''){const _0x4bc7ad=crypt[_0x46246b(0x22c)](secure[_0x46246b(0x1c5)],_0x5c3049[_0x46246b(0x329)])[_0x46246b(0x2a6)][_0x46246b(0x2be)]('@')[0x0],_0x4adbf4=bcrypt[_0x46246b(0x2a0)](_0x4bc7ad,saltRounds);_0x5c3049={..._0x5c3049,'bbPassword':_0x4adbf4};}if(_0x4e3558&&_0x5c3049[_0x46246b(0x242)]!='************'&&_0x5c3049['telegramToken']!=_0x46246b(0x336)&&_0x5c3049[_0x46246b(0x242)]!=''){const _0x9afb9=crypt[_0x46246b(0x22c)](secure['privateKey'],_0x5c3049['telegramToken'])[_0x46246b(0x2a6)][_0x46246b(0x2be)]('@')[0x0];_0x5c3049={..._0x5c3049,'telegramToken':_0x9afb9};}const _0x535243=_0x5c3049[_0x46246b(0x242)]!=_0x46246b(0x339)&&_0x5c3049[_0x46246b(0x242)]!=settings[_0x46246b(0x242)]||_0x5c3049[_0x46246b(0x22a)]!=settings[_0x46246b(0x22a)],_0x4d9cf2=_0x5c3049['telegramToken']==''||_0x5c3049[_0x46246b(0x22a)]=='';_0x535243&&(_0x5c3049['telegramChatId']=null,_0x5c3049[_0x46246b(0x26e)]=_0x46246b(0x2ef));for(const [_0x3392c1,_0x1a206e]of Object[_0x46246b(0x2c6)](_0x5c3049)){if(_0x3392c1==_0x46246b(0x242)&&_0x1a206e==_0x46246b(0x339)){_0x5c3049['telegramToken']=settings[_0x46246b(0x242)];continue;};if(_0x3392c1=='bbPassword'&&_0x1a206e==_0x46246b(0x339)){_0x5c3049['bbPassword']=settings[_0x46246b(0x329)];continue;};dbSettings[_0x46246b(0x2ff)]('settings.'+_0x3392c1,_0x1a206e)[_0x46246b(0x1ce)]();}settings=_0x5c3049,io['to'](_0x46246b(0x2db))[_0x46246b(0x319)]('settings',cleanSettings()),broadcastToBots('timeshift',settings[_0x46246b(0x2bb)]),broadcastToBots(_0x46246b(0x1d1),settings[_0x46246b(0x1d1)]);if(_0x535243&&!_0x4d9cf2)initTelegram();if(_0x535243&&_0x4d9cf2)disableTelegram();getAllClients()[_0x46246b(0x2cb)](_0x30937d=>{const _0x361934=_0x46246b;getSocket(_0x30937d['id'])['emit'](_0x361934(0x2b3),{'access':{'allow':![],'reason':_0x361934(0x334),'token':null}});});}function updateSetting(_0x49ae84,_0xf7cf39){const _0x2d55e4=_0x5cada0;dbSettings[_0x2d55e4(0x2ff)](_0x2d55e4(0x358)+_0x49ae84,_0xf7cf39)[_0x2d55e4(0x1ce)](),settings=getSettings(),io['to'](_0x2d55e4(0x2db))[_0x2d55e4(0x319)](_0x2d55e4(0x20e),cleanSettings());}function storeSecure(_0x547128){const _0x129d70=_0x5cada0;dbSecure[_0x129d70(0x323)](_0x129d70(0x23f))['push'](_0x547128)[_0x129d70(0x1ce)](),secure=_0x547128;}function addBlacklist(_0x10de94){const _0x352e8a=_0x5cada0;cleanBlacklist();let _0x167f20;devices[_0x10de94][_0x352e8a(0x1c0)]?_0x167f20=Math[_0x352e8a(0x2b2)](devices[_0x10de94][_0x352e8a(0x1c0)]['expiry'],loginExpiry):_0x167f20=loginExpiry,dbSecure[_0x352e8a(0x323)](_0x352e8a(0x34a))[_0x352e8a(0x237)]({'expiry':new Date()[_0x352e8a(0x217)]()+_0x167f20*0x3c*0x3e8,'token':devices[_0x10de94][_0x352e8a(0x260)][_0x352e8a(0x374)]})[_0x352e8a(0x1ce)](),blacklist=dbSecure[_0x352e8a(0x323)](_0x352e8a(0x34a))[_0x352e8a(0x276)]();}function cleanBlacklist(){const _0x37330b=_0x5cada0;let _0x1b9ddb=dbSecure[_0x37330b(0x323)](_0x37330b(0x34a))[_0x37330b(0x27f)]()['value'](),_0x5e6eb1=new Date()['getTime']();_0x1b9ddb[_0x37330b(0x2cb)](_0x3a3e95=>{const _0xa7122f=_0x37330b;_0x3a3e95['expiry']<_0x5e6eb1&&dbSecure[_0xa7122f(0x323)](_0xa7122f(0x34a))[_0xa7122f(0x28a)]({'expiry':_0x3a3e95[_0xa7122f(0x2b7)]})[_0xa7122f(0x1ce)]();});}function initStates(){const _0x57d011=_0x5cada0;let _0x340e11=getConfiguration();_0x340e11[_0x57d011(0x2cb)](_0x156fac=>{const _0x2fc02b=_0x57d011;_0x156fac[_0x2fc02b(0x25c)]=_0x2fc02b(0x266);}),storeConfiguration(_0x340e11);}function onKeys(){const _0x2bd68b=new RSA();return new Promise(_0x4390c0=>{const _0x56c0b2=_0x16b2;_0x2bd68b[_0x56c0b2(0x272)]()['then'](_0x1bf5e5=>{_0x4390c0(_0x1bf5e5);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2318aa=_0x5cada0;let _0x57986f=getSettings(),_0x598bfc=![];!_0x57986f[_0x2318aa(0x2aa)](_0x2318aa(0x1e0))&&(_0x57986f[_0x2318aa(0x1e0)]=0x0,_0x598bfc=!![]);!_0x57986f[_0x2318aa(0x2aa)](_0x2318aa(0x302))&&(_0x57986f[_0x2318aa(0x302)]=0x0,_0x598bfc=!![]);!_0x57986f[_0x2318aa(0x2aa)](_0x2318aa(0x218))&&(_0x57986f['latestversion']=_0x2318aa(0x2a5),_0x598bfc=!![]);!_0x57986f[_0x2318aa(0x2aa)]('onepagemode')&&(_0x57986f['onepagemode']=![],_0x598bfc=!![]);if(_0x598bfc)storeSettings(_0x57986f);try{fs[_0x2318aa(0x332)](configbackuppath,{'withFileTypes':!![]})[_0x2318aa(0x2cb)](_0x5e67a8=>{const _0x23fd23=_0x2318aa;if(!_0x5e67a8[_0x23fd23(0x308)]()){if(!_0x5e67a8[_0x23fd23(0x32c)][_0x23fd23(0x347)]('backup-full@'))fs[_0x23fd23(0x294)](configbackuppath+_0x5e67a8[_0x23fd23(0x32c)]);}else fs[_0x23fd23(0x182)](configbackuppath+_0x5e67a8['name'],{'recursive':!![]});});}catch(_0x3af90b){logger['debug'](_0x2318aa(0x2e1),_0x3af90b);}}function storeConfiguration(_0x386353){const _0x22ccb7=_0x5cada0;dbConfig[_0x22ccb7(0x323)](_0x22ccb7(0x18a))[_0x22ccb7(0x28a)]()[_0x22ccb7(0x1ce)](),dbConfig['get']('bots')[_0x22ccb7(0x237)](..._0x386353)['write'](),config=_0x386353;}async function resetPassword(){const _0xbccb1d=_0x5cada0;if(tgBot&&settings[_0xbccb1d(0x254)]){const _0xb3ceb4=Markup[_0xbccb1d(0x380)]([Markup[_0xbccb1d(0x26b)][_0xbccb1d(0x357)](_0xbccb1d(0x278),_0xbccb1d(0x267)),Markup[_0xbccb1d(0x26b)][_0xbccb1d(0x357)]('no','resetpw_no')]);await sendTelegram(settings[_0xbccb1d(0x254)],_0xbccb1d(0x285),_0xb3ceb4),tgBot[_0xbccb1d(0x20d)](/resetpw_(.+)/,async _0x417899=>{const _0x3add78=_0xbccb1d,_0x1ab926=_0x417899[_0x3add78(0x273)][0x1];_0x417899[_0x3add78(0x18e)]();if(_0x1ab926!='no'){const _0x3ad768=0xf,_0x4e2f26=_0x3add78(0x1a1),_0xd3be1=Array['from'](crypto[_0x3add78(0x1d0)](new Uint32Array(_0x3ad768)))[_0x3add78(0x1d6)](_0x4d9034=>_0x4e2f26[_0x4d9034%_0x4e2f26['length']])[_0x3add78(0x274)](''),_0x1794f8=bcrypt[_0x3add78(0x2a0)](_0xd3be1,saltRounds);storeSettings({'bbPassword':_0x1794f8}),await sendTelegram(_0x417899['chat']['id'],_0x3add78(0x371)+_0xd3be1,{'parse_mode':'HTML'});}else await sendTelegram(_0x417899[_0x3add78(0x1c1)]['id'],_0x3add78(0x1bc));});}}async function confirmRestore(_0x59b6ec,_0x4f0215){const _0x430994=_0x5cada0;io['to'](_0x430994(0x2db))[_0x430994(0x319)](_0x430994(0x208),_0x430994(0x21f),_0x430994(0x2c7));if(tgBot&&settings[_0x430994(0x254)]){const _0x4c1f5a=uuidRandom();tmpStorage[_0x4c1f5a]={'path':_0x59b6ec,'filename':_0x4f0215};const _0x2eb677=Markup['inlineKeyboard']([Markup[_0x430994(0x26b)][_0x430994(0x357)](_0x430994(0x278),_0x430994(0x1a0)+_0x4c1f5a),Markup[_0x430994(0x26b)][_0x430994(0x357)]('no',_0x430994(0x1b3)+_0x4c1f5a)]);await sendTelegram(settings[_0x430994(0x254)],_0x430994(0x282),_0x2eb677),tgBot[_0x430994(0x20d)](/restore_(.+)_(.+)/,async _0x1fb87a=>{const _0x8635f5=_0x430994,_0x36185c=_0x1fb87a['match'][0x1],_0x4a542a=_0x1fb87a['match'][0x2],{path:_0x49dde4,filename:_0x1e24ec}=tmpStorage[_0x4a542a];delete tmpStorage[_0x4a542a],_0x1fb87a['editMessageReplyMarkup'](),_0x36185c=='yes'?(logger[_0x8635f5(0x17a)](_0x8635f5(0x1e1)),await sendTelegram(_0x1fb87a[_0x8635f5(0x1c1)]['id'],_0x8635f5(0x318),{'parse_mode':_0x8635f5(0x180)}),unzipFile(_0x49dde4,_0x1e24ec)):(logger['debug'](_0x8635f5(0x1cb)),await sendTelegram(_0x1fb87a[_0x8635f5(0x1c1)]['id'],_0x8635f5(0x1cb)));});}}function getServerTime(){const _0x3b8950=_0x5cada0,_0xdb9c9b=new Date();return _0xdb9c9b[_0x3b8950(0x313)]()+'/'+(_0xdb9c9b[_0x3b8950(0x223)]()+0x1)[_0x3b8950(0x1a6)]()[_0x3b8950(0x18f)](0x2,'0')+'/'+_0xdb9c9b['getDate']()[_0x3b8950(0x1a6)]()[_0x3b8950(0x18f)](0x2,'0')+'\x20'+_0xdb9c9b[_0x3b8950(0x2ce)]()[_0x3b8950(0x1a6)]()[_0x3b8950(0x18f)](0x2,'0')+':'+_0xdb9c9b[_0x3b8950(0x345)]()['toString']()['padStart'](0x2,'0')+':'+_0xdb9c9b[_0x3b8950(0x360)]()['toString']()[_0x3b8950(0x18f)](0x2,'0');}function getTimeStamp(){const _0x408409=_0x5cada0,_0x344b9d=shiftedTime();return _0x344b9d['getFullYear']()+'/'+(_0x344b9d[_0x408409(0x223)]()+0x1)[_0x408409(0x1a6)]()[_0x408409(0x18f)](0x2,'0')+'/'+_0x344b9d['getDate']()[_0x408409(0x1a6)]()[_0x408409(0x18f)](0x2,'0')+'\x20'+_0x344b9d[_0x408409(0x2ce)]()[_0x408409(0x1a6)]()[_0x408409(0x18f)](0x2,'0')+':'+_0x344b9d[_0x408409(0x345)]()[_0x408409(0x1a6)]()[_0x408409(0x18f)](0x2,'0')+':'+_0x344b9d['getSeconds']()[_0x408409(0x1a6)]()[_0x408409(0x18f)](0x2,'0');}function getCleanTimeStamp(){const _0x464399=_0x5cada0,_0x1d4876=shiftedTime();return _0x1d4876['getFullYear']()+(_0x1d4876[_0x464399(0x223)]()+0x1)['toString']()[_0x464399(0x18f)](0x2,'0')+_0x1d4876[_0x464399(0x1ef)]()['toString']()[_0x464399(0x18f)](0x2,'0')+'-'+_0x1d4876[_0x464399(0x2ce)]()['toString']()[_0x464399(0x18f)](0x2,'0')+_0x1d4876[_0x464399(0x345)]()[_0x464399(0x1a6)]()[_0x464399(0x18f)](0x2,'0')+_0x1d4876[_0x464399(0x360)]()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0x1f1c4c=_0x5cada0,_0x127361=new Date();let _0x3515eb=_0x127361;if(settings[_0x1f1c4c(0x2bb)]&&settings[_0x1f1c4c(0x2bb)]!==0x0)_0x3515eb=fns[_0x1f1c4c(0x2ab)](_0x127361,{'hours':settings['timeshift']});return _0x3515eb;}function startScheduler(){const _0x976a2f=_0x5cada0,_0x29c683=new Date()[_0x976a2f(0x37d)](),_0x698065=shiftedTime()[_0x976a2f(0x2ce)]();_0x698065==0x4&&backupConfigFiles();_0x698065==0x0&&rotateLogFiles();_0x29c683%0x6==0x0&&triggerAnalytics();_0x29c683%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x5ea962){const _0x433cbc=_0x5cada0;logger[_0x433cbc(0x17a)](_0x433cbc(0x34f)+_0x5ea962);const _0x3bfafc=getBotsWithMode();_0x3bfafc['length']>0x0?confirmRestore(configbackuppath,_0x5ea962):unzipFile(configbackuppath,_0x5ea962);}async function getBackupFiles(_0x456e52=null){const _0x2a2369=_0x5cada0;let _0xfd2595=[],_0x2e99c2=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x2e99c2[_0x2a2369(0x291)]((_0x2b700d,_0x1d5e09)=>_0x2b700d[_0x2a2369(0x32c)]<_0x1d5e09[_0x2a2369(0x32c)]?0x1:_0x1d5e09['name']<_0x2b700d[_0x2a2369(0x32c)]?-0x1:0x0),_0x2e99c2['forEach'](_0x3e800f=>{const _0x20bd3d=_0x2a2369;if(!_0x3e800f['isDirectory']()&&_0x3e800f[_0x20bd3d(0x32c)][_0x20bd3d(0x347)](_0x20bd3d(0x37e))&&_0x3e800f['name'][_0x20bd3d(0x256)](_0x20bd3d(0x2c3))){const _0x5479cc=formatDate(fs[_0x20bd3d(0x225)](configbackuppath+_0x3e800f[_0x20bd3d(0x32c)])['mtime']);_0xfd2595[_0x20bd3d(0x237)]({'name':_0x3e800f[_0x20bd3d(0x32c)],'mtime':_0x5479cc});}});if(_0x456e52)io['to'](_0x456e52)[_0x2a2369(0x319)](_0x2a2369(0x320),_0xfd2595);else return _0xfd2595;}async function backupConfigFiles(){const _0x519c18=_0x5cada0;await zipFiles('backup-full');const _0x15c4d3=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x519c18(0x353),configbackuppath+('backup-full@'+_0x15c4d3+_0x519c18(0x2c3)));let _0x5f0f1e=fs[_0x519c18(0x332)](configbackuppath,{'withFileTypes':!![]});_0x5f0f1e[_0x519c18(0x291)]((_0x421171,_0x36946e)=>_0x421171[_0x519c18(0x32c)]<_0x36946e['name']?0x1:_0x36946e[_0x519c18(0x32c)]<_0x421171[_0x519c18(0x32c)]?-0x1:0x0),_0x5f0f1e[_0x519c18(0x185)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x5f0f1e[_0x5f0f1e[_0x519c18(0x185)]-0x1][_0x519c18(0x32c)]);}function rotateLogFiles(){const _0x33e64c=_0x5cada0,_0x5eb2f8=fs[_0x33e64c(0x225)](logspath+_0x33e64c(0x2fe)),_0x2d7911=_0x5eb2f8[_0x33e64c(0x350)]/0x400;if(_0x2d7911>0x64){let _0x2cc9ce=fs[_0x33e64c(0x332)](logspath,{'withFileTypes':!![]});_0x2cc9ce[_0x33e64c(0x291)]((_0x1336cd,_0x2cae37)=>_0x1336cd[_0x33e64c(0x32c)]<_0x2cae37[_0x33e64c(0x32c)]?0x1:_0x2cae37[_0x33e64c(0x32c)]<_0x1336cd[_0x33e64c(0x32c)]?-0x1:0x0),_0x2cc9ce['forEach'](_0x12ffaa=>{const _0x1d63a7=_0x33e64c;if(_0x12ffaa[_0x1d63a7(0x32c)]=='output-002.log')fs['copyFileSync'](logspath+_0x12ffaa['name'],logspath+_0x1d63a7(0x1b2));if(_0x12ffaa[_0x1d63a7(0x32c)]==_0x1d63a7(0x363))fs[_0x1d63a7(0x1f8)](logspath+_0x12ffaa[_0x1d63a7(0x32c)],logspath+_0x1d63a7(0x219));_0x12ffaa[_0x1d63a7(0x32c)]==_0x1d63a7(0x2fe)&&(fs[_0x1d63a7(0x1f8)](logspath+_0x12ffaa[_0x1d63a7(0x32c)],logspath+_0x1d63a7(0x363)),fs['writeFileSync'](logspath+_0x12ffaa[_0x1d63a7(0x32c)],''));});}}async function zipFiles(_0x328690){const _0x2fdf41=_0x5cada0;let _0x1a15cf;if(_0x328690==_0x2fdf41(0x35c))_0x1a15cf=logspath;if(_0x328690==_0x2fdf41(0x24a))_0x1a15cf=configpath;if(_0x328690==_0x2fdf41(0x20b))_0x1a15cf=configpath;let _0x4625a1=fs[_0x2fdf41(0x332)](_0x1a15cf,{'withFileTypes':!![]});const _0x21dc9d=new require('node-zip')();_0x4625a1[_0x2fdf41(0x2cb)](_0x2d6b67=>{const _0x5eced4=_0x2fdf41;if(!_0x2d6b67[_0x5eced4(0x308)]()){let _0x4d42c4=fs[_0x5eced4(0x28b)](_0x1a15cf+_0x2d6b67[_0x5eced4(0x32c)]);if(_0x328690==_0x5eced4(0x24a)){const _0x157f1b=/^bot-[0-9]{3}-config.json$/,_0xfb9b87=_0x157f1b[_0x5eced4(0x1a3)](_0x2d6b67['name']);if(_0xfb9b87){const _0x41aff4=JSON[_0x5eced4(0x1ec)](_0x4d42c4);if(_0x41aff4['bot'][0x0]){_0x41aff4[_0x5eced4(0x2f8)][0x0][_0x5eced4(0x32b)]=_0x5eced4(0x336),_0x41aff4[_0x5eced4(0x2f8)][0x0][_0x5eced4(0x189)]=_0x5eced4(0x336);if(_0x41aff4[_0x5eced4(0x2f8)][0x0][_0x5eced4(0x2a3)])_0x41aff4[_0x5eced4(0x2f8)][0x0][_0x5eced4(0x2a3)]='***';}_0x4d42c4=JSON[_0x5eced4(0x310)](_0x41aff4,null,0x2);}if(_0x2d6b67[_0x5eced4(0x32c)]==_0x5eced4(0x2d6)){const _0x36a545=JSON[_0x5eced4(0x1ec)](_0x4d42c4);if(_0x36a545[_0x5eced4(0x20e)][_0x5eced4(0x244)])_0x36a545['settings'][_0x5eced4(0x244)]=![];if(_0x36a545[_0x5eced4(0x20e)]['bbPassword'])_0x36a545[_0x5eced4(0x20e)][_0x5eced4(0x329)]='***';if(_0x36a545[_0x5eced4(0x20e)][_0x5eced4(0x242)])_0x36a545['settings'][_0x5eced4(0x242)]=_0x5eced4(0x336);if(_0x36a545[_0x5eced4(0x20e)][_0x5eced4(0x254)])_0x36a545[_0x5eced4(0x20e)]['telegramChatId']=null;_0x4d42c4=JSON[_0x5eced4(0x310)](_0x36a545,null,0x2);}if(_0x2d6b67[_0x5eced4(0x32c)]!='bb-secure.json')_0x21dc9d[_0x5eced4(0x35e)](_0x2d6b67[_0x5eced4(0x32c)],_0x4d42c4);}else _0x21dc9d[_0x5eced4(0x35e)](_0x2d6b67[_0x5eced4(0x32c)],_0x4d42c4);}});const _0x3550e8=_0x21dc9d['generate']({'base64':![],'compression':_0x2fdf41(0x36b)});fs['writeFileSync'](zippath+(_0x328690+_0x2fdf41(0x2c3)),_0x3550e8,'binary');}async function unzipFile(_0x184b92,_0x22872c){const _0x467ab6=_0x5cada0;fs[_0x467ab6(0x332)](configpath,{'withFileTypes':!![]})[_0x467ab6(0x2cb)](_0x26be56=>{const _0x3ef773=_0x467ab6;if(!_0x26be56[_0x3ef773(0x308)]())fs[_0x3ef773(0x182)](configpath+_0x26be56[_0x3ef773(0x32c)]);});const _0x36376e=fs[_0x467ab6(0x28b)](_0x184b92+_0x22872c,_0x467ab6(0x227)),_0x3e8226=new require(_0x467ab6(0x2d3))(_0x36376e,{'base64':![],'checkCRC32':!![]});Object[_0x467ab6(0x224)](_0x3e8226[_0x467ab6(0x304)])['forEach'](_0xeb1964=>{const _0x2ab6b1=_0x467ab6,_0xd90103=_0x3e8226[_0x2ab6b1(0x304)][_0xeb1964];fs[_0x2ab6b1(0x26c)](configpath+_0xd90103[_0x2ab6b1(0x32c)],_0xd90103[_0x2ab6b1(0x1fb)]);}),fs[_0x467ab6(0x332)](temppath,{'withFileTypes':!![]})['forEach'](_0x380f8e=>{if(!_0x380f8e['isDirectory']())fs['rmSync'](temppath+_0x380f8e['name']);}),logger[_0x467ab6(0x17a)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x467ab6(0x335)]({'restore':!![]},_0x10187d=>{});}async function getPublicIp(){const _0x1e83a8=_0x5cada0;try{const _0x3218c6=await axios[_0x1e83a8(0x323)](_0x1e83a8(0x364));publicip=_0x3218c6[_0x1e83a8(0x211)]['ip'];}catch(_0x54bbe2){}}async function triggerAnalytics(){const _0x1f0b65=_0x5cada0;if(!publicip)await getPublicIp();const _0x44b69f=getBotsWithMode();let _0x5a9e86=0x0;_0x44b69f[_0x1f0b65(0x2cb)](_0x37b19b=>{const _0x4b8359=_0x1f0b65;if(_0x37b19b[_0x4b8359(0x2b3)]===_0x4b8359(0x362))_0x5a9e86++;});const _0x37b394=getBotExchanges();mixpanel[_0x1f0b65(0x27e)](_0x1f0b65(0x368),{'distinct_id':settings[_0x1f0b65(0x29c)],'ip':publicip,'version':serverversion,'numbots':_0x44b69f[_0x1f0b65(0x185)],'numbotsenabled':_0x5a9e86,'exchanges':_0x37b394,'environment':environment});}async function getMessages(){const _0x56c422=_0x5cada0,_0x53101f=_0x56c422(0x1e4),_0x2e6491=new GraphQLClient(_0x53101f),_0x5453f6={'authorization':_0x56c422(0x2e6)},_0x157f24=serverversion[_0x56c422(0x2be)]('.'),_0x48317e=_0x157f24[0x0]+'.'+_0x157f24[0x1],_0x3bb3de=Math['min'](settings['lastmsgtelegram'],settings[_0x56c422(0x302)]),_0x626ab2={'last':parseInt(_0x3bb3de),'bbm':_0x48317e},_0x45f2d2=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0xa53c46;try{_0xa53c46=await _0x2e6491['request'](_0x45f2d2,_0x626ab2,_0x5453f6);}catch(_0x1a28d7){}if(_0xa53c46&&_0xa53c46['messages']){let _0x205aa1=settings['lastmsgtelegram'];newMessages=[];for(const _0x196bb1 of _0xa53c46[_0x56c422(0x264)]){newMessages['push'](_0x196bb1);let _0x14c35b=![];_0x196bb1[_0x56c422(0x248)]&&(updateSetting(_0x56c422(0x218),_0x196bb1[_0x56c422(0x248)]),_0x14c35b=isNewerVersion(serverversion,_0x196bb1[_0x56c422(0x248)])||serverversion==_0x196bb1[_0x56c422(0x248)]);if(!_0x14c35b&&_0x196bb1[_0x56c422(0x1a7)]>_0x205aa1){if(_0x196bb1['bbvReceive']===_0x56c422(0x241)||serverversion['startsWith'](_0x196bb1[_0x56c422(0x1eb)])){let _0x5c84be=''+_0x196bb1[_0x56c422(0x1b9)]+'\x0a\x0a'+_0x196bb1['message'];const _0x527757=await sendTelegramMsg(toTelegramMarkdown(_0x5c84be),_0x56c422(0x2c4));if(_0x527757)_0x205aa1=_0x196bb1[_0x56c422(0x1a7)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x56c422(0x1e0),_0x205aa1),emitMessages();}}function emitMessages(){const _0x243f82=_0x5cada0,_0x2f05ae=settings[_0x243f82(0x302)];let _0x1a8fa2=[];newMessages[_0x243f82(0x2cb)](_0xe7323d=>{const _0x32b7b2=_0x243f82;_0xe7323d[_0x32b7b2(0x1a7)]>_0x2f05ae&&_0x1a8fa2[_0x32b7b2(0x237)](_0xe7323d);}),_0x1a8fa2['length']>0x0&&getAllClients()[_0x243f82(0x2cb)](_0x55eeea=>{const _0x6e91df=_0x243f82;getSocket(_0x55eeea['id'])[_0x6e91df(0x319)](_0x6e91df(0x2a6),_0x1a8fa2);});}function confirmMessage(_0xbdd3c7){const _0x187ef0=_0x5cada0;updateSetting(_0x187ef0(0x302),Number(_0xbdd3c7));}function isNewerVersion(_0x3b30f9,_0x5d6d1c){const _0x379947=_0x5cada0,_0x5dd182=_0x5d6d1c[_0x379947(0x2be)]('.'),_0x339dfb=_0x3b30f9['split']('.');for(var _0x39ea1f=0x0;_0x39ea1f<_0x339dfb[_0x379947(0x185)];_0x39ea1f++){const _0x63f995=~~_0x339dfb[_0x39ea1f],_0x55b645=~~_0x5dd182[_0x39ea1f];if(_0x63f995>_0x55b645)return!![];if(_0x63f995<_0x55b645)return![];}return![];}function toTelegramMarkdown(_0x3bf896){const _0x5230c6=_0x5cada0,_0x236d0f=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0xfcf9c0=/\*{2}(.+?)\*{2}/gim;return _0x3bf896=_0x3bf896[_0x5230c6(0x1c2)](_0x236d0f,_0x5230c6(0x184))[_0x5230c6(0x1c2)](_0xfcf9c0,'*$1*'),_0x3bf896;}async function validateConfigFile(){const _0x1e5001=_0x5cada0,_0x5054d2=dbConfig['get'](_0x1e5001(0x18a))[_0x1e5001(0x297)](_0x1e5001(0x22d))[_0x1e5001(0x276)]()||[];if(_0x5054d2[_0x1e5001(0x185)]==0x0){let _0xd12e92=0x0,_0x210ee3=[];const _0x4f3380=/^bot-([0-9]{3})-config.json$/,_0x9c777=fs[_0x1e5001(0x332)](configpath);_0x9c777[_0x1e5001(0x2cb)](_0x2e92b0=>{const _0x59c0ad=_0x1e5001,_0x26244e=_0x4f3380['exec'](_0x2e92b0);if(_0x26244e){const _0x5bffb6=_0x26244e[0x1];let _0x44d73e=getBotAttributes(_0x5bffb6);_0x210ee3[_0x59c0ad(0x237)]({'botID':_0x5bffb6,'botname':_0x44d73e[_0x59c0ad(0x178)],'status':_0x59c0ad(0x321),'live':_0x59c0ad(0x266)}),_0xd12e92++;}}),_0xd12e92!=0x0&&(dbConfig[_0x1e5001(0x323)](_0x1e5001(0x18a))[_0x1e5001(0x1a5)](_0x210ee3)[_0x1e5001(0x1ce)](),config=_0x210ee3,restoredConfigFile=_0xd12e92);}}async function restoreConfigNotify(_0x366fdd){const _0x570bb8=_0x5cada0;let _0x566e8b;if(restoredConfigFile==0x1)_0x566e8b=_0x570bb8(0x1f5);else _0x566e8b=_0x570bb8(0x1d7);if(_0x366fdd)io['to'](_0x570bb8(0x2db))[_0x570bb8(0x319)]('notification',_0x566e8b);else{logger[_0x570bb8(0x36a)]('-----------------------------------------------------------------------------------'),logger[_0x570bb8(0x36a)](_0x566e8b),logger[_0x570bb8(0x36a)](_0x570bb8(0x207)),logger[_0x570bb8(0x36a)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x570bb8(0x26e)]!='orders')await sendTelegram(settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x566e8b);}}function validateCredentials(_0xf7c652,_0x31a7a0){const _0x2de12a=_0x5cada0;if(_0xf7c652[_0x2de12a(0x201)]==settings[_0x2de12a(0x243)]&&bcrypt[_0x2de12a(0x1d9)](_0xf7c652[_0x2de12a(0x1c8)],settings[_0x2de12a(0x329)])){if(settings[_0x2de12a(0x1bf)])return{'allow':![],'reason':_0x2de12a(0x23b),'token':null};else{const _0x4861f1=generateLoginToken(_0x31a7a0);return{'allow':!![],'reason':_0x2de12a(0x24d),'token':_0x4861f1};}}else return{'allow':![],'reason':_0x2de12a(0x346),'token':null};}function refreshToken(_0x3a6372){const _0x5279bd=_0x5cada0,_0x1c72a7=generateLoginToken(_0x3a6372);return{'allow':!![],'reason':_0x5279bd(0x24d),'token':_0x1c72a7};}function validateAccess(_0x46bc8b,_0x2ee442,_0x5156ce){const _0x27275c=_0x5cada0,_0x564131=_0x5156ce?_0x5156ce:devices[_0x2ee442]['ip'];let _0x24a785;const _0x147019=_0x401ca7=>{const _0x4d3add=_0x16b2;if(settings[_0x4d3add(0x244)]){if(settings[_0x4d3add(0x1bf)]){if(telegram2FaApproved(_0x2ee442)){const _0x2ea9c3=generateLoginToken(_0x2ee442);return{'allow':!![],'reason':_0x4d3add(0x2d0),'token':_0x2ea9c3};}else return{'allow':![],'reason':_0x4d3add(0x287),'token':null};}else return _0x24a785=validToken(_0x401ca7,_0x2ee442),_0x24a785[_0x4d3add(0x2aa)](_0x4d3add(0x2c7))?{'allow':!![],'reason':_0x4d3add(0x216),'token':_0x401ca7}:{'allow':![],'reason':_0x4d3add(0x287),'token':null};}else return{'allow':!![],'reason':_0x4d3add(0x26a),'token':null};};if(settings['whitelistEnabled']){let _0x1dae74=[...settings[_0x27275c(0x27b)],_0x27275c(0x1ff),_0x27275c(0x24b),_0x27275c(0x372)];if(_0x1dae74[_0x27275c(0x2e0)](_0x564131))return _0x147019(_0x46bc8b);else{_0x24a785=validToken(_0x46bc8b,_0x2ee442);if(_0x24a785[_0x27275c(0x2aa)](_0x27275c(0x2c7)))return _0x147019(_0x46bc8b);else{if(telegramIpApproved(_0x2ee442)){const _0x5b898c=generateToken(_0x2ee442);return _0x24a785=_0x147019(_0x46bc8b),_0x24a785[_0x27275c(0x215)]?{'allow':!![],'reason':_0x27275c(0x29f),'token':_0x5b898c}:_0x24a785;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x27275c(0x200),'token':null}:{'allow':![],'reason':_0x27275c(0x2f0),'token':null};}}}else return _0x147019(_0x46bc8b);}function timelyDecrypt(_0x37bf2e,_0x5c8404=!![]){const _0x56367c=_0x5cada0;if(_0x37bf2e)try{const _0xda5fa0=crypt[_0x56367c(0x22c)](secure[_0x56367c(0x1c5)],_0x37bf2e)['message'],_0x3d80e4=_0xda5fa0[_0x56367c(0x2be)]('@')[0x0],_0x1b7144=_0xda5fa0[_0x56367c(0x2be)]('@')[0x1],_0x1c741b=new Date()[_0x56367c(0x217)]();if(_0x5c8404){if(_0x1c741b-_0x1b7144<maxSecretAge*0x3e8)return _0x3d80e4;else return![];}else return _0x3d80e4;}catch(_0x44a423){return![];}else return![];}const validToken=(_0x1fd715,_0x341fa6)=>{const _0xa0237c=_0x5cada0,_0xb5ed0e=devices[_0x341fa6]['ip'];if(!_0x1fd715)return{'error':_0xa0237c(0x31f)};for(let _0x361984 of blacklist){if(_0x361984['token']==_0x1fd715)return{'error':_0xa0237c(0x305)};}let _0x391d4c;try{_0x391d4c=jwt[_0xa0237c(0x35f)](_0x1fd715,secure[_0xa0237c(0x367)]+_0x341fa6);}catch{return{'error':_0xa0237c(0x1d5)};}if(!_0x391d4c[_0xa0237c(0x2aa)]('clientip')&&!_0x391d4c[_0xa0237c(0x2aa)](_0xa0237c(0x201))||!_0x391d4c['hasOwnProperty']('exp'))return{'error':_0xa0237c(0x1bd)};if(!_0x391d4c[_0xa0237c(0x2aa)](_0xa0237c(0x201))&&_0x391d4c['hasOwnProperty'](_0xa0237c(0x205))){const {clientip:_0x4cb02a}=_0x391d4c;return _0xb5ed0e==_0x4cb02a?{'success':_0xa0237c(0x25d)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x391d4c[_0xa0237c(0x2aa)](_0xa0237c(0x201))&&_0x391d4c['hasOwnProperty'](_0xa0237c(0x205))){const {username:_0x59b53f,clientip:_0x501c4c}=_0x391d4c;return settings[_0xa0237c(0x243)]==_0x59b53f&&_0xb5ed0e==_0x501c4c?{'success':_0xa0237c(0x25d)}:{'error':_0xa0237c(0x30b)};}}},generateLoginToken=_0x26baaf=>{const _0x59d868=_0x5cada0;if(_0x26baaf){const _0x1c1ff1=devices[_0x26baaf]['ip'];return jwt[_0x59d868(0x2ae)]({'username':settings[_0x59d868(0x243)],'clientip':_0x1c1ff1},secure[_0x59d868(0x367)]+_0x26baaf,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x41d883=>{const _0x4124f6=_0x5cada0;if(_0x41d883){const _0x8b348c=devices[_0x41d883]['ip'];return jwt[_0x4124f6(0x2ae)]({'clientip':_0x8b348c},secure[_0x4124f6(0x367)]+_0x41d883,{'expiresIn':devices[_0x41d883]['telegramIpApproval'][_0x4124f6(0x2b7)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x53261b=>{const _0x3fa815=_0x5cada0;let _0x474134=![];return devices[_0x53261b][_0x3fa815(0x1c0)]&&devices[_0x53261b][_0x3fa815(0x1c0)][_0x3fa815(0x2b7)]!='reject'&&(_0x474134=devices[_0x53261b][_0x3fa815(0x1c0)][_0x3fa815(0x205)]==devices[_0x53261b]['ip']&&new Date()['getTime']()-devices[_0x53261b][_0x3fa815(0x1c0)][_0x3fa815(0x1a4)]<devices[_0x53261b]['telegramIpApproval'][_0x3fa815(0x2b7)]*0x3c*0x3e8),_0x474134;},telegram2FaApproved=_0x212826=>{const _0x155d53=_0x5cada0;let _0xf28e8=![];return devices[_0x212826][_0x155d53(0x338)]&&devices[_0x212826][_0x155d53(0x338)][_0x155d53(0x2b7)]!=_0x155d53(0x31d)&&(_0xf28e8=devices[_0x212826][_0x155d53(0x338)]['clientip']==devices[_0x212826]['ip']&&new Date()[_0x155d53(0x217)]()-devices[_0x212826][_0x155d53(0x338)][_0x155d53(0x1a4)]<devices[_0x212826][_0x155d53(0x338)][_0x155d53(0x2b7)]*0x3c*0x3e8),_0xf28e8;},normalizeIP=_0x532f7a=>{const _0x194cd1=_0x5cada0;let _0x3aa2f5=null,_0x166558=null;if(ipaddr[_0x194cd1(0x324)](_0x532f7a)){const _0x3210fb=ipaddr[_0x194cd1(0x1ec)](_0x532f7a);_0x3210fb[_0x194cd1(0x2ad)]()===_0x194cd1(0x341)?(_0x3210fb[_0x194cd1(0x21e)]()&&(_0x3aa2f5=_0x3210fb[_0x194cd1(0x376)]()[_0x194cd1(0x1a6)]()),_0x166558=_0x3210fb[_0x194cd1(0x1a6)]()):(_0x3aa2f5=_0x3210fb[_0x194cd1(0x1a6)](),_0x166558=_0x3210fb[_0x194cd1(0x1d2)]()[_0x194cd1(0x1a6)]());}return{'show':_0x3aa2f5?_0x3aa2f5:_0x166558,'store':_0x166558};};function formatDate(_0x1f45f1){const _0x3d0a09=_0x5cada0;return _0x1f45f1[_0x3d0a09(0x313)]()+'/'+(_0x1f45f1[_0x3d0a09(0x223)]()+0x1)['toString']()[_0x3d0a09(0x18f)](0x2,'0')+'/'+_0x1f45f1[_0x3d0a09(0x1ef)]()[_0x3d0a09(0x1a6)]()[_0x3d0a09(0x18f)](0x2,'0')+'\x20'+_0x1f45f1[_0x3d0a09(0x2ce)]()[_0x3d0a09(0x1a6)]()['padStart'](0x2,'0')+':'+_0x1f45f1[_0x3d0a09(0x345)]()[_0x3d0a09(0x1a6)]()[_0x3d0a09(0x18f)](0x2,'0')+':'+_0x1f45f1[_0x3d0a09(0x360)]()[_0x3d0a09(0x1a6)]()[_0x3d0a09(0x18f)](0x2,'0');}function sleep(_0x2e0e26){return new Promise(_0x1a3e01=>setTimeout(_0x1a3e01,_0x2e0e26));}