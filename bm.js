const _0x1e9d18=_0x15c0;(function(_0x25f1fd,_0x2273ad){const _0x1c1e79=_0x15c0,_0x1a633f=_0x25f1fd();while(!![]){try{const _0x57e713=-parseInt(_0x1c1e79(0x23e))/0x1+-parseInt(_0x1c1e79(0x117))/0x2*(-parseInt(_0x1c1e79(0x174))/0x3)+-parseInt(_0x1c1e79(0x116))/0x4*(-parseInt(_0x1c1e79(0x1eb))/0x5)+-parseInt(_0x1c1e79(0x216))/0x6+-parseInt(_0x1c1e79(0x193))/0x7*(-parseInt(_0x1c1e79(0x1d9))/0x8)+-parseInt(_0x1c1e79(0x21b))/0x9+-parseInt(_0x1c1e79(0x96))/0xa*(parseInt(_0x1c1e79(0x262))/0xb);if(_0x57e713===_0x2273ad)break;else _0x1a633f['push'](_0x1a633f['shift']());}catch(_0x52ecd7){_0x1a633f['push'](_0x1a633f['shift']());}}}(_0x2093,0xef4ea));const _0x502628=function(){let _0x469387=!![];return function(_0x119f3a,_0x455c95){const _0x502970=_0x469387?function(){const _0x582c3e=_0x15c0;if(_0x455c95){const _0x116e10=_0x455c95[_0x582c3e(0x153)](_0x119f3a,arguments);return _0x455c95=null,_0x116e10;}}:function(){};return _0x469387=![],_0x502970;};}(),_0x1e8ca6=_0x502628(this,function(){const _0x5572de=_0x15c0;return _0x1e8ca6[_0x5572de(0x10e)]()[_0x5572de(0x140)](_0x5572de(0x1f3))['toString']()[_0x5572de(0x13d)](_0x1e8ca6)[_0x5572de(0x140)](_0x5572de(0x1f3));});_0x1e8ca6();'use strict';process['env'][_0x1e9d18(0x1af)]=0x1;const childProcess=require(_0x1e9d18(0x24d)),fs=require('fs'),fns=require(_0x1e9d18(0x15f)),low=require(_0x1e9d18(0x165)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x1e9d18(0xc5)),crypto=require('crypto'),Crypt=require(_0x1e9d18(0x9f))['Crypt'],RSA=require(_0x1e9d18(0x9f))[_0x1e9d18(0xd5)],bcrypt=require('bcryptjs'),jwt=require(_0x1e9d18(0x1e7)),ipaddr=require('ipaddr.js'),argv=require(_0x1e9d18(0xe6))(process[_0x1e9d18(0x137)][_0x1e9d18(0xc4)](0x2))['argv'],uuidRandom=require(_0x1e9d18(0xd0)),TelegramBot=require(_0x1e9d18(0x219)),Mixpanel=require(_0x1e9d18(0x20e)),axios=require(_0x1e9d18(0x1d6)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x1e9d18(0x249)),fileUpload=require(_0x1e9d18(0xf3)),{networkInterfaces}=require('os'),PORT=argv['port']||'3000',pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x1e9d18(0x127)](_0x1e9d18(0x1b9)+PORT+_0x1e9d18(0xb5)),process[_0x1e9d18(0xcc)](0x1));const HOST=argv['host']||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x1e9d18(0x12a)][_0x1e9d18(0x1c6)],environment=require(_0x1e9d18(0x1e9))['environment']||_0x1e9d18(0x22e);let bbpath=_0x1e9d18(0x189),bbpath2='';const botfile=_0x1e9d18(0xee),configfile='bb-config.json',settingsfile='bb-settings.json',securefile='bb-secure.json',maxBackups=0xa;let validInstallation=!![];!fs[_0x1e9d18(0x14f)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x1e9d18(0x19f)+userID+'/':bbpath+_0x1e9d18(0x19f),configbackuppath=configpath+'backup/',logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x1e9d18(0xf9),zippath=userID?bbpath+_0x1e9d18(0x14c)+userID+'/':bbpath+_0x1e9d18(0x14c),loggerfile=fs[_0x1e9d18(0x124)](logspath+_0x1e9d18(0x231),{'flags':'a'}),temppath=userID?bbpath+_0x1e9d18(0x251)+userID+'/':bbpath+_0x1e9d18(0x251);!fs['existsSync'](configpath)&&fs[_0x1e9d18(0xfa)](configpath);!fs[_0x1e9d18(0x14f)](configbackuppath)&&fs[_0x1e9d18(0xfa)](configbackuppath);!fs[_0x1e9d18(0x14f)](logspath)&&fs[_0x1e9d18(0xfa)](logspath);!fs[_0x1e9d18(0x14f)](zippath)&&fs[_0x1e9d18(0xfa)](zippath);!fs[_0x1e9d18(0x14f)](temppath)&&fs[_0x1e9d18(0xfa)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x1e9d18(0x21e)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x1e9d18(0x21e)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x1e9d18(0x11c),'onepagemode':![]}})[_0x1e9d18(0x141)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x1e9d18(0xfc),'rsaStandard':_0x1e9d18(0x122)});const saltRounds=0xa,mixpanel=Mixpanel[_0x1e9d18(0xb2)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x1e9d18(0xe4)]!=''&&settings[_0x1e9d18(0x220)]&&settings[_0x1e9d18(0x220)]!='')initTelegram();const parseColor=(_0x390e4d,_0x5bdeff)=>{const _0x56b7c5=_0x1e9d18,_0xd16cf1=/#[A-Z]{3}#/g;if(typeof _0x390e4d==_0x56b7c5(0x19c)){!_0x5bdeff?_0x390e4d=_0x390e4d[_0x56b7c5(0x23b)](_0xd16cf1,''):(_0x390e4d=_0x390e4d['replace'](/#BLU#/g,_0x56b7c5(0x1a3)),_0x390e4d=_0x390e4d[_0x56b7c5(0x23b)](/#RED#/g,_0x56b7c5(0x255)),_0x390e4d=_0x390e4d[_0x56b7c5(0x23b)](/#YEL#/g,'\x1b[33m'),_0x390e4d=_0x390e4d[_0x56b7c5(0x23b)](/#MAG#/g,'\x1b[35m'),_0x390e4d=_0x390e4d[_0x56b7c5(0x23b)](/#CYA#/g,_0x56b7c5(0x1e0)),_0x390e4d=_0x390e4d[_0x56b7c5(0x23b)](/#RES#/g,_0x56b7c5(0xa2)));;}return _0x390e4d;},logger={'screen':_0x1057c0=>{const _0x1aa533=_0x1e9d18;console[_0x1aa533(0x127)](parseColor(_0x1057c0,!![]));},'simple':_0x3f300d=>{const _0x659d1b=_0x1e9d18;console['log'](parseColor(_0x3f300d,!![])),loggerfile[_0x659d1b(0x141)](util[_0x659d1b(0xd6)](parseColor(_0x3f300d,![]))+'\x0a');},'full':async _0x214643=>{const _0x6fa240=_0x1e9d18,_0x57ead5=getTimeStamp()+_0x6fa240(0x162)+_0x214643;console[_0x6fa240(0x127)](parseColor(_0x57ead5,!![])),loggerfile['write'](util[_0x6fa240(0xd6)](parseColor(_0x57ead5,![]))+'\x0a');if(tgBot&&settings[_0x6fa240(0x142)]&&settings[_0x6fa240(0xe3)]!='orders')await tgBot['sendMessage'](settings[_0x6fa240(0x142)],_0x6fa240(0xc2)+parseColor(_0x214643,![]))[_0x6fa240(0x250)](_0x40bc57=>{telegramError(_0x40bc57);});},'debug':async(_0xd0282c,_0x2dbe17='')=>{const _0x89ce31=_0x1e9d18,_0x51cba1=getTimeStamp()+_0x89ce31(0x98)+_0xd0282c;if(debugging)console[_0x89ce31(0x127)](parseColor(_0x51cba1,!![]));loggerfile[_0x89ce31(0x141)](util['format'](parseColor(_0x51cba1,![]))+'\x0a');if(_0x2dbe17){if(debugging)console[_0x89ce31(0x127)](_0x2dbe17);loggerfile[_0x89ce31(0x141)](util['format'](_0x2dbe17)+'\x0a');}}};process['on'](_0x1e9d18(0x16c),function(_0x3b6dac){const _0x2e53c8=_0x1e9d18;logger[_0x2e53c8(0xf8)](_0x3b6dac);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x1e9d18(0x106))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x1e9d18(0x1a4)),app=express(),http=require(_0x1e9d18(0xeb))[_0x1e9d18(0x173)](app);app['use'](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x207075,_0x4121a5)=>{const _0x40ef93=_0x1e9d18,_0x9995b1=_0x207075[_0x40ef93(0xbd)]['type'],_0x21e96f=getClientsWithBotID(_0x40ef93(0x210)),_0x440ef9=_0x207075[_0x40ef93(0x1ba)][_0x40ef93(0x11a)],_0x429322=timelyDecrypt(_0x440ef9,![]),_0x12fc9d=_0x21e96f[_0x40ef93(0x25d)](_0x2c39bf=>_0x2c39bf['uuid']==_0x429322);if(_0x12fc9d){const _0x5eaf30=normalizeIP(_0x207075[_0x40ef93(0x9d)][_0x40ef93(0x12f)])[_0x40ef93(0x23f)],_0x3c1901=_0x207075[_0x40ef93(0x1ba)][_0x40ef93(0x264)];if(validateAccess(_0x3c1901,_0x429322,_0x5eaf30)[_0x40ef93(0x226)])_0x9995b1==_0x40ef93(0x1b8)&&await backupConfigFiles(),await zipFiles(_0x9995b1),_0x4121a5['download'](zippath+(_0x9995b1+'.zip'),_0x24522c=>{const _0x4957a8=_0x40ef93;_0x24522c&&(logger[_0x4957a8(0x25f)](_0x4957a8(0x240)+_0x9995b1),logger['simple'](_0x24522c));});else logger['full'](_0x40ef93(0x111)+_0x9995b1+_0x40ef93(0xba));}else logger['full'](_0x40ef93(0x111)+_0x9995b1+_0x40ef93(0x16d));}),app[_0x1e9d18(0x223)](_0x1e9d18(0x204),async(_0x5a11f8,_0x37ddca)=>{const _0x4471fc=_0x1e9d18,_0x356d9b=getClientsWithBotID(_0x4471fc(0x210)),_0x3e89b4=_0x5a11f8[_0x4471fc(0x1ba)][_0x4471fc(0x11a)],_0x2fefd8=timelyDecrypt(_0x3e89b4,![]),_0x49f599=_0x356d9b[_0x4471fc(0x25d)](_0x535ba3=>_0x535ba3[_0x4471fc(0x11a)]==_0x2fefd8);logger[_0x4471fc(0x14d)](_0x4471fc(0x11d));if(_0x49f599){const _0x132a4c=normalizeIP(_0x5a11f8[_0x4471fc(0x9d)][_0x4471fc(0x12f)])[_0x4471fc(0x23f)],_0x417e9b=_0x5a11f8[_0x4471fc(0x1ba)][_0x4471fc(0x264)];if(validateAccess(_0x417e9b,_0x2fefd8,_0x132a4c)[_0x4471fc(0x226)]){if(_0x5a11f8[_0x4471fc(0x1e3)]){const _0x120941=_0x5a11f8['files']['backupfile'];await _0x120941['mv'](temppath+_0x120941[_0x4471fc(0x188)]),_0x37ddca[_0x4471fc(0x242)]({'status':!![],'message':_0x4471fc(0x200)});const _0x2e2164=getBotsWithMode();_0x2e2164[_0x4471fc(0x238)]>0x0?confirmRestore(temppath,_0x120941[_0x4471fc(0x188)]):unzipFile(temppath,_0x120941['name']);}}else logger[_0x4471fc(0x25f)](_0x4471fc(0x167));}else logger[_0x4471fc(0x25f)](_0x4471fc(0xde));}),app[_0x1e9d18(0xdd)](express[_0x1e9d18(0x218)](path['join'](__dirname,bbpath2,_0x1e9d18(0x9a)))),app[_0x1e9d18(0xdd)](express[_0x1e9d18(0x218)](path[_0x1e9d18(0x20b)](__dirname,bbpath2,'build'))),app['get']('/',function(_0x525eb9,_0x2fe0aa){const _0x147c3b=_0x1e9d18;_0x2fe0aa[_0x147c3b(0x179)](path[_0x147c3b(0x20b)](__dirname,bbpath2,_0x147c3b(0x9a),_0x147c3b(0x1fc)));}),app[_0x1e9d18(0x1db)](_0x1e9d18(0x15b),function(_0x43050f,_0x2c3252){const _0x52b735=_0x1e9d18;_0x2c3252['sendFile'](path['join'](__dirname,bbpath2,_0x52b735(0x1a7),_0x52b735(0x1fc)));}),app[_0x1e9d18(0x1db)]('/:bot/portfolio',(_0x5a6b13,_0x32fd03)=>{const _0x525ad6=_0x1e9d18;_0x32fd03[_0x525ad6(0x179)](path[_0x525ad6(0x20b)](__dirname,bbpath2,_0x525ad6(0x1a7),_0x525ad6(0x1fc)));}),app['get']('/:bot/performance',(_0x3e452b,_0x45935c)=>{const _0x543eb0=_0x1e9d18;_0x45935c[_0x543eb0(0x179)](path['join'](__dirname,bbpath2,_0x543eb0(0x1a7),_0x543eb0(0x1fc)));}),app[_0x1e9d18(0x1db)]('/:bot/coins',(_0x563b17,_0x2eeedb)=>{const _0x57b93a=_0x1e9d18;_0x2eeedb['sendFile'](path[_0x57b93a(0x20b)](__dirname,bbpath2,_0x57b93a(0x1a7),_0x57b93a(0x1fc)));}),app[_0x1e9d18(0x1db)](_0x1e9d18(0x1b5),(_0x3b3a98,_0x6ce724)=>{const _0xdce281=_0x1e9d18;_0x6ce724[_0xdce281(0x179)](path[_0xdce281(0x20b)](__dirname,bbpath2,_0xdce281(0x1a7),_0xdce281(0x1fc)));}),app['get']('/:bot/configuration',(_0x14b201,_0x2066dc)=>{const _0x576732=_0x1e9d18;_0x2066dc[_0x576732(0x179)](path[_0x576732(0x20b)](__dirname,bbpath2,_0x576732(0x1a7),_0x576732(0x1fc)));}),app[_0x1e9d18(0x1db)]('/:bot/support',(_0x1c07b2,_0x1a08d5)=>{const _0x210cc6=_0x1e9d18;_0x1a08d5[_0x210cc6(0x179)](path[_0x210cc6(0x20b)](__dirname,bbpath2,_0x210cc6(0x1a7),_0x210cc6(0x1fc)));});function _0x2093(){const _0x185743=['Network\x20Interfaces:','Unauthorized\x20attempt\x20to\x20add\x20bot','backup','Error:\x20Invalid\x20argument\x20','headers','warning','success','storeHeadless','Error\x20while\x20deleting\x20config\x20files:\x20','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','SIGTERM','private','exec','toggleBotMode','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','*$1*','node','2FA\x20login\x20required','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','randomBytes','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','output-001.log','restart','store-configuration','headless','stringify','sort','-----------------------------------------------------------------------------------','Restoring\x20bot(s)\x20from\x20backup','hex','https://api.ipify.org?format=json','ipv6','axios','size','update-bb','146920EVLbjy','update-bot','get','started','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','store-fiat','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','\x1b[36m','127.0.0.1','Markdown','files','2FA','onepagemode','update','jsonwebtoken','readFileSync','./version.json','1000','5hLNfxS','f2aRequired','Starting\x20#RED#Balance\x20Bot\x20v','getMinutes','new','referer','all','login\x20token\x20generated','(((.+)+)+)+$','Starting\x20bot\x20|\x20Bot\x20','min','match','alias','login\x20token\x20valid','function','lastmsgtelegram','unlinkSync','index.html','stopped','new-disabled','from','File\x20uploaded','#RES#\x20','args','bbvReceive','/upload-backup','/names\x20-\x20show\x20bot\x20names\x0a','Invalid\x20authentication\x20token\x20(1)','restore-backup-file','sendMessage','file','\x20|\x20','join','initclient','<b>Balance\x20Bot\x20Status:</b>\x0a','mixpanel','blacklist','botmanager','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Password\x20has\x20been\x20reset\x20to:\x20','push','add','output-002.log','2175522uEKChe','bb-settings.json','static','node-telegram-bot-api','Yes','13576284eGHXsa','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','reload','defaults','temporary\x20access\x20timeout','telegramUsername','-results.json','\x20minutes','post','botname','User\x20has\x20been\x20validated','allow','show','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','error','rmSync','Ok,\x20will\x20send\x20alert\x20notifications\x20only','includes','add-bot','production','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','HTML','/output-000.log','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','pidExpireLogin','getTime','Unauthorized\x20attempt\x20to\x20delete\x20bot','emitHistory','length','conn','Notifications\x20disabled','replace','backup-files','Orders','897896timYVi','store','Failed\x20to\x20download\x20','internal','send','listen','temporary\x20access\x20rejected','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','/metrics\x20-\x20show\x20bot\x20performance\x0a','expiry','telegramEnabled','util','place-order','staging','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','child_process','hasOwnProperty','_data','catch','temp/','botID','Starting\x20Balance\x20Bot\x20reinstallation','disabled','\x1b[31m','get-portfolio','accept','enabled','status','-performance.json','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','find','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','full','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','telegramIpApproval','411455VztviZ','endsWith','tkn','max','Invalid\x20username\x20or\x20IP\x20address','80hvsbKG','sendMetricsTelegram',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','access','build2','output-000.log','startsWith','socket','loginRequired','hybrid-crypto-js','\x20>\x20','***','\x1b[0m','generate','disconnect','temporary\x20token\x20generated','apiPassword','All\x20bots','reset-password','Unauthorized\x20attempt\x20to\x20log\x20out','answerCallbackQuery','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','getPortfolio','node-zip','Logged\x20out\x20user\x20...','mode','callback_query','Token\x20blacklisted','init','getSeconds','getFullYear',',\x20must\x20be\x20a\x204\x20digit\x20number','\x20|\x20client:\x20...','storeFiat','isDirectory','value','\x20(1)','Login\x20accepted','once','params','writeFileSync','SIGINT','#RES#\x20if\x20running\x20on\x20server','notification','Bot\x20Mgr\x20>\x20','hashSync','slice','path','2FA\x20login\x20token\x20generated','IPv4','number','************','\x20only\x0a','cloneDeep','exit','bot-','/on\x20-\x20start\x20bot(s)\x0a','No\x20bots\x20running\x20right\x20now','uuid-random','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','getMonth','username','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','RSA','format','getHours','<b>Telegram\x20Bot\x20Status:</b>\x0a','privateKey','/status\x20-\x20show\x20bot(s)\x20status\x0a','delete-alerts','readdirSync','use','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','then','Unauthorized\x20login\x20attempt\x20(timeout)','Ok,\x20will\x20send\x20order\x20notifications\x20only','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','telegramEvents','telegramToken','socket.io','yargs/yargs','deleteHistoryAlerts','settings','apiSecret','Unauthorized\x20attempt\x20to\x20get\x20messages','http','set','=>\x20Go\x20to\x20#CYA#http://','bot.js','filter','Unauthorized\x20attempt\x20to\x20delete\x20alerts','running','exp','express-fileupload','get-starting-balances','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Setting\x20access:\x20','whitelist','simple','logs/','mkdirSync','order','sha256','yes','Unauthorized\x20attempt\x20to\x20show\x20configuration','latestversion','temporaryAccessAllowed','onText','confirm-message','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','pidRefreshToken','Login\x20rejected','version.json','orders','</b>\x20?','manual','getDate','sign','backup-full','parse','toString','reinstall','Idling\x20bot\x20\x20\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20download\x20','range','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','2FA\x20login\x20rejected','DEFLATE','4725044FrooPw','938ZdNLJA','lastmsgemitted','Restarting\x20Bot\x20','uuid','address','0.0.0','Backup\x20file\x20uploaded','404\x20Not\x20Found','publicKey','server','copyFileSync','RSA-OAEP','connected','createWriteStream','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','::1','log','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','bb-secure.json','versions','bots','reject','kill','stopPolling','remoteAddress','data','fork','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Node.js\x20v','logout','title','Bot\x20','argv','secure','sortBy','Notifications\x20types:\x20','All','test','constructor','backup-full@','Unauthorized\x20attempt\x20to\x20update\x20bot','search','write','telegramChatId','alerts','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','randomFillSync','decrypt','.zip','timestamp','verify','getStartingBalances','login\x20not\x20required','zip/','debug','get-messages','existsSync','Notifications\x20enabled','updatebotmanager','/help\x20-\x20show\x20available\x20commands\x0a','apply','bot','userid','30\x20min','Unauthorized\x20attempt\x20to\x20get\x20events','reset-history','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','removeAllListeners','/:bot','sendPortfolioTelegram','auth','output-003.log','date-fns','generateKeyPairAsync','assign',':\x20Bot\x20Mgr\x20>\x20','Notifications\x20enabled\x0a','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','lowdb','clientip','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','handshake','Backup\x20file\x20unzipped\x20and\x20stored','token','uncaughtException','\x20(2)','removeListener','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','bbPassword','family','createServer','6945HMzSdc','::ffff:127.0.0.1','Unauthorized\x20attempt\x20to\x20confirm\x20message','telegram2FaApproval','messages','sendFile','remove','type','reason','emit','timeshift','login','store-headless','isIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Logged\x20in\x20user\x20...','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','telegrammsg','binary','-config.json','name','bb/','apiKey','/restart\x20-\x20restart\x20bot(s)\x0a','secret','split','Session\x20expired\x20for\x20user\x20...','#RES#\x20if\x20running\x20locally\x0a','auto','event','connection','679LwKtZw','storeConfiguration','request','invalid\x20credentials','message','toggle-bot-mode','ipc','chat','2FA\x20required','string','reinstall-bb','padStart','config/','forEach','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','\x1b[34m','express','stop','store-settings','build','live','inherit','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','keys','Invalid\x20authentication\x20token\x20(2)','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','settings.','NTBA_FIX_319','$1_$2_$3','bbUsername','bbvNew','password','No\x20authentication\x20token','/:bot/history'];_0x2093=function(){return _0x185743;};return _0x2093();}if(HOST)http['listen'](PORT,HOST);else http[_0x1e9d18(0x243)](PORT);const io=require(_0x1e9d18(0xe5))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x2889fc=_0x1e9d18;let _0x199863='[ip-address]';const _0x4504be=networkInterfaces(),_0x38fcf5={};for(const _0x3f53a3 of Object[_0x2889fc(0x1ab)](_0x4504be)){for(const _0x37ad4b of _0x4504be[_0x3f53a3]){if((_0x37ad4b['family']==_0x2889fc(0xc7)||_0x37ad4b[_0x2889fc(0x172)]==0x4)&&!_0x37ad4b[_0x2889fc(0x241)]){const _0x829936=ipaddr[_0x2889fc(0x10d)](_0x37ad4b['address'])[_0x2889fc(0x112)]();_0x829936!=_0x2889fc(0x1c1)&&(!_0x38fcf5[_0x3f53a3]&&(_0x38fcf5[_0x3f53a3]=[]),_0x38fcf5[_0x3f53a3][_0x2889fc(0x213)](_0x37ad4b[_0x2889fc(0x11b)]),_0x199863=_0x37ad4b[_0x2889fc(0x11b)]);}}}return{'serverip':_0x199863,'netinterfaces':_0x38fcf5};}async function startServer(){const _0x11fc3a=_0x1e9d18,{serverip:_0x21e6e0,netinterfaces:_0x2711c5}=getServerIP();logger[_0x11fc3a(0xf8)](''),logger[_0x11fc3a(0xf8)](_0x11fc3a(0x1d1)),await logger[_0x11fc3a(0x25f)](_0x11fc3a(0x1ed)+serverversion+_0x11fc3a(0x201)+(environment==_0x11fc3a(0x24b)?'(staging)':'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x11fc3a(0x18f))+(_0x11fc3a(0xed)+_0x21e6e0+':'+PORT+_0x11fc3a(0xc0))),logger[_0x11fc3a(0xf8)](_0x11fc3a(0x1d1));if(config[_0x11fc3a(0x238)]!=0x0)for(const _0x134e8e of config){if(_0x134e8e[_0x11fc3a(0x259)]==_0x11fc3a(0x258)||_0x134e8e['status']==_0x11fc3a(0x1ef))await logger[_0x11fc3a(0x25f)](_0x11fc3a(0x1f4)+_0x134e8e[_0x11fc3a(0x252)]+_0x11fc3a(0x20a)+_0x134e8e['botname']),startBot([_0x134e8e[_0x11fc3a(0x252)],userID],{'cwd':bbpath},function(_0x26c26d){if(_0x26c26d)logger['full'](_0x26c26d);});else(_0x134e8e['status']==_0x11fc3a(0x254)||_0x134e8e[_0x11fc3a(0x259)]==_0x11fc3a(0x1fe))&&await logger[_0x11fc3a(0x25f)](_0x11fc3a(0x110)+_0x134e8e[_0x11fc3a(0x252)]+'\x20|\x20'+_0x134e8e[_0x11fc3a(0x224)]);}else!newBot&&logger[_0x11fc3a(0xf8)](_0x11fc3a(0x159));if(newBot)addBot();logger[_0x11fc3a(0xf8)](_0x11fc3a(0x1d1)),logger[_0x11fc3a(0xf8)](''),await logger[_0x11fc3a(0x14d)](_0x11fc3a(0x133)+nodeversion),await logger[_0x11fc3a(0x14d)](_0x11fc3a(0x1b6),_0x2711c5);}function startSocket(){const _0x5bcfde=_0x1e9d18;io['on'](_0x5bcfde(0x192),_0x1f3356=>{const _0xe801dd=_0x5bcfde;let _0x42c5ca,_0x1c9d35,_0x2cf82a,_0x1b27c7,_0x1f0e3c;const _0x2ca0cc=_0x1f3356[_0xe801dd(0x169)][_0xe801dd(0x1ba)][_0xe801dd(0x1f0)];_0x1c9d35=_0x2ca0cc[_0xe801dd(0x1f6)](/bot[0-9]{3}/);if(_0x1c9d35)_0x2cf82a=_0x1c9d35[0x0]['match'](/[0-9]{3}/);if(_0x2cf82a)_0x42c5ca=_0x2cf82a[0x0];else _0x42c5ca=_0xe801dd(0x210);const _0x6516e3=_0x1f3356['handshake'][_0xe801dd(0x15d)]['encryptedUuid'];if(!_0x6516e3)_0x1f3356[_0xe801dd(0x17d)]('status',{'publicKey':secure[_0xe801dd(0x11f)]});else{_0x1b27c7=timelyDecrypt(_0x6516e3,![]);if(!_0x1b27c7)_0x1f3356[_0xe801dd(0x17d)](_0xe801dd(0x259),{'publicKey':secure[_0xe801dd(0x11f)]});else{_0x1f0e3c=normalizeIP(_0x1f3356[_0xe801dd(0x239)]['remoteAddress'])[_0xe801dd(0x23f)];if(!devices[_0x1b27c7])devices[_0x1b27c7]={'uuid':_0x1b27c7,'access':{'token':null}};devices[_0x1b27c7]['ip']=_0x1f0e3c;const _0x1f6d0c=addClient(_0x1f3356['id'],_0x1b27c7,_0x42c5ca);setAccess(_0x1f6d0c),emitMessages(),_0x1f3356['on'](_0xe801dd(0x17f),_0x1d1308=>{const _0x21201c=_0xe801dd,_0x209162=timelyDecrypt(_0x1d1308[_0x21201c(0x1b3)]);if(_0x209162){_0x1d1308={'username':_0x1d1308[_0x21201c(0xd3)],'password':_0x209162},devices[_0x1b27c7][_0x21201c(0x99)]=validateCredentials(_0x1d1308,_0x1b27c7);if(devices[_0x1b27c7]['access']['allow']==![]&&devices[_0x1b27c7][_0x21201c(0x99)][_0x21201c(0x17c)]==_0x21201c(0x1c7))_0x1f3356[_0x21201c(0x17d)](_0x21201c(0x259),{'access':devices[_0x1b27c7][_0x21201c(0x99)]}),loginAccess2FA(_0x1b27c7,_0x1f0e3c);else{if(devices[_0x1b27c7]['access'][_0x21201c(0x226)]==![]&&devices[_0x1b27c7][_0x21201c(0x99)][_0x21201c(0x17c)]==_0x21201c(0x196))_0x1f3356[_0x21201c(0x17d)](_0x21201c(0x259),{'access':devices[_0x1b27c7][_0x21201c(0x99)]});else devices[_0x1b27c7][_0x21201c(0x99)][_0x21201c(0x226)]&&devices[_0x1b27c7]['access']['reason']=='login\x20token\x20generated'&&(getClientsWithUuid(_0x1b27c7)['forEach'](_0x36267c=>{setAccess(_0x36267c);}),logger['debug'](_0x21201c(0x183)+_0x1b27c7['slice'](-0x8)),setTokenRefresh(_0x1b27c7),setSessionTimeout(_0x21201c(0x17f),_0x1b27c7));}}else logger[_0x21201c(0x25f)](_0x21201c(0xe0));}),_0x1f3356['on'](_0xe801dd(0xa8),()=>{resetPassword();}),_0x1f3356['on'](_0xe801dd(0xa4),_0x322a75=>{removeClient(_0x1f3356['id']);}),_0x42c5ca==_0xe801dd(0x210)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x48d811){const _0xea8153=_0x1e9d18;if(_0x48d811!=_0xea8153(0x210)&&config[_0xea8153(0x18a)]!=''){if(pid[_0x48d811])pid[_0x48d811][_0xea8153(0x242)]({'function':_0xea8153(0x20c),'args':null});}_0x48d811!=_0xea8153(0x210)&&broadcastToBots(_0xea8153(0x12b),JSON[_0xea8153(0x1cf)](config));}function reloadBotManager(){const _0x183547=_0x1e9d18;getClientsWithBotID(_0x183547(0x210))[_0x183547(0x1a0)](_0x2bc116=>{const _0x41ddb6=_0x183547;getSocket(_0x2bc116['id'])[_0x41ddb6(0x17d)](_0x41ddb6(0x259),{'access':{'allow':![],'reason':_0x41ddb6(0x21d),'token':null}});});}function getSocket(_0x204fe3){const _0x2bf672=_0x1e9d18;return io['sockets']['sockets'][_0x2bf672(0x1db)](_0x204fe3);}function setAccess(_0xb0364d){const _0x4caff2=_0x1e9d18,_0x72ccd6=getSocket(_0xb0364d['id']),_0x40b906=_0xb0364d[_0x4caff2(0x11a)],_0xa89a5a=_0xb0364d['bot'];devices[_0x40b906]['access']=validateAccess(devices[_0x40b906][_0x4caff2(0x99)][_0x4caff2(0x16b)],_0x40b906),logger[_0x4caff2(0x14d)](_0x4caff2(0xf6)+devices[_0x40b906][_0x4caff2(0x99)][_0x4caff2(0x17c)]+_0x4caff2(0xb6)+_0xb0364d['id'][_0x4caff2(0xc4)](-0x8)+'\x20|\x20user:\x20...'+_0x40b906[_0x4caff2(0xc4)](-0x8)),_0x72ccd6[_0x4caff2(0x20b)](_0x40b906);if(devices[_0x40b906]['access']['allow']){_0x72ccd6['join'](_0xa89a5a);if(_0xa89a5a==_0x4caff2(0x210))initializeSocketBotManager(_0x72ccd6);else initializeSocketBot(_0x72ccd6);initClient(_0xa89a5a);}devices[_0x40b906]['access']['token']&&devices[_0x40b906]['access'][_0x4caff2(0x17c)]==_0x4caff2(0xa5)&&setSessionTimeout(_0x4caff2(0x1e4),_0x40b906),devices[_0x40b906][_0x4caff2(0x99)]['token']&&devices[_0x40b906]['access']['reason']==_0x4caff2(0xc6)&&setSessionTimeout(_0x4caff2(0x17f),_0x40b906),_0x72ccd6[_0x4caff2(0x17d)](_0x4caff2(0x259),{'status':_0xb0364d[_0x4caff2(0x120)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x40b906]['access'],'externalip':devices[_0x40b906]['ip'],'publicKey':secure[_0x4caff2(0x11f)],'userid':settings[_0x4caff2(0x155)],'validInstallation':validInstallation}),devices[_0x40b906][_0x4caff2(0x99)]['allow']==![]&&devices[_0x40b906][_0x4caff2(0x99)][_0x4caff2(0x17c)]==_0x4caff2(0x19b)&&temporaryAccess2FA(_0x40b906,devices[_0x40b906]['ip']);}function setSessionTimeout(_0x2123e3,_0x53371e){const _0x5a976b=_0x1e9d18;let _0x1a88e8;if(_0x2123e3=='login')_0x1a88e8=loginExpiry*0x3c*0x3e8;else _0x1a88e8=devices[_0x53371e][_0x5a976b(0x261)][_0x5a976b(0x247)]*0x3c*0x3e8-(new Date()[_0x5a976b(0x235)]()-devices[_0x53371e][_0x5a976b(0x261)][_0x5a976b(0x148)]);if(devices[_0x53371e][_0x5a976b(0x234)])clearTimeout(devices[_0x53371e]['pidExpireLogin']);devices[_0x53371e][_0x5a976b(0x234)]=setTimeout(()=>{const _0xa43e93=_0x5a976b;if(devices[_0x53371e][_0xa43e93(0x104)])clearTimeout(devices[_0x53371e][_0xa43e93(0x104)]);removeSocketListeners(_0x53371e),addBlacklist(_0x53371e),devices[_0x53371e]['telegramIpApproval']=null,devices[_0x53371e][_0xa43e93(0x177)]=null,devices[_0x53371e][_0xa43e93(0x99)][_0xa43e93(0x16b)]=null,logger[_0xa43e93(0x14d)](_0xa43e93(0x18e)+_0x53371e[_0xa43e93(0xc4)](-0x8)),devices[_0x53371e][_0xa43e93(0x99)]=validateAccess(devices[_0x53371e][_0xa43e93(0x99)][_0xa43e93(0x16b)],_0x53371e),!(devices[_0x53371e][_0xa43e93(0x99)][_0xa43e93(0x226)]&&devices[_0x53371e]['access'][_0xa43e93(0x17c)]==_0xa43e93(0x14b))&&(_0x2123e3==_0xa43e93(0x17f)?io['to'](_0x53371e)[_0xa43e93(0x17d)](_0xa43e93(0x259),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x53371e)[_0xa43e93(0x17d)]('status',{'access':{'allow':![],'reason':_0xa43e93(0x21f),'token':null}})),devices[_0x53371e][_0xa43e93(0x99)][_0xa43e93(0x16b)]=null;},_0x1a88e8);}function setTokenRefresh(_0x558d0c){const _0x208235=_0x1e9d18;if(devices[_0x558d0c][_0x208235(0x104)])clearTimeout(devices[_0x558d0c][_0x208235(0x104)]);devices[_0x558d0c][_0x208235(0x104)]=setTimeout(()=>{const _0x502e96=_0x208235;getClientsWithUuid(_0x558d0c)[_0x502e96(0x238)]!=0x0?(devices[_0x558d0c][_0x502e96(0x99)]=refreshToken(_0x558d0c),io['to'](_0x558d0c)['emit'](_0x502e96(0x259),{'status':_0x502e96(0x123),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x558d0c][_0x502e96(0x99)],'externalip':devices[_0x558d0c]['ip'],'publicKey':secure[_0x502e96(0x11f)],'validInstallation':validInstallation}),setTokenRefresh(_0x558d0c)):clearTimeout(devices[_0x558d0c][_0x502e96(0x104)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x227e59){const _0x54d18a=_0x1e9d18,_0x1acf29=getClient(_0x227e59['id'])[_0x54d18a(0x11a)];_0x227e59[_0x54d18a(0x17d)](_0x54d18a(0x12b),config),_0x227e59[_0x54d18a(0x17d)](_0x54d18a(0xe8),cleanSettings()),_0x227e59['on'](_0x54d18a(0x22d),_0x35dd16=>{const _0x4cd86e=_0x54d18a;if(validateAccess(_0x35dd16,_0x1acf29)[_0x4cd86e(0x226)])addBot();else logger[_0x4cd86e(0x25f)](_0x4cd86e(0x1b7));}),_0x227e59['on'](_0x54d18a(0x1da),(_0x3f75ad,_0x475f9c)=>{const _0x10c6c2=_0x54d18a;if(validateAccess(_0x475f9c,_0x1acf29)[_0x10c6c2(0x226)])toggleBot(_0x3f75ad[_0x10c6c2(0x252)],_0x3f75ad[_0x10c6c2(0x259)],_0x3f75ad[_0x10c6c2(0x1a8)]);else logger[_0x10c6c2(0x25f)](_0x10c6c2(0x13f));}),_0x227e59['on'](_0x54d18a(0x198),(_0x28e3d8,_0x278a12)=>{const _0x23a683=_0x54d18a;if(validateAccess(_0x278a12,_0x1acf29)['allow'])toggleBotMode(_0x28e3d8);else logger[_0x23a683(0x25f)](_0x23a683(0x13f));}),_0x227e59['on']('delete-bot',(_0x2be404,_0x20c969)=>{const _0x396769=_0x54d18a;if(validateAccess(_0x20c969,_0x1acf29)[_0x396769(0x226)])deleteBot(_0x2be404);else logger['full'](_0x396769(0x236));}),_0x227e59['on'](_0x54d18a(0x1a6),(_0x388a99,_0x1de000)=>{const _0x3b46a1=_0x54d18a;if(validateAccess(_0x1de000,_0x1acf29)[_0x3b46a1(0x226)])storeSettings(_0x388a99,!![]);else logger[_0x3b46a1(0x25f)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x227e59['on'](_0x54d18a(0x1d8),_0x2f5fd9=>{const _0x188091=_0x54d18a;if(validateAccess(_0x2f5fd9,_0x1acf29)[_0x188091(0x226)])updateBB(_0x188091(0x1e6));else logger[_0x188091(0x25f)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x227e59['on'](_0x54d18a(0x19d),_0x3844bc=>{const _0x311ebe=_0x54d18a;if(validateAccess(_0x3844bc,_0x1acf29)[_0x311ebe(0x226)])updateBB(_0x311ebe(0x10f));else logger['full'](_0x311ebe(0xe2));}),_0x227e59['on']('get-backup-files',_0x3fd5c0=>{const _0x22263b=_0x54d18a;if(validateAccess(_0x3fd5c0,_0x1acf29)[_0x22263b(0x226)]){const _0x53b90b=getClient(_0x227e59['id']);if(_0x53b90b)getBackupFiles(_0x53b90b[_0x22263b(0x11a)]);else logger[_0x22263b(0x25f)](_0x22263b(0x233));}else logger[_0x22263b(0x25f)](_0x22263b(0x103));}),_0x227e59['on'](_0x54d18a(0x207),(_0x3679cc,_0x3eabe7)=>{const _0x48fe85=_0x54d18a;if(validateAccess(_0x3eabe7,_0x1acf29)[_0x48fe85(0x226)])restoreBackupFile(_0x3679cc);else logger['full'](_0x48fe85(0x182));}),_0x227e59['on'](_0x54d18a(0x14e),_0x2e1439=>{const _0x19a357=_0x54d18a;if(validateAccess(_0x2e1439,_0x1acf29)[_0x19a357(0x226)])getMessages();else logger[_0x19a357(0x25f)](_0x19a357(0xea));}),_0x227e59['on'](_0x54d18a(0x102),(_0x5a6f59,_0x2ff5b5)=>{const _0x4d6e6f=_0x54d18a;if(validateAccess(_0x2ff5b5,_0x1acf29)[_0x4d6e6f(0x226)])confirmMessage(_0x5a6f59);else logger[_0x4d6e6f(0x25f)](_0x4d6e6f(0x176));}),_0x227e59['on'](_0x54d18a(0x134),_0x3afde7=>{const _0x5a6cbb=_0x54d18a;if(validateAccess(_0x3afde7,_0x1acf29)['allow']){if(devices[_0x1acf29][_0x5a6cbb(0x104)])clearTimeout(devices[_0x1acf29][_0x5a6cbb(0x104)]);if(devices[_0x1acf29][_0x5a6cbb(0x234)])clearTimeout(devices[_0x1acf29][_0x5a6cbb(0x234)]);removeSocketListeners(getClient(_0x227e59['id'])[_0x5a6cbb(0x11a)]),addBlacklist(_0x1acf29),devices[_0x1acf29][_0x5a6cbb(0x261)]=null,devices[_0x1acf29][_0x5a6cbb(0x177)]=null,devices[_0x1acf29][_0x5a6cbb(0x99)][_0x5a6cbb(0x16b)]=null,logger[_0x5a6cbb(0x14d)](_0x5a6cbb(0xae)+_0x1acf29[_0x5a6cbb(0xc4)](-0x8)),io['to'](getClient(_0x227e59['id'])[_0x5a6cbb(0x11a)])['emit'](_0x5a6cbb(0x259),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x5a6cbb(0x25f)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x39dbfe){const _0x540d21=_0x1e9d18,_0xb28ebd=getClient(_0x39dbfe['id'])[_0x540d21(0x154)],_0x13cc31=getClient(_0x39dbfe['id'])[_0x540d21(0x11a)];_0x39dbfe['on']('get-logs',(_0x26c147,_0x46f8d4)=>{const _0x24ee1f=_0x540d21;if(validateAccess(_0x46f8d4,_0x13cc31)[_0x24ee1f(0x226)]){if(pid[_0xb28ebd])pid[_0xb28ebd][_0x24ee1f(0x242)]({'function':_0x24ee1f(0x237),'args':_0x26c147});}else logger[_0x24ee1f(0x25f)](_0x24ee1f(0x157));}),_0x39dbfe['on'](_0x540d21(0xdb),(_0x4eda19,_0x4d9c1c)=>{const _0x458772=_0x540d21;if(validateAccess(_0x4d9c1c,_0x13cc31)[_0x458772(0x226)]){if(pid[_0xb28ebd])pid[_0xb28ebd][_0x458772(0x242)]({'function':_0x458772(0xe7),'args':_0x4eda19});}else logger[_0x458772(0x25f)](_0x458772(0xf0));}),_0x39dbfe['on'](_0x540d21(0x256),(_0x3acd1e,_0x2dcb55)=>{const _0x22940c=_0x540d21;if(validateAccess(_0x2dcb55,_0x13cc31)['allow']){if(pid[_0xb28ebd])pid[_0xb28ebd]['send']({'function':_0x22940c(0xac),'args':_0x3acd1e});}else logger[_0x22940c(0x25f)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x39dbfe['on'](_0x540d21(0x1cd),(_0x1256be,_0x5cf722)=>{const _0x2cae88=_0x540d21;if(validateAccess(_0x5cf722,_0x13cc31)[_0x2cae88(0x226)]){if(pid[_0xb28ebd])pid[_0xb28ebd][_0x2cae88(0x242)]({'function':_0x2cae88(0x194),'args':_0x1256be});}else logger[_0x2cae88(0x25f)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x39dbfe['on'](_0x540d21(0x180),(_0x2117e9,_0x182e86)=>{const _0x462448=_0x540d21;if(validateAccess(_0x182e86,_0x13cc31)['allow']){if(pid[_0xb28ebd])pid[_0xb28ebd]['send']({'function':_0x462448(0x1bd),'args':_0x2117e9});}else logger[_0x462448(0x25f)](_0x462448(0xf5));}),_0x39dbfe['on'](_0x540d21(0x1de),(_0x485f85,_0x15f60a)=>{const _0x2edc87=_0x540d21;if(validateAccess(_0x15f60a,_0x13cc31)['allow']){if(pid[_0xb28ebd])pid[_0xb28ebd][_0x2edc87(0x242)]({'function':_0x2edc87(0xb7),'args':_0x485f85});}else logger[_0x2edc87(0x25f)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x39dbfe['on'](_0x540d21(0x158),_0x38c2d2=>{const _0x27516d=_0x540d21;if(validateAccess(_0x38c2d2,_0x13cc31)[_0x27516d(0x226)]){if(pid[_0xb28ebd])pid[_0xb28ebd]['send']({'function':'resetHistory','args':null});}else logger[_0x27516d(0x25f)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x39dbfe['on'](_0x540d21(0xf4),_0xeb211c=>{const _0x323c51=_0x540d21;if(validateAccess(_0xeb211c,_0x13cc31)[_0x323c51(0x226)]){if(pid[_0xb28ebd])pid[_0xb28ebd][_0x323c51(0x242)]({'function':_0x323c51(0x14a),'args':null});}else logger[_0x323c51(0x25f)](_0x323c51(0x1a1));}),_0x39dbfe['on'](_0x540d21(0x24a),(_0x2b7f53,_0x111987)=>{const _0x232ff8=_0x540d21;if(validateAccess(_0x111987,_0x13cc31)[_0x232ff8(0x226)]){if(pid[_0xb28ebd])pid[_0xb28ebd][_0x232ff8(0x242)]({'function':'placeOrder','args':_0x2b7f53});}else logger[_0x232ff8(0x25f)](_0x232ff8(0x211));}),_0x39dbfe['on']('cancel-loading',_0x11d57e=>{const _0x232804=_0x540d21;if(validateAccess(_0x11d57e,_0x13cc31)[_0x232804(0x226)]){if(pid[_0xb28ebd])pid[_0xb28ebd]['send']({'function':'cancelLoading','args':null});}else logger[_0x232804(0x25f)](_0x232804(0xd1));}),_0x39dbfe['on']('show-config',_0xcf5988=>{const _0xe9bdb5=_0x540d21;if(validateAccess(_0xcf5988,_0x13cc31)[_0xe9bdb5(0x226)]){if(pid[_0xb28ebd])pid[_0xb28ebd][_0xe9bdb5(0x242)]({'function':'showConfig','args':null});}else logger[_0xe9bdb5(0x25f)](_0xe9bdb5(0xfe));}),_0x39dbfe['on'](_0x540d21(0x1d8),_0x50c261=>{const _0x192a24=_0x540d21;if(validateAccess(_0x50c261,_0x13cc31)[_0x192a24(0x226)])updateBB(_0x192a24(0x1e6));else logger[_0x192a24(0x25f)](_0x192a24(0x164));}),_0x39dbfe['on'](_0x540d21(0x14e),_0x142e83=>{const _0x2343db=_0x540d21;if(validateAccess(_0x142e83,_0x13cc31)[_0x2343db(0x226)])getMessages();else logger[_0x2343db(0x25f)](_0x2343db(0xea));}),_0x39dbfe['on'](_0x540d21(0x102),(_0x1029b9,_0x28a196)=>{const _0x1f6074=_0x540d21;if(validateAccess(_0x28a196,_0x13cc31)[_0x1f6074(0x226)])confirmMessage(_0x1029b9);else logger[_0x1f6074(0x25f)](_0x1f6074(0x176));}),_0x39dbfe['on']('logout',_0x7477c6=>{const _0xedb233=_0x540d21;if(validateAccess(_0x7477c6,_0x13cc31)[_0xedb233(0x226)]){if(devices[_0x13cc31][_0xedb233(0x104)])clearTimeout(devices[_0x13cc31]['pidRefreshToken']);if(devices[_0x13cc31][_0xedb233(0x234)])clearTimeout(devices[_0x13cc31]['pidExpireLogin']);removeSocketListeners(getClient(_0x39dbfe['id'])[_0xedb233(0x11a)]),addBlacklist(_0x13cc31),devices[_0x13cc31]['telegramIpApproval']=null,devices[_0x13cc31][_0xedb233(0x177)]=null,devices[_0x13cc31][_0xedb233(0x99)][_0xedb233(0x16b)]=null,logger[_0xedb233(0x14d)](_0xedb233(0xae)+_0x13cc31['slice'](-0x8)),io['to'](getClient(_0x39dbfe['id'])[_0xedb233(0x11a)])[_0xedb233(0x17d)](_0xedb233(0x259),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0xedb233(0x25f)](_0xedb233(0xa9));});}function removeSocketListeners(_0x32f1e3){const _0x31a44d=_0x1e9d18;getClientsWithUuid(_0x32f1e3)[_0x31a44d(0x1a0)](_0x121ddd=>{const _0x385717=_0x31a44d;getSocket(_0x121ddd['id'])[_0x385717(0x15a)]();});}function cleanSettings(){const _0x2b19dc=_0x1e9d18;let _0x691792=settings;return settings[_0x2b19dc(0xe4)]&&settings[_0x2b19dc(0xe4)]!=''&&(_0x691792={..._0x691792,'telegramToken':_0x2b19dc(0xc9)}),settings[_0x2b19dc(0x171)]&&settings[_0x2b19dc(0x171)]!=''&&(_0x691792={..._0x691792,'bbPassword':'************'}),(settings[_0x2b19dc(0x171)]&&settings[_0x2b19dc(0x171)]=='***'||settings[_0x2b19dc(0xe4)]&&settings[_0x2b19dc(0xe4)]==_0x2b19dc(0xa1))&&(_0x691792={..._0x691792,'restored':{'password':settings[_0x2b19dc(0x171)]==_0x2b19dc(0xa1),'telegram':settings['telegramToken']==_0x2b19dc(0xa1)}}),_0x691792;}async function updateBB(_0x46da87){const _0x1f26f1=_0x1e9d18;await backupConfigFiles(),installingUpdate=!![],config[_0x1f26f1(0x1a0)](_0x43e178=>{restartBot(_0x43e178['botID']);});if(_0x46da87==_0x1f26f1(0x1e6))process[_0x1f26f1(0x242)]({'update':!![],'environment':environment},_0x118b30=>{});else _0x46da87=='reinstall'&&process[_0x1f26f1(0x242)]({'reinstall':!![],'environment':environment},_0x5b0996=>{});}function startBot(_0x5abaaa,_0x13dcfe,_0x4227fc){const _0x2e17e9=_0x1e9d18;if(debugging)_0x5abaaa[_0x2e17e9(0x213)]('-d');let _0x32bda3=![];const _0x1db924=_0x5abaaa[0x0];_0x13dcfe={..._0x13dcfe,'stdio':[_0x2e17e9(0x1a9),_0x2e17e9(0x1a9),_0x2e17e9(0x1a9),_0x2e17e9(0x199)]},pid[_0x1db924]=childProcess[_0x2e17e9(0x131)](botfile,_0x5abaaa,_0x13dcfe),pid[_0x1db924]['on']('message',_0x333a9b=>{const _0x121625=_0x2e17e9;switch(Object[_0x121625(0x1ab)](_0x333a9b)[0x0]){case _0x121625(0x224):updateBotName(_0x1db924,_0x333a9b['botname']);break;case _0x121625(0x151):updateBotManager();break;case _0x121625(0x259):updateStatus(_0x1db924,_0x333a9b[_0x121625(0x259)]);break;case _0x121625(0x1a8):updateLive(_0x1db924,_0x333a9b[_0x121625(0x1a8)]);break;case'started':updateLive(_0x1db924,_0x333a9b[_0x121625(0x1dc)]),io['to'](_0x1db924)[_0x121625(0x17d)]('status',{'access':{'allow':![],'reason':_0x121625(0x21d),'token':null}});break;case'stop':_0x333a9b[_0x121625(0x1a5)]==_0x121625(0x1cc)&&restartBot(_0x1db924);_0x333a9b['stop']==_0x121625(0x12d)&&toggleBot(_0x1db924,_0x121625(0x254),_0x121625(0x1fd));break;case'telegram':sendTelegram(_0x1db924,_0x333a9b['telegram']);break;case _0x121625(0x185):sendTelegramMsg(_0x333a9b['telegrammsg']);break;case _0x121625(0x1f9):io['to'](_0x1db924)['emit'](_0x333a9b[_0x121625(0x1f9)],_0x333a9b[_0x121625(0x202)]);break;}}),pid[_0x1db924]['on']('error',function(_0x5b323e){if(_0x32bda3)return;_0x32bda3=!![],_0x4227fc(_0x5b323e);}),pid[_0x1db924]['on'](_0x2e17e9(0xcc),async function(_0x34cc1c){const _0x3752b7=_0x2e17e9;if(installingUpdate)return;if(_0x32bda3)return;_0x32bda3=!![],_0x4227fc(null);const _0x3af543=dbConfig['get']('bots')['find']({'botID':_0x1db924})[_0x3752b7(0xb9)]();_0x3af543&&(_0x3af543['status']==_0x3752b7(0x258)||_0x3af543['status']==_0x3752b7(0x1ef))&&(await sleep(0x3e8),updateLive(_0x1db924,'stopped'),logger[_0x3752b7(0x25f)](_0x3752b7(0x119)+_0x1db924),startBot([_0x1db924,userID],{'cwd':bbpath},function(_0x41d1e6){if(_0x41d1e6)logger['full'](_0x41d1e6);}));});}function stopBot(_0x1112a1){const _0x5f0aa6=_0x1e9d18;getClientsWithBotID(_0x1112a1)[_0x5f0aa6(0x1a0)](_0x3496b9=>{const _0x1e4007=_0x5f0aa6;getSocket(_0x3496b9['id'])[_0x1e4007(0xa4)](!![]),removeClient(_0x3496b9['id']);}),pid[_0x1112a1]&&(pid[_0x1112a1]['kill'](),pid[_0x1112a1]=null);}function restartBot(_0x3e6c60){const _0x5bb792=_0x1e9d18;if(pid[_0x3e6c60])pid[_0x3e6c60][_0x5bb792(0x12d)]();}function addBot(){const _0x55c785=_0x1e9d18;let _0x5a075c;for(let _0x35517a=0x1;_0x35517a<0x3e9;_0x35517a++){_0x5a075c=_0x35517a[_0x55c785(0x10e)]()[_0x55c785(0x19e)](0x3,'0');let _0x522060=config['find'](_0x92adc1=>_0x92adc1[_0x55c785(0x252)]==_0x5a075c);if(!_0x522060)break;}if(_0x5a075c===_0x55c785(0x1ea)){logger[_0x55c785(0x25f)](_0x55c785(0x168));return;}logger['full']('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x5a075c),dbConfig[_0x55c785(0x1db)]('bots')[_0x55c785(0x213)]({'botID':_0x5a075c,'botname':'Bot\x20'+_0x5a075c,'status':_0x55c785(0x1ef),'live':''})[_0x55c785(0x141)](),startBot([_0x5a075c,userID],{'cwd':bbpath},function(_0x12f25e){const _0x4c735d=_0x55c785;if(_0x12f25e)logger[_0x4c735d(0x25f)](_0x12f25e);}),config=getConfiguration(),io['to']('botmanager')['emit'](_0x55c785(0x12b),config),broadcastToBots('bots',JSON['stringify'](config));}function deleteBot(_0x2174fa){const _0x463d60=_0x1e9d18;getClientsWithBotID(_0x2174fa)[_0x463d60(0x1a0)](_0x474615=>{const _0x1fc094=_0x463d60;getSocket(_0x474615['id'])[_0x1fc094(0xa4)](!![]),removeClient(_0x474615['id']);}),dbConfig['get']('bots')[_0x463d60(0x17a)]({'botID':_0x2174fa})[_0x463d60(0x141)](),logger['full']('Deleted\x20Bot\x20'+_0x2174fa),stopBot(_0x2174fa);try{if(fs[_0x463d60(0x14f)](path[_0x463d60(0x20b)](configpath,'bot-'+_0x2174fa+_0x463d60(0x187))))fs[_0x463d60(0x1fb)](path['join'](configpath,_0x463d60(0xcd)+_0x2174fa+_0x463d60(0x187)));if(fs[_0x463d60(0x14f)](path[_0x463d60(0x20b)](configpath,_0x463d60(0xcd)+_0x2174fa+'-events.json')))fs[_0x463d60(0x1fb)](path['join'](configpath,_0x463d60(0xcd)+_0x2174fa+'-events.json'));if(fs['existsSync'](path[_0x463d60(0x20b)](configpath,'bot-'+_0x2174fa+'-performance.json')))fs[_0x463d60(0x1fb)](path[_0x463d60(0x20b)](configpath,_0x463d60(0xcd)+_0x2174fa+_0x463d60(0x25a)));if(fs[_0x463d60(0x14f)](path['join'](configpath,_0x463d60(0xcd)+_0x2174fa+_0x463d60(0x221))))fs[_0x463d60(0x1fb)](path['join'](configpath,_0x463d60(0xcd)+_0x2174fa+_0x463d60(0x221)));}catch(_0x8f6c71){if(_0x8f6c71)logger[_0x463d60(0x25f)](_0x463d60(0x1be),_0x8f6c71);}config=getConfiguration(),io['to'](_0x463d60(0x210))[_0x463d60(0x17d)](_0x463d60(0x12b),config),broadcastToBots(_0x463d60(0x12b),JSON[_0x463d60(0x1cf)](config));}function toggleBot(_0xa3cbc2,_0x5275c3,_0x980cc3){const _0x19ef40=_0x1e9d18;dbConfig[_0x19ef40(0x1db)](_0x19ef40(0x12b))[_0x19ef40(0x25d)]({'botID':_0xa3cbc2})[_0x19ef40(0x161)]({'status':_0x5275c3})['assign']({'live':_0x980cc3})[_0x19ef40(0x141)]();if(_0x5275c3=='enabled'||_0x5275c3==_0x19ef40(0x1ef))logger[_0x19ef40(0x25f)]('Enabled\x20Bot\x20'+_0xa3cbc2),startBot([_0xa3cbc2,userID],{'cwd':bbpath},function(_0x540806){const _0x132f6b=_0x19ef40;if(_0x540806)logger[_0x132f6b(0x25f)](_0x540806);});else(_0x5275c3==_0x19ef40(0x254)||_0x5275c3==_0x19ef40(0x1fe))&&(logger[_0x19ef40(0x25f)]('Disabled\x20Bot\x20'+_0xa3cbc2),stopBot(_0xa3cbc2));config=getConfiguration(),io['to'](_0x19ef40(0x210))[_0x19ef40(0x17d)]('bots',config),broadcastToBots(_0x19ef40(0x12b),JSON['stringify'](config));}function toggleStatus(_0x4b715d){const _0x2877b6=_0x1e9d18;let _0x460369=dbConfig[_0x2877b6(0x1db)](_0x2877b6(0x12b))[_0x2877b6(0x25d)]({'botID':_0x4b715d})[_0x2877b6(0xb9)](),_0x2eb94b;if(_0x460369['status']==='enabled')_0x2eb94b=_0x2877b6(0x254);else{if(_0x460369[_0x2877b6(0x259)]===_0x2877b6(0x1ef))_0x2eb94b=_0x2877b6(0x1fe);else{if(_0x460369[_0x2877b6(0x259)]==='new-disabled')_0x2eb94b=_0x2877b6(0x1ef);else{if(_0x460369[_0x2877b6(0x259)]===_0x2877b6(0x254))_0x2eb94b=_0x2877b6(0x258);}}}return _0x2eb94b;}function updateStatus(_0x19e6c5,_0x350294){const _0x1d8ebe=_0x1e9d18;dbConfig[_0x1d8ebe(0x1db)]('bots')[_0x1d8ebe(0x25d)]({'botID':_0x19e6c5})[_0x1d8ebe(0x161)]({'status':_0x350294})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x1d8ebe(0x17d)]('bots',config),broadcastToBots(_0x1d8ebe(0x12b),JSON['stringify'](config));}function updateLive(_0x3a409c,_0x3c8241){const _0x3df1da=_0x1e9d18;dbConfig[_0x3df1da(0x1db)](_0x3df1da(0x12b))[_0x3df1da(0x25d)]({'botID':_0x3a409c})[_0x3df1da(0x161)]({'live':_0x3c8241})['write'](),config=getConfiguration(),io['to'](_0x3df1da(0x210))['emit']('bots',config),broadcastToBots(_0x3df1da(0x12b),JSON['stringify'](config));}function updateBotName(_0x447352,_0x55e116){const _0x378960=_0x1e9d18;dbConfig['get'](_0x378960(0x12b))['find']({'botID':_0x447352})[_0x378960(0x161)]({'botname':_0x55e116})[_0x378960(0x141)](),config=getConfiguration(),io['to'](_0x378960(0x210))[_0x378960(0x17d)](_0x378960(0x12b),config),broadcastToBots(_0x378960(0x12b),JSON['stringify'](config));}function updateBotManager(){const _0x4f1669=_0x1e9d18;config=getConfiguration(),io['to'](_0x4f1669(0x210))['emit'](_0x4f1669(0x12b),config),broadcastToBots(_0x4f1669(0x12b),JSON['stringify'](config));}function toggleBotMode(_0x1abff8){const _0x5b7403=_0x1e9d18;if(pid[_0x1abff8])pid[_0x1abff8][_0x5b7403(0x242)]({'function':_0x5b7403(0x1c3),'args':null});else{const _0x280848=configpath+'bot-'+_0x1abff8+_0x5b7403(0x187),_0x25af8e=fs['readFileSync'](_0x280848),_0x209d37=JSON[_0x5b7403(0x10d)](_0x25af8e),_0x2f9851=_0x209d37[_0x5b7403(0x154)][0x0][_0x5b7403(0x1ce)];_0x209d37['bot'][0x0][_0x5b7403(0x1ce)]=!_0x2f9851;const _0x4d43dc=JSON[_0x5b7403(0x1cf)](_0x209d37,null,0x2);fs['writeFileSync'](_0x280848,_0x4d43dc),config=getConfiguration(),io['to']('botmanager')['emit'](_0x5b7403(0x12b),config),broadcastToBots(_0x5b7403(0x12b),JSON['stringify'](config));}}function telegramError(_0x6af3d2){const _0x3c2b20=_0x1e9d18;logger[_0x3c2b20(0xf8)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x3b5373){const _0x44d804=_0x1e9d18;if(_0x3b5373[_0x44d804(0x1ff)][_0x44d804(0xd3)]!=settings[_0x44d804(0x220)]&&'@'+_0x3b5373[_0x44d804(0x1ff)]['username']!=settings[_0x44d804(0x220)])return tgBot[_0x44d804(0x208)](_0x3b5373[_0x44d804(0x19a)]['id'],_0x44d804(0x1aa),{'parse_mode':_0x44d804(0x230)})['catch'](_0x15c9e1=>{telegramError(_0x15c9e1);}),![];return!![];}async function initTelegram(){const _0x4ea8bf=_0x1e9d18;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x424624='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x424624+='\x0a',_0x424624+='/enable\x20-\x20enable\x20notifications\x0a',_0x424624+='/disable\x20-\x20disable\x20notifications\x0a',_0x424624+=_0x4ea8bf(0xd4),_0x424624+=_0x4ea8bf(0x18b),_0x424624+=_0x4ea8bf(0xce),_0x424624+='/off\x20-\x20stop\x20bot(s)\x0a',_0x424624+=_0x4ea8bf(0x1df),_0x424624+=_0x4ea8bf(0x205),_0x424624+=_0x4ea8bf(0xda),_0x424624+=_0x4ea8bf(0x246),_0x424624+=_0x4ea8bf(0x1dd),_0x424624+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x424624+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x424624+=_0x4ea8bf(0x152);let _0x1b4df2=_0x4ea8bf(0x125);_0x1b4df2+='\x0a',_0x1b4df2+=_0x424624,tgBot[_0x4ea8bf(0x101)](/\/start/,_0x500089=>{const _0x379432=_0x4ea8bf;if(!validateTelegram(_0x500089))return;if(settings['telegramChatId']!=_0x500089[_0x379432(0x19a)]['id'])updateSetting(_0x379432(0x142),_0x500089['chat']['id']);updateSetting(_0x379432(0x248),!![]),tgBot[_0x379432(0x208)](_0x500089['chat']['id'],_0x1b4df2)[_0x379432(0x250)](_0x424715=>{telegramError(_0x424715);});}),tgBot[_0x4ea8bf(0x101)](/\/enable/,_0x1c2b7d=>{const _0x5608e7=_0x4ea8bf;if(!validateTelegram(_0x1c2b7d))return;if(settings[_0x5608e7(0x142)]!=_0x1c2b7d[_0x5608e7(0x19a)]['id'])updateSetting(_0x5608e7(0x142),_0x1c2b7d[_0x5608e7(0x19a)]['id']);updateSetting(_0x5608e7(0x248),!![]),tgBot[_0x5608e7(0x208)](_0x1c2b7d['chat']['id'],_0x5608e7(0x150))[_0x5608e7(0x250)](_0x531046=>{telegramError(_0x531046);});}),tgBot[_0x4ea8bf(0x101)](/\/config/,async _0x31058e=>{const _0x23412e=_0x4ea8bf;if(!validateTelegram(_0x31058e))return;tgBot['removeListener'](_0x23412e(0xb0)),tgBot[_0x23412e(0x208)](_0x31058e['chat']['id'],_0x23412e(0x16f),{'reply_markup':{'inline_keyboard':[[{'text':_0x23412e(0x23d),'callback_data':_0x23412e(0x107)},{'text':'Alerts','callback_data':_0x23412e(0x143)},{'text':_0x23412e(0x13b),'callback_data':_0x23412e(0x1f1)}]]}})['catch'](_0x35e0d9=>{telegramError(_0x35e0d9);}),tgBot['on'](_0x23412e(0xb0),async _0x8daf67=>{const _0x1d3115=_0x23412e,_0x1e4559=_0x8daf67['data'],_0xc3d6dd=_0x8daf67[_0x1d3115(0x197)];tgBot[_0x1d3115(0xaa)](_0x8daf67['id'])[_0x1d3115(0xdf)](async()=>{const _0x3375f0=_0x1d3115;_0x1e4559==_0x3375f0(0x107)&&(updateSetting(_0x3375f0(0xe3),_0x3375f0(0x107)),updateSetting(_0x3375f0(0x248),!![]),await tgBot[_0x3375f0(0x208)](_0xc3d6dd[_0x3375f0(0x19a)]['id'],_0x3375f0(0xe1))[_0x3375f0(0x250)](_0x5791ba=>{telegramError(_0x5791ba);}));_0x1e4559==_0x3375f0(0x143)&&(updateSetting('telegramEvents','alerts'),updateSetting('telegramEnabled',!![]),await tgBot[_0x3375f0(0x208)](_0xc3d6dd['chat']['id'],_0x3375f0(0x22b))[_0x3375f0(0x250)](_0x3710c4=>{telegramError(_0x3710c4);}));_0x1e4559==_0x3375f0(0x1f1)&&(updateSetting(_0x3375f0(0xe3),_0x3375f0(0x1f1)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0xc3d6dd['chat']['id'],_0x3375f0(0x113))[_0x3375f0(0x250)](_0x43bff7=>{telegramError(_0x43bff7);}));if(!settings['telegramChatId'])tgBot[_0x3375f0(0x208)](_0xc3d6dd[_0x3375f0(0x19a)]['id'],_0x3375f0(0x1ad))['catch'](_0xbe6fb8=>{telegramError(_0xbe6fb8);});}),tgBot[_0x1d3115(0x16e)]('callback_query');});}),tgBot[_0x4ea8bf(0x101)](/\/status/,_0x497617=>{const _0x265561=_0x4ea8bf;if(!validateTelegram(_0x497617))return;const _0x20c529=getBotsWithMode();let _0x2304db=_0x265561(0x20d);config['forEach'](_0x53223f=>{const _0x49098e=_0x265561,_0x4c0473=_0x20c529['find'](_0x59fde8=>_0x59fde8[_0x49098e(0x252)]==_0x53223f[_0x49098e(0x252)])[_0x49098e(0xaf)];_0x2304db+=_0x49098e(0x136)+_0x53223f[_0x49098e(0x252)]+':\x20'+_0x53223f[_0x49098e(0x259)]+_0x49098e(0x20a)+_0x4c0473+_0x49098e(0x20a)+_0x53223f[_0x49098e(0x1a8)]+'\x0a';}),_0x2304db+='\x0a',_0x2304db+=_0x265561(0xd8),_0x2304db+=!settings['telegramEnabled']?'Notifications\x20disabled\x0a':_0x265561(0x163),_0x2304db+=settings[_0x265561(0x248)]?settings[_0x265561(0xe3)]==_0x265561(0x1f1)?_0x265561(0x132):_0x265561(0x13a)+settings[_0x265561(0xe3)]+_0x265561(0xca):'',tgBot[_0x265561(0x208)](_0x497617['chat']['id'],_0x2304db,{'parse_mode':'HTML'})['catch'](_0x1d1f08=>{telegramError(_0x1d1f08);});}),tgBot[_0x4ea8bf(0x101)](/\/restart/,_0x268f2c=>{const _0x1b15fe=_0x4ea8bf;if(!validateTelegram(_0x268f2c))return;tgBot[_0x1b15fe(0x16e)](_0x1b15fe(0xb0));const _0x2cf8b0=getEnabledBots();if(_0x2cf8b0['length']==0x0)tgBot[_0x1b15fe(0x208)](_0x268f2c['chat']['id'],_0x1b15fe(0xcf))[_0x1b15fe(0x250)](_0x595a67=>{telegramError(_0x595a67);});else{if(_0x2cf8b0[_0x1b15fe(0x238)]>0x1)_0x2cf8b0[_0x1b15fe(0x213)]({'botID':_0x1b15fe(0x1f1)});let _0x38a777=[],_0x34c46e=[];const _0x5cb330=_0x2cf8b0['length']%0x4==0x0||_0x2cf8b0['length']%0x4==0x3||_0x2cf8b0[_0x1b15fe(0x238)]%0x3==0x1?0x4:0x3;let _0x13985f=0x0;_0x2cf8b0['forEach']((_0x266fb8,_0x576104)=>{const _0x47ce1a=_0x1b15fe;if(_0x576104%_0x5cb330==0x0)_0x34c46e=[];_0x34c46e[_0x47ce1a(0x213)]({'text':_0x266fb8[_0x47ce1a(0x252)]==_0x47ce1a(0x1f1)?_0x47ce1a(0xa7):_0x47ce1a(0x136)+_0x266fb8['botID'],'callback_data':_0x266fb8[_0x47ce1a(0x252)]}),_0x576104%_0x5cb330==0x0&&(_0x38a777[_0x13985f]=_0x34c46e,_0x13985f++);}),tgBot[_0x1b15fe(0x208)](_0x268f2c[_0x1b15fe(0x19a)]['id'],_0x1b15fe(0x1ca),{'reply_markup':{'inline_keyboard':_0x38a777}})[_0x1b15fe(0x250)](_0x31c292=>{telegramError(_0x31c292);}),tgBot['on'](_0x1b15fe(0xb0),async _0xcc3b77=>{const _0x4abfd9=_0x1b15fe,_0x301e5e=_0xcc3b77['data'],_0xea37a1=_0xcc3b77[_0x4abfd9(0x197)];tgBot[_0x4abfd9(0xaa)](_0xcc3b77['id'])['then'](async()=>{_0x301e5e=='all'?config['forEach'](_0x1db669=>{const _0xdada79=_0x15c0;restartBot(_0x1db669[_0xdada79(0x252)]);}):restartBot(_0x301e5e);}),tgBot[_0x4abfd9(0x16e)](_0x4abfd9(0xb0));});}}),tgBot['onText'](/\/on/,_0x954518=>{const _0x57e1e2=_0x4ea8bf;if(!validateTelegram(_0x954518))return;tgBot[_0x57e1e2(0x16e)](_0x57e1e2(0xb0));const _0x2f6087=getDisabledBots();if(_0x2f6087[_0x57e1e2(0x238)]==0x0)tgBot[_0x57e1e2(0x208)](_0x954518[_0x57e1e2(0x19a)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x57e1e2(0x250)](_0x285f27=>{telegramError(_0x285f27);});else{if(_0x2f6087['length']>0x1)_0x2f6087[_0x57e1e2(0x213)]({'botID':'all'});let _0x13dd92=[],_0x494455=[];const _0x40906f=_0x2f6087[_0x57e1e2(0x238)]%0x4==0x0||_0x2f6087['length']%0x4==0x3||_0x2f6087[_0x57e1e2(0x238)]%0x3==0x1?0x4:0x3;let _0x297720=0x0;_0x2f6087[_0x57e1e2(0x1a0)]((_0x32224e,_0xb6c3bc)=>{const _0x8d8473=_0x57e1e2;if(_0xb6c3bc%_0x40906f==0x0)_0x494455=[];_0x494455[_0x8d8473(0x213)]({'text':_0x32224e[_0x8d8473(0x252)]==_0x8d8473(0x1f1)?_0x8d8473(0xa7):'Bot\x20'+_0x32224e['botID'],'callback_data':_0x32224e['botID']}),_0xb6c3bc%_0x40906f==0x0&&(_0x13dd92[_0x297720]=_0x494455,_0x297720++);}),tgBot[_0x57e1e2(0x208)](_0x954518[_0x57e1e2(0x19a)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x13dd92}})[_0x57e1e2(0x250)](_0x7a409b=>{telegramError(_0x7a409b);}),tgBot['on'](_0x57e1e2(0xb0),async _0x18f14e=>{const _0x32ec5d=_0x57e1e2,_0x47bd52=_0x18f14e[_0x32ec5d(0x130)],_0x339ed0=_0x18f14e['message'];tgBot[_0x32ec5d(0xaa)](_0x18f14e['id'])['then'](async()=>{const _0x507350=_0x32ec5d;_0x47bd52==_0x507350(0x1f1)?(tgBot[_0x507350(0x208)](_0x339ed0['chat']['id'],_0x507350(0x22f))['catch'](_0x14dce7=>{telegramError(_0x14dce7);}),_0x2f6087[_0x507350(0x1a0)](_0x27eb9d=>{const _0x198503=_0x507350;if(_0x27eb9d['botID']!='all')toggleBot(_0x27eb9d[_0x198503(0x252)],toggleStatus(_0x27eb9d[_0x198503(0x252)]),_0x198503(0x1fd));})):(tgBot['sendMessage'](_0x339ed0[_0x507350(0x19a)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x47bd52)[_0x507350(0x250)](_0x5f146e=>{telegramError(_0x5f146e);}),toggleBot(_0x47bd52,toggleStatus(_0x47bd52),_0x507350(0x1fd)));}),tgBot[_0x32ec5d(0x16e)](_0x32ec5d(0xb0));});}}),tgBot['onText'](/\/off/,_0x349153=>{const _0x405129=_0x4ea8bf;if(!validateTelegram(_0x349153))return;tgBot[_0x405129(0x16e)]('callback_query');const _0x4f5b07=getEnabledBots();if(_0x4f5b07[_0x405129(0x238)]==0x0)tgBot[_0x405129(0x208)](_0x349153[_0x405129(0x19a)]['id'],_0x405129(0xcf))[_0x405129(0x250)](_0xdddc93=>{telegramError(_0xdddc93);});else{if(_0x4f5b07[_0x405129(0x238)]>0x1)_0x4f5b07[_0x405129(0x213)]({'botID':_0x405129(0x1f1)});let _0x117817=[],_0x3df991=[];const _0x294a97=_0x4f5b07[_0x405129(0x238)]%0x4==0x0||_0x4f5b07[_0x405129(0x238)]%0x4==0x3||_0x4f5b07[_0x405129(0x238)]%0x3==0x1?0x4:0x3;let _0x5a0b7e=0x0;_0x4f5b07[_0x405129(0x1a0)]((_0x2a53ed,_0x1ddad9)=>{const _0x15d46c=_0x405129;if(_0x1ddad9%_0x294a97==0x0)_0x3df991=[];_0x3df991['push']({'text':_0x2a53ed[_0x15d46c(0x252)]==_0x15d46c(0x1f1)?'All\x20bots':_0x15d46c(0x136)+_0x2a53ed['botID'],'callback_data':_0x2a53ed[_0x15d46c(0x252)]}),_0x1ddad9%_0x294a97==0x0&&(_0x117817[_0x5a0b7e]=_0x3df991,_0x5a0b7e++);}),tgBot[_0x405129(0x208)](_0x349153[_0x405129(0x19a)]['id'],_0x405129(0x184),{'reply_markup':{'inline_keyboard':_0x117817}})[_0x405129(0x250)](_0x86e8b9=>{telegramError(_0x86e8b9);}),tgBot['on'](_0x405129(0xb0),async _0x596e63=>{const _0x4dd1b2=_0x405129,_0x4eccc6=_0x596e63[_0x4dd1b2(0x130)],_0x47fc14=_0x596e63[_0x4dd1b2(0x197)];tgBot[_0x4dd1b2(0xaa)](_0x596e63['id'])['then'](async()=>{const _0x4ee445=_0x4dd1b2;_0x4eccc6==_0x4ee445(0x1f1)?(tgBot['sendMessage'](_0x47fc14[_0x4ee445(0x19a)]['id'],_0x4ee445(0x25c))[_0x4ee445(0x250)](_0x33af2e=>{telegramError(_0x33af2e);}),_0x4f5b07['forEach'](_0x1d870a=>{const _0xceffb2=_0x4ee445;if(_0x1d870a[_0xceffb2(0x252)]!=_0xceffb2(0x1f1))toggleBot(_0x1d870a[_0xceffb2(0x252)],toggleStatus(_0x1d870a[_0xceffb2(0x252)]),_0xceffb2(0x1fd));})):(tgBot[_0x4ee445(0x208)](_0x47fc14[_0x4ee445(0x19a)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x4eccc6)[_0x4ee445(0x250)](_0x1f6518=>{telegramError(_0x1f6518);}),toggleBot(_0x4eccc6,toggleStatus(_0x4eccc6),'stopped'));}),tgBot[_0x4dd1b2(0x16e)](_0x4dd1b2(0xb0));});}}),tgBot[_0x4ea8bf(0x101)](/\/metrics/,_0x5ead69=>{const _0x496c4c=_0x4ea8bf;if(!validateTelegram(_0x5ead69))return;tgBot[_0x496c4c(0x16e)](_0x496c4c(0xb0));const _0x7a55f0=getEnabledBots();if(_0x7a55f0['length']==0x0)tgBot[_0x496c4c(0x208)](_0x5ead69[_0x496c4c(0x19a)]['id'],_0x496c4c(0xcf))[_0x496c4c(0x250)](_0x42b252=>{telegramError(_0x42b252);});else{if(_0x7a55f0[_0x496c4c(0x238)]>0x1){let _0x44b5d2=[],_0x3b02b5=[];const _0x689084=_0x7a55f0[_0x496c4c(0x238)]%0x4==0x0||_0x7a55f0[_0x496c4c(0x238)]%0x4==0x3||_0x7a55f0[_0x496c4c(0x238)]%0x3==0x1?0x4:0x3;let _0x3a0b5e=0x0;_0x7a55f0[_0x496c4c(0x1a0)]((_0x1b1fd9,_0x18bb2a)=>{const _0x265f01=_0x496c4c;if(_0x18bb2a%_0x689084==0x0)_0x3b02b5=[];_0x3b02b5[_0x265f01(0x213)]({'text':_0x265f01(0x136)+_0x1b1fd9[_0x265f01(0x252)],'callback_data':_0x1b1fd9[_0x265f01(0x252)]}),_0x18bb2a%_0x689084==0x0&&(_0x44b5d2[_0x3a0b5e]=_0x3b02b5,_0x3a0b5e++);}),tgBot[_0x496c4c(0x208)](_0x5ead69['chat']['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x44b5d2}})['catch'](_0x260a8e=>{telegramError(_0x260a8e);}),tgBot['on']('callback_query',async _0x30706a=>{const _0x5e3c29=_0x496c4c,_0x161370=_0x30706a[_0x5e3c29(0x130)],_0x2f6fe0=_0x30706a[_0x5e3c29(0x197)];tgBot['answerCallbackQuery'](_0x30706a['id'])[_0x5e3c29(0xdf)](async()=>{const _0xa77ee0=_0x5e3c29;if(pid[_0x161370])pid[_0x161370][_0xa77ee0(0x242)]({'function':_0xa77ee0(0x97),'args':null});}),tgBot[_0x5e3c29(0x16e)]('callback_query');});}else{const _0x5c83b9=_0x7a55f0[0x0][_0x496c4c(0x252)];if(pid[_0x5c83b9])pid[_0x5c83b9][_0x496c4c(0x242)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x4ea8bf(0x101)](/\/portfolio/,_0x387f9d=>{const _0x388ea4=_0x4ea8bf;if(!validateTelegram(_0x387f9d))return;tgBot[_0x388ea4(0x16e)](_0x388ea4(0xb0));const _0x2e5378=getEnabledBots();if(_0x2e5378['length']==0x0)tgBot[_0x388ea4(0x208)](_0x387f9d[_0x388ea4(0x19a)]['id'],_0x388ea4(0xcf))[_0x388ea4(0x250)](_0x5471ee=>{telegramError(_0x5471ee);});else{if(_0x2e5378[_0x388ea4(0x238)]>0x1){let _0x535f88=[],_0x47a33d=[];const _0x1e86e8=_0x2e5378[_0x388ea4(0x238)]%0x4==0x0||_0x2e5378[_0x388ea4(0x238)]%0x4==0x3||_0x2e5378['length']%0x3==0x1?0x4:0x3;let _0x247847=0x0;_0x2e5378[_0x388ea4(0x1a0)]((_0x305b34,_0x2b9101)=>{const _0x45f8f6=_0x388ea4;if(_0x2b9101%_0x1e86e8==0x0)_0x47a33d=[];_0x47a33d[_0x45f8f6(0x213)]({'text':_0x45f8f6(0x136)+_0x305b34[_0x45f8f6(0x252)],'callback_data':_0x305b34[_0x45f8f6(0x252)]}),_0x2b9101%_0x1e86e8==0x0&&(_0x535f88[_0x247847]=_0x47a33d,_0x247847++);}),tgBot['sendMessage'](_0x387f9d[_0x388ea4(0x19a)]['id'],_0x388ea4(0x1c8),{'reply_markup':{'inline_keyboard':_0x535f88}})['catch'](_0x930829=>{telegramError(_0x930829);}),tgBot['on'](_0x388ea4(0xb0),async _0x5863fd=>{const _0x14bcd4=_0x388ea4,_0x31fd41=_0x5863fd['data'],_0x28a3bb=_0x5863fd['message'];tgBot[_0x14bcd4(0xaa)](_0x5863fd['id'])[_0x14bcd4(0xdf)](async()=>{if(pid[_0x31fd41])pid[_0x31fd41]['send']({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x14bcd4(0x16e)]('callback_query');});}else{const _0x3f401d=_0x2e5378[0x0]['botID'];if(pid[_0x3f401d])pid[_0x3f401d][_0x388ea4(0x242)]({'function':_0x388ea4(0x15c),'args':null});}}}),tgBot[_0x4ea8bf(0x101)](/\/update/,async _0x397f5a=>{const _0x300c18=_0x4ea8bf;if(!validateTelegram(_0x397f5a))return;tgBot[_0x300c18(0x16e)](_0x300c18(0xb0)),await getMessages();if(!updateAvailable)tgBot['sendMessage'](_0x397f5a['chat']['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x300c18(0x250)](_0x55e3b3=>{telegramError(_0x55e3b3);});else!validInstallation?tgBot['sendMessage'](_0x397f5a[_0x300c18(0x19a)]['id'],_0x300c18(0x1bf))[_0x300c18(0x250)](_0x1f5f42=>{telegramError(_0x1f5f42);}):(tgBot[_0x300c18(0x208)](_0x397f5a[_0x300c18(0x19a)]['id'],_0x300c18(0x232),{'reply_markup':{'inline_keyboard':[[{'text':_0x300c18(0x21a),'callback_data':_0x300c18(0xfd)},{'text':'No','callback_data':'no'}]]}})[_0x300c18(0x250)](_0x47a29c=>{telegramError(_0x47a29c);}),tgBot['on']('callback_query',async _0x2f5025=>{const _0x5c3bf9=_0x300c18,_0x40fcd1=_0x2f5025[_0x5c3bf9(0x130)],_0x57524d=_0x2f5025[_0x5c3bf9(0x197)];tgBot[_0x5c3bf9(0xaa)](_0x2f5025['id'])['then'](async()=>{const _0x410a29=_0x5c3bf9;_0x40fcd1==_0x410a29(0xfd)&&(await tgBot[_0x410a29(0x208)](_0x57524d[_0x410a29(0x19a)]['id'],'Starting\x20Balance\x20Bot\x20update')[_0x410a29(0x250)](_0x3d5719=>{telegramError(_0x3d5719);}),updateBB(_0x410a29(0x1e6))),_0x40fcd1=='no'&&await tgBot[_0x410a29(0x208)](_0x57524d['chat']['id'],_0x410a29(0x1a2))['catch'](_0xcac8d4=>{telegramError(_0xcac8d4);});}),tgBot[_0x5c3bf9(0x16e)](_0x5c3bf9(0xb0));}));}),tgBot[_0x4ea8bf(0x101)](/\/reinstall/,async _0x12daa7=>{const _0x29d936=_0x4ea8bf;if(!validateTelegram(_0x12daa7))return;tgBot[_0x29d936(0x16e)](_0x29d936(0xb0)),!validInstallation?tgBot['sendMessage'](_0x12daa7[_0x29d936(0x19a)]['id'],_0x29d936(0x21c))[_0x29d936(0x250)](_0xaccc9a=>{telegramError(_0xaccc9a);}):(tgBot['sendMessage'](_0x12daa7[_0x29d936(0x19a)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x29d936(0x21a),'callback_data':_0x29d936(0xfd)},{'text':'No','callback_data':'no'}]]}})[_0x29d936(0x250)](_0x3eac24=>{telegramError(_0x3eac24);}),tgBot['on'](_0x29d936(0xb0),async _0x3262d4=>{const _0x5e44a1=_0x29d936,_0x203d51=_0x3262d4[_0x5e44a1(0x130)],_0x12c9f4=_0x3262d4['message'];tgBot['answerCallbackQuery'](_0x3262d4['id'])['then'](async()=>{const _0x4724db=_0x5e44a1;_0x203d51==_0x4724db(0xfd)&&(await tgBot['sendMessage'](_0x12c9f4[_0x4724db(0x19a)]['id'],_0x4724db(0x253))[_0x4724db(0x250)](_0x1eb978=>{telegramError(_0x1eb978);}),updateBB(_0x4724db(0x10f))),_0x203d51=='no'&&await tgBot[_0x4724db(0x208)](_0x12c9f4[_0x4724db(0x19a)]['id'],_0x4724db(0x25e))[_0x4724db(0x250)](_0x3f26c9=>{telegramError(_0x3f26c9);});}),tgBot[_0x5e44a1(0x16e)](_0x5e44a1(0xb0));}));}),tgBot[_0x4ea8bf(0x101)](/\/toggle/,_0x2e5725=>{const _0x540959=_0x4ea8bf;if(!validateTelegram(_0x2e5725))return;tgBot[_0x540959(0x16e)]('callback_query');const _0xd07042=getBotsWithMode();if(_0xd07042[_0x540959(0x238)]==0x0)tgBot[_0x540959(0x208)](_0x2e5725['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x540959(0x250)](_0x318010=>{telegramError(_0x318010);});else{let _0x365a0a=[],_0x9b232a=[];const _0x150fb1=0x2;let _0x1e413a=0x0;_0xd07042[_0x540959(0x1a0)]((_0x38718b,_0x41b680)=>{const _0x30926d=_0x540959;if(_0x41b680%_0x150fb1==0x0)_0x9b232a=[];_0x9b232a[_0x30926d(0x213)]({'text':_0x30926d(0x136)+_0x38718b[_0x30926d(0x252)]+'\x20('+_0x38718b['mode']+')','callback_data':_0x38718b[_0x30926d(0x252)]}),_0x41b680%_0x150fb1==0x0&&(_0x365a0a[_0x1e413a]=_0x9b232a,_0x1e413a++);}),tgBot[_0x540959(0x208)](_0x2e5725[_0x540959(0x19a)]['id'],_0x540959(0x25b),{'reply_markup':{'inline_keyboard':_0x365a0a}})[_0x540959(0x250)](_0x2417df=>{telegramError(_0x2417df);}),tgBot['on'](_0x540959(0xb0),async _0x3472f1=>{const _0x463442=_0x540959,_0x43e47a=_0x3472f1[_0x463442(0x130)],_0x255a9f=_0x3472f1[_0x463442(0x197)];tgBot[_0x463442(0xaa)](_0x3472f1['id'])[_0x463442(0xdf)](async()=>{const _0x2b91f1=_0x463442,_0x78c354=_0xd07042[_0x2b91f1(0x25d)](_0x280c62=>_0x280c62[_0x2b91f1(0x252)]==_0x43e47a),_0x1b400f=_0x78c354[_0x2b91f1(0xaf)]==_0x2b91f1(0x190)?'manual':_0x2b91f1(0x190);tgBot[_0x2b91f1(0x208)](_0x255a9f[_0x2b91f1(0x19a)]['id'],_0x2b91f1(0x144)+_0x43e47a+'\x20to\x20'+_0x1b400f+'\x20mode')['catch'](_0x2f527b=>{telegramError(_0x2f527b);}),toggleBotMode(_0x43e47a);}),tgBot[_0x463442(0x16e)](_0x463442(0xb0));});}}),tgBot[_0x4ea8bf(0x101)](/\/names/,_0x512215=>{const _0x2a4da1=_0x4ea8bf;if(!validateTelegram(_0x512215))return;let _0x44fad5='';config['forEach'](_0x122561=>{const _0x48d85c=_0x15c0;_0x44fad5+=_0x48d85c(0x136)+_0x122561[_0x48d85c(0x252)]+':\x20'+_0x122561[_0x48d85c(0x224)]+'\x0a';}),tgBot['sendMessage'](_0x512215['chat']['id'],_0x44fad5,{'parse_mode':_0x2a4da1(0x230)})[_0x2a4da1(0x250)](_0x281edd=>{telegramError(_0x281edd);});}),tgBot['onText'](/\/disable/,_0x299416=>{const _0x5338ea=_0x4ea8bf;if(!validateTelegram(_0x299416))return;tgBot[_0x5338ea(0x208)](_0x299416[_0x5338ea(0x19a)]['id'],_0x5338ea(0x23a))['catch'](_0x13861b=>{telegramError(_0x13861b);}),updateSetting(_0x5338ea(0x248),![]);}),tgBot[_0x4ea8bf(0x101)](/\/help/,_0x2b4fa0=>{const _0xf121c8=_0x4ea8bf;if(!validateTelegram(_0x2b4fa0))return;tgBot[_0xf121c8(0x208)](_0x2b4fa0[_0xf121c8(0x19a)]['id'],_0x424624)['catch'](_0x215245=>{telegramError(_0x215245);});}),tgBot['on']('polling_error',_0x5953ef=>{const _0x47e3cc=_0x4ea8bf;_0x5953ef[_0x47e3cc(0x10e)]()[_0x47e3cc(0x22c)](_0x47e3cc(0x11e))&&(logger[_0x47e3cc(0x25f)]('Invalid\x20Telegram\x20token'),tgBot[_0x47e3cc(0x12e)](),tgBot=null,io['to'](_0x47e3cc(0x210))['emit'](_0x47e3cc(0xc1),'Invalid\x20Telegram\x20token'));}),process[_0x4ea8bf(0xbc)](_0x4ea8bf(0xbf),()=>{const _0x6b74dc=_0x4ea8bf;if(tgBot)tgBot[_0x6b74dc(0x12e)]();process[_0x6b74dc(0xcc)](0x1);}),process[_0x4ea8bf(0xbc)](_0x4ea8bf(0x1c0),()=>{const _0x529301=_0x4ea8bf;if(tgBot)tgBot[_0x529301(0x12e)]();process[_0x529301(0xcc)](0x1);});}}function disableTelegram(){const _0x53f7cf=_0x1e9d18;tgBot&&(tgBot[_0x53f7cf(0x12e)](),tgBot=null);}function sendTelegram(_0x2db295,_0x2e14dd){const _0x1c30bd=_0x1e9d18;if(settings[_0x1c30bd(0x248)]){if(settings[_0x1c30bd(0xe3)]=='all'||(_0x2e14dd[_0x1c30bd(0x17b)]==_0x1c30bd(0x229)||_0x2e14dd['type']==_0x1c30bd(0x1bb)||_0x2e14dd[_0x1c30bd(0x17b)]==_0x1c30bd(0x1bc))&&settings[_0x1c30bd(0xe3)]==_0x1c30bd(0x143)||_0x2e14dd[_0x1c30bd(0x17b)]==_0x1c30bd(0xfb)&&settings[_0x1c30bd(0xe3)]=='orders'){if(tgBot&&settings[_0x1c30bd(0x142)]){if(_0x2e14dd['showname'])tgBot[_0x1c30bd(0x208)](settings[_0x1c30bd(0x142)],_0x2e14dd['botname']+_0x1c30bd(0xa0)+_0x2e14dd[_0x1c30bd(0x191)])[_0x1c30bd(0x250)](_0x9797e=>{telegramError(_0x9797e);});else tgBot[_0x1c30bd(0x208)](settings[_0x1c30bd(0x142)],_0x1c30bd(0x136)+_0x2db295+_0x1c30bd(0xa0)+_0x2e14dd[_0x1c30bd(0x191)])[_0x1c30bd(0x250)](_0x418e29=>{telegramError(_0x418e29);});}}}}async function sendTelegramMsg(_0x471768,_0x2f415a=_0x1e9d18(0x230)){const _0x294ecb=_0x1e9d18;return settings[_0x294ecb(0x248)]&&tgBot&&settings[_0x294ecb(0x142)]?(await tgBot[_0x294ecb(0x208)](settings[_0x294ecb(0x142)],_0x471768,{'parse_mode':_0x2f415a})[_0x294ecb(0x250)](_0x2b09dc=>{telegramError(_0x2b09dc);}),!![]):![];}function getDeviceWithIp(_0x28e943){return devices['find'](_0x457df8=>_0x457df8['ip']===_0x28e943);}function temporaryAccess2FA(_0x5dc967,_0x3f3437){const _0x5aead2=_0x1e9d18;let _0x4d55ce=new Date(),_0x989c5d=![];if(lastIpApproval){if(_0x4d55ce-lastIpApproval<0x1388)_0x989c5d=!![];}lastIpApproval=new Date();if(_0x989c5d)return;tgBot&&settings[_0x5aead2(0x142)]&&(tgBot['removeListener'](_0x5aead2(0xb0)),tgBot[_0x5aead2(0x208)](settings[_0x5aead2(0x142)],_0x5aead2(0xab)+normalizeIP(_0x3f3437)['show']+_0x5aead2(0x108),{'parse_mode':_0x5aead2(0x230),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x5aead2(0x156),'callback_data':'30'},{'text':_0x5aead2(0x12c),'callback_data':_0x5aead2(0x12c)}]]}})['catch'](_0x143a4c=>{telegramError(_0x143a4c);}),tgBot['on']('callback_query',async _0x8f4060=>{const _0x9f7bc4=_0x5aead2,_0x39a1cd=_0x8f4060[_0x9f7bc4(0x130)],_0x42e0cf=_0x8f4060[_0x9f7bc4(0x197)];tgBot[_0x9f7bc4(0xaa)](_0x8f4060['id'])[_0x9f7bc4(0xdf)](async()=>{const _0x234ffd=_0x9f7bc4;devices[_0x5dc967][_0x234ffd(0x261)]={'clientip':_0x3f3437,'timestamp':new Date()[_0x234ffd(0x235)](),'expiry':_0x39a1cd},_0x39a1cd!=_0x234ffd(0x12c)?(await tgBot['sendMessage'](_0x42e0cf['chat']['id'],'Access\x20enabled\x20for\x20'+_0x39a1cd+_0x234ffd(0x222),{'parse_mode':_0x234ffd(0x230)})['catch'](_0x32cda5=>{telegramError(_0x32cda5);}),io['to'](_0x5dc967)['emit'](_0x234ffd(0x259),{'access':{'allow':![],'reason':_0x234ffd(0x21d),'token':null}})):(await tgBot[_0x234ffd(0x208)](_0x42e0cf[_0x234ffd(0x19a)]['id'],'Temporary\x20access\x20rejected')[_0x234ffd(0x250)](_0x5871ff=>{telegramError(_0x5871ff);}),io['to'](_0x5dc967)[_0x234ffd(0x17d)](_0x234ffd(0x259),{'access':{'allow':![],'reason':_0x234ffd(0x244),'token':null}}));}),tgBot[_0x9f7bc4(0x16e)](_0x9f7bc4(0xb0));}));}function loginAccess2FA(_0xf3663,_0x1bbb06){const _0x45ed23=_0x1e9d18;tgBot&&settings[_0x45ed23(0x142)]&&(tgBot['removeListener']('callback_query'),tgBot[_0x45ed23(0x208)](settings[_0x45ed23(0x142)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x1bbb06)[_0x45ed23(0x227)]+_0x45ed23(0x108),{'parse_mode':_0x45ed23(0x230),'reply_markup':{'inline_keyboard':[[{'text':_0x45ed23(0x257),'callback_data':loginExpiry},{'text':_0x45ed23(0x12c),'callback_data':_0x45ed23(0x12c)}]]}})[_0x45ed23(0x250)](_0xb5bcdf=>{telegramError(_0xb5bcdf);}),tgBot['on'](_0x45ed23(0xb0),async _0x5bddae=>{const _0x3d6fb9=_0x45ed23,_0x1538cd=_0x5bddae['data'],_0x16f1f6=_0x5bddae[_0x3d6fb9(0x197)];tgBot[_0x3d6fb9(0xaa)](_0x5bddae['id'])[_0x3d6fb9(0xdf)](async()=>{const _0x2fd177=_0x3d6fb9;devices[_0xf3663][_0x2fd177(0x177)]={'clientip':_0x1bbb06,'timestamp':new Date()[_0x2fd177(0x235)](),'expiry':_0x1538cd},_0x1538cd!=_0x2fd177(0x12c)?(await tgBot[_0x2fd177(0x208)](_0x16f1f6[_0x2fd177(0x19a)]['id'],_0x2fd177(0xbb),{'parse_mode':_0x2fd177(0x230)})[_0x2fd177(0x250)](_0x2b8627=>{telegramError(_0x2b8627);}),io['to'](_0xf3663)[_0x2fd177(0x17d)]('status',{'access':{'allow':![],'reason':_0x2fd177(0x21d),'token':null}})):(await tgBot[_0x2fd177(0x208)](_0x16f1f6[_0x2fd177(0x19a)]['id'],_0x2fd177(0x105))['catch'](_0x1cdabb=>{telegramError(_0x1cdabb);}),io['to'](_0xf3663)['emit'](_0x2fd177(0x259),{'access':{'allow':![],'reason':_0x2fd177(0x114),'token':null}}));}),tgBot['removeListener'](_0x3d6fb9(0xb0));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x35ef35=_0x1e9d18;return dbConfig['get'](_0x35ef35(0x12b))[_0x35ef35(0x139)](_0x35ef35(0x252))[_0x35ef35(0xef)]({'status':_0x35ef35(0x258)})['value']()||[];}function _0x15c0(_0x1f10a9,_0x180293){const _0x3b4d17=_0x2093();return _0x15c0=function(_0x1e8ca6,_0x502628){_0x1e8ca6=_0x1e8ca6-0x95;let _0x209308=_0x3b4d17[_0x1e8ca6];return _0x209308;},_0x15c0(_0x1f10a9,_0x180293);}function getDisabledBots(){const _0x4ba71c=_0x1e9d18;return dbConfig['get'](_0x4ba71c(0x12b))[_0x4ba71c(0x139)]('botID')['filter']({'status':_0x4ba71c(0x254)})[_0x4ba71c(0xb9)]()||[];}function getBotAttributes(_0x2878d6){const _0x1bd1d9=_0x1e9d18;let _0x20d62c={};const _0x5d71d8=configpath+_0x1bd1d9(0xcd)+_0x2878d6+'-config.json',_0x29a60b=fs['existsSync'](_0x5d71d8);if(_0x29a60b){const _0x26af43=fs['readFileSync'](_0x5d71d8);try{const _0x36a242=JSON[_0x1bd1d9(0x10d)](_0x26af43),_0x8ce8ff=_0x36a242?_0x36a242[_0x1bd1d9(0x154)][0x0][_0x1bd1d9(0x1ce)]:![];_0x20d62c[_0x1bd1d9(0xaf)]=_0x8ce8ff?_0x1bd1d9(0x190):_0x1bd1d9(0x109),_0x20d62c[_0x1bd1d9(0x224)]=_0x36a242?_0x36a242[_0x1bd1d9(0x154)][0x0][_0x1bd1d9(0x224)]:_0x1bd1d9(0x136)+_0x2878d6;}catch(_0x3e4b80){_0x20d62c[_0x1bd1d9(0xaf)]=_0x1bd1d9(0x109),_0x20d62c[_0x1bd1d9(0x224)]=_0x1bd1d9(0x136)+_0x2878d6;}}else _0x20d62c[_0x1bd1d9(0xaf)]=_0x1bd1d9(0x109),_0x20d62c[_0x1bd1d9(0x224)]=_0x1bd1d9(0x136)+_0x2878d6;return _0x20d62c;}function getBotsWithMode(){const _0x3fab29=_0x1e9d18,_0x14d5b8=dbConfig[_0x3fab29(0x1db)]('bots')[_0x3fab29(0x139)](_0x3fab29(0x252))[_0x3fab29(0xb9)]()||[];return _0x14d5b8['forEach'](_0x3afd68=>{const _0x45442b=_0x3fab29;let _0x9b5c75=getBotAttributes(_0x3afd68[_0x45442b(0x252)]);_0x3afd68[_0x45442b(0xaf)]=_0x9b5c75[_0x45442b(0xaf)];}),_0x14d5b8;}function getBotExchanges(){const _0x1dfb12=_0x1e9d18;let _0x102a31=[];const _0x7c60ee=dbConfig[_0x1dfb12(0x1db)]('bots')[_0x1dfb12(0x139)]('botID')['value']()||[];_0x7c60ee[_0x1dfb12(0x1a0)](_0x612102=>{const _0x59bcf9=_0x1dfb12;if(_0x612102[_0x59bcf9(0x259)]==_0x59bcf9(0x258)){const _0x14b00d=configpath+_0x59bcf9(0xcd)+_0x612102[_0x59bcf9(0x252)]+_0x59bcf9(0x187),_0x17d301=fs[_0x59bcf9(0x14f)](_0x14b00d);let _0x1f4fbb;if(_0x17d301){const _0x3cbe26=fs['readFileSync'](_0x14b00d);try{const _0x4324eb=JSON[_0x59bcf9(0x10d)](_0x3cbe26);_0x1f4fbb=_0x4324eb?_0x4324eb['bot'][0x0]['exchange']:null;}catch(_0x4f7adb){}}if(_0x1f4fbb)_0x102a31[_0x59bcf9(0x213)](_0x1f4fbb);}});const _0xacff23=[...new Set(_0x102a31)][_0x1dfb12(0x1d0)]();return _0xacff23;}async function initUser(){const _0x5bf315=_0x1e9d18;if(!settings[_0x5bf315(0x155)]){const _0x5f1618=uuidRandom();mixpanel[_0x5bf315(0x1f7)](_0x5f1618),updateSetting(_0x5bf315(0x155),_0x5f1618);}}async function initSecure(){const _0x1ffbfe=_0x1e9d18;let _0x49d733=getSecure();if(!_0x49d733[_0x1ffbfe(0x24e)]('secret')){let _0x3e09d8=await generateKeys();_0x49d733[_0x1ffbfe(0x11f)]=_0x3e09d8[_0x1ffbfe(0x11f)],_0x49d733[_0x1ffbfe(0xd9)]=_0x3e09d8[_0x1ffbfe(0xd9)],_0x49d733[_0x1ffbfe(0x18c)]=crypto[_0x1ffbfe(0x1c9)](0x20)['toString'](_0x1ffbfe(0x1d3));;storeSecure(_0x49d733);}}function getSettings(){const _0x40eca1=_0x1e9d18;return dbSettings['get'](_0x40eca1(0xe8))[_0x40eca1(0xb9)]()||{};}function getSecure(){const _0x5685d7=_0x1e9d18;return dbSecure[_0x5685d7(0x1db)]('secure')[_0x5685d7(0xb9)]()||{};}function getBlacklist(){const _0x2917a9=_0x1e9d18;return dbSecure['get'](_0x2917a9(0x20f))[_0x2917a9(0xb9)]()||[];}function broadcastToBots(_0x4a2c65,_0x49e505){const _0x27c0f4=_0x1e9d18;config[_0x27c0f4(0x1a0)](_0x3e8cf7=>{const _0x5a34f3=_0x27c0f4;if(_0x3e8cf7[_0x5a34f3(0x259)]==_0x5a34f3(0x258)&&_0x3e8cf7[_0x5a34f3(0x1a8)]==_0x5a34f3(0xf1)||_0x3e8cf7[_0x5a34f3(0x259)]==_0x5a34f3(0x1ef)&&_0x3e8cf7[_0x5a34f3(0x1a8)]==_0x5a34f3(0xf1)){if(pid[_0x3e8cf7[_0x5a34f3(0x252)]])pid[_0x3e8cf7[_0x5a34f3(0x252)]][_0x5a34f3(0x242)]({[_0x4a2c65]:_0x49e505});}});}function storeSettings(_0x15cfd3,_0xdaa6a=![]){const _0x1ddf32=_0x1e9d18;_0x15cfd3={...settings,..._0x15cfd3};if(_0xdaa6a&&_0x15cfd3[_0x1ddf32(0x171)]!=_0x1ddf32(0xc9)&&_0x15cfd3[_0x1ddf32(0x171)]!='***'&&_0x15cfd3[_0x1ddf32(0x171)]!=''){const _0x327e98=crypt[_0x1ddf32(0x146)](secure[_0x1ddf32(0xd9)],_0x15cfd3[_0x1ddf32(0x171)])['message'][_0x1ddf32(0x18d)]('@')[0x0],_0x13cadc=bcrypt['hashSync'](_0x327e98,saltRounds);_0x15cfd3={..._0x15cfd3,'bbPassword':_0x13cadc};}if(_0xdaa6a&&_0x15cfd3[_0x1ddf32(0xe4)]!=_0x1ddf32(0xc9)&&_0x15cfd3['telegramToken']!=_0x1ddf32(0xa1)&&_0x15cfd3['telegramToken']!=''){const _0x12369a=crypt['decrypt'](secure[_0x1ddf32(0xd9)],_0x15cfd3[_0x1ddf32(0xe4)])[_0x1ddf32(0x197)][_0x1ddf32(0x18d)]('@')[0x0];_0x15cfd3={..._0x15cfd3,'telegramToken':_0x12369a};}const _0x18f939=_0x15cfd3[_0x1ddf32(0xe4)]!=_0x1ddf32(0xc9)&&_0x15cfd3[_0x1ddf32(0xe4)]!=settings[_0x1ddf32(0xe4)]||_0x15cfd3[_0x1ddf32(0x220)]!=settings['telegramUsername'],_0x5c0c98=_0x15cfd3[_0x1ddf32(0xe4)]==''||_0x15cfd3[_0x1ddf32(0x220)]=='';if(_0x18f939)_0x15cfd3[_0x1ddf32(0xe3)]='all';for(const [_0x4b96ae,_0x249847]of Object['entries'](_0x15cfd3)){if(_0x4b96ae==_0x1ddf32(0xe4)&&_0x249847==_0x1ddf32(0xc9)){_0x15cfd3['telegramToken']=settings[_0x1ddf32(0xe4)];continue;};if(_0x4b96ae==_0x1ddf32(0x171)&&_0x249847=='************'){_0x15cfd3[_0x1ddf32(0x171)]=settings[_0x1ddf32(0x171)];continue;};dbSettings['set'](_0x1ddf32(0x1ae)+_0x4b96ae,_0x249847)[_0x1ddf32(0x141)]();}settings=_0x15cfd3,io['to']('botmanager')['emit'](_0x1ddf32(0xe8),cleanSettings()),broadcastToBots(_0x1ddf32(0x17e),settings['timeshift']),broadcastToBots(_0x1ddf32(0x1e5),settings[_0x1ddf32(0x1e5)]);if(_0x18f939&&!_0x5c0c98)initTelegram();if(_0x18f939&&_0x5c0c98)disableTelegram();getAllClients()[_0x1ddf32(0x1a0)](_0x4fd282=>{const _0x1f5df7=_0x1ddf32;getSocket(_0x4fd282['id'])[_0x1f5df7(0x17d)](_0x1f5df7(0x259),{'access':{'allow':![],'reason':_0x1f5df7(0x21d),'token':null}});});}function updateSetting(_0xf66eee,_0x45f4bf){const _0x2f6330=_0x1e9d18;dbSettings[_0x2f6330(0xec)]('settings.'+_0xf66eee,_0x45f4bf)['write'](),settings=getSettings(),io['to'](_0x2f6330(0x210))['emit']('settings',cleanSettings());}function storeSecure(_0xaa75a8){const _0x3c158e=_0x1e9d18;dbSecure[_0x3c158e(0x1db)](_0x3c158e(0x138))[_0x3c158e(0x213)](_0xaa75a8)[_0x3c158e(0x141)](),secure=_0xaa75a8;}function addBlacklist(_0x593e72){const _0x33ed50=_0x1e9d18;cleanBlacklist();let _0x65940;devices[_0x593e72][_0x33ed50(0x261)]?_0x65940=Math[_0x33ed50(0x265)](devices[_0x593e72][_0x33ed50(0x261)][_0x33ed50(0x247)],loginExpiry):_0x65940=loginExpiry,dbSecure[_0x33ed50(0x1db)](_0x33ed50(0x20f))['push']({'expiry':new Date()[_0x33ed50(0x235)]()+_0x65940*0x3c*0x3e8,'token':devices[_0x593e72][_0x33ed50(0x99)]['token']})[_0x33ed50(0x141)](),blacklist=dbSecure[_0x33ed50(0x1db)](_0x33ed50(0x20f))[_0x33ed50(0xb9)]();}function cleanBlacklist(){const _0x313f19=_0x1e9d18;let _0x21b3cf=dbSecure[_0x313f19(0x1db)]('blacklist')[_0x313f19(0xcb)]()['value'](),_0x456319=new Date()[_0x313f19(0x235)]();_0x21b3cf['forEach'](_0x2d2947=>{const _0x5ebecb=_0x313f19;_0x2d2947[_0x5ebecb(0x247)]<_0x456319&&dbSecure[_0x5ebecb(0x1db)](_0x5ebecb(0x20f))[_0x5ebecb(0x17a)]({'expiry':_0x2d2947['expiry']})[_0x5ebecb(0x141)]();});}function initStates(){let _0x31ed17=getConfiguration();_0x31ed17['forEach'](_0x1a2eb6=>{const _0x584d9d=_0x15c0;_0x1a2eb6[_0x584d9d(0x1a8)]=_0x584d9d(0x1fd);}),storeConfiguration(_0x31ed17);}function onKeys(){const _0x17c8ab=new RSA();return new Promise(_0x319b2d=>{const _0xae41c=_0x15c0;_0x17c8ab[_0xae41c(0x160)]()['then'](_0x260f71=>{_0x319b2d(_0x260f71);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x50a3c7=_0x1e9d18;let _0x12472e=getSettings(),_0x15868c=![];!_0x12472e[_0x50a3c7(0x24e)]('lastmsgtelegram')&&(_0x12472e[_0x50a3c7(0x1fa)]=0x0,_0x15868c=!![]);!_0x12472e[_0x50a3c7(0x24e)](_0x50a3c7(0x118))&&(_0x12472e[_0x50a3c7(0x118)]=0x0,_0x15868c=!![]);!_0x12472e[_0x50a3c7(0x24e)](_0x50a3c7(0xff))&&(_0x12472e[_0x50a3c7(0xff)]=_0x50a3c7(0x11c),_0x15868c=!![]);!_0x12472e['hasOwnProperty'](_0x50a3c7(0x1e5))&&(_0x12472e[_0x50a3c7(0x1e5)]=![],_0x15868c=!![]);if(_0x15868c)storeSettings(_0x12472e);try{fs[_0x50a3c7(0xdc)](configbackuppath,{'withFileTypes':!![]})[_0x50a3c7(0x1a0)](_0x2542d8=>{const _0xe888e3=_0x50a3c7;if(!_0x2542d8[_0xe888e3(0xb8)]()){if(!_0x2542d8[_0xe888e3(0x188)][_0xe888e3(0x9c)](_0xe888e3(0x13e)))fs[_0xe888e3(0x1fb)](configbackuppath+_0x2542d8[_0xe888e3(0x188)]);}else fs['rmSync'](configbackuppath+_0x2542d8[_0xe888e3(0x188)],{'recursive':!![]});});}catch(_0x5dca51){logger[_0x50a3c7(0x14d)]('Error\x20removing\x20old\x20backup\x20files:',_0x5dca51);}}function storeConfiguration(_0x32d7ac){const _0x301640=_0x1e9d18;dbConfig[_0x301640(0x1db)](_0x301640(0x12b))['remove']()[_0x301640(0x141)](),_0x32d7ac['forEach'](_0x327078=>{delete _0x327078['mode'];}),dbConfig['get']('bots')[_0x301640(0x213)](..._0x32d7ac)[_0x301640(0x141)](),config=_0x32d7ac;}function resetPassword(){const _0x102ceb=_0x1e9d18;tgBot&&settings[_0x102ceb(0x142)]&&(tgBot[_0x102ceb(0x16e)]('callback_query'),tgBot[_0x102ceb(0x208)](settings[_0x102ceb(0x142)],_0x102ceb(0x245),{'parse_mode':_0x102ceb(0x230),'reply_markup':{'inline_keyboard':[[{'text':_0x102ceb(0xfd),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x102ceb(0x250)](_0x57386c=>{telegramError(_0x57386c);}),tgBot['on'](_0x102ceb(0xb0),async _0x53eea6=>{const _0x4ec0e1=_0x102ceb,_0x354b9f=_0x53eea6['data'],_0x32836d=_0x53eea6['message'];tgBot[_0x4ec0e1(0xaa)](_0x53eea6['id'])[_0x4ec0e1(0xdf)](async()=>{const _0x463f7b=_0x4ec0e1;if(_0x354b9f!='no'){const _0x2656f7=0xf,_0x8658c6=_0x463f7b(0x128),_0x1ad5f5=Array[_0x463f7b(0x1ff)](crypto[_0x463f7b(0x145)](new Uint32Array(_0x2656f7)))['map'](_0xb450b5=>_0x8658c6[_0xb450b5%_0x8658c6[_0x463f7b(0x238)]])['join'](''),_0x40059f=bcrypt[_0x463f7b(0xc3)](_0x1ad5f5,saltRounds);storeSettings({'bbPassword':_0x40059f}),await tgBot[_0x463f7b(0x208)](_0x32836d['chat']['id'],_0x463f7b(0x212)+_0x1ad5f5,{'parse_mode':_0x463f7b(0x230)})['catch'](_0x5b9352=>{telegramError(_0x5b9352);});}else await tgBot['sendMessage'](_0x32836d[_0x463f7b(0x19a)]['id'],'Password\x20reset\x20rejected')['catch'](_0x4dc7a4=>{telegramError(_0x4dc7a4);});}),tgBot['removeListener'](_0x4ec0e1(0xb0));}));}async function confirmRestore(_0x4040d4,_0x1b7d74){const _0x524232=_0x1e9d18;io['to'](_0x524232(0x210))['emit'](_0x524232(0xc1),_0x524232(0x24c),_0x524232(0x1bc)),tgBot&&settings['telegramChatId']&&(tgBot[_0x524232(0x16e)]('callback_query'),await tgBot[_0x524232(0x208)](settings[_0x524232(0x142)],_0x524232(0x228),{'parse_mode':_0x524232(0x230),'reply_markup':{'inline_keyboard':[[{'text':_0x524232(0xfd),'callback_data':_0x524232(0xfd)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x5c744f=>{telegramError(_0x5c744f);}),tgBot['on'](_0x524232(0xb0),async _0x41ef85=>{const _0x1bac51=_0x524232,_0xb38b58=_0x41ef85['data'],_0x19bb62=_0x41ef85['message'];tgBot[_0x1bac51(0xaa)](_0x41ef85['id'])[_0x1bac51(0xdf)](async()=>{const _0xb47714=_0x1bac51;_0xb38b58==_0xb47714(0xfd)?(await tgBot[_0xb47714(0x208)](_0x19bb62['chat']['id'],_0xb47714(0x1d2),{'parse_mode':_0xb47714(0x230)})[_0xb47714(0x250)](_0x1e4c6f=>{telegramError(_0x1e4c6f);}),unzipFile(_0x4040d4,_0x1b7d74)):(logger[_0xb47714(0x14d)]('Restore\x20process\x20aborted'),await tgBot[_0xb47714(0x208)](_0x19bb62[_0xb47714(0x19a)]['id'],'Restore\x20process\x20aborted')[_0xb47714(0x250)](_0x255cf9=>{telegramError(_0x255cf9);}));}),tgBot[_0x1bac51(0x16e)](_0x1bac51(0xb0));}));}function getServerTime(){const _0x44b155=_0x1e9d18,_0x7d8744=new Date();return _0x7d8744[_0x44b155(0xb4)]()+'/'+(_0x7d8744[_0x44b155(0xd2)]()+0x1)['toString']()[_0x44b155(0x19e)](0x2,'0')+'/'+_0x7d8744['getDate']()[_0x44b155(0x10e)]()[_0x44b155(0x19e)](0x2,'0')+'\x20'+_0x7d8744[_0x44b155(0xd7)]()[_0x44b155(0x10e)]()[_0x44b155(0x19e)](0x2,'0')+':'+_0x7d8744['getMinutes']()[_0x44b155(0x10e)]()[_0x44b155(0x19e)](0x2,'0')+':'+_0x7d8744[_0x44b155(0xb3)]()['toString']()[_0x44b155(0x19e)](0x2,'0');}function getTimeStamp(){const _0x2c96f0=_0x1e9d18,_0x3b34f2=shiftedTime();return _0x3b34f2[_0x2c96f0(0xb4)]()+'/'+(_0x3b34f2[_0x2c96f0(0xd2)]()+0x1)[_0x2c96f0(0x10e)]()[_0x2c96f0(0x19e)](0x2,'0')+'/'+_0x3b34f2[_0x2c96f0(0x10a)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x3b34f2[_0x2c96f0(0xd7)]()[_0x2c96f0(0x10e)]()[_0x2c96f0(0x19e)](0x2,'0')+':'+_0x3b34f2[_0x2c96f0(0x1ee)]()['toString']()['padStart'](0x2,'0')+':'+_0x3b34f2[_0x2c96f0(0xb3)]()[_0x2c96f0(0x10e)]()[_0x2c96f0(0x19e)](0x2,'0');}function getCleanTimeStamp(){const _0x274381=_0x1e9d18,_0x4de646=shiftedTime();return _0x4de646[_0x274381(0xb4)]()+(_0x4de646[_0x274381(0xd2)]()+0x1)['toString']()['padStart'](0x2,'0')+_0x4de646[_0x274381(0x10a)]()[_0x274381(0x10e)]()['padStart'](0x2,'0')+'-'+_0x4de646['getHours']()['toString']()['padStart'](0x2,'0')+_0x4de646[_0x274381(0x1ee)]()[_0x274381(0x10e)]()[_0x274381(0x19e)](0x2,'0')+_0x4de646[_0x274381(0xb3)]()[_0x274381(0x10e)]()['padStart'](0x2,'0');}function shiftedTime(){const _0xa7cba3=_0x1e9d18,_0x49d4a9=new Date();let _0x5e8dbf=_0x49d4a9;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x5e8dbf=fns[_0xa7cba3(0x214)](_0x49d4a9,{'hours':settings[_0xa7cba3(0x17e)]});return _0x5e8dbf;}function startScheduler(){const _0x5ed9ec=new Date()['getUTCHours'](),_0x573dd3=shiftedTime()['getHours']();_0x573dd3==0x4&&backupConfigFiles();_0x573dd3==0x0&&rotateLogFiles();_0x5ed9ec%0x6==0x0&&triggerAnalytics();_0x5ed9ec%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x1e5f52){const _0x204fb0=_0x1e9d18;logger['debug']('Restore\x20backup\x20file\x20'+_0x1e5f52);const _0x3055fe=getBotsWithMode();_0x3055fe[_0x204fb0(0x238)]>0x0?confirmRestore(configbackuppath,_0x1e5f52):unzipFile(configbackuppath,_0x1e5f52);}async function getBackupFiles(_0x346751=null){const _0x50f031=_0x1e9d18;let _0x2817fb=[],_0x58ac47=fs[_0x50f031(0xdc)](configbackuppath,{'withFileTypes':!![]});_0x58ac47['sort']((_0x5bb1fd,_0x1a3719)=>_0x5bb1fd['name']<_0x1a3719[_0x50f031(0x188)]?0x1:_0x1a3719[_0x50f031(0x188)]<_0x5bb1fd[_0x50f031(0x188)]?-0x1:0x0),_0x58ac47[_0x50f031(0x1a0)](_0x4532bd=>{const _0x205025=_0x50f031;if(!_0x4532bd[_0x205025(0xb8)]()&&_0x4532bd[_0x205025(0x188)][_0x205025(0x9c)]('backup-full@')&&_0x4532bd[_0x205025(0x188)][_0x205025(0x263)]('.zip')){const _0x5705e6=formatDate(fs['statSync'](configbackuppath+_0x4532bd[_0x205025(0x188)])['mtime']);_0x2817fb[_0x205025(0x213)]({'name':_0x4532bd[_0x205025(0x188)],'mtime':_0x5705e6});}});if(_0x346751)io['to'](_0x346751)[_0x50f031(0x17d)](_0x50f031(0x23c),_0x2817fb);else return _0x2817fb;}async function backupConfigFiles(){const _0x30793a=_0x1e9d18;await zipFiles(_0x30793a(0x10c));const _0x4acf3c=getCleanTimeStamp();fs[_0x30793a(0x121)](zippath+'backup-full.zip',configbackuppath+(_0x30793a(0x13e)+_0x4acf3c+'.zip'));let _0x3a5657=fs[_0x30793a(0xdc)](configbackuppath,{'withFileTypes':!![]});_0x3a5657[_0x30793a(0x1d0)]((_0x36be31,_0x24b924)=>_0x36be31[_0x30793a(0x188)]<_0x24b924[_0x30793a(0x188)]?0x1:_0x24b924[_0x30793a(0x188)]<_0x36be31[_0x30793a(0x188)]?-0x1:0x0),_0x3a5657[_0x30793a(0x238)]>maxBackups&&fs[_0x30793a(0x1fb)](configbackuppath+_0x3a5657[_0x3a5657['length']-0x1][_0x30793a(0x188)]);}function rotateLogFiles(){const _0x267706=_0x1e9d18,_0xa4077b=fs['statSync'](logspath+_0x267706(0x9b)),_0x209bad=_0xa4077b[_0x267706(0x1d7)]/0x400;if(_0x209bad>0x64){let _0xd1847b=fs[_0x267706(0xdc)](logspath,{'withFileTypes':!![]});_0xd1847b[_0x267706(0x1d0)]((_0x5436e6,_0x496bbd)=>_0x5436e6['name']<_0x496bbd[_0x267706(0x188)]?0x1:_0x496bbd['name']<_0x5436e6[_0x267706(0x188)]?-0x1:0x0),_0xd1847b['forEach'](_0x539ff0=>{const _0x11a99c=_0x267706;if(_0x539ff0[_0x11a99c(0x188)]==_0x11a99c(0x215))fs[_0x11a99c(0x121)](logspath+_0x539ff0[_0x11a99c(0x188)],logspath+_0x11a99c(0x15e));if(_0x539ff0[_0x11a99c(0x188)]==_0x11a99c(0x1cb))fs[_0x11a99c(0x121)](logspath+_0x539ff0[_0x11a99c(0x188)],logspath+_0x11a99c(0x215));_0x539ff0['name']==_0x11a99c(0x9b)&&(fs['copyFileSync'](logspath+_0x539ff0['name'],logspath+'output-001.log'),fs[_0x11a99c(0xbe)](logspath+_0x539ff0['name'],''));});}}async function zipFiles(_0x2733cf){const _0x4e844d=_0x1e9d18;let _0xf3b3d0;if(_0x2733cf=='logs')_0xf3b3d0=logspath;if(_0x2733cf==_0x4e844d(0x1b8))_0xf3b3d0=configpath;if(_0x2733cf==_0x4e844d(0x10c))_0xf3b3d0=configpath;let _0x352c25=fs[_0x4e844d(0xdc)](_0xf3b3d0,{'withFileTypes':!![]});const _0x422c40=new require(_0x4e844d(0xad))();_0x352c25[_0x4e844d(0x1a0)](_0x286a25=>{const _0x5d9a07=_0x4e844d;if(!_0x286a25[_0x5d9a07(0xb8)]()){let _0x5ce35f=fs[_0x5d9a07(0x1e8)](_0xf3b3d0+_0x286a25[_0x5d9a07(0x188)]);if(_0x2733cf=='backup'){const _0x42c424=/^bot-[0-9]{3}-config.json$/,_0x566837=_0x42c424[_0x5d9a07(0x13c)](_0x286a25[_0x5d9a07(0x188)]);if(_0x566837){const _0x549567=JSON[_0x5d9a07(0x10d)](_0x5ce35f);if(_0x549567[_0x5d9a07(0x154)][0x0]){_0x549567['bot'][0x0][_0x5d9a07(0x18a)]=_0x5d9a07(0xa1),_0x549567[_0x5d9a07(0x154)][0x0][_0x5d9a07(0xe9)]='***';if(_0x549567[_0x5d9a07(0x154)][0x0][_0x5d9a07(0xa6)])_0x549567[_0x5d9a07(0x154)][0x0][_0x5d9a07(0xa6)]=_0x5d9a07(0xa1);}_0x5ce35f=JSON[_0x5d9a07(0x1cf)](_0x549567,null,0x2);}if(_0x286a25['name']==_0x5d9a07(0x217)){const _0xf95eab=JSON[_0x5d9a07(0x10d)](_0x5ce35f);if(_0xf95eab['settings'][_0x5d9a07(0x9e)])_0xf95eab[_0x5d9a07(0xe8)][_0x5d9a07(0x9e)]=![];if(_0xf95eab[_0x5d9a07(0xe8)][_0x5d9a07(0x171)])_0xf95eab['settings']['bbPassword']='***';if(_0xf95eab[_0x5d9a07(0xe8)][_0x5d9a07(0xe4)])_0xf95eab['settings'][_0x5d9a07(0xe4)]='***';if(_0xf95eab[_0x5d9a07(0xe8)]['telegramChatId'])_0xf95eab['settings'][_0x5d9a07(0x142)]=null;_0x5ce35f=JSON[_0x5d9a07(0x1cf)](_0xf95eab,null,0x2);}if(_0x286a25['name']!=_0x5d9a07(0x129))_0x422c40['file'](_0x286a25[_0x5d9a07(0x188)],_0x5ce35f);}else _0x422c40[_0x5d9a07(0x209)](_0x286a25[_0x5d9a07(0x188)],_0x5ce35f);}});const _0x40a499=_0x422c40[_0x4e844d(0xa3)]({'base64':![],'compression':_0x4e844d(0x115)});fs[_0x4e844d(0xbe)](zippath+(_0x2733cf+_0x4e844d(0x147)),_0x40a499,'binary');}async function unzipFile(_0x4a6fb2,_0x28bc1e){const _0x333795=_0x1e9d18;fs[_0x333795(0xdc)](configpath,{'withFileTypes':!![]})['forEach'](_0x125366=>{const _0x242902=_0x333795;if(!_0x125366['isDirectory']())fs[_0x242902(0x22a)](configpath+_0x125366[_0x242902(0x188)]);});const _0x272e8f=fs[_0x333795(0x1e8)](_0x4a6fb2+_0x28bc1e,_0x333795(0x186)),_0x3c0486=new require(_0x333795(0xad))(_0x272e8f,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x3c0486[_0x333795(0x1e3)])[_0x333795(0x1a0)](_0x34d59c=>{const _0x30b5d6=_0x333795,_0x59e459=_0x3c0486[_0x30b5d6(0x1e3)][_0x34d59c];fs[_0x30b5d6(0xbe)](configpath+_0x59e459[_0x30b5d6(0x188)],_0x59e459[_0x30b5d6(0x24f)]);}),fs[_0x333795(0xdc)](temppath,{'withFileTypes':!![]})[_0x333795(0x1a0)](_0x534700=>{const _0x78b462=_0x333795;if(!_0x534700[_0x78b462(0xb8)]())fs['rmSync'](temppath+_0x534700[_0x78b462(0x188)]);}),logger[_0x333795(0x14d)](_0x333795(0x16a)),process['send']({'restore':!![]},_0x57e502=>{});}async function getPublicIp(){const _0x2e4fd7=_0x1e9d18;try{const _0x453278=await axios[_0x2e4fd7(0x1db)](_0x2e4fd7(0x1d4));publicip=_0x453278['data']['ip'];}catch(_0x4191c7){}}async function triggerAnalytics(){const _0x2cf8b4=_0x1e9d18;if(!publicip)await getPublicIp();const _0x18b565=getBotsWithMode();let _0x1311ce=0x0;_0x18b565['forEach'](_0x3a85c1=>{const _0x81ddef=_0x15c0;if(_0x3a85c1[_0x81ddef(0x259)]===_0x81ddef(0x258))_0x1311ce++;});const _0x2c3791=getBotExchanges();mixpanel['track']('Server',{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x18b565[_0x2cf8b4(0x238)],'numbotsenabled':_0x1311ce,'exchanges':_0x2c3791});}async function getMessages(){const _0x515679=_0x1e9d18,_0x513729='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x4073ad=new GraphQLClient(_0x513729),_0x456069={'authorization':_0x515679(0x1c4)},_0xbd32e2=serverversion['split']('.'),_0x1c93a8=_0xbd32e2[0x0]+'.'+_0xbd32e2[0x1],_0x11ccc2=Math[_0x515679(0x1f5)](settings['lastmsgtelegram'],settings[_0x515679(0x118)]),_0x56d9a6={'last':parseInt(_0x11ccc2),'bbm':_0x1c93a8},_0x3d07e9=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x8e16e4;try{_0x8e16e4=await _0x4073ad[_0x515679(0x195)](_0x3d07e9,_0x56d9a6,_0x456069);}catch(_0x744972){}if(_0x8e16e4&&_0x8e16e4['messages']){let _0x50962c=settings[_0x515679(0x1fa)];newMessages=[];for(const _0x2bfa80 of _0x8e16e4[_0x515679(0x178)]){newMessages['push'](_0x2bfa80);if(_0x2bfa80['bbvNew'])updateSetting(_0x515679(0xff),_0x2bfa80[_0x515679(0x1b2)]);let _0x35c4eb=_0x2bfa80[_0x515679(0x1b2)]?serverversion>=_0x2bfa80[_0x515679(0x1b2)]:![];if(!_0x35c4eb&&_0x2bfa80[_0x515679(0xc8)]>_0x50962c){if(_0x2bfa80[_0x515679(0x203)]==='any'||serverversion[_0x515679(0x9c)](_0x2bfa80[_0x515679(0x203)])){let _0x595a3a=''+_0x2bfa80[_0x515679(0x135)]+'\x0a\x0a'+_0x2bfa80['message'];const _0x3236cf=await sendTelegramMsg(toTelegramMarkdown(_0x595a3a),_0x515679(0x1e2));if(_0x3236cf)_0x50962c=_0x2bfa80[_0x515679(0xc8)];}}}updateAvailable=isNewerVersion(settings[_0x515679(0xff)],serverversion),updateSetting(_0x515679(0x1fa),_0x50962c),emitMessages();}}function emitMessages(){const _0x177906=_0x1e9d18,_0x5dc38a=settings['lastmsgemitted'];let _0x24d4ed=[];newMessages[_0x177906(0x1a0)](_0x45a833=>{const _0x385d78=_0x177906;_0x45a833[_0x385d78(0xc8)]>_0x5dc38a&&_0x24d4ed[_0x385d78(0x213)](_0x45a833);}),_0x24d4ed[_0x177906(0x238)]>0x0&&getAllClients()[_0x177906(0x1a0)](_0xd8a05d=>{const _0x145085=_0x177906;getSocket(_0xd8a05d['id'])[_0x145085(0x17d)](_0x145085(0x197),_0x24d4ed);});}function confirmMessage(_0x29df7b){updateSetting('lastmsgemitted',Number(_0x29df7b));}function isNewerVersion(_0x722a01,_0x1b3a99){const _0x10b412=_0x1e9d18,_0x92c148=_0x1b3a99['split']('.'),_0xe9c4cd=_0x722a01['split']('.');for(var _0x1a15cc=0x0;_0x1a15cc<_0xe9c4cd[_0x10b412(0x238)];_0x1a15cc++){const _0x5ccc78=~~_0xe9c4cd[_0x1a15cc],_0x15466b=~~_0x92c148[_0x1a15cc];if(_0x5ccc78>_0x15466b)return!![];if(_0x5ccc78<_0x15466b)return![];}return![];}function toTelegramMarkdown(_0x57d846){const _0x1b8573=_0x1e9d18,_0x5a4b01=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x2af32f=/\*{2}(.+?)\*{2}/gim;return _0x57d846=_0x57d846[_0x1b8573(0x23b)](_0x5a4b01,_0x1b8573(0x1b0))['replace'](_0x2af32f,_0x1b8573(0x1c5)),_0x57d846;}async function validateConfigFile(){const _0x484baf=_0x1e9d18,_0x54822b=dbConfig['get'](_0x484baf(0x12b))[_0x484baf(0x139)]('botID')[_0x484baf(0xb9)]()||[];if(_0x54822b[_0x484baf(0x238)]==0x0){let _0x556d12=0x0,_0x3ca216=[];const _0x432f8e=/^bot-([0-9]{3})-config.json$/,_0x2bcc88=fs[_0x484baf(0xdc)](configpath);_0x2bcc88[_0x484baf(0x1a0)](_0x2482ea=>{const _0x51a8fe=_0x484baf,_0x45309f=_0x432f8e[_0x51a8fe(0x1c2)](_0x2482ea);if(_0x45309f){const _0x3b554b=_0x45309f[0x1];let _0x2bcd27=getBotAttributes(_0x3b554b);_0x3ca216[_0x51a8fe(0x213)]({'botID':_0x3b554b,'botname':_0x2bcd27[_0x51a8fe(0x224)],'status':'disabled','live':_0x51a8fe(0x1fd)}),_0x556d12++;}}),_0x556d12!=0x0&&(dbConfig[_0x484baf(0x1db)](_0x484baf(0x12b))['assign'](_0x3ca216)[_0x484baf(0x141)](),config=_0x3ca216,restoredConfigFile=_0x556d12);}}async function restoreConfigNotify(_0x3c1cd4){const _0x265a46=_0x1e9d18;let _0x3aaac9;if(restoredConfigFile==0x1)_0x3aaac9=_0x265a46(0x170);else _0x3aaac9=_0x265a46(0x260);if(_0x3c1cd4)io['to'](_0x265a46(0x210))[_0x265a46(0x17d)](_0x265a46(0xc1),_0x3aaac9);else{logger[_0x265a46(0xf8)]('-----------------------------------------------------------------------------------'),logger[_0x265a46(0xf8)](_0x3aaac9),logger['simple'](_0x265a46(0x1d1)),logger['simple']('');if(tgBot&&settings['telegramChatId']&&settings[_0x265a46(0xe3)]!=_0x265a46(0x107))tgBot[_0x265a46(0x208)](settings[_0x265a46(0x142)],_0x265a46(0xc2)+_0x3aaac9)['catch'](_0x14cd46=>{telegramError(_0x14cd46);});}}function validateCredentials(_0x156db0,_0x142cdd){const _0x3da753=_0x1e9d18;if(_0x156db0['username']==settings[_0x3da753(0x1b1)]&&bcrypt['compareSync'](_0x156db0[_0x3da753(0x1b3)],settings[_0x3da753(0x171)])){if(settings[_0x3da753(0x1ec)])return{'allow':![],'reason':_0x3da753(0x1c7),'token':null};else{const _0x36b91b=generateLoginToken(_0x142cdd);return{'allow':!![],'reason':_0x3da753(0x1f2),'token':_0x36b91b};}}else return{'allow':![],'reason':_0x3da753(0x196),'token':null};}function refreshToken(_0x561ba1){const _0x27b1d6=_0x1e9d18,_0x16d051=generateLoginToken(_0x561ba1);return{'allow':!![],'reason':_0x27b1d6(0x1f2),'token':_0x16d051};}function validateAccess(_0x3dbec8,_0xc2062a,_0x1f2be6){const _0x4fa53b=_0x1e9d18,_0x3400a5=_0x1f2be6?_0x1f2be6:devices[_0xc2062a]['ip'];let _0x184b5b;const _0x3139dc=_0x34f4b9=>{const _0x47d726=_0x15c0;if(settings[_0x47d726(0x9e)]){if(settings[_0x47d726(0x1ec)]){if(telegram2FaApproved(_0xc2062a)){const _0xa9195a=generateLoginToken(_0xc2062a);return{'allow':!![],'reason':_0x47d726(0xc6),'token':_0xa9195a};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x184b5b=validToken(_0x34f4b9,_0xc2062a),_0x184b5b[_0x47d726(0x24e)]('success')?{'allow':!![],'reason':_0x47d726(0x1f8),'token':_0x34f4b9}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x47d726(0x14b),'token':null};};if(settings['whitelistEnabled']){let _0x3db1f2=[...settings[_0x4fa53b(0xf7)],_0x4fa53b(0x126),_0x4fa53b(0x175),_0x4fa53b(0x1e1)];if(_0x3db1f2[_0x4fa53b(0x22c)](_0x3400a5))return _0x3139dc(_0x3dbec8);else{_0x184b5b=validToken(_0x3dbec8,_0xc2062a);if(_0x184b5b['hasOwnProperty'](_0x4fa53b(0x1bc)))return _0x3139dc(_0x3dbec8);else{if(telegramIpApproved(_0xc2062a)){const _0x200678=generateToken(_0xc2062a);return _0x184b5b=_0x3139dc(_0x3dbec8),_0x184b5b[_0x4fa53b(0x226)]?{'allow':!![],'reason':_0x4fa53b(0xa5),'token':_0x200678}:_0x184b5b;}else return settings[_0x4fa53b(0x100)]?{'allow':![],'reason':_0x4fa53b(0x19b),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x3139dc(_0x3dbec8);}function timelyDecrypt(_0xe18de6,_0x52f7c5=!![]){const _0x2cf3b1=_0x1e9d18;if(_0xe18de6)try{const _0x237033=crypt[_0x2cf3b1(0x146)](secure[_0x2cf3b1(0xd9)],_0xe18de6)[_0x2cf3b1(0x197)],_0x2017a9=_0x237033[_0x2cf3b1(0x18d)]('@')[0x0],_0x36df82=_0x237033[_0x2cf3b1(0x18d)]('@')[0x1],_0x4ed595=new Date()[_0x2cf3b1(0x235)]();if(_0x52f7c5){if(_0x4ed595-_0x36df82<maxSecretAge*0x3e8)return _0x2017a9;else return![];}else return _0x2017a9;}catch(_0x3c9fd4){return![];}else return![];}const validToken=(_0x463cfd,_0x2debb1)=>{const _0x1962b4=_0x1e9d18,_0x147efa=devices[_0x2debb1]['ip'];if(!_0x463cfd)return{'error':_0x1962b4(0x1b4)};for(let _0x443177 of blacklist){if(_0x443177['token']==_0x463cfd)return{'error':_0x1962b4(0xb1)};}let _0x32cc92;try{_0x32cc92=jwt[_0x1962b4(0x149)](_0x463cfd,secure[_0x1962b4(0x18c)]+_0x2debb1);}catch{return{'error':_0x1962b4(0x206)};}if(!_0x32cc92[_0x1962b4(0x24e)](_0x1962b4(0x166))&&!_0x32cc92['hasOwnProperty'](_0x1962b4(0xd3))||!_0x32cc92['hasOwnProperty'](_0x1962b4(0xf2)))return{'error':_0x1962b4(0x1ac)};if(!_0x32cc92[_0x1962b4(0x24e)](_0x1962b4(0xd3))&&_0x32cc92[_0x1962b4(0x24e)]('clientip')){const {clientip:_0x57971d}=_0x32cc92;return _0x147efa==_0x57971d?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x32cc92[_0x1962b4(0x24e)](_0x1962b4(0xd3))&&_0x32cc92['hasOwnProperty'](_0x1962b4(0x166))){const {username:_0x3b805d,clientip:_0x6380c3}=_0x32cc92;return settings[_0x1962b4(0x1b1)]==_0x3b805d&&_0x147efa==_0x6380c3?{'success':_0x1962b4(0x225)}:{'error':_0x1962b4(0x95)};}}},generateLoginToken=_0x10c6ef=>{const _0x441912=_0x1e9d18;if(_0x10c6ef){const _0x31f7fb=devices[_0x10c6ef]['ip'];return jwt[_0x441912(0x10b)]({'username':settings[_0x441912(0x1b1)],'clientip':_0x31f7fb},secure['secret']+_0x10c6ef,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x1d739e=>{const _0x588530=_0x1e9d18;if(_0x1d739e){const _0x576e6f=devices[_0x1d739e]['ip'];return jwt[_0x588530(0x10b)]({'clientip':_0x576e6f},secure['secret']+_0x1d739e,{'expiresIn':devices[_0x1d739e]['telegramIpApproval'][_0x588530(0x247)]*0x3c});}else return![];},telegramIpApproved=_0xa48004=>{const _0x28731c=_0x1e9d18;let _0x4d2fc4=![];return devices[_0xa48004][_0x28731c(0x261)]&&devices[_0xa48004]['telegramIpApproval'][_0x28731c(0x247)]!='reject'&&(_0x4d2fc4=devices[_0xa48004]['telegramIpApproval'][_0x28731c(0x166)]==devices[_0xa48004]['ip']&&new Date()[_0x28731c(0x235)]()-devices[_0xa48004][_0x28731c(0x261)][_0x28731c(0x148)]<devices[_0xa48004]['telegramIpApproval'][_0x28731c(0x247)]*0x3c*0x3e8),_0x4d2fc4;},telegram2FaApproved=_0x46b76a=>{const _0x2c1e2b=_0x1e9d18;let _0x5bb53f=![];return devices[_0x46b76a][_0x2c1e2b(0x177)]&&devices[_0x46b76a][_0x2c1e2b(0x177)][_0x2c1e2b(0x247)]!=_0x2c1e2b(0x12c)&&(_0x5bb53f=devices[_0x46b76a][_0x2c1e2b(0x177)]['clientip']==devices[_0x46b76a]['ip']&&new Date()[_0x2c1e2b(0x235)]()-devices[_0x46b76a][_0x2c1e2b(0x177)]['timestamp']<devices[_0x46b76a][_0x2c1e2b(0x177)][_0x2c1e2b(0x247)]*0x3c*0x3e8),_0x5bb53f;},normalizeIP=_0x28b86f=>{const _0x334761=_0x1e9d18;let _0x3faea8=null,_0x459281=null;if(ipaddr['isValid'](_0x28b86f)){const _0x519f70=ipaddr[_0x334761(0x10d)](_0x28b86f);_0x519f70['kind']()===_0x334761(0x1d5)?(_0x519f70[_0x334761(0x181)]()&&(_0x3faea8=_0x519f70['toIPv4Address']()[_0x334761(0x10e)]()),_0x459281=_0x519f70['toString']()):(_0x3faea8=_0x519f70[_0x334761(0x10e)](),_0x459281=_0x519f70['toIPv4MappedAddress']()[_0x334761(0x10e)]());}return{'show':_0x3faea8?_0x3faea8:_0x459281,'store':_0x459281};};function formatDate(_0x237012){const _0xd68578=_0x1e9d18;return _0x237012[_0xd68578(0xb4)]()+'/'+(_0x237012['getMonth']()+0x1)['toString']()[_0xd68578(0x19e)](0x2,'0')+'/'+_0x237012['getDate']()[_0xd68578(0x10e)]()[_0xd68578(0x19e)](0x2,'0')+'\x20'+_0x237012[_0xd68578(0xd7)]()['toString']()[_0xd68578(0x19e)](0x2,'0')+':'+_0x237012[_0xd68578(0x1ee)]()[_0xd68578(0x10e)]()['padStart'](0x2,'0')+':'+_0x237012[_0xd68578(0xb3)]()[_0xd68578(0x10e)]()[_0xd68578(0x19e)](0x2,'0');}function sleep(_0x4f3cee){return new Promise(_0x25b058=>setTimeout(_0x25b058,_0x4f3cee));}