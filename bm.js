const _0x485691=_0x2509;(function(_0x20222e,_0x2ffa39){const _0x4c6930=_0x2509,_0x4bff0d=_0x20222e();while(!![]){try{const _0x560ae8=-parseInt(_0x4c6930(0x24e))/0x1+-parseInt(_0x4c6930(0x254))/0x2+-parseInt(_0x4c6930(0x1ff))/0x3*(-parseInt(_0x4c6930(0x3a3))/0x4)+-parseInt(_0x4c6930(0x2ee))/0x5+parseInt(_0x4c6930(0x27b))/0x6*(parseInt(_0x4c6930(0x2aa))/0x7)+-parseInt(_0x4c6930(0x1b1))/0x8*(-parseInt(_0x4c6930(0x1c2))/0x9)+parseInt(_0x4c6930(0x3a0))/0xa*(parseInt(_0x4c6930(0x24f))/0xb);if(_0x560ae8===_0x2ffa39)break;else _0x4bff0d['push'](_0x4bff0d['shift']());}catch(_0x5cbf1a){_0x4bff0d['push'](_0x4bff0d['shift']());}}}(_0x7996,0x7abda));const _0x16c1ee=function(){let _0x407439=!![];return function(_0x7390b,_0x38b420){const _0xf290ea=_0x407439?function(){const _0x407a52=_0x2509;if(_0x38b420){const _0xac3842=_0x38b420[_0x407a52(0x20f)](_0x7390b,arguments);return _0x38b420=null,_0xac3842;}}:function(){};return _0x407439=![],_0xf290ea;};}(),_0x2baa1e=_0x16c1ee(this,function(){const _0x23c518=_0x2509;return _0x2baa1e[_0x23c518(0x2ec)]()[_0x23c518(0x1d7)](_0x23c518(0x205))[_0x23c518(0x2ec)]()[_0x23c518(0x268)](_0x2baa1e)[_0x23c518(0x1d7)](_0x23c518(0x205));});_0x2baa1e();'use strict';process[_0x485691(0x289)][_0x485691(0x352)]=0x1;const childProcess=require(_0x485691(0x1f0)),fs=require('fs'),fns=require('date-fns'),low=require(_0x485691(0x2c7)),FileSync=require(_0x485691(0x218)),path=require(_0x485691(0x2f0)),crypto=require(_0x485691(0x328)),Crypt=require(_0x485691(0x1c0))[_0x485691(0x1e7)],RSA=require(_0x485691(0x1c0))[_0x485691(0x25a)],bcrypt=require(_0x485691(0x2dc)),jwt=require(_0x485691(0x1a8)),ipaddr=require(_0x485691(0x280)),argv=require(_0x485691(0x1fb))(process[_0x485691(0x2a5)]['slice'](0x2))[_0x485691(0x2a5)],uuidRandom=require(_0x485691(0x39e)),{Telegraf,Markup}=require(_0x485691(0x212)),Mixpanel=require(_0x485691(0x39d)),axios=require(_0x485691(0x3a5)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x485691(0x22d)),fileUpload=require(_0x485691(0x1cf)),{networkInterfaces}=require('os'),PORT=argv['port']||_0x485691(0x1f8),pattern=/^[0-9]{2,4}$/;!pattern[_0x485691(0x384)](PORT)&&(console['log'](_0x485691(0x288)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x485691(0x222)](0x1));const HOST=argv[_0x485691(0x2f9)]||null,userID=argv[_0x485691(0x2c3)]||'',debugging=argv['d']||![],nodeversion=process[_0x485691(0x23d)]['node'];let bbpath=_0x485691(0x2b2),bbpath2='';const botfile=_0x485691(0x33f),configfile=_0x485691(0x2e0),settingsfile='bb-settings.json',securefile=_0x485691(0x1af),environment=require('./'+bbpath2+'version.json')[_0x485691(0x271)]||_0x485691(0x202),maxBackups=0xa;let validInstallation=!![];!fs[_0x485691(0x1a0)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x485691(0x366)),configpath=userID?bbpath+_0x485691(0x2bf)+userID+'/':bbpath+_0x485691(0x2bf),configbackuppath=configpath+_0x485691(0x1ad),logspath=userID?bbpath+_0x485691(0x287)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x485691(0x2b3)+userID+'/':bbpath+_0x485691(0x2b3),loggerfile=fs[_0x485691(0x1cd)](logspath+_0x485691(0x370),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x485691(0x234);!fs[_0x485691(0x1a0)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x485691(0x1a0)](configbackuppath)&&fs[_0x485691(0x229)](configbackuppath);!fs[_0x485691(0x1a0)](logspath)&&fs[_0x485691(0x229)](logspath);!fs[_0x485691(0x1a0)](zippath)&&fs['mkdirSync'](zippath);!fs['existsSync'](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x485691(0x2b7)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x485691(0x34d)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x485691(0x1ba),'onepagemode':![],'marketcapApi':''}})[_0x485691(0x2b7)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x485691(0x34d)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x485691(0x32b)});const saltRounds=0xa,mixpanel=Mixpanel[_0x485691(0x277)](_0x485691(0x207),{'host':_0x485691(0x1f5)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x485691(0x1c9)]&&(settings[_0x485691(0x1c9)]!=''&&settings[_0x485691(0x1c9)]!=_0x485691(0x291))&&settings['telegramUsername']&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x34fbde,_0x3d6d76)=>{const _0x1cf374=_0x485691,_0x22893e=/#[A-Z]{3}#/g;if(typeof _0x34fbde==_0x1cf374(0x347)){!_0x3d6d76?_0x34fbde=_0x34fbde[_0x1cf374(0x1c5)](_0x22893e,''):(_0x34fbde=_0x34fbde['replace'](/#BLU#/g,'\x1b[34m'),_0x34fbde=_0x34fbde[_0x1cf374(0x1c5)](/#RED#/g,_0x1cf374(0x30e)),_0x34fbde=_0x34fbde['replace'](/#YEL#/g,_0x1cf374(0x2ae)),_0x34fbde=_0x34fbde['replace'](/#MAG#/g,_0x1cf374(0x1de)),_0x34fbde=_0x34fbde[_0x1cf374(0x1c5)](/#CYA#/g,'\x1b[36m'),_0x34fbde=_0x34fbde[_0x1cf374(0x1c5)](/#RES#/g,_0x1cf374(0x2e5)));;}return _0x34fbde;},logger={'screen':_0x2116dd=>{const _0x4c7f62=_0x485691;console[_0x4c7f62(0x2df)](parseColor(_0x2116dd,!![]));},'simple':_0x5c83cf=>{const _0xf675b2=_0x485691;console['log'](parseColor(_0x5c83cf,!![])),loggerfile['write'](util[_0xf675b2(0x38d)](parseColor(_0x5c83cf,![]))+'\x0a');},'full':async _0x30985e=>{const _0x1d0a2a=_0x485691,_0x212eb9=getTimeStamp()+_0x1d0a2a(0x342)+_0x30985e;console['log'](parseColor(_0x212eb9,!![])),loggerfile['write'](util['format'](parseColor(_0x212eb9,![]))+'\x0a');if(tgBot&&settings[_0x1d0a2a(0x3a4)]&&settings[_0x1d0a2a(0x30c)]!=_0x1d0a2a(0x383))await sendTelegram(settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+parseColor(_0x30985e,![]));},'debug':async(_0x5aa471,_0x1b9914='')=>{const _0x1d93f3=_0x485691,_0x21387e=getTimeStamp()+_0x1d93f3(0x1cc)+_0x5aa471;if(debugging)console['log'](parseColor(_0x21387e,!![]));loggerfile[_0x1d93f3(0x2b7)](util['format'](parseColor(_0x21387e,![]))+'\x0a');if(_0x1b9914){if(debugging)console[_0x1d93f3(0x2df)](_0x1b9914);loggerfile[_0x1d93f3(0x2b7)](util[_0x1d93f3(0x38d)](_0x1b9914)+'\x0a');}}};let terminating=![];process['on'](_0x485691(0x313),function(_0x14bb34){const _0x5cd523=_0x485691;_0x14bb34[_0x5cd523(0x2ec)]()[_0x5cd523(0x318)]('address\x20already\x20in\x20use')?(logger['simple']('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x14bb34[_0x5cd523(0x302)]+_0x5cd523(0x2a9)),process[_0x5cd523(0x245)]({'terminate':!![]},_0x5ce81f=>{})):logger['simple'](_0x14bb34);}),process['on']('exit',()=>{const _0x2719c7=_0x485691;stopAllBots(),process[_0x2719c7(0x222)](0x0);}),process['on'](_0x485691(0x209),()=>{const _0x25cee1=_0x485691;stopAllBots(),process[_0x25cee1(0x222)](0x0);}),process['on']('SIGINT',()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x485691(0x22e))[_0x485691(0x20e)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x485691(0x327)),app=express(),http=require(_0x485691(0x221))[_0x485691(0x376)](app);app[_0x485691(0x2ac)](fileUpload({'useTempFiles':!![]})),app[_0x485691(0x306)](_0x485691(0x282),async(_0x4f05ff,_0x536e98)=>{const _0x2035ff=_0x485691,_0x37b58a=_0x4f05ff[_0x2035ff(0x253)][_0x2035ff(0x2c8)],_0x5e4b39=getClientsWithBotID(_0x2035ff(0x1a5)),_0x50d4f4=_0x4f05ff[_0x2035ff(0x308)]['uuid'],_0x5405b5=timelyDecrypt(_0x50d4f4,![]),_0x228a41=_0x5e4b39['find'](_0x3dc70a=>_0x3dc70a[_0x2035ff(0x248)]==_0x5405b5);if(_0x228a41){const _0x2ef659=normalizeIP(_0x4f05ff[_0x2035ff(0x299)][_0x2035ff(0x2da)])[_0x2035ff(0x28d)],_0x17b286=_0x4f05ff[_0x2035ff(0x308)][_0x2035ff(0x1ac)];if(validateAccess(_0x17b286,_0x5405b5,_0x2ef659)[_0x2035ff(0x2d8)])_0x37b58a==_0x2035ff(0x2d4)&&await backupConfigFiles(),await zipFiles(_0x37b58a),_0x536e98[_0x2035ff(0x2f7)](zippath+(_0x37b58a+_0x2035ff(0x310)),_0x5297f8=>{const _0x403126=_0x2035ff;_0x5297f8&&(logger[_0x403126(0x33d)]('Failed\x20to\x20download\x20'+_0x37b58a),logger['simple'](_0x5297f8));});else logger[_0x2035ff(0x33d)](_0x2035ff(0x382)+_0x37b58a+_0x2035ff(0x1fc));}else logger[_0x2035ff(0x33d)](_0x2035ff(0x382)+_0x37b58a+'\x20(2)');}),app[_0x485691(0x386)](_0x485691(0x1a6),async(_0x118a52,_0x28c2ba)=>{const _0x20b8fd=_0x485691,_0x2f5ca6=getClientsWithBotID(_0x20b8fd(0x1a5)),_0x25855d=_0x118a52[_0x20b8fd(0x308)][_0x20b8fd(0x248)],_0x3d0fcb=timelyDecrypt(_0x25855d,![]),_0x8c0ebb=_0x2f5ca6[_0x20b8fd(0x247)](_0x115a7e=>_0x115a7e['uuid']==_0x3d0fcb);logger['debug'](_0x20b8fd(0x264));if(_0x8c0ebb){const _0x273d05=normalizeIP(_0x118a52['socket'][_0x20b8fd(0x2da)])[_0x20b8fd(0x28d)],_0x1431d1=_0x118a52[_0x20b8fd(0x308)]['tkn'];if(validateAccess(_0x1431d1,_0x3d0fcb,_0x273d05)['allow']){if(_0x118a52['files']){const _0x1d59d8=_0x118a52['files'][_0x20b8fd(0x20d)];await _0x1d59d8['mv'](temppath+_0x1d59d8[_0x20b8fd(0x244)]),_0x28c2ba[_0x20b8fd(0x245)]({'status':!![],'message':'File\x20uploaded'});const _0x43b5cc=getBotsWithMode();_0x43b5cc[_0x20b8fd(0x30b)]>0x0?confirmRestore(temppath,_0x1d59d8[_0x20b8fd(0x244)]):unzipFile(temppath,_0x1d59d8['name']);}}else logger[_0x20b8fd(0x33d)](_0x20b8fd(0x1eb));}else logger[_0x20b8fd(0x33d)](_0x20b8fd(0x367));}),app[_0x485691(0x2ac)](express[_0x485691(0x314)](path[_0x485691(0x1f3)](__dirname,bbpath2,_0x485691(0x2b8)))),app[_0x485691(0x2ac)](express[_0x485691(0x314)](path[_0x485691(0x1f3)](__dirname,bbpath2,_0x485691(0x36a)))),app[_0x485691(0x306)]('/',function(_0x434cab,_0x17aa96){const _0x38161b=_0x485691;_0x17aa96[_0x38161b(0x1bb)](path['join'](__dirname,bbpath2,_0x38161b(0x2b8),'index.html'));}),app['get'](_0x485691(0x29b),function(_0x4d9de7,_0x16339a){const _0x558f69=_0x485691;_0x16339a[_0x558f69(0x1bb)](path[_0x558f69(0x1f3)](__dirname,bbpath2,_0x558f69(0x36a),_0x558f69(0x2d3)));}),app[_0x485691(0x306)](_0x485691(0x230),(_0x33770b,_0x1e8b7f)=>{const _0x17ecd5=_0x485691;_0x1e8b7f[_0x17ecd5(0x1bb)](path[_0x17ecd5(0x1f3)](__dirname,bbpath2,'build','index.html'));}),app[_0x485691(0x306)](_0x485691(0x1dc),(_0x327c6d,_0x5c5cd6)=>{const _0x4dfc23=_0x485691;_0x5c5cd6[_0x4dfc23(0x1bb)](path['join'](__dirname,bbpath2,_0x4dfc23(0x36a),_0x4dfc23(0x2d3)));}),app[_0x485691(0x306)]('/:bot/coins',(_0x279320,_0x4badc6)=>{const _0x3f57e=_0x485691;_0x4badc6['sendFile'](path[_0x3f57e(0x1f3)](__dirname,bbpath2,_0x3f57e(0x36a),_0x3f57e(0x2d3)));}),app[_0x485691(0x306)]('/:bot/history',(_0x22b1a4,_0x1ab49f)=>{const _0x41e461=_0x485691;_0x1ab49f[_0x41e461(0x1bb)](path[_0x41e461(0x1f3)](__dirname,bbpath2,_0x41e461(0x36a),_0x41e461(0x2d3)));}),app['get'](_0x485691(0x1f6),(_0x245f08,_0xabd9e5)=>{const _0x312529=_0x485691;_0xabd9e5[_0x312529(0x1bb)](path[_0x312529(0x1f3)](__dirname,bbpath2,_0x312529(0x36a),_0x312529(0x2d3)));}),app[_0x485691(0x306)](_0x485691(0x2f2),(_0x3a3d7b,_0x20ef98)=>{const _0x36c96b=_0x485691;_0x20ef98[_0x36c96b(0x1bb)](path[_0x36c96b(0x1f3)](__dirname,bbpath2,'build','index.html'));});if(HOST)http[_0x485691(0x30a)](PORT,HOST);else http[_0x485691(0x30a)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x4c676c=_0x485691;let _0x5d3d98='[ip-address]';const _0x5035c8=networkInterfaces(),_0x315561={};for(const _0x3c65d5 of Object[_0x4c676c(0x275)](_0x5035c8)){for(const _0x3fe4d3 of _0x5035c8[_0x3c65d5]){if((_0x3fe4d3[_0x4c676c(0x39c)]==_0x4c676c(0x2d7)||_0x3fe4d3[_0x4c676c(0x39c)]==0x4)&&!_0x3fe4d3[_0x4c676c(0x2ef)]){const _0x4e2a51=ipaddr[_0x4c676c(0x381)](_0x3fe4d3['address'])[_0x4c676c(0x1e3)]();_0x4e2a51!='private'&&(!_0x315561[_0x3c65d5]&&(_0x315561[_0x3c65d5]=[]),_0x315561[_0x3c65d5][_0x4c676c(0x35a)](_0x3fe4d3[_0x4c676c(0x37b)]),_0x5d3d98=_0x3fe4d3[_0x4c676c(0x37b)]);}}}return{'serverip':_0x5d3d98,'netinterfaces':_0x315561};}async function startServer(){const _0x501757=_0x485691,{serverip:_0x5511a0,netinterfaces:_0x24577f}=getServerIP();logger['simple'](''),logger['simple'](_0x501757(0x262)),await logger['full'](_0x501757(0x1a1)+serverversion+'#RES#\x20'+(environment==_0x501757(0x1b7)?_0x501757(0x39f):'')+'\x0a'+(_0x501757(0x1c3)+PORT+_0x501757(0x23c))+('=>\x20Go\x20to\x20#CYA#http://'+_0x5511a0+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x501757(0x251)]('-----------------------------------------------------------------------------------');if(config['length']!=0x0)for(const _0x59da25 of config){const _0x3ab909=_0x59da25[_0x501757(0x2cc)]==_0x501757(0x2dd)?'a':'m';if(_0x59da25[_0x501757(0x200)]=='enabled'||_0x59da25['status']==_0x501757(0x36f))await logger[_0x501757(0x33d)](_0x501757(0x355)+_0x3ab909+_0x501757(0x26b)+_0x59da25['botID']+'\x20|\x20'+_0x59da25[_0x501757(0x22c)]),startBot([_0x59da25['botID'],userID],{'cwd':bbpath},function(_0x56f74e){if(_0x56f74e)logger['full'](_0x56f74e);});else(_0x59da25[_0x501757(0x200)]==_0x501757(0x307)||_0x59da25[_0x501757(0x200)]==_0x501757(0x31a))&&await logger[_0x501757(0x33d)](_0x501757(0x1b4)+_0x3ab909+_0x501757(0x34c)+_0x59da25[_0x501757(0x304)]+_0x501757(0x1cb)+_0x59da25[_0x501757(0x22c)]);}else!newBot&&logger[_0x501757(0x251)](_0x501757(0x33a));if(newBot)addBot();logger[_0x501757(0x251)](_0x501757(0x262)),logger[_0x501757(0x251)](''),await logger[_0x501757(0x32d)](_0x501757(0x220)+nodeversion),await logger[_0x501757(0x32d)]('Network\x20Interfaces:',_0x24577f);}function startSocket(){io['on']('connection',_0x6deb91=>{const _0x9d187b=_0x2509;let _0x170fba,_0x311463,_0x52df7c,_0x3a0e83,_0x5ed7b8;const _0x137eb4=_0x6deb91['handshake'][_0x9d187b(0x308)]['referer'];_0x311463=_0x137eb4[_0x9d187b(0x243)](/bot[0-9]{3}/);if(_0x311463)_0x52df7c=_0x311463[0x0][_0x9d187b(0x243)](/[0-9]{3}/);if(_0x52df7c)_0x170fba=_0x52df7c[0x0];else _0x170fba=_0x9d187b(0x1a5);const _0x1bdf12=_0x6deb91[_0x9d187b(0x1d0)]['auth']['encryptedUuid'];if(!_0x1bdf12)_0x6deb91[_0x9d187b(0x2be)](_0x9d187b(0x200),{'publicKey':secure[_0x9d187b(0x37d)]});else{_0x3a0e83=timelyDecrypt(_0x1bdf12,![]);if(!_0x3a0e83)_0x6deb91[_0x9d187b(0x2be)](_0x9d187b(0x200),{'publicKey':secure[_0x9d187b(0x37d)]});else{_0x5ed7b8=normalizeIP(_0x6deb91[_0x9d187b(0x23b)][_0x9d187b(0x2da)])[_0x9d187b(0x28d)];if(!devices[_0x3a0e83])devices[_0x3a0e83]={'uuid':_0x3a0e83,'access':{'token':null}};devices[_0x3a0e83]['ip']=_0x5ed7b8;const _0x245e97=addClient(_0x6deb91['id'],_0x3a0e83,_0x170fba);setAccess(_0x245e97),emitMessages(),_0x6deb91['on'](_0x9d187b(0x25f),_0x1b210a=>{const _0x31122b=_0x9d187b,_0x2966c0=timelyDecrypt(_0x1b210a[_0x31122b(0x395)],!![],_0x31122b(0x3a6));if(_0x2966c0){_0x1b210a={'username':_0x1b210a[_0x31122b(0x394)],'password':_0x2966c0},devices[_0x3a0e83]['access']=validateCredentials(_0x1b210a,_0x3a0e83);if(devices[_0x3a0e83][_0x31122b(0x20a)]['allow']==![]&&devices[_0x3a0e83][_0x31122b(0x20a)][_0x31122b(0x29d)]==_0x31122b(0x21a))_0x6deb91[_0x31122b(0x2be)](_0x31122b(0x200),{'access':devices[_0x3a0e83][_0x31122b(0x20a)]}),loginAccess2FA(_0x3a0e83,_0x5ed7b8);else{if(devices[_0x3a0e83][_0x31122b(0x20a)][_0x31122b(0x2d8)]==![]&&devices[_0x3a0e83][_0x31122b(0x20a)]['reason']=='invalid\x20credentials')_0x6deb91[_0x31122b(0x2be)](_0x31122b(0x200),{'access':devices[_0x3a0e83]['access']});else devices[_0x3a0e83][_0x31122b(0x20a)]['allow']&&devices[_0x3a0e83][_0x31122b(0x20a)][_0x31122b(0x29d)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x3a0e83)[_0x31122b(0x256)](_0xf81c6=>{setAccess(_0xf81c6);}),logger[_0x31122b(0x32d)]('Logged\x20in\x20user\x20...'+_0x3a0e83['slice'](-0x8)),setTokenRefresh(_0x3a0e83),setSessionTimeout(_0x31122b(0x25f),_0x3a0e83));}}else logger[_0x31122b(0x33d)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x6deb91['on']('reset-password',()=>{resetPassword();}),_0x6deb91['on'](_0x9d187b(0x312),_0x224b79=>{removeClient(_0x6deb91['id']);}),_0x170fba=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4f51c5){const _0x1c231e=_0x485691;if(_0x4f51c5!='botmanager'&&config[_0x1c231e(0x332)]!=''){if(pid[_0x4f51c5])pid[_0x4f51c5][_0x1c231e(0x245)]({'function':'initclient','args':null});}_0x4f51c5!=_0x1c231e(0x1a5)&&broadcastToBots(_0x1c231e(0x29e),JSON[_0x1c231e(0x2b1)](config));}function reloadBotManager(){const _0x2fb15a=_0x485691;getClientsWithBotID(_0x2fb15a(0x1a5))[_0x2fb15a(0x256)](_0x5c2ff9=>{const _0x4bb091=_0x2fb15a;getSocket(_0x5c2ff9['id'])[_0x4bb091(0x2be)](_0x4bb091(0x200),{'access':{'allow':![],'reason':_0x4bb091(0x1d2),'token':null}});});}function getSocket(_0x3b4805){const _0x4e64b0=_0x485691;return io[_0x4e64b0(0x21c)]['sockets']['get'](_0x3b4805);}function setAccess(_0x15b0fb){const _0x45cd8a=_0x485691,_0x57cce1=getSocket(_0x15b0fb['id']),_0xf93765=_0x15b0fb[_0x45cd8a(0x248)],_0x5bdc10=_0x15b0fb['bot'];devices[_0xf93765][_0x45cd8a(0x20a)]=validateAccess(devices[_0xf93765]['access'][_0x45cd8a(0x1d5)],_0xf93765),logger[_0x45cd8a(0x32d)](_0x45cd8a(0x334)+devices[_0xf93765][_0x45cd8a(0x20a)][_0x45cd8a(0x29d)]+_0x45cd8a(0x33c)+_0x15b0fb['id']['slice'](-0x8)+_0x45cd8a(0x379)+_0xf93765['slice'](-0x8)),_0x57cce1[_0x45cd8a(0x1f3)](_0xf93765);if(devices[_0xf93765]['access'][_0x45cd8a(0x2d8)]){_0x57cce1['join'](_0x5bdc10);if(_0x5bdc10=='botmanager')initializeSocketBotManager(_0x57cce1);else initializeSocketBot(_0x57cce1);initClient(_0x5bdc10);}devices[_0xf93765][_0x45cd8a(0x20a)][_0x45cd8a(0x1d5)]&&devices[_0xf93765]['access']['reason']==_0x45cd8a(0x261)&&setSessionTimeout(_0x45cd8a(0x1a7),_0xf93765),devices[_0xf93765]['access']['token']&&devices[_0xf93765][_0x45cd8a(0x20a)]['reason']=='2FA\x20login\x20token\x20generated'&&setSessionTimeout('login',_0xf93765),_0x57cce1[_0x45cd8a(0x2be)](_0x45cd8a(0x200),{'status':_0x15b0fb[_0x45cd8a(0x2b6)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xf93765][_0x45cd8a(0x20a)],'externalip':devices[_0xf93765]['ip'],'publicKey':secure[_0x45cd8a(0x37d)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0xf93765][_0x45cd8a(0x20a)][_0x45cd8a(0x2d8)]==![]&&devices[_0xf93765][_0x45cd8a(0x20a)][_0x45cd8a(0x29d)]==_0x45cd8a(0x1b2)&&temporaryAccess2FA(_0xf93765,devices[_0xf93765]['ip']);}function setSessionTimeout(_0x4ef614,_0x1ddf4e){const _0x2286e6=_0x485691;let _0xde6df1;if(_0x4ef614==_0x2286e6(0x25f))_0xde6df1=loginExpiry*0x3c*0x3e8;else _0xde6df1=devices[_0x1ddf4e][_0x2286e6(0x37f)][_0x2286e6(0x27c)]*0x3c*0x3e8-(new Date()[_0x2286e6(0x24d)]()-devices[_0x1ddf4e]['telegramIpApproval'][_0x2286e6(0x28a)]);if(devices[_0x1ddf4e][_0x2286e6(0x267)])clearTimeout(devices[_0x1ddf4e][_0x2286e6(0x267)]);devices[_0x1ddf4e][_0x2286e6(0x267)]=setTimeout(()=>{const _0x323034=_0x2286e6;if(devices[_0x1ddf4e]['pidRefreshToken'])clearTimeout(devices[_0x1ddf4e][_0x323034(0x29a)]);removeSocketListeners(_0x1ddf4e),addBlacklist(_0x1ddf4e),devices[_0x1ddf4e][_0x323034(0x37f)]=null,devices[_0x1ddf4e][_0x323034(0x2bb)]=null,devices[_0x1ddf4e][_0x323034(0x20a)][_0x323034(0x1d5)]=null,logger['debug']('Session\x20expired\x20for\x20user\x20...'+_0x1ddf4e['slice'](-0x8)),devices[_0x1ddf4e][_0x323034(0x20a)]=validateAccess(devices[_0x1ddf4e][_0x323034(0x20a)][_0x323034(0x1d5)],_0x1ddf4e),!(devices[_0x1ddf4e]['access'][_0x323034(0x2d8)]&&devices[_0x1ddf4e]['access'][_0x323034(0x29d)]==_0x323034(0x323))&&(_0x4ef614=='login'?io['to'](_0x1ddf4e)['emit'](_0x323034(0x200),{'access':{'allow':![],'reason':_0x323034(0x1e8),'token':null}}):io['to'](_0x1ddf4e)[_0x323034(0x2be)](_0x323034(0x200),{'access':{'allow':![],'reason':_0x323034(0x1a4),'token':null}})),devices[_0x1ddf4e][_0x323034(0x20a)]['token']=null;},_0xde6df1);}function setTokenRefresh(_0x464cde){const _0x13aa82=_0x485691;if(devices[_0x464cde]['pidRefreshToken'])clearTimeout(devices[_0x464cde][_0x13aa82(0x29a)]);devices[_0x464cde][_0x13aa82(0x29a)]=setTimeout(()=>{const _0x4ad0e7=_0x13aa82;getClientsWithUuid(_0x464cde)[_0x4ad0e7(0x30b)]!=0x0?(devices[_0x464cde][_0x4ad0e7(0x20a)]=refreshToken(_0x464cde),io['to'](_0x464cde)[_0x4ad0e7(0x2be)](_0x4ad0e7(0x200),{'status':_0x4ad0e7(0x2fe),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x464cde]['access'],'externalip':devices[_0x464cde]['ip'],'publicKey':secure[_0x4ad0e7(0x37d)],'validInstallation':validInstallation}),setTokenRefresh(_0x464cde)):clearTimeout(devices[_0x464cde][_0x4ad0e7(0x29a)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0xbbdd14){const _0x246f9c=_0x485691,_0x1af014=getClient(_0xbbdd14['id'])[_0x246f9c(0x248)];_0xbbdd14[_0x246f9c(0x2be)](_0x246f9c(0x29e),config),_0xbbdd14['emit'](_0x246f9c(0x35d),cleanSettings()),_0xbbdd14['on']('add-bot',_0xb2456=>{const _0x4711b2=_0x246f9c;if(validateAccess(_0xb2456,_0x1af014)[_0x4711b2(0x2d8)])addBot();else logger['full'](_0x4711b2(0x324));}),_0xbbdd14['on']('update-bot',(_0x1d6624,_0x4fa4d1)=>{const _0x1fe442=_0x246f9c;if(validateAccess(_0x4fa4d1,_0x1af014)[_0x1fe442(0x2d8)])toggleBot(_0x1d6624['botID'],_0x1d6624[_0x1fe442(0x200)],_0x1d6624[_0x1fe442(0x317)]);else logger[_0x1fe442(0x33d)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0xbbdd14['on'](_0x246f9c(0x1d3),(_0x50631f,_0x35b217)=>{const _0x1af27d=_0x246f9c;if(validateAccess(_0x35b217,_0x1af014)[_0x1af27d(0x2d8)])toggleBotMode(_0x50631f);else logger['full'](_0x1af27d(0x309));}),_0xbbdd14['on']('delete-bot',(_0x5a56c2,_0x2414ae)=>{const _0x4b35db=_0x246f9c;if(validateAccess(_0x2414ae,_0x1af014)[_0x4b35db(0x2d8)])deleteBot(_0x5a56c2);else logger['full'](_0x4b35db(0x266));}),_0xbbdd14['on'](_0x246f9c(0x380),(_0x4d1fd1,_0x61feef)=>{const _0x4b361b=_0x246f9c;if(validateAccess(_0x61feef,_0x1af014)[_0x4b361b(0x2d8)])storeSettings(_0x4d1fd1,!![]);else logger[_0x4b361b(0x33d)](_0x4b361b(0x1d1));}),_0xbbdd14['on'](_0x246f9c(0x2a2),_0x4b2e91=>{const _0x1ae7af=_0x246f9c;if(validateAccess(_0x4b2e91,_0x1af014)['allow'])updateBB(_0x1ae7af(0x385));else logger[_0x1ae7af(0x33d)](_0x1ae7af(0x255));}),_0xbbdd14['on'](_0x246f9c(0x37a),_0x27522a=>{const _0x63470e=_0x246f9c;if(validateAccess(_0x27522a,_0x1af014)[_0x63470e(0x2d8)])updateBB(_0x63470e(0x37c));else logger['full'](_0x63470e(0x335));}),_0xbbdd14['on']('get-backup-files',_0xc4d71f=>{const _0x4ade93=_0x246f9c;if(validateAccess(_0xc4d71f,_0x1af014)[_0x4ade93(0x2d8)]){const _0x5a633d=getClient(_0xbbdd14['id']);if(_0x5a633d)getBackupFiles(_0x5a633d[_0x4ade93(0x248)]);else logger[_0x4ade93(0x33d)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x4ade93(0x33d)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0xbbdd14['on'](_0x246f9c(0x201),(_0x4ac97a,_0x124be8)=>{if(validateAccess(_0x124be8,_0x1af014)['allow'])restoreBackupFile(_0x4ac97a);else logger['full']('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0xbbdd14['on']('get-messages',_0x38bb13=>{const _0x36e397=_0x246f9c;if(validateAccess(_0x38bb13,_0x1af014)[_0x36e397(0x2d8)])getMessages();else logger[_0x36e397(0x33d)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0xbbdd14['on']('confirm-message',(_0x374d41,_0x3a14a8)=>{const _0x5ebf8d=_0x246f9c;if(validateAccess(_0x3a14a8,_0x1af014)['allow'])confirmMessage(_0x374d41);else logger[_0x5ebf8d(0x33d)](_0x5ebf8d(0x2fa));}),_0xbbdd14['on'](_0x246f9c(0x1bf),_0x37ee4c=>{const _0x3ba998=_0x246f9c;if(validateAccess(_0x37ee4c,_0x1af014)['allow']){if(devices[_0x1af014][_0x3ba998(0x29a)])clearTimeout(devices[_0x1af014][_0x3ba998(0x29a)]);if(devices[_0x1af014][_0x3ba998(0x267)])clearTimeout(devices[_0x1af014][_0x3ba998(0x267)]);removeSocketListeners(getClient(_0xbbdd14['id'])[_0x3ba998(0x248)]),addBlacklist(_0x1af014),devices[_0x1af014][_0x3ba998(0x37f)]=null,devices[_0x1af014][_0x3ba998(0x2bb)]=null,devices[_0x1af014]['access'][_0x3ba998(0x1d5)]=null,logger[_0x3ba998(0x32d)](_0x3ba998(0x2d6)+_0x1af014[_0x3ba998(0x1e2)](-0x8)),io['to'](getClient(_0xbbdd14['id'])[_0x3ba998(0x248)])[_0x3ba998(0x2be)](_0x3ba998(0x200),{'access':{'allow':![],'reason':_0x3ba998(0x2f4),'token':null}});}else logger[_0x3ba998(0x33d)](_0x3ba998(0x341));});}function initializeSocketBot(_0x513670){const _0x4e0c2b=_0x485691,_0x26bd47=getClient(_0x513670['id'])[_0x4e0c2b(0x2ff)],_0x40228d=getClient(_0x513670['id'])[_0x4e0c2b(0x248)];_0x513670['on'](_0x4e0c2b(0x338),(_0x466c1d,_0xfc9b37)=>{const _0x438127=_0x4e0c2b;if(validateAccess(_0xfc9b37,_0x40228d)[_0x438127(0x2d8)]){if(pid[_0x26bd47])pid[_0x26bd47]['send']({'function':'emitHistory','args':_0x466c1d});}else logger[_0x438127(0x33d)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x513670['on'](_0x4e0c2b(0x34b),(_0x19853b,_0x51b771)=>{const _0xb3f3ac=_0x4e0c2b;if(validateAccess(_0x51b771,_0x40228d)[_0xb3f3ac(0x2d8)]){if(pid[_0x26bd47])pid[_0x26bd47][_0xb3f3ac(0x245)]({'function':'deleteHistoryAlerts','args':_0x19853b});}else logger[_0xb3f3ac(0x33d)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x513670['on'](_0x4e0c2b(0x290),(_0x185e23,_0x2efa03)=>{const _0x475247=_0x4e0c2b;if(validateAccess(_0x2efa03,_0x40228d)[_0x475247(0x2d8)]){if(pid[_0x26bd47])pid[_0x26bd47]['send']({'function':'getPortfolio','args':_0x185e23});}else logger[_0x475247(0x33d)](_0x475247(0x362));}),_0x513670['on']('store-configuration',(_0x30cf79,_0x111945)=>{const _0x57ea6d=_0x4e0c2b;if(validateAccess(_0x111945,_0x40228d)[_0x57ea6d(0x2d8)]){if(pid[_0x26bd47])pid[_0x26bd47][_0x57ea6d(0x245)]({'function':_0x57ea6d(0x344),'args':_0x30cf79});}else logger[_0x57ea6d(0x33d)](_0x57ea6d(0x349));}),_0x513670['on']('store-headless',(_0x5c99da,_0x53de4a)=>{const _0x3af7ec=_0x4e0c2b;if(validateAccess(_0x53de4a,_0x40228d)[_0x3af7ec(0x2d8)]){if(pid[_0x26bd47])pid[_0x26bd47][_0x3af7ec(0x245)]({'function':'storeHeadless','args':_0x5c99da});}else logger['full'](_0x3af7ec(0x387));}),_0x513670['on'](_0x4e0c2b(0x1a9),(_0x3092f0,_0x205363)=>{const _0x572459=_0x4e0c2b;if(validateAccess(_0x205363,_0x40228d)['allow']){if(pid[_0x26bd47])pid[_0x26bd47][_0x572459(0x245)]({'function':'storeFiat','args':_0x3092f0});}else logger[_0x572459(0x33d)](_0x572459(0x206));}),_0x513670['on'](_0x4e0c2b(0x30f),_0x1afab0=>{const _0x533d70=_0x4e0c2b;if(validateAccess(_0x1afab0,_0x40228d)['allow']){if(pid[_0x26bd47])pid[_0x26bd47]['send']({'function':'resetHistory','args':null});}else logger[_0x533d70(0x33d)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x513670['on'](_0x4e0c2b(0x296),_0x3645d5=>{const _0x153d4e=_0x4e0c2b;if(validateAccess(_0x3645d5,_0x40228d)[_0x153d4e(0x2d8)]){if(pid[_0x26bd47])pid[_0x26bd47][_0x153d4e(0x245)]({'function':'getStartingBalances','args':null});}else logger[_0x153d4e(0x33d)](_0x153d4e(0x26c));}),_0x513670['on'](_0x4e0c2b(0x265),(_0x4400f4,_0x1f692e)=>{const _0xba4074=_0x4e0c2b;if(validateAccess(_0x1f692e,_0x40228d)[_0xba4074(0x2d8)]){if(pid[_0x26bd47])pid[_0x26bd47][_0xba4074(0x245)]({'function':_0xba4074(0x2f6),'args':_0x4400f4});}else logger[_0xba4074(0x33d)](_0xba4074(0x20b));}),_0x513670['on'](_0x4e0c2b(0x298),_0xbe037c=>{const _0x8b9a8c=_0x4e0c2b;if(validateAccess(_0xbe037c,_0x40228d)[_0x8b9a8c(0x2d8)]){if(pid[_0x26bd47])pid[_0x26bd47][_0x8b9a8c(0x245)]({'function':_0x8b9a8c(0x38e),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x513670['on'](_0x4e0c2b(0x330),_0x532b4a=>{const _0x111aa3=_0x4e0c2b;if(validateAccess(_0x532b4a,_0x40228d)['allow']){if(pid[_0x26bd47])pid[_0x26bd47][_0x111aa3(0x245)]({'function':_0x111aa3(0x28c),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x513670['on'](_0x4e0c2b(0x2a2),_0x52bb73=>{const _0x10d88a=_0x4e0c2b;if(validateAccess(_0x52bb73,_0x40228d)[_0x10d88a(0x2d8)])updateBB(_0x10d88a(0x385));else logger[_0x10d88a(0x33d)](_0x10d88a(0x255));}),_0x513670['on']('get-messages',_0x2bbe3a=>{const _0x1f8f2b=_0x4e0c2b;if(validateAccess(_0x2bbe3a,_0x40228d)[_0x1f8f2b(0x2d8)])getMessages();else logger[_0x1f8f2b(0x33d)](_0x1f8f2b(0x1c6));}),_0x513670['on'](_0x4e0c2b(0x1ed),(_0x2bdd52,_0x2ab17e)=>{const _0x30f197=_0x4e0c2b;if(validateAccess(_0x2ab17e,_0x40228d)['allow'])confirmMessage(_0x2bdd52);else logger[_0x30f197(0x33d)](_0x30f197(0x2fa));}),_0x513670['on'](_0x4e0c2b(0x1bf),_0x644382=>{const _0x2e10bb=_0x4e0c2b;if(validateAccess(_0x644382,_0x40228d)[_0x2e10bb(0x2d8)]){if(devices[_0x40228d][_0x2e10bb(0x29a)])clearTimeout(devices[_0x40228d][_0x2e10bb(0x29a)]);if(devices[_0x40228d]['pidExpireLogin'])clearTimeout(devices[_0x40228d]['pidExpireLogin']);removeSocketListeners(getClient(_0x513670['id'])[_0x2e10bb(0x248)]),addBlacklist(_0x40228d),devices[_0x40228d][_0x2e10bb(0x37f)]=null,devices[_0x40228d][_0x2e10bb(0x2bb)]=null,devices[_0x40228d][_0x2e10bb(0x20a)][_0x2e10bb(0x1d5)]=null,logger[_0x2e10bb(0x32d)](_0x2e10bb(0x2d6)+_0x40228d[_0x2e10bb(0x1e2)](-0x8)),io['to'](getClient(_0x513670['id'])[_0x2e10bb(0x248)])[_0x2e10bb(0x2be)](_0x2e10bb(0x200),{'access':{'allow':![],'reason':_0x2e10bb(0x2f4),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x2d22a3){const _0xe0f3b8=_0x485691;getClientsWithUuid(_0x2d22a3)[_0xe0f3b8(0x256)](_0x1b4378=>{const _0x3d7bd9=_0xe0f3b8;getSocket(_0x1b4378['id'])[_0x3d7bd9(0x246)]();});}function cleanSettings(){const _0x278aa6=_0x485691;let _0x391aae=settings;return settings[_0x278aa6(0x1c9)]&&settings[_0x278aa6(0x1c9)]!=''&&(_0x391aae={..._0x391aae,'telegramToken':_0x278aa6(0x252)}),settings[_0x278aa6(0x373)]&&settings[_0x278aa6(0x373)]!=''&&(_0x391aae={..._0x391aae,'bbPassword':_0x278aa6(0x252)}),settings[_0x278aa6(0x38b)]&&settings[_0x278aa6(0x38b)]!=''&&(_0x391aae={..._0x391aae,'marketcapApi':'************'}),(settings[_0x278aa6(0x373)]&&settings['bbPassword']=='***'||settings[_0x278aa6(0x1c9)]&&settings[_0x278aa6(0x1c9)]==_0x278aa6(0x291)||settings['marketcapApi']&&settings[_0x278aa6(0x38b)]==_0x278aa6(0x291))&&(_0x391aae={..._0x391aae,'restored':{'password':settings[_0x278aa6(0x373)]=='***','telegram':settings['telegramToken']==_0x278aa6(0x291),'marketcap':settings['marketcapApi']==_0x278aa6(0x291)}}),_0x391aae;}async function updateBB(_0x215ab7){const _0x1be3aa=_0x485691;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x502f76=>{restartBot(_0x502f76['botID']);});if(_0x215ab7==_0x1be3aa(0x385))process['send']({'update':!![],'environment':environment},_0x4c6fcb=>{});else _0x215ab7==_0x1be3aa(0x37c)&&process['send']({'reinstall':!![],'environment':environment},_0x2435ca=>{});}function startBot(_0x47c50f,_0x5c2dc5,_0x10a6dc){const _0x1e9fe3=_0x485691;if(debugging)_0x47c50f[_0x1e9fe3(0x35a)]('-d');let _0x1417d3=![];const _0x4a26c8=_0x47c50f[0x0];_0x5c2dc5={..._0x5c2dc5,'stdio':[_0x1e9fe3(0x393),_0x1e9fe3(0x393),_0x1e9fe3(0x393),_0x1e9fe3(0x377)]},pid[_0x4a26c8]=childProcess[_0x1e9fe3(0x22f)](botfile,_0x47c50f,_0x5c2dc5),pid[_0x4a26c8]['on']('message',_0x5756af=>{const _0x27e113=_0x1e9fe3;switch(Object[_0x27e113(0x275)](_0x5756af)[0x0]){case _0x27e113(0x22c):updateBotName(_0x4a26c8,_0x5756af[_0x27e113(0x22c)]);break;case _0x27e113(0x363):updateBotManager();break;case'status':updateStatus(_0x4a26c8,_0x5756af[_0x27e113(0x200)]);break;case _0x27e113(0x317):updateLive(_0x4a26c8,_0x5756af[_0x27e113(0x317)]);break;case'started':updateLive(_0x4a26c8,_0x5756af['started']),io['to'](_0x4a26c8)[_0x27e113(0x2be)]('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case'stop':_0x5756af[_0x27e113(0x20c)]==_0x27e113(0x27e)&&restartBot(_0x4a26c8);_0x5756af[_0x27e113(0x20c)]==_0x27e113(0x1e5)&&toggleBot(_0x4a26c8,_0x27e113(0x307),_0x27e113(0x1b8));break;case _0x27e113(0x2e7):sendTelegramBot(_0x4a26c8,_0x5756af[_0x27e113(0x2e7)]);break;case _0x27e113(0x274):sendTelegramMsg(_0x5756af[_0x27e113(0x274)]);break;case _0x27e113(0x270):io['to'](_0x4a26c8)['emit'](_0x5756af[_0x27e113(0x270)],_0x5756af['args']);break;}}),pid[_0x4a26c8]['on'](_0x1e9fe3(0x397),function(_0x2166fd){if(_0x1417d3)return;_0x1417d3=!![],_0x10a6dc(_0x2166fd);}),pid[_0x4a26c8]['on'](_0x1e9fe3(0x222),async function(_0x2bdbdc){const _0x2fb858=_0x1e9fe3;if(terminating)return;if(installingUpdate){logger[_0x2fb858(0x32d)](_0x2fb858(0x283)),io['close']();return;}if(_0x1417d3)return;_0x1417d3=!![],_0x10a6dc(null);const _0x2586cb=dbConfig[_0x2fb858(0x306)](_0x2fb858(0x29e))[_0x2fb858(0x247)]({'botID':_0x4a26c8})[_0x2fb858(0x249)]();_0x2586cb&&(_0x2586cb['status']=='enabled'||_0x2586cb[_0x2fb858(0x200)]==_0x2fb858(0x36f))&&(await sleep(0x3e8),updateLive(_0x4a26c8,_0x2fb858(0x1b8)),logger[_0x2fb858(0x33d)](_0x2fb858(0x1b6)+_0x4a26c8),startBot([_0x4a26c8,userID],{'cwd':bbpath},function(_0x2e52d6){const _0x51f88c=_0x2fb858;if(_0x2e52d6)logger[_0x51f88c(0x33d)](_0x2e52d6);}));});}function stopBot(_0x5cc92a){const _0x43f37a=_0x485691;getClientsWithBotID(_0x5cc92a)[_0x43f37a(0x256)](_0x35aa2d=>{getSocket(_0x35aa2d['id'])['disconnect'](!![]),removeClient(_0x35aa2d['id']);}),pid[_0x5cc92a]&&(pid[_0x5cc92a]['kill'](),pid[_0x5cc92a]=null);}function stopAllBots(){const _0x39a890=_0x485691;terminating=!![];const _0x1c5b24=getEnabledBots();_0x1c5b24[_0x39a890(0x256)](_0x14e45e=>{const _0x2cc64f=_0x39a890;stopBot(_0x14e45e[_0x2cc64f(0x304)]);});}function restartBot(_0x38c3eb){const _0x5d76bd=_0x485691;if(pid[_0x38c3eb])pid[_0x38c3eb][_0x5d76bd(0x1e5)]();}function addBot(){const _0x3fe09f=_0x485691;let _0x3ba0c3;for(let _0x580075=0x1;_0x580075<0x3e9;_0x580075++){_0x3ba0c3=_0x580075[_0x3fe09f(0x2ec)]()[_0x3fe09f(0x239)](0x3,'0');let _0x11ffed=config[_0x3fe09f(0x247)](_0x4f601b=>_0x4f601b['botID']==_0x3ba0c3);if(!_0x11ffed)break;}if(_0x3ba0c3===_0x3fe09f(0x29c)){logger[_0x3fe09f(0x33d)](_0x3fe09f(0x23f));return;}logger[_0x3fe09f(0x33d)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x3ba0c3),dbConfig['get']('bots')[_0x3fe09f(0x35a)]({'botID':_0x3ba0c3,'botname':_0x3fe09f(0x322)+_0x3ba0c3,'status':'new','live':''})[_0x3fe09f(0x2b7)](),startBot([_0x3ba0c3,userID],{'cwd':bbpath},function(_0x1a8ac0){const _0x53ec54=_0x3fe09f;if(_0x1a8ac0)logger[_0x53ec54(0x33d)](_0x1a8ac0);}),config=getConfiguration(),io['to'](_0x3fe09f(0x1a5))[_0x3fe09f(0x2be)](_0x3fe09f(0x29e),config),broadcastToBots(_0x3fe09f(0x29e),JSON[_0x3fe09f(0x2b1)](config));}function deleteBot(_0xedb59){const _0x507ad1=_0x485691;getClientsWithBotID(_0xedb59)[_0x507ad1(0x256)](_0x33865e=>{getSocket(_0x33865e['id'])['disconnect'](!![]),removeClient(_0x33865e['id']);}),dbConfig[_0x507ad1(0x306)](_0x507ad1(0x29e))[_0x507ad1(0x27a)]({'botID':_0xedb59})[_0x507ad1(0x2b7)](),logger[_0x507ad1(0x33d)](_0x507ad1(0x2fb)+_0xedb59),stopBot(_0xedb59);try{if(fs[_0x507ad1(0x1a0)](path[_0x507ad1(0x1f3)](configpath,_0x507ad1(0x305)+_0xedb59+_0x507ad1(0x357))))fs['unlinkSync'](path[_0x507ad1(0x1f3)](configpath,_0x507ad1(0x305)+_0xedb59+'-config.json'));if(fs['existsSync'](path['join'](configpath,_0x507ad1(0x305)+_0xedb59+_0x507ad1(0x2ad))))fs[_0x507ad1(0x38c)](path['join'](configpath,_0x507ad1(0x305)+_0xedb59+_0x507ad1(0x2ad)));if(fs['existsSync'](path['join'](configpath,_0x507ad1(0x305)+_0xedb59+_0x507ad1(0x38f))))fs['unlinkSync'](path[_0x507ad1(0x1f3)](configpath,'bot-'+_0xedb59+_0x507ad1(0x38f)));if(fs[_0x507ad1(0x1a0)](path[_0x507ad1(0x1f3)](configpath,'bot-'+_0xedb59+_0x507ad1(0x1ab))))fs[_0x507ad1(0x38c)](path[_0x507ad1(0x1f3)](configpath,'bot-'+_0xedb59+_0x507ad1(0x1ab)));}catch(_0x553217){if(_0x553217)logger[_0x507ad1(0x33d)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x553217);}config=getConfiguration(),io['to'](_0x507ad1(0x1a5))[_0x507ad1(0x2be)](_0x507ad1(0x29e),config),broadcastToBots(_0x507ad1(0x29e),JSON['stringify'](config));}function toggleBot(_0x385656,_0x5aebe0,_0x25c95e){const _0x1d78bd=_0x485691;dbConfig[_0x1d78bd(0x306)](_0x1d78bd(0x29e))['find']({'botID':_0x385656})[_0x1d78bd(0x35e)]({'status':_0x5aebe0})[_0x1d78bd(0x35e)]({'live':_0x25c95e})['write']();if(_0x5aebe0==_0x1d78bd(0x2d1)||_0x5aebe0==_0x1d78bd(0x36f))logger[_0x1d78bd(0x33d)](_0x1d78bd(0x2a4)+_0x385656),startBot([_0x385656,userID],{'cwd':bbpath},function(_0x47e8a0){const _0x4fde30=_0x1d78bd;if(_0x47e8a0)logger[_0x4fde30(0x33d)](_0x47e8a0);});else(_0x5aebe0==_0x1d78bd(0x307)||_0x5aebe0==_0x1d78bd(0x31a))&&(logger[_0x1d78bd(0x33d)](_0x1d78bd(0x26f)+_0x385656),stopBot(_0x385656));config=getConfiguration(),io['to']('botmanager')[_0x1d78bd(0x2be)](_0x1d78bd(0x29e),config),broadcastToBots(_0x1d78bd(0x29e),JSON[_0x1d78bd(0x2b1)](config));}function toggleStatus(_0x2bf6bb){const _0x5392b2=_0x485691;let _0x4358a4=dbConfig[_0x5392b2(0x306)](_0x5392b2(0x29e))[_0x5392b2(0x247)]({'botID':_0x2bf6bb})[_0x5392b2(0x249)](),_0x3f6d63;if(_0x4358a4[_0x5392b2(0x200)]===_0x5392b2(0x2d1))_0x3f6d63=_0x5392b2(0x307);else{if(_0x4358a4[_0x5392b2(0x200)]===_0x5392b2(0x36f))_0x3f6d63=_0x5392b2(0x31a);else{if(_0x4358a4[_0x5392b2(0x200)]==='new-disabled')_0x3f6d63=_0x5392b2(0x36f);else{if(_0x4358a4['status']===_0x5392b2(0x307))_0x3f6d63=_0x5392b2(0x2d1);}}}return _0x3f6d63;}function updateStatus(_0x2d7982,_0x57a26b){const _0x20b43f=_0x485691;dbConfig['get'](_0x20b43f(0x29e))[_0x20b43f(0x247)]({'botID':_0x2d7982})[_0x20b43f(0x35e)]({'status':_0x57a26b})[_0x20b43f(0x2b7)](),config=getConfiguration(),io['to'](_0x20b43f(0x1a5))['emit']('bots',config),broadcastToBots(_0x20b43f(0x29e),JSON[_0x20b43f(0x2b1)](config));}function updateLive(_0x437065,_0x2dafd4){const _0x5cbeb2=_0x485691;dbConfig[_0x5cbeb2(0x306)](_0x5cbeb2(0x29e))['find']({'botID':_0x437065})[_0x5cbeb2(0x35e)]({'live':_0x2dafd4})[_0x5cbeb2(0x2b7)](),config=getConfiguration(),io['to']('botmanager')[_0x5cbeb2(0x2be)](_0x5cbeb2(0x29e),config),broadcastToBots(_0x5cbeb2(0x29e),JSON[_0x5cbeb2(0x2b1)](config));}function updateBotName(_0x890984,_0x236f48){const _0x2d0b5e=_0x485691;dbConfig[_0x2d0b5e(0x306)](_0x2d0b5e(0x29e))[_0x2d0b5e(0x247)]({'botID':_0x890984})['assign']({'botname':_0x236f48})[_0x2d0b5e(0x2b7)](),config=getConfiguration(),io['to']('botmanager')[_0x2d0b5e(0x2be)]('bots',config),broadcastToBots(_0x2d0b5e(0x29e),JSON[_0x2d0b5e(0x2b1)](config));}function updateBotManager(){const _0x59601f=_0x485691;config=getConfiguration(),io['to'](_0x59601f(0x1a5))[_0x59601f(0x2be)]('bots',config),broadcastToBots(_0x59601f(0x29e),JSON[_0x59601f(0x2b1)](config));}function _0x2509(_0x2d41b9,_0x1c0a26){const _0x40e05b=_0x7996();return _0x2509=function(_0x2baa1e,_0x16c1ee){_0x2baa1e=_0x2baa1e-0x1a0;let _0x799673=_0x40e05b[_0x2baa1e];return _0x799673;},_0x2509(_0x2d41b9,_0x1c0a26);}function toggleBotMode(_0x124ccc){const _0x220260=_0x485691;if(pid[_0x124ccc])pid[_0x124ccc][_0x220260(0x245)]({'function':'toggleBotMode','args':null});else{const _0x5dd0d8=configpath+_0x220260(0x305)+_0x124ccc+_0x220260(0x357),_0xe8d7a=fs[_0x220260(0x39b)](_0x5dd0d8),_0x2ec67e=JSON[_0x220260(0x381)](_0xe8d7a),_0x431ce8=_0x2ec67e[_0x220260(0x2ff)][0x0][_0x220260(0x22b)];_0x2ec67e[_0x220260(0x2ff)][0x0][_0x220260(0x22b)]=!_0x431ce8;const _0x4d620c=JSON[_0x220260(0x2b1)](_0x2ec67e,null,0x2);fs[_0x220260(0x240)](_0x5dd0d8,_0x4d620c),config=getConfiguration(),io['to']('botmanager')['emit'](_0x220260(0x29e),config),broadcastToBots(_0x220260(0x29e),JSON[_0x220260(0x2b1)](config));}}function validateTelegram(_0x18b877){const _0x11083a=_0x485691;if(_0x18b877[_0x11083a(0x359)]['username']!=settings[_0x11083a(0x361)]&&'@'+_0x18b877[_0x11083a(0x359)]['username']!=settings[_0x11083a(0x361)]||_0x18b877[_0x11083a(0x21b)]['id']!=settings[_0x11083a(0x3a4)])return sendTelegram(_0x18b877[_0x11083a(0x21b)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x11083a(0x2de)}),![];return!![];}async function initTelegram(){const _0x6295ab=_0x485691;if(tgBot)tgBot[_0x6295ab(0x20c)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x6295ab(0x1c9)]);let _0x2baa5d=_0x6295ab(0x1c8);_0x2baa5d+='\x0a',_0x2baa5d+=_0x6295ab(0x1fe),_0x2baa5d+=_0x6295ab(0x217),_0x2baa5d+=_0x6295ab(0x1c7),_0x2baa5d+=_0x6295ab(0x272),_0x2baa5d+=_0x6295ab(0x215),_0x2baa5d+=_0x6295ab(0x2cd),_0x2baa5d+=_0x6295ab(0x35b),_0x2baa5d+=_0x6295ab(0x1ec),_0x2baa5d+=_0x6295ab(0x31c),_0x2baa5d+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x2baa5d+=_0x6295ab(0x333),_0x2baa5d+=_0x6295ab(0x351),_0x2baa5d+=_0x6295ab(0x37e),_0x2baa5d+=_0x6295ab(0x32e);let _0x4a4525='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x4a4525+='\x0a',_0x4a4525+=_0x2baa5d,tgBot[_0x6295ab(0x396)]((_0x4afbf7,_0x558b42)=>{const _0x1938bf=_0x6295ab;logger[_0x1938bf(0x251)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger[_0x1938bf(0x32d)](_0x1938bf(0x2af),_0x4afbf7);}),tgBot[_0x6295ab(0x2ac)](async(_0x68cd27,_0x50a7f5)=>{const _0x14a228=_0x6295ab;if(!(!settings[_0x14a228(0x3a4)]&&_0x68cd27['update'][_0x14a228(0x258)][_0x14a228(0x293)]==_0x14a228(0x208))){if(!validateTelegram(_0x68cd27))return;}_0x50a7f5();}),tgBot[_0x6295ab(0x36c)](_0x6295ab(0x28f),async _0x126097=>{const _0x286d78=_0x6295ab;if(!settings['telegramChatId'])updateSetting(_0x286d78(0x3a4),_0x126097[_0x286d78(0x21b)]['id']);updateSetting(_0x286d78(0x320),!![]);if(!validateTelegram(_0x126097))return;await sendTelegram(_0x126097[_0x286d78(0x21b)]['id'],_0x4a4525);}),tgBot[_0x6295ab(0x36c)](_0x6295ab(0x31b),async _0x13d9c5=>{const _0x332d82=_0x6295ab;updateSetting(_0x332d82(0x320),!![]),await sendTelegram(_0x13d9c5[_0x332d82(0x21b)]['id'],_0x332d82(0x1ef));}),tgBot[_0x6295ab(0x36c)](_0x6295ab(0x227),async _0x32e7d2=>{const _0x34aa01=_0x6295ab;await sendTelegram(_0x32e7d2['chat']['id'],_0x34aa01(0x2e6)),updateSetting(_0x34aa01(0x320),![]);}),tgBot[_0x6295ab(0x36c)](_0x6295ab(0x336),async _0x21446c=>{const _0x51b3fd=_0x6295ab,_0x5a566a=Markup['inlineKeyboard']([Markup[_0x51b3fd(0x300)][_0x51b3fd(0x2a8)](_0x51b3fd(0x390),_0x51b3fd(0x1e9)),Markup['button'][_0x51b3fd(0x2a8)](_0x51b3fd(0x34f),_0x51b3fd(0x315)),Markup[_0x51b3fd(0x300)][_0x51b3fd(0x2a8)]('All',_0x51b3fd(0x329))]);_0x21446c[_0x51b3fd(0x1f9)](_0x51b3fd(0x31e),_0x5a566a);}),tgBot[_0x6295ab(0x1d9)](_0x6295ab(0x1e9),async _0x5cedc2=>{const _0x36b0fe=_0x6295ab;_0x5cedc2[_0x36b0fe(0x391)](),updateSetting(_0x36b0fe(0x30c),'orders'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x5cedc2[_0x36b0fe(0x21b)]['id'],_0x36b0fe(0x31f));}),tgBot['action'](_0x6295ab(0x315),async _0x28b44b=>{const _0x4458f9=_0x6295ab;_0x28b44b['editMessageReplyMarkup'](),updateSetting(_0x4458f9(0x30c),'alerts'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x28b44b[_0x4458f9(0x21b)]['id'],_0x4458f9(0x331));}),tgBot[_0x6295ab(0x1d9)](_0x6295ab(0x329),async _0x325103=>{const _0x1d9f36=_0x6295ab;_0x325103[_0x1d9f36(0x391)](),updateSetting(_0x1d9f36(0x30c),'all'),updateSetting(_0x1d9f36(0x320),!![]),await sendTelegram(_0x325103[_0x1d9f36(0x21b)]['id'],_0x1d9f36(0x1df));}),tgBot[_0x6295ab(0x36c)]('status',async _0x133d40=>{const _0x2859a8=_0x6295ab,_0x5aa52c=getBotsWithMode();let _0x46ffc2='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x2859a8(0x256)](_0x3ab645=>{const _0x2bca07=_0x2859a8,_0x507946=_0x5aa52c[_0x2bca07(0x247)](_0x3d6fa2=>_0x3d6fa2[_0x2bca07(0x304)]==_0x3ab645['botID'])['mode'];_0x46ffc2+=_0x2bca07(0x322)+_0x3ab645[_0x2bca07(0x304)]+':\x20'+_0x3ab645[_0x2bca07(0x200)]+'\x20|\x20'+_0x507946+_0x2bca07(0x1cb)+_0x3ab645[_0x2bca07(0x317)]+'\x0a';}),_0x46ffc2+='\x0a',_0x46ffc2+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x46ffc2+=!settings[_0x2859a8(0x320)]?_0x2859a8(0x2b0):_0x2859a8(0x2a7),_0x46ffc2+=settings[_0x2859a8(0x320)]?settings[_0x2859a8(0x30c)]==_0x2859a8(0x36b)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings[_0x2859a8(0x30c)]+'\x20only\x0a':'',await sendTelegram(_0x133d40[_0x2859a8(0x21b)]['id'],_0x46ffc2,{'parse_mode':_0x2859a8(0x2de)});}),tgBot['command'](_0x6295ab(0x27e),async _0x26b0d9=>{const _0x3754c3=_0x6295ab,_0x389c03=getEnabledBots();if(_0x389c03[_0x3754c3(0x30b)]==0x0)await sendTelegram(_0x26b0d9['chat']['id'],_0x3754c3(0x25c));else{if(_0x389c03['length']>0x1)_0x389c03[_0x3754c3(0x35a)]({'botID':_0x3754c3(0x36b)});let _0x1314e3=[],_0x16bf16=[];const _0x25da5b=_0x389c03[_0x3754c3(0x30b)]%0x4==0x0||_0x389c03[_0x3754c3(0x30b)]%0x4==0x3||_0x389c03[_0x3754c3(0x30b)]%0x3==0x1?0x4:0x3;let _0x542b84=0x0;_0x389c03['forEach']((_0x18d8db,_0x2afb4c)=>{const _0x1fb3e4=_0x3754c3;if(_0x2afb4c%_0x25da5b==0x0)_0x16bf16=[];_0x16bf16[_0x1fb3e4(0x35a)](Markup['button'][_0x1fb3e4(0x2a8)](_0x18d8db['botID']==_0x1fb3e4(0x36b)?_0x1fb3e4(0x2ca):_0x1fb3e4(0x322)+_0x18d8db['botID'],_0x1fb3e4(0x303)+_0x18d8db[_0x1fb3e4(0x304)])),_0x2afb4c%_0x25da5b==0x0&&(_0x1314e3[_0x542b84]=_0x16bf16,_0x542b84++);});const _0x41f985=Markup[_0x3754c3(0x2db)](_0x1314e3);_0x26b0d9[_0x3754c3(0x1f9)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x41f985);}}),tgBot[_0x6295ab(0x1d9)](/restart_(.+)/,async _0x4978b8=>{const _0x2dd889=_0x6295ab,_0x197b56=_0x4978b8[_0x2dd889(0x243)][0x1];_0x4978b8[_0x2dd889(0x391)](),_0x197b56=='all'?config['forEach'](_0x4a206f=>{restartBot(_0x4a206f['botID']);}):restartBot(_0x197b56);}),tgBot[_0x6295ab(0x36c)]('on',async _0x53b3f=>{const _0x9af11b=_0x6295ab,_0x53ab17=getDisabledBots();if(_0x53ab17['length']==0x0)await sendTelegram(_0x53b3f[_0x9af11b(0x21b)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x53ab17[_0x9af11b(0x30b)]>0x1)_0x53ab17[_0x9af11b(0x35a)]({'botID':_0x9af11b(0x36b)});let _0x3c0d77=[],_0xf74f58=[];const _0x3a3fd9=_0x53ab17[_0x9af11b(0x30b)]%0x4==0x0||_0x53ab17[_0x9af11b(0x30b)]%0x4==0x3||_0x53ab17[_0x9af11b(0x30b)]%0x3==0x1?0x4:0x3;let _0x491258=0x0;_0x53ab17[_0x9af11b(0x256)]((_0x51aec6,_0x1d3577)=>{const _0x3c4d07=_0x9af11b;if(_0x1d3577%_0x3a3fd9==0x0)_0xf74f58=[];_0xf74f58['push'](Markup['button'][_0x3c4d07(0x2a8)](_0x51aec6[_0x3c4d07(0x304)]==_0x3c4d07(0x36b)?_0x3c4d07(0x2ca):_0x3c4d07(0x322)+_0x51aec6['botID'],_0x3c4d07(0x225)+_0x51aec6[_0x3c4d07(0x304)])),_0x1d3577%_0x3a3fd9==0x0&&(_0x3c0d77[_0x491258]=_0xf74f58,_0x491258++);});const _0x5e75b0=Markup['inlineKeyboard'](_0x3c0d77);_0x53b3f['reply'](_0x9af11b(0x316),_0x5e75b0);}}),tgBot[_0x6295ab(0x1d9)](/on_(.+)/,async _0x197e57=>{const _0x3a8c04=_0x6295ab,_0x43aee6=_0x197e57['match'][0x1];_0x197e57['editMessageReplyMarkup']();if(_0x43aee6=='all'){const _0x498994=getDisabledBots();await sendTelegram(_0x197e57[_0x3a8c04(0x21b)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x498994[_0x3a8c04(0x256)](_0x234cd5=>{const _0x1cbcd9=_0x3a8c04;if(_0x234cd5[_0x1cbcd9(0x304)]!=_0x1cbcd9(0x36b))toggleBot(_0x234cd5['botID'],toggleStatus(_0x234cd5[_0x1cbcd9(0x304)]),'stopped');});}else await sendTelegram(_0x197e57[_0x3a8c04(0x21b)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x43aee6),toggleBot(_0x43aee6,toggleStatus(_0x43aee6),'stopped');}),tgBot[_0x6295ab(0x36c)](_0x6295ab(0x364),async _0x18ad89=>{const _0x286893=_0x6295ab,_0x5cfaac=getEnabledBots();if(_0x5cfaac[_0x286893(0x30b)]==0x0)await sendTelegram(_0x18ad89['chat']['id'],_0x286893(0x25c));else{if(_0x5cfaac[_0x286893(0x30b)]>0x1)_0x5cfaac[_0x286893(0x35a)]({'botID':'all'});let _0x4cebac=[],_0x5855a2=[];const _0x1ef47f=_0x5cfaac['length']%0x4==0x0||_0x5cfaac['length']%0x4==0x3||_0x5cfaac[_0x286893(0x30b)]%0x3==0x1?0x4:0x3;let _0x3f3d0c=0x0;_0x5cfaac[_0x286893(0x256)]((_0x58aec9,_0x3046bb)=>{const _0xcb16c4=_0x286893;if(_0x3046bb%_0x1ef47f==0x0)_0x5855a2=[];_0x5855a2[_0xcb16c4(0x35a)](Markup[_0xcb16c4(0x300)]['callback'](_0x58aec9[_0xcb16c4(0x304)]=='all'?_0xcb16c4(0x2ca):_0xcb16c4(0x322)+_0x58aec9['botID'],_0xcb16c4(0x235)+_0x58aec9[_0xcb16c4(0x304)])),_0x3046bb%_0x1ef47f==0x0&&(_0x4cebac[_0x3f3d0c]=_0x5855a2,_0x3f3d0c++);});const _0x55983f=Markup[_0x286893(0x2db)](_0x4cebac);_0x18ad89[_0x286893(0x1f9)](_0x286893(0x2e4),_0x55983f);}}),tgBot[_0x6295ab(0x1d9)](/off_(.+)/,async _0x5c405d=>{const _0x500705=_0x6295ab,_0x79f6d2=_0x5c405d['match'][0x1];_0x5c405d['editMessageReplyMarkup']();if(_0x79f6d2==_0x500705(0x36b)){const _0x4a20a5=getEnabledBots();await sendTelegram(_0x5c405d[_0x500705(0x21b)]['id'],_0x500705(0x25d)),_0x4a20a5['forEach'](_0x302e1a=>{const _0x4ad483=_0x500705;if(_0x302e1a['botID']!=_0x4ad483(0x36b))toggleBot(_0x302e1a[_0x4ad483(0x304)],toggleStatus(_0x302e1a[_0x4ad483(0x304)]),_0x4ad483(0x1b8));});}else await sendTelegram(_0x5c405d[_0x500705(0x21b)]['id'],_0x500705(0x241)+_0x79f6d2),toggleBot(_0x79f6d2,toggleStatus(_0x79f6d2),_0x500705(0x1b8));}),tgBot['command']('metrics',async _0x49f634=>{const _0x2ede8d=_0x6295ab,_0x3137f9=getEnabledBots();if(_0x3137f9[_0x2ede8d(0x30b)]==0x0)await sendTelegram(_0x49f634[_0x2ede8d(0x21b)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x3137f9[_0x2ede8d(0x30b)]>0x1){let _0x515188=[],_0x289ef0=[];const _0x1b0680=_0x3137f9[_0x2ede8d(0x30b)]%0x4==0x0||_0x3137f9['length']%0x4==0x3||_0x3137f9[_0x2ede8d(0x30b)]%0x3==0x1?0x4:0x3;let _0x405f27=0x0;_0x3137f9['forEach']((_0xce376a,_0x249b62)=>{const _0x3be431=_0x2ede8d;if(_0x249b62%_0x1b0680==0x0)_0x289ef0=[];_0x289ef0[_0x3be431(0x35a)](Markup[_0x3be431(0x300)][_0x3be431(0x2a8)](_0x3be431(0x322)+_0xce376a['botID'],_0x3be431(0x210)+_0xce376a[_0x3be431(0x304)])),_0x249b62%_0x1b0680==0x0&&(_0x515188[_0x405f27]=_0x289ef0,_0x405f27++);});const _0x269cdf=Markup[_0x2ede8d(0x2db)](_0x515188);_0x49f634[_0x2ede8d(0x1f9)](_0x2ede8d(0x2a1),_0x269cdf);}else{const _0x40fca4=_0x3137f9[0x0][_0x2ede8d(0x304)];if(pid[_0x40fca4])pid[_0x40fca4]['send']({'function':_0x2ede8d(0x3a7),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x2c7850=>{const _0x43071a=_0x6295ab,_0xb241a3=_0x2c7850['match'][0x1];_0x2c7850[_0x43071a(0x391)]();if(pid[_0xb241a3])pid[_0xb241a3]['send']({'function':_0x43071a(0x3a7),'args':null});}),tgBot[_0x6295ab(0x36c)](_0x6295ab(0x368),async _0x3c08cc=>{const _0x4b5591=_0x6295ab,_0x2acf0c=getEnabledBots();if(_0x2acf0c['length']==0x0)await sendTelegram(_0x3c08cc[_0x4b5591(0x21b)]['id'],_0x4b5591(0x25c));else{if(_0x2acf0c[_0x4b5591(0x30b)]>0x1){let _0x3cd6e0=[],_0x4f2bc8=[];const _0x54fe89=_0x2acf0c[_0x4b5591(0x30b)]%0x4==0x0||_0x2acf0c['length']%0x4==0x3||_0x2acf0c['length']%0x3==0x1?0x4:0x3;let _0x2faef5=0x0;_0x2acf0c[_0x4b5591(0x256)]((_0x5c4b00,_0xe7be8a)=>{const _0xcdb72c=_0x4b5591;if(_0xe7be8a%_0x54fe89==0x0)_0x4f2bc8=[];_0x4f2bc8[_0xcdb72c(0x35a)](Markup[_0xcdb72c(0x300)][_0xcdb72c(0x2a8)]('Bot\x20'+_0x5c4b00[_0xcdb72c(0x304)],_0xcdb72c(0x340)+_0x5c4b00[_0xcdb72c(0x304)])),_0xe7be8a%_0x54fe89==0x0&&(_0x3cd6e0[_0x2faef5]=_0x4f2bc8,_0x2faef5++);});const _0x1fd6d7=Markup[_0x4b5591(0x2db)](_0x3cd6e0);_0x3c08cc['reply'](_0x4b5591(0x399),_0x1fd6d7);}else{const _0x5b90b0=_0x2acf0c[0x0][_0x4b5591(0x304)];if(pid[_0x5b90b0])pid[_0x5b90b0][_0x4b5591(0x245)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x6295ab(0x1d9)](/portfolio_(.+)/,async _0x31a059=>{const _0x582d5c=_0x6295ab,_0x363a11=_0x31a059[_0x582d5c(0x243)][0x1];_0x31a059[_0x582d5c(0x391)]();if(pid[_0x363a11])pid[_0x363a11][_0x582d5c(0x245)]({'function':_0x582d5c(0x1bd),'args':null});}),tgBot['command']('update',async _0x10c51a=>{const _0x2f17fe=_0x6295ab;await getMessages();if(!updateAvailable)await sendTelegram(_0x10c51a['chat']['id'],_0x2f17fe(0x1c1));else{if(!validInstallation)await sendTelegram(_0x10c51a[_0x2f17fe(0x21b)]['id'],_0x2f17fe(0x21f));else{const _0x5cfd01=Markup[_0x2f17fe(0x2db)]([Markup[_0x2f17fe(0x300)][_0x2f17fe(0x2a8)](_0x2f17fe(0x23a),_0x2f17fe(0x273)),Markup['button'][_0x2f17fe(0x2a8)]('No',_0x2f17fe(0x238))]);_0x10c51a['reply'](_0x2f17fe(0x22a),_0x5cfd01);}}}),tgBot[_0x6295ab(0x1d9)](/update_(.+)/,async _0x986850=>{const _0x49cfc6=_0x6295ab,_0x434966=_0x986850[_0x49cfc6(0x243)][0x1];_0x986850[_0x49cfc6(0x391)](),_0x434966==_0x49cfc6(0x295)&&(await sendTelegram(_0x986850[_0x49cfc6(0x21b)]['id'],_0x49cfc6(0x339)),updateBB(_0x49cfc6(0x385))),_0x434966=='no'&&await sendTelegram(_0x986850['chat']['id'],_0x49cfc6(0x23e));}),tgBot[_0x6295ab(0x36c)](_0x6295ab(0x37c),async _0x5710f1=>{const _0x3d1faa=_0x6295ab;if(!validInstallation)await sendTelegram(_0x5710f1['chat']['id'],_0x3d1faa(0x1b0));else{const _0x2d9f9c=Markup['inlineKeyboard']([Markup['button']['callback'](_0x3d1faa(0x23a),_0x3d1faa(0x1f1)),Markup[_0x3d1faa(0x300)][_0x3d1faa(0x2a8)]('No',_0x3d1faa(0x301))]);_0x5710f1[_0x3d1faa(0x1f9)](_0x3d1faa(0x2c1),_0x2d9f9c);}}),tgBot['action'](/reinstall_(.+)/,async _0xaae8ed=>{const _0x36927a=_0x6295ab,_0x219c33=_0xaae8ed[_0x36927a(0x243)][0x1];_0xaae8ed[_0x36927a(0x391)](),_0x219c33=='yes'&&(await sendTelegram(_0xaae8ed[_0x36927a(0x21b)]['id'],_0x36927a(0x39a)),updateBB(_0x36927a(0x37c))),_0x219c33=='no'&&await sendTelegram(_0xaae8ed[_0x36927a(0x21b)]['id'],_0x36927a(0x2d2));}),tgBot[_0x6295ab(0x36c)](_0x6295ab(0x346),async _0x47eef9=>{const _0x3a9096=_0x6295ab,_0x109745=getBotsWithMode();if(_0x109745['length']==0x0)await sendTelegram(_0x47eef9[_0x3a9096(0x21b)]['id'],_0x3a9096(0x25c));else{let _0x51a3be=[],_0x2afc9a=[];const _0x4de23a=0x2;let _0x4c0ae3=0x0;_0x109745[_0x3a9096(0x256)]((_0x3b50f2,_0x144243)=>{const _0x24f1b0=_0x3a9096;if(_0x144243%_0x4de23a==0x0)_0x2afc9a=[];_0x2afc9a[_0x24f1b0(0x35a)](Markup['button']['callback']('Bot\x20'+_0x3b50f2[_0x24f1b0(0x304)]+'\x20('+_0x3b50f2[_0x24f1b0(0x2cc)]+')',_0x24f1b0(0x358)+_0x3b50f2[_0x24f1b0(0x304)])),_0x144243%_0x4de23a==0x0&&(_0x51a3be[_0x4c0ae3]=_0x2afc9a,_0x4c0ae3++);});const _0x2750d6=Markup[_0x3a9096(0x2db)](_0x51a3be);_0x47eef9[_0x3a9096(0x1f9)](_0x3a9096(0x259),_0x2750d6);}}),tgBot[_0x6295ab(0x1d9)](/toggle_(.+)/,async _0x2c5ac0=>{const _0x25fd02=_0x6295ab,_0x501f5b=_0x2c5ac0[_0x25fd02(0x243)][0x1];_0x2c5ac0[_0x25fd02(0x391)]();const _0x512a8d=getBotsWithMode(),_0x4d5daf=_0x512a8d[_0x25fd02(0x247)](_0x2b3fc7=>_0x2b3fc7[_0x25fd02(0x304)]==_0x501f5b),_0x199b16=_0x4d5daf[_0x25fd02(0x2cc)]==_0x25fd02(0x2dd)?_0x25fd02(0x26d):_0x25fd02(0x2dd);await sendTelegram(_0x2c5ac0[_0x25fd02(0x21b)]['id'],_0x25fd02(0x1aa)+_0x501f5b+'\x20to\x20'+_0x199b16+'\x20mode'),toggleBotMode(_0x501f5b);}),tgBot[_0x6295ab(0x36c)](_0x6295ab(0x2ed),async _0x122f51=>{const _0x59f6a0=_0x6295ab;let _0x743d69='';config[_0x59f6a0(0x256)](_0x19d28b=>{const _0x1f919f=_0x59f6a0;_0x743d69+=_0x1f919f(0x322)+_0x19d28b[_0x1f919f(0x304)]+':\x20'+_0x19d28b[_0x1f919f(0x22c)]+'\x0a';}),await sendTelegram(_0x122f51[_0x59f6a0(0x21b)]['id'],_0x743d69,{'parse_mode':_0x59f6a0(0x2de)});}),tgBot[_0x6295ab(0x36c)]('help',async _0x19b585=>{const _0x182f17=_0x6295ab;await sendTelegram(_0x19b585[_0x182f17(0x21b)]['id'],_0x2baa5d);}),process[_0x6295ab(0x32c)](_0x6295ab(0x371),()=>tgBot[_0x6295ab(0x20c)](_0x6295ab(0x371))),process['once']('SIGTERM',()=>tgBot[_0x6295ab(0x20c)]('SIGTERM')),tgBot[_0x6295ab(0x279)]();}}function disableTelegram(){const _0x2754f1=_0x485691;tgBot&&tgBot[_0x2754f1(0x20c)]();}async function sendTelegram(_0x538189,_0x4eb919,_0x249219){const _0x3e27be=_0x485691;_0x249219={..._0x249219,'disable_web_page_preview':!![]};try{await tgBot[_0x3e27be(0x2e7)][_0x3e27be(0x1fd)](_0x538189,_0x4eb919,_0x249219);}catch(_0x1d6589){console[_0x3e27be(0x2df)](_0x3e27be(0x398),_0x1d6589);}}async function sendTelegramBot(_0x41567b,_0x45c515){const _0x2c48cb=_0x485691;if(settings[_0x2c48cb(0x320)]){if(settings[_0x2c48cb(0x30c)]=='all'||(_0x45c515[_0x2c48cb(0x2c8)]==_0x2c48cb(0x397)||_0x45c515[_0x2c48cb(0x2c8)]==_0x2c48cb(0x2c4)||_0x45c515[_0x2c48cb(0x2c8)]==_0x2c48cb(0x203))&&settings[_0x2c48cb(0x30c)]==_0x2c48cb(0x2c9)||_0x45c515['type']==_0x2c48cb(0x1e1)&&settings[_0x2c48cb(0x30c)]==_0x2c48cb(0x383)){if(tgBot&&settings[_0x2c48cb(0x3a4)]){if(_0x45c515['showname'])await sendTelegram(settings[_0x2c48cb(0x3a4)],_0x45c515[_0x2c48cb(0x22c)]+_0x2c48cb(0x326)+_0x45c515[_0x2c48cb(0x2b9)]);else await sendTelegram(settings[_0x2c48cb(0x3a4)],'Bot\x20'+_0x41567b+_0x2c48cb(0x326)+_0x45c515[_0x2c48cb(0x2b9)]);}}}}function _0x7996(){const _0x3740b3=['disable','::ffff:127.0.0.1','mkdirSync','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','headless','botname','util','version.json','fork','/:bot/portfolio','login\x20required','resetpw_yes','tempaccess_15_','temp/','off_','restore_yes_','whitelistEnabled','update_no','padStart','Yes','conn','#RES#\x20if\x20running\x20locally\x0a','versions','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','writeFileSync','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','userid','match','name','send','removeAllListeners','find','uuid','value','backup-full','User\x20has\x20been\x20validated','_data','getTime','272833dzZBxC','118151gqEBas','privateKey','simple','************','params','1838950STOibZ','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','forEach','isDirectory','message','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','RSA','binary','No\x20bots\x20running\x20right\x20now','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','login','any','temporary\x20token\x20generated','-----------------------------------------------------------------------------------','alias','Backup\x20file\x20uploaded','place-order','Unauthorized\x20attempt\x20to\x20delete\x20bot','pidExpireLogin','constructor','Restoring\x20bot(s)\x20from\x20backup','*$1*',')\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','manual','exp','Disabled\x20Bot\x20','function','environment','/restart\x20-\x20restart\x20bot(s)\x0a','update_yes','telegrammsg','keys','Password\x20has\x20been\x20reset\x20to:\x20','init','bbvReceive','launch','remove','2778uHyEfW','expiry','::1','restart','getMinutes','ipaddr.js','30\x20min','/download/:type','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','Bot\x20Mgr\x20>\x20','sortBy','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','logs/','Error:\x20Invalid\x20argument\x20','env','timestamp','temporary\x20access\x20rejected','showConfig','store','mtime','start','get-portfolio','***','Invalid\x20username\x20or\x20IP\x20address','text','getSeconds','yes','get-starting-balances','onepagemode','cancel-loading','socket','pidRefreshToken','/:bot','1000','reason','bots','\x20-\x20','lastmsgemitted','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','update-bb','Access\x20enabled\x20for\x20','Enabled\x20Bot\x20','argv','startsWith','Notifications\x20enabled\x0a','callback','#RES#','12747HFCjkk','login\x20token\x20valid','use','-events.json','\x1b[33m','Telegraf\x20error:','Notifications\x20disabled\x0a','stringify','bb/','zip/','Invalid\x20IP\x20address','generate','server','write','build2','event','apiSecret','telegram2FaApproval','latestversion','f2aRequired','emit','config/','$1_$2_$3','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','getFullYear','user','warning','exchange','statSync','lowdb','type','alerts','All\x20bots','exec','mode','/off\x20-\x20stop\x20bot(s)\x0a','\x20minutes','temporary\x20access\x20not\x20allowed','Login\x20rejected','enabled','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','index.html','backup','number','Logged\x20out\x20user\x20...','IPv4','allow','blacklist','remoteAddress','inlineKeyboard','bcryptjs','auto','HTML','log','bb-config.json','toIPv4Address','then','set','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','\x1b[0m','Notifications\x20disabled','telegram','output-002.log','Restore\x20backup\x20file\x20','login2fa_','compareSync','toString','names','3430985mQGVXq','internal','path','lastmsgtelegram','/:bot/support','2FA\x20login\x20rejected','logged\x20out','copyFileSync','placeOrder','download','kind','host','Unauthorized\x20attempt\x20to\x20confirm\x20message','Deleted\x20Bot\x20','getMonth','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','connected','bot','button','reinstall_no','port','restart_','botID','bot-','get','disabled','headers','Unauthorized\x20attempt\x20to\x20update\x20bot','listen','length','telegramEvents','resetpw_no','\x1b[31m','reset-history','.zip','request','disconnect','uncaughtException','static','config_alerts','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','live','includes','getUTCHours','new-disabled','enable','/status\x20-\x20show\x20bot(s)\x20status\x0a','Login\x20accepted','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Ok,\x20will\x20send\x20order\x20notifications\x20only','telegramEnabled','BCT','Bot\x20','login\x20not\x20required','Unauthorized\x20attempt\x20to\x20add\x20bot','clientip','\x20>\x20','express','crypto','config_all','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','RSA-OAEP','once','debug','/help\x20-\x20show\x20available\x20commands\x0a','messages','show-config','Ok,\x20will\x20send\x20alert\x20notifications\x20only','apiKey','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Setting\x20access:\x20','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','config','filter','get-logs','Starting\x20Balance\x20Bot\x20update','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','running','\x20|\x20client:\x20...','full','entries','bot.js','portfolio_','Unauthorized\x20attempt\x20to\x20log\x20out',':\x20Bot\x20Mgr\x20>\x20','login2fa_reject_','storeConfiguration','getHours','toggle','string','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Unauthorized\x20attempt\x20to\x20store\x20configuration','Token\x20blacklisted','delete-alerts',')\x20\x20\x20|\x20Bot\x20','defaults','2FA\x20login\x20token\x20generated','Alerts','Password\x20reset\x20rejected','/update\x20-\x20update\x20Balance\x20Bot\x0a','NTBA_FIX_319','ETH','track','Starting\x20(','show','-config.json','toggle_','from','push','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','No\x20authentication\x20token','settings','assign','Temporary\x20access\x20rejected','hashSync','telegramUsername','Unauthorized\x20attempt\x20to\x20get\x20portfolio','updatebotmanager','off','hex','clients','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','portfolio','Error\x20removing\x20old\x20backup\x20files:','build','all','command','generateKeyPairAsync','reject','new','/output-000.log','SIGINT','sort','bbPassword','size','decrypt','createServer','ipc','output-003.log','\x20|\x20user:\x20...','reinstall-bb','address','reinstall','publicKey','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','telegramIpApproval','store-settings','parse','Unauthorized\x20attempt\x20to\x20download\x20','orders','test','update','post','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','node-zip','tempaccess_reject_','getDate','marketcapApi','unlinkSync','format','cancelLoading','-performance.json','Orders','editMessageReplyMarkup','timeshift','inherit','username','password','catch','error','Telegram\x20error:','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Starting\x20Balance\x20Bot\x20reinstallation','readFileSync','family','mixpanel','uuid-random','(staging)','460dAteKW','Restore\x20process\x20confirmed','invalid\x20credentials','1492dXOdeE','telegramChatId','axios','|@|','sendMetricsTelegram','existsSync','Starting\x20#RED#Balance\x20Bot\x20v','randomBytes','map','temporary\x20access\x20timeout','botmanager','/upload-backup','2FA','jsonwebtoken','store-fiat','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','-results.json','tkn','backup/','endsWith','bb-secure.json','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','1057888ohoXnQ','2FA\x20required','hasOwnProperty','Idling\x20(','apiPassword','Restarting\x20Bot\x20','staging','stopped','file','0.0.0','sendFile','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','sendPortfolioTelegram','login\x20token\x20generated','logout','hybrid-crypto-js','Your\x20installation\x20is\x20already\x20up\x20to\x20date','18dfHYyN','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','add','replace','Unauthorized\x20attempt\x20to\x20get\x20messages','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','You\x20can\x20use\x20the\x20following\x20commands:\x0a','telegramToken','min','\x20|\x20',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','createWriteStream','ipv6','express-fileupload','handshake','Unauthorized\x20attempt\x20to\x20update\x20settings','reload','toggle-bot-mode','Error\x20details:','token','bbvNew','search','secure','action','logs','loginRequired','/:bot/performance','bbUsername','\x1b[35m','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','max','order','slice','range','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','kill','secret','Crypt','access\x20timeout','config_orders','Invalid\x20authentication\x20token\x20(2)','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','/names\x20-\x20show\x20bot\x20names\x0a','confirm-message','code','Notifications\x20enabled','child_process','reinstall_yes','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','join','Backup\x20file\x20unzipped\x20and\x20stored','api-eu.mixpanel.com','/:bot/configuration','isIPv4MappedAddress','3000','reply','accept','yargs/yargs','\x20(1)','sendMessage','/enable\x20-\x20enable\x20notifications\x0a','6270wmxnyL','status','restore-backup-file','production','success','Restore\x20process\x20aborted','(((.+)+)+)+$','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','6b67f3d61ee94b8f5c80b4affef4c4d9','/start','SIGTERM','access','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','stop','backupfile','version','apply','metrics_','sign','telegraf','readdirSync','split','/on\x20-\x20start\x20bot(s)\x0a','CoinMarketCap\x20API\x20key\x20validated','/disable\x20-\x20disable\x20notifications\x0a','lowdb/adapters/FileSync','data','2FA\x20login\x20required','chat','sockets','output-000.log','settings.','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Node.js\x20v','http','exit','notification','backup-full@','on_','rmSync'];_0x7996=function(){return _0x3740b3;};return _0x7996();}async function sendTelegramMsg(_0x2dc61c,_0x525f71='HTML'){const _0x5cfd38=_0x485691;return settings[_0x5cfd38(0x320)]&&tgBot&&settings[_0x5cfd38(0x3a4)]?(await sendTelegram(settings[_0x5cfd38(0x3a4)],_0x2dc61c,{'parse_mode':_0x525f71}),!![]):![];}function getDeviceWithIp(_0x53d2be){const _0x4c9e8c=_0x485691;return devices[_0x4c9e8c(0x247)](_0x5572e1=>_0x5572e1['ip']===_0x53d2be);}async function temporaryAccess2FA(_0x4353a6,_0x3204a9){const _0x9f4c0=_0x485691;let _0xf03a0b=new Date(),_0x5a2d18=![];if(lastIpApproval){if(_0xf03a0b-lastIpApproval<0x1388)_0x5a2d18=!![];}lastIpApproval=new Date();if(_0x5a2d18)return;if(tgBot&&settings[_0x9f4c0(0x3a4)]){const _0x5f23f3=uuidRandom();tmpStorage[_0x5f23f3]={'uuid':_0x4353a6,'externalip':_0x3204a9};const _0x283568=Markup[_0x9f4c0(0x2db)]([Markup[_0x9f4c0(0x300)][_0x9f4c0(0x2a8)]('5\x20min','tempaccess_5_'+_0x5f23f3),Markup[_0x9f4c0(0x300)][_0x9f4c0(0x2a8)]('15\x20min',_0x9f4c0(0x233)+_0x5f23f3),Markup['button'][_0x9f4c0(0x2a8)](_0x9f4c0(0x281),'tempaccess_30_'+_0x5f23f3),Markup['button']['callback'](_0x9f4c0(0x36e),_0x9f4c0(0x389)+_0x5f23f3)]);await sendTelegram(settings[_0x9f4c0(0x3a4)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x3204a9)[_0x9f4c0(0x356)]+'\x20?',_0x283568),tgBot[_0x9f4c0(0x1d9)](/tempaccess_(.+)_(.+)/,async _0x5d2ba7=>{const _0x1d953e=_0x9f4c0,_0x2f0d5e=_0x5d2ba7[_0x1d953e(0x243)][0x1],_0x34e863=_0x5d2ba7[_0x1d953e(0x243)][0x2],{uuid:_0x180669,externalip:_0x2db954}=tmpStorage[_0x34e863];delete tmpStorage[_0x34e863],_0x5d2ba7[_0x1d953e(0x391)](),devices[_0x180669][_0x1d953e(0x37f)]={'clientip':_0x2db954,'timestamp':new Date()[_0x1d953e(0x24d)](),'expiry':_0x2f0d5e},_0x2f0d5e!=_0x1d953e(0x36e)?(await sendTelegram(_0x5d2ba7[_0x1d953e(0x21b)]['id'],_0x1d953e(0x2a3)+_0x2f0d5e+_0x1d953e(0x2ce),{'parse_mode':_0x1d953e(0x2de)}),io['to'](_0x180669)[_0x1d953e(0x2be)](_0x1d953e(0x200),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x5d2ba7['chat']['id'],_0x1d953e(0x35f)),io['to'](_0x180669)[_0x1d953e(0x2be)]('status',{'access':{'allow':![],'reason':_0x1d953e(0x28b),'token':null}}));});}}async function loginAccess2FA(_0x4bc8b6,_0x1e085b){const _0x226063=_0x485691;if(tgBot&&settings[_0x226063(0x3a4)]){const _0x37ed0c=uuidRandom();tmpStorage[_0x37ed0c]={'uuid':_0x4bc8b6,'externalip':_0x1e085b};const _0xf3f721=Markup[_0x226063(0x2db)]([Markup[_0x226063(0x300)][_0x226063(0x2a8)](_0x226063(0x1fa),_0x226063(0x2ea)+loginExpiry+'_'+_0x37ed0c),Markup[_0x226063(0x300)]['callback'](_0x226063(0x36e),_0x226063(0x343)+_0x37ed0c)]);await sendTelegram(settings[_0x226063(0x3a4)],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x1e085b)[_0x226063(0x356)]+'\x20?',_0xf3f721),tgBot[_0x226063(0x1d9)](/login2fa_(.+)_(.+)/,async _0x81e947=>{const _0x388150=_0x226063,_0xde9908=_0x81e947[_0x388150(0x243)][0x1],_0x2518a6=_0x81e947['match'][0x2],{uuid:_0x3f2ccf,externalip:_0x43b313}=tmpStorage[_0x2518a6];delete tmpStorage[_0x2518a6],_0x81e947[_0x388150(0x391)](),devices[_0x3f2ccf][_0x388150(0x2bb)]={'clientip':_0x43b313,'timestamp':new Date()[_0x388150(0x24d)](),'expiry':_0xde9908},_0xde9908!=_0x388150(0x36e)?(await sendTelegram(_0x81e947[_0x388150(0x21b)]['id'],_0x388150(0x31d),{'parse_mode':_0x388150(0x2de)}),io['to'](_0x3f2ccf)['emit'](_0x388150(0x200),{'access':{'allow':![],'reason':_0x388150(0x1d2),'token':null}})):(await sendTelegram(_0x81e947['chat']['id'],_0x388150(0x2d0)),io['to'](_0x3f2ccf)['emit'](_0x388150(0x200),{'access':{'allow':![],'reason':_0x388150(0x2f3),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3bf141=_0x485691;return dbConfig[_0x3bf141(0x306)]('bots')[_0x3bf141(0x285)](_0x3bf141(0x304))[_0x3bf141(0x337)]({'status':_0x3bf141(0x2d1)})[_0x3bf141(0x249)]()||[];}function getDisabledBots(){const _0x8c0795=_0x485691;return dbConfig[_0x8c0795(0x306)](_0x8c0795(0x29e))[_0x8c0795(0x285)]('botID')[_0x8c0795(0x337)]({'status':_0x8c0795(0x307)})['value']()||[];}function getBotAttributes(_0x1948b8){const _0x16fe13=_0x485691;let _0x55f2ef={};const _0x34939e=configpath+_0x16fe13(0x305)+_0x1948b8+_0x16fe13(0x357),_0x2d915c=fs[_0x16fe13(0x1a0)](_0x34939e);if(_0x2d915c){const _0x32067b=fs[_0x16fe13(0x39b)](_0x34939e);try{const _0x32fbd0=JSON[_0x16fe13(0x381)](_0x32067b),_0x2fbb91=_0x32fbd0?_0x32fbd0[_0x16fe13(0x2ff)][0x0][_0x16fe13(0x22b)]:![];_0x55f2ef[_0x16fe13(0x2cc)]=_0x2fbb91?_0x16fe13(0x2dd):_0x16fe13(0x26d),_0x55f2ef[_0x16fe13(0x22c)]=_0x32fbd0?_0x32fbd0[_0x16fe13(0x2ff)][0x0][_0x16fe13(0x22c)]:_0x16fe13(0x322)+_0x1948b8;}catch(_0x198fa0){_0x55f2ef['mode']=_0x16fe13(0x26d),_0x55f2ef[_0x16fe13(0x22c)]=_0x16fe13(0x322)+_0x1948b8;}}else _0x55f2ef['mode']=_0x16fe13(0x26d),_0x55f2ef[_0x16fe13(0x22c)]=_0x16fe13(0x322)+_0x1948b8;return _0x55f2ef;}function getBotsWithMode(){const _0x40a92e=_0x485691,_0x3a8cf3=dbConfig[_0x40a92e(0x306)](_0x40a92e(0x29e))[_0x40a92e(0x285)](_0x40a92e(0x304))[_0x40a92e(0x249)]()||[];return _0x3a8cf3[_0x40a92e(0x256)](_0x3208b4=>{const _0x27c142=_0x40a92e;let _0x22a271=getBotAttributes(_0x3208b4[_0x27c142(0x304)]);_0x3208b4['mode']=_0x22a271[_0x27c142(0x2cc)];}),_0x3a8cf3;}function getBotExchanges(){const _0x1a535d=_0x485691;let _0x4d14df=[];const _0x2f5d1a=dbConfig['get'](_0x1a535d(0x29e))[_0x1a535d(0x285)](_0x1a535d(0x304))[_0x1a535d(0x249)]()||[];_0x2f5d1a[_0x1a535d(0x256)](_0x54778f=>{const _0x52b2cb=_0x1a535d;if(_0x54778f['status']==_0x52b2cb(0x2d1)){const _0x7b759b=configpath+'bot-'+_0x54778f['botID']+_0x52b2cb(0x357),_0x3d68e8=fs[_0x52b2cb(0x1a0)](_0x7b759b);let _0xfb142b;if(_0x3d68e8){const _0x5ca1af=fs[_0x52b2cb(0x39b)](_0x7b759b);try{const _0x4fc936=JSON[_0x52b2cb(0x381)](_0x5ca1af);_0xfb142b=_0x4fc936?_0x4fc936['bot'][0x0][_0x52b2cb(0x2c5)]:null;}catch(_0x4ebb9e){}}if(_0xfb142b)_0x4d14df[_0x52b2cb(0x35a)](_0xfb142b);}});const _0x59817b=[...new Set(_0x4d14df)][_0x1a535d(0x372)]();return _0x59817b;}async function initUser(){const _0x3a72cb=_0x485691;if(!settings['userid']){const _0x327b30=uuidRandom();mixpanel[_0x3a72cb(0x263)](_0x327b30),updateSetting(_0x3a72cb(0x242),_0x327b30);}}async function initSecure(){const _0x2eb9e=_0x485691;let _0x483dc0=getSecure();if(!_0x483dc0[_0x2eb9e(0x1b3)]('secret')){let _0x576308=await generateKeys();_0x483dc0[_0x2eb9e(0x37d)]=_0x576308['publicKey'],_0x483dc0['privateKey']=_0x576308[_0x2eb9e(0x250)],_0x483dc0[_0x2eb9e(0x1e6)]=crypto[_0x2eb9e(0x1a2)](0x20)[_0x2eb9e(0x2ec)](_0x2eb9e(0x365));;storeSecure(_0x483dc0);}}function getSettings(){const _0x17eb98=_0x485691;return dbSettings[_0x17eb98(0x306)](_0x17eb98(0x35d))[_0x17eb98(0x249)]()||{};}function getSecure(){const _0x4ad15e=_0x485691;return dbSecure[_0x4ad15e(0x306)](_0x4ad15e(0x1d8))[_0x4ad15e(0x249)]()||{};}function getBlacklist(){const _0x5e8a0b=_0x485691;return dbSecure['get'](_0x5e8a0b(0x2d9))[_0x5e8a0b(0x249)]()||[];}function broadcastToBots(_0x3becbe,_0x51145c){const _0x378e2b=_0x485691;config[_0x378e2b(0x256)](_0x141242=>{const _0x3eb2a4=_0x378e2b;if(_0x141242[_0x3eb2a4(0x200)]==_0x3eb2a4(0x2d1)&&_0x141242[_0x3eb2a4(0x317)]==_0x3eb2a4(0x33b)||_0x141242['status']=='new'&&_0x141242['live']==_0x3eb2a4(0x33b)){if(pid[_0x141242['botID']])pid[_0x141242[_0x3eb2a4(0x304)]][_0x3eb2a4(0x245)]({[_0x3becbe]:_0x51145c});}});}async function storeSettings(_0x56380d,_0x572a11=![]){const _0x28efad=_0x485691;_0x56380d={...settings,..._0x56380d};if(_0x572a11&&_0x56380d[_0x28efad(0x373)]!=_0x28efad(0x252)&&_0x56380d[_0x28efad(0x373)]!=_0x28efad(0x291)&&_0x56380d[_0x28efad(0x373)]!=''){const _0x8bc2e4=crypt[_0x28efad(0x375)](secure[_0x28efad(0x250)],_0x56380d['bbPassword'])[_0x28efad(0x258)][_0x28efad(0x214)](_0x28efad(0x3a6))[0x0],_0xa5fa3f=bcrypt[_0x28efad(0x360)](_0x8bc2e4,saltRounds);_0x56380d={..._0x56380d,'bbPassword':_0xa5fa3f};}if(_0x572a11&&_0x56380d['telegramToken']!=_0x28efad(0x252)&&_0x56380d[_0x28efad(0x1c9)]!=_0x28efad(0x291)&&_0x56380d['telegramToken']!=''){const _0x2b17a2=crypt[_0x28efad(0x375)](secure['privateKey'],_0x56380d['telegramToken'])[_0x28efad(0x258)][_0x28efad(0x214)](_0x28efad(0x3a6))[0x0];_0x56380d={..._0x56380d,'telegramToken':_0x2b17a2};}if(_0x572a11&&_0x56380d[_0x28efad(0x38b)]!='************'&&_0x56380d[_0x28efad(0x38b)]!=_0x28efad(0x291)&&_0x56380d[_0x28efad(0x38b)]!=''){const _0x2e6261=crypt[_0x28efad(0x375)](secure[_0x28efad(0x250)],_0x56380d[_0x28efad(0x38b)])[_0x28efad(0x258)][_0x28efad(0x214)](_0x28efad(0x3a6))[0x0];_0x56380d={..._0x56380d,'marketcapApi':_0x2e6261};}const _0xc83d79=_0x56380d[_0x28efad(0x1c9)]!=_0x28efad(0x252)&&_0x56380d[_0x28efad(0x1c9)]!=settings[_0x28efad(0x1c9)]||_0x56380d['telegramUsername']!=settings[_0x28efad(0x361)],_0x5c1437=_0x56380d[_0x28efad(0x1c9)]==''||_0x56380d[_0x28efad(0x361)]=='',_0x42762b=_0x56380d['marketcapApi']&&_0x56380d['marketcapApi']!='************'&&_0x56380d[_0x28efad(0x38b)]!=settings[_0x28efad(0x1c9)];_0xc83d79&&(_0x56380d[_0x28efad(0x3a4)]=null,_0x56380d[_0x28efad(0x30c)]='all');for(const [_0x4139a0,_0x1bba47]of Object[_0x28efad(0x33e)](_0x56380d)){if(_0x4139a0==_0x28efad(0x1c9)&&_0x1bba47=='************'){_0x56380d[_0x28efad(0x1c9)]=settings['telegramToken'];continue;};if(_0x4139a0==_0x28efad(0x373)&&_0x1bba47==_0x28efad(0x252)){_0x56380d[_0x28efad(0x373)]=settings[_0x28efad(0x373)];continue;};if(_0x4139a0=='marketcapApi'&&_0x1bba47==_0x28efad(0x252)){_0x56380d[_0x28efad(0x38b)]=settings[_0x28efad(0x38b)];continue;};dbSettings[_0x28efad(0x2e3)]('settings.'+_0x4139a0,_0x1bba47)['write']();}settings=_0x56380d,io['to'](_0x28efad(0x1a5))[_0x28efad(0x2be)]('settings',cleanSettings()),broadcastToBots(_0x28efad(0x392),settings[_0x28efad(0x392)]),broadcastToBots(_0x28efad(0x297),settings[_0x28efad(0x297)]),broadcastToBots(_0x28efad(0x38b),settings['marketcapApi']);if(_0xc83d79&&!_0x5c1437)initTelegram();if(_0xc83d79&&_0x5c1437)disableTelegram();getAllClients()[_0x28efad(0x256)](_0x2b3324=>{const _0x517001=_0x28efad;getSocket(_0x2b3324['id'])[_0x517001(0x2be)](_0x517001(0x200),{'access':{'allow':![],'reason':_0x517001(0x1d2),'token':null}});}),_0x42762b&&(await sleep(0xbb8),testMarketcapApi(_0x56380d[_0x28efad(0x38b)]));}async function testMarketcapApi(_0x18d1f2){const _0x4fa7d3=_0x485691,_0x5dcf42=[_0x4fa7d3(0x321),_0x4fa7d3(0x353)];try{await axios['get'](_0x4fa7d3(0x25e),{'headers':{'X-CMC_PRO_API_KEY':_0x18d1f2},'params':{'symbol':_0x5dcf42['toString']()}});}catch(_0x483a48){_0x483a48['toString']()[_0x4fa7d3(0x318)]('status\x20code\x20401')?(io['to'](_0x4fa7d3(0x1a5))[_0x4fa7d3(0x2be)](_0x4fa7d3(0x223),_0x4fa7d3(0x286)),logger[_0x4fa7d3(0x33d)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to']('botmanager')[_0x4fa7d3(0x2be)](_0x4fa7d3(0x223),'CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x4fa7d3(0x33d)](_0x4fa7d3(0x1bc)),logger['debug'](_0x4fa7d3(0x1d4),_0x483a48[_0x4fa7d3(0x2ec)]()+_0x4fa7d3(0x29f)+_0x483a48[_0x4fa7d3(0x1ee)]));return;}logger['debug'](_0x4fa7d3(0x216));}function updateSetting(_0x527464,_0x272ce5){const _0x44174c=_0x485691;dbSettings[_0x44174c(0x2e3)](_0x44174c(0x21e)+_0x527464,_0x272ce5)[_0x44174c(0x2b7)](),settings=getSettings(),io['to'](_0x44174c(0x1a5))['emit'](_0x44174c(0x35d),cleanSettings());}function storeSecure(_0x6fffb){const _0x432e45=_0x485691;dbSecure[_0x432e45(0x306)](_0x432e45(0x1d8))['push'](_0x6fffb)[_0x432e45(0x2b7)](),secure=_0x6fffb;}function addBlacklist(_0x58fbd3){const _0x4baff6=_0x485691;cleanBlacklist();let _0x35da1f;devices[_0x58fbd3][_0x4baff6(0x37f)]?_0x35da1f=Math[_0x4baff6(0x1e0)](devices[_0x58fbd3]['telegramIpApproval']['expiry'],loginExpiry):_0x35da1f=loginExpiry,dbSecure[_0x4baff6(0x306)](_0x4baff6(0x2d9))[_0x4baff6(0x35a)]({'expiry':new Date()[_0x4baff6(0x24d)]()+_0x35da1f*0x3c*0x3e8,'token':devices[_0x58fbd3][_0x4baff6(0x20a)][_0x4baff6(0x1d5)]})[_0x4baff6(0x2b7)](),blacklist=dbSecure[_0x4baff6(0x306)](_0x4baff6(0x2d9))[_0x4baff6(0x249)]();}function cleanBlacklist(){const _0x5a492c=_0x485691;let _0x33f468=dbSecure[_0x5a492c(0x306)](_0x5a492c(0x2d9))['cloneDeep']()['value'](),_0x350e7b=new Date()[_0x5a492c(0x24d)]();_0x33f468['forEach'](_0x499792=>{const _0x40ee8d=_0x5a492c;_0x499792[_0x40ee8d(0x27c)]<_0x350e7b&&dbSecure[_0x40ee8d(0x306)]('blacklist')['remove']({'expiry':_0x499792[_0x40ee8d(0x27c)]})[_0x40ee8d(0x2b7)]();});}function initStates(){let _0x1d7977=getConfiguration();_0x1d7977['forEach'](_0x56dd66=>{const _0x3263c5=_0x2509;_0x56dd66[_0x3263c5(0x317)]=_0x3263c5(0x1b8);}),storeConfiguration(_0x1d7977);}function onKeys(){const _0x338a26=new RSA();return new Promise(_0x30be60=>{const _0x2f63b2=_0x2509;_0x338a26[_0x2f63b2(0x36d)]()[_0x2f63b2(0x2e2)](_0x36a182=>{_0x30be60(_0x36a182);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x36ae02=_0x485691;let _0x1ea36b=getSettings(),_0x224f6e=![];!_0x1ea36b[_0x36ae02(0x1b3)](_0x36ae02(0x2f1))&&(_0x1ea36b[_0x36ae02(0x2f1)]=0x0,_0x224f6e=!![]);!_0x1ea36b[_0x36ae02(0x1b3)]('lastmsgemitted')&&(_0x1ea36b['lastmsgemitted']=0x0,_0x224f6e=!![]);!_0x1ea36b['hasOwnProperty']('latestversion')&&(_0x1ea36b[_0x36ae02(0x2bc)]='0.0.0',_0x224f6e=!![]);!_0x1ea36b[_0x36ae02(0x1b3)](_0x36ae02(0x297))&&(_0x1ea36b[_0x36ae02(0x297)]=![],_0x224f6e=!![]);!_0x1ea36b[_0x36ae02(0x1b3)](_0x36ae02(0x38b))&&(_0x1ea36b[_0x36ae02(0x38b)]='',_0x224f6e=!![]);if(_0x224f6e)storeSettings(_0x1ea36b);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x36ae02(0x256)](_0x1585da=>{const _0x5b4353=_0x36ae02;if(!_0x1585da[_0x5b4353(0x257)]()){if(!_0x1585da[_0x5b4353(0x244)][_0x5b4353(0x2a6)](_0x5b4353(0x224)))fs['unlinkSync'](configbackuppath+_0x1585da[_0x5b4353(0x244)]);}else fs[_0x5b4353(0x226)](configbackuppath+_0x1585da[_0x5b4353(0x244)],{'recursive':!![]});});}catch(_0x1088d8){logger[_0x36ae02(0x32d)](_0x36ae02(0x369),_0x1088d8);}}function storeConfiguration(_0x434c38){const _0x283968=_0x485691;dbConfig[_0x283968(0x306)](_0x283968(0x29e))[_0x283968(0x27a)]()[_0x283968(0x2b7)](),dbConfig[_0x283968(0x306)](_0x283968(0x29e))[_0x283968(0x35a)](..._0x434c38)[_0x283968(0x2b7)](),config=_0x434c38;}async function resetPassword(){const _0x4c8645=_0x485691;if(tgBot&&settings['telegramChatId']){const _0x56349d=Markup['inlineKeyboard']([Markup[_0x4c8645(0x300)]['callback'](_0x4c8645(0x295),_0x4c8645(0x232)),Markup[_0x4c8645(0x300)][_0x4c8645(0x2a8)]('no',_0x4c8645(0x30d))]);await sendTelegram(settings[_0x4c8645(0x3a4)],_0x4c8645(0x2fd),_0x56349d),tgBot[_0x4c8645(0x1d9)](/resetpw_(.+)/,async _0x94b488=>{const _0x37e021=_0x4c8645,_0x2830a4=_0x94b488[_0x37e021(0x243)][0x1];_0x94b488['editMessageReplyMarkup']();if(_0x2830a4!='no'){const _0x6ace6=0xf,_0x1a80ea=_0x37e021(0x32a),_0x34d8e5=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x6ace6)))[_0x37e021(0x1a3)](_0x2f3cc8=>_0x1a80ea[_0x2f3cc8%_0x1a80ea[_0x37e021(0x30b)]])[_0x37e021(0x1f3)](''),_0x19fac5=bcrypt[_0x37e021(0x360)](_0x34d8e5,saltRounds);storeSettings({'bbPassword':_0x19fac5}),await sendTelegram(_0x94b488[_0x37e021(0x21b)]['id'],_0x37e021(0x276)+_0x34d8e5,{'parse_mode':_0x37e021(0x2de)});}else await sendTelegram(_0x94b488[_0x37e021(0x21b)]['id'],_0x37e021(0x350));});}}async function confirmRestore(_0xddf74a,_0xbb426e){const _0x56eb9d=_0x485691;io['to'](_0x56eb9d(0x1a5))[_0x56eb9d(0x2be)](_0x56eb9d(0x223),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x56eb9d(0x203));if(tgBot&&settings[_0x56eb9d(0x3a4)]){const _0x2e3835=uuidRandom();tmpStorage[_0x2e3835]={'path':_0xddf74a,'filename':_0xbb426e};const _0x5df053=Markup[_0x56eb9d(0x2db)]([Markup['button'][_0x56eb9d(0x2a8)](_0x56eb9d(0x295),_0x56eb9d(0x236)+_0x2e3835),Markup['button'][_0x56eb9d(0x2a8)]('no','restore_no_'+_0x2e3835)]);await sendTelegram(settings[_0x56eb9d(0x3a4)],_0x56eb9d(0x1e4),_0x5df053),tgBot[_0x56eb9d(0x1d9)](/restore_(.+)_(.+)/,async _0x4cac02=>{const _0xa080bd=_0x56eb9d,_0x23ae91=_0x4cac02[_0xa080bd(0x243)][0x1],_0xadf722=_0x4cac02[_0xa080bd(0x243)][0x2],{path:_0x418fd4,filename:_0x315ac9}=tmpStorage[_0xadf722];delete tmpStorage[_0xadf722],_0x4cac02[_0xa080bd(0x391)](),_0x23ae91=='yes'?(logger['debug'](_0xa080bd(0x3a1)),await sendTelegram(_0x4cac02['chat']['id'],_0xa080bd(0x269),{'parse_mode':_0xa080bd(0x2de)}),unzipFile(_0x418fd4,_0x315ac9)):(logger['debug']('Restore\x20process\x20aborted'),await sendTelegram(_0x4cac02[_0xa080bd(0x21b)]['id'],_0xa080bd(0x204)));});}}function getServerTime(){const _0x306f95=_0x485691,_0x5c0d5f=new Date();return _0x5c0d5f[_0x306f95(0x2c2)]()+'/'+(_0x5c0d5f[_0x306f95(0x2fc)]()+0x1)['toString']()[_0x306f95(0x239)](0x2,'0')+'/'+_0x5c0d5f[_0x306f95(0x38a)]()[_0x306f95(0x2ec)]()[_0x306f95(0x239)](0x2,'0')+'\x20'+_0x5c0d5f[_0x306f95(0x345)]()[_0x306f95(0x2ec)]()[_0x306f95(0x239)](0x2,'0')+':'+_0x5c0d5f[_0x306f95(0x27f)]()['toString']()['padStart'](0x2,'0')+':'+_0x5c0d5f[_0x306f95(0x294)]()[_0x306f95(0x2ec)]()[_0x306f95(0x239)](0x2,'0');}function getTimeStamp(){const _0x137af9=_0x485691,_0x1960cf=shiftedTime();return _0x1960cf[_0x137af9(0x2c2)]()+'/'+(_0x1960cf[_0x137af9(0x2fc)]()+0x1)[_0x137af9(0x2ec)]()[_0x137af9(0x239)](0x2,'0')+'/'+_0x1960cf[_0x137af9(0x38a)]()['toString']()[_0x137af9(0x239)](0x2,'0')+'\x20'+_0x1960cf['getHours']()[_0x137af9(0x2ec)]()[_0x137af9(0x239)](0x2,'0')+':'+_0x1960cf['getMinutes']()[_0x137af9(0x2ec)]()['padStart'](0x2,'0')+':'+_0x1960cf[_0x137af9(0x294)]()['toString']()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x5895db=_0x485691,_0x225e98=shiftedTime();return _0x225e98['getFullYear']()+(_0x225e98[_0x5895db(0x2fc)]()+0x1)[_0x5895db(0x2ec)]()['padStart'](0x2,'0')+_0x225e98[_0x5895db(0x38a)]()[_0x5895db(0x2ec)]()[_0x5895db(0x239)](0x2,'0')+'-'+_0x225e98[_0x5895db(0x345)]()[_0x5895db(0x2ec)]()[_0x5895db(0x239)](0x2,'0')+_0x225e98[_0x5895db(0x27f)]()[_0x5895db(0x2ec)]()['padStart'](0x2,'0')+_0x225e98['getSeconds']()['toString']()[_0x5895db(0x239)](0x2,'0');}function shiftedTime(){const _0x3cd7c9=_0x485691,_0x177262=new Date();let _0x24aa2c=_0x177262;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x24aa2c=fns[_0x3cd7c9(0x1c4)](_0x177262,{'hours':settings[_0x3cd7c9(0x392)]});return _0x24aa2c;}function startScheduler(){const _0x3f0404=_0x485691,_0x3fee03=new Date()[_0x3f0404(0x319)](),_0x5c6c7=shiftedTime()[_0x3f0404(0x345)]();_0x5c6c7==0x4&&backupConfigFiles();_0x5c6c7==0x0&&rotateLogFiles();_0x3fee03%0x6==0x0&&triggerAnalytics();_0x3fee03%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x3b0c6a){const _0xfba12a=_0x485691;logger[_0xfba12a(0x32d)](_0xfba12a(0x2e9)+_0x3b0c6a);const _0x4339a7=getBotsWithMode();_0x4339a7[_0xfba12a(0x30b)]>0x0?confirmRestore(configbackuppath,_0x3b0c6a):unzipFile(configbackuppath,_0x3b0c6a);}async function getBackupFiles(_0x133d18=null){const _0x452877=_0x485691;let _0x31e993=[],_0x42b4ce=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x42b4ce[_0x452877(0x372)]((_0x203a08,_0x5f3454)=>_0x203a08[_0x452877(0x244)]<_0x5f3454['name']?0x1:_0x5f3454[_0x452877(0x244)]<_0x203a08[_0x452877(0x244)]?-0x1:0x0),_0x42b4ce[_0x452877(0x256)](_0x5b80d9=>{const _0x23d3b6=_0x452877;if(!_0x5b80d9[_0x23d3b6(0x257)]()&&_0x5b80d9[_0x23d3b6(0x244)]['startsWith'](_0x23d3b6(0x224))&&_0x5b80d9[_0x23d3b6(0x244)][_0x23d3b6(0x1ae)](_0x23d3b6(0x310))){const _0xd90d5b=formatDate(fs[_0x23d3b6(0x2c6)](configbackuppath+_0x5b80d9[_0x23d3b6(0x244)])[_0x23d3b6(0x28e)]);_0x31e993[_0x23d3b6(0x35a)]({'name':_0x5b80d9[_0x23d3b6(0x244)],'mtime':_0xd90d5b});}});if(_0x133d18)io['to'](_0x133d18)[_0x452877(0x2be)]('backup-files',_0x31e993);else return _0x31e993;}async function backupConfigFiles(){const _0x51e4ae=_0x485691;await zipFiles('backup-full');const _0x280fa1=getCleanTimeStamp();fs[_0x51e4ae(0x2f5)](zippath+'backup-full.zip',configbackuppath+(_0x51e4ae(0x224)+_0x280fa1+_0x51e4ae(0x310)));let _0x3fc9c6=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x3fc9c6[_0x51e4ae(0x372)]((_0x3fe3e2,_0x45fdc4)=>_0x3fe3e2[_0x51e4ae(0x244)]<_0x45fdc4[_0x51e4ae(0x244)]?0x1:_0x45fdc4[_0x51e4ae(0x244)]<_0x3fe3e2[_0x51e4ae(0x244)]?-0x1:0x0),_0x3fc9c6['length']>maxBackups&&fs[_0x51e4ae(0x38c)](configbackuppath+_0x3fc9c6[_0x3fc9c6['length']-0x1][_0x51e4ae(0x244)]);}function rotateLogFiles(){const _0x35c765=_0x485691,_0x8f4afc=fs['statSync'](logspath+_0x35c765(0x21d)),_0x248f96=_0x8f4afc[_0x35c765(0x374)]/0x400;if(_0x248f96>0x64){let _0x190534=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x190534[_0x35c765(0x372)]((_0x1686b4,_0xfd6a0d)=>_0x1686b4[_0x35c765(0x244)]<_0xfd6a0d['name']?0x1:_0xfd6a0d['name']<_0x1686b4['name']?-0x1:0x0),_0x190534[_0x35c765(0x256)](_0x28820b=>{const _0x338171=_0x35c765;if(_0x28820b['name']==_0x338171(0x2e8))fs[_0x338171(0x2f5)](logspath+_0x28820b[_0x338171(0x244)],logspath+_0x338171(0x378));if(_0x28820b[_0x338171(0x244)]=='output-001.log')fs[_0x338171(0x2f5)](logspath+_0x28820b['name'],logspath+_0x338171(0x2e8));_0x28820b['name']=='output-000.log'&&(fs[_0x338171(0x2f5)](logspath+_0x28820b[_0x338171(0x244)],logspath+'output-001.log'),fs['writeFileSync'](logspath+_0x28820b[_0x338171(0x244)],''));});}}async function zipFiles(_0x5223a4){const _0x1fbf12=_0x485691;let _0x56eaba;if(_0x5223a4==_0x1fbf12(0x1da))_0x56eaba=logspath;if(_0x5223a4=='backup')_0x56eaba=configpath;if(_0x5223a4==_0x1fbf12(0x24a))_0x56eaba=configpath;let _0x41a914=fs[_0x1fbf12(0x213)](_0x56eaba,{'withFileTypes':!![]});const _0x357803=new require('node-zip')();_0x41a914[_0x1fbf12(0x256)](_0x3ca715=>{const _0x380466=_0x1fbf12;if(!_0x3ca715['isDirectory']()){let _0x23ca46=fs[_0x380466(0x39b)](_0x56eaba+_0x3ca715['name']);if(_0x5223a4=='backup'){const _0x396ea0=/^bot-[0-9]{3}-config.json$/,_0x2e21fe=_0x396ea0[_0x380466(0x384)](_0x3ca715['name']);if(_0x2e21fe){const _0x47af69=JSON[_0x380466(0x381)](_0x23ca46);if(_0x47af69[_0x380466(0x2ff)][0x0]){_0x47af69[_0x380466(0x2ff)][0x0][_0x380466(0x332)]=_0x380466(0x291),_0x47af69[_0x380466(0x2ff)][0x0][_0x380466(0x2ba)]=_0x380466(0x291);if(_0x47af69['bot'][0x0][_0x380466(0x1b5)])_0x47af69['bot'][0x0][_0x380466(0x1b5)]=_0x380466(0x291);}_0x23ca46=JSON['stringify'](_0x47af69,null,0x2);}if(_0x3ca715['name']=='bb-settings.json'){const _0x478d2b=JSON[_0x380466(0x381)](_0x23ca46);if(_0x478d2b[_0x380466(0x35d)]['loginRequired'])_0x478d2b[_0x380466(0x35d)][_0x380466(0x1db)]=![];if(_0x478d2b[_0x380466(0x35d)][_0x380466(0x373)])_0x478d2b[_0x380466(0x35d)][_0x380466(0x373)]=_0x380466(0x291);if(_0x478d2b[_0x380466(0x35d)][_0x380466(0x1c9)])_0x478d2b[_0x380466(0x35d)][_0x380466(0x1c9)]=_0x380466(0x291);if(_0x478d2b[_0x380466(0x35d)][_0x380466(0x3a4)])_0x478d2b[_0x380466(0x35d)]['telegramChatId']=null;if(_0x478d2b[_0x380466(0x35d)][_0x380466(0x38b)])_0x478d2b['settings']['marketcapApi']='***';_0x23ca46=JSON[_0x380466(0x2b1)](_0x478d2b,null,0x2);}if(_0x3ca715[_0x380466(0x244)]!=_0x380466(0x1af))_0x357803[_0x380466(0x1b9)](_0x3ca715[_0x380466(0x244)],_0x23ca46);}else _0x357803[_0x380466(0x1b9)](_0x3ca715[_0x380466(0x244)],_0x23ca46);}});const _0x29c690=_0x357803[_0x1fbf12(0x2b5)]({'base64':![],'compression':'DEFLATE'});fs[_0x1fbf12(0x240)](zippath+(_0x5223a4+_0x1fbf12(0x310)),_0x29c690,_0x1fbf12(0x25b));}async function unzipFile(_0x2ced23,_0x35839d){const _0x4f63c5=_0x485691;fs[_0x4f63c5(0x213)](configpath,{'withFileTypes':!![]})['forEach'](_0x32f6fc=>{const _0x5ea525=_0x4f63c5;if(!_0x32f6fc[_0x5ea525(0x257)]())fs[_0x5ea525(0x226)](configpath+_0x32f6fc['name']);});const _0x13284a=fs[_0x4f63c5(0x39b)](_0x2ced23+_0x35839d,'binary'),_0x1ee7f9=new require(_0x4f63c5(0x388))(_0x13284a,{'base64':![],'checkCRC32':!![]});Object[_0x4f63c5(0x275)](_0x1ee7f9['files'])[_0x4f63c5(0x256)](_0x2f671d=>{const _0x319477=_0x4f63c5,_0x107932=_0x1ee7f9['files'][_0x2f671d];fs[_0x319477(0x240)](configpath+_0x107932[_0x319477(0x244)],_0x107932[_0x319477(0x24c)]);}),fs[_0x4f63c5(0x213)](temppath,{'withFileTypes':!![]})[_0x4f63c5(0x256)](_0x34f1d8=>{const _0xd10b3f=_0x4f63c5;if(!_0x34f1d8[_0xd10b3f(0x257)]())fs[_0xd10b3f(0x226)](temppath+_0x34f1d8['name']);}),logger['debug'](_0x4f63c5(0x1f4)),process['send']({'restore':!![]},_0x3a2a89=>{});}async function getPublicIp(){const _0x2e9f9c=_0x485691;try{const _0x2c22e4=await axios['get']('https://api.ipify.org?format=json');publicip=_0x2c22e4[_0x2e9f9c(0x219)]['ip'];}catch(_0x4c61f2){}}async function triggerAnalytics(){const _0x515eac=_0x485691;if(!publicip)await getPublicIp();const _0xab45df=getBotsWithMode();let _0x32a4e8=0x0;_0xab45df[_0x515eac(0x256)](_0x14603c=>{const _0x4a10a8=_0x515eac;if(_0x14603c[_0x4a10a8(0x200)]==='enabled')_0x32a4e8++;});const _0x40b140=getBotExchanges();mixpanel[_0x515eac(0x354)]('Server',{'distinct_id':settings[_0x515eac(0x242)],'ip':publicip,'version':serverversion,'numbots':_0xab45df[_0x515eac(0x30b)],'numbotsenabled':_0x32a4e8,'exchanges':_0x40b140,'environment':environment});}async function getMessages(){const _0x1d6471=_0x485691,_0x384a3d=_0x1d6471(0x1f2),_0x4ff184=new GraphQLClient(_0x384a3d),_0x42d332={'authorization':_0x1d6471(0x348)},_0x17b834=serverversion[_0x1d6471(0x214)]('.'),_0x5d5790=_0x17b834[0x0]+'.'+_0x17b834[0x1],_0x57da95=Math[_0x1d6471(0x1ca)](settings[_0x1d6471(0x2f1)],settings[_0x1d6471(0x2a0)]),_0x4eaf27={'last':parseInt(_0x57da95),'bbm':_0x5d5790},_0xed203c=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x576157;try{_0x576157=await _0x4ff184[_0x1d6471(0x311)](_0xed203c,_0x4eaf27,_0x42d332);}catch(_0x524ea1){}if(_0x576157&&_0x576157[_0x1d6471(0x32f)]){let _0x2944d0=settings[_0x1d6471(0x2f1)];newMessages=[];for(const _0x23ecfc of _0x576157[_0x1d6471(0x32f)]){newMessages[_0x1d6471(0x35a)](_0x23ecfc);let _0x5a41aa=![];_0x23ecfc[_0x1d6471(0x1d6)]&&(updateSetting(_0x1d6471(0x2bc),_0x23ecfc['bbvNew']),_0x5a41aa=isNewerVersion(serverversion,_0x23ecfc[_0x1d6471(0x1d6)])||serverversion==_0x23ecfc['bbvNew']);if(!_0x5a41aa&&_0x23ecfc['number']>_0x2944d0){if(_0x23ecfc[_0x1d6471(0x278)]===_0x1d6471(0x260)||serverversion[_0x1d6471(0x2a6)](_0x23ecfc['bbvReceive'])){let _0x1b71a6=''+_0x23ecfc['title']+'\x0a\x0a'+_0x23ecfc[_0x1d6471(0x258)];const _0x1cd5a7=await sendTelegramMsg(toTelegramMarkdown(_0x1b71a6),'Markdown');if(_0x1cd5a7)_0x2944d0=_0x23ecfc[_0x1d6471(0x2d5)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x1d6471(0x2f1),_0x2944d0),emitMessages();}}function emitMessages(){const _0xb2ad4d=_0x485691,_0x3eaf22=settings['lastmsgemitted'];let _0x1c7c69=[];newMessages[_0xb2ad4d(0x256)](_0x3c4930=>{const _0x4cf836=_0xb2ad4d;_0x3c4930[_0x4cf836(0x2d5)]>_0x3eaf22&&_0x1c7c69[_0x4cf836(0x35a)](_0x3c4930);}),_0x1c7c69[_0xb2ad4d(0x30b)]>0x0&&getAllClients()['forEach'](_0x460deb=>{const _0x1d628d=_0xb2ad4d;getSocket(_0x460deb['id'])[_0x1d628d(0x2be)]('message',_0x1c7c69);});}function confirmMessage(_0xc1da66){updateSetting('lastmsgemitted',Number(_0xc1da66));}function isNewerVersion(_0x37336e,_0x3b4d22){const _0x3e0ec7=_0x485691,_0x2a5f17=_0x3b4d22[_0x3e0ec7(0x214)]('.'),_0x22ffad=_0x37336e[_0x3e0ec7(0x214)]('.');for(var _0x385596=0x0;_0x385596<_0x22ffad[_0x3e0ec7(0x30b)];_0x385596++){const _0x453611=~~_0x22ffad[_0x385596],_0x599fd1=~~_0x2a5f17[_0x385596];if(_0x453611>_0x599fd1)return!![];if(_0x453611<_0x599fd1)return![];}return![];}function toTelegramMarkdown(_0x497a11){const _0x238dfe=_0x485691,_0x350808=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x2f9807=/\*{2}(.+?)\*{2}/gim;return _0x497a11=_0x497a11['replace'](_0x350808,_0x238dfe(0x2c0))[_0x238dfe(0x1c5)](_0x2f9807,_0x238dfe(0x26a)),_0x497a11;}async function validateConfigFile(){const _0x26482b=_0x485691,_0xb8b4a4=dbConfig[_0x26482b(0x306)](_0x26482b(0x29e))[_0x26482b(0x285)]('botID')[_0x26482b(0x249)]()||[];if(_0xb8b4a4[_0x26482b(0x30b)]==0x0){let _0x40b658=0x0,_0x20dc85=[];const _0x380759=/^bot-([0-9]{3})-config.json$/,_0x5a630c=fs['readdirSync'](configpath);_0x5a630c[_0x26482b(0x256)](_0x39aad7=>{const _0x2447d2=_0x26482b,_0x2e7cca=_0x380759[_0x2447d2(0x2cb)](_0x39aad7);if(_0x2e7cca){const _0x81acc0=_0x2e7cca[0x1];let _0x535518=getBotAttributes(_0x81acc0);_0x20dc85[_0x2447d2(0x35a)]({'botID':_0x81acc0,'botname':_0x535518[_0x2447d2(0x22c)],'status':'disabled','live':_0x2447d2(0x1b8)}),_0x40b658++;}}),_0x40b658!=0x0&&(dbConfig[_0x26482b(0x306)]('bots')[_0x26482b(0x35e)](_0x20dc85)[_0x26482b(0x2b7)](),config=_0x20dc85,restoredConfigFile=_0x40b658);}}async function restoreConfigNotify(_0x275569){const _0xea787d=_0x485691;let _0x1e7d34;if(restoredConfigFile==0x1)_0x1e7d34='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x1e7d34='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x275569)io['to'](_0xea787d(0x1a5))['emit'](_0xea787d(0x223),_0x1e7d34);else{logger[_0xea787d(0x251)](_0xea787d(0x262)),logger[_0xea787d(0x251)](_0x1e7d34),logger[_0xea787d(0x251)](_0xea787d(0x262)),logger[_0xea787d(0x251)]('');if(tgBot&&settings[_0xea787d(0x3a4)]&&settings[_0xea787d(0x30c)]!=_0xea787d(0x383))await sendTelegram(settings[_0xea787d(0x3a4)],_0xea787d(0x284)+_0x1e7d34);}}function validateCredentials(_0x29b1e3,_0x2e6de8){const _0x3e2264=_0x485691;if(_0x29b1e3[_0x3e2264(0x394)]==settings['bbUsername']&&bcrypt[_0x3e2264(0x2eb)](_0x29b1e3[_0x3e2264(0x395)],settings[_0x3e2264(0x373)])){if(settings[_0x3e2264(0x2bd)])return{'allow':![],'reason':_0x3e2264(0x21a),'token':null};else{const _0x95ab29=generateLoginToken(_0x2e6de8);return{'allow':!![],'reason':_0x3e2264(0x1be),'token':_0x95ab29};}}else return{'allow':![],'reason':_0x3e2264(0x3a2),'token':null};}function refreshToken(_0x53570a){const _0x5283b0=_0x485691,_0xe5437b=generateLoginToken(_0x53570a);return{'allow':!![],'reason':_0x5283b0(0x1be),'token':_0xe5437b};}function validateAccess(_0x1c756b,_0x3f8841,_0x10ad7c){const _0x2f8da2=_0x485691,_0x4b6556=_0x10ad7c?_0x10ad7c:devices[_0x3f8841]['ip'];let _0x547eb9;const _0x12cc3f=_0x203520=>{const _0x27babd=_0x2509;if(settings[_0x27babd(0x1db)]){if(settings[_0x27babd(0x2bd)]){if(telegram2FaApproved(_0x3f8841)){const _0x43a0e7=generateLoginToken(_0x3f8841);return{'allow':!![],'reason':_0x27babd(0x34e),'token':_0x43a0e7};}else return{'allow':![],'reason':_0x27babd(0x231),'token':null};}else return _0x547eb9=validToken(_0x203520,_0x3f8841),_0x547eb9[_0x27babd(0x1b3)](_0x27babd(0x203))?{'allow':!![],'reason':_0x27babd(0x2ab),'token':_0x203520}:{'allow':![],'reason':_0x27babd(0x231),'token':null};}else return{'allow':!![],'reason':_0x27babd(0x323),'token':null};};if(settings[_0x2f8da2(0x237)]){let _0x53bad5=[...settings['whitelist'],_0x2f8da2(0x27d),_0x2f8da2(0x228),'127.0.0.1'];if(_0x53bad5['includes'](_0x4b6556))return _0x12cc3f(_0x1c756b);else{_0x547eb9=validToken(_0x1c756b,_0x3f8841);if(_0x547eb9[_0x2f8da2(0x1b3)](_0x2f8da2(0x203)))return _0x12cc3f(_0x1c756b);else{if(telegramIpApproved(_0x3f8841)){const _0x47d581=generateToken(_0x3f8841);return _0x547eb9=_0x12cc3f(_0x1c756b),_0x547eb9[_0x2f8da2(0x2d8)]?{'allow':!![],'reason':_0x2f8da2(0x261),'token':_0x47d581}:_0x547eb9;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x2f8da2(0x2cf),'token':null};}}}else return _0x12cc3f(_0x1c756b);}function timelyDecrypt(_0x3bf87a,_0x5196bb,_0x3225dd='@'){const _0x2ba881=_0x485691;if(_0x3bf87a)try{const _0x452db4=crypt[_0x2ba881(0x375)](secure[_0x2ba881(0x250)],_0x3bf87a)[_0x2ba881(0x258)],_0x25c678=_0x452db4[_0x2ba881(0x214)](_0x3225dd)[0x0],_0x36ee2b=_0x452db4[_0x2ba881(0x214)](_0x3225dd)[0x1],_0x5cbad5=new Date()[_0x2ba881(0x24d)]();if(_0x5196bb){if(_0x5cbad5-_0x36ee2b<maxSecretAge*0x3e8)return _0x25c678;else return![];}else return _0x25c678;}catch(_0x54931f){return![];}else return![];}const validToken=(_0x539842,_0x5dacfc)=>{const _0x405a63=_0x485691,_0x12b2c5=devices[_0x5dacfc]['ip'];if(!_0x539842)return{'error':_0x405a63(0x35c)};for(let _0x3a9aae of blacklist){if(_0x3a9aae[_0x405a63(0x1d5)]==_0x539842)return{'error':_0x405a63(0x34a)};}let _0x3a317c;try{_0x3a317c=jwt['verify'](_0x539842,secure[_0x405a63(0x1e6)]+_0x5dacfc);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x3a317c[_0x405a63(0x1b3)](_0x405a63(0x325))&&!_0x3a317c[_0x405a63(0x1b3)](_0x405a63(0x394))||!_0x3a317c[_0x405a63(0x1b3)](_0x405a63(0x26e)))return{'error':_0x405a63(0x1ea)};if(!_0x3a317c['hasOwnProperty'](_0x405a63(0x394))&&_0x3a317c['hasOwnProperty']('clientip')){const {clientip:_0x236912}=_0x3a317c;return _0x12b2c5==_0x236912?{'success':_0x405a63(0x24b)}:{'error':_0x405a63(0x2b4)};}else{if(_0x3a317c[_0x405a63(0x1b3)](_0x405a63(0x394))&&_0x3a317c[_0x405a63(0x1b3)]('clientip')){const {username:_0x1659eb,clientip:_0x18585f}=_0x3a317c;return settings[_0x405a63(0x1dd)]==_0x1659eb&&_0x12b2c5==_0x18585f?{'success':_0x405a63(0x24b)}:{'error':_0x405a63(0x292)};}}},generateLoginToken=_0x23cb8d=>{const _0x534795=_0x485691;if(_0x23cb8d){const _0x542b73=devices[_0x23cb8d]['ip'];return jwt[_0x534795(0x211)]({'username':settings[_0x534795(0x1dd)],'clientip':_0x542b73},secure[_0x534795(0x1e6)]+_0x23cb8d,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x12e25b=>{const _0x1f783f=_0x485691;if(_0x12e25b){const _0x11bb62=devices[_0x12e25b]['ip'];return jwt['sign']({'clientip':_0x11bb62},secure[_0x1f783f(0x1e6)]+_0x12e25b,{'expiresIn':devices[_0x12e25b][_0x1f783f(0x37f)][_0x1f783f(0x27c)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x48f022=>{const _0x58005d=_0x485691;let _0xc50042=![];return devices[_0x48f022][_0x58005d(0x37f)]&&devices[_0x48f022][_0x58005d(0x37f)]['expiry']!=_0x58005d(0x36e)&&(_0xc50042=devices[_0x48f022][_0x58005d(0x37f)][_0x58005d(0x325)]==devices[_0x48f022]['ip']&&new Date()[_0x58005d(0x24d)]()-devices[_0x48f022][_0x58005d(0x37f)][_0x58005d(0x28a)]<devices[_0x48f022][_0x58005d(0x37f)]['expiry']*0x3c*0x3e8),_0xc50042;},telegram2FaApproved=_0x4f22ee=>{const _0x259a08=_0x485691;let _0x43d6ca=![];return devices[_0x4f22ee][_0x259a08(0x2bb)]&&devices[_0x4f22ee][_0x259a08(0x2bb)][_0x259a08(0x27c)]!='reject'&&(_0x43d6ca=devices[_0x4f22ee]['telegram2FaApproval'][_0x259a08(0x325)]==devices[_0x4f22ee]['ip']&&new Date()[_0x259a08(0x24d)]()-devices[_0x4f22ee][_0x259a08(0x2bb)][_0x259a08(0x28a)]<devices[_0x4f22ee][_0x259a08(0x2bb)][_0x259a08(0x27c)]*0x3c*0x3e8),_0x43d6ca;},normalizeIP=_0x342dad=>{const _0x103cbd=_0x485691;let _0x2a86a7=null,_0x2f38f4=null;if(ipaddr['isValid'](_0x342dad)){const _0x57ef1c=ipaddr['parse'](_0x342dad);_0x57ef1c[_0x103cbd(0x2f8)]()===_0x103cbd(0x1ce)?(_0x57ef1c[_0x103cbd(0x1f7)]()&&(_0x2a86a7=_0x57ef1c[_0x103cbd(0x2e1)]()[_0x103cbd(0x2ec)]()),_0x2f38f4=_0x57ef1c[_0x103cbd(0x2ec)]()):(_0x2a86a7=_0x57ef1c[_0x103cbd(0x2ec)](),_0x2f38f4=_0x57ef1c['toIPv4MappedAddress']()[_0x103cbd(0x2ec)]());}return{'show':_0x2a86a7?_0x2a86a7:_0x2f38f4,'store':_0x2f38f4};};function formatDate(_0x3804f7){const _0x40964c=_0x485691;return _0x3804f7['getFullYear']()+'/'+(_0x3804f7[_0x40964c(0x2fc)]()+0x1)[_0x40964c(0x2ec)]()['padStart'](0x2,'0')+'/'+_0x3804f7[_0x40964c(0x38a)]()[_0x40964c(0x2ec)]()[_0x40964c(0x239)](0x2,'0')+'\x20'+_0x3804f7[_0x40964c(0x345)]()['toString']()[_0x40964c(0x239)](0x2,'0')+':'+_0x3804f7[_0x40964c(0x27f)]()['toString']()[_0x40964c(0x239)](0x2,'0')+':'+_0x3804f7[_0x40964c(0x294)]()[_0x40964c(0x2ec)]()[_0x40964c(0x239)](0x2,'0');}function sleep(_0x377f0c){return new Promise(_0xeac54d=>setTimeout(_0xeac54d,_0x377f0c));}