const _0x1131a9=_0xc092;(function(_0x46b83d,_0x4e744c){const _0x299dd3=_0xc092,_0x14d28f=_0x46b83d();while(!![]){try{const _0x53a1e9=parseInt(_0x299dd3(0x24d))/0x1*(parseInt(_0x299dd3(0x161))/0x2)+parseInt(_0x299dd3(0x256))/0x3*(-parseInt(_0x299dd3(0xc8))/0x4)+parseInt(_0x299dd3(0x148))/0x5*(-parseInt(_0x299dd3(0x210))/0x6)+parseInt(_0x299dd3(0xde))/0x7*(parseInt(_0x299dd3(0x15e))/0x8)+-parseInt(_0x299dd3(0x251))/0x9*(parseInt(_0x299dd3(0x90))/0xa)+parseInt(_0x299dd3(0x203))/0xb*(parseInt(_0x299dd3(0x19f))/0xc)+-parseInt(_0x299dd3(0x10d))/0xd*(parseInt(_0x299dd3(0x1ae))/0xe);if(_0x53a1e9===_0x4e744c)break;else _0x14d28f['push'](_0x14d28f['shift']());}catch(_0x3f15b5){_0x14d28f['push'](_0x14d28f['shift']());}}}(_0x43a0,0x9a298));const _0x734dad=function(){let _0x1d7eb5=!![];return function(_0x4012e2,_0xba23ff){const _0x274e67=_0x1d7eb5?function(){const _0x43cfd2=_0xc092;if(_0xba23ff){const _0x319c0b=_0xba23ff[_0x43cfd2(0x1bf)](_0x4012e2,arguments);return _0xba23ff=null,_0x319c0b;}}:function(){};return _0x1d7eb5=![],_0x274e67;};}(),_0x43bab7=_0x734dad(this,function(){const _0xda7e05=_0xc092;return _0x43bab7[_0xda7e05(0x1d4)]()['search'](_0xda7e05(0x239))[_0xda7e05(0x1d4)]()[_0xda7e05(0xa5)](_0x43bab7)[_0xda7e05(0x14c)](_0xda7e05(0x239));});_0x43bab7();'use strict';process[_0x1131a9(0x115)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x1131a9(0x19e)),fs=require('fs'),fns=require(_0x1131a9(0x1f6)),low=require(_0x1131a9(0x257)),FileSync=require(_0x1131a9(0x19c)),path=require('path'),crypto=require(_0x1131a9(0x18f)),Crypt=require('hybrid-crypto-js')[_0x1131a9(0x237)],RSA=require('hybrid-crypto-js')[_0x1131a9(0x201)],bcrypt=require(_0x1131a9(0xd4)),jwt=require(_0x1131a9(0xf0)),ipaddr=require(_0x1131a9(0x1a5)),argv=require('yargs/yargs')(process[_0x1131a9(0x13a)][_0x1131a9(0xad)](0x2))[_0x1131a9(0x13a)],uuidRandom=require('uuid-random'),{Telegraf,Markup}=require(_0x1131a9(0x19b)),Mixpanel=require(_0x1131a9(0x174)),axios=require('axios'),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x1131a9(0x164)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x1131a9(0x146)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x1131a9(0x92)](PORT)&&(console[_0x1131a9(0x100)](_0x1131a9(0xfd)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x1131a9(0x1d6)](0x1));const HOST=argv[_0x1131a9(0x255)]||null,userID=argv[_0x1131a9(0xd5)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x1131a9(0x1aa)];let bbpath=_0x1131a9(0x266),bbpath2='';const botfile=_0x1131a9(0xba),configfile=_0x1131a9(0x26d),settingsfile='bb-settings.json',securefile=_0x1131a9(0x154),environment=require('./'+bbpath2+'version.json')[_0x1131a9(0xc5)]||_0x1131a9(0x199),maxBackups=0xa;let validInstallation=!![];!fs[_0x1131a9(0x286)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x1131a9(0x1b3)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x1131a9(0x8f),configbackuppath=configpath+_0x1131a9(0x181),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x1131a9(0x147),zippath=userID?bbpath+_0x1131a9(0x1c0)+userID+'/':bbpath+_0x1131a9(0x1c0),loggerfile=fs[_0x1131a9(0x1a6)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x1131a9(0x22d)+userID+'/':bbpath+'temp/';!fs['existsSync'](configpath)&&fs['mkdirSync'](configpath);function _0x43a0(){const _0xf0b4f6=['copyFileSync','pidRefreshToken','sendMetricsTelegram','bot.js','All\x20bots','reinstall-bb','invalid\x20credentials','login\x20not\x20required','padStart','rmSync','inlineKeyboard','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','help','Invalid\x20username\x20or\x20IP\x20address','environment','SIGTERM','use','2459660OgWDJO','getSeconds','tkn','send','127.0.0.1','editMessageReplyMarkup','tempaccess_reject_','(staging)','config','notification','randomBytes','\x20minutes','bcryptjs','user','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','split','Unauthorized\x20login\x20attempt\x20(timeout)','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','running','telegramEvents','\x20|\x20','Logged\x20out\x20user\x20...','72408zgiKHA','replace','-----------------------------------------------------------------------------------','resetHistory','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','isIPv4MappedAddress','login\x20required','2FA','login\x20token\x20generated','exec','get','place-order','getUTCHours','sendFile','reinstall_no','hasOwnProperty','build2','update-bot','jsonwebtoken','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','stop','auto','\x20only\x0a','uncaughtException','<b>Balance\x20Bot\x20Status:</b>\x0a','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','username','bbUsername','6b67f3d61ee94b8f5c80b4affef4c4d9','/:bot','toIPv4MappedAddress','Error:\x20Invalid\x20argument\x20','output-002.log','filter','log',')\x20\x20\x20|\x20Bot\x20','isDirectory','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','off_','files','Enabled\x20Bot\x20','output-003.log','disconnect','Restoring\x20bot(s)\x20from\x20backup','forEach','show','family','130SUBZfR','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Backup\x20file\x20unzipped\x20and\x20stored','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','close','logs','config_all','-results.json','env','isValid','Starting\x20#RED#Balance\x20Bot\x20v','file','internal','reinstall','kind','Setting\x20access:\x20','cancelLoading','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','HTML','Idling\x20(','sign','reload','socket','IPv4','No\x20bots\x20running\x20right\x20now','names','store-fiat','apiKey','***','getDate','set','latestversion','new','temporary\x20token\x20generated','backup-full@','getMonth','metrics_','get-messages','File\x20uploaded','\x1b[31m','Unauthorized\x20attempt\x20to\x20log\x20out','from','all','login','argv','version.json','password','connected','data','Restore\x20backup\x20file\x20','access','bots','initclient','Starting\x20Balance\x20Bot\x20reinstallation','bbPassword','onepagemode','port','logs/','30TFETeN','static','0.0.0','store','search','\x20>\x20','ipv6','Unauthorized\x20attempt\x20to\x20delete\x20alerts','number','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','toggleBotMode','unlinkSync','bb-secure.json','/enable\x20-\x20enable\x20notifications\x0a','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','whitelist','error','2FA\x20required','temporary\x20access\x20timeout','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','#RES#\x20if\x20running\x20locally\x0a','/download/:type','976qqqOoE','bbvNew','Unauthorized\x20attempt\x20to\x20download\x20','2GdFtbz','remoteAddress','callback','util','exp','sendMessage','Disabled\x20Bot\x20','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Password\x20reset\x20rejected','expiry','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','once','Temporary\x20access\x20rejected','\x1b[33m','listen','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','createServer','hex','Your\x20installation\x20is\x20already\x20up\x20to\x20date','mixpanel','address','DEFLATE','bb-settings.json','_data','https://api.ipify.org?format=json','socket.io','Failed\x20to\x20download\x20','/metrics\x20-\x20show\x20bot\x20performance\x0a','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','headless','api-eu.mixpanel.com','status','backup/','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','#RES#\x20','sha256','toggle','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','reason','index.html','\x1b[34m','headers','::ffff:127.0.0.1','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','\x20to\x20','showConfig','crypto','success','/disable\x20-\x20disable\x20notifications\x0a','sort','sendPortfolioTelegram','getTime','store-configuration','Token\x20blacklisted','writeFileSync','/on\x20-\x20start\x20bot(s)\x0a','production','orders','telegraf','lowdb/adapters/FileSync','Ok,\x20will\x20send\x20order\x20notifications\x20only','child_process','6612qCJcwV','botID','-config.json','tempaccess_5_','Unauthorized\x20attempt\x20to\x20show\x20configuration','delete-bot','ipaddr.js','createWriteStream','backup','reset-password','write','node','timeshift','metrics','/restart\x20-\x20restart\x20bot(s)\x0a','223902tXNAVB','confirm-message','lastmsgtelegram','emit','SIGINT','clients','botname','kill',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','inherit','access\x20timeout','output-001.log','privateKey','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','\x20mode','allow','defaults','apply','zip/','Markdown','length','\x1b[0m','restart_','function','<b>Telegram\x20Bot\x20Status:</b>\x0a','User\x20has\x20been\x20validated','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','2FA\x20login\x20token\x20generated','All','getStartingBalances','cancel-loading','action','mtime','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','storeHeadless','backup-full','toString','Unauthorized\x20attempt\x20to\x20update\x20settings','exit','Bot\x20','Login\x20rejected','new-disabled','secure','showname','botmanager','publicKey','backup-full.zip','track','logout','backupfile','Error\x20while\x20deleting\x20config\x20files:\x20','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','statSync','assign','match','update','telegrammsg','bot','includes','Notifications\x20types:\x20','temporaryAccessAllowed','Starting\x20(','telegram2FaApproval','f2aRequired','storeConfiguration','message','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','No\x20authentication\x20token','staging','login2fa_reject_','date-fns','Notifications\x20disabled','value','lastmsgemitted','reply','Yes','/help\x20-\x20show\x20available\x20commands\x0a','restart','alias','loginRequired','on_','RSA','Unauthorized\x20attempt\x20to\x20confirm\x20message','7458hNEMLM','Unauthorized\x20attempt\x20to\x20update\x20bot','Restarting\x20Bot\x20','pidExpireLogin','hashSync','Server','disable','Unauthorized\x20attempt\x20to\x20delete\x20bot','download','secret','reject','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','params','310854JXPuDk','readdirSync','Session\x20expired\x20for\x20user\x20...','resetpw_yes','range','Deleted\x20Bot\x20','uuid','/:bot/portfolio','bbvReceive','started','connection','add','post','type','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','\x20|\x20user:\x20...','entries','stopped','randomFillSync','resetpw_no','/start','format','mode','telegramIpApproval','launch','deleteHistoryAlerts','button','map','catch','temp/','Restore\x20process\x20confirmed','portfolio_','Access\x20enabled\x20for\x20','/:bot/history','\x1b[35m','Error\x20removing\x20old\x20backup\x20files:','restore_no_','mkdirSync','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Crypt','config_alerts','(((.+)+)+)+$','command','endsWith','Invalid\x20authentication\x20token\x20(2)','get-portfolio','************','store-settings','telegramChatId','off','encryptedUuid','Unauthorized\x20attempt\x20to\x20get\x20messages','get-starting-balances','toIPv4Address','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','chat','alerts','telegramToken','apiPassword','compareSync','Orders','112341mgntHh','bot-','event','5\x20min','27666FczRcW','update_no','debug','auth','host','3IimCsy','lowdb','disabled','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','stringify','readFileSync','temporary\x20access\x20rejected','/:bot/support','reset-history','Invalid\x20IP\x20address','sortBy','/:bot/coins','simple','text','#RES#\x20if\x20running\x20on\x20server','push','bb/','live','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','2FA\x20login\x20required','add-bot','Notifications\x20enabled\x0a','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','bb-config.json','15\x20min','startsWith','settings','token','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','size','server','Backup\x20file\x20uploaded','login\x20token\x20valid','getFullYear','clientip',')\x20|\x20Bot\x20','max','remove','generateKeyPairAsync','reinstall_yes','show-config','restore-backup-file','binary','storeFiat','blacklist','output-000.log','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','existsSync','keys','request','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','-performance.json','build','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','telegram','name','apiSecret','Notifications\x20enabled','yes','Node.js\x20v','\x20|\x20client:\x20...','settings.','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Starting\x20new\x20bot\x20|\x20Bot\x20','parse','/status\x20-\x20show\x20bot(s)\x20status\x0a','verify','find','config/','100XMIjSV','=>\x20Go\x20to\x20#CYA#http://','test','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','enabled','Unauthorized\x20attempt\x20to\x20get\x20portfolio','tempaccess_30_','You\x20can\x20use\x20the\x20following\x20commands:\x0a','private','join','messages','express','get-backup-files','then','enable','telegramUsername','Allow\x20login\x20from\x20IP\x20address\x20','Bot\x20Mgr\x20>\x20','-events.json','[ip-address]','manual','constructor','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','sockets',':\x20Bot\x20Mgr\x20>\x20','init','getHours','Starting\x20Balance\x20Bot\x20update','cloneDeep','slice','full','getMinutes','userid','/:bot/configuration','telegramEnabled','warning','order','/update\x20-\x20update\x20Balance\x20Bot\x0a','.zip'];_0x43a0=function(){return _0xf0b4f6;};return _0x43a0();}!fs[_0x1131a9(0x286)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x1131a9(0x286)](logspath)&&fs[_0x1131a9(0x235)](logspath);!fs[_0x1131a9(0x286)](zippath)&&fs[_0x1131a9(0x235)](zippath);!fs[_0x1131a9(0x286)](temppath)&&fs[_0x1131a9(0x235)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x1131a9(0x1be)]({'bots':[]})[_0x1131a9(0x1a9)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x1131a9(0x1be)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x1131a9(0x14a),'onepagemode':![]}})[_0x1131a9(0x1a9)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x1131a9(0x184),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x1131a9(0xa9)](_0x1131a9(0xfa),{'host':_0x1131a9(0x17f)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x1131a9(0x249)]&&(settings[_0x1131a9(0x249)]!=''&&settings[_0x1131a9(0x249)]!=_0x1131a9(0x12a))&&settings['telegramUsername']&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x46b098,_0x2964ae)=>{const _0x506618=_0x1131a9,_0x141e6f=/#[A-Z]{3}#/g;if(typeof _0x46b098=='string'){!_0x2964ae?_0x46b098=_0x46b098[_0x506618(0xdf)](_0x141e6f,''):(_0x46b098=_0x46b098['replace'](/#BLU#/g,_0x506618(0x189)),_0x46b098=_0x46b098[_0x506618(0xdf)](/#RED#/g,_0x506618(0x135)),_0x46b098=_0x46b098['replace'](/#YEL#/g,_0x506618(0x16e)),_0x46b098=_0x46b098['replace'](/#MAG#/g,_0x506618(0x232)),_0x46b098=_0x46b098[_0x506618(0xdf)](/#CYA#/g,'\x1b[36m'),_0x46b098=_0x46b098[_0x506618(0xdf)](/#RES#/g,_0x506618(0x1c3)));;}return _0x46b098;},logger={'screen':_0x36e10a=>{console['log'](parseColor(_0x36e10a,!![]));},'simple':_0x5171b0=>{const _0x4e5cee=_0x1131a9;console[_0x4e5cee(0x100)](parseColor(_0x5171b0,!![])),loggerfile[_0x4e5cee(0x1a9)](util['format'](parseColor(_0x5171b0,![]))+'\x0a');},'full':async _0x2ec894=>{const _0x9f820f=_0x1131a9,_0x27edb9=getTimeStamp()+_0x9f820f(0xa8)+_0x2ec894;console['log'](parseColor(_0x27edb9,!![])),loggerfile[_0x9f820f(0x1a9)](util[_0x9f820f(0x225)](parseColor(_0x27edb9,![]))+'\x0a');if(tgBot&&settings[_0x9f820f(0x240)]&&settings['telegramEvents']!=_0x9f820f(0x19a))await sendTelegram(settings[_0x9f820f(0x240)],_0x9f820f(0xa1)+parseColor(_0x2ec894,![]));},'debug':async(_0x2c7c97,_0x1d3eb4='')=>{const _0x39816b=_0x1131a9,_0x12f27d=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x2c7c97;if(debugging)console[_0x39816b(0x100)](parseColor(_0x12f27d,!![]));loggerfile[_0x39816b(0x1a9)](util[_0x39816b(0x225)](parseColor(_0x12f27d,![]))+'\x0a');if(_0x1d3eb4){if(debugging)console['log'](_0x1d3eb4);loggerfile[_0x39816b(0x1a9)](util[_0x39816b(0x225)](_0x1d3eb4)+'\x0a');}}};let terminating=![];function _0xc092(_0x1f7318,_0x18c803){const _0x1483a2=_0x43a0();return _0xc092=function(_0x43bab7,_0x734dad){_0x43bab7=_0x43bab7-0x83;let _0x43a002=_0x1483a2[_0x43bab7];return _0x43a002;},_0xc092(_0x1f7318,_0x18c803);}process['on'](_0x1131a9(0xf5),function(_0x59d9b8){const _0x15a32d=_0x1131a9;logger[_0x15a32d(0x262)](_0x59d9b8);}),process['on'](_0x1131a9(0x1d6),()=>{stopAllBots();}),process['on'](_0x1131a9(0x1b2),()=>{stopAllBots();});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x1131a9(0x13b))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x1131a9(0x9b)),app=express(),http=require('http')[_0x1131a9(0x171)](app);app[_0x1131a9(0xc7)](fileUpload({'useTempFiles':!![]})),app[_0x1131a9(0xe8)](_0x1131a9(0x15d),async(_0xb65886,_0x1ef05b)=>{const _0x4e5b92=_0x1131a9,_0x35817d=_0xb65886[_0x4e5b92(0x20f)][_0x4e5b92(0x21d)],_0x4c26c0=getClientsWithBotID(_0x4e5b92(0x1dc)),_0x460a6a=_0xb65886[_0x4e5b92(0x18a)][_0x4e5b92(0x216)],_0x412431=timelyDecrypt(_0x460a6a,![]),_0x1a115f=_0x4c26c0[_0x4e5b92(0x8e)](_0x4379da=>_0x4379da[_0x4e5b92(0x216)]==_0x412431);if(_0x1a115f){const _0x49d133=normalizeIP(_0xb65886['socket'][_0x4e5b92(0x162)])[_0x4e5b92(0x14b)],_0x8fae2=_0xb65886[_0x4e5b92(0x18a)][_0x4e5b92(0xca)];if(validateAccess(_0x8fae2,_0x412431,_0x49d133)[_0x4e5b92(0x1bd)])_0x35817d==_0x4e5b92(0x1a7)&&await backupConfigFiles(),await zipFiles(_0x35817d),_0x1ef05b[_0x4e5b92(0x20b)](zippath+(_0x35817d+_0x4e5b92(0xb6)),_0x5f1f45=>{const _0xe4a307=_0x4e5b92;_0x5f1f45&&(logger[_0xe4a307(0xae)](_0xe4a307(0x17b)+_0x35817d),logger[_0xe4a307(0x262)](_0x5f1f45));});else logger[_0x4e5b92(0xae)](_0x4e5b92(0x160)+_0x35817d+'\x20(1)');}else logger['full'](_0x4e5b92(0x160)+_0x35817d+'\x20(2)');}),app[_0x1131a9(0x21c)]('/upload-backup',async(_0x57fafa,_0x2be999)=>{const _0x36e038=_0x1131a9,_0x4d56e4=getClientsWithBotID(_0x36e038(0x1dc)),_0x482a05=_0x57fafa[_0x36e038(0x18a)][_0x36e038(0x216)],_0x6f198b=timelyDecrypt(_0x482a05,![]),_0x1c1ed6=_0x4d56e4[_0x36e038(0x8e)](_0x5f31e4=>_0x5f31e4[_0x36e038(0x216)]==_0x6f198b);logger[_0x36e038(0x253)](_0x36e038(0x276));if(_0x1c1ed6){const _0x279007=normalizeIP(_0x57fafa[_0x36e038(0x124)][_0x36e038(0x162)])[_0x36e038(0x14b)],_0x9c73b8=_0x57fafa[_0x36e038(0x18a)]['tkn'];if(validateAccess(_0x9c73b8,_0x6f198b,_0x279007)[_0x36e038(0x1bd)]){if(_0x57fafa[_0x36e038(0x105)]){const _0x5bfe38=_0x57fafa[_0x36e038(0x105)][_0x36e038(0x1e1)];await _0x5bfe38['mv'](temppath+_0x5bfe38[_0x36e038(0x28e)]),_0x2be999[_0x36e038(0xcb)]({'status':!![],'message':_0x36e038(0x134)});const _0x1ae0ef=getBotsWithMode();_0x1ae0ef[_0x36e038(0x1c2)]>0x0?confirmRestore(temppath,_0x5bfe38[_0x36e038(0x28e)]):unzipFile(temppath,_0x5bfe38[_0x36e038(0x28e)]);}}else logger[_0x36e038(0xae)](_0x36e038(0x156));}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x1131a9(0xc7)](express['static'](path[_0x1131a9(0x99)](__dirname,bbpath2,'build2'))),app[_0x1131a9(0xc7)](express[_0x1131a9(0x149)](path[_0x1131a9(0x99)](__dirname,bbpath2,_0x1131a9(0x28b)))),app['get']('/',function(_0x4e651f,_0x3a50b8){const _0x251573=_0x1131a9;_0x3a50b8[_0x251573(0xeb)](path[_0x251573(0x99)](__dirname,bbpath2,_0x251573(0xee),_0x251573(0x188)));}),app[_0x1131a9(0xe8)](_0x1131a9(0xfb),function(_0x31e44c,_0x366d67){const _0x1a569a=_0x1131a9;_0x366d67[_0x1a569a(0xeb)](path['join'](__dirname,bbpath2,_0x1a569a(0x28b),'index.html'));}),app['get'](_0x1131a9(0x217),(_0x594d7d,_0x115541)=>{const _0x38a008=_0x1131a9;_0x115541[_0x38a008(0xeb)](path[_0x38a008(0x99)](__dirname,bbpath2,_0x38a008(0x28b),_0x38a008(0x188)));}),app[_0x1131a9(0xe8)]('/:bot/performance',(_0x926707,_0x513abf)=>{const _0x4a884e=_0x1131a9;_0x513abf['sendFile'](path['join'](__dirname,bbpath2,_0x4a884e(0x28b),_0x4a884e(0x188)));}),app[_0x1131a9(0xe8)](_0x1131a9(0x261),(_0x5ed735,_0x53a050)=>{const _0x465678=_0x1131a9;_0x53a050['sendFile'](path[_0x465678(0x99)](__dirname,bbpath2,_0x465678(0x28b),_0x465678(0x188)));}),app[_0x1131a9(0xe8)](_0x1131a9(0x231),(_0x2f990d,_0x3fcb42)=>{const _0x665fad=_0x1131a9;_0x3fcb42['sendFile'](path[_0x665fad(0x99)](__dirname,bbpath2,_0x665fad(0x28b),'index.html'));}),app[_0x1131a9(0xe8)](_0x1131a9(0xb1),(_0x12ddce,_0x304424)=>{const _0x57cf41=_0x1131a9;_0x304424[_0x57cf41(0xeb)](path[_0x57cf41(0x99)](__dirname,bbpath2,_0x57cf41(0x28b),'index.html'));}),app[_0x1131a9(0xe8)](_0x1131a9(0x25d),(_0x1da60c,_0x66debf)=>{const _0x70a98e=_0x1131a9;_0x66debf[_0x70a98e(0xeb)](path[_0x70a98e(0x99)](__dirname,bbpath2,_0x70a98e(0x28b),_0x70a98e(0x188)));});if(HOST)http[_0x1131a9(0x16f)](PORT,HOST);else http['listen'](PORT);const io=require(_0x1131a9(0x17a))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x3f888f=_0x1131a9;let _0x44b85d=_0x3f888f(0xa3);const _0x29cdfb=networkInterfaces(),_0x49973e={};for(const _0x8b9ea3 of Object[_0x3f888f(0x287)](_0x29cdfb)){for(const _0x6c228 of _0x29cdfb[_0x8b9ea3]){if((_0x6c228[_0x3f888f(0x10c)]==_0x3f888f(0x125)||_0x6c228[_0x3f888f(0x10c)]==0x4)&&!_0x6c228[_0x3f888f(0x119)]){const _0x3e862a=ipaddr['parse'](_0x6c228['address'])[_0x3f888f(0x214)]();_0x3e862a!=_0x3f888f(0x98)&&(!_0x49973e[_0x8b9ea3]&&(_0x49973e[_0x8b9ea3]=[]),_0x49973e[_0x8b9ea3][_0x3f888f(0x265)](_0x6c228[_0x3f888f(0x175)]),_0x44b85d=_0x6c228[_0x3f888f(0x175)]);}}}return{'serverip':_0x44b85d,'netinterfaces':_0x49973e};}async function startServer(){const _0x20dcf9=_0x1131a9,{serverip:_0x1ce25f,netinterfaces:_0x17fe42}=getServerIP();logger[_0x20dcf9(0x262)](''),logger[_0x20dcf9(0x262)](_0x20dcf9(0xe0)),await logger['full'](_0x20dcf9(0x117)+serverversion+_0x20dcf9(0x183)+(environment==_0x20dcf9(0x1f4)?_0x20dcf9(0xcf):'')+'\x0a'+(_0x20dcf9(0x285)+PORT+_0x20dcf9(0x15c))+(_0x20dcf9(0x91)+_0x1ce25f+':'+PORT+_0x20dcf9(0x264))),logger[_0x20dcf9(0x262)]('-----------------------------------------------------------------------------------');if(config[_0x20dcf9(0x1c2)]!=0x0)for(const _0x39f1a8 of config){const _0x14b2b5=_0x39f1a8[_0x20dcf9(0x226)]==_0x20dcf9(0xf3)?'a':'m';if(_0x39f1a8[_0x20dcf9(0x180)]==_0x20dcf9(0x94)||_0x39f1a8[_0x20dcf9(0x180)]=='new')await logger[_0x20dcf9(0xae)](_0x20dcf9(0x1ed)+_0x14b2b5+_0x20dcf9(0x27a)+_0x39f1a8[_0x20dcf9(0x1a0)]+_0x20dcf9(0xdc)+_0x39f1a8[_0x20dcf9(0x1b4)]),startBot([_0x39f1a8[_0x20dcf9(0x1a0)],userID],{'cwd':bbpath},function(_0x4899b9){const _0xe4a9c3=_0x20dcf9;if(_0x4899b9)logger[_0xe4a9c3(0xae)](_0x4899b9);});else(_0x39f1a8[_0x20dcf9(0x180)]==_0x20dcf9(0x258)||_0x39f1a8[_0x20dcf9(0x180)]==_0x20dcf9(0x1d9))&&await logger[_0x20dcf9(0xae)](_0x20dcf9(0x121)+_0x14b2b5+_0x20dcf9(0x101)+_0x39f1a8[_0x20dcf9(0x1a0)]+_0x20dcf9(0xdc)+_0x39f1a8[_0x20dcf9(0x1b4)]);}else!newBot&&logger['simple'](_0x20dcf9(0x246));if(newBot)addBot();logger[_0x20dcf9(0x262)](_0x20dcf9(0xe0)),logger['simple'](''),await logger[_0x20dcf9(0x253)](_0x20dcf9(0x86)+nodeversion),await logger[_0x20dcf9(0x253)]('Network\x20Interfaces:',_0x17fe42);}function startSocket(){const _0x3bcdcc=_0x1131a9;io['on'](_0x3bcdcc(0x21a),_0x1018e7=>{const _0x4cb713=_0x3bcdcc;let _0x2d8dc5,_0x31cb6b,_0x403aaa,_0x376f9e,_0x60c19a;const _0x6c5ec3=_0x1018e7['handshake'][_0x4cb713(0x18a)]['referer'];_0x31cb6b=_0x6c5ec3['match'](/bot[0-9]{3}/);if(_0x31cb6b)_0x403aaa=_0x31cb6b[0x0]['match'](/[0-9]{3}/);if(_0x403aaa)_0x2d8dc5=_0x403aaa[0x0];else _0x2d8dc5=_0x4cb713(0x1dc);const _0x5e0ce4=_0x1018e7['handshake'][_0x4cb713(0x254)][_0x4cb713(0x242)];if(!_0x5e0ce4)_0x1018e7['emit'](_0x4cb713(0x180),{'publicKey':secure[_0x4cb713(0x1dd)]});else{_0x376f9e=timelyDecrypt(_0x5e0ce4,![]);if(!_0x376f9e)_0x1018e7[_0x4cb713(0x1b1)]('status',{'publicKey':secure[_0x4cb713(0x1dd)]});else{_0x60c19a=normalizeIP(_0x1018e7['conn'][_0x4cb713(0x162)])[_0x4cb713(0x14b)];if(!devices[_0x376f9e])devices[_0x376f9e]={'uuid':_0x376f9e,'access':{'token':null}};devices[_0x376f9e]['ip']=_0x60c19a;const _0x28ca99=addClient(_0x1018e7['id'],_0x376f9e,_0x2d8dc5);setAccess(_0x28ca99),emitMessages(),_0x1018e7['on']('login',_0x1b5dcf=>{const _0x414c41=_0x4cb713,_0x191e58=timelyDecrypt(_0x1b5dcf[_0x414c41(0x13c)]);if(_0x191e58){_0x1b5dcf={'username':_0x1b5dcf['username'],'password':_0x191e58},devices[_0x376f9e][_0x414c41(0x140)]=validateCredentials(_0x1b5dcf,_0x376f9e);if(devices[_0x376f9e]['access'][_0x414c41(0x1bd)]==![]&&devices[_0x376f9e][_0x414c41(0x140)][_0x414c41(0x187)]==_0x414c41(0x269))_0x1018e7[_0x414c41(0x1b1)]('status',{'access':devices[_0x376f9e][_0x414c41(0x140)]}),loginAccess2FA(_0x376f9e,_0x60c19a);else{if(devices[_0x376f9e]['access']['allow']==![]&&devices[_0x376f9e][_0x414c41(0x140)]['reason']==_0x414c41(0xbd))_0x1018e7[_0x414c41(0x1b1)](_0x414c41(0x180),{'access':devices[_0x376f9e][_0x414c41(0x140)]});else devices[_0x376f9e][_0x414c41(0x140)][_0x414c41(0x1bd)]&&devices[_0x376f9e]['access'][_0x414c41(0x187)]==_0x414c41(0xe6)&&(getClientsWithUuid(_0x376f9e)[_0x414c41(0x10a)](_0x371ef0=>{setAccess(_0x371ef0);}),logger[_0x414c41(0x253)]('Logged\x20in\x20user\x20...'+_0x376f9e[_0x414c41(0xad)](-0x8)),setTokenRefresh(_0x376f9e),setSessionTimeout(_0x414c41(0x139),_0x376f9e));}}else logger['full'](_0x414c41(0xd8));}),_0x1018e7['on'](_0x4cb713(0x1a8),()=>{resetPassword();}),_0x1018e7['on']('disconnect',_0x4f5a30=>{removeClient(_0x1018e7['id']);}),_0x2d8dc5=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x1ed590){const _0x3f9057=_0x1131a9;if(_0x1ed590!=_0x3f9057(0x1dc)&&config['apiKey']!=''){if(pid[_0x1ed590])pid[_0x1ed590][_0x3f9057(0xcb)]({'function':_0x3f9057(0x142),'args':null});}_0x1ed590!='botmanager'&&broadcastToBots(_0x3f9057(0x141),JSON[_0x3f9057(0x25a)](config));}function reloadBotManager(){const _0x5a973d=_0x1131a9;getClientsWithBotID('botmanager')[_0x5a973d(0x10a)](_0x6aeb9a=>{const _0x423b64=_0x5a973d;getSocket(_0x6aeb9a['id'])['emit']('status',{'access':{'allow':![],'reason':_0x423b64(0x123),'token':null}});});}function getSocket(_0x25f0d3){const _0x5e7ca5=_0x1131a9;return io[_0x5e7ca5(0xa7)][_0x5e7ca5(0xa7)][_0x5e7ca5(0xe8)](_0x25f0d3);}function setAccess(_0x3101e2){const _0x5a6c3f=_0x1131a9,_0x48d560=getSocket(_0x3101e2['id']),_0x10a15b=_0x3101e2[_0x5a6c3f(0x216)],_0x695a46=_0x3101e2['bot'];devices[_0x10a15b]['access']=validateAccess(devices[_0x10a15b][_0x5a6c3f(0x140)]['token'],_0x10a15b),logger[_0x5a6c3f(0x253)](_0x5a6c3f(0x11c)+devices[_0x10a15b]['access'][_0x5a6c3f(0x187)]+_0x5a6c3f(0x87)+_0x3101e2['id'][_0x5a6c3f(0xad)](-0x8)+_0x5a6c3f(0x21f)+_0x10a15b['slice'](-0x8)),_0x48d560['join'](_0x10a15b);if(devices[_0x10a15b][_0x5a6c3f(0x140)]['allow']){_0x48d560['join'](_0x695a46);if(_0x695a46==_0x5a6c3f(0x1dc))initializeSocketBotManager(_0x48d560);else initializeSocketBot(_0x48d560);initClient(_0x695a46);}devices[_0x10a15b][_0x5a6c3f(0x140)][_0x5a6c3f(0x271)]&&devices[_0x10a15b]['access'][_0x5a6c3f(0x187)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x5a6c3f(0xe5),_0x10a15b),devices[_0x10a15b][_0x5a6c3f(0x140)]['token']&&devices[_0x10a15b]['access'][_0x5a6c3f(0x187)]==_0x5a6c3f(0x1ca)&&setSessionTimeout(_0x5a6c3f(0x139),_0x10a15b),_0x48d560[_0x5a6c3f(0x1b1)](_0x5a6c3f(0x180),{'status':_0x3101e2[_0x5a6c3f(0x275)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x10a15b][_0x5a6c3f(0x140)],'externalip':devices[_0x10a15b]['ip'],'publicKey':secure[_0x5a6c3f(0x1dd)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x10a15b][_0x5a6c3f(0x140)][_0x5a6c3f(0x1bd)]==![]&&devices[_0x10a15b][_0x5a6c3f(0x140)][_0x5a6c3f(0x187)]=='2FA\x20required'&&temporaryAccess2FA(_0x10a15b,devices[_0x10a15b]['ip']);}function setSessionTimeout(_0x2c39d2,_0x336fb0){const _0x318f12=_0x1131a9;let _0x2efe7e;if(_0x2c39d2==_0x318f12(0x139))_0x2efe7e=loginExpiry*0x3c*0x3e8;else _0x2efe7e=devices[_0x336fb0][_0x318f12(0x227)][_0x318f12(0x16a)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x336fb0]['telegramIpApproval']['timestamp']);if(devices[_0x336fb0][_0x318f12(0x206)])clearTimeout(devices[_0x336fb0]['pidExpireLogin']);devices[_0x336fb0][_0x318f12(0x206)]=setTimeout(()=>{const _0xe30e27=_0x318f12;if(devices[_0x336fb0]['pidRefreshToken'])clearTimeout(devices[_0x336fb0][_0xe30e27(0xb8)]);removeSocketListeners(_0x336fb0),addBlacklist(_0x336fb0),devices[_0x336fb0]['telegramIpApproval']=null,devices[_0x336fb0][_0xe30e27(0x1ee)]=null,devices[_0x336fb0][_0xe30e27(0x140)][_0xe30e27(0x271)]=null,logger[_0xe30e27(0x253)](_0xe30e27(0x212)+_0x336fb0['slice'](-0x8)),devices[_0x336fb0][_0xe30e27(0x140)]=validateAccess(devices[_0x336fb0][_0xe30e27(0x140)]['token'],_0x336fb0),!(devices[_0x336fb0][_0xe30e27(0x140)][_0xe30e27(0x1bd)]&&devices[_0x336fb0][_0xe30e27(0x140)][_0xe30e27(0x187)]==_0xe30e27(0xbe))&&(_0x2c39d2==_0xe30e27(0x139)?io['to'](_0x336fb0)[_0xe30e27(0x1b1)](_0xe30e27(0x180),{'access':{'allow':![],'reason':_0xe30e27(0x1b8),'token':null}}):io['to'](_0x336fb0)[_0xe30e27(0x1b1)](_0xe30e27(0x180),{'access':{'allow':![],'reason':_0xe30e27(0x15a),'token':null}})),devices[_0x336fb0][_0xe30e27(0x140)][_0xe30e27(0x271)]=null;},_0x2efe7e);}function setTokenRefresh(_0x5d7599){const _0x2c6975=_0x1131a9;if(devices[_0x5d7599][_0x2c6975(0xb8)])clearTimeout(devices[_0x5d7599][_0x2c6975(0xb8)]);devices[_0x5d7599]['pidRefreshToken']=setTimeout(()=>{const _0x2216b1=_0x2c6975;getClientsWithUuid(_0x5d7599)['length']!=0x0?(devices[_0x5d7599]['access']=refreshToken(_0x5d7599),io['to'](_0x5d7599)[_0x2216b1(0x1b1)](_0x2216b1(0x180),{'status':_0x2216b1(0x13d),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5d7599]['access'],'externalip':devices[_0x5d7599]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x5d7599)):clearTimeout(devices[_0x5d7599][_0x2216b1(0xb8)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x34bfbf){const _0x4e0497=_0x1131a9,_0x278ccc=getClient(_0x34bfbf['id'])[_0x4e0497(0x216)];_0x34bfbf[_0x4e0497(0x1b1)]('bots',config),_0x34bfbf[_0x4e0497(0x1b1)](_0x4e0497(0x270),cleanSettings()),_0x34bfbf['on'](_0x4e0497(0x26a),_0x12dc81=>{const _0x593f86=_0x4e0497;if(validateAccess(_0x12dc81,_0x278ccc)[_0x593f86(0x1bd)])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x34bfbf['on'](_0x4e0497(0xef),(_0x6b1e2a,_0x42586d)=>{const _0x10b86e=_0x4e0497;if(validateAccess(_0x42586d,_0x278ccc)[_0x10b86e(0x1bd)])toggleBot(_0x6b1e2a['botID'],_0x6b1e2a[_0x10b86e(0x180)],_0x6b1e2a[_0x10b86e(0x267)]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x34bfbf['on']('toggle-bot-mode',(_0x2c9f2d,_0x18551c)=>{const _0x30e709=_0x4e0497;if(validateAccess(_0x18551c,_0x278ccc)[_0x30e709(0x1bd)])toggleBotMode(_0x2c9f2d);else logger[_0x30e709(0xae)](_0x30e709(0x204));}),_0x34bfbf['on'](_0x4e0497(0x1a4),(_0x963694,_0x47a64e)=>{const _0x3a1498=_0x4e0497;if(validateAccess(_0x47a64e,_0x278ccc)[_0x3a1498(0x1bd)])deleteBot(_0x963694);else logger[_0x3a1498(0xae)](_0x3a1498(0x20a));}),_0x34bfbf['on'](_0x4e0497(0x23f),(_0x59acc1,_0x546244)=>{const _0x2a274c=_0x4e0497;if(validateAccess(_0x546244,_0x278ccc)[_0x2a274c(0x1bd)])storeSettings(_0x59acc1,!![]);else logger[_0x2a274c(0xae)](_0x2a274c(0x1d5));}),_0x34bfbf['on']('update-bb',_0x5b3ad1=>{const _0x1667b0=_0x4e0497;if(validateAccess(_0x5b3ad1,_0x278ccc)[_0x1667b0(0x1bd)])updateBB(_0x1667b0(0x1e7));else logger[_0x1667b0(0xae)](_0x1667b0(0x1d0));}),_0x34bfbf['on'](_0x4e0497(0xbc),_0x380a6a=>{const _0x2958ec=_0x4e0497;if(validateAccess(_0x380a6a,_0x278ccc)[_0x2958ec(0x1bd)])updateBB(_0x2958ec(0x11a));else logger['full'](_0x2958ec(0xf1));}),_0x34bfbf['on'](_0x4e0497(0x9c),_0x2cf99e=>{const _0x3ac4bd=_0x4e0497;if(validateAccess(_0x2cf99e,_0x278ccc)[_0x3ac4bd(0x1bd)]){const _0x35b53a=getClient(_0x34bfbf['id']);if(_0x35b53a)getBackupFiles(_0x35b53a[_0x3ac4bd(0x216)]);else logger[_0x3ac4bd(0xae)](_0x3ac4bd(0x268));}else logger[_0x3ac4bd(0xae)](_0x3ac4bd(0x26c));}),_0x34bfbf['on'](_0x4e0497(0x280),(_0x4d1658,_0x3fb1f0)=>{const _0x435a71=_0x4e0497;if(validateAccess(_0x3fb1f0,_0x278ccc)[_0x435a71(0x1bd)])restoreBackupFile(_0x4d1658);else logger['full'](_0x435a71(0x17d));}),_0x34bfbf['on'](_0x4e0497(0x133),_0x34febe=>{const _0x1cd735=_0x4e0497;if(validateAccess(_0x34febe,_0x278ccc)[_0x1cd735(0x1bd)])getMessages();else logger[_0x1cd735(0xae)](_0x1cd735(0x243));}),_0x34bfbf['on']('confirm-message',(_0x8834a5,_0x3b0244)=>{const _0xc5a796=_0x4e0497;if(validateAccess(_0x3b0244,_0x278ccc)[_0xc5a796(0x1bd)])confirmMessage(_0x8834a5);else logger[_0xc5a796(0xae)](_0xc5a796(0x202));}),_0x34bfbf['on'](_0x4e0497(0x1e0),_0x4be930=>{const _0x42f422=_0x4e0497;if(validateAccess(_0x4be930,_0x278ccc)['allow']){if(devices[_0x278ccc][_0x42f422(0xb8)])clearTimeout(devices[_0x278ccc][_0x42f422(0xb8)]);if(devices[_0x278ccc][_0x42f422(0x206)])clearTimeout(devices[_0x278ccc]['pidExpireLogin']);removeSocketListeners(getClient(_0x34bfbf['id'])[_0x42f422(0x216)]),addBlacklist(_0x278ccc),devices[_0x278ccc][_0x42f422(0x227)]=null,devices[_0x278ccc][_0x42f422(0x1ee)]=null,devices[_0x278ccc][_0x42f422(0x140)][_0x42f422(0x271)]=null,logger[_0x42f422(0x253)](_0x42f422(0xdd)+_0x278ccc[_0x42f422(0xad)](-0x8)),io['to'](getClient(_0x34bfbf['id'])[_0x42f422(0x216)])[_0x42f422(0x1b1)](_0x42f422(0x180),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x42f422(0xae)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x27d257){const _0x3ceead=_0x1131a9,_0x50bb3a=getClient(_0x27d257['id'])['bot'],_0x5ebf00=getClient(_0x27d257['id'])[_0x3ceead(0x216)];_0x27d257['on']('get-logs',(_0x1e2928,_0x599978)=>{const _0x941342=_0x3ceead;if(validateAccess(_0x599978,_0x5ebf00)[_0x941342(0x1bd)]){if(pid[_0x50bb3a])pid[_0x50bb3a][_0x941342(0xcb)]({'function':'emitHistory','args':_0x1e2928});}else logger[_0x941342(0xae)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x27d257['on']('delete-alerts',(_0xc200cc,_0x2bf596)=>{const _0x400604=_0x3ceead;if(validateAccess(_0x2bf596,_0x5ebf00)[_0x400604(0x1bd)]){if(pid[_0x50bb3a])pid[_0x50bb3a][_0x400604(0xcb)]({'function':_0x400604(0x229),'args':_0xc200cc});}else logger[_0x400604(0xae)](_0x400604(0x14f));}),_0x27d257['on'](_0x3ceead(0x23d),(_0x4a6758,_0xd5baf0)=>{const _0xe4724d=_0x3ceead;if(validateAccess(_0xd5baf0,_0x5ebf00)[_0xe4724d(0x1bd)]){if(pid[_0x50bb3a])pid[_0x50bb3a][_0xe4724d(0xcb)]({'function':'getPortfolio','args':_0x4a6758});}else logger[_0xe4724d(0xae)](_0xe4724d(0x95));}),_0x27d257['on'](_0x3ceead(0x195),(_0x48f703,_0x4d4adf)=>{const _0x5d3928=_0x3ceead;if(validateAccess(_0x4d4adf,_0x5ebf00)[_0x5d3928(0x1bd)]){if(pid[_0x50bb3a])pid[_0x50bb3a][_0x5d3928(0xcb)]({'function':_0x5d3928(0x1f0),'args':_0x48f703});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x27d257['on']('store-headless',(_0x5baa9a,_0x207c7c)=>{const _0x506587=_0x3ceead;if(validateAccess(_0x207c7c,_0x5ebf00)[_0x506587(0x1bd)]){if(pid[_0x50bb3a])pid[_0x50bb3a]['send']({'function':_0x506587(0x1d2),'args':_0x5baa9a});}else logger[_0x506587(0xae)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x27d257['on'](_0x3ceead(0x128),(_0x23bcfe,_0x2dfa7c)=>{const _0x3a592b=_0x3ceead;if(validateAccess(_0x2dfa7c,_0x5ebf00)[_0x3a592b(0x1bd)]){if(pid[_0x50bb3a])pid[_0x50bb3a][_0x3a592b(0xcb)]({'function':_0x3a592b(0x282),'args':_0x23bcfe});}else logger[_0x3a592b(0xae)](_0x3a592b(0x272));}),_0x27d257['on'](_0x3ceead(0x25e),_0x14cb74=>{const _0x1b3e54=_0x3ceead;if(validateAccess(_0x14cb74,_0x5ebf00)[_0x1b3e54(0x1bd)]){if(pid[_0x50bb3a])pid[_0x50bb3a]['send']({'function':_0x1b3e54(0xe1),'args':null});}else logger[_0x1b3e54(0xae)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x27d257['on'](_0x3ceead(0x244),_0x2f0e6a=>{const _0x33cb43=_0x3ceead;if(validateAccess(_0x2f0e6a,_0x5ebf00)[_0x33cb43(0x1bd)]){if(pid[_0x50bb3a])pid[_0x50bb3a]['send']({'function':_0x33cb43(0x1cc),'args':null});}else logger[_0x33cb43(0xae)](_0x33cb43(0x1d1));}),_0x27d257['on'](_0x3ceead(0xe9),(_0xdae29b,_0x18d359)=>{const _0x14c1ef=_0x3ceead;if(validateAccess(_0x18d359,_0x5ebf00)[_0x14c1ef(0x1bd)]){if(pid[_0x50bb3a])pid[_0x50bb3a][_0x14c1ef(0xcb)]({'function':'placeOrder','args':_0xdae29b});}else logger[_0x14c1ef(0xae)](_0x14c1ef(0x259));}),_0x27d257['on'](_0x3ceead(0x1cd),_0x2684b6=>{const _0x30d920=_0x3ceead;if(validateAccess(_0x2684b6,_0x5ebf00)[_0x30d920(0x1bd)]){if(pid[_0x50bb3a])pid[_0x50bb3a][_0x30d920(0xcb)]({'function':_0x30d920(0x11d),'args':null});}else logger[_0x30d920(0xae)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x27d257['on'](_0x3ceead(0x27f),_0x700fb1=>{const _0x16d8b7=_0x3ceead;if(validateAccess(_0x700fb1,_0x5ebf00)['allow']){if(pid[_0x50bb3a])pid[_0x50bb3a][_0x16d8b7(0xcb)]({'function':_0x16d8b7(0x18e),'args':null});}else logger[_0x16d8b7(0xae)](_0x16d8b7(0x1a3));}),_0x27d257['on']('update-bb',_0x1e9020=>{const _0x3fe917=_0x3ceead;if(validateAccess(_0x1e9020,_0x5ebf00)[_0x3fe917(0x1bd)])updateBB('update');else logger[_0x3fe917(0xae)](_0x3fe917(0x1d0));}),_0x27d257['on']('get-messages',_0xa8e293=>{const _0x3cef55=_0x3ceead;if(validateAccess(_0xa8e293,_0x5ebf00)[_0x3cef55(0x1bd)])getMessages();else logger[_0x3cef55(0xae)](_0x3cef55(0x243));}),_0x27d257['on'](_0x3ceead(0x1af),(_0x5a6049,_0x5ead7c)=>{const _0x335d5f=_0x3ceead;if(validateAccess(_0x5ead7c,_0x5ebf00)['allow'])confirmMessage(_0x5a6049);else logger['full'](_0x335d5f(0x202));}),_0x27d257['on'](_0x3ceead(0x1e0),_0x828316=>{const _0x3ef42b=_0x3ceead;if(validateAccess(_0x828316,_0x5ebf00)['allow']){if(devices[_0x5ebf00][_0x3ef42b(0xb8)])clearTimeout(devices[_0x5ebf00]['pidRefreshToken']);if(devices[_0x5ebf00][_0x3ef42b(0x206)])clearTimeout(devices[_0x5ebf00][_0x3ef42b(0x206)]);removeSocketListeners(getClient(_0x27d257['id'])[_0x3ef42b(0x216)]),addBlacklist(_0x5ebf00),devices[_0x5ebf00][_0x3ef42b(0x227)]=null,devices[_0x5ebf00][_0x3ef42b(0x1ee)]=null,devices[_0x5ebf00][_0x3ef42b(0x140)][_0x3ef42b(0x271)]=null,logger['debug'](_0x3ef42b(0xdd)+_0x5ebf00[_0x3ef42b(0xad)](-0x8)),io['to'](getClient(_0x27d257['id'])[_0x3ef42b(0x216)])[_0x3ef42b(0x1b1)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x3ef42b(0xae)](_0x3ef42b(0x136));});}function removeSocketListeners(_0xfe56ae){const _0x4d80eb=_0x1131a9;getClientsWithUuid(_0xfe56ae)[_0x4d80eb(0x10a)](_0x5f2fb8=>{getSocket(_0x5f2fb8['id'])['removeAllListeners']();});}function cleanSettings(){const _0x35c185=_0x1131a9;let _0x5466d6=settings;return settings[_0x35c185(0x249)]&&settings[_0x35c185(0x249)]!=''&&(_0x5466d6={..._0x5466d6,'telegramToken':_0x35c185(0x23e)}),settings[_0x35c185(0x144)]&&settings[_0x35c185(0x144)]!=''&&(_0x5466d6={..._0x5466d6,'bbPassword':'************'}),(settings[_0x35c185(0x144)]&&settings[_0x35c185(0x144)]==_0x35c185(0x12a)||settings[_0x35c185(0x249)]&&settings['telegramToken']==_0x35c185(0x12a))&&(_0x5466d6={..._0x5466d6,'restored':{'password':settings[_0x35c185(0x144)]==_0x35c185(0x12a),'telegram':settings[_0x35c185(0x249)]=='***'}}),_0x5466d6;}async function updateBB(_0x5bcce5){const _0x190356=_0x1131a9;await backupConfigFiles(),installingUpdate=!![],config[_0x190356(0x10a)](_0xcab1db=>{const _0x2d4fe7=_0x190356;restartBot(_0xcab1db[_0x2d4fe7(0x1a0)]);});if(_0x5bcce5=='update')process['send']({'update':!![],'environment':environment},_0x120a33=>{});else _0x5bcce5==_0x190356(0x11a)&&process[_0x190356(0xcb)]({'reinstall':!![],'environment':environment},_0x3ab99e=>{});}function startBot(_0x47911c,_0x4b6aad,_0x3622bc){const _0x339be7=_0x1131a9;if(debugging)_0x47911c[_0x339be7(0x265)]('-d');let _0x3111f7=![];const _0x4eb5bf=_0x47911c[0x0];_0x4b6aad={..._0x4b6aad,'stdio':[_0x339be7(0x1b7),_0x339be7(0x1b7),_0x339be7(0x1b7),'ipc']},pid[_0x4eb5bf]=childProcess['fork'](botfile,_0x47911c,_0x4b6aad),pid[_0x4eb5bf]['on'](_0x339be7(0x1f1),_0x2c7219=>{const _0x1c0bd9=_0x339be7;switch(Object[_0x1c0bd9(0x287)](_0x2c7219)[0x0]){case _0x1c0bd9(0x1b4):updateBotName(_0x4eb5bf,_0x2c7219[_0x1c0bd9(0x1b4)]);break;case'updatebotmanager':updateBotManager();break;case'status':updateStatus(_0x4eb5bf,_0x2c7219[_0x1c0bd9(0x180)]);break;case _0x1c0bd9(0x267):updateLive(_0x4eb5bf,_0x2c7219['live']);break;case _0x1c0bd9(0x219):updateLive(_0x4eb5bf,_0x2c7219['started']),io['to'](_0x4eb5bf)['emit']('status',{'access':{'allow':![],'reason':_0x1c0bd9(0x123),'token':null}});break;case _0x1c0bd9(0xf2):_0x2c7219[_0x1c0bd9(0xf2)]==_0x1c0bd9(0x1fd)&&restartBot(_0x4eb5bf);_0x2c7219[_0x1c0bd9(0xf2)]==_0x1c0bd9(0x1b5)&&toggleBot(_0x4eb5bf,'disabled',_0x1c0bd9(0x221));break;case _0x1c0bd9(0x28d):sendTelegramBot(_0x4eb5bf,_0x2c7219[_0x1c0bd9(0x28d)]);break;case _0x1c0bd9(0x1e8):sendTelegramMsg(_0x2c7219[_0x1c0bd9(0x1e8)]);break;case _0x1c0bd9(0x1c5):io['to'](_0x4eb5bf)['emit'](_0x2c7219['function'],_0x2c7219['args']);break;}}),pid[_0x4eb5bf]['on'](_0x339be7(0x158),function(_0x1c0d13){if(_0x3111f7)return;_0x3111f7=!![],_0x3622bc(_0x1c0d13);}),pid[_0x4eb5bf]['on'](_0x339be7(0x1d6),async function(_0x4ad70c){const _0x1566a8=_0x339be7;if(terminating)return;if(installingUpdate){logger[_0x1566a8(0x253)](_0x1566a8(0x20e)),io[_0x1566a8(0x111)]();return;}if(_0x3111f7)return;_0x3111f7=!![],_0x3622bc(null);const _0xac58a6=dbConfig[_0x1566a8(0xe8)](_0x1566a8(0x141))[_0x1566a8(0x8e)]({'botID':_0x4eb5bf})[_0x1566a8(0x1f8)]();_0xac58a6&&(_0xac58a6[_0x1566a8(0x180)]=='enabled'||_0xac58a6['status']==_0x1566a8(0x12e))&&(await sleep(0x3e8),updateLive(_0x4eb5bf,_0x1566a8(0x221)),logger['full'](_0x1566a8(0x205)+_0x4eb5bf),startBot([_0x4eb5bf,userID],{'cwd':bbpath},function(_0xe7c5c1){const _0x507a5a=_0x1566a8;if(_0xe7c5c1)logger[_0x507a5a(0xae)](_0xe7c5c1);}));});}function stopBot(_0xbfae29){const _0x23a21d=_0x1131a9;getClientsWithBotID(_0xbfae29)[_0x23a21d(0x10a)](_0x5a62e0=>{const _0x568a9a=_0x23a21d;getSocket(_0x5a62e0['id'])[_0x568a9a(0x108)](!![]),removeClient(_0x5a62e0['id']);}),pid[_0xbfae29]&&(pid[_0xbfae29]['kill'](),pid[_0xbfae29]=null);}function stopAllBots(){const _0x3c0ed6=_0x1131a9;terminating=!![];const _0x33b961=getEnabledBots();_0x33b961[_0x3c0ed6(0x10a)](_0x16a4a5=>{const _0x30e299=_0x3c0ed6;stopBot(_0x16a4a5[_0x30e299(0x1a0)]);});}function restartBot(_0x417b0b){const _0x32838c=_0x1131a9;if(pid[_0x417b0b])pid[_0x417b0b][_0x32838c(0x1b5)]();}function addBot(){const _0x1b2743=_0x1131a9;let _0x396ed9;for(let _0x32f673=0x1;_0x32f673<0x3e9;_0x32f673++){_0x396ed9=_0x32f673[_0x1b2743(0x1d4)]()['padStart'](0x3,'0');let _0x579fc6=config[_0x1b2743(0x8e)](_0xb2bce6=>_0xb2bce6[_0x1b2743(0x1a0)]==_0x396ed9);if(!_0x579fc6)break;}if(_0x396ed9==='1000'){logger['full'](_0x1b2743(0xc2));return;}logger[_0x1b2743(0xae)](_0x1b2743(0x8a)+_0x396ed9),dbConfig[_0x1b2743(0xe8)](_0x1b2743(0x141))['push']({'botID':_0x396ed9,'botname':_0x1b2743(0x1d7)+_0x396ed9,'status':_0x1b2743(0x12e),'live':''})[_0x1b2743(0x1a9)](),startBot([_0x396ed9,userID],{'cwd':bbpath},function(_0x47d8e8){const _0xad9ed7=_0x1b2743;if(_0x47d8e8)logger[_0xad9ed7(0xae)](_0x47d8e8);}),config=getConfiguration(),io['to'](_0x1b2743(0x1dc))[_0x1b2743(0x1b1)](_0x1b2743(0x141),config),broadcastToBots(_0x1b2743(0x141),JSON[_0x1b2743(0x25a)](config));}function deleteBot(_0x4a1c94){const _0x523ad8=_0x1131a9;getClientsWithBotID(_0x4a1c94)[_0x523ad8(0x10a)](_0x5da606=>{const _0x3458af=_0x523ad8;getSocket(_0x5da606['id'])[_0x3458af(0x108)](!![]),removeClient(_0x5da606['id']);}),dbConfig['get']('bots')[_0x523ad8(0x27c)]({'botID':_0x4a1c94})[_0x523ad8(0x1a9)](),logger[_0x523ad8(0xae)](_0x523ad8(0x215)+_0x4a1c94),stopBot(_0x4a1c94);try{if(fs[_0x523ad8(0x286)](path[_0x523ad8(0x99)](configpath,'bot-'+_0x4a1c94+_0x523ad8(0x1a1))))fs[_0x523ad8(0x153)](path[_0x523ad8(0x99)](configpath,'bot-'+_0x4a1c94+_0x523ad8(0x1a1)));if(fs['existsSync'](path['join'](configpath,_0x523ad8(0x24e)+_0x4a1c94+_0x523ad8(0xa2))))fs[_0x523ad8(0x153)](path[_0x523ad8(0x99)](configpath,'bot-'+_0x4a1c94+_0x523ad8(0xa2)));if(fs['existsSync'](path[_0x523ad8(0x99)](configpath,'bot-'+_0x4a1c94+_0x523ad8(0x28a))))fs['unlinkSync'](path[_0x523ad8(0x99)](configpath,_0x523ad8(0x24e)+_0x4a1c94+_0x523ad8(0x28a)));if(fs[_0x523ad8(0x286)](path[_0x523ad8(0x99)](configpath,_0x523ad8(0x24e)+_0x4a1c94+'-results.json')))fs[_0x523ad8(0x153)](path['join'](configpath,'bot-'+_0x4a1c94+_0x523ad8(0x114)));}catch(_0x329a35){if(_0x329a35)logger[_0x523ad8(0xae)](_0x523ad8(0x1e2),_0x329a35);}config=getConfiguration(),io['to'](_0x523ad8(0x1dc))[_0x523ad8(0x1b1)](_0x523ad8(0x141),config),broadcastToBots(_0x523ad8(0x141),JSON[_0x523ad8(0x25a)](config));}function toggleBot(_0x13c72e,_0x562fe6,_0x1fc3d8){const _0x267218=_0x1131a9;dbConfig[_0x267218(0xe8)](_0x267218(0x141))['find']({'botID':_0x13c72e})[_0x267218(0x1e5)]({'status':_0x562fe6})[_0x267218(0x1e5)]({'live':_0x1fc3d8})[_0x267218(0x1a9)]();if(_0x562fe6==_0x267218(0x94)||_0x562fe6=='new')logger['full'](_0x267218(0x106)+_0x13c72e),startBot([_0x13c72e,userID],{'cwd':bbpath},function(_0x473d7c){const _0x2872e4=_0x267218;if(_0x473d7c)logger[_0x2872e4(0xae)](_0x473d7c);});else(_0x562fe6==_0x267218(0x258)||_0x562fe6==_0x267218(0x1d9))&&(logger[_0x267218(0xae)](_0x267218(0x167)+_0x13c72e),stopBot(_0x13c72e));config=getConfiguration(),io['to'](_0x267218(0x1dc))[_0x267218(0x1b1)](_0x267218(0x141),config),broadcastToBots(_0x267218(0x141),JSON[_0x267218(0x25a)](config));}function toggleStatus(_0x31e9f0){const _0x1b67b6=_0x1131a9;let _0x597296=dbConfig[_0x1b67b6(0xe8)]('bots')['find']({'botID':_0x31e9f0})[_0x1b67b6(0x1f8)](),_0x356ec8;if(_0x597296[_0x1b67b6(0x180)]===_0x1b67b6(0x94))_0x356ec8=_0x1b67b6(0x258);else{if(_0x597296['status']==='new')_0x356ec8=_0x1b67b6(0x1d9);else{if(_0x597296[_0x1b67b6(0x180)]===_0x1b67b6(0x1d9))_0x356ec8=_0x1b67b6(0x12e);else{if(_0x597296[_0x1b67b6(0x180)]===_0x1b67b6(0x258))_0x356ec8=_0x1b67b6(0x94);}}}return _0x356ec8;}function updateStatus(_0x6a030,_0x2ec2bd){const _0x3704d2=_0x1131a9;dbConfig[_0x3704d2(0xe8)](_0x3704d2(0x141))[_0x3704d2(0x8e)]({'botID':_0x6a030})[_0x3704d2(0x1e5)]({'status':_0x2ec2bd})[_0x3704d2(0x1a9)](),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots(_0x3704d2(0x141),JSON[_0x3704d2(0x25a)](config));}function updateLive(_0x7924f5,_0x4fb864){const _0x3c7eeb=_0x1131a9;dbConfig[_0x3c7eeb(0xe8)](_0x3c7eeb(0x141))['find']({'botID':_0x7924f5})[_0x3c7eeb(0x1e5)]({'live':_0x4fb864})[_0x3c7eeb(0x1a9)](),config=getConfiguration(),io['to'](_0x3c7eeb(0x1dc))['emit'](_0x3c7eeb(0x141),config),broadcastToBots(_0x3c7eeb(0x141),JSON['stringify'](config));}function updateBotName(_0x2e2fa7,_0x3ae413){const _0x52be02=_0x1131a9;dbConfig[_0x52be02(0xe8)](_0x52be02(0x141))[_0x52be02(0x8e)]({'botID':_0x2e2fa7})[_0x52be02(0x1e5)]({'botname':_0x3ae413})[_0x52be02(0x1a9)](),config=getConfiguration(),io['to'](_0x52be02(0x1dc))['emit'](_0x52be02(0x141),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0x54f59d=_0x1131a9;config=getConfiguration(),io['to'](_0x54f59d(0x1dc))[_0x54f59d(0x1b1)](_0x54f59d(0x141),config),broadcastToBots(_0x54f59d(0x141),JSON[_0x54f59d(0x25a)](config));}function toggleBotMode(_0x59e7b1){const _0xaafd70=_0x1131a9;if(pid[_0x59e7b1])pid[_0x59e7b1][_0xaafd70(0xcb)]({'function':_0xaafd70(0x152),'args':null});else{const _0x45a642=configpath+_0xaafd70(0x24e)+_0x59e7b1+_0xaafd70(0x1a1),_0x5f46ff=fs[_0xaafd70(0x25b)](_0x45a642),_0x243c6f=JSON['parse'](_0x5f46ff),_0x1306ce=_0x243c6f[_0xaafd70(0x1e9)][0x0][_0xaafd70(0x17e)];_0x243c6f[_0xaafd70(0x1e9)][0x0][_0xaafd70(0x17e)]=!_0x1306ce;const _0x155d7e=JSON[_0xaafd70(0x25a)](_0x243c6f,null,0x2);fs[_0xaafd70(0x197)](_0x45a642,_0x155d7e),config=getConfiguration(),io['to'](_0xaafd70(0x1dc))[_0xaafd70(0x1b1)](_0xaafd70(0x141),config),broadcastToBots('bots',JSON[_0xaafd70(0x25a)](config));}}function validateTelegram(_0x6fd494){const _0x14993a=_0x1131a9;if(_0x6fd494[_0x14993a(0x137)][_0x14993a(0xf8)]!=settings['telegramUsername']&&'@'+_0x6fd494[_0x14993a(0x137)][_0x14993a(0xf8)]!=settings[_0x14993a(0x9f)]||_0x6fd494[_0x14993a(0x247)]['id']!=settings['telegramChatId'])return sendTelegram(_0x6fd494[_0x14993a(0x247)]['id'],_0x14993a(0x1c8),{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0x43efcc=_0x1131a9;if(tgBot)tgBot[_0x43efcc(0xf2)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x43efcc(0x249)]);let _0x52da97=_0x43efcc(0x97);_0x52da97+='\x0a',_0x52da97+=_0x43efcc(0x155),_0x52da97+=_0x43efcc(0x191),_0x52da97+=_0x43efcc(0x15b),_0x52da97+=_0x43efcc(0x1ad),_0x52da97+=_0x43efcc(0x198),_0x52da97+='/off\x20-\x20stop\x20bot(s)\x0a',_0x52da97+=_0x43efcc(0x1f2),_0x52da97+='/names\x20-\x20show\x20bot\x20names\x0a',_0x52da97+=_0x43efcc(0x8c),_0x52da97+=_0x43efcc(0x17c),_0x52da97+=_0x43efcc(0x170),_0x52da97+=_0x43efcc(0xb5),_0x52da97+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x52da97+=_0x43efcc(0x1fc);let _0x1880f8=_0x43efcc(0x182);_0x1880f8+='\x0a',_0x1880f8+=_0x52da97,tgBot[_0x43efcc(0x22c)]((_0x530152,_0x4c156e)=>{const _0x33e207=_0x43efcc;logger[_0x33e207(0x262)](getTimeStamp()+_0x33e207(0x1b6)),logger['debug']('Telegraf\x20error:',_0x530152);}),tgBot['use'](async(_0x2a12a1,_0x38e5b6)=>{const _0x57713d=_0x43efcc;if(!(!settings[_0x57713d(0x240)]&&_0x2a12a1[_0x57713d(0x1e7)][_0x57713d(0x1f1)][_0x57713d(0x263)]==_0x57713d(0x224))){if(!validateTelegram(_0x2a12a1))return;}_0x38e5b6();}),tgBot[_0x43efcc(0x23a)]('start',async _0x476d12=>{const _0x4f7055=_0x43efcc;if(!settings['telegramChatId'])updateSetting(_0x4f7055(0x240),_0x476d12[_0x4f7055(0x247)]['id']);updateSetting(_0x4f7055(0xb2),!![]);if(!validateTelegram(_0x476d12))return;await sendTelegram(_0x476d12[_0x4f7055(0x247)]['id'],_0x1880f8);}),tgBot[_0x43efcc(0x23a)](_0x43efcc(0x9e),async _0xe9cdb0=>{const _0x4c453e=_0x43efcc;updateSetting(_0x4c453e(0xb2),!![]),await sendTelegram(_0xe9cdb0[_0x4c453e(0x247)]['id'],_0x4c453e(0x84));}),tgBot[_0x43efcc(0x23a)](_0x43efcc(0x209),async _0x4cb83a=>{const _0x312e0f=_0x43efcc;await sendTelegram(_0x4cb83a[_0x312e0f(0x247)]['id'],_0x312e0f(0x1f7)),updateSetting(_0x312e0f(0xb2),![]);}),tgBot[_0x43efcc(0x23a)](_0x43efcc(0xd0),async _0x5d7c92=>{const _0x2640d7=_0x43efcc,_0x508099=Markup[_0x2640d7(0xc1)]([Markup[_0x2640d7(0x22a)][_0x2640d7(0x163)](_0x2640d7(0x24c),'config_orders'),Markup[_0x2640d7(0x22a)]['callback']('Alerts','config_alerts'),Markup[_0x2640d7(0x22a)][_0x2640d7(0x163)](_0x2640d7(0x1cb),'config_all')]);_0x5d7c92['reply'](_0x2640d7(0x1bb),_0x508099);}),tgBot[_0x43efcc(0x1ce)]('config_orders',async _0x43d53d=>{const _0x393667=_0x43efcc;_0x43d53d[_0x393667(0xcd)](),updateSetting(_0x393667(0xdb),'orders'),updateSetting(_0x393667(0xb2),!![]),await sendTelegram(_0x43d53d['chat']['id'],_0x393667(0x19d));}),tgBot[_0x43efcc(0x1ce)](_0x43efcc(0x238),async _0x20f7c3=>{const _0x3bc532=_0x43efcc;_0x20f7c3['editMessageReplyMarkup'](),updateSetting(_0x3bc532(0xdb),'alerts'),updateSetting(_0x3bc532(0xb2),!![]),await sendTelegram(_0x20f7c3[_0x3bc532(0x247)]['id'],_0x3bc532(0x89));}),tgBot[_0x43efcc(0x1ce)](_0x43efcc(0x113),async _0x2f614f=>{const _0x23be4b=_0x43efcc;_0x2f614f[_0x23be4b(0xcd)](),updateSetting(_0x23be4b(0xdb),'all'),updateSetting(_0x23be4b(0xb2),!![]),await sendTelegram(_0x2f614f['chat']['id'],_0x23be4b(0xe2));}),tgBot[_0x43efcc(0x23a)](_0x43efcc(0x180),async _0x2a2f77=>{const _0x41f70d=_0x43efcc,_0x379a7f=getBotsWithMode();let _0x32eb75=_0x41f70d(0xf6);config[_0x41f70d(0x10a)](_0x374d87=>{const _0x3f54c6=_0x41f70d,_0x1432ec=_0x379a7f[_0x3f54c6(0x8e)](_0x76d593=>_0x76d593[_0x3f54c6(0x1a0)]==_0x374d87[_0x3f54c6(0x1a0)])[_0x3f54c6(0x226)];_0x32eb75+=_0x3f54c6(0x1d7)+_0x374d87[_0x3f54c6(0x1a0)]+':\x20'+_0x374d87['status']+_0x3f54c6(0xdc)+_0x1432ec+_0x3f54c6(0xdc)+_0x374d87[_0x3f54c6(0x267)]+'\x0a';}),_0x32eb75+='\x0a',_0x32eb75+=_0x41f70d(0x1c6),_0x32eb75+=!settings[_0x41f70d(0xb2)]?'Notifications\x20disabled\x0a':_0x41f70d(0x26b),_0x32eb75+=settings['telegramEnabled']?settings[_0x41f70d(0xdb)]==_0x41f70d(0x138)?_0x41f70d(0x289):_0x41f70d(0x1eb)+settings[_0x41f70d(0xdb)]+_0x41f70d(0xf4):'',await sendTelegram(_0x2a2f77['chat']['id'],_0x32eb75,{'parse_mode':'HTML'});}),tgBot[_0x43efcc(0x23a)](_0x43efcc(0x1fd),async _0x4c0377=>{const _0x4690b7=_0x43efcc,_0x23daa6=getEnabledBots();if(_0x23daa6[_0x4690b7(0x1c2)]==0x0)await sendTelegram(_0x4c0377['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x23daa6['length']>0x1)_0x23daa6[_0x4690b7(0x265)]({'botID':_0x4690b7(0x138)});let _0x105011=[],_0x6fbc15=[];const _0x91c846=_0x23daa6[_0x4690b7(0x1c2)]%0x4==0x0||_0x23daa6[_0x4690b7(0x1c2)]%0x4==0x3||_0x23daa6['length']%0x3==0x1?0x4:0x3;let _0x127b2d=0x0;_0x23daa6[_0x4690b7(0x10a)]((_0x203a12,_0x41ea64)=>{const _0x3ac419=_0x4690b7;if(_0x41ea64%_0x91c846==0x0)_0x6fbc15=[];_0x6fbc15[_0x3ac419(0x265)](Markup[_0x3ac419(0x22a)][_0x3ac419(0x163)](_0x203a12[_0x3ac419(0x1a0)]=='all'?_0x3ac419(0xbb):_0x3ac419(0x1d7)+_0x203a12[_0x3ac419(0x1a0)],_0x3ac419(0x1c4)+_0x203a12[_0x3ac419(0x1a0)])),_0x41ea64%_0x91c846==0x0&&(_0x105011[_0x127b2d]=_0x6fbc15,_0x127b2d++);});const _0x229735=Markup['inlineKeyboard'](_0x105011);_0x4c0377['reply'](_0x4690b7(0x151),_0x229735);}}),tgBot[_0x43efcc(0x1ce)](/restart_(.+)/,async _0x1f2ddc=>{const _0x5c03c2=_0x43efcc,_0x5a5a3d=_0x1f2ddc[_0x5c03c2(0x1e6)][0x1];_0x1f2ddc[_0x5c03c2(0xcd)](),_0x5a5a3d=='all'?config[_0x5c03c2(0x10a)](_0x465e09=>{const _0x584394=_0x5c03c2;restartBot(_0x465e09[_0x584394(0x1a0)]);}):restartBot(_0x5a5a3d);}),tgBot[_0x43efcc(0x23a)]('on',async _0x5d2d62=>{const _0x48a507=_0x43efcc,_0x9f3a27=getDisabledBots();if(_0x9f3a27[_0x48a507(0x1c2)]==0x0)await sendTelegram(_0x5d2d62[_0x48a507(0x247)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x9f3a27[_0x48a507(0x1c2)]>0x1)_0x9f3a27['push']({'botID':_0x48a507(0x138)});let _0x302ae2=[],_0x9d322e=[];const _0xa3fb7d=_0x9f3a27[_0x48a507(0x1c2)]%0x4==0x0||_0x9f3a27[_0x48a507(0x1c2)]%0x4==0x3||_0x9f3a27['length']%0x3==0x1?0x4:0x3;let _0x5a0f32=0x0;_0x9f3a27[_0x48a507(0x10a)]((_0x164202,_0x3b6eab)=>{const _0x2453e5=_0x48a507;if(_0x3b6eab%_0xa3fb7d==0x0)_0x9d322e=[];_0x9d322e['push'](Markup[_0x2453e5(0x22a)][_0x2453e5(0x163)](_0x164202[_0x2453e5(0x1a0)]==_0x2453e5(0x138)?_0x2453e5(0xbb):_0x2453e5(0x1d7)+_0x164202[_0x2453e5(0x1a0)],_0x2453e5(0x200)+_0x164202[_0x2453e5(0x1a0)])),_0x3b6eab%_0xa3fb7d==0x0&&(_0x302ae2[_0x5a0f32]=_0x9d322e,_0x5a0f32++);});const _0xdd2dcb=Markup[_0x48a507(0xc1)](_0x302ae2);_0x5d2d62['reply'](_0x48a507(0x28c),_0xdd2dcb);}}),tgBot[_0x43efcc(0x1ce)](/on_(.+)/,async _0x558d25=>{const _0x59c430=_0x43efcc,_0x28a5dd=_0x558d25[_0x59c430(0x1e6)][0x1];_0x558d25['editMessageReplyMarkup']();if(_0x28a5dd==_0x59c430(0x138)){const _0x48804a=getDisabledBots();await sendTelegram(_0x558d25[_0x59c430(0x247)]['id'],_0x59c430(0x11f)),_0x48804a[_0x59c430(0x10a)](_0x545e18=>{const _0x44f00d=_0x59c430;if(_0x545e18[_0x44f00d(0x1a0)]!=_0x44f00d(0x138))toggleBot(_0x545e18['botID'],toggleStatus(_0x545e18['botID']),_0x44f00d(0x221));});}else await sendTelegram(_0x558d25[_0x59c430(0x247)]['id'],_0x59c430(0x273)+_0x28a5dd),toggleBot(_0x28a5dd,toggleStatus(_0x28a5dd),_0x59c430(0x221));}),tgBot[_0x43efcc(0x23a)](_0x43efcc(0x241),async _0x66b50d=>{const _0x43d6ff=_0x43efcc,_0x3c8e39=getEnabledBots();if(_0x3c8e39[_0x43d6ff(0x1c2)]==0x0)await sendTelegram(_0x66b50d[_0x43d6ff(0x247)]['id'],_0x43d6ff(0x126));else{if(_0x3c8e39[_0x43d6ff(0x1c2)]>0x1)_0x3c8e39['push']({'botID':'all'});let _0x1f232d=[],_0x123c68=[];const _0x4b504d=_0x3c8e39[_0x43d6ff(0x1c2)]%0x4==0x0||_0x3c8e39[_0x43d6ff(0x1c2)]%0x4==0x3||_0x3c8e39[_0x43d6ff(0x1c2)]%0x3==0x1?0x4:0x3;let _0x105edd=0x0;_0x3c8e39[_0x43d6ff(0x10a)]((_0x35c227,_0x31c025)=>{const _0x58f933=_0x43d6ff;if(_0x31c025%_0x4b504d==0x0)_0x123c68=[];_0x123c68[_0x58f933(0x265)](Markup[_0x58f933(0x22a)][_0x58f933(0x163)](_0x35c227[_0x58f933(0x1a0)]==_0x58f933(0x138)?_0x58f933(0xbb):'Bot\x20'+_0x35c227['botID'],_0x58f933(0x104)+_0x35c227[_0x58f933(0x1a0)])),_0x31c025%_0x4b504d==0x0&&(_0x1f232d[_0x105edd]=_0x123c68,_0x105edd++);});const _0x285f5a=Markup[_0x43d6ff(0xc1)](_0x1f232d);_0x66b50d[_0x43d6ff(0x1fa)](_0x43d6ff(0x186),_0x285f5a);}}),tgBot['action'](/off_(.+)/,async _0x118355=>{const _0x58ea40=_0x43efcc,_0x343427=_0x118355[_0x58ea40(0x1e6)][0x1];_0x118355[_0x58ea40(0xcd)]();if(_0x343427=='all'){const _0x5ae2be=getEnabledBots();await sendTelegram(_0x118355[_0x58ea40(0x247)]['id'],_0x58ea40(0x103)),_0x5ae2be[_0x58ea40(0x10a)](_0x153ec7=>{const _0xa65bb4=_0x58ea40;if(_0x153ec7[_0xa65bb4(0x1a0)]!='all')toggleBot(_0x153ec7[_0xa65bb4(0x1a0)],toggleStatus(_0x153ec7[_0xa65bb4(0x1a0)]),_0xa65bb4(0x221));});}else await sendTelegram(_0x118355[_0x58ea40(0x247)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x343427),toggleBot(_0x343427,toggleStatus(_0x343427),_0x58ea40(0x221));}),tgBot[_0x43efcc(0x23a)](_0x43efcc(0x1ac),async _0x243499=>{const _0x259811=_0x43efcc,_0x116e73=getEnabledBots();if(_0x116e73['length']==0x0)await sendTelegram(_0x243499['chat']['id'],_0x259811(0x126));else{if(_0x116e73[_0x259811(0x1c2)]>0x1){let _0x54553b=[],_0x727a47=[];const _0x181624=_0x116e73['length']%0x4==0x0||_0x116e73[_0x259811(0x1c2)]%0x4==0x3||_0x116e73[_0x259811(0x1c2)]%0x3==0x1?0x4:0x3;let _0x182a07=0x0;_0x116e73[_0x259811(0x10a)]((_0x3af254,_0x566f52)=>{const _0x177835=_0x259811;if(_0x566f52%_0x181624==0x0)_0x727a47=[];_0x727a47[_0x177835(0x265)](Markup[_0x177835(0x22a)]['callback'](_0x177835(0x1d7)+_0x3af254[_0x177835(0x1a0)],_0x177835(0x132)+_0x3af254[_0x177835(0x1a0)])),_0x566f52%_0x181624==0x0&&(_0x54553b[_0x182a07]=_0x727a47,_0x182a07++);});const _0x3c4ad9=Markup[_0x259811(0xc1)](_0x54553b);_0x243499['reply']('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x3c4ad9);}else{const _0xa90147=_0x116e73[0x0][_0x259811(0x1a0)];if(pid[_0xa90147])pid[_0xa90147][_0x259811(0xcb)]({'function':_0x259811(0xb9),'args':null});}}}),tgBot[_0x43efcc(0x1ce)](/metrics_(.+)/,async _0x5d5efb=>{const _0x184703=_0x43efcc,_0x13d76f=_0x5d5efb[_0x184703(0x1e6)][0x1];_0x5d5efb['editMessageReplyMarkup']();if(pid[_0x13d76f])pid[_0x13d76f]['send']({'function':_0x184703(0xb9),'args':null});}),tgBot[_0x43efcc(0x23a)]('portfolio',async _0x5057b6=>{const _0x14fca5=_0x43efcc,_0xa50fa9=getEnabledBots();if(_0xa50fa9['length']==0x0)await sendTelegram(_0x5057b6[_0x14fca5(0x247)]['id'],_0x14fca5(0x126));else{if(_0xa50fa9['length']>0x1){let _0x2c7179=[],_0xc5788=[];const _0xf92a3b=_0xa50fa9[_0x14fca5(0x1c2)]%0x4==0x0||_0xa50fa9[_0x14fca5(0x1c2)]%0x4==0x3||_0xa50fa9[_0x14fca5(0x1c2)]%0x3==0x1?0x4:0x3;let _0x220ce7=0x0;_0xa50fa9[_0x14fca5(0x10a)]((_0x4cd0c1,_0x2db50b)=>{const _0x48390d=_0x14fca5;if(_0x2db50b%_0xf92a3b==0x0)_0xc5788=[];_0xc5788[_0x48390d(0x265)](Markup['button'][_0x48390d(0x163)](_0x48390d(0x1d7)+_0x4cd0c1[_0x48390d(0x1a0)],_0x48390d(0x22f)+_0x4cd0c1[_0x48390d(0x1a0)])),_0x2db50b%_0xf92a3b==0x0&&(_0x2c7179[_0x220ce7]=_0xc5788,_0x220ce7++);});const _0x168f93=Markup[_0x14fca5(0xc1)](_0x2c7179);_0x5057b6[_0x14fca5(0x1fa)](_0x14fca5(0x236),_0x168f93);}else{const _0x501517=_0xa50fa9[0x0][_0x14fca5(0x1a0)];if(pid[_0x501517])pid[_0x501517][_0x14fca5(0xcb)]({'function':_0x14fca5(0x193),'args':null});}}}),tgBot[_0x43efcc(0x1ce)](/portfolio_(.+)/,async _0x4774d1=>{const _0x2f0946=_0x43efcc,_0x2808e9=_0x4774d1[_0x2f0946(0x1e6)][0x1];_0x4774d1[_0x2f0946(0xcd)]();if(pid[_0x2808e9])pid[_0x2808e9]['send']({'function':_0x2f0946(0x193),'args':null});}),tgBot[_0x43efcc(0x23a)](_0x43efcc(0x1e7),async _0x2e39de=>{const _0x54ef00=_0x43efcc;await getMessages();if(!updateAvailable)await sendTelegram(_0x2e39de[_0x54ef00(0x247)]['id'],_0x54ef00(0x173));else{if(!validInstallation)await sendTelegram(_0x2e39de[_0x54ef00(0x247)]['id'],_0x54ef00(0xa6));else{const _0x5b7eac=Markup['inlineKeyboard']([Markup['button'][_0x54ef00(0x163)](_0x54ef00(0x1fb),'update_yes'),Markup[_0x54ef00(0x22a)][_0x54ef00(0x163)]('No',_0x54ef00(0x252))]);_0x2e39de[_0x54ef00(0x1fa)](_0x54ef00(0x168),_0x5b7eac);}}}),tgBot['action'](/update_(.+)/,async _0x5b2782=>{const _0x2cd572=_0x43efcc,_0x195947=_0x5b2782[_0x2cd572(0x1e6)][0x1];_0x5b2782[_0x2cd572(0xcd)](),_0x195947=='yes'&&(await sendTelegram(_0x5b2782[_0x2cd572(0x247)]['id'],_0x2cd572(0xab)),updateBB('update')),_0x195947=='no'&&await sendTelegram(_0x5b2782[_0x2cd572(0x247)]['id'],_0x2cd572(0x1c9));}),tgBot[_0x43efcc(0x23a)](_0x43efcc(0x11a),async _0x1079dd=>{const _0x45bc2d=_0x43efcc;if(!validInstallation)await sendTelegram(_0x1079dd[_0x45bc2d(0x247)]['id'],_0x45bc2d(0x11e));else{const _0x130fbb=Markup['inlineKeyboard']([Markup[_0x45bc2d(0x22a)]['callback']('Yes',_0x45bc2d(0x27e)),Markup[_0x45bc2d(0x22a)][_0x45bc2d(0x163)]('No',_0x45bc2d(0xec))]);_0x1079dd[_0x45bc2d(0x1fa)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x130fbb);}}),tgBot[_0x43efcc(0x1ce)](/reinstall_(.+)/,async _0x124b26=>{const _0x5e51d3=_0x43efcc,_0x391f36=_0x124b26[_0x5e51d3(0x1e6)][0x1];_0x124b26['editMessageReplyMarkup'](),_0x391f36==_0x5e51d3(0x85)&&(await sendTelegram(_0x124b26[_0x5e51d3(0x247)]['id'],_0x5e51d3(0x143)),updateBB(_0x5e51d3(0x11a))),_0x391f36=='no'&&await sendTelegram(_0x124b26[_0x5e51d3(0x247)]['id'],_0x5e51d3(0x18c));}),tgBot[_0x43efcc(0x23a)](_0x43efcc(0x185),async _0x5f104e=>{const _0x20924c=_0x43efcc,_0x4e3ab9=getBotsWithMode();if(_0x4e3ab9[_0x20924c(0x1c2)]==0x0)await sendTelegram(_0x5f104e[_0x20924c(0x247)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x4bea05=[],_0x22b3a9=[];const _0x51f3bf=0x2;let _0x47e04f=0x0;_0x4e3ab9[_0x20924c(0x10a)]((_0x40145c,_0x374d24)=>{const _0xd17b05=_0x20924c;if(_0x374d24%_0x51f3bf==0x0)_0x22b3a9=[];_0x22b3a9[_0xd17b05(0x265)](Markup[_0xd17b05(0x22a)]['callback'](_0xd17b05(0x1d7)+_0x40145c[_0xd17b05(0x1a0)]+'\x20('+_0x40145c[_0xd17b05(0x226)]+')','toggle_'+_0x40145c[_0xd17b05(0x1a0)])),_0x374d24%_0x51f3bf==0x0&&(_0x4bea05[_0x47e04f]=_0x22b3a9,_0x47e04f++);});const _0x2fdf8a=Markup[_0x20924c(0xc1)](_0x4bea05);_0x5f104e[_0x20924c(0x1fa)](_0x20924c(0xd9),_0x2fdf8a);}}),tgBot[_0x43efcc(0x1ce)](/toggle_(.+)/,async _0xbe38fc=>{const _0x4373dd=_0x43efcc,_0x199a03=_0xbe38fc[_0x4373dd(0x1e6)][0x1];_0xbe38fc[_0x4373dd(0xcd)]();const _0x5c625c=getBotsWithMode(),_0x51f9c4=_0x5c625c[_0x4373dd(0x8e)](_0x3f755a=>_0x3f755a[_0x4373dd(0x1a0)]==_0x199a03),_0x2abab9=_0x51f9c4[_0x4373dd(0x226)]==_0x4373dd(0xf3)?_0x4373dd(0xa4):_0x4373dd(0xf3);await sendTelegram(_0xbe38fc[_0x4373dd(0x247)]['id'],_0x4373dd(0xf7)+_0x199a03+_0x4373dd(0x18d)+_0x2abab9+_0x4373dd(0x1bc)),toggleBotMode(_0x199a03);}),tgBot['command'](_0x43efcc(0x127),async _0xd2a00f=>{const _0x320610=_0x43efcc;let _0x5029eb='';config[_0x320610(0x10a)](_0x5c2add=>{const _0x8350c4=_0x320610;_0x5029eb+=_0x8350c4(0x1d7)+_0x5c2add['botID']+':\x20'+_0x5c2add[_0x8350c4(0x1b4)]+'\x0a';}),await sendTelegram(_0xd2a00f[_0x320610(0x247)]['id'],_0x5029eb,{'parse_mode':_0x320610(0x120)});}),tgBot['command'](_0x43efcc(0xc3),async _0x39b091=>{const _0x446778=_0x43efcc;await sendTelegram(_0x39b091[_0x446778(0x247)]['id'],_0x52da97);}),process[_0x43efcc(0x16c)](_0x43efcc(0x1b2),()=>tgBot[_0x43efcc(0xf2)](_0x43efcc(0x1b2))),process[_0x43efcc(0x16c)](_0x43efcc(0xc6),()=>tgBot[_0x43efcc(0xf2)](_0x43efcc(0xc6))),tgBot[_0x43efcc(0x228)]();}}function disableTelegram(){const _0x1e90b9=_0x1131a9;tgBot&&tgBot[_0x1e90b9(0xf2)]();}async function sendTelegram(_0x5bcd39,_0x5c4cc0,_0x492971){const _0x8c1e58=_0x1131a9;try{await tgBot[_0x8c1e58(0x28d)][_0x8c1e58(0x166)](_0x5bcd39,_0x5c4cc0,_0x492971);}catch(_0x5ac009){console[_0x8c1e58(0x100)]('Telegram\x20error:',_0x5ac009);}}async function sendTelegramBot(_0x56f88e,_0x215ccc){const _0x596f0a=_0x1131a9;if(settings['telegramEnabled']){if(settings[_0x596f0a(0xdb)]==_0x596f0a(0x138)||(_0x215ccc[_0x596f0a(0x21d)]==_0x596f0a(0x158)||_0x215ccc[_0x596f0a(0x21d)]==_0x596f0a(0xb3)||_0x215ccc[_0x596f0a(0x21d)]==_0x596f0a(0x190))&&settings['telegramEvents']==_0x596f0a(0x248)||_0x215ccc[_0x596f0a(0x21d)]==_0x596f0a(0xb4)&&settings[_0x596f0a(0xdb)]=='orders'){if(tgBot&&settings[_0x596f0a(0x240)]){if(_0x215ccc[_0x596f0a(0x1db)])await sendTelegram(settings[_0x596f0a(0x240)],_0x215ccc[_0x596f0a(0x1b4)]+_0x596f0a(0x14d)+_0x215ccc[_0x596f0a(0x24f)]);else await sendTelegram(settings['telegramChatId'],_0x596f0a(0x1d7)+_0x56f88e+'\x20>\x20'+_0x215ccc[_0x596f0a(0x24f)]);}}}}async function sendTelegramMsg(_0x333c02,_0x1fd711=_0x1131a9(0x120)){const _0x38850e=_0x1131a9;return settings[_0x38850e(0xb2)]&&tgBot&&settings[_0x38850e(0x240)]?(await sendTelegram(settings[_0x38850e(0x240)],_0x333c02,{'parse_mode':_0x1fd711}),!![]):![];}function getDeviceWithIp(_0x3a0fdb){return devices['find'](_0x48346b=>_0x48346b['ip']===_0x3a0fdb);}async function temporaryAccess2FA(_0x147115,_0x945bc5){const _0x24de02=_0x1131a9;let _0x4137e6=new Date(),_0x3d0be1=![];if(lastIpApproval){if(_0x4137e6-lastIpApproval<0x1388)_0x3d0be1=!![];}lastIpApproval=new Date();if(_0x3d0be1)return;if(tgBot&&settings[_0x24de02(0x240)]){const _0x4c591c=uuidRandom();tmpStorage[_0x4c591c]={'uuid':_0x147115,'externalip':_0x945bc5};const _0x376fe8=Markup[_0x24de02(0xc1)]([Markup[_0x24de02(0x22a)]['callback'](_0x24de02(0x250),_0x24de02(0x1a2)+_0x4c591c),Markup[_0x24de02(0x22a)][_0x24de02(0x163)](_0x24de02(0x26e),'tempaccess_15_'+_0x4c591c),Markup[_0x24de02(0x22a)][_0x24de02(0x163)]('30\x20min',_0x24de02(0x96)+_0x4c591c),Markup[_0x24de02(0x22a)][_0x24de02(0x163)](_0x24de02(0x20d),_0x24de02(0xce)+_0x4c591c)]);await sendTelegram(settings[_0x24de02(0x240)],_0x24de02(0x16b)+normalizeIP(_0x945bc5)[_0x24de02(0x10b)]+'\x20?',_0x376fe8),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x27e1fe=>{const _0x15ac51=_0x24de02,_0x66c5b6=_0x27e1fe[_0x15ac51(0x1e6)][0x1],_0x2f1a72=_0x27e1fe[_0x15ac51(0x1e6)][0x2],{uuid:_0xa5729a,externalip:_0x2735d9}=tmpStorage[_0x2f1a72];delete tmpStorage[_0x2f1a72],_0x27e1fe[_0x15ac51(0xcd)](),devices[_0xa5729a]['telegramIpApproval']={'clientip':_0x2735d9,'timestamp':new Date()['getTime'](),'expiry':_0x66c5b6},_0x66c5b6!=_0x15ac51(0x20d)?(await sendTelegram(_0x27e1fe[_0x15ac51(0x247)]['id'],_0x15ac51(0x230)+_0x66c5b6+_0x15ac51(0xd3),{'parse_mode':_0x15ac51(0x120)}),io['to'](_0xa5729a)['emit'](_0x15ac51(0x180),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x27e1fe[_0x15ac51(0x247)]['id'],_0x15ac51(0x16d)),io['to'](_0xa5729a)[_0x15ac51(0x1b1)](_0x15ac51(0x180),{'access':{'allow':![],'reason':_0x15ac51(0x25c),'token':null}}));});}}async function loginAccess2FA(_0x5451cd,_0x4741ce){const _0x44ace4=_0x1131a9;if(tgBot&&settings['telegramChatId']){const _0x2fc80c=uuidRandom();tmpStorage[_0x2fc80c]={'uuid':_0x5451cd,'externalip':_0x4741ce};const _0x3dfe43=Markup[_0x44ace4(0xc1)]([Markup['button'][_0x44ace4(0x163)]('accept','login2fa_'+loginExpiry+'_'+_0x2fc80c),Markup[_0x44ace4(0x22a)][_0x44ace4(0x163)](_0x44ace4(0x20d),_0x44ace4(0x1f5)+_0x2fc80c)]);await sendTelegram(settings[_0x44ace4(0x240)],_0x44ace4(0xa0)+normalizeIP(_0x4741ce)[_0x44ace4(0x10b)]+'\x20?',_0x3dfe43),tgBot[_0x44ace4(0x1ce)](/login2fa_(.+)_(.+)/,async _0x2baddb=>{const _0x2f793d=_0x44ace4,_0x5dbec0=_0x2baddb[_0x2f793d(0x1e6)][0x1],_0x5324d1=_0x2baddb['match'][0x2],{uuid:_0x56d007,externalip:_0x22ae6d}=tmpStorage[_0x5324d1];delete tmpStorage[_0x5324d1],_0x2baddb['editMessageReplyMarkup'](),devices[_0x56d007][_0x2f793d(0x1ee)]={'clientip':_0x22ae6d,'timestamp':new Date()[_0x2f793d(0x194)](),'expiry':_0x5dbec0},_0x5dbec0!=_0x2f793d(0x20d)?(await sendTelegram(_0x2baddb['chat']['id'],'Login\x20accepted',{'parse_mode':_0x2f793d(0x120)}),io['to'](_0x56d007)[_0x2f793d(0x1b1)](_0x2f793d(0x180),{'access':{'allow':![],'reason':_0x2f793d(0x123),'token':null}})):(await sendTelegram(_0x2baddb['chat']['id'],_0x2f793d(0x1d8)),io['to'](_0x56d007)[_0x2f793d(0x1b1)](_0x2f793d(0x180),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x332de2=_0x1131a9;return dbConfig[_0x332de2(0xe8)]('bots')['sortBy']('botID')[_0x332de2(0xff)]({'status':'enabled'})['value']()||[];}function getDisabledBots(){const _0x5d7bdd=_0x1131a9;return dbConfig[_0x5d7bdd(0xe8)](_0x5d7bdd(0x141))[_0x5d7bdd(0x260)]('botID')[_0x5d7bdd(0xff)]({'status':_0x5d7bdd(0x258)})[_0x5d7bdd(0x1f8)]()||[];}function getBotAttributes(_0x3298e9){const _0x86fc89=_0x1131a9;let _0x294983={};const _0x520d0b=configpath+_0x86fc89(0x24e)+_0x3298e9+_0x86fc89(0x1a1),_0x4fd9ed=fs[_0x86fc89(0x286)](_0x520d0b);if(_0x4fd9ed){const _0x249a6d=fs[_0x86fc89(0x25b)](_0x520d0b);try{const _0x2e8543=JSON[_0x86fc89(0x8b)](_0x249a6d),_0x3d7b43=_0x2e8543?_0x2e8543[_0x86fc89(0x1e9)][0x0][_0x86fc89(0x17e)]:![];_0x294983['mode']=_0x3d7b43?'auto':_0x86fc89(0xa4),_0x294983[_0x86fc89(0x1b4)]=_0x2e8543?_0x2e8543[_0x86fc89(0x1e9)][0x0]['botname']:_0x86fc89(0x1d7)+_0x3298e9;}catch(_0x372dff){_0x294983[_0x86fc89(0x226)]=_0x86fc89(0xa4),_0x294983[_0x86fc89(0x1b4)]=_0x86fc89(0x1d7)+_0x3298e9;}}else _0x294983[_0x86fc89(0x226)]=_0x86fc89(0xa4),_0x294983[_0x86fc89(0x1b4)]=_0x86fc89(0x1d7)+_0x3298e9;return _0x294983;}function getBotsWithMode(){const _0x960cc6=_0x1131a9,_0x42a388=dbConfig[_0x960cc6(0xe8)](_0x960cc6(0x141))[_0x960cc6(0x260)](_0x960cc6(0x1a0))[_0x960cc6(0x1f8)]()||[];return _0x42a388['forEach'](_0xd27283=>{const _0x33b669=_0x960cc6;let _0xc0ece1=getBotAttributes(_0xd27283[_0x33b669(0x1a0)]);_0xd27283[_0x33b669(0x226)]=_0xc0ece1[_0x33b669(0x226)];}),_0x42a388;}function getBotExchanges(){const _0x562026=_0x1131a9;let _0x262222=[];const _0x248dda=dbConfig['get'](_0x562026(0x141))[_0x562026(0x260)]('botID')['value']()||[];_0x248dda['forEach'](_0x534ac6=>{const _0x46b76e=_0x562026;if(_0x534ac6['status']==_0x46b76e(0x94)){const _0x26ff09=configpath+_0x46b76e(0x24e)+_0x534ac6['botID']+_0x46b76e(0x1a1),_0x47bb97=fs[_0x46b76e(0x286)](_0x26ff09);let _0x290135;if(_0x47bb97){const _0x531b01=fs['readFileSync'](_0x26ff09);try{const _0x106b18=JSON[_0x46b76e(0x8b)](_0x531b01);_0x290135=_0x106b18?_0x106b18[_0x46b76e(0x1e9)][0x0]['exchange']:null;}catch(_0x321a90){}}if(_0x290135)_0x262222[_0x46b76e(0x265)](_0x290135);}});const _0x52a081=[...new Set(_0x262222)][_0x562026(0x192)]();return _0x52a081;}async function initUser(){const _0x4c7269=_0x1131a9;if(!settings[_0x4c7269(0xb0)]){const _0x52b7e8=uuidRandom();mixpanel[_0x4c7269(0x1fe)](_0x52b7e8),updateSetting(_0x4c7269(0xb0),_0x52b7e8);}}async function initSecure(){const _0x143a7c=_0x1131a9;let _0x192650=getSecure();if(!_0x192650[_0x143a7c(0xed)](_0x143a7c(0x20c))){let _0x382cb3=await generateKeys();_0x192650[_0x143a7c(0x1dd)]=_0x382cb3[_0x143a7c(0x1dd)],_0x192650[_0x143a7c(0x1ba)]=_0x382cb3[_0x143a7c(0x1ba)],_0x192650[_0x143a7c(0x20c)]=crypto[_0x143a7c(0xd2)](0x20)[_0x143a7c(0x1d4)](_0x143a7c(0x172));;storeSecure(_0x192650);}}function getSettings(){const _0x122688=_0x1131a9;return dbSettings[_0x122688(0xe8)](_0x122688(0x270))['value']()||{};}function getSecure(){const _0x1a111d=_0x1131a9;return dbSecure[_0x1a111d(0xe8)](_0x1a111d(0x1da))[_0x1a111d(0x1f8)]()||{};}function getBlacklist(){const _0x2305b1=_0x1131a9;return dbSecure[_0x2305b1(0xe8)](_0x2305b1(0x283))['value']()||[];}function broadcastToBots(_0x4efd2a,_0x1b1f41){const _0x2583f2=_0x1131a9;config[_0x2583f2(0x10a)](_0x20810c=>{const _0x36aed7=_0x2583f2;if(_0x20810c[_0x36aed7(0x180)]==_0x36aed7(0x94)&&_0x20810c[_0x36aed7(0x267)]=='running'||_0x20810c[_0x36aed7(0x180)]==_0x36aed7(0x12e)&&_0x20810c[_0x36aed7(0x267)]==_0x36aed7(0xda)){if(pid[_0x20810c[_0x36aed7(0x1a0)]])pid[_0x20810c[_0x36aed7(0x1a0)]][_0x36aed7(0xcb)]({[_0x4efd2a]:_0x1b1f41});}});}function storeSettings(_0x4bd840,_0xb09b86=![]){const _0x5af310=_0x1131a9;_0x4bd840={...settings,..._0x4bd840};if(_0xb09b86&&_0x4bd840['bbPassword']!=_0x5af310(0x23e)&&_0x4bd840['bbPassword']!=_0x5af310(0x12a)&&_0x4bd840['bbPassword']!=''){const _0x42db2d=crypt['decrypt'](secure[_0x5af310(0x1ba)],_0x4bd840[_0x5af310(0x144)])[_0x5af310(0x1f1)]['split']('@')[0x0],_0x58a1b0=bcrypt[_0x5af310(0x207)](_0x42db2d,saltRounds);_0x4bd840={..._0x4bd840,'bbPassword':_0x58a1b0};}if(_0xb09b86&&_0x4bd840[_0x5af310(0x249)]!=_0x5af310(0x23e)&&_0x4bd840['telegramToken']!=_0x5af310(0x12a)&&_0x4bd840[_0x5af310(0x249)]!=''){const _0xef11d2=crypt['decrypt'](secure[_0x5af310(0x1ba)],_0x4bd840[_0x5af310(0x249)])[_0x5af310(0x1f1)]['split']('@')[0x0];_0x4bd840={..._0x4bd840,'telegramToken':_0xef11d2};}const _0x47e41d=_0x4bd840[_0x5af310(0x249)]!=_0x5af310(0x23e)&&_0x4bd840[_0x5af310(0x249)]!=settings[_0x5af310(0x249)]||_0x4bd840[_0x5af310(0x9f)]!=settings[_0x5af310(0x9f)],_0x1dd240=_0x4bd840[_0x5af310(0x249)]==''||_0x4bd840[_0x5af310(0x9f)]=='';_0x47e41d&&(_0x4bd840[_0x5af310(0x240)]=null,_0x4bd840[_0x5af310(0xdb)]=_0x5af310(0x138));for(const [_0x59d746,_0x1369f4]of Object[_0x5af310(0x220)](_0x4bd840)){if(_0x59d746==_0x5af310(0x249)&&_0x1369f4==_0x5af310(0x23e)){_0x4bd840['telegramToken']=settings['telegramToken'];continue;};if(_0x59d746==_0x5af310(0x144)&&_0x1369f4=='************'){_0x4bd840['bbPassword']=settings['bbPassword'];continue;};dbSettings[_0x5af310(0x12c)](_0x5af310(0x88)+_0x59d746,_0x1369f4)[_0x5af310(0x1a9)]();}settings=_0x4bd840,io['to']('botmanager')[_0x5af310(0x1b1)](_0x5af310(0x270),cleanSettings()),broadcastToBots('timeshift',settings['timeshift']),broadcastToBots('onepagemode',settings[_0x5af310(0x145)]);if(_0x47e41d&&!_0x1dd240)initTelegram();if(_0x47e41d&&_0x1dd240)disableTelegram();getAllClients()[_0x5af310(0x10a)](_0x5cea0c=>{const _0x112066=_0x5af310;getSocket(_0x5cea0c['id'])[_0x112066(0x1b1)](_0x112066(0x180),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x49e502,_0x340b75){const _0xb5381a=_0x1131a9;dbSettings[_0xb5381a(0x12c)](_0xb5381a(0x88)+_0x49e502,_0x340b75)[_0xb5381a(0x1a9)](),settings=getSettings(),io['to'](_0xb5381a(0x1dc))[_0xb5381a(0x1b1)](_0xb5381a(0x270),cleanSettings());}function storeSecure(_0x8a84c9){const _0x3eb788=_0x1131a9;dbSecure['get'](_0x3eb788(0x1da))[_0x3eb788(0x265)](_0x8a84c9)['write'](),secure=_0x8a84c9;}function addBlacklist(_0x2e954a){const _0x42361e=_0x1131a9;cleanBlacklist();let _0x4c6270;devices[_0x2e954a][_0x42361e(0x227)]?_0x4c6270=Math[_0x42361e(0x27b)](devices[_0x2e954a][_0x42361e(0x227)]['expiry'],loginExpiry):_0x4c6270=loginExpiry,dbSecure['get'](_0x42361e(0x283))['push']({'expiry':new Date()[_0x42361e(0x194)]()+_0x4c6270*0x3c*0x3e8,'token':devices[_0x2e954a][_0x42361e(0x140)][_0x42361e(0x271)]})[_0x42361e(0x1a9)](),blacklist=dbSecure[_0x42361e(0xe8)](_0x42361e(0x283))[_0x42361e(0x1f8)]();}function cleanBlacklist(){const _0x5a5d11=_0x1131a9;let _0x242a24=dbSecure[_0x5a5d11(0xe8)]('blacklist')[_0x5a5d11(0xac)]()[_0x5a5d11(0x1f8)](),_0x37dfbc=new Date()[_0x5a5d11(0x194)]();_0x242a24[_0x5a5d11(0x10a)](_0x512a4b=>{const _0x5e75fe=_0x5a5d11;_0x512a4b[_0x5e75fe(0x16a)]<_0x37dfbc&&dbSecure['get'](_0x5e75fe(0x283))[_0x5e75fe(0x27c)]({'expiry':_0x512a4b['expiry']})[_0x5e75fe(0x1a9)]();});}function initStates(){const _0x1b048c=_0x1131a9;let _0x4d185e=getConfiguration();_0x4d185e[_0x1b048c(0x10a)](_0x3c7d5a=>{const _0x22e360=_0x1b048c;_0x3c7d5a[_0x22e360(0x267)]=_0x22e360(0x221);}),storeConfiguration(_0x4d185e);}function onKeys(){const _0x1927b1=new RSA();return new Promise(_0x14c727=>{const _0x586231=_0xc092;_0x1927b1[_0x586231(0x27d)]()[_0x586231(0x9d)](_0x210401=>{_0x14c727(_0x210401);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x37e0d4=_0x1131a9;let _0x32d4f8=getSettings(),_0x127da9=![];!_0x32d4f8[_0x37e0d4(0xed)](_0x37e0d4(0x1b0))&&(_0x32d4f8[_0x37e0d4(0x1b0)]=0x0,_0x127da9=!![]);!_0x32d4f8['hasOwnProperty'](_0x37e0d4(0x1f9))&&(_0x32d4f8[_0x37e0d4(0x1f9)]=0x0,_0x127da9=!![]);!_0x32d4f8[_0x37e0d4(0xed)](_0x37e0d4(0x12d))&&(_0x32d4f8[_0x37e0d4(0x12d)]='0.0.0',_0x127da9=!![]);!_0x32d4f8['hasOwnProperty'](_0x37e0d4(0x145))&&(_0x32d4f8[_0x37e0d4(0x145)]=![],_0x127da9=!![]);if(_0x127da9)storeSettings(_0x32d4f8);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x37e0d4(0x10a)](_0x2964a8=>{const _0x5029f3=_0x37e0d4;if(!_0x2964a8[_0x5029f3(0x102)]()){if(!_0x2964a8[_0x5029f3(0x28e)]['startsWith']('backup-full@'))fs['unlinkSync'](configbackuppath+_0x2964a8[_0x5029f3(0x28e)]);}else fs[_0x5029f3(0xc0)](configbackuppath+_0x2964a8[_0x5029f3(0x28e)],{'recursive':!![]});});}catch(_0x4ca43){logger[_0x37e0d4(0x253)](_0x37e0d4(0x233),_0x4ca43);}}function storeConfiguration(_0x2cdc56){const _0x453135=_0x1131a9;dbConfig[_0x453135(0xe8)](_0x453135(0x141))[_0x453135(0x27c)]()[_0x453135(0x1a9)](),dbConfig[_0x453135(0xe8)]('bots')[_0x453135(0x265)](..._0x2cdc56)[_0x453135(0x1a9)](),config=_0x2cdc56;}async function resetPassword(){const _0x4f2fcc=_0x1131a9;if(tgBot&&settings[_0x4f2fcc(0x240)]){const _0x3adbca=Markup[_0x4f2fcc(0xc1)]([Markup[_0x4f2fcc(0x22a)]['callback'](_0x4f2fcc(0x85),_0x4f2fcc(0x213)),Markup[_0x4f2fcc(0x22a)][_0x4f2fcc(0x163)]('no',_0x4f2fcc(0x223))]);await sendTelegram(settings['telegramChatId'],_0x4f2fcc(0x110),_0x3adbca),tgBot[_0x4f2fcc(0x1ce)](/resetpw_(.+)/,async _0x267e57=>{const _0x5bb292=_0x4f2fcc,_0x5af931=_0x267e57['match'][0x1];_0x267e57['editMessageReplyMarkup']();if(_0x5af931!='no'){const _0x5dee96=0xf,_0x53de99=_0x5bb292(0x93),_0x1c5fc4=Array[_0x5bb292(0x137)](crypto[_0x5bb292(0x222)](new Uint32Array(_0x5dee96)))[_0x5bb292(0x22b)](_0x9f5d74=>_0x53de99[_0x9f5d74%_0x53de99[_0x5bb292(0x1c2)]])[_0x5bb292(0x99)](''),_0x3b745d=bcrypt[_0x5bb292(0x207)](_0x1c5fc4,saltRounds);storeSettings({'bbPassword':_0x3b745d}),await sendTelegram(_0x267e57[_0x5bb292(0x247)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x1c5fc4,{'parse_mode':_0x5bb292(0x120)});}else await sendTelegram(_0x267e57[_0x5bb292(0x247)]['id'],_0x5bb292(0x169));});}}async function confirmRestore(_0x1a1118,_0x1aca99){const _0x351a3d=_0x1131a9;io['to'](_0x351a3d(0x1dc))[_0x351a3d(0x1b1)]('notification','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x351a3d(0x190));if(tgBot&&settings[_0x351a3d(0x240)]){const _0xb31145=uuidRandom();tmpStorage[_0xb31145]={'path':_0x1a1118,'filename':_0x1aca99};const _0x196a49=Markup[_0x351a3d(0xc1)]([Markup['button']['callback'](_0x351a3d(0x85),'restore_yes_'+_0xb31145),Markup[_0x351a3d(0x22a)][_0x351a3d(0x163)]('no',_0x351a3d(0x234)+_0xb31145)]);await sendTelegram(settings[_0x351a3d(0x240)],_0x351a3d(0x1e3),_0x196a49),tgBot[_0x351a3d(0x1ce)](/restore_(.+)_(.+)/,async _0x469b44=>{const _0x4aa347=_0x351a3d,_0x12400e=_0x469b44['match'][0x1],_0x1fd17e=_0x469b44[_0x4aa347(0x1e6)][0x2],{path:_0x4adc5e,filename:_0x1c0fba}=tmpStorage[_0x1fd17e];delete tmpStorage[_0x1fd17e],_0x469b44[_0x4aa347(0xcd)](),_0x12400e==_0x4aa347(0x85)?(logger['debug'](_0x4aa347(0x22e)),await sendTelegram(_0x469b44['chat']['id'],_0x4aa347(0x109),{'parse_mode':_0x4aa347(0x120)}),unzipFile(_0x4adc5e,_0x1c0fba)):(logger[_0x4aa347(0x253)]('Restore\x20process\x20aborted'),await sendTelegram(_0x469b44['chat']['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x348a6c=_0x1131a9,_0xf3706d=new Date();return _0xf3706d[_0x348a6c(0x278)]()+'/'+(_0xf3706d[_0x348a6c(0x131)]()+0x1)[_0x348a6c(0x1d4)]()['padStart'](0x2,'0')+'/'+_0xf3706d[_0x348a6c(0x12b)]()[_0x348a6c(0x1d4)]()[_0x348a6c(0xbf)](0x2,'0')+'\x20'+_0xf3706d[_0x348a6c(0xaa)]()['toString']()[_0x348a6c(0xbf)](0x2,'0')+':'+_0xf3706d[_0x348a6c(0xaf)]()[_0x348a6c(0x1d4)]()[_0x348a6c(0xbf)](0x2,'0')+':'+_0xf3706d[_0x348a6c(0xc9)]()[_0x348a6c(0x1d4)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x4c566b=_0x1131a9,_0x59a1c2=shiftedTime();return _0x59a1c2[_0x4c566b(0x278)]()+'/'+(_0x59a1c2['getMonth']()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x59a1c2[_0x4c566b(0x12b)]()[_0x4c566b(0x1d4)]()[_0x4c566b(0xbf)](0x2,'0')+'\x20'+_0x59a1c2[_0x4c566b(0xaa)]()[_0x4c566b(0x1d4)]()['padStart'](0x2,'0')+':'+_0x59a1c2[_0x4c566b(0xaf)]()['toString']()[_0x4c566b(0xbf)](0x2,'0')+':'+_0x59a1c2['getSeconds']()[_0x4c566b(0x1d4)]()[_0x4c566b(0xbf)](0x2,'0');}function getCleanTimeStamp(){const _0x56d1ae=_0x1131a9,_0x3e46de=shiftedTime();return _0x3e46de[_0x56d1ae(0x278)]()+(_0x3e46de[_0x56d1ae(0x131)]()+0x1)[_0x56d1ae(0x1d4)]()[_0x56d1ae(0xbf)](0x2,'0')+_0x3e46de[_0x56d1ae(0x12b)]()[_0x56d1ae(0x1d4)]()['padStart'](0x2,'0')+'-'+_0x3e46de['getHours']()[_0x56d1ae(0x1d4)]()[_0x56d1ae(0xbf)](0x2,'0')+_0x3e46de[_0x56d1ae(0xaf)]()[_0x56d1ae(0x1d4)]()[_0x56d1ae(0xbf)](0x2,'0')+_0x3e46de['getSeconds']()[_0x56d1ae(0x1d4)]()[_0x56d1ae(0xbf)](0x2,'0');}function shiftedTime(){const _0x5720c8=_0x1131a9,_0x2661b7=new Date();let _0x59291b=_0x2661b7;if(settings[_0x5720c8(0x1ab)]&&settings[_0x5720c8(0x1ab)]!==0x0)_0x59291b=fns[_0x5720c8(0x21b)](_0x2661b7,{'hours':settings[_0x5720c8(0x1ab)]});return _0x59291b;}function startScheduler(){const _0x17114f=_0x1131a9,_0x64304d=new Date()[_0x17114f(0xea)](),_0x4b4c71=shiftedTime()['getHours']();_0x4b4c71==0x4&&backupConfigFiles();_0x4b4c71==0x0&&rotateLogFiles();_0x64304d%0x6==0x0&&triggerAnalytics();_0x64304d%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x1032d1){const _0x500f40=_0x1131a9;logger[_0x500f40(0x253)](_0x500f40(0x13f)+_0x1032d1);const _0x12addd=getBotsWithMode();_0x12addd[_0x500f40(0x1c2)]>0x0?confirmRestore(configbackuppath,_0x1032d1):unzipFile(configbackuppath,_0x1032d1);}async function getBackupFiles(_0x3d004c=null){const _0x5007f4=_0x1131a9;let _0x15e691=[],_0xf4a82=fs[_0x5007f4(0x211)](configbackuppath,{'withFileTypes':!![]});_0xf4a82[_0x5007f4(0x192)]((_0x192f16,_0x417655)=>_0x192f16[_0x5007f4(0x28e)]<_0x417655[_0x5007f4(0x28e)]?0x1:_0x417655[_0x5007f4(0x28e)]<_0x192f16[_0x5007f4(0x28e)]?-0x1:0x0),_0xf4a82[_0x5007f4(0x10a)](_0x25baf0=>{const _0x53e5d5=_0x5007f4;if(!_0x25baf0[_0x53e5d5(0x102)]()&&_0x25baf0[_0x53e5d5(0x28e)]['startsWith'](_0x53e5d5(0x130))&&_0x25baf0[_0x53e5d5(0x28e)][_0x53e5d5(0x23b)]('.zip')){const _0x3fc4d2=formatDate(fs[_0x53e5d5(0x1e4)](configbackuppath+_0x25baf0[_0x53e5d5(0x28e)])[_0x53e5d5(0x1cf)]);_0x15e691['push']({'name':_0x25baf0[_0x53e5d5(0x28e)],'mtime':_0x3fc4d2});}});if(_0x3d004c)io['to'](_0x3d004c)['emit']('backup-files',_0x15e691);else return _0x15e691;}async function backupConfigFiles(){const _0x339795=_0x1131a9;await zipFiles(_0x339795(0x1d3));const _0x1ab21d=getCleanTimeStamp();fs[_0x339795(0xb7)](zippath+_0x339795(0x1de),configbackuppath+(_0x339795(0x130)+_0x1ab21d+_0x339795(0xb6)));let _0x1d507a=fs[_0x339795(0x211)](configbackuppath,{'withFileTypes':!![]});_0x1d507a[_0x339795(0x192)]((_0x5ca5ac,_0x1e1860)=>_0x5ca5ac[_0x339795(0x28e)]<_0x1e1860[_0x339795(0x28e)]?0x1:_0x1e1860[_0x339795(0x28e)]<_0x5ca5ac[_0x339795(0x28e)]?-0x1:0x0),_0x1d507a[_0x339795(0x1c2)]>maxBackups&&fs[_0x339795(0x153)](configbackuppath+_0x1d507a[_0x1d507a['length']-0x1]['name']);}function rotateLogFiles(){const _0x5d27af=_0x1131a9,_0x3fa1b7=fs['statSync'](logspath+_0x5d27af(0x284)),_0x2687ab=_0x3fa1b7[_0x5d27af(0x274)]/0x400;if(_0x2687ab>0x64){let _0x55cd27=fs[_0x5d27af(0x211)](logspath,{'withFileTypes':!![]});_0x55cd27[_0x5d27af(0x192)]((_0x39d500,_0x400f93)=>_0x39d500[_0x5d27af(0x28e)]<_0x400f93[_0x5d27af(0x28e)]?0x1:_0x400f93[_0x5d27af(0x28e)]<_0x39d500[_0x5d27af(0x28e)]?-0x1:0x0),_0x55cd27[_0x5d27af(0x10a)](_0x1195b5=>{const _0x26c7e2=_0x5d27af;if(_0x1195b5[_0x26c7e2(0x28e)]==_0x26c7e2(0xfe))fs[_0x26c7e2(0xb7)](logspath+_0x1195b5['name'],logspath+_0x26c7e2(0x107));if(_0x1195b5[_0x26c7e2(0x28e)]==_0x26c7e2(0x1b9))fs[_0x26c7e2(0xb7)](logspath+_0x1195b5[_0x26c7e2(0x28e)],logspath+_0x26c7e2(0xfe));_0x1195b5[_0x26c7e2(0x28e)]==_0x26c7e2(0x284)&&(fs[_0x26c7e2(0xb7)](logspath+_0x1195b5['name'],logspath+'output-001.log'),fs[_0x26c7e2(0x197)](logspath+_0x1195b5['name'],''));});}}async function zipFiles(_0x395d59){const _0x1347f9=_0x1131a9;let _0x47108f;if(_0x395d59==_0x1347f9(0x112))_0x47108f=logspath;if(_0x395d59==_0x1347f9(0x1a7))_0x47108f=configpath;if(_0x395d59=='backup-full')_0x47108f=configpath;let _0x1b38b4=fs[_0x1347f9(0x211)](_0x47108f,{'withFileTypes':!![]});const _0x4d2618=new require('node-zip')();_0x1b38b4[_0x1347f9(0x10a)](_0x34b299=>{const _0x52190c=_0x1347f9;if(!_0x34b299[_0x52190c(0x102)]()){let _0x4299cf=fs[_0x52190c(0x25b)](_0x47108f+_0x34b299[_0x52190c(0x28e)]);if(_0x395d59==_0x52190c(0x1a7)){const _0x284a3c=/^bot-[0-9]{3}-config.json$/,_0x39031e=_0x284a3c[_0x52190c(0x92)](_0x34b299[_0x52190c(0x28e)]);if(_0x39031e){const _0x34e989=JSON[_0x52190c(0x8b)](_0x4299cf);if(_0x34e989['bot'][0x0]){_0x34e989['bot'][0x0][_0x52190c(0x129)]=_0x52190c(0x12a),_0x34e989[_0x52190c(0x1e9)][0x0][_0x52190c(0x83)]=_0x52190c(0x12a);if(_0x34e989['bot'][0x0][_0x52190c(0x24a)])_0x34e989[_0x52190c(0x1e9)][0x0][_0x52190c(0x24a)]=_0x52190c(0x12a);}_0x4299cf=JSON[_0x52190c(0x25a)](_0x34e989,null,0x2);}if(_0x34b299['name']==_0x52190c(0x177)){const _0x5dbf3f=JSON[_0x52190c(0x8b)](_0x4299cf);if(_0x5dbf3f['settings'][_0x52190c(0x1ff)])_0x5dbf3f[_0x52190c(0x270)][_0x52190c(0x1ff)]=![];if(_0x5dbf3f[_0x52190c(0x270)][_0x52190c(0x144)])_0x5dbf3f['settings']['bbPassword']=_0x52190c(0x12a);if(_0x5dbf3f[_0x52190c(0x270)][_0x52190c(0x249)])_0x5dbf3f[_0x52190c(0x270)][_0x52190c(0x249)]=_0x52190c(0x12a);if(_0x5dbf3f[_0x52190c(0x270)][_0x52190c(0x240)])_0x5dbf3f[_0x52190c(0x270)][_0x52190c(0x240)]=null;_0x4299cf=JSON[_0x52190c(0x25a)](_0x5dbf3f,null,0x2);}if(_0x34b299[_0x52190c(0x28e)]!=_0x52190c(0x154))_0x4d2618['file'](_0x34b299['name'],_0x4299cf);}else _0x4d2618[_0x52190c(0x118)](_0x34b299['name'],_0x4299cf);}});const _0x3a2955=_0x4d2618['generate']({'base64':![],'compression':_0x1347f9(0x176)});fs[_0x1347f9(0x197)](zippath+(_0x395d59+_0x1347f9(0xb6)),_0x3a2955,'binary');}async function unzipFile(_0x3ac04f,_0x17c52a){const _0x3ddf80=_0x1131a9;fs[_0x3ddf80(0x211)](configpath,{'withFileTypes':!![]})[_0x3ddf80(0x10a)](_0x3d9909=>{const _0x2e8c4c=_0x3ddf80;if(!_0x3d9909['isDirectory']())fs[_0x2e8c4c(0xc0)](configpath+_0x3d9909[_0x2e8c4c(0x28e)]);});const _0x5511c6=fs[_0x3ddf80(0x25b)](_0x3ac04f+_0x17c52a,_0x3ddf80(0x281)),_0xec5551=new require('node-zip')(_0x5511c6,{'base64':![],'checkCRC32':!![]});Object['keys'](_0xec5551[_0x3ddf80(0x105)])[_0x3ddf80(0x10a)](_0x560243=>{const _0x5a96c8=_0x3ddf80,_0x4ae687=_0xec5551['files'][_0x560243];fs[_0x5a96c8(0x197)](configpath+_0x4ae687[_0x5a96c8(0x28e)],_0x4ae687[_0x5a96c8(0x178)]);}),fs[_0x3ddf80(0x211)](temppath,{'withFileTypes':!![]})[_0x3ddf80(0x10a)](_0x68ebcc=>{const _0x1d5d9f=_0x3ddf80;if(!_0x68ebcc[_0x1d5d9f(0x102)]())fs[_0x1d5d9f(0xc0)](temppath+_0x68ebcc['name']);}),logger[_0x3ddf80(0x253)](_0x3ddf80(0x10f)),process[_0x3ddf80(0xcb)]({'restore':!![]},_0x46bf6d=>{});}async function getPublicIp(){const _0xeaec26=_0x1131a9;try{const _0xe0790=await axios[_0xeaec26(0xe8)](_0xeaec26(0x179));publicip=_0xe0790[_0xeaec26(0x13e)]['ip'];}catch(_0x400f2f){}}async function triggerAnalytics(){const _0x2ed4d8=_0x1131a9;if(!publicip)await getPublicIp();const _0x58a594=getBotsWithMode();let _0x48f654=0x0;_0x58a594['forEach'](_0x5724f6=>{const _0x44b379=_0xc092;if(_0x5724f6[_0x44b379(0x180)]===_0x44b379(0x94))_0x48f654++;});const _0x4b563c=getBotExchanges();mixpanel[_0x2ed4d8(0x1df)](_0x2ed4d8(0x208),{'distinct_id':settings[_0x2ed4d8(0xb0)],'ip':publicip,'version':serverversion,'numbots':_0x58a594[_0x2ed4d8(0x1c2)],'numbotsenabled':_0x48f654,'exchanges':_0x4b563c,'environment':environment});}async function getMessages(){const _0x35c823=_0x1131a9,_0x4872eb=_0x35c823(0x21e),_0x433be6=new GraphQLClient(_0x4872eb),_0x38cdac={'authorization':_0x35c823(0xd6)},_0xd42a11=serverversion[_0x35c823(0xd7)]('.'),_0x2c9b9c=_0xd42a11[0x0]+'.'+_0xd42a11[0x1],_0x13dc2d=Math['min'](settings[_0x35c823(0x1b0)],settings[_0x35c823(0x1f9)]),_0x14e9ec={'last':parseInt(_0x13dc2d),'bbm':_0x2c9b9c},_0x3564a9=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x5ec74a;try{_0x5ec74a=await _0x433be6[_0x35c823(0x288)](_0x3564a9,_0x14e9ec,_0x38cdac);}catch(_0x5d8620){}if(_0x5ec74a&&_0x5ec74a['messages']){let _0xd74ffc=settings[_0x35c823(0x1b0)];newMessages=[];for(const _0xb3dbd8 of _0x5ec74a[_0x35c823(0x9a)]){newMessages['push'](_0xb3dbd8);let _0x2d5ef9=![];_0xb3dbd8['bbvNew']&&(updateSetting(_0x35c823(0x12d),_0xb3dbd8[_0x35c823(0x15f)]),_0x2d5ef9=isNewerVersion(serverversion,_0xb3dbd8[_0x35c823(0x15f)])||serverversion==_0xb3dbd8[_0x35c823(0x15f)]);if(!_0x2d5ef9&&_0xb3dbd8['number']>_0xd74ffc){if(_0xb3dbd8[_0x35c823(0x218)]==='any'||serverversion[_0x35c823(0x26f)](_0xb3dbd8[_0x35c823(0x218)])){let _0x368a40=''+_0xb3dbd8['title']+'\x0a\x0a'+_0xb3dbd8[_0x35c823(0x1f1)];const _0x25a2fd=await sendTelegramMsg(toTelegramMarkdown(_0x368a40),_0x35c823(0x1c1));if(_0x25a2fd)_0xd74ffc=_0xb3dbd8[_0x35c823(0x150)];}}}updateAvailable=isNewerVersion(settings[_0x35c823(0x12d)],serverversion),updateSetting(_0x35c823(0x1b0),_0xd74ffc),emitMessages();}}function emitMessages(){const _0x288fc4=_0x1131a9,_0x1278c1=settings[_0x288fc4(0x1f9)];let _0x508fff=[];newMessages[_0x288fc4(0x10a)](_0x33526d=>{const _0x2fe769=_0x288fc4;_0x33526d[_0x2fe769(0x150)]>_0x1278c1&&_0x508fff[_0x2fe769(0x265)](_0x33526d);}),_0x508fff[_0x288fc4(0x1c2)]>0x0&&getAllClients()[_0x288fc4(0x10a)](_0x645c12=>{const _0x4eeaee=_0x288fc4;getSocket(_0x645c12['id'])[_0x4eeaee(0x1b1)](_0x4eeaee(0x1f1),_0x508fff);});}function confirmMessage(_0x206a62){const _0x4b8b14=_0x1131a9;updateSetting(_0x4b8b14(0x1f9),Number(_0x206a62));}function isNewerVersion(_0xd773a1,_0x34c5de){const _0x4e8f5e=_0x1131a9,_0x2a9559=_0x34c5de[_0x4e8f5e(0xd7)]('.'),_0x1df535=_0xd773a1['split']('.');for(var _0x864f0a=0x0;_0x864f0a<_0x1df535[_0x4e8f5e(0x1c2)];_0x864f0a++){const _0x22d76b=~~_0x1df535[_0x864f0a],_0x5543d6=~~_0x2a9559[_0x864f0a];if(_0x22d76b>_0x5543d6)return!![];if(_0x22d76b<_0x5543d6)return![];}return![];}function toTelegramMarkdown(_0x25fe30){const _0x3865ed=_0x1131a9,_0x2bb94b=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x16ee79=/\*{2}(.+?)\*{2}/gim;return _0x25fe30=_0x25fe30[_0x3865ed(0xdf)](_0x2bb94b,'$1_$2_$3')[_0x3865ed(0xdf)](_0x16ee79,'*$1*'),_0x25fe30;}async function validateConfigFile(){const _0x39a12d=_0x1131a9,_0x137490=dbConfig[_0x39a12d(0xe8)](_0x39a12d(0x141))[_0x39a12d(0x260)](_0x39a12d(0x1a0))['value']()||[];if(_0x137490[_0x39a12d(0x1c2)]==0x0){let _0x1bc748=0x0,_0x203044=[];const _0x2e0402=/^bot-([0-9]{3})-config.json$/,_0x394a3f=fs['readdirSync'](configpath);_0x394a3f['forEach'](_0x50617b=>{const _0x397698=_0x39a12d,_0x52a6c4=_0x2e0402[_0x397698(0xe7)](_0x50617b);if(_0x52a6c4){const _0x1cfaf8=_0x52a6c4[0x1];let _0x23dc46=getBotAttributes(_0x1cfaf8);_0x203044['push']({'botID':_0x1cfaf8,'botname':_0x23dc46[_0x397698(0x1b4)],'status':_0x397698(0x258),'live':_0x397698(0x221)}),_0x1bc748++;}}),_0x1bc748!=0x0&&(dbConfig[_0x39a12d(0xe8)](_0x39a12d(0x141))['assign'](_0x203044)[_0x39a12d(0x1a9)](),config=_0x203044,restoredConfigFile=_0x1bc748);}}async function restoreConfigNotify(_0xbc7a02){const _0x117133=_0x1131a9;let _0x2c7d21;if(restoredConfigFile==0x1)_0x2c7d21=_0x117133(0x10e);else _0x2c7d21='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0xbc7a02)io['to']('botmanager')[_0x117133(0x1b1)](_0x117133(0xd1),_0x2c7d21);else{logger[_0x117133(0x262)](_0x117133(0xe0)),logger[_0x117133(0x262)](_0x2c7d21),logger[_0x117133(0x262)](_0x117133(0xe0)),logger[_0x117133(0x262)]('');if(tgBot&&settings[_0x117133(0x240)]&&settings[_0x117133(0xdb)]!=_0x117133(0x19a))await sendTelegram(settings[_0x117133(0x240)],_0x117133(0xa1)+_0x2c7d21);}}function validateCredentials(_0x252599,_0x37f75b){const _0x3032e2=_0x1131a9;if(_0x252599[_0x3032e2(0xf8)]==settings['bbUsername']&&bcrypt[_0x3032e2(0x24b)](_0x252599['password'],settings[_0x3032e2(0x144)])){if(settings[_0x3032e2(0x1ef)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x4e3d70=generateLoginToken(_0x37f75b);return{'allow':!![],'reason':_0x3032e2(0xe6),'token':_0x4e3d70};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x5429db){const _0x3bd011=_0x1131a9,_0x19a8a7=generateLoginToken(_0x5429db);return{'allow':!![],'reason':_0x3bd011(0xe6),'token':_0x19a8a7};}function validateAccess(_0x30ef6e,_0x14eabf,_0x18c122){const _0x59790b=_0x1131a9,_0x11ac74=_0x18c122?_0x18c122:devices[_0x14eabf]['ip'];let _0x539c62;const _0x350431=_0x566db1=>{const _0x42320e=_0xc092;if(settings[_0x42320e(0x1ff)]){if(settings[_0x42320e(0x1ef)]){if(telegram2FaApproved(_0x14eabf)){const _0x5167cf=generateLoginToken(_0x14eabf);return{'allow':!![],'reason':_0x42320e(0x1ca),'token':_0x5167cf};}else return{'allow':![],'reason':_0x42320e(0xe4),'token':null};}else return _0x539c62=validToken(_0x566db1,_0x14eabf),_0x539c62[_0x42320e(0xed)](_0x42320e(0x190))?{'allow':!![],'reason':_0x42320e(0x277),'token':_0x566db1}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x42320e(0xbe),'token':null};};if(settings['whitelistEnabled']){let _0x158062=[...settings[_0x59790b(0x157)],'::1',_0x59790b(0x18b),_0x59790b(0xcc)];if(_0x158062[_0x59790b(0x1ea)](_0x11ac74))return _0x350431(_0x30ef6e);else{_0x539c62=validToken(_0x30ef6e,_0x14eabf);if(_0x539c62[_0x59790b(0xed)](_0x59790b(0x190)))return _0x350431(_0x30ef6e);else{if(telegramIpApproved(_0x14eabf)){const _0x9eaaad=generateToken(_0x14eabf);return _0x539c62=_0x350431(_0x30ef6e),_0x539c62[_0x59790b(0x1bd)]?{'allow':!![],'reason':_0x59790b(0x12f),'token':_0x9eaaad}:_0x539c62;}else return settings[_0x59790b(0x1ec)]?{'allow':![],'reason':_0x59790b(0x159),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x350431(_0x30ef6e);}function timelyDecrypt(_0x3349b9,_0x13e047=!![]){const _0x2908ab=_0x1131a9;if(_0x3349b9)try{const _0x17e1f7=crypt['decrypt'](secure[_0x2908ab(0x1ba)],_0x3349b9)[_0x2908ab(0x1f1)],_0x5cb76e=_0x17e1f7[_0x2908ab(0xd7)]('@')[0x0],_0x4351ed=_0x17e1f7[_0x2908ab(0xd7)]('@')[0x1],_0x2adac3=new Date()[_0x2908ab(0x194)]();if(_0x13e047){if(_0x2adac3-_0x4351ed<maxSecretAge*0x3e8)return _0x5cb76e;else return![];}else return _0x5cb76e;}catch(_0x5a056f){return![];}else return![];}const validToken=(_0x434c46,_0x4bef73)=>{const _0x5a9ba0=_0x1131a9,_0x5f38ea=devices[_0x4bef73]['ip'];if(!_0x434c46)return{'error':_0x5a9ba0(0x1f3)};for(let _0x4da2b8 of blacklist){if(_0x4da2b8[_0x5a9ba0(0x271)]==_0x434c46)return{'error':_0x5a9ba0(0x196)};}let _0x2c5bda;try{_0x2c5bda=jwt[_0x5a9ba0(0x8d)](_0x434c46,secure[_0x5a9ba0(0x20c)]+_0x4bef73);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x2c5bda['hasOwnProperty'](_0x5a9ba0(0x279))&&!_0x2c5bda[_0x5a9ba0(0xed)](_0x5a9ba0(0xf8))||!_0x2c5bda[_0x5a9ba0(0xed)](_0x5a9ba0(0x165)))return{'error':_0x5a9ba0(0x23c)};if(!_0x2c5bda['hasOwnProperty'](_0x5a9ba0(0xf8))&&_0x2c5bda[_0x5a9ba0(0xed)]('clientip')){const {clientip:_0x5114f7}=_0x2c5bda;return _0x5f38ea==_0x5114f7?{'success':_0x5a9ba0(0x1c7)}:{'error':_0x5a9ba0(0x25f)};}else{if(_0x2c5bda['hasOwnProperty'](_0x5a9ba0(0xf8))&&_0x2c5bda[_0x5a9ba0(0xed)]('clientip')){const {username:_0x3d45ca,clientip:_0x10f16f}=_0x2c5bda;return settings[_0x5a9ba0(0xf9)]==_0x3d45ca&&_0x5f38ea==_0x10f16f?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x5a9ba0(0xc4)};}}},generateLoginToken=_0x6f3f2e=>{const _0x547380=_0x1131a9;if(_0x6f3f2e){const _0xd60ef4=devices[_0x6f3f2e]['ip'];return jwt[_0x547380(0x122)]({'username':settings['bbUsername'],'clientip':_0xd60ef4},secure[_0x547380(0x20c)]+_0x6f3f2e,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x581cb0=>{const _0x3d0fba=_0x1131a9;if(_0x581cb0){const _0x25a3d2=devices[_0x581cb0]['ip'];return jwt[_0x3d0fba(0x122)]({'clientip':_0x25a3d2},secure[_0x3d0fba(0x20c)]+_0x581cb0,{'expiresIn':devices[_0x581cb0]['telegramIpApproval'][_0x3d0fba(0x16a)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x2a90ca=>{const _0x1abbd4=_0x1131a9;let _0x131830=![];return devices[_0x2a90ca][_0x1abbd4(0x227)]&&devices[_0x2a90ca][_0x1abbd4(0x227)]['expiry']!='reject'&&(_0x131830=devices[_0x2a90ca][_0x1abbd4(0x227)]['clientip']==devices[_0x2a90ca]['ip']&&new Date()['getTime']()-devices[_0x2a90ca]['telegramIpApproval']['timestamp']<devices[_0x2a90ca][_0x1abbd4(0x227)][_0x1abbd4(0x16a)]*0x3c*0x3e8),_0x131830;},telegram2FaApproved=_0x52503c=>{const _0xdb6367=_0x1131a9;let _0x19a787=![];return devices[_0x52503c][_0xdb6367(0x1ee)]&&devices[_0x52503c][_0xdb6367(0x1ee)][_0xdb6367(0x16a)]!=_0xdb6367(0x20d)&&(_0x19a787=devices[_0x52503c][_0xdb6367(0x1ee)][_0xdb6367(0x279)]==devices[_0x52503c]['ip']&&new Date()[_0xdb6367(0x194)]()-devices[_0x52503c][_0xdb6367(0x1ee)]['timestamp']<devices[_0x52503c][_0xdb6367(0x1ee)][_0xdb6367(0x16a)]*0x3c*0x3e8),_0x19a787;},normalizeIP=_0xfdbc84=>{const _0x20f940=_0x1131a9;let _0x3b5fb0=null,_0x4829c0=null;if(ipaddr[_0x20f940(0x116)](_0xfdbc84)){const _0x7f1380=ipaddr['parse'](_0xfdbc84);_0x7f1380[_0x20f940(0x11b)]()===_0x20f940(0x14e)?(_0x7f1380[_0x20f940(0xe3)]()&&(_0x3b5fb0=_0x7f1380[_0x20f940(0x245)]()['toString']()),_0x4829c0=_0x7f1380['toString']()):(_0x3b5fb0=_0x7f1380[_0x20f940(0x1d4)](),_0x4829c0=_0x7f1380[_0x20f940(0xfc)]()['toString']());}return{'show':_0x3b5fb0?_0x3b5fb0:_0x4829c0,'store':_0x4829c0};};function formatDate(_0x42b489){const _0x478401=_0x1131a9;return _0x42b489['getFullYear']()+'/'+(_0x42b489[_0x478401(0x131)]()+0x1)[_0x478401(0x1d4)]()[_0x478401(0xbf)](0x2,'0')+'/'+_0x42b489[_0x478401(0x12b)]()['toString']()[_0x478401(0xbf)](0x2,'0')+'\x20'+_0x42b489[_0x478401(0xaa)]()[_0x478401(0x1d4)]()[_0x478401(0xbf)](0x2,'0')+':'+_0x42b489[_0x478401(0xaf)]()['toString']()['padStart'](0x2,'0')+':'+_0x42b489[_0x478401(0xc9)]()[_0x478401(0x1d4)]()[_0x478401(0xbf)](0x2,'0');}function sleep(_0x4f7cff){return new Promise(_0x2e795f=>setTimeout(_0x2e795f,_0x4f7cff));}