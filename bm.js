const _0x25c9ed=_0x36f7;(function(_0x4a2b45,_0xda4a56){const _0x48a1e2=_0x36f7,_0x1c2a0a=_0x4a2b45();while(!![]){try{const _0x2cff55=-parseInt(_0x48a1e2(0x27b))/0x1+parseInt(_0x48a1e2(0x1c7))/0x2*(parseInt(_0x48a1e2(0x2cf))/0x3)+-parseInt(_0x48a1e2(0x2b5))/0x4*(parseInt(_0x48a1e2(0x2e5))/0x5)+parseInt(_0x48a1e2(0x1da))/0x6+-parseInt(_0x48a1e2(0x23e))/0x7+parseInt(_0x48a1e2(0x27c))/0x8+-parseInt(_0x48a1e2(0x2a4))/0x9*(parseInt(_0x48a1e2(0x23c))/0xa);if(_0x2cff55===_0xda4a56)break;else _0x1c2a0a['push'](_0x1c2a0a['shift']());}catch(_0x58fe4f){_0x1c2a0a['push'](_0x1c2a0a['shift']());}}}(_0x5c59,0x9f8ef));const _0x3b1653=function(){let _0x5e352a=!![];return function(_0x365a2f,_0x403b69){const _0x22bad3=_0x5e352a?function(){const _0x563e45=_0x36f7;if(_0x403b69){const _0x44f832=_0x403b69[_0x563e45(0x2c6)](_0x365a2f,arguments);return _0x403b69=null,_0x44f832;}}:function(){};return _0x5e352a=![],_0x22bad3;};}(),_0x2c9bd3=_0x3b1653(this,function(){const _0x2c2c2a=_0x36f7;return _0x2c9bd3[_0x2c2c2a(0x293)]()['search']('(((.+)+)+)+$')[_0x2c2c2a(0x293)]()[_0x2c2c2a(0x22a)](_0x2c9bd3)[_0x2c2c2a(0x28b)](_0x2c2c2a(0x2df));});_0x2c9bd3();'use strict';process[_0x25c9ed(0x345)][_0x25c9ed(0x2f8)]=0x1;const childProcess=require(_0x25c9ed(0x241)),fs=require('fs'),fns=require(_0x25c9ed(0x1ba)),low=require('lowdb'),FileSync=require(_0x25c9ed(0x317)),path=require('path'),crypto=require(_0x25c9ed(0x32a)),Crypt=require(_0x25c9ed(0x255))['Crypt'],RSA=require(_0x25c9ed(0x255))[_0x25c9ed(0x2f9)],bcrypt=require(_0x25c9ed(0x23a)),jwt=require(_0x25c9ed(0x2d3)),ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process['argv'][_0x25c9ed(0x1e8)](0x2))['argv'],uuidRandom=require(_0x25c9ed(0x330)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require(_0x25c9ed(0x33b)),axios=require(_0x25c9ed(0x206)),{GraphQLClient,gql}=require(_0x25c9ed(0x258)),util=require('util'),fileUpload=require(_0x25c9ed(0x351)),PORT=argv['port']||_0x25c9ed(0x35c),pattern=/^[0-9]{2,4}$/;!pattern[_0x25c9ed(0x238)](PORT)&&(console[_0x25c9ed(0x1e2)](_0x25c9ed(0x363)+PORT+_0x25c9ed(0x1cc)),process[_0x25c9ed(0x22b)](0x1));const HOST=argv['host']||null,userID=argv['user']||'';let bbpath=_0x25c9ed(0x2ba),bbpath2='';const botfile=_0x25c9ed(0x342),configfile='bb-config.json',settingsfile='bb-settings.json',securefile='bb-secure.json';let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);function _0x36f7(_0x5c1bb3,_0x261a01){const _0x48b565=_0x5c59();return _0x36f7=function(_0x2c9bd3,_0x3b1653){_0x2c9bd3=_0x2c9bd3-0x1b3;let _0x5c59f9=_0x48b565[_0x2c9bd3];return _0x5c59f9;},_0x36f7(_0x5c1bb3,_0x261a01);}const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x25c9ed(0x32f)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x25c9ed(0x203),logspath=userID?bbpath+_0x25c9ed(0x1e0)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x25c9ed(0x279)+userID+'/':bbpath+'zip/',loggerfile=fs['createWriteStream'](logspath+_0x25c9ed(0x2ed),{'flags':'a'}),temppath=userID?bbpath+_0x25c9ed(0x284)+userID+'/':bbpath+'temp/';!fs[_0x25c9ed(0x357)](configpath)&&fs[_0x25c9ed(0x272)](configpath);!fs[_0x25c9ed(0x357)](configbackuppath)&&fs[_0x25c9ed(0x272)](configbackuppath);!fs[_0x25c9ed(0x357)](logspath)&&fs[_0x25c9ed(0x272)](logspath);!fs[_0x25c9ed(0x357)](zippath)&&fs[_0x25c9ed(0x272)](zippath);!fs['existsSync'](temppath)&&fs[_0x25c9ed(0x272)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x25c9ed(0x31d)]({'bots':[]})[_0x25c9ed(0x261)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x25c9ed(0x31d)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x25c9ed(0x216)}})[_0x25c9ed(0x261)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x25c9ed(0x31d)]({'secure':{},'blacklist':[]})[_0x25c9ed(0x261)]();let crypt=new Crypt({'md':_0x25c9ed(0x1f4),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x25c9ed(0x2e3)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x25c9ed(0x335)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x25c9ed(0x28d)]!=''&&settings['telegramUsername']&&settings[_0x25c9ed(0x230)]!='')initTelegram();const logger={'screen':_0x2e41d1=>{const _0x76571c=_0x25c9ed;console[_0x76571c(0x1e2)](_0x2e41d1);},'simple':_0x2e162a=>{const _0x2d9e8a=_0x25c9ed;console[_0x2d9e8a(0x1e2)](_0x2e162a),loggerfile[_0x2d9e8a(0x261)](util[_0x2d9e8a(0x33d)](_0x2e162a)+'\x0a');},'full':async _0x9f190=>{const _0x540ef7=_0x25c9ed,_0x15ed02=getTimeStamp()+_0x540ef7(0x211)+_0x9f190;console[_0x540ef7(0x1e2)](_0x15ed02),loggerfile['write'](util[_0x540ef7(0x33d)](_0x15ed02)+'\x0a');if(tgBot&&settings[_0x540ef7(0x247)]&&settings[_0x540ef7(0x1b6)]!=_0x540ef7(0x32e))await tgBot[_0x540ef7(0x273)](settings[_0x540ef7(0x247)],_0x540ef7(0x266)+_0x9f190)[_0x540ef7(0x2e6)](_0x1d3dca=>{telegramError(_0x1d3dca);});}};function _0x5c59(){const _0x3419ec=['test','Unauthorized\x20attempt\x20to\x20add\x20bot','bcryptjs','All\x20bots','10asmIha','number','370909peBxhP','http','size','child_process','title','warning','Unauthorized\x20attempt\x20to\x20confirm\x20message','/status\x20-\x20show\x20bot(s)\x20status\x0a','Unauthorized\x20attempt\x20to\x20store\x20configuration','telegramChatId','removeListener','Bot\x20','backup','find','Notifications\x20enabled\x0a','alias','handshake','Allow\x20login\x20from\x20IP\x20address\x20<b>','filter','Unauthorized\x20attempt\x20to\x20log\x20out','place-order','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','bbvReceive','hybrid-crypto-js','Restoring\x20bot(s)\x20from\x20backup','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','graphql-request','readFileSync','sort','bb-settings.json','reject','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','callback_query','keys','username','write','getPortfolio','restart','::1','/download/:type','Bot\x20Mgr\x20>\x20','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','password','/restart\x20-\x20restart\x20bot(s)\x0a','/disable\x20-\x20disable\x20notifications\x0a','remoteAddress','messages','stop','botmanager','User\x20has\x20been\x20validated','Orders','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','mkdirSync','sendMessage','\x20(1)','bot-','botID','settings','generate','zip/','any','109138qSMSfY','6810928TZUgzi','Unauthorized\x20attempt\x20to\x20show\x20configuration','logs','secure','temporary\x20token\x20generated','getFullYear','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Login\x20accepted','temp/','/off\x20-\x20stop\x20bot(s)\x0a','$1_$2_$3','restarting\x20Bot\x20','function','All\x20bots\x20running\x20right\x20now','index.html','search','login\x20not\x20required','telegramToken','Notifications\x20disabled\x0a','starting\x20bot\x20|\x20Bot\x20','getUTCHours','File\x20uploaded','Login\x20rejected','toString','new-disabled','add-bot','add','sendFile','name','Unauthorized\x20attempt\x20to\x20download\x20','update-bot','manual','\x20mode','build','once','reason','Notifications\x20enabled','unlinkSync','version.json','max','5218614KqSzdc','exp','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','parse','sign','uuid','Yes','download','DEFLATE','version','split','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','type','Unauthorized\x20attempt\x20to\x20update\x20bot','copyFileSync','output-002.log','Starting\x20Balance\x20Bot\x20update','40Pxkmig','2FA\x20login\x20required','bbUsername','enabled','disabled\x20Bot\x20','bb/','SIGINT','toggleBotMode','verify','ipc','listen','bots','hashSync','generateKeyPairAsync','stopped','apiSecret','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','apply','/:bot/portfolio','output-003.log','auth','Password\x20has\x20been\x20reset\x20to:\x20','invalid\x20credentials','https://api.ipify.org?format=json','replace','sendPortfolioTelegram','438177DiACUB','getSeconds','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Ok,\x20will\x20send\x20order\x20notifications\x20only','jsonwebtoken','allow','encryptedUuid','inherit','match','-events.json','removeAllListeners','/enable\x20-\x20enable\x20notifications\x0a','5\x20min','backupfile','use','forEach','(((.+)+)+)+$','Token\x20blacklisted','Unauthorized\x20attempt\x20to\x20get\x20messages','127.0.0.1','init','kill','503665pRJRFn','catch','2FA','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','login','/help\x20-\x20show\x20available\x20commands\x0a','getDate','blacklist','/output-000.log','logout','publicKey','writeFileSync','map','getMonth','live','/:bot/coins','kind','botname','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','NTBA_FIX_319','RSA','sortBy','store-headless','send','HTML','pidExpireLogin','/:bot/history','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','files','All','show','Unauthorized\x20attempt\x20to\x20update\x20settings','answerCallbackQuery','data','Failed\x20to\x20download\x20','disabled','telegramIpApproval','auto','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','temporary\x20access\x20rejected','idling\x20bot\x20\x20\x20|\x20Bot\x20','initclient','/:bot/support','pidRefreshToken','showConfig','lastmsgemitted','::ffff:127.0.0.1','telegramEnabled','lowdb/adapters/FileSync','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','cancel-loading','all','confirm-message','entries','defaults','decrypt','conn','stopPolling','get-messages','2FA\x20login\x20token\x20generated','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','access\x20timeout','stringify','file','\x20|\x20','join','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','crypto','-performance.json','token','userid','orders','clients','uuid-random','-results.json','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','getMinutes','logged\x20out','api-eu.mixpanel.com','settings.','remove','get-portfolio','accept','startsWith','mixpanel','bbPassword','format','privateKey','Unauthorized\x20login\x20attempt\x20(timeout)','get-starting-balances','hex','bot.js','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Ok,\x20will\x20send\x20alert\x20notifications\x20only','env','SIGTERM','output-001.log','Invalid\x20Telegram\x20token','telegram','reload','f2aRequired','expiry','loginRequired','\x20>\x20','starting\x20new\x20bot\x20|\x20Bot\x20','store','express-fileupload','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','event','No\x20authentication\x20token','hasOwnProperty','secret','existsSync','mode','running','get','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','3000','alerts','isIPv4MappedAddress','min','update-bb','getStartingBalances','post','Error:\x20Invalid\x20argument\x20','set','then','referer','Notifications\x20types:\x20','node-zip','\x20only\x0a','telegramEvents','binary','_data','2FA\x20required','date-fns','padStart','404\x20Not\x20Found','telegrammsg','full','access','Access\x20enabled\x20for\x20','/upload-backup','static','getHours','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','get-logs','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','4LvzhbN','simple','connected','tkn','enabled\x20Bot\x20',',\x20must\x20be\x20a\x204\x20digit\x20number','socket','/:bot/performance','push','login\x20required','timeshift','disconnect','store-settings','toIPv4MappedAddress','args','success','new','message','telegram2FaApproval','7556208sHUQpk','connection','emitHistory','\x20(2)','temporaryAccessAllowed','***','logs/','getTime','log','error\x20while\x20deleting\x20config\x20files:\x20','latestversion','2FA\x20login\x20rejected','request','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','slice','lastmsgtelegram','login\x20token\x20valid','bbvNew','Unauthorized\x20attempt\x20to\x20delete\x20bot','whitelistEnabled','polling_error','Alerts','headers','socket.io','includes','Restore\x20process\x20aborted','sha256','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','************','cloneDeep','Your\x20installation\x20is\x20already\x20up\x20to\x20date','show-config','headless','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','order','deleteHistoryAlerts','temporary\x20access\x20timeout','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','value','build2','/:bot/configuration','backup/','/:bot','bot','axios','assign','error','Invalid\x20username\x20or\x20IP\x20address','\x20minutes','login\x20token\x20generated','/on\x20-\x20start\x20bot(s)\x0a','</b>\x20?','chat','apiKey','timestamp',':\x20Bot\x20Mgr\x20>\x20','from','sockets','statSync','server','0.0.0','Temporary\x20access\x20rejected','rmSync','clientip','compareSync','isDirectory','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','onText','exchange','/update\x20-\x20update\x20Balance\x20Bot\x0a','params','randomFillSync','No\x20bots\x20running\x20right\x20now','\x20to\x20','length','readdirSync','-config.json','-----------------------------------------------------------------------------------','emit','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','constructor','exit','cancelLoading','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Password\x20reset\x20rejected','started','telegramUsername','createServer','status','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','whitelist','*$1*','yes','notification'];_0x5c59=function(){return _0x3419ec;};return _0x5c59();}process['on']('uncaughtException',function(_0x552da9){const _0x2d75a4=_0x25c9ed;logger[_0x2d75a4(0x1c8)](_0x552da9);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x25c9ed(0x2a2))[_0x25c9ed(0x2ad)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x25c9ed(0x23f))[_0x25c9ed(0x231)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x25c9ed(0x35a)](_0x25c9ed(0x265),async(_0x7d76be,_0x5a6a18)=>{const _0x3764b3=_0x25c9ed,_0x378e80=_0x7d76be[_0x3764b3(0x220)][_0x3764b3(0x2b0)],_0xbec487=getClientsWithBotID('botmanager'),_0x96a644=_0x7d76be[_0x3764b3(0x1f0)][_0x3764b3(0x2a9)],_0x4b7c9b=timelyDecrypt(_0x96a644,![]),_0x51c03d=_0xbec487['find'](_0x29a72a=>_0x29a72a[_0x3764b3(0x2a9)]==_0x4b7c9b);if(_0x51c03d){const _0x54215d=normalizeIP(_0x7d76be[_0x3764b3(0x1cd)][_0x3764b3(0x26b)])[_0x3764b3(0x350)],_0x5ae097=_0x7d76be['headers']['tkn'];if(validateAccess(_0x5ae097,_0x4b7c9b,_0x54215d)['allow'])await zipFiles(_0x378e80),_0x5a6a18[_0x3764b3(0x2ab)](zippath+(_0x378e80+'.zip'),_0x5df234=>{const _0x52a4ed=_0x3764b3;_0x5df234&&(logger[_0x52a4ed(0x1be)](_0x52a4ed(0x309)+_0x378e80),logger[_0x52a4ed(0x1c8)](_0x5df234));});else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x378e80+_0x3764b3(0x274));}else logger[_0x3764b3(0x1be)](_0x3764b3(0x299)+_0x378e80+_0x3764b3(0x1dd));}),app[_0x25c9ed(0x362)](_0x25c9ed(0x1c1),async(_0x5196ae,_0x4c37d9)=>{const _0x1437ba=_0x25c9ed,_0x9667e5=getClientsWithBotID(_0x1437ba(0x26e)),_0x132275=_0x5196ae[_0x1437ba(0x1f0)][_0x1437ba(0x2a9)],_0x438460=timelyDecrypt(_0x132275,![]),_0x57112d=_0x9667e5[_0x1437ba(0x24b)](_0x252bd4=>_0x252bd4[_0x1437ba(0x2a9)]==_0x438460);if(_0x57112d){const _0x2951de=normalizeIP(_0x5196ae[_0x1437ba(0x1cd)][_0x1437ba(0x26b)])[_0x1437ba(0x350)],_0x461219=_0x5196ae[_0x1437ba(0x1f0)][_0x1437ba(0x1ca)];if(validateAccess(_0x461219,_0x438460,_0x2951de)[_0x1437ba(0x2d4)]){if(_0x5196ae[_0x1437ba(0x303)]){const _0x30c3e2=_0x5196ae[_0x1437ba(0x303)][_0x1437ba(0x2dc)];await _0x30c3e2['mv'](temppath+_0x30c3e2[_0x1437ba(0x298)]),_0x4c37d9['send']({'status':!![],'message':_0x1437ba(0x291)});const _0x24f17f=getBotsWithMode();_0x24f17f[_0x1437ba(0x224)]>0x0?confirmRestore(temppath,_0x30c3e2['name']):unzipFile(temppath,_0x30c3e2[_0x1437ba(0x298)]);}}else logger[_0x1437ba(0x1be)](_0x1437ba(0x21c));}else logger[_0x1437ba(0x1be)](_0x1437ba(0x318));}),app[_0x25c9ed(0x2dd)](express['static'](path[_0x25c9ed(0x328)](__dirname,bbpath2,_0x25c9ed(0x201)))),app[_0x25c9ed(0x2dd)](express[_0x25c9ed(0x1c2)](path[_0x25c9ed(0x328)](__dirname,bbpath2,'build'))),app[_0x25c9ed(0x35a)]('/',function(_0x2ffb09,_0x55d1d9){const _0x3c446a=_0x25c9ed;_0x55d1d9[_0x3c446a(0x297)](path['join'](__dirname,bbpath2,'build2',_0x3c446a(0x28a)));}),app[_0x25c9ed(0x35a)](_0x25c9ed(0x204),function(_0x2a2275,_0x2083ef){const _0x1f400b=_0x25c9ed;_0x2083ef[_0x1f400b(0x297)](path[_0x1f400b(0x328)](__dirname,bbpath2,_0x1f400b(0x29d),_0x1f400b(0x28a)));}),app['get'](_0x25c9ed(0x2c7),(_0x47cf5c,_0x5769b0)=>{const _0x314055=_0x25c9ed;_0x5769b0[_0x314055(0x297)](path[_0x314055(0x328)](__dirname,bbpath2,_0x314055(0x29d),_0x314055(0x28a)));}),app['get'](_0x25c9ed(0x1ce),(_0x5b59f7,_0x5bca52)=>{const _0x315743=_0x25c9ed;_0x5bca52[_0x315743(0x297)](path[_0x315743(0x328)](__dirname,bbpath2,_0x315743(0x29d),'index.html'));}),app[_0x25c9ed(0x35a)](_0x25c9ed(0x2f4),(_0x2e664e,_0x5a49e8)=>{const _0x3891b1=_0x25c9ed;_0x5a49e8[_0x3891b1(0x297)](path[_0x3891b1(0x328)](__dirname,bbpath2,_0x3891b1(0x29d),_0x3891b1(0x28a)));}),app['get'](_0x25c9ed(0x2ff),(_0x4c8b07,_0x58728b)=>{const _0x162ab6=_0x25c9ed;_0x58728b[_0x162ab6(0x297)](path[_0x162ab6(0x328)](__dirname,bbpath2,_0x162ab6(0x29d),_0x162ab6(0x28a)));}),app['get'](_0x25c9ed(0x202),(_0x5d3e1d,_0x2bb407)=>{const _0x3c0364=_0x25c9ed;_0x2bb407['sendFile'](path['join'](__dirname,bbpath2,_0x3c0364(0x29d),_0x3c0364(0x28a)));}),app[_0x25c9ed(0x35a)](_0x25c9ed(0x311),(_0xe74d93,_0x3c74c0)=>{const _0x5b8248=_0x25c9ed;_0x3c74c0[_0x5b8248(0x297)](path[_0x5b8248(0x328)](__dirname,bbpath2,_0x5b8248(0x29d),_0x5b8248(0x28a)));});if(HOST)http[_0x25c9ed(0x2bf)](PORT,HOST);else http[_0x25c9ed(0x2bf)](PORT);const io=require(_0x25c9ed(0x1f1))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x205ae4=_0x25c9ed;logger[_0x205ae4(0x1c8)](''),logger[_0x205ae4(0x1c8)](_0x205ae4(0x227)),await logger[_0x205ae4(0x1be)]('Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:'+PORT),logger[_0x205ae4(0x1c8)]('-----------------------------------------------------------------------------------');if(config['length']!=0x0)for(const _0x579241 of config){if(_0x579241['status']==_0x205ae4(0x2b8)||_0x579241[_0x205ae4(0x232)]==_0x205ae4(0x1d7))await logger['full'](_0x205ae4(0x28f)+_0x579241[_0x205ae4(0x276)]+'\x20|\x20'+_0x579241[_0x205ae4(0x2f6)]),startBot([_0x579241[_0x205ae4(0x276)],userID],{'cwd':bbpath},function(_0x286937){const _0x1e4d68=_0x205ae4;if(_0x286937)logger[_0x1e4d68(0x1be)](_0x286937);});else(_0x579241[_0x205ae4(0x232)]==_0x205ae4(0x30a)||_0x579241[_0x205ae4(0x232)]==_0x205ae4(0x294))&&await logger[_0x205ae4(0x1be)](_0x205ae4(0x30f)+_0x579241['botID']+_0x205ae4(0x327)+_0x579241[_0x205ae4(0x2f6)]);}else!newBot&&logger[_0x205ae4(0x1c8)](_0x205ae4(0x332));if(newBot)addBot();logger[_0x205ae4(0x1c8)](_0x205ae4(0x227)),logger[_0x205ae4(0x1c8)]('');}function startSocket(){const _0x44e438=_0x25c9ed;io['on'](_0x44e438(0x1db),_0x452fef=>{const _0x2dd11c=_0x44e438;let _0x4b683d,_0x2c02d4,_0x3e44c5,_0x1277fd,_0xb9209a;const _0x449c16=_0x452fef[_0x2dd11c(0x24e)][_0x2dd11c(0x1f0)][_0x2dd11c(0x366)];_0x2c02d4=_0x449c16[_0x2dd11c(0x2d7)](/bot[0-9]{3}/);if(_0x2c02d4)_0x3e44c5=_0x2c02d4[0x0][_0x2dd11c(0x2d7)](/[0-9]{3}/);if(_0x3e44c5)_0x4b683d=_0x3e44c5[0x0];else _0x4b683d='botmanager';const _0x165b12=_0x452fef[_0x2dd11c(0x24e)][_0x2dd11c(0x2c9)][_0x2dd11c(0x2d5)];if(!_0x165b12)_0x452fef[_0x2dd11c(0x228)]('status',{'publicKey':secure['publicKey']});else{_0x1277fd=timelyDecrypt(_0x165b12,![]);if(!_0x1277fd)_0x452fef[_0x2dd11c(0x228)](_0x2dd11c(0x232),{'publicKey':secure[_0x2dd11c(0x2ef)]});else{_0xb9209a=normalizeIP(_0x452fef[_0x2dd11c(0x31f)]['remoteAddress'])[_0x2dd11c(0x350)];if(!devices[_0x1277fd])devices[_0x1277fd]={'uuid':_0x1277fd,'access':{'token':null}};devices[_0x1277fd]['ip']=_0xb9209a;const _0x72081c=addClient(_0x452fef['id'],_0x1277fd,_0x4b683d);setAccess(_0x72081c),emitMessages(),_0x452fef['on'](_0x2dd11c(0x2e9),_0x58c25c=>{const _0x3dc7e9=_0x2dd11c,_0x37c101=timelyDecrypt(_0x58c25c['password']);if(_0x37c101){_0x58c25c={'username':_0x58c25c[_0x3dc7e9(0x260)],'password':_0x37c101},devices[_0x1277fd]['access']=validateCredentials(_0x58c25c,_0x1277fd);if(devices[_0x1277fd][_0x3dc7e9(0x1bf)][_0x3dc7e9(0x2d4)]==![]&&devices[_0x1277fd]['access'][_0x3dc7e9(0x29f)]==_0x3dc7e9(0x2b6))_0x452fef[_0x3dc7e9(0x228)](_0x3dc7e9(0x232),{'access':devices[_0x1277fd][_0x3dc7e9(0x1bf)]}),loginAccess2FA(_0x1277fd,_0xb9209a);else{if(devices[_0x1277fd][_0x3dc7e9(0x1bf)][_0x3dc7e9(0x2d4)]==![]&&devices[_0x1277fd][_0x3dc7e9(0x1bf)][_0x3dc7e9(0x29f)]=='invalid\x20credentials')_0x452fef[_0x3dc7e9(0x228)]('status',{'access':devices[_0x1277fd][_0x3dc7e9(0x1bf)]});else devices[_0x1277fd][_0x3dc7e9(0x1bf)][_0x3dc7e9(0x2d4)]&&devices[_0x1277fd]['access'][_0x3dc7e9(0x29f)]==_0x3dc7e9(0x20b)&&(getClientsWithUuid(_0x1277fd)[_0x3dc7e9(0x2de)](_0x1c6135=>{setAccess(_0x1c6135);}),setTokenRefresh(_0x1277fd),setSessionTimeout(_0x3dc7e9(0x2e9),_0x1277fd));}}else logger[_0x3dc7e9(0x1be)](_0x3dc7e9(0x33f));}),_0x452fef['on']('reset-password',()=>{resetPassword();}),_0x452fef['on'](_0x2dd11c(0x1d2),_0x385b16=>{removeClient(_0x452fef['id']);}),_0x4b683d==_0x2dd11c(0x26e)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x253eea){const _0x4535d2=_0x25c9ed;if(_0x253eea!=_0x4535d2(0x26e)&&config['apiKey']!=''){if(pid[_0x253eea])pid[_0x253eea][_0x4535d2(0x2fc)]({'function':_0x4535d2(0x310),'args':null});}}function reloadBotManager(){getClientsWithBotID('botmanager')['forEach'](_0x5cfed9=>{const _0x227470=_0x36f7;getSocket(_0x5cfed9['id'])[_0x227470(0x228)](_0x227470(0x232),{'access':{'allow':![],'reason':_0x227470(0x34a),'token':null}});});}function getSocket(_0x15a406){const _0x452529=_0x25c9ed;return io[_0x452529(0x213)]['sockets'][_0x452529(0x35a)](_0x15a406);}function setAccess(_0x5c5b2d){const _0x416fb7=_0x25c9ed,_0x3afb2e=getSocket(_0x5c5b2d['id']),_0x145fff=_0x5c5b2d[_0x416fb7(0x2a9)],_0x3dc79d=_0x5c5b2d[_0x416fb7(0x205)];devices[_0x145fff][_0x416fb7(0x1bf)]=validateAccess(devices[_0x145fff]['access']['token'],_0x145fff),_0x3afb2e[_0x416fb7(0x328)](_0x145fff);if(devices[_0x145fff]['access'][_0x416fb7(0x2d4)]){_0x3afb2e[_0x416fb7(0x328)](_0x3dc79d);if(_0x3dc79d==_0x416fb7(0x26e))initializeSocketBotManager(_0x3afb2e);else initializeSocketBot(_0x3afb2e);initClient(_0x3dc79d);}devices[_0x145fff][_0x416fb7(0x1bf)][_0x416fb7(0x32c)]&&devices[_0x145fff]['access'][_0x416fb7(0x29f)]==_0x416fb7(0x280)&&setSessionTimeout(_0x416fb7(0x2e7),_0x145fff),devices[_0x145fff][_0x416fb7(0x1bf)]['token']&&devices[_0x145fff][_0x416fb7(0x1bf)][_0x416fb7(0x29f)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x416fb7(0x2e9),_0x145fff),_0x3afb2e[_0x416fb7(0x228)](_0x416fb7(0x232),{'status':_0x5c5b2d[_0x416fb7(0x215)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x145fff][_0x416fb7(0x1bf)],'externalip':devices[_0x145fff]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x416fb7(0x32d)],'validInstallation':validInstallation}),devices[_0x145fff]['access'][_0x416fb7(0x2d4)]==![]&&devices[_0x145fff][_0x416fb7(0x1bf)][_0x416fb7(0x29f)]==_0x416fb7(0x1b9)&&temporaryAccess2FA(_0x145fff,devices[_0x145fff]['ip']);}function setSessionTimeout(_0x3b7225,_0xc23fe8){const _0x34145b=_0x25c9ed;let _0x24d4b6;if(_0x3b7225==_0x34145b(0x2e9))_0x24d4b6=loginExpiry*0x3c*0x3e8;else _0x24d4b6=devices[_0xc23fe8][_0x34145b(0x30b)]['expiry']*0x3c*0x3e8-(new Date()[_0x34145b(0x1e1)]()-devices[_0xc23fe8]['telegramIpApproval']['timestamp']);if(devices[_0xc23fe8][_0x34145b(0x2fe)])clearTimeout(devices[_0xc23fe8][_0x34145b(0x2fe)]);devices[_0xc23fe8][_0x34145b(0x2fe)]=setTimeout(()=>{const _0x22b0b1=_0x34145b;if(devices[_0xc23fe8][_0x22b0b1(0x312)])clearTimeout(devices[_0xc23fe8][_0x22b0b1(0x312)]);removeSocketListeners(_0xc23fe8),addBlacklist(_0xc23fe8),devices[_0xc23fe8]['telegramIpApproval']=null,devices[_0xc23fe8][_0x22b0b1(0x1d9)]=null,devices[_0xc23fe8][_0x22b0b1(0x1bf)][_0x22b0b1(0x32c)]=null,devices[_0xc23fe8][_0x22b0b1(0x1bf)]=validateAccess(devices[_0xc23fe8]['access'][_0x22b0b1(0x32c)],_0xc23fe8),!(devices[_0xc23fe8][_0x22b0b1(0x1bf)][_0x22b0b1(0x2d4)]&&devices[_0xc23fe8]['access'][_0x22b0b1(0x29f)]==_0x22b0b1(0x28c))&&(_0x3b7225==_0x22b0b1(0x2e9)?io['to'](_0xc23fe8)[_0x22b0b1(0x228)](_0x22b0b1(0x232),{'access':{'allow':![],'reason':_0x22b0b1(0x324),'token':null}}):io['to'](_0xc23fe8)[_0x22b0b1(0x228)]('status',{'access':{'allow':![],'reason':_0x22b0b1(0x1fe),'token':null}})),devices[_0xc23fe8][_0x22b0b1(0x1bf)][_0x22b0b1(0x32c)]=null;},_0x24d4b6);}function setTokenRefresh(_0x8a9ce5){const _0x495bf9=_0x25c9ed;if(devices[_0x8a9ce5][_0x495bf9(0x312)])clearTimeout(devices[_0x8a9ce5][_0x495bf9(0x312)]);devices[_0x8a9ce5][_0x495bf9(0x312)]=setTimeout(()=>{const _0x8b6ee9=_0x495bf9;getClientsWithUuid(_0x8a9ce5)[_0x8b6ee9(0x224)]!=0x0?(devices[_0x8a9ce5][_0x8b6ee9(0x1bf)]=refreshToken(_0x8a9ce5),io['to'](_0x8a9ce5)[_0x8b6ee9(0x228)](_0x8b6ee9(0x232),{'status':_0x8b6ee9(0x1c9),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x8a9ce5]['access'],'externalip':devices[_0x8a9ce5]['ip'],'publicKey':secure[_0x8b6ee9(0x2ef)],'validInstallation':validInstallation}),setTokenRefresh(_0x8a9ce5)):clearTimeout(devices[_0x8a9ce5]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x18168e){const _0x19017c=_0x25c9ed,_0x354b2b=getClient(_0x18168e['id'])['uuid'];_0x18168e[_0x19017c(0x228)](_0x19017c(0x2c0),config),_0x18168e[_0x19017c(0x228)](_0x19017c(0x277),cleanSettings()),_0x18168e['on'](_0x19017c(0x295),_0x8ed240=>{const _0x431495=_0x19017c;if(validateAccess(_0x8ed240,_0x354b2b)['allow'])addBot();else logger[_0x431495(0x1be)](_0x431495(0x239));}),_0x18168e['on'](_0x19017c(0x29a),(_0x8bcdb4,_0x5607fa)=>{const _0x489c4f=_0x19017c;if(validateAccess(_0x5607fa,_0x354b2b)[_0x489c4f(0x2d4)])toggleBot(_0x8bcdb4['botID'],_0x8bcdb4[_0x489c4f(0x232)],_0x8bcdb4[_0x489c4f(0x2f3)]);else logger[_0x489c4f(0x1be)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x18168e['on']('toggle-bot-mode',(_0x57b91f,_0xaa0104)=>{const _0x18143c=_0x19017c;if(validateAccess(_0xaa0104,_0x354b2b)['allow'])toggleBotMode(_0x57b91f);else logger[_0x18143c(0x1be)](_0x18143c(0x2b1));}),_0x18168e['on']('delete-bot',(_0x3932e6,_0x34cca1)=>{const _0x5c1456=_0x19017c;if(validateAccess(_0x34cca1,_0x354b2b)['allow'])deleteBot(_0x3932e6);else logger['full'](_0x5c1456(0x1ec));}),_0x18168e['on'](_0x19017c(0x1d3),(_0x2f9a6f,_0x43e10f)=>{const _0x1d8f17=_0x19017c;if(validateAccess(_0x43e10f,_0x354b2b)[_0x1d8f17(0x2d4)])storeSettings(_0x2f9a6f,!![]);else logger[_0x1d8f17(0x1be)](_0x1d8f17(0x306));}),_0x18168e['on'](_0x19017c(0x360),_0x345704=>{const _0x26a2b7=_0x19017c;if(validateAccess(_0x345704,_0x354b2b)[_0x26a2b7(0x2d4)])updateBB();else logger[_0x26a2b7(0x1be)](_0x26a2b7(0x267));}),_0x18168e['on'](_0x19017c(0x321),_0x3d6003=>{const _0x42f15a=_0x19017c;if(validateAccess(_0x3d6003,_0x354b2b)['allow'])getMessages();else logger['full'](_0x42f15a(0x2e1));}),_0x18168e['on'](_0x19017c(0x31b),(_0x2bb16c,_0x49d096)=>{const _0x1f895d=_0x19017c;if(validateAccess(_0x49d096,_0x354b2b)[_0x1f895d(0x2d4)])confirmMessage(_0x2bb16c);else logger[_0x1f895d(0x1be)](_0x1f895d(0x244));}),_0x18168e['on'](_0x19017c(0x2ee),_0x3f20d1=>{const _0x2f913a=_0x19017c;if(validateAccess(_0x3f20d1,_0x354b2b)[_0x2f913a(0x2d4)]){if(devices[_0x354b2b]['pidRefreshToken'])clearTimeout(devices[_0x354b2b]['pidRefreshToken']);if(devices[_0x354b2b][_0x2f913a(0x2fe)])clearTimeout(devices[_0x354b2b][_0x2f913a(0x2fe)]);removeSocketListeners(getClient(_0x18168e['id'])[_0x2f913a(0x2a9)]),addBlacklist(_0x354b2b),devices[_0x354b2b][_0x2f913a(0x30b)]=null,devices[_0x354b2b]['telegram2FaApproval']=null,devices[_0x354b2b][_0x2f913a(0x1bf)][_0x2f913a(0x32c)]=null,io['to'](getClient(_0x18168e['id'])[_0x2f913a(0x2a9)])[_0x2f913a(0x228)](_0x2f913a(0x232),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x2f913a(0x251));});}function initializeSocketBot(_0x13cbe4){const _0x127ff2=_0x25c9ed,_0x16f68e=getClient(_0x13cbe4['id'])[_0x127ff2(0x205)],_0x2bdc81=getClient(_0x13cbe4['id'])['uuid'];_0x13cbe4['on'](_0x127ff2(0x1c5),(_0x2909b4,_0x3b6ea7)=>{const _0x4f66db=_0x127ff2;if(validateAccess(_0x3b6ea7,_0x2bdc81)[_0x4f66db(0x2d4)]){if(pid[_0x16f68e])pid[_0x16f68e][_0x4f66db(0x2fc)]({'function':_0x4f66db(0x1dc),'args':_0x2909b4});}else logger[_0x4f66db(0x1be)]('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0x13cbe4['on']('delete-alerts',(_0x52cebb,_0x3dd955)=>{const _0x3f3189=_0x127ff2;if(validateAccess(_0x3dd955,_0x2bdc81)[_0x3f3189(0x2d4)]){if(pid[_0x16f68e])pid[_0x16f68e]['send']({'function':_0x3f3189(0x1fd),'args':_0x52cebb});}else logger['full'](_0x3f3189(0x2d1));}),_0x13cbe4['on'](_0x127ff2(0x338),(_0x5b81b4,_0x54e7fc)=>{const _0x41838c=_0x127ff2;if(validateAccess(_0x54e7fc,_0x2bdc81)['allow']){if(pid[_0x16f68e])pid[_0x16f68e][_0x41838c(0x2fc)]({'function':_0x41838c(0x262),'args':_0x5b81b4});}else logger[_0x41838c(0x1be)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x13cbe4['on']('store-configuration',(_0x4e34c9,_0x5a7135)=>{const _0xe0fef8=_0x127ff2;if(validateAccess(_0x5a7135,_0x2bdc81)[_0xe0fef8(0x2d4)]){if(pid[_0x16f68e])pid[_0x16f68e][_0xe0fef8(0x2fc)]({'function':'storeConfiguration','args':_0x4e34c9});}else logger['full'](_0xe0fef8(0x246));}),_0x13cbe4['on'](_0x127ff2(0x2fb),(_0x15260c,_0x1c09d7)=>{const _0x46a4ee=_0x127ff2;if(validateAccess(_0x1c09d7,_0x2bdc81)[_0x46a4ee(0x2d4)]){if(pid[_0x16f68e])pid[_0x16f68e]['send']({'function':'storeHeadless','args':_0x15260c});}else logger[_0x46a4ee(0x1be)](_0x46a4ee(0x233));}),_0x13cbe4['on'](_0x127ff2(0x340),_0x2579b3=>{const _0x113821=_0x127ff2;if(validateAccess(_0x2579b3,_0x2bdc81)[_0x113821(0x2d4)]){if(pid[_0x16f68e])pid[_0x16f68e][_0x113821(0x2fc)]({'function':_0x113821(0x361),'args':null});}else logger[_0x113821(0x1be)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x13cbe4['on'](_0x127ff2(0x252),(_0xead633,_0x318da6)=>{const _0x36eefc=_0x127ff2;if(validateAccess(_0x318da6,_0x2bdc81)[_0x36eefc(0x2d4)]){if(pid[_0x16f68e])pid[_0x16f68e][_0x36eefc(0x2fc)]({'function':'placeOrder','args':_0xead633});}else logger[_0x36eefc(0x1be)](_0x36eefc(0x323));}),_0x13cbe4['on'](_0x127ff2(0x319),_0x1b65ec=>{const _0x28455a=_0x127ff2;if(validateAccess(_0x1b65ec,_0x2bdc81)[_0x28455a(0x2d4)]){if(pid[_0x16f68e])pid[_0x16f68e][_0x28455a(0x2fc)]({'function':_0x28455a(0x22c),'args':null});}else logger[_0x28455a(0x1be)](_0x28455a(0x2af));}),_0x13cbe4['on'](_0x127ff2(0x1f9),_0x1e5278=>{const _0xf07df9=_0x127ff2;if(validateAccess(_0x1e5278,_0x2bdc81)[_0xf07df9(0x2d4)]){if(pid[_0x16f68e])pid[_0x16f68e][_0xf07df9(0x2fc)]({'function':_0xf07df9(0x313),'args':null});}else logger[_0xf07df9(0x1be)](_0xf07df9(0x27d));}),_0x13cbe4['on'](_0x127ff2(0x360),_0x5a0214=>{const _0x5d904a=_0x127ff2;if(validateAccess(_0x5a0214,_0x2bdc81)[_0x5d904a(0x2d4)])updateBB();else logger[_0x5d904a(0x1be)](_0x5d904a(0x267));}),_0x13cbe4['on'](_0x127ff2(0x321),_0x494323=>{const _0x2d1702=_0x127ff2;if(validateAccess(_0x494323,_0x2bdc81)[_0x2d1702(0x2d4)])getMessages();else logger[_0x2d1702(0x1be)](_0x2d1702(0x2e1));}),_0x13cbe4['on']('confirm-message',(_0x5935e4,_0x265425)=>{const _0x4f579a=_0x127ff2;if(validateAccess(_0x265425,_0x2bdc81)[_0x4f579a(0x2d4)])confirmMessage(_0x5935e4);else logger[_0x4f579a(0x1be)](_0x4f579a(0x244));}),_0x13cbe4['on'](_0x127ff2(0x2ee),_0x2c8298=>{const _0x409115=_0x127ff2;if(validateAccess(_0x2c8298,_0x2bdc81)['allow']){if(devices[_0x2bdc81]['pidRefreshToken'])clearTimeout(devices[_0x2bdc81][_0x409115(0x312)]);if(devices[_0x2bdc81]['pidExpireLogin'])clearTimeout(devices[_0x2bdc81][_0x409115(0x2fe)]);removeSocketListeners(getClient(_0x13cbe4['id'])['uuid']),addBlacklist(_0x2bdc81),devices[_0x2bdc81]['telegramIpApproval']=null,devices[_0x2bdc81][_0x409115(0x1d9)]=null,devices[_0x2bdc81][_0x409115(0x1bf)][_0x409115(0x32c)]=null,io['to'](getClient(_0x13cbe4['id'])['uuid'])[_0x409115(0x228)]('status',{'access':{'allow':![],'reason':_0x409115(0x334),'token':null}});}else logger[_0x409115(0x1be)](_0x409115(0x251));});}function removeSocketListeners(_0x5a0a59){getClientsWithUuid(_0x5a0a59)['forEach'](_0x1c9e4a=>{const _0x5a83f5=_0x36f7;getSocket(_0x1c9e4a['id'])[_0x5a83f5(0x2d9)]();});}function cleanSettings(){const _0x1d7a75=_0x25c9ed;let _0x585ae4=settings;return settings[_0x1d7a75(0x28d)]&&settings[_0x1d7a75(0x28d)]!=''&&(_0x585ae4={..._0x585ae4,'telegramToken':'************'}),settings[_0x1d7a75(0x33c)]&&settings['bbPassword']!=''&&(_0x585ae4={..._0x585ae4,'bbPassword':_0x1d7a75(0x1f6)}),(settings['bbPassword']&&settings[_0x1d7a75(0x33c)]==_0x1d7a75(0x1df)||settings[_0x1d7a75(0x28d)]&&settings[_0x1d7a75(0x28d)]=='***')&&(_0x585ae4={..._0x585ae4,'restored':{'password':settings[_0x1d7a75(0x33c)]==_0x1d7a75(0x1df),'telegram':settings[_0x1d7a75(0x28d)]==_0x1d7a75(0x1df)}}),_0x585ae4;}function updateBB(){const _0x2c9aaf=_0x25c9ed;installingUpdate=!![],config[_0x2c9aaf(0x2de)](_0x3d4c2d=>{const _0x53f169=_0x2c9aaf;restartBot(_0x3d4c2d[_0x53f169(0x276)]);}),process['send']({'update':!![]},_0x1a0216=>{});}function startBot(_0x3d01ea,_0xc44582,_0x27b67b){const _0x220038=_0x25c9ed;let _0x4fc3f1=![];const _0x5bf0e5=_0x3d01ea[0x0];_0xc44582={..._0xc44582,'stdio':[_0x220038(0x2d6),_0x220038(0x2d6),_0x220038(0x2d6),_0x220038(0x2be)]},pid[_0x5bf0e5]=childProcess['fork'](botfile,_0x3d01ea,_0xc44582),pid[_0x5bf0e5]['on']('message',_0x147da7=>{const _0x5d0183=_0x220038;switch(Object[_0x5d0183(0x25f)](_0x147da7)[0x0]){case _0x5d0183(0x2f6):updateBotName(_0x5bf0e5,_0x147da7['botname']);break;case'updatebotmanager':updateBotManager();break;case _0x5d0183(0x232):updateStatus(_0x5bf0e5,_0x147da7[_0x5d0183(0x232)]);break;case'live':updateLive(_0x5bf0e5,_0x147da7['live']);break;case _0x5d0183(0x22f):updateLive(_0x5bf0e5,_0x147da7['started']),io['to'](_0x5bf0e5)[_0x5d0183(0x228)](_0x5d0183(0x232),{'access':{'allow':![],'reason':_0x5d0183(0x34a),'token':null}});break;case _0x5d0183(0x26d):_0x147da7[_0x5d0183(0x26d)]==_0x5d0183(0x263)&&restartBot(_0x5bf0e5);_0x147da7[_0x5d0183(0x26d)]==_0x5d0183(0x2e4)&&toggleBot(_0x5bf0e5,'disabled',_0x5d0183(0x2c3));break;case'telegram':sendTelegram(_0x5bf0e5,_0x147da7[_0x5d0183(0x349)]);break;case _0x5d0183(0x1bd):sendTelegramMsg(_0x147da7[_0x5d0183(0x1bd)]);break;case _0x5d0183(0x288):io['to'](_0x5bf0e5)[_0x5d0183(0x228)](_0x147da7[_0x5d0183(0x288)],_0x147da7[_0x5d0183(0x1d5)]);break;}}),pid[_0x5bf0e5]['on'](_0x220038(0x208),function(_0x3269c7){if(_0x4fc3f1)return;_0x4fc3f1=!![],_0x27b67b(_0x3269c7);}),pid[_0x5bf0e5]['on'](_0x220038(0x22b),async function(_0x572e76){const _0x1a3cbb=_0x220038;if(installingUpdate)return;if(_0x4fc3f1)return;_0x4fc3f1=!![],_0x27b67b(null);const _0x53f9b3=dbConfig[_0x1a3cbb(0x35a)](_0x1a3cbb(0x2c0))[_0x1a3cbb(0x24b)]({'botID':_0x5bf0e5})[_0x1a3cbb(0x200)]();_0x53f9b3&&(_0x53f9b3['status']==_0x1a3cbb(0x2b8)||_0x53f9b3[_0x1a3cbb(0x232)]=='new')&&(await sleep(0x3e8),updateLive(_0x5bf0e5,'stopped'),logger[_0x1a3cbb(0x1be)](_0x1a3cbb(0x287)+_0x5bf0e5),startBot([_0x5bf0e5,userID],{'cwd':bbpath},function(_0x97276){if(_0x97276)logger['full'](_0x97276);}));});}function stopBot(_0x2268a0){const _0x357ca8=_0x25c9ed;getClientsWithBotID(_0x2268a0)['forEach'](_0x4b51d3=>{const _0x33ab1f=_0x36f7;getSocket(_0x4b51d3['id'])[_0x33ab1f(0x1d2)](!![]),removeClient(_0x4b51d3['id']);}),pid[_0x2268a0]&&(pid[_0x2268a0][_0x357ca8(0x2e4)](),pid[_0x2268a0]=null);}function restartBot(_0x344ab8){const _0x19273f=_0x25c9ed;if(pid[_0x344ab8])pid[_0x344ab8][_0x19273f(0x2e4)]();}function addBot(){const _0x479c87=_0x25c9ed;let _0x1871ed;for(let _0x1bc536=0x1;_0x1bc536<0x3e9;_0x1bc536++){_0x1871ed=_0x1bc536[_0x479c87(0x293)]()[_0x479c87(0x1bb)](0x3,'0');let _0x42b102=config[_0x479c87(0x24b)](_0x8d21ff=>_0x8d21ff['botID']==_0x1871ed);if(!_0x42b102)break;}if(_0x1871ed==='1000'){logger['full'](_0x479c87(0x25d));return;}logger['full'](_0x479c87(0x34f)+_0x1871ed),dbConfig[_0x479c87(0x35a)](_0x479c87(0x2c0))['push']({'botID':_0x1871ed,'botname':_0x479c87(0x249)+_0x1871ed,'status':_0x479c87(0x1d7),'live':''})['write'](),startBot([_0x1871ed,userID],{'cwd':bbpath},function(_0x2534c5){const _0x113ef7=_0x479c87;if(_0x2534c5)logger[_0x113ef7(0x1be)](_0x2534c5);}),config=getConfiguration(),io['to'](_0x479c87(0x26e))[_0x479c87(0x228)](_0x479c87(0x2c0),config);}function deleteBot(_0x4d92e6){const _0x237704=_0x25c9ed;getClientsWithBotID(_0x4d92e6)[_0x237704(0x2de)](_0x3942e0=>{const _0x4446e2=_0x237704;getSocket(_0x3942e0['id'])[_0x4446e2(0x1d2)](!![]),removeClient(_0x3942e0['id']);}),dbConfig[_0x237704(0x35a)]('bots')[_0x237704(0x337)]({'botID':_0x4d92e6})[_0x237704(0x261)](),logger[_0x237704(0x1be)]('deleted\x20Bot\x20'+_0x4d92e6),stopBot(_0x4d92e6);try{if(fs[_0x237704(0x357)](path[_0x237704(0x328)](configpath,_0x237704(0x275)+_0x4d92e6+_0x237704(0x226))))fs[_0x237704(0x2a1)](path[_0x237704(0x328)](configpath,_0x237704(0x275)+_0x4d92e6+_0x237704(0x226)));if(fs['existsSync'](path['join'](configpath,_0x237704(0x275)+_0x4d92e6+_0x237704(0x2d8))))fs[_0x237704(0x2a1)](path[_0x237704(0x328)](configpath,_0x237704(0x275)+_0x4d92e6+'-events.json'));if(fs['existsSync'](path[_0x237704(0x328)](configpath,'bot-'+_0x4d92e6+_0x237704(0x32b))))fs[_0x237704(0x2a1)](path[_0x237704(0x328)](configpath,'bot-'+_0x4d92e6+_0x237704(0x32b)));if(fs['existsSync'](path[_0x237704(0x328)](configpath,'bot-'+_0x4d92e6+_0x237704(0x331))))fs[_0x237704(0x2a1)](path[_0x237704(0x328)](configpath,'bot-'+_0x4d92e6+'-results.json'));}catch(_0x429ae3){if(_0x429ae3)logger[_0x237704(0x1be)](_0x237704(0x1e3),_0x429ae3);}config=getConfiguration(),io['to'](_0x237704(0x26e))[_0x237704(0x228)](_0x237704(0x2c0),config);}function toggleBot(_0xf9d3c3,_0xfff60d,_0x200b1a){const _0x45ffbb=_0x25c9ed;dbConfig[_0x45ffbb(0x35a)](_0x45ffbb(0x2c0))['find']({'botID':_0xf9d3c3})['assign']({'status':_0xfff60d})['assign']({'live':_0x200b1a})[_0x45ffbb(0x261)]();if(_0xfff60d==_0x45ffbb(0x2b8)||_0xfff60d==_0x45ffbb(0x1d7))logger['full'](_0x45ffbb(0x1cb)+_0xf9d3c3),startBot([_0xf9d3c3,userID],{'cwd':bbpath},function(_0x2bf031){const _0x3c18f3=_0x45ffbb;if(_0x2bf031)logger[_0x3c18f3(0x1be)](_0x2bf031);});else(_0xfff60d==_0x45ffbb(0x30a)||_0xfff60d==_0x45ffbb(0x294))&&(logger[_0x45ffbb(0x1be)](_0x45ffbb(0x2b9)+_0xf9d3c3),stopBot(_0xf9d3c3));config=getConfiguration(),io['to'](_0x45ffbb(0x26e))[_0x45ffbb(0x228)](_0x45ffbb(0x2c0),config);}function toggleStatus(_0x296f1c){const _0x1bde06=_0x25c9ed;let _0x412524=dbConfig['get'](_0x1bde06(0x2c0))[_0x1bde06(0x24b)]({'botID':_0x296f1c})[_0x1bde06(0x200)](),_0x5b4af0;if(_0x412524[_0x1bde06(0x232)]==='enabled')_0x5b4af0=_0x1bde06(0x30a);else{if(_0x412524[_0x1bde06(0x232)]===_0x1bde06(0x1d7))_0x5b4af0=_0x1bde06(0x294);else{if(_0x412524[_0x1bde06(0x232)]===_0x1bde06(0x294))_0x5b4af0=_0x1bde06(0x1d7);else{if(_0x412524[_0x1bde06(0x232)]==='disabled')_0x5b4af0=_0x1bde06(0x2b8);}}}return _0x5b4af0;}function updateStatus(_0x5386db,_0x457d89){const _0x517329=_0x25c9ed;dbConfig[_0x517329(0x35a)](_0x517329(0x2c0))[_0x517329(0x24b)]({'botID':_0x5386db})[_0x517329(0x207)]({'status':_0x457d89})['write'](),config=getConfiguration(),io['to'](_0x517329(0x26e))[_0x517329(0x228)](_0x517329(0x2c0),config);}function updateLive(_0x2855b1,_0x411c55){const _0xde93a3=_0x25c9ed;dbConfig[_0xde93a3(0x35a)](_0xde93a3(0x2c0))[_0xde93a3(0x24b)]({'botID':_0x2855b1})['assign']({'live':_0x411c55})[_0xde93a3(0x261)](),config=getConfiguration(),io['to'](_0xde93a3(0x26e))[_0xde93a3(0x228)](_0xde93a3(0x2c0),config);}function updateBotName(_0x1f676a,_0x1d8c67){const _0x134b9d=_0x25c9ed;dbConfig[_0x134b9d(0x35a)](_0x134b9d(0x2c0))[_0x134b9d(0x24b)]({'botID':_0x1f676a})['assign']({'botname':_0x1d8c67})[_0x134b9d(0x261)](),config=getConfiguration(),io['to']('botmanager')[_0x134b9d(0x228)](_0x134b9d(0x2c0),config);}function updateBotManager(){const _0x3337c1=_0x25c9ed;config=getConfiguration(),io['to']('botmanager')[_0x3337c1(0x228)](_0x3337c1(0x2c0),config);}function toggleBotMode(_0x4545be){const _0x385816=_0x25c9ed;if(pid[_0x4545be])pid[_0x4545be][_0x385816(0x2fc)]({'function':_0x385816(0x2bc),'args':null});else{const _0x505046=configpath+'bot-'+_0x4545be+_0x385816(0x226),_0x4e40c1=fs['readFileSync'](_0x505046),_0x5474b1=JSON[_0x385816(0x2a7)](_0x4e40c1),_0xc5e45f=_0x5474b1[_0x385816(0x205)][0x0]['headless'];_0x5474b1[_0x385816(0x205)][0x0][_0x385816(0x1fa)]=!_0xc5e45f;const _0x2a3d75=JSON[_0x385816(0x325)](_0x5474b1,null,0x2);fs[_0x385816(0x2f0)](_0x505046,_0x2a3d75),config=getConfiguration(),io['to']('botmanager')[_0x385816(0x228)]('bots',config);}}function telegramError(_0x8c0aff){const _0x3c8854=_0x25c9ed;logger[_0x3c8854(0x1c8)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x3f223b){const _0x2abc83=_0x25c9ed;if(_0x3f223b[_0x2abc83(0x212)][_0x2abc83(0x260)]!=settings[_0x2abc83(0x230)]&&'@'+_0x3f223b['from']['username']!=settings['telegramUsername'])return tgBot[_0x2abc83(0x273)](_0x3f223b['chat']['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':'HTML'})[_0x2abc83(0x2e6)](_0x37f1e3=>{telegramError(_0x37f1e3);}),![];return!![];}async function initTelegram(){const _0x4673ce=_0x25c9ed;if(tgBot)tgBot[_0x4673ce(0x320)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x462ac7='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x462ac7+='\x0a',_0x462ac7+=_0x4673ce(0x2da),_0x462ac7+=_0x4673ce(0x26a),_0x462ac7+=_0x4673ce(0x30d),_0x462ac7+=_0x4673ce(0x269),_0x462ac7+=_0x4673ce(0x20c),_0x462ac7+=_0x4673ce(0x285),_0x462ac7+=_0x4673ce(0x352),_0x462ac7+='/names\x20-\x20show\x20bot\x20names\x0a',_0x462ac7+=_0x4673ce(0x245),_0x462ac7+=_0x4673ce(0x1fb),_0x462ac7+=_0x4673ce(0x21f),_0x462ac7+=_0x4673ce(0x2ea);let _0x45019c='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x45019c+='\x0a',_0x45019c+=_0x462ac7,tgBot[_0x4673ce(0x21d)](/\/start/,_0x5d9dc0=>{const _0x54db92=_0x4673ce;if(!validateTelegram(_0x5d9dc0))return;if(settings[_0x54db92(0x247)]!=_0x5d9dc0[_0x54db92(0x20e)]['id'])updateSetting('telegramChatId',_0x5d9dc0[_0x54db92(0x20e)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x54db92(0x273)](_0x5d9dc0['chat']['id'],_0x45019c)[_0x54db92(0x2e6)](_0x5b09b2=>{telegramError(_0x5b09b2);});}),tgBot[_0x4673ce(0x21d)](/\/enable/,_0xcd2e39=>{const _0x773380=_0x4673ce;if(!validateTelegram(_0xcd2e39))return;if(settings['telegramChatId']!=_0xcd2e39[_0x773380(0x20e)]['id'])updateSetting(_0x773380(0x247),_0xcd2e39[_0x773380(0x20e)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x773380(0x273)](_0xcd2e39[_0x773380(0x20e)]['id'],_0x773380(0x2a0))[_0x773380(0x2e6)](_0x19542d=>{telegramError(_0x19542d);});}),tgBot[_0x4673ce(0x21d)](/\/config/,async _0xbc542d=>{const _0x1ac43e=_0x4673ce;if(!validateTelegram(_0xbc542d))return;tgBot['removeListener'](_0x1ac43e(0x25e)),tgBot[_0x1ac43e(0x273)](_0xbc542d[_0x1ac43e(0x20e)]['id'],_0x1ac43e(0x329),{'reply_markup':{'inline_keyboard':[[{'text':_0x1ac43e(0x270),'callback_data':_0x1ac43e(0x32e)},{'text':_0x1ac43e(0x1ef),'callback_data':_0x1ac43e(0x35d)},{'text':_0x1ac43e(0x304),'callback_data':_0x1ac43e(0x31a)}]]}})[_0x1ac43e(0x2e6)](_0x3ee258=>{telegramError(_0x3ee258);}),tgBot['on'](_0x1ac43e(0x25e),async _0x2d97ff=>{const _0x16aee5=_0x1ac43e,_0xa103e0=_0x2d97ff[_0x16aee5(0x308)],_0x5643f5=_0x2d97ff[_0x16aee5(0x1d8)];tgBot[_0x16aee5(0x307)](_0x2d97ff['id'])[_0x16aee5(0x365)](async()=>{const _0x12d04c=_0x16aee5;_0xa103e0==_0x12d04c(0x32e)&&(updateSetting('telegramEvents',_0x12d04c(0x32e)),updateSetting(_0x12d04c(0x316),!![]),await tgBot[_0x12d04c(0x273)](_0x5643f5[_0x12d04c(0x20e)]['id'],_0x12d04c(0x2d2))[_0x12d04c(0x2e6)](_0xa398cd=>{telegramError(_0xa398cd);}));_0xa103e0=='alerts'&&(updateSetting(_0x12d04c(0x1b6),'alerts'),updateSetting('telegramEnabled',!![]),await tgBot[_0x12d04c(0x273)](_0x5643f5[_0x12d04c(0x20e)]['id'],_0x12d04c(0x344))['catch'](_0x290227=>{telegramError(_0x290227);}));_0xa103e0==_0x12d04c(0x31a)&&(updateSetting(_0x12d04c(0x1b6),'all'),updateSetting(_0x12d04c(0x316),!![]),await tgBot[_0x12d04c(0x273)](_0x5643f5[_0x12d04c(0x20e)]['id'],_0x12d04c(0x253))[_0x12d04c(0x2e6)](_0x58dc81=>{telegramError(_0x58dc81);}));if(!settings[_0x12d04c(0x247)])tgBot[_0x12d04c(0x273)](_0x5643f5[_0x12d04c(0x20e)]['id'],_0x12d04c(0x2a6))[_0x12d04c(0x2e6)](_0x1d1eb1=>{telegramError(_0x1d1eb1);});}),tgBot[_0x16aee5(0x248)](_0x16aee5(0x25e));});}),tgBot[_0x4673ce(0x21d)](/\/status/,_0x482f9f=>{const _0x5c0be3=_0x4673ce;if(!validateTelegram(_0x482f9f))return;const _0x1d1a12=getBotsWithMode();let _0x4509b5='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x5c0be3(0x2de)](_0x5a270c=>{const _0x294bdd=_0x5c0be3,_0x594af5=_0x1d1a12['find'](_0x25cf1b=>_0x25cf1b[_0x294bdd(0x276)]==_0x5a270c['botID'])[_0x294bdd(0x358)];_0x4509b5+=_0x294bdd(0x249)+_0x5a270c[_0x294bdd(0x276)]+':\x20'+_0x5a270c[_0x294bdd(0x232)]+_0x294bdd(0x327)+_0x594af5+_0x294bdd(0x327)+_0x5a270c[_0x294bdd(0x2f3)]+'\x0a';}),_0x4509b5+='\x0a',_0x4509b5+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x4509b5+=!settings[_0x5c0be3(0x316)]?_0x5c0be3(0x28e):_0x5c0be3(0x24c),_0x4509b5+=settings[_0x5c0be3(0x316)]?settings['telegramEvents']=='all'?_0x5c0be3(0x2f7):_0x5c0be3(0x1b3)+settings[_0x5c0be3(0x1b6)]+_0x5c0be3(0x1b5):'',tgBot[_0x5c0be3(0x273)](_0x482f9f[_0x5c0be3(0x20e)]['id'],_0x4509b5,{'parse_mode':'HTML'})[_0x5c0be3(0x2e6)](_0x2abcce=>{telegramError(_0x2abcce);});}),tgBot[_0x4673ce(0x21d)](/\/restart/,_0x367219=>{const _0x3b013a=_0x4673ce;if(!validateTelegram(_0x367219))return;tgBot[_0x3b013a(0x248)]('callback_query');const _0x391066=getEnabledBots();if(_0x391066[_0x3b013a(0x224)]==0x0)tgBot[_0x3b013a(0x273)](_0x367219[_0x3b013a(0x20e)]['id'],_0x3b013a(0x222))[_0x3b013a(0x2e6)](_0x364020=>{telegramError(_0x364020);});else{if(_0x391066[_0x3b013a(0x224)]>0x1)_0x391066[_0x3b013a(0x1cf)]({'botID':'all'});let _0x505e48=[],_0x2dddf1=[];const _0x2f926f=_0x391066['length']%0x4==0x0||_0x391066[_0x3b013a(0x224)]%0x4==0x3||_0x391066['length']%0x3==0x1?0x4:0x3;let _0x4a046a=0x0;_0x391066['forEach']((_0x4474f0,_0x4109a5)=>{const _0x34ae76=_0x3b013a;if(_0x4109a5%_0x2f926f==0x0)_0x2dddf1=[];_0x2dddf1[_0x34ae76(0x1cf)]({'text':_0x4474f0[_0x34ae76(0x276)]==_0x34ae76(0x31a)?_0x34ae76(0x23b):_0x34ae76(0x249)+_0x4474f0[_0x34ae76(0x276)],'callback_data':_0x4474f0[_0x34ae76(0x276)]}),_0x4109a5%_0x2f926f==0x0&&(_0x505e48[_0x4a046a]=_0x2dddf1,_0x4a046a++);}),tgBot['sendMessage'](_0x367219['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x505e48}})[_0x3b013a(0x2e6)](_0x40d582=>{telegramError(_0x40d582);}),tgBot['on'](_0x3b013a(0x25e),async _0x327df8=>{const _0x302d69=_0x3b013a,_0x292b53=_0x327df8[_0x302d69(0x308)],_0x4e2774=_0x327df8[_0x302d69(0x1d8)];tgBot[_0x302d69(0x307)](_0x327df8['id'])[_0x302d69(0x365)](async()=>{const _0x292b45=_0x302d69;_0x292b53==_0x292b45(0x31a)?config[_0x292b45(0x2de)](_0x27e946=>{const _0x48cfb0=_0x292b45;restartBot(_0x27e946[_0x48cfb0(0x276)]);}):restartBot(_0x292b53);}),tgBot['removeListener'](_0x302d69(0x25e));});}}),tgBot[_0x4673ce(0x21d)](/\/on/,_0x3ee8ba=>{const _0x3675a8=_0x4673ce;if(!validateTelegram(_0x3ee8ba))return;tgBot['removeListener']('callback_query');const _0x2a9644=getDisabledBots();if(_0x2a9644[_0x3675a8(0x224)]==0x0)tgBot['sendMessage'](_0x3ee8ba[_0x3675a8(0x20e)]['id'],_0x3675a8(0x289))['catch'](_0x48ac45=>{telegramError(_0x48ac45);});else{if(_0x2a9644[_0x3675a8(0x224)]>0x1)_0x2a9644['push']({'botID':_0x3675a8(0x31a)});let _0x26bdc9=[],_0x3aa96c=[];const _0x8d1346=_0x2a9644[_0x3675a8(0x224)]%0x4==0x0||_0x2a9644[_0x3675a8(0x224)]%0x4==0x3||_0x2a9644[_0x3675a8(0x224)]%0x3==0x1?0x4:0x3;let _0x329657=0x0;_0x2a9644[_0x3675a8(0x2de)]((_0x32c02f,_0x4052f1)=>{const _0x412c3c=_0x3675a8;if(_0x4052f1%_0x8d1346==0x0)_0x3aa96c=[];_0x3aa96c[_0x412c3c(0x1cf)]({'text':_0x32c02f[_0x412c3c(0x276)]==_0x412c3c(0x31a)?_0x412c3c(0x23b):'Bot\x20'+_0x32c02f['botID'],'callback_data':_0x32c02f[_0x412c3c(0x276)]}),_0x4052f1%_0x8d1346==0x0&&(_0x26bdc9[_0x329657]=_0x3aa96c,_0x329657++);}),tgBot['sendMessage'](_0x3ee8ba[_0x3675a8(0x20e)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x26bdc9}})['catch'](_0x1d8094=>{telegramError(_0x1d8094);}),tgBot['on'](_0x3675a8(0x25e),async _0x502cca=>{const _0x19ea2f=_0x3675a8,_0x52967a=_0x502cca[_0x19ea2f(0x308)],_0x1ee0ec=_0x502cca['message'];tgBot[_0x19ea2f(0x307)](_0x502cca['id'])[_0x19ea2f(0x365)](async()=>{const _0x48232e=_0x19ea2f;_0x52967a==_0x48232e(0x31a)?(tgBot[_0x48232e(0x273)](_0x1ee0ec[_0x48232e(0x20e)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')['catch'](_0x4bbe8c=>{telegramError(_0x4bbe8c);}),_0x2a9644[_0x48232e(0x2de)](_0x2f908c=>{const _0x4fe06d=_0x48232e;if(_0x2f908c[_0x4fe06d(0x276)]!=_0x4fe06d(0x31a))toggleBot(_0x2f908c[_0x4fe06d(0x276)],toggleStatus(_0x2f908c[_0x4fe06d(0x276)]),_0x4fe06d(0x2c3));})):(tgBot[_0x48232e(0x273)](_0x1ee0ec[_0x48232e(0x20e)]['id'],_0x48232e(0x300)+_0x52967a)[_0x48232e(0x2e6)](_0x189efe=>{telegramError(_0x189efe);}),toggleBot(_0x52967a,toggleStatus(_0x52967a),_0x48232e(0x2c3)));}),tgBot['removeListener'](_0x19ea2f(0x25e));});}}),tgBot['onText'](/\/off/,_0x29b44c=>{const _0x2b5320=_0x4673ce;if(!validateTelegram(_0x29b44c))return;tgBot[_0x2b5320(0x248)]('callback_query');const _0x48d4f1=getEnabledBots();if(_0x48d4f1[_0x2b5320(0x224)]==0x0)tgBot[_0x2b5320(0x273)](_0x29b44c[_0x2b5320(0x20e)]['id'],_0x2b5320(0x222))[_0x2b5320(0x2e6)](_0x1b82b9=>{telegramError(_0x1b82b9);});else{if(_0x48d4f1['length']>0x1)_0x48d4f1[_0x2b5320(0x1cf)]({'botID':_0x2b5320(0x31a)});let _0x204384=[],_0x11b3d2=[];const _0x2432aa=_0x48d4f1[_0x2b5320(0x224)]%0x4==0x0||_0x48d4f1[_0x2b5320(0x224)]%0x4==0x3||_0x48d4f1[_0x2b5320(0x224)]%0x3==0x1?0x4:0x3;let _0x4c947b=0x0;_0x48d4f1['forEach']((_0x287fcd,_0x73d462)=>{const _0xab4f19=_0x2b5320;if(_0x73d462%_0x2432aa==0x0)_0x11b3d2=[];_0x11b3d2[_0xab4f19(0x1cf)]({'text':_0x287fcd[_0xab4f19(0x276)]==_0xab4f19(0x31a)?'All\x20bots':_0xab4f19(0x249)+_0x287fcd[_0xab4f19(0x276)],'callback_data':_0x287fcd['botID']}),_0x73d462%_0x2432aa==0x0&&(_0x204384[_0x4c947b]=_0x11b3d2,_0x4c947b++);}),tgBot['sendMessage'](_0x29b44c[_0x2b5320(0x20e)]['id'],_0x2b5320(0x257),{'reply_markup':{'inline_keyboard':_0x204384}})[_0x2b5320(0x2e6)](_0x4202bd=>{telegramError(_0x4202bd);}),tgBot['on'](_0x2b5320(0x25e),async _0x363c85=>{const _0x475739=_0x2b5320,_0x4d7b9b=_0x363c85[_0x475739(0x308)],_0x4fade1=_0x363c85[_0x475739(0x1d8)];tgBot[_0x475739(0x307)](_0x363c85['id'])[_0x475739(0x365)](async()=>{const _0x112e96=_0x475739;_0x4d7b9b==_0x112e96(0x31a)?(tgBot[_0x112e96(0x273)](_0x4fade1[_0x112e96(0x20e)]['id'],_0x112e96(0x1ff))[_0x112e96(0x2e6)](_0x48126f=>{telegramError(_0x48126f);}),_0x48d4f1[_0x112e96(0x2de)](_0x1b0e0c=>{const _0x1a9cea=_0x112e96;if(_0x1b0e0c['botID']!=_0x1a9cea(0x31a))toggleBot(_0x1b0e0c['botID'],toggleStatus(_0x1b0e0c[_0x1a9cea(0x276)]),_0x1a9cea(0x2c3));})):(tgBot['sendMessage'](_0x4fade1[_0x112e96(0x20e)]['id'],_0x112e96(0x22d)+_0x4d7b9b)[_0x112e96(0x2e6)](_0x37b21d=>{telegramError(_0x37b21d);}),toggleBot(_0x4d7b9b,toggleStatus(_0x4d7b9b),'stopped'));}),tgBot['removeListener'](_0x475739(0x25e));});}}),tgBot[_0x4673ce(0x21d)](/\/portfolio/,_0x388e44=>{const _0x4afc1e=_0x4673ce;if(!validateTelegram(_0x388e44))return;tgBot[_0x4afc1e(0x248)]('callback_query');const _0x215fe1=getEnabledBots();if(_0x215fe1[_0x4afc1e(0x224)]==0x0)tgBot['sendMessage'](_0x388e44[_0x4afc1e(0x20e)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x466bb6=>{telegramError(_0x466bb6);});else{if(_0x215fe1[_0x4afc1e(0x224)]>0x1){let _0x204811=[],_0x4c40d8=[];const _0x5086cd=_0x215fe1['length']%0x4==0x0||_0x215fe1[_0x4afc1e(0x224)]%0x4==0x3||_0x215fe1['length']%0x3==0x1?0x4:0x3;let _0x77926d=0x0;_0x215fe1[_0x4afc1e(0x2de)]((_0x5f418d,_0x4986da)=>{const _0x220383=_0x4afc1e;if(_0x4986da%_0x5086cd==0x0)_0x4c40d8=[];_0x4c40d8[_0x220383(0x1cf)]({'text':_0x220383(0x249)+_0x5f418d[_0x220383(0x276)],'callback_data':_0x5f418d[_0x220383(0x276)]}),_0x4986da%_0x5086cd==0x0&&(_0x204811[_0x77926d]=_0x4c40d8,_0x77926d++);}),tgBot['sendMessage'](_0x388e44['chat']['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x204811}})[_0x4afc1e(0x2e6)](_0x5e4f10=>{telegramError(_0x5e4f10);}),tgBot['on']('callback_query',async _0x233e21=>{const _0x449efb=_0x4afc1e,_0x4e00c2=_0x233e21[_0x449efb(0x308)],_0x332a70=_0x233e21['message'];tgBot[_0x449efb(0x307)](_0x233e21['id'])[_0x449efb(0x365)](async()=>{if(pid[_0x4e00c2])pid[_0x4e00c2]['send']({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x449efb(0x248)]('callback_query');});}else{const _0x2f0c7c=_0x215fe1[0x0]['botID'];if(pid[_0x2f0c7c])pid[_0x2f0c7c]['send']({'function':_0x4afc1e(0x2ce),'args':null});}}}),tgBot[_0x4673ce(0x21d)](/\/update/,async _0x1f5192=>{const _0x4ab867=_0x4673ce;if(!validateTelegram(_0x1f5192))return;tgBot[_0x4ab867(0x248)](_0x4ab867(0x25e)),await getMessages();if(!updateAvailable)tgBot[_0x4ab867(0x273)](_0x1f5192[_0x4ab867(0x20e)]['id'],_0x4ab867(0x1f8))[_0x4ab867(0x2e6)](_0x126aa4=>{telegramError(_0x126aa4);});else!validInstallation?tgBot[_0x4ab867(0x273)](_0x1f5192[_0x4ab867(0x20e)]['id'],_0x4ab867(0x302))[_0x4ab867(0x2e6)](_0x11994c=>{telegramError(_0x11994c);}):(tgBot[_0x4ab867(0x273)](_0x1f5192['chat']['id'],_0x4ab867(0x1c4),{'reply_markup':{'inline_keyboard':[[{'text':_0x4ab867(0x2aa),'callback_data':_0x4ab867(0x236)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x3b5ba6=>{telegramError(_0x3b5ba6);}),tgBot['on'](_0x4ab867(0x25e),async _0x24b373=>{const _0x25e0f5=_0x4ab867,_0x5530b8=_0x24b373[_0x25e0f5(0x308)],_0x38f834=_0x24b373[_0x25e0f5(0x1d8)];tgBot[_0x25e0f5(0x307)](_0x24b373['id'])[_0x25e0f5(0x365)](async()=>{const _0x4cb270=_0x25e0f5;_0x5530b8==_0x4cb270(0x236)&&(await tgBot['sendMessage'](_0x38f834[_0x4cb270(0x20e)]['id'],_0x4cb270(0x2b4))[_0x4cb270(0x2e6)](_0x3535d6=>{telegramError(_0x3535d6);}),updateBB());_0x5530b8=='no'&&await tgBot[_0x4cb270(0x273)](_0x38f834[_0x4cb270(0x20e)]['id'],_0x4cb270(0x1c6))[_0x4cb270(0x2e6)](_0x289043=>{telegramError(_0x289043);});if(!settings[_0x4cb270(0x247)])tgBot[_0x4cb270(0x273)](_0x38f834['chat']['id'],_0x4cb270(0x2a6))[_0x4cb270(0x2e6)](_0x2baf5f=>{telegramError(_0x2baf5f);});}),tgBot[_0x25e0f5(0x248)](_0x25e0f5(0x25e));}));}),tgBot['onText'](/\/toggle/,_0x363633=>{const _0x6e30e7=_0x4673ce;if(!validateTelegram(_0x363633))return;tgBot[_0x6e30e7(0x248)](_0x6e30e7(0x25e));const _0x549dba=getBotsWithMode();if(_0x549dba[_0x6e30e7(0x224)]==0x0)tgBot[_0x6e30e7(0x273)](_0x363633[_0x6e30e7(0x20e)]['id'],_0x6e30e7(0x222))[_0x6e30e7(0x2e6)](_0x2e3242=>{telegramError(_0x2e3242);});else{let _0x2257c0=[],_0x24cf07=[];const _0x43fe5=0x2;let _0x4ecb29=0x0;_0x549dba['forEach']((_0x226865,_0x2a0943)=>{const _0x2312a7=_0x6e30e7;if(_0x2a0943%_0x43fe5==0x0)_0x24cf07=[];_0x24cf07['push']({'text':'Bot\x20'+_0x226865['botID']+'\x20('+_0x226865[_0x2312a7(0x358)]+')','callback_data':_0x226865[_0x2312a7(0x276)]}),_0x2a0943%_0x43fe5==0x0&&(_0x2257c0[_0x4ecb29]=_0x24cf07,_0x4ecb29++);}),tgBot[_0x6e30e7(0x273)](_0x363633[_0x6e30e7(0x20e)]['id'],_0x6e30e7(0x229),{'reply_markup':{'inline_keyboard':_0x2257c0}})['catch'](_0x377056=>{telegramError(_0x377056);}),tgBot['on'](_0x6e30e7(0x25e),async _0x31f510=>{const _0x245b65=_0x6e30e7,_0x2a941f=_0x31f510[_0x245b65(0x308)],_0x3af5e4=_0x31f510[_0x245b65(0x1d8)];tgBot[_0x245b65(0x307)](_0x31f510['id'])[_0x245b65(0x365)](async()=>{const _0x42be69=_0x245b65,_0xd9f384=_0x549dba[_0x42be69(0x24b)](_0x2acc41=>_0x2acc41[_0x42be69(0x276)]==_0x2a941f),_0x468b73=_0xd9f384[_0x42be69(0x358)]==_0x42be69(0x30c)?_0x42be69(0x29b):_0x42be69(0x30c);tgBot['sendMessage'](_0x3af5e4[_0x42be69(0x20e)]['id'],_0x42be69(0x343)+_0x2a941f+_0x42be69(0x223)+_0x468b73+_0x42be69(0x29c))[_0x42be69(0x2e6)](_0x2b3515=>{telegramError(_0x2b3515);}),toggleBotMode(_0x2a941f);}),tgBot[_0x245b65(0x248)](_0x245b65(0x25e));});}}),tgBot[_0x4673ce(0x21d)](/\/names/,_0x3dba47=>{const _0x4939dc=_0x4673ce;if(!validateTelegram(_0x3dba47))return;let _0x187d9f='';config[_0x4939dc(0x2de)](_0x416a2f=>{const _0x499eee=_0x4939dc;_0x187d9f+=_0x499eee(0x249)+_0x416a2f[_0x499eee(0x276)]+':\x20'+_0x416a2f[_0x499eee(0x2f6)]+'\x0a';}),tgBot['sendMessage'](_0x3dba47['chat']['id'],_0x187d9f,{'parse_mode':_0x4939dc(0x2fd)})[_0x4939dc(0x2e6)](_0x484519=>{telegramError(_0x484519);});}),tgBot[_0x4673ce(0x21d)](/\/disable/,_0xec98f7=>{const _0x1ce131=_0x4673ce;if(!validateTelegram(_0xec98f7))return;tgBot[_0x1ce131(0x273)](_0xec98f7[_0x1ce131(0x20e)]['id'],'Notifications\x20disabled')[_0x1ce131(0x2e6)](_0x4757f5=>{telegramError(_0x4757f5);}),updateSetting(_0x1ce131(0x316),![]);}),tgBot['onText'](/\/help/,_0xf8fb28=>{const _0x4329c7=_0x4673ce;if(!validateTelegram(_0xf8fb28))return;tgBot[_0x4329c7(0x273)](_0xf8fb28['chat']['id'],_0x462ac7)['catch'](_0x1c2a72=>{telegramError(_0x1c2a72);});}),tgBot['on'](_0x4673ce(0x1ee),_0x2b7653=>{const _0x2d530f=_0x4673ce;_0x2b7653[_0x2d530f(0x293)]()[_0x2d530f(0x1f2)](_0x2d530f(0x1bc))&&(logger[_0x2d530f(0x1be)](_0x2d530f(0x348)),tgBot['stopPolling'](),tgBot=null,io['to']('botmanager')[_0x2d530f(0x228)](_0x2d530f(0x237),_0x2d530f(0x348)));}),process[_0x4673ce(0x29e)](_0x4673ce(0x2bb),()=>{const _0x4e9774=_0x4673ce;if(tgBot)tgBot[_0x4e9774(0x320)]();process[_0x4e9774(0x22b)](0x1);}),process[_0x4673ce(0x29e)](_0x4673ce(0x346),()=>{const _0x1a551b=_0x4673ce;if(tgBot)tgBot[_0x1a551b(0x320)]();process[_0x1a551b(0x22b)](0x1);});}}function disableTelegram(){const _0xf2c7d8=_0x25c9ed;tgBot&&(tgBot[_0xf2c7d8(0x320)](),tgBot=null);}function sendTelegram(_0x5e3666,_0x3a4280){const _0x470cef=_0x25c9ed;if(settings[_0x470cef(0x316)]){if(settings[_0x470cef(0x1b6)]==_0x470cef(0x31a)||(_0x3a4280['type']=='error'||_0x3a4280[_0x470cef(0x2b0)]==_0x470cef(0x243)||_0x3a4280[_0x470cef(0x2b0)]==_0x470cef(0x1d6))&&settings[_0x470cef(0x1b6)]=='alerts'||_0x3a4280[_0x470cef(0x2b0)]==_0x470cef(0x1fc)&&settings[_0x470cef(0x1b6)]==_0x470cef(0x32e)){if(tgBot&&settings[_0x470cef(0x247)]){if(_0x3a4280['showname'])tgBot[_0x470cef(0x273)](settings[_0x470cef(0x247)],_0x3a4280['botname']+_0x470cef(0x34e)+_0x3a4280['event'])[_0x470cef(0x2e6)](_0x13d47e=>{telegramError(_0x13d47e);});else tgBot[_0x470cef(0x273)](settings[_0x470cef(0x247)],_0x470cef(0x249)+_0x5e3666+_0x470cef(0x34e)+_0x3a4280[_0x470cef(0x353)])[_0x470cef(0x2e6)](_0x3e95a3=>{telegramError(_0x3e95a3);});}}}}async function sendTelegramMsg(_0x83347c,_0x5b15a1=_0x25c9ed(0x2fd)){const _0x49c014=_0x25c9ed;return settings['telegramEnabled']&&tgBot&&settings[_0x49c014(0x247)]?(await tgBot[_0x49c014(0x273)](settings[_0x49c014(0x247)],_0x83347c,{'parse_mode':_0x5b15a1})[_0x49c014(0x2e6)](_0x2ae6d2=>{telegramError(_0x2ae6d2);}),!![]):![];}function getDeviceWithIp(_0x43d6a1){const _0x5e4e58=_0x25c9ed;return devices[_0x5e4e58(0x24b)](_0x5b4fcc=>_0x5b4fcc['ip']===_0x43d6a1);}function temporaryAccess2FA(_0x2e0aed,_0x356e9a){const _0x17a883=_0x25c9ed;let _0x45d911=new Date(),_0x343bbe=![];if(lastIpApproval){if(_0x45d911-lastIpApproval<0x1388)_0x343bbe=!![];}lastIpApproval=new Date();if(_0x343bbe)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x17a883(0x248)](_0x17a883(0x25e)),tgBot['sendMessage'](settings['telegramChatId'],_0x17a883(0x2e8)+normalizeIP(_0x356e9a)[_0x17a883(0x305)]+_0x17a883(0x20d),{'parse_mode':_0x17a883(0x2fd),'reply_markup':{'inline_keyboard':[[{'text':_0x17a883(0x2db),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':'reject','callback_data':'reject'}]]}})['catch'](_0x30ce11=>{telegramError(_0x30ce11);}),tgBot['on']('callback_query',async _0x22da08=>{const _0x2d5b36=_0x17a883,_0x273566=_0x22da08[_0x2d5b36(0x308)],_0xa98a4d=_0x22da08['message'];tgBot[_0x2d5b36(0x307)](_0x22da08['id'])[_0x2d5b36(0x365)](async()=>{const _0x183455=_0x2d5b36;devices[_0x2e0aed]['telegramIpApproval']={'clientip':_0x356e9a,'timestamp':new Date()[_0x183455(0x1e1)](),'expiry':_0x273566},_0x273566!=_0x183455(0x25c)?(await tgBot['sendMessage'](_0xa98a4d[_0x183455(0x20e)]['id'],_0x183455(0x1c0)+_0x273566+_0x183455(0x20a),{'parse_mode':_0x183455(0x2fd)})['catch'](_0x508ee7=>{telegramError(_0x508ee7);}),io['to'](_0x2e0aed)[_0x183455(0x228)]('status',{'access':{'allow':![],'reason':_0x183455(0x34a),'token':null}})):(await tgBot['sendMessage'](_0xa98a4d['chat']['id'],_0x183455(0x217))[_0x183455(0x2e6)](_0x1adc7e=>{telegramError(_0x1adc7e);}),io['to'](_0x2e0aed)[_0x183455(0x228)](_0x183455(0x232),{'access':{'allow':![],'reason':_0x183455(0x30e),'token':null}}));}),tgBot[_0x2d5b36(0x248)](_0x2d5b36(0x25e));}));}function loginAccess2FA(_0x25e7d9,_0x258bf8){const _0x57f33e=_0x25c9ed;tgBot&&settings[_0x57f33e(0x247)]&&(tgBot['removeListener'](_0x57f33e(0x25e)),tgBot[_0x57f33e(0x273)](settings[_0x57f33e(0x247)],_0x57f33e(0x24f)+normalizeIP(_0x258bf8)[_0x57f33e(0x305)]+_0x57f33e(0x20d),{'parse_mode':_0x57f33e(0x2fd),'reply_markup':{'inline_keyboard':[[{'text':_0x57f33e(0x339),'callback_data':loginExpiry},{'text':_0x57f33e(0x25c),'callback_data':_0x57f33e(0x25c)}]]}})[_0x57f33e(0x2e6)](_0x297db0=>{telegramError(_0x297db0);}),tgBot['on'](_0x57f33e(0x25e),async _0x392fd2=>{const _0x5e529d=_0x57f33e,_0xaecc29=_0x392fd2[_0x5e529d(0x308)],_0x5ee2b3=_0x392fd2['message'];tgBot[_0x5e529d(0x307)](_0x392fd2['id'])[_0x5e529d(0x365)](async()=>{const _0x2b0810=_0x5e529d;devices[_0x25e7d9][_0x2b0810(0x1d9)]={'clientip':_0x258bf8,'timestamp':new Date()[_0x2b0810(0x1e1)](),'expiry':_0xaecc29},_0xaecc29!='reject'?(await tgBot[_0x2b0810(0x273)](_0x5ee2b3['chat']['id'],_0x2b0810(0x283),{'parse_mode':'HTML'})[_0x2b0810(0x2e6)](_0x49a9d5=>{telegramError(_0x49a9d5);}),io['to'](_0x25e7d9)[_0x2b0810(0x228)]('status',{'access':{'allow':![],'reason':_0x2b0810(0x34a),'token':null}})):(await tgBot[_0x2b0810(0x273)](_0x5ee2b3[_0x2b0810(0x20e)]['id'],_0x2b0810(0x292))['catch'](_0x2df505=>{telegramError(_0x2df505);}),io['to'](_0x25e7d9)['emit'](_0x2b0810(0x232),{'access':{'allow':![],'reason':_0x2b0810(0x1e5),'token':null}}));}),tgBot[_0x5e529d(0x248)](_0x5e529d(0x25e));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0xb1bdbc=_0x25c9ed;return dbConfig[_0xb1bdbc(0x35a)](_0xb1bdbc(0x2c0))[_0xb1bdbc(0x2fa)](_0xb1bdbc(0x276))[_0xb1bdbc(0x250)]({'status':_0xb1bdbc(0x2b8)})['value']()||[];}function getDisabledBots(){const _0x49e482=_0x25c9ed;return dbConfig['get'](_0x49e482(0x2c0))['sortBy']('botID')[_0x49e482(0x250)]({'status':_0x49e482(0x30a)})[_0x49e482(0x200)]()||[];}function getBotAttributes(_0x3eccb6){const _0x454bab=_0x25c9ed;let _0x1e9ff7={};const _0x210416=configpath+_0x454bab(0x275)+_0x3eccb6+_0x454bab(0x226),_0x216185=fs[_0x454bab(0x357)](_0x210416);if(_0x216185){const _0x804162=fs[_0x454bab(0x259)](_0x210416);try{const _0x2e59f3=JSON[_0x454bab(0x2a7)](_0x804162),_0x2e74ab=_0x2e59f3?_0x2e59f3['bot'][0x0][_0x454bab(0x1fa)]:![];_0x1e9ff7[_0x454bab(0x358)]=_0x2e74ab?_0x454bab(0x30c):'manual',_0x1e9ff7['botname']=_0x2e59f3?_0x2e59f3['bot'][0x0][_0x454bab(0x2f6)]:'Bot\x20'+_0x3eccb6;}catch(_0x3d53be){_0x1e9ff7[_0x454bab(0x358)]=_0x454bab(0x29b),_0x1e9ff7[_0x454bab(0x2f6)]=_0x454bab(0x249)+_0x3eccb6;}}else _0x1e9ff7[_0x454bab(0x358)]=_0x454bab(0x29b),_0x1e9ff7['botname']=_0x454bab(0x249)+_0x3eccb6;return _0x1e9ff7;}function getBotsWithMode(){const _0x5ae764=_0x25c9ed,_0x304a35=dbConfig[_0x5ae764(0x35a)](_0x5ae764(0x2c0))['sortBy'](_0x5ae764(0x276))[_0x5ae764(0x200)]()||[];return _0x304a35[_0x5ae764(0x2de)](_0x2cc961=>{const _0x3c9e95=_0x5ae764;let _0xc7306a=getBotAttributes(_0x2cc961[_0x3c9e95(0x276)]);_0x2cc961[_0x3c9e95(0x358)]=_0xc7306a[_0x3c9e95(0x358)];}),_0x304a35;}function getBotExchanges(){const _0x4be8f6=_0x25c9ed;let _0x1672dc=[];const _0x4d0864=dbConfig[_0x4be8f6(0x35a)](_0x4be8f6(0x2c0))[_0x4be8f6(0x2fa)](_0x4be8f6(0x276))[_0x4be8f6(0x200)]()||[];_0x4d0864[_0x4be8f6(0x2de)](_0x2bde04=>{const _0x40cf03=_0x4be8f6;if(_0x2bde04[_0x40cf03(0x232)]==_0x40cf03(0x2b8)){const _0x4b0bc6=configpath+_0x40cf03(0x275)+_0x2bde04[_0x40cf03(0x276)]+_0x40cf03(0x226),_0x1ea213=fs['existsSync'](_0x4b0bc6);let _0x1789f0;if(_0x1ea213){const _0x393ba2=fs['readFileSync'](_0x4b0bc6);try{const _0x1316ba=JSON[_0x40cf03(0x2a7)](_0x393ba2);_0x1789f0=_0x1316ba?_0x1316ba[_0x40cf03(0x205)][0x0][_0x40cf03(0x21e)]:null;}catch(_0x3f7345){}}if(_0x1789f0)_0x1672dc[_0x40cf03(0x1cf)](_0x1789f0);}});const _0x1965f7=[...new Set(_0x1672dc)][_0x4be8f6(0x25a)]();return _0x1965f7;}async function initUser(){const _0x441bc8=_0x25c9ed;if(!settings['userid']){const _0x1d3dfd=uuidRandom();mixpanel[_0x441bc8(0x24d)](_0x1d3dfd),updateSetting('userid',_0x1d3dfd);}}async function initSecure(){const _0x2b96fe=_0x25c9ed;let _0x4762e2=getSecure();if(!_0x4762e2[_0x2b96fe(0x355)](_0x2b96fe(0x356))){let _0x3a03e4=await generateKeys();_0x4762e2[_0x2b96fe(0x2ef)]=_0x3a03e4[_0x2b96fe(0x2ef)],_0x4762e2['privateKey']=_0x3a03e4['privateKey'],_0x4762e2['secret']=crypto['randomBytes'](0x20)[_0x2b96fe(0x293)](_0x2b96fe(0x341));;storeSecure(_0x4762e2);}}function getSettings(){const _0x2bd366=_0x25c9ed;return dbSettings[_0x2bd366(0x35a)](_0x2bd366(0x277))[_0x2bd366(0x200)]()||{};}function getSecure(){return dbSecure['get']('secure')['value']()||{};}function getBlacklist(){const _0x2edcca=_0x25c9ed;return dbSecure[_0x2edcca(0x35a)]('blacklist')['value']()||[];}function broadcastToBots(_0x4fadc4,_0x3f351d){config['forEach'](_0x4d1a48=>{const _0x521639=_0x36f7;if(_0x4d1a48[_0x521639(0x232)]==_0x521639(0x2b8)&&_0x4d1a48[_0x521639(0x2f3)]==_0x521639(0x359)){if(pid[_0x4d1a48[_0x521639(0x276)]])pid[_0x4d1a48[_0x521639(0x276)]][_0x521639(0x2fc)]({[_0x4fadc4]:_0x3f351d});}});}function storeSettings(_0x1b7f7f,_0x208eb0=![]){const _0x3bbc58=_0x25c9ed;_0x1b7f7f={...settings,..._0x1b7f7f};if(_0x208eb0&&_0x1b7f7f[_0x3bbc58(0x33c)]!='************'&&_0x1b7f7f[_0x3bbc58(0x33c)]!=_0x3bbc58(0x1df)&&_0x1b7f7f[_0x3bbc58(0x33c)]!=''){const _0x4b0b6b=crypt[_0x3bbc58(0x31e)](secure[_0x3bbc58(0x33e)],_0x1b7f7f[_0x3bbc58(0x33c)])[_0x3bbc58(0x1d8)][_0x3bbc58(0x2ae)]('@')[0x0],_0x57d791=bcrypt[_0x3bbc58(0x2c1)](_0x4b0b6b,saltRounds);_0x1b7f7f={..._0x1b7f7f,'bbPassword':_0x57d791};}if(_0x208eb0&&_0x1b7f7f['telegramToken']!=_0x3bbc58(0x1f6)&&_0x1b7f7f[_0x3bbc58(0x28d)]!=_0x3bbc58(0x1df)&&_0x1b7f7f[_0x3bbc58(0x28d)]!=''){const _0x182cb9=crypt[_0x3bbc58(0x31e)](secure[_0x3bbc58(0x33e)],_0x1b7f7f[_0x3bbc58(0x28d)])[_0x3bbc58(0x1d8)][_0x3bbc58(0x2ae)]('@')[0x0];_0x1b7f7f={..._0x1b7f7f,'telegramToken':_0x182cb9};}const _0x5b7f01=_0x1b7f7f[_0x3bbc58(0x28d)]!=_0x3bbc58(0x1f6)&&_0x1b7f7f[_0x3bbc58(0x28d)]!=settings[_0x3bbc58(0x28d)]||_0x1b7f7f[_0x3bbc58(0x230)]!=settings[_0x3bbc58(0x230)],_0x2fbe10=_0x1b7f7f[_0x3bbc58(0x28d)]==''||_0x1b7f7f['telegramUsername']=='';if(_0x5b7f01)_0x1b7f7f['telegramEvents']='all';for(const [_0x3a6d92,_0x1034d5]of Object[_0x3bbc58(0x31c)](_0x1b7f7f)){if(_0x3a6d92==_0x3bbc58(0x28d)&&_0x1034d5==_0x3bbc58(0x1f6)){_0x1b7f7f['telegramToken']=settings[_0x3bbc58(0x28d)];continue;};if(_0x3a6d92=='bbPassword'&&_0x1034d5=='************'){_0x1b7f7f['bbPassword']=settings[_0x3bbc58(0x33c)];continue;};dbSettings[_0x3bbc58(0x364)](_0x3bbc58(0x336)+_0x3a6d92,_0x1034d5)['write']();}settings=_0x1b7f7f,io['to']('botmanager')[_0x3bbc58(0x228)](_0x3bbc58(0x277),cleanSettings()),broadcastToBots(_0x3bbc58(0x1d1),settings[_0x3bbc58(0x1d1)]);if(_0x5b7f01&&!_0x2fbe10)initTelegram();if(_0x5b7f01&&_0x2fbe10)disableTelegram();getAllClients()[_0x3bbc58(0x2de)](_0x25cb5f=>{const _0x40b606=_0x3bbc58;getSocket(_0x25cb5f['id'])[_0x40b606(0x228)](_0x40b606(0x232),{'access':{'allow':![],'reason':_0x40b606(0x34a),'token':null}});});}function updateSetting(_0x44bcb8,_0x81eda1){const _0x21bfa8=_0x25c9ed;dbSettings[_0x21bfa8(0x364)](_0x21bfa8(0x336)+_0x44bcb8,_0x81eda1)['write'](),settings=getSettings(),io['to'](_0x21bfa8(0x26e))[_0x21bfa8(0x228)]('settings',cleanSettings());}function storeSecure(_0x1eaeac){const _0x5031d3=_0x25c9ed;dbSecure[_0x5031d3(0x35a)](_0x5031d3(0x27f))['push'](_0x1eaeac)['write'](),secure=_0x1eaeac;}function addBlacklist(_0x4d4a60){const _0x2587ac=_0x25c9ed;cleanBlacklist();let _0x30ecbd;devices[_0x4d4a60][_0x2587ac(0x30b)]?_0x30ecbd=Math[_0x2587ac(0x2a3)](devices[_0x4d4a60][_0x2587ac(0x30b)][_0x2587ac(0x34c)],loginExpiry):_0x30ecbd=loginExpiry,dbSecure[_0x2587ac(0x35a)](_0x2587ac(0x2ec))[_0x2587ac(0x1cf)]({'expiry':new Date()['getTime']()+_0x30ecbd*0x3c*0x3e8,'token':devices[_0x4d4a60]['access'][_0x2587ac(0x32c)]})[_0x2587ac(0x261)](),blacklist=dbSecure[_0x2587ac(0x35a)](_0x2587ac(0x2ec))[_0x2587ac(0x200)]();}function cleanBlacklist(){const _0x479254=_0x25c9ed;let _0x16adc1=dbSecure[_0x479254(0x35a)](_0x479254(0x2ec))[_0x479254(0x1f7)]()['value'](),_0x3fe0f1=new Date()['getTime']();_0x16adc1[_0x479254(0x2de)](_0x303aa2=>{const _0x137083=_0x479254;_0x303aa2[_0x137083(0x34c)]<_0x3fe0f1&&dbSecure[_0x137083(0x35a)](_0x137083(0x2ec))[_0x137083(0x337)]({'expiry':_0x303aa2[_0x137083(0x34c)]})['write']();});}function initStates(){let _0x5df086=getConfiguration();_0x5df086['forEach'](_0x41e025=>{const _0x2634eb=_0x36f7;_0x41e025['live']=_0x2634eb(0x2c3);}),storeConfiguration(_0x5df086);}function onKeys(){const _0x1a7a87=new RSA();return new Promise(_0x39ab8f=>{const _0x13047b=_0x36f7;_0x1a7a87[_0x13047b(0x2c2)]()[_0x13047b(0x365)](_0x363b0d=>{_0x39ab8f(_0x363b0d);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x3bd274=_0x25c9ed;let _0x4f2b8c=getSettings(),_0xba0fa1=![];!_0x4f2b8c['hasOwnProperty']('lastmsgtelegram')&&(_0x4f2b8c[_0x3bd274(0x1e9)]=0x0,_0xba0fa1=!![]);!_0x4f2b8c['hasOwnProperty'](_0x3bd274(0x314))&&(_0x4f2b8c[_0x3bd274(0x314)]=0x0,_0xba0fa1=!![]);!_0x4f2b8c[_0x3bd274(0x355)](_0x3bd274(0x1e4))&&(_0x4f2b8c[_0x3bd274(0x1e4)]=_0x3bd274(0x216),_0xba0fa1=!![]);if(_0xba0fa1)storeSettings(_0x4f2b8c);}function storeConfiguration(_0x3b0689){const _0x5a6cdf=_0x25c9ed;dbConfig[_0x5a6cdf(0x35a)]('bots')['remove']()[_0x5a6cdf(0x261)](),_0x3b0689[_0x5a6cdf(0x2de)](_0xb858fe=>{const _0x367ba8=_0x5a6cdf;delete _0xb858fe[_0x367ba8(0x358)];}),dbConfig[_0x5a6cdf(0x35a)]('bots')[_0x5a6cdf(0x1cf)](..._0x3b0689)[_0x5a6cdf(0x261)](),config=_0x3b0689;}function resetPassword(){const _0x459834=_0x25c9ed;tgBot&&settings[_0x459834(0x247)]&&(tgBot[_0x459834(0x248)](_0x459834(0x25e)),tgBot[_0x459834(0x273)](settings[_0x459834(0x247)],_0x459834(0x271),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x459834(0x236)},{'text':'no','callback_data':'no'}]]}})[_0x459834(0x2e6)](_0x5e81d1=>{telegramError(_0x5e81d1);}),tgBot['on'](_0x459834(0x25e),async _0x5a5dfa=>{const _0x355afe=_0x459834,_0x377bca=_0x5a5dfa[_0x355afe(0x308)],_0x1d5fad=_0x5a5dfa[_0x355afe(0x1d8)];tgBot[_0x355afe(0x307)](_0x5a5dfa['id'])[_0x355afe(0x365)](async()=>{const _0x520f75=_0x355afe;if(_0x377bca!='no'){const _0xdf6546=0xf,_0x22f3a5=_0x520f75(0x282),_0x3d8b46=Array[_0x520f75(0x212)](crypto[_0x520f75(0x221)](new Uint32Array(_0xdf6546)))[_0x520f75(0x2f1)](_0x18591c=>_0x22f3a5[_0x18591c%_0x22f3a5[_0x520f75(0x224)]])[_0x520f75(0x328)](''),_0x1e1a14=bcrypt[_0x520f75(0x2c1)](_0x3d8b46,saltRounds);storeSettings({'bbPassword':_0x1e1a14}),await tgBot[_0x520f75(0x273)](_0x1d5fad[_0x520f75(0x20e)]['id'],_0x520f75(0x2ca)+_0x3d8b46,{'parse_mode':_0x520f75(0x2fd)})[_0x520f75(0x2e6)](_0x46398a=>{telegramError(_0x46398a);});}else await tgBot[_0x520f75(0x273)](_0x1d5fad[_0x520f75(0x20e)]['id'],_0x520f75(0x22e))[_0x520f75(0x2e6)](_0x275130=>{telegramError(_0x275130);});}),tgBot['removeListener'](_0x355afe(0x25e));}));}async function confirmRestore(_0x1a0c30,_0x5cb600){const _0x4f2a65=_0x25c9ed;tgBot&&settings[_0x4f2a65(0x247)]&&(tgBot[_0x4f2a65(0x248)](_0x4f2a65(0x25e)),await tgBot[_0x4f2a65(0x273)](settings[_0x4f2a65(0x247)],_0x4f2a65(0x2c5),{'parse_mode':_0x4f2a65(0x2fd),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x4f2a65(0x2e6)](_0xe8c23c=>{telegramError(_0xe8c23c);}),tgBot['on'](_0x4f2a65(0x25e),async _0x4fea55=>{const _0xdb5302=_0x4f2a65,_0x130089=_0x4fea55[_0xdb5302(0x308)],_0x3ac9ff=_0x4fea55[_0xdb5302(0x1d8)];tgBot[_0xdb5302(0x307)](_0x4fea55['id'])[_0xdb5302(0x365)](async()=>{const _0x474b1d=_0xdb5302;_0x130089==_0x474b1d(0x236)?(await tgBot['sendMessage'](_0x3ac9ff[_0x474b1d(0x20e)]['id'],_0x474b1d(0x256),{'parse_mode':_0x474b1d(0x2fd)})[_0x474b1d(0x2e6)](_0x1f7435=>{telegramError(_0x1f7435);}),unzipFile(_0x1a0c30,_0x5cb600)):await tgBot[_0x474b1d(0x273)](_0x3ac9ff[_0x474b1d(0x20e)]['id'],_0x474b1d(0x1f3))['catch'](_0x4b4061=>{telegramError(_0x4b4061);});}),tgBot['removeListener'](_0xdb5302(0x25e));}));}function getServerTime(){const _0x3290ab=_0x25c9ed,_0x49dcf1=new Date();return _0x49dcf1[_0x3290ab(0x281)]()+'/'+(_0x49dcf1[_0x3290ab(0x2f2)]()+0x1)[_0x3290ab(0x293)]()[_0x3290ab(0x1bb)](0x2,'0')+'/'+_0x49dcf1[_0x3290ab(0x2eb)]()[_0x3290ab(0x293)]()[_0x3290ab(0x1bb)](0x2,'0')+'\x20'+_0x49dcf1['getHours']()[_0x3290ab(0x293)]()['padStart'](0x2,'0')+':'+_0x49dcf1[_0x3290ab(0x333)]()[_0x3290ab(0x293)]()[_0x3290ab(0x1bb)](0x2,'0')+':'+_0x49dcf1['getSeconds']()[_0x3290ab(0x293)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x26bf57=_0x25c9ed,_0x73d322=shiftedTime();return _0x73d322[_0x26bf57(0x281)]()+'/'+(_0x73d322[_0x26bf57(0x2f2)]()+0x1)[_0x26bf57(0x293)]()[_0x26bf57(0x1bb)](0x2,'0')+'/'+_0x73d322[_0x26bf57(0x2eb)]()[_0x26bf57(0x293)]()[_0x26bf57(0x1bb)](0x2,'0')+'\x20'+_0x73d322[_0x26bf57(0x1c3)]()[_0x26bf57(0x293)]()[_0x26bf57(0x1bb)](0x2,'0')+':'+_0x73d322[_0x26bf57(0x333)]()['toString']()[_0x26bf57(0x1bb)](0x2,'0')+':'+_0x73d322[_0x26bf57(0x2d0)]()[_0x26bf57(0x293)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x34cf03=_0x25c9ed,_0x299ec8=new Date();let _0x21fd60=_0x299ec8;if(settings['timeshift']&&settings[_0x34cf03(0x1d1)]!==0x0)_0x21fd60=fns[_0x34cf03(0x296)](_0x299ec8,{'hours':settings[_0x34cf03(0x1d1)]});return _0x21fd60;}function startScheduler(){const _0x3d3c67=_0x25c9ed,_0x504684=new Date()[_0x3d3c67(0x290)](),_0x506a2b=shiftedTime()[_0x3d3c67(0x1c3)]();_0x506a2b==0x4&&backupConfigFiles();_0x506a2b==0x0&&rotateLogFiles();_0x504684%0x6==0x0&&triggerAnalytics();_0x504684%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function backupConfigFiles(){const _0x611a1f=_0x25c9ed;fs[_0x611a1f(0x225)](configpath,{'withFileTypes':!![]})[_0x611a1f(0x2de)](_0x183010=>{const _0x85d5aa=_0x611a1f;if(!_0x183010['isDirectory']())fs[_0x85d5aa(0x2b2)](configpath+_0x183010['name'],configbackuppath+_0x183010[_0x85d5aa(0x298)]);});}function rotateLogFiles(){const _0x113286=_0x25c9ed,_0x462fee=fs[_0x113286(0x214)](logspath+'output-000.log'),_0x48877b=_0x462fee[_0x113286(0x240)]/0x400;if(_0x48877b>0x32){let _0x4b76ba=fs[_0x113286(0x225)](logspath,{'withFileTypes':!![]});_0x4b76ba['sort']((_0x598db7,_0x2d1c26)=>_0x598db7['name']<_0x2d1c26['name']?0x1:_0x2d1c26['name']<_0x598db7[_0x113286(0x298)]?-0x1:0x0),_0x4b76ba[_0x113286(0x2de)](_0x316bd7=>{const _0x34b18c=_0x113286;if(_0x316bd7[_0x34b18c(0x298)]==_0x34b18c(0x2b3))fs[_0x34b18c(0x2b2)](logspath+_0x316bd7[_0x34b18c(0x298)],logspath+_0x34b18c(0x2c8));if(_0x316bd7[_0x34b18c(0x298)]==_0x34b18c(0x347))fs[_0x34b18c(0x2b2)](logspath+_0x316bd7[_0x34b18c(0x298)],logspath+_0x34b18c(0x2b3));_0x316bd7[_0x34b18c(0x298)]=='output-000.log'&&(fs[_0x34b18c(0x2b2)](logspath+_0x316bd7[_0x34b18c(0x298)],logspath+_0x34b18c(0x347)),fs[_0x34b18c(0x2f0)](logspath+_0x316bd7['name'],''));});}}async function zipFiles(_0x2270d9){const _0x2b4c3a=_0x25c9ed;let _0x2034a4;if(_0x2270d9==_0x2b4c3a(0x27e))_0x2034a4=logspath;if(_0x2270d9==_0x2b4c3a(0x24a))_0x2034a4=configpath;let _0x4d5803=fs[_0x2b4c3a(0x225)](_0x2034a4,{'withFileTypes':!![]});const _0x3cbb5e=new require(_0x2b4c3a(0x1b4))();_0x4d5803[_0x2b4c3a(0x2de)](_0x119de3=>{const _0x2c5cd1=_0x2b4c3a;if(!_0x119de3[_0x2c5cd1(0x21b)]()){let _0x8c2c7b=fs[_0x2c5cd1(0x259)](_0x2034a4+_0x119de3[_0x2c5cd1(0x298)]);const _0x3ce643=/^bot-[0-9]{3}-config.json$/,_0x5e1dfa=_0x3ce643[_0x2c5cd1(0x238)](_0x119de3['name']);if(_0x5e1dfa){const _0x3bd76f=JSON['parse'](_0x8c2c7b);_0x3bd76f[_0x2c5cd1(0x205)][0x0][_0x2c5cd1(0x20f)]=_0x2c5cd1(0x1df),_0x3bd76f[_0x2c5cd1(0x205)][0x0][_0x2c5cd1(0x2c4)]='***',_0x8c2c7b=JSON[_0x2c5cd1(0x325)](_0x3bd76f,null,0x2);}if(_0x119de3[_0x2c5cd1(0x298)]==_0x2c5cd1(0x25b)){const _0x591d0e=JSON['parse'](_0x8c2c7b);if(_0x591d0e[_0x2c5cd1(0x277)][_0x2c5cd1(0x34d)])_0x591d0e[_0x2c5cd1(0x277)][_0x2c5cd1(0x34d)]=![];if(_0x591d0e[_0x2c5cd1(0x277)][_0x2c5cd1(0x33c)])_0x591d0e[_0x2c5cd1(0x277)][_0x2c5cd1(0x33c)]='***';if(_0x591d0e['settings'][_0x2c5cd1(0x28d)])_0x591d0e['settings']['telegramToken']=_0x2c5cd1(0x1df);if(_0x591d0e['settings'][_0x2c5cd1(0x247)])_0x591d0e[_0x2c5cd1(0x277)][_0x2c5cd1(0x247)]=null;_0x8c2c7b=JSON['stringify'](_0x591d0e,null,0x2);}if(_0x119de3[_0x2c5cd1(0x298)]!='bb-secure.json')_0x3cbb5e[_0x2c5cd1(0x326)](_0x119de3[_0x2c5cd1(0x298)],_0x8c2c7b);}});const _0x389776=_0x3cbb5e[_0x2b4c3a(0x278)]({'base64':![],'compression':_0x2b4c3a(0x2ac)});fs[_0x2b4c3a(0x2f0)](zippath+(_0x2270d9+'.zip'),_0x389776,_0x2b4c3a(0x1b7));}async function unzipFile(_0x3d74de,_0x2a907e){const _0x19f19d=_0x25c9ed;await backupConfigFiles(),fs[_0x19f19d(0x225)](configpath,{'withFileTypes':!![]})[_0x19f19d(0x2de)](_0x15f6fe=>{const _0x6494c0=_0x19f19d;if(!_0x15f6fe[_0x6494c0(0x21b)]())fs[_0x6494c0(0x218)](configpath+_0x15f6fe['name']);});const _0xdef36d=fs[_0x19f19d(0x259)](_0x3d74de+_0x2a907e,'binary'),_0x5c767f=new require(_0x19f19d(0x1b4))(_0xdef36d,{'base64':![],'checkCRC32':!![]});Object[_0x19f19d(0x25f)](_0x5c767f[_0x19f19d(0x303)])[_0x19f19d(0x2de)](_0x351ca3=>{const _0x1b60a8=_0x19f19d,_0x47106e=_0x5c767f[_0x1b60a8(0x303)][_0x351ca3];fs[_0x1b60a8(0x2f0)](configpath+_0x47106e[_0x1b60a8(0x298)],_0x47106e[_0x1b60a8(0x1b8)]);}),fs[_0x19f19d(0x225)](temppath,{'withFileTypes':!![]})[_0x19f19d(0x2de)](_0x4ff91f=>{const _0x1d0149=_0x19f19d;if(!_0x4ff91f['isDirectory']())fs[_0x1d0149(0x218)](temppath+_0x4ff91f['name']);}),process[_0x19f19d(0x2fc)]({'restore':!![]},_0x245111=>{});}async function getPublicIp(){const _0x41815d=_0x25c9ed;try{const _0x355e48=await axios[_0x41815d(0x35a)](_0x41815d(0x2cc));publicip=_0x355e48[_0x41815d(0x308)]['ip'];}catch(_0x377f6f){}}async function triggerAnalytics(){const _0x15f4a0=_0x25c9ed;if(!publicip)await getPublicIp();const _0xb4a8ac=getBotsWithMode();let _0x1dd8b8=0x0;_0xb4a8ac['forEach'](_0x4ed00e=>{const _0x5043ea=_0x36f7;if(_0x4ed00e[_0x5043ea(0x232)]===_0x5043ea(0x2b8))_0x1dd8b8++;});const _0x360404=getBotExchanges();mixpanel['track']('Server',{'distinct_id':settings[_0x15f4a0(0x32d)],'ip':publicip,'version':serverversion,'numbots':_0xb4a8ac['length'],'numbotsenabled':_0x1dd8b8,'exchanges':_0x360404});}async function getMessages(){const _0xc8a36a=_0x25c9ed,_0x3a4f16=_0xc8a36a(0x1f5),_0x294647=new GraphQLClient(_0x3a4f16),_0x3faced={'authorization':_0xc8a36a(0x301)},_0x273b11=serverversion['split']('.'),_0x9c62e3=_0x273b11[0x0]+'.'+_0x273b11[0x1],_0xd6302c=Math[_0xc8a36a(0x35f)](settings[_0xc8a36a(0x1e9)],settings['lastmsgemitted']),_0x2d14e6={'last':parseInt(_0xd6302c),'bbm':_0x9c62e3},_0x2d29f4=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x255350;try{_0x255350=await _0x294647[_0xc8a36a(0x1e6)](_0x2d29f4,_0x2d14e6,_0x3faced);}catch(_0x55f3fc){}if(_0x255350&&_0x255350[_0xc8a36a(0x26c)]){let _0xba6b0e=settings['lastmsgtelegram'];newMessages=[];for(const _0x5ee8e of _0x255350[_0xc8a36a(0x26c)]){newMessages['push'](_0x5ee8e);if(_0x5ee8e[_0xc8a36a(0x1eb)])updateSetting(_0xc8a36a(0x1e4),_0x5ee8e[_0xc8a36a(0x1eb)]);let _0x58227d=_0x5ee8e['bbvNew']?serverversion>=_0x5ee8e[_0xc8a36a(0x1eb)]:![];if(!_0x58227d&&_0x5ee8e[_0xc8a36a(0x23d)]>_0xba6b0e){if(_0x5ee8e[_0xc8a36a(0x254)]===_0xc8a36a(0x27a)||serverversion[_0xc8a36a(0x33a)](_0x5ee8e[_0xc8a36a(0x254)])){let _0x1429c9=''+_0x5ee8e[_0xc8a36a(0x242)]+'\x0a\x0a'+_0x5ee8e[_0xc8a36a(0x1d8)];const _0x18c4e8=await sendTelegramMsg(toTelegramMarkdown(_0x1429c9),'Markdown');if(_0x18c4e8)_0xba6b0e=_0x5ee8e[_0xc8a36a(0x23d)];}}}updateAvailable=isNewerVersion(settings[_0xc8a36a(0x1e4)],serverversion),updateSetting(_0xc8a36a(0x1e9),_0xba6b0e),emitMessages();}}function emitMessages(){const _0x28b528=_0x25c9ed,_0x5f5779=settings[_0x28b528(0x314)];let _0x36c014=[];newMessages['forEach'](_0x181e88=>{const _0x192283=_0x28b528;_0x181e88['number']>_0x5f5779&&_0x36c014[_0x192283(0x1cf)](_0x181e88);}),_0x36c014[_0x28b528(0x224)]>0x0&&getAllClients()[_0x28b528(0x2de)](_0x492e33=>{const _0xbed0ce=_0x28b528;getSocket(_0x492e33['id'])[_0xbed0ce(0x228)](_0xbed0ce(0x1d8),_0x36c014);});}function confirmMessage(_0x24cde9){const _0x2d7659=_0x25c9ed;updateSetting(_0x2d7659(0x314),Number(_0x24cde9));}function isNewerVersion(_0x53f2da,_0x5bbff7){const _0x8cf117=_0x25c9ed,_0x32a45f=_0x5bbff7[_0x8cf117(0x2ae)]('.'),_0x2b35a3=_0x53f2da[_0x8cf117(0x2ae)]('.');for(var _0x8243c5=0x0;_0x8243c5<_0x2b35a3[_0x8cf117(0x224)];_0x8243c5++){const _0x366b04=~~_0x2b35a3[_0x8243c5],_0x4106f6=~~_0x32a45f[_0x8243c5];if(_0x366b04>_0x4106f6)return!![];if(_0x366b04<_0x4106f6)return![];}return![];}function toTelegramMarkdown(_0x4a7620){const _0x553cd8=_0x25c9ed,_0x36054f=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3cf5b9=/\*{2}(.+?)\*{2}/gim;return _0x4a7620=_0x4a7620[_0x553cd8(0x2cd)](_0x36054f,_0x553cd8(0x286))['replace'](_0x3cf5b9,_0x553cd8(0x235)),_0x4a7620;}async function validateConfigFile(){const _0xd9510b=_0x25c9ed,_0x3ee148=dbConfig[_0xd9510b(0x35a)](_0xd9510b(0x2c0))[_0xd9510b(0x2fa)](_0xd9510b(0x276))[_0xd9510b(0x200)]()||[];if(_0x3ee148[_0xd9510b(0x224)]==0x0){let _0x184048=0x0,_0x456be0=[];const _0x603a0a=/^bot-([0-9]{3})-config.json$/,_0x4aeb27=fs[_0xd9510b(0x225)](configpath);_0x4aeb27[_0xd9510b(0x2de)](_0x319cee=>{const _0x1ebe51=_0xd9510b,_0x3bb74b=_0x603a0a['exec'](_0x319cee);if(_0x3bb74b){const _0x475976=_0x3bb74b[0x1];let _0x1a1631=getBotAttributes(_0x475976);_0x456be0[_0x1ebe51(0x1cf)]({'botID':_0x475976,'botname':_0x1a1631[_0x1ebe51(0x2f6)],'status':'disabled','live':'stopped'}),_0x184048++;}}),_0x184048!=0x0&&(dbConfig[_0xd9510b(0x35a)](_0xd9510b(0x2c0))[_0xd9510b(0x207)](_0x456be0)[_0xd9510b(0x261)](),config=_0x456be0,restoredConfigFile=_0x184048);}}async function restoreConfigNotify(_0x5a371d){const _0x1f8276=_0x25c9ed;let _0xfdcbdb;if(restoredConfigFile==0x1)_0xfdcbdb=_0x1f8276(0x35b);else _0xfdcbdb=_0x1f8276(0x1e7);if(_0x5a371d)io['to'](_0x1f8276(0x26e))['emit'](_0x1f8276(0x237),_0xfdcbdb);else{logger['simple'](_0x1f8276(0x227)),logger[_0x1f8276(0x1c8)](_0xfdcbdb),logger[_0x1f8276(0x1c8)](_0x1f8276(0x227)),logger[_0x1f8276(0x1c8)]('');if(tgBot&&settings[_0x1f8276(0x247)]&&settings[_0x1f8276(0x1b6)]!='orders')tgBot[_0x1f8276(0x273)](settings[_0x1f8276(0x247)],'Bot\x20Mgr\x20>\x20'+_0xfdcbdb)[_0x1f8276(0x2e6)](_0x1ef779=>{telegramError(_0x1ef779);});}}function validateCredentials(_0x2179fa,_0x52d6a5){const _0x40b43f=_0x25c9ed;if(_0x2179fa[_0x40b43f(0x260)]==settings['bbUsername']&&bcrypt[_0x40b43f(0x21a)](_0x2179fa[_0x40b43f(0x268)],settings[_0x40b43f(0x33c)])){if(settings[_0x40b43f(0x34b)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x555c26=generateLoginToken(_0x52d6a5);return{'allow':!![],'reason':_0x40b43f(0x20b),'token':_0x555c26};}}else return{'allow':![],'reason':_0x40b43f(0x2cb),'token':null};}function refreshToken(_0x207013){const _0x4739f6=_0x25c9ed,_0x35e592=generateLoginToken(_0x207013);return{'allow':!![],'reason':_0x4739f6(0x20b),'token':_0x35e592};}function validateAccess(_0x3f28cd,_0x38f069,_0x335431){const _0x228e01=_0x25c9ed,_0x65322e=_0x335431?_0x335431:devices[_0x38f069]['ip'];let _0xd55054;const _0x62e19a=_0x45c52d=>{const _0x465348=_0x36f7;if(settings[_0x465348(0x34d)]){if(settings[_0x465348(0x34b)]){if(telegram2FaApproved(_0x38f069)){const _0x51f74c=generateLoginToken(_0x38f069);return{'allow':!![],'reason':_0x465348(0x322),'token':_0x51f74c};}else return{'allow':![],'reason':_0x465348(0x1d0),'token':null};}else return _0xd55054=validToken(_0x45c52d,_0x38f069),_0xd55054[_0x465348(0x355)](_0x465348(0x1d6))?{'allow':!![],'reason':_0x465348(0x1ea),'token':_0x45c52d}:{'allow':![],'reason':_0x465348(0x1d0),'token':null};}else return{'allow':!![],'reason':_0x465348(0x28c),'token':null};};if(settings[_0x228e01(0x1ed)]){let _0x33cb45=[...settings[_0x228e01(0x234)],_0x228e01(0x264),_0x228e01(0x315),_0x228e01(0x2e2)];if(_0x33cb45['includes'](_0x65322e))return _0x62e19a(_0x3f28cd);else{_0xd55054=validToken(_0x3f28cd,_0x38f069);if(_0xd55054[_0x228e01(0x355)](_0x228e01(0x1d6)))return _0x62e19a(_0x3f28cd);else{if(telegramIpApproved(_0x38f069)){const _0xf708d4=generateToken(_0x38f069);return _0xd55054=_0x62e19a(_0x3f28cd),_0xd55054['allow']?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0xf708d4}:_0xd55054;}else return settings[_0x228e01(0x1de)]?{'allow':![],'reason':_0x228e01(0x1b9),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x62e19a(_0x3f28cd);}function timelyDecrypt(_0x430757,_0x494802=!![]){const _0x715ed7=_0x25c9ed;if(_0x430757)try{const _0x5a328c=crypt[_0x715ed7(0x31e)](secure[_0x715ed7(0x33e)],_0x430757)['message'],_0x34e8fe=_0x5a328c[_0x715ed7(0x2ae)]('@')[0x0],_0xd62183=_0x5a328c[_0x715ed7(0x2ae)]('@')[0x1],_0x5f3a4c=new Date()[_0x715ed7(0x1e1)]();if(_0x494802){if(_0x5f3a4c-_0xd62183<maxSecretAge*0x3e8)return _0x34e8fe;else return![];}else return _0x34e8fe;}catch(_0x54b104){return![];}else return![];}const validToken=(_0xfcb6f9,_0x1bc78c)=>{const _0x524d80=_0x25c9ed,_0x2baa62=devices[_0x1bc78c]['ip'];if(!_0xfcb6f9)return{'error':_0x524d80(0x354)};for(let _0x52876e of blacklist){if(_0x52876e[_0x524d80(0x32c)]==_0xfcb6f9)return{'error':_0x524d80(0x2e0)};}let _0x5071d7;try{_0x5071d7=jwt[_0x524d80(0x2bd)](_0xfcb6f9,secure['secret']+_0x1bc78c);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x5071d7[_0x524d80(0x355)](_0x524d80(0x219))&&!_0x5071d7[_0x524d80(0x355)](_0x524d80(0x260))||!_0x5071d7[_0x524d80(0x355)](_0x524d80(0x2a5)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x5071d7[_0x524d80(0x355)]('username')&&_0x5071d7[_0x524d80(0x355)](_0x524d80(0x219))){const {clientip:_0x4332a0}=_0x5071d7;return _0x2baa62==_0x4332a0?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x5071d7['hasOwnProperty'](_0x524d80(0x260))&&_0x5071d7['hasOwnProperty']('clientip')){const {username:_0x17a1c8,clientip:_0x26bcf9}=_0x5071d7;return settings['bbUsername']==_0x17a1c8&&_0x2baa62==_0x26bcf9?{'success':_0x524d80(0x26f)}:{'error':_0x524d80(0x209)};}}},generateLoginToken=_0xcd544a=>{const _0x11bca9=_0x25c9ed;if(_0xcd544a){const _0x540ae4=devices[_0xcd544a]['ip'];return jwt[_0x11bca9(0x2a8)]({'username':settings[_0x11bca9(0x2b7)],'clientip':_0x540ae4},secure[_0x11bca9(0x356)]+_0xcd544a,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x5a7d0f=>{const _0x4c9a17=_0x25c9ed;if(_0x5a7d0f){const _0x2ed36b=devices[_0x5a7d0f]['ip'];return jwt[_0x4c9a17(0x2a8)]({'clientip':_0x2ed36b},secure[_0x4c9a17(0x356)]+_0x5a7d0f,{'expiresIn':devices[_0x5a7d0f]['telegramIpApproval'][_0x4c9a17(0x34c)]*0x3c});}else return![];},telegramIpApproved=_0x1bf93f=>{const _0x243d0f=_0x25c9ed;let _0x2bc064=![];return devices[_0x1bf93f][_0x243d0f(0x30b)]&&devices[_0x1bf93f][_0x243d0f(0x30b)][_0x243d0f(0x34c)]!=_0x243d0f(0x25c)&&(_0x2bc064=devices[_0x1bf93f][_0x243d0f(0x30b)][_0x243d0f(0x219)]==devices[_0x1bf93f]['ip']&&new Date()['getTime']()-devices[_0x1bf93f][_0x243d0f(0x30b)][_0x243d0f(0x210)]<devices[_0x1bf93f]['telegramIpApproval'][_0x243d0f(0x34c)]*0x3c*0x3e8),_0x2bc064;},telegram2FaApproved=_0x3466b4=>{const _0x44ea2d=_0x25c9ed;let _0x4a678e=![];return devices[_0x3466b4][_0x44ea2d(0x1d9)]&&devices[_0x3466b4]['telegram2FaApproval'][_0x44ea2d(0x34c)]!=_0x44ea2d(0x25c)&&(_0x4a678e=devices[_0x3466b4][_0x44ea2d(0x1d9)]['clientip']==devices[_0x3466b4]['ip']&&new Date()[_0x44ea2d(0x1e1)]()-devices[_0x3466b4][_0x44ea2d(0x1d9)][_0x44ea2d(0x210)]<devices[_0x3466b4][_0x44ea2d(0x1d9)]['expiry']*0x3c*0x3e8),_0x4a678e;},normalizeIP=_0x1a4f86=>{const _0x30ae68=_0x25c9ed;let _0x1fd06e=null,_0x1f6dfe=null;if(ipaddr['isValid'](_0x1a4f86)){const _0x3a0a19=ipaddr[_0x30ae68(0x2a7)](_0x1a4f86);_0x3a0a19[_0x30ae68(0x2f5)]()==='ipv6'?(_0x3a0a19[_0x30ae68(0x35e)]()&&(_0x1fd06e=_0x3a0a19['toIPv4Address']()['toString']()),_0x1f6dfe=_0x3a0a19[_0x30ae68(0x293)]()):(_0x1fd06e=_0x3a0a19[_0x30ae68(0x293)](),_0x1f6dfe=_0x3a0a19[_0x30ae68(0x1d4)]()['toString']());}return{'show':_0x1fd06e?_0x1fd06e:_0x1f6dfe,'store':_0x1f6dfe};};function sleep(_0x2144ef){return new Promise(_0x4a4956=>setTimeout(_0x4a4956,_0x2144ef));}