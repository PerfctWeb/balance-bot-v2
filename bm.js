const _0x5264f4=_0x305e;(function(_0x249a9b,_0x38c61c){const _0x3908c9=_0x305e,_0x5697be=_0x249a9b();while(!![]){try{const _0x5190e3=parseInt(_0x3908c9(0x2bd))/0x1+-parseInt(_0x3908c9(0x299))/0x2*(-parseInt(_0x3908c9(0x198))/0x3)+-parseInt(_0x3908c9(0x1a6))/0x4+-parseInt(_0x3908c9(0x22b))/0x5*(parseInt(_0x3908c9(0x232))/0x6)+-parseInt(_0x3908c9(0x2f3))/0x7*(parseInt(_0x3908c9(0x187))/0x8)+-parseInt(_0x3908c9(0x305))/0x9*(-parseInt(_0x3908c9(0x1e2))/0xa)+-parseInt(_0x3908c9(0x1df))/0xb;if(_0x5190e3===_0x38c61c)break;else _0x5697be['push'](_0x5697be['shift']());}catch(_0x3ea74b){_0x5697be['push'](_0x5697be['shift']());}}}(_0x3b49,0xbe86d));const _0x2ee602=function(){let _0x5a86b8=!![];return function(_0x38af3b,_0xb1c8b2){const _0xe2a99=_0x5a86b8?function(){if(_0xb1c8b2){const _0x52696a=_0xb1c8b2['apply'](_0x38af3b,arguments);return _0xb1c8b2=null,_0x52696a;}}:function(){};return _0x5a86b8=![],_0xe2a99;};}(),_0x5bd626=_0x2ee602(this,function(){const _0x3193b6=_0x305e;return _0x5bd626[_0x3193b6(0x2b1)]()['search'](_0x3193b6(0x1f1))[_0x3193b6(0x2b1)]()[_0x3193b6(0x229)](_0x5bd626)[_0x3193b6(0x24c)](_0x3193b6(0x1f1));});_0x5bd626();'use strict';process['env'][_0x5264f4(0x1d7)]=0x1;const childProcess=require(_0x5264f4(0x275)),fs=require('fs'),fns=require(_0x5264f4(0x2d0)),low=require(_0x5264f4(0x2cb)),FileSync=require('lowdb/adapters/FileSync'),path=require('path'),crypto=require(_0x5264f4(0x173)),Crypt=require(_0x5264f4(0x2e7))[_0x5264f4(0x1c8)],RSA=require(_0x5264f4(0x2e7))['RSA'],bcrypt=require(_0x5264f4(0x22a)),jwt=require(_0x5264f4(0x181)),ipaddr=require(_0x5264f4(0x192)),argv=require('yargs/yargs')(process['argv'][_0x5264f4(0x204)](0x2))[_0x5264f4(0x2e1)],uuidRandom=require(_0x5264f4(0x23b)),TelegramBot=require(_0x5264f4(0x2b3)),Mixpanel=require(_0x5264f4(0x240)),axios=require('axios'),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x5264f4(0x1e5)),fileUpload=require('express-fileupload'),PORT=argv[_0x5264f4(0x1a0)]||_0x5264f4(0x2b5),pattern=/^[0-9]{2,4}$/;!pattern[_0x5264f4(0x253)](PORT)&&(console['log'](_0x5264f4(0x1ba)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x5264f4(0x176)](0x1));const HOST=argv[_0x5264f4(0x2a3)]||null,userID=argv['user']||'';let bbpath=_0x5264f4(0x2d3),bbpath2='';const botfile=_0x5264f4(0x200),configfile=_0x5264f4(0x29b),settingsfile=_0x5264f4(0x222),securefile=_0x5264f4(0x1aa);let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);function _0x3b49(){const _0x1531a8=['the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','get-messages','ipc','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','stopPolling','reload','telegramEvents','success','ipaddr.js','chat','getSeconds','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','backup/','Token\x20blacklisted','42YYDtkR','polling_error','name','index.html','reject','size','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','stringify','port','randomBytes','temporary\x20access\x20not\x20allowed','5\x20min','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','toIPv4MappedAddress','1257168LbiZZB','unlinkSync','reason','/enable\x20-\x20enable\x20notifications\x0a','bb-secure.json','get-logs','settings.','then','sendPortfolioTelegram','output-002.log','onText','padStart','compareSync','Server','generateKeyPairAsync','handshake','files','exec','*$1*','write','Error:\x20Invalid\x20argument\x20','new-disabled','store-configuration','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','starting\x20bot\x20|\x20Bot\x20','clients','-results.json','allow','headers','\x20|\x20','404\x20Not\x20Found','mode','number','access','Crypt','https://api.ipify.org?format=json','Invalid\x20authentication\x20token\x20(2)','error\x20while\x20deleting\x20config\x20files:\x20','token','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','writeFileSync','\x20only\x0a','output-000.log','listen','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','telegram2FaApproval','2FA\x20required','\x20minutes','loginRequired','NTBA_FIX_319','whitelist','Login\x20accepted','telegramIpApproval','delete-alerts','stopped','username','deleteHistoryAlerts','1683121FXBpyo','enabled\x20Bot\x20','getTime','25910UidZXX','args','DEFLATE','util','Invalid\x20username\x20or\x20IP\x20address','backup','readFileSync','update-bb','push','auto','Failed\x20to\x20download\x20','File\x20uploaded','-----------------------------------------------------------------------------------','telegramEnabled','getHours','(((.+)+)+)+$','Invalid\x20IP\x20address','sockets','starting\x20new\x20bot\x20|\x20Bot\x20','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','version','disabled','hex','notification','/:bot/portfolio','remove','split','Unauthorized\x20attempt\x20to\x20update\x20settings','emit','defaults','bot.js','showConfig','SIGTERM','f2aRequired','slice','hasOwnProperty','decrypt','remoteAddress','telegram','All','join','expiry','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','socket','removeListener','copyFileSync','format','temporaryAccessAllowed','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','timeshift','Ok,\x20will\x20send\x20alert\x20notifications\x20only','keys','_data','logs','map','post','version.json','disconnect','orders','kind','Restore\x20process\x20aborted','alerts','Unauthorized\x20attempt\x20to\x20delete\x20alerts','User\x20has\x20been\x20validated','bb-settings.json','entries','/update\x20-\x20update\x20Balance\x20Bot\x0a','Unauthorized\x20attempt\x20to\x20get\x20messages','match','Unauthorized\x20attempt\x20to\x20get\x20logs','clientip','constructor','bcryptjs','1495hpfJgx','Ok,\x20will\x20send\x20order\x20notifications\x20only','forEach','2FA','replace','get','type','2802LJzPgI','show-config','getPortfolio','disabled\x20Bot\x20','params','Yes','error','config/','Restoring\x20bot(s)\x20from\x20backup','uuid-random','************','answerCallbackQuery','Bot\x20Mgr\x20>\x20','telegramUsername','mixpanel','bots','::ffff:127.0.0.1','mkdirSync','Password\x20has\x20been\x20reset\x20to:\x20','removeAllListeners','Notifications\x20enabled','Notifications\x20types:\x20','Invalid\x20Telegram\x20token','Unauthorized\x20attempt\x20to\x20get\x20portfolio','data','2FA\x20login\x20required','search','tkn','messages','blacklist','createWriteStream','assign','download','test','bot-','createServer','lastmsgtelegram','You\x20can\x20use\x20the\x20following\x20commands:\x0a','place-order','sort','statSync','***','existsSync','initclient','login\x20not\x20required','Notifications\x20disabled','.zip','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','getMinutes','telegrammsg','headless','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','callback_query','RSA-OAEP','lastmsgemitted','backupfile','set','-performance.json','/upload-backup','isDirectory','Markdown','logs/','/names\x20-\x20show\x20bot\x20names\x0a','add','any','login\x20token\x20valid','child_process','binary','delete-bot','/:bot/performance','Unauthorized\x20attempt\x20to\x20log\x20out','stop','temporary\x20access\x20timeout','HTML','filter','full','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','toggleBotMode','inherit','conn','Bot\x20','/:bot/history','show','get-portfolio','getDate','Unauthorized\x20attempt\x20to\x20download\x20','exp','/output-000.log','userid','includes','Notifications\x20disabled\x0a','live','hashSync','Unauthorized\x20attempt\x20to\x20update\x20bot','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','use','6b67f3d61ee94b8f5c80b4affef4c4d9','store','pidRefreshToken','botID','order','202578uEktQO','uncaughtException','bb-config.json','manual','server','new','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','2FA\x20login\x20rejected','started','Unauthorized\x20attempt\x20to\x20confirm\x20message','host','restarting\x20Bot\x20','sendFile','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','once','output-001.log','readdirSync','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Unauthorized\x20attempt\x20to\x20add\x20bot','simple','botmanager','$1_$2_$3','\x20>\x20','Login\x20rejected','toString','logged\x20out','node-telegram-bot-api','sortBy','3000','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','getMonth','showname','sign','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','log','socket.io','347776IQalmT','all','bbvNew','enabled','/:bot/configuration','file','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','whitelistEnabled','randomFillSync','0.0.0','pidExpireLogin','settings','getFullYear','static','lowdb','secure','bbvReceive','encryptedUuid','build2','date-fns','login','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','bb/','::1','bbPassword','deleted\x20Bot\x20','rmSync','send','Unauthorized\x20attempt\x20to\x20delete\x20bot','apiSecret','fork','Orders','referer','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','-events.json','bot','argv','http','apiKey','value','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','cloneDeep','hybrid-crypto-js','login\x20required','latestversion','startsWith','timestamp','\x20to\x20','ipv6','telegramToken','telegramChatId','botname','No\x20authentication\x20token','password','1950438fGnmAl','Notifications\x20enabled\x0a','/on\x20-\x20start\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','toggle-bot-mode','status','No\x20bots\x20running\x20right\x20now','logout','message','updatebotmanager','get-starting-balances','sendMessage','connection','node-zip','isValid','length','publicKey','parse','621DijzND','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Unauthorized\x20attempt\x20to\x20show\x20configuration','privateKey','verify','find','secret','build','invalid\x20credentials','reset-password','from','temporary\x20token\x20generated','/download/:type','-config.json','catch','crypto','restart','bbUsername','exit','</b>\x20?','function',':\x20Bot\x20Mgr\x20>\x20','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','All\x20bots\x20running\x20right\x20now','storeHeadless','\x20(1)','uuid','yes','SIGINT','jsonwebtoken','1000','store-settings','kill','idling\x20bot\x20\x20\x20|\x20Bot\x20','Alerts','16CuLzcq','confirm-message','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'];_0x3b49=function(){return _0x1531a8;};return _0x3b49();}const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x5264f4(0x1bf)),configpath=userID?bbpath+_0x5264f4(0x239)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x5264f4(0x196),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x5264f4(0x270),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+'zip/',loggerfile=fs[_0x5264f4(0x250)](logspath+_0x5264f4(0x28a),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+'temp/';!fs[_0x5264f4(0x25c)](configpath)&&fs[_0x5264f4(0x243)](configpath);!fs[_0x5264f4(0x25c)](configbackuppath)&&fs[_0x5264f4(0x243)](configbackuppath);!fs[_0x5264f4(0x25c)](logspath)&&fs[_0x5264f4(0x243)](logspath);!fs[_0x5264f4(0x25c)](zippath)&&fs[_0x5264f4(0x243)](zippath);!fs[_0x5264f4(0x25c)](temppath)&&fs[_0x5264f4(0x243)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x5264f4(0x1ff)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x5264f4(0x2c6)}})[_0x5264f4(0x1b9)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x5264f4(0x1ff)]({'secure':{},'blacklist':[]})[_0x5264f4(0x1b9)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x5264f4(0x268)});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x5264f4(0x294),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x5264f4(0x2ee)]&&settings['telegramToken']!=''&&settings[_0x5264f4(0x23f)]&&settings['telegramUsername']!='')initTelegram();const logger={'screen':_0x1c5d5d=>{const _0x18b3a3=_0x5264f4;console[_0x18b3a3(0x2bb)](_0x1c5d5d);},'simple':_0x2e7ceb=>{const _0x5b82d0=_0x5264f4;console[_0x5b82d0(0x2bb)](_0x2e7ceb),loggerfile['write'](util[_0x5b82d0(0x210)](_0x2e7ceb)+'\x0a');},'full':async _0x819445=>{const _0x16da25=_0x5264f4,_0x15814b=getTimeStamp()+_0x16da25(0x179)+_0x819445;console[_0x16da25(0x2bb)](_0x15814b),loggerfile['write'](util['format'](_0x15814b)+'\x0a');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x16da25(0x21c))await tgBot[_0x16da25(0x2fe)](settings[_0x16da25(0x2ef)],_0x16da25(0x23e)+_0x819445)[_0x16da25(0x172)](_0x5a1a39=>{telegramError(_0x5a1a39);});}};process['on'](_0x5264f4(0x29a),function(_0x5aa28){const _0x4e8bd6=_0x5264f4;logger[_0x4e8bd6(0x2ac)](_0x5aa28);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x5264f4(0x21a))[_0x5264f4(0x1f6)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x5264f4(0x2e2))[_0x5264f4(0x255)](app);app[_0x5264f4(0x293)](fileUpload({'useTempFiles':!![]})),app[_0x5264f4(0x230)](_0x5264f4(0x170),async(_0x370d27,_0x591c5e)=>{const _0x4a5fa2=_0x5264f4,_0x1a980d=_0x370d27[_0x4a5fa2(0x236)][_0x4a5fa2(0x231)],_0x264f07=getClientsWithBotID(_0x4a5fa2(0x2ad)),_0x4ddb2c=_0x370d27['headers'][_0x4a5fa2(0x17e)],_0x5625f8=timelyDecrypt(_0x4ddb2c,![]),_0x440bcd=_0x264f07[_0x4a5fa2(0x30b)](_0x44c37d=>_0x44c37d[_0x4a5fa2(0x17e)]==_0x5625f8);if(_0x440bcd){const _0xadb90e=normalizeIP(_0x370d27['socket'][_0x4a5fa2(0x207)])['store'],_0x1bfef9=_0x370d27[_0x4a5fa2(0x1c2)][_0x4a5fa2(0x24d)];if(validateAccess(_0x1bfef9,_0x5625f8,_0xadb90e)['allow'])await zipFiles(_0x1a980d),_0x591c5e[_0x4a5fa2(0x252)](zippath+(_0x1a980d+_0x4a5fa2(0x260)),_0x4ed946=>{const _0x538d10=_0x4a5fa2;_0x4ed946&&(logger[_0x538d10(0x27e)](_0x538d10(0x1ec)+_0x1a980d),logger[_0x538d10(0x2ac)](_0x4ed946));});else logger['full'](_0x4a5fa2(0x288)+_0x1a980d+_0x4a5fa2(0x17d));}else logger[_0x4a5fa2(0x27e)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x1a980d+'\x20(2)');}),app[_0x5264f4(0x219)](_0x5264f4(0x26d),async(_0xd3128f,_0x18be47)=>{const _0x42ae36=_0x5264f4,_0x7967e6=getClientsWithBotID('botmanager'),_0x45f5dd=_0xd3128f[_0x42ae36(0x1c2)][_0x42ae36(0x17e)],_0x50c7a0=timelyDecrypt(_0x45f5dd,![]),_0x103dc8=_0x7967e6['find'](_0x50e347=>_0x50e347['uuid']==_0x50c7a0);if(_0x103dc8){const _0x5b3c21=normalizeIP(_0xd3128f[_0x42ae36(0x20d)][_0x42ae36(0x207)])[_0x42ae36(0x295)],_0x11a877=_0xd3128f['headers'][_0x42ae36(0x24d)];if(validateAccess(_0x11a877,_0x50c7a0,_0x5b3c21)[_0x42ae36(0x1c1)]){if(_0xd3128f['files']){const _0x5793fd=_0xd3128f[_0x42ae36(0x1b6)][_0x42ae36(0x26a)];await _0x5793fd['mv'](temppath+_0x5793fd[_0x42ae36(0x19a)]),_0x18be47['send']({'status':!![],'message':_0x42ae36(0x1ed)});const _0x44bace=getBotsWithMode();_0x44bace['length']>0x0?confirmRestore(temppath,_0x5793fd[_0x42ae36(0x19a)]):unzipFile(temppath,_0x5793fd[_0x42ae36(0x19a)]);}}else logger[_0x42ae36(0x27e)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x42ae36(0x27e)](_0x42ae36(0x261));}),app[_0x5264f4(0x293)](express[_0x5264f4(0x2ca)](path['join'](__dirname,bbpath2,_0x5264f4(0x2cf)))),app[_0x5264f4(0x293)](express['static'](path[_0x5264f4(0x20a)](__dirname,bbpath2,'build'))),app[_0x5264f4(0x230)]('/',function(_0xbf5b,_0x3e6732){const _0x495c25=_0x5264f4;_0x3e6732[_0x495c25(0x2a5)](path[_0x495c25(0x20a)](__dirname,bbpath2,_0x495c25(0x2cf),_0x495c25(0x19b)));}),app[_0x5264f4(0x230)]('/:bot',function(_0x17e180,_0x2fef60){const _0x5aec28=_0x5264f4;_0x2fef60['sendFile'](path[_0x5aec28(0x20a)](__dirname,bbpath2,'build','index.html'));}),app[_0x5264f4(0x230)](_0x5264f4(0x1fa),(_0x181835,_0x258e34)=>{const _0x37ffa4=_0x5264f4;_0x258e34[_0x37ffa4(0x2a5)](path['join'](__dirname,bbpath2,_0x37ffa4(0x30d),_0x37ffa4(0x19b)));}),app[_0x5264f4(0x230)](_0x5264f4(0x278),(_0x4b7b2b,_0x2d3bff)=>{const _0x4ede68=_0x5264f4;_0x2d3bff[_0x4ede68(0x2a5)](path[_0x4ede68(0x20a)](__dirname,bbpath2,'build',_0x4ede68(0x19b)));}),app['get']('/:bot/coins',(_0x275fb9,_0x5847dc)=>{const _0x5c79ec=_0x5264f4;_0x5847dc[_0x5c79ec(0x2a5)](path[_0x5c79ec(0x20a)](__dirname,bbpath2,_0x5c79ec(0x30d),_0x5c79ec(0x19b)));}),app['get'](_0x5264f4(0x284),(_0x21f6fe,_0x38b7eb)=>{const _0x4323aa=_0x5264f4;_0x38b7eb['sendFile'](path[_0x4323aa(0x20a)](__dirname,bbpath2,_0x4323aa(0x30d),'index.html'));}),app[_0x5264f4(0x230)](_0x5264f4(0x2c1),(_0x3ab2d7,_0x3a8ed2)=>{const _0x468d4a=_0x5264f4;_0x3a8ed2['sendFile'](path[_0x468d4a(0x20a)](__dirname,bbpath2,_0x468d4a(0x30d),_0x468d4a(0x19b)));}),app[_0x5264f4(0x230)]('/:bot/support',(_0x3acd0e,_0x18ce91)=>{const _0x443cbc=_0x5264f4;_0x18ce91[_0x443cbc(0x2a5)](path[_0x443cbc(0x20a)](__dirname,bbpath2,_0x443cbc(0x30d),_0x443cbc(0x19b)));});if(HOST)http[_0x5264f4(0x1d1)](PORT,HOST);else http[_0x5264f4(0x1d1)](PORT);const io=require(_0x5264f4(0x2bc))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0xfc628a=_0x5264f4;logger[_0xfc628a(0x2ac)](''),logger[_0xfc628a(0x2ac)](_0xfc628a(0x1ee)),await logger[_0xfc628a(0x27e)](_0xfc628a(0x17a)+PORT),logger['simple'](_0xfc628a(0x1ee));if(config[_0xfc628a(0x302)]!=0x0)for(const _0x6022a2 of config){if(_0x6022a2['status']==_0xfc628a(0x2c0)||_0x6022a2[_0xfc628a(0x2f8)]=='new')await logger[_0xfc628a(0x27e)](_0xfc628a(0x1be)+_0x6022a2[_0xfc628a(0x297)]+_0xfc628a(0x1c3)+_0x6022a2['botname']),startBot([_0x6022a2['botID'],userID],{'cwd':bbpath},function(_0x5dabde){const _0x41a58f=_0xfc628a;if(_0x5dabde)logger[_0x41a58f(0x27e)](_0x5dabde);});else(_0x6022a2[_0xfc628a(0x2f8)]=='disabled'||_0x6022a2[_0xfc628a(0x2f8)]==_0xfc628a(0x1bb))&&await logger[_0xfc628a(0x27e)](_0xfc628a(0x185)+_0x6022a2['botID']+_0xfc628a(0x1c3)+_0x6022a2[_0xfc628a(0x2f0)]);}else!newBot&&logger[_0xfc628a(0x2ac)](_0xfc628a(0x2c3));if(newBot)addBot();logger[_0xfc628a(0x2ac)]('-----------------------------------------------------------------------------------'),logger[_0xfc628a(0x2ac)]('');}function startSocket(){const _0x503b0f=_0x5264f4;io['on'](_0x503b0f(0x2ff),_0x11a7b=>{const _0x277a5c=_0x503b0f;let _0x4811b0,_0x4d7a54,_0x1ee7c0,_0x1bb008,_0x90f56a;const _0x52d050=_0x11a7b[_0x277a5c(0x1b5)][_0x277a5c(0x1c2)][_0x277a5c(0x2dd)];_0x4d7a54=_0x52d050['match'](/bot[0-9]{3}/);if(_0x4d7a54)_0x1ee7c0=_0x4d7a54[0x0][_0x277a5c(0x226)](/[0-9]{3}/);if(_0x1ee7c0)_0x4811b0=_0x1ee7c0[0x0];else _0x4811b0=_0x277a5c(0x2ad);const _0x43a839=_0x11a7b[_0x277a5c(0x1b5)]['auth'][_0x277a5c(0x2ce)];if(!_0x43a839)_0x11a7b[_0x277a5c(0x1fe)](_0x277a5c(0x2f8),{'publicKey':secure[_0x277a5c(0x303)]});else{_0x1bb008=timelyDecrypt(_0x43a839,![]);if(!_0x1bb008)_0x11a7b[_0x277a5c(0x1fe)]('status',{'publicKey':secure['publicKey']});else{_0x90f56a=normalizeIP(_0x11a7b[_0x277a5c(0x282)][_0x277a5c(0x207)])[_0x277a5c(0x295)];if(!devices[_0x1bb008])devices[_0x1bb008]={'uuid':_0x1bb008,'access':{'token':null}};devices[_0x1bb008]['ip']=_0x90f56a;const _0x244d0c=addClient(_0x11a7b['id'],_0x1bb008,_0x4811b0);setAccess(_0x244d0c),emitMessages(),_0x11a7b['on']('login',_0x194056=>{const _0x3e4092=_0x277a5c,_0x57c206=timelyDecrypt(_0x194056[_0x3e4092(0x2f2)]);if(_0x57c206){_0x194056={'username':_0x194056[_0x3e4092(0x1dd)],'password':_0x57c206},devices[_0x1bb008]['access']=validateCredentials(_0x194056,_0x1bb008);if(devices[_0x1bb008]['access']['allow']==![]&&devices[_0x1bb008][_0x3e4092(0x1c7)][_0x3e4092(0x1a8)]==_0x3e4092(0x24b))_0x11a7b[_0x3e4092(0x1fe)](_0x3e4092(0x2f8),{'access':devices[_0x1bb008][_0x3e4092(0x1c7)]}),loginAccess2FA(_0x1bb008,_0x90f56a);else{if(devices[_0x1bb008][_0x3e4092(0x1c7)][_0x3e4092(0x1c1)]==![]&&devices[_0x1bb008][_0x3e4092(0x1c7)]['reason']==_0x3e4092(0x16c))_0x11a7b['emit'](_0x3e4092(0x2f8),{'access':devices[_0x1bb008][_0x3e4092(0x1c7)]});else devices[_0x1bb008][_0x3e4092(0x1c7)][_0x3e4092(0x1c1)]&&devices[_0x1bb008][_0x3e4092(0x1c7)]['reason']=='login\x20token\x20generated'&&(getClientsWithUuid(_0x1bb008)['forEach'](_0x54eab8=>{setAccess(_0x54eab8);}),setTokenRefresh(_0x1bb008),setSessionTimeout(_0x3e4092(0x2d1),_0x1bb008));}}else logger[_0x3e4092(0x27e)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x11a7b['on'](_0x277a5c(0x16d),()=>{resetPassword();}),_0x11a7b['on'](_0x277a5c(0x21b),_0x4b9239=>{removeClient(_0x11a7b['id']);}),_0x4811b0==_0x277a5c(0x2ad)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5e855c){const _0x8ba9f7=_0x5264f4;if(_0x5e855c!='botmanager'&&config[_0x8ba9f7(0x2e3)]!=''){if(pid[_0x5e855c])pid[_0x5e855c][_0x8ba9f7(0x2d8)]({'function':_0x8ba9f7(0x25d),'args':null});}}function reloadBotManager(){const _0x5dd1fe=_0x5264f4;getClientsWithBotID(_0x5dd1fe(0x2ad))[_0x5dd1fe(0x22d)](_0x4846c1=>{const _0xbc1e86=_0x5dd1fe;getSocket(_0x4846c1['id'])[_0xbc1e86(0x1fe)](_0xbc1e86(0x2f8),{'access':{'allow':![],'reason':_0xbc1e86(0x18f),'token':null}});});}function getSocket(_0x54982d){const _0x5a59bb=_0x5264f4;return io['sockets'][_0x5a59bb(0x1f3)][_0x5a59bb(0x230)](_0x54982d);}function setAccess(_0x3ca099){const _0x13da70=_0x5264f4,_0x434c1f=getSocket(_0x3ca099['id']),_0x4bd6d4=_0x3ca099[_0x13da70(0x17e)],_0x4d3a05=_0x3ca099[_0x13da70(0x2e0)];devices[_0x4bd6d4][_0x13da70(0x1c7)]=validateAccess(devices[_0x4bd6d4][_0x13da70(0x1c7)][_0x13da70(0x1cc)],_0x4bd6d4),_0x434c1f['join'](_0x4bd6d4);if(devices[_0x4bd6d4][_0x13da70(0x1c7)][_0x13da70(0x1c1)]){_0x434c1f['join'](_0x4d3a05);if(_0x4d3a05==_0x13da70(0x2ad))initializeSocketBotManager(_0x434c1f);else initializeSocketBot(_0x434c1f);initClient(_0x4d3a05);}devices[_0x4bd6d4][_0x13da70(0x1c7)][_0x13da70(0x1cc)]&&devices[_0x4bd6d4][_0x13da70(0x1c7)][_0x13da70(0x1a8)]==_0x13da70(0x16f)&&setSessionTimeout(_0x13da70(0x22e),_0x4bd6d4),devices[_0x4bd6d4][_0x13da70(0x1c7)][_0x13da70(0x1cc)]&&devices[_0x4bd6d4][_0x13da70(0x1c7)][_0x13da70(0x1a8)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x13da70(0x2d1),_0x4bd6d4),_0x434c1f[_0x13da70(0x1fe)](_0x13da70(0x2f8),{'status':_0x3ca099[_0x13da70(0x29d)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x4bd6d4][_0x13da70(0x1c7)],'externalip':devices[_0x4bd6d4]['ip'],'publicKey':secure[_0x13da70(0x303)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x4bd6d4]['access'][_0x13da70(0x1c1)]==![]&&devices[_0x4bd6d4][_0x13da70(0x1c7)][_0x13da70(0x1a8)]==_0x13da70(0x1d4)&&temporaryAccess2FA(_0x4bd6d4,devices[_0x4bd6d4]['ip']);}function setSessionTimeout(_0x5ec5aa,_0x1afbb5){const _0x2e417e=_0x5264f4;let _0x4c3e71;if(_0x5ec5aa==_0x2e417e(0x2d1))_0x4c3e71=loginExpiry*0x3c*0x3e8;else _0x4c3e71=devices[_0x1afbb5][_0x2e417e(0x1da)][_0x2e417e(0x20b)]*0x3c*0x3e8-(new Date()[_0x2e417e(0x1e1)]()-devices[_0x1afbb5]['telegramIpApproval'][_0x2e417e(0x2eb)]);if(devices[_0x1afbb5]['pidExpireLogin'])clearTimeout(devices[_0x1afbb5]['pidExpireLogin']);devices[_0x1afbb5][_0x2e417e(0x2c7)]=setTimeout(()=>{const _0x24ff46=_0x2e417e;if(devices[_0x1afbb5][_0x24ff46(0x296)])clearTimeout(devices[_0x1afbb5]['pidRefreshToken']);removeSocketListeners(_0x1afbb5),addBlacklist(_0x1afbb5),devices[_0x1afbb5][_0x24ff46(0x1da)]=null,devices[_0x1afbb5]['telegram2FaApproval']=null,devices[_0x1afbb5][_0x24ff46(0x1c7)][_0x24ff46(0x1cc)]=null,devices[_0x1afbb5][_0x24ff46(0x1c7)]=validateAccess(devices[_0x1afbb5][_0x24ff46(0x1c7)][_0x24ff46(0x1cc)],_0x1afbb5),!(devices[_0x1afbb5][_0x24ff46(0x1c7)][_0x24ff46(0x1c1)]&&devices[_0x1afbb5]['access'][_0x24ff46(0x1a8)]==_0x24ff46(0x25e))&&(_0x5ec5aa==_0x24ff46(0x2d1)?io['to'](_0x1afbb5)[_0x24ff46(0x1fe)]('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x1afbb5)[_0x24ff46(0x1fe)]('status',{'access':{'allow':![],'reason':_0x24ff46(0x27b),'token':null}})),devices[_0x1afbb5]['access'][_0x24ff46(0x1cc)]=null;},_0x4c3e71);}function setTokenRefresh(_0x558e65){const _0x166d5a=_0x5264f4;if(devices[_0x558e65][_0x166d5a(0x296)])clearTimeout(devices[_0x558e65]['pidRefreshToken']);devices[_0x558e65]['pidRefreshToken']=setTimeout(()=>{const _0x1721da=_0x166d5a;getClientsWithUuid(_0x558e65)['length']!=0x0?(devices[_0x558e65]['access']=refreshToken(_0x558e65),io['to'](_0x558e65)[_0x1721da(0x1fe)](_0x1721da(0x2f8),{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x558e65][_0x1721da(0x1c7)],'externalip':devices[_0x558e65]['ip'],'publicKey':secure[_0x1721da(0x303)],'validInstallation':validInstallation}),setTokenRefresh(_0x558e65)):clearTimeout(devices[_0x558e65][_0x1721da(0x296)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3a591f){const _0x46ccea=_0x5264f4,_0x4c7160=getClient(_0x3a591f['id'])['uuid'];_0x3a591f[_0x46ccea(0x1fe)](_0x46ccea(0x241),config),_0x3a591f['emit']('settings',cleanSettings()),_0x3a591f['on']('add-bot',_0x4310d7=>{const _0x78ee90=_0x46ccea;if(validateAccess(_0x4310d7,_0x4c7160)['allow'])addBot();else logger[_0x78ee90(0x27e)](_0x78ee90(0x2ab));}),_0x3a591f['on']('update-bot',(_0x5a34cb,_0x4a04f5)=>{const _0x487928=_0x46ccea;if(validateAccess(_0x4a04f5,_0x4c7160)[_0x487928(0x1c1)])toggleBot(_0x5a34cb[_0x487928(0x297)],_0x5a34cb[_0x487928(0x2f8)],_0x5a34cb[_0x487928(0x28e)]);else logger[_0x487928(0x27e)](_0x487928(0x290));}),_0x3a591f['on'](_0x46ccea(0x2f7),(_0x528c2f,_0x11f94c)=>{const _0x36266a=_0x46ccea;if(validateAccess(_0x11f94c,_0x4c7160)['allow'])toggleBotMode(_0x528c2f);else logger['full'](_0x36266a(0x290));}),_0x3a591f['on'](_0x46ccea(0x277),(_0x3b6214,_0x49fc8d)=>{const _0x21fae1=_0x46ccea;if(validateAccess(_0x49fc8d,_0x4c7160)[_0x21fae1(0x1c1)])deleteBot(_0x3b6214);else logger[_0x21fae1(0x27e)](_0x21fae1(0x2d9));}),_0x3a591f['on'](_0x46ccea(0x183),(_0x153bd5,_0x381268)=>{const _0x47e5c1=_0x46ccea;if(validateAccess(_0x381268,_0x4c7160)['allow'])storeSettings(_0x153bd5,!![]);else logger[_0x47e5c1(0x27e)](_0x47e5c1(0x1fd));}),_0x3a591f['on'](_0x46ccea(0x1e9),_0x3c1d74=>{const _0x486721=_0x46ccea;if(validateAccess(_0x3c1d74,_0x4c7160)['allow'])updateBB();else logger['full'](_0x486721(0x2f6));}),_0x3a591f['on'](_0x46ccea(0x18b),_0x78714c=>{const _0x3e6165=_0x46ccea;if(validateAccess(_0x78714c,_0x4c7160)[_0x3e6165(0x1c1)])getMessages();else logger[_0x3e6165(0x27e)](_0x3e6165(0x225));}),_0x3a591f['on'](_0x46ccea(0x188),(_0x2785f4,_0x1deb3e)=>{const _0x43a64e=_0x46ccea;if(validateAccess(_0x1deb3e,_0x4c7160)[_0x43a64e(0x1c1)])confirmMessage(_0x2785f4);else logger['full'](_0x43a64e(0x2a2));}),_0x3a591f['on'](_0x46ccea(0x2fa),_0x49aa48=>{const _0x1e6527=_0x46ccea;if(validateAccess(_0x49aa48,_0x4c7160)[_0x1e6527(0x1c1)]){if(devices[_0x4c7160][_0x1e6527(0x296)])clearTimeout(devices[_0x4c7160]['pidRefreshToken']);if(devices[_0x4c7160]['pidExpireLogin'])clearTimeout(devices[_0x4c7160][_0x1e6527(0x2c7)]);removeSocketListeners(getClient(_0x3a591f['id'])[_0x1e6527(0x17e)]),addBlacklist(_0x4c7160),devices[_0x4c7160][_0x1e6527(0x1da)]=null,devices[_0x4c7160][_0x1e6527(0x1d3)]=null,devices[_0x4c7160][_0x1e6527(0x1c7)][_0x1e6527(0x1cc)]=null,io['to'](getClient(_0x3a591f['id'])[_0x1e6527(0x17e)])[_0x1e6527(0x1fe)](_0x1e6527(0x2f8),{'access':{'allow':![],'reason':_0x1e6527(0x2b2),'token':null}});}else logger[_0x1e6527(0x27e)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x32724d){const _0x3bc191=_0x5264f4,_0x515f59=getClient(_0x32724d['id'])[_0x3bc191(0x2e0)],_0x242d7e=getClient(_0x32724d['id'])[_0x3bc191(0x17e)];_0x32724d['on'](_0x3bc191(0x1ab),(_0x321b1c,_0xed6687)=>{const _0x20045c=_0x3bc191;if(validateAccess(_0xed6687,_0x242d7e)[_0x20045c(0x1c1)]){if(pid[_0x515f59])pid[_0x515f59][_0x20045c(0x2d8)]({'function':'emitHistory','args':_0x321b1c});}else logger[_0x20045c(0x27e)](_0x20045c(0x227));}),_0x32724d['on'](_0x3bc191(0x1db),(_0xa561a,_0x33b855)=>{const _0x1ab7a1=_0x3bc191;if(validateAccess(_0x33b855,_0x242d7e)[_0x1ab7a1(0x1c1)]){if(pid[_0x515f59])pid[_0x515f59][_0x1ab7a1(0x2d8)]({'function':_0x1ab7a1(0x1de),'args':_0xa561a});}else logger[_0x1ab7a1(0x27e)](_0x1ab7a1(0x220));}),_0x32724d['on'](_0x3bc191(0x286),(_0x2f2e26,_0x25733a)=>{const _0x4f252f=_0x3bc191;if(validateAccess(_0x25733a,_0x242d7e)['allow']){if(pid[_0x515f59])pid[_0x515f59][_0x4f252f(0x2d8)]({'function':_0x4f252f(0x234),'args':_0x2f2e26});}else logger['full'](_0x4f252f(0x249));}),_0x32724d['on'](_0x3bc191(0x1bc),(_0xdd597a,_0x5c6bd6)=>{const _0x156c2f=_0x3bc191;if(validateAccess(_0x5c6bd6,_0x242d7e)[_0x156c2f(0x1c1)]){if(pid[_0x515f59])pid[_0x515f59][_0x156c2f(0x2d8)]({'function':'storeConfiguration','args':_0xdd597a});}else logger[_0x156c2f(0x27e)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x32724d['on']('store-headless',(_0x4e33ac,_0x343d16)=>{const _0x31c94d=_0x3bc191;if(validateAccess(_0x343d16,_0x242d7e)[_0x31c94d(0x1c1)]){if(pid[_0x515f59])pid[_0x515f59]['send']({'function':_0x31c94d(0x17c),'args':_0x4e33ac});}else logger['full'](_0x31c94d(0x2d2));}),_0x32724d['on'](_0x3bc191(0x2fd),_0x478356=>{const _0x53ef5c=_0x3bc191;if(validateAccess(_0x478356,_0x242d7e)[_0x53ef5c(0x1c1)]){if(pid[_0x515f59])pid[_0x515f59]['send']({'function':'getStartingBalances','args':null});}else logger[_0x53ef5c(0x27e)](_0x53ef5c(0x1d2));}),_0x32724d['on'](_0x3bc191(0x258),(_0x2480b3,_0x137196)=>{const _0x324ef9=_0x3bc191;if(validateAccess(_0x137196,_0x242d7e)[_0x324ef9(0x1c1)]){if(pid[_0x515f59])pid[_0x515f59][_0x324ef9(0x2d8)]({'function':'placeOrder','args':_0x2480b3});}else logger['full'](_0x324ef9(0x292));}),_0x32724d['on']('cancel-loading',_0x5bc227=>{const _0x2980e7=_0x3bc191;if(validateAccess(_0x5bc227,_0x242d7e)[_0x2980e7(0x1c1)]){if(pid[_0x515f59])pid[_0x515f59][_0x2980e7(0x2d8)]({'function':'cancelLoading','args':null});}else logger[_0x2980e7(0x27e)](_0x2980e7(0x2de));}),_0x32724d['on'](_0x3bc191(0x233),_0x2d70fc=>{const _0x3654b1=_0x3bc191;if(validateAccess(_0x2d70fc,_0x242d7e)[_0x3654b1(0x1c1)]){if(pid[_0x515f59])pid[_0x515f59][_0x3654b1(0x2d8)]({'function':_0x3654b1(0x201),'args':null});}else logger[_0x3654b1(0x27e)](_0x3654b1(0x308));}),_0x32724d['on']('update-bb',_0x576e33=>{if(validateAccess(_0x576e33,_0x242d7e)['allow'])updateBB();else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x32724d['on']('get-messages',_0x1c0ab1=>{const _0x3ace9e=_0x3bc191;if(validateAccess(_0x1c0ab1,_0x242d7e)[_0x3ace9e(0x1c1)])getMessages();else logger[_0x3ace9e(0x27e)](_0x3ace9e(0x225));}),_0x32724d['on']('confirm-message',(_0x3e2d31,_0x417609)=>{const _0x453a42=_0x3bc191;if(validateAccess(_0x417609,_0x242d7e)[_0x453a42(0x1c1)])confirmMessage(_0x3e2d31);else logger['full'](_0x453a42(0x2a2));}),_0x32724d['on'](_0x3bc191(0x2fa),_0x535c06=>{const _0x466f36=_0x3bc191;if(validateAccess(_0x535c06,_0x242d7e)[_0x466f36(0x1c1)]){if(devices[_0x242d7e][_0x466f36(0x296)])clearTimeout(devices[_0x242d7e][_0x466f36(0x296)]);if(devices[_0x242d7e][_0x466f36(0x2c7)])clearTimeout(devices[_0x242d7e][_0x466f36(0x2c7)]);removeSocketListeners(getClient(_0x32724d['id'])[_0x466f36(0x17e)]),addBlacklist(_0x242d7e),devices[_0x242d7e][_0x466f36(0x1da)]=null,devices[_0x242d7e]['telegram2FaApproval']=null,devices[_0x242d7e][_0x466f36(0x1c7)]['token']=null,io['to'](getClient(_0x32724d['id'])[_0x466f36(0x17e)])['emit'](_0x466f36(0x2f8),{'access':{'allow':![],'reason':_0x466f36(0x2b2),'token':null}});}else logger['full'](_0x466f36(0x279));});}function removeSocketListeners(_0xe3a9df){const _0x3a7324=_0x5264f4;getClientsWithUuid(_0xe3a9df)[_0x3a7324(0x22d)](_0x384fd7=>{const _0xaecda4=_0x3a7324;getSocket(_0x384fd7['id'])[_0xaecda4(0x245)]();});}function cleanSettings(){const _0x59a2d2=_0x5264f4;let _0x25b433=settings;return settings[_0x59a2d2(0x2ee)]&&settings['telegramToken']!=''&&(_0x25b433={..._0x25b433,'telegramToken':_0x59a2d2(0x23c)}),settings['bbPassword']&&settings[_0x59a2d2(0x2d5)]!=''&&(_0x25b433={..._0x25b433,'bbPassword':'************'}),(settings['bbPassword']&&settings[_0x59a2d2(0x2d5)]=='***'||settings[_0x59a2d2(0x2ee)]&&settings[_0x59a2d2(0x2ee)]==_0x59a2d2(0x25b))&&(_0x25b433={..._0x25b433,'restored':{'password':settings[_0x59a2d2(0x2d5)]==_0x59a2d2(0x25b),'telegram':settings[_0x59a2d2(0x2ee)]==_0x59a2d2(0x25b)}}),_0x25b433;}function updateBB(){const _0x317e2a=_0x5264f4;installingUpdate=!![],config[_0x317e2a(0x22d)](_0x2670e3=>{restartBot(_0x2670e3['botID']);}),process[_0x317e2a(0x2d8)]({'update':!![]},_0x3f5483=>{});}function startBot(_0x22cd43,_0x50caa4,_0x5433fe){const _0x46b5a9=_0x5264f4;let _0x4c1960=![];const _0x15af1d=_0x22cd43[0x0];_0x50caa4={..._0x50caa4,'stdio':[_0x46b5a9(0x281),_0x46b5a9(0x281),'inherit',_0x46b5a9(0x18c)]},pid[_0x15af1d]=childProcess[_0x46b5a9(0x2db)](botfile,_0x22cd43,_0x50caa4),pid[_0x15af1d]['on'](_0x46b5a9(0x2fb),_0x5ba17d=>{const _0x462c84=_0x46b5a9;switch(Object[_0x462c84(0x215)](_0x5ba17d)[0x0]){case _0x462c84(0x2f0):updateBotName(_0x15af1d,_0x5ba17d[_0x462c84(0x2f0)]);break;case _0x462c84(0x2fc):updateBotManager();break;case _0x462c84(0x2f8):updateStatus(_0x15af1d,_0x5ba17d[_0x462c84(0x2f8)]);break;case'live':updateLive(_0x15af1d,_0x5ba17d['live']);break;case _0x462c84(0x2a1):updateLive(_0x15af1d,_0x5ba17d['started']),io['to'](_0x15af1d)[_0x462c84(0x1fe)](_0x462c84(0x2f8),{'access':{'allow':![],'reason':_0x462c84(0x18f),'token':null}});break;case _0x462c84(0x27a):_0x5ba17d['stop']==_0x462c84(0x174)&&restartBot(_0x15af1d);_0x5ba17d[_0x462c84(0x27a)]==_0x462c84(0x184)&&toggleBot(_0x15af1d,'disabled',_0x462c84(0x1dc));break;case _0x462c84(0x208):sendTelegram(_0x15af1d,_0x5ba17d[_0x462c84(0x208)]);break;case _0x462c84(0x264):sendTelegramMsg(_0x5ba17d[_0x462c84(0x264)]);break;case'function':io['to'](_0x15af1d)['emit'](_0x5ba17d[_0x462c84(0x178)],_0x5ba17d[_0x462c84(0x1e3)]);break;}}),pid[_0x15af1d]['on'](_0x46b5a9(0x238),function(_0x2f69a5){if(_0x4c1960)return;_0x4c1960=!![],_0x5433fe(_0x2f69a5);}),pid[_0x15af1d]['on'](_0x46b5a9(0x176),async function(_0x47b40e){const _0x57e9e7=_0x46b5a9;if(installingUpdate)return;if(_0x4c1960)return;_0x4c1960=!![],_0x5433fe(null);const _0xfc5c1c=dbConfig[_0x57e9e7(0x230)](_0x57e9e7(0x241))[_0x57e9e7(0x30b)]({'botID':_0x15af1d})['value']();_0xfc5c1c&&(_0xfc5c1c[_0x57e9e7(0x2f8)]==_0x57e9e7(0x2c0)||_0xfc5c1c[_0x57e9e7(0x2f8)]==_0x57e9e7(0x29e))&&(await sleep(0x3e8),updateLive(_0x15af1d,_0x57e9e7(0x1dc)),logger[_0x57e9e7(0x27e)](_0x57e9e7(0x2a4)+_0x15af1d),startBot([_0x15af1d,userID],{'cwd':bbpath},function(_0x3f85c4){if(_0x3f85c4)logger['full'](_0x3f85c4);}));});}function stopBot(_0x1bb1b7){const _0x1efa79=_0x5264f4;getClientsWithBotID(_0x1bb1b7)['forEach'](_0x50d23e=>{const _0x4aa0d0=_0x305e;getSocket(_0x50d23e['id'])[_0x4aa0d0(0x21b)](!![]),removeClient(_0x50d23e['id']);}),pid[_0x1bb1b7]&&(pid[_0x1bb1b7][_0x1efa79(0x184)](),pid[_0x1bb1b7]=null);}function restartBot(_0xc1157e){const _0x1eae94=_0x5264f4;if(pid[_0xc1157e])pid[_0xc1157e][_0x1eae94(0x184)]();}function addBot(){const _0x512e64=_0x5264f4;let _0xd15ab9;for(let _0x1abe0b=0x1;_0x1abe0b<0x3e9;_0x1abe0b++){_0xd15ab9=_0x1abe0b[_0x512e64(0x2b1)]()[_0x512e64(0x1b1)](0x3,'0');let _0x34b1c2=config['find'](_0x1c6975=>_0x1c6975[_0x512e64(0x297)]==_0xd15ab9);if(!_0x34b1c2)break;}if(_0xd15ab9===_0x512e64(0x182)){logger['full'](_0x512e64(0x18a));return;}logger[_0x512e64(0x27e)](_0x512e64(0x1f4)+_0xd15ab9),dbConfig[_0x512e64(0x230)](_0x512e64(0x241))[_0x512e64(0x1ea)]({'botID':_0xd15ab9,'botname':'Bot\x20'+_0xd15ab9,'status':_0x512e64(0x29e),'live':''})[_0x512e64(0x1b9)](),startBot([_0xd15ab9,userID],{'cwd':bbpath},function(_0x1a0fb7){const _0x15cc7a=_0x512e64;if(_0x1a0fb7)logger[_0x15cc7a(0x27e)](_0x1a0fb7);}),config=getConfiguration(),io['to'](_0x512e64(0x2ad))[_0x512e64(0x1fe)](_0x512e64(0x241),config);}function deleteBot(_0x40b5c2){const _0x248610=_0x5264f4;getClientsWithBotID(_0x40b5c2)[_0x248610(0x22d)](_0x34ae7d=>{const _0x70eb8e=_0x248610;getSocket(_0x34ae7d['id'])[_0x70eb8e(0x21b)](!![]),removeClient(_0x34ae7d['id']);}),dbConfig['get']('bots')[_0x248610(0x1fb)]({'botID':_0x40b5c2})['write'](),logger[_0x248610(0x27e)](_0x248610(0x2d6)+_0x40b5c2),stopBot(_0x40b5c2);try{fs[_0x248610(0x1a7)](path[_0x248610(0x20a)](configpath,_0x248610(0x254)+_0x40b5c2+'-config.json')),fs['unlinkSync'](path['join'](configpath,_0x248610(0x254)+_0x40b5c2+_0x248610(0x2df))),fs[_0x248610(0x1a7)](path[_0x248610(0x20a)](configpath,_0x248610(0x254)+_0x40b5c2+_0x248610(0x26c))),fs[_0x248610(0x1a7)](path[_0x248610(0x20a)](configpath,'bot-'+_0x40b5c2+_0x248610(0x1c0)));}catch(_0x17dd50){if(_0x17dd50)logger[_0x248610(0x27e)](_0x248610(0x1cb),_0x17dd50);}config=getConfiguration(),io['to'](_0x248610(0x2ad))[_0x248610(0x1fe)](_0x248610(0x241),config);}function toggleBot(_0x31131e,_0x4fe3f1,_0x2d8fcf){const _0x7ba44=_0x5264f4;dbConfig[_0x7ba44(0x230)](_0x7ba44(0x241))[_0x7ba44(0x30b)]({'botID':_0x31131e})[_0x7ba44(0x251)]({'status':_0x4fe3f1})[_0x7ba44(0x251)]({'live':_0x2d8fcf})['write']();if(_0x4fe3f1==_0x7ba44(0x2c0)||_0x4fe3f1=='new')logger['full'](_0x7ba44(0x1e0)+_0x31131e),startBot([_0x31131e,userID],{'cwd':bbpath},function(_0x3f25f8){const _0x54b65b=_0x7ba44;if(_0x3f25f8)logger[_0x54b65b(0x27e)](_0x3f25f8);});else(_0x4fe3f1==_0x7ba44(0x1f7)||_0x4fe3f1==_0x7ba44(0x1bb))&&(logger['full'](_0x7ba44(0x235)+_0x31131e),stopBot(_0x31131e));config=getConfiguration(),io['to']('botmanager')[_0x7ba44(0x1fe)]('bots',config);}function toggleStatus(_0x2411fa){const _0x190d68=_0x5264f4;let _0x2ae0b8=dbConfig[_0x190d68(0x230)](_0x190d68(0x241))[_0x190d68(0x30b)]({'botID':_0x2411fa})[_0x190d68(0x2e4)](),_0x1b2c25;if(_0x2ae0b8['status']===_0x190d68(0x2c0))_0x1b2c25=_0x190d68(0x1f7);else{if(_0x2ae0b8[_0x190d68(0x2f8)]==='new')_0x1b2c25=_0x190d68(0x1bb);else{if(_0x2ae0b8[_0x190d68(0x2f8)]===_0x190d68(0x1bb))_0x1b2c25=_0x190d68(0x29e);else{if(_0x2ae0b8['status']===_0x190d68(0x1f7))_0x1b2c25=_0x190d68(0x2c0);}}}return _0x1b2c25;}function updateStatus(_0x5dce98,_0x13372c){const _0x4e7d4f=_0x5264f4;dbConfig[_0x4e7d4f(0x230)](_0x4e7d4f(0x241))[_0x4e7d4f(0x30b)]({'botID':_0x5dce98})['assign']({'status':_0x13372c})[_0x4e7d4f(0x1b9)](),config=getConfiguration(),io['to'](_0x4e7d4f(0x2ad))[_0x4e7d4f(0x1fe)]('bots',config);}function updateLive(_0x13e4bf,_0x519fe3){const _0x1f7fb5=_0x5264f4;dbConfig[_0x1f7fb5(0x230)](_0x1f7fb5(0x241))['find']({'botID':_0x13e4bf})[_0x1f7fb5(0x251)]({'live':_0x519fe3})[_0x1f7fb5(0x1b9)](),config=getConfiguration(),io['to'](_0x1f7fb5(0x2ad))[_0x1f7fb5(0x1fe)](_0x1f7fb5(0x241),config);}function updateBotName(_0x486d1a,_0x4f04ee){const _0x638d8c=_0x5264f4;dbConfig[_0x638d8c(0x230)](_0x638d8c(0x241))[_0x638d8c(0x30b)]({'botID':_0x486d1a})[_0x638d8c(0x251)]({'botname':_0x4f04ee})[_0x638d8c(0x1b9)](),config=getConfiguration(),io['to'](_0x638d8c(0x2ad))['emit'](_0x638d8c(0x241),config);}function updateBotManager(){const _0xa8ee06=_0x5264f4;config=getConfiguration(),io['to'](_0xa8ee06(0x2ad))[_0xa8ee06(0x1fe)](_0xa8ee06(0x241),config);}function toggleBotMode(_0x1b06f0){const _0xee7834=_0x5264f4;if(pid[_0x1b06f0])pid[_0x1b06f0][_0xee7834(0x2d8)]({'function':_0xee7834(0x280),'args':null});else{const _0x23b401=configpath+_0xee7834(0x254)+_0x1b06f0+_0xee7834(0x171),_0x37f8dd=fs[_0xee7834(0x1e8)](_0x23b401),_0x6e1aa9=JSON[_0xee7834(0x304)](_0x37f8dd),_0x2a7d7b=_0x6e1aa9[_0xee7834(0x2e0)][0x0][_0xee7834(0x265)];_0x6e1aa9[_0xee7834(0x2e0)][0x0][_0xee7834(0x265)]=!_0x2a7d7b;const _0x55e89e=JSON['stringify'](_0x6e1aa9,null,0x2);fs['writeFileSync'](_0x23b401,_0x55e89e),config=getConfiguration(),io['to'](_0xee7834(0x2ad))[_0xee7834(0x1fe)]('bots',config);}}function telegramError(_0x548c15){const _0x22805d=_0x5264f4;logger[_0x22805d(0x2ac)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x594b7a){const _0x5e3c2b=_0x5264f4;if(_0x594b7a[_0x5e3c2b(0x16e)]['username']!=settings[_0x5e3c2b(0x23f)]&&'@'+_0x594b7a[_0x5e3c2b(0x16e)][_0x5e3c2b(0x1dd)]!=settings[_0x5e3c2b(0x23f)])return tgBot[_0x5e3c2b(0x2fe)](_0x594b7a[_0x5e3c2b(0x193)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x5e3c2b(0x27c)})[_0x5e3c2b(0x172)](_0x50942f=>{telegramError(_0x50942f);}),![];return!![];}async function initTelegram(){const _0x57d728=_0x5264f4;if(tgBot)tgBot[_0x57d728(0x18e)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x168074=_0x57d728(0x257);_0x168074+='\x0a',_0x168074+=_0x57d728(0x1a9),_0x168074+='/disable\x20-\x20disable\x20notifications\x0a',_0x168074+=_0x57d728(0x2aa),_0x168074+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x168074+=_0x57d728(0x2f5),_0x168074+='/off\x20-\x20stop\x20bot(s)\x0a',_0x168074+=_0x57d728(0x20c),_0x168074+=_0x57d728(0x271),_0x168074+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x168074+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x168074+=_0x57d728(0x224),_0x168074+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x46ee94='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x46ee94+='\x0a',_0x46ee94+=_0x168074,tgBot[_0x57d728(0x1b0)](/\/start/,_0x4f7552=>{const _0x564d5e=_0x57d728;if(!validateTelegram(_0x4f7552))return;if(settings[_0x564d5e(0x2ef)]!=_0x4f7552[_0x564d5e(0x193)]['id'])updateSetting(_0x564d5e(0x2ef),_0x4f7552[_0x564d5e(0x193)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x564d5e(0x2fe)](_0x4f7552[_0x564d5e(0x193)]['id'],_0x46ee94)[_0x564d5e(0x172)](_0x1f7e83=>{telegramError(_0x1f7e83);});}),tgBot[_0x57d728(0x1b0)](/\/enable/,_0x49d4c9=>{const _0x2e6e3a=_0x57d728;if(!validateTelegram(_0x49d4c9))return;if(settings[_0x2e6e3a(0x2ef)]!=_0x49d4c9[_0x2e6e3a(0x193)]['id'])updateSetting(_0x2e6e3a(0x2ef),_0x49d4c9[_0x2e6e3a(0x193)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x2e6e3a(0x2fe)](_0x49d4c9[_0x2e6e3a(0x193)]['id'],_0x2e6e3a(0x246))[_0x2e6e3a(0x172)](_0x22fcf2=>{telegramError(_0x22fcf2);});}),tgBot['onText'](/\/config/,async _0xaa8f24=>{const _0x21d65a=_0x57d728;if(!validateTelegram(_0xaa8f24))return;tgBot[_0x21d65a(0x20e)](_0x21d65a(0x267)),tgBot[_0x21d65a(0x2fe)](_0xaa8f24['chat']['id'],_0x21d65a(0x2b6),{'reply_markup':{'inline_keyboard':[[{'text':_0x21d65a(0x2dc),'callback_data':_0x21d65a(0x21c)},{'text':_0x21d65a(0x186),'callback_data':_0x21d65a(0x21f)},{'text':_0x21d65a(0x209),'callback_data':_0x21d65a(0x2be)}]]}})[_0x21d65a(0x172)](_0x2be6d7=>{telegramError(_0x2be6d7);}),tgBot['on'](_0x21d65a(0x267),async _0x29b23a=>{const _0x56ba10=_0x21d65a,_0x1498c5=_0x29b23a[_0x56ba10(0x24a)],_0x336dc2=_0x29b23a[_0x56ba10(0x2fb)];tgBot[_0x56ba10(0x23d)](_0x29b23a['id'])[_0x56ba10(0x1ad)](async()=>{const _0xaa0f06=_0x56ba10;_0x1498c5==_0xaa0f06(0x21c)&&(updateSetting(_0xaa0f06(0x190),_0xaa0f06(0x21c)),updateSetting(_0xaa0f06(0x1ef),!![]),await tgBot[_0xaa0f06(0x2fe)](_0x336dc2[_0xaa0f06(0x193)]['id'],_0xaa0f06(0x22c))[_0xaa0f06(0x172)](_0x34e3d4=>{telegramError(_0x34e3d4);}));_0x1498c5==_0xaa0f06(0x21f)&&(updateSetting(_0xaa0f06(0x190),_0xaa0f06(0x21f)),updateSetting(_0xaa0f06(0x1ef),!![]),await tgBot[_0xaa0f06(0x2fe)](_0x336dc2[_0xaa0f06(0x193)]['id'],_0xaa0f06(0x214))[_0xaa0f06(0x172)](_0x3693cf=>{telegramError(_0x3693cf);}));_0x1498c5==_0xaa0f06(0x2be)&&(updateSetting(_0xaa0f06(0x190),_0xaa0f06(0x2be)),updateSetting(_0xaa0f06(0x1ef),!![]),await tgBot[_0xaa0f06(0x2fe)](_0x336dc2[_0xaa0f06(0x193)]['id'],_0xaa0f06(0x19e))[_0xaa0f06(0x172)](_0x27e699=>{telegramError(_0x27e699);}));if(!settings[_0xaa0f06(0x2ef)])tgBot['sendMessage'](_0x336dc2[_0xaa0f06(0x193)]['id'],_0xaa0f06(0x266))[_0xaa0f06(0x172)](_0x4aff2b=>{telegramError(_0x4aff2b);});}),tgBot[_0x56ba10(0x20e)](_0x56ba10(0x267));});}),tgBot[_0x57d728(0x1b0)](/\/status/,_0x4ef665=>{const _0x3cacac=_0x57d728;if(!validateTelegram(_0x4ef665))return;const _0x5f4c9e=getBotsWithMode();let _0x5808c9='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x3cacac(0x22d)](_0x119652=>{const _0x464fb1=_0x3cacac,_0x3c4c81=_0x5f4c9e[_0x464fb1(0x30b)](_0x15db1e=>_0x15db1e[_0x464fb1(0x297)]==_0x119652[_0x464fb1(0x297)])['mode'];_0x5808c9+='Bot\x20'+_0x119652[_0x464fb1(0x297)]+':\x20'+_0x119652[_0x464fb1(0x2f8)]+_0x464fb1(0x1c3)+_0x3c4c81+_0x464fb1(0x1c3)+_0x119652[_0x464fb1(0x28e)]+'\x0a';}),_0x5808c9+='\x0a',_0x5808c9+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x5808c9+=!settings[_0x3cacac(0x1ef)]?_0x3cacac(0x28d):_0x3cacac(0x2f4),_0x5808c9+=settings['telegramEnabled']?settings[_0x3cacac(0x190)]==_0x3cacac(0x2be)?_0x3cacac(0x1a4):_0x3cacac(0x247)+settings[_0x3cacac(0x190)]+_0x3cacac(0x1cf):'',tgBot[_0x3cacac(0x2fe)](_0x4ef665[_0x3cacac(0x193)]['id'],_0x5808c9,{'parse_mode':'HTML'})[_0x3cacac(0x172)](_0x2e28e8=>{telegramError(_0x2e28e8);});}),tgBot[_0x57d728(0x1b0)](/\/restart/,_0x403c04=>{const _0x589170=_0x57d728;if(!validateTelegram(_0x403c04))return;tgBot['removeListener'](_0x589170(0x267));const _0x43c456=getEnabledBots();if(_0x43c456[_0x589170(0x302)]==0x0)tgBot['sendMessage'](_0x403c04['chat']['id'],_0x589170(0x2f9))[_0x589170(0x172)](_0x385d03=>{telegramError(_0x385d03);});else{if(_0x43c456[_0x589170(0x302)]>0x1)_0x43c456['push']({'botID':_0x589170(0x2be)});let _0x3d2dfc=[],_0x33f07d=[];const _0x4369da=_0x43c456[_0x589170(0x302)]%0x4==0x0||_0x43c456['length']%0x4==0x3||_0x43c456[_0x589170(0x302)]%0x3==0x1?0x4:0x3;let _0x494303=0x0;_0x43c456['forEach']((_0x6a65c,_0x413c89)=>{const _0x58bc6d=_0x589170;if(_0x413c89%_0x4369da==0x0)_0x33f07d=[];_0x33f07d[_0x58bc6d(0x1ea)]({'text':_0x6a65c[_0x58bc6d(0x297)]==_0x58bc6d(0x2be)?'All\x20bots':_0x58bc6d(0x283)+_0x6a65c[_0x58bc6d(0x297)],'callback_data':_0x6a65c[_0x58bc6d(0x297)]}),_0x413c89%_0x4369da==0x0&&(_0x3d2dfc[_0x494303]=_0x33f07d,_0x494303++);}),tgBot[_0x589170(0x2fe)](_0x403c04[_0x589170(0x193)]['id'],_0x589170(0x262),{'reply_markup':{'inline_keyboard':_0x3d2dfc}})[_0x589170(0x172)](_0x9713ad=>{telegramError(_0x9713ad);}),tgBot['on'](_0x589170(0x267),async _0x88b946=>{const _0x4f8c46=_0x589170,_0x26b1dc=_0x88b946['data'],_0x37dde4=_0x88b946[_0x4f8c46(0x2fb)];tgBot['answerCallbackQuery'](_0x88b946['id'])['then'](async()=>{const _0x1cb782=_0x4f8c46;_0x26b1dc=='all'?config[_0x1cb782(0x22d)](_0x4bf8a9=>{const _0x2cfe6b=_0x1cb782;restartBot(_0x4bf8a9[_0x2cfe6b(0x297)]);}):restartBot(_0x26b1dc);}),tgBot[_0x4f8c46(0x20e)](_0x4f8c46(0x267));});}}),tgBot[_0x57d728(0x1b0)](/\/on/,_0xa145e8=>{const _0x3f0dfb=_0x57d728;if(!validateTelegram(_0xa145e8))return;tgBot[_0x3f0dfb(0x20e)]('callback_query');const _0x56e717=getDisabledBots();if(_0x56e717[_0x3f0dfb(0x302)]==0x0)tgBot[_0x3f0dfb(0x2fe)](_0xa145e8[_0x3f0dfb(0x193)]['id'],_0x3f0dfb(0x17b))[_0x3f0dfb(0x172)](_0x5f5d79=>{telegramError(_0x5f5d79);});else{if(_0x56e717['length']>0x1)_0x56e717['push']({'botID':_0x3f0dfb(0x2be)});let _0x5b88ba=[],_0x1bfd72=[];const _0x36e4a4=_0x56e717[_0x3f0dfb(0x302)]%0x4==0x0||_0x56e717[_0x3f0dfb(0x302)]%0x4==0x3||_0x56e717[_0x3f0dfb(0x302)]%0x3==0x1?0x4:0x3;let _0x422c98=0x0;_0x56e717['forEach']((_0x5f257a,_0x38c899)=>{const _0x3605f4=_0x3f0dfb;if(_0x38c899%_0x36e4a4==0x0)_0x1bfd72=[];_0x1bfd72['push']({'text':_0x5f257a[_0x3605f4(0x297)]==_0x3605f4(0x2be)?'All\x20bots':_0x3605f4(0x283)+_0x5f257a[_0x3605f4(0x297)],'callback_data':_0x5f257a[_0x3605f4(0x297)]}),_0x38c899%_0x36e4a4==0x0&&(_0x5b88ba[_0x422c98]=_0x1bfd72,_0x422c98++);}),tgBot[_0x3f0dfb(0x2fe)](_0xa145e8['chat']['id'],_0x3f0dfb(0x27f),{'reply_markup':{'inline_keyboard':_0x5b88ba}})[_0x3f0dfb(0x172)](_0x177dbd=>{telegramError(_0x177dbd);}),tgBot['on'](_0x3f0dfb(0x267),async _0x94a29b=>{const _0x2be478=_0x3f0dfb,_0x502c94=_0x94a29b[_0x2be478(0x24a)],_0x3db250=_0x94a29b[_0x2be478(0x2fb)];tgBot[_0x2be478(0x23d)](_0x94a29b['id'])['then'](async()=>{const _0x19b4fc=_0x2be478;_0x502c94=='all'?(tgBot[_0x19b4fc(0x2fe)](_0x3db250[_0x19b4fc(0x193)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')['catch'](_0x5da95c=>{telegramError(_0x5da95c);}),_0x56e717[_0x19b4fc(0x22d)](_0x4368d6=>{const _0x7f939f=_0x19b4fc;if(_0x4368d6['botID']!=_0x7f939f(0x2be))toggleBot(_0x4368d6[_0x7f939f(0x297)],toggleStatus(_0x4368d6[_0x7f939f(0x297)]),'stopped');})):(tgBot['sendMessage'](_0x3db250[_0x19b4fc(0x193)]['id'],_0x19b4fc(0x306)+_0x502c94)['catch'](_0x901648=>{telegramError(_0x901648);}),toggleBot(_0x502c94,toggleStatus(_0x502c94),'stopped'));}),tgBot[_0x2be478(0x20e)](_0x2be478(0x267));});}}),tgBot['onText'](/\/off/,_0x41bbcd=>{const _0x3e1e21=_0x57d728;if(!validateTelegram(_0x41bbcd))return;tgBot[_0x3e1e21(0x20e)](_0x3e1e21(0x267));const _0x39428c=getEnabledBots();if(_0x39428c['length']==0x0)tgBot[_0x3e1e21(0x2fe)](_0x41bbcd[_0x3e1e21(0x193)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x3e1e21(0x172)](_0x29ae08=>{telegramError(_0x29ae08);});else{if(_0x39428c[_0x3e1e21(0x302)]>0x1)_0x39428c['push']({'botID':'all'});let _0x79fb89=[],_0xb94245=[];const _0x37545b=_0x39428c[_0x3e1e21(0x302)]%0x4==0x0||_0x39428c[_0x3e1e21(0x302)]%0x4==0x3||_0x39428c[_0x3e1e21(0x302)]%0x3==0x1?0x4:0x3;let _0x157ff8=0x0;_0x39428c['forEach']((_0x361cd1,_0x787078)=>{const _0x5406d8=_0x3e1e21;if(_0x787078%_0x37545b==0x0)_0xb94245=[];_0xb94245[_0x5406d8(0x1ea)]({'text':_0x361cd1['botID']==_0x5406d8(0x2be)?'All\x20bots':'Bot\x20'+_0x361cd1[_0x5406d8(0x297)],'callback_data':_0x361cd1['botID']}),_0x787078%_0x37545b==0x0&&(_0x79fb89[_0x157ff8]=_0xb94245,_0x157ff8++);}),tgBot[_0x3e1e21(0x2fe)](_0x41bbcd['chat']['id'],_0x3e1e21(0x18d),{'reply_markup':{'inline_keyboard':_0x79fb89}})[_0x3e1e21(0x172)](_0x568142=>{telegramError(_0x568142);}),tgBot['on'](_0x3e1e21(0x267),async _0x5db72b=>{const _0x36bac7=_0x3e1e21,_0x35a5ef=_0x5db72b[_0x36bac7(0x24a)],_0x381e8e=_0x5db72b[_0x36bac7(0x2fb)];tgBot[_0x36bac7(0x23d)](_0x5db72b['id'])['then'](async()=>{const _0x3c374d=_0x36bac7;_0x35a5ef=='all'?(tgBot['sendMessage'](_0x381e8e[_0x3c374d(0x193)]['id'],_0x3c374d(0x2e5))[_0x3c374d(0x172)](_0x3bb62c=>{telegramError(_0x3bb62c);}),_0x39428c[_0x3c374d(0x22d)](_0x4408f3=>{const _0x4e39c5=_0x3c374d;if(_0x4408f3[_0x4e39c5(0x297)]!='all')toggleBot(_0x4408f3[_0x4e39c5(0x297)],toggleStatus(_0x4408f3[_0x4e39c5(0x297)]),_0x4e39c5(0x1dc));})):(tgBot['sendMessage'](_0x381e8e[_0x3c374d(0x193)]['id'],_0x3c374d(0x195)+_0x35a5ef)[_0x3c374d(0x172)](_0x9b78df=>{telegramError(_0x9b78df);}),toggleBot(_0x35a5ef,toggleStatus(_0x35a5ef),_0x3c374d(0x1dc)));}),tgBot[_0x36bac7(0x20e)]('callback_query');});}}),tgBot['onText'](/\/portfolio/,_0xf1a394=>{const _0xf99698=_0x57d728;if(!validateTelegram(_0xf1a394))return;tgBot[_0xf99698(0x20e)](_0xf99698(0x267));const _0x492d9e=getEnabledBots();if(_0x492d9e[_0xf99698(0x302)]==0x0)tgBot[_0xf99698(0x2fe)](_0xf1a394[_0xf99698(0x193)]['id'],'No\x20bots\x20running\x20right\x20now')[_0xf99698(0x172)](_0x3d2d43=>{telegramError(_0x3d2d43);});else{if(_0x492d9e[_0xf99698(0x302)]>0x1){let _0x1c7740=[],_0xb3d990=[];const _0x257ac8=_0x492d9e[_0xf99698(0x302)]%0x4==0x0||_0x492d9e[_0xf99698(0x302)]%0x4==0x3||_0x492d9e['length']%0x3==0x1?0x4:0x3;let _0x33a690=0x0;_0x492d9e[_0xf99698(0x22d)]((_0x303572,_0x26d893)=>{const _0x5162f4=_0xf99698;if(_0x26d893%_0x257ac8==0x0)_0xb3d990=[];_0xb3d990[_0x5162f4(0x1ea)]({'text':_0x5162f4(0x283)+_0x303572[_0x5162f4(0x297)],'callback_data':_0x303572[_0x5162f4(0x297)]}),_0x26d893%_0x257ac8==0x0&&(_0x1c7740[_0x33a690]=_0xb3d990,_0x33a690++);}),tgBot[_0xf99698(0x2fe)](_0xf1a394[_0xf99698(0x193)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x1c7740}})['catch'](_0x341ab5=>{telegramError(_0x341ab5);}),tgBot['on'](_0xf99698(0x267),async _0x853e8d=>{const _0x34e959=_0xf99698,_0x486fb9=_0x853e8d['data'],_0x5d9c15=_0x853e8d[_0x34e959(0x2fb)];tgBot[_0x34e959(0x23d)](_0x853e8d['id'])['then'](async()=>{const _0x9d6818=_0x34e959;if(pid[_0x486fb9])pid[_0x486fb9][_0x9d6818(0x2d8)]({'function':_0x9d6818(0x1ae),'args':null});}),tgBot[_0x34e959(0x20e)](_0x34e959(0x267));});}else{const _0x336300=_0x492d9e[0x0]['botID'];if(pid[_0x336300])pid[_0x336300][_0xf99698(0x2d8)]({'function':_0xf99698(0x1ae),'args':null});}}}),tgBot['onText'](/\/update/,async _0xbe9cb1=>{const _0x4dd55e=_0x57d728;if(!validateTelegram(_0xbe9cb1))return;tgBot['removeListener']('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x4dd55e(0x2fe)](_0xbe9cb1[_0x4dd55e(0x193)]['id'],_0x4dd55e(0x307))[_0x4dd55e(0x172)](_0x313fce=>{telegramError(_0x313fce);});else!validInstallation?tgBot[_0x4dd55e(0x2fe)](_0xbe9cb1[_0x4dd55e(0x193)]['id'],_0x4dd55e(0x2a6))['catch'](_0x3ad94e=>{telegramError(_0x3ad94e);}):(tgBot[_0x4dd55e(0x2fe)](_0xbe9cb1[_0x4dd55e(0x193)]['id'],_0x4dd55e(0x29f),{'reply_markup':{'inline_keyboard':[[{'text':_0x4dd55e(0x237),'callback_data':_0x4dd55e(0x17f)},{'text':'No','callback_data':'no'}]]}})[_0x4dd55e(0x172)](_0x28e6aa=>{telegramError(_0x28e6aa);}),tgBot['on'](_0x4dd55e(0x267),async _0x4a443c=>{const _0x3617ce=_0x4dd55e,_0x4b7059=_0x4a443c[_0x3617ce(0x24a)],_0x4579af=_0x4a443c['message'];tgBot[_0x3617ce(0x23d)](_0x4a443c['id'])[_0x3617ce(0x1ad)](async()=>{const _0x52e0a9=_0x3617ce;_0x4b7059==_0x52e0a9(0x17f)&&(await tgBot[_0x52e0a9(0x2fe)](_0x4579af[_0x52e0a9(0x193)]['id'],'Starting\x20Balance\x20Bot\x20update')[_0x52e0a9(0x172)](_0x5408b0=>{telegramError(_0x5408b0);}),updateBB());_0x4b7059=='no'&&await tgBot['sendMessage'](_0x4579af[_0x52e0a9(0x193)]['id'],_0x52e0a9(0x2ba))[_0x52e0a9(0x172)](_0x4539a9=>{telegramError(_0x4539a9);});if(!settings[_0x52e0a9(0x2ef)])tgBot[_0x52e0a9(0x2fe)](_0x4579af[_0x52e0a9(0x193)]['id'],_0x52e0a9(0x266))[_0x52e0a9(0x172)](_0x2376eb=>{telegramError(_0x2376eb);});}),tgBot[_0x3617ce(0x20e)](_0x3617ce(0x267));}));}),tgBot[_0x57d728(0x1b0)](/\/toggle/,_0x5178d0=>{const _0x2b90ea=_0x57d728;if(!validateTelegram(_0x5178d0))return;tgBot[_0x2b90ea(0x20e)]('callback_query');const _0x235ddf=getBotsWithMode();if(_0x235ddf[_0x2b90ea(0x302)]==0x0)tgBot[_0x2b90ea(0x2fe)](_0x5178d0['chat']['id'],_0x2b90ea(0x2f9))[_0x2b90ea(0x172)](_0x1c4a74=>{telegramError(_0x1c4a74);});else{let _0x4fc58b=[],_0x33fd99=[];const _0x332ffe=0x2;let _0x3eb30d=0x0;_0x235ddf[_0x2b90ea(0x22d)]((_0x1d388f,_0xf30fc7)=>{const _0x234cd9=_0x2b90ea;if(_0xf30fc7%_0x332ffe==0x0)_0x33fd99=[];_0x33fd99['push']({'text':_0x234cd9(0x283)+_0x1d388f[_0x234cd9(0x297)]+'\x20('+_0x1d388f[_0x234cd9(0x1c5)]+')','callback_data':_0x1d388f[_0x234cd9(0x297)]}),_0xf30fc7%_0x332ffe==0x0&&(_0x4fc58b[_0x3eb30d]=_0x33fd99,_0x3eb30d++);}),tgBot[_0x2b90ea(0x2fe)](_0x5178d0[_0x2b90ea(0x193)]['id'],_0x2b90ea(0x1cd),{'reply_markup':{'inline_keyboard':_0x4fc58b}})['catch'](_0x3ae14a=>{telegramError(_0x3ae14a);}),tgBot['on'](_0x2b90ea(0x267),async _0x4e5184=>{const _0x443186=_0x2b90ea,_0x6729d6=_0x4e5184[_0x443186(0x24a)],_0x3330f5=_0x4e5184[_0x443186(0x2fb)];tgBot[_0x443186(0x23d)](_0x4e5184['id'])['then'](async()=>{const _0x4bcab8=_0x443186,_0x592307=_0x235ddf[_0x4bcab8(0x30b)](_0x54d8c0=>_0x54d8c0[_0x4bcab8(0x297)]==_0x6729d6),_0x55ffc4=_0x592307['mode']==_0x4bcab8(0x1eb)?_0x4bcab8(0x29c):_0x4bcab8(0x1eb);tgBot[_0x4bcab8(0x2fe)](_0x3330f5[_0x4bcab8(0x193)]['id'],_0x4bcab8(0x189)+_0x6729d6+_0x4bcab8(0x2ec)+_0x55ffc4+'\x20mode')[_0x4bcab8(0x172)](_0x5241f8=>{telegramError(_0x5241f8);}),toggleBotMode(_0x6729d6);}),tgBot[_0x443186(0x20e)]('callback_query');});}}),tgBot[_0x57d728(0x1b0)](/\/names/,_0x30f305=>{const _0x2a3cb4=_0x57d728;if(!validateTelegram(_0x30f305))return;let _0x312f4b='';config['forEach'](_0x191821=>{const _0xe491db=_0x305e;_0x312f4b+='Bot\x20'+_0x191821[_0xe491db(0x297)]+':\x20'+_0x191821[_0xe491db(0x2f0)]+'\x0a';}),tgBot[_0x2a3cb4(0x2fe)](_0x30f305[_0x2a3cb4(0x193)]['id'],_0x312f4b,{'parse_mode':_0x2a3cb4(0x27c)})[_0x2a3cb4(0x172)](_0x2249f1=>{telegramError(_0x2249f1);});}),tgBot[_0x57d728(0x1b0)](/\/disable/,_0x1ed405=>{const _0x26d40d=_0x57d728;if(!validateTelegram(_0x1ed405))return;tgBot[_0x26d40d(0x2fe)](_0x1ed405['chat']['id'],_0x26d40d(0x25f))['catch'](_0x18e5de=>{telegramError(_0x18e5de);}),updateSetting(_0x26d40d(0x1ef),![]);}),tgBot['onText'](/\/help/,_0x2d84cc=>{const _0x3ec32c=_0x57d728;if(!validateTelegram(_0x2d84cc))return;tgBot['sendMessage'](_0x2d84cc[_0x3ec32c(0x193)]['id'],_0x168074)[_0x3ec32c(0x172)](_0x33e001=>{telegramError(_0x33e001);});}),tgBot['on'](_0x57d728(0x199),_0x1dc724=>{const _0x5ed08c=_0x57d728;_0x1dc724[_0x5ed08c(0x2b1)]()[_0x5ed08c(0x28c)](_0x5ed08c(0x1c4))&&(logger['full']('Invalid\x20Telegram\x20token'),tgBot[_0x5ed08c(0x18e)](),tgBot=null,io['to'](_0x5ed08c(0x2ad))['emit']('notification',_0x5ed08c(0x248)));}),process[_0x57d728(0x2a7)](_0x57d728(0x180),()=>{const _0x558930=_0x57d728;if(tgBot)tgBot[_0x558930(0x18e)]();process['exit'](0x1);}),process[_0x57d728(0x2a7)](_0x57d728(0x202),()=>{const _0x32680f=_0x57d728;if(tgBot)tgBot['stopPolling']();process[_0x32680f(0x176)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x1ea838,_0x3fe2ea){const _0xc63655=_0x5264f4;if(settings[_0xc63655(0x1ef)]){if(settings[_0xc63655(0x190)]==_0xc63655(0x2be)||(_0x3fe2ea[_0xc63655(0x231)]==_0xc63655(0x238)||_0x3fe2ea[_0xc63655(0x231)]=='warning'||_0x3fe2ea[_0xc63655(0x231)]==_0xc63655(0x191))&&settings[_0xc63655(0x190)]=='alerts'||_0x3fe2ea['type']==_0xc63655(0x298)&&settings[_0xc63655(0x190)]=='orders'){if(tgBot&&settings[_0xc63655(0x2ef)]){if(_0x3fe2ea[_0xc63655(0x2b8)])tgBot['sendMessage'](settings[_0xc63655(0x2ef)],_0x3fe2ea[_0xc63655(0x2f0)]+_0xc63655(0x2af)+_0x3fe2ea['event'])[_0xc63655(0x172)](_0x14d50c=>{telegramError(_0x14d50c);});else tgBot[_0xc63655(0x2fe)](settings[_0xc63655(0x2ef)],'Bot\x20'+_0x1ea838+_0xc63655(0x2af)+_0x3fe2ea['event'])[_0xc63655(0x172)](_0x373c7a=>{telegramError(_0x373c7a);});}}}}async function sendTelegramMsg(_0x3f34e1,_0x597c6c=_0x5264f4(0x27c)){const _0x511694=_0x5264f4;return settings['telegramEnabled']&&tgBot&&settings[_0x511694(0x2ef)]?(await tgBot[_0x511694(0x2fe)](settings[_0x511694(0x2ef)],_0x3f34e1,{'parse_mode':_0x597c6c})['catch'](_0x240152=>{telegramError(_0x240152);}),!![]):![];}function getDeviceWithIp(_0x1eef17){const _0x2c3b7f=_0x5264f4;return devices[_0x2c3b7f(0x30b)](_0x41c28f=>_0x41c28f['ip']===_0x1eef17);}function temporaryAccess2FA(_0x1c6dd9,_0xfd6c8){const _0xd44b71=_0x5264f4;let _0x175528=new Date(),_0x35e0d3=![];if(lastIpApproval){if(_0x175528-lastIpApproval<0x1388)_0x35e0d3=!![];}lastIpApproval=new Date();if(_0x35e0d3)return;tgBot&&settings[_0xd44b71(0x2ef)]&&(tgBot[_0xd44b71(0x20e)]('callback_query'),tgBot['sendMessage'](settings[_0xd44b71(0x2ef)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0xfd6c8)['show']+_0xd44b71(0x177),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0xd44b71(0x1a3),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':'reject','callback_data':_0xd44b71(0x19c)}]]}})[_0xd44b71(0x172)](_0x2d56dd=>{telegramError(_0x2d56dd);}),tgBot['on'](_0xd44b71(0x267),async _0x3f21f7=>{const _0x1c7e8b=_0xd44b71,_0x55d310=_0x3f21f7['data'],_0xd80225=_0x3f21f7[_0x1c7e8b(0x2fb)];tgBot[_0x1c7e8b(0x23d)](_0x3f21f7['id'])['then'](async()=>{const _0x3dd2b3=_0x1c7e8b;devices[_0x1c6dd9][_0x3dd2b3(0x1da)]={'clientip':_0xfd6c8,'timestamp':new Date()['getTime'](),'expiry':_0x55d310},_0x55d310!=_0x3dd2b3(0x19c)?(await tgBot[_0x3dd2b3(0x2fe)](_0xd80225['chat']['id'],'Access\x20enabled\x20for\x20'+_0x55d310+_0x3dd2b3(0x1d5),{'parse_mode':'HTML'})[_0x3dd2b3(0x172)](_0x662244=>{telegramError(_0x662244);}),io['to'](_0x1c6dd9)[_0x3dd2b3(0x1fe)]('status',{'access':{'allow':![],'reason':_0x3dd2b3(0x18f),'token':null}})):(await tgBot[_0x3dd2b3(0x2fe)](_0xd80225[_0x3dd2b3(0x193)]['id'],'Temporary\x20access\x20rejected')['catch'](_0x1c9c91=>{telegramError(_0x1c9c91);}),io['to'](_0x1c6dd9)[_0x3dd2b3(0x1fe)](_0x3dd2b3(0x2f8),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x1c7e8b(0x20e)](_0x1c7e8b(0x267));}));}function _0x305e(_0x44878c,_0xe672e4){const _0x3b5e8f=_0x3b49();return _0x305e=function(_0x5bd626,_0x2ee602){_0x5bd626=_0x5bd626-0x16c;let _0x3b4996=_0x3b5e8f[_0x5bd626];return _0x3b4996;},_0x305e(_0x44878c,_0xe672e4);}function loginAccess2FA(_0x5c3c32,_0x421f61){const _0x51bcab=_0x5264f4;tgBot&&settings[_0x51bcab(0x2ef)]&&(tgBot['removeListener'](_0x51bcab(0x267)),tgBot['sendMessage'](settings[_0x51bcab(0x2ef)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x421f61)[_0x51bcab(0x285)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':'reject','callback_data':_0x51bcab(0x19c)}]]}})[_0x51bcab(0x172)](_0x52a33b=>{telegramError(_0x52a33b);}),tgBot['on'](_0x51bcab(0x267),async _0x4d846d=>{const _0x53cb16=_0x51bcab,_0x3e5e01=_0x4d846d[_0x53cb16(0x24a)],_0x3bacd6=_0x4d846d[_0x53cb16(0x2fb)];tgBot[_0x53cb16(0x23d)](_0x4d846d['id'])[_0x53cb16(0x1ad)](async()=>{const _0x5de9cc=_0x53cb16;devices[_0x5c3c32][_0x5de9cc(0x1d3)]={'clientip':_0x421f61,'timestamp':new Date()[_0x5de9cc(0x1e1)](),'expiry':_0x3e5e01},_0x3e5e01!=_0x5de9cc(0x19c)?(await tgBot[_0x5de9cc(0x2fe)](_0x3bacd6[_0x5de9cc(0x193)]['id'],_0x5de9cc(0x1d9),{'parse_mode':_0x5de9cc(0x27c)})[_0x5de9cc(0x172)](_0xaca715=>{telegramError(_0xaca715);}),io['to'](_0x5c3c32)[_0x5de9cc(0x1fe)]('status',{'access':{'allow':![],'reason':_0x5de9cc(0x18f),'token':null}})):(await tgBot[_0x5de9cc(0x2fe)](_0x3bacd6[_0x5de9cc(0x193)]['id'],_0x5de9cc(0x2b0))[_0x5de9cc(0x172)](_0x5dcda4=>{telegramError(_0x5dcda4);}),io['to'](_0x5c3c32)[_0x5de9cc(0x1fe)](_0x5de9cc(0x2f8),{'access':{'allow':![],'reason':_0x5de9cc(0x2a0),'token':null}}));}),tgBot[_0x53cb16(0x20e)](_0x53cb16(0x267));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x55531b=_0x5264f4;return dbConfig['get'](_0x55531b(0x241))['sortBy'](_0x55531b(0x297))[_0x55531b(0x27d)]({'status':'enabled'})[_0x55531b(0x2e4)]()||[];}function getDisabledBots(){const _0x3ff03e=_0x5264f4;return dbConfig['get'](_0x3ff03e(0x241))[_0x3ff03e(0x2b4)](_0x3ff03e(0x297))[_0x3ff03e(0x27d)]({'status':_0x3ff03e(0x1f7)})[_0x3ff03e(0x2e4)]()||[];}function getBotAttributes(_0x3f182f){const _0x17b70c=_0x5264f4;let _0x47d5b3={};const _0x49a02d=configpath+_0x17b70c(0x254)+_0x3f182f+_0x17b70c(0x171),_0x2e3c0f=fs[_0x17b70c(0x25c)](_0x49a02d);if(_0x2e3c0f){const _0x1b467e=fs[_0x17b70c(0x1e8)](_0x49a02d);try{const _0x2e9da1=JSON['parse'](_0x1b467e),_0x37e684=_0x2e9da1?_0x2e9da1['bot'][0x0][_0x17b70c(0x265)]:![];_0x47d5b3[_0x17b70c(0x1c5)]=_0x37e684?_0x17b70c(0x1eb):'manual',_0x47d5b3['botname']=_0x2e9da1?_0x2e9da1[_0x17b70c(0x2e0)][0x0][_0x17b70c(0x2f0)]:_0x17b70c(0x283)+_0x3f182f;}catch(_0x13aba2){_0x47d5b3[_0x17b70c(0x1c5)]='manual',_0x47d5b3['botname']=_0x17b70c(0x283)+_0x3f182f;}}else _0x47d5b3[_0x17b70c(0x1c5)]='manual',_0x47d5b3[_0x17b70c(0x2f0)]='Bot\x20'+_0x3f182f;return _0x47d5b3;}function getBotsWithMode(){const _0x21e583=_0x5264f4,_0x43c05f=dbConfig[_0x21e583(0x230)](_0x21e583(0x241))['sortBy']('botID')[_0x21e583(0x2e4)]()||[];return _0x43c05f[_0x21e583(0x22d)](_0x36c98e=>{const _0x13401b=_0x21e583;let _0x15a90a=getBotAttributes(_0x36c98e[_0x13401b(0x297)]);_0x36c98e[_0x13401b(0x1c5)]=_0x15a90a[_0x13401b(0x1c5)];}),_0x43c05f;}async function initUser(){const _0x22fd9e=_0x5264f4;if(!settings['userid']){const _0x2f791d=uuidRandom();mixpanel['alias'](_0x2f791d),updateSetting(_0x22fd9e(0x28b),_0x2f791d);}}async function initSecure(){const _0x50cb1b=_0x5264f4;let _0x463b7e=getSecure();if(!_0x463b7e['hasOwnProperty'](_0x50cb1b(0x30c))){let _0x5d3294=await generateKeys();_0x463b7e[_0x50cb1b(0x303)]=_0x5d3294['publicKey'],_0x463b7e[_0x50cb1b(0x309)]=_0x5d3294[_0x50cb1b(0x309)],_0x463b7e[_0x50cb1b(0x30c)]=crypto[_0x50cb1b(0x1a1)](0x20)[_0x50cb1b(0x2b1)](_0x50cb1b(0x1f8));;storeSecure(_0x463b7e);}}function getSettings(){const _0xea99c5=_0x5264f4;return dbSettings[_0xea99c5(0x230)]('settings')[_0xea99c5(0x2e4)]()||{};}function getSecure(){const _0x111572=_0x5264f4;return dbSecure['get'](_0x111572(0x2cc))[_0x111572(0x2e4)]()||{};}function getBlacklist(){const _0x487e71=_0x5264f4;return dbSecure[_0x487e71(0x230)]('blacklist')[_0x487e71(0x2e4)]()||[];}function broadcastToBots(_0x336777,_0x19134f){config['forEach'](_0x300699=>{const _0x616083=_0x305e;if(_0x300699['status']=='enabled'&&_0x300699[_0x616083(0x28e)]=='running'){if(pid[_0x300699['botID']])pid[_0x300699['botID']][_0x616083(0x2d8)]({[_0x336777]:_0x19134f});}});}function storeSettings(_0x2b3707,_0x5c4699=![]){const _0x46763b=_0x5264f4;_0x2b3707={...settings,..._0x2b3707};if(_0x5c4699&&_0x2b3707[_0x46763b(0x2d5)]!=_0x46763b(0x23c)&&_0x2b3707[_0x46763b(0x2d5)]!=_0x46763b(0x25b)&&_0x2b3707[_0x46763b(0x2d5)]!=''){const _0x16ad5b=crypt[_0x46763b(0x206)](secure['privateKey'],_0x2b3707['bbPassword'])['message']['split']('@')[0x0],_0x5cf523=bcrypt['hashSync'](_0x16ad5b,saltRounds);_0x2b3707={..._0x2b3707,'bbPassword':_0x5cf523};}if(_0x5c4699&&_0x2b3707[_0x46763b(0x2ee)]!=_0x46763b(0x23c)&&_0x2b3707[_0x46763b(0x2ee)]!=_0x46763b(0x25b)&&_0x2b3707['telegramToken']!=''){const _0x16b5a4=crypt['decrypt'](secure[_0x46763b(0x309)],_0x2b3707[_0x46763b(0x2ee)])['message'][_0x46763b(0x1fc)]('@')[0x0];_0x2b3707={..._0x2b3707,'telegramToken':_0x16b5a4};}const _0x57bc82=_0x2b3707[_0x46763b(0x2ee)]!=_0x46763b(0x23c)&&_0x2b3707[_0x46763b(0x2ee)]!=settings['telegramToken']||_0x2b3707[_0x46763b(0x23f)]!=settings['telegramUsername'],_0x34721d=_0x2b3707[_0x46763b(0x2ee)]==''||_0x2b3707[_0x46763b(0x23f)]=='';if(_0x57bc82)_0x2b3707['telegramEvents']=_0x46763b(0x2be);for(const [_0x45d2d2,_0x2db441]of Object[_0x46763b(0x223)](_0x2b3707)){if(_0x45d2d2==_0x46763b(0x2ee)&&_0x2db441==_0x46763b(0x23c)){_0x2b3707[_0x46763b(0x2ee)]=settings['telegramToken'];continue;};if(_0x45d2d2==_0x46763b(0x2d5)&&_0x2db441==_0x46763b(0x23c)){_0x2b3707[_0x46763b(0x2d5)]=settings['bbPassword'];continue;};dbSettings[_0x46763b(0x26b)](_0x46763b(0x1ac)+_0x45d2d2,_0x2db441)[_0x46763b(0x1b9)]();}settings=_0x2b3707,io['to'](_0x46763b(0x2ad))[_0x46763b(0x1fe)]('settings',cleanSettings()),broadcastToBots('timeshift',settings[_0x46763b(0x213)]);if(_0x57bc82&&!_0x34721d)initTelegram();if(_0x57bc82&&_0x34721d)disableTelegram();getAllClients()[_0x46763b(0x22d)](_0x5d5142=>{const _0x547b3d=_0x46763b;getSocket(_0x5d5142['id'])[_0x547b3d(0x1fe)](_0x547b3d(0x2f8),{'access':{'allow':![],'reason':_0x547b3d(0x18f),'token':null}});});}function updateSetting(_0x1988c3,_0x3eb6c1){const _0x1ccdda=_0x5264f4;dbSettings[_0x1ccdda(0x26b)]('settings.'+_0x1988c3,_0x3eb6c1)[_0x1ccdda(0x1b9)](),settings=getSettings(),io['to'](_0x1ccdda(0x2ad))[_0x1ccdda(0x1fe)](_0x1ccdda(0x2c8),cleanSettings());}function storeSecure(_0x4ab65e){const _0x32b3eb=_0x5264f4;dbSecure[_0x32b3eb(0x230)](_0x32b3eb(0x2cc))['push'](_0x4ab65e)[_0x32b3eb(0x1b9)](),secure=_0x4ab65e;}function addBlacklist(_0xfc601a){const _0x2c50c6=_0x5264f4;cleanBlacklist();let _0x4fea94;devices[_0xfc601a]['telegramIpApproval']?_0x4fea94=Math['max'](devices[_0xfc601a][_0x2c50c6(0x1da)][_0x2c50c6(0x20b)],loginExpiry):_0x4fea94=loginExpiry,dbSecure[_0x2c50c6(0x230)](_0x2c50c6(0x24f))[_0x2c50c6(0x1ea)]({'expiry':new Date()[_0x2c50c6(0x1e1)]()+_0x4fea94*0x3c*0x3e8,'token':devices[_0xfc601a][_0x2c50c6(0x1c7)][_0x2c50c6(0x1cc)]})['write'](),blacklist=dbSecure[_0x2c50c6(0x230)](_0x2c50c6(0x24f))[_0x2c50c6(0x2e4)]();}function cleanBlacklist(){const _0xe23625=_0x5264f4;let _0xdd0418=dbSecure['get'](_0xe23625(0x24f))[_0xe23625(0x2e6)]()['value'](),_0x137720=new Date()[_0xe23625(0x1e1)]();_0xdd0418[_0xe23625(0x22d)](_0x450c5e=>{const _0x3f7b55=_0xe23625;_0x450c5e[_0x3f7b55(0x20b)]<_0x137720&&dbSecure[_0x3f7b55(0x230)](_0x3f7b55(0x24f))['remove']({'expiry':_0x450c5e[_0x3f7b55(0x20b)]})[_0x3f7b55(0x1b9)]();});}function initStates(){let _0xa7bcff=getConfiguration();_0xa7bcff['forEach'](_0x245406=>{const _0x541cc1=_0x305e;_0x245406[_0x541cc1(0x28e)]=_0x541cc1(0x1dc);}),storeConfiguration(_0xa7bcff);}function onKeys(){const _0x15c4ff=new RSA();return new Promise(_0x136766=>{const _0x415f08=_0x305e;_0x15c4ff[_0x415f08(0x1b4)]()[_0x415f08(0x1ad)](_0x43ef6d=>{_0x136766(_0x43ef6d);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1fde57=_0x5264f4;let _0x4930d6=getSettings(),_0x189c62=![];!_0x4930d6[_0x1fde57(0x205)](_0x1fde57(0x256))&&(_0x4930d6[_0x1fde57(0x256)]=0x0,_0x189c62=!![]);!_0x4930d6['hasOwnProperty'](_0x1fde57(0x269))&&(_0x4930d6[_0x1fde57(0x269)]=0x0,_0x189c62=!![]);!_0x4930d6[_0x1fde57(0x205)](_0x1fde57(0x2e9))&&(_0x4930d6[_0x1fde57(0x2e9)]=_0x1fde57(0x2c6),_0x189c62=!![]);if(_0x189c62)storeSettings(_0x4930d6);}function storeConfiguration(_0x391f0e){const _0x2b4977=_0x5264f4;dbConfig[_0x2b4977(0x230)](_0x2b4977(0x241))[_0x2b4977(0x1fb)]()['write'](),_0x391f0e[_0x2b4977(0x22d)](_0x4d57e7=>{const _0x12c002=_0x2b4977;delete _0x4d57e7[_0x12c002(0x1c5)];}),dbConfig[_0x2b4977(0x230)](_0x2b4977(0x241))[_0x2b4977(0x1ea)](..._0x391f0e)['write'](),config=_0x391f0e;}function resetPassword(){const _0x172917=_0x5264f4;tgBot&&settings[_0x172917(0x2ef)]&&(tgBot[_0x172917(0x20e)]('callback_query'),tgBot[_0x172917(0x2fe)](settings[_0x172917(0x2ef)],_0x172917(0x212),{'parse_mode':_0x172917(0x27c),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x172917(0x17f)},{'text':'no','callback_data':'no'}]]}})[_0x172917(0x172)](_0x22be84=>{telegramError(_0x22be84);}),tgBot['on']('callback_query',async _0x530112=>{const _0x4476fe=_0x172917,_0x22a663=_0x530112[_0x4476fe(0x24a)],_0x45192e=_0x530112[_0x4476fe(0x2fb)];tgBot[_0x4476fe(0x23d)](_0x530112['id'])[_0x4476fe(0x1ad)](async()=>{const _0xba19ca=_0x4476fe;if(_0x22a663!='no'){const _0x88a5c6=0xf,_0x70d3c1='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x44cf42=Array[_0xba19ca(0x16e)](crypto[_0xba19ca(0x2c5)](new Uint32Array(_0x88a5c6)))[_0xba19ca(0x218)](_0x2c7df5=>_0x70d3c1[_0x2c7df5%_0x70d3c1[_0xba19ca(0x302)]])[_0xba19ca(0x20a)](''),_0x4f76df=bcrypt[_0xba19ca(0x28f)](_0x44cf42,saltRounds);storeSettings({'bbPassword':_0x4f76df}),await tgBot[_0xba19ca(0x2fe)](_0x45192e[_0xba19ca(0x193)]['id'],_0xba19ca(0x244)+_0x44cf42,{'parse_mode':_0xba19ca(0x27c)})[_0xba19ca(0x172)](_0x5c3d5c=>{telegramError(_0x5c3d5c);});}else await tgBot[_0xba19ca(0x2fe)](_0x45192e[_0xba19ca(0x193)]['id'],'Password\x20reset\x20rejected')['catch'](_0x3da873=>{telegramError(_0x3da873);});}),tgBot['removeListener'](_0x4476fe(0x267));}));}async function confirmRestore(_0x44a820,_0x59f060){const _0x58143f=_0x5264f4;tgBot&&settings['telegramChatId']&&(tgBot[_0x58143f(0x20e)](_0x58143f(0x267)),await tgBot['sendMessage'](settings[_0x58143f(0x2ef)],_0x58143f(0x1f5),{'parse_mode':_0x58143f(0x27c),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x58143f(0x17f)},{'text':'no','callback_data':'no'}]]}})[_0x58143f(0x172)](_0x552f6f=>{telegramError(_0x552f6f);}),tgBot['on'](_0x58143f(0x267),async _0x44210d=>{const _0x5db03e=_0x58143f,_0x2073fa=_0x44210d[_0x5db03e(0x24a)],_0x53aef5=_0x44210d[_0x5db03e(0x2fb)];tgBot[_0x5db03e(0x23d)](_0x44210d['id'])['then'](async()=>{const _0x2d5e5f=_0x5db03e;_0x2073fa==_0x2d5e5f(0x17f)?(await tgBot[_0x2d5e5f(0x2fe)](_0x53aef5['chat']['id'],_0x2d5e5f(0x23a),{'parse_mode':_0x2d5e5f(0x27c)})[_0x2d5e5f(0x172)](_0x4e0c8f=>{telegramError(_0x4e0c8f);}),unzipFile(_0x44a820,_0x59f060)):await tgBot['sendMessage'](_0x53aef5[_0x2d5e5f(0x193)]['id'],_0x2d5e5f(0x21e))[_0x2d5e5f(0x172)](_0x40d627=>{telegramError(_0x40d627);});}),tgBot[_0x5db03e(0x20e)](_0x5db03e(0x267));}));}function getServerTime(){const _0xce844e=_0x5264f4,_0x4a92c0=new Date();return _0x4a92c0[_0xce844e(0x2c9)]()+'/'+(_0x4a92c0[_0xce844e(0x2b7)]()+0x1)[_0xce844e(0x2b1)]()[_0xce844e(0x1b1)](0x2,'0')+'/'+_0x4a92c0[_0xce844e(0x287)]()['toString']()[_0xce844e(0x1b1)](0x2,'0')+'\x20'+_0x4a92c0[_0xce844e(0x1f0)]()[_0xce844e(0x2b1)]()[_0xce844e(0x1b1)](0x2,'0')+':'+_0x4a92c0['getMinutes']()[_0xce844e(0x2b1)]()[_0xce844e(0x1b1)](0x2,'0')+':'+_0x4a92c0[_0xce844e(0x194)]()[_0xce844e(0x2b1)]()[_0xce844e(0x1b1)](0x2,'0');}function getTimeStamp(){const _0x3a06f4=_0x5264f4,_0x32d8aa=shiftedTime();return _0x32d8aa['getFullYear']()+'/'+(_0x32d8aa['getMonth']()+0x1)[_0x3a06f4(0x2b1)]()[_0x3a06f4(0x1b1)](0x2,'0')+'/'+_0x32d8aa['getDate']()[_0x3a06f4(0x2b1)]()[_0x3a06f4(0x1b1)](0x2,'0')+'\x20'+_0x32d8aa[_0x3a06f4(0x1f0)]()[_0x3a06f4(0x2b1)]()['padStart'](0x2,'0')+':'+_0x32d8aa[_0x3a06f4(0x263)]()[_0x3a06f4(0x2b1)]()[_0x3a06f4(0x1b1)](0x2,'0')+':'+_0x32d8aa[_0x3a06f4(0x194)]()[_0x3a06f4(0x2b1)]()[_0x3a06f4(0x1b1)](0x2,'0');}function shiftedTime(){const _0x59d0d7=_0x5264f4,_0x1ea979=new Date();let _0x1300f8=_0x1ea979;if(settings['timeshift']&&settings[_0x59d0d7(0x213)]!==0x0)_0x1300f8=fns[_0x59d0d7(0x272)](_0x1ea979,{'hours':settings[_0x59d0d7(0x213)]});return _0x1300f8;}function startScheduler(){const _0x17b5a4=_0x5264f4,_0x227dce=new Date()['getUTCHours'](),_0x153136=shiftedTime()[_0x17b5a4(0x1f0)]();_0x153136==0x4&&backupConfigFiles();_0x153136==0x0&&rotateLogFiles();_0x227dce%0x6==0x0&&triggerAnalytics();_0x227dce%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function backupConfigFiles(){const _0x57875e=_0x5264f4;fs[_0x57875e(0x2a9)](configpath,{'withFileTypes':!![]})[_0x57875e(0x22d)](_0x11c038=>{const _0xda8861=_0x57875e;if(!_0x11c038[_0xda8861(0x26e)]())fs['copyFileSync'](configpath+_0x11c038['name'],configbackuppath+_0x11c038['name']);});}function rotateLogFiles(){const _0x539f7d=_0x5264f4,_0x3901a5=fs[_0x539f7d(0x25a)](logspath+_0x539f7d(0x1d0)),_0x580279=_0x3901a5[_0x539f7d(0x19d)]/0x400;if(_0x580279>0x32){let _0x27e317=fs[_0x539f7d(0x2a9)](logspath,{'withFileTypes':!![]});_0x27e317[_0x539f7d(0x259)]((_0x2e4796,_0x4fd211)=>_0x2e4796['name']<_0x4fd211[_0x539f7d(0x19a)]?0x1:_0x4fd211[_0x539f7d(0x19a)]<_0x2e4796[_0x539f7d(0x19a)]?-0x1:0x0),_0x27e317[_0x539f7d(0x22d)](_0x1a2c55=>{const _0x548c9a=_0x539f7d;if(_0x1a2c55['name']==_0x548c9a(0x1af))fs[_0x548c9a(0x20f)](logspath+_0x1a2c55['name'],logspath+'output-003.log');if(_0x1a2c55[_0x548c9a(0x19a)]==_0x548c9a(0x2a8))fs[_0x548c9a(0x20f)](logspath+_0x1a2c55[_0x548c9a(0x19a)],logspath+_0x548c9a(0x1af));_0x1a2c55[_0x548c9a(0x19a)]==_0x548c9a(0x1d0)&&(fs[_0x548c9a(0x20f)](logspath+_0x1a2c55['name'],logspath+_0x548c9a(0x2a8)),fs[_0x548c9a(0x1ce)](logspath+_0x1a2c55[_0x548c9a(0x19a)],''));});}}async function zipFiles(_0xcac01){const _0x663df6=_0x5264f4;let _0x45b7c4;if(_0xcac01==_0x663df6(0x217))_0x45b7c4=logspath;if(_0xcac01==_0x663df6(0x1e7))_0x45b7c4=configpath;let _0x4dbd64=fs['readdirSync'](_0x45b7c4,{'withFileTypes':!![]});const _0x12bba5=new require('node-zip')();_0x4dbd64[_0x663df6(0x22d)](_0x365756=>{const _0x233194=_0x663df6;if(!_0x365756['isDirectory']()){let _0x424696=fs[_0x233194(0x1e8)](_0x45b7c4+_0x365756[_0x233194(0x19a)]);const _0x4e1c0b=/^bot-[0-9]{3}-config.json$/,_0x70c758=_0x4e1c0b[_0x233194(0x253)](_0x365756[_0x233194(0x19a)]);if(_0x70c758){const _0x3c4c8a=JSON[_0x233194(0x304)](_0x424696);_0x3c4c8a[_0x233194(0x2e0)][0x0][_0x233194(0x2e3)]=_0x233194(0x25b),_0x3c4c8a['bot'][0x0][_0x233194(0x2da)]='***',_0x424696=JSON[_0x233194(0x19f)](_0x3c4c8a,null,0x2);}if(_0x365756[_0x233194(0x19a)]==_0x233194(0x222)){const _0x2c8deb=JSON['parse'](_0x424696);if(_0x2c8deb[_0x233194(0x2c8)][_0x233194(0x1d6)])_0x2c8deb[_0x233194(0x2c8)][_0x233194(0x1d6)]=![];if(_0x2c8deb[_0x233194(0x2c8)]['bbPassword'])_0x2c8deb['settings'][_0x233194(0x2d5)]=_0x233194(0x25b);if(_0x2c8deb[_0x233194(0x2c8)][_0x233194(0x2ee)])_0x2c8deb['settings'][_0x233194(0x2ee)]=_0x233194(0x25b);if(_0x2c8deb['settings'][_0x233194(0x2ef)])_0x2c8deb['settings'][_0x233194(0x2ef)]=null;_0x424696=JSON[_0x233194(0x19f)](_0x2c8deb,null,0x2);}if(_0x365756['name']!=_0x233194(0x1aa))_0x12bba5[_0x233194(0x2c2)](_0x365756['name'],_0x424696);}});const _0x370ac7=_0x12bba5['generate']({'base64':![],'compression':_0x663df6(0x1e4)});fs['writeFileSync'](zippath+(_0xcac01+_0x663df6(0x260)),_0x370ac7,_0x663df6(0x276));}async function unzipFile(_0x3e6a33,_0x515f69){const _0x5d87d0=_0x5264f4;await backupConfigFiles(),fs[_0x5d87d0(0x2a9)](configpath,{'withFileTypes':!![]})['forEach'](_0x3d1427=>{if(!_0x3d1427['isDirectory']())fs['rmSync'](configpath+_0x3d1427['name']);});const _0x31ffe5=fs['readFileSync'](_0x3e6a33+_0x515f69,_0x5d87d0(0x276)),_0x3a7dfc=new require(_0x5d87d0(0x300))(_0x31ffe5,{'base64':![],'checkCRC32':!![]});Object[_0x5d87d0(0x215)](_0x3a7dfc[_0x5d87d0(0x1b6)])[_0x5d87d0(0x22d)](_0x154a59=>{const _0x11532f=_0x5d87d0,_0x3e1688=_0x3a7dfc[_0x11532f(0x1b6)][_0x154a59];fs[_0x11532f(0x1ce)](configpath+_0x3e1688[_0x11532f(0x19a)],_0x3e1688[_0x11532f(0x216)]);}),fs[_0x5d87d0(0x2a9)](temppath,{'withFileTypes':!![]})[_0x5d87d0(0x22d)](_0xd65d23=>{const _0x1bd43a=_0x5d87d0;if(!_0xd65d23[_0x1bd43a(0x26e)]())fs[_0x1bd43a(0x2d7)](temppath+_0xd65d23[_0x1bd43a(0x19a)]);}),process[_0x5d87d0(0x2d8)]({'restore':!![]},_0x3b0b6b=>{});}async function getPublicIp(){const _0x5dbe94=_0x5264f4;try{const _0x12be29=await axios[_0x5dbe94(0x230)](_0x5dbe94(0x1c9));publicip=_0x12be29[_0x5dbe94(0x24a)]['ip'];}catch(_0x2d4881){}}async function triggerAnalytics(){const _0x4071e4=_0x5264f4;if(!publicip)await getPublicIp();const _0x3796cc=getBotsWithMode();let _0x90320a=0x0;_0x3796cc[_0x4071e4(0x22d)](_0x4f9f3f=>{const _0x35f118=_0x4071e4;if(_0x4f9f3f[_0x35f118(0x2f8)]===_0x35f118(0x2c0))_0x90320a++;}),mixpanel['track'](_0x4071e4(0x1b3),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x3796cc[_0x4071e4(0x302)],'numbotsenabled':_0x90320a});}async function getMessages(){const _0x4e4e43=_0x5264f4,_0x176cd8='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x33bbdc=new GraphQLClient(_0x176cd8),_0x480b5c={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x2d432e=serverversion[_0x4e4e43(0x1fc)]('.'),_0x1052c2=_0x2d432e[0x0]+'.'+_0x2d432e[0x1],_0xa81670=Math['min'](settings[_0x4e4e43(0x256)],settings[_0x4e4e43(0x269)]),_0x1e377d={'last':parseInt(_0xa81670),'bbm':_0x1052c2},_0x2fb664=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x36b077;try{_0x36b077=await _0x33bbdc['request'](_0x2fb664,_0x1e377d,_0x480b5c);}catch(_0x59f418){}if(_0x36b077&&_0x36b077[_0x4e4e43(0x24e)]){let _0x55959b=settings[_0x4e4e43(0x256)];newMessages=[];for(const _0x45df0a of _0x36b077[_0x4e4e43(0x24e)]){newMessages['push'](_0x45df0a);if(_0x45df0a[_0x4e4e43(0x2bf)])updateSetting(_0x4e4e43(0x2e9),_0x45df0a['bbvNew']);let _0x3d8095=_0x45df0a[_0x4e4e43(0x2bf)]?serverversion>=_0x45df0a[_0x4e4e43(0x2bf)]:![];if(!_0x3d8095&&_0x45df0a['number']>_0x55959b){if(_0x45df0a['bbvReceive']===_0x4e4e43(0x273)||serverversion[_0x4e4e43(0x2ea)](_0x45df0a[_0x4e4e43(0x2cd)])){let _0x15d7bc=''+_0x45df0a['title']+'\x0a\x0a'+_0x45df0a[_0x4e4e43(0x2fb)];const _0x11fe4a=await sendTelegramMsg(toTelegramMarkdown(_0x15d7bc),_0x4e4e43(0x26f));if(_0x11fe4a)_0x55959b=_0x45df0a[_0x4e4e43(0x1c6)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x4e4e43(0x256),_0x55959b),emitMessages();}}function emitMessages(){const _0x11e496=_0x5264f4,_0x3a8f5e=settings['lastmsgemitted'];let _0x2c3a26=[];newMessages[_0x11e496(0x22d)](_0x324500=>{const _0x52718b=_0x11e496;_0x324500[_0x52718b(0x1c6)]>_0x3a8f5e&&_0x2c3a26[_0x52718b(0x1ea)](_0x324500);}),_0x2c3a26[_0x11e496(0x302)]>0x0&&getAllClients()[_0x11e496(0x22d)](_0x2ed4af=>{const _0x4aaa1b=_0x11e496;getSocket(_0x2ed4af['id'])[_0x4aaa1b(0x1fe)](_0x4aaa1b(0x2fb),_0x2c3a26);});}function confirmMessage(_0x5bb6b1){const _0x28e6bb=_0x5264f4;updateSetting(_0x28e6bb(0x269),Number(_0x5bb6b1));}function isNewerVersion(_0x1fba8c,_0x49ff2b){const _0x29b7c8=_0x5264f4,_0x2ce86c=_0x49ff2b[_0x29b7c8(0x1fc)]('.'),_0xc7c368=_0x1fba8c[_0x29b7c8(0x1fc)]('.');for(var _0x44d0b9=0x0;_0x44d0b9<_0xc7c368[_0x29b7c8(0x302)];_0x44d0b9++){const _0x13e052=~~_0xc7c368[_0x44d0b9],_0xc119e2=~~_0x2ce86c[_0x44d0b9];if(_0x13e052>_0xc119e2)return!![];if(_0x13e052<_0xc119e2)return![];}return![];}function toTelegramMarkdown(_0x4415db){const _0x3ad12e=_0x5264f4,_0x5cdd93=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x313b42=/\*{2}(.+?)\*{2}/gim;return _0x4415db=_0x4415db[_0x3ad12e(0x22f)](_0x5cdd93,_0x3ad12e(0x2ae))['replace'](_0x313b42,_0x3ad12e(0x1b8)),_0x4415db;}async function validateConfigFile(){const _0x571358=_0x5264f4,_0x59d943=dbConfig['get'](_0x571358(0x241))[_0x571358(0x2b4)]('botID')[_0x571358(0x2e4)]()||[];if(_0x59d943[_0x571358(0x302)]==0x0){let _0xa54287=0x0,_0x2755f3=[];const _0x2e4705=/^bot-([0-9]{3})-config.json$/,_0x11a9b4=fs[_0x571358(0x2a9)](configpath);_0x11a9b4[_0x571358(0x22d)](_0xa0ec73=>{const _0x208b76=_0x571358,_0x54d075=_0x2e4705[_0x208b76(0x1b7)](_0xa0ec73);if(_0x54d075){const _0x4aae20=_0x54d075[0x1];let _0x4376b5=getBotAttributes(_0x4aae20);_0x2755f3[_0x208b76(0x1ea)]({'botID':_0x4aae20,'botname':_0x4376b5[_0x208b76(0x2f0)],'status':'disabled','live':_0x208b76(0x1dc)}),_0xa54287++;}}),_0xa54287!=0x0&&(dbConfig[_0x571358(0x230)](_0x571358(0x241))['assign'](_0x2755f3)[_0x571358(0x1b9)](),config=_0x2755f3,restoredConfigFile=_0xa54287);}}async function restoreConfigNotify(_0x11cd0e){const _0x575d61=_0x5264f4;let _0x59c761;if(restoredConfigFile==0x1)_0x59c761=_0x575d61(0x1bd);else _0x59c761=_0x575d61(0x291);if(_0x11cd0e)io['to'](_0x575d61(0x2ad))[_0x575d61(0x1fe)](_0x575d61(0x1f9),_0x59c761);else{logger[_0x575d61(0x2ac)](_0x575d61(0x1ee)),logger[_0x575d61(0x2ac)](_0x59c761),logger[_0x575d61(0x2ac)](_0x575d61(0x1ee)),logger['simple']('');if(tgBot&&settings[_0x575d61(0x2ef)]&&settings[_0x575d61(0x190)]!=_0x575d61(0x21c))tgBot[_0x575d61(0x2fe)](settings[_0x575d61(0x2ef)],_0x575d61(0x23e)+_0x59c761)[_0x575d61(0x172)](_0x2d9dd8=>{telegramError(_0x2d9dd8);});}}function validateCredentials(_0x36653a,_0x26a272){const _0x44e70a=_0x5264f4;if(_0x36653a['username']==settings[_0x44e70a(0x175)]&&bcrypt[_0x44e70a(0x1b2)](_0x36653a[_0x44e70a(0x2f2)],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x3603a8=generateLoginToken(_0x26a272);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x3603a8};}}else return{'allow':![],'reason':_0x44e70a(0x16c),'token':null};}function refreshToken(_0x362e77){const _0x4ce5b2=generateLoginToken(_0x362e77);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x4ce5b2};}function validateAccess(_0x1424c5,_0x4a4ae7,_0x3fde7f){const _0x137344=_0x5264f4,_0x380153=_0x3fde7f?_0x3fde7f:devices[_0x4a4ae7]['ip'];let _0x126c29;const _0x373ebf=_0x255863=>{const _0x1114c4=_0x305e;if(settings['loginRequired']){if(settings[_0x1114c4(0x203)]){if(telegram2FaApproved(_0x4a4ae7)){const _0x2a5096=generateLoginToken(_0x4a4ae7);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x2a5096};}else return{'allow':![],'reason':_0x1114c4(0x2e8),'token':null};}else return _0x126c29=validToken(_0x255863,_0x4a4ae7),_0x126c29[_0x1114c4(0x205)](_0x1114c4(0x191))?{'allow':!![],'reason':_0x1114c4(0x274),'token':_0x255863}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x1114c4(0x25e),'token':null};};if(settings[_0x137344(0x2c4)]){let _0x491b73=[...settings[_0x137344(0x1d8)],_0x137344(0x2d4),_0x137344(0x242),'127.0.0.1'];if(_0x491b73['includes'](_0x380153))return _0x373ebf(_0x1424c5);else{_0x126c29=validToken(_0x1424c5,_0x4a4ae7);if(_0x126c29[_0x137344(0x205)](_0x137344(0x191)))return _0x373ebf(_0x1424c5);else{if(telegramIpApproved(_0x4a4ae7)){const _0x20e4b3=generateToken(_0x4a4ae7);return _0x126c29=_0x373ebf(_0x1424c5),_0x126c29[_0x137344(0x1c1)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x20e4b3}:_0x126c29;}else return settings[_0x137344(0x211)]?{'allow':![],'reason':_0x137344(0x1d4),'token':null}:{'allow':![],'reason':_0x137344(0x1a2),'token':null};}}}else return _0x373ebf(_0x1424c5);}function timelyDecrypt(_0xa37c8,_0x10b068=!![]){const _0x27d5b5=_0x5264f4;if(_0xa37c8)try{const _0x31f624=crypt[_0x27d5b5(0x206)](secure[_0x27d5b5(0x309)],_0xa37c8)['message'],_0x559dae=_0x31f624[_0x27d5b5(0x1fc)]('@')[0x0],_0x2c91b4=_0x31f624[_0x27d5b5(0x1fc)]('@')[0x1],_0x1546b7=new Date()['getTime']();if(_0x10b068){if(_0x1546b7-_0x2c91b4<maxSecretAge*0x3e8)return _0x559dae;else return![];}else return _0x559dae;}catch(_0x18b436){return![];}else return![];}const validToken=(_0x69e5a,_0x138f5a)=>{const _0x4948aa=_0x5264f4,_0x44a376=devices[_0x138f5a]['ip'];if(!_0x69e5a)return{'error':_0x4948aa(0x2f1)};for(let _0xf9d014 of blacklist){if(_0xf9d014['token']==_0x69e5a)return{'error':_0x4948aa(0x197)};}let _0x554e21;try{_0x554e21=jwt[_0x4948aa(0x30a)](_0x69e5a,secure[_0x4948aa(0x30c)]+_0x138f5a);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x554e21[_0x4948aa(0x205)](_0x4948aa(0x228))&&!_0x554e21[_0x4948aa(0x205)]('username')||!_0x554e21[_0x4948aa(0x205)](_0x4948aa(0x289)))return{'error':_0x4948aa(0x1ca)};if(!_0x554e21[_0x4948aa(0x205)](_0x4948aa(0x1dd))&&_0x554e21['hasOwnProperty']('clientip')){const {clientip:_0x3a7937}=_0x554e21;return _0x44a376==_0x3a7937?{'success':_0x4948aa(0x221)}:{'error':_0x4948aa(0x1f2)};}else{if(_0x554e21[_0x4948aa(0x205)]('username')&&_0x554e21['hasOwnProperty'](_0x4948aa(0x228))){const {username:_0xd212b1,clientip:_0xdb429}=_0x554e21;return settings[_0x4948aa(0x175)]==_0xd212b1&&_0x44a376==_0xdb429?{'success':_0x4948aa(0x221)}:{'error':_0x4948aa(0x1e6)};}}},generateLoginToken=_0x2dcc21=>{const _0x5b69d0=_0x5264f4;if(_0x2dcc21){const _0x1b01cf=devices[_0x2dcc21]['ip'];return jwt[_0x5b69d0(0x2b9)]({'username':settings[_0x5b69d0(0x175)],'clientip':_0x1b01cf},secure[_0x5b69d0(0x30c)]+_0x2dcc21,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x903e7=>{const _0x48288f=_0x5264f4;if(_0x903e7){const _0x4d3144=devices[_0x903e7]['ip'];return jwt[_0x48288f(0x2b9)]({'clientip':_0x4d3144},secure[_0x48288f(0x30c)]+_0x903e7,{'expiresIn':devices[_0x903e7][_0x48288f(0x1da)][_0x48288f(0x20b)]*0x3c});}else return![];},telegramIpApproved=_0x39cf8f=>{const _0x1b71e4=_0x5264f4;let _0x50d555=![];return devices[_0x39cf8f][_0x1b71e4(0x1da)]&&devices[_0x39cf8f]['telegramIpApproval'][_0x1b71e4(0x20b)]!=_0x1b71e4(0x19c)&&(_0x50d555=devices[_0x39cf8f]['telegramIpApproval'][_0x1b71e4(0x228)]==devices[_0x39cf8f]['ip']&&new Date()[_0x1b71e4(0x1e1)]()-devices[_0x39cf8f][_0x1b71e4(0x1da)]['timestamp']<devices[_0x39cf8f]['telegramIpApproval']['expiry']*0x3c*0x3e8),_0x50d555;},telegram2FaApproved=_0xafa4e3=>{const _0x4bb208=_0x5264f4;let _0x47604b=![];return devices[_0xafa4e3][_0x4bb208(0x1d3)]&&devices[_0xafa4e3][_0x4bb208(0x1d3)][_0x4bb208(0x20b)]!=_0x4bb208(0x19c)&&(_0x47604b=devices[_0xafa4e3][_0x4bb208(0x1d3)][_0x4bb208(0x228)]==devices[_0xafa4e3]['ip']&&new Date()[_0x4bb208(0x1e1)]()-devices[_0xafa4e3][_0x4bb208(0x1d3)][_0x4bb208(0x2eb)]<devices[_0xafa4e3][_0x4bb208(0x1d3)][_0x4bb208(0x20b)]*0x3c*0x3e8),_0x47604b;},normalizeIP=_0x41facb=>{const _0x441dd9=_0x5264f4;let _0x8e2ffb=null,_0x47d2ff=null;if(ipaddr[_0x441dd9(0x301)](_0x41facb)){const _0x569ba8=ipaddr[_0x441dd9(0x304)](_0x41facb);_0x569ba8[_0x441dd9(0x21d)]()===_0x441dd9(0x2ed)?(_0x569ba8['isIPv4MappedAddress']()&&(_0x8e2ffb=_0x569ba8['toIPv4Address']()[_0x441dd9(0x2b1)]()),_0x47d2ff=_0x569ba8['toString']()):(_0x8e2ffb=_0x569ba8['toString'](),_0x47d2ff=_0x569ba8[_0x441dd9(0x1a5)]()[_0x441dd9(0x2b1)]());}return{'show':_0x8e2ffb?_0x8e2ffb:_0x47d2ff,'store':_0x47d2ff};};function sleep(_0x38d61a){return new Promise(_0x49b594=>setTimeout(_0x49b594,_0x38d61a));}