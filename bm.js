const _0x1ec03f=_0x3adf;(function(_0x23fc4e,_0x31a623){const _0x1c6f97=_0x3adf,_0x5a6f86=_0x23fc4e();while(!![]){try{const _0x407169=parseInt(_0x1c6f97(0x336))/0x1*(-parseInt(_0x1c6f97(0x2d2))/0x2)+parseInt(_0x1c6f97(0x2ae))/0x3+-parseInt(_0x1c6f97(0x21d))/0x4*(parseInt(_0x1c6f97(0x268))/0x5)+parseInt(_0x1c6f97(0x1f6))/0x6*(-parseInt(_0x1c6f97(0x209))/0x7)+-parseInt(_0x1c6f97(0x301))/0x8*(-parseInt(_0x1c6f97(0x21e))/0x9)+-parseInt(_0x1c6f97(0x34e))/0xa*(parseInt(_0x1c6f97(0x2ef))/0xb)+parseInt(_0x1c6f97(0x3d0))/0xc*(parseInt(_0x1c6f97(0x379))/0xd);if(_0x407169===_0x31a623)break;else _0x5a6f86['push'](_0x5a6f86['shift']());}catch(_0x63dcdb){_0x5a6f86['push'](_0x5a6f86['shift']());}}}(_0x3c13,0x5ed20));const _0xc5fc2a=function(){let _0x245d96=!![];return function(_0x573a0d,_0x3972e9){const _0x27b55e=_0x245d96?function(){if(_0x3972e9){const _0xb3fe57=_0x3972e9['apply'](_0x573a0d,arguments);return _0x3972e9=null,_0xb3fe57;}}:function(){};return _0x245d96=![],_0x27b55e;};}(),_0x559a9b=_0xc5fc2a(this,function(){const _0x525d77=_0x3adf;return _0x559a9b['toString']()[_0x525d77(0x3b3)](_0x525d77(0x2c8))[_0x525d77(0x2ff)]()[_0x525d77(0x347)](_0x559a9b)['search'](_0x525d77(0x2c8));});_0x559a9b();'use strict';process[_0x1ec03f(0x26f)][_0x1ec03f(0x31d)]=0x1;const childProcess=require(_0x1ec03f(0x353)),fs=require('fs'),fns=require(_0x1ec03f(0x38e)),low=require(_0x1ec03f(0x2a3)),FileSync=require(_0x1ec03f(0x22e)),path=require(_0x1ec03f(0x35d)),crypto=require(_0x1ec03f(0x2b2)),Crypt=require(_0x1ec03f(0x3dd))[_0x1ec03f(0x342)],RSA=require(_0x1ec03f(0x3dd))[_0x1ec03f(0x273)],bcrypt=require('bcryptjs'),jwt=require(_0x1ec03f(0x277)),ipaddr=require(_0x1ec03f(0x243)),argv=require('yargs/yargs')(process[_0x1ec03f(0x2e3)]['slice'](0x2))[_0x1ec03f(0x2e3)],uuidRandom=require(_0x1ec03f(0x2e4)),{Telegraf,Markup}=require(_0x1ec03f(0x23b)),Mixpanel=require(_0x1ec03f(0x3a5)),axios=require(_0x1ec03f(0x2c3)),{GraphQLClient,gql}=require(_0x1ec03f(0x222)),util=require(_0x1ec03f(0x22c)),fileUpload=require(_0x1ec03f(0x2fc)),{networkInterfaces}=require('os'),PORT=argv[_0x1ec03f(0x370)]||_0x1ec03f(0x376),pattern=/^[0-9]{2,4}$/;!pattern[_0x1ec03f(0x2a2)](PORT)&&(console[_0x1ec03f(0x265)](_0x1ec03f(0x251)+PORT+_0x1ec03f(0x380)),process[_0x1ec03f(0x386)](0x1));const HOST=argv[_0x1ec03f(0x27b)]||null,userID=argv[_0x1ec03f(0x27e)]||'',debugging=argv['d']||![],nodeversion=process[_0x1ec03f(0x311)]['node'];let bbpath='bb/',bbpath2='';function _0x3adf(_0xca48d7,_0x4169cd){const _0x33576d=_0x3c13();return _0x3adf=function(_0x559a9b,_0xc5fc2a){_0x559a9b=_0x559a9b-0x1e9;let _0x3c1332=_0x33576d[_0x559a9b];return _0x3c1332;},_0x3adf(_0xca48d7,_0x4169cd);}const botfile=_0x1ec03f(0x2c4),configfile=_0x1ec03f(0x292),settingsfile=_0x1ec03f(0x3d5),securefile=_0x1ec03f(0x275),environment=require('./'+bbpath2+_0x1ec03f(0x355))['environment']||_0x1ec03f(0x2a1),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x1ec03f(0x2c7)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x1ec03f(0x328)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x1ec03f(0x3a6),configbackuppath=configpath+_0x1ec03f(0x398),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x1ec03f(0x252)+userID+'/':bbpath+_0x1ec03f(0x252),loggerfile=fs['createWriteStream'](logspath+_0x1ec03f(0x2f2),{'flags':'a'}),temppath=userID?bbpath+_0x1ec03f(0x2b4)+userID+'/':bbpath+_0x1ec03f(0x2b4);!fs[_0x1ec03f(0x2c7)](configpath)&&fs['mkdirSync'](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x1ec03f(0x2c7)](logspath)&&fs[_0x1ec03f(0x2e8)](logspath);!fs['existsSync'](zippath)&&fs[_0x1ec03f(0x2e8)](zippath);!fs[_0x1ec03f(0x2c7)](temppath)&&fs[_0x1ec03f(0x2e8)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x1ec03f(0x38c)]({'bots':[]})[_0x1ec03f(0x33e)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x1ec03f(0x38c)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x1ec03f(0x232),'onepagemode':![],'marketcapApi':''}})[_0x1ec03f(0x33e)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x1ec03f(0x38c)]({'secure':{},'blacklist':[]})[_0x1ec03f(0x33e)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x1ec03f(0x27f)});const saltRounds=0xa,mixpanel=Mixpanel[_0x1ec03f(0x2ba)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x1ec03f(0x27c)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings['telegramToken']!=''&&settings[_0x1ec03f(0x211)]!=_0x1ec03f(0x3e9))&&settings[_0x1ec03f(0x2fe)]&&settings[_0x1ec03f(0x2fe)]!='')initTelegram();const parseColor=(_0x2a8028,_0x292717)=>{const _0xa62760=_0x1ec03f,_0x46994a=/#[A-Z]{3}#/g;if(typeof _0x2a8028==_0xa62760(0x283)){!_0x292717?_0x2a8028=_0x2a8028[_0xa62760(0x2a8)](_0x46994a,''):(_0x2a8028=_0x2a8028['replace'](/#BLU#/g,_0xa62760(0x3ea)),_0x2a8028=_0x2a8028[_0xa62760(0x2a8)](/#RED#/g,'\x1b[31m'),_0x2a8028=_0x2a8028[_0xa62760(0x2a8)](/#YEL#/g,_0xa62760(0x34c)),_0x2a8028=_0x2a8028[_0xa62760(0x2a8)](/#MAG#/g,'\x1b[35m'),_0x2a8028=_0x2a8028[_0xa62760(0x2a8)](/#CYA#/g,_0xa62760(0x3d3)),_0x2a8028=_0x2a8028[_0xa62760(0x2a8)](/#RES#/g,_0xa62760(0x31e)));;}return _0x2a8028;},logger={'screen':_0x2eb44e=>{console['log'](parseColor(_0x2eb44e,!![]));},'simple':_0x2d5093=>{const _0x18cd55=_0x1ec03f;console[_0x18cd55(0x265)](parseColor(_0x2d5093,!![])),loggerfile['write'](util[_0x18cd55(0x38f)](parseColor(_0x2d5093,![]))+'\x0a');},'full':async _0x4c83fd=>{const _0x593566=_0x1ec03f,_0x307c3c=getTimeStamp()+_0x593566(0x37d)+_0x4c83fd;console[_0x593566(0x265)](parseColor(_0x307c3c,!![])),loggerfile[_0x593566(0x33e)](util[_0x593566(0x38f)](parseColor(_0x307c3c,![]))+'\x0a');if(tgBot&&settings[_0x593566(0x206)]&&settings['telegramEvents']!=_0x593566(0x38b))await sendTelegram(settings[_0x593566(0x206)],_0x593566(0x25c)+parseColor(_0x4c83fd,![]));},'debug':async(_0x22f871,_0x473102='')=>{const _0x187ffc=_0x1ec03f,_0x5e001a=getTimeStamp()+_0x187ffc(0x37a)+_0x22f871;if(debugging)console['log'](parseColor(_0x5e001a,!![]));loggerfile['write'](util[_0x187ffc(0x38f)](parseColor(_0x5e001a,![]))+'\x0a');if(_0x473102){if(debugging)console['log'](_0x473102);loggerfile['write'](util[_0x187ffc(0x38f)](_0x473102)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x4946b5){const _0x466b9b=_0x1ec03f;_0x4946b5['toString']()[_0x466b9b(0x359)](_0x466b9b(0x30f))?(logger[_0x466b9b(0x2f7)](_0x466b9b(0x349)+_0x4946b5['port']+_0x466b9b(0x29c)),process[_0x466b9b(0x1ec)]({'terminate':!![]},_0x2cd524=>{})):logger[_0x466b9b(0x2f7)](_0x4946b5);}),process['on'](_0x1ec03f(0x386),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x1ec03f(0x320),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x1ec03f(0x3be),()=>{const _0x51c67e=_0x1ec03f;stopAllBots(),process[_0x51c67e(0x386)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x1ec03f(0x355))[_0x1ec03f(0x214)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x1ec03f(0x334)),app=express(),http=require(_0x1ec03f(0x2db))[_0x1ec03f(0x309)](app);app[_0x1ec03f(0x350)](fileUpload({'useTempFiles':!![]})),app[_0x1ec03f(0x236)](_0x1ec03f(0x2c5),async(_0x17d0bf,_0x2047a6)=>{const _0x3023d1=_0x1ec03f,_0x464039=_0x17d0bf[_0x3023d1(0x2ec)][_0x3023d1(0x24a)],_0xaeaa0=getClientsWithBotID(_0x3023d1(0x329)),_0x32e9d7=_0x17d0bf['headers'][_0x3023d1(0x2fa)],_0x45f94c=timelyDecrypt(_0x32e9d7,![]),_0xa66646=_0xaeaa0['find'](_0x49a6f6=>_0x49a6f6[_0x3023d1(0x2fa)]==_0x45f94c);if(_0xa66646){const _0x63c58f=normalizeIP(_0x17d0bf[_0x3023d1(0x3b9)][_0x3023d1(0x326)])[_0x3023d1(0x39a)],_0x40cacb=_0x17d0bf[_0x3023d1(0x373)]['tkn'];if(validateAccess(_0x40cacb,_0x45f94c,_0x63c58f)[_0x3023d1(0x3aa)])_0x464039==_0x3023d1(0x324)&&await backupConfigFiles(),await zipFiles(_0x464039),_0x2047a6[_0x3023d1(0x37c)](zippath+(_0x464039+_0x3023d1(0x30e)),_0x2a0935=>{const _0x43f907=_0x3023d1;_0x2a0935&&(logger[_0x43f907(0x24e)](_0x43f907(0x2a5)+_0x464039),logger[_0x43f907(0x2f7)](_0x2a0935));});else logger[_0x3023d1(0x24e)](_0x3023d1(0x3a4)+_0x464039+_0x3023d1(0x37e));}else logger[_0x3023d1(0x24e)](_0x3023d1(0x3a4)+_0x464039+_0x3023d1(0x262));}),app[_0x1ec03f(0x2ce)](_0x1ec03f(0x2cd),async(_0x2b69db,_0x7c04ca)=>{const _0x2f220f=_0x1ec03f,_0x38b675=getClientsWithBotID(_0x2f220f(0x329)),_0x9aaf26=_0x2b69db['headers'][_0x2f220f(0x2fa)],_0x8d5cd8=timelyDecrypt(_0x9aaf26,![]),_0x33a4cf=_0x38b675[_0x2f220f(0x23d)](_0x397097=>_0x397097[_0x2f220f(0x2fa)]==_0x8d5cd8);logger['debug']('Backup\x20file\x20uploaded');if(_0x33a4cf){const _0x4a00f1=normalizeIP(_0x2b69db[_0x2f220f(0x3b9)][_0x2f220f(0x326)])[_0x2f220f(0x39a)],_0x2ee6e4=_0x2b69db['headers'][_0x2f220f(0x22b)];if(validateAccess(_0x2ee6e4,_0x8d5cd8,_0x4a00f1)[_0x2f220f(0x3aa)]){if(_0x2b69db[_0x2f220f(0x2a7)]){const _0x3a2446=_0x2b69db[_0x2f220f(0x2a7)]['backupfile'];await _0x3a2446['mv'](temppath+_0x3a2446['name']),_0x7c04ca[_0x2f220f(0x1ec)]({'status':!![],'message':_0x2f220f(0x2df)});const _0x77faf5=getBotsWithMode();_0x77faf5[_0x2f220f(0x315)]>0x0?confirmRestore(temppath,_0x3a2446[_0x2f220f(0x30a)]):unzipFile(temppath,_0x3a2446[_0x2f220f(0x30a)]);}}else logger[_0x2f220f(0x24e)](_0x2f220f(0x1f0));}else logger['full'](_0x2f220f(0x1ed));}),app[_0x1ec03f(0x350)](express[_0x1ec03f(0x2cc)](path[_0x1ec03f(0x226)](__dirname,bbpath2,_0x1ec03f(0x29d)))),app[_0x1ec03f(0x350)](express['static'](path['join'](__dirname,bbpath2,_0x1ec03f(0x25f)))),app[_0x1ec03f(0x236)]('/',function(_0x5c1d8c,_0x1831f0){const _0x399c7d=_0x1ec03f;_0x1831f0[_0x399c7d(0x228)](path['join'](__dirname,bbpath2,'build2',_0x399c7d(0x250)));}),app[_0x1ec03f(0x236)]('/:bot',function(_0x38f3a3,_0x393e06){const _0x54b56c=_0x1ec03f;_0x393e06['sendFile'](path[_0x54b56c(0x226)](__dirname,bbpath2,'build',_0x54b56c(0x250)));}),app[_0x1ec03f(0x236)](_0x1ec03f(0x2b5),(_0x474768,_0x383408)=>{const _0x56a280=_0x1ec03f;_0x383408['sendFile'](path[_0x56a280(0x226)](__dirname,bbpath2,'build','index.html'));}),app['get']('/:bot/performance',(_0x256f87,_0x423400)=>{const _0x3a06d9=_0x1ec03f;_0x423400[_0x3a06d9(0x228)](path[_0x3a06d9(0x226)](__dirname,bbpath2,'build',_0x3a06d9(0x250)));}),app[_0x1ec03f(0x236)](_0x1ec03f(0x296),(_0x4326a5,_0x2d45d4)=>{const _0x35c171=_0x1ec03f;_0x2d45d4[_0x35c171(0x228)](path['join'](__dirname,bbpath2,'build','index.html'));}),app[_0x1ec03f(0x236)]('/:bot/history',(_0x152db5,_0x211164)=>{const _0x2efa62=_0x1ec03f;_0x211164[_0x2efa62(0x228)](path[_0x2efa62(0x226)](__dirname,bbpath2,_0x2efa62(0x25f),'index.html'));}),app[_0x1ec03f(0x236)](_0x1ec03f(0x304),(_0x49393b,_0x3fd3c5)=>{const _0x51883a=_0x1ec03f;_0x3fd3c5[_0x51883a(0x228)](path[_0x51883a(0x226)](__dirname,bbpath2,_0x51883a(0x25f),_0x51883a(0x250)));}),app['get']('/:bot/support',(_0xadebc4,_0x23f6f2)=>{const _0x4f6427=_0x1ec03f;_0x23f6f2[_0x4f6427(0x228)](path[_0x4f6427(0x226)](__dirname,bbpath2,_0x4f6427(0x25f),_0x4f6427(0x250)));});if(HOST)http[_0x1ec03f(0x2dd)](PORT,HOST);else http['listen'](PORT);const io=require(_0x1ec03f(0x340))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x367295=_0x1ec03f;let _0x50aafb=_0x367295(0x223);const _0x36713a=networkInterfaces(),_0x49d245={};for(const _0x5f0360 of Object[_0x367295(0x2b3)](_0x36713a)){for(const _0x2626d0 of _0x36713a[_0x5f0360]){if((_0x2626d0['family']=='IPv4'||_0x2626d0['family']==0x4)&&!_0x2626d0['internal']){const _0x42f04b=ipaddr[_0x367295(0x1ff)](_0x2626d0[_0x367295(0x385)])[_0x367295(0x286)]();_0x42f04b!=_0x367295(0x321)&&(!_0x49d245[_0x5f0360]&&(_0x49d245[_0x5f0360]=[]),_0x49d245[_0x5f0360][_0x367295(0x344)](_0x2626d0[_0x367295(0x385)]),_0x50aafb=_0x2626d0[_0x367295(0x385)]);}}}return{'serverip':_0x50aafb,'netinterfaces':_0x49d245};}async function startServer(){const _0x469a4c=_0x1ec03f,{serverip:_0x44009e,netinterfaces:_0x511cef}=getServerIP();logger[_0x469a4c(0x2f7)](''),logger['simple'](_0x469a4c(0x377)),await logger[_0x469a4c(0x24e)](_0x469a4c(0x36b)+serverversion+_0x469a4c(0x244)+(environment==_0x469a4c(0x36a)?'(staging)':'')+'\x0a'+(_0x469a4c(0x2ee)+PORT+_0x469a4c(0x31b))+(_0x469a4c(0x2d6)+_0x44009e+':'+PORT+_0x469a4c(0x333))),logger['simple']('-----------------------------------------------------------------------------------');if(config['length']!=0x0)for(const _0x2c4c74 of config){const _0x5041e5=_0x2c4c74[_0x469a4c(0x279)]==_0x469a4c(0x3b5)?'a':'m';if(_0x2c4c74[_0x469a4c(0x247)]==_0x469a4c(0x3ec)||_0x2c4c74[_0x469a4c(0x247)]==_0x469a4c(0x3d6))await logger[_0x469a4c(0x24e)](_0x469a4c(0x3c3)+_0x5041e5+')\x20|\x20Bot\x20'+_0x2c4c74[_0x469a4c(0x36d)]+_0x469a4c(0x207)+_0x2c4c74[_0x469a4c(0x3a3)]),startBot([_0x2c4c74[_0x469a4c(0x36d)],userID],{'cwd':bbpath},function(_0x38d259){const _0x1fdf52=_0x469a4c;if(_0x38d259)logger[_0x1fdf52(0x24e)](_0x38d259);});else(_0x2c4c74[_0x469a4c(0x247)]=='disabled'||_0x2c4c74[_0x469a4c(0x247)]=='new-disabled')&&await logger[_0x469a4c(0x24e)](_0x469a4c(0x2f8)+_0x5041e5+_0x469a4c(0x366)+_0x2c4c74['botID']+_0x469a4c(0x207)+_0x2c4c74[_0x469a4c(0x3a3)]);}else!newBot&&logger[_0x469a4c(0x2f7)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x469a4c(0x2f7)](_0x469a4c(0x377)),logger['simple'](''),await logger[_0x469a4c(0x338)](_0x469a4c(0x267)+nodeversion),await logger[_0x469a4c(0x338)](_0x469a4c(0x2cf),_0x511cef);}function startSocket(){const _0x5323aa=_0x1ec03f;io['on'](_0x5323aa(0x2d5),_0x2ca3e4=>{const _0x7d94de=_0x5323aa;let _0x3050f5,_0x2283e5,_0x3f80c2,_0x4927bb,_0x45a792;const _0x445ef7=_0x2ca3e4['handshake'][_0x7d94de(0x373)][_0x7d94de(0x316)];_0x2283e5=_0x445ef7[_0x7d94de(0x312)](/bot[0-9]{3}/);if(_0x2283e5)_0x3f80c2=_0x2283e5[0x0][_0x7d94de(0x312)](/[0-9]{3}/);if(_0x3f80c2)_0x3050f5=_0x3f80c2[0x0];else _0x3050f5='botmanager';const _0x18dbbf=_0x2ca3e4['handshake'][_0x7d94de(0x392)][_0x7d94de(0x280)];if(!_0x18dbbf)_0x2ca3e4[_0x7d94de(0x394)](_0x7d94de(0x247),{'publicKey':secure[_0x7d94de(0x2d1)]});else{_0x4927bb=timelyDecrypt(_0x18dbbf,![]);if(!_0x4927bb)_0x2ca3e4['emit']('status',{'publicKey':secure[_0x7d94de(0x2d1)]});else{_0x45a792=normalizeIP(_0x2ca3e4[_0x7d94de(0x2a4)][_0x7d94de(0x326)])[_0x7d94de(0x39a)];if(!devices[_0x4927bb])devices[_0x4927bb]={'uuid':_0x4927bb,'access':{'token':null}};devices[_0x4927bb]['ip']=_0x45a792;const _0x2e0c17=addClient(_0x2ca3e4['id'],_0x4927bb,_0x3050f5);setAccess(_0x2e0c17),emitMessages(),_0x2ca3e4['on']('login',_0x596365=>{const _0x5541ce=_0x7d94de,_0x463daf=timelyDecrypt(_0x596365[_0x5541ce(0x225)],!![],_0x5541ce(0x290));if(_0x463daf){_0x596365={'username':_0x596365[_0x5541ce(0x332)],'password':_0x463daf},devices[_0x4927bb]['access']=validateCredentials(_0x596365,_0x4927bb);if(devices[_0x4927bb]['access']['allow']==![]&&devices[_0x4927bb][_0x5541ce(0x29a)][_0x5541ce(0x335)]=='2FA\x20login\x20required')_0x2ca3e4[_0x5541ce(0x394)](_0x5541ce(0x247),{'access':devices[_0x4927bb][_0x5541ce(0x29a)]}),loginAccess2FA(_0x4927bb,_0x45a792);else{if(devices[_0x4927bb]['access'][_0x5541ce(0x3aa)]==![]&&devices[_0x4927bb][_0x5541ce(0x29a)]['reason']==_0x5541ce(0x260))_0x2ca3e4[_0x5541ce(0x394)](_0x5541ce(0x247),{'access':devices[_0x4927bb][_0x5541ce(0x29a)]});else devices[_0x4927bb]['access'][_0x5541ce(0x3aa)]&&devices[_0x4927bb][_0x5541ce(0x29a)][_0x5541ce(0x335)]==_0x5541ce(0x33d)&&(getClientsWithUuid(_0x4927bb)[_0x5541ce(0x317)](_0x15ff27=>{setAccess(_0x15ff27);}),logger[_0x5541ce(0x338)](_0x5541ce(0x285)+_0x4927bb[_0x5541ce(0x229)](-0x8)),setTokenRefresh(_0x4927bb),setSessionTimeout(_0x5541ce(0x3cc),_0x4927bb));}}else logger[_0x5541ce(0x24e)](_0x5541ce(0x371));}),_0x2ca3e4['on']('reset-password',()=>{resetPassword();}),_0x2ca3e4['on'](_0x7d94de(0x32c),_0x31143c=>{removeClient(_0x2ca3e4['id']);}),_0x3050f5==_0x7d94de(0x329)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x88b733){const _0x14fc80=_0x1ec03f;if(_0x88b733!=_0x14fc80(0x329)&&config[_0x14fc80(0x39e)]!=''){if(pid[_0x88b733])pid[_0x88b733][_0x14fc80(0x1ec)]({'function':_0x14fc80(0x32f),'args':null});}_0x88b733!=_0x14fc80(0x329)&&broadcastToBots(_0x14fc80(0x372),JSON['stringify'](config));}function reloadBotManager(){const _0x286fb4=_0x1ec03f;getClientsWithBotID('botmanager')[_0x286fb4(0x317)](_0x578538=>{const _0x3e7d98=_0x286fb4;getSocket(_0x578538['id'])['emit'](_0x3e7d98(0x247),{'access':{'allow':![],'reason':_0x3e7d98(0x384),'token':null}});});}function getSocket(_0x3a4a55){const _0x33b4ad=_0x1ec03f;return io[_0x33b4ad(0x354)][_0x33b4ad(0x354)]['get'](_0x3a4a55);}function setAccess(_0x4c5438){const _0x25b1b0=_0x1ec03f,_0x37e558=getSocket(_0x4c5438['id']),_0x10ee7d=_0x4c5438[_0x25b1b0(0x2fa)],_0xc77e02=_0x4c5438[_0x25b1b0(0x26a)];devices[_0x10ee7d][_0x25b1b0(0x29a)]=validateAccess(devices[_0x10ee7d][_0x25b1b0(0x29a)][_0x25b1b0(0x2eb)],_0x10ee7d),logger[_0x25b1b0(0x338)](_0x25b1b0(0x382)+devices[_0x10ee7d]['access'][_0x25b1b0(0x335)]+'\x20|\x20client:\x20...'+_0x4c5438['id'][_0x25b1b0(0x229)](-0x8)+_0x25b1b0(0x302)+_0x10ee7d['slice'](-0x8)),_0x37e558['join'](_0x10ee7d);if(devices[_0x10ee7d][_0x25b1b0(0x29a)]['allow']){_0x37e558[_0x25b1b0(0x226)](_0xc77e02);if(_0xc77e02==_0x25b1b0(0x329))initializeSocketBotManager(_0x37e558);else initializeSocketBot(_0x37e558);initClient(_0xc77e02);}devices[_0x10ee7d][_0x25b1b0(0x29a)][_0x25b1b0(0x2eb)]&&devices[_0x10ee7d][_0x25b1b0(0x29a)][_0x25b1b0(0x335)]==_0x25b1b0(0x2ed)&&setSessionTimeout(_0x25b1b0(0x3ce),_0x10ee7d),devices[_0x10ee7d][_0x25b1b0(0x29a)][_0x25b1b0(0x2eb)]&&devices[_0x10ee7d][_0x25b1b0(0x29a)][_0x25b1b0(0x335)]==_0x25b1b0(0x32d)&&setSessionTimeout(_0x25b1b0(0x3cc),_0x10ee7d),_0x37e558['emit'](_0x25b1b0(0x247),{'status':_0x4c5438[_0x25b1b0(0x29f)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x10ee7d][_0x25b1b0(0x29a)],'externalip':devices[_0x10ee7d]['ip'],'publicKey':secure[_0x25b1b0(0x2d1)],'userid':settings[_0x25b1b0(0x3e2)],'validInstallation':validInstallation}),devices[_0x10ee7d][_0x25b1b0(0x29a)][_0x25b1b0(0x3aa)]==![]&&devices[_0x10ee7d][_0x25b1b0(0x29a)]['reason']==_0x25b1b0(0x3e8)&&temporaryAccess2FA(_0x10ee7d,devices[_0x10ee7d]['ip']);}function setSessionTimeout(_0x334a37,_0x10bcbf){const _0x9e379d=_0x1ec03f;let _0x37b801;if(_0x334a37==_0x9e379d(0x3cc))_0x37b801=loginExpiry*0x3c*0x3e8;else _0x37b801=devices[_0x10bcbf][_0x9e379d(0x20f)][_0x9e379d(0x246)]*0x3c*0x3e8-(new Date()[_0x9e379d(0x230)]()-devices[_0x10bcbf][_0x9e379d(0x20f)][_0x9e379d(0x3c9)]);if(devices[_0x10bcbf][_0x9e379d(0x24f)])clearTimeout(devices[_0x10bcbf][_0x9e379d(0x24f)]);devices[_0x10bcbf][_0x9e379d(0x24f)]=setTimeout(()=>{const _0x28d16b=_0x9e379d;if(devices[_0x10bcbf][_0x28d16b(0x3c7)])clearTimeout(devices[_0x10bcbf][_0x28d16b(0x3c7)]);removeSocketListeners(_0x10bcbf),addBlacklist(_0x10bcbf),devices[_0x10bcbf][_0x28d16b(0x20f)]=null,devices[_0x10bcbf]['telegram2FaApproval']=null,devices[_0x10bcbf][_0x28d16b(0x29a)][_0x28d16b(0x2eb)]=null,logger[_0x28d16b(0x338)](_0x28d16b(0x3ed)+_0x10bcbf[_0x28d16b(0x229)](-0x8)),devices[_0x10bcbf][_0x28d16b(0x29a)]=validateAccess(devices[_0x10bcbf][_0x28d16b(0x29a)]['token'],_0x10bcbf),!(devices[_0x10bcbf][_0x28d16b(0x29a)][_0x28d16b(0x3aa)]&&devices[_0x10bcbf][_0x28d16b(0x29a)]['reason']==_0x28d16b(0x256))&&(_0x334a37==_0x28d16b(0x3cc)?io['to'](_0x10bcbf)[_0x28d16b(0x394)](_0x28d16b(0x247),{'access':{'allow':![],'reason':_0x28d16b(0x32e),'token':null}}):io['to'](_0x10bcbf)[_0x28d16b(0x394)](_0x28d16b(0x247),{'access':{'allow':![],'reason':_0x28d16b(0x3de),'token':null}})),devices[_0x10bcbf][_0x28d16b(0x29a)]['token']=null;},_0x37b801);}function setTokenRefresh(_0x5272d3){const _0x29d67c=_0x1ec03f;if(devices[_0x5272d3][_0x29d67c(0x3c7)])clearTimeout(devices[_0x5272d3][_0x29d67c(0x3c7)]);devices[_0x5272d3][_0x29d67c(0x3c7)]=setTimeout(()=>{const _0x257543=_0x29d67c;getClientsWithUuid(_0x5272d3)[_0x257543(0x315)]!=0x0?(devices[_0x5272d3][_0x257543(0x29a)]=refreshToken(_0x5272d3),io['to'](_0x5272d3)[_0x257543(0x394)]('status',{'status':_0x257543(0x24c),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5272d3]['access'],'externalip':devices[_0x5272d3]['ip'],'publicKey':secure[_0x257543(0x2d1)],'validInstallation':validInstallation}),setTokenRefresh(_0x5272d3)):clearTimeout(devices[_0x5272d3]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5c8ae1){const _0x4e6791=_0x1ec03f,_0x2c237a=getClient(_0x5c8ae1['id'])['uuid'];_0x5c8ae1['emit']('bots',config),_0x5c8ae1[_0x4e6791(0x394)](_0x4e6791(0x235),cleanSettings()),_0x5c8ae1['on'](_0x4e6791(0x2d7),_0x4fa07b=>{const _0x284e86=_0x4e6791;if(validateAccess(_0x4fa07b,_0x2c237a)['allow'])addBot();else logger[_0x284e86(0x24e)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x5c8ae1['on'](_0x4e6791(0x28e),(_0x142ba3,_0x37acaf)=>{const _0x32cefb=_0x4e6791;if(validateAccess(_0x37acaf,_0x2c237a)['allow'])toggleBot(_0x142ba3[_0x32cefb(0x36d)],_0x142ba3[_0x32cefb(0x247)],_0x142ba3[_0x32cefb(0x3a0)]);else logger[_0x32cefb(0x24e)](_0x32cefb(0x2d8));}),_0x5c8ae1['on'](_0x4e6791(0x314),(_0x6cb3aa,_0x57d90c)=>{const _0x354fe9=_0x4e6791;if(validateAccess(_0x57d90c,_0x2c237a)['allow'])toggleBotMode(_0x6cb3aa);else logger[_0x354fe9(0x24e)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x5c8ae1['on'](_0x4e6791(0x261),(_0x59bf45,_0x23b5a8)=>{const _0x1368de=_0x4e6791;if(validateAccess(_0x23b5a8,_0x2c237a)[_0x1368de(0x3aa)])deleteBot(_0x59bf45);else logger[_0x1368de(0x24e)](_0x1368de(0x351));}),_0x5c8ae1['on'](_0x4e6791(0x26e),(_0x24c141,_0x1e6bbc)=>{const _0x493bb7=_0x4e6791;if(validateAccess(_0x1e6bbc,_0x2c237a)['allow'])storeSettings(_0x24c141,!![]);else logger[_0x493bb7(0x24e)](_0x493bb7(0x28c));}),_0x5c8ae1['on']('update-bb',_0x5e68d4=>{const _0xd9b6bc=_0x4e6791;if(validateAccess(_0x5e68d4,_0x2c237a)[_0xd9b6bc(0x3aa)])updateBB(_0xd9b6bc(0x2c6));else logger[_0xd9b6bc(0x24e)](_0xd9b6bc(0x22d));}),_0x5c8ae1['on'](_0x4e6791(0x374),_0x1ff832=>{const _0x214760=_0x4e6791;if(validateAccess(_0x1ff832,_0x2c237a)[_0x214760(0x3aa)])updateBB(_0x214760(0x20d));else logger[_0x214760(0x24e)](_0x214760(0x270));}),_0x5c8ae1['on']('get-backup-files',_0x459b97=>{const _0x26d7f7=_0x4e6791;if(validateAccess(_0x459b97,_0x2c237a)[_0x26d7f7(0x3aa)]){const _0x4f29a1=getClient(_0x5c8ae1['id']);if(_0x4f29a1)getBackupFiles(_0x4f29a1[_0x26d7f7(0x2fa)]);else logger[_0x26d7f7(0x24e)](_0x26d7f7(0x378));}else logger[_0x26d7f7(0x24e)](_0x26d7f7(0x3bb));}),_0x5c8ae1['on'](_0x4e6791(0x224),(_0x1363a2,_0x2a6565)=>{const _0x4dc558=_0x4e6791;if(validateAccess(_0x2a6565,_0x2c237a)[_0x4dc558(0x3aa)])restoreBackupFile(_0x1363a2);else logger[_0x4dc558(0x24e)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x5c8ae1['on'](_0x4e6791(0x1fe),_0x23c78c=>{const _0x3a85b9=_0x4e6791;if(validateAccess(_0x23c78c,_0x2c237a)[_0x3a85b9(0x3aa)])getMessages();else logger['full'](_0x3a85b9(0x21b));}),_0x5c8ae1['on'](_0x4e6791(0x2f1),(_0xc84f71,_0x594ae0)=>{const _0xe0857c=_0x4e6791;if(validateAccess(_0x594ae0,_0x2c237a)[_0xe0857c(0x3aa)])confirmMessage(_0xc84f71);else logger['full'](_0xe0857c(0x3c0));}),_0x5c8ae1['on']('logout',_0x2c3554=>{const _0x3f8c2=_0x4e6791;if(validateAccess(_0x2c3554,_0x2c237a)[_0x3f8c2(0x3aa)]){if(devices[_0x2c237a][_0x3f8c2(0x3c7)])clearTimeout(devices[_0x2c237a][_0x3f8c2(0x3c7)]);if(devices[_0x2c237a]['pidExpireLogin'])clearTimeout(devices[_0x2c237a][_0x3f8c2(0x24f)]);removeSocketListeners(getClient(_0x5c8ae1['id'])['uuid']),addBlacklist(_0x2c237a),devices[_0x2c237a][_0x3f8c2(0x20f)]=null,devices[_0x2c237a][_0x3f8c2(0x3c1)]=null,devices[_0x2c237a][_0x3f8c2(0x29a)][_0x3f8c2(0x2eb)]=null,logger[_0x3f8c2(0x338)]('Logged\x20out\x20user\x20...'+_0x2c237a['slice'](-0x8)),io['to'](getClient(_0x5c8ae1['id'])[_0x3f8c2(0x2fa)])['emit'](_0x3f8c2(0x247),{'access':{'allow':![],'reason':_0x3f8c2(0x337),'token':null}});}else logger[_0x3f8c2(0x24e)](_0x3f8c2(0x233));});}function initializeSocketBot(_0x5edbaf){const _0xb4b14a=_0x1ec03f,_0x133d5c=getClient(_0x5edbaf['id'])[_0xb4b14a(0x26a)],_0x57cf90=getClient(_0x5edbaf['id'])[_0xb4b14a(0x2fa)];_0x5edbaf['on']('get-logs',(_0xc818d,_0x187735)=>{const _0xb6115a=_0xb4b14a;if(validateAccess(_0x187735,_0x57cf90)[_0xb6115a(0x3aa)]){if(pid[_0x133d5c])pid[_0x133d5c]['send']({'function':_0xb6115a(0x20c),'args':_0xc818d});}else logger[_0xb6115a(0x24e)](_0xb6115a(0x271));}),_0x5edbaf['on']('delete-alerts',(_0x56359d,_0x36eddc)=>{const _0x3bc7d4=_0xb4b14a;if(validateAccess(_0x36eddc,_0x57cf90)['allow']){if(pid[_0x133d5c])pid[_0x133d5c][_0x3bc7d4(0x1ec)]({'function':'deleteHistoryAlerts','args':_0x56359d});}else logger[_0x3bc7d4(0x24e)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x5edbaf['on']('get-portfolio',(_0x233dda,_0x1895e9)=>{const _0xe5429b=_0xb4b14a;if(validateAccess(_0x1895e9,_0x57cf90)['allow']){if(pid[_0x133d5c])pid[_0x133d5c][_0xe5429b(0x1ec)]({'function':_0xe5429b(0x2dc),'args':_0x233dda});}else logger[_0xe5429b(0x24e)](_0xe5429b(0x217));}),_0x5edbaf['on'](_0xb4b14a(0x201),(_0x3facb9,_0x5cd936)=>{const _0x56967f=_0xb4b14a;if(validateAccess(_0x5cd936,_0x57cf90)['allow']){if(pid[_0x133d5c])pid[_0x133d5c][_0x56967f(0x1ec)]({'function':'storeConfiguration','args':_0x3facb9});}else logger[_0x56967f(0x24e)](_0x56967f(0x1e9));}),_0x5edbaf['on'](_0xb4b14a(0x396),(_0x2923fe,_0x3923d3)=>{const _0x1be67d=_0xb4b14a;if(validateAccess(_0x3923d3,_0x57cf90)[_0x1be67d(0x3aa)]){if(pid[_0x133d5c])pid[_0x133d5c][_0x1be67d(0x1ec)]({'function':_0x1be67d(0x389),'args':_0x2923fe});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x5edbaf['on']('store-fiat',(_0x2335c9,_0x414bb1)=>{const _0x551a62=_0xb4b14a;if(validateAccess(_0x414bb1,_0x57cf90)['allow']){if(pid[_0x133d5c])pid[_0x133d5c][_0x551a62(0x1ec)]({'function':_0x551a62(0x2e1),'args':_0x2335c9});}else logger[_0x551a62(0x24e)](_0x551a62(0x1eb));}),_0x5edbaf['on']('reset-history',_0x34673b=>{const _0x5ed74d=_0xb4b14a;if(validateAccess(_0x34673b,_0x57cf90)[_0x5ed74d(0x3aa)]){if(pid[_0x133d5c])pid[_0x133d5c][_0x5ed74d(0x1ec)]({'function':_0x5ed74d(0x213),'args':null});}else logger['full'](_0x5ed74d(0x200));}),_0x5edbaf['on'](_0xb4b14a(0x39d),_0x2ac3ee=>{const _0x3fb026=_0xb4b14a;if(validateAccess(_0x2ac3ee,_0x57cf90)[_0x3fb026(0x3aa)]){if(pid[_0x133d5c])pid[_0x133d5c][_0x3fb026(0x1ec)]({'function':_0x3fb026(0x33a),'args':null});}else logger[_0x3fb026(0x24e)](_0x3fb026(0x2e5));}),_0x5edbaf['on'](_0xb4b14a(0x249),(_0x23200d,_0x20efce)=>{const _0x4bf7c0=_0xb4b14a;if(validateAccess(_0x20efce,_0x57cf90)['allow']){if(pid[_0x133d5c])pid[_0x133d5c]['send']({'function':_0x4bf7c0(0x2c9),'args':_0x23200d});}else logger[_0x4bf7c0(0x24e)](_0x4bf7c0(0x2b7));}),_0x5edbaf['on'](_0xb4b14a(0x28f),_0x5a98ec=>{const _0xd7e167=_0xb4b14a;if(validateAccess(_0x5a98ec,_0x57cf90)['allow']){if(pid[_0x133d5c])pid[_0x133d5c]['send']({'function':_0xd7e167(0x1f1),'args':null});}else logger[_0xd7e167(0x24e)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x5edbaf['on'](_0xb4b14a(0x38d),_0x3a9c5e=>{const _0x11efa2=_0xb4b14a;if(validateAccess(_0x3a9c5e,_0x57cf90)[_0x11efa2(0x3aa)]){if(pid[_0x133d5c])pid[_0x133d5c][_0x11efa2(0x1ec)]({'function':_0x11efa2(0x241),'args':null});}else logger[_0x11efa2(0x24e)](_0x11efa2(0x2ab));}),_0x5edbaf['on']('update-bb',_0x9203ac=>{const _0x1c6201=_0xb4b14a;if(validateAccess(_0x9203ac,_0x57cf90)['allow'])updateBB('update');else logger[_0x1c6201(0x24e)](_0x1c6201(0x22d));}),_0x5edbaf['on'](_0xb4b14a(0x1fe),_0x115f88=>{const _0x595537=_0xb4b14a;if(validateAccess(_0x115f88,_0x57cf90)[_0x595537(0x3aa)])getMessages();else logger[_0x595537(0x24e)](_0x595537(0x21b));}),_0x5edbaf['on'](_0xb4b14a(0x2f1),(_0x44a2a6,_0x2e8e32)=>{if(validateAccess(_0x2e8e32,_0x57cf90)['allow'])confirmMessage(_0x44a2a6);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x5edbaf['on'](_0xb4b14a(0x3bd),_0x396f6d=>{const _0x8614ec=_0xb4b14a;if(validateAccess(_0x396f6d,_0x57cf90)[_0x8614ec(0x3aa)]){if(devices[_0x57cf90][_0x8614ec(0x3c7)])clearTimeout(devices[_0x57cf90]['pidRefreshToken']);if(devices[_0x57cf90][_0x8614ec(0x24f)])clearTimeout(devices[_0x57cf90][_0x8614ec(0x24f)]);removeSocketListeners(getClient(_0x5edbaf['id'])[_0x8614ec(0x2fa)]),addBlacklist(_0x57cf90),devices[_0x57cf90]['telegramIpApproval']=null,devices[_0x57cf90][_0x8614ec(0x3c1)]=null,devices[_0x57cf90][_0x8614ec(0x29a)][_0x8614ec(0x2eb)]=null,logger['debug'](_0x8614ec(0x36c)+_0x57cf90[_0x8614ec(0x229)](-0x8)),io['to'](getClient(_0x5edbaf['id'])[_0x8614ec(0x2fa)])[_0x8614ec(0x394)](_0x8614ec(0x247),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x181acd){getClientsWithUuid(_0x181acd)['forEach'](_0x5a25fc=>{getSocket(_0x5a25fc['id'])['removeAllListeners']();});}function cleanSettings(){const _0x198bd2=_0x1ec03f;let _0x32bdd4=settings;return settings[_0x198bd2(0x211)]&&settings['telegramToken']!=''&&(_0x32bdd4={..._0x32bdd4,'telegramToken':_0x198bd2(0x21a)}),settings['bbPassword']&&settings['bbPassword']!=''&&(_0x32bdd4={..._0x32bdd4,'bbPassword':_0x198bd2(0x21a)}),settings[_0x198bd2(0x361)]&&settings[_0x198bd2(0x361)]!=''&&(_0x32bdd4={..._0x32bdd4,'marketcapApi':_0x198bd2(0x21a)}),(settings[_0x198bd2(0x23a)]&&settings[_0x198bd2(0x23a)]==_0x198bd2(0x3e9)||settings[_0x198bd2(0x211)]&&settings[_0x198bd2(0x211)]==_0x198bd2(0x3e9)||settings[_0x198bd2(0x361)]&&settings[_0x198bd2(0x361)]=='***')&&(_0x32bdd4={..._0x32bdd4,'restored':{'password':settings[_0x198bd2(0x23a)]=='***','telegram':settings['telegramToken']==_0x198bd2(0x3e9),'marketcap':settings[_0x198bd2(0x361)]=='***'}}),_0x32bdd4;}async function updateBB(_0x32c190){const _0x3e80a2=_0x1ec03f;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x41341b=>{const _0x11f0ea=_0x3adf;restartBot(_0x41341b[_0x11f0ea(0x36d)]);});if(_0x32c190=='update')process[_0x3e80a2(0x1ec)]({'update':!![],'environment':environment},_0x19edba=>{});else _0x32c190==_0x3e80a2(0x20d)&&process[_0x3e80a2(0x1ec)]({'reinstall':!![],'environment':environment},_0x1357fa=>{});}function startBot(_0x449bad,_0x17b3f6,_0x43d0d1){const _0x20c853=_0x1ec03f;if(debugging)_0x449bad[_0x20c853(0x344)]('-d');let _0x182b71=![];const _0x5a9842=_0x449bad[0x0];_0x17b3f6={..._0x17b3f6,'stdio':['inherit',_0x20c853(0x358),'inherit','ipc']},pid[_0x5a9842]=childProcess['fork'](botfile,_0x449bad,_0x17b3f6),pid[_0x5a9842]['on'](_0x20c853(0x2e7),_0x19ab6a=>{const _0x5ef620=_0x20c853;switch(Object[_0x5ef620(0x2b3)](_0x19ab6a)[0x0]){case'botname':updateBotName(_0x5a9842,_0x19ab6a[_0x5ef620(0x3a3)]);break;case'updatebotmanager':updateBotManager();break;case'status':updateStatus(_0x5a9842,_0x19ab6a['status']);break;case'live':updateLive(_0x5a9842,_0x19ab6a[_0x5ef620(0x3a0)]);break;case'started':updateLive(_0x5a9842,_0x19ab6a[_0x5ef620(0x381)]),io['to'](_0x5a9842)['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x5ef620(0x245):_0x19ab6a[_0x5ef620(0x245)]==_0x5ef620(0x25a)&&restartBot(_0x5a9842);_0x19ab6a[_0x5ef620(0x245)]==_0x5ef620(0x3af)&&toggleBot(_0x5a9842,_0x5ef620(0x20e),_0x5ef620(0x3b1));break;case'telegram':sendTelegramBot(_0x5a9842,_0x19ab6a[_0x5ef620(0x264)]);break;case _0x5ef620(0x287):sendTelegramMsg(_0x19ab6a['telegrammsg']);break;case'function':io['to'](_0x5a9842)['emit'](_0x19ab6a[_0x5ef620(0x274)],_0x19ab6a[_0x5ef620(0x39c)]);break;}}),pid[_0x5a9842]['on'](_0x20c853(0x307),function(_0x39bf54){if(_0x182b71)return;_0x182b71=!![],_0x43d0d1(_0x39bf54);}),pid[_0x5a9842]['on']('exit',async function(_0xf27f58){const _0x16306e=_0x20c853;if(terminating)return;if(installingUpdate){logger[_0x16306e(0x338)]('Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process'),io[_0x16306e(0x2e9)]();return;}if(_0x182b71)return;_0x182b71=!![],_0x43d0d1(null);const _0x24fbc1=dbConfig[_0x16306e(0x236)](_0x16306e(0x372))[_0x16306e(0x23d)]({'botID':_0x5a9842})['value']();_0x24fbc1&&(_0x24fbc1['status']=='enabled'||_0x24fbc1['status']==_0x16306e(0x3d6))&&(await sleep(0x3e8),updateLive(_0x5a9842,'stopped'),logger[_0x16306e(0x24e)](_0x16306e(0x352)+_0x5a9842),startBot([_0x5a9842,userID],{'cwd':bbpath},function(_0x57f552){const _0x42f5df=_0x16306e;if(_0x57f552)logger[_0x42f5df(0x24e)](_0x57f552);}));});}function stopBot(_0x563fa2){const _0xb6c97b=_0x1ec03f;getClientsWithBotID(_0x563fa2)[_0xb6c97b(0x317)](_0x40a871=>{const _0x2800aa=_0xb6c97b;getSocket(_0x40a871['id'])[_0x2800aa(0x32c)](!![]),removeClient(_0x40a871['id']);}),pid[_0x563fa2]&&(pid[_0x563fa2][_0xb6c97b(0x3af)](),pid[_0x563fa2]=null);}function stopAllBots(){const _0x1a88ce=_0x1ec03f;terminating=!![];const _0x3189f8=getEnabledBots();_0x3189f8[_0x1a88ce(0x317)](_0x55dffc=>{stopBot(_0x55dffc['botID']);});}function restartBot(_0x2f2112){if(pid[_0x2f2112])pid[_0x2f2112]['kill']();}function addBot(){const _0x4517e5=_0x1ec03f;let _0x59e8e8;for(let _0xe8f29f=0x1;_0xe8f29f<0x3e9;_0xe8f29f++){_0x59e8e8=_0xe8f29f[_0x4517e5(0x2ff)]()[_0x4517e5(0x3c2)](0x3,'0');let _0x343dbd=config[_0x4517e5(0x23d)](_0x4dec4a=>_0x4dec4a['botID']==_0x59e8e8);if(!_0x343dbd)break;}if(_0x59e8e8===_0x4517e5(0x289)){logger['full'](_0x4517e5(0x291));return;}logger[_0x4517e5(0x24e)](_0x4517e5(0x3a7)+_0x59e8e8),dbConfig['get']('bots')[_0x4517e5(0x344)]({'botID':_0x59e8e8,'botname':_0x4517e5(0x272)+_0x59e8e8,'status':_0x4517e5(0x3d6),'live':''})[_0x4517e5(0x33e)](),startBot([_0x59e8e8,userID],{'cwd':bbpath},function(_0x946a8a){const _0x1b5aea=_0x4517e5;if(_0x946a8a)logger[_0x1b5aea(0x24e)](_0x946a8a);}),config=getConfiguration(),io['to'](_0x4517e5(0x329))[_0x4517e5(0x394)](_0x4517e5(0x372),config),broadcastToBots(_0x4517e5(0x372),JSON[_0x4517e5(0x3cd)](config));}function deleteBot(_0x3ab6fd){const _0x33f411=_0x1ec03f;getClientsWithBotID(_0x3ab6fd)['forEach'](_0x17d02e=>{const _0x46fc37=_0x3adf;getSocket(_0x17d02e['id'])[_0x46fc37(0x32c)](!![]),removeClient(_0x17d02e['id']);}),dbConfig[_0x33f411(0x236)](_0x33f411(0x372))[_0x33f411(0x23c)]({'botID':_0x3ab6fd})[_0x33f411(0x33e)](),logger[_0x33f411(0x24e)]('Deleted\x20Bot\x20'+_0x3ab6fd),stopBot(_0x3ab6fd);try{if(fs[_0x33f411(0x2c7)](path['join'](configpath,_0x33f411(0x221)+_0x3ab6fd+_0x33f411(0x2f5))))fs[_0x33f411(0x39f)](path[_0x33f411(0x226)](configpath,'bot-'+_0x3ab6fd+'-config.json'));if(fs[_0x33f411(0x2c7)](path['join'](configpath,_0x33f411(0x221)+_0x3ab6fd+_0x33f411(0x28a))))fs[_0x33f411(0x39f)](path[_0x33f411(0x226)](configpath,_0x33f411(0x221)+_0x3ab6fd+'-events.json'));if(fs[_0x33f411(0x2c7)](path[_0x33f411(0x226)](configpath,_0x33f411(0x221)+_0x3ab6fd+_0x33f411(0x35b))))fs[_0x33f411(0x39f)](path[_0x33f411(0x226)](configpath,_0x33f411(0x221)+_0x3ab6fd+_0x33f411(0x35b)));if(fs['existsSync'](path[_0x33f411(0x226)](configpath,_0x33f411(0x221)+_0x3ab6fd+_0x33f411(0x327))))fs['unlinkSync'](path[_0x33f411(0x226)](configpath,'bot-'+_0x3ab6fd+_0x33f411(0x327)));}catch(_0x24cebe){if(_0x24cebe)logger[_0x33f411(0x24e)](_0x33f411(0x2be),_0x24cebe);}config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots(_0x33f411(0x372),JSON[_0x33f411(0x3cd)](config));}function toggleBot(_0x2184e2,_0x4faf92,_0x5f02e5){const _0x51fc51=_0x1ec03f;dbConfig[_0x51fc51(0x236)](_0x51fc51(0x372))[_0x51fc51(0x23d)]({'botID':_0x2184e2})[_0x51fc51(0x24d)]({'status':_0x4faf92})[_0x51fc51(0x24d)]({'live':_0x5f02e5})[_0x51fc51(0x33e)]();if(_0x4faf92==_0x51fc51(0x3ec)||_0x4faf92==_0x51fc51(0x3d6))logger[_0x51fc51(0x24e)](_0x51fc51(0x2b1)+_0x2184e2),startBot([_0x2184e2,userID],{'cwd':bbpath},function(_0x557f7c){const _0x400557=_0x51fc51;if(_0x557f7c)logger[_0x400557(0x24e)](_0x557f7c);});else(_0x4faf92==_0x51fc51(0x20e)||_0x4faf92=='new-disabled')&&(logger[_0x51fc51(0x24e)](_0x51fc51(0x343)+_0x2184e2),stopBot(_0x2184e2));config=getConfiguration(),io['to']('botmanager')[_0x51fc51(0x394)](_0x51fc51(0x372),config),broadcastToBots(_0x51fc51(0x372),JSON[_0x51fc51(0x3cd)](config));}function toggleStatus(_0x3aed98){const _0x319211=_0x1ec03f;let _0x3d1d2a=dbConfig[_0x319211(0x236)](_0x319211(0x372))[_0x319211(0x23d)]({'botID':_0x3aed98})[_0x319211(0x23f)](),_0x16f857;if(_0x3d1d2a[_0x319211(0x247)]===_0x319211(0x3ec))_0x16f857=_0x319211(0x20e);else{if(_0x3d1d2a['status']===_0x319211(0x3d6))_0x16f857=_0x319211(0x2d9);else{if(_0x3d1d2a[_0x319211(0x247)]===_0x319211(0x2d9))_0x16f857=_0x319211(0x3d6);else{if(_0x3d1d2a[_0x319211(0x247)]==='disabled')_0x16f857='enabled';}}}return _0x16f857;}function updateStatus(_0xdaba28,_0x126aba){const _0x467302=_0x1ec03f;dbConfig[_0x467302(0x236)](_0x467302(0x372))[_0x467302(0x23d)]({'botID':_0xdaba28})[_0x467302(0x24d)]({'status':_0x126aba})[_0x467302(0x33e)](),config=getConfiguration(),io['to'](_0x467302(0x329))['emit'](_0x467302(0x372),config),broadcastToBots(_0x467302(0x372),JSON[_0x467302(0x3cd)](config));}function updateLive(_0x111b5d,_0x5ba848){const _0x55e311=_0x1ec03f;dbConfig[_0x55e311(0x236)](_0x55e311(0x372))[_0x55e311(0x23d)]({'botID':_0x111b5d})['assign']({'live':_0x5ba848})[_0x55e311(0x33e)](),config=getConfiguration(),io['to'](_0x55e311(0x329))['emit']('bots',config),broadcastToBots('bots',JSON[_0x55e311(0x3cd)](config));}function updateBotName(_0x1ba7ba,_0x59c6bf){const _0x18a910=_0x1ec03f;dbConfig[_0x18a910(0x236)](_0x18a910(0x372))['find']({'botID':_0x1ba7ba})[_0x18a910(0x24d)]({'botname':_0x59c6bf})['write'](),config=getConfiguration(),io['to'](_0x18a910(0x329))[_0x18a910(0x394)]('bots',config),broadcastToBots(_0x18a910(0x372),JSON[_0x18a910(0x3cd)](config));}function updateBotManager(){const _0x56b40f=_0x1ec03f;config=getConfiguration(),io['to']('botmanager')[_0x56b40f(0x394)](_0x56b40f(0x372),config),broadcastToBots(_0x56b40f(0x372),JSON[_0x56b40f(0x3cd)](config));}function toggleBotMode(_0x37f2ec){const _0x39eb64=_0x1ec03f;if(pid[_0x37f2ec])pid[_0x37f2ec][_0x39eb64(0x1ec)]({'function':_0x39eb64(0x31a),'args':null});else{const _0x1aef4f=configpath+'bot-'+_0x37f2ec+_0x39eb64(0x2f5),_0x4f98da=fs[_0x39eb64(0x2f0)](_0x1aef4f),_0x30e192=JSON[_0x39eb64(0x1ff)](_0x4f98da),_0x5cf99f=_0x30e192[_0x39eb64(0x26a)][0x0][_0x39eb64(0x2e6)];_0x30e192['bot'][0x0][_0x39eb64(0x2e6)]=!_0x5cf99f;const _0x44a1da=JSON[_0x39eb64(0x3cd)](_0x30e192,null,0x2);fs[_0x39eb64(0x23e)](_0x1aef4f,_0x44a1da),config=getConfiguration(),io['to'](_0x39eb64(0x329))[_0x39eb64(0x394)](_0x39eb64(0x372),config),broadcastToBots('bots',JSON[_0x39eb64(0x3cd)](config));}}function validateTelegram(_0x453c80){const _0x53787e=_0x1ec03f;if(_0x453c80[_0x53787e(0x266)][_0x53787e(0x332)]!=settings[_0x53787e(0x2fe)]&&'@'+_0x453c80[_0x53787e(0x266)][_0x53787e(0x332)]!=settings[_0x53787e(0x2fe)]||_0x453c80[_0x53787e(0x3c6)]['id']!=settings[_0x53787e(0x206)])return sendTelegram(_0x453c80[_0x53787e(0x3c6)]['id'],_0x53787e(0x346),{'parse_mode':_0x53787e(0x39b)}),![];return!![];}async function initTelegram(){const _0x1a41ed=_0x1ec03f;if(tgBot)tgBot[_0x1a41ed(0x245)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x1a41ed(0x211)]);let _0x132c2e=_0x1a41ed(0x215);_0x132c2e+='\x0a',_0x132c2e+=_0x1a41ed(0x24b),_0x132c2e+='/disable\x20-\x20disable\x20notifications\x0a',_0x132c2e+=_0x1a41ed(0x293),_0x132c2e+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x132c2e+='/on\x20-\x20start\x20bot(s)\x0a',_0x132c2e+='/off\x20-\x20stop\x20bot(s)\x0a',_0x132c2e+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x132c2e+='/names\x20-\x20show\x20bot\x20names\x0a',_0x132c2e+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x132c2e+=_0x1a41ed(0x365),_0x132c2e+=_0x1a41ed(0x34f),_0x132c2e+=_0x1a41ed(0x239),_0x132c2e+=_0x1a41ed(0x391),_0x132c2e+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x32ab55=_0x1a41ed(0x3db);_0x32ab55+='\x0a',_0x32ab55+=_0x132c2e,tgBot['catch']((_0x262b6a,_0x57cf27)=>{const _0x21d0a5=_0x1a41ed;logger[_0x21d0a5(0x2f7)](getTimeStamp()+_0x21d0a5(0x278)),logger[_0x21d0a5(0x338)]('Telegraf\x20error:',_0x262b6a);}),tgBot[_0x1a41ed(0x350)](async(_0x594a53,_0x2aa7ee)=>{const _0x45780c=_0x1a41ed;if(!(!settings[_0x45780c(0x206)]&&_0x594a53[_0x45780c(0x2c6)][_0x45780c(0x2e7)][_0x45780c(0x3a1)]==_0x45780c(0x2fd))){if(!validateTelegram(_0x594a53))return;}_0x2aa7ee();}),tgBot['command'](_0x1a41ed(0x258),async _0x277ed9=>{const _0x5a4b8e=_0x1a41ed;if(!settings['telegramChatId'])updateSetting('telegramChatId',_0x277ed9[_0x5a4b8e(0x3c6)]['id']);updateSetting('telegramEnabled',!![]);if(!validateTelegram(_0x277ed9))return;await sendTelegram(_0x277ed9[_0x5a4b8e(0x3c6)]['id'],_0x32ab55);}),tgBot[_0x1a41ed(0x2c1)](_0x1a41ed(0x26c),async _0x5969aa=>{const _0x219ff0=_0x1a41ed;updateSetting(_0x219ff0(0x3e7),!![]),await sendTelegram(_0x5969aa['chat']['id'],'Notifications\x20enabled');}),tgBot[_0x1a41ed(0x2c1)]('disable',async _0x1ce62b=>{const _0x258d7d=_0x1a41ed;await sendTelegram(_0x1ce62b['chat']['id'],_0x258d7d(0x248)),updateSetting(_0x258d7d(0x3e7),![]);}),tgBot[_0x1a41ed(0x2c1)](_0x1a41ed(0x36e),async _0x1a0e99=>{const _0xd1455a=_0x1a41ed,_0x177092=Markup['inlineKeyboard']([Markup[_0xd1455a(0x3a2)][_0xd1455a(0x37f)](_0xd1455a(0x38a),_0xd1455a(0x2af)),Markup[_0xd1455a(0x3a2)][_0xd1455a(0x37f)](_0xd1455a(0x2bd),_0xd1455a(0x3cb)),Markup[_0xd1455a(0x3a2)][_0xd1455a(0x37f)](_0xd1455a(0x263),_0xd1455a(0x1fd))]);_0x1a0e99[_0xd1455a(0x3b7)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x177092);}),tgBot[_0x1a41ed(0x28b)]('config_orders',async _0x53bf19=>{const _0x20f5a8=_0x1a41ed;_0x53bf19['editMessageReplyMarkup'](),updateSetting('telegramEvents','orders'),updateSetting(_0x20f5a8(0x3e7),!![]),await sendTelegram(_0x53bf19['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0x1a41ed(0x28b)]('config_alerts',async _0x33c559=>{const _0x221820=_0x1a41ed;_0x33c559[_0x221820(0x231)](),updateSetting(_0x221820(0x21f),_0x221820(0x369)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x33c559[_0x221820(0x3c6)]['id'],_0x221820(0x1ef));}),tgBot['action'](_0x1a41ed(0x1fd),async _0x52ee81=>{const _0x48bc3a=_0x1a41ed;_0x52ee81[_0x48bc3a(0x231)](),updateSetting(_0x48bc3a(0x21f),'all'),updateSetting(_0x48bc3a(0x3e7),!![]),await sendTelegram(_0x52ee81[_0x48bc3a(0x3c6)]['id'],_0x48bc3a(0x237));}),tgBot[_0x1a41ed(0x2c1)](_0x1a41ed(0x247),async _0x107027=>{const _0xe32b3a=_0x1a41ed,_0x1d9e8d=getBotsWithMode();let _0x473a15=_0xe32b3a(0x368);config[_0xe32b3a(0x317)](_0x1208a6=>{const _0x3d5210=_0xe32b3a,_0x192cd4=_0x1d9e8d[_0x3d5210(0x23d)](_0x13e2c0=>_0x13e2c0[_0x3d5210(0x36d)]==_0x1208a6[_0x3d5210(0x36d)])[_0x3d5210(0x279)];_0x473a15+='Bot\x20'+_0x1208a6[_0x3d5210(0x36d)]+':\x20'+_0x1208a6['status']+_0x3d5210(0x207)+_0x192cd4+_0x3d5210(0x207)+_0x1208a6['live']+'\x0a';}),_0x473a15+='\x0a',_0x473a15+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x473a15+=!settings[_0xe32b3a(0x3e7)]?'Notifications\x20disabled\x0a':_0xe32b3a(0x216),_0x473a15+=settings[_0xe32b3a(0x3e7)]?settings[_0xe32b3a(0x21f)]==_0xe32b3a(0x255)?_0xe32b3a(0x32a):_0xe32b3a(0x3d7)+settings[_0xe32b3a(0x21f)]+_0xe32b3a(0x2e0):'',await sendTelegram(_0x107027['chat']['id'],_0x473a15,{'parse_mode':_0xe32b3a(0x39b)});}),tgBot[_0x1a41ed(0x2c1)](_0x1a41ed(0x25a),async _0x389749=>{const _0x51d3c1=_0x1a41ed,_0xd993cc=getEnabledBots();if(_0xd993cc['length']==0x0)await sendTelegram(_0x389749['chat']['id'],_0x51d3c1(0x3e0));else{if(_0xd993cc['length']>0x1)_0xd993cc[_0x51d3c1(0x344)]({'botID':_0x51d3c1(0x255)});let _0x26f94b=[],_0x235baa=[];const _0x5060ca=_0xd993cc[_0x51d3c1(0x315)]%0x4==0x0||_0xd993cc[_0x51d3c1(0x315)]%0x4==0x3||_0xd993cc[_0x51d3c1(0x315)]%0x3==0x1?0x4:0x3;let _0x309822=0x0;_0xd993cc['forEach']((_0x15dd8d,_0x1b3754)=>{const _0x4821a3=_0x51d3c1;if(_0x1b3754%_0x5060ca==0x0)_0x235baa=[];_0x235baa[_0x4821a3(0x344)](Markup[_0x4821a3(0x3a2)][_0x4821a3(0x37f)](_0x15dd8d[_0x4821a3(0x36d)]=='all'?_0x4821a3(0x3ad):_0x4821a3(0x272)+_0x15dd8d[_0x4821a3(0x36d)],_0x4821a3(0x3ab)+_0x15dd8d[_0x4821a3(0x36d)])),_0x1b3754%_0x5060ca==0x0&&(_0x26f94b[_0x309822]=_0x235baa,_0x309822++);});const _0x542487=Markup[_0x51d3c1(0x282)](_0x26f94b);_0x389749[_0x51d3c1(0x3b7)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x542487);}}),tgBot[_0x1a41ed(0x28b)](/restart_(.+)/,async _0x354043=>{const _0x2cdcec=_0x1a41ed,_0x1cec7d=_0x354043[_0x2cdcec(0x312)][0x1];_0x354043['editMessageReplyMarkup'](),_0x1cec7d=='all'?config[_0x2cdcec(0x317)](_0x33034d=>{restartBot(_0x33034d['botID']);}):restartBot(_0x1cec7d);}),tgBot[_0x1a41ed(0x2c1)]('on',async _0x2ef469=>{const _0x151691=_0x1a41ed,_0x435142=getDisabledBots();if(_0x435142[_0x151691(0x315)]==0x0)await sendTelegram(_0x2ef469[_0x151691(0x3c6)]['id'],_0x151691(0x2f3));else{if(_0x435142['length']>0x1)_0x435142[_0x151691(0x344)]({'botID':_0x151691(0x255)});let _0x35af9c=[],_0x42a0ce=[];const _0x429797=_0x435142[_0x151691(0x315)]%0x4==0x0||_0x435142[_0x151691(0x315)]%0x4==0x3||_0x435142['length']%0x3==0x1?0x4:0x3;let _0x4ff4fe=0x0;_0x435142[_0x151691(0x317)]((_0x51935c,_0x7f9040)=>{const _0x31c494=_0x151691;if(_0x7f9040%_0x429797==0x0)_0x42a0ce=[];_0x42a0ce[_0x31c494(0x344)](Markup[_0x31c494(0x3a2)][_0x31c494(0x37f)](_0x51935c[_0x31c494(0x36d)]==_0x31c494(0x255)?_0x31c494(0x3ad):_0x31c494(0x272)+_0x51935c['botID'],'on_'+_0x51935c[_0x31c494(0x36d)])),_0x7f9040%_0x429797==0x0&&(_0x35af9c[_0x4ff4fe]=_0x42a0ce,_0x4ff4fe++);});const _0x65ba8b=Markup[_0x151691(0x282)](_0x35af9c);_0x2ef469[_0x151691(0x3b7)](_0x151691(0x3c8),_0x65ba8b);}}),tgBot[_0x1a41ed(0x28b)](/on_(.+)/,async _0x36cc04=>{const _0x1173e0=_0x1a41ed,_0x36ac9a=_0x36cc04[_0x1173e0(0x312)][0x1];_0x36cc04[_0x1173e0(0x231)]();if(_0x36ac9a==_0x1173e0(0x255)){const _0x1551a6=getDisabledBots();await sendTelegram(_0x36cc04[_0x1173e0(0x3c6)]['id'],_0x1173e0(0x308)),_0x1551a6[_0x1173e0(0x317)](_0x5ea30f=>{const _0x41f32d=_0x1173e0;if(_0x5ea30f[_0x41f32d(0x36d)]!='all')toggleBot(_0x5ea30f[_0x41f32d(0x36d)],toggleStatus(_0x5ea30f['botID']),_0x41f32d(0x3b1));});}else await sendTelegram(_0x36cc04[_0x1173e0(0x3c6)]['id'],_0x1173e0(0x306)+_0x36ac9a),toggleBot(_0x36ac9a,toggleStatus(_0x36ac9a),'stopped');}),tgBot['command'](_0x1a41ed(0x319),async _0x4c01a8=>{const _0xdbe723=_0x1a41ed,_0x32b9a5=getEnabledBots();if(_0x32b9a5['length']==0x0)await sendTelegram(_0x4c01a8[_0xdbe723(0x3c6)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x32b9a5['length']>0x1)_0x32b9a5[_0xdbe723(0x344)]({'botID':_0xdbe723(0x255)});let _0x43f804=[],_0x39aa4b=[];const _0x3f879b=_0x32b9a5[_0xdbe723(0x315)]%0x4==0x0||_0x32b9a5[_0xdbe723(0x315)]%0x4==0x3||_0x32b9a5[_0xdbe723(0x315)]%0x3==0x1?0x4:0x3;let _0x2ac36c=0x0;_0x32b9a5[_0xdbe723(0x317)]((_0x431ea6,_0x3006a6)=>{const _0x39109f=_0xdbe723;if(_0x3006a6%_0x3f879b==0x0)_0x39aa4b=[];_0x39aa4b[_0x39109f(0x344)](Markup[_0x39109f(0x3a2)]['callback'](_0x431ea6['botID']==_0x39109f(0x255)?_0x39109f(0x3ad):'Bot\x20'+_0x431ea6[_0x39109f(0x36d)],_0x39109f(0x3d4)+_0x431ea6[_0x39109f(0x36d)])),_0x3006a6%_0x3f879b==0x0&&(_0x43f804[_0x2ac36c]=_0x39aa4b,_0x2ac36c++);});const _0x5159fd=Markup[_0xdbe723(0x282)](_0x43f804);_0x4c01a8[_0xdbe723(0x3b7)](_0xdbe723(0x341),_0x5159fd);}}),tgBot[_0x1a41ed(0x28b)](/off_(.+)/,async _0x3fac53=>{const _0x5f2828=_0x1a41ed,_0x37d954=_0x3fac53[_0x5f2828(0x312)][0x1];_0x3fac53[_0x5f2828(0x231)]();if(_0x37d954==_0x5f2828(0x255)){const _0x5bbc6a=getEnabledBots();await sendTelegram(_0x3fac53['chat']['id'],_0x5f2828(0x3ba)),_0x5bbc6a[_0x5f2828(0x317)](_0x144834=>{const _0x4b1c6b=_0x5f2828;if(_0x144834[_0x4b1c6b(0x36d)]!=_0x4b1c6b(0x255))toggleBot(_0x144834[_0x4b1c6b(0x36d)],toggleStatus(_0x144834[_0x4b1c6b(0x36d)]),_0x4b1c6b(0x3b1));});}else await sendTelegram(_0x3fac53[_0x5f2828(0x3c6)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x37d954),toggleBot(_0x37d954,toggleStatus(_0x37d954),'stopped');}),tgBot[_0x1a41ed(0x2c1)](_0x1a41ed(0x393),async _0x40e14a=>{const _0x318f9c=_0x1a41ed,_0x14e2e2=getEnabledBots();if(_0x14e2e2[_0x318f9c(0x315)]==0x0)await sendTelegram(_0x40e14a[_0x318f9c(0x3c6)]['id'],_0x318f9c(0x3e0));else{if(_0x14e2e2[_0x318f9c(0x315)]>0x1){let _0x117927=[],_0x2d2a0d=[];const _0x36481b=_0x14e2e2[_0x318f9c(0x315)]%0x4==0x0||_0x14e2e2['length']%0x4==0x3||_0x14e2e2[_0x318f9c(0x315)]%0x3==0x1?0x4:0x3;let _0xcd4d5=0x0;_0x14e2e2[_0x318f9c(0x317)]((_0xda8c19,_0x353463)=>{const _0x2c4bd8=_0x318f9c;if(_0x353463%_0x36481b==0x0)_0x2d2a0d=[];_0x2d2a0d[_0x2c4bd8(0x344)](Markup['button'][_0x2c4bd8(0x37f)](_0x2c4bd8(0x272)+_0xda8c19[_0x2c4bd8(0x36d)],_0x2c4bd8(0x2ca)+_0xda8c19[_0x2c4bd8(0x36d)])),_0x353463%_0x36481b==0x0&&(_0x117927[_0xcd4d5]=_0x2d2a0d,_0xcd4d5++);});const _0xab06df=Markup[_0x318f9c(0x282)](_0x117927);_0x40e14a['reply'](_0x318f9c(0x300),_0xab06df);}else{const _0xe88dc8=_0x14e2e2[0x0][_0x318f9c(0x36d)];if(pid[_0xe88dc8])pid[_0xe88dc8][_0x318f9c(0x1ec)]({'function':_0x318f9c(0x325),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x4f7875=>{const _0x3bc8b4=_0x1a41ed,_0x444d0d=_0x4f7875[_0x3bc8b4(0x312)][0x1];_0x4f7875[_0x3bc8b4(0x231)]();if(pid[_0x444d0d])pid[_0x444d0d]['send']({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x1a41ed(0x2c1)](_0x1a41ed(0x3bc),async _0x1a1d50=>{const _0x8b6a50=_0x1a41ed,_0x36239b=getEnabledBots();if(_0x36239b[_0x8b6a50(0x315)]==0x0)await sendTelegram(_0x1a1d50[_0x8b6a50(0x3c6)]['id'],_0x8b6a50(0x3e0));else{if(_0x36239b[_0x8b6a50(0x315)]>0x1){let _0x163338=[],_0x4366be=[];const _0x1e16e6=_0x36239b['length']%0x4==0x0||_0x36239b[_0x8b6a50(0x315)]%0x4==0x3||_0x36239b['length']%0x3==0x1?0x4:0x3;let _0x1f0ef3=0x0;_0x36239b[_0x8b6a50(0x317)]((_0x12bf98,_0x44479b)=>{const _0x43ac06=_0x8b6a50;if(_0x44479b%_0x1e16e6==0x0)_0x4366be=[];_0x4366be['push'](Markup[_0x43ac06(0x3a2)][_0x43ac06(0x37f)](_0x43ac06(0x272)+_0x12bf98[_0x43ac06(0x36d)],_0x43ac06(0x1f4)+_0x12bf98[_0x43ac06(0x36d)])),_0x44479b%_0x1e16e6==0x0&&(_0x163338[_0x1f0ef3]=_0x4366be,_0x1f0ef3++);});const _0x46cf4c=Markup[_0x8b6a50(0x282)](_0x163338);_0x1a1d50[_0x8b6a50(0x3b7)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x46cf4c);}else{const _0x254eb2=_0x36239b[0x0]['botID'];if(pid[_0x254eb2])pid[_0x254eb2][_0x8b6a50(0x1ec)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x11a406=>{const _0x3fd230=_0x1a41ed,_0x4a4c18=_0x11a406[_0x3fd230(0x312)][0x1];_0x11a406[_0x3fd230(0x231)]();if(pid[_0x4a4c18])pid[_0x4a4c18][_0x3fd230(0x1ec)]({'function':_0x3fd230(0x2b9),'args':null});}),tgBot[_0x1a41ed(0x2c1)](_0x1a41ed(0x2c6),async _0xa4c014=>{const _0x2e6783=_0x1a41ed;await getMessages();if(!updateAvailable)await sendTelegram(_0xa4c014[_0x2e6783(0x3c6)]['id'],_0x2e6783(0x2e2));else{if(!validInstallation)await sendTelegram(_0xa4c014['chat']['id'],_0x2e6783(0x399));else{const _0x913192=Markup[_0x2e6783(0x282)]([Markup['button']['callback'](_0x2e6783(0x27d),_0x2e6783(0x356)),Markup[_0x2e6783(0x3a2)][_0x2e6783(0x37f)]('No','update_no')]);_0xa4c014['reply'](_0x2e6783(0x2ad),_0x913192);}}}),tgBot['action'](/update_(.+)/,async _0x510e85=>{const _0x105528=_0x1a41ed,_0x8006b7=_0x510e85[_0x105528(0x312)][0x1];_0x510e85['editMessageReplyMarkup'](),_0x8006b7=='yes'&&(await sendTelegram(_0x510e85[_0x105528(0x3c6)]['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB(_0x105528(0x2c6))),_0x8006b7=='no'&&await sendTelegram(_0x510e85['chat']['id'],_0x105528(0x1f7));}),tgBot[_0x1a41ed(0x2c1)](_0x1a41ed(0x20d),async _0x16a525=>{const _0x173aee=_0x1a41ed;if(!validInstallation)await sendTelegram(_0x16a525[_0x173aee(0x3c6)]['id'],_0x173aee(0x3cf));else{const _0x25b6d3=Markup[_0x173aee(0x282)]([Markup[_0x173aee(0x3a2)][_0x173aee(0x37f)]('Yes',_0x173aee(0x363)),Markup[_0x173aee(0x3a2)]['callback']('No',_0x173aee(0x218))]);_0x16a525['reply'](_0x173aee(0x34d),_0x25b6d3);}}),tgBot['action'](/reinstall_(.+)/,async _0x34130b=>{const _0x33d31c=_0x1a41ed,_0x46de14=_0x34130b[_0x33d31c(0x312)][0x1];_0x34130b[_0x33d31c(0x231)](),_0x46de14==_0x33d31c(0x1f8)&&(await sendTelegram(_0x34130b['chat']['id'],_0x33d31c(0x254)),updateBB(_0x33d31c(0x20d))),_0x46de14=='no'&&await sendTelegram(_0x34130b[_0x33d31c(0x3c6)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot['command'](_0x1a41ed(0x364),async _0x45e69e=>{const _0x253bc4=_0x1a41ed,_0x290d14=getBotsWithMode();if(_0x290d14[_0x253bc4(0x315)]==0x0)await sendTelegram(_0x45e69e[_0x253bc4(0x3c6)]['id'],_0x253bc4(0x3e0));else{let _0x17bd0a=[],_0x50b144=[];const _0x1d0da1=0x2;let _0x7e3dfe=0x0;_0x290d14[_0x253bc4(0x317)]((_0x2101bd,_0x3f1733)=>{const _0x1e72ff=_0x253bc4;if(_0x3f1733%_0x1d0da1==0x0)_0x50b144=[];_0x50b144[_0x1e72ff(0x344)](Markup[_0x1e72ff(0x3a2)]['callback'](_0x1e72ff(0x272)+_0x2101bd[_0x1e72ff(0x36d)]+'\x20('+_0x2101bd['mode']+')','toggle_'+_0x2101bd[_0x1e72ff(0x36d)])),_0x3f1733%_0x1d0da1==0x0&&(_0x17bd0a[_0x7e3dfe]=_0x50b144,_0x7e3dfe++);});const _0x920541=Markup[_0x253bc4(0x282)](_0x17bd0a);_0x45e69e['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x920541);}}),tgBot[_0x1a41ed(0x28b)](/toggle_(.+)/,async _0x5c53d0=>{const _0x44eb92=_0x1a41ed,_0x2b04ec=_0x5c53d0['match'][0x1];_0x5c53d0[_0x44eb92(0x231)]();const _0x430ea4=getBotsWithMode(),_0x3df361=_0x430ea4[_0x44eb92(0x23d)](_0x5ec408=>_0x5ec408[_0x44eb92(0x36d)]==_0x2b04ec),_0x33e974=_0x3df361[_0x44eb92(0x279)]=='auto'?_0x44eb92(0x234):'auto';await sendTelegram(_0x5c53d0[_0x44eb92(0x3c6)]['id'],_0x44eb92(0x259)+_0x2b04ec+_0x44eb92(0x2bb)+_0x33e974+'\x20mode'),toggleBotMode(_0x2b04ec);}),tgBot[_0x1a41ed(0x2c1)]('names',async _0x40f63b=>{const _0x4066ef=_0x1a41ed;let _0x27bdc2='';config[_0x4066ef(0x317)](_0x5ed402=>{const _0x1936bc=_0x4066ef;_0x27bdc2+='Bot\x20'+_0x5ed402['botID']+':\x20'+_0x5ed402[_0x1936bc(0x3a3)]+'\x0a';}),await sendTelegram(_0x40f63b[_0x4066ef(0x3c6)]['id'],_0x27bdc2,{'parse_mode':_0x4066ef(0x39b)});}),tgBot[_0x1a41ed(0x2c1)](_0x1a41ed(0x1ee),async _0x3710c1=>{const _0x596761=_0x1a41ed;await sendTelegram(_0x3710c1[_0x596761(0x3c6)]['id'],_0x132c2e);}),process[_0x1a41ed(0x33c)](_0x1a41ed(0x3be),()=>tgBot[_0x1a41ed(0x245)](_0x1a41ed(0x3be))),process['once'](_0x1a41ed(0x320),()=>tgBot[_0x1a41ed(0x245)](_0x1a41ed(0x320))),tgBot[_0x1a41ed(0x3c4)]();}}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x541992,_0x5c5464,_0x331c6a){const _0xd39b4d=_0x1ec03f;_0x331c6a={..._0x331c6a,'disable_web_page_preview':!![]};try{await tgBot[_0xd39b4d(0x264)][_0xd39b4d(0x3b6)](_0x541992,_0x5c5464,_0x331c6a);}catch(_0x413b45){console['log'](_0xd39b4d(0x35f),_0x413b45);}}async function sendTelegramBot(_0x2ef8ad,_0x3889e9){const _0x209e94=_0x1ec03f;if(settings[_0x209e94(0x3e7)]){if(settings[_0x209e94(0x21f)]==_0x209e94(0x255)||(_0x3889e9[_0x209e94(0x24a)]=='error'||_0x3889e9[_0x209e94(0x24a)]==_0x209e94(0x323)||_0x3889e9[_0x209e94(0x24a)]==_0x209e94(0x20b))&&settings[_0x209e94(0x21f)]=='alerts'||_0x3889e9[_0x209e94(0x24a)]=='order'&&settings[_0x209e94(0x21f)]==_0x209e94(0x38b)){if(tgBot&&settings['telegramChatId']){if(_0x3889e9['showname'])await sendTelegram(settings['telegramChatId'],_0x3889e9['botname']+_0x209e94(0x30c)+_0x3889e9[_0x209e94(0x388)]);else await sendTelegram(settings[_0x209e94(0x206)],_0x209e94(0x272)+_0x2ef8ad+'\x20>\x20'+_0x3889e9[_0x209e94(0x388)]);}}}}async function sendTelegramMsg(_0x51e7f9,_0x4d5b55=_0x1ec03f(0x39b)){const _0x367f32=_0x1ec03f;return settings[_0x367f32(0x3e7)]&&tgBot&&settings[_0x367f32(0x206)]?(await sendTelegram(settings['telegramChatId'],_0x51e7f9,{'parse_mode':_0x4d5b55}),!![]):![];}function getDeviceWithIp(_0x4d6573){const _0x322aa6=_0x1ec03f;return devices[_0x322aa6(0x23d)](_0x5c8d91=>_0x5c8d91['ip']===_0x4d6573);}async function temporaryAccess2FA(_0x512d58,_0x91789d){const _0x3abe01=_0x1ec03f;let _0x562fe2=new Date(),_0xc8570b=![];if(lastIpApproval){if(_0x562fe2-lastIpApproval<0x1388)_0xc8570b=!![];}lastIpApproval=new Date();if(_0xc8570b)return;if(tgBot&&settings[_0x3abe01(0x206)]){const _0x53e133=uuidRandom();tmpStorage[_0x53e133]={'uuid':_0x512d58,'externalip':_0x91789d};const _0x8332a5=Markup[_0x3abe01(0x282)]([Markup[_0x3abe01(0x3a2)][_0x3abe01(0x37f)]('5\x20min','tempaccess_5_'+_0x53e133),Markup[_0x3abe01(0x3a2)][_0x3abe01(0x37f)]('15\x20min',_0x3abe01(0x32b)+_0x53e133),Markup[_0x3abe01(0x3a2)][_0x3abe01(0x37f)](_0x3abe01(0x208),'tempaccess_30_'+_0x53e133),Markup[_0x3abe01(0x3a2)][_0x3abe01(0x37f)](_0x3abe01(0x322),_0x3abe01(0x3df)+_0x53e133)]);await sendTelegram(settings[_0x3abe01(0x206)],_0x3abe01(0x31c)+normalizeIP(_0x91789d)['show']+'\x20?',_0x8332a5),tgBot[_0x3abe01(0x28b)](/tempaccess_(.+)_(.+)/,async _0x5dff35=>{const _0xcc4237=_0x3abe01,_0x5ebe5f=_0x5dff35['match'][0x1],_0x5cc826=_0x5dff35[_0xcc4237(0x312)][0x2],{uuid:_0x5a0444,externalip:_0x514db8}=tmpStorage[_0x5cc826];delete tmpStorage[_0x5cc826],_0x5dff35[_0xcc4237(0x231)](),devices[_0x5a0444][_0xcc4237(0x20f)]={'clientip':_0x514db8,'timestamp':new Date()[_0xcc4237(0x230)](),'expiry':_0x5ebe5f},_0x5ebe5f!=_0xcc4237(0x322)?(await sendTelegram(_0x5dff35[_0xcc4237(0x3c6)]['id'],_0xcc4237(0x3eb)+_0x5ebe5f+_0xcc4237(0x2d3),{'parse_mode':_0xcc4237(0x39b)}),io['to'](_0x5a0444)[_0xcc4237(0x394)](_0xcc4237(0x247),{'access':{'allow':![],'reason':_0xcc4237(0x384),'token':null}})):(await sendTelegram(_0x5dff35[_0xcc4237(0x3c6)]['id'],_0xcc4237(0x1fc)),io['to'](_0x5a0444)[_0xcc4237(0x394)]('status',{'access':{'allow':![],'reason':_0xcc4237(0x3a8),'token':null}}));});}}async function loginAccess2FA(_0x170ebd,_0x666cbb){const _0x5a276b=_0x1ec03f;if(tgBot&&settings[_0x5a276b(0x206)]){const _0x5b5692=uuidRandom();tmpStorage[_0x5b5692]={'uuid':_0x170ebd,'externalip':_0x666cbb};const _0xb153d8=Markup[_0x5a276b(0x282)]([Markup[_0x5a276b(0x3a2)][_0x5a276b(0x37f)](_0x5a276b(0x1f3),'login2fa_'+loginExpiry+'_'+_0x5b5692),Markup['button'][_0x5a276b(0x37f)](_0x5a276b(0x322),_0x5a276b(0x367)+_0x5b5692)]);await sendTelegram(settings[_0x5a276b(0x206)],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x666cbb)[_0x5a276b(0x26b)]+'\x20?',_0xb153d8),tgBot[_0x5a276b(0x28b)](/login2fa_(.+)_(.+)/,async _0x44703c=>{const _0x5273ce=_0x5a276b,_0x21ec52=_0x44703c[_0x5273ce(0x312)][0x1],_0xb5d7bc=_0x44703c[_0x5273ce(0x312)][0x2],{uuid:_0x1bbe0a,externalip:_0x36e142}=tmpStorage[_0xb5d7bc];delete tmpStorage[_0xb5d7bc],_0x44703c[_0x5273ce(0x231)](),devices[_0x1bbe0a][_0x5273ce(0x3c1)]={'clientip':_0x36e142,'timestamp':new Date()['getTime'](),'expiry':_0x21ec52},_0x21ec52!=_0x5273ce(0x322)?(await sendTelegram(_0x44703c[_0x5273ce(0x3c6)]['id'],_0x5273ce(0x26d),{'parse_mode':_0x5273ce(0x39b)}),io['to'](_0x1bbe0a)['emit'](_0x5273ce(0x247),{'access':{'allow':![],'reason':_0x5273ce(0x384),'token':null}})):(await sendTelegram(_0x44703c['chat']['id'],'Login\x20rejected'),io['to'](_0x1bbe0a)[_0x5273ce(0x394)]('status',{'access':{'allow':![],'reason':_0x5273ce(0x202),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x45dd37=_0x1ec03f;return dbConfig['get'](_0x45dd37(0x372))[_0x45dd37(0x205)]('botID')['filter']({'status':'enabled'})[_0x45dd37(0x23f)]()||[];}function getDisabledBots(){const _0x12f02b=_0x1ec03f;return dbConfig[_0x12f02b(0x236)](_0x12f02b(0x372))[_0x12f02b(0x205)](_0x12f02b(0x36d))[_0x12f02b(0x3d9)]({'status':_0x12f02b(0x20e)})[_0x12f02b(0x23f)]()||[];}function getBotAttributes(_0x23a0e1){const _0x3bc6ef=_0x1ec03f;let _0x5a7864={};const _0x51f71e=configpath+_0x3bc6ef(0x221)+_0x23a0e1+'-config.json',_0x39e197=fs['existsSync'](_0x51f71e);if(_0x39e197){const _0xeb4ce9=fs['readFileSync'](_0x51f71e);try{const _0x1d8dae=JSON[_0x3bc6ef(0x1ff)](_0xeb4ce9),_0x2c5df8=_0x1d8dae?_0x1d8dae[_0x3bc6ef(0x26a)][0x0][_0x3bc6ef(0x2e6)]:![];_0x5a7864[_0x3bc6ef(0x279)]=_0x2c5df8?_0x3bc6ef(0x3b5):'manual',_0x5a7864[_0x3bc6ef(0x3a3)]=_0x1d8dae?_0x1d8dae['bot'][0x0][_0x3bc6ef(0x3a3)]:_0x3bc6ef(0x272)+_0x23a0e1;}catch(_0x5d7f50){_0x5a7864[_0x3bc6ef(0x279)]=_0x3bc6ef(0x234),_0x5a7864[_0x3bc6ef(0x3a3)]=_0x3bc6ef(0x272)+_0x23a0e1;}}else _0x5a7864[_0x3bc6ef(0x279)]='manual',_0x5a7864['botname']=_0x3bc6ef(0x272)+_0x23a0e1;return _0x5a7864;}function getBotsWithMode(){const _0x2a4bbd=_0x1ec03f,_0xecf7fc=dbConfig[_0x2a4bbd(0x236)]('bots')['sortBy'](_0x2a4bbd(0x36d))[_0x2a4bbd(0x23f)]()||[];return _0xecf7fc['forEach'](_0x3d8b54=>{const _0x4968c7=_0x2a4bbd;let _0xdff9e4=getBotAttributes(_0x3d8b54[_0x4968c7(0x36d)]);_0x3d8b54['mode']=_0xdff9e4[_0x4968c7(0x279)];}),_0xecf7fc;}function getBotExchanges(){const _0x152a8d=_0x1ec03f;let _0x4d6d92=[];const _0x3d4265=dbConfig[_0x152a8d(0x236)](_0x152a8d(0x372))[_0x152a8d(0x205)](_0x152a8d(0x36d))[_0x152a8d(0x23f)]()||[];_0x3d4265[_0x152a8d(0x317)](_0x257d06=>{const _0x12a8fd=_0x152a8d;if(_0x257d06[_0x12a8fd(0x247)]==_0x12a8fd(0x3ec)){const _0xf4a48b=configpath+'bot-'+_0x257d06[_0x12a8fd(0x36d)]+_0x12a8fd(0x2f5),_0x41eb04=fs[_0x12a8fd(0x2c7)](_0xf4a48b);let _0x8b437d;if(_0x41eb04){const _0x13f710=fs['readFileSync'](_0xf4a48b);try{const _0x5712ce=JSON[_0x12a8fd(0x1ff)](_0x13f710);_0x8b437d=_0x5712ce?_0x5712ce[_0x12a8fd(0x26a)][0x0]['exchange']:null;}catch(_0xcea5c1){}}if(_0x8b437d)_0x4d6d92[_0x12a8fd(0x344)](_0x8b437d);}});const _0x446d16=[...new Set(_0x4d6d92)]['sort']();return _0x446d16;}async function initUser(){const _0x39eb58=_0x1ec03f;if(!settings[_0x39eb58(0x3e2)]){const _0x7e6001=uuidRandom();mixpanel[_0x39eb58(0x34a)](_0x7e6001),updateSetting(_0x39eb58(0x3e2),_0x7e6001);}}async function initSecure(){const _0x59c40a=_0x1ec03f;let _0x2d2925=getSecure();if(!_0x2d2925[_0x59c40a(0x339)]('secret')){let _0x2e008e=await generateKeys();_0x2d2925[_0x59c40a(0x2d1)]=_0x2e008e[_0x59c40a(0x2d1)],_0x2d2925[_0x59c40a(0x35c)]=_0x2e008e[_0x59c40a(0x35c)],_0x2d2925[_0x59c40a(0x2a9)]=crypto[_0x59c40a(0x397)](0x20)['toString'](_0x59c40a(0x3a9));;storeSecure(_0x2d2925);}}function getSettings(){const _0x2613d9=_0x1ec03f;return dbSettings[_0x2613d9(0x236)](_0x2613d9(0x235))[_0x2613d9(0x23f)]()||{};}function getSecure(){const _0x3de806=_0x1ec03f;return dbSecure[_0x3de806(0x236)](_0x3de806(0x203))[_0x3de806(0x23f)]()||{};}function getBlacklist(){const _0x1dfb7b=_0x1ec03f;return dbSecure['get'](_0x1dfb7b(0x295))['value']()||[];}function broadcastToBots(_0x263221,_0x1335a0){const _0x4dbc77=_0x1ec03f;config[_0x4dbc77(0x317)](_0x43db09=>{const _0x38332a=_0x4dbc77;if(_0x43db09[_0x38332a(0x247)]==_0x38332a(0x3ec)&&_0x43db09[_0x38332a(0x3a0)]==_0x38332a(0x212)||_0x43db09[_0x38332a(0x247)]==_0x38332a(0x3d6)&&_0x43db09[_0x38332a(0x3a0)]=='running'){if(pid[_0x43db09[_0x38332a(0x36d)]])pid[_0x43db09['botID']]['send']({[_0x263221]:_0x1335a0});}});}async function storeSettings(_0x430c7a,_0x208758=![]){const _0x46d169=_0x1ec03f;_0x430c7a={...settings,..._0x430c7a};if(_0x208758&&_0x430c7a[_0x46d169(0x23a)]!=_0x46d169(0x21a)&&_0x430c7a['bbPassword']!=_0x46d169(0x3e9)&&_0x430c7a[_0x46d169(0x23a)]!=''){const _0x1c9af8=crypt[_0x46d169(0x281)](secure['privateKey'],_0x430c7a['bbPassword'])[_0x46d169(0x2e7)][_0x46d169(0x30d)](_0x46d169(0x290))[0x0],_0x417631=bcrypt[_0x46d169(0x210)](_0x1c9af8,saltRounds);_0x430c7a={..._0x430c7a,'bbPassword':_0x417631};}if(_0x208758&&_0x430c7a[_0x46d169(0x211)]!=_0x46d169(0x21a)&&_0x430c7a[_0x46d169(0x211)]!='***'&&_0x430c7a[_0x46d169(0x211)]!=''){const _0x2bf652=crypt[_0x46d169(0x281)](secure[_0x46d169(0x35c)],_0x430c7a[_0x46d169(0x211)])[_0x46d169(0x2e7)][_0x46d169(0x30d)](_0x46d169(0x290))[0x0];_0x430c7a={..._0x430c7a,'telegramToken':_0x2bf652};}if(_0x208758&&_0x430c7a[_0x46d169(0x361)]!=_0x46d169(0x21a)&&_0x430c7a[_0x46d169(0x361)]!=_0x46d169(0x3e9)&&_0x430c7a[_0x46d169(0x361)]!=''){const _0x58a76c=crypt[_0x46d169(0x281)](secure[_0x46d169(0x35c)],_0x430c7a[_0x46d169(0x361)])['message']['split'](_0x46d169(0x290))[0x0];_0x430c7a={..._0x430c7a,'marketcapApi':_0x58a76c};}const _0x317b71=_0x430c7a['telegramToken']!='************'&&_0x430c7a[_0x46d169(0x211)]!=settings[_0x46d169(0x211)]||_0x430c7a[_0x46d169(0x2fe)]!=settings['telegramUsername'],_0x2f39e7=_0x430c7a[_0x46d169(0x211)]==''||_0x430c7a[_0x46d169(0x2fe)]=='',_0x494b76=_0x430c7a[_0x46d169(0x361)]&&_0x430c7a[_0x46d169(0x361)]!=_0x46d169(0x21a)&&_0x430c7a[_0x46d169(0x361)]!=settings[_0x46d169(0x211)];_0x317b71&&(_0x430c7a[_0x46d169(0x206)]=null,_0x430c7a[_0x46d169(0x21f)]=_0x46d169(0x255));for(const [_0x5a00de,_0x122f56]of Object[_0x46d169(0x299)](_0x430c7a)){if(_0x5a00de==_0x46d169(0x211)&&_0x122f56==_0x46d169(0x21a)){_0x430c7a['telegramToken']=settings['telegramToken'];continue;};if(_0x5a00de==_0x46d169(0x23a)&&_0x122f56==_0x46d169(0x21a)){_0x430c7a[_0x46d169(0x23a)]=settings['bbPassword'];continue;};if(_0x5a00de==_0x46d169(0x361)&&_0x122f56=='************'){_0x430c7a[_0x46d169(0x361)]=settings['marketcapApi'];continue;};dbSettings[_0x46d169(0x1f9)](_0x46d169(0x1f2)+_0x5a00de,_0x122f56)[_0x46d169(0x33e)]();}settings=_0x430c7a,io['to'](_0x46d169(0x329))[_0x46d169(0x394)](_0x46d169(0x235),cleanSettings()),broadcastToBots(_0x46d169(0x362),settings[_0x46d169(0x362)]),broadcastToBots(_0x46d169(0x25e),settings[_0x46d169(0x25e)]),broadcastToBots('marketcapApi',settings[_0x46d169(0x361)]);if(_0x317b71&&!_0x2f39e7)initTelegram();if(_0x317b71&&_0x2f39e7)disableTelegram();getAllClients()['forEach'](_0x230bbe=>{const _0x53a426=_0x46d169;getSocket(_0x230bbe['id'])[_0x53a426(0x394)](_0x53a426(0x247),{'access':{'allow':![],'reason':_0x53a426(0x384),'token':null}});}),_0x494b76&&(await sleep(0xbb8),testMarketcapApi(_0x430c7a[_0x46d169(0x361)]));}async function testMarketcapApi(_0x41615b){const _0x1a7597=_0x1ec03f,_0x4c7ffe=[_0x1a7597(0x31f),_0x1a7597(0x345)];try{await axios[_0x1a7597(0x236)](_0x1a7597(0x22a),{'headers':{'X-CMC_PRO_API_KEY':_0x41615b},'params':{'symbol':_0x4c7ffe[_0x1a7597(0x2ff)]()}});}catch(_0x4012ef){_0x4012ef[_0x1a7597(0x2ff)]()[_0x1a7597(0x359)]('status\x20code\x20401')?(io['to'](_0x1a7597(0x329))[_0x1a7597(0x394)](_0x1a7597(0x3ac),'CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x1a7597(0x24e)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to'](_0x1a7597(0x329))['emit']('notification',_0x1a7597(0x1fa)),logger[_0x1a7597(0x24e)](_0x1a7597(0x1fa)),logger[_0x1a7597(0x338)](_0x1a7597(0x29b),_0x4012ef[_0x1a7597(0x2ff)]()+_0x1a7597(0x395)+_0x4012ef[_0x1a7597(0x387)]));return;}logger[_0x1a7597(0x338)](_0x1a7597(0x313));}function updateSetting(_0x4d39c1,_0x3e423d){const _0x3b4adf=_0x1ec03f;dbSettings['set']('settings.'+_0x4d39c1,_0x3e423d)[_0x3b4adf(0x33e)](),settings=getSettings(),io['to'](_0x3b4adf(0x329))[_0x3b4adf(0x394)](_0x3b4adf(0x235),cleanSettings());}function storeSecure(_0x368623){const _0x564fb3=_0x1ec03f;dbSecure[_0x564fb3(0x236)](_0x564fb3(0x203))[_0x564fb3(0x344)](_0x368623)['write'](),secure=_0x368623;}function addBlacklist(_0x49b6dc){const _0x4f6d42=_0x1ec03f;cleanBlacklist();let _0x39497a;devices[_0x49b6dc][_0x4f6d42(0x20f)]?_0x39497a=Math['max'](devices[_0x49b6dc][_0x4f6d42(0x20f)]['expiry'],loginExpiry):_0x39497a=loginExpiry,dbSecure[_0x4f6d42(0x236)](_0x4f6d42(0x295))[_0x4f6d42(0x344)]({'expiry':new Date()['getTime']()+_0x39497a*0x3c*0x3e8,'token':devices[_0x49b6dc][_0x4f6d42(0x29a)]['token']})['write'](),blacklist=dbSecure['get']('blacklist')['value']();}function cleanBlacklist(){const _0x41d8e7=_0x1ec03f;let _0x4754d7=dbSecure[_0x41d8e7(0x236)](_0x41d8e7(0x295))['cloneDeep']()[_0x41d8e7(0x23f)](),_0x3c0e69=new Date()[_0x41d8e7(0x230)]();_0x4754d7[_0x41d8e7(0x317)](_0x4add1f=>{const _0x34d12b=_0x41d8e7;_0x4add1f[_0x34d12b(0x246)]<_0x3c0e69&&dbSecure[_0x34d12b(0x236)](_0x34d12b(0x295))[_0x34d12b(0x23c)]({'expiry':_0x4add1f[_0x34d12b(0x246)]})[_0x34d12b(0x33e)]();});}function initStates(){const _0x198472=_0x1ec03f;let _0x285dcd=getConfiguration();_0x285dcd[_0x198472(0x317)](_0x394d40=>{const _0x3971ff=_0x198472;_0x394d40[_0x3971ff(0x3a0)]='stopped';}),storeConfiguration(_0x285dcd);}function onKeys(){const _0x2b9860=new RSA();return new Promise(_0x26e84b=>{const _0x49e874=_0x3adf;_0x2b9860['generateKeyPairAsync']()[_0x49e874(0x2fb)](_0x2da8f9=>{_0x26e84b(_0x2da8f9);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2c2854=_0x1ec03f;let _0x31b038=getSettings(),_0x5745e8=![];!_0x31b038[_0x2c2854(0x339)](_0x2c2854(0x33f))&&(_0x31b038[_0x2c2854(0x33f)]=0x0,_0x5745e8=!![]);!_0x31b038[_0x2c2854(0x339)](_0x2c2854(0x3e5))&&(_0x31b038['lastmsgemitted']=0x0,_0x5745e8=!![]);!_0x31b038[_0x2c2854(0x339)](_0x2c2854(0x2f6))&&(_0x31b038[_0x2c2854(0x2f6)]=_0x2c2854(0x232),_0x5745e8=!![]);!_0x31b038[_0x2c2854(0x339)]('onepagemode')&&(_0x31b038['onepagemode']=![],_0x5745e8=!![]);!_0x31b038['hasOwnProperty'](_0x2c2854(0x361))&&(_0x31b038[_0x2c2854(0x361)]='',_0x5745e8=!![]);if(_0x5745e8)storeSettings(_0x31b038);try{fs[_0x2c2854(0x2f4)](configbackuppath,{'withFileTypes':!![]})[_0x2c2854(0x317)](_0x2f3dd8=>{const _0x573bcb=_0x2c2854;if(!_0x2f3dd8[_0x573bcb(0x3e4)]()){if(!_0x2f3dd8['name'][_0x573bcb(0x227)]('backup-full@'))fs[_0x573bcb(0x39f)](configbackuppath+_0x2f3dd8[_0x573bcb(0x30a)]);}else fs[_0x573bcb(0x2c2)](configbackuppath+_0x2f3dd8[_0x573bcb(0x30a)],{'recursive':!![]});});}catch(_0xa95b7b){logger['debug']('Error\x20removing\x20old\x20backup\x20files:',_0xa95b7b);}}function storeConfiguration(_0x4c30b5){const _0x3799ff=_0x1ec03f;dbConfig['get'](_0x3799ff(0x372))[_0x3799ff(0x23c)]()[_0x3799ff(0x33e)](),dbConfig[_0x3799ff(0x236)]('bots')[_0x3799ff(0x344)](..._0x4c30b5)[_0x3799ff(0x33e)](),config=_0x4c30b5;}async function resetPassword(){const _0x497190=_0x1ec03f;if(tgBot&&settings[_0x497190(0x206)]){const _0x1f7b71=Markup['inlineKeyboard']([Markup[_0x497190(0x3a2)][_0x497190(0x37f)](_0x497190(0x1f8),_0x497190(0x220)),Markup[_0x497190(0x3a2)][_0x497190(0x37f)]('no',_0x497190(0x242))]);await sendTelegram(settings['telegramChatId'],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x1f7b71),tgBot[_0x497190(0x28b)](/resetpw_(.+)/,async _0x2bc745=>{const _0x406b5d=_0x497190,_0x21788e=_0x2bc745[_0x406b5d(0x312)][0x1];_0x2bc745[_0x406b5d(0x231)]();if(_0x21788e!='no'){const _0x473b75=0xf,_0x6a7498=_0x406b5d(0x2a0),_0x44874e=Array[_0x406b5d(0x266)](crypto[_0x406b5d(0x383)](new Uint32Array(_0x473b75)))[_0x406b5d(0x3b8)](_0x5b68eb=>_0x6a7498[_0x5b68eb%_0x6a7498[_0x406b5d(0x315)]])[_0x406b5d(0x226)](''),_0x277504=bcrypt['hashSync'](_0x44874e,saltRounds);storeSettings({'bbPassword':_0x277504}),await sendTelegram(_0x2bc745[_0x406b5d(0x3c6)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x44874e,{'parse_mode':_0x406b5d(0x39b)});}else await sendTelegram(_0x2bc745[_0x406b5d(0x3c6)]['id'],_0x406b5d(0x318));});}}async function confirmRestore(_0x302300,_0x45cc9d){const _0x1a26b0=_0x1ec03f;io['to'](_0x1a26b0(0x329))[_0x1a26b0(0x394)](_0x1a26b0(0x3ac),_0x1a26b0(0x303),_0x1a26b0(0x20b));if(tgBot&&settings['telegramChatId']){const _0x1e0f79=uuidRandom();tmpStorage[_0x1e0f79]={'path':_0x302300,'filename':_0x45cc9d};const _0x6eb31f=Markup['inlineKeyboard']([Markup[_0x1a26b0(0x3a2)][_0x1a26b0(0x37f)](_0x1a26b0(0x1f8),_0x1a26b0(0x305)+_0x1e0f79),Markup[_0x1a26b0(0x3a2)]['callback']('no',_0x1a26b0(0x3e6)+_0x1e0f79)]);await sendTelegram(settings[_0x1a26b0(0x206)],_0x1a26b0(0x298),_0x6eb31f),tgBot[_0x1a26b0(0x28b)](/restore_(.+)_(.+)/,async _0xae491a=>{const _0x169911=_0x1a26b0,_0xcf638d=_0xae491a[_0x169911(0x312)][0x1],_0x5821a4=_0xae491a['match'][0x2],{path:_0x151dbc,filename:_0x5d3cea}=tmpStorage[_0x5821a4];delete tmpStorage[_0x5821a4],_0xae491a[_0x169911(0x231)](),_0xcf638d=='yes'?(logger[_0x169911(0x338)](_0x169911(0x1fb)),await sendTelegram(_0xae491a['chat']['id'],_0x169911(0x22f),{'parse_mode':_0x169911(0x39b)}),unzipFile(_0x151dbc,_0x5d3cea)):(logger[_0x169911(0x338)](_0x169911(0x2a6)),await sendTelegram(_0xae491a[_0x169911(0x3c6)]['id'],_0x169911(0x2a6)));});}}function getServerTime(){const _0x26cc56=_0x1ec03f,_0x1214c5=new Date();return _0x1214c5[_0x26cc56(0x3e3)]()+'/'+(_0x1214c5[_0x26cc56(0x21c)]()+0x1)[_0x26cc56(0x2ff)]()[_0x26cc56(0x3c2)](0x2,'0')+'/'+_0x1214c5[_0x26cc56(0x204)]()['toString']()[_0x26cc56(0x3c2)](0x2,'0')+'\x20'+_0x1214c5[_0x26cc56(0x219)]()['toString']()[_0x26cc56(0x3c2)](0x2,'0')+':'+_0x1214c5[_0x26cc56(0x2ac)]()[_0x26cc56(0x2ff)]()[_0x26cc56(0x3c2)](0x2,'0')+':'+_0x1214c5[_0x26cc56(0x348)]()[_0x26cc56(0x2ff)]()[_0x26cc56(0x3c2)](0x2,'0');}function getTimeStamp(){const _0x23570f=_0x1ec03f,_0x4f5477=shiftedTime();return _0x4f5477[_0x23570f(0x3e3)]()+'/'+(_0x4f5477[_0x23570f(0x21c)]()+0x1)[_0x23570f(0x2ff)]()[_0x23570f(0x3c2)](0x2,'0')+'/'+_0x4f5477[_0x23570f(0x204)]()[_0x23570f(0x2ff)]()[_0x23570f(0x3c2)](0x2,'0')+'\x20'+_0x4f5477[_0x23570f(0x219)]()[_0x23570f(0x2ff)]()[_0x23570f(0x3c2)](0x2,'0')+':'+_0x4f5477['getMinutes']()[_0x23570f(0x2ff)]()[_0x23570f(0x3c2)](0x2,'0')+':'+_0x4f5477[_0x23570f(0x348)]()[_0x23570f(0x2ff)]()[_0x23570f(0x3c2)](0x2,'0');}function getCleanTimeStamp(){const _0x272c24=_0x1ec03f,_0x32c2f1=shiftedTime();return _0x32c2f1['getFullYear']()+(_0x32c2f1[_0x272c24(0x21c)]()+0x1)[_0x272c24(0x2ff)]()[_0x272c24(0x3c2)](0x2,'0')+_0x32c2f1[_0x272c24(0x204)]()['toString']()['padStart'](0x2,'0')+'-'+_0x32c2f1['getHours']()['toString']()[_0x272c24(0x3c2)](0x2,'0')+_0x32c2f1[_0x272c24(0x2ac)]()[_0x272c24(0x2ff)]()[_0x272c24(0x3c2)](0x2,'0')+_0x32c2f1[_0x272c24(0x348)]()[_0x272c24(0x2ff)]()[_0x272c24(0x3c2)](0x2,'0');}function shiftedTime(){const _0x4a7745=_0x1ec03f,_0x4acbb9=new Date();let _0x4a6eb3=_0x4acbb9;if(settings[_0x4a7745(0x362)]&&settings[_0x4a7745(0x362)]!==0x0)_0x4a6eb3=fns['add'](_0x4acbb9,{'hours':settings[_0x4a7745(0x362)]});return _0x4a6eb3;}async function startScheduler(){const _0x52a33f=_0x1ec03f,_0x24f566=new Date()['getUTCHours'](),_0x20d7e2=shiftedTime()[_0x52a33f(0x219)]();_0x20d7e2==0x4&&backupConfigFiles(),_0x20d7e2==0x0&&rotateLogFiles(),_0x24f566%0x6==0x0&&triggerAnalytics(),_0x24f566%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x260318){const _0x2c6cdd=_0x1ec03f;logger[_0x2c6cdd(0x338)](_0x2c6cdd(0x390)+_0x260318);const _0x5fa43e=getBotsWithMode();_0x5fa43e[_0x2c6cdd(0x315)]>0x0?confirmRestore(configbackuppath,_0x260318):unzipFile(configbackuppath,_0x260318);}async function getBackupFiles(_0x474c27=null){const _0x39facb=_0x1ec03f;let _0x210464=[],_0x5953fb=fs[_0x39facb(0x2f4)](configbackuppath,{'withFileTypes':!![]});_0x5953fb[_0x39facb(0x2ea)]((_0x38ac8a,_0x1ef08c)=>_0x38ac8a['name']<_0x1ef08c[_0x39facb(0x30a)]?0x1:_0x1ef08c[_0x39facb(0x30a)]<_0x38ac8a[_0x39facb(0x30a)]?-0x1:0x0),_0x5953fb[_0x39facb(0x317)](_0x4408b3=>{const _0x1aa75e=_0x39facb;if(!_0x4408b3[_0x1aa75e(0x3e4)]()&&_0x4408b3[_0x1aa75e(0x30a)][_0x1aa75e(0x227)](_0x1aa75e(0x288))&&_0x4408b3['name'][_0x1aa75e(0x2cb)](_0x1aa75e(0x30e))){const _0x2801c7=formatDate(fs[_0x1aa75e(0x3b2)](configbackuppath+_0x4408b3['name'])[_0x1aa75e(0x2bf)]);_0x210464['push']({'name':_0x4408b3[_0x1aa75e(0x30a)],'mtime':_0x2801c7});}});if(_0x474c27)io['to'](_0x474c27)['emit'](_0x39facb(0x1f5),_0x210464);else return _0x210464;}async function backupConfigFiles(){const _0x5e0094=_0x1ec03f;await zipFiles(_0x5e0094(0x3b0));const _0x6b6915=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x5e0094(0x3c5),configbackuppath+(_0x5e0094(0x288)+_0x6b6915+_0x5e0094(0x30e)));let _0x489fab=fs[_0x5e0094(0x2f4)](configbackuppath,{'withFileTypes':!![]});_0x489fab[_0x5e0094(0x2ea)]((_0x4f5433,_0x33f4c9)=>_0x4f5433[_0x5e0094(0x30a)]<_0x33f4c9[_0x5e0094(0x30a)]?0x1:_0x33f4c9[_0x5e0094(0x30a)]<_0x4f5433[_0x5e0094(0x30a)]?-0x1:0x0),_0x489fab[_0x5e0094(0x315)]>maxBackups&&fs[_0x5e0094(0x39f)](configbackuppath+_0x489fab[_0x489fab[_0x5e0094(0x315)]-0x1]['name']);}function rotateLogFiles(){const _0xf0b549=_0x1ec03f,_0x2d66a5=fs[_0xf0b549(0x3b2)](logspath+_0xf0b549(0x276)),_0x55511d=_0x2d66a5[_0xf0b549(0x28d)]/0x400;if(_0x55511d>0x64){let _0x429bb2=fs[_0xf0b549(0x2f4)](logspath,{'withFileTypes':!![]});_0x429bb2[_0xf0b549(0x2ea)]((_0x4ccb7c,_0x2a4872)=>_0x4ccb7c[_0xf0b549(0x30a)]<_0x2a4872['name']?0x1:_0x2a4872['name']<_0x4ccb7c[_0xf0b549(0x30a)]?-0x1:0x0),_0x429bb2[_0xf0b549(0x317)](_0x3033a1=>{const _0x22867a=_0xf0b549;if(_0x3033a1[_0x22867a(0x30a)]==_0x22867a(0x357))fs[_0x22867a(0x3da)](logspath+_0x3033a1[_0x22867a(0x30a)],logspath+_0x22867a(0x3d2));if(_0x3033a1[_0x22867a(0x30a)]==_0x22867a(0x310))fs[_0x22867a(0x3da)](logspath+_0x3033a1[_0x22867a(0x30a)],logspath+_0x22867a(0x357));_0x3033a1['name']=='output-000.log'&&(fs[_0x22867a(0x3da)](logspath+_0x3033a1[_0x22867a(0x30a)],logspath+_0x22867a(0x310)),fs[_0x22867a(0x23e)](logspath+_0x3033a1['name'],''));});}}async function zipFiles(_0x3727c7){const _0x4e9784=_0x1ec03f;let _0xaa4aca;if(_0x3727c7==_0x4e9784(0x29e))_0xaa4aca=logspath;if(_0x3727c7=='backup')_0xaa4aca=configpath;if(_0x3727c7==_0x4e9784(0x3b0))_0xaa4aca=configpath;let _0x3d0f8d=fs['readdirSync'](_0xaa4aca,{'withFileTypes':!![]});const _0x109a49=new require(_0x4e9784(0x25b))();_0x3d0f8d[_0x4e9784(0x317)](_0x2e7a82=>{const _0x4d6f54=_0x4e9784;if(!_0x2e7a82[_0x4d6f54(0x3e4)]()){let _0x1a8f05=fs[_0x4d6f54(0x2f0)](_0xaa4aca+_0x2e7a82[_0x4d6f54(0x30a)]);if(_0x3727c7==_0x4d6f54(0x324)){const _0x1ba46c=/^bot-[0-9]{3}-config.json$/,_0x3421ff=_0x1ba46c[_0x4d6f54(0x2a2)](_0x2e7a82[_0x4d6f54(0x30a)]);if(_0x3421ff){const _0x2c3ad8=JSON[_0x4d6f54(0x1ff)](_0x1a8f05);if(_0x2c3ad8['bot'][0x0]){_0x2c3ad8[_0x4d6f54(0x26a)][0x0][_0x4d6f54(0x39e)]=_0x4d6f54(0x3e9),_0x2c3ad8['bot'][0x0][_0x4d6f54(0x2b8)]=_0x4d6f54(0x3e9);if(_0x2c3ad8[_0x4d6f54(0x26a)][0x0][_0x4d6f54(0x35a)])_0x2c3ad8[_0x4d6f54(0x26a)][0x0][_0x4d6f54(0x35a)]=_0x4d6f54(0x3e9);}_0x1a8f05=JSON[_0x4d6f54(0x3cd)](_0x2c3ad8,null,0x2);}if(_0x2e7a82['name']==_0x4d6f54(0x3d5)){const _0x2e7fa6=JSON['parse'](_0x1a8f05);if(_0x2e7fa6[_0x4d6f54(0x235)]['loginRequired'])_0x2e7fa6[_0x4d6f54(0x235)][_0x4d6f54(0x3ca)]=![];if(_0x2e7fa6[_0x4d6f54(0x235)][_0x4d6f54(0x23a)])_0x2e7fa6[_0x4d6f54(0x235)][_0x4d6f54(0x23a)]=_0x4d6f54(0x3e9);if(_0x2e7fa6[_0x4d6f54(0x235)][_0x4d6f54(0x211)])_0x2e7fa6[_0x4d6f54(0x235)]['telegramToken']=_0x4d6f54(0x3e9);if(_0x2e7fa6[_0x4d6f54(0x235)][_0x4d6f54(0x206)])_0x2e7fa6[_0x4d6f54(0x235)]['telegramChatId']=null;if(_0x2e7fa6[_0x4d6f54(0x235)][_0x4d6f54(0x361)])_0x2e7fa6['settings'][_0x4d6f54(0x361)]='***';_0x1a8f05=JSON['stringify'](_0x2e7fa6,null,0x2);}if(_0x2e7a82['name']!=_0x4d6f54(0x275))_0x109a49[_0x4d6f54(0x257)](_0x2e7a82['name'],_0x1a8f05);}else _0x109a49[_0x4d6f54(0x257)](_0x2e7a82['name'],_0x1a8f05);}});const _0x1ef054=_0x109a49[_0x4e9784(0x3d8)]({'base64':![],'compression':_0x4e9784(0x35e)});fs[_0x4e9784(0x23e)](zippath+(_0x3727c7+'.zip'),_0x1ef054,_0x4e9784(0x3b4));}async function unzipFile(_0x453650,_0x51ba49){const _0x588278=_0x1ec03f;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x588278(0x317)](_0x32b9ac=>{const _0x450d9c=_0x588278;if(!_0x32b9ac[_0x450d9c(0x3e4)]())fs['rmSync'](configpath+_0x32b9ac[_0x450d9c(0x30a)]);});const _0xea8c8f=fs[_0x588278(0x2f0)](_0x453650+_0x51ba49,_0x588278(0x3b4)),_0x57b417=new require('node-zip')(_0xea8c8f,{'base64':![],'checkCRC32':!![]});Object[_0x588278(0x2b3)](_0x57b417[_0x588278(0x2a7)])[_0x588278(0x317)](_0x59669e=>{const _0x59bc2b=_0x588278,_0x3d717c=_0x57b417['files'][_0x59669e];fs[_0x59bc2b(0x23e)](configpath+_0x3d717c['name'],_0x3d717c[_0x59bc2b(0x240)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x588278(0x317)](_0x1657ee=>{const _0x43fb25=_0x588278;if(!_0x1657ee[_0x43fb25(0x3e4)]())fs[_0x43fb25(0x2c2)](temppath+_0x1657ee[_0x43fb25(0x30a)]);}),logger['debug']('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x588278(0x1ec)]({'restore':!![]},_0x2a81c8=>{});}async function getPublicIp(){const _0x4a2b17=_0x1ec03f;try{const _0x16b768=await axios[_0x4a2b17(0x236)](_0x4a2b17(0x2c0));publicip=_0x16b768[_0x4a2b17(0x284)]['ip'];}catch(_0x4c5ad0){}}async function triggerAnalytics(){const _0x2e39e2=_0x1ec03f;if(!publicip)await getPublicIp();const _0xeafacb=getBotsWithMode();let _0x28013b=0x0;_0xeafacb[_0x2e39e2(0x317)](_0x47e337=>{const _0x40b8f2=_0x2e39e2;if(_0x47e337['status']===_0x40b8f2(0x3ec))_0x28013b++;});const _0x16aae1=getBotExchanges();mixpanel[_0x2e39e2(0x2b0)](_0x2e39e2(0x3d1),{'distinct_id':settings[_0x2e39e2(0x3e2)],'ip':publicip,'version':serverversion,'numbots':_0xeafacb[_0x2e39e2(0x315)],'numbotsenabled':_0x28013b,'exchanges':_0x16aae1,'environment':environment});}async function getMessages(){const _0xa65e9b=_0x1ec03f,_0x565f83=_0xa65e9b(0x2bc),_0x17958f=new GraphQLClient(_0x565f83),_0x305bb3={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x24e63d=serverversion['split']('.'),_0x402a63=_0x24e63d[0x0]+'.'+_0x24e63d[0x1],_0x8bf4c6=Math[_0xa65e9b(0x3ae)](settings[_0xa65e9b(0x33f)],settings['lastmsgemitted']),_0x384d54={'last':parseInt(_0x8bf4c6),'bbm':_0x402a63},_0x56bc31=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x5c2afe;try{_0x5c2afe=await _0x17958f[_0xa65e9b(0x2aa)](_0x56bc31,_0x384d54,_0x305bb3);}catch(_0x2de9b4){}if(_0x5c2afe&&_0x5c2afe['messages']){let _0x437bcb=settings[_0xa65e9b(0x33f)];newMessages=[];for(const _0x52085c of _0x5c2afe[_0xa65e9b(0x2d0)]){newMessages[_0xa65e9b(0x344)](_0x52085c);let _0x5b2292=![];_0x52085c[_0xa65e9b(0x27a)]&&(updateSetting('latestversion',_0x52085c[_0xa65e9b(0x27a)]),_0x5b2292=isNewerVersion(serverversion,_0x52085c[_0xa65e9b(0x27a)])||serverversion==_0x52085c[_0xa65e9b(0x27a)]);if(!_0x5b2292&&_0x52085c[_0xa65e9b(0x33b)]>_0x437bcb){if(_0x52085c[_0xa65e9b(0x2f9)]==='any'||serverversion[_0xa65e9b(0x227)](_0x52085c[_0xa65e9b(0x2f9)])){let _0x223246=''+_0x52085c['title']+'\x0a\x0a'+_0x52085c[_0xa65e9b(0x2e7)];const _0x506da6=await sendTelegramMsg(toTelegramMarkdown(_0x223246),_0xa65e9b(0x25d));if(_0x506da6)_0x437bcb=_0x52085c[_0xa65e9b(0x33b)];}}}updateAvailable=isNewerVersion(settings[_0xa65e9b(0x2f6)],serverversion),updateSetting(_0xa65e9b(0x33f),_0x437bcb),emitMessages();}}function emitMessages(){const _0x1cc4ba=settings['lastmsgemitted'];let _0x18b723=[];newMessages['forEach'](_0x17523d=>{const _0x1bddcf=_0x3adf;_0x17523d[_0x1bddcf(0x33b)]>_0x1cc4ba&&_0x18b723[_0x1bddcf(0x344)](_0x17523d);}),_0x18b723['length']>0x0&&getAllClients()['forEach'](_0x669ebf=>{const _0x2587c5=_0x3adf;getSocket(_0x669ebf['id'])[_0x2587c5(0x394)](_0x2587c5(0x2e7),_0x18b723);});}function confirmMessage(_0x233ff9){updateSetting('lastmsgemitted',Number(_0x233ff9));}function isNewerVersion(_0x57c8f7,_0x1903bc){const _0x1f3641=_0x1ec03f,_0x545ba1=_0x1903bc[_0x1f3641(0x30d)]('.'),_0x5365cc=_0x57c8f7[_0x1f3641(0x30d)]('.');for(var _0x442cf6=0x0;_0x442cf6<_0x5365cc['length'];_0x442cf6++){const _0x11c499=~~_0x5365cc[_0x442cf6],_0x346bb2=~~_0x545ba1[_0x442cf6];if(_0x11c499>_0x346bb2)return!![];if(_0x11c499<_0x346bb2)return![];}return![];}function toTelegramMarkdown(_0x1a9c30){const _0x154505=_0x1ec03f,_0x5a5b0c=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x97eb7c=/\*{2}(.+?)\*{2}/gim;return _0x1a9c30=_0x1a9c30[_0x154505(0x2a8)](_0x5a5b0c,_0x154505(0x3e1))['replace'](_0x97eb7c,_0x154505(0x20a)),_0x1a9c30;}function _0x3c13(){const _0x5cd5cd=['telegramChatId','\x20|\x20','30\x20min','153776AnFvsz','*$1*','success','emitHistory','reinstall','disabled','telegramIpApproval','hashSync','telegramToken','running','resetHistory','version','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Notifications\x20enabled\x0a','Unauthorized\x20attempt\x20to\x20get\x20portfolio','reinstall_no','getHours','************','Unauthorized\x20attempt\x20to\x20get\x20messages','getMonth','1592IliJzU','198XbJsTC','telegramEvents','resetpw_yes','bot-','graphql-request','[ip-address]','restore-backup-file','password','join','startsWith','sendFile','slice','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','tkn','util','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','lowdb/adapters/FileSync','Restoring\x20bot(s)\x20from\x20backup','getTime','editMessageReplyMarkup','0.0.0','Unauthorized\x20attempt\x20to\x20log\x20out','manual','settings','get','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','exec','/update\x20-\x20update\x20Balance\x20Bot\x0a','bbPassword','telegraf','remove','find','writeFileSync','value','_data','showConfig','resetpw_no','ipaddr.js','#RES#\x20','stop','expiry','status','Notifications\x20disabled','place-order','type','/enable\x20-\x20enable\x20notifications\x0a','connected','assign','full','pidExpireLogin','index.html','Error:\x20Invalid\x20argument\x20','zip/','Invalid\x20IP\x20address','Starting\x20Balance\x20Bot\x20reinstallation','all','login\x20not\x20required','file','start','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','restart','node-zip','Bot\x20Mgr\x20>\x20','Markdown','onepagemode','build','invalid\x20credentials','delete-bot','\x20(2)','All','telegram','log','from','Node.js\x20v','4325GqJmqb','toIPv4Address','bot','show','enable','Login\x20accepted','store-settings','env','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Unauthorized\x20attempt\x20to\x20get\x20events','Bot\x20','RSA','function','bb-secure.json','output-000.log','jsonwebtoken',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','mode','bbvNew','host','api-eu.mixpanel.com','Yes','user','RSA-OAEP','encryptedUuid','decrypt','inlineKeyboard','string','data','Logged\x20in\x20user\x20...','range','telegrammsg','backup-full@','1000','-events.json','action','Unauthorized\x20attempt\x20to\x20update\x20settings','size','update-bot','cancel-loading','|@|','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','bb-config.json','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','sign','blacklist','/:bot/coins','whitelistEnabled','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','entries','access','Error\x20details:','#RES#','build2','logs','server','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','production','test','lowdb','conn','Failed\x20to\x20download\x20','Restore\x20process\x20aborted','files','replace','secret','request','Unauthorized\x20attempt\x20to\x20show\x20configuration','getMinutes','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','1512984TrxpkS','config_orders','track','Enabled\x20Bot\x20','crypto','keys','temp/','/:bot/portfolio','User\x20has\x20been\x20validated','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','apiSecret','sendPortfolioTelegram','init','\x20to\x20','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Alerts','Error\x20while\x20deleting\x20config\x20files:\x20','mtime','https://api.ipify.org?format=json','command','rmSync','axios','bot.js','/download/:type','update','existsSync','(((.+)+)+)+$','placeOrder','metrics_','endsWith','static','/upload-backup','post','Network\x20Interfaces:','messages','publicKey','42CaFbqp','\x20minutes','exp','connection','=>\x20Go\x20to\x20#CYA#http://','add-bot','Unauthorized\x20attempt\x20to\x20update\x20bot','new-disabled','compareSync','http','getPortfolio','listen','temporaryAccessAllowed','File\x20uploaded','\x20only\x0a','storeFiat','Your\x20installation\x20is\x20already\x20up\x20to\x20date','argv','uuid-random','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','headless','message','mkdirSync','close','sort','token','params','temporary\x20token\x20generated','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','22gRnFKD','readFileSync','confirm-message','/output-000.log','All\x20bots\x20running\x20right\x20now','readdirSync','-config.json','latestversion','simple','Idling\x20(','bbvReceive','uuid','then','express-fileupload','/start','telegramUsername','toString','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','144280HFEeQI','\x20|\x20user:\x20...','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','/:bot/configuration','restore_yes_','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','error','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','createServer','name','Token\x20blacklisted','\x20>\x20','split','.zip','address\x20already\x20in\x20use','output-001.log','versions','match','CoinMarketCap\x20API\x20key\x20validated','toggle-bot-mode','length','referer','forEach','Password\x20reset\x20rejected','off','toggleBotMode','#RES#\x20if\x20running\x20locally\x0a','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','NTBA_FIX_319','\x1b[0m','BCT','SIGTERM','private','reject','warning','backup','sendMetricsTelegram','remoteAddress','-results.json','clients','botmanager','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','tempaccess_15_','disconnect','2FA\x20login\x20token\x20generated','access\x20timeout','initclient','f2aRequired','login\x20required','username','#RES#\x20if\x20running\x20on\x20server','express','reason','19421ADOjoF','logged\x20out','debug','hasOwnProperty','getStartingBalances','number','once','login\x20token\x20generated','write','lastmsgtelegram','socket.io','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Crypt','Disabled\x20Bot\x20','push','ETH','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','constructor','getSeconds','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','alias','::ffff:127.0.0.1','\x1b[33m','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','1871270gnboUy','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','use','Unauthorized\x20attempt\x20to\x20delete\x20bot','Restarting\x20Bot\x20','child_process','sockets','version.json','update_yes','output-002.log','inherit','includes','apiPassword','-performance.json','privateKey','path','DEFLATE','Telegram\x20error:','::1','marketcapApi','timeshift','reinstall_yes','toggle','/metrics\x20-\x20show\x20bot\x20performance\x0a',')\x20\x20\x20|\x20Bot\x20','login2fa_reject_','<b>Balance\x20Bot\x20Status:</b>\x0a','alerts','staging','Starting\x20#RED#Balance\x20Bot\x20v','Logged\x20out\x20user\x20...','botID','config','kind','port','Unauthorized\x20login\x20attempt\x20(timeout)','bots','headers','reinstall-bb','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','3000','-----------------------------------------------------------------------------------','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','30901IDqkXJ',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','ipv6','download',':\x20Bot\x20Mgr\x20>\x20','\x20(1)','callback',',\x20must\x20be\x20a\x204\x20digit\x20number','started','Setting\x20access:\x20','randomFillSync','reload','address','exit','code','event','storeHeadless','Orders','orders','defaults','show-config','date-fns','format','Restore\x20backup\x20file\x20','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','auth','metrics','emit','\x20-\x20','store-headless','randomBytes','backup/','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','store','HTML','args','get-starting-balances','apiKey','unlinkSync','live','text','button','botname','Unauthorized\x20attempt\x20to\x20download\x20','mixpanel','config/','Starting\x20new\x20bot\x20|\x20Bot\x20','temporary\x20access\x20rejected','hex','allow','restart_','notification','All\x20bots','min','kill','backup-full','stopped','statSync','search','binary','auto','sendMessage','reply','map','socket','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','portfolio','logout','SIGINT','clientip','Unauthorized\x20attempt\x20to\x20confirm\x20message','telegram2FaApproval','padStart','Starting\x20(','launch','backup-full.zip','chat','pidRefreshToken','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','timestamp','loginRequired','config_alerts','login','stringify','2FA','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','5316ZZISPZ','Server','output-003.log','\x1b[36m','off_','bb-settings.json','new','Notifications\x20types:\x20','generate','filter','copyFileSync','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','bbUsername','hybrid-crypto-js','temporary\x20access\x20timeout','tempaccess_reject_','No\x20bots\x20running\x20right\x20now','$1_$2_$3','userid','getFullYear','isDirectory','lastmsgemitted','restore_no_','telegramEnabled','2FA\x20required','***','\x1b[34m','Access\x20enabled\x20for\x20','enabled','Session\x20expired\x20for\x20user\x20...','Unauthorized\x20attempt\x20to\x20store\x20configuration','isIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','send','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','help','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','cancelLoading','settings.','accept','portfolio_','backup-files','120BzSwAk','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','yes','set','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','Restore\x20process\x20confirmed','Temporary\x20access\x20rejected','config_all','get-messages','parse','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','store-configuration','2FA\x20login\x20rejected','secure','getDate','sortBy'];_0x3c13=function(){return _0x5cd5cd;};return _0x3c13();}async function validateConfigFile(){const _0x5d211a=_0x1ec03f,_0x3f93a6=dbConfig['get'](_0x5d211a(0x372))[_0x5d211a(0x205)](_0x5d211a(0x36d))[_0x5d211a(0x23f)]()||[];if(_0x3f93a6['length']==0x0){let _0x546280=0x0,_0x45f95f=[];const _0x4d6705=/^bot-([0-9]{3})-config.json$/,_0x342871=fs['readdirSync'](configpath);_0x342871[_0x5d211a(0x317)](_0x2fbb4a=>{const _0x3ec9a1=_0x5d211a,_0x34b755=_0x4d6705[_0x3ec9a1(0x238)](_0x2fbb4a);if(_0x34b755){const _0x180032=_0x34b755[0x1];let _0x5452b4=getBotAttributes(_0x180032);_0x45f95f[_0x3ec9a1(0x344)]({'botID':_0x180032,'botname':_0x5452b4[_0x3ec9a1(0x3a3)],'status':_0x3ec9a1(0x20e),'live':_0x3ec9a1(0x3b1)}),_0x546280++;}}),_0x546280!=0x0&&(dbConfig[_0x5d211a(0x236)](_0x5d211a(0x372))[_0x5d211a(0x24d)](_0x45f95f)[_0x5d211a(0x33e)](),config=_0x45f95f,restoredConfigFile=_0x546280);}}async function restoreConfigNotify(_0x4f8958){const _0x448173=_0x1ec03f;let _0x22ba44;if(restoredConfigFile==0x1)_0x22ba44='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x22ba44=_0x448173(0x375);if(_0x4f8958)io['to'](_0x448173(0x329))['emit'](_0x448173(0x3ac),_0x22ba44);else{logger[_0x448173(0x2f7)](_0x448173(0x377)),logger[_0x448173(0x2f7)](_0x22ba44),logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x448173(0x2f7)]('');if(tgBot&&settings[_0x448173(0x206)]&&settings[_0x448173(0x21f)]!='orders')await sendTelegram(settings['telegramChatId'],_0x448173(0x25c)+_0x22ba44);}}function validateCredentials(_0xfaedde,_0x10871b){const _0x1f34f9=_0x1ec03f;if(_0xfaedde[_0x1f34f9(0x332)]==settings[_0x1f34f9(0x3dc)]&&bcrypt[_0x1f34f9(0x2da)](_0xfaedde[_0x1f34f9(0x225)],settings[_0x1f34f9(0x23a)])){if(settings[_0x1f34f9(0x330)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0xe33d53=generateLoginToken(_0x10871b);return{'allow':!![],'reason':_0x1f34f9(0x33d),'token':_0xe33d53};}}else return{'allow':![],'reason':_0x1f34f9(0x260),'token':null};}function refreshToken(_0x508bf7){const _0x112d4e=_0x1ec03f,_0x4fff87=generateLoginToken(_0x508bf7);return{'allow':!![],'reason':_0x112d4e(0x33d),'token':_0x4fff87};}function validateAccess(_0x313342,_0x1ac12a,_0x1b1209){const _0x3dbc2f=_0x1ec03f,_0x1c61c8=_0x1b1209?_0x1b1209:devices[_0x1ac12a]['ip'];let _0x1694f4;const _0x33bc9f=_0x41a41f=>{const _0x18aec7=_0x3adf;if(settings[_0x18aec7(0x3ca)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x1ac12a)){const _0x24d622=generateLoginToken(_0x1ac12a);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x24d622};}else return{'allow':![],'reason':_0x18aec7(0x331),'token':null};}else return _0x1694f4=validToken(_0x41a41f,_0x1ac12a),_0x1694f4[_0x18aec7(0x339)](_0x18aec7(0x20b))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x41a41f}:{'allow':![],'reason':_0x18aec7(0x331),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x3dbc2f(0x297)]){let _0x529a38=[...settings['whitelist'],_0x3dbc2f(0x360),_0x3dbc2f(0x34b),'127.0.0.1'];if(_0x529a38[_0x3dbc2f(0x359)](_0x1c61c8))return _0x33bc9f(_0x313342);else{_0x1694f4=validToken(_0x313342,_0x1ac12a);if(_0x1694f4['hasOwnProperty']('success'))return _0x33bc9f(_0x313342);else{if(telegramIpApproved(_0x1ac12a)){const _0x2ed396=generateToken(_0x1ac12a);return _0x1694f4=_0x33bc9f(_0x313342),_0x1694f4[_0x3dbc2f(0x3aa)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x2ed396}:_0x1694f4;}else return settings[_0x3dbc2f(0x2de)]?{'allow':![],'reason':_0x3dbc2f(0x3e8),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x33bc9f(_0x313342);}function timelyDecrypt(_0x42473c,_0x2f8aa3,_0x29667d='@'){const _0x6d4466=_0x1ec03f;if(_0x42473c)try{const _0x581a1e=crypt[_0x6d4466(0x281)](secure[_0x6d4466(0x35c)],_0x42473c)[_0x6d4466(0x2e7)],_0x44f068=_0x581a1e[_0x6d4466(0x30d)](_0x29667d)[0x0],_0x4f7061=_0x581a1e['split'](_0x29667d)[0x1],_0x2fdecb=new Date()[_0x6d4466(0x230)]();if(_0x2f8aa3){if(_0x2fdecb-_0x4f7061<maxSecretAge*0x3e8)return _0x44f068;else return![];}else return _0x44f068;}catch(_0x31742d){return![];}else return![];}const validToken=(_0xf14428,_0x937e8a)=>{const _0x2566a2=_0x1ec03f,_0x38f16a=devices[_0x937e8a]['ip'];if(!_0xf14428)return{'error':'No\x20authentication\x20token'};for(let _0x5ddaea of blacklist){if(_0x5ddaea[_0x2566a2(0x2eb)]==_0xf14428)return{'error':_0x2566a2(0x30b)};}let _0x59812a;try{_0x59812a=jwt['verify'](_0xf14428,secure[_0x2566a2(0x2a9)]+_0x937e8a);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x59812a[_0x2566a2(0x339)](_0x2566a2(0x3bf))&&!_0x59812a[_0x2566a2(0x339)](_0x2566a2(0x332))||!_0x59812a[_0x2566a2(0x339)](_0x2566a2(0x2d4)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x59812a[_0x2566a2(0x339)](_0x2566a2(0x332))&&_0x59812a[_0x2566a2(0x339)](_0x2566a2(0x3bf))){const {clientip:_0x4cf006}=_0x59812a;return _0x38f16a==_0x4cf006?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x2566a2(0x253)};}else{if(_0x59812a[_0x2566a2(0x339)]('username')&&_0x59812a['hasOwnProperty'](_0x2566a2(0x3bf))){const {username:_0x2765e8,clientip:_0x4c8106}=_0x59812a;return settings['bbUsername']==_0x2765e8&&_0x38f16a==_0x4c8106?{'success':_0x2566a2(0x2b6)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x996071=>{const _0x4a00a0=_0x1ec03f;if(_0x996071){const _0x13252b=devices[_0x996071]['ip'];return jwt[_0x4a00a0(0x294)]({'username':settings[_0x4a00a0(0x3dc)],'clientip':_0x13252b},secure[_0x4a00a0(0x2a9)]+_0x996071,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x6b56b2=>{const _0x1aa5a1=_0x1ec03f;if(_0x6b56b2){const _0x308e46=devices[_0x6b56b2]['ip'];return jwt[_0x1aa5a1(0x294)]({'clientip':_0x308e46},secure[_0x1aa5a1(0x2a9)]+_0x6b56b2,{'expiresIn':devices[_0x6b56b2][_0x1aa5a1(0x20f)][_0x1aa5a1(0x246)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x113bab=>{const _0x6454e1=_0x1ec03f;let _0x3b0963=![];return devices[_0x113bab][_0x6454e1(0x20f)]&&devices[_0x113bab][_0x6454e1(0x20f)]['expiry']!=_0x6454e1(0x322)&&(_0x3b0963=devices[_0x113bab][_0x6454e1(0x20f)][_0x6454e1(0x3bf)]==devices[_0x113bab]['ip']&&new Date()[_0x6454e1(0x230)]()-devices[_0x113bab][_0x6454e1(0x20f)]['timestamp']<devices[_0x113bab][_0x6454e1(0x20f)][_0x6454e1(0x246)]*0x3c*0x3e8),_0x3b0963;},telegram2FaApproved=_0x5acbac=>{const _0x38b442=_0x1ec03f;let _0x15c180=![];return devices[_0x5acbac][_0x38b442(0x3c1)]&&devices[_0x5acbac]['telegram2FaApproval'][_0x38b442(0x246)]!=_0x38b442(0x322)&&(_0x15c180=devices[_0x5acbac]['telegram2FaApproval'][_0x38b442(0x3bf)]==devices[_0x5acbac]['ip']&&new Date()[_0x38b442(0x230)]()-devices[_0x5acbac][_0x38b442(0x3c1)][_0x38b442(0x3c9)]<devices[_0x5acbac][_0x38b442(0x3c1)][_0x38b442(0x246)]*0x3c*0x3e8),_0x15c180;},normalizeIP=_0x44d34b=>{const _0x45c5ae=_0x1ec03f;let _0x1c7f87=null,_0x3071f0=null;if(ipaddr['isValid'](_0x44d34b)){const _0x2f98b7=ipaddr['parse'](_0x44d34b);_0x2f98b7[_0x45c5ae(0x36f)]()===_0x45c5ae(0x37b)?(_0x2f98b7[_0x45c5ae(0x1ea)]()&&(_0x1c7f87=_0x2f98b7[_0x45c5ae(0x269)]()[_0x45c5ae(0x2ff)]()),_0x3071f0=_0x2f98b7[_0x45c5ae(0x2ff)]()):(_0x1c7f87=_0x2f98b7[_0x45c5ae(0x2ff)](),_0x3071f0=_0x2f98b7['toIPv4MappedAddress']()[_0x45c5ae(0x2ff)]());}return{'show':_0x1c7f87?_0x1c7f87:_0x3071f0,'store':_0x3071f0};};function formatDate(_0x4c3d92){const _0x1243b9=_0x1ec03f;return _0x4c3d92[_0x1243b9(0x3e3)]()+'/'+(_0x4c3d92['getMonth']()+0x1)[_0x1243b9(0x2ff)]()[_0x1243b9(0x3c2)](0x2,'0')+'/'+_0x4c3d92[_0x1243b9(0x204)]()[_0x1243b9(0x2ff)]()[_0x1243b9(0x3c2)](0x2,'0')+'\x20'+_0x4c3d92[_0x1243b9(0x219)]()[_0x1243b9(0x2ff)]()[_0x1243b9(0x3c2)](0x2,'0')+':'+_0x4c3d92[_0x1243b9(0x2ac)]()['toString']()['padStart'](0x2,'0')+':'+_0x4c3d92[_0x1243b9(0x348)]()[_0x1243b9(0x2ff)]()[_0x1243b9(0x3c2)](0x2,'0');}function sleep(_0x50ee57){return new Promise(_0x255e06=>setTimeout(_0x255e06,_0x50ee57));}