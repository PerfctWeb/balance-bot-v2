const _0x5b0321=_0x169f;(function(_0x4d5be1,_0x1beac7){const _0x15419f=_0x169f,_0x269965=_0x4d5be1();while(!![]){try{const _0x388601=parseInt(_0x15419f(0x155))/0x1+parseInt(_0x15419f(0x1fd))/0x2*(parseInt(_0x15419f(0x21e))/0x3)+parseInt(_0x15419f(0x1b4))/0x4*(parseInt(_0x15419f(0x174))/0x5)+-parseInt(_0x15419f(0x14d))/0x6*(-parseInt(_0x15419f(0x1f8))/0x7)+-parseInt(_0x15419f(0x255))/0x8+parseInt(_0x15419f(0x134))/0x9+parseInt(_0x15419f(0x22f))/0xa*(-parseInt(_0x15419f(0x14c))/0xb);if(_0x388601===_0x1beac7)break;else _0x269965['push'](_0x269965['shift']());}catch(_0x1755f3){_0x269965['push'](_0x269965['shift']());}}}(_0x3a58,0x5c862));const _0x5168f4=function(){let _0x271da1=!![];return function(_0x6f2ee7,_0x271615){const _0x103602=_0x271da1?function(){const _0x2c3572=_0x169f;if(_0x271615){const _0x70d632=_0x271615[_0x2c3572(0x23b)](_0x6f2ee7,arguments);return _0x271615=null,_0x70d632;}}:function(){};return _0x271da1=![],_0x103602;};}(),_0x211adb=_0x5168f4(this,function(){const _0x362282=_0x169f;return _0x211adb[_0x362282(0x166)]()[_0x362282(0x14a)]('(((.+)+)+)+$')[_0x362282(0x166)]()[_0x362282(0x20c)](_0x211adb)[_0x362282(0x14a)](_0x362282(0x12e));});_0x211adb();'use strict';function _0x169f(_0x1bcd0b,_0x132a9d){const _0x28496c=_0x3a58();return _0x169f=function(_0x211adb,_0x5168f4){_0x211adb=_0x211adb-0x118;let _0x3a58aa=_0x28496c[_0x211adb];return _0x3a58aa;},_0x169f(_0x1bcd0b,_0x132a9d);}process[_0x5b0321(0x163)][_0x5b0321(0x156)]=0x1;const childProcess=require(_0x5b0321(0x222)),FileSync=require(_0x5b0321(0x19c)),fs=require('fs'),fns=require('date-fns'),low=require(_0x5b0321(0x23d)),path=require(_0x5b0321(0x15b)),crypto=require(_0x5b0321(0x177)),Crypt=require(_0x5b0321(0x207))[_0x5b0321(0x1d6)],RSA=require(_0x5b0321(0x207))[_0x5b0321(0x233)],bcrypt=require(_0x5b0321(0x12c)),jwt=require(_0x5b0321(0x22e)),analyticsLib=require(_0x5b0321(0x1f9))[_0x5b0321(0x214)],googleAnalytics=require(_0x5b0321(0x21a))[_0x5b0321(0x214)],ipaddr=require(_0x5b0321(0x244)),argv=require('yargs/yargs')(process['argv']['slice'](0x2))[_0x5b0321(0x228)],PORT=argv['port']||_0x5b0321(0x152),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x5b0321(0x219)](PORT))return console[_0x5b0321(0x194)](_0x5b0321(0x1b0)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1);const HOST=argv['host']||null,userID=argv[_0x5b0321(0x187)]||'';let bbpath='bb/',bbpath2='';const botfile='bot.js',configfile=_0x5b0321(0x149),settingsfile=_0x5b0321(0x1a7),securefile=_0x5b0321(0x169);!fs[_0x5b0321(0x179)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x5b0321(0x141)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x5b0321(0x19b),configbackuppath=configpath+_0x5b0321(0x1fa);!fs[_0x5b0321(0x179)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x5b0321(0x179)](configbackuppath)&&fs['mkdirSync'](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x5b0321(0x1b9)]({'bots':[]})[_0x5b0321(0x1f2)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x5b0321(0x1b9)]({'settings':{'timeshift':0x0}})[_0x5b0321(0x1f2)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x5b0321(0x1b9)]({'secure':{},'blacklist':[]})[_0x5b0321(0x1f2)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x5b0321(0x1d5)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x5b0321(0x1e1)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require('express'),app=express(),http=require(_0x5b0321(0x265))[_0x5b0321(0x257)](app);app[_0x5b0321(0x251)](express['static'](path[_0x5b0321(0x1f0)](__dirname,bbpath2,'build2'))),app[_0x5b0321(0x251)](express[_0x5b0321(0x239)](path[_0x5b0321(0x1f0)](__dirname,bbpath2,_0x5b0321(0x24e)))),app[_0x5b0321(0x1dc)]('/',function(_0x586b28,_0x11bee3){const _0x52a105=_0x5b0321;_0x11bee3[_0x52a105(0x246)](path[_0x52a105(0x1f0)](__dirname,bbpath2,_0x52a105(0x17d),_0x52a105(0x263)));}),app[_0x5b0321(0x1dc)](_0x5b0321(0x181),function(_0x298712,_0x261302){const _0x50b268=_0x5b0321;_0x261302['sendFile'](path[_0x50b268(0x1f0)](__dirname,bbpath2,_0x50b268(0x24e),_0x50b268(0x263)));}),app[_0x5b0321(0x1dc)]('/:bot/portfolio',(_0x57ce5f,_0x23841f)=>{const _0x14d3b3=_0x5b0321;_0x23841f[_0x14d3b3(0x246)](path[_0x14d3b3(0x1f0)](__dirname,bbpath2,_0x14d3b3(0x24e),_0x14d3b3(0x263)));}),app['get']('/:bot/performance',(_0x4f39b4,_0x4d7023)=>{const _0x4529a7=_0x5b0321;_0x4d7023[_0x4529a7(0x246)](path[_0x4529a7(0x1f0)](__dirname,bbpath2,_0x4529a7(0x24e),_0x4529a7(0x263)));}),app[_0x5b0321(0x1dc)](_0x5b0321(0x132),(_0x14739f,_0x201f34)=>{const _0x52746a=_0x5b0321;_0x201f34['sendFile'](path[_0x52746a(0x1f0)](__dirname,bbpath2,'build',_0x52746a(0x263)));}),app[_0x5b0321(0x1dc)]('/:bot/history',(_0xe15c44,_0x467bf2)=>{const _0x2500bf=_0x5b0321;_0x467bf2[_0x2500bf(0x246)](path['join'](__dirname,bbpath2,_0x2500bf(0x24e),_0x2500bf(0x263)));}),app[_0x5b0321(0x1dc)](_0x5b0321(0x1c7),(_0x433376,_0x17d28d)=>{const _0xaaa6cf=_0x5b0321;_0x17d28d['sendFile'](path[_0xaaa6cf(0x1f0)](__dirname,bbpath2,'build',_0xaaa6cf(0x263)));}),app[_0x5b0321(0x1dc)](_0x5b0321(0x23e),(_0x4579af,_0x3709a5)=>{const _0x30ff43=_0x5b0321;_0x3709a5[_0x30ff43(0x246)](path[_0x30ff43(0x1f0)](__dirname,bbpath2,'build','index.html'));});if(HOST)http[_0x5b0321(0x24d)](PORT,HOST);else http[_0x5b0321(0x24d)](PORT);const io=require(_0x5b0321(0x1a8))(http,{}),analytics=analyticsLib({'app':_0x5b0321(0x1f1),'plugins':[googleAnalytics({'trackingId':_0x5b0321(0x217)})]}),TelegramBot=require('node-telegram-bot-api');function _0x3a58(){const _0x16c827=['remove','readdirSync','username','storeConfiguration','get-logs','argv','accept','No\x20authentication\x20token','bot-','botID','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','jsonwebtoken','200YrFTgh','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','telegramChatId','keys','RSA','login\x20required','logged\x20out','reset-password','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','disabled\x20Bot\x20','static','getPortfolio','apply','encryptedUuid','lowdb','/:bot/support','Unauthorized\x20attempt\x20to\x20update\x20settings','deleted\x20Bot\x20','ipc','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','message','ipaddr.js','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','sendFile','Login\x20accepted','HTML','getSeconds','reload','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','/enable\x20-\x20enable\x20notifications\x0a','listen','build','from','You\x20can\x20use\x20the\x20following\x20commands:\x0a','use','get-starting-balances','toIPv4Address','\x20only\x0a','2264864eOCLPa','alerts','createServer','Invalid\x20IP\x20address','handshake','5\x20min','args','Balance\x20Bot\x20Server','data','2FA\x20login\x20rejected','All','removeListener','error','2FA\x20login\x20required','index.html','send','http','Alerts','add','temporaryAccessAllowed','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','find','show','telegram2FaApproval','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','kill','telegramEnabled','ipv6','loginRequired','bots','/off\x20-\x20stop\x20bot(s)\x0a','forEach','removeAllListeners','live','/restart\x20-\x20restart\x20bot(s)\x0a','bot','entries','************','hex','bcryptjs','exp','(((.+)+)+)+$','starting\x20bot\x20|\x20Bot\x20','conn','cloneDeep','/:bot/coins','generateKeyPairAsync','2769597ldzWjj','store-settings','temporary\x20token\x20generated','timestamp','notification','</b>\x20?','starting\x20new\x20bot\x20|\x20Bot\x20','login\x20token\x20generated','::1','-results.json','unlinkSync','store-headless','\x20minutes','clients','-events.json','telegramToken','getHours','reason','sign','-config.json','token','bb-config.json','search','access','181808rzHiGy','1301838dVHCkH','SIGTERM','verify','stopped','onText','3000','remoteAddress','Unauthorized\x20attempt\x20to\x20delete\x20bot','322406omUUpa','NTBA_FIX_319','decrypt','yes','Notifications\x20disabled','store','path','whitelistEnabled','push','publicKey','password','chat','404\x20Not\x20Found','connection','env','running','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','toString','all','expiry','bb-secure.json','disabled','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','server','split','\x20>\x20','map','login\x20not\x20required','update-bot','catch','Access\x20enabled\x20for\x20','8430ogauXs','2FA','bbUsername','crypto','Unauthorized\x20attempt\x20to\x20log\x20out','existsSync','Unauthorized\x20attempt\x20to\x20get\x20portfolio','telegramEvents','\x20|\x20','build2','getTime','max','match','/:bot','Unauthorized\x20attempt\x20to\x20store\x20configuration','status','getStartingBalances','/on\x20-\x20start\x20bot(s)\x0a','blacklist','user','SIGINT','settings.','Password\x20reset\x20rejected','Unauthorized\x20attempt\x20to\x20update\x20bot','function','page','Token\x20blacklisted','Unauthorized\x20attempt\x20to\x20add\x20bot','cancelLoading','isValid','randomFillSync','telegram','log','access\x20timeout','temporary\x20access\x20rejected','started','/status\x20-\x20show\x20bot(s)\x20status\x0a','No\x20bots\x20running\x20right\x20now','Allow\x20login\x20from\x20IP\x20address\x20<b>','config/','lowdb/adapters/FileSync','Notifications\x20disabled\x0a','event','disconnect','enabled','assign','stop','Orders',':\x20Bot\x20Mgr\x20>\x20','toIPv4MappedAddress','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','bb-settings.json','socket.io','compareSync','Notifications\x20enabled\x0a','\x20/\x20','pidExpireLogin','cancel-loading','privateKey','referer','Error:\x20Invalid\x20argument\x20','2FA\x20required','https://hodlerhacks.com','timeshift','100EknevI','bbPassword','stopPolling','sockets','callback_query','defaults','f2aRequired','Bot\x20','telegramUsername','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','error\x20while\x20deleting\x20config\x20files:\x20','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','length','logout','copyFileSync','get-portfolio','idling\x20bot\x20\x20\x20|\x20Bot\x20','emit','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','/:bot/configuration','once','botname','orders','answerCallbackQuery','padStart','clientip','-performance.json','All\x20bots\x20running\x20right\x20now','/disable\x20-\x20disable\x20notifications\x0a','User\x20has\x20been\x20validated','polling_error','apiKey','place-order','RSA-OAEP','Crypt','kind','uuid','getDate','new','Invalid\x20Telegram\x20token','get','delete-bot',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','set','Notifications\x20enabled','version','15\x20min','emitHistory','Invalid\x20username\x20or\x20IP\x20address','hashSync','initclient','Password\x20has\x20been\x20reset\x20to:\x20','30\x20min','temporary\x20access\x20not\x20allowed','success','isDirectory','sendMessage','value','exit','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','join','Balance\x20Bot','write','whitelist','Bot\x20Mgr\x20>\x20','type','new-disabled','reject','7ZNaUtj','analytics','backup/','filter','hasOwnProperty','103384wcliEV','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','secret','Temporary\x20access\x20rejected','inherit','settings','getMinutes','<b>Balance\x20Bot\x20status:</b>\x0a','name','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','hybrid-crypto-js','includes','-----------------------------------------------------------------------------------','then','sortBy','constructor','randomBytes','/help\x20-\x20show\x20available\x20commands\x0a','botmanager','pidRefreshToken','telegramIpApproval','2FA\x20login\x20token\x20generated','invalid\x20credentials','default','login','allow','UA-192771731-1','getFullYear','test','@analytics/google-analytics','getMonth','getUTCHours','<b>Telegram\x20bot\x20status:</b>\x0a','6tcizkj','Unauthorized\x20attempt\x20to\x20get\x20logs','Unauthorized\x20login\x20attempt\x20(timeout)','Ok,\x20will\x20send\x20order\x20notifications\x20only','child_process'];_0x3a58=function(){return _0x16c827;};return _0x3a58();}let tgBot;if(settings[_0x5b0321(0x143)]&&settings[_0x5b0321(0x143)]!=''&&settings[_0x5b0321(0x1bc)]&&settings[_0x5b0321(0x1bc)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x319b93=_0x5b0321;console[_0x319b93(0x194)](''),console['log']('-----------------------------------------------------------------------------------'),logging(_0x319b93(0x1fe)+PORT),console[_0x319b93(0x194)](_0x319b93(0x209));if(config['length']!=0x0)config[_0x319b93(0x124)](_0x44c38e=>{const _0x71e4f9=_0x319b93;if(_0x44c38e['status']==_0x71e4f9(0x1a0)||_0x44c38e['status']==_0x71e4f9(0x1da))logging(_0x71e4f9(0x12f)+_0x44c38e[_0x71e4f9(0x22c)]+_0x71e4f9(0x17c)+_0x44c38e[_0x71e4f9(0x1c9)]),startBot([_0x44c38e[_0x71e4f9(0x22c)],userID],{'cwd':bbpath},function(_0x16b89f){if(_0x16b89f)logging(_0x16b89f);});else(_0x44c38e['status']=='disabled'||_0x44c38e['status']==_0x71e4f9(0x1f6))&&logging(_0x71e4f9(0x1c4)+_0x44c38e['botID']+'\x20|\x20'+_0x44c38e[_0x71e4f9(0x1c9)]);});else!newBot&&console[_0x319b93(0x194)](_0x319b93(0x1a6));if(newBot)addBot();console['log'](_0x319b93(0x209)),console[_0x319b93(0x194)]('');}function startSocket(){const _0x24b664=_0x5b0321;io['on'](_0x24b664(0x162),_0x4beb84=>{const _0x3b5a8a=_0x24b664;let _0x2387af,_0x155696,_0x3fbe95,_0x37dc5c,_0x262cc7;const _0x4b0096=_0x4beb84[_0x3b5a8a(0x259)]['headers'][_0x3b5a8a(0x1af)];_0x155696=_0x4b0096[_0x3b5a8a(0x180)](/bot[0-9]{3}/);if(_0x155696)_0x3fbe95=_0x155696[0x0]['match'](/[0-9]{3}/);if(_0x3fbe95)_0x2387af=_0x3fbe95[0x0];else _0x2387af=_0x3b5a8a(0x20f);const _0x2b2c5c=_0x4beb84[_0x3b5a8a(0x259)]['auth'][_0x3b5a8a(0x23c)];if(!_0x2b2c5c)_0x4beb84[_0x3b5a8a(0x1c5)]('status',{'publicKey':secure[_0x3b5a8a(0x15e)]});else{_0x37dc5c=timelyDecrypt(_0x2b2c5c,![]);if(!_0x37dc5c)logging('Unauthorized\x20login\x20attempt\x20(public\x20key)');else{_0x262cc7=normalizeIP(_0x4beb84[_0x3b5a8a(0x130)][_0x3b5a8a(0x153)])[_0x3b5a8a(0x15a)];if(!devices[_0x37dc5c])devices[_0x37dc5c]={'uuid':_0x37dc5c,'access':{'token':null}};devices[_0x37dc5c]['ip']=_0x262cc7;const _0x31246b=addClient(_0x4beb84['id'],_0x37dc5c,_0x2387af);setAccess(_0x31246b),_0x4beb84['on']('login',_0x3f4742=>{const _0x1e33ac=_0x3b5a8a,_0x22c4dc=timelyDecrypt(_0x3f4742['password']);if(_0x22c4dc){_0x3f4742={'username':_0x3f4742['username'],'password':_0x22c4dc},devices[_0x37dc5c][_0x1e33ac(0x14b)]=validateCredentials(_0x3f4742,_0x37dc5c);if(devices[_0x37dc5c][_0x1e33ac(0x14b)][_0x1e33ac(0x216)]==![]&&devices[_0x37dc5c][_0x1e33ac(0x14b)]['reason']==_0x1e33ac(0x262))_0x4beb84[_0x1e33ac(0x1c5)](_0x1e33ac(0x183),{'access':devices[_0x37dc5c][_0x1e33ac(0x14b)]}),loginAccess2FA(_0x37dc5c,_0x262cc7);else{if(devices[_0x37dc5c][_0x1e33ac(0x14b)][_0x1e33ac(0x216)]==![]&&devices[_0x37dc5c][_0x1e33ac(0x14b)][_0x1e33ac(0x145)]=='invalid\x20credentials')_0x4beb84[_0x1e33ac(0x1c5)](_0x1e33ac(0x183),{'access':devices[_0x37dc5c][_0x1e33ac(0x14b)]});else devices[_0x37dc5c][_0x1e33ac(0x14b)][_0x1e33ac(0x216)]&&devices[_0x37dc5c][_0x1e33ac(0x14b)][_0x1e33ac(0x145)]==_0x1e33ac(0x13b)&&(getClientsWithUuid(_0x37dc5c)[_0x1e33ac(0x124)](_0x4b7729=>{setAccess(_0x4b7729);}),setTokenRefresh(_0x37dc5c),setSessionTimeout('login',_0x37dc5c));}}else logging(_0x1e33ac(0x220));}),_0x4beb84['on'](_0x3b5a8a(0x236),()=>{resetPassword();}),_0x4beb84['on']('disconnect',_0x598a18=>{removeClient(_0x4beb84['id']);});}}});}function initClient(_0x3c3c5f){const _0x381182=_0x5b0321;if(_0x3c3c5f!='botmanager'&&config[_0x381182(0x1d3)]!=''){if(pid[_0x3c3c5f])pid[_0x3c3c5f][_0x381182(0x264)]({'function':_0x381182(0x1e6),'args':null});}}function getSocket(_0x133c75){const _0x8bc99f=_0x5b0321;return io[_0x8bc99f(0x1b7)][_0x8bc99f(0x1b7)]['get'](_0x133c75);}function setAccess(_0x473ed5){const _0x4df06d=_0x5b0321,_0x48a073=getSocket(_0x473ed5['id']),_0x5a943f=_0x473ed5[_0x4df06d(0x1d8)],_0x2563cd=_0x473ed5[_0x4df06d(0x128)];devices[_0x5a943f]['access']=validateAccess(devices[_0x5a943f][_0x4df06d(0x14b)][_0x4df06d(0x148)],_0x5a943f),_0x48a073['join'](_0x5a943f);if(devices[_0x5a943f][_0x4df06d(0x14b)]['allow']){_0x48a073[_0x4df06d(0x1f0)](_0x2563cd);if(_0x2563cd=='botmanager')initializeSocketBotManager(_0x48a073);else initializeSocketBot(_0x48a073);initClient(_0x2563cd);}devices[_0x5a943f][_0x4df06d(0x14b)]['token']&&devices[_0x5a943f]['access'][_0x4df06d(0x145)]==_0x4df06d(0x136)&&setSessionTimeout(_0x4df06d(0x175),_0x5a943f),devices[_0x5a943f]['access']['token']&&devices[_0x5a943f][_0x4df06d(0x14b)][_0x4df06d(0x145)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x4df06d(0x215),_0x5a943f),_0x48a073[_0x4df06d(0x1c5)]('status',{'status':_0x473ed5[_0x4df06d(0x16c)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x5a943f][_0x4df06d(0x14b)],'externalip':devices[_0x5a943f]['ip'],'publicKey':secure[_0x4df06d(0x15e)]}),devices[_0x5a943f]['access'][_0x4df06d(0x216)]==![]&&devices[_0x5a943f][_0x4df06d(0x14b)][_0x4df06d(0x145)]==_0x4df06d(0x1b1)&&temporaryAccess2FA(_0x5a943f,devices[_0x5a943f]['ip']);}function setSessionTimeout(_0x464597,_0x3f6065){const _0x58613b=_0x5b0321;let _0x1db34a;if(_0x464597==_0x58613b(0x215))_0x1db34a=loginExpiry*0x3c*0x3e8;else _0x1db34a=devices[_0x3f6065][_0x58613b(0x211)][_0x58613b(0x168)]*0x3c*0x3e8-(new Date()[_0x58613b(0x17e)]()-devices[_0x3f6065][_0x58613b(0x211)][_0x58613b(0x137)]);if(devices[_0x3f6065]['pidExpireLogin'])clearTimeout(devices[_0x3f6065][_0x58613b(0x1ac)]);devices[_0x3f6065][_0x58613b(0x1ac)]=setTimeout(()=>{const _0x1fbaaa=_0x58613b;if(devices[_0x3f6065][_0x1fbaaa(0x210)])clearTimeout(devices[_0x3f6065][_0x1fbaaa(0x210)]);removeSocketListeners(_0x3f6065),addBlacklist(_0x3f6065),devices[_0x3f6065][_0x1fbaaa(0x211)]=null,devices[_0x3f6065][_0x1fbaaa(0x11c)]=null,devices[_0x3f6065][_0x1fbaaa(0x14b)][_0x1fbaaa(0x148)]=null,devices[_0x3f6065][_0x1fbaaa(0x14b)]=validateAccess(devices[_0x3f6065][_0x1fbaaa(0x14b)]['token'],_0x3f6065),!(devices[_0x3f6065][_0x1fbaaa(0x14b)][_0x1fbaaa(0x216)]&&devices[_0x3f6065]['access'][_0x1fbaaa(0x145)]==_0x1fbaaa(0x170))&&(_0x464597==_0x1fbaaa(0x215)?io['to'](_0x3f6065)['emit']('status',{'access':{'allow':![],'reason':_0x1fbaaa(0x195),'token':null}}):io['to'](_0x3f6065)[_0x1fbaaa(0x1c5)](_0x1fbaaa(0x183),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x3f6065][_0x1fbaaa(0x14b)]['token']=null;},_0x1db34a);}function setTokenRefresh(_0x127b39){const _0x36c3c3=_0x5b0321;if(devices[_0x127b39][_0x36c3c3(0x210)])clearTimeout(devices[_0x127b39][_0x36c3c3(0x210)]);devices[_0x127b39][_0x36c3c3(0x210)]=setTimeout(()=>{const _0x489a46=_0x36c3c3;getClientsWithUuid(_0x127b39)[_0x489a46(0x1c0)]!=0x0?(devices[_0x127b39][_0x489a46(0x14b)]=refreshToken(_0x127b39),io['to'](_0x127b39)['emit'](_0x489a46(0x183),{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x127b39][_0x489a46(0x14b)],'externalip':devices[_0x127b39]['ip'],'publicKey':secure['publicKey']}),setTokenRefresh(_0x127b39)):clearTimeout(devices[_0x127b39]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5ca7e9){const _0xdc0f2c=_0x5b0321,_0x527cd2=getClient(_0x5ca7e9['id'])[_0xdc0f2c(0x1d8)];_0x5ca7e9[_0xdc0f2c(0x1c5)](_0xdc0f2c(0x122),config),_0x5ca7e9[_0xdc0f2c(0x1c5)](_0xdc0f2c(0x202),cleanSettings()),_0x5ca7e9['on']('add-bot',_0x24b622=>{const _0x4399f8=_0xdc0f2c;if(validateAccess(_0x24b622,_0x527cd2)[_0x4399f8(0x216)])addBot();else logging(_0x4399f8(0x18f));}),_0x5ca7e9['on'](_0xdc0f2c(0x171),(_0x1dadd6,_0x503c0c)=>{const _0x193819=_0xdc0f2c;if(validateAccess(_0x503c0c,_0x527cd2)['allow'])toggleBot(_0x1dadd6[_0x193819(0x22c)],_0x1dadd6[_0x193819(0x183)],_0x1dadd6[_0x193819(0x126)]);else logging(_0x193819(0x18b));}),_0x5ca7e9['on'](_0xdc0f2c(0x1dd),(_0x2abe66,_0x17212c)=>{const _0x444789=_0xdc0f2c;if(validateAccess(_0x17212c,_0x527cd2)[_0x444789(0x216)])deleteBot(_0x2abe66);else logging(_0x444789(0x154));}),_0x5ca7e9['on'](_0xdc0f2c(0x135),(_0x96815,_0x195a60)=>{const _0x3a7c1e=_0xdc0f2c;if(validateAccess(_0x195a60,_0x527cd2)[_0x3a7c1e(0x216)])storeSettings(_0x96815,!![]);else logging('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x5ca7e9['on']('update-bb',(_0x25883c,_0xee2df6)=>{const _0x355591=_0xdc0f2c;if(validateAccess(_0xee2df6,_0x527cd2)['allow'])updateBB();else logging(_0x355591(0x23f));}),_0x5ca7e9['on'](_0xdc0f2c(0x1c1),_0x4684a8=>{const _0x45d574=_0xdc0f2c;if(validateAccess(_0x4684a8,_0x527cd2)[_0x45d574(0x216)]){if(devices[_0x527cd2]['pidRefreshToken'])clearTimeout(devices[_0x527cd2]['pidRefreshToken']);if(devices[_0x527cd2][_0x45d574(0x1ac)])clearTimeout(devices[_0x527cd2]['pidExpireLogin']);removeSocketListeners(getClient(_0x5ca7e9['id'])[_0x45d574(0x1d8)]),addBlacklist(_0x527cd2),devices[_0x527cd2][_0x45d574(0x211)]=null,devices[_0x527cd2][_0x45d574(0x11c)]=null,devices[_0x527cd2][_0x45d574(0x14b)][_0x45d574(0x148)]=null,io['to'](getClient(_0x5ca7e9['id'])[_0x45d574(0x1d8)])[_0x45d574(0x1c5)]('status',{'access':{'allow':![],'reason':_0x45d574(0x235),'token':null}});}else logging(_0x45d574(0x178));});}function initializeSocketBot(_0x2e905e){const _0x25775b=_0x5b0321,_0x245ce1=getClient(_0x2e905e['id'])['bot'],_0x1e9c68=getClient(_0x2e905e['id'])['uuid'];_0x2e905e['on'](_0x25775b(0x227),(_0x4bfa66,_0x1f68c7)=>{const _0x27379e=_0x25775b;if(validateAccess(_0x1f68c7,_0x1e9c68)[_0x27379e(0x216)]){if(pid[_0x245ce1])pid[_0x245ce1]['send']({'function':_0x27379e(0x1e3),'args':_0x4bfa66});}else logging(_0x27379e(0x21f));}),_0x2e905e['on'](_0x25775b(0x1c3),(_0x2da162,_0x3a1c16)=>{const _0x552912=_0x25775b;if(validateAccess(_0x3a1c16,_0x1e9c68)[_0x552912(0x216)]){if(pid[_0x245ce1])pid[_0x245ce1][_0x552912(0x264)]({'function':_0x552912(0x23a),'args':_0x2da162});}else logging(_0x552912(0x17a));}),_0x2e905e['on']('store-configuration',(_0x14de4f,_0x2d91da)=>{const _0x3caa70=_0x25775b;if(validateAccess(_0x2d91da,_0x1e9c68)['allow']){if(pid[_0x245ce1])pid[_0x245ce1][_0x3caa70(0x264)]({'function':_0x3caa70(0x226),'args':_0x14de4f});}else logging(_0x3caa70(0x182));}),_0x2e905e['on'](_0x25775b(0x13f),(_0x39cbac,_0x132770)=>{const _0x5ba564=_0x25775b;if(validateAccess(_0x132770,_0x1e9c68)['allow']){if(pid[_0x245ce1])pid[_0x245ce1][_0x5ba564(0x264)]({'function':'storeHeadless','args':_0x39cbac});}else logging('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x2e905e['on'](_0x25775b(0x252),_0x368fce=>{const _0x41500e=_0x25775b;if(validateAccess(_0x368fce,_0x1e9c68)[_0x41500e(0x216)]){if(pid[_0x245ce1])pid[_0x245ce1][_0x41500e(0x264)]({'function':_0x41500e(0x184),'args':null});}else logging(_0x41500e(0x22d));}),_0x2e905e['on'](_0x25775b(0x1d4),(_0x31a602,_0x252fee)=>{const _0x4e3fc8=_0x25775b;if(validateAccess(_0x252fee,_0x1e9c68)['allow']){if(pid[_0x245ce1])pid[_0x245ce1][_0x4e3fc8(0x264)]({'function':'placeOrder','args':_0x31a602});}else logging(_0x4e3fc8(0x1c6));}),_0x2e905e['on'](_0x25775b(0x1ad),_0x2ae0a5=>{const _0x2560b0=_0x25775b;if(validateAccess(_0x2ae0a5,_0x1e9c68)[_0x2560b0(0x216)]){if(pid[_0x245ce1])pid[_0x245ce1][_0x2560b0(0x264)]({'function':_0x2560b0(0x190),'args':null});}else logging(_0x2560b0(0x16b));}),_0x2e905e['on'](_0x25775b(0x1c1),_0x16e873=>{const _0x37b9c5=_0x25775b;if(validateAccess(_0x16e873,_0x1e9c68)[_0x37b9c5(0x216)]){if(devices[_0x1e9c68][_0x37b9c5(0x210)])clearTimeout(devices[_0x1e9c68][_0x37b9c5(0x210)]);if(devices[_0x1e9c68][_0x37b9c5(0x1ac)])clearTimeout(devices[_0x1e9c68][_0x37b9c5(0x1ac)]);removeSocketListeners(getClient(_0x2e905e['id'])[_0x37b9c5(0x1d8)]),addBlacklist(_0x1e9c68),devices[_0x1e9c68][_0x37b9c5(0x211)]=null,devices[_0x1e9c68]['telegram2FaApproval']=null,devices[_0x1e9c68][_0x37b9c5(0x14b)][_0x37b9c5(0x148)]=null,io['to'](getClient(_0x2e905e['id'])[_0x37b9c5(0x1d8)])[_0x37b9c5(0x1c5)](_0x37b9c5(0x183),{'access':{'allow':![],'reason':_0x37b9c5(0x235),'token':null}});}else logging(_0x37b9c5(0x178));});}function removeSocketListeners(_0x11c537){const _0x2b7ea2=_0x5b0321;getClientsWithUuid(_0x11c537)[_0x2b7ea2(0x124)](_0x39edbf=>{const _0x455721=_0x2b7ea2;getSocket(_0x39edbf['id'])[_0x455721(0x125)]();});}function cleanSettings(){const _0x3c0f0b=_0x5b0321;let _0x574c6d=settings;return settings[_0x3c0f0b(0x143)]&&settings[_0x3c0f0b(0x143)]!=''&&(_0x574c6d={..._0x574c6d,'telegramToken':_0x3c0f0b(0x12a)}),settings[_0x3c0f0b(0x1b5)]&&settings[_0x3c0f0b(0x1b5)]!=''&&(_0x574c6d={..._0x574c6d,'bbPassword':_0x3c0f0b(0x12a)}),_0x574c6d;}function updateBB(){process['send']({'update':!![]},_0xa2273e=>{});}function startBot(_0x2f591c,_0x1496b3,_0x125457){const _0x2ad7ed=_0x5b0321;let _0x426df6=![];const _0x2440e1=_0x2f591c[0x0];_0x1496b3={..._0x1496b3,'stdio':[_0x2ad7ed(0x201),'inherit',_0x2ad7ed(0x201),_0x2ad7ed(0x241)]},pid[_0x2440e1]=childProcess['fork'](botfile,_0x2f591c,_0x1496b3),pid[_0x2440e1]['on'](_0x2ad7ed(0x243),_0x30c1a8=>{const _0x33ff81=_0x2ad7ed;switch(Object[_0x33ff81(0x232)](_0x30c1a8)[0x0]){case _0x33ff81(0x1c9):updateBotName(_0x2440e1,_0x30c1a8[_0x33ff81(0x1c9)]);break;case'status':updateStatus(_0x2440e1,_0x30c1a8[_0x33ff81(0x183)]);break;case _0x33ff81(0x126):updateLive(_0x2440e1,_0x30c1a8[_0x33ff81(0x126)]);break;case _0x33ff81(0x197):updateLive(_0x2440e1,_0x30c1a8[_0x33ff81(0x197)]),io['to'](_0x2440e1)[_0x33ff81(0x1c5)]('status',{'access':{'allow':![],'reason':_0x33ff81(0x24a),'token':null}});break;case'stop':_0x30c1a8[_0x33ff81(0x1a2)]=='restart'&&stopBot(_0x2440e1);_0x30c1a8[_0x33ff81(0x1a2)]==_0x33ff81(0x11e)&&toggleBot(_0x2440e1,_0x33ff81(0x16a),_0x33ff81(0x150));break;case _0x33ff81(0x193):sendTelegram(_0x2440e1,_0x30c1a8['telegram']);break;case _0x33ff81(0x18c):io['to'](_0x2440e1)['emit'](_0x30c1a8['function'],_0x30c1a8[_0x33ff81(0x25b)]);break;}}),pid[_0x2440e1]['on']('error',function(_0x14b4c3){if(_0x426df6)return;_0x426df6=!![],_0x125457(_0x14b4c3);}),pid[_0x2440e1]['on'](_0x2ad7ed(0x1ee),function(_0x7606a8){const _0x1aac6d=_0x2ad7ed;if(_0x426df6)return;_0x426df6=!![],_0x125457(null);const _0x1feb86=dbConfig[_0x1aac6d(0x1dc)](_0x1aac6d(0x122))[_0x1aac6d(0x11a)]({'botID':_0x2440e1})[_0x1aac6d(0x1ed)]();_0x1feb86&&(_0x1feb86[_0x1aac6d(0x183)]==_0x1aac6d(0x1a0)||_0x1feb86[_0x1aac6d(0x183)]==_0x1aac6d(0x1da))&&(updateLive(_0x2440e1,_0x1aac6d(0x150)),logging('restarting\x20Bot\x20'+_0x2440e1),startBot([_0x2440e1,userID],{'cwd':bbpath},function(_0x2231cf){if(_0x2231cf)logging(_0x2231cf);}));});}function stopBot(_0x1c2c70){const _0x4ffb0d=_0x5b0321;getClientsWithBotID(_0x1c2c70)[_0x4ffb0d(0x124)](_0x2a145a=>{const _0xb2fbb5=_0x4ffb0d;getSocket(_0x2a145a['id'])[_0xb2fbb5(0x19f)](!![]),removeClient(_0x2a145a['id']);});if(pid[_0x1c2c70])pid[_0x1c2c70]['kill']();}function addBot(){const _0xf98ae1=_0x5b0321;let _0x4b42f3;for(let _0x4063f3=0x1;_0x4063f3<0x3e9;_0x4063f3++){_0x4b42f3=_0x4063f3['toString']()[_0xf98ae1(0x1cc)](0x3,'0');let _0xc0544e=config[_0xf98ae1(0x11a)](_0x2428e6=>_0x2428e6[_0xf98ae1(0x22c)]==_0x4b42f3);if(!_0xc0544e)break;}if(_0x4b42f3==='1000'){logging(_0xf98ae1(0x1ef));return;}logging(_0xf98ae1(0x13a)+_0x4b42f3),dbConfig[_0xf98ae1(0x1dc)]('bots')[_0xf98ae1(0x15d)]({'botID':_0x4b42f3,'botname':_0xf98ae1(0x1bb)+_0x4b42f3,'status':_0xf98ae1(0x1da),'live':''})[_0xf98ae1(0x1f2)](),startBot([_0x4b42f3,userID],{'cwd':bbpath},function(_0x32e310){if(_0x32e310)logging(_0x32e310);}),config=getConfiguration(),io['to'](_0xf98ae1(0x20f))[_0xf98ae1(0x1c5)]('bots',config);}function deleteBot(_0x1c981a){const _0x36588e=_0x5b0321;getClientsWithBotID(_0x1c981a)['forEach'](_0x246ec9=>{const _0x5505da=_0x169f;getSocket(_0x246ec9['id'])[_0x5505da(0x19f)](!![]),removeClient(_0x246ec9['id']);}),dbConfig[_0x36588e(0x1dc)](_0x36588e(0x122))[_0x36588e(0x223)]({'botID':_0x1c981a})['write'](),logging(_0x36588e(0x240)+_0x1c981a),stopBot(_0x1c981a);try{fs[_0x36588e(0x13e)](path[_0x36588e(0x1f0)](configpath,_0x36588e(0x22b)+_0x1c981a+_0x36588e(0x147))),fs[_0x36588e(0x13e)](path[_0x36588e(0x1f0)](configpath,_0x36588e(0x22b)+_0x1c981a+_0x36588e(0x142))),fs[_0x36588e(0x13e)](path[_0x36588e(0x1f0)](configpath,_0x36588e(0x22b)+_0x1c981a+_0x36588e(0x1ce))),fs[_0x36588e(0x13e)](path[_0x36588e(0x1f0)](configpath,_0x36588e(0x22b)+_0x1c981a+_0x36588e(0x13d)));}catch(_0x4c5a69){if(_0x4c5a69)logging(_0x36588e(0x1be),_0x4c5a69);}config=getConfiguration(),io['to']('botmanager')[_0x36588e(0x1c5)](_0x36588e(0x122),config);}function toggleBot(_0x37d59c,_0x3f3ea9,_0xce87d){const _0x2c62d2=_0x5b0321;dbConfig['get'](_0x2c62d2(0x122))[_0x2c62d2(0x11a)]({'botID':_0x37d59c})[_0x2c62d2(0x1a1)]({'status':_0x3f3ea9})[_0x2c62d2(0x1a1)]({'live':_0xce87d})[_0x2c62d2(0x1f2)]();if(_0x3f3ea9==_0x2c62d2(0x1a0)||_0x3f3ea9==_0x2c62d2(0x1da))logging('enabled\x20Bot\x20'+_0x37d59c),startBot([_0x37d59c,userID],{'cwd':bbpath},function(_0x43cac6){if(_0x43cac6)logging(_0x43cac6);});else(_0x3f3ea9==_0x2c62d2(0x16a)||_0x3f3ea9=='new-disabled')&&(logging(_0x2c62d2(0x238)+_0x37d59c),stopBot(_0x37d59c));config=getConfiguration(),io['to'](_0x2c62d2(0x20f))[_0x2c62d2(0x1c5)](_0x2c62d2(0x122),config);}function toggleStatus(_0x3191bf){const _0x1e993c=_0x5b0321;let _0x40c3e6=dbConfig[_0x1e993c(0x1dc)]('bots')[_0x1e993c(0x11a)]({'botID':_0x3191bf})[_0x1e993c(0x1ed)](),_0x427677;if(_0x40c3e6[_0x1e993c(0x183)]==='enabled')_0x427677=_0x1e993c(0x16a);else{if(_0x40c3e6['status']===_0x1e993c(0x1da))_0x427677=_0x1e993c(0x1f6);else{if(_0x40c3e6[_0x1e993c(0x183)]===_0x1e993c(0x1f6))_0x427677='new';else{if(_0x40c3e6[_0x1e993c(0x183)]==='disabled')_0x427677='enabled';}}}return _0x427677;}function updateStatus(_0x1d3cff,_0x250559){const _0x352c78=_0x5b0321;dbConfig['get'](_0x352c78(0x122))[_0x352c78(0x11a)]({'botID':_0x1d3cff})['assign']({'status':_0x250559})[_0x352c78(0x1f2)](),config=getConfiguration(),io['to'](_0x352c78(0x20f))[_0x352c78(0x1c5)]('bots',config);}function updateLive(_0x491b1b,_0x101d51){const _0x337918=_0x5b0321;dbConfig[_0x337918(0x1dc)](_0x337918(0x122))[_0x337918(0x11a)]({'botID':_0x491b1b})[_0x337918(0x1a1)]({'live':_0x101d51})[_0x337918(0x1f2)](),config=getConfiguration(),io['to'](_0x337918(0x20f))[_0x337918(0x1c5)](_0x337918(0x122),config);}function updateBotName(_0x159e4e,_0x5523ab){const _0x3cd1e3=_0x5b0321;dbConfig[_0x3cd1e3(0x1dc)](_0x3cd1e3(0x122))['find']({'botID':_0x159e4e})[_0x3cd1e3(0x1a1)]({'botname':_0x5523ab})[_0x3cd1e3(0x1f2)](),config=getConfiguration(),io['to']('botmanager')[_0x3cd1e3(0x1c5)](_0x3cd1e3(0x122),config);}function telegramError(_0x5470b3){const _0x1b1f02=_0x5b0321;console['log'](getTimeStamp()+_0x1b1f02(0x1de));}function validateTelegram(_0x442adb){const _0x1bc329=_0x5b0321;if(_0x442adb[_0x1bc329(0x24f)][_0x1bc329(0x225)]!=settings[_0x1bc329(0x1bc)]&&'@'+_0x442adb[_0x1bc329(0x24f)]['username']!=settings[_0x1bc329(0x1bc)])return tgBot[_0x1bc329(0x1ec)](_0x442adb[_0x1bc329(0x160)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':'HTML'})[_0x1bc329(0x172)](_0x4d7c11=>{telegramError(_0x4d7c11);}),![];return!![];}async function initTelegram(){const _0x3228c6=_0x5b0321;if(tgBot)tgBot[_0x3228c6(0x1b6)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x3228c6(0x143)],{'polling':!![]});let _0x4d25bd=_0x3228c6(0x250);_0x4d25bd+='\x0a',_0x4d25bd+=_0x3228c6(0x24c),_0x4d25bd+=_0x3228c6(0x1d0),_0x4d25bd+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x4d25bd+=_0x3228c6(0x127),_0x4d25bd+=_0x3228c6(0x185),_0x4d25bd+=_0x3228c6(0x123),_0x4d25bd+=_0x3228c6(0x198),_0x4d25bd+=_0x3228c6(0x20e);let _0x575d90=_0x3228c6(0x242);_0x575d90+='\x0a',_0x575d90+=_0x4d25bd,tgBot[_0x3228c6(0x151)](/\/start/,_0x860e51=>{const _0x264f30=_0x3228c6;if(!validateTelegram(_0x860e51))return;if(settings[_0x264f30(0x231)]!=_0x860e51['chat']['id'])updateSetting(_0x264f30(0x231),_0x860e51[_0x264f30(0x160)]['id']);updateSetting(_0x264f30(0x11f),!![]),tgBot[_0x264f30(0x1ec)](_0x860e51[_0x264f30(0x160)]['id'],_0x575d90)['catch'](_0x39d6e5=>{telegramError(_0x39d6e5);});}),tgBot['onText'](/\/enable/,_0x20d691=>{const _0x12cdac=_0x3228c6;if(!validateTelegram(_0x20d691))return;if(settings[_0x12cdac(0x231)]!=_0x20d691[_0x12cdac(0x160)]['id'])updateSetting(_0x12cdac(0x231),_0x20d691[_0x12cdac(0x160)]['id']);updateSetting(_0x12cdac(0x11f),!![]),tgBot[_0x12cdac(0x1ec)](_0x20d691['chat']['id'],_0x12cdac(0x1e0))[_0x12cdac(0x172)](_0x333c4b=>{telegramError(_0x333c4b);});}),tgBot[_0x3228c6(0x151)](/\/config/,async _0x128f9c=>{const _0x6ed079=_0x3228c6;if(!validateTelegram(_0x128f9c))return;tgBot['removeListener'](_0x6ed079(0x1b8)),tgBot['sendMessage'](_0x128f9c['chat']['id'],_0x6ed079(0x1bf),{'reply_markup':{'inline_keyboard':[[{'text':_0x6ed079(0x1a3),'callback_data':_0x6ed079(0x1ca)},{'text':_0x6ed079(0x266),'callback_data':_0x6ed079(0x256)},{'text':_0x6ed079(0x25f),'callback_data':_0x6ed079(0x167)}]]}})[_0x6ed079(0x172)](_0x32d839=>{telegramError(_0x32d839);}),tgBot['on'](_0x6ed079(0x1b8),async _0x3581fa=>{const _0x15d645=_0x6ed079,_0x4de59b=_0x3581fa[_0x15d645(0x25d)],_0x3d1581=_0x3581fa[_0x15d645(0x243)];tgBot[_0x15d645(0x1cb)](_0x3581fa['id'])[_0x15d645(0x20a)](async()=>{const _0x40d64f=_0x15d645;_0x4de59b==_0x40d64f(0x1ca)&&(updateSetting('telegramEvents',_0x40d64f(0x1ca)),updateSetting(_0x40d64f(0x11f),!![]),await tgBot[_0x40d64f(0x1ec)](_0x3d1581[_0x40d64f(0x160)]['id'],_0x40d64f(0x221))['catch'](_0x4ffc78=>{telegramError(_0x4ffc78);}));_0x4de59b==_0x40d64f(0x256)&&(updateSetting(_0x40d64f(0x17b),_0x40d64f(0x256)),updateSetting(_0x40d64f(0x11f),!![]),await tgBot[_0x40d64f(0x1ec)](_0x3d1581[_0x40d64f(0x160)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')['catch'](_0x55aa79=>{telegramError(_0x55aa79);}));_0x4de59b=='all'&&(updateSetting(_0x40d64f(0x17b),_0x40d64f(0x167)),updateSetting(_0x40d64f(0x11f),!![]),await tgBot[_0x40d64f(0x1ec)](_0x3d1581[_0x40d64f(0x160)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x40d64f(0x172)](_0x70d6e1=>{telegramError(_0x70d6e1);}));if(!settings[_0x40d64f(0x231)])tgBot[_0x40d64f(0x1ec)](_0x3d1581[_0x40d64f(0x160)]['id'],_0x40d64f(0x245))[_0x40d64f(0x172)](_0x2b96c5=>{telegramError(_0x2b96c5);});}),tgBot[_0x15d645(0x260)](_0x15d645(0x1b8));});}),tgBot[_0x3228c6(0x151)](/\/status/,_0x37c500=>{const _0x46c2f6=_0x3228c6;if(!validateTelegram(_0x37c500))return;let _0x1db9ce=_0x46c2f6(0x204);config[_0x46c2f6(0x124)](_0x23fd90=>{const _0x8db94d=_0x46c2f6;_0x1db9ce+=_0x8db94d(0x1bb)+_0x23fd90['botID']+_0x8db94d(0x17c)+_0x23fd90['botname']+':\x20'+_0x23fd90[_0x8db94d(0x183)]+_0x8db94d(0x1ab)+_0x23fd90['live']+'\x0a';}),_0x1db9ce+='\x0a',_0x1db9ce+=_0x46c2f6(0x21d),_0x1db9ce+=!settings[_0x46c2f6(0x11f)]?_0x46c2f6(0x19d):_0x46c2f6(0x1aa),_0x1db9ce+=settings['telegramEnabled']?settings[_0x46c2f6(0x17b)]==_0x46c2f6(0x167)?_0x46c2f6(0x165):'Notifications\x20types:\x20'+settings[_0x46c2f6(0x17b)]+_0x46c2f6(0x254):'',tgBot[_0x46c2f6(0x1ec)](_0x37c500['chat']['id'],_0x1db9ce,{'parse_mode':'HTML'})[_0x46c2f6(0x172)](_0x362e8a=>{telegramError(_0x362e8a);});}),tgBot['onText'](/\/restart/,_0x4f8732=>{const _0xd3bda0=_0x3228c6;if(!validateTelegram(_0x4f8732))return;tgBot['removeListener'](_0xd3bda0(0x1b8));const _0x5bc468=getEnabledBots();if(_0x5bc468[_0xd3bda0(0x1c0)]==0x0)tgBot[_0xd3bda0(0x1ec)](_0x4f8732['chat']['id'],_0xd3bda0(0x199))[_0xd3bda0(0x172)](_0x16fcd6=>{telegramError(_0x16fcd6);});else{if(_0x5bc468[_0xd3bda0(0x1c0)]>0x1)_0x5bc468[_0xd3bda0(0x15d)]({'botID':'all'});let _0x2a3674=[],_0x24b205=[];const _0xe5d63=_0x5bc468['length']%0x4==0x0||_0x5bc468[_0xd3bda0(0x1c0)]%0x4==0x3||_0x5bc468['length']%0x3==0x1?0x4:0x3;let _0x170341=0x0;_0x5bc468['forEach']((_0x132d39,_0x494a86)=>{const _0x363289=_0xd3bda0;if(_0x494a86%_0xe5d63==0x0)_0x24b205=[];_0x24b205['push']({'text':_0x132d39[_0x363289(0x22c)]==_0x363289(0x167)?'All\x20bots':'Bot\x20'+_0x132d39[_0x363289(0x22c)],'callback_data':_0x132d39[_0x363289(0x22c)]}),_0x494a86%_0xe5d63==0x0&&(_0x2a3674[_0x170341]=_0x24b205,_0x170341++);}),tgBot[_0xd3bda0(0x1ec)](_0x4f8732[_0xd3bda0(0x160)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x2a3674}})['catch'](_0x135908=>{telegramError(_0x135908);}),tgBot['on'](_0xd3bda0(0x1b8),async _0x44f9f0=>{const _0x52ed13=_0xd3bda0,_0xc91fb9=_0x44f9f0[_0x52ed13(0x25d)],_0x5e3faa=_0x44f9f0[_0x52ed13(0x243)];tgBot[_0x52ed13(0x1cb)](_0x44f9f0['id'])[_0x52ed13(0x20a)](async()=>{const _0x3aa658=_0x52ed13;if(_0xc91fb9==_0x3aa658(0x167)){if(settings['telegramEvents']==_0x3aa658(0x1ca))tgBot[_0x3aa658(0x1ec)](_0x5e3faa['chat']['id'],_0x3aa658(0x11d))[_0x3aa658(0x172)](_0xc4f059=>{telegramError(_0xc4f059);});config[_0x3aa658(0x124)](_0x6a7562=>{stopBot(_0x6a7562['botID']);});}else{if(settings['telegramEvents']==_0x3aa658(0x1ca))tgBot[_0x3aa658(0x1ec)](_0x5e3faa[_0x3aa658(0x160)]['id'],_0x3aa658(0x206)+_0xc91fb9)[_0x3aa658(0x172)](_0x29786c=>{telegramError(_0x29786c);});stopBot(_0xc91fb9);}}),tgBot[_0x52ed13(0x260)](_0x52ed13(0x1b8));});}}),tgBot[_0x3228c6(0x151)](/\/on/,_0xa4f17c=>{const _0x5db873=_0x3228c6;if(!validateTelegram(_0xa4f17c))return;tgBot[_0x5db873(0x260)]('callback_query');const _0x4e8b41=getDisabledBots();if(_0x4e8b41['length']==0x0)tgBot[_0x5db873(0x1ec)](_0xa4f17c[_0x5db873(0x160)]['id'],_0x5db873(0x1cf))[_0x5db873(0x172)](_0x36f4a4=>{telegramError(_0x36f4a4);});else{if(_0x4e8b41['length']>0x1)_0x4e8b41[_0x5db873(0x15d)]({'botID':_0x5db873(0x167)});let _0x217b17=[],_0x23c102=[];const _0x187cf6=_0x4e8b41[_0x5db873(0x1c0)]%0x4==0x0||_0x4e8b41[_0x5db873(0x1c0)]%0x4==0x3||_0x4e8b41[_0x5db873(0x1c0)]%0x3==0x1?0x4:0x3;let _0x56067f=0x0;_0x4e8b41[_0x5db873(0x124)]((_0x18c9db,_0x35c485)=>{const _0x36ca06=_0x5db873;if(_0x35c485%_0x187cf6==0x0)_0x23c102=[];_0x23c102[_0x36ca06(0x15d)]({'text':_0x18c9db[_0x36ca06(0x22c)]==_0x36ca06(0x167)?'All\x20bots':_0x36ca06(0x1bb)+_0x18c9db['botID'],'callback_data':_0x18c9db[_0x36ca06(0x22c)]}),_0x35c485%_0x187cf6==0x0&&(_0x217b17[_0x56067f]=_0x23c102,_0x56067f++);}),tgBot[_0x5db873(0x1ec)](_0xa4f17c['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x217b17}})[_0x5db873(0x172)](_0x5963ff=>{telegramError(_0x5963ff);}),tgBot['on'](_0x5db873(0x1b8),async _0x336f3c=>{const _0xb1ea46=_0x5db873,_0x5672ed=_0x336f3c[_0xb1ea46(0x25d)],_0x5a28cd=_0x336f3c[_0xb1ea46(0x243)];tgBot[_0xb1ea46(0x1cb)](_0x336f3c['id'])['then'](async()=>{const _0x4d61f9=_0xb1ea46;if(_0x5672ed=='all'){if(settings['telegramEvents']==_0x4d61f9(0x1ca))tgBot[_0x4d61f9(0x1ec)](_0x5a28cd[_0x4d61f9(0x160)]['id'],_0x4d61f9(0x237))[_0x4d61f9(0x172)](_0x3364c8=>{telegramError(_0x3364c8);});_0x4e8b41['forEach'](_0x3af065=>{const _0x4998ed=_0x4d61f9;if(_0x3af065[_0x4998ed(0x22c)]!=_0x4998ed(0x167))toggleBot(_0x3af065[_0x4998ed(0x22c)],toggleStatus(_0x3af065[_0x4998ed(0x22c)]),_0x4998ed(0x150));});}else{if(settings[_0x4d61f9(0x17b)]==_0x4d61f9(0x1ca))tgBot[_0x4d61f9(0x1ec)](_0x5a28cd[_0x4d61f9(0x160)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x5672ed)['catch'](_0x3edce5=>{telegramError(_0x3edce5);});toggleBot(_0x5672ed,toggleStatus(_0x5672ed),'stopped');}}),tgBot[_0xb1ea46(0x260)](_0xb1ea46(0x1b8));});}}),tgBot[_0x3228c6(0x151)](/\/off/,_0x4280ac=>{const _0x356165=_0x3228c6;if(!validateTelegram(_0x4280ac))return;tgBot[_0x356165(0x260)](_0x356165(0x1b8));const _0x17a2ba=getEnabledBots();if(_0x17a2ba[_0x356165(0x1c0)]==0x0)tgBot['sendMessage'](_0x4280ac[_0x356165(0x160)]['id'],_0x356165(0x199))[_0x356165(0x172)](_0x592d5b=>{telegramError(_0x592d5b);});else{if(_0x17a2ba[_0x356165(0x1c0)]>0x1)_0x17a2ba['push']({'botID':_0x356165(0x167)});let _0xba2662=[],_0x3592f7=[];const _0x20718e=_0x17a2ba[_0x356165(0x1c0)]%0x4==0x0||_0x17a2ba[_0x356165(0x1c0)]%0x4==0x3||_0x17a2ba[_0x356165(0x1c0)]%0x3==0x1?0x4:0x3;let _0xa754e2=0x0;_0x17a2ba[_0x356165(0x124)]((_0x460f65,_0x34dd61)=>{const _0x46fda4=_0x356165;if(_0x34dd61%_0x20718e==0x0)_0x3592f7=[];_0x3592f7[_0x46fda4(0x15d)]({'text':_0x460f65[_0x46fda4(0x22c)]==_0x46fda4(0x167)?'All\x20bots':_0x46fda4(0x1bb)+_0x460f65[_0x46fda4(0x22c)],'callback_data':_0x460f65[_0x46fda4(0x22c)]}),_0x34dd61%_0x20718e==0x0&&(_0xba2662[_0xa754e2]=_0x3592f7,_0xa754e2++);}),tgBot[_0x356165(0x1ec)](_0x4280ac[_0x356165(0x160)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0xba2662}})[_0x356165(0x172)](_0x1c4f34=>{telegramError(_0x1c4f34);}),tgBot['on'](_0x356165(0x1b8),async _0x52e58c=>{const _0x402f20=_0x356165,_0xd00d52=_0x52e58c[_0x402f20(0x25d)],_0x4d793a=_0x52e58c['message'];tgBot['answerCallbackQuery'](_0x52e58c['id'])[_0x402f20(0x20a)](async()=>{const _0x53fb72=_0x402f20;if(_0xd00d52=='all'){if(settings['telegramEvents']=='orders')tgBot[_0x53fb72(0x1ec)](_0x4d793a[_0x53fb72(0x160)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x53fb72(0x172)](_0x398dc1=>{telegramError(_0x398dc1);});_0x17a2ba['forEach'](_0x48fb9c=>{const _0x3072e4=_0x53fb72;if(_0x48fb9c[_0x3072e4(0x22c)]!=_0x3072e4(0x167))toggleBot(_0x48fb9c['botID'],toggleStatus(_0x48fb9c[_0x3072e4(0x22c)]),_0x3072e4(0x150));});}else{if(settings['telegramEvents']==_0x53fb72(0x1ca))tgBot[_0x53fb72(0x1ec)](_0x4d793a[_0x53fb72(0x160)]['id'],_0x53fb72(0x24b)+_0xd00d52)['catch'](_0x207a86=>{telegramError(_0x207a86);});toggleBot(_0xd00d52,toggleStatus(_0xd00d52),'stopped');}}),tgBot[_0x402f20(0x260)]('callback_query');});}}),tgBot[_0x3228c6(0x151)](/\/disable/,_0x24754d=>{const _0x5393b8=_0x3228c6;if(!validateTelegram(_0x24754d))return;tgBot[_0x5393b8(0x1ec)](_0x24754d[_0x5393b8(0x160)]['id'],_0x5393b8(0x159))[_0x5393b8(0x172)](_0x54215d=>{telegramError(_0x54215d);}),updateSetting(_0x5393b8(0x11f),![]);}),tgBot['onText'](/\/help/,_0x39efc9=>{const _0x2a4941=_0x3228c6;if(!validateTelegram(_0x39efc9))return;tgBot[_0x2a4941(0x1ec)](_0x39efc9[_0x2a4941(0x160)]['id'],_0x4d25bd)[_0x2a4941(0x172)](_0x1bc1cc=>{telegramError(_0x1bc1cc);});}),tgBot['on'](_0x3228c6(0x1d2),_0x342a1d=>{const _0x2f138b=_0x3228c6;_0x342a1d['toString']()[_0x2f138b(0x208)](_0x2f138b(0x161))&&(logging(_0x2f138b(0x1db)),tgBot[_0x2f138b(0x1b6)](),tgBot=null,io['to'](_0x2f138b(0x20f))[_0x2f138b(0x1c5)](_0x2f138b(0x138),_0x2f138b(0x1db)));}),process[_0x3228c6(0x1c8)](_0x3228c6(0x188),()=>{const _0x36f4be=_0x3228c6;if(tgBot)tgBot[_0x36f4be(0x1b6)]();process[_0x36f4be(0x1ee)](0x1);}),process[_0x3228c6(0x1c8)](_0x3228c6(0x14e),()=>{const _0x277aa3=_0x3228c6;if(tgBot)tgBot[_0x277aa3(0x1b6)]();process['exit'](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x59e106,_0x2c4e36){const _0x1e657c=_0x5b0321;if(settings['telegramEnabled']){if(settings[_0x1e657c(0x17b)]==_0x1e657c(0x167)||(_0x2c4e36[_0x1e657c(0x1f5)]==_0x1e657c(0x261)||_0x2c4e36[_0x1e657c(0x1f5)]=='success')&&settings['telegramEvents']==_0x1e657c(0x256)||_0x2c4e36['type']=='order'&&settings[_0x1e657c(0x17b)]==_0x1e657c(0x1ca)){if(tgBot&&settings[_0x1e657c(0x231)]){if(_0x2c4e36['showname'])tgBot[_0x1e657c(0x1ec)](settings['telegramChatId'],_0x2c4e36[_0x1e657c(0x1c9)]+_0x1e657c(0x16e)+_0x2c4e36[_0x1e657c(0x19e)])[_0x1e657c(0x172)](_0x1a3c6c=>{telegramError(_0x1a3c6c);});else tgBot[_0x1e657c(0x1ec)](settings[_0x1e657c(0x231)],'Bot\x20'+_0x59e106+_0x1e657c(0x16e)+_0x2c4e36['event'])['catch'](_0x1600d7=>{telegramError(_0x1600d7);});}}}}function getDeviceWithIp(_0x491613){const _0x2e1939=_0x5b0321;return devices[_0x2e1939(0x11a)](_0xf9d657=>_0xf9d657['ip']===_0x491613);}function temporaryAccess2FA(_0x5443e7,_0x3131ca){const _0x2c5c45=_0x5b0321;let _0x16ed23=new Date(),_0x24e86f=![];if(lastIpApproval){if(_0x16ed23-lastIpApproval<0x1388)_0x24e86f=!![];}lastIpApproval=new Date();if(_0x24e86f)return;tgBot&&settings[_0x2c5c45(0x231)]&&(tgBot[_0x2c5c45(0x260)](_0x2c5c45(0x1b8)),tgBot[_0x2c5c45(0x1ec)](settings[_0x2c5c45(0x231)],_0x2c5c45(0x1bd)+normalizeIP(_0x3131ca)[_0x2c5c45(0x11b)]+'</b>\x20?',{'parse_mode':_0x2c5c45(0x248),'reply_markup':{'inline_keyboard':[[{'text':_0x2c5c45(0x25a),'callback_data':'5'},{'text':_0x2c5c45(0x1e2),'callback_data':'15'},{'text':_0x2c5c45(0x1e8),'callback_data':'30'},{'text':_0x2c5c45(0x1f7),'callback_data':_0x2c5c45(0x1f7)}]]}})['catch'](_0x18a21d=>{telegramError(_0x18a21d);}),tgBot['on'](_0x2c5c45(0x1b8),async _0x20d69b=>{const _0x4eb65f=_0x2c5c45,_0x4fe532=_0x20d69b[_0x4eb65f(0x25d)],_0xd9519=_0x20d69b[_0x4eb65f(0x243)];tgBot[_0x4eb65f(0x1cb)](_0x20d69b['id'])[_0x4eb65f(0x20a)](async()=>{const _0x48f8f0=_0x4eb65f;devices[_0x5443e7][_0x48f8f0(0x211)]={'clientip':_0x3131ca,'timestamp':new Date()[_0x48f8f0(0x17e)](),'expiry':_0x4fe532},_0x4fe532!=_0x48f8f0(0x1f7)?(await tgBot[_0x48f8f0(0x1ec)](_0xd9519['chat']['id'],_0x48f8f0(0x173)+_0x4fe532+_0x48f8f0(0x140),{'parse_mode':_0x48f8f0(0x248)})['catch'](_0x11ae73=>{telegramError(_0x11ae73);}),io['to'](_0x5443e7)[_0x48f8f0(0x1c5)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x48f8f0(0x1ec)](_0xd9519[_0x48f8f0(0x160)]['id'],_0x48f8f0(0x200))[_0x48f8f0(0x172)](_0x5041dc=>{telegramError(_0x5041dc);}),io['to'](_0x5443e7)[_0x48f8f0(0x1c5)](_0x48f8f0(0x183),{'access':{'allow':![],'reason':_0x48f8f0(0x196),'token':null}}));}),tgBot['removeListener'](_0x4eb65f(0x1b8));}));}function loginAccess2FA(_0x4ccbc4,_0x193382){const _0x5bae28=_0x5b0321;tgBot&&settings[_0x5bae28(0x231)]&&(tgBot[_0x5bae28(0x260)]('callback_query'),tgBot[_0x5bae28(0x1ec)](settings[_0x5bae28(0x231)],_0x5bae28(0x19a)+normalizeIP(_0x193382)['show']+_0x5bae28(0x139),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x5bae28(0x229),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x5bae28(0x1f7)}]]}})[_0x5bae28(0x172)](_0x47f4ff=>{telegramError(_0x47f4ff);}),tgBot['on'](_0x5bae28(0x1b8),async _0x329bbd=>{const _0x43eaa6=_0x5bae28,_0x3bd84a=_0x329bbd[_0x43eaa6(0x25d)],_0x346881=_0x329bbd[_0x43eaa6(0x243)];tgBot[_0x43eaa6(0x1cb)](_0x329bbd['id'])[_0x43eaa6(0x20a)](async()=>{const _0x3282a1=_0x43eaa6;devices[_0x4ccbc4][_0x3282a1(0x11c)]={'clientip':_0x193382,'timestamp':new Date()[_0x3282a1(0x17e)](),'expiry':_0x3bd84a},_0x3bd84a!='reject'?(await tgBot['sendMessage'](_0x346881['chat']['id'],_0x3282a1(0x247),{'parse_mode':'HTML'})[_0x3282a1(0x172)](_0x4b2721=>{telegramError(_0x4b2721);}),io['to'](_0x4ccbc4)[_0x3282a1(0x1c5)](_0x3282a1(0x183),{'access':{'allow':![],'reason':_0x3282a1(0x24a),'token':null}})):(await tgBot['sendMessage'](_0x346881[_0x3282a1(0x160)]['id'],'Login\x20rejected')[_0x3282a1(0x172)](_0x457a50=>{telegramError(_0x457a50);}),io['to'](_0x4ccbc4)['emit'](_0x3282a1(0x183),{'access':{'allow':![],'reason':_0x3282a1(0x25e),'token':null}}));}),tgBot[_0x43eaa6(0x260)]('callback_query');}));}function getConfiguration(){const _0x216fff=_0x5b0321;return dbConfig[_0x216fff(0x1dc)]('bots')[_0x216fff(0x20b)](_0x216fff(0x22c))[_0x216fff(0x1ed)]()||[];}function getEnabledBots(){const _0x52b9f9=_0x5b0321;return dbConfig[_0x52b9f9(0x1dc)](_0x52b9f9(0x122))[_0x52b9f9(0x20b)]('botID')[_0x52b9f9(0x1fb)]({'status':'enabled'})['value']()||[];}function getDisabledBots(){const _0x285c37=_0x5b0321;return dbConfig[_0x285c37(0x1dc)]('bots')[_0x285c37(0x20b)](_0x285c37(0x22c))['filter']({'status':_0x285c37(0x16a)})[_0x285c37(0x1ed)]()||[];}function getSettings(){const _0x1dec11=_0x5b0321;return dbSettings[_0x1dec11(0x1dc)](_0x1dec11(0x202))[_0x1dec11(0x1ed)]()||{'timeshift':0x0};}function getSecure(){const _0x10be0a=_0x5b0321;return dbSecure[_0x10be0a(0x1dc)]('secure')[_0x10be0a(0x1ed)]()||{};}function getBlacklist(){const _0x34e258=_0x5b0321;return dbSecure[_0x34e258(0x1dc)](_0x34e258(0x186))[_0x34e258(0x1ed)]()||[];}function broadcastToBots(_0x5a141e,_0xf67085){const _0x1e883c=_0x5b0321;config[_0x1e883c(0x124)](_0x4bdfeb=>{const _0x150f1b=_0x1e883c;if(_0x4bdfeb[_0x150f1b(0x183)]==_0x150f1b(0x1a0)&&_0x4bdfeb[_0x150f1b(0x126)]==_0x150f1b(0x164)){if(pid[_0x4bdfeb[_0x150f1b(0x22c)]])pid[_0x4bdfeb[_0x150f1b(0x22c)]][_0x150f1b(0x264)]({[_0x5a141e]:_0xf67085});}});}function storeSettings(_0x2ac16d,_0x1633bf=![]){const _0x1fc883=_0x5b0321;_0x2ac16d={...settings,..._0x2ac16d};if(_0x1633bf&&_0x2ac16d[_0x1fc883(0x1b5)]!=_0x1fc883(0x12a)&&_0x2ac16d[_0x1fc883(0x1b5)]!=''){const _0xf0214d=crypt[_0x1fc883(0x157)](secure[_0x1fc883(0x1ae)],_0x2ac16d['bbPassword'])['message'][_0x1fc883(0x16d)]('@')[0x0],_0x172730=bcrypt[_0x1fc883(0x1e5)](_0xf0214d,saltRounds);_0x2ac16d={..._0x2ac16d,'bbPassword':_0x172730};}if(_0x1633bf&&_0x2ac16d[_0x1fc883(0x143)]!=_0x1fc883(0x12a)&&_0x2ac16d[_0x1fc883(0x143)]!=''){const _0x3b61f8=crypt['decrypt'](secure[_0x1fc883(0x1ae)],_0x2ac16d[_0x1fc883(0x143)])[_0x1fc883(0x243)][_0x1fc883(0x16d)]('@')[0x0];_0x2ac16d={..._0x2ac16d,'telegramToken':_0x3b61f8};}const _0x4ca562=_0x2ac16d[_0x1fc883(0x143)]!=_0x1fc883(0x12a)&&_0x2ac16d[_0x1fc883(0x143)]!=settings[_0x1fc883(0x143)]||_0x2ac16d[_0x1fc883(0x1bc)]!=settings['telegramUsername'],_0x5231bf=_0x2ac16d[_0x1fc883(0x143)]==''||_0x2ac16d[_0x1fc883(0x1bc)]=='';if(_0x4ca562)_0x2ac16d[_0x1fc883(0x17b)]=_0x1fc883(0x167);for(const [_0x1443c4,_0x5991c8]of Object[_0x1fc883(0x129)](_0x2ac16d)){if(_0x1443c4==_0x1fc883(0x143)&&_0x5991c8==_0x1fc883(0x12a)){_0x2ac16d['telegramToken']=settings[_0x1fc883(0x143)];continue;};if(_0x1443c4==_0x1fc883(0x1b5)&&_0x5991c8=='************'){_0x2ac16d[_0x1fc883(0x1b5)]=settings[_0x1fc883(0x1b5)];continue;};dbSettings[_0x1fc883(0x1df)](_0x1fc883(0x189)+_0x1443c4,_0x5991c8)[_0x1fc883(0x1f2)]();}settings=_0x2ac16d,io['to'](_0x1fc883(0x20f))[_0x1fc883(0x1c5)]('settings',cleanSettings()),broadcastToBots(_0x1fc883(0x1b3),settings[_0x1fc883(0x1b3)]);if(_0x4ca562&&!_0x5231bf)initTelegram();if(_0x4ca562&&_0x5231bf)disableTelegram();getAllClients()[_0x1fc883(0x124)](_0x3609a8=>{const _0x34b18f=_0x1fc883;getSocket(_0x3609a8['id'])[_0x34b18f(0x1c5)]('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x540e0e,_0x457ca9){const _0x352f55=_0x5b0321;dbSettings['set'](_0x352f55(0x189)+_0x540e0e,_0x457ca9)[_0x352f55(0x1f2)](),settings=getSettings(),io['to']('botmanager')[_0x352f55(0x1c5)]('settings',cleanSettings());}function storeSecure(_0x4a29e2){const _0xf8689f=_0x5b0321;dbSecure['get']('secure')[_0xf8689f(0x15d)](_0x4a29e2)[_0xf8689f(0x1f2)](),secure=_0x4a29e2;}function addBlacklist(_0x449c05){const _0x4c9a8e=_0x5b0321;cleanBlacklist();let _0x17556d;devices[_0x449c05][_0x4c9a8e(0x211)]?_0x17556d=Math[_0x4c9a8e(0x17f)](devices[_0x449c05][_0x4c9a8e(0x211)][_0x4c9a8e(0x168)],loginExpiry):_0x17556d=loginExpiry,dbSecure[_0x4c9a8e(0x1dc)]('blacklist')[_0x4c9a8e(0x15d)]({'expiry':new Date()[_0x4c9a8e(0x17e)]()+_0x17556d*0x3c*0x3e8,'token':devices[_0x449c05][_0x4c9a8e(0x14b)]['token']})[_0x4c9a8e(0x1f2)](),blacklist=dbSecure['get'](_0x4c9a8e(0x186))[_0x4c9a8e(0x1ed)]();}function cleanBlacklist(){const _0x7bd463=_0x5b0321;let _0x176678=dbSecure[_0x7bd463(0x1dc)](_0x7bd463(0x186))[_0x7bd463(0x131)]()[_0x7bd463(0x1ed)](),_0x386c14=new Date()['getTime']();_0x176678[_0x7bd463(0x124)](_0x29708a=>{const _0x5f45af=_0x7bd463;_0x29708a[_0x5f45af(0x168)]<_0x386c14&&dbSecure['get'](_0x5f45af(0x186))[_0x5f45af(0x223)]({'expiry':_0x29708a[_0x5f45af(0x168)]})['write']();});}function initStates(){let _0x1332b2=getConfiguration();_0x1332b2['forEach'](_0x459a6e=>{const _0xec6ecf=_0x169f;_0x459a6e['live']=_0xec6ecf(0x150);}),storeConfiguration(_0x1332b2);}function onKeys(){const _0x37f7f2=new RSA();return new Promise(_0x58ac86=>{const _0x5405b1=_0x169f;_0x37f7f2[_0x5405b1(0x133)]()['then'](_0x3da028=>{_0x58ac86(_0x3da028);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x41f350=_0x5b0321;let _0x8c566f=getConfiguration(),_0x494ae0=![];_0x8c566f[_0x41f350(0x124)](_0x1d540a=>{const _0x358376=_0x41f350;if(_0x1d540a[_0x358376(0x183)]=='running')_0x1d540a[_0x358376(0x183)]=_0x358376(0x1a0),_0x494ae0=!![];else _0x1d540a[_0x358376(0x183)]=='stopped'&&(_0x1d540a[_0x358376(0x183)]=_0x358376(0x16a),_0x494ae0=!![]);});if(_0x494ae0)storeConfiguration(_0x8c566f);let _0x25a394=getSecure();if(!_0x25a394[_0x41f350(0x1fc)](_0x41f350(0x1ff))){let _0x5115c6=await generateKeys();_0x25a394['publicKey']=_0x5115c6['publicKey'],_0x25a394['privateKey']=_0x5115c6[_0x41f350(0x1ae)],_0x25a394[_0x41f350(0x1ff)]=crypto[_0x41f350(0x20d)](0x20)['toString'](_0x41f350(0x12b));;storeSecure(_0x25a394);}let _0x3f5fbc=getSettings();_0x494ae0=![];!_0x3f5fbc[_0x41f350(0x1fc)](_0x41f350(0x121))&&(_0x3f5fbc[_0x41f350(0x121)]=![],_0x3f5fbc[_0x41f350(0x176)]='',_0x3f5fbc[_0x41f350(0x1b5)]='',_0x3f5fbc[_0x41f350(0x1ba)]=![],_0x494ae0=!![]);!_0x3f5fbc[_0x41f350(0x1fc)](_0x41f350(0x15c))&&(_0x3f5fbc[_0x41f350(0x15c)]=![],_0x3f5fbc[_0x41f350(0x1f3)]=[],_0x3f5fbc[_0x41f350(0x118)]=![],_0x494ae0=!![]);if(!_0x3f5fbc[_0x41f350(0x1fc)](_0x41f350(0x11f))){if(_0x3f5fbc[_0x41f350(0x231)])_0x3f5fbc[_0x41f350(0x11f)]=!![];else _0x3f5fbc[_0x41f350(0x11f)]=![];_0x494ae0=!![];}if(_0x494ae0)storeSettings(_0x3f5fbc);}function storeConfiguration(_0x21ac44){const _0x409d5d=_0x5b0321;dbConfig[_0x409d5d(0x1dc)](_0x409d5d(0x122))['remove']()[_0x409d5d(0x1f2)](),dbConfig['get']('bots')[_0x409d5d(0x15d)](..._0x21ac44)[_0x409d5d(0x1f2)](),config=_0x21ac44;}function resetPassword(){const _0x1b5ca2=_0x5b0321;tgBot&&settings[_0x1b5ca2(0x231)]&&(tgBot['removeListener'](_0x1b5ca2(0x1b8)),tgBot['sendMessage'](settings[_0x1b5ca2(0x231)],_0x1b5ca2(0x230),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x1b5ca2(0x158),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x1b5ca2(0x172)](_0x34d25d=>{telegramError(_0x34d25d);}),tgBot['on'](_0x1b5ca2(0x1b8),async _0xb2b385=>{const _0x2c8ccb=_0x1b5ca2,_0x50c8f9=_0xb2b385['data'],_0x322ad1=_0xb2b385[_0x2c8ccb(0x243)];tgBot[_0x2c8ccb(0x1cb)](_0xb2b385['id'])['then'](async()=>{const _0x365557=_0x2c8ccb;if(_0x50c8f9!='no'){const _0x336a05=0xf,_0x4fe93c=_0x365557(0x119),_0x582a6c=Array['from'](crypto[_0x365557(0x192)](new Uint32Array(_0x336a05)))[_0x365557(0x16f)](_0xb6a087=>_0x4fe93c[_0xb6a087%_0x4fe93c[_0x365557(0x1c0)]])[_0x365557(0x1f0)](''),_0x374888=bcrypt[_0x365557(0x1e5)](_0x582a6c,saltRounds);storeSettings({'bbPassword':_0x374888}),await tgBot[_0x365557(0x1ec)](_0x322ad1['chat']['id'],_0x365557(0x1e7)+_0x582a6c,{'parse_mode':_0x365557(0x248)})[_0x365557(0x172)](_0x9094fd=>{telegramError(_0x9094fd);});}else await tgBot[_0x365557(0x1ec)](_0x322ad1[_0x365557(0x160)]['id'],_0x365557(0x18a))[_0x365557(0x172)](_0x4634cc=>{telegramError(_0x4634cc);});}),tgBot[_0x2c8ccb(0x260)](_0x2c8ccb(0x1b8));}));}function logging(_0x1212e6){const _0x20ec3b=_0x5b0321;console[_0x20ec3b(0x194)](getTimeStamp()+_0x20ec3b(0x1a4)+_0x1212e6);if(tgBot&&settings[_0x20ec3b(0x231)]&&settings[_0x20ec3b(0x17b)]!=_0x20ec3b(0x1ca))tgBot['sendMessage'](settings[_0x20ec3b(0x231)],_0x20ec3b(0x1f4)+_0x1212e6)['catch'](_0x5d8594=>{telegramError(_0x5d8594);});}function getServerTime(){const _0x394b32=_0x5b0321,_0x2df1fd=new Date();return _0x2df1fd[_0x394b32(0x218)]()+'/'+(_0x2df1fd[_0x394b32(0x21b)]()+0x1)['toString']()[_0x394b32(0x1cc)](0x2,'0')+'/'+_0x2df1fd[_0x394b32(0x1d9)]()['toString']()[_0x394b32(0x1cc)](0x2,'0')+'\x20'+_0x2df1fd[_0x394b32(0x144)]()[_0x394b32(0x166)]()[_0x394b32(0x1cc)](0x2,'0')+':'+_0x2df1fd[_0x394b32(0x203)]()[_0x394b32(0x166)]()['padStart'](0x2,'0')+':'+_0x2df1fd[_0x394b32(0x249)]()[_0x394b32(0x166)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x1137b8=_0x5b0321,_0x16f659=shiftedTime();return _0x16f659['getFullYear']()+'/'+(_0x16f659[_0x1137b8(0x21b)]()+0x1)[_0x1137b8(0x166)]()[_0x1137b8(0x1cc)](0x2,'0')+'/'+_0x16f659[_0x1137b8(0x1d9)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x16f659[_0x1137b8(0x144)]()[_0x1137b8(0x166)]()['padStart'](0x2,'0')+':'+_0x16f659[_0x1137b8(0x203)]()['toString']()[_0x1137b8(0x1cc)](0x2,'0')+':'+_0x16f659[_0x1137b8(0x249)]()[_0x1137b8(0x166)]()[_0x1137b8(0x1cc)](0x2,'0');}function shiftedTime(){const _0x3fb9ce=_0x5b0321,_0x137b78=new Date();let _0x3fcdbf=_0x137b78;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x3fcdbf=fns[_0x3fb9ce(0x267)](_0x137b78,{'hours':settings['timeshift']});return _0x3fcdbf;}function startScheduler(){const _0xaaef67=_0x5b0321;let _0x25d9d7=new Date()[_0xaaef67(0x21c)]();_0x25d9d7==0x1&&backupConfigFiles();_0x25d9d7==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x1e0ebd=_0x5b0321;fs[_0x1e0ebd(0x224)](configpath,{'withFileTypes':!![]})[_0x1e0ebd(0x124)](_0x2cadc5=>{const _0x5d449d=_0x1e0ebd;if(!_0x2cadc5[_0x5d449d(0x1eb)]())fs[_0x5d449d(0x1c2)](configpath+_0x2cadc5[_0x5d449d(0x205)],configbackuppath+_0x2cadc5[_0x5d449d(0x205)]);});}function triggerAnalytics(){const _0x146cc6=_0x5b0321;analytics[_0x146cc6(0x18d)]({'title':_0x146cc6(0x25c),'href':_0x146cc6(0x1b2),'path':'/v'+serverversion});}function validateCredentials(_0x115552,_0x17202d){const _0xe1644=_0x5b0321;if(_0x115552[_0xe1644(0x225)]==settings[_0xe1644(0x176)]&&bcrypt[_0xe1644(0x1a9)](_0x115552[_0xe1644(0x15f)],settings[_0xe1644(0x1b5)])){if(settings[_0xe1644(0x1ba)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x10e6aa=generateLoginToken(_0x17202d);return{'allow':!![],'reason':_0xe1644(0x13b),'token':_0x10e6aa};}}else return{'allow':![],'reason':_0xe1644(0x213),'token':null};}function refreshToken(_0x205e99){const _0x350ff0=generateLoginToken(_0x205e99);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x350ff0};}function validateAccess(_0x2600bf,_0x1a694b){const _0x4ec264=_0x5b0321;let _0x1e6577=devices[_0x1a694b]['ip'],_0x3a626b;const _0x3a5eb6=_0x471ac4=>{const _0x4856cd=_0x169f;if(settings[_0x4856cd(0x121)]){if(settings[_0x4856cd(0x1ba)]){if(telegram2FaApproved(_0x1a694b)){const _0x3bd73f=generateLoginToken(_0x1a694b);return{'allow':!![],'reason':_0x4856cd(0x212),'token':_0x3bd73f};}else return{'allow':![],'reason':_0x4856cd(0x234),'token':null};}else return _0x3a626b=validToken(_0x471ac4,_0x1a694b),_0x3a626b[_0x4856cd(0x1fc)](_0x4856cd(0x1ea))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x471ac4}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings['whitelistEnabled']){let _0x3ae75a=[...settings['whitelist'],_0x4ec264(0x13c),'::ffff:127.0.0.1','127.0.0.1'];if(_0x3ae75a['includes'](_0x1e6577))return _0x3a5eb6(_0x2600bf);else{_0x3a626b=validToken(_0x2600bf,_0x1a694b);if(_0x3a626b[_0x4ec264(0x1fc)](_0x4ec264(0x1ea)))return _0x3a5eb6(_0x2600bf);else{if(telegramIpApproved(_0x1a694b)){const _0x10abd9=generateToken(_0x1a694b);return _0x3a626b=_0x3a5eb6(_0x2600bf),_0x3a626b[_0x4ec264(0x216)]?{'allow':!![],'reason':_0x4ec264(0x136),'token':_0x10abd9}:_0x3a626b;}else return settings[_0x4ec264(0x118)]?{'allow':![],'reason':_0x4ec264(0x1b1),'token':null}:{'allow':![],'reason':_0x4ec264(0x1e9),'token':null};}}}else return _0x3a5eb6(_0x2600bf);}function timelyDecrypt(_0xa8ce7f,_0x1af13a=!![]){const _0xb0984f=_0x5b0321;if(_0xa8ce7f)try{const _0x1beb8a=crypt[_0xb0984f(0x157)](secure[_0xb0984f(0x1ae)],_0xa8ce7f)[_0xb0984f(0x243)],_0x50fe7e=_0x1beb8a[_0xb0984f(0x16d)]('@')[0x0],_0x402893=_0x1beb8a[_0xb0984f(0x16d)]('@')[0x1],_0x508887=new Date()[_0xb0984f(0x17e)]();if(_0x1af13a){if(_0x508887-_0x402893<maxSecretAge*0x3e8)return _0x50fe7e;else return![];}else return _0x50fe7e;}catch(_0x3d1ea3){return![];}else return![];}const validToken=(_0x187356,_0x50c379)=>{const _0x11c5c8=_0x5b0321,_0x3c6deb=devices[_0x50c379]['ip'];if(!_0x187356)return{'error':_0x11c5c8(0x22a)};for(let _0x37cc67 of blacklist){if(_0x37cc67['token']==_0x187356)return{'error':_0x11c5c8(0x18e)};}let _0x323bf0;try{_0x323bf0=jwt[_0x11c5c8(0x14f)](_0x187356,secure['secret']+_0x50c379);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x323bf0[_0x11c5c8(0x1fc)](_0x11c5c8(0x1cd))&&!_0x323bf0[_0x11c5c8(0x1fc)]('username')||!_0x323bf0['hasOwnProperty'](_0x11c5c8(0x12d)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x323bf0[_0x11c5c8(0x1fc)](_0x11c5c8(0x225))&&_0x323bf0['hasOwnProperty']('clientip')){const {clientip:_0x331b24}=_0x323bf0;return _0x3c6deb==_0x331b24?{'success':_0x11c5c8(0x1d1)}:{'error':_0x11c5c8(0x258)};}else{if(_0x323bf0[_0x11c5c8(0x1fc)]('username')&&_0x323bf0[_0x11c5c8(0x1fc)]('clientip')){const {username:_0x3f7eed,clientip:_0x5ea4f7}=_0x323bf0;return settings[_0x11c5c8(0x176)]==_0x3f7eed&&_0x3c6deb==_0x5ea4f7?{'success':_0x11c5c8(0x1d1)}:{'error':_0x11c5c8(0x1e4)};}}},generateLoginToken=_0x1747a0=>{const _0x5e2c68=_0x5b0321;if(_0x1747a0){const _0x1c914d=devices[_0x1747a0]['ip'];return jwt[_0x5e2c68(0x146)]({'username':settings[_0x5e2c68(0x176)],'clientip':_0x1c914d},secure['secret']+_0x1747a0,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x4a5143=>{const _0x36e177=_0x5b0321;if(_0x4a5143){const _0x5072a7=devices[_0x4a5143]['ip'];return jwt['sign']({'clientip':_0x5072a7},secure[_0x36e177(0x1ff)]+_0x4a5143,{'expiresIn':devices[_0x4a5143][_0x36e177(0x211)][_0x36e177(0x168)]*0x3c});}else return![];},telegramIpApproved=_0x278eb9=>{const _0x5e56c9=_0x5b0321;let _0x4a46f8=![];return devices[_0x278eb9]['telegramIpApproval']&&devices[_0x278eb9][_0x5e56c9(0x211)][_0x5e56c9(0x168)]!='reject'&&(_0x4a46f8=devices[_0x278eb9][_0x5e56c9(0x211)]['clientip']==devices[_0x278eb9]['ip']&&new Date()[_0x5e56c9(0x17e)]()-devices[_0x278eb9]['telegramIpApproval'][_0x5e56c9(0x137)]<devices[_0x278eb9][_0x5e56c9(0x211)]['expiry']*0x3c*0x3e8),_0x4a46f8;},telegram2FaApproved=_0x2fc214=>{const _0x2a9e5f=_0x5b0321;let _0x19ba1b=![];return devices[_0x2fc214][_0x2a9e5f(0x11c)]&&devices[_0x2fc214][_0x2a9e5f(0x11c)][_0x2a9e5f(0x168)]!=_0x2a9e5f(0x1f7)&&(_0x19ba1b=devices[_0x2fc214][_0x2a9e5f(0x11c)][_0x2a9e5f(0x1cd)]==devices[_0x2fc214]['ip']&&new Date()['getTime']()-devices[_0x2fc214]['telegram2FaApproval']['timestamp']<devices[_0x2fc214][_0x2a9e5f(0x11c)][_0x2a9e5f(0x168)]*0x3c*0x3e8),_0x19ba1b;},normalizeIP=_0x1f21d3=>{const _0x2366f5=_0x5b0321;let _0x1d9861=null,_0xee653c=null;if(ipaddr[_0x2366f5(0x191)](_0x1f21d3)){const _0x30af69=ipaddr['parse'](_0x1f21d3);_0x30af69[_0x2366f5(0x1d7)]()===_0x2366f5(0x120)?(_0x30af69['isIPv4MappedAddress']()&&(_0x1d9861=_0x30af69[_0x2366f5(0x253)]()[_0x2366f5(0x166)]()),_0xee653c=_0x30af69[_0x2366f5(0x166)]()):(_0x1d9861=_0x30af69[_0x2366f5(0x166)](),_0xee653c=_0x30af69[_0x2366f5(0x1a5)]()[_0x2366f5(0x166)]());}return{'show':_0x1d9861?_0x1d9861:_0xee653c,'store':_0xee653c};};