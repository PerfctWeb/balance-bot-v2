const _0x39a6ea=_0x2b3e;(function(_0x145bd4,_0x2614df){const _0x5bfe65=_0x2b3e,_0x2b8ad8=_0x145bd4();while(!![]){try{const _0x3d243a=-parseInt(_0x5bfe65(0x2b8))/0x1*(parseInt(_0x5bfe65(0x276))/0x2)+parseInt(_0x5bfe65(0x2b9))/0x3+parseInt(_0x5bfe65(0x1bf))/0x4+parseInt(_0x5bfe65(0x20d))/0x5+parseInt(_0x5bfe65(0x237))/0x6+parseInt(_0x5bfe65(0x233))/0x7+parseInt(_0x5bfe65(0x305))/0x8*(-parseInt(_0x5bfe65(0x1ab))/0x9);if(_0x3d243a===_0x2614df)break;else _0x2b8ad8['push'](_0x2b8ad8['shift']());}catch(_0x3a4845){_0x2b8ad8['push'](_0x2b8ad8['shift']());}}}(_0x11b6,0x744de));const _0x36d6f6=function(){let _0x1e0304=!![];return function(_0x2f1418,_0x4a6bfd){const _0x5b7146=_0x1e0304?function(){const _0x4a0146=_0x2b3e;if(_0x4a6bfd){const _0x15ee00=_0x4a6bfd[_0x4a0146(0x21d)](_0x2f1418,arguments);return _0x4a6bfd=null,_0x15ee00;}}:function(){};return _0x1e0304=![],_0x5b7146;};}(),_0x8636b=_0x36d6f6(this,function(){const _0x57963a=_0x2b3e;return _0x8636b['toString']()[_0x57963a(0x2fb)](_0x57963a(0x1c8))[_0x57963a(0x2ad)]()[_0x57963a(0x2ba)](_0x8636b)['search'](_0x57963a(0x1c8));});_0x8636b();'use strict';process[_0x39a6ea(0x22c)][_0x39a6ea(0x196)]=0x1;const childProcess=require(_0x39a6ea(0x23a)),fs=require('fs'),fns=require(_0x39a6ea(0x23d)),low=require(_0x39a6ea(0x2eb)),FileSync=require(_0x39a6ea(0x234)),path=require(_0x39a6ea(0x298)),crypto=require(_0x39a6ea(0x2c9)),Crypt=require(_0x39a6ea(0x17f))[_0x39a6ea(0x2d8)],RSA=require('hybrid-crypto-js')[_0x39a6ea(0x217)],bcrypt=require('bcryptjs'),jwt=require(_0x39a6ea(0x245)),ipaddr=require(_0x39a6ea(0x227)),argv=require('yargs/yargs')(process[_0x39a6ea(0x206)][_0x39a6ea(0x2b1)](0x2))[_0x39a6ea(0x206)],uuidRandom=require(_0x39a6ea(0x18a)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require(_0x39a6ea(0x15f)),axios=require(_0x39a6ea(0x285)),{GraphQLClient,gql}=require(_0x39a6ea(0x2b3)),util=require('util'),fileUpload=require(_0x39a6ea(0x155)),{networkInterfaces}=require('os'),PORT=argv['port']||_0x39a6ea(0x153),pattern=/^[0-9]{2,4}$/;!pattern[_0x39a6ea(0x1f4)](PORT)&&(console[_0x39a6ea(0x281)](_0x39a6ea(0x2ed)+PORT+_0x39a6ea(0x20c)),process[_0x39a6ea(0x1d4)](0x1));const HOST=argv[_0x39a6ea(0x201)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x39a6ea(0x230)];let bbpath=_0x39a6ea(0x264),bbpath2='';const botfile='bot.js',configfile='bb-config.json',settingsfile=_0x39a6ea(0x169),securefile=_0x39a6ea(0x2fa),maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x39a6ea(0x159)),configpath=userID?bbpath+_0x39a6ea(0x303)+userID+'/':bbpath+_0x39a6ea(0x303),configbackuppath=configpath+'backup/',logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x39a6ea(0x304),zippath=userID?bbpath+_0x39a6ea(0x290)+userID+'/':bbpath+'zip/',loggerfile=fs['createWriteStream'](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x39a6ea(0x148);!fs['existsSync'](configpath)&&fs[_0x39a6ea(0x2e3)](configpath);!fs[_0x39a6ea(0x261)](configbackuppath)&&fs[_0x39a6ea(0x2e3)](configbackuppath);!fs[_0x39a6ea(0x261)](logspath)&&fs[_0x39a6ea(0x2e3)](logspath);!fs[_0x39a6ea(0x261)](zippath)&&fs[_0x39a6ea(0x2e3)](zippath);!fs[_0x39a6ea(0x261)](temppath)&&fs[_0x39a6ea(0x2e3)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x39a6ea(0x273)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x39a6ea(0x273)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x39a6ea(0x287),'onepagemode':![]}})[_0x39a6ea(0x252)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x39a6ea(0x273)]({'secure':{},'blacklist':[]})[_0x39a6ea(0x252)]();let crypt=new Crypt({'md':_0x39a6ea(0x306),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x39a6ea(0x2c2)](_0x39a6ea(0x16c),{'host':_0x39a6ea(0x1b1)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x39a6ea(0x2a7)]&&settings[_0x39a6ea(0x2a7)]!=''&&settings['telegramUsername']&&settings[_0x39a6ea(0x1f1)]!='')initTelegram();const parseColor=(_0x148acb,_0x3ba443)=>{const _0x4e020f=_0x39a6ea,_0x57e677=/#[A-Z]{3}#/g;if(typeof _0x148acb=='string'){!_0x3ba443?_0x148acb=_0x148acb[_0x4e020f(0x297)](_0x57e677,''):(_0x148acb=_0x148acb[_0x4e020f(0x297)](/#BLU#/g,'\x1b[34m'),_0x148acb=_0x148acb[_0x4e020f(0x297)](/#RED#/g,_0x4e020f(0x2c4)),_0x148acb=_0x148acb['replace'](/#YEL#/g,_0x4e020f(0x15e)),_0x148acb=_0x148acb['replace'](/#MAG#/g,'\x1b[35m'),_0x148acb=_0x148acb['replace'](/#CYA#/g,'\x1b[36m'),_0x148acb=_0x148acb['replace'](/#RES#/g,_0x4e020f(0x268)));;}return _0x148acb;},logger={'screen':_0xf76d72=>{const _0x4a4fc3=_0x39a6ea;console[_0x4a4fc3(0x281)](parseColor(_0xf76d72,!![]));},'simple':_0x1db067=>{const _0x59f46e=_0x39a6ea;console[_0x59f46e(0x281)](parseColor(_0x1db067,!![])),loggerfile['write'](util['format'](parseColor(_0x1db067,![]))+'\x0a');},'full':async _0x491910=>{const _0x2165d0=_0x39a6ea,_0x164c3d=getTimeStamp()+_0x2165d0(0x1e3)+_0x491910;console[_0x2165d0(0x281)](parseColor(_0x164c3d,!![])),loggerfile[_0x2165d0(0x252)](util['format'](parseColor(_0x164c3d,![]))+'\x0a');if(tgBot&&settings[_0x2165d0(0x1bd)]&&settings['telegramEvents']!=_0x2165d0(0x1e4))await tgBot[_0x2165d0(0x2d7)](settings[_0x2165d0(0x1bd)],_0x2165d0(0x2ca)+parseColor(_0x491910,![]))[_0x2165d0(0x220)](_0x165afd=>{telegramError(_0x165afd);});},'debug':async(_0x461287,_0x289101='')=>{const _0x492c27=_0x39a6ea,_0x2b1a33=getTimeStamp()+_0x492c27(0x26d)+_0x461287;if(debugging)console['log'](parseColor(_0x2b1a33,!![]));loggerfile[_0x492c27(0x252)](util[_0x492c27(0x2c8)](parseColor(_0x2b1a33,![]))+'\x0a');if(_0x289101){if(debugging)console['log'](_0x289101);loggerfile[_0x492c27(0x252)](util[_0x492c27(0x2c8)](_0x289101)+'\x0a');}}};process['on'](_0x39a6ea(0x1a8),function(_0x54b086){const _0x4709ef=_0x39a6ea;logger[_0x4709ef(0x1da)](_0x54b086);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x39a6ea(0x2af))[_0x39a6ea(0x172)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x39a6ea(0x190)),app=express(),http=require(_0x39a6ea(0x161))[_0x39a6ea(0x2c3)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x39a6ea(0x28e)]('/download/:type',async(_0x12966c,_0x48ef19)=>{const _0x4839a3=_0x39a6ea,_0x2d393a=_0x12966c[_0x4839a3(0x260)][_0x4839a3(0x2d2)],_0x562431=getClientsWithBotID('botmanager'),_0x3a95e2=_0x12966c[_0x4839a3(0x1bc)][_0x4839a3(0x171)],_0x57b824=timelyDecrypt(_0x3a95e2,![]),_0xf04a28=_0x562431[_0x4839a3(0x1d7)](_0x521914=>_0x521914[_0x4839a3(0x171)]==_0x57b824);if(_0xf04a28){const _0x28da0f=normalizeIP(_0x12966c['socket']['remoteAddress'])[_0x4839a3(0x274)],_0x1b11ff=_0x12966c[_0x4839a3(0x1bc)]['tkn'];if(validateAccess(_0x1b11ff,_0x57b824,_0x28da0f)[_0x4839a3(0x170)])_0x2d393a=='backup'&&await backupConfigFiles(),await zipFiles(_0x2d393a),_0x48ef19[_0x4839a3(0x309)](zippath+(_0x2d393a+'.zip'),_0x267086=>{const _0x24f33e=_0x4839a3;_0x267086&&(logger[_0x24f33e(0x17c)](_0x24f33e(0x2d4)+_0x2d393a),logger[_0x24f33e(0x1da)](_0x267086));});else logger[_0x4839a3(0x17c)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x2d393a+_0x4839a3(0x18b));}else logger[_0x4839a3(0x17c)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x2d393a+_0x4839a3(0x2a2));}),app['post'](_0x39a6ea(0x1c3),async(_0x248827,_0x279f69)=>{const _0x2b62b3=_0x39a6ea,_0x2fcf87=getClientsWithBotID(_0x2b62b3(0x253)),_0x4a69a6=_0x248827[_0x2b62b3(0x1bc)][_0x2b62b3(0x171)],_0x42dbdb=timelyDecrypt(_0x4a69a6,![]),_0x4be640=_0x2fcf87[_0x2b62b3(0x1d7)](_0x12e418=>_0x12e418[_0x2b62b3(0x171)]==_0x42dbdb);logger['debug'](_0x2b62b3(0x2cc));if(_0x4be640){const _0x40c513=normalizeIP(_0x248827['socket'][_0x2b62b3(0x1eb)])[_0x2b62b3(0x274)],_0x2c6eb6=_0x248827[_0x2b62b3(0x1bc)][_0x2b62b3(0x256)];if(validateAccess(_0x2c6eb6,_0x42dbdb,_0x40c513)[_0x2b62b3(0x170)]){if(_0x248827['files']){const _0x2668c1=_0x248827[_0x2b62b3(0x1ac)]['backupfile'];await _0x2668c1['mv'](temppath+_0x2668c1[_0x2b62b3(0x282)]),_0x279f69[_0x2b62b3(0x1a4)]({'status':!![],'message':_0x2b62b3(0x267)});const _0x566567=getBotsWithMode();_0x566567[_0x2b62b3(0x2c5)]>0x0?confirmRestore(temppath,_0x2668c1[_0x2b62b3(0x282)]):unzipFile(temppath,_0x2668c1['name']);}}else logger['full'](_0x2b62b3(0x29b));}else logger[_0x2b62b3(0x17c)](_0x2b62b3(0x182));}),app[_0x39a6ea(0x1c6)](express['static'](path['join'](__dirname,bbpath2,_0x39a6ea(0x1f2)))),app[_0x39a6ea(0x1c6)](express[_0x39a6ea(0x173)](path[_0x39a6ea(0x141)](__dirname,bbpath2,_0x39a6ea(0x1e1)))),app[_0x39a6ea(0x28e)]('/',function(_0x1b42e9,_0x11e54c){const _0x57a13b=_0x39a6ea;_0x11e54c[_0x57a13b(0x23b)](path[_0x57a13b(0x141)](__dirname,bbpath2,_0x57a13b(0x1f2),_0x57a13b(0x20f)));}),app[_0x39a6ea(0x28e)](_0x39a6ea(0x1e0),function(_0x588aa0,_0x3bada9){const _0x3011c9=_0x39a6ea;_0x3bada9[_0x3011c9(0x23b)](path[_0x3011c9(0x141)](__dirname,bbpath2,'build','index.html'));}),app['get']('/:bot/portfolio',(_0x152071,_0x3281e3)=>{const _0x421525=_0x39a6ea;_0x3281e3[_0x421525(0x23b)](path[_0x421525(0x141)](__dirname,bbpath2,_0x421525(0x1e1),'index.html'));}),app[_0x39a6ea(0x28e)](_0x39a6ea(0x1d5),(_0x5a056f,_0xe8e5ad)=>{const _0x1f7221=_0x39a6ea;_0xe8e5ad[_0x1f7221(0x23b)](path[_0x1f7221(0x141)](__dirname,bbpath2,_0x1f7221(0x1e1),_0x1f7221(0x20f)));}),app['get'](_0x39a6ea(0x2be),(_0x2335b0,_0x10494b)=>{const _0x23960a=_0x39a6ea;_0x10494b['sendFile'](path[_0x23960a(0x141)](__dirname,bbpath2,_0x23960a(0x1e1),_0x23960a(0x20f)));}),app[_0x39a6ea(0x28e)](_0x39a6ea(0x17e),(_0x11eed1,_0x5cc6b9)=>{const _0x3942fb=_0x39a6ea;_0x5cc6b9[_0x3942fb(0x23b)](path['join'](__dirname,bbpath2,'build',_0x3942fb(0x20f)));}),app[_0x39a6ea(0x28e)](_0x39a6ea(0x178),(_0x1f8710,_0x52e8ff)=>{const _0x4004b3=_0x39a6ea;_0x52e8ff[_0x4004b3(0x23b)](path[_0x4004b3(0x141)](__dirname,bbpath2,'build',_0x4004b3(0x20f)));}),app[_0x39a6ea(0x28e)](_0x39a6ea(0x2e1),(_0x1c790b,_0x1966d8)=>{const _0x2ff2e3=_0x39a6ea;_0x1966d8['sendFile'](path[_0x2ff2e3(0x141)](__dirname,bbpath2,_0x2ff2e3(0x1e1),_0x2ff2e3(0x20f)));});if(HOST)http[_0x39a6ea(0x1f3)](PORT,HOST);else http[_0x39a6ea(0x1f3)](PORT);const io=require(_0x39a6ea(0x250))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x12f56f=_0x39a6ea;let _0x12b6d7=_0x12f56f(0x23f);const _0x34408b=networkInterfaces(),_0x475ac0={};for(const _0x29d66d of Object[_0x12f56f(0x2ac)](_0x34408b)){for(const _0xb65d14 of _0x34408b[_0x29d66d]){if((_0xb65d14[_0x12f56f(0x232)]==_0x12f56f(0x2d1)||_0xb65d14[_0x12f56f(0x232)]==0x4)&&!_0xb65d14['internal']){const _0x5edf0b=ipaddr['parse'](_0xb65d14[_0x12f56f(0x150)])[_0x12f56f(0x1fe)]();_0x5edf0b!='private'&&(!_0x475ac0[_0x29d66d]&&(_0x475ac0[_0x29d66d]=[]),_0x475ac0[_0x29d66d][_0x12f56f(0x24e)](_0xb65d14[_0x12f56f(0x150)]),_0x12b6d7=_0xb65d14['address']);}}}return{'serverip':_0x12b6d7,'netinterfaces':_0x475ac0};}async function startServer(){const _0x463def=_0x39a6ea,{serverip:_0x59ed11,netinterfaces:_0x43226d}=getServerIP();logger[_0x463def(0x1da)](''),logger[_0x463def(0x1da)](_0x463def(0x30c)),await logger[_0x463def(0x17c)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x0a'+(_0x463def(0x1d6)+PORT+_0x463def(0x144))+(_0x463def(0x294)+_0x59ed11+':'+PORT+_0x463def(0x183))),logger['simple'](_0x463def(0x30c));if(config[_0x463def(0x2c5)]!=0x0)for(const _0xf7603b of config){if(_0xf7603b[_0x463def(0x216)]=='enabled'||_0xf7603b[_0x463def(0x216)]==_0x463def(0x239))await logger[_0x463def(0x17c)]('Starting\x20bot\x20|\x20Bot\x20'+_0xf7603b[_0x463def(0x224)]+'\x20|\x20'+_0xf7603b[_0x463def(0x15d)]),startBot([_0xf7603b[_0x463def(0x224)],userID],{'cwd':bbpath},function(_0xd19586){if(_0xd19586)logger['full'](_0xd19586);});else(_0xf7603b[_0x463def(0x216)]==_0x463def(0x1e2)||_0xf7603b['status']==_0x463def(0x315))&&await logger[_0x463def(0x17c)](_0x463def(0x180)+_0xf7603b[_0x463def(0x224)]+_0x463def(0x1fa)+_0xf7603b[_0x463def(0x15d)]);}else!newBot&&logger[_0x463def(0x1da)](_0x463def(0x149));if(newBot)addBot();logger[_0x463def(0x1da)]('-----------------------------------------------------------------------------------'),logger['simple'](''),await logger[_0x463def(0x152)](_0x463def(0x1ce)+nodeversion),await logger[_0x463def(0x152)]('Network\x20Interfaces:',_0x43226d);}function startSocket(){const _0x3357e9=_0x39a6ea;io['on'](_0x3357e9(0x2d9),_0x167c4c=>{const _0x4881a9=_0x3357e9;let _0x21a808,_0x3a6062,_0x309ce5,_0x57b07f,_0x3ea935;const _0x51f141=_0x167c4c[_0x4881a9(0x160)][_0x4881a9(0x1bc)]['referer'];_0x3a6062=_0x51f141['match'](/bot[0-9]{3}/);if(_0x3a6062)_0x309ce5=_0x3a6062[0x0][_0x4881a9(0x19a)](/[0-9]{3}/);if(_0x309ce5)_0x21a808=_0x309ce5[0x0];else _0x21a808='botmanager';const _0x317a6e=_0x167c4c[_0x4881a9(0x160)][_0x4881a9(0x293)][_0x4881a9(0x296)];if(!_0x317a6e)_0x167c4c[_0x4881a9(0x249)](_0x4881a9(0x216),{'publicKey':secure[_0x4881a9(0x280)]});else{_0x57b07f=timelyDecrypt(_0x317a6e,![]);if(!_0x57b07f)_0x167c4c[_0x4881a9(0x249)]('status',{'publicKey':secure[_0x4881a9(0x280)]});else{_0x3ea935=normalizeIP(_0x167c4c[_0x4881a9(0x2dd)]['remoteAddress'])[_0x4881a9(0x274)];if(!devices[_0x57b07f])devices[_0x57b07f]={'uuid':_0x57b07f,'access':{'token':null}};devices[_0x57b07f]['ip']=_0x3ea935;const _0x13044e=addClient(_0x167c4c['id'],_0x57b07f,_0x21a808);setAccess(_0x13044e),emitMessages(),_0x167c4c['on']('login',_0x5cd140=>{const _0x521fbd=_0x4881a9,_0x2c13ff=timelyDecrypt(_0x5cd140['password']);if(_0x2c13ff){_0x5cd140={'username':_0x5cd140[_0x521fbd(0x1bb)],'password':_0x2c13ff},devices[_0x57b07f][_0x521fbd(0x291)]=validateCredentials(_0x5cd140,_0x57b07f);if(devices[_0x57b07f]['access'][_0x521fbd(0x170)]==![]&&devices[_0x57b07f][_0x521fbd(0x291)]['reason']==_0x521fbd(0x1c4))_0x167c4c[_0x521fbd(0x249)](_0x521fbd(0x216),{'access':devices[_0x57b07f]['access']}),loginAccess2FA(_0x57b07f,_0x3ea935);else{if(devices[_0x57b07f][_0x521fbd(0x291)][_0x521fbd(0x170)]==![]&&devices[_0x57b07f]['access'][_0x521fbd(0x1b8)]==_0x521fbd(0x2fc))_0x167c4c[_0x521fbd(0x249)]('status',{'access':devices[_0x57b07f]['access']});else devices[_0x57b07f][_0x521fbd(0x291)][_0x521fbd(0x170)]&&devices[_0x57b07f][_0x521fbd(0x291)][_0x521fbd(0x1b8)]==_0x521fbd(0x2c6)&&(getClientsWithUuid(_0x57b07f)[_0x521fbd(0x2f9)](_0x461140=>{setAccess(_0x461140);}),logger[_0x521fbd(0x152)](_0x521fbd(0x219)+_0x57b07f[_0x521fbd(0x2b1)](-0x8)),setTokenRefresh(_0x57b07f),setSessionTimeout(_0x521fbd(0x251),_0x57b07f));}}else logger[_0x521fbd(0x17c)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x167c4c['on']('reset-password',()=>{resetPassword();}),_0x167c4c['on'](_0x4881a9(0x205),_0x95090a=>{removeClient(_0x167c4c['id']);}),_0x21a808==_0x4881a9(0x253)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4abd7f){const _0xf7e413=_0x39a6ea;if(_0x4abd7f!='botmanager'&&config['apiKey']!=''){if(pid[_0x4abd7f])pid[_0x4abd7f][_0xf7e413(0x1a4)]({'function':'initclient','args':null});}_0x4abd7f!=_0xf7e413(0x253)&&broadcastToBots(_0xf7e413(0x210),JSON[_0xf7e413(0x26b)](config));}function reloadBotManager(){const _0x439077=_0x39a6ea;getClientsWithBotID(_0x439077(0x253))[_0x439077(0x2f9)](_0x13cbfa=>{const _0x50c433=_0x439077;getSocket(_0x13cbfa['id'])[_0x50c433(0x249)](_0x50c433(0x216),{'access':{'allow':![],'reason':_0x50c433(0x1ed),'token':null}});});}function getSocket(_0x319b82){const _0xd9e89=_0x39a6ea;return io[_0xd9e89(0x2e8)][_0xd9e89(0x2e8)][_0xd9e89(0x28e)](_0x319b82);}function setAccess(_0x5bdac2){const _0x9d8e3c=_0x39a6ea,_0x184bbb=getSocket(_0x5bdac2['id']),_0x12abcf=_0x5bdac2[_0x9d8e3c(0x171)],_0x5ceb61=_0x5bdac2[_0x9d8e3c(0x270)];devices[_0x12abcf][_0x9d8e3c(0x291)]=validateAccess(devices[_0x12abcf][_0x9d8e3c(0x291)][_0x9d8e3c(0x1be)],_0x12abcf),logger[_0x9d8e3c(0x152)](_0x9d8e3c(0x15a)+devices[_0x12abcf][_0x9d8e3c(0x291)][_0x9d8e3c(0x1b8)]+'\x20|\x20client:\x20...'+_0x5bdac2['id'][_0x9d8e3c(0x2b1)](-0x8)+_0x9d8e3c(0x195)+_0x12abcf['slice'](-0x8)),_0x184bbb[_0x9d8e3c(0x141)](_0x12abcf);if(devices[_0x12abcf][_0x9d8e3c(0x291)][_0x9d8e3c(0x170)]){_0x184bbb['join'](_0x5ceb61);if(_0x5ceb61=='botmanager')initializeSocketBotManager(_0x184bbb);else initializeSocketBot(_0x184bbb);initClient(_0x5ceb61);}devices[_0x12abcf]['access'][_0x9d8e3c(0x1be)]&&devices[_0x12abcf]['access'][_0x9d8e3c(0x1b8)]==_0x9d8e3c(0x1df)&&setSessionTimeout(_0x9d8e3c(0x266),_0x12abcf),devices[_0x12abcf]['access'][_0x9d8e3c(0x1be)]&&devices[_0x12abcf][_0x9d8e3c(0x291)]['reason']==_0x9d8e3c(0x24b)&&setSessionTimeout(_0x9d8e3c(0x251),_0x12abcf),_0x184bbb[_0x9d8e3c(0x249)](_0x9d8e3c(0x216),{'status':_0x5bdac2[_0x9d8e3c(0x1b2)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x12abcf]['access'],'externalip':devices[_0x12abcf]['ip'],'publicKey':secure[_0x9d8e3c(0x280)],'userid':settings[_0x9d8e3c(0x2a0)],'validInstallation':validInstallation}),devices[_0x12abcf][_0x9d8e3c(0x291)][_0x9d8e3c(0x170)]==![]&&devices[_0x12abcf]['access'][_0x9d8e3c(0x1b8)]==_0x9d8e3c(0x21e)&&temporaryAccess2FA(_0x12abcf,devices[_0x12abcf]['ip']);}function setSessionTimeout(_0x156290,_0x27ab44){const _0x31b65f=_0x39a6ea;let _0x1db6d8;if(_0x156290==_0x31b65f(0x251))_0x1db6d8=loginExpiry*0x3c*0x3e8;else _0x1db6d8=devices[_0x27ab44][_0x31b65f(0x1d1)][_0x31b65f(0x238)]*0x3c*0x3e8-(new Date()[_0x31b65f(0x1b4)]()-devices[_0x27ab44][_0x31b65f(0x1d1)][_0x31b65f(0x1d8)]);if(devices[_0x27ab44][_0x31b65f(0x24f)])clearTimeout(devices[_0x27ab44][_0x31b65f(0x24f)]);devices[_0x27ab44]['pidExpireLogin']=setTimeout(()=>{const _0x1053cd=_0x31b65f;if(devices[_0x27ab44][_0x1053cd(0x316)])clearTimeout(devices[_0x27ab44][_0x1053cd(0x316)]);removeSocketListeners(_0x27ab44),addBlacklist(_0x27ab44),devices[_0x27ab44][_0x1053cd(0x1d1)]=null,devices[_0x27ab44][_0x1053cd(0x2f0)]=null,devices[_0x27ab44][_0x1053cd(0x291)][_0x1053cd(0x1be)]=null,logger[_0x1053cd(0x152)](_0x1053cd(0x25e)+_0x27ab44[_0x1053cd(0x2b1)](-0x8)),devices[_0x27ab44][_0x1053cd(0x291)]=validateAccess(devices[_0x27ab44][_0x1053cd(0x291)][_0x1053cd(0x1be)],_0x27ab44),!(devices[_0x27ab44][_0x1053cd(0x291)][_0x1053cd(0x170)]&&devices[_0x27ab44][_0x1053cd(0x291)][_0x1053cd(0x1b8)]==_0x1053cd(0x1a6))&&(_0x156290==_0x1053cd(0x251)?io['to'](_0x27ab44)[_0x1053cd(0x249)](_0x1053cd(0x216),{'access':{'allow':![],'reason':_0x1053cd(0x2c7),'token':null}}):io['to'](_0x27ab44)[_0x1053cd(0x249)]('status',{'access':{'allow':![],'reason':_0x1053cd(0x194),'token':null}})),devices[_0x27ab44][_0x1053cd(0x291)][_0x1053cd(0x1be)]=null;},_0x1db6d8);}function setTokenRefresh(_0x56fc7e){const _0xc1d8c6=_0x39a6ea;if(devices[_0x56fc7e][_0xc1d8c6(0x316)])clearTimeout(devices[_0x56fc7e][_0xc1d8c6(0x316)]);devices[_0x56fc7e][_0xc1d8c6(0x316)]=setTimeout(()=>{const _0xe111d6=_0xc1d8c6;getClientsWithUuid(_0x56fc7e)[_0xe111d6(0x2c5)]!=0x0?(devices[_0x56fc7e]['access']=refreshToken(_0x56fc7e),io['to'](_0x56fc7e)[_0xe111d6(0x249)](_0xe111d6(0x216),{'status':_0xe111d6(0x154),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x56fc7e][_0xe111d6(0x291)],'externalip':devices[_0x56fc7e]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x56fc7e)):clearTimeout(devices[_0x56fc7e][_0xe111d6(0x316)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0xf8eba7){const _0x4a5d9f=_0x39a6ea,_0x49a519=getClient(_0xf8eba7['id'])[_0x4a5d9f(0x171)];_0xf8eba7[_0x4a5d9f(0x249)](_0x4a5d9f(0x210),config),_0xf8eba7[_0x4a5d9f(0x249)](_0x4a5d9f(0x192),cleanSettings()),_0xf8eba7['on'](_0x4a5d9f(0x299),_0x469a3f=>{const _0x27d80c=_0x4a5d9f;if(validateAccess(_0x469a3f,_0x49a519)[_0x27d80c(0x170)])addBot();else logger[_0x27d80c(0x17c)](_0x27d80c(0x2b5));}),_0xf8eba7['on']('update-bot',(_0x77f7f9,_0x36baea)=>{const _0x2a6687=_0x4a5d9f;if(validateAccess(_0x36baea,_0x49a519)[_0x2a6687(0x170)])toggleBot(_0x77f7f9[_0x2a6687(0x224)],_0x77f7f9[_0x2a6687(0x216)],_0x77f7f9[_0x2a6687(0x1dd)]);else logger[_0x2a6687(0x17c)](_0x2a6687(0x2c1));}),_0xf8eba7['on'](_0x4a5d9f(0x16f),(_0xf7f729,_0x51167a)=>{const _0x1a2e0c=_0x4a5d9f;if(validateAccess(_0x51167a,_0x49a519)[_0x1a2e0c(0x170)])toggleBotMode(_0xf7f729);else logger[_0x1a2e0c(0x17c)](_0x1a2e0c(0x2c1));}),_0xf8eba7['on'](_0x4a5d9f(0x1a3),(_0x5a98d2,_0x65e680)=>{const _0x5a5c62=_0x4a5d9f;if(validateAccess(_0x65e680,_0x49a519)[_0x5a5c62(0x170)])deleteBot(_0x5a98d2);else logger[_0x5a5c62(0x17c)](_0x5a5c62(0x2cb));}),_0xf8eba7['on']('store-settings',(_0x1a0a52,_0x242cb1)=>{const _0xba01e3=_0x4a5d9f;if(validateAccess(_0x242cb1,_0x49a519)[_0xba01e3(0x170)])storeSettings(_0x1a0a52,!![]);else logger[_0xba01e3(0x17c)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0xf8eba7['on']('update-bb',_0x34b091=>{const _0x50aa49=_0x4a5d9f;if(validateAccess(_0x34b091,_0x49a519)[_0x50aa49(0x170)])updateBB('update');else logger[_0x50aa49(0x17c)](_0x50aa49(0x278));}),_0xf8eba7['on'](_0x4a5d9f(0x2ef),_0x5a4dbc=>{const _0x28a52b=_0x4a5d9f;if(validateAccess(_0x5a4dbc,_0x49a519)[_0x28a52b(0x170)])updateBB('reinstall');else logger[_0x28a52b(0x17c)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0xf8eba7['on'](_0x4a5d9f(0x1d2),_0x219e4c=>{const _0x3e58c9=_0x4a5d9f;if(validateAccess(_0x219e4c,_0x49a519)[_0x3e58c9(0x170)]){const _0x1c0f60=getClient(_0xf8eba7['id']);if(_0x1c0f60)getBackupFiles(_0x1c0f60[_0x3e58c9(0x171)]);else logger[_0x3e58c9(0x17c)](_0x3e58c9(0x17b));}else logger[_0x3e58c9(0x17c)](_0x3e58c9(0x157));}),_0xf8eba7['on'](_0x4a5d9f(0x2f1),(_0x565887,_0x30203e)=>{const _0x24352a=_0x4a5d9f;if(validateAccess(_0x30203e,_0x49a519)[_0x24352a(0x170)])restoreBackupFile(_0x565887);else logger['full'](_0x24352a(0x2f8));}),_0xf8eba7['on']('get-messages',_0xeff028=>{const _0x8ee6e8=_0x4a5d9f;if(validateAccess(_0xeff028,_0x49a519)[_0x8ee6e8(0x170)])getMessages();else logger[_0x8ee6e8(0x17c)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0xf8eba7['on'](_0x4a5d9f(0x289),(_0x1e2b36,_0x41f86e)=>{const _0x9277e5=_0x4a5d9f;if(validateAccess(_0x41f86e,_0x49a519)['allow'])confirmMessage(_0x1e2b36);else logger[_0x9277e5(0x17c)](_0x9277e5(0x27d));}),_0xf8eba7['on'](_0x4a5d9f(0x14e),_0x5f4005=>{const _0x108397=_0x4a5d9f;if(validateAccess(_0x5f4005,_0x49a519)[_0x108397(0x170)]){if(devices[_0x49a519]['pidRefreshToken'])clearTimeout(devices[_0x49a519][_0x108397(0x316)]);if(devices[_0x49a519][_0x108397(0x24f)])clearTimeout(devices[_0x49a519][_0x108397(0x24f)]);removeSocketListeners(getClient(_0xf8eba7['id'])[_0x108397(0x171)]),addBlacklist(_0x49a519),devices[_0x49a519][_0x108397(0x1d1)]=null,devices[_0x49a519][_0x108397(0x2f0)]=null,devices[_0x49a519][_0x108397(0x291)]['token']=null,logger[_0x108397(0x152)](_0x108397(0x187)+_0x49a519['slice'](-0x8)),io['to'](getClient(_0xf8eba7['id'])[_0x108397(0x171)])[_0x108397(0x249)](_0x108397(0x216),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x108397(0x17c)](_0x108397(0x28f));});}function initializeSocketBot(_0x33d181){const _0x32a093=_0x39a6ea,_0x38c9e5=getClient(_0x33d181['id'])[_0x32a093(0x270)],_0x813a92=getClient(_0x33d181['id'])['uuid'];_0x33d181['on'](_0x32a093(0x2f2),(_0x20d12a,_0xe5d5b3)=>{const _0x1ff2ec=_0x32a093;if(validateAccess(_0xe5d5b3,_0x813a92)['allow']){if(pid[_0x38c9e5])pid[_0x38c9e5]['send']({'function':_0x1ff2ec(0x174),'args':_0x20d12a});}else logger['full'](_0x1ff2ec(0x259));}),_0x33d181['on'](_0x32a093(0x2fd),(_0x2bd89a,_0xdfa626)=>{const _0x1f94ac=_0x32a093;if(validateAccess(_0xdfa626,_0x813a92)[_0x1f94ac(0x170)]){if(pid[_0x38c9e5])pid[_0x38c9e5][_0x1f94ac(0x1a4)]({'function':_0x1f94ac(0x1f7),'args':_0x2bd89a});}else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x33d181['on']('get-portfolio',(_0x4986de,_0x15984f)=>{const _0x720126=_0x32a093;if(validateAccess(_0x15984f,_0x813a92)['allow']){if(pid[_0x38c9e5])pid[_0x38c9e5][_0x720126(0x1a4)]({'function':'getPortfolio','args':_0x4986de});}else logger['full'](_0x720126(0x165));}),_0x33d181['on'](_0x32a093(0x25c),(_0x41ed81,_0x48fdd7)=>{const _0x47480f=_0x32a093;if(validateAccess(_0x48fdd7,_0x813a92)[_0x47480f(0x170)]){if(pid[_0x38c9e5])pid[_0x38c9e5][_0x47480f(0x1a4)]({'function':_0x47480f(0x1b6),'args':_0x41ed81});}else logger[_0x47480f(0x17c)](_0x47480f(0x22d));}),_0x33d181['on']('store-headless',(_0xdf99c0,_0x3b2de0)=>{const _0x86b42b=_0x32a093;if(validateAccess(_0x3b2de0,_0x813a92)[_0x86b42b(0x170)]){if(pid[_0x38c9e5])pid[_0x38c9e5][_0x86b42b(0x1a4)]({'function':_0x86b42b(0x1ea),'args':_0xdf99c0});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x33d181['on'](_0x32a093(0x1ad),(_0x23114b,_0x20e6d3)=>{const _0x6c003a=_0x32a093;if(validateAccess(_0x20e6d3,_0x813a92)[_0x6c003a(0x170)]){if(pid[_0x38c9e5])pid[_0x38c9e5][_0x6c003a(0x1a4)]({'function':_0x6c003a(0x2a8),'args':_0x23114b});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x33d181['on'](_0x32a093(0x22a),_0x35bc90=>{const _0x60e319=_0x32a093;if(validateAccess(_0x35bc90,_0x813a92)[_0x60e319(0x170)]){if(pid[_0x38c9e5])pid[_0x38c9e5][_0x60e319(0x1a4)]({'function':'resetHistory','args':null});}else logger[_0x60e319(0x17c)](_0x60e319(0x277));}),_0x33d181['on'](_0x32a093(0x2d6),_0x349d5c=>{const _0x5648b0=_0x32a093;if(validateAccess(_0x349d5c,_0x813a92)['allow']){if(pid[_0x38c9e5])pid[_0x38c9e5][_0x5648b0(0x1a4)]({'function':_0x5648b0(0x292),'args':null});}else logger[_0x5648b0(0x17c)](_0x5648b0(0x176));}),_0x33d181['on'](_0x32a093(0x29c),(_0x461d8b,_0x127db0)=>{const _0x18286d=_0x32a093;if(validateAccess(_0x127db0,_0x813a92)['allow']){if(pid[_0x38c9e5])pid[_0x38c9e5][_0x18286d(0x1a4)]({'function':'placeOrder','args':_0x461d8b});}else logger[_0x18286d(0x17c)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x33d181['on'](_0x32a093(0x223),_0xfc2d3a=>{const _0x87dcfa=_0x32a093;if(validateAccess(_0xfc2d3a,_0x813a92)['allow']){if(pid[_0x38c9e5])pid[_0x38c9e5]['send']({'function':_0x87dcfa(0x175),'args':null});}else logger[_0x87dcfa(0x17c)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x33d181['on'](_0x32a093(0x2a9),_0x2bca1b=>{const _0x2da810=_0x32a093;if(validateAccess(_0x2bca1b,_0x813a92)[_0x2da810(0x170)]){if(pid[_0x38c9e5])pid[_0x38c9e5][_0x2da810(0x1a4)]({'function':_0x2da810(0x24c),'args':null});}else logger[_0x2da810(0x17c)](_0x2da810(0x1cf));}),_0x33d181['on'](_0x32a093(0x189),_0x30b8b7=>{const _0x248966=_0x32a093;if(validateAccess(_0x30b8b7,_0x813a92)['allow'])updateBB(_0x248966(0x203));else logger[_0x248966(0x17c)](_0x248966(0x278));}),_0x33d181['on'](_0x32a093(0x2e5),_0xb5229a=>{const _0xdc1ea5=_0x32a093;if(validateAccess(_0xb5229a,_0x813a92)['allow'])getMessages();else logger['full'](_0xdc1ea5(0x1fc));}),_0x33d181['on'](_0x32a093(0x289),(_0x10f0db,_0x2f1423)=>{const _0x4bb6f6=_0x32a093;if(validateAccess(_0x2f1423,_0x813a92)[_0x4bb6f6(0x170)])confirmMessage(_0x10f0db);else logger[_0x4bb6f6(0x17c)](_0x4bb6f6(0x27d));}),_0x33d181['on'](_0x32a093(0x14e),_0x3d725e=>{const _0x160085=_0x32a093;if(validateAccess(_0x3d725e,_0x813a92)[_0x160085(0x170)]){if(devices[_0x813a92][_0x160085(0x316)])clearTimeout(devices[_0x813a92][_0x160085(0x316)]);if(devices[_0x813a92][_0x160085(0x24f)])clearTimeout(devices[_0x813a92][_0x160085(0x24f)]);removeSocketListeners(getClient(_0x33d181['id'])[_0x160085(0x171)]),addBlacklist(_0x813a92),devices[_0x813a92][_0x160085(0x1d1)]=null,devices[_0x813a92]['telegram2FaApproval']=null,devices[_0x813a92][_0x160085(0x291)][_0x160085(0x1be)]=null,logger[_0x160085(0x152)](_0x160085(0x187)+_0x813a92[_0x160085(0x2b1)](-0x8)),io['to'](getClient(_0x33d181['id'])[_0x160085(0x171)])[_0x160085(0x249)]('status',{'access':{'allow':![],'reason':_0x160085(0x147),'token':null}});}else logger[_0x160085(0x17c)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x280e42){getClientsWithUuid(_0x280e42)['forEach'](_0x332ceb=>{const _0x542c32=_0x2b3e;getSocket(_0x332ceb['id'])[_0x542c32(0x1a1)]();});}function cleanSettings(){const _0x49b11a=_0x39a6ea;let _0x5de915=settings;return settings['telegramToken']&&settings['telegramToken']!=''&&(_0x5de915={..._0x5de915,'telegramToken':_0x49b11a(0x28a)}),settings[_0x49b11a(0x2f4)]&&settings[_0x49b11a(0x2f4)]!=''&&(_0x5de915={..._0x5de915,'bbPassword':_0x49b11a(0x28a)}),(settings[_0x49b11a(0x2f4)]&&settings[_0x49b11a(0x2f4)]==_0x49b11a(0x25a)||settings[_0x49b11a(0x2a7)]&&settings['telegramToken']==_0x49b11a(0x25a))&&(_0x5de915={..._0x5de915,'restored':{'password':settings[_0x49b11a(0x2f4)]==_0x49b11a(0x25a),'telegram':settings['telegramToken']==_0x49b11a(0x25a)}}),_0x5de915;}async function updateBB(_0x44ab80){const _0x51e787=_0x39a6ea;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x424ceb=>{const _0x20a8ba=_0x2b3e;restartBot(_0x424ceb[_0x20a8ba(0x224)]);}),logger['debug'](_0x51e787(0x164)+_0x44ab80);if(_0x44ab80=='update')process[_0x51e787(0x1a4)]({'update':!![]},_0x59f3a6=>{});else _0x44ab80==_0x51e787(0x1aa)&&process[_0x51e787(0x1a4)]({'reinstall':!![]},_0x566b7e=>{});}function startBot(_0x19a684,_0x544414,_0x1c82e9){const _0x2a264c=_0x39a6ea;if(debugging)_0x19a684[_0x2a264c(0x24e)]('-d');let _0x442f48=![];const _0x24e8c8=_0x19a684[0x0];_0x544414={..._0x544414,'stdio':[_0x2a264c(0x1cb),_0x2a264c(0x1cb),_0x2a264c(0x1cb),_0x2a264c(0x167)]},pid[_0x24e8c8]=childProcess[_0x2a264c(0x246)](botfile,_0x19a684,_0x544414),pid[_0x24e8c8]['on']('message',_0x827528=>{const _0x484fc6=_0x2a264c;switch(Object['keys'](_0x827528)[0x0]){case _0x484fc6(0x15d):updateBotName(_0x24e8c8,_0x827528['botname']);break;case _0x484fc6(0x1f8):updateBotManager();break;case'status':updateStatus(_0x24e8c8,_0x827528['status']);break;case _0x484fc6(0x1dd):updateLive(_0x24e8c8,_0x827528['live']);break;case _0x484fc6(0x1a5):updateLive(_0x24e8c8,_0x827528[_0x484fc6(0x1a5)]),io['to'](_0x24e8c8)[_0x484fc6(0x249)](_0x484fc6(0x216),{'access':{'allow':![],'reason':_0x484fc6(0x1ed),'token':null}});break;case _0x484fc6(0x2ee):_0x827528[_0x484fc6(0x2ee)]==_0x484fc6(0x1cd)&&restartBot(_0x24e8c8);_0x827528[_0x484fc6(0x2ee)]==_0x484fc6(0x314)&&toggleBot(_0x24e8c8,_0x484fc6(0x1e2),_0x484fc6(0x21c));break;case _0x484fc6(0x218):sendTelegram(_0x24e8c8,_0x827528['telegram']);break;case _0x484fc6(0x29f):sendTelegramMsg(_0x827528[_0x484fc6(0x29f)]);break;case'function':io['to'](_0x24e8c8)[_0x484fc6(0x249)](_0x827528[_0x484fc6(0x21b)],_0x827528[_0x484fc6(0x177)]);break;}}),pid[_0x24e8c8]['on'](_0x2a264c(0x2f7),function(_0x3aab81){if(_0x442f48)return;_0x442f48=!![],_0x1c82e9(_0x3aab81);}),pid[_0x24e8c8]['on']('exit',async function(_0x16859f){const _0xf0e9e0=_0x2a264c;if(installingUpdate)return;if(_0x442f48)return;_0x442f48=!![],_0x1c82e9(null);const _0x3c1cb6=dbConfig['get'](_0xf0e9e0(0x210))[_0xf0e9e0(0x1d7)]({'botID':_0x24e8c8})['value']();_0x3c1cb6&&(_0x3c1cb6[_0xf0e9e0(0x216)]==_0xf0e9e0(0x30d)||_0x3c1cb6['status']==_0xf0e9e0(0x239))&&(await sleep(0x3e8),updateLive(_0x24e8c8,'stopped'),logger[_0xf0e9e0(0x17c)](_0xf0e9e0(0x236)+_0x24e8c8),startBot([_0x24e8c8,userID],{'cwd':bbpath},function(_0x3d9685){const _0x4c28be=_0xf0e9e0;if(_0x3d9685)logger[_0x4c28be(0x17c)](_0x3d9685);}));});}function stopBot(_0x1b8606){const _0x4af413=_0x39a6ea;getClientsWithBotID(_0x1b8606)[_0x4af413(0x2f9)](_0x437b70=>{const _0x32c5ea=_0x4af413;getSocket(_0x437b70['id'])[_0x32c5ea(0x205)](!![]),removeClient(_0x437b70['id']);}),pid[_0x1b8606]&&(pid[_0x1b8606]['kill'](),pid[_0x1b8606]=null);}function restartBot(_0x573fb6){const _0xc236fe=_0x39a6ea;if(pid[_0x573fb6])pid[_0x573fb6][_0xc236fe(0x314)]();}function addBot(){const _0x19d981=_0x39a6ea;let _0x1fe721;for(let _0x2f5186=0x1;_0x2f5186<0x3e9;_0x2f5186++){_0x1fe721=_0x2f5186[_0x19d981(0x2ad)]()['padStart'](0x3,'0');let _0x1925b9=config[_0x19d981(0x1d7)](_0x2df116=>_0x2df116[_0x19d981(0x224)]==_0x1fe721);if(!_0x1925b9)break;}if(_0x1fe721==='1000'){logger['full']('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x19d981(0x17c)](_0x19d981(0x221)+_0x1fe721),dbConfig[_0x19d981(0x28e)]('bots')['push']({'botID':_0x1fe721,'botname':_0x19d981(0x2ae)+_0x1fe721,'status':_0x19d981(0x239),'live':''})[_0x19d981(0x252)](),startBot([_0x1fe721,userID],{'cwd':bbpath},function(_0x1af1c4){const _0x5d8189=_0x19d981;if(_0x1af1c4)logger[_0x5d8189(0x17c)](_0x1af1c4);}),config=getConfiguration(),io['to']('botmanager')['emit'](_0x19d981(0x210),config),broadcastToBots(_0x19d981(0x210),JSON[_0x19d981(0x26b)](config));}function deleteBot(_0x511a45){const _0x3afe82=_0x39a6ea;getClientsWithBotID(_0x511a45)[_0x3afe82(0x2f9)](_0x2ea44a=>{const _0x1e248b=_0x3afe82;getSocket(_0x2ea44a['id'])[_0x1e248b(0x205)](!![]),removeClient(_0x2ea44a['id']);}),dbConfig[_0x3afe82(0x28e)](_0x3afe82(0x210))[_0x3afe82(0x1e6)]({'botID':_0x511a45})[_0x3afe82(0x252)](),logger['full'](_0x3afe82(0x308)+_0x511a45),stopBot(_0x511a45);try{if(fs[_0x3afe82(0x261)](path['join'](configpath,'bot-'+_0x511a45+'-config.json')))fs[_0x3afe82(0x17d)](path['join'](configpath,_0x3afe82(0x2cd)+_0x511a45+_0x3afe82(0x14a)));if(fs['existsSync'](path[_0x3afe82(0x141)](configpath,_0x3afe82(0x2cd)+_0x511a45+_0x3afe82(0x300))))fs[_0x3afe82(0x17d)](path[_0x3afe82(0x141)](configpath,_0x3afe82(0x2cd)+_0x511a45+_0x3afe82(0x300)));if(fs[_0x3afe82(0x261)](path['join'](configpath,_0x3afe82(0x2cd)+_0x511a45+_0x3afe82(0x25f))))fs[_0x3afe82(0x17d)](path[_0x3afe82(0x141)](configpath,_0x3afe82(0x2cd)+_0x511a45+_0x3afe82(0x25f)));if(fs[_0x3afe82(0x261)](path[_0x3afe82(0x141)](configpath,_0x3afe82(0x2cd)+_0x511a45+_0x3afe82(0x214))))fs[_0x3afe82(0x17d)](path[_0x3afe82(0x141)](configpath,'bot-'+_0x511a45+_0x3afe82(0x214)));}catch(_0x2909ee){if(_0x2909ee)logger[_0x3afe82(0x17c)](_0x3afe82(0x257),_0x2909ee);}config=getConfiguration(),io['to'](_0x3afe82(0x253))[_0x3afe82(0x249)](_0x3afe82(0x210),config),broadcastToBots(_0x3afe82(0x210),JSON['stringify'](config));}function toggleBot(_0x4cb613,_0xe8ad84,_0x44692b){const _0x379bcb=_0x39a6ea;dbConfig['get'](_0x379bcb(0x210))[_0x379bcb(0x1d7)]({'botID':_0x4cb613})[_0x379bcb(0x24a)]({'status':_0xe8ad84})['assign']({'live':_0x44692b})[_0x379bcb(0x252)]();if(_0xe8ad84==_0x379bcb(0x30d)||_0xe8ad84==_0x379bcb(0x239))logger[_0x379bcb(0x17c)](_0x379bcb(0x269)+_0x4cb613),startBot([_0x4cb613,userID],{'cwd':bbpath},function(_0x23d6fd){const _0x44bb18=_0x379bcb;if(_0x23d6fd)logger[_0x44bb18(0x17c)](_0x23d6fd);});else(_0xe8ad84==_0x379bcb(0x1e2)||_0xe8ad84==_0x379bcb(0x315))&&(logger[_0x379bcb(0x17c)]('Disabled\x20Bot\x20'+_0x4cb613),stopBot(_0x4cb613));config=getConfiguration(),io['to']('botmanager')[_0x379bcb(0x249)](_0x379bcb(0x210),config),broadcastToBots(_0x379bcb(0x210),JSON[_0x379bcb(0x26b)](config));}function toggleStatus(_0xb5c14e){const _0x1c343c=_0x39a6ea;let _0x47d4ce=dbConfig[_0x1c343c(0x28e)](_0x1c343c(0x210))[_0x1c343c(0x1d7)]({'botID':_0xb5c14e})[_0x1c343c(0x241)](),_0x55f42a;if(_0x47d4ce[_0x1c343c(0x216)]===_0x1c343c(0x30d))_0x55f42a=_0x1c343c(0x1e2);else{if(_0x47d4ce[_0x1c343c(0x216)]===_0x1c343c(0x239))_0x55f42a=_0x1c343c(0x315);else{if(_0x47d4ce[_0x1c343c(0x216)]===_0x1c343c(0x315))_0x55f42a='new';else{if(_0x47d4ce[_0x1c343c(0x216)]===_0x1c343c(0x1e2))_0x55f42a='enabled';}}}return _0x55f42a;}function updateStatus(_0x3cc118,_0x466847){const _0x4b6cc3=_0x39a6ea;dbConfig[_0x4b6cc3(0x28e)](_0x4b6cc3(0x210))[_0x4b6cc3(0x1d7)]({'botID':_0x3cc118})[_0x4b6cc3(0x24a)]({'status':_0x466847})[_0x4b6cc3(0x252)](),config=getConfiguration(),io['to']('botmanager')[_0x4b6cc3(0x249)](_0x4b6cc3(0x210),config),broadcastToBots(_0x4b6cc3(0x210),JSON['stringify'](config));}function updateLive(_0x269364,_0x2eb531){const _0x481860=_0x39a6ea;dbConfig['get'](_0x481860(0x210))[_0x481860(0x1d7)]({'botID':_0x269364})[_0x481860(0x24a)]({'live':_0x2eb531})[_0x481860(0x252)](),config=getConfiguration(),io['to'](_0x481860(0x253))[_0x481860(0x249)](_0x481860(0x210),config),broadcastToBots(_0x481860(0x210),JSON[_0x481860(0x26b)](config));}function updateBotName(_0x43b02d,_0x50f346){const _0x499ed4=_0x39a6ea;dbConfig['get'](_0x499ed4(0x210))['find']({'botID':_0x43b02d})[_0x499ed4(0x24a)]({'botname':_0x50f346})['write'](),config=getConfiguration(),io['to'](_0x499ed4(0x253))['emit'](_0x499ed4(0x210),config),broadcastToBots(_0x499ed4(0x210),JSON['stringify'](config));}function updateBotManager(){const _0x1813f9=_0x39a6ea;config=getConfiguration(),io['to'](_0x1813f9(0x253))['emit']('bots',config),broadcastToBots(_0x1813f9(0x210),JSON[_0x1813f9(0x26b)](config));}function toggleBotMode(_0x41ec50){const _0x4faafb=_0x39a6ea;if(pid[_0x41ec50])pid[_0x41ec50][_0x4faafb(0x1a4)]({'function':_0x4faafb(0x1d0),'args':null});else{const _0x5050be=configpath+_0x4faafb(0x2cd)+_0x41ec50+_0x4faafb(0x14a),_0x4f27ea=fs['readFileSync'](_0x5050be),_0x55ac5a=JSON[_0x4faafb(0x229)](_0x4f27ea),_0x443900=_0x55ac5a[_0x4faafb(0x270)][0x0]['headless'];_0x55ac5a[_0x4faafb(0x270)][0x0][_0x4faafb(0x191)]=!_0x443900;const _0x1a4f62=JSON[_0x4faafb(0x26b)](_0x55ac5a,null,0x2);fs[_0x4faafb(0x1a9)](_0x5050be,_0x1a4f62),config=getConfiguration(),io['to']('botmanager')[_0x4faafb(0x249)](_0x4faafb(0x210),config),broadcastToBots(_0x4faafb(0x210),JSON[_0x4faafb(0x26b)](config));}}function telegramError(_0x4bd449){const _0x2beb7=_0x39a6ea;logger[_0x2beb7(0x1da)](getTimeStamp()+_0x2beb7(0x2e0));}function validateTelegram(_0x1d5b26){const _0x2e24b5=_0x39a6ea;if(_0x1d5b26['from']['username']!=settings[_0x2e24b5(0x1f1)]&&'@'+_0x1d5b26[_0x2e24b5(0x200)]['username']!=settings[_0x2e24b5(0x1f1)])return tgBot[_0x2e24b5(0x2d7)](_0x1d5b26['chat']['id'],_0x2e24b5(0x1de),{'parse_mode':_0x2e24b5(0x288)})[_0x2e24b5(0x220)](_0x3ca892=>{telegramError(_0x3ca892);}),![];return!![];}async function initTelegram(){const _0x448c4d=_0x39a6ea;if(tgBot)tgBot[_0x448c4d(0x2fe)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x448c4d(0x2a7)],{'polling':!![]});let _0x5c9b10=_0x448c4d(0x222);_0x5c9b10+='\x0a',_0x5c9b10+=_0x448c4d(0x1f6),_0x5c9b10+=_0x448c4d(0x1dc),_0x5c9b10+=_0x448c4d(0x255),_0x5c9b10+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x5c9b10+='/on\x20-\x20start\x20bot(s)\x0a',_0x5c9b10+=_0x448c4d(0x1b9),_0x5c9b10+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x5c9b10+=_0x448c4d(0x2d5),_0x5c9b10+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x5c9b10+=_0x448c4d(0x2bf),_0x5c9b10+=_0x448c4d(0x16d),_0x5c9b10+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x5c9b10+=_0x448c4d(0x145),_0x5c9b10+=_0x448c4d(0x28c);let _0x48153a=_0x448c4d(0x179);_0x48153a+='\x0a',_0x48153a+=_0x5c9b10,tgBot[_0x448c4d(0x27b)](/\/start/,_0x2d3dce=>{const _0x314f33=_0x448c4d;if(!validateTelegram(_0x2d3dce))return;if(settings[_0x314f33(0x1bd)]!=_0x2d3dce[_0x314f33(0x14d)]['id'])updateSetting(_0x314f33(0x1bd),_0x2d3dce[_0x314f33(0x14d)]['id']);updateSetting(_0x314f33(0x1ca),!![]),tgBot[_0x314f33(0x2d7)](_0x2d3dce[_0x314f33(0x14d)]['id'],_0x48153a)[_0x314f33(0x220)](_0x3c59f5=>{telegramError(_0x3c59f5);});}),tgBot[_0x448c4d(0x27b)](/\/enable/,_0x1a19c3=>{const _0x5602ef=_0x448c4d;if(!validateTelegram(_0x1a19c3))return;if(settings[_0x5602ef(0x1bd)]!=_0x1a19c3[_0x5602ef(0x14d)]['id'])updateSetting(_0x5602ef(0x1bd),_0x1a19c3[_0x5602ef(0x14d)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x5602ef(0x2d7)](_0x1a19c3[_0x5602ef(0x14d)]['id'],_0x5602ef(0x2a1))['catch'](_0xb053ac=>{telegramError(_0xb053ac);});}),tgBot[_0x448c4d(0x27b)](/\/config/,async _0x7b6d7a=>{const _0x39bfa2=_0x448c4d;if(!validateTelegram(_0x7b6d7a))return;tgBot['removeListener'](_0x39bfa2(0x1c0)),tgBot[_0x39bfa2(0x2d7)](_0x7b6d7a['chat']['id'],_0x39bfa2(0x1a0),{'reply_markup':{'inline_keyboard':[[{'text':_0x39bfa2(0x2a5),'callback_data':'orders'},{'text':'Alerts','callback_data':_0x39bfa2(0x26c)},{'text':'All','callback_data':'all'}]]}})[_0x39bfa2(0x220)](_0x2d5b83=>{telegramError(_0x2d5b83);}),tgBot['on'](_0x39bfa2(0x1c0),async _0x193018=>{const _0x33a838=_0x39bfa2,_0x8bed18=_0x193018[_0x33a838(0x2de)],_0x2b267f=_0x193018[_0x33a838(0x2bd)];tgBot[_0x33a838(0x311)](_0x193018['id'])[_0x33a838(0x1fb)](async()=>{const _0x2bf22c=_0x33a838;_0x8bed18=='orders'&&(updateSetting(_0x2bf22c(0x2df),'orders'),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x2b267f[_0x2bf22c(0x14d)]['id'],_0x2bf22c(0x2a6))[_0x2bf22c(0x220)](_0x4ccae4=>{telegramError(_0x4ccae4);}));_0x8bed18=='alerts'&&(updateSetting(_0x2bf22c(0x2df),'alerts'),updateSetting(_0x2bf22c(0x1ca),!![]),await tgBot[_0x2bf22c(0x2d7)](_0x2b267f[_0x2bf22c(0x14d)]['id'],_0x2bf22c(0x19d))[_0x2bf22c(0x220)](_0x3e5292=>{telegramError(_0x3e5292);}));_0x8bed18==_0x2bf22c(0x1b0)&&(updateSetting('telegramEvents',_0x2bf22c(0x1b0)),updateSetting('telegramEnabled',!![]),await tgBot[_0x2bf22c(0x2d7)](_0x2b267f[_0x2bf22c(0x14d)]['id'],_0x2bf22c(0x1f0))[_0x2bf22c(0x220)](_0x51ea41=>{telegramError(_0x51ea41);}));if(!settings[_0x2bf22c(0x1bd)])tgBot['sendMessage'](_0x2b267f['chat']['id'],_0x2bf22c(0x1e5))[_0x2bf22c(0x220)](_0x2467a3=>{telegramError(_0x2467a3);});}),tgBot['removeListener'](_0x33a838(0x1c0));});}),tgBot[_0x448c4d(0x27b)](/\/status/,_0x247356=>{const _0x8af5ee=_0x448c4d;if(!validateTelegram(_0x247356))return;const _0x218142=getBotsWithMode();let _0x2209ce=_0x8af5ee(0x16a);config[_0x8af5ee(0x2f9)](_0x3dcd68=>{const _0x1056ba=_0x8af5ee,_0x3c67d0=_0x218142[_0x1056ba(0x1d7)](_0x4fbe3d=>_0x4fbe3d[_0x1056ba(0x224)]==_0x3dcd68['botID'])[_0x1056ba(0x1e7)];_0x2209ce+=_0x1056ba(0x2ae)+_0x3dcd68['botID']+':\x20'+_0x3dcd68['status']+_0x1056ba(0x1fa)+_0x3c67d0+_0x1056ba(0x1fa)+_0x3dcd68[_0x1056ba(0x1dd)]+'\x0a';}),_0x2209ce+='\x0a',_0x2209ce+=_0x8af5ee(0x202),_0x2209ce+=!settings['telegramEnabled']?'Notifications\x20disabled\x0a':_0x8af5ee(0x28d),_0x2209ce+=settings[_0x8af5ee(0x1ca)]?settings['telegramEvents']=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x8af5ee(0x1cc)+settings['telegramEvents']+'\x20only\x0a':'',tgBot[_0x8af5ee(0x2d7)](_0x247356[_0x8af5ee(0x14d)]['id'],_0x2209ce,{'parse_mode':'HTML'})[_0x8af5ee(0x220)](_0x5bcd21=>{telegramError(_0x5bcd21);});}),tgBot['onText'](/\/restart/,_0x2ab6b2=>{const _0x3f3ed5=_0x448c4d;if(!validateTelegram(_0x2ab6b2))return;tgBot['removeListener']('callback_query');const _0x5f1aa7=getEnabledBots();if(_0x5f1aa7[_0x3f3ed5(0x2c5)]==0x0)tgBot['sendMessage'](_0x2ab6b2['chat']['id'],_0x3f3ed5(0x1ec))[_0x3f3ed5(0x220)](_0xfeb16=>{telegramError(_0xfeb16);});else{if(_0x5f1aa7[_0x3f3ed5(0x2c5)]>0x1)_0x5f1aa7[_0x3f3ed5(0x24e)]({'botID':_0x3f3ed5(0x1b0)});let _0x453d43=[],_0xcf9141=[];const _0x5e025a=_0x5f1aa7[_0x3f3ed5(0x2c5)]%0x4==0x0||_0x5f1aa7['length']%0x4==0x3||_0x5f1aa7[_0x3f3ed5(0x2c5)]%0x3==0x1?0x4:0x3;let _0x2fc425=0x0;_0x5f1aa7[_0x3f3ed5(0x2f9)]((_0x53b9f2,_0x527cce)=>{const _0x30b842=_0x3f3ed5;if(_0x527cce%_0x5e025a==0x0)_0xcf9141=[];_0xcf9141[_0x30b842(0x24e)]({'text':_0x53b9f2[_0x30b842(0x224)]==_0x30b842(0x1b0)?_0x30b842(0x2e9):_0x30b842(0x2ae)+_0x53b9f2[_0x30b842(0x224)],'callback_data':_0x53b9f2[_0x30b842(0x224)]}),_0x527cce%_0x5e025a==0x0&&(_0x453d43[_0x2fc425]=_0xcf9141,_0x2fc425++);}),tgBot[_0x3f3ed5(0x2d7)](_0x2ab6b2[_0x3f3ed5(0x14d)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x453d43}})[_0x3f3ed5(0x220)](_0x380cdd=>{telegramError(_0x380cdd);}),tgBot['on'](_0x3f3ed5(0x1c0),async _0x378d88=>{const _0x517b70=_0x3f3ed5,_0x31b238=_0x378d88[_0x517b70(0x2de)],_0x4073f4=_0x378d88['message'];tgBot[_0x517b70(0x311)](_0x378d88['id'])[_0x517b70(0x1fb)](async()=>{const _0x13f345=_0x517b70;_0x31b238==_0x13f345(0x1b0)?config['forEach'](_0x4c8e1e=>{const _0xa5f320=_0x13f345;restartBot(_0x4c8e1e[_0xa5f320(0x224)]);}):restartBot(_0x31b238);}),tgBot[_0x517b70(0x302)](_0x517b70(0x1c0));});}}),tgBot[_0x448c4d(0x27b)](/\/on/,_0x306870=>{const _0x16d643=_0x448c4d;if(!validateTelegram(_0x306870))return;tgBot[_0x16d643(0x302)](_0x16d643(0x1c0));const _0xda116b=getDisabledBots();if(_0xda116b[_0x16d643(0x2c5)]==0x0)tgBot[_0x16d643(0x2d7)](_0x306870[_0x16d643(0x14d)]['id'],_0x16d643(0x301))[_0x16d643(0x220)](_0x4dd4d1=>{telegramError(_0x4dd4d1);});else{if(_0xda116b[_0x16d643(0x2c5)]>0x1)_0xda116b[_0x16d643(0x24e)]({'botID':_0x16d643(0x1b0)});let _0x744b22=[],_0x182463=[];const _0x577450=_0xda116b['length']%0x4==0x0||_0xda116b[_0x16d643(0x2c5)]%0x4==0x3||_0xda116b[_0x16d643(0x2c5)]%0x3==0x1?0x4:0x3;let _0x7ef302=0x0;_0xda116b[_0x16d643(0x2f9)]((_0xdfbf21,_0x21cccd)=>{const _0xf46106=_0x16d643;if(_0x21cccd%_0x577450==0x0)_0x182463=[];_0x182463[_0xf46106(0x24e)]({'text':_0xdfbf21[_0xf46106(0x224)]==_0xf46106(0x1b0)?_0xf46106(0x2e9):_0xf46106(0x2ae)+_0xdfbf21[_0xf46106(0x224)],'callback_data':_0xdfbf21['botID']}),_0x21cccd%_0x577450==0x0&&(_0x744b22[_0x7ef302]=_0x182463,_0x7ef302++);}),tgBot[_0x16d643(0x2d7)](_0x306870[_0x16d643(0x14d)]['id'],_0x16d643(0x17a),{'reply_markup':{'inline_keyboard':_0x744b22}})[_0x16d643(0x220)](_0x28d5ae=>{telegramError(_0x28d5ae);}),tgBot['on'](_0x16d643(0x1c0),async _0x25b879=>{const _0x308c9d=_0x16d643,_0x30c259=_0x25b879[_0x308c9d(0x2de)],_0x3b83aa=_0x25b879['message'];tgBot[_0x308c9d(0x311)](_0x25b879['id'])[_0x308c9d(0x1fb)](async()=>{const _0x1998d9=_0x308c9d;_0x30c259=='all'?(tgBot[_0x1998d9(0x2d7)](_0x3b83aa[_0x1998d9(0x14d)]['id'],_0x1998d9(0x209))[_0x1998d9(0x220)](_0x5a504d=>{telegramError(_0x5a504d);}),_0xda116b[_0x1998d9(0x2f9)](_0x31a5a9=>{const _0x2298a1=_0x1998d9;if(_0x31a5a9[_0x2298a1(0x224)]!=_0x2298a1(0x1b0))toggleBot(_0x31a5a9[_0x2298a1(0x224)],toggleStatus(_0x31a5a9[_0x2298a1(0x224)]),_0x2298a1(0x21c));})):(tgBot['sendMessage'](_0x3b83aa[_0x1998d9(0x14d)]['id'],_0x1998d9(0x254)+_0x30c259)['catch'](_0x272a15=>{telegramError(_0x272a15);}),toggleBot(_0x30c259,toggleStatus(_0x30c259),_0x1998d9(0x21c)));}),tgBot[_0x308c9d(0x302)](_0x308c9d(0x1c0));});}}),tgBot[_0x448c4d(0x27b)](/\/off/,_0x1d0f80=>{const _0x2d7b91=_0x448c4d;if(!validateTelegram(_0x1d0f80))return;tgBot[_0x2d7b91(0x302)]('callback_query');const _0x1ac213=getEnabledBots();if(_0x1ac213[_0x2d7b91(0x2c5)]==0x0)tgBot[_0x2d7b91(0x2d7)](_0x1d0f80[_0x2d7b91(0x14d)]['id'],_0x2d7b91(0x1ec))[_0x2d7b91(0x220)](_0x52c925=>{telegramError(_0x52c925);});else{if(_0x1ac213[_0x2d7b91(0x2c5)]>0x1)_0x1ac213['push']({'botID':_0x2d7b91(0x1b0)});let _0x2ae9c0=[],_0x43e0a6=[];const _0xe10dde=_0x1ac213[_0x2d7b91(0x2c5)]%0x4==0x0||_0x1ac213[_0x2d7b91(0x2c5)]%0x4==0x3||_0x1ac213[_0x2d7b91(0x2c5)]%0x3==0x1?0x4:0x3;let _0x3fae40=0x0;_0x1ac213['forEach']((_0x76ecac,_0x842655)=>{const _0x2af762=_0x2d7b91;if(_0x842655%_0xe10dde==0x0)_0x43e0a6=[];_0x43e0a6[_0x2af762(0x24e)]({'text':_0x76ecac[_0x2af762(0x224)]=='all'?_0x2af762(0x2e9):_0x2af762(0x2ae)+_0x76ecac[_0x2af762(0x224)],'callback_data':_0x76ecac['botID']}),_0x842655%_0xe10dde==0x0&&(_0x2ae9c0[_0x3fae40]=_0x43e0a6,_0x3fae40++);}),tgBot[_0x2d7b91(0x2d7)](_0x1d0f80[_0x2d7b91(0x14d)]['id'],_0x2d7b91(0x318),{'reply_markup':{'inline_keyboard':_0x2ae9c0}})[_0x2d7b91(0x220)](_0x27a1af=>{telegramError(_0x27a1af);}),tgBot['on'](_0x2d7b91(0x1c0),async _0x22d5cc=>{const _0x373d8c=_0x2d7b91,_0x4005f7=_0x22d5cc['data'],_0x5c2200=_0x22d5cc['message'];tgBot[_0x373d8c(0x311)](_0x22d5cc['id'])[_0x373d8c(0x1fb)](async()=>{const _0x170918=_0x373d8c;_0x4005f7==_0x170918(0x1b0)?(tgBot[_0x170918(0x2d7)](_0x5c2200['chat']['id'],_0x170918(0x19f))['catch'](_0x2fc8e0=>{telegramError(_0x2fc8e0);}),_0x1ac213['forEach'](_0x513e6e=>{const _0x23d6bd=_0x170918;if(_0x513e6e['botID']!=_0x23d6bd(0x1b0))toggleBot(_0x513e6e[_0x23d6bd(0x224)],toggleStatus(_0x513e6e[_0x23d6bd(0x224)]),'stopped');})):(tgBot[_0x170918(0x2d7)](_0x5c2200[_0x170918(0x14d)]['id'],_0x170918(0x1fd)+_0x4005f7)[_0x170918(0x220)](_0x1b86b7=>{telegramError(_0x1b86b7);}),toggleBot(_0x4005f7,toggleStatus(_0x4005f7),_0x170918(0x21c)));}),tgBot['removeListener']('callback_query');});}}),tgBot[_0x448c4d(0x27b)](/\/metrics/,_0x22f466=>{const _0x5fd138=_0x448c4d;if(!validateTelegram(_0x22f466))return;tgBot[_0x5fd138(0x302)](_0x5fd138(0x1c0));const _0x921b24=getEnabledBots();if(_0x921b24['length']==0x0)tgBot[_0x5fd138(0x2d7)](_0x22f466[_0x5fd138(0x14d)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x5fd138(0x220)](_0x5d5c56=>{telegramError(_0x5d5c56);});else{if(_0x921b24['length']>0x1){let _0x52154a=[],_0x435bdf=[];const _0x2b66dd=_0x921b24[_0x5fd138(0x2c5)]%0x4==0x0||_0x921b24[_0x5fd138(0x2c5)]%0x4==0x3||_0x921b24[_0x5fd138(0x2c5)]%0x3==0x1?0x4:0x3;let _0x44492b=0x0;_0x921b24['forEach']((_0x3403a4,_0xb7c79c)=>{const _0x3c0718=_0x5fd138;if(_0xb7c79c%_0x2b66dd==0x0)_0x435bdf=[];_0x435bdf['push']({'text':_0x3c0718(0x2ae)+_0x3403a4[_0x3c0718(0x224)],'callback_data':_0x3403a4[_0x3c0718(0x224)]}),_0xb7c79c%_0x2b66dd==0x0&&(_0x52154a[_0x44492b]=_0x435bdf,_0x44492b++);}),tgBot['sendMessage'](_0x22f466[_0x5fd138(0x14d)]['id'],_0x5fd138(0x247),{'reply_markup':{'inline_keyboard':_0x52154a}})[_0x5fd138(0x220)](_0x1145b6=>{telegramError(_0x1145b6);}),tgBot['on']('callback_query',async _0x59cb78=>{const _0x5b1ccc=_0x5fd138,_0xe3d6f5=_0x59cb78[_0x5b1ccc(0x2de)],_0x3ea061=_0x59cb78['message'];tgBot[_0x5b1ccc(0x311)](_0x59cb78['id'])[_0x5b1ccc(0x1fb)](async()=>{const _0x5322c2=_0x5b1ccc;if(pid[_0xe3d6f5])pid[_0xe3d6f5][_0x5322c2(0x1a4)]({'function':_0x5322c2(0x2d0),'args':null});}),tgBot[_0x5b1ccc(0x302)](_0x5b1ccc(0x1c0));});}else{const _0xb189a2=_0x921b24[0x0][_0x5fd138(0x224)];if(pid[_0xb189a2])pid[_0xb189a2][_0x5fd138(0x1a4)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x448c4d(0x27b)](/\/portfolio/,_0x5224a3=>{const _0x2d7848=_0x448c4d;if(!validateTelegram(_0x5224a3))return;tgBot[_0x2d7848(0x302)](_0x2d7848(0x1c0));const _0x5ee1aa=getEnabledBots();if(_0x5ee1aa[_0x2d7848(0x2c5)]==0x0)tgBot[_0x2d7848(0x2d7)](_0x5224a3[_0x2d7848(0x14d)]['id'],_0x2d7848(0x1ec))['catch'](_0x725abd=>{telegramError(_0x725abd);});else{if(_0x5ee1aa['length']>0x1){let _0x48e706=[],_0x175f69=[];const _0x594873=_0x5ee1aa['length']%0x4==0x0||_0x5ee1aa['length']%0x4==0x3||_0x5ee1aa['length']%0x3==0x1?0x4:0x3;let _0x92e7a4=0x0;_0x5ee1aa['forEach']((_0xbaeb28,_0x2fc38c)=>{const _0x45a063=_0x2d7848;if(_0x2fc38c%_0x594873==0x0)_0x175f69=[];_0x175f69[_0x45a063(0x24e)]({'text':_0x45a063(0x2ae)+_0xbaeb28[_0x45a063(0x224)],'callback_data':_0xbaeb28[_0x45a063(0x224)]}),_0x2fc38c%_0x594873==0x0&&(_0x48e706[_0x92e7a4]=_0x175f69,_0x92e7a4++);}),tgBot[_0x2d7848(0x2d7)](_0x5224a3[_0x2d7848(0x14d)]['id'],_0x2d7848(0x1a7),{'reply_markup':{'inline_keyboard':_0x48e706}})[_0x2d7848(0x220)](_0x19daa6=>{telegramError(_0x19daa6);}),tgBot['on'](_0x2d7848(0x1c0),async _0x2000cd=>{const _0x4601d5=_0x2d7848,_0xa01478=_0x2000cd[_0x4601d5(0x2de)],_0x2f41a3=_0x2000cd['message'];tgBot[_0x4601d5(0x311)](_0x2000cd['id'])[_0x4601d5(0x1fb)](async()=>{const _0x16a704=_0x4601d5;if(pid[_0xa01478])pid[_0xa01478][_0x16a704(0x1a4)]({'function':_0x16a704(0x284),'args':null});}),tgBot[_0x4601d5(0x302)](_0x4601d5(0x1c0));});}else{const _0x264d78=_0x5ee1aa[0x0][_0x2d7848(0x224)];if(pid[_0x264d78])pid[_0x264d78][_0x2d7848(0x1a4)]({'function':_0x2d7848(0x284),'args':null});}}}),tgBot[_0x448c4d(0x27b)](/\/update/,async _0x290f14=>{const _0xc0b462=_0x448c4d;if(!validateTelegram(_0x290f14))return;tgBot[_0xc0b462(0x302)]('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0xc0b462(0x2d7)](_0x290f14[_0xc0b462(0x14d)]['id'],_0xc0b462(0x151))['catch'](_0x339fb6=>{telegramError(_0x339fb6);});else!validInstallation?tgBot[_0xc0b462(0x2d7)](_0x290f14['chat']['id'],_0xc0b462(0x1c7))['catch'](_0x5e698b=>{telegramError(_0x5e698b);}):(tgBot[_0xc0b462(0x2d7)](_0x290f14['chat']['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0xc0b462(0x28b),'callback_data':_0xc0b462(0x26f)},{'text':'No','callback_data':'no'}]]}})[_0xc0b462(0x220)](_0x5144d8=>{telegramError(_0x5144d8);}),tgBot['on'](_0xc0b462(0x1c0),async _0x2c4135=>{const _0x27178a=_0xc0b462,_0x54a824=_0x2c4135[_0x27178a(0x2de)],_0x170449=_0x2c4135[_0x27178a(0x2bd)];tgBot[_0x27178a(0x311)](_0x2c4135['id'])[_0x27178a(0x1fb)](async()=>{const _0x5f00d1=_0x27178a;_0x54a824==_0x5f00d1(0x26f)&&(await tgBot[_0x5f00d1(0x2d7)](_0x170449['chat']['id'],'Starting\x20Balance\x20Bot\x20update')[_0x5f00d1(0x220)](_0x4d91db=>{telegramError(_0x4d91db);}),updateBB(_0x5f00d1(0x203))),_0x54a824=='no'&&await tgBot[_0x5f00d1(0x2d7)](_0x170449['chat']['id'],_0x5f00d1(0x207))[_0x5f00d1(0x220)](_0xcd6517=>{telegramError(_0xcd6517);});}),tgBot[_0x27178a(0x302)](_0x27178a(0x1c0));}));}),tgBot[_0x448c4d(0x27b)](/\/reinstall/,async _0x5b3529=>{const _0x18f4a1=_0x448c4d;if(!validateTelegram(_0x5b3529))return;tgBot[_0x18f4a1(0x302)](_0x18f4a1(0x1c0)),!validInstallation?tgBot['sendMessage'](_0x5b3529['chat']['id'],_0x18f4a1(0x231))[_0x18f4a1(0x220)](_0x547a2b=>{telegramError(_0x547a2b);}):(tgBot[_0x18f4a1(0x2d7)](_0x5b3529[_0x18f4a1(0x14d)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x18f4a1(0x28b),'callback_data':_0x18f4a1(0x26f)},{'text':'No','callback_data':'no'}]]}})[_0x18f4a1(0x220)](_0x370dd0=>{telegramError(_0x370dd0);}),tgBot['on']('callback_query',async _0x23094a=>{const _0x3a57b9=_0x18f4a1,_0x459cdd=_0x23094a['data'],_0x148266=_0x23094a['message'];tgBot[_0x3a57b9(0x311)](_0x23094a['id'])[_0x3a57b9(0x1fb)](async()=>{const _0x2d0131=_0x3a57b9;_0x459cdd==_0x2d0131(0x26f)&&(await tgBot[_0x2d0131(0x2d7)](_0x148266[_0x2d0131(0x14d)]['id'],_0x2d0131(0x2da))[_0x2d0131(0x220)](_0x242783=>{telegramError(_0x242783);}),updateBB(_0x2d0131(0x1aa))),_0x459cdd=='no'&&await tgBot[_0x2d0131(0x2d7)](_0x148266['chat']['id'],_0x2d0131(0x275))[_0x2d0131(0x220)](_0x2ba2ea=>{telegramError(_0x2ba2ea);});}),tgBot['removeListener']('callback_query');}));}),tgBot[_0x448c4d(0x27b)](/\/toggle/,_0x471a89=>{const _0x5b3427=_0x448c4d;if(!validateTelegram(_0x471a89))return;tgBot[_0x5b3427(0x302)](_0x5b3427(0x1c0));const _0x62bb89=getBotsWithMode();if(_0x62bb89[_0x5b3427(0x2c5)]==0x0)tgBot['sendMessage'](_0x471a89[_0x5b3427(0x14d)]['id'],_0x5b3427(0x1ec))['catch'](_0x49b9aa=>{telegramError(_0x49b9aa);});else{let _0x156ff9=[],_0x3c07a1=[];const _0x26b1ec=0x2;let _0x3c8d35=0x0;_0x62bb89[_0x5b3427(0x2f9)]((_0x4e370a,_0xc925b9)=>{const _0x443b77=_0x5b3427;if(_0xc925b9%_0x26b1ec==0x0)_0x3c07a1=[];_0x3c07a1['push']({'text':_0x443b77(0x2ae)+_0x4e370a[_0x443b77(0x224)]+'\x20('+_0x4e370a[_0x443b77(0x1e7)]+')','callback_data':_0x4e370a[_0x443b77(0x224)]}),_0xc925b9%_0x26b1ec==0x0&&(_0x156ff9[_0x3c8d35]=_0x3c07a1,_0x3c8d35++);}),tgBot[_0x5b3427(0x2d7)](_0x471a89[_0x5b3427(0x14d)]['id'],_0x5b3427(0x22f),{'reply_markup':{'inline_keyboard':_0x156ff9}})[_0x5b3427(0x220)](_0x36e977=>{telegramError(_0x36e977);}),tgBot['on'](_0x5b3427(0x1c0),async _0x3d3896=>{const _0x281163=_0x5b3427,_0x54ab05=_0x3d3896[_0x281163(0x2de)],_0x35a3a3=_0x3d3896[_0x281163(0x2bd)];tgBot[_0x281163(0x311)](_0x3d3896['id'])[_0x281163(0x1fb)](async()=>{const _0x44256b=_0x281163,_0x2b2801=_0x62bb89[_0x44256b(0x1d7)](_0x56f16a=>_0x56f16a[_0x44256b(0x224)]==_0x54ab05),_0x5729dd=_0x2b2801[_0x44256b(0x1e7)]==_0x44256b(0x19c)?'manual':_0x44256b(0x19c);tgBot[_0x44256b(0x2d7)](_0x35a3a3[_0x44256b(0x14d)]['id'],_0x44256b(0x1e8)+_0x54ab05+'\x20to\x20'+_0x5729dd+_0x44256b(0x262))[_0x44256b(0x220)](_0x2982d2=>{telegramError(_0x2982d2);}),toggleBotMode(_0x54ab05);}),tgBot['removeListener'](_0x281163(0x1c0));});}}),tgBot[_0x448c4d(0x27b)](/\/names/,_0x39fd8c=>{const _0xd8e020=_0x448c4d;if(!validateTelegram(_0x39fd8c))return;let _0x5f093b='';config[_0xd8e020(0x2f9)](_0x145a21=>{const _0x1b0f6a=_0xd8e020;_0x5f093b+=_0x1b0f6a(0x2ae)+_0x145a21[_0x1b0f6a(0x224)]+':\x20'+_0x145a21[_0x1b0f6a(0x15d)]+'\x0a';}),tgBot[_0xd8e020(0x2d7)](_0x39fd8c[_0xd8e020(0x14d)]['id'],_0x5f093b,{'parse_mode':_0xd8e020(0x288)})['catch'](_0x2c46b8=>{telegramError(_0x2c46b8);});}),tgBot[_0x448c4d(0x27b)](/\/disable/,_0x782c39=>{const _0x5a0f85=_0x448c4d;if(!validateTelegram(_0x782c39))return;tgBot[_0x5a0f85(0x2d7)](_0x782c39[_0x5a0f85(0x14d)]['id'],_0x5a0f85(0x1c1))['catch'](_0x21c85a=>{telegramError(_0x21c85a);}),updateSetting(_0x5a0f85(0x1ca),![]);}),tgBot['onText'](/\/help/,_0x53994b=>{const _0xde47a7=_0x448c4d;if(!validateTelegram(_0x53994b))return;tgBot['sendMessage'](_0x53994b[_0xde47a7(0x14d)]['id'],_0x5c9b10)[_0xde47a7(0x220)](_0x1d1a75=>{telegramError(_0x1d1a75);});}),tgBot['on'](_0x448c4d(0x208),_0x4b26af=>{const _0x50a4ee=_0x448c4d;_0x4b26af[_0x50a4ee(0x2ad)]()[_0x50a4ee(0x1d3)]('404\x20Not\x20Found')&&(logger[_0x50a4ee(0x17c)](_0x50a4ee(0x2b6)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x50a4ee(0x253))[_0x50a4ee(0x249)](_0x50a4ee(0x30e),_0x50a4ee(0x2b6)));}),process[_0x448c4d(0x25b)](_0x448c4d(0x185),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);}),process[_0x448c4d(0x25b)](_0x448c4d(0x313),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);});}}function disableTelegram(){const _0x24f6bd=_0x39a6ea;tgBot&&(tgBot[_0x24f6bd(0x2fe)](),tgBot=null);}function sendTelegram(_0x19bad6,_0x546af8){const _0x2d2532=_0x39a6ea;if(settings[_0x2d2532(0x1ca)]){if(settings[_0x2d2532(0x2df)]==_0x2d2532(0x1b0)||(_0x546af8['type']==_0x2d2532(0x2f7)||_0x546af8[_0x2d2532(0x2d2)]==_0x2d2532(0x20b)||_0x546af8['type']==_0x2d2532(0x22e))&&settings[_0x2d2532(0x2df)]==_0x2d2532(0x26c)||_0x546af8['type']==_0x2d2532(0x15b)&&settings[_0x2d2532(0x2df)]=='orders'){if(tgBot&&settings['telegramChatId']){if(_0x546af8[_0x2d2532(0x2bc)])tgBot[_0x2d2532(0x2d7)](settings[_0x2d2532(0x1bd)],_0x546af8[_0x2d2532(0x15d)]+_0x2d2532(0x213)+_0x546af8[_0x2d2532(0x307)])[_0x2d2532(0x220)](_0x45e617=>{telegramError(_0x45e617);});else tgBot[_0x2d2532(0x2d7)](settings[_0x2d2532(0x1bd)],_0x2d2532(0x2ae)+_0x19bad6+'\x20>\x20'+_0x546af8[_0x2d2532(0x307)])['catch'](_0x21ef2c=>{telegramError(_0x21ef2c);});}}}}async function sendTelegramMsg(_0x56a10f,_0x4c11bd='HTML'){const _0x50f90a=_0x39a6ea;return settings[_0x50f90a(0x1ca)]&&tgBot&&settings[_0x50f90a(0x1bd)]?(await tgBot[_0x50f90a(0x2d7)](settings[_0x50f90a(0x1bd)],_0x56a10f,{'parse_mode':_0x4c11bd})['catch'](_0x5174fd=>{telegramError(_0x5174fd);}),!![]):![];}function getDeviceWithIp(_0x325aca){const _0x2d9da8=_0x39a6ea;return devices[_0x2d9da8(0x1d7)](_0x2f3c40=>_0x2f3c40['ip']===_0x325aca);}function temporaryAccess2FA(_0xb29e6,_0x346d2a){const _0x3dbad9=_0x39a6ea;let _0x4e7183=new Date(),_0x1b3ce4=![];if(lastIpApproval){if(_0x4e7183-lastIpApproval<0x1388)_0x1b3ce4=!![];}lastIpApproval=new Date();if(_0x1b3ce4)return;tgBot&&settings[_0x3dbad9(0x1bd)]&&(tgBot[_0x3dbad9(0x302)](_0x3dbad9(0x1c0)),tgBot[_0x3dbad9(0x2d7)](settings[_0x3dbad9(0x1bd)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x346d2a)['show']+_0x3dbad9(0x2f6),{'parse_mode':_0x3dbad9(0x288),'reply_markup':{'inline_keyboard':[[{'text':_0x3dbad9(0x272),'callback_data':'5'},{'text':_0x3dbad9(0x310),'callback_data':'15'},{'text':_0x3dbad9(0x198),'callback_data':'30'},{'text':'reject','callback_data':_0x3dbad9(0x265)}]]}})[_0x3dbad9(0x220)](_0x190bd0=>{telegramError(_0x190bd0);}),tgBot['on'](_0x3dbad9(0x1c0),async _0x1944ff=>{const _0xb40cc9=_0x3dbad9,_0x58e3a6=_0x1944ff[_0xb40cc9(0x2de)],_0xab0d83=_0x1944ff[_0xb40cc9(0x2bd)];tgBot[_0xb40cc9(0x311)](_0x1944ff['id'])[_0xb40cc9(0x1fb)](async()=>{const _0x5428fe=_0xb40cc9;devices[_0xb29e6][_0x5428fe(0x1d1)]={'clientip':_0x346d2a,'timestamp':new Date()[_0x5428fe(0x1b4)](),'expiry':_0x58e3a6},_0x58e3a6!=_0x5428fe(0x265)?(await tgBot[_0x5428fe(0x2d7)](_0xab0d83[_0x5428fe(0x14d)]['id'],'Access\x20enabled\x20for\x20'+_0x58e3a6+_0x5428fe(0x1ee),{'parse_mode':_0x5428fe(0x288)})[_0x5428fe(0x220)](_0x1bd50a=>{telegramError(_0x1bd50a);}),io['to'](_0xb29e6)['emit']('status',{'access':{'allow':![],'reason':_0x5428fe(0x1ed),'token':null}})):(await tgBot[_0x5428fe(0x2d7)](_0xab0d83[_0x5428fe(0x14d)]['id'],_0x5428fe(0x1ba))['catch'](_0x55a709=>{telegramError(_0x55a709);}),io['to'](_0xb29e6)[_0x5428fe(0x249)](_0x5428fe(0x216),{'access':{'allow':![],'reason':_0x5428fe(0x1b3),'token':null}}));}),tgBot[_0xb40cc9(0x302)](_0xb40cc9(0x1c0));}));}function loginAccess2FA(_0x28e4a2,_0x5432db){const _0x5288b8=_0x39a6ea;tgBot&&settings['telegramChatId']&&(tgBot[_0x5288b8(0x302)]('callback_query'),tgBot[_0x5288b8(0x2d7)](settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x5432db)['show']+'</b>\x20?',{'parse_mode':_0x5288b8(0x288),'reply_markup':{'inline_keyboard':[[{'text':_0x5288b8(0x142),'callback_data':loginExpiry},{'text':_0x5288b8(0x265),'callback_data':_0x5288b8(0x265)}]]}})['catch'](_0x5521c2=>{telegramError(_0x5521c2);}),tgBot['on']('callback_query',async _0x646c85=>{const _0x4ef38a=_0x5288b8,_0x1d41ed=_0x646c85[_0x4ef38a(0x2de)],_0x23a295=_0x646c85['message'];tgBot[_0x4ef38a(0x311)](_0x646c85['id'])[_0x4ef38a(0x1fb)](async()=>{const _0x2c8aaa=_0x4ef38a;devices[_0x28e4a2][_0x2c8aaa(0x2f0)]={'clientip':_0x5432db,'timestamp':new Date()['getTime'](),'expiry':_0x1d41ed},_0x1d41ed!=_0x2c8aaa(0x265)?(await tgBot['sendMessage'](_0x23a295[_0x2c8aaa(0x14d)]['id'],_0x2c8aaa(0x317),{'parse_mode':_0x2c8aaa(0x288)})[_0x2c8aaa(0x220)](_0x17cf76=>{telegramError(_0x17cf76);}),io['to'](_0x28e4a2)[_0x2c8aaa(0x249)]('status',{'access':{'allow':![],'reason':_0x2c8aaa(0x1ed),'token':null}})):(await tgBot[_0x2c8aaa(0x2d7)](_0x23a295['chat']['id'],_0x2c8aaa(0x2ff))[_0x2c8aaa(0x220)](_0x2b4288=>{telegramError(_0x2b4288);}),io['to'](_0x28e4a2)[_0x2c8aaa(0x249)](_0x2c8aaa(0x216),{'access':{'allow':![],'reason':_0x2c8aaa(0x1db),'token':null}}));}),tgBot[_0x4ef38a(0x302)](_0x4ef38a(0x1c0));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x49a5db=_0x39a6ea;return dbConfig[_0x49a5db(0x28e)](_0x49a5db(0x210))[_0x49a5db(0x18d)](_0x49a5db(0x224))[_0x49a5db(0x14b)]({'status':_0x49a5db(0x30d)})['value']()||[];}function getDisabledBots(){const _0x496f49=_0x39a6ea;return dbConfig['get'](_0x496f49(0x210))[_0x496f49(0x18d)](_0x496f49(0x224))['filter']({'status':_0x496f49(0x1e2)})[_0x496f49(0x241)]()||[];}function getBotAttributes(_0x314039){const _0x1ec5ec=_0x39a6ea;let _0xba39a6={};const _0x138340=configpath+_0x1ec5ec(0x2cd)+_0x314039+'-config.json',_0x55c4ef=fs[_0x1ec5ec(0x261)](_0x138340);if(_0x55c4ef){const _0x203406=fs['readFileSync'](_0x138340);try{const _0x46fcd7=JSON[_0x1ec5ec(0x229)](_0x203406),_0x1e2a3a=_0x46fcd7?_0x46fcd7[_0x1ec5ec(0x270)][0x0][_0x1ec5ec(0x191)]:![];_0xba39a6[_0x1ec5ec(0x1e7)]=_0x1e2a3a?_0x1ec5ec(0x19c):_0x1ec5ec(0x27e),_0xba39a6['botname']=_0x46fcd7?_0x46fcd7[_0x1ec5ec(0x270)][0x0][_0x1ec5ec(0x15d)]:_0x1ec5ec(0x2ae)+_0x314039;}catch(_0x5a5684){_0xba39a6[_0x1ec5ec(0x1e7)]='manual',_0xba39a6[_0x1ec5ec(0x15d)]=_0x1ec5ec(0x2ae)+_0x314039;}}else _0xba39a6[_0x1ec5ec(0x1e7)]=_0x1ec5ec(0x27e),_0xba39a6[_0x1ec5ec(0x15d)]='Bot\x20'+_0x314039;return _0xba39a6;}function getBotsWithMode(){const _0x16dcd4=_0x39a6ea,_0x14cb1a=dbConfig[_0x16dcd4(0x28e)]('bots')['sortBy']('botID')[_0x16dcd4(0x241)]()||[];return _0x14cb1a[_0x16dcd4(0x2f9)](_0x3021e0=>{const _0x447f1c=_0x16dcd4;let _0x8be69e=getBotAttributes(_0x3021e0[_0x447f1c(0x224)]);_0x3021e0[_0x447f1c(0x1e7)]=_0x8be69e[_0x447f1c(0x1e7)];}),_0x14cb1a;}function getBotExchanges(){const _0xfed9a0=_0x39a6ea;let _0x506b0b=[];const _0x158e64=dbConfig[_0xfed9a0(0x28e)](_0xfed9a0(0x210))['sortBy']('botID')[_0xfed9a0(0x241)]()||[];_0x158e64[_0xfed9a0(0x2f9)](_0x116781=>{const _0x10feed=_0xfed9a0;if(_0x116781[_0x10feed(0x216)]==_0x10feed(0x30d)){const _0x18db0e=configpath+_0x10feed(0x2cd)+_0x116781[_0x10feed(0x224)]+'-config.json',_0x2a387a=fs[_0x10feed(0x261)](_0x18db0e);let _0x3cd584;if(_0x2a387a){const _0x1e0f8d=fs['readFileSync'](_0x18db0e);try{const _0x387948=JSON[_0x10feed(0x229)](_0x1e0f8d);_0x3cd584=_0x387948?_0x387948[_0x10feed(0x270)][0x0][_0x10feed(0x146)]:null;}catch(_0x4e7417){}}if(_0x3cd584)_0x506b0b[_0x10feed(0x24e)](_0x3cd584);}});const _0x4fe3f6=[...new Set(_0x506b0b)][_0xfed9a0(0x140)]();return _0x4fe3f6;}async function initUser(){const _0x42dc1a=_0x39a6ea;if(!settings[_0x42dc1a(0x2a0)]){const _0x4fc5e5=uuidRandom();mixpanel[_0x42dc1a(0x29e)](_0x4fc5e5),updateSetting(_0x42dc1a(0x2a0),_0x4fc5e5);}}async function initSecure(){const _0x3e2e83=_0x39a6ea;let _0x2a7a06=getSecure();if(!_0x2a7a06[_0x3e2e83(0x18c)](_0x3e2e83(0x2e7))){let _0x17bd54=await generateKeys();_0x2a7a06['publicKey']=_0x17bd54[_0x3e2e83(0x280)],_0x2a7a06[_0x3e2e83(0x2b4)]=_0x17bd54[_0x3e2e83(0x2b4)],_0x2a7a06[_0x3e2e83(0x2e7)]=crypto['randomBytes'](0x20)['toString'](_0x3e2e83(0x235));;storeSecure(_0x2a7a06);}}function getSettings(){const _0x196a1d=_0x39a6ea;return dbSettings['get'](_0x196a1d(0x192))['value']()||{};}function getSecure(){const _0x50e717=_0x39a6ea;return dbSecure[_0x50e717(0x28e)](_0x50e717(0x2a3))[_0x50e717(0x241)]()||{};}function getBlacklist(){const _0x396c08=_0x39a6ea;return dbSecure[_0x396c08(0x28e)]('blacklist')[_0x396c08(0x241)]()||[];}function broadcastToBots(_0x19cde8,_0x24ee70){const _0x2b56ae=_0x39a6ea;config[_0x2b56ae(0x2f9)](_0x3b5676=>{const _0x5ea8fc=_0x2b56ae;if(_0x3b5676['status']==_0x5ea8fc(0x30d)&&_0x3b5676[_0x5ea8fc(0x1dd)]==_0x5ea8fc(0x204)||_0x3b5676[_0x5ea8fc(0x216)]==_0x5ea8fc(0x239)&&_0x3b5676[_0x5ea8fc(0x1dd)]==_0x5ea8fc(0x204)){if(pid[_0x3b5676[_0x5ea8fc(0x224)]])pid[_0x3b5676[_0x5ea8fc(0x224)]][_0x5ea8fc(0x1a4)]({[_0x19cde8]:_0x24ee70});}});}function storeSettings(_0x21d77b,_0x3e5fd5=![]){const _0x598666=_0x39a6ea;_0x21d77b={...settings,..._0x21d77b};if(_0x3e5fd5&&_0x21d77b[_0x598666(0x2f4)]!=_0x598666(0x28a)&&_0x21d77b[_0x598666(0x2f4)]!=_0x598666(0x25a)&&_0x21d77b['bbPassword']!=''){const _0x25a1a7=crypt[_0x598666(0x156)](secure[_0x598666(0x2b4)],_0x21d77b[_0x598666(0x2f4)])[_0x598666(0x2bd)][_0x598666(0x2ec)]('@')[0x0],_0x2e766b=bcrypt[_0x598666(0x2c0)](_0x25a1a7,saltRounds);_0x21d77b={..._0x21d77b,'bbPassword':_0x2e766b};}if(_0x3e5fd5&&_0x21d77b[_0x598666(0x2a7)]!=_0x598666(0x28a)&&_0x21d77b[_0x598666(0x2a7)]!=_0x598666(0x25a)&&_0x21d77b['telegramToken']!=''){const _0x41a15a=crypt['decrypt'](secure[_0x598666(0x2b4)],_0x21d77b['telegramToken'])['message']['split']('@')[0x0];_0x21d77b={..._0x21d77b,'telegramToken':_0x41a15a};}const _0x57b1ff=_0x21d77b['telegramToken']!='************'&&_0x21d77b['telegramToken']!=settings['telegramToken']||_0x21d77b[_0x598666(0x1f1)]!=settings[_0x598666(0x1f1)],_0x4d98e0=_0x21d77b['telegramToken']==''||_0x21d77b[_0x598666(0x1f1)]=='';if(_0x57b1ff)_0x21d77b[_0x598666(0x2df)]=_0x598666(0x1b0);for(const [_0xf05b53,_0xd04dbc]of Object[_0x598666(0x1ae)](_0x21d77b)){if(_0xf05b53==_0x598666(0x2a7)&&_0xd04dbc==_0x598666(0x28a)){_0x21d77b[_0x598666(0x2a7)]=settings[_0x598666(0x2a7)];continue;};if(_0xf05b53=='bbPassword'&&_0xd04dbc==_0x598666(0x28a)){_0x21d77b[_0x598666(0x2f4)]=settings[_0x598666(0x2f4)];continue;};dbSettings[_0x598666(0x29a)](_0x598666(0x30b)+_0xf05b53,_0xd04dbc)['write']();}settings=_0x21d77b,io['to']('botmanager')[_0x598666(0x249)]('settings',cleanSettings()),broadcastToBots('timeshift',settings[_0x598666(0x143)]),broadcastToBots(_0x598666(0x24d),settings['onepagemode']);if(_0x57b1ff&&!_0x4d98e0)initTelegram();if(_0x57b1ff&&_0x4d98e0)disableTelegram();getAllClients()['forEach'](_0x40b4f0=>{const _0x845a0d=_0x598666;getSocket(_0x40b4f0['id'])[_0x845a0d(0x249)](_0x845a0d(0x216),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x526154,_0x5aeec5){const _0x329072=_0x39a6ea;dbSettings[_0x329072(0x29a)](_0x329072(0x30b)+_0x526154,_0x5aeec5)[_0x329072(0x252)](),settings=getSettings(),io['to'](_0x329072(0x253))[_0x329072(0x249)](_0x329072(0x192),cleanSettings());}function storeSecure(_0x55c1ad){const _0x304178=_0x39a6ea;dbSecure['get'](_0x304178(0x2a3))['push'](_0x55c1ad)[_0x304178(0x252)](),secure=_0x55c1ad;}function addBlacklist(_0x2c5de4){const _0x2d8e06=_0x39a6ea;cleanBlacklist();let _0x370dd8;devices[_0x2c5de4][_0x2d8e06(0x1d1)]?_0x370dd8=Math[_0x2d8e06(0x240)](devices[_0x2c5de4][_0x2d8e06(0x1d1)][_0x2d8e06(0x238)],loginExpiry):_0x370dd8=loginExpiry,dbSecure[_0x2d8e06(0x28e)](_0x2d8e06(0x2ce))[_0x2d8e06(0x24e)]({'expiry':new Date()[_0x2d8e06(0x1b4)]()+_0x370dd8*0x3c*0x3e8,'token':devices[_0x2c5de4][_0x2d8e06(0x291)][_0x2d8e06(0x1be)]})['write'](),blacklist=dbSecure[_0x2d8e06(0x28e)]('blacklist')[_0x2d8e06(0x241)]();}function _0x11b6(){const _0x45844f=['chat','logout','statSync','address','Your\x20installation\x20is\x20already\x20up\x20to\x20date','debug','3000','connected','express-fileupload','decrypt','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','size','clients','Setting\x20access:\x20','order','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','botname','\x1b[33m','mixpanel','handshake','http','getSeconds','output-002.log','Starting\x20Balance\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20portfolio','readdirSync','ipc','backup-full','bb-settings.json','<b>Balance\x20Bot\x20Status:</b>\x0a','127.0.0.1','6b67f3d61ee94b8f5c80b4affef4c4d9','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','*$1*','toggle-bot-mode','allow','uuid','version','static','emitHistory','cancelLoading','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','args','/:bot/configuration','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','full','unlinkSync','/:bot/history','hybrid-crypto-js','Idling\x20bot\x20\x20\x20|\x20Bot\x20','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','#RES#\x20if\x20running\x20on\x20server','isValid','SIGINT','add','Logged\x20out\x20user\x20...','cloneDeep','update-bb','uuid-random','\x20(1)','hasOwnProperty','sortBy','track','exp','express','headless','settings','Backup\x20file\x20unzipped\x20and\x20stored','temporary\x20access\x20timeout','\x20|\x20user:\x20...','NTBA_FIX_319','logs','30\x20min','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','match','startsWith','auto','Ok,\x20will\x20send\x20alert\x20notifications\x20only','verify','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','removeAllListeners','output-001.log','delete-bot','send','started','login\x20not\x20required','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','uncaughtException','writeFileSync','reinstall','18YGJNue','files','store-fiat','entries','endsWith','all','api-eu.mixpanel.com','server','temporary\x20access\x20rejected','getTime','readFileSync','storeConfiguration','getFullYear','reason','/off\x20-\x20stop\x20bot(s)\x0a','Temporary\x20access\x20rejected','username','headers','telegramChatId','token','3697988EtLHOH','callback_query','Notifications\x20disabled','clientip','/upload-backup','2FA\x20login\x20required','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','use','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','(((.+)+)+)+$','request','telegramEnabled','inherit','Notifications\x20types:\x20','restart','Node.js\x20v','Unauthorized\x20attempt\x20to\x20show\x20configuration','toggleBotMode','telegramIpApproval','get-backup-files','includes','exit','/:bot/performance','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','find','timestamp','title','simple','2FA\x20login\x20rejected','/disable\x20-\x20disable\x20notifications\x0a','live','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','temporary\x20token\x20generated','/:bot','build','disabled',':\x20Bot\x20Mgr\x20>\x20','orders','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','remove','mode','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','User\x20has\x20been\x20validated','storeHeadless','remoteAddress','No\x20bots\x20running\x20right\x20now','reload','\x20minutes','padStart','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','telegramUsername','build2','listen','test','apiKey','/enable\x20-\x20enable\x20notifications\x0a','deleteHistoryAlerts','updatebotmanager','latestversion','\x20|\x20','then','Unauthorized\x20attempt\x20to\x20get\x20messages','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','range','min','from','host','<b>Telegram\x20Bot\x20Status:</b>\x0a','update','running','disconnect','argv','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','polling_error','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','sign','warning',',\x20must\x20be\x20a\x204\x20digit\x20number','2580085DIAQTx','DEFLATE','index.html','bots','whitelist','getHours','\x20>\x20','-results.json','mtime','status','RSA','telegram','Logged\x20in\x20user\x20...','loginRequired','function','stopped','apply','2FA\x20required','Password\x20reset\x20rejected','catch','Starting\x20new\x20bot\x20|\x20Bot\x20','You\x20can\x20use\x20the\x20following\x20commands:\x0a','cancel-loading','botID','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','generate','ipaddr.js','bbvNew','parse','reset-history','map','env','Unauthorized\x20attempt\x20to\x20store\x20configuration','success','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','node','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','family','6160364SsrHtx','lowdb/adapters/FileSync','hex','Restarting\x20Bot\x20','5600856byfqPi','expiry','new','child_process','sendFile','_data','date-fns','lastmsgemitted','[ip-address]','max','value','temporaryAccessAllowed','exec','getDate','jsonwebtoken','fork','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','lastmsgtelegram','emit','assign','2FA\x20login\x20token\x20generated','showConfig','onepagemode','push','pidExpireLogin','socket.io','login','write','botmanager','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','tkn','Error\x20while\x20deleting\x20config\x20files:\x20','$1_$2_$3','Unauthorized\x20attempt\x20to\x20get\x20events','***','once','store-configuration','Restoring\x20bot(s)\x20from\x20backup','Session\x20expired\x20for\x20user\x20...','-performance.json','params','existsSync','\x20mode','rmSync','bb/','reject','2FA','File\x20uploaded','\x1b[0m','Enabled\x20Bot\x20','ipv6','stringify','alerts',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Invalid\x20IP\x20address','yes','bot','binary','5\x20min','defaults','store','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','10kNJUNB','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','temporary\x20access\x20not\x20allowed','isDirectory','onText','file','Unauthorized\x20attempt\x20to\x20confirm\x20message','manual','output-003.log','publicKey','log','name','messages','sendPortfolioTelegram','axios','Restore\x20backup\x20file\x20','0.0.0','HTML','confirm-message','************','Yes','/help\x20-\x20show\x20available\x20commands\x0a','Notifications\x20enabled\x0a','get','Unauthorized\x20attempt\x20to\x20log\x20out','zip/','access','getStartingBalances','auth','=>\x20Go\x20to\x20#CYA#http://','Server','encryptedUuid','replace','path','add-bot','set','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','place-order','number','alias','telegrammsg','userid','Notifications\x20enabled','\x20(2)','secure','copyFileSync','Orders','Ok,\x20will\x20send\x20order\x20notifications\x20only','telegramToken','storeFiat','show-config','kind','compareSync','keys','toString','Bot\x20','version.json','backup','slice','getMinutes','graphql-request','privateKey','Unauthorized\x20attempt\x20to\x20add\x20bot','Invalid\x20Telegram\x20token','bbvReceive','15889Xrspch','54093ZTySTA','constructor','getMonth','showname','message','/:bot/coins','/metrics\x20-\x20show\x20bot\x20performance\x0a','hashSync','Unauthorized\x20attempt\x20to\x20update\x20bot','init','createServer','\x1b[31m','length','login\x20token\x20generated','access\x20timeout','format','crypto','Bot\x20Mgr\x20>\x20','Unauthorized\x20attempt\x20to\x20delete\x20bot','Backup\x20file\x20uploaded','bot-','blacklist','Password\x20has\x20been\x20reset\x20to:\x20','sendMetricsTelegram','IPv4','type','backup-files','Failed\x20to\x20download\x20','/names\x20-\x20show\x20bot\x20names\x0a','get-starting-balances','sendMessage','Crypt','connection','Starting\x20Balance\x20Bot\x20reinstallation','Token\x20blacklisted','.zip','conn','data','telegramEvents',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','/:bot/support','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','mkdirSync','whitelistEnabled','get-messages','any','secret','sockets','All\x20bots','node-zip','lowdb','split','Error:\x20Invalid\x20argument\x20','stop','reinstall-bb','telegram2FaApproval','restore-backup-file','get-logs','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','bbPassword','backup-full.zip','</b>\x20?','error','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','forEach','bb-secure.json','search','invalid\x20credentials','delete-alerts','stopPolling','Login\x20rejected','-events.json','All\x20bots\x20running\x20right\x20now','removeListener','config/','logs/','10864984mXhuhO','sha256','event','Deleted\x20Bot\x20','download','::ffff:127.0.0.1','settings.','-----------------------------------------------------------------------------------','enabled','notification','apiSecret','15\x20min','answerCallbackQuery','f2aRequired','SIGTERM','kill','new-disabled','pidRefreshToken','Login\x20accepted','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','sort','join','accept','timeshift','#RES#\x20if\x20running\x20locally\x0a','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','exchange','logged\x20out','temp/','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','-config.json','filter','login\x20required'];_0x11b6=function(){return _0x45844f;};return _0x11b6();}function cleanBlacklist(){const _0x491d5b=_0x39a6ea;let _0x5a59a7=dbSecure[_0x491d5b(0x28e)]('blacklist')[_0x491d5b(0x188)]()[_0x491d5b(0x241)](),_0x4114d8=new Date()[_0x491d5b(0x1b4)]();_0x5a59a7[_0x491d5b(0x2f9)](_0x429d2b=>{const _0x491cf1=_0x491d5b;_0x429d2b[_0x491cf1(0x238)]<_0x4114d8&&dbSecure[_0x491cf1(0x28e)](_0x491cf1(0x2ce))[_0x491cf1(0x1e6)]({'expiry':_0x429d2b[_0x491cf1(0x238)]})[_0x491cf1(0x252)]();});}function initStates(){let _0x22f4bd=getConfiguration();_0x22f4bd['forEach'](_0x4996e1=>{const _0x463a08=_0x2b3e;_0x4996e1[_0x463a08(0x1dd)]=_0x463a08(0x21c);}),storeConfiguration(_0x22f4bd);}function onKeys(){const _0x286674=new RSA();return new Promise(_0x481f0e=>{_0x286674['generateKeyPairAsync']()['then'](_0x2429ca=>{_0x481f0e(_0x2429ca);});});}async function generateKeys(){return await onKeys();}function _0x2b3e(_0xc69e4b,_0x498a91){const _0x19c2a3=_0x11b6();return _0x2b3e=function(_0x8636b,_0x36d6f6){_0x8636b=_0x8636b-0x140;let _0x11b6a=_0x19c2a3[_0x8636b];return _0x11b6a;},_0x2b3e(_0xc69e4b,_0x498a91);}async function oneTimeMigration(){const _0x38de31=_0x39a6ea;let _0xe4803=getSettings(),_0x2f70a1=![];!_0xe4803[_0x38de31(0x18c)](_0x38de31(0x248))&&(_0xe4803['lastmsgtelegram']=0x0,_0x2f70a1=!![]);!_0xe4803['hasOwnProperty'](_0x38de31(0x23e))&&(_0xe4803[_0x38de31(0x23e)]=0x0,_0x2f70a1=!![]);!_0xe4803[_0x38de31(0x18c)](_0x38de31(0x1f9))&&(_0xe4803['latestversion']=_0x38de31(0x287),_0x2f70a1=!![]);!_0xe4803['hasOwnProperty'](_0x38de31(0x24d))&&(_0xe4803[_0x38de31(0x24d)]=![],_0x2f70a1=!![]);if(_0x2f70a1)storeSettings(_0xe4803);}function storeConfiguration(_0x16da03){const _0x19df96=_0x39a6ea;dbConfig[_0x19df96(0x28e)](_0x19df96(0x210))[_0x19df96(0x1e6)]()['write'](),_0x16da03[_0x19df96(0x2f9)](_0x53eaf9=>{const _0x5a3f88=_0x19df96;delete _0x53eaf9[_0x5a3f88(0x1e7)];}),dbConfig[_0x19df96(0x28e)](_0x19df96(0x210))[_0x19df96(0x24e)](..._0x16da03)[_0x19df96(0x252)](),config=_0x16da03;}function resetPassword(){const _0x16b90b=_0x39a6ea;tgBot&&settings['telegramChatId']&&(tgBot['removeListener']('callback_query'),tgBot[_0x16b90b(0x2d7)](settings[_0x16b90b(0x1bd)],_0x16b90b(0x199),{'parse_mode':_0x16b90b(0x288),'reply_markup':{'inline_keyboard':[[{'text':_0x16b90b(0x26f),'callback_data':_0x16b90b(0x26f)},{'text':'no','callback_data':'no'}]]}})[_0x16b90b(0x220)](_0x5ba1c2=>{telegramError(_0x5ba1c2);}),tgBot['on'](_0x16b90b(0x1c0),async _0x4832f4=>{const _0x2e074b=_0x16b90b,_0x2ba5d8=_0x4832f4[_0x2e074b(0x2de)],_0x9a9682=_0x4832f4[_0x2e074b(0x2bd)];tgBot[_0x2e074b(0x311)](_0x4832f4['id'])[_0x2e074b(0x1fb)](async()=>{const _0x207c3a=_0x2e074b;if(_0x2ba5d8!='no'){const _0x11b427=0xf,_0x1fded2='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x2b25f8=Array[_0x207c3a(0x200)](crypto['randomFillSync'](new Uint32Array(_0x11b427)))[_0x207c3a(0x22b)](_0xe4b870=>_0x1fded2[_0xe4b870%_0x1fded2[_0x207c3a(0x2c5)]])['join'](''),_0x4a2a9f=bcrypt[_0x207c3a(0x2c0)](_0x2b25f8,saltRounds);storeSettings({'bbPassword':_0x4a2a9f}),await tgBot[_0x207c3a(0x2d7)](_0x9a9682['chat']['id'],_0x207c3a(0x2cf)+_0x2b25f8,{'parse_mode':_0x207c3a(0x288)})[_0x207c3a(0x220)](_0x36c62b=>{telegramError(_0x36c62b);});}else await tgBot[_0x207c3a(0x2d7)](_0x9a9682['chat']['id'],_0x207c3a(0x21f))[_0x207c3a(0x220)](_0x4910e0=>{telegramError(_0x4910e0);});}),tgBot[_0x2e074b(0x302)](_0x2e074b(0x1c0));}));}async function confirmRestore(_0x36b6c4,_0x308e8b){const _0x1888fd=_0x39a6ea;io['to']('botmanager')[_0x1888fd(0x249)](_0x1888fd(0x30e),_0x1888fd(0x2f3),_0x1888fd(0x22e)),tgBot&&settings[_0x1888fd(0x1bd)]&&(tgBot[_0x1888fd(0x302)]('callback_query'),await tgBot[_0x1888fd(0x2d7)](settings[_0x1888fd(0x1bd)],_0x1888fd(0x1c5),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x1888fd(0x26f)},{'text':'no','callback_data':'no'}]]}})[_0x1888fd(0x220)](_0x10287b=>{telegramError(_0x10287b);}),tgBot['on'](_0x1888fd(0x1c0),async _0x1adee4=>{const _0x58975b=_0x1888fd,_0x1f5e3a=_0x1adee4[_0x58975b(0x2de)],_0x411d6c=_0x1adee4['message'];tgBot[_0x58975b(0x311)](_0x1adee4['id'])[_0x58975b(0x1fb)](async()=>{const _0x4d42b8=_0x58975b;_0x1f5e3a==_0x4d42b8(0x26f)?(await tgBot[_0x4d42b8(0x2d7)](_0x411d6c['chat']['id'],_0x4d42b8(0x25d),{'parse_mode':'HTML'})[_0x4d42b8(0x220)](_0x553977=>{telegramError(_0x553977);}),unzipFile(_0x36b6c4,_0x308e8b)):(logger[_0x4d42b8(0x152)]('Restore\x20process\x20aborted'),await tgBot[_0x4d42b8(0x2d7)](_0x411d6c['chat']['id'],'Restore\x20process\x20aborted')['catch'](_0x2eb043=>{telegramError(_0x2eb043);}));}),tgBot['removeListener'](_0x58975b(0x1c0));}));}function getServerTime(){const _0x5bd75a=_0x39a6ea,_0x1e2a38=new Date();return _0x1e2a38[_0x5bd75a(0x1b7)]()+'/'+(_0x1e2a38[_0x5bd75a(0x2bb)]()+0x1)['toString']()[_0x5bd75a(0x1ef)](0x2,'0')+'/'+_0x1e2a38[_0x5bd75a(0x244)]()[_0x5bd75a(0x2ad)]()[_0x5bd75a(0x1ef)](0x2,'0')+'\x20'+_0x1e2a38[_0x5bd75a(0x212)]()['toString']()['padStart'](0x2,'0')+':'+_0x1e2a38[_0x5bd75a(0x2b2)]()['toString']()[_0x5bd75a(0x1ef)](0x2,'0')+':'+_0x1e2a38[_0x5bd75a(0x162)]()[_0x5bd75a(0x2ad)]()[_0x5bd75a(0x1ef)](0x2,'0');}function getTimeStamp(){const _0x4dda69=_0x39a6ea,_0x2b5f01=shiftedTime();return _0x2b5f01[_0x4dda69(0x1b7)]()+'/'+(_0x2b5f01[_0x4dda69(0x2bb)]()+0x1)[_0x4dda69(0x2ad)]()[_0x4dda69(0x1ef)](0x2,'0')+'/'+_0x2b5f01[_0x4dda69(0x244)]()[_0x4dda69(0x2ad)]()['padStart'](0x2,'0')+'\x20'+_0x2b5f01[_0x4dda69(0x212)]()['toString']()[_0x4dda69(0x1ef)](0x2,'0')+':'+_0x2b5f01['getMinutes']()[_0x4dda69(0x2ad)]()['padStart'](0x2,'0')+':'+_0x2b5f01[_0x4dda69(0x162)]()[_0x4dda69(0x2ad)]()[_0x4dda69(0x1ef)](0x2,'0');}function getCleanTimeStamp(){const _0x1f092d=_0x39a6ea,_0x2ad973=shiftedTime();return _0x2ad973[_0x1f092d(0x1b7)]()+(_0x2ad973['getMonth']()+0x1)[_0x1f092d(0x2ad)]()[_0x1f092d(0x1ef)](0x2,'0')+_0x2ad973[_0x1f092d(0x244)]()[_0x1f092d(0x2ad)]()['padStart'](0x2,'0')+'-'+_0x2ad973[_0x1f092d(0x212)]()[_0x1f092d(0x2ad)]()[_0x1f092d(0x1ef)](0x2,'0')+_0x2ad973[_0x1f092d(0x2b2)]()['toString']()[_0x1f092d(0x1ef)](0x2,'0')+_0x2ad973[_0x1f092d(0x162)]()['toString']()[_0x1f092d(0x1ef)](0x2,'0');}function shiftedTime(){const _0x58bbf1=_0x39a6ea,_0x1177b2=new Date();let _0x35a935=_0x1177b2;if(settings[_0x58bbf1(0x143)]&&settings[_0x58bbf1(0x143)]!==0x0)_0x35a935=fns[_0x58bbf1(0x186)](_0x1177b2,{'hours':settings[_0x58bbf1(0x143)]});return _0x35a935;}function startScheduler(){const _0x19391f=new Date()['getUTCHours'](),_0x3e3b4e=shiftedTime()['getHours']();_0x3e3b4e==0x4&&backupConfigFiles();_0x3e3b4e==0x0&&rotateLogFiles();_0x19391f%0x6==0x0&&triggerAnalytics();_0x19391f%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0xcdf9b1){const _0x53716e=_0x39a6ea;logger[_0x53716e(0x152)](_0x53716e(0x286)+_0xcdf9b1);const _0x1bf70e=getBotsWithMode();_0x1bf70e[_0x53716e(0x2c5)]>0x0?confirmRestore(configbackuppath,_0xcdf9b1):unzipFile(configbackuppath,_0xcdf9b1);}async function getBackupFiles(_0x3c9b56=null){const _0x520a11=_0x39a6ea;let _0xbf3667=[],_0x9447c=fs[_0x520a11(0x166)](configbackuppath,{'withFileTypes':!![]});_0x9447c[_0x520a11(0x140)]((_0x267b9b,_0x1db608)=>_0x267b9b[_0x520a11(0x282)]<_0x1db608[_0x520a11(0x282)]?0x1:_0x1db608[_0x520a11(0x282)]<_0x267b9b[_0x520a11(0x282)]?-0x1:0x0),_0x9447c[_0x520a11(0x2f9)](_0x242adc=>{const _0x45f5df=_0x520a11;if(!_0x242adc[_0x45f5df(0x27a)]()&&_0x242adc['name'][_0x45f5df(0x19b)]('backup-full@')&&_0x242adc[_0x45f5df(0x282)][_0x45f5df(0x1af)](_0x45f5df(0x2dc))){const _0x1f2911=formatDate(fs[_0x45f5df(0x14f)](configbackuppath+_0x242adc[_0x45f5df(0x282)])[_0x45f5df(0x215)]);_0xbf3667[_0x45f5df(0x24e)]({'name':_0x242adc[_0x45f5df(0x282)],'mtime':_0x1f2911});}});if(_0x3c9b56)io['to'](_0x3c9b56)[_0x520a11(0x249)](_0x520a11(0x2d3),_0xbf3667);else return _0xbf3667;}async function backupConfigFiles(){const _0x2b8d49=_0x39a6ea;await zipFiles(_0x2b8d49(0x168));const _0x35c806=getCleanTimeStamp();fs[_0x2b8d49(0x2a4)](zippath+_0x2b8d49(0x2f5),configbackuppath+('backup-full@'+_0x35c806+_0x2b8d49(0x2dc)));let _0x1176b9=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x1176b9[_0x2b8d49(0x140)]((_0x2597ce,_0x2adc7f)=>_0x2597ce[_0x2b8d49(0x282)]<_0x2adc7f[_0x2b8d49(0x282)]?0x1:_0x2adc7f[_0x2b8d49(0x282)]<_0x2597ce[_0x2b8d49(0x282)]?-0x1:0x0),_0x1176b9[_0x2b8d49(0x2c5)]>maxBackups&&fs[_0x2b8d49(0x17d)](configbackuppath+_0x1176b9[maxBackups][_0x2b8d49(0x282)]);}function rotateLogFiles(){const _0x5e28cb=_0x39a6ea,_0x41411a=fs['statSync'](logspath+'output-000.log'),_0x7bfb59=_0x41411a[_0x5e28cb(0x158)]/0x400;if(_0x7bfb59>0x64){let _0x11fde0=fs[_0x5e28cb(0x166)](logspath,{'withFileTypes':!![]});_0x11fde0[_0x5e28cb(0x140)]((_0x2dea4c,_0x5eebce)=>_0x2dea4c[_0x5e28cb(0x282)]<_0x5eebce[_0x5e28cb(0x282)]?0x1:_0x5eebce[_0x5e28cb(0x282)]<_0x2dea4c[_0x5e28cb(0x282)]?-0x1:0x0),_0x11fde0[_0x5e28cb(0x2f9)](_0x26b46d=>{const _0x1fa626=_0x5e28cb;if(_0x26b46d['name']==_0x1fa626(0x163))fs[_0x1fa626(0x2a4)](logspath+_0x26b46d[_0x1fa626(0x282)],logspath+_0x1fa626(0x27f));if(_0x26b46d[_0x1fa626(0x282)]==_0x1fa626(0x1a2))fs[_0x1fa626(0x2a4)](logspath+_0x26b46d[_0x1fa626(0x282)],logspath+_0x1fa626(0x163));_0x26b46d['name']=='output-000.log'&&(fs['copyFileSync'](logspath+_0x26b46d[_0x1fa626(0x282)],logspath+_0x1fa626(0x1a2)),fs[_0x1fa626(0x1a9)](logspath+_0x26b46d[_0x1fa626(0x282)],''));});}}async function zipFiles(_0x37200a){const _0x51eea4=_0x39a6ea;let _0xa7a1e8;if(_0x37200a==_0x51eea4(0x197))_0xa7a1e8=logspath;if(_0x37200a==_0x51eea4(0x2b0))_0xa7a1e8=configpath;if(_0x37200a==_0x51eea4(0x168))_0xa7a1e8=configpath;let _0x21749c=fs['readdirSync'](_0xa7a1e8,{'withFileTypes':!![]});const _0x2fd9ea=new require(_0x51eea4(0x2ea))();_0x21749c[_0x51eea4(0x2f9)](_0x60bcf8=>{const _0x5080d2=_0x51eea4;if(!_0x60bcf8[_0x5080d2(0x27a)]()){let _0x40db54=fs[_0x5080d2(0x1b5)](_0xa7a1e8+_0x60bcf8[_0x5080d2(0x282)]);if(_0x37200a==_0x5080d2(0x2b0)){const _0x2172ad=/^bot-[0-9]{3}-config.json$/,_0x1ed637=_0x2172ad[_0x5080d2(0x1f4)](_0x60bcf8[_0x5080d2(0x282)]);if(_0x1ed637){const _0x3bcc7b=JSON[_0x5080d2(0x229)](_0x40db54);if(_0x3bcc7b[_0x5080d2(0x270)][0x0]){_0x3bcc7b[_0x5080d2(0x270)][0x0][_0x5080d2(0x1f5)]=_0x5080d2(0x25a),_0x3bcc7b[_0x5080d2(0x270)][0x0][_0x5080d2(0x30f)]=_0x5080d2(0x25a);if(_0x3bcc7b['bot'][0x0]['apiPassword'])_0x3bcc7b[_0x5080d2(0x270)][0x0]['apiPassword']=_0x5080d2(0x25a);}_0x40db54=JSON[_0x5080d2(0x26b)](_0x3bcc7b,null,0x2);}if(_0x60bcf8['name']=='bb-settings.json'){const _0x2c2c58=JSON['parse'](_0x40db54);if(_0x2c2c58['settings'][_0x5080d2(0x21a)])_0x2c2c58['settings']['loginRequired']=![];if(_0x2c2c58[_0x5080d2(0x192)][_0x5080d2(0x2f4)])_0x2c2c58[_0x5080d2(0x192)]['bbPassword']=_0x5080d2(0x25a);if(_0x2c2c58[_0x5080d2(0x192)][_0x5080d2(0x2a7)])_0x2c2c58[_0x5080d2(0x192)]['telegramToken']='***';if(_0x2c2c58['settings'][_0x5080d2(0x1bd)])_0x2c2c58[_0x5080d2(0x192)]['telegramChatId']=null;_0x40db54=JSON['stringify'](_0x2c2c58,null,0x2);}if(_0x60bcf8[_0x5080d2(0x282)]!=_0x5080d2(0x2fa))_0x2fd9ea['file'](_0x60bcf8[_0x5080d2(0x282)],_0x40db54);}else _0x2fd9ea[_0x5080d2(0x27c)](_0x60bcf8[_0x5080d2(0x282)],_0x40db54);}});const _0xc170b0=_0x2fd9ea[_0x51eea4(0x226)]({'base64':![],'compression':_0x51eea4(0x20e)});fs['writeFileSync'](zippath+(_0x37200a+'.zip'),_0xc170b0,_0x51eea4(0x271));}async function unzipFile(_0x58337a,_0x24fb94){const _0x215e04=_0x39a6ea;fs[_0x215e04(0x166)](configpath,{'withFileTypes':!![]})[_0x215e04(0x2f9)](_0x4dd32d=>{const _0x434226=_0x215e04;if(!_0x4dd32d[_0x434226(0x27a)]())fs[_0x434226(0x263)](configpath+_0x4dd32d['name']);});const _0x4585f3=fs[_0x215e04(0x1b5)](_0x58337a+_0x24fb94,'binary'),_0x5d3829=new require(_0x215e04(0x2ea))(_0x4585f3,{'base64':![],'checkCRC32':!![]});Object[_0x215e04(0x2ac)](_0x5d3829[_0x215e04(0x1ac)])[_0x215e04(0x2f9)](_0x239ee2=>{const _0x140c58=_0x215e04,_0x12d360=_0x5d3829[_0x140c58(0x1ac)][_0x239ee2];fs[_0x140c58(0x1a9)](configpath+_0x12d360['name'],_0x12d360[_0x140c58(0x23c)]);}),fs[_0x215e04(0x166)](temppath,{'withFileTypes':!![]})[_0x215e04(0x2f9)](_0x472378=>{const _0x14a5f9=_0x215e04;if(!_0x472378[_0x14a5f9(0x27a)]())fs[_0x14a5f9(0x263)](temppath+_0x472378[_0x14a5f9(0x282)]);}),logger[_0x215e04(0x152)](_0x215e04(0x193)),process['send']({'restore':!![]},_0x2951d9=>{});}async function getPublicIp(){const _0x44bb2e=_0x39a6ea;try{const _0x14227d=await axios[_0x44bb2e(0x28e)]('https://api.ipify.org?format=json');publicip=_0x14227d[_0x44bb2e(0x2de)]['ip'];}catch(_0x245f86){}}async function triggerAnalytics(){const _0x51a8ce=_0x39a6ea;if(!publicip)await getPublicIp();const _0x4cefc0=getBotsWithMode();let _0x40f2e7=0x0;_0x4cefc0[_0x51a8ce(0x2f9)](_0x33d5f5=>{const _0x12644b=_0x51a8ce;if(_0x33d5f5[_0x12644b(0x216)]===_0x12644b(0x30d))_0x40f2e7++;});const _0x538113=getBotExchanges();mixpanel[_0x51a8ce(0x18e)](_0x51a8ce(0x295),{'distinct_id':settings[_0x51a8ce(0x2a0)],'ip':publicip,'version':serverversion,'numbots':_0x4cefc0[_0x51a8ce(0x2c5)],'numbotsenabled':_0x40f2e7,'exchanges':_0x538113});}async function getMessages(){const _0x56f42d=_0x39a6ea,_0x14f54d=_0x56f42d(0x2e2),_0x2e843e=new GraphQLClient(_0x14f54d),_0x517f88={'authorization':_0x56f42d(0x181)},_0x1715d2=serverversion[_0x56f42d(0x2ec)]('.'),_0x223308=_0x1715d2[0x0]+'.'+_0x1715d2[0x1],_0xaba16f=Math[_0x56f42d(0x1ff)](settings[_0x56f42d(0x248)],settings[_0x56f42d(0x23e)]),_0x5c862a={'last':parseInt(_0xaba16f),'bbm':_0x223308},_0x10fe39=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x14a8ad;try{_0x14a8ad=await _0x2e843e[_0x56f42d(0x1c9)](_0x10fe39,_0x5c862a,_0x517f88);}catch(_0x292f74){}if(_0x14a8ad&&_0x14a8ad[_0x56f42d(0x283)]){let _0x2aa924=settings[_0x56f42d(0x248)];newMessages=[];for(const _0x141f67 of _0x14a8ad[_0x56f42d(0x283)]){newMessages['push'](_0x141f67);if(_0x141f67['bbvNew'])updateSetting(_0x56f42d(0x1f9),_0x141f67[_0x56f42d(0x228)]);let _0x1e98d9=_0x141f67[_0x56f42d(0x228)]?serverversion>=_0x141f67[_0x56f42d(0x228)]:![];if(!_0x1e98d9&&_0x141f67[_0x56f42d(0x29d)]>_0x2aa924){if(_0x141f67[_0x56f42d(0x2b7)]===_0x56f42d(0x2e6)||serverversion[_0x56f42d(0x19b)](_0x141f67['bbvReceive'])){let _0x309258=''+_0x141f67[_0x56f42d(0x1d9)]+'\x0a\x0a'+_0x141f67['message'];const _0x307f5f=await sendTelegramMsg(toTelegramMarkdown(_0x309258),'Markdown');if(_0x307f5f)_0x2aa924=_0x141f67[_0x56f42d(0x29d)];}}}updateAvailable=isNewerVersion(settings[_0x56f42d(0x1f9)],serverversion),updateSetting(_0x56f42d(0x248),_0x2aa924),emitMessages();}}function emitMessages(){const _0x4f369a=_0x39a6ea,_0x382a47=settings[_0x4f369a(0x23e)];let _0x250b10=[];newMessages[_0x4f369a(0x2f9)](_0x77fb56=>{const _0x420158=_0x4f369a;_0x77fb56[_0x420158(0x29d)]>_0x382a47&&_0x250b10[_0x420158(0x24e)](_0x77fb56);}),_0x250b10[_0x4f369a(0x2c5)]>0x0&&getAllClients()['forEach'](_0x5f37b4=>{const _0x2df5d2=_0x4f369a;getSocket(_0x5f37b4['id'])[_0x2df5d2(0x249)]('message',_0x250b10);});}function confirmMessage(_0x37d49b){updateSetting('lastmsgemitted',Number(_0x37d49b));}function isNewerVersion(_0x3a9035,_0x260e19){const _0xfe738e=_0x39a6ea,_0x2af0bc=_0x260e19[_0xfe738e(0x2ec)]('.'),_0x2a909b=_0x3a9035[_0xfe738e(0x2ec)]('.');for(var _0x25843e=0x0;_0x25843e<_0x2a909b[_0xfe738e(0x2c5)];_0x25843e++){const _0x2a25f6=~~_0x2a909b[_0x25843e],_0x4f5754=~~_0x2af0bc[_0x25843e];if(_0x2a25f6>_0x4f5754)return!![];if(_0x2a25f6<_0x4f5754)return![];}return![];}function toTelegramMarkdown(_0x2ab595){const _0x1c8e38=_0x39a6ea,_0x640906=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0xf1fed9=/\*{2}(.+?)\*{2}/gim;return _0x2ab595=_0x2ab595['replace'](_0x640906,_0x1c8e38(0x258))[_0x1c8e38(0x297)](_0xf1fed9,_0x1c8e38(0x16e)),_0x2ab595;}async function validateConfigFile(){const _0x246e0f=_0x39a6ea,_0x4388d1=dbConfig[_0x246e0f(0x28e)](_0x246e0f(0x210))['sortBy'](_0x246e0f(0x224))['value']()||[];if(_0x4388d1[_0x246e0f(0x2c5)]==0x0){let _0x31537b=0x0,_0x188bc9=[];const _0x21585c=/^bot-([0-9]{3})-config.json$/,_0x29c34b=fs[_0x246e0f(0x166)](configpath);_0x29c34b[_0x246e0f(0x2f9)](_0x3570f0=>{const _0xcd164d=_0x246e0f,_0x95d347=_0x21585c[_0xcd164d(0x243)](_0x3570f0);if(_0x95d347){const _0xc1c388=_0x95d347[0x1];let _0xb8f43d=getBotAttributes(_0xc1c388);_0x188bc9[_0xcd164d(0x24e)]({'botID':_0xc1c388,'botname':_0xb8f43d[_0xcd164d(0x15d)],'status':'disabled','live':_0xcd164d(0x21c)}),_0x31537b++;}}),_0x31537b!=0x0&&(dbConfig['get']('bots')[_0x246e0f(0x24a)](_0x188bc9)[_0x246e0f(0x252)](),config=_0x188bc9,restoredConfigFile=_0x31537b);}}async function restoreConfigNotify(_0x1f8098){const _0x689e92=_0x39a6ea;let _0x21ecdd;if(restoredConfigFile==0x1)_0x21ecdd=_0x689e92(0x225);else _0x21ecdd=_0x689e92(0x15c);if(_0x1f8098)io['to'](_0x689e92(0x253))[_0x689e92(0x249)](_0x689e92(0x30e),_0x21ecdd);else{logger['simple'](_0x689e92(0x30c)),logger[_0x689e92(0x1da)](_0x21ecdd),logger[_0x689e92(0x1da)](_0x689e92(0x30c)),logger[_0x689e92(0x1da)]('');if(tgBot&&settings[_0x689e92(0x1bd)]&&settings[_0x689e92(0x2df)]!=_0x689e92(0x1e4))tgBot['sendMessage'](settings[_0x689e92(0x1bd)],_0x689e92(0x2ca)+_0x21ecdd)[_0x689e92(0x220)](_0x343515=>{telegramError(_0x343515);});}}function validateCredentials(_0x46d8df,_0x128f72){const _0xb8ab49=_0x39a6ea;if(_0x46d8df[_0xb8ab49(0x1bb)]==settings['bbUsername']&&bcrypt[_0xb8ab49(0x2ab)](_0x46d8df['password'],settings[_0xb8ab49(0x2f4)])){if(settings[_0xb8ab49(0x312)])return{'allow':![],'reason':_0xb8ab49(0x1c4),'token':null};else{const _0x558eb9=generateLoginToken(_0x128f72);return{'allow':!![],'reason':_0xb8ab49(0x2c6),'token':_0x558eb9};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x86224a){const _0x1df750=_0x39a6ea,_0x37fa2f=generateLoginToken(_0x86224a);return{'allow':!![],'reason':_0x1df750(0x2c6),'token':_0x37fa2f};}function validateAccess(_0x5b1ada,_0x1d4501,_0x1f7643){const _0x3d0ae8=_0x39a6ea,_0x456b3f=_0x1f7643?_0x1f7643:devices[_0x1d4501]['ip'];let _0x15e5b9;const _0x4a5cbd=_0x2d50c4=>{const _0x547be9=_0x2b3e;if(settings[_0x547be9(0x21a)]){if(settings[_0x547be9(0x312)]){if(telegram2FaApproved(_0x1d4501)){const _0x5aef5e=generateLoginToken(_0x1d4501);return{'allow':!![],'reason':_0x547be9(0x24b),'token':_0x5aef5e};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x15e5b9=validToken(_0x2d50c4,_0x1d4501),_0x15e5b9[_0x547be9(0x18c)]('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x2d50c4}:{'allow':![],'reason':_0x547be9(0x14c),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x3d0ae8(0x2e4)]){let _0x4b7f64=[...settings[_0x3d0ae8(0x211)],'::1',_0x3d0ae8(0x30a),_0x3d0ae8(0x16b)];if(_0x4b7f64[_0x3d0ae8(0x1d3)](_0x456b3f))return _0x4a5cbd(_0x5b1ada);else{_0x15e5b9=validToken(_0x5b1ada,_0x1d4501);if(_0x15e5b9[_0x3d0ae8(0x18c)](_0x3d0ae8(0x22e)))return _0x4a5cbd(_0x5b1ada);else{if(telegramIpApproved(_0x1d4501)){const _0x46da1a=generateToken(_0x1d4501);return _0x15e5b9=_0x4a5cbd(_0x5b1ada),_0x15e5b9[_0x3d0ae8(0x170)]?{'allow':!![],'reason':_0x3d0ae8(0x1df),'token':_0x46da1a}:_0x15e5b9;}else return settings[_0x3d0ae8(0x242)]?{'allow':![],'reason':_0x3d0ae8(0x21e),'token':null}:{'allow':![],'reason':_0x3d0ae8(0x279),'token':null};}}}else return _0x4a5cbd(_0x5b1ada);}function timelyDecrypt(_0x391bbc,_0x3a37b8=!![]){const _0x23899c=_0x39a6ea;if(_0x391bbc)try{const _0x52d41c=crypt[_0x23899c(0x156)](secure[_0x23899c(0x2b4)],_0x391bbc)[_0x23899c(0x2bd)],_0x3c19fa=_0x52d41c['split']('@')[0x0],_0x1a2159=_0x52d41c['split']('@')[0x1],_0x50e780=new Date()[_0x23899c(0x1b4)]();if(_0x3a37b8){if(_0x50e780-_0x1a2159<maxSecretAge*0x3e8)return _0x3c19fa;else return![];}else return _0x3c19fa;}catch(_0xacf97b){return![];}else return![];}const validToken=(_0x242080,_0x11bb74)=>{const _0x24cb7d=_0x39a6ea,_0x27d627=devices[_0x11bb74]['ip'];if(!_0x242080)return{'error':'No\x20authentication\x20token'};for(let _0x325af0 of blacklist){if(_0x325af0['token']==_0x242080)return{'error':_0x24cb7d(0x2db)};}let _0x5ac0fe;try{_0x5ac0fe=jwt[_0x24cb7d(0x19e)](_0x242080,secure[_0x24cb7d(0x2e7)]+_0x11bb74);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x5ac0fe[_0x24cb7d(0x18c)](_0x24cb7d(0x1c2))&&!_0x5ac0fe['hasOwnProperty'](_0x24cb7d(0x1bb))||!_0x5ac0fe['hasOwnProperty'](_0x24cb7d(0x18f)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x5ac0fe['hasOwnProperty'](_0x24cb7d(0x1bb))&&_0x5ac0fe[_0x24cb7d(0x18c)](_0x24cb7d(0x1c2))){const {clientip:_0xd5e73c}=_0x5ac0fe;return _0x27d627==_0xd5e73c?{'success':_0x24cb7d(0x1e9)}:{'error':_0x24cb7d(0x26e)};}else{if(_0x5ac0fe['hasOwnProperty'](_0x24cb7d(0x1bb))&&_0x5ac0fe[_0x24cb7d(0x18c)]('clientip')){const {username:_0x4f217a,clientip:_0x19276a}=_0x5ac0fe;return settings['bbUsername']==_0x4f217a&&_0x27d627==_0x19276a?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0xd092d7=>{const _0x50a459=_0x39a6ea;if(_0xd092d7){const _0xb7c829=devices[_0xd092d7]['ip'];return jwt[_0x50a459(0x20a)]({'username':settings['bbUsername'],'clientip':_0xb7c829},secure['secret']+_0xd092d7,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x558679=>{const _0x2eaa63=_0x39a6ea;if(_0x558679){const _0x35619e=devices[_0x558679]['ip'];return jwt['sign']({'clientip':_0x35619e},secure[_0x2eaa63(0x2e7)]+_0x558679,{'expiresIn':devices[_0x558679][_0x2eaa63(0x1d1)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x5e13aa=>{const _0x3b4c56=_0x39a6ea;let _0x55ea27=![];return devices[_0x5e13aa]['telegramIpApproval']&&devices[_0x5e13aa][_0x3b4c56(0x1d1)][_0x3b4c56(0x238)]!=_0x3b4c56(0x265)&&(_0x55ea27=devices[_0x5e13aa]['telegramIpApproval'][_0x3b4c56(0x1c2)]==devices[_0x5e13aa]['ip']&&new Date()[_0x3b4c56(0x1b4)]()-devices[_0x5e13aa][_0x3b4c56(0x1d1)]['timestamp']<devices[_0x5e13aa]['telegramIpApproval'][_0x3b4c56(0x238)]*0x3c*0x3e8),_0x55ea27;},telegram2FaApproved=_0x46d69f=>{const _0x43e110=_0x39a6ea;let _0x4dd631=![];return devices[_0x46d69f][_0x43e110(0x2f0)]&&devices[_0x46d69f]['telegram2FaApproval'][_0x43e110(0x238)]!=_0x43e110(0x265)&&(_0x4dd631=devices[_0x46d69f]['telegram2FaApproval'][_0x43e110(0x1c2)]==devices[_0x46d69f]['ip']&&new Date()[_0x43e110(0x1b4)]()-devices[_0x46d69f]['telegram2FaApproval'][_0x43e110(0x1d8)]<devices[_0x46d69f][_0x43e110(0x2f0)][_0x43e110(0x238)]*0x3c*0x3e8),_0x4dd631;},normalizeIP=_0x554c08=>{const _0x3476cd=_0x39a6ea;let _0x557b2d=null,_0x2dc678=null;if(ipaddr[_0x3476cd(0x184)](_0x554c08)){const _0x2419bd=ipaddr[_0x3476cd(0x229)](_0x554c08);_0x2419bd[_0x3476cd(0x2aa)]()===_0x3476cd(0x26a)?(_0x2419bd['isIPv4MappedAddress']()&&(_0x557b2d=_0x2419bd['toIPv4Address']()[_0x3476cd(0x2ad)]()),_0x2dc678=_0x2419bd['toString']()):(_0x557b2d=_0x2419bd['toString'](),_0x2dc678=_0x2419bd['toIPv4MappedAddress']()['toString']());}return{'show':_0x557b2d?_0x557b2d:_0x2dc678,'store':_0x2dc678};};function formatDate(_0x15c047){const _0x4c4a39=_0x39a6ea;return _0x15c047[_0x4c4a39(0x1b7)]()+'/'+(_0x15c047['getMonth']()+0x1)[_0x4c4a39(0x2ad)]()[_0x4c4a39(0x1ef)](0x2,'0')+'/'+_0x15c047['getDate']()[_0x4c4a39(0x2ad)]()[_0x4c4a39(0x1ef)](0x2,'0')+'\x20'+_0x15c047[_0x4c4a39(0x212)]()[_0x4c4a39(0x2ad)]()['padStart'](0x2,'0')+':'+_0x15c047[_0x4c4a39(0x2b2)]()[_0x4c4a39(0x2ad)]()[_0x4c4a39(0x1ef)](0x2,'0')+':'+_0x15c047[_0x4c4a39(0x162)]()[_0x4c4a39(0x2ad)]()[_0x4c4a39(0x1ef)](0x2,'0');}function sleep(_0x108c31){return new Promise(_0xe79cd5=>setTimeout(_0xe79cd5,_0x108c31));}