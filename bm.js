const _0x381d67=_0x4f30;(function(_0x237dbb,_0x354036){const _0x4ce3a5=_0x4f30,_0x522e36=_0x237dbb();while(!![]){try{const _0x50b645=-parseInt(_0x4ce3a5(0x1a5))/0x1+parseInt(_0x4ce3a5(0x1fd))/0x2+parseInt(_0x4ce3a5(0x149))/0x3+-parseInt(_0x4ce3a5(0x1fa))/0x4+parseInt(_0x4ce3a5(0x1c5))/0x5*(-parseInt(_0x4ce3a5(0x13e))/0x6)+parseInt(_0x4ce3a5(0x10a))/0x7+parseInt(_0x4ce3a5(0x1c3))/0x8;if(_0x50b645===_0x354036)break;else _0x522e36['push'](_0x522e36['shift']());}catch(_0x418ffd){_0x522e36['push'](_0x522e36['shift']());}}}(_0x1704,0x8c7a3));const _0x4a519e=function(){let _0x451d7d=!![];return function(_0x4360f1,_0x46623c){const _0x1d097f=_0x451d7d?function(){const _0x5e2298=_0x4f30;if(_0x46623c){const _0xda28d9=_0x46623c[_0x5e2298(0x104)](_0x4360f1,arguments);return _0x46623c=null,_0xda28d9;}}:function(){};return _0x451d7d=![],_0x1d097f;};}(),_0x5ba715=_0x4a519e(this,function(){const _0xe1a4d4=_0x4f30;return _0x5ba715[_0xe1a4d4(0x1d7)]()[_0xe1a4d4(0x122)](_0xe1a4d4(0xe6))['toString']()['constructor'](_0x5ba715)[_0xe1a4d4(0x122)](_0xe1a4d4(0xe6));});_0x5ba715();'use strict';process[_0x381d67(0x164)][_0x381d67(0xf4)]=0x1;const childProcess=require(_0x381d67(0x158)),FileSync=require(_0x381d67(0x1ba)),fs=require('fs'),fns=require('date-fns'),low=require('lowdb'),path=require('path'),crypto=require(_0x381d67(0x1a8)),Crypt=require(_0x381d67(0x135))[_0x381d67(0xf5)],RSA=require('hybrid-crypto-js')['RSA'],bcrypt=require(_0x381d67(0x12b)),jwt=require(_0x381d67(0xf3)),analyticsLib=require(_0x381d67(0xcd))[_0x381d67(0x11e)],googleAnalytics=require('@analytics/google-analytics')[_0x381d67(0x11e)],ipaddr=require(_0x381d67(0x138)),argv=require(_0x381d67(0x157))(process['argv'][_0x381d67(0x176)](0x2))[_0x381d67(0xfc)],PORT=argv[_0x381d67(0x18c)]||_0x381d67(0x111),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x381d67(0xea)](PORT))return console[_0x381d67(0x1a3)](_0x381d67(0x1b7)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1);const HOST=argv['host']||null,userID=argv['user']||'';let bbpath=_0x381d67(0x1eb),bbpath2='';const botfile='bot.js',configfile=_0x381d67(0x126),settingsfile=_0x381d67(0xe2),securefile=_0x381d67(0x101);let validInstallation=!![];!fs[_0x381d67(0x10c)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x381d67(0x14b)),configpath=userID?bbpath+_0x381d67(0x17e)+userID+'/':bbpath+_0x381d67(0x17e),configbackuppath=configpath+'backup/';!fs[_0x381d67(0x10c)](configpath)&&fs[_0x381d67(0xd5)](configpath);!fs[_0x381d67(0x10c)](configbackuppath)&&fs[_0x381d67(0xd5)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x381d67(0x171)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x381d67(0xff)]({'settings':{'timeshift':0x0}})[_0x381d67(0x171)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x381d67(0xff)]({'secure':{},'blacklist':[]})[_0x381d67(0x171)]();let crypt=new Crypt({'md':_0x381d67(0x1e8),'rsaStandard':_0x381d67(0x1bf)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x381d67(0x128)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];oneTimeMigration(),cleanBlacklist();const express=require(_0x381d67(0x1b6)),app=express(),http=require(_0x381d67(0xc4))[_0x381d67(0x1dc)](app);app[_0x381d67(0x19c)](express['static'](path[_0x381d67(0x1e7)](__dirname,bbpath2,_0x381d67(0x1e6)))),app[_0x381d67(0x19c)](express[_0x381d67(0x183)](path[_0x381d67(0x1e7)](__dirname,bbpath2,'build'))),app[_0x381d67(0x10d)]('/',function(_0x11b127,_0x5c45b9){const _0x254b01=_0x381d67;_0x5c45b9[_0x254b01(0x143)](path[_0x254b01(0x1e7)](__dirname,bbpath2,_0x254b01(0x1e6),'index.html'));}),app[_0x381d67(0x10d)]('/:bot',function(_0x17d07d,_0x2d51ef){const _0x18e5a1=_0x381d67;_0x2d51ef['sendFile'](path['join'](__dirname,bbpath2,_0x18e5a1(0x1b4),_0x18e5a1(0x12f)));}),app[_0x381d67(0x10d)](_0x381d67(0x159),(_0x1b1503,_0x28ee45)=>{const _0x2d885d=_0x381d67;_0x28ee45['sendFile'](path[_0x2d885d(0x1e7)](__dirname,bbpath2,_0x2d885d(0x1b4),_0x2d885d(0x12f)));}),app[_0x381d67(0x10d)]('/:bot/performance',(_0x45e6d3,_0x20d885)=>{const _0x1ab5cf=_0x381d67;_0x20d885[_0x1ab5cf(0x143)](path[_0x1ab5cf(0x1e7)](__dirname,bbpath2,'build',_0x1ab5cf(0x12f)));}),app[_0x381d67(0x10d)](_0x381d67(0x1bc),(_0x248e1c,_0x1768f3)=>{const _0x2b15a6=_0x381d67;_0x1768f3[_0x2b15a6(0x143)](path[_0x2b15a6(0x1e7)](__dirname,bbpath2,'build','index.html'));}),app[_0x381d67(0x10d)](_0x381d67(0x1e2),(_0x58bcba,_0x861544)=>{const _0x529630=_0x381d67;_0x861544[_0x529630(0x143)](path[_0x529630(0x1e7)](__dirname,bbpath2,_0x529630(0x1b4),_0x529630(0x12f)));}),app['get']('/:bot/configuration',(_0x3adcb5,_0x3e19b0)=>{const _0x410cb6=_0x381d67;_0x3e19b0[_0x410cb6(0x143)](path[_0x410cb6(0x1e7)](__dirname,bbpath2,'build',_0x410cb6(0x12f)));}),app[_0x381d67(0x10d)](_0x381d67(0x19d),(_0x2ac841,_0x2eda1d)=>{const _0x45bed4=_0x381d67;_0x2eda1d[_0x45bed4(0x143)](path['join'](__dirname,bbpath2,'build',_0x45bed4(0x12f)));});if(HOST)http[_0x381d67(0x1c4)](PORT,HOST);else http[_0x381d67(0x1c4)](PORT);const io=require(_0x381d67(0x1a7))(http,{}),analytics=analyticsLib({'app':_0x381d67(0x132),'plugins':[googleAnalytics({'trackingId':'UA-192771731-1'})]}),TelegramBot=require(_0x381d67(0x17f));let tgBot;if(settings[_0x381d67(0x141)]&&settings['telegramToken']!=''&&settings['telegramUsername']&&settings[_0x381d67(0x165)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x2788a4=_0x381d67;console[_0x2788a4(0x1a3)](''),console[_0x2788a4(0x1a3)]('-----------------------------------------------------------------------------------'),logging(_0x2788a4(0xd7)+PORT),console['log'](_0x2788a4(0x154));if(config[_0x2788a4(0x18d)]!=0x0)config[_0x2788a4(0x155)](_0x485db3=>{const _0x46277b=_0x2788a4;if(_0x485db3[_0x46277b(0x185)]==_0x46277b(0x1ec)||_0x485db3[_0x46277b(0x185)]==_0x46277b(0x1f4))logging(_0x46277b(0x15f)+_0x485db3['botID']+_0x46277b(0x1cd)+_0x485db3[_0x46277b(0xf1)]),startBot([_0x485db3['botID'],userID],{'cwd':bbpath},function(_0x1b2ce2){if(_0x1b2ce2)logging(_0x1b2ce2);});else(_0x485db3[_0x46277b(0x185)]==_0x46277b(0xce)||_0x485db3[_0x46277b(0x185)]==_0x46277b(0x100))&&logging('idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x485db3['botID']+_0x46277b(0x1cd)+_0x485db3[_0x46277b(0xf1)]);});else!newBot&&console[_0x2788a4(0x1a3)](_0x2788a4(0x1a9));if(newBot)addBot();console[_0x2788a4(0x1a3)]('-----------------------------------------------------------------------------------'),console['log']('');}function startSocket(){const _0x20a0aa=_0x381d67;io['on'](_0x20a0aa(0x14e),_0x24a9a5=>{const _0x3a1e5d=_0x20a0aa;let _0x10d40d,_0x51320f,_0x23cc74,_0xd8caa2,_0x55c865;const _0x5bf5dd=_0x24a9a5[_0x3a1e5d(0x136)][_0x3a1e5d(0x1fc)][_0x3a1e5d(0x16c)];_0x51320f=_0x5bf5dd[_0x3a1e5d(0x17b)](/bot[0-9]{3}/);if(_0x51320f)_0x23cc74=_0x51320f[0x0][_0x3a1e5d(0x17b)](/[0-9]{3}/);if(_0x23cc74)_0x10d40d=_0x23cc74[0x0];else _0x10d40d=_0x3a1e5d(0x175);const _0x2036fe=_0x24a9a5[_0x3a1e5d(0x136)]['auth'][_0x3a1e5d(0x17c)];if(!_0x2036fe)_0x24a9a5[_0x3a1e5d(0xc2)](_0x3a1e5d(0x185),{'publicKey':secure[_0x3a1e5d(0xdd)]});else{_0xd8caa2=timelyDecrypt(_0x2036fe,![]);if(!_0xd8caa2)_0x24a9a5[_0x3a1e5d(0xc2)](_0x3a1e5d(0x185),{'publicKey':secure['publicKey']});else{_0x55c865=normalizeIP(_0x24a9a5['conn'][_0x3a1e5d(0x162)])[_0x3a1e5d(0xc9)];if(!devices[_0xd8caa2])devices[_0xd8caa2]={'uuid':_0xd8caa2,'access':{'token':null}};devices[_0xd8caa2]['ip']=_0x55c865;const _0x360837=addClient(_0x24a9a5['id'],_0xd8caa2,_0x10d40d);setAccess(_0x360837),_0x24a9a5['on']('login',_0x1b18a8=>{const _0x222e4a=_0x3a1e5d,_0x4c5d0a=timelyDecrypt(_0x1b18a8[_0x222e4a(0x134)]);if(_0x4c5d0a){_0x1b18a8={'username':_0x1b18a8[_0x222e4a(0x189)],'password':_0x4c5d0a},devices[_0xd8caa2]['access']=validateCredentials(_0x1b18a8,_0xd8caa2);if(devices[_0xd8caa2][_0x222e4a(0x184)][_0x222e4a(0x1e0)]==![]&&devices[_0xd8caa2]['access'][_0x222e4a(0x167)]==_0x222e4a(0x115))_0x24a9a5[_0x222e4a(0xc2)](_0x222e4a(0x185),{'access':devices[_0xd8caa2][_0x222e4a(0x184)]}),loginAccess2FA(_0xd8caa2,_0x55c865);else{if(devices[_0xd8caa2]['access'][_0x222e4a(0x1e0)]==![]&&devices[_0xd8caa2]['access'][_0x222e4a(0x167)]=='invalid\x20credentials')_0x24a9a5[_0x222e4a(0xc2)](_0x222e4a(0x185),{'access':devices[_0xd8caa2][_0x222e4a(0x184)]});else devices[_0xd8caa2][_0x222e4a(0x184)][_0x222e4a(0x1e0)]&&devices[_0xd8caa2][_0x222e4a(0x184)][_0x222e4a(0x167)]==_0x222e4a(0x142)&&(getClientsWithUuid(_0xd8caa2)[_0x222e4a(0x155)](_0x4ec44a=>{setAccess(_0x4ec44a);}),setTokenRefresh(_0xd8caa2),setSessionTimeout(_0x222e4a(0xd2),_0xd8caa2));}}else logging(_0x222e4a(0x13d));}),_0x24a9a5['on'](_0x3a1e5d(0xde),()=>{resetPassword();}),_0x24a9a5['on'](_0x3a1e5d(0x12a),_0x478eab=>{removeClient(_0x24a9a5['id']);});}}});}function initClient(_0x2e828a){const _0x2bbbe5=_0x381d67;if(_0x2e828a!=_0x2bbbe5(0x175)&&config[_0x2bbbe5(0x1f3)]!=''){if(pid[_0x2e828a])pid[_0x2e828a][_0x2bbbe5(0x11b)]({'function':_0x2bbbe5(0xee),'args':null});}}function getSocket(_0x1ef5fa){const _0x6973bf=_0x381d67;return io['sockets'][_0x6973bf(0xcf)][_0x6973bf(0x10d)](_0x1ef5fa);}function setAccess(_0x57936f){const _0xdf960c=_0x381d67,_0x390e6c=getSocket(_0x57936f['id']),_0x402750=_0x57936f['uuid'],_0x17e5cf=_0x57936f[_0xdf960c(0xd1)];devices[_0x402750][_0xdf960c(0x184)]=validateAccess(devices[_0x402750][_0xdf960c(0x184)][_0xdf960c(0x1d2)],_0x402750),_0x390e6c[_0xdf960c(0x1e7)](_0x402750);if(devices[_0x402750][_0xdf960c(0x184)][_0xdf960c(0x1e0)]){_0x390e6c['join'](_0x17e5cf);if(_0x17e5cf==_0xdf960c(0x175))initializeSocketBotManager(_0x390e6c);else initializeSocketBot(_0x390e6c);initClient(_0x17e5cf);}devices[_0x402750][_0xdf960c(0x184)][_0xdf960c(0x1d2)]&&devices[_0x402750][_0xdf960c(0x184)][_0xdf960c(0x167)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0xdf960c(0x12c),_0x402750),devices[_0x402750][_0xdf960c(0x184)][_0xdf960c(0x1d2)]&&devices[_0x402750][_0xdf960c(0x184)]['reason']==_0xdf960c(0x1cc)&&setSessionTimeout(_0xdf960c(0xd2),_0x402750),_0x390e6c[_0xdf960c(0xc2)]('status',{'status':_0x57936f[_0xdf960c(0x1f8)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x402750][_0xdf960c(0x184)],'externalip':devices[_0x402750]['ip'],'publicKey':secure[_0xdf960c(0xdd)],'validInstallation':validInstallation}),devices[_0x402750][_0xdf960c(0x184)][_0xdf960c(0x1e0)]==![]&&devices[_0x402750][_0xdf960c(0x184)][_0xdf960c(0x167)]=='2FA\x20required'&&temporaryAccess2FA(_0x402750,devices[_0x402750]['ip']);}function setSessionTimeout(_0x543941,_0x7f3163){const _0x1e0f4e=_0x381d67;let _0x2befdb;if(_0x543941=='login')_0x2befdb=loginExpiry*0x3c*0x3e8;else _0x2befdb=devices[_0x7f3163]['telegramIpApproval']['expiry']*0x3c*0x3e8-(new Date()[_0x1e0f4e(0x151)]()-devices[_0x7f3163]['telegramIpApproval'][_0x1e0f4e(0x144)]);if(devices[_0x7f3163][_0x1e0f4e(0xe7)])clearTimeout(devices[_0x7f3163][_0x1e0f4e(0xe7)]);devices[_0x7f3163][_0x1e0f4e(0xe7)]=setTimeout(()=>{const _0xab547a=_0x1e0f4e;if(devices[_0x7f3163][_0xab547a(0x146)])clearTimeout(devices[_0x7f3163][_0xab547a(0x146)]);removeSocketListeners(_0x7f3163),addBlacklist(_0x7f3163),devices[_0x7f3163]['telegramIpApproval']=null,devices[_0x7f3163][_0xab547a(0x15c)]=null,devices[_0x7f3163][_0xab547a(0x184)][_0xab547a(0x1d2)]=null,devices[_0x7f3163][_0xab547a(0x184)]=validateAccess(devices[_0x7f3163][_0xab547a(0x184)]['token'],_0x7f3163),!(devices[_0x7f3163][_0xab547a(0x184)][_0xab547a(0x1e0)]&&devices[_0x7f3163][_0xab547a(0x184)][_0xab547a(0x167)]==_0xab547a(0x177))&&(_0x543941==_0xab547a(0xd2)?io['to'](_0x7f3163)[_0xab547a(0xc2)]('status',{'access':{'allow':![],'reason':_0xab547a(0x17d),'token':null}}):io['to'](_0x7f3163)['emit'](_0xab547a(0x185),{'access':{'allow':![],'reason':_0xab547a(0xef),'token':null}})),devices[_0x7f3163][_0xab547a(0x184)][_0xab547a(0x1d2)]=null;},_0x2befdb);}function setTokenRefresh(_0x4692b7){const _0x3dec29=_0x381d67;if(devices[_0x4692b7][_0x3dec29(0x146)])clearTimeout(devices[_0x4692b7][_0x3dec29(0x146)]);devices[_0x4692b7]['pidRefreshToken']=setTimeout(()=>{const _0x1b57e2=_0x3dec29;getClientsWithUuid(_0x4692b7)[_0x1b57e2(0x18d)]!=0x0?(devices[_0x4692b7][_0x1b57e2(0x184)]=refreshToken(_0x4692b7),io['to'](_0x4692b7)['emit']('status',{'status':_0x1b57e2(0x13c),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x4692b7][_0x1b57e2(0x184)],'externalip':devices[_0x4692b7]['ip'],'publicKey':secure[_0x1b57e2(0xdd)],'validInstallation':validInstallation}),setTokenRefresh(_0x4692b7)):clearTimeout(devices[_0x4692b7][_0x1b57e2(0x146)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3718ba){const _0x4bc5e9=_0x381d67,_0x3c0826=getClient(_0x3718ba['id'])['uuid'];_0x3718ba[_0x4bc5e9(0xc2)]('bots',config),_0x3718ba[_0x4bc5e9(0xc2)](_0x4bc5e9(0xf0),cleanSettings()),_0x3718ba['on'](_0x4bc5e9(0x1d8),_0x473bfb=>{const _0x50b314=_0x4bc5e9;if(validateAccess(_0x473bfb,_0x3c0826)['allow'])addBot();else logging(_0x50b314(0x120));}),_0x3718ba['on'](_0x4bc5e9(0xe5),(_0x29b071,_0x2eb258)=>{const _0x2f7a1e=_0x4bc5e9;if(validateAccess(_0x2eb258,_0x3c0826)[_0x2f7a1e(0x1e0)])toggleBot(_0x29b071['botID'],_0x29b071[_0x2f7a1e(0x185)],_0x29b071[_0x2f7a1e(0x1f0)]);else logging('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x3718ba['on']('delete-bot',(_0x2eb419,_0x3e7026)=>{const _0x52c408=_0x4bc5e9;if(validateAccess(_0x3e7026,_0x3c0826)[_0x52c408(0x1e0)])deleteBot(_0x2eb419);else logging(_0x52c408(0x195));}),_0x3718ba['on']('store-settings',(_0x3b9e51,_0x2b0f2d)=>{const _0x1447fc=_0x4bc5e9;if(validateAccess(_0x2b0f2d,_0x3c0826)[_0x1447fc(0x1e0)])storeSettings(_0x3b9e51,!![]);else logging('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x3718ba['on'](_0x4bc5e9(0x19a),_0x3e3c99=>{const _0x1cbbe7=_0x4bc5e9;if(validateAccess(_0x3e3c99,_0x3c0826)[_0x1cbbe7(0x1e0)])updateBB();else logging(_0x1cbbe7(0x1db));}),_0x3718ba['on'](_0x4bc5e9(0x1ef),_0xf60be6=>{const _0x3f32f2=_0x4bc5e9;if(validateAccess(_0xf60be6,_0x3c0826)[_0x3f32f2(0x1e0)]){if(devices[_0x3c0826][_0x3f32f2(0x146)])clearTimeout(devices[_0x3c0826][_0x3f32f2(0x146)]);if(devices[_0x3c0826][_0x3f32f2(0xe7)])clearTimeout(devices[_0x3c0826][_0x3f32f2(0xe7)]);removeSocketListeners(getClient(_0x3718ba['id'])[_0x3f32f2(0x163)]),addBlacklist(_0x3c0826),devices[_0x3c0826]['telegramIpApproval']=null,devices[_0x3c0826][_0x3f32f2(0x15c)]=null,devices[_0x3c0826]['access'][_0x3f32f2(0x1d2)]=null,io['to'](getClient(_0x3718ba['id'])[_0x3f32f2(0x163)])[_0x3f32f2(0xc2)](_0x3f32f2(0x185),{'access':{'allow':![],'reason':_0x3f32f2(0x1cf),'token':null}});}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x550bc4){const _0x7cdfcc=_0x381d67,_0xbe5309=getClient(_0x550bc4['id'])['bot'],_0x2c3ada=getClient(_0x550bc4['id'])[_0x7cdfcc(0x163)];_0x550bc4['on']('get-logs',(_0x5d2d5c,_0x3d3413)=>{const _0x3e4089=_0x7cdfcc;if(validateAccess(_0x3d3413,_0x2c3ada)['allow']){if(pid[_0xbe5309])pid[_0xbe5309][_0x3e4089(0x11b)]({'function':_0x3e4089(0x1d3),'args':_0x5d2d5c});}else logging(_0x3e4089(0xfe));}),_0x550bc4['on'](_0x7cdfcc(0x1c1),(_0x180085,_0x4db9b3)=>{const _0x1bcdd8=_0x7cdfcc;if(validateAccess(_0x4db9b3,_0x2c3ada)[_0x1bcdd8(0x1e0)]){if(pid[_0xbe5309])pid[_0xbe5309][_0x1bcdd8(0x11b)]({'function':'deleteHistoryAlerts','args':_0x180085});}else logging('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x550bc4['on'](_0x7cdfcc(0x133),(_0x17a7ae,_0x5c9b50)=>{const _0x572d42=_0x7cdfcc;if(validateAccess(_0x5c9b50,_0x2c3ada)['allow']){if(pid[_0xbe5309])pid[_0xbe5309]['send']({'function':_0x572d42(0x1d5),'args':_0x17a7ae});}else logging(_0x572d42(0xd6));}),_0x550bc4['on'](_0x7cdfcc(0x139),(_0x25a7ac,_0x4c1b9b)=>{const _0xd9aab=_0x7cdfcc;if(validateAccess(_0x4c1b9b,_0x2c3ada)[_0xd9aab(0x1e0)]){if(pid[_0xbe5309])pid[_0xbe5309][_0xd9aab(0x11b)]({'function':_0xd9aab(0x13f),'args':_0x25a7ac});}else logging(_0xd9aab(0x194));}),_0x550bc4['on'](_0x7cdfcc(0x190),(_0x5c5f27,_0x2c838f)=>{const _0x3fbb40=_0x7cdfcc;if(validateAccess(_0x2c838f,_0x2c3ada)[_0x3fbb40(0x1e0)]){if(pid[_0xbe5309])pid[_0xbe5309][_0x3fbb40(0x11b)]({'function':_0x3fbb40(0x127),'args':_0x5c5f27});}else logging('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x550bc4['on'](_0x7cdfcc(0x150),_0x544eb3=>{const _0x259ee1=_0x7cdfcc;if(validateAccess(_0x544eb3,_0x2c3ada)[_0x259ee1(0x1e0)]){if(pid[_0xbe5309])pid[_0xbe5309][_0x259ee1(0x11b)]({'function':_0x259ee1(0x113),'args':null});}else logging(_0x259ee1(0x140));}),_0x550bc4['on']('place-order',(_0x2ccd24,_0x229d2f)=>{const _0x3369d3=_0x7cdfcc;if(validateAccess(_0x229d2f,_0x2c3ada)[_0x3369d3(0x1e0)]){if(pid[_0xbe5309])pid[_0xbe5309][_0x3369d3(0x11b)]({'function':'placeOrder','args':_0x2ccd24});}else logging(_0x3369d3(0x1e1));}),_0x550bc4['on']('cancel-loading',_0x362035=>{const _0x4cc327=_0x7cdfcc;if(validateAccess(_0x362035,_0x2c3ada)[_0x4cc327(0x1e0)]){if(pid[_0xbe5309])pid[_0xbe5309]['send']({'function':'cancelLoading','args':null});}else logging(_0x4cc327(0x193));}),_0x550bc4['on'](_0x7cdfcc(0x1ef),_0x26b8cb=>{const _0x205c2b=_0x7cdfcc;if(validateAccess(_0x26b8cb,_0x2c3ada)[_0x205c2b(0x1e0)]){if(devices[_0x2c3ada][_0x205c2b(0x146)])clearTimeout(devices[_0x2c3ada][_0x205c2b(0x146)]);if(devices[_0x2c3ada][_0x205c2b(0xe7)])clearTimeout(devices[_0x2c3ada][_0x205c2b(0xe7)]);removeSocketListeners(getClient(_0x550bc4['id'])[_0x205c2b(0x163)]),addBlacklist(_0x2c3ada),devices[_0x2c3ada][_0x205c2b(0x137)]=null,devices[_0x2c3ada][_0x205c2b(0x15c)]=null,devices[_0x2c3ada]['access'][_0x205c2b(0x1d2)]=null,io['to'](getClient(_0x550bc4['id'])['uuid'])[_0x205c2b(0xc2)](_0x205c2b(0x185),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0x205c2b(0x148));});}function removeSocketListeners(_0x14bf0a){const _0x2bc110=_0x381d67;getClientsWithUuid(_0x14bf0a)[_0x2bc110(0x155)](_0xeabe6d=>{const _0x2585fe=_0x2bc110;getSocket(_0xeabe6d['id'])[_0x2585fe(0x1c9)]();});}function cleanSettings(){const _0x3cc235=_0x381d67;let _0x28cf40=settings;return settings['telegramToken']&&settings[_0x3cc235(0x141)]!=''&&(_0x28cf40={..._0x28cf40,'telegramToken':'************'}),settings[_0x3cc235(0x1fb)]&&settings['bbPassword']!=''&&(_0x28cf40={..._0x28cf40,'bbPassword':_0x3cc235(0x192)}),_0x28cf40;}function updateBB(){const _0x502494=_0x381d67;installingUpdate=!![],config[_0x502494(0x155)](_0x10dbec=>{const _0x2360ce=_0x502494;restartBot(_0x10dbec[_0x2360ce(0x1c8)]);}),process['send']({'update':!![]},_0x148e5d=>{});}function startBot(_0x261ef3,_0x16789f,_0x20ccc0){const _0x2a2360=_0x381d67;let _0x343855=![];const _0x111483=_0x261ef3[0x0];_0x16789f={..._0x16789f,'stdio':[_0x2a2360(0x14f),_0x2a2360(0x14f),'inherit',_0x2a2360(0x1e3)]},pid[_0x111483]=childProcess[_0x2a2360(0x197)](botfile,_0x261ef3,_0x16789f),pid[_0x111483]['on'](_0x2a2360(0x1ed),_0x187d8c=>{const _0x554d1a=_0x2a2360;switch(Object['keys'](_0x187d8c)[0x0]){case _0x554d1a(0xf1):updateBotName(_0x111483,_0x187d8c['botname']);break;case _0x554d1a(0x185):updateStatus(_0x111483,_0x187d8c[_0x554d1a(0x185)]);break;case'live':updateLive(_0x111483,_0x187d8c[_0x554d1a(0x1f0)]);break;case'started':updateLive(_0x111483,_0x187d8c[_0x554d1a(0x196)]),io['to'](_0x111483)[_0x554d1a(0xc2)](_0x554d1a(0x185),{'access':{'allow':![],'reason':_0x554d1a(0x1f1),'token':null}});break;case _0x554d1a(0xfb):_0x187d8c[_0x554d1a(0xfb)]==_0x554d1a(0xfd)&&restartBot(_0x111483);_0x187d8c[_0x554d1a(0xfb)]==_0x554d1a(0xd0)&&toggleBot(_0x111483,_0x554d1a(0xce),_0x554d1a(0xf7));break;case'telegram':sendTelegram(_0x111483,_0x187d8c['telegram']);break;case'function':io['to'](_0x111483)[_0x554d1a(0xc2)](_0x187d8c[_0x554d1a(0x179)],_0x187d8c[_0x554d1a(0x10b)]);break;}}),pid[_0x111483]['on']('error',function(_0x112138){if(_0x343855)return;_0x343855=!![],_0x20ccc0(_0x112138);}),pid[_0x111483]['on'](_0x2a2360(0xc3),function(_0x9209ae){const _0x42c0be=_0x2a2360;if(installingUpdate)return;if(_0x343855)return;_0x343855=!![],_0x20ccc0(null);const _0x13c6d9=dbConfig[_0x42c0be(0x10d)](_0x42c0be(0xca))[_0x42c0be(0xec)]({'botID':_0x111483})['value']();_0x13c6d9&&(_0x13c6d9[_0x42c0be(0x185)]=='enabled'||_0x13c6d9[_0x42c0be(0x185)]=='new')&&(updateLive(_0x111483,'stopped'),logging('restarting\x20Bot\x20'+_0x111483),startBot([_0x111483,userID],{'cwd':bbpath},function(_0x23f2f6){if(_0x23f2f6)logging(_0x23f2f6);}));});}function stopBot(_0x5392ba){const _0x10aebe=_0x381d67;getClientsWithBotID(_0x5392ba)['forEach'](_0x52d137=>{const _0x40a0f1=_0x4f30;getSocket(_0x52d137['id'])[_0x40a0f1(0x12a)](!![]),removeClient(_0x52d137['id']);});if(pid[_0x5392ba])pid[_0x5392ba][_0x10aebe(0xd0)]();}function restartBot(_0xa6a5e3){const _0x8b1a08=_0x381d67;if(pid[_0xa6a5e3])pid[_0xa6a5e3][_0x8b1a08(0xd0)]();}function addBot(){const _0x19fed2=_0x381d67;let _0x55d680;for(let _0x277d8e=0x1;_0x277d8e<0x3e9;_0x277d8e++){_0x55d680=_0x277d8e[_0x19fed2(0x1d7)]()[_0x19fed2(0xcc)](0x3,'0');let _0x5276f3=config[_0x19fed2(0xec)](_0x7ad928=>_0x7ad928[_0x19fed2(0x1c8)]==_0x55d680);if(!_0x5276f3)break;}if(_0x55d680===_0x19fed2(0x1ce)){logging(_0x19fed2(0x112));return;}logging(_0x19fed2(0xc8)+_0x55d680),dbConfig[_0x19fed2(0x10d)](_0x19fed2(0xca))[_0x19fed2(0x170)]({'botID':_0x55d680,'botname':_0x19fed2(0x186)+_0x55d680,'status':_0x19fed2(0x1f4),'live':''})[_0x19fed2(0x171)](),startBot([_0x55d680,userID],{'cwd':bbpath},function(_0x39b45d){if(_0x39b45d)logging(_0x39b45d);}),config=getConfiguration(),io['to'](_0x19fed2(0x175))[_0x19fed2(0xc2)](_0x19fed2(0xca),config);}function deleteBot(_0x5d8cc2){const _0x283b09=_0x381d67;getClientsWithBotID(_0x5d8cc2)[_0x283b09(0x155)](_0x590b4e=>{const _0x359070=_0x283b09;getSocket(_0x590b4e['id'])[_0x359070(0x12a)](!![]),removeClient(_0x590b4e['id']);}),dbConfig['get'](_0x283b09(0xca))[_0x283b09(0x1da)]({'botID':_0x5d8cc2})[_0x283b09(0x171)](),logging(_0x283b09(0x123)+_0x5d8cc2),stopBot(_0x5d8cc2);try{fs[_0x283b09(0x106)](path[_0x283b09(0x1e7)](configpath,_0x283b09(0x1be)+_0x5d8cc2+_0x283b09(0x108))),fs['unlinkSync'](path['join'](configpath,_0x283b09(0x1be)+_0x5d8cc2+'-events.json')),fs[_0x283b09(0x106)](path['join'](configpath,_0x283b09(0x1be)+_0x5d8cc2+_0x283b09(0x156))),fs[_0x283b09(0x106)](path['join'](configpath,_0x283b09(0x1be)+_0x5d8cc2+'-results.json'));}catch(_0x21e53f){if(_0x21e53f)logging(_0x283b09(0x198),_0x21e53f);}config=getConfiguration(),io['to'](_0x283b09(0x175))['emit'](_0x283b09(0xca),config);}function toggleBot(_0x3231cb,_0x41ac8d,_0x46bac4){const _0x53d2c2=_0x381d67;dbConfig[_0x53d2c2(0x10d)](_0x53d2c2(0xca))[_0x53d2c2(0xec)]({'botID':_0x3231cb})[_0x53d2c2(0x18f)]({'status':_0x41ac8d})['assign']({'live':_0x46bac4})[_0x53d2c2(0x171)]();if(_0x41ac8d==_0x53d2c2(0x1ec)||_0x41ac8d==_0x53d2c2(0x1f4))logging(_0x53d2c2(0x1d0)+_0x3231cb),startBot([_0x3231cb,userID],{'cwd':bbpath},function(_0x37d2f1){if(_0x37d2f1)logging(_0x37d2f1);});else(_0x41ac8d=='disabled'||_0x41ac8d=='new-disabled')&&(logging(_0x53d2c2(0x1b5)+_0x3231cb),stopBot(_0x3231cb));config=getConfiguration(),io['to']('botmanager')[_0x53d2c2(0xc2)](_0x53d2c2(0xca),config);}function toggleStatus(_0x4bc7ec){const _0x5d105e=_0x381d67;let _0x4c5816=dbConfig[_0x5d105e(0x10d)](_0x5d105e(0xca))[_0x5d105e(0xec)]({'botID':_0x4bc7ec})[_0x5d105e(0x10e)](),_0x18be13;if(_0x4c5816[_0x5d105e(0x185)]===_0x5d105e(0x1ec))_0x18be13=_0x5d105e(0xce);else{if(_0x4c5816[_0x5d105e(0x185)]===_0x5d105e(0x1f4))_0x18be13=_0x5d105e(0x100);else{if(_0x4c5816[_0x5d105e(0x185)]===_0x5d105e(0x100))_0x18be13='new';else{if(_0x4c5816[_0x5d105e(0x185)]==='disabled')_0x18be13=_0x5d105e(0x1ec);}}}return _0x18be13;}function updateStatus(_0x42d5b7,_0x44b8c6){const _0x358f6f=_0x381d67;dbConfig[_0x358f6f(0x10d)]('bots')[_0x358f6f(0xec)]({'botID':_0x42d5b7})[_0x358f6f(0x18f)]({'status':_0x44b8c6})[_0x358f6f(0x171)](),config=getConfiguration(),io['to'](_0x358f6f(0x175))[_0x358f6f(0xc2)]('bots',config);}function updateLive(_0x44d937,_0x212f1f){const _0xe045c3=_0x381d67;dbConfig[_0xe045c3(0x10d)](_0xe045c3(0xca))[_0xe045c3(0xec)]({'botID':_0x44d937})[_0xe045c3(0x18f)]({'live':_0x212f1f})[_0xe045c3(0x171)](),config=getConfiguration(),io['to'](_0xe045c3(0x175))['emit'](_0xe045c3(0xca),config);}function updateBotName(_0x3a27e6,_0x394500){const _0x2e10af=_0x381d67;dbConfig[_0x2e10af(0x10d)](_0x2e10af(0xca))[_0x2e10af(0xec)]({'botID':_0x3a27e6})['assign']({'botname':_0x394500})[_0x2e10af(0x171)](),config=getConfiguration(),io['to']('botmanager')[_0x2e10af(0xc2)]('bots',config);}function telegramError(_0x2a4a8e){const _0x4acb29=_0x381d67;console[_0x4acb29(0x1a3)](getTimeStamp()+_0x4acb29(0x1a1));}function validateTelegram(_0x15ab3d){const _0x307297=_0x381d67;if(_0x15ab3d[_0x307297(0x1f9)][_0x307297(0x189)]!=settings[_0x307297(0x165)]&&'@'+_0x15ab3d[_0x307297(0x1f9)][_0x307297(0x189)]!=settings[_0x307297(0x165)])return tgBot['sendMessage'](_0x15ab3d[_0x307297(0x11d)]['id'],_0x307297(0xd3),{'parse_mode':'HTML'})[_0x307297(0x1e5)](_0x3995c1=>{telegramError(_0x3995c1);}),![];return!![];}async function initTelegram(){const _0x4b7774=_0x381d67;if(tgBot)tgBot[_0x4b7774(0x1c6)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x4b7774(0x141)],{'polling':!![]});let _0x45768e=_0x4b7774(0x168);_0x45768e+='\x0a',_0x45768e+=_0x4b7774(0x1a2),_0x45768e+='/disable\x20-\x20disable\x20notifications\x0a',_0x45768e+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x45768e+=_0x4b7774(0x15b),_0x45768e+='/on\x20-\x20start\x20bot(s)\x0a',_0x45768e+=_0x4b7774(0x16b),_0x45768e+=_0x4b7774(0x1de),_0x45768e+=_0x4b7774(0x13b);let _0x1d4360=_0x4b7774(0x1dd);_0x1d4360+='\x0a',_0x1d4360+=_0x45768e,tgBot[_0x4b7774(0x16f)](/\/start/,_0x1086bf=>{const _0xe5af94=_0x4b7774;if(!validateTelegram(_0x1086bf))return;if(settings[_0xe5af94(0x13a)]!=_0x1086bf['chat']['id'])updateSetting('telegramChatId',_0x1086bf[_0xe5af94(0x11d)]['id']);updateSetting(_0xe5af94(0x19e),!![]),tgBot[_0xe5af94(0xf2)](_0x1086bf[_0xe5af94(0x11d)]['id'],_0x1d4360)[_0xe5af94(0x1e5)](_0xf9f1d8=>{telegramError(_0xf9f1d8);});}),tgBot[_0x4b7774(0x16f)](/\/enable/,_0x40b7ff=>{const _0x459998=_0x4b7774;if(!validateTelegram(_0x40b7ff))return;if(settings['telegramChatId']!=_0x40b7ff[_0x459998(0x11d)]['id'])updateSetting('telegramChatId',_0x40b7ff[_0x459998(0x11d)]['id']);updateSetting(_0x459998(0x19e),!![]),tgBot['sendMessage'](_0x40b7ff[_0x459998(0x11d)]['id'],_0x459998(0x1bd))[_0x459998(0x1e5)](_0x595e5e=>{telegramError(_0x595e5e);});}),tgBot[_0x4b7774(0x16f)](/\/config/,async _0x136146=>{const _0x1a0072=_0x4b7774;if(!validateTelegram(_0x136146))return;tgBot[_0x1a0072(0x114)](_0x1a0072(0x1a4)),tgBot[_0x1a0072(0xf2)](_0x136146[_0x1a0072(0x11d)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x1a0072(0x161),'callback_data':_0x1a0072(0x124)},{'text':_0x1a0072(0x17a),'callback_data':_0x1a0072(0x147)},{'text':_0x1a0072(0xf8),'callback_data':_0x1a0072(0x119)}]]}})[_0x1a0072(0x1e5)](_0x2dc1f2=>{telegramError(_0x2dc1f2);}),tgBot['on']('callback_query',async _0x33ac3e=>{const _0x26709a=_0x1a0072,_0x5278ea=_0x33ac3e[_0x26709a(0x11f)],_0x44c50a=_0x33ac3e[_0x26709a(0x1ed)];tgBot[_0x26709a(0x1bb)](_0x33ac3e['id'])[_0x26709a(0x12d)](async()=>{const _0x3eaff2=_0x26709a;_0x5278ea==_0x3eaff2(0x124)&&(updateSetting(_0x3eaff2(0xd9),_0x3eaff2(0x124)),updateSetting(_0x3eaff2(0x19e),!![]),await tgBot['sendMessage'](_0x44c50a[_0x3eaff2(0x11d)]['id'],_0x3eaff2(0x1c7))[_0x3eaff2(0x1e5)](_0x35e5c1=>{telegramError(_0x35e5c1);}));_0x5278ea==_0x3eaff2(0x147)&&(updateSetting('telegramEvents',_0x3eaff2(0x147)),updateSetting(_0x3eaff2(0x19e),!![]),await tgBot[_0x3eaff2(0xf2)](_0x44c50a[_0x3eaff2(0x11d)]['id'],_0x3eaff2(0x153))['catch'](_0x23d1ff=>{telegramError(_0x23d1ff);}));_0x5278ea==_0x3eaff2(0x119)&&(updateSetting(_0x3eaff2(0xd9),_0x3eaff2(0x119)),updateSetting(_0x3eaff2(0x19e),!![]),await tgBot[_0x3eaff2(0xf2)](_0x44c50a[_0x3eaff2(0x11d)]['id'],_0x3eaff2(0x1ae))['catch'](_0x42f0f3=>{telegramError(_0x42f0f3);}));if(!settings[_0x3eaff2(0x13a)])tgBot[_0x3eaff2(0xf2)](_0x44c50a[_0x3eaff2(0x11d)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')['catch'](_0x1cf849=>{telegramError(_0x1cf849);});}),tgBot[_0x26709a(0x114)](_0x26709a(0x1a4));});}),tgBot[_0x4b7774(0x16f)](/\/status/,_0x2895ed=>{const _0x2741e5=_0x4b7774;if(!validateTelegram(_0x2895ed))return;let _0x146109=_0x2741e5(0x1b3);config[_0x2741e5(0x155)](_0x40edf6=>{const _0x5ee485=_0x2741e5;_0x146109+='Bot\x20'+_0x40edf6[_0x5ee485(0x1c8)]+_0x5ee485(0x1cd)+_0x40edf6['botname']+':\x20'+_0x40edf6[_0x5ee485(0x185)]+'\x20/\x20'+_0x40edf6[_0x5ee485(0x1f0)]+'\x0a';}),_0x146109+='\x0a',_0x146109+='<b>Telegram\x20bot\x20status:</b>\x0a',_0x146109+=!settings[_0x2741e5(0x19e)]?'Notifications\x20disabled\x0a':'Notifications\x20enabled\x0a',_0x146109+=settings['telegramEnabled']?settings['telegramEvents']==_0x2741e5(0x119)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings[_0x2741e5(0xd9)]+_0x2741e5(0xdf):'',tgBot[_0x2741e5(0xf2)](_0x2895ed[_0x2741e5(0x11d)]['id'],_0x146109,{'parse_mode':'HTML'})[_0x2741e5(0x1e5)](_0x349658=>{telegramError(_0x349658);});}),tgBot[_0x4b7774(0x16f)](/\/restart/,_0x4f0e34=>{const _0x60eb25=_0x4b7774;if(!validateTelegram(_0x4f0e34))return;tgBot[_0x60eb25(0x114)]('callback_query');const _0x38d251=getEnabledBots();if(_0x38d251[_0x60eb25(0x18d)]==0x0)tgBot[_0x60eb25(0xf2)](_0x4f0e34[_0x60eb25(0x11d)]['id'],_0x60eb25(0xed))[_0x60eb25(0x1e5)](_0x5de127=>{telegramError(_0x5de127);});else{if(_0x38d251[_0x60eb25(0x18d)]>0x1)_0x38d251[_0x60eb25(0x170)]({'botID':_0x60eb25(0x119)});let _0x32f2bb=[],_0x3e3291=[];const _0x430e8f=_0x38d251['length']%0x4==0x0||_0x38d251['length']%0x4==0x3||_0x38d251[_0x60eb25(0x18d)]%0x3==0x1?0x4:0x3;let _0x454403=0x0;_0x38d251['forEach']((_0x45ef77,_0x5ee88e)=>{const _0x309482=_0x60eb25;if(_0x5ee88e%_0x430e8f==0x0)_0x3e3291=[];_0x3e3291['push']({'text':_0x45ef77['botID']=='all'?_0x309482(0xe9):_0x309482(0x186)+_0x45ef77[_0x309482(0x1c8)],'callback_data':_0x45ef77['botID']}),_0x5ee88e%_0x430e8f==0x0&&(_0x32f2bb[_0x454403]=_0x3e3291,_0x454403++);}),tgBot['sendMessage'](_0x4f0e34['chat']['id'],_0x60eb25(0x1df),{'reply_markup':{'inline_keyboard':_0x32f2bb}})[_0x60eb25(0x1e5)](_0x548ca2=>{telegramError(_0x548ca2);}),tgBot['on'](_0x60eb25(0x1a4),async _0xa832c5=>{const _0xbe947a=_0x60eb25,_0x16e72d=_0xa832c5[_0xbe947a(0x11f)],_0x340495=_0xa832c5['message'];tgBot[_0xbe947a(0x1bb)](_0xa832c5['id'])['then'](async()=>{const _0x3742d3=_0xbe947a;if(_0x16e72d==_0x3742d3(0x119)){if(settings[_0x3742d3(0xd9)]==_0x3742d3(0x124))tgBot[_0x3742d3(0xf2)](_0x340495[_0x3742d3(0x11d)]['id'],_0x3742d3(0x178))[_0x3742d3(0x1e5)](_0x1f994f=>{telegramError(_0x1f994f);});config[_0x3742d3(0x155)](_0x296bc1=>{const _0x2df396=_0x3742d3;restartBot(_0x296bc1[_0x2df396(0x1c8)]);});}else{if(settings[_0x3742d3(0xd9)]=='orders')tgBot[_0x3742d3(0xf2)](_0x340495[_0x3742d3(0x11d)]['id'],_0x3742d3(0x125)+_0x16e72d)[_0x3742d3(0x1e5)](_0x2cdb52=>{telegramError(_0x2cdb52);});restartBot(_0x16e72d);}}),tgBot[_0xbe947a(0x114)](_0xbe947a(0x1a4));});}}),tgBot[_0x4b7774(0x16f)](/\/on/,_0x4ca17e=>{const _0x13d95b=_0x4b7774;if(!validateTelegram(_0x4ca17e))return;tgBot['removeListener']('callback_query');const _0x4b35c6=getDisabledBots();if(_0x4b35c6[_0x13d95b(0x18d)]==0x0)tgBot['sendMessage'](_0x4ca17e[_0x13d95b(0x11d)]['id'],_0x13d95b(0x12e))[_0x13d95b(0x1e5)](_0x1b34eb=>{telegramError(_0x1b34eb);});else{if(_0x4b35c6[_0x13d95b(0x18d)]>0x1)_0x4b35c6[_0x13d95b(0x170)]({'botID':_0x13d95b(0x119)});let _0x45b5a3=[],_0x33ceb6=[];const _0x26ee5a=_0x4b35c6['length']%0x4==0x0||_0x4b35c6[_0x13d95b(0x18d)]%0x4==0x3||_0x4b35c6[_0x13d95b(0x18d)]%0x3==0x1?0x4:0x3;let _0x597205=0x0;_0x4b35c6[_0x13d95b(0x155)]((_0x5232d2,_0x558cb8)=>{const _0x358068=_0x13d95b;if(_0x558cb8%_0x26ee5a==0x0)_0x33ceb6=[];_0x33ceb6[_0x358068(0x170)]({'text':_0x5232d2[_0x358068(0x1c8)]=='all'?'All\x20bots':_0x358068(0x186)+_0x5232d2[_0x358068(0x1c8)],'callback_data':_0x5232d2['botID']}),_0x558cb8%_0x26ee5a==0x0&&(_0x45b5a3[_0x597205]=_0x33ceb6,_0x597205++);}),tgBot[_0x13d95b(0xf2)](_0x4ca17e[_0x13d95b(0x11d)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x45b5a3}})[_0x13d95b(0x1e5)](_0x55812b=>{telegramError(_0x55812b);}),tgBot['on'](_0x13d95b(0x1a4),async _0x408492=>{const _0x5733c5=_0x13d95b,_0x260d19=_0x408492[_0x5733c5(0x11f)],_0x1f0925=_0x408492[_0x5733c5(0x1ed)];tgBot[_0x5733c5(0x1bb)](_0x408492['id'])[_0x5733c5(0x12d)](async()=>{const _0x4c028f=_0x5733c5;if(_0x260d19==_0x4c028f(0x119)){if(settings['telegramEvents']==_0x4c028f(0x124))tgBot[_0x4c028f(0xf2)](_0x1f0925[_0x4c028f(0x11d)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x4c028f(0x1e5)](_0x9a62e3=>{telegramError(_0x9a62e3);});_0x4b35c6[_0x4c028f(0x155)](_0xe572b0=>{const _0x25370b=_0x4c028f;if(_0xe572b0[_0x25370b(0x1c8)]!=_0x25370b(0x119))toggleBot(_0xe572b0[_0x25370b(0x1c8)],toggleStatus(_0xe572b0[_0x25370b(0x1c8)]),_0x25370b(0xf7));});}else{if(settings[_0x4c028f(0xd9)]==_0x4c028f(0x124))tgBot[_0x4c028f(0xf2)](_0x1f0925[_0x4c028f(0x11d)]['id'],_0x4c028f(0x188)+_0x260d19)[_0x4c028f(0x1e5)](_0x3ed11f=>{telegramError(_0x3ed11f);});toggleBot(_0x260d19,toggleStatus(_0x260d19),'stopped');}}),tgBot['removeListener'](_0x5733c5(0x1a4));});}}),tgBot[_0x4b7774(0x16f)](/\/off/,_0x325f70=>{const _0xf3db60=_0x4b7774;if(!validateTelegram(_0x325f70))return;tgBot['removeListener']('callback_query');const _0x56ced9=getEnabledBots();if(_0x56ced9[_0xf3db60(0x18d)]==0x0)tgBot[_0xf3db60(0xf2)](_0x325f70[_0xf3db60(0x11d)]['id'],_0xf3db60(0xed))[_0xf3db60(0x1e5)](_0x5e8fc6=>{telegramError(_0x5e8fc6);});else{if(_0x56ced9[_0xf3db60(0x18d)]>0x1)_0x56ced9[_0xf3db60(0x170)]({'botID':_0xf3db60(0x119)});let _0x336a33=[],_0x57f5db=[];const _0x338e99=_0x56ced9['length']%0x4==0x0||_0x56ced9['length']%0x4==0x3||_0x56ced9[_0xf3db60(0x18d)]%0x3==0x1?0x4:0x3;let _0x117f02=0x0;_0x56ced9[_0xf3db60(0x155)]((_0x2499e3,_0x32c2b6)=>{const _0x5908fa=_0xf3db60;if(_0x32c2b6%_0x338e99==0x0)_0x57f5db=[];_0x57f5db['push']({'text':_0x2499e3[_0x5908fa(0x1c8)]=='all'?'All\x20bots':_0x5908fa(0x186)+_0x2499e3[_0x5908fa(0x1c8)],'callback_data':_0x2499e3['botID']}),_0x32c2b6%_0x338e99==0x0&&(_0x336a33[_0x117f02]=_0x57f5db,_0x117f02++);}),tgBot[_0xf3db60(0xf2)](_0x325f70[_0xf3db60(0x11d)]['id'],_0xf3db60(0x16e),{'reply_markup':{'inline_keyboard':_0x336a33}})[_0xf3db60(0x1e5)](_0x499ebb=>{telegramError(_0x499ebb);}),tgBot['on'](_0xf3db60(0x1a4),async _0xdcf808=>{const _0x3b89a3=_0xf3db60,_0x3b9d28=_0xdcf808[_0x3b89a3(0x11f)],_0x2bde1d=_0xdcf808[_0x3b89a3(0x1ed)];tgBot[_0x3b89a3(0x1bb)](_0xdcf808['id'])['then'](async()=>{const _0x28f957=_0x3b89a3;if(_0x3b9d28=='all'){if(settings[_0x28f957(0xd9)]==_0x28f957(0x124))tgBot[_0x28f957(0xf2)](_0x2bde1d['chat']['id'],_0x28f957(0x169))[_0x28f957(0x1e5)](_0x40b0df=>{telegramError(_0x40b0df);});_0x56ced9[_0x28f957(0x155)](_0x3dcd88=>{const _0x5e94f1=_0x28f957;if(_0x3dcd88[_0x5e94f1(0x1c8)]!=_0x5e94f1(0x119))toggleBot(_0x3dcd88[_0x5e94f1(0x1c8)],toggleStatus(_0x3dcd88[_0x5e94f1(0x1c8)]),_0x5e94f1(0xf7));});}else{if(settings[_0x28f957(0xd9)]=='orders')tgBot[_0x28f957(0xf2)](_0x2bde1d[_0x28f957(0x11d)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x3b9d28)[_0x28f957(0x1e5)](_0xcc6886=>{telegramError(_0xcc6886);});toggleBot(_0x3b9d28,toggleStatus(_0x3b9d28),_0x28f957(0xf7));}}),tgBot[_0x3b89a3(0x114)](_0x3b89a3(0x1a4));});}}),tgBot['onText'](/\/disable/,_0x5ab852=>{const _0x209df3=_0x4b7774;if(!validateTelegram(_0x5ab852))return;tgBot['sendMessage'](_0x5ab852[_0x209df3(0x11d)]['id'],_0x209df3(0xdc))[_0x209df3(0x1e5)](_0x54bdd2=>{telegramError(_0x54bdd2);}),updateSetting(_0x209df3(0x19e),![]);}),tgBot['onText'](/\/help/,_0x517c59=>{const _0x19bc4e=_0x4b7774;if(!validateTelegram(_0x517c59))return;tgBot[_0x19bc4e(0xf2)](_0x517c59[_0x19bc4e(0x11d)]['id'],_0x45768e)[_0x19bc4e(0x1e5)](_0x1e66f6=>{telegramError(_0x1e66f6);});}),tgBot['on'](_0x4b7774(0x1ca),_0x29aea9=>{const _0x118ed1=_0x4b7774;_0x29aea9[_0x118ed1(0x1d7)]()['includes'](_0x118ed1(0x110))&&(logging(_0x118ed1(0xdb)),tgBot[_0x118ed1(0x1c6)](),tgBot=null,io['to'](_0x118ed1(0x175))[_0x118ed1(0xc2)]('notification','Invalid\x20Telegram\x20token'));}),process[_0x4b7774(0x1a6)](_0x4b7774(0xeb),()=>{const _0x194bf6=_0x4b7774;if(tgBot)tgBot[_0x194bf6(0x1c6)]();process[_0x194bf6(0xc3)](0x1);}),process[_0x4b7774(0x1a6)](_0x4b7774(0xf6),()=>{const _0x1b0279=_0x4b7774;if(tgBot)tgBot[_0x1b0279(0x1c6)]();process['exit'](0x1);});}}function disableTelegram(){const _0x1340d2=_0x381d67;tgBot&&(tgBot[_0x1340d2(0x1c6)](),tgBot=null);}function sendTelegram(_0x553544,_0x5bd5c8){const _0x1bdd81=_0x381d67;if(settings['telegramEnabled']){if(settings['telegramEvents']=='all'||(_0x5bd5c8['type']==_0x1bdd81(0x172)||_0x5bd5c8['type']==_0x1bdd81(0xc1))&&settings['telegramEvents']=='alerts'||_0x5bd5c8[_0x1bdd81(0x15e)]=='order'&&settings[_0x1bdd81(0xd9)]==_0x1bdd81(0x124)){if(tgBot&&settings[_0x1bdd81(0x13a)]){if(_0x5bd5c8[_0x1bdd81(0x1ac)])tgBot[_0x1bdd81(0xf2)](settings[_0x1bdd81(0x13a)],_0x5bd5c8[_0x1bdd81(0xf1)]+_0x1bdd81(0x1f5)+_0x5bd5c8['event'])['catch'](_0x5a39c2=>{telegramError(_0x5a39c2);});else tgBot[_0x1bdd81(0xf2)](settings[_0x1bdd81(0x13a)],'Bot\x20'+_0x553544+'\x20>\x20'+_0x5bd5c8[_0x1bdd81(0xd8)])[_0x1bdd81(0x1e5)](_0x4958fd=>{telegramError(_0x4958fd);});}}}}function getDeviceWithIp(_0x12dbf3){const _0x5449c7=_0x381d67;return devices[_0x5449c7(0xec)](_0x13932c=>_0x13932c['ip']===_0x12dbf3);}function temporaryAccess2FA(_0x4b977b,_0xa2a355){const _0x536940=_0x381d67;let _0x424aa9=new Date(),_0x48d138=![];if(lastIpApproval){if(_0x424aa9-lastIpApproval<0x1388)_0x48d138=!![];}lastIpApproval=new Date();if(_0x48d138)return;tgBot&&settings[_0x536940(0x13a)]&&(tgBot[_0x536940(0x114)](_0x536940(0x1a4)),tgBot['sendMessage'](settings[_0x536940(0x13a)],_0x536940(0x1d9)+normalizeIP(_0xa2a355)[_0x536940(0x173)]+'</b>\x20?',{'parse_mode':_0x536940(0x105),'reply_markup':{'inline_keyboard':[[{'text':_0x536940(0x1c0),'callback_data':'5'},{'text':_0x536940(0x191),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x536940(0xe1),'callback_data':_0x536940(0xe1)}]]}})[_0x536940(0x1e5)](_0x540f25=>{telegramError(_0x540f25);}),tgBot['on'](_0x536940(0x1a4),async _0x32b2d7=>{const _0x4820ae=_0x536940,_0x127251=_0x32b2d7[_0x4820ae(0x11f)],_0x44ac0f=_0x32b2d7[_0x4820ae(0x1ed)];tgBot[_0x4820ae(0x1bb)](_0x32b2d7['id'])['then'](async()=>{const _0x3169fb=_0x4820ae;devices[_0x4b977b][_0x3169fb(0x137)]={'clientip':_0xa2a355,'timestamp':new Date()[_0x3169fb(0x151)](),'expiry':_0x127251},_0x127251!=_0x3169fb(0xe1)?(await tgBot[_0x3169fb(0xf2)](_0x44ac0f['chat']['id'],'Access\x20enabled\x20for\x20'+_0x127251+_0x3169fb(0x1f2),{'parse_mode':_0x3169fb(0x105)})[_0x3169fb(0x1e5)](_0x2abb6b=>{telegramError(_0x2abb6b);}),io['to'](_0x4b977b)[_0x3169fb(0xc2)](_0x3169fb(0x185),{'access':{'allow':![],'reason':_0x3169fb(0x1f1),'token':null}})):(await tgBot[_0x3169fb(0xf2)](_0x44ac0f[_0x3169fb(0x11d)]['id'],_0x3169fb(0x107))[_0x3169fb(0x1e5)](_0x2b3415=>{telegramError(_0x2b3415);}),io['to'](_0x4b977b)[_0x3169fb(0xc2)](_0x3169fb(0x185),{'access':{'allow':![],'reason':_0x3169fb(0x129),'token':null}}));}),tgBot[_0x4820ae(0x114)](_0x4820ae(0x1a4));}));}function loginAccess2FA(_0x5afd31,_0x32bc81){const _0x16ad74=_0x381d67;tgBot&&settings['telegramChatId']&&(tgBot[_0x16ad74(0x114)](_0x16ad74(0x1a4)),tgBot[_0x16ad74(0xf2)](settings[_0x16ad74(0x13a)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x32bc81)[_0x16ad74(0x173)]+_0x16ad74(0xc6),{'parse_mode':_0x16ad74(0x105),'reply_markup':{'inline_keyboard':[[{'text':_0x16ad74(0x102),'callback_data':loginExpiry},{'text':_0x16ad74(0xe1),'callback_data':_0x16ad74(0xe1)}]]}})[_0x16ad74(0x1e5)](_0x2904e1=>{telegramError(_0x2904e1);}),tgBot['on'](_0x16ad74(0x1a4),async _0x4543dd=>{const _0x1b7552=_0x16ad74,_0x64e629=_0x4543dd['data'],_0x1f8460=_0x4543dd[_0x1b7552(0x1ed)];tgBot[_0x1b7552(0x1bb)](_0x4543dd['id'])['then'](async()=>{const _0xb033aa=_0x1b7552;devices[_0x5afd31][_0xb033aa(0x15c)]={'clientip':_0x32bc81,'timestamp':new Date()[_0xb033aa(0x151)](),'expiry':_0x64e629},_0x64e629!=_0xb033aa(0xe1)?(await tgBot[_0xb033aa(0xf2)](_0x1f8460[_0xb033aa(0x11d)]['id'],'Login\x20accepted',{'parse_mode':_0xb033aa(0x105)})['catch'](_0x5bb5ea=>{telegramError(_0x5bb5ea);}),io['to'](_0x5afd31)['emit'](_0xb033aa(0x185),{'access':{'allow':![],'reason':_0xb033aa(0x1f1),'token':null}})):(await tgBot[_0xb033aa(0xf2)](_0x1f8460[_0xb033aa(0x11d)]['id'],_0xb033aa(0x1cb))['catch'](_0x220d5c=>{telegramError(_0x220d5c);}),io['to'](_0x5afd31)['emit']('status',{'access':{'allow':![],'reason':_0xb033aa(0xe0),'token':null}}));}),tgBot['removeListener'](_0x1b7552(0x1a4));}));}function getConfiguration(){const _0x4c941f=_0x381d67;return dbConfig[_0x4c941f(0x10d)](_0x4c941f(0xca))['sortBy'](_0x4c941f(0x1c8))[_0x4c941f(0x10e)]()||[];}function getEnabledBots(){const _0x3b2df9=_0x381d67;return dbConfig[_0x3b2df9(0x10d)](_0x3b2df9(0xca))[_0x3b2df9(0xd4)](_0x3b2df9(0x1c8))[_0x3b2df9(0x1b2)]({'status':_0x3b2df9(0x1ec)})[_0x3b2df9(0x10e)]()||[];}function getDisabledBots(){const _0x1ae783=_0x381d67;return dbConfig[_0x1ae783(0x10d)](_0x1ae783(0xca))[_0x1ae783(0xd4)](_0x1ae783(0x1c8))[_0x1ae783(0x1b2)]({'status':'disabled'})['value']()||[];}function getSettings(){const _0x317c26=_0x381d67;return dbSettings[_0x317c26(0x10d)](_0x317c26(0xf0))[_0x317c26(0x10e)]()||{'timeshift':0x0};}function _0x1704(){const _0x5619e1=['bot','login','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','sortBy','mkdirSync','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','event','telegramEvents','Bot\x20Mgr\x20>\x20','Invalid\x20Telegram\x20token','Notifications\x20disabled','publicKey','reset-password','\x20only\x0a','2FA\x20login\x20rejected','reject','bb-settings.json','settings.','privateKey','update-bot','(((.+)+)+)+$','pidExpireLogin','invalid\x20credentials','All\x20bots','test','SIGINT','find','No\x20bots\x20running\x20right\x20now','initclient','temporary\x20access\x20timeout','settings','botname','sendMessage','jsonwebtoken','NTBA_FIX_319','Crypt','SIGTERM','stopped','All','map','No\x20authentication\x20token','stop','argv','restart','Unauthorized\x20attempt\x20to\x20get\x20logs','defaults','new-disabled','bb-secure.json','accept','::1','apply','HTML','unlinkSync','Temporary\x20access\x20rejected','-config.json','kind','7425418LvDBMv','args','existsSync','get','value','getFullYear','404\x20Not\x20Found','3000','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','getStartingBalances','removeListener','2FA\x20login\x20required','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','getMinutes','blacklist','all','Invalid\x20authentication\x20token\x20(1)','send','f2aRequired','chat','default','data','Unauthorized\x20attempt\x20to\x20add\x20bot','decrypt','search','deleted\x20Bot\x20','orders','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','bb-config.json','storeHeadless','version','temporary\x20access\x20rejected','disconnect','bcryptjs','2FA','then','All\x20bots\x20running\x20right\x20now','index.html','timeshift','Password\x20has\x20been\x20reset\x20to:\x20','Balance\x20Bot','get-portfolio','password','hybrid-crypto-js','handshake','telegramIpApproval','ipaddr.js','store-configuration','telegramChatId','/help\x20-\x20show\x20available\x20commands\x0a','connected','Unauthorized\x20login\x20attempt\x20(timeout)','66udyPlc','storeConfiguration','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','telegramToken','login\x20token\x20generated','sendFile','timestamp','isValid','pidRefreshToken','alerts','Unauthorized\x20attempt\x20to\x20log\x20out','3258108pZbRPY','ipv6','clients','secure','max','connection','inherit','get-starting-balances','getTime','expiry','Ok,\x20will\x20send\x20alert\x20notifications\x20only','-----------------------------------------------------------------------------------','forEach','-performance.json','yargs/yargs','child_process','/:bot/portfolio','Invalid\x20IP\x20address','/restart\x20-\x20restart\x20bot(s)\x0a','telegram2FaApproval','isDirectory','type','starting\x20bot\x20|\x20Bot\x20','sign','Orders','remoteAddress','uuid','env','telegramUsername','secret','reason','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','/off\x20-\x20stop\x20bot(s)\x0a','referer','whitelistEnabled','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','onText','push','write','error','show','getSeconds','botmanager','slice','login\x20not\x20required','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','function','Alerts','match','encryptedUuid','access\x20timeout','config/','node-telegram-bot-api','https://hodlerhacks.com','hasOwnProperty','whitelist','static','access','status','Bot\x20','name','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','username','Invalid\x20authentication\x20token\x20(2)','login\x20token\x20valid','port','length','login\x20required','assign','store-headless','15\x20min','************','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Unauthorized\x20attempt\x20to\x20store\x20configuration','Unauthorized\x20attempt\x20to\x20delete\x20bot','started','fork','error\x20while\x20deleting\x20config\x20files:\x20','yes','update-bb','temporaryAccessAllowed','use','/:bot/support','telegramEnabled','getDate','User\x20has\x20been\x20validated',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','/enable\x20-\x20enable\x20notifications\x0a','log','callback_query','366846pZbabE','once','socket.io','crypto','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','exp','::ffff:127.0.0.1','showname','cloneDeep','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','temporary\x20access\x20not\x20allowed','temporary\x20token\x20generated','hex','filter','<b>Balance\x20Bot\x20status:</b>\x0a','build','disabled\x20Bot\x20','express','Error:\x20Invalid\x20argument\x20','2FA\x20required','clientip','lowdb/adapters/FileSync','answerCallbackQuery','/:bot/coins','Notifications\x20enabled','bot-','RSA-OAEP','5\x20min','delete-alerts','randomBytes','1723080VWZFli','listen','475955ELLiHs','stopPolling','Ok,\x20will\x20send\x20order\x20notifications\x20only','botID','removeAllListeners','polling_error','Login\x20rejected','2FA\x20login\x20token\x20generated','\x20|\x20','1000','logged\x20out','enabled\x20Bot\x20','bbUsername','token','emitHistory','Password\x20reset\x20rejected','getPortfolio','split','toString','add-bot','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','remove','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','createServer','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','/status\x20-\x20show\x20bot(s)\x20status\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','allow','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','/:bot/history','ipc','isIPv4MappedAddress','catch','build2','join','sha256','add','getHours','bb/','enabled','message','set','logout','live','reload','\x20minutes','apiKey','new','\x20>\x20','hashSync','copyFileSync','server','from','2534464vKPVlM','bbPassword','headers','521526PWVxdG','randomFillSync','success','emit','exit','http','getMonth','</b>\x20?','running','starting\x20new\x20bot\x20|\x20Bot\x20','store','bots','readdirSync','padStart','analytics','disabled','sockets','kill'];_0x1704=function(){return _0x5619e1;};return _0x1704();}function getSecure(){const _0x5d4e48=_0x381d67;return dbSecure[_0x5d4e48(0x10d)](_0x5d4e48(0x14c))[_0x5d4e48(0x10e)]()||{};}function getBlacklist(){const _0x193d42=_0x381d67;return dbSecure[_0x193d42(0x10d)]('blacklist')[_0x193d42(0x10e)]()||[];}function broadcastToBots(_0x16680e,_0x1e958f){const _0x13b3ab=_0x381d67;config[_0x13b3ab(0x155)](_0x575d74=>{const _0x45fe1b=_0x13b3ab;if(_0x575d74[_0x45fe1b(0x185)]=='enabled'&&_0x575d74['live']=='running'){if(pid[_0x575d74[_0x45fe1b(0x1c8)]])pid[_0x575d74[_0x45fe1b(0x1c8)]][_0x45fe1b(0x11b)]({[_0x16680e]:_0x1e958f});}});}function storeSettings(_0x51b80e,_0x4a39e2=![]){const _0x42a595=_0x381d67;_0x51b80e={...settings,..._0x51b80e};if(_0x4a39e2&&_0x51b80e[_0x42a595(0x1fb)]!='************'&&_0x51b80e[_0x42a595(0x1fb)]!=''){const _0x5f3fac=crypt['decrypt'](secure[_0x42a595(0xe4)],_0x51b80e[_0x42a595(0x1fb)])[_0x42a595(0x1ed)][_0x42a595(0x1d6)]('@')[0x0],_0x421a27=bcrypt[_0x42a595(0x1f6)](_0x5f3fac,saltRounds);_0x51b80e={..._0x51b80e,'bbPassword':_0x421a27};}if(_0x4a39e2&&_0x51b80e[_0x42a595(0x141)]!='************'&&_0x51b80e[_0x42a595(0x141)]!=''){const _0x4ec229=crypt['decrypt'](secure[_0x42a595(0xe4)],_0x51b80e[_0x42a595(0x141)])[_0x42a595(0x1ed)][_0x42a595(0x1d6)]('@')[0x0];_0x51b80e={..._0x51b80e,'telegramToken':_0x4ec229};}const _0x29ca17=_0x51b80e['telegramToken']!=_0x42a595(0x192)&&_0x51b80e[_0x42a595(0x141)]!=settings['telegramToken']||_0x51b80e[_0x42a595(0x165)]!=settings[_0x42a595(0x165)],_0x200739=_0x51b80e[_0x42a595(0x141)]==''||_0x51b80e[_0x42a595(0x165)]=='';if(_0x29ca17)_0x51b80e[_0x42a595(0xd9)]=_0x42a595(0x119);for(const [_0x3faff4,_0x4acc4d]of Object['entries'](_0x51b80e)){if(_0x3faff4==_0x42a595(0x141)&&_0x4acc4d==_0x42a595(0x192)){_0x51b80e[_0x42a595(0x141)]=settings[_0x42a595(0x141)];continue;};if(_0x3faff4==_0x42a595(0x1fb)&&_0x4acc4d==_0x42a595(0x192)){_0x51b80e['bbPassword']=settings[_0x42a595(0x1fb)];continue;};dbSettings['set'](_0x42a595(0xe3)+_0x3faff4,_0x4acc4d)['write']();}settings=_0x51b80e,io['to']('botmanager')[_0x42a595(0xc2)](_0x42a595(0xf0),cleanSettings()),broadcastToBots(_0x42a595(0x130),settings[_0x42a595(0x130)]);if(_0x29ca17&&!_0x200739)initTelegram();if(_0x29ca17&&_0x200739)disableTelegram();getAllClients()['forEach'](_0x3ab865=>{const _0x53f590=_0x42a595;getSocket(_0x3ab865['id'])[_0x53f590(0xc2)]('status',{'access':{'allow':![],'reason':_0x53f590(0x1f1),'token':null}});});}function updateSetting(_0x3b21e5,_0x2971e6){const _0x3f41a2=_0x381d67;dbSettings[_0x3f41a2(0x1ee)](_0x3f41a2(0xe3)+_0x3b21e5,_0x2971e6)[_0x3f41a2(0x171)](),settings=getSettings(),io['to']('botmanager')[_0x3f41a2(0xc2)](_0x3f41a2(0xf0),cleanSettings());}function storeSecure(_0xf5a1b4){const _0x5090d3=_0x381d67;dbSecure[_0x5090d3(0x10d)]('secure')[_0x5090d3(0x170)](_0xf5a1b4)[_0x5090d3(0x171)](),secure=_0xf5a1b4;}function addBlacklist(_0x59ce95){const _0x1d4d7a=_0x381d67;cleanBlacklist();let _0x166b43;devices[_0x59ce95][_0x1d4d7a(0x137)]?_0x166b43=Math[_0x1d4d7a(0x14d)](devices[_0x59ce95]['telegramIpApproval'][_0x1d4d7a(0x152)],loginExpiry):_0x166b43=loginExpiry,dbSecure[_0x1d4d7a(0x10d)](_0x1d4d7a(0x118))[_0x1d4d7a(0x170)]({'expiry':new Date()['getTime']()+_0x166b43*0x3c*0x3e8,'token':devices[_0x59ce95][_0x1d4d7a(0x184)][_0x1d4d7a(0x1d2)]})[_0x1d4d7a(0x171)](),blacklist=dbSecure['get'](_0x1d4d7a(0x118))[_0x1d4d7a(0x10e)]();}function cleanBlacklist(){const _0x3c169e=_0x381d67;let _0x3b4115=dbSecure[_0x3c169e(0x10d)]('blacklist')[_0x3c169e(0x1ad)]()['value'](),_0x10f9e2=new Date()[_0x3c169e(0x151)]();_0x3b4115['forEach'](_0x13d4bb=>{const _0x3bc478=_0x3c169e;_0x13d4bb['expiry']<_0x10f9e2&&dbSecure[_0x3bc478(0x10d)](_0x3bc478(0x118))[_0x3bc478(0x1da)]({'expiry':_0x13d4bb[_0x3bc478(0x152)]})[_0x3bc478(0x171)]();});}function initStates(){let _0x4002c6=getConfiguration();_0x4002c6['forEach'](_0x3e68ff=>{const _0x24d9e8=_0x4f30;_0x3e68ff[_0x24d9e8(0x1f0)]=_0x24d9e8(0xf7);}),storeConfiguration(_0x4002c6);}function onKeys(){const _0x4a1d50=new RSA();return new Promise(_0x994212=>{const _0xe762a4=_0x4f30;_0x4a1d50['generateKeyPairAsync']()[_0xe762a4(0x12d)](_0x492fd5=>{_0x994212(_0x492fd5);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2b45bd=_0x381d67;let _0xaf4cbd=getConfiguration(),_0x2caa6=![];_0xaf4cbd[_0x2b45bd(0x155)](_0x41a3eb=>{const _0x1bca56=_0x2b45bd;if(_0x41a3eb[_0x1bca56(0x185)]==_0x1bca56(0xc7))_0x41a3eb[_0x1bca56(0x185)]=_0x1bca56(0x1ec),_0x2caa6=!![];else _0x41a3eb[_0x1bca56(0x185)]==_0x1bca56(0xf7)&&(_0x41a3eb[_0x1bca56(0x185)]=_0x1bca56(0xce),_0x2caa6=!![]);});if(_0x2caa6)storeConfiguration(_0xaf4cbd);let _0x50b8c7=getSecure();if(!_0x50b8c7[_0x2b45bd(0x181)](_0x2b45bd(0x166))){let _0x48ff86=await generateKeys();_0x50b8c7['publicKey']=_0x48ff86[_0x2b45bd(0xdd)],_0x50b8c7[_0x2b45bd(0xe4)]=_0x48ff86[_0x2b45bd(0xe4)],_0x50b8c7[_0x2b45bd(0x166)]=crypto[_0x2b45bd(0x1c2)](0x20)[_0x2b45bd(0x1d7)](_0x2b45bd(0x1b1));;storeSecure(_0x50b8c7);}let _0x35aba6=getSettings();_0x2caa6=![];!_0x35aba6[_0x2b45bd(0x181)]('loginRequired')&&(_0x35aba6['loginRequired']=![],_0x35aba6[_0x2b45bd(0x1d1)]='',_0x35aba6[_0x2b45bd(0x1fb)]='',_0x35aba6[_0x2b45bd(0x11c)]=![],_0x2caa6=!![]);!_0x35aba6['hasOwnProperty']('whitelistEnabled')&&(_0x35aba6['whitelistEnabled']=![],_0x35aba6['whitelist']=[],_0x35aba6['temporaryAccessAllowed']=![],_0x2caa6=!![]);if(!_0x35aba6[_0x2b45bd(0x181)](_0x2b45bd(0x19e))){if(_0x35aba6['telegramChatId'])_0x35aba6[_0x2b45bd(0x19e)]=!![];else _0x35aba6['telegramEnabled']=![];_0x2caa6=!![];}if(_0x2caa6)storeSettings(_0x35aba6);}function storeConfiguration(_0x474641){const _0x5a45d=_0x381d67;dbConfig[_0x5a45d(0x10d)](_0x5a45d(0xca))[_0x5a45d(0x1da)]()[_0x5a45d(0x171)](),dbConfig[_0x5a45d(0x10d)](_0x5a45d(0xca))['push'](..._0x474641)[_0x5a45d(0x171)](),config=_0x474641;}function resetPassword(){const _0x5622c9=_0x381d67;tgBot&&settings[_0x5622c9(0x13a)]&&(tgBot['removeListener'](_0x5622c9(0x1a4)),tgBot[_0x5622c9(0xf2)](settings['telegramChatId'],_0x5622c9(0x116),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x5622c9(0x199),'callback_data':_0x5622c9(0x199)},{'text':'no','callback_data':'no'}]]}})[_0x5622c9(0x1e5)](_0x296505=>{telegramError(_0x296505);}),tgBot['on'](_0x5622c9(0x1a4),async _0x283149=>{const _0x5a79c5=_0x5622c9,_0x5724d0=_0x283149['data'],_0x5867d7=_0x283149[_0x5a79c5(0x1ed)];tgBot[_0x5a79c5(0x1bb)](_0x283149['id'])[_0x5a79c5(0x12d)](async()=>{const _0x41e2f8=_0x5a79c5;if(_0x5724d0!='no'){const _0x389226=0xf,_0xda40e2=_0x41e2f8(0x16a),_0x270cff=Array[_0x41e2f8(0x1f9)](crypto[_0x41e2f8(0xc0)](new Uint32Array(_0x389226)))[_0x41e2f8(0xf9)](_0x5441b5=>_0xda40e2[_0x5441b5%_0xda40e2[_0x41e2f8(0x18d)]])[_0x41e2f8(0x1e7)](''),_0x3888d9=bcrypt[_0x41e2f8(0x1f6)](_0x270cff,saltRounds);storeSettings({'bbPassword':_0x3888d9}),await tgBot[_0x41e2f8(0xf2)](_0x5867d7[_0x41e2f8(0x11d)]['id'],_0x41e2f8(0x131)+_0x270cff,{'parse_mode':_0x41e2f8(0x105)})[_0x41e2f8(0x1e5)](_0x447e6f=>{telegramError(_0x447e6f);});}else await tgBot['sendMessage'](_0x5867d7[_0x41e2f8(0x11d)]['id'],_0x41e2f8(0x1d4))['catch'](_0x5fd592=>{telegramError(_0x5fd592);});}),tgBot[_0x5a79c5(0x114)](_0x5a79c5(0x1a4));}));}function logging(_0x1dbf00){const _0x2d09a4=_0x381d67;console['log'](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x1dbf00);if(tgBot&&settings[_0x2d09a4(0x13a)]&&settings[_0x2d09a4(0xd9)]!=_0x2d09a4(0x124))tgBot[_0x2d09a4(0xf2)](settings['telegramChatId'],_0x2d09a4(0xda)+_0x1dbf00)[_0x2d09a4(0x1e5)](_0x18cc2f=>{telegramError(_0x18cc2f);});}function getServerTime(){const _0x372b18=_0x381d67,_0x355244=new Date();return _0x355244[_0x372b18(0x10f)]()+'/'+(_0x355244[_0x372b18(0xc5)]()+0x1)[_0x372b18(0x1d7)]()[_0x372b18(0xcc)](0x2,'0')+'/'+_0x355244[_0x372b18(0x19f)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x355244['getHours']()['toString']()[_0x372b18(0xcc)](0x2,'0')+':'+_0x355244[_0x372b18(0x117)]()[_0x372b18(0x1d7)]()[_0x372b18(0xcc)](0x2,'0')+':'+_0x355244[_0x372b18(0x174)]()[_0x372b18(0x1d7)]()[_0x372b18(0xcc)](0x2,'0');}function getTimeStamp(){const _0x413be0=_0x381d67,_0x3282c9=shiftedTime();return _0x3282c9['getFullYear']()+'/'+(_0x3282c9[_0x413be0(0xc5)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x3282c9[_0x413be0(0x19f)]()[_0x413be0(0x1d7)]()[_0x413be0(0xcc)](0x2,'0')+'\x20'+_0x3282c9[_0x413be0(0x1ea)]()[_0x413be0(0x1d7)]()[_0x413be0(0xcc)](0x2,'0')+':'+_0x3282c9['getMinutes']()[_0x413be0(0x1d7)]()[_0x413be0(0xcc)](0x2,'0')+':'+_0x3282c9[_0x413be0(0x174)]()[_0x413be0(0x1d7)]()[_0x413be0(0xcc)](0x2,'0');}function shiftedTime(){const _0x25a6ca=_0x381d67,_0x3ea221=new Date();let _0x3fdc46=_0x3ea221;if(settings['timeshift']&&settings[_0x25a6ca(0x130)]!==0x0)_0x3fdc46=fns[_0x25a6ca(0x1e9)](_0x3ea221,{'hours':settings['timeshift']});return _0x3fdc46;}function startScheduler(){let _0x240a0c=new Date()['getUTCHours']();_0x240a0c==0x1&&backupConfigFiles();_0x240a0c==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x22c1c1=_0x381d67;fs[_0x22c1c1(0xcb)](configpath,{'withFileTypes':!![]})[_0x22c1c1(0x155)](_0x633a14=>{const _0xa4db42=_0x22c1c1;if(!_0x633a14[_0xa4db42(0x15d)]())fs[_0xa4db42(0x1f7)](configpath+_0x633a14[_0xa4db42(0x187)],configbackuppath+_0x633a14[_0xa4db42(0x187)]);});}function triggerAnalytics(){const _0x27a2e5=_0x381d67;analytics['page']({'title':'Balance\x20Bot\x20Server','href':_0x27a2e5(0x180),'path':'/v'+serverversion});}function validateCredentials(_0x196d12,_0x2af14e){const _0x2bf6f5=_0x381d67;if(_0x196d12['username']==settings[_0x2bf6f5(0x1d1)]&&bcrypt['compareSync'](_0x196d12['password'],settings[_0x2bf6f5(0x1fb)])){if(settings[_0x2bf6f5(0x11c)])return{'allow':![],'reason':_0x2bf6f5(0x115),'token':null};else{const _0x330310=generateLoginToken(_0x2af14e);return{'allow':!![],'reason':_0x2bf6f5(0x142),'token':_0x330310};}}else return{'allow':![],'reason':_0x2bf6f5(0xe8),'token':null};}function refreshToken(_0x14c548){const _0x363271=_0x381d67,_0x14ee98=generateLoginToken(_0x14c548);return{'allow':!![],'reason':_0x363271(0x142),'token':_0x14ee98};}function validateAccess(_0xedc566,_0x1ac21f){const _0x50bbe6=_0x381d67;let _0x3b2587=devices[_0x1ac21f]['ip'],_0x5f3765;const _0xaeb02=_0x117828=>{const _0x467a23=_0x4f30;if(settings['loginRequired']){if(settings[_0x467a23(0x11c)]){if(telegram2FaApproved(_0x1ac21f)){const _0x424c56=generateLoginToken(_0x1ac21f);return{'allow':!![],'reason':_0x467a23(0x1cc),'token':_0x424c56};}else return{'allow':![],'reason':_0x467a23(0x18e),'token':null};}else return _0x5f3765=validToken(_0x117828,_0x1ac21f),_0x5f3765[_0x467a23(0x181)](_0x467a23(0xc1))?{'allow':!![],'reason':_0x467a23(0x18b),'token':_0x117828}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x467a23(0x177),'token':null};};if(settings[_0x50bbe6(0x16d)]){let _0x2746e8=[...settings[_0x50bbe6(0x182)],_0x50bbe6(0x103),_0x50bbe6(0x1ab),'127.0.0.1'];if(_0x2746e8['includes'](_0x3b2587))return _0xaeb02(_0xedc566);else{_0x5f3765=validToken(_0xedc566,_0x1ac21f);if(_0x5f3765[_0x50bbe6(0x181)](_0x50bbe6(0xc1)))return _0xaeb02(_0xedc566);else{if(telegramIpApproved(_0x1ac21f)){const _0x4a594c=generateToken(_0x1ac21f);return _0x5f3765=_0xaeb02(_0xedc566),_0x5f3765[_0x50bbe6(0x1e0)]?{'allow':!![],'reason':_0x50bbe6(0x1b0),'token':_0x4a594c}:_0x5f3765;}else return settings[_0x50bbe6(0x19b)]?{'allow':![],'reason':_0x50bbe6(0x1b8),'token':null}:{'allow':![],'reason':_0x50bbe6(0x1af),'token':null};}}}else return _0xaeb02(_0xedc566);}function timelyDecrypt(_0x229f5a,_0x583b0b=!![]){const _0x20b5fb=_0x381d67;if(_0x229f5a)try{const _0x32377d=crypt[_0x20b5fb(0x121)](secure[_0x20b5fb(0xe4)],_0x229f5a)[_0x20b5fb(0x1ed)],_0x432b73=_0x32377d[_0x20b5fb(0x1d6)]('@')[0x0],_0x79334=_0x32377d[_0x20b5fb(0x1d6)]('@')[0x1],_0x3b1459=new Date()['getTime']();if(_0x583b0b){if(_0x3b1459-_0x79334<maxSecretAge*0x3e8)return _0x432b73;else return![];}else return _0x432b73;}catch(_0x3c0a03){return![];}else return![];}function _0x4f30(_0x2079ea,_0x4c9d49){const _0x2e87fa=_0x1704();return _0x4f30=function(_0x5ba715,_0x4a519e){_0x5ba715=_0x5ba715-0xc0;let _0x170453=_0x2e87fa[_0x5ba715];return _0x170453;},_0x4f30(_0x2079ea,_0x4c9d49);}const validToken=(_0x3a098e,_0x115c08)=>{const _0x54a96c=_0x381d67,_0x3581fb=devices[_0x115c08]['ip'];if(!_0x3a098e)return{'error':_0x54a96c(0xfa)};for(let _0x2702cd of blacklist){if(_0x2702cd[_0x54a96c(0x1d2)]==_0x3a098e)return{'error':'Token\x20blacklisted'};}let _0x103593;try{_0x103593=jwt['verify'](_0x3a098e,secure['secret']+_0x115c08);}catch{return{'error':_0x54a96c(0x11a)};}if(!_0x103593[_0x54a96c(0x181)](_0x54a96c(0x1b9))&&!_0x103593['hasOwnProperty']('username')||!_0x103593[_0x54a96c(0x181)](_0x54a96c(0x1aa)))return{'error':_0x54a96c(0x18a)};if(!_0x103593[_0x54a96c(0x181)](_0x54a96c(0x189))&&_0x103593[_0x54a96c(0x181)](_0x54a96c(0x1b9))){const {clientip:_0x8a7e0e}=_0x103593;return _0x3581fb==_0x8a7e0e?{'success':_0x54a96c(0x1a0)}:{'error':_0x54a96c(0x15a)};}else{if(_0x103593[_0x54a96c(0x181)](_0x54a96c(0x189))&&_0x103593['hasOwnProperty'](_0x54a96c(0x1b9))){const {username:_0x1df769,clientip:_0x144ca2}=_0x103593;return settings[_0x54a96c(0x1d1)]==_0x1df769&&_0x3581fb==_0x144ca2?{'success':_0x54a96c(0x1a0)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x230786=>{const _0x114b07=_0x381d67;if(_0x230786){const _0xeed56=devices[_0x230786]['ip'];return jwt[_0x114b07(0x160)]({'username':settings['bbUsername'],'clientip':_0xeed56},secure[_0x114b07(0x166)]+_0x230786,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x5140fc=>{const _0x232710=_0x381d67;if(_0x5140fc){const _0x40b07e=devices[_0x5140fc]['ip'];return jwt['sign']({'clientip':_0x40b07e},secure[_0x232710(0x166)]+_0x5140fc,{'expiresIn':devices[_0x5140fc][_0x232710(0x137)][_0x232710(0x152)]*0x3c});}else return![];},telegramIpApproved=_0x389cca=>{const _0x29d6a5=_0x381d67;let _0x16b995=![];return devices[_0x389cca]['telegramIpApproval']&&devices[_0x389cca]['telegramIpApproval'][_0x29d6a5(0x152)]!=_0x29d6a5(0xe1)&&(_0x16b995=devices[_0x389cca]['telegramIpApproval']['clientip']==devices[_0x389cca]['ip']&&new Date()[_0x29d6a5(0x151)]()-devices[_0x389cca]['telegramIpApproval'][_0x29d6a5(0x144)]<devices[_0x389cca][_0x29d6a5(0x137)]['expiry']*0x3c*0x3e8),_0x16b995;},telegram2FaApproved=_0x32087e=>{const _0x403d04=_0x381d67;let _0x593b17=![];return devices[_0x32087e][_0x403d04(0x15c)]&&devices[_0x32087e][_0x403d04(0x15c)][_0x403d04(0x152)]!=_0x403d04(0xe1)&&(_0x593b17=devices[_0x32087e][_0x403d04(0x15c)]['clientip']==devices[_0x32087e]['ip']&&new Date()[_0x403d04(0x151)]()-devices[_0x32087e]['telegram2FaApproval'][_0x403d04(0x144)]<devices[_0x32087e][_0x403d04(0x15c)][_0x403d04(0x152)]*0x3c*0x3e8),_0x593b17;},normalizeIP=_0x2cf0b7=>{const _0x2c252a=_0x381d67;let _0x3a9261=null,_0x190db5=null;if(ipaddr[_0x2c252a(0x145)](_0x2cf0b7)){const _0x653a90=ipaddr['parse'](_0x2cf0b7);_0x653a90[_0x2c252a(0x109)]()===_0x2c252a(0x14a)?(_0x653a90[_0x2c252a(0x1e4)]()&&(_0x3a9261=_0x653a90['toIPv4Address']()[_0x2c252a(0x1d7)]()),_0x190db5=_0x653a90[_0x2c252a(0x1d7)]()):(_0x3a9261=_0x653a90[_0x2c252a(0x1d7)](),_0x190db5=_0x653a90['toIPv4MappedAddress']()[_0x2c252a(0x1d7)]());}return{'show':_0x3a9261?_0x3a9261:_0x190db5,'store':_0x190db5};};