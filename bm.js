const _0x2b0fc2=_0x2ca7;(function(_0x343b03,_0x21f5aa){const _0x4f10f1=_0x2ca7,_0x372bcf=_0x343b03();while(!![]){try{const _0x42248e=-parseInt(_0x4f10f1(0x220))/0x1*(-parseInt(_0x4f10f1(0x2cc))/0x2)+-parseInt(_0x4f10f1(0x3b8))/0x3*(parseInt(_0x4f10f1(0x229))/0x4)+parseInt(_0x4f10f1(0x376))/0x5+-parseInt(_0x4f10f1(0x2c7))/0x6*(parseInt(_0x4f10f1(0x37d))/0x7)+-parseInt(_0x4f10f1(0x310))/0x8*(-parseInt(_0x4f10f1(0x212))/0x9)+-parseInt(_0x4f10f1(0x33f))/0xa*(-parseInt(_0x4f10f1(0x1eb))/0xb)+-parseInt(_0x4f10f1(0x3ba))/0xc;if(_0x42248e===_0x21f5aa)break;else _0x372bcf['push'](_0x372bcf['shift']());}catch(_0x10c427){_0x372bcf['push'](_0x372bcf['shift']());}}}(_0x52e8,0x3c97c));const _0x2b7f81=function(){let _0x9233e0=!![];return function(_0x47d521,_0x2c6676){const _0x50e384=_0x9233e0?function(){const _0x48d679=_0x2ca7;if(_0x2c6676){const _0x58cece=_0x2c6676[_0x48d679(0x28f)](_0x47d521,arguments);return _0x2c6676=null,_0x58cece;}}:function(){};return _0x9233e0=![],_0x50e384;};}(),_0xd7ec0c=_0x2b7f81(this,function(){const _0x2c9afe=_0x2ca7;return _0xd7ec0c[_0x2c9afe(0x29e)]()[_0x2c9afe(0x29a)](_0x2c9afe(0x3a4))['toString']()[_0x2c9afe(0x1e2)](_0xd7ec0c)[_0x2c9afe(0x29a)](_0x2c9afe(0x3a4));});_0xd7ec0c();'use strict';process[_0x2b0fc2(0x305)][_0x2b0fc2(0x313)]=0x1;const childProcess=require(_0x2b0fc2(0x36e)),fs=require('fs'),fns=require(_0x2b0fc2(0x3a7)),low=require(_0x2b0fc2(0x1df)),FileSync=require(_0x2b0fc2(0x2b2)),path=require(_0x2b0fc2(0x27b)),crypto=require('crypto'),Crypt=require(_0x2b0fc2(0x245))[_0x2b0fc2(0x333)],RSA=require(_0x2b0fc2(0x245))['RSA'],bcrypt=require(_0x2b0fc2(0x227)),jwt=require(_0x2b0fc2(0x38e)),ipaddr=require('ipaddr.js'),argv=require(_0x2b0fc2(0x1ff))(process[_0x2b0fc2(0x22f)][_0x2b0fc2(0x34b)](0x2))[_0x2b0fc2(0x22f)],uuidRandom=require(_0x2b0fc2(0x2c8)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require('mixpanel'),axios=require(_0x2b0fc2(0x2dc)),{GraphQLClient,gql}=require(_0x2b0fc2(0x23b)),util=require('util'),fileUpload=require(_0x2b0fc2(0x389)),{networkInterfaces}=require('os'),PORT=argv[_0x2b0fc2(0x211)]||_0x2b0fc2(0x297),pattern=/^[0-9]{2,4}$/;!pattern[_0x2b0fc2(0x373)](PORT)&&(console[_0x2b0fc2(0x358)](_0x2b0fc2(0x301)+PORT+_0x2b0fc2(0x1fc)),process[_0x2b0fc2(0x228)](0x1));const HOST=argv[_0x2b0fc2(0x1e8)]||null,userID=argv[_0x2b0fc2(0x32b)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x2b0fc2(0x224)],environment=require('./version.json')[_0x2b0fc2(0x2eb)]||_0x2b0fc2(0x295);let bbpath=_0x2b0fc2(0x20f),bbpath2='';const botfile=_0x2b0fc2(0x293),configfile=_0x2b0fc2(0x29d),settingsfile=_0x2b0fc2(0x391),securefile='bb-secure.json',maxBackups=0xa;let validInstallation=!![];!fs[_0x2b0fc2(0x354)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x2b0fc2(0x22a)+userID+'/':bbpath+_0x2b0fc2(0x22a),configbackuppath=configpath+_0x2b0fc2(0x280),logspath=userID?bbpath+_0x2b0fc2(0x32c)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x2b0fc2(0x21f)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x2b0fc2(0x267)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x2b0fc2(0x3b5);!fs[_0x2b0fc2(0x354)](configpath)&&fs[_0x2b0fc2(0x240)](configpath);!fs[_0x2b0fc2(0x354)](configbackuppath)&&fs[_0x2b0fc2(0x240)](configbackuppath);!fs[_0x2b0fc2(0x354)](logspath)&&fs[_0x2b0fc2(0x240)](logspath);!fs[_0x2b0fc2(0x354)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x2b0fc2(0x354)](temppath)&&fs[_0x2b0fc2(0x240)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2b0fc2(0x244)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x2b0fc2(0x367),'onepagemode':![]}})[_0x2b0fc2(0x28d)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x2b0fc2(0x244)]({'secure':{},'blacklist':[]})[_0x2b0fc2(0x28d)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x2b0fc2(0x393)});const saltRounds=0xa,mixpanel=Mixpanel[_0x2b0fc2(0x25b)](_0x2b0fc2(0x2df),{'host':_0x2b0fc2(0x308)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x2b0fc2(0x261)]&&settings[_0x2b0fc2(0x261)]!=''&&settings[_0x2b0fc2(0x36b)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x4ac4ce,_0x12296f)=>{const _0x5ba60c=_0x2b0fc2,_0x2d9f90=/#[A-Z]{3}#/g;if(typeof _0x4ac4ce==_0x5ba60c(0x217)){!_0x12296f?_0x4ac4ce=_0x4ac4ce[_0x5ba60c(0x1ea)](_0x2d9f90,''):(_0x4ac4ce=_0x4ac4ce[_0x5ba60c(0x1ea)](/#BLU#/g,_0x5ba60c(0x323)),_0x4ac4ce=_0x4ac4ce[_0x5ba60c(0x1ea)](/#RED#/g,_0x5ba60c(0x221)),_0x4ac4ce=_0x4ac4ce[_0x5ba60c(0x1ea)](/#YEL#/g,_0x5ba60c(0x20e)),_0x4ac4ce=_0x4ac4ce[_0x5ba60c(0x1ea)](/#MAG#/g,_0x5ba60c(0x303)),_0x4ac4ce=_0x4ac4ce[_0x5ba60c(0x1ea)](/#CYA#/g,_0x5ba60c(0x369)),_0x4ac4ce=_0x4ac4ce[_0x5ba60c(0x1ea)](/#RES#/g,_0x5ba60c(0x255)));;}return _0x4ac4ce;},logger={'screen':_0x35f595=>{const _0x4497c9=_0x2b0fc2;console[_0x4497c9(0x358)](parseColor(_0x35f595,!![]));},'simple':_0x2b3108=>{const _0x331f06=_0x2b0fc2;console[_0x331f06(0x358)](parseColor(_0x2b3108,!![])),loggerfile[_0x331f06(0x28d)](util[_0x331f06(0x326)](parseColor(_0x2b3108,![]))+'\x0a');},'full':async _0x1f5dfa=>{const _0x5c9276=_0x2b0fc2,_0x19a23a=getTimeStamp()+_0x5c9276(0x3ae)+_0x1f5dfa;console['log'](parseColor(_0x19a23a,!![])),loggerfile[_0x5c9276(0x28d)](util[_0x5c9276(0x326)](parseColor(_0x19a23a,![]))+'\x0a');if(tgBot&&settings[_0x5c9276(0x392)]&&settings['telegramEvents']!=_0x5c9276(0x24d))await tgBot[_0x5c9276(0x345)](settings[_0x5c9276(0x392)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x1f5dfa,![]))[_0x5c9276(0x28b)](_0x2da2cc=>{telegramError(_0x2da2cc);});},'debug':async(_0x275e6c,_0x4e56c3='')=>{const _0x29e2b6=_0x2b0fc2,_0x1f7875=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x275e6c;if(debugging)console['log'](parseColor(_0x1f7875,!![]));loggerfile[_0x29e2b6(0x28d)](util[_0x29e2b6(0x326)](parseColor(_0x1f7875,![]))+'\x0a');if(_0x4e56c3){if(debugging)console[_0x29e2b6(0x358)](_0x4e56c3);loggerfile['write'](util[_0x29e2b6(0x326)](_0x4e56c3)+'\x0a');}}};process['on'](_0x2b0fc2(0x2f6),function(_0x3ba839){const _0x606762=_0x2b0fc2;logger[_0x606762(0x3a0)](_0x3ba839);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x2b0fc2(0x2d3))[_0x2b0fc2(0x33e)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x2b0fc2(0x2a0)),app=express(),http=require(_0x2b0fc2(0x2da))['createServer'](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x2b0fc2(0x210)](_0x2b0fc2(0x3bb),async(_0x1d95a8,_0xa49957)=>{const _0x5ae636=_0x2b0fc2,_0x33a3e0=_0x1d95a8['params'][_0x5ae636(0x294)],_0x4f416b=getClientsWithBotID(_0x5ae636(0x277)),_0x2d1a89=_0x1d95a8[_0x5ae636(0x28a)][_0x5ae636(0x263)],_0x4297d9=timelyDecrypt(_0x2d1a89,![]),_0x2b8485=_0x4f416b[_0x5ae636(0x1fa)](_0xe8b3ea=>_0xe8b3ea[_0x5ae636(0x263)]==_0x4297d9);if(_0x2b8485){const _0xaa9dec=normalizeIP(_0x1d95a8[_0x5ae636(0x288)][_0x5ae636(0x2f8)])['store'],_0x5df57e=_0x1d95a8[_0x5ae636(0x28a)][_0x5ae636(0x2c9)];if(validateAccess(_0x5df57e,_0x4297d9,_0xaa9dec)[_0x5ae636(0x2ae)])_0x33a3e0==_0x5ae636(0x222)&&await backupConfigFiles(),await zipFiles(_0x33a3e0),_0xa49957[_0x5ae636(0x2c1)](zippath+(_0x33a3e0+'.zip'),_0x3df464=>{const _0x1ab85a=_0x5ae636;_0x3df464&&(logger[_0x1ab85a(0x200)](_0x1ab85a(0x27c)+_0x33a3e0),logger[_0x1ab85a(0x3a0)](_0x3df464));});else logger[_0x5ae636(0x200)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x33a3e0+_0x5ae636(0x29f));}else logger[_0x5ae636(0x200)](_0x5ae636(0x2ee)+_0x33a3e0+_0x5ae636(0x247));}),app[_0x2b0fc2(0x27a)]('/upload-backup',async(_0x1df9d7,_0xc7a156)=>{const _0xa0405b=_0x2b0fc2,_0x40e442=getClientsWithBotID(_0xa0405b(0x277)),_0x41dac8=_0x1df9d7[_0xa0405b(0x28a)][_0xa0405b(0x263)],_0x4cfd9b=timelyDecrypt(_0x41dac8,![]),_0x1ecee=_0x40e442[_0xa0405b(0x1fa)](_0x36baeb=>_0x36baeb[_0xa0405b(0x263)]==_0x4cfd9b);logger[_0xa0405b(0x385)](_0xa0405b(0x22c));if(_0x1ecee){const _0x387928=normalizeIP(_0x1df9d7[_0xa0405b(0x288)]['remoteAddress'])[_0xa0405b(0x1f3)],_0x2db063=_0x1df9d7[_0xa0405b(0x28a)][_0xa0405b(0x2c9)];if(validateAccess(_0x2db063,_0x4cfd9b,_0x387928)[_0xa0405b(0x2ae)]){if(_0x1df9d7[_0xa0405b(0x1e3)]){const _0x8b8eb=_0x1df9d7[_0xa0405b(0x1e3)]['backupfile'];await _0x8b8eb['mv'](temppath+_0x8b8eb[_0xa0405b(0x27f)]),_0xc7a156[_0xa0405b(0x34c)]({'status':!![],'message':_0xa0405b(0x35a)});const _0x36a0df=getBotsWithMode();_0x36a0df['length']>0x0?confirmRestore(temppath,_0x8b8eb[_0xa0405b(0x27f)]):unzipFile(temppath,_0x8b8eb[_0xa0405b(0x27f)]);}}else logger[_0xa0405b(0x200)](_0xa0405b(0x275));}else logger[_0xa0405b(0x200)](_0xa0405b(0x27d));}),app['use'](express[_0x2b0fc2(0x1ef)](path[_0x2b0fc2(0x3bd)](__dirname,bbpath2,_0x2b0fc2(0x2f4)))),app[_0x2b0fc2(0x214)](express['static'](path[_0x2b0fc2(0x3bd)](__dirname,bbpath2,_0x2b0fc2(0x2d2)))),app[_0x2b0fc2(0x210)]('/',function(_0x1f8168,_0x38a1c3){const _0x15e15d=_0x2b0fc2;_0x38a1c3['sendFile'](path[_0x15e15d(0x3bd)](__dirname,bbpath2,_0x15e15d(0x2f4),'index.html'));}),app['get'](_0x2b0fc2(0x1e4),function(_0x10e6c0,_0x3e2f97){const _0x3bdbe7=_0x2b0fc2;_0x3e2f97[_0x3bdbe7(0x285)](path[_0x3bdbe7(0x3bd)](__dirname,bbpath2,_0x3bdbe7(0x2d2),_0x3bdbe7(0x38d)));}),app[_0x2b0fc2(0x210)]('/:bot/portfolio',(_0x33babd,_0x11443b)=>{const _0x404f6f=_0x2b0fc2;_0x11443b[_0x404f6f(0x285)](path[_0x404f6f(0x3bd)](__dirname,bbpath2,_0x404f6f(0x2d2),_0x404f6f(0x38d)));}),app[_0x2b0fc2(0x210)]('/:bot/performance',(_0x36278a,_0x20d9a4)=>{const _0x344582=_0x2b0fc2;_0x20d9a4[_0x344582(0x285)](path['join'](__dirname,bbpath2,_0x344582(0x2d2),_0x344582(0x38d)));}),app['get'](_0x2b0fc2(0x344),(_0x4ca024,_0x3f328b)=>{const _0x2c92f5=_0x2b0fc2;_0x3f328b[_0x2c92f5(0x285)](path[_0x2c92f5(0x3bd)](__dirname,bbpath2,_0x2c92f5(0x2d2),_0x2c92f5(0x38d)));}),app[_0x2b0fc2(0x210)](_0x2b0fc2(0x21e),(_0x5bdb46,_0x1d1131)=>{const _0x5b51ba=_0x2b0fc2;_0x1d1131['sendFile'](path['join'](__dirname,bbpath2,_0x5b51ba(0x2d2),'index.html'));}),app[_0x2b0fc2(0x210)]('/:bot/configuration',(_0x2b82c1,_0x74c092)=>{const _0x2ab7ad=_0x2b0fc2;_0x74c092['sendFile'](path['join'](__dirname,bbpath2,_0x2ab7ad(0x2d2),_0x2ab7ad(0x38d)));}),app['get'](_0x2b0fc2(0x374),(_0x2eae88,_0x4ddbd1)=>{const _0x3181e9=_0x2b0fc2;_0x4ddbd1['sendFile'](path[_0x3181e9(0x3bd)](__dirname,bbpath2,'build',_0x3181e9(0x38d)));});if(HOST)http[_0x2b0fc2(0x2ad)](PORT,HOST);else http['listen'](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x48982c=_0x2b0fc2;let _0x12298f=_0x48982c(0x3b2);const _0x18e3e0=networkInterfaces(),_0x426e0b={};for(const _0x501c84 of Object[_0x48982c(0x26e)](_0x18e3e0)){for(const _0x21c6a2 of _0x18e3e0[_0x501c84]){if((_0x21c6a2[_0x48982c(0x335)]==_0x48982c(0x2e9)||_0x21c6a2[_0x48982c(0x335)]==0x4)&&!_0x21c6a2[_0x48982c(0x1e7)]){const _0xfc7acc=ipaddr[_0x48982c(0x230)](_0x21c6a2[_0x48982c(0x399)])[_0x48982c(0x32d)]();_0xfc7acc!='private'&&(!_0x426e0b[_0x501c84]&&(_0x426e0b[_0x501c84]=[]),_0x426e0b[_0x501c84]['push'](_0x21c6a2['address']),_0x12298f=_0x21c6a2[_0x48982c(0x399)]);}}}return{'serverip':_0x12298f,'netinterfaces':_0x426e0b};}async function startServer(){const _0x1fc8df=_0x2b0fc2,{serverip:_0xd761db,netinterfaces:_0x36dc20}=getServerIP();logger[_0x1fc8df(0x3a0)](''),logger[_0x1fc8df(0x3a0)](_0x1fc8df(0x361)),await logger[_0x1fc8df(0x200)](_0x1fc8df(0x28e)+serverversion+_0x1fc8df(0x278)+(environment==_0x1fc8df(0x269)?_0x1fc8df(0x2e6):'')+'\x0a'+(_0x1fc8df(0x2bf)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+('=>\x20Go\x20to\x20#CYA#http://'+_0xd761db+':'+PORT+_0x1fc8df(0x268))),logger['simple'](_0x1fc8df(0x361));if(config[_0x1fc8df(0x2d7)]!=0x0)for(const _0x23c7b1 of config){if(_0x23c7b1[_0x1fc8df(0x218)]=='enabled'||_0x23c7b1[_0x1fc8df(0x218)]==_0x1fc8df(0x33b))await logger[_0x1fc8df(0x200)](_0x1fc8df(0x1f7)+_0x23c7b1[_0x1fc8df(0x2a3)]+'\x20|\x20'+_0x23c7b1[_0x1fc8df(0x2d5)]),startBot([_0x23c7b1['botID'],userID],{'cwd':bbpath},function(_0x13d52b){const _0x59ae6f=_0x1fc8df;if(_0x13d52b)logger[_0x59ae6f(0x200)](_0x13d52b);});else(_0x23c7b1[_0x1fc8df(0x218)]==_0x1fc8df(0x340)||_0x23c7b1[_0x1fc8df(0x218)]==_0x1fc8df(0x2b6))&&await logger['full']('Idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x23c7b1['botID']+_0x1fc8df(0x338)+_0x23c7b1['botname']);}else!newBot&&logger[_0x1fc8df(0x3a0)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x1fc8df(0x3a0)](_0x1fc8df(0x361)),logger['simple'](''),await logger[_0x1fc8df(0x385)]('Node.js\x20v'+nodeversion),await logger[_0x1fc8df(0x385)](_0x1fc8df(0x2a4),_0x36dc20);}function startSocket(){const _0x17254c=_0x2b0fc2;io['on'](_0x17254c(0x346),_0x541bf4=>{const _0x2264ab=_0x17254c;let _0x26e936,_0x55ed32,_0x18eb81,_0x1dcfa4,_0x1eb8cc;const _0x298878=_0x541bf4['handshake'][_0x2264ab(0x28a)][_0x2264ab(0x327)];_0x55ed32=_0x298878[_0x2264ab(0x36f)](/bot[0-9]{3}/);if(_0x55ed32)_0x18eb81=_0x55ed32[0x0][_0x2264ab(0x36f)](/[0-9]{3}/);if(_0x18eb81)_0x26e936=_0x18eb81[0x0];else _0x26e936=_0x2264ab(0x277);const _0x4296f3=_0x541bf4[_0x2264ab(0x22e)]['auth']['encryptedUuid'];if(!_0x4296f3)_0x541bf4[_0x2264ab(0x31d)](_0x2264ab(0x218),{'publicKey':secure['publicKey']});else{_0x1dcfa4=timelyDecrypt(_0x4296f3,![]);if(!_0x1dcfa4)_0x541bf4[_0x2264ab(0x31d)](_0x2264ab(0x218),{'publicKey':secure[_0x2264ab(0x292)]});else{_0x1eb8cc=normalizeIP(_0x541bf4['conn'][_0x2264ab(0x2f8)])[_0x2264ab(0x1f3)];if(!devices[_0x1dcfa4])devices[_0x1dcfa4]={'uuid':_0x1dcfa4,'access':{'token':null}};devices[_0x1dcfa4]['ip']=_0x1eb8cc;const _0x4fcd7e=addClient(_0x541bf4['id'],_0x1dcfa4,_0x26e936);setAccess(_0x4fcd7e),emitMessages(),_0x541bf4['on'](_0x2264ab(0x37f),_0x3f7f00=>{const _0x255814=_0x2264ab,_0x542962=timelyDecrypt(_0x3f7f00[_0x255814(0x1fd)]);if(_0x542962){_0x3f7f00={'username':_0x3f7f00['username'],'password':_0x542962},devices[_0x1dcfa4][_0x255814(0x233)]=validateCredentials(_0x3f7f00,_0x1dcfa4);if(devices[_0x1dcfa4][_0x255814(0x233)][_0x255814(0x2ae)]==![]&&devices[_0x1dcfa4][_0x255814(0x233)][_0x255814(0x34a)]==_0x255814(0x3ac))_0x541bf4[_0x255814(0x31d)](_0x255814(0x218),{'access':devices[_0x1dcfa4][_0x255814(0x233)]}),loginAccess2FA(_0x1dcfa4,_0x1eb8cc);else{if(devices[_0x1dcfa4]['access'][_0x255814(0x2ae)]==![]&&devices[_0x1dcfa4][_0x255814(0x233)]['reason']=='invalid\x20credentials')_0x541bf4[_0x255814(0x31d)]('status',{'access':devices[_0x1dcfa4][_0x255814(0x233)]});else devices[_0x1dcfa4][_0x255814(0x233)][_0x255814(0x2ae)]&&devices[_0x1dcfa4][_0x255814(0x233)][_0x255814(0x34a)]==_0x255814(0x364)&&(getClientsWithUuid(_0x1dcfa4)[_0x255814(0x387)](_0xebb61f=>{setAccess(_0xebb61f);}),logger['debug'](_0x255814(0x2c0)+_0x1dcfa4['slice'](-0x8)),setTokenRefresh(_0x1dcfa4),setSessionTimeout('login',_0x1dcfa4));}}else logger[_0x255814(0x200)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x541bf4['on'](_0x2264ab(0x2f7),()=>{resetPassword();}),_0x541bf4['on'](_0x2264ab(0x2ca),_0x3bcae3=>{removeClient(_0x541bf4['id']);}),_0x26e936==_0x2264ab(0x277)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x30ba43){const _0x2bbf92=_0x2b0fc2;if(_0x30ba43!='botmanager'&&config[_0x2bbf92(0x296)]!=''){if(pid[_0x30ba43])pid[_0x30ba43][_0x2bbf92(0x34c)]({'function':_0x2bbf92(0x351),'args':null});}_0x30ba43!='botmanager'&&broadcastToBots(_0x2bbf92(0x2a1),JSON[_0x2bbf92(0x317)](config));}function reloadBotManager(){const _0xde8e56=_0x2b0fc2;getClientsWithBotID(_0xde8e56(0x277))[_0xde8e56(0x387)](_0x47fd72=>{const _0x388d0b=_0xde8e56;getSocket(_0x47fd72['id'])[_0x388d0b(0x31d)](_0x388d0b(0x218),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x45d15c){const _0x55fa7e=_0x2b0fc2;return io[_0x55fa7e(0x31b)][_0x55fa7e(0x31b)][_0x55fa7e(0x210)](_0x45d15c);}function setAccess(_0x132025){const _0x56ca8f=_0x2b0fc2,_0x15a7e2=getSocket(_0x132025['id']),_0x37169e=_0x132025['uuid'],_0x4d8297=_0x132025[_0x56ca8f(0x256)];devices[_0x37169e][_0x56ca8f(0x233)]=validateAccess(devices[_0x37169e][_0x56ca8f(0x233)][_0x56ca8f(0x29c)],_0x37169e),logger['debug'](_0x56ca8f(0x353)+devices[_0x37169e]['access'][_0x56ca8f(0x34a)]+_0x56ca8f(0x38c)+_0x132025['id'][_0x56ca8f(0x34b)](-0x8)+'\x20|\x20user:\x20...'+_0x37169e[_0x56ca8f(0x34b)](-0x8)),_0x15a7e2[_0x56ca8f(0x3bd)](_0x37169e);if(devices[_0x37169e][_0x56ca8f(0x233)][_0x56ca8f(0x2ae)]){_0x15a7e2['join'](_0x4d8297);if(_0x4d8297==_0x56ca8f(0x277))initializeSocketBotManager(_0x15a7e2);else initializeSocketBot(_0x15a7e2);initClient(_0x4d8297);}devices[_0x37169e]['access'][_0x56ca8f(0x29c)]&&devices[_0x37169e][_0x56ca8f(0x233)][_0x56ca8f(0x34a)]==_0x56ca8f(0x306)&&setSessionTimeout(_0x56ca8f(0x2ea),_0x37169e),devices[_0x37169e][_0x56ca8f(0x233)]['token']&&devices[_0x37169e][_0x56ca8f(0x233)][_0x56ca8f(0x34a)]==_0x56ca8f(0x2aa)&&setSessionTimeout(_0x56ca8f(0x37f),_0x37169e),_0x15a7e2['emit'](_0x56ca8f(0x218),{'status':_0x132025[_0x56ca8f(0x2a9)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x37169e][_0x56ca8f(0x233)],'externalip':devices[_0x37169e]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x56ca8f(0x20a)],'validInstallation':validInstallation}),devices[_0x37169e][_0x56ca8f(0x233)][_0x56ca8f(0x2ae)]==![]&&devices[_0x37169e][_0x56ca8f(0x233)][_0x56ca8f(0x34a)]=='2FA\x20required'&&temporaryAccess2FA(_0x37169e,devices[_0x37169e]['ip']);}function setSessionTimeout(_0x29f37e,_0x50e239){const _0x102fa5=_0x2b0fc2;let _0x296324;if(_0x29f37e==_0x102fa5(0x37f))_0x296324=loginExpiry*0x3c*0x3e8;else _0x296324=devices[_0x50e239]['telegramIpApproval']['expiry']*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x50e239][_0x102fa5(0x319)][_0x102fa5(0x24c)]);if(devices[_0x50e239][_0x102fa5(0x356)])clearTimeout(devices[_0x50e239]['pidExpireLogin']);devices[_0x50e239]['pidExpireLogin']=setTimeout(()=>{const _0xa5bbde=_0x102fa5;if(devices[_0x50e239][_0xa5bbde(0x2f9)])clearTimeout(devices[_0x50e239][_0xa5bbde(0x2f9)]);removeSocketListeners(_0x50e239),addBlacklist(_0x50e239),devices[_0x50e239][_0xa5bbde(0x319)]=null,devices[_0x50e239]['telegram2FaApproval']=null,devices[_0x50e239][_0xa5bbde(0x233)]['token']=null,logger[_0xa5bbde(0x385)](_0xa5bbde(0x241)+_0x50e239[_0xa5bbde(0x34b)](-0x8)),devices[_0x50e239][_0xa5bbde(0x233)]=validateAccess(devices[_0x50e239][_0xa5bbde(0x233)][_0xa5bbde(0x29c)],_0x50e239),!(devices[_0x50e239]['access'][_0xa5bbde(0x2ae)]&&devices[_0x50e239][_0xa5bbde(0x233)]['reason']==_0xa5bbde(0x2b5))&&(_0x29f37e==_0xa5bbde(0x37f)?io['to'](_0x50e239)[_0xa5bbde(0x31d)]('status',{'access':{'allow':![],'reason':_0xa5bbde(0x25d),'token':null}}):io['to'](_0x50e239)['emit'](_0xa5bbde(0x218),{'access':{'allow':![],'reason':_0xa5bbde(0x2e8),'token':null}})),devices[_0x50e239][_0xa5bbde(0x233)][_0xa5bbde(0x29c)]=null;},_0x296324);}function setTokenRefresh(_0x251c35){const _0x2a5457=_0x2b0fc2;if(devices[_0x251c35][_0x2a5457(0x2f9)])clearTimeout(devices[_0x251c35][_0x2a5457(0x2f9)]);devices[_0x251c35][_0x2a5457(0x2f9)]=setTimeout(()=>{const _0x4ff458=_0x2a5457;getClientsWithUuid(_0x251c35)[_0x4ff458(0x2d7)]!=0x0?(devices[_0x251c35][_0x4ff458(0x233)]=refreshToken(_0x251c35),io['to'](_0x251c35)['emit']('status',{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x251c35][_0x4ff458(0x233)],'externalip':devices[_0x251c35]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x251c35)):clearTimeout(devices[_0x251c35][_0x4ff458(0x2f9)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3b24fa){const _0x4aba9f=_0x2b0fc2,_0x52dba7=getClient(_0x3b24fa['id'])[_0x4aba9f(0x263)];_0x3b24fa['emit'](_0x4aba9f(0x2a1),config),_0x3b24fa['emit'](_0x4aba9f(0x1f1),cleanSettings()),_0x3b24fa['on'](_0x4aba9f(0x31e),_0x4e6727=>{const _0x2073e7=_0x4aba9f;if(validateAccess(_0x4e6727,_0x52dba7)[_0x2073e7(0x2ae)])addBot();else logger[_0x2073e7(0x200)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x3b24fa['on'](_0x4aba9f(0x37b),(_0x429523,_0x45068d)=>{const _0xc9d6ee=_0x4aba9f;if(validateAccess(_0x45068d,_0x52dba7)['allow'])toggleBot(_0x429523['botID'],_0x429523[_0xc9d6ee(0x218)],_0x429523[_0xc9d6ee(0x23a)]);else logger[_0xc9d6ee(0x200)](_0xc9d6ee(0x22b));}),_0x3b24fa['on'](_0x4aba9f(0x1f9),(_0xdfb20,_0x12d003)=>{const _0x8d8bb9=_0x4aba9f;if(validateAccess(_0x12d003,_0x52dba7)[_0x8d8bb9(0x2ae)])toggleBotMode(_0xdfb20);else logger[_0x8d8bb9(0x200)](_0x8d8bb9(0x22b));}),_0x3b24fa['on'](_0x4aba9f(0x242),(_0xb35085,_0x11589a)=>{const _0x2e1dd4=_0x4aba9f;if(validateAccess(_0x11589a,_0x52dba7)['allow'])deleteBot(_0xb35085);else logger[_0x2e1dd4(0x200)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x3b24fa['on']('store-settings',(_0x2f5dc0,_0x2d7e3a)=>{const _0xbf099f=_0x4aba9f;if(validateAccess(_0x2d7e3a,_0x52dba7)['allow'])storeSettings(_0x2f5dc0,!![]);else logger[_0xbf099f(0x200)](_0xbf099f(0x34d));}),_0x3b24fa['on'](_0x4aba9f(0x3a3),_0x31d01a=>{const _0x3b4322=_0x4aba9f;if(validateAccess(_0x31d01a,_0x52dba7)['allow'])updateBB(_0x3b4322(0x33d));else logger['full'](_0x3b4322(0x30c));}),_0x3b24fa['on']('reinstall-bb',_0xd8d95c=>{const _0x289596=_0x4aba9f;if(validateAccess(_0xd8d95c,_0x52dba7)['allow'])updateBB('reinstall');else logger[_0x289596(0x200)](_0x289596(0x337));}),_0x3b24fa['on'](_0x4aba9f(0x398),_0x42f4c1=>{const _0x438920=_0x4aba9f;if(validateAccess(_0x42f4c1,_0x52dba7)[_0x438920(0x2ae)]){const _0x7d74ef=getClient(_0x3b24fa['id']);if(_0x7d74ef)getBackupFiles(_0x7d74ef['uuid']);else logger['full']('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x438920(0x200)](_0x438920(0x390));}),_0x3b24fa['on'](_0x4aba9f(0x32f),(_0x39c0ba,_0x4dea54)=>{const _0x26d7b3=_0x4aba9f;if(validateAccess(_0x4dea54,_0x52dba7)[_0x26d7b3(0x2ae)])restoreBackupFile(_0x39c0ba);else logger[_0x26d7b3(0x200)](_0x26d7b3(0x264));}),_0x3b24fa['on']('get-messages',_0x42c2da=>{const _0x88db57=_0x4aba9f;if(validateAccess(_0x42c2da,_0x52dba7)[_0x88db57(0x2ae)])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x3b24fa['on'](_0x4aba9f(0x3aa),(_0x2dac29,_0x497602)=>{const _0x379aae=_0x4aba9f;if(validateAccess(_0x497602,_0x52dba7)[_0x379aae(0x2ae)])confirmMessage(_0x2dac29);else logger[_0x379aae(0x200)](_0x379aae(0x276));}),_0x3b24fa['on']('logout',_0x19d26c=>{const _0xb9e1e7=_0x4aba9f;if(validateAccess(_0x19d26c,_0x52dba7)['allow']){if(devices[_0x52dba7][_0xb9e1e7(0x2f9)])clearTimeout(devices[_0x52dba7][_0xb9e1e7(0x2f9)]);if(devices[_0x52dba7][_0xb9e1e7(0x356)])clearTimeout(devices[_0x52dba7][_0xb9e1e7(0x356)]);removeSocketListeners(getClient(_0x3b24fa['id'])[_0xb9e1e7(0x263)]),addBlacklist(_0x52dba7),devices[_0x52dba7][_0xb9e1e7(0x319)]=null,devices[_0x52dba7][_0xb9e1e7(0x3a2)]=null,devices[_0x52dba7][_0xb9e1e7(0x233)][_0xb9e1e7(0x29c)]=null,logger['debug'](_0xb9e1e7(0x3b1)+_0x52dba7['slice'](-0x8)),io['to'](getClient(_0x3b24fa['id'])[_0xb9e1e7(0x263)])[_0xb9e1e7(0x31d)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x49a42c){const _0x7bad77=_0x2b0fc2,_0x1d744e=getClient(_0x49a42c['id'])['bot'],_0x218df0=getClient(_0x49a42c['id'])[_0x7bad77(0x263)];_0x49a42c['on'](_0x7bad77(0x379),(_0xc395fb,_0x4b6b8)=>{const _0x43385d=_0x7bad77;if(validateAccess(_0x4b6b8,_0x218df0)[_0x43385d(0x2ae)]){if(pid[_0x1d744e])pid[_0x1d744e]['send']({'function':'emitHistory','args':_0xc395fb});}else logger['full'](_0x43385d(0x322));}),_0x49a42c['on']('delete-alerts',(_0xb7006a,_0x44a2fb)=>{const _0x3301bb=_0x7bad77;if(validateAccess(_0x44a2fb,_0x218df0)[_0x3301bb(0x2ae)]){if(pid[_0x1d744e])pid[_0x1d744e][_0x3301bb(0x34c)]({'function':_0x3301bb(0x35c),'args':_0xb7006a});}else logger['full'](_0x3301bb(0x3a1));}),_0x49a42c['on']('get-portfolio',(_0x1500eb,_0x1d8d87)=>{const _0x16a466=_0x7bad77;if(validateAccess(_0x1d8d87,_0x218df0)['allow']){if(pid[_0x1d744e])pid[_0x1d744e]['send']({'function':_0x16a466(0x348),'args':_0x1500eb});}else logger[_0x16a466(0x200)](_0x16a466(0x2d0));}),_0x49a42c['on']('store-configuration',(_0x1ab342,_0x1797e6)=>{const _0x3a6246=_0x7bad77;if(validateAccess(_0x1797e6,_0x218df0)['allow']){if(pid[_0x1d744e])pid[_0x1d744e][_0x3a6246(0x34c)]({'function':_0x3a6246(0x208),'args':_0x1ab342});}else logger[_0x3a6246(0x200)](_0x3a6246(0x2ce));}),_0x49a42c['on']('store-headless',(_0x200647,_0x2870e8)=>{const _0x4761c3=_0x7bad77;if(validateAccess(_0x2870e8,_0x218df0)[_0x4761c3(0x2ae)]){if(pid[_0x1d744e])pid[_0x1d744e][_0x4761c3(0x34c)]({'function':_0x4761c3(0x2ec),'args':_0x200647});}else logger[_0x4761c3(0x200)](_0x4761c3(0x2c3));}),_0x49a42c['on'](_0x7bad77(0x2cb),(_0xc778ed,_0x24b972)=>{const _0x2f5f8f=_0x7bad77;if(validateAccess(_0x24b972,_0x218df0)[_0x2f5f8f(0x2ae)]){if(pid[_0x1d744e])pid[_0x1d744e][_0x2f5f8f(0x34c)]({'function':_0x2f5f8f(0x23f),'args':_0xc778ed});}else logger['full'](_0x2f5f8f(0x34e));}),_0x49a42c['on'](_0x7bad77(0x2f2),_0x4e4631=>{const _0x50c8fb=_0x7bad77;if(validateAccess(_0x4e4631,_0x218df0)[_0x50c8fb(0x2ae)]){if(pid[_0x1d744e])pid[_0x1d744e]['send']({'function':_0x50c8fb(0x3a5),'args':null});}else logger[_0x50c8fb(0x200)](_0x50c8fb(0x352));}),_0x49a42c['on'](_0x7bad77(0x26b),_0x8e041f=>{const _0x57534f=_0x7bad77;if(validateAccess(_0x8e041f,_0x218df0)[_0x57534f(0x2ae)]){if(pid[_0x1d744e])pid[_0x1d744e][_0x57534f(0x34c)]({'function':_0x57534f(0x39a),'args':null});}else logger['full'](_0x57534f(0x237));}),_0x49a42c['on'](_0x7bad77(0x2fa),(_0x329c5f,_0x45d0c3)=>{const _0x16dbd7=_0x7bad77;if(validateAccess(_0x45d0c3,_0x218df0)[_0x16dbd7(0x2ae)]){if(pid[_0x1d744e])pid[_0x1d744e][_0x16dbd7(0x34c)]({'function':_0x16dbd7(0x2ba),'args':_0x329c5f});}else logger['full'](_0x16dbd7(0x359));}),_0x49a42c['on'](_0x7bad77(0x38f),_0x45177b=>{const _0x5a5d5d=_0x7bad77;if(validateAccess(_0x45177b,_0x218df0)[_0x5a5d5d(0x2ae)]){if(pid[_0x1d744e])pid[_0x1d744e][_0x5a5d5d(0x34c)]({'function':_0x5a5d5d(0x2e2),'args':null});}else logger[_0x5a5d5d(0x200)](_0x5a5d5d(0x332));}),_0x49a42c['on'](_0x7bad77(0x2a5),_0x231bdd=>{const _0x32b42b=_0x7bad77;if(validateAccess(_0x231bdd,_0x218df0)[_0x32b42b(0x2ae)]){if(pid[_0x1d744e])pid[_0x1d744e]['send']({'function':'showConfig','args':null});}else logger[_0x32b42b(0x200)](_0x32b42b(0x2fe));}),_0x49a42c['on']('update-bb',_0x41d1be=>{const _0x70da24=_0x7bad77;if(validateAccess(_0x41d1be,_0x218df0)[_0x70da24(0x2ae)])updateBB('update');else logger[_0x70da24(0x200)](_0x70da24(0x30c));}),_0x49a42c['on'](_0x7bad77(0x2b0),_0x3465f5=>{const _0xb83da1=_0x7bad77;if(validateAccess(_0x3465f5,_0x218df0)[_0xb83da1(0x2ae)])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x49a42c['on'](_0x7bad77(0x3aa),(_0xfaf715,_0x192607)=>{const _0x223a08=_0x7bad77;if(validateAccess(_0x192607,_0x218df0)[_0x223a08(0x2ae)])confirmMessage(_0xfaf715);else logger[_0x223a08(0x200)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x49a42c['on'](_0x7bad77(0x2a6),_0x3a8a69=>{const _0x2aabd9=_0x7bad77;if(validateAccess(_0x3a8a69,_0x218df0)['allow']){if(devices[_0x218df0][_0x2aabd9(0x2f9)])clearTimeout(devices[_0x218df0]['pidRefreshToken']);if(devices[_0x218df0][_0x2aabd9(0x356)])clearTimeout(devices[_0x218df0][_0x2aabd9(0x356)]);removeSocketListeners(getClient(_0x49a42c['id'])[_0x2aabd9(0x263)]),addBlacklist(_0x218df0),devices[_0x218df0][_0x2aabd9(0x319)]=null,devices[_0x218df0][_0x2aabd9(0x3a2)]=null,devices[_0x218df0][_0x2aabd9(0x233)][_0x2aabd9(0x29c)]=null,logger[_0x2aabd9(0x385)](_0x2aabd9(0x3b1)+_0x218df0['slice'](-0x8)),io['to'](getClient(_0x49a42c['id'])[_0x2aabd9(0x263)])[_0x2aabd9(0x31d)](_0x2aabd9(0x218),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x4a6979){const _0x42c212=_0x2b0fc2;getClientsWithUuid(_0x4a6979)[_0x42c212(0x387)](_0x56fdfb=>{getSocket(_0x56fdfb['id'])['removeAllListeners']();});}function cleanSettings(){const _0x5e0083=_0x2b0fc2;let _0x317db4=settings;return settings['telegramToken']&&settings['telegramToken']!=''&&(_0x317db4={..._0x317db4,'telegramToken':_0x5e0083(0x289)}),settings[_0x5e0083(0x397)]&&settings['bbPassword']!=''&&(_0x317db4={..._0x317db4,'bbPassword':_0x5e0083(0x289)}),(settings['bbPassword']&&settings[_0x5e0083(0x397)]=='***'||settings[_0x5e0083(0x261)]&&settings['telegramToken']=='***')&&(_0x317db4={..._0x317db4,'restored':{'password':settings[_0x5e0083(0x397)]==_0x5e0083(0x266),'telegram':settings[_0x5e0083(0x261)]==_0x5e0083(0x266)}}),_0x317db4;}async function updateBB(_0x2020ea){const _0xc09056=_0x2b0fc2;await backupConfigFiles(),installingUpdate=!![],config[_0xc09056(0x387)](_0x52f757=>{const _0x1e3118=_0xc09056;restartBot(_0x52f757[_0x1e3118(0x2a3)]);});if(_0x2020ea==_0xc09056(0x33d))process[_0xc09056(0x34c)]({'update':!![],'environment':environment},_0x475a59=>{});else _0x2020ea==_0xc09056(0x3af)&&process['send']({'reinstall':!![],'environment':environment},_0x143fc8=>{});}function startBot(_0x1a014e,_0x5d21d2,_0x2e18db){const _0x17f076=_0x2b0fc2;if(debugging)_0x1a014e[_0x17f076(0x31f)]('-d');let _0x1aa169=![];const _0x43e6e7=_0x1a014e[0x0];_0x5d21d2={..._0x5d21d2,'stdio':['inherit',_0x17f076(0x1de),_0x17f076(0x1de),_0x17f076(0x21b)]},pid[_0x43e6e7]=childProcess['fork'](botfile,_0x1a014e,_0x5d21d2),pid[_0x43e6e7]['on'](_0x17f076(0x2ac),_0x58f25d=>{const _0x29b3e0=_0x17f076;switch(Object[_0x29b3e0(0x26e)](_0x58f25d)[0x0]){case _0x29b3e0(0x2d5):updateBotName(_0x43e6e7,_0x58f25d[_0x29b3e0(0x2d5)]);break;case _0x29b3e0(0x30b):updateBotManager();break;case _0x29b3e0(0x218):updateStatus(_0x43e6e7,_0x58f25d[_0x29b3e0(0x218)]);break;case _0x29b3e0(0x23a):updateLive(_0x43e6e7,_0x58f25d[_0x29b3e0(0x23a)]);break;case'started':updateLive(_0x43e6e7,_0x58f25d[_0x29b3e0(0x1e5)]),io['to'](_0x43e6e7)[_0x29b3e0(0x31d)]('status',{'access':{'allow':![],'reason':_0x29b3e0(0x357),'token':null}});break;case _0x29b3e0(0x26f):_0x58f25d['stop']==_0x29b3e0(0x2bd)&&restartBot(_0x43e6e7);_0x58f25d['stop']==_0x29b3e0(0x372)&&toggleBot(_0x43e6e7,_0x29b3e0(0x340),_0x29b3e0(0x236));break;case _0x29b3e0(0x284):sendTelegram(_0x43e6e7,_0x58f25d[_0x29b3e0(0x284)]);break;case _0x29b3e0(0x35e):sendTelegramMsg(_0x58f25d[_0x29b3e0(0x35e)]);break;case _0x29b3e0(0x331):io['to'](_0x43e6e7)['emit'](_0x58f25d[_0x29b3e0(0x331)],_0x58f25d[_0x29b3e0(0x265)]);break;}}),pid[_0x43e6e7]['on']('error',function(_0x3dbb7d){if(_0x1aa169)return;_0x1aa169=!![],_0x2e18db(_0x3dbb7d);}),pid[_0x43e6e7]['on'](_0x17f076(0x228),async function(_0x219a4b){const _0x35a7c3=_0x17f076;if(installingUpdate)return;if(_0x1aa169)return;_0x1aa169=!![],_0x2e18db(null);const _0x241c20=dbConfig[_0x35a7c3(0x210)](_0x35a7c3(0x2a1))[_0x35a7c3(0x1fa)]({'botID':_0x43e6e7})[_0x35a7c3(0x213)]();_0x241c20&&(_0x241c20['status']==_0x35a7c3(0x23c)||_0x241c20[_0x35a7c3(0x218)]==_0x35a7c3(0x33b))&&(await sleep(0x3e8),updateLive(_0x43e6e7,_0x35a7c3(0x236)),logger['full'](_0x35a7c3(0x2de)+_0x43e6e7),startBot([_0x43e6e7,userID],{'cwd':bbpath},function(_0x324595){const _0x588510=_0x35a7c3;if(_0x324595)logger[_0x588510(0x200)](_0x324595);}));});}function stopBot(_0x45363d){const _0x34b8bf=_0x2b0fc2;getClientsWithBotID(_0x45363d)[_0x34b8bf(0x387)](_0xc36cb4=>{const _0x2b350d=_0x34b8bf;getSocket(_0xc36cb4['id'])[_0x2b350d(0x2ca)](!![]),removeClient(_0xc36cb4['id']);}),pid[_0x45363d]&&(pid[_0x45363d]['kill'](),pid[_0x45363d]=null);}function restartBot(_0x44e9a2){if(pid[_0x44e9a2])pid[_0x44e9a2]['kill']();}function addBot(){const _0xba547a=_0x2b0fc2;let _0x20ac3b;for(let _0x123ed5=0x1;_0x123ed5<0x3e9;_0x123ed5++){_0x20ac3b=_0x123ed5[_0xba547a(0x29e)]()[_0xba547a(0x2a8)](0x3,'0');let _0x32038e=config[_0xba547a(0x1fa)](_0x12a519=>_0x12a519[_0xba547a(0x2a3)]==_0x20ac3b);if(!_0x32038e)break;}if(_0x20ac3b==='1000'){logger[_0xba547a(0x200)](_0xba547a(0x368));return;}logger['full'](_0xba547a(0x299)+_0x20ac3b),dbConfig[_0xba547a(0x210)](_0xba547a(0x2a1))[_0xba547a(0x31f)]({'botID':_0x20ac3b,'botname':_0xba547a(0x382)+_0x20ac3b,'status':_0xba547a(0x33b),'live':''})[_0xba547a(0x28d)](),startBot([_0x20ac3b,userID],{'cwd':bbpath},function(_0x5c6904){const _0x445d81=_0xba547a;if(_0x5c6904)logger[_0x445d81(0x200)](_0x5c6904);}),config=getConfiguration(),io['to'](_0xba547a(0x277))[_0xba547a(0x31d)](_0xba547a(0x2a1),config),broadcastToBots('bots',JSON[_0xba547a(0x317)](config));}function deleteBot(_0xd6d2e6){const _0x323d29=_0x2b0fc2;getClientsWithBotID(_0xd6d2e6)[_0x323d29(0x387)](_0x481da5=>{getSocket(_0x481da5['id'])['disconnect'](!![]),removeClient(_0x481da5['id']);}),dbConfig[_0x323d29(0x210)](_0x323d29(0x2a1))[_0x323d29(0x254)]({'botID':_0xd6d2e6})[_0x323d29(0x28d)](),logger['full'](_0x323d29(0x36a)+_0xd6d2e6),stopBot(_0xd6d2e6);try{if(fs[_0x323d29(0x354)](path[_0x323d29(0x3bd)](configpath,_0x323d29(0x329)+_0xd6d2e6+_0x323d29(0x20d))))fs[_0x323d29(0x350)](path[_0x323d29(0x3bd)](configpath,_0x323d29(0x329)+_0xd6d2e6+_0x323d29(0x20d)));if(fs[_0x323d29(0x354)](path['join'](configpath,'bot-'+_0xd6d2e6+_0x323d29(0x274))))fs[_0x323d29(0x350)](path[_0x323d29(0x3bd)](configpath,'bot-'+_0xd6d2e6+_0x323d29(0x274)));if(fs['existsSync'](path[_0x323d29(0x3bd)](configpath,'bot-'+_0xd6d2e6+'-performance.json')))fs[_0x323d29(0x350)](path[_0x323d29(0x3bd)](configpath,_0x323d29(0x329)+_0xd6d2e6+_0x323d29(0x26a)));if(fs[_0x323d29(0x354)](path[_0x323d29(0x3bd)](configpath,_0x323d29(0x329)+_0xd6d2e6+_0x323d29(0x394))))fs[_0x323d29(0x350)](path[_0x323d29(0x3bd)](configpath,_0x323d29(0x329)+_0xd6d2e6+_0x323d29(0x394)));}catch(_0x47160d){if(_0x47160d)logger[_0x323d29(0x200)](_0x323d29(0x291),_0x47160d);}config=getConfiguration(),io['to'](_0x323d29(0x277))[_0x323d29(0x31d)]('bots',config),broadcastToBots('bots',JSON[_0x323d29(0x317)](config));}function toggleBot(_0x439cb2,_0x14f6a3,_0x2dccfe){const _0x13d6f2=_0x2b0fc2;dbConfig[_0x13d6f2(0x210)]('bots')[_0x13d6f2(0x1fa)]({'botID':_0x439cb2})[_0x13d6f2(0x28c)]({'status':_0x14f6a3})[_0x13d6f2(0x28c)]({'live':_0x2dccfe})['write']();if(_0x14f6a3=='enabled'||_0x14f6a3==_0x13d6f2(0x33b))logger[_0x13d6f2(0x200)](_0x13d6f2(0x3a9)+_0x439cb2),startBot([_0x439cb2,userID],{'cwd':bbpath},function(_0x48b8a0){const _0x5a3b9f=_0x13d6f2;if(_0x48b8a0)logger[_0x5a3b9f(0x200)](_0x48b8a0);});else(_0x14f6a3==_0x13d6f2(0x340)||_0x14f6a3==_0x13d6f2(0x2b6))&&(logger['full']('Disabled\x20Bot\x20'+_0x439cb2),stopBot(_0x439cb2));config=getConfiguration(),io['to'](_0x13d6f2(0x277))[_0x13d6f2(0x31d)]('bots',config),broadcastToBots(_0x13d6f2(0x2a1),JSON[_0x13d6f2(0x317)](config));}function toggleStatus(_0x83e4e2){const _0x1c0547=_0x2b0fc2;let _0x25f88a=dbConfig[_0x1c0547(0x210)](_0x1c0547(0x2a1))['find']({'botID':_0x83e4e2})[_0x1c0547(0x213)](),_0x22cda2;if(_0x25f88a[_0x1c0547(0x218)]===_0x1c0547(0x23c))_0x22cda2=_0x1c0547(0x340);else{if(_0x25f88a[_0x1c0547(0x218)]===_0x1c0547(0x33b))_0x22cda2=_0x1c0547(0x2b6);else{if(_0x25f88a['status']===_0x1c0547(0x2b6))_0x22cda2=_0x1c0547(0x33b);else{if(_0x25f88a[_0x1c0547(0x218)]==='disabled')_0x22cda2=_0x1c0547(0x23c);}}}return _0x22cda2;}function updateStatus(_0x2e7640,_0x40462a){const _0x333eff=_0x2b0fc2;dbConfig[_0x333eff(0x210)](_0x333eff(0x2a1))[_0x333eff(0x1fa)]({'botID':_0x2e7640})[_0x333eff(0x28c)]({'status':_0x40462a})[_0x333eff(0x28d)](),config=getConfiguration(),io['to']('botmanager')[_0x333eff(0x31d)](_0x333eff(0x2a1),config),broadcastToBots(_0x333eff(0x2a1),JSON[_0x333eff(0x317)](config));}function updateLive(_0x9ce853,_0x383161){const _0x34d136=_0x2b0fc2;dbConfig[_0x34d136(0x210)]('bots')['find']({'botID':_0x9ce853})['assign']({'live':_0x383161})[_0x34d136(0x28d)](),config=getConfiguration(),io['to'](_0x34d136(0x277))['emit']('bots',config),broadcastToBots('bots',JSON[_0x34d136(0x317)](config));}function updateBotName(_0x48e779,_0xd15621){const _0x3873e1=_0x2b0fc2;dbConfig[_0x3873e1(0x210)](_0x3873e1(0x2a1))[_0x3873e1(0x1fa)]({'botID':_0x48e779})[_0x3873e1(0x28c)]({'botname':_0xd15621})[_0x3873e1(0x28d)](),config=getConfiguration(),io['to'](_0x3873e1(0x277))[_0x3873e1(0x31d)](_0x3873e1(0x2a1),config),broadcastToBots(_0x3873e1(0x2a1),JSON[_0x3873e1(0x317)](config));}function updateBotManager(){const _0x2836f9=_0x2b0fc2;config=getConfiguration(),io['to'](_0x2836f9(0x277))[_0x2836f9(0x31d)]('bots',config),broadcastToBots('bots',JSON[_0x2836f9(0x317)](config));}function toggleBotMode(_0x2e0462){const _0x14217a=_0x2b0fc2;if(pid[_0x2e0462])pid[_0x2e0462][_0x14217a(0x34c)]({'function':_0x14217a(0x234),'args':null});else{const _0x52c5c0=configpath+_0x14217a(0x329)+_0x2e0462+_0x14217a(0x20d),_0x4c4b9d=fs[_0x14217a(0x287)](_0x52c5c0),_0x32427f=JSON['parse'](_0x4c4b9d),_0x39c002=_0x32427f[_0x14217a(0x256)][0x0][_0x14217a(0x24a)];_0x32427f['bot'][0x0][_0x14217a(0x24a)]=!_0x39c002;const _0x4ccd4e=JSON[_0x14217a(0x317)](_0x32427f,null,0x2);fs[_0x14217a(0x1e6)](_0x52c5c0,_0x4ccd4e),config=getConfiguration(),io['to'](_0x14217a(0x277))[_0x14217a(0x31d)](_0x14217a(0x2a1),config),broadcastToBots(_0x14217a(0x2a1),JSON['stringify'](config));}}function telegramError(_0x4fc6a3){const _0x120ca5=_0x2b0fc2;logger[_0x120ca5(0x3a0)](getTimeStamp()+_0x120ca5(0x21c));}function validateTelegram(_0x301a19){const _0x2dee67=_0x2b0fc2;if(_0x301a19[_0x2dee67(0x328)]['username']!=settings[_0x2dee67(0x36b)]&&'@'+_0x301a19['from']['username']!=settings['telegramUsername'])return tgBot[_0x2dee67(0x345)](_0x301a19[_0x2dee67(0x1ee)]['id'],_0x2dee67(0x3be),{'parse_mode':_0x2dee67(0x25e)})[_0x2dee67(0x28b)](_0x519a91=>{telegramError(_0x519a91);}),![];return!![];}async function initTelegram(){const _0x46a5fa=_0x2b0fc2;if(tgBot)tgBot[_0x46a5fa(0x309)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x261505=_0x46a5fa(0x23e);_0x261505+='\x0a',_0x261505+='/enable\x20-\x20enable\x20notifications\x0a',_0x261505+=_0x46a5fa(0x3a6),_0x261505+=_0x46a5fa(0x347),_0x261505+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x261505+=_0x46a5fa(0x2fd),_0x261505+=_0x46a5fa(0x311),_0x261505+=_0x46a5fa(0x238),_0x261505+=_0x46a5fa(0x290),_0x261505+=_0x46a5fa(0x37a),_0x261505+=_0x46a5fa(0x3ab),_0x261505+=_0x46a5fa(0x304),_0x261505+=_0x46a5fa(0x270),_0x261505+=_0x46a5fa(0x2bc),_0x261505+=_0x46a5fa(0x283);let _0x5833ed=_0x46a5fa(0x298);_0x5833ed+='\x0a',_0x5833ed+=_0x261505,tgBot[_0x46a5fa(0x25a)](/\/start/,_0x38801a=>{const _0x2a08d8=_0x46a5fa;if(!validateTelegram(_0x38801a))return;if(settings[_0x2a08d8(0x392)]!=_0x38801a['chat']['id'])updateSetting('telegramChatId',_0x38801a['chat']['id']);updateSetting(_0x2a08d8(0x1ed),!![]),tgBot[_0x2a08d8(0x345)](_0x38801a[_0x2a08d8(0x1ee)]['id'],_0x5833ed)['catch'](_0x3ebe7f=>{telegramError(_0x3ebe7f);});}),tgBot[_0x46a5fa(0x25a)](/\/enable/,_0xa65066=>{const _0x92bcfc=_0x46a5fa;if(!validateTelegram(_0xa65066))return;if(settings[_0x92bcfc(0x392)]!=_0xa65066['chat']['id'])updateSetting(_0x92bcfc(0x392),_0xa65066[_0x92bcfc(0x1ee)]['id']);updateSetting(_0x92bcfc(0x1ed),!![]),tgBot['sendMessage'](_0xa65066[_0x92bcfc(0x1ee)]['id'],_0x92bcfc(0x39c))[_0x92bcfc(0x28b)](_0x2c73a1=>{telegramError(_0x2c73a1);});}),tgBot[_0x46a5fa(0x25a)](/\/config/,async _0x2cd75c=>{const _0x170692=_0x46a5fa;if(!validateTelegram(_0x2cd75c))return;tgBot[_0x170692(0x1e1)]('callback_query'),tgBot[_0x170692(0x345)](_0x2cd75c['chat']['id'],_0x170692(0x2d4),{'reply_markup':{'inline_keyboard':[[{'text':_0x170692(0x20c),'callback_data':_0x170692(0x24d)},{'text':'Alerts','callback_data':'alerts'},{'text':_0x170692(0x324),'callback_data':_0x170692(0x260)}]]}})['catch'](_0xbcf67f=>{telegramError(_0xbcf67f);}),tgBot['on']('callback_query',async _0x205fa8=>{const _0x1f5b46=_0x170692,_0x5b42ce=_0x205fa8[_0x1f5b46(0x381)],_0x5620e9=_0x205fa8[_0x1f5b46(0x2ac)];tgBot[_0x1f5b46(0x21d)](_0x205fa8['id'])[_0x1f5b46(0x2dd)](async()=>{const _0x75213a=_0x1f5b46;_0x5b42ce=='orders'&&(updateSetting(_0x75213a(0x225),_0x75213a(0x24d)),updateSetting(_0x75213a(0x1ed),!![]),await tgBot[_0x75213a(0x345)](_0x5620e9[_0x75213a(0x1ee)]['id'],_0x75213a(0x3b6))[_0x75213a(0x28b)](_0x1bc726=>{telegramError(_0x1bc726);}));_0x5b42ce==_0x75213a(0x34f)&&(updateSetting(_0x75213a(0x225),'alerts'),updateSetting(_0x75213a(0x1ed),!![]),await tgBot[_0x75213a(0x345)](_0x5620e9['chat']['id'],_0x75213a(0x36c))['catch'](_0x48045f=>{telegramError(_0x48045f);}));_0x5b42ce==_0x75213a(0x260)&&(updateSetting(_0x75213a(0x225),'all'),updateSetting(_0x75213a(0x1ed),!![]),await tgBot['sendMessage'](_0x5620e9['chat']['id'],_0x75213a(0x314))[_0x75213a(0x28b)](_0xc48dcb=>{telegramError(_0xc48dcb);}));if(!settings[_0x75213a(0x392)])tgBot['sendMessage'](_0x5620e9[_0x75213a(0x1ee)]['id'],_0x75213a(0x2a2))[_0x75213a(0x28b)](_0x3452b9=>{telegramError(_0x3452b9);});}),tgBot['removeListener']('callback_query');});}),tgBot['onText'](/\/status/,_0x38ac46=>{const _0x5f38d7=_0x46a5fa;if(!validateTelegram(_0x38ac46))return;const _0x249217=getBotsWithMode();let _0x2f76c8=_0x5f38d7(0x2a7);config[_0x5f38d7(0x387)](_0x27c5e4=>{const _0x53c758=_0x5f38d7,_0x46490e=_0x249217[_0x53c758(0x1fa)](_0x48ed2d=>_0x48ed2d[_0x53c758(0x2a3)]==_0x27c5e4[_0x53c758(0x2a3)])[_0x53c758(0x3bc)];_0x2f76c8+=_0x53c758(0x382)+_0x27c5e4[_0x53c758(0x2a3)]+':\x20'+_0x27c5e4[_0x53c758(0x218)]+'\x20|\x20'+_0x46490e+_0x53c758(0x338)+_0x27c5e4[_0x53c758(0x23a)]+'\x0a';}),_0x2f76c8+='\x0a',_0x2f76c8+=_0x5f38d7(0x330),_0x2f76c8+=!settings['telegramEnabled']?_0x5f38d7(0x203):_0x5f38d7(0x249),_0x2f76c8+=settings['telegramEnabled']?settings[_0x5f38d7(0x225)]==_0x5f38d7(0x260)?_0x5f38d7(0x2fc):'Notifications\x20types:\x20'+settings[_0x5f38d7(0x225)]+'\x20only\x0a':'',tgBot[_0x5f38d7(0x345)](_0x38ac46[_0x5f38d7(0x1ee)]['id'],_0x2f76c8,{'parse_mode':_0x5f38d7(0x25e)})['catch'](_0x3f336f=>{telegramError(_0x3f336f);});}),tgBot['onText'](/\/restart/,_0x24a86d=>{const _0x3d179e=_0x46a5fa;if(!validateTelegram(_0x24a86d))return;tgBot[_0x3d179e(0x1e1)]('callback_query');const _0x18f139=getEnabledBots();if(_0x18f139[_0x3d179e(0x2d7)]==0x0)tgBot[_0x3d179e(0x345)](_0x24a86d['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x3d179e(0x28b)](_0x1d1f73=>{telegramError(_0x1d1f73);});else{if(_0x18f139[_0x3d179e(0x2d7)]>0x1)_0x18f139['push']({'botID':_0x3d179e(0x260)});let _0x27459f=[],_0x41c829=[];const _0x2cb5b9=_0x18f139[_0x3d179e(0x2d7)]%0x4==0x0||_0x18f139[_0x3d179e(0x2d7)]%0x4==0x3||_0x18f139['length']%0x3==0x1?0x4:0x3;let _0x1475f6=0x0;_0x18f139['forEach']((_0x4230fd,_0x5122c8)=>{const _0x17d189=_0x3d179e;if(_0x5122c8%_0x2cb5b9==0x0)_0x41c829=[];_0x41c829[_0x17d189(0x31f)]({'text':_0x4230fd[_0x17d189(0x2a3)]==_0x17d189(0x260)?_0x17d189(0x243):_0x17d189(0x382)+_0x4230fd[_0x17d189(0x2a3)],'callback_data':_0x4230fd[_0x17d189(0x2a3)]}),_0x5122c8%_0x2cb5b9==0x0&&(_0x27459f[_0x1475f6]=_0x41c829,_0x1475f6++);}),tgBot[_0x3d179e(0x345)](_0x24a86d[_0x3d179e(0x1ee)]['id'],_0x3d179e(0x355),{'reply_markup':{'inline_keyboard':_0x27459f}})['catch'](_0x370936=>{telegramError(_0x370936);}),tgBot['on'](_0x3d179e(0x273),async _0x17dbf8=>{const _0x383262=_0x3d179e,_0x2f4372=_0x17dbf8[_0x383262(0x381)],_0x59323f=_0x17dbf8['message'];tgBot[_0x383262(0x21d)](_0x17dbf8['id'])['then'](async()=>{_0x2f4372=='all'?config['forEach'](_0x55e786=>{const _0x46c038=_0x2ca7;restartBot(_0x55e786[_0x46c038(0x2a3)]);}):restartBot(_0x2f4372);}),tgBot['removeListener'](_0x383262(0x273));});}}),tgBot[_0x46a5fa(0x25a)](/\/on/,_0x1a932b=>{const _0x1809c0=_0x46a5fa;if(!validateTelegram(_0x1a932b))return;tgBot['removeListener']('callback_query');const _0x3ffc30=getDisabledBots();if(_0x3ffc30[_0x1809c0(0x2d7)]==0x0)tgBot[_0x1809c0(0x345)](_0x1a932b['chat']['id'],'All\x20bots\x20running\x20right\x20now')[_0x1809c0(0x28b)](_0x4f5c92=>{telegramError(_0x4f5c92);});else{if(_0x3ffc30[_0x1809c0(0x2d7)]>0x1)_0x3ffc30['push']({'botID':'all'});let _0xefe3c9=[],_0x33df00=[];const _0x3b310f=_0x3ffc30['length']%0x4==0x0||_0x3ffc30['length']%0x4==0x3||_0x3ffc30['length']%0x3==0x1?0x4:0x3;let _0x51788e=0x0;_0x3ffc30[_0x1809c0(0x387)]((_0x296e10,_0x5e27ea)=>{const _0x22cd5a=_0x1809c0;if(_0x5e27ea%_0x3b310f==0x0)_0x33df00=[];_0x33df00['push']({'text':_0x296e10[_0x22cd5a(0x2a3)]=='all'?_0x22cd5a(0x243):'Bot\x20'+_0x296e10[_0x22cd5a(0x2a3)],'callback_data':_0x296e10[_0x22cd5a(0x2a3)]}),_0x5e27ea%_0x3b310f==0x0&&(_0xefe3c9[_0x51788e]=_0x33df00,_0x51788e++);}),tgBot['sendMessage'](_0x1a932b[_0x1809c0(0x1ee)]['id'],_0x1809c0(0x282),{'reply_markup':{'inline_keyboard':_0xefe3c9}})['catch'](_0x4f9c0b=>{telegramError(_0x4f9c0b);}),tgBot['on'](_0x1809c0(0x273),async _0x13a5d0=>{const _0x53bfcc=_0x1809c0,_0x1439be=_0x13a5d0['data'],_0x1708c8=_0x13a5d0[_0x53bfcc(0x2ac)];tgBot[_0x53bfcc(0x21d)](_0x13a5d0['id'])[_0x53bfcc(0x2dd)](async()=>{const _0x5ad7e7=_0x53bfcc;_0x1439be==_0x5ad7e7(0x260)?(tgBot[_0x5ad7e7(0x345)](_0x1708c8[_0x5ad7e7(0x1ee)]['id'],_0x5ad7e7(0x302))[_0x5ad7e7(0x28b)](_0x1bc789=>{telegramError(_0x1bc789);}),_0x3ffc30['forEach'](_0x58eb48=>{const _0x3a9b10=_0x5ad7e7;if(_0x58eb48['botID']!=_0x3a9b10(0x260))toggleBot(_0x58eb48[_0x3a9b10(0x2a3)],toggleStatus(_0x58eb48[_0x3a9b10(0x2a3)]),'stopped');})):(tgBot['sendMessage'](_0x1708c8['chat']['id'],_0x5ad7e7(0x2b1)+_0x1439be)[_0x5ad7e7(0x28b)](_0x45381b=>{telegramError(_0x45381b);}),toggleBot(_0x1439be,toggleStatus(_0x1439be),_0x5ad7e7(0x236)));}),tgBot[_0x53bfcc(0x1e1)](_0x53bfcc(0x273));});}}),tgBot[_0x46a5fa(0x25a)](/\/off/,_0x3be691=>{const _0x5660d9=_0x46a5fa;if(!validateTelegram(_0x3be691))return;tgBot[_0x5660d9(0x1e1)](_0x5660d9(0x273));const _0x53c05e=getEnabledBots();if(_0x53c05e[_0x5660d9(0x2d7)]==0x0)tgBot[_0x5660d9(0x345)](_0x3be691[_0x5660d9(0x1ee)]['id'],_0x5660d9(0x1f4))['catch'](_0x41982e=>{telegramError(_0x41982e);});else{if(_0x53c05e[_0x5660d9(0x2d7)]>0x1)_0x53c05e[_0x5660d9(0x31f)]({'botID':_0x5660d9(0x260)});let _0x7a5eb3=[],_0xf90e8c=[];const _0x2d4d23=_0x53c05e[_0x5660d9(0x2d7)]%0x4==0x0||_0x53c05e[_0x5660d9(0x2d7)]%0x4==0x3||_0x53c05e[_0x5660d9(0x2d7)]%0x3==0x1?0x4:0x3;let _0x571f5e=0x0;_0x53c05e[_0x5660d9(0x387)]((_0xec6684,_0x21dd71)=>{const _0x28b830=_0x5660d9;if(_0x21dd71%_0x2d4d23==0x0)_0xf90e8c=[];_0xf90e8c[_0x28b830(0x31f)]({'text':_0xec6684[_0x28b830(0x2a3)]==_0x28b830(0x260)?_0x28b830(0x243):_0x28b830(0x382)+_0xec6684['botID'],'callback_data':_0xec6684[_0x28b830(0x2a3)]}),_0x21dd71%_0x2d4d23==0x0&&(_0x7a5eb3[_0x571f5e]=_0xf90e8c,_0x571f5e++);}),tgBot['sendMessage'](_0x3be691[_0x5660d9(0x1ee)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x7a5eb3}})[_0x5660d9(0x28b)](_0x34eba6=>{telegramError(_0x34eba6);}),tgBot['on'](_0x5660d9(0x273),async _0x1b8600=>{const _0xa213cc=_0x5660d9,_0x2b90b9=_0x1b8600[_0xa213cc(0x381)],_0xda97b4=_0x1b8600['message'];tgBot[_0xa213cc(0x21d)](_0x1b8600['id'])['then'](async()=>{const _0x3699ad=_0xa213cc;_0x2b90b9==_0x3699ad(0x260)?(tgBot[_0x3699ad(0x345)](_0xda97b4[_0x3699ad(0x1ee)]['id'],_0x3699ad(0x202))[_0x3699ad(0x28b)](_0x2a3bd3=>{telegramError(_0x2a3bd3);}),_0x53c05e[_0x3699ad(0x387)](_0x313083=>{const _0x39c8ec=_0x3699ad;if(_0x313083[_0x39c8ec(0x2a3)]!=_0x39c8ec(0x260))toggleBot(_0x313083[_0x39c8ec(0x2a3)],toggleStatus(_0x313083[_0x39c8ec(0x2a3)]),_0x39c8ec(0x236));})):(tgBot[_0x3699ad(0x345)](_0xda97b4['chat']['id'],_0x3699ad(0x2f0)+_0x2b90b9)['catch'](_0x2b475d=>{telegramError(_0x2b475d);}),toggleBot(_0x2b90b9,toggleStatus(_0x2b90b9),_0x3699ad(0x236)));}),tgBot['removeListener'](_0xa213cc(0x273));});}}),tgBot['onText'](/\/metrics/,_0x5133d1=>{const _0x38ca7d=_0x46a5fa;if(!validateTelegram(_0x5133d1))return;tgBot[_0x38ca7d(0x1e1)]('callback_query');const _0x292cef=getEnabledBots();if(_0x292cef[_0x38ca7d(0x2d7)]==0x0)tgBot[_0x38ca7d(0x345)](_0x5133d1[_0x38ca7d(0x1ee)]['id'],_0x38ca7d(0x1f4))[_0x38ca7d(0x28b)](_0x461754=>{telegramError(_0x461754);});else{if(_0x292cef[_0x38ca7d(0x2d7)]>0x1){let _0x5d89e9=[],_0x234c0d=[];const _0x25fb06=_0x292cef[_0x38ca7d(0x2d7)]%0x4==0x0||_0x292cef['length']%0x4==0x3||_0x292cef[_0x38ca7d(0x2d7)]%0x3==0x1?0x4:0x3;let _0x46a72e=0x0;_0x292cef[_0x38ca7d(0x387)]((_0x5ad0ec,_0x167589)=>{const _0x33f69b=_0x38ca7d;if(_0x167589%_0x25fb06==0x0)_0x234c0d=[];_0x234c0d[_0x33f69b(0x31f)]({'text':_0x33f69b(0x382)+_0x5ad0ec['botID'],'callback_data':_0x5ad0ec[_0x33f69b(0x2a3)]}),_0x167589%_0x25fb06==0x0&&(_0x5d89e9[_0x46a72e]=_0x234c0d,_0x46a72e++);}),tgBot['sendMessage'](_0x5133d1['chat']['id'],_0x38ca7d(0x320),{'reply_markup':{'inline_keyboard':_0x5d89e9}})[_0x38ca7d(0x28b)](_0x2eff74=>{telegramError(_0x2eff74);}),tgBot['on'](_0x38ca7d(0x273),async _0x4b9089=>{const _0x338c91=_0x38ca7d,_0x3fcdac=_0x4b9089[_0x338c91(0x381)],_0x548b89=_0x4b9089[_0x338c91(0x2ac)];tgBot['answerCallbackQuery'](_0x4b9089['id'])[_0x338c91(0x2dd)](async()=>{if(pid[_0x3fcdac])pid[_0x3fcdac]['send']({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x338c91(0x1e1)]('callback_query');});}else{const _0x44d854=_0x292cef[0x0][_0x38ca7d(0x2a3)];if(pid[_0x44d854])pid[_0x44d854][_0x38ca7d(0x34c)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot['onText'](/\/portfolio/,_0xfcaa4e=>{const _0x2c18db=_0x46a5fa;if(!validateTelegram(_0xfcaa4e))return;tgBot[_0x2c18db(0x1e1)](_0x2c18db(0x273));const _0x878248=getEnabledBots();if(_0x878248[_0x2c18db(0x2d7)]==0x0)tgBot[_0x2c18db(0x345)](_0xfcaa4e[_0x2c18db(0x1ee)]['id'],_0x2c18db(0x1f4))[_0x2c18db(0x28b)](_0x7bff1f=>{telegramError(_0x7bff1f);});else{if(_0x878248[_0x2c18db(0x2d7)]>0x1){let _0x1b8342=[],_0xdcd4b1=[];const _0x15a878=_0x878248[_0x2c18db(0x2d7)]%0x4==0x0||_0x878248[_0x2c18db(0x2d7)]%0x4==0x3||_0x878248[_0x2c18db(0x2d7)]%0x3==0x1?0x4:0x3;let _0x38eda6=0x0;_0x878248[_0x2c18db(0x387)]((_0x387a0b,_0x45bec0)=>{const _0x1d2b6b=_0x2c18db;if(_0x45bec0%_0x15a878==0x0)_0xdcd4b1=[];_0xdcd4b1['push']({'text':_0x1d2b6b(0x382)+_0x387a0b['botID'],'callback_data':_0x387a0b[_0x1d2b6b(0x2a3)]}),_0x45bec0%_0x15a878==0x0&&(_0x1b8342[_0x38eda6]=_0xdcd4b1,_0x38eda6++);}),tgBot[_0x2c18db(0x345)](_0xfcaa4e['chat']['id'],_0x2c18db(0x2fb),{'reply_markup':{'inline_keyboard':_0x1b8342}})[_0x2c18db(0x28b)](_0x225720=>{telegramError(_0x225720);}),tgBot['on'](_0x2c18db(0x273),async _0x51157a=>{const _0x5ed77d=_0x2c18db,_0x52e1a6=_0x51157a[_0x5ed77d(0x381)],_0x2df8cb=_0x51157a[_0x5ed77d(0x2ac)];tgBot['answerCallbackQuery'](_0x51157a['id'])[_0x5ed77d(0x2dd)](async()=>{const _0x4ef99d=_0x5ed77d;if(pid[_0x52e1a6])pid[_0x52e1a6][_0x4ef99d(0x34c)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x5ed77d(0x1e1)](_0x5ed77d(0x273));});}else{const _0x43ad29=_0x878248[0x0]['botID'];if(pid[_0x43ad29])pid[_0x43ad29][_0x2c18db(0x34c)]({'function':_0x2c18db(0x1fb),'args':null});}}}),tgBot['onText'](/\/update/,async _0x5a6ab5=>{const _0x5886e7=_0x46a5fa;if(!validateTelegram(_0x5a6ab5))return;tgBot[_0x5886e7(0x1e1)](_0x5886e7(0x273)),await getMessages();if(!updateAvailable)tgBot[_0x5886e7(0x345)](_0x5a6ab5[_0x5886e7(0x1ee)]['id'],_0x5886e7(0x2db))[_0x5886e7(0x28b)](_0x124086=>{telegramError(_0x124086);});else!validInstallation?tgBot[_0x5886e7(0x345)](_0x5a6ab5[_0x5886e7(0x1ee)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0x5886e7(0x28b)](_0x59e15b=>{telegramError(_0x59e15b);}):(tgBot['sendMessage'](_0x5a6ab5['chat']['id'],_0x5886e7(0x307),{'reply_markup':{'inline_keyboard':[[{'text':_0x5886e7(0x32e),'callback_data':_0x5886e7(0x3ad)},{'text':'No','callback_data':'no'}]]}})[_0x5886e7(0x28b)](_0x6d4aa0=>{telegramError(_0x6d4aa0);}),tgBot['on'](_0x5886e7(0x273),async _0x3f8f67=>{const _0x4952df=_0x5886e7,_0x21ab50=_0x3f8f67[_0x4952df(0x381)],_0x583640=_0x3f8f67[_0x4952df(0x2ac)];tgBot[_0x4952df(0x21d)](_0x3f8f67['id'])[_0x4952df(0x2dd)](async()=>{const _0x592f81=_0x4952df;_0x21ab50==_0x592f81(0x3ad)&&(await tgBot['sendMessage'](_0x583640[_0x592f81(0x1ee)]['id'],_0x592f81(0x248))[_0x592f81(0x28b)](_0x478e01=>{telegramError(_0x478e01);}),updateBB('update')),_0x21ab50=='no'&&await tgBot[_0x592f81(0x345)](_0x583640['chat']['id'],_0x592f81(0x30a))[_0x592f81(0x28b)](_0x47278c=>{telegramError(_0x47278c);});}),tgBot['removeListener'](_0x4952df(0x273));}));}),tgBot[_0x46a5fa(0x25a)](/\/reinstall/,async _0x3bbce1=>{const _0x3aa8a5=_0x46a5fa;if(!validateTelegram(_0x3bbce1))return;tgBot[_0x3aa8a5(0x1e1)](_0x3aa8a5(0x273)),!validInstallation?tgBot['sendMessage'](_0x3bbce1[_0x3aa8a5(0x1ee)]['id'],_0x3aa8a5(0x286))[_0x3aa8a5(0x28b)](_0x58da75=>{telegramError(_0x58da75);}):(tgBot[_0x3aa8a5(0x345)](_0x3bbce1[_0x3aa8a5(0x1ee)]['id'],_0x3aa8a5(0x3a8),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x3aa8a5(0x3ad)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x3b7a16=>{telegramError(_0x3b7a16);}),tgBot['on'](_0x3aa8a5(0x273),async _0x575c25=>{const _0x4135b3=_0x3aa8a5,_0x4d4910=_0x575c25[_0x4135b3(0x381)],_0x3309b1=_0x575c25[_0x4135b3(0x2ac)];tgBot[_0x4135b3(0x21d)](_0x575c25['id'])[_0x4135b3(0x2dd)](async()=>{const _0x4692a3=_0x4135b3;_0x4d4910==_0x4692a3(0x3ad)&&(await tgBot['sendMessage'](_0x3309b1['chat']['id'],_0x4692a3(0x2ef))[_0x4692a3(0x28b)](_0x5d360e=>{telegramError(_0x5d360e);}),updateBB(_0x4692a3(0x3af))),_0x4d4910=='no'&&await tgBot['sendMessage'](_0x3309b1[_0x4692a3(0x1ee)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')['catch'](_0xdb8f02=>{telegramError(_0xdb8f02);});}),tgBot['removeListener']('callback_query');}));}),tgBot[_0x46a5fa(0x25a)](/\/toggle/,_0xe16c42=>{const _0x300932=_0x46a5fa;if(!validateTelegram(_0xe16c42))return;tgBot[_0x300932(0x1e1)](_0x300932(0x273));const _0x177be8=getBotsWithMode();if(_0x177be8[_0x300932(0x2d7)]==0x0)tgBot[_0x300932(0x345)](_0xe16c42[_0x300932(0x1ee)]['id'],_0x300932(0x1f4))[_0x300932(0x28b)](_0x187e53=>{telegramError(_0x187e53);});else{let _0x22da7f=[],_0x1ef79b=[];const _0xf393c3=0x2;let _0x4661e7=0x0;_0x177be8['forEach']((_0x3005b0,_0x40cdf2)=>{const _0x335439=_0x300932;if(_0x40cdf2%_0xf393c3==0x0)_0x1ef79b=[];_0x1ef79b[_0x335439(0x31f)]({'text':_0x335439(0x382)+_0x3005b0[_0x335439(0x2a3)]+'\x20('+_0x3005b0[_0x335439(0x3bc)]+')','callback_data':_0x3005b0['botID']}),_0x40cdf2%_0xf393c3==0x0&&(_0x22da7f[_0x4661e7]=_0x1ef79b,_0x4661e7++);}),tgBot[_0x300932(0x345)](_0xe16c42['chat']['id'],_0x300932(0x349),{'reply_markup':{'inline_keyboard':_0x22da7f}})['catch'](_0x2920fa=>{telegramError(_0x2920fa);}),tgBot['on']('callback_query',async _0x7c27fc=>{const _0x13f64e=_0x300932,_0x4c993a=_0x7c27fc[_0x13f64e(0x381)],_0x284533=_0x7c27fc['message'];tgBot[_0x13f64e(0x21d)](_0x7c27fc['id'])[_0x13f64e(0x2dd)](async()=>{const _0x2b26a0=_0x13f64e,_0x1f16e7=_0x177be8[_0x2b26a0(0x1fa)](_0x17d0f8=>_0x17d0f8[_0x2b26a0(0x2a3)]==_0x4c993a),_0x2ee9c0=_0x1f16e7[_0x2b26a0(0x3bc)]==_0x2b26a0(0x1f5)?'manual':'auto';tgBot[_0x2b26a0(0x345)](_0x284533[_0x2b26a0(0x1ee)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x4c993a+_0x2b26a0(0x2e4)+_0x2ee9c0+_0x2b26a0(0x251))[_0x2b26a0(0x28b)](_0x1b18de=>{telegramError(_0x1b18de);}),toggleBotMode(_0x4c993a);}),tgBot[_0x13f64e(0x1e1)](_0x13f64e(0x273));});}}),tgBot['onText'](/\/names/,_0x107cc9=>{const _0xe24411=_0x46a5fa;if(!validateTelegram(_0x107cc9))return;let _0x5c3dde='';config[_0xe24411(0x387)](_0x48a292=>{const _0x1f8eab=_0xe24411;_0x5c3dde+='Bot\x20'+_0x48a292[_0x1f8eab(0x2a3)]+':\x20'+_0x48a292['botname']+'\x0a';}),tgBot['sendMessage'](_0x107cc9['chat']['id'],_0x5c3dde,{'parse_mode':_0xe24411(0x25e)})['catch'](_0x29702a=>{telegramError(_0x29702a);});}),tgBot[_0x46a5fa(0x25a)](/\/disable/,_0x490932=>{const _0x28397e=_0x46a5fa;if(!validateTelegram(_0x490932))return;tgBot[_0x28397e(0x345)](_0x490932[_0x28397e(0x1ee)]['id'],_0x28397e(0x2f3))[_0x28397e(0x28b)](_0x158134=>{telegramError(_0x158134);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x46a5fa(0x25a)](/\/help/,_0x12a393=>{const _0x5e8240=_0x46a5fa;if(!validateTelegram(_0x12a393))return;tgBot[_0x5e8240(0x345)](_0x12a393[_0x5e8240(0x1ee)]['id'],_0x261505)[_0x5e8240(0x28b)](_0x328ecb=>{telegramError(_0x328ecb);});}),tgBot['on'](_0x46a5fa(0x204),_0x1d9cd5=>{const _0x469bb0=_0x46a5fa;_0x1d9cd5['toString']()['includes']('404\x20Not\x20Found')&&(logger['full'](_0x469bb0(0x378)),tgBot[_0x469bb0(0x309)](),tgBot=null,io['to'](_0x469bb0(0x277))[_0x469bb0(0x31d)]('notification',_0x469bb0(0x378)));}),process[_0x46a5fa(0x2b4)](_0x46a5fa(0x232),()=>{const _0x1ce3c5=_0x46a5fa;if(tgBot)tgBot['stopPolling']();process[_0x1ce3c5(0x228)](0x1);}),process['once'](_0x46a5fa(0x300),()=>{const _0x389932=_0x46a5fa;if(tgBot)tgBot[_0x389932(0x309)]();process[_0x389932(0x228)](0x1);});}}function disableTelegram(){const _0x563b4f=_0x2b0fc2;tgBot&&(tgBot[_0x563b4f(0x309)](),tgBot=null);}function sendTelegram(_0x332202,_0x33461d){const _0x122490=_0x2b0fc2;if(settings['telegramEnabled']){if(settings[_0x122490(0x225)]==_0x122490(0x260)||(_0x33461d[_0x122490(0x294)]=='error'||_0x33461d[_0x122490(0x294)]==_0x122490(0x250)||_0x33461d[_0x122490(0x294)]=='success')&&settings[_0x122490(0x225)]==_0x122490(0x34f)||_0x33461d['type']==_0x122490(0x2ab)&&settings[_0x122490(0x225)]==_0x122490(0x24d)){if(tgBot&&settings['telegramChatId']){if(_0x33461d['showname'])tgBot[_0x122490(0x345)](settings[_0x122490(0x392)],_0x33461d[_0x122490(0x2d5)]+'\x20>\x20'+_0x33461d[_0x122490(0x343)])[_0x122490(0x28b)](_0xf8e9e5=>{telegramError(_0xf8e9e5);});else tgBot['sendMessage'](settings['telegramChatId'],_0x122490(0x382)+_0x332202+_0x122490(0x35b)+_0x33461d[_0x122490(0x343)])[_0x122490(0x28b)](_0x385a5f=>{telegramError(_0x385a5f);});}}}}async function sendTelegramMsg(_0x5da898,_0x2fb491=_0x2b0fc2(0x25e)){const _0x3cf342=_0x2b0fc2;return settings[_0x3cf342(0x1ed)]&&tgBot&&settings[_0x3cf342(0x392)]?(await tgBot[_0x3cf342(0x345)](settings[_0x3cf342(0x392)],_0x5da898,{'parse_mode':_0x2fb491})['catch'](_0x5722a6=>{telegramError(_0x5722a6);}),!![]):![];}function getDeviceWithIp(_0x1b821c){const _0x44774d=_0x2b0fc2;return devices[_0x44774d(0x1fa)](_0x590e02=>_0x590e02['ip']===_0x1b821c);}function temporaryAccess2FA(_0x4c749b,_0x2c96f3){const _0x26929a=_0x2b0fc2;let _0x1aa848=new Date(),_0x3e1790=![];if(lastIpApproval){if(_0x1aa848-lastIpApproval<0x1388)_0x3e1790=!![];}lastIpApproval=new Date();if(_0x3e1790)return;tgBot&&settings[_0x26929a(0x392)]&&(tgBot[_0x26929a(0x1e1)]('callback_query'),tgBot['sendMessage'](settings[_0x26929a(0x392)],_0x26929a(0x363)+normalizeIP(_0x2c96f3)[_0x26929a(0x271)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x26929a(0x1f0),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x26929a(0x219),'callback_data':'30'},{'text':'reject','callback_data':_0x26929a(0x2e0)}]]}})[_0x26929a(0x28b)](_0x53d969=>{telegramError(_0x53d969);}),tgBot['on']('callback_query',async _0x3a61bf=>{const _0x20d71d=_0x26929a,_0x2a0bb4=_0x3a61bf[_0x20d71d(0x381)],_0x14afd2=_0x3a61bf[_0x20d71d(0x2ac)];tgBot[_0x20d71d(0x21d)](_0x3a61bf['id'])['then'](async()=>{const _0x48f78e=_0x20d71d;devices[_0x4c749b][_0x48f78e(0x319)]={'clientip':_0x2c96f3,'timestamp':new Date()[_0x48f78e(0x380)](),'expiry':_0x2a0bb4},_0x2a0bb4!='reject'?(await tgBot[_0x48f78e(0x345)](_0x14afd2['chat']['id'],_0x48f78e(0x3b9)+_0x2a0bb4+_0x48f78e(0x216),{'parse_mode':_0x48f78e(0x25e)})[_0x48f78e(0x28b)](_0x24eaa9=>{telegramError(_0x24eaa9);}),io['to'](_0x4c749b)[_0x48f78e(0x31d)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x48f78e(0x345)](_0x14afd2[_0x48f78e(0x1ee)]['id'],_0x48f78e(0x253))[_0x48f78e(0x28b)](_0x32f312=>{telegramError(_0x32f312);}),io['to'](_0x4c749b)[_0x48f78e(0x31d)](_0x48f78e(0x218),{'access':{'allow':![],'reason':_0x48f78e(0x205),'token':null}}));}),tgBot['removeListener']('callback_query');}));}function loginAccess2FA(_0x5e0556,_0x47a28f){const _0x339ef8=_0x2b0fc2;tgBot&&settings[_0x339ef8(0x392)]&&(tgBot[_0x339ef8(0x1e1)](_0x339ef8(0x273)),tgBot[_0x339ef8(0x345)](settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x47a28f)[_0x339ef8(0x271)]+_0x339ef8(0x334),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x339ef8(0x30d),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x339ef8(0x2e0)}]]}})['catch'](_0x4312c3=>{telegramError(_0x4312c3);}),tgBot['on'](_0x339ef8(0x273),async _0x4b5970=>{const _0x4827ea=_0x339ef8,_0x5e7514=_0x4b5970[_0x4827ea(0x381)],_0xa4295d=_0x4b5970[_0x4827ea(0x2ac)];tgBot['answerCallbackQuery'](_0x4b5970['id'])[_0x4827ea(0x2dd)](async()=>{const _0x6370fe=_0x4827ea;devices[_0x5e0556][_0x6370fe(0x3a2)]={'clientip':_0x47a28f,'timestamp':new Date()[_0x6370fe(0x380)](),'expiry':_0x5e7514},_0x5e7514!=_0x6370fe(0x2e0)?(await tgBot[_0x6370fe(0x345)](_0xa4295d['chat']['id'],_0x6370fe(0x312),{'parse_mode':_0x6370fe(0x25e)})[_0x6370fe(0x28b)](_0x3e81f3=>{telegramError(_0x3e81f3);}),io['to'](_0x5e0556)[_0x6370fe(0x31d)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x6370fe(0x345)](_0xa4295d[_0x6370fe(0x1ee)]['id'],_0x6370fe(0x1f8))[_0x6370fe(0x28b)](_0x373df9=>{telegramError(_0x373df9);}),io['to'](_0x5e0556)[_0x6370fe(0x31d)]('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x4827ea(0x1e1)](_0x4827ea(0x273));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x12ea87=_0x2b0fc2;return dbConfig[_0x12ea87(0x210)](_0x12ea87(0x2a1))[_0x12ea87(0x37c)](_0x12ea87(0x2a3))['filter']({'status':_0x12ea87(0x23c)})[_0x12ea87(0x213)]()||[];}function getDisabledBots(){const _0x3043a2=_0x2b0fc2;return dbConfig[_0x3043a2(0x210)](_0x3043a2(0x2a1))['sortBy'](_0x3043a2(0x2a3))[_0x3043a2(0x262)]({'status':_0x3043a2(0x340)})[_0x3043a2(0x213)]()||[];}function getBotAttributes(_0x129132){const _0x351d38=_0x2b0fc2;let _0x34830c={};const _0x4e59e4=configpath+_0x351d38(0x329)+_0x129132+_0x351d38(0x20d),_0x521245=fs[_0x351d38(0x354)](_0x4e59e4);if(_0x521245){const _0x2ad838=fs['readFileSync'](_0x4e59e4);try{const _0x1acc02=JSON[_0x351d38(0x230)](_0x2ad838),_0xf25ca=_0x1acc02?_0x1acc02['bot'][0x0]['headless']:![];_0x34830c[_0x351d38(0x3bc)]=_0xf25ca?_0x351d38(0x1f5):_0x351d38(0x223),_0x34830c[_0x351d38(0x2d5)]=_0x1acc02?_0x1acc02[_0x351d38(0x256)][0x0][_0x351d38(0x2d5)]:'Bot\x20'+_0x129132;}catch(_0x58c0bd){_0x34830c[_0x351d38(0x3bc)]=_0x351d38(0x223),_0x34830c[_0x351d38(0x2d5)]=_0x351d38(0x382)+_0x129132;}}else _0x34830c[_0x351d38(0x3bc)]=_0x351d38(0x223),_0x34830c['botname']=_0x351d38(0x382)+_0x129132;return _0x34830c;}function getBotsWithMode(){const _0x469a04=_0x2b0fc2,_0xa81e2d=dbConfig[_0x469a04(0x210)](_0x469a04(0x2a1))[_0x469a04(0x37c)]('botID')['value']()||[];return _0xa81e2d[_0x469a04(0x387)](_0x392ffc=>{const _0x6916db=_0x469a04;let _0x17a0db=getBotAttributes(_0x392ffc[_0x6916db(0x2a3)]);_0x392ffc[_0x6916db(0x3bc)]=_0x17a0db[_0x6916db(0x3bc)];}),_0xa81e2d;}function getBotExchanges(){const _0x503f65=_0x2b0fc2;let _0x5b4157=[];const _0x4e3491=dbConfig['get']('bots')['sortBy'](_0x503f65(0x2a3))[_0x503f65(0x213)]()||[];_0x4e3491[_0x503f65(0x387)](_0x2c2bdd=>{const _0x4ae3f1=_0x503f65;if(_0x2c2bdd[_0x4ae3f1(0x218)]==_0x4ae3f1(0x23c)){const _0x196192=configpath+_0x4ae3f1(0x329)+_0x2c2bdd[_0x4ae3f1(0x2a3)]+_0x4ae3f1(0x20d),_0x4909fd=fs[_0x4ae3f1(0x354)](_0x196192);let _0x8eacd8;if(_0x4909fd){const _0x5f05f9=fs['readFileSync'](_0x196192);try{const _0x13b0b7=JSON[_0x4ae3f1(0x230)](_0x5f05f9);_0x8eacd8=_0x13b0b7?_0x13b0b7['bot'][0x0][_0x4ae3f1(0x336)]:null;}catch(_0xe86d36){}}if(_0x8eacd8)_0x5b4157['push'](_0x8eacd8);}});const _0x28d53c=[...new Set(_0x5b4157)][_0x503f65(0x31a)]();return _0x28d53c;}async function initUser(){const _0x1420a8=_0x2b0fc2;if(!settings[_0x1420a8(0x20a)]){const _0x4d697a=uuidRandom();mixpanel[_0x1420a8(0x1e0)](_0x4d697a),updateSetting('userid',_0x4d697a);}}async function initSecure(){const _0x1e0576=_0x2b0fc2;let _0x29950a=getSecure();if(!_0x29950a[_0x1e0576(0x384)](_0x1e0576(0x35f))){let _0x446b70=await generateKeys();_0x29950a[_0x1e0576(0x292)]=_0x446b70[_0x1e0576(0x292)],_0x29950a['privateKey']=_0x446b70[_0x1e0576(0x21a)],_0x29950a[_0x1e0576(0x35f)]=crypto['randomBytes'](0x20)[_0x1e0576(0x29e)](_0x1e0576(0x366));;storeSecure(_0x29950a);}}function getSettings(){const _0x1a82ab=_0x2b0fc2;return dbSettings[_0x1a82ab(0x210)](_0x1a82ab(0x1f1))[_0x1a82ab(0x213)]()||{};}function getSecure(){const _0x5dc9fe=_0x2b0fc2;return dbSecure[_0x5dc9fe(0x210)](_0x5dc9fe(0x1f6))[_0x5dc9fe(0x213)]()||{};}function getBlacklist(){const _0x3b0d46=_0x2b0fc2;return dbSecure[_0x3b0d46(0x210)](_0x3b0d46(0x2c4))['value']()||[];}function broadcastToBots(_0x1b9b2a,_0x3cc1ef){const _0x5b7970=_0x2b0fc2;config[_0x5b7970(0x387)](_0x22e0e2=>{const _0x434c36=_0x5b7970;if(_0x22e0e2[_0x434c36(0x218)]=='enabled'&&_0x22e0e2[_0x434c36(0x23a)]==_0x434c36(0x377)||_0x22e0e2[_0x434c36(0x218)]=='new'&&_0x22e0e2[_0x434c36(0x23a)]=='running'){if(pid[_0x22e0e2[_0x434c36(0x2a3)]])pid[_0x22e0e2[_0x434c36(0x2a3)]][_0x434c36(0x34c)]({[_0x1b9b2a]:_0x3cc1ef});}});}function storeSettings(_0x8dbc61,_0x3267de=![]){const _0x295233=_0x2b0fc2;_0x8dbc61={...settings,..._0x8dbc61};if(_0x3267de&&_0x8dbc61[_0x295233(0x397)]!=_0x295233(0x289)&&_0x8dbc61[_0x295233(0x397)]!=_0x295233(0x266)&&_0x8dbc61[_0x295233(0x397)]!=''){const _0x73a61a=crypt['decrypt'](secure[_0x295233(0x21a)],_0x8dbc61[_0x295233(0x397)])[_0x295233(0x2ac)][_0x295233(0x395)]('@')[0x0],_0x78b575=bcrypt[_0x295233(0x3b7)](_0x73a61a,saltRounds);_0x8dbc61={..._0x8dbc61,'bbPassword':_0x78b575};}if(_0x3267de&&_0x8dbc61[_0x295233(0x261)]!=_0x295233(0x289)&&_0x8dbc61['telegramToken']!=_0x295233(0x266)&&_0x8dbc61[_0x295233(0x261)]!=''){const _0x1f5961=crypt[_0x295233(0x2c2)](secure[_0x295233(0x21a)],_0x8dbc61[_0x295233(0x261)])[_0x295233(0x2ac)][_0x295233(0x395)]('@')[0x0];_0x8dbc61={..._0x8dbc61,'telegramToken':_0x1f5961};}const _0x5b3217=_0x8dbc61['telegramToken']!='************'&&_0x8dbc61['telegramToken']!=settings[_0x295233(0x261)]||_0x8dbc61['telegramUsername']!=settings[_0x295233(0x36b)],_0x2d3b5=_0x8dbc61[_0x295233(0x261)]==''||_0x8dbc61[_0x295233(0x36b)]=='';if(_0x5b3217)_0x8dbc61[_0x295233(0x225)]=_0x295233(0x260);for(const [_0x341f33,_0x2967a2]of Object[_0x295233(0x26c)](_0x8dbc61)){if(_0x341f33==_0x295233(0x261)&&_0x2967a2==_0x295233(0x289)){_0x8dbc61[_0x295233(0x261)]=settings['telegramToken'];continue;};if(_0x341f33=='bbPassword'&&_0x2967a2==_0x295233(0x289)){_0x8dbc61[_0x295233(0x397)]=settings[_0x295233(0x397)];continue;};dbSettings[_0x295233(0x257)](_0x295233(0x325)+_0x341f33,_0x2967a2)['write']();}settings=_0x8dbc61,io['to'](_0x295233(0x277))[_0x295233(0x31d)](_0x295233(0x1f1),cleanSettings()),broadcastToBots(_0x295233(0x215),settings[_0x295233(0x215)]),broadcastToBots('onepagemode',settings[_0x295233(0x2e5)]);if(_0x5b3217&&!_0x2d3b5)initTelegram();if(_0x5b3217&&_0x2d3b5)disableTelegram();getAllClients()['forEach'](_0x24cd80=>{const _0x5caa9e=_0x295233;getSocket(_0x24cd80['id'])[_0x5caa9e(0x31d)](_0x5caa9e(0x218),{'access':{'allow':![],'reason':_0x5caa9e(0x357),'token':null}});});}function _0x52e8(){const _0x2bfb12=['storeConfiguration','readdirSync','userid','isDirectory','Orders','-config.json','\x1b[33m','bb/','get','port','36WbqBrb','value','use','timeshift','\x20minutes','string','status','30\x20min','privateKey','ipc',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','answerCallbackQuery','/:bot/history','zip/','24851mYVRDj','\x1b[31m','backup','manual','node','telegramEvents','Restore\x20process\x20aborted','bcryptjs','exit','1057048ODpHyP','config/','Unauthorized\x20attempt\x20to\x20update\x20bot','Backup\x20file\x20uploaded','Markdown','handshake','argv','parse','backup-full.zip','SIGINT','access','toggleBotMode','notification','stopped','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','output-000.log','live','graphql-request','enabled','generateKeyPairAsync','You\x20can\x20use\x20the\x20following\x20commands:\x0a','storeFiat','mkdirSync','Session\x20expired\x20for\x20user\x20...','delete-bot','All\x20bots','defaults','hybrid-crypto-js','backup-full@','\x20(2)','Starting\x20Balance\x20Bot\x20update','Notifications\x20enabled\x0a','headless','getMonth','timestamp','orders','*$1*','success','warning','\x20mode','Bot\x20Mgr\x20>\x20','Temporary\x20access\x20rejected','remove','\x1b[0m','bot','set','Token\x20blacklisted','User\x20has\x20been\x20validated','onText','init','f2aRequired','access\x20timeout','HTML','generate','all','telegramToken','filter','uuid','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','args','***','createWriteStream','#RES#\x20if\x20running\x20on\x20server','staging','-performance.json','get-starting-balances','entries','Password\x20reset\x20rejected','keys','stop','/update\x20-\x20update\x20Balance\x20Bot\x0a','show','getUTCHours','callback_query','-events.json','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Unauthorized\x20attempt\x20to\x20confirm\x20message','botmanager','#RES#\x20','bbvNew','post','path','Failed\x20to\x20download\x20','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','latestversion','name','backup/','::ffff:127.0.0.1','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','/help\x20-\x20show\x20available\x20commands\x0a','telegram','sendFile','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','readFileSync','socket','************','headers','catch','assign','write','Starting\x20#RED#Balance\x20Bot\x20v','apply','/names\x20-\x20show\x20bot\x20names\x0a','Error\x20while\x20deleting\x20config\x20files:\x20','publicKey','bot.js','type','production','apiKey','3000','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Starting\x20new\x20bot\x20|\x20Bot\x20','search','output-001.log','token','bb-config.json','toString','\x20(1)','express','bots','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','botID','Network\x20Interfaces:','show-config','logout','<b>Balance\x20Bot\x20Status:</b>\x0a','padStart','server','2FA\x20login\x20token\x20generated','order','message','listen','allow','rmSync','get-messages','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','lowdb/adapters/FileSync','getMinutes','once','login\x20not\x20required','new-disabled','_data','expiry','min','placeOrder','whitelist','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','restart','DEFLATE','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Logged\x20in\x20user\x20...','download','decrypt','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','blacklist','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','startsWith','6qwJHAG','uuid-random','tkn','disconnect','store-fiat','28tWhadd','getSeconds','Unauthorized\x20attempt\x20to\x20store\x20configuration','endsWith','Unauthorized\x20attempt\x20to\x20get\x20portfolio','node-zip','build','version.json','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','botname','compareSync','length','username','statSync','http','Your\x20installation\x20is\x20already\x20up\x20to\x20date','axios','then','Restarting\x20Bot\x20','6b67f3d61ee94b8f5c80b4affef4c4d9','reject','.zip','cancelLoading','temporary\x20access\x20not\x20allowed','\x20to\x20','onepagemode','(staging)','map','temporary\x20access\x20timeout','IPv4','2FA','environment','storeHeadless','getHours','Unauthorized\x20attempt\x20to\x20download\x20','Starting\x20Balance\x20Bot\x20reinstallation','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Restoring\x20bot(s)\x20from\x20backup','reset-history','Notifications\x20disabled','build2','No\x20authentication\x20token','uncaughtException','reset-password','remoteAddress','pidRefreshToken','place-order','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','/on\x20-\x20start\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20show\x20configuration','apiSecret','SIGTERM','Error:\x20Invalid\x20argument\x20','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','\x1b[35m','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','env','temporary\x20token\x20generated','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','api-eu.mixpanel.com','stopPolling','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','updatebotmanager','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','accept','login\x20token\x20valid','kind','148816FakoRx','/off\x20-\x20stop\x20bot(s)\x0a','Login\x20accepted','NTBA_FIX_319','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','isIPv4MappedAddress','verify','stringify','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','telegramIpApproval','sort','sockets','copyFileSync','emit','add-bot','push','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','toIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20get\x20events','\x1b[34m','All','settings.','format','referer','from','bot-','getFullYear','user','logs/','range','Yes','restore-backup-file','<b>Telegram\x20Bot\x20Status:</b>\x0a','function','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Crypt','</b>\x20?','family','exchange','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','\x20|\x20','exp','sign','new','2FA\x20required','update','version','10YzAeJU','disabled','getDate','$1_$2_$3','event','/:bot/coins','sendMessage','connection','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','getPortfolio','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','reason','slice','send','Unauthorized\x20attempt\x20to\x20update\x20settings','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','alerts','unlinkSync','initclient','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Setting\x20access:\x20','existsSync','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','pidExpireLogin','reload','log','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','File\x20uploaded','\x20>\x20','deleteHistoryAlerts','Invalid\x20authentication\x20token\x20(2)','telegrammsg','secret','mtime','-----------------------------------------------------------------------------------','any','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','login\x20token\x20generated','invalid\x20credentials','hex','0.0.0','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','\x1b[36m','Deleted\x20Bot\x20','telegramUsername','Ok,\x20will\x20send\x20alert\x20notifications\x20only','isValid','child_process','match','Invalid\x20authentication\x20token\x20(1)','max','kill','test','/:bot/support','cloneDeep','689500XltNpf','running','Invalid\x20Telegram\x20token','get-logs','/status\x20-\x20show\x20bot(s)\x20status\x0a','update-bot','sortBy','1070181ofpGwz','lastmsgtelegram','login','getTime','data','Bot\x20','https://api.ipify.org?format=json','hasOwnProperty','debug','bbvReceive','forEach','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','express-fileupload','lastmsgemitted','temporaryAccessAllowed','\x20|\x20client:\x20...','index.html','jsonwebtoken','cancel-loading','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','bb-settings.json','telegramChatId','RSA-OAEP','-results.json','split','includes','bbPassword','get-backup-files','address','getStartingBalances','ipv6','Notifications\x20enabled','file','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Server','simple','Unauthorized\x20attempt\x20to\x20delete\x20alerts','telegram2FaApproval','update-bb','(((.+)+)+)+$','resetHistory','/disable\x20-\x20disable\x20notifications\x0a','date-fns','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Enabled\x20Bot\x20','confirm-message','/metrics\x20-\x20show\x20bot\x20performance\x0a','2FA\x20login\x20required','yes',':\x20Bot\x20Mgr\x20>\x20','reinstall','backup-full','Logged\x20out\x20user\x20...','[ip-address]','output-002.log','number','temp/','Ok,\x20will\x20send\x20order\x20notifications\x20only','hashSync','3zHlZtu','Access\x20enabled\x20for\x20','1465080EvYpkP','/download/:type','mode','join','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','inherit','lowdb','alias','removeListener','constructor','files','/:bot','started','writeFileSync','internal','host','Invalid\x20username\x20or\x20IP\x20address','replace','2499211kZbYAf','clientip','telegramEnabled','chat','static','5\x20min','settings','Restore\x20backup\x20file\x20','store','No\x20bots\x20running\x20right\x20now','auto','secure','Starting\x20bot\x20|\x20Bot\x20','Login\x20rejected','toggle-bot-mode','find','sendPortfolioTelegram',',\x20must\x20be\x20a\x204\x20digit\x20number','password','request','yargs/yargs','full','binary','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Notifications\x20disabled\x0a','polling_error','temporary\x20access\x20rejected','output-003.log','bbUsername'];_0x52e8=function(){return _0x2bfb12;};return _0x52e8();}function updateSetting(_0x3c0603,_0x3758e5){const _0x1ae68c=_0x2b0fc2;dbSettings[_0x1ae68c(0x257)](_0x1ae68c(0x325)+_0x3c0603,_0x3758e5)[_0x1ae68c(0x28d)](),settings=getSettings(),io['to'](_0x1ae68c(0x277))[_0x1ae68c(0x31d)](_0x1ae68c(0x1f1),cleanSettings());}function storeSecure(_0x43825e){const _0x1b68f8=_0x2b0fc2;dbSecure[_0x1b68f8(0x210)](_0x1b68f8(0x1f6))[_0x1b68f8(0x31f)](_0x43825e)['write'](),secure=_0x43825e;}function addBlacklist(_0x7d38de){const _0x33755a=_0x2b0fc2;cleanBlacklist();let _0x1a2718;devices[_0x7d38de][_0x33755a(0x319)]?_0x1a2718=Math[_0x33755a(0x371)](devices[_0x7d38de][_0x33755a(0x319)]['expiry'],loginExpiry):_0x1a2718=loginExpiry,dbSecure['get'](_0x33755a(0x2c4))['push']({'expiry':new Date()[_0x33755a(0x380)]()+_0x1a2718*0x3c*0x3e8,'token':devices[_0x7d38de][_0x33755a(0x233)]['token']})['write'](),blacklist=dbSecure[_0x33755a(0x210)](_0x33755a(0x2c4))[_0x33755a(0x213)]();}function cleanBlacklist(){const _0x150545=_0x2b0fc2;let _0x4be0fc=dbSecure[_0x150545(0x210)]('blacklist')[_0x150545(0x375)]()[_0x150545(0x213)](),_0x1bd63e=new Date()[_0x150545(0x380)]();_0x4be0fc[_0x150545(0x387)](_0x55323b=>{const _0x37ea2c=_0x150545;_0x55323b[_0x37ea2c(0x2b8)]<_0x1bd63e&&dbSecure[_0x37ea2c(0x210)]('blacklist')[_0x37ea2c(0x254)]({'expiry':_0x55323b[_0x37ea2c(0x2b8)]})[_0x37ea2c(0x28d)]();});}function initStates(){const _0x9e119=_0x2b0fc2;let _0x8337cb=getConfiguration();_0x8337cb[_0x9e119(0x387)](_0x1323f4=>{const _0x54ac59=_0x9e119;_0x1323f4[_0x54ac59(0x23a)]=_0x54ac59(0x236);}),storeConfiguration(_0x8337cb);}function _0x2ca7(_0x4bb5b8,_0x53073c){const _0x4e4259=_0x52e8();return _0x2ca7=function(_0xd7ec0c,_0x2b7f81){_0xd7ec0c=_0xd7ec0c-0x1de;let _0x52e89d=_0x4e4259[_0xd7ec0c];return _0x52e89d;},_0x2ca7(_0x4bb5b8,_0x53073c);}function onKeys(){const _0x2b8343=new RSA();return new Promise(_0x115436=>{const _0x10c98e=_0x2ca7;_0x2b8343[_0x10c98e(0x23d)]()['then'](_0x35effc=>{_0x115436(_0x35effc);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2eab10=_0x2b0fc2;let _0x3988d4=getSettings(),_0x42397c=![];!_0x3988d4[_0x2eab10(0x384)]('lastmsgtelegram')&&(_0x3988d4['lastmsgtelegram']=0x0,_0x42397c=!![]);!_0x3988d4[_0x2eab10(0x384)](_0x2eab10(0x38a))&&(_0x3988d4[_0x2eab10(0x38a)]=0x0,_0x42397c=!![]);!_0x3988d4[_0x2eab10(0x384)](_0x2eab10(0x27e))&&(_0x3988d4[_0x2eab10(0x27e)]=_0x2eab10(0x367),_0x42397c=!![]);!_0x3988d4[_0x2eab10(0x384)]('onepagemode')&&(_0x3988d4[_0x2eab10(0x2e5)]=![],_0x42397c=!![]);if(_0x42397c)storeSettings(_0x3988d4);try{fs[_0x2eab10(0x209)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0xaa1564=>{const _0x5162bd=_0x2eab10;if(!_0xaa1564[_0x5162bd(0x20b)]()){if(!_0xaa1564[_0x5162bd(0x27f)][_0x5162bd(0x2c6)]('backup-full@'))fs[_0x5162bd(0x350)](configbackuppath+_0xaa1564[_0x5162bd(0x27f)]);}else fs[_0x5162bd(0x2af)](configbackuppath+_0xaa1564[_0x5162bd(0x27f)],{'recursive':!![]});});}catch(_0x4dc419){logger[_0x2eab10(0x385)]('Error\x20removing\x20old\x20backup\x20files:',_0x4dc419);}}function storeConfiguration(_0x27ad48){const _0x4f7d86=_0x2b0fc2;dbConfig[_0x4f7d86(0x210)](_0x4f7d86(0x2a1))[_0x4f7d86(0x254)]()[_0x4f7d86(0x28d)](),_0x27ad48[_0x4f7d86(0x387)](_0x11324b=>{const _0x4d1d12=_0x4f7d86;delete _0x11324b[_0x4d1d12(0x3bc)];}),dbConfig[_0x4f7d86(0x210)](_0x4f7d86(0x2a1))[_0x4f7d86(0x31f)](..._0x27ad48)[_0x4f7d86(0x28d)](),config=_0x27ad48;}function resetPassword(){const _0x351fd6=_0x2b0fc2;tgBot&&settings[_0x351fd6(0x392)]&&(tgBot[_0x351fd6(0x1e1)](_0x351fd6(0x273)),tgBot['sendMessage'](settings[_0x351fd6(0x392)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x351fd6(0x25e),'reply_markup':{'inline_keyboard':[[{'text':_0x351fd6(0x3ad),'callback_data':_0x351fd6(0x3ad)},{'text':'no','callback_data':'no'}]]}})[_0x351fd6(0x28b)](_0x2875af=>{telegramError(_0x2875af);}),tgBot['on'](_0x351fd6(0x273),async _0x4a971c=>{const _0x1ffad5=_0x351fd6,_0x1fe0af=_0x4a971c[_0x1ffad5(0x381)],_0x32a2d8=_0x4a971c[_0x1ffad5(0x2ac)];tgBot[_0x1ffad5(0x21d)](_0x4a971c['id'])[_0x1ffad5(0x2dd)](async()=>{const _0x497d66=_0x1ffad5;if(_0x1fe0af!='no'){const _0x36eeef=0xf,_0x3f9ee7='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0xa74e90=Array[_0x497d66(0x328)](crypto['randomFillSync'](new Uint32Array(_0x36eeef)))[_0x497d66(0x2e7)](_0x10f0ce=>_0x3f9ee7[_0x10f0ce%_0x3f9ee7[_0x497d66(0x2d7)]])['join'](''),_0x1d4ac8=bcrypt['hashSync'](_0xa74e90,saltRounds);storeSettings({'bbPassword':_0x1d4ac8}),await tgBot[_0x497d66(0x345)](_0x32a2d8[_0x497d66(0x1ee)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0xa74e90,{'parse_mode':'HTML'})[_0x497d66(0x28b)](_0x3e9bae=>{telegramError(_0x3e9bae);});}else await tgBot[_0x497d66(0x345)](_0x32a2d8[_0x497d66(0x1ee)]['id'],_0x497d66(0x26d))[_0x497d66(0x28b)](_0x425f30=>{telegramError(_0x425f30);});}),tgBot['removeListener']('callback_query');}));}async function confirmRestore(_0x5138a0,_0x1c75cc){const _0x16fae3=_0x2b0fc2;io['to'](_0x16fae3(0x277))['emit'](_0x16fae3(0x235),_0x16fae3(0x39e),_0x16fae3(0x24f)),tgBot&&settings[_0x16fae3(0x392)]&&(tgBot[_0x16fae3(0x1e1)](_0x16fae3(0x273)),await tgBot['sendMessage'](settings[_0x16fae3(0x392)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x16fae3(0x3ad),'callback_data':_0x16fae3(0x3ad)},{'text':'no','callback_data':'no'}]]}})[_0x16fae3(0x28b)](_0x3c407b=>{telegramError(_0x3c407b);}),tgBot['on'](_0x16fae3(0x273),async _0x265826=>{const _0x5292a6=_0x16fae3,_0x58bb8d=_0x265826[_0x5292a6(0x381)],_0x30ed17=_0x265826['message'];tgBot[_0x5292a6(0x21d)](_0x265826['id'])[_0x5292a6(0x2dd)](async()=>{const _0x5e6835=_0x5292a6;_0x58bb8d=='yes'?(await tgBot[_0x5e6835(0x345)](_0x30ed17[_0x5e6835(0x1ee)]['id'],_0x5e6835(0x2f1),{'parse_mode':'HTML'})[_0x5e6835(0x28b)](_0x3fb63a=>{telegramError(_0x3fb63a);}),unzipFile(_0x5138a0,_0x1c75cc)):(logger[_0x5e6835(0x385)](_0x5e6835(0x226)),await tgBot[_0x5e6835(0x345)](_0x30ed17[_0x5e6835(0x1ee)]['id'],_0x5e6835(0x226))['catch'](_0x566879=>{telegramError(_0x566879);}));}),tgBot['removeListener'](_0x5292a6(0x273));}));}function getServerTime(){const _0x23dbff=_0x2b0fc2,_0x388ee0=new Date();return _0x388ee0[_0x23dbff(0x32a)]()+'/'+(_0x388ee0[_0x23dbff(0x24b)]()+0x1)[_0x23dbff(0x29e)]()[_0x23dbff(0x2a8)](0x2,'0')+'/'+_0x388ee0[_0x23dbff(0x341)]()['toString']()[_0x23dbff(0x2a8)](0x2,'0')+'\x20'+_0x388ee0[_0x23dbff(0x2ed)]()[_0x23dbff(0x29e)]()[_0x23dbff(0x2a8)](0x2,'0')+':'+_0x388ee0[_0x23dbff(0x2b3)]()['toString']()['padStart'](0x2,'0')+':'+_0x388ee0[_0x23dbff(0x2cd)]()[_0x23dbff(0x29e)]()[_0x23dbff(0x2a8)](0x2,'0');}function getTimeStamp(){const _0x328968=_0x2b0fc2,_0x183e9d=shiftedTime();return _0x183e9d['getFullYear']()+'/'+(_0x183e9d[_0x328968(0x24b)]()+0x1)[_0x328968(0x29e)]()[_0x328968(0x2a8)](0x2,'0')+'/'+_0x183e9d['getDate']()[_0x328968(0x29e)]()['padStart'](0x2,'0')+'\x20'+_0x183e9d[_0x328968(0x2ed)]()['toString']()[_0x328968(0x2a8)](0x2,'0')+':'+_0x183e9d['getMinutes']()['toString']()['padStart'](0x2,'0')+':'+_0x183e9d[_0x328968(0x2cd)]()[_0x328968(0x29e)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x1913e3=_0x2b0fc2,_0x3b381a=shiftedTime();return _0x3b381a[_0x1913e3(0x32a)]()+(_0x3b381a[_0x1913e3(0x24b)]()+0x1)[_0x1913e3(0x29e)]()[_0x1913e3(0x2a8)](0x2,'0')+_0x3b381a[_0x1913e3(0x341)]()[_0x1913e3(0x29e)]()[_0x1913e3(0x2a8)](0x2,'0')+'-'+_0x3b381a[_0x1913e3(0x2ed)]()[_0x1913e3(0x29e)]()[_0x1913e3(0x2a8)](0x2,'0')+_0x3b381a[_0x1913e3(0x2b3)]()[_0x1913e3(0x29e)]()[_0x1913e3(0x2a8)](0x2,'0')+_0x3b381a['getSeconds']()[_0x1913e3(0x29e)]()[_0x1913e3(0x2a8)](0x2,'0');}function shiftedTime(){const _0x27cfd7=_0x2b0fc2,_0x207301=new Date();let _0x19b5c9=_0x207301;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x19b5c9=fns['add'](_0x207301,{'hours':settings[_0x27cfd7(0x215)]});return _0x19b5c9;}function startScheduler(){const _0x4dc401=_0x2b0fc2,_0x3a46e4=new Date()[_0x4dc401(0x272)](),_0x130cd0=shiftedTime()[_0x4dc401(0x2ed)]();_0x130cd0==0x4&&backupConfigFiles();_0x130cd0==0x0&&rotateLogFiles();_0x3a46e4%0x6==0x0&&triggerAnalytics();_0x3a46e4%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x267415){const _0x48a353=_0x2b0fc2;logger['debug'](_0x48a353(0x1f2)+_0x267415);const _0x388c8e=getBotsWithMode();_0x388c8e[_0x48a353(0x2d7)]>0x0?confirmRestore(configbackuppath,_0x267415):unzipFile(configbackuppath,_0x267415);}async function getBackupFiles(_0x3885fb=null){const _0x3e58d8=_0x2b0fc2;let _0x3b149d=[],_0x3adb28=fs[_0x3e58d8(0x209)](configbackuppath,{'withFileTypes':!![]});_0x3adb28[_0x3e58d8(0x31a)]((_0x273126,_0x905be1)=>_0x273126['name']<_0x905be1[_0x3e58d8(0x27f)]?0x1:_0x905be1[_0x3e58d8(0x27f)]<_0x273126[_0x3e58d8(0x27f)]?-0x1:0x0),_0x3adb28[_0x3e58d8(0x387)](_0xb2a1f0=>{const _0x565e8d=_0x3e58d8;if(!_0xb2a1f0[_0x565e8d(0x20b)]()&&_0xb2a1f0[_0x565e8d(0x27f)][_0x565e8d(0x2c6)](_0x565e8d(0x246))&&_0xb2a1f0[_0x565e8d(0x27f)][_0x565e8d(0x2cf)](_0x565e8d(0x2e1))){const _0x2f7b24=formatDate(fs['statSync'](configbackuppath+_0xb2a1f0['name'])[_0x565e8d(0x360)]);_0x3b149d[_0x565e8d(0x31f)]({'name':_0xb2a1f0[_0x565e8d(0x27f)],'mtime':_0x2f7b24});}});if(_0x3885fb)io['to'](_0x3885fb)[_0x3e58d8(0x31d)]('backup-files',_0x3b149d);else return _0x3b149d;}async function backupConfigFiles(){const _0x3b4e40=_0x2b0fc2;await zipFiles(_0x3b4e40(0x3b0));const _0x457956=getCleanTimeStamp();fs[_0x3b4e40(0x31c)](zippath+_0x3b4e40(0x231),configbackuppath+(_0x3b4e40(0x246)+_0x457956+_0x3b4e40(0x2e1)));let _0x5e0c30=fs[_0x3b4e40(0x209)](configbackuppath,{'withFileTypes':!![]});_0x5e0c30[_0x3b4e40(0x31a)]((_0x4f30bc,_0x417d48)=>_0x4f30bc[_0x3b4e40(0x27f)]<_0x417d48[_0x3b4e40(0x27f)]?0x1:_0x417d48[_0x3b4e40(0x27f)]<_0x4f30bc[_0x3b4e40(0x27f)]?-0x1:0x0),_0x5e0c30[_0x3b4e40(0x2d7)]>maxBackups&&fs[_0x3b4e40(0x350)](configbackuppath+_0x5e0c30[_0x5e0c30[_0x3b4e40(0x2d7)]-0x1][_0x3b4e40(0x27f)]);}function rotateLogFiles(){const _0xf781fc=_0x2b0fc2,_0x12fdba=fs[_0xf781fc(0x2d9)](logspath+'output-000.log'),_0x3437e9=_0x12fdba['size']/0x400;if(_0x3437e9>0x64){let _0x2f9609=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x2f9609[_0xf781fc(0x31a)]((_0x442e78,_0x2d2e34)=>_0x442e78[_0xf781fc(0x27f)]<_0x2d2e34['name']?0x1:_0x2d2e34['name']<_0x442e78[_0xf781fc(0x27f)]?-0x1:0x0),_0x2f9609[_0xf781fc(0x387)](_0x2dbc1c=>{const _0x5f18e3=_0xf781fc;if(_0x2dbc1c['name']==_0x5f18e3(0x3b3))fs[_0x5f18e3(0x31c)](logspath+_0x2dbc1c['name'],logspath+_0x5f18e3(0x206));if(_0x2dbc1c[_0x5f18e3(0x27f)]==_0x5f18e3(0x29b))fs['copyFileSync'](logspath+_0x2dbc1c[_0x5f18e3(0x27f)],logspath+_0x5f18e3(0x3b3));_0x2dbc1c[_0x5f18e3(0x27f)]==_0x5f18e3(0x239)&&(fs[_0x5f18e3(0x31c)](logspath+_0x2dbc1c[_0x5f18e3(0x27f)],logspath+_0x5f18e3(0x29b)),fs[_0x5f18e3(0x1e6)](logspath+_0x2dbc1c[_0x5f18e3(0x27f)],''));});}}async function zipFiles(_0x1136f0){const _0x1b25db=_0x2b0fc2;let _0x3d3b68;if(_0x1136f0=='logs')_0x3d3b68=logspath;if(_0x1136f0==_0x1b25db(0x222))_0x3d3b68=configpath;if(_0x1136f0=='backup-full')_0x3d3b68=configpath;let _0x26f662=fs['readdirSync'](_0x3d3b68,{'withFileTypes':!![]});const _0x2195a9=new require(_0x1b25db(0x2d1))();_0x26f662[_0x1b25db(0x387)](_0x5342b8=>{const _0x489476=_0x1b25db;if(!_0x5342b8[_0x489476(0x20b)]()){let _0x164bad=fs[_0x489476(0x287)](_0x3d3b68+_0x5342b8[_0x489476(0x27f)]);if(_0x1136f0==_0x489476(0x222)){const _0xb77e3f=/^bot-[0-9]{3}-config.json$/,_0xd393a2=_0xb77e3f[_0x489476(0x373)](_0x5342b8[_0x489476(0x27f)]);if(_0xd393a2){const _0x2c4b58=JSON[_0x489476(0x230)](_0x164bad);if(_0x2c4b58[_0x489476(0x256)][0x0]){_0x2c4b58['bot'][0x0][_0x489476(0x296)]=_0x489476(0x266),_0x2c4b58[_0x489476(0x256)][0x0][_0x489476(0x2ff)]=_0x489476(0x266);if(_0x2c4b58[_0x489476(0x256)][0x0]['apiPassword'])_0x2c4b58[_0x489476(0x256)][0x0]['apiPassword']='***';}_0x164bad=JSON['stringify'](_0x2c4b58,null,0x2);}if(_0x5342b8[_0x489476(0x27f)]==_0x489476(0x391)){const _0x3a2f23=JSON['parse'](_0x164bad);if(_0x3a2f23[_0x489476(0x1f1)]['loginRequired'])_0x3a2f23['settings']['loginRequired']=![];if(_0x3a2f23[_0x489476(0x1f1)]['bbPassword'])_0x3a2f23[_0x489476(0x1f1)]['bbPassword']='***';if(_0x3a2f23['settings'][_0x489476(0x261)])_0x3a2f23[_0x489476(0x1f1)][_0x489476(0x261)]=_0x489476(0x266);if(_0x3a2f23['settings'][_0x489476(0x392)])_0x3a2f23[_0x489476(0x1f1)][_0x489476(0x392)]=null;_0x164bad=JSON['stringify'](_0x3a2f23,null,0x2);}if(_0x5342b8[_0x489476(0x27f)]!='bb-secure.json')_0x2195a9[_0x489476(0x39d)](_0x5342b8[_0x489476(0x27f)],_0x164bad);}else _0x2195a9[_0x489476(0x39d)](_0x5342b8[_0x489476(0x27f)],_0x164bad);}});const _0x2ea896=_0x2195a9[_0x1b25db(0x25f)]({'base64':![],'compression':_0x1b25db(0x2be)});fs['writeFileSync'](zippath+(_0x1136f0+'.zip'),_0x2ea896,_0x1b25db(0x201));}async function unzipFile(_0x3fc83c,_0xa7cec4){const _0xc33c11=_0x2b0fc2;fs[_0xc33c11(0x209)](configpath,{'withFileTypes':!![]})[_0xc33c11(0x387)](_0x3e7073=>{const _0x535002=_0xc33c11;if(!_0x3e7073['isDirectory']())fs[_0x535002(0x2af)](configpath+_0x3e7073['name']);});const _0x77e2f0=fs['readFileSync'](_0x3fc83c+_0xa7cec4,_0xc33c11(0x201)),_0x2beca9=new require(_0xc33c11(0x2d1))(_0x77e2f0,{'base64':![],'checkCRC32':!![]});Object[_0xc33c11(0x26e)](_0x2beca9['files'])[_0xc33c11(0x387)](_0x591dec=>{const _0x53a156=_0xc33c11,_0x5b3d89=_0x2beca9[_0x53a156(0x1e3)][_0x591dec];fs[_0x53a156(0x1e6)](configpath+_0x5b3d89['name'],_0x5b3d89[_0x53a156(0x2b7)]);}),fs[_0xc33c11(0x209)](temppath,{'withFileTypes':!![]})[_0xc33c11(0x387)](_0x22e184=>{const _0x5c8c1b=_0xc33c11;if(!_0x22e184['isDirectory']())fs['rmSync'](temppath+_0x22e184[_0x5c8c1b(0x27f)]);}),logger[_0xc33c11(0x385)]('Backup\x20file\x20unzipped\x20and\x20stored'),process['send']({'restore':!![]},_0x2c60de=>{});}async function getPublicIp(){const _0x32fee7=_0x2b0fc2;try{const _0x342575=await axios['get'](_0x32fee7(0x383));publicip=_0x342575[_0x32fee7(0x381)]['ip'];}catch(_0x1bc474){}}async function triggerAnalytics(){const _0x2a3b5b=_0x2b0fc2;if(!publicip)await getPublicIp();const _0x5ac782=getBotsWithMode();let _0x7e0810=0x0;_0x5ac782[_0x2a3b5b(0x387)](_0x2c0225=>{const _0x4eece7=_0x2a3b5b;if(_0x2c0225[_0x4eece7(0x218)]===_0x4eece7(0x23c))_0x7e0810++;});const _0x2e5323=getBotExchanges();mixpanel['track'](_0x2a3b5b(0x39f),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x5ac782[_0x2a3b5b(0x2d7)],'numbotsenabled':_0x7e0810,'exchanges':_0x2e5323});}async function getMessages(){const _0x556a14=_0x2b0fc2,_0x3044c2='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x2421cb=new GraphQLClient(_0x3044c2),_0x5c2afd={'authorization':_0x556a14(0x2c5)},_0x2f51c2=serverversion[_0x556a14(0x395)]('.'),_0x3ea058=_0x2f51c2[0x0]+'.'+_0x2f51c2[0x1],_0x47aa75=Math[_0x556a14(0x2b9)](settings[_0x556a14(0x37e)],settings[_0x556a14(0x38a)]),_0x1b97df={'last':parseInt(_0x47aa75),'bbm':_0x3ea058},_0x159856=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x36843b;try{_0x36843b=await _0x2421cb[_0x556a14(0x1fe)](_0x159856,_0x1b97df,_0x5c2afd);}catch(_0x156bbc){}if(_0x36843b&&_0x36843b['messages']){let _0x1c52bd=settings[_0x556a14(0x37e)];newMessages=[];for(const _0x4c1bd1 of _0x36843b['messages']){newMessages[_0x556a14(0x31f)](_0x4c1bd1);if(_0x4c1bd1[_0x556a14(0x279)])updateSetting(_0x556a14(0x27e),_0x4c1bd1[_0x556a14(0x279)]);let _0x2505d8=_0x4c1bd1[_0x556a14(0x279)]?serverversion>=_0x4c1bd1[_0x556a14(0x279)]:![];if(!_0x2505d8&&_0x4c1bd1[_0x556a14(0x3b4)]>_0x1c52bd){if(_0x4c1bd1[_0x556a14(0x386)]===_0x556a14(0x362)||serverversion[_0x556a14(0x2c6)](_0x4c1bd1['bbvReceive'])){let _0x2a35e1=''+_0x4c1bd1['title']+'\x0a\x0a'+_0x4c1bd1[_0x556a14(0x2ac)];const _0x2a0c1f=await sendTelegramMsg(toTelegramMarkdown(_0x2a35e1),_0x556a14(0x22d));if(_0x2a0c1f)_0x1c52bd=_0x4c1bd1[_0x556a14(0x3b4)];}}}updateAvailable=isNewerVersion(settings[_0x556a14(0x27e)],serverversion),updateSetting(_0x556a14(0x37e),_0x1c52bd),emitMessages();}}function emitMessages(){const _0x5be47d=_0x2b0fc2,_0x32857c=settings['lastmsgemitted'];let _0x273d54=[];newMessages['forEach'](_0x156272=>{const _0x3558b7=_0x2ca7;_0x156272[_0x3558b7(0x3b4)]>_0x32857c&&_0x273d54[_0x3558b7(0x31f)](_0x156272);}),_0x273d54[_0x5be47d(0x2d7)]>0x0&&getAllClients()['forEach'](_0x421a9f=>{const _0x43a1cb=_0x5be47d;getSocket(_0x421a9f['id'])[_0x43a1cb(0x31d)](_0x43a1cb(0x2ac),_0x273d54);});}function confirmMessage(_0x27c250){const _0x51c604=_0x2b0fc2;updateSetting(_0x51c604(0x38a),Number(_0x27c250));}function isNewerVersion(_0x43d982,_0x2d4abc){const _0x2d79e9=_0x2b0fc2,_0x15c601=_0x2d4abc[_0x2d79e9(0x395)]('.'),_0x31b578=_0x43d982[_0x2d79e9(0x395)]('.');for(var _0x351021=0x0;_0x351021<_0x31b578[_0x2d79e9(0x2d7)];_0x351021++){const _0x3cc25d=~~_0x31b578[_0x351021],_0x513562=~~_0x15c601[_0x351021];if(_0x3cc25d>_0x513562)return!![];if(_0x3cc25d<_0x513562)return![];}return![];}function toTelegramMarkdown(_0x59533e){const _0x519788=_0x2b0fc2,_0x30c9bf=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3dc3ac=/\*{2}(.+?)\*{2}/gim;return _0x59533e=_0x59533e[_0x519788(0x1ea)](_0x30c9bf,_0x519788(0x342))[_0x519788(0x1ea)](_0x3dc3ac,_0x519788(0x24e)),_0x59533e;}async function validateConfigFile(){const _0x5780a9=_0x2b0fc2,_0x3c6131=dbConfig[_0x5780a9(0x210)](_0x5780a9(0x2a1))['sortBy']('botID')[_0x5780a9(0x213)]()||[];if(_0x3c6131[_0x5780a9(0x2d7)]==0x0){let _0x1097ff=0x0,_0xa0dede=[];const _0x235ac6=/^bot-([0-9]{3})-config.json$/,_0x5db64e=fs[_0x5780a9(0x209)](configpath);_0x5db64e['forEach'](_0x17e8bf=>{const _0x1a1558=_0x5780a9,_0x54b08a=_0x235ac6['exec'](_0x17e8bf);if(_0x54b08a){const _0x2bfa0d=_0x54b08a[0x1];let _0x253a3d=getBotAttributes(_0x2bfa0d);_0xa0dede[_0x1a1558(0x31f)]({'botID':_0x2bfa0d,'botname':_0x253a3d['botname'],'status':'disabled','live':_0x1a1558(0x236)}),_0x1097ff++;}}),_0x1097ff!=0x0&&(dbConfig[_0x5780a9(0x210)](_0x5780a9(0x2a1))[_0x5780a9(0x28c)](_0xa0dede)[_0x5780a9(0x28d)](),config=_0xa0dede,restoredConfigFile=_0x1097ff);}}async function restoreConfigNotify(_0x4143be){const _0x309161=_0x2b0fc2;let _0x33def3;if(restoredConfigFile==0x1)_0x33def3=_0x309161(0x388);else _0x33def3=_0x309161(0x318);if(_0x4143be)io['to'](_0x309161(0x277))[_0x309161(0x31d)]('notification',_0x33def3);else{logger[_0x309161(0x3a0)](_0x309161(0x361)),logger[_0x309161(0x3a0)](_0x33def3),logger['simple'](_0x309161(0x361)),logger[_0x309161(0x3a0)]('');if(tgBot&&settings[_0x309161(0x392)]&&settings[_0x309161(0x225)]!=_0x309161(0x24d))tgBot[_0x309161(0x345)](settings['telegramChatId'],_0x309161(0x252)+_0x33def3)[_0x309161(0x28b)](_0x7ae530=>{telegramError(_0x7ae530);});}}function validateCredentials(_0x109942,_0x221b06){const _0x135897=_0x2b0fc2;if(_0x109942[_0x135897(0x2d8)]==settings[_0x135897(0x207)]&&bcrypt[_0x135897(0x2d6)](_0x109942[_0x135897(0x1fd)],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x135897(0x3ac),'token':null};else{const _0x1bc59a=generateLoginToken(_0x221b06);return{'allow':!![],'reason':_0x135897(0x364),'token':_0x1bc59a};}}else return{'allow':![],'reason':_0x135897(0x365),'token':null};}function refreshToken(_0x32acd1){const _0x31bd46=_0x2b0fc2,_0x15ec81=generateLoginToken(_0x32acd1);return{'allow':!![],'reason':_0x31bd46(0x364),'token':_0x15ec81};}function validateAccess(_0x2a2650,_0x5bd14c,_0xcedaae){const _0x3fd87=_0x2b0fc2,_0x32289f=_0xcedaae?_0xcedaae:devices[_0x5bd14c]['ip'];let _0x140598;const _0x45a86e=_0x302ca7=>{const _0x1b6ea3=_0x2ca7;if(settings['loginRequired']){if(settings[_0x1b6ea3(0x25c)]){if(telegram2FaApproved(_0x5bd14c)){const _0x5ac66b=generateLoginToken(_0x5bd14c);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x5ac66b};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x140598=validToken(_0x302ca7,_0x5bd14c),_0x140598[_0x1b6ea3(0x384)]('success')?{'allow':!![],'reason':_0x1b6ea3(0x30e),'token':_0x302ca7}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x1b6ea3(0x2b5),'token':null};};if(settings['whitelistEnabled']){let _0x2dbd3f=[...settings[_0x3fd87(0x2bb)],'::1',_0x3fd87(0x281),'127.0.0.1'];if(_0x2dbd3f[_0x3fd87(0x396)](_0x32289f))return _0x45a86e(_0x2a2650);else{_0x140598=validToken(_0x2a2650,_0x5bd14c);if(_0x140598[_0x3fd87(0x384)](_0x3fd87(0x24f)))return _0x45a86e(_0x2a2650);else{if(telegramIpApproved(_0x5bd14c)){const _0x391c84=generateToken(_0x5bd14c);return _0x140598=_0x45a86e(_0x2a2650),_0x140598[_0x3fd87(0x2ae)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x391c84}:_0x140598;}else return settings[_0x3fd87(0x38b)]?{'allow':![],'reason':_0x3fd87(0x33c),'token':null}:{'allow':![],'reason':_0x3fd87(0x2e3),'token':null};}}}else return _0x45a86e(_0x2a2650);}function timelyDecrypt(_0xa8920e,_0x41ba5a=!![]){const _0x4e4eb8=_0x2b0fc2;if(_0xa8920e)try{const _0x2f3b05=crypt[_0x4e4eb8(0x2c2)](secure[_0x4e4eb8(0x21a)],_0xa8920e)[_0x4e4eb8(0x2ac)],_0x1be966=_0x2f3b05[_0x4e4eb8(0x395)]('@')[0x0],_0x55f31b=_0x2f3b05[_0x4e4eb8(0x395)]('@')[0x1],_0x12d536=new Date()[_0x4e4eb8(0x380)]();if(_0x41ba5a){if(_0x12d536-_0x55f31b<maxSecretAge*0x3e8)return _0x1be966;else return![];}else return _0x1be966;}catch(_0x41c35d){return![];}else return![];}const validToken=(_0x5d0ed7,_0x278534)=>{const _0xd01ffa=_0x2b0fc2,_0x1de980=devices[_0x278534]['ip'];if(!_0x5d0ed7)return{'error':_0xd01ffa(0x2f5)};for(let _0x3c7e0f of blacklist){if(_0x3c7e0f['token']==_0x5d0ed7)return{'error':_0xd01ffa(0x258)};}let _0x14811c;try{_0x14811c=jwt[_0xd01ffa(0x316)](_0x5d0ed7,secure[_0xd01ffa(0x35f)]+_0x278534);}catch{return{'error':_0xd01ffa(0x370)};}if(!_0x14811c[_0xd01ffa(0x384)](_0xd01ffa(0x1ec))&&!_0x14811c[_0xd01ffa(0x384)](_0xd01ffa(0x2d8))||!_0x14811c[_0xd01ffa(0x384)](_0xd01ffa(0x339)))return{'error':_0xd01ffa(0x35d)};if(!_0x14811c[_0xd01ffa(0x384)](_0xd01ffa(0x2d8))&&_0x14811c['hasOwnProperty'](_0xd01ffa(0x1ec))){const {clientip:_0x5d09dc}=_0x14811c;return _0x1de980==_0x5d09dc?{'success':_0xd01ffa(0x259)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x14811c[_0xd01ffa(0x384)]('username')&&_0x14811c[_0xd01ffa(0x384)]('clientip')){const {username:_0x3bb597,clientip:_0x20c783}=_0x14811c;return settings[_0xd01ffa(0x207)]==_0x3bb597&&_0x1de980==_0x20c783?{'success':_0xd01ffa(0x259)}:{'error':_0xd01ffa(0x1e9)};}}},generateLoginToken=_0x3fbedd=>{const _0x9e11b3=_0x2b0fc2;if(_0x3fbedd){const _0x36e8ab=devices[_0x3fbedd]['ip'];return jwt[_0x9e11b3(0x33a)]({'username':settings['bbUsername'],'clientip':_0x36e8ab},secure[_0x9e11b3(0x35f)]+_0x3fbedd,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0xf5d3d9=>{const _0x4ab119=_0x2b0fc2;if(_0xf5d3d9){const _0x173e9e=devices[_0xf5d3d9]['ip'];return jwt[_0x4ab119(0x33a)]({'clientip':_0x173e9e},secure[_0x4ab119(0x35f)]+_0xf5d3d9,{'expiresIn':devices[_0xf5d3d9][_0x4ab119(0x319)][_0x4ab119(0x2b8)]*0x3c});}else return![];},telegramIpApproved=_0x138f17=>{const _0x4aae97=_0x2b0fc2;let _0x31224a=![];return devices[_0x138f17][_0x4aae97(0x319)]&&devices[_0x138f17][_0x4aae97(0x319)][_0x4aae97(0x2b8)]!=_0x4aae97(0x2e0)&&(_0x31224a=devices[_0x138f17][_0x4aae97(0x319)][_0x4aae97(0x1ec)]==devices[_0x138f17]['ip']&&new Date()['getTime']()-devices[_0x138f17]['telegramIpApproval'][_0x4aae97(0x24c)]<devices[_0x138f17][_0x4aae97(0x319)]['expiry']*0x3c*0x3e8),_0x31224a;},telegram2FaApproved=_0xe54828=>{const _0x11689a=_0x2b0fc2;let _0x23e62c=![];return devices[_0xe54828]['telegram2FaApproval']&&devices[_0xe54828][_0x11689a(0x3a2)][_0x11689a(0x2b8)]!=_0x11689a(0x2e0)&&(_0x23e62c=devices[_0xe54828][_0x11689a(0x3a2)][_0x11689a(0x1ec)]==devices[_0xe54828]['ip']&&new Date()['getTime']()-devices[_0xe54828][_0x11689a(0x3a2)][_0x11689a(0x24c)]<devices[_0xe54828]['telegram2FaApproval'][_0x11689a(0x2b8)]*0x3c*0x3e8),_0x23e62c;},normalizeIP=_0x3b9974=>{const _0x195f5c=_0x2b0fc2;let _0x23e738=null,_0x2c40cb=null;if(ipaddr[_0x195f5c(0x36d)](_0x3b9974)){const _0x32b9e1=ipaddr['parse'](_0x3b9974);_0x32b9e1[_0x195f5c(0x30f)]()===_0x195f5c(0x39b)?(_0x32b9e1[_0x195f5c(0x315)]()&&(_0x23e738=_0x32b9e1['toIPv4Address']()[_0x195f5c(0x29e)]()),_0x2c40cb=_0x32b9e1[_0x195f5c(0x29e)]()):(_0x23e738=_0x32b9e1['toString'](),_0x2c40cb=_0x32b9e1[_0x195f5c(0x321)]()[_0x195f5c(0x29e)]());}return{'show':_0x23e738?_0x23e738:_0x2c40cb,'store':_0x2c40cb};};function formatDate(_0x237ac6){const _0x2bd66c=_0x2b0fc2;return _0x237ac6[_0x2bd66c(0x32a)]()+'/'+(_0x237ac6[_0x2bd66c(0x24b)]()+0x1)[_0x2bd66c(0x29e)]()[_0x2bd66c(0x2a8)](0x2,'0')+'/'+_0x237ac6[_0x2bd66c(0x341)]()[_0x2bd66c(0x29e)]()[_0x2bd66c(0x2a8)](0x2,'0')+'\x20'+_0x237ac6['getHours']()[_0x2bd66c(0x29e)]()[_0x2bd66c(0x2a8)](0x2,'0')+':'+_0x237ac6[_0x2bd66c(0x2b3)]()[_0x2bd66c(0x29e)]()['padStart'](0x2,'0')+':'+_0x237ac6[_0x2bd66c(0x2cd)]()[_0x2bd66c(0x29e)]()[_0x2bd66c(0x2a8)](0x2,'0');}function sleep(_0x1bde4c){return new Promise(_0x1d7892=>setTimeout(_0x1d7892,_0x1bde4c));}