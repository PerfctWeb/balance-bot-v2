const _0xab0e8e=_0x5e43;(function(_0x15e928,_0x1c5eeb){const _0x43dbfb=_0x5e43,_0x3d0552=_0x15e928();while(!![]){try{const _0xe471f7=parseInt(_0x43dbfb(0x2c1))/0x1+parseInt(_0x43dbfb(0x279))/0x2*(-parseInt(_0x43dbfb(0x159))/0x3)+parseInt(_0x43dbfb(0x227))/0x4*(parseInt(_0x43dbfb(0x1a3))/0x5)+parseInt(_0x43dbfb(0x2d1))/0x6*(parseInt(_0x43dbfb(0x22c))/0x7)+-parseInt(_0x43dbfb(0x218))/0x8*(-parseInt(_0x43dbfb(0x295))/0x9)+-parseInt(_0x43dbfb(0x1c6))/0xa*(-parseInt(_0x43dbfb(0xcc))/0xb)+-parseInt(_0x43dbfb(0x25b))/0xc;if(_0xe471f7===_0x1c5eeb)break;else _0x3d0552['push'](_0x3d0552['shift']());}catch(_0x67985f){_0x3d0552['push'](_0x3d0552['shift']());}}}(_0x317f,0x67bdd));const _0x4e2341=function(){let _0x2fa019=!![];return function(_0x1e8969,_0x3cfe9b){const _0x3d23d4=_0x2fa019?function(){if(_0x3cfe9b){const _0x297151=_0x3cfe9b['apply'](_0x1e8969,arguments);return _0x3cfe9b=null,_0x297151;}}:function(){};return _0x2fa019=![],_0x3d23d4;};}(),_0x590538=_0x4e2341(this,function(){const _0x119980=_0x5e43;return _0x590538[_0x119980(0xf6)]()[_0x119980(0x2be)](_0x119980(0x27d))[_0x119980(0xf6)]()[_0x119980(0x1df)](_0x590538)[_0x119980(0x2be)](_0x119980(0x27d));});_0x590538();'use strict';process[_0xab0e8e(0x2cc)][_0xab0e8e(0xeb)]=0x1;const childProcess=require(_0xab0e8e(0x2a9)),fs=require('fs'),fns=require('date-fns'),low=require(_0xab0e8e(0x121)),FileSync=require(_0xab0e8e(0x296)),path=require('path'),crypto=require(_0xab0e8e(0x1e8)),forge=require(_0xab0e8e(0x2b7)),bcrypt=require('bcryptjs'),jwt=require(_0xab0e8e(0x2bf)),ipaddr=require(_0xab0e8e(0x241)),argv=require('yargs/yargs')(process[_0xab0e8e(0x1a6)][_0xab0e8e(0x20a)](0x2))['argv'],uuidRandom=require(_0xab0e8e(0x22a)),{Telegraf,Markup}=require(_0xab0e8e(0xd4)),Mixpanel=require(_0xab0e8e(0x221)),axios=require(_0xab0e8e(0x103)),{GraphQLClient,gql}=require(_0xab0e8e(0x1c9)),util=require(_0xab0e8e(0xfd)),fileUpload=require(_0xab0e8e(0x119)),{networkInterfaces}=require('os'),JSZip=require(_0xab0e8e(0x29c)),PORT=argv['port']||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0xab0e8e(0x248)](PORT)&&(console[_0xab0e8e(0x150)](_0xab0e8e(0x252)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0xab0e8e(0xed)](0x1));const HOST=argv[_0xab0e8e(0x209)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0xab0e8e(0x10c)][_0xab0e8e(0x1a5)];let bbpath=_0xab0e8e(0x272),bbpath2='';const botfile=_0xab0e8e(0x26f),configfile='bb-config.json',settingsfile='bb-settings.json',securefile=_0xab0e8e(0x28c),environment=require('./'+bbpath2+_0xab0e8e(0x291))[_0xab0e8e(0x14c)]||_0xab0e8e(0x116),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0xab0e8e(0x28b)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0xab0e8e(0x1f0)+userID+'/':bbpath+'config/',configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0xab0e8e(0x1ee)+userID+'/':bbpath+_0xab0e8e(0x1ee),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0xab0e8e(0x1e0),loggerfile=fs['createWriteStream'](logspath+_0xab0e8e(0xc6),{'flags':'a'}),temppath=userID?bbpath+_0xab0e8e(0xea)+userID+'/':bbpath+_0xab0e8e(0xea);!fs[_0xab0e8e(0x28b)](configpath)&&fs['mkdirSync'](configpath);!fs[_0xab0e8e(0x28b)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0xab0e8e(0x28b)](logspath)&&fs[_0xab0e8e(0x2b6)](logspath);!fs['existsSync'](zippath)&&fs[_0xab0e8e(0x2b6)](zippath);!fs[_0xab0e8e(0x28b)](temppath)&&fs[_0xab0e8e(0x2b6)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0xab0e8e(0x22e)]({'bots':[]})[_0xab0e8e(0x299)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0xab0e8e(0x22e)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0xab0e8e(0x299)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0xab0e8e(0x22e)]({'secure':{},'blacklist':[]})[_0xab0e8e(0x299)]();const saltRounds=0xa,mixpanel=Mixpanel[_0xab0e8e(0x112)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0xab0e8e(0x1e9)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0xab0e8e(0x10d)]&&(settings[_0xab0e8e(0x10d)]!=''&&settings[_0xab0e8e(0x10d)]!=_0xab0e8e(0x2b3))&&settings[_0xab0e8e(0xe1)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0xba80ee,_0x11a6db)=>{const _0x2e5d03=_0xab0e8e,_0x15790a=/#[A-Z]{3}#/g;if(typeof _0xba80ee=='string'){!_0x11a6db?_0xba80ee=_0xba80ee[_0x2e5d03(0x20f)](_0x15790a,''):(_0xba80ee=_0xba80ee['replace'](/#BLU#/g,'\x1b[34m'),_0xba80ee=_0xba80ee[_0x2e5d03(0x20f)](/#RED#/g,_0x2e5d03(0x1f6)),_0xba80ee=_0xba80ee[_0x2e5d03(0x20f)](/#YEL#/g,_0x2e5d03(0x128)),_0xba80ee=_0xba80ee[_0x2e5d03(0x20f)](/#MAG#/g,_0x2e5d03(0x185)),_0xba80ee=_0xba80ee[_0x2e5d03(0x20f)](/#CYA#/g,_0x2e5d03(0x156)),_0xba80ee=_0xba80ee[_0x2e5d03(0x20f)](/#RES#/g,_0x2e5d03(0x18e)));;}return _0xba80ee;},logger={'screen':_0x3e32cc=>{const _0x5eaf3b=_0xab0e8e;console[_0x5eaf3b(0x150)](parseColor(_0x3e32cc,!![]));},'simple':_0x4d2d61=>{const _0x4a8a34=_0xab0e8e;console[_0x4a8a34(0x150)](parseColor(_0x4d2d61,!![])),loggerfile[_0x4a8a34(0x299)](util[_0x4a8a34(0x1bc)](parseColor(_0x4d2d61,![]))+'\x0a');},'full':async _0x53ba4c=>{const _0x143949=_0xab0e8e,_0x45e5ee=getTimeStamp()+_0x143949(0x213)+_0x53ba4c;console[_0x143949(0x150)](parseColor(_0x45e5ee,!![])),loggerfile[_0x143949(0x299)](util[_0x143949(0x1bc)](parseColor(_0x45e5ee,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x143949(0x23f)]!='orders')await sendTelegram(settings[_0x143949(0x21c)],_0x143949(0x107)+parseColor(_0x53ba4c,![]));},'debug':async(_0x3cd87c,_0xafb049='')=>{const _0x3bce87=_0xab0e8e,_0x8f6d4b=getTimeStamp()+_0x3bce87(0x1c5)+_0x3cd87c;if(debugging)console[_0x3bce87(0x150)](parseColor(_0x8f6d4b,!![]));loggerfile[_0x3bce87(0x299)](util[_0x3bce87(0x1bc)](parseColor(_0x8f6d4b,![]))+'\x0a');if(_0xafb049){if(debugging)console[_0x3bce87(0x150)](_0xafb049);loggerfile[_0x3bce87(0x299)](util['format'](_0xafb049)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x5c7443){const _0x2258fc=_0xab0e8e;_0x5c7443[_0x2258fc(0xf6)]()['includes'](_0x2258fc(0x215))?(logger['simple'](_0x2258fc(0x126)+_0x5c7443['port']+_0x2258fc(0x2b0)),process[_0x2258fc(0x28f)]({'terminate':!![]},_0x2a9864=>{})):logger[_0x2258fc(0x1f5)](_0x5c7443);}),process['on'](_0xab0e8e(0xed),()=>{const _0x4d356e=_0xab0e8e;stopAllBots(),process[_0x4d356e(0xed)](0x0);}),process['on'](_0xab0e8e(0x2a4),()=>{const _0x48fb7e=_0xab0e8e;stopAllBots(),process[_0x48fb7e(0xed)](0x0);}),process['on'](_0xab0e8e(0x191),()=>{const _0x4deca1=_0xab0e8e;stopAllBots(),process[_0x4deca1(0xed)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0xab0e8e(0x291))[_0xab0e8e(0x167)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0xab0e8e(0x1b9)),app=express(),http=require(_0xab0e8e(0x1c8))['createServer'](app);app[_0xab0e8e(0x1e4)](fileUpload({'useTempFiles':!![]})),app[_0xab0e8e(0x200)]('/download/:type',async(_0x1535e2,_0x4c9b42)=>{const _0x27c473=_0xab0e8e,_0x40367f=_0x1535e2[_0x27c473(0x152)][_0x27c473(0x175)],_0x39e33b=getClientsWithBotID(_0x27c473(0x11b)),_0xa2c0a0=_0x1535e2['headers']['uuid'],_0x400c36=timelyDecrypt(_0xa2c0a0,![]),_0x1d8139=_0x39e33b[_0x27c473(0x190)](_0x5c2c7a=>_0x5c2c7a[_0x27c473(0x230)]==_0x400c36);if(_0x1d8139){const _0x11130d=normalizeIP(_0x1535e2[_0x27c473(0x20e)][_0x27c473(0x22d)])['store'],_0x18bf9f=_0x1535e2['headers']['tkn'];if(validateAccess(_0x18bf9f,_0x400c36,_0x11130d)[_0x27c473(0x195)])_0x40367f=='backup'&&await backupConfigFiles(),await zipFiles(_0x40367f),_0x4c9b42[_0x27c473(0x2af)](zippath+(_0x40367f+_0x27c473(0xf3)),_0x382dbd=>{const _0x54a49d=_0x27c473;_0x382dbd&&(logger[_0x54a49d(0x217)](_0x54a49d(0x271)+_0x40367f),logger['simple'](_0x382dbd));});else logger[_0x27c473(0x217)](_0x27c473(0x18b)+_0x40367f+_0x27c473(0x1f9));}else logger[_0x27c473(0x217)](_0x27c473(0x18b)+_0x40367f+'\x20(2)');}),app[_0xab0e8e(0x16d)](_0xab0e8e(0x15c),async(_0x5666c9,_0x52650e)=>{const _0x4883c0=_0xab0e8e,_0x815907=getClientsWithBotID(_0x4883c0(0x11b)),_0x56f1d8=_0x5666c9[_0x4883c0(0x18c)]['uuid'],_0x462f9e=timelyDecrypt(_0x56f1d8,![]),_0x57c594=_0x815907[_0x4883c0(0x190)](_0x4d9ea9=>_0x4d9ea9[_0x4883c0(0x230)]==_0x462f9e);logger[_0x4883c0(0xce)]('Backup\x20file\x20uploaded');if(_0x57c594){const _0x59b80d=normalizeIP(_0x5666c9['socket'][_0x4883c0(0x22d)])['store'],_0x110d6c=_0x5666c9[_0x4883c0(0x18c)][_0x4883c0(0x13f)];if(validateAccess(_0x110d6c,_0x462f9e,_0x59b80d)['allow']){if(_0x5666c9[_0x4883c0(0x1b1)]){const _0x3c17aa=_0x5666c9[_0x4883c0(0x1b1)][_0x4883c0(0x206)];await _0x3c17aa['mv'](temppath+_0x3c17aa[_0x4883c0(0xf5)]),_0x52650e[_0x4883c0(0x28f)]({'status':!![],'message':_0x4883c0(0x1ef)});const _0x3710f6=getBotsWithMode();_0x3710f6[_0x4883c0(0x147)]>0x0?confirmRestore(temppath,_0x3c17aa[_0x4883c0(0xf5)]):unzipFile(temppath,_0x3c17aa[_0x4883c0(0xf5)]);}}else logger[_0x4883c0(0x217)](_0x4883c0(0xd0));}else logger['full'](_0x4883c0(0x1a8));}),app['use'](express[_0xab0e8e(0x270)](path['join'](__dirname,bbpath2,'build2'))),app[_0xab0e8e(0x1e4)](express[_0xab0e8e(0x270)](path[_0xab0e8e(0x170)](__dirname,bbpath2,'build'))),app[_0xab0e8e(0x200)]('/',function(_0x24b972,_0x36ef4a){const _0x550125=_0xab0e8e;_0x36ef4a[_0x550125(0x21e)](path[_0x550125(0x170)](__dirname,bbpath2,'build2',_0x550125(0x1fa)));}),app[_0xab0e8e(0x200)](_0xab0e8e(0x26c),function(_0x4ef5fd,_0x205f73){const _0x5f87e=_0xab0e8e;_0x205f73[_0x5f87e(0x21e)](path[_0x5f87e(0x170)](__dirname,bbpath2,_0x5f87e(0xe6),_0x5f87e(0x1fa)));}),app[_0xab0e8e(0x200)]('/:bot/portfolio',(_0x4f0b86,_0x566065)=>{const _0x1c3eaf=_0xab0e8e;_0x566065['sendFile'](path[_0x1c3eaf(0x170)](__dirname,bbpath2,_0x1c3eaf(0xe6),_0x1c3eaf(0x1fa)));}),app[_0xab0e8e(0x200)](_0xab0e8e(0x235),(_0x3a1785,_0x10b799)=>{const _0x58210b=_0xab0e8e;_0x10b799[_0x58210b(0x21e)](path[_0x58210b(0x170)](__dirname,bbpath2,_0x58210b(0xe6),_0x58210b(0x1fa)));}),app['get']('/:bot/coins',(_0x456bce,_0xa96556)=>{const _0x59cc99=_0xab0e8e;_0xa96556[_0x59cc99(0x21e)](path[_0x59cc99(0x170)](__dirname,bbpath2,_0x59cc99(0xe6),_0x59cc99(0x1fa)));}),app[_0xab0e8e(0x200)](_0xab0e8e(0xd8),(_0x1cd091,_0x2160e1)=>{const _0x536775=_0xab0e8e;_0x2160e1[_0x536775(0x21e)](path[_0x536775(0x170)](__dirname,bbpath2,_0x536775(0xe6),'index.html'));}),app[_0xab0e8e(0x200)](_0xab0e8e(0x2d0),(_0x5112d6,_0x5ad410)=>{const _0xdf66d5=_0xab0e8e;_0x5ad410[_0xdf66d5(0x21e)](path['join'](__dirname,bbpath2,_0xdf66d5(0xe6),'index.html'));}),app[_0xab0e8e(0x200)](_0xab0e8e(0x1a1),(_0x13921e,_0x225d55)=>{const _0x12f979=_0xab0e8e;_0x225d55['sendFile'](path[_0x12f979(0x170)](__dirname,bbpath2,_0x12f979(0xe6),'index.html'));});if(HOST)http[_0xab0e8e(0x1e7)](PORT,HOST);else http['listen'](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x13d933=_0xab0e8e;let _0xc8b714=_0x13d933(0x1b2);const _0x2e7a19=networkInterfaces(),_0x54454f={};for(const _0x4766c3 of Object[_0x13d933(0x2bd)](_0x2e7a19)){for(const _0x56cd72 of _0x2e7a19[_0x4766c3]){if((_0x56cd72[_0x13d933(0x10e)]==_0x13d933(0x11c)||_0x56cd72['family']==0x4)&&!_0x56cd72[_0x13d933(0x2c2)]){const _0x4fbda9=ipaddr[_0x13d933(0x102)](_0x56cd72[_0x13d933(0x124)])['range']();_0x4fbda9!=_0x13d933(0x25c)&&(!_0x54454f[_0x4766c3]&&(_0x54454f[_0x4766c3]=[]),_0x54454f[_0x4766c3][_0x13d933(0x226)](_0x56cd72[_0x13d933(0x124)]),_0xc8b714=_0x56cd72['address']);}}}return{'serverip':_0xc8b714,'netinterfaces':_0x54454f};}async function startServer(){const _0x143e8d=_0xab0e8e,{serverip:_0x4e539b,netinterfaces:_0x10cfd7}=getServerIP();logger[_0x143e8d(0x1f5)](''),logger[_0x143e8d(0x1f5)]('-----------------------------------------------------------------------------------'),await logger[_0x143e8d(0x217)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x143e8d(0x251)+(environment==_0x143e8d(0x281)?'(staging)':'')+'\x0a'+(_0x143e8d(0x2a8)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x143e8d(0x1bf)+_0x4e539b+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger['simple']('-----------------------------------------------------------------------------------');if(config['length']!=0x0)for(const _0x3b9397 of config){const _0x4bc79b=_0x3b9397[_0x143e8d(0xc5)]=='auto'?'a':'m';if(_0x3b9397[_0x143e8d(0x293)]=='enabled'||_0x3b9397[_0x143e8d(0x293)]==_0x143e8d(0xfb))await logger['full'](_0x143e8d(0xc9)+_0x4bc79b+_0x143e8d(0x262)+_0x3b9397[_0x143e8d(0xe0)]+_0x143e8d(0x278)+_0x3b9397['botname']),startBot([_0x3b9397[_0x143e8d(0xe0)],userID],{'cwd':bbpath},function(_0x2613bb){const _0x5bb92c=_0x143e8d;if(_0x2613bb)logger[_0x5bb92c(0x217)](_0x2613bb);});else(_0x3b9397[_0x143e8d(0x293)]==_0x143e8d(0x1ff)||_0x3b9397[_0x143e8d(0x293)]==_0x143e8d(0x15d))&&await logger[_0x143e8d(0x217)](_0x143e8d(0x1da)+_0x4bc79b+_0x143e8d(0x282)+_0x3b9397['botID']+_0x143e8d(0x278)+_0x3b9397['botname']);}else!newBot&&logger[_0x143e8d(0x1f5)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x143e8d(0x1f5)](_0x143e8d(0xf9)),logger[_0x143e8d(0x1f5)](''),await logger[_0x143e8d(0xce)](_0x143e8d(0x1f2)+nodeversion),await logger[_0x143e8d(0xce)]('Network\x20Interfaces:',_0x10cfd7);}function startSocket(){io['on']('connection',_0x382f2d=>{const _0x56fd17=_0x5e43;let _0x5cd856,_0x203684,_0x59d520,_0x5181c8,_0x12be22;const _0x5180c2=_0x382f2d['handshake'][_0x56fd17(0x18c)][_0x56fd17(0x2b8)];_0x203684=_0x5180c2[_0x56fd17(0x2d2)](/bot[0-9]{3}/);if(_0x203684)_0x59d520=_0x203684[0x0]['match'](/[0-9]{3}/);if(_0x59d520)_0x5cd856=_0x59d520[0x0];else _0x5cd856=_0x56fd17(0x11b);const _0x4422d3=_0x382f2d['handshake'][_0x56fd17(0x196)]['encryptedUuid'];if(!_0x4422d3)_0x382f2d['emit'](_0x56fd17(0x293),{'publicKey':secure[_0x56fd17(0x277)]});else{_0x5181c8=timelyDecrypt(_0x4422d3,![]);if(!_0x5181c8)_0x382f2d['emit'](_0x56fd17(0x293),{'publicKey':secure[_0x56fd17(0x277)]});else{_0x12be22=normalizeIP(_0x382f2d[_0x56fd17(0x1c1)][_0x56fd17(0x22d)])[_0x56fd17(0x15b)];if(!devices[_0x5181c8])devices[_0x5181c8]={'uuid':_0x5181c8,'access':{'token':null}};devices[_0x5181c8]['ip']=_0x12be22;const _0x3e67e7=addClient(_0x382f2d['id'],_0x5181c8,_0x5cd856);setAccess(_0x3e67e7),emitMessages(),_0x382f2d['on'](_0x56fd17(0x1d1),_0x32b041=>{const _0x244144=_0x56fd17,_0xd5d5aa=timelyDecrypt(_0x32b041[_0x244144(0x25f)],!![],_0x244144(0x129));if(_0xd5d5aa){_0x32b041={'username':_0x32b041[_0x244144(0x186)],'password':_0xd5d5aa},devices[_0x5181c8][_0x244144(0x2a6)]=validateCredentials(_0x32b041,_0x5181c8);if(devices[_0x5181c8]['access'][_0x244144(0x195)]==![]&&devices[_0x5181c8][_0x244144(0x2a6)][_0x244144(0x204)]=='2FA\x20login\x20required')_0x382f2d[_0x244144(0x2c6)]('status',{'access':devices[_0x5181c8][_0x244144(0x2a6)]}),loginAccess2FA(_0x5181c8,_0x12be22);else{if(devices[_0x5181c8][_0x244144(0x2a6)][_0x244144(0x195)]==![]&&devices[_0x5181c8]['access'][_0x244144(0x204)]=='invalid\x20credentials')_0x382f2d['emit']('status',{'access':devices[_0x5181c8][_0x244144(0x2a6)]});else devices[_0x5181c8]['access'][_0x244144(0x195)]&&devices[_0x5181c8][_0x244144(0x2a6)][_0x244144(0x204)]==_0x244144(0xf8)&&(getClientsWithUuid(_0x5181c8)[_0x244144(0x134)](_0x1c9f0e=>{setAccess(_0x1c9f0e);}),logger[_0x244144(0xce)](_0x244144(0x1a0)+_0x5181c8[_0x244144(0x20a)](-0x8)),setTokenRefresh(_0x5181c8),setSessionTimeout(_0x244144(0x1d1),_0x5181c8));}}else logger[_0x244144(0x217)](_0x244144(0x2ad));}),_0x382f2d['on'](_0x56fd17(0x10a),()=>{resetPassword();}),_0x382f2d['on'](_0x56fd17(0x2bc),_0x5c1cbd=>{removeClient(_0x382f2d['id']);}),_0x5cd856==_0x56fd17(0x11b)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0xe04c7a){const _0x3e86d6=_0xab0e8e;if(_0xe04c7a!=_0x3e86d6(0x11b)&&config[_0x3e86d6(0x2c9)]!=''){if(pid[_0xe04c7a])pid[_0xe04c7a]['send']({'function':_0x3e86d6(0x163),'args':null});}_0xe04c7a!=_0x3e86d6(0x11b)&&broadcastToBots(_0x3e86d6(0x1b5),JSON[_0x3e86d6(0x298)](config));}function reloadBotManager(){const _0x2b4f40=_0xab0e8e;getClientsWithBotID('botmanager')[_0x2b4f40(0x134)](_0x284c8d=>{const _0x347296=_0x2b4f40;getSocket(_0x284c8d['id'])[_0x347296(0x2c6)](_0x347296(0x293),{'access':{'allow':![],'reason':_0x347296(0xff),'token':null}});});}function getSocket(_0x1ef4b2){const _0x293b75=_0xab0e8e,_0x3e8f8b=io[_0x293b75(0x2d3)][_0x293b75(0x200)]('/');return _0x3e8f8b['sockets'][_0x293b75(0x200)](_0x1ef4b2);}function setAccess(_0x5f2e13){const _0x19a006=_0xab0e8e,_0x19bf63=getSocket(_0x5f2e13['id']),_0x2eddab=_0x5f2e13[_0x19a006(0x230)],_0x3ffde6=_0x5f2e13[_0x19a006(0x22b)];devices[_0x2eddab][_0x19a006(0x2a6)]=validateAccess(devices[_0x2eddab][_0x19a006(0x2a6)][_0x19a006(0x1c2)],_0x2eddab),logger[_0x19a006(0xce)](_0x19a006(0x2a5)+devices[_0x2eddab][_0x19a006(0x2a6)][_0x19a006(0x204)]+_0x19a006(0x1dd)+_0x5f2e13['id'][_0x19a006(0x20a)](-0x8)+_0x19a006(0x144)+_0x2eddab[_0x19a006(0x20a)](-0x8)),_0x19bf63['join'](_0x2eddab);if(devices[_0x2eddab]['access'][_0x19a006(0x195)]){_0x19bf63['join'](_0x3ffde6);if(_0x3ffde6==_0x19a006(0x11b))initializeSocketBotManager(_0x19bf63);else initializeSocketBot(_0x19bf63);initClient(_0x3ffde6);}devices[_0x2eddab][_0x19a006(0x2a6)]['token']&&devices[_0x2eddab]['access'][_0x19a006(0x204)]==_0x19a006(0x260)&&setSessionTimeout(_0x19a006(0x12a),_0x2eddab),devices[_0x2eddab][_0x19a006(0x2a6)]['token']&&devices[_0x2eddab][_0x19a006(0x2a6)][_0x19a006(0x204)]==_0x19a006(0x16c)&&setSessionTimeout('login',_0x2eddab),_0x19bf63['emit'](_0x19a006(0x293),{'status':_0x5f2e13[_0x19a006(0x229)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2eddab][_0x19a006(0x2a6)],'externalip':devices[_0x2eddab]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x19a006(0x17d)],'validInstallation':validInstallation}),devices[_0x2eddab][_0x19a006(0x2a6)]['allow']==![]&&devices[_0x2eddab][_0x19a006(0x2a6)]['reason']==_0x19a006(0x157)&&temporaryAccess2FA(_0x2eddab,devices[_0x2eddab]['ip']);}function setSessionTimeout(_0x359ee9,_0x10a521){const _0x412318=_0xab0e8e;let _0x22ea78;if(_0x359ee9=='login')_0x22ea78=loginExpiry*0x3c*0x3e8;else _0x22ea78=devices[_0x10a521][_0x412318(0xe2)][_0x412318(0x194)]*0x3c*0x3e8-(new Date()[_0x412318(0x23c)]()-devices[_0x10a521][_0x412318(0xe2)]['timestamp']);if(devices[_0x10a521][_0x412318(0x172)])clearTimeout(devices[_0x10a521]['pidExpireLogin']);devices[_0x10a521][_0x412318(0x172)]=setTimeout(()=>{const _0x5cfd91=_0x412318;if(devices[_0x10a521]['pidRefreshToken'])clearTimeout(devices[_0x10a521][_0x5cfd91(0x12e)]);removeSocketListeners(_0x10a521),addBlacklist(_0x10a521),devices[_0x10a521][_0x5cfd91(0xe2)]=null,devices[_0x10a521][_0x5cfd91(0x24f)]=null,devices[_0x10a521][_0x5cfd91(0x2a6)]['token']=null,logger[_0x5cfd91(0xce)](_0x5cfd91(0x13b)+_0x10a521['slice'](-0x8)),devices[_0x10a521][_0x5cfd91(0x2a6)]=validateAccess(devices[_0x10a521][_0x5cfd91(0x2a6)]['token'],_0x10a521),!(devices[_0x10a521]['access']['allow']&&devices[_0x10a521][_0x5cfd91(0x2a6)][_0x5cfd91(0x204)]=='login\x20not\x20required')&&(_0x359ee9==_0x5cfd91(0x1d1)?io['to'](_0x10a521)[_0x5cfd91(0x2c6)](_0x5cfd91(0x293),{'access':{'allow':![],'reason':_0x5cfd91(0x2a1),'token':null}}):io['to'](_0x10a521)[_0x5cfd91(0x2c6)](_0x5cfd91(0x293),{'access':{'allow':![],'reason':_0x5cfd91(0x21b),'token':null}})),devices[_0x10a521]['access'][_0x5cfd91(0x1c2)]=null;},_0x22ea78);}function setTokenRefresh(_0x2422d0){const _0x13c97b=_0xab0e8e;if(devices[_0x2422d0][_0x13c97b(0x12e)])clearTimeout(devices[_0x2422d0]['pidRefreshToken']);devices[_0x2422d0][_0x13c97b(0x12e)]=setTimeout(()=>{const _0x1a35d0=_0x13c97b;getClientsWithUuid(_0x2422d0)[_0x1a35d0(0x147)]!=0x0?(devices[_0x2422d0][_0x1a35d0(0x2a6)]=refreshToken(_0x2422d0),io['to'](_0x2422d0)[_0x1a35d0(0x2c6)](_0x1a35d0(0x293),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2422d0][_0x1a35d0(0x2a6)],'externalip':devices[_0x2422d0]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x2422d0)):clearTimeout(devices[_0x2422d0][_0x1a35d0(0x12e)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3a1aa7){const _0x492574=_0xab0e8e,_0x7b6c14=getClient(_0x3a1aa7['id'])[_0x492574(0x230)];_0x3a1aa7[_0x492574(0x2c6)](_0x492574(0x1b5),config),_0x3a1aa7[_0x492574(0x2c6)](_0x492574(0x20b),cleanSettings()),_0x3a1aa7['on'](_0x492574(0x1d8),_0x2ebb51=>{const _0x2f4851=_0x492574;if(validateAccess(_0x2ebb51,_0x7b6c14)[_0x2f4851(0x195)])addBot();else logger['full'](_0x2f4851(0x193));}),_0x3a1aa7['on']('update-bot',(_0x3bef27,_0x3519d5)=>{const _0x5a0f0a=_0x492574;if(validateAccess(_0x3519d5,_0x7b6c14)[_0x5a0f0a(0x195)])toggleBot(_0x3bef27[_0x5a0f0a(0xe0)],_0x3bef27[_0x5a0f0a(0x293)],_0x3bef27['live']);else logger[_0x5a0f0a(0x217)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x3a1aa7['on']('toggle-bot-mode',(_0x244059,_0x6d4ca2)=>{const _0x5413d=_0x492574;if(validateAccess(_0x6d4ca2,_0x7b6c14)[_0x5413d(0x195)])toggleBotMode(_0x244059);else logger['full'](_0x5413d(0xf4));}),_0x3a1aa7['on'](_0x492574(0x118),(_0x103063,_0x16763a)=>{const _0x54955e=_0x492574;if(validateAccess(_0x16763a,_0x7b6c14)[_0x54955e(0x195)])deleteBot(_0x103063);else logger[_0x54955e(0x217)](_0x54955e(0x1d4));}),_0x3a1aa7['on'](_0x492574(0x219),(_0x201f14,_0x5e7329)=>{const _0x150b10=_0x492574;if(validateAccess(_0x5e7329,_0x7b6c14)[_0x150b10(0x195)])storeSettings(_0x201f14,!![]);else logger[_0x150b10(0x217)](_0x150b10(0x1b7));}),_0x3a1aa7['on']('update-bb',_0x27c739=>{const _0x31077f=_0x492574;if(validateAccess(_0x27c739,_0x7b6c14)['allow'])updateBB(_0x31077f(0x25a));else logger[_0x31077f(0x217)](_0x31077f(0x2d5));}),_0x3a1aa7['on'](_0x492574(0x2bb),_0x568b34=>{const _0x3fd3a8=_0x492574;if(validateAccess(_0x568b34,_0x7b6c14)[_0x3fd3a8(0x195)])updateBB('reinstall');else logger[_0x3fd3a8(0x217)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x3a1aa7['on'](_0x492574(0x1fe),_0x1ce73a=>{const _0x3e2154=_0x492574;if(validateAccess(_0x1ce73a,_0x7b6c14)[_0x3e2154(0x195)]){const _0x130dd4=getClient(_0x3a1aa7['id']);if(_0x130dd4)getBackupFiles(_0x130dd4[_0x3e2154(0x230)]);else logger['full'](_0x3e2154(0xcf));}else logger[_0x3e2154(0x217)](_0x3e2154(0x1aa));}),_0x3a1aa7['on'](_0x492574(0x1f8),(_0x38d779,_0x2e3aed)=>{const _0x39f896=_0x492574;if(validateAccess(_0x2e3aed,_0x7b6c14)[_0x39f896(0x195)])restoreBackupFile(_0x38d779);else logger['full'](_0x39f896(0x23e));}),_0x3a1aa7['on']('get-messages',_0x231610=>{const _0x4ed96c=_0x492574;if(validateAccess(_0x231610,_0x7b6c14)['allow'])getMessages();else logger['full'](_0x4ed96c(0x1a7));}),_0x3a1aa7['on'](_0x492574(0x267),(_0x57915c,_0x3f88a6)=>{const _0x3bbc9f=_0x492574;if(validateAccess(_0x3f88a6,_0x7b6c14)[_0x3bbc9f(0x195)])confirmMessage(_0x57915c);else logger[_0x3bbc9f(0x217)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x3a1aa7['on'](_0x492574(0x255),_0x3c6bd0=>{const _0x119a6f=_0x492574;if(validateAccess(_0x3c6bd0,_0x7b6c14)[_0x119a6f(0x195)]){if(devices[_0x7b6c14]['pidRefreshToken'])clearTimeout(devices[_0x7b6c14][_0x119a6f(0x12e)]);if(devices[_0x7b6c14][_0x119a6f(0x172)])clearTimeout(devices[_0x7b6c14]['pidExpireLogin']);removeSocketListeners(getClient(_0x3a1aa7['id'])[_0x119a6f(0x230)]),addBlacklist(_0x7b6c14),devices[_0x7b6c14][_0x119a6f(0xe2)]=null,devices[_0x7b6c14][_0x119a6f(0x24f)]=null,devices[_0x7b6c14]['access']['token']=null,logger[_0x119a6f(0xce)](_0x119a6f(0x17b)+_0x7b6c14[_0x119a6f(0x20a)](-0x8)),io['to'](getClient(_0x3a1aa7['id'])['uuid'])[_0x119a6f(0x2c6)](_0x119a6f(0x293),{'access':{'allow':![],'reason':_0x119a6f(0x158),'token':null}});}else logger[_0x119a6f(0x217)](_0x119a6f(0x113));});}function initializeSocketBot(_0xd2a615){const _0x1d52c4=_0xab0e8e,_0x69c005=getClient(_0xd2a615['id'])[_0x1d52c4(0x22b)],_0x428853=getClient(_0xd2a615['id'])[_0x1d52c4(0x230)];_0xd2a615['on'](_0x1d52c4(0x1ec),(_0x5efcc3,_0x156144)=>{const _0x5677a9=_0x1d52c4;if(validateAccess(_0x156144,_0x428853)[_0x5677a9(0x195)]){if(pid[_0x69c005])pid[_0x69c005]['send']({'function':_0x5677a9(0x1bb),'args':_0x5efcc3});}else logger[_0x5677a9(0x217)](_0x5677a9(0x2ab));}),_0xd2a615['on'](_0x1d52c4(0x239),(_0x43db75,_0x921786)=>{const _0x3c70e6=_0x1d52c4;if(validateAccess(_0x921786,_0x428853)[_0x3c70e6(0x195)]){if(pid[_0x69c005])pid[_0x69c005][_0x3c70e6(0x28f)]({'function':_0x3c70e6(0x19c),'args':_0x43db75});}else logger[_0x3c70e6(0x217)](_0x3c70e6(0x1e2));}),_0xd2a615['on']('get-portfolio',(_0x594393,_0x253b46)=>{const _0x29a004=_0x1d52c4;if(validateAccess(_0x253b46,_0x428853)['allow']){if(pid[_0x69c005])pid[_0x69c005][_0x29a004(0x28f)]({'function':'getPortfolio','args':_0x594393});}else logger[_0x29a004(0x217)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0xd2a615['on'](_0x1d52c4(0x12d),(_0x1844c4,_0x5448ae)=>{const _0x2779a3=_0x1d52c4;if(validateAccess(_0x5448ae,_0x428853)[_0x2779a3(0x195)]){if(pid[_0x69c005])pid[_0x69c005][_0x2779a3(0x28f)]({'function':_0x2779a3(0x20c),'args':_0x1844c4});}else logger[_0x2779a3(0x217)](_0x2779a3(0x16b));}),_0xd2a615['on']('store-headless',(_0x4c4182,_0x43d072)=>{const _0x1fe71e=_0x1d52c4;if(validateAccess(_0x43d072,_0x428853)[_0x1fe71e(0x195)]){if(pid[_0x69c005])pid[_0x69c005]['send']({'function':_0x1fe71e(0x256),'args':_0x4c4182});}else logger[_0x1fe71e(0x217)](_0x1fe71e(0x2cb));}),_0xd2a615['on'](_0x1d52c4(0xd7),(_0x266757,_0x10185d)=>{const _0x376e78=_0x1d52c4;if(validateAccess(_0x10185d,_0x428853)[_0x376e78(0x195)]){if(pid[_0x69c005])pid[_0x69c005][_0x376e78(0x28f)]({'function':_0x376e78(0x15f),'args':_0x266757});}else logger['full'](_0x376e78(0x1c7));}),_0xd2a615['on'](_0x1d52c4(0x1d3),_0x2a6a39=>{const _0x595200=_0x1d52c4;if(validateAccess(_0x2a6a39,_0x428853)[_0x595200(0x195)]){if(pid[_0x69c005])pid[_0x69c005][_0x595200(0x28f)]({'function':'resetHistory','args':null});}else logger[_0x595200(0x217)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0xd2a615['on'](_0x1d52c4(0xd2),_0x3d029b=>{const _0x29502e=_0x1d52c4;if(validateAccess(_0x3d029b,_0x428853)['allow']){if(pid[_0x69c005])pid[_0x69c005][_0x29502e(0x28f)]({'function':_0x29502e(0x188),'args':null});}else logger['full'](_0x29502e(0x13a));}),_0xd2a615['on']('place-order',(_0x3d79f2,_0x78ef27)=>{const _0x990b91=_0x1d52c4;if(validateAccess(_0x78ef27,_0x428853)[_0x990b91(0x195)]){if(pid[_0x69c005])pid[_0x69c005][_0x990b91(0x28f)]({'function':_0x990b91(0xfa),'args':_0x3d79f2});}else logger[_0x990b91(0x217)](_0x990b91(0x27c));}),_0xd2a615['on'](_0x1d52c4(0x1c4),_0x211f7c=>{const _0x163d94=_0x1d52c4;if(validateAccess(_0x211f7c,_0x428853)[_0x163d94(0x195)]){if(pid[_0x69c005])pid[_0x69c005][_0x163d94(0x28f)]({'function':_0x163d94(0x246),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0xd2a615['on'](_0x1d52c4(0x23a),_0x34ef15=>{const _0x54e5d8=_0x1d52c4;if(validateAccess(_0x34ef15,_0x428853)['allow']){if(pid[_0x69c005])pid[_0x69c005][_0x54e5d8(0x28f)]({'function':_0x54e5d8(0x1ea),'args':null});}else logger[_0x54e5d8(0x217)](_0x54e5d8(0xec));}),_0xd2a615['on'](_0x1d52c4(0x27f),_0x21a943=>{const _0x43cb21=_0x1d52c4;if(validateAccess(_0x21a943,_0x428853)[_0x43cb21(0x195)])updateBB(_0x43cb21(0x25a));else logger[_0x43cb21(0x217)](_0x43cb21(0x2d5));}),_0xd2a615['on'](_0x1d52c4(0x15a),_0x196e90=>{const _0x3af975=_0x1d52c4;if(validateAccess(_0x196e90,_0x428853)[_0x3af975(0x195)])getMessages();else logger['full'](_0x3af975(0x1a7));}),_0xd2a615['on'](_0x1d52c4(0x267),(_0x27bdfd,_0x8a7cdb)=>{const _0x3e6d21=_0x1d52c4;if(validateAccess(_0x8a7cdb,_0x428853)[_0x3e6d21(0x195)])confirmMessage(_0x27bdfd);else logger[_0x3e6d21(0x217)](_0x3e6d21(0x123));}),_0xd2a615['on'](_0x1d52c4(0x255),_0xff671b=>{const _0x3a5c5d=_0x1d52c4;if(validateAccess(_0xff671b,_0x428853)[_0x3a5c5d(0x195)]){if(devices[_0x428853][_0x3a5c5d(0x12e)])clearTimeout(devices[_0x428853]['pidRefreshToken']);if(devices[_0x428853][_0x3a5c5d(0x172)])clearTimeout(devices[_0x428853]['pidExpireLogin']);removeSocketListeners(getClient(_0xd2a615['id'])['uuid']),addBlacklist(_0x428853),devices[_0x428853][_0x3a5c5d(0xe2)]=null,devices[_0x428853][_0x3a5c5d(0x24f)]=null,devices[_0x428853][_0x3a5c5d(0x2a6)][_0x3a5c5d(0x1c2)]=null,logger[_0x3a5c5d(0xce)](_0x3a5c5d(0x17b)+_0x428853[_0x3a5c5d(0x20a)](-0x8)),io['to'](getClient(_0xd2a615['id'])[_0x3a5c5d(0x230)])[_0x3a5c5d(0x2c6)](_0x3a5c5d(0x293),{'access':{'allow':![],'reason':_0x3a5c5d(0x158),'token':null}});}else logger[_0x3a5c5d(0x217)](_0x3a5c5d(0x113));});}function removeSocketListeners(_0xb853cb){const _0xeb76e5=_0xab0e8e;getClientsWithUuid(_0xb853cb)[_0xeb76e5(0x134)](_0x5e0ba2=>{const _0x228dc1=_0xeb76e5;getSocket(_0x5e0ba2['id'])[_0x228dc1(0x1b0)]();});}function cleanSettings(){const _0x4816d9=_0xab0e8e;let _0x5e5f0c=settings;return settings[_0x4816d9(0x10d)]&&settings[_0x4816d9(0x10d)]!=''&&(_0x5e5f0c={..._0x5e5f0c,'telegramToken':'************'}),settings[_0x4816d9(0x114)]&&settings[_0x4816d9(0x114)]!=''&&(_0x5e5f0c={..._0x5e5f0c,'bbPassword':_0x4816d9(0x25d)}),settings[_0x4816d9(0x181)]&&settings[_0x4816d9(0x181)]!=''&&(_0x5e5f0c={..._0x5e5f0c,'marketcapApi':'************'}),(settings[_0x4816d9(0x114)]&&settings[_0x4816d9(0x114)]=='***'||settings['telegramToken']&&settings['telegramToken']=='***'||settings['marketcapApi']&&settings[_0x4816d9(0x181)]==_0x4816d9(0x2b3))&&(_0x5e5f0c={..._0x5e5f0c,'restored':{'password':settings[_0x4816d9(0x114)]=='***','telegram':settings[_0x4816d9(0x10d)]==_0x4816d9(0x2b3),'marketcap':settings[_0x4816d9(0x181)]==_0x4816d9(0x2b3)}}),_0x5e5f0c;}async function updateBB(_0x3ce041){const _0x5379bf=_0xab0e8e;await backupConfigFiles(),installingUpdate=!![],config[_0x5379bf(0x134)](_0x48ab66=>{const _0x5b4a76=_0x5379bf;restartBot(_0x48ab66[_0x5b4a76(0xe0)]);});if(_0x3ce041=='update')process[_0x5379bf(0x28f)]({'update':!![],'environment':environment},_0x2aafbd=>{});else _0x3ce041==_0x5379bf(0x266)&&process[_0x5379bf(0x28f)]({'reinstall':!![],'environment':environment},_0x5a06c6=>{});}function startBot(_0x5c49ed,_0x313faa,_0x265b8b){const _0x1bfc31=_0xab0e8e;if(debugging)_0x5c49ed[_0x1bfc31(0x226)]('-d');let _0x8f5560=![];const _0x380157=_0x5c49ed[0x0];_0x313faa={..._0x313faa,'stdio':['inherit',_0x1bfc31(0x247),_0x1bfc31(0x247),_0x1bfc31(0x1a4)]},pid[_0x380157]=childProcess[_0x1bfc31(0x23d)](botfile,_0x5c49ed,_0x313faa),pid[_0x380157]['on'](_0x1bfc31(0x2ce),_0xf914cf=>{const _0x4dd58c=_0x1bfc31;switch(Object[_0x4dd58c(0x2bd)](_0xf914cf)[0x0]){case'botname':updateBotName(_0x380157,_0xf914cf[_0x4dd58c(0x1d9)]);break;case'updatebotmanager':updateBotManager();break;case _0x4dd58c(0x293):updateStatus(_0x380157,_0xf914cf[_0x4dd58c(0x293)]);break;case _0x4dd58c(0x29e):updateLive(_0x380157,_0xf914cf[_0x4dd58c(0x29e)]);break;case _0x4dd58c(0x237):updateLive(_0x380157,_0xf914cf[_0x4dd58c(0x237)]),io['to'](_0x380157)[_0x4dd58c(0x2c6)](_0x4dd58c(0x293),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x4dd58c(0x19e):_0xf914cf['stop']==_0x4dd58c(0x276)&&restartBot(_0x380157);_0xf914cf[_0x4dd58c(0x19e)]==_0x4dd58c(0x212)&&toggleBot(_0x380157,'disabled',_0x4dd58c(0x153));break;case _0x4dd58c(0x284):sendTelegramBot(_0x380157,_0xf914cf[_0x4dd58c(0x284)]);break;case _0x4dd58c(0x10b):sendTelegramMsg(_0xf914cf[_0x4dd58c(0x10b)]);break;case _0x4dd58c(0x155):io['to'](_0x380157)['emit'](_0xf914cf[_0x4dd58c(0x155)],_0xf914cf[_0x4dd58c(0x27e)]);break;}}),pid[_0x380157]['on'](_0x1bfc31(0x160),function(_0x31734d){if(_0x8f5560)return;_0x8f5560=!![],_0x265b8b(_0x31734d);}),pid[_0x380157]['on']('exit',async function(_0x1eced2){const _0xb7ec74=_0x1bfc31;if(terminating)return;if(installingUpdate){io[_0xb7ec74(0x1ab)]();return;}if(_0x8f5560)return;_0x8f5560=!![],_0x265b8b(null);const _0x55b73c=dbConfig[_0xb7ec74(0x200)](_0xb7ec74(0x1b5))[_0xb7ec74(0x190)]({'botID':_0x380157})[_0xb7ec74(0x27b)]();_0x55b73c&&(_0x55b73c[_0xb7ec74(0x293)]==_0xb7ec74(0x2a2)||_0x55b73c[_0xb7ec74(0x293)]=='new')&&(await sleep(0x3e8),updateLive(_0x380157,_0xb7ec74(0x153)),logger[_0xb7ec74(0x217)](_0xb7ec74(0x214)+_0x380157),startBot([_0x380157,userID],{'cwd':bbpath},function(_0xe19d2f){const _0x420380=_0xb7ec74;if(_0xe19d2f)logger[_0x420380(0x217)](_0xe19d2f);}));});}function stopBot(_0x5e9b3b){getClientsWithBotID(_0x5e9b3b)['forEach'](_0x5bb9c2=>{const _0x464ad1=_0x5e43;getSocket(_0x5bb9c2['id'])[_0x464ad1(0x2bc)](!![]),removeClient(_0x5bb9c2['id']);}),pid[_0x5e9b3b]&&(pid[_0x5e9b3b]['kill'](),pid[_0x5e9b3b]=null);}function stopAllBots(){const _0x3867a=_0xab0e8e;terminating=!![];const _0x2fbe28=getEnabledBots();_0x2fbe28[_0x3867a(0x134)](_0x455b08=>{const _0x2b6917=_0x3867a;stopBot(_0x455b08[_0x2b6917(0xe0)]);});}function restartBot(_0x4b48e0){const _0x2b65b3=_0xab0e8e;if(pid[_0x4b48e0])pid[_0x4b48e0][_0x2b65b3(0x212)]();}function addBot(){const _0x16f66b=_0xab0e8e;let _0x33aa2b;for(let _0x347ad5=0x1;_0x347ad5<0x3e9;_0x347ad5++){_0x33aa2b=_0x347ad5[_0x16f66b(0xf6)]()[_0x16f66b(0x182)](0x3,'0');let _0x6fa7b=config[_0x16f66b(0x190)](_0x566acf=>_0x566acf[_0x16f66b(0xe0)]==_0x33aa2b);if(!_0x6fa7b)break;}if(_0x33aa2b===_0x16f66b(0x1a9)){logger[_0x16f66b(0x217)](_0x16f66b(0x11e));return;}logger[_0x16f66b(0x217)](_0x16f66b(0x171)+_0x33aa2b),dbConfig[_0x16f66b(0x200)](_0x16f66b(0x1b5))[_0x16f66b(0x226)]({'botID':_0x33aa2b,'botname':'Bot\x20'+_0x33aa2b,'status':_0x16f66b(0xfb),'live':''})[_0x16f66b(0x299)](),startBot([_0x33aa2b,userID],{'cwd':bbpath},function(_0xbd85a){const _0x15ff9b=_0x16f66b;if(_0xbd85a)logger[_0x15ff9b(0x217)](_0xbd85a);}),config=getConfiguration(),io['to']('botmanager')['emit'](_0x16f66b(0x1b5),config),broadcastToBots(_0x16f66b(0x1b5),JSON[_0x16f66b(0x298)](config));}function deleteBot(_0x4ef9f0){const _0xbed037=_0xab0e8e;getClientsWithBotID(_0x4ef9f0)['forEach'](_0x11f2ec=>{const _0x145d0b=_0x5e43;getSocket(_0x11f2ec['id'])[_0x145d0b(0x2bc)](!![]),removeClient(_0x11f2ec['id']);}),dbConfig[_0xbed037(0x200)](_0xbed037(0x1b5))[_0xbed037(0x2ac)]({'botID':_0x4ef9f0})['write'](),logger[_0xbed037(0x217)](_0xbed037(0x28e)+_0x4ef9f0),stopBot(_0x4ef9f0);try{if(fs['existsSync'](path[_0xbed037(0x170)](configpath,_0xbed037(0xde)+_0x4ef9f0+_0xbed037(0x162))))fs[_0xbed037(0x183)](path[_0xbed037(0x170)](configpath,_0xbed037(0xde)+_0x4ef9f0+_0xbed037(0x162)));if(fs['existsSync'](path[_0xbed037(0x170)](configpath,_0xbed037(0xde)+_0x4ef9f0+_0xbed037(0xdd))))fs[_0xbed037(0x183)](path['join'](configpath,'bot-'+_0x4ef9f0+_0xbed037(0xdd)));if(fs['existsSync'](path['join'](configpath,_0xbed037(0xde)+_0x4ef9f0+_0xbed037(0x100))))fs[_0xbed037(0x183)](path[_0xbed037(0x170)](configpath,_0xbed037(0xde)+_0x4ef9f0+'-performance.json'));if(fs[_0xbed037(0x28b)](path[_0xbed037(0x170)](configpath,_0xbed037(0xde)+_0x4ef9f0+_0xbed037(0x108))))fs[_0xbed037(0x183)](path[_0xbed037(0x170)](configpath,_0xbed037(0xde)+_0x4ef9f0+'-results.json'));}catch(_0x50f89f){if(_0x50f89f)logger[_0xbed037(0x217)](_0xbed037(0x223),_0x50f89f);}config=getConfiguration(),io['to'](_0xbed037(0x11b))[_0xbed037(0x2c6)](_0xbed037(0x1b5),config),broadcastToBots(_0xbed037(0x1b5),JSON[_0xbed037(0x298)](config));}function toggleBot(_0x5e12d9,_0x596316,_0x433ab8){const _0x4950af=_0xab0e8e;dbConfig[_0x4950af(0x200)](_0x4950af(0x1b5))[_0x4950af(0x190)]({'botID':_0x5e12d9})[_0x4950af(0x136)]({'status':_0x596316})[_0x4950af(0x136)]({'live':_0x433ab8})[_0x4950af(0x299)]();if(_0x596316==_0x4950af(0x2a2)||_0x596316=='new')logger[_0x4950af(0x217)](_0x4950af(0x179)+_0x5e12d9),startBot([_0x5e12d9,userID],{'cwd':bbpath},function(_0x19d32d){const _0x516df0=_0x4950af;if(_0x19d32d)logger[_0x516df0(0x217)](_0x19d32d);});else(_0x596316==_0x4950af(0x1ff)||_0x596316==_0x4950af(0x15d))&&(logger['full'](_0x4950af(0x23b)+_0x5e12d9),stopBot(_0x5e12d9));config=getConfiguration(),io['to']('botmanager')[_0x4950af(0x2c6)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function toggleStatus(_0x1fa6ac){const _0x3ed741=_0xab0e8e;let _0x2a2867=dbConfig[_0x3ed741(0x200)](_0x3ed741(0x1b5))[_0x3ed741(0x190)]({'botID':_0x1fa6ac})[_0x3ed741(0x27b)](),_0x5e9320;if(_0x2a2867[_0x3ed741(0x293)]===_0x3ed741(0x2a2))_0x5e9320=_0x3ed741(0x1ff);else{if(_0x2a2867[_0x3ed741(0x293)]===_0x3ed741(0xfb))_0x5e9320=_0x3ed741(0x15d);else{if(_0x2a2867[_0x3ed741(0x293)]===_0x3ed741(0x15d))_0x5e9320='new';else{if(_0x2a2867[_0x3ed741(0x293)]==='disabled')_0x5e9320='enabled';}}}return _0x5e9320;}function updateStatus(_0x4deee2,_0x476f9f){const _0x2746ac=_0xab0e8e;dbConfig[_0x2746ac(0x200)]('bots')[_0x2746ac(0x190)]({'botID':_0x4deee2})['assign']({'status':_0x476f9f})[_0x2746ac(0x299)](),config=getConfiguration(),io['to'](_0x2746ac(0x11b))[_0x2746ac(0x2c6)]('bots',config),broadcastToBots(_0x2746ac(0x1b5),JSON[_0x2746ac(0x298)](config));}function updateLive(_0x9c7522,_0x8580b7){const _0xb4862a=_0xab0e8e;dbConfig[_0xb4862a(0x200)](_0xb4862a(0x1b5))['find']({'botID':_0x9c7522})['assign']({'live':_0x8580b7})[_0xb4862a(0x299)](),config=getConfiguration(),io['to'](_0xb4862a(0x11b))[_0xb4862a(0x2c6)](_0xb4862a(0x1b5),config),broadcastToBots(_0xb4862a(0x1b5),JSON[_0xb4862a(0x298)](config));}function updateBotName(_0x35c7d3,_0x4dcdca){const _0x4d28bb=_0xab0e8e;dbConfig[_0x4d28bb(0x200)](_0x4d28bb(0x1b5))[_0x4d28bb(0x190)]({'botID':_0x35c7d3})[_0x4d28bb(0x136)]({'botname':_0x4dcdca})[_0x4d28bb(0x299)](),config=getConfiguration(),io['to'](_0x4d28bb(0x11b))[_0x4d28bb(0x2c6)]('bots',config),broadcastToBots(_0x4d28bb(0x1b5),JSON[_0x4d28bb(0x298)](config));}function updateBotManager(){const _0x4aba33=_0xab0e8e;config=getConfiguration(),io['to'](_0x4aba33(0x11b))[_0x4aba33(0x2c6)](_0x4aba33(0x1b5),config),broadcastToBots(_0x4aba33(0x1b5),JSON[_0x4aba33(0x298)](config));}function toggleBotMode(_0x284539){const _0x1603a6=_0xab0e8e;if(pid[_0x284539])pid[_0x284539][_0x1603a6(0x28f)]({'function':_0x1603a6(0x2c5),'args':null});else{const _0x2c4b3b=configpath+_0x1603a6(0xde)+_0x284539+'-config.json',_0x71f1d3=fs[_0x1603a6(0x1cf)](_0x2c4b3b),_0x4f387a=JSON['parse'](_0x71f1d3),_0x5199c0=_0x4f387a[_0x1603a6(0x22b)][0x0][_0x1603a6(0x1de)];_0x4f387a[_0x1603a6(0x22b)][0x0][_0x1603a6(0x1de)]=!_0x5199c0;const _0x3a0f50=JSON['stringify'](_0x4f387a,null,0x2);fs['writeFileSync'](_0x2c4b3b,_0x3a0f50),config=getConfiguration(),io['to']('botmanager')[_0x1603a6(0x2c6)](_0x1603a6(0x1b5),config),broadcastToBots('bots',JSON[_0x1603a6(0x298)](config));}}function validateTelegram(_0x1919b9){const _0x2cf8ad=_0xab0e8e;if(_0x1919b9[_0x2cf8ad(0x142)]['username']!=settings['telegramUsername']&&'@'+_0x1919b9[_0x2cf8ad(0x142)][_0x2cf8ad(0x186)]!=settings[_0x2cf8ad(0xe1)]||_0x1919b9[_0x2cf8ad(0x2c3)]['id']!=settings[_0x2cf8ad(0x21c)])return sendTelegram(_0x1919b9['chat']['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x2cf8ad(0x10f)}),![];return!![];}function _0x317f(){const _0x5cbd12=['settings','storeConfiguration','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','socket','replace','randomBytes','entries','kill',':\x20Bot\x20Mgr\x20>\x20','Restarting\x20Bot\x20','address\x20already\x20in\x20use','Invalid\x20username\x20or\x20IP\x20address','full','28520lNMXtr','store-settings','BCT','temporary\x20access\x20timeout','telegramChatId','login\x20required','sendFile','settings.','127.0.0.1','mixpanel','messages','Error\x20while\x20deleting\x20config\x20files:\x20',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','bbUsername','push','27464bZpuMD','sendPortfolioTelegram','server','uuid-random','bot','1532587KCYmkq','remoteAddress','defaults','privateKeyToPem','uuid','split','metrics_','Restore\x20process\x20aborted','toIPv4Address','/:bot/performance','orders','started','Markdown','delete-alerts','show-config','Disabled\x20Bot\x20','getTime','fork','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','telegramEvents','Login\x20rejected','ipaddr.js','portfolio','randomFillSync','endsWith','start','cancelLoading','inherit','test','*$1*','decrypt','login\x20token\x20valid','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','30\x20min','Orders','telegram2FaApproval','output-002.log','#RES#\x20','Error:\x20Invalid\x20argument\x20','No\x20bots\x20running\x20right\x20now','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','logout','storeHeadless','generateKeyPair','secret','temporaryAccessAllowed','update','12108048MWDikP','private','************','help','password','temporary\x20token\x20generated','timestamp',')\x20|\x20Bot\x20','::1','Bot\x20','file','reinstall','confirm-message','map','auto','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','async','/:bot','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','5\x20min','bot.js','static','Failed\x20to\x20download\x20','bb/','isValid','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Restore\x20backup\x20file\x20','restart','publicKey','\x20|\x20','6QotXiN','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','value','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','(((.+)+)+)+$','args','update-bb','publicKeyToPem','staging',')\x20\x20\x20|\x20Bot\x20','exchange','telegram','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','secure','resetpw_yes','alias','All\x20bots','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','existsSync','bb-secure.json','toIPv4MappedAddress','Deleted\x20Bot\x20','send','on_','version.json','<b>Telegram\x20Bot\x20Status:</b>\x0a','status','Notifications\x20enabled','882lgpGUO','lowdb/adapters/FileSync','tempaccess_15_','stringify','write','Starting\x20Balance\x20Bot\x20update','login\x20not\x20required','jszip','Access\x20enabled\x20for\x20','live','running','getFullYear','access\x20timeout','enabled','sortBy','SIGTERM','Setting\x20access:\x20','access','reject','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','child_process','Invalid\x20authentication\x20token\x20(1)','Unauthorized\x20attempt\x20to\x20get\x20events','remove','Unauthorized\x20login\x20attempt\x20(timeout)','Ok,\x20will\x20send\x20order\x20notifications\x20only','download','#RES#','editMessageReplyMarkup','apiSecret','***','telegramEnabled','timeshift','mkdirSync','node-forge','referer','update_no','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','reinstall-bb','disconnect','keys','search','jsonwebtoken','getDate','749618bnqPhf','internal','chat','/disable\x20-\x20disable\x20notifications\x0a','toggleBotMode','emit','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','apiKey','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','env','status\x20code\x20401','message','getMonth','/:bot/configuration','6rJRKVi','match','_nsps','Telegram\x20error:','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','/start','Restore\x20process\x20confirmed','action','mode','/output-000.log','/off\x20-\x20stop\x20bot(s)\x0a','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Starting\x20(','bbvNew','No\x20authentication\x20token','11ySfyWq','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','debug','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','output-003.log','get-starting-balances','event','telegraf','manual','sort','store-fiat','/:bot/history','decode64','add','All','compareSync','-events.json','bot-','config','botID','telegramUsername','telegramIpApproval','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Your\x20installation\x20is\x20already\x20up\x20to\x20date','bbvReceive','build','track','/metrics\x20-\x20show\x20bot\x20performance\x0a','button','temp/','NTBA_FIX_319','Unauthorized\x20attempt\x20to\x20show\x20configuration','exit','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','create','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','latestversion','catch','.zip','Unauthorized\x20attempt\x20to\x20update\x20bot','name','toString','2FA\x20login\x20rejected','login\x20token\x20generated','-----------------------------------------------------------------------------------','placeOrder','new','set','util','update_yes','reload','-performance.json','number','parse','axios','all','resetpw_no','sendMessage','Bot\x20Mgr\x20>\x20','-results.json','portfolio_','reset-password','telegrammsg','versions','telegramToken','family','HTML','hashSync','show','init','Unauthorized\x20attempt\x20to\x20log\x20out','bbPassword','blacklist','production','backup','delete-bot','express-fileupload','copyFileSync','botmanager','IPv4','Notifications\x20enabled\x0a','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','any','cloneDeep','lowdb','/update\x20-\x20update\x20Balance\x20Bot\x0a','Unauthorized\x20attempt\x20to\x20confirm\x20message','address','loadAsync','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','Alerts','\x1b[33m','|@|','2FA','hex','disable','store-configuration','pidRefreshToken','backup-full.zip','Invalid\x20IP\x20address','bb-settings.json','\x20>\x20','verify','forEach','Telegraf\x20error:','assign','output-001.log','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','warning','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Session\x20expired\x20for\x20user\x20...','CoinMarketCap\x20API\x20key\x20validated','reinstall_yes','whitelist','tkn','Notifications\x20disabled\x0a','loginRequired','from','getMinutes','\x20|\x20user:\x20...','Yes','lastmsgtelegram','length','/restart\x20-\x20restart\x20bot(s)\x0a','startsWith','onepagemode','order','environment','apiPassword','request','f2aRequired','log','notification','params','stopped','command','function','\x1b[36m','2FA\x20required','logged\x20out','775947fTGRDc','get-messages','store','/upload-backup','new-disabled','tempaccess_5_','storeFiat','error','config_alerts','-config.json','initclient','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','off','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','version','enable','reinstall_no','DEFLATE','Unauthorized\x20attempt\x20to\x20store\x20configuration','2FA\x20login\x20token\x20generated','post','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Server','join','Starting\x20new\x20bot\x20|\x20Bot\x20','pidExpireLogin','tempaccess_reject_','rmSync','type','backup-files','lastmsgemitted','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Enabled\x20Bot\x20','temporary\x20access\x20not\x20allowed','Logged\x20out\x20user\x20...','config_orders','userid','statSync','writeFileSync','text','marketcapApi','padStart','unlinkSync','temporary\x20access\x20rejected','\x1b[35m','username','login2fa_reject_','getStartingBalances','yes','pki','Unauthorized\x20attempt\x20to\x20download\x20','headers','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','\x1b[0m','showname','find','SIGINT','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','Unauthorized\x20attempt\x20to\x20add\x20bot','expiry','allow','auth','2FA\x20login\x20required','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','privateKeyFromPem','/enable\x20-\x20enable\x20notifications\x0a','title','deleteHistoryAlerts','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','stop','backup-full','Logged\x20in\x20user\x20...','/:bot/support','max','540cotivG','ipc','node','argv','Unauthorized\x20attempt\x20to\x20get\x20messages','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','1000','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','close','inlineKeyboard','callback','off_','User\x20has\x20been\x20validated','removeAllListeners','files','[ip-address]','tempaccess_30_','login2fa_','bots','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','Unauthorized\x20attempt\x20to\x20update\x20settings','code','express','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','emitHistory','format','readdirSync','once','=>\x20Go\x20to\x20#CYA#http://','filter','conn','token','size','cancel-loading',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','1504190ZNefwM','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','http','graphql-request','hasOwnProperty','Login\x20accepted','\x20only\x0a','Invalid\x20authentication\x20token\x20(2)','sendMetricsTelegram','readFileSync','binary','login','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','reset-history','Unauthorized\x20attempt\x20to\x20delete\x20bot','logs','success','0.0.0','add-bot','botname','Idling\x20(','includes','sha256','\x20|\x20client:\x20...','headless','constructor','zip/','backup-full@','Unauthorized\x20attempt\x20to\x20delete\x20alerts','getHours','use','launch','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','listen','crypto','api-eu.mixpanel.com','showConfig','isDirectory','get-logs','getSeconds','logs/','File\x20uploaded','config/','sign','Node.js\x20v','data','output-000.log','simple','\x1b[31m','You\x20can\x20use\x20the\x20following\x20commands:\x0a','restore-backup-file','\x20(1)','index.html','Notifications\x20disabled','reply','Token\x20blacklisted','get-backup-files','disabled','get','Backup\x20file\x20unzipped\x20and\x20stored','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','clientip','reason','privateKey','backupfile','alerts','config_all','host','slice'];_0x317f=function(){return _0x5cbd12;};return _0x317f();}async function initTelegram(){const _0x4b6396=_0xab0e8e;if(tgBot)tgBot[_0x4b6396(0x19e)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x4b6396(0x10d)]);let _0x473e68=_0x4b6396(0x1f7);_0x473e68+='\x0a',_0x473e68+=_0x4b6396(0x19a),_0x473e68+=_0x4b6396(0x2c4),_0x473e68+=_0x4b6396(0x18d),_0x473e68+=_0x4b6396(0x148),_0x473e68+='/on\x20-\x20start\x20bot(s)\x0a',_0x473e68+=_0x4b6396(0xc7),_0x473e68+=_0x4b6396(0x166),_0x473e68+='/names\x20-\x20show\x20bot\x20names\x0a',_0x473e68+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x473e68+=_0x4b6396(0xe8),_0x473e68+=_0x4b6396(0x2ca),_0x473e68+=_0x4b6396(0x122),_0x473e68+=_0x4b6396(0x1e6),_0x473e68+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x103bf5='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x103bf5+='\x0a',_0x103bf5+=_0x473e68,tgBot[_0x4b6396(0xf2)]((_0x218bd6,_0x467f01)=>{const _0x11235a=_0x4b6396;logger[_0x11235a(0x1f5)](getTimeStamp()+_0x11235a(0x224)),logger['debug'](_0x11235a(0x135),_0x218bd6);}),tgBot[_0x4b6396(0x1e4)](async(_0x571862,_0x139411)=>{const _0x1b236c=_0x4b6396;if(!(!settings['telegramChatId']&&_0x571862[_0x1b236c(0x25a)][_0x1b236c(0x2ce)][_0x1b236c(0x180)]==_0x1b236c(0x2d6))){if(!validateTelegram(_0x571862))return;}_0x139411();}),tgBot['command'](_0x4b6396(0x245),async _0x3fc91b=>{const _0x1a78a5=_0x4b6396;if(!settings[_0x1a78a5(0x21c)])updateSetting(_0x1a78a5(0x21c),_0x3fc91b['chat']['id']);updateSetting(_0x1a78a5(0x2b4),!![]);if(!validateTelegram(_0x3fc91b))return;await sendTelegram(_0x3fc91b[_0x1a78a5(0x2c3)]['id'],_0x103bf5);}),tgBot['command'](_0x4b6396(0x168),async _0x4d26ee=>{const _0x35c9b5=_0x4b6396;updateSetting(_0x35c9b5(0x2b4),!![]),await sendTelegram(_0x4d26ee['chat']['id'],_0x35c9b5(0x294));}),tgBot[_0x4b6396(0x154)](_0x4b6396(0x12c),async _0x35d73a=>{const _0x5c10ec=_0x4b6396;await sendTelegram(_0x35d73a['chat']['id'],_0x5c10ec(0x1fb)),updateSetting(_0x5c10ec(0x2b4),![]);}),tgBot[_0x4b6396(0x154)](_0x4b6396(0xdf),async _0x49b960=>{const _0x47fa31=_0x4b6396,_0x3901ba=Markup[_0x47fa31(0x1ac)]([Markup[_0x47fa31(0xe9)]['callback'](_0x47fa31(0x24e),_0x47fa31(0x17c)),Markup[_0x47fa31(0xe9)][_0x47fa31(0x1ad)](_0x47fa31(0x127),_0x47fa31(0x161)),Markup[_0x47fa31(0xe9)][_0x47fa31(0x1ad)](_0x47fa31(0xdb),'config_all')]);_0x49b960[_0x47fa31(0x1fc)](_0x47fa31(0x285),_0x3901ba);}),tgBot[_0x4b6396(0xc4)]('config_orders',async _0x2fa7a1=>{const _0x22d488=_0x4b6396;_0x2fa7a1['editMessageReplyMarkup'](),updateSetting(_0x22d488(0x23f),_0x22d488(0x236)),updateSetting(_0x22d488(0x2b4),!![]),await sendTelegram(_0x2fa7a1['chat']['id'],_0x22d488(0x2ae));}),tgBot[_0x4b6396(0xc4)](_0x4b6396(0x161),async _0x13c173=>{const _0x32af63=_0x4b6396;_0x13c173[_0x32af63(0x2b1)](),updateSetting(_0x32af63(0x23f),_0x32af63(0x207)),updateSetting(_0x32af63(0x2b4),!![]),await sendTelegram(_0x13c173[_0x32af63(0x2c3)]['id'],_0x32af63(0x274));}),tgBot[_0x4b6396(0xc4)](_0x4b6396(0x208),async _0x2a46c9=>{const _0x45f0d4=_0x4b6396;_0x2a46c9[_0x45f0d4(0x2b1)](),updateSetting(_0x45f0d4(0x23f),_0x45f0d4(0x104)),updateSetting(_0x45f0d4(0x2b4),!![]),await sendTelegram(_0x2a46c9[_0x45f0d4(0x2c3)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x4b6396(0x154)](_0x4b6396(0x293),async _0xe1b0f7=>{const _0x1f6c63=_0x4b6396,_0x341842=getBotsWithMode();let _0x1e22a5='<b>Balance\x20Bot\x20Status:</b>\x0a';config['forEach'](_0x3cae90=>{const _0x2777ed=_0x5e43,_0x29ac2b=_0x341842['find'](_0x22c4c6=>_0x22c4c6[_0x2777ed(0xe0)]==_0x3cae90[_0x2777ed(0xe0)])[_0x2777ed(0xc5)];_0x1e22a5+='Bot\x20'+_0x3cae90['botID']+':\x20'+_0x3cae90['status']+'\x20|\x20'+_0x29ac2b+'\x20|\x20'+_0x3cae90[_0x2777ed(0x29e)]+'\x0a';}),_0x1e22a5+='\x0a',_0x1e22a5+=_0x1f6c63(0x292),_0x1e22a5+=!settings[_0x1f6c63(0x2b4)]?_0x1f6c63(0x140):_0x1f6c63(0x11d),_0x1e22a5+=settings['telegramEnabled']?settings[_0x1f6c63(0x23f)]==_0x1f6c63(0x104)?_0x1f6c63(0x26d):'Notifications\x20types:\x20'+settings[_0x1f6c63(0x23f)]+_0x1f6c63(0x1cc):'',await sendTelegram(_0xe1b0f7[_0x1f6c63(0x2c3)]['id'],_0x1e22a5,{'parse_mode':_0x1f6c63(0x10f)});}),tgBot[_0x4b6396(0x154)](_0x4b6396(0x276),async _0xc603=>{const _0xb469e5=_0x4b6396,_0x307e15=getEnabledBots();if(_0x307e15['length']==0x0)await sendTelegram(_0xc603[_0xb469e5(0x2c3)]['id'],_0xb469e5(0x253));else{if(_0x307e15[_0xb469e5(0x147)]>0x1)_0x307e15[_0xb469e5(0x226)]({'botID':'all'});let _0x361369=[],_0x323872=[];const _0x221e6b=_0x307e15[_0xb469e5(0x147)]%0x4==0x0||_0x307e15[_0xb469e5(0x147)]%0x4==0x3||_0x307e15['length']%0x3==0x1?0x4:0x3;let _0x192845=0x0;_0x307e15[_0xb469e5(0x134)]((_0x14b736,_0x33ee86)=>{const _0x3cf412=_0xb469e5;if(_0x33ee86%_0x221e6b==0x0)_0x323872=[];_0x323872[_0x3cf412(0x226)](Markup['button'][_0x3cf412(0x1ad)](_0x14b736[_0x3cf412(0xe0)]==_0x3cf412(0x104)?_0x3cf412(0x289):_0x3cf412(0x264)+_0x14b736[_0x3cf412(0xe0)],'restart_'+_0x14b736[_0x3cf412(0xe0)])),_0x33ee86%_0x221e6b==0x0&&(_0x361369[_0x192845]=_0x323872,_0x192845++);});const _0x7299b3=Markup[_0xb469e5(0x1ac)](_0x361369);_0xc603[_0xb469e5(0x1fc)](_0xb469e5(0xf0),_0x7299b3);}}),tgBot[_0x4b6396(0xc4)](/restart_(.+)/,async _0x4cb41b=>{const _0x5d6b12=_0x4b6396,_0x1ba098=_0x4cb41b[_0x5d6b12(0x2d2)][0x1];_0x4cb41b['editMessageReplyMarkup'](),_0x1ba098==_0x5d6b12(0x104)?config['forEach'](_0x4b0edd=>{restartBot(_0x4b0edd['botID']);}):restartBot(_0x1ba098);}),tgBot[_0x4b6396(0x154)]('on',async _0x17189c=>{const _0xf5bd7b=_0x4b6396,_0x445b10=getDisabledBots();if(_0x445b10[_0xf5bd7b(0x147)]==0x0)await sendTelegram(_0x17189c['chat']['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x445b10[_0xf5bd7b(0x147)]>0x1)_0x445b10[_0xf5bd7b(0x226)]({'botID':'all'});let _0x2bc3f7=[],_0xe76c4b=[];const _0x560b76=_0x445b10[_0xf5bd7b(0x147)]%0x4==0x0||_0x445b10['length']%0x4==0x3||_0x445b10[_0xf5bd7b(0x147)]%0x3==0x1?0x4:0x3;let _0x26ab5e=0x0;_0x445b10[_0xf5bd7b(0x134)]((_0xecf8ca,_0x278e42)=>{const _0x4f01db=_0xf5bd7b;if(_0x278e42%_0x560b76==0x0)_0xe76c4b=[];_0xe76c4b['push'](Markup[_0x4f01db(0xe9)]['callback'](_0xecf8ca[_0x4f01db(0xe0)]==_0x4f01db(0x104)?_0x4f01db(0x289):'Bot\x20'+_0xecf8ca[_0x4f01db(0xe0)],_0x4f01db(0x290)+_0xecf8ca[_0x4f01db(0xe0)])),_0x278e42%_0x560b76==0x0&&(_0x2bc3f7[_0x26ab5e]=_0xe76c4b,_0x26ab5e++);});const _0x12e3b9=Markup[_0xf5bd7b(0x1ac)](_0x2bc3f7);_0x17189c[_0xf5bd7b(0x1fc)](_0xf5bd7b(0x26a),_0x12e3b9);}}),tgBot[_0x4b6396(0xc4)](/on_(.+)/,async _0x4e7d1d=>{const _0x4b097d=_0x4b6396,_0x29efa2=_0x4e7d1d['match'][0x1];_0x4e7d1d[_0x4b097d(0x2b1)]();if(_0x29efa2==_0x4b097d(0x104)){const _0x5b50f4=getDisabledBots();await sendTelegram(_0x4e7d1d[_0x4b097d(0x2c3)]['id'],_0x4b097d(0xc8)),_0x5b50f4[_0x4b097d(0x134)](_0x219cb0=>{const _0x300c54=_0x4b097d;if(_0x219cb0[_0x300c54(0xe0)]!=_0x300c54(0x104))toggleBot(_0x219cb0[_0x300c54(0xe0)],toggleStatus(_0x219cb0[_0x300c54(0xe0)]),'stopped');});}else await sendTelegram(_0x4e7d1d[_0x4b097d(0x2c3)]['id'],_0x4b097d(0x164)+_0x29efa2),toggleBot(_0x29efa2,toggleStatus(_0x29efa2),_0x4b097d(0x153));}),tgBot[_0x4b6396(0x154)](_0x4b6396(0x165),async _0x4bc8bb=>{const _0x41730=_0x4b6396,_0x17df33=getEnabledBots();if(_0x17df33['length']==0x0)await sendTelegram(_0x4bc8bb[_0x41730(0x2c3)]['id'],_0x41730(0x253));else{if(_0x17df33['length']>0x1)_0x17df33[_0x41730(0x226)]({'botID':_0x41730(0x104)});let _0x4fa3c6=[],_0x4d312f=[];const _0x1b0fb5=_0x17df33[_0x41730(0x147)]%0x4==0x0||_0x17df33['length']%0x4==0x3||_0x17df33[_0x41730(0x147)]%0x3==0x1?0x4:0x3;let _0x342b9d=0x0;_0x17df33[_0x41730(0x134)]((_0x439e31,_0x466c32)=>{const _0x520863=_0x41730;if(_0x466c32%_0x1b0fb5==0x0)_0x4d312f=[];_0x4d312f[_0x520863(0x226)](Markup[_0x520863(0xe9)][_0x520863(0x1ad)](_0x439e31[_0x520863(0xe0)]==_0x520863(0x104)?_0x520863(0x289):_0x520863(0x264)+_0x439e31[_0x520863(0xe0)],_0x520863(0x1ae)+_0x439e31[_0x520863(0xe0)])),_0x466c32%_0x1b0fb5==0x0&&(_0x4fa3c6[_0x342b9d]=_0x4d312f,_0x342b9d++);});const _0x399fb6=Markup[_0x41730(0x1ac)](_0x4fa3c6);_0x4bc8bb[_0x41730(0x1fc)](_0x41730(0x178),_0x399fb6);}}),tgBot['action'](/off_(.+)/,async _0x496e3d=>{const _0x5a7f74=_0x4b6396,_0x31e655=_0x496e3d[_0x5a7f74(0x2d2)][0x1];_0x496e3d[_0x5a7f74(0x2b1)]();if(_0x31e655==_0x5a7f74(0x104)){const _0x4ccd5a=getEnabledBots();await sendTelegram(_0x496e3d['chat']['id'],_0x5a7f74(0x19d)),_0x4ccd5a[_0x5a7f74(0x134)](_0x5ec051=>{const _0x279fca=_0x5a7f74;if(_0x5ec051[_0x279fca(0xe0)]!='all')toggleBot(_0x5ec051[_0x279fca(0xe0)],toggleStatus(_0x5ec051[_0x279fca(0xe0)]),'stopped');});}else await sendTelegram(_0x496e3d[_0x5a7f74(0x2c3)]['id'],_0x5a7f74(0x27a)+_0x31e655),toggleBot(_0x31e655,toggleStatus(_0x31e655),_0x5a7f74(0x153));}),tgBot['command']('metrics',async _0x369647=>{const _0x4dfa86=_0x4b6396,_0xceadf9=getEnabledBots();if(_0xceadf9[_0x4dfa86(0x147)]==0x0)await sendTelegram(_0x369647[_0x4dfa86(0x2c3)]['id'],_0x4dfa86(0x253));else{if(_0xceadf9['length']>0x1){let _0x52029b=[],_0x429b18=[];const _0x398786=_0xceadf9['length']%0x4==0x0||_0xceadf9[_0x4dfa86(0x147)]%0x4==0x3||_0xceadf9['length']%0x3==0x1?0x4:0x3;let _0x3f77d9=0x0;_0xceadf9[_0x4dfa86(0x134)]((_0x1813a1,_0x2fc231)=>{const _0x5d8312=_0x4dfa86;if(_0x2fc231%_0x398786==0x0)_0x429b18=[];_0x429b18[_0x5d8312(0x226)](Markup[_0x5d8312(0xe9)][_0x5d8312(0x1ad)](_0x5d8312(0x264)+_0x1813a1[_0x5d8312(0xe0)],_0x5d8312(0x232)+_0x1813a1[_0x5d8312(0xe0)])),_0x2fc231%_0x398786==0x0&&(_0x52029b[_0x3f77d9]=_0x429b18,_0x3f77d9++);});const _0x2d6c26=Markup[_0x4dfa86(0x1ac)](_0x52029b);_0x369647[_0x4dfa86(0x1fc)](_0x4dfa86(0x2c7),_0x2d6c26);}else{const _0x54eb4d=_0xceadf9[0x0]['botID'];if(pid[_0x54eb4d])pid[_0x54eb4d]['send']({'function':_0x4dfa86(0x1ce),'args':null});}}}),tgBot[_0x4b6396(0xc4)](/metrics_(.+)/,async _0x423372=>{const _0x12c18c=_0x4b6396,_0x2851bb=_0x423372[_0x12c18c(0x2d2)][0x1];_0x423372['editMessageReplyMarkup']();if(pid[_0x2851bb])pid[_0x2851bb]['send']({'function':_0x12c18c(0x1ce),'args':null});}),tgBot[_0x4b6396(0x154)](_0x4b6396(0x242),async _0xcf56ed=>{const _0x61c32c=_0x4b6396,_0x102107=getEnabledBots();if(_0x102107[_0x61c32c(0x147)]==0x0)await sendTelegram(_0xcf56ed[_0x61c32c(0x2c3)]['id'],_0x61c32c(0x253));else{if(_0x102107[_0x61c32c(0x147)]>0x1){let _0x1d8735=[],_0x219c14=[];const _0x207193=_0x102107['length']%0x4==0x0||_0x102107['length']%0x4==0x3||_0x102107['length']%0x3==0x1?0x4:0x3;let _0x34fd2d=0x0;_0x102107[_0x61c32c(0x134)]((_0xf4bee6,_0x2da556)=>{const _0x5387e4=_0x61c32c;if(_0x2da556%_0x207193==0x0)_0x219c14=[];_0x219c14[_0x5387e4(0x226)](Markup[_0x5387e4(0xe9)]['callback']('Bot\x20'+_0xf4bee6[_0x5387e4(0xe0)],_0x5387e4(0x109)+_0xf4bee6[_0x5387e4(0xe0)])),_0x2da556%_0x207193==0x0&&(_0x1d8735[_0x34fd2d]=_0x219c14,_0x34fd2d++);});const _0x1ed6a3=Markup[_0x61c32c(0x1ac)](_0x1d8735);_0xcf56ed[_0x61c32c(0x1fc)](_0x61c32c(0x24c),_0x1ed6a3);}else{const _0xc4313f=_0x102107[0x0][_0x61c32c(0xe0)];if(pid[_0xc4313f])pid[_0xc4313f]['send']({'function':_0x61c32c(0x228),'args':null});}}}),tgBot[_0x4b6396(0xc4)](/portfolio_(.+)/,async _0xbebfa1=>{const _0x75e0f5=_0x4b6396,_0x506a26=_0xbebfa1[_0x75e0f5(0x2d2)][0x1];_0xbebfa1['editMessageReplyMarkup']();if(pid[_0x506a26])pid[_0x506a26][_0x75e0f5(0x28f)]({'function':_0x75e0f5(0x228),'args':null});}),tgBot[_0x4b6396(0x154)](_0x4b6396(0x25a),async _0x446d0f=>{const _0x26485d=_0x4b6396;await getMessages();if(!updateAvailable)await sendTelegram(_0x446d0f[_0x26485d(0x2c3)]['id'],_0x26485d(0xe4));else{if(!validInstallation)await sendTelegram(_0x446d0f[_0x26485d(0x2c3)]['id'],_0x26485d(0xcd));else{const _0x195794=Markup[_0x26485d(0x1ac)]([Markup[_0x26485d(0xe9)][_0x26485d(0x1ad)](_0x26485d(0x145),_0x26485d(0xfe)),Markup['button'][_0x26485d(0x1ad)]('No',_0x26485d(0x2b9))]);_0x446d0f[_0x26485d(0x1fc)](_0x26485d(0xee),_0x195794);}}}),tgBot[_0x4b6396(0xc4)](/update_(.+)/,async _0x287ece=>{const _0x272c5f=_0x4b6396,_0x2bd83f=_0x287ece['match'][0x1];_0x287ece[_0x272c5f(0x2b1)](),_0x2bd83f==_0x272c5f(0x189)&&(await sendTelegram(_0x287ece[_0x272c5f(0x2c3)]['id'],_0x272c5f(0x29a)),updateBB(_0x272c5f(0x25a))),_0x2bd83f=='no'&&await sendTelegram(_0x287ece['chat']['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot['command'](_0x4b6396(0x266),async _0x902629=>{const _0x26ec77=_0x4b6396;if(!validInstallation)await sendTelegram(_0x902629[_0x26ec77(0x2c3)]['id'],_0x26ec77(0x1ba));else{const _0x1b8235=Markup['inlineKeyboard']([Markup[_0x26ec77(0xe9)][_0x26ec77(0x1ad)](_0x26ec77(0x145),_0x26ec77(0x13d)),Markup[_0x26ec77(0xe9)]['callback']('No',_0x26ec77(0x169))]);_0x902629[_0x26ec77(0x1fc)](_0x26ec77(0x2c8),_0x1b8235);}}),tgBot['action'](/reinstall_(.+)/,async _0x1fa528=>{const _0x311cf3=_0x4b6396,_0x27388e=_0x1fa528[_0x311cf3(0x2d2)][0x1];_0x1fa528[_0x311cf3(0x2b1)](),_0x27388e==_0x311cf3(0x189)&&(await sendTelegram(_0x1fa528[_0x311cf3(0x2c3)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB('reinstall')),_0x27388e=='no'&&await sendTelegram(_0x1fa528[_0x311cf3(0x2c3)]['id'],_0x311cf3(0x16e));}),tgBot[_0x4b6396(0x154)]('toggle',async _0x53dd32=>{const _0x3439e1=_0x4b6396,_0x53c31d=getBotsWithMode();if(_0x53c31d['length']==0x0)await sendTelegram(_0x53dd32[_0x3439e1(0x2c3)]['id'],_0x3439e1(0x253));else{let _0xec4416=[],_0x129146=[];const _0x590ffb=0x2;let _0x6b3e71=0x0;_0x53c31d[_0x3439e1(0x134)]((_0x1abbbd,_0x550653)=>{const _0x229f1e=_0x3439e1;if(_0x550653%_0x590ffb==0x0)_0x129146=[];_0x129146[_0x229f1e(0x226)](Markup[_0x229f1e(0xe9)]['callback'](_0x229f1e(0x264)+_0x1abbbd[_0x229f1e(0xe0)]+'\x20('+_0x1abbbd[_0x229f1e(0xc5)]+')','toggle_'+_0x1abbbd['botID'])),_0x550653%_0x590ffb==0x0&&(_0xec4416[_0x6b3e71]=_0x129146,_0x6b3e71++);});const _0x543631=Markup[_0x3439e1(0x1ac)](_0xec4416);_0x53dd32[_0x3439e1(0x1fc)](_0x3439e1(0x28a),_0x543631);}}),tgBot[_0x4b6396(0xc4)](/toggle_(.+)/,async _0x564a5e=>{const _0x4a5792=_0x4b6396,_0x136846=_0x564a5e[_0x4a5792(0x2d2)][0x1];_0x564a5e[_0x4a5792(0x2b1)]();const _0x14ad26=getBotsWithMode(),_0x450e86=_0x14ad26['find'](_0x1d46e6=>_0x1d46e6[_0x4a5792(0xe0)]==_0x136846),_0x5a179e=_0x450e86['mode']==_0x4a5792(0x269)?'manual':_0x4a5792(0x269);await sendTelegram(_0x564a5e[_0x4a5792(0x2c3)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x136846+'\x20to\x20'+_0x5a179e+'\x20mode'),toggleBotMode(_0x136846);}),tgBot[_0x4b6396(0x154)]('names',async _0x172698=>{const _0x191f46=_0x4b6396;let _0x597470='';config['forEach'](_0x4a3b2a=>{const _0x761431=_0x5e43;_0x597470+=_0x761431(0x264)+_0x4a3b2a[_0x761431(0xe0)]+':\x20'+_0x4a3b2a['botname']+'\x0a';}),await sendTelegram(_0x172698[_0x191f46(0x2c3)]['id'],_0x597470,{'parse_mode':'HTML'});}),tgBot[_0x4b6396(0x154)](_0x4b6396(0x25e),async _0x2c15d9=>{const _0x1c96c=_0x4b6396;await sendTelegram(_0x2c15d9[_0x1c96c(0x2c3)]['id'],_0x473e68);}),process[_0x4b6396(0x1be)](_0x4b6396(0x191),()=>tgBot['stop'](_0x4b6396(0x191))),process[_0x4b6396(0x1be)](_0x4b6396(0x2a4),()=>tgBot[_0x4b6396(0x19e)](_0x4b6396(0x2a4))),tgBot[_0x4b6396(0x1e5)]();}}function disableTelegram(){const _0x2fed7e=_0xab0e8e;tgBot&&tgBot[_0x2fed7e(0x19e)]();}async function sendTelegram(_0x5acfd7,_0x584e13,_0x1f4514){const _0x4ada64=_0xab0e8e;_0x1f4514={..._0x1f4514,'disable_web_page_preview':!![]};try{await tgBot['telegram'][_0x4ada64(0x106)](_0x5acfd7,_0x584e13,_0x1f4514);}catch(_0x84f457){console[_0x4ada64(0x150)](_0x4ada64(0x2d4),_0x84f457);}}async function sendTelegramBot(_0x20f644,_0x4d5ea3){const _0x4733c9=_0xab0e8e;if(settings[_0x4733c9(0x2b4)]){if(settings[_0x4733c9(0x23f)]==_0x4733c9(0x104)||(_0x4d5ea3[_0x4733c9(0x175)]==_0x4733c9(0x160)||_0x4d5ea3[_0x4733c9(0x175)]==_0x4733c9(0x139)||_0x4d5ea3['type']==_0x4733c9(0x1d6))&&settings['telegramEvents']=='alerts'||_0x4d5ea3[_0x4733c9(0x175)]==_0x4733c9(0x14b)&&settings[_0x4733c9(0x23f)]==_0x4733c9(0x236)){if(tgBot&&settings[_0x4733c9(0x21c)]){if(_0x4d5ea3[_0x4733c9(0x18f)])await sendTelegram(settings['telegramChatId'],_0x4d5ea3[_0x4733c9(0x1d9)]+_0x4733c9(0x132)+_0x4d5ea3[_0x4733c9(0xd3)]);else await sendTelegram(settings['telegramChatId'],_0x4733c9(0x264)+_0x20f644+_0x4733c9(0x132)+_0x4d5ea3[_0x4733c9(0xd3)]);}}}}async function sendTelegramMsg(_0xa989c,_0x189b6e=_0xab0e8e(0x10f)){const _0x731d92=_0xab0e8e;return settings[_0x731d92(0x2b4)]&&tgBot&&settings[_0x731d92(0x21c)]?(await sendTelegram(settings[_0x731d92(0x21c)],_0xa989c,{'parse_mode':_0x189b6e}),!![]):![];}function getDeviceWithIp(_0x21a4cd){return devices['find'](_0x4215cc=>_0x4215cc['ip']===_0x21a4cd);}async function temporaryAccess2FA(_0x228e8d,_0x55962e){const _0x2be058=_0xab0e8e;let _0x4320e6=new Date(),_0xa2ff2e=![];if(lastIpApproval){if(_0x4320e6-lastIpApproval<0x1388)_0xa2ff2e=!![];}lastIpApproval=new Date();if(_0xa2ff2e)return;if(tgBot&&settings['telegramChatId']){const _0x1a51d8=uuidRandom();tmpStorage[_0x1a51d8]={'uuid':_0x228e8d,'externalip':_0x55962e};const _0x209409=Markup[_0x2be058(0x1ac)]([Markup[_0x2be058(0xe9)][_0x2be058(0x1ad)](_0x2be058(0x26e),_0x2be058(0x15e)+_0x1a51d8),Markup[_0x2be058(0xe9)][_0x2be058(0x1ad)]('15\x20min',_0x2be058(0x297)+_0x1a51d8),Markup[_0x2be058(0xe9)][_0x2be058(0x1ad)](_0x2be058(0x24d),_0x2be058(0x1b3)+_0x1a51d8),Markup[_0x2be058(0xe9)]['callback']('reject',_0x2be058(0x173)+_0x1a51d8)]);await sendTelegram(settings[_0x2be058(0x21c)],_0x2be058(0x20d)+normalizeIP(_0x55962e)[_0x2be058(0x111)]+'\x20?',_0x209409),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x443bd5=>{const _0x1d268e=_0x2be058,_0x33fb44=_0x443bd5['match'][0x1],_0x141cf9=_0x443bd5['match'][0x2],{uuid:_0x394ca4,externalip:_0x1a26a9}=tmpStorage[_0x141cf9];delete tmpStorage[_0x141cf9],_0x443bd5[_0x1d268e(0x2b1)](),devices[_0x394ca4]['telegramIpApproval']={'clientip':_0x1a26a9,'timestamp':new Date()[_0x1d268e(0x23c)](),'expiry':_0x33fb44},_0x33fb44!='reject'?(await sendTelegram(_0x443bd5[_0x1d268e(0x2c3)]['id'],_0x1d268e(0x29d)+_0x33fb44+'\x20minutes',{'parse_mode':_0x1d268e(0x10f)}),io['to'](_0x394ca4)[_0x1d268e(0x2c6)](_0x1d268e(0x293),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x443bd5['chat']['id'],'Temporary\x20access\x20rejected'),io['to'](_0x394ca4)[_0x1d268e(0x2c6)]('status',{'access':{'allow':![],'reason':_0x1d268e(0x184),'token':null}}));});}}async function loginAccess2FA(_0x2afa2d,_0x4e2c52){const _0x1d4106=_0xab0e8e;if(tgBot&&settings[_0x1d4106(0x21c)]){const _0x5c5745=uuidRandom();tmpStorage[_0x5c5745]={'uuid':_0x2afa2d,'externalip':_0x4e2c52};const _0xb8d5c4=Markup['inlineKeyboard']([Markup[_0x1d4106(0xe9)][_0x1d4106(0x1ad)]('accept',_0x1d4106(0x1b4)+loginExpiry+'_'+_0x5c5745),Markup[_0x1d4106(0xe9)][_0x1d4106(0x1ad)](_0x1d4106(0x2a7),_0x1d4106(0x187)+_0x5c5745)]);await sendTelegram(settings[_0x1d4106(0x21c)],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x4e2c52)[_0x1d4106(0x111)]+'\x20?',_0xb8d5c4),tgBot[_0x1d4106(0xc4)](/login2fa_(.+)_(.+)/,async _0x10f9b4=>{const _0x568b8d=_0x1d4106,_0x18b662=_0x10f9b4[_0x568b8d(0x2d2)][0x1],_0x20f622=_0x10f9b4[_0x568b8d(0x2d2)][0x2],{uuid:_0x329e4d,externalip:_0x270bee}=tmpStorage[_0x20f622];delete tmpStorage[_0x20f622],_0x10f9b4['editMessageReplyMarkup'](),devices[_0x329e4d][_0x568b8d(0x24f)]={'clientip':_0x270bee,'timestamp':new Date()[_0x568b8d(0x23c)](),'expiry':_0x18b662},_0x18b662!=_0x568b8d(0x2a7)?(await sendTelegram(_0x10f9b4['chat']['id'],_0x568b8d(0x1cb),{'parse_mode':_0x568b8d(0x10f)}),io['to'](_0x329e4d)['emit'](_0x568b8d(0x293),{'access':{'allow':![],'reason':_0x568b8d(0xff),'token':null}})):(await sendTelegram(_0x10f9b4['chat']['id'],_0x568b8d(0x240)),io['to'](_0x329e4d)[_0x568b8d(0x2c6)](_0x568b8d(0x293),{'access':{'allow':![],'reason':_0x568b8d(0xf7),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x2547f2=_0xab0e8e;return dbConfig['get'](_0x2547f2(0x1b5))[_0x2547f2(0x2a3)](_0x2547f2(0xe0))[_0x2547f2(0x1c0)]({'status':_0x2547f2(0x2a2)})['value']()||[];}function getDisabledBots(){const _0x327eec=_0xab0e8e;return dbConfig['get'](_0x327eec(0x1b5))['sortBy'](_0x327eec(0xe0))[_0x327eec(0x1c0)]({'status':'disabled'})['value']()||[];}function getBotAttributes(_0x4fd68d){const _0x5dfa88=_0xab0e8e;let _0x4edb2a={};const _0x5e8e79=configpath+'bot-'+_0x4fd68d+'-config.json',_0x579a45=fs[_0x5dfa88(0x28b)](_0x5e8e79);if(_0x579a45){const _0x56340a=fs[_0x5dfa88(0x1cf)](_0x5e8e79);try{const _0x524705=JSON[_0x5dfa88(0x102)](_0x56340a),_0x2cd40e=_0x524705?_0x524705[_0x5dfa88(0x22b)][0x0][_0x5dfa88(0x1de)]:![];_0x4edb2a[_0x5dfa88(0xc5)]=_0x2cd40e?_0x5dfa88(0x269):_0x5dfa88(0xd5),_0x4edb2a['botname']=_0x524705?_0x524705[_0x5dfa88(0x22b)][0x0][_0x5dfa88(0x1d9)]:'Bot\x20'+_0x4fd68d;}catch(_0x37e2ce){_0x4edb2a[_0x5dfa88(0xc5)]=_0x5dfa88(0xd5),_0x4edb2a[_0x5dfa88(0x1d9)]=_0x5dfa88(0x264)+_0x4fd68d;}}else _0x4edb2a[_0x5dfa88(0xc5)]='manual',_0x4edb2a[_0x5dfa88(0x1d9)]=_0x5dfa88(0x264)+_0x4fd68d;return _0x4edb2a;}function getBotsWithMode(){const _0x5c56dd=_0xab0e8e,_0x2b47aa=dbConfig[_0x5c56dd(0x200)](_0x5c56dd(0x1b5))['sortBy'](_0x5c56dd(0xe0))[_0x5c56dd(0x27b)]()||[];return _0x2b47aa['forEach'](_0x1e20d0=>{const _0x2a3e5d=_0x5c56dd;let _0x380068=getBotAttributes(_0x1e20d0[_0x2a3e5d(0xe0)]);_0x1e20d0['mode']=_0x380068['mode'];}),_0x2b47aa;}function getBotExchanges(){const _0x531046=_0xab0e8e;let _0x18a154=[];const _0x10d1fd=dbConfig[_0x531046(0x200)](_0x531046(0x1b5))[_0x531046(0x2a3)](_0x531046(0xe0))[_0x531046(0x27b)]()||[];_0x10d1fd['forEach'](_0x5a3197=>{const _0x59b224=_0x531046;if(_0x5a3197[_0x59b224(0x293)]==_0x59b224(0x2a2)){const _0x48d7b3=configpath+_0x59b224(0xde)+_0x5a3197['botID']+_0x59b224(0x162),_0x426baa=fs[_0x59b224(0x28b)](_0x48d7b3);let _0x34f191;if(_0x426baa){const _0x535b49=fs[_0x59b224(0x1cf)](_0x48d7b3);try{const _0x52bfde=JSON['parse'](_0x535b49);_0x34f191=_0x52bfde?_0x52bfde[_0x59b224(0x22b)][0x0][_0x59b224(0x283)]:null;}catch(_0x2360b8){}}if(_0x34f191)_0x18a154[_0x59b224(0x226)](_0x34f191);}});const _0x3697d5=[...new Set(_0x18a154)][_0x531046(0xd6)]();return _0x3697d5;}async function initUser(){const _0x324d6=_0xab0e8e;if(!settings[_0x324d6(0x17d)]){const _0x38de5a=uuidRandom();mixpanel[_0x324d6(0x288)](_0x38de5a),updateSetting('userid',_0x38de5a);}}async function initSecure(){const _0x53156f=_0xab0e8e;let _0x213018=getSecure();if(!_0x213018[_0x53156f(0x1ca)](_0x53156f(0x258))){let _0x3b5f2a=await generateKeys();_0x213018[_0x53156f(0x277)]=_0x3b5f2a['publicKey'],_0x213018['privateKey']=_0x3b5f2a['privateKey'],_0x213018['secret']=crypto[_0x53156f(0x210)](0x20)[_0x53156f(0xf6)](_0x53156f(0x12b));;storeSecure(_0x213018);}}function getSettings(){const _0x4572f2=_0xab0e8e;return dbSettings[_0x4572f2(0x200)]('settings')[_0x4572f2(0x27b)]()||{};}function getSecure(){const _0x288879=_0xab0e8e;return dbSecure[_0x288879(0x200)]('secure')[_0x288879(0x27b)]()||{};}function getBlacklist(){const _0xd949aa=_0xab0e8e;return dbSecure['get']('blacklist')[_0xd949aa(0x27b)]()||[];}function broadcastToBots(_0x289d40,_0x57df4c){config['forEach'](_0x12c7b0=>{const _0x1de50e=_0x5e43;if(_0x12c7b0['status']==_0x1de50e(0x2a2)&&_0x12c7b0[_0x1de50e(0x29e)]=='running'||_0x12c7b0['status']==_0x1de50e(0xfb)&&_0x12c7b0[_0x1de50e(0x29e)]==_0x1de50e(0x29f)){if(pid[_0x12c7b0['botID']])pid[_0x12c7b0[_0x1de50e(0xe0)]]['send']({[_0x289d40]:_0x57df4c});}});}async function storeSettings(_0x1ec04d,_0x14385f=![]){const _0x12f675=_0xab0e8e;_0x1ec04d={...settings,..._0x1ec04d};if(_0x14385f&&_0x1ec04d[_0x12f675(0x114)]!=_0x12f675(0x25d)&&_0x1ec04d[_0x12f675(0x114)]!='***'&&_0x1ec04d['bbPassword']!=''){const _0x1dab74=decryptRSA(secure[_0x12f675(0x205)],_0x1ec04d['bbPassword'])[_0x12f675(0x231)](_0x12f675(0x129))[0x0],_0x363adb=bcrypt[_0x12f675(0x110)](_0x1dab74,saltRounds);_0x1ec04d={..._0x1ec04d,'bbPassword':_0x363adb};}if(_0x14385f&&_0x1ec04d[_0x12f675(0x10d)]!=_0x12f675(0x25d)&&_0x1ec04d[_0x12f675(0x10d)]!=_0x12f675(0x2b3)&&_0x1ec04d['telegramToken']!=''){const _0x3921dc=decryptRSA(secure[_0x12f675(0x205)],_0x1ec04d['telegramToken'])[_0x12f675(0x231)](_0x12f675(0x129))[0x0];_0x1ec04d={..._0x1ec04d,'telegramToken':_0x3921dc};}if(_0x14385f&&_0x1ec04d['marketcapApi']!=_0x12f675(0x25d)&&_0x1ec04d[_0x12f675(0x181)]!='***'&&_0x1ec04d[_0x12f675(0x181)]!=''){const _0x272884=decryptRSA(secure[_0x12f675(0x205)],_0x1ec04d['marketcapApi'])[_0x12f675(0x231)](_0x12f675(0x129))[0x0];_0x1ec04d={..._0x1ec04d,'marketcapApi':_0x272884};}const _0x3ff361=_0x1ec04d[_0x12f675(0x10d)]!=_0x12f675(0x25d)&&_0x1ec04d['telegramToken']!=settings['telegramToken']||_0x1ec04d[_0x12f675(0xe1)]!=settings[_0x12f675(0xe1)],_0x1b655f=_0x1ec04d['telegramToken']==''||_0x1ec04d['telegramUsername']=='',_0x5a13b=_0x1ec04d['marketcapApi']&&_0x1ec04d[_0x12f675(0x181)]!=_0x12f675(0x25d)&&_0x1ec04d[_0x12f675(0x181)]!=settings[_0x12f675(0x10d)];_0x3ff361&&(_0x1ec04d[_0x12f675(0x21c)]=null,_0x1ec04d[_0x12f675(0x23f)]=_0x12f675(0x104));for(const [_0x1bccf0,_0x1565c1]of Object[_0x12f675(0x211)](_0x1ec04d)){if(_0x1bccf0==_0x12f675(0x10d)&&_0x1565c1==_0x12f675(0x25d)){_0x1ec04d[_0x12f675(0x10d)]=settings[_0x12f675(0x10d)];continue;};if(_0x1bccf0=='bbPassword'&&_0x1565c1==_0x12f675(0x25d)){_0x1ec04d['bbPassword']=settings[_0x12f675(0x114)];continue;};if(_0x1bccf0==_0x12f675(0x181)&&_0x1565c1=='************'){_0x1ec04d['marketcapApi']=settings[_0x12f675(0x181)];continue;};dbSettings[_0x12f675(0xfc)](_0x12f675(0x21f)+_0x1bccf0,_0x1565c1)[_0x12f675(0x299)]();}settings=_0x1ec04d,io['to']('botmanager')[_0x12f675(0x2c6)](_0x12f675(0x20b),cleanSettings()),broadcastToBots(_0x12f675(0x2b5),settings[_0x12f675(0x2b5)]),broadcastToBots('onepagemode',settings['onepagemode']),broadcastToBots('marketcapApi',settings[_0x12f675(0x181)]);if(_0x3ff361&&!_0x1b655f)initTelegram();if(_0x3ff361&&_0x1b655f)disableTelegram();getAllClients()[_0x12f675(0x134)](_0x3cd4a9=>{const _0x1f2688=_0x12f675;getSocket(_0x3cd4a9['id'])[_0x1f2688(0x2c6)]('status',{'access':{'allow':![],'reason':_0x1f2688(0xff),'token':null}});}),_0x5a13b&&(await sleep(0xbb8),testMarketcapApi(_0x1ec04d['marketcapApi']));}async function testMarketcapApi(_0x18398c){const _0x249ce3=_0xab0e8e,_0x12db07=[_0x249ce3(0x21a),'ETH'];try{await axios[_0x249ce3(0x200)](_0x249ce3(0x254),{'headers':{'X-CMC_PRO_API_KEY':_0x18398c},'params':{'symbol':_0x12db07[_0x249ce3(0xf6)]()}});}catch(_0x26b810){_0x26b810[_0x249ce3(0xf6)]()[_0x249ce3(0x1db)](_0x249ce3(0x2cd))?(io['to']('botmanager')[_0x249ce3(0x2c6)](_0x249ce3(0x151),_0x249ce3(0x192)),logger[_0x249ce3(0x217)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to'](_0x249ce3(0x11b))['emit'](_0x249ce3(0x151),_0x249ce3(0x1b6)),logger[_0x249ce3(0x217)]('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x249ce3(0xce)]('Error\x20details:',_0x26b810['toString']()+'\x20-\x20'+_0x26b810[_0x249ce3(0x1b8)]));return;}logger[_0x249ce3(0xce)](_0x249ce3(0x13c));}function updateSetting(_0x1c213e,_0x1b93aa){const _0xeb8dff=_0xab0e8e;dbSettings['set'](_0xeb8dff(0x21f)+_0x1c213e,_0x1b93aa)[_0xeb8dff(0x299)](),settings=getSettings(),io['to'](_0xeb8dff(0x11b))[_0xeb8dff(0x2c6)](_0xeb8dff(0x20b),cleanSettings());}function storeSecure(_0x3e5dcd){const _0x212570=_0xab0e8e;dbSecure[_0x212570(0x200)](_0x212570(0x286))[_0x212570(0x226)](_0x3e5dcd)[_0x212570(0x299)](),secure=_0x3e5dcd;}function addBlacklist(_0x57c31b){const _0xe4f314=_0xab0e8e;cleanBlacklist();let _0x485ee0;devices[_0x57c31b][_0xe4f314(0xe2)]?_0x485ee0=Math[_0xe4f314(0x1a2)](devices[_0x57c31b]['telegramIpApproval'][_0xe4f314(0x194)],loginExpiry):_0x485ee0=loginExpiry,dbSecure[_0xe4f314(0x200)](_0xe4f314(0x115))['push']({'expiry':new Date()[_0xe4f314(0x23c)]()+_0x485ee0*0x3c*0x3e8,'token':devices[_0x57c31b][_0xe4f314(0x2a6)][_0xe4f314(0x1c2)]})['write'](),blacklist=dbSecure[_0xe4f314(0x200)](_0xe4f314(0x115))[_0xe4f314(0x27b)]();}function cleanBlacklist(){const _0x1490e1=_0xab0e8e;let _0x4aadda=dbSecure[_0x1490e1(0x200)](_0x1490e1(0x115))[_0x1490e1(0x120)]()[_0x1490e1(0x27b)](),_0x5a7f8b=new Date()['getTime']();_0x4aadda['forEach'](_0x4e5c4b=>{const _0x738995=_0x1490e1;_0x4e5c4b[_0x738995(0x194)]<_0x5a7f8b&&dbSecure['get']('blacklist')[_0x738995(0x2ac)]({'expiry':_0x4e5c4b['expiry']})[_0x738995(0x299)]();});}function initStates(){const _0x43bc9a=_0xab0e8e;let _0xced57a=getConfiguration();_0xced57a[_0x43bc9a(0x134)](_0x52b399=>{const _0x705504=_0x43bc9a;_0x52b399['live']=_0x705504(0x153);}),storeConfiguration(_0xced57a);}async function generateKeys(){const _0xa28e8b=_0xab0e8e,_0x15ddc7=forge[_0xa28e8b(0x18a)]['rsa'][_0xa28e8b(0x257)]({'bits':0x1000,'e':0x10001}),_0x686ebb=forge['pki'][_0xa28e8b(0x22f)](_0x15ddc7[_0xa28e8b(0x205)]),_0x2037f7=forge[_0xa28e8b(0x18a)][_0xa28e8b(0x280)](_0x15ddc7[_0xa28e8b(0x277)]);return{'privateKey':_0x686ebb,'publicKey':_0x2037f7};}async function oneTimeMigration(){const _0x2c92bf=_0xab0e8e;let _0x4c3548=getSettings(),_0xb2fa97=![];!_0x4c3548['hasOwnProperty'](_0x2c92bf(0x146))&&(_0x4c3548[_0x2c92bf(0x146)]=0x0,_0xb2fa97=!![]);!_0x4c3548['hasOwnProperty'](_0x2c92bf(0x177))&&(_0x4c3548['lastmsgemitted']=0x0,_0xb2fa97=!![]);!_0x4c3548[_0x2c92bf(0x1ca)](_0x2c92bf(0xf1))&&(_0x4c3548[_0x2c92bf(0xf1)]=_0x2c92bf(0x1d7),_0xb2fa97=!![]);!_0x4c3548[_0x2c92bf(0x1ca)]('onepagemode')&&(_0x4c3548[_0x2c92bf(0x14a)]=![],_0xb2fa97=!![]);!_0x4c3548[_0x2c92bf(0x1ca)]('marketcapApi')&&(_0x4c3548['marketcapApi']='',_0xb2fa97=!![]);if(_0xb2fa97)storeSettings(_0x4c3548);try{fs[_0x2c92bf(0x1bd)](configbackuppath,{'withFileTypes':!![]})[_0x2c92bf(0x134)](_0x1185e2=>{const _0xcccdad=_0x2c92bf;if(!_0x1185e2[_0xcccdad(0x1eb)]()){if(!_0x1185e2[_0xcccdad(0xf5)]['startsWith'](_0xcccdad(0x1e1)))fs[_0xcccdad(0x183)](configbackuppath+_0x1185e2[_0xcccdad(0xf5)]);}else fs[_0xcccdad(0x174)](configbackuppath+_0x1185e2['name'],{'recursive':!![]});});}catch(_0x339473){logger['debug']('Error\x20removing\x20old\x20backup\x20files:',_0x339473);}}function storeConfiguration(_0x3bcaf7){const _0x5e79fa=_0xab0e8e;dbConfig[_0x5e79fa(0x200)](_0x5e79fa(0x1b5))[_0x5e79fa(0x2ac)]()['write'](),dbConfig[_0x5e79fa(0x200)](_0x5e79fa(0x1b5))[_0x5e79fa(0x226)](..._0x3bcaf7)['write'](),config=_0x3bcaf7;}async function resetPassword(){const _0x3bfdb8=_0xab0e8e;if(tgBot&&settings['telegramChatId']){const _0x51a13=Markup[_0x3bfdb8(0x1ac)]([Markup['button'][_0x3bfdb8(0x1ad)](_0x3bfdb8(0x189),_0x3bfdb8(0x287)),Markup[_0x3bfdb8(0xe9)][_0x3bfdb8(0x1ad)]('no',_0x3bfdb8(0x105))]);await sendTelegram(settings['telegramChatId'],_0x3bfdb8(0x198),_0x51a13),tgBot['action'](/resetpw_(.+)/,async _0x35acb4=>{const _0x1a8e5c=_0x3bfdb8,_0xd51eae=_0x35acb4['match'][0x1];_0x35acb4['editMessageReplyMarkup']();if(_0xd51eae!='no'){const _0xacf880=0xf,_0x54d0e2=_0x1a8e5c(0x138),_0x2f6c8c=Array[_0x1a8e5c(0x142)](crypto[_0x1a8e5c(0x243)](new Uint32Array(_0xacf880)))[_0x1a8e5c(0x268)](_0x2a287a=>_0x54d0e2[_0x2a287a%_0x54d0e2['length']])['join'](''),_0x9ecd94=bcrypt[_0x1a8e5c(0x110)](_0x2f6c8c,saltRounds);storeSettings({'bbPassword':_0x9ecd94}),await sendTelegram(_0x35acb4[_0x1a8e5c(0x2c3)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x2f6c8c,{'parse_mode':_0x1a8e5c(0x10f)});}else await sendTelegram(_0x35acb4[_0x1a8e5c(0x2c3)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x14c048,_0x29c332){const _0x4c84dd=_0xab0e8e;io['to'](_0x4c84dd(0x11b))[_0x4c84dd(0x2c6)](_0x4c84dd(0x151),_0x4c84dd(0x202),'success');if(tgBot&&settings[_0x4c84dd(0x21c)]){const _0x8392f3=uuidRandom();tmpStorage[_0x8392f3]={'path':_0x14c048,'filename':_0x29c332};const _0x4b485f=Markup[_0x4c84dd(0x1ac)]([Markup['button'][_0x4c84dd(0x1ad)](_0x4c84dd(0x189),'restore_yes_'+_0x8392f3),Markup[_0x4c84dd(0xe9)][_0x4c84dd(0x1ad)]('no','restore_no_'+_0x8392f3)]);await sendTelegram(settings['telegramChatId'],_0x4c84dd(0x1d2),_0x4b485f),tgBot[_0x4c84dd(0xc4)](/restore_(.+)_(.+)/,async _0x4eca06=>{const _0x525881=_0x4c84dd,_0x2a4e0e=_0x4eca06['match'][0x1],_0x43b91d=_0x4eca06['match'][0x2],{path:_0x1ab30a,filename:_0x3f4306}=tmpStorage[_0x43b91d];delete tmpStorage[_0x43b91d],_0x4eca06[_0x525881(0x2b1)](),_0x2a4e0e==_0x525881(0x189)?(logger['debug'](_0x525881(0xc3)),await sendTelegram(_0x4eca06[_0x525881(0x2c3)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x525881(0x10f)}),unzipFile(_0x1ab30a,_0x3f4306)):(logger[_0x525881(0xce)](_0x525881(0x233)),await sendTelegram(_0x4eca06[_0x525881(0x2c3)]['id'],_0x525881(0x233)));});}}function getServerTime(){const _0x42cca3=_0xab0e8e,_0x35f2f1=new Date();return _0x35f2f1[_0x42cca3(0x2a0)]()+'/'+(_0x35f2f1[_0x42cca3(0x2cf)]()+0x1)[_0x42cca3(0xf6)]()[_0x42cca3(0x182)](0x2,'0')+'/'+_0x35f2f1['getDate']()[_0x42cca3(0xf6)]()[_0x42cca3(0x182)](0x2,'0')+'\x20'+_0x35f2f1[_0x42cca3(0x1e3)]()['toString']()[_0x42cca3(0x182)](0x2,'0')+':'+_0x35f2f1['getMinutes']()[_0x42cca3(0xf6)]()[_0x42cca3(0x182)](0x2,'0')+':'+_0x35f2f1[_0x42cca3(0x1ed)]()['toString']()[_0x42cca3(0x182)](0x2,'0');}function getTimeStamp(){const _0xc0f2d9=_0xab0e8e,_0x3d4038=shiftedTime();return _0x3d4038[_0xc0f2d9(0x2a0)]()+'/'+(_0x3d4038[_0xc0f2d9(0x2cf)]()+0x1)[_0xc0f2d9(0xf6)]()[_0xc0f2d9(0x182)](0x2,'0')+'/'+_0x3d4038[_0xc0f2d9(0x2c0)]()[_0xc0f2d9(0xf6)]()[_0xc0f2d9(0x182)](0x2,'0')+'\x20'+_0x3d4038[_0xc0f2d9(0x1e3)]()[_0xc0f2d9(0xf6)]()[_0xc0f2d9(0x182)](0x2,'0')+':'+_0x3d4038[_0xc0f2d9(0x143)]()[_0xc0f2d9(0xf6)]()[_0xc0f2d9(0x182)](0x2,'0')+':'+_0x3d4038['getSeconds']()['toString']()[_0xc0f2d9(0x182)](0x2,'0');}function getCleanTimeStamp(){const _0xb2401a=_0xab0e8e,_0x5c6028=shiftedTime();return _0x5c6028[_0xb2401a(0x2a0)]()+(_0x5c6028[_0xb2401a(0x2cf)]()+0x1)[_0xb2401a(0xf6)]()['padStart'](0x2,'0')+_0x5c6028[_0xb2401a(0x2c0)]()[_0xb2401a(0xf6)]()[_0xb2401a(0x182)](0x2,'0')+'-'+_0x5c6028['getHours']()[_0xb2401a(0xf6)]()[_0xb2401a(0x182)](0x2,'0')+_0x5c6028[_0xb2401a(0x143)]()[_0xb2401a(0xf6)]()['padStart'](0x2,'0')+_0x5c6028['getSeconds']()[_0xb2401a(0xf6)]()[_0xb2401a(0x182)](0x2,'0');}function shiftedTime(){const _0x6fdc9b=_0xab0e8e,_0x5abfea=new Date();let _0x4efc78=_0x5abfea;if(settings['timeshift']&&settings[_0x6fdc9b(0x2b5)]!==0x0)_0x4efc78=fns[_0x6fdc9b(0xda)](_0x5abfea,{'hours':settings[_0x6fdc9b(0x2b5)]});return _0x4efc78;}async function startScheduler(){const _0x1a57e6=_0xab0e8e,_0x2e350c=new Date()['getUTCHours'](),_0x46cb45=shiftedTime()[_0x1a57e6(0x1e3)]();_0x46cb45==0x4&&backupConfigFiles(),_0x46cb45==0x0&&rotateLogFiles(),_0x2e350c%0x6==0x0&&triggerAnalytics(),_0x2e350c%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0xbb166){const _0x39f2cb=_0xab0e8e;logger['debug'](_0x39f2cb(0x275)+_0xbb166);const _0x4987be=getBotsWithMode();_0x4987be[_0x39f2cb(0x147)]>0x0?confirmRestore(configbackuppath,_0xbb166):unzipFile(configbackuppath,_0xbb166);}async function getBackupFiles(_0x5f2e1a=null){const _0x3a7f44=_0xab0e8e;let _0x5e4e0c=[],_0x326c92=fs[_0x3a7f44(0x1bd)](configbackuppath,{'withFileTypes':!![]});_0x326c92[_0x3a7f44(0xd6)]((_0x148a0f,_0x5660dc)=>_0x148a0f[_0x3a7f44(0xf5)]<_0x5660dc[_0x3a7f44(0xf5)]?0x1:_0x5660dc['name']<_0x148a0f['name']?-0x1:0x0),_0x326c92[_0x3a7f44(0x134)](_0x5821de=>{const _0x5dc952=_0x3a7f44;if(!_0x5821de['isDirectory']()&&_0x5821de[_0x5dc952(0xf5)][_0x5dc952(0x149)](_0x5dc952(0x1e1))&&_0x5821de[_0x5dc952(0xf5)][_0x5dc952(0x244)](_0x5dc952(0xf3))){const _0x203bae=formatDate(fs[_0x5dc952(0x17e)](configbackuppath+_0x5821de[_0x5dc952(0xf5)])['mtime']);_0x5e4e0c[_0x5dc952(0x226)]({'name':_0x5821de[_0x5dc952(0xf5)],'mtime':_0x203bae});}});if(_0x5f2e1a)io['to'](_0x5f2e1a)[_0x3a7f44(0x2c6)](_0x3a7f44(0x176),_0x5e4e0c);else return _0x5e4e0c;}function _0x5e43(_0x505e73,_0x41a3b6){const _0x5df9df=_0x317f();return _0x5e43=function(_0x590538,_0x4e2341){_0x590538=_0x590538-0xc3;let _0x317f05=_0x5df9df[_0x590538];return _0x317f05;},_0x5e43(_0x505e73,_0x41a3b6);}async function backupConfigFiles(){const _0x384985=_0xab0e8e;await zipFiles(_0x384985(0x19f));const _0x21a4a0=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x384985(0x12f),configbackuppath+(_0x384985(0x1e1)+_0x21a4a0+_0x384985(0xf3)));let _0x299512=fs[_0x384985(0x1bd)](configbackuppath,{'withFileTypes':!![]});_0x299512[_0x384985(0xd6)]((_0x20ead1,_0x510193)=>_0x20ead1[_0x384985(0xf5)]<_0x510193[_0x384985(0xf5)]?0x1:_0x510193[_0x384985(0xf5)]<_0x20ead1[_0x384985(0xf5)]?-0x1:0x0),_0x299512[_0x384985(0x147)]>maxBackups&&fs[_0x384985(0x183)](configbackuppath+_0x299512[_0x299512[_0x384985(0x147)]-0x1][_0x384985(0xf5)]);}function rotateLogFiles(){const _0x2d4d81=_0xab0e8e,_0x19ab9d=fs[_0x2d4d81(0x17e)](logspath+'output-000.log'),_0x3cee10=_0x19ab9d[_0x2d4d81(0x1c3)]/0x400;if(_0x3cee10>0x64){let _0x55cfc6=fs[_0x2d4d81(0x1bd)](logspath,{'withFileTypes':!![]});_0x55cfc6[_0x2d4d81(0xd6)]((_0x1dffe7,_0x453734)=>_0x1dffe7[_0x2d4d81(0xf5)]<_0x453734[_0x2d4d81(0xf5)]?0x1:_0x453734[_0x2d4d81(0xf5)]<_0x1dffe7[_0x2d4d81(0xf5)]?-0x1:0x0),_0x55cfc6[_0x2d4d81(0x134)](_0x327d3f=>{const _0x5ee219=_0x2d4d81;if(_0x327d3f[_0x5ee219(0xf5)]==_0x5ee219(0x250))fs[_0x5ee219(0x11a)](logspath+_0x327d3f[_0x5ee219(0xf5)],logspath+_0x5ee219(0xd1));if(_0x327d3f[_0x5ee219(0xf5)]==_0x5ee219(0x137))fs[_0x5ee219(0x11a)](logspath+_0x327d3f[_0x5ee219(0xf5)],logspath+_0x5ee219(0x250));_0x327d3f['name']==_0x5ee219(0x1f4)&&(fs['copyFileSync'](logspath+_0x327d3f[_0x5ee219(0xf5)],logspath+_0x5ee219(0x137)),fs[_0x5ee219(0x17f)](logspath+_0x327d3f['name'],''));});}}async function zipFiles(_0x403abc){const _0x349df8=_0xab0e8e;let _0x29d5af;if(_0x403abc==_0x349df8(0x1d5))_0x29d5af=logspath;if(_0x403abc==_0x349df8(0x117))_0x29d5af=configpath;if(_0x403abc==_0x349df8(0x19f))_0x29d5af=configpath;let _0x2b0b93=fs[_0x349df8(0x1bd)](_0x29d5af,{'withFileTypes':!![]});const _0x1d56cd=new JSZip();_0x2b0b93[_0x349df8(0x134)](_0x3ca213=>{const _0x394d26=_0x349df8;if(!_0x3ca213[_0x394d26(0x1eb)]()){let _0x4bfca5=fs[_0x394d26(0x1cf)](_0x29d5af+_0x3ca213[_0x394d26(0xf5)]);if(_0x403abc=='backup'){const _0x4cb60b=/^bot-[0-9]{3}-config.json$/,_0x2cb7ec=_0x4cb60b[_0x394d26(0x248)](_0x3ca213[_0x394d26(0xf5)]);if(_0x2cb7ec){const _0x2bc582=JSON[_0x394d26(0x102)](_0x4bfca5);if(_0x2bc582['bot'][0x0]){_0x2bc582[_0x394d26(0x22b)][0x0][_0x394d26(0x2c9)]=_0x394d26(0x2b3),_0x2bc582['bot'][0x0][_0x394d26(0x2b2)]=_0x394d26(0x2b3);if(_0x2bc582['bot'][0x0][_0x394d26(0x14d)])_0x2bc582['bot'][0x0][_0x394d26(0x14d)]=_0x394d26(0x2b3);}_0x4bfca5=JSON[_0x394d26(0x298)](_0x2bc582,null,0x2);}if(_0x3ca213['name']==_0x394d26(0x131)){const _0x2066b9=JSON[_0x394d26(0x102)](_0x4bfca5);if(_0x2066b9[_0x394d26(0x20b)][_0x394d26(0x141)])_0x2066b9[_0x394d26(0x20b)][_0x394d26(0x141)]=![];if(_0x2066b9[_0x394d26(0x20b)][_0x394d26(0x114)])_0x2066b9[_0x394d26(0x20b)][_0x394d26(0x114)]=_0x394d26(0x2b3);if(_0x2066b9[_0x394d26(0x20b)][_0x394d26(0x10d)])_0x2066b9[_0x394d26(0x20b)]['telegramToken']=_0x394d26(0x2b3);if(_0x2066b9['settings'][_0x394d26(0x21c)])_0x2066b9[_0x394d26(0x20b)][_0x394d26(0x21c)]=null;if(_0x2066b9[_0x394d26(0x20b)]['marketcapApi'])_0x2066b9[_0x394d26(0x20b)][_0x394d26(0x181)]=_0x394d26(0x2b3);_0x4bfca5=JSON[_0x394d26(0x298)](_0x2066b9,null,0x2);}if(_0x3ca213[_0x394d26(0xf5)]!=_0x394d26(0x28c))_0x1d56cd[_0x394d26(0x265)](_0x3ca213[_0x394d26(0xf5)],_0x4bfca5);}else _0x1d56cd[_0x394d26(0x265)](_0x3ca213[_0x394d26(0xf5)],_0x4bfca5);}});const _0x68a66f=await _0x1d56cd['generateAsync']({'type':'string','base64':![],'compression':_0x349df8(0x16a)});fs[_0x349df8(0x17f)](zippath+(_0x403abc+_0x349df8(0xf3)),_0x68a66f,'binary');}async function unzipFile(_0x5b83ef,_0x32068a){const _0x33c62b=_0xab0e8e;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x33c62b(0x134)](_0x4c89d3=>{const _0x25f505=_0x33c62b;if(!_0x4c89d3[_0x25f505(0x1eb)]())fs[_0x25f505(0x174)](configpath+_0x4c89d3['name']);});const _0x93048=fs['readFileSync'](_0x5b83ef+_0x32068a,_0x33c62b(0x1d0)),_0x3f2586=await JSZip[_0x33c62b(0x125)](_0x93048,{'base64':![],'checkCRC32':!![]});for(const _0x3ed337 of Object[_0x33c62b(0x2bd)](_0x3f2586[_0x33c62b(0x1b1)])){const _0x2565c8=_0x3f2586[_0x33c62b(0x1b1)][_0x3ed337],_0x1a5a92=await _0x2565c8[_0x33c62b(0x26b)]('string');fs[_0x33c62b(0x17f)](configpath+_0x2565c8[_0x33c62b(0xf5)],_0x1a5a92);}fs[_0x33c62b(0x1bd)](temppath,{'withFileTypes':!![]})[_0x33c62b(0x134)](_0x470394=>{const _0x39fa3e=_0x33c62b;if(!_0x470394[_0x39fa3e(0x1eb)]())fs[_0x39fa3e(0x174)](temppath+_0x470394[_0x39fa3e(0xf5)]);}),logger[_0x33c62b(0xce)](_0x33c62b(0x201)),process['send']({'restore':!![]},_0x168d37=>{});}async function getPublicIp(){const _0x1883b5=_0xab0e8e;try{const _0x3ecefa=await axios['get']('https://api.ipify.org?format=json');publicip=_0x3ecefa[_0x1883b5(0x1f3)]['ip'];}catch(_0x3c1b7b){}}async function triggerAnalytics(){const _0x138330=_0xab0e8e;if(!publicip)await getPublicIp();const _0x1ab113=getBotsWithMode();let _0x5a8b02=0x0;_0x1ab113['forEach'](_0x5f4f64=>{const _0x430ed2=_0x5e43;if(_0x5f4f64[_0x430ed2(0x293)]===_0x430ed2(0x2a2))_0x5a8b02++;});const _0x91a9b8=getBotExchanges();mixpanel[_0x138330(0xe7)](_0x138330(0x16f),{'distinct_id':settings[_0x138330(0x17d)],'ip':publicip,'version':serverversion,'numbots':_0x1ab113[_0x138330(0x147)],'numbotsenabled':_0x5a8b02,'exchanges':_0x91a9b8,'environment':environment});}async function getMessages(){const _0x41b6c4=_0xab0e8e,_0xecb62c='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x42c54e=new GraphQLClient(_0xecb62c),_0x35e016={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x2a026f=serverversion[_0x41b6c4(0x231)]('.'),_0x1c5b7a=_0x2a026f[0x0]+'.'+_0x2a026f[0x1],_0x4c521e=Math['min'](settings[_0x41b6c4(0x146)],settings['lastmsgemitted']),_0x5f0b59={'last':parseInt(_0x4c521e),'bbm':_0x1c5b7a},_0x3a0537=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x3d048c;try{_0x3d048c=await _0x42c54e[_0x41b6c4(0x14e)](_0x3a0537,_0x5f0b59,_0x35e016);}catch(_0x50a311){}if(_0x3d048c&&_0x3d048c[_0x41b6c4(0x222)]){let _0x3d8c2f=settings[_0x41b6c4(0x146)];newMessages=[];for(const _0x5b095c of _0x3d048c[_0x41b6c4(0x222)]){newMessages[_0x41b6c4(0x226)](_0x5b095c);let _0xfd9013=![];_0x5b095c['bbvNew']&&(updateSetting(_0x41b6c4(0xf1),_0x5b095c[_0x41b6c4(0xca)]),_0xfd9013=isNewerVersion(serverversion,_0x5b095c[_0x41b6c4(0xca)])||serverversion==_0x5b095c[_0x41b6c4(0xca)]);if(!_0xfd9013&&_0x5b095c[_0x41b6c4(0x101)]>_0x3d8c2f){if(_0x5b095c[_0x41b6c4(0xe5)]===_0x41b6c4(0x11f)||serverversion[_0x41b6c4(0x149)](_0x5b095c[_0x41b6c4(0xe5)])){let _0x1aadef=''+_0x5b095c[_0x41b6c4(0x19b)]+'\x0a\x0a'+_0x5b095c[_0x41b6c4(0x2ce)];const _0x2aeb5b=await sendTelegramMsg(toTelegramMarkdown(_0x1aadef),_0x41b6c4(0x238));if(_0x2aeb5b)_0x3d8c2f=_0x5b095c['number'];}}}updateAvailable=isNewerVersion(settings[_0x41b6c4(0xf1)],serverversion),updateSetting(_0x41b6c4(0x146),_0x3d8c2f),emitMessages();}}function emitMessages(){const _0x476d45=_0xab0e8e,_0x56f8b0=settings[_0x476d45(0x177)];let _0x466d87=[];newMessages['forEach'](_0x1e904c=>{const _0x45b161=_0x476d45;_0x1e904c[_0x45b161(0x101)]>_0x56f8b0&&_0x466d87['push'](_0x1e904c);}),_0x466d87[_0x476d45(0x147)]>0x0&&getAllClients()[_0x476d45(0x134)](_0x31b753=>{const _0x1f74d0=_0x476d45;getSocket(_0x31b753['id'])[_0x1f74d0(0x2c6)](_0x1f74d0(0x2ce),_0x466d87);});}function confirmMessage(_0x32f29e){const _0x2b4a4e=_0xab0e8e;updateSetting(_0x2b4a4e(0x177),Number(_0x32f29e));}function isNewerVersion(_0x4cbfed,_0x3f9905){const _0x55c776=_0xab0e8e,_0x38fcc1=_0x3f9905['split']('.'),_0x21c040=_0x4cbfed[_0x55c776(0x231)]('.');for(var _0x47bfb1=0x0;_0x47bfb1<_0x21c040[_0x55c776(0x147)];_0x47bfb1++){const _0x21a6ea=~~_0x21c040[_0x47bfb1],_0x43d5=~~_0x38fcc1[_0x47bfb1];if(_0x21a6ea>_0x43d5)return!![];if(_0x21a6ea<_0x43d5)return![];}return![];}function toTelegramMarkdown(_0x5bd9ff){const _0x35dc41=_0xab0e8e,_0x3223e8=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x16df71=/\*{2}(.+?)\*{2}/gim;return _0x5bd9ff=_0x5bd9ff[_0x35dc41(0x20f)](_0x3223e8,'$1_$2_$3')[_0x35dc41(0x20f)](_0x16df71,_0x35dc41(0x249)),_0x5bd9ff;}async function validateConfigFile(){const _0x34fd5a=_0xab0e8e,_0x4f7df4=dbConfig[_0x34fd5a(0x200)](_0x34fd5a(0x1b5))[_0x34fd5a(0x2a3)](_0x34fd5a(0xe0))[_0x34fd5a(0x27b)]()||[];if(_0x4f7df4[_0x34fd5a(0x147)]==0x0){let _0x57da2f=0x0,_0xbe8233=[];const _0x8af7c=/^bot-([0-9]{3})-config.json$/,_0x4315bd=fs['readdirSync'](configpath);_0x4315bd[_0x34fd5a(0x134)](_0x19b966=>{const _0x5d59d4=_0x34fd5a,_0x11a5ce=_0x8af7c['exec'](_0x19b966);if(_0x11a5ce){const _0x19a2b5=_0x11a5ce[0x1];let _0x3f854b=getBotAttributes(_0x19a2b5);_0xbe8233[_0x5d59d4(0x226)]({'botID':_0x19a2b5,'botname':_0x3f854b[_0x5d59d4(0x1d9)],'status':_0x5d59d4(0x1ff),'live':_0x5d59d4(0x153)}),_0x57da2f++;}}),_0x57da2f!=0x0&&(dbConfig['get'](_0x34fd5a(0x1b5))[_0x34fd5a(0x136)](_0xbe8233)[_0x34fd5a(0x299)](),config=_0xbe8233,restoredConfigFile=_0x57da2f);}}async function restoreConfigNotify(_0x5f32b1){const _0xe454f4=_0xab0e8e;let _0x154246;if(restoredConfigFile==0x1)_0x154246=_0xe454f4(0xe3);else _0x154246=_0xe454f4(0x2ba);if(_0x5f32b1)io['to'](_0xe454f4(0x11b))[_0xe454f4(0x2c6)](_0xe454f4(0x151),_0x154246);else{logger['simple'](_0xe454f4(0xf9)),logger[_0xe454f4(0x1f5)](_0x154246),logger[_0xe454f4(0x1f5)](_0xe454f4(0xf9)),logger[_0xe454f4(0x1f5)]('');if(tgBot&&settings[_0xe454f4(0x21c)]&&settings[_0xe454f4(0x23f)]!='orders')await sendTelegram(settings[_0xe454f4(0x21c)],_0xe454f4(0x107)+_0x154246);}}function decryptRSA(_0x217aec,_0x3f3e6e){const _0xc60e24=_0xab0e8e,_0xc03233=forge[_0xc60e24(0x18a)][_0xc60e24(0x199)](_0x217aec),_0xb2281e=_0xc03233[_0xc60e24(0x24a)](forge[_0xc60e24(0xfd)][_0xc60e24(0xd9)](_0x3f3e6e),'RSA-OAEP',{'md':forge['md'][_0xc60e24(0x1dc)][_0xc60e24(0xef)](),'mgf1':{'md':forge['md']['sha256'][_0xc60e24(0xef)]()}});return _0xb2281e;}function validateCredentials(_0x1053e8,_0x237d21){const _0x3529bc=_0xab0e8e;if(_0x1053e8[_0x3529bc(0x186)]==settings[_0x3529bc(0x225)]&&bcrypt[_0x3529bc(0xdc)](_0x1053e8['password'],settings[_0x3529bc(0x114)])){if(settings[_0x3529bc(0x14f)])return{'allow':![],'reason':_0x3529bc(0x197),'token':null};else{const _0x1c1335=generateLoginToken(_0x237d21);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x1c1335};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x3f0992){const _0x4868e4=_0xab0e8e,_0x948b4d=generateLoginToken(_0x3f0992);return{'allow':!![],'reason':_0x4868e4(0xf8),'token':_0x948b4d};}function validateAccess(_0x47ef62,_0x42be45,_0x2e0a55){const _0x251e77=_0xab0e8e,_0x4b88e0=_0x2e0a55?_0x2e0a55:devices[_0x42be45]['ip'];let _0x2d0240;const _0x3bcdd8=_0x4cffc1=>{const _0x17a40f=_0x5e43;if(settings['loginRequired']){if(settings[_0x17a40f(0x14f)]){if(telegram2FaApproved(_0x42be45)){const _0x21fc5b=generateLoginToken(_0x42be45);return{'allow':!![],'reason':_0x17a40f(0x16c),'token':_0x21fc5b};}else return{'allow':![],'reason':_0x17a40f(0x21d),'token':null};}else return _0x2d0240=validToken(_0x4cffc1,_0x42be45),_0x2d0240[_0x17a40f(0x1ca)](_0x17a40f(0x1d6))?{'allow':!![],'reason':_0x17a40f(0x24b),'token':_0x4cffc1}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x17a40f(0x29b),'token':null};};if(settings['whitelistEnabled']){let _0x12a539=[...settings[_0x251e77(0x13e)],_0x251e77(0x263),'::ffff:127.0.0.1',_0x251e77(0x220)];if(_0x12a539[_0x251e77(0x1db)](_0x4b88e0))return _0x3bcdd8(_0x47ef62);else{_0x2d0240=validToken(_0x47ef62,_0x42be45);if(_0x2d0240['hasOwnProperty'](_0x251e77(0x1d6)))return _0x3bcdd8(_0x47ef62);else{if(telegramIpApproved(_0x42be45)){const _0x5d3e10=generateToken(_0x42be45);return _0x2d0240=_0x3bcdd8(_0x47ef62),_0x2d0240[_0x251e77(0x195)]?{'allow':!![],'reason':_0x251e77(0x260),'token':_0x5d3e10}:_0x2d0240;}else return settings[_0x251e77(0x259)]?{'allow':![],'reason':_0x251e77(0x157),'token':null}:{'allow':![],'reason':_0x251e77(0x17a),'token':null};}}}else return _0x3bcdd8(_0x47ef62);}function timelyDecrypt(_0x5b47a4,_0x6a4a61,_0x2e818b='@'){const _0x33c7d0=_0xab0e8e;if(_0x5b47a4)try{const _0x3df4b8=decryptRSA(secure['privateKey'],_0x5b47a4),_0x4c91a4=_0x3df4b8[_0x33c7d0(0x231)](_0x2e818b)[0x0],_0x391976=_0x3df4b8['split'](_0x2e818b)[0x1],_0x38541f=new Date()[_0x33c7d0(0x23c)]();if(_0x6a4a61){if(_0x38541f-_0x391976<maxSecretAge*0x3e8)return _0x4c91a4;else return![];}else return _0x4c91a4;}catch(_0x3789d8){return![];}else return![];}const validToken=(_0x2452c6,_0x432b4b)=>{const _0x2abf64=_0xab0e8e,_0x1221c4=devices[_0x432b4b]['ip'];if(!_0x2452c6)return{'error':_0x2abf64(0xcb)};for(let _0x372f9a of blacklist){if(_0x372f9a[_0x2abf64(0x1c2)]==_0x2452c6)return{'error':_0x2abf64(0x1fd)};}let _0x17e4c1;try{_0x17e4c1=jwt[_0x2abf64(0x133)](_0x2452c6,secure[_0x2abf64(0x258)]+_0x432b4b);}catch{return{'error':_0x2abf64(0x2aa)};}if(!_0x17e4c1['hasOwnProperty']('clientip')&&!_0x17e4c1[_0x2abf64(0x1ca)](_0x2abf64(0x186))||!_0x17e4c1[_0x2abf64(0x1ca)]('exp'))return{'error':_0x2abf64(0x1cd)};if(!_0x17e4c1[_0x2abf64(0x1ca)]('username')&&_0x17e4c1['hasOwnProperty']('clientip')){const {clientip:_0x3e67ca}=_0x17e4c1;return _0x1221c4==_0x3e67ca?{'success':_0x2abf64(0x1af)}:{'error':_0x2abf64(0x130)};}else{if(_0x17e4c1[_0x2abf64(0x1ca)](_0x2abf64(0x186))&&_0x17e4c1['hasOwnProperty'](_0x2abf64(0x203))){const {username:_0xd291ba,clientip:_0x5acf14}=_0x17e4c1;return settings[_0x2abf64(0x225)]==_0xd291ba&&_0x1221c4==_0x5acf14?{'success':_0x2abf64(0x1af)}:{'error':_0x2abf64(0x216)};}}},generateLoginToken=_0x3ad75d=>{const _0x204f9a=_0xab0e8e;if(_0x3ad75d){const _0x5cb750=devices[_0x3ad75d]['ip'];return jwt[_0x204f9a(0x1f1)]({'username':settings[_0x204f9a(0x225)],'clientip':_0x5cb750},secure[_0x204f9a(0x258)]+_0x3ad75d,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x567e12=>{const _0xafe51a=_0xab0e8e;if(_0x567e12){const _0x440efb=devices[_0x567e12]['ip'];return jwt['sign']({'clientip':_0x440efb},secure['secret']+_0x567e12,{'expiresIn':devices[_0x567e12][_0xafe51a(0xe2)]['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x3af5f0=>{const _0x1d2220=_0xab0e8e;let _0x4a93ce=![];return devices[_0x3af5f0][_0x1d2220(0xe2)]&&devices[_0x3af5f0][_0x1d2220(0xe2)][_0x1d2220(0x194)]!=_0x1d2220(0x2a7)&&(_0x4a93ce=devices[_0x3af5f0]['telegramIpApproval'][_0x1d2220(0x203)]==devices[_0x3af5f0]['ip']&&new Date()[_0x1d2220(0x23c)]()-devices[_0x3af5f0][_0x1d2220(0xe2)][_0x1d2220(0x261)]<devices[_0x3af5f0]['telegramIpApproval'][_0x1d2220(0x194)]*0x3c*0x3e8),_0x4a93ce;},telegram2FaApproved=_0x4f9a8e=>{const _0xd02500=_0xab0e8e;let _0x327cd9=![];return devices[_0x4f9a8e][_0xd02500(0x24f)]&&devices[_0x4f9a8e]['telegram2FaApproval'][_0xd02500(0x194)]!=_0xd02500(0x2a7)&&(_0x327cd9=devices[_0x4f9a8e][_0xd02500(0x24f)][_0xd02500(0x203)]==devices[_0x4f9a8e]['ip']&&new Date()['getTime']()-devices[_0x4f9a8e][_0xd02500(0x24f)][_0xd02500(0x261)]<devices[_0x4f9a8e]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x327cd9;},normalizeIP=_0x42f85c=>{const _0x4a822e=_0xab0e8e;let _0x225e1f=null,_0x1735f5=null;if(ipaddr[_0x4a822e(0x273)](_0x42f85c)){const _0x4cadec=ipaddr[_0x4a822e(0x102)](_0x42f85c);_0x4cadec['kind']()==='ipv6'?(_0x4cadec['isIPv4MappedAddress']()&&(_0x225e1f=_0x4cadec[_0x4a822e(0x234)]()[_0x4a822e(0xf6)]()),_0x1735f5=_0x4cadec['toString']()):(_0x225e1f=_0x4cadec[_0x4a822e(0xf6)](),_0x1735f5=_0x4cadec[_0x4a822e(0x28d)]()[_0x4a822e(0xf6)]());}return{'show':_0x225e1f?_0x225e1f:_0x1735f5,'store':_0x1735f5};};function formatDate(_0x31df25){const _0x29a350=_0xab0e8e;return _0x31df25[_0x29a350(0x2a0)]()+'/'+(_0x31df25[_0x29a350(0x2cf)]()+0x1)[_0x29a350(0xf6)]()[_0x29a350(0x182)](0x2,'0')+'/'+_0x31df25[_0x29a350(0x2c0)]()[_0x29a350(0xf6)]()['padStart'](0x2,'0')+'\x20'+_0x31df25[_0x29a350(0x1e3)]()['toString']()[_0x29a350(0x182)](0x2,'0')+':'+_0x31df25[_0x29a350(0x143)]()[_0x29a350(0xf6)]()[_0x29a350(0x182)](0x2,'0')+':'+_0x31df25['getSeconds']()[_0x29a350(0xf6)]()[_0x29a350(0x182)](0x2,'0');}function sleep(_0x3ebc99){return new Promise(_0x5eeb18=>setTimeout(_0x5eeb18,_0x3ebc99));}