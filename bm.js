const _0x487f4c=_0x19ac;(function(_0x52cabf,_0x587519){const _0x8ec591=_0x19ac,_0x1415f6=_0x52cabf();while(!![]){try{const _0x40719e=-parseInt(_0x8ec591(0x11a))/0x1*(parseInt(_0x8ec591(0x15c))/0x2)+-parseInt(_0x8ec591(0x100))/0x3*(-parseInt(_0x8ec591(0x187))/0x4)+parseInt(_0x8ec591(0x1aa))/0x5*(-parseInt(_0x8ec591(0x1b2))/0x6)+-parseInt(_0x8ec591(0x11b))/0x7+-parseInt(_0x8ec591(0x12c))/0x8+-parseInt(_0x8ec591(0xff))/0x9+parseInt(_0x8ec591(0x17c))/0xa;if(_0x40719e===_0x587519)break;else _0x1415f6['push'](_0x1415f6['shift']());}catch(_0x1e7284){_0x1415f6['push'](_0x1415f6['shift']());}}}(_0x431f,0x3afdc));const _0x2e794d=function(){let _0x42f994=!![];return function(_0x5a6458,_0x37ad06){const _0x339700=_0x42f994?function(){const _0x38d48f=_0x19ac;if(_0x37ad06){const _0x2a9adf=_0x37ad06[_0x38d48f(0x285)](_0x5a6458,arguments);return _0x37ad06=null,_0x2a9adf;}}:function(){};return _0x42f994=![],_0x339700;};}(),_0x5387d1=_0x2e794d(this,function(){const _0x22a8c3=_0x19ac;return _0x5387d1[_0x22a8c3(0x1c9)]()[_0x22a8c3(0x132)]('(((.+)+)+)+$')[_0x22a8c3(0x1c9)]()[_0x22a8c3(0x12d)](_0x5387d1)['search']('(((.+)+)+)+$');});_0x5387d1();'use strict';process[_0x487f4c(0x1f6)]['NTBA_FIX_319']=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x487f4c(0x291)),low=require(_0x487f4c(0x181)),FileSync=require(_0x487f4c(0xe6)),path=require('path'),crypto=require('crypto'),Crypt=require('hybrid-crypto-js')[_0x487f4c(0x239)],RSA=require(_0x487f4c(0x138))[_0x487f4c(0x21a)],bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),ipaddr=require(_0x487f4c(0x1e6)),argv=require(_0x487f4c(0x186))(process[_0x487f4c(0xf7)][_0x487f4c(0x1c4)](0x2))[_0x487f4c(0xf7)],uuidRandom=require(_0x487f4c(0x10b)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require(_0x487f4c(0xbd)),axios=require(_0x487f4c(0x260)),{GraphQLClient,gql}=require(_0x487f4c(0x24b)),util=require(_0x487f4c(0xfe)),fileUpload=require(_0x487f4c(0x284)),{networkInterfaces}=require('os'),PORT=argv[_0x487f4c(0x1e4)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x487f4c(0xf5)](PORT)&&(console[_0x487f4c(0xd9)](_0x487f4c(0x153)+PORT+_0x487f4c(0x274)),process['exit'](0x1));const HOST=argv[_0x487f4c(0x289)]||null,userID=argv[_0x487f4c(0x126)]||'',debugging=argv['d']||![],nodeversion=process[_0x487f4c(0x165)][_0x487f4c(0x253)];let bbpath=_0x487f4c(0x1f0),bbpath2='';const botfile='bot.js',configfile=_0x487f4c(0x195),settingsfile=_0x487f4c(0x237),securefile=_0x487f4c(0x102),maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x487f4c(0x26c)+userID+'/':bbpath+_0x487f4c(0x26c),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x487f4c(0x15e)+userID+'/':bbpath+_0x487f4c(0x15e),zippath=userID?bbpath+_0x487f4c(0x1e7)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x487f4c(0x273)](logspath+_0x487f4c(0x113),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x487f4c(0x12e);!fs[_0x487f4c(0x255)](configpath)&&fs[_0x487f4c(0x1bb)](configpath);!fs[_0x487f4c(0x255)](configbackuppath)&&fs[_0x487f4c(0x1bb)](configbackuppath);!fs[_0x487f4c(0x255)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x487f4c(0x255)](zippath)&&fs[_0x487f4c(0x1bb)](zippath);!fs[_0x487f4c(0x255)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x487f4c(0x1d2)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x487f4c(0x1d2)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x487f4c(0x23c),'onepagemode':![]}})[_0x487f4c(0x25f)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x487f4c(0x25f)]();let crypt=new Crypt({'md':_0x487f4c(0x10d),'rsaStandard':_0x487f4c(0x1b6)});const saltRounds=0xa,mixpanel=Mixpanel[_0x487f4c(0x189)](_0x487f4c(0x137),{'host':_0x487f4c(0xf9)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x487f4c(0x119)]&&settings[_0x487f4c(0x119)]!=''&&settings[_0x487f4c(0x26a)]&&settings[_0x487f4c(0x26a)]!='')initTelegram();const parseColor=(_0xb3196,_0x24f1b5)=>{const _0x37f36b=_0x487f4c,_0x2d3469=/#[A-Z]{3}#/g;if(typeof _0xb3196==_0x37f36b(0xbf)){!_0x24f1b5?_0xb3196=_0xb3196[_0x37f36b(0x1d1)](_0x2d3469,''):(_0xb3196=_0xb3196[_0x37f36b(0x1d1)](/#BLU#/g,_0x37f36b(0x1c2)),_0xb3196=_0xb3196[_0x37f36b(0x1d1)](/#RED#/g,_0x37f36b(0x190)),_0xb3196=_0xb3196[_0x37f36b(0x1d1)](/#YEL#/g,_0x37f36b(0x151)),_0xb3196=_0xb3196['replace'](/#MAG#/g,'\x1b[35m'),_0xb3196=_0xb3196[_0x37f36b(0x1d1)](/#CYA#/g,_0x37f36b(0x111)),_0xb3196=_0xb3196[_0x37f36b(0x1d1)](/#RES#/g,_0x37f36b(0x1da)));;}return _0xb3196;},logger={'screen':_0x4897dd=>{const _0x3648c8=_0x487f4c;console[_0x3648c8(0xd9)](parseColor(_0x4897dd,!![]));},'simple':_0xa5df50=>{const _0x541b66=_0x487f4c;console[_0x541b66(0xd9)](parseColor(_0xa5df50,!![])),loggerfile['write'](util['format'](parseColor(_0xa5df50,![]))+'\x0a');},'full':async _0x1a3192=>{const _0x4aa5a4=_0x487f4c,_0x2ec900=getTimeStamp()+_0x4aa5a4(0x1ee)+_0x1a3192;console[_0x4aa5a4(0xd9)](parseColor(_0x2ec900,!![])),loggerfile[_0x4aa5a4(0x25f)](util['format'](parseColor(_0x2ec900,![]))+'\x0a');if(tgBot&&settings[_0x4aa5a4(0x1d9)]&&settings['telegramEvents']!=_0x4aa5a4(0x1c8))await tgBot[_0x4aa5a4(0x103)](settings[_0x4aa5a4(0x1d9)],_0x4aa5a4(0x172)+parseColor(_0x1a3192,![]))[_0x4aa5a4(0x1fb)](_0x88b917=>{telegramError(_0x88b917);});},'debug':async(_0x240ccc,_0x439cf0='')=>{const _0x15e754=_0x487f4c,_0x58a3c5=getTimeStamp()+_0x15e754(0x129)+_0x240ccc;if(debugging)console['log'](parseColor(_0x58a3c5,!![]));loggerfile[_0x15e754(0x25f)](util['format'](parseColor(_0x58a3c5,![]))+'\x0a');if(_0x439cf0){if(debugging)console['log'](_0x439cf0);loggerfile[_0x15e754(0x25f)](util['format'](_0x439cf0)+'\x0a');}}};process['on'](_0x487f4c(0x1ea),function(_0x5604ba){logger['simple'](_0x5604ba);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x487f4c(0x230))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x487f4c(0x19a)),app=express(),http=require(_0x487f4c(0x206))['createServer'](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x487f4c(0xe5)](_0x487f4c(0xbb),async(_0x1e67c0,_0x47f572)=>{const _0x55457a=_0x487f4c,_0x56829f=_0x1e67c0[_0x55457a(0x1ce)][_0x55457a(0x271)],_0x175f4a=getClientsWithBotID(_0x55457a(0x265)),_0x287ae1=_0x1e67c0[_0x55457a(0xbc)]['uuid'],_0x48f154=timelyDecrypt(_0x287ae1,![]),_0x4433d1=_0x175f4a[_0x55457a(0x19e)](_0x1e7f81=>_0x1e7f81['uuid']==_0x48f154);if(_0x4433d1){const _0x46ef19=normalizeIP(_0x1e67c0[_0x55457a(0x1a4)]['remoteAddress'])[_0x55457a(0xdc)],_0x9615e9=_0x1e67c0[_0x55457a(0xbc)][_0x55457a(0x182)];if(validateAccess(_0x9615e9,_0x48f154,_0x46ef19)[_0x55457a(0x1f8)])_0x56829f==_0x55457a(0x1df)&&await backupConfigFiles(),await zipFiles(_0x56829f),_0x47f572[_0x55457a(0x1dd)](zippath+(_0x56829f+_0x55457a(0x199)),_0x299de2=>{const _0x86ed5f=_0x55457a;_0x299de2&&(logger[_0x86ed5f(0x121)]('Failed\x20to\x20download\x20'+_0x56829f),logger['simple'](_0x299de2));});else logger['full'](_0x55457a(0x1d7)+_0x56829f+'\x20(1)');}else logger[_0x55457a(0x121)](_0x55457a(0x1d7)+_0x56829f+_0x55457a(0x279));}),app['post'](_0x487f4c(0x234),async(_0x1e9ca3,_0x4e1163)=>{const _0x32e79e=_0x487f4c,_0x2e01fe=getClientsWithBotID('botmanager'),_0x8729ea=_0x1e9ca3[_0x32e79e(0xbc)][_0x32e79e(0x1b0)],_0x131ba2=timelyDecrypt(_0x8729ea,![]),_0x395906=_0x2e01fe['find'](_0x59503c=>_0x59503c[_0x32e79e(0x1b0)]==_0x131ba2);logger[_0x32e79e(0x1c3)](_0x32e79e(0x1b8));if(_0x395906){const _0x12adf7=normalizeIP(_0x1e9ca3['socket'][_0x32e79e(0x136)])[_0x32e79e(0xdc)],_0x30baf6=_0x1e9ca3[_0x32e79e(0xbc)]['tkn'];if(validateAccess(_0x30baf6,_0x131ba2,_0x12adf7)[_0x32e79e(0x1f8)]){if(_0x1e9ca3[_0x32e79e(0x123)]){const _0x2a77cb=_0x1e9ca3[_0x32e79e(0x123)][_0x32e79e(0x164)];await _0x2a77cb['mv'](temppath+_0x2a77cb['name']),_0x4e1163[_0x32e79e(0x223)]({'status':!![],'message':_0x32e79e(0x233)});const _0x44b69f=getBotsWithMode();_0x44b69f[_0x32e79e(0xcd)]>0x0?confirmRestore(temppath,_0x2a77cb['name']):unzipFile(temppath,_0x2a77cb['name']);}}else logger[_0x32e79e(0x121)](_0x32e79e(0xd5));}else logger[_0x32e79e(0x121)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x487f4c(0x14a)](express['static'](path['join'](__dirname,bbpath2,_0x487f4c(0x107)))),app['use'](express[_0x487f4c(0x23b)](path[_0x487f4c(0x1ba)](__dirname,bbpath2,_0x487f4c(0xec)))),app['get']('/',function(_0x7155c6,_0x43792f){const _0x3cb4b2=_0x487f4c;_0x43792f['sendFile'](path['join'](__dirname,bbpath2,_0x3cb4b2(0x107),'index.html'));}),app['get']('/:bot',function(_0x3de5c0,_0x2b6082){const _0x1ba567=_0x487f4c;_0x2b6082[_0x1ba567(0x1ac)](path['join'](__dirname,bbpath2,_0x1ba567(0xec),_0x1ba567(0x267)));}),app['get'](_0x487f4c(0x13e),(_0x5a2e93,_0x2474ed)=>{const _0x4561b4=_0x487f4c;_0x2474ed[_0x4561b4(0x1ac)](path[_0x4561b4(0x1ba)](__dirname,bbpath2,'build',_0x4561b4(0x267)));}),app[_0x487f4c(0xe5)](_0x487f4c(0xef),(_0x461b1f,_0x275989)=>{const _0x415270=_0x487f4c;_0x275989[_0x415270(0x1ac)](path['join'](__dirname,bbpath2,_0x415270(0xec),_0x415270(0x267)));}),app[_0x487f4c(0xe5)](_0x487f4c(0x10c),(_0x3803e2,_0x5693e0)=>{const _0x1a453f=_0x487f4c;_0x5693e0[_0x1a453f(0x1ac)](path[_0x1a453f(0x1ba)](__dirname,bbpath2,_0x1a453f(0xec),_0x1a453f(0x267)));}),app[_0x487f4c(0xe5)]('/:bot/history',(_0x796582,_0x3b1459)=>{const _0x55c0bc=_0x487f4c;_0x3b1459['sendFile'](path[_0x55c0bc(0x1ba)](__dirname,bbpath2,_0x55c0bc(0xec),_0x55c0bc(0x267)));}),app[_0x487f4c(0xe5)](_0x487f4c(0x1de),(_0x50eea5,_0xed64f0)=>{const _0xbfcaff=_0x487f4c;_0xed64f0[_0xbfcaff(0x1ac)](path[_0xbfcaff(0x1ba)](__dirname,bbpath2,_0xbfcaff(0xec),_0xbfcaff(0x267)));}),app[_0x487f4c(0xe5)](_0x487f4c(0x125),(_0x221bae,_0x114794)=>{const _0xa8f37d=_0x487f4c;_0x114794[_0xa8f37d(0x1ac)](path[_0xa8f37d(0x1ba)](__dirname,bbpath2,'build',_0xa8f37d(0x267)));});if(HOST)http[_0x487f4c(0x28b)](PORT,HOST);else http[_0x487f4c(0x28b)](PORT);const io=require(_0x487f4c(0x120))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x24bbaa=_0x487f4c;let _0x457a70=_0x24bbaa(0x221);const _0x3cba2a=networkInterfaces(),_0x9fbbd1={};for(const _0x550790 of Object[_0x24bbaa(0x217)](_0x3cba2a)){for(const _0x4c0cd4 of _0x3cba2a[_0x550790]){if((_0x4c0cd4[_0x24bbaa(0x12b)]==_0x24bbaa(0x175)||_0x4c0cd4[_0x24bbaa(0x12b)]==0x4)&&!_0x4c0cd4[_0x24bbaa(0x21f)]){const _0x1f33ce=ipaddr[_0x24bbaa(0x26d)](_0x4c0cd4[_0x24bbaa(0x16d)])['range']();_0x1f33ce!=_0x24bbaa(0x28d)&&(!_0x9fbbd1[_0x550790]&&(_0x9fbbd1[_0x550790]=[]),_0x9fbbd1[_0x550790][_0x24bbaa(0x1f5)](_0x4c0cd4[_0x24bbaa(0x16d)]),_0x457a70=_0x4c0cd4[_0x24bbaa(0x16d)]);}}}return{'serverip':_0x457a70,'netinterfaces':_0x9fbbd1};}async function startServer(){const _0x115561=_0x487f4c,{serverip:_0x4e1f56,netinterfaces:_0x513854}=getServerIP();logger[_0x115561(0x245)](''),logger['simple'](_0x115561(0x27c)),await logger[_0x115561(0x121)](_0x115561(0x256)+serverversion+_0x115561(0x282)+(_0x115561(0x154)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x115561(0x226)+_0x4e1f56+':'+PORT+_0x115561(0x134))),logger[_0x115561(0x245)]('-----------------------------------------------------------------------------------');if(config[_0x115561(0xcd)]!=0x0)for(const _0x3fb47b of config){if(_0x3fb47b['status']==_0x115561(0x1e9)||_0x3fb47b[_0x115561(0x216)]==_0x115561(0x12f))await logger['full'](_0x115561(0x124)+_0x3fb47b[_0x115561(0xdd)]+_0x115561(0x27f)+_0x3fb47b[_0x115561(0x281)]),startBot([_0x3fb47b[_0x115561(0xdd)],userID],{'cwd':bbpath},function(_0x804fe1){const _0x48ad65=_0x115561;if(_0x804fe1)logger[_0x48ad65(0x121)](_0x804fe1);});else(_0x3fb47b[_0x115561(0x216)]==_0x115561(0x141)||_0x3fb47b[_0x115561(0x216)]==_0x115561(0x210))&&await logger[_0x115561(0x121)]('Idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x3fb47b[_0x115561(0xdd)]+_0x115561(0x27f)+_0x3fb47b[_0x115561(0x281)]);}else!newBot&&logger[_0x115561(0x245)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x115561(0x245)](_0x115561(0x27c)),logger[_0x115561(0x245)](''),await logger[_0x115561(0x1c3)](_0x115561(0x183)+nodeversion),await logger[_0x115561(0x1c3)]('Network\x20Interfaces:',_0x513854);}function startSocket(){io['on']('connection',_0x4220bc=>{const _0x31db9d=_0x19ac;let _0xadd8ba,_0x14bbe8,_0xefaf53,_0x4287d9,_0x3aa197;const _0xcba911=_0x4220bc[_0x31db9d(0xf2)][_0x31db9d(0xbc)][_0x31db9d(0x242)];_0x14bbe8=_0xcba911[_0x31db9d(0x205)](/bot[0-9]{3}/);if(_0x14bbe8)_0xefaf53=_0x14bbe8[0x0][_0x31db9d(0x205)](/[0-9]{3}/);if(_0xefaf53)_0xadd8ba=_0xefaf53[0x0];else _0xadd8ba=_0x31db9d(0x265);const _0x4539d3=_0x4220bc[_0x31db9d(0xf2)][_0x31db9d(0x27e)][_0x31db9d(0x264)];if(!_0x4539d3)_0x4220bc['emit'](_0x31db9d(0x216),{'publicKey':secure[_0x31db9d(0x11d)]});else{_0x4287d9=timelyDecrypt(_0x4539d3,![]);if(!_0x4287d9)_0x4220bc[_0x31db9d(0x23d)](_0x31db9d(0x216),{'publicKey':secure[_0x31db9d(0x11d)]});else{_0x3aa197=normalizeIP(_0x4220bc[_0x31db9d(0xdf)][_0x31db9d(0x136)])[_0x31db9d(0xdc)];if(!devices[_0x4287d9])devices[_0x4287d9]={'uuid':_0x4287d9,'access':{'token':null}};devices[_0x4287d9]['ip']=_0x3aa197;const _0x3bf315=addClient(_0x4220bc['id'],_0x4287d9,_0xadd8ba);setAccess(_0x3bf315),emitMessages(),_0x4220bc['on'](_0x31db9d(0x184),_0x320a06=>{const _0x52bf09=_0x31db9d,_0x1794c5=timelyDecrypt(_0x320a06[_0x52bf09(0x219)]);if(_0x1794c5){_0x320a06={'username':_0x320a06[_0x52bf09(0x14b)],'password':_0x1794c5},devices[_0x4287d9][_0x52bf09(0x16a)]=validateCredentials(_0x320a06,_0x4287d9);if(devices[_0x4287d9]['access'][_0x52bf09(0x1f8)]==![]&&devices[_0x4287d9][_0x52bf09(0x16a)]['reason']==_0x52bf09(0x1af))_0x4220bc['emit'](_0x52bf09(0x216),{'access':devices[_0x4287d9]['access']}),loginAccess2FA(_0x4287d9,_0x3aa197);else{if(devices[_0x4287d9][_0x52bf09(0x16a)][_0x52bf09(0x1f8)]==![]&&devices[_0x4287d9][_0x52bf09(0x16a)][_0x52bf09(0x201)]==_0x52bf09(0x22b))_0x4220bc[_0x52bf09(0x23d)](_0x52bf09(0x216),{'access':devices[_0x4287d9]['access']});else devices[_0x4287d9]['access'][_0x52bf09(0x1f8)]&&devices[_0x4287d9]['access'][_0x52bf09(0x201)]==_0x52bf09(0x24d)&&(getClientsWithUuid(_0x4287d9)['forEach'](_0x2e3b2f=>{setAccess(_0x2e3b2f);}),logger['debug'](_0x52bf09(0x1e3)+_0x4287d9[_0x52bf09(0x1c4)](-0x8)),setTokenRefresh(_0x4287d9),setSessionTimeout(_0x52bf09(0x184),_0x4287d9));}}else logger[_0x52bf09(0x121)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x4220bc['on'](_0x31db9d(0xf3),()=>{resetPassword();}),_0x4220bc['on'](_0x31db9d(0x109),_0x58904f=>{removeClient(_0x4220bc['id']);}),_0xadd8ba==_0x31db9d(0x265)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x1d5972){const _0x4ad657=_0x487f4c;if(_0x1d5972!=_0x4ad657(0x265)&&config[_0x4ad657(0x10e)]!=''){if(pid[_0x1d5972])pid[_0x1d5972][_0x4ad657(0x223)]({'function':_0x4ad657(0x150),'args':null});}_0x1d5972!=_0x4ad657(0x265)&&broadcastToBots(_0x4ad657(0x203),JSON[_0x4ad657(0x139)](config));}function reloadBotManager(){const _0x4e2712=_0x487f4c;getClientsWithBotID(_0x4e2712(0x265))['forEach'](_0x11b851=>{const _0x1f93ba=_0x4e2712;getSocket(_0x11b851['id'])[_0x1f93ba(0x23d)](_0x1f93ba(0x216),{'access':{'allow':![],'reason':_0x1f93ba(0x1ab),'token':null}});});}function getSocket(_0x1c6cd1){const _0x167d23=_0x487f4c;return io['sockets']['sockets'][_0x167d23(0xe5)](_0x1c6cd1);}function setAccess(_0x5a0461){const _0x497509=_0x487f4c,_0x1a05ea=getSocket(_0x5a0461['id']),_0x3a5326=_0x5a0461[_0x497509(0x1b0)],_0x5ec10d=_0x5a0461[_0x497509(0x158)];devices[_0x3a5326][_0x497509(0x16a)]=validateAccess(devices[_0x3a5326]['access'][_0x497509(0x18b)],_0x3a5326),logger[_0x497509(0x1c3)]('Setting\x20access:\x20'+devices[_0x3a5326][_0x497509(0x16a)][_0x497509(0x201)]+'\x20|\x20client:\x20...'+_0x5a0461['id']['slice'](-0x8)+_0x497509(0x225)+_0x3a5326[_0x497509(0x1c4)](-0x8)),_0x1a05ea[_0x497509(0x1ba)](_0x3a5326);if(devices[_0x3a5326]['access'][_0x497509(0x1f8)]){_0x1a05ea[_0x497509(0x1ba)](_0x5ec10d);if(_0x5ec10d=='botmanager')initializeSocketBotManager(_0x1a05ea);else initializeSocketBot(_0x1a05ea);initClient(_0x5ec10d);}devices[_0x3a5326][_0x497509(0x16a)][_0x497509(0x18b)]&&devices[_0x3a5326][_0x497509(0x16a)][_0x497509(0x201)]==_0x497509(0x17f)&&setSessionTimeout(_0x497509(0xf6),_0x3a5326),devices[_0x3a5326][_0x497509(0x16a)][_0x497509(0x18b)]&&devices[_0x3a5326][_0x497509(0x16a)][_0x497509(0x201)]==_0x497509(0x1a1)&&setSessionTimeout(_0x497509(0x184),_0x3a5326),_0x1a05ea['emit'](_0x497509(0x216),{'status':_0x5a0461[_0x497509(0x193)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x3a5326][_0x497509(0x16a)],'externalip':devices[_0x3a5326]['ip'],'publicKey':secure[_0x497509(0x11d)],'userid':settings[_0x497509(0x14e)],'validInstallation':validInstallation}),devices[_0x3a5326][_0x497509(0x16a)][_0x497509(0x1f8)]==![]&&devices[_0x3a5326][_0x497509(0x16a)][_0x497509(0x201)]==_0x497509(0x220)&&temporaryAccess2FA(_0x3a5326,devices[_0x3a5326]['ip']);}function setSessionTimeout(_0x49605b,_0x2a4e29){const _0x1807b0=_0x487f4c;let _0x2b1b5d;if(_0x49605b==_0x1807b0(0x184))_0x2b1b5d=loginExpiry*0x3c*0x3e8;else _0x2b1b5d=devices[_0x2a4e29][_0x1807b0(0x192)][_0x1807b0(0x21b)]*0x3c*0x3e8-(new Date()[_0x1807b0(0xd8)]()-devices[_0x2a4e29]['telegramIpApproval']['timestamp']);if(devices[_0x2a4e29][_0x1807b0(0x159)])clearTimeout(devices[_0x2a4e29]['pidExpireLogin']);devices[_0x2a4e29][_0x1807b0(0x159)]=setTimeout(()=>{const _0x5d6150=_0x1807b0;if(devices[_0x2a4e29][_0x5d6150(0x1cb)])clearTimeout(devices[_0x2a4e29]['pidRefreshToken']);removeSocketListeners(_0x2a4e29),addBlacklist(_0x2a4e29),devices[_0x2a4e29][_0x5d6150(0x192)]=null,devices[_0x2a4e29][_0x5d6150(0x20b)]=null,devices[_0x2a4e29][_0x5d6150(0x16a)]['token']=null,logger[_0x5d6150(0x1c3)](_0x5d6150(0x1d3)+_0x2a4e29['slice'](-0x8)),devices[_0x2a4e29][_0x5d6150(0x16a)]=validateAccess(devices[_0x2a4e29][_0x5d6150(0x16a)][_0x5d6150(0x18b)],_0x2a4e29),!(devices[_0x2a4e29][_0x5d6150(0x16a)]['allow']&&devices[_0x2a4e29]['access'][_0x5d6150(0x201)]==_0x5d6150(0xd2))&&(_0x49605b==_0x5d6150(0x184)?io['to'](_0x2a4e29)['emit'](_0x5d6150(0x216),{'access':{'allow':![],'reason':_0x5d6150(0x143),'token':null}}):io['to'](_0x2a4e29)[_0x5d6150(0x23d)]('status',{'access':{'allow':![],'reason':_0x5d6150(0x1eb),'token':null}})),devices[_0x2a4e29][_0x5d6150(0x16a)][_0x5d6150(0x18b)]=null;},_0x2b1b5d);}function setTokenRefresh(_0x59fb49){const _0xa1dcd7=_0x487f4c;if(devices[_0x59fb49][_0xa1dcd7(0x1cb)])clearTimeout(devices[_0x59fb49]['pidRefreshToken']);devices[_0x59fb49][_0xa1dcd7(0x1cb)]=setTimeout(()=>{const _0xd92768=_0xa1dcd7;getClientsWithUuid(_0x59fb49)['length']!=0x0?(devices[_0x59fb49][_0xd92768(0x16a)]=refreshToken(_0x59fb49),io['to'](_0x59fb49)['emit']('status',{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x59fb49][_0xd92768(0x16a)],'externalip':devices[_0x59fb49]['ip'],'publicKey':secure[_0xd92768(0x11d)],'validInstallation':validInstallation}),setTokenRefresh(_0x59fb49)):clearTimeout(devices[_0x59fb49]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x48ca3a){const _0x3dce73=_0x487f4c,_0x294ffe=getClient(_0x48ca3a['id'])[_0x3dce73(0x1b0)];_0x48ca3a['emit'](_0x3dce73(0x203),config),_0x48ca3a[_0x3dce73(0x23d)]('settings',cleanSettings()),_0x48ca3a['on'](_0x3dce73(0x1cd),_0x5177e5=>{const _0x1b981d=_0x3dce73;if(validateAccess(_0x5177e5,_0x294ffe)[_0x1b981d(0x1f8)])addBot();else logger[_0x1b981d(0x121)](_0x1b981d(0x287));}),_0x48ca3a['on']('update-bot',(_0x5895c7,_0x5ec7e2)=>{const _0x1a8c8f=_0x3dce73;if(validateAccess(_0x5ec7e2,_0x294ffe)[_0x1a8c8f(0x1f8)])toggleBot(_0x5895c7[_0x1a8c8f(0xdd)],_0x5895c7[_0x1a8c8f(0x216)],_0x5895c7[_0x1a8c8f(0xee)]);else logger[_0x1a8c8f(0x121)](_0x1a8c8f(0x211));}),_0x48ca3a['on'](_0x3dce73(0x140),(_0x373af9,_0x696b0d)=>{const _0x31a55e=_0x3dce73;if(validateAccess(_0x696b0d,_0x294ffe)[_0x31a55e(0x1f8)])toggleBotMode(_0x373af9);else logger[_0x31a55e(0x121)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x48ca3a['on'](_0x3dce73(0x24e),(_0x4ba92a,_0x5386bf)=>{const _0xc74134=_0x3dce73;if(validateAccess(_0x5386bf,_0x294ffe)[_0xc74134(0x1f8)])deleteBot(_0x4ba92a);else logger[_0xc74134(0x121)](_0xc74134(0x174));}),_0x48ca3a['on'](_0x3dce73(0x167),(_0x31d9a2,_0x447e2b)=>{const _0x5b2dbf=_0x3dce73;if(validateAccess(_0x447e2b,_0x294ffe)['allow'])storeSettings(_0x31d9a2,!![]);else logger[_0x5b2dbf(0x121)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x48ca3a['on'](_0x3dce73(0x1ed),_0x29be2c=>{const _0x269360=_0x3dce73;if(validateAccess(_0x29be2c,_0x294ffe)[_0x269360(0x1f8)])updateBB(_0x269360(0x27a));else logger[_0x269360(0x121)](_0x269360(0x15f));}),_0x48ca3a['on'](_0x3dce73(0x1b5),_0x2a7706=>{const _0x332856=_0x3dce73;if(validateAccess(_0x2a7706,_0x294ffe)[_0x332856(0x1f8)])updateBB(_0x332856(0x27b));else logger[_0x332856(0x121)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x48ca3a['on'](_0x3dce73(0x1fc),_0x227048=>{const _0x318009=_0x3dce73;if(validateAccess(_0x227048,_0x294ffe)['allow']){const _0x1903f8=getClient(_0x48ca3a['id']);if(_0x1903f8)getBackupFiles(_0x1903f8[_0x318009(0x1b0)]);else logger[_0x318009(0x121)](_0x318009(0x196));}else logger[_0x318009(0x121)](_0x318009(0xc9));}),_0x48ca3a['on'](_0x3dce73(0xed),(_0x5885c1,_0x6f1f2d)=>{const _0x415d7e=_0x3dce73;if(validateAccess(_0x6f1f2d,_0x294ffe)['allow'])restoreBackupFile(_0x5885c1);else logger['full'](_0x415d7e(0x17e));}),_0x48ca3a['on'](_0x3dce73(0x1bf),_0x54b8f6=>{const _0x57a28f=_0x3dce73;if(validateAccess(_0x54b8f6,_0x294ffe)['allow'])getMessages();else logger[_0x57a28f(0x121)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x48ca3a['on'](_0x3dce73(0x19c),(_0x3caab9,_0x5ec91c)=>{const _0x64927=_0x3dce73;if(validateAccess(_0x5ec91c,_0x294ffe)[_0x64927(0x1f8)])confirmMessage(_0x3caab9);else logger[_0x64927(0x121)](_0x64927(0x1b9));}),_0x48ca3a['on']('logout',_0x4a36da=>{const _0x1d5640=_0x3dce73;if(validateAccess(_0x4a36da,_0x294ffe)[_0x1d5640(0x1f8)]){if(devices[_0x294ffe][_0x1d5640(0x1cb)])clearTimeout(devices[_0x294ffe][_0x1d5640(0x1cb)]);if(devices[_0x294ffe][_0x1d5640(0x159)])clearTimeout(devices[_0x294ffe][_0x1d5640(0x159)]);removeSocketListeners(getClient(_0x48ca3a['id'])[_0x1d5640(0x1b0)]),addBlacklist(_0x294ffe),devices[_0x294ffe]['telegramIpApproval']=null,devices[_0x294ffe][_0x1d5640(0x20b)]=null,devices[_0x294ffe]['access'][_0x1d5640(0x18b)]=null,logger[_0x1d5640(0x1c3)]('Logged\x20out\x20user\x20...'+_0x294ffe['slice'](-0x8)),io['to'](getClient(_0x48ca3a['id'])[_0x1d5640(0x1b0)])[_0x1d5640(0x23d)](_0x1d5640(0x216),{'access':{'allow':![],'reason':_0x1d5640(0x275),'token':null}});}else logger[_0x1d5640(0x121)](_0x1d5640(0xd7));});}function initializeSocketBot(_0x134dcc){const _0x16f40c=_0x487f4c,_0x4eae20=getClient(_0x134dcc['id'])['bot'],_0x9821de=getClient(_0x134dcc['id'])[_0x16f40c(0x1b0)];_0x134dcc['on'](_0x16f40c(0x18f),(_0x299e13,_0x4c5cdb)=>{const _0x345293=_0x16f40c;if(validateAccess(_0x4c5cdb,_0x9821de)[_0x345293(0x1f8)]){if(pid[_0x4eae20])pid[_0x4eae20][_0x345293(0x223)]({'function':_0x345293(0x26f),'args':_0x299e13});}else logger[_0x345293(0x121)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x134dcc['on'](_0x16f40c(0x280),(_0x317eca,_0x40777a)=>{const _0x1f6978=_0x16f40c;if(validateAccess(_0x40777a,_0x9821de)['allow']){if(pid[_0x4eae20])pid[_0x4eae20][_0x1f6978(0x223)]({'function':_0x1f6978(0x20d),'args':_0x317eca});}else logger['full'](_0x1f6978(0x1d0));}),_0x134dcc['on'](_0x16f40c(0x157),(_0x14a2af,_0x2e2c83)=>{const _0x2e3f21=_0x16f40c;if(validateAccess(_0x2e2c83,_0x9821de)[_0x2e3f21(0x1f8)]){if(pid[_0x4eae20])pid[_0x4eae20][_0x2e3f21(0x223)]({'function':'getPortfolio','args':_0x14a2af});}else logger['full'](_0x2e3f21(0xe2));}),_0x134dcc['on']('store-configuration',(_0x260dc9,_0x1a6f43)=>{const _0x3b7557=_0x16f40c;if(validateAccess(_0x1a6f43,_0x9821de)['allow']){if(pid[_0x4eae20])pid[_0x4eae20][_0x3b7557(0x223)]({'function':_0x3b7557(0x13d),'args':_0x260dc9});}else logger[_0x3b7557(0x121)](_0x3b7557(0x232));}),_0x134dcc['on'](_0x16f40c(0x161),(_0x21db9d,_0x55651f)=>{const _0x273d70=_0x16f40c;if(validateAccess(_0x55651f,_0x9821de)['allow']){if(pid[_0x4eae20])pid[_0x4eae20][_0x273d70(0x223)]({'function':_0x273d70(0xf0),'args':_0x21db9d});}else logger[_0x273d70(0x121)](_0x273d70(0x13b));}),_0x134dcc['on'](_0x16f40c(0x1e5),(_0x40443c,_0xedc5cf)=>{const _0x1cad6b=_0x16f40c;if(validateAccess(_0xedc5cf,_0x9821de)[_0x1cad6b(0x1f8)]){if(pid[_0x4eae20])pid[_0x4eae20][_0x1cad6b(0x223)]({'function':_0x1cad6b(0x212),'args':_0x40443c});}else logger[_0x1cad6b(0x121)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x134dcc['on'](_0x16f40c(0xc3),_0x345252=>{const _0x329a5f=_0x16f40c;if(validateAccess(_0x345252,_0x9821de)[_0x329a5f(0x1f8)]){if(pid[_0x4eae20])pid[_0x4eae20][_0x329a5f(0x223)]({'function':'resetHistory','args':null});}else logger[_0x329a5f(0x121)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x134dcc['on'](_0x16f40c(0x1b3),_0x10bcd1=>{const _0x2b9d22=_0x16f40c;if(validateAccess(_0x10bcd1,_0x9821de)[_0x2b9d22(0x1f8)]){if(pid[_0x4eae20])pid[_0x4eae20]['send']({'function':'getStartingBalances','args':null});}else logger[_0x2b9d22(0x121)](_0x2b9d22(0x25c));}),_0x134dcc['on']('place-order',(_0x51c91e,_0x234ba2)=>{const _0x1428cc=_0x16f40c;if(validateAccess(_0x234ba2,_0x9821de)[_0x1428cc(0x1f8)]){if(pid[_0x4eae20])pid[_0x4eae20][_0x1428cc(0x223)]({'function':_0x1428cc(0x17d),'args':_0x51c91e});}else logger[_0x1428cc(0x121)](_0x1428cc(0x1fe));}),_0x134dcc['on'](_0x16f40c(0x202),_0x422aea=>{const _0x2c2283=_0x16f40c;if(validateAccess(_0x422aea,_0x9821de)[_0x2c2283(0x1f8)]){if(pid[_0x4eae20])pid[_0x4eae20][_0x2c2283(0x223)]({'function':'cancelLoading','args':null});}else logger[_0x2c2283(0x121)](_0x2c2283(0x20e));}),_0x134dcc['on'](_0x16f40c(0x148),_0x3cade6=>{const _0x729c86=_0x16f40c;if(validateAccess(_0x3cade6,_0x9821de)[_0x729c86(0x1f8)]){if(pid[_0x4eae20])pid[_0x4eae20]['send']({'function':_0x729c86(0x177),'args':null});}else logger[_0x729c86(0x121)](_0x729c86(0x19d));}),_0x134dcc['on'](_0x16f40c(0x1ed),_0x44c3b1=>{const _0x21e5df=_0x16f40c;if(validateAccess(_0x44c3b1,_0x9821de)[_0x21e5df(0x1f8)])updateBB(_0x21e5df(0x27a));else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x134dcc['on'](_0x16f40c(0x1bf),_0x322153=>{const _0x2c64bd=_0x16f40c;if(validateAccess(_0x322153,_0x9821de)[_0x2c64bd(0x1f8)])getMessages();else logger[_0x2c64bd(0x121)](_0x2c64bd(0x117));}),_0x134dcc['on'](_0x16f40c(0x19c),(_0x423c66,_0x28f804)=>{const _0x3a2fb9=_0x16f40c;if(validateAccess(_0x28f804,_0x9821de)['allow'])confirmMessage(_0x423c66);else logger[_0x3a2fb9(0x121)](_0x3a2fb9(0x1b9));}),_0x134dcc['on'](_0x16f40c(0x114),_0x3f3c12=>{const _0x238c42=_0x16f40c;if(validateAccess(_0x3f3c12,_0x9821de)['allow']){if(devices[_0x9821de][_0x238c42(0x1cb)])clearTimeout(devices[_0x9821de][_0x238c42(0x1cb)]);if(devices[_0x9821de][_0x238c42(0x159)])clearTimeout(devices[_0x9821de]['pidExpireLogin']);removeSocketListeners(getClient(_0x134dcc['id'])['uuid']),addBlacklist(_0x9821de),devices[_0x9821de][_0x238c42(0x192)]=null,devices[_0x9821de][_0x238c42(0x20b)]=null,devices[_0x9821de]['access']['token']=null,logger[_0x238c42(0x1c3)](_0x238c42(0x227)+_0x9821de['slice'](-0x8)),io['to'](getClient(_0x134dcc['id'])[_0x238c42(0x1b0)])[_0x238c42(0x23d)]('status',{'access':{'allow':![],'reason':_0x238c42(0x275),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x53016b){const _0x1f0ac7=_0x487f4c;getClientsWithUuid(_0x53016b)[_0x1f0ac7(0x209)](_0xf06af4=>{const _0x5de6cb=_0x1f0ac7;getSocket(_0xf06af4['id'])[_0x5de6cb(0x106)]();});}function cleanSettings(){const _0x36d18f=_0x487f4c;let _0x1ddb8d=settings;return settings[_0x36d18f(0x119)]&&settings[_0x36d18f(0x119)]!=''&&(_0x1ddb8d={..._0x1ddb8d,'telegramToken':'************'}),settings[_0x36d18f(0x28e)]&&settings['bbPassword']!=''&&(_0x1ddb8d={..._0x1ddb8d,'bbPassword':_0x36d18f(0x173)}),(settings[_0x36d18f(0x28e)]&&settings[_0x36d18f(0x28e)]==_0x36d18f(0x122)||settings[_0x36d18f(0x119)]&&settings[_0x36d18f(0x119)]=='***')&&(_0x1ddb8d={..._0x1ddb8d,'restored':{'password':settings[_0x36d18f(0x28e)]==_0x36d18f(0x122),'telegram':settings[_0x36d18f(0x119)]==_0x36d18f(0x122)}}),_0x1ddb8d;}async function updateBB(_0x318b23){const _0x2a019c=_0x487f4c;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x29728a=>{const _0x591cb4=_0x19ac;restartBot(_0x29728a[_0x591cb4(0xdd)]);}),logger[_0x2a019c(0x1c3)](_0x2a019c(0x19f)+_0x318b23);if(_0x318b23=='update')process['send']({'update':!![]},_0x399956=>{});else _0x318b23==_0x2a019c(0x27b)&&process[_0x2a019c(0x223)]({'reinstall':!![]},_0xba3f33=>{});}function startBot(_0x180ce1,_0x3d6f89,_0x1defd3){const _0x6952f4=_0x487f4c;if(debugging)_0x180ce1[_0x6952f4(0x1f5)]('-d');let _0x8528ae=![];const _0x555cb7=_0x180ce1[0x0];_0x3d6f89={..._0x3d6f89,'stdio':['inherit',_0x6952f4(0x198),_0x6952f4(0x198),_0x6952f4(0x24c)]},pid[_0x555cb7]=childProcess[_0x6952f4(0xc6)](botfile,_0x180ce1,_0x3d6f89),pid[_0x555cb7]['on'](_0x6952f4(0x108),_0x4be7ee=>{const _0x9d8c10=_0x6952f4;switch(Object[_0x9d8c10(0x217)](_0x4be7ee)[0x0]){case _0x9d8c10(0x281):updateBotName(_0x555cb7,_0x4be7ee[_0x9d8c10(0x281)]);break;case'updatebotmanager':updateBotManager();break;case'status':updateStatus(_0x555cb7,_0x4be7ee[_0x9d8c10(0x216)]);break;case _0x9d8c10(0xee):updateLive(_0x555cb7,_0x4be7ee[_0x9d8c10(0xee)]);break;case _0x9d8c10(0x1e2):updateLive(_0x555cb7,_0x4be7ee[_0x9d8c10(0x1e2)]),io['to'](_0x555cb7)[_0x9d8c10(0x23d)](_0x9d8c10(0x216),{'access':{'allow':![],'reason':_0x9d8c10(0x1ab),'token':null}});break;case _0x9d8c10(0x214):_0x4be7ee[_0x9d8c10(0x214)]==_0x9d8c10(0xe7)&&restartBot(_0x555cb7);_0x4be7ee[_0x9d8c10(0x214)]==_0x9d8c10(0x160)&&toggleBot(_0x555cb7,_0x9d8c10(0x141),_0x9d8c10(0x13a));break;case _0x9d8c10(0x21e):sendTelegram(_0x555cb7,_0x4be7ee[_0x9d8c10(0x21e)]);break;case _0x9d8c10(0x15b):sendTelegramMsg(_0x4be7ee[_0x9d8c10(0x15b)]);break;case _0x9d8c10(0x1a8):io['to'](_0x555cb7)[_0x9d8c10(0x23d)](_0x4be7ee['function'],_0x4be7ee[_0x9d8c10(0x152)]);break;}}),pid[_0x555cb7]['on'](_0x6952f4(0xc7),function(_0x5854b0){if(_0x8528ae)return;_0x8528ae=!![],_0x1defd3(_0x5854b0);}),pid[_0x555cb7]['on'](_0x6952f4(0xd3),async function(_0x1d4ce4){const _0x219893=_0x6952f4;if(installingUpdate)return;if(_0x8528ae)return;_0x8528ae=!![],_0x1defd3(null);const _0x5e457f=dbConfig['get'](_0x219893(0x203))[_0x219893(0x19e)]({'botID':_0x555cb7})['value']();_0x5e457f&&(_0x5e457f[_0x219893(0x216)]==_0x219893(0x1e9)||_0x5e457f['status']==_0x219893(0x12f))&&(await sleep(0x3e8),updateLive(_0x555cb7,'stopped'),logger[_0x219893(0x121)]('Restarting\x20Bot\x20'+_0x555cb7),startBot([_0x555cb7,userID],{'cwd':bbpath},function(_0x2dd444){const _0x233a00=_0x219893;if(_0x2dd444)logger[_0x233a00(0x121)](_0x2dd444);}));});}function stopBot(_0x5963c4){const _0x3a2c5a=_0x487f4c;getClientsWithBotID(_0x5963c4)[_0x3a2c5a(0x209)](_0x27cf96=>{const _0x337bf7=_0x3a2c5a;getSocket(_0x27cf96['id'])[_0x337bf7(0x109)](!![]),removeClient(_0x27cf96['id']);}),pid[_0x5963c4]&&(pid[_0x5963c4][_0x3a2c5a(0x160)](),pid[_0x5963c4]=null);}function restartBot(_0x222a5e){const _0xb942d4=_0x487f4c;if(pid[_0x222a5e])pid[_0x222a5e][_0xb942d4(0x160)]();}function addBot(){const _0x306654=_0x487f4c;let _0x4c4224;for(let _0x28dd20=0x1;_0x28dd20<0x3e9;_0x28dd20++){_0x4c4224=_0x28dd20[_0x306654(0x1c9)]()[_0x306654(0x11f)](0x3,'0');let _0x51188a=config['find'](_0x3e87c7=>_0x3e87c7[_0x306654(0xdd)]==_0x4c4224);if(!_0x51188a)break;}if(_0x4c4224==='1000'){logger[_0x306654(0x121)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x306654(0x121)](_0x306654(0x231)+_0x4c4224),dbConfig[_0x306654(0xe5)](_0x306654(0x203))[_0x306654(0x1f5)]({'botID':_0x4c4224,'botname':_0x306654(0x283)+_0x4c4224,'status':_0x306654(0x12f),'live':''})['write'](),startBot([_0x4c4224,userID],{'cwd':bbpath},function(_0x47f3ae){const _0x34ec96=_0x306654;if(_0x47f3ae)logger[_0x34ec96(0x121)](_0x47f3ae);}),config=getConfiguration(),io['to'](_0x306654(0x265))['emit'](_0x306654(0x203),config),broadcastToBots(_0x306654(0x203),JSON[_0x306654(0x139)](config));}function deleteBot(_0x46de51){const _0x24d261=_0x487f4c;getClientsWithBotID(_0x46de51)['forEach'](_0x4175d0=>{const _0x365ee4=_0x19ac;getSocket(_0x4175d0['id'])[_0x365ee4(0x109)](!![]),removeClient(_0x4175d0['id']);}),dbConfig['get'](_0x24d261(0x203))['remove']({'botID':_0x46de51})['write'](),logger['full']('Deleted\x20Bot\x20'+_0x46de51),stopBot(_0x46de51);try{if(fs[_0x24d261(0x255)](path[_0x24d261(0x1ba)](configpath,_0x24d261(0x1bd)+_0x46de51+'-config.json')))fs[_0x24d261(0x250)](path[_0x24d261(0x1ba)](configpath,_0x24d261(0x1bd)+_0x46de51+_0x24d261(0x147)));if(fs['existsSync'](path['join'](configpath,_0x24d261(0x1bd)+_0x46de51+_0x24d261(0x23a))))fs[_0x24d261(0x250)](path[_0x24d261(0x1ba)](configpath,'bot-'+_0x46de51+_0x24d261(0x23a)));if(fs[_0x24d261(0x255)](path['join'](configpath,_0x24d261(0x1bd)+_0x46de51+_0x24d261(0x235))))fs[_0x24d261(0x250)](path['join'](configpath,_0x24d261(0x1bd)+_0x46de51+'-performance.json'));if(fs[_0x24d261(0x255)](path[_0x24d261(0x1ba)](configpath,_0x24d261(0x1bd)+_0x46de51+_0x24d261(0x16e))))fs['unlinkSync'](path[_0x24d261(0x1ba)](configpath,_0x24d261(0x1bd)+_0x46de51+_0x24d261(0x16e)));}catch(_0x2fef9a){if(_0x2fef9a)logger[_0x24d261(0x121)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x2fef9a);}config=getConfiguration(),io['to']('botmanager')[_0x24d261(0x23d)](_0x24d261(0x203),config),broadcastToBots('bots',JSON[_0x24d261(0x139)](config));}function toggleBot(_0x5a16ab,_0x32ddb7,_0x4c66f8){const _0x15e046=_0x487f4c;dbConfig[_0x15e046(0xe5)](_0x15e046(0x203))[_0x15e046(0x19e)]({'botID':_0x5a16ab})[_0x15e046(0x1f4)]({'status':_0x32ddb7})['assign']({'live':_0x4c66f8})[_0x15e046(0x25f)]();if(_0x32ddb7==_0x15e046(0x1e9)||_0x32ddb7==_0x15e046(0x12f))logger[_0x15e046(0x121)](_0x15e046(0x11c)+_0x5a16ab),startBot([_0x5a16ab,userID],{'cwd':bbpath},function(_0x3383ca){if(_0x3383ca)logger['full'](_0x3383ca);});else(_0x32ddb7=='disabled'||_0x32ddb7==_0x15e046(0x210))&&(logger['full']('Disabled\x20Bot\x20'+_0x5a16ab),stopBot(_0x5a16ab));config=getConfiguration(),io['to'](_0x15e046(0x265))[_0x15e046(0x23d)](_0x15e046(0x203),config),broadcastToBots('bots',JSON[_0x15e046(0x139)](config));}function toggleStatus(_0x26262c){const _0x5c02a7=_0x487f4c;let _0x2b0463=dbConfig[_0x5c02a7(0xe5)](_0x5c02a7(0x203))[_0x5c02a7(0x19e)]({'botID':_0x26262c})[_0x5c02a7(0x14d)](),_0x7319e8;if(_0x2b0463[_0x5c02a7(0x216)]===_0x5c02a7(0x1e9))_0x7319e8=_0x5c02a7(0x141);else{if(_0x2b0463[_0x5c02a7(0x216)]===_0x5c02a7(0x12f))_0x7319e8='new-disabled';else{if(_0x2b0463[_0x5c02a7(0x216)]===_0x5c02a7(0x210))_0x7319e8=_0x5c02a7(0x12f);else{if(_0x2b0463['status']==='disabled')_0x7319e8=_0x5c02a7(0x1e9);}}}return _0x7319e8;}function updateStatus(_0x2f5dd5,_0x3be759){const _0x52901e=_0x487f4c;dbConfig[_0x52901e(0xe5)](_0x52901e(0x203))['find']({'botID':_0x2f5dd5})[_0x52901e(0x1f4)]({'status':_0x3be759})[_0x52901e(0x25f)](),config=getConfiguration(),io['to']('botmanager')[_0x52901e(0x23d)](_0x52901e(0x203),config),broadcastToBots(_0x52901e(0x203),JSON[_0x52901e(0x139)](config));}function updateLive(_0x72b920,_0x16a4e8){const _0x5ec25a=_0x487f4c;dbConfig['get'](_0x5ec25a(0x203))[_0x5ec25a(0x19e)]({'botID':_0x72b920})['assign']({'live':_0x16a4e8})[_0x5ec25a(0x25f)](),config=getConfiguration(),io['to'](_0x5ec25a(0x265))[_0x5ec25a(0x23d)]('bots',config),broadcastToBots(_0x5ec25a(0x203),JSON[_0x5ec25a(0x139)](config));}function updateBotName(_0x201df7,_0x57b035){const _0x2179d5=_0x487f4c;dbConfig[_0x2179d5(0xe5)](_0x2179d5(0x203))[_0x2179d5(0x19e)]({'botID':_0x201df7})[_0x2179d5(0x1f4)]({'botname':_0x57b035})['write'](),config=getConfiguration(),io['to'](_0x2179d5(0x265))[_0x2179d5(0x23d)]('bots',config),broadcastToBots(_0x2179d5(0x203),JSON[_0x2179d5(0x139)](config));}function updateBotManager(){const _0x2b65d3=_0x487f4c;config=getConfiguration(),io['to'](_0x2b65d3(0x265))[_0x2b65d3(0x23d)](_0x2b65d3(0x203),config),broadcastToBots(_0x2b65d3(0x203),JSON[_0x2b65d3(0x139)](config));}function toggleBotMode(_0x3cbb3b){const _0x2e8434=_0x487f4c;if(pid[_0x3cbb3b])pid[_0x3cbb3b][_0x2e8434(0x223)]({'function':_0x2e8434(0xe8),'args':null});else{const _0x4d7ec6=configpath+_0x2e8434(0x1bd)+_0x3cbb3b+_0x2e8434(0x147),_0x3971c7=fs[_0x2e8434(0x1c7)](_0x4d7ec6),_0x46cb76=JSON[_0x2e8434(0x26d)](_0x3971c7),_0x65ee09=_0x46cb76[_0x2e8434(0x158)][0x0][_0x2e8434(0x1c0)];_0x46cb76[_0x2e8434(0x158)][0x0][_0x2e8434(0x1c0)]=!_0x65ee09;const _0x41efe7=JSON[_0x2e8434(0x139)](_0x46cb76,null,0x2);fs['writeFileSync'](_0x4d7ec6,_0x41efe7),config=getConfiguration(),io['to']('botmanager')[_0x2e8434(0x23d)](_0x2e8434(0x203),config),broadcastToBots('bots',JSON[_0x2e8434(0x139)](config));}}function telegramError(_0x391d41){const _0x4ff797=_0x487f4c;logger[_0x4ff797(0x245)](getTimeStamp()+_0x4ff797(0x22f));}function validateTelegram(_0x585daa){const _0x5dbd1a=_0x487f4c;if(_0x585daa[_0x5dbd1a(0x11e)][_0x5dbd1a(0x14b)]!=settings[_0x5dbd1a(0x26a)]&&'@'+_0x585daa[_0x5dbd1a(0x11e)][_0x5dbd1a(0x14b)]!=settings[_0x5dbd1a(0x26a)])return tgBot[_0x5dbd1a(0x103)](_0x585daa['chat']['id'],_0x5dbd1a(0x1ae),{'parse_mode':_0x5dbd1a(0xd0)})[_0x5dbd1a(0x1fb)](_0x320e1a=>{telegramError(_0x320e1a);}),![];return!![];}async function initTelegram(){const _0x1ecf68=_0x487f4c;if(tgBot)tgBot[_0x1ecf68(0x14f)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x1ecf68(0x119)],{'polling':!![]});let _0x1a26f4=_0x1ecf68(0x13c);_0x1a26f4+='\x0a',_0x1a26f4+='/enable\x20-\x20enable\x20notifications\x0a',_0x1a26f4+='/disable\x20-\x20disable\x20notifications\x0a',_0x1a26f4+=_0x1ecf68(0x1be),_0x1a26f4+=_0x1ecf68(0x1e0),_0x1a26f4+=_0x1ecf68(0x1a7),_0x1a26f4+=_0x1ecf68(0x191),_0x1a26f4+=_0x1ecf68(0x1c6),_0x1a26f4+=_0x1ecf68(0x259),_0x1a26f4+=_0x1ecf68(0xf8),_0x1a26f4+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x1a26f4+=_0x1ecf68(0x176),_0x1a26f4+=_0x1ecf68(0x127),_0x1a26f4+=_0x1ecf68(0x169),_0x1a26f4+=_0x1ecf68(0x268);let _0x4516b2=_0x1ecf68(0xf4);_0x4516b2+='\x0a',_0x4516b2+=_0x1a26f4,tgBot['onText'](/\/start/,_0x30f770=>{const _0x38df0d=_0x1ecf68;if(!validateTelegram(_0x30f770))return;if(settings[_0x38df0d(0x1d9)]!=_0x30f770[_0x38df0d(0x292)]['id'])updateSetting(_0x38df0d(0x1d9),_0x30f770['chat']['id']);updateSetting(_0x38df0d(0xc8),!![]),tgBot['sendMessage'](_0x30f770[_0x38df0d(0x292)]['id'],_0x4516b2)[_0x38df0d(0x1fb)](_0x220740=>{telegramError(_0x220740);});}),tgBot[_0x1ecf68(0x246)](/\/enable/,_0x2a7e46=>{const _0x26db71=_0x1ecf68;if(!validateTelegram(_0x2a7e46))return;if(settings['telegramChatId']!=_0x2a7e46['chat']['id'])updateSetting(_0x26db71(0x1d9),_0x2a7e46['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x26db71(0x103)](_0x2a7e46[_0x26db71(0x292)]['id'],_0x26db71(0x18e))[_0x26db71(0x1fb)](_0x3dfb5f=>{telegramError(_0x3dfb5f);});}),tgBot[_0x1ecf68(0x246)](/\/config/,async _0x39fad4=>{const _0x1d448d=_0x1ecf68;if(!validateTelegram(_0x39fad4))return;tgBot['removeListener'](_0x1d448d(0x1cc)),tgBot[_0x1d448d(0x103)](_0x39fad4[_0x1d448d(0x292)]['id'],_0x1d448d(0x25e),{'reply_markup':{'inline_keyboard':[[{'text':_0x1d448d(0x1a9),'callback_data':_0x1d448d(0x1c8)},{'text':'Alerts','callback_data':_0x1d448d(0x142)},{'text':'All','callback_data':_0x1d448d(0x16c)}]]}})[_0x1d448d(0x1fb)](_0x4d0f9a=>{telegramError(_0x4d0f9a);}),tgBot['on'](_0x1d448d(0x1cc),async _0x4fc22f=>{const _0x20ab3b=_0x1d448d,_0x24e6b2=_0x4fc22f['data'],_0x487a6e=_0x4fc22f[_0x20ab3b(0x108)];tgBot[_0x20ab3b(0x25a)](_0x4fc22f['id'])[_0x20ab3b(0x197)](async()=>{const _0x48dc64=_0x20ab3b;_0x24e6b2==_0x48dc64(0x1c8)&&(updateSetting('telegramEvents',_0x48dc64(0x1c8)),updateSetting(_0x48dc64(0xc8),!![]),await tgBot['sendMessage'](_0x487a6e[_0x48dc64(0x292)]['id'],_0x48dc64(0x252))[_0x48dc64(0x1fb)](_0x19112b=>{telegramError(_0x19112b);}));_0x24e6b2==_0x48dc64(0x142)&&(updateSetting(_0x48dc64(0x1a6),_0x48dc64(0x142)),updateSetting(_0x48dc64(0xc8),!![]),await tgBot[_0x48dc64(0x103)](_0x487a6e[_0x48dc64(0x292)]['id'],_0x48dc64(0x1ec))[_0x48dc64(0x1fb)](_0x2c1520=>{telegramError(_0x2c1520);}));_0x24e6b2==_0x48dc64(0x16c)&&(updateSetting(_0x48dc64(0x1a6),_0x48dc64(0x16c)),updateSetting(_0x48dc64(0xc8),!![]),await tgBot[_0x48dc64(0x103)](_0x487a6e[_0x48dc64(0x292)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')['catch'](_0x475e15=>{telegramError(_0x475e15);}));if(!settings[_0x48dc64(0x1d9)])tgBot[_0x48dc64(0x103)](_0x487a6e['chat']['id'],_0x48dc64(0xdb))[_0x48dc64(0x1fb)](_0x12409e=>{telegramError(_0x12409e);});}),tgBot['removeListener'](_0x20ab3b(0x1cc));});}),tgBot[_0x1ecf68(0x246)](/\/status/,_0x3661c9=>{const _0x42bc86=_0x1ecf68;if(!validateTelegram(_0x3661c9))return;const _0x4484b9=getBotsWithMode();let _0x3f893f=_0x42bc86(0x28c);config[_0x42bc86(0x209)](_0x68fb66=>{const _0x59b132=_0x42bc86,_0xc5d1a0=_0x4484b9[_0x59b132(0x19e)](_0x3793b9=>_0x3793b9[_0x59b132(0xdd)]==_0x68fb66[_0x59b132(0xdd)])[_0x59b132(0x194)];_0x3f893f+=_0x59b132(0x283)+_0x68fb66[_0x59b132(0xdd)]+':\x20'+_0x68fb66[_0x59b132(0x216)]+_0x59b132(0x27f)+_0xc5d1a0+_0x59b132(0x27f)+_0x68fb66[_0x59b132(0xee)]+'\x0a';}),_0x3f893f+='\x0a',_0x3f893f+=_0x42bc86(0x224),_0x3f893f+=!settings['telegramEnabled']?_0x42bc86(0x16f):_0x42bc86(0x228),_0x3f893f+=settings['telegramEnabled']?settings['telegramEvents']==_0x42bc86(0x16c)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x42bc86(0xeb)+settings[_0x42bc86(0x1a6)]+_0x42bc86(0x21d):'',tgBot[_0x42bc86(0x103)](_0x3661c9[_0x42bc86(0x292)]['id'],_0x3f893f,{'parse_mode':_0x42bc86(0xd0)})[_0x42bc86(0x1fb)](_0x5dee2f=>{telegramError(_0x5dee2f);});}),tgBot[_0x1ecf68(0x246)](/\/restart/,_0x257cb3=>{const _0x29712a=_0x1ecf68;if(!validateTelegram(_0x257cb3))return;tgBot['removeListener']('callback_query');const _0x3074b7=getEnabledBots();if(_0x3074b7[_0x29712a(0xcd)]==0x0)tgBot['sendMessage'](_0x257cb3['chat']['id'],_0x29712a(0x146))[_0x29712a(0x1fb)](_0x5a82ff=>{telegramError(_0x5a82ff);});else{if(_0x3074b7[_0x29712a(0xcd)]>0x1)_0x3074b7[_0x29712a(0x1f5)]({'botID':'all'});let _0x31dd24=[],_0x4ef848=[];const _0x3c561b=_0x3074b7[_0x29712a(0xcd)]%0x4==0x0||_0x3074b7[_0x29712a(0xcd)]%0x4==0x3||_0x3074b7['length']%0x3==0x1?0x4:0x3;let _0x314c9d=0x0;_0x3074b7[_0x29712a(0x209)]((_0x1d998a,_0x2bc37c)=>{const _0x3e8ae5=_0x29712a;if(_0x2bc37c%_0x3c561b==0x0)_0x4ef848=[];_0x4ef848[_0x3e8ae5(0x1f5)]({'text':_0x1d998a[_0x3e8ae5(0xdd)]==_0x3e8ae5(0x16c)?'All\x20bots':_0x3e8ae5(0x283)+_0x1d998a[_0x3e8ae5(0xdd)],'callback_data':_0x1d998a[_0x3e8ae5(0xdd)]}),_0x2bc37c%_0x3c561b==0x0&&(_0x31dd24[_0x314c9d]=_0x4ef848,_0x314c9d++);}),tgBot[_0x29712a(0x103)](_0x257cb3['chat']['id'],_0x29712a(0xfc),{'reply_markup':{'inline_keyboard':_0x31dd24}})['catch'](_0x571b08=>{telegramError(_0x571b08);}),tgBot['on'](_0x29712a(0x1cc),async _0x4c7da5=>{const _0x55c54a=_0x29712a,_0x4af417=_0x4c7da5[_0x55c54a(0xd4)],_0xb0a43f=_0x4c7da5[_0x55c54a(0x108)];tgBot[_0x55c54a(0x25a)](_0x4c7da5['id'])[_0x55c54a(0x197)](async()=>{const _0xa554ac=_0x55c54a;_0x4af417==_0xa554ac(0x16c)?config[_0xa554ac(0x209)](_0x5972c7=>{const _0x594d63=_0xa554ac;restartBot(_0x5972c7[_0x594d63(0xdd)]);}):restartBot(_0x4af417);}),tgBot[_0x55c54a(0x277)](_0x55c54a(0x1cc));});}}),tgBot['onText'](/\/on/,_0x2c8246=>{const _0x4d4549=_0x1ecf68;if(!validateTelegram(_0x2c8246))return;tgBot[_0x4d4549(0x277)](_0x4d4549(0x1cc));const _0x947b54=getDisabledBots();if(_0x947b54[_0x4d4549(0xcd)]==0x0)tgBot[_0x4d4549(0x103)](_0x2c8246[_0x4d4549(0x292)]['id'],_0x4d4549(0xc0))[_0x4d4549(0x1fb)](_0x20ec5f=>{telegramError(_0x20ec5f);});else{if(_0x947b54['length']>0x1)_0x947b54[_0x4d4549(0x1f5)]({'botID':'all'});let _0xfe0fc1=[],_0x4a30b5=[];const _0x229c86=_0x947b54['length']%0x4==0x0||_0x947b54[_0x4d4549(0xcd)]%0x4==0x3||_0x947b54[_0x4d4549(0xcd)]%0x3==0x1?0x4:0x3;let _0x37cc24=0x0;_0x947b54[_0x4d4549(0x209)]((_0x325202,_0xdb7928)=>{const _0x4ac43e=_0x4d4549;if(_0xdb7928%_0x229c86==0x0)_0x4a30b5=[];_0x4a30b5[_0x4ac43e(0x1f5)]({'text':_0x325202[_0x4ac43e(0xdd)]=='all'?_0x4ac43e(0x222):_0x4ac43e(0x283)+_0x325202[_0x4ac43e(0xdd)],'callback_data':_0x325202['botID']}),_0xdb7928%_0x229c86==0x0&&(_0xfe0fc1[_0x37cc24]=_0x4a30b5,_0x37cc24++);}),tgBot[_0x4d4549(0x103)](_0x2c8246[_0x4d4549(0x292)]['id'],_0x4d4549(0xd6),{'reply_markup':{'inline_keyboard':_0xfe0fc1}})['catch'](_0xef2058=>{telegramError(_0xef2058);}),tgBot['on'](_0x4d4549(0x1cc),async _0x4198ad=>{const _0x12a263=_0x4d4549,_0x48f35f=_0x4198ad[_0x12a263(0xd4)],_0x727cb5=_0x4198ad['message'];tgBot['answerCallbackQuery'](_0x4198ad['id'])[_0x12a263(0x197)](async()=>{const _0x332118=_0x12a263;_0x48f35f=='all'?(tgBot[_0x332118(0x103)](_0x727cb5[_0x332118(0x292)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x332118(0x1fb)](_0x371ac3=>{telegramError(_0x371ac3);}),_0x947b54[_0x332118(0x209)](_0x17f3a4=>{const _0x235159=_0x332118;if(_0x17f3a4['botID']!=_0x235159(0x16c))toggleBot(_0x17f3a4[_0x235159(0xdd)],toggleStatus(_0x17f3a4[_0x235159(0xdd)]),_0x235159(0x13a));})):(tgBot[_0x332118(0x103)](_0x727cb5['chat']['id'],_0x332118(0x1b1)+_0x48f35f)[_0x332118(0x1fb)](_0x7181d0=>{telegramError(_0x7181d0);}),toggleBot(_0x48f35f,toggleStatus(_0x48f35f),_0x332118(0x13a)));}),tgBot[_0x12a263(0x277)](_0x12a263(0x1cc));});}}),tgBot[_0x1ecf68(0x246)](/\/off/,_0x4671b6=>{const _0x2dbf53=_0x1ecf68;if(!validateTelegram(_0x4671b6))return;tgBot['removeListener']('callback_query');const _0x12f929=getEnabledBots();if(_0x12f929[_0x2dbf53(0xcd)]==0x0)tgBot[_0x2dbf53(0x103)](_0x4671b6[_0x2dbf53(0x292)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x25b02a=>{telegramError(_0x25b02a);});else{if(_0x12f929[_0x2dbf53(0xcd)]>0x1)_0x12f929['push']({'botID':'all'});let _0x57c325=[],_0xd219bc=[];const _0x1e5a51=_0x12f929[_0x2dbf53(0xcd)]%0x4==0x0||_0x12f929[_0x2dbf53(0xcd)]%0x4==0x3||_0x12f929[_0x2dbf53(0xcd)]%0x3==0x1?0x4:0x3;let _0x2d8065=0x0;_0x12f929[_0x2dbf53(0x209)]((_0x4de0b4,_0x37e9d2)=>{const _0x2b3a76=_0x2dbf53;if(_0x37e9d2%_0x1e5a51==0x0)_0xd219bc=[];_0xd219bc[_0x2b3a76(0x1f5)]({'text':_0x4de0b4[_0x2b3a76(0xdd)]==_0x2b3a76(0x16c)?_0x2b3a76(0x222):_0x2b3a76(0x283)+_0x4de0b4['botID'],'callback_data':_0x4de0b4[_0x2b3a76(0xdd)]}),_0x37e9d2%_0x1e5a51==0x0&&(_0x57c325[_0x2d8065]=_0xd219bc,_0x2d8065++);}),tgBot[_0x2dbf53(0x103)](_0x4671b6[_0x2dbf53(0x292)]['id'],_0x2dbf53(0x180),{'reply_markup':{'inline_keyboard':_0x57c325}})['catch'](_0x55c38f=>{telegramError(_0x55c38f);}),tgBot['on']('callback_query',async _0x3ce5d3=>{const _0x36553b=_0x2dbf53,_0x2020ab=_0x3ce5d3['data'],_0x3f979b=_0x3ce5d3[_0x36553b(0x108)];tgBot['answerCallbackQuery'](_0x3ce5d3['id'])[_0x36553b(0x197)](async()=>{const _0x50d94b=_0x36553b;_0x2020ab==_0x50d94b(0x16c)?(tgBot[_0x50d94b(0x103)](_0x3f979b['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x50d94b(0x1fb)](_0x5af649=>{telegramError(_0x5af649);}),_0x12f929[_0x50d94b(0x209)](_0x197a5b=>{const _0x1af145=_0x50d94b;if(_0x197a5b[_0x1af145(0xdd)]!=_0x1af145(0x16c))toggleBot(_0x197a5b['botID'],toggleStatus(_0x197a5b[_0x1af145(0xdd)]),_0x1af145(0x13a));})):(tgBot['sendMessage'](_0x3f979b['chat']['id'],_0x50d94b(0x1fa)+_0x2020ab)[_0x50d94b(0x1fb)](_0x4522d8=>{telegramError(_0x4522d8);}),toggleBot(_0x2020ab,toggleStatus(_0x2020ab),'stopped'));}),tgBot[_0x36553b(0x277)](_0x36553b(0x1cc));});}}),tgBot['onText'](/\/metrics/,_0x584583=>{const _0x37dcfe=_0x1ecf68;if(!validateTelegram(_0x584583))return;tgBot[_0x37dcfe(0x277)]('callback_query');const _0xceeae1=getEnabledBots();if(_0xceeae1[_0x37dcfe(0xcd)]==0x0)tgBot[_0x37dcfe(0x103)](_0x584583[_0x37dcfe(0x292)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x545735=>{telegramError(_0x545735);});else{if(_0xceeae1[_0x37dcfe(0xcd)]>0x1){let _0x3986e2=[],_0x37617c=[];const _0x12b0d5=_0xceeae1[_0x37dcfe(0xcd)]%0x4==0x0||_0xceeae1[_0x37dcfe(0xcd)]%0x4==0x3||_0xceeae1[_0x37dcfe(0xcd)]%0x3==0x1?0x4:0x3;let _0x400875=0x0;_0xceeae1['forEach']((_0x35db39,_0x4770ea)=>{const _0x220925=_0x37dcfe;if(_0x4770ea%_0x12b0d5==0x0)_0x37617c=[];_0x37617c[_0x220925(0x1f5)]({'text':_0x220925(0x283)+_0x35db39[_0x220925(0xdd)],'callback_data':_0x35db39['botID']}),_0x4770ea%_0x12b0d5==0x0&&(_0x3986e2[_0x400875]=_0x37617c,_0x400875++);}),tgBot[_0x37dcfe(0x103)](_0x584583[_0x37dcfe(0x292)]['id'],_0x37dcfe(0x207),{'reply_markup':{'inline_keyboard':_0x3986e2}})[_0x37dcfe(0x1fb)](_0x4b03c6=>{telegramError(_0x4b03c6);}),tgBot['on'](_0x37dcfe(0x1cc),async _0x559895=>{const _0x36f95a=_0x37dcfe,_0x4e5766=_0x559895[_0x36f95a(0xd4)],_0x5d3cce=_0x559895['message'];tgBot[_0x36f95a(0x25a)](_0x559895['id'])['then'](async()=>{const _0x427809=_0x36f95a;if(pid[_0x4e5766])pid[_0x4e5766][_0x427809(0x223)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x36f95a(0x277)](_0x36f95a(0x1cc));});}else{const _0x258289=_0xceeae1[0x0][_0x37dcfe(0xdd)];if(pid[_0x258289])pid[_0x258289][_0x37dcfe(0x223)]({'function':_0x37dcfe(0x188),'args':null});}}}),tgBot['onText'](/\/portfolio/,_0x1de6e2=>{const _0x938f21=_0x1ecf68;if(!validateTelegram(_0x1de6e2))return;tgBot[_0x938f21(0x277)](_0x938f21(0x1cc));const _0x1de978=getEnabledBots();if(_0x1de978['length']==0x0)tgBot[_0x938f21(0x103)](_0x1de6e2[_0x938f21(0x292)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x938f21(0x1fb)](_0x198cb4=>{telegramError(_0x198cb4);});else{if(_0x1de978[_0x938f21(0xcd)]>0x1){let _0x3065a5=[],_0x4e07bc=[];const _0x2f3400=_0x1de978[_0x938f21(0xcd)]%0x4==0x0||_0x1de978['length']%0x4==0x3||_0x1de978[_0x938f21(0xcd)]%0x3==0x1?0x4:0x3;let _0x56552d=0x0;_0x1de978['forEach']((_0x561c2c,_0x4d951d)=>{const _0x3abff1=_0x938f21;if(_0x4d951d%_0x2f3400==0x0)_0x4e07bc=[];_0x4e07bc[_0x3abff1(0x1f5)]({'text':_0x3abff1(0x283)+_0x561c2c[_0x3abff1(0xdd)],'callback_data':_0x561c2c[_0x3abff1(0xdd)]}),_0x4d951d%_0x2f3400==0x0&&(_0x3065a5[_0x56552d]=_0x4e07bc,_0x56552d++);}),tgBot[_0x938f21(0x103)](_0x1de6e2[_0x938f21(0x292)]['id'],_0x938f21(0x28a),{'reply_markup':{'inline_keyboard':_0x3065a5}})['catch'](_0x2a56aa=>{telegramError(_0x2a56aa);}),tgBot['on']('callback_query',async _0xd9fd87=>{const _0xdec942=_0x938f21,_0x52d6d1=_0xd9fd87[_0xdec942(0xd4)],_0x267c08=_0xd9fd87['message'];tgBot['answerCallbackQuery'](_0xd9fd87['id'])[_0xdec942(0x197)](async()=>{const _0x5f159d=_0xdec942;if(pid[_0x52d6d1])pid[_0x52d6d1]['send']({'function':_0x5f159d(0xc5),'args':null});}),tgBot[_0xdec942(0x277)](_0xdec942(0x1cc));});}else{const _0x5db064=_0x1de978[0x0][_0x938f21(0xdd)];if(pid[_0x5db064])pid[_0x5db064][_0x938f21(0x223)]({'function':_0x938f21(0xc5),'args':null});}}}),tgBot['onText'](/\/update/,async _0x5cb66c=>{const _0x25cd7f=_0x1ecf68;if(!validateTelegram(_0x5cb66c))return;tgBot[_0x25cd7f(0x277)]('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x25cd7f(0x103)](_0x5cb66c[_0x25cd7f(0x292)]['id'],_0x25cd7f(0x248))[_0x25cd7f(0x1fb)](_0x8761e=>{telegramError(_0x8761e);});else!validInstallation?tgBot[_0x25cd7f(0x103)](_0x5cb66c['chat']['id'],_0x25cd7f(0x293))['catch'](_0x272afe=>{telegramError(_0x272afe);}):(tgBot[_0x25cd7f(0x103)](_0x5cb66c[_0x25cd7f(0x292)]['id'],_0x25cd7f(0x261),{'reply_markup':{'inline_keyboard':[[{'text':_0x25cd7f(0x1ff),'callback_data':_0x25cd7f(0xe0)},{'text':'No','callback_data':'no'}]]}})[_0x25cd7f(0x1fb)](_0x384d5e=>{telegramError(_0x384d5e);}),tgBot['on'](_0x25cd7f(0x1cc),async _0x40f934=>{const _0xe9cf1c=_0x25cd7f,_0x41f10c=_0x40f934[_0xe9cf1c(0xd4)],_0x436eb3=_0x40f934['message'];tgBot[_0xe9cf1c(0x25a)](_0x40f934['id'])[_0xe9cf1c(0x197)](async()=>{const _0x5d87cb=_0xe9cf1c;_0x41f10c==_0x5d87cb(0xe0)&&(await tgBot[_0x5d87cb(0x103)](_0x436eb3['chat']['id'],_0x5d87cb(0x254))[_0x5d87cb(0x1fb)](_0x1d8d6f=>{telegramError(_0x1d8d6f);}),updateBB(_0x5d87cb(0x27a))),_0x41f10c=='no'&&await tgBot[_0x5d87cb(0x103)](_0x436eb3[_0x5d87cb(0x292)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')[_0x5d87cb(0x1fb)](_0x35ff00=>{telegramError(_0x35ff00);});}),tgBot[_0xe9cf1c(0x277)](_0xe9cf1c(0x1cc));}));}),tgBot[_0x1ecf68(0x246)](/\/reinstall/,async _0x49071c=>{const _0x47457e=_0x1ecf68;if(!validateTelegram(_0x49071c))return;tgBot[_0x47457e(0x277)]('callback_query'),!validInstallation?tgBot[_0x47457e(0x103)](_0x49071c[_0x47457e(0x292)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')['catch'](_0x2cc410=>{telegramError(_0x2cc410);}):(tgBot[_0x47457e(0x103)](_0x49071c[_0x47457e(0x292)]['id'],_0x47457e(0x27d),{'reply_markup':{'inline_keyboard':[[{'text':_0x47457e(0x1ff),'callback_data':_0x47457e(0xe0)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x4d6dfb=>{telegramError(_0x4d6dfb);}),tgBot['on'](_0x47457e(0x1cc),async _0x1dd6c2=>{const _0x4b7241=_0x47457e,_0x1f2bb7=_0x1dd6c2[_0x4b7241(0xd4)],_0x1f07d9=_0x1dd6c2[_0x4b7241(0x108)];tgBot['answerCallbackQuery'](_0x1dd6c2['id'])[_0x4b7241(0x197)](async()=>{const _0x1a3d37=_0x4b7241;_0x1f2bb7==_0x1a3d37(0xe0)&&(await tgBot[_0x1a3d37(0x103)](_0x1f07d9['chat']['id'],_0x1a3d37(0x236))[_0x1a3d37(0x1fb)](_0x2b92e7=>{telegramError(_0x2b92e7);}),updateBB(_0x1a3d37(0x27b))),_0x1f2bb7=='no'&&await tgBot[_0x1a3d37(0x103)](_0x1f07d9[_0x1a3d37(0x292)]['id'],_0x1a3d37(0x1ad))[_0x1a3d37(0x1fb)](_0x46a0cf=>{telegramError(_0x46a0cf);});}),tgBot[_0x4b7241(0x277)]('callback_query');}));}),tgBot['onText'](/\/toggle/,_0x2f5b61=>{const _0x39b971=_0x1ecf68;if(!validateTelegram(_0x2f5b61))return;tgBot[_0x39b971(0x277)](_0x39b971(0x1cc));const _0x519e19=getBotsWithMode();if(_0x519e19[_0x39b971(0xcd)]==0x0)tgBot[_0x39b971(0x103)](_0x2f5b61[_0x39b971(0x292)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x39b971(0x1fb)](_0x437cc5=>{telegramError(_0x437cc5);});else{let _0x243670=[],_0x3c3400=[];const _0x420485=0x2;let _0x422c6f=0x0;_0x519e19[_0x39b971(0x209)]((_0x278fe9,_0x4552d0)=>{const _0x176249=_0x39b971;if(_0x4552d0%_0x420485==0x0)_0x3c3400=[];_0x3c3400[_0x176249(0x1f5)]({'text':_0x176249(0x283)+_0x278fe9['botID']+'\x20('+_0x278fe9[_0x176249(0x194)]+')','callback_data':_0x278fe9[_0x176249(0xdd)]}),_0x4552d0%_0x420485==0x0&&(_0x243670[_0x422c6f]=_0x3c3400,_0x422c6f++);}),tgBot[_0x39b971(0x103)](_0x2f5b61['chat']['id'],_0x39b971(0x263),{'reply_markup':{'inline_keyboard':_0x243670}})['catch'](_0x5758df=>{telegramError(_0x5758df);}),tgBot['on'](_0x39b971(0x1cc),async _0x51eb6b=>{const _0x50dc77=_0x39b971,_0x1eaaae=_0x51eb6b['data'],_0x2548cd=_0x51eb6b[_0x50dc77(0x108)];tgBot['answerCallbackQuery'](_0x51eb6b['id'])[_0x50dc77(0x197)](async()=>{const _0x381781=_0x50dc77,_0x4b8a79=_0x519e19['find'](_0x39f013=>_0x39f013[_0x381781(0xdd)]==_0x1eaaae),_0x2413fb=_0x4b8a79[_0x381781(0x194)]==_0x381781(0x1cf)?_0x381781(0x131):_0x381781(0x1cf);tgBot[_0x381781(0x103)](_0x2548cd[_0x381781(0x292)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x1eaaae+'\x20to\x20'+_0x2413fb+_0x381781(0x240))[_0x381781(0x1fb)](_0x355861=>{telegramError(_0x355861);}),toggleBotMode(_0x1eaaae);}),tgBot['removeListener'](_0x50dc77(0x1cc));});}}),tgBot[_0x1ecf68(0x246)](/\/names/,_0x2522d9=>{const _0x1f2c01=_0x1ecf68;if(!validateTelegram(_0x2522d9))return;let _0x123e44='';config[_0x1f2c01(0x209)](_0x568d3e=>{const _0x4058a7=_0x1f2c01;_0x123e44+='Bot\x20'+_0x568d3e[_0x4058a7(0xdd)]+':\x20'+_0x568d3e[_0x4058a7(0x281)]+'\x0a';}),tgBot['sendMessage'](_0x2522d9[_0x1f2c01(0x292)]['id'],_0x123e44,{'parse_mode':_0x1f2c01(0xd0)})[_0x1f2c01(0x1fb)](_0x45d4e1=>{telegramError(_0x45d4e1);});}),tgBot[_0x1ecf68(0x246)](/\/disable/,_0x892f3c=>{const _0x82fa1c=_0x1ecf68;if(!validateTelegram(_0x892f3c))return;tgBot['sendMessage'](_0x892f3c[_0x82fa1c(0x292)]['id'],_0x82fa1c(0xc1))['catch'](_0xbf134a=>{telegramError(_0xbf134a);}),updateSetting(_0x82fa1c(0xc8),![]);}),tgBot[_0x1ecf68(0x246)](/\/help/,_0x326dd4=>{const _0x81446a=_0x1ecf68;if(!validateTelegram(_0x326dd4))return;tgBot[_0x81446a(0x103)](_0x326dd4[_0x81446a(0x292)]['id'],_0x1a26f4)[_0x81446a(0x1fb)](_0x1a8711=>{telegramError(_0x1a8711);});}),tgBot['on']('polling_error',_0xd6747c=>{const _0x532b93=_0x1ecf68;_0xd6747c['toString']()[_0x532b93(0x241)](_0x532b93(0x110))&&(logger[_0x532b93(0x121)]('Invalid\x20Telegram\x20token'),tgBot['stopPolling'](),tgBot=null,io['to'](_0x532b93(0x265))['emit'](_0x532b93(0x208),_0x532b93(0xda)));}),process[_0x1ecf68(0x269)](_0x1ecf68(0x1d5),()=>{const _0x2c4b4f=_0x1ecf68;if(tgBot)tgBot[_0x2c4b4f(0x14f)]();process[_0x2c4b4f(0xd3)](0x1);}),process[_0x1ecf68(0x269)](_0x1ecf68(0x1a3),()=>{const _0x5ee397=_0x1ecf68;if(tgBot)tgBot['stopPolling']();process[_0x5ee397(0xd3)](0x1);});}}function disableTelegram(){const _0x407667=_0x487f4c;tgBot&&(tgBot[_0x407667(0x14f)](),tgBot=null);}function sendTelegram(_0x42db76,_0x89ba21){const _0x2c8b73=_0x487f4c;if(settings[_0x2c8b73(0xc8)]){if(settings['telegramEvents']==_0x2c8b73(0x16c)||(_0x89ba21['type']==_0x2c8b73(0xc7)||_0x89ba21[_0x2c8b73(0x271)]==_0x2c8b73(0x171)||_0x89ba21[_0x2c8b73(0x271)]=='success')&&settings[_0x2c8b73(0x1a6)]==_0x2c8b73(0x142)||_0x89ba21[_0x2c8b73(0x271)]==_0x2c8b73(0xca)&&settings[_0x2c8b73(0x1a6)]==_0x2c8b73(0x1c8)){if(tgBot&&settings[_0x2c8b73(0x1d9)]){if(_0x89ba21[_0x2c8b73(0x1f9)])tgBot[_0x2c8b73(0x103)](settings[_0x2c8b73(0x1d9)],_0x89ba21[_0x2c8b73(0x281)]+_0x2c8b73(0x101)+_0x89ba21[_0x2c8b73(0x12a)])[_0x2c8b73(0x1fb)](_0x5d9df2=>{telegramError(_0x5d9df2);});else tgBot['sendMessage'](settings['telegramChatId'],_0x2c8b73(0x283)+_0x42db76+_0x2c8b73(0x101)+_0x89ba21[_0x2c8b73(0x12a)])[_0x2c8b73(0x1fb)](_0x230875=>{telegramError(_0x230875);});}}}}async function sendTelegramMsg(_0x1fb203,_0x2051de=_0x487f4c(0xd0)){const _0x5d09bb=_0x487f4c;return settings[_0x5d09bb(0xc8)]&&tgBot&&settings[_0x5d09bb(0x1d9)]?(await tgBot[_0x5d09bb(0x103)](settings[_0x5d09bb(0x1d9)],_0x1fb203,{'parse_mode':_0x2051de})[_0x5d09bb(0x1fb)](_0x299b46=>{telegramError(_0x299b46);}),!![]):![];}function getDeviceWithIp(_0x55f2a4){const _0x108641=_0x487f4c;return devices[_0x108641(0x19e)](_0x1eeaba=>_0x1eeaba['ip']===_0x55f2a4);}function temporaryAccess2FA(_0x1704f0,_0x5f55dc){const _0x4c37cd=_0x487f4c;let _0x5b79c6=new Date(),_0x4ff5c8=![];if(lastIpApproval){if(_0x5b79c6-lastIpApproval<0x1388)_0x4ff5c8=!![];}lastIpApproval=new Date();if(_0x4ff5c8)return;tgBot&&settings[_0x4c37cd(0x1d9)]&&(tgBot[_0x4c37cd(0x277)](_0x4c37cd(0x1cc)),tgBot[_0x4c37cd(0x103)](settings[_0x4c37cd(0x1d9)],_0x4c37cd(0x1c5)+normalizeIP(_0x5f55dc)[_0x4c37cd(0xfa)]+_0x4c37cd(0x116),{'parse_mode':_0x4c37cd(0xd0),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x4c37cd(0x266),'callback_data':'15'},{'text':_0x4c37cd(0x145),'callback_data':'30'},{'text':_0x4c37cd(0x213),'callback_data':_0x4c37cd(0x213)}]]}})[_0x4c37cd(0x1fb)](_0x43a6eb=>{telegramError(_0x43a6eb);}),tgBot['on']('callback_query',async _0x79dc3b=>{const _0x2b2e64=_0x4c37cd,_0x210aad=_0x79dc3b['data'],_0x48b9df=_0x79dc3b['message'];tgBot[_0x2b2e64(0x25a)](_0x79dc3b['id'])[_0x2b2e64(0x197)](async()=>{const _0x13aa19=_0x2b2e64;devices[_0x1704f0][_0x13aa19(0x192)]={'clientip':_0x5f55dc,'timestamp':new Date()[_0x13aa19(0xd8)](),'expiry':_0x210aad},_0x210aad!='reject'?(await tgBot['sendMessage'](_0x48b9df['chat']['id'],'Access\x20enabled\x20for\x20'+_0x210aad+'\x20minutes',{'parse_mode':'HTML'})[_0x13aa19(0x1fb)](_0x3d1368=>{telegramError(_0x3d1368);}),io['to'](_0x1704f0)[_0x13aa19(0x23d)](_0x13aa19(0x216),{'access':{'allow':![],'reason':_0x13aa19(0x1ab),'token':null}})):(await tgBot['sendMessage'](_0x48b9df['chat']['id'],'Temporary\x20access\x20rejected')['catch'](_0x3ee10f=>{telegramError(_0x3ee10f);}),io['to'](_0x1704f0)[_0x13aa19(0x23d)](_0x13aa19(0x216),{'access':{'allow':![],'reason':_0x13aa19(0x251),'token':null}}));}),tgBot[_0x2b2e64(0x277)]('callback_query');}));}function loginAccess2FA(_0x304b5b,_0x358f5b){const _0x4f6154=_0x487f4c;tgBot&&settings[_0x4f6154(0x1d9)]&&(tgBot[_0x4f6154(0x277)](_0x4f6154(0x1cc)),tgBot[_0x4f6154(0x103)](settings[_0x4f6154(0x1d9)],_0x4f6154(0x26e)+normalizeIP(_0x358f5b)[_0x4f6154(0xfa)]+_0x4f6154(0x116),{'parse_mode':_0x4f6154(0xd0),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x4f6154(0x213),'callback_data':_0x4f6154(0x213)}]]}})[_0x4f6154(0x1fb)](_0x110b1e=>{telegramError(_0x110b1e);}),tgBot['on'](_0x4f6154(0x1cc),async _0x5d3d16=>{const _0x1dc411=_0x4f6154,_0x1f56d6=_0x5d3d16['data'],_0x4a8a7e=_0x5d3d16[_0x1dc411(0x108)];tgBot[_0x1dc411(0x25a)](_0x5d3d16['id'])[_0x1dc411(0x197)](async()=>{const _0x5b43e1=_0x1dc411;devices[_0x304b5b][_0x5b43e1(0x20b)]={'clientip':_0x358f5b,'timestamp':new Date()[_0x5b43e1(0xd8)](),'expiry':_0x1f56d6},_0x1f56d6!=_0x5b43e1(0x213)?(await tgBot[_0x5b43e1(0x103)](_0x4a8a7e[_0x5b43e1(0x292)]['id'],'Login\x20accepted',{'parse_mode':_0x5b43e1(0xd0)})[_0x5b43e1(0x1fb)](_0x34828e=>{telegramError(_0x34828e);}),io['to'](_0x304b5b)[_0x5b43e1(0x23d)](_0x5b43e1(0x216),{'access':{'allow':![],'reason':_0x5b43e1(0x1ab),'token':null}})):(await tgBot[_0x5b43e1(0x103)](_0x4a8a7e[_0x5b43e1(0x292)]['id'],_0x5b43e1(0xfb))[_0x5b43e1(0x1fb)](_0x4e681c=>{telegramError(_0x4e681c);}),io['to'](_0x304b5b)[_0x5b43e1(0x23d)](_0x5b43e1(0x216),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x1dc411(0x277)](_0x1dc411(0x1cc));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1b99fc=_0x487f4c;return dbConfig[_0x1b99fc(0xe5)](_0x1b99fc(0x203))[_0x1b99fc(0x1f1)](_0x1b99fc(0xdd))['filter']({'status':'enabled'})[_0x1b99fc(0x14d)]()||[];}function getDisabledBots(){const _0x35d1a0=_0x487f4c;return dbConfig[_0x35d1a0(0xe5)]('bots')['sortBy'](_0x35d1a0(0xdd))['filter']({'status':_0x35d1a0(0x141)})['value']()||[];}function getBotAttributes(_0x191e2c){const _0x55bd34=_0x487f4c;let _0x1894cf={};const _0x32eaa2=configpath+_0x55bd34(0x1bd)+_0x191e2c+'-config.json',_0x2a1917=fs[_0x55bd34(0x255)](_0x32eaa2);if(_0x2a1917){const _0x572473=fs[_0x55bd34(0x1c7)](_0x32eaa2);try{const _0x83684d=JSON[_0x55bd34(0x26d)](_0x572473),_0x1eba94=_0x83684d?_0x83684d[_0x55bd34(0x158)][0x0][_0x55bd34(0x1c0)]:![];_0x1894cf['mode']=_0x1eba94?_0x55bd34(0x1cf):_0x55bd34(0x131),_0x1894cf[_0x55bd34(0x281)]=_0x83684d?_0x83684d['bot'][0x0][_0x55bd34(0x281)]:'Bot\x20'+_0x191e2c;}catch(_0xa0bb02){_0x1894cf[_0x55bd34(0x194)]='manual',_0x1894cf[_0x55bd34(0x281)]=_0x55bd34(0x283)+_0x191e2c;}}else _0x1894cf['mode']=_0x55bd34(0x131),_0x1894cf['botname']=_0x55bd34(0x283)+_0x191e2c;return _0x1894cf;}function getBotsWithMode(){const _0xb924a7=_0x487f4c,_0x7a148c=dbConfig[_0xb924a7(0xe5)](_0xb924a7(0x203))['sortBy'](_0xb924a7(0xdd))[_0xb924a7(0x14d)]()||[];return _0x7a148c[_0xb924a7(0x209)](_0x1ad81a=>{const _0x51207b=_0xb924a7;let _0x235bf3=getBotAttributes(_0x1ad81a['botID']);_0x1ad81a['mode']=_0x235bf3[_0x51207b(0x194)];}),_0x7a148c;}function getBotExchanges(){const _0x4f357d=_0x487f4c;let _0x149592=[];const _0x5e1050=dbConfig[_0x4f357d(0xe5)]('bots')['sortBy']('botID')[_0x4f357d(0x14d)]()||[];_0x5e1050[_0x4f357d(0x209)](_0x24d4fc=>{const _0x47b404=_0x4f357d;if(_0x24d4fc[_0x47b404(0x216)]=='enabled'){const _0x568a77=configpath+'bot-'+_0x24d4fc['botID']+_0x47b404(0x147),_0x168759=fs[_0x47b404(0x255)](_0x568a77);let _0x27dccc;if(_0x168759){const _0x4cd402=fs[_0x47b404(0x1c7)](_0x568a77);try{const _0x1e5ab1=JSON[_0x47b404(0x26d)](_0x4cd402);_0x27dccc=_0x1e5ab1?_0x1e5ab1[_0x47b404(0x158)][0x0]['exchange']:null;}catch(_0x46c0e2){}}if(_0x27dccc)_0x149592[_0x47b404(0x1f5)](_0x27dccc);}});const _0x3ca88c=[...new Set(_0x149592)][_0x4f357d(0x105)]();return _0x3ca88c;}async function initUser(){const _0x51ba90=_0x487f4c;if(!settings['userid']){const _0x56feee=uuidRandom();mixpanel['alias'](_0x56feee),updateSetting(_0x51ba90(0x14e),_0x56feee);}}async function initSecure(){const _0x20c1b5=_0x487f4c;let _0x352508=getSecure();if(!_0x352508[_0x20c1b5(0x1a0)](_0x20c1b5(0x168))){let _0x48766a=await generateKeys();_0x352508['publicKey']=_0x48766a['publicKey'],_0x352508[_0x20c1b5(0x112)]=_0x48766a[_0x20c1b5(0x112)],_0x352508[_0x20c1b5(0x168)]=crypto['randomBytes'](0x20)[_0x20c1b5(0x1c9)]('hex');;storeSecure(_0x352508);}}function getSettings(){return dbSettings['get']('settings')['value']()||{};}function getSecure(){const _0x54246e=_0x487f4c;return dbSecure[_0x54246e(0xe5)](_0x54246e(0xea))['value']()||{};}function _0x431f(){const _0x4f64d7=['address','-results.json','Notifications\x20disabled\x0a','toIPv4MappedAddress','warning','Bot\x20Mgr\x20>\x20','************','Unauthorized\x20attempt\x20to\x20delete\x20bot','IPv4','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','showConfig','getDate','generate','getFullYear','kind','4984820bRnAeo','placeOrder','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','temporary\x20token\x20generated','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','lowdb','tkn','Node.js\x20v','login','isDirectory','yargs/yargs','4hbBmVC','sendMetricsTelegram','init','whitelist','token','randomFillSync','lastmsgtelegram','Notifications\x20enabled','get-logs','\x1b[31m','/off\x20-\x20stop\x20bot(s)\x0a','telegramIpApproval','server','mode','bb-config.json','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','then','inherit','.zip','express','login\x20token\x20valid','confirm-message','Unauthorized\x20attempt\x20to\x20show\x20configuration','find','Starting\x20Balance\x20Bot\x20','hasOwnProperty','2FA\x20login\x20token\x20generated','file','SIGTERM','socket','remove','telegramEvents','/on\x20-\x20start\x20bot(s)\x0a','function','Orders','495UaSOqN','reload','sendFile','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','2FA\x20login\x20required','uuid','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','14682YxEptu','get-starting-balances','set','reinstall-bb','RSA-OAEP','exp','Backup\x20file\x20uploaded','Unauthorized\x20attempt\x20to\x20confirm\x20message','join','mkdirSync','backup-full@','bot-','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','get-messages','headless','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','\x1b[34m','debug','slice','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','readFileSync','orders','toString','settings.','pidRefreshToken','callback_query','add-bot','params','auto','Unauthorized\x20attempt\x20to\x20delete\x20alerts','replace','defaults','Session\x20expired\x20for\x20user\x20...','DEFLATE','SIGINT','Password\x20has\x20been\x20reset\x20to:\x20','Unauthorized\x20attempt\x20to\x20download\x20','Invalid\x20IP\x20address','telegramChatId','\x1b[0m','number','temporary\x20access\x20not\x20allowed','download','/:bot/configuration','backup','/restart\x20-\x20restart\x20bot(s)\x0a','startsWith','started','Logged\x20in\x20user\x20...','port','store-fiat','ipaddr.js','zip/','Markdown','enabled','uncaughtException','temporary\x20access\x20timeout','Ok,\x20will\x20send\x20alert\x20notifications\x20only','update-bb',':\x20Bot\x20Mgr\x20>\x20','lastmsgemitted','bb/','sortBy','getSeconds','compareSync','assign','push','env','decrypt','allow','showname','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','catch','get-backup-files','exec','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Yes','writeFileSync','reason','cancel-loading','bots','output-002.log','match','http','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','notification','forEach','::1','telegram2FaApproval','any','deleteHistoryAlerts','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','track','new-disabled','Unauthorized\x20attempt\x20to\x20update\x20bot','storeFiat','reject','stop','Restore\x20backup\x20file\x20','status','keys','login\x20required','password','RSA','expiry','bbUsername','\x20only\x0a','telegram','internal','2FA\x20required','[ip-address]','All\x20bots','send','<b>Telegram\x20Bot\x20Status:</b>\x0a','\x20|\x20user:\x20...','=>\x20Go\x20to\x20#CYA#http://','Logged\x20out\x20user\x20...','Notifications\x20enabled\x0a','split','settings','invalid\x20credentials','getMonth','loginRequired','logs',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','version.json','Starting\x20new\x20bot\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20store\x20configuration','File\x20uploaded','/upload-backup','-performance.json','Starting\x20Balance\x20Bot\x20reinstallation','bb-settings.json','Invalid\x20username\x20or\x20IP\x20address','Crypt','-events.json','static','0.0.0','emit','getHours','ipv6','\x20mode','includes','referer','size','min','simple','onText','onepagemode','Your\x20installation\x20is\x20already\x20up\x20to\x20date','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','cloneDeep','graphql-request','ipc','login\x20token\x20generated','delete-bot','Password\x20reset\x20rejected','unlinkSync','temporary\x20access\x20rejected','Ok,\x20will\x20send\x20order\x20notifications\x20only','node','Starting\x20Balance\x20Bot\x20update','existsSync','Starting\x20#RED#Balance\x20Bot\x20v','verify','copyFileSync','/names\x20-\x20show\x20bot\x20names\x0a','answerCallbackQuery','https://api.ipify.org?format=json','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','max','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','write','axios','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','latestversion','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','encryptedUuid','botmanager','15\x20min','index.html','/help\x20-\x20show\x20available\x20commands\x0a','once','telegramUsername','isValid','config/','parse','Allow\x20login\x20from\x20IP\x20address\x20<b>','emitHistory','success','type','whitelistEnabled','createWriteStream',',\x20must\x20be\x20a\x204\x20digit\x20number','logged\x20out','127.0.0.1','removeListener','bbvReceive','\x20(2)','update','reinstall','-----------------------------------------------------------------------------------','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','auth','\x20|\x20','delete-alerts','botname','#RES#\x0a','Bot\x20','express-fileupload','apply','readdirSync','Unauthorized\x20attempt\x20to\x20add\x20bot','::ffff:127.0.0.1','host','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','listen','<b>Balance\x20Bot\x20Status:</b>\x0a','private','bbPassword','backup-files','Backup\x20file\x20unzipped\x20and\x20stored','date-fns','chat','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','/download/:type','headers','mixpanel','Error\x20removing\x20old\x20backup\x20files:','string','All\x20bots\x20running\x20right\x20now','Notifications\x20disabled','blacklist','reset-history','add','sendPortfolioTelegram','fork','error','telegramEnabled','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','order','bbvNew','f2aRequired','length','Server','backup-full','HTML','clientip','login\x20not\x20required','exit','data','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Unauthorized\x20attempt\x20to\x20log\x20out','getTime','log','Invalid\x20Telegram\x20token','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','store','botID','User\x20has\x20been\x20validated','conn','yes','request','Unauthorized\x20attempt\x20to\x20get\x20portfolio','endsWith','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','get','lowdb/adapters/FileSync','restart','toggleBotMode','getMinutes','secure','Notifications\x20types:\x20','build','restore-backup-file','live','/:bot/performance','storeHeadless','Restore\x20process\x20aborted','handshake','reset-password','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','test','2FA','argv','/status\x20-\x20show\x20bot(s)\x20status\x0a','api-eu.mixpanel.com','show','Login\x20rejected','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','temporaryAccessAllowed','util','896535tItjbC','1071246hTByZL','\x20>\x20','bb-secure.json','sendMessage','mtime','sort','removeAllListeners','build2','message','disconnect','getUTCHours','uuid-random','/:bot/coins','sha256','apiKey','Invalid\x20authentication\x20token\x20(1)','404\x20Not\x20Found','\x1b[36m','privateKey','/output-000.log','logout','entries','</b>\x20?','Unauthorized\x20attempt\x20to\x20get\x20messages','apiPassword','telegramToken','3rVDPhF','1407434pyrnIO','Enabled\x20Bot\x20','publicKey','from','padStart','socket.io','full','***','files','Starting\x20bot\x20|\x20Bot\x20','/:bot/support','user','/update\x20-\x20update\x20Balance\x20Bot\x0a','apiSecret',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','event','family','86344gDfHqN','constructor','temp/','new','Token\x20blacklisted','manual','search','toIPv4Address','#RES#\x20if\x20running\x20on\x20server','timeshift','remoteAddress','6b67f3d61ee94b8f5c80b4affef4c4d9','hybrid-crypto-js','stringify','stopped','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','You\x20can\x20use\x20the\x20following\x20commands:\x0a','storeConfiguration','/:bot/portfolio','output-000.log','toggle-bot-mode','disabled','alerts','access\x20timeout','messages','30\x20min','No\x20bots\x20running\x20right\x20now','-config.json','show-config','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','use','username','node-zip','value','userid','stopPolling','initclient','\x1b[33m','args','Error:\x20Invalid\x20argument\x20','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','$1_$2_$3','running','get-portfolio','bot','pidExpireLogin','output-001.log','telegrammsg','40142vKHkdR','sign','logs/','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','kill','store-headless','name','rmSync','backupfile','versions','statSync','store-settings','secret','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','access','timestamp','all'];_0x431f=function(){return _0x4f64d7;};return _0x431f();}function getBlacklist(){const _0x556258=_0x487f4c;return dbSecure[_0x556258(0xe5)](_0x556258(0xc2))[_0x556258(0x14d)]()||[];}function broadcastToBots(_0x5e1237,_0x29b6bc){const _0x497eda=_0x487f4c;config[_0x497eda(0x209)](_0xd4f027=>{const _0x2ad993=_0x497eda;if(_0xd4f027[_0x2ad993(0x216)]==_0x2ad993(0x1e9)&&_0xd4f027[_0x2ad993(0xee)]==_0x2ad993(0x156)||_0xd4f027['status']=='new'&&_0xd4f027['live']==_0x2ad993(0x156)){if(pid[_0xd4f027[_0x2ad993(0xdd)]])pid[_0xd4f027[_0x2ad993(0xdd)]]['send']({[_0x5e1237]:_0x29b6bc});}});}function storeSettings(_0x26fa78,_0x4839ed=![]){const _0x597e66=_0x487f4c;_0x26fa78={...settings,..._0x26fa78};if(_0x4839ed&&_0x26fa78[_0x597e66(0x28e)]!=_0x597e66(0x173)&&_0x26fa78[_0x597e66(0x28e)]!='***'&&_0x26fa78[_0x597e66(0x28e)]!=''){const _0x551343=crypt['decrypt'](secure[_0x597e66(0x112)],_0x26fa78[_0x597e66(0x28e)])[_0x597e66(0x108)]['split']('@')[0x0],_0x4d749d=bcrypt['hashSync'](_0x551343,saltRounds);_0x26fa78={..._0x26fa78,'bbPassword':_0x4d749d};}if(_0x4839ed&&_0x26fa78[_0x597e66(0x119)]!=_0x597e66(0x173)&&_0x26fa78[_0x597e66(0x119)]!=_0x597e66(0x122)&&_0x26fa78[_0x597e66(0x119)]!=''){const _0x1afc25=crypt[_0x597e66(0x1f7)](secure['privateKey'],_0x26fa78[_0x597e66(0x119)])['message'][_0x597e66(0x229)]('@')[0x0];_0x26fa78={..._0x26fa78,'telegramToken':_0x1afc25};}const _0x23c8b7=_0x26fa78['telegramToken']!=_0x597e66(0x173)&&_0x26fa78['telegramToken']!=settings[_0x597e66(0x119)]||_0x26fa78[_0x597e66(0x26a)]!=settings[_0x597e66(0x26a)],_0x15678d=_0x26fa78['telegramToken']==''||_0x26fa78[_0x597e66(0x26a)]=='';if(_0x23c8b7)_0x26fa78['telegramEvents']='all';for(const [_0x58c3ac,_0x216dff]of Object[_0x597e66(0x115)](_0x26fa78)){if(_0x58c3ac==_0x597e66(0x119)&&_0x216dff==_0x597e66(0x173)){_0x26fa78[_0x597e66(0x119)]=settings[_0x597e66(0x119)];continue;};if(_0x58c3ac==_0x597e66(0x28e)&&_0x216dff=='************'){_0x26fa78[_0x597e66(0x28e)]=settings[_0x597e66(0x28e)];continue;};dbSettings[_0x597e66(0x1b4)](_0x597e66(0x1ca)+_0x58c3ac,_0x216dff)[_0x597e66(0x25f)]();}settings=_0x26fa78,io['to']('botmanager')[_0x597e66(0x23d)]('settings',cleanSettings()),broadcastToBots(_0x597e66(0x135),settings['timeshift']),broadcastToBots(_0x597e66(0x247),settings[_0x597e66(0x247)]);if(_0x23c8b7&&!_0x15678d)initTelegram();if(_0x23c8b7&&_0x15678d)disableTelegram();getAllClients()[_0x597e66(0x209)](_0x23459c=>{const _0x34a3e1=_0x597e66;getSocket(_0x23459c['id'])[_0x34a3e1(0x23d)](_0x34a3e1(0x216),{'access':{'allow':![],'reason':_0x34a3e1(0x1ab),'token':null}});});}function updateSetting(_0x3311f5,_0xa7baf5){const _0x52b24c=_0x487f4c;dbSettings[_0x52b24c(0x1b4)](_0x52b24c(0x1ca)+_0x3311f5,_0xa7baf5)[_0x52b24c(0x25f)](),settings=getSettings(),io['to']('botmanager')[_0x52b24c(0x23d)](_0x52b24c(0x22a),cleanSettings());}function storeSecure(_0x2eafa1){const _0x4be90f=_0x487f4c;dbSecure[_0x4be90f(0xe5)](_0x4be90f(0xea))[_0x4be90f(0x1f5)](_0x2eafa1)['write'](),secure=_0x2eafa1;}function addBlacklist(_0x2bf994){const _0x4fec0c=_0x487f4c;cleanBlacklist();let _0x41082a;devices[_0x2bf994][_0x4fec0c(0x192)]?_0x41082a=Math[_0x4fec0c(0x25d)](devices[_0x2bf994][_0x4fec0c(0x192)]['expiry'],loginExpiry):_0x41082a=loginExpiry,dbSecure[_0x4fec0c(0xe5)]('blacklist')['push']({'expiry':new Date()[_0x4fec0c(0xd8)]()+_0x41082a*0x3c*0x3e8,'token':devices[_0x2bf994][_0x4fec0c(0x16a)]['token']})[_0x4fec0c(0x25f)](),blacklist=dbSecure['get'](_0x4fec0c(0xc2))['value']();}function cleanBlacklist(){const _0x2cfa2c=_0x487f4c;let _0xdac689=dbSecure[_0x2cfa2c(0xe5)](_0x2cfa2c(0xc2))[_0x2cfa2c(0x24a)]()[_0x2cfa2c(0x14d)](),_0x7c5484=new Date()['getTime']();_0xdac689[_0x2cfa2c(0x209)](_0x2e8400=>{const _0x3e98fd=_0x2cfa2c;_0x2e8400[_0x3e98fd(0x21b)]<_0x7c5484&&dbSecure[_0x3e98fd(0xe5)](_0x3e98fd(0xc2))['remove']({'expiry':_0x2e8400[_0x3e98fd(0x21b)]})['write']();});}function initStates(){let _0x261e3c=getConfiguration();_0x261e3c['forEach'](_0x3bfd9e=>{const _0x33e147=_0x19ac;_0x3bfd9e[_0x33e147(0xee)]=_0x33e147(0x13a);}),storeConfiguration(_0x261e3c);}function onKeys(){const _0x30fcc7=new RSA();return new Promise(_0x4bd613=>{const _0x392473=_0x19ac;_0x30fcc7['generateKeyPairAsync']()[_0x392473(0x197)](_0x543c6b=>{_0x4bd613(_0x543c6b);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x633eed=_0x487f4c;let _0x3647fe=getSettings(),_0x4d0397=![];!_0x3647fe[_0x633eed(0x1a0)]('lastmsgtelegram')&&(_0x3647fe['lastmsgtelegram']=0x0,_0x4d0397=!![]);!_0x3647fe[_0x633eed(0x1a0)](_0x633eed(0x1ef))&&(_0x3647fe[_0x633eed(0x1ef)]=0x0,_0x4d0397=!![]);!_0x3647fe[_0x633eed(0x1a0)](_0x633eed(0x262))&&(_0x3647fe[_0x633eed(0x262)]=_0x633eed(0x23c),_0x4d0397=!![]);!_0x3647fe['hasOwnProperty']('onepagemode')&&(_0x3647fe[_0x633eed(0x247)]=![],_0x4d0397=!![]);if(_0x4d0397)storeSettings(_0x3647fe);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x1fbbbc=>{const _0x447fe1=_0x633eed;if(!_0x1fbbbc[_0x447fe1(0x185)]()){if(!_0x1fbbbc[_0x447fe1(0x162)][_0x447fe1(0x1e1)](_0x447fe1(0x1bc)))fs[_0x447fe1(0x250)](configbackuppath+_0x1fbbbc[_0x447fe1(0x162)]);}else fs['rmSync'](configbackuppath+_0x1fbbbc[_0x447fe1(0x162)],{'recursive':!![]});});}catch(_0x2df842){logger[_0x633eed(0x1c3)](_0x633eed(0xbe),_0x2df842);}}function storeConfiguration(_0x218833){const _0x3e2952=_0x487f4c;dbConfig['get'](_0x3e2952(0x203))[_0x3e2952(0x1a5)]()[_0x3e2952(0x25f)](),_0x218833[_0x3e2952(0x209)](_0x3b57c9=>{const _0x5a0f00=_0x3e2952;delete _0x3b57c9[_0x5a0f00(0x194)];}),dbConfig[_0x3e2952(0xe5)](_0x3e2952(0x203))[_0x3e2952(0x1f5)](..._0x218833)[_0x3e2952(0x25f)](),config=_0x218833;}function resetPassword(){const _0xc3d9a8=_0x487f4c;tgBot&&settings[_0xc3d9a8(0x1d9)]&&(tgBot[_0xc3d9a8(0x277)](_0xc3d9a8(0x1cc)),tgBot['sendMessage'](settings[_0xc3d9a8(0x1d9)],_0xc3d9a8(0x1c1),{'parse_mode':_0xc3d9a8(0xd0),'reply_markup':{'inline_keyboard':[[{'text':_0xc3d9a8(0xe0),'callback_data':_0xc3d9a8(0xe0)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x50ba25=>{telegramError(_0x50ba25);}),tgBot['on'](_0xc3d9a8(0x1cc),async _0x180a5c=>{const _0x436ec9=_0xc3d9a8,_0x17f223=_0x180a5c[_0x436ec9(0xd4)],_0x2226ad=_0x180a5c[_0x436ec9(0x108)];tgBot[_0x436ec9(0x25a)](_0x180a5c['id'])['then'](async()=>{const _0x1a6f55=_0x436ec9;if(_0x17f223!='no'){const _0x55aee8=0xf,_0x5b5ca9=_0x1a6f55(0x149),_0x5ca135=Array['from'](crypto[_0x1a6f55(0x18c)](new Uint32Array(_0x55aee8)))['map'](_0x4b4371=>_0x5b5ca9[_0x4b4371%_0x5b5ca9[_0x1a6f55(0xcd)]])[_0x1a6f55(0x1ba)](''),_0x51037d=bcrypt['hashSync'](_0x5ca135,saltRounds);storeSettings({'bbPassword':_0x51037d}),await tgBot[_0x1a6f55(0x103)](_0x2226ad[_0x1a6f55(0x292)]['id'],_0x1a6f55(0x1d6)+_0x5ca135,{'parse_mode':_0x1a6f55(0xd0)})[_0x1a6f55(0x1fb)](_0x47ce8a=>{telegramError(_0x47ce8a);});}else await tgBot[_0x1a6f55(0x103)](_0x2226ad['chat']['id'],_0x1a6f55(0x24f))[_0x1a6f55(0x1fb)](_0x3ad7cf=>{telegramError(_0x3ad7cf);});}),tgBot['removeListener']('callback_query');}));}async function confirmRestore(_0x10bef0,_0x2a3819){const _0x2217a4=_0x487f4c;io['to']('botmanager')[_0x2217a4(0x23d)]('notification',_0x2217a4(0xe4),_0x2217a4(0x270)),tgBot&&settings['telegramChatId']&&(tgBot['removeListener'](_0x2217a4(0x1cc)),await tgBot['sendMessage'](settings['telegramChatId'],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x2217a4(0xe0),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x2217a4(0x1fb)](_0x8c8455=>{telegramError(_0x8c8455);}),tgBot['on'](_0x2217a4(0x1cc),async _0x22cc24=>{const _0x33c1d9=_0x2217a4,_0x3b9a24=_0x22cc24[_0x33c1d9(0xd4)],_0x1c9f4f=_0x22cc24[_0x33c1d9(0x108)];tgBot[_0x33c1d9(0x25a)](_0x22cc24['id'])[_0x33c1d9(0x197)](async()=>{const _0x13a782=_0x33c1d9;_0x3b9a24=='yes'?(await tgBot['sendMessage'](_0x1c9f4f[_0x13a782(0x292)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x13a782(0xd0)})[_0x13a782(0x1fb)](_0x4e9ef4=>{telegramError(_0x4e9ef4);}),unzipFile(_0x10bef0,_0x2a3819)):(logger[_0x13a782(0x1c3)](_0x13a782(0xf1)),await tgBot[_0x13a782(0x103)](_0x1c9f4f[_0x13a782(0x292)]['id'],_0x13a782(0xf1))[_0x13a782(0x1fb)](_0x2d0ea2=>{telegramError(_0x2d0ea2);}));}),tgBot['removeListener'](_0x33c1d9(0x1cc));}));}function getServerTime(){const _0x5badc1=_0x487f4c,_0x3e3886=new Date();return _0x3e3886[_0x5badc1(0x17a)]()+'/'+(_0x3e3886['getMonth']()+0x1)[_0x5badc1(0x1c9)]()[_0x5badc1(0x11f)](0x2,'0')+'/'+_0x3e3886[_0x5badc1(0x178)]()[_0x5badc1(0x1c9)]()[_0x5badc1(0x11f)](0x2,'0')+'\x20'+_0x3e3886[_0x5badc1(0x23e)]()[_0x5badc1(0x1c9)]()['padStart'](0x2,'0')+':'+_0x3e3886['getMinutes']()['toString']()[_0x5badc1(0x11f)](0x2,'0')+':'+_0x3e3886[_0x5badc1(0x1f2)]()[_0x5badc1(0x1c9)]()[_0x5badc1(0x11f)](0x2,'0');}function getTimeStamp(){const _0xe3b4a=_0x487f4c,_0x16c0b8=shiftedTime();return _0x16c0b8['getFullYear']()+'/'+(_0x16c0b8[_0xe3b4a(0x22c)]()+0x1)[_0xe3b4a(0x1c9)]()['padStart'](0x2,'0')+'/'+_0x16c0b8['getDate']()[_0xe3b4a(0x1c9)]()[_0xe3b4a(0x11f)](0x2,'0')+'\x20'+_0x16c0b8[_0xe3b4a(0x23e)]()[_0xe3b4a(0x1c9)]()[_0xe3b4a(0x11f)](0x2,'0')+':'+_0x16c0b8[_0xe3b4a(0xe9)]()[_0xe3b4a(0x1c9)]()[_0xe3b4a(0x11f)](0x2,'0')+':'+_0x16c0b8[_0xe3b4a(0x1f2)]()[_0xe3b4a(0x1c9)]()[_0xe3b4a(0x11f)](0x2,'0');}function getCleanTimeStamp(){const _0xd1f468=_0x487f4c,_0x42a7cc=shiftedTime();return _0x42a7cc[_0xd1f468(0x17a)]()+(_0x42a7cc['getMonth']()+0x1)[_0xd1f468(0x1c9)]()['padStart'](0x2,'0')+_0x42a7cc[_0xd1f468(0x178)]()[_0xd1f468(0x1c9)]()['padStart'](0x2,'0')+'-'+_0x42a7cc[_0xd1f468(0x23e)]()['toString']()[_0xd1f468(0x11f)](0x2,'0')+_0x42a7cc[_0xd1f468(0xe9)]()[_0xd1f468(0x1c9)]()[_0xd1f468(0x11f)](0x2,'0')+_0x42a7cc[_0xd1f468(0x1f2)]()[_0xd1f468(0x1c9)]()[_0xd1f468(0x11f)](0x2,'0');}function shiftedTime(){const _0x137e44=_0x487f4c,_0x108701=new Date();let _0x4d3190=_0x108701;if(settings[_0x137e44(0x135)]&&settings[_0x137e44(0x135)]!==0x0)_0x4d3190=fns[_0x137e44(0xc4)](_0x108701,{'hours':settings['timeshift']});return _0x4d3190;}function startScheduler(){const _0x426740=_0x487f4c,_0x14fe0b=new Date()[_0x426740(0x10a)](),_0x50c42a=shiftedTime()['getHours']();_0x50c42a==0x4&&backupConfigFiles();_0x50c42a==0x0&&rotateLogFiles();_0x14fe0b%0x6==0x0&&triggerAnalytics();_0x14fe0b%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function _0x19ac(_0x29f8b6,_0x10077e){const _0x445f90=_0x431f();return _0x19ac=function(_0x5387d1,_0x2e794d){_0x5387d1=_0x5387d1-0xbb;let _0x431f72=_0x445f90[_0x5387d1];return _0x431f72;},_0x19ac(_0x29f8b6,_0x10077e);}async function restoreBackupFile(_0x305d30){const _0x34f0d9=_0x487f4c;logger[_0x34f0d9(0x1c3)](_0x34f0d9(0x215)+_0x305d30);const _0x2d1137=getBotsWithMode();_0x2d1137[_0x34f0d9(0xcd)]>0x0?confirmRestore(configbackuppath,_0x305d30):unzipFile(configbackuppath,_0x305d30);}async function getBackupFiles(_0x1c9a78=null){const _0x4f3707=_0x487f4c;let _0x1ef5a2=[],_0x2c55b9=fs[_0x4f3707(0x286)](configbackuppath,{'withFileTypes':!![]});_0x2c55b9['sort']((_0x1b32e5,_0x3b447e)=>_0x1b32e5[_0x4f3707(0x162)]<_0x3b447e[_0x4f3707(0x162)]?0x1:_0x3b447e[_0x4f3707(0x162)]<_0x1b32e5[_0x4f3707(0x162)]?-0x1:0x0),_0x2c55b9[_0x4f3707(0x209)](_0x24d21a=>{const _0x1255a7=_0x4f3707;if(!_0x24d21a['isDirectory']()&&_0x24d21a[_0x1255a7(0x162)][_0x1255a7(0x1e1)](_0x1255a7(0x1bc))&&_0x24d21a[_0x1255a7(0x162)][_0x1255a7(0xe3)](_0x1255a7(0x199))){const _0x483a66=formatDate(fs[_0x1255a7(0x166)](configbackuppath+_0x24d21a[_0x1255a7(0x162)])[_0x1255a7(0x104)]);_0x1ef5a2[_0x1255a7(0x1f5)]({'name':_0x24d21a[_0x1255a7(0x162)],'mtime':_0x483a66});}});if(_0x1c9a78)io['to'](_0x1c9a78)[_0x4f3707(0x23d)](_0x4f3707(0x28f),_0x1ef5a2);else return _0x1ef5a2;}async function backupConfigFiles(){const _0x531a04=_0x487f4c;await zipFiles('backup-full');const _0x3d67a0=getCleanTimeStamp();fs[_0x531a04(0x258)](zippath+'backup-full.zip',configbackuppath+(_0x531a04(0x1bc)+_0x3d67a0+_0x531a04(0x199)));let _0x1d99a2=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x1d99a2[_0x531a04(0x105)]((_0x148b1f,_0x382a16)=>_0x148b1f[_0x531a04(0x162)]<_0x382a16[_0x531a04(0x162)]?0x1:_0x382a16[_0x531a04(0x162)]<_0x148b1f[_0x531a04(0x162)]?-0x1:0x0),_0x1d99a2[_0x531a04(0xcd)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x1d99a2[_0x1d99a2[_0x531a04(0xcd)]-0x1][_0x531a04(0x162)]);}function rotateLogFiles(){const _0x1bd1c4=_0x487f4c,_0x1d90f2=fs['statSync'](logspath+_0x1bd1c4(0x13f)),_0x30ff6d=_0x1d90f2[_0x1bd1c4(0x243)]/0x400;if(_0x30ff6d>0x64){let _0x42d564=fs[_0x1bd1c4(0x286)](logspath,{'withFileTypes':!![]});_0x42d564[_0x1bd1c4(0x105)]((_0x4ca005,_0x3274f9)=>_0x4ca005['name']<_0x3274f9['name']?0x1:_0x3274f9[_0x1bd1c4(0x162)]<_0x4ca005[_0x1bd1c4(0x162)]?-0x1:0x0),_0x42d564['forEach'](_0x729e32=>{const _0x4543c0=_0x1bd1c4;if(_0x729e32['name']==_0x4543c0(0x204))fs[_0x4543c0(0x258)](logspath+_0x729e32[_0x4543c0(0x162)],logspath+'output-003.log');if(_0x729e32[_0x4543c0(0x162)]==_0x4543c0(0x15a))fs[_0x4543c0(0x258)](logspath+_0x729e32[_0x4543c0(0x162)],logspath+'output-002.log');_0x729e32['name']==_0x4543c0(0x13f)&&(fs['copyFileSync'](logspath+_0x729e32[_0x4543c0(0x162)],logspath+_0x4543c0(0x15a)),fs[_0x4543c0(0x200)](logspath+_0x729e32[_0x4543c0(0x162)],''));});}}async function zipFiles(_0x4a31e3){const _0x57e227=_0x487f4c;let _0x19252c;if(_0x4a31e3==_0x57e227(0x22e))_0x19252c=logspath;if(_0x4a31e3==_0x57e227(0x1df))_0x19252c=configpath;if(_0x4a31e3==_0x57e227(0xcf))_0x19252c=configpath;let _0x55065d=fs['readdirSync'](_0x19252c,{'withFileTypes':!![]});const _0x1d8c2f=new require(_0x57e227(0x14c))();_0x55065d['forEach'](_0x44ac60=>{const _0xe427c9=_0x57e227;if(!_0x44ac60[_0xe427c9(0x185)]()){let _0x481b24=fs['readFileSync'](_0x19252c+_0x44ac60[_0xe427c9(0x162)]);if(_0x4a31e3==_0xe427c9(0x1df)){const _0x341528=/^bot-[0-9]{3}-config.json$/,_0x54f8a5=_0x341528[_0xe427c9(0xf5)](_0x44ac60[_0xe427c9(0x162)]);if(_0x54f8a5){const _0x3cef8d=JSON['parse'](_0x481b24);if(_0x3cef8d['bot'][0x0]){_0x3cef8d[_0xe427c9(0x158)][0x0][_0xe427c9(0x10e)]=_0xe427c9(0x122),_0x3cef8d[_0xe427c9(0x158)][0x0][_0xe427c9(0x128)]='***';if(_0x3cef8d[_0xe427c9(0x158)][0x0][_0xe427c9(0x118)])_0x3cef8d[_0xe427c9(0x158)][0x0][_0xe427c9(0x118)]=_0xe427c9(0x122);}_0x481b24=JSON['stringify'](_0x3cef8d,null,0x2);}if(_0x44ac60[_0xe427c9(0x162)]==_0xe427c9(0x237)){const _0x2346cc=JSON[_0xe427c9(0x26d)](_0x481b24);if(_0x2346cc[_0xe427c9(0x22a)][_0xe427c9(0x22d)])_0x2346cc[_0xe427c9(0x22a)][_0xe427c9(0x22d)]=![];if(_0x2346cc['settings']['bbPassword'])_0x2346cc[_0xe427c9(0x22a)]['bbPassword']=_0xe427c9(0x122);if(_0x2346cc[_0xe427c9(0x22a)][_0xe427c9(0x119)])_0x2346cc[_0xe427c9(0x22a)][_0xe427c9(0x119)]=_0xe427c9(0x122);if(_0x2346cc[_0xe427c9(0x22a)]['telegramChatId'])_0x2346cc['settings'][_0xe427c9(0x1d9)]=null;_0x481b24=JSON[_0xe427c9(0x139)](_0x2346cc,null,0x2);}if(_0x44ac60[_0xe427c9(0x162)]!=_0xe427c9(0x102))_0x1d8c2f[_0xe427c9(0x1a2)](_0x44ac60[_0xe427c9(0x162)],_0x481b24);}else _0x1d8c2f[_0xe427c9(0x1a2)](_0x44ac60[_0xe427c9(0x162)],_0x481b24);}});const _0x5d13e3=_0x1d8c2f[_0x57e227(0x179)]({'base64':![],'compression':_0x57e227(0x1d4)});fs[_0x57e227(0x200)](zippath+(_0x4a31e3+_0x57e227(0x199)),_0x5d13e3,'binary');}async function unzipFile(_0x2e1945,_0x5d1327){const _0xf4119=_0x487f4c;fs[_0xf4119(0x286)](configpath,{'withFileTypes':!![]})[_0xf4119(0x209)](_0x59111a=>{const _0x3b598d=_0xf4119;if(!_0x59111a[_0x3b598d(0x185)]())fs[_0x3b598d(0x163)](configpath+_0x59111a['name']);});const _0x49a6f1=fs[_0xf4119(0x1c7)](_0x2e1945+_0x5d1327,'binary'),_0xea21e=new require('node-zip')(_0x49a6f1,{'base64':![],'checkCRC32':!![]});Object[_0xf4119(0x217)](_0xea21e['files'])[_0xf4119(0x209)](_0x5e5629=>{const _0x25c712=_0xf4119,_0x4feb57=_0xea21e[_0x25c712(0x123)][_0x5e5629];fs[_0x25c712(0x200)](configpath+_0x4feb57['name'],_0x4feb57['_data']);}),fs[_0xf4119(0x286)](temppath,{'withFileTypes':!![]})[_0xf4119(0x209)](_0x45e52e=>{const _0x16d8a1=_0xf4119;if(!_0x45e52e[_0x16d8a1(0x185)]())fs['rmSync'](temppath+_0x45e52e[_0x16d8a1(0x162)]);}),logger['debug'](_0xf4119(0x290)),process[_0xf4119(0x223)]({'restore':!![]},_0x2f424f=>{});}async function getPublicIp(){const _0x2ac32a=_0x487f4c;try{const _0x121f58=await axios[_0x2ac32a(0xe5)](_0x2ac32a(0x25b));publicip=_0x121f58[_0x2ac32a(0xd4)]['ip'];}catch(_0x3b004d){}}async function triggerAnalytics(){const _0x581b12=_0x487f4c;if(!publicip)await getPublicIp();const _0x22f887=getBotsWithMode();let _0x17157e=0x0;_0x22f887[_0x581b12(0x209)](_0x55b4c4=>{const _0x500828=_0x581b12;if(_0x55b4c4[_0x500828(0x216)]==='enabled')_0x17157e++;});const _0x46e984=getBotExchanges();mixpanel[_0x581b12(0x20f)](_0x581b12(0xce),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x22f887[_0x581b12(0xcd)],'numbotsenabled':_0x17157e,'exchanges':_0x46e984});}async function getMessages(){const _0x521c01=_0x487f4c,_0x119340='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x48a43b=new GraphQLClient(_0x119340),_0x1d39d6={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x32522c=serverversion['split']('.'),_0x170bc6=_0x32522c[0x0]+'.'+_0x32522c[0x1],_0x20d462=Math[_0x521c01(0x244)](settings['lastmsgtelegram'],settings['lastmsgemitted']),_0xebd2af={'last':parseInt(_0x20d462),'bbm':_0x170bc6},_0x53c7d4=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0xbb69bc;try{_0xbb69bc=await _0x48a43b[_0x521c01(0xe1)](_0x53c7d4,_0xebd2af,_0x1d39d6);}catch(_0x724dd4){}if(_0xbb69bc&&_0xbb69bc['messages']){let _0x46d685=settings[_0x521c01(0x18d)];newMessages=[];for(const _0x37e41d of _0xbb69bc[_0x521c01(0x144)]){newMessages[_0x521c01(0x1f5)](_0x37e41d);if(_0x37e41d[_0x521c01(0xcb)])updateSetting(_0x521c01(0x262),_0x37e41d['bbvNew']);let _0x2c9a67=_0x37e41d[_0x521c01(0xcb)]?serverversion>=_0x37e41d[_0x521c01(0xcb)]:![];if(!_0x2c9a67&&_0x37e41d[_0x521c01(0x1db)]>_0x46d685){if(_0x37e41d[_0x521c01(0x278)]===_0x521c01(0x20c)||serverversion[_0x521c01(0x1e1)](_0x37e41d[_0x521c01(0x278)])){let _0x4fc090=''+_0x37e41d['title']+'\x0a\x0a'+_0x37e41d['message'];const _0x2bdd66=await sendTelegramMsg(toTelegramMarkdown(_0x4fc090),_0x521c01(0x1e8));if(_0x2bdd66)_0x46d685=_0x37e41d[_0x521c01(0x1db)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x521c01(0x18d),_0x46d685),emitMessages();}}function emitMessages(){const _0x5da6d5=_0x487f4c,_0x333b41=settings['lastmsgemitted'];let _0x47f3ee=[];newMessages[_0x5da6d5(0x209)](_0x5f24aa=>{const _0x5338fc=_0x5da6d5;_0x5f24aa[_0x5338fc(0x1db)]>_0x333b41&&_0x47f3ee[_0x5338fc(0x1f5)](_0x5f24aa);}),_0x47f3ee[_0x5da6d5(0xcd)]>0x0&&getAllClients()[_0x5da6d5(0x209)](_0x4229da=>{const _0x244daf=_0x5da6d5;getSocket(_0x4229da['id'])[_0x244daf(0x23d)]('message',_0x47f3ee);});}function confirmMessage(_0x105b10){updateSetting('lastmsgemitted',Number(_0x105b10));}function isNewerVersion(_0x2c2b7c,_0x54dd93){const _0x3c0dd0=_0x487f4c,_0xb712cf=_0x54dd93[_0x3c0dd0(0x229)]('.'),_0x520f89=_0x2c2b7c[_0x3c0dd0(0x229)]('.');for(var _0x5676=0x0;_0x5676<_0x520f89[_0x3c0dd0(0xcd)];_0x5676++){const _0x278003=~~_0x520f89[_0x5676],_0x59f7bc=~~_0xb712cf[_0x5676];if(_0x278003>_0x59f7bc)return!![];if(_0x278003<_0x59f7bc)return![];}return![];}function toTelegramMarkdown(_0x3c6c08){const _0x31773d=_0x487f4c,_0x3c26a7=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x5747e4=/\*{2}(.+?)\*{2}/gim;return _0x3c6c08=_0x3c6c08[_0x31773d(0x1d1)](_0x3c26a7,_0x31773d(0x155))[_0x31773d(0x1d1)](_0x5747e4,'*$1*'),_0x3c6c08;}async function validateConfigFile(){const _0x3b1be6=_0x487f4c,_0x272cca=dbConfig[_0x3b1be6(0xe5)](_0x3b1be6(0x203))[_0x3b1be6(0x1f1)](_0x3b1be6(0xdd))[_0x3b1be6(0x14d)]()||[];if(_0x272cca[_0x3b1be6(0xcd)]==0x0){let _0x22f680=0x0,_0x462169=[];const _0x206825=/^bot-([0-9]{3})-config.json$/,_0x59a4b0=fs[_0x3b1be6(0x286)](configpath);_0x59a4b0[_0x3b1be6(0x209)](_0x265ce5=>{const _0x51d5ac=_0x3b1be6,_0x2d07d8=_0x206825[_0x51d5ac(0x1fd)](_0x265ce5);if(_0x2d07d8){const _0xa5b536=_0x2d07d8[0x1];let _0x406aff=getBotAttributes(_0xa5b536);_0x462169['push']({'botID':_0xa5b536,'botname':_0x406aff[_0x51d5ac(0x281)],'status':_0x51d5ac(0x141),'live':_0x51d5ac(0x13a)}),_0x22f680++;}}),_0x22f680!=0x0&&(dbConfig[_0x3b1be6(0xe5)](_0x3b1be6(0x203))[_0x3b1be6(0x1f4)](_0x462169)[_0x3b1be6(0x25f)](),config=_0x462169,restoredConfigFile=_0x22f680);}}async function restoreConfigNotify(_0x190676){const _0x419ee2=_0x487f4c;let _0x2dc79f;if(restoredConfigFile==0x1)_0x2dc79f=_0x419ee2(0x249);else _0x2dc79f='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x190676)io['to'](_0x419ee2(0x265))[_0x419ee2(0x23d)]('notification',_0x2dc79f);else{logger[_0x419ee2(0x245)](_0x419ee2(0x27c)),logger[_0x419ee2(0x245)](_0x2dc79f),logger['simple'](_0x419ee2(0x27c)),logger[_0x419ee2(0x245)]('');if(tgBot&&settings[_0x419ee2(0x1d9)]&&settings[_0x419ee2(0x1a6)]!='orders')tgBot['sendMessage'](settings['telegramChatId'],_0x419ee2(0x172)+_0x2dc79f)[_0x419ee2(0x1fb)](_0x1195d3=>{telegramError(_0x1195d3);});}}function validateCredentials(_0x217b69,_0x4920cd){const _0x62aec9=_0x487f4c;if(_0x217b69[_0x62aec9(0x14b)]==settings[_0x62aec9(0x21c)]&&bcrypt[_0x62aec9(0x1f3)](_0x217b69['password'],settings[_0x62aec9(0x28e)])){if(settings[_0x62aec9(0xcc)])return{'allow':![],'reason':_0x62aec9(0x1af),'token':null};else{const _0x57779c=generateLoginToken(_0x4920cd);return{'allow':!![],'reason':_0x62aec9(0x24d),'token':_0x57779c};}}else return{'allow':![],'reason':_0x62aec9(0x22b),'token':null};}function refreshToken(_0x3446d9){const _0x2586c2=_0x487f4c,_0xca06e5=generateLoginToken(_0x3446d9);return{'allow':!![],'reason':_0x2586c2(0x24d),'token':_0xca06e5};}function validateAccess(_0x33d990,_0x994d6e,_0x462f91){const _0x3aa27d=_0x487f4c,_0x4799c8=_0x462f91?_0x462f91:devices[_0x994d6e]['ip'];let _0x1d6bc2;const _0x581fa7=_0x2822d2=>{const _0x40c828=_0x19ac;if(settings[_0x40c828(0x22d)]){if(settings[_0x40c828(0xcc)]){if(telegram2FaApproved(_0x994d6e)){const _0xb0e752=generateLoginToken(_0x994d6e);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0xb0e752};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x1d6bc2=validToken(_0x2822d2,_0x994d6e),_0x1d6bc2[_0x40c828(0x1a0)](_0x40c828(0x270))?{'allow':!![],'reason':_0x40c828(0x19b),'token':_0x2822d2}:{'allow':![],'reason':_0x40c828(0x218),'token':null};}else return{'allow':!![],'reason':_0x40c828(0xd2),'token':null};};if(settings[_0x3aa27d(0x272)]){let _0x4d5d36=[...settings[_0x3aa27d(0x18a)],_0x3aa27d(0x20a),_0x3aa27d(0x288),_0x3aa27d(0x276)];if(_0x4d5d36[_0x3aa27d(0x241)](_0x4799c8))return _0x581fa7(_0x33d990);else{_0x1d6bc2=validToken(_0x33d990,_0x994d6e);if(_0x1d6bc2['hasOwnProperty']('success'))return _0x581fa7(_0x33d990);else{if(telegramIpApproved(_0x994d6e)){const _0x1a57f0=generateToken(_0x994d6e);return _0x1d6bc2=_0x581fa7(_0x33d990),_0x1d6bc2['allow']?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x1a57f0}:_0x1d6bc2;}else return settings[_0x3aa27d(0xfd)]?{'allow':![],'reason':_0x3aa27d(0x220),'token':null}:{'allow':![],'reason':_0x3aa27d(0x1dc),'token':null};}}}else return _0x581fa7(_0x33d990);}function timelyDecrypt(_0x27b528,_0x3e639d=!![]){const _0x5c6ba7=_0x487f4c;if(_0x27b528)try{const _0x57feea=crypt[_0x5c6ba7(0x1f7)](secure['privateKey'],_0x27b528)[_0x5c6ba7(0x108)],_0x3705ee=_0x57feea[_0x5c6ba7(0x229)]('@')[0x0],_0x1db8c6=_0x57feea[_0x5c6ba7(0x229)]('@')[0x1],_0x2cc879=new Date()[_0x5c6ba7(0xd8)]();if(_0x3e639d){if(_0x2cc879-_0x1db8c6<maxSecretAge*0x3e8)return _0x3705ee;else return![];}else return _0x3705ee;}catch(_0x3e01ec){return![];}else return![];}const validToken=(_0xb2901a,_0x282468)=>{const _0x5050af=_0x487f4c,_0x4e1429=devices[_0x282468]['ip'];if(!_0xb2901a)return{'error':'No\x20authentication\x20token'};for(let _0x5315e8 of blacklist){if(_0x5315e8['token']==_0xb2901a)return{'error':_0x5050af(0x130)};}let _0x4b1a17;try{_0x4b1a17=jwt[_0x5050af(0x257)](_0xb2901a,secure['secret']+_0x282468);}catch{return{'error':_0x5050af(0x10f)};}if(!_0x4b1a17[_0x5050af(0x1a0)]('clientip')&&!_0x4b1a17['hasOwnProperty'](_0x5050af(0x14b))||!_0x4b1a17[_0x5050af(0x1a0)](_0x5050af(0x1b7)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x4b1a17[_0x5050af(0x1a0)](_0x5050af(0x14b))&&_0x4b1a17[_0x5050af(0x1a0)](_0x5050af(0xd1))){const {clientip:_0x21be78}=_0x4b1a17;return _0x4e1429==_0x21be78?{'success':_0x5050af(0xde)}:{'error':_0x5050af(0x1d8)};}else{if(_0x4b1a17[_0x5050af(0x1a0)]('username')&&_0x4b1a17[_0x5050af(0x1a0)]('clientip')){const {username:_0x6971f3,clientip:_0x5817a0}=_0x4b1a17;return settings[_0x5050af(0x21c)]==_0x6971f3&&_0x4e1429==_0x5817a0?{'success':_0x5050af(0xde)}:{'error':_0x5050af(0x238)};}}},generateLoginToken=_0x535607=>{const _0x269891=_0x487f4c;if(_0x535607){const _0x3dd299=devices[_0x535607]['ip'];return jwt[_0x269891(0x15d)]({'username':settings['bbUsername'],'clientip':_0x3dd299},secure[_0x269891(0x168)]+_0x535607,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x59c574=>{const _0x24d3c1=_0x487f4c;if(_0x59c574){const _0x489e73=devices[_0x59c574]['ip'];return jwt[_0x24d3c1(0x15d)]({'clientip':_0x489e73},secure[_0x24d3c1(0x168)]+_0x59c574,{'expiresIn':devices[_0x59c574][_0x24d3c1(0x192)][_0x24d3c1(0x21b)]*0x3c});}else return![];},telegramIpApproved=_0x40f587=>{const _0x5e73d2=_0x487f4c;let _0x5ce773=![];return devices[_0x40f587][_0x5e73d2(0x192)]&&devices[_0x40f587][_0x5e73d2(0x192)][_0x5e73d2(0x21b)]!=_0x5e73d2(0x213)&&(_0x5ce773=devices[_0x40f587]['telegramIpApproval'][_0x5e73d2(0xd1)]==devices[_0x40f587]['ip']&&new Date()['getTime']()-devices[_0x40f587]['telegramIpApproval'][_0x5e73d2(0x16b)]<devices[_0x40f587][_0x5e73d2(0x192)][_0x5e73d2(0x21b)]*0x3c*0x3e8),_0x5ce773;},telegram2FaApproved=_0x9a012e=>{const _0x20265f=_0x487f4c;let _0x4eb53c=![];return devices[_0x9a012e][_0x20265f(0x20b)]&&devices[_0x9a012e][_0x20265f(0x20b)][_0x20265f(0x21b)]!=_0x20265f(0x213)&&(_0x4eb53c=devices[_0x9a012e][_0x20265f(0x20b)]['clientip']==devices[_0x9a012e]['ip']&&new Date()[_0x20265f(0xd8)]()-devices[_0x9a012e][_0x20265f(0x20b)][_0x20265f(0x16b)]<devices[_0x9a012e][_0x20265f(0x20b)][_0x20265f(0x21b)]*0x3c*0x3e8),_0x4eb53c;},normalizeIP=_0x5027be=>{const _0x56e41c=_0x487f4c;let _0x5b4c9c=null,_0x4cd7d6=null;if(ipaddr[_0x56e41c(0x26b)](_0x5027be)){const _0x1da752=ipaddr[_0x56e41c(0x26d)](_0x5027be);_0x1da752[_0x56e41c(0x17b)]()===_0x56e41c(0x23f)?(_0x1da752['isIPv4MappedAddress']()&&(_0x5b4c9c=_0x1da752[_0x56e41c(0x133)]()[_0x56e41c(0x1c9)]()),_0x4cd7d6=_0x1da752[_0x56e41c(0x1c9)]()):(_0x5b4c9c=_0x1da752['toString'](),_0x4cd7d6=_0x1da752[_0x56e41c(0x170)]()[_0x56e41c(0x1c9)]());}return{'show':_0x5b4c9c?_0x5b4c9c:_0x4cd7d6,'store':_0x4cd7d6};};function formatDate(_0x1ed886){const _0x5c6b04=_0x487f4c;return _0x1ed886[_0x5c6b04(0x17a)]()+'/'+(_0x1ed886[_0x5c6b04(0x22c)]()+0x1)[_0x5c6b04(0x1c9)]()[_0x5c6b04(0x11f)](0x2,'0')+'/'+_0x1ed886['getDate']()['toString']()[_0x5c6b04(0x11f)](0x2,'0')+'\x20'+_0x1ed886['getHours']()[_0x5c6b04(0x1c9)]()[_0x5c6b04(0x11f)](0x2,'0')+':'+_0x1ed886[_0x5c6b04(0xe9)]()[_0x5c6b04(0x1c9)]()['padStart'](0x2,'0')+':'+_0x1ed886[_0x5c6b04(0x1f2)]()[_0x5c6b04(0x1c9)]()[_0x5c6b04(0x11f)](0x2,'0');}function sleep(_0xd54fa4){return new Promise(_0x299a29=>setTimeout(_0x299a29,_0xd54fa4));}