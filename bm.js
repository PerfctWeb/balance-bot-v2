const _0x3715e9=_0x54f1;(function(_0x2ce062,_0x1a92e7){const _0x59748f=_0x54f1,_0x1d6e35=_0x2ce062();while(!![]){try{const _0x2f4f0d=parseInt(_0x59748f(0xbb))/0x1*(-parseInt(_0x59748f(0x206))/0x2)+parseInt(_0x59748f(0x11e))/0x3+-parseInt(_0x59748f(0x169))/0x4*(parseInt(_0x59748f(0x202))/0x5)+parseInt(_0x59748f(0x116))/0x6*(-parseInt(_0x59748f(0x104))/0x7)+-parseInt(_0x59748f(0xaa))/0x8*(-parseInt(_0x59748f(0x227))/0x9)+parseInt(_0x59748f(0xd7))/0xa*(parseInt(_0x59748f(0x89))/0xb)+parseInt(_0x59748f(0x180))/0xc;if(_0x2f4f0d===_0x1a92e7)break;else _0x1d6e35['push'](_0x1d6e35['shift']());}catch(_0x33f035){_0x1d6e35['push'](_0x1d6e35['shift']());}}}(_0x4f3b,0x389da));const _0xce2a91=function(){let _0x40e45f=!![];return function(_0x4d526d,_0x2f0e25){const _0x521252=_0x40e45f?function(){const _0x242ba3=_0x54f1;if(_0x2f0e25){const _0x5f2e68=_0x2f0e25[_0x242ba3(0xa3)](_0x4d526d,arguments);return _0x2f0e25=null,_0x5f2e68;}}:function(){};return _0x40e45f=![],_0x521252;};}(),_0x551e9c=_0xce2a91(this,function(){const _0x4a7f0e=_0x54f1;return _0x551e9c[_0x4a7f0e(0x1cd)]()[_0x4a7f0e(0x112)](_0x4a7f0e(0x145))[_0x4a7f0e(0x1cd)]()['constructor'](_0x551e9c)[_0x4a7f0e(0x112)]('(((.+)+)+)+$');});_0x551e9c();'use strict';process[_0x3715e9(0x176)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x3715e9(0x138)),fs=require('fs'),fns=require(_0x3715e9(0xcc)),low=require(_0x3715e9(0x91)),FileSync=require(_0x3715e9(0x14d)),path=require(_0x3715e9(0x1b5)),crypto=require(_0x3715e9(0x130)),Crypt=require('hybrid-crypto-js')[_0x3715e9(0xe7)],RSA=require(_0x3715e9(0x102))[_0x3715e9(0x12f)],bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),ipaddr=require(_0x3715e9(0x1ff)),argv=require(_0x3715e9(0x160))(process[_0x3715e9(0xc4)][_0x3715e9(0x15c)](0x2))[_0x3715e9(0xc4)],uuidRandom=require(_0x3715e9(0x1fe)),TelegramBot=require(_0x3715e9(0x1d8)),Mixpanel=require(_0x3715e9(0x120)),axios=require(_0x3715e9(0x220)),{GraphQLClient,gql}=require('graphql-request'),util=require('util'),fileUpload=require(_0x3715e9(0x159)),PORT=argv['port']||_0x3715e9(0x8c),pattern=/^[0-9]{2,4}$/;function _0x4f3b(){const _0x242c96=['output-001.log','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','socket.io','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','getStartingBalances','polling_error','isDirectory','alerts','9713bArjGM','Unauthorized\x20attempt\x20to\x20confirm\x20message','join','find','access','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','fork','generateKeyPairAsync','argv','Notifications\x20enabled\x0a','manual','verify','delete-bot','getHours','randomFillSync','includes','date-fns','then','bb-config.json','store-configuration','/upload-backup','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','/status\x20-\x20show\x20bot(s)\x20status\x0a','write','2FA\x20login\x20required','$1_$2_$3','timestamp','47300EgcGFc','login\x20token\x20generated','reject','headless','catch','temporary\x20access\x20timeout','new','args','Unauthorized\x20attempt\x20to\x20log\x20out','Unauthorized\x20attempt\x20to\x20delete\x20alerts','stopped','split','function','botID','2FA','clients','Crypt','Invalid\x20Telegram\x20token','telegramUsername','config/','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','callback_query','copyFileSync','forEach','logs/','************','loginRequired','deleted\x20Bot\x20','blacklist','username','success','\x20>\x20','pidExpireLogin','toIPv4Address','telegramEnabled','Error:\x20Invalid\x20argument\x20','expiry','stop','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','replace','/off\x20-\x20stop\x20bot(s)\x0a','Server','number','hybrid-crypto-js','User\x20has\x20been\x20validated','14399FQBBhF','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','defaults','conn','uuid','botmanager','once','output-002.log','secure','filter','mode','bbvReceive','127.0.0.1','disabled','search',':\x20Bot\x20Mgr\x20>\x20','auth','zip/','846jcBihU','Unauthorized\x20login\x20attempt\x20(timeout)','exp','storeConfiguration','lastmsgtelegram','api-eu.mixpanel.com','Unauthorized\x20attempt\x20to\x20download\x20','from','344835YFfkvf','-performance.json','mixpanel','params','invalid\x20credentials','randomBytes','***','messages','Unauthorized\x20attempt\x20to\x20get\x20logs','timeshift','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','token','createServer','Unauthorized\x20attempt\x20to\x20get\x20messages','emit','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','bot.js','RSA','crypto','max','showname','pidRefreshToken','Restore\x20process\x20aborted','bb-settings.json','inherit','getFullYear','child_process','uncaughtException','exec','Orders','No\x20bots\x20running\x20right\x20now','user','file','updatebotmanager','starting\x20new\x20bot\x20|\x20Bot\x20','update-bb','enabled\x20Bot\x20','All\x20bots','parse','(((.+)+)+)+$','map','-events.json','2FA\x20required','getDate',',\x20must\x20be\x20a\x204\x20digit\x20number','reason','_data','lowdb/adapters/FileSync','getSeconds','message','publicKey','DEFLATE','apiKey','sign','get-messages','host','latestversion','-----------------------------------------------------------------------------------','File\x20uploaded','express-fileupload','backupfile','lastmsgemitted','slice','sendPortfolioTelegram','clientip','kill','yargs/yargs','mkdirSync','restart','temporary\x20token\x20generated','login\x20not\x20required','rmSync','2FA\x20login\x20rejected','store-headless','confirm-message','401228FOZaWL','restarting\x20Bot\x20','existsSync','Restoring\x20bot(s)\x20from\x20backup','storeHeadless','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','chat','cancelLoading','decrypt','compareSync','encryptedUuid','reset-password','env','telegrammsg','length','getUTCHours','removeAllListeners','6b67f3d61ee94b8f5c80b4affef4c4d9','-config.json','connection','Login\x20accepted','/:bot/support','1345416SFapZC','express','enabled','All','0.0.0','removeListener','disconnect','files','answerCallbackQuery','bbUsername','login\x20token\x20valid','all','\x20(2)','/:bot/performance','remove','keys','temporary\x20access\x20rejected','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','emitHistory','Password\x20reset\x20rejected','server','-results.json','live','f2aRequired','backup/','/update\x20-\x20update\x20Balance\x20Bot\x0a','headers',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','sendMessage','toIPv4MappedAddress','assign','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','full','download','error\x20while\x20deleting\x20config\x20files:\x20','listen','password','Unauthorized\x20attempt\x20to\x20get\x20portfolio','settings','/restart\x20-\x20restart\x20bot(s)\x0a','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','socket','node-zip','yes','idling\x20bot\x20\x20\x20|\x20Bot\x20','2FA\x20login\x20token\x20generated','getPortfolio','push','Allow\x20login\x20from\x20IP\x20address\x20<b>','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','title','RSA-OAEP','deleteHistoryAlerts','path','telegramChatId','started','Temporary\x20access\x20rejected','http','15\x20min','privateKey','output-003.log','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','tkn','format','stringify','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','log','createWriteStream','version.json','telegram','event','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Access\x20enabled\x20for\x20','You\x20can\x20use\x20the\x20following\x20commands:\x0a','track','botname','toString','post','stopPolling','allow','Markdown','logged\x20out','use','logs','Unauthorized\x20attempt\x20to\x20store\x20configuration','bot','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','node-telegram-bot-api','getMinutes','startsWith','Bot\x20Mgr\x20>\x20','\x20(1)','logout','SIGTERM','exit','ipv6','binary','::ffff:127.0.0.1','telegram2FaApproval','Alerts','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','request','\x20to\x20','telegramIpApproval','readdirSync','/on\x20-\x20start\x20bot(s)\x0a','placeOrder','referer','temp/','simple','<b>Balance\x20Bot\x20Status:</b>\x0a','All\x20bots\x20running\x20right\x20now','set','store-settings','writeFileSync','generate','1000','bb-secure.json','readFileSync','sort','get-starting-balances','bb/','order','toggleBotMode','telegramEvents','uuid-random','ipaddr.js','unlinkSync','secret','5GUfhjU','index.html','/names\x20-\x20show\x20bot\x20names\x0a','sockets','4WJQCfi','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','notification','value','running','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','HTML','bbvNew','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','/download/:type','Ok,\x20will\x20send\x20alert\x20notifications\x20only','/help\x20-\x20show\x20available\x20commands\x0a','SIGINT','isValid','name','Bot\x20','\x20mode','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','build2','Failed\x20to\x20download\x20','test','bots','login\x20required','Unauthorized\x20attempt\x20to\x20delete\x20bot','warning','ipc','axios','reload','sendFile','userid','login','init','.zip','261RuYDmJ','bot-','hasOwnProperty','temporaryAccessAllowed','remoteAddress','backup','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','statSync','delete-alerts','hashSync','sortBy','\x20|\x20','store','cancel-loading','new-disabled','Invalid\x20username\x20or\x20IP\x20address','Ok,\x20will\x20send\x20order\x20notifications\x20only','77RnKuLo','auto','</b>\x20?','3000','getMonth','add','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','static','lowdb','bbPassword','<b>Telegram\x20Bot\x20Status:</b>\x0a','build','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','send','data','access\x20timeout','get','cloneDeep','\x20only\x0a','temporary\x20access\x20not\x20allowed','connected','size','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','kind','padStart','status','apply','add-bot','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','accept','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','initclient','onText','105240HPtYOZ','orders','apiSecret','show','getTime','/:bot/history','telegramToken','type','::1'];_0x4f3b=function(){return _0x242c96;};return _0x4f3b();}!pattern[_0x3715e9(0x21a)](PORT)&&(console[_0x3715e9(0x1c2)](_0x3715e9(0xfa)+PORT+_0x3715e9(0x14a)),process[_0x3715e9(0x1df)](0x1));const HOST=argv[_0x3715e9(0x155)]||null,userID=argv[_0x3715e9(0x13d)]||'';let bbpath=_0x3715e9(0x1fa),bbpath2='';const botfile=_0x3715e9(0x12e),configfile=_0x3715e9(0xce),settingsfile=_0x3715e9(0x135),securefile=_0x3715e9(0x1f6);let validInstallation=!![];!fs[_0x3715e9(0x16b)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3715e9(0xe6)),configpath=userID?bbpath+_0x3715e9(0xea)+userID+'/':bbpath+_0x3715e9(0xea),configbackuppath=configpath+_0x3715e9(0x198),logspath=userID?bbpath+_0x3715e9(0xef)+userID+'/':bbpath+_0x3715e9(0xef),zippath=userID?bbpath+_0x3715e9(0x115)+userID+'/':bbpath+_0x3715e9(0x115),loggerfile=fs[_0x3715e9(0x1c3)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x3715e9(0x1ed);!fs[_0x3715e9(0x16b)](configpath)&&fs[_0x3715e9(0x161)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x3715e9(0x161)](configbackuppath);!fs[_0x3715e9(0x16b)](logspath)&&fs[_0x3715e9(0x161)](logspath);!fs[_0x3715e9(0x16b)](zippath)&&fs[_0x3715e9(0x161)](zippath);!fs[_0x3715e9(0x16b)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x3715e9(0xd3)]();function _0x54f1(_0x1b9493,_0x58a766){const _0x4ec5a8=_0x4f3b();return _0x54f1=function(_0x551e9c,_0xce2a91){_0x551e9c=_0x551e9c-0x85;let _0x4f3bf7=_0x4ec5a8[_0x551e9c];return _0x4f3bf7;},_0x54f1(_0x1b9493,_0x58a766);}const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3715e9(0x106)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x3715e9(0x184)}})[_0x3715e9(0xd3)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x3715e9(0x106)]({'secure':{},'blacklist':[]})[_0x3715e9(0xd3)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x3715e9(0x1b3)});const saltRounds=0xa,mixpanel=Mixpanel[_0x3715e9(0x225)](_0x3715e9(0x17b),{'host':_0x3715e9(0x11b)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x3715e9(0xb0)]&&settings['telegramToken']!=''&&settings['telegramUsername']&&settings[_0x3715e9(0xe9)]!='')initTelegram();const logger={'screen':_0x3f10cd=>{const _0x431dce=_0x3715e9;console[_0x431dce(0x1c2)](_0x3f10cd);},'simple':_0x59632c=>{const _0x2f2056=_0x3715e9;console[_0x2f2056(0x1c2)](_0x59632c),loggerfile['write'](util[_0x2f2056(0x1bf)](_0x59632c)+'\x0a');},'full':async _0x2e9f06=>{const _0x46f11d=_0x3715e9,_0x2b523c=getTimeStamp()+_0x46f11d(0x113)+_0x2e9f06;console[_0x46f11d(0x1c2)](_0x2b523c),loggerfile['write'](util['format'](_0x2b523c)+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x46f11d(0x1fd)]!=_0x46f11d(0xab))await tgBot[_0x46f11d(0x19c)](settings[_0x46f11d(0x1b6)],'Bot\x20Mgr\x20>\x20'+_0x2e9f06)[_0x46f11d(0xdb)](_0x2d19fe=>{telegramError(_0x2d19fe);});}};process['on'](_0x3715e9(0x139),function(_0x2a4cb1){const _0x1aae6e=_0x3715e9;logger[_0x1aae6e(0x1ee)](_0x2a4cb1);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x3715e9(0x1c4))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x3715e9(0x181)),app=express(),http=require(_0x3715e9(0x1b9))[_0x3715e9(0x12a)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x3715e9(0x99)](_0x3715e9(0x20f),async(_0x3c999b,_0x3fd853)=>{const _0x3e3cd8=_0x3715e9,_0x685c80=_0x3c999b[_0x3e3cd8(0x121)][_0x3e3cd8(0xb1)],_0x4003ff=getClientsWithBotID('botmanager'),_0x40a733=_0x3c999b[_0x3e3cd8(0x19a)][_0x3e3cd8(0x108)],_0x5139d3=timelyDecrypt(_0x40a733,![]),_0xf19d41=_0x4003ff['find'](_0x6a388c=>_0x6a388c[_0x3e3cd8(0x108)]==_0x5139d3);if(_0xf19d41){const _0x34d03d=normalizeIP(_0x3c999b[_0x3e3cd8(0x1a9)]['remoteAddress'])[_0x3e3cd8(0x234)],_0xd0ff70=_0x3c999b[_0x3e3cd8(0x19a)][_0x3e3cd8(0x1be)];if(validateAccess(_0xd0ff70,_0x5139d3,_0x34d03d)[_0x3e3cd8(0x1d0)])await zipFiles(_0x685c80),_0x3fd853[_0x3e3cd8(0x1a1)](zippath+(_0x685c80+_0x3e3cd8(0x226)),_0x17447d=>{const _0x409d13=_0x3e3cd8;_0x17447d&&(logger[_0x409d13(0x1a0)](_0x409d13(0x219)+_0x685c80),logger[_0x409d13(0x1ee)](_0x17447d));});else logger[_0x3e3cd8(0x1a0)](_0x3e3cd8(0x11c)+_0x685c80+_0x3e3cd8(0x1dc));}else logger[_0x3e3cd8(0x1a0)](_0x3e3cd8(0x11c)+_0x685c80+_0x3e3cd8(0x18c));}),app[_0x3715e9(0x1ce)](_0x3715e9(0xd0),async(_0x41ab9e,_0x15d17a)=>{const _0x4640de=_0x3715e9,_0x77aec1=getClientsWithBotID(_0x4640de(0x109)),_0x23e629=_0x41ab9e['headers']['uuid'],_0x5e2071=timelyDecrypt(_0x23e629,![]),_0x2aac1a=_0x77aec1[_0x4640de(0xbe)](_0xb1711f=>_0xb1711f['uuid']==_0x5e2071);if(_0x2aac1a){const _0x4756ae=normalizeIP(_0x41ab9e[_0x4640de(0x1a9)][_0x4640de(0x22b)])[_0x4640de(0x234)],_0x246bab=_0x41ab9e[_0x4640de(0x19a)][_0x4640de(0x1be)];if(validateAccess(_0x246bab,_0x5e2071,_0x4756ae)['allow']){if(_0x41ab9e[_0x4640de(0x187)]){const _0x5e8027=_0x41ab9e[_0x4640de(0x187)][_0x4640de(0x15a)];await _0x5e8027['mv'](temppath+_0x5e8027[_0x4640de(0x214)]),_0x15d17a[_0x4640de(0x96)]({'status':!![],'message':_0x4640de(0x158)}),confirmRestore(temppath,_0x5e8027[_0x4640de(0x214)]);}}else logger[_0x4640de(0x1a0)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x4640de(0x1a0)](_0x4640de(0xb4));}),app['use'](express[_0x3715e9(0x90)](path[_0x3715e9(0xbd)](__dirname,bbpath2,_0x3715e9(0x218)))),app[_0x3715e9(0x1d3)](express['static'](path[_0x3715e9(0xbd)](__dirname,bbpath2,'build'))),app[_0x3715e9(0x99)]('/',function(_0x10c70e,_0x48d0f5){const _0xd94ade=_0x3715e9;_0x48d0f5['sendFile'](path['join'](__dirname,bbpath2,_0xd94ade(0x218),'index.html'));}),app[_0x3715e9(0x99)]('/:bot',function(_0x5ed92c,_0x7843d9){const _0x2690f2=_0x3715e9;_0x7843d9[_0x2690f2(0x222)](path['join'](__dirname,bbpath2,_0x2690f2(0x94),_0x2690f2(0x203)));}),app[_0x3715e9(0x99)]('/:bot/portfolio',(_0x3072aa,_0x4c146a)=>{const _0x1c5be8=_0x3715e9;_0x4c146a['sendFile'](path[_0x1c5be8(0xbd)](__dirname,bbpath2,_0x1c5be8(0x94),_0x1c5be8(0x203)));}),app[_0x3715e9(0x99)](_0x3715e9(0x18d),(_0x36c2d9,_0x127543)=>{const _0x4e8e55=_0x3715e9;_0x127543['sendFile'](path[_0x4e8e55(0xbd)](__dirname,bbpath2,_0x4e8e55(0x94),'index.html'));}),app[_0x3715e9(0x99)]('/:bot/coins',(_0x48865f,_0x45e78e)=>{const _0x53c4c4=_0x3715e9;_0x45e78e[_0x53c4c4(0x222)](path[_0x53c4c4(0xbd)](__dirname,bbpath2,_0x53c4c4(0x94),'index.html'));}),app[_0x3715e9(0x99)](_0x3715e9(0xaf),(_0x4ad537,_0x2992a6)=>{const _0x527948=_0x3715e9;_0x2992a6[_0x527948(0x222)](path['join'](__dirname,bbpath2,'build',_0x527948(0x203)));}),app[_0x3715e9(0x99)]('/:bot/configuration',(_0xed556f,_0x5279c7)=>{const _0x1ddf58=_0x3715e9;_0x5279c7['sendFile'](path[_0x1ddf58(0xbd)](__dirname,bbpath2,_0x1ddf58(0x94),_0x1ddf58(0x203)));}),app['get'](_0x3715e9(0x17f),(_0x594b6d,_0x1ef8a0)=>{const _0x163034=_0x3715e9;_0x1ef8a0['sendFile'](path[_0x163034(0xbd)](__dirname,bbpath2,'build',_0x163034(0x203)));});if(HOST)http[_0x3715e9(0x1a3)](PORT,HOST);else http['listen'](PORT);const io=require(_0x3715e9(0xb5))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x1f17a1=_0x3715e9;logger[_0x1f17a1(0x1ee)](''),logger[_0x1f17a1(0x1ee)](_0x1f17a1(0x157)),await logger[_0x1f17a1(0x1a0)]('Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:'+PORT),logger[_0x1f17a1(0x1ee)](_0x1f17a1(0x157));if(config['length']!=0x0)for(const _0x2a48ed of config){if(_0x2a48ed[_0x1f17a1(0xa2)]==_0x1f17a1(0x182)||_0x2a48ed[_0x1f17a1(0xa2)]==_0x1f17a1(0xdd))await logger[_0x1f17a1(0x1a0)]('starting\x20bot\x20|\x20Bot\x20'+_0x2a48ed[_0x1f17a1(0xe4)]+'\x20|\x20'+_0x2a48ed[_0x1f17a1(0x1cc)]),startBot([_0x2a48ed[_0x1f17a1(0xe4)],userID],{'cwd':bbpath},function(_0x57d358){const _0x187bba=_0x1f17a1;if(_0x57d358)logger[_0x187bba(0x1a0)](_0x57d358);});else(_0x2a48ed['status']==_0x1f17a1(0x111)||_0x2a48ed[_0x1f17a1(0xa2)]==_0x1f17a1(0x86))&&await logger['full'](_0x1f17a1(0x1ac)+_0x2a48ed[_0x1f17a1(0xe4)]+_0x1f17a1(0x233)+_0x2a48ed['botname']);}else!newBot&&logger[_0x1f17a1(0x1ee)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x1f17a1(0x1ee)](_0x1f17a1(0x157)),logger['simple']('');}function startSocket(){const _0x2c4be5=_0x3715e9;io['on'](_0x2c4be5(0x17d),_0x1ec623=>{const _0x1cfe50=_0x2c4be5;let _0x4493ae,_0x58b5f0,_0x51d6c5,_0x25fce8,_0x371920;const _0x4d8c4b=_0x1ec623['handshake'][_0x1cfe50(0x19a)][_0x1cfe50(0x1ec)];_0x58b5f0=_0x4d8c4b['match'](/bot[0-9]{3}/);if(_0x58b5f0)_0x51d6c5=_0x58b5f0[0x0]['match'](/[0-9]{3}/);if(_0x51d6c5)_0x4493ae=_0x51d6c5[0x0];else _0x4493ae='botmanager';const _0x3a4dcd=_0x1ec623['handshake'][_0x1cfe50(0x114)][_0x1cfe50(0x174)];if(!_0x3a4dcd)_0x1ec623['emit'](_0x1cfe50(0xa2),{'publicKey':secure[_0x1cfe50(0x150)]});else{_0x25fce8=timelyDecrypt(_0x3a4dcd,![]);if(!_0x25fce8)_0x1ec623[_0x1cfe50(0x12c)](_0x1cfe50(0xa2),{'publicKey':secure[_0x1cfe50(0x150)]});else{_0x371920=normalizeIP(_0x1ec623[_0x1cfe50(0x107)][_0x1cfe50(0x22b)])['store'];if(!devices[_0x25fce8])devices[_0x25fce8]={'uuid':_0x25fce8,'access':{'token':null}};devices[_0x25fce8]['ip']=_0x371920;const _0x2b7de5=addClient(_0x1ec623['id'],_0x25fce8,_0x4493ae);setAccess(_0x2b7de5),emitMessages(),_0x1ec623['on'](_0x1cfe50(0x224),_0xaa69ce=>{const _0x211955=_0x1cfe50,_0x522aa6=timelyDecrypt(_0xaa69ce[_0x211955(0x1a4)]);if(_0x522aa6){_0xaa69ce={'username':_0xaa69ce[_0x211955(0xf4)],'password':_0x522aa6},devices[_0x25fce8][_0x211955(0xbf)]=validateCredentials(_0xaa69ce,_0x25fce8);if(devices[_0x25fce8][_0x211955(0xbf)][_0x211955(0x1d0)]==![]&&devices[_0x25fce8][_0x211955(0xbf)][_0x211955(0x14b)]=='2FA\x20login\x20required')_0x1ec623[_0x211955(0x12c)](_0x211955(0xa2),{'access':devices[_0x25fce8][_0x211955(0xbf)]}),loginAccess2FA(_0x25fce8,_0x371920);else{if(devices[_0x25fce8][_0x211955(0xbf)]['allow']==![]&&devices[_0x25fce8][_0x211955(0xbf)][_0x211955(0x14b)]==_0x211955(0x122))_0x1ec623[_0x211955(0x12c)](_0x211955(0xa2),{'access':devices[_0x25fce8][_0x211955(0xbf)]});else devices[_0x25fce8][_0x211955(0xbf)][_0x211955(0x1d0)]&&devices[_0x25fce8]['access']['reason']==_0x211955(0xd8)&&(getClientsWithUuid(_0x25fce8)[_0x211955(0xee)](_0x6e7502=>{setAccess(_0x6e7502);}),setTokenRefresh(_0x25fce8),setSessionTimeout(_0x211955(0x224),_0x25fce8));}}else logger[_0x211955(0x1a0)](_0x211955(0x117));}),_0x1ec623['on'](_0x1cfe50(0x175),()=>{resetPassword();}),_0x1ec623['on']('disconnect',_0x3568f7=>{removeClient(_0x1ec623['id']);}),_0x4493ae==_0x1cfe50(0x109)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4f43a6){const _0x3aa452=_0x3715e9;if(_0x4f43a6!=_0x3aa452(0x109)&&config[_0x3aa452(0x152)]!=''){if(pid[_0x4f43a6])pid[_0x4f43a6][_0x3aa452(0x96)]({'function':_0x3aa452(0xa8),'args':null});}}function reloadBotManager(){const _0x59a25a=_0x3715e9;getClientsWithBotID('botmanager')[_0x59a25a(0xee)](_0x5d5ad0=>{const _0x3e4cc0=_0x59a25a;getSocket(_0x5d5ad0['id'])[_0x3e4cc0(0x12c)](_0x3e4cc0(0xa2),{'access':{'allow':![],'reason':_0x3e4cc0(0x221),'token':null}});});}function getSocket(_0x351640){const _0xabf363=_0x3715e9;return io['sockets'][_0xabf363(0x205)][_0xabf363(0x99)](_0x351640);}function setAccess(_0x211846){const _0x4c4013=_0x3715e9,_0x33135f=getSocket(_0x211846['id']),_0xab860c=_0x211846['uuid'],_0x55b70c=_0x211846[_0x4c4013(0x1d6)];devices[_0xab860c][_0x4c4013(0xbf)]=validateAccess(devices[_0xab860c][_0x4c4013(0xbf)][_0x4c4013(0x129)],_0xab860c),_0x33135f[_0x4c4013(0xbd)](_0xab860c);if(devices[_0xab860c]['access']['allow']){_0x33135f[_0x4c4013(0xbd)](_0x55b70c);if(_0x55b70c==_0x4c4013(0x109))initializeSocketBotManager(_0x33135f);else initializeSocketBot(_0x33135f);initClient(_0x55b70c);}devices[_0xab860c][_0x4c4013(0xbf)]['token']&&devices[_0xab860c][_0x4c4013(0xbf)]['reason']==_0x4c4013(0x163)&&setSessionTimeout(_0x4c4013(0xe5),_0xab860c),devices[_0xab860c]['access']['token']&&devices[_0xab860c][_0x4c4013(0xbf)][_0x4c4013(0x14b)]==_0x4c4013(0x1ad)&&setSessionTimeout('login',_0xab860c),_0x33135f[_0x4c4013(0x12c)](_0x4c4013(0xa2),{'status':_0x211846[_0x4c4013(0x194)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0xab860c][_0x4c4013(0xbf)],'externalip':devices[_0xab860c]['ip'],'publicKey':secure[_0x4c4013(0x150)],'userid':settings[_0x4c4013(0x223)],'validInstallation':validInstallation}),devices[_0xab860c][_0x4c4013(0xbf)][_0x4c4013(0x1d0)]==![]&&devices[_0xab860c][_0x4c4013(0xbf)][_0x4c4013(0x14b)]==_0x4c4013(0x148)&&temporaryAccess2FA(_0xab860c,devices[_0xab860c]['ip']);}function setSessionTimeout(_0x5f31d7,_0x18a60f){const _0x25e5b5=_0x3715e9;let _0x34ab38;if(_0x5f31d7==_0x25e5b5(0x224))_0x34ab38=loginExpiry*0x3c*0x3e8;else _0x34ab38=devices[_0x18a60f][_0x25e5b5(0x1e8)]['expiry']*0x3c*0x3e8-(new Date()[_0x25e5b5(0xae)]()-devices[_0x18a60f][_0x25e5b5(0x1e8)][_0x25e5b5(0xd6)]);if(devices[_0x18a60f][_0x25e5b5(0xf7)])clearTimeout(devices[_0x18a60f][_0x25e5b5(0xf7)]);devices[_0x18a60f][_0x25e5b5(0xf7)]=setTimeout(()=>{const _0x2b4e84=_0x25e5b5;if(devices[_0x18a60f]['pidRefreshToken'])clearTimeout(devices[_0x18a60f][_0x2b4e84(0x133)]);removeSocketListeners(_0x18a60f),addBlacklist(_0x18a60f),devices[_0x18a60f][_0x2b4e84(0x1e8)]=null,devices[_0x18a60f][_0x2b4e84(0x1e3)]=null,devices[_0x18a60f][_0x2b4e84(0xbf)][_0x2b4e84(0x129)]=null,devices[_0x18a60f][_0x2b4e84(0xbf)]=validateAccess(devices[_0x18a60f]['access'][_0x2b4e84(0x129)],_0x18a60f),!(devices[_0x18a60f][_0x2b4e84(0xbf)][_0x2b4e84(0x1d0)]&&devices[_0x18a60f]['access'][_0x2b4e84(0x14b)]==_0x2b4e84(0x164))&&(_0x5f31d7==_0x2b4e84(0x224)?io['to'](_0x18a60f)[_0x2b4e84(0x12c)](_0x2b4e84(0xa2),{'access':{'allow':![],'reason':_0x2b4e84(0x98),'token':null}}):io['to'](_0x18a60f)[_0x2b4e84(0x12c)]('status',{'access':{'allow':![],'reason':_0x2b4e84(0xdc),'token':null}})),devices[_0x18a60f][_0x2b4e84(0xbf)][_0x2b4e84(0x129)]=null;},_0x34ab38);}function setTokenRefresh(_0x14631e){const _0x3f93f0=_0x3715e9;if(devices[_0x14631e]['pidRefreshToken'])clearTimeout(devices[_0x14631e][_0x3f93f0(0x133)]);devices[_0x14631e][_0x3f93f0(0x133)]=setTimeout(()=>{const _0x42950c=_0x3f93f0;getClientsWithUuid(_0x14631e)[_0x42950c(0x178)]!=0x0?(devices[_0x14631e][_0x42950c(0xbf)]=refreshToken(_0x14631e),io['to'](_0x14631e)[_0x42950c(0x12c)]('status',{'status':_0x42950c(0x9d),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x14631e][_0x42950c(0xbf)],'externalip':devices[_0x14631e]['ip'],'publicKey':secure[_0x42950c(0x150)],'validInstallation':validInstallation}),setTokenRefresh(_0x14631e)):clearTimeout(devices[_0x14631e][_0x42950c(0x133)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4104a5){const _0x1487fb=_0x3715e9,_0x1b7ebb=getClient(_0x4104a5['id'])[_0x1487fb(0x108)];_0x4104a5[_0x1487fb(0x12c)](_0x1487fb(0x21b),config),_0x4104a5[_0x1487fb(0x12c)]('settings',cleanSettings()),_0x4104a5['on'](_0x1487fb(0xa4),_0x4d7f85=>{const _0x59228a=_0x1487fb;if(validateAccess(_0x4d7f85,_0x1b7ebb)[_0x59228a(0x1d0)])addBot();else logger[_0x59228a(0x1a0)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x4104a5['on']('update-bot',(_0x1e21d3,_0x3f6918)=>{const _0x2a263d=_0x1487fb;if(validateAccess(_0x3f6918,_0x1b7ebb)[_0x2a263d(0x1d0)])toggleBot(_0x1e21d3[_0x2a263d(0xe4)],_0x1e21d3[_0x2a263d(0xa2)],_0x1e21d3[_0x2a263d(0x196)]);else logger[_0x2a263d(0x1a0)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x4104a5['on']('toggle-bot-mode',(_0x30b9ab,_0x4a7f6e)=>{const _0x39a0d4=_0x1487fb;if(validateAccess(_0x4a7f6e,_0x1b7ebb)[_0x39a0d4(0x1d0)])toggleBotMode(_0x30b9ab);else logger[_0x39a0d4(0x1a0)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x4104a5['on'](_0x1487fb(0xc8),(_0x5b1b5d,_0x1ff087)=>{const _0x51e3b6=_0x1487fb;if(validateAccess(_0x1ff087,_0x1b7ebb)[_0x51e3b6(0x1d0)])deleteBot(_0x5b1b5d);else logger[_0x51e3b6(0x1a0)](_0x51e3b6(0x21d));}),_0x4104a5['on'](_0x1487fb(0x1f2),(_0x184d2e,_0x42c907)=>{const _0x3dfbea=_0x1487fb;if(validateAccess(_0x42c907,_0x1b7ebb)[_0x3dfbea(0x1d0)])storeSettings(_0x184d2e,!![]);else logger[_0x3dfbea(0x1a0)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x4104a5['on'](_0x1487fb(0x141),_0x1d5adb=>{const _0x1a190f=_0x1487fb;if(validateAccess(_0x1d5adb,_0x1b7ebb)[_0x1a190f(0x1d0)])updateBB();else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x4104a5['on'](_0x1487fb(0x154),_0x2ac1a8=>{const _0x1b317b=_0x1487fb;if(validateAccess(_0x2ac1a8,_0x1b7ebb)['allow'])getMessages();else logger['full'](_0x1b317b(0x12b));}),_0x4104a5['on'](_0x1487fb(0x168),(_0x28cd85,_0x5eccd6)=>{const _0x30b7b1=_0x1487fb;if(validateAccess(_0x5eccd6,_0x1b7ebb)[_0x30b7b1(0x1d0)])confirmMessage(_0x28cd85);else logger[_0x30b7b1(0x1a0)](_0x30b7b1(0xbc));}),_0x4104a5['on']('logout',_0x45d42c=>{const _0x211767=_0x1487fb;if(validateAccess(_0x45d42c,_0x1b7ebb)[_0x211767(0x1d0)]){if(devices[_0x1b7ebb][_0x211767(0x133)])clearTimeout(devices[_0x1b7ebb]['pidRefreshToken']);if(devices[_0x1b7ebb][_0x211767(0xf7)])clearTimeout(devices[_0x1b7ebb][_0x211767(0xf7)]);removeSocketListeners(getClient(_0x4104a5['id'])['uuid']),addBlacklist(_0x1b7ebb),devices[_0x1b7ebb][_0x211767(0x1e8)]=null,devices[_0x1b7ebb][_0x211767(0x1e3)]=null,devices[_0x1b7ebb][_0x211767(0xbf)][_0x211767(0x129)]=null,io['to'](getClient(_0x4104a5['id'])[_0x211767(0x108)])[_0x211767(0x12c)](_0x211767(0xa2),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x211767(0xdf));});}function initializeSocketBot(_0x5b1853){const _0x57903e=_0x3715e9,_0x102a2e=getClient(_0x5b1853['id'])[_0x57903e(0x1d6)],_0x93ea25=getClient(_0x5b1853['id'])['uuid'];_0x5b1853['on']('get-logs',(_0x5cecce,_0x1a95bf)=>{const _0x15883b=_0x57903e;if(validateAccess(_0x1a95bf,_0x93ea25)[_0x15883b(0x1d0)]){if(pid[_0x102a2e])pid[_0x102a2e][_0x15883b(0x96)]({'function':_0x15883b(0x192),'args':_0x5cecce});}else logger['full'](_0x15883b(0x126));}),_0x5b1853['on'](_0x57903e(0x230),(_0x29aa21,_0x5b5274)=>{const _0xd05eed=_0x57903e;if(validateAccess(_0x5b5274,_0x93ea25)[_0xd05eed(0x1d0)]){if(pid[_0x102a2e])pid[_0x102a2e]['send']({'function':_0xd05eed(0x1b4),'args':_0x29aa21});}else logger[_0xd05eed(0x1a0)](_0xd05eed(0xe0));}),_0x5b1853['on']('get-portfolio',(_0xd5ca9c,_0x4a668b)=>{const _0x580d6b=_0x57903e;if(validateAccess(_0x4a668b,_0x93ea25)[_0x580d6b(0x1d0)]){if(pid[_0x102a2e])pid[_0x102a2e][_0x580d6b(0x96)]({'function':_0x580d6b(0x1ae),'args':_0xd5ca9c});}else logger[_0x580d6b(0x1a0)](_0x580d6b(0x1a5));}),_0x5b1853['on'](_0x57903e(0xcf),(_0x5dfe0b,_0x7f3fc7)=>{const _0x5435ef=_0x57903e;if(validateAccess(_0x7f3fc7,_0x93ea25)[_0x5435ef(0x1d0)]){if(pid[_0x102a2e])pid[_0x102a2e][_0x5435ef(0x96)]({'function':_0x5435ef(0x119),'args':_0x5dfe0b});}else logger[_0x5435ef(0x1a0)](_0x5435ef(0x1d5));}),_0x5b1853['on'](_0x57903e(0x167),(_0x2c7adf,_0x3d3527)=>{const _0x365799=_0x57903e;if(validateAccess(_0x3d3527,_0x93ea25)[_0x365799(0x1d0)]){if(pid[_0x102a2e])pid[_0x102a2e][_0x365799(0x96)]({'function':_0x365799(0x16d),'args':_0x2c7adf});}else logger[_0x365799(0x1a0)](_0x365799(0xd1));}),_0x5b1853['on'](_0x57903e(0x1f9),_0x3f9833=>{const _0x4f4845=_0x57903e;if(validateAccess(_0x3f9833,_0x93ea25)[_0x4f4845(0x1d0)]){if(pid[_0x102a2e])pid[_0x102a2e][_0x4f4845(0x96)]({'function':_0x4f4845(0xb7),'args':null});}else logger[_0x4f4845(0x1a0)](_0x4f4845(0x1e5));}),_0x5b1853['on']('place-order',(_0x2bbdf7,_0x2fbd30)=>{const _0x4f4ed1=_0x57903e;if(validateAccess(_0x2fbd30,_0x93ea25)[_0x4f4ed1(0x1d0)]){if(pid[_0x102a2e])pid[_0x102a2e][_0x4f4ed1(0x96)]({'function':_0x4f4ed1(0x1eb),'args':_0x2bbdf7});}else logger[_0x4f4ed1(0x1a0)](_0x4f4ed1(0xfd));}),_0x5b1853['on'](_0x57903e(0x85),_0xb5f1f6=>{const _0x164275=_0x57903e;if(validateAccess(_0xb5f1f6,_0x93ea25)[_0x164275(0x1d0)]){if(pid[_0x102a2e])pid[_0x102a2e][_0x164275(0x96)]({'function':_0x164275(0x171),'args':null});}else logger[_0x164275(0x1a0)](_0x164275(0x1b1));}),_0x5b1853['on']('update-bb',_0x742412=>{const _0x8a129=_0x57903e;if(validateAccess(_0x742412,_0x93ea25)[_0x8a129(0x1d0)])updateBB();else logger[_0x8a129(0x1a0)](_0x8a129(0x9f));}),_0x5b1853['on']('get-messages',_0x1d757c=>{const _0x18d91f=_0x57903e;if(validateAccess(_0x1d757c,_0x93ea25)[_0x18d91f(0x1d0)])getMessages();else logger[_0x18d91f(0x1a0)](_0x18d91f(0x12b));}),_0x5b1853['on'](_0x57903e(0x168),(_0x4ab3ab,_0x40a696)=>{const _0x1cad5d=_0x57903e;if(validateAccess(_0x40a696,_0x93ea25)[_0x1cad5d(0x1d0)])confirmMessage(_0x4ab3ab);else logger[_0x1cad5d(0x1a0)](_0x1cad5d(0xbc));}),_0x5b1853['on'](_0x57903e(0x1dd),_0x15736c=>{const _0x2cbed3=_0x57903e;if(validateAccess(_0x15736c,_0x93ea25)[_0x2cbed3(0x1d0)]){if(devices[_0x93ea25][_0x2cbed3(0x133)])clearTimeout(devices[_0x93ea25]['pidRefreshToken']);if(devices[_0x93ea25][_0x2cbed3(0xf7)])clearTimeout(devices[_0x93ea25][_0x2cbed3(0xf7)]);removeSocketListeners(getClient(_0x5b1853['id'])[_0x2cbed3(0x108)]),addBlacklist(_0x93ea25),devices[_0x93ea25][_0x2cbed3(0x1e8)]=null,devices[_0x93ea25][_0x2cbed3(0x1e3)]=null,devices[_0x93ea25][_0x2cbed3(0xbf)]['token']=null,io['to'](getClient(_0x5b1853['id'])[_0x2cbed3(0x108)])[_0x2cbed3(0x12c)](_0x2cbed3(0xa2),{'access':{'allow':![],'reason':_0x2cbed3(0x1d2),'token':null}});}else logger['full'](_0x2cbed3(0xdf));});}function removeSocketListeners(_0x6bb287){getClientsWithUuid(_0x6bb287)['forEach'](_0x10190e=>{const _0x1ef58c=_0x54f1;getSocket(_0x10190e['id'])[_0x1ef58c(0x17a)]();});}function cleanSettings(){const _0x5f3356=_0x3715e9;let _0xabbe5f=settings;return settings[_0x5f3356(0xb0)]&&settings[_0x5f3356(0xb0)]!=''&&(_0xabbe5f={..._0xabbe5f,'telegramToken':_0x5f3356(0xf0)}),settings[_0x5f3356(0x92)]&&settings['bbPassword']!=''&&(_0xabbe5f={..._0xabbe5f,'bbPassword':'************'}),(settings['bbPassword']&&settings[_0x5f3356(0x92)]==_0x5f3356(0x124)||settings[_0x5f3356(0xb0)]&&settings['telegramToken']==_0x5f3356(0x124))&&(_0xabbe5f={..._0xabbe5f,'restored':{'password':settings[_0x5f3356(0x92)]=='***','telegram':settings[_0x5f3356(0xb0)]==_0x5f3356(0x124)}}),_0xabbe5f;}function updateBB(){const _0x3db72e=_0x3715e9;installingUpdate=!![],config[_0x3db72e(0xee)](_0xfceb25=>{const _0x2bd71d=_0x3db72e;restartBot(_0xfceb25[_0x2bd71d(0xe4)]);}),process[_0x3db72e(0x96)]({'update':!![]},_0x29322e=>{});}function startBot(_0x37b2c8,_0x150e80,_0x5e4913){const _0xe73cae=_0x3715e9;let _0x54f77e=![];const _0x377dfd=_0x37b2c8[0x0];_0x150e80={..._0x150e80,'stdio':['inherit',_0xe73cae(0x136),_0xe73cae(0x136),_0xe73cae(0x21f)]},pid[_0x377dfd]=childProcess[_0xe73cae(0xc2)](botfile,_0x37b2c8,_0x150e80),pid[_0x377dfd]['on'](_0xe73cae(0x14f),_0xb572c=>{const _0x13a8fd=_0xe73cae;switch(Object['keys'](_0xb572c)[0x0]){case _0x13a8fd(0x1cc):updateBotName(_0x377dfd,_0xb572c[_0x13a8fd(0x1cc)]);break;case _0x13a8fd(0x13f):updateBotManager();break;case _0x13a8fd(0xa2):updateStatus(_0x377dfd,_0xb572c[_0x13a8fd(0xa2)]);break;case'live':updateLive(_0x377dfd,_0xb572c[_0x13a8fd(0x196)]);break;case _0x13a8fd(0x1b7):updateLive(_0x377dfd,_0xb572c[_0x13a8fd(0x1b7)]),io['to'](_0x377dfd)['emit'](_0x13a8fd(0xa2),{'access':{'allow':![],'reason':'reload','token':null}});break;case'stop':_0xb572c[_0x13a8fd(0xfc)]==_0x13a8fd(0x162)&&restartBot(_0x377dfd);_0xb572c[_0x13a8fd(0xfc)]=='kill'&&toggleBot(_0x377dfd,_0x13a8fd(0x111),_0x13a8fd(0xe1));break;case _0x13a8fd(0x1c5):sendTelegram(_0x377dfd,_0xb572c['telegram']);break;case _0x13a8fd(0x177):sendTelegramMsg(_0xb572c[_0x13a8fd(0x177)]);break;case _0x13a8fd(0xe3):io['to'](_0x377dfd)[_0x13a8fd(0x12c)](_0xb572c[_0x13a8fd(0xe3)],_0xb572c[_0x13a8fd(0xde)]);break;}}),pid[_0x377dfd]['on']('error',function(_0x26239d){if(_0x54f77e)return;_0x54f77e=!![],_0x5e4913(_0x26239d);}),pid[_0x377dfd]['on'](_0xe73cae(0x1df),async function(_0x437f43){const _0x48ad33=_0xe73cae;if(installingUpdate)return;if(_0x54f77e)return;_0x54f77e=!![],_0x5e4913(null);const _0x37c137=dbConfig['get'](_0x48ad33(0x21b))[_0x48ad33(0xbe)]({'botID':_0x377dfd})[_0x48ad33(0x209)]();_0x37c137&&(_0x37c137[_0x48ad33(0xa2)]=='enabled'||_0x37c137[_0x48ad33(0xa2)]==_0x48ad33(0xdd))&&(await sleep(0x3e8),updateLive(_0x377dfd,_0x48ad33(0xe1)),logger[_0x48ad33(0x1a0)](_0x48ad33(0x16a)+_0x377dfd),startBot([_0x377dfd,userID],{'cwd':bbpath},function(_0x4ab2c7){const _0x37b165=_0x48ad33;if(_0x4ab2c7)logger[_0x37b165(0x1a0)](_0x4ab2c7);}));});}function stopBot(_0x5137e1){const _0x2dfda4=_0x3715e9;getClientsWithBotID(_0x5137e1)[_0x2dfda4(0xee)](_0x2b33e5=>{getSocket(_0x2b33e5['id'])['disconnect'](!![]),removeClient(_0x2b33e5['id']);}),pid[_0x5137e1]&&(pid[_0x5137e1][_0x2dfda4(0x15f)](),pid[_0x5137e1]=null);}function restartBot(_0x509175){const _0x1c5172=_0x3715e9;if(pid[_0x509175])pid[_0x509175][_0x1c5172(0x15f)]();}function addBot(){const _0x3eb763=_0x3715e9;let _0x13c11f;for(let _0x5bf7cf=0x1;_0x5bf7cf<0x3e9;_0x5bf7cf++){_0x13c11f=_0x5bf7cf['toString']()['padStart'](0x3,'0');let _0xd05309=config[_0x3eb763(0xbe)](_0x4135a2=>_0x4135a2[_0x3eb763(0xe4)]==_0x13c11f);if(!_0xd05309)break;}if(_0x13c11f===_0x3eb763(0x1f5)){logger[_0x3eb763(0x1a0)](_0x3eb763(0x22e));return;}logger[_0x3eb763(0x1a0)](_0x3eb763(0x140)+_0x13c11f),dbConfig['get']('bots')['push']({'botID':_0x13c11f,'botname':_0x3eb763(0x215)+_0x13c11f,'status':_0x3eb763(0xdd),'live':''})[_0x3eb763(0xd3)](),startBot([_0x13c11f,userID],{'cwd':bbpath},function(_0x347ff7){if(_0x347ff7)logger['full'](_0x347ff7);}),config=getConfiguration(),io['to']('botmanager')[_0x3eb763(0x12c)](_0x3eb763(0x21b),config);}function deleteBot(_0xe76ca0){const _0x2cad10=_0x3715e9;getClientsWithBotID(_0xe76ca0)['forEach'](_0xd4721a=>{const _0x18792a=_0x54f1;getSocket(_0xd4721a['id'])[_0x18792a(0x186)](!![]),removeClient(_0xd4721a['id']);}),dbConfig[_0x2cad10(0x99)]('bots')[_0x2cad10(0x18e)]({'botID':_0xe76ca0})[_0x2cad10(0xd3)](),logger[_0x2cad10(0x1a0)](_0x2cad10(0xf2)+_0xe76ca0),stopBot(_0xe76ca0);try{fs[_0x2cad10(0x200)](path[_0x2cad10(0xbd)](configpath,_0x2cad10(0x228)+_0xe76ca0+_0x2cad10(0x17c))),fs[_0x2cad10(0x200)](path[_0x2cad10(0xbd)](configpath,_0x2cad10(0x228)+_0xe76ca0+_0x2cad10(0x147))),fs[_0x2cad10(0x200)](path['join'](configpath,_0x2cad10(0x228)+_0xe76ca0+_0x2cad10(0x11f))),fs[_0x2cad10(0x200)](path[_0x2cad10(0xbd)](configpath,_0x2cad10(0x228)+_0xe76ca0+_0x2cad10(0x195)));}catch(_0x5a965a){if(_0x5a965a)logger[_0x2cad10(0x1a0)](_0x2cad10(0x1a2),_0x5a965a);}config=getConfiguration(),io['to'](_0x2cad10(0x109))[_0x2cad10(0x12c)]('bots',config);}function toggleBot(_0x4ffcb4,_0x1ee9c8,_0x234a3b){const _0x44ff46=_0x3715e9;dbConfig['get']('bots')[_0x44ff46(0xbe)]({'botID':_0x4ffcb4})[_0x44ff46(0x19e)]({'status':_0x1ee9c8})['assign']({'live':_0x234a3b})[_0x44ff46(0xd3)]();if(_0x1ee9c8=='enabled'||_0x1ee9c8==_0x44ff46(0xdd))logger[_0x44ff46(0x1a0)](_0x44ff46(0x142)+_0x4ffcb4),startBot([_0x4ffcb4,userID],{'cwd':bbpath},function(_0x4f8596){const _0x355a0a=_0x44ff46;if(_0x4f8596)logger[_0x355a0a(0x1a0)](_0x4f8596);});else(_0x1ee9c8==_0x44ff46(0x111)||_0x1ee9c8==_0x44ff46(0x86))&&(logger['full']('disabled\x20Bot\x20'+_0x4ffcb4),stopBot(_0x4ffcb4));config=getConfiguration(),io['to'](_0x44ff46(0x109))[_0x44ff46(0x12c)](_0x44ff46(0x21b),config);}function toggleStatus(_0x3c623e){const _0x4aca38=_0x3715e9;let _0x450e74=dbConfig[_0x4aca38(0x99)](_0x4aca38(0x21b))[_0x4aca38(0xbe)]({'botID':_0x3c623e})[_0x4aca38(0x209)](),_0x2ee58d;if(_0x450e74['status']===_0x4aca38(0x182))_0x2ee58d=_0x4aca38(0x111);else{if(_0x450e74[_0x4aca38(0xa2)]===_0x4aca38(0xdd))_0x2ee58d=_0x4aca38(0x86);else{if(_0x450e74['status']==='new-disabled')_0x2ee58d=_0x4aca38(0xdd);else{if(_0x450e74[_0x4aca38(0xa2)]===_0x4aca38(0x111))_0x2ee58d=_0x4aca38(0x182);}}}return _0x2ee58d;}function updateStatus(_0x21d75d,_0x4c6ee2){const _0x3bb49e=_0x3715e9;dbConfig[_0x3bb49e(0x99)](_0x3bb49e(0x21b))[_0x3bb49e(0xbe)]({'botID':_0x21d75d})['assign']({'status':_0x4c6ee2})['write'](),config=getConfiguration(),io['to'](_0x3bb49e(0x109))[_0x3bb49e(0x12c)](_0x3bb49e(0x21b),config);}function updateLive(_0x5621ca,_0x225edb){const _0x343a95=_0x3715e9;dbConfig[_0x343a95(0x99)](_0x343a95(0x21b))[_0x343a95(0xbe)]({'botID':_0x5621ca})[_0x343a95(0x19e)]({'live':_0x225edb})[_0x343a95(0xd3)](),config=getConfiguration(),io['to'](_0x343a95(0x109))['emit']('bots',config);}function updateBotName(_0x291d64,_0x508db1){const _0x3ec2fc=_0x3715e9;dbConfig[_0x3ec2fc(0x99)](_0x3ec2fc(0x21b))['find']({'botID':_0x291d64})[_0x3ec2fc(0x19e)]({'botname':_0x508db1})[_0x3ec2fc(0xd3)](),config=getConfiguration(),io['to'](_0x3ec2fc(0x109))['emit'](_0x3ec2fc(0x21b),config);}function updateBotManager(){const _0x5908ae=_0x3715e9;config=getConfiguration(),io['to'](_0x5908ae(0x109))[_0x5908ae(0x12c)](_0x5908ae(0x21b),config);}function toggleBotMode(_0x2f807d){const _0x10b4ef=_0x3715e9;if(pid[_0x2f807d])pid[_0x2f807d]['send']({'function':_0x10b4ef(0x1fc),'args':null});else{const _0x50f927=configpath+_0x10b4ef(0x228)+_0x2f807d+_0x10b4ef(0x17c),_0x13ddb6=fs[_0x10b4ef(0x1f7)](_0x50f927),_0x3dbb65=JSON[_0x10b4ef(0x144)](_0x13ddb6),_0x13f624=_0x3dbb65[_0x10b4ef(0x1d6)][0x0][_0x10b4ef(0xda)];_0x3dbb65[_0x10b4ef(0x1d6)][0x0][_0x10b4ef(0xda)]=!_0x13f624;const _0x491742=JSON['stringify'](_0x3dbb65,null,0x2);fs[_0x10b4ef(0x1f3)](_0x50f927,_0x491742),config=getConfiguration(),io['to'](_0x10b4ef(0x109))[_0x10b4ef(0x12c)](_0x10b4ef(0x21b),config);}}function telegramError(_0xe476ae){const _0xa43382=_0x3715e9;logger[_0xa43382(0x1ee)](getTimeStamp()+_0xa43382(0x19b));}function validateTelegram(_0x15f0bf){const _0x33b18e=_0x3715e9;if(_0x15f0bf[_0x33b18e(0x11d)]['username']!=settings['telegramUsername']&&'@'+_0x15f0bf[_0x33b18e(0x11d)][_0x33b18e(0xf4)]!=settings['telegramUsername'])return tgBot[_0x33b18e(0x19c)](_0x15f0bf[_0x33b18e(0x170)]['id'],_0x33b18e(0x105),{'parse_mode':_0x33b18e(0x20c)})['catch'](_0x487d29=>{telegramError(_0x487d29);}),![];return!![];}async function initTelegram(){const _0x5dcb20=_0x3715e9;if(tgBot)tgBot[_0x5dcb20(0x1cf)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x2e598a=_0x5dcb20(0x1ca);_0x2e598a+='\x0a',_0x2e598a+='/enable\x20-\x20enable\x20notifications\x0a',_0x2e598a+='/disable\x20-\x20disable\x20notifications\x0a',_0x2e598a+=_0x5dcb20(0x20e),_0x2e598a+=_0x5dcb20(0x1a7),_0x2e598a+=_0x5dcb20(0x1ea),_0x2e598a+=_0x5dcb20(0xff),_0x2e598a+=_0x5dcb20(0x128),_0x2e598a+=_0x5dcb20(0x204),_0x2e598a+=_0x5dcb20(0xd2),_0x2e598a+=_0x5dcb20(0x217),_0x2e598a+=_0x5dcb20(0x199),_0x2e598a+=_0x5dcb20(0x211);let _0x447824=_0x5dcb20(0xa7);_0x447824+='\x0a',_0x447824+=_0x2e598a,tgBot[_0x5dcb20(0xa9)](/\/start/,_0xe5343f=>{const _0x8491df=_0x5dcb20;if(!validateTelegram(_0xe5343f))return;if(settings[_0x8491df(0x1b6)]!=_0xe5343f[_0x8491df(0x170)]['id'])updateSetting(_0x8491df(0x1b6),_0xe5343f['chat']['id']);updateSetting(_0x8491df(0xf9),!![]),tgBot['sendMessage'](_0xe5343f[_0x8491df(0x170)]['id'],_0x447824)[_0x8491df(0xdb)](_0x153419=>{telegramError(_0x153419);});}),tgBot[_0x5dcb20(0xa9)](/\/enable/,_0x4b01cd=>{const _0x1ec858=_0x5dcb20;if(!validateTelegram(_0x4b01cd))return;if(settings['telegramChatId']!=_0x4b01cd[_0x1ec858(0x170)]['id'])updateSetting(_0x1ec858(0x1b6),_0x4b01cd[_0x1ec858(0x170)]['id']);updateSetting(_0x1ec858(0xf9),!![]),tgBot[_0x1ec858(0x19c)](_0x4b01cd['chat']['id'],'Notifications\x20enabled')[_0x1ec858(0xdb)](_0x35e147=>{telegramError(_0x35e147);});}),tgBot[_0x5dcb20(0xa9)](/\/config/,async _0x2b4f46=>{const _0x56f2b0=_0x5dcb20;if(!validateTelegram(_0x2b4f46))return;tgBot[_0x56f2b0(0x185)]('callback_query'),tgBot['sendMessage'](_0x2b4f46[_0x56f2b0(0x170)]['id'],_0x56f2b0(0x95),{'reply_markup':{'inline_keyboard':[[{'text':_0x56f2b0(0x13b),'callback_data':_0x56f2b0(0xab)},{'text':_0x56f2b0(0x1e4),'callback_data':_0x56f2b0(0xba)},{'text':_0x56f2b0(0x183),'callback_data':_0x56f2b0(0x18b)}]]}})[_0x56f2b0(0xdb)](_0x3e6982=>{telegramError(_0x3e6982);}),tgBot['on'](_0x56f2b0(0xec),async _0x5d18ef=>{const _0x5e7ff7=_0x56f2b0,_0x33648a=_0x5d18ef['data'],_0x37481f=_0x5d18ef[_0x5e7ff7(0x14f)];tgBot['answerCallbackQuery'](_0x5d18ef['id'])[_0x5e7ff7(0xcd)](async()=>{const _0x1dfa94=_0x5e7ff7;_0x33648a==_0x1dfa94(0xab)&&(updateSetting(_0x1dfa94(0x1fd),_0x1dfa94(0xab)),updateSetting(_0x1dfa94(0xf9),!![]),await tgBot[_0x1dfa94(0x19c)](_0x37481f['chat']['id'],_0x1dfa94(0x88))[_0x1dfa94(0xdb)](_0x5c6e9b=>{telegramError(_0x5c6e9b);}));_0x33648a==_0x1dfa94(0xba)&&(updateSetting(_0x1dfa94(0x1fd),'alerts'),updateSetting('telegramEnabled',!![]),await tgBot[_0x1dfa94(0x19c)](_0x37481f[_0x1dfa94(0x170)]['id'],_0x1dfa94(0x210))[_0x1dfa94(0xdb)](_0x3ea47d=>{telegramError(_0x3ea47d);}));_0x33648a==_0x1dfa94(0x18b)&&(updateSetting(_0x1dfa94(0x1fd),'all'),updateSetting(_0x1dfa94(0xf9),!![]),await tgBot[_0x1dfa94(0x19c)](_0x37481f['chat']['id'],_0x1dfa94(0x1bd))[_0x1dfa94(0xdb)](_0x1eee1d=>{telegramError(_0x1eee1d);}));if(!settings[_0x1dfa94(0x1b6)])tgBot[_0x1dfa94(0x19c)](_0x37481f[_0x1dfa94(0x170)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x1dfa94(0xdb)](_0xf51f95=>{telegramError(_0xf51f95);});}),tgBot[_0x5e7ff7(0x185)]('callback_query');});}),tgBot[_0x5dcb20(0xa9)](/\/status/,_0xd64184=>{const _0x498963=_0x5dcb20;if(!validateTelegram(_0xd64184))return;const _0x395313=getBotsWithMode();let _0x2388e2=_0x498963(0x1ef);config['forEach'](_0x2ff5c4=>{const _0x17fd96=_0x498963,_0x10e35a=_0x395313[_0x17fd96(0xbe)](_0x188afb=>_0x188afb[_0x17fd96(0xe4)]==_0x2ff5c4[_0x17fd96(0xe4)])[_0x17fd96(0x10e)];_0x2388e2+=_0x17fd96(0x215)+_0x2ff5c4[_0x17fd96(0xe4)]+':\x20'+_0x2ff5c4[_0x17fd96(0xa2)]+'\x20|\x20'+_0x10e35a+_0x17fd96(0x233)+_0x2ff5c4['live']+'\x0a';}),_0x2388e2+='\x0a',_0x2388e2+=_0x498963(0x93),_0x2388e2+=!settings[_0x498963(0xf9)]?'Notifications\x20disabled\x0a':_0x498963(0xc5),_0x2388e2+=settings[_0x498963(0xf9)]?settings['telegramEvents']==_0x498963(0x18b)?_0x498963(0xeb):'Notifications\x20types:\x20'+settings[_0x498963(0x1fd)]+_0x498963(0x9b):'',tgBot[_0x498963(0x19c)](_0xd64184[_0x498963(0x170)]['id'],_0x2388e2,{'parse_mode':'HTML'})[_0x498963(0xdb)](_0x20bdcb=>{telegramError(_0x20bdcb);});}),tgBot[_0x5dcb20(0xa9)](/\/restart/,_0x3a1653=>{const _0x253983=_0x5dcb20;if(!validateTelegram(_0x3a1653))return;tgBot[_0x253983(0x185)](_0x253983(0xec));const _0x328930=getEnabledBots();if(_0x328930[_0x253983(0x178)]==0x0)tgBot[_0x253983(0x19c)](_0x3a1653[_0x253983(0x170)]['id'],_0x253983(0x13c))[_0x253983(0xdb)](_0xabcac1=>{telegramError(_0xabcac1);});else{if(_0x328930[_0x253983(0x178)]>0x1)_0x328930[_0x253983(0x1af)]({'botID':_0x253983(0x18b)});let _0x4dad5d=[],_0x5d0259=[];const _0x148df6=_0x328930[_0x253983(0x178)]%0x4==0x0||_0x328930[_0x253983(0x178)]%0x4==0x3||_0x328930[_0x253983(0x178)]%0x3==0x1?0x4:0x3;let _0x15a846=0x0;_0x328930['forEach']((_0x3ef747,_0x3d4a1b)=>{const _0x36f341=_0x253983;if(_0x3d4a1b%_0x148df6==0x0)_0x5d0259=[];_0x5d0259[_0x36f341(0x1af)]({'text':_0x3ef747[_0x36f341(0xe4)]==_0x36f341(0x18b)?_0x36f341(0x143):'Bot\x20'+_0x3ef747[_0x36f341(0xe4)],'callback_data':_0x3ef747[_0x36f341(0xe4)]}),_0x3d4a1b%_0x148df6==0x0&&(_0x4dad5d[_0x15a846]=_0x5d0259,_0x15a846++);}),tgBot[_0x253983(0x19c)](_0x3a1653[_0x253983(0x170)]['id'],_0x253983(0xa5),{'reply_markup':{'inline_keyboard':_0x4dad5d}})[_0x253983(0xdb)](_0x136d01=>{telegramError(_0x136d01);}),tgBot['on']('callback_query',async _0x5af014=>{const _0x499a02=_0x253983,_0x1f391e=_0x5af014['data'],_0x40a713=_0x5af014[_0x499a02(0x14f)];tgBot[_0x499a02(0x188)](_0x5af014['id'])[_0x499a02(0xcd)](async()=>{const _0x541cb9=_0x499a02;_0x1f391e==_0x541cb9(0x18b)?config['forEach'](_0x1fb55c=>{const _0x522f50=_0x541cb9;restartBot(_0x1fb55c[_0x522f50(0xe4)]);}):restartBot(_0x1f391e);}),tgBot[_0x499a02(0x185)](_0x499a02(0xec));});}}),tgBot[_0x5dcb20(0xa9)](/\/on/,_0x420ac1=>{const _0x3430f6=_0x5dcb20;if(!validateTelegram(_0x420ac1))return;tgBot[_0x3430f6(0x185)](_0x3430f6(0xec));const _0x25b93e=getDisabledBots();if(_0x25b93e[_0x3430f6(0x178)]==0x0)tgBot[_0x3430f6(0x19c)](_0x420ac1[_0x3430f6(0x170)]['id'],_0x3430f6(0x1f0))[_0x3430f6(0xdb)](_0x370712=>{telegramError(_0x370712);});else{if(_0x25b93e[_0x3430f6(0x178)]>0x1)_0x25b93e['push']({'botID':_0x3430f6(0x18b)});let _0x51f30c=[],_0x54726a=[];const _0x1b222b=_0x25b93e[_0x3430f6(0x178)]%0x4==0x0||_0x25b93e[_0x3430f6(0x178)]%0x4==0x3||_0x25b93e['length']%0x3==0x1?0x4:0x3;let _0x5e7618=0x0;_0x25b93e['forEach']((_0x5ed626,_0x3ffdab)=>{const _0x3d796c=_0x3430f6;if(_0x3ffdab%_0x1b222b==0x0)_0x54726a=[];_0x54726a[_0x3d796c(0x1af)]({'text':_0x5ed626[_0x3d796c(0xe4)]==_0x3d796c(0x18b)?_0x3d796c(0x143):_0x3d796c(0x215)+_0x5ed626[_0x3d796c(0xe4)],'callback_data':_0x5ed626['botID']}),_0x3ffdab%_0x1b222b==0x0&&(_0x51f30c[_0x5e7618]=_0x54726a,_0x5e7618++);}),tgBot[_0x3430f6(0x19c)](_0x420ac1[_0x3430f6(0x170)]['id'],_0x3430f6(0x20b),{'reply_markup':{'inline_keyboard':_0x51f30c}})[_0x3430f6(0xdb)](_0x2ddba8=>{telegramError(_0x2ddba8);}),tgBot['on']('callback_query',async _0x448e18=>{const _0x53f698=_0x3430f6,_0x240727=_0x448e18[_0x53f698(0x97)],_0x23df42=_0x448e18[_0x53f698(0x14f)];tgBot['answerCallbackQuery'](_0x448e18['id'])[_0x53f698(0xcd)](async()=>{const _0x1982fc=_0x53f698;_0x240727==_0x1982fc(0x18b)?(tgBot[_0x1982fc(0x19c)](_0x23df42[_0x1982fc(0x170)]['id'],_0x1982fc(0x1d7))[_0x1982fc(0xdb)](_0x4d99c9=>{telegramError(_0x4d99c9);}),_0x25b93e[_0x1982fc(0xee)](_0x7b56cf=>{const _0x158769=_0x1982fc;if(_0x7b56cf[_0x158769(0xe4)]!=_0x158769(0x18b))toggleBot(_0x7b56cf['botID'],toggleStatus(_0x7b56cf['botID']),_0x158769(0xe1));})):(tgBot['sendMessage'](_0x23df42[_0x1982fc(0x170)]['id'],_0x1982fc(0x8f)+_0x240727)[_0x1982fc(0xdb)](_0x2e4992=>{telegramError(_0x2e4992);}),toggleBot(_0x240727,toggleStatus(_0x240727),_0x1982fc(0xe1)));}),tgBot[_0x53f698(0x185)](_0x53f698(0xec));});}}),tgBot['onText'](/\/off/,_0x45ea6d=>{const _0x33b70e=_0x5dcb20;if(!validateTelegram(_0x45ea6d))return;tgBot['removeListener']('callback_query');const _0x539061=getEnabledBots();if(_0x539061[_0x33b70e(0x178)]==0x0)tgBot[_0x33b70e(0x19c)](_0x45ea6d[_0x33b70e(0x170)]['id'],_0x33b70e(0x13c))[_0x33b70e(0xdb)](_0x470edf=>{telegramError(_0x470edf);});else{if(_0x539061[_0x33b70e(0x178)]>0x1)_0x539061[_0x33b70e(0x1af)]({'botID':_0x33b70e(0x18b)});let _0x4d0a63=[],_0x529411=[];const _0x167ce2=_0x539061[_0x33b70e(0x178)]%0x4==0x0||_0x539061[_0x33b70e(0x178)]%0x4==0x3||_0x539061[_0x33b70e(0x178)]%0x3==0x1?0x4:0x3;let _0x344927=0x0;_0x539061[_0x33b70e(0xee)]((_0x2e905b,_0x559eb4)=>{const _0x143662=_0x33b70e;if(_0x559eb4%_0x167ce2==0x0)_0x529411=[];_0x529411[_0x143662(0x1af)]({'text':_0x2e905b['botID']==_0x143662(0x18b)?_0x143662(0x143):_0x143662(0x215)+_0x2e905b[_0x143662(0xe4)],'callback_data':_0x2e905b[_0x143662(0xe4)]}),_0x559eb4%_0x167ce2==0x0&&(_0x4d0a63[_0x344927]=_0x529411,_0x344927++);}),tgBot[_0x33b70e(0x19c)](_0x45ea6d[_0x33b70e(0x170)]['id'],_0x33b70e(0x1c8),{'reply_markup':{'inline_keyboard':_0x4d0a63}})[_0x33b70e(0xdb)](_0x4d1447=>{telegramError(_0x4d1447);}),tgBot['on']('callback_query',async _0x472fcb=>{const _0xabfaa5=_0x33b70e,_0x25b2bd=_0x472fcb[_0xabfaa5(0x97)],_0xa5e065=_0x472fcb['message'];tgBot[_0xabfaa5(0x188)](_0x472fcb['id'])[_0xabfaa5(0xcd)](async()=>{const _0x32d1d9=_0xabfaa5;_0x25b2bd=='all'?(tgBot[_0x32d1d9(0x19c)](_0xa5e065[_0x32d1d9(0x170)]['id'],_0x32d1d9(0x12d))['catch'](_0x8d4763=>{telegramError(_0x8d4763);}),_0x539061[_0x32d1d9(0xee)](_0x2af413=>{const _0x206233=_0x32d1d9;if(_0x2af413['botID']!=_0x206233(0x18b))toggleBot(_0x2af413[_0x206233(0xe4)],toggleStatus(_0x2af413[_0x206233(0xe4)]),'stopped');})):(tgBot[_0x32d1d9(0x19c)](_0xa5e065[_0x32d1d9(0x170)]['id'],_0x32d1d9(0x22d)+_0x25b2bd)['catch'](_0x21ea81=>{telegramError(_0x21ea81);}),toggleBot(_0x25b2bd,toggleStatus(_0x25b2bd),'stopped'));}),tgBot[_0xabfaa5(0x185)]('callback_query');});}}),tgBot[_0x5dcb20(0xa9)](/\/portfolio/,_0x2c1eec=>{const _0x34e71a=_0x5dcb20;if(!validateTelegram(_0x2c1eec))return;tgBot[_0x34e71a(0x185)](_0x34e71a(0xec));const _0xaf55a9=getEnabledBots();if(_0xaf55a9['length']==0x0)tgBot[_0x34e71a(0x19c)](_0x2c1eec['chat']['id'],_0x34e71a(0x13c))[_0x34e71a(0xdb)](_0x38b674=>{telegramError(_0x38b674);});else{if(_0xaf55a9[_0x34e71a(0x178)]>0x1){let _0x3b32c4=[],_0x8f544b=[];const _0x198285=_0xaf55a9[_0x34e71a(0x178)]%0x4==0x0||_0xaf55a9[_0x34e71a(0x178)]%0x4==0x3||_0xaf55a9[_0x34e71a(0x178)]%0x3==0x1?0x4:0x3;let _0x2f11d7=0x0;_0xaf55a9[_0x34e71a(0xee)]((_0x2edc1e,_0x46329a)=>{const _0x3a901f=_0x34e71a;if(_0x46329a%_0x198285==0x0)_0x8f544b=[];_0x8f544b['push']({'text':_0x3a901f(0x215)+_0x2edc1e['botID'],'callback_data':_0x2edc1e['botID']}),_0x46329a%_0x198285==0x0&&(_0x3b32c4[_0x2f11d7]=_0x8f544b,_0x2f11d7++);}),tgBot['sendMessage'](_0x2c1eec[_0x34e71a(0x170)]['id'],_0x34e71a(0x191),{'reply_markup':{'inline_keyboard':_0x3b32c4}})[_0x34e71a(0xdb)](_0x574631=>{telegramError(_0x574631);}),tgBot['on'](_0x34e71a(0xec),async _0x4fce7a=>{const _0x2a964d=_0x34e71a,_0x4a5a6f=_0x4fce7a[_0x2a964d(0x97)],_0x90d259=_0x4fce7a[_0x2a964d(0x14f)];tgBot[_0x2a964d(0x188)](_0x4fce7a['id'])[_0x2a964d(0xcd)](async()=>{if(pid[_0x4a5a6f])pid[_0x4a5a6f]['send']({'function':'sendPortfolioTelegram','args':null});}),tgBot['removeListener'](_0x2a964d(0xec));});}else{const _0x4f4bd4=_0xaf55a9[0x0][_0x34e71a(0xe4)];if(pid[_0x4f4bd4])pid[_0x4f4bd4][_0x34e71a(0x96)]({'function':_0x34e71a(0x15d),'args':null});}}}),tgBot[_0x5dcb20(0xa9)](/\/update/,async _0x36d79f=>{const _0x11f5a5=_0x5dcb20;if(!validateTelegram(_0x36d79f))return;tgBot[_0x11f5a5(0x185)](_0x11f5a5(0xec)),await getMessages();if(!updateAvailable)tgBot[_0x11f5a5(0x19c)](_0x36d79f[_0x11f5a5(0x170)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')['catch'](_0x2948ad=>{telegramError(_0x2948ad);});else!validInstallation?tgBot['sendMessage'](_0x36d79f['chat']['id'],_0x11f5a5(0x207))[_0x11f5a5(0xdb)](_0x1718b7=>{telegramError(_0x1718b7);}):(tgBot[_0x11f5a5(0x19c)](_0x36d79f[_0x11f5a5(0x170)]['id'],_0x11f5a5(0x1c1),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x11f5a5(0x1ab)},{'text':'No','callback_data':'no'}]]}})[_0x11f5a5(0xdb)](_0x3f3420=>{telegramError(_0x3f3420);}),tgBot['on']('callback_query',async _0x2522d9=>{const _0x1623c1=_0x11f5a5,_0x1c3565=_0x2522d9[_0x1623c1(0x97)],_0x185a31=_0x2522d9[_0x1623c1(0x14f)];tgBot[_0x1623c1(0x188)](_0x2522d9['id'])[_0x1623c1(0xcd)](async()=>{const _0x1a1774=_0x1623c1;_0x1c3565==_0x1a1774(0x1ab)&&(await tgBot[_0x1a1774(0x19c)](_0x185a31[_0x1a1774(0x170)]['id'],'Starting\x20Balance\x20Bot\x20update')[_0x1a1774(0xdb)](_0x2631e8=>{telegramError(_0x2631e8);}),updateBB());_0x1c3565=='no'&&await tgBot[_0x1a1774(0x19c)](_0x185a31[_0x1a1774(0x170)]['id'],_0x1a1774(0xc0))[_0x1a1774(0xdb)](_0x32392f=>{telegramError(_0x32392f);});if(!settings[_0x1a1774(0x1b6)])tgBot[_0x1a1774(0x19c)](_0x185a31[_0x1a1774(0x170)]['id'],_0x1a1774(0xc1))['catch'](_0x1f4e59=>{telegramError(_0x1f4e59);});}),tgBot[_0x1623c1(0x185)](_0x1623c1(0xec));}));}),tgBot[_0x5dcb20(0xa9)](/\/toggle/,_0x42ac49=>{const _0x51e30f=_0x5dcb20;if(!validateTelegram(_0x42ac49))return;tgBot['removeListener'](_0x51e30f(0xec));const _0x3c3501=getBotsWithMode();if(_0x3c3501[_0x51e30f(0x178)]==0x0)tgBot[_0x51e30f(0x19c)](_0x42ac49['chat']['id'],_0x51e30f(0x13c))[_0x51e30f(0xdb)](_0x47de74=>{telegramError(_0x47de74);});else{let _0x5a116e=[],_0x1abc38=[];const _0x2730e4=0x2;let _0x4278b9=0x0;_0x3c3501[_0x51e30f(0xee)]((_0x12abea,_0x47337e)=>{const _0x591035=_0x51e30f;if(_0x47337e%_0x2730e4==0x0)_0x1abc38=[];_0x1abc38[_0x591035(0x1af)]({'text':_0x591035(0x215)+_0x12abea[_0x591035(0xe4)]+'\x20('+_0x12abea[_0x591035(0x10e)]+')','callback_data':_0x12abea['botID']}),_0x47337e%_0x2730e4==0x0&&(_0x5a116e[_0x4278b9]=_0x1abc38,_0x4278b9++);}),tgBot[_0x51e30f(0x19c)](_0x42ac49[_0x51e30f(0x170)]['id'],_0x51e30f(0x19f),{'reply_markup':{'inline_keyboard':_0x5a116e}})[_0x51e30f(0xdb)](_0x3b016a=>{telegramError(_0x3b016a);}),tgBot['on'](_0x51e30f(0xec),async _0x145f5a=>{const _0x565042=_0x51e30f,_0x1b0bbd=_0x145f5a[_0x565042(0x97)],_0x162f35=_0x145f5a[_0x565042(0x14f)];tgBot[_0x565042(0x188)](_0x145f5a['id'])[_0x565042(0xcd)](async()=>{const _0x198daa=_0x565042,_0x1d3a5f=_0x3c3501[_0x198daa(0xbe)](_0x39f731=>_0x39f731[_0x198daa(0xe4)]==_0x1b0bbd),_0x67cdb=_0x1d3a5f[_0x198daa(0x10e)]==_0x198daa(0x8a)?'manual':_0x198daa(0x8a);tgBot[_0x198daa(0x19c)](_0x162f35[_0x198daa(0x170)]['id'],_0x198daa(0xb6)+_0x1b0bbd+_0x198daa(0x1e7)+_0x67cdb+_0x198daa(0x216))[_0x198daa(0xdb)](_0x41bc0c=>{telegramError(_0x41bc0c);}),toggleBotMode(_0x1b0bbd);}),tgBot['removeListener'](_0x565042(0xec));});}}),tgBot[_0x5dcb20(0xa9)](/\/names/,_0x542ab1=>{const _0x56f2df=_0x5dcb20;if(!validateTelegram(_0x542ab1))return;let _0x28e968='';config[_0x56f2df(0xee)](_0x5c5441=>{const _0x3979cc=_0x56f2df;_0x28e968+=_0x3979cc(0x215)+_0x5c5441[_0x3979cc(0xe4)]+':\x20'+_0x5c5441[_0x3979cc(0x1cc)]+'\x0a';}),tgBot[_0x56f2df(0x19c)](_0x542ab1['chat']['id'],_0x28e968,{'parse_mode':_0x56f2df(0x20c)})[_0x56f2df(0xdb)](_0x5101a7=>{telegramError(_0x5101a7);});}),tgBot[_0x5dcb20(0xa9)](/\/disable/,_0x3c6976=>{const _0x5b5d7c=_0x5dcb20;if(!validateTelegram(_0x3c6976))return;tgBot[_0x5b5d7c(0x19c)](_0x3c6976[_0x5b5d7c(0x170)]['id'],'Notifications\x20disabled')[_0x5b5d7c(0xdb)](_0x36760b=>{telegramError(_0x36760b);}),updateSetting('telegramEnabled',![]);}),tgBot['onText'](/\/help/,_0x3c5831=>{const _0x9ac1ad=_0x5dcb20;if(!validateTelegram(_0x3c5831))return;tgBot[_0x9ac1ad(0x19c)](_0x3c5831[_0x9ac1ad(0x170)]['id'],_0x2e598a)[_0x9ac1ad(0xdb)](_0x1fba77=>{telegramError(_0x1fba77);});}),tgBot['on'](_0x5dcb20(0xb8),_0x4a1178=>{const _0x169fe2=_0x5dcb20;_0x4a1178[_0x169fe2(0x1cd)]()[_0x169fe2(0xcb)]('404\x20Not\x20Found')&&(logger[_0x169fe2(0x1a0)](_0x169fe2(0xe8)),tgBot[_0x169fe2(0x1cf)](),tgBot=null,io['to'](_0x169fe2(0x109))['emit'](_0x169fe2(0x208),_0x169fe2(0xe8)));}),process[_0x5dcb20(0x10a)](_0x5dcb20(0x212),()=>{const _0x2d9160=_0x5dcb20;if(tgBot)tgBot[_0x2d9160(0x1cf)]();process[_0x2d9160(0x1df)](0x1);}),process['once'](_0x5dcb20(0x1de),()=>{const _0x51504c=_0x5dcb20;if(tgBot)tgBot[_0x51504c(0x1cf)]();process['exit'](0x1);});}}function disableTelegram(){const _0x5e315d=_0x3715e9;tgBot&&(tgBot[_0x5e315d(0x1cf)](),tgBot=null);}function sendTelegram(_0x516842,_0x154435){const _0x1a6628=_0x3715e9;if(settings[_0x1a6628(0xf9)]){if(settings[_0x1a6628(0x1fd)]==_0x1a6628(0x18b)||(_0x154435['type']=='error'||_0x154435[_0x1a6628(0xb1)]==_0x1a6628(0x21e)||_0x154435[_0x1a6628(0xb1)]==_0x1a6628(0xf5))&&settings['telegramEvents']=='alerts'||_0x154435[_0x1a6628(0xb1)]==_0x1a6628(0x1fb)&&settings['telegramEvents']==_0x1a6628(0xab)){if(tgBot&&settings[_0x1a6628(0x1b6)]){if(_0x154435[_0x1a6628(0x132)])tgBot[_0x1a6628(0x19c)](settings['telegramChatId'],_0x154435[_0x1a6628(0x1cc)]+_0x1a6628(0xf6)+_0x154435[_0x1a6628(0x1c6)])[_0x1a6628(0xdb)](_0x18c428=>{telegramError(_0x18c428);});else tgBot['sendMessage'](settings[_0x1a6628(0x1b6)],_0x1a6628(0x215)+_0x516842+_0x1a6628(0xf6)+_0x154435[_0x1a6628(0x1c6)])[_0x1a6628(0xdb)](_0x78b79c=>{telegramError(_0x78b79c);});}}}}async function sendTelegramMsg(_0x5d3e05,_0xa1a8fc='HTML'){const _0x18e6d2=_0x3715e9;return settings[_0x18e6d2(0xf9)]&&tgBot&&settings[_0x18e6d2(0x1b6)]?(await tgBot[_0x18e6d2(0x19c)](settings[_0x18e6d2(0x1b6)],_0x5d3e05,{'parse_mode':_0xa1a8fc})['catch'](_0x33c6b7=>{telegramError(_0x33c6b7);}),!![]):![];}function getDeviceWithIp(_0x451663){const _0x5097ad=_0x3715e9;return devices[_0x5097ad(0xbe)](_0x1096d9=>_0x1096d9['ip']===_0x451663);}function temporaryAccess2FA(_0x3a39fa,_0x2943de){const _0x586aa2=_0x3715e9;let _0x5256f2=new Date(),_0x25bb3c=![];if(lastIpApproval){if(_0x5256f2-lastIpApproval<0x1388)_0x25bb3c=!![];}lastIpApproval=new Date();if(_0x25bb3c)return;tgBot&&settings[_0x586aa2(0x1b6)]&&(tgBot[_0x586aa2(0x185)]('callback_query'),tgBot['sendMessage'](settings[_0x586aa2(0x1b6)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x2943de)[_0x586aa2(0xad)]+_0x586aa2(0x8b),{'parse_mode':_0x586aa2(0x20c),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x586aa2(0x1ba),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x586aa2(0xd9),'callback_data':'reject'}]]}})[_0x586aa2(0xdb)](_0x44a35f=>{telegramError(_0x44a35f);}),tgBot['on'](_0x586aa2(0xec),async _0x390a07=>{const _0x3e4b2a=_0x586aa2,_0x31beb6=_0x390a07[_0x3e4b2a(0x97)],_0x390402=_0x390a07[_0x3e4b2a(0x14f)];tgBot['answerCallbackQuery'](_0x390a07['id'])[_0x3e4b2a(0xcd)](async()=>{const _0x5e4eaf=_0x3e4b2a;devices[_0x3a39fa]['telegramIpApproval']={'clientip':_0x2943de,'timestamp':new Date()[_0x5e4eaf(0xae)](),'expiry':_0x31beb6},_0x31beb6!='reject'?(await tgBot[_0x5e4eaf(0x19c)](_0x390402[_0x5e4eaf(0x170)]['id'],_0x5e4eaf(0x1c9)+_0x31beb6+'\x20minutes',{'parse_mode':_0x5e4eaf(0x20c)})[_0x5e4eaf(0xdb)](_0x41a91a=>{telegramError(_0x41a91a);}),io['to'](_0x3a39fa)['emit']('status',{'access':{'allow':![],'reason':_0x5e4eaf(0x221),'token':null}})):(await tgBot[_0x5e4eaf(0x19c)](_0x390402[_0x5e4eaf(0x170)]['id'],_0x5e4eaf(0x1b8))[_0x5e4eaf(0xdb)](_0x2830f1=>{telegramError(_0x2830f1);}),io['to'](_0x3a39fa)['emit'](_0x5e4eaf(0xa2),{'access':{'allow':![],'reason':_0x5e4eaf(0x190),'token':null}}));}),tgBot[_0x3e4b2a(0x185)](_0x3e4b2a(0xec));}));}function loginAccess2FA(_0x1bf614,_0x2f5e83){const _0x517196=_0x3715e9;tgBot&&settings[_0x517196(0x1b6)]&&(tgBot[_0x517196(0x185)](_0x517196(0xec)),tgBot['sendMessage'](settings[_0x517196(0x1b6)],_0x517196(0x1b0)+normalizeIP(_0x2f5e83)[_0x517196(0xad)]+_0x517196(0x8b),{'parse_mode':_0x517196(0x20c),'reply_markup':{'inline_keyboard':[[{'text':_0x517196(0xa6),'callback_data':loginExpiry},{'text':_0x517196(0xd9),'callback_data':_0x517196(0xd9)}]]}})[_0x517196(0xdb)](_0x1b3d04=>{telegramError(_0x1b3d04);}),tgBot['on'](_0x517196(0xec),async _0x5edee3=>{const _0x263230=_0x517196,_0x2fdfcc=_0x5edee3['data'],_0x59da77=_0x5edee3['message'];tgBot[_0x263230(0x188)](_0x5edee3['id'])['then'](async()=>{const _0x23ec70=_0x263230;devices[_0x1bf614][_0x23ec70(0x1e3)]={'clientip':_0x2f5e83,'timestamp':new Date()['getTime'](),'expiry':_0x2fdfcc},_0x2fdfcc!=_0x23ec70(0xd9)?(await tgBot[_0x23ec70(0x19c)](_0x59da77[_0x23ec70(0x170)]['id'],_0x23ec70(0x17e),{'parse_mode':'HTML'})[_0x23ec70(0xdb)](_0xa82a2b=>{telegramError(_0xa82a2b);}),io['to'](_0x1bf614)[_0x23ec70(0x12c)]('status',{'access':{'allow':![],'reason':_0x23ec70(0x221),'token':null}})):(await tgBot[_0x23ec70(0x19c)](_0x59da77[_0x23ec70(0x170)]['id'],'Login\x20rejected')[_0x23ec70(0xdb)](_0x263806=>{telegramError(_0x263806);}),io['to'](_0x1bf614)['emit'](_0x23ec70(0xa2),{'access':{'allow':![],'reason':_0x23ec70(0x166),'token':null}}));}),tgBot[_0x263230(0x185)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3b5b60=_0x3715e9;return dbConfig[_0x3b5b60(0x99)](_0x3b5b60(0x21b))['sortBy'](_0x3b5b60(0xe4))[_0x3b5b60(0x10d)]({'status':_0x3b5b60(0x182)})[_0x3b5b60(0x209)]()||[];}function getDisabledBots(){const _0x3f9c99=_0x3715e9;return dbConfig[_0x3f9c99(0x99)](_0x3f9c99(0x21b))['sortBy']('botID')[_0x3f9c99(0x10d)]({'status':_0x3f9c99(0x111)})['value']()||[];}function getBotAttributes(_0x8394fb){const _0x3c067f=_0x3715e9;let _0x34d847={};const _0x4c0aa2=configpath+'bot-'+_0x8394fb+'-config.json',_0x5d47f4=fs['existsSync'](_0x4c0aa2);if(_0x5d47f4){const _0xb62c82=fs[_0x3c067f(0x1f7)](_0x4c0aa2);try{const _0xf2d7ca=JSON['parse'](_0xb62c82),_0x1fc03d=_0xf2d7ca?_0xf2d7ca['bot'][0x0][_0x3c067f(0xda)]:![];_0x34d847[_0x3c067f(0x10e)]=_0x1fc03d?_0x3c067f(0x8a):'manual',_0x34d847[_0x3c067f(0x1cc)]=_0xf2d7ca?_0xf2d7ca[_0x3c067f(0x1d6)][0x0][_0x3c067f(0x1cc)]:_0x3c067f(0x215)+_0x8394fb;}catch(_0xe4dece){_0x34d847[_0x3c067f(0x10e)]=_0x3c067f(0xc6),_0x34d847[_0x3c067f(0x1cc)]='Bot\x20'+_0x8394fb;}}else _0x34d847[_0x3c067f(0x10e)]='manual',_0x34d847['botname']='Bot\x20'+_0x8394fb;return _0x34d847;}function getBotsWithMode(){const _0x64c87f=_0x3715e9,_0x414e49=dbConfig[_0x64c87f(0x99)](_0x64c87f(0x21b))['sortBy'](_0x64c87f(0xe4))[_0x64c87f(0x209)]()||[];return _0x414e49[_0x64c87f(0xee)](_0x33d0fc=>{const _0x161a5f=_0x64c87f;let _0x4cd45c=getBotAttributes(_0x33d0fc[_0x161a5f(0xe4)]);_0x33d0fc['mode']=_0x4cd45c[_0x161a5f(0x10e)];}),_0x414e49;}async function initUser(){const _0x493a09=_0x3715e9;if(!settings['userid']){const _0x1a1e6e=uuidRandom();mixpanel['alias'](_0x1a1e6e),updateSetting(_0x493a09(0x223),_0x1a1e6e);}}async function initSecure(){const _0x456f0c=_0x3715e9;let _0x43467d=getSecure();if(!_0x43467d[_0x456f0c(0x229)](_0x456f0c(0x201))){let _0x31df74=await generateKeys();_0x43467d['publicKey']=_0x31df74[_0x456f0c(0x150)],_0x43467d[_0x456f0c(0x1bb)]=_0x31df74[_0x456f0c(0x1bb)],_0x43467d[_0x456f0c(0x201)]=crypto[_0x456f0c(0x123)](0x20)[_0x456f0c(0x1cd)]('hex');;storeSecure(_0x43467d);}}function getSettings(){const _0x2d98fa=_0x3715e9;return dbSettings[_0x2d98fa(0x99)](_0x2d98fa(0x1a6))['value']()||{};}function getSecure(){const _0x413b57=_0x3715e9;return dbSecure['get']('secure')[_0x413b57(0x209)]()||{};}function getBlacklist(){const _0x5c94c9=_0x3715e9;return dbSecure[_0x5c94c9(0x99)](_0x5c94c9(0xf3))[_0x5c94c9(0x209)]()||[];}function broadcastToBots(_0x42d713,_0x50858e){const _0x4126b7=_0x3715e9;config[_0x4126b7(0xee)](_0x282ed3=>{const _0x133eb3=_0x4126b7;if(_0x282ed3[_0x133eb3(0xa2)]==_0x133eb3(0x182)&&_0x282ed3[_0x133eb3(0x196)]==_0x133eb3(0x20a)){if(pid[_0x282ed3[_0x133eb3(0xe4)]])pid[_0x282ed3['botID']][_0x133eb3(0x96)]({[_0x42d713]:_0x50858e});}});}function storeSettings(_0x145e4e,_0x489e23=![]){const _0x2a9940=_0x3715e9;_0x145e4e={...settings,..._0x145e4e};if(_0x489e23&&_0x145e4e[_0x2a9940(0x92)]!='************'&&_0x145e4e[_0x2a9940(0x92)]!=_0x2a9940(0x124)&&_0x145e4e[_0x2a9940(0x92)]!=''){const _0x23d918=crypt[_0x2a9940(0x172)](secure[_0x2a9940(0x1bb)],_0x145e4e[_0x2a9940(0x92)])[_0x2a9940(0x14f)][_0x2a9940(0xe2)]('@')[0x0],_0x5c3e14=bcrypt[_0x2a9940(0x231)](_0x23d918,saltRounds);_0x145e4e={..._0x145e4e,'bbPassword':_0x5c3e14};}if(_0x489e23&&_0x145e4e[_0x2a9940(0xb0)]!='************'&&_0x145e4e[_0x2a9940(0xb0)]!=_0x2a9940(0x124)&&_0x145e4e['telegramToken']!=''){const _0x320e17=crypt[_0x2a9940(0x172)](secure['privateKey'],_0x145e4e[_0x2a9940(0xb0)])['message']['split']('@')[0x0];_0x145e4e={..._0x145e4e,'telegramToken':_0x320e17};}const _0x3330ce=_0x145e4e['telegramToken']!=_0x2a9940(0xf0)&&_0x145e4e[_0x2a9940(0xb0)]!=settings[_0x2a9940(0xb0)]||_0x145e4e[_0x2a9940(0xe9)]!=settings[_0x2a9940(0xe9)],_0x133582=_0x145e4e[_0x2a9940(0xb0)]==''||_0x145e4e[_0x2a9940(0xe9)]=='';if(_0x3330ce)_0x145e4e[_0x2a9940(0x1fd)]=_0x2a9940(0x18b);for(const [_0x55022e,_0x14d6fd]of Object['entries'](_0x145e4e)){if(_0x55022e=='telegramToken'&&_0x14d6fd==_0x2a9940(0xf0)){_0x145e4e[_0x2a9940(0xb0)]=settings[_0x2a9940(0xb0)];continue;};if(_0x55022e==_0x2a9940(0x92)&&_0x14d6fd==_0x2a9940(0xf0)){_0x145e4e[_0x2a9940(0x92)]=settings[_0x2a9940(0x92)];continue;};dbSettings[_0x2a9940(0x1f1)]('settings.'+_0x55022e,_0x14d6fd)[_0x2a9940(0xd3)]();}settings=_0x145e4e,io['to'](_0x2a9940(0x109))[_0x2a9940(0x12c)](_0x2a9940(0x1a6),cleanSettings()),broadcastToBots('timeshift',settings[_0x2a9940(0x127)]);if(_0x3330ce&&!_0x133582)initTelegram();if(_0x3330ce&&_0x133582)disableTelegram();getAllClients()[_0x2a9940(0xee)](_0x4f18d8=>{const _0x11728f=_0x2a9940;getSocket(_0x4f18d8['id'])[_0x11728f(0x12c)](_0x11728f(0xa2),{'access':{'allow':![],'reason':_0x11728f(0x221),'token':null}});});}function updateSetting(_0x184897,_0x516c89){const _0x5b9738=_0x3715e9;dbSettings[_0x5b9738(0x1f1)]('settings.'+_0x184897,_0x516c89)[_0x5b9738(0xd3)](),settings=getSettings(),io['to'](_0x5b9738(0x109))[_0x5b9738(0x12c)](_0x5b9738(0x1a6),cleanSettings());}function storeSecure(_0x1a7b89){const _0x2d552e=_0x3715e9;dbSecure[_0x2d552e(0x99)](_0x2d552e(0x10c))[_0x2d552e(0x1af)](_0x1a7b89)[_0x2d552e(0xd3)](),secure=_0x1a7b89;}function addBlacklist(_0x552d24){const _0x4f2a29=_0x3715e9;cleanBlacklist();let _0x3e3fbd;devices[_0x552d24]['telegramIpApproval']?_0x3e3fbd=Math[_0x4f2a29(0x131)](devices[_0x552d24][_0x4f2a29(0x1e8)][_0x4f2a29(0xfb)],loginExpiry):_0x3e3fbd=loginExpiry,dbSecure[_0x4f2a29(0x99)]('blacklist')[_0x4f2a29(0x1af)]({'expiry':new Date()['getTime']()+_0x3e3fbd*0x3c*0x3e8,'token':devices[_0x552d24][_0x4f2a29(0xbf)]['token']})[_0x4f2a29(0xd3)](),blacklist=dbSecure['get'](_0x4f2a29(0xf3))['value']();}function cleanBlacklist(){const _0x218a1b=_0x3715e9;let _0x33f011=dbSecure[_0x218a1b(0x99)](_0x218a1b(0xf3))[_0x218a1b(0x9a)]()[_0x218a1b(0x209)](),_0x15dff1=new Date()['getTime']();_0x33f011[_0x218a1b(0xee)](_0x5b957d=>{const _0x31b9db=_0x218a1b;_0x5b957d[_0x31b9db(0xfb)]<_0x15dff1&&dbSecure[_0x31b9db(0x99)](_0x31b9db(0xf3))['remove']({'expiry':_0x5b957d[_0x31b9db(0xfb)]})[_0x31b9db(0xd3)]();});}function initStates(){let _0xf7779a=getConfiguration();_0xf7779a['forEach'](_0x23ac22=>{const _0x207f14=_0x54f1;_0x23ac22[_0x207f14(0x196)]='stopped';}),storeConfiguration(_0xf7779a);}function onKeys(){const _0x50c3dd=new RSA();return new Promise(_0x46b137=>{const _0x35d51c=_0x54f1;_0x50c3dd[_0x35d51c(0xc3)]()['then'](_0x2474ef=>{_0x46b137(_0x2474ef);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1dd78a=_0x3715e9;let _0x48172a=getSettings(),_0xb6220d=![];!_0x48172a[_0x1dd78a(0x229)](_0x1dd78a(0x11a))&&(_0x48172a[_0x1dd78a(0x11a)]=0x0,_0xb6220d=!![]);!_0x48172a['hasOwnProperty'](_0x1dd78a(0x15b))&&(_0x48172a[_0x1dd78a(0x15b)]=0x0,_0xb6220d=!![]);!_0x48172a['hasOwnProperty'](_0x1dd78a(0x156))&&(_0x48172a[_0x1dd78a(0x156)]=_0x1dd78a(0x184),_0xb6220d=!![]);if(_0xb6220d)storeSettings(_0x48172a);}function storeConfiguration(_0x329275){const _0x3976f3=_0x3715e9;dbConfig[_0x3976f3(0x99)]('bots')[_0x3976f3(0x18e)]()[_0x3976f3(0xd3)](),_0x329275[_0x3976f3(0xee)](_0x582514=>{const _0xd2209a=_0x3976f3;delete _0x582514[_0xd2209a(0x10e)];}),dbConfig['get'](_0x3976f3(0x21b))['push'](..._0x329275)[_0x3976f3(0xd3)](),config=_0x329275;}function resetPassword(){const _0x4ef235=_0x3715e9;tgBot&&settings[_0x4ef235(0x1b6)]&&(tgBot[_0x4ef235(0x185)](_0x4ef235(0xec)),tgBot['sendMessage'](settings[_0x4ef235(0x1b6)],_0x4ef235(0x1c7),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x4ef235(0x1ab)},{'text':'no','callback_data':'no'}]]}})[_0x4ef235(0xdb)](_0x5e286c=>{telegramError(_0x5e286c);}),tgBot['on'](_0x4ef235(0xec),async _0x368150=>{const _0x2488b7=_0x4ef235,_0x5e680e=_0x368150[_0x2488b7(0x97)],_0x42409e=_0x368150[_0x2488b7(0x14f)];tgBot[_0x2488b7(0x188)](_0x368150['id'])[_0x2488b7(0xcd)](async()=>{const _0x43f93d=_0x2488b7;if(_0x5e680e!='no'){const _0x523547=0xf,_0x33b7f3=_0x43f93d(0x16e),_0x1a7b30=Array[_0x43f93d(0x11d)](crypto[_0x43f93d(0xca)](new Uint32Array(_0x523547)))[_0x43f93d(0x146)](_0x19fa4b=>_0x33b7f3[_0x19fa4b%_0x33b7f3['length']])[_0x43f93d(0xbd)](''),_0x262fe4=bcrypt[_0x43f93d(0x231)](_0x1a7b30,saltRounds);storeSettings({'bbPassword':_0x262fe4}),await tgBot[_0x43f93d(0x19c)](_0x42409e['chat']['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x1a7b30,{'parse_mode':_0x43f93d(0x20c)})['catch'](_0xd3fc20=>{telegramError(_0xd3fc20);});}else await tgBot[_0x43f93d(0x19c)](_0x42409e[_0x43f93d(0x170)]['id'],_0x43f93d(0x193))[_0x43f93d(0xdb)](_0xd1c356=>{telegramError(_0xd1c356);});}),tgBot[_0x2488b7(0x185)](_0x2488b7(0xec));}));}async function confirmRestore(_0xebfe53,_0x587135){const _0x2b5e6b=_0x3715e9;tgBot&&settings[_0x2b5e6b(0x1b6)]&&(tgBot[_0x2b5e6b(0x185)]('callback_query'),await tgBot['sendMessage'](settings[_0x2b5e6b(0x1b6)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':_0x2b5e6b(0x20c),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x2b5e6b(0x1ab)},{'text':'no','callback_data':'no'}]]}})[_0x2b5e6b(0xdb)](_0x1340de=>{telegramError(_0x1340de);}),tgBot['on'](_0x2b5e6b(0xec),async _0x29b06d=>{const _0xdcbd5c=_0x2b5e6b,_0x329a88=_0x29b06d[_0xdcbd5c(0x97)],_0x53a52d=_0x29b06d[_0xdcbd5c(0x14f)];tgBot[_0xdcbd5c(0x188)](_0x29b06d['id'])['then'](async()=>{const _0x20097a=_0xdcbd5c;_0x329a88!='no'?(await tgBot[_0x20097a(0x19c)](_0x53a52d[_0x20097a(0x170)]['id'],_0x20097a(0x16c),{'parse_mode':_0x20097a(0x20c)})['catch'](_0x17209c=>{telegramError(_0x17209c);}),unzipFile(_0xebfe53,_0x587135)):await tgBot[_0x20097a(0x19c)](_0x53a52d[_0x20097a(0x170)]['id'],_0x20097a(0x134))[_0x20097a(0xdb)](_0x1d397a=>{telegramError(_0x1d397a);});}),tgBot[_0xdcbd5c(0x185)](_0xdcbd5c(0xec));}));}function getServerTime(){const _0x3319b7=_0x3715e9,_0x4a12a8=new Date();return _0x4a12a8[_0x3319b7(0x137)]()+'/'+(_0x4a12a8['getMonth']()+0x1)[_0x3319b7(0x1cd)]()[_0x3319b7(0xa1)](0x2,'0')+'/'+_0x4a12a8['getDate']()[_0x3319b7(0x1cd)]()[_0x3319b7(0xa1)](0x2,'0')+'\x20'+_0x4a12a8[_0x3319b7(0xc9)]()[_0x3319b7(0x1cd)]()[_0x3319b7(0xa1)](0x2,'0')+':'+_0x4a12a8[_0x3319b7(0x1d9)]()[_0x3319b7(0x1cd)]()['padStart'](0x2,'0')+':'+_0x4a12a8[_0x3319b7(0x14e)]()[_0x3319b7(0x1cd)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x3e756a=_0x3715e9,_0x1b925b=shiftedTime();return _0x1b925b['getFullYear']()+'/'+(_0x1b925b[_0x3e756a(0x8d)]()+0x1)[_0x3e756a(0x1cd)]()[_0x3e756a(0xa1)](0x2,'0')+'/'+_0x1b925b[_0x3e756a(0x149)]()['toString']()[_0x3e756a(0xa1)](0x2,'0')+'\x20'+_0x1b925b[_0x3e756a(0xc9)]()['toString']()['padStart'](0x2,'0')+':'+_0x1b925b[_0x3e756a(0x1d9)]()['toString']()['padStart'](0x2,'0')+':'+_0x1b925b[_0x3e756a(0x14e)]()[_0x3e756a(0x1cd)]()[_0x3e756a(0xa1)](0x2,'0');}function shiftedTime(){const _0x152f1a=_0x3715e9,_0x4681eb=new Date();let _0x555f32=_0x4681eb;if(settings[_0x152f1a(0x127)]&&settings['timeshift']!==0x0)_0x555f32=fns[_0x152f1a(0x8e)](_0x4681eb,{'hours':settings[_0x152f1a(0x127)]});return _0x555f32;}function startScheduler(){const _0x43db7b=_0x3715e9,_0x5a43e8=new Date()[_0x43db7b(0x179)](),_0x4605ac=shiftedTime()[_0x43db7b(0xc9)]();_0x4605ac==0x4&&backupConfigFiles();_0x4605ac==0x0&&rotateLogFiles();_0x5a43e8%0x6==0x0&&triggerAnalytics();_0x5a43e8%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function backupConfigFiles(){const _0x188785=_0x3715e9;fs[_0x188785(0x1e9)](configpath,{'withFileTypes':!![]})['forEach'](_0x31d653=>{const _0x156587=_0x188785;if(!_0x31d653[_0x156587(0xb9)]())fs[_0x156587(0xed)](configpath+_0x31d653[_0x156587(0x214)],configbackuppath+_0x31d653[_0x156587(0x214)]);});}function rotateLogFiles(){const _0x20032e=_0x3715e9,_0x260c53=fs[_0x20032e(0x22f)](logspath+'output-000.log'),_0x10b8cc=_0x260c53[_0x20032e(0x9e)]/0x400;if(_0x10b8cc>0x32){let _0x1d6f49=fs[_0x20032e(0x1e9)](logspath,{'withFileTypes':!![]});_0x1d6f49[_0x20032e(0x1f8)]((_0x4fb074,_0x162337)=>_0x4fb074[_0x20032e(0x214)]<_0x162337[_0x20032e(0x214)]?0x1:_0x162337[_0x20032e(0x214)]<_0x4fb074[_0x20032e(0x214)]?-0x1:0x0),_0x1d6f49[_0x20032e(0xee)](_0x347d85=>{const _0x5c7353=_0x20032e;if(_0x347d85[_0x5c7353(0x214)]==_0x5c7353(0x10b))fs['copyFileSync'](logspath+_0x347d85['name'],logspath+_0x5c7353(0x1bc));if(_0x347d85[_0x5c7353(0x214)]=='output-001.log')fs['copyFileSync'](logspath+_0x347d85['name'],logspath+'output-002.log');_0x347d85[_0x5c7353(0x214)]=='output-000.log'&&(fs[_0x5c7353(0xed)](logspath+_0x347d85[_0x5c7353(0x214)],logspath+_0x5c7353(0xb3)),fs[_0x5c7353(0x1f3)](logspath+_0x347d85[_0x5c7353(0x214)],''));});}}async function zipFiles(_0x4b2071){const _0x1d6d69=_0x3715e9;let _0x2aab08;if(_0x4b2071==_0x1d6d69(0x1d4))_0x2aab08=logspath;if(_0x4b2071==_0x1d6d69(0x22c))_0x2aab08=configpath;let _0x4da19e=fs['readdirSync'](_0x2aab08,{'withFileTypes':!![]});const _0x573aea=new require(_0x1d6d69(0x1aa))();_0x4da19e[_0x1d6d69(0xee)](_0x5d6be1=>{const _0x3ee18c=_0x1d6d69;if(!_0x5d6be1[_0x3ee18c(0xb9)]()){let _0x296a7d=fs[_0x3ee18c(0x1f7)](_0x2aab08+_0x5d6be1['name']);const _0x3376b7=/^bot-[0-9]{3}-config.json$/,_0x496bd5=_0x3376b7[_0x3ee18c(0x21a)](_0x5d6be1[_0x3ee18c(0x214)]);if(_0x496bd5){const _0x37ff4c=JSON['parse'](_0x296a7d);_0x37ff4c['bot'][0x0][_0x3ee18c(0x152)]='***',_0x37ff4c[_0x3ee18c(0x1d6)][0x0][_0x3ee18c(0xac)]='***',_0x296a7d=JSON[_0x3ee18c(0x1c0)](_0x37ff4c,null,0x2);}if(_0x5d6be1[_0x3ee18c(0x214)]==_0x3ee18c(0x135)){const _0x4a82d1=JSON['parse'](_0x296a7d);if(_0x4a82d1[_0x3ee18c(0x1a6)][_0x3ee18c(0xf1)])_0x4a82d1[_0x3ee18c(0x1a6)]['loginRequired']=![];if(_0x4a82d1[_0x3ee18c(0x1a6)][_0x3ee18c(0x92)])_0x4a82d1[_0x3ee18c(0x1a6)][_0x3ee18c(0x92)]=_0x3ee18c(0x124);if(_0x4a82d1['settings'][_0x3ee18c(0xb0)])_0x4a82d1['settings']['telegramToken']=_0x3ee18c(0x124);if(_0x4a82d1[_0x3ee18c(0x1a6)][_0x3ee18c(0x1b6)])_0x4a82d1[_0x3ee18c(0x1a6)][_0x3ee18c(0x1b6)]=null;_0x296a7d=JSON['stringify'](_0x4a82d1,null,0x2);}if(_0x5d6be1['name']!=_0x3ee18c(0x1f6))_0x573aea[_0x3ee18c(0x13e)](_0x5d6be1['name'],_0x296a7d);}});const _0x27e6f8=_0x573aea[_0x1d6d69(0x1f4)]({'base64':![],'compression':_0x1d6d69(0x151)});fs['writeFileSync'](zippath+(_0x4b2071+'.zip'),_0x27e6f8,'binary');}async function unzipFile(_0xeafd8e,_0x2b8e6a){const _0x559210=_0x3715e9;await backupConfigFiles(),fs[_0x559210(0x1e9)](configpath,{'withFileTypes':!![]})[_0x559210(0xee)](_0x4cce0a=>{const _0xb5b77a=_0x559210;if(!_0x4cce0a['isDirectory']())fs[_0xb5b77a(0x165)](configpath+_0x4cce0a['name']);});const _0x400f7f=fs['readFileSync'](_0xeafd8e+_0x2b8e6a,_0x559210(0x1e1)),_0x34d2dc=new require(_0x559210(0x1aa))(_0x400f7f,{'base64':![],'checkCRC32':!![]});Object[_0x559210(0x18f)](_0x34d2dc[_0x559210(0x187)])[_0x559210(0xee)](_0x33e351=>{const _0x33329b=_0x559210,_0x4c50d1=_0x34d2dc['files'][_0x33e351];fs[_0x33329b(0x1f3)](configpath+_0x4c50d1[_0x33329b(0x214)],_0x4c50d1[_0x33329b(0x14c)]);}),fs[_0x559210(0x1e9)](temppath,{'withFileTypes':!![]})[_0x559210(0xee)](_0x209657=>{const _0x3418f9=_0x559210;if(!_0x209657[_0x3418f9(0xb9)]())fs[_0x3418f9(0x165)](temppath+_0x209657[_0x3418f9(0x214)]);}),process[_0x559210(0x96)]({'restore':!![]},_0x391774=>{});}async function getPublicIp(){try{const _0x47e511=await axios['get']('https://api.ipify.org?format=json');publicip=_0x47e511['data']['ip'];}catch(_0x74a787){}}async function triggerAnalytics(){const _0x4f7705=_0x3715e9;if(!publicip)await getPublicIp();const _0x324d10=getBotsWithMode();let _0x5ce413=0x0;_0x324d10['forEach'](_0x66b411=>{if(_0x66b411['status']==='enabled')_0x5ce413++;}),mixpanel[_0x4f7705(0x1cb)](_0x4f7705(0x100),{'distinct_id':settings[_0x4f7705(0x223)],'ip':publicip,'version':serverversion,'numbots':_0x324d10[_0x4f7705(0x178)],'numbotsenabled':_0x5ce413});}async function getMessages(){const _0x428b12=_0x3715e9,_0x4f60aa='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x3e9f6f=new GraphQLClient(_0x4f60aa),_0x4bdc64={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x5c12a3=serverversion['split']('.'),_0x229fd3=_0x5c12a3[0x0]+'.'+_0x5c12a3[0x1],_0x1c85b3=Math['min'](settings[_0x428b12(0x11a)],settings[_0x428b12(0x15b)]),_0x5b482b={'last':parseInt(_0x1c85b3),'bbm':_0x229fd3},_0x2ae24b=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x366da1;try{_0x366da1=await _0x3e9f6f[_0x428b12(0x1e6)](_0x2ae24b,_0x5b482b,_0x4bdc64);}catch(_0x534e4c){}if(_0x366da1&&_0x366da1[_0x428b12(0x125)]){let _0x471678=settings[_0x428b12(0x11a)];newMessages=[];for(const _0x402ec1 of _0x366da1[_0x428b12(0x125)]){newMessages[_0x428b12(0x1af)](_0x402ec1);if(_0x402ec1[_0x428b12(0x20d)])updateSetting('latestversion',_0x402ec1[_0x428b12(0x20d)]);let _0x307f59=_0x402ec1[_0x428b12(0x20d)]?serverversion>=_0x402ec1[_0x428b12(0x20d)]:![];if(!_0x307f59&&_0x402ec1[_0x428b12(0x101)]>_0x471678){if(_0x402ec1[_0x428b12(0x10f)]==='any'||serverversion[_0x428b12(0x1da)](_0x402ec1['bbvReceive'])){let _0x519b46=''+_0x402ec1[_0x428b12(0x1b2)]+'\x0a\x0a'+_0x402ec1['message'];const _0x4f24f6=await sendTelegramMsg(toTelegramMarkdown(_0x519b46),_0x428b12(0x1d1));if(_0x4f24f6)_0x471678=_0x402ec1[_0x428b12(0x101)];}}}updateAvailable=isNewerVersion(settings[_0x428b12(0x156)],serverversion),updateSetting(_0x428b12(0x11a),_0x471678),emitMessages();}}function emitMessages(){const _0x92be80=_0x3715e9,_0x154c43=settings[_0x92be80(0x15b)];let _0x328763=[];newMessages['forEach'](_0x440f70=>{const _0x5b340b=_0x92be80;_0x440f70[_0x5b340b(0x101)]>_0x154c43&&_0x328763[_0x5b340b(0x1af)](_0x440f70);}),_0x328763[_0x92be80(0x178)]>0x0&&getAllClients()['forEach'](_0x2dbbc0=>{const _0x2085d9=_0x92be80;getSocket(_0x2dbbc0['id'])['emit'](_0x2085d9(0x14f),_0x328763);});}function confirmMessage(_0x2c9223){const _0x573980=_0x3715e9;updateSetting(_0x573980(0x15b),Number(_0x2c9223));}function isNewerVersion(_0x39cfb7,_0xd6ca74){const _0x893a6b=_0x3715e9,_0x5506a7=_0xd6ca74[_0x893a6b(0xe2)]('.'),_0x41ccc2=_0x39cfb7['split']('.');for(var _0xf01d2a=0x0;_0xf01d2a<_0x41ccc2[_0x893a6b(0x178)];_0xf01d2a++){const _0x452896=~~_0x41ccc2[_0xf01d2a],_0xbbd504=~~_0x5506a7[_0xf01d2a];if(_0x452896>_0xbbd504)return!![];if(_0x452896<_0xbbd504)return![];}return![];}function toTelegramMarkdown(_0x2a1ec3){const _0x1e4604=_0x3715e9,_0x3aad47=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x22de23=/\*{2}(.+?)\*{2}/gim;return _0x2a1ec3=_0x2a1ec3[_0x1e4604(0xfe)](_0x3aad47,_0x1e4604(0xd5))['replace'](_0x22de23,'*$1*'),_0x2a1ec3;}async function validateConfigFile(){const _0x2b1731=_0x3715e9,_0x30d64f=dbConfig['get'](_0x2b1731(0x21b))[_0x2b1731(0x232)](_0x2b1731(0xe4))['value']()||[];if(_0x30d64f[_0x2b1731(0x178)]==0x0){let _0x14df1c=0x0,_0xeffeb4=[];const _0x377c44=/^bot-([0-9]{3})-config.json$/,_0x384ddc=fs['readdirSync'](configpath);_0x384ddc[_0x2b1731(0xee)](_0x235ce8=>{const _0x4fb850=_0x2b1731,_0x231a7b=_0x377c44[_0x4fb850(0x13a)](_0x235ce8);if(_0x231a7b){const _0x53196d=_0x231a7b[0x1];let _0x2031f6=getBotAttributes(_0x53196d);_0xeffeb4['push']({'botID':_0x53196d,'botname':_0x2031f6[_0x4fb850(0x1cc)],'status':_0x4fb850(0x111),'live':_0x4fb850(0xe1)}),_0x14df1c++;}}),_0x14df1c!=0x0&&(dbConfig[_0x2b1731(0x99)](_0x2b1731(0x21b))['assign'](_0xeffeb4)[_0x2b1731(0xd3)](),config=_0xeffeb4,restoredConfigFile=_0x14df1c);}}async function restoreConfigNotify(_0x451d0e){const _0x160519=_0x3715e9;let _0x3e1ae1;if(restoredConfigFile==0x1)_0x3e1ae1=_0x160519(0x16f);else _0x3e1ae1=_0x160519(0x1a8);if(_0x451d0e)io['to']('botmanager')[_0x160519(0x12c)](_0x160519(0x208),_0x3e1ae1);else{logger[_0x160519(0x1ee)](_0x160519(0x157)),logger[_0x160519(0x1ee)](_0x3e1ae1),logger[_0x160519(0x1ee)](_0x160519(0x157)),logger[_0x160519(0x1ee)]('');if(tgBot&&settings[_0x160519(0x1b6)]&&settings[_0x160519(0x1fd)]!=_0x160519(0xab))tgBot[_0x160519(0x19c)](settings[_0x160519(0x1b6)],_0x160519(0x1db)+_0x3e1ae1)['catch'](_0x31653b=>{telegramError(_0x31653b);});}}function validateCredentials(_0x12e471,_0x57e907){const _0x472ffa=_0x3715e9;if(_0x12e471[_0x472ffa(0xf4)]==settings[_0x472ffa(0x189)]&&bcrypt[_0x472ffa(0x173)](_0x12e471[_0x472ffa(0x1a4)],settings[_0x472ffa(0x92)])){if(settings[_0x472ffa(0x197)])return{'allow':![],'reason':_0x472ffa(0xd4),'token':null};else{const _0x9ef524=generateLoginToken(_0x57e907);return{'allow':!![],'reason':_0x472ffa(0xd8),'token':_0x9ef524};}}else return{'allow':![],'reason':_0x472ffa(0x122),'token':null};}function refreshToken(_0x15fc01){const _0xb95a04=_0x3715e9,_0x2f2a8e=generateLoginToken(_0x15fc01);return{'allow':!![],'reason':_0xb95a04(0xd8),'token':_0x2f2a8e};}function validateAccess(_0x49ec6c,_0xf84ee4,_0x10fb6b){const _0x5a08b0=_0x3715e9,_0x446a87=_0x10fb6b?_0x10fb6b:devices[_0xf84ee4]['ip'];let _0x163564;const _0x780f2e=_0x4e1219=>{const _0x5d8aad=_0x54f1;if(settings['loginRequired']){if(settings['f2aRequired']){if(telegram2FaApproved(_0xf84ee4)){const _0x71d05d=generateLoginToken(_0xf84ee4);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x71d05d};}else return{'allow':![],'reason':_0x5d8aad(0x21c),'token':null};}else return _0x163564=validToken(_0x4e1219,_0xf84ee4),_0x163564[_0x5d8aad(0x229)](_0x5d8aad(0xf5))?{'allow':!![],'reason':_0x5d8aad(0x18a),'token':_0x4e1219}:{'allow':![],'reason':_0x5d8aad(0x21c),'token':null};}else return{'allow':!![],'reason':_0x5d8aad(0x164),'token':null};};if(settings['whitelistEnabled']){let _0x122e83=[...settings['whitelist'],_0x5a08b0(0xb2),_0x5a08b0(0x1e2),_0x5a08b0(0x110)];if(_0x122e83[_0x5a08b0(0xcb)](_0x446a87))return _0x780f2e(_0x49ec6c);else{_0x163564=validToken(_0x49ec6c,_0xf84ee4);if(_0x163564[_0x5a08b0(0x229)]('success'))return _0x780f2e(_0x49ec6c);else{if(telegramIpApproved(_0xf84ee4)){const _0x492d37=generateToken(_0xf84ee4);return _0x163564=_0x780f2e(_0x49ec6c),_0x163564[_0x5a08b0(0x1d0)]?{'allow':!![],'reason':_0x5a08b0(0x163),'token':_0x492d37}:_0x163564;}else return settings[_0x5a08b0(0x22a)]?{'allow':![],'reason':_0x5a08b0(0x148),'token':null}:{'allow':![],'reason':_0x5a08b0(0x9c),'token':null};}}}else return _0x780f2e(_0x49ec6c);}function timelyDecrypt(_0x1aa776,_0x23a4e6=!![]){const _0x35f685=_0x3715e9;if(_0x1aa776)try{const _0x5580e5=crypt['decrypt'](secure[_0x35f685(0x1bb)],_0x1aa776)[_0x35f685(0x14f)],_0x3e1cdb=_0x5580e5['split']('@')[0x0],_0x211716=_0x5580e5[_0x35f685(0xe2)]('@')[0x1],_0x2369cb=new Date()['getTime']();if(_0x23a4e6){if(_0x2369cb-_0x211716<maxSecretAge*0x3e8)return _0x3e1cdb;else return![];}else return _0x3e1cdb;}catch(_0x4c5f24){return![];}else return![];}const validToken=(_0x2a6932,_0x2ee217)=>{const _0x182ffa=_0x3715e9,_0x29c14e=devices[_0x2ee217]['ip'];if(!_0x2a6932)return{'error':'No\x20authentication\x20token'};for(let _0xbed52a of blacklist){if(_0xbed52a['token']==_0x2a6932)return{'error':'Token\x20blacklisted'};}let _0x5235af;try{_0x5235af=jwt[_0x182ffa(0xc7)](_0x2a6932,secure['secret']+_0x2ee217);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x5235af['hasOwnProperty'](_0x182ffa(0x15e))&&!_0x5235af[_0x182ffa(0x229)](_0x182ffa(0xf4))||!_0x5235af[_0x182ffa(0x229)](_0x182ffa(0x118)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x5235af['hasOwnProperty']('username')&&_0x5235af['hasOwnProperty'](_0x182ffa(0x15e))){const {clientip:_0x3d8558}=_0x5235af;return _0x29c14e==_0x3d8558?{'success':_0x182ffa(0x103)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x5235af['hasOwnProperty'](_0x182ffa(0xf4))&&_0x5235af[_0x182ffa(0x229)](_0x182ffa(0x15e))){const {username:_0x42651e,clientip:_0x539082}=_0x5235af;return settings[_0x182ffa(0x189)]==_0x42651e&&_0x29c14e==_0x539082?{'success':_0x182ffa(0x103)}:{'error':_0x182ffa(0x87)};}}},generateLoginToken=_0x3cb431=>{const _0x21cba3=_0x3715e9;if(_0x3cb431){const _0x227741=devices[_0x3cb431]['ip'];return jwt[_0x21cba3(0x153)]({'username':settings[_0x21cba3(0x189)],'clientip':_0x227741},secure[_0x21cba3(0x201)]+_0x3cb431,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0xdafab7=>{const _0x299899=_0x3715e9;if(_0xdafab7){const _0x40520f=devices[_0xdafab7]['ip'];return jwt[_0x299899(0x153)]({'clientip':_0x40520f},secure[_0x299899(0x201)]+_0xdafab7,{'expiresIn':devices[_0xdafab7][_0x299899(0x1e8)][_0x299899(0xfb)]*0x3c});}else return![];},telegramIpApproved=_0x18ae31=>{const _0xcb9014=_0x3715e9;let _0x43416f=![];return devices[_0x18ae31][_0xcb9014(0x1e8)]&&devices[_0x18ae31]['telegramIpApproval']['expiry']!=_0xcb9014(0xd9)&&(_0x43416f=devices[_0x18ae31][_0xcb9014(0x1e8)]['clientip']==devices[_0x18ae31]['ip']&&new Date()[_0xcb9014(0xae)]()-devices[_0x18ae31][_0xcb9014(0x1e8)]['timestamp']<devices[_0x18ae31][_0xcb9014(0x1e8)]['expiry']*0x3c*0x3e8),_0x43416f;},telegram2FaApproved=_0xcfe22d=>{const _0x4d4d2b=_0x3715e9;let _0x39871f=![];return devices[_0xcfe22d][_0x4d4d2b(0x1e3)]&&devices[_0xcfe22d][_0x4d4d2b(0x1e3)][_0x4d4d2b(0xfb)]!='reject'&&(_0x39871f=devices[_0xcfe22d][_0x4d4d2b(0x1e3)][_0x4d4d2b(0x15e)]==devices[_0xcfe22d]['ip']&&new Date()[_0x4d4d2b(0xae)]()-devices[_0xcfe22d]['telegram2FaApproval'][_0x4d4d2b(0xd6)]<devices[_0xcfe22d][_0x4d4d2b(0x1e3)][_0x4d4d2b(0xfb)]*0x3c*0x3e8),_0x39871f;},normalizeIP=_0x208901=>{const _0x384c76=_0x3715e9;let _0x905787=null,_0x5ec83e=null;if(ipaddr[_0x384c76(0x213)](_0x208901)){const _0x4f255e=ipaddr[_0x384c76(0x144)](_0x208901);_0x4f255e[_0x384c76(0xa0)]()===_0x384c76(0x1e0)?(_0x4f255e['isIPv4MappedAddress']()&&(_0x905787=_0x4f255e[_0x384c76(0xf8)]()[_0x384c76(0x1cd)]()),_0x5ec83e=_0x4f255e['toString']()):(_0x905787=_0x4f255e['toString'](),_0x5ec83e=_0x4f255e[_0x384c76(0x19d)]()[_0x384c76(0x1cd)]());}return{'show':_0x905787?_0x905787:_0x5ec83e,'store':_0x5ec83e};};function sleep(_0x22bc27){return new Promise(_0x4f2a15=>setTimeout(_0x4f2a15,_0x22bc27));}