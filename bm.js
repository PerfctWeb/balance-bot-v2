const _0x3b1bde=_0xbd08;(function(_0x8a7d5,_0x253e1c){const _0x5b246f=_0xbd08,_0x15484a=_0x8a7d5();while(!![]){try{const _0x381666=-parseInt(_0x5b246f(0x1ab))/0x1+parseInt(_0x5b246f(0x204))/0x2+-parseInt(_0x5b246f(0x1e9))/0x3+-parseInt(_0x5b246f(0x215))/0x4*(parseInt(_0x5b246f(0x1d2))/0x5)+parseInt(_0x5b246f(0x152))/0x6+parseInt(_0x5b246f(0x227))/0x7+parseInt(_0x5b246f(0x1ae))/0x8;if(_0x381666===_0x253e1c)break;else _0x15484a['push'](_0x15484a['shift']());}catch(_0x5720ac){_0x15484a['push'](_0x15484a['shift']());}}}(_0x2609,0x53b63));const _0x4ec8e8=function(){let _0x1160f0=!![];return function(_0x44d8fa,_0x350259){const _0x2396e7=_0x1160f0?function(){const _0x2a9a84=_0xbd08;if(_0x350259){const _0x26b91d=_0x350259[_0x2a9a84(0x24a)](_0x44d8fa,arguments);return _0x350259=null,_0x26b91d;}}:function(){};return _0x1160f0=![],_0x2396e7;};}(),_0x3953ba=_0x4ec8e8(this,function(){const _0x3a8d3d=_0xbd08;return _0x3953ba[_0x3a8d3d(0x1d6)]()[_0x3a8d3d(0x1c7)]('(((.+)+)+)+$')[_0x3a8d3d(0x1d6)]()[_0x3a8d3d(0x233)](_0x3953ba)[_0x3a8d3d(0x1c7)](_0x3a8d3d(0x206));});_0x3953ba();'use strict';process['env'][_0x3b1bde(0x150)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x3b1bde(0x19e)),low=require(_0x3b1bde(0x209)),FileSync=require('lowdb/adapters/FileSync'),path=require('path'),crypto=require(_0x3b1bde(0x1e1)),Crypt=require(_0x3b1bde(0x25f))['Crypt'],RSA=require(_0x3b1bde(0x25f))['RSA'],bcrypt=require(_0x3b1bde(0x1aa)),jwt=require(_0x3b1bde(0x159)),{Analytics}=require(_0x3b1bde(0x231)),googleAnalyticsV3Plugin=require('@analytics/google-analytics-v3')['default'],ipaddr=require('ipaddr.js'),argv=require(_0x3b1bde(0x1f4))(process[_0x3b1bde(0x10f)][_0x3b1bde(0x169)](0x2))[_0x3b1bde(0x10f)],uuidRandom=require('uuid-random'),Mixpanel=require(_0x3b1bde(0x1b3)),axios=require(_0x3b1bde(0x249)),{GraphQLClient,gql}=require(_0x3b1bde(0x239)),PORT=argv[_0x3b1bde(0x25b)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x3b1bde(0x14e)](PORT)&&(console[_0x3b1bde(0x1c4)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x3b1bde(0x1bd)),process[_0x3b1bde(0x151)](0x1));const HOST=argv[_0x3b1bde(0x1f0)]||null,userID=argv['user']||'';function _0x2609(){const _0x5011f3=['\x20to\x20','restarting\x20Bot\x20','clientip','connection','catch','RSA-OAEP','sendFile','bbUsername','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','unlinkSync','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','2FA\x20required','version','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','build2','privateKey','filter','getUTCHours','sign','loginRequired','No\x20bots\x20running\x20right\x20now','test','Password\x20has\x20been\x20reset\x20to:\x20','NTBA_FIX_319','exit','1335936aUoJmD','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','Unauthorized\x20attempt\x20to\x20delete\x20bot','replace','userid','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','send','jsonwebtoken','generateKeyPairAsync','/off\x20-\x20stop\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20add\x20bot','add-bot','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','Login\x20rejected','User\x20has\x20been\x20validated','headless','SIGTERM','hex','get','secure','-config.json','/:bot','logged\x20out','slice',':\x20Bot\x20Mgr\x20>\x20','disabled\x20Bot\x20','remove','mkdirSync','sortBy','2FA','<b>Balance\x20Bot\x20Status:</b>\x0a','telegramToken','bbvNew','/restart\x20-\x20restart\x20bot(s)\x0a','store','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Unauthorized\x20login\x20attempt\x20(timeout)','enabled','reject','remoteAddress','Your\x20installation\x20is\x20already\x20up\x20to\x20date','127.0.0.1','settings','allow','live','Ok,\x20will\x20send\x20alert\x20notifications\x20only','randomBytes','/enable\x20-\x20enable\x20notifications\x0a','update-bot','botmanager','botID','existsSync','https://hodlerhacks.com','Bot\x20','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','blacklist','entries','keys','join','0.0.0','notification','1000','telegramUsername','Markdown','removeAllListeners','************','orders','<b>Telegram\x20Bot\x20Status:</b>\x0a','from','telegrammsg','temporaryAccessAllowed','hashSync','Unauthorized\x20attempt\x20to\x20log\x20out','token','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','date-fns','headers','\x20|\x20','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Invalid\x20IP\x20address','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','push','verify','Balance\x20Bot\x20Server','Notifications\x20enabled','bcryptjs','247355ECNcrD','lastmsgtelegram','Orders','548256oCZgmB','split','/:bot/performance','delete-alerts','store-headless','mixpanel','getStartingBalances','number','write','password','then','/:bot/support','map','apiKey','*$1*',',\x20must\x20be\x20a\x204\x20digit\x20number','use','build','invalid\x20credentials','starting\x20bot\x20|\x20Bot\x20','request','Invalid\x20Telegram\x20token','log','\x20only\x0a','/help\x20-\x20show\x20available\x20commands\x0a','search','Notifications\x20enabled\x0a','show','getPortfolio','accept','toggle-bot-mode','success','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','add','telegramIpApproval','express','5JnqbLC','expiry','-results.json','bot.js','toString','access\x20timeout','Unauthorized\x20attempt\x20to\x20update\x20settings','Invalid\x20authentication\x20token\x20(2)','decrypt','getDate','chat','Starting\x20Balance\x20Bot\x20update','find','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','clients','crypto','removeListener','includes','readFileSync','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','login\x20not\x20required','once','publicKey','1347984yuQIVt','function','fork','f2aRequired','callback_query','title','5\x20min','host','disabled','match','All\x20bots','yargs/yargs','kill','sockets','page','data','botname','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','ipv6','Unauthorized\x20attempt\x20to\x20confirm\x20message','assign','login\x20token\x20valid','yes','30\x20min','running','new','hasOwnProperty','997544OXmvrH','exp','(((.+)+)+)+$','sendMessage','Temporary\x20access\x20rejected','lowdb','track','error','initclient','compareSync','telegramChatId','parse','bbPassword','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','access','login\x20required','Unauthorized\x20attempt\x20to\x20get\x20portfolio','1608284JUNFJt','timeshift','cancel-loading',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','messages','bots','inherit','https://api.ipify.org?format=json','Ok,\x20will\x20send\x20order\x20notifications\x20only','username','telegram2FaApproval','emitHistory','timestamp','answerCallbackQuery','getTime','placeOrder','</b>\x20?','store-configuration','4561739CGZkFK','all','sha256','/update\x20-\x20update\x20Balance\x20Bot\x0a','bb/','encryptedUuid','store-settings','updatebotmanager','handshake','init','analytics','getSeconds','constructor','whitelistEnabled','bot','static','createServer','reload','graphql-request','Server','type','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Balance\x20Bot','Invalid\x20username\x20or\x20IP\x20address','listen','http','disconnect','temporary\x20access\x20rejected','/disable\x20-\x20disable\x20notifications\x0a','HTML','padStart','/names\x20-\x20show\x20bot\x20names\x0a','reset-password','manual','axios','apply','reason','getMonth','No\x20authentication\x20token','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','confirm-message','forEach','new-disabled','index.html','::1','mode','telegramEvents','/:bot/coins','\x20>\x20','deleted\x20Bot\x20','whitelist','latestversion','port','emit','-----------------------------------------------------------------------------------','Unauthorized\x20attempt\x20to\x20update\x20bot','hybrid-crypto-js','args','UA-192771731-1','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','value','started','defaults','uuid','polling_error','2FA\x20login\x20required','login','update-bb','logout','6b67f3d61ee94b8f5c80b4affef4c4d9','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','alerts','2FA\x20login\x20token\x20generated','isIPv4MappedAddress','telegramEnabled','enabled\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20messages','::ffff:127.0.0.1','temporary\x20token\x20generated','stopPolling','Unauthorized\x20attempt\x20to\x20store\x20configuration','Allow\x20login\x20from\x20IP\x20address\x20<b>','15\x20min','onText','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Password\x20reset\x20rejected','showname','referer','max','pidRefreshToken','argv','SIGINT','Unauthorized\x20attempt\x20to\x20delete\x20alerts','stopped','status','Alerts','place-order','isDirectory','login\x20token\x20generated','Bot\x20Mgr\x20>\x20','stop','socket.io','Yes','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','bbvReceive','secret','storeConfiguration','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','2FA\x20login\x20rejected','bb-settings.json','copyFileSync','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','getHours','All','All\x20bots\x20running\x20right\x20now','kind','bot-','auto','pidExpireLogin','length','alias','/:bot/portfolio','toIPv4Address','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','name','lastmsgemitted','toIPv4MappedAddress','message','Notifications\x20disabled\x0a','Invalid\x20authentication\x20token\x20(1)','getMinutes'];_0x2609=function(){return _0x5011f3;};return _0x2609();}let bbpath=_0x3b1bde(0x22b),bbpath2='';const botfile=_0x3b1bde(0x1d5),configfile='bb-config.json',settingsfile=_0x3b1bde(0x122),securefile='bb-secure.json';let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3b1bde(0x1e0)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+'config/',configbackuppath=configpath+'backup/';!fs[_0x3b1bde(0x185)](configpath)&&fs[_0x3b1bde(0x16d)](configpath);!fs[_0x3b1bde(0x185)](configbackuppath)&&fs[_0x3b1bde(0x16d)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x3b1bde(0xf3)]({'bots':[]})[_0x3b1bde(0x1b6)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3b1bde(0xf3)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x3b1bde(0x18e)}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);function _0xbd08(_0x27e95e,_0x6efa69){const _0x45caf0=_0x2609();return _0xbd08=function(_0x3953ba,_0x4ec8e8){_0x3953ba=_0x3953ba-0xf1;let _0x2609a8=_0x45caf0[_0x3953ba];return _0x2609a8;},_0xbd08(_0x27e95e,_0x6efa69);}dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x3b1bde(0x229),'rsaStandard':_0x3b1bde(0x13e)});const saltRounds=0xa,mixpanel=Mixpanel[_0x3b1bde(0x230)](_0x3b1bde(0xfa),{'host':'api-eu.mixpanel.com'}),analytics=Analytics({'app':_0x3b1bde(0x23d),'plugins':[googleAnalyticsV3Plugin({'trackingId':_0x3b1bde(0x261)})]});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x3b1bde(0x145)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x3b1bde(0x1d1)),app=express(),http=require(_0x3b1bde(0x240))[_0x3b1bde(0x237)](app);app[_0x3b1bde(0x1be)](express[_0x3b1bde(0x236)](path[_0x3b1bde(0x18d)](__dirname,bbpath2,_0x3b1bde(0x147)))),app[_0x3b1bde(0x1be)](express['static'](path[_0x3b1bde(0x18d)](__dirname,bbpath2,'build'))),app[_0x3b1bde(0x164)]('/',function(_0x1fe151,_0x58a607){const _0x1fc2bd=_0x3b1bde;_0x58a607['sendFile'](path[_0x1fc2bd(0x18d)](__dirname,bbpath2,_0x1fc2bd(0x147),_0x1fc2bd(0x252)));}),app[_0x3b1bde(0x164)](_0x3b1bde(0x167),function(_0x51689d,_0x492736){const _0x4c41b1=_0x3b1bde;_0x492736[_0x4c41b1(0x13f)](path[_0x4c41b1(0x18d)](__dirname,bbpath2,'build',_0x4c41b1(0x252)));}),app[_0x3b1bde(0x164)](_0x3b1bde(0x12f),(_0x28f3df,_0x5c5f72)=>{const _0x122cd2=_0x3b1bde;_0x5c5f72[_0x122cd2(0x13f)](path['join'](__dirname,bbpath2,_0x122cd2(0x1bf),_0x122cd2(0x252)));}),app[_0x3b1bde(0x164)](_0x3b1bde(0x1b0),(_0xe0cf4f,_0x134ad7)=>{const _0xbce559=_0x3b1bde;_0x134ad7[_0xbce559(0x13f)](path[_0xbce559(0x18d)](__dirname,bbpath2,_0xbce559(0x1bf),_0xbce559(0x252)));}),app[_0x3b1bde(0x164)](_0x3b1bde(0x256),(_0x4762c4,_0x1665b7)=>{const _0x37f058=_0x3b1bde;_0x1665b7[_0x37f058(0x13f)](path[_0x37f058(0x18d)](__dirname,bbpath2,_0x37f058(0x1bf),_0x37f058(0x252)));}),app[_0x3b1bde(0x164)]('/:bot/history',(_0x21302e,_0x31723b)=>{const _0x1aee58=_0x3b1bde;_0x31723b[_0x1aee58(0x13f)](path[_0x1aee58(0x18d)](__dirname,bbpath2,'build',_0x1aee58(0x252)));}),app[_0x3b1bde(0x164)]('/:bot/configuration',(_0x4e6abc,_0x2edbe3)=>{const _0x3ef9f5=_0x3b1bde;_0x2edbe3[_0x3ef9f5(0x13f)](path['join'](__dirname,bbpath2,'build',_0x3ef9f5(0x252)));}),app['get'](_0x3b1bde(0x1b9),(_0x32628d,_0x5cc430)=>{const _0x5983a2=_0x3b1bde;_0x5cc430['sendFile'](path[_0x5983a2(0x18d)](__dirname,bbpath2,_0x5983a2(0x1bf),_0x5983a2(0x252)));});if(HOST)http[_0x3b1bde(0x23f)](PORT,HOST);else http[_0x3b1bde(0x23f)](PORT);const io=require(_0x3b1bde(0x11a))(http,{}),TelegramBot=require('node-telegram-bot-api');let tgBot;if(settings['telegramToken']&&settings['telegramToken']!=''&&settings['telegramUsername']&&settings[_0x3b1bde(0x191)]!='')initTelegram();init();async function init(){await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),startServer(),startSocket(),startScheduler(),triggerAnalytics(!![]),getMessages();}function startServer(){const _0x2b6408=_0x3b1bde;console[_0x2b6408(0x1c4)](''),console['log'](_0x2b6408(0x25d)),logging(_0x2b6408(0x125)+PORT),console[_0x2b6408(0x1c4)](_0x2b6408(0x25d));if(config[_0x2b6408(0x12d)]!=0x0)config[_0x2b6408(0x250)](_0x5b1b15=>{const _0x2033bc=_0x2b6408;if(_0x5b1b15[_0x2033bc(0x113)]==_0x2033bc(0x177)||_0x5b1b15[_0x2033bc(0x113)]==_0x2033bc(0x202))logging(_0x2033bc(0x1c1)+_0x5b1b15[_0x2033bc(0x184)]+_0x2033bc(0x1a0)+_0x5b1b15[_0x2033bc(0x1f9)]),startBot([_0x5b1b15[_0x2033bc(0x184)],userID],{'cwd':bbpath},function(_0x34bff5){if(_0x34bff5)logging(_0x34bff5);});else(_0x5b1b15['status']=='disabled'||_0x5b1b15[_0x2033bc(0x113)]==_0x2033bc(0x251))&&logging('idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x5b1b15[_0x2033bc(0x184)]+_0x2033bc(0x1a0)+_0x5b1b15[_0x2033bc(0x1f9)]);});else!newBot&&console[_0x2b6408(0x1c4)](_0x2b6408(0x1e5));if(newBot)addBot();console[_0x2b6408(0x1c4)](_0x2b6408(0x25d)),console[_0x2b6408(0x1c4)]('');}function startSocket(){const _0x2cc12e=_0x3b1bde;io['on'](_0x2cc12e(0x13c),_0x2ab44c=>{const _0xc2c9a7=_0x2cc12e;let _0x2b09d6,_0x42317a,_0x469819,_0x5e1ead,_0x4160fb;const _0x159ad5=_0x2ab44c[_0xc2c9a7(0x22f)][_0xc2c9a7(0x19f)][_0xc2c9a7(0x10c)];_0x42317a=_0x159ad5[_0xc2c9a7(0x1f2)](/bot[0-9]{3}/);if(_0x42317a)_0x469819=_0x42317a[0x0][_0xc2c9a7(0x1f2)](/[0-9]{3}/);if(_0x469819)_0x2b09d6=_0x469819[0x0];else _0x2b09d6=_0xc2c9a7(0x183);const _0xd63a7d=_0x2ab44c['handshake']['auth'][_0xc2c9a7(0x22c)];if(!_0xd63a7d)_0x2ab44c[_0xc2c9a7(0x25c)](_0xc2c9a7(0x113),{'publicKey':secure[_0xc2c9a7(0x1e8)]});else{_0x5e1ead=timelyDecrypt(_0xd63a7d,![]);if(!_0x5e1ead)_0x2ab44c[_0xc2c9a7(0x25c)](_0xc2c9a7(0x113),{'publicKey':secure[_0xc2c9a7(0x1e8)]});else{_0x4160fb=normalizeIP(_0x2ab44c['conn'][_0xc2c9a7(0x179)])[_0xc2c9a7(0x174)];if(!devices[_0x5e1ead])devices[_0x5e1ead]={'uuid':_0x5e1ead,'access':{'token':null}};devices[_0x5e1ead]['ip']=_0x4160fb;const _0x43d9f5=addClient(_0x2ab44c['id'],_0x5e1ead,_0x2b09d6);setAccess(_0x43d9f5),emitMessages(),_0x2ab44c['on'](_0xc2c9a7(0xf7),_0x403784=>{const _0xf24ca2=_0xc2c9a7,_0x415c5c=timelyDecrypt(_0x403784[_0xf24ca2(0x1b7)]);if(_0x415c5c){_0x403784={'username':_0x403784[_0xf24ca2(0x21e)],'password':_0x415c5c},devices[_0x5e1ead][_0xf24ca2(0x212)]=validateCredentials(_0x403784,_0x5e1ead);if(devices[_0x5e1ead][_0xf24ca2(0x212)][_0xf24ca2(0x17d)]==![]&&devices[_0x5e1ead][_0xf24ca2(0x212)][_0xf24ca2(0x24b)]==_0xf24ca2(0xf6))_0x2ab44c[_0xf24ca2(0x25c)](_0xf24ca2(0x113),{'access':devices[_0x5e1ead][_0xf24ca2(0x212)]}),loginAccess2FA(_0x5e1ead,_0x4160fb);else{if(devices[_0x5e1ead][_0xf24ca2(0x212)][_0xf24ca2(0x17d)]==![]&&devices[_0x5e1ead][_0xf24ca2(0x212)][_0xf24ca2(0x24b)]==_0xf24ca2(0x1c0))_0x2ab44c['emit'](_0xf24ca2(0x113),{'access':devices[_0x5e1ead][_0xf24ca2(0x212)]});else devices[_0x5e1ead]['access'][_0xf24ca2(0x17d)]&&devices[_0x5e1ead]['access']['reason']==_0xf24ca2(0x117)&&(getClientsWithUuid(_0x5e1ead)[_0xf24ca2(0x250)](_0x5aaeb2=>{setAccess(_0x5aaeb2);}),setTokenRefresh(_0x5e1ead),setSessionTimeout(_0xf24ca2(0xf7),_0x5e1ead));}}else logging(_0xf24ca2(0x176));}),_0x2ab44c['on'](_0xc2c9a7(0x247),()=>{resetPassword();}),_0x2ab44c['on']('disconnect',_0x2bfdd4=>{removeClient(_0x2ab44c['id']);});}}});}function initClient(_0x516b5d){const _0x3c76c1=_0x3b1bde;if(_0x516b5d!='botmanager'&&config[_0x3c76c1(0x1bb)]!=''){if(pid[_0x516b5d])pid[_0x516b5d]['send']({'function':_0x3c76c1(0x20c),'args':null});}}function getSocket(_0x49662a){const _0x2ce0d4=_0x3b1bde;return io['sockets'][_0x2ce0d4(0x1f6)][_0x2ce0d4(0x164)](_0x49662a);}function setAccess(_0x28680a){const _0x558a2d=_0x3b1bde,_0x5d3d32=getSocket(_0x28680a['id']),_0x41b744=_0x28680a[_0x558a2d(0xf4)],_0x2456ba=_0x28680a[_0x558a2d(0x235)];devices[_0x41b744][_0x558a2d(0x212)]=validateAccess(devices[_0x41b744][_0x558a2d(0x212)]['token'],_0x41b744),_0x5d3d32['join'](_0x41b744);if(devices[_0x41b744][_0x558a2d(0x212)][_0x558a2d(0x17d)]){_0x5d3d32['join'](_0x2456ba);if(_0x2456ba==_0x558a2d(0x183))initializeSocketBotManager(_0x5d3d32);else initializeSocketBot(_0x5d3d32);initClient(_0x2456ba);}devices[_0x41b744][_0x558a2d(0x212)]['token']&&devices[_0x41b744][_0x558a2d(0x212)][_0x558a2d(0x24b)]==_0x558a2d(0x103)&&setSessionTimeout(_0x558a2d(0x16f),_0x41b744),devices[_0x41b744]['access'][_0x558a2d(0x19c)]&&devices[_0x41b744][_0x558a2d(0x212)][_0x558a2d(0x24b)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x558a2d(0xf7),_0x41b744),_0x5d3d32['emit'](_0x558a2d(0x113),{'status':_0x28680a['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x41b744][_0x558a2d(0x212)],'externalip':devices[_0x41b744]['ip'],'publicKey':secure[_0x558a2d(0x1e8)],'userid':settings[_0x558a2d(0x156)],'validInstallation':validInstallation}),devices[_0x41b744]['access'][_0x558a2d(0x17d)]==![]&&devices[_0x41b744][_0x558a2d(0x212)][_0x558a2d(0x24b)]==_0x558a2d(0x144)&&temporaryAccess2FA(_0x41b744,devices[_0x41b744]['ip']);}function setSessionTimeout(_0x223300,_0x462260){const _0x46f85a=_0x3b1bde;let _0x59d89d;if(_0x223300==_0x46f85a(0xf7))_0x59d89d=loginExpiry*0x3c*0x3e8;else _0x59d89d=devices[_0x462260][_0x46f85a(0x1d0)]['expiry']*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x462260][_0x46f85a(0x1d0)][_0x46f85a(0x221)]);if(devices[_0x462260]['pidExpireLogin'])clearTimeout(devices[_0x462260][_0x46f85a(0x12c)]);devices[_0x462260]['pidExpireLogin']=setTimeout(()=>{const _0x543285=_0x46f85a;if(devices[_0x462260]['pidRefreshToken'])clearTimeout(devices[_0x462260]['pidRefreshToken']);removeSocketListeners(_0x462260),addBlacklist(_0x462260),devices[_0x462260]['telegramIpApproval']=null,devices[_0x462260][_0x543285(0x21f)]=null,devices[_0x462260]['access'][_0x543285(0x19c)]=null,devices[_0x462260]['access']=validateAccess(devices[_0x462260][_0x543285(0x212)][_0x543285(0x19c)],_0x462260),!(devices[_0x462260][_0x543285(0x212)][_0x543285(0x17d)]&&devices[_0x462260][_0x543285(0x212)]['reason']==_0x543285(0x1e6))&&(_0x223300==_0x543285(0xf7)?io['to'](_0x462260)[_0x543285(0x25c)](_0x543285(0x113),{'access':{'allow':![],'reason':_0x543285(0x1d7),'token':null}}):io['to'](_0x462260)[_0x543285(0x25c)](_0x543285(0x113),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x462260][_0x543285(0x212)][_0x543285(0x19c)]=null;},_0x59d89d);}function setTokenRefresh(_0x3983af){const _0x18b79b=_0x3b1bde;if(devices[_0x3983af]['pidRefreshToken'])clearTimeout(devices[_0x3983af][_0x18b79b(0x10e)]);devices[_0x3983af][_0x18b79b(0x10e)]=setTimeout(()=>{const _0x409517=_0x18b79b;getClientsWithUuid(_0x3983af)[_0x409517(0x12d)]!=0x0?(devices[_0x3983af][_0x409517(0x212)]=refreshToken(_0x3983af),io['to'](_0x3983af)[_0x409517(0x25c)]('status',{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x3983af]['access'],'externalip':devices[_0x3983af]['ip'],'publicKey':secure[_0x409517(0x1e8)],'validInstallation':validInstallation}),setTokenRefresh(_0x3983af)):clearTimeout(devices[_0x3983af]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x569696){const _0xbec4c2=_0x3b1bde,_0xfcf313=getClient(_0x569696['id'])[_0xbec4c2(0xf4)];_0x569696[_0xbec4c2(0x25c)]('bots',config),_0x569696['emit']('settings',cleanSettings()),_0x569696['on'](_0xbec4c2(0x15d),_0x3ff9a9=>{const _0x3aebfd=_0xbec4c2;if(validateAccess(_0x3ff9a9,_0xfcf313)[_0x3aebfd(0x17d)])addBot();else logging(_0x3aebfd(0x15c));}),_0x569696['on'](_0xbec4c2(0x182),(_0x3ceaad,_0x4cf3d4)=>{const _0x423ca1=_0xbec4c2;if(validateAccess(_0x4cf3d4,_0xfcf313)[_0x423ca1(0x17d)])toggleBot(_0x3ceaad[_0x423ca1(0x184)],_0x3ceaad['status'],_0x3ceaad[_0x423ca1(0x17e)]);else logging('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x569696['on'](_0xbec4c2(0x1cc),(_0x4390eb,_0x28b9c9)=>{const _0x3ad795=_0xbec4c2;if(validateAccess(_0x28b9c9,_0xfcf313)['allow'])toggleBotMode(_0x4390eb);else logging(_0x3ad795(0x25e));}),_0x569696['on']('delete-bot',(_0x9fc858,_0x470250)=>{const _0x3f1fe4=_0xbec4c2;if(validateAccess(_0x470250,_0xfcf313)[_0x3f1fe4(0x17d)])deleteBot(_0x9fc858);else logging(_0x3f1fe4(0x154));}),_0x569696['on'](_0xbec4c2(0x22d),(_0x514ee3,_0x40371d)=>{const _0x1924c2=_0xbec4c2;if(validateAccess(_0x40371d,_0xfcf313)[_0x1924c2(0x17d)])storeSettings(_0x514ee3,!![]);else logging(_0x1924c2(0x1d8));}),_0x569696['on']('update-bb',_0x72deff=>{const _0x3171a8=_0xbec4c2;if(validateAccess(_0x72deff,_0xfcf313)[_0x3171a8(0x17d)])updateBB();else logging(_0x3171a8(0x109));}),_0x569696['on']('get-messages',_0x1e0bca=>{const _0x51f8d2=_0xbec4c2;if(validateAccess(_0x1e0bca,_0xfcf313)[_0x51f8d2(0x17d)])getMessages();else logging(_0x51f8d2(0x101));}),_0x569696['on'](_0xbec4c2(0x24f),(_0x40d8ce,_0x36adea)=>{const _0x17d16d=_0xbec4c2;if(validateAccess(_0x36adea,_0xfcf313)[_0x17d16d(0x17d)])confirmMessage(_0x40d8ce);else logging(_0x17d16d(0x1fc));}),_0x569696['on'](_0xbec4c2(0xf9),_0x777220=>{const _0x98422a=_0xbec4c2;if(validateAccess(_0x777220,_0xfcf313)[_0x98422a(0x17d)]){if(devices[_0xfcf313]['pidRefreshToken'])clearTimeout(devices[_0xfcf313][_0x98422a(0x10e)]);if(devices[_0xfcf313][_0x98422a(0x12c)])clearTimeout(devices[_0xfcf313][_0x98422a(0x12c)]);removeSocketListeners(getClient(_0x569696['id'])[_0x98422a(0xf4)]),addBlacklist(_0xfcf313),devices[_0xfcf313][_0x98422a(0x1d0)]=null,devices[_0xfcf313][_0x98422a(0x21f)]=null,devices[_0xfcf313][_0x98422a(0x212)]['token']=null,io['to'](getClient(_0x569696['id'])[_0x98422a(0xf4)])['emit'](_0x98422a(0x113),{'access':{'allow':![],'reason':_0x98422a(0x168),'token':null}});}else logging(_0x98422a(0x19b));});}function initializeSocketBot(_0x32e9f9){const _0x2efa40=_0x3b1bde,_0x437bbf=getClient(_0x32e9f9['id'])[_0x2efa40(0x235)],_0x5591cd=getClient(_0x32e9f9['id'])[_0x2efa40(0xf4)];_0x32e9f9['on']('get-logs',(_0x966c18,_0x413202)=>{const _0x380cb3=_0x2efa40;if(validateAccess(_0x413202,_0x5591cd)[_0x380cb3(0x17d)]){if(pid[_0x437bbf])pid[_0x437bbf]['send']({'function':_0x380cb3(0x220),'args':_0x966c18});}else logging('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0x32e9f9['on'](_0x2efa40(0x1b1),(_0x26f990,_0x20b7b9)=>{const _0x3337a5=_0x2efa40;if(validateAccess(_0x20b7b9,_0x5591cd)[_0x3337a5(0x17d)]){if(pid[_0x437bbf])pid[_0x437bbf]['send']({'function':'deleteHistoryAlerts','args':_0x26f990});}else logging(_0x3337a5(0x111));}),_0x32e9f9['on']('get-portfolio',(_0x309b15,_0x3fd18c)=>{const _0x4ec440=_0x2efa40;if(validateAccess(_0x3fd18c,_0x5591cd)[_0x4ec440(0x17d)]){if(pid[_0x437bbf])pid[_0x437bbf][_0x4ec440(0x158)]({'function':_0x4ec440(0x1ca),'args':_0x309b15});}else logging(_0x4ec440(0x214));}),_0x32e9f9['on'](_0x2efa40(0x226),(_0x4e72f3,_0x4006c8)=>{const _0x3875f0=_0x2efa40;if(validateAccess(_0x4006c8,_0x5591cd)[_0x3875f0(0x17d)]){if(pid[_0x437bbf])pid[_0x437bbf]['send']({'function':_0x3875f0(0x11f),'args':_0x4e72f3});}else logging(_0x3875f0(0x105));}),_0x32e9f9['on'](_0x2efa40(0x1b2),(_0x52bcd5,_0x56efed)=>{const _0x15d9bd=_0x2efa40;if(validateAccess(_0x56efed,_0x5591cd)[_0x15d9bd(0x17d)]){if(pid[_0x437bbf])pid[_0x437bbf][_0x15d9bd(0x158)]({'function':'storeHeadless','args':_0x52bcd5});}else logging(_0x15d9bd(0x146));}),_0x32e9f9['on']('get-starting-balances',_0x47ccb5=>{const _0x317f52=_0x2efa40;if(validateAccess(_0x47ccb5,_0x5591cd)[_0x317f52(0x17d)]){if(pid[_0x437bbf])pid[_0x437bbf][_0x317f52(0x158)]({'function':_0x317f52(0x1b4),'args':null});}else logging(_0x317f52(0x11c));}),_0x32e9f9['on'](_0x2efa40(0x115),(_0x12825a,_0x53b17b)=>{const _0xa47079=_0x2efa40;if(validateAccess(_0x53b17b,_0x5591cd)[_0xa47079(0x17d)]){if(pid[_0x437bbf])pid[_0x437bbf]['send']({'function':_0xa47079(0x224),'args':_0x12825a});}else logging(_0xa47079(0x124));}),_0x32e9f9['on'](_0x2efa40(0x217),_0x5c87c6=>{const _0x7822c4=_0x2efa40;if(validateAccess(_0x5c87c6,_0x5591cd)[_0x7822c4(0x17d)]){if(pid[_0x437bbf])pid[_0x437bbf][_0x7822c4(0x158)]({'function':'cancelLoading','args':null});}else logging(_0x7822c4(0x1a1));}),_0x32e9f9['on'](_0x2efa40(0xf8),_0x4be10a=>{const _0x4390fc=_0x2efa40;if(validateAccess(_0x4be10a,_0x5591cd)[_0x4390fc(0x17d)])updateBB();else logging(_0x4390fc(0x109));}),_0x32e9f9['on']('get-messages',_0x5c9a65=>{const _0x3a01d5=_0x2efa40;if(validateAccess(_0x5c9a65,_0x5591cd)[_0x3a01d5(0x17d)])getMessages();else logging(_0x3a01d5(0x101));}),_0x32e9f9['on'](_0x2efa40(0x24f),(_0x625a22,_0x28d85e)=>{const _0x119263=_0x2efa40;if(validateAccess(_0x28d85e,_0x5591cd)[_0x119263(0x17d)])confirmMessage(_0x625a22);else logging(_0x119263(0x1fc));}),_0x32e9f9['on'](_0x2efa40(0xf9),_0x18f8b5=>{const _0xb48b8f=_0x2efa40;if(validateAccess(_0x18f8b5,_0x5591cd)[_0xb48b8f(0x17d)]){if(devices[_0x5591cd][_0xb48b8f(0x10e)])clearTimeout(devices[_0x5591cd][_0xb48b8f(0x10e)]);if(devices[_0x5591cd]['pidExpireLogin'])clearTimeout(devices[_0x5591cd][_0xb48b8f(0x12c)]);removeSocketListeners(getClient(_0x32e9f9['id'])[_0xb48b8f(0xf4)]),addBlacklist(_0x5591cd),devices[_0x5591cd][_0xb48b8f(0x1d0)]=null,devices[_0x5591cd][_0xb48b8f(0x21f)]=null,devices[_0x5591cd]['access'][_0xb48b8f(0x19c)]=null,io['to'](getClient(_0x32e9f9['id'])[_0xb48b8f(0xf4)])[_0xb48b8f(0x25c)](_0xb48b8f(0x113),{'access':{'allow':![],'reason':_0xb48b8f(0x168),'token':null}});}else logging(_0xb48b8f(0x19b));});}function removeSocketListeners(_0x9aec6b){getClientsWithUuid(_0x9aec6b)['forEach'](_0x4e10e8=>{const _0x56c545=_0xbd08;getSocket(_0x4e10e8['id'])[_0x56c545(0x193)]();});}function cleanSettings(){const _0x2419cd=_0x3b1bde;let _0x34f796=settings;return settings[_0x2419cd(0x171)]&&settings['telegramToken']!=''&&(_0x34f796={..._0x34f796,'telegramToken':_0x2419cd(0x194)}),settings[_0x2419cd(0x210)]&&settings[_0x2419cd(0x210)]!=''&&(_0x34f796={..._0x34f796,'bbPassword':_0x2419cd(0x194)}),_0x34f796;}function updateBB(){const _0x1772de=_0x3b1bde;installingUpdate=!![],config[_0x1772de(0x250)](_0x559a61=>{const _0x2491d5=_0x1772de;restartBot(_0x559a61[_0x2491d5(0x184)]);}),process[_0x1772de(0x158)]({'update':!![]},_0x159048=>{});}function startBot(_0x24a3fe,_0x5cc370,_0x542af6){const _0x59d1ad=_0x3b1bde;let _0x1fbeeb=![];const _0x5bed66=_0x24a3fe[0x0];_0x5cc370={..._0x5cc370,'stdio':[_0x59d1ad(0x21b),_0x59d1ad(0x21b),_0x59d1ad(0x21b),'ipc']},pid[_0x5bed66]=childProcess[_0x59d1ad(0x1eb)](botfile,_0x24a3fe,_0x5cc370),pid[_0x5bed66]['on']('message',_0x4f99c9=>{const _0x5f2079=_0x59d1ad;switch(Object[_0x5f2079(0x18c)](_0x4f99c9)[0x0]){case _0x5f2079(0x1f9):updateBotName(_0x5bed66,_0x4f99c9[_0x5f2079(0x1f9)]);break;case _0x5f2079(0x22e):updateBotManager();break;case _0x5f2079(0x113):updateStatus(_0x5bed66,_0x4f99c9['status']);break;case _0x5f2079(0x17e):updateLive(_0x5bed66,_0x4f99c9[_0x5f2079(0x17e)]);break;case _0x5f2079(0xf2):updateLive(_0x5bed66,_0x4f99c9[_0x5f2079(0xf2)]),io['to'](_0x5bed66)[_0x5f2079(0x25c)](_0x5f2079(0x113),{'access':{'allow':![],'reason':_0x5f2079(0x238),'token':null}});break;case _0x5f2079(0x119):_0x4f99c9[_0x5f2079(0x119)]=='restart'&&restartBot(_0x5bed66);_0x4f99c9[_0x5f2079(0x119)]=='kill'&&toggleBot(_0x5bed66,_0x5f2079(0x1f1),'stopped');break;case'telegram':sendTelegram(_0x5bed66,_0x4f99c9['telegram']);break;case _0x5f2079(0x198):sendTelegramMsg(_0x4f99c9[_0x5f2079(0x198)]);break;case _0x5f2079(0x1ea):io['to'](_0x5bed66)[_0x5f2079(0x25c)](_0x4f99c9[_0x5f2079(0x1ea)],_0x4f99c9[_0x5f2079(0x260)]);break;}}),pid[_0x5bed66]['on'](_0x59d1ad(0x20b),function(_0x25522c){if(_0x1fbeeb)return;_0x1fbeeb=!![],_0x542af6(_0x25522c);}),pid[_0x5bed66]['on'](_0x59d1ad(0x151),function(_0x58892b){const _0x4395c0=_0x59d1ad;if(installingUpdate)return;if(_0x1fbeeb)return;_0x1fbeeb=!![],_0x542af6(null);const _0x57c479=dbConfig['get'](_0x4395c0(0x21a))[_0x4395c0(0x1de)]({'botID':_0x5bed66})[_0x4395c0(0xf1)]();_0x57c479&&(_0x57c479[_0x4395c0(0x113)]==_0x4395c0(0x177)||_0x57c479[_0x4395c0(0x113)]==_0x4395c0(0x202))&&(updateLive(_0x5bed66,_0x4395c0(0x112)),logging(_0x4395c0(0x13a)+_0x5bed66),startBot([_0x5bed66,userID],{'cwd':bbpath},function(_0x4ece9c){if(_0x4ece9c)logging(_0x4ece9c);}));});}function stopBot(_0x1dca0c){const _0x53c7a9=_0x3b1bde;getClientsWithBotID(_0x1dca0c)['forEach'](_0xefe2c0=>{const _0x1e8100=_0xbd08;getSocket(_0xefe2c0['id'])[_0x1e8100(0x241)](!![]),removeClient(_0xefe2c0['id']);}),pid[_0x1dca0c]&&(pid[_0x1dca0c][_0x53c7a9(0x1f5)](),pid[_0x1dca0c]=null);}function restartBot(_0x8f684f){const _0x2bec68=_0x3b1bde;if(pid[_0x8f684f])pid[_0x8f684f][_0x2bec68(0x1f5)]();}function addBot(){const _0x1bfec3=_0x3b1bde;let _0x2f3770;for(let _0x1dab7f=0x1;_0x1dab7f<0x3e9;_0x1dab7f++){_0x2f3770=_0x1dab7f['toString']()[_0x1bfec3(0x245)](0x3,'0');let _0x20654d=config[_0x1bfec3(0x1de)](_0x2729f9=>_0x2729f9['botID']==_0x2f3770);if(!_0x20654d)break;}if(_0x2f3770===_0x1bfec3(0x190)){logging(_0x1bfec3(0x211));return;}logging('starting\x20new\x20bot\x20|\x20Bot\x20'+_0x2f3770),dbConfig['get'](_0x1bfec3(0x21a))[_0x1bfec3(0x1a6)]({'botID':_0x2f3770,'botname':_0x1bfec3(0x187)+_0x2f3770,'status':'new','live':''})[_0x1bfec3(0x1b6)](),startBot([_0x2f3770,userID],{'cwd':bbpath},function(_0x23e7b4){if(_0x23e7b4)logging(_0x23e7b4);}),config=getConfiguration(),io['to']('botmanager')['emit'](_0x1bfec3(0x21a),config);}function deleteBot(_0x47fbc6){const _0x49e673=_0x3b1bde;getClientsWithBotID(_0x47fbc6)[_0x49e673(0x250)](_0x36e205=>{const _0x25cdd6=_0x49e673;getSocket(_0x36e205['id'])[_0x25cdd6(0x241)](!![]),removeClient(_0x36e205['id']);}),dbConfig[_0x49e673(0x164)](_0x49e673(0x21a))[_0x49e673(0x16c)]({'botID':_0x47fbc6})[_0x49e673(0x1b6)](),logging(_0x49e673(0x258)+_0x47fbc6),stopBot(_0x47fbc6);try{fs[_0x49e673(0x142)](path[_0x49e673(0x18d)](configpath,'bot-'+_0x47fbc6+_0x49e673(0x166))),fs[_0x49e673(0x142)](path[_0x49e673(0x18d)](configpath,'bot-'+_0x47fbc6+'-events.json')),fs[_0x49e673(0x142)](path[_0x49e673(0x18d)](configpath,_0x49e673(0x12a)+_0x47fbc6+'-performance.json')),fs[_0x49e673(0x142)](path[_0x49e673(0x18d)](configpath,_0x49e673(0x12a)+_0x47fbc6+_0x49e673(0x1d4)));}catch(_0x12fe29){if(_0x12fe29)logging('error\x20while\x20deleting\x20config\x20files:\x20',_0x12fe29);}config=getConfiguration(),io['to']('botmanager')['emit'](_0x49e673(0x21a),config);}function toggleBot(_0x2795ea,_0x47967c,_0x5b5078){const _0x3eace9=_0x3b1bde;dbConfig[_0x3eace9(0x164)](_0x3eace9(0x21a))[_0x3eace9(0x1de)]({'botID':_0x2795ea})['assign']({'status':_0x47967c})[_0x3eace9(0x1fd)]({'live':_0x5b5078})[_0x3eace9(0x1b6)]();if(_0x47967c==_0x3eace9(0x177)||_0x47967c==_0x3eace9(0x202))logging(_0x3eace9(0x100)+_0x2795ea),startBot([_0x2795ea,userID],{'cwd':bbpath},function(_0x38c182){if(_0x38c182)logging(_0x38c182);});else(_0x47967c=='disabled'||_0x47967c==_0x3eace9(0x251))&&(logging(_0x3eace9(0x16b)+_0x2795ea),stopBot(_0x2795ea));config=getConfiguration(),io['to'](_0x3eace9(0x183))[_0x3eace9(0x25c)]('bots',config);}function toggleStatus(_0x2e1292){const _0x21d3ea=_0x3b1bde;let _0xab685a=dbConfig[_0x21d3ea(0x164)]('bots')[_0x21d3ea(0x1de)]({'botID':_0x2e1292})[_0x21d3ea(0xf1)](),_0x23e202;if(_0xab685a[_0x21d3ea(0x113)]===_0x21d3ea(0x177))_0x23e202='disabled';else{if(_0xab685a[_0x21d3ea(0x113)]==='new')_0x23e202='new-disabled';else{if(_0xab685a[_0x21d3ea(0x113)]===_0x21d3ea(0x251))_0x23e202=_0x21d3ea(0x202);else{if(_0xab685a['status']===_0x21d3ea(0x1f1))_0x23e202=_0x21d3ea(0x177);}}}return _0x23e202;}function updateStatus(_0x5b213f,_0x3c7593){const _0x5d8e47=_0x3b1bde;dbConfig[_0x5d8e47(0x164)](_0x5d8e47(0x21a))[_0x5d8e47(0x1de)]({'botID':_0x5b213f})['assign']({'status':_0x3c7593})[_0x5d8e47(0x1b6)](),config=getConfiguration(),io['to'](_0x5d8e47(0x183))[_0x5d8e47(0x25c)](_0x5d8e47(0x21a),config);}function updateLive(_0x21551f,_0xf99bd0){const _0x6a54c9=_0x3b1bde;dbConfig[_0x6a54c9(0x164)]('bots')[_0x6a54c9(0x1de)]({'botID':_0x21551f})[_0x6a54c9(0x1fd)]({'live':_0xf99bd0})[_0x6a54c9(0x1b6)](),config=getConfiguration(),io['to'](_0x6a54c9(0x183))['emit'](_0x6a54c9(0x21a),config);}function updateBotName(_0x81b4b9,_0x36e18b){const _0x1d694e=_0x3b1bde;dbConfig[_0x1d694e(0x164)](_0x1d694e(0x21a))[_0x1d694e(0x1de)]({'botID':_0x81b4b9})[_0x1d694e(0x1fd)]({'botname':_0x36e18b})['write'](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x1d694e(0x21a),config);}function updateBotManager(){const _0x37a651=_0x3b1bde;config=getConfiguration(),io['to'](_0x37a651(0x183))['emit'](_0x37a651(0x21a),config);}function toggleBotMode(_0x5d5168){const _0x4c5e15=_0x3b1bde;if(pid[_0x5d5168])pid[_0x5d5168][_0x4c5e15(0x158)]({'function':'toggleBotMode','args':null});else{const _0x27be17=configpath+_0x4c5e15(0x12a)+_0x5d5168+_0x4c5e15(0x166),_0x7da368=fs[_0x4c5e15(0x1e4)](_0x27be17),_0x26a836=JSON[_0x4c5e15(0x20f)](_0x7da368),_0x182e2d=_0x26a836[_0x4c5e15(0x235)][0x0][_0x4c5e15(0x161)];_0x26a836[_0x4c5e15(0x235)][0x0][_0x4c5e15(0x161)]=!_0x182e2d;const _0x2487b3=JSON['stringify'](_0x26a836,null,0x2);fs['writeFileSync'](_0x27be17,_0x2487b3),config=getConfiguration(),io['to'](_0x4c5e15(0x183))[_0x4c5e15(0x25c)](_0x4c5e15(0x21a),config);}}function telegramError(_0x4b5a4){const _0x16470f=_0x3b1bde;console['log'](getTimeStamp()+_0x16470f(0x218));}function validateTelegram(_0x1c0bad){const _0x4cdd65=_0x3b1bde;if(_0x1c0bad['from'][_0x4cdd65(0x21e)]!=settings[_0x4cdd65(0x191)]&&'@'+_0x1c0bad[_0x4cdd65(0x197)][_0x4cdd65(0x21e)]!=settings[_0x4cdd65(0x191)])return tgBot[_0x4cdd65(0x207)](_0x1c0bad[_0x4cdd65(0x1dc)]['id'],_0x4cdd65(0xfb),{'parse_mode':_0x4cdd65(0x244)})['catch'](_0x32fcf3=>{telegramError(_0x32fcf3);}),![];return!![];}async function initTelegram(){const _0x57ee9c=_0x3b1bde;if(tgBot)tgBot[_0x57ee9c(0x104)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x132c1f='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x132c1f+='\x0a',_0x132c1f+=_0x57ee9c(0x181),_0x132c1f+=_0x57ee9c(0x243),_0x132c1f+=_0x57ee9c(0x141),_0x132c1f+=_0x57ee9c(0x173),_0x132c1f+='/on\x20-\x20start\x20bot(s)\x0a',_0x132c1f+=_0x57ee9c(0x15b),_0x132c1f+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x132c1f+=_0x57ee9c(0x246),_0x132c1f+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x132c1f+=_0x57ee9c(0x262),_0x132c1f+=_0x57ee9c(0x22a),_0x132c1f+=_0x57ee9c(0x1c6);let _0x11d599=_0x57ee9c(0x1a2);_0x11d599+='\x0a',_0x11d599+=_0x132c1f,tgBot[_0x57ee9c(0x108)](/\/start/,_0x2cc9c0=>{const _0x78040a=_0x57ee9c;if(!validateTelegram(_0x2cc9c0))return;if(settings[_0x78040a(0x20e)]!=_0x2cc9c0[_0x78040a(0x1dc)]['id'])updateSetting('telegramChatId',_0x2cc9c0[_0x78040a(0x1dc)]['id']);updateSetting(_0x78040a(0xff),!![]),tgBot[_0x78040a(0x207)](_0x2cc9c0[_0x78040a(0x1dc)]['id'],_0x11d599)[_0x78040a(0x13d)](_0x3ced7a=>{telegramError(_0x3ced7a);});}),tgBot[_0x57ee9c(0x108)](/\/enable/,_0x5377a2=>{const _0x46e3bd=_0x57ee9c;if(!validateTelegram(_0x5377a2))return;if(settings['telegramChatId']!=_0x5377a2[_0x46e3bd(0x1dc)]['id'])updateSetting(_0x46e3bd(0x20e),_0x5377a2[_0x46e3bd(0x1dc)]['id']);updateSetting(_0x46e3bd(0xff),!![]),tgBot['sendMessage'](_0x5377a2[_0x46e3bd(0x1dc)]['id'],_0x46e3bd(0x1a9))[_0x46e3bd(0x13d)](_0x427d86=>{telegramError(_0x427d86);});}),tgBot[_0x57ee9c(0x108)](/\/config/,async _0x44ce52=>{const _0x521a7c=_0x57ee9c;if(!validateTelegram(_0x44ce52))return;tgBot[_0x521a7c(0x1e2)](_0x521a7c(0x1ed)),tgBot[_0x521a7c(0x207)](_0x44ce52['chat']['id'],_0x521a7c(0x189),{'reply_markup':{'inline_keyboard':[[{'text':_0x521a7c(0x1ad),'callback_data':_0x521a7c(0x195)},{'text':_0x521a7c(0x114),'callback_data':_0x521a7c(0xfc)},{'text':_0x521a7c(0x127),'callback_data':'all'}]]}})['catch'](_0x24d4e7=>{telegramError(_0x24d4e7);}),tgBot['on'](_0x521a7c(0x1ed),async _0x588766=>{const _0x14db38=_0x521a7c,_0x43b20e=_0x588766['data'],_0x3f98e5=_0x588766[_0x14db38(0x135)];tgBot['answerCallbackQuery'](_0x588766['id'])[_0x14db38(0x1b8)](async()=>{const _0x392692=_0x14db38;_0x43b20e=='orders'&&(updateSetting(_0x392692(0x255),_0x392692(0x195)),updateSetting(_0x392692(0xff),!![]),await tgBot[_0x392692(0x207)](_0x3f98e5[_0x392692(0x1dc)]['id'],_0x392692(0x21d))['catch'](_0x1ae4ff=>{telegramError(_0x1ae4ff);}));_0x43b20e=='alerts'&&(updateSetting(_0x392692(0x255),_0x392692(0xfc)),updateSetting(_0x392692(0xff),!![]),await tgBot[_0x392692(0x207)](_0x3f98e5[_0x392692(0x1dc)]['id'],_0x392692(0x17f))[_0x392692(0x13d)](_0xdbd9cf=>{telegramError(_0xdbd9cf);}));_0x43b20e==_0x392692(0x228)&&(updateSetting(_0x392692(0x255),'all'),updateSetting(_0x392692(0xff),!![]),await tgBot[_0x392692(0x207)](_0x3f98e5[_0x392692(0x1dc)]['id'],_0x392692(0x1a5))[_0x392692(0x13d)](_0x351cca=>{telegramError(_0x351cca);}));if(!settings[_0x392692(0x20e)])tgBot[_0x392692(0x207)](_0x3f98e5[_0x392692(0x1dc)]['id'],_0x392692(0x153))[_0x392692(0x13d)](_0x5128ee=>{telegramError(_0x5128ee);});}),tgBot[_0x14db38(0x1e2)](_0x14db38(0x1ed));});}),tgBot['onText'](/\/status/,_0x12102b=>{const _0x13dbf9=_0x57ee9c;if(!validateTelegram(_0x12102b))return;const _0x7c96fa=getBotsWithMode();let _0x3a3bf5=_0x13dbf9(0x170);config[_0x13dbf9(0x250)](_0x2c1863=>{const _0x44ae3a=_0x13dbf9,_0x365d1a=_0x7c96fa[_0x44ae3a(0x1de)](_0x2cb734=>_0x2cb734[_0x44ae3a(0x184)]==_0x2c1863[_0x44ae3a(0x184)])[_0x44ae3a(0x254)];_0x3a3bf5+='Bot\x20'+_0x2c1863['botID']+':\x20'+_0x2c1863[_0x44ae3a(0x113)]+_0x44ae3a(0x1a0)+_0x365d1a+_0x44ae3a(0x1a0)+_0x2c1863[_0x44ae3a(0x17e)]+'\x0a';}),_0x3a3bf5+='\x0a',_0x3a3bf5+=_0x13dbf9(0x196),_0x3a3bf5+=!settings['telegramEnabled']?_0x13dbf9(0x136):_0x13dbf9(0x1c8),_0x3a3bf5+=settings[_0x13dbf9(0xff)]?settings['telegramEvents']=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings[_0x13dbf9(0x255)]+_0x13dbf9(0x1c5):'',tgBot[_0x13dbf9(0x207)](_0x12102b['chat']['id'],_0x3a3bf5,{'parse_mode':'HTML'})['catch'](_0x53923e=>{telegramError(_0x53923e);});}),tgBot['onText'](/\/restart/,_0x5ddb57=>{const _0x29e110=_0x57ee9c;if(!validateTelegram(_0x5ddb57))return;tgBot[_0x29e110(0x1e2)]('callback_query');const _0x177839=getEnabledBots();if(_0x177839[_0x29e110(0x12d)]==0x0)tgBot[_0x29e110(0x207)](_0x5ddb57[_0x29e110(0x1dc)]['id'],_0x29e110(0x14d))['catch'](_0x3f3dfa=>{telegramError(_0x3f3dfa);});else{if(_0x177839[_0x29e110(0x12d)]>0x1)_0x177839['push']({'botID':_0x29e110(0x228)});let _0x10c8eb=[],_0x4069aa=[];const _0x1e8550=_0x177839['length']%0x4==0x0||_0x177839[_0x29e110(0x12d)]%0x4==0x3||_0x177839['length']%0x3==0x1?0x4:0x3;let _0x51fba3=0x0;_0x177839[_0x29e110(0x250)]((_0xd72f77,_0x67b951)=>{const _0x4e1556=_0x29e110;if(_0x67b951%_0x1e8550==0x0)_0x4069aa=[];_0x4069aa['push']({'text':_0xd72f77[_0x4e1556(0x184)]==_0x4e1556(0x228)?'All\x20bots':_0x4e1556(0x187)+_0xd72f77[_0x4e1556(0x184)],'callback_data':_0xd72f77[_0x4e1556(0x184)]}),_0x67b951%_0x1e8550==0x0&&(_0x10c8eb[_0x51fba3]=_0x4069aa,_0x51fba3++);}),tgBot['sendMessage'](_0x5ddb57[_0x29e110(0x1dc)]['id'],_0x29e110(0x23c),{'reply_markup':{'inline_keyboard':_0x10c8eb}})['catch'](_0x44f359=>{telegramError(_0x44f359);}),tgBot['on'](_0x29e110(0x1ed),async _0x3368c5=>{const _0x2cec1b=_0x29e110,_0x58c3d0=_0x3368c5[_0x2cec1b(0x1f8)],_0x3ddd9d=_0x3368c5[_0x2cec1b(0x135)];tgBot[_0x2cec1b(0x222)](_0x3368c5['id'])[_0x2cec1b(0x1b8)](async()=>{_0x58c3d0=='all'?config['forEach'](_0x49cf23=>{const _0x3044ff=_0xbd08;restartBot(_0x49cf23[_0x3044ff(0x184)]);}):restartBot(_0x58c3d0);}),tgBot[_0x2cec1b(0x1e2)](_0x2cec1b(0x1ed));});}}),tgBot[_0x57ee9c(0x108)](/\/on/,_0x147c41=>{const _0x3c698e=_0x57ee9c;if(!validateTelegram(_0x147c41))return;tgBot[_0x3c698e(0x1e2)](_0x3c698e(0x1ed));const _0x4d9133=getDisabledBots();if(_0x4d9133['length']==0x0)tgBot[_0x3c698e(0x207)](_0x147c41['chat']['id'],_0x3c698e(0x128))[_0x3c698e(0x13d)](_0x641961=>{telegramError(_0x641961);});else{if(_0x4d9133[_0x3c698e(0x12d)]>0x1)_0x4d9133[_0x3c698e(0x1a6)]({'botID':_0x3c698e(0x228)});let _0x5b6134=[],_0x3b1bfb=[];const _0x9853a=_0x4d9133[_0x3c698e(0x12d)]%0x4==0x0||_0x4d9133[_0x3c698e(0x12d)]%0x4==0x3||_0x4d9133['length']%0x3==0x1?0x4:0x3;let _0x32918e=0x0;_0x4d9133[_0x3c698e(0x250)]((_0xdc56cb,_0x57d9af)=>{const _0xad4087=_0x3c698e;if(_0x57d9af%_0x9853a==0x0)_0x3b1bfb=[];_0x3b1bfb[_0xad4087(0x1a6)]({'text':_0xdc56cb['botID']==_0xad4087(0x228)?_0xad4087(0x1f3):_0xad4087(0x187)+_0xdc56cb['botID'],'callback_data':_0xdc56cb[_0xad4087(0x184)]}),_0x57d9af%_0x9853a==0x0&&(_0x5b6134[_0x32918e]=_0x3b1bfb,_0x32918e++);}),tgBot[_0x3c698e(0x207)](_0x147c41[_0x3c698e(0x1dc)]['id'],_0x3c698e(0x1a4),{'reply_markup':{'inline_keyboard':_0x5b6134}})[_0x3c698e(0x13d)](_0x28a7d4=>{telegramError(_0x28a7d4);}),tgBot['on']('callback_query',async _0x1bfffe=>{const _0x3a72b5=_0x3c698e,_0x321c71=_0x1bfffe[_0x3a72b5(0x1f8)],_0x3aed0b=_0x1bfffe[_0x3a72b5(0x135)];tgBot['answerCallbackQuery'](_0x1bfffe['id'])[_0x3a72b5(0x1b8)](async()=>{const _0x14a4b2=_0x3a72b5;_0x321c71=='all'?(tgBot[_0x14a4b2(0x207)](_0x3aed0b[_0x14a4b2(0x1dc)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x14a4b2(0x13d)](_0x11d0be=>{telegramError(_0x11d0be);}),_0x4d9133['forEach'](_0x4984fd=>{const _0x572dc8=_0x14a4b2;if(_0x4984fd[_0x572dc8(0x184)]!='all')toggleBot(_0x4984fd[_0x572dc8(0x184)],toggleStatus(_0x4984fd[_0x572dc8(0x184)]),_0x572dc8(0x112));})):(tgBot['sendMessage'](_0x3aed0b[_0x14a4b2(0x1dc)]['id'],_0x14a4b2(0x175)+_0x321c71)[_0x14a4b2(0x13d)](_0x53c264=>{telegramError(_0x53c264);}),toggleBot(_0x321c71,toggleStatus(_0x321c71),_0x14a4b2(0x112)));}),tgBot[_0x3a72b5(0x1e2)](_0x3a72b5(0x1ed));});}}),tgBot[_0x57ee9c(0x108)](/\/off/,_0x17dddd=>{const _0x5702e0=_0x57ee9c;if(!validateTelegram(_0x17dddd))return;tgBot[_0x5702e0(0x1e2)](_0x5702e0(0x1ed));const _0x1afae7=getEnabledBots();if(_0x1afae7[_0x5702e0(0x12d)]==0x0)tgBot[_0x5702e0(0x207)](_0x17dddd[_0x5702e0(0x1dc)]['id'],_0x5702e0(0x14d))['catch'](_0x471b7e=>{telegramError(_0x471b7e);});else{if(_0x1afae7[_0x5702e0(0x12d)]>0x1)_0x1afae7[_0x5702e0(0x1a6)]({'botID':_0x5702e0(0x228)});let _0xba0d06=[],_0x2e40ba=[];const _0x5315c4=_0x1afae7[_0x5702e0(0x12d)]%0x4==0x0||_0x1afae7['length']%0x4==0x3||_0x1afae7[_0x5702e0(0x12d)]%0x3==0x1?0x4:0x3;let _0x98adde=0x0;_0x1afae7['forEach']((_0x3c119d,_0x2c83d3)=>{const _0x686365=_0x5702e0;if(_0x2c83d3%_0x5315c4==0x0)_0x2e40ba=[];_0x2e40ba[_0x686365(0x1a6)]({'text':_0x3c119d[_0x686365(0x184)]==_0x686365(0x228)?_0x686365(0x1f3):_0x686365(0x187)+_0x3c119d['botID'],'callback_data':_0x3c119d['botID']}),_0x2c83d3%_0x5315c4==0x0&&(_0xba0d06[_0x98adde]=_0x2e40ba,_0x98adde++);}),tgBot[_0x5702e0(0x207)](_0x17dddd['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0xba0d06}})[_0x5702e0(0x13d)](_0x51236a=>{telegramError(_0x51236a);}),tgBot['on']('callback_query',async _0x16c4e8=>{const _0x6782db=_0x5702e0,_0xef97a1=_0x16c4e8[_0x6782db(0x1f8)],_0x1736d9=_0x16c4e8[_0x6782db(0x135)];tgBot[_0x6782db(0x222)](_0x16c4e8['id'])['then'](async()=>{const _0x1b1cfd=_0x6782db;_0xef97a1==_0x1b1cfd(0x228)?(tgBot[_0x1b1cfd(0x207)](_0x1736d9[_0x1b1cfd(0x1dc)]['id'],_0x1b1cfd(0x1fa))[_0x1b1cfd(0x13d)](_0x1b7a4b=>{telegramError(_0x1b7a4b);}),_0x1afae7[_0x1b1cfd(0x250)](_0x23c2ed=>{const _0x4a69e9=_0x1b1cfd;if(_0x23c2ed['botID']!='all')toggleBot(_0x23c2ed[_0x4a69e9(0x184)],toggleStatus(_0x23c2ed[_0x4a69e9(0x184)]),_0x4a69e9(0x112));})):(tgBot[_0x1b1cfd(0x207)](_0x1736d9[_0x1b1cfd(0x1dc)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0xef97a1)[_0x1b1cfd(0x13d)](_0x54a67f=>{telegramError(_0x54a67f);}),toggleBot(_0xef97a1,toggleStatus(_0xef97a1),_0x1b1cfd(0x112)));}),tgBot[_0x6782db(0x1e2)]('callback_query');});}}),tgBot['onText'](/\/portfolio/,_0x28d38c=>{const _0x334109=_0x57ee9c;if(!validateTelegram(_0x28d38c))return;tgBot['removeListener'](_0x334109(0x1ed));const _0x108cfc=getEnabledBots();if(_0x108cfc[_0x334109(0x12d)]==0x0)tgBot[_0x334109(0x207)](_0x28d38c[_0x334109(0x1dc)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x334109(0x13d)](_0x44ec5b=>{telegramError(_0x44ec5b);});else{if(_0x108cfc[_0x334109(0x12d)]>0x1){let _0x18969e=[],_0x4f042f=[];const _0x58fcae=_0x108cfc[_0x334109(0x12d)]%0x4==0x0||_0x108cfc['length']%0x4==0x3||_0x108cfc['length']%0x3==0x1?0x4:0x3;let _0x283264=0x0;_0x108cfc['forEach']((_0x34367e,_0x1b83d3)=>{const _0x29b093=_0x334109;if(_0x1b83d3%_0x58fcae==0x0)_0x4f042f=[];_0x4f042f[_0x29b093(0x1a6)]({'text':'Bot\x20'+_0x34367e[_0x29b093(0x184)],'callback_data':_0x34367e[_0x29b093(0x184)]}),_0x1b83d3%_0x58fcae==0x0&&(_0x18969e[_0x283264]=_0x4f042f,_0x283264++);}),tgBot[_0x334109(0x207)](_0x28d38c[_0x334109(0x1dc)]['id'],_0x334109(0x131),{'reply_markup':{'inline_keyboard':_0x18969e}})[_0x334109(0x13d)](_0x547774=>{telegramError(_0x547774);}),tgBot['on'](_0x334109(0x1ed),async _0xcb2411=>{const _0x45c36f=_0x334109,_0x11bc66=_0xcb2411[_0x45c36f(0x1f8)],_0x334a5c=_0xcb2411[_0x45c36f(0x135)];tgBot['answerCallbackQuery'](_0xcb2411['id'])[_0x45c36f(0x1b8)](async()=>{const _0x42dbac=_0x45c36f;if(pid[_0x11bc66])pid[_0x11bc66][_0x42dbac(0x158)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x45c36f(0x1e2)]('callback_query');});}else{const _0x27b587=_0x108cfc[0x0][_0x334109(0x184)];if(pid[_0x27b587])pid[_0x27b587]['send']({'function':'sendPortfolioTelegram','args':null});}}}),tgBot['onText'](/\/update/,async _0x28a196=>{const _0x44949c=_0x57ee9c;if(!validateTelegram(_0x28a196))return;tgBot['removeListener'](_0x44949c(0x1ed)),await getMessages();if(!updateAvailable)tgBot[_0x44949c(0x207)](_0x28a196[_0x44949c(0x1dc)]['id'],_0x44949c(0x17a))['catch'](_0x17bd58=>{telegramError(_0x17bd58);});else!validInstallation?tgBot[_0x44949c(0x207)](_0x28a196[_0x44949c(0x1dc)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0x44949c(0x13d)](_0x3e77a4=>{telegramError(_0x3e77a4);}):(tgBot[_0x44949c(0x207)](_0x28a196[_0x44949c(0x1dc)]['id'],_0x44949c(0x1ce),{'reply_markup':{'inline_keyboard':[[{'text':_0x44949c(0x11b),'callback_data':_0x44949c(0x1ff)},{'text':'No','callback_data':'no'}]]}})[_0x44949c(0x13d)](_0x30d77c=>{telegramError(_0x30d77c);}),tgBot['on'](_0x44949c(0x1ed),async _0x5b095d=>{const _0x1def8a=_0x44949c,_0x419e78=_0x5b095d[_0x1def8a(0x1f8)],_0x55fc7d=_0x5b095d['message'];tgBot['answerCallbackQuery'](_0x5b095d['id'])[_0x1def8a(0x1b8)](async()=>{const _0x3851d5=_0x1def8a;_0x419e78==_0x3851d5(0x1ff)&&(await tgBot['sendMessage'](_0x55fc7d[_0x3851d5(0x1dc)]['id'],_0x3851d5(0x1dd))['catch'](_0x51df21=>{telegramError(_0x51df21);}),updateBB());_0x419e78=='no'&&await tgBot['sendMessage'](_0x55fc7d[_0x3851d5(0x1dc)]['id'],_0x3851d5(0x24e))[_0x3851d5(0x13d)](_0x276e8d=>{telegramError(_0x276e8d);});if(!settings[_0x3851d5(0x20e)])tgBot[_0x3851d5(0x207)](_0x55fc7d[_0x3851d5(0x1dc)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x3851d5(0x13d)](_0xdce94c=>{telegramError(_0xdce94c);});}),tgBot[_0x1def8a(0x1e2)]('callback_query');}));}),tgBot[_0x57ee9c(0x108)](/\/toggle/,_0x1f6c06=>{const _0x1672e0=_0x57ee9c;if(!validateTelegram(_0x1f6c06))return;tgBot[_0x1672e0(0x1e2)](_0x1672e0(0x1ed));const _0x27902b=getBotsWithMode();if(_0x27902b[_0x1672e0(0x12d)]==0x0)tgBot['sendMessage'](_0x1f6c06[_0x1672e0(0x1dc)]['id'],_0x1672e0(0x14d))[_0x1672e0(0x13d)](_0x428244=>{telegramError(_0x428244);});else{let _0x4015a8=[],_0x569325=[];const _0xb95741=0x2;let _0x2736af=0x0;_0x27902b[_0x1672e0(0x250)]((_0x2a095b,_0x130a3e)=>{const _0x37f1c3=_0x1672e0;if(_0x130a3e%_0xb95741==0x0)_0x569325=[];_0x569325['push']({'text':_0x37f1c3(0x187)+_0x2a095b['botID']+'\x20('+_0x2a095b[_0x37f1c3(0x254)]+')','callback_data':_0x2a095b[_0x37f1c3(0x184)]}),_0x130a3e%_0xb95741==0x0&&(_0x4015a8[_0x2736af]=_0x569325,_0x2736af++);}),tgBot[_0x1672e0(0x207)](_0x1f6c06['chat']['id'],_0x1672e0(0x1df),{'reply_markup':{'inline_keyboard':_0x4015a8}})[_0x1672e0(0x13d)](_0x4ed294=>{telegramError(_0x4ed294);}),tgBot['on']('callback_query',async _0x3b751e=>{const _0x34c9fc=_0x1672e0,_0x10cc07=_0x3b751e[_0x34c9fc(0x1f8)],_0x53b7a2=_0x3b751e[_0x34c9fc(0x135)];tgBot[_0x34c9fc(0x222)](_0x3b751e['id'])['then'](async()=>{const _0x2d1ea3=_0x34c9fc,_0x20b223=_0x27902b[_0x2d1ea3(0x1de)](_0x2778a8=>_0x2778a8[_0x2d1ea3(0x184)]==_0x10cc07),_0x270781=_0x20b223[_0x2d1ea3(0x254)]=='auto'?'manual':_0x2d1ea3(0x12b);tgBot[_0x2d1ea3(0x207)](_0x53b7a2[_0x2d1ea3(0x1dc)]['id'],_0x2d1ea3(0x143)+_0x10cc07+_0x2d1ea3(0x139)+_0x270781+'\x20mode')[_0x2d1ea3(0x13d)](_0x1d4d12=>{telegramError(_0x1d4d12);}),toggleBotMode(_0x10cc07);}),tgBot[_0x34c9fc(0x1e2)](_0x34c9fc(0x1ed));});}}),tgBot[_0x57ee9c(0x108)](/\/names/,_0x10771a=>{const _0x5788f7=_0x57ee9c;if(!validateTelegram(_0x10771a))return;let _0x1d3882='';config[_0x5788f7(0x250)](_0x22c319=>{const _0xda40e1=_0x5788f7;_0x1d3882+='Bot\x20'+_0x22c319[_0xda40e1(0x184)]+':\x20'+_0x22c319[_0xda40e1(0x1f9)]+'\x0a';}),tgBot[_0x5788f7(0x207)](_0x10771a['chat']['id'],_0x1d3882,{'parse_mode':_0x5788f7(0x244)})['catch'](_0xa31795=>{telegramError(_0xa31795);});}),tgBot['onText'](/\/disable/,_0x5a0114=>{const _0x2791bd=_0x57ee9c;if(!validateTelegram(_0x5a0114))return;tgBot[_0x2791bd(0x207)](_0x5a0114[_0x2791bd(0x1dc)]['id'],'Notifications\x20disabled')[_0x2791bd(0x13d)](_0x1d9c90=>{telegramError(_0x1d9c90);}),updateSetting(_0x2791bd(0xff),![]);}),tgBot[_0x57ee9c(0x108)](/\/help/,_0x331959=>{const _0x353e16=_0x57ee9c;if(!validateTelegram(_0x331959))return;tgBot[_0x353e16(0x207)](_0x331959[_0x353e16(0x1dc)]['id'],_0x132c1f)[_0x353e16(0x13d)](_0x4b9532=>{telegramError(_0x4b9532);});}),tgBot['on'](_0x57ee9c(0xf5),_0x3fa98d=>{const _0x462eb0=_0x57ee9c;_0x3fa98d['toString']()[_0x462eb0(0x1e3)]('404\x20Not\x20Found')&&(logging(_0x462eb0(0x1c3)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x462eb0(0x183))['emit'](_0x462eb0(0x18f),_0x462eb0(0x1c3)));}),process['once'](_0x57ee9c(0x110),()=>{const _0x3260ea=_0x57ee9c;if(tgBot)tgBot[_0x3260ea(0x104)]();process['exit'](0x1);}),process[_0x57ee9c(0x1e7)](_0x57ee9c(0x162),()=>{const _0x233cc5=_0x57ee9c;if(tgBot)tgBot[_0x233cc5(0x104)]();process[_0x233cc5(0x151)](0x1);});}}function disableTelegram(){const _0x34d181=_0x3b1bde;tgBot&&(tgBot[_0x34d181(0x104)](),tgBot=null);}function sendTelegram(_0x4bc535,_0x4e33ec){const _0x5991c0=_0x3b1bde;if(settings[_0x5991c0(0xff)]){if(settings[_0x5991c0(0x255)]=='all'||(_0x4e33ec[_0x5991c0(0x23b)]==_0x5991c0(0x20b)||_0x4e33ec['type']==_0x5991c0(0x1cd))&&settings[_0x5991c0(0x255)]=='alerts'||_0x4e33ec[_0x5991c0(0x23b)]=='order'&&settings[_0x5991c0(0x255)]==_0x5991c0(0x195)){if(tgBot&&settings[_0x5991c0(0x20e)]){if(_0x4e33ec[_0x5991c0(0x10b)])tgBot[_0x5991c0(0x207)](settings[_0x5991c0(0x20e)],_0x4e33ec[_0x5991c0(0x1f9)]+_0x5991c0(0x257)+_0x4e33ec['event'])['catch'](_0xda74ef=>{telegramError(_0xda74ef);});else tgBot[_0x5991c0(0x207)](settings[_0x5991c0(0x20e)],_0x5991c0(0x187)+_0x4bc535+_0x5991c0(0x257)+_0x4e33ec['event'])[_0x5991c0(0x13d)](_0x30c3fe=>{telegramError(_0x30c3fe);});}}}}async function sendTelegramMsg(_0x1819e6,_0x4289ee=_0x3b1bde(0x244)){const _0x2007d7=_0x3b1bde;return settings[_0x2007d7(0xff)]&&tgBot&&settings[_0x2007d7(0x20e)]?(await tgBot[_0x2007d7(0x207)](settings[_0x2007d7(0x20e)],_0x1819e6,{'parse_mode':_0x4289ee})[_0x2007d7(0x13d)](_0x5dab30=>{telegramError(_0x5dab30);}),!![]):![];}function getDeviceWithIp(_0x5d4bc1){const _0x4ce187=_0x3b1bde;return devices[_0x4ce187(0x1de)](_0x5003f1=>_0x5003f1['ip']===_0x5d4bc1);}function temporaryAccess2FA(_0x573090,_0x54e277){const _0x422547=_0x3b1bde;let _0x4aa93d=new Date(),_0x244eb0=![];if(lastIpApproval){if(_0x4aa93d-lastIpApproval<0x1388)_0x244eb0=!![];}lastIpApproval=new Date();if(_0x244eb0)return;tgBot&&settings['telegramChatId']&&(tgBot['removeListener'](_0x422547(0x1ed)),tgBot[_0x422547(0x207)](settings[_0x422547(0x20e)],_0x422547(0x15e)+normalizeIP(_0x54e277)[_0x422547(0x1c9)]+_0x422547(0x225),{'parse_mode':_0x422547(0x244),'reply_markup':{'inline_keyboard':[[{'text':_0x422547(0x1ef),'callback_data':'5'},{'text':_0x422547(0x107),'callback_data':'15'},{'text':_0x422547(0x200),'callback_data':'30'},{'text':_0x422547(0x178),'callback_data':_0x422547(0x178)}]]}})[_0x422547(0x13d)](_0xc48442=>{telegramError(_0xc48442);}),tgBot['on'](_0x422547(0x1ed),async _0x27ae9c=>{const _0x3c7582=_0x422547,_0x1228e2=_0x27ae9c['data'],_0x33d82a=_0x27ae9c[_0x3c7582(0x135)];tgBot[_0x3c7582(0x222)](_0x27ae9c['id'])['then'](async()=>{const _0x48b7ac=_0x3c7582;devices[_0x573090][_0x48b7ac(0x1d0)]={'clientip':_0x54e277,'timestamp':new Date()['getTime'](),'expiry':_0x1228e2},_0x1228e2!=_0x48b7ac(0x178)?(await tgBot[_0x48b7ac(0x207)](_0x33d82a[_0x48b7ac(0x1dc)]['id'],'Access\x20enabled\x20for\x20'+_0x1228e2+'\x20minutes',{'parse_mode':'HTML'})[_0x48b7ac(0x13d)](_0x42eaff=>{telegramError(_0x42eaff);}),io['to'](_0x573090)[_0x48b7ac(0x25c)](_0x48b7ac(0x113),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x48b7ac(0x207)](_0x33d82a['chat']['id'],_0x48b7ac(0x208))[_0x48b7ac(0x13d)](_0x46cfb0=>{telegramError(_0x46cfb0);}),io['to'](_0x573090)[_0x48b7ac(0x25c)](_0x48b7ac(0x113),{'access':{'allow':![],'reason':_0x48b7ac(0x242),'token':null}}));}),tgBot[_0x3c7582(0x1e2)]('callback_query');}));}function loginAccess2FA(_0x44b3dd,_0x4de38d){const _0x35ded5=_0x3b1bde;tgBot&&settings[_0x35ded5(0x20e)]&&(tgBot['removeListener']('callback_query'),tgBot[_0x35ded5(0x207)](settings[_0x35ded5(0x20e)],_0x35ded5(0x106)+normalizeIP(_0x4de38d)[_0x35ded5(0x1c9)]+_0x35ded5(0x225),{'parse_mode':_0x35ded5(0x244),'reply_markup':{'inline_keyboard':[[{'text':_0x35ded5(0x1cb),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x35ded5(0x178)}]]}})[_0x35ded5(0x13d)](_0x3b3e43=>{telegramError(_0x3b3e43);}),tgBot['on']('callback_query',async _0x3df2f5=>{const _0x1051d9=_0x35ded5,_0x4e631f=_0x3df2f5[_0x1051d9(0x1f8)],_0x11490e=_0x3df2f5['message'];tgBot[_0x1051d9(0x222)](_0x3df2f5['id'])[_0x1051d9(0x1b8)](async()=>{const _0x43c964=_0x1051d9;devices[_0x44b3dd][_0x43c964(0x21f)]={'clientip':_0x4de38d,'timestamp':new Date()[_0x43c964(0x223)](),'expiry':_0x4e631f},_0x4e631f!=_0x43c964(0x178)?(await tgBot['sendMessage'](_0x11490e[_0x43c964(0x1dc)]['id'],'Login\x20accepted',{'parse_mode':_0x43c964(0x244)})['catch'](_0x34ab1c=>{telegramError(_0x34ab1c);}),io['to'](_0x44b3dd)[_0x43c964(0x25c)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x43c964(0x207)](_0x11490e[_0x43c964(0x1dc)]['id'],_0x43c964(0x15f))[_0x43c964(0x13d)](_0x30133a=>{telegramError(_0x30133a);}),io['to'](_0x44b3dd)[_0x43c964(0x25c)](_0x43c964(0x113),{'access':{'allow':![],'reason':_0x43c964(0x121),'token':null}}));}),tgBot['removeListener'](_0x1051d9(0x1ed));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x408855=_0x3b1bde;return dbConfig[_0x408855(0x164)](_0x408855(0x21a))[_0x408855(0x16e)](_0x408855(0x184))['filter']({'status':_0x408855(0x177)})['value']()||[];}function getDisabledBots(){const _0x312325=_0x3b1bde;return dbConfig[_0x312325(0x164)](_0x312325(0x21a))[_0x312325(0x16e)]('botID')[_0x312325(0x149)]({'status':_0x312325(0x1f1)})[_0x312325(0xf1)]()||[];}function getBotsWithMode(){const _0x4bf6be=_0x3b1bde,_0x3f9a6f=dbConfig[_0x4bf6be(0x164)](_0x4bf6be(0x21a))[_0x4bf6be(0x16e)](_0x4bf6be(0x184))['value']()||[];return _0x3f9a6f[_0x4bf6be(0x250)](_0x14ca73=>{const _0x1c975b=_0x4bf6be,_0x3f52b6=configpath+_0x1c975b(0x12a)+_0x14ca73[_0x1c975b(0x184)]+_0x1c975b(0x166),_0x52d0c4=fs['existsSync'](_0x3f52b6);if(_0x52d0c4){const _0x3b30d8=fs[_0x1c975b(0x1e4)](_0x3f52b6);try{const _0x1b8393=JSON['parse'](_0x3b30d8),_0x5175d9=_0x1b8393?_0x1b8393[_0x1c975b(0x235)][0x0][_0x1c975b(0x161)]:![];_0x14ca73[_0x1c975b(0x254)]=_0x5175d9?_0x1c975b(0x12b):_0x1c975b(0x248);}catch(_0x42b581){_0x14ca73[_0x1c975b(0x254)]=_0x1c975b(0x248);}}else _0x14ca73['mode']='manual';}),_0x3f9a6f;}async function initUser(){const _0x32670c=_0x3b1bde;if(!settings[_0x32670c(0x156)]){const _0x5789b1=uuidRandom();mixpanel[_0x32670c(0x12e)](_0x5789b1),updateSetting('userid',_0x5789b1);}}async function initSecure(){const _0x55b956=_0x3b1bde;let _0x512b46=getSecure();if(!_0x512b46[_0x55b956(0x203)](_0x55b956(0x11e))){let _0x39c13c=await generateKeys();_0x512b46[_0x55b956(0x1e8)]=_0x39c13c[_0x55b956(0x1e8)],_0x512b46[_0x55b956(0x148)]=_0x39c13c[_0x55b956(0x148)],_0x512b46[_0x55b956(0x11e)]=crypto[_0x55b956(0x180)](0x20)['toString'](_0x55b956(0x163));;storeSecure(_0x512b46);}}function getSettings(){const _0x5ab4e9=_0x3b1bde;return dbSettings[_0x5ab4e9(0x164)](_0x5ab4e9(0x17c))['value']()||{};}function getSecure(){const _0x1edd98=_0x3b1bde;return dbSecure[_0x1edd98(0x164)](_0x1edd98(0x165))[_0x1edd98(0xf1)]()||{};}function getBlacklist(){const _0xa8b37c=_0x3b1bde;return dbSecure[_0xa8b37c(0x164)](_0xa8b37c(0x18a))['value']()||[];}function broadcastToBots(_0x2412b3,_0x23f8d0){const _0x12b590=_0x3b1bde;config[_0x12b590(0x250)](_0x146b50=>{const _0x243c95=_0x12b590;if(_0x146b50[_0x243c95(0x113)]==_0x243c95(0x177)&&_0x146b50['live']==_0x243c95(0x201)){if(pid[_0x146b50[_0x243c95(0x184)]])pid[_0x146b50['botID']]['send']({[_0x2412b3]:_0x23f8d0});}});}function storeSettings(_0x389d6a,_0x5df17f=![]){const _0x31a70a=_0x3b1bde;_0x389d6a={...settings,..._0x389d6a};if(_0x5df17f&&_0x389d6a[_0x31a70a(0x210)]!=_0x31a70a(0x194)&&_0x389d6a[_0x31a70a(0x210)]!=''){const _0x5cf678=crypt['decrypt'](secure[_0x31a70a(0x148)],_0x389d6a[_0x31a70a(0x210)])[_0x31a70a(0x135)][_0x31a70a(0x1af)]('@')[0x0],_0x178713=bcrypt[_0x31a70a(0x19a)](_0x5cf678,saltRounds);_0x389d6a={..._0x389d6a,'bbPassword':_0x178713};}if(_0x5df17f&&_0x389d6a[_0x31a70a(0x171)]!=_0x31a70a(0x194)&&_0x389d6a[_0x31a70a(0x171)]!=''){const _0x1b16e1=crypt[_0x31a70a(0x1da)](secure['privateKey'],_0x389d6a[_0x31a70a(0x171)])[_0x31a70a(0x135)]['split']('@')[0x0];_0x389d6a={..._0x389d6a,'telegramToken':_0x1b16e1};}const _0x29f421=_0x389d6a['telegramToken']!=_0x31a70a(0x194)&&_0x389d6a['telegramToken']!=settings[_0x31a70a(0x171)]||_0x389d6a[_0x31a70a(0x191)]!=settings[_0x31a70a(0x191)],_0x476aff=_0x389d6a[_0x31a70a(0x171)]==''||_0x389d6a[_0x31a70a(0x191)]=='';if(_0x29f421)_0x389d6a[_0x31a70a(0x255)]=_0x31a70a(0x228);for(const [_0xa71220,_0xf714a1]of Object[_0x31a70a(0x18b)](_0x389d6a)){if(_0xa71220=='telegramToken'&&_0xf714a1==_0x31a70a(0x194)){_0x389d6a[_0x31a70a(0x171)]=settings[_0x31a70a(0x171)];continue;};if(_0xa71220==_0x31a70a(0x210)&&_0xf714a1==_0x31a70a(0x194)){_0x389d6a['bbPassword']=settings['bbPassword'];continue;};dbSettings['set']('settings.'+_0xa71220,_0xf714a1)[_0x31a70a(0x1b6)]();}settings=_0x389d6a,io['to'](_0x31a70a(0x183))[_0x31a70a(0x25c)](_0x31a70a(0x17c),cleanSettings()),broadcastToBots(_0x31a70a(0x216),settings[_0x31a70a(0x216)]);if(_0x29f421&&!_0x476aff)initTelegram();if(_0x29f421&&_0x476aff)disableTelegram();getAllClients()[_0x31a70a(0x250)](_0x29b213=>{const _0x1b8248=_0x31a70a;getSocket(_0x29b213['id'])[_0x1b8248(0x25c)]('status',{'access':{'allow':![],'reason':_0x1b8248(0x238),'token':null}});});}function updateSetting(_0x950b05,_0x558d94){const _0x5252da=_0x3b1bde;dbSettings['set']('settings.'+_0x950b05,_0x558d94)[_0x5252da(0x1b6)](),settings=getSettings(),io['to'](_0x5252da(0x183))[_0x5252da(0x25c)](_0x5252da(0x17c),cleanSettings());}function storeSecure(_0x35b4f0){const _0x575d1e=_0x3b1bde;dbSecure[_0x575d1e(0x164)]('secure')[_0x575d1e(0x1a6)](_0x35b4f0)['write'](),secure=_0x35b4f0;}function addBlacklist(_0x27a06f){const _0x3cbf7d=_0x3b1bde;cleanBlacklist();let _0x53bc8a;devices[_0x27a06f]['telegramIpApproval']?_0x53bc8a=Math[_0x3cbf7d(0x10d)](devices[_0x27a06f]['telegramIpApproval'][_0x3cbf7d(0x1d3)],loginExpiry):_0x53bc8a=loginExpiry,dbSecure[_0x3cbf7d(0x164)](_0x3cbf7d(0x18a))[_0x3cbf7d(0x1a6)]({'expiry':new Date()[_0x3cbf7d(0x223)]()+_0x53bc8a*0x3c*0x3e8,'token':devices[_0x27a06f][_0x3cbf7d(0x212)][_0x3cbf7d(0x19c)]})[_0x3cbf7d(0x1b6)](),blacklist=dbSecure[_0x3cbf7d(0x164)](_0x3cbf7d(0x18a))[_0x3cbf7d(0xf1)]();}function cleanBlacklist(){const _0x18e82e=_0x3b1bde;let _0x291ca9=dbSecure['get'](_0x18e82e(0x18a))['cloneDeep']()[_0x18e82e(0xf1)](),_0x447cc2=new Date()[_0x18e82e(0x223)]();_0x291ca9['forEach'](_0x501165=>{const _0x4eca92=_0x18e82e;_0x501165[_0x4eca92(0x1d3)]<_0x447cc2&&dbSecure[_0x4eca92(0x164)]('blacklist')[_0x4eca92(0x16c)]({'expiry':_0x501165[_0x4eca92(0x1d3)]})[_0x4eca92(0x1b6)]();});}function initStates(){const _0x536d06=_0x3b1bde;let _0x2d341a=getConfiguration();_0x2d341a[_0x536d06(0x250)](_0x53ca4c=>{const _0xdedb77=_0x536d06;_0x53ca4c[_0xdedb77(0x17e)]=_0xdedb77(0x112);}),storeConfiguration(_0x2d341a);}function onKeys(){const _0x52c5f5=new RSA();return new Promise(_0x10f9e5=>{const _0x125c25=_0xbd08;_0x52c5f5[_0x125c25(0x15a)]()['then'](_0x332ab4=>{_0x10f9e5(_0x332ab4);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1ed5e2=_0x3b1bde;let _0x3580e5=getSettings(),_0x39df6a=![];!_0x3580e5['hasOwnProperty']('lastmsgtelegram')&&(_0x3580e5[_0x1ed5e2(0x1ac)]=0x0,_0x39df6a=!![]);!_0x3580e5[_0x1ed5e2(0x203)](_0x1ed5e2(0x133))&&(_0x3580e5['lastmsgemitted']=0x0,_0x39df6a=!![]);!_0x3580e5[_0x1ed5e2(0x203)]('latestversion')&&(_0x3580e5[_0x1ed5e2(0x25a)]='0.0.0',_0x39df6a=!![]);if(_0x39df6a)storeSettings(_0x3580e5);}function storeConfiguration(_0x205ab6){const _0x1c6b95=_0x3b1bde;dbConfig[_0x1c6b95(0x164)](_0x1c6b95(0x21a))['remove']()[_0x1c6b95(0x1b6)](),_0x205ab6[_0x1c6b95(0x250)](_0x52ff8d=>{delete _0x52ff8d['mode'];}),dbConfig[_0x1c6b95(0x164)](_0x1c6b95(0x21a))[_0x1c6b95(0x1a6)](..._0x205ab6)[_0x1c6b95(0x1b6)](),config=_0x205ab6;}function resetPassword(){const _0x35af43=_0x3b1bde;tgBot&&settings[_0x35af43(0x20e)]&&(tgBot[_0x35af43(0x1e2)](_0x35af43(0x1ed)),tgBot['sendMessage'](settings[_0x35af43(0x20e)],_0x35af43(0x19d),{'parse_mode':_0x35af43(0x244),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x35af43(0x1ff)},{'text':'no','callback_data':'no'}]]}})[_0x35af43(0x13d)](_0x48a894=>{telegramError(_0x48a894);}),tgBot['on']('callback_query',async _0xce2b1e=>{const _0x4d8e65=_0x35af43,_0x497217=_0xce2b1e['data'],_0xd2d5b9=_0xce2b1e[_0x4d8e65(0x135)];tgBot[_0x4d8e65(0x222)](_0xce2b1e['id'])[_0x4d8e65(0x1b8)](async()=>{const _0x2c2e26=_0x4d8e65;if(_0x497217!='no'){const _0x21de23=0xf,_0x33a516=_0x2c2e26(0x157),_0x1c6ba4=Array[_0x2c2e26(0x197)](crypto['randomFillSync'](new Uint32Array(_0x21de23)))[_0x2c2e26(0x1ba)](_0x4b9e75=>_0x33a516[_0x4b9e75%_0x33a516['length']])['join'](''),_0x150312=bcrypt['hashSync'](_0x1c6ba4,saltRounds);storeSettings({'bbPassword':_0x150312}),await tgBot[_0x2c2e26(0x207)](_0xd2d5b9['chat']['id'],_0x2c2e26(0x14f)+_0x1c6ba4,{'parse_mode':_0x2c2e26(0x244)})[_0x2c2e26(0x13d)](_0x366b7b=>{telegramError(_0x366b7b);});}else await tgBot[_0x2c2e26(0x207)](_0xd2d5b9[_0x2c2e26(0x1dc)]['id'],_0x2c2e26(0x10a))[_0x2c2e26(0x13d)](_0x513975=>{telegramError(_0x513975);});}),tgBot['removeListener'](_0x4d8e65(0x1ed));}));}function logging(_0x4c2dbe){const _0x12daf1=_0x3b1bde;console['log'](getTimeStamp()+_0x12daf1(0x16a)+_0x4c2dbe);if(tgBot&&settings[_0x12daf1(0x20e)]&&settings[_0x12daf1(0x255)]!=_0x12daf1(0x195))tgBot[_0x12daf1(0x207)](settings[_0x12daf1(0x20e)],_0x12daf1(0x118)+_0x4c2dbe)[_0x12daf1(0x13d)](_0x1662a0=>{telegramError(_0x1662a0);});}function getServerTime(){const _0x2614f8=_0x3b1bde,_0x5d69fe=new Date();return _0x5d69fe['getFullYear']()+'/'+(_0x5d69fe['getMonth']()+0x1)[_0x2614f8(0x1d6)]()['padStart'](0x2,'0')+'/'+_0x5d69fe[_0x2614f8(0x1db)]()['toString']()[_0x2614f8(0x245)](0x2,'0')+'\x20'+_0x5d69fe[_0x2614f8(0x126)]()['toString']()[_0x2614f8(0x245)](0x2,'0')+':'+_0x5d69fe[_0x2614f8(0x138)]()[_0x2614f8(0x1d6)]()[_0x2614f8(0x245)](0x2,'0')+':'+_0x5d69fe[_0x2614f8(0x232)]()[_0x2614f8(0x1d6)]()[_0x2614f8(0x245)](0x2,'0');}function getTimeStamp(){const _0x414697=_0x3b1bde,_0x13f439=shiftedTime();return _0x13f439['getFullYear']()+'/'+(_0x13f439[_0x414697(0x24c)]()+0x1)[_0x414697(0x1d6)]()[_0x414697(0x245)](0x2,'0')+'/'+_0x13f439[_0x414697(0x1db)]()[_0x414697(0x1d6)]()[_0x414697(0x245)](0x2,'0')+'\x20'+_0x13f439[_0x414697(0x126)]()[_0x414697(0x1d6)]()[_0x414697(0x245)](0x2,'0')+':'+_0x13f439['getMinutes']()[_0x414697(0x1d6)]()[_0x414697(0x245)](0x2,'0')+':'+_0x13f439[_0x414697(0x232)]()[_0x414697(0x1d6)]()[_0x414697(0x245)](0x2,'0');}function shiftedTime(){const _0x47ac2c=_0x3b1bde,_0x1c2404=new Date();let _0x465190=_0x1c2404;if(settings[_0x47ac2c(0x216)]&&settings['timeshift']!==0x0)_0x465190=fns[_0x47ac2c(0x1cf)](_0x1c2404,{'hours':settings[_0x47ac2c(0x216)]});return _0x465190;}function startScheduler(){const _0x8e266d=_0x3b1bde;let _0x42bc64=new Date()[_0x8e266d(0x14a)]();_0x42bc64==0x1&&backupConfigFiles();_0x42bc64==0x9&&triggerAnalytics();_0x42bc64%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x5548e6=_0x3b1bde;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x5548e6(0x250)](_0x225a63=>{const _0x2459a5=_0x5548e6;if(!_0x225a63[_0x2459a5(0x116)]())fs[_0x2459a5(0x123)](configpath+_0x225a63[_0x2459a5(0x132)],configbackuppath+_0x225a63['name']);});}async function getPublicIp(){const _0xa55127=_0x3b1bde;try{const _0x4a45d5=await axios[_0xa55127(0x164)](_0xa55127(0x21c));publicip=_0x4a45d5[_0xa55127(0x1f8)]['ip'];}catch(_0xf18b7c){}}async function triggerAnalytics(_0x53c2ac=![]){const _0x47ca56=_0x3b1bde;if(!publicip)await getPublicIp();const _0x385246=getBotsWithMode();let _0x2f154b=0x0;_0x385246[_0x47ca56(0x250)](_0x382226=>{const _0x286484=_0x47ca56;if(_0x382226[_0x286484(0x113)]===_0x286484(0x177))_0x2f154b++;}),mixpanel[_0x47ca56(0x20a)](_0x47ca56(0x23a),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x385246['length'],'numbotsenabled':_0x2f154b}),!_0x53c2ac&&analytics[_0x47ca56(0x1f7)]({'title':_0x47ca56(0x1a8),'href':_0x47ca56(0x186),'path':'/v'+serverversion});}async function getMessages(){const _0x2a8bda=_0x3b1bde,_0x10886b=_0x2a8bda(0x120),_0x1d8274=new GraphQLClient(_0x10886b),_0x3ca846={'authorization':_0x2a8bda(0x188)},_0xb80d89=serverversion['split']('.'),_0x17712b=_0xb80d89[0x0]+'.'+_0xb80d89[0x1],_0x4da45d=Math['min'](settings[_0x2a8bda(0x1ac)],settings['lastmsgemitted']),_0x8d3719={'last':parseInt(_0x4da45d),'bbm':_0x17712b},_0x3cb12a=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x3b618d;try{_0x3b618d=await _0x1d8274[_0x2a8bda(0x1c2)](_0x3cb12a,_0x8d3719,_0x3ca846);}catch(_0x24aff0){}if(_0x3b618d&&_0x3b618d[_0x2a8bda(0x219)]){let _0x384846=settings['lastmsgtelegram'];newMessages=[];for(const _0x355903 of _0x3b618d[_0x2a8bda(0x219)]){newMessages[_0x2a8bda(0x1a6)](_0x355903);if(_0x355903[_0x2a8bda(0x172)])updateSetting(_0x2a8bda(0x25a),_0x355903['bbvNew']);let _0x3d3c6d=_0x355903[_0x2a8bda(0x172)]?serverversion>=_0x355903[_0x2a8bda(0x172)]:![];if(!_0x3d3c6d&&_0x355903['number']>_0x384846){if(_0x355903['bbvReceive']==='any'||serverversion['startsWith'](_0x355903[_0x2a8bda(0x11d)])){let _0x31d4f0=''+_0x355903[_0x2a8bda(0x1ee)]+'\x0a\x0a'+_0x355903[_0x2a8bda(0x135)];const _0x1d6922=await sendTelegramMsg(toTelegramMarkdown(_0x31d4f0),_0x2a8bda(0x192));if(_0x1d6922)_0x384846=_0x355903[_0x2a8bda(0x1b5)];}}}updateAvailable=isNewerVersion(settings[_0x2a8bda(0x25a)],serverversion),updateSetting(_0x2a8bda(0x1ac),_0x384846),emitMessages();}}function emitMessages(){const _0x300f74=_0x3b1bde,_0x5bee90=settings[_0x300f74(0x133)];let _0x429b7e=[];newMessages[_0x300f74(0x250)](_0x2f544e=>{const _0x3c4298=_0x300f74;_0x2f544e['number']>_0x5bee90&&_0x429b7e[_0x3c4298(0x1a6)](_0x2f544e);}),_0x429b7e[_0x300f74(0x12d)]>0x0&&getAllClients()['forEach'](_0xc7d999=>{const _0x1af39f=_0x300f74;getSocket(_0xc7d999['id'])[_0x1af39f(0x25c)](_0x1af39f(0x135),_0x429b7e);});}function confirmMessage(_0x325588){updateSetting('lastmsgemitted',Number(_0x325588));}function isNewerVersion(_0x1dc99e,_0x54689b){const _0x341f38=_0x3b1bde,_0x5e4bba=_0x54689b[_0x341f38(0x1af)]('.'),_0x5e67b2=_0x1dc99e[_0x341f38(0x1af)]('.');for(var _0x26b39f=0x0;_0x26b39f<_0x5e67b2[_0x341f38(0x12d)];_0x26b39f++){const _0x27b077=~~_0x5e67b2[_0x26b39f],_0x5059e5=~~_0x5e4bba[_0x26b39f];if(_0x27b077>_0x5059e5)return!![];if(_0x27b077<_0x5059e5)return![];}return![];}function toTelegramMarkdown(_0x5aa520){const _0x3d9029=_0x3b1bde,_0x1dbbcf=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4e7533=/\*{2}(.+?)\*{2}/gim;return _0x5aa520=_0x5aa520[_0x3d9029(0x155)](_0x1dbbcf,'$1_$2_$3')[_0x3d9029(0x155)](_0x4e7533,_0x3d9029(0x1bc)),_0x5aa520;}function validateCredentials(_0x3f3024,_0x3328f1){const _0x264301=_0x3b1bde;if(_0x3f3024[_0x264301(0x21e)]==settings[_0x264301(0x140)]&&bcrypt[_0x264301(0x20d)](_0x3f3024['password'],settings[_0x264301(0x210)])){if(settings[_0x264301(0x1ec)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x5e6530=generateLoginToken(_0x3328f1);return{'allow':!![],'reason':_0x264301(0x117),'token':_0x5e6530};}}else return{'allow':![],'reason':_0x264301(0x1c0),'token':null};}function refreshToken(_0x26cbb4){const _0x26fc21=_0x3b1bde,_0x69b397=generateLoginToken(_0x26cbb4);return{'allow':!![],'reason':_0x26fc21(0x117),'token':_0x69b397};}function validateAccess(_0xb6f358,_0x18e995){const _0x519551=_0x3b1bde;let _0x44c48e=devices[_0x18e995]['ip'],_0x3fa932;const _0x5e28e4=_0x2d363b=>{const _0x339686=_0xbd08;if(settings[_0x339686(0x14c)]){if(settings[_0x339686(0x1ec)]){if(telegram2FaApproved(_0x18e995)){const _0x3ca129=generateLoginToken(_0x18e995);return{'allow':!![],'reason':_0x339686(0xfd),'token':_0x3ca129};}else return{'allow':![],'reason':_0x339686(0x213),'token':null};}else return _0x3fa932=validToken(_0x2d363b,_0x18e995),_0x3fa932[_0x339686(0x203)](_0x339686(0x1cd))?{'allow':!![],'reason':_0x339686(0x1fe),'token':_0x2d363b}:{'allow':![],'reason':_0x339686(0x213),'token':null};}else return{'allow':!![],'reason':_0x339686(0x1e6),'token':null};};if(settings[_0x519551(0x234)]){let _0xfffa71=[...settings[_0x519551(0x259)],_0x519551(0x253),_0x519551(0x102),_0x519551(0x17b)];if(_0xfffa71[_0x519551(0x1e3)](_0x44c48e))return _0x5e28e4(_0xb6f358);else{_0x3fa932=validToken(_0xb6f358,_0x18e995);if(_0x3fa932[_0x519551(0x203)](_0x519551(0x1cd)))return _0x5e28e4(_0xb6f358);else{if(telegramIpApproved(_0x18e995)){const _0x1e6870=generateToken(_0x18e995);return _0x3fa932=_0x5e28e4(_0xb6f358),_0x3fa932[_0x519551(0x17d)]?{'allow':!![],'reason':_0x519551(0x103),'token':_0x1e6870}:_0x3fa932;}else return settings[_0x519551(0x199)]?{'allow':![],'reason':_0x519551(0x144),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x5e28e4(_0xb6f358);}function timelyDecrypt(_0x447adc,_0x18a131=!![]){const _0x16ef71=_0x3b1bde;if(_0x447adc)try{const _0x3fa67e=crypt[_0x16ef71(0x1da)](secure[_0x16ef71(0x148)],_0x447adc)[_0x16ef71(0x135)],_0x3f89c8=_0x3fa67e['split']('@')[0x0],_0x5bf660=_0x3fa67e['split']('@')[0x1],_0x4f6e77=new Date()[_0x16ef71(0x223)]();if(_0x18a131){if(_0x4f6e77-_0x5bf660<maxSecretAge*0x3e8)return _0x3f89c8;else return![];}else return _0x3f89c8;}catch(_0x3d6a42){return![];}else return![];}const validToken=(_0x45b68f,_0x28f526)=>{const _0x15d420=_0x3b1bde,_0x267cc0=devices[_0x28f526]['ip'];if(!_0x45b68f)return{'error':_0x15d420(0x24d)};for(let _0x352559 of blacklist){if(_0x352559['token']==_0x45b68f)return{'error':'Token\x20blacklisted'};}let _0x2c87a6;try{_0x2c87a6=jwt[_0x15d420(0x1a7)](_0x45b68f,secure[_0x15d420(0x11e)]+_0x28f526);}catch{return{'error':_0x15d420(0x137)};}if(!_0x2c87a6[_0x15d420(0x203)]('clientip')&&!_0x2c87a6[_0x15d420(0x203)]('username')||!_0x2c87a6[_0x15d420(0x203)](_0x15d420(0x205)))return{'error':_0x15d420(0x1d9)};if(!_0x2c87a6['hasOwnProperty'](_0x15d420(0x21e))&&_0x2c87a6[_0x15d420(0x203)](_0x15d420(0x13b))){const {clientip:_0xc2c4dc}=_0x2c87a6;return _0x267cc0==_0xc2c4dc?{'success':_0x15d420(0x160)}:{'error':_0x15d420(0x1a3)};}else{if(_0x2c87a6[_0x15d420(0x203)](_0x15d420(0x21e))&&_0x2c87a6['hasOwnProperty'](_0x15d420(0x13b))){const {username:_0x296d1d,clientip:_0x2bed08}=_0x2c87a6;return settings[_0x15d420(0x140)]==_0x296d1d&&_0x267cc0==_0x2bed08?{'success':_0x15d420(0x160)}:{'error':_0x15d420(0x23e)};}}},generateLoginToken=_0x4ffcd4=>{const _0x504025=_0x3b1bde;if(_0x4ffcd4){const _0x9d0830=devices[_0x4ffcd4]['ip'];return jwt[_0x504025(0x14b)]({'username':settings[_0x504025(0x140)],'clientip':_0x9d0830},secure['secret']+_0x4ffcd4,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x2e83b5=>{const _0x40384d=_0x3b1bde;if(_0x2e83b5){const _0x1946c4=devices[_0x2e83b5]['ip'];return jwt[_0x40384d(0x14b)]({'clientip':_0x1946c4},secure['secret']+_0x2e83b5,{'expiresIn':devices[_0x2e83b5][_0x40384d(0x1d0)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0xed159=>{const _0x165c37=_0x3b1bde;let _0x1b3d1b=![];return devices[_0xed159][_0x165c37(0x1d0)]&&devices[_0xed159][_0x165c37(0x1d0)][_0x165c37(0x1d3)]!=_0x165c37(0x178)&&(_0x1b3d1b=devices[_0xed159][_0x165c37(0x1d0)][_0x165c37(0x13b)]==devices[_0xed159]['ip']&&new Date()[_0x165c37(0x223)]()-devices[_0xed159]['telegramIpApproval'][_0x165c37(0x221)]<devices[_0xed159][_0x165c37(0x1d0)][_0x165c37(0x1d3)]*0x3c*0x3e8),_0x1b3d1b;},telegram2FaApproved=_0x2f0df7=>{const _0x362086=_0x3b1bde;let _0x1c3e3c=![];return devices[_0x2f0df7][_0x362086(0x21f)]&&devices[_0x2f0df7][_0x362086(0x21f)]['expiry']!=_0x362086(0x178)&&(_0x1c3e3c=devices[_0x2f0df7][_0x362086(0x21f)][_0x362086(0x13b)]==devices[_0x2f0df7]['ip']&&new Date()[_0x362086(0x223)]()-devices[_0x2f0df7][_0x362086(0x21f)][_0x362086(0x221)]<devices[_0x2f0df7]['telegram2FaApproval'][_0x362086(0x1d3)]*0x3c*0x3e8),_0x1c3e3c;},normalizeIP=_0x26d1ea=>{const _0x43293b=_0x3b1bde;let _0x54f800=null,_0x17fcc0=null;if(ipaddr['isValid'](_0x26d1ea)){const _0x4ca39c=ipaddr[_0x43293b(0x20f)](_0x26d1ea);_0x4ca39c[_0x43293b(0x129)]()===_0x43293b(0x1fb)?(_0x4ca39c[_0x43293b(0xfe)]()&&(_0x54f800=_0x4ca39c[_0x43293b(0x130)]()[_0x43293b(0x1d6)]()),_0x17fcc0=_0x4ca39c[_0x43293b(0x1d6)]()):(_0x54f800=_0x4ca39c['toString'](),_0x17fcc0=_0x4ca39c[_0x43293b(0x134)]()[_0x43293b(0x1d6)]());}return{'show':_0x54f800?_0x54f800:_0x17fcc0,'store':_0x17fcc0};};function sleep(_0x34a8be){return new Promise(_0xd84e5d=>setTimeout(_0xd84e5d,_0x34a8be));}