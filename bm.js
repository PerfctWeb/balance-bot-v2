const _0xc692c=_0x374a;(function(_0x3d89d0,_0x2c1087){const _0x148390=_0x374a,_0x229a3b=_0x3d89d0();while(!![]){try{const _0x1460cd=parseInt(_0x148390(0x23a))/0x1*(parseInt(_0x148390(0x30d))/0x2)+-parseInt(_0x148390(0x15b))/0x3+parseInt(_0x148390(0x20e))/0x4+parseInt(_0x148390(0x2ed))/0x5*(parseInt(_0x148390(0x225))/0x6)+parseInt(_0x148390(0x21a))/0x7+parseInt(_0x148390(0x2c0))/0x8*(parseInt(_0x148390(0x1a2))/0x9)+parseInt(_0x148390(0x15e))/0xa*(-parseInt(_0x148390(0x155))/0xb);if(_0x1460cd===_0x2c1087)break;else _0x229a3b['push'](_0x229a3b['shift']());}catch(_0x326d8e){_0x229a3b['push'](_0x229a3b['shift']());}}}(_0x2b56,0x25f32));const _0x3c96d0=function(){let _0x1760f4=!![];return function(_0x30c473,_0x25dc8e){const _0x3265b6=_0x1760f4?function(){if(_0x25dc8e){const _0x288491=_0x25dc8e['apply'](_0x30c473,arguments);return _0x25dc8e=null,_0x288491;}}:function(){};return _0x1760f4=![],_0x3265b6;};}(),_0x1702e2=_0x3c96d0(this,function(){const _0x24258c=_0x374a;return _0x1702e2[_0x24258c(0x306)]()[_0x24258c(0x19c)](_0x24258c(0x199))[_0x24258c(0x306)]()[_0x24258c(0x29e)](_0x1702e2)[_0x24258c(0x19c)](_0x24258c(0x199));});_0x1702e2();'use strict';process[_0xc692c(0x30b)][_0xc692c(0x2b3)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0xc692c(0x303)),low=require(_0xc692c(0x1db)),FileSync=require(_0xc692c(0x30f)),path=require('path'),crypto=require(_0xc692c(0x1ae)),Crypt=require(_0xc692c(0x145))[_0xc692c(0x2e4)],RSA=require(_0xc692c(0x145))[_0xc692c(0x273)],bcrypt=require('bcryptjs'),jwt=require(_0xc692c(0x13d)),ipaddr=require(_0xc692c(0x1ff)),argv=require(_0xc692c(0x1f4))(process[_0xc692c(0x310)]['slice'](0x2))[_0xc692c(0x310)],uuidRandom=require(_0xc692c(0x1de)),{Telegraf,Markup}=require(_0xc692c(0x252)),Mixpanel=require('mixpanel'),axios=require('axios'),{GraphQLClient,gql}=require(_0xc692c(0x135)),util=require(_0xc692c(0x160)),fileUpload=require(_0xc692c(0x285)),{networkInterfaces}=require('os'),PORT=argv[_0xc692c(0x123)]||_0xc692c(0x260),pattern=/^[0-9]{2,4}$/;!pattern[_0xc692c(0x1ca)](PORT)&&(console[_0xc692c(0x2f2)](_0xc692c(0x2a2)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0xc692c(0x132)](0x1));const HOST=argv['host']||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0xc692c(0x15a)]['node'];let bbpath=_0xc692c(0x194),bbpath2='';const botfile=_0xc692c(0x1c5),configfile=_0xc692c(0x17a),settingsfile=_0xc692c(0x149),securefile='bb-secure.json',environment=require('./'+bbpath2+_0xc692c(0x246))[_0xc692c(0x284)]||_0xc692c(0x28d),maxBackups=0xa;let validInstallation=!![];!fs[_0xc692c(0x29f)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0xc692c(0x242)),configpath=userID?bbpath+_0xc692c(0x1cb)+userID+'/':bbpath+_0xc692c(0x1cb),configbackuppath=configpath+_0xc692c(0x1ac),logspath=userID?bbpath+_0xc692c(0x141)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0xc692c(0x1be)+userID+'/':bbpath+_0xc692c(0x1be),loggerfile=fs['createWriteStream'](logspath+_0xc692c(0x31a),{'flags':'a'}),temppath=userID?bbpath+_0xc692c(0x334)+userID+'/':bbpath+_0xc692c(0x334);!fs['existsSync'](configpath)&&fs[_0xc692c(0x178)](configpath);!fs[_0xc692c(0x29f)](configbackuppath)&&fs[_0xc692c(0x178)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0xc692c(0x178)](logspath);!fs[_0xc692c(0x29f)](zippath)&&fs[_0xc692c(0x178)](zippath);!fs['existsSync'](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0xc692c(0x2ef)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);function _0x2b56(){const _0x475ef8=['13070BTeJLm','inlineKeyboard','util','alerts','\x20-\x20','text','sortBy','telegramToken','kill','lastmsgemitted','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','getStartingBalances','off_','set','delete-bot','15\x20min','<b>Balance\x20Bot\x20Status:</b>\x0a','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','reset-history','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','started','message','request','backup-full','running','status','mkdirSync','RSA-OAEP','bb-config.json','/enable\x20-\x20enable\x20notifications\x0a','restore_yes_','sockets','Yes','output-003.log','index.html','headers','update_yes','chat','temporary\x20access\x20rejected','|@|','Enabled\x20Bot\x20','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','node-zip','https://api.ipify.org?format=json','config_orders','config_alerts','live','join','backupfile','IPv4','exchange','confirm-message','yes','string','bb/','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','$1_$2_$3','replace','Telegraf\x20error:','(((.+)+)+)+$','resetHistory','assign','search','warning','defaults','/:bot','notification','event','2133kwAqGf','stringify','getUTCHours','#RES#\x20if\x20running\x20on\x20server','error','/:bot/portfolio','name','sha256','Login\x20accepted','launch','backup/','close','crypto','backup-full@','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','sendPortfolioTelegram','title',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','bbUsername','\x1b[36m','timeshift','verify','\x1b[34m','************','Allow\x20login\x20from\x20IP\x20address\x20','settings.','all','HTML','zip/','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','success','reason','Unauthorized\x20attempt\x20to\x20download\x20','1000','secret','bot.js','::ffff:127.0.0.1','bbPassword','-performance.json','cancel-loading','test','config/','settings','expiry','.zip','file','readFileSync','***','5\x20min','show-config','2FA','simple','sendFile','match','mode','slice','disabled','lowdb','rmSync','address\x20already\x20in\x20use','uuid-random','latestversion','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Unauthorized\x20attempt\x20to\x20delete\x20bot','code','inherit','login\x20token\x20generated','username','push',')\x20|\x20Bot\x20','params','Unauthorized\x20attempt\x20to\x20delete\x20alerts','\x20(2)','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','orders','publicKey','/disable\x20-\x20disable\x20notifications\x0a','sendMessage','init','\x20|\x20','Unauthorized\x20attempt\x20to\x20confirm\x20message','\x1b[33m','yargs/yargs','padStart','headless','login2fa_reject_','Error\x20removing\x20old\x20backup\x20files:','Restoring\x20bot(s)\x20from\x20backup','disconnect','statSync','Network\x20Interfaces:','sign','Idling\x20(','ipaddr.js','getMonth','action','order','Unauthorized\x20attempt\x20to\x20log\x20out','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Telegram\x20error:','start','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Starting\x20#RED#Balance\x20Bot\x20v','Temporary\x20access\x20rejected','from','isIPv4MappedAddress','All\x20bots','length','803428riNWMO','-config.json','Orders','toIPv4MappedAddress','placeOrder','resetpw_yes','internal','blacklist','127.0.0.1','isDirectory','writeFileSync','restore_no_','548863meJTFG','Token\x20blacklisted','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','auth',':\x20Bot\x20Mgr\x20>\x20','6b67f3d61ee94b8f5c80b4affef4c4d9','bbvNew','onepagemode','reinstall_no','password','show','42iXaGsD','sort','Notifications\x20enabled\x0a','args','/status\x20-\x20show\x20bot(s)\x20status\x0a','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','randomFillSync','storeFiat','Restore\x20process\x20confirmed','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','enabled','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','initclient','handshake','randomBytes','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','express','allow','Unauthorized\x20attempt\x20to\x20get\x20events','SIGINT','686NTLWKx','createServer','ETH','Notifications\x20enabled','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','new-disabled','min','login\x20not\x20required','clients','toggleBotMode','invalid\x20credentials','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','version.json','address','server','#RES#\x20','off','button','size','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','All\x20bots\x20running\x20right\x20now','bbvReceive','config_all','Starting\x20(','telegraf','bots','output-001.log','/update\x20-\x20update\x20Balance\x20Bot\x0a','temporaryAccessAllowed','SIGTERM','once','login','CoinMarketCap\x20API\x20key\x20validated','Restarting\x20Bot\x20','toggle','\x1b[0m','Setting\x20access:\x20','Logged\x20in\x20user\x20...','3000','removeAllListeners','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','hashSync','auto','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','_data','\x20(1)','No\x20authentication\x20token','debug','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','getDate','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','login\x20required','getHours','Unauthorized\x20attempt\x20to\x20update\x20bot','storeHeadless','build','backup-files','RSA','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','config','botID','use','User\x20has\x20been\x20validated','Logged\x20out\x20user\x20...','editMessageReplyMarkup','/on\x20-\x20start\x20bot(s)\x0a','whitelist','mtime','endsWith','marketcapApi','get-logs','new','Starting\x20new\x20bot\x20|\x20Bot\x20','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','environment','express-fileupload','ipv6','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','callback','reject','find','alias','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','production','toggle_','telegramEvents','accept','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Password\x20has\x20been\x20reset\x20to:\x20','Notifications\x20types:\x20','All','place-order','/upload-backup','access','reinstall-bb','/:bot/performance','range','/:bot/configuration','No\x20bots\x20running\x20right\x20now','constructor','existsSync','split','update-bot','Error:\x20Invalid\x20argument\x20','lastmsgtelegram','map','number','-----------------------------------------------------------------------------------','bot','reload','get-messages','/start','decrypt','\x20>\x20','token','tempaccess_15_','\x1b[35m','0.0.0','backup','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','NTBA_FIX_319','/download/:type','clientip','then','Backup\x20file\x20uploaded','store-fiat','generate','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','copyFileSync','f2aRequired','telegrammsg','telegramChatId','uuid','7032knjuaw','getFullYear','sendMetricsTelegram','telegram','stopped','Bot\x20','telegramUsername','(staging)','2FA\x20required','Deleted\x20Bot\x20','output-000.log','getSeconds','binary','reinstall','emitHistory','command','family','startsWith','logs','generateKeyPairAsync','pidExpireLogin','::1','reinstall_yes','apiSecret','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','bot-','telegramEnabled','\x20only\x0a','tkn','<b>Telegram\x20Bot\x20Status:</b>\x0a','30\x20min','Failed\x20to\x20download\x20','-events.json','BCT','secure','Crypt','listen','\x1b[31m','type','Unauthorized\x20attempt\x20to\x20update\x20settings','forEach','Bot\x20Mgr\x20>\x20starting\x20Bot\x20',')\x20\x20\x20|\x20Bot\x20','Ok,\x20will\x20send\x20order\x20notifications\x20only','156020wbkeLD',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','write','getMinutes','=>\x20Go\x20to\x20#CYA#http://','log','messages','store-headless','getTime','static','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','\x20to\x20','emit','store-configuration','update','Invalid\x20username\x20or\x20IP\x20address','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','function','/names\x20-\x20show\x20bot\x20names\x0a','userid','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','api-eu.mixpanel.com','date-fns','restore-backup-file','remoteAddress','toString','status\x20code\x20401','referer','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Server','env','Invalid\x20authentication\x20token\x20(2)','472MkDVQv','access\x20timeout','lowdb/adapters/FileSync','argv','filter','unlinkSync','files','socket.io','full','connection','hasOwnProperty','includes','remove','/output-000.log','entries','telegram2FaApproval','privateKey','Error\x20while\x20deleting\x20config\x20files:\x20','keys','add-bot','2FA\x20login\x20token\x20generated','send','/:bot/coins','disable','value','/off\x20-\x20stop\x20bot(s)\x0a','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','parse','telegramIpApproval','track','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','max','stop','staging','socket','apiKey','compareSync','pidRefreshToken','temp/','port','reply','Unauthorized\x20attempt\x20to\x20get\x20messages','login2fa_','reset-password','\x20|\x20client:\x20...','store-settings','whitelistEnabled','manual','apiPassword','Starting\x20Balance\x20Bot\x20reinstallation','cancelLoading','restart','build2','tempaccess_30_','exit','portfolio','deleteHistoryAlerts','graphql-request','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Restore\x20process\x20aborted','isValid','update_no','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','fork','Restore\x20backup\x20file\x20','jsonwebtoken','toggle-bot-mode','#RES#\x20if\x20running\x20locally\x0a','format','logs/','Password\x20reset\x20rejected','store','timestamp','hybrid-crypto-js','kind','readdirSync','output-002.log','bb-settings.json','botname','Unauthorized\x20attempt\x20to\x20show\x20configuration','help','2FA\x20login\x20required','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','/restart\x20-\x20restart\x20bot(s)\x0a','logged\x20out','update-bb','Starting\x20Balance\x20Bot\x20update','temporary\x20access\x20timeout','Invalid\x20authentication\x20token\x20(1)','3443hamoJj','botmanager','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','temporary\x20access\x20not\x20allowed','*$1*','versions','910140nebTEA','get','\x20mode'];_0x2b56=function(){return _0x475ef8;};return _0x2b56();}dbSettings[_0xc692c(0x19e)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0xc692c(0x2ef)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0xc692c(0x1a9),'rsaStandard':_0xc692c(0x179)});const saltRounds=0xa,mixpanel=Mixpanel[_0xc692c(0x1f0)](_0xc692c(0x21f),{'host':_0xc692c(0x302)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0xc692c(0x165)]&&(settings[_0xc692c(0x165)]!=''&&settings[_0xc692c(0x165)]!=_0xc692c(0x1d1))&&settings[_0xc692c(0x2c6)]&&settings[_0xc692c(0x2c6)]!='')initTelegram();const parseColor=(_0x39fed2,_0x25be19)=>{const _0x4c8daf=_0xc692c,_0x515432=/#[A-Z]{3}#/g;if(typeof _0x39fed2==_0x4c8daf(0x193)){!_0x25be19?_0x39fed2=_0x39fed2[_0x4c8daf(0x197)](_0x515432,''):(_0x39fed2=_0x39fed2[_0x4c8daf(0x197)](/#BLU#/g,_0x4c8daf(0x1b8)),_0x39fed2=_0x39fed2[_0x4c8daf(0x197)](/#RED#/g,_0x4c8daf(0x2e6)),_0x39fed2=_0x39fed2['replace'](/#YEL#/g,_0x4c8daf(0x1f3)),_0x39fed2=_0x39fed2[_0x4c8daf(0x197)](/#MAG#/g,_0x4c8daf(0x2af)),_0x39fed2=_0x39fed2[_0x4c8daf(0x197)](/#CYA#/g,_0x4c8daf(0x1b5)),_0x39fed2=_0x39fed2[_0x4c8daf(0x197)](/#RES#/g,_0x4c8daf(0x25d)));;}return _0x39fed2;},logger={'screen':_0x249fdd=>{const _0x4ddf1e=_0xc692c;console[_0x4ddf1e(0x2f2)](parseColor(_0x249fdd,!![]));},'simple':_0x3e22a8=>{const _0xb5bd09=_0xc692c;console['log'](parseColor(_0x3e22a8,!![])),loggerfile[_0xb5bd09(0x2ef)](util['format'](parseColor(_0x3e22a8,![]))+'\x0a');},'full':async _0xb36fe5=>{const _0x398ffb=_0xc692c,_0x45d5b3=getTimeStamp()+_0x398ffb(0x21e)+_0xb36fe5;console[_0x398ffb(0x2f2)](parseColor(_0x45d5b3,!![])),loggerfile[_0x398ffb(0x2ef)](util[_0x398ffb(0x140)](parseColor(_0x45d5b3,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x398ffb(0x1ec))await sendTelegram(settings[_0x398ffb(0x2be)],'Bot\x20Mgr\x20>\x20'+parseColor(_0xb36fe5,![]));},'debug':async(_0x58d30d,_0x392c01='')=>{const _0x55e4a7=_0xc692c,_0x4457a2=getTimeStamp()+_0x55e4a7(0x1b3)+_0x58d30d;if(debugging)console[_0x55e4a7(0x2f2)](parseColor(_0x4457a2,!![]));loggerfile[_0x55e4a7(0x2ef)](util[_0x55e4a7(0x140)](parseColor(_0x4457a2,![]))+'\x0a');if(_0x392c01){if(debugging)console[_0x55e4a7(0x2f2)](_0x392c01);loggerfile['write'](util[_0x55e4a7(0x140)](_0x392c01)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x3d9b1a){const _0x5874cb=_0xc692c;_0x3d9b1a[_0x5874cb(0x306)]()[_0x5874cb(0x318)](_0x5874cb(0x1dd))?(logger[_0x5874cb(0x1d5)](_0x5874cb(0x16f)+_0x3d9b1a[_0x5874cb(0x123)]+'#RES#'),process[_0x5874cb(0x322)]({'terminate':!![]},_0x1cbc9a=>{})):logger['simple'](_0x3d9b1a);}),process['on']('exit',()=>{const _0x2eabb6=_0xc692c;stopAllBots(),process[_0x2eabb6(0x132)](0x0);}),process['on'](_0xc692c(0x257),()=>{const _0x2a7c04=_0xc692c;stopAllBots(),process[_0x2a7c04(0x132)](0x0);}),process['on']('SIGINT',()=>{const _0x3e11ae=_0xc692c;stopAllBots(),process[_0x3e11ae(0x132)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0xc692c(0x246))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0xc692c(0x236)),app=express(),http=require('http')[_0xc692c(0x23b)](app);app[_0xc692c(0x277)](fileUpload({'useTempFiles':!![]})),app['get'](_0xc692c(0x2b4),async(_0x2b2f74,_0x3b8dde)=>{const _0x33bc0d=_0xc692c,_0x41a496=_0x2b2f74[_0x33bc0d(0x1e8)][_0x33bc0d(0x2e7)],_0x97b64b=getClientsWithBotID(_0x33bc0d(0x156)),_0x1a1ad7=_0x2b2f74[_0x33bc0d(0x181)][_0x33bc0d(0x2bf)],_0x3d7080=timelyDecrypt(_0x1a1ad7,![]),_0x2679f9=_0x97b64b[_0x33bc0d(0x28a)](_0x24c348=>_0x24c348['uuid']==_0x3d7080);if(_0x2679f9){const _0x297878=normalizeIP(_0x2b2f74[_0x33bc0d(0x330)][_0x33bc0d(0x305)])[_0x33bc0d(0x143)],_0x719e69=_0x2b2f74[_0x33bc0d(0x181)]['tkn'];if(validateAccess(_0x719e69,_0x3d7080,_0x297878)['allow'])_0x41a496==_0x33bc0d(0x2b1)&&await backupConfigFiles(),await zipFiles(_0x41a496),_0x3b8dde['download'](zippath+(_0x41a496+'.zip'),_0x35afc6=>{const _0x363eea=_0x33bc0d;_0x35afc6&&(logger[_0x363eea(0x315)](_0x363eea(0x2e0)+_0x41a496),logger['simple'](_0x35afc6));});else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x41a496+_0x33bc0d(0x267));}else logger[_0x33bc0d(0x315)](_0x33bc0d(0x1c2)+_0x41a496+_0x33bc0d(0x1ea));}),app['post'](_0xc692c(0x297),async(_0x3724b6,_0x12cbdc)=>{const _0x43e363=_0xc692c,_0x36583f=getClientsWithBotID('botmanager'),_0x2a58ed=_0x3724b6[_0x43e363(0x181)][_0x43e363(0x2bf)],_0x2049f6=timelyDecrypt(_0x2a58ed,![]),_0x4c832f=_0x36583f['find'](_0x5a19a5=>_0x5a19a5[_0x43e363(0x2bf)]==_0x2049f6);logger['debug'](_0x43e363(0x2b7));if(_0x4c832f){const _0x35e726=normalizeIP(_0x3724b6['socket'][_0x43e363(0x305)])[_0x43e363(0x143)],_0x38648d=_0x3724b6['headers'][_0x43e363(0x2dd)];if(validateAccess(_0x38648d,_0x2049f6,_0x35e726)[_0x43e363(0x237)]){if(_0x3724b6[_0x43e363(0x313)]){const _0x523103=_0x3724b6[_0x43e363(0x313)][_0x43e363(0x18e)];await _0x523103['mv'](temppath+_0x523103[_0x43e363(0x1a8)]),_0x12cbdc[_0x43e363(0x322)]({'status':!![],'message':'File\x20uploaded'});const _0x53bb36=getBotsWithMode();_0x53bb36['length']>0x0?confirmRestore(temppath,_0x523103[_0x43e363(0x1a8)]):unzipFile(temppath,_0x523103[_0x43e363(0x1a8)]);}}else logger[_0x43e363(0x315)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger['full'](_0x43e363(0x262));}),app[_0xc692c(0x277)](express['static'](path['join'](__dirname,bbpath2,_0xc692c(0x130)))),app[_0xc692c(0x277)](express[_0xc692c(0x2f6)](path[_0xc692c(0x18d)](__dirname,bbpath2,_0xc692c(0x271)))),app['get']('/',function(_0x53cca6,_0x42de19){const _0x23bf6a=_0xc692c;_0x42de19['sendFile'](path[_0x23bf6a(0x18d)](__dirname,bbpath2,_0x23bf6a(0x130),'index.html'));}),app[_0xc692c(0x15c)](_0xc692c(0x19f),function(_0x5a975b,_0x43f15e){const _0x3bf23a=_0xc692c;_0x43f15e[_0x3bf23a(0x1d6)](path[_0x3bf23a(0x18d)](__dirname,bbpath2,_0x3bf23a(0x271),_0x3bf23a(0x180)));}),app[_0xc692c(0x15c)](_0xc692c(0x1a7),(_0x4c08e4,_0x101c09)=>{const _0x158382=_0xc692c;_0x101c09[_0x158382(0x1d6)](path[_0x158382(0x18d)](__dirname,bbpath2,_0x158382(0x271),_0x158382(0x180)));}),app['get'](_0xc692c(0x29a),(_0x23d98c,_0x43c9ab)=>{const _0x3c1a61=_0xc692c;_0x43c9ab[_0x3c1a61(0x1d6)](path[_0x3c1a61(0x18d)](__dirname,bbpath2,_0x3c1a61(0x271),_0x3c1a61(0x180)));}),app['get'](_0xc692c(0x323),(_0xa339cd,_0x399efc)=>{const _0x59cce4=_0xc692c;_0x399efc[_0x59cce4(0x1d6)](path[_0x59cce4(0x18d)](__dirname,bbpath2,_0x59cce4(0x271),_0x59cce4(0x180)));}),app[_0xc692c(0x15c)]('/:bot/history',(_0x5804dd,_0x1572f1)=>{const _0x371432=_0xc692c;_0x1572f1[_0x371432(0x1d6)](path[_0x371432(0x18d)](__dirname,bbpath2,'build',_0x371432(0x180)));}),app['get'](_0xc692c(0x29c),(_0x3c73b6,_0x112106)=>{const _0xd12047=_0xc692c;_0x112106[_0xd12047(0x1d6)](path[_0xd12047(0x18d)](__dirname,bbpath2,'build','index.html'));}),app['get']('/:bot/support',(_0x2ae26b,_0x2dc987)=>{const _0x337fdd=_0xc692c;_0x2dc987['sendFile'](path[_0x337fdd(0x18d)](__dirname,bbpath2,_0x337fdd(0x271),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http[_0xc692c(0x2e5)](PORT);const io=require(_0xc692c(0x314))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x5cb1ca=_0xc692c;let _0x46f58f='[ip-address]';const _0x3a041b=networkInterfaces(),_0x39a7b8={};for(const _0x118724 of Object[_0x5cb1ca(0x31f)](_0x3a041b)){for(const _0x41f186 of _0x3a041b[_0x118724]){if((_0x41f186['family']==_0x5cb1ca(0x18f)||_0x41f186[_0x5cb1ca(0x2d0)]==0x4)&&!_0x41f186[_0x5cb1ca(0x214)]){const _0x432778=ipaddr[_0x5cb1ca(0x329)](_0x41f186['address'])[_0x5cb1ca(0x29b)]();_0x432778!='private'&&(!_0x39a7b8[_0x118724]&&(_0x39a7b8[_0x118724]=[]),_0x39a7b8[_0x118724][_0x5cb1ca(0x1e6)](_0x41f186[_0x5cb1ca(0x247)]),_0x46f58f=_0x41f186['address']);}}}return{'serverip':_0x46f58f,'netinterfaces':_0x39a7b8};}async function startServer(){const _0xf70b7=_0xc692c,{serverip:_0x47f7e8,netinterfaces:_0x288478}=getServerIP();logger[_0xf70b7(0x1d5)](''),logger[_0xf70b7(0x1d5)](_0xf70b7(0x2a6)),await logger[_0xf70b7(0x315)](_0xf70b7(0x208)+serverversion+_0xf70b7(0x249)+(environment==_0xf70b7(0x32f)?_0xf70b7(0x2c7):'')+'\x0a'+(_0xf70b7(0x204)+PORT+_0xf70b7(0x13f))+(_0xf70b7(0x2f1)+_0x47f7e8+':'+PORT+_0xf70b7(0x1a5))),logger['simple'](_0xf70b7(0x2a6));if(config[_0xf70b7(0x20d)]!=0x0)for(const _0x535163 of config){const _0x3d3389=_0x535163['mode']==_0xf70b7(0x264)?'a':'m';if(_0x535163['status']=='enabled'||_0x535163[_0xf70b7(0x177)]=='new')await logger[_0xf70b7(0x315)](_0xf70b7(0x251)+_0x3d3389+_0xf70b7(0x1e7)+_0x535163['botID']+_0xf70b7(0x1f1)+_0x535163[_0xf70b7(0x14a)]),startBot([_0x535163[_0xf70b7(0x276)],userID],{'cwd':bbpath},function(_0x353a8b){const _0x1f5da4=_0xf70b7;if(_0x353a8b)logger[_0x1f5da4(0x315)](_0x353a8b);});else(_0x535163[_0xf70b7(0x177)]==_0xf70b7(0x1da)||_0x535163[_0xf70b7(0x177)]==_0xf70b7(0x23f))&&await logger[_0xf70b7(0x315)](_0xf70b7(0x1fe)+_0x3d3389+_0xf70b7(0x2eb)+_0x535163['botID']+_0xf70b7(0x1f1)+_0x535163[_0xf70b7(0x14a)]);}else!newBot&&logger[_0xf70b7(0x1d5)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0xf70b7(0x1d5)](_0xf70b7(0x2a6)),logger[_0xf70b7(0x1d5)](''),await logger[_0xf70b7(0x269)]('Node.js\x20v'+nodeversion),await logger[_0xf70b7(0x269)](_0xf70b7(0x1fc),_0x288478);}function startSocket(){const _0x1aa1d5=_0xc692c;io['on'](_0x1aa1d5(0x316),_0x14a2bf=>{const _0x1c438e=_0x1aa1d5;let _0x55d1f1,_0x3aed5e,_0x2afee6,_0x100906,_0xfe307e;const _0x295deb=_0x14a2bf[_0x1c438e(0x233)][_0x1c438e(0x181)][_0x1c438e(0x308)];_0x3aed5e=_0x295deb[_0x1c438e(0x1d7)](/bot[0-9]{3}/);if(_0x3aed5e)_0x2afee6=_0x3aed5e[0x0]['match'](/[0-9]{3}/);if(_0x2afee6)_0x55d1f1=_0x2afee6[0x0];else _0x55d1f1='botmanager';const _0x21973b=_0x14a2bf['handshake'][_0x1c438e(0x21d)]['encryptedUuid'];if(!_0x21973b)_0x14a2bf[_0x1c438e(0x2f9)](_0x1c438e(0x177),{'publicKey':secure[_0x1c438e(0x1ed)]});else{_0x100906=timelyDecrypt(_0x21973b,![]);if(!_0x100906)_0x14a2bf['emit'](_0x1c438e(0x177),{'publicKey':secure[_0x1c438e(0x1ed)]});else{_0xfe307e=normalizeIP(_0x14a2bf['conn'][_0x1c438e(0x305)])['store'];if(!devices[_0x100906])devices[_0x100906]={'uuid':_0x100906,'access':{'token':null}};devices[_0x100906]['ip']=_0xfe307e;const _0x157e2f=addClient(_0x14a2bf['id'],_0x100906,_0x55d1f1);setAccess(_0x157e2f),emitMessages(),_0x14a2bf['on'](_0x1c438e(0x259),_0xaea11b=>{const _0x453525=_0x1c438e,_0xd53af7=timelyDecrypt(_0xaea11b[_0x453525(0x223)],!![],_0x453525(0x185));if(_0xd53af7){_0xaea11b={'username':_0xaea11b[_0x453525(0x1e5)],'password':_0xd53af7},devices[_0x100906]['access']=validateCredentials(_0xaea11b,_0x100906);if(devices[_0x100906][_0x453525(0x298)]['allow']==![]&&devices[_0x100906]['access'][_0x453525(0x1c1)]==_0x453525(0x14d))_0x14a2bf['emit']('status',{'access':devices[_0x100906][_0x453525(0x298)]}),loginAccess2FA(_0x100906,_0xfe307e);else{if(devices[_0x100906][_0x453525(0x298)][_0x453525(0x237)]==![]&&devices[_0x100906]['access']['reason']==_0x453525(0x244))_0x14a2bf[_0x453525(0x2f9)](_0x453525(0x177),{'access':devices[_0x100906][_0x453525(0x298)]});else devices[_0x100906]['access'][_0x453525(0x237)]&&devices[_0x100906][_0x453525(0x298)][_0x453525(0x1c1)]==_0x453525(0x1e4)&&(getClientsWithUuid(_0x100906)['forEach'](_0x4a1278=>{setAccess(_0x4a1278);}),logger[_0x453525(0x269)](_0x453525(0x25f)+_0x100906['slice'](-0x8)),setTokenRefresh(_0x100906),setSessionTimeout('login',_0x100906));}}else logger[_0x453525(0x315)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x14a2bf['on'](_0x1c438e(0x127),()=>{resetPassword();}),_0x14a2bf['on'](_0x1c438e(0x1fa),_0xb64924=>{removeClient(_0x14a2bf['id']);}),_0x55d1f1=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x545cd1){const _0x249aae=_0xc692c;if(_0x545cd1!=_0x249aae(0x156)&&config[_0x249aae(0x331)]!=''){if(pid[_0x545cd1])pid[_0x545cd1][_0x249aae(0x322)]({'function':_0x249aae(0x232),'args':null});}_0x545cd1!=_0x249aae(0x156)&&broadcastToBots(_0x249aae(0x253),JSON[_0x249aae(0x1a3)](config));}function reloadBotManager(){const _0x33fa57=_0xc692c;getClientsWithBotID('botmanager')[_0x33fa57(0x2e9)](_0x8dece9=>{const _0x1f968c=_0x33fa57;getSocket(_0x8dece9['id'])['emit'](_0x1f968c(0x177),{'access':{'allow':![],'reason':_0x1f968c(0x2a8),'token':null}});});}function getSocket(_0x7ee624){const _0x58c296=_0xc692c;return io[_0x58c296(0x17d)][_0x58c296(0x17d)][_0x58c296(0x15c)](_0x7ee624);}function setAccess(_0x1b9c90){const _0x3b7db8=_0xc692c,_0x58051d=getSocket(_0x1b9c90['id']),_0x37684a=_0x1b9c90['uuid'],_0x495e74=_0x1b9c90['bot'];devices[_0x37684a]['access']=validateAccess(devices[_0x37684a]['access'][_0x3b7db8(0x2ad)],_0x37684a),logger['debug'](_0x3b7db8(0x25e)+devices[_0x37684a][_0x3b7db8(0x298)][_0x3b7db8(0x1c1)]+_0x3b7db8(0x128)+_0x1b9c90['id'][_0x3b7db8(0x1d9)](-0x8)+'\x20|\x20user:\x20...'+_0x37684a[_0x3b7db8(0x1d9)](-0x8)),_0x58051d['join'](_0x37684a);if(devices[_0x37684a][_0x3b7db8(0x298)][_0x3b7db8(0x237)]){_0x58051d[_0x3b7db8(0x18d)](_0x495e74);if(_0x495e74==_0x3b7db8(0x156))initializeSocketBotManager(_0x58051d);else initializeSocketBot(_0x58051d);initClient(_0x495e74);}devices[_0x37684a][_0x3b7db8(0x298)][_0x3b7db8(0x2ad)]&&devices[_0x37684a][_0x3b7db8(0x298)][_0x3b7db8(0x1c1)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x3b7db8(0x1d4),_0x37684a),devices[_0x37684a][_0x3b7db8(0x298)][_0x3b7db8(0x2ad)]&&devices[_0x37684a]['access'][_0x3b7db8(0x1c1)]==_0x3b7db8(0x321)&&setSessionTimeout('login',_0x37684a),_0x58051d[_0x3b7db8(0x2f9)](_0x3b7db8(0x177),{'status':_0x1b9c90[_0x3b7db8(0x248)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x37684a][_0x3b7db8(0x298)],'externalip':devices[_0x37684a]['ip'],'publicKey':secure[_0x3b7db8(0x1ed)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x37684a][_0x3b7db8(0x298)][_0x3b7db8(0x237)]==![]&&devices[_0x37684a][_0x3b7db8(0x298)]['reason']==_0x3b7db8(0x2c8)&&temporaryAccess2FA(_0x37684a,devices[_0x37684a]['ip']);}function setSessionTimeout(_0x53bb3c,_0x2bae2){const _0xb1f3ab=_0xc692c;let _0x905c77;if(_0x53bb3c==_0xb1f3ab(0x259))_0x905c77=loginExpiry*0x3c*0x3e8;else _0x905c77=devices[_0x2bae2]['telegramIpApproval'][_0xb1f3ab(0x1cd)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x2bae2][_0xb1f3ab(0x32a)][_0xb1f3ab(0x144)]);if(devices[_0x2bae2][_0xb1f3ab(0x2d4)])clearTimeout(devices[_0x2bae2][_0xb1f3ab(0x2d4)]);devices[_0x2bae2][_0xb1f3ab(0x2d4)]=setTimeout(()=>{const _0x553104=_0xb1f3ab;if(devices[_0x2bae2][_0x553104(0x333)])clearTimeout(devices[_0x2bae2][_0x553104(0x333)]);removeSocketListeners(_0x2bae2),addBlacklist(_0x2bae2),devices[_0x2bae2][_0x553104(0x32a)]=null,devices[_0x2bae2][_0x553104(0x31c)]=null,devices[_0x2bae2][_0x553104(0x298)][_0x553104(0x2ad)]=null,logger['debug']('Session\x20expired\x20for\x20user\x20...'+_0x2bae2['slice'](-0x8)),devices[_0x2bae2][_0x553104(0x298)]=validateAccess(devices[_0x2bae2][_0x553104(0x298)][_0x553104(0x2ad)],_0x2bae2),!(devices[_0x2bae2][_0x553104(0x298)][_0x553104(0x237)]&&devices[_0x2bae2][_0x553104(0x298)][_0x553104(0x1c1)]==_0x553104(0x241))&&(_0x53bb3c=='login'?io['to'](_0x2bae2)[_0x553104(0x2f9)](_0x553104(0x177),{'access':{'allow':![],'reason':_0x553104(0x30e),'token':null}}):io['to'](_0x2bae2)[_0x553104(0x2f9)]('status',{'access':{'allow':![],'reason':_0x553104(0x153),'token':null}})),devices[_0x2bae2][_0x553104(0x298)][_0x553104(0x2ad)]=null;},_0x905c77);}function setTokenRefresh(_0x11bf92){const _0x2d814c=_0xc692c;if(devices[_0x11bf92][_0x2d814c(0x333)])clearTimeout(devices[_0x11bf92][_0x2d814c(0x333)]);devices[_0x11bf92][_0x2d814c(0x333)]=setTimeout(()=>{const _0x54663a=_0x2d814c;getClientsWithUuid(_0x11bf92)['length']!=0x0?(devices[_0x11bf92][_0x54663a(0x298)]=refreshToken(_0x11bf92),io['to'](_0x11bf92)[_0x54663a(0x2f9)](_0x54663a(0x177),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x11bf92][_0x54663a(0x298)],'externalip':devices[_0x11bf92]['ip'],'publicKey':secure[_0x54663a(0x1ed)],'validInstallation':validInstallation}),setTokenRefresh(_0x11bf92)):clearTimeout(devices[_0x11bf92][_0x54663a(0x333)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5095cd){const _0x26d1f6=_0xc692c,_0x1a0ca4=getClient(_0x5095cd['id'])['uuid'];_0x5095cd['emit']('bots',config),_0x5095cd[_0x26d1f6(0x2f9)](_0x26d1f6(0x1cc),cleanSettings()),_0x5095cd['on'](_0x26d1f6(0x320),_0x7c50bc=>{const _0x461c7d=_0x26d1f6;if(validateAccess(_0x7c50bc,_0x1a0ca4)[_0x461c7d(0x237)])addBot();else logger[_0x461c7d(0x315)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x5095cd['on'](_0x26d1f6(0x2a1),(_0x2de092,_0x5f09a6)=>{const _0x954e19=_0x26d1f6;if(validateAccess(_0x5f09a6,_0x1a0ca4)['allow'])toggleBot(_0x2de092['botID'],_0x2de092[_0x954e19(0x177)],_0x2de092[_0x954e19(0x18c)]);else logger[_0x954e19(0x315)](_0x954e19(0x26f));}),_0x5095cd['on'](_0x26d1f6(0x13e),(_0x25d533,_0x54b92d)=>{const _0x28374a=_0x26d1f6;if(validateAccess(_0x54b92d,_0x1a0ca4)[_0x28374a(0x237)])toggleBotMode(_0x25d533);else logger[_0x28374a(0x315)](_0x28374a(0x26f));}),_0x5095cd['on'](_0x26d1f6(0x16c),(_0x5bd3f8,_0x3b604b)=>{const _0x548d97=_0x26d1f6;if(validateAccess(_0x3b604b,_0x1a0ca4)[_0x548d97(0x237)])deleteBot(_0x5bd3f8);else logger[_0x548d97(0x315)](_0x548d97(0x1e1));}),_0x5095cd['on'](_0x26d1f6(0x129),(_0x4bb778,_0x49fdeb)=>{const _0x2cd424=_0x26d1f6;if(validateAccess(_0x49fdeb,_0x1a0ca4)['allow'])storeSettings(_0x4bb778,!![]);else logger[_0x2cd424(0x315)](_0x2cd424(0x2e8));}),_0x5095cd['on']('update-bb',_0xda8a34=>{const _0x4b276a=_0x26d1f6;if(validateAccess(_0xda8a34,_0x1a0ca4)[_0x4b276a(0x237)])updateBB('update');else logger[_0x4b276a(0x315)](_0x4b276a(0x1eb));}),_0x5095cd['on'](_0x26d1f6(0x299),_0x4f85fa=>{const _0x2c4554=_0x26d1f6;if(validateAccess(_0x4f85fa,_0x1a0ca4)[_0x2c4554(0x237)])updateBB(_0x2c4554(0x2cd));else logger[_0x2c4554(0x315)](_0x2c4554(0x1b0));}),_0x5095cd['on']('get-backup-files',_0x25174e=>{const _0x333047=_0x26d1f6;if(validateAccess(_0x25174e,_0x1a0ca4)[_0x333047(0x237)]){const _0x3f9fd3=getClient(_0x5095cd['id']);if(_0x3f9fd3)getBackupFiles(_0x3f9fd3[_0x333047(0x2bf)]);else logger[_0x333047(0x315)](_0x333047(0x231));}else logger[_0x333047(0x315)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x5095cd['on'](_0x26d1f6(0x304),(_0x39dcee,_0x570b0d)=>{const _0x17dd70=_0x26d1f6;if(validateAccess(_0x570b0d,_0x1a0ca4)[_0x17dd70(0x237)])restoreBackupFile(_0x39dcee);else logger['full']('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x5095cd['on'](_0x26d1f6(0x2a9),_0x19858a=>{const _0x200956=_0x26d1f6;if(validateAccess(_0x19858a,_0x1a0ca4)[_0x200956(0x237)])getMessages();else logger[_0x200956(0x315)](_0x200956(0x125));}),_0x5095cd['on'](_0x26d1f6(0x191),(_0x4329a9,_0x43fbd7)=>{const _0x3ee73c=_0x26d1f6;if(validateAccess(_0x43fbd7,_0x1a0ca4)[_0x3ee73c(0x237)])confirmMessage(_0x4329a9);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x5095cd['on']('logout',_0xea09dc=>{const _0x1c9131=_0x26d1f6;if(validateAccess(_0xea09dc,_0x1a0ca4)[_0x1c9131(0x237)]){if(devices[_0x1a0ca4]['pidRefreshToken'])clearTimeout(devices[_0x1a0ca4][_0x1c9131(0x333)]);if(devices[_0x1a0ca4][_0x1c9131(0x2d4)])clearTimeout(devices[_0x1a0ca4][_0x1c9131(0x2d4)]);removeSocketListeners(getClient(_0x5095cd['id'])[_0x1c9131(0x2bf)]),addBlacklist(_0x1a0ca4),devices[_0x1a0ca4][_0x1c9131(0x32a)]=null,devices[_0x1a0ca4][_0x1c9131(0x31c)]=null,devices[_0x1a0ca4][_0x1c9131(0x298)][_0x1c9131(0x2ad)]=null,logger[_0x1c9131(0x269)](_0x1c9131(0x279)+_0x1a0ca4['slice'](-0x8)),io['to'](getClient(_0x5095cd['id'])['uuid'])[_0x1c9131(0x2f9)](_0x1c9131(0x177),{'access':{'allow':![],'reason':_0x1c9131(0x150),'token':null}});}else logger['full'](_0x1c9131(0x203));});}function initializeSocketBot(_0x446e87){const _0x204356=_0xc692c,_0x18a645=getClient(_0x446e87['id'])[_0x204356(0x2a7)],_0xe92f38=getClient(_0x446e87['id'])[_0x204356(0x2bf)];_0x446e87['on'](_0x204356(0x280),(_0x34e314,_0x3f54a2)=>{const _0x17c15e=_0x204356;if(validateAccess(_0x3f54a2,_0xe92f38)[_0x17c15e(0x237)]){if(pid[_0x18a645])pid[_0x18a645][_0x17c15e(0x322)]({'function':_0x17c15e(0x2ce),'args':_0x34e314});}else logger['full'](_0x17c15e(0x238));}),_0x446e87['on']('delete-alerts',(_0x20fb58,_0x189dc3)=>{const _0x1e5ef4=_0x204356;if(validateAccess(_0x189dc3,_0xe92f38)['allow']){if(pid[_0x18a645])pid[_0x18a645][_0x1e5ef4(0x322)]({'function':_0x1e5ef4(0x134),'args':_0x20fb58});}else logger[_0x1e5ef4(0x315)](_0x1e5ef4(0x1e9));}),_0x446e87['on']('get-portfolio',(_0x3ec1cc,_0xfc5d05)=>{const _0x41fea7=_0x204356;if(validateAccess(_0xfc5d05,_0xe92f38)[_0x41fea7(0x237)]){if(pid[_0x18a645])pid[_0x18a645][_0x41fea7(0x322)]({'function':'getPortfolio','args':_0x3ec1cc});}else logger[_0x41fea7(0x315)](_0x41fea7(0x292));}),_0x446e87['on'](_0x204356(0x2fa),(_0x19051a,_0x464a40)=>{const _0x57edfa=_0x204356;if(validateAccess(_0x464a40,_0xe92f38)['allow']){if(pid[_0x18a645])pid[_0x18a645][_0x57edfa(0x322)]({'function':'storeConfiguration','args':_0x19051a});}else logger[_0x57edfa(0x315)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x446e87['on'](_0x204356(0x2f4),(_0x32456c,_0x26b675)=>{const _0x16052b=_0x204356;if(validateAccess(_0x26b675,_0xe92f38)[_0x16052b(0x237)]){if(pid[_0x18a645])pid[_0x18a645][_0x16052b(0x322)]({'function':_0x16052b(0x270),'args':_0x32456c});}else logger[_0x16052b(0x315)](_0x16052b(0x26a));}),_0x446e87['on'](_0x204356(0x2b8),(_0x3a887d,_0x149ebb)=>{const _0x37d22c=_0x204356;if(validateAccess(_0x149ebb,_0xe92f38)['allow']){if(pid[_0x18a645])pid[_0x18a645][_0x37d22c(0x322)]({'function':_0x37d22c(0x22d),'args':_0x3a887d});}else logger['full'](_0x37d22c(0x22b));}),_0x446e87['on'](_0x204356(0x170),_0x3b2949=>{const _0x55fa1d=_0x204356;if(validateAccess(_0x3b2949,_0xe92f38)['allow']){if(pid[_0x18a645])pid[_0x18a645][_0x55fa1d(0x322)]({'function':_0x55fa1d(0x19a),'args':null});}else logger[_0x55fa1d(0x315)](_0x55fa1d(0x157));}),_0x446e87['on']('get-starting-balances',_0xb0f384=>{const _0x589263=_0x204356;if(validateAccess(_0xb0f384,_0xe92f38)['allow']){if(pid[_0x18a645])pid[_0x18a645]['send']({'function':_0x589263(0x169),'args':null});}else logger[_0x589263(0x315)](_0x589263(0x24d));}),_0x446e87['on'](_0x204356(0x296),(_0x91b2f6,_0x5b8a56)=>{const _0x3fc459=_0x204356;if(validateAccess(_0x5b8a56,_0xe92f38)[_0x3fc459(0x237)]){if(pid[_0x18a645])pid[_0x18a645][_0x3fc459(0x322)]({'function':_0x3fc459(0x212),'args':_0x91b2f6});}else logger[_0x3fc459(0x315)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x446e87['on'](_0x204356(0x1c9),_0x39c7b6=>{const _0x419c46=_0x204356;if(validateAccess(_0x39c7b6,_0xe92f38)[_0x419c46(0x237)]){if(pid[_0x18a645])pid[_0x18a645][_0x419c46(0x322)]({'function':_0x419c46(0x12e),'args':null});}else logger['full'](_0x419c46(0x291));}),_0x446e87['on'](_0x204356(0x1d3),_0x339d23=>{const _0x37d582=_0x204356;if(validateAccess(_0x339d23,_0xe92f38)['allow']){if(pid[_0x18a645])pid[_0x18a645][_0x37d582(0x322)]({'function':'showConfig','args':null});}else logger[_0x37d582(0x315)](_0x37d582(0x14b));}),_0x446e87['on'](_0x204356(0x151),_0x3bd75a=>{const _0x476ad7=_0x204356;if(validateAccess(_0x3bd75a,_0xe92f38)[_0x476ad7(0x237)])updateBB(_0x476ad7(0x2fb));else logger[_0x476ad7(0x315)](_0x476ad7(0x1eb));}),_0x446e87['on']('get-messages',_0x44ec1d=>{const _0x4fc367=_0x204356;if(validateAccess(_0x44ec1d,_0xe92f38)['allow'])getMessages();else logger[_0x4fc367(0x315)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x446e87['on']('confirm-message',(_0x5eeefe,_0x209682)=>{const _0x1f5cff=_0x204356;if(validateAccess(_0x209682,_0xe92f38)[_0x1f5cff(0x237)])confirmMessage(_0x5eeefe);else logger[_0x1f5cff(0x315)](_0x1f5cff(0x1f2));}),_0x446e87['on']('logout',_0x15c56c=>{const _0x58cbc1=_0x204356;if(validateAccess(_0x15c56c,_0xe92f38)[_0x58cbc1(0x237)]){if(devices[_0xe92f38][_0x58cbc1(0x333)])clearTimeout(devices[_0xe92f38][_0x58cbc1(0x333)]);if(devices[_0xe92f38][_0x58cbc1(0x2d4)])clearTimeout(devices[_0xe92f38]['pidExpireLogin']);removeSocketListeners(getClient(_0x446e87['id'])[_0x58cbc1(0x2bf)]),addBlacklist(_0xe92f38),devices[_0xe92f38]['telegramIpApproval']=null,devices[_0xe92f38]['telegram2FaApproval']=null,devices[_0xe92f38][_0x58cbc1(0x298)][_0x58cbc1(0x2ad)]=null,logger[_0x58cbc1(0x269)](_0x58cbc1(0x279)+_0xe92f38[_0x58cbc1(0x1d9)](-0x8)),io['to'](getClient(_0x446e87['id'])['uuid'])['emit']('status',{'access':{'allow':![],'reason':_0x58cbc1(0x150),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x4ebefc){const _0x52c848=_0xc692c;getClientsWithUuid(_0x4ebefc)[_0x52c848(0x2e9)](_0x30f9df=>{const _0xda3ddb=_0x52c848;getSocket(_0x30f9df['id'])[_0xda3ddb(0x261)]();});}function cleanSettings(){const _0x3cc8aa=_0xc692c;let _0x244138=settings;return settings[_0x3cc8aa(0x165)]&&settings[_0x3cc8aa(0x165)]!=''&&(_0x244138={..._0x244138,'telegramToken':_0x3cc8aa(0x1b9)}),settings[_0x3cc8aa(0x1c7)]&&settings[_0x3cc8aa(0x1c7)]!=''&&(_0x244138={..._0x244138,'bbPassword':_0x3cc8aa(0x1b9)}),settings[_0x3cc8aa(0x27f)]&&settings[_0x3cc8aa(0x27f)]!=''&&(_0x244138={..._0x244138,'marketcapApi':'************'}),(settings[_0x3cc8aa(0x1c7)]&&settings[_0x3cc8aa(0x1c7)]==_0x3cc8aa(0x1d1)||settings[_0x3cc8aa(0x165)]&&settings[_0x3cc8aa(0x165)]==_0x3cc8aa(0x1d1)||settings[_0x3cc8aa(0x27f)]&&settings[_0x3cc8aa(0x27f)]=='***')&&(_0x244138={..._0x244138,'restored':{'password':settings['bbPassword']==_0x3cc8aa(0x1d1),'telegram':settings[_0x3cc8aa(0x165)]=='***','marketcap':settings['marketcapApi']==_0x3cc8aa(0x1d1)}}),_0x244138;}async function updateBB(_0x57cd99){const _0x588d5e=_0xc692c;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x42f6f9=>{const _0x23c19f=_0x374a;restartBot(_0x42f6f9[_0x23c19f(0x276)]);});if(_0x57cd99==_0x588d5e(0x2fb))process[_0x588d5e(0x322)]({'update':!![],'environment':environment},_0x40b1a3=>{});else _0x57cd99==_0x588d5e(0x2cd)&&process[_0x588d5e(0x322)]({'reinstall':!![],'environment':environment},_0x29ba98=>{});}function startBot(_0x54dfa5,_0x123e13,_0xc3209a){const _0x29d34e=_0xc692c;if(debugging)_0x54dfa5['push']('-d');let _0x1d482b=![];const _0x4e4403=_0x54dfa5[0x0];_0x123e13={..._0x123e13,'stdio':[_0x29d34e(0x1e3),_0x29d34e(0x1e3),_0x29d34e(0x1e3),'ipc']},pid[_0x4e4403]=childProcess[_0x29d34e(0x13b)](botfile,_0x54dfa5,_0x123e13),pid[_0x4e4403]['on']('message',_0x2e9ead=>{const _0x233d9d=_0x29d34e;switch(Object[_0x233d9d(0x31f)](_0x2e9ead)[0x0]){case _0x233d9d(0x14a):updateBotName(_0x4e4403,_0x2e9ead[_0x233d9d(0x14a)]);break;case'updatebotmanager':updateBotManager();break;case _0x233d9d(0x177):updateStatus(_0x4e4403,_0x2e9ead[_0x233d9d(0x177)]);break;case _0x233d9d(0x18c):updateLive(_0x4e4403,_0x2e9ead[_0x233d9d(0x18c)]);break;case _0x233d9d(0x172):updateLive(_0x4e4403,_0x2e9ead[_0x233d9d(0x172)]),io['to'](_0x4e4403)['emit'](_0x233d9d(0x177),{'access':{'allow':![],'reason':_0x233d9d(0x2a8),'token':null}});break;case _0x233d9d(0x32e):_0x2e9ead[_0x233d9d(0x32e)]==_0x233d9d(0x12f)&&restartBot(_0x4e4403);_0x2e9ead['stop']==_0x233d9d(0x166)&&toggleBot(_0x4e4403,_0x233d9d(0x1da),_0x233d9d(0x2c4));break;case'telegram':sendTelegramBot(_0x4e4403,_0x2e9ead[_0x233d9d(0x2c3)]);break;case _0x233d9d(0x2bd):sendTelegramMsg(_0x2e9ead[_0x233d9d(0x2bd)]);break;case _0x233d9d(0x2fe):io['to'](_0x4e4403)[_0x233d9d(0x2f9)](_0x2e9ead[_0x233d9d(0x2fe)],_0x2e9ead[_0x233d9d(0x228)]);break;}}),pid[_0x4e4403]['on'](_0x29d34e(0x1a6),function(_0x228a2f){if(_0x1d482b)return;_0x1d482b=!![],_0xc3209a(_0x228a2f);}),pid[_0x4e4403]['on'](_0x29d34e(0x132),async function(_0x5c2dcf){const _0x3d7dff=_0x29d34e;if(terminating)return;if(installingUpdate){logger[_0x3d7dff(0x269)](_0x3d7dff(0x32c)),io[_0x3d7dff(0x1ad)]();return;}if(_0x1d482b)return;_0x1d482b=!![],_0xc3209a(null);const _0x298fc6=dbConfig['get']('bots')[_0x3d7dff(0x28a)]({'botID':_0x4e4403})['value']();_0x298fc6&&(_0x298fc6['status']==_0x3d7dff(0x230)||_0x298fc6[_0x3d7dff(0x177)]==_0x3d7dff(0x281))&&(await sleep(0x3e8),updateLive(_0x4e4403,_0x3d7dff(0x2c4)),logger['full'](_0x3d7dff(0x25b)+_0x4e4403),startBot([_0x4e4403,userID],{'cwd':bbpath},function(_0x15fe7e){if(_0x15fe7e)logger['full'](_0x15fe7e);}));});}function stopBot(_0xf995ca){getClientsWithBotID(_0xf995ca)['forEach'](_0xe27236=>{const _0x150c98=_0x374a;getSocket(_0xe27236['id'])[_0x150c98(0x1fa)](!![]),removeClient(_0xe27236['id']);}),pid[_0xf995ca]&&(pid[_0xf995ca]['kill'](),pid[_0xf995ca]=null);}function stopAllBots(){const _0x1bac7b=_0xc692c;terminating=!![];const _0x4e8d84=getEnabledBots();_0x4e8d84[_0x1bac7b(0x2e9)](_0x459a12=>{const _0x31f353=_0x1bac7b;stopBot(_0x459a12[_0x31f353(0x276)]);});}function restartBot(_0x4b1b99){const _0x35b9f2=_0xc692c;if(pid[_0x4b1b99])pid[_0x4b1b99][_0x35b9f2(0x166)]();}function addBot(){const _0x31c985=_0xc692c;let _0x165df3;for(let _0x29a5ef=0x1;_0x29a5ef<0x3e9;_0x29a5ef++){_0x165df3=_0x29a5ef[_0x31c985(0x306)]()[_0x31c985(0x1f5)](0x3,'0');let _0x25ccca=config[_0x31c985(0x28a)](_0x343e05=>_0x343e05['botID']==_0x165df3);if(!_0x25ccca)break;}if(_0x165df3===_0x31c985(0x1c3)){logger[_0x31c985(0x315)](_0x31c985(0x23e));return;}logger[_0x31c985(0x315)](_0x31c985(0x282)+_0x165df3),dbConfig[_0x31c985(0x15c)](_0x31c985(0x253))[_0x31c985(0x1e6)]({'botID':_0x165df3,'botname':_0x31c985(0x2c5)+_0x165df3,'status':_0x31c985(0x281),'live':''})[_0x31c985(0x2ef)](),startBot([_0x165df3,userID],{'cwd':bbpath},function(_0x508e44){const _0x387aeb=_0x31c985;if(_0x508e44)logger[_0x387aeb(0x315)](_0x508e44);}),config=getConfiguration(),io['to'](_0x31c985(0x156))['emit'](_0x31c985(0x253),config),broadcastToBots('bots',JSON[_0x31c985(0x1a3)](config));}function deleteBot(_0x235387){const _0x11d1e0=_0xc692c;getClientsWithBotID(_0x235387)[_0x11d1e0(0x2e9)](_0x483bb9=>{const _0x379ca8=_0x11d1e0;getSocket(_0x483bb9['id'])[_0x379ca8(0x1fa)](!![]),removeClient(_0x483bb9['id']);}),dbConfig[_0x11d1e0(0x15c)](_0x11d1e0(0x253))['remove']({'botID':_0x235387})[_0x11d1e0(0x2ef)](),logger[_0x11d1e0(0x315)](_0x11d1e0(0x2c9)+_0x235387),stopBot(_0x235387);try{if(fs[_0x11d1e0(0x29f)](path[_0x11d1e0(0x18d)](configpath,'bot-'+_0x235387+_0x11d1e0(0x20f))))fs[_0x11d1e0(0x312)](path[_0x11d1e0(0x18d)](configpath,_0x11d1e0(0x2da)+_0x235387+_0x11d1e0(0x20f)));if(fs[_0x11d1e0(0x29f)](path[_0x11d1e0(0x18d)](configpath,'bot-'+_0x235387+_0x11d1e0(0x2e1))))fs['unlinkSync'](path[_0x11d1e0(0x18d)](configpath,'bot-'+_0x235387+_0x11d1e0(0x2e1)));if(fs['existsSync'](path[_0x11d1e0(0x18d)](configpath,_0x11d1e0(0x2da)+_0x235387+_0x11d1e0(0x1c8))))fs[_0x11d1e0(0x312)](path[_0x11d1e0(0x18d)](configpath,_0x11d1e0(0x2da)+_0x235387+_0x11d1e0(0x1c8)));if(fs[_0x11d1e0(0x29f)](path[_0x11d1e0(0x18d)](configpath,_0x11d1e0(0x2da)+_0x235387+'-results.json')))fs[_0x11d1e0(0x312)](path[_0x11d1e0(0x18d)](configpath,_0x11d1e0(0x2da)+_0x235387+'-results.json'));}catch(_0x2da855){if(_0x2da855)logger[_0x11d1e0(0x315)](_0x11d1e0(0x31e),_0x2da855);}config=getConfiguration(),io['to'](_0x11d1e0(0x156))['emit'](_0x11d1e0(0x253),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBot(_0x135fc2,_0x2eaa00,_0x33e484){const _0x231ce5=_0xc692c;dbConfig[_0x231ce5(0x15c)](_0x231ce5(0x253))[_0x231ce5(0x28a)]({'botID':_0x135fc2})[_0x231ce5(0x19b)]({'status':_0x2eaa00})[_0x231ce5(0x19b)]({'live':_0x33e484})[_0x231ce5(0x2ef)]();if(_0x2eaa00==_0x231ce5(0x230)||_0x2eaa00=='new')logger['full'](_0x231ce5(0x186)+_0x135fc2),startBot([_0x135fc2,userID],{'cwd':bbpath},function(_0x25c3fd){if(_0x25c3fd)logger['full'](_0x25c3fd);});else(_0x2eaa00==_0x231ce5(0x1da)||_0x2eaa00==_0x231ce5(0x23f))&&(logger[_0x231ce5(0x315)]('Disabled\x20Bot\x20'+_0x135fc2),stopBot(_0x135fc2));config=getConfiguration(),io['to']('botmanager')[_0x231ce5(0x2f9)]('bots',config),broadcastToBots(_0x231ce5(0x253),JSON[_0x231ce5(0x1a3)](config));}function toggleStatus(_0x18f120){const _0x1ccd5d=_0xc692c;let _0x1192cc=dbConfig[_0x1ccd5d(0x15c)]('bots')[_0x1ccd5d(0x28a)]({'botID':_0x18f120})['value'](),_0x4a700c;if(_0x1192cc[_0x1ccd5d(0x177)]===_0x1ccd5d(0x230))_0x4a700c='disabled';else{if(_0x1192cc[_0x1ccd5d(0x177)]===_0x1ccd5d(0x281))_0x4a700c=_0x1ccd5d(0x23f);else{if(_0x1192cc[_0x1ccd5d(0x177)]==='new-disabled')_0x4a700c=_0x1ccd5d(0x281);else{if(_0x1192cc[_0x1ccd5d(0x177)]==='disabled')_0x4a700c='enabled';}}}return _0x4a700c;}function updateStatus(_0xb975c1,_0x446e8f){const _0x492929=_0xc692c;dbConfig[_0x492929(0x15c)](_0x492929(0x253))[_0x492929(0x28a)]({'botID':_0xb975c1})[_0x492929(0x19b)]({'status':_0x446e8f})[_0x492929(0x2ef)](),config=getConfiguration(),io['to'](_0x492929(0x156))[_0x492929(0x2f9)]('bots',config),broadcastToBots(_0x492929(0x253),JSON['stringify'](config));}function updateLive(_0x1d401a,_0x311468){const _0x277030=_0xc692c;dbConfig[_0x277030(0x15c)](_0x277030(0x253))[_0x277030(0x28a)]({'botID':_0x1d401a})[_0x277030(0x19b)]({'live':_0x311468})[_0x277030(0x2ef)](),config=getConfiguration(),io['to']('botmanager')[_0x277030(0x2f9)](_0x277030(0x253),config),broadcastToBots('bots',JSON[_0x277030(0x1a3)](config));}function updateBotName(_0x9e7df4,_0xc7e772){const _0x15c67c=_0xc692c;dbConfig['get'](_0x15c67c(0x253))[_0x15c67c(0x28a)]({'botID':_0x9e7df4})['assign']({'botname':_0xc7e772})[_0x15c67c(0x2ef)](),config=getConfiguration(),io['to'](_0x15c67c(0x156))[_0x15c67c(0x2f9)](_0x15c67c(0x253),config),broadcastToBots(_0x15c67c(0x253),JSON['stringify'](config));}function updateBotManager(){const _0x4019ff=_0xc692c;config=getConfiguration(),io['to'](_0x4019ff(0x156))['emit'](_0x4019ff(0x253),config),broadcastToBots(_0x4019ff(0x253),JSON[_0x4019ff(0x1a3)](config));}function toggleBotMode(_0x437fd5){const _0x43571e=_0xc692c;if(pid[_0x437fd5])pid[_0x437fd5][_0x43571e(0x322)]({'function':_0x43571e(0x243),'args':null});else{const _0x2c37db=configpath+_0x43571e(0x2da)+_0x437fd5+_0x43571e(0x20f),_0x141f2e=fs[_0x43571e(0x1d0)](_0x2c37db),_0x369876=JSON[_0x43571e(0x329)](_0x141f2e),_0x7aab55=_0x369876['bot'][0x0][_0x43571e(0x1f6)];_0x369876[_0x43571e(0x2a7)][0x0]['headless']=!_0x7aab55;const _0x11d419=JSON['stringify'](_0x369876,null,0x2);fs['writeFileSync'](_0x2c37db,_0x11d419),config=getConfiguration(),io['to'](_0x43571e(0x156))[_0x43571e(0x2f9)](_0x43571e(0x253),config),broadcastToBots(_0x43571e(0x253),JSON[_0x43571e(0x1a3)](config));}}function validateTelegram(_0x5ac3b8){const _0x4165ad=_0xc692c;if(_0x5ac3b8[_0x4165ad(0x20a)][_0x4165ad(0x1e5)]!=settings[_0x4165ad(0x2c6)]&&'@'+_0x5ac3b8['from'][_0x4165ad(0x1e5)]!=settings[_0x4165ad(0x2c6)]||_0x5ac3b8['chat']['id']!=settings[_0x4165ad(0x2be)])return sendTelegram(_0x5ac3b8[_0x4165ad(0x183)]['id'],_0x4165ad(0x265),{'parse_mode':_0x4165ad(0x1bd)}),![];return!![];}async function initTelegram(){const _0xe19cc8=_0xc692c;if(tgBot)tgBot['stop'](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0xe19cc8(0x165)]);let _0x4d6d54=_0xe19cc8(0x22a);_0x4d6d54+='\x0a',_0x4d6d54+=_0xe19cc8(0x17b),_0x4d6d54+=_0xe19cc8(0x1ee),_0x4d6d54+=_0xe19cc8(0x14e),_0x4d6d54+=_0xe19cc8(0x14f),_0x4d6d54+=_0xe19cc8(0x27b),_0x4d6d54+=_0xe19cc8(0x326),_0x4d6d54+=_0xe19cc8(0x171),_0x4d6d54+=_0xe19cc8(0x2ff),_0x4d6d54+=_0xe19cc8(0x229),_0x4d6d54+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x4d6d54+=_0xe19cc8(0x2ba),_0x4d6d54+=_0xe19cc8(0x255),_0x4d6d54+=_0xe19cc8(0x287),_0x4d6d54+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x488498='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x488498+='\x0a',_0x488498+=_0x4d6d54,tgBot['catch']((_0x291387,_0x556f66)=>{const _0x2d37c6=_0xe19cc8;logger[_0x2d37c6(0x1d5)](getTimeStamp()+_0x2d37c6(0x2ee)),logger[_0x2d37c6(0x269)](_0x2d37c6(0x198),_0x291387);}),tgBot[_0xe19cc8(0x277)](async(_0x553391,_0x47c5d0)=>{const _0x2798cd=_0xe19cc8;if(!(!settings[_0x2798cd(0x2be)]&&_0x553391['update']['message'][_0x2798cd(0x163)]==_0x2798cd(0x2aa))){if(!validateTelegram(_0x553391))return;}_0x47c5d0();}),tgBot[_0xe19cc8(0x2cf)](_0xe19cc8(0x206),async _0x50784c=>{const _0x1e680b=_0xe19cc8;if(!settings[_0x1e680b(0x2be)])updateSetting('telegramChatId',_0x50784c[_0x1e680b(0x183)]['id']);updateSetting(_0x1e680b(0x2db),!![]);if(!validateTelegram(_0x50784c))return;await sendTelegram(_0x50784c[_0x1e680b(0x183)]['id'],_0x488498);}),tgBot[_0xe19cc8(0x2cf)]('enable',async _0x195f9e=>{const _0x8b921b=_0xe19cc8;updateSetting(_0x8b921b(0x2db),!![]),await sendTelegram(_0x195f9e[_0x8b921b(0x183)]['id'],_0x8b921b(0x23d));}),tgBot[_0xe19cc8(0x2cf)](_0xe19cc8(0x324),async _0x381c38=>{const _0x4fa668=_0xe19cc8;await sendTelegram(_0x381c38[_0x4fa668(0x183)]['id'],'Notifications\x20disabled'),updateSetting('telegramEnabled',![]);}),tgBot[_0xe19cc8(0x2cf)](_0xe19cc8(0x275),async _0x1933f4=>{const _0x4105a1=_0xe19cc8,_0x41eb11=Markup[_0x4105a1(0x15f)]([Markup[_0x4105a1(0x24b)][_0x4105a1(0x288)](_0x4105a1(0x210),_0x4105a1(0x18a)),Markup[_0x4105a1(0x24b)][_0x4105a1(0x288)]('Alerts',_0x4105a1(0x18b)),Markup[_0x4105a1(0x24b)][_0x4105a1(0x288)](_0x4105a1(0x295),'config_all')]);_0x1933f4[_0x4105a1(0x124)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x41eb11);}),tgBot[_0xe19cc8(0x201)](_0xe19cc8(0x18a),async _0x53b2a2=>{const _0x4361cc=_0xe19cc8;_0x53b2a2[_0x4361cc(0x27a)](),updateSetting(_0x4361cc(0x28f),'orders'),updateSetting(_0x4361cc(0x2db),!![]),await sendTelegram(_0x53b2a2['chat']['id'],_0x4361cc(0x2ec));}),tgBot[_0xe19cc8(0x201)](_0xe19cc8(0x18b),async _0x4333b8=>{const _0x526669=_0xe19cc8;_0x4333b8[_0x526669(0x27a)](),updateSetting('telegramEvents','alerts'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x4333b8[_0x526669(0x183)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot['action'](_0xe19cc8(0x250),async _0x38148a=>{const _0x2db4b0=_0xe19cc8;_0x38148a[_0x2db4b0(0x27a)](),updateSetting(_0x2db4b0(0x28f),_0x2db4b0(0x1bc)),updateSetting(_0x2db4b0(0x2db),!![]),await sendTelegram(_0x38148a['chat']['id'],_0x2db4b0(0x26c));}),tgBot[_0xe19cc8(0x2cf)](_0xe19cc8(0x177),async _0x427df4=>{const _0x2b1cab=_0xe19cc8,_0x5afec4=getBotsWithMode();let _0x1d1868=_0x2b1cab(0x16e);config[_0x2b1cab(0x2e9)](_0x5d7932=>{const _0x3d8b9e=_0x2b1cab,_0x117caf=_0x5afec4[_0x3d8b9e(0x28a)](_0x543153=>_0x543153[_0x3d8b9e(0x276)]==_0x5d7932[_0x3d8b9e(0x276)])['mode'];_0x1d1868+=_0x3d8b9e(0x2c5)+_0x5d7932[_0x3d8b9e(0x276)]+':\x20'+_0x5d7932[_0x3d8b9e(0x177)]+'\x20|\x20'+_0x117caf+_0x3d8b9e(0x1f1)+_0x5d7932['live']+'\x0a';}),_0x1d1868+='\x0a',_0x1d1868+=_0x2b1cab(0x2de),_0x1d1868+=!settings[_0x2b1cab(0x2db)]?'Notifications\x20disabled\x0a':_0x2b1cab(0x227),_0x1d1868+=settings[_0x2b1cab(0x2db)]?settings[_0x2b1cab(0x28f)]==_0x2b1cab(0x1bc)?_0x2b1cab(0x136):_0x2b1cab(0x294)+settings[_0x2b1cab(0x28f)]+_0x2b1cab(0x2dc):'',await sendTelegram(_0x427df4[_0x2b1cab(0x183)]['id'],_0x1d1868,{'parse_mode':_0x2b1cab(0x1bd)});}),tgBot[_0xe19cc8(0x2cf)](_0xe19cc8(0x12f),async _0x4bc186=>{const _0x21efd5=_0xe19cc8,_0x6d48ca=getEnabledBots();if(_0x6d48ca[_0x21efd5(0x20d)]==0x0)await sendTelegram(_0x4bc186[_0x21efd5(0x183)]['id'],_0x21efd5(0x29d));else{if(_0x6d48ca[_0x21efd5(0x20d)]>0x1)_0x6d48ca[_0x21efd5(0x1e6)]({'botID':'all'});let _0x4c4cd0=[],_0x4dbf39=[];const _0x30b916=_0x6d48ca[_0x21efd5(0x20d)]%0x4==0x0||_0x6d48ca['length']%0x4==0x3||_0x6d48ca[_0x21efd5(0x20d)]%0x3==0x1?0x4:0x3;let _0x1d8108=0x0;_0x6d48ca[_0x21efd5(0x2e9)]((_0x4a37c7,_0x6492b3)=>{const _0x16f1e9=_0x21efd5;if(_0x6492b3%_0x30b916==0x0)_0x4dbf39=[];_0x4dbf39['push'](Markup[_0x16f1e9(0x24b)][_0x16f1e9(0x288)](_0x4a37c7[_0x16f1e9(0x276)]=='all'?_0x16f1e9(0x20c):'Bot\x20'+_0x4a37c7['botID'],'restart_'+_0x4a37c7['botID'])),_0x6492b3%_0x30b916==0x0&&(_0x4c4cd0[_0x1d8108]=_0x4dbf39,_0x1d8108++);});const _0x50b58c=Markup[_0x21efd5(0x15f)](_0x4c4cd0);_0x4bc186['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x50b58c);}}),tgBot[_0xe19cc8(0x201)](/restart_(.+)/,async _0x1b48cb=>{const _0x221752=_0xe19cc8,_0x4a8c4a=_0x1b48cb['match'][0x1];_0x1b48cb[_0x221752(0x27a)](),_0x4a8c4a==_0x221752(0x1bc)?config[_0x221752(0x2e9)](_0x599875=>{const _0x373d20=_0x221752;restartBot(_0x599875[_0x373d20(0x276)]);}):restartBot(_0x4a8c4a);}),tgBot[_0xe19cc8(0x2cf)]('on',async _0x56e9b3=>{const _0x595a1c=_0xe19cc8,_0xc9662b=getDisabledBots();if(_0xc9662b['length']==0x0)await sendTelegram(_0x56e9b3['chat']['id'],_0x595a1c(0x24e));else{if(_0xc9662b['length']>0x1)_0xc9662b['push']({'botID':_0x595a1c(0x1bc)});let _0x4dd7fc=[],_0x3ca0af=[];const _0x512be9=_0xc9662b[_0x595a1c(0x20d)]%0x4==0x0||_0xc9662b[_0x595a1c(0x20d)]%0x4==0x3||_0xc9662b[_0x595a1c(0x20d)]%0x3==0x1?0x4:0x3;let _0x4461d9=0x0;_0xc9662b[_0x595a1c(0x2e9)]((_0x80caef,_0x2bf4a4)=>{const _0x1fc65d=_0x595a1c;if(_0x2bf4a4%_0x512be9==0x0)_0x3ca0af=[];_0x3ca0af[_0x1fc65d(0x1e6)](Markup['button']['callback'](_0x80caef[_0x1fc65d(0x276)]==_0x1fc65d(0x1bc)?_0x1fc65d(0x20c):_0x1fc65d(0x2c5)+_0x80caef[_0x1fc65d(0x276)],'on_'+_0x80caef[_0x1fc65d(0x276)])),_0x2bf4a4%_0x512be9==0x0&&(_0x4dd7fc[_0x4461d9]=_0x3ca0af,_0x4461d9++);});const _0x1cb6da=Markup[_0x595a1c(0x15f)](_0x4dd7fc);_0x56e9b3[_0x595a1c(0x124)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x1cb6da);}}),tgBot[_0xe19cc8(0x201)](/on_(.+)/,async _0x21fc78=>{const _0x83d344=_0xe19cc8,_0x5c1d23=_0x21fc78[_0x83d344(0x1d7)][0x1];_0x21fc78['editMessageReplyMarkup']();if(_0x5c1d23=='all'){const _0x40f73a=getDisabledBots();await sendTelegram(_0x21fc78[_0x83d344(0x183)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x40f73a[_0x83d344(0x2e9)](_0x181341=>{const _0x2e1cc0=_0x83d344;if(_0x181341[_0x2e1cc0(0x276)]!=_0x2e1cc0(0x1bc))toggleBot(_0x181341[_0x2e1cc0(0x276)],toggleStatus(_0x181341[_0x2e1cc0(0x276)]),_0x2e1cc0(0x2c4));});}else await sendTelegram(_0x21fc78['chat']['id'],_0x83d344(0x2ea)+_0x5c1d23),toggleBot(_0x5c1d23,toggleStatus(_0x5c1d23),_0x83d344(0x2c4));}),tgBot['command'](_0xe19cc8(0x24a),async _0xb60d4e=>{const _0x58e0f0=_0xe19cc8,_0x5a5bf3=getEnabledBots();if(_0x5a5bf3['length']==0x0)await sendTelegram(_0xb60d4e[_0x58e0f0(0x183)]['id'],_0x58e0f0(0x29d));else{if(_0x5a5bf3[_0x58e0f0(0x20d)]>0x1)_0x5a5bf3[_0x58e0f0(0x1e6)]({'botID':_0x58e0f0(0x1bc)});let _0x2c3b92=[],_0x4c69a3=[];const _0x774e56=_0x5a5bf3[_0x58e0f0(0x20d)]%0x4==0x0||_0x5a5bf3['length']%0x4==0x3||_0x5a5bf3[_0x58e0f0(0x20d)]%0x3==0x1?0x4:0x3;let _0x3d4971=0x0;_0x5a5bf3[_0x58e0f0(0x2e9)]((_0x31d1e1,_0x1331d6)=>{const _0x2cb21b=_0x58e0f0;if(_0x1331d6%_0x774e56==0x0)_0x4c69a3=[];_0x4c69a3[_0x2cb21b(0x1e6)](Markup['button'][_0x2cb21b(0x288)](_0x31d1e1['botID']==_0x2cb21b(0x1bc)?_0x2cb21b(0x20c):_0x2cb21b(0x2c5)+_0x31d1e1['botID'],_0x2cb21b(0x16a)+_0x31d1e1[_0x2cb21b(0x276)])),_0x1331d6%_0x774e56==0x0&&(_0x2c3b92[_0x3d4971]=_0x4c69a3,_0x3d4971++);});const _0x565f97=Markup[_0x58e0f0(0x15f)](_0x2c3b92);_0xb60d4e['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x565f97);}}),tgBot[_0xe19cc8(0x201)](/off_(.+)/,async _0x639c92=>{const _0x3b2333=_0xe19cc8,_0x62320b=_0x639c92[_0x3b2333(0x1d7)][0x1];_0x639c92[_0x3b2333(0x27a)]();if(_0x62320b==_0x3b2333(0x1bc)){const _0x29f901=getEnabledBots();await sendTelegram(_0x639c92['chat']['id'],_0x3b2333(0x28c)),_0x29f901[_0x3b2333(0x2e9)](_0x5a0501=>{const _0x4da15d=_0x3b2333;if(_0x5a0501['botID']!=_0x4da15d(0x1bc))toggleBot(_0x5a0501[_0x4da15d(0x276)],toggleStatus(_0x5a0501['botID']),_0x4da15d(0x2c4));});}else await sendTelegram(_0x639c92[_0x3b2333(0x183)]['id'],_0x3b2333(0x2f7)+_0x62320b),toggleBot(_0x62320b,toggleStatus(_0x62320b),'stopped');}),tgBot['command']('metrics',async _0x386e92=>{const _0xc43c8d=_0xe19cc8,_0x4760d8=getEnabledBots();if(_0x4760d8['length']==0x0)await sendTelegram(_0x386e92[_0xc43c8d(0x183)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x4760d8[_0xc43c8d(0x20d)]>0x1){let _0x40bdf8=[],_0x53280f=[];const _0x438e3c=_0x4760d8['length']%0x4==0x0||_0x4760d8['length']%0x4==0x3||_0x4760d8[_0xc43c8d(0x20d)]%0x3==0x1?0x4:0x3;let _0xed750=0x0;_0x4760d8[_0xc43c8d(0x2e9)]((_0x1ffb98,_0x5f3efc)=>{const _0x59a34e=_0xc43c8d;if(_0x5f3efc%_0x438e3c==0x0)_0x53280f=[];_0x53280f[_0x59a34e(0x1e6)](Markup[_0x59a34e(0x24b)][_0x59a34e(0x288)](_0x59a34e(0x2c5)+_0x1ffb98[_0x59a34e(0x276)],'metrics_'+_0x1ffb98[_0x59a34e(0x276)])),_0x5f3efc%_0x438e3c==0x0&&(_0x40bdf8[_0xed750]=_0x53280f,_0xed750++);});const _0x5c0050=Markup['inlineKeyboard'](_0x40bdf8);_0x386e92[_0xc43c8d(0x124)](_0xc43c8d(0x301),_0x5c0050);}else{const _0x708ce2=_0x4760d8[0x0]['botID'];if(pid[_0x708ce2])pid[_0x708ce2]['send']({'function':_0xc43c8d(0x2c2),'args':null});}}}),tgBot[_0xe19cc8(0x201)](/metrics_(.+)/,async _0x1943de=>{const _0x4b5d43=_0xe19cc8,_0x178363=_0x1943de[_0x4b5d43(0x1d7)][0x1];_0x1943de[_0x4b5d43(0x27a)]();if(pid[_0x178363])pid[_0x178363][_0x4b5d43(0x322)]({'function':_0x4b5d43(0x2c2),'args':null});}),tgBot[_0xe19cc8(0x2cf)](_0xe19cc8(0x133),async _0x157992=>{const _0x6f7cc2=_0xe19cc8,_0x4de4be=getEnabledBots();if(_0x4de4be[_0x6f7cc2(0x20d)]==0x0)await sendTelegram(_0x157992[_0x6f7cc2(0x183)]['id'],_0x6f7cc2(0x29d));else{if(_0x4de4be[_0x6f7cc2(0x20d)]>0x1){let _0xbf4fb5=[],_0x5bc4b5=[];const _0x2ad6e1=_0x4de4be[_0x6f7cc2(0x20d)]%0x4==0x0||_0x4de4be[_0x6f7cc2(0x20d)]%0x4==0x3||_0x4de4be['length']%0x3==0x1?0x4:0x3;let _0x20ce6b=0x0;_0x4de4be[_0x6f7cc2(0x2e9)]((_0x4f6420,_0x3c44f0)=>{const _0xb424ee=_0x6f7cc2;if(_0x3c44f0%_0x2ad6e1==0x0)_0x5bc4b5=[];_0x5bc4b5[_0xb424ee(0x1e6)](Markup[_0xb424ee(0x24b)][_0xb424ee(0x288)](_0xb424ee(0x2c5)+_0x4f6420['botID'],'portfolio_'+_0x4f6420['botID'])),_0x3c44f0%_0x2ad6e1==0x0&&(_0xbf4fb5[_0x20ce6b]=_0x5bc4b5,_0x20ce6b++);});const _0x34ef83=Markup[_0x6f7cc2(0x15f)](_0xbf4fb5);_0x157992['reply'](_0x6f7cc2(0x168),_0x34ef83);}else{const _0x1d38ec=_0x4de4be[0x0][_0x6f7cc2(0x276)];if(pid[_0x1d38ec])pid[_0x1d38ec][_0x6f7cc2(0x322)]({'function':_0x6f7cc2(0x1b1),'args':null});}}}),tgBot[_0xe19cc8(0x201)](/portfolio_(.+)/,async _0x1af5a5=>{const _0x4fcd66=_0xe19cc8,_0x4c441c=_0x1af5a5['match'][0x1];_0x1af5a5[_0x4fcd66(0x27a)]();if(pid[_0x4c441c])pid[_0x4c441c][_0x4fcd66(0x322)]({'function':_0x4fcd66(0x1b1),'args':null});}),tgBot['command'](_0xe19cc8(0x2fb),async _0x325a94=>{const _0x68cb7d=_0xe19cc8;await getMessages();if(!updateAvailable)await sendTelegram(_0x325a94['chat']['id'],_0x68cb7d(0x1e0));else{if(!validInstallation)await sendTelegram(_0x325a94[_0x68cb7d(0x183)]['id'],_0x68cb7d(0x2fd));else{const _0x14006d=Markup[_0x68cb7d(0x15f)]([Markup['button'][_0x68cb7d(0x288)](_0x68cb7d(0x17e),_0x68cb7d(0x182)),Markup['button']['callback']('No',_0x68cb7d(0x139))]);_0x325a94[_0x68cb7d(0x124)](_0x68cb7d(0x1bf),_0x14006d);}}}),tgBot[_0xe19cc8(0x201)](/update_(.+)/,async _0x43f30f=>{const _0x5531ec=_0xe19cc8,_0x1afc6d=_0x43f30f[_0x5531ec(0x1d7)][0x1];_0x43f30f['editMessageReplyMarkup'](),_0x1afc6d==_0x5531ec(0x192)&&(await sendTelegram(_0x43f30f['chat']['id'],_0x5531ec(0x152)),updateBB('update')),_0x1afc6d=='no'&&await sendTelegram(_0x43f30f[_0x5531ec(0x183)]['id'],_0x5531ec(0x21c));}),tgBot['command'](_0xe19cc8(0x2cd),async _0x881ff2=>{const _0x1a4e8a=_0xe19cc8;if(!validInstallation)await sendTelegram(_0x881ff2[_0x1a4e8a(0x183)]['id'],_0x1a4e8a(0x195));else{const _0x2fa9f5=Markup[_0x1a4e8a(0x15f)]([Markup['button'][_0x1a4e8a(0x288)]('Yes',_0x1a4e8a(0x2d6)),Markup[_0x1a4e8a(0x24b)][_0x1a4e8a(0x288)]('No',_0x1a4e8a(0x222))]);_0x881ff2[_0x1a4e8a(0x124)](_0x1a4e8a(0x327),_0x2fa9f5);}}),tgBot[_0xe19cc8(0x201)](/reinstall_(.+)/,async _0x27f7fd=>{const _0x39bc85=_0xe19cc8,_0x86bddb=_0x27f7fd[_0x39bc85(0x1d7)][0x1];_0x27f7fd[_0x39bc85(0x27a)](),_0x86bddb==_0x39bc85(0x192)&&(await sendTelegram(_0x27f7fd[_0x39bc85(0x183)]['id'],_0x39bc85(0x12d)),updateBB(_0x39bc85(0x2cd))),_0x86bddb=='no'&&await sendTelegram(_0x27f7fd[_0x39bc85(0x183)]['id'],_0x39bc85(0x2d8));}),tgBot[_0xe19cc8(0x2cf)](_0xe19cc8(0x25c),async _0x38cbca=>{const _0x498908=_0xe19cc8,_0x5c961d=getBotsWithMode();if(_0x5c961d[_0x498908(0x20d)]==0x0)await sendTelegram(_0x38cbca[_0x498908(0x183)]['id'],_0x498908(0x29d));else{let _0x1c0667=[],_0x46b166=[];const _0x34dd6a=0x2;let _0x3eb54e=0x0;_0x5c961d[_0x498908(0x2e9)]((_0x2c902c,_0x3504ae)=>{const _0x47a7c4=_0x498908;if(_0x3504ae%_0x34dd6a==0x0)_0x46b166=[];_0x46b166[_0x47a7c4(0x1e6)](Markup['button'][_0x47a7c4(0x288)](_0x47a7c4(0x2c5)+_0x2c902c['botID']+'\x20('+_0x2c902c[_0x47a7c4(0x1d8)]+')',_0x47a7c4(0x28e)+_0x2c902c[_0x47a7c4(0x276)])),_0x3504ae%_0x34dd6a==0x0&&(_0x1c0667[_0x3eb54e]=_0x46b166,_0x3eb54e++);});const _0xfa73f4=Markup[_0x498908(0x15f)](_0x1c0667);_0x38cbca[_0x498908(0x124)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0xfa73f4);}}),tgBot[_0xe19cc8(0x201)](/toggle_(.+)/,async _0x17f7b2=>{const _0x3b4f6d=_0xe19cc8,_0x4a82de=_0x17f7b2['match'][0x1];_0x17f7b2[_0x3b4f6d(0x27a)]();const _0x26a36e=getBotsWithMode(),_0x242925=_0x26a36e[_0x3b4f6d(0x28a)](_0x28e667=>_0x28e667[_0x3b4f6d(0x276)]==_0x4a82de),_0x161358=_0x242925[_0x3b4f6d(0x1d8)]=='auto'?_0x3b4f6d(0x12b):_0x3b4f6d(0x264);await sendTelegram(_0x17f7b2['chat']['id'],_0x3b4f6d(0x274)+_0x4a82de+_0x3b4f6d(0x2f8)+_0x161358+_0x3b4f6d(0x15d)),toggleBotMode(_0x4a82de);}),tgBot[_0xe19cc8(0x2cf)]('names',async _0x44a093=>{const _0x46c489=_0xe19cc8;let _0x4c6bea='';config[_0x46c489(0x2e9)](_0x4f4f92=>{const _0x19c03b=_0x46c489;_0x4c6bea+=_0x19c03b(0x2c5)+_0x4f4f92[_0x19c03b(0x276)]+':\x20'+_0x4f4f92[_0x19c03b(0x14a)]+'\x0a';}),await sendTelegram(_0x44a093['chat']['id'],_0x4c6bea,{'parse_mode':_0x46c489(0x1bd)});}),tgBot['command'](_0xe19cc8(0x14c),async _0x2d252e=>{const _0x13677a=_0xe19cc8;await sendTelegram(_0x2d252e[_0x13677a(0x183)]['id'],_0x4d6d54);}),process[_0xe19cc8(0x258)](_0xe19cc8(0x239),()=>tgBot['stop']('SIGINT')),process[_0xe19cc8(0x258)](_0xe19cc8(0x257),()=>tgBot[_0xe19cc8(0x32e)](_0xe19cc8(0x257))),tgBot[_0xe19cc8(0x1ab)]();}}function disableTelegram(){const _0x44928a=_0xc692c;tgBot&&tgBot[_0x44928a(0x32e)]();}async function sendTelegram(_0x1d0c9f,_0x46b65a,_0x39ede1){const _0x5760a4=_0xc692c;_0x39ede1={..._0x39ede1,'disable_web_page_preview':!![]};try{await tgBot['telegram'][_0x5760a4(0x1ef)](_0x1d0c9f,_0x46b65a,_0x39ede1);}catch(_0x2b9cf2){console[_0x5760a4(0x2f2)](_0x5760a4(0x205),_0x2b9cf2);}}async function sendTelegramBot(_0xbb9e34,_0x27d0d7){const _0x45a445=_0xc692c;if(settings[_0x45a445(0x2db)]){if(settings['telegramEvents']==_0x45a445(0x1bc)||(_0x27d0d7['type']==_0x45a445(0x1a6)||_0x27d0d7['type']==_0x45a445(0x19d)||_0x27d0d7[_0x45a445(0x2e7)]==_0x45a445(0x1c0))&&settings['telegramEvents']==_0x45a445(0x161)||_0x27d0d7['type']==_0x45a445(0x202)&&settings[_0x45a445(0x28f)]==_0x45a445(0x1ec)){if(tgBot&&settings['telegramChatId']){if(_0x27d0d7['showname'])await sendTelegram(settings[_0x45a445(0x2be)],_0x27d0d7['botname']+'\x20>\x20'+_0x27d0d7[_0x45a445(0x1a1)]);else await sendTelegram(settings[_0x45a445(0x2be)],_0x45a445(0x2c5)+_0xbb9e34+_0x45a445(0x2ac)+_0x27d0d7[_0x45a445(0x1a1)]);}}}}async function sendTelegramMsg(_0x453c60,_0x17a3a9=_0xc692c(0x1bd)){const _0x198482=_0xc692c;return settings[_0x198482(0x2db)]&&tgBot&&settings[_0x198482(0x2be)]?(await sendTelegram(settings[_0x198482(0x2be)],_0x453c60,{'parse_mode':_0x17a3a9}),!![]):![];}function getDeviceWithIp(_0x182ae2){const _0x165163=_0xc692c;return devices[_0x165163(0x28a)](_0x474d34=>_0x474d34['ip']===_0x182ae2);}async function temporaryAccess2FA(_0x5996ca,_0x5af1e3){const _0x3113de=_0xc692c;let _0x27bb70=new Date(),_0x778db2=![];if(lastIpApproval){if(_0x27bb70-lastIpApproval<0x1388)_0x778db2=!![];}lastIpApproval=new Date();if(_0x778db2)return;if(tgBot&&settings[_0x3113de(0x2be)]){const _0x12986f=uuidRandom();tmpStorage[_0x12986f]={'uuid':_0x5996ca,'externalip':_0x5af1e3};const _0xf79463=Markup['inlineKeyboard']([Markup['button'][_0x3113de(0x288)](_0x3113de(0x1d2),'tempaccess_5_'+_0x12986f),Markup[_0x3113de(0x24b)][_0x3113de(0x288)](_0x3113de(0x16d),_0x3113de(0x2ae)+_0x12986f),Markup[_0x3113de(0x24b)][_0x3113de(0x288)](_0x3113de(0x2df),_0x3113de(0x131)+_0x12986f),Markup['button']['callback']('reject','tempaccess_reject_'+_0x12986f)]);await sendTelegram(settings[_0x3113de(0x2be)],_0x3113de(0x13a)+normalizeIP(_0x5af1e3)[_0x3113de(0x224)]+'\x20?',_0xf79463),tgBot[_0x3113de(0x201)](/tempaccess_(.+)_(.+)/,async _0xc815ef=>{const _0x12ce93=_0x3113de,_0x1a2dc1=_0xc815ef['match'][0x1],_0x3ab622=_0xc815ef[_0x12ce93(0x1d7)][0x2],{uuid:_0x15898a,externalip:_0x7c57e9}=tmpStorage[_0x3ab622];delete tmpStorage[_0x3ab622],_0xc815ef[_0x12ce93(0x27a)](),devices[_0x15898a][_0x12ce93(0x32a)]={'clientip':_0x7c57e9,'timestamp':new Date()['getTime'](),'expiry':_0x1a2dc1},_0x1a2dc1!=_0x12ce93(0x289)?(await sendTelegram(_0xc815ef[_0x12ce93(0x183)]['id'],'Access\x20enabled\x20for\x20'+_0x1a2dc1+'\x20minutes',{'parse_mode':'HTML'}),io['to'](_0x15898a)[_0x12ce93(0x2f9)](_0x12ce93(0x177),{'access':{'allow':![],'reason':_0x12ce93(0x2a8),'token':null}})):(await sendTelegram(_0xc815ef[_0x12ce93(0x183)]['id'],_0x12ce93(0x209)),io['to'](_0x15898a)['emit'](_0x12ce93(0x177),{'access':{'allow':![],'reason':_0x12ce93(0x184),'token':null}}));});}}async function loginAccess2FA(_0x208165,_0x42e125){const _0x47c612=_0xc692c;if(tgBot&&settings[_0x47c612(0x2be)]){const _0x5a449b=uuidRandom();tmpStorage[_0x5a449b]={'uuid':_0x208165,'externalip':_0x42e125};const _0x2cdd58=Markup[_0x47c612(0x15f)]([Markup[_0x47c612(0x24b)][_0x47c612(0x288)](_0x47c612(0x290),_0x47c612(0x126)+loginExpiry+'_'+_0x5a449b),Markup[_0x47c612(0x24b)]['callback'](_0x47c612(0x289),_0x47c612(0x1f7)+_0x5a449b)]);await sendTelegram(settings[_0x47c612(0x2be)],_0x47c612(0x1ba)+normalizeIP(_0x42e125)[_0x47c612(0x224)]+'\x20?',_0x2cdd58),tgBot[_0x47c612(0x201)](/login2fa_(.+)_(.+)/,async _0x41b36c=>{const _0x491b9e=_0x47c612,_0x296232=_0x41b36c[_0x491b9e(0x1d7)][0x1],_0x1fa548=_0x41b36c[_0x491b9e(0x1d7)][0x2],{uuid:_0x1e50ef,externalip:_0x31fbcc}=tmpStorage[_0x1fa548];delete tmpStorage[_0x1fa548],_0x41b36c[_0x491b9e(0x27a)](),devices[_0x1e50ef][_0x491b9e(0x31c)]={'clientip':_0x31fbcc,'timestamp':new Date()[_0x491b9e(0x2f5)](),'expiry':_0x296232},_0x296232!=_0x491b9e(0x289)?(await sendTelegram(_0x41b36c[_0x491b9e(0x183)]['id'],_0x491b9e(0x1aa),{'parse_mode':'HTML'}),io['to'](_0x1e50ef)['emit'](_0x491b9e(0x177),{'access':{'allow':![],'reason':_0x491b9e(0x2a8),'token':null}})):(await sendTelegram(_0x41b36c[_0x491b9e(0x183)]['id'],'Login\x20rejected'),io['to'](_0x1e50ef)[_0x491b9e(0x2f9)]('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function _0x374a(_0x316825,_0x4aa30c){const _0x25eda3=_0x2b56();return _0x374a=function(_0x1702e2,_0x3c96d0){_0x1702e2=_0x1702e2-0x123;let _0x2b5614=_0x25eda3[_0x1702e2];return _0x2b5614;},_0x374a(_0x316825,_0x4aa30c);}function getEnabledBots(){const _0x58a792=_0xc692c;return dbConfig[_0x58a792(0x15c)](_0x58a792(0x253))[_0x58a792(0x164)](_0x58a792(0x276))['filter']({'status':_0x58a792(0x230)})[_0x58a792(0x325)]()||[];}function getDisabledBots(){const _0x2397f3=_0xc692c;return dbConfig['get'](_0x2397f3(0x253))[_0x2397f3(0x164)](_0x2397f3(0x276))[_0x2397f3(0x311)]({'status':_0x2397f3(0x1da)})['value']()||[];}function getBotAttributes(_0x53c442){const _0x2f577a=_0xc692c;let _0x4bbd4f={};const _0x167b6d=configpath+'bot-'+_0x53c442+'-config.json',_0x44b11e=fs['existsSync'](_0x167b6d);if(_0x44b11e){const _0x4de051=fs['readFileSync'](_0x167b6d);try{const _0x51a54a=JSON['parse'](_0x4de051),_0xf1d543=_0x51a54a?_0x51a54a[_0x2f577a(0x2a7)][0x0][_0x2f577a(0x1f6)]:![];_0x4bbd4f[_0x2f577a(0x1d8)]=_0xf1d543?_0x2f577a(0x264):'manual',_0x4bbd4f[_0x2f577a(0x14a)]=_0x51a54a?_0x51a54a[_0x2f577a(0x2a7)][0x0][_0x2f577a(0x14a)]:_0x2f577a(0x2c5)+_0x53c442;}catch(_0x9df883){_0x4bbd4f[_0x2f577a(0x1d8)]=_0x2f577a(0x12b),_0x4bbd4f['botname']=_0x2f577a(0x2c5)+_0x53c442;}}else _0x4bbd4f[_0x2f577a(0x1d8)]=_0x2f577a(0x12b),_0x4bbd4f[_0x2f577a(0x14a)]=_0x2f577a(0x2c5)+_0x53c442;return _0x4bbd4f;}function getBotsWithMode(){const _0x361906=_0xc692c,_0x58beb6=dbConfig[_0x361906(0x15c)]('bots')[_0x361906(0x164)]('botID')['value']()||[];return _0x58beb6['forEach'](_0x113a42=>{const _0x3342db=_0x361906;let _0x59ebca=getBotAttributes(_0x113a42[_0x3342db(0x276)]);_0x113a42[_0x3342db(0x1d8)]=_0x59ebca[_0x3342db(0x1d8)];}),_0x58beb6;}function getBotExchanges(){const _0x2c86d2=_0xc692c;let _0x5d7967=[];const _0x4abe7c=dbConfig[_0x2c86d2(0x15c)](_0x2c86d2(0x253))['sortBy'](_0x2c86d2(0x276))[_0x2c86d2(0x325)]()||[];_0x4abe7c[_0x2c86d2(0x2e9)](_0xecb14a=>{const _0x154521=_0x2c86d2;if(_0xecb14a[_0x154521(0x177)]==_0x154521(0x230)){const _0x46b310=configpath+_0x154521(0x2da)+_0xecb14a[_0x154521(0x276)]+'-config.json',_0x213ff5=fs[_0x154521(0x29f)](_0x46b310);let _0x53f2ce;if(_0x213ff5){const _0x3fca7f=fs[_0x154521(0x1d0)](_0x46b310);try{const _0x1496d4=JSON[_0x154521(0x329)](_0x3fca7f);_0x53f2ce=_0x1496d4?_0x1496d4[_0x154521(0x2a7)][0x0][_0x154521(0x190)]:null;}catch(_0x55a169){}}if(_0x53f2ce)_0x5d7967[_0x154521(0x1e6)](_0x53f2ce);}});const _0x4f5d62=[...new Set(_0x5d7967)][_0x2c86d2(0x226)]();return _0x4f5d62;}async function initUser(){const _0x3d01c7=_0xc692c;if(!settings[_0x3d01c7(0x300)]){const _0x37ba57=uuidRandom();mixpanel[_0x3d01c7(0x28b)](_0x37ba57),updateSetting(_0x3d01c7(0x300),_0x37ba57);}}async function initSecure(){const _0x50044f=_0xc692c;let _0x20ccee=getSecure();if(!_0x20ccee['hasOwnProperty'](_0x50044f(0x1c4))){let _0x44dcb0=await generateKeys();_0x20ccee['publicKey']=_0x44dcb0['publicKey'],_0x20ccee['privateKey']=_0x44dcb0[_0x50044f(0x31d)],_0x20ccee[_0x50044f(0x1c4)]=crypto[_0x50044f(0x234)](0x20)[_0x50044f(0x306)]('hex');;storeSecure(_0x20ccee);}}function getSettings(){const _0x944319=_0xc692c;return dbSettings['get'](_0x944319(0x1cc))[_0x944319(0x325)]()||{};}function getSecure(){const _0x3dfc51=_0xc692c;return dbSecure[_0x3dfc51(0x15c)]('secure')[_0x3dfc51(0x325)]()||{};}function getBlacklist(){const _0x333601=_0xc692c;return dbSecure[_0x333601(0x15c)](_0x333601(0x215))[_0x333601(0x325)]()||[];}function broadcastToBots(_0x417dbb,_0x4159f3){const _0x4de6b9=_0xc692c;config[_0x4de6b9(0x2e9)](_0x362db8=>{const _0x1abbb2=_0x4de6b9;if(_0x362db8[_0x1abbb2(0x177)]=='enabled'&&_0x362db8[_0x1abbb2(0x18c)]==_0x1abbb2(0x176)||_0x362db8[_0x1abbb2(0x177)]=='new'&&_0x362db8[_0x1abbb2(0x18c)]==_0x1abbb2(0x176)){if(pid[_0x362db8[_0x1abbb2(0x276)]])pid[_0x362db8[_0x1abbb2(0x276)]][_0x1abbb2(0x322)]({[_0x417dbb]:_0x4159f3});}});}async function storeSettings(_0x135497,_0x4b150c=![]){const _0x240e14=_0xc692c;_0x135497={...settings,..._0x135497};if(_0x4b150c&&_0x135497['bbPassword']!=_0x240e14(0x1b9)&&_0x135497[_0x240e14(0x1c7)]!=_0x240e14(0x1d1)&&_0x135497['bbPassword']!=''){const _0xb3f373=crypt[_0x240e14(0x2ab)](secure['privateKey'],_0x135497[_0x240e14(0x1c7)])[_0x240e14(0x173)][_0x240e14(0x2a0)](_0x240e14(0x185))[0x0],_0x18d66f=bcrypt[_0x240e14(0x263)](_0xb3f373,saltRounds);_0x135497={..._0x135497,'bbPassword':_0x18d66f};}if(_0x4b150c&&_0x135497[_0x240e14(0x165)]!=_0x240e14(0x1b9)&&_0x135497[_0x240e14(0x165)]!='***'&&_0x135497[_0x240e14(0x165)]!=''){const _0x44ace8=crypt[_0x240e14(0x2ab)](secure[_0x240e14(0x31d)],_0x135497[_0x240e14(0x165)])['message'][_0x240e14(0x2a0)]('|@|')[0x0];_0x135497={..._0x135497,'telegramToken':_0x44ace8};}if(_0x4b150c&&_0x135497[_0x240e14(0x27f)]!=_0x240e14(0x1b9)&&_0x135497[_0x240e14(0x27f)]!='***'&&_0x135497[_0x240e14(0x27f)]!=''){const _0x31d119=crypt['decrypt'](secure[_0x240e14(0x31d)],_0x135497[_0x240e14(0x27f)])[_0x240e14(0x173)]['split']('|@|')[0x0];_0x135497={..._0x135497,'marketcapApi':_0x31d119};}const _0x1864d9=_0x135497[_0x240e14(0x165)]!=_0x240e14(0x1b9)&&_0x135497['telegramToken']!=settings['telegramToken']||_0x135497[_0x240e14(0x2c6)]!=settings[_0x240e14(0x2c6)],_0x3b3750=_0x135497[_0x240e14(0x165)]==''||_0x135497[_0x240e14(0x2c6)]=='',_0x21f2c6=_0x135497[_0x240e14(0x27f)]&&_0x135497['marketcapApi']!='************'&&_0x135497[_0x240e14(0x27f)]!=settings['telegramToken'];_0x1864d9&&(_0x135497[_0x240e14(0x2be)]=null,_0x135497[_0x240e14(0x28f)]='all');for(const [_0x512fdc,_0x7e87f3]of Object[_0x240e14(0x31b)](_0x135497)){if(_0x512fdc==_0x240e14(0x165)&&_0x7e87f3==_0x240e14(0x1b9)){_0x135497[_0x240e14(0x165)]=settings[_0x240e14(0x165)];continue;};if(_0x512fdc=='bbPassword'&&_0x7e87f3==_0x240e14(0x1b9)){_0x135497['bbPassword']=settings[_0x240e14(0x1c7)];continue;};if(_0x512fdc=='marketcapApi'&&_0x7e87f3==_0x240e14(0x1b9)){_0x135497[_0x240e14(0x27f)]=settings[_0x240e14(0x27f)];continue;};dbSettings[_0x240e14(0x16b)](_0x240e14(0x1bb)+_0x512fdc,_0x7e87f3)['write']();}settings=_0x135497,io['to'](_0x240e14(0x156))[_0x240e14(0x2f9)](_0x240e14(0x1cc),cleanSettings()),broadcastToBots(_0x240e14(0x1b6),settings[_0x240e14(0x1b6)]),broadcastToBots(_0x240e14(0x221),settings[_0x240e14(0x221)]),broadcastToBots(_0x240e14(0x27f),settings[_0x240e14(0x27f)]);if(_0x1864d9&&!_0x3b3750)initTelegram();if(_0x1864d9&&_0x3b3750)disableTelegram();getAllClients()[_0x240e14(0x2e9)](_0x49be6b=>{const _0x1b9282=_0x240e14;getSocket(_0x49be6b['id'])[_0x1b9282(0x2f9)]('status',{'access':{'allow':![],'reason':_0x1b9282(0x2a8),'token':null}});}),_0x21f2c6&&(await sleep(0xbb8),testMarketcapApi(_0x135497[_0x240e14(0x27f)]));}async function testMarketcapApi(_0x16cf7b){const _0x35a0f5=_0xc692c,_0x484ea1=[_0x35a0f5(0x2e2),_0x35a0f5(0x23c)];try{await axios[_0x35a0f5(0x15c)]('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0x16cf7b},'params':{'symbol':_0x484ea1[_0x35a0f5(0x306)]()}});}catch(_0x490634){_0x490634[_0x35a0f5(0x306)]()[_0x35a0f5(0x318)](_0x35a0f5(0x307))?(io['to'](_0x35a0f5(0x156))[_0x35a0f5(0x2f9)](_0x35a0f5(0x1a0),_0x35a0f5(0x328)),logger['full'](_0x35a0f5(0x328))):(io['to'](_0x35a0f5(0x156))[_0x35a0f5(0x2f9)](_0x35a0f5(0x1a0),_0x35a0f5(0x245)),logger[_0x35a0f5(0x315)](_0x35a0f5(0x245)),logger[_0x35a0f5(0x269)]('Error\x20details:',_0x490634[_0x35a0f5(0x306)]()+_0x35a0f5(0x162)+_0x490634[_0x35a0f5(0x1e2)]));return;}logger[_0x35a0f5(0x269)](_0x35a0f5(0x25a));}function updateSetting(_0x11b8ac,_0xac7e90){const _0x20cc9d=_0xc692c;dbSettings[_0x20cc9d(0x16b)]('settings.'+_0x11b8ac,_0xac7e90)[_0x20cc9d(0x2ef)](),settings=getSettings(),io['to'](_0x20cc9d(0x156))[_0x20cc9d(0x2f9)](_0x20cc9d(0x1cc),cleanSettings());}function storeSecure(_0x485148){const _0x5eec42=_0xc692c;dbSecure['get'](_0x5eec42(0x2e3))['push'](_0x485148)[_0x5eec42(0x2ef)](),secure=_0x485148;}function addBlacklist(_0x293651){const _0x536751=_0xc692c;cleanBlacklist();let _0x1fa90e;devices[_0x293651][_0x536751(0x32a)]?_0x1fa90e=Math[_0x536751(0x32d)](devices[_0x293651][_0x536751(0x32a)]['expiry'],loginExpiry):_0x1fa90e=loginExpiry,dbSecure[_0x536751(0x15c)](_0x536751(0x215))[_0x536751(0x1e6)]({'expiry':new Date()[_0x536751(0x2f5)]()+_0x1fa90e*0x3c*0x3e8,'token':devices[_0x293651][_0x536751(0x298)][_0x536751(0x2ad)]})['write'](),blacklist=dbSecure[_0x536751(0x15c)](_0x536751(0x215))[_0x536751(0x325)]();}function cleanBlacklist(){const _0x401a02=_0xc692c;let _0x26b98f=dbSecure['get']('blacklist')['cloneDeep']()[_0x401a02(0x325)](),_0x3e5708=new Date()['getTime']();_0x26b98f[_0x401a02(0x2e9)](_0x32c46f=>{const _0x3fd40d=_0x401a02;_0x32c46f['expiry']<_0x3e5708&&dbSecure[_0x3fd40d(0x15c)](_0x3fd40d(0x215))[_0x3fd40d(0x319)]({'expiry':_0x32c46f['expiry']})[_0x3fd40d(0x2ef)]();});}function initStates(){let _0x482a61=getConfiguration();_0x482a61['forEach'](_0x40cf55=>{const _0x4b042f=_0x374a;_0x40cf55[_0x4b042f(0x18c)]='stopped';}),storeConfiguration(_0x482a61);}function onKeys(){const _0x4f0833=new RSA();return new Promise(_0xd481d4=>{const _0x4caf4d=_0x374a;_0x4f0833[_0x4caf4d(0x2d3)]()[_0x4caf4d(0x2b6)](_0x3f53d2=>{_0xd481d4(_0x3f53d2);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5dcb57=_0xc692c;let _0x2c18e5=getSettings(),_0x4bd2a1=![];!_0x2c18e5[_0x5dcb57(0x317)](_0x5dcb57(0x2a3))&&(_0x2c18e5['lastmsgtelegram']=0x0,_0x4bd2a1=!![]);!_0x2c18e5[_0x5dcb57(0x317)]('lastmsgemitted')&&(_0x2c18e5['lastmsgemitted']=0x0,_0x4bd2a1=!![]);!_0x2c18e5[_0x5dcb57(0x317)](_0x5dcb57(0x1df))&&(_0x2c18e5[_0x5dcb57(0x1df)]=_0x5dcb57(0x2b0),_0x4bd2a1=!![]);!_0x2c18e5[_0x5dcb57(0x317)](_0x5dcb57(0x221))&&(_0x2c18e5[_0x5dcb57(0x221)]=![],_0x4bd2a1=!![]);!_0x2c18e5[_0x5dcb57(0x317)]('marketcapApi')&&(_0x2c18e5[_0x5dcb57(0x27f)]='',_0x4bd2a1=!![]);if(_0x4bd2a1)storeSettings(_0x2c18e5);try{fs[_0x5dcb57(0x147)](configbackuppath,{'withFileTypes':!![]})[_0x5dcb57(0x2e9)](_0x1f9e89=>{const _0x2f0339=_0x5dcb57;if(!_0x1f9e89['isDirectory']()){if(!_0x1f9e89[_0x2f0339(0x1a8)][_0x2f0339(0x2d1)]('backup-full@'))fs['unlinkSync'](configbackuppath+_0x1f9e89[_0x2f0339(0x1a8)]);}else fs[_0x2f0339(0x1dc)](configbackuppath+_0x1f9e89[_0x2f0339(0x1a8)],{'recursive':!![]});});}catch(_0x447e01){logger[_0x5dcb57(0x269)](_0x5dcb57(0x1f8),_0x447e01);}}function storeConfiguration(_0x420e72){const _0x551f69=_0xc692c;dbConfig['get'](_0x551f69(0x253))['remove']()[_0x551f69(0x2ef)](),dbConfig[_0x551f69(0x15c)](_0x551f69(0x253))[_0x551f69(0x1e6)](..._0x420e72)[_0x551f69(0x2ef)](),config=_0x420e72;}async function resetPassword(){const _0x440e7c=_0xc692c;if(tgBot&&settings[_0x440e7c(0x2be)]){const _0xa1892d=Markup[_0x440e7c(0x15f)]([Markup['button'][_0x440e7c(0x288)](_0x440e7c(0x192),_0x440e7c(0x213)),Markup[_0x440e7c(0x24b)]['callback']('no','resetpw_no')]);await sendTelegram(settings[_0x440e7c(0x2be)],_0x440e7c(0x309),_0xa1892d),tgBot[_0x440e7c(0x201)](/resetpw_(.+)/,async _0x1ed891=>{const _0x4954bc=_0x440e7c,_0x568810=_0x1ed891[_0x4954bc(0x1d7)][0x1];_0x1ed891[_0x4954bc(0x27a)]();if(_0x568810!='no'){const _0x1a1c30=0xf,_0x32fbac=_0x4954bc(0x187),_0x106f91=Array[_0x4954bc(0x20a)](crypto[_0x4954bc(0x22c)](new Uint32Array(_0x1a1c30)))[_0x4954bc(0x2a4)](_0xf1ddf8=>_0x32fbac[_0xf1ddf8%_0x32fbac[_0x4954bc(0x20d)]])['join'](''),_0x31e8aa=bcrypt[_0x4954bc(0x263)](_0x106f91,saltRounds);storeSettings({'bbPassword':_0x31e8aa}),await sendTelegram(_0x1ed891[_0x4954bc(0x183)]['id'],_0x4954bc(0x293)+_0x106f91,{'parse_mode':_0x4954bc(0x1bd)});}else await sendTelegram(_0x1ed891[_0x4954bc(0x183)]['id'],_0x4954bc(0x142));});}}async function confirmRestore(_0x32a26f,_0x37bd99){const _0x232656=_0xc692c;io['to']('botmanager')[_0x232656(0x2f9)](_0x232656(0x1a0),_0x232656(0x283),_0x232656(0x1c0));if(tgBot&&settings[_0x232656(0x2be)]){const _0x31eb71=uuidRandom();tmpStorage[_0x31eb71]={'path':_0x32a26f,'filename':_0x37bd99};const _0x182c57=Markup[_0x232656(0x15f)]([Markup[_0x232656(0x24b)]['callback']('yes',_0x232656(0x17c)+_0x31eb71),Markup[_0x232656(0x24b)]['callback']('no',_0x232656(0x219)+_0x31eb71)]);await sendTelegram(settings[_0x232656(0x2be)],_0x232656(0x22f),_0x182c57),tgBot[_0x232656(0x201)](/restore_(.+)_(.+)/,async _0x331bec=>{const _0x1bc65e=_0x232656,_0xa11a24=_0x331bec['match'][0x1],_0x343b3b=_0x331bec['match'][0x2],{path:_0x5a643d,filename:_0xeceb9e}=tmpStorage[_0x343b3b];delete tmpStorage[_0x343b3b],_0x331bec[_0x1bc65e(0x27a)](),_0xa11a24=='yes'?(logger[_0x1bc65e(0x269)](_0x1bc65e(0x22e)),await sendTelegram(_0x331bec[_0x1bc65e(0x183)]['id'],_0x1bc65e(0x1f9),{'parse_mode':_0x1bc65e(0x1bd)}),unzipFile(_0x5a643d,_0xeceb9e)):(logger['debug'](_0x1bc65e(0x137)),await sendTelegram(_0x331bec[_0x1bc65e(0x183)]['id'],_0x1bc65e(0x137)));});}}function getServerTime(){const _0x37c953=_0xc692c,_0x1b5e39=new Date();return _0x1b5e39[_0x37c953(0x2c1)]()+'/'+(_0x1b5e39[_0x37c953(0x200)]()+0x1)[_0x37c953(0x306)]()[_0x37c953(0x1f5)](0x2,'0')+'/'+_0x1b5e39[_0x37c953(0x26b)]()[_0x37c953(0x306)]()[_0x37c953(0x1f5)](0x2,'0')+'\x20'+_0x1b5e39[_0x37c953(0x26e)]()[_0x37c953(0x306)]()[_0x37c953(0x1f5)](0x2,'0')+':'+_0x1b5e39[_0x37c953(0x2f0)]()[_0x37c953(0x306)]()['padStart'](0x2,'0')+':'+_0x1b5e39['getSeconds']()[_0x37c953(0x306)]()[_0x37c953(0x1f5)](0x2,'0');}function getTimeStamp(){const _0x63ab85=_0xc692c,_0xb561d9=shiftedTime();return _0xb561d9[_0x63ab85(0x2c1)]()+'/'+(_0xb561d9[_0x63ab85(0x200)]()+0x1)[_0x63ab85(0x306)]()[_0x63ab85(0x1f5)](0x2,'0')+'/'+_0xb561d9['getDate']()['toString']()[_0x63ab85(0x1f5)](0x2,'0')+'\x20'+_0xb561d9[_0x63ab85(0x26e)]()[_0x63ab85(0x306)]()[_0x63ab85(0x1f5)](0x2,'0')+':'+_0xb561d9[_0x63ab85(0x2f0)]()[_0x63ab85(0x306)]()['padStart'](0x2,'0')+':'+_0xb561d9[_0x63ab85(0x2cb)]()[_0x63ab85(0x306)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x58b0bb=_0xc692c,_0x95459e=shiftedTime();return _0x95459e[_0x58b0bb(0x2c1)]()+(_0x95459e[_0x58b0bb(0x200)]()+0x1)[_0x58b0bb(0x306)]()['padStart'](0x2,'0')+_0x95459e['getDate']()[_0x58b0bb(0x306)]()[_0x58b0bb(0x1f5)](0x2,'0')+'-'+_0x95459e['getHours']()[_0x58b0bb(0x306)]()[_0x58b0bb(0x1f5)](0x2,'0')+_0x95459e['getMinutes']()['toString']()[_0x58b0bb(0x1f5)](0x2,'0')+_0x95459e[_0x58b0bb(0x2cb)]()[_0x58b0bb(0x306)]()[_0x58b0bb(0x1f5)](0x2,'0');}function shiftedTime(){const _0xb07104=_0xc692c,_0x1d45fe=new Date();let _0x4df309=_0x1d45fe;if(settings['timeshift']&&settings[_0xb07104(0x1b6)]!==0x0)_0x4df309=fns['add'](_0x1d45fe,{'hours':settings['timeshift']});return _0x4df309;}function startScheduler(){const _0x40c89b=_0xc692c,_0x319157=new Date()[_0x40c89b(0x1a4)](),_0x770592=shiftedTime()[_0x40c89b(0x26e)]();_0x770592==0x4&&backupConfigFiles();_0x770592==0x0&&rotateLogFiles();_0x319157%0x6==0x0&&triggerAnalytics();_0x319157%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x542c74){const _0x3813b8=_0xc692c;logger[_0x3813b8(0x269)](_0x3813b8(0x13c)+_0x542c74);const _0x4caf57=getBotsWithMode();_0x4caf57[_0x3813b8(0x20d)]>0x0?confirmRestore(configbackuppath,_0x542c74):unzipFile(configbackuppath,_0x542c74);}async function getBackupFiles(_0x41d502=null){const _0x1726ba=_0xc692c;let _0x1337ed=[],_0x5518a8=fs[_0x1726ba(0x147)](configbackuppath,{'withFileTypes':!![]});_0x5518a8[_0x1726ba(0x226)]((_0x5bb32e,_0x1572e3)=>_0x5bb32e[_0x1726ba(0x1a8)]<_0x1572e3[_0x1726ba(0x1a8)]?0x1:_0x1572e3[_0x1726ba(0x1a8)]<_0x5bb32e[_0x1726ba(0x1a8)]?-0x1:0x0),_0x5518a8[_0x1726ba(0x2e9)](_0x2e7456=>{const _0x1e88ee=_0x1726ba;if(!_0x2e7456[_0x1e88ee(0x217)]()&&_0x2e7456[_0x1e88ee(0x1a8)]['startsWith'](_0x1e88ee(0x1af))&&_0x2e7456[_0x1e88ee(0x1a8)][_0x1e88ee(0x27e)]('.zip')){const _0x5b74aa=formatDate(fs[_0x1e88ee(0x1fb)](configbackuppath+_0x2e7456[_0x1e88ee(0x1a8)])[_0x1e88ee(0x27d)]);_0x1337ed[_0x1e88ee(0x1e6)]({'name':_0x2e7456['name'],'mtime':_0x5b74aa});}});if(_0x41d502)io['to'](_0x41d502)[_0x1726ba(0x2f9)](_0x1726ba(0x272),_0x1337ed);else return _0x1337ed;}async function backupConfigFiles(){const _0x5dc06e=_0xc692c;await zipFiles(_0x5dc06e(0x175));const _0x45121a=getCleanTimeStamp();fs['copyFileSync'](zippath+'backup-full.zip',configbackuppath+(_0x5dc06e(0x1af)+_0x45121a+_0x5dc06e(0x1ce)));let _0x153999=fs[_0x5dc06e(0x147)](configbackuppath,{'withFileTypes':!![]});_0x153999['sort']((_0x47c8f1,_0x206f80)=>_0x47c8f1[_0x5dc06e(0x1a8)]<_0x206f80[_0x5dc06e(0x1a8)]?0x1:_0x206f80[_0x5dc06e(0x1a8)]<_0x47c8f1[_0x5dc06e(0x1a8)]?-0x1:0x0),_0x153999[_0x5dc06e(0x20d)]>maxBackups&&fs[_0x5dc06e(0x312)](configbackuppath+_0x153999[_0x153999[_0x5dc06e(0x20d)]-0x1][_0x5dc06e(0x1a8)]);}function rotateLogFiles(){const _0x36d122=_0xc692c,_0x29843b=fs[_0x36d122(0x1fb)](logspath+_0x36d122(0x2ca)),_0x413e65=_0x29843b[_0x36d122(0x24c)]/0x400;if(_0x413e65>0x64){let _0x142f07=fs[_0x36d122(0x147)](logspath,{'withFileTypes':!![]});_0x142f07[_0x36d122(0x226)]((_0x2b43e8,_0x5f02e1)=>_0x2b43e8[_0x36d122(0x1a8)]<_0x5f02e1['name']?0x1:_0x5f02e1[_0x36d122(0x1a8)]<_0x2b43e8[_0x36d122(0x1a8)]?-0x1:0x0),_0x142f07[_0x36d122(0x2e9)](_0x560cc1=>{const _0x3df0cc=_0x36d122;if(_0x560cc1[_0x3df0cc(0x1a8)]==_0x3df0cc(0x148))fs[_0x3df0cc(0x2bb)](logspath+_0x560cc1['name'],logspath+_0x3df0cc(0x17f));if(_0x560cc1[_0x3df0cc(0x1a8)]==_0x3df0cc(0x254))fs[_0x3df0cc(0x2bb)](logspath+_0x560cc1['name'],logspath+_0x3df0cc(0x148));_0x560cc1[_0x3df0cc(0x1a8)]=='output-000.log'&&(fs[_0x3df0cc(0x2bb)](logspath+_0x560cc1[_0x3df0cc(0x1a8)],logspath+_0x3df0cc(0x254)),fs[_0x3df0cc(0x218)](logspath+_0x560cc1[_0x3df0cc(0x1a8)],''));});}}async function zipFiles(_0x5dcac5){const _0x4e94df=_0xc692c;let _0x56fd9f;if(_0x5dcac5==_0x4e94df(0x2d2))_0x56fd9f=logspath;if(_0x5dcac5==_0x4e94df(0x2b1))_0x56fd9f=configpath;if(_0x5dcac5==_0x4e94df(0x175))_0x56fd9f=configpath;let _0x2f9364=fs[_0x4e94df(0x147)](_0x56fd9f,{'withFileTypes':!![]});const _0x2c914b=new require(_0x4e94df(0x188))();_0x2f9364[_0x4e94df(0x2e9)](_0x28e1df=>{const _0x4d93bb=_0x4e94df;if(!_0x28e1df[_0x4d93bb(0x217)]()){let _0x16d8be=fs['readFileSync'](_0x56fd9f+_0x28e1df[_0x4d93bb(0x1a8)]);if(_0x5dcac5==_0x4d93bb(0x2b1)){const _0x41599f=/^bot-[0-9]{3}-config.json$/,_0x4e7d2d=_0x41599f[_0x4d93bb(0x1ca)](_0x28e1df[_0x4d93bb(0x1a8)]);if(_0x4e7d2d){const _0x23922a=JSON['parse'](_0x16d8be);if(_0x23922a[_0x4d93bb(0x2a7)][0x0]){_0x23922a[_0x4d93bb(0x2a7)][0x0][_0x4d93bb(0x331)]=_0x4d93bb(0x1d1),_0x23922a[_0x4d93bb(0x2a7)][0x0][_0x4d93bb(0x2d7)]=_0x4d93bb(0x1d1);if(_0x23922a[_0x4d93bb(0x2a7)][0x0]['apiPassword'])_0x23922a[_0x4d93bb(0x2a7)][0x0][_0x4d93bb(0x12c)]=_0x4d93bb(0x1d1);}_0x16d8be=JSON[_0x4d93bb(0x1a3)](_0x23922a,null,0x2);}if(_0x28e1df[_0x4d93bb(0x1a8)]==_0x4d93bb(0x149)){const _0xee62b6=JSON[_0x4d93bb(0x329)](_0x16d8be);if(_0xee62b6[_0x4d93bb(0x1cc)]['loginRequired'])_0xee62b6[_0x4d93bb(0x1cc)]['loginRequired']=![];if(_0xee62b6[_0x4d93bb(0x1cc)][_0x4d93bb(0x1c7)])_0xee62b6[_0x4d93bb(0x1cc)]['bbPassword']=_0x4d93bb(0x1d1);if(_0xee62b6[_0x4d93bb(0x1cc)][_0x4d93bb(0x165)])_0xee62b6['settings'][_0x4d93bb(0x165)]=_0x4d93bb(0x1d1);if(_0xee62b6[_0x4d93bb(0x1cc)]['telegramChatId'])_0xee62b6[_0x4d93bb(0x1cc)][_0x4d93bb(0x2be)]=null;if(_0xee62b6['settings'][_0x4d93bb(0x27f)])_0xee62b6[_0x4d93bb(0x1cc)][_0x4d93bb(0x27f)]=_0x4d93bb(0x1d1);_0x16d8be=JSON[_0x4d93bb(0x1a3)](_0xee62b6,null,0x2);}if(_0x28e1df[_0x4d93bb(0x1a8)]!='bb-secure.json')_0x2c914b[_0x4d93bb(0x1cf)](_0x28e1df['name'],_0x16d8be);}else _0x2c914b[_0x4d93bb(0x1cf)](_0x28e1df[_0x4d93bb(0x1a8)],_0x16d8be);}});const _0x4894fd=_0x2c914b[_0x4e94df(0x2b9)]({'base64':![],'compression':'DEFLATE'});fs[_0x4e94df(0x218)](zippath+(_0x5dcac5+'.zip'),_0x4894fd,'binary');}async function unzipFile(_0x4c82bc,_0x115870){const _0x320f76=_0xc692c;fs[_0x320f76(0x147)](configpath,{'withFileTypes':!![]})[_0x320f76(0x2e9)](_0x140ba5=>{const _0x5e7f7f=_0x320f76;if(!_0x140ba5[_0x5e7f7f(0x217)]())fs[_0x5e7f7f(0x1dc)](configpath+_0x140ba5[_0x5e7f7f(0x1a8)]);});const _0x301725=fs[_0x320f76(0x1d0)](_0x4c82bc+_0x115870,_0x320f76(0x2cc)),_0x5b337e=new require(_0x320f76(0x188))(_0x301725,{'base64':![],'checkCRC32':!![]});Object[_0x320f76(0x31f)](_0x5b337e[_0x320f76(0x313)])[_0x320f76(0x2e9)](_0x199a6b=>{const _0x40b95d=_0x320f76,_0x1e0b62=_0x5b337e[_0x40b95d(0x313)][_0x199a6b];fs[_0x40b95d(0x218)](configpath+_0x1e0b62[_0x40b95d(0x1a8)],_0x1e0b62[_0x40b95d(0x266)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})['forEach'](_0x2327e3=>{const _0x499b78=_0x320f76;if(!_0x2327e3['isDirectory']())fs['rmSync'](temppath+_0x2327e3[_0x499b78(0x1a8)]);}),logger[_0x320f76(0x269)]('Backup\x20file\x20unzipped\x20and\x20stored'),process['send']({'restore':!![]},_0x4c2a2a=>{});}async function getPublicIp(){const _0x171390=_0xc692c;try{const _0x10e890=await axios['get'](_0x171390(0x189));publicip=_0x10e890['data']['ip'];}catch(_0x48aa21){}}async function triggerAnalytics(){const _0x2f0ed6=_0xc692c;if(!publicip)await getPublicIp();const _0x44f5ec=getBotsWithMode();let _0xb805f5=0x0;_0x44f5ec['forEach'](_0x3c20b3=>{const _0x1fe28d=_0x374a;if(_0x3c20b3[_0x1fe28d(0x177)]==='enabled')_0xb805f5++;});const _0x1fe0ce=getBotExchanges();mixpanel[_0x2f0ed6(0x32b)](_0x2f0ed6(0x30a),{'distinct_id':settings[_0x2f0ed6(0x300)],'ip':publicip,'version':serverversion,'numbots':_0x44f5ec[_0x2f0ed6(0x20d)],'numbotsenabled':_0xb805f5,'exchanges':_0x1fe0ce,'environment':environment});}async function getMessages(){const _0x32694e=_0xc692c,_0x5c5fd2=_0x32694e(0x207),_0x42b9d5=new GraphQLClient(_0x5c5fd2),_0x5ad65e={'authorization':_0x32694e(0x2b2)},_0x2f3634=serverversion[_0x32694e(0x2a0)]('.'),_0x90d87d=_0x2f3634[0x0]+'.'+_0x2f3634[0x1],_0x1fdb90=Math[_0x32694e(0x240)](settings[_0x32694e(0x2a3)],settings['lastmsgemitted']),_0x3c62bc={'last':parseInt(_0x1fdb90),'bbm':_0x90d87d},_0x4e254e=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x273ed5;try{_0x273ed5=await _0x42b9d5[_0x32694e(0x174)](_0x4e254e,_0x3c62bc,_0x5ad65e);}catch(_0x430702){}if(_0x273ed5&&_0x273ed5[_0x32694e(0x2f3)]){let _0x1ce4d5=settings[_0x32694e(0x2a3)];newMessages=[];for(const _0xe4c838 of _0x273ed5[_0x32694e(0x2f3)]){newMessages[_0x32694e(0x1e6)](_0xe4c838);let _0x4594a7=![];_0xe4c838[_0x32694e(0x220)]&&(updateSetting('latestversion',_0xe4c838['bbvNew']),_0x4594a7=isNewerVersion(serverversion,_0xe4c838[_0x32694e(0x220)])||serverversion==_0xe4c838[_0x32694e(0x220)]);if(!_0x4594a7&&_0xe4c838[_0x32694e(0x2a5)]>_0x1ce4d5){if(_0xe4c838[_0x32694e(0x24f)]==='any'||serverversion[_0x32694e(0x2d1)](_0xe4c838['bbvReceive'])){let _0x2f3a53=''+_0xe4c838[_0x32694e(0x1b2)]+'\x0a\x0a'+_0xe4c838['message'];const _0x2b5f3a=await sendTelegramMsg(toTelegramMarkdown(_0x2f3a53),'Markdown');if(_0x2b5f3a)_0x1ce4d5=_0xe4c838[_0x32694e(0x2a5)];}}}updateAvailable=isNewerVersion(settings[_0x32694e(0x1df)],serverversion),updateSetting(_0x32694e(0x2a3),_0x1ce4d5),emitMessages();}}function emitMessages(){const _0x4285f3=_0xc692c,_0x8b1a8=settings[_0x4285f3(0x167)];let _0x108c96=[];newMessages['forEach'](_0x3bdb55=>{const _0x4b9977=_0x4285f3;_0x3bdb55[_0x4b9977(0x2a5)]>_0x8b1a8&&_0x108c96['push'](_0x3bdb55);}),_0x108c96[_0x4285f3(0x20d)]>0x0&&getAllClients()['forEach'](_0x1134a6=>{getSocket(_0x1134a6['id'])['emit']('message',_0x108c96);});}function confirmMessage(_0x206f21){const _0x328bcd=_0xc692c;updateSetting(_0x328bcd(0x167),Number(_0x206f21));}function isNewerVersion(_0x1f2557,_0x58f9ab){const _0x31bc77=_0xc692c,_0x4623eb=_0x58f9ab[_0x31bc77(0x2a0)]('.'),_0x5621fe=_0x1f2557[_0x31bc77(0x2a0)]('.');for(var _0x3ea923=0x0;_0x3ea923<_0x5621fe['length'];_0x3ea923++){const _0x138f86=~~_0x5621fe[_0x3ea923],_0x1592e3=~~_0x4623eb[_0x3ea923];if(_0x138f86>_0x1592e3)return!![];if(_0x138f86<_0x1592e3)return![];}return![];}function toTelegramMarkdown(_0xeadeef){const _0x121095=_0xc692c,_0x310948=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x40c637=/\*{2}(.+?)\*{2}/gim;return _0xeadeef=_0xeadeef['replace'](_0x310948,_0x121095(0x196))[_0x121095(0x197)](_0x40c637,_0x121095(0x159)),_0xeadeef;}async function validateConfigFile(){const _0x27911f=_0xc692c,_0x5784bd=dbConfig[_0x27911f(0x15c)](_0x27911f(0x253))['sortBy'](_0x27911f(0x276))[_0x27911f(0x325)]()||[];if(_0x5784bd[_0x27911f(0x20d)]==0x0){let _0x33945f=0x0,_0x539fe4=[];const _0x43616f=/^bot-([0-9]{3})-config.json$/,_0x5afdbe=fs[_0x27911f(0x147)](configpath);_0x5afdbe[_0x27911f(0x2e9)](_0x5305ef=>{const _0x17c83c=_0x27911f,_0x53d5f4=_0x43616f['exec'](_0x5305ef);if(_0x53d5f4){const _0x355567=_0x53d5f4[0x1];let _0x2bebe0=getBotAttributes(_0x355567);_0x539fe4[_0x17c83c(0x1e6)]({'botID':_0x355567,'botname':_0x2bebe0[_0x17c83c(0x14a)],'status':'disabled','live':_0x17c83c(0x2c4)}),_0x33945f++;}}),_0x33945f!=0x0&&(dbConfig['get'](_0x27911f(0x253))[_0x27911f(0x19b)](_0x539fe4)[_0x27911f(0x2ef)](),config=_0x539fe4,restoredConfigFile=_0x33945f);}}async function restoreConfigNotify(_0x1ead9f){const _0x1ad2fd=_0xc692c;let _0x19b7c2;if(restoredConfigFile==0x1)_0x19b7c2=_0x1ad2fd(0x235);else _0x19b7c2=_0x1ad2fd(0x2d9);if(_0x1ead9f)io['to']('botmanager')[_0x1ad2fd(0x2f9)](_0x1ad2fd(0x1a0),_0x19b7c2);else{logger[_0x1ad2fd(0x1d5)](_0x1ad2fd(0x2a6)),logger[_0x1ad2fd(0x1d5)](_0x19b7c2),logger[_0x1ad2fd(0x1d5)]('-----------------------------------------------------------------------------------'),logger[_0x1ad2fd(0x1d5)]('');if(tgBot&&settings[_0x1ad2fd(0x2be)]&&settings[_0x1ad2fd(0x28f)]!=_0x1ad2fd(0x1ec))await sendTelegram(settings[_0x1ad2fd(0x2be)],'Bot\x20Mgr\x20>\x20'+_0x19b7c2);}}function validateCredentials(_0x526097,_0x2d98ef){const _0xb8f429=_0xc692c;if(_0x526097['username']==settings[_0xb8f429(0x1b4)]&&bcrypt[_0xb8f429(0x332)](_0x526097[_0xb8f429(0x223)],settings[_0xb8f429(0x1c7)])){if(settings[_0xb8f429(0x2bc)])return{'allow':![],'reason':_0xb8f429(0x14d),'token':null};else{const _0x3ede8a=generateLoginToken(_0x2d98ef);return{'allow':!![],'reason':_0xb8f429(0x1e4),'token':_0x3ede8a};}}else return{'allow':![],'reason':_0xb8f429(0x244),'token':null};}function refreshToken(_0x39f3cd){const _0xa94760=_0xc692c,_0x5bfbe8=generateLoginToken(_0x39f3cd);return{'allow':!![],'reason':_0xa94760(0x1e4),'token':_0x5bfbe8};}function validateAccess(_0x15d91f,_0x1550bd,_0x4406c6){const _0x15b3e4=_0xc692c,_0x3c281c=_0x4406c6?_0x4406c6:devices[_0x1550bd]['ip'];let _0x29cbe7;const _0x1be598=_0x21a0d3=>{const _0x346344=_0x374a;if(settings['loginRequired']){if(settings[_0x346344(0x2bc)]){if(telegram2FaApproved(_0x1550bd)){const _0x2d1726=generateLoginToken(_0x1550bd);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x2d1726};}else return{'allow':![],'reason':_0x346344(0x26d),'token':null};}else return _0x29cbe7=validToken(_0x21a0d3,_0x1550bd),_0x29cbe7[_0x346344(0x317)]('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x21a0d3}:{'allow':![],'reason':_0x346344(0x26d),'token':null};}else return{'allow':!![],'reason':_0x346344(0x241),'token':null};};if(settings[_0x15b3e4(0x12a)]){let _0x344b5f=[...settings[_0x15b3e4(0x27c)],_0x15b3e4(0x2d5),_0x15b3e4(0x1c6),_0x15b3e4(0x216)];if(_0x344b5f[_0x15b3e4(0x318)](_0x3c281c))return _0x1be598(_0x15d91f);else{_0x29cbe7=validToken(_0x15d91f,_0x1550bd);if(_0x29cbe7[_0x15b3e4(0x317)](_0x15b3e4(0x1c0)))return _0x1be598(_0x15d91f);else{if(telegramIpApproved(_0x1550bd)){const _0x49a44a=generateToken(_0x1550bd);return _0x29cbe7=_0x1be598(_0x15d91f),_0x29cbe7[_0x15b3e4(0x237)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x49a44a}:_0x29cbe7;}else return settings[_0x15b3e4(0x256)]?{'allow':![],'reason':_0x15b3e4(0x2c8),'token':null}:{'allow':![],'reason':_0x15b3e4(0x158),'token':null};}}}else return _0x1be598(_0x15d91f);}function timelyDecrypt(_0x185efa,_0x2f19a5,_0x45484b='@'){const _0x5d3d77=_0xc692c;if(_0x185efa)try{const _0x471ee2=crypt[_0x5d3d77(0x2ab)](secure[_0x5d3d77(0x31d)],_0x185efa)[_0x5d3d77(0x173)],_0x3c17f2=_0x471ee2[_0x5d3d77(0x2a0)](_0x45484b)[0x0],_0x4ba1bc=_0x471ee2[_0x5d3d77(0x2a0)](_0x45484b)[0x1],_0x4e8f72=new Date()[_0x5d3d77(0x2f5)]();if(_0x2f19a5){if(_0x4e8f72-_0x4ba1bc<maxSecretAge*0x3e8)return _0x3c17f2;else return![];}else return _0x3c17f2;}catch(_0x24cb93){return![];}else return![];}const validToken=(_0x140dfb,_0x5d4018)=>{const _0x59207f=_0xc692c,_0x14118a=devices[_0x5d4018]['ip'];if(!_0x140dfb)return{'error':_0x59207f(0x268)};for(let _0x1062f2 of blacklist){if(_0x1062f2[_0x59207f(0x2ad)]==_0x140dfb)return{'error':_0x59207f(0x21b)};}let _0x228742;try{_0x228742=jwt[_0x59207f(0x1b7)](_0x140dfb,secure['secret']+_0x5d4018);}catch{return{'error':_0x59207f(0x154)};}if(!_0x228742[_0x59207f(0x317)](_0x59207f(0x2b5))&&!_0x228742[_0x59207f(0x317)](_0x59207f(0x1e5))||!_0x228742[_0x59207f(0x317)]('exp'))return{'error':_0x59207f(0x30c)};if(!_0x228742[_0x59207f(0x317)]('username')&&_0x228742[_0x59207f(0x317)]('clientip')){const {clientip:_0x683940}=_0x228742;return _0x14118a==_0x683940?{'success':_0x59207f(0x278)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x228742['hasOwnProperty']('username')&&_0x228742['hasOwnProperty'](_0x59207f(0x2b5))){const {username:_0x315db3,clientip:_0x43c465}=_0x228742;return settings['bbUsername']==_0x315db3&&_0x14118a==_0x43c465?{'success':_0x59207f(0x278)}:{'error':_0x59207f(0x2fc)};}}},generateLoginToken=_0x180895=>{const _0x5e0d3c=_0xc692c;if(_0x180895){const _0x20f139=devices[_0x180895]['ip'];return jwt[_0x5e0d3c(0x1fd)]({'username':settings[_0x5e0d3c(0x1b4)],'clientip':_0x20f139},secure['secret']+_0x180895,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x31257e=>{const _0x1a9870=_0xc692c;if(_0x31257e){const _0x19f846=devices[_0x31257e]['ip'];return jwt['sign']({'clientip':_0x19f846},secure[_0x1a9870(0x1c4)]+_0x31257e,{'expiresIn':devices[_0x31257e][_0x1a9870(0x32a)][_0x1a9870(0x1cd)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x37b794=>{const _0x399f23=_0xc692c;let _0x55e1d3=![];return devices[_0x37b794][_0x399f23(0x32a)]&&devices[_0x37b794]['telegramIpApproval'][_0x399f23(0x1cd)]!='reject'&&(_0x55e1d3=devices[_0x37b794][_0x399f23(0x32a)][_0x399f23(0x2b5)]==devices[_0x37b794]['ip']&&new Date()['getTime']()-devices[_0x37b794][_0x399f23(0x32a)][_0x399f23(0x144)]<devices[_0x37b794][_0x399f23(0x32a)]['expiry']*0x3c*0x3e8),_0x55e1d3;},telegram2FaApproved=_0x1a51fa=>{const _0xfedacd=_0xc692c;let _0x568e9a=![];return devices[_0x1a51fa][_0xfedacd(0x31c)]&&devices[_0x1a51fa][_0xfedacd(0x31c)][_0xfedacd(0x1cd)]!=_0xfedacd(0x289)&&(_0x568e9a=devices[_0x1a51fa][_0xfedacd(0x31c)][_0xfedacd(0x2b5)]==devices[_0x1a51fa]['ip']&&new Date()[_0xfedacd(0x2f5)]()-devices[_0x1a51fa][_0xfedacd(0x31c)][_0xfedacd(0x144)]<devices[_0x1a51fa]['telegram2FaApproval'][_0xfedacd(0x1cd)]*0x3c*0x3e8),_0x568e9a;},normalizeIP=_0xd2a30a=>{const _0xe836eb=_0xc692c;let _0x420d09=null,_0x5f044f=null;if(ipaddr[_0xe836eb(0x138)](_0xd2a30a)){const _0x5eb938=ipaddr[_0xe836eb(0x329)](_0xd2a30a);_0x5eb938[_0xe836eb(0x146)]()===_0xe836eb(0x286)?(_0x5eb938[_0xe836eb(0x20b)]()&&(_0x420d09=_0x5eb938['toIPv4Address']()[_0xe836eb(0x306)]()),_0x5f044f=_0x5eb938[_0xe836eb(0x306)]()):(_0x420d09=_0x5eb938[_0xe836eb(0x306)](),_0x5f044f=_0x5eb938[_0xe836eb(0x211)]()['toString']());}return{'show':_0x420d09?_0x420d09:_0x5f044f,'store':_0x5f044f};};function formatDate(_0x18b3fc){const _0x5cb5d1=_0xc692c;return _0x18b3fc[_0x5cb5d1(0x2c1)]()+'/'+(_0x18b3fc[_0x5cb5d1(0x200)]()+0x1)[_0x5cb5d1(0x306)]()[_0x5cb5d1(0x1f5)](0x2,'0')+'/'+_0x18b3fc[_0x5cb5d1(0x26b)]()[_0x5cb5d1(0x306)]()[_0x5cb5d1(0x1f5)](0x2,'0')+'\x20'+_0x18b3fc[_0x5cb5d1(0x26e)]()[_0x5cb5d1(0x306)]()['padStart'](0x2,'0')+':'+_0x18b3fc[_0x5cb5d1(0x2f0)]()[_0x5cb5d1(0x306)]()[_0x5cb5d1(0x1f5)](0x2,'0')+':'+_0x18b3fc[_0x5cb5d1(0x2cb)]()['toString']()[_0x5cb5d1(0x1f5)](0x2,'0');}function sleep(_0x768295){return new Promise(_0x8cb58a=>setTimeout(_0x8cb58a,_0x768295));}