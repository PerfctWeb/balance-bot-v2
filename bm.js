const _0x1a8ea8=_0x4eba;(function(_0xce5f80,_0x3d8ea0){const _0x2795c4=_0x4eba,_0x3e7c9e=_0xce5f80();while(!![]){try{const _0x12dfa2=-parseInt(_0x2795c4(0x311))/0x1+parseInt(_0x2795c4(0x1d3))/0x2+-parseInt(_0x2795c4(0x266))/0x3+parseInt(_0x2795c4(0x2fd))/0x4*(parseInt(_0x2795c4(0x1e5))/0x5)+parseInt(_0x2795c4(0x34c))/0x6*(parseInt(_0x2795c4(0x24d))/0x7)+parseInt(_0x2795c4(0x219))/0x8*(-parseInt(_0x2795c4(0x32a))/0x9)+parseInt(_0x2795c4(0x2ae))/0xa;if(_0x12dfa2===_0x3d8ea0)break;else _0x3e7c9e['push'](_0x3e7c9e['shift']());}catch(_0x245bef){_0x3e7c9e['push'](_0x3e7c9e['shift']());}}}(_0x47e7,0x79794));const _0x5b233d=function(){let _0x2f11f3=!![];return function(_0x4ff0bf,_0x9b4df3){const _0xf7c5a0=_0x2f11f3?function(){const _0x3ff851=_0x4eba;if(_0x9b4df3){const _0x3a2943=_0x9b4df3[_0x3ff851(0x202)](_0x4ff0bf,arguments);return _0x9b4df3=null,_0x3a2943;}}:function(){};return _0x2f11f3=![],_0xf7c5a0;};}(),_0x25e044=_0x5b233d(this,function(){const _0x4822b3=_0x4eba;return _0x25e044[_0x4822b3(0x2a5)]()[_0x4822b3(0x1ce)]('(((.+)+)+)+$')['toString']()[_0x4822b3(0x2a8)](_0x25e044)[_0x4822b3(0x1ce)](_0x4822b3(0x329));});_0x25e044();'use strict';process[_0x1a8ea8(0x2e1)][_0x1a8ea8(0x314)]=0x1;const childProcess=require(_0x1a8ea8(0x328)),fs=require('fs'),fns=require(_0x1a8ea8(0x2f2)),low=require('lowdb'),FileSync=require(_0x1a8ea8(0x23d)),path=require('path'),crypto=require('crypto'),Crypt=require(_0x1a8ea8(0x2db))[_0x1a8ea8(0x2bc)],RSA=require(_0x1a8ea8(0x2db))[_0x1a8ea8(0x2d7)],bcrypt=require('bcryptjs'),jwt=require(_0x1a8ea8(0x2ab)),ipaddr=require(_0x1a8ea8(0x247)),argv=require(_0x1a8ea8(0x221))(process['argv']['slice'](0x2))['argv'],uuidRandom=require(_0x1a8ea8(0x263)),TelegramBot=require(_0x1a8ea8(0x2df)),Mixpanel=require(_0x1a8ea8(0x1d2)),axios=require('axios'),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x1a8ea8(0x2d2)),fileUpload=require(_0x1a8ea8(0x2e0)),PORT=argv[_0x1a8ea8(0x2da)]||_0x1a8ea8(0x22e),pattern=/^[0-9]{2,4}$/;!pattern[_0x1a8ea8(0x1eb)](PORT)&&(console[_0x1a8ea8(0x326)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x1a8ea8(0x34b)),process['exit'](0x1));const HOST=argv[_0x1a8ea8(0x2c5)]||null,userID=argv[_0x1a8ea8(0x32c)]||'';let bbpath=_0x1a8ea8(0x22c),bbpath2='';const botfile=_0x1a8ea8(0x206),configfile='bb-config.json',settingsfile='bb-settings.json',securefile=_0x1a8ea8(0x345);let validInstallation=!![];!fs[_0x1a8ea8(0x217)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x1a8ea8(0x2f1)+userID+'/':bbpath+_0x1a8ea8(0x2f1),configbackuppath=configpath+_0x1a8ea8(0x218),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x1a8ea8(0x230)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x1a8ea8(0x2c2)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x1a8ea8(0x33a)+userID+'/':bbpath+_0x1a8ea8(0x33a);!fs[_0x1a8ea8(0x217)](configpath)&&fs[_0x1a8ea8(0x25b)](configpath);!fs[_0x1a8ea8(0x217)](configbackuppath)&&fs[_0x1a8ea8(0x25b)](configbackuppath);!fs[_0x1a8ea8(0x217)](logspath)&&fs[_0x1a8ea8(0x25b)](logspath);!fs[_0x1a8ea8(0x217)](zippath)&&fs[_0x1a8ea8(0x25b)](zippath);!fs['existsSync'](temppath)&&fs[_0x1a8ea8(0x25b)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x1a8ea8(0x2a0)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x1a8ea8(0x2a0)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x1a8ea8(0x277)}})[_0x1a8ea8(0x236)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x1a8ea8(0x2a0)]({'secure':{},'blacklist':[]})[_0x1a8ea8(0x236)]();let crypt=new Crypt({'md':_0x1a8ea8(0x20f),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x1a8ea8(0x1e2),{'host':_0x1a8ea8(0x24e)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x1a8ea8(0x2e3)]!=''&&settings[_0x1a8ea8(0x2f9)]&&settings[_0x1a8ea8(0x2f9)]!='')initTelegram();const logger={'screen':_0x10fd9d=>{const _0x439625=_0x1a8ea8;console[_0x439625(0x326)](_0x10fd9d);},'simple':_0x2755b3=>{const _0x4aebe5=_0x1a8ea8;console[_0x4aebe5(0x326)](_0x2755b3),loggerfile[_0x4aebe5(0x236)](util['format'](_0x2755b3)+'\x0a');},'full':async _0x1dc06a=>{const _0x5e78c8=_0x1a8ea8,_0x484769=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x1dc06a;console['log'](_0x484769),loggerfile[_0x5e78c8(0x236)](util['format'](_0x484769)+'\x0a');if(tgBot&&settings[_0x5e78c8(0x244)]&&settings[_0x5e78c8(0x1d4)]!=_0x5e78c8(0x233))await tgBot[_0x5e78c8(0x2b9)](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x1dc06a)[_0x5e78c8(0x31a)](_0x469d99=>{telegramError(_0x469d99);});}};process['on'](_0x1a8ea8(0x1c3),function(_0x501cfe){const _0x4532cd=_0x1a8ea8;logger[_0x4532cd(0x34d)](_0x501cfe);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x1a8ea8(0x1c6)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x1a8ea8(0x296))[_0x1a8ea8(0x30d)](app);app[_0x1a8ea8(0x1cb)](fileUpload({'useTempFiles':!![]})),app[_0x1a8ea8(0x1f4)](_0x1a8ea8(0x239),async(_0x39725b,_0x56af22)=>{const _0x16b570=_0x1a8ea8,_0x284a1f=_0x39725b['params'][_0x16b570(0x253)],_0x3d93eb=getClientsWithBotID(_0x16b570(0x1f1)),_0x4b0c5a=_0x39725b[_0x16b570(0x211)][_0x16b570(0x1c0)],_0x98c904=timelyDecrypt(_0x4b0c5a,![]),_0x2ad54f=_0x3d93eb[_0x16b570(0x245)](_0x44dfb5=>_0x44dfb5[_0x16b570(0x1c0)]==_0x98c904);if(_0x2ad54f){const _0x48d544=normalizeIP(_0x39725b[_0x16b570(0x23c)][_0x16b570(0x2ea)])[_0x16b570(0x24a)],_0x2582ad=_0x39725b['headers']['tkn'];if(validateAccess(_0x2582ad,_0x98c904,_0x48d544)['allow'])await zipFiles(_0x284a1f),_0x56af22[_0x16b570(0x2c9)](zippath+(_0x284a1f+'.zip'),_0x54753e=>{const _0x561f85=_0x16b570;_0x54753e&&(logger[_0x561f85(0x335)](_0x561f85(0x33e)+_0x284a1f),logger['simple'](_0x54753e));});else logger['full'](_0x16b570(0x2d4)+_0x284a1f+_0x16b570(0x1f9));}else logger[_0x16b570(0x335)](_0x16b570(0x2d4)+_0x284a1f+'\x20(2)');}),app[_0x1a8ea8(0x318)]('/upload-backup',async(_0x302fa2,_0x79b45c)=>{const _0x2cdba8=_0x1a8ea8,_0x1b9654=getClientsWithBotID(_0x2cdba8(0x1f1)),_0x4c4b7d=_0x302fa2[_0x2cdba8(0x211)]['uuid'],_0x1ce889=timelyDecrypt(_0x4c4b7d,![]),_0x3333e8=_0x1b9654[_0x2cdba8(0x245)](_0x84b5ae=>_0x84b5ae[_0x2cdba8(0x1c0)]==_0x1ce889);if(_0x3333e8){const _0x2d4eb7=normalizeIP(_0x302fa2['socket'][_0x2cdba8(0x2ea)])[_0x2cdba8(0x24a)],_0x36853b=_0x302fa2[_0x2cdba8(0x211)][_0x2cdba8(0x21e)];if(validateAccess(_0x36853b,_0x1ce889,_0x2d4eb7)[_0x2cdba8(0x2cc)]){if(_0x302fa2[_0x2cdba8(0x212)]){const _0x40584d=_0x302fa2[_0x2cdba8(0x212)]['backupfile'];await _0x40584d['mv'](temppath+_0x40584d['name']),_0x79b45c[_0x2cdba8(0x1d5)]({'status':!![],'message':_0x2cdba8(0x1d1)});const _0x34c7d3=getBotsWithMode();_0x34c7d3[_0x2cdba8(0x1ba)]>0x0?confirmRestore(temppath,_0x40584d['name']):unzipFile(temppath,_0x40584d[_0x2cdba8(0x1df)]);}}else logger[_0x2cdba8(0x335)](_0x2cdba8(0x2bf));}else logger['full'](_0x2cdba8(0x2fc));}),app['use'](express[_0x1a8ea8(0x2fb)](path[_0x1a8ea8(0x260)](__dirname,bbpath2,_0x1a8ea8(0x2e4)))),app[_0x1a8ea8(0x1cb)](express[_0x1a8ea8(0x2fb)](path['join'](__dirname,bbpath2,_0x1a8ea8(0x1f2)))),app[_0x1a8ea8(0x1f4)]('/',function(_0x2590fb,_0x823db9){const _0x35da24=_0x1a8ea8;_0x823db9['sendFile'](path[_0x35da24(0x260)](__dirname,bbpath2,_0x35da24(0x2e4),'index.html'));}),app[_0x1a8ea8(0x1f4)](_0x1a8ea8(0x2a1),function(_0x553ccf,_0x35d882){const _0x4d13fb=_0x1a8ea8;_0x35d882['sendFile'](path[_0x4d13fb(0x260)](__dirname,bbpath2,'build','index.html'));}),app[_0x1a8ea8(0x1f4)](_0x1a8ea8(0x1ca),(_0x4ed182,_0x264253)=>{const _0x4ecf34=_0x1a8ea8;_0x264253[_0x4ecf34(0x209)](path[_0x4ecf34(0x260)](__dirname,bbpath2,_0x4ecf34(0x1f2),_0x4ecf34(0x2af)));}),app[_0x1a8ea8(0x1f4)]('/:bot/performance',(_0x1ffee0,_0x31b598)=>{const _0x1dddb1=_0x1a8ea8;_0x31b598[_0x1dddb1(0x209)](path[_0x1dddb1(0x260)](__dirname,bbpath2,_0x1dddb1(0x1f2),_0x1dddb1(0x2af)));}),app['get']('/:bot/coins',(_0x5a30c2,_0x74606d)=>{const _0x23a544=_0x1a8ea8;_0x74606d[_0x23a544(0x209)](path[_0x23a544(0x260)](__dirname,bbpath2,_0x23a544(0x1f2),'index.html'));}),app['get'](_0x1a8ea8(0x268),(_0x38134e,_0x473a8f)=>{const _0x55b291=_0x1a8ea8;_0x473a8f[_0x55b291(0x209)](path[_0x55b291(0x260)](__dirname,bbpath2,_0x55b291(0x1f2),'index.html'));}),app[_0x1a8ea8(0x1f4)](_0x1a8ea8(0x2e9),(_0x1e40c0,_0x3b26d9)=>{const _0x5b9750=_0x1a8ea8;_0x3b26d9[_0x5b9750(0x209)](path[_0x5b9750(0x260)](__dirname,bbpath2,_0x5b9750(0x1f2),_0x5b9750(0x2af)));}),app[_0x1a8ea8(0x1f4)](_0x1a8ea8(0x323),(_0x43134a,_0x422158)=>{const _0x4648b7=_0x1a8ea8;_0x422158['sendFile'](path['join'](__dirname,bbpath2,_0x4648b7(0x1f2),_0x4648b7(0x2af)));});if(HOST)http[_0x1a8ea8(0x2dc)](PORT,HOST);else http[_0x1a8ea8(0x2dc)](PORT);const io=require(_0x1a8ea8(0x20d))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x4bbdd9=_0x1a8ea8;logger['simple'](''),logger['simple'](_0x4bbdd9(0x234)),await logger[_0x4bbdd9(0x335)]('Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:'+PORT),logger[_0x4bbdd9(0x34d)](_0x4bbdd9(0x234));if(config[_0x4bbdd9(0x1ba)]!=0x0)for(const _0x392f3d of config){if(_0x392f3d[_0x4bbdd9(0x1e4)]==_0x4bbdd9(0x301)||_0x392f3d[_0x4bbdd9(0x1e4)]=='new')await logger[_0x4bbdd9(0x335)](_0x4bbdd9(0x2eb)+_0x392f3d[_0x4bbdd9(0x1c5)]+'\x20|\x20'+_0x392f3d['botname']),startBot([_0x392f3d['botID'],userID],{'cwd':bbpath},function(_0x179947){const _0x4851c6=_0x4bbdd9;if(_0x179947)logger[_0x4851c6(0x335)](_0x179947);});else(_0x392f3d[_0x4bbdd9(0x1e4)]=='disabled'||_0x392f3d[_0x4bbdd9(0x1e4)]==_0x4bbdd9(0x1dd))&&await logger[_0x4bbdd9(0x335)](_0x4bbdd9(0x27e)+_0x392f3d[_0x4bbdd9(0x1c5)]+_0x4bbdd9(0x1e0)+_0x392f3d[_0x4bbdd9(0x29b)]);}else!newBot&&logger[_0x4bbdd9(0x34d)](_0x4bbdd9(0x21b));if(newBot)addBot();logger[_0x4bbdd9(0x34d)](_0x4bbdd9(0x234)),logger[_0x4bbdd9(0x34d)]('');}function startSocket(){io['on']('connection',_0x4833c6=>{const _0x3ef3bf=_0x4eba;let _0x313d35,_0x3aee8c,_0xe56fdd,_0x444b29,_0x27e9f6;const _0x56725f=_0x4833c6[_0x3ef3bf(0x256)]['headers']['referer'];_0x3aee8c=_0x56725f[_0x3ef3bf(0x1b7)](/bot[0-9]{3}/);if(_0x3aee8c)_0xe56fdd=_0x3aee8c[0x0][_0x3ef3bf(0x1b7)](/[0-9]{3}/);if(_0xe56fdd)_0x313d35=_0xe56fdd[0x0];else _0x313d35=_0x3ef3bf(0x1f1);const _0x3c55ed=_0x4833c6[_0x3ef3bf(0x256)][_0x3ef3bf(0x23a)][_0x3ef3bf(0x324)];if(!_0x3c55ed)_0x4833c6['emit'](_0x3ef3bf(0x1e4),{'publicKey':secure[_0x3ef3bf(0x2c3)]});else{_0x444b29=timelyDecrypt(_0x3c55ed,![]);if(!_0x444b29)_0x4833c6['emit'](_0x3ef3bf(0x1e4),{'publicKey':secure[_0x3ef3bf(0x2c3)]});else{_0x27e9f6=normalizeIP(_0x4833c6[_0x3ef3bf(0x338)][_0x3ef3bf(0x2ea)])[_0x3ef3bf(0x24a)];if(!devices[_0x444b29])devices[_0x444b29]={'uuid':_0x444b29,'access':{'token':null}};devices[_0x444b29]['ip']=_0x27e9f6;const _0x36eae4=addClient(_0x4833c6['id'],_0x444b29,_0x313d35);setAccess(_0x36eae4),emitMessages(),_0x4833c6['on'](_0x3ef3bf(0x2f5),_0x3a88c0=>{const _0x55e882=_0x3ef3bf,_0x4fef5c=timelyDecrypt(_0x3a88c0[_0x55e882(0x1e1)]);if(_0x4fef5c){_0x3a88c0={'username':_0x3a88c0['username'],'password':_0x4fef5c},devices[_0x444b29][_0x55e882(0x2b4)]=validateCredentials(_0x3a88c0,_0x444b29);if(devices[_0x444b29][_0x55e882(0x2b4)][_0x55e882(0x2cc)]==![]&&devices[_0x444b29][_0x55e882(0x2b4)][_0x55e882(0x32b)]==_0x55e882(0x321))_0x4833c6['emit'](_0x55e882(0x1e4),{'access':devices[_0x444b29][_0x55e882(0x2b4)]}),loginAccess2FA(_0x444b29,_0x27e9f6);else{if(devices[_0x444b29]['access'][_0x55e882(0x2cc)]==![]&&devices[_0x444b29][_0x55e882(0x2b4)]['reason']=='invalid\x20credentials')_0x4833c6[_0x55e882(0x2ef)](_0x55e882(0x1e4),{'access':devices[_0x444b29][_0x55e882(0x2b4)]});else devices[_0x444b29]['access'][_0x55e882(0x2cc)]&&devices[_0x444b29][_0x55e882(0x2b4)][_0x55e882(0x32b)]==_0x55e882(0x33f)&&(getClientsWithUuid(_0x444b29)[_0x55e882(0x2a7)](_0x594ce9=>{setAccess(_0x594ce9);}),setTokenRefresh(_0x444b29),setSessionTimeout(_0x55e882(0x2f5),_0x444b29));}}else logger[_0x55e882(0x335)](_0x55e882(0x30f));}),_0x4833c6['on'](_0x3ef3bf(0x251),()=>{resetPassword();}),_0x4833c6['on'](_0x3ef3bf(0x346),_0x3c1dc7=>{removeClient(_0x4833c6['id']);}),_0x313d35==_0x3ef3bf(0x1f1)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x276f02){const _0x13f5be=_0x1a8ea8;if(_0x276f02!='botmanager'&&config[_0x13f5be(0x232)]!=''){if(pid[_0x276f02])pid[_0x276f02][_0x13f5be(0x1d5)]({'function':_0x13f5be(0x1d6),'args':null});}}function reloadBotManager(){const _0x4d259f=_0x1a8ea8;getClientsWithBotID(_0x4d259f(0x1f1))[_0x4d259f(0x2a7)](_0x5de89f=>{const _0x51dfa2=_0x4d259f;getSocket(_0x5de89f['id'])['emit'](_0x51dfa2(0x1e4),{'access':{'allow':![],'reason':_0x51dfa2(0x2a9),'token':null}});});}function getSocket(_0x42b232){const _0x26eca0=_0x1a8ea8;return io[_0x26eca0(0x23f)][_0x26eca0(0x23f)][_0x26eca0(0x1f4)](_0x42b232);}function setAccess(_0x467e27){const _0xbfbad6=_0x1a8ea8,_0x510f9f=getSocket(_0x467e27['id']),_0x10864a=_0x467e27[_0xbfbad6(0x1c0)],_0x2e1f63=_0x467e27[_0xbfbad6(0x1c9)];devices[_0x10864a][_0xbfbad6(0x2b4)]=validateAccess(devices[_0x10864a][_0xbfbad6(0x2b4)][_0xbfbad6(0x24b)],_0x10864a),_0x510f9f[_0xbfbad6(0x260)](_0x10864a);if(devices[_0x10864a]['access'][_0xbfbad6(0x2cc)]){_0x510f9f[_0xbfbad6(0x260)](_0x2e1f63);if(_0x2e1f63==_0xbfbad6(0x1f1))initializeSocketBotManager(_0x510f9f);else initializeSocketBot(_0x510f9f);initClient(_0x2e1f63);}devices[_0x10864a][_0xbfbad6(0x2b4)][_0xbfbad6(0x24b)]&&devices[_0x10864a]['access']['reason']==_0xbfbad6(0x305)&&setSessionTimeout(_0xbfbad6(0x2d0),_0x10864a),devices[_0x10864a][_0xbfbad6(0x2b4)][_0xbfbad6(0x24b)]&&devices[_0x10864a]['access']['reason']==_0xbfbad6(0x21a)&&setSessionTimeout(_0xbfbad6(0x2f5),_0x10864a),_0x510f9f['emit'](_0xbfbad6(0x1e4),{'status':_0x467e27['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x10864a]['access'],'externalip':devices[_0x10864a]['ip'],'publicKey':secure[_0xbfbad6(0x2c3)],'userid':settings[_0xbfbad6(0x27b)],'validInstallation':validInstallation}),devices[_0x10864a][_0xbfbad6(0x2b4)][_0xbfbad6(0x2cc)]==![]&&devices[_0x10864a]['access'][_0xbfbad6(0x32b)]==_0xbfbad6(0x2ee)&&temporaryAccess2FA(_0x10864a,devices[_0x10864a]['ip']);}function setSessionTimeout(_0x2eafed,_0x55e85d){const _0x135654=_0x1a8ea8;let _0x3b11ba;if(_0x2eafed==_0x135654(0x2f5))_0x3b11ba=loginExpiry*0x3c*0x3e8;else _0x3b11ba=devices[_0x55e85d][_0x135654(0x1b8)][_0x135654(0x259)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x55e85d][_0x135654(0x1b8)][_0x135654(0x33b)]);if(devices[_0x55e85d][_0x135654(0x243)])clearTimeout(devices[_0x55e85d][_0x135654(0x243)]);devices[_0x55e85d][_0x135654(0x243)]=setTimeout(()=>{const _0x388207=_0x135654;if(devices[_0x55e85d][_0x388207(0x223)])clearTimeout(devices[_0x55e85d][_0x388207(0x223)]);removeSocketListeners(_0x55e85d),addBlacklist(_0x55e85d),devices[_0x55e85d]['telegramIpApproval']=null,devices[_0x55e85d][_0x388207(0x298)]=null,devices[_0x55e85d][_0x388207(0x2b4)][_0x388207(0x24b)]=null,devices[_0x55e85d]['access']=validateAccess(devices[_0x55e85d][_0x388207(0x2b4)][_0x388207(0x24b)],_0x55e85d),!(devices[_0x55e85d][_0x388207(0x2b4)][_0x388207(0x2cc)]&&devices[_0x55e85d]['access']['reason']==_0x388207(0x2f7))&&(_0x2eafed==_0x388207(0x2f5)?io['to'](_0x55e85d)['emit'](_0x388207(0x1e4),{'access':{'allow':![],'reason':_0x388207(0x241),'token':null}}):io['to'](_0x55e85d)[_0x388207(0x2ef)](_0x388207(0x1e4),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x55e85d]['access'][_0x388207(0x24b)]=null;},_0x3b11ba);}function setTokenRefresh(_0x1a79b4){const _0x31c7a2=_0x1a8ea8;if(devices[_0x1a79b4][_0x31c7a2(0x223)])clearTimeout(devices[_0x1a79b4][_0x31c7a2(0x223)]);devices[_0x1a79b4]['pidRefreshToken']=setTimeout(()=>{const _0x351025=_0x31c7a2;getClientsWithUuid(_0x1a79b4)['length']!=0x0?(devices[_0x1a79b4]['access']=refreshToken(_0x1a79b4),io['to'](_0x1a79b4)[_0x351025(0x2ef)](_0x351025(0x1e4),{'status':_0x351025(0x1bd),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x1a79b4][_0x351025(0x2b4)],'externalip':devices[_0x1a79b4]['ip'],'publicKey':secure[_0x351025(0x2c3)],'validInstallation':validInstallation}),setTokenRefresh(_0x1a79b4)):clearTimeout(devices[_0x1a79b4][_0x351025(0x223)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x364a85){const _0x197381=_0x1a8ea8,_0x5e6834=getClient(_0x364a85['id'])['uuid'];_0x364a85[_0x197381(0x2ef)](_0x197381(0x288),config),_0x364a85[_0x197381(0x2ef)](_0x197381(0x2b3),cleanSettings()),_0x364a85['on'](_0x197381(0x33c),_0x42265d=>{const _0x4048fa=_0x197381;if(validateAccess(_0x42265d,_0x5e6834)[_0x4048fa(0x2cc)])addBot();else logger[_0x4048fa(0x335)](_0x4048fa(0x334));}),_0x364a85['on'](_0x197381(0x270),(_0x4f367b,_0x423b5f)=>{const _0x506213=_0x197381;if(validateAccess(_0x423b5f,_0x5e6834)[_0x506213(0x2cc)])toggleBot(_0x4f367b[_0x506213(0x1c5)],_0x4f367b[_0x506213(0x1e4)],_0x4f367b[_0x506213(0x32e)]);else logger[_0x506213(0x335)](_0x506213(0x255));}),_0x364a85['on'](_0x197381(0x250),(_0x4b0164,_0x240fca)=>{const _0x26e1e5=_0x197381;if(validateAccess(_0x240fca,_0x5e6834)['allow'])toggleBotMode(_0x4b0164);else logger['full'](_0x26e1e5(0x255));}),_0x364a85['on'](_0x197381(0x1da),(_0x3b7568,_0x1ff7b1)=>{const _0x17f5c1=_0x197381;if(validateAccess(_0x1ff7b1,_0x5e6834)[_0x17f5c1(0x2cc)])deleteBot(_0x3b7568);else logger['full'](_0x17f5c1(0x2ca));}),_0x364a85['on']('store-settings',(_0x2a0b86,_0x21109d)=>{const _0x352086=_0x197381;if(validateAccess(_0x21109d,_0x5e6834)[_0x352086(0x2cc)])storeSettings(_0x2a0b86,!![]);else logger['full'](_0x352086(0x285));}),_0x364a85['on'](_0x197381(0x210),_0xcdf7a0=>{const _0x1d50d2=_0x197381;if(validateAccess(_0xcdf7a0,_0x5e6834)[_0x1d50d2(0x2cc)])updateBB();else logger[_0x1d50d2(0x335)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x364a85['on'](_0x197381(0x235),_0x45e934=>{const _0x19d7ee=_0x197381;if(validateAccess(_0x45e934,_0x5e6834)[_0x19d7ee(0x2cc)])getMessages();else logger[_0x19d7ee(0x335)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x364a85['on'](_0x197381(0x2ce),(_0x4e44a5,_0x470698)=>{const _0x5031de=_0x197381;if(validateAccess(_0x470698,_0x5e6834)[_0x5031de(0x2cc)])confirmMessage(_0x4e44a5);else logger[_0x5031de(0x335)](_0x5031de(0x1ef));}),_0x364a85['on'](_0x197381(0x29e),_0x34f8e1=>{const _0x400ca9=_0x197381;if(validateAccess(_0x34f8e1,_0x5e6834)[_0x400ca9(0x2cc)]){if(devices[_0x5e6834]['pidRefreshToken'])clearTimeout(devices[_0x5e6834][_0x400ca9(0x223)]);if(devices[_0x5e6834]['pidExpireLogin'])clearTimeout(devices[_0x5e6834][_0x400ca9(0x243)]);removeSocketListeners(getClient(_0x364a85['id'])[_0x400ca9(0x1c0)]),addBlacklist(_0x5e6834),devices[_0x5e6834][_0x400ca9(0x1b8)]=null,devices[_0x5e6834][_0x400ca9(0x298)]=null,devices[_0x5e6834]['access'][_0x400ca9(0x24b)]=null,io['to'](getClient(_0x364a85['id'])[_0x400ca9(0x1c0)])[_0x400ca9(0x2ef)](_0x400ca9(0x1e4),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x400ca9(0x335)](_0x400ca9(0x304));});}function initializeSocketBot(_0x3fd426){const _0x1860c6=_0x1a8ea8,_0x1bb8fe=getClient(_0x3fd426['id'])['bot'],_0x4a26fd=getClient(_0x3fd426['id'])['uuid'];_0x3fd426['on'](_0x1860c6(0x2f3),(_0x127113,_0x58b0ed)=>{const _0x2ea6ea=_0x1860c6;if(validateAccess(_0x58b0ed,_0x4a26fd)['allow']){if(pid[_0x1bb8fe])pid[_0x1bb8fe][_0x2ea6ea(0x1d5)]({'function':_0x2ea6ea(0x22b),'args':_0x127113});}else logger[_0x2ea6ea(0x335)]('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0x3fd426['on']('delete-alerts',(_0x2263ce,_0x3770d1)=>{const _0x1dbf40=_0x1860c6;if(validateAccess(_0x3770d1,_0x4a26fd)[_0x1dbf40(0x2cc)]){if(pid[_0x1bb8fe])pid[_0x1bb8fe][_0x1dbf40(0x1d5)]({'function':'deleteHistoryAlerts','args':_0x2263ce});}else logger[_0x1dbf40(0x335)](_0x1dbf40(0x292));}),_0x3fd426['on'](_0x1860c6(0x316),(_0x7cc171,_0x2b1c9e)=>{const _0x315084=_0x1860c6;if(validateAccess(_0x2b1c9e,_0x4a26fd)[_0x315084(0x2cc)]){if(pid[_0x1bb8fe])pid[_0x1bb8fe][_0x315084(0x1d5)]({'function':_0x315084(0x274),'args':_0x7cc171});}else logger[_0x315084(0x335)](_0x315084(0x312));}),_0x3fd426['on'](_0x1860c6(0x34a),(_0x26dccf,_0x1269e3)=>{const _0x3de95e=_0x1860c6;if(validateAccess(_0x1269e3,_0x4a26fd)[_0x3de95e(0x2cc)]){if(pid[_0x1bb8fe])pid[_0x1bb8fe][_0x3de95e(0x1d5)]({'function':_0x3de95e(0x1b4),'args':_0x26dccf});}else logger[_0x3de95e(0x335)](_0x3de95e(0x225));}),_0x3fd426['on']('store-headless',(_0x21f7d5,_0x393ae2)=>{const _0x58e4a3=_0x1860c6;if(validateAccess(_0x393ae2,_0x4a26fd)[_0x58e4a3(0x2cc)]){if(pid[_0x1bb8fe])pid[_0x1bb8fe][_0x58e4a3(0x1d5)]({'function':_0x58e4a3(0x272),'args':_0x21f7d5});}else logger[_0x58e4a3(0x335)](_0x58e4a3(0x29a));}),_0x3fd426['on'](_0x1860c6(0x349),_0x147b3b=>{const _0x51c0ec=_0x1860c6;if(validateAccess(_0x147b3b,_0x4a26fd)[_0x51c0ec(0x2cc)]){if(pid[_0x1bb8fe])pid[_0x1bb8fe]['send']({'function':_0x51c0ec(0x295),'args':null});}else logger[_0x51c0ec(0x335)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x3fd426['on'](_0x1860c6(0x262),(_0x42aa88,_0x58bd40)=>{const _0x20c133=_0x1860c6;if(validateAccess(_0x58bd40,_0x4a26fd)[_0x20c133(0x2cc)]){if(pid[_0x1bb8fe])pid[_0x1bb8fe][_0x20c133(0x1d5)]({'function':_0x20c133(0x2aa),'args':_0x42aa88});}else logger['full']('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x3fd426['on'](_0x1860c6(0x1f0),_0x8d7d57=>{const _0x31d6c4=_0x1860c6;if(validateAccess(_0x8d7d57,_0x4a26fd)['allow']){if(pid[_0x1bb8fe])pid[_0x1bb8fe][_0x31d6c4(0x1d5)]({'function':'cancelLoading','args':null});}else logger['full'](_0x31d6c4(0x2cb));}),_0x3fd426['on']('show-config',_0x16b248=>{const _0x3a6853=_0x1860c6;if(validateAccess(_0x16b248,_0x4a26fd)[_0x3a6853(0x2cc)]){if(pid[_0x1bb8fe])pid[_0x1bb8fe][_0x3a6853(0x1d5)]({'function':_0x3a6853(0x242),'args':null});}else logger[_0x3a6853(0x335)](_0x3a6853(0x31d));}),_0x3fd426['on'](_0x1860c6(0x210),_0x3d8977=>{const _0x1bff6b=_0x1860c6;if(validateAccess(_0x3d8977,_0x4a26fd)[_0x1bff6b(0x2cc)])updateBB();else logger[_0x1bff6b(0x335)](_0x1bff6b(0x215));}),_0x3fd426['on'](_0x1860c6(0x235),_0xd44660=>{const _0x1abc53=_0x1860c6;if(validateAccess(_0xd44660,_0x4a26fd)['allow'])getMessages();else logger[_0x1abc53(0x335)](_0x1abc53(0x1ea));}),_0x3fd426['on'](_0x1860c6(0x2ce),(_0x1c4b95,_0x1e5284)=>{const _0x1e168d=_0x1860c6;if(validateAccess(_0x1e5284,_0x4a26fd)['allow'])confirmMessage(_0x1c4b95);else logger[_0x1e168d(0x335)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x3fd426['on'](_0x1860c6(0x29e),_0x23a7ea=>{const _0x5a1080=_0x1860c6;if(validateAccess(_0x23a7ea,_0x4a26fd)['allow']){if(devices[_0x4a26fd][_0x5a1080(0x223)])clearTimeout(devices[_0x4a26fd][_0x5a1080(0x223)]);if(devices[_0x4a26fd][_0x5a1080(0x243)])clearTimeout(devices[_0x4a26fd][_0x5a1080(0x243)]);removeSocketListeners(getClient(_0x3fd426['id'])[_0x5a1080(0x1c0)]),addBlacklist(_0x4a26fd),devices[_0x4a26fd][_0x5a1080(0x1b8)]=null,devices[_0x4a26fd]['telegram2FaApproval']=null,devices[_0x4a26fd][_0x5a1080(0x2b4)]['token']=null,io['to'](getClient(_0x3fd426['id'])[_0x5a1080(0x1c0)])[_0x5a1080(0x2ef)](_0x5a1080(0x1e4),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x5a1080(0x335)](_0x5a1080(0x304));});}function removeSocketListeners(_0x5d74e3){const _0x3e4fef=_0x1a8ea8;getClientsWithUuid(_0x5d74e3)[_0x3e4fef(0x2a7)](_0x57a1b0=>{const _0x5f2b04=_0x3e4fef;getSocket(_0x57a1b0['id'])[_0x5f2b04(0x2c4)]();});}function cleanSettings(){const _0x1b7fe4=_0x1a8ea8;let _0x36550b=settings;return settings['telegramToken']&&settings[_0x1b7fe4(0x2e3)]!=''&&(_0x36550b={..._0x36550b,'telegramToken':_0x1b7fe4(0x32d)}),settings[_0x1b7fe4(0x281)]&&settings[_0x1b7fe4(0x281)]!=''&&(_0x36550b={..._0x36550b,'bbPassword':_0x1b7fe4(0x32d)}),(settings[_0x1b7fe4(0x281)]&&settings['bbPassword']==_0x1b7fe4(0x21f)||settings[_0x1b7fe4(0x2e3)]&&settings[_0x1b7fe4(0x2e3)]==_0x1b7fe4(0x21f))&&(_0x36550b={..._0x36550b,'restored':{'password':settings['bbPassword']==_0x1b7fe4(0x21f),'telegram':settings[_0x1b7fe4(0x2e3)]==_0x1b7fe4(0x21f)}}),_0x36550b;}function updateBB(){const _0x4a9d0c=_0x1a8ea8;installingUpdate=!![],config[_0x4a9d0c(0x2a7)](_0x25c704=>{const _0x531d7a=_0x4a9d0c;restartBot(_0x25c704[_0x531d7a(0x1c5)]);}),process[_0x4a9d0c(0x1d5)]({'update':!![]},_0xcb111e=>{});}function startBot(_0x8d7027,_0x4caa27,_0x1c789f){const _0x1d9885=_0x1a8ea8;let _0x358242=![];const _0x357f08=_0x8d7027[0x0];_0x4caa27={..._0x4caa27,'stdio':[_0x1d9885(0x2d5),_0x1d9885(0x2d5),_0x1d9885(0x2d5),'ipc']},pid[_0x357f08]=childProcess['fork'](botfile,_0x8d7027,_0x4caa27),pid[_0x357f08]['on'](_0x1d9885(0x322),_0x3bd679=>{const _0xc685fa=_0x1d9885;switch(Object[_0xc685fa(0x283)](_0x3bd679)[0x0]){case _0xc685fa(0x29b):updateBotName(_0x357f08,_0x3bd679['botname']);break;case'updatebotmanager':updateBotManager();break;case _0xc685fa(0x1e4):updateStatus(_0x357f08,_0x3bd679[_0xc685fa(0x1e4)]);break;case _0xc685fa(0x32e):updateLive(_0x357f08,_0x3bd679[_0xc685fa(0x32e)]);break;case _0xc685fa(0x26b):updateLive(_0x357f08,_0x3bd679[_0xc685fa(0x26b)]),io['to'](_0x357f08)[_0xc685fa(0x2ef)]('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case _0xc685fa(0x337):_0x3bd679[_0xc685fa(0x337)]==_0xc685fa(0x2ec)&&restartBot(_0x357f08);_0x3bd679['stop']==_0xc685fa(0x1cd)&&toggleBot(_0x357f08,'disabled',_0xc685fa(0x340));break;case _0xc685fa(0x25d):sendTelegram(_0x357f08,_0x3bd679[_0xc685fa(0x25d)]);break;case _0xc685fa(0x325):sendTelegramMsg(_0x3bd679[_0xc685fa(0x325)]);break;case _0xc685fa(0x22a):io['to'](_0x357f08)['emit'](_0x3bd679[_0xc685fa(0x22a)],_0x3bd679[_0xc685fa(0x307)]);break;}}),pid[_0x357f08]['on'](_0x1d9885(0x284),function(_0x159b67){if(_0x358242)return;_0x358242=!![],_0x1c789f(_0x159b67);}),pid[_0x357f08]['on'](_0x1d9885(0x33d),async function(_0x35b436){const _0x8c063d=_0x1d9885;if(installingUpdate)return;if(_0x358242)return;_0x358242=!![],_0x1c789f(null);const _0x5d5792=dbConfig[_0x8c063d(0x1f4)](_0x8c063d(0x288))['find']({'botID':_0x357f08})[_0x8c063d(0x1fa)]();_0x5d5792&&(_0x5d5792[_0x8c063d(0x1e4)]=='enabled'||_0x5d5792[_0x8c063d(0x1e4)]==_0x8c063d(0x1fe))&&(await sleep(0x3e8),updateLive(_0x357f08,_0x8c063d(0x340)),logger[_0x8c063d(0x335)](_0x8c063d(0x2b6)+_0x357f08),startBot([_0x357f08,userID],{'cwd':bbpath},function(_0x50b96a){const _0x239531=_0x8c063d;if(_0x50b96a)logger[_0x239531(0x335)](_0x50b96a);}));});}function _0x4eba(_0x2e143d,_0x295c86){const _0x448bea=_0x47e7();return _0x4eba=function(_0x25e044,_0x5b233d){_0x25e044=_0x25e044-0x1b3;let _0x47e779=_0x448bea[_0x25e044];return _0x47e779;},_0x4eba(_0x2e143d,_0x295c86);}function stopBot(_0xea1de){const _0x264aad=_0x1a8ea8;getClientsWithBotID(_0xea1de)[_0x264aad(0x2a7)](_0x26ebeb=>{getSocket(_0x26ebeb['id'])['disconnect'](!![]),removeClient(_0x26ebeb['id']);}),pid[_0xea1de]&&(pid[_0xea1de][_0x264aad(0x1cd)](),pid[_0xea1de]=null);}function restartBot(_0x322699){if(pid[_0x322699])pid[_0x322699]['kill']();}function addBot(){const _0x117c5a=_0x1a8ea8;let _0x575c11;for(let _0x386e75=0x1;_0x386e75<0x3e9;_0x386e75++){_0x575c11=_0x386e75['toString']()['padStart'](0x3,'0');let _0x3eff6c=config[_0x117c5a(0x245)](_0x2e565a=>_0x2e565a[_0x117c5a(0x1c5)]==_0x575c11);if(!_0x3eff6c)break;}if(_0x575c11==='1000'){logger[_0x117c5a(0x335)]('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x117c5a(0x335)](_0x117c5a(0x23b)+_0x575c11),dbConfig[_0x117c5a(0x1f4)](_0x117c5a(0x288))['push']({'botID':_0x575c11,'botname':'Bot\x20'+_0x575c11,'status':'new','live':''})[_0x117c5a(0x236)](),startBot([_0x575c11,userID],{'cwd':bbpath},function(_0x489731){const _0x59d356=_0x117c5a;if(_0x489731)logger[_0x59d356(0x335)](_0x489731);}),config=getConfiguration(),io['to']('botmanager')[_0x117c5a(0x2ef)]('bots',config);}function deleteBot(_0x2e41e7){const _0x32afb8=_0x1a8ea8;getClientsWithBotID(_0x2e41e7)[_0x32afb8(0x2a7)](_0x314d8d=>{const _0x59454c=_0x32afb8;getSocket(_0x314d8d['id'])[_0x59454c(0x346)](!![]),removeClient(_0x314d8d['id']);}),dbConfig[_0x32afb8(0x1f4)](_0x32afb8(0x288))[_0x32afb8(0x310)]({'botID':_0x2e41e7})['write'](),logger[_0x32afb8(0x335)]('deleted\x20Bot\x20'+_0x2e41e7),stopBot(_0x2e41e7);try{if(fs['existsSync'](path[_0x32afb8(0x260)](configpath,_0x32afb8(0x1cf)+_0x2e41e7+_0x32afb8(0x2c0))))fs[_0x32afb8(0x26c)](path[_0x32afb8(0x260)](configpath,'bot-'+_0x2e41e7+_0x32afb8(0x2c0)));if(fs[_0x32afb8(0x217)](path[_0x32afb8(0x260)](configpath,_0x32afb8(0x1cf)+_0x2e41e7+_0x32afb8(0x299))))fs['unlinkSync'](path['join'](configpath,'bot-'+_0x2e41e7+_0x32afb8(0x299)));if(fs['existsSync'](path[_0x32afb8(0x260)](configpath,_0x32afb8(0x1cf)+_0x2e41e7+_0x32afb8(0x204))))fs[_0x32afb8(0x26c)](path[_0x32afb8(0x260)](configpath,_0x32afb8(0x1cf)+_0x2e41e7+_0x32afb8(0x204)));if(fs['existsSync'](path[_0x32afb8(0x260)](configpath,_0x32afb8(0x1cf)+_0x2e41e7+_0x32afb8(0x2b0))))fs[_0x32afb8(0x26c)](path[_0x32afb8(0x260)](configpath,'bot-'+_0x2e41e7+'-results.json'));}catch(_0x3817c1){if(_0x3817c1)logger[_0x32afb8(0x335)](_0x32afb8(0x2fe),_0x3817c1);}config=getConfiguration(),io['to'](_0x32afb8(0x1f1))[_0x32afb8(0x2ef)](_0x32afb8(0x288),config);}function toggleBot(_0x23a54d,_0x4cfa9f,_0x1a2ebf){const _0x4dac4c=_0x1a8ea8;dbConfig[_0x4dac4c(0x1f4)](_0x4dac4c(0x288))[_0x4dac4c(0x245)]({'botID':_0x23a54d})[_0x4dac4c(0x20a)]({'status':_0x4cfa9f})['assign']({'live':_0x1a2ebf})[_0x4dac4c(0x236)]();if(_0x4cfa9f==_0x4dac4c(0x301)||_0x4cfa9f==_0x4dac4c(0x1fe))logger[_0x4dac4c(0x335)]('enabled\x20Bot\x20'+_0x23a54d),startBot([_0x23a54d,userID],{'cwd':bbpath},function(_0x2056e4){const _0x26c844=_0x4dac4c;if(_0x2056e4)logger[_0x26c844(0x335)](_0x2056e4);});else(_0x4cfa9f==_0x4dac4c(0x273)||_0x4cfa9f=='new-disabled')&&(logger[_0x4dac4c(0x335)](_0x4dac4c(0x278)+_0x23a54d),stopBot(_0x23a54d));config=getConfiguration(),io['to']('botmanager')['emit'](_0x4dac4c(0x288),config);}function toggleStatus(_0xc60f5e){const _0xd22cef=_0x1a8ea8;let _0x170dda=dbConfig[_0xd22cef(0x1f4)](_0xd22cef(0x288))[_0xd22cef(0x245)]({'botID':_0xc60f5e})[_0xd22cef(0x1fa)](),_0x3cf010;if(_0x170dda[_0xd22cef(0x1e4)]===_0xd22cef(0x301))_0x3cf010=_0xd22cef(0x273);else{if(_0x170dda[_0xd22cef(0x1e4)]===_0xd22cef(0x1fe))_0x3cf010=_0xd22cef(0x1dd);else{if(_0x170dda[_0xd22cef(0x1e4)]===_0xd22cef(0x1dd))_0x3cf010=_0xd22cef(0x1fe);else{if(_0x170dda[_0xd22cef(0x1e4)]==='disabled')_0x3cf010='enabled';}}}return _0x3cf010;}function updateStatus(_0x70a839,_0x254071){const _0x3f2ad0=_0x1a8ea8;dbConfig[_0x3f2ad0(0x1f4)](_0x3f2ad0(0x288))['find']({'botID':_0x70a839})[_0x3f2ad0(0x20a)]({'status':_0x254071})['write'](),config=getConfiguration(),io['to'](_0x3f2ad0(0x1f1))['emit']('bots',config);}function updateLive(_0x4a9dfc,_0x3051b6){const _0x39251e=_0x1a8ea8;dbConfig[_0x39251e(0x1f4)](_0x39251e(0x288))[_0x39251e(0x245)]({'botID':_0x4a9dfc})['assign']({'live':_0x3051b6})['write'](),config=getConfiguration(),io['to'](_0x39251e(0x1f1))[_0x39251e(0x2ef)](_0x39251e(0x288),config);}function updateBotName(_0x1d5119,_0x3d0b47){const _0x2c0955=_0x1a8ea8;dbConfig[_0x2c0955(0x1f4)](_0x2c0955(0x288))['find']({'botID':_0x1d5119})[_0x2c0955(0x20a)]({'botname':_0x3d0b47})['write'](),config=getConfiguration(),io['to'](_0x2c0955(0x1f1))['emit']('bots',config);}function updateBotManager(){const _0x3da0bd=_0x1a8ea8;config=getConfiguration(),io['to'](_0x3da0bd(0x1f1))[_0x3da0bd(0x2ef)](_0x3da0bd(0x288),config);}function toggleBotMode(_0xc1fa3f){const _0x50f93b=_0x1a8ea8;if(pid[_0xc1fa3f])pid[_0xc1fa3f][_0x50f93b(0x1d5)]({'function':'toggleBotMode','args':null});else{const _0xcd3a7b=configpath+_0x50f93b(0x1cf)+_0xc1fa3f+_0x50f93b(0x2c0),_0x2d434a=fs[_0x50f93b(0x1e7)](_0xcd3a7b),_0xc2d8dd=JSON[_0x50f93b(0x25e)](_0x2d434a),_0x4654f8=_0xc2d8dd[_0x50f93b(0x1c9)][0x0][_0x50f93b(0x1f6)];_0xc2d8dd[_0x50f93b(0x1c9)][0x0][_0x50f93b(0x1f6)]=!_0x4654f8;const _0x23038a=JSON['stringify'](_0xc2d8dd,null,0x2);fs['writeFileSync'](_0xcd3a7b,_0x23038a),config=getConfiguration(),io['to'](_0x50f93b(0x1f1))['emit'](_0x50f93b(0x288),config);}}function telegramError(_0x410e61){const _0x5a9cfe=_0x1a8ea8;logger['simple'](getTimeStamp()+_0x5a9cfe(0x28f));}function validateTelegram(_0x2c9edb){const _0x25cf05=_0x1a8ea8;if(_0x2c9edb['from'][_0x25cf05(0x246)]!=settings[_0x25cf05(0x2f9)]&&'@'+_0x2c9edb['from'][_0x25cf05(0x246)]!=settings['telegramUsername'])return tgBot[_0x25cf05(0x2b9)](_0x2c9edb[_0x25cf05(0x2ba)]['id'],_0x25cf05(0x208),{'parse_mode':'HTML'})[_0x25cf05(0x31a)](_0x32f17d=>{telegramError(_0x32f17d);}),![];return!![];}async function initTelegram(){const _0x59ccba=_0x1a8ea8;if(tgBot)tgBot[_0x59ccba(0x1fd)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x59ccba(0x2e3)],{'polling':!![]});let _0x54dee9=_0x59ccba(0x339);_0x54dee9+='\x0a',_0x54dee9+=_0x59ccba(0x286),_0x54dee9+='/disable\x20-\x20disable\x20notifications\x0a',_0x54dee9+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x54dee9+=_0x59ccba(0x1bb),_0x54dee9+=_0x59ccba(0x1de),_0x54dee9+=_0x59ccba(0x330),_0x54dee9+=_0x59ccba(0x2cd),_0x54dee9+='/names\x20-\x20show\x20bot\x20names\x0a',_0x54dee9+=_0x59ccba(0x25f),_0x54dee9+=_0x59ccba(0x313),_0x54dee9+=_0x59ccba(0x231),_0x54dee9+=_0x59ccba(0x1e6);let _0x162c8d=_0x59ccba(0x20b);_0x162c8d+='\x0a',_0x162c8d+=_0x54dee9,tgBot[_0x59ccba(0x34e)](/\/start/,_0x85899=>{const _0xf85522=_0x59ccba;if(!validateTelegram(_0x85899))return;if(settings['telegramChatId']!=_0x85899[_0xf85522(0x2ba)]['id'])updateSetting(_0xf85522(0x244),_0x85899[_0xf85522(0x2ba)]['id']);updateSetting(_0xf85522(0x2f8),!![]),tgBot['sendMessage'](_0x85899[_0xf85522(0x2ba)]['id'],_0x162c8d)[_0xf85522(0x31a)](_0x547f23=>{telegramError(_0x547f23);});}),tgBot['onText'](/\/enable/,_0x1a753c=>{const _0x1c356e=_0x59ccba;if(!validateTelegram(_0x1a753c))return;if(settings[_0x1c356e(0x244)]!=_0x1a753c[_0x1c356e(0x2ba)]['id'])updateSetting(_0x1c356e(0x244),_0x1a753c['chat']['id']);updateSetting(_0x1c356e(0x2f8),!![]),tgBot[_0x1c356e(0x2b9)](_0x1a753c[_0x1c356e(0x2ba)]['id'],_0x1c356e(0x1fb))[_0x1c356e(0x31a)](_0x15baf6=>{telegramError(_0x15baf6);});}),tgBot[_0x59ccba(0x34e)](/\/config/,async _0x11c088=>{const _0x525b86=_0x59ccba;if(!validateTelegram(_0x11c088))return;tgBot[_0x525b86(0x2e5)](_0x525b86(0x294)),tgBot[_0x525b86(0x2b9)](_0x11c088[_0x525b86(0x2ba)]['id'],_0x525b86(0x342),{'reply_markup':{'inline_keyboard':[[{'text':_0x525b86(0x2f6),'callback_data':_0x525b86(0x233)},{'text':_0x525b86(0x300),'callback_data':_0x525b86(0x1e3)},{'text':_0x525b86(0x2c6),'callback_data':_0x525b86(0x1f8)}]]}})[_0x525b86(0x31a)](_0x50b05e=>{telegramError(_0x50b05e);}),tgBot['on'](_0x525b86(0x294),async _0x1263d2=>{const _0x248f22=_0x525b86,_0x5d2443=_0x1263d2[_0x248f22(0x269)],_0x141b12=_0x1263d2[_0x248f22(0x322)];tgBot[_0x248f22(0x28b)](_0x1263d2['id'])[_0x248f22(0x1bc)](async()=>{const _0x534e6e=_0x248f22;_0x5d2443==_0x534e6e(0x233)&&(updateSetting(_0x534e6e(0x1d4),_0x534e6e(0x233)),updateSetting(_0x534e6e(0x2f8),!![]),await tgBot[_0x534e6e(0x2b9)](_0x141b12[_0x534e6e(0x2ba)]['id'],_0x534e6e(0x228))[_0x534e6e(0x31a)](_0x5ae5e7=>{telegramError(_0x5ae5e7);}));_0x5d2443==_0x534e6e(0x1e3)&&(updateSetting(_0x534e6e(0x1d4),'alerts'),updateSetting(_0x534e6e(0x2f8),!![]),await tgBot['sendMessage'](_0x141b12['chat']['id'],_0x534e6e(0x240))['catch'](_0x570731=>{telegramError(_0x570731);}));_0x5d2443==_0x534e6e(0x1f8)&&(updateSetting('telegramEvents','all'),updateSetting('telegramEnabled',!![]),await tgBot[_0x534e6e(0x2b9)](_0x141b12[_0x534e6e(0x2ba)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x534e6e(0x31a)](_0x375459=>{telegramError(_0x375459);}));if(!settings[_0x534e6e(0x244)])tgBot[_0x534e6e(0x2b9)](_0x141b12['chat']['id'],_0x534e6e(0x34f))[_0x534e6e(0x31a)](_0x169eeb=>{telegramError(_0x169eeb);});}),tgBot['removeListener'](_0x248f22(0x294));});}),tgBot['onText'](/\/status/,_0x55bd79=>{const _0x3a0b20=_0x59ccba;if(!validateTelegram(_0x55bd79))return;const _0x48f41b=getBotsWithMode();let _0x4e3781=_0x3a0b20(0x264);config[_0x3a0b20(0x2a7)](_0xbfc0e9=>{const _0x164b53=_0x3a0b20,_0x5530cd=_0x48f41b['find'](_0xeaa4b6=>_0xeaa4b6[_0x164b53(0x1c5)]==_0xbfc0e9[_0x164b53(0x1c5)])[_0x164b53(0x1c7)];_0x4e3781+=_0x164b53(0x20e)+_0xbfc0e9[_0x164b53(0x1c5)]+':\x20'+_0xbfc0e9['status']+'\x20|\x20'+_0x5530cd+_0x164b53(0x1e0)+_0xbfc0e9[_0x164b53(0x32e)]+'\x0a';}),_0x4e3781+='\x0a',_0x4e3781+=_0x3a0b20(0x1e9),_0x4e3781+=!settings[_0x3a0b20(0x2f8)]?'Notifications\x20disabled\x0a':_0x3a0b20(0x1cc),_0x4e3781+=settings[_0x3a0b20(0x2f8)]?settings[_0x3a0b20(0x1d4)]==_0x3a0b20(0x1f8)?_0x3a0b20(0x29f):_0x3a0b20(0x332)+settings[_0x3a0b20(0x1d4)]+_0x3a0b20(0x275):'',tgBot['sendMessage'](_0x55bd79['chat']['id'],_0x4e3781,{'parse_mode':'HTML'})[_0x3a0b20(0x31a)](_0x2c2079=>{telegramError(_0x2c2079);});}),tgBot[_0x59ccba(0x34e)](/\/restart/,_0x2ca028=>{const _0x5d7ea4=_0x59ccba;if(!validateTelegram(_0x2ca028))return;tgBot['removeListener']('callback_query');const _0x5504b9=getEnabledBots();if(_0x5504b9['length']==0x0)tgBot['sendMessage'](_0x2ca028['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x5d7ea4(0x31a)](_0x5b0577=>{telegramError(_0x5b0577);});else{if(_0x5504b9[_0x5d7ea4(0x1ba)]>0x1)_0x5504b9[_0x5d7ea4(0x2f0)]({'botID':_0x5d7ea4(0x1f8)});let _0x59b9f2=[],_0x4f1497=[];const _0x59d9d7=_0x5504b9[_0x5d7ea4(0x1ba)]%0x4==0x0||_0x5504b9[_0x5d7ea4(0x1ba)]%0x4==0x3||_0x5504b9[_0x5d7ea4(0x1ba)]%0x3==0x1?0x4:0x3;let _0x227f24=0x0;_0x5504b9[_0x5d7ea4(0x2a7)]((_0x281b9a,_0x3b659e)=>{const _0x2ffd4d=_0x5d7ea4;if(_0x3b659e%_0x59d9d7==0x0)_0x4f1497=[];_0x4f1497[_0x2ffd4d(0x2f0)]({'text':_0x281b9a[_0x2ffd4d(0x1c5)]==_0x2ffd4d(0x1f8)?_0x2ffd4d(0x29d):_0x2ffd4d(0x20e)+_0x281b9a[_0x2ffd4d(0x1c5)],'callback_data':_0x281b9a['botID']}),_0x3b659e%_0x59d9d7==0x0&&(_0x59b9f2[_0x227f24]=_0x4f1497,_0x227f24++);}),tgBot[_0x5d7ea4(0x2b9)](_0x2ca028[_0x5d7ea4(0x2ba)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x59b9f2}})[_0x5d7ea4(0x31a)](_0x3b1019=>{telegramError(_0x3b1019);}),tgBot['on'](_0x5d7ea4(0x294),async _0x3d7e2c=>{const _0x10594b=_0x5d7ea4,_0x232eb9=_0x3d7e2c[_0x10594b(0x269)],_0x11448f=_0x3d7e2c[_0x10594b(0x322)];tgBot['answerCallbackQuery'](_0x3d7e2c['id'])['then'](async()=>{const _0x51cd59=_0x10594b;_0x232eb9==_0x51cd59(0x1f8)?config['forEach'](_0x27868b=>{const _0x523bf9=_0x51cd59;restartBot(_0x27868b[_0x523bf9(0x1c5)]);}):restartBot(_0x232eb9);}),tgBot[_0x10594b(0x2e5)]('callback_query');});}}),tgBot[_0x59ccba(0x34e)](/\/on/,_0xe045b9=>{const _0x322e2c=_0x59ccba;if(!validateTelegram(_0xe045b9))return;tgBot[_0x322e2c(0x2e5)]('callback_query');const _0x5bf436=getDisabledBots();if(_0x5bf436[_0x322e2c(0x1ba)]==0x0)tgBot['sendMessage'](_0xe045b9[_0x322e2c(0x2ba)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x322e2c(0x31a)](_0x30387f=>{telegramError(_0x30387f);});else{if(_0x5bf436[_0x322e2c(0x1ba)]>0x1)_0x5bf436['push']({'botID':'all'});let _0x30c0eb=[],_0x3433f5=[];const _0x95c266=_0x5bf436[_0x322e2c(0x1ba)]%0x4==0x0||_0x5bf436[_0x322e2c(0x1ba)]%0x4==0x3||_0x5bf436['length']%0x3==0x1?0x4:0x3;let _0x1485a1=0x0;_0x5bf436[_0x322e2c(0x2a7)]((_0x141076,_0x3ae917)=>{const _0x30b6d4=_0x322e2c;if(_0x3ae917%_0x95c266==0x0)_0x3433f5=[];_0x3433f5[_0x30b6d4(0x2f0)]({'text':_0x141076[_0x30b6d4(0x1c5)]==_0x30b6d4(0x1f8)?_0x30b6d4(0x29d):_0x30b6d4(0x20e)+_0x141076['botID'],'callback_data':_0x141076[_0x30b6d4(0x1c5)]}),_0x3ae917%_0x95c266==0x0&&(_0x30c0eb[_0x1485a1]=_0x3433f5,_0x1485a1++);}),tgBot[_0x322e2c(0x2b9)](_0xe045b9[_0x322e2c(0x2ba)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x30c0eb}})[_0x322e2c(0x31a)](_0x47a5db=>{telegramError(_0x47a5db);}),tgBot['on'](_0x322e2c(0x294),async _0x23ffe9=>{const _0x1f8d1e=_0x322e2c,_0x98efe5=_0x23ffe9[_0x1f8d1e(0x269)],_0x5d4d94=_0x23ffe9[_0x1f8d1e(0x322)];tgBot['answerCallbackQuery'](_0x23ffe9['id'])[_0x1f8d1e(0x1bc)](async()=>{const _0x37490d=_0x1f8d1e;_0x98efe5==_0x37490d(0x1f8)?(tgBot[_0x37490d(0x2b9)](_0x5d4d94['chat']['id'],_0x37490d(0x287))['catch'](_0x3b2f43=>{telegramError(_0x3b2f43);}),_0x5bf436[_0x37490d(0x2a7)](_0x473ef3=>{const _0x177c3f=_0x37490d;if(_0x473ef3[_0x177c3f(0x1c5)]!=_0x177c3f(0x1f8))toggleBot(_0x473ef3[_0x177c3f(0x1c5)],toggleStatus(_0x473ef3['botID']),_0x177c3f(0x340));})):(tgBot[_0x37490d(0x2b9)](_0x5d4d94['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x98efe5)[_0x37490d(0x31a)](_0x3445da=>{telegramError(_0x3445da);}),toggleBot(_0x98efe5,toggleStatus(_0x98efe5),_0x37490d(0x340)));}),tgBot[_0x1f8d1e(0x2e5)](_0x1f8d1e(0x294));});}}),tgBot[_0x59ccba(0x34e)](/\/off/,_0x5037ee=>{const _0x34f2cc=_0x59ccba;if(!validateTelegram(_0x5037ee))return;tgBot['removeListener'](_0x34f2cc(0x294));const _0x5eebba=getEnabledBots();if(_0x5eebba['length']==0x0)tgBot[_0x34f2cc(0x2b9)](_0x5037ee[_0x34f2cc(0x2ba)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x2509a3=>{telegramError(_0x2509a3);});else{if(_0x5eebba['length']>0x1)_0x5eebba[_0x34f2cc(0x2f0)]({'botID':_0x34f2cc(0x1f8)});let _0x421bf9=[],_0x56d566=[];const _0x56a534=_0x5eebba[_0x34f2cc(0x1ba)]%0x4==0x0||_0x5eebba['length']%0x4==0x3||_0x5eebba[_0x34f2cc(0x1ba)]%0x3==0x1?0x4:0x3;let _0xa8691b=0x0;_0x5eebba[_0x34f2cc(0x2a7)]((_0x37b0b8,_0xa02730)=>{const _0x4f7ebd=_0x34f2cc;if(_0xa02730%_0x56a534==0x0)_0x56d566=[];_0x56d566[_0x4f7ebd(0x2f0)]({'text':_0x37b0b8[_0x4f7ebd(0x1c5)]==_0x4f7ebd(0x1f8)?_0x4f7ebd(0x29d):_0x4f7ebd(0x20e)+_0x37b0b8['botID'],'callback_data':_0x37b0b8[_0x4f7ebd(0x1c5)]}),_0xa02730%_0x56a534==0x0&&(_0x421bf9[_0xa8691b]=_0x56d566,_0xa8691b++);}),tgBot['sendMessage'](_0x5037ee['chat']['id'],_0x34f2cc(0x2f4),{'reply_markup':{'inline_keyboard':_0x421bf9}})[_0x34f2cc(0x31a)](_0xea0430=>{telegramError(_0xea0430);}),tgBot['on'](_0x34f2cc(0x294),async _0x31d510=>{const _0x275e30=_0x34f2cc,_0x5c82bf=_0x31d510[_0x275e30(0x269)],_0x51dbc2=_0x31d510[_0x275e30(0x322)];tgBot[_0x275e30(0x28b)](_0x31d510['id'])[_0x275e30(0x1bc)](async()=>{const _0xa9cd2c=_0x275e30;_0x5c82bf==_0xa9cd2c(0x1f8)?(tgBot[_0xa9cd2c(0x2b9)](_0x51dbc2['chat']['id'],_0xa9cd2c(0x1fc))[_0xa9cd2c(0x31a)](_0x2c3b79=>{telegramError(_0x2c3b79);}),_0x5eebba['forEach'](_0x421f74=>{const _0x2d54b7=_0xa9cd2c;if(_0x421f74['botID']!=_0x2d54b7(0x1f8))toggleBot(_0x421f74[_0x2d54b7(0x1c5)],toggleStatus(_0x421f74['botID']),_0x2d54b7(0x340));})):(tgBot[_0xa9cd2c(0x2b9)](_0x51dbc2[_0xa9cd2c(0x2ba)]['id'],_0xa9cd2c(0x1c2)+_0x5c82bf)[_0xa9cd2c(0x31a)](_0x1da82b=>{telegramError(_0x1da82b);}),toggleBot(_0x5c82bf,toggleStatus(_0x5c82bf),'stopped'));}),tgBot[_0x275e30(0x2e5)](_0x275e30(0x294));});}}),tgBot[_0x59ccba(0x34e)](/\/portfolio/,_0x2cd771=>{const _0x34308c=_0x59ccba;if(!validateTelegram(_0x2cd771))return;tgBot[_0x34308c(0x2e5)](_0x34308c(0x294));const _0x2d06e2=getEnabledBots();if(_0x2d06e2[_0x34308c(0x1ba)]==0x0)tgBot[_0x34308c(0x2b9)](_0x2cd771[_0x34308c(0x2ba)]['id'],_0x34308c(0x1dc))[_0x34308c(0x31a)](_0x14936d=>{telegramError(_0x14936d);});else{if(_0x2d06e2[_0x34308c(0x1ba)]>0x1){let _0x5e4b6a=[],_0x2c5703=[];const _0x24bfc3=_0x2d06e2[_0x34308c(0x1ba)]%0x4==0x0||_0x2d06e2[_0x34308c(0x1ba)]%0x4==0x3||_0x2d06e2['length']%0x3==0x1?0x4:0x3;let _0x32b47d=0x0;_0x2d06e2[_0x34308c(0x2a7)]((_0x1ed0e3,_0xc4b948)=>{const _0x47ba22=_0x34308c;if(_0xc4b948%_0x24bfc3==0x0)_0x2c5703=[];_0x2c5703[_0x47ba22(0x2f0)]({'text':_0x47ba22(0x20e)+_0x1ed0e3[_0x47ba22(0x1c5)],'callback_data':_0x1ed0e3[_0x47ba22(0x1c5)]}),_0xc4b948%_0x24bfc3==0x0&&(_0x5e4b6a[_0x32b47d]=_0x2c5703,_0x32b47d++);}),tgBot[_0x34308c(0x2b9)](_0x2cd771[_0x34308c(0x2ba)]['id'],_0x34308c(0x30e),{'reply_markup':{'inline_keyboard':_0x5e4b6a}})[_0x34308c(0x31a)](_0xa9604=>{telegramError(_0xa9604);}),tgBot['on']('callback_query',async _0x3cb45d=>{const _0x328f46=_0x34308c,_0x1c4c4f=_0x3cb45d[_0x328f46(0x269)],_0x5dba81=_0x3cb45d['message'];tgBot[_0x328f46(0x28b)](_0x3cb45d['id'])[_0x328f46(0x1bc)](async()=>{const _0x68b6c4=_0x328f46;if(pid[_0x1c4c4f])pid[_0x1c4c4f][_0x68b6c4(0x1d5)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x328f46(0x2e5)](_0x328f46(0x294));});}else{const _0x4f2f7b=_0x2d06e2[0x0]['botID'];if(pid[_0x4f2f7b])pid[_0x4f2f7b][_0x34308c(0x1d5)]({'function':_0x34308c(0x279),'args':null});}}}),tgBot[_0x59ccba(0x34e)](/\/update/,async _0x2999db=>{const _0x3574ef=_0x59ccba;if(!validateTelegram(_0x2999db))return;tgBot[_0x3574ef(0x2e5)](_0x3574ef(0x294)),await getMessages();if(!updateAvailable)tgBot['sendMessage'](_0x2999db[_0x3574ef(0x2ba)]['id'],_0x3574ef(0x31c))[_0x3574ef(0x31a)](_0x5b2a2c=>{telegramError(_0x5b2a2c);});else!validInstallation?tgBot['sendMessage'](_0x2999db['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')['catch'](_0x3e81fe=>{telegramError(_0x3e81fe);}):(tgBot[_0x3574ef(0x2b9)](_0x2999db[_0x3574ef(0x2ba)]['id'],_0x3574ef(0x1c8),{'reply_markup':{'inline_keyboard':[[{'text':_0x3574ef(0x2d3),'callback_data':_0x3574ef(0x1bf)},{'text':'No','callback_data':'no'}]]}})[_0x3574ef(0x31a)](_0x2f646e=>{telegramError(_0x2f646e);}),tgBot['on'](_0x3574ef(0x294),async _0x106c10=>{const _0x22e4f7=_0x3574ef,_0x2b8651=_0x106c10[_0x22e4f7(0x269)],_0x5ac4ee=_0x106c10[_0x22e4f7(0x322)];tgBot[_0x22e4f7(0x28b)](_0x106c10['id'])[_0x22e4f7(0x1bc)](async()=>{const _0x34ea65=_0x22e4f7;_0x2b8651==_0x34ea65(0x1bf)&&(await tgBot[_0x34ea65(0x2b9)](_0x5ac4ee[_0x34ea65(0x2ba)]['id'],'Starting\x20Balance\x20Bot\x20update')['catch'](_0x161058=>{telegramError(_0x161058);}),updateBB());_0x2b8651=='no'&&await tgBot[_0x34ea65(0x2b9)](_0x5ac4ee[_0x34ea65(0x2ba)]['id'],_0x34ea65(0x2c1))['catch'](_0x3a3baa=>{telegramError(_0x3a3baa);});if(!settings[_0x34ea65(0x244)])tgBot[_0x34ea65(0x2b9)](_0x5ac4ee[_0x34ea65(0x2ba)]['id'],_0x34ea65(0x34f))[_0x34ea65(0x31a)](_0x566a09=>{telegramError(_0x566a09);});}),tgBot['removeListener'](_0x22e4f7(0x294));}));}),tgBot[_0x59ccba(0x34e)](/\/toggle/,_0x38a59c=>{const _0x515fe7=_0x59ccba;if(!validateTelegram(_0x38a59c))return;tgBot[_0x515fe7(0x2e5)]('callback_query');const _0xae21bf=getBotsWithMode();if(_0xae21bf[_0x515fe7(0x1ba)]==0x0)tgBot[_0x515fe7(0x2b9)](_0x38a59c['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x515fe7(0x31a)](_0x427c68=>{telegramError(_0x427c68);});else{let _0x150f16=[],_0x3960f0=[];const _0x1c316b=0x2;let _0x5af74e=0x0;_0xae21bf[_0x515fe7(0x2a7)]((_0x26b17d,_0x17baa6)=>{const _0xef6365=_0x515fe7;if(_0x17baa6%_0x1c316b==0x0)_0x3960f0=[];_0x3960f0[_0xef6365(0x2f0)]({'text':'Bot\x20'+_0x26b17d[_0xef6365(0x1c5)]+'\x20('+_0x26b17d[_0xef6365(0x1c7)]+')','callback_data':_0x26b17d[_0xef6365(0x1c5)]}),_0x17baa6%_0x1c316b==0x0&&(_0x150f16[_0x5af74e]=_0x3960f0,_0x5af74e++);}),tgBot[_0x515fe7(0x2b9)](_0x38a59c['chat']['id'],_0x515fe7(0x2bb),{'reply_markup':{'inline_keyboard':_0x150f16}})[_0x515fe7(0x31a)](_0x51ddf7=>{telegramError(_0x51ddf7);}),tgBot['on'](_0x515fe7(0x294),async _0x99214d=>{const _0x522315=_0x515fe7,_0xc18905=_0x99214d[_0x522315(0x269)],_0x471ee5=_0x99214d[_0x522315(0x322)];tgBot[_0x522315(0x28b)](_0x99214d['id'])['then'](async()=>{const _0x26e70c=_0x522315,_0x3ceb9d=_0xae21bf[_0x26e70c(0x245)](_0x181b6d=>_0x181b6d['botID']==_0xc18905),_0x65c101=_0x3ceb9d['mode']=='auto'?_0x26e70c(0x22f):_0x26e70c(0x258);tgBot['sendMessage'](_0x471ee5[_0x26e70c(0x2ba)]['id'],_0x26e70c(0x265)+_0xc18905+_0x26e70c(0x1b3)+_0x65c101+_0x26e70c(0x203))['catch'](_0x3d69e2=>{telegramError(_0x3d69e2);}),toggleBotMode(_0xc18905);}),tgBot[_0x522315(0x2e5)]('callback_query');});}}),tgBot[_0x59ccba(0x34e)](/\/names/,_0x56a9cd=>{const _0x242462=_0x59ccba;if(!validateTelegram(_0x56a9cd))return;let _0x46e886='';config[_0x242462(0x2a7)](_0x81b24d=>{const _0x5636f7=_0x242462;_0x46e886+='Bot\x20'+_0x81b24d[_0x5636f7(0x1c5)]+':\x20'+_0x81b24d[_0x5636f7(0x29b)]+'\x0a';}),tgBot['sendMessage'](_0x56a9cd[_0x242462(0x2ba)]['id'],_0x46e886,{'parse_mode':_0x242462(0x2ff)})[_0x242462(0x31a)](_0x1f4a90=>{telegramError(_0x1f4a90);});}),tgBot['onText'](/\/disable/,_0x307e9f=>{const _0x42b0e8=_0x59ccba;if(!validateTelegram(_0x307e9f))return;tgBot[_0x42b0e8(0x2b9)](_0x307e9f[_0x42b0e8(0x2ba)]['id'],'Notifications\x20disabled')[_0x42b0e8(0x31a)](_0x348152=>{telegramError(_0x348152);}),updateSetting(_0x42b0e8(0x2f8),![]);}),tgBot[_0x59ccba(0x34e)](/\/help/,_0x1d2b4a=>{const _0x139f67=_0x59ccba;if(!validateTelegram(_0x1d2b4a))return;tgBot['sendMessage'](_0x1d2b4a[_0x139f67(0x2ba)]['id'],_0x54dee9)[_0x139f67(0x31a)](_0x3f5171=>{telegramError(_0x3f5171);});}),tgBot['on'](_0x59ccba(0x226),_0x2e43e9=>{const _0x18d5e0=_0x59ccba;_0x2e43e9['toString']()[_0x18d5e0(0x30b)]('404\x20Not\x20Found')&&(logger[_0x18d5e0(0x335)]('Invalid\x20Telegram\x20token'),tgBot[_0x18d5e0(0x1fd)](),tgBot=null,io['to'](_0x18d5e0(0x1f1))[_0x18d5e0(0x2ef)]('notification',_0x18d5e0(0x249)));}),process['once'](_0x59ccba(0x227),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);}),process[_0x59ccba(0x238)](_0x59ccba(0x1db),()=>{const _0x16729a=_0x59ccba;if(tgBot)tgBot[_0x16729a(0x1fd)]();process['exit'](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x289774,_0x550ae1){const _0x4892fb=_0x1a8ea8;if(settings[_0x4892fb(0x2f8)]){if(settings['telegramEvents']==_0x4892fb(0x1f8)||(_0x550ae1[_0x4892fb(0x253)]==_0x4892fb(0x284)||_0x550ae1[_0x4892fb(0x253)]==_0x4892fb(0x1ee)||_0x550ae1[_0x4892fb(0x253)]==_0x4892fb(0x348))&&settings[_0x4892fb(0x1d4)]==_0x4892fb(0x1e3)||_0x550ae1['type']==_0x4892fb(0x290)&&settings[_0x4892fb(0x1d4)]=='orders'){if(tgBot&&settings['telegramChatId']){if(_0x550ae1[_0x4892fb(0x293)])tgBot[_0x4892fb(0x2b9)](settings['telegramChatId'],_0x550ae1[_0x4892fb(0x29b)]+_0x4892fb(0x1c4)+_0x550ae1[_0x4892fb(0x2e2)])[_0x4892fb(0x31a)](_0x1c081d=>{telegramError(_0x1c081d);});else tgBot[_0x4892fb(0x2b9)](settings['telegramChatId'],_0x4892fb(0x20e)+_0x289774+_0x4892fb(0x1c4)+_0x550ae1['event'])[_0x4892fb(0x31a)](_0x31df64=>{telegramError(_0x31df64);});}}}}async function sendTelegramMsg(_0x2bb6cb,_0x1e8652=_0x1a8ea8(0x2ff)){const _0x380dcd=_0x1a8ea8;return settings[_0x380dcd(0x2f8)]&&tgBot&&settings[_0x380dcd(0x244)]?(await tgBot[_0x380dcd(0x2b9)](settings[_0x380dcd(0x244)],_0x2bb6cb,{'parse_mode':_0x1e8652})[_0x380dcd(0x31a)](_0x1ff699=>{telegramError(_0x1ff699);}),!![]):![];}function getDeviceWithIp(_0x598d21){const _0x2dc455=_0x1a8ea8;return devices[_0x2dc455(0x245)](_0x2ae494=>_0x2ae494['ip']===_0x598d21);}function temporaryAccess2FA(_0x5995ae,_0x5ce943){const _0x1ab6e8=_0x1a8ea8;let _0x593f40=new Date(),_0x553e2a=![];if(lastIpApproval){if(_0x593f40-lastIpApproval<0x1388)_0x553e2a=!![];}lastIpApproval=new Date();if(_0x553e2a)return;tgBot&&settings[_0x1ab6e8(0x244)]&&(tgBot[_0x1ab6e8(0x2e5)](_0x1ab6e8(0x294)),tgBot['sendMessage'](settings[_0x1ab6e8(0x244)],_0x1ab6e8(0x317)+normalizeIP(_0x5ce943)[_0x1ab6e8(0x24f)]+_0x1ab6e8(0x31b),{'parse_mode':_0x1ab6e8(0x2ff),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x1ab6e8(0x2a4),'callback_data':'30'},{'text':'reject','callback_data':'reject'}]]}})['catch'](_0x175366=>{telegramError(_0x175366);}),tgBot['on'](_0x1ab6e8(0x294),async _0x12f653=>{const _0x55a341=_0x1ab6e8,_0x4721b4=_0x12f653['data'],_0x27affc=_0x12f653['message'];tgBot[_0x55a341(0x28b)](_0x12f653['id'])[_0x55a341(0x1bc)](async()=>{const _0x1f94f2=_0x55a341;devices[_0x5995ae][_0x1f94f2(0x1b8)]={'clientip':_0x5ce943,'timestamp':new Date()['getTime'](),'expiry':_0x4721b4},_0x4721b4!=_0x1f94f2(0x1ff)?(await tgBot[_0x1f94f2(0x2b9)](_0x27affc[_0x1f94f2(0x2ba)]['id'],'Access\x20enabled\x20for\x20'+_0x4721b4+_0x1f94f2(0x291),{'parse_mode':_0x1f94f2(0x2ff)})[_0x1f94f2(0x31a)](_0x14b3e5=>{telegramError(_0x14b3e5);}),io['to'](_0x5995ae)[_0x1f94f2(0x2ef)](_0x1f94f2(0x1e4),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x1f94f2(0x2b9)](_0x27affc['chat']['id'],_0x1f94f2(0x248))[_0x1f94f2(0x31a)](_0xcd6435=>{telegramError(_0xcd6435);}),io['to'](_0x5995ae)[_0x1f94f2(0x2ef)](_0x1f94f2(0x1e4),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x55a341(0x2e5)](_0x55a341(0x294));}));}function loginAccess2FA(_0x5ab350,_0x4aa02d){const _0x1d8763=_0x1a8ea8;tgBot&&settings['telegramChatId']&&(tgBot[_0x1d8763(0x2e5)](_0x1d8763(0x294)),tgBot['sendMessage'](settings['telegramChatId'],_0x1d8763(0x1b5)+normalizeIP(_0x4aa02d)[_0x1d8763(0x24f)]+_0x1d8763(0x31b),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x1d8763(0x32f),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x1d8763(0x1ff)}]]}})['catch'](_0x2b0cac=>{telegramError(_0x2b0cac);}),tgBot['on'](_0x1d8763(0x294),async _0x28c337=>{const _0x5ae05c=_0x1d8763,_0x453df0=_0x28c337[_0x5ae05c(0x269)],_0x6d1ae9=_0x28c337[_0x5ae05c(0x322)];tgBot[_0x5ae05c(0x28b)](_0x28c337['id'])['then'](async()=>{const _0x5493ae=_0x5ae05c;devices[_0x5ab350][_0x5493ae(0x298)]={'clientip':_0x4aa02d,'timestamp':new Date()[_0x5493ae(0x303)](),'expiry':_0x453df0},_0x453df0!=_0x5493ae(0x1ff)?(await tgBot[_0x5493ae(0x2b9)](_0x6d1ae9[_0x5493ae(0x2ba)]['id'],'Login\x20accepted',{'parse_mode':_0x5493ae(0x2ff)})[_0x5493ae(0x31a)](_0x4fadf8=>{telegramError(_0x4fadf8);}),io['to'](_0x5ab350)['emit'](_0x5493ae(0x1e4),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot['sendMessage'](_0x6d1ae9['chat']['id'],_0x5493ae(0x2d6))[_0x5493ae(0x31a)](_0x3ac063=>{telegramError(_0x3ac063);}),io['to'](_0x5ab350)[_0x5493ae(0x2ef)](_0x5493ae(0x1e4),{'access':{'allow':![],'reason':_0x5493ae(0x1b6),'token':null}}));}),tgBot[_0x5ae05c(0x2e5)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x28d827=_0x1a8ea8;return dbConfig[_0x28d827(0x1f4)]('bots')[_0x28d827(0x1d8)]('botID')['filter']({'status':_0x28d827(0x301)})[_0x28d827(0x1fa)]()||[];}function getDisabledBots(){const _0x1f98be=_0x1a8ea8;return dbConfig[_0x1f98be(0x1f4)](_0x1f98be(0x288))[_0x1f98be(0x1d8)](_0x1f98be(0x1c5))[_0x1f98be(0x22d)]({'status':_0x1f98be(0x273)})[_0x1f98be(0x1fa)]()||[];}function getBotAttributes(_0x3bba58){const _0xf0035a=_0x1a8ea8;let _0x3e2126={};const _0x49d6ae=configpath+_0xf0035a(0x1cf)+_0x3bba58+'-config.json',_0x5da0c5=fs[_0xf0035a(0x217)](_0x49d6ae);if(_0x5da0c5){const _0x3f541c=fs[_0xf0035a(0x1e7)](_0x49d6ae);try{const _0x57eeec=JSON[_0xf0035a(0x25e)](_0x3f541c),_0x530e2a=_0x57eeec?_0x57eeec[_0xf0035a(0x1c9)][0x0][_0xf0035a(0x1f6)]:![];_0x3e2126[_0xf0035a(0x1c7)]=_0x530e2a?'auto':_0xf0035a(0x22f),_0x3e2126[_0xf0035a(0x29b)]=_0x57eeec?_0x57eeec[_0xf0035a(0x1c9)][0x0][_0xf0035a(0x29b)]:_0xf0035a(0x20e)+_0x3bba58;}catch(_0x1494d2){_0x3e2126[_0xf0035a(0x1c7)]=_0xf0035a(0x22f),_0x3e2126['botname']=_0xf0035a(0x20e)+_0x3bba58;}}else _0x3e2126[_0xf0035a(0x1c7)]=_0xf0035a(0x22f),_0x3e2126[_0xf0035a(0x29b)]=_0xf0035a(0x20e)+_0x3bba58;return _0x3e2126;}function getBotsWithMode(){const _0x17af05=_0x1a8ea8,_0xe53d7e=dbConfig['get']('bots')[_0x17af05(0x1d8)](_0x17af05(0x1c5))[_0x17af05(0x1fa)]()||[];return _0xe53d7e['forEach'](_0x2435c4=>{const _0x4c1751=_0x17af05;let _0x1ac9ad=getBotAttributes(_0x2435c4[_0x4c1751(0x1c5)]);_0x2435c4[_0x4c1751(0x1c7)]=_0x1ac9ad['mode'];}),_0xe53d7e;}function getBotExchanges(){const _0x4b5a43=_0x1a8ea8;let _0x2e3181=[];const _0x1d7ed4=dbConfig[_0x4b5a43(0x1f4)](_0x4b5a43(0x288))['sortBy'](_0x4b5a43(0x1c5))['value']()||[];_0x1d7ed4[_0x4b5a43(0x2a7)](_0x233056=>{const _0x5ca46a=_0x4b5a43;if(_0x233056['status']==_0x5ca46a(0x301)){const _0x2d3ac9=configpath+_0x5ca46a(0x1cf)+_0x233056[_0x5ca46a(0x1c5)]+_0x5ca46a(0x2c0),_0x4a476c=fs[_0x5ca46a(0x217)](_0x2d3ac9);let _0x5668b0;if(_0x4a476c){const _0x112521=fs[_0x5ca46a(0x1e7)](_0x2d3ac9);try{const _0x3bd188=JSON[_0x5ca46a(0x25e)](_0x112521);_0x5668b0=_0x3bd188?_0x3bd188['bot'][0x0][_0x5ca46a(0x319)]:null;}catch(_0x5d3588){}}if(_0x5668b0)_0x2e3181['push'](_0x5668b0);}});const _0x54f2d1=[...new Set(_0x2e3181)]['sort']();return _0x54f2d1;}async function initUser(){const _0xa54054=_0x1a8ea8;if(!settings[_0xa54054(0x27b)]){const _0x72d6de=uuidRandom();mixpanel[_0xa54054(0x261)](_0x72d6de),updateSetting(_0xa54054(0x27b),_0x72d6de);}}async function initSecure(){const _0x3e5b8e=_0x1a8ea8;let _0x201ffb=getSecure();if(!_0x201ffb[_0x3e5b8e(0x1d0)]('secret')){let _0x43478d=await generateKeys();_0x201ffb['publicKey']=_0x43478d[_0x3e5b8e(0x2c3)],_0x201ffb[_0x3e5b8e(0x2b8)]=_0x43478d['privateKey'],_0x201ffb[_0x3e5b8e(0x2bd)]=crypto['randomBytes'](0x20)[_0x3e5b8e(0x2a5)]('hex');;storeSecure(_0x201ffb);}}function getSettings(){const _0x21064a=_0x1a8ea8;return dbSettings[_0x21064a(0x1f4)](_0x21064a(0x2b3))[_0x21064a(0x1fa)]()||{};}function getSecure(){return dbSecure['get']('secure')['value']()||{};}function getBlacklist(){const _0x5352a0=_0x1a8ea8;return dbSecure[_0x5352a0(0x1f4)]('blacklist')['value']()||[];}function broadcastToBots(_0xc71e01,_0x3f03eb){const _0x361e65=_0x1a8ea8;config[_0x361e65(0x2a7)](_0xd76698=>{const _0x2bf135=_0x361e65;if(_0xd76698[_0x2bf135(0x1e4)]==_0x2bf135(0x301)&&_0xd76698[_0x2bf135(0x32e)]=='running'){if(pid[_0xd76698['botID']])pid[_0xd76698['botID']][_0x2bf135(0x1d5)]({[_0xc71e01]:_0x3f03eb});}});}function storeSettings(_0x3e999d,_0x3b4398=![]){const _0x418eae=_0x1a8ea8;_0x3e999d={...settings,..._0x3e999d};if(_0x3b4398&&_0x3e999d[_0x418eae(0x281)]!='************'&&_0x3e999d[_0x418eae(0x281)]!=_0x418eae(0x21f)&&_0x3e999d[_0x418eae(0x281)]!=''){const _0x3d233a=crypt['decrypt'](secure[_0x418eae(0x2b8)],_0x3e999d['bbPassword'])[_0x418eae(0x322)][_0x418eae(0x2fa)]('@')[0x0],_0x4bd5dd=bcrypt[_0x418eae(0x205)](_0x3d233a,saltRounds);_0x3e999d={..._0x3e999d,'bbPassword':_0x4bd5dd};}if(_0x3b4398&&_0x3e999d[_0x418eae(0x2e3)]!=_0x418eae(0x32d)&&_0x3e999d[_0x418eae(0x2e3)]!=_0x418eae(0x21f)&&_0x3e999d[_0x418eae(0x2e3)]!=''){const _0x3bf8b1=crypt[_0x418eae(0x282)](secure[_0x418eae(0x2b8)],_0x3e999d[_0x418eae(0x2e3)])[_0x418eae(0x322)][_0x418eae(0x2fa)]('@')[0x0];_0x3e999d={..._0x3e999d,'telegramToken':_0x3bf8b1};}const _0x7fa001=_0x3e999d['telegramToken']!='************'&&_0x3e999d[_0x418eae(0x2e3)]!=settings[_0x418eae(0x2e3)]||_0x3e999d[_0x418eae(0x2f9)]!=settings['telegramUsername'],_0x221af8=_0x3e999d[_0x418eae(0x2e3)]==''||_0x3e999d[_0x418eae(0x2f9)]=='';if(_0x7fa001)_0x3e999d['telegramEvents']='all';for(const [_0x2274c5,_0x146413]of Object['entries'](_0x3e999d)){if(_0x2274c5==_0x418eae(0x2e3)&&_0x146413==_0x418eae(0x32d)){_0x3e999d['telegramToken']=settings[_0x418eae(0x2e3)];continue;};if(_0x2274c5==_0x418eae(0x281)&&_0x146413==_0x418eae(0x32d)){_0x3e999d[_0x418eae(0x281)]=settings['bbPassword'];continue;};dbSettings[_0x418eae(0x2e7)](_0x418eae(0x2ac)+_0x2274c5,_0x146413)['write']();}settings=_0x3e999d,io['to'](_0x418eae(0x1f1))[_0x418eae(0x2ef)]('settings',cleanSettings()),broadcastToBots(_0x418eae(0x308),settings['timeshift']);if(_0x7fa001&&!_0x221af8)initTelegram();if(_0x7fa001&&_0x221af8)disableTelegram();getAllClients()['forEach'](_0x4a04cc=>{const _0x1bd4a5=_0x418eae;getSocket(_0x4a04cc['id'])[_0x1bd4a5(0x2ef)](_0x1bd4a5(0x1e4),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x23d824,_0xa0d51c){const _0x55dc2e=_0x1a8ea8;dbSettings[_0x55dc2e(0x2e7)](_0x55dc2e(0x2ac)+_0x23d824,_0xa0d51c)[_0x55dc2e(0x236)](),settings=getSettings(),io['to'](_0x55dc2e(0x1f1))[_0x55dc2e(0x2ef)](_0x55dc2e(0x2b3),cleanSettings());}function storeSecure(_0x44aae6){const _0x170ef8=_0x1a8ea8;dbSecure[_0x170ef8(0x1f4)](_0x170ef8(0x27d))[_0x170ef8(0x2f0)](_0x44aae6)['write'](),secure=_0x44aae6;}function addBlacklist(_0x494a6c){const _0x478f76=_0x1a8ea8;cleanBlacklist();let _0x380eae;devices[_0x494a6c]['telegramIpApproval']?_0x380eae=Math[_0x478f76(0x1d9)](devices[_0x494a6c]['telegramIpApproval'][_0x478f76(0x259)],loginExpiry):_0x380eae=loginExpiry,dbSecure[_0x478f76(0x1f4)](_0x478f76(0x30a))[_0x478f76(0x2f0)]({'expiry':new Date()[_0x478f76(0x303)]()+_0x380eae*0x3c*0x3e8,'token':devices[_0x494a6c][_0x478f76(0x2b4)]['token']})[_0x478f76(0x236)](),blacklist=dbSecure[_0x478f76(0x1f4)]('blacklist')[_0x478f76(0x1fa)]();}function cleanBlacklist(){const _0x415b04=_0x1a8ea8;let _0xd74e7d=dbSecure['get'](_0x415b04(0x30a))[_0x415b04(0x1be)]()[_0x415b04(0x1fa)](),_0xf79a1b=new Date()[_0x415b04(0x303)]();_0xd74e7d['forEach'](_0x266e8f=>{const _0x274c0d=_0x415b04;_0x266e8f['expiry']<_0xf79a1b&&dbSecure['get']('blacklist')[_0x274c0d(0x310)]({'expiry':_0x266e8f['expiry']})[_0x274c0d(0x236)]();});}function initStates(){const _0x241796=_0x1a8ea8;let _0x19ad11=getConfiguration();_0x19ad11[_0x241796(0x2a7)](_0x8ab85c=>{const _0x5c8f4b=_0x241796;_0x8ab85c[_0x5c8f4b(0x32e)]='stopped';}),storeConfiguration(_0x19ad11);}function onKeys(){const _0x4e5940=new RSA();return new Promise(_0x5f41a9=>{const _0x384b11=_0x4eba;_0x4e5940[_0x384b11(0x216)]()[_0x384b11(0x1bc)](_0x49621d=>{_0x5f41a9(_0x49621d);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x53496e=_0x1a8ea8;let _0x48973d=getSettings(),_0xdcb8c7=![];!_0x48973d[_0x53496e(0x1d0)](_0x53496e(0x26a))&&(_0x48973d['lastmsgtelegram']=0x0,_0xdcb8c7=!![]);!_0x48973d[_0x53496e(0x1d0)](_0x53496e(0x2a6))&&(_0x48973d[_0x53496e(0x2a6)]=0x0,_0xdcb8c7=!![]);!_0x48973d['hasOwnProperty']('latestversion')&&(_0x48973d[_0x53496e(0x26d)]=_0x53496e(0x277),_0xdcb8c7=!![]);if(_0xdcb8c7)storeSettings(_0x48973d);}function storeConfiguration(_0x232940){const _0x3a1fbd=_0x1a8ea8;dbConfig[_0x3a1fbd(0x1f4)](_0x3a1fbd(0x288))[_0x3a1fbd(0x310)]()[_0x3a1fbd(0x236)](),_0x232940[_0x3a1fbd(0x2a7)](_0x1ecedc=>{const _0x2643f7=_0x3a1fbd;delete _0x1ecedc[_0x2643f7(0x1c7)];}),dbConfig[_0x3a1fbd(0x1f4)](_0x3a1fbd(0x288))[_0x3a1fbd(0x2f0)](..._0x232940)[_0x3a1fbd(0x236)](),config=_0x232940;}function resetPassword(){const _0x416e34=_0x1a8ea8;tgBot&&settings[_0x416e34(0x244)]&&(tgBot['removeListener']('callback_query'),tgBot['sendMessage'](settings['telegramChatId'],_0x416e34(0x21c),{'parse_mode':_0x416e34(0x2ff),'reply_markup':{'inline_keyboard':[[{'text':_0x416e34(0x1bf),'callback_data':_0x416e34(0x1bf)},{'text':'no','callback_data':'no'}]]}})[_0x416e34(0x31a)](_0x3a600b=>{telegramError(_0x3a600b);}),tgBot['on'](_0x416e34(0x294),async _0xc7a775=>{const _0x27f685=_0x416e34,_0xa96abb=_0xc7a775[_0x27f685(0x269)],_0x52aff0=_0xc7a775[_0x27f685(0x322)];tgBot['answerCallbackQuery'](_0xc7a775['id'])[_0x27f685(0x1bc)](async()=>{const _0x20c938=_0x27f685;if(_0xa96abb!='no'){const _0x19dc22=0xf,_0x4b148e='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x23a37e=Array[_0x20c938(0x297)](crypto[_0x20c938(0x27a)](new Uint32Array(_0x19dc22)))[_0x20c938(0x2cf)](_0x5e0791=>_0x4b148e[_0x5e0791%_0x4b148e[_0x20c938(0x1ba)]])[_0x20c938(0x260)](''),_0x21b75a=bcrypt[_0x20c938(0x205)](_0x23a37e,saltRounds);storeSettings({'bbPassword':_0x21b75a}),await tgBot[_0x20c938(0x2b9)](_0x52aff0[_0x20c938(0x2ba)]['id'],_0x20c938(0x220)+_0x23a37e,{'parse_mode':_0x20c938(0x2ff)})[_0x20c938(0x31a)](_0x59e3fa=>{telegramError(_0x59e3fa);});}else await tgBot[_0x20c938(0x2b9)](_0x52aff0[_0x20c938(0x2ba)]['id'],_0x20c938(0x344))[_0x20c938(0x31a)](_0x1ce3b0=>{telegramError(_0x1ce3b0);});}),tgBot[_0x27f685(0x2e5)]('callback_query');}));}async function confirmRestore(_0x307ae2,_0x5e0d19){const _0x14af6a=_0x1a8ea8;tgBot&&settings[_0x14af6a(0x244)]&&(tgBot['removeListener'](_0x14af6a(0x294)),await tgBot[_0x14af6a(0x2b9)](settings[_0x14af6a(0x244)],_0x14af6a(0x1f5),{'parse_mode':_0x14af6a(0x2ff),'reply_markup':{'inline_keyboard':[[{'text':_0x14af6a(0x1bf),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x14af6a(0x31a)](_0x5d2fc2=>{telegramError(_0x5d2fc2);}),tgBot['on'](_0x14af6a(0x294),async _0x426d26=>{const _0x1c4389=_0x14af6a,_0x1a0178=_0x426d26['data'],_0x3b30c=_0x426d26[_0x1c4389(0x322)];tgBot[_0x1c4389(0x28b)](_0x426d26['id'])['then'](async()=>{const _0x371b10=_0x1c4389;_0x1a0178==_0x371b10(0x1bf)?(await tgBot[_0x371b10(0x2b9)](_0x3b30c['chat']['id'],_0x371b10(0x302),{'parse_mode':_0x371b10(0x2ff)})[_0x371b10(0x31a)](_0x3c4799=>{telegramError(_0x3c4799);}),unzipFile(_0x307ae2,_0x5e0d19)):await tgBot['sendMessage'](_0x3b30c[_0x371b10(0x2ba)]['id'],_0x371b10(0x2d8))['catch'](_0x59d313=>{telegramError(_0x59d313);});}),tgBot['removeListener']('callback_query');}));}function getServerTime(){const _0x410407=_0x1a8ea8,_0x81f07d=new Date();return _0x81f07d[_0x410407(0x271)]()+'/'+(_0x81f07d['getMonth']()+0x1)[_0x410407(0x2a5)]()[_0x410407(0x201)](0x2,'0')+'/'+_0x81f07d['getDate']()[_0x410407(0x2a5)]()[_0x410407(0x201)](0x2,'0')+'\x20'+_0x81f07d[_0x410407(0x254)]()[_0x410407(0x2a5)]()['padStart'](0x2,'0')+':'+_0x81f07d[_0x410407(0x2b2)]()[_0x410407(0x2a5)]()[_0x410407(0x201)](0x2,'0')+':'+_0x81f07d[_0x410407(0x213)]()[_0x410407(0x2a5)]()[_0x410407(0x201)](0x2,'0');}function getTimeStamp(){const _0x3b0ca3=_0x1a8ea8,_0x28db02=shiftedTime();return _0x28db02[_0x3b0ca3(0x271)]()+'/'+(_0x28db02['getMonth']()+0x1)[_0x3b0ca3(0x2a5)]()[_0x3b0ca3(0x201)](0x2,'0')+'/'+_0x28db02['getDate']()[_0x3b0ca3(0x2a5)]()[_0x3b0ca3(0x201)](0x2,'0')+'\x20'+_0x28db02['getHours']()[_0x3b0ca3(0x2a5)]()[_0x3b0ca3(0x201)](0x2,'0')+':'+_0x28db02[_0x3b0ca3(0x2b2)]()[_0x3b0ca3(0x2a5)]()[_0x3b0ca3(0x201)](0x2,'0')+':'+_0x28db02['getSeconds']()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0x23b845=_0x1a8ea8,_0x4e8856=new Date();let _0x156358=_0x4e8856;if(settings[_0x23b845(0x308)]&&settings[_0x23b845(0x308)]!==0x0)_0x156358=fns[_0x23b845(0x2a2)](_0x4e8856,{'hours':settings[_0x23b845(0x308)]});return _0x156358;}function startScheduler(){const _0xca3ba9=_0x1a8ea8,_0x158b73=new Date()[_0xca3ba9(0x327)](),_0x123ea6=shiftedTime()[_0xca3ba9(0x254)]();_0x123ea6==0x4&&backupConfigFiles();_0x123ea6==0x0&&rotateLogFiles();_0x158b73%0x6==0x0&&triggerAnalytics();_0x158b73%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function backupConfigFiles(){const _0x1b7930=_0x1a8ea8;fs[_0x1b7930(0x1c1)](configpath,{'withFileTypes':!![]})['forEach'](_0xdf0e58=>{const _0x675ee5=_0x1b7930;if(!_0xdf0e58['isDirectory']())fs[_0x675ee5(0x2e6)](configpath+_0xdf0e58[_0x675ee5(0x1df)],configbackuppath+_0xdf0e58['name']);});}function rotateLogFiles(){const _0x572186=_0x1a8ea8,_0x992895=fs[_0x572186(0x267)](logspath+_0x572186(0x2be)),_0x11023e=_0x992895['size']/0x400;if(_0x11023e>0x32){let _0x29c0b9=fs[_0x572186(0x1c1)](logspath,{'withFileTypes':!![]});_0x29c0b9['sort']((_0x22e286,_0x1eff5d)=>_0x22e286[_0x572186(0x1df)]<_0x1eff5d[_0x572186(0x1df)]?0x1:_0x1eff5d['name']<_0x22e286[_0x572186(0x1df)]?-0x1:0x0),_0x29c0b9[_0x572186(0x2a7)](_0x525c4a=>{const _0x4ab446=_0x572186;if(_0x525c4a[_0x4ab446(0x1df)]==_0x4ab446(0x280))fs[_0x4ab446(0x2e6)](logspath+_0x525c4a[_0x4ab446(0x1df)],logspath+_0x4ab446(0x28c));if(_0x525c4a[_0x4ab446(0x1df)]==_0x4ab446(0x30c))fs[_0x4ab446(0x2e6)](logspath+_0x525c4a['name'],logspath+_0x4ab446(0x280));_0x525c4a[_0x4ab446(0x1df)]==_0x4ab446(0x2be)&&(fs['copyFileSync'](logspath+_0x525c4a[_0x4ab446(0x1df)],logspath+_0x4ab446(0x30c)),fs[_0x4ab446(0x222)](logspath+_0x525c4a['name'],''));});}}async function zipFiles(_0x2d9460){const _0x4bd877=_0x1a8ea8;let _0x5203a1;if(_0x2d9460=='logs')_0x5203a1=logspath;if(_0x2d9460==_0x4bd877(0x1f3))_0x5203a1=configpath;let _0x2eb23c=fs[_0x4bd877(0x1c1)](_0x5203a1,{'withFileTypes':!![]});const _0x4f01cc=new require(_0x4bd877(0x229))();_0x2eb23c[_0x4bd877(0x2a7)](_0x55d766=>{const _0x23ade3=_0x4bd877;if(!_0x55d766['isDirectory']()){let _0xd0272f=fs[_0x23ade3(0x1e7)](_0x5203a1+_0x55d766[_0x23ade3(0x1df)]);const _0x509e28=/^bot-[0-9]{3}-config.json$/,_0x168953=_0x509e28[_0x23ade3(0x1eb)](_0x55d766[_0x23ade3(0x1df)]);if(_0x168953){const _0x211975=JSON[_0x23ade3(0x25e)](_0xd0272f);_0x211975[_0x23ade3(0x1c9)][0x0]['apiKey']=_0x23ade3(0x21f),_0x211975[_0x23ade3(0x1c9)][0x0]['apiSecret']=_0x23ade3(0x21f),_0xd0272f=JSON['stringify'](_0x211975,null,0x2);}if(_0x55d766[_0x23ade3(0x1df)]=='bb-settings.json'){const _0x1dca5e=JSON[_0x23ade3(0x25e)](_0xd0272f);if(_0x1dca5e[_0x23ade3(0x2b3)][_0x23ade3(0x2b5)])_0x1dca5e[_0x23ade3(0x2b3)][_0x23ade3(0x2b5)]=![];if(_0x1dca5e[_0x23ade3(0x2b3)][_0x23ade3(0x281)])_0x1dca5e[_0x23ade3(0x2b3)][_0x23ade3(0x281)]=_0x23ade3(0x21f);if(_0x1dca5e[_0x23ade3(0x2b3)][_0x23ade3(0x2e3)])_0x1dca5e[_0x23ade3(0x2b3)][_0x23ade3(0x2e3)]=_0x23ade3(0x21f);if(_0x1dca5e['settings'][_0x23ade3(0x244)])_0x1dca5e[_0x23ade3(0x2b3)][_0x23ade3(0x244)]=null;_0xd0272f=JSON['stringify'](_0x1dca5e,null,0x2);}if(_0x55d766[_0x23ade3(0x1df)]!='bb-secure.json')_0x4f01cc[_0x23ade3(0x224)](_0x55d766[_0x23ade3(0x1df)],_0xd0272f);}});const _0x7750fe=_0x4f01cc[_0x4bd877(0x1b9)]({'base64':![],'compression':_0x4bd877(0x207)});fs[_0x4bd877(0x222)](zippath+(_0x2d9460+_0x4bd877(0x2d9)),_0x7750fe,_0x4bd877(0x28d));}async function unzipFile(_0x5c6090,_0x226621){const _0x17908a=_0x1a8ea8;await backupConfigFiles(),fs[_0x17908a(0x1c1)](configpath,{'withFileTypes':!![]})[_0x17908a(0x2a7)](_0xd8bdf8=>{const _0x51b36b=_0x17908a;if(!_0xd8bdf8[_0x51b36b(0x200)]())fs[_0x51b36b(0x25a)](configpath+_0xd8bdf8['name']);});const _0xd997f2=fs[_0x17908a(0x1e7)](_0x5c6090+_0x226621,_0x17908a(0x28d)),_0x30b2e0=new require(_0x17908a(0x229))(_0xd997f2,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x30b2e0[_0x17908a(0x212)])[_0x17908a(0x2a7)](_0x1384c9=>{const _0xd3c2dd=_0x17908a,_0x2dd615=_0x30b2e0['files'][_0x1384c9];fs['writeFileSync'](configpath+_0x2dd615['name'],_0x2dd615[_0xd3c2dd(0x309)]);}),fs[_0x17908a(0x1c1)](temppath,{'withFileTypes':!![]})[_0x17908a(0x2a7)](_0x3b3f70=>{const _0x2da101=_0x17908a;if(!_0x3b3f70[_0x2da101(0x200)]())fs[_0x2da101(0x25a)](temppath+_0x3b3f70[_0x2da101(0x1df)]);}),process[_0x17908a(0x1d5)]({'restore':!![]},_0x322f2c=>{});}async function getPublicIp(){const _0x3a7af1=_0x1a8ea8;try{const _0x530bae=await axios[_0x3a7af1(0x1f4)](_0x3a7af1(0x257));publicip=_0x530bae[_0x3a7af1(0x269)]['ip'];}catch(_0x1722f2){}}async function triggerAnalytics(){const _0x415287=_0x1a8ea8;if(!publicip)await getPublicIp();const _0x4afa0d=getBotsWithMode();let _0x58958b=0x0;_0x4afa0d[_0x415287(0x2a7)](_0x42a90b=>{const _0x194050=_0x415287;if(_0x42a90b['status']===_0x194050(0x301))_0x58958b++;});const _0x49b05b=getBotExchanges();mixpanel[_0x415287(0x28a)](_0x415287(0x336),{'distinct_id':settings[_0x415287(0x27b)],'ip':publicip,'version':serverversion,'numbots':_0x4afa0d[_0x415287(0x1ba)],'numbotsenabled':_0x58958b,'exchanges':_0x49b05b});}function _0x47e7(){const _0x1101fe=['output-002.log','bbPassword','decrypt','keys','error','Unauthorized\x20attempt\x20to\x20update\x20settings','/enable\x20-\x20enable\x20notifications\x0a','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','bots','f2aRequired','track','answerCallbackQuery','output-003.log','binary','number',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','order','\x20minutes','Unauthorized\x20attempt\x20to\x20delete\x20alerts','showname','callback_query','getStartingBalances','http','from','telegram2FaApproval','-events.json','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','botname','Bot\x20Mgr\x20>\x20','All\x20bots','logout','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','defaults','/:bot','add','login\x20required','30\x20min','toString','lastmsgemitted','forEach','constructor','reload','placeOrder','jsonwebtoken','settings.','any','6253680VvgUAI','index.html','-results.json','exp','getMinutes','settings','access','loginRequired','restarting\x20Bot\x20','Invalid\x20authentication\x20token\x20(1)','privateKey','sendMessage','chat','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Crypt','secret','output-000.log','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','-config.json','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','createWriteStream','publicKey','removeAllListeners','host','All','whitelist','messages','download','Unauthorized\x20attempt\x20to\x20delete\x20bot','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','allow','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','confirm-message','map','2FA','min','util','Yes','Unauthorized\x20attempt\x20to\x20download\x20','inherit','Login\x20rejected','RSA','Restore\x20process\x20aborted','.zip','port','hybrid-crypto-js','listen','toIPv4Address','User\x20has\x20been\x20validated','node-telegram-bot-api','express-fileupload','env','event','telegramToken','build2','removeListener','copyFileSync','set','request','/:bot/configuration','remoteAddress','starting\x20bot\x20|\x20Bot\x20','restart','*$1*','2FA\x20required','emit','push','config/','date-fns','get-logs','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','login','Orders','login\x20not\x20required','telegramEnabled','telegramUsername','split','static','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','16KFEdTT','error\x20while\x20deleting\x20config\x20files:\x20','HTML','Alerts','enabled','Restoring\x20bot(s)\x20from\x20backup','getTime','Unauthorized\x20attempt\x20to\x20log\x20out','temporary\x20token\x20generated','verify','args','timeshift','_data','blacklist','includes','output-001.log','createServer','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Unauthorized\x20login\x20attempt\x20(timeout)','remove','560737LcfTPJ','Unauthorized\x20attempt\x20to\x20get\x20portfolio','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','NTBA_FIX_319','replace','get-portfolio','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','post','exchange','catch','</b>\x20?','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Unauthorized\x20attempt\x20to\x20show\x20configuration','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','exec','Invalid\x20authentication\x20token\x20(2)','2FA\x20login\x20required','message','/:bot/support','encryptedUuid','telegrammsg','log','getUTCHours','child_process','(((.+)+)+)+$','5339448QlZzjK','reason','user','************','live','accept','/off\x20-\x20stop\x20bot(s)\x0a','notification','Notifications\x20types:\x20','invalid\x20credentials','Unauthorized\x20attempt\x20to\x20add\x20bot','full','Server','stop','conn','You\x20can\x20use\x20the\x20following\x20commands:\x0a','temp/','timestamp','add-bot','exit','Failed\x20to\x20download\x20','login\x20token\x20generated','stopped','login\x20token\x20valid','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','127.0.0.1','Password\x20reset\x20rejected','bb-secure.json','disconnect','isValid','success','get-starting-balances','store-configuration',',\x20must\x20be\x20a\x204\x20digit\x20number','12ALcXoo','simple','onText','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','\x20to\x20','storeConfiguration','Allow\x20login\x20from\x20IP\x20address\x20<b>','2FA\x20login\x20rejected','match','telegramIpApproval','generate','length','/restart\x20-\x20restart\x20bot(s)\x0a','then','connected','cloneDeep','yes','uuid','readdirSync','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','uncaughtException','\x20>\x20','botID','version','mode','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','bot','/:bot/portfolio','use','Notifications\x20enabled\x0a','kill','search','bot-','hasOwnProperty','File\x20uploaded','mixpanel','1843322IOvSsW','telegramEvents','send','initclient','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','sortBy','max','delete-bot','SIGTERM','No\x20bots\x20running\x20right\x20now','new-disabled','/on\x20-\x20start\x20bot(s)\x0a','name','\x20|\x20','password','6b67f3d61ee94b8f5c80b4affef4c4d9','alerts','status','145565xwWPpM','/help\x20-\x20show\x20available\x20commands\x0a','readFileSync','::1','<b>Telegram\x20Bot\x20Status:</b>\x0a','Unauthorized\x20attempt\x20to\x20get\x20messages','test','bbvNew','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','warning','Unauthorized\x20attempt\x20to\x20confirm\x20message','cancel-loading','botmanager','build','backup','get','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','headless','::ffff:127.0.0.1','all','\x20(1)','value','Notifications\x20enabled','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','stopPolling','new','reject','isDirectory','padStart','apply','\x20mode','-performance.json','hashSync','bot.js','DEFLATE','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','sendFile','assign','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Markdown','socket.io','Bot\x20','sha256','update-bb','headers','files','getSeconds','ipv6','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','generateKeyPairAsync','existsSync','backup/','8PJqdov','2FA\x20login\x20token\x20generated','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','$1_$2_$3','tkn','***','Password\x20has\x20been\x20reset\x20to:\x20','yargs/yargs','writeFileSync','pidRefreshToken','file','Unauthorized\x20attempt\x20to\x20store\x20configuration','polling_error','SIGINT','Ok,\x20will\x20send\x20order\x20notifications\x20only','node-zip','function','emitHistory','bb/','filter','3000','manual','zip/','/update\x20-\x20update\x20Balance\x20Bot\x0a','apiKey','orders','-----------------------------------------------------------------------------------','get-messages','write','whitelistEnabled','once','/download/:type','auth','starting\x20new\x20bot\x20|\x20Bot\x20','socket','lowdb/adapters/FileSync','startsWith','sockets','Ok,\x20will\x20send\x20alert\x20notifications\x20only','access\x20timeout','showConfig','pidExpireLogin','telegramChatId','find','username','ipaddr.js','Temporary\x20access\x20rejected','Invalid\x20Telegram\x20token','store','token','No\x20authentication\x20token','2423323BlmKZq','api-eu.mixpanel.com','show','toggle-bot-mode','reset-password','Invalid\x20IP\x20address','type','getHours','Unauthorized\x20attempt\x20to\x20update\x20bot','handshake','https://api.ipify.org?format=json','auto','expiry','rmSync','mkdirSync','sign','telegram','parse','/status\x20-\x20show\x20bot(s)\x20status\x0a','join','alias','place-order','uuid-random','<b>Balance\x20Bot\x20Status:</b>\x0a','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','2112882VovNwn','statSync','/:bot/history','data','lastmsgtelegram','started','unlinkSync','latestversion','bbvReceive','temporaryAccessAllowed','update-bot','getFullYear','storeHeadless','disabled','getPortfolio','\x20only\x0a','clientip','0.0.0','disabled\x20Bot\x20','sendPortfolioTelegram','randomFillSync','userid','temporary\x20access\x20not\x20allowed','secure','idling\x20bot\x20\x20\x20|\x20Bot\x20','compareSync'];_0x47e7=function(){return _0x1101fe;};return _0x47e7();}async function getMessages(){const _0x534c45=_0x1a8ea8,_0x1acd54=_0x534c45(0x1d7),_0xdf7587=new GraphQLClient(_0x1acd54),_0x1183f3={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x1f6092=serverversion[_0x534c45(0x2fa)]('.'),_0x1281cb=_0x1f6092[0x0]+'.'+_0x1f6092[0x1],_0x3dffec=Math[_0x534c45(0x2d1)](settings[_0x534c45(0x26a)],settings['lastmsgemitted']),_0x5cea77={'last':parseInt(_0x3dffec),'bbm':_0x1281cb},_0xa0912a=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x22a4d5;try{_0x22a4d5=await _0xdf7587[_0x534c45(0x2e8)](_0xa0912a,_0x5cea77,_0x1183f3);}catch(_0x1466d5){}if(_0x22a4d5&&_0x22a4d5[_0x534c45(0x2c8)]){let _0x3d6e68=settings[_0x534c45(0x26a)];newMessages=[];for(const _0x2d2917 of _0x22a4d5['messages']){newMessages[_0x534c45(0x2f0)](_0x2d2917);if(_0x2d2917[_0x534c45(0x1ec)])updateSetting('latestversion',_0x2d2917[_0x534c45(0x1ec)]);let _0x29683c=_0x2d2917[_0x534c45(0x1ec)]?serverversion>=_0x2d2917[_0x534c45(0x1ec)]:![];if(!_0x29683c&&_0x2d2917[_0x534c45(0x28e)]>_0x3d6e68){if(_0x2d2917['bbvReceive']===_0x534c45(0x2ad)||serverversion[_0x534c45(0x23e)](_0x2d2917[_0x534c45(0x26e)])){let _0x1acf0b=''+_0x2d2917['title']+'\x0a\x0a'+_0x2d2917[_0x534c45(0x322)];const _0x53bd15=await sendTelegramMsg(toTelegramMarkdown(_0x1acf0b),_0x534c45(0x20c));if(_0x53bd15)_0x3d6e68=_0x2d2917[_0x534c45(0x28e)];}}}updateAvailable=isNewerVersion(settings[_0x534c45(0x26d)],serverversion),updateSetting(_0x534c45(0x26a),_0x3d6e68),emitMessages();}}function emitMessages(){const _0x32c606=_0x1a8ea8,_0x17c0b9=settings['lastmsgemitted'];let _0x38fa4d=[];newMessages[_0x32c606(0x2a7)](_0x329121=>{const _0x20c6c6=_0x32c606;_0x329121[_0x20c6c6(0x28e)]>_0x17c0b9&&_0x38fa4d[_0x20c6c6(0x2f0)](_0x329121);}),_0x38fa4d['length']>0x0&&getAllClients()[_0x32c606(0x2a7)](_0xf69ed1=>{const _0x3a25c3=_0x32c606;getSocket(_0xf69ed1['id'])[_0x3a25c3(0x2ef)](_0x3a25c3(0x322),_0x38fa4d);});}function confirmMessage(_0x22c526){const _0xb35ed4=_0x1a8ea8;updateSetting(_0xb35ed4(0x2a6),Number(_0x22c526));}function isNewerVersion(_0x44a563,_0x3a0c39){const _0x489e62=_0x1a8ea8,_0x333198=_0x3a0c39[_0x489e62(0x2fa)]('.'),_0x19f4fd=_0x44a563[_0x489e62(0x2fa)]('.');for(var _0x4d818d=0x0;_0x4d818d<_0x19f4fd['length'];_0x4d818d++){const _0x38b990=~~_0x19f4fd[_0x4d818d],_0x54ba5b=~~_0x333198[_0x4d818d];if(_0x38b990>_0x54ba5b)return!![];if(_0x38b990<_0x54ba5b)return![];}return![];}function toTelegramMarkdown(_0x1b64be){const _0x5399d1=_0x1a8ea8,_0x672cf4=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3f537a=/\*{2}(.+?)\*{2}/gim;return _0x1b64be=_0x1b64be[_0x5399d1(0x315)](_0x672cf4,_0x5399d1(0x21d))['replace'](_0x3f537a,_0x5399d1(0x2ed)),_0x1b64be;}async function validateConfigFile(){const _0x14d28a=_0x1a8ea8,_0x34960d=dbConfig['get'](_0x14d28a(0x288))['sortBy'](_0x14d28a(0x1c5))[_0x14d28a(0x1fa)]()||[];if(_0x34960d['length']==0x0){let _0x4b7252=0x0,_0x42b754=[];const _0x297620=/^bot-([0-9]{3})-config.json$/,_0x281e3e=fs['readdirSync'](configpath);_0x281e3e[_0x14d28a(0x2a7)](_0x15dcfa=>{const _0x239976=_0x14d28a,_0x172567=_0x297620[_0x239976(0x31f)](_0x15dcfa);if(_0x172567){const _0x221384=_0x172567[0x1];let _0x598a66=getBotAttributes(_0x221384);_0x42b754[_0x239976(0x2f0)]({'botID':_0x221384,'botname':_0x598a66['botname'],'status':_0x239976(0x273),'live':_0x239976(0x340)}),_0x4b7252++;}}),_0x4b7252!=0x0&&(dbConfig['get'](_0x14d28a(0x288))['assign'](_0x42b754)[_0x14d28a(0x236)](),config=_0x42b754,restoredConfigFile=_0x4b7252);}}async function restoreConfigNotify(_0x52f8de){const _0x3af7b6=_0x1a8ea8;let _0x182a15;if(restoredConfigFile==0x1)_0x182a15=_0x3af7b6(0x31e);else _0x182a15=_0x3af7b6(0x1ed);if(_0x52f8de)io['to']('botmanager')[_0x3af7b6(0x2ef)](_0x3af7b6(0x331),_0x182a15);else{logger[_0x3af7b6(0x34d)](_0x3af7b6(0x234)),logger['simple'](_0x182a15),logger['simple'](_0x3af7b6(0x234)),logger[_0x3af7b6(0x34d)]('');if(tgBot&&settings[_0x3af7b6(0x244)]&&settings[_0x3af7b6(0x1d4)]!=_0x3af7b6(0x233))tgBot[_0x3af7b6(0x2b9)](settings[_0x3af7b6(0x244)],_0x3af7b6(0x29c)+_0x182a15)['catch'](_0x1d25f2=>{telegramError(_0x1d25f2);});}}function validateCredentials(_0x2a8b25,_0x568ee9){const _0x34007e=_0x1a8ea8;if(_0x2a8b25[_0x34007e(0x246)]==settings['bbUsername']&&bcrypt[_0x34007e(0x27f)](_0x2a8b25['password'],settings[_0x34007e(0x281)])){if(settings[_0x34007e(0x289)])return{'allow':![],'reason':_0x34007e(0x321),'token':null};else{const _0x3b8748=generateLoginToken(_0x568ee9);return{'allow':!![],'reason':_0x34007e(0x33f),'token':_0x3b8748};}}else return{'allow':![],'reason':_0x34007e(0x333),'token':null};}function refreshToken(_0x5f4ae7){const _0x5ce49b=generateLoginToken(_0x5f4ae7);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x5ce49b};}function validateAccess(_0x35e143,_0x535a7b,_0x4e9c89){const _0x1ab2f5=_0x1a8ea8,_0x50b795=_0x4e9c89?_0x4e9c89:devices[_0x535a7b]['ip'];let _0x1e7e5a;const _0x3ad3a8=_0x1e117a=>{const _0x5e664d=_0x4eba;if(settings[_0x5e664d(0x2b5)]){if(settings[_0x5e664d(0x289)]){if(telegram2FaApproved(_0x535a7b)){const _0x254149=generateLoginToken(_0x535a7b);return{'allow':!![],'reason':_0x5e664d(0x21a),'token':_0x254149};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x1e7e5a=validToken(_0x1e117a,_0x535a7b),_0x1e7e5a['hasOwnProperty'](_0x5e664d(0x348))?{'allow':!![],'reason':_0x5e664d(0x341),'token':_0x1e117a}:{'allow':![],'reason':_0x5e664d(0x2a3),'token':null};}else return{'allow':!![],'reason':_0x5e664d(0x2f7),'token':null};};if(settings[_0x1ab2f5(0x237)]){let _0x841617=[...settings[_0x1ab2f5(0x2c7)],_0x1ab2f5(0x1e8),_0x1ab2f5(0x1f7),_0x1ab2f5(0x343)];if(_0x841617[_0x1ab2f5(0x30b)](_0x50b795))return _0x3ad3a8(_0x35e143);else{_0x1e7e5a=validToken(_0x35e143,_0x535a7b);if(_0x1e7e5a[_0x1ab2f5(0x1d0)](_0x1ab2f5(0x348)))return _0x3ad3a8(_0x35e143);else{if(telegramIpApproved(_0x535a7b)){const _0xff6898=generateToken(_0x535a7b);return _0x1e7e5a=_0x3ad3a8(_0x35e143),_0x1e7e5a['allow']?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0xff6898}:_0x1e7e5a;}else return settings[_0x1ab2f5(0x26f)]?{'allow':![],'reason':_0x1ab2f5(0x2ee),'token':null}:{'allow':![],'reason':_0x1ab2f5(0x27c),'token':null};}}}else return _0x3ad3a8(_0x35e143);}function timelyDecrypt(_0x149cce,_0x375fb2=!![]){const _0x55b76a=_0x1a8ea8;if(_0x149cce)try{const _0x2f7028=crypt[_0x55b76a(0x282)](secure[_0x55b76a(0x2b8)],_0x149cce)[_0x55b76a(0x322)],_0x262210=_0x2f7028[_0x55b76a(0x2fa)]('@')[0x0],_0x4c5860=_0x2f7028[_0x55b76a(0x2fa)]('@')[0x1],_0x3a8224=new Date()[_0x55b76a(0x303)]();if(_0x375fb2){if(_0x3a8224-_0x4c5860<maxSecretAge*0x3e8)return _0x262210;else return![];}else return _0x262210;}catch(_0x502ea9){return![];}else return![];}const validToken=(_0x48298e,_0x6a9fc0)=>{const _0x41401e=_0x1a8ea8,_0x180526=devices[_0x6a9fc0]['ip'];if(!_0x48298e)return{'error':_0x41401e(0x24c)};for(let _0x138c2e of blacklist){if(_0x138c2e[_0x41401e(0x24b)]==_0x48298e)return{'error':'Token\x20blacklisted'};}let _0x19db8b;try{_0x19db8b=jwt[_0x41401e(0x306)](_0x48298e,secure[_0x41401e(0x2bd)]+_0x6a9fc0);}catch{return{'error':_0x41401e(0x2b7)};}if(!_0x19db8b[_0x41401e(0x1d0)](_0x41401e(0x276))&&!_0x19db8b['hasOwnProperty'](_0x41401e(0x246))||!_0x19db8b[_0x41401e(0x1d0)](_0x41401e(0x2b1)))return{'error':_0x41401e(0x320)};if(!_0x19db8b['hasOwnProperty'](_0x41401e(0x246))&&_0x19db8b[_0x41401e(0x1d0)](_0x41401e(0x276))){const {clientip:_0x3f1030}=_0x19db8b;return _0x180526==_0x3f1030?{'success':_0x41401e(0x2de)}:{'error':_0x41401e(0x252)};}else{if(_0x19db8b[_0x41401e(0x1d0)](_0x41401e(0x246))&&_0x19db8b[_0x41401e(0x1d0)](_0x41401e(0x276))){const {username:_0x388f5a,clientip:_0x1b320e}=_0x19db8b;return settings['bbUsername']==_0x388f5a&&_0x180526==_0x1b320e?{'success':_0x41401e(0x2de)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x323c46=>{const _0x4e0610=_0x1a8ea8;if(_0x323c46){const _0x5635a1=devices[_0x323c46]['ip'];return jwt[_0x4e0610(0x25c)]({'username':settings['bbUsername'],'clientip':_0x5635a1},secure[_0x4e0610(0x2bd)]+_0x323c46,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x503fe5=>{const _0x4d1607=_0x1a8ea8;if(_0x503fe5){const _0x13418f=devices[_0x503fe5]['ip'];return jwt[_0x4d1607(0x25c)]({'clientip':_0x13418f},secure[_0x4d1607(0x2bd)]+_0x503fe5,{'expiresIn':devices[_0x503fe5][_0x4d1607(0x1b8)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x5315bb=>{const _0x4c6057=_0x1a8ea8;let _0x2d9381=![];return devices[_0x5315bb][_0x4c6057(0x1b8)]&&devices[_0x5315bb][_0x4c6057(0x1b8)][_0x4c6057(0x259)]!='reject'&&(_0x2d9381=devices[_0x5315bb]['telegramIpApproval'][_0x4c6057(0x276)]==devices[_0x5315bb]['ip']&&new Date()[_0x4c6057(0x303)]()-devices[_0x5315bb][_0x4c6057(0x1b8)][_0x4c6057(0x33b)]<devices[_0x5315bb][_0x4c6057(0x1b8)][_0x4c6057(0x259)]*0x3c*0x3e8),_0x2d9381;},telegram2FaApproved=_0x322c03=>{const _0x35e60e=_0x1a8ea8;let _0x1b97a2=![];return devices[_0x322c03][_0x35e60e(0x298)]&&devices[_0x322c03]['telegram2FaApproval'][_0x35e60e(0x259)]!=_0x35e60e(0x1ff)&&(_0x1b97a2=devices[_0x322c03][_0x35e60e(0x298)][_0x35e60e(0x276)]==devices[_0x322c03]['ip']&&new Date()[_0x35e60e(0x303)]()-devices[_0x322c03]['telegram2FaApproval'][_0x35e60e(0x33b)]<devices[_0x322c03][_0x35e60e(0x298)][_0x35e60e(0x259)]*0x3c*0x3e8),_0x1b97a2;},normalizeIP=_0x1fd0b8=>{const _0x5ed3c8=_0x1a8ea8;let _0x4d5795=null,_0x4526e8=null;if(ipaddr[_0x5ed3c8(0x347)](_0x1fd0b8)){const _0x580c77=ipaddr[_0x5ed3c8(0x25e)](_0x1fd0b8);_0x580c77['kind']()===_0x5ed3c8(0x214)?(_0x580c77['isIPv4MappedAddress']()&&(_0x4d5795=_0x580c77[_0x5ed3c8(0x2dd)]()[_0x5ed3c8(0x2a5)]()),_0x4526e8=_0x580c77[_0x5ed3c8(0x2a5)]()):(_0x4d5795=_0x580c77[_0x5ed3c8(0x2a5)](),_0x4526e8=_0x580c77['toIPv4MappedAddress']()[_0x5ed3c8(0x2a5)]());}return{'show':_0x4d5795?_0x4d5795:_0x4526e8,'store':_0x4526e8};};function sleep(_0x4af164){return new Promise(_0x39ea54=>setTimeout(_0x39ea54,_0x4af164));}