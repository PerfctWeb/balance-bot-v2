const _0x286fd3=_0x2175;(function(_0x61a84e,_0x22ccd0){const _0x3be9c1=_0x2175,_0x24b51a=_0x61a84e();while(!![]){try{const _0x30755e=parseInt(_0x3be9c1(0x135))/0x1*(-parseInt(_0x3be9c1(0x168))/0x2)+parseInt(_0x3be9c1(0x259))/0x3*(parseInt(_0x3be9c1(0x21f))/0x4)+parseInt(_0x3be9c1(0x1ae))/0x5*(parseInt(_0x3be9c1(0x23b))/0x6)+parseInt(_0x3be9c1(0x20b))/0x7*(-parseInt(_0x3be9c1(0x184))/0x8)+parseInt(_0x3be9c1(0x19e))/0x9+parseInt(_0x3be9c1(0x1e4))/0xa*(parseInt(_0x3be9c1(0x1dc))/0xb)+-parseInt(_0x3be9c1(0x13a))/0xc*(parseInt(_0x3be9c1(0x251))/0xd);if(_0x30755e===_0x22ccd0)break;else _0x24b51a['push'](_0x24b51a['shift']());}catch(_0xd5d3c){_0x24b51a['push'](_0x24b51a['shift']());}}}(_0x58f1,0x88add));const _0x234537=function(){let _0x410782=!![];return function(_0x1a912d,_0x42c11){const _0x524703=_0x410782?function(){const _0x44f6f8=_0x2175;if(_0x42c11){const _0x39c8dd=_0x42c11[_0x44f6f8(0x266)](_0x1a912d,arguments);return _0x42c11=null,_0x39c8dd;}}:function(){};return _0x410782=![],_0x524703;};}(),_0x4b039e=_0x234537(this,function(){const _0x37a2b6=_0x2175;return _0x4b039e['toString']()['search']('(((.+)+)+)+$')[_0x37a2b6(0x25c)]()[_0x37a2b6(0x1d7)](_0x4b039e)[_0x37a2b6(0x17b)](_0x37a2b6(0x22f));});_0x4b039e();'use strict';process[_0x286fd3(0x22c)][_0x286fd3(0x143)]=0x1;const childProcess=require(_0x286fd3(0x26e)),FileSync=require(_0x286fd3(0x124)),fs=require('fs'),fns=require('date-fns'),low=require(_0x286fd3(0x12a)),path=require(_0x286fd3(0x252)),crypto=require(_0x286fd3(0x198)),Crypt=require(_0x286fd3(0x20f))[_0x286fd3(0x209)],RSA=require(_0x286fd3(0x20f))[_0x286fd3(0x1b3)],bcrypt=require(_0x286fd3(0x218)),jwt=require('jsonwebtoken'),analyticsLib=require(_0x286fd3(0x190))[_0x286fd3(0x1d9)],googleAnalytics=require(_0x286fd3(0x18e))['default'],ipaddr=require(_0x286fd3(0x269)),argv=require(_0x286fd3(0x1fd))(process[_0x286fd3(0x13d)][_0x286fd3(0x164)](0x2))[_0x286fd3(0x13d)],PORT=argv[_0x286fd3(0x1a7)]||_0x286fd3(0x25e),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x286fd3(0x23c)](PORT))return console[_0x286fd3(0x14d)](_0x286fd3(0x226)+PORT+_0x286fd3(0x176)),process[_0x286fd3(0x1ef)](0x1);const HOST=argv['host']||null,userID=argv['user']||'';let bbpath=_0x286fd3(0x19c),bbpath2='';const botfile='bot.js',configfile=_0x286fd3(0x219),settingsfile=_0x286fd3(0x256),securefile='bb-secure.json';!fs['existsSync'](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x286fd3(0x146)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x286fd3(0x18b),configbackuppath=configpath+_0x286fd3(0x23f);!fs[_0x286fd3(0x1c9)](configpath)&&fs[_0x286fd3(0x1b1)](configpath);!fs[_0x286fd3(0x1c9)](configbackuppath)&&fs[_0x286fd3(0x1b1)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x286fd3(0x19b)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x286fd3(0x20c)]({'settings':{'timeshift':0x0}})[_0x286fd3(0x19b)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x286fd3(0x20c)]({'secure':{},'blacklist':[]})[_0x286fd3(0x19b)]();let crypt=new Crypt({'md':_0x286fd3(0x180),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x286fd3(0x19a))[_0x286fd3(0x174)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];function _0x58f1(){const _0x2b8f42=['Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','bot','sortBy','botname','store','update-bb','placeOrder','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','privateKey','Login\x20rejected','Crypt','starting\x20bot\x20|\x20Bot\x20','707AvAxmL','defaults','Login\x20accepted','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','hybrid-crypto-js','answerCallbackQuery','\x20|\x20','Unauthorized\x20login\x20attempt\x20(timeout)','getTime','toIPv4Address','connected','-config.json','getStartingBalances','bcryptjs','bb-config.json','telegramToken','index.html','\x20>\x20','Unauthorized\x20attempt\x20to\x20get\x20portfolio','error\x20while\x20deleting\x20config\x20files:\x20','2504CPflkz','getMonth','then','update-bot','disconnect','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','2FA','Error:\x20Invalid\x20argument\x20','/enable\x20-\x20enable\x20notifications\x0a','telegramEnabled','enabled\x20Bot\x20','push','initclient','env','length','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','(((.+)+)+)+$','assign','2FA\x20login\x20required','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','All\x20bots\x20running\x20right\x20now','send','status','telegramIpApproval','set','verify','get','logged\x20out','87198AqklQe','test','from','running','backup/','createServer','getSeconds','polling_error','ipc','access','add','order','Ok,\x20will\x20send\x20order\x20notifications\x20only','Unauthorized\x20attempt\x20to\x20update\x20settings','new','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','randomBytes','store-settings','once','1000','kill','cancel-loading','221UQxUiT','path','No\x20authentication\x20token','************','disabled','bb-settings.json','Unauthorized\x20attempt\x20to\x20delete\x20bot','token','2343JcprwT','decrypt','padStart','toString','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','3000','Balance\x20Bot\x20Server','2FA\x20login\x20token\x20generated','timestamp','conn','telegramEvents','starting\x20new\x20bot\x20|\x20Bot\x20','success','apply','secure','auth','ipaddr.js','-events.json','build','botID','clientip','child_process','Token\x20blacklisted','lowdb/adapters/FileSync','catch','showname','reload','kind','<b>Balance\x20Bot\x20status:</b>\x0a','lowdb','live','map','login\x20token\x20generated','onText','max','temporary\x20token\x20generated','HTML','reset-password','telegram','callback_query','47yFgEfc','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','get-starting-balances','login\x20not\x20required','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','653160IfERmO','referer','restart','argv','Unauthorized\x20attempt\x20to\x20update\x20bot','hasOwnProperty','filter','getDate','allow','NTBA_FIX_319','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','includes','clients','parse','toIPv4MappedAddress','express','storeHeadless','alerts','/status\x20-\x20show\x20bot(s)\x20status\x0a','log','cancelLoading','invalid\x20credentials','login\x20token\x20valid','idling\x20bot\x20\x20\x20|\x20Bot\x20','Notifications\x20enabled',':\x20Bot\x20Mgr\x20>\x20','all','hashSync','login','build2','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','127.0.0.1','::1','pidRefreshToken','sign','stop','use','enabled','show','/help\x20-\x20show\x20available\x20commands\x0a','2FA\x20login\x20rejected','Unauthorized\x20attempt\x20to\x20add\x20bot','slice','https://hodlerhacks.com','expiry','sockets','31978qvYZsQ','stopPolling','isDirectory','f2aRequired','SIGTERM','new-disabled','sendFile','UA-192771731-1','page','remove','5\x20min','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','version','inherit',',\x20must\x20be\x20a\x204\x20digit\x20number','data','secret','timeshift','args','search','telegramChatId','logout','/:bot','/:bot/history','sha256','uuid','split','404\x20Not\x20Found','18048WngfFS','copyFileSync','value','Bot\x20Mgr\x20>\x20','pidExpireLogin','get-portfolio','loginRequired','config/','yes','isValid','@analytics/google-analytics','chat','analytics','password','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','bbUsername','Invalid\x20IP\x20address','publicKey','Invalid\x20username\x20or\x20IP\x20address','orders','crypto','reject','version.json','write','bb/','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','6719922XObTgs','/on\x20-\x20start\x20bot(s)\x0a','bbPassword','listen','Invalid\x20Telegram\x20token','store-headless','</b>\x20?','static','store-configuration','port','Notifications\x20enabled\x0a','getFullYear','All','\x20/\x20','generateKeyPairAsync','emit','290GwcRYe','15\x20min','find','mkdirSync','Password\x20has\x20been\x20reset\x20to:\x20','RSA','2FA\x20required','exp','username','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','/:bot/configuration','Notifications\x20types:\x20','ipv6','Notifications\x20disabled\x0a','keys','deleted\x20Bot\x20','telegram2FaApproval','readdirSync','Ok,\x20will\x20send\x20alert\x20notifications\x20only','emitHistory','error','-----------------------------------------------------------------------------------','isIPv4MappedAddress','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','getHours','User\x20has\x20been\x20validated','name','existsSync','remoteAddress','unlinkSync','message','sendMessage','Notifications\x20disabled','hex','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','temporary\x20access\x20not\x20allowed','event','Balance\x20Bot','type','whitelist','\x20minutes','constructor','temporaryAccessAllowed','default','login\x20required','Invalid\x20authentication\x20token\x20(2)','671KopYna','join','bot-','bots','Unauthorized\x20attempt\x20to\x20get\x20logs','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','stopped','getUTCHours','63280IHsUoq','getMinutes','/disable\x20-\x20disable\x20notifications\x0a','headers','removeListener','settings','reason','blacklist','whitelistEnabled','Bot\x20','notification','exit','storeConfiguration','forEach','Invalid\x20authentication\x20token\x20(1)','temporary\x20access\x20timeout','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Access\x20enabled\x20for\x20','botmanager','telegramUsername','/:bot/portfolio','All\x20bots','handshake','match','function','yargs/yargs','connection'];_0x58f1=function(){return _0x2b8f42;};return _0x58f1();}oneTimeMigration(),cleanBlacklist();const express=require(_0x286fd3(0x149)),app=express(),http=require('http')[_0x286fd3(0x240)](app);app[_0x286fd3(0x15e)](express[_0x286fd3(0x1a5)](path['join'](__dirname,bbpath2,_0x286fd3(0x157)))),app['use'](express[_0x286fd3(0x1a5)](path[_0x286fd3(0x1dd)](__dirname,bbpath2,_0x286fd3(0x26b)))),app[_0x286fd3(0x239)]('/',function(_0x553434,_0x3e1178){const _0x21003f=_0x286fd3;_0x3e1178[_0x21003f(0x16e)](path['join'](__dirname,bbpath2,'build2',_0x21003f(0x21b)));}),app[_0x286fd3(0x239)](_0x286fd3(0x17e),function(_0x33ab74,_0x165ed0){const _0x2578f3=_0x286fd3;_0x165ed0[_0x2578f3(0x16e)](path['join'](__dirname,bbpath2,_0x2578f3(0x26b),_0x2578f3(0x21b)));}),app['get'](_0x286fd3(0x1f8),(_0x3b1973,_0x4b4e11)=>{const _0x220080=_0x286fd3;_0x4b4e11[_0x220080(0x16e)](path[_0x220080(0x1dd)](__dirname,bbpath2,_0x220080(0x26b),_0x220080(0x21b)));}),app[_0x286fd3(0x239)]('/:bot/performance',(_0xd62516,_0x39147d)=>{const _0x383a6e=_0x286fd3;_0x39147d[_0x383a6e(0x16e)](path['join'](__dirname,bbpath2,_0x383a6e(0x26b),'index.html'));}),app[_0x286fd3(0x239)]('/:bot/coins',(_0x20e190,_0x4f786e)=>{const _0x7ad1e3=_0x286fd3;_0x4f786e[_0x7ad1e3(0x16e)](path[_0x7ad1e3(0x1dd)](__dirname,bbpath2,_0x7ad1e3(0x26b),_0x7ad1e3(0x21b)));}),app['get'](_0x286fd3(0x17f),(_0x4a0d58,_0x49dc29)=>{const _0x4179ca=_0x286fd3;_0x49dc29[_0x4179ca(0x16e)](path[_0x4179ca(0x1dd)](__dirname,bbpath2,_0x4179ca(0x26b),_0x4179ca(0x21b)));}),app[_0x286fd3(0x239)](_0x286fd3(0x1b8),(_0x244b88,_0x3c95bc)=>{const _0x7817bb=_0x286fd3;_0x3c95bc[_0x7817bb(0x16e)](path['join'](__dirname,bbpath2,_0x7817bb(0x26b),'index.html'));}),app[_0x286fd3(0x239)]('/:bot/support',(_0xe04041,_0x43cf78)=>{const _0xc3444e=_0x286fd3;_0x43cf78['sendFile'](path[_0xc3444e(0x1dd)](__dirname,bbpath2,'build',_0xc3444e(0x21b)));});if(HOST)http['listen'](PORT,HOST);else http[_0x286fd3(0x1a1)](PORT);const io=require('socket.io')(http,{}),analytics=analyticsLib({'app':_0x286fd3(0x1d3),'plugins':[googleAnalytics({'trackingId':_0x286fd3(0x16f)})]}),TelegramBot=require('node-telegram-bot-api');let tgBot;if(settings[_0x286fd3(0x21a)]&&settings[_0x286fd3(0x21a)]!=''&&settings['telegramUsername']&&settings[_0x286fd3(0x1f7)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x29a219=_0x286fd3;console[_0x29a219(0x14d)](''),console[_0x29a219(0x14d)](_0x29a219(0x1c3)),logging(_0x29a219(0x1ff)+PORT),console[_0x29a219(0x14d)](_0x29a219(0x1c3));if(config['length']!=0x0)config[_0x29a219(0x1f1)](_0x3c35fe=>{const _0x466790=_0x29a219;if(_0x3c35fe[_0x466790(0x235)]==_0x466790(0x15f)||_0x3c35fe['status']==_0x466790(0x249))logging(_0x466790(0x20a)+_0x3c35fe['botID']+_0x466790(0x211)+_0x3c35fe[_0x466790(0x202)]),startBot([_0x3c35fe[_0x466790(0x26c)],userID],{'cwd':bbpath},function(_0x116e7e){if(_0x116e7e)logging(_0x116e7e);});else(_0x3c35fe[_0x466790(0x235)]==_0x466790(0x255)||_0x3c35fe[_0x466790(0x235)]==_0x466790(0x16d))&&logging(_0x466790(0x151)+_0x3c35fe[_0x466790(0x26c)]+'\x20|\x20'+_0x3c35fe[_0x466790(0x202)]);});else!newBot&&console[_0x29a219(0x14d)](_0x29a219(0x1f4));if(newBot)addBot();console[_0x29a219(0x14d)](_0x29a219(0x1c3)),console['log']('');}function startSocket(){const _0xdd504b=_0x286fd3;io['on'](_0xdd504b(0x1fe),_0x3807e8=>{const _0x82f25e=_0xdd504b;let _0x5cd715,_0x3f784f,_0x581107,_0x5126d4,_0x37034d;const _0xc8dfcf=_0x3807e8[_0x82f25e(0x1fa)][_0x82f25e(0x1e7)][_0x82f25e(0x13b)];_0x3f784f=_0xc8dfcf[_0x82f25e(0x1fb)](/bot[0-9]{3}/);if(_0x3f784f)_0x581107=_0x3f784f[0x0][_0x82f25e(0x1fb)](/[0-9]{3}/);if(_0x581107)_0x5cd715=_0x581107[0x0];else _0x5cd715=_0x82f25e(0x1f6);const _0xd5eaa0=_0x3807e8[_0x82f25e(0x1fa)][_0x82f25e(0x268)]['encryptedUuid'];if(!_0xd5eaa0)_0x3807e8[_0x82f25e(0x1ad)]('status',{'publicKey':secure[_0x82f25e(0x195)]});else{_0x5126d4=timelyDecrypt(_0xd5eaa0,![]);if(!_0x5126d4)_0x3807e8[_0x82f25e(0x1ad)](_0x82f25e(0x235),{'publicKey':secure[_0x82f25e(0x195)]});else{_0x37034d=normalizeIP(_0x3807e8[_0x82f25e(0x262)][_0x82f25e(0x1ca)])[_0x82f25e(0x203)];if(!devices[_0x5126d4])devices[_0x5126d4]={'uuid':_0x5126d4,'access':{'token':null}};devices[_0x5126d4]['ip']=_0x37034d;const _0xa2334a=addClient(_0x3807e8['id'],_0x5126d4,_0x5cd715);setAccess(_0xa2334a),_0x3807e8['on'](_0x82f25e(0x156),_0x21b0ee=>{const _0x16393b=_0x82f25e,_0x513b07=timelyDecrypt(_0x21b0ee[_0x16393b(0x191)]);if(_0x513b07){_0x21b0ee={'username':_0x21b0ee[_0x16393b(0x1b6)],'password':_0x513b07},devices[_0x5126d4]['access']=validateCredentials(_0x21b0ee,_0x5126d4);if(devices[_0x5126d4][_0x16393b(0x244)]['allow']==![]&&devices[_0x5126d4]['access'][_0x16393b(0x1ea)]==_0x16393b(0x231))_0x3807e8['emit'](_0x16393b(0x235),{'access':devices[_0x5126d4]['access']}),loginAccess2FA(_0x5126d4,_0x37034d);else{if(devices[_0x5126d4][_0x16393b(0x244)]['allow']==![]&&devices[_0x5126d4][_0x16393b(0x244)]['reason']==_0x16393b(0x14f))_0x3807e8['emit'](_0x16393b(0x235),{'access':devices[_0x5126d4][_0x16393b(0x244)]});else devices[_0x5126d4][_0x16393b(0x244)][_0x16393b(0x142)]&&devices[_0x5126d4][_0x16393b(0x244)]['reason']==_0x16393b(0x12d)&&(getClientsWithUuid(_0x5126d4)[_0x16393b(0x1f1)](_0x4a6c22=>{setAccess(_0x4a6c22);}),setTokenRefresh(_0x5126d4),setSessionTimeout(_0x16393b(0x156),_0x5126d4));}}else logging(_0x16393b(0x212));}),_0x3807e8['on'](_0x82f25e(0x132),()=>{resetPassword();}),_0x3807e8['on'](_0x82f25e(0x223),_0x102f8f=>{removeClient(_0x3807e8['id']);});}}});}function initClient(_0x4d3b68){const _0x3b1abc=_0x286fd3;if(_0x4d3b68!='botmanager'&&config['apiKey']!=''){if(pid[_0x4d3b68])pid[_0x4d3b68][_0x3b1abc(0x234)]({'function':_0x3b1abc(0x22b),'args':null});}}function getSocket(_0x1234df){const _0x3cd393=_0x286fd3;return io[_0x3cd393(0x167)]['sockets'][_0x3cd393(0x239)](_0x1234df);}function setAccess(_0x540b6c){const _0x23c4d6=_0x286fd3,_0x1da563=getSocket(_0x540b6c['id']),_0x1a7ee1=_0x540b6c[_0x23c4d6(0x181)],_0x5328a7=_0x540b6c[_0x23c4d6(0x200)];devices[_0x1a7ee1][_0x23c4d6(0x244)]=validateAccess(devices[_0x1a7ee1][_0x23c4d6(0x244)][_0x23c4d6(0x258)],_0x1a7ee1),_0x1da563[_0x23c4d6(0x1dd)](_0x1a7ee1);if(devices[_0x1a7ee1][_0x23c4d6(0x244)][_0x23c4d6(0x142)]){_0x1da563[_0x23c4d6(0x1dd)](_0x5328a7);if(_0x5328a7==_0x23c4d6(0x1f6))initializeSocketBotManager(_0x1da563);else initializeSocketBot(_0x1da563);initClient(_0x5328a7);}devices[_0x1a7ee1][_0x23c4d6(0x244)][_0x23c4d6(0x258)]&&devices[_0x1a7ee1][_0x23c4d6(0x244)][_0x23c4d6(0x1ea)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x23c4d6(0x225),_0x1a7ee1),devices[_0x1a7ee1]['access'][_0x23c4d6(0x258)]&&devices[_0x1a7ee1][_0x23c4d6(0x244)][_0x23c4d6(0x1ea)]==_0x23c4d6(0x260)&&setSessionTimeout(_0x23c4d6(0x156),_0x1a7ee1),_0x1da563[_0x23c4d6(0x1ad)](_0x23c4d6(0x235),{'status':_0x540b6c['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x1a7ee1][_0x23c4d6(0x244)],'externalip':devices[_0x1a7ee1]['ip'],'publicKey':secure[_0x23c4d6(0x195)]}),devices[_0x1a7ee1]['access'][_0x23c4d6(0x142)]==![]&&devices[_0x1a7ee1][_0x23c4d6(0x244)][_0x23c4d6(0x1ea)]=='2FA\x20required'&&temporaryAccess2FA(_0x1a7ee1,devices[_0x1a7ee1]['ip']);}function setSessionTimeout(_0x16892d,_0x238e56){const _0x5b5841=_0x286fd3;let _0x5af12e;if(_0x16892d==_0x5b5841(0x156))_0x5af12e=loginExpiry*0x3c*0x3e8;else _0x5af12e=devices[_0x238e56]['telegramIpApproval']['expiry']*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x238e56][_0x5b5841(0x236)][_0x5b5841(0x261)]);if(devices[_0x238e56]['pidExpireLogin'])clearTimeout(devices[_0x238e56][_0x5b5841(0x188)]);devices[_0x238e56][_0x5b5841(0x188)]=setTimeout(()=>{const _0x427789=_0x5b5841;if(devices[_0x238e56]['pidRefreshToken'])clearTimeout(devices[_0x238e56][_0x427789(0x15b)]);removeSocketListeners(_0x238e56),addBlacklist(_0x238e56),devices[_0x238e56][_0x427789(0x236)]=null,devices[_0x238e56]['telegram2FaApproval']=null,devices[_0x238e56][_0x427789(0x244)][_0x427789(0x258)]=null,devices[_0x238e56][_0x427789(0x244)]=validateAccess(devices[_0x238e56][_0x427789(0x244)][_0x427789(0x258)],_0x238e56),!(devices[_0x238e56][_0x427789(0x244)][_0x427789(0x142)]&&devices[_0x238e56][_0x427789(0x244)]['reason']==_0x427789(0x138))&&(_0x16892d==_0x427789(0x156)?io['to'](_0x238e56)['emit'](_0x427789(0x235),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x238e56)[_0x427789(0x1ad)]('status',{'access':{'allow':![],'reason':_0x427789(0x1f3),'token':null}})),devices[_0x238e56]['access']['token']=null;},_0x5af12e);}function setTokenRefresh(_0x29d30a){const _0xcf6223=_0x286fd3;if(devices[_0x29d30a][_0xcf6223(0x15b)])clearTimeout(devices[_0x29d30a][_0xcf6223(0x15b)]);devices[_0x29d30a]['pidRefreshToken']=setTimeout(()=>{const _0x1aa8b5=_0xcf6223;getClientsWithUuid(_0x29d30a)[_0x1aa8b5(0x22d)]!=0x0?(devices[_0x29d30a][_0x1aa8b5(0x244)]=refreshToken(_0x29d30a),io['to'](_0x29d30a)[_0x1aa8b5(0x1ad)](_0x1aa8b5(0x235),{'status':_0x1aa8b5(0x215),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x29d30a][_0x1aa8b5(0x244)],'externalip':devices[_0x29d30a]['ip'],'publicKey':secure['publicKey']}),setTokenRefresh(_0x29d30a)):clearTimeout(devices[_0x29d30a]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x23aad2){const _0x582d91=_0x286fd3,_0x378085=getClient(_0x23aad2['id'])[_0x582d91(0x181)];_0x23aad2['emit']('bots',config),_0x23aad2[_0x582d91(0x1ad)]('settings',cleanSettings()),_0x23aad2['on']('add-bot',_0x5549ac=>{const _0x3bbb7b=_0x582d91;if(validateAccess(_0x5549ac,_0x378085)[_0x3bbb7b(0x142)])addBot();else logging(_0x3bbb7b(0x163));}),_0x23aad2['on'](_0x582d91(0x222),(_0x133c57,_0x28c737)=>{const _0x5d37c4=_0x582d91;if(validateAccess(_0x28c737,_0x378085)[_0x5d37c4(0x142)])toggleBot(_0x133c57[_0x5d37c4(0x26c)],_0x133c57[_0x5d37c4(0x235)],_0x133c57[_0x5d37c4(0x12b)]);else logging(_0x5d37c4(0x13e));}),_0x23aad2['on']('delete-bot',(_0xec2be1,_0x321bc5)=>{const _0x28acc1=_0x582d91;if(validateAccess(_0x321bc5,_0x378085)[_0x28acc1(0x142)])deleteBot(_0xec2be1);else logging(_0x28acc1(0x257));}),_0x23aad2['on'](_0x582d91(0x24c),(_0x323968,_0x1d245d)=>{const _0x16f611=_0x582d91;if(validateAccess(_0x1d245d,_0x378085)[_0x16f611(0x142)])storeSettings(_0x323968,!![]);else logging(_0x16f611(0x248));}),_0x23aad2['on'](_0x582d91(0x204),(_0x483545,_0x8ba18b)=>{const _0x6f1cb2=_0x582d91;if(validateAccess(_0x8ba18b,_0x378085)[_0x6f1cb2(0x142)])updateBB();else logging(_0x6f1cb2(0x248));}),_0x23aad2['on'](_0x582d91(0x17d),_0x571a7b=>{const _0x33fe53=_0x582d91;if(validateAccess(_0x571a7b,_0x378085)[_0x33fe53(0x142)]){if(devices[_0x378085][_0x33fe53(0x15b)])clearTimeout(devices[_0x378085][_0x33fe53(0x15b)]);if(devices[_0x378085][_0x33fe53(0x188)])clearTimeout(devices[_0x378085][_0x33fe53(0x188)]);removeSocketListeners(getClient(_0x23aad2['id'])[_0x33fe53(0x181)]),addBlacklist(_0x378085),devices[_0x378085][_0x33fe53(0x236)]=null,devices[_0x378085][_0x33fe53(0x1be)]=null,devices[_0x378085][_0x33fe53(0x244)]['token']=null,io['to'](getClient(_0x23aad2['id'])[_0x33fe53(0x181)])[_0x33fe53(0x1ad)](_0x33fe53(0x235),{'access':{'allow':![],'reason':_0x33fe53(0x23a),'token':null}});}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x2c3ed9){const _0x48efe8=_0x286fd3,_0x244f42=getClient(_0x2c3ed9['id'])[_0x48efe8(0x200)],_0x2e06e5=getClient(_0x2c3ed9['id'])[_0x48efe8(0x181)];_0x2c3ed9['on']('get-logs',(_0x2467c5,_0x29c9a3)=>{const _0x649263=_0x48efe8;if(validateAccess(_0x29c9a3,_0x2e06e5)[_0x649263(0x142)]){if(pid[_0x244f42])pid[_0x244f42][_0x649263(0x234)]({'function':_0x649263(0x1c1),'args':_0x2467c5});}else logging(_0x649263(0x1e0));}),_0x2c3ed9['on'](_0x48efe8(0x189),(_0x33e3a2,_0x512620)=>{const _0x33f59d=_0x48efe8;if(validateAccess(_0x512620,_0x2e06e5)[_0x33f59d(0x142)]){if(pid[_0x244f42])pid[_0x244f42][_0x33f59d(0x234)]({'function':'getPortfolio','args':_0x33e3a2});}else logging(_0x33f59d(0x21d));}),_0x2c3ed9['on'](_0x48efe8(0x1a6),(_0x480758,_0x3da5e6)=>{const _0x13286a=_0x48efe8;if(validateAccess(_0x3da5e6,_0x2e06e5)[_0x13286a(0x142)]){if(pid[_0x244f42])pid[_0x244f42][_0x13286a(0x234)]({'function':_0x13286a(0x1f0),'args':_0x480758});}else logging('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x2c3ed9['on'](_0x48efe8(0x1a3),(_0x1a0498,_0x1fdabd)=>{const _0x91442f=_0x48efe8;if(validateAccess(_0x1fdabd,_0x2e06e5)[_0x91442f(0x142)]){if(pid[_0x244f42])pid[_0x244f42][_0x91442f(0x234)]({'function':_0x91442f(0x14a),'args':_0x1a0498});}else logging(_0x91442f(0x139));}),_0x2c3ed9['on'](_0x48efe8(0x137),_0x54b7c8=>{const _0x2e8c34=_0x48efe8;if(validateAccess(_0x54b7c8,_0x2e06e5)[_0x2e8c34(0x142)]){if(pid[_0x244f42])pid[_0x244f42]['send']({'function':_0x2e8c34(0x217),'args':null});}else logging(_0x2e8c34(0x24a));}),_0x2c3ed9['on']('place-order',(_0x4e556e,_0x539fce)=>{const _0x2b04fe=_0x48efe8;if(validateAccess(_0x539fce,_0x2e06e5)[_0x2b04fe(0x142)]){if(pid[_0x244f42])pid[_0x244f42][_0x2b04fe(0x234)]({'function':_0x2b04fe(0x205),'args':_0x4e556e});}else logging(_0x2b04fe(0x144));}),_0x2c3ed9['on'](_0x48efe8(0x250),_0xd63214=>{const _0x266727=_0x48efe8;if(validateAccess(_0xd63214,_0x2e06e5)[_0x266727(0x142)]){if(pid[_0x244f42])pid[_0x244f42][_0x266727(0x234)]({'function':_0x266727(0x14e),'args':null});}else logging('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x2c3ed9['on'](_0x48efe8(0x17d),_0x422281=>{const _0x5968c3=_0x48efe8;if(validateAccess(_0x422281,_0x2e06e5)[_0x5968c3(0x142)]){if(devices[_0x2e06e5][_0x5968c3(0x15b)])clearTimeout(devices[_0x2e06e5]['pidRefreshToken']);if(devices[_0x2e06e5]['pidExpireLogin'])clearTimeout(devices[_0x2e06e5][_0x5968c3(0x188)]);removeSocketListeners(getClient(_0x2c3ed9['id'])[_0x5968c3(0x181)]),addBlacklist(_0x2e06e5),devices[_0x2e06e5]['telegramIpApproval']=null,devices[_0x2e06e5]['telegram2FaApproval']=null,devices[_0x2e06e5]['access'][_0x5968c3(0x258)]=null,io['to'](getClient(_0x2c3ed9['id'])[_0x5968c3(0x181)])['emit'](_0x5968c3(0x235),{'access':{'allow':![],'reason':_0x5968c3(0x23a),'token':null}});}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x2d67e2){const _0x38f6c4=_0x286fd3;getClientsWithUuid(_0x2d67e2)[_0x38f6c4(0x1f1)](_0x4aa2f8=>{getSocket(_0x4aa2f8['id'])['removeAllListeners']();});}function cleanSettings(){const _0x2e5eed=_0x286fd3;let _0x22ca9a=settings;return settings[_0x2e5eed(0x21a)]&&settings[_0x2e5eed(0x21a)]!=''&&(_0x22ca9a={..._0x22ca9a,'telegramToken':'************'}),settings[_0x2e5eed(0x1a0)]&&settings[_0x2e5eed(0x1a0)]!=''&&(_0x22ca9a={..._0x22ca9a,'bbPassword':_0x2e5eed(0x254)}),_0x22ca9a;}function updateBB(){const _0x148fc4=_0x286fd3;installingUpdate=!![],config[_0x148fc4(0x1f1)](_0x513f79=>{const _0x32eed0=_0x148fc4;restartBot(_0x513f79[_0x32eed0(0x26c)]);}),process[_0x148fc4(0x234)]({'update':!![]},_0x4b4612=>{});}function startBot(_0x5b2cfe,_0x5673a1,_0x24f462){const _0x31f1a0=_0x286fd3;let _0x2e11fa=![];const _0x4d1841=_0x5b2cfe[0x0];_0x5673a1={..._0x5673a1,'stdio':['inherit',_0x31f1a0(0x175),_0x31f1a0(0x175),_0x31f1a0(0x243)]},pid[_0x4d1841]=childProcess['fork'](botfile,_0x5b2cfe,_0x5673a1),pid[_0x4d1841]['on'](_0x31f1a0(0x1cc),_0x2e4166=>{const _0x127d09=_0x31f1a0;switch(Object[_0x127d09(0x1bc)](_0x2e4166)[0x0]){case _0x127d09(0x202):updateBotName(_0x4d1841,_0x2e4166['botname']);break;case'status':updateStatus(_0x4d1841,_0x2e4166[_0x127d09(0x235)]);break;case _0x127d09(0x12b):updateLive(_0x4d1841,_0x2e4166[_0x127d09(0x12b)]);break;case'started':updateLive(_0x4d1841,_0x2e4166['started']),io['to'](_0x4d1841)[_0x127d09(0x1ad)](_0x127d09(0x235),{'access':{'allow':![],'reason':_0x127d09(0x127),'token':null}});break;case _0x127d09(0x15d):_0x2e4166['stop']==_0x127d09(0x13c)&&restartBot(_0x4d1841);_0x2e4166[_0x127d09(0x15d)]==_0x127d09(0x24f)&&toggleBot(_0x4d1841,'disabled',_0x127d09(0x1e2));break;case _0x127d09(0x133):sendTelegram(_0x4d1841,_0x2e4166['telegram']);break;case _0x127d09(0x1fc):io['to'](_0x4d1841)[_0x127d09(0x1ad)](_0x2e4166[_0x127d09(0x1fc)],_0x2e4166[_0x127d09(0x17a)]);break;}}),pid[_0x4d1841]['on']('error',function(_0x1dadfb){if(_0x2e11fa)return;_0x2e11fa=!![],_0x24f462(_0x1dadfb);}),pid[_0x4d1841]['on'](_0x31f1a0(0x1ef),function(_0xa0eeb9){const _0x38e53a=_0x31f1a0;if(installingUpdate)return;if(_0x2e11fa)return;_0x2e11fa=!![],_0x24f462(null);const _0x4f0258=dbConfig[_0x38e53a(0x239)](_0x38e53a(0x1df))[_0x38e53a(0x1b0)]({'botID':_0x4d1841})[_0x38e53a(0x186)]();_0x4f0258&&(_0x4f0258[_0x38e53a(0x235)]==_0x38e53a(0x15f)||_0x4f0258[_0x38e53a(0x235)]=='new')&&(updateLive(_0x4d1841,_0x38e53a(0x1e2)),logging('restarting\x20Bot\x20'+_0x4d1841),startBot([_0x4d1841,userID],{'cwd':bbpath},function(_0x3af2eb){if(_0x3af2eb)logging(_0x3af2eb);}));});}function stopBot(_0x3514d6){const _0x247614=_0x286fd3;getClientsWithBotID(_0x3514d6)[_0x247614(0x1f1)](_0x4ec7b3=>{const _0x41db92=_0x247614;getSocket(_0x4ec7b3['id'])[_0x41db92(0x223)](!![]),removeClient(_0x4ec7b3['id']);});if(pid[_0x3514d6])pid[_0x3514d6][_0x247614(0x24f)]();}function restartBot(_0x3a6e37){const _0x365dd6=_0x286fd3;if(pid[_0x3a6e37])pid[_0x3a6e37][_0x365dd6(0x24f)]();}function addBot(){const _0x3f6bab=_0x286fd3;let _0x5d8875;for(let _0x5778ce=0x1;_0x5778ce<0x3e9;_0x5778ce++){_0x5d8875=_0x5778ce[_0x3f6bab(0x25c)]()[_0x3f6bab(0x25b)](0x3,'0');let _0xf98851=config['find'](_0x17ad19=>_0x17ad19[_0x3f6bab(0x26c)]==_0x5d8875);if(!_0xf98851)break;}if(_0x5d8875===_0x3f6bab(0x24e)){logging(_0x3f6bab(0x1c5));return;}logging(_0x3f6bab(0x264)+_0x5d8875),dbConfig[_0x3f6bab(0x239)](_0x3f6bab(0x1df))['push']({'botID':_0x5d8875,'botname':_0x3f6bab(0x1ed)+_0x5d8875,'status':'new','live':''})[_0x3f6bab(0x19b)](),startBot([_0x5d8875,userID],{'cwd':bbpath},function(_0x4ca578){if(_0x4ca578)logging(_0x4ca578);}),config=getConfiguration(),io['to'](_0x3f6bab(0x1f6))[_0x3f6bab(0x1ad)]('bots',config);}function deleteBot(_0x3ef571){const _0x4e08e0=_0x286fd3;getClientsWithBotID(_0x3ef571)[_0x4e08e0(0x1f1)](_0x295da9=>{const _0x3fdd03=_0x4e08e0;getSocket(_0x295da9['id'])[_0x3fdd03(0x223)](!![]),removeClient(_0x295da9['id']);}),dbConfig['get'](_0x4e08e0(0x1df))[_0x4e08e0(0x171)]({'botID':_0x3ef571})[_0x4e08e0(0x19b)](),logging(_0x4e08e0(0x1bd)+_0x3ef571),stopBot(_0x3ef571);try{fs[_0x4e08e0(0x1cb)](path['join'](configpath,'bot-'+_0x3ef571+_0x4e08e0(0x216))),fs[_0x4e08e0(0x1cb)](path['join'](configpath,_0x4e08e0(0x1de)+_0x3ef571+_0x4e08e0(0x26a))),fs[_0x4e08e0(0x1cb)](path[_0x4e08e0(0x1dd)](configpath,_0x4e08e0(0x1de)+_0x3ef571+'-performance.json')),fs[_0x4e08e0(0x1cb)](path[_0x4e08e0(0x1dd)](configpath,'bot-'+_0x3ef571+'-results.json'));}catch(_0x4e2fab){if(_0x4e2fab)logging(_0x4e08e0(0x21e),_0x4e2fab);}config=getConfiguration(),io['to']('botmanager')[_0x4e08e0(0x1ad)]('bots',config);}function toggleBot(_0x5bd5bb,_0x3da491,_0x3a3a26){const _0x235f6c=_0x286fd3;dbConfig[_0x235f6c(0x239)]('bots')[_0x235f6c(0x1b0)]({'botID':_0x5bd5bb})['assign']({'status':_0x3da491})[_0x235f6c(0x230)]({'live':_0x3a3a26})[_0x235f6c(0x19b)]();if(_0x3da491==_0x235f6c(0x15f)||_0x3da491==_0x235f6c(0x249))logging(_0x235f6c(0x229)+_0x5bd5bb),startBot([_0x5bd5bb,userID],{'cwd':bbpath},function(_0x1f8ec4){if(_0x1f8ec4)logging(_0x1f8ec4);});else(_0x3da491=='disabled'||_0x3da491==_0x235f6c(0x16d))&&(logging('disabled\x20Bot\x20'+_0x5bd5bb),stopBot(_0x5bd5bb));config=getConfiguration(),io['to'](_0x235f6c(0x1f6))['emit']('bots',config);}function toggleStatus(_0x1c8a1b){const _0x4fb144=_0x286fd3;let _0x14adb7=dbConfig['get'](_0x4fb144(0x1df))[_0x4fb144(0x1b0)]({'botID':_0x1c8a1b})[_0x4fb144(0x186)](),_0x2a16b9;if(_0x14adb7[_0x4fb144(0x235)]===_0x4fb144(0x15f))_0x2a16b9=_0x4fb144(0x255);else{if(_0x14adb7[_0x4fb144(0x235)]===_0x4fb144(0x249))_0x2a16b9=_0x4fb144(0x16d);else{if(_0x14adb7['status']===_0x4fb144(0x16d))_0x2a16b9=_0x4fb144(0x249);else{if(_0x14adb7[_0x4fb144(0x235)]===_0x4fb144(0x255))_0x2a16b9=_0x4fb144(0x15f);}}}return _0x2a16b9;}function updateStatus(_0x220776,_0x406691){const _0x55bb46=_0x286fd3;dbConfig[_0x55bb46(0x239)]('bots')[_0x55bb46(0x1b0)]({'botID':_0x220776})['assign']({'status':_0x406691})['write'](),config=getConfiguration(),io['to'](_0x55bb46(0x1f6))[_0x55bb46(0x1ad)](_0x55bb46(0x1df),config);}function updateLive(_0x4fb874,_0x10261f){const _0x2730d6=_0x286fd3;dbConfig['get'](_0x2730d6(0x1df))['find']({'botID':_0x4fb874})[_0x2730d6(0x230)]({'live':_0x10261f})['write'](),config=getConfiguration(),io['to'](_0x2730d6(0x1f6))[_0x2730d6(0x1ad)](_0x2730d6(0x1df),config);}function updateBotName(_0x4873aa,_0x5d4c1c){const _0x207072=_0x286fd3;dbConfig[_0x207072(0x239)](_0x207072(0x1df))['find']({'botID':_0x4873aa})[_0x207072(0x230)]({'botname':_0x5d4c1c})[_0x207072(0x19b)](),config=getConfiguration(),io['to']('botmanager')[_0x207072(0x1ad)](_0x207072(0x1df),config);}function telegramError(_0x2d4421){const _0x2ad4f4=_0x286fd3;console[_0x2ad4f4(0x14d)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x4af087){const _0x238cd9=_0x286fd3;if(_0x4af087[_0x238cd9(0x23d)][_0x238cd9(0x1b6)]!=settings['telegramUsername']&&'@'+_0x4af087[_0x238cd9(0x23d)][_0x238cd9(0x1b6)]!=settings[_0x238cd9(0x1f7)])return tgBot[_0x238cd9(0x1cd)](_0x4af087[_0x238cd9(0x18f)]['id'],_0x238cd9(0x22e),{'parse_mode':_0x238cd9(0x131)})['catch'](_0x5d951c=>{telegramError(_0x5d951c);}),![];return!![];}async function initTelegram(){const _0x5ce8f2=_0x286fd3;if(tgBot)tgBot[_0x5ce8f2(0x169)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x5ce8f2(0x21a)],{'polling':!![]});let _0x16d824='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x16d824+='\x0a',_0x16d824+=_0x5ce8f2(0x227),_0x16d824+=_0x5ce8f2(0x1e6),_0x16d824+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x16d824+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x16d824+=_0x5ce8f2(0x19f),_0x16d824+='/off\x20-\x20stop\x20bot(s)\x0a',_0x16d824+=_0x5ce8f2(0x14c),_0x16d824+=_0x5ce8f2(0x161);let _0x1dcbfe=_0x5ce8f2(0x206);_0x1dcbfe+='\x0a',_0x1dcbfe+=_0x16d824,tgBot[_0x5ce8f2(0x12e)](/\/start/,_0x6cd09c=>{const _0x5cf531=_0x5ce8f2;if(!validateTelegram(_0x6cd09c))return;if(settings['telegramChatId']!=_0x6cd09c[_0x5cf531(0x18f)]['id'])updateSetting('telegramChatId',_0x6cd09c[_0x5cf531(0x18f)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x5cf531(0x1cd)](_0x6cd09c[_0x5cf531(0x18f)]['id'],_0x1dcbfe)['catch'](_0x28d1a1=>{telegramError(_0x28d1a1);});}),tgBot[_0x5ce8f2(0x12e)](/\/enable/,_0x144f98=>{const _0xf950a8=_0x5ce8f2;if(!validateTelegram(_0x144f98))return;if(settings[_0xf950a8(0x17c)]!=_0x144f98[_0xf950a8(0x18f)]['id'])updateSetting('telegramChatId',_0x144f98[_0xf950a8(0x18f)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0xf950a8(0x1cd)](_0x144f98[_0xf950a8(0x18f)]['id'],_0xf950a8(0x152))[_0xf950a8(0x125)](_0x24eebc=>{telegramError(_0x24eebc);});}),tgBot[_0x5ce8f2(0x12e)](/\/config/,async _0x50041c=>{const _0x318dfa=_0x5ce8f2;if(!validateTelegram(_0x50041c))return;tgBot[_0x318dfa(0x1e8)]('callback_query'),tgBot[_0x318dfa(0x1cd)](_0x50041c['chat']['id'],_0x318dfa(0x232),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x318dfa(0x197)},{'text':'Alerts','callback_data':'alerts'},{'text':_0x318dfa(0x1aa),'callback_data':'all'}]]}})[_0x318dfa(0x125)](_0x1789de=>{telegramError(_0x1789de);}),tgBot['on'](_0x318dfa(0x134),async _0x265855=>{const _0xdcbc85=_0x318dfa,_0x376463=_0x265855['data'],_0x246be8=_0x265855[_0xdcbc85(0x1cc)];tgBot[_0xdcbc85(0x210)](_0x265855['id'])[_0xdcbc85(0x221)](async()=>{const _0x2709df=_0xdcbc85;_0x376463==_0x2709df(0x197)&&(updateSetting('telegramEvents','orders'),updateSetting(_0x2709df(0x228),!![]),await tgBot[_0x2709df(0x1cd)](_0x246be8[_0x2709df(0x18f)]['id'],_0x2709df(0x247))[_0x2709df(0x125)](_0x2dcff7=>{telegramError(_0x2dcff7);}));_0x376463=='alerts'&&(updateSetting(_0x2709df(0x263),_0x2709df(0x14b)),updateSetting(_0x2709df(0x228),!![]),await tgBot[_0x2709df(0x1cd)](_0x246be8[_0x2709df(0x18f)]['id'],_0x2709df(0x1c0))[_0x2709df(0x125)](_0x244aea=>{telegramError(_0x244aea);}));_0x376463==_0x2709df(0x154)&&(updateSetting('telegramEvents',_0x2709df(0x154)),updateSetting(_0x2709df(0x228),!![]),await tgBot[_0x2709df(0x1cd)](_0x246be8[_0x2709df(0x18f)]['id'],_0x2709df(0x192))['catch'](_0xb201d6=>{telegramError(_0xb201d6);}));if(!settings[_0x2709df(0x17c)])tgBot[_0x2709df(0x1cd)](_0x246be8['chat']['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x2709df(0x125)](_0x381998=>{telegramError(_0x381998);});}),tgBot[_0xdcbc85(0x1e8)](_0xdcbc85(0x134));});}),tgBot[_0x5ce8f2(0x12e)](/\/status/,_0x15950e=>{const _0x5acafb=_0x5ce8f2;if(!validateTelegram(_0x15950e))return;let _0x59de36=_0x5acafb(0x129);config['forEach'](_0x183690=>{const _0xc36133=_0x5acafb;_0x59de36+=_0xc36133(0x1ed)+_0x183690[_0xc36133(0x26c)]+'\x20|\x20'+_0x183690[_0xc36133(0x202)]+':\x20'+_0x183690['status']+_0xc36133(0x1ab)+_0x183690['live']+'\x0a';}),_0x59de36+='\x0a',_0x59de36+='<b>Telegram\x20bot\x20status:</b>\x0a',_0x59de36+=!settings['telegramEnabled']?_0x5acafb(0x1bb):_0x5acafb(0x1a8),_0x59de36+=settings[_0x5acafb(0x228)]?settings['telegramEvents']==_0x5acafb(0x154)?_0x5acafb(0x136):_0x5acafb(0x1b9)+settings[_0x5acafb(0x263)]+'\x20only\x0a':'',tgBot[_0x5acafb(0x1cd)](_0x15950e[_0x5acafb(0x18f)]['id'],_0x59de36,{'parse_mode':'HTML'})[_0x5acafb(0x125)](_0x1f93db=>{telegramError(_0x1f93db);});}),tgBot['onText'](/\/restart/,_0x152098=>{const _0xda102e=_0x5ce8f2;if(!validateTelegram(_0x152098))return;tgBot[_0xda102e(0x1e8)](_0xda102e(0x134));const _0x1ba7d4=getEnabledBots();if(_0x1ba7d4[_0xda102e(0x22d)]==0x0)tgBot[_0xda102e(0x1cd)](_0x152098['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0xda102e(0x125)](_0x1d24c1=>{telegramError(_0x1d24c1);});else{if(_0x1ba7d4[_0xda102e(0x22d)]>0x1)_0x1ba7d4[_0xda102e(0x22a)]({'botID':_0xda102e(0x154)});let _0x191675=[],_0x25ea9f=[];const _0x48fe9a=_0x1ba7d4[_0xda102e(0x22d)]%0x4==0x0||_0x1ba7d4[_0xda102e(0x22d)]%0x4==0x3||_0x1ba7d4['length']%0x3==0x1?0x4:0x3;let _0x5c44a1=0x0;_0x1ba7d4[_0xda102e(0x1f1)]((_0x5d78ba,_0x4f2ad3)=>{const _0x24824b=_0xda102e;if(_0x4f2ad3%_0x48fe9a==0x0)_0x25ea9f=[];_0x25ea9f[_0x24824b(0x22a)]({'text':_0x5d78ba[_0x24824b(0x26c)]==_0x24824b(0x154)?_0x24824b(0x1f9):'Bot\x20'+_0x5d78ba[_0x24824b(0x26c)],'callback_data':_0x5d78ba[_0x24824b(0x26c)]}),_0x4f2ad3%_0x48fe9a==0x0&&(_0x191675[_0x5c44a1]=_0x25ea9f,_0x5c44a1++);}),tgBot[_0xda102e(0x1cd)](_0x152098['chat']['id'],_0xda102e(0x173),{'reply_markup':{'inline_keyboard':_0x191675}})[_0xda102e(0x125)](_0x7d7664=>{telegramError(_0x7d7664);}),tgBot['on'](_0xda102e(0x134),async _0x4bbf99=>{const _0x5f3f42=_0xda102e,_0x1f8f1d=_0x4bbf99[_0x5f3f42(0x177)],_0x3b35a6=_0x4bbf99[_0x5f3f42(0x1cc)];tgBot['answerCallbackQuery'](_0x4bbf99['id'])[_0x5f3f42(0x221)](async()=>{const _0x113c83=_0x5f3f42;if(_0x1f8f1d==_0x113c83(0x154)){if(settings[_0x113c83(0x263)]==_0x113c83(0x197))tgBot[_0x113c83(0x1cd)](_0x3b35a6[_0x113c83(0x18f)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20all\x20bots')['catch'](_0x726bda=>{telegramError(_0x726bda);});config[_0x113c83(0x1f1)](_0x36fb50=>{restartBot(_0x36fb50['botID']);});}else{if(settings['telegramEvents']==_0x113c83(0x197))tgBot[_0x113c83(0x1cd)](_0x3b35a6['chat']['id'],_0x113c83(0x1d0)+_0x1f8f1d)[_0x113c83(0x125)](_0x2107d6=>{telegramError(_0x2107d6);});restartBot(_0x1f8f1d);}}),tgBot['removeListener'](_0x5f3f42(0x134));});}}),tgBot['onText'](/\/on/,_0x57f295=>{const _0x135b78=_0x5ce8f2;if(!validateTelegram(_0x57f295))return;tgBot[_0x135b78(0x1e8)](_0x135b78(0x134));const _0x236851=getDisabledBots();if(_0x236851[_0x135b78(0x22d)]==0x0)tgBot[_0x135b78(0x1cd)](_0x57f295[_0x135b78(0x18f)]['id'],_0x135b78(0x233))['catch'](_0x339920=>{telegramError(_0x339920);});else{if(_0x236851[_0x135b78(0x22d)]>0x1)_0x236851[_0x135b78(0x22a)]({'botID':_0x135b78(0x154)});let _0x4751bd=[],_0x22a335=[];const _0x33110f=_0x236851[_0x135b78(0x22d)]%0x4==0x0||_0x236851[_0x135b78(0x22d)]%0x4==0x3||_0x236851['length']%0x3==0x1?0x4:0x3;let _0x40fd5c=0x0;_0x236851[_0x135b78(0x1f1)]((_0x98d226,_0x47f2d3)=>{const _0x5d7f67=_0x135b78;if(_0x47f2d3%_0x33110f==0x0)_0x22a335=[];_0x22a335[_0x5d7f67(0x22a)]({'text':_0x98d226[_0x5d7f67(0x26c)]==_0x5d7f67(0x154)?_0x5d7f67(0x1f9):'Bot\x20'+_0x98d226[_0x5d7f67(0x26c)],'callback_data':_0x98d226[_0x5d7f67(0x26c)]}),_0x47f2d3%_0x33110f==0x0&&(_0x4751bd[_0x40fd5c]=_0x22a335,_0x40fd5c++);}),tgBot[_0x135b78(0x1cd)](_0x57f295['chat']['id'],_0x135b78(0x158),{'reply_markup':{'inline_keyboard':_0x4751bd}})[_0x135b78(0x125)](_0x18b439=>{telegramError(_0x18b439);}),tgBot['on'](_0x135b78(0x134),async _0x24ea7b=>{const _0x406041=_0x135b78,_0xdc2ad0=_0x24ea7b[_0x406041(0x177)],_0x36d6cb=_0x24ea7b['message'];tgBot[_0x406041(0x210)](_0x24ea7b['id'])[_0x406041(0x221)](async()=>{const _0x3a7d59=_0x406041;if(_0xdc2ad0==_0x3a7d59(0x154)){if(settings['telegramEvents']==_0x3a7d59(0x197))tgBot[_0x3a7d59(0x1cd)](_0x36d6cb['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')['catch'](_0x10ab07=>{telegramError(_0x10ab07);});_0x236851['forEach'](_0x264141=>{const _0xa225ff=_0x3a7d59;if(_0x264141[_0xa225ff(0x26c)]!=_0xa225ff(0x154))toggleBot(_0x264141[_0xa225ff(0x26c)],toggleStatus(_0x264141['botID']),_0xa225ff(0x1e2));});}else{if(settings['telegramEvents']==_0x3a7d59(0x197))tgBot['sendMessage'](_0x36d6cb[_0x3a7d59(0x18f)]['id'],_0x3a7d59(0x20e)+_0xdc2ad0)[_0x3a7d59(0x125)](_0x1ba0fb=>{telegramError(_0x1ba0fb);});toggleBot(_0xdc2ad0,toggleStatus(_0xdc2ad0),_0x3a7d59(0x1e2));}}),tgBot[_0x406041(0x1e8)](_0x406041(0x134));});}}),tgBot[_0x5ce8f2(0x12e)](/\/off/,_0x321760=>{const _0x42e329=_0x5ce8f2;if(!validateTelegram(_0x321760))return;tgBot[_0x42e329(0x1e8)](_0x42e329(0x134));const _0x2d93bf=getEnabledBots();if(_0x2d93bf[_0x42e329(0x22d)]==0x0)tgBot['sendMessage'](_0x321760[_0x42e329(0x18f)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x42e329(0x125)](_0xaa0176=>{telegramError(_0xaa0176);});else{if(_0x2d93bf[_0x42e329(0x22d)]>0x1)_0x2d93bf[_0x42e329(0x22a)]({'botID':_0x42e329(0x154)});let _0x5e3422=[],_0x488d44=[];const _0x49fad6=_0x2d93bf[_0x42e329(0x22d)]%0x4==0x0||_0x2d93bf[_0x42e329(0x22d)]%0x4==0x3||_0x2d93bf['length']%0x3==0x1?0x4:0x3;let _0x283aac=0x0;_0x2d93bf['forEach']((_0x3119d2,_0x49b5d1)=>{const _0x28adc8=_0x42e329;if(_0x49b5d1%_0x49fad6==0x0)_0x488d44=[];_0x488d44['push']({'text':_0x3119d2[_0x28adc8(0x26c)]==_0x28adc8(0x154)?_0x28adc8(0x1f9):_0x28adc8(0x1ed)+_0x3119d2[_0x28adc8(0x26c)],'callback_data':_0x3119d2['botID']}),_0x49b5d1%_0x49fad6==0x0&&(_0x5e3422[_0x283aac]=_0x488d44,_0x283aac++);}),tgBot[_0x42e329(0x1cd)](_0x321760['chat']['id'],_0x42e329(0x25d),{'reply_markup':{'inline_keyboard':_0x5e3422}})[_0x42e329(0x125)](_0x841574=>{telegramError(_0x841574);}),tgBot['on']('callback_query',async _0x2272e4=>{const _0x5e6d62=_0x42e329,_0x2beb0b=_0x2272e4[_0x5e6d62(0x177)],_0x17e887=_0x2272e4[_0x5e6d62(0x1cc)];tgBot[_0x5e6d62(0x210)](_0x2272e4['id'])['then'](async()=>{const _0x17ce0b=_0x5e6d62;if(_0x2beb0b=='all'){if(settings[_0x17ce0b(0x263)]==_0x17ce0b(0x197))tgBot['sendMessage'](_0x17e887['chat']['id'],_0x17ce0b(0x224))[_0x17ce0b(0x125)](_0x2891f2=>{telegramError(_0x2891f2);});_0x2d93bf['forEach'](_0x2e0069=>{const _0x377e44=_0x17ce0b;if(_0x2e0069[_0x377e44(0x26c)]!=_0x377e44(0x154))toggleBot(_0x2e0069[_0x377e44(0x26c)],toggleStatus(_0x2e0069[_0x377e44(0x26c)]),_0x377e44(0x1e2));});}else{if(settings[_0x17ce0b(0x263)]==_0x17ce0b(0x197))tgBot['sendMessage'](_0x17e887[_0x17ce0b(0x18f)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x2beb0b)['catch'](_0x3d8c6f=>{telegramError(_0x3d8c6f);});toggleBot(_0x2beb0b,toggleStatus(_0x2beb0b),_0x17ce0b(0x1e2));}}),tgBot[_0x5e6d62(0x1e8)](_0x5e6d62(0x134));});}}),tgBot[_0x5ce8f2(0x12e)](/\/disable/,_0x38dc73=>{const _0xcd1d16=_0x5ce8f2;if(!validateTelegram(_0x38dc73))return;tgBot['sendMessage'](_0x38dc73[_0xcd1d16(0x18f)]['id'],_0xcd1d16(0x1ce))['catch'](_0x361f04=>{telegramError(_0x361f04);}),updateSetting(_0xcd1d16(0x228),![]);}),tgBot['onText'](/\/help/,_0x2d2d83=>{const _0x1209ca=_0x5ce8f2;if(!validateTelegram(_0x2d2d83))return;tgBot[_0x1209ca(0x1cd)](_0x2d2d83[_0x1209ca(0x18f)]['id'],_0x16d824)[_0x1209ca(0x125)](_0x1b9485=>{telegramError(_0x1b9485);});}),tgBot['on'](_0x5ce8f2(0x242),_0x533913=>{const _0x111e54=_0x5ce8f2;_0x533913[_0x111e54(0x25c)]()[_0x111e54(0x145)](_0x111e54(0x183))&&(logging(_0x111e54(0x1a2)),tgBot[_0x111e54(0x169)](),tgBot=null,io['to'](_0x111e54(0x1f6))[_0x111e54(0x1ad)](_0x111e54(0x1ee),'Invalid\x20Telegram\x20token'));}),process['once']('SIGINT',()=>{const _0x32a97b=_0x5ce8f2;if(tgBot)tgBot[_0x32a97b(0x169)]();process['exit'](0x1);}),process[_0x5ce8f2(0x24d)](_0x5ce8f2(0x16c),()=>{const _0x285c2c=_0x5ce8f2;if(tgBot)tgBot[_0x285c2c(0x169)]();process['exit'](0x1);});}}function disableTelegram(){const _0x48fbd9=_0x286fd3;tgBot&&(tgBot[_0x48fbd9(0x169)](),tgBot=null);}function sendTelegram(_0x3e7210,_0xb1cc07){const _0x441a6c=_0x286fd3;if(settings['telegramEnabled']){if(settings[_0x441a6c(0x263)]==_0x441a6c(0x154)||(_0xb1cc07[_0x441a6c(0x1d4)]==_0x441a6c(0x1c2)||_0xb1cc07[_0x441a6c(0x1d4)]==_0x441a6c(0x265))&&settings[_0x441a6c(0x263)]==_0x441a6c(0x14b)||_0xb1cc07[_0x441a6c(0x1d4)]==_0x441a6c(0x246)&&settings[_0x441a6c(0x263)]=='orders'){if(tgBot&&settings[_0x441a6c(0x17c)]){if(_0xb1cc07[_0x441a6c(0x126)])tgBot[_0x441a6c(0x1cd)](settings[_0x441a6c(0x17c)],_0xb1cc07[_0x441a6c(0x202)]+_0x441a6c(0x21c)+_0xb1cc07[_0x441a6c(0x1d2)])[_0x441a6c(0x125)](_0x537404=>{telegramError(_0x537404);});else tgBot[_0x441a6c(0x1cd)](settings[_0x441a6c(0x17c)],_0x441a6c(0x1ed)+_0x3e7210+_0x441a6c(0x21c)+_0xb1cc07[_0x441a6c(0x1d2)])[_0x441a6c(0x125)](_0x121dc7=>{telegramError(_0x121dc7);});}}}}function getDeviceWithIp(_0x2f3e81){const _0x4cdfc7=_0x286fd3;return devices[_0x4cdfc7(0x1b0)](_0x1fd1c9=>_0x1fd1c9['ip']===_0x2f3e81);}function temporaryAccess2FA(_0x4f531a,_0x43054c){const _0x2993d1=_0x286fd3;let _0x11d738=new Date(),_0x214ac7=![];if(lastIpApproval){if(_0x11d738-lastIpApproval<0x1388)_0x214ac7=!![];}lastIpApproval=new Date();if(_0x214ac7)return;tgBot&&settings[_0x2993d1(0x17c)]&&(tgBot[_0x2993d1(0x1e8)](_0x2993d1(0x134)),tgBot[_0x2993d1(0x1cd)](settings[_0x2993d1(0x17c)],_0x2993d1(0x1b7)+normalizeIP(_0x43054c)['show']+_0x2993d1(0x1a4),{'parse_mode':_0x2993d1(0x131),'reply_markup':{'inline_keyboard':[[{'text':_0x2993d1(0x172),'callback_data':'5'},{'text':_0x2993d1(0x1af),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x2993d1(0x199),'callback_data':_0x2993d1(0x199)}]]}})[_0x2993d1(0x125)](_0x2cd16a=>{telegramError(_0x2cd16a);}),tgBot['on'](_0x2993d1(0x134),async _0x4c6edf=>{const _0x444cdb=_0x2993d1,_0x2c4762=_0x4c6edf[_0x444cdb(0x177)],_0x1922e8=_0x4c6edf[_0x444cdb(0x1cc)];tgBot['answerCallbackQuery'](_0x4c6edf['id'])[_0x444cdb(0x221)](async()=>{const _0x119e5b=_0x444cdb;devices[_0x4f531a][_0x119e5b(0x236)]={'clientip':_0x43054c,'timestamp':new Date()[_0x119e5b(0x213)](),'expiry':_0x2c4762},_0x2c4762!=_0x119e5b(0x199)?(await tgBot[_0x119e5b(0x1cd)](_0x1922e8[_0x119e5b(0x18f)]['id'],_0x119e5b(0x1f5)+_0x2c4762+_0x119e5b(0x1d6),{'parse_mode':'HTML'})[_0x119e5b(0x125)](_0x4f312d=>{telegramError(_0x4f312d);}),io['to'](_0x4f531a)[_0x119e5b(0x1ad)]('status',{'access':{'allow':![],'reason':_0x119e5b(0x127),'token':null}})):(await tgBot[_0x119e5b(0x1cd)](_0x1922e8['chat']['id'],'Temporary\x20access\x20rejected')[_0x119e5b(0x125)](_0x25d976=>{telegramError(_0x25d976);}),io['to'](_0x4f531a)[_0x119e5b(0x1ad)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x444cdb(0x1e8)](_0x444cdb(0x134));}));}function loginAccess2FA(_0x4a6dc6,_0x1301f0){const _0x2fd7fb=_0x286fd3;tgBot&&settings[_0x2fd7fb(0x17c)]&&(tgBot['removeListener']('callback_query'),tgBot['sendMessage'](settings[_0x2fd7fb(0x17c)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x1301f0)[_0x2fd7fb(0x160)]+'</b>\x20?',{'parse_mode':_0x2fd7fb(0x131),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x2fd7fb(0x199),'callback_data':_0x2fd7fb(0x199)}]]}})[_0x2fd7fb(0x125)](_0x21a979=>{telegramError(_0x21a979);}),tgBot['on'](_0x2fd7fb(0x134),async _0x49f0e3=>{const _0x55cf72=_0x2fd7fb,_0x70c7c2=_0x49f0e3[_0x55cf72(0x177)],_0x5acb3c=_0x49f0e3[_0x55cf72(0x1cc)];tgBot[_0x55cf72(0x210)](_0x49f0e3['id'])['then'](async()=>{const _0x3b9ce6=_0x55cf72;devices[_0x4a6dc6][_0x3b9ce6(0x1be)]={'clientip':_0x1301f0,'timestamp':new Date()[_0x3b9ce6(0x213)](),'expiry':_0x70c7c2},_0x70c7c2!=_0x3b9ce6(0x199)?(await tgBot[_0x3b9ce6(0x1cd)](_0x5acb3c[_0x3b9ce6(0x18f)]['id'],_0x3b9ce6(0x20d),{'parse_mode':_0x3b9ce6(0x131)})[_0x3b9ce6(0x125)](_0x521742=>{telegramError(_0x521742);}),io['to'](_0x4a6dc6)[_0x3b9ce6(0x1ad)](_0x3b9ce6(0x235),{'access':{'allow':![],'reason':_0x3b9ce6(0x127),'token':null}})):(await tgBot['sendMessage'](_0x5acb3c[_0x3b9ce6(0x18f)]['id'],_0x3b9ce6(0x208))['catch'](_0x7ab12a=>{telegramError(_0x7ab12a);}),io['to'](_0x4a6dc6)[_0x3b9ce6(0x1ad)](_0x3b9ce6(0x235),{'access':{'allow':![],'reason':_0x3b9ce6(0x162),'token':null}}));}),tgBot['removeListener'](_0x55cf72(0x134));}));}function getConfiguration(){const _0x144285=_0x286fd3;return dbConfig['get'](_0x144285(0x1df))['sortBy']('botID')[_0x144285(0x186)]()||[];}function getEnabledBots(){const _0x17060b=_0x286fd3;return dbConfig[_0x17060b(0x239)](_0x17060b(0x1df))[_0x17060b(0x201)](_0x17060b(0x26c))['filter']({'status':_0x17060b(0x15f)})[_0x17060b(0x186)]()||[];}function getDisabledBots(){const _0x4600ee=_0x286fd3;return dbConfig['get'](_0x4600ee(0x1df))[_0x4600ee(0x201)]('botID')[_0x4600ee(0x140)]({'status':_0x4600ee(0x255)})['value']()||[];}function getSettings(){const _0x162413=_0x286fd3;return dbSettings[_0x162413(0x239)](_0x162413(0x1e9))[_0x162413(0x186)]()||{'timeshift':0x0};}function getSecure(){const _0x13c1b0=_0x286fd3;return dbSecure[_0x13c1b0(0x239)](_0x13c1b0(0x267))['value']()||{};}function getBlacklist(){const _0x21825b=_0x286fd3;return dbSecure[_0x21825b(0x239)]('blacklist')[_0x21825b(0x186)]()||[];}function broadcastToBots(_0x21ddcd,_0x1320c5){const _0x23143f=_0x286fd3;config[_0x23143f(0x1f1)](_0x128bff=>{const _0x5caec1=_0x23143f;if(_0x128bff[_0x5caec1(0x235)]==_0x5caec1(0x15f)&&_0x128bff['live']==_0x5caec1(0x23e)){if(pid[_0x128bff[_0x5caec1(0x26c)]])pid[_0x128bff[_0x5caec1(0x26c)]][_0x5caec1(0x234)]({[_0x21ddcd]:_0x1320c5});}});}function storeSettings(_0x1b163b,_0x2cb568=![]){const _0x587320=_0x286fd3;_0x1b163b={...settings,..._0x1b163b};if(_0x2cb568&&_0x1b163b[_0x587320(0x1a0)]!=_0x587320(0x254)&&_0x1b163b[_0x587320(0x1a0)]!=''){const _0x1d5e38=crypt[_0x587320(0x25a)](secure[_0x587320(0x207)],_0x1b163b['bbPassword'])[_0x587320(0x1cc)][_0x587320(0x182)]('@')[0x0],_0x49dca1=bcrypt[_0x587320(0x155)](_0x1d5e38,saltRounds);_0x1b163b={..._0x1b163b,'bbPassword':_0x49dca1};}if(_0x2cb568&&_0x1b163b[_0x587320(0x21a)]!=_0x587320(0x254)&&_0x1b163b['telegramToken']!=''){const _0xc765b1=crypt['decrypt'](secure['privateKey'],_0x1b163b[_0x587320(0x21a)])[_0x587320(0x1cc)][_0x587320(0x182)]('@')[0x0];_0x1b163b={..._0x1b163b,'telegramToken':_0xc765b1};}const _0x4b2682=_0x1b163b['telegramToken']!=_0x587320(0x254)&&_0x1b163b['telegramToken']!=settings[_0x587320(0x21a)]||_0x1b163b['telegramUsername']!=settings[_0x587320(0x1f7)],_0x31b294=_0x1b163b[_0x587320(0x21a)]==''||_0x1b163b['telegramUsername']=='';if(_0x4b2682)_0x1b163b['telegramEvents']=_0x587320(0x154);for(const [_0x18e427,_0x32e883]of Object['entries'](_0x1b163b)){if(_0x18e427==_0x587320(0x21a)&&_0x32e883==_0x587320(0x254)){_0x1b163b['telegramToken']=settings[_0x587320(0x21a)];continue;};if(_0x18e427==_0x587320(0x1a0)&&_0x32e883==_0x587320(0x254)){_0x1b163b[_0x587320(0x1a0)]=settings[_0x587320(0x1a0)];continue;};dbSettings[_0x587320(0x237)]('settings.'+_0x18e427,_0x32e883)[_0x587320(0x19b)]();}settings=_0x1b163b,io['to']('botmanager')[_0x587320(0x1ad)](_0x587320(0x1e9),cleanSettings()),broadcastToBots(_0x587320(0x179),settings['timeshift']);if(_0x4b2682&&!_0x31b294)initTelegram();if(_0x4b2682&&_0x31b294)disableTelegram();getAllClients()[_0x587320(0x1f1)](_0x47c09a=>{const _0x37b250=_0x587320;getSocket(_0x47c09a['id'])[_0x37b250(0x1ad)](_0x37b250(0x235),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x3aaf5d,_0x57c216){const _0x354637=_0x286fd3;dbSettings['set']('settings.'+_0x3aaf5d,_0x57c216)[_0x354637(0x19b)](),settings=getSettings(),io['to'](_0x354637(0x1f6))[_0x354637(0x1ad)](_0x354637(0x1e9),cleanSettings());}function storeSecure(_0x3a646a){const _0x3b1edc=_0x286fd3;dbSecure[_0x3b1edc(0x239)](_0x3b1edc(0x267))[_0x3b1edc(0x22a)](_0x3a646a)[_0x3b1edc(0x19b)](),secure=_0x3a646a;}function addBlacklist(_0x24da33){const _0x21dbb4=_0x286fd3;cleanBlacklist();let _0x1d9f85;devices[_0x24da33]['telegramIpApproval']?_0x1d9f85=Math[_0x21dbb4(0x12f)](devices[_0x24da33][_0x21dbb4(0x236)]['expiry'],loginExpiry):_0x1d9f85=loginExpiry,dbSecure['get'](_0x21dbb4(0x1eb))[_0x21dbb4(0x22a)]({'expiry':new Date()['getTime']()+_0x1d9f85*0x3c*0x3e8,'token':devices[_0x24da33][_0x21dbb4(0x244)][_0x21dbb4(0x258)]})[_0x21dbb4(0x19b)](),blacklist=dbSecure[_0x21dbb4(0x239)](_0x21dbb4(0x1eb))['value']();}function cleanBlacklist(){const _0x390821=_0x286fd3;let _0x16d389=dbSecure[_0x390821(0x239)]('blacklist')['cloneDeep']()[_0x390821(0x186)](),_0x1cca5d=new Date()[_0x390821(0x213)]();_0x16d389[_0x390821(0x1f1)](_0x5a0149=>{const _0x4b7303=_0x390821;_0x5a0149[_0x4b7303(0x166)]<_0x1cca5d&&dbSecure[_0x4b7303(0x239)](_0x4b7303(0x1eb))['remove']({'expiry':_0x5a0149[_0x4b7303(0x166)]})['write']();});}function initStates(){const _0x4de024=_0x286fd3;let _0x5ef7ca=getConfiguration();_0x5ef7ca[_0x4de024(0x1f1)](_0x575fad=>{const _0x24e1e2=_0x4de024;_0x575fad[_0x24e1e2(0x12b)]='stopped';}),storeConfiguration(_0x5ef7ca);}function onKeys(){const _0x11d204=new RSA();return new Promise(_0x13304a=>{const _0x9edae7=_0x2175;_0x11d204[_0x9edae7(0x1ac)]()['then'](_0x13230e=>{_0x13304a(_0x13230e);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2c93f1=_0x286fd3;let _0x34f500=getConfiguration(),_0x59577f=![];_0x34f500[_0x2c93f1(0x1f1)](_0x43b145=>{const _0x27b41c=_0x2c93f1;if(_0x43b145[_0x27b41c(0x235)]=='running')_0x43b145[_0x27b41c(0x235)]=_0x27b41c(0x15f),_0x59577f=!![];else _0x43b145[_0x27b41c(0x235)]==_0x27b41c(0x1e2)&&(_0x43b145['status']=_0x27b41c(0x255),_0x59577f=!![]);});if(_0x59577f)storeConfiguration(_0x34f500);let _0x180019=getSecure();if(!_0x180019['hasOwnProperty'](_0x2c93f1(0x178))){let _0xb21048=await generateKeys();_0x180019[_0x2c93f1(0x195)]=_0xb21048['publicKey'],_0x180019['privateKey']=_0xb21048[_0x2c93f1(0x207)],_0x180019[_0x2c93f1(0x178)]=crypto[_0x2c93f1(0x24b)](0x20)[_0x2c93f1(0x25c)](_0x2c93f1(0x1cf));;storeSecure(_0x180019);}let _0x446290=getSettings();_0x59577f=![];!_0x446290[_0x2c93f1(0x13f)](_0x2c93f1(0x18a))&&(_0x446290['loginRequired']=![],_0x446290['bbUsername']='',_0x446290[_0x2c93f1(0x1a0)]='',_0x446290[_0x2c93f1(0x16b)]=![],_0x59577f=!![]);!_0x446290[_0x2c93f1(0x13f)](_0x2c93f1(0x1ec))&&(_0x446290['whitelistEnabled']=![],_0x446290[_0x2c93f1(0x1d5)]=[],_0x446290[_0x2c93f1(0x1d8)]=![],_0x59577f=!![]);if(!_0x446290[_0x2c93f1(0x13f)](_0x2c93f1(0x228))){if(_0x446290[_0x2c93f1(0x17c)])_0x446290['telegramEnabled']=!![];else _0x446290[_0x2c93f1(0x228)]=![];_0x59577f=!![];}if(_0x59577f)storeSettings(_0x446290);}function storeConfiguration(_0xe8d554){const _0xe613de=_0x286fd3;dbConfig[_0xe613de(0x239)](_0xe613de(0x1df))[_0xe613de(0x171)]()['write'](),dbConfig['get']('bots')[_0xe613de(0x22a)](..._0xe8d554)[_0xe613de(0x19b)](),config=_0xe8d554;}function resetPassword(){const _0x5648da=_0x286fd3;tgBot&&settings[_0x5648da(0x17c)]&&(tgBot[_0x5648da(0x1e8)](_0x5648da(0x134)),tgBot['sendMessage'](settings['telegramChatId'],_0x5648da(0x1e1),{'parse_mode':_0x5648da(0x131),'reply_markup':{'inline_keyboard':[[{'text':_0x5648da(0x18c),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x5648da(0x125)](_0x152d20=>{telegramError(_0x152d20);}),tgBot['on'](_0x5648da(0x134),async _0x4d813a=>{const _0x2be108=_0x5648da,_0x42cced=_0x4d813a['data'],_0x4e19d7=_0x4d813a[_0x2be108(0x1cc)];tgBot[_0x2be108(0x210)](_0x4d813a['id'])[_0x2be108(0x221)](async()=>{const _0x48d58c=_0x2be108;if(_0x42cced!='no'){const _0xb0dd3a=0xf,_0x31f6d8=_0x48d58c(0x19d),_0x17917a=Array[_0x48d58c(0x23d)](crypto['randomFillSync'](new Uint32Array(_0xb0dd3a)))[_0x48d58c(0x12c)](_0x30eea8=>_0x31f6d8[_0x30eea8%_0x31f6d8[_0x48d58c(0x22d)]])[_0x48d58c(0x1dd)](''),_0x3fd4be=bcrypt['hashSync'](_0x17917a,saltRounds);storeSettings({'bbPassword':_0x3fd4be}),await tgBot['sendMessage'](_0x4e19d7['chat']['id'],_0x48d58c(0x1b2)+_0x17917a,{'parse_mode':_0x48d58c(0x131)})[_0x48d58c(0x125)](_0x4e4683=>{telegramError(_0x4e4683);});}else await tgBot[_0x48d58c(0x1cd)](_0x4e19d7[_0x48d58c(0x18f)]['id'],'Password\x20reset\x20rejected')[_0x48d58c(0x125)](_0x386b70=>{telegramError(_0x386b70);});}),tgBot[_0x2be108(0x1e8)]('callback_query');}));}function logging(_0x2c04b1){const _0x1a7cc3=_0x286fd3;console['log'](getTimeStamp()+_0x1a7cc3(0x153)+_0x2c04b1);if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x1a7cc3(0x197))tgBot[_0x1a7cc3(0x1cd)](settings['telegramChatId'],_0x1a7cc3(0x187)+_0x2c04b1)['catch'](_0x551943=>{telegramError(_0x551943);});}function getServerTime(){const _0x11b2e0=_0x286fd3,_0x16601f=new Date();return _0x16601f[_0x11b2e0(0x1a9)]()+'/'+(_0x16601f[_0x11b2e0(0x220)]()+0x1)[_0x11b2e0(0x25c)]()[_0x11b2e0(0x25b)](0x2,'0')+'/'+_0x16601f[_0x11b2e0(0x141)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x16601f['getHours']()[_0x11b2e0(0x25c)]()['padStart'](0x2,'0')+':'+_0x16601f[_0x11b2e0(0x1e5)]()[_0x11b2e0(0x25c)]()['padStart'](0x2,'0')+':'+_0x16601f[_0x11b2e0(0x241)]()[_0x11b2e0(0x25c)]()[_0x11b2e0(0x25b)](0x2,'0');}function getTimeStamp(){const _0xcf3334=_0x286fd3,_0x24d62a=shiftedTime();return _0x24d62a['getFullYear']()+'/'+(_0x24d62a['getMonth']()+0x1)[_0xcf3334(0x25c)]()[_0xcf3334(0x25b)](0x2,'0')+'/'+_0x24d62a[_0xcf3334(0x141)]()[_0xcf3334(0x25c)]()[_0xcf3334(0x25b)](0x2,'0')+'\x20'+_0x24d62a[_0xcf3334(0x1c6)]()['toString']()[_0xcf3334(0x25b)](0x2,'0')+':'+_0x24d62a[_0xcf3334(0x1e5)]()[_0xcf3334(0x25c)]()[_0xcf3334(0x25b)](0x2,'0')+':'+_0x24d62a[_0xcf3334(0x241)]()[_0xcf3334(0x25c)]()[_0xcf3334(0x25b)](0x2,'0');}function shiftedTime(){const _0x55a865=_0x286fd3,_0x5b8371=new Date();let _0x2e05ab=_0x5b8371;if(settings['timeshift']&&settings[_0x55a865(0x179)]!==0x0)_0x2e05ab=fns[_0x55a865(0x245)](_0x5b8371,{'hours':settings[_0x55a865(0x179)]});return _0x2e05ab;}function startScheduler(){const _0x2659e9=_0x286fd3;let _0x3bf13f=new Date()[_0x2659e9(0x1e3)]();_0x3bf13f==0x1&&backupConfigFiles();_0x3bf13f==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x518d9a=_0x286fd3;fs[_0x518d9a(0x1bf)](configpath,{'withFileTypes':!![]})['forEach'](_0x28ff8e=>{const _0x35c8e1=_0x518d9a;if(!_0x28ff8e[_0x35c8e1(0x16a)]())fs[_0x35c8e1(0x185)](configpath+_0x28ff8e['name'],configbackuppath+_0x28ff8e[_0x35c8e1(0x1c8)]);});}function triggerAnalytics(){const _0x132cfa=_0x286fd3;analytics[_0x132cfa(0x170)]({'title':_0x132cfa(0x25f),'href':_0x132cfa(0x165),'path':'/v'+serverversion});}function _0x2175(_0x3c2405,_0x3cae38){const _0x2a76da=_0x58f1();return _0x2175=function(_0x4b039e,_0x234537){_0x4b039e=_0x4b039e-0x123;let _0x58f157=_0x2a76da[_0x4b039e];return _0x58f157;},_0x2175(_0x3c2405,_0x3cae38);}function validateCredentials(_0x16d7d0,_0x393ce9){const _0x430750=_0x286fd3;if(_0x16d7d0[_0x430750(0x1b6)]==settings[_0x430750(0x193)]&&bcrypt['compareSync'](_0x16d7d0[_0x430750(0x191)],settings['bbPassword'])){if(settings[_0x430750(0x16b)])return{'allow':![],'reason':_0x430750(0x231),'token':null};else{const _0x5ba1a5=generateLoginToken(_0x393ce9);return{'allow':!![],'reason':_0x430750(0x12d),'token':_0x5ba1a5};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x39c927){const _0x3e0dfc=_0x286fd3,_0x444ffd=generateLoginToken(_0x39c927);return{'allow':!![],'reason':_0x3e0dfc(0x12d),'token':_0x444ffd};}function validateAccess(_0x98dabf,_0xdea458){const _0x575fdf=_0x286fd3;let _0xcb574e=devices[_0xdea458]['ip'],_0xc9602;const _0x313822=_0x1bb726=>{const _0x34142f=_0x2175;if(settings['loginRequired']){if(settings[_0x34142f(0x16b)]){if(telegram2FaApproved(_0xdea458)){const _0x593050=generateLoginToken(_0xdea458);return{'allow':!![],'reason':_0x34142f(0x260),'token':_0x593050};}else return{'allow':![],'reason':_0x34142f(0x1da),'token':null};}else return _0xc9602=validToken(_0x1bb726,_0xdea458),_0xc9602[_0x34142f(0x13f)](_0x34142f(0x265))?{'allow':!![],'reason':_0x34142f(0x150),'token':_0x1bb726}:{'allow':![],'reason':_0x34142f(0x1da),'token':null};}else return{'allow':!![],'reason':_0x34142f(0x138),'token':null};};if(settings['whitelistEnabled']){let _0x42fa1f=[...settings['whitelist'],_0x575fdf(0x15a),'::ffff:127.0.0.1',_0x575fdf(0x159)];if(_0x42fa1f['includes'](_0xcb574e))return _0x313822(_0x98dabf);else{_0xc9602=validToken(_0x98dabf,_0xdea458);if(_0xc9602[_0x575fdf(0x13f)]('success'))return _0x313822(_0x98dabf);else{if(telegramIpApproved(_0xdea458)){const _0x456211=generateToken(_0xdea458);return _0xc9602=_0x313822(_0x98dabf),_0xc9602['allow']?{'allow':!![],'reason':_0x575fdf(0x130),'token':_0x456211}:_0xc9602;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x575fdf(0x1b4),'token':null}:{'allow':![],'reason':_0x575fdf(0x1d1),'token':null};}}}else return _0x313822(_0x98dabf);}function timelyDecrypt(_0x517750,_0x53d75f=!![]){const _0x557fbb=_0x286fd3;if(_0x517750)try{const _0x4b5b26=crypt[_0x557fbb(0x25a)](secure['privateKey'],_0x517750)[_0x557fbb(0x1cc)],_0x47b7c7=_0x4b5b26[_0x557fbb(0x182)]('@')[0x0],_0x59ad30=_0x4b5b26[_0x557fbb(0x182)]('@')[0x1],_0x544138=new Date()[_0x557fbb(0x213)]();if(_0x53d75f){if(_0x544138-_0x59ad30<maxSecretAge*0x3e8)return _0x47b7c7;else return![];}else return _0x47b7c7;}catch(_0x339e34){return![];}else return![];}const validToken=(_0x2faa5b,_0x13f7c8)=>{const _0x3c39bd=_0x286fd3,_0x145a9d=devices[_0x13f7c8]['ip'];if(!_0x2faa5b)return{'error':_0x3c39bd(0x253)};for(let _0x328ad9 of blacklist){if(_0x328ad9['token']==_0x2faa5b)return{'error':_0x3c39bd(0x123)};}let _0x5c3dc6;try{_0x5c3dc6=jwt[_0x3c39bd(0x238)](_0x2faa5b,secure[_0x3c39bd(0x178)]+_0x13f7c8);}catch{return{'error':_0x3c39bd(0x1f2)};}if(!_0x5c3dc6[_0x3c39bd(0x13f)](_0x3c39bd(0x26d))&&!_0x5c3dc6[_0x3c39bd(0x13f)](_0x3c39bd(0x1b6))||!_0x5c3dc6[_0x3c39bd(0x13f)](_0x3c39bd(0x1b5)))return{'error':_0x3c39bd(0x1db)};if(!_0x5c3dc6[_0x3c39bd(0x13f)](_0x3c39bd(0x1b6))&&_0x5c3dc6[_0x3c39bd(0x13f)](_0x3c39bd(0x26d))){const {clientip:_0x4fc367}=_0x5c3dc6;return _0x145a9d==_0x4fc367?{'success':_0x3c39bd(0x1c7)}:{'error':_0x3c39bd(0x194)};}else{if(_0x5c3dc6['hasOwnProperty']('username')&&_0x5c3dc6['hasOwnProperty'](_0x3c39bd(0x26d))){const {username:_0x447844,clientip:_0x2637ae}=_0x5c3dc6;return settings['bbUsername']==_0x447844&&_0x145a9d==_0x2637ae?{'success':_0x3c39bd(0x1c7)}:{'error':_0x3c39bd(0x196)};}}},generateLoginToken=_0x22ac6f=>{const _0x25b467=_0x286fd3;if(_0x22ac6f){const _0xc4ac4f=devices[_0x22ac6f]['ip'];return jwt[_0x25b467(0x15c)]({'username':settings[_0x25b467(0x193)],'clientip':_0xc4ac4f},secure['secret']+_0x22ac6f,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x5a94fb=>{const _0x3af035=_0x286fd3;if(_0x5a94fb){const _0x4a8f51=devices[_0x5a94fb]['ip'];return jwt[_0x3af035(0x15c)]({'clientip':_0x4a8f51},secure['secret']+_0x5a94fb,{'expiresIn':devices[_0x5a94fb]['telegramIpApproval'][_0x3af035(0x166)]*0x3c});}else return![];},telegramIpApproved=_0xcd4bb6=>{const _0x3b9e32=_0x286fd3;let _0x546285=![];return devices[_0xcd4bb6]['telegramIpApproval']&&devices[_0xcd4bb6][_0x3b9e32(0x236)][_0x3b9e32(0x166)]!=_0x3b9e32(0x199)&&(_0x546285=devices[_0xcd4bb6][_0x3b9e32(0x236)][_0x3b9e32(0x26d)]==devices[_0xcd4bb6]['ip']&&new Date()[_0x3b9e32(0x213)]()-devices[_0xcd4bb6][_0x3b9e32(0x236)][_0x3b9e32(0x261)]<devices[_0xcd4bb6][_0x3b9e32(0x236)][_0x3b9e32(0x166)]*0x3c*0x3e8),_0x546285;},telegram2FaApproved=_0xd407b2=>{const _0x1a2fbc=_0x286fd3;let _0x2501db=![];return devices[_0xd407b2]['telegram2FaApproval']&&devices[_0xd407b2]['telegram2FaApproval'][_0x1a2fbc(0x166)]!=_0x1a2fbc(0x199)&&(_0x2501db=devices[_0xd407b2][_0x1a2fbc(0x1be)][_0x1a2fbc(0x26d)]==devices[_0xd407b2]['ip']&&new Date()[_0x1a2fbc(0x213)]()-devices[_0xd407b2]['telegram2FaApproval'][_0x1a2fbc(0x261)]<devices[_0xd407b2]['telegram2FaApproval'][_0x1a2fbc(0x166)]*0x3c*0x3e8),_0x2501db;},normalizeIP=_0x3ddc01=>{const _0x27dd21=_0x286fd3;let _0x577a1a=null,_0x1ee23e=null;if(ipaddr[_0x27dd21(0x18d)](_0x3ddc01)){const _0x22694d=ipaddr[_0x27dd21(0x147)](_0x3ddc01);_0x22694d[_0x27dd21(0x128)]()===_0x27dd21(0x1ba)?(_0x22694d[_0x27dd21(0x1c4)]()&&(_0x577a1a=_0x22694d[_0x27dd21(0x214)]()['toString']()),_0x1ee23e=_0x22694d[_0x27dd21(0x25c)]()):(_0x577a1a=_0x22694d[_0x27dd21(0x25c)](),_0x1ee23e=_0x22694d[_0x27dd21(0x148)]()[_0x27dd21(0x25c)]());}return{'show':_0x577a1a?_0x577a1a:_0x1ee23e,'store':_0x1ee23e};};