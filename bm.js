const _0x309369=_0x1a18;function _0x1a18(_0x47449e,_0x5b18cd){const _0x301142=_0x25dc();return _0x1a18=function(_0x5192bf,_0x336914){_0x5192bf=_0x5192bf-0xfe;let _0x25dc69=_0x301142[_0x5192bf];return _0x25dc69;},_0x1a18(_0x47449e,_0x5b18cd);}(function(_0x423ef5,_0x8d6862){const _0x53be22=_0x1a18,_0x224773=_0x423ef5();while(!![]){try{const _0x5c177e=-parseInt(_0x53be22(0x1ad))/0x1+parseInt(_0x53be22(0x10a))/0x2+parseInt(_0x53be22(0x214))/0x3+-parseInt(_0x53be22(0x200))/0x4+-parseInt(_0x53be22(0x1a9))/0x5*(-parseInt(_0x53be22(0x1ed))/0x6)+-parseInt(_0x53be22(0x111))/0x7*(parseInt(_0x53be22(0x128))/0x8)+-parseInt(_0x53be22(0x10d))/0x9*(-parseInt(_0x53be22(0x1e3))/0xa);if(_0x5c177e===_0x8d6862)break;else _0x224773['push'](_0x224773['shift']());}catch(_0x369ff9){_0x224773['push'](_0x224773['shift']());}}}(_0x25dc,0x82d9e));const _0x336914=function(){let _0x55cc58=!![];return function(_0x1086a2,_0x25c2b3){const _0x898186=_0x55cc58?function(){if(_0x25c2b3){const _0x49eeef=_0x25c2b3['apply'](_0x1086a2,arguments);return _0x25c2b3=null,_0x49eeef;}}:function(){};return _0x55cc58=![],_0x898186;};}(),_0x5192bf=_0x336914(this,function(){const _0x51d36f=_0x1a18;return _0x5192bf[_0x51d36f(0x1c8)]()['search'](_0x51d36f(0x198))[_0x51d36f(0x1c8)]()['constructor'](_0x5192bf)[_0x51d36f(0x10f)]('(((.+)+)+)+$');});_0x5192bf();'use strict';process[_0x309369(0x1f7)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x309369(0x191)),FileSync=require(_0x309369(0x154)),fs=require('fs'),fns=require(_0x309369(0x16a)),low=require('lowdb'),path=require('path'),crypto=require(_0x309369(0x117)),Crypt=require(_0x309369(0x159))[_0x309369(0x113)],RSA=require(_0x309369(0x159))[_0x309369(0x1b7)],bcrypt=require(_0x309369(0x20f)),jwt=require(_0x309369(0x13d)),analyticsLib=require(_0x309369(0x1f1))['default'],googleAnalytics=require('@analytics/google-analytics')[_0x309369(0x1df)],ipaddr=require(_0x309369(0x129)),argv=require(_0x309369(0x1b0))(process[_0x309369(0x1c1)]['slice'](0x2))[_0x309369(0x1c1)],PORT=argv[_0x309369(0x101)]||_0x309369(0x17d),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x309369(0x21f)](PORT))return console[_0x309369(0x1cd)](_0x309369(0x149)+PORT+_0x309369(0x119)),process[_0x309369(0x13b)](0x1);const HOST=argv['host']||null,userID=argv[_0x309369(0x1cc)]||'';let bbpath=_0x309369(0x22c),bbpath2='';const botfile=_0x309369(0x1f6),configfile=_0x309369(0x20d),settingsfile='bb-settings.json',securefile=_0x309369(0x169);!fs[_0x309369(0x1a2)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x309369(0x1b1)),configpath=userID?bbpath+_0x309369(0x1fb)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x309369(0x1c3);!fs['existsSync'](configpath)&&fs[_0x309369(0x1b3)](configpath);!fs[_0x309369(0x1a2)](configbackuppath)&&fs[_0x309369(0x1b3)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x309369(0x123)]({'bots':[]})[_0x309369(0x11f)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);function _0x25dc(){const _0x44163b=['Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','3926984nhiXQt','get-starting-balances','update-bb','https://hodlerhacks.com','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Bot\x20','padStart','storeConfiguration','Unauthorized\x20attempt\x20to\x20update\x20settings','encryptedUuid','/enable\x20-\x20enable\x20notifications\x0a','2FA','Ok,\x20will\x20send\x20alert\x20notifications\x20only','bb-config.json','sockets','bcryptjs','Notifications\x20enabled\x0a','access','whitelistEnabled','logged\x20out','322608nZsAfW','isIPv4MappedAddress','timestamp','message','answerCallbackQuery','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','length','getFullYear','secure','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Password\x20has\x20been\x20reset\x20to:\x20','test','data','getMinutes','Invalid\x20authentication\x20token\x20(1)','temporaryAccessAllowed','status','bot-','static','max','add-bot','Allow\x20login\x20from\x20IP\x20address\x20<b>','isValid','whitelist','bb/','node-telegram-bot-api','Password\x20reset\x20rejected','Unauthorized\x20attempt\x20to\x20get\x20portfolio','UA-192771731-1','f2aRequired','callback_query','build2','/status\x20-\x20show\x20bot(s)\x20status\x0a','pidExpireLogin','404\x20Not\x20Found','enabled\x20Bot\x20','2FA\x20required','get-logs','chat','order','parse','Unauthorized\x20attempt\x20to\x20get\x20logs','compareSync','bot','login\x20token\x20generated','getDate','new','port','blacklist','value','settings','build','Invalid\x20Telegram\x20token','Unauthorized\x20attempt\x20to\x20add\x20bot','telegramChatId','exp','1839530pQVvpx','args','removeListener','1376064WUHyRV','index.html','search','add','1791811BhctDL','bots','Crypt','uuid','ipv6','/:bot/performance','crypto','event',',\x20must\x20be\x20a\x204\x20digit\x20number','telegramEvents','reload','No\x20authentication\x20token','/:bot/coins','disabled\x20Bot\x20','write','::ffff:127.0.0.1','temporary\x20access\x20rejected','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','defaults','split','remove','starting\x20new\x20bot\x20|\x20Bot\x20','loginRequired','16jIkyJI','ipaddr.js','telegramUsername','15\x20min','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','hasOwnProperty','use','All\x20bots\x20running\x20right\x20now','error','sortBy','join','</b>\x20?','Unauthorized\x20attempt\x20to\x20store\x20configuration','Unauthorized\x20attempt\x20to\x20update\x20bot','Ok,\x20will\x20send\x20order\x20notifications\x20only','cloneDeep','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','exit','get-portfolio','jsonwebtoken','orders','store','access\x20timeout','telegramIpApproval','restart','All\x20bots','hex','bbUsername','Invalid\x20IP\x20address','http','filter','Error:\x20Invalid\x20argument\x20','2FA\x20login\x20token\x20generated','/:bot/configuration','1000','2FA\x20login\x20rejected','Alerts','sign','-results.json','password','botmanager','listen','lowdb/adapters/FileSync','success','/help\x20-\x20show\x20available\x20commands\x0a','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','catch','hybrid-crypto-js','accept','new-disabled','************','\x20|\x20','-config.json','getHours','apiKey','headers','push','Balance\x20Bot','SIGTERM','alerts','disabled','Temporary\x20access\x20rejected','then','bb-secure.json','date-fns','assign','type','version','getTime','randomFillSync','function','getUTCHours','allow','version.json','pidRefreshToken','emitHistory','<b>Telegram\x20bot\x20status:</b>\x0a','notification','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','getMonth','/:bot/history','name','telegramEnabled','3000','/:bot/portfolio','logout','secret','reject','publicKey','Notifications\x20disabled\x0a','started','login\x20required','copyFileSync','yes','sha256','Unauthorized\x20attempt\x20to\x20log\x20out','verify','storeHeadless','getSeconds','kind','username','match','entries','child_process','get','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','hashSync','disconnect','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','invalid\x20credentials','(((.+)+)+)+$','unlinkSync','telegram','toIPv4Address','\x20minutes','token','login\x20not\x20required','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','HTML','connection','existsSync','inherit','fork','removeAllListeners','timeshift','Orders','bbPassword','1300pBEHNr','telegramToken','30\x20min','stopPolling','660147BYDipV','set','handshake','yargs/yargs','clients',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','mkdirSync','idling\x20bot\x20\x20\x20|\x20Bot\x20','Access\x20enabled\x20for\x20','-----------------------------------------------------------------------------------','RSA','2FA\x20login\x20required','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','sendMessage','all','createServer','send','clientip','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','reason','argv','kill','backup/','store-configuration','store-headless','getPortfolio','getStartingBalances','toString','generateKeyPairAsync','\x20only\x0a','enabled','user','log','botname','temporary\x20token\x20generated','update-bot','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Bot\x20Mgr\x20>\x20','sendFile','-events.json','Login\x20rejected','show','\x20/\x20','/disable\x20-\x20disable\x20notifications\x0a','User\x20has\x20been\x20validated','delete-bot','botID','telegram2FaApproval','-performance.json','temporary\x20access\x20timeout','default','<b>Balance\x20Bot\x20status:</b>\x0a','map','decrypt','40nAkEYe','You\x20can\x20use\x20the\x20following\x20commands:\x0a','live','find','forEach','remoteAddress','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','onText','\x20>\x20','referer','24252CNAvda','No\x20bots\x20running\x20right\x20now','settings.','stop','analytics','from','expiry','stopped','privateKey','bot.js','env','Unauthorized\x20login\x20attempt\x20(timeout)','emit','login','config/','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','auth','error\x20while\x20deleting\x20config\x20files:\x20'];_0x25dc=function(){return _0x44163b;};return _0x25dc();}dbSettings['defaults']({'settings':{'timeshift':0x0}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x309369(0x123)]({'secure':{},'blacklist':[]})[_0x309369(0x11f)]();let crypt=new Crypt({'md':_0x309369(0x188),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x309369(0x173))[_0x309369(0x16d)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];oneTimeMigration(),cleanBlacklist();const express=require('express'),app=express(),http=require(_0x309369(0x147))[_0x309369(0x1bc)](app);app[_0x309369(0x130)](express[_0x309369(0x226)](path[_0x309369(0x134)](__dirname,bbpath2,_0x309369(0x233)))),app['use'](express[_0x309369(0x226)](path[_0x309369(0x134)](__dirname,bbpath2,'build'))),app[_0x309369(0x192)]('/',function(_0x340ba7,_0x114bae){const _0x2ddff7=_0x309369;_0x114bae[_0x2ddff7(0x1d3)](path['join'](__dirname,bbpath2,_0x2ddff7(0x233),_0x2ddff7(0x10e)));}),app[_0x309369(0x192)]('/:bot',function(_0x4c793e,_0xb9a1fa){const _0x2872c5=_0x309369;_0xb9a1fa['sendFile'](path['join'](__dirname,bbpath2,'build',_0x2872c5(0x10e)));}),app['get'](_0x309369(0x17e),(_0x15265e,_0x197bde)=>{const _0x15f01d=_0x309369;_0x197bde['sendFile'](path['join'](__dirname,bbpath2,_0x15f01d(0x105),_0x15f01d(0x10e)));}),app['get'](_0x309369(0x116),(_0x26e1ce,_0x193ef5)=>{const _0x2d2ec8=_0x309369;_0x193ef5[_0x2d2ec8(0x1d3)](path['join'](__dirname,bbpath2,_0x2d2ec8(0x105),_0x2d2ec8(0x10e)));}),app['get'](_0x309369(0x11d),(_0xc5f676,_0x113c5a)=>{const _0x488977=_0x309369;_0x113c5a[_0x488977(0x1d3)](path[_0x488977(0x134)](__dirname,bbpath2,_0x488977(0x105),_0x488977(0x10e)));}),app[_0x309369(0x192)](_0x309369(0x17a),(_0x2cc794,_0x1d5820)=>{const _0x4d80d3=_0x309369;_0x1d5820[_0x4d80d3(0x1d3)](path[_0x4d80d3(0x134)](__dirname,bbpath2,_0x4d80d3(0x105),_0x4d80d3(0x10e)));}),app[_0x309369(0x192)](_0x309369(0x14b),(_0x6d1675,_0x25dfad)=>{const _0x4a881f=_0x309369;_0x25dfad[_0x4a881f(0x1d3)](path[_0x4a881f(0x134)](__dirname,bbpath2,_0x4a881f(0x105),_0x4a881f(0x10e)));}),app[_0x309369(0x192)]('/:bot/support',(_0x41600f,_0x126e38)=>{const _0x17bdf1=_0x309369;_0x126e38['sendFile'](path[_0x17bdf1(0x134)](__dirname,bbpath2,_0x17bdf1(0x105),_0x17bdf1(0x10e)));});if(HOST)http[_0x309369(0x153)](PORT,HOST);else http[_0x309369(0x153)](PORT);const io=require('socket.io')(http,{}),analytics=analyticsLib({'app':_0x309369(0x163),'plugins':[googleAnalytics({'trackingId':_0x309369(0x230)})]}),TelegramBot=require(_0x309369(0x22d));let tgBot;if(settings[_0x309369(0x1aa)]&&settings[_0x309369(0x1aa)]!=''&&settings['telegramUsername']&&settings[_0x309369(0x12a)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x401350=_0x309369;console['log'](''),console[_0x401350(0x1cd)]('-----------------------------------------------------------------------------------'),logging('Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:'+PORT),console[_0x401350(0x1cd)](_0x401350(0x1b6));if(config[_0x401350(0x21a)]!=0x0)config['forEach'](_0x535fa0=>{const _0x7c0375=_0x401350;if(_0x535fa0['status']=='enabled'||_0x535fa0['status']==_0x7c0375(0x100))logging('starting\x20bot\x20|\x20Bot\x20'+_0x535fa0[_0x7c0375(0x1db)]+_0x7c0375(0x15d)+_0x535fa0[_0x7c0375(0x1ce)]),startBot([_0x535fa0[_0x7c0375(0x1db)],userID],{'cwd':bbpath},function(_0x4226de){if(_0x4226de)logging(_0x4226de);});else(_0x535fa0[_0x7c0375(0x224)]==_0x7c0375(0x166)||_0x535fa0[_0x7c0375(0x224)]=='new-disabled')&&logging(_0x7c0375(0x1b4)+_0x535fa0[_0x7c0375(0x1db)]+'\x20|\x20'+_0x535fa0[_0x7c0375(0x1ce)]);});else!newBot&&console[_0x401350(0x1cd)](_0x401350(0x196));if(newBot)addBot();console['log'](_0x401350(0x1b6)),console[_0x401350(0x1cd)]('');}function startSocket(){const _0x8f86d6=_0x309369;io['on'](_0x8f86d6(0x1a1),_0x30e36b=>{const _0x3b1f07=_0x8f86d6;let _0xfa6170,_0x6c8f73,_0x12a7c9,_0x469e0a,_0xaf25f8;const _0x44d5ea=_0x30e36b[_0x3b1f07(0x1af)][_0x3b1f07(0x161)][_0x3b1f07(0x1ec)];_0x6c8f73=_0x44d5ea[_0x3b1f07(0x18f)](/bot[0-9]{3}/);if(_0x6c8f73)_0x12a7c9=_0x6c8f73[0x0][_0x3b1f07(0x18f)](/[0-9]{3}/);if(_0x12a7c9)_0xfa6170=_0x12a7c9[0x0];else _0xfa6170=_0x3b1f07(0x152);const _0x33e361=_0x30e36b[_0x3b1f07(0x1af)][_0x3b1f07(0x1fd)][_0x3b1f07(0x209)];if(!_0x33e361)_0x30e36b[_0x3b1f07(0x1f9)](_0x3b1f07(0x224),{'publicKey':secure[_0x3b1f07(0x182)]});else{_0x469e0a=timelyDecrypt(_0x33e361,![]);if(!_0x469e0a)_0x30e36b[_0x3b1f07(0x1f9)](_0x3b1f07(0x224),{'publicKey':secure[_0x3b1f07(0x182)]});else{_0xaf25f8=normalizeIP(_0x30e36b['conn'][_0x3b1f07(0x1e8)])[_0x3b1f07(0x13f)];if(!devices[_0x469e0a])devices[_0x469e0a]={'uuid':_0x469e0a,'access':{'token':null}};devices[_0x469e0a]['ip']=_0xaf25f8;const _0xea3f99=addClient(_0x30e36b['id'],_0x469e0a,_0xfa6170);setAccess(_0xea3f99),_0x30e36b['on']('login',_0x314fa1=>{const _0x1a5856=_0x3b1f07,_0x240ebf=timelyDecrypt(_0x314fa1[_0x1a5856(0x151)]);if(_0x240ebf){_0x314fa1={'username':_0x314fa1[_0x1a5856(0x18e)],'password':_0x240ebf},devices[_0x469e0a][_0x1a5856(0x211)]=validateCredentials(_0x314fa1,_0x469e0a);if(devices[_0x469e0a]['access'][_0x1a5856(0x172)]==![]&&devices[_0x469e0a][_0x1a5856(0x211)][_0x1a5856(0x1c0)]==_0x1a5856(0x1b8))_0x30e36b[_0x1a5856(0x1f9)](_0x1a5856(0x224),{'access':devices[_0x469e0a][_0x1a5856(0x211)]}),loginAccess2FA(_0x469e0a,_0xaf25f8);else{if(devices[_0x469e0a][_0x1a5856(0x211)][_0x1a5856(0x172)]==![]&&devices[_0x469e0a][_0x1a5856(0x211)]['reason']==_0x1a5856(0x197))_0x30e36b[_0x1a5856(0x1f9)](_0x1a5856(0x224),{'access':devices[_0x469e0a][_0x1a5856(0x211)]});else devices[_0x469e0a]['access']['allow']&&devices[_0x469e0a][_0x1a5856(0x211)]['reason']==_0x1a5856(0xfe)&&(getClientsWithUuid(_0x469e0a)[_0x1a5856(0x1e7)](_0x4f05b2=>{setAccess(_0x4f05b2);}),setTokenRefresh(_0x469e0a),setSessionTimeout(_0x1a5856(0x1fa),_0x469e0a));}}else logging(_0x1a5856(0x1f8));}),_0x30e36b['on']('reset-password',()=>{resetPassword();}),_0x30e36b['on'](_0x3b1f07(0x195),_0x3597ed=>{removeClient(_0x30e36b['id']);});}}});}function initClient(_0x5da0b8){const _0x460a80=_0x309369;if(_0x5da0b8!=_0x460a80(0x152)&&config[_0x460a80(0x160)]!=''){if(pid[_0x5da0b8])pid[_0x5da0b8][_0x460a80(0x1bd)]({'function':'initclient','args':null});}}function getSocket(_0x468377){const _0x28b5e4=_0x309369;return io[_0x28b5e4(0x20e)][_0x28b5e4(0x20e)][_0x28b5e4(0x192)](_0x468377);}function setAccess(_0x295e58){const _0x1408b9=_0x309369,_0x205083=getSocket(_0x295e58['id']),_0xadc30a=_0x295e58[_0x1408b9(0x114)],_0x5214d3=_0x295e58[_0x1408b9(0x23f)];devices[_0xadc30a][_0x1408b9(0x211)]=validateAccess(devices[_0xadc30a][_0x1408b9(0x211)][_0x1408b9(0x19d)],_0xadc30a),_0x205083['join'](_0xadc30a);if(devices[_0xadc30a][_0x1408b9(0x211)][_0x1408b9(0x172)]){_0x205083[_0x1408b9(0x134)](_0x5214d3);if(_0x5214d3==_0x1408b9(0x152))initializeSocketBotManager(_0x205083);else initializeSocketBot(_0x205083);initClient(_0x5214d3);}devices[_0xadc30a][_0x1408b9(0x211)][_0x1408b9(0x19d)]&&devices[_0xadc30a]['access'][_0x1408b9(0x1c0)]==_0x1408b9(0x1cf)&&setSessionTimeout(_0x1408b9(0x20b),_0xadc30a),devices[_0xadc30a][_0x1408b9(0x211)][_0x1408b9(0x19d)]&&devices[_0xadc30a][_0x1408b9(0x211)][_0x1408b9(0x1c0)]==_0x1408b9(0x14a)&&setSessionTimeout(_0x1408b9(0x1fa),_0xadc30a),_0x205083[_0x1408b9(0x1f9)](_0x1408b9(0x224),{'status':_0x295e58['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0xadc30a]['access'],'externalip':devices[_0xadc30a]['ip'],'publicKey':secure['publicKey']}),devices[_0xadc30a][_0x1408b9(0x211)][_0x1408b9(0x172)]==![]&&devices[_0xadc30a][_0x1408b9(0x211)][_0x1408b9(0x1c0)]=='2FA\x20required'&&temporaryAccess2FA(_0xadc30a,devices[_0xadc30a]['ip']);}function setSessionTimeout(_0x5ea15f,_0x385dfe){const _0x1f6677=_0x309369;let _0x177f0d;if(_0x5ea15f==_0x1f6677(0x1fa))_0x177f0d=loginExpiry*0x3c*0x3e8;else _0x177f0d=devices[_0x385dfe][_0x1f6677(0x141)][_0x1f6677(0x1f3)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x385dfe][_0x1f6677(0x141)][_0x1f6677(0x216)]);if(devices[_0x385dfe][_0x1f6677(0x235)])clearTimeout(devices[_0x385dfe]['pidExpireLogin']);devices[_0x385dfe][_0x1f6677(0x235)]=setTimeout(()=>{const _0x26a3ec=_0x1f6677;if(devices[_0x385dfe]['pidRefreshToken'])clearTimeout(devices[_0x385dfe][_0x26a3ec(0x174)]);removeSocketListeners(_0x385dfe),addBlacklist(_0x385dfe),devices[_0x385dfe]['telegramIpApproval']=null,devices[_0x385dfe]['telegram2FaApproval']=null,devices[_0x385dfe][_0x26a3ec(0x211)][_0x26a3ec(0x19d)]=null,devices[_0x385dfe]['access']=validateAccess(devices[_0x385dfe][_0x26a3ec(0x211)][_0x26a3ec(0x19d)],_0x385dfe),!(devices[_0x385dfe][_0x26a3ec(0x211)][_0x26a3ec(0x172)]&&devices[_0x385dfe][_0x26a3ec(0x211)][_0x26a3ec(0x1c0)]==_0x26a3ec(0x19e))&&(_0x5ea15f==_0x26a3ec(0x1fa)?io['to'](_0x385dfe)['emit'](_0x26a3ec(0x224),{'access':{'allow':![],'reason':_0x26a3ec(0x140),'token':null}}):io['to'](_0x385dfe)['emit'](_0x26a3ec(0x224),{'access':{'allow':![],'reason':_0x26a3ec(0x1de),'token':null}})),devices[_0x385dfe][_0x26a3ec(0x211)][_0x26a3ec(0x19d)]=null;},_0x177f0d);}function setTokenRefresh(_0x5c7fde){const _0x454798=_0x309369;if(devices[_0x5c7fde][_0x454798(0x174)])clearTimeout(devices[_0x5c7fde]['pidRefreshToken']);devices[_0x5c7fde][_0x454798(0x174)]=setTimeout(()=>{const _0x312ee1=_0x454798;getClientsWithUuid(_0x5c7fde)[_0x312ee1(0x21a)]!=0x0?(devices[_0x5c7fde][_0x312ee1(0x211)]=refreshToken(_0x5c7fde),io['to'](_0x5c7fde)[_0x312ee1(0x1f9)](_0x312ee1(0x224),{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x5c7fde]['access'],'externalip':devices[_0x5c7fde]['ip'],'publicKey':secure[_0x312ee1(0x182)]}),setTokenRefresh(_0x5c7fde)):clearTimeout(devices[_0x5c7fde][_0x312ee1(0x174)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x51fe16){const _0x627d22=_0x309369,_0x3f0542=getClient(_0x51fe16['id'])[_0x627d22(0x114)];_0x51fe16['emit'](_0x627d22(0x112),config),_0x51fe16[_0x627d22(0x1f9)](_0x627d22(0x104),cleanSettings()),_0x51fe16['on'](_0x627d22(0x228),_0x172201=>{const _0x5ad71a=_0x627d22;if(validateAccess(_0x172201,_0x3f0542)['allow'])addBot();else logging(_0x5ad71a(0x107));}),_0x51fe16['on'](_0x627d22(0x1d0),(_0x2411f1,_0x17d65c)=>{const _0x4c37c0=_0x627d22;if(validateAccess(_0x17d65c,_0x3f0542)[_0x4c37c0(0x172)])toggleBot(_0x2411f1[_0x4c37c0(0x1db)],_0x2411f1[_0x4c37c0(0x224)],_0x2411f1[_0x4c37c0(0x1e5)]);else logging(_0x4c37c0(0x137));}),_0x51fe16['on'](_0x627d22(0x1da),(_0x5ea6c2,_0xa08dd3)=>{if(validateAccess(_0xa08dd3,_0x3f0542)['allow'])deleteBot(_0x5ea6c2);else logging('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x51fe16['on']('store-settings',(_0x1912a5,_0x5f0892)=>{const _0xf136a3=_0x627d22;if(validateAccess(_0x5f0892,_0x3f0542)[_0xf136a3(0x172)])storeSettings(_0x1912a5,!![]);else logging('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x51fe16['on'](_0x627d22(0x202),(_0x48612c,_0x34fb9f)=>{const _0x12617f=_0x627d22;if(validateAccess(_0x34fb9f,_0x3f0542)[_0x12617f(0x172)])updateBB();else logging(_0x12617f(0x208));}),_0x51fe16['on'](_0x627d22(0x17f),_0x1c5e8b=>{const _0x406aeb=_0x627d22;if(validateAccess(_0x1c5e8b,_0x3f0542)[_0x406aeb(0x172)]){if(devices[_0x3f0542][_0x406aeb(0x174)])clearTimeout(devices[_0x3f0542]['pidRefreshToken']);if(devices[_0x3f0542][_0x406aeb(0x235)])clearTimeout(devices[_0x3f0542][_0x406aeb(0x235)]);removeSocketListeners(getClient(_0x51fe16['id'])[_0x406aeb(0x114)]),addBlacklist(_0x3f0542),devices[_0x3f0542][_0x406aeb(0x141)]=null,devices[_0x3f0542][_0x406aeb(0x1dc)]=null,devices[_0x3f0542][_0x406aeb(0x211)][_0x406aeb(0x19d)]=null,io['to'](getClient(_0x51fe16['id'])[_0x406aeb(0x114)])[_0x406aeb(0x1f9)]('status',{'access':{'allow':![],'reason':_0x406aeb(0x213),'token':null}});}else logging(_0x406aeb(0x189));});}function initializeSocketBot(_0x3bf1f2){const _0x28bb51=_0x309369,_0xf07a7b=getClient(_0x3bf1f2['id'])[_0x28bb51(0x23f)],_0x58efd1=getClient(_0x3bf1f2['id'])['uuid'];_0x3bf1f2['on'](_0x28bb51(0x239),(_0x4d5ddf,_0x4839d3)=>{const _0x1734f7=_0x28bb51;if(validateAccess(_0x4839d3,_0x58efd1)[_0x1734f7(0x172)]){if(pid[_0xf07a7b])pid[_0xf07a7b][_0x1734f7(0x1bd)]({'function':_0x1734f7(0x175),'args':_0x4d5ddf});}else logging(_0x1734f7(0x23d));}),_0x3bf1f2['on'](_0x28bb51(0x13c),(_0x6f07d0,_0x484eee)=>{const _0x157a1b=_0x28bb51;if(validateAccess(_0x484eee,_0x58efd1)[_0x157a1b(0x172)]){if(pid[_0xf07a7b])pid[_0xf07a7b][_0x157a1b(0x1bd)]({'function':_0x157a1b(0x1c6),'args':_0x6f07d0});}else logging(_0x157a1b(0x22f));}),_0x3bf1f2['on'](_0x28bb51(0x1c4),(_0x51d5de,_0x5d11a8)=>{const _0x310193=_0x28bb51;if(validateAccess(_0x5d11a8,_0x58efd1)[_0x310193(0x172)]){if(pid[_0xf07a7b])pid[_0xf07a7b][_0x310193(0x1bd)]({'function':_0x310193(0x207),'args':_0x51d5de});}else logging(_0x310193(0x136));}),_0x3bf1f2['on'](_0x28bb51(0x1c5),(_0xf8f3b8,_0x1ea3fc)=>{const _0x2ab432=_0x28bb51;if(validateAccess(_0x1ea3fc,_0x58efd1)[_0x2ab432(0x172)]){if(pid[_0xf07a7b])pid[_0xf07a7b][_0x2ab432(0x1bd)]({'function':_0x2ab432(0x18b),'args':_0xf8f3b8});}else logging(_0x2ab432(0x1fc));}),_0x3bf1f2['on'](_0x28bb51(0x201),_0x306ae4=>{const _0x24af68=_0x28bb51;if(validateAccess(_0x306ae4,_0x58efd1)['allow']){if(pid[_0xf07a7b])pid[_0xf07a7b][_0x24af68(0x1bd)]({'function':_0x24af68(0x1c7),'args':null});}else logging(_0x24af68(0x13a));}),_0x3bf1f2['on']('place-order',(_0x4a506d,_0x360ef4)=>{const _0x493c23=_0x28bb51;if(validateAccess(_0x360ef4,_0x58efd1)['allow']){if(pid[_0xf07a7b])pid[_0xf07a7b][_0x493c23(0x1bd)]({'function':'placeOrder','args':_0x4a506d});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x3bf1f2['on']('cancel-loading',_0x1baae0=>{const _0x30ea65=_0x28bb51;if(validateAccess(_0x1baae0,_0x58efd1)[_0x30ea65(0x172)]){if(pid[_0xf07a7b])pid[_0xf07a7b][_0x30ea65(0x1bd)]({'function':'cancelLoading','args':null});}else logging('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x3bf1f2['on']('logout',_0x3681e3=>{const _0x303a30=_0x28bb51;if(validateAccess(_0x3681e3,_0x58efd1)[_0x303a30(0x172)]){if(devices[_0x58efd1][_0x303a30(0x174)])clearTimeout(devices[_0x58efd1][_0x303a30(0x174)]);if(devices[_0x58efd1]['pidExpireLogin'])clearTimeout(devices[_0x58efd1]['pidExpireLogin']);removeSocketListeners(getClient(_0x3bf1f2['id'])[_0x303a30(0x114)]),addBlacklist(_0x58efd1),devices[_0x58efd1][_0x303a30(0x141)]=null,devices[_0x58efd1][_0x303a30(0x1dc)]=null,devices[_0x58efd1][_0x303a30(0x211)][_0x303a30(0x19d)]=null,io['to'](getClient(_0x3bf1f2['id'])[_0x303a30(0x114)])['emit']('status',{'access':{'allow':![],'reason':_0x303a30(0x213),'token':null}});}else logging(_0x303a30(0x189));});}function removeSocketListeners(_0x5d3224){const _0x5875c4=_0x309369;getClientsWithUuid(_0x5d3224)[_0x5875c4(0x1e7)](_0x5e0fb6=>{const _0x40db80=_0x5875c4;getSocket(_0x5e0fb6['id'])[_0x40db80(0x1a5)]();});}function cleanSettings(){const _0x38f255=_0x309369;let _0xcbb84f=settings;return settings[_0x38f255(0x1aa)]&&settings[_0x38f255(0x1aa)]!=''&&(_0xcbb84f={..._0xcbb84f,'telegramToken':_0x38f255(0x15c)}),settings[_0x38f255(0x1a8)]&&settings['bbPassword']!=''&&(_0xcbb84f={..._0xcbb84f,'bbPassword':'************'}),_0xcbb84f;}function updateBB(){const _0x283477=_0x309369;installingUpdate=!![],config[_0x283477(0x1e7)](_0xd2eec=>{restartBot(_0xd2eec['botID']);}),process[_0x283477(0x1bd)]({'update':!![]},_0x3c573a=>{});}function startBot(_0x3b015f,_0x5a3e3c,_0x5ea161){const _0x112d19=_0x309369;let _0x1df89f=![];const _0x2d3d76=_0x3b015f[0x0];_0x5a3e3c={..._0x5a3e3c,'stdio':[_0x112d19(0x1a3),_0x112d19(0x1a3),_0x112d19(0x1a3),'ipc']},pid[_0x2d3d76]=childProcess[_0x112d19(0x1a4)](botfile,_0x3b015f,_0x5a3e3c),pid[_0x2d3d76]['on'](_0x112d19(0x217),_0x439007=>{const _0x220772=_0x112d19;switch(Object['keys'](_0x439007)[0x0]){case'botname':updateBotName(_0x2d3d76,_0x439007[_0x220772(0x1ce)]);break;case'status':updateStatus(_0x2d3d76,_0x439007['status']);break;case _0x220772(0x1e5):updateLive(_0x2d3d76,_0x439007['live']);break;case'started':updateLive(_0x2d3d76,_0x439007[_0x220772(0x184)]),io['to'](_0x2d3d76)[_0x220772(0x1f9)]('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x220772(0x1f0):_0x439007[_0x220772(0x1f0)]==_0x220772(0x142)&&restartBot(_0x2d3d76);_0x439007[_0x220772(0x1f0)]==_0x220772(0x1c2)&&toggleBot(_0x2d3d76,'disabled','stopped');break;case'telegram':sendTelegram(_0x2d3d76,_0x439007[_0x220772(0x19a)]);break;case _0x220772(0x170):io['to'](_0x2d3d76)[_0x220772(0x1f9)](_0x439007[_0x220772(0x170)],_0x439007[_0x220772(0x10b)]);break;}}),pid[_0x2d3d76]['on']('error',function(_0x71906e){if(_0x1df89f)return;_0x1df89f=!![],_0x5ea161(_0x71906e);}),pid[_0x2d3d76]['on']('exit',function(_0x1f29ee){const _0x4956f9=_0x112d19;if(installingUpdate)return;if(_0x1df89f)return;_0x1df89f=!![],_0x5ea161(null);const _0x2106e6=dbConfig[_0x4956f9(0x192)](_0x4956f9(0x112))[_0x4956f9(0x1e6)]({'botID':_0x2d3d76})['value']();_0x2106e6&&(_0x2106e6[_0x4956f9(0x224)]==_0x4956f9(0x1cb)||_0x2106e6['status']==_0x4956f9(0x100))&&(updateLive(_0x2d3d76,_0x4956f9(0x1f4)),logging('restarting\x20Bot\x20'+_0x2d3d76),startBot([_0x2d3d76,userID],{'cwd':bbpath},function(_0x310e3c){if(_0x310e3c)logging(_0x310e3c);}));});}function stopBot(_0x25a3ae){const _0x9dfb60=_0x309369;getClientsWithBotID(_0x25a3ae)[_0x9dfb60(0x1e7)](_0x1cac3e=>{const _0xa68c89=_0x9dfb60;getSocket(_0x1cac3e['id'])[_0xa68c89(0x195)](!![]),removeClient(_0x1cac3e['id']);});if(pid[_0x25a3ae])pid[_0x25a3ae][_0x9dfb60(0x1c2)]();}function restartBot(_0x3ad4a0){const _0x39700d=_0x309369;if(pid[_0x3ad4a0])pid[_0x3ad4a0][_0x39700d(0x1c2)]();}function addBot(){const _0x1e7ffd=_0x309369;let _0x365856;for(let _0x54a392=0x1;_0x54a392<0x3e9;_0x54a392++){_0x365856=_0x54a392[_0x1e7ffd(0x1c8)]()[_0x1e7ffd(0x206)](0x3,'0');let _0x15499f=config[_0x1e7ffd(0x1e6)](_0x215582=>_0x215582[_0x1e7ffd(0x1db)]==_0x365856);if(!_0x15499f)break;}if(_0x365856===_0x1e7ffd(0x14c)){logging('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logging(_0x1e7ffd(0x126)+_0x365856),dbConfig[_0x1e7ffd(0x192)](_0x1e7ffd(0x112))[_0x1e7ffd(0x162)]({'botID':_0x365856,'botname':'Bot\x20'+_0x365856,'status':_0x1e7ffd(0x100),'live':''})[_0x1e7ffd(0x11f)](),startBot([_0x365856,userID],{'cwd':bbpath},function(_0x1b0559){if(_0x1b0559)logging(_0x1b0559);}),config=getConfiguration(),io['to']('botmanager')[_0x1e7ffd(0x1f9)](_0x1e7ffd(0x112),config);}function deleteBot(_0x4784d8){const _0x469817=_0x309369;getClientsWithBotID(_0x4784d8)[_0x469817(0x1e7)](_0x94ac8c=>{const _0xbea09e=_0x469817;getSocket(_0x94ac8c['id'])[_0xbea09e(0x195)](!![]),removeClient(_0x94ac8c['id']);}),dbConfig[_0x469817(0x192)](_0x469817(0x112))[_0x469817(0x125)]({'botID':_0x4784d8})[_0x469817(0x11f)](),logging('deleted\x20Bot\x20'+_0x4784d8),stopBot(_0x4784d8);try{fs[_0x469817(0x199)](path[_0x469817(0x134)](configpath,'bot-'+_0x4784d8+_0x469817(0x15e))),fs[_0x469817(0x199)](path[_0x469817(0x134)](configpath,_0x469817(0x225)+_0x4784d8+_0x469817(0x1d4))),fs[_0x469817(0x199)](path[_0x469817(0x134)](configpath,_0x469817(0x225)+_0x4784d8+_0x469817(0x1dd))),fs[_0x469817(0x199)](path[_0x469817(0x134)](configpath,_0x469817(0x225)+_0x4784d8+_0x469817(0x150)));}catch(_0x3faa46){if(_0x3faa46)logging(_0x469817(0x1fe),_0x3faa46);}config=getConfiguration(),io['to'](_0x469817(0x152))[_0x469817(0x1f9)](_0x469817(0x112),config);}function toggleBot(_0x448629,_0x1d9d25,_0x520f5a){const _0x5c36fe=_0x309369;dbConfig[_0x5c36fe(0x192)](_0x5c36fe(0x112))[_0x5c36fe(0x1e6)]({'botID':_0x448629})[_0x5c36fe(0x16b)]({'status':_0x1d9d25})['assign']({'live':_0x520f5a})['write']();if(_0x1d9d25=='enabled'||_0x1d9d25=='new')logging(_0x5c36fe(0x237)+_0x448629),startBot([_0x448629,userID],{'cwd':bbpath},function(_0x3ca732){if(_0x3ca732)logging(_0x3ca732);});else(_0x1d9d25=='disabled'||_0x1d9d25=='new-disabled')&&(logging(_0x5c36fe(0x11e)+_0x448629),stopBot(_0x448629));config=getConfiguration(),io['to'](_0x5c36fe(0x152))[_0x5c36fe(0x1f9)]('bots',config);}function toggleStatus(_0x175dea){const _0x2eb147=_0x309369;let _0xa4e8ad=dbConfig[_0x2eb147(0x192)](_0x2eb147(0x112))['find']({'botID':_0x175dea})['value'](),_0x24ce14;if(_0xa4e8ad[_0x2eb147(0x224)]==='enabled')_0x24ce14=_0x2eb147(0x166);else{if(_0xa4e8ad[_0x2eb147(0x224)]==='new')_0x24ce14=_0x2eb147(0x15b);else{if(_0xa4e8ad[_0x2eb147(0x224)]===_0x2eb147(0x15b))_0x24ce14='new';else{if(_0xa4e8ad[_0x2eb147(0x224)]===_0x2eb147(0x166))_0x24ce14=_0x2eb147(0x1cb);}}}return _0x24ce14;}function updateStatus(_0x3d471e,_0x175783){const _0x5bc816=_0x309369;dbConfig[_0x5bc816(0x192)](_0x5bc816(0x112))[_0x5bc816(0x1e6)]({'botID':_0x3d471e})[_0x5bc816(0x16b)]({'status':_0x175783})[_0x5bc816(0x11f)](),config=getConfiguration(),io['to']('botmanager')[_0x5bc816(0x1f9)](_0x5bc816(0x112),config);}function updateLive(_0x1ca5f1,_0xb4dd4b){const _0x7991a0=_0x309369;dbConfig[_0x7991a0(0x192)](_0x7991a0(0x112))[_0x7991a0(0x1e6)]({'botID':_0x1ca5f1})[_0x7991a0(0x16b)]({'live':_0xb4dd4b})['write'](),config=getConfiguration(),io['to'](_0x7991a0(0x152))[_0x7991a0(0x1f9)](_0x7991a0(0x112),config);}function updateBotName(_0x3517ea,_0x179c13){const _0x329693=_0x309369;dbConfig[_0x329693(0x192)](_0x329693(0x112))[_0x329693(0x1e6)]({'botID':_0x3517ea})['assign']({'botname':_0x179c13})[_0x329693(0x11f)](),config=getConfiguration(),io['to'](_0x329693(0x152))[_0x329693(0x1f9)](_0x329693(0x112),config);}function telegramError(_0x44ce55){const _0xa93f58=_0x309369;console['log'](getTimeStamp()+_0xa93f58(0x1b2));}function validateTelegram(_0x3dd5ae){const _0x5f1ca6=_0x309369;if(_0x3dd5ae['from'][_0x5f1ca6(0x18e)]!=settings[_0x5f1ca6(0x12a)]&&'@'+_0x3dd5ae[_0x5f1ca6(0x1f2)][_0x5f1ca6(0x18e)]!=settings[_0x5f1ca6(0x12a)])return tgBot[_0x5f1ca6(0x1ba)](_0x3dd5ae['chat']['id'],_0x5f1ca6(0x1e9),{'parse_mode':'HTML'})['catch'](_0x3a9aed=>{telegramError(_0x3a9aed);}),![];return!![];}async function initTelegram(){const _0x4f0bb7=_0x309369;if(tgBot)tgBot[_0x4f0bb7(0x1ac)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x4f0bb7(0x1aa)],{'polling':!![]});let _0x578b40=_0x4f0bb7(0x1e4);_0x578b40+='\x0a',_0x578b40+=_0x4f0bb7(0x20a),_0x578b40+=_0x4f0bb7(0x1d8),_0x578b40+=_0x4f0bb7(0x12c),_0x578b40+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x578b40+='/on\x20-\x20start\x20bot(s)\x0a',_0x578b40+='/off\x20-\x20stop\x20bot(s)\x0a',_0x578b40+=_0x4f0bb7(0x234),_0x578b40+=_0x4f0bb7(0x156);let _0x43d1ca=_0x4f0bb7(0x1ff);_0x43d1ca+='\x0a',_0x43d1ca+=_0x578b40,tgBot['onText'](/\/start/,_0x53526f=>{const _0x34cfe3=_0x4f0bb7;if(!validateTelegram(_0x53526f))return;if(settings['telegramChatId']!=_0x53526f[_0x34cfe3(0x23a)]['id'])updateSetting(_0x34cfe3(0x108),_0x53526f[_0x34cfe3(0x23a)]['id']);updateSetting(_0x34cfe3(0x17c),!![]),tgBot[_0x34cfe3(0x1ba)](_0x53526f[_0x34cfe3(0x23a)]['id'],_0x43d1ca)[_0x34cfe3(0x158)](_0x18b4c5=>{telegramError(_0x18b4c5);});}),tgBot['onText'](/\/enable/,_0x2def66=>{const _0x156b4d=_0x4f0bb7;if(!validateTelegram(_0x2def66))return;if(settings[_0x156b4d(0x108)]!=_0x2def66['chat']['id'])updateSetting(_0x156b4d(0x108),_0x2def66[_0x156b4d(0x23a)]['id']);updateSetting(_0x156b4d(0x17c),!![]),tgBot[_0x156b4d(0x1ba)](_0x2def66[_0x156b4d(0x23a)]['id'],'Notifications\x20enabled')[_0x156b4d(0x158)](_0x13a1f6=>{telegramError(_0x13a1f6);});}),tgBot[_0x4f0bb7(0x1ea)](/\/config/,async _0x16dd85=>{const _0x55aa57=_0x4f0bb7;if(!validateTelegram(_0x16dd85))return;tgBot['removeListener'](_0x55aa57(0x232)),tgBot[_0x55aa57(0x1ba)](_0x16dd85[_0x55aa57(0x23a)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x55aa57(0x1a7),'callback_data':_0x55aa57(0x13e)},{'text':_0x55aa57(0x14e),'callback_data':_0x55aa57(0x165)},{'text':'All','callback_data':_0x55aa57(0x1bb)}]]}})[_0x55aa57(0x158)](_0x4a644d=>{telegramError(_0x4a644d);}),tgBot['on'](_0x55aa57(0x232),async _0x3c2d5f=>{const _0x3e7b91=_0x55aa57,_0x355aa4=_0x3c2d5f[_0x3e7b91(0x220)],_0x54b41d=_0x3c2d5f[_0x3e7b91(0x217)];tgBot['answerCallbackQuery'](_0x3c2d5f['id'])[_0x3e7b91(0x168)](async()=>{const _0x519957=_0x3e7b91;_0x355aa4==_0x519957(0x13e)&&(updateSetting(_0x519957(0x11a),_0x519957(0x13e)),updateSetting(_0x519957(0x17c),!![]),await tgBot[_0x519957(0x1ba)](_0x54b41d[_0x519957(0x23a)]['id'],_0x519957(0x138))[_0x519957(0x158)](_0x481448=>{telegramError(_0x481448);}));_0x355aa4==_0x519957(0x165)&&(updateSetting(_0x519957(0x11a),_0x519957(0x165)),updateSetting('telegramEnabled',!![]),await tgBot[_0x519957(0x1ba)](_0x54b41d[_0x519957(0x23a)]['id'],_0x519957(0x20c))[_0x519957(0x158)](_0x4621ca=>{telegramError(_0x4621ca);}));_0x355aa4=='all'&&(updateSetting(_0x519957(0x11a),_0x519957(0x1bb)),updateSetting(_0x519957(0x17c),!![]),await tgBot[_0x519957(0x1ba)](_0x54b41d[_0x519957(0x23a)]['id'],_0x519957(0x1d1))[_0x519957(0x158)](_0x2f92c8=>{telegramError(_0x2f92c8);}));if(!settings[_0x519957(0x108)])tgBot[_0x519957(0x1ba)](_0x54b41d[_0x519957(0x23a)]['id'],_0x519957(0x1bf))[_0x519957(0x158)](_0x1e9ac9=>{telegramError(_0x1e9ac9);});}),tgBot[_0x3e7b91(0x10c)]('callback_query');});}),tgBot[_0x4f0bb7(0x1ea)](/\/status/,_0x483d86=>{const _0x22bb03=_0x4f0bb7;if(!validateTelegram(_0x483d86))return;let _0xef6030=_0x22bb03(0x1e0);config[_0x22bb03(0x1e7)](_0x896a5f=>{const _0x1435a1=_0x22bb03;_0xef6030+='Bot\x20'+_0x896a5f['botID']+_0x1435a1(0x15d)+_0x896a5f[_0x1435a1(0x1ce)]+':\x20'+_0x896a5f['status']+_0x1435a1(0x1d7)+_0x896a5f[_0x1435a1(0x1e5)]+'\x0a';}),_0xef6030+='\x0a',_0xef6030+=_0x22bb03(0x176),_0xef6030+=!settings['telegramEnabled']?_0x22bb03(0x183):_0x22bb03(0x210),_0xef6030+=settings[_0x22bb03(0x17c)]?settings[_0x22bb03(0x11a)]==_0x22bb03(0x1bb)?_0x22bb03(0x193):'Notifications\x20types:\x20'+settings[_0x22bb03(0x11a)]+_0x22bb03(0x1ca):'',tgBot[_0x22bb03(0x1ba)](_0x483d86[_0x22bb03(0x23a)]['id'],_0xef6030,{'parse_mode':_0x22bb03(0x1a0)})[_0x22bb03(0x158)](_0x45d5ec=>{telegramError(_0x45d5ec);});}),tgBot['onText'](/\/restart/,_0xf36418=>{const _0x3f2ad5=_0x4f0bb7;if(!validateTelegram(_0xf36418))return;tgBot[_0x3f2ad5(0x10c)](_0x3f2ad5(0x232));const _0x3694dd=getEnabledBots();if(_0x3694dd[_0x3f2ad5(0x21a)]==0x0)tgBot[_0x3f2ad5(0x1ba)](_0xf36418[_0x3f2ad5(0x23a)]['id'],_0x3f2ad5(0x1ee))[_0x3f2ad5(0x158)](_0x2cdbc2=>{telegramError(_0x2cdbc2);});else{if(_0x3694dd[_0x3f2ad5(0x21a)]>0x1)_0x3694dd[_0x3f2ad5(0x162)]({'botID':_0x3f2ad5(0x1bb)});let _0x5bdc74=[],_0x35f9b1=[];const _0x18183d=_0x3694dd[_0x3f2ad5(0x21a)]%0x4==0x0||_0x3694dd['length']%0x4==0x3||_0x3694dd[_0x3f2ad5(0x21a)]%0x3==0x1?0x4:0x3;let _0x514f03=0x0;_0x3694dd['forEach']((_0x1453f7,_0x1aae90)=>{const _0x30616a=_0x3f2ad5;if(_0x1aae90%_0x18183d==0x0)_0x35f9b1=[];_0x35f9b1['push']({'text':_0x1453f7[_0x30616a(0x1db)]=='all'?'All\x20bots':'Bot\x20'+_0x1453f7[_0x30616a(0x1db)],'callback_data':_0x1453f7[_0x30616a(0x1db)]}),_0x1aae90%_0x18183d==0x0&&(_0x5bdc74[_0x514f03]=_0x35f9b1,_0x514f03++);}),tgBot[_0x3f2ad5(0x1ba)](_0xf36418[_0x3f2ad5(0x23a)]['id'],_0x3f2ad5(0x219),{'reply_markup':{'inline_keyboard':_0x5bdc74}})[_0x3f2ad5(0x158)](_0x3aa9e0=>{telegramError(_0x3aa9e0);}),tgBot['on'](_0x3f2ad5(0x232),async _0x553145=>{const _0xab1733=_0x3f2ad5,_0x1ca818=_0x553145['data'],_0x158829=_0x553145[_0xab1733(0x217)];tgBot['answerCallbackQuery'](_0x553145['id'])[_0xab1733(0x168)](async()=>{const _0x634ec4=_0xab1733;if(_0x1ca818==_0x634ec4(0x1bb)){if(settings['telegramEvents']==_0x634ec4(0x13e))tgBot[_0x634ec4(0x1ba)](_0x158829[_0x634ec4(0x23a)]['id'],_0x634ec4(0x19f))[_0x634ec4(0x158)](_0x2944a3=>{telegramError(_0x2944a3);});config[_0x634ec4(0x1e7)](_0x5c3990=>{restartBot(_0x5c3990['botID']);});}else{if(settings[_0x634ec4(0x11a)]==_0x634ec4(0x13e))tgBot[_0x634ec4(0x1ba)](_0x158829[_0x634ec4(0x23a)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20Bot\x20'+_0x1ca818)[_0x634ec4(0x158)](_0x205dbd=>{telegramError(_0x205dbd);});restartBot(_0x1ca818);}}),tgBot[_0xab1733(0x10c)](_0xab1733(0x232));});}}),tgBot[_0x4f0bb7(0x1ea)](/\/on/,_0x4d2f01=>{const _0x2fea4b=_0x4f0bb7;if(!validateTelegram(_0x4d2f01))return;tgBot[_0x2fea4b(0x10c)](_0x2fea4b(0x232));const _0x5edc89=getDisabledBots();if(_0x5edc89[_0x2fea4b(0x21a)]==0x0)tgBot[_0x2fea4b(0x1ba)](_0x4d2f01[_0x2fea4b(0x23a)]['id'],_0x2fea4b(0x131))[_0x2fea4b(0x158)](_0x3f118a=>{telegramError(_0x3f118a);});else{if(_0x5edc89[_0x2fea4b(0x21a)]>0x1)_0x5edc89[_0x2fea4b(0x162)]({'botID':'all'});let _0x48f10d=[],_0x50accc=[];const _0xcac504=_0x5edc89[_0x2fea4b(0x21a)]%0x4==0x0||_0x5edc89[_0x2fea4b(0x21a)]%0x4==0x3||_0x5edc89[_0x2fea4b(0x21a)]%0x3==0x1?0x4:0x3;let _0x509c5c=0x0;_0x5edc89[_0x2fea4b(0x1e7)]((_0x6bc878,_0x3c9cb6)=>{const _0x4224ea=_0x2fea4b;if(_0x3c9cb6%_0xcac504==0x0)_0x50accc=[];_0x50accc[_0x4224ea(0x162)]({'text':_0x6bc878['botID']==_0x4224ea(0x1bb)?_0x4224ea(0x143):_0x4224ea(0x205)+_0x6bc878[_0x4224ea(0x1db)],'callback_data':_0x6bc878[_0x4224ea(0x1db)]}),_0x3c9cb6%_0xcac504==0x0&&(_0x48f10d[_0x509c5c]=_0x50accc,_0x509c5c++);}),tgBot[_0x2fea4b(0x1ba)](_0x4d2f01[_0x2fea4b(0x23a)]['id'],_0x2fea4b(0x1b9),{'reply_markup':{'inline_keyboard':_0x48f10d}})['catch'](_0x279dbe=>{telegramError(_0x279dbe);}),tgBot['on'](_0x2fea4b(0x232),async _0x1972c0=>{const _0x1c76cb=_0x2fea4b,_0x241501=_0x1972c0[_0x1c76cb(0x220)],_0x21ba63=_0x1972c0[_0x1c76cb(0x217)];tgBot[_0x1c76cb(0x218)](_0x1972c0['id'])[_0x1c76cb(0x168)](async()=>{const _0x8d3821=_0x1c76cb;if(_0x241501==_0x8d3821(0x1bb)){if(settings[_0x8d3821(0x11a)]==_0x8d3821(0x13e))tgBot[_0x8d3821(0x1ba)](_0x21ba63[_0x8d3821(0x23a)]['id'],_0x8d3821(0x21d))[_0x8d3821(0x158)](_0x4c9648=>{telegramError(_0x4c9648);});_0x5edc89[_0x8d3821(0x1e7)](_0x2ce1c1=>{const _0x11230c=_0x8d3821;if(_0x2ce1c1[_0x11230c(0x1db)]!=_0x11230c(0x1bb))toggleBot(_0x2ce1c1[_0x11230c(0x1db)],toggleStatus(_0x2ce1c1['botID']),_0x11230c(0x1f4));});}else{if(settings[_0x8d3821(0x11a)]==_0x8d3821(0x13e))tgBot[_0x8d3821(0x1ba)](_0x21ba63[_0x8d3821(0x23a)]['id'],_0x8d3821(0x157)+_0x241501)[_0x8d3821(0x158)](_0x366be0=>{telegramError(_0x366be0);});toggleBot(_0x241501,toggleStatus(_0x241501),'stopped');}}),tgBot[_0x1c76cb(0x10c)](_0x1c76cb(0x232));});}}),tgBot[_0x4f0bb7(0x1ea)](/\/off/,_0xd59520=>{const _0xa76ed5=_0x4f0bb7;if(!validateTelegram(_0xd59520))return;tgBot['removeListener'](_0xa76ed5(0x232));const _0x5383d2=getEnabledBots();if(_0x5383d2['length']==0x0)tgBot[_0xa76ed5(0x1ba)](_0xd59520[_0xa76ed5(0x23a)]['id'],'No\x20bots\x20running\x20right\x20now')[_0xa76ed5(0x158)](_0x551375=>{telegramError(_0x551375);});else{if(_0x5383d2[_0xa76ed5(0x21a)]>0x1)_0x5383d2[_0xa76ed5(0x162)]({'botID':_0xa76ed5(0x1bb)});let _0x3a1dac=[],_0x46e8fc=[];const _0x10c58d=_0x5383d2['length']%0x4==0x0||_0x5383d2[_0xa76ed5(0x21a)]%0x4==0x3||_0x5383d2[_0xa76ed5(0x21a)]%0x3==0x1?0x4:0x3;let _0x3188fd=0x0;_0x5383d2[_0xa76ed5(0x1e7)]((_0x4286fc,_0x20b8a1)=>{const _0x5a00b1=_0xa76ed5;if(_0x20b8a1%_0x10c58d==0x0)_0x46e8fc=[];_0x46e8fc[_0x5a00b1(0x162)]({'text':_0x4286fc[_0x5a00b1(0x1db)]==_0x5a00b1(0x1bb)?_0x5a00b1(0x143):_0x5a00b1(0x205)+_0x4286fc[_0x5a00b1(0x1db)],'callback_data':_0x4286fc[_0x5a00b1(0x1db)]}),_0x20b8a1%_0x10c58d==0x0&&(_0x3a1dac[_0x3188fd]=_0x46e8fc,_0x3188fd++);}),tgBot[_0xa76ed5(0x1ba)](_0xd59520['chat']['id'],_0xa76ed5(0x122),{'reply_markup':{'inline_keyboard':_0x3a1dac}})['catch'](_0x2a0a52=>{telegramError(_0x2a0a52);}),tgBot['on'](_0xa76ed5(0x232),async _0x110d6d=>{const _0x171084=_0xa76ed5,_0x593f5a=_0x110d6d[_0x171084(0x220)],_0x16492b=_0x110d6d[_0x171084(0x217)];tgBot[_0x171084(0x218)](_0x110d6d['id'])[_0x171084(0x168)](async()=>{const _0x395aa4=_0x171084;if(_0x593f5a=='all'){if(settings[_0x395aa4(0x11a)]==_0x395aa4(0x13e))tgBot[_0x395aa4(0x1ba)](_0x16492b[_0x395aa4(0x23a)]['id'],_0x395aa4(0x178))[_0x395aa4(0x158)](_0x5d999b=>{telegramError(_0x5d999b);});_0x5383d2['forEach'](_0x3d5765=>{const _0x3c0a74=_0x395aa4;if(_0x3d5765[_0x3c0a74(0x1db)]!=_0x3c0a74(0x1bb))toggleBot(_0x3d5765[_0x3c0a74(0x1db)],toggleStatus(_0x3d5765['botID']),'stopped');});}else{if(settings[_0x395aa4(0x11a)]==_0x395aa4(0x13e))tgBot[_0x395aa4(0x1ba)](_0x16492b[_0x395aa4(0x23a)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x593f5a)[_0x395aa4(0x158)](_0xf8ec4d=>{telegramError(_0xf8ec4d);});toggleBot(_0x593f5a,toggleStatus(_0x593f5a),_0x395aa4(0x1f4));}}),tgBot['removeListener'](_0x171084(0x232));});}}),tgBot[_0x4f0bb7(0x1ea)](/\/disable/,_0x5245d9=>{const _0x985ae1=_0x4f0bb7;if(!validateTelegram(_0x5245d9))return;tgBot['sendMessage'](_0x5245d9['chat']['id'],'Notifications\x20disabled')[_0x985ae1(0x158)](_0x441f3d=>{telegramError(_0x441f3d);}),updateSetting(_0x985ae1(0x17c),![]);}),tgBot['onText'](/\/help/,_0x1c835f=>{const _0x147cc4=_0x4f0bb7;if(!validateTelegram(_0x1c835f))return;tgBot[_0x147cc4(0x1ba)](_0x1c835f['chat']['id'],_0x578b40)[_0x147cc4(0x158)](_0x2dc130=>{telegramError(_0x2dc130);});}),tgBot['on']('polling_error',_0x2e6c8c=>{const _0xed5cd=_0x4f0bb7;_0x2e6c8c['toString']()['includes'](_0xed5cd(0x236))&&(logging('Invalid\x20Telegram\x20token'),tgBot[_0xed5cd(0x1ac)](),tgBot=null,io['to'](_0xed5cd(0x152))[_0xed5cd(0x1f9)](_0xed5cd(0x177),_0xed5cd(0x106)));}),process['once']('SIGINT',()=>{const _0x148444=_0x4f0bb7;if(tgBot)tgBot[_0x148444(0x1ac)]();process[_0x148444(0x13b)](0x1);}),process['once'](_0x4f0bb7(0x164),()=>{const _0x10ecab=_0x4f0bb7;if(tgBot)tgBot[_0x10ecab(0x1ac)]();process[_0x10ecab(0x13b)](0x1);});}}function disableTelegram(){const _0x2eba56=_0x309369;tgBot&&(tgBot[_0x2eba56(0x1ac)](),tgBot=null);}function sendTelegram(_0x595776,_0x1635a0){const _0x4c57e7=_0x309369;if(settings['telegramEnabled']){if(settings[_0x4c57e7(0x11a)]==_0x4c57e7(0x1bb)||(_0x1635a0[_0x4c57e7(0x16c)]==_0x4c57e7(0x132)||_0x1635a0[_0x4c57e7(0x16c)]==_0x4c57e7(0x155))&&settings[_0x4c57e7(0x11a)]==_0x4c57e7(0x165)||_0x1635a0[_0x4c57e7(0x16c)]==_0x4c57e7(0x23b)&&settings[_0x4c57e7(0x11a)]==_0x4c57e7(0x13e)){if(tgBot&&settings[_0x4c57e7(0x108)]){if(_0x1635a0['showname'])tgBot[_0x4c57e7(0x1ba)](settings[_0x4c57e7(0x108)],_0x1635a0[_0x4c57e7(0x1ce)]+_0x4c57e7(0x1eb)+_0x1635a0['event'])[_0x4c57e7(0x158)](_0x1a9a91=>{telegramError(_0x1a9a91);});else tgBot[_0x4c57e7(0x1ba)](settings[_0x4c57e7(0x108)],'Bot\x20'+_0x595776+'\x20>\x20'+_0x1635a0[_0x4c57e7(0x118)])[_0x4c57e7(0x158)](_0x32c2a3=>{telegramError(_0x32c2a3);});}}}}function getDeviceWithIp(_0x84b8b5){const _0x4b1b07=_0x309369;return devices[_0x4b1b07(0x1e6)](_0x214f4b=>_0x214f4b['ip']===_0x84b8b5);}function temporaryAccess2FA(_0x35bf60,_0x4dbe1d){const _0x57eebd=_0x309369;let _0x41933d=new Date(),_0x5de58c=![];if(lastIpApproval){if(_0x41933d-lastIpApproval<0x1388)_0x5de58c=!![];}lastIpApproval=new Date();if(_0x5de58c)return;tgBot&&settings[_0x57eebd(0x108)]&&(tgBot[_0x57eebd(0x10c)](_0x57eebd(0x232)),tgBot[_0x57eebd(0x1ba)](settings[_0x57eebd(0x108)],_0x57eebd(0x12e)+normalizeIP(_0x4dbe1d)[_0x57eebd(0x1d6)]+_0x57eebd(0x135),{'parse_mode':_0x57eebd(0x1a0),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x57eebd(0x12b),'callback_data':'15'},{'text':_0x57eebd(0x1ab),'callback_data':'30'},{'text':_0x57eebd(0x181),'callback_data':_0x57eebd(0x181)}]]}})[_0x57eebd(0x158)](_0xc66947=>{telegramError(_0xc66947);}),tgBot['on'](_0x57eebd(0x232),async _0x22564f=>{const _0x3ad9d2=_0x57eebd,_0x2e9d62=_0x22564f[_0x3ad9d2(0x220)],_0x58462c=_0x22564f['message'];tgBot[_0x3ad9d2(0x218)](_0x22564f['id'])[_0x3ad9d2(0x168)](async()=>{const _0x2df357=_0x3ad9d2;devices[_0x35bf60][_0x2df357(0x141)]={'clientip':_0x4dbe1d,'timestamp':new Date()[_0x2df357(0x16e)](),'expiry':_0x2e9d62},_0x2e9d62!='reject'?(await tgBot[_0x2df357(0x1ba)](_0x58462c['chat']['id'],_0x2df357(0x1b5)+_0x2e9d62+_0x2df357(0x19c),{'parse_mode':_0x2df357(0x1a0)})[_0x2df357(0x158)](_0x176bd4=>{telegramError(_0x176bd4);}),io['to'](_0x35bf60)[_0x2df357(0x1f9)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x2df357(0x1ba)](_0x58462c['chat']['id'],_0x2df357(0x167))['catch'](_0x1bc593=>{telegramError(_0x1bc593);}),io['to'](_0x35bf60)['emit'](_0x2df357(0x224),{'access':{'allow':![],'reason':_0x2df357(0x121),'token':null}}));}),tgBot[_0x3ad9d2(0x10c)]('callback_query');}));}function loginAccess2FA(_0x587f48,_0x5aef3a){const _0x397c95=_0x309369;tgBot&&settings[_0x397c95(0x108)]&&(tgBot[_0x397c95(0x10c)](_0x397c95(0x232)),tgBot[_0x397c95(0x1ba)](settings[_0x397c95(0x108)],_0x397c95(0x229)+normalizeIP(_0x5aef3a)[_0x397c95(0x1d6)]+_0x397c95(0x135),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x397c95(0x15a),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x397c95(0x181)}]]}})['catch'](_0x2232a1=>{telegramError(_0x2232a1);}),tgBot['on'](_0x397c95(0x232),async _0x1afbb8=>{const _0x19bbba=_0x397c95,_0x5e0167=_0x1afbb8[_0x19bbba(0x220)],_0x29f8f2=_0x1afbb8[_0x19bbba(0x217)];tgBot[_0x19bbba(0x218)](_0x1afbb8['id'])[_0x19bbba(0x168)](async()=>{const _0x1601b4=_0x19bbba;devices[_0x587f48][_0x1601b4(0x1dc)]={'clientip':_0x5aef3a,'timestamp':new Date()[_0x1601b4(0x16e)](),'expiry':_0x5e0167},_0x5e0167!='reject'?(await tgBot[_0x1601b4(0x1ba)](_0x29f8f2[_0x1601b4(0x23a)]['id'],'Login\x20accepted',{'parse_mode':'HTML'})[_0x1601b4(0x158)](_0x4938c8=>{telegramError(_0x4938c8);}),io['to'](_0x587f48)[_0x1601b4(0x1f9)](_0x1601b4(0x224),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot['sendMessage'](_0x29f8f2[_0x1601b4(0x23a)]['id'],_0x1601b4(0x1d5))['catch'](_0x1e335b=>{telegramError(_0x1e335b);}),io['to'](_0x587f48)['emit'](_0x1601b4(0x224),{'access':{'allow':![],'reason':_0x1601b4(0x14d),'token':null}}));}),tgBot[_0x19bbba(0x10c)](_0x19bbba(0x232));}));}function getConfiguration(){const _0x49be2a=_0x309369;return dbConfig[_0x49be2a(0x192)](_0x49be2a(0x112))[_0x49be2a(0x133)]('botID')[_0x49be2a(0x103)]()||[];}function getEnabledBots(){const _0x55be43=_0x309369;return dbConfig['get']('bots')['sortBy'](_0x55be43(0x1db))[_0x55be43(0x148)]({'status':_0x55be43(0x1cb)})['value']()||[];}function getDisabledBots(){const _0x38b804=_0x309369;return dbConfig[_0x38b804(0x192)]('bots')['sortBy'](_0x38b804(0x1db))[_0x38b804(0x148)]({'status':_0x38b804(0x166)})[_0x38b804(0x103)]()||[];}function getSettings(){const _0xa032ea=_0x309369;return dbSettings[_0xa032ea(0x192)](_0xa032ea(0x104))[_0xa032ea(0x103)]()||{'timeshift':0x0};}function getSecure(){const _0x157daa=_0x309369;return dbSecure['get'](_0x157daa(0x21c))[_0x157daa(0x103)]()||{};}function getBlacklist(){const _0x34c1b6=_0x309369;return dbSecure[_0x34c1b6(0x192)](_0x34c1b6(0x102))[_0x34c1b6(0x103)]()||[];}function broadcastToBots(_0x58fdd4,_0x2b18fe){const _0x2f728a=_0x309369;config[_0x2f728a(0x1e7)](_0x3ec663=>{const _0x3f4b63=_0x2f728a;if(_0x3ec663['status']==_0x3f4b63(0x1cb)&&_0x3ec663[_0x3f4b63(0x1e5)]=='running'){if(pid[_0x3ec663[_0x3f4b63(0x1db)]])pid[_0x3ec663['botID']]['send']({[_0x58fdd4]:_0x2b18fe});}});}function storeSettings(_0x3c5827,_0x2605df=![]){const _0x4bf73c=_0x309369;_0x3c5827={...settings,..._0x3c5827};if(_0x2605df&&_0x3c5827[_0x4bf73c(0x1a8)]!='************'&&_0x3c5827[_0x4bf73c(0x1a8)]!=''){const _0x293f25=crypt['decrypt'](secure[_0x4bf73c(0x1f5)],_0x3c5827[_0x4bf73c(0x1a8)])[_0x4bf73c(0x217)][_0x4bf73c(0x124)]('@')[0x0],_0x202310=bcrypt[_0x4bf73c(0x194)](_0x293f25,saltRounds);_0x3c5827={..._0x3c5827,'bbPassword':_0x202310};}if(_0x2605df&&_0x3c5827[_0x4bf73c(0x1aa)]!=_0x4bf73c(0x15c)&&_0x3c5827[_0x4bf73c(0x1aa)]!=''){const _0x10a26e=crypt[_0x4bf73c(0x1e2)](secure[_0x4bf73c(0x1f5)],_0x3c5827[_0x4bf73c(0x1aa)])[_0x4bf73c(0x217)][_0x4bf73c(0x124)]('@')[0x0];_0x3c5827={..._0x3c5827,'telegramToken':_0x10a26e};}const _0x5e6d3c=_0x3c5827['telegramToken']!=_0x4bf73c(0x15c)&&_0x3c5827[_0x4bf73c(0x1aa)]!=settings['telegramToken']||_0x3c5827[_0x4bf73c(0x12a)]!=settings['telegramUsername'],_0x5747c1=_0x3c5827[_0x4bf73c(0x1aa)]==''||_0x3c5827[_0x4bf73c(0x12a)]=='';if(_0x5e6d3c)_0x3c5827[_0x4bf73c(0x11a)]='all';for(const [_0x58226b,_0x28364b]of Object[_0x4bf73c(0x190)](_0x3c5827)){if(_0x58226b==_0x4bf73c(0x1aa)&&_0x28364b==_0x4bf73c(0x15c)){_0x3c5827[_0x4bf73c(0x1aa)]=settings[_0x4bf73c(0x1aa)];continue;};if(_0x58226b==_0x4bf73c(0x1a8)&&_0x28364b==_0x4bf73c(0x15c)){_0x3c5827[_0x4bf73c(0x1a8)]=settings[_0x4bf73c(0x1a8)];continue;};dbSettings[_0x4bf73c(0x1ae)](_0x4bf73c(0x1ef)+_0x58226b,_0x28364b)[_0x4bf73c(0x11f)]();}settings=_0x3c5827,io['to'](_0x4bf73c(0x152))[_0x4bf73c(0x1f9)](_0x4bf73c(0x104),cleanSettings()),broadcastToBots('timeshift',settings[_0x4bf73c(0x1a6)]);if(_0x5e6d3c&&!_0x5747c1)initTelegram();if(_0x5e6d3c&&_0x5747c1)disableTelegram();getAllClients()[_0x4bf73c(0x1e7)](_0x4df154=>{const _0x25a74a=_0x4bf73c;getSocket(_0x4df154['id'])['emit'](_0x25a74a(0x224),{'access':{'allow':![],'reason':_0x25a74a(0x11b),'token':null}});});}function updateSetting(_0x3a431a,_0x39c7d1){const _0x4ed546=_0x309369;dbSettings['set']('settings.'+_0x3a431a,_0x39c7d1)[_0x4ed546(0x11f)](),settings=getSettings(),io['to']('botmanager')[_0x4ed546(0x1f9)](_0x4ed546(0x104),cleanSettings());}function storeSecure(_0x2eea24){const _0x4ab509=_0x309369;dbSecure['get'](_0x4ab509(0x21c))[_0x4ab509(0x162)](_0x2eea24)[_0x4ab509(0x11f)](),secure=_0x2eea24;}function addBlacklist(_0x27ed35){const _0x2fa214=_0x309369;cleanBlacklist();let _0x1cbdc2;devices[_0x27ed35]['telegramIpApproval']?_0x1cbdc2=Math[_0x2fa214(0x227)](devices[_0x27ed35][_0x2fa214(0x141)][_0x2fa214(0x1f3)],loginExpiry):_0x1cbdc2=loginExpiry,dbSecure[_0x2fa214(0x192)]('blacklist')[_0x2fa214(0x162)]({'expiry':new Date()[_0x2fa214(0x16e)]()+_0x1cbdc2*0x3c*0x3e8,'token':devices[_0x27ed35][_0x2fa214(0x211)]['token']})[_0x2fa214(0x11f)](),blacklist=dbSecure[_0x2fa214(0x192)]('blacklist')[_0x2fa214(0x103)]();}function cleanBlacklist(){const _0xdc0ab5=_0x309369;let _0x241e9f=dbSecure[_0xdc0ab5(0x192)](_0xdc0ab5(0x102))[_0xdc0ab5(0x139)]()['value'](),_0x1a1e6e=new Date()[_0xdc0ab5(0x16e)]();_0x241e9f['forEach'](_0x58fb6d=>{const _0x3cb90f=_0xdc0ab5;_0x58fb6d['expiry']<_0x1a1e6e&&dbSecure[_0x3cb90f(0x192)](_0x3cb90f(0x102))[_0x3cb90f(0x125)]({'expiry':_0x58fb6d[_0x3cb90f(0x1f3)]})['write']();});}function initStates(){const _0x5a1f86=_0x309369;let _0x27fb19=getConfiguration();_0x27fb19[_0x5a1f86(0x1e7)](_0x245f7b=>{const _0x439f4b=_0x5a1f86;_0x245f7b[_0x439f4b(0x1e5)]='stopped';}),storeConfiguration(_0x27fb19);}function onKeys(){const _0x1c1817=new RSA();return new Promise(_0x3df801=>{const _0x4d3181=_0x1a18;_0x1c1817[_0x4d3181(0x1c9)]()[_0x4d3181(0x168)](_0x126352=>{_0x3df801(_0x126352);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x168359=_0x309369;let _0x1e0c8c=getConfiguration(),_0x460914=![];_0x1e0c8c[_0x168359(0x1e7)](_0x4b4d98=>{const _0x28e095=_0x168359;if(_0x4b4d98['status']=='running')_0x4b4d98[_0x28e095(0x224)]=_0x28e095(0x1cb),_0x460914=!![];else _0x4b4d98[_0x28e095(0x224)]==_0x28e095(0x1f4)&&(_0x4b4d98[_0x28e095(0x224)]=_0x28e095(0x166),_0x460914=!![]);});if(_0x460914)storeConfiguration(_0x1e0c8c);let _0x4bc49c=getSecure();if(!_0x4bc49c[_0x168359(0x12f)]('secret')){let _0xa04246=await generateKeys();_0x4bc49c[_0x168359(0x182)]=_0xa04246[_0x168359(0x182)],_0x4bc49c[_0x168359(0x1f5)]=_0xa04246[_0x168359(0x1f5)],_0x4bc49c[_0x168359(0x180)]=crypto['randomBytes'](0x20)[_0x168359(0x1c8)](_0x168359(0x144));;storeSecure(_0x4bc49c);}let _0x5b95a0=getSettings();_0x460914=![];!_0x5b95a0[_0x168359(0x12f)](_0x168359(0x127))&&(_0x5b95a0['loginRequired']=![],_0x5b95a0[_0x168359(0x145)]='',_0x5b95a0[_0x168359(0x1a8)]='',_0x5b95a0[_0x168359(0x231)]=![],_0x460914=!![]);!_0x5b95a0['hasOwnProperty'](_0x168359(0x212))&&(_0x5b95a0[_0x168359(0x212)]=![],_0x5b95a0[_0x168359(0x22b)]=[],_0x5b95a0[_0x168359(0x223)]=![],_0x460914=!![]);if(!_0x5b95a0[_0x168359(0x12f)](_0x168359(0x17c))){if(_0x5b95a0[_0x168359(0x108)])_0x5b95a0[_0x168359(0x17c)]=!![];else _0x5b95a0['telegramEnabled']=![];_0x460914=!![];}if(_0x460914)storeSettings(_0x5b95a0);}function storeConfiguration(_0x3ac42c){const _0x52d4f1=_0x309369;dbConfig[_0x52d4f1(0x192)](_0x52d4f1(0x112))[_0x52d4f1(0x125)]()[_0x52d4f1(0x11f)](),dbConfig[_0x52d4f1(0x192)](_0x52d4f1(0x112))['push'](..._0x3ac42c)[_0x52d4f1(0x11f)](),config=_0x3ac42c;}function resetPassword(){const _0x344252=_0x309369;tgBot&&settings[_0x344252(0x108)]&&(tgBot[_0x344252(0x10c)](_0x344252(0x232)),tgBot['sendMessage'](settings[_0x344252(0x108)],_0x344252(0x204),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x344252(0x187),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x344252(0x158)](_0x17a84c=>{telegramError(_0x17a84c);}),tgBot['on']('callback_query',async _0x97192f=>{const _0x292505=_0x344252,_0x4c3f22=_0x97192f[_0x292505(0x220)],_0x5bdb4e=_0x97192f[_0x292505(0x217)];tgBot[_0x292505(0x218)](_0x97192f['id'])[_0x292505(0x168)](async()=>{const _0x536a73=_0x292505;if(_0x4c3f22!='no'){const _0x506c1f=0xf,_0x1d11d8=_0x536a73(0x12d),_0x75ce53=Array[_0x536a73(0x1f2)](crypto[_0x536a73(0x16f)](new Uint32Array(_0x506c1f)))[_0x536a73(0x1e1)](_0xfe3463=>_0x1d11d8[_0xfe3463%_0x1d11d8['length']])[_0x536a73(0x134)](''),_0x41a477=bcrypt[_0x536a73(0x194)](_0x75ce53,saltRounds);storeSettings({'bbPassword':_0x41a477}),await tgBot['sendMessage'](_0x5bdb4e[_0x536a73(0x23a)]['id'],_0x536a73(0x21e)+_0x75ce53,{'parse_mode':'HTML'})[_0x536a73(0x158)](_0x3ee8d0=>{telegramError(_0x3ee8d0);});}else await tgBot[_0x536a73(0x1ba)](_0x5bdb4e[_0x536a73(0x23a)]['id'],_0x536a73(0x22e))[_0x536a73(0x158)](_0x3cfd34=>{telegramError(_0x3cfd34);});}),tgBot['removeListener'](_0x292505(0x232));}));}function logging(_0x2b448a){const _0xa9ef79=_0x309369;console[_0xa9ef79(0x1cd)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x2b448a);if(tgBot&&settings[_0xa9ef79(0x108)]&&settings[_0xa9ef79(0x11a)]!=_0xa9ef79(0x13e))tgBot[_0xa9ef79(0x1ba)](settings[_0xa9ef79(0x108)],_0xa9ef79(0x1d2)+_0x2b448a)['catch'](_0x13b31d=>{telegramError(_0x13b31d);});}function getServerTime(){const _0x15217f=_0x309369,_0x30e59e=new Date();return _0x30e59e[_0x15217f(0x21b)]()+'/'+(_0x30e59e['getMonth']()+0x1)[_0x15217f(0x1c8)]()['padStart'](0x2,'0')+'/'+_0x30e59e[_0x15217f(0xff)]()[_0x15217f(0x1c8)]()[_0x15217f(0x206)](0x2,'0')+'\x20'+_0x30e59e[_0x15217f(0x15f)]()[_0x15217f(0x1c8)]()[_0x15217f(0x206)](0x2,'0')+':'+_0x30e59e['getMinutes']()[_0x15217f(0x1c8)]()[_0x15217f(0x206)](0x2,'0')+':'+_0x30e59e[_0x15217f(0x18c)]()[_0x15217f(0x1c8)]()[_0x15217f(0x206)](0x2,'0');}function getTimeStamp(){const _0x450dde=_0x309369,_0x48878b=shiftedTime();return _0x48878b[_0x450dde(0x21b)]()+'/'+(_0x48878b[_0x450dde(0x179)]()+0x1)[_0x450dde(0x1c8)]()['padStart'](0x2,'0')+'/'+_0x48878b[_0x450dde(0xff)]()[_0x450dde(0x1c8)]()['padStart'](0x2,'0')+'\x20'+_0x48878b['getHours']()[_0x450dde(0x1c8)]()[_0x450dde(0x206)](0x2,'0')+':'+_0x48878b[_0x450dde(0x221)]()[_0x450dde(0x1c8)]()[_0x450dde(0x206)](0x2,'0')+':'+_0x48878b[_0x450dde(0x18c)]()['toString']()[_0x450dde(0x206)](0x2,'0');}function shiftedTime(){const _0x4071d5=_0x309369,_0x3dd5c7=new Date();let _0xca3e38=_0x3dd5c7;if(settings[_0x4071d5(0x1a6)]&&settings[_0x4071d5(0x1a6)]!==0x0)_0xca3e38=fns[_0x4071d5(0x110)](_0x3dd5c7,{'hours':settings[_0x4071d5(0x1a6)]});return _0xca3e38;}function startScheduler(){const _0x1a6584=_0x309369;let _0x4ccbe5=new Date()[_0x1a6584(0x171)]();_0x4ccbe5==0x1&&backupConfigFiles();_0x4ccbe5==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x559f5b=_0x309369;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x559f5b(0x1e7)](_0x526e94=>{const _0x1b7ec6=_0x559f5b;if(!_0x526e94['isDirectory']())fs[_0x1b7ec6(0x186)](configpath+_0x526e94['name'],configbackuppath+_0x526e94[_0x1b7ec6(0x17b)]);});}function triggerAnalytics(){const _0x425d85=_0x309369;analytics['page']({'title':'Balance\x20Bot\x20Server','href':_0x425d85(0x203),'path':'/v'+serverversion});}function validateCredentials(_0x52e085,_0x505e4d){const _0x5405ac=_0x309369;if(_0x52e085[_0x5405ac(0x18e)]==settings[_0x5405ac(0x145)]&&bcrypt[_0x5405ac(0x23e)](_0x52e085[_0x5405ac(0x151)],settings[_0x5405ac(0x1a8)])){if(settings[_0x5405ac(0x231)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x504f70=generateLoginToken(_0x505e4d);return{'allow':!![],'reason':_0x5405ac(0xfe),'token':_0x504f70};}}else return{'allow':![],'reason':_0x5405ac(0x197),'token':null};}function refreshToken(_0x1cd9c2){const _0xae4e6=_0x309369,_0xc3116=generateLoginToken(_0x1cd9c2);return{'allow':!![],'reason':_0xae4e6(0xfe),'token':_0xc3116};}function validateAccess(_0x4db3b0,_0x29e8a9){const _0x549b87=_0x309369;let _0x361810=devices[_0x29e8a9]['ip'],_0x480855;const _0x2249fe=_0x595598=>{const _0x5e97df=_0x1a18;if(settings[_0x5e97df(0x127)]){if(settings[_0x5e97df(0x231)]){if(telegram2FaApproved(_0x29e8a9)){const _0x3a6b4c=generateLoginToken(_0x29e8a9);return{'allow':!![],'reason':_0x5e97df(0x14a),'token':_0x3a6b4c};}else return{'allow':![],'reason':_0x5e97df(0x185),'token':null};}else return _0x480855=validToken(_0x595598,_0x29e8a9),_0x480855['hasOwnProperty'](_0x5e97df(0x155))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x595598}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x5e97df(0x19e),'token':null};};if(settings['whitelistEnabled']){let _0x253ae6=[...settings[_0x549b87(0x22b)],'::1',_0x549b87(0x120),'127.0.0.1'];if(_0x253ae6['includes'](_0x361810))return _0x2249fe(_0x4db3b0);else{_0x480855=validToken(_0x4db3b0,_0x29e8a9);if(_0x480855[_0x549b87(0x12f)]('success'))return _0x2249fe(_0x4db3b0);else{if(telegramIpApproved(_0x29e8a9)){const _0x556f88=generateToken(_0x29e8a9);return _0x480855=_0x2249fe(_0x4db3b0),_0x480855[_0x549b87(0x172)]?{'allow':!![],'reason':_0x549b87(0x1cf),'token':_0x556f88}:_0x480855;}else return settings[_0x549b87(0x223)]?{'allow':![],'reason':_0x549b87(0x238),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x2249fe(_0x4db3b0);}function timelyDecrypt(_0x48bb07,_0x3462a3=!![]){const _0x2a0426=_0x309369;if(_0x48bb07)try{const _0x4c6f8b=crypt[_0x2a0426(0x1e2)](secure['privateKey'],_0x48bb07)[_0x2a0426(0x217)],_0x20ae3c=_0x4c6f8b[_0x2a0426(0x124)]('@')[0x0],_0x4cd9e3=_0x4c6f8b[_0x2a0426(0x124)]('@')[0x1],_0x2e90cd=new Date()[_0x2a0426(0x16e)]();if(_0x3462a3){if(_0x2e90cd-_0x4cd9e3<maxSecretAge*0x3e8)return _0x20ae3c;else return![];}else return _0x20ae3c;}catch(_0xa4d174){return![];}else return![];}const validToken=(_0x46522d,_0x5b1a35)=>{const _0x288e88=_0x309369,_0x5dc4c5=devices[_0x5b1a35]['ip'];if(!_0x46522d)return{'error':_0x288e88(0x11c)};for(let _0x40d295 of blacklist){if(_0x40d295['token']==_0x46522d)return{'error':'Token\x20blacklisted'};}let _0x136f95;try{_0x136f95=jwt[_0x288e88(0x18a)](_0x46522d,secure[_0x288e88(0x180)]+_0x5b1a35);}catch{return{'error':_0x288e88(0x222)};}if(!_0x136f95[_0x288e88(0x12f)]('clientip')&&!_0x136f95[_0x288e88(0x12f)]('username')||!_0x136f95['hasOwnProperty'](_0x288e88(0x109)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x136f95[_0x288e88(0x12f)](_0x288e88(0x18e))&&_0x136f95[_0x288e88(0x12f)](_0x288e88(0x1be))){const {clientip:_0x4caddc}=_0x136f95;return _0x5dc4c5==_0x4caddc?{'success':_0x288e88(0x1d9)}:{'error':_0x288e88(0x146)};}else{if(_0x136f95['hasOwnProperty'](_0x288e88(0x18e))&&_0x136f95[_0x288e88(0x12f)](_0x288e88(0x1be))){const {username:_0x4d5eaa,clientip:_0x204d1e}=_0x136f95;return settings[_0x288e88(0x145)]==_0x4d5eaa&&_0x5dc4c5==_0x204d1e?{'success':_0x288e88(0x1d9)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x376fd3=>{const _0x2f8614=_0x309369;if(_0x376fd3){const _0x2dfd7b=devices[_0x376fd3]['ip'];return jwt['sign']({'username':settings['bbUsername'],'clientip':_0x2dfd7b},secure[_0x2f8614(0x180)]+_0x376fd3,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x39cc7d=>{const _0x4b6cc0=_0x309369;if(_0x39cc7d){const _0x52c1e7=devices[_0x39cc7d]['ip'];return jwt[_0x4b6cc0(0x14f)]({'clientip':_0x52c1e7},secure[_0x4b6cc0(0x180)]+_0x39cc7d,{'expiresIn':devices[_0x39cc7d][_0x4b6cc0(0x141)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x4a113e=>{const _0x40b03d=_0x309369;let _0x120ee8=![];return devices[_0x4a113e][_0x40b03d(0x141)]&&devices[_0x4a113e][_0x40b03d(0x141)]['expiry']!='reject'&&(_0x120ee8=devices[_0x4a113e]['telegramIpApproval']['clientip']==devices[_0x4a113e]['ip']&&new Date()[_0x40b03d(0x16e)]()-devices[_0x4a113e][_0x40b03d(0x141)][_0x40b03d(0x216)]<devices[_0x4a113e][_0x40b03d(0x141)][_0x40b03d(0x1f3)]*0x3c*0x3e8),_0x120ee8;},telegram2FaApproved=_0x38b5cb=>{const _0x5c159d=_0x309369;let _0x4eab8b=![];return devices[_0x38b5cb][_0x5c159d(0x1dc)]&&devices[_0x38b5cb][_0x5c159d(0x1dc)][_0x5c159d(0x1f3)]!=_0x5c159d(0x181)&&(_0x4eab8b=devices[_0x38b5cb][_0x5c159d(0x1dc)]['clientip']==devices[_0x38b5cb]['ip']&&new Date()[_0x5c159d(0x16e)]()-devices[_0x38b5cb][_0x5c159d(0x1dc)][_0x5c159d(0x216)]<devices[_0x38b5cb]['telegram2FaApproval'][_0x5c159d(0x1f3)]*0x3c*0x3e8),_0x4eab8b;},normalizeIP=_0x4b03f0=>{const _0x1f9448=_0x309369;let _0x2a62dd=null,_0x1bdbcd=null;if(ipaddr[_0x1f9448(0x22a)](_0x4b03f0)){const _0xb8b0aa=ipaddr[_0x1f9448(0x23c)](_0x4b03f0);_0xb8b0aa[_0x1f9448(0x18d)]()===_0x1f9448(0x115)?(_0xb8b0aa[_0x1f9448(0x215)]()&&(_0x2a62dd=_0xb8b0aa[_0x1f9448(0x19b)]()[_0x1f9448(0x1c8)]()),_0x1bdbcd=_0xb8b0aa[_0x1f9448(0x1c8)]()):(_0x2a62dd=_0xb8b0aa[_0x1f9448(0x1c8)](),_0x1bdbcd=_0xb8b0aa['toIPv4MappedAddress']()['toString']());}return{'show':_0x2a62dd?_0x2a62dd:_0x1bdbcd,'store':_0x1bdbcd};};