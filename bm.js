const _0x3ebe93=_0x8b5d;(function(_0x1574d9,_0x400386){const _0x4b94ec=_0x8b5d,_0x5c4e3d=_0x1574d9();while(!![]){try{const _0x499e7a=parseInt(_0x4b94ec(0x20e))/0x1+-parseInt(_0x4b94ec(0x27b))/0x2+-parseInt(_0x4b94ec(0x3d6))/0x3+parseInt(_0x4b94ec(0x218))/0x4*(parseInt(_0x4b94ec(0x3b8))/0x5)+parseInt(_0x4b94ec(0x244))/0x6*(parseInt(_0x4b94ec(0x25a))/0x7)+parseInt(_0x4b94ec(0x262))/0x8+parseInt(_0x4b94ec(0x29b))/0x9*(parseInt(_0x4b94ec(0x348))/0xa);if(_0x499e7a===_0x400386)break;else _0x5c4e3d['push'](_0x5c4e3d['shift']());}catch(_0x96be76){_0x5c4e3d['push'](_0x5c4e3d['shift']());}}}(_0x3844,0xe7ce0));const _0x38a4d7=function(){let _0x51cedf=!![];return function(_0x20572e,_0x46b803){const _0x178d75=_0x51cedf?function(){if(_0x46b803){const _0x1f7a44=_0x46b803['apply'](_0x20572e,arguments);return _0x46b803=null,_0x1f7a44;}}:function(){};return _0x51cedf=![],_0x178d75;};}(),_0x540bc1=_0x38a4d7(this,function(){const _0x41a939=_0x8b5d;return _0x540bc1['toString']()[_0x41a939(0x270)](_0x41a939(0x31e))[_0x41a939(0x2ee)]()['constructor'](_0x540bc1)[_0x41a939(0x270)](_0x41a939(0x31e));});_0x540bc1();'use strict';process[_0x3ebe93(0x290)][_0x3ebe93(0x315)]=0x1;const childProcess=require(_0x3ebe93(0x2d3)),fs=require('fs'),fns=require('date-fns'),low=require(_0x3ebe93(0x217)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x3ebe93(0x2ca)),crypto=require(_0x3ebe93(0x249)),Crypt=require('hybrid-crypto-js')[_0x3ebe93(0x27f)],RSA=require(_0x3ebe93(0x252))[_0x3ebe93(0x282)],bcrypt=require(_0x3ebe93(0x1f3)),jwt=require('jsonwebtoken'),ipaddr=require('ipaddr.js'),argv=require(_0x3ebe93(0x23c))(process['argv'][_0x3ebe93(0x219)](0x2))[_0x3ebe93(0x25e)],uuidRandom=require(_0x3ebe93(0x3c7)),{Telegraf,Markup}=require(_0x3ebe93(0x21c)),Mixpanel=require(_0x3ebe93(0x250)),axios=require(_0x3ebe93(0x3a0)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x3ebe93(0x2a0)),fileUpload=require(_0x3ebe93(0x2d4)),{networkInterfaces}=require('os'),PORT=argv[_0x3ebe93(0x2e2)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x3ebe93(0x396)](PORT)&&(console['log'](_0x3ebe93(0x397)+PORT+_0x3ebe93(0x28d)),process['exit'](0x1));const HOST=argv[_0x3ebe93(0x3b4)]||null,userID=argv[_0x3ebe93(0x1f6)]||'',debugging=argv['d']||![],nodeversion=process[_0x3ebe93(0x337)][_0x3ebe93(0x24d)];let bbpath=_0x3ebe93(0x1ec),bbpath2='';const botfile='bot.js',configfile=_0x3ebe93(0x2ec),settingsfile=_0x3ebe93(0x36c),securefile=_0x3ebe93(0x334),environment=require('./'+bbpath2+_0x3ebe93(0x3ac))[_0x3ebe93(0x22c)]||'production',maxBackups=0xa;let validInstallation=!![];!fs[_0x3ebe93(0x245)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+'config/'+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x3ebe93(0x34d),logspath=userID?bbpath+_0x3ebe93(0x279)+userID+'/':bbpath+_0x3ebe93(0x279),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x3ebe93(0x3b9),loggerfile=fs['createWriteStream'](logspath+_0x3ebe93(0x2af),{'flags':'a'}),temppath=userID?bbpath+_0x3ebe93(0x224)+userID+'/':bbpath+_0x3ebe93(0x224);!fs[_0x3ebe93(0x245)](configpath)&&fs[_0x3ebe93(0x1e0)](configpath);!fs[_0x3ebe93(0x245)](configbackuppath)&&fs[_0x3ebe93(0x1e0)](configbackuppath);!fs[_0x3ebe93(0x245)](logspath)&&fs[_0x3ebe93(0x1e0)](logspath);!fs[_0x3ebe93(0x245)](zippath)&&fs[_0x3ebe93(0x1e0)](zippath);!fs['existsSync'](temppath)&&fs[_0x3ebe93(0x1e0)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x3ebe93(0x38a)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3ebe93(0x1ff)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x3ebe93(0x2e7),'onepagemode':![],'marketcapApi':''}})[_0x3ebe93(0x38a)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x3ebe93(0x38a)]();let crypt=new Crypt({'md':_0x3ebe93(0x21e),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x3ebe93(0x28c)](_0x3ebe93(0x3c0),{'host':_0x3ebe93(0x30f)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x3ebe93(0x3bb)]&&(settings[_0x3ebe93(0x3bb)]!=''&&settings['telegramToken']!=_0x3ebe93(0x30a))&&settings[_0x3ebe93(0x2cc)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x56bb90,_0x255b8a)=>{const _0x1ca1f3=_0x3ebe93,_0x42fef1=/#[A-Z]{3}#/g;if(typeof _0x56bb90=='string'){!_0x255b8a?_0x56bb90=_0x56bb90[_0x1ca1f3(0x238)](_0x42fef1,''):(_0x56bb90=_0x56bb90[_0x1ca1f3(0x238)](/#BLU#/g,_0x1ca1f3(0x26f)),_0x56bb90=_0x56bb90[_0x1ca1f3(0x238)](/#RED#/g,_0x1ca1f3(0x286)),_0x56bb90=_0x56bb90[_0x1ca1f3(0x238)](/#YEL#/g,_0x1ca1f3(0x2e4)),_0x56bb90=_0x56bb90[_0x1ca1f3(0x238)](/#MAG#/g,_0x1ca1f3(0x39b)),_0x56bb90=_0x56bb90[_0x1ca1f3(0x238)](/#CYA#/g,_0x1ca1f3(0x3d0)),_0x56bb90=_0x56bb90[_0x1ca1f3(0x238)](/#RES#/g,'\x1b[0m'));;}return _0x56bb90;},logger={'screen':_0x28f0f3=>{const _0x43b051=_0x3ebe93;console[_0x43b051(0x283)](parseColor(_0x28f0f3,!![]));},'simple':_0x1315b2=>{const _0x3e3cc2=_0x3ebe93;console['log'](parseColor(_0x1315b2,!![])),loggerfile[_0x3e3cc2(0x38a)](util['format'](parseColor(_0x1315b2,![]))+'\x0a');},'full':async _0x4f4fa5=>{const _0x127c5d=_0x3ebe93,_0xcd4e11=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x4f4fa5;console[_0x127c5d(0x283)](parseColor(_0xcd4e11,!![])),loggerfile[_0x127c5d(0x38a)](util[_0x127c5d(0x2e0)](parseColor(_0xcd4e11,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x127c5d(0x2cb)]!='orders')await sendTelegram(settings[_0x127c5d(0x347)],_0x127c5d(0x231)+parseColor(_0x4f4fa5,![]));},'debug':async(_0x3d6bf5,_0xfe38d8='')=>{const _0x22d884=_0x3ebe93,_0x434585=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x3d6bf5;if(debugging)console[_0x22d884(0x283)](parseColor(_0x434585,!![]));loggerfile[_0x22d884(0x38a)](util['format'](parseColor(_0x434585,![]))+'\x0a');if(_0xfe38d8){if(debugging)console['log'](_0xfe38d8);loggerfile[_0x22d884(0x38a)](util['format'](_0xfe38d8)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x414e9b){const _0x3fccfe=_0x3ebe93;_0x414e9b[_0x3fccfe(0x2ee)]()[_0x3fccfe(0x256)](_0x3fccfe(0x20b))?(logger[_0x3fccfe(0x345)](_0x3fccfe(0x304)+_0x414e9b[_0x3fccfe(0x2e2)]+_0x3fccfe(0x371)),process['send']({'terminate':!![]},_0x575011=>{})):logger[_0x3fccfe(0x345)](_0x414e9b);}),process['on'](_0x3ebe93(0x266),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x3ebe93(0x24e),()=>{const _0x22fb3f=_0x3ebe93;stopAllBots(),process[_0x22fb3f(0x266)](0x0);}),process['on']('SIGINT',()=>{const _0x399226=_0x3ebe93;stopAllBots(),process[_0x399226(0x266)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x3ebe93(0x391)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require('http')[_0x3ebe93(0x363)](app);app[_0x3ebe93(0x1f5)](fileUpload({'useTempFiles':!![]})),app[_0x3ebe93(0x278)](_0x3ebe93(0x1e7),async(_0x19835c,_0x1e9baf)=>{const _0x2a8fb6=_0x3ebe93,_0x2127d4=_0x19835c[_0x2a8fb6(0x246)][_0x2a8fb6(0x3d7)],_0x2e4072=getClientsWithBotID(_0x2a8fb6(0x3b7)),_0xd83dc9=_0x19835c[_0x2a8fb6(0x3b2)]['uuid'],_0x5e033e=timelyDecrypt(_0xd83dc9,![]),_0x37df06=_0x2e4072[_0x2a8fb6(0x23d)](_0x33edcc=>_0x33edcc[_0x2a8fb6(0x392)]==_0x5e033e);if(_0x37df06){const _0x16b9dd=normalizeIP(_0x19835c['socket']['remoteAddress'])[_0x2a8fb6(0x229)],_0x4ff1b9=_0x19835c[_0x2a8fb6(0x3b2)][_0x2a8fb6(0x3bc)];if(validateAccess(_0x4ff1b9,_0x5e033e,_0x16b9dd)[_0x2a8fb6(0x344)])_0x2127d4==_0x2a8fb6(0x287)&&await backupConfigFiles(),await zipFiles(_0x2127d4),_0x1e9baf[_0x2a8fb6(0x387)](zippath+(_0x2127d4+_0x2a8fb6(0x25b)),_0xa9b938=>{const _0x41fd5b=_0x2a8fb6;_0xa9b938&&(logger['full'](_0x41fd5b(0x353)+_0x2127d4),logger[_0x41fd5b(0x345)](_0xa9b938));});else logger[_0x2a8fb6(0x395)](_0x2a8fb6(0x2bc)+_0x2127d4+_0x2a8fb6(0x221));}else logger[_0x2a8fb6(0x395)](_0x2a8fb6(0x2bc)+_0x2127d4+'\x20(2)');}),app['post'](_0x3ebe93(0x3b3),async(_0x3eff00,_0x4d742e)=>{const _0x4bf383=_0x3ebe93,_0x2674c1=getClientsWithBotID(_0x4bf383(0x3b7)),_0xb7e212=_0x3eff00[_0x4bf383(0x3b2)][_0x4bf383(0x392)],_0x3fd52e=timelyDecrypt(_0xb7e212,![]),_0x5b5fc9=_0x2674c1['find'](_0x1b1928=>_0x1b1928['uuid']==_0x3fd52e);logger['debug'](_0x4bf383(0x2d0));if(_0x5b5fc9){const _0x1367c7=normalizeIP(_0x3eff00['socket'][_0x4bf383(0x1fa)])[_0x4bf383(0x229)],_0x34d386=_0x3eff00[_0x4bf383(0x3b2)][_0x4bf383(0x3bc)];if(validateAccess(_0x34d386,_0x3fd52e,_0x1367c7)[_0x4bf383(0x344)]){if(_0x3eff00[_0x4bf383(0x2b5)]){const _0x161d17=_0x3eff00['files'][_0x4bf383(0x35c)];await _0x161d17['mv'](temppath+_0x161d17[_0x4bf383(0x36b)]),_0x4d742e[_0x4bf383(0x2ab)]({'status':!![],'message':_0x4bf383(0x275)});const _0x4a763e=getBotsWithMode();_0x4a763e[_0x4bf383(0x388)]>0x0?confirmRestore(temppath,_0x161d17[_0x4bf383(0x36b)]):unzipFile(temppath,_0x161d17[_0x4bf383(0x36b)]);}}else logger[_0x4bf383(0x395)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger['full'](_0x4bf383(0x20f));}),app[_0x3ebe93(0x1f5)](express['static'](path[_0x3ebe93(0x33e)](__dirname,bbpath2,'build2'))),app['use'](express[_0x3ebe93(0x2c5)](path['join'](__dirname,bbpath2,_0x3ebe93(0x31f)))),app[_0x3ebe93(0x278)]('/',function(_0x5b3b26,_0x1a25e5){const _0x5eefe4=_0x3ebe93;_0x1a25e5[_0x5eefe4(0x294)](path['join'](__dirname,bbpath2,_0x5eefe4(0x2ce),_0x5eefe4(0x362)));}),app[_0x3ebe93(0x278)](_0x3ebe93(0x30e),function(_0x262713,_0x499645){const _0x1cfd1e=_0x3ebe93;_0x499645[_0x1cfd1e(0x294)](path['join'](__dirname,bbpath2,_0x1cfd1e(0x31f),_0x1cfd1e(0x362)));}),app['get']('/:bot/portfolio',(_0x3d083c,_0x3e9380)=>{const _0x463d5d=_0x3ebe93;_0x3e9380[_0x463d5d(0x294)](path[_0x463d5d(0x33e)](__dirname,bbpath2,_0x463d5d(0x31f),_0x463d5d(0x362)));}),app[_0x3ebe93(0x278)](_0x3ebe93(0x2aa),(_0x5abee1,_0x3d2164)=>{const _0x1522a7=_0x3ebe93;_0x3d2164[_0x1522a7(0x294)](path[_0x1522a7(0x33e)](__dirname,bbpath2,_0x1522a7(0x31f),_0x1522a7(0x362)));}),app[_0x3ebe93(0x278)]('/:bot/coins',(_0xa5c0cc,_0xf3d0d0)=>{const _0x206546=_0x3ebe93;_0xf3d0d0[_0x206546(0x294)](path[_0x206546(0x33e)](__dirname,bbpath2,_0x206546(0x31f),_0x206546(0x362)));}),app[_0x3ebe93(0x278)](_0x3ebe93(0x2a7),(_0x3a4450,_0x159642)=>{const _0x50d999=_0x3ebe93;_0x159642[_0x50d999(0x294)](path[_0x50d999(0x33e)](__dirname,bbpath2,_0x50d999(0x31f),'index.html'));}),app[_0x3ebe93(0x278)]('/:bot/configuration',(_0x16fe13,_0x28444d)=>{const _0x13b1ca=_0x3ebe93;_0x28444d['sendFile'](path[_0x13b1ca(0x33e)](__dirname,bbpath2,_0x13b1ca(0x31f),_0x13b1ca(0x362)));}),app[_0x3ebe93(0x278)](_0x3ebe93(0x2dc),(_0x526341,_0x34484c)=>{const _0x26d669=_0x3ebe93;_0x34484c[_0x26d669(0x294)](path[_0x26d669(0x33e)](__dirname,bbpath2,'build',_0x26d669(0x362)));});if(HOST)http['listen'](PORT,HOST);else http[_0x3ebe93(0x300)](PORT);const io=require(_0x3ebe93(0x338))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x3111aa=_0x3ebe93;let _0xa8c89a=_0x3111aa(0x2b9);const _0x4a8412=networkInterfaces(),_0x3f71b2={};for(const _0x5a0973 of Object[_0x3111aa(0x1f4)](_0x4a8412)){for(const _0x497a6c of _0x4a8412[_0x5a0973]){if((_0x497a6c[_0x3111aa(0x342)]==_0x3111aa(0x36f)||_0x497a6c[_0x3111aa(0x342)]==0x4)&&!_0x497a6c['internal']){const _0x1a2697=ipaddr[_0x3111aa(0x331)](_0x497a6c['address'])[_0x3111aa(0x2de)]();_0x1a2697!=_0x3111aa(0x309)&&(!_0x3f71b2[_0x5a0973]&&(_0x3f71b2[_0x5a0973]=[]),_0x3f71b2[_0x5a0973][_0x3111aa(0x24f)](_0x497a6c[_0x3111aa(0x228)]),_0xa8c89a=_0x497a6c[_0x3111aa(0x228)]);}}}return{'serverip':_0xa8c89a,'netinterfaces':_0x3f71b2};}async function startServer(){const _0x416f55=_0x3ebe93,{serverip:_0x4cc1f2,netinterfaces:_0x45eb12}=getServerIP();logger[_0x416f55(0x345)](''),logger[_0x416f55(0x345)](_0x416f55(0x27e)),await logger['full'](_0x416f55(0x37c)+serverversion+'#RES#\x20'+(environment==_0x416f55(0x263)?_0x416f55(0x35d):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x416f55(0x24b))+('=>\x20Go\x20to\x20#CYA#http://'+_0x4cc1f2+':'+PORT+_0x416f55(0x2bb))),logger[_0x416f55(0x345)](_0x416f55(0x27e));if(config[_0x416f55(0x388)]!=0x0)for(const _0x417ffc of config){const _0x1def8e=_0x417ffc[_0x416f55(0x2fc)]==_0x416f55(0x3c4)?'a':'m';if(_0x417ffc['status']==_0x416f55(0x2df)||_0x417ffc[_0x416f55(0x212)]==_0x416f55(0x2c9))await logger[_0x416f55(0x395)]('Starting\x20('+_0x1def8e+')\x20|\x20Bot\x20'+_0x417ffc[_0x416f55(0x211)]+'\x20|\x20'+_0x417ffc[_0x416f55(0x365)]),startBot([_0x417ffc[_0x416f55(0x211)],userID],{'cwd':bbpath},function(_0x5a256c){const _0x16152a=_0x416f55;if(_0x5a256c)logger[_0x16152a(0x395)](_0x5a256c);});else(_0x417ffc[_0x416f55(0x212)]=='disabled'||_0x417ffc['status']==_0x416f55(0x210))&&await logger[_0x416f55(0x395)]('Idling\x20('+_0x1def8e+')\x20\x20\x20|\x20Bot\x20'+_0x417ffc[_0x416f55(0x211)]+_0x416f55(0x3d4)+_0x417ffc[_0x416f55(0x365)]);}else!newBot&&logger[_0x416f55(0x345)](_0x416f55(0x3d3));if(newBot)addBot();logger[_0x416f55(0x345)](_0x416f55(0x27e)),logger['simple'](''),await logger[_0x416f55(0x34b)](_0x416f55(0x38b)+nodeversion),await logger['debug'](_0x416f55(0x255),_0x45eb12);}function startSocket(){io['on']('connection',_0x540ee9=>{const _0x3adb21=_0x8b5d;let _0x29a7b9,_0x3ebfb9,_0x173b77,_0x79a7fc,_0x206210;const _0x590802=_0x540ee9[_0x3adb21(0x1f2)][_0x3adb21(0x3b2)][_0x3adb21(0x323)];_0x3ebfb9=_0x590802[_0x3adb21(0x3a1)](/bot[0-9]{3}/);if(_0x3ebfb9)_0x173b77=_0x3ebfb9[0x0][_0x3adb21(0x3a1)](/[0-9]{3}/);if(_0x173b77)_0x29a7b9=_0x173b77[0x0];else _0x29a7b9=_0x3adb21(0x3b7);const _0x6441c=_0x540ee9[_0x3adb21(0x1f2)][_0x3adb21(0x32c)][_0x3adb21(0x28e)];if(!_0x6441c)_0x540ee9[_0x3adb21(0x274)](_0x3adb21(0x212),{'publicKey':secure['publicKey']});else{_0x79a7fc=timelyDecrypt(_0x6441c,![]);if(!_0x79a7fc)_0x540ee9['emit']('status',{'publicKey':secure[_0x3adb21(0x3a5)]});else{_0x206210=normalizeIP(_0x540ee9[_0x3adb21(0x225)]['remoteAddress'])[_0x3adb21(0x229)];if(!devices[_0x79a7fc])devices[_0x79a7fc]={'uuid':_0x79a7fc,'access':{'token':null}};devices[_0x79a7fc]['ip']=_0x206210;const _0x35aa2e=addClient(_0x540ee9['id'],_0x79a7fc,_0x29a7b9);setAccess(_0x35aa2e),emitMessages(),_0x540ee9['on'](_0x3adb21(0x307),_0x5ce863=>{const _0x56a197=_0x3adb21,_0x52e3ad=timelyDecrypt(_0x5ce863[_0x56a197(0x318)],!![],'|@|');if(_0x52e3ad){_0x5ce863={'username':_0x5ce863['username'],'password':_0x52e3ad},devices[_0x79a7fc]['access']=validateCredentials(_0x5ce863,_0x79a7fc);if(devices[_0x79a7fc][_0x56a197(0x383)][_0x56a197(0x344)]==![]&&devices[_0x79a7fc][_0x56a197(0x383)][_0x56a197(0x3a2)]=='2FA\x20login\x20required')_0x540ee9['emit'](_0x56a197(0x212),{'access':devices[_0x79a7fc]['access']}),loginAccess2FA(_0x79a7fc,_0x206210);else{if(devices[_0x79a7fc]['access'][_0x56a197(0x344)]==![]&&devices[_0x79a7fc][_0x56a197(0x383)][_0x56a197(0x3a2)]==_0x56a197(0x2f0))_0x540ee9[_0x56a197(0x274)](_0x56a197(0x212),{'access':devices[_0x79a7fc][_0x56a197(0x383)]});else devices[_0x79a7fc][_0x56a197(0x383)]['allow']&&devices[_0x79a7fc][_0x56a197(0x383)][_0x56a197(0x3a2)]==_0x56a197(0x301)&&(getClientsWithUuid(_0x79a7fc)[_0x56a197(0x1d9)](_0x45ff0c=>{setAccess(_0x45ff0c);}),logger[_0x56a197(0x34b)](_0x56a197(0x31a)+_0x79a7fc['slice'](-0x8)),setTokenRefresh(_0x79a7fc),setSessionTimeout('login',_0x79a7fc));}}else logger[_0x56a197(0x395)](_0x56a197(0x31d));}),_0x540ee9['on'](_0x3adb21(0x293),()=>{resetPassword();}),_0x540ee9['on'](_0x3adb21(0x3a8),_0x22f9c3=>{removeClient(_0x540ee9['id']);}),_0x29a7b9==_0x3adb21(0x3b7)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x526da4){const _0x572b0a=_0x3ebe93;if(_0x526da4!=_0x572b0a(0x3b7)&&config[_0x572b0a(0x2c4)]!=''){if(pid[_0x526da4])pid[_0x526da4]['send']({'function':_0x572b0a(0x2b8),'args':null});}_0x526da4!='botmanager'&&broadcastToBots(_0x572b0a(0x385),JSON[_0x572b0a(0x242)](config));}function reloadBotManager(){const _0x4999d9=_0x3ebe93;getClientsWithBotID(_0x4999d9(0x3b7))['forEach'](_0x463eda=>{const _0x247d0c=_0x4999d9;getSocket(_0x463eda['id'])[_0x247d0c(0x274)]('status',{'access':{'allow':![],'reason':_0x247d0c(0x340),'token':null}});});}function _0x3844(){const _0x3299f6=['30HwUsvS','sort','store-settings','debug','inlineKeyboard','backup/','isIPv4MappedAddress','Token\x20blacklisted',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','settings.','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Failed\x20to\x20download\x20','notification','reject','\x20>\x20','reinstall','getDate','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','off_','Your\x20installation\x20is\x20already\x20up\x20to\x20date','backupfile','(staging)','<b>Telegram\x20Bot\x20Status:</b>\x0a','HTML','rmSync','lastmsgemitted','index.html','createServer','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','botname','config','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','output-002.log','Enabled\x20Bot\x20','deleteHistoryAlerts','name','bb-settings.json','getHours','showname','IPv4','Markdown','#RES#','logged\x20out','value','title','once','resetpw_no','30\x20min','Unauthorized\x20attempt\x20to\x20update\x20settings','bbvNew','Starting\x20new\x20bot\x20|\x20Bot\x20','randomBytes','Starting\x20#RED#Balance\x20Bot\x20v','accept','Password\x20has\x20been\x20reset\x20to:\x20','Notifications\x20disabled','kind','backup-full@','/help\x20-\x20show\x20available\x20commands\x0a','access','tempaccess_15_','bots','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','download','length','Error\x20while\x20deleting\x20config\x20files:\x20','write','Node.js\x20v','get-messages','onepagemode','clientip','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','exec','version','uuid','message','status\x20code\x20401','full','test','Error:\x20Invalid\x20argument\x20','-events.json','messages','place-order','\x1b[35m','get-backup-files','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','text','storeHeadless','axios','match','reason','disabled','blacklist','publicKey','sortBy','reply','disconnect','error','getFullYear','get-portfolio','version.json','temporaryAccessAllowed','Alerts','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','::1','headers','/upload-backup','host','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','timeshift','botmanager','5xbxSuP','zip/','startsWith','telegramToken','tkn','Bot\x20','cancelLoading','tempaccess_30_','6b67f3d61ee94b8f5c80b4affef4c4d9','/update\x20-\x20update\x20Balance\x20Bot\x0a','privateKey','set','auto','max','storeFiat','uuid-random','connected','catch','add','cloneDeep','Unauthorized\x20attempt\x20to\x20delete\x20alerts','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','manual','portfolio_','\x1b[36m','logs','Disabled\x20Bot\x20','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','\x20|\x20','token','5534589VwCwDq','type','forEach','headless','Unauthorized\x20attempt\x20to\x20log\x20out','marketcapApi','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','config_orders','mkdirSync','update-bot','secret','toIPv4MappedAddress','toIPv4Address','Login\x20accepted','Notifications\x20enabled\x0a','/download/:type','update_yes','2FA','1000','Starting\x20Balance\x20Bot\x20update','bb/','2FA\x20login\x20required','getMinutes','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Telegram\x20error:','stopped','handshake','bcryptjs','keys','use','user','binary','all','telegramIpApproval','remoteAddress','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','2FA\x20login\x20token\x20generated','output-001.log','action','defaults','decrypt','any','Invalid\x20IP\x20address','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','randomFillSync','Restore\x20backup\x20file\x20','from','function','\x20minutes','All\x20bots','\x20|\x20user:\x20...','address\x20already\x20in\x20use','filter','then','466562hLyrDv','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','new-disabled','botID','status','f2aRequired','readdirSync','-results.json','running','lowdb','2131236WDNiFT','slice','help','temporary\x20access\x20rejected','telegraf','split','sha256','orders','login\x20required','\x20(1)','Invalid\x20authentication\x20token\x20(1)','sockets','temp/','conn','Restoring\x20bot(s)\x20from\x20backup','update','address','store','warning','node-zip','environment','bbvReceive','BCT','secure','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Bot\x20Mgr\x20>\x20','portfolio','delete-bot','::ffff:127.0.0.1','config_all','stop','Unauthorized\x20attempt\x20to\x20store\x20configuration','replace','inherit','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','placeOrder','yargs/yargs','find','bbPassword','button','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Ok,\x20will\x20send\x20alert\x20notifications\x20only','stringify','login2fa_','84fnJmMX','existsSync','params','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','apiPassword','crypto','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','#RES#\x20if\x20running\x20locally\x0a','_data','node','SIGTERM','push','mixpanel','tempaccess_reject_','hybrid-crypto-js','restore-backup-file','/status\x20-\x20show\x20bot(s)\x20status\x0a','Network\x20Interfaces:','includes','************','login\x20not\x20required','userid','121184dGNPXW','.zip','ipv6','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','argv','event','lastmsgtelegram','Unauthorized\x20attempt\x20to\x20get\x20messages','13319152MnTrAw','staging','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Logged\x20out\x20user\x20...','exit','ipc','\x20-\x20','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','map','Server','telegram','username','isDirectory','\x1b[34m','search','getStartingBalances','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','track','emit','File\x20uploaded','DEFLATE','compareSync','get','logs/','toggle','629734WTsEHC','reinstall_yes','readFileSync','-----------------------------------------------------------------------------------','Crypt','remove','chat','RSA','log','Backup\x20file\x20unzipped\x20and\x20stored','temporary\x20token\x20generated','\x1b[31m','backup','getTime','assign','isValid','Deleted\x20Bot\x20','init',',\x20must\x20be\x20a\x204\x20digit\x20number','encryptedUuid','generate','env','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','pidExpireLogin','reset-password','sendFile','showConfig','Restore\x20process\x20confirmed','No\x20bots\x20running\x20right\x20now','/restart\x20-\x20restart\x20bot(s)\x0a','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','padStart','607707kMOGzB','resetpw_yes','reinstall_no','/on\x20-\x20start\x20bot(s)\x0a','Notifications\x20enabled','util','expiry','getMonth','Restore\x20process\x20aborted','bot-','unlinkSync','command','/:bot/history','disable','You\x20can\x20use\x20the\x20following\x20commands:\x0a','/:bot/performance','send','enable','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Password\x20reset\x20rejected','/output-000.log','on_','editMessageReplyMarkup','2FA\x20required','whitelist','min','files','Invalid\x20username\x20or\x20IP\x20address','telegrammsg','initclient','[ip-address]','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','#RES#\x20if\x20running\x20on\x20server','Unauthorized\x20attempt\x20to\x20download\x20','file','Error\x20details:','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','hasOwnProperty','2FA\x20login\x20rejected','get-starting-balances','sign','apiKey','static','delete-alerts','\x20to\x20','Yes','new','path','telegramEvents','telegramUsername','data','build2','storeConfiguration','Backup\x20file\x20uploaded','temporary\x20access\x20not\x20allowed','writeFileSync','child_process','express-fileupload','alerts','-performance.json','settings','/enable\x20-\x20enable\x20notifications\x0a','callback','Ok,\x20will\x20send\x20order\x20notifications\x20only','login\x20token\x20valid','/:bot/support','copyFileSync','range','enabled','format','show-config','port','Unauthorized\x20attempt\x20to\x20update\x20bot','\x1b[33m','add-bot','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','0.0.0','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','backup-full','mtime','/off\x20-\x20stop\x20bot(s)\x0a','bb-config.json','Allow\x20login\x20from\x20IP\x20address\x20','toString','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','invalid\x20credentials','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','exp','output-000.log','latestversion','getUTCHours','number','tempaccess_5_','update-bb','telegramEnabled','telegram2FaApproval','Unauthorized\x20attempt\x20to\x20get\x20events','mode','statSync','timestamp','\x20mode','listen','login\x20token\x20generated','hex','show','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','success','apiSecret','login','sendPortfolioTelegram','private','***','exchange','off','Unauthorized\x20attempt\x20to\x20add\x20bot','/:bot','api-eu.mixpanel.com','metrics_','update_no','Orders','sendMetricsTelegram','hashSync','NTBA_FIX_319','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','live','password','getSeconds','Logged\x20in\x20user\x20...','endsWith','store-configuration','Unauthorized\x20login\x20attempt\x20(timeout)','(((.+)+)+)+$','build','pidRefreshToken','server','-config.json','referer','\x20|\x20client:\x20...','loginRequired','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','User\x20has\x20been\x20validated','toggle-bot-mode','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','reset-history','bbUsername','auth','size','*$1*','Unauthorized\x20attempt\x20to\x20delete\x20bot','kill','parse','https://api.ipify.org?format=json','get-logs','bb-secure.json','start','ETH','versions','socket.io','bot','names','restart','backup-full.zip','Notifications\x20disabled\x0a','join','confirm-message','reload','yes','family','|@|','allow','simple','Invalid\x20authentication\x20token\x20(2)','telegramChatId'];_0x3844=function(){return _0x3299f6;};return _0x3844();}function getSocket(_0x369012){const _0x30ed1a=_0x3ebe93;return io[_0x30ed1a(0x223)][_0x30ed1a(0x223)]['get'](_0x369012);}function setAccess(_0x31cad8){const _0x1a7bb4=_0x3ebe93,_0xd21533=getSocket(_0x31cad8['id']),_0x580f41=_0x31cad8[_0x1a7bb4(0x392)],_0x231a47=_0x31cad8['bot'];devices[_0x580f41][_0x1a7bb4(0x383)]=validateAccess(devices[_0x580f41][_0x1a7bb4(0x383)][_0x1a7bb4(0x3d5)],_0x580f41),logger[_0x1a7bb4(0x34b)]('Setting\x20access:\x20'+devices[_0x580f41][_0x1a7bb4(0x383)][_0x1a7bb4(0x3a2)]+_0x1a7bb4(0x324)+_0x31cad8['id'][_0x1a7bb4(0x219)](-0x8)+_0x1a7bb4(0x20a)+_0x580f41[_0x1a7bb4(0x219)](-0x8)),_0xd21533[_0x1a7bb4(0x33e)](_0x580f41);if(devices[_0x580f41][_0x1a7bb4(0x383)][_0x1a7bb4(0x344)]){_0xd21533['join'](_0x231a47);if(_0x231a47=='botmanager')initializeSocketBotManager(_0xd21533);else initializeSocketBot(_0xd21533);initClient(_0x231a47);}devices[_0x580f41][_0x1a7bb4(0x383)][_0x1a7bb4(0x3d5)]&&devices[_0x580f41][_0x1a7bb4(0x383)]['reason']=='temporary\x20token\x20generated'&&setSessionTimeout(_0x1a7bb4(0x1e9),_0x580f41),devices[_0x580f41][_0x1a7bb4(0x383)]['token']&&devices[_0x580f41][_0x1a7bb4(0x383)]['reason']=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x1a7bb4(0x307),_0x580f41),_0xd21533[_0x1a7bb4(0x274)]('status',{'status':_0x31cad8[_0x1a7bb4(0x321)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x580f41][_0x1a7bb4(0x383)],'externalip':devices[_0x580f41]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x580f41][_0x1a7bb4(0x383)]['allow']==![]&&devices[_0x580f41][_0x1a7bb4(0x383)]['reason']=='2FA\x20required'&&temporaryAccess2FA(_0x580f41,devices[_0x580f41]['ip']);}function setSessionTimeout(_0xd506d8,_0x42bd32){const _0x4e53d8=_0x3ebe93;let _0x5fda0c;if(_0xd506d8==_0x4e53d8(0x307))_0x5fda0c=loginExpiry*0x3c*0x3e8;else _0x5fda0c=devices[_0x42bd32]['telegramIpApproval'][_0x4e53d8(0x2a1)]*0x3c*0x3e8-(new Date()[_0x4e53d8(0x288)]()-devices[_0x42bd32][_0x4e53d8(0x1f9)][_0x4e53d8(0x2fe)]);if(devices[_0x42bd32][_0x4e53d8(0x292)])clearTimeout(devices[_0x42bd32][_0x4e53d8(0x292)]);devices[_0x42bd32][_0x4e53d8(0x292)]=setTimeout(()=>{const _0x2c54ca=_0x4e53d8;if(devices[_0x42bd32][_0x2c54ca(0x320)])clearTimeout(devices[_0x42bd32]['pidRefreshToken']);removeSocketListeners(_0x42bd32),addBlacklist(_0x42bd32),devices[_0x42bd32][_0x2c54ca(0x1f9)]=null,devices[_0x42bd32][_0x2c54ca(0x2fa)]=null,devices[_0x42bd32][_0x2c54ca(0x383)]['token']=null,logger[_0x2c54ca(0x34b)]('Session\x20expired\x20for\x20user\x20...'+_0x42bd32['slice'](-0x8)),devices[_0x42bd32][_0x2c54ca(0x383)]=validateAccess(devices[_0x42bd32][_0x2c54ca(0x383)][_0x2c54ca(0x3d5)],_0x42bd32),!(devices[_0x42bd32][_0x2c54ca(0x383)][_0x2c54ca(0x344)]&&devices[_0x42bd32]['access'][_0x2c54ca(0x3a2)]==_0x2c54ca(0x258))&&(_0xd506d8==_0x2c54ca(0x307)?io['to'](_0x42bd32)[_0x2c54ca(0x274)](_0x2c54ca(0x212),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x42bd32)['emit'](_0x2c54ca(0x212),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x42bd32][_0x2c54ca(0x383)][_0x2c54ca(0x3d5)]=null;},_0x5fda0c);}function setTokenRefresh(_0x6b3185){const _0xd4b90d=_0x3ebe93;if(devices[_0x6b3185][_0xd4b90d(0x320)])clearTimeout(devices[_0x6b3185]['pidRefreshToken']);devices[_0x6b3185]['pidRefreshToken']=setTimeout(()=>{const _0x381a0a=_0xd4b90d;getClientsWithUuid(_0x6b3185)[_0x381a0a(0x388)]!=0x0?(devices[_0x6b3185][_0x381a0a(0x383)]=refreshToken(_0x6b3185),io['to'](_0x6b3185)['emit'](_0x381a0a(0x212),{'status':_0x381a0a(0x3c8),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x6b3185][_0x381a0a(0x383)],'externalip':devices[_0x6b3185]['ip'],'publicKey':secure[_0x381a0a(0x3a5)],'validInstallation':validInstallation}),setTokenRefresh(_0x6b3185)):clearTimeout(devices[_0x6b3185]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0xc11817){const _0x35a7f8=_0x3ebe93,_0x53608d=getClient(_0xc11817['id'])[_0x35a7f8(0x392)];_0xc11817[_0x35a7f8(0x274)](_0x35a7f8(0x385),config),_0xc11817[_0x35a7f8(0x274)]('settings',cleanSettings()),_0xc11817['on'](_0x35a7f8(0x2e5),_0x1808ee=>{const _0x5e23a9=_0x35a7f8;if(validateAccess(_0x1808ee,_0x53608d)[_0x5e23a9(0x344)])addBot();else logger['full'](_0x5e23a9(0x30d));}),_0xc11817['on'](_0x35a7f8(0x1e1),(_0x17b6fd,_0x55de1b)=>{const _0x2f1c64=_0x35a7f8;if(validateAccess(_0x55de1b,_0x53608d)[_0x2f1c64(0x344)])toggleBot(_0x17b6fd[_0x2f1c64(0x211)],_0x17b6fd[_0x2f1c64(0x212)],_0x17b6fd[_0x2f1c64(0x317)]);else logger[_0x2f1c64(0x395)](_0x2f1c64(0x2e3));}),_0xc11817['on'](_0x35a7f8(0x328),(_0x10957f,_0x1ba21d)=>{const _0x335676=_0x35a7f8;if(validateAccess(_0x1ba21d,_0x53608d)['allow'])toggleBotMode(_0x10957f);else logger[_0x335676(0x395)](_0x335676(0x2e3));}),_0xc11817['on'](_0x35a7f8(0x233),(_0x5a2f65,_0x3695ce)=>{const _0x573b1f=_0x35a7f8;if(validateAccess(_0x3695ce,_0x53608d)['allow'])deleteBot(_0x5a2f65);else logger['full'](_0x573b1f(0x32f));}),_0xc11817['on'](_0x35a7f8(0x34a),(_0x478098,_0x35ef7b)=>{const _0x521e76=_0x35a7f8;if(validateAccess(_0x35ef7b,_0x53608d)[_0x521e76(0x344)])storeSettings(_0x478098,!![]);else logger['full'](_0x521e76(0x378));}),_0xc11817['on'](_0x35a7f8(0x2f8),_0x22a1f6=>{const _0x4e6d91=_0x35a7f8;if(validateAccess(_0x22a1f6,_0x53608d)['allow'])updateBB(_0x4e6d91(0x227));else logger['full'](_0x4e6d91(0x247));}),_0xc11817['on']('reinstall-bb',_0x1c95db=>{const _0x53874d=_0x35a7f8;if(validateAccess(_0x1c95db,_0x53608d)[_0x53874d(0x344)])updateBB(_0x53874d(0x357));else logger[_0x53874d(0x395)](_0x53874d(0x329));}),_0xc11817['on'](_0x35a7f8(0x39c),_0xf9fac8=>{const _0x2d428c=_0x35a7f8;if(validateAccess(_0xf9fac8,_0x53608d)['allow']){const _0x207754=getClient(_0xc11817['id']);if(_0x207754)getBackupFiles(_0x207754[_0x2d428c(0x392)]);else logger[_0x2d428c(0x395)](_0x2d428c(0x23a));}else logger['full']('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0xc11817['on'](_0x35a7f8(0x253),(_0x1dd554,_0x28435d)=>{const _0x5dc3f1=_0x35a7f8;if(validateAccess(_0x28435d,_0x53608d)['allow'])restoreBackupFile(_0x1dd554);else logger[_0x5dc3f1(0x395)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0xc11817['on'](_0x35a7f8(0x38c),_0x56d690=>{const _0x5c4f24=_0x35a7f8;if(validateAccess(_0x56d690,_0x53608d)[_0x5c4f24(0x344)])getMessages();else logger[_0x5c4f24(0x395)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0xc11817['on']('confirm-message',(_0x5c9e87,_0x3fee2a)=>{const _0x24b590=_0x35a7f8;if(validateAccess(_0x3fee2a,_0x53608d)[_0x24b590(0x344)])confirmMessage(_0x5c9e87);else logger[_0x24b590(0x395)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0xc11817['on']('logout',_0x5f4725=>{const _0x345ad9=_0x35a7f8;if(validateAccess(_0x5f4725,_0x53608d)['allow']){if(devices[_0x53608d][_0x345ad9(0x320)])clearTimeout(devices[_0x53608d]['pidRefreshToken']);if(devices[_0x53608d][_0x345ad9(0x292)])clearTimeout(devices[_0x53608d]['pidExpireLogin']);removeSocketListeners(getClient(_0xc11817['id'])['uuid']),addBlacklist(_0x53608d),devices[_0x53608d][_0x345ad9(0x1f9)]=null,devices[_0x53608d][_0x345ad9(0x2fa)]=null,devices[_0x53608d][_0x345ad9(0x383)][_0x345ad9(0x3d5)]=null,logger[_0x345ad9(0x34b)](_0x345ad9(0x265)+_0x53608d[_0x345ad9(0x219)](-0x8)),io['to'](getClient(_0xc11817['id'])[_0x345ad9(0x392)])[_0x345ad9(0x274)](_0x345ad9(0x212),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x345ad9(0x395)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x2f203f){const _0x5304bc=_0x3ebe93,_0x2f5120=getClient(_0x2f203f['id'])[_0x5304bc(0x339)],_0x1b40e2=getClient(_0x2f203f['id'])[_0x5304bc(0x392)];_0x2f203f['on'](_0x5304bc(0x333),(_0x3ad380,_0x8a9562)=>{const _0x1e2493=_0x5304bc;if(validateAccess(_0x8a9562,_0x1b40e2)[_0x1e2493(0x344)]){if(pid[_0x2f5120])pid[_0x2f5120][_0x1e2493(0x2ab)]({'function':'emitHistory','args':_0x3ad380});}else logger[_0x1e2493(0x395)](_0x1e2493(0x2fb));}),_0x2f203f['on'](_0x5304bc(0x2c6),(_0x5113c3,_0x10f9c5)=>{const _0x282b9e=_0x5304bc;if(validateAccess(_0x10f9c5,_0x1b40e2)[_0x282b9e(0x344)]){if(pid[_0x2f5120])pid[_0x2f5120][_0x282b9e(0x2ab)]({'function':_0x282b9e(0x36a),'args':_0x5113c3});}else logger['full'](_0x282b9e(0x3cc));}),_0x2f203f['on'](_0x5304bc(0x3ab),(_0x2d634d,_0x70c43b)=>{const _0x22861c=_0x5304bc;if(validateAccess(_0x70c43b,_0x1b40e2)[_0x22861c(0x344)]){if(pid[_0x2f5120])pid[_0x2f5120][_0x22861c(0x2ab)]({'function':'getPortfolio','args':_0x2d634d});}else logger[_0x22861c(0x395)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x2f203f['on'](_0x5304bc(0x31c),(_0x17abf7,_0x3a2839)=>{const _0xf46706=_0x5304bc;if(validateAccess(_0x3a2839,_0x1b40e2)[_0xf46706(0x344)]){if(pid[_0x2f5120])pid[_0x2f5120][_0xf46706(0x2ab)]({'function':_0xf46706(0x2cf),'args':_0x17abf7});}else logger[_0xf46706(0x395)](_0xf46706(0x237));}),_0x2f203f['on']('store-headless',(_0x2bf9fd,_0x20587f)=>{const _0x2d9c9a=_0x5304bc;if(validateAccess(_0x20587f,_0x1b40e2)[_0x2d9c9a(0x344)]){if(pid[_0x2f5120])pid[_0x2f5120]['send']({'function':_0x2d9c9a(0x39f),'args':_0x2bf9fd});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x2f203f['on']('store-fiat',(_0x338c5a,_0x101df6)=>{const _0x20197e=_0x5304bc;if(validateAccess(_0x101df6,_0x1b40e2)[_0x20197e(0x344)]){if(pid[_0x2f5120])pid[_0x2f5120]['send']({'function':_0x20197e(0x3c6),'args':_0x338c5a});}else logger[_0x20197e(0x395)](_0x20197e(0x1fb));}),_0x2f203f['on'](_0x5304bc(0x32a),_0x548548=>{const _0x382ebd=_0x5304bc;if(validateAccess(_0x548548,_0x1b40e2)[_0x382ebd(0x344)]){if(pid[_0x2f5120])pid[_0x2f5120][_0x382ebd(0x2ab)]({'function':'resetHistory','args':null});}else logger[_0x382ebd(0x395)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x2f203f['on'](_0x5304bc(0x2c2),_0x314928=>{const _0x170093=_0x5304bc;if(validateAccess(_0x314928,_0x1b40e2)[_0x170093(0x344)]){if(pid[_0x2f5120])pid[_0x2f5120]['send']({'function':_0x170093(0x271),'args':null});}else logger[_0x170093(0x395)](_0x170093(0x203));}),_0x2f203f['on'](_0x5304bc(0x39a),(_0x167245,_0x586698)=>{const _0x1580f6=_0x5304bc;if(validateAccess(_0x586698,_0x1b40e2)[_0x1580f6(0x344)]){if(pid[_0x2f5120])pid[_0x2f5120][_0x1580f6(0x2ab)]({'function':_0x1580f6(0x23b),'args':_0x167245});}else logger[_0x1580f6(0x395)](_0x1580f6(0x1dd));}),_0x2f203f['on']('cancel-loading',_0x124f59=>{const _0x4437b1=_0x5304bc;if(validateAccess(_0x124f59,_0x1b40e2)[_0x4437b1(0x344)]){if(pid[_0x2f5120])pid[_0x2f5120]['send']({'function':_0x4437b1(0x3be),'args':null});}else logger[_0x4437b1(0x395)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x2f203f['on'](_0x5304bc(0x2e1),_0x513fc4=>{const _0x58c0e2=_0x5304bc;if(validateAccess(_0x513fc4,_0x1b40e2)[_0x58c0e2(0x344)]){if(pid[_0x2f5120])pid[_0x2f5120]['send']({'function':_0x58c0e2(0x295),'args':null});}else logger[_0x58c0e2(0x395)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x2f203f['on'](_0x5304bc(0x2f8),_0x1435f2=>{const _0x4b2300=_0x5304bc;if(validateAccess(_0x1435f2,_0x1b40e2)['allow'])updateBB(_0x4b2300(0x227));else logger[_0x4b2300(0x395)](_0x4b2300(0x247));}),_0x2f203f['on'](_0x5304bc(0x38c),_0x2f61c8=>{const _0x59dc93=_0x5304bc;if(validateAccess(_0x2f61c8,_0x1b40e2)[_0x59dc93(0x344)])getMessages();else logger[_0x59dc93(0x395)](_0x59dc93(0x261));}),_0x2f203f['on'](_0x5304bc(0x33f),(_0x1ecfd6,_0x25ffb1)=>{const _0x8ef4a2=_0x5304bc;if(validateAccess(_0x25ffb1,_0x1b40e2)['allow'])confirmMessage(_0x1ecfd6);else logger[_0x8ef4a2(0x395)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x2f203f['on']('logout',_0x42939b=>{const _0x55f584=_0x5304bc;if(validateAccess(_0x42939b,_0x1b40e2)[_0x55f584(0x344)]){if(devices[_0x1b40e2][_0x55f584(0x320)])clearTimeout(devices[_0x1b40e2][_0x55f584(0x320)]);if(devices[_0x1b40e2][_0x55f584(0x292)])clearTimeout(devices[_0x1b40e2][_0x55f584(0x292)]);removeSocketListeners(getClient(_0x2f203f['id'])[_0x55f584(0x392)]),addBlacklist(_0x1b40e2),devices[_0x1b40e2][_0x55f584(0x1f9)]=null,devices[_0x1b40e2]['telegram2FaApproval']=null,devices[_0x1b40e2][_0x55f584(0x383)][_0x55f584(0x3d5)]=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x1b40e2[_0x55f584(0x219)](-0x8)),io['to'](getClient(_0x2f203f['id'])[_0x55f584(0x392)])[_0x55f584(0x274)]('status',{'access':{'allow':![],'reason':_0x55f584(0x372),'token':null}});}else logger[_0x55f584(0x395)](_0x55f584(0x1db));});}function removeSocketListeners(_0x59447f){getClientsWithUuid(_0x59447f)['forEach'](_0xbd2478=>{getSocket(_0xbd2478['id'])['removeAllListeners']();});}function cleanSettings(){const _0x2582fe=_0x3ebe93;let _0x1b2cbc=settings;return settings['telegramToken']&&settings[_0x2582fe(0x3bb)]!=''&&(_0x1b2cbc={..._0x1b2cbc,'telegramToken':_0x2582fe(0x257)}),settings[_0x2582fe(0x23e)]&&settings['bbPassword']!=''&&(_0x1b2cbc={..._0x1b2cbc,'bbPassword':_0x2582fe(0x257)}),settings[_0x2582fe(0x1dc)]&&settings['marketcapApi']!=''&&(_0x1b2cbc={..._0x1b2cbc,'marketcapApi':'************'}),(settings['bbPassword']&&settings[_0x2582fe(0x23e)]==_0x2582fe(0x30a)||settings[_0x2582fe(0x3bb)]&&settings['telegramToken']==_0x2582fe(0x30a)||settings[_0x2582fe(0x1dc)]&&settings['marketcapApi']==_0x2582fe(0x30a))&&(_0x1b2cbc={..._0x1b2cbc,'restored':{'password':settings[_0x2582fe(0x23e)]==_0x2582fe(0x30a),'telegram':settings[_0x2582fe(0x3bb)]==_0x2582fe(0x30a),'marketcap':settings[_0x2582fe(0x1dc)]=='***'}}),_0x1b2cbc;}async function updateBB(_0x59a3b9){const _0x5408a2=_0x3ebe93;await backupConfigFiles(),installingUpdate=!![],config[_0x5408a2(0x1d9)](_0x3c576d=>{restartBot(_0x3c576d['botID']);});if(_0x59a3b9==_0x5408a2(0x227))process[_0x5408a2(0x2ab)]({'update':!![],'environment':environment},_0x3868b9=>{});else _0x59a3b9=='reinstall'&&process['send']({'reinstall':!![],'environment':environment},_0x5d31d3=>{});}function startBot(_0x2c242f,_0x15d494,_0x38ce3d){const _0x5bf3f4=_0x3ebe93;if(debugging)_0x2c242f[_0x5bf3f4(0x24f)]('-d');let _0x510713=![];const _0x461185=_0x2c242f[0x0];_0x15d494={..._0x15d494,'stdio':['inherit',_0x5bf3f4(0x239),_0x5bf3f4(0x239),_0x5bf3f4(0x267)]},pid[_0x461185]=childProcess['fork'](botfile,_0x2c242f,_0x15d494),pid[_0x461185]['on'](_0x5bf3f4(0x393),_0xff4d23=>{const _0x4fb445=_0x5bf3f4;switch(Object['keys'](_0xff4d23)[0x0]){case'botname':updateBotName(_0x461185,_0xff4d23[_0x4fb445(0x365)]);break;case'updatebotmanager':updateBotManager();break;case _0x4fb445(0x212):updateStatus(_0x461185,_0xff4d23[_0x4fb445(0x212)]);break;case _0x4fb445(0x317):updateLive(_0x461185,_0xff4d23[_0x4fb445(0x317)]);break;case'started':updateLive(_0x461185,_0xff4d23['started']),io['to'](_0x461185)[_0x4fb445(0x274)](_0x4fb445(0x212),{'access':{'allow':![],'reason':_0x4fb445(0x340),'token':null}});break;case _0x4fb445(0x236):_0xff4d23[_0x4fb445(0x236)]==_0x4fb445(0x33b)&&restartBot(_0x461185);_0xff4d23[_0x4fb445(0x236)]=='kill'&&toggleBot(_0x461185,_0x4fb445(0x3a3),_0x4fb445(0x1f1));break;case _0x4fb445(0x26c):sendTelegramBot(_0x461185,_0xff4d23[_0x4fb445(0x26c)]);break;case _0x4fb445(0x2b7):sendTelegramMsg(_0xff4d23[_0x4fb445(0x2b7)]);break;case _0x4fb445(0x207):io['to'](_0x461185)['emit'](_0xff4d23['function'],_0xff4d23['args']);break;}}),pid[_0x461185]['on'](_0x5bf3f4(0x3a9),function(_0x41f423){if(_0x510713)return;_0x510713=!![],_0x38ce3d(_0x41f423);}),pid[_0x461185]['on'](_0x5bf3f4(0x266),async function(_0x19fb8a){const _0x5719d1=_0x5bf3f4;if(terminating)return;if(installingUpdate){logger[_0x5719d1(0x34b)](_0x5719d1(0x291)),io['close']();return;}if(_0x510713)return;_0x510713=!![],_0x38ce3d(null);const _0x40da88=dbConfig[_0x5719d1(0x278)]('bots')[_0x5719d1(0x23d)]({'botID':_0x461185})[_0x5719d1(0x373)]();_0x40da88&&(_0x40da88[_0x5719d1(0x212)]==_0x5719d1(0x2df)||_0x40da88[_0x5719d1(0x212)]==_0x5719d1(0x2c9))&&(await sleep(0x3e8),updateLive(_0x461185,_0x5719d1(0x1f1)),logger['full']('Restarting\x20Bot\x20'+_0x461185),startBot([_0x461185,userID],{'cwd':bbpath},function(_0x279cf1){const _0x2d79e2=_0x5719d1;if(_0x279cf1)logger[_0x2d79e2(0x395)](_0x279cf1);}));});}function stopBot(_0x5ab286){const _0x506efc=_0x3ebe93;getClientsWithBotID(_0x5ab286)['forEach'](_0x5e654e=>{const _0x2bc510=_0x8b5d;getSocket(_0x5e654e['id'])[_0x2bc510(0x3a8)](!![]),removeClient(_0x5e654e['id']);}),pid[_0x5ab286]&&(pid[_0x5ab286][_0x506efc(0x330)](),pid[_0x5ab286]=null);}function stopAllBots(){const _0x1b9ca6=_0x3ebe93;terminating=!![];const _0x564179=getEnabledBots();_0x564179[_0x1b9ca6(0x1d9)](_0x34b411=>{stopBot(_0x34b411['botID']);});}function restartBot(_0x46ea2b){if(pid[_0x46ea2b])pid[_0x46ea2b]['kill']();}function addBot(){const _0x4014c7=_0x3ebe93;let _0x1b3378;for(let _0x404ccb=0x1;_0x404ccb<0x3e9;_0x404ccb++){_0x1b3378=_0x404ccb[_0x4014c7(0x2ee)]()['padStart'](0x3,'0');let _0x327456=config['find'](_0x31cd03=>_0x31cd03[_0x4014c7(0x211)]==_0x1b3378);if(!_0x327456)break;}if(_0x1b3378===_0x4014c7(0x1ea)){logger['full'](_0x4014c7(0x364));return;}logger['full'](_0x4014c7(0x37a)+_0x1b3378),dbConfig[_0x4014c7(0x278)]('bots')[_0x4014c7(0x24f)]({'botID':_0x1b3378,'botname':'Bot\x20'+_0x1b3378,'status':_0x4014c7(0x2c9),'live':''})[_0x4014c7(0x38a)](),startBot([_0x1b3378,userID],{'cwd':bbpath},function(_0x5ccfdd){if(_0x5ccfdd)logger['full'](_0x5ccfdd);}),config=getConfiguration(),io['to'](_0x4014c7(0x3b7))[_0x4014c7(0x274)](_0x4014c7(0x385),config),broadcastToBots(_0x4014c7(0x385),JSON[_0x4014c7(0x242)](config));}function deleteBot(_0x2d1114){const _0x1b3691=_0x3ebe93;getClientsWithBotID(_0x2d1114)[_0x1b3691(0x1d9)](_0x153e24=>{const _0xe20b17=_0x1b3691;getSocket(_0x153e24['id'])[_0xe20b17(0x3a8)](!![]),removeClient(_0x153e24['id']);}),dbConfig['get'](_0x1b3691(0x385))['remove']({'botID':_0x2d1114})['write'](),logger[_0x1b3691(0x395)](_0x1b3691(0x28b)+_0x2d1114),stopBot(_0x2d1114);try{if(fs[_0x1b3691(0x245)](path['join'](configpath,_0x1b3691(0x2a4)+_0x2d1114+_0x1b3691(0x322))))fs[_0x1b3691(0x2a5)](path[_0x1b3691(0x33e)](configpath,_0x1b3691(0x2a4)+_0x2d1114+'-config.json'));if(fs[_0x1b3691(0x245)](path['join'](configpath,_0x1b3691(0x2a4)+_0x2d1114+_0x1b3691(0x398))))fs[_0x1b3691(0x2a5)](path[_0x1b3691(0x33e)](configpath,_0x1b3691(0x2a4)+_0x2d1114+_0x1b3691(0x398)));if(fs['existsSync'](path[_0x1b3691(0x33e)](configpath,_0x1b3691(0x2a4)+_0x2d1114+_0x1b3691(0x2d6))))fs['unlinkSync'](path['join'](configpath,_0x1b3691(0x2a4)+_0x2d1114+'-performance.json'));if(fs[_0x1b3691(0x245)](path['join'](configpath,_0x1b3691(0x2a4)+_0x2d1114+_0x1b3691(0x215))))fs[_0x1b3691(0x2a5)](path['join'](configpath,_0x1b3691(0x2a4)+_0x2d1114+_0x1b3691(0x215)));}catch(_0x55509d){if(_0x55509d)logger[_0x1b3691(0x395)](_0x1b3691(0x389),_0x55509d);}config=getConfiguration(),io['to'](_0x1b3691(0x3b7))['emit'](_0x1b3691(0x385),config),broadcastToBots(_0x1b3691(0x385),JSON['stringify'](config));}function toggleBot(_0x5c8231,_0x352a6f,_0x4ab61c){const _0x33f6e1=_0x3ebe93;dbConfig['get'](_0x33f6e1(0x385))[_0x33f6e1(0x23d)]({'botID':_0x5c8231})[_0x33f6e1(0x289)]({'status':_0x352a6f})[_0x33f6e1(0x289)]({'live':_0x4ab61c})[_0x33f6e1(0x38a)]();if(_0x352a6f==_0x33f6e1(0x2df)||_0x352a6f==_0x33f6e1(0x2c9))logger[_0x33f6e1(0x395)](_0x33f6e1(0x369)+_0x5c8231),startBot([_0x5c8231,userID],{'cwd':bbpath},function(_0x159a41){const _0x33322b=_0x33f6e1;if(_0x159a41)logger[_0x33322b(0x395)](_0x159a41);});else(_0x352a6f==_0x33f6e1(0x3a3)||_0x352a6f==_0x33f6e1(0x210))&&(logger['full'](_0x33f6e1(0x3d2)+_0x5c8231),stopBot(_0x5c8231));config=getConfiguration(),io['to'](_0x33f6e1(0x3b7))[_0x33f6e1(0x274)](_0x33f6e1(0x385),config),broadcastToBots(_0x33f6e1(0x385),JSON[_0x33f6e1(0x242)](config));}function toggleStatus(_0x39008e){const _0x5b4cfb=_0x3ebe93;let _0x38eee2=dbConfig[_0x5b4cfb(0x278)]('bots')[_0x5b4cfb(0x23d)]({'botID':_0x39008e})[_0x5b4cfb(0x373)](),_0xa27fcd;if(_0x38eee2[_0x5b4cfb(0x212)]===_0x5b4cfb(0x2df))_0xa27fcd='disabled';else{if(_0x38eee2[_0x5b4cfb(0x212)]===_0x5b4cfb(0x2c9))_0xa27fcd=_0x5b4cfb(0x210);else{if(_0x38eee2[_0x5b4cfb(0x212)]===_0x5b4cfb(0x210))_0xa27fcd='new';else{if(_0x38eee2[_0x5b4cfb(0x212)]===_0x5b4cfb(0x3a3))_0xa27fcd=_0x5b4cfb(0x2df);}}}return _0xa27fcd;}function updateStatus(_0x50bd0f,_0x27f935){const _0x266b1d=_0x3ebe93;dbConfig[_0x266b1d(0x278)](_0x266b1d(0x385))['find']({'botID':_0x50bd0f})['assign']({'status':_0x27f935})['write'](),config=getConfiguration(),io['to'](_0x266b1d(0x3b7))[_0x266b1d(0x274)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function updateLive(_0x3a97a0,_0x172267){const _0x585da9=_0x3ebe93;dbConfig[_0x585da9(0x278)](_0x585da9(0x385))[_0x585da9(0x23d)]({'botID':_0x3a97a0})[_0x585da9(0x289)]({'live':_0x172267})[_0x585da9(0x38a)](),config=getConfiguration(),io['to'](_0x585da9(0x3b7))[_0x585da9(0x274)](_0x585da9(0x385),config),broadcastToBots(_0x585da9(0x385),JSON['stringify'](config));}function updateBotName(_0x39ee0f,_0x4fdd39){const _0x33679f=_0x3ebe93;dbConfig[_0x33679f(0x278)](_0x33679f(0x385))[_0x33679f(0x23d)]({'botID':_0x39ee0f})[_0x33679f(0x289)]({'botname':_0x4fdd39})[_0x33679f(0x38a)](),config=getConfiguration(),io['to'](_0x33679f(0x3b7))[_0x33679f(0x274)]('bots',config),broadcastToBots(_0x33679f(0x385),JSON[_0x33679f(0x242)](config));}function updateBotManager(){const _0x1647e8=_0x3ebe93;config=getConfiguration(),io['to'](_0x1647e8(0x3b7))[_0x1647e8(0x274)](_0x1647e8(0x385),config),broadcastToBots('bots',JSON[_0x1647e8(0x242)](config));}function toggleBotMode(_0x553061){const _0x38811b=_0x3ebe93;if(pid[_0x553061])pid[_0x553061]['send']({'function':'toggleBotMode','args':null});else{const _0x44f845=configpath+_0x38811b(0x2a4)+_0x553061+_0x38811b(0x322),_0x5b3847=fs[_0x38811b(0x27d)](_0x44f845),_0x1d13c6=JSON[_0x38811b(0x331)](_0x5b3847),_0x9db34d=_0x1d13c6[_0x38811b(0x339)][0x0]['headless'];_0x1d13c6[_0x38811b(0x339)][0x0][_0x38811b(0x1da)]=!_0x9db34d;const _0x4c10e1=JSON[_0x38811b(0x242)](_0x1d13c6,null,0x2);fs[_0x38811b(0x2d2)](_0x44f845,_0x4c10e1),config=getConfiguration(),io['to']('botmanager')['emit'](_0x38811b(0x385),config),broadcastToBots(_0x38811b(0x385),JSON[_0x38811b(0x242)](config));}}function validateTelegram(_0xf2a093){const _0x4e3384=_0x3ebe93;if(_0xf2a093[_0x4e3384(0x206)][_0x4e3384(0x26d)]!=settings[_0x4e3384(0x2cc)]&&'@'+_0xf2a093[_0x4e3384(0x206)][_0x4e3384(0x26d)]!=settings[_0x4e3384(0x2cc)]||_0xf2a093[_0x4e3384(0x281)]['id']!=settings[_0x4e3384(0x347)])return sendTelegram(_0xf2a093[_0x4e3384(0x281)]['id'],_0x4e3384(0x2bf),{'parse_mode':_0x4e3384(0x35f)}),![];return!![];}async function initTelegram(){const _0x796906=_0x3ebe93;if(tgBot)tgBot[_0x796906(0x236)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0x5ed8d9=_0x796906(0x2a9);_0x5ed8d9+='\x0a',_0x5ed8d9+=_0x796906(0x2d8),_0x5ed8d9+='/disable\x20-\x20disable\x20notifications\x0a',_0x5ed8d9+=_0x796906(0x3cd),_0x5ed8d9+=_0x796906(0x298),_0x5ed8d9+=_0x796906(0x29e),_0x5ed8d9+=_0x796906(0x2eb),_0x5ed8d9+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x5ed8d9+='/names\x20-\x20show\x20bot\x20names\x0a',_0x5ed8d9+=_0x796906(0x254),_0x5ed8d9+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x5ed8d9+=_0x796906(0x240),_0x5ed8d9+=_0x796906(0x3c1),_0x5ed8d9+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x5ed8d9+=_0x796906(0x382);let _0x127bf4=_0x796906(0x230);_0x127bf4+='\x0a',_0x127bf4+=_0x5ed8d9,tgBot[_0x796906(0x3c9)]((_0x2e71ec,_0x48784f)=>{const _0x2d5d0f=_0x796906;logger[_0x2d5d0f(0x345)](getTimeStamp()+_0x2d5d0f(0x350)),logger['debug']('Telegraf\x20error:',_0x2e71ec);}),tgBot[_0x796906(0x1f5)](async(_0x28ba26,_0x14ac68)=>{const _0x2dc098=_0x796906;if(!(!settings[_0x2dc098(0x347)]&&_0x28ba26[_0x2dc098(0x227)]['message'][_0x2dc098(0x39e)]=='/start')){if(!validateTelegram(_0x28ba26))return;}_0x14ac68();}),tgBot[_0x796906(0x2a6)](_0x796906(0x335),async _0x728d71=>{const _0x36a577=_0x796906;if(!settings[_0x36a577(0x347)])updateSetting(_0x36a577(0x347),_0x728d71[_0x36a577(0x281)]['id']);updateSetting('telegramEnabled',!![]);if(!validateTelegram(_0x728d71))return;await sendTelegram(_0x728d71[_0x36a577(0x281)]['id'],_0x127bf4);}),tgBot[_0x796906(0x2a6)](_0x796906(0x2ac),async _0x194987=>{const _0x44dcd9=_0x796906;updateSetting(_0x44dcd9(0x2f9),!![]),await sendTelegram(_0x194987[_0x44dcd9(0x281)]['id'],_0x44dcd9(0x29f));}),tgBot['command'](_0x796906(0x2a8),async _0x4bd59b=>{const _0x1aa456=_0x796906;await sendTelegram(_0x4bd59b[_0x1aa456(0x281)]['id'],_0x1aa456(0x37f)),updateSetting(_0x1aa456(0x2f9),![]);}),tgBot[_0x796906(0x2a6)](_0x796906(0x366),async _0x18eb3e=>{const _0x59ad62=_0x796906,_0x5879a4=Markup[_0x59ad62(0x34c)]([Markup['button'][_0x59ad62(0x2d9)](_0x59ad62(0x312),'config_orders'),Markup[_0x59ad62(0x23f)]['callback'](_0x59ad62(0x3ae),'config_alerts'),Markup[_0x59ad62(0x23f)]['callback']('All',_0x59ad62(0x235))]);_0x18eb3e[_0x59ad62(0x3a7)](_0x59ad62(0x359),_0x5879a4);}),tgBot['action'](_0x796906(0x1df),async _0x5d7a0c=>{const _0x40919f=_0x796906;_0x5d7a0c[_0x40919f(0x2b1)](),updateSetting('telegramEvents',_0x40919f(0x21f)),updateSetting(_0x40919f(0x2f9),!![]),await sendTelegram(_0x5d7a0c[_0x40919f(0x281)]['id'],_0x40919f(0x2da));}),tgBot['action']('config_alerts',async _0x4a825b=>{const _0x4388ab=_0x796906;_0x4a825b['editMessageReplyMarkup'](),updateSetting(_0x4388ab(0x2cb),_0x4388ab(0x2d5)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x4a825b[_0x4388ab(0x281)]['id'],_0x4388ab(0x241));}),tgBot[_0x796906(0x1fe)](_0x796906(0x235),async _0x122934=>{const _0x52ef15=_0x796906;_0x122934[_0x52ef15(0x2b1)](),updateSetting(_0x52ef15(0x2cb),'all'),updateSetting(_0x52ef15(0x2f9),!![]),await sendTelegram(_0x122934[_0x52ef15(0x281)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x796906(0x2a6)](_0x796906(0x212),async _0x91d9=>{const _0xc44a81=_0x796906,_0x51ccf1=getBotsWithMode();let _0x23b5e1='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0xc44a81(0x1d9)](_0x39f052=>{const _0x59d192=_0xc44a81,_0x3dcd2c=_0x51ccf1[_0x59d192(0x23d)](_0x1ef7d6=>_0x1ef7d6[_0x59d192(0x211)]==_0x39f052[_0x59d192(0x211)])['mode'];_0x23b5e1+=_0x59d192(0x3bd)+_0x39f052[_0x59d192(0x211)]+':\x20'+_0x39f052[_0x59d192(0x212)]+_0x59d192(0x3d4)+_0x3dcd2c+_0x59d192(0x3d4)+_0x39f052['live']+'\x0a';}),_0x23b5e1+='\x0a',_0x23b5e1+=_0xc44a81(0x35e),_0x23b5e1+=!settings['telegramEnabled']?_0xc44a81(0x33d):_0xc44a81(0x1e6),_0x23b5e1+=settings['telegramEnabled']?settings[_0xc44a81(0x2cb)]==_0xc44a81(0x1f8)?_0xc44a81(0x38f):'Notifications\x20types:\x20'+settings[_0xc44a81(0x2cb)]+'\x20only\x0a':'',await sendTelegram(_0x91d9[_0xc44a81(0x281)]['id'],_0x23b5e1,{'parse_mode':_0xc44a81(0x35f)});}),tgBot['command']('restart',async _0x1c22ce=>{const _0x3e93a8=_0x796906,_0x5f4cf6=getEnabledBots();if(_0x5f4cf6[_0x3e93a8(0x388)]==0x0)await sendTelegram(_0x1c22ce[_0x3e93a8(0x281)]['id'],_0x3e93a8(0x297));else{if(_0x5f4cf6[_0x3e93a8(0x388)]>0x1)_0x5f4cf6[_0x3e93a8(0x24f)]({'botID':_0x3e93a8(0x1f8)});let _0x25f9a9=[],_0x468f12=[];const _0x2d0f1c=_0x5f4cf6[_0x3e93a8(0x388)]%0x4==0x0||_0x5f4cf6['length']%0x4==0x3||_0x5f4cf6[_0x3e93a8(0x388)]%0x3==0x1?0x4:0x3;let _0x2b92ab=0x0;_0x5f4cf6[_0x3e93a8(0x1d9)]((_0x1cfaa5,_0x583da4)=>{const _0x2a030f=_0x3e93a8;if(_0x583da4%_0x2d0f1c==0x0)_0x468f12=[];_0x468f12[_0x2a030f(0x24f)](Markup[_0x2a030f(0x23f)]['callback'](_0x1cfaa5['botID']==_0x2a030f(0x1f8)?'All\x20bots':'Bot\x20'+_0x1cfaa5[_0x2a030f(0x211)],'restart_'+_0x1cfaa5[_0x2a030f(0x211)])),_0x583da4%_0x2d0f1c==0x0&&(_0x25f9a9[_0x2b92ab]=_0x468f12,_0x2b92ab++);});const _0x4cfe7d=Markup[_0x3e93a8(0x34c)](_0x25f9a9);_0x1c22ce[_0x3e93a8(0x3a7)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x4cfe7d);}}),tgBot[_0x796906(0x1fe)](/restart_(.+)/,async _0x156298=>{const _0x2c172c=_0x796906,_0x148980=_0x156298[_0x2c172c(0x3a1)][0x1];_0x156298[_0x2c172c(0x2b1)](),_0x148980=='all'?config[_0x2c172c(0x1d9)](_0x12832b=>{restartBot(_0x12832b['botID']);}):restartBot(_0x148980);}),tgBot['command']('on',async _0x19d268=>{const _0xdb9c99=_0x796906,_0x9398c2=getDisabledBots();if(_0x9398c2[_0xdb9c99(0x388)]==0x0)await sendTelegram(_0x19d268[_0xdb9c99(0x281)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x9398c2[_0xdb9c99(0x388)]>0x1)_0x9398c2[_0xdb9c99(0x24f)]({'botID':'all'});let _0x19dd40=[],_0x9525ee=[];const _0x39b9fd=_0x9398c2[_0xdb9c99(0x388)]%0x4==0x0||_0x9398c2[_0xdb9c99(0x388)]%0x4==0x3||_0x9398c2[_0xdb9c99(0x388)]%0x3==0x1?0x4:0x3;let _0x3f800d=0x0;_0x9398c2[_0xdb9c99(0x1d9)]((_0x5a6a4d,_0x4e1761)=>{const _0x182ad1=_0xdb9c99;if(_0x4e1761%_0x39b9fd==0x0)_0x9525ee=[];_0x9525ee[_0x182ad1(0x24f)](Markup[_0x182ad1(0x23f)]['callback'](_0x5a6a4d[_0x182ad1(0x211)]==_0x182ad1(0x1f8)?_0x182ad1(0x209):_0x182ad1(0x3bd)+_0x5a6a4d[_0x182ad1(0x211)],_0x182ad1(0x2b0)+_0x5a6a4d[_0x182ad1(0x211)])),_0x4e1761%_0x39b9fd==0x0&&(_0x19dd40[_0x3f800d]=_0x9525ee,_0x3f800d++);});const _0x3476c9=Markup['inlineKeyboard'](_0x19dd40);_0x19d268[_0xdb9c99(0x3a7)](_0xdb9c99(0x316),_0x3476c9);}}),tgBot[_0x796906(0x1fe)](/on_(.+)/,async _0x487e07=>{const _0x37798e=_0x796906,_0x1645bb=_0x487e07[_0x37798e(0x3a1)][0x1];_0x487e07[_0x37798e(0x2b1)]();if(_0x1645bb==_0x37798e(0x1f8)){const _0x422671=getDisabledBots();await sendTelegram(_0x487e07['chat']['id'],_0x37798e(0x39d)),_0x422671[_0x37798e(0x1d9)](_0x32ea33=>{const _0x14bc7c=_0x37798e;if(_0x32ea33['botID']!=_0x14bc7c(0x1f8))toggleBot(_0x32ea33[_0x14bc7c(0x211)],toggleStatus(_0x32ea33['botID']),_0x14bc7c(0x1f1));});}else await sendTelegram(_0x487e07[_0x37798e(0x281)]['id'],_0x37798e(0x3b5)+_0x1645bb),toggleBot(_0x1645bb,toggleStatus(_0x1645bb),'stopped');}),tgBot[_0x796906(0x2a6)](_0x796906(0x30c),async _0x5d0238=>{const _0x2d0d80=_0x796906,_0x3ca145=getEnabledBots();if(_0x3ca145[_0x2d0d80(0x388)]==0x0)await sendTelegram(_0x5d0238['chat']['id'],_0x2d0d80(0x297));else{if(_0x3ca145[_0x2d0d80(0x388)]>0x1)_0x3ca145[_0x2d0d80(0x24f)]({'botID':_0x2d0d80(0x1f8)});let _0x3bb495=[],_0x561c4c=[];const _0x3feb4a=_0x3ca145[_0x2d0d80(0x388)]%0x4==0x0||_0x3ca145[_0x2d0d80(0x388)]%0x4==0x3||_0x3ca145[_0x2d0d80(0x388)]%0x3==0x1?0x4:0x3;let _0x2fea81=0x0;_0x3ca145[_0x2d0d80(0x1d9)]((_0x1ef2f6,_0x949c3d)=>{const _0x17583d=_0x2d0d80;if(_0x949c3d%_0x3feb4a==0x0)_0x561c4c=[];_0x561c4c['push'](Markup[_0x17583d(0x23f)]['callback'](_0x1ef2f6['botID']==_0x17583d(0x1f8)?_0x17583d(0x209):_0x17583d(0x3bd)+_0x1ef2f6[_0x17583d(0x211)],_0x17583d(0x35a)+_0x1ef2f6[_0x17583d(0x211)])),_0x949c3d%_0x3feb4a==0x0&&(_0x3bb495[_0x2fea81]=_0x561c4c,_0x2fea81++);});const _0x4f9a42=Markup[_0x2d0d80(0x34c)](_0x3bb495);_0x5d0238[_0x2d0d80(0x3a7)](_0x2d0d80(0x2ba),_0x4f9a42);}}),tgBot[_0x796906(0x1fe)](/off_(.+)/,async _0x4792ed=>{const _0x3146b0=_0x796906,_0x9a6152=_0x4792ed[_0x3146b0(0x3a1)][0x1];_0x4792ed[_0x3146b0(0x2b1)]();if(_0x9a6152==_0x3146b0(0x1f8)){const _0x4a91f1=getEnabledBots();await sendTelegram(_0x4792ed['chat']['id'],_0x3146b0(0x1ef)),_0x4a91f1['forEach'](_0x4368ee=>{const _0x3d665f=_0x3146b0;if(_0x4368ee[_0x3d665f(0x211)]!=_0x3d665f(0x1f8))toggleBot(_0x4368ee['botID'],toggleStatus(_0x4368ee[_0x3d665f(0x211)]),'stopped');});}else await sendTelegram(_0x4792ed[_0x3146b0(0x281)]['id'],_0x3146b0(0x24a)+_0x9a6152),toggleBot(_0x9a6152,toggleStatus(_0x9a6152),'stopped');}),tgBot[_0x796906(0x2a6)]('metrics',async _0xaf541d=>{const _0xaa828=_0x796906,_0x5085f0=getEnabledBots();if(_0x5085f0[_0xaa828(0x388)]==0x0)await sendTelegram(_0xaf541d[_0xaa828(0x281)]['id'],_0xaa828(0x297));else{if(_0x5085f0[_0xaa828(0x388)]>0x1){let _0x1e11bc=[],_0x48096c=[];const _0x3bcfad=_0x5085f0[_0xaa828(0x388)]%0x4==0x0||_0x5085f0[_0xaa828(0x388)]%0x4==0x3||_0x5085f0[_0xaa828(0x388)]%0x3==0x1?0x4:0x3;let _0x2cdecd=0x0;_0x5085f0[_0xaa828(0x1d9)]((_0x59fb1c,_0xe8101b)=>{const _0x232a15=_0xaa828;if(_0xe8101b%_0x3bcfad==0x0)_0x48096c=[];_0x48096c[_0x232a15(0x24f)](Markup[_0x232a15(0x23f)]['callback'](_0x232a15(0x3bd)+_0x59fb1c[_0x232a15(0x211)],_0x232a15(0x310)+_0x59fb1c[_0x232a15(0x211)])),_0xe8101b%_0x3bcfad==0x0&&(_0x1e11bc[_0x2cdecd]=_0x48096c,_0x2cdecd++);});const _0x580743=Markup[_0xaa828(0x34c)](_0x1e11bc);_0xaf541d[_0xaa828(0x3a7)](_0xaa828(0x3af),_0x580743);}else{const _0x3cb75f=_0x5085f0[0x0][_0xaa828(0x211)];if(pid[_0x3cb75f])pid[_0x3cb75f][_0xaa828(0x2ab)]({'function':_0xaa828(0x313),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x2838a2=>{const _0x672c11=_0x796906,_0x2337f0=_0x2838a2[_0x672c11(0x3a1)][0x1];_0x2838a2[_0x672c11(0x2b1)]();if(pid[_0x2337f0])pid[_0x2337f0]['send']({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x796906(0x2a6)](_0x796906(0x232),async _0x100447=>{const _0x3c41a7=_0x796906,_0x518dac=getEnabledBots();if(_0x518dac['length']==0x0)await sendTelegram(_0x100447[_0x3c41a7(0x281)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x518dac['length']>0x1){let _0x5c1520=[],_0xb5196a=[];const _0x362afa=_0x518dac[_0x3c41a7(0x388)]%0x4==0x0||_0x518dac[_0x3c41a7(0x388)]%0x4==0x3||_0x518dac[_0x3c41a7(0x388)]%0x3==0x1?0x4:0x3;let _0x4bff74=0x0;_0x518dac[_0x3c41a7(0x1d9)]((_0x5bf742,_0xdcf49a)=>{const _0x5ee8bb=_0x3c41a7;if(_0xdcf49a%_0x362afa==0x0)_0xb5196a=[];_0xb5196a[_0x5ee8bb(0x24f)](Markup[_0x5ee8bb(0x23f)][_0x5ee8bb(0x2d9)]('Bot\x20'+_0x5bf742[_0x5ee8bb(0x211)],_0x5ee8bb(0x3cf)+_0x5bf742[_0x5ee8bb(0x211)])),_0xdcf49a%_0x362afa==0x0&&(_0x5c1520[_0x4bff74]=_0xb5196a,_0x4bff74++);});const _0x2692ef=Markup['inlineKeyboard'](_0x5c1520);_0x100447[_0x3c41a7(0x3a7)](_0x3c41a7(0x2e8),_0x2692ef);}else{const _0x501b74=_0x518dac[0x0]['botID'];if(pid[_0x501b74])pid[_0x501b74][_0x3c41a7(0x2ab)]({'function':_0x3c41a7(0x308),'args':null});}}}),tgBot[_0x796906(0x1fe)](/portfolio_(.+)/,async _0x53cdcd=>{const _0x282a32=_0x796906,_0x120558=_0x53cdcd[_0x282a32(0x3a1)][0x1];_0x53cdcd['editMessageReplyMarkup']();if(pid[_0x120558])pid[_0x120558][_0x282a32(0x2ab)]({'function':_0x282a32(0x308),'args':null});}),tgBot[_0x796906(0x2a6)](_0x796906(0x227),async _0x11efac=>{const _0x45707f=_0x796906;await getMessages();if(!updateAvailable)await sendTelegram(_0x11efac[_0x45707f(0x281)]['id'],_0x45707f(0x35b));else{if(!validInstallation)await sendTelegram(_0x11efac[_0x45707f(0x281)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x1fabeb=Markup[_0x45707f(0x34c)]([Markup['button']['callback'](_0x45707f(0x2c8),_0x45707f(0x1e8)),Markup[_0x45707f(0x23f)]['callback']('No',_0x45707f(0x311))]);_0x11efac['reply'](_0x45707f(0x2ef),_0x1fabeb);}}}),tgBot[_0x796906(0x1fe)](/update_(.+)/,async _0x265f91=>{const _0x5901f7=_0x796906,_0xedb07e=_0x265f91[_0x5901f7(0x3a1)][0x1];_0x265f91[_0x5901f7(0x2b1)](),_0xedb07e=='yes'&&(await sendTelegram(_0x265f91['chat']['id'],_0x5901f7(0x1eb)),updateBB('update')),_0xedb07e=='no'&&await sendTelegram(_0x265f91['chat']['id'],_0x5901f7(0x2f1));}),tgBot[_0x796906(0x2a6)](_0x796906(0x357),async _0x3a5912=>{const _0x154129=_0x796906;if(!validInstallation)await sendTelegram(_0x3a5912[_0x154129(0x281)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x52eb98=Markup['inlineKeyboard']([Markup[_0x154129(0x23f)][_0x154129(0x2d9)](_0x154129(0x2c8),_0x154129(0x27c)),Markup[_0x154129(0x23f)]['callback']('No',_0x154129(0x29d))]);_0x3a5912[_0x154129(0x3a7)](_0x154129(0x264),_0x52eb98);}}),tgBot[_0x796906(0x1fe)](/reinstall_(.+)/,async _0x174e81=>{const _0x321e9e=_0x796906,_0x3a3b76=_0x174e81[_0x321e9e(0x3a1)][0x1];_0x174e81['editMessageReplyMarkup'](),_0x3a3b76==_0x321e9e(0x341)&&(await sendTelegram(_0x174e81[_0x321e9e(0x281)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x321e9e(0x357))),_0x3a3b76=='no'&&await sendTelegram(_0x174e81[_0x321e9e(0x281)]['id'],_0x321e9e(0x1de));}),tgBot['command'](_0x796906(0x27a),async _0x29524b=>{const _0x19f62b=_0x796906,_0x3b1f8f=getBotsWithMode();if(_0x3b1f8f[_0x19f62b(0x388)]==0x0)await sendTelegram(_0x29524b[_0x19f62b(0x281)]['id'],_0x19f62b(0x297));else{let _0x40e295=[],_0x3901e1=[];const _0x39dbf7=0x2;let _0xfc4e8f=0x0;_0x3b1f8f['forEach']((_0x1c8b4e,_0x15682d)=>{const _0x1ce9cd=_0x19f62b;if(_0x15682d%_0x39dbf7==0x0)_0x3901e1=[];_0x3901e1['push'](Markup[_0x1ce9cd(0x23f)][_0x1ce9cd(0x2d9)](_0x1ce9cd(0x3bd)+_0x1c8b4e[_0x1ce9cd(0x211)]+'\x20('+_0x1c8b4e[_0x1ce9cd(0x2fc)]+')','toggle_'+_0x1c8b4e[_0x1ce9cd(0x211)])),_0x15682d%_0x39dbf7==0x0&&(_0x40e295[_0xfc4e8f]=_0x3901e1,_0xfc4e8f++);});const _0x227354=Markup[_0x19f62b(0x34c)](_0x40e295);_0x29524b[_0x19f62b(0x3a7)](_0x19f62b(0x386),_0x227354);}}),tgBot[_0x796906(0x1fe)](/toggle_(.+)/,async _0x440b39=>{const _0x5208ca=_0x796906,_0x388989=_0x440b39[_0x5208ca(0x3a1)][0x1];_0x440b39[_0x5208ca(0x2b1)]();const _0x499156=getBotsWithMode(),_0x47530d=_0x499156['find'](_0x5bc2c6=>_0x5bc2c6[_0x5208ca(0x211)]==_0x388989),_0x1d0244=_0x47530d[_0x5208ca(0x2fc)]==_0x5208ca(0x3c4)?_0x5208ca(0x3ce):_0x5208ca(0x3c4);await sendTelegram(_0x440b39[_0x5208ca(0x281)]['id'],_0x5208ca(0x299)+_0x388989+_0x5208ca(0x2c7)+_0x1d0244+_0x5208ca(0x2ff)),toggleBotMode(_0x388989);}),tgBot[_0x796906(0x2a6)](_0x796906(0x33a),async _0x373801=>{const _0x35361c=_0x796906;let _0x16466e='';config[_0x35361c(0x1d9)](_0x47488b=>{const _0x5924ed=_0x35361c;_0x16466e+='Bot\x20'+_0x47488b[_0x5924ed(0x211)]+':\x20'+_0x47488b[_0x5924ed(0x365)]+'\x0a';}),await sendTelegram(_0x373801['chat']['id'],_0x16466e,{'parse_mode':'HTML'});}),tgBot['command'](_0x796906(0x21a),async _0x292613=>{const _0x763657=_0x796906;await sendTelegram(_0x292613[_0x763657(0x281)]['id'],_0x5ed8d9);}),process[_0x796906(0x375)]('SIGINT',()=>tgBot[_0x796906(0x236)]('SIGINT')),process[_0x796906(0x375)](_0x796906(0x24e),()=>tgBot[_0x796906(0x236)]('SIGTERM')),tgBot['launch']();}}function disableTelegram(){const _0x16e373=_0x3ebe93;tgBot&&tgBot[_0x16e373(0x236)]();}async function sendTelegram(_0x2e3c8a,_0x40ba5d,_0x43fab3){const _0x47859a=_0x3ebe93;_0x43fab3={..._0x43fab3,'disable_web_page_preview':!![]};try{await tgBot['telegram']['sendMessage'](_0x2e3c8a,_0x40ba5d,_0x43fab3);}catch(_0x9ecb3c){console[_0x47859a(0x283)](_0x47859a(0x1f0),_0x9ecb3c);}}async function sendTelegramBot(_0xdea574,_0x115874){const _0x21489e=_0x3ebe93;if(settings[_0x21489e(0x2f9)]){if(settings[_0x21489e(0x2cb)]==_0x21489e(0x1f8)||(_0x115874[_0x21489e(0x3d7)]==_0x21489e(0x3a9)||_0x115874['type']==_0x21489e(0x22a)||_0x115874['type']=='success')&&settings['telegramEvents']==_0x21489e(0x2d5)||_0x115874[_0x21489e(0x3d7)]=='order'&&settings[_0x21489e(0x2cb)]==_0x21489e(0x21f)){if(tgBot&&settings[_0x21489e(0x347)]){if(_0x115874[_0x21489e(0x36e)])await sendTelegram(settings['telegramChatId'],_0x115874[_0x21489e(0x365)]+'\x20>\x20'+_0x115874['event']);else await sendTelegram(settings[_0x21489e(0x347)],'Bot\x20'+_0xdea574+_0x21489e(0x356)+_0x115874[_0x21489e(0x25f)]);}}}}async function sendTelegramMsg(_0x3c7a5f,_0xf4e08b='HTML'){const _0x30b580=_0x3ebe93;return settings[_0x30b580(0x2f9)]&&tgBot&&settings[_0x30b580(0x347)]?(await sendTelegram(settings[_0x30b580(0x347)],_0x3c7a5f,{'parse_mode':_0xf4e08b}),!![]):![];}function getDeviceWithIp(_0x22bc13){const _0xb09931=_0x3ebe93;return devices[_0xb09931(0x23d)](_0x47bf2c=>_0x47bf2c['ip']===_0x22bc13);}async function temporaryAccess2FA(_0x2068df,_0x2c8917){const _0x24dd32=_0x3ebe93;let _0x4d7b91=new Date(),_0x1988fe=![];if(lastIpApproval){if(_0x4d7b91-lastIpApproval<0x1388)_0x1988fe=!![];}lastIpApproval=new Date();if(_0x1988fe)return;if(tgBot&&settings[_0x24dd32(0x347)]){const _0x32dfb6=uuidRandom();tmpStorage[_0x32dfb6]={'uuid':_0x2068df,'externalip':_0x2c8917};const _0x1f9c89=Markup[_0x24dd32(0x34c)]([Markup['button'][_0x24dd32(0x2d9)]('5\x20min',_0x24dd32(0x2f7)+_0x32dfb6),Markup[_0x24dd32(0x23f)][_0x24dd32(0x2d9)]('15\x20min',_0x24dd32(0x384)+_0x32dfb6),Markup['button'][_0x24dd32(0x2d9)](_0x24dd32(0x377),_0x24dd32(0x3bf)+_0x32dfb6),Markup[_0x24dd32(0x23f)][_0x24dd32(0x2d9)](_0x24dd32(0x355),_0x24dd32(0x251)+_0x32dfb6)]);await sendTelegram(settings[_0x24dd32(0x347)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x2c8917)[_0x24dd32(0x303)]+'\x20?',_0x1f9c89),tgBot[_0x24dd32(0x1fe)](/tempaccess_(.+)_(.+)/,async _0x59e10c=>{const _0x59faba=_0x24dd32,_0x59bcaa=_0x59e10c[_0x59faba(0x3a1)][0x1],_0x4d94a0=_0x59e10c['match'][0x2],{uuid:_0x3916dc,externalip:_0x34208b}=tmpStorage[_0x4d94a0];delete tmpStorage[_0x4d94a0],_0x59e10c['editMessageReplyMarkup'](),devices[_0x3916dc][_0x59faba(0x1f9)]={'clientip':_0x34208b,'timestamp':new Date()[_0x59faba(0x288)](),'expiry':_0x59bcaa},_0x59bcaa!=_0x59faba(0x355)?(await sendTelegram(_0x59e10c[_0x59faba(0x281)]['id'],'Access\x20enabled\x20for\x20'+_0x59bcaa+_0x59faba(0x208),{'parse_mode':_0x59faba(0x35f)}),io['to'](_0x3916dc)['emit'](_0x59faba(0x212),{'access':{'allow':![],'reason':_0x59faba(0x340),'token':null}})):(await sendTelegram(_0x59e10c['chat']['id'],'Temporary\x20access\x20rejected'),io['to'](_0x3916dc)[_0x59faba(0x274)](_0x59faba(0x212),{'access':{'allow':![],'reason':_0x59faba(0x21b),'token':null}}));});}}async function loginAccess2FA(_0x3b46bf,_0x2c486a){const _0x4c74f6=_0x3ebe93;if(tgBot&&settings[_0x4c74f6(0x347)]){const _0x2d1d64=uuidRandom();tmpStorage[_0x2d1d64]={'uuid':_0x3b46bf,'externalip':_0x2c486a};const _0x344144=Markup['inlineKeyboard']([Markup[_0x4c74f6(0x23f)][_0x4c74f6(0x2d9)](_0x4c74f6(0x37d),_0x4c74f6(0x243)+loginExpiry+'_'+_0x2d1d64),Markup[_0x4c74f6(0x23f)]['callback'](_0x4c74f6(0x355),'login2fa_reject_'+_0x2d1d64)]);await sendTelegram(settings[_0x4c74f6(0x347)],_0x4c74f6(0x2ed)+normalizeIP(_0x2c486a)[_0x4c74f6(0x303)]+'\x20?',_0x344144),tgBot[_0x4c74f6(0x1fe)](/login2fa_(.+)_(.+)/,async _0x144376=>{const _0x2b0f85=_0x4c74f6,_0x3e7962=_0x144376['match'][0x1],_0x367257=_0x144376[_0x2b0f85(0x3a1)][0x2],{uuid:_0x1e5979,externalip:_0x25efa8}=tmpStorage[_0x367257];delete tmpStorage[_0x367257],_0x144376['editMessageReplyMarkup'](),devices[_0x1e5979][_0x2b0f85(0x2fa)]={'clientip':_0x25efa8,'timestamp':new Date()[_0x2b0f85(0x288)](),'expiry':_0x3e7962},_0x3e7962!=_0x2b0f85(0x355)?(await sendTelegram(_0x144376[_0x2b0f85(0x281)]['id'],_0x2b0f85(0x1e5),{'parse_mode':'HTML'}),io['to'](_0x1e5979)['emit'](_0x2b0f85(0x212),{'access':{'allow':![],'reason':_0x2b0f85(0x340),'token':null}})):(await sendTelegram(_0x144376[_0x2b0f85(0x281)]['id'],'Login\x20rejected'),io['to'](_0x1e5979)[_0x2b0f85(0x274)](_0x2b0f85(0x212),{'access':{'allow':![],'reason':_0x2b0f85(0x2c1),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1912e3=_0x3ebe93;return dbConfig['get'](_0x1912e3(0x385))[_0x1912e3(0x3a6)](_0x1912e3(0x211))['filter']({'status':_0x1912e3(0x2df)})['value']()||[];}function getDisabledBots(){const _0xa02cf2=_0x3ebe93;return dbConfig[_0xa02cf2(0x278)](_0xa02cf2(0x385))[_0xa02cf2(0x3a6)]('botID')[_0xa02cf2(0x20c)]({'status':_0xa02cf2(0x3a3)})[_0xa02cf2(0x373)]()||[];}function getBotAttributes(_0x3fe5d3){const _0x19c284=_0x3ebe93;let _0x424fd6={};const _0x163f62=configpath+_0x19c284(0x2a4)+_0x3fe5d3+'-config.json',_0x4f2af1=fs['existsSync'](_0x163f62);if(_0x4f2af1){const _0x2bbb61=fs[_0x19c284(0x27d)](_0x163f62);try{const _0xee2d41=JSON[_0x19c284(0x331)](_0x2bbb61),_0x19df2a=_0xee2d41?_0xee2d41[_0x19c284(0x339)][0x0]['headless']:![];_0x424fd6[_0x19c284(0x2fc)]=_0x19df2a?_0x19c284(0x3c4):_0x19c284(0x3ce),_0x424fd6[_0x19c284(0x365)]=_0xee2d41?_0xee2d41[_0x19c284(0x339)][0x0][_0x19c284(0x365)]:_0x19c284(0x3bd)+_0x3fe5d3;}catch(_0x55130e){_0x424fd6['mode']='manual',_0x424fd6['botname']=_0x19c284(0x3bd)+_0x3fe5d3;}}else _0x424fd6[_0x19c284(0x2fc)]='manual',_0x424fd6[_0x19c284(0x365)]=_0x19c284(0x3bd)+_0x3fe5d3;return _0x424fd6;}function getBotsWithMode(){const _0x2a0f3d=_0x3ebe93,_0x111542=dbConfig[_0x2a0f3d(0x278)](_0x2a0f3d(0x385))[_0x2a0f3d(0x3a6)](_0x2a0f3d(0x211))['value']()||[];return _0x111542[_0x2a0f3d(0x1d9)](_0x1ba32b=>{const _0x23d176=_0x2a0f3d;let _0x2b0061=getBotAttributes(_0x1ba32b[_0x23d176(0x211)]);_0x1ba32b[_0x23d176(0x2fc)]=_0x2b0061[_0x23d176(0x2fc)];}),_0x111542;}function getBotExchanges(){const _0xd29c68=_0x3ebe93;let _0x4b0b1e=[];const _0xedbbb8=dbConfig[_0xd29c68(0x278)](_0xd29c68(0x385))[_0xd29c68(0x3a6)]('botID')['value']()||[];_0xedbbb8[_0xd29c68(0x1d9)](_0x50fbef=>{const _0x40b00a=_0xd29c68;if(_0x50fbef[_0x40b00a(0x212)]==_0x40b00a(0x2df)){const _0x332ac7=configpath+_0x40b00a(0x2a4)+_0x50fbef[_0x40b00a(0x211)]+'-config.json',_0x1b3302=fs[_0x40b00a(0x245)](_0x332ac7);let _0x378f63;if(_0x1b3302){const _0x119e5b=fs[_0x40b00a(0x27d)](_0x332ac7);try{const _0x52853f=JSON['parse'](_0x119e5b);_0x378f63=_0x52853f?_0x52853f[_0x40b00a(0x339)][0x0][_0x40b00a(0x30b)]:null;}catch(_0x56645d){}}if(_0x378f63)_0x4b0b1e[_0x40b00a(0x24f)](_0x378f63);}});const _0x73f9a8=[...new Set(_0x4b0b1e)][_0xd29c68(0x349)]();return _0x73f9a8;}async function initUser(){const _0x4e3b07=_0x3ebe93;if(!settings[_0x4e3b07(0x259)]){const _0x336948=uuidRandom();mixpanel['alias'](_0x336948),updateSetting(_0x4e3b07(0x259),_0x336948);}}async function initSecure(){const _0x49cd21=_0x3ebe93;let _0x3db67f=getSecure();if(!_0x3db67f['hasOwnProperty'](_0x49cd21(0x1e2))){let _0x4e6bd2=await generateKeys();_0x3db67f[_0x49cd21(0x3a5)]=_0x4e6bd2[_0x49cd21(0x3a5)],_0x3db67f['privateKey']=_0x4e6bd2[_0x49cd21(0x3c2)],_0x3db67f[_0x49cd21(0x1e2)]=crypto[_0x49cd21(0x37b)](0x20)[_0x49cd21(0x2ee)](_0x49cd21(0x302));;storeSecure(_0x3db67f);}}function getSettings(){const _0xe15a27=_0x3ebe93;return dbSettings[_0xe15a27(0x278)](_0xe15a27(0x2d7))[_0xe15a27(0x373)]()||{};}function getSecure(){const _0xc9ffb3=_0x3ebe93;return dbSecure[_0xc9ffb3(0x278)](_0xc9ffb3(0x22f))[_0xc9ffb3(0x373)]()||{};}function getBlacklist(){const _0x1e7cde=_0x3ebe93;return dbSecure[_0x1e7cde(0x278)](_0x1e7cde(0x3a4))[_0x1e7cde(0x373)]()||[];}function broadcastToBots(_0x4c3e26,_0x3e7658){const _0x328774=_0x3ebe93;config[_0x328774(0x1d9)](_0x331a03=>{const _0x25cab5=_0x328774;if(_0x331a03[_0x25cab5(0x212)]==_0x25cab5(0x2df)&&_0x331a03['live']==_0x25cab5(0x216)||_0x331a03[_0x25cab5(0x212)]=='new'&&_0x331a03[_0x25cab5(0x317)]==_0x25cab5(0x216)){if(pid[_0x331a03[_0x25cab5(0x211)]])pid[_0x331a03[_0x25cab5(0x211)]]['send']({[_0x4c3e26]:_0x3e7658});}});}async function storeSettings(_0x55ab37,_0xdab6a7=![]){const _0xe74b4b=_0x3ebe93;_0x55ab37={...settings,..._0x55ab37};if(_0xdab6a7&&_0x55ab37[_0xe74b4b(0x23e)]!=_0xe74b4b(0x257)&&_0x55ab37[_0xe74b4b(0x23e)]!=_0xe74b4b(0x30a)&&_0x55ab37[_0xe74b4b(0x23e)]!=''){const _0x618eaf=crypt[_0xe74b4b(0x200)](secure[_0xe74b4b(0x3c2)],_0x55ab37[_0xe74b4b(0x23e)])['message'][_0xe74b4b(0x21d)](_0xe74b4b(0x343))[0x0],_0x492eb4=bcrypt[_0xe74b4b(0x314)](_0x618eaf,saltRounds);_0x55ab37={..._0x55ab37,'bbPassword':_0x492eb4};}if(_0xdab6a7&&_0x55ab37['telegramToken']!=_0xe74b4b(0x257)&&_0x55ab37[_0xe74b4b(0x3bb)]!=_0xe74b4b(0x30a)&&_0x55ab37[_0xe74b4b(0x3bb)]!=''){const _0x5c335f=crypt[_0xe74b4b(0x200)](secure[_0xe74b4b(0x3c2)],_0x55ab37[_0xe74b4b(0x3bb)])[_0xe74b4b(0x393)][_0xe74b4b(0x21d)](_0xe74b4b(0x343))[0x0];_0x55ab37={..._0x55ab37,'telegramToken':_0x5c335f};}if(_0xdab6a7&&_0x55ab37['marketcapApi']!=_0xe74b4b(0x257)&&_0x55ab37[_0xe74b4b(0x1dc)]!=_0xe74b4b(0x30a)&&_0x55ab37[_0xe74b4b(0x1dc)]!=''){const _0xcff4a1=crypt[_0xe74b4b(0x200)](secure[_0xe74b4b(0x3c2)],_0x55ab37['marketcapApi'])[_0xe74b4b(0x393)]['split'](_0xe74b4b(0x343))[0x0];_0x55ab37={..._0x55ab37,'marketcapApi':_0xcff4a1};}const _0x3e6fd8=_0x55ab37['telegramToken']!=_0xe74b4b(0x257)&&_0x55ab37['telegramToken']!=settings[_0xe74b4b(0x3bb)]||_0x55ab37[_0xe74b4b(0x2cc)]!=settings[_0xe74b4b(0x2cc)],_0x10eedb=_0x55ab37[_0xe74b4b(0x3bb)]==''||_0x55ab37[_0xe74b4b(0x2cc)]=='',_0x28c2e7=_0x55ab37['marketcapApi']&&_0x55ab37[_0xe74b4b(0x1dc)]!=_0xe74b4b(0x257)&&_0x55ab37[_0xe74b4b(0x1dc)]!=settings[_0xe74b4b(0x3bb)];_0x3e6fd8&&(_0x55ab37[_0xe74b4b(0x347)]=null,_0x55ab37['telegramEvents']=_0xe74b4b(0x1f8));for(const [_0x193546,_0x47f662]of Object['entries'](_0x55ab37)){if(_0x193546==_0xe74b4b(0x3bb)&&_0x47f662==_0xe74b4b(0x257)){_0x55ab37[_0xe74b4b(0x3bb)]=settings[_0xe74b4b(0x3bb)];continue;};if(_0x193546=='bbPassword'&&_0x47f662==_0xe74b4b(0x257)){_0x55ab37['bbPassword']=settings[_0xe74b4b(0x23e)];continue;};if(_0x193546==_0xe74b4b(0x1dc)&&_0x47f662=='************'){_0x55ab37['marketcapApi']=settings[_0xe74b4b(0x1dc)];continue;};dbSettings[_0xe74b4b(0x3c3)]('settings.'+_0x193546,_0x47f662)[_0xe74b4b(0x38a)]();}settings=_0x55ab37,io['to']('botmanager')[_0xe74b4b(0x274)]('settings',cleanSettings()),broadcastToBots(_0xe74b4b(0x3b6),settings[_0xe74b4b(0x3b6)]),broadcastToBots(_0xe74b4b(0x38d),settings['onepagemode']),broadcastToBots(_0xe74b4b(0x1dc),settings[_0xe74b4b(0x1dc)]);if(_0x3e6fd8&&!_0x10eedb)initTelegram();if(_0x3e6fd8&&_0x10eedb)disableTelegram();getAllClients()['forEach'](_0x1cb7a8=>{const _0x30176b=_0xe74b4b;getSocket(_0x1cb7a8['id'])[_0x30176b(0x274)](_0x30176b(0x212),{'access':{'allow':![],'reason':_0x30176b(0x340),'token':null}});}),_0x28c2e7&&(await sleep(0xbb8),testMarketcapApi(_0x55ab37[_0xe74b4b(0x1dc)]));}async function testMarketcapApi(_0x41be9f){const _0xd2f3c0=_0x3ebe93,_0x55d0e8=[_0xd2f3c0(0x22e),_0xd2f3c0(0x336)];try{await axios[_0xd2f3c0(0x278)](_0xd2f3c0(0x3b0),{'headers':{'X-CMC_PRO_API_KEY':_0x41be9f},'params':{'symbol':_0x55d0e8[_0xd2f3c0(0x2ee)]()}});}catch(_0x148951){_0x148951['toString']()['includes'](_0xd2f3c0(0x394))?(io['to'](_0xd2f3c0(0x3b7))[_0xd2f3c0(0x274)](_0xd2f3c0(0x354),_0xd2f3c0(0x367)),logger['full'](_0xd2f3c0(0x367))):(io['to'](_0xd2f3c0(0x3b7))[_0xd2f3c0(0x274)](_0xd2f3c0(0x354),'CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger['full'](_0xd2f3c0(0x326)),logger['debug'](_0xd2f3c0(0x2be),_0x148951[_0xd2f3c0(0x2ee)]()+_0xd2f3c0(0x268)+_0x148951['code']));return;}logger[_0xd2f3c0(0x34b)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x484682,_0x289a82){const _0x14fa64=_0x3ebe93;dbSettings[_0x14fa64(0x3c3)](_0x14fa64(0x351)+_0x484682,_0x289a82)[_0x14fa64(0x38a)](),settings=getSettings(),io['to'](_0x14fa64(0x3b7))[_0x14fa64(0x274)](_0x14fa64(0x2d7),cleanSettings());}function storeSecure(_0x46335c){const _0x5e84f6=_0x3ebe93;dbSecure[_0x5e84f6(0x278)](_0x5e84f6(0x22f))['push'](_0x46335c)['write'](),secure=_0x46335c;}function addBlacklist(_0x2dd0a3){const _0x1da07a=_0x3ebe93;cleanBlacklist();let _0x38359c;devices[_0x2dd0a3][_0x1da07a(0x1f9)]?_0x38359c=Math[_0x1da07a(0x3c5)](devices[_0x2dd0a3][_0x1da07a(0x1f9)][_0x1da07a(0x2a1)],loginExpiry):_0x38359c=loginExpiry,dbSecure[_0x1da07a(0x278)](_0x1da07a(0x3a4))['push']({'expiry':new Date()[_0x1da07a(0x288)]()+_0x38359c*0x3c*0x3e8,'token':devices[_0x2dd0a3][_0x1da07a(0x383)][_0x1da07a(0x3d5)]})[_0x1da07a(0x38a)](),blacklist=dbSecure[_0x1da07a(0x278)](_0x1da07a(0x3a4))[_0x1da07a(0x373)]();}function cleanBlacklist(){const _0x58d139=_0x3ebe93;let _0xfbcb8d=dbSecure[_0x58d139(0x278)](_0x58d139(0x3a4))[_0x58d139(0x3cb)]()['value'](),_0x5bd724=new Date()[_0x58d139(0x288)]();_0xfbcb8d[_0x58d139(0x1d9)](_0x299e9d=>{const _0x4e19e6=_0x58d139;_0x299e9d[_0x4e19e6(0x2a1)]<_0x5bd724&&dbSecure[_0x4e19e6(0x278)](_0x4e19e6(0x3a4))[_0x4e19e6(0x280)]({'expiry':_0x299e9d[_0x4e19e6(0x2a1)]})[_0x4e19e6(0x38a)]();});}function initStates(){const _0x2c2b62=_0x3ebe93;let _0x2164bf=getConfiguration();_0x2164bf[_0x2c2b62(0x1d9)](_0x3e8947=>{const _0x46fab1=_0x2c2b62;_0x3e8947[_0x46fab1(0x317)]='stopped';}),storeConfiguration(_0x2164bf);}function onKeys(){const _0x1334a1=new RSA();return new Promise(_0x1be1d1=>{const _0x554c78=_0x8b5d;_0x1334a1['generateKeyPairAsync']()[_0x554c78(0x20d)](_0x166628=>{_0x1be1d1(_0x166628);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x20cfce=_0x3ebe93;let _0x5ac2cd=getSettings(),_0x19e4f0=![];!_0x5ac2cd[_0x20cfce(0x2c0)](_0x20cfce(0x260))&&(_0x5ac2cd[_0x20cfce(0x260)]=0x0,_0x19e4f0=!![]);!_0x5ac2cd[_0x20cfce(0x2c0)](_0x20cfce(0x361))&&(_0x5ac2cd['lastmsgemitted']=0x0,_0x19e4f0=!![]);!_0x5ac2cd[_0x20cfce(0x2c0)](_0x20cfce(0x2f4))&&(_0x5ac2cd['latestversion']='0.0.0',_0x19e4f0=!![]);!_0x5ac2cd[_0x20cfce(0x2c0)](_0x20cfce(0x38d))&&(_0x5ac2cd[_0x20cfce(0x38d)]=![],_0x19e4f0=!![]);!_0x5ac2cd[_0x20cfce(0x2c0)](_0x20cfce(0x1dc))&&(_0x5ac2cd[_0x20cfce(0x1dc)]='',_0x19e4f0=!![]);if(_0x19e4f0)storeSettings(_0x5ac2cd);try{fs[_0x20cfce(0x214)](configbackuppath,{'withFileTypes':!![]})[_0x20cfce(0x1d9)](_0x2ff4ef=>{const _0x23811f=_0x20cfce;if(!_0x2ff4ef[_0x23811f(0x26e)]()){if(!_0x2ff4ef[_0x23811f(0x36b)]['startsWith'](_0x23811f(0x381)))fs[_0x23811f(0x2a5)](configbackuppath+_0x2ff4ef['name']);}else fs[_0x23811f(0x360)](configbackuppath+_0x2ff4ef['name'],{'recursive':!![]});});}catch(_0xf03454){logger[_0x20cfce(0x34b)]('Error\x20removing\x20old\x20backup\x20files:',_0xf03454);}}function storeConfiguration(_0x474574){const _0x1315e6=_0x3ebe93;dbConfig['get'](_0x1315e6(0x385))[_0x1315e6(0x280)]()[_0x1315e6(0x38a)](),dbConfig[_0x1315e6(0x278)](_0x1315e6(0x385))['push'](..._0x474574)['write'](),config=_0x474574;}async function resetPassword(){const _0x2589de=_0x3ebe93;if(tgBot&&settings[_0x2589de(0x347)]){const _0x2f2eca=Markup[_0x2589de(0x34c)]([Markup[_0x2589de(0x23f)][_0x2589de(0x2d9)](_0x2589de(0x341),_0x2589de(0x29c)),Markup['button'][_0x2589de(0x2d9)]('no',_0x2589de(0x376))]);await sendTelegram(settings[_0x2589de(0x347)],_0x2589de(0x25d),_0x2f2eca),tgBot[_0x2589de(0x1fe)](/resetpw_(.+)/,async _0x4358fa=>{const _0x17f0e5=_0x2589de,_0x480f52=_0x4358fa['match'][0x1];_0x4358fa[_0x17f0e5(0x2b1)]();if(_0x480f52!='no'){const _0xbc7d09=0xf,_0x499982='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x4eca2b=Array['from'](crypto[_0x17f0e5(0x204)](new Uint32Array(_0xbc7d09)))[_0x17f0e5(0x26a)](_0x5c71cd=>_0x499982[_0x5c71cd%_0x499982[_0x17f0e5(0x388)]])[_0x17f0e5(0x33e)](''),_0x2be206=bcrypt[_0x17f0e5(0x314)](_0x4eca2b,saltRounds);storeSettings({'bbPassword':_0x2be206}),await sendTelegram(_0x4358fa[_0x17f0e5(0x281)]['id'],_0x17f0e5(0x37e)+_0x4eca2b,{'parse_mode':'HTML'});}else await sendTelegram(_0x4358fa['chat']['id'],_0x17f0e5(0x2ae));});}}async function confirmRestore(_0x563269,_0x2ab354){const _0x3065ba=_0x3ebe93;io['to'](_0x3065ba(0x3b7))['emit']('notification','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x3065ba(0x305));if(tgBot&&settings['telegramChatId']){const _0x354e71=uuidRandom();tmpStorage[_0x354e71]={'path':_0x563269,'filename':_0x2ab354};const _0x5ab8ea=Markup['inlineKeyboard']([Markup[_0x3065ba(0x23f)]['callback'](_0x3065ba(0x341),'restore_yes_'+_0x354e71),Markup['button']['callback']('no','restore_no_'+_0x354e71)]);await sendTelegram(settings['telegramChatId'],_0x3065ba(0x352),_0x5ab8ea),tgBot['action'](/restore_(.+)_(.+)/,async _0x7ae464=>{const _0x53b0bf=_0x3065ba,_0x1703b7=_0x7ae464[_0x53b0bf(0x3a1)][0x1],_0x32b9e2=_0x7ae464[_0x53b0bf(0x3a1)][0x2],{path:_0x7cba9d,filename:_0x2ff415}=tmpStorage[_0x32b9e2];delete tmpStorage[_0x32b9e2],_0x7ae464[_0x53b0bf(0x2b1)](),_0x1703b7==_0x53b0bf(0x341)?(logger[_0x53b0bf(0x34b)](_0x53b0bf(0x296)),await sendTelegram(_0x7ae464[_0x53b0bf(0x281)]['id'],_0x53b0bf(0x226),{'parse_mode':_0x53b0bf(0x35f)}),unzipFile(_0x7cba9d,_0x2ff415)):(logger[_0x53b0bf(0x34b)]('Restore\x20process\x20aborted'),await sendTelegram(_0x7ae464[_0x53b0bf(0x281)]['id'],_0x53b0bf(0x2a3)));});}}function getServerTime(){const _0x1746e2=_0x3ebe93,_0x1b48a6=new Date();return _0x1b48a6[_0x1746e2(0x3aa)]()+'/'+(_0x1b48a6[_0x1746e2(0x2a2)]()+0x1)[_0x1746e2(0x2ee)]()[_0x1746e2(0x29a)](0x2,'0')+'/'+_0x1b48a6[_0x1746e2(0x358)]()[_0x1746e2(0x2ee)]()[_0x1746e2(0x29a)](0x2,'0')+'\x20'+_0x1b48a6[_0x1746e2(0x36d)]()[_0x1746e2(0x2ee)]()[_0x1746e2(0x29a)](0x2,'0')+':'+_0x1b48a6[_0x1746e2(0x1ee)]()['toString']()[_0x1746e2(0x29a)](0x2,'0')+':'+_0x1b48a6[_0x1746e2(0x319)]()[_0x1746e2(0x2ee)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x3814d0=_0x3ebe93,_0x263dc2=shiftedTime();return _0x263dc2[_0x3814d0(0x3aa)]()+'/'+(_0x263dc2[_0x3814d0(0x2a2)]()+0x1)[_0x3814d0(0x2ee)]()['padStart'](0x2,'0')+'/'+_0x263dc2[_0x3814d0(0x358)]()[_0x3814d0(0x2ee)]()[_0x3814d0(0x29a)](0x2,'0')+'\x20'+_0x263dc2[_0x3814d0(0x36d)]()[_0x3814d0(0x2ee)]()['padStart'](0x2,'0')+':'+_0x263dc2['getMinutes']()[_0x3814d0(0x2ee)]()[_0x3814d0(0x29a)](0x2,'0')+':'+_0x263dc2[_0x3814d0(0x319)]()['toString']()[_0x3814d0(0x29a)](0x2,'0');}function getCleanTimeStamp(){const _0xd54b33=_0x3ebe93,_0x39624e=shiftedTime();return _0x39624e[_0xd54b33(0x3aa)]()+(_0x39624e[_0xd54b33(0x2a2)]()+0x1)[_0xd54b33(0x2ee)]()[_0xd54b33(0x29a)](0x2,'0')+_0x39624e['getDate']()[_0xd54b33(0x2ee)]()[_0xd54b33(0x29a)](0x2,'0')+'-'+_0x39624e[_0xd54b33(0x36d)]()[_0xd54b33(0x2ee)]()[_0xd54b33(0x29a)](0x2,'0')+_0x39624e['getMinutes']()[_0xd54b33(0x2ee)]()[_0xd54b33(0x29a)](0x2,'0')+_0x39624e[_0xd54b33(0x319)]()['toString']()[_0xd54b33(0x29a)](0x2,'0');}function shiftedTime(){const _0xeec06e=_0x3ebe93,_0x36b34e=new Date();let _0x5573f4=_0x36b34e;if(settings[_0xeec06e(0x3b6)]&&settings[_0xeec06e(0x3b6)]!==0x0)_0x5573f4=fns[_0xeec06e(0x3ca)](_0x36b34e,{'hours':settings[_0xeec06e(0x3b6)]});return _0x5573f4;}function startScheduler(){const _0x4ddb24=_0x3ebe93,_0x24b705=new Date()[_0x4ddb24(0x2f5)](),_0x40090d=shiftedTime()[_0x4ddb24(0x36d)]();_0x40090d==0x4&&backupConfigFiles();_0x40090d==0x0&&rotateLogFiles();_0x24b705%0x6==0x0&&triggerAnalytics();_0x24b705%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x8e50f2){const _0x37ab0d=_0x3ebe93;logger[_0x37ab0d(0x34b)](_0x37ab0d(0x205)+_0x8e50f2);const _0x4036b9=getBotsWithMode();_0x4036b9[_0x37ab0d(0x388)]>0x0?confirmRestore(configbackuppath,_0x8e50f2):unzipFile(configbackuppath,_0x8e50f2);}async function getBackupFiles(_0x2f94d2=null){const _0x8f08f6=_0x3ebe93;let _0x5cb805=[],_0x12e470=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x12e470[_0x8f08f6(0x349)]((_0x11c057,_0x43eaed)=>_0x11c057[_0x8f08f6(0x36b)]<_0x43eaed[_0x8f08f6(0x36b)]?0x1:_0x43eaed['name']<_0x11c057['name']?-0x1:0x0),_0x12e470[_0x8f08f6(0x1d9)](_0x4d2665=>{const _0x490507=_0x8f08f6;if(!_0x4d2665[_0x490507(0x26e)]()&&_0x4d2665[_0x490507(0x36b)][_0x490507(0x3ba)](_0x490507(0x381))&&_0x4d2665[_0x490507(0x36b)][_0x490507(0x31b)](_0x490507(0x25b))){const _0x405278=formatDate(fs[_0x490507(0x2fd)](configbackuppath+_0x4d2665[_0x490507(0x36b)])[_0x490507(0x2ea)]);_0x5cb805[_0x490507(0x24f)]({'name':_0x4d2665[_0x490507(0x36b)],'mtime':_0x405278});}});if(_0x2f94d2)io['to'](_0x2f94d2)[_0x8f08f6(0x274)]('backup-files',_0x5cb805);else return _0x5cb805;}async function backupConfigFiles(){const _0x210718=_0x3ebe93;await zipFiles('backup-full');const _0x3366d0=getCleanTimeStamp();fs[_0x210718(0x2dd)](zippath+_0x210718(0x33c),configbackuppath+(_0x210718(0x381)+_0x3366d0+_0x210718(0x25b)));let _0x4e4e5e=fs[_0x210718(0x214)](configbackuppath,{'withFileTypes':!![]});_0x4e4e5e[_0x210718(0x349)]((_0x1c264d,_0x3f5841)=>_0x1c264d[_0x210718(0x36b)]<_0x3f5841['name']?0x1:_0x3f5841[_0x210718(0x36b)]<_0x1c264d['name']?-0x1:0x0),_0x4e4e5e['length']>maxBackups&&fs['unlinkSync'](configbackuppath+_0x4e4e5e[_0x4e4e5e[_0x210718(0x388)]-0x1][_0x210718(0x36b)]);}function rotateLogFiles(){const _0x31c8f7=_0x3ebe93,_0x959d81=fs[_0x31c8f7(0x2fd)](logspath+_0x31c8f7(0x2f3)),_0x64344d=_0x959d81[_0x31c8f7(0x32d)]/0x400;if(_0x64344d>0x64){let _0x1088e0=fs[_0x31c8f7(0x214)](logspath,{'withFileTypes':!![]});_0x1088e0[_0x31c8f7(0x349)]((_0x19c4a3,_0x2c74c7)=>_0x19c4a3[_0x31c8f7(0x36b)]<_0x2c74c7[_0x31c8f7(0x36b)]?0x1:_0x2c74c7[_0x31c8f7(0x36b)]<_0x19c4a3[_0x31c8f7(0x36b)]?-0x1:0x0),_0x1088e0[_0x31c8f7(0x1d9)](_0x108914=>{const _0x184f11=_0x31c8f7;if(_0x108914[_0x184f11(0x36b)]==_0x184f11(0x368))fs[_0x184f11(0x2dd)](logspath+_0x108914[_0x184f11(0x36b)],logspath+'output-003.log');if(_0x108914[_0x184f11(0x36b)]==_0x184f11(0x1fd))fs[_0x184f11(0x2dd)](logspath+_0x108914['name'],logspath+'output-002.log');_0x108914[_0x184f11(0x36b)]==_0x184f11(0x2f3)&&(fs[_0x184f11(0x2dd)](logspath+_0x108914[_0x184f11(0x36b)],logspath+_0x184f11(0x1fd)),fs[_0x184f11(0x2d2)](logspath+_0x108914['name'],''));});}}async function zipFiles(_0x3cb3ff){const _0x431819=_0x3ebe93;let _0x3fb3a0;if(_0x3cb3ff==_0x431819(0x3d1))_0x3fb3a0=logspath;if(_0x3cb3ff=='backup')_0x3fb3a0=configpath;if(_0x3cb3ff==_0x431819(0x2e9))_0x3fb3a0=configpath;let _0x351c92=fs[_0x431819(0x214)](_0x3fb3a0,{'withFileTypes':!![]});const _0x374701=new require(_0x431819(0x22b))();_0x351c92[_0x431819(0x1d9)](_0x4df00b=>{const _0x219316=_0x431819;if(!_0x4df00b[_0x219316(0x26e)]()){let _0x5d1b90=fs[_0x219316(0x27d)](_0x3fb3a0+_0x4df00b[_0x219316(0x36b)]);if(_0x3cb3ff==_0x219316(0x287)){const _0x11f013=/^bot-[0-9]{3}-config.json$/,_0x3d6202=_0x11f013[_0x219316(0x396)](_0x4df00b[_0x219316(0x36b)]);if(_0x3d6202){const _0x5001d5=JSON[_0x219316(0x331)](_0x5d1b90);if(_0x5001d5['bot'][0x0]){_0x5001d5[_0x219316(0x339)][0x0]['apiKey']=_0x219316(0x30a),_0x5001d5[_0x219316(0x339)][0x0][_0x219316(0x306)]='***';if(_0x5001d5[_0x219316(0x339)][0x0][_0x219316(0x248)])_0x5001d5[_0x219316(0x339)][0x0][_0x219316(0x248)]='***';}_0x5d1b90=JSON['stringify'](_0x5001d5,null,0x2);}if(_0x4df00b['name']==_0x219316(0x36c)){const _0xa180b2=JSON[_0x219316(0x331)](_0x5d1b90);if(_0xa180b2[_0x219316(0x2d7)][_0x219316(0x325)])_0xa180b2[_0x219316(0x2d7)][_0x219316(0x325)]=![];if(_0xa180b2[_0x219316(0x2d7)][_0x219316(0x23e)])_0xa180b2['settings'][_0x219316(0x23e)]=_0x219316(0x30a);if(_0xa180b2['settings'][_0x219316(0x3bb)])_0xa180b2['settings'][_0x219316(0x3bb)]=_0x219316(0x30a);if(_0xa180b2[_0x219316(0x2d7)][_0x219316(0x347)])_0xa180b2[_0x219316(0x2d7)][_0x219316(0x347)]=null;if(_0xa180b2['settings']['marketcapApi'])_0xa180b2[_0x219316(0x2d7)][_0x219316(0x1dc)]=_0x219316(0x30a);_0x5d1b90=JSON[_0x219316(0x242)](_0xa180b2,null,0x2);}if(_0x4df00b['name']!=_0x219316(0x334))_0x374701['file'](_0x4df00b[_0x219316(0x36b)],_0x5d1b90);}else _0x374701[_0x219316(0x2bd)](_0x4df00b[_0x219316(0x36b)],_0x5d1b90);}});const _0x1212e3=_0x374701[_0x431819(0x28f)]({'base64':![],'compression':_0x431819(0x276)});fs[_0x431819(0x2d2)](zippath+(_0x3cb3ff+_0x431819(0x25b)),_0x1212e3,'binary');}async function unzipFile(_0x17b330,_0x46c8ce){const _0x52fb40=_0x3ebe93;fs[_0x52fb40(0x214)](configpath,{'withFileTypes':!![]})['forEach'](_0x284788=>{const _0x5d1fdd=_0x52fb40;if(!_0x284788['isDirectory']())fs[_0x5d1fdd(0x360)](configpath+_0x284788[_0x5d1fdd(0x36b)]);});const _0x409828=fs['readFileSync'](_0x17b330+_0x46c8ce,_0x52fb40(0x1f7)),_0x280b44=new require(_0x52fb40(0x22b))(_0x409828,{'base64':![],'checkCRC32':!![]});Object[_0x52fb40(0x1f4)](_0x280b44[_0x52fb40(0x2b5)])['forEach'](_0xe73ddf=>{const _0x47b739=_0x52fb40,_0x404f6d=_0x280b44[_0x47b739(0x2b5)][_0xe73ddf];fs['writeFileSync'](configpath+_0x404f6d['name'],_0x404f6d[_0x47b739(0x24c)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x52fb40(0x1d9)](_0x6f1a35=>{const _0x4ce0b9=_0x52fb40;if(!_0x6f1a35[_0x4ce0b9(0x26e)]())fs[_0x4ce0b9(0x360)](temppath+_0x6f1a35[_0x4ce0b9(0x36b)]);}),logger[_0x52fb40(0x34b)](_0x52fb40(0x284)),process[_0x52fb40(0x2ab)]({'restore':!![]},_0x53d4a2=>{});}function _0x8b5d(_0x3e0bfc,_0x29c2b6){const _0x194f3b=_0x3844();return _0x8b5d=function(_0x540bc1,_0x38a4d7){_0x540bc1=_0x540bc1-0x1d9;let _0x384496=_0x194f3b[_0x540bc1];return _0x384496;},_0x8b5d(_0x3e0bfc,_0x29c2b6);}async function getPublicIp(){const _0x4edcce=_0x3ebe93;try{const _0x292888=await axios[_0x4edcce(0x278)](_0x4edcce(0x332));publicip=_0x292888[_0x4edcce(0x2cd)]['ip'];}catch(_0xabb0d6){}}async function triggerAnalytics(){const _0x3464cd=_0x3ebe93;if(!publicip)await getPublicIp();const _0x54bdab=getBotsWithMode();let _0x2274cc=0x0;_0x54bdab[_0x3464cd(0x1d9)](_0x4f3f15=>{const _0xefa2f5=_0x3464cd;if(_0x4f3f15[_0xefa2f5(0x212)]===_0xefa2f5(0x2df))_0x2274cc++;});const _0x19a8fc=getBotExchanges();mixpanel[_0x3464cd(0x273)](_0x3464cd(0x26b),{'distinct_id':settings[_0x3464cd(0x259)],'ip':publicip,'version':serverversion,'numbots':_0x54bdab[_0x3464cd(0x388)],'numbotsenabled':_0x2274cc,'exchanges':_0x19a8fc,'environment':environment});}async function getMessages(){const _0x37457f=_0x3ebe93,_0x8acf9b=_0x37457f(0x2e6),_0x28a3ac=new GraphQLClient(_0x8acf9b),_0x5c9ea4={'authorization':_0x37457f(0x2ad)},_0x17b687=serverversion[_0x37457f(0x21d)]('.'),_0x5264d0=_0x17b687[0x0]+'.'+_0x17b687[0x1],_0x12d29f=Math[_0x37457f(0x2b4)](settings[_0x37457f(0x260)],settings[_0x37457f(0x361)]),_0x33da1c={'last':parseInt(_0x12d29f),'bbm':_0x5264d0},_0x3e816e=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x2e42f7;try{_0x2e42f7=await _0x28a3ac['request'](_0x3e816e,_0x33da1c,_0x5c9ea4);}catch(_0x41085b){}if(_0x2e42f7&&_0x2e42f7[_0x37457f(0x399)]){let _0x3f4cb9=settings[_0x37457f(0x260)];newMessages=[];for(const _0x2f6a15 of _0x2e42f7[_0x37457f(0x399)]){newMessages['push'](_0x2f6a15);let _0x13efcb=![];_0x2f6a15[_0x37457f(0x379)]&&(updateSetting(_0x37457f(0x2f4),_0x2f6a15[_0x37457f(0x379)]),_0x13efcb=isNewerVersion(serverversion,_0x2f6a15[_0x37457f(0x379)])||serverversion==_0x2f6a15[_0x37457f(0x379)]);if(!_0x13efcb&&_0x2f6a15[_0x37457f(0x2f6)]>_0x3f4cb9){if(_0x2f6a15[_0x37457f(0x22d)]===_0x37457f(0x201)||serverversion[_0x37457f(0x3ba)](_0x2f6a15[_0x37457f(0x22d)])){let _0x64f482=''+_0x2f6a15[_0x37457f(0x374)]+'\x0a\x0a'+_0x2f6a15[_0x37457f(0x393)];const _0x1201b4=await sendTelegramMsg(toTelegramMarkdown(_0x64f482),_0x37457f(0x370));if(_0x1201b4)_0x3f4cb9=_0x2f6a15[_0x37457f(0x2f6)];}}}updateAvailable=isNewerVersion(settings[_0x37457f(0x2f4)],serverversion),updateSetting(_0x37457f(0x260),_0x3f4cb9),emitMessages();}}function emitMessages(){const _0x32128c=_0x3ebe93,_0x3120c2=settings[_0x32128c(0x361)];let _0x2ee785=[];newMessages[_0x32128c(0x1d9)](_0x59c380=>{const _0x24fe79=_0x32128c;_0x59c380[_0x24fe79(0x2f6)]>_0x3120c2&&_0x2ee785['push'](_0x59c380);}),_0x2ee785[_0x32128c(0x388)]>0x0&&getAllClients()['forEach'](_0x3c3f6e=>{const _0x5794fc=_0x32128c;getSocket(_0x3c3f6e['id'])[_0x5794fc(0x274)](_0x5794fc(0x393),_0x2ee785);});}function confirmMessage(_0xc60813){const _0x5b34d5=_0x3ebe93;updateSetting(_0x5b34d5(0x361),Number(_0xc60813));}function isNewerVersion(_0x4a6c32,_0x7cffef){const _0x446e76=_0x3ebe93,_0x577398=_0x7cffef[_0x446e76(0x21d)]('.'),_0x173d39=_0x4a6c32[_0x446e76(0x21d)]('.');for(var _0x20f44f=0x0;_0x20f44f<_0x173d39[_0x446e76(0x388)];_0x20f44f++){const _0x1e24b4=~~_0x173d39[_0x20f44f],_0x3b1395=~~_0x577398[_0x20f44f];if(_0x1e24b4>_0x3b1395)return!![];if(_0x1e24b4<_0x3b1395)return![];}return![];}function toTelegramMarkdown(_0x126ff8){const _0x242250=_0x3ebe93,_0x442d14=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x58cc54=/\*{2}(.+?)\*{2}/gim;return _0x126ff8=_0x126ff8[_0x242250(0x238)](_0x442d14,'$1_$2_$3')['replace'](_0x58cc54,_0x242250(0x32e)),_0x126ff8;}async function validateConfigFile(){const _0x1edb11=_0x3ebe93,_0x26bbaf=dbConfig[_0x1edb11(0x278)](_0x1edb11(0x385))[_0x1edb11(0x3a6)](_0x1edb11(0x211))[_0x1edb11(0x373)]()||[];if(_0x26bbaf[_0x1edb11(0x388)]==0x0){let _0x19fcf2=0x0,_0x57ec02=[];const _0x916f66=/^bot-([0-9]{3})-config.json$/,_0x5e91ea=fs[_0x1edb11(0x214)](configpath);_0x5e91ea[_0x1edb11(0x1d9)](_0x3e730c=>{const _0x6cfd5d=_0x1edb11,_0xa6c0d5=_0x916f66[_0x6cfd5d(0x390)](_0x3e730c);if(_0xa6c0d5){const _0x5be2aa=_0xa6c0d5[0x1];let _0x5d6bf8=getBotAttributes(_0x5be2aa);_0x57ec02[_0x6cfd5d(0x24f)]({'botID':_0x5be2aa,'botname':_0x5d6bf8[_0x6cfd5d(0x365)],'status':_0x6cfd5d(0x3a3),'live':_0x6cfd5d(0x1f1)}),_0x19fcf2++;}}),_0x19fcf2!=0x0&&(dbConfig[_0x1edb11(0x278)](_0x1edb11(0x385))[_0x1edb11(0x289)](_0x57ec02)[_0x1edb11(0x38a)](),config=_0x57ec02,restoredConfigFile=_0x19fcf2);}}async function restoreConfigNotify(_0x1b0ac9){const _0x5d593a=_0x3ebe93;let _0x409210;if(restoredConfigFile==0x1)_0x409210=_0x5d593a(0x272);else _0x409210=_0x5d593a(0x269);if(_0x1b0ac9)io['to'](_0x5d593a(0x3b7))[_0x5d593a(0x274)](_0x5d593a(0x354),_0x409210);else{logger['simple'](_0x5d593a(0x27e)),logger['simple'](_0x409210),logger[_0x5d593a(0x345)]('-----------------------------------------------------------------------------------'),logger[_0x5d593a(0x345)]('');if(tgBot&&settings[_0x5d593a(0x347)]&&settings[_0x5d593a(0x2cb)]!=_0x5d593a(0x21f))await sendTelegram(settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x409210);}}function validateCredentials(_0xe3d01b,_0x398626){const _0x1da3bc=_0x3ebe93;if(_0xe3d01b[_0x1da3bc(0x26d)]==settings['bbUsername']&&bcrypt[_0x1da3bc(0x277)](_0xe3d01b[_0x1da3bc(0x318)],settings[_0x1da3bc(0x23e)])){if(settings[_0x1da3bc(0x213)])return{'allow':![],'reason':_0x1da3bc(0x1ed),'token':null};else{const _0x19c067=generateLoginToken(_0x398626);return{'allow':!![],'reason':_0x1da3bc(0x301),'token':_0x19c067};}}else return{'allow':![],'reason':_0x1da3bc(0x2f0),'token':null};}function refreshToken(_0x25afab){const _0x369e1e=_0x3ebe93,_0x304291=generateLoginToken(_0x25afab);return{'allow':!![],'reason':_0x369e1e(0x301),'token':_0x304291};}function validateAccess(_0x2a6536,_0x47323c,_0x6f6e26){const _0x2bcb52=_0x3ebe93,_0x54da14=_0x6f6e26?_0x6f6e26:devices[_0x47323c]['ip'];let _0x5bb9fd;const _0x4c154a=_0x116f49=>{const _0x5f3bc4=_0x8b5d;if(settings['loginRequired']){if(settings[_0x5f3bc4(0x213)]){if(telegram2FaApproved(_0x47323c)){const _0x2bac0d=generateLoginToken(_0x47323c);return{'allow':!![],'reason':_0x5f3bc4(0x1fc),'token':_0x2bac0d};}else return{'allow':![],'reason':_0x5f3bc4(0x220),'token':null};}else return _0x5bb9fd=validToken(_0x116f49,_0x47323c),_0x5bb9fd[_0x5f3bc4(0x2c0)]('success')?{'allow':!![],'reason':_0x5f3bc4(0x2db),'token':_0x116f49}:{'allow':![],'reason':_0x5f3bc4(0x220),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings['whitelistEnabled']){let _0x2ff277=[...settings[_0x2bcb52(0x2b3)],_0x2bcb52(0x3b1),_0x2bcb52(0x234),'127.0.0.1'];if(_0x2ff277['includes'](_0x54da14))return _0x4c154a(_0x2a6536);else{_0x5bb9fd=validToken(_0x2a6536,_0x47323c);if(_0x5bb9fd[_0x2bcb52(0x2c0)](_0x2bcb52(0x305)))return _0x4c154a(_0x2a6536);else{if(telegramIpApproved(_0x47323c)){const _0x20d8d0=generateToken(_0x47323c);return _0x5bb9fd=_0x4c154a(_0x2a6536),_0x5bb9fd[_0x2bcb52(0x344)]?{'allow':!![],'reason':_0x2bcb52(0x285),'token':_0x20d8d0}:_0x5bb9fd;}else return settings[_0x2bcb52(0x3ad)]?{'allow':![],'reason':_0x2bcb52(0x2b2),'token':null}:{'allow':![],'reason':_0x2bcb52(0x2d1),'token':null};}}}else return _0x4c154a(_0x2a6536);}function timelyDecrypt(_0x55aca3,_0x281ba2,_0x3948f5='@'){const _0x57fb26=_0x3ebe93;if(_0x55aca3)try{const _0x4922a3=crypt[_0x57fb26(0x200)](secure['privateKey'],_0x55aca3)[_0x57fb26(0x393)],_0x2851e8=_0x4922a3[_0x57fb26(0x21d)](_0x3948f5)[0x0],_0x26030c=_0x4922a3[_0x57fb26(0x21d)](_0x3948f5)[0x1],_0x192e4d=new Date()[_0x57fb26(0x288)]();if(_0x281ba2){if(_0x192e4d-_0x26030c<maxSecretAge*0x3e8)return _0x2851e8;else return![];}else return _0x2851e8;}catch(_0x8eb6ce){return![];}else return![];}const validToken=(_0x3ed0fd,_0x38cedb)=>{const _0x1aeaed=_0x3ebe93,_0x45debc=devices[_0x38cedb]['ip'];if(!_0x3ed0fd)return{'error':'No\x20authentication\x20token'};for(let _0x35bf65 of blacklist){if(_0x35bf65['token']==_0x3ed0fd)return{'error':_0x1aeaed(0x34f)};}let _0x64eab6;try{_0x64eab6=jwt['verify'](_0x3ed0fd,secure['secret']+_0x38cedb);}catch{return{'error':_0x1aeaed(0x222)};}if(!_0x64eab6[_0x1aeaed(0x2c0)]('clientip')&&!_0x64eab6[_0x1aeaed(0x2c0)](_0x1aeaed(0x26d))||!_0x64eab6[_0x1aeaed(0x2c0)](_0x1aeaed(0x2f2)))return{'error':_0x1aeaed(0x346)};if(!_0x64eab6['hasOwnProperty'](_0x1aeaed(0x26d))&&_0x64eab6[_0x1aeaed(0x2c0)](_0x1aeaed(0x38e))){const {clientip:_0x289aec}=_0x64eab6;return _0x45debc==_0x289aec?{'success':_0x1aeaed(0x327)}:{'error':_0x1aeaed(0x202)};}else{if(_0x64eab6[_0x1aeaed(0x2c0)]('username')&&_0x64eab6['hasOwnProperty'](_0x1aeaed(0x38e))){const {username:_0x4e3e19,clientip:_0x1c7b58}=_0x64eab6;return settings[_0x1aeaed(0x32b)]==_0x4e3e19&&_0x45debc==_0x1c7b58?{'success':_0x1aeaed(0x327)}:{'error':_0x1aeaed(0x2b6)};}}},generateLoginToken=_0x30766a=>{const _0x4ca99a=_0x3ebe93;if(_0x30766a){const _0x13554f=devices[_0x30766a]['ip'];return jwt['sign']({'username':settings[_0x4ca99a(0x32b)],'clientip':_0x13554f},secure[_0x4ca99a(0x1e2)]+_0x30766a,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x1f4ff2=>{const _0x3ee33e=_0x3ebe93;if(_0x1f4ff2){const _0xc0ace4=devices[_0x1f4ff2]['ip'];return jwt[_0x3ee33e(0x2c3)]({'clientip':_0xc0ace4},secure[_0x3ee33e(0x1e2)]+_0x1f4ff2,{'expiresIn':devices[_0x1f4ff2][_0x3ee33e(0x1f9)][_0x3ee33e(0x2a1)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x249338=>{const _0x55c4ad=_0x3ebe93;let _0x52ec5e=![];return devices[_0x249338]['telegramIpApproval']&&devices[_0x249338][_0x55c4ad(0x1f9)][_0x55c4ad(0x2a1)]!='reject'&&(_0x52ec5e=devices[_0x249338][_0x55c4ad(0x1f9)][_0x55c4ad(0x38e)]==devices[_0x249338]['ip']&&new Date()[_0x55c4ad(0x288)]()-devices[_0x249338][_0x55c4ad(0x1f9)][_0x55c4ad(0x2fe)]<devices[_0x249338][_0x55c4ad(0x1f9)][_0x55c4ad(0x2a1)]*0x3c*0x3e8),_0x52ec5e;},telegram2FaApproved=_0x548076=>{const _0x3a4325=_0x3ebe93;let _0x179661=![];return devices[_0x548076][_0x3a4325(0x2fa)]&&devices[_0x548076][_0x3a4325(0x2fa)][_0x3a4325(0x2a1)]!=_0x3a4325(0x355)&&(_0x179661=devices[_0x548076][_0x3a4325(0x2fa)][_0x3a4325(0x38e)]==devices[_0x548076]['ip']&&new Date()[_0x3a4325(0x288)]()-devices[_0x548076][_0x3a4325(0x2fa)][_0x3a4325(0x2fe)]<devices[_0x548076][_0x3a4325(0x2fa)][_0x3a4325(0x2a1)]*0x3c*0x3e8),_0x179661;},normalizeIP=_0x7c1a8e=>{const _0x38e62a=_0x3ebe93;let _0x42009d=null,_0x153726=null;if(ipaddr[_0x38e62a(0x28a)](_0x7c1a8e)){const _0x3517f8=ipaddr[_0x38e62a(0x331)](_0x7c1a8e);_0x3517f8[_0x38e62a(0x380)]()===_0x38e62a(0x25c)?(_0x3517f8[_0x38e62a(0x34e)]()&&(_0x42009d=_0x3517f8[_0x38e62a(0x1e4)]()[_0x38e62a(0x2ee)]()),_0x153726=_0x3517f8['toString']()):(_0x42009d=_0x3517f8['toString'](),_0x153726=_0x3517f8[_0x38e62a(0x1e3)]()[_0x38e62a(0x2ee)]());}return{'show':_0x42009d?_0x42009d:_0x153726,'store':_0x153726};};function formatDate(_0x41c98e){const _0x5ea563=_0x3ebe93;return _0x41c98e[_0x5ea563(0x3aa)]()+'/'+(_0x41c98e[_0x5ea563(0x2a2)]()+0x1)[_0x5ea563(0x2ee)]()[_0x5ea563(0x29a)](0x2,'0')+'/'+_0x41c98e[_0x5ea563(0x358)]()['toString']()[_0x5ea563(0x29a)](0x2,'0')+'\x20'+_0x41c98e[_0x5ea563(0x36d)]()[_0x5ea563(0x2ee)]()[_0x5ea563(0x29a)](0x2,'0')+':'+_0x41c98e[_0x5ea563(0x1ee)]()['toString']()['padStart'](0x2,'0')+':'+_0x41c98e[_0x5ea563(0x319)]()[_0x5ea563(0x2ee)]()[_0x5ea563(0x29a)](0x2,'0');}function sleep(_0x479d01){return new Promise(_0xf743d1=>setTimeout(_0xf743d1,_0x479d01));}