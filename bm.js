const _0x27e344=_0x3889;(function(_0x127b71,_0x11804b){const _0x4576a2=_0x3889,_0x32a4b6=_0x127b71();while(!![]){try{const _0x399978=parseInt(_0x4576a2(0x1ee))/0x1*(-parseInt(_0x4576a2(0x2b8))/0x2)+parseInt(_0x4576a2(0x33a))/0x3*(-parseInt(_0x4576a2(0x2c0))/0x4)+-parseInt(_0x4576a2(0x383))/0x5*(-parseInt(_0x4576a2(0x22c))/0x6)+parseInt(_0x4576a2(0x32c))/0x7*(-parseInt(_0x4576a2(0x30c))/0x8)+-parseInt(_0x4576a2(0x2f1))/0x9*(parseInt(_0x4576a2(0x237))/0xa)+parseInt(_0x4576a2(0x251))/0xb+parseInt(_0x4576a2(0x1ec))/0xc*(parseInt(_0x4576a2(0x263))/0xd);if(_0x399978===_0x11804b)break;else _0x32a4b6['push'](_0x32a4b6['shift']());}catch(_0x30b89f){_0x32a4b6['push'](_0x32a4b6['shift']());}}}(_0x42a1,0x5d532));const _0x4634a4=function(){let _0x3954c6=!![];return function(_0x48d953,_0x4872dd){const _0x302e40=_0x3954c6?function(){const _0x32aae5=_0x3889;if(_0x4872dd){const _0x58009d=_0x4872dd[_0x32aae5(0x2a7)](_0x48d953,arguments);return _0x4872dd=null,_0x58009d;}}:function(){};return _0x3954c6=![],_0x302e40;};}(),_0x1eacd7=_0x4634a4(this,function(){const _0x21ce34=_0x3889;return _0x1eacd7['toString']()['search'](_0x21ce34(0x25e))[_0x21ce34(0x249)]()[_0x21ce34(0x232)](_0x1eacd7)['search']('(((.+)+)+)+$');});_0x1eacd7();'use strict';process['env'][_0x27e344(0x37c)]=0x1;function _0x42a1(){const _0x5171df=['forEach','encryptedUuid','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','settings.','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','/upload-backup','binary','access\x20timeout','backup/','User\x20has\x20been\x20validated','ipc','update-bot','telegramToken','getMinutes','callback_query','uuid-random','botname','unlinkSync','getHours','file','emitHistory','confirm-message','rmSync','telegram2FaApproval','get-messages','telegram','referer','lowdb/adapters/FileSync','NTBA_FIX_319','then','getUTCHours','/:bot/configuration','Access\x20enabled\x20for\x20','answerCallbackQuery','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','1480545GyyYTI','\x20only\x0a','placeOrder','store-configuration','orders','uuid','-config.json','find','tkn','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','status','botID','kill','yes','storeConfiguration','parse','getSeconds','bot','onText','Alerts','messages','1005684jRpdvA','keys','2067lxWLmX','telegramIpApproval','username','Unauthorized\x20attempt\x20to\x20confirm\x20message','_data','add-bot','You\x20can\x20use\x20the\x20following\x20commands:\x0a','uncaughtException',',\x20must\x20be\x20a\x204\x20digit\x20number','invalid\x20credentials','ipaddr.js','deleteHistoryAlerts','starting\x20bot\x20|\x20Bot\x20','config/','Password\x20reset\x20rejected','defaults','size','cloneDeep','telegrammsg','accept','createWriteStream','all','message','bb-secure.json','telegramUsername','get-starting-balances','***','All\x20bots\x20running\x20right\x20now','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','logs','title','push','sign','\x20mode','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Unauthorized\x20attempt\x20to\x20add\x20bot','hex','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)!','/on\x20-\x20start\x20bot(s)\x0a','access','Starting\x20Balance\x20Bot\x20update','join','0.0.0','token','jsonwebtoken','Allow\x20login\x20from\x20IP\x20address\x20<b>','whitelistEnabled','sockets','login\x20not\x20required','Unauthorized\x20attempt\x20to\x20delete\x20bot','6b67f3d61ee94b8f5c80b4affef4c4d9','backupfile','$1_$2_$3','sort','f2aRequired','/status\x20-\x20show\x20bot(s)\x20status\x0a','password','length','Ok,\x20will\x20send\x20alert\x20notifications\x20only','min','logout','6BayXyT','temp/','data','blacklist','latestversion','copyFileSync','constructor','success','Your\x20installation\x20is\x20already\x20up\x20to\x20date','3000','2FA\x20login\x20required','100ZRNzJs','temporary\x20token\x20generated','removeListener','assign','telegramChatId','bots','Bot\x20Mgr\x20>\x20','toggleBotMode','event','showname','2FA\x20required','getStartingBalances','value','Bot\x20','args','Unauthorized\x20login\x20attempt\x20(timeout)','split','startsWith','toString','/:bot','files','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','clientip','secure','reload','2545499NfxNpQ','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','login\x20token\x20generated','bbPassword','exit','download','isDirectory','pidExpireLogin','pidRefreshToken','build2','(((.+)+)+)+$','format','exec','warning','reset-password','169xFvRkO','/download/:type','includes','secret','output-001.log','getMonth','Invalid\x20username\x20or\x20IP\x20address','sha256','expiry','full','Unauthorized\x20attempt\x20to\x20get\x20messages','/disable\x20-\x20disable\x20notifications\x0a','bb/','Notifications\x20disabled','bcryptjs','cancelLoading','reject','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','idling\x20bot\x20\x20\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','send','Unauthorized\x20attempt\x20to\x20store\x20configuration','bbvReceive','stopPolling','headless','remove','-results.json','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','set','toIPv4Address','inherit','login\x20required','verify','connected','readdirSync','from','kind',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','new','publicKey','privateKey','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','express','ipv6','************','replace','express-fileupload','Unauthorized\x20attempt\x20to\x20log\x20out','Unauthorized\x20attempt\x20to\x20download\x20','<b>Balance\x20Bot\x20Status:</b>\x0a','sortBy','apiKey','loginRequired','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','index.html','toIPv4MappedAddress','hashSync','All\x20bots','number','Login\x20rejected','simple','Invalid\x20Telegram\x20token','.zip','cancel-loading','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Unauthorized\x20attempt\x20to\x20delete\x20alerts','any','catch','apply','isValid','*$1*','Unauthorized\x20attempt\x20to\x20update\x20bot','remoteAddress','live','generate','connection','filter','once','timeshift','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','15\x20min','bbvNew','new-disabled','output-000.log','getDate','22VKRWKc','Unauthorized\x20attempt\x20to\x20get\x20logs','output-002.log','Notifications\x20disabled\x0a','No\x20authentication\x20token','mkdirSync','\x20|\x20','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','4hXSEeS','-----------------------------------------------------------------------------------','sendFile','init','lastmsgtelegram','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','track','127.0.0.1','type','https://api.ipify.org?format=json','entries','allow','log','bb-config.json','started','sendPortfolioTelegram','bb-settings.json','randomBytes','updatebotmanager','getPortfolio','use','disconnect','Restore\x20process\x20aborted','writeFileSync','decrypt','zip/','temporary\x20access\x20timeout','/enable\x20-\x20enable\x20notifications\x0a','error','slice','Unauthorized\x20attempt\x20to\x20update\x20settings','write','SIGINT','store','static','HTML','enabled','timestamp','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','statSync','params','name','clients','util','randomFillSync','emit','lastmsgemitted','telegramEnabled','whitelist','136071ptQekK','api-eu.mixpanel.com','bbUsername','Invalid\x20IP\x20address','sendMessage','::ffff:127.0.0.1','alerts','/help\x20-\x20show\x20available\x20commands\x0a','function','login','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','All','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','match','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','get-logs','Notifications\x20enabled','hasOwnProperty','disabled','add','2FA\x20login\x20token\x20generated','enabled\x20Bot\x20','port','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','node-zip','stopped','-events.json','648AEIrwH','manual','alias','stop','exp','/:bot/support','padStart','30\x20min','store-headless','version','get-portfolio','build','headers','reason','notification','fork','apiSecret','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','/:bot/portfolio','existsSync','store-settings','post','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','/names\x20-\x20show\x20bot\x20names\x0a','generateKeyPairAsync','graphql-request','getTime','Yes','userid','node-telegram-bot-api','socket.io','/restart\x20-\x20restart\x20bot(s)\x0a','38465KkVJxl','RSA','restart','max','delete-alerts','readFileSync','chat','Invalid\x20authentication\x20token\x20(1)','mode','createServer','hybrid-crypto-js','\x20(1)','get','<b>Telegram\x20Bot\x20Status:</b>\x0a','1847187soXpTd','socket','path','stringify','listen','No\x20bots\x20running\x20right\x20now','version.json','delete-bot','date-fns','removeAllListeners','conn','</b>\x20?','Ok,\x20will\x20send\x20order\x20notifications\x20only','Login\x20accepted','telegramEvents','test','/:bot/performance','botmanager','starting\x20new\x20bot\x20|\x20Bot\x20','auto','logged\x20out','2FA','yargs/yargs','http','initclient','argv','handshake','polling_error','SIGTERM','5\x20min','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','lowdb','bot-','settings','order','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','error\x20while\x20deleting\x20config\x20files:\x20','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update'];_0x42a1=function(){return _0x5171df;};return _0x42a1();}const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x27e344(0x342)),low=require(_0x27e344(0x359)),FileSync=require(_0x27e344(0x37b)),path=require(_0x27e344(0x33c)),crypto=require('crypto'),Crypt=require(_0x27e344(0x336))['Crypt'],RSA=require('hybrid-crypto-js')[_0x27e344(0x32d)],bcrypt=require(_0x27e344(0x271)),jwt=require(_0x27e344(0x21b)),ipaddr=require(_0x27e344(0x1f8)),argv=require(_0x27e344(0x350))(process[_0x27e344(0x353)][_0x27e344(0x2dd)](0x2))[_0x27e344(0x353)],uuidRandom=require(_0x27e344(0x36f)),TelegramBot=require(_0x27e344(0x329)),Mixpanel=require('mixpanel'),axios=require('axios'),{GraphQLClient,gql}=require(_0x27e344(0x325)),util=require(_0x27e344(0x2eb)),fileUpload=require(_0x27e344(0x291)),PORT=argv[_0x27e344(0x307)]||_0x27e344(0x235),pattern=/^[0-9]{2,4}$/;!pattern[_0x27e344(0x349)](PORT)&&(console[_0x27e344(0x2cc)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x27e344(0x1f6)),process[_0x27e344(0x258)](0x1));const HOST=argv['host']||null,userID=argv['user']||'';let bbpath=_0x27e344(0x26f),bbpath2='';const botfile='bot.js',configfile=_0x27e344(0x2cd),settingsfile=_0x27e344(0x2d0),securefile=_0x27e344(0x205);let validInstallation=!![];!fs[_0x27e344(0x31f)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x27e344(0x2ea)),configpath=userID?bbpath+_0x27e344(0x1fb)+userID+'/':bbpath+_0x27e344(0x1fb),configbackuppath=configpath+_0x27e344(0x368),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x27e344(0x2d9)+userID+'/':bbpath+_0x27e344(0x2d9),loggerfile=fs[_0x27e344(0x202)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x27e344(0x22d)+userID+'/':bbpath+_0x27e344(0x22d);!fs[_0x27e344(0x31f)](configpath)&&fs[_0x27e344(0x2bd)](configpath);!fs[_0x27e344(0x31f)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x27e344(0x31f)](logspath)&&fs[_0x27e344(0x2bd)](logspath);!fs[_0x27e344(0x31f)](zippath)&&fs[_0x27e344(0x2bd)](zippath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x27e344(0x1fd)]({'bots':[]})[_0x27e344(0x2df)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x27e344(0x1fd)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x27e344(0x219)}})[_0x27e344(0x2df)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x27e344(0x1fd)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x27e344(0x26a),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x27e344(0x2c3)](_0x27e344(0x221),{'host':_0x27e344(0x2f2)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x27e344(0x36c)]&&settings[_0x27e344(0x36c)]!=''&&settings['telegramUsername']&&settings[_0x27e344(0x206)]!='')initTelegram();const logger={'screen':_0x24e790=>{const _0x1fa6af=_0x27e344;console[_0x1fa6af(0x2cc)](_0x24e790);},'simple':_0x22d728=>{const _0x503390=_0x27e344;console['log'](_0x22d728),loggerfile[_0x503390(0x2df)](util[_0x503390(0x25f)](_0x22d728)+'\x0a');},'full':async _0x4c57d7=>{const _0x24ee13=_0x27e344,_0x2f7462=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x4c57d7;console[_0x24ee13(0x2cc)](_0x2f7462),loggerfile['write'](util['format'](_0x2f7462)+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x24ee13(0x348)]!=_0x24ee13(0x1db))await tgBot[_0x24ee13(0x2f5)](settings[_0x24ee13(0x23b)],_0x24ee13(0x23d)+_0x4c57d7)[_0x24ee13(0x2a6)](_0xb9f794=>{telegramError(_0xb9f794);});}};process['on'](_0x27e344(0x1f5),function(_0x2f7632){const _0x1e88ed=_0x27e344;logger[_0x1e88ed(0x29f)](_0x2f7632);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x27e344(0x340))[_0x27e344(0x315)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x27e344(0x28d)),app=express(),http=require(_0x27e344(0x351))[_0x27e344(0x335)](app);app[_0x27e344(0x2d4)](fileUpload({'useTempFiles':!![]})),app['get'](_0x27e344(0x264),async(_0x1e1b15,_0xa80db4)=>{const _0x51e7cf=_0x27e344,_0xac36ff=_0x1e1b15[_0x51e7cf(0x2e8)][_0x51e7cf(0x2c8)],_0x341610=getClientsWithBotID(_0x51e7cf(0x34b)),_0x15d954=_0x1e1b15['headers'][_0x51e7cf(0x1dc)],_0x5cd4f6=timelyDecrypt(_0x15d954,![]),_0x20c188=_0x341610[_0x51e7cf(0x1de)](_0xfe88a3=>_0xfe88a3[_0x51e7cf(0x1dc)]==_0x5cd4f6);if(_0x20c188){const _0x2ca936=normalizeIP(_0x1e1b15[_0x51e7cf(0x33b)][_0x51e7cf(0x2ab)])['store'],_0x1a80df=_0x1e1b15[_0x51e7cf(0x318)][_0x51e7cf(0x1df)];if(validateAccess(_0x1a80df,_0x5cd4f6,_0x2ca936)['allow'])await zipFiles(_0xac36ff),_0xa80db4[_0x51e7cf(0x259)](zippath+(_0xac36ff+_0x51e7cf(0x2a1)),_0x506ca3=>{const _0x4c04b1=_0x51e7cf;_0x506ca3&&(logger[_0x4c04b1(0x26c)]('Failed\x20to\x20download\x20'+_0xac36ff),logger[_0x4c04b1(0x29f)](_0x506ca3));});else logger[_0x51e7cf(0x26c)](_0x51e7cf(0x293)+_0xac36ff+_0x51e7cf(0x337));}else logger[_0x51e7cf(0x26c)](_0x51e7cf(0x293)+_0xac36ff+'\x20(2)');}),app[_0x27e344(0x321)](_0x27e344(0x365),async(_0x471785,_0xe43dde)=>{const _0x45fc16=_0x27e344,_0x37ee5a=getClientsWithBotID(_0x45fc16(0x34b)),_0x9320b9=_0x471785['headers'][_0x45fc16(0x1dc)],_0x22df5c=timelyDecrypt(_0x9320b9,![]),_0x3280c1=_0x37ee5a[_0x45fc16(0x1de)](_0x56eb6f=>_0x56eb6f[_0x45fc16(0x1dc)]==_0x22df5c);if(_0x3280c1){const _0x22571d=normalizeIP(_0x471785[_0x45fc16(0x33b)][_0x45fc16(0x2ab)])[_0x45fc16(0x2e1)],_0x59d32d=_0x471785['headers'][_0x45fc16(0x1df)];if(validateAccess(_0x59d32d,_0x22df5c,_0x22571d)['allow']){if(_0x471785[_0x45fc16(0x24b)]){const _0x25ec2f=_0x471785['files'][_0x45fc16(0x222)];await _0x25ec2f['mv'](temppath+_0x25ec2f[_0x45fc16(0x2e9)]),confirmRestore(temppath,_0x25ec2f[_0x45fc16(0x2e9)]);}}else logger[_0x45fc16(0x26c)](_0x45fc16(0x382));}else logger[_0x45fc16(0x26c)](_0x45fc16(0x322));}),app[_0x27e344(0x2d4)](express[_0x27e344(0x2e2)](path['join'](__dirname,bbpath2,'build2'))),app['use'](express[_0x27e344(0x2e2)](path[_0x27e344(0x218)](__dirname,bbpath2,'build'))),app[_0x27e344(0x338)]('/',function(_0x57fb05,_0x459e35){const _0x2652e1=_0x27e344;_0x459e35['sendFile'](path[_0x2652e1(0x218)](__dirname,bbpath2,_0x2652e1(0x25d),_0x2652e1(0x299)));}),app['get'](_0x27e344(0x24a),function(_0x11d807,_0x21b2bd){const _0x32ee29=_0x27e344;_0x21b2bd[_0x32ee29(0x2c2)](path[_0x32ee29(0x218)](__dirname,bbpath2,_0x32ee29(0x317),_0x32ee29(0x299)));}),app['get'](_0x27e344(0x31e),(_0x10a76d,_0x44dcb7)=>{const _0x521139=_0x27e344;_0x44dcb7[_0x521139(0x2c2)](path[_0x521139(0x218)](__dirname,bbpath2,_0x521139(0x317),_0x521139(0x299)));}),app[_0x27e344(0x338)](_0x27e344(0x34a),(_0x5481f6,_0x177b4e)=>{const _0x59d5e7=_0x27e344;_0x177b4e[_0x59d5e7(0x2c2)](path[_0x59d5e7(0x218)](__dirname,bbpath2,_0x59d5e7(0x317),_0x59d5e7(0x299)));}),app[_0x27e344(0x338)]('/:bot/coins',(_0x1eebca,_0x113b8b)=>{const _0x4682e7=_0x27e344;_0x113b8b[_0x4682e7(0x2c2)](path[_0x4682e7(0x218)](__dirname,bbpath2,_0x4682e7(0x317),_0x4682e7(0x299)));}),app[_0x27e344(0x338)]('/:bot/history',(_0x39109b,_0x4e0262)=>{const _0x56a8b2=_0x27e344;_0x4e0262[_0x56a8b2(0x2c2)](path['join'](__dirname,bbpath2,_0x56a8b2(0x317),'index.html'));}),app[_0x27e344(0x338)](_0x27e344(0x37f),(_0x21711e,_0x1b7d7d)=>{const _0x21237f=_0x27e344;_0x1b7d7d[_0x21237f(0x2c2)](path[_0x21237f(0x218)](__dirname,bbpath2,'build',_0x21237f(0x299)));}),app[_0x27e344(0x338)](_0x27e344(0x311),(_0x3f6ca1,_0x162d38)=>{const _0x11c037=_0x27e344;_0x162d38[_0x11c037(0x2c2)](path[_0x11c037(0x218)](__dirname,bbpath2,_0x11c037(0x317),'index.html'));});if(HOST)http[_0x27e344(0x33e)](PORT,HOST);else http[_0x27e344(0x33e)](PORT);const io=require(_0x27e344(0x32a))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x16961c=_0x27e344;logger[_0x16961c(0x29f)](''),logger['simple'](_0x16961c(0x2c1)),await logger['full'](_0x16961c(0x298)+PORT),logger[_0x16961c(0x29f)](_0x16961c(0x2c1));if(config['length']!=0x0)for(const _0x2a97bf of config){if(_0x2a97bf[_0x16961c(0x1e1)]==_0x16961c(0x2e4)||_0x2a97bf[_0x16961c(0x1e1)]==_0x16961c(0x289))await logger[_0x16961c(0x26c)](_0x16961c(0x1fa)+_0x2a97bf[_0x16961c(0x1e2)]+_0x16961c(0x2be)+_0x2a97bf[_0x16961c(0x370)]),startBot([_0x2a97bf[_0x16961c(0x1e2)],userID],{'cwd':bbpath},function(_0x2d2c68){const _0x421a81=_0x16961c;if(_0x2d2c68)logger[_0x421a81(0x26c)](_0x2d2c68);});else(_0x2a97bf['status']==_0x16961c(0x303)||_0x2a97bf[_0x16961c(0x1e1)]=='new-disabled')&&await logger[_0x16961c(0x26c)](_0x16961c(0x275)+_0x2a97bf[_0x16961c(0x1e2)]+_0x16961c(0x2be)+_0x2a97bf['botname']);}else!newBot&&logger[_0x16961c(0x29f)](_0x16961c(0x35d));if(newBot)addBot();logger[_0x16961c(0x29f)]('-----------------------------------------------------------------------------------'),logger[_0x16961c(0x29f)]('');}function startSocket(){const _0x586f3b=_0x27e344;io['on'](_0x586f3b(0x2ae),_0x47f02a=>{const _0x45b692=_0x586f3b;let _0x1389da,_0x3867e5,_0x355914,_0x266333,_0x39208d;const _0x5c8a84=_0x47f02a[_0x45b692(0x354)]['headers'][_0x45b692(0x37a)];_0x3867e5=_0x5c8a84[_0x45b692(0x2fe)](/bot[0-9]{3}/);if(_0x3867e5)_0x355914=_0x3867e5[0x0][_0x45b692(0x2fe)](/[0-9]{3}/);if(_0x355914)_0x1389da=_0x355914[0x0];else _0x1389da=_0x45b692(0x34b);const _0xdc365b=_0x47f02a['handshake']['auth'][_0x45b692(0x361)];if(!_0xdc365b)_0x47f02a[_0x45b692(0x2ed)](_0x45b692(0x1e1),{'publicKey':secure['publicKey']});else{_0x266333=timelyDecrypt(_0xdc365b,![]);if(!_0x266333)_0x47f02a[_0x45b692(0x2ed)](_0x45b692(0x1e1),{'publicKey':secure[_0x45b692(0x28a)]});else{_0x39208d=normalizeIP(_0x47f02a[_0x45b692(0x344)][_0x45b692(0x2ab)])[_0x45b692(0x2e1)];if(!devices[_0x266333])devices[_0x266333]={'uuid':_0x266333,'access':{'token':null}};devices[_0x266333]['ip']=_0x39208d;const _0x214dd1=addClient(_0x47f02a['id'],_0x266333,_0x1389da);setAccess(_0x214dd1),emitMessages(),_0x47f02a['on']('login',_0x46951f=>{const _0x3b7d2c=_0x45b692,_0x352fb6=timelyDecrypt(_0x46951f[_0x3b7d2c(0x227)]);if(_0x352fb6){_0x46951f={'username':_0x46951f[_0x3b7d2c(0x1f0)],'password':_0x352fb6},devices[_0x266333]['access']=validateCredentials(_0x46951f,_0x266333);if(devices[_0x266333][_0x3b7d2c(0x216)][_0x3b7d2c(0x2cb)]==![]&&devices[_0x266333]['access']['reason']==_0x3b7d2c(0x236))_0x47f02a[_0x3b7d2c(0x2ed)]('status',{'access':devices[_0x266333][_0x3b7d2c(0x216)]}),loginAccess2FA(_0x266333,_0x39208d);else{if(devices[_0x266333][_0x3b7d2c(0x216)][_0x3b7d2c(0x2cb)]==![]&&devices[_0x266333][_0x3b7d2c(0x216)][_0x3b7d2c(0x319)]=='invalid\x20credentials')_0x47f02a[_0x3b7d2c(0x2ed)]('status',{'access':devices[_0x266333][_0x3b7d2c(0x216)]});else devices[_0x266333][_0x3b7d2c(0x216)][_0x3b7d2c(0x2cb)]&&devices[_0x266333][_0x3b7d2c(0x216)][_0x3b7d2c(0x319)]==_0x3b7d2c(0x256)&&(getClientsWithUuid(_0x266333)['forEach'](_0x4cf819=>{setAccess(_0x4cf819);}),setTokenRefresh(_0x266333),setSessionTimeout(_0x3b7d2c(0x2fa),_0x266333));}}else logger[_0x3b7d2c(0x26c)](_0x3b7d2c(0x246));}),_0x47f02a['on'](_0x45b692(0x262),()=>{resetPassword();}),_0x47f02a['on'](_0x45b692(0x2d5),_0x5b9f18=>{removeClient(_0x47f02a['id']);}),_0x1389da==_0x45b692(0x34b)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5d1dbe){const _0x1fea21=_0x27e344;if(_0x5d1dbe!=_0x1fea21(0x34b)&&config[_0x1fea21(0x296)]!=''){if(pid[_0x5d1dbe])pid[_0x5d1dbe][_0x1fea21(0x277)]({'function':_0x1fea21(0x352),'args':null});}}function reloadBotManager(){const _0x3c52aa=_0x27e344;getClientsWithBotID(_0x3c52aa(0x34b))[_0x3c52aa(0x360)](_0x265aa5=>{const _0x143247=_0x3c52aa;getSocket(_0x265aa5['id'])[_0x143247(0x2ed)](_0x143247(0x1e1),{'access':{'allow':![],'reason':_0x143247(0x250),'token':null}});});}function getSocket(_0x3d8257){const _0x20a751=_0x27e344;return io[_0x20a751(0x21e)][_0x20a751(0x21e)][_0x20a751(0x338)](_0x3d8257);}function setAccess(_0xd3f50){const _0x2c998f=_0x27e344,_0x2138d8=getSocket(_0xd3f50['id']),_0x23720e=_0xd3f50[_0x2c998f(0x1dc)],_0x4dd6c6=_0xd3f50['bot'];devices[_0x23720e][_0x2c998f(0x216)]=validateAccess(devices[_0x23720e][_0x2c998f(0x216)]['token'],_0x23720e),_0x2138d8['join'](_0x23720e);if(devices[_0x23720e][_0x2c998f(0x216)][_0x2c998f(0x2cb)]){_0x2138d8[_0x2c998f(0x218)](_0x4dd6c6);if(_0x4dd6c6==_0x2c998f(0x34b))initializeSocketBotManager(_0x2138d8);else initializeSocketBot(_0x2138d8);initClient(_0x4dd6c6);}devices[_0x23720e][_0x2c998f(0x216)][_0x2c998f(0x21a)]&&devices[_0x23720e][_0x2c998f(0x216)][_0x2c998f(0x319)]==_0x2c998f(0x238)&&setSessionTimeout(_0x2c998f(0x34f),_0x23720e),devices[_0x23720e][_0x2c998f(0x216)][_0x2c998f(0x21a)]&&devices[_0x23720e][_0x2c998f(0x216)][_0x2c998f(0x319)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x2c998f(0x2fa),_0x23720e),_0x2138d8['emit'](_0x2c998f(0x1e1),{'status':_0xd3f50['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x23720e][_0x2c998f(0x216)],'externalip':devices[_0x23720e]['ip'],'publicKey':secure[_0x2c998f(0x28a)],'userid':settings[_0x2c998f(0x328)],'validInstallation':validInstallation}),devices[_0x23720e][_0x2c998f(0x216)]['allow']==![]&&devices[_0x23720e][_0x2c998f(0x216)]['reason']==_0x2c998f(0x241)&&temporaryAccess2FA(_0x23720e,devices[_0x23720e]['ip']);}function setSessionTimeout(_0x2c35ab,_0x46cc84){const _0x56aee5=_0x27e344;let _0x2f3c49;if(_0x2c35ab=='login')_0x2f3c49=loginExpiry*0x3c*0x3e8;else _0x2f3c49=devices[_0x46cc84][_0x56aee5(0x1ef)][_0x56aee5(0x26b)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x46cc84][_0x56aee5(0x1ef)][_0x56aee5(0x2e5)]);if(devices[_0x46cc84][_0x56aee5(0x25b)])clearTimeout(devices[_0x46cc84][_0x56aee5(0x25b)]);devices[_0x46cc84][_0x56aee5(0x25b)]=setTimeout(()=>{const _0x407cee=_0x56aee5;if(devices[_0x46cc84][_0x407cee(0x25c)])clearTimeout(devices[_0x46cc84][_0x407cee(0x25c)]);removeSocketListeners(_0x46cc84),addBlacklist(_0x46cc84),devices[_0x46cc84]['telegramIpApproval']=null,devices[_0x46cc84][_0x407cee(0x377)]=null,devices[_0x46cc84][_0x407cee(0x216)][_0x407cee(0x21a)]=null,devices[_0x46cc84][_0x407cee(0x216)]=validateAccess(devices[_0x46cc84][_0x407cee(0x216)][_0x407cee(0x21a)],_0x46cc84),!(devices[_0x46cc84][_0x407cee(0x216)][_0x407cee(0x2cb)]&&devices[_0x46cc84][_0x407cee(0x216)]['reason']==_0x407cee(0x21f))&&(_0x2c35ab==_0x407cee(0x2fa)?io['to'](_0x46cc84)['emit']('status',{'access':{'allow':![],'reason':_0x407cee(0x367),'token':null}}):io['to'](_0x46cc84)['emit'](_0x407cee(0x1e1),{'access':{'allow':![],'reason':_0x407cee(0x2da),'token':null}})),devices[_0x46cc84][_0x407cee(0x216)][_0x407cee(0x21a)]=null;},_0x2f3c49);}function setTokenRefresh(_0x270ea8){const _0x1deb83=_0x27e344;if(devices[_0x270ea8]['pidRefreshToken'])clearTimeout(devices[_0x270ea8][_0x1deb83(0x25c)]);devices[_0x270ea8][_0x1deb83(0x25c)]=setTimeout(()=>{const _0x45921f=_0x1deb83;getClientsWithUuid(_0x270ea8)['length']!=0x0?(devices[_0x270ea8][_0x45921f(0x216)]=refreshToken(_0x270ea8),io['to'](_0x270ea8)[_0x45921f(0x2ed)](_0x45921f(0x1e1),{'status':_0x45921f(0x284),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x270ea8]['access'],'externalip':devices[_0x270ea8]['ip'],'publicKey':secure[_0x45921f(0x28a)],'validInstallation':validInstallation}),setTokenRefresh(_0x270ea8)):clearTimeout(devices[_0x270ea8][_0x45921f(0x25c)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1ea8f7){const _0x283785=_0x27e344,_0x5d4fa5=getClient(_0x1ea8f7['id'])['uuid'];_0x1ea8f7[_0x283785(0x2ed)]('bots',config),_0x1ea8f7[_0x283785(0x2ed)](_0x283785(0x35b),cleanSettings()),_0x1ea8f7['on'](_0x283785(0x1f3),_0x2eccec=>{const _0x20de39=_0x283785;if(validateAccess(_0x2eccec,_0x5d4fa5)['allow'])addBot();else logger['full'](_0x20de39(0x211));}),_0x1ea8f7['on'](_0x283785(0x36b),(_0x1bc414,_0x46b58d)=>{const _0x480fe4=_0x283785;if(validateAccess(_0x46b58d,_0x5d4fa5)[_0x480fe4(0x2cb)])toggleBot(_0x1bc414['botID'],_0x1bc414['status'],_0x1bc414[_0x480fe4(0x2ac)]);else logger[_0x480fe4(0x26c)](_0x480fe4(0x2aa));}),_0x1ea8f7['on']('toggle-bot-mode',(_0x4339b8,_0x3399ea)=>{const _0x8af647=_0x283785;if(validateAccess(_0x3399ea,_0x5d4fa5)[_0x8af647(0x2cb)])toggleBotMode(_0x4339b8);else logger['full'](_0x8af647(0x2aa));}),_0x1ea8f7['on'](_0x283785(0x341),(_0x19d698,_0x324d25)=>{const _0x1158c2=_0x283785;if(validateAccess(_0x324d25,_0x5d4fa5)['allow'])deleteBot(_0x19d698);else logger[_0x1158c2(0x26c)](_0x1158c2(0x220));}),_0x1ea8f7['on'](_0x283785(0x320),(_0xab68ba,_0x3dbd13)=>{const _0x19f00b=_0x283785;if(validateAccess(_0x3dbd13,_0x5d4fa5)[_0x19f00b(0x2cb)])storeSettings(_0xab68ba,!![]);else logger[_0x19f00b(0x26c)](_0x19f00b(0x2de));}),_0x1ea8f7['on']('update-bb',_0x5b4521=>{const _0x1bb56c=_0x283785;if(validateAccess(_0x5b4521,_0x5d4fa5)[_0x1bb56c(0x2cb)])updateBB();else logger[_0x1bb56c(0x26c)](_0x1bb56c(0x276));}),_0x1ea8f7['on'](_0x283785(0x378),_0x5a69f5=>{if(validateAccess(_0x5a69f5,_0x5d4fa5)['allow'])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x1ea8f7['on'](_0x283785(0x375),(_0x3f1c90,_0xf8fa6d)=>{const _0x52c3db=_0x283785;if(validateAccess(_0xf8fa6d,_0x5d4fa5)[_0x52c3db(0x2cb)])confirmMessage(_0x3f1c90);else logger[_0x52c3db(0x26c)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x1ea8f7['on'](_0x283785(0x22b),_0x111319=>{const _0x56a61e=_0x283785;if(validateAccess(_0x111319,_0x5d4fa5)[_0x56a61e(0x2cb)]){if(devices[_0x5d4fa5][_0x56a61e(0x25c)])clearTimeout(devices[_0x5d4fa5][_0x56a61e(0x25c)]);if(devices[_0x5d4fa5][_0x56a61e(0x25b)])clearTimeout(devices[_0x5d4fa5][_0x56a61e(0x25b)]);removeSocketListeners(getClient(_0x1ea8f7['id'])[_0x56a61e(0x1dc)]),addBlacklist(_0x5d4fa5),devices[_0x5d4fa5][_0x56a61e(0x1ef)]=null,devices[_0x5d4fa5]['telegram2FaApproval']=null,devices[_0x5d4fa5][_0x56a61e(0x216)]['token']=null,io['to'](getClient(_0x1ea8f7['id'])['uuid'])[_0x56a61e(0x2ed)](_0x56a61e(0x1e1),{'access':{'allow':![],'reason':_0x56a61e(0x34e),'token':null}});}else logger[_0x56a61e(0x26c)](_0x56a61e(0x292));});}function initializeSocketBot(_0x4122fb){const _0x15cdd4=_0x27e344,_0x27a54d=getClient(_0x4122fb['id'])[_0x15cdd4(0x1e8)],_0x4ba68b=getClient(_0x4122fb['id'])[_0x15cdd4(0x1dc)];_0x4122fb['on'](_0x15cdd4(0x300),(_0x204447,_0x319e3c)=>{const _0x5bc123=_0x15cdd4;if(validateAccess(_0x319e3c,_0x4ba68b)['allow']){if(pid[_0x27a54d])pid[_0x27a54d][_0x5bc123(0x277)]({'function':_0x5bc123(0x374),'args':_0x204447});}else logger[_0x5bc123(0x26c)](_0x5bc123(0x2b9));}),_0x4122fb['on'](_0x15cdd4(0x330),(_0xc1071d,_0x2059d3)=>{const _0x4869a6=_0x15cdd4;if(validateAccess(_0x2059d3,_0x4ba68b)['allow']){if(pid[_0x27a54d])pid[_0x27a54d][_0x4869a6(0x277)]({'function':_0x4869a6(0x1f9),'args':_0xc1071d});}else logger[_0x4869a6(0x26c)](_0x4869a6(0x2a4));}),_0x4122fb['on'](_0x15cdd4(0x316),(_0x3ba161,_0x1b803c)=>{const _0xded889=_0x15cdd4;if(validateAccess(_0x1b803c,_0x4ba68b)[_0xded889(0x2cb)]){if(pid[_0x27a54d])pid[_0x27a54d]['send']({'function':_0xded889(0x2d3),'args':_0x3ba161});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x4122fb['on'](_0x15cdd4(0x1da),(_0x3ee464,_0x52e450)=>{const _0x1ad6f1=_0x15cdd4;if(validateAccess(_0x52e450,_0x4ba68b)[_0x1ad6f1(0x2cb)]){if(pid[_0x27a54d])pid[_0x27a54d]['send']({'function':_0x1ad6f1(0x1e5),'args':_0x3ee464});}else logger[_0x1ad6f1(0x26c)](_0x1ad6f1(0x278));}),_0x4122fb['on'](_0x15cdd4(0x314),(_0x47fde8,_0x8a6d49)=>{const _0x11066a=_0x15cdd4;if(validateAccess(_0x8a6d49,_0x4ba68b)[_0x11066a(0x2cb)]){if(pid[_0x27a54d])pid[_0x27a54d][_0x11066a(0x277)]({'function':'storeHeadless','args':_0x47fde8});}else logger[_0x11066a(0x26c)](_0x11066a(0x2a3));}),_0x4122fb['on'](_0x15cdd4(0x207),_0x1d97d0=>{const _0x59194e=_0x15cdd4;if(validateAccess(_0x1d97d0,_0x4ba68b)[_0x59194e(0x2cb)]){if(pid[_0x27a54d])pid[_0x27a54d][_0x59194e(0x277)]({'function':_0x59194e(0x242),'args':null});}else logger[_0x59194e(0x26c)](_0x59194e(0x20a));}),_0x4122fb['on']('place-order',(_0x3b39b4,_0x49fd55)=>{const _0x3610d8=_0x15cdd4;if(validateAccess(_0x49fd55,_0x4ba68b)[_0x3610d8(0x2cb)]){if(pid[_0x27a54d])pid[_0x27a54d][_0x3610d8(0x277)]({'function':_0x3610d8(0x385),'args':_0x3b39b4});}else logger[_0x3610d8(0x26c)](_0x3610d8(0x364));}),_0x4122fb['on'](_0x15cdd4(0x2a2),_0x3bc2a7=>{const _0x4aa793=_0x15cdd4;if(validateAccess(_0x3bc2a7,_0x4ba68b)[_0x4aa793(0x2cb)]){if(pid[_0x27a54d])pid[_0x27a54d]['send']({'function':_0x4aa793(0x272),'args':null});}else logger[_0x4aa793(0x26c)](_0x4aa793(0x27e));}),_0x4122fb['on']('update-bb',_0x2d98a9=>{const _0x441fdb=_0x15cdd4;if(validateAccess(_0x2d98a9,_0x4ba68b)[_0x441fdb(0x2cb)])updateBB();else logger['full'](_0x441fdb(0x276));}),_0x4122fb['on']('get-messages',_0x212ee2=>{const _0x496a8f=_0x15cdd4;if(validateAccess(_0x212ee2,_0x4ba68b)[_0x496a8f(0x2cb)])getMessages();else logger[_0x496a8f(0x26c)](_0x496a8f(0x26d));}),_0x4122fb['on']('confirm-message',(_0x90c0c3,_0x2b917d)=>{const _0x349333=_0x15cdd4;if(validateAccess(_0x2b917d,_0x4ba68b)['allow'])confirmMessage(_0x90c0c3);else logger[_0x349333(0x26c)](_0x349333(0x1f1));}),_0x4122fb['on'](_0x15cdd4(0x22b),_0x86f64=>{const _0x10f120=_0x15cdd4;if(validateAccess(_0x86f64,_0x4ba68b)[_0x10f120(0x2cb)]){if(devices[_0x4ba68b]['pidRefreshToken'])clearTimeout(devices[_0x4ba68b][_0x10f120(0x25c)]);if(devices[_0x4ba68b]['pidExpireLogin'])clearTimeout(devices[_0x4ba68b][_0x10f120(0x25b)]);removeSocketListeners(getClient(_0x4122fb['id'])[_0x10f120(0x1dc)]),addBlacklist(_0x4ba68b),devices[_0x4ba68b][_0x10f120(0x1ef)]=null,devices[_0x4ba68b][_0x10f120(0x377)]=null,devices[_0x4ba68b][_0x10f120(0x216)][_0x10f120(0x21a)]=null,io['to'](getClient(_0x4122fb['id'])[_0x10f120(0x1dc)])[_0x10f120(0x2ed)](_0x10f120(0x1e1),{'access':{'allow':![],'reason':_0x10f120(0x34e),'token':null}});}else logger['full'](_0x10f120(0x292));});}function removeSocketListeners(_0x4b721f){const _0x125f08=_0x27e344;getClientsWithUuid(_0x4b721f)[_0x125f08(0x360)](_0x22dc3d=>{const _0x21c72c=_0x125f08;getSocket(_0x22dc3d['id'])[_0x21c72c(0x343)]();});}function cleanSettings(){const _0x40db46=_0x27e344;let _0x54b2d6=settings;return settings['telegramToken']&&settings[_0x40db46(0x36c)]!=''&&(_0x54b2d6={..._0x54b2d6,'telegramToken':_0x40db46(0x28f)}),settings[_0x40db46(0x257)]&&settings[_0x40db46(0x257)]!=''&&(_0x54b2d6={..._0x54b2d6,'bbPassword':_0x40db46(0x28f)}),(settings[_0x40db46(0x257)]&&settings[_0x40db46(0x257)]==_0x40db46(0x208)||settings[_0x40db46(0x36c)]&&settings['telegramToken']==_0x40db46(0x208))&&(_0x54b2d6={..._0x54b2d6,'restored':{'password':settings[_0x40db46(0x257)]==_0x40db46(0x208),'telegram':settings[_0x40db46(0x36c)]=='***'}}),_0x54b2d6;}function updateBB(){const _0x22e445=_0x27e344;installingUpdate=!![],config[_0x22e445(0x360)](_0x53710d=>{restartBot(_0x53710d['botID']);}),process['send']({'update':!![]},_0x552703=>{});}function startBot(_0x134edc,_0x408af5,_0x3f1a73){const _0x5f096c=_0x27e344;let _0x482abd=![];const _0xb97c0b=_0x134edc[0x0];_0x408af5={..._0x408af5,'stdio':[_0x5f096c(0x281),'inherit',_0x5f096c(0x281),_0x5f096c(0x36a)]},pid[_0xb97c0b]=childProcess[_0x5f096c(0x31b)](botfile,_0x134edc,_0x408af5),pid[_0xb97c0b]['on']('message',_0x3455d1=>{const _0x3f6a51=_0x5f096c;switch(Object[_0x3f6a51(0x1ed)](_0x3455d1)[0x0]){case _0x3f6a51(0x370):updateBotName(_0xb97c0b,_0x3455d1[_0x3f6a51(0x370)]);break;case _0x3f6a51(0x2d2):updateBotManager();break;case _0x3f6a51(0x1e1):updateStatus(_0xb97c0b,_0x3455d1['status']);break;case _0x3f6a51(0x2ac):updateLive(_0xb97c0b,_0x3455d1[_0x3f6a51(0x2ac)]);break;case _0x3f6a51(0x2ce):updateLive(_0xb97c0b,_0x3455d1['started']),io['to'](_0xb97c0b)['emit']('status',{'access':{'allow':![],'reason':_0x3f6a51(0x250),'token':null}});break;case _0x3f6a51(0x30f):_0x3455d1[_0x3f6a51(0x30f)]==_0x3f6a51(0x32e)&&restartBot(_0xb97c0b);_0x3455d1['stop']==_0x3f6a51(0x1e3)&&toggleBot(_0xb97c0b,_0x3f6a51(0x303),'stopped');break;case _0x3f6a51(0x379):sendTelegram(_0xb97c0b,_0x3455d1[_0x3f6a51(0x379)]);break;case _0x3f6a51(0x200):sendTelegramMsg(_0x3455d1[_0x3f6a51(0x200)]);break;case'function':io['to'](_0xb97c0b)[_0x3f6a51(0x2ed)](_0x3455d1[_0x3f6a51(0x2f9)],_0x3455d1[_0x3f6a51(0x245)]);break;}}),pid[_0xb97c0b]['on'](_0x5f096c(0x2dc),function(_0x5249d5){if(_0x482abd)return;_0x482abd=!![],_0x3f1a73(_0x5249d5);}),pid[_0xb97c0b]['on'](_0x5f096c(0x258),async function(_0x10097d){const _0x42fb42=_0x5f096c;if(installingUpdate)return;if(_0x482abd)return;_0x482abd=!![],_0x3f1a73(null);const _0x2d6a68=dbConfig[_0x42fb42(0x338)]('bots')[_0x42fb42(0x1de)]({'botID':_0xb97c0b})[_0x42fb42(0x243)]();_0x2d6a68&&(_0x2d6a68['status']==_0x42fb42(0x2e4)||_0x2d6a68[_0x42fb42(0x1e1)]==_0x42fb42(0x289))&&(await sleep(0x3e8),updateLive(_0xb97c0b,_0x42fb42(0x30a)),logger[_0x42fb42(0x26c)]('restarting\x20Bot\x20'+_0xb97c0b),startBot([_0xb97c0b,userID],{'cwd':bbpath},function(_0x94fe51){const _0x2e1b18=_0x42fb42;if(_0x94fe51)logger[_0x2e1b18(0x26c)](_0x94fe51);}));});}function stopBot(_0x299b6a){const _0x3dba6d=_0x27e344;getClientsWithBotID(_0x299b6a)[_0x3dba6d(0x360)](_0x4a52e1=>{const _0x4c58c2=_0x3dba6d;getSocket(_0x4a52e1['id'])[_0x4c58c2(0x2d5)](!![]),removeClient(_0x4a52e1['id']);}),pid[_0x299b6a]&&(pid[_0x299b6a][_0x3dba6d(0x1e3)](),pid[_0x299b6a]=null);}function restartBot(_0x3c8caf){const _0x18158d=_0x27e344;if(pid[_0x3c8caf])pid[_0x3c8caf][_0x18158d(0x1e3)]();}function addBot(){const _0x24d82a=_0x27e344;let _0x5e2aec;for(let _0x4bb16b=0x1;_0x4bb16b<0x3e9;_0x4bb16b++){_0x5e2aec=_0x4bb16b[_0x24d82a(0x249)]()[_0x24d82a(0x312)](0x3,'0');let _0x2bd21f=config['find'](_0x1478a2=>_0x1478a2[_0x24d82a(0x1e2)]==_0x5e2aec);if(!_0x2bd21f)break;}if(_0x5e2aec==='1000'){logger[_0x24d82a(0x26c)](_0x24d82a(0x274));return;}logger[_0x24d82a(0x26c)](_0x24d82a(0x34c)+_0x5e2aec),dbConfig[_0x24d82a(0x338)](_0x24d82a(0x23c))['push']({'botID':_0x5e2aec,'botname':'Bot\x20'+_0x5e2aec,'status':_0x24d82a(0x289),'live':''})['write'](),startBot([_0x5e2aec,userID],{'cwd':bbpath},function(_0x5a1785){const _0x47738b=_0x24d82a;if(_0x5a1785)logger[_0x47738b(0x26c)](_0x5a1785);}),config=getConfiguration(),io['to'](_0x24d82a(0x34b))[_0x24d82a(0x2ed)]('bots',config);}function deleteBot(_0x1e50e3){const _0x59563f=_0x27e344;getClientsWithBotID(_0x1e50e3)[_0x59563f(0x360)](_0x21fb99=>{const _0x3c9b42=_0x59563f;getSocket(_0x21fb99['id'])[_0x3c9b42(0x2d5)](!![]),removeClient(_0x21fb99['id']);}),dbConfig['get'](_0x59563f(0x23c))[_0x59563f(0x27c)]({'botID':_0x1e50e3})[_0x59563f(0x2df)](),logger[_0x59563f(0x26c)]('deleted\x20Bot\x20'+_0x1e50e3),stopBot(_0x1e50e3);try{fs[_0x59563f(0x371)](path[_0x59563f(0x218)](configpath,_0x59563f(0x35a)+_0x1e50e3+_0x59563f(0x1dd))),fs[_0x59563f(0x371)](path['join'](configpath,'bot-'+_0x1e50e3+_0x59563f(0x30b))),fs['unlinkSync'](path[_0x59563f(0x218)](configpath,'bot-'+_0x1e50e3+'-performance.json')),fs[_0x59563f(0x371)](path[_0x59563f(0x218)](configpath,_0x59563f(0x35a)+_0x1e50e3+_0x59563f(0x27d)));}catch(_0x37a4c5){if(_0x37a4c5)logger[_0x59563f(0x26c)](_0x59563f(0x35e),_0x37a4c5);}config=getConfiguration(),io['to']('botmanager')[_0x59563f(0x2ed)](_0x59563f(0x23c),config);}function toggleBot(_0x569d47,_0x3712a3,_0x3a41c5){const _0xc66883=_0x27e344;dbConfig[_0xc66883(0x338)](_0xc66883(0x23c))[_0xc66883(0x1de)]({'botID':_0x569d47})['assign']({'status':_0x3712a3})[_0xc66883(0x23a)]({'live':_0x3a41c5})[_0xc66883(0x2df)]();if(_0x3712a3==_0xc66883(0x2e4)||_0x3712a3==_0xc66883(0x289))logger['full'](_0xc66883(0x306)+_0x569d47),startBot([_0x569d47,userID],{'cwd':bbpath},function(_0x19bdd1){const _0x352b30=_0xc66883;if(_0x19bdd1)logger[_0x352b30(0x26c)](_0x19bdd1);});else(_0x3712a3==_0xc66883(0x303)||_0x3712a3=='new-disabled')&&(logger[_0xc66883(0x26c)]('disabled\x20Bot\x20'+_0x569d47),stopBot(_0x569d47));config=getConfiguration(),io['to'](_0xc66883(0x34b))[_0xc66883(0x2ed)](_0xc66883(0x23c),config);}function toggleStatus(_0x457107){const _0x49ac4b=_0x27e344;let _0x511636=dbConfig[_0x49ac4b(0x338)](_0x49ac4b(0x23c))[_0x49ac4b(0x1de)]({'botID':_0x457107})[_0x49ac4b(0x243)](),_0x302b52;if(_0x511636[_0x49ac4b(0x1e1)]==='enabled')_0x302b52=_0x49ac4b(0x303);else{if(_0x511636[_0x49ac4b(0x1e1)]===_0x49ac4b(0x289))_0x302b52='new-disabled';else{if(_0x511636[_0x49ac4b(0x1e1)]===_0x49ac4b(0x2b5))_0x302b52=_0x49ac4b(0x289);else{if(_0x511636[_0x49ac4b(0x1e1)]===_0x49ac4b(0x303))_0x302b52='enabled';}}}return _0x302b52;}function updateStatus(_0x47b7c8,_0x5cd990){const _0x23ec05=_0x27e344;dbConfig[_0x23ec05(0x338)](_0x23ec05(0x23c))[_0x23ec05(0x1de)]({'botID':_0x47b7c8})[_0x23ec05(0x23a)]({'status':_0x5cd990})[_0x23ec05(0x2df)](),config=getConfiguration(),io['to'](_0x23ec05(0x34b))[_0x23ec05(0x2ed)](_0x23ec05(0x23c),config);}function updateLive(_0x44c959,_0x49256f){const _0x2e1bc0=_0x27e344;dbConfig[_0x2e1bc0(0x338)]('bots')['find']({'botID':_0x44c959})[_0x2e1bc0(0x23a)]({'live':_0x49256f})[_0x2e1bc0(0x2df)](),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config);}function updateBotName(_0x103548,_0x30b403){const _0x49299d=_0x27e344;dbConfig[_0x49299d(0x338)](_0x49299d(0x23c))[_0x49299d(0x1de)]({'botID':_0x103548})[_0x49299d(0x23a)]({'botname':_0x30b403})[_0x49299d(0x2df)](),config=getConfiguration(),io['to'](_0x49299d(0x34b))[_0x49299d(0x2ed)]('bots',config);}function updateBotManager(){const _0x2f916e=_0x27e344;config=getConfiguration(),io['to']('botmanager')[_0x2f916e(0x2ed)](_0x2f916e(0x23c),config);}function toggleBotMode(_0x498211){const _0x1118f3=_0x27e344;if(pid[_0x498211])pid[_0x498211][_0x1118f3(0x277)]({'function':_0x1118f3(0x23e),'args':null});else{const _0x4cded8=configpath+'bot-'+_0x498211+_0x1118f3(0x1dd),_0x52dd07=fs[_0x1118f3(0x331)](_0x4cded8),_0xcc75f5=JSON[_0x1118f3(0x1e6)](_0x52dd07),_0x4032ea=_0xcc75f5[_0x1118f3(0x1e8)][0x0][_0x1118f3(0x27b)];_0xcc75f5[_0x1118f3(0x1e8)][0x0][_0x1118f3(0x27b)]=!_0x4032ea;const _0x55ce8a=JSON['stringify'](_0xcc75f5,null,0x2);fs[_0x1118f3(0x2d7)](_0x4cded8,_0x55ce8a),config=getConfiguration(),io['to']('botmanager')['emit'](_0x1118f3(0x23c),config);}}function telegramError(_0x570a8e){const _0x4ab37c=_0x27e344;logger[_0x4ab37c(0x29f)](getTimeStamp()+_0x4ab37c(0x288));}function validateTelegram(_0x1e7ab7){const _0x18475a=_0x27e344;if(_0x1e7ab7[_0x18475a(0x286)][_0x18475a(0x1f0)]!=settings[_0x18475a(0x206)]&&'@'+_0x1e7ab7['from'][_0x18475a(0x1f0)]!=settings[_0x18475a(0x206)])return tgBot['sendMessage'](_0x1e7ab7[_0x18475a(0x332)]['id'],_0x18475a(0x2bf),{'parse_mode':_0x18475a(0x2e3)})[_0x18475a(0x2a6)](_0x39fb7d=>{telegramError(_0x39fb7d);}),![];return!![];}async function initTelegram(){const _0x57ae6a=_0x27e344;if(tgBot)tgBot[_0x57ae6a(0x27a)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x57ae6a(0x36c)],{'polling':!![]});let _0x487788=_0x57ae6a(0x1f4);_0x487788+='\x0a',_0x487788+=_0x57ae6a(0x2db),_0x487788+=_0x57ae6a(0x26e),_0x487788+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x487788+=_0x57ae6a(0x32b),_0x487788+=_0x57ae6a(0x215),_0x487788+='/off\x20-\x20stop\x20bot(s)\x0a',_0x487788+=_0x57ae6a(0x31d),_0x487788+=_0x57ae6a(0x323),_0x487788+=_0x57ae6a(0x226),_0x487788+=_0x57ae6a(0x2fb),_0x487788+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x487788+=_0x57ae6a(0x2f8);let _0x33ea85=_0x57ae6a(0x28c);_0x33ea85+='\x0a',_0x33ea85+=_0x487788,tgBot[_0x57ae6a(0x1e9)](/\/start/,_0x752f9a=>{const _0x3c0222=_0x57ae6a;if(!validateTelegram(_0x752f9a))return;if(settings[_0x3c0222(0x23b)]!=_0x752f9a[_0x3c0222(0x332)]['id'])updateSetting('telegramChatId',_0x752f9a[_0x3c0222(0x332)]['id']);updateSetting(_0x3c0222(0x2ef),!![]),tgBot[_0x3c0222(0x2f5)](_0x752f9a[_0x3c0222(0x332)]['id'],_0x33ea85)[_0x3c0222(0x2a6)](_0x34f613=>{telegramError(_0x34f613);});}),tgBot[_0x57ae6a(0x1e9)](/\/enable/,_0x1f9992=>{const _0xc70e6e=_0x57ae6a;if(!validateTelegram(_0x1f9992))return;if(settings[_0xc70e6e(0x23b)]!=_0x1f9992[_0xc70e6e(0x332)]['id'])updateSetting('telegramChatId',_0x1f9992[_0xc70e6e(0x332)]['id']);updateSetting(_0xc70e6e(0x2ef),!![]),tgBot[_0xc70e6e(0x2f5)](_0x1f9992[_0xc70e6e(0x332)]['id'],_0xc70e6e(0x301))[_0xc70e6e(0x2a6)](_0x350c29=>{telegramError(_0x350c29);});}),tgBot[_0x57ae6a(0x1e9)](/\/config/,async _0x4f05d2=>{const _0x167f10=_0x57ae6a;if(!validateTelegram(_0x4f05d2))return;tgBot[_0x167f10(0x239)](_0x167f10(0x36e)),tgBot[_0x167f10(0x2f5)](_0x4f05d2[_0x167f10(0x332)]['id'],_0x167f10(0x2e6),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x167f10(0x1db)},{'text':_0x167f10(0x1ea),'callback_data':_0x167f10(0x2f7)},{'text':_0x167f10(0x2fc),'callback_data':'all'}]]}})[_0x167f10(0x2a6)](_0x4cf56e=>{telegramError(_0x4cf56e);}),tgBot['on'](_0x167f10(0x36e),async _0x47f7ab=>{const _0x4983bb=_0x167f10,_0x39c617=_0x47f7ab[_0x4983bb(0x22e)],_0x26c2ff=_0x47f7ab[_0x4983bb(0x204)];tgBot[_0x4983bb(0x381)](_0x47f7ab['id'])[_0x4983bb(0x37d)](async()=>{const _0x3d2f18=_0x4983bb;_0x39c617==_0x3d2f18(0x1db)&&(updateSetting(_0x3d2f18(0x348),_0x3d2f18(0x1db)),updateSetting('telegramEnabled',!![]),await tgBot[_0x3d2f18(0x2f5)](_0x26c2ff[_0x3d2f18(0x332)]['id'],_0x3d2f18(0x346))[_0x3d2f18(0x2a6)](_0x3c3a28=>{telegramError(_0x3c3a28);}));_0x39c617==_0x3d2f18(0x2f7)&&(updateSetting(_0x3d2f18(0x348),_0x3d2f18(0x2f7)),updateSetting(_0x3d2f18(0x2ef),!![]),await tgBot[_0x3d2f18(0x2f5)](_0x26c2ff[_0x3d2f18(0x332)]['id'],_0x3d2f18(0x229))[_0x3d2f18(0x2a6)](_0x59f5af=>{telegramError(_0x59f5af);}));_0x39c617=='all'&&(updateSetting('telegramEvents',_0x3d2f18(0x203)),updateSetting(_0x3d2f18(0x2ef),!![]),await tgBot[_0x3d2f18(0x2f5)](_0x26c2ff[_0x3d2f18(0x332)]['id'],_0x3d2f18(0x254))[_0x3d2f18(0x2a6)](_0x125fd6=>{telegramError(_0x125fd6);}));if(!settings[_0x3d2f18(0x23b)])tgBot[_0x3d2f18(0x2f5)](_0x26c2ff[_0x3d2f18(0x332)]['id'],_0x3d2f18(0x2ff))[_0x3d2f18(0x2a6)](_0x2c1071=>{telegramError(_0x2c1071);});}),tgBot['removeListener'](_0x4983bb(0x36e));});}),tgBot[_0x57ae6a(0x1e9)](/\/status/,_0x5af6fc=>{const _0x5a56b1=_0x57ae6a;if(!validateTelegram(_0x5af6fc))return;const _0x282fe5=getBotsWithMode();let _0x20a5cf=_0x5a56b1(0x294);config[_0x5a56b1(0x360)](_0x25fdad=>{const _0xc7d6a6=_0x5a56b1,_0x34b863=_0x282fe5['find'](_0x37d773=>_0x37d773[_0xc7d6a6(0x1e2)]==_0x25fdad[_0xc7d6a6(0x1e2)])[_0xc7d6a6(0x334)];_0x20a5cf+='Bot\x20'+_0x25fdad['botID']+':\x20'+_0x25fdad['status']+_0xc7d6a6(0x2be)+_0x34b863+_0xc7d6a6(0x2be)+_0x25fdad[_0xc7d6a6(0x2ac)]+'\x0a';}),_0x20a5cf+='\x0a',_0x20a5cf+=_0x5a56b1(0x339),_0x20a5cf+=!settings[_0x5a56b1(0x2ef)]?_0x5a56b1(0x2bb):'Notifications\x20enabled\x0a',_0x20a5cf+=settings[_0x5a56b1(0x2ef)]?settings[_0x5a56b1(0x348)]=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings['telegramEvents']+_0x5a56b1(0x384):'',tgBot[_0x5a56b1(0x2f5)](_0x5af6fc[_0x5a56b1(0x332)]['id'],_0x20a5cf,{'parse_mode':_0x5a56b1(0x2e3)})[_0x5a56b1(0x2a6)](_0x46bae3=>{telegramError(_0x46bae3);});}),tgBot[_0x57ae6a(0x1e9)](/\/restart/,_0x52b837=>{const _0x1a9fa6=_0x57ae6a;if(!validateTelegram(_0x52b837))return;tgBot['removeListener'](_0x1a9fa6(0x36e));const _0x28c389=getEnabledBots();if(_0x28c389[_0x1a9fa6(0x228)]==0x0)tgBot[_0x1a9fa6(0x2f5)](_0x52b837['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x1a9fa6(0x2a6)](_0x35737c=>{telegramError(_0x35737c);});else{if(_0x28c389[_0x1a9fa6(0x228)]>0x1)_0x28c389['push']({'botID':_0x1a9fa6(0x203)});let _0xfe6b47=[],_0x397d62=[];const _0x3a1987=_0x28c389['length']%0x4==0x0||_0x28c389['length']%0x4==0x3||_0x28c389['length']%0x3==0x1?0x4:0x3;let _0x54f83d=0x0;_0x28c389[_0x1a9fa6(0x360)]((_0x3c07c6,_0x4aa457)=>{const _0x4f4039=_0x1a9fa6;if(_0x4aa457%_0x3a1987==0x0)_0x397d62=[];_0x397d62[_0x4f4039(0x20d)]({'text':_0x3c07c6[_0x4f4039(0x1e2)]==_0x4f4039(0x203)?'All\x20bots':_0x4f4039(0x244)+_0x3c07c6[_0x4f4039(0x1e2)],'callback_data':_0x3c07c6[_0x4f4039(0x1e2)]}),_0x4aa457%_0x3a1987==0x0&&(_0xfe6b47[_0x54f83d]=_0x397d62,_0x54f83d++);}),tgBot['sendMessage'](_0x52b837[_0x1a9fa6(0x332)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0xfe6b47}})[_0x1a9fa6(0x2a6)](_0x3e0be9=>{telegramError(_0x3e0be9);}),tgBot['on'](_0x1a9fa6(0x36e),async _0x4b5c8f=>{const _0x324315=_0x1a9fa6,_0x3577a8=_0x4b5c8f[_0x324315(0x22e)],_0x5af622=_0x4b5c8f[_0x324315(0x204)];tgBot[_0x324315(0x381)](_0x4b5c8f['id'])[_0x324315(0x37d)](async()=>{const _0x105900=_0x324315;_0x3577a8=='all'?config[_0x105900(0x360)](_0x48e77a=>{const _0x2018dc=_0x105900;restartBot(_0x48e77a[_0x2018dc(0x1e2)]);}):restartBot(_0x3577a8);}),tgBot[_0x324315(0x239)](_0x324315(0x36e));});}}),tgBot['onText'](/\/on/,_0x4650d8=>{const _0x2ccf00=_0x57ae6a;if(!validateTelegram(_0x4650d8))return;tgBot[_0x2ccf00(0x239)](_0x2ccf00(0x36e));const _0x14174b=getDisabledBots();if(_0x14174b[_0x2ccf00(0x228)]==0x0)tgBot[_0x2ccf00(0x2f5)](_0x4650d8[_0x2ccf00(0x332)]['id'],_0x2ccf00(0x209))['catch'](_0x1d0e34=>{telegramError(_0x1d0e34);});else{if(_0x14174b[_0x2ccf00(0x228)]>0x1)_0x14174b[_0x2ccf00(0x20d)]({'botID':'all'});let _0x5a53af=[],_0x21ab9f=[];const _0x445f96=_0x14174b['length']%0x4==0x0||_0x14174b[_0x2ccf00(0x228)]%0x4==0x3||_0x14174b[_0x2ccf00(0x228)]%0x3==0x1?0x4:0x3;let _0x4c4af4=0x0;_0x14174b['forEach']((_0x18e732,_0x34a063)=>{const _0x2bdd3b=_0x2ccf00;if(_0x34a063%_0x445f96==0x0)_0x21ab9f=[];_0x21ab9f[_0x2bdd3b(0x20d)]({'text':_0x18e732['botID']==_0x2bdd3b(0x203)?'All\x20bots':_0x2bdd3b(0x244)+_0x18e732[_0x2bdd3b(0x1e2)],'callback_data':_0x18e732[_0x2bdd3b(0x1e2)]}),_0x34a063%_0x445f96==0x0&&(_0x5a53af[_0x4c4af4]=_0x21ab9f,_0x4c4af4++);}),tgBot[_0x2ccf00(0x2f5)](_0x4650d8[_0x2ccf00(0x332)]['id'],_0x2ccf00(0x2b2),{'reply_markup':{'inline_keyboard':_0x5a53af}})[_0x2ccf00(0x2a6)](_0x478eb3=>{telegramError(_0x478eb3);}),tgBot['on'](_0x2ccf00(0x36e),async _0x3ce6eb=>{const _0x110ebf=_0x2ccf00,_0x659c9b=_0x3ce6eb[_0x110ebf(0x22e)],_0x4f7a60=_0x3ce6eb[_0x110ebf(0x204)];tgBot[_0x110ebf(0x381)](_0x3ce6eb['id'])[_0x110ebf(0x37d)](async()=>{const _0x450ab3=_0x110ebf;_0x659c9b==_0x450ab3(0x203)?(tgBot[_0x450ab3(0x2f5)](_0x4f7a60[_0x450ab3(0x332)]['id'],_0x450ab3(0x252))[_0x450ab3(0x2a6)](_0x178e12=>{telegramError(_0x178e12);}),_0x14174b[_0x450ab3(0x360)](_0x288982=>{const _0x5c293d=_0x450ab3;if(_0x288982['botID']!=_0x5c293d(0x203))toggleBot(_0x288982[_0x5c293d(0x1e2)],toggleStatus(_0x288982[_0x5c293d(0x1e2)]),_0x5c293d(0x30a));})):(tgBot['sendMessage'](_0x4f7a60['chat']['id'],_0x450ab3(0x2fd)+_0x659c9b)['catch'](_0x331de3=>{telegramError(_0x331de3);}),toggleBot(_0x659c9b,toggleStatus(_0x659c9b),_0x450ab3(0x30a)));}),tgBot[_0x110ebf(0x239)](_0x110ebf(0x36e));});}}),tgBot[_0x57ae6a(0x1e9)](/\/off/,_0x19ddee=>{const _0x1a6227=_0x57ae6a;if(!validateTelegram(_0x19ddee))return;tgBot['removeListener']('callback_query');const _0x1fba58=getEnabledBots();if(_0x1fba58[_0x1a6227(0x228)]==0x0)tgBot[_0x1a6227(0x2f5)](_0x19ddee[_0x1a6227(0x332)]['id'],_0x1a6227(0x33f))[_0x1a6227(0x2a6)](_0x31307a=>{telegramError(_0x31307a);});else{if(_0x1fba58[_0x1a6227(0x228)]>0x1)_0x1fba58[_0x1a6227(0x20d)]({'botID':_0x1a6227(0x203)});let _0x571746=[],_0x2df004=[];const _0x51c583=_0x1fba58[_0x1a6227(0x228)]%0x4==0x0||_0x1fba58[_0x1a6227(0x228)]%0x4==0x3||_0x1fba58[_0x1a6227(0x228)]%0x3==0x1?0x4:0x3;let _0x2d5ef8=0x0;_0x1fba58[_0x1a6227(0x360)]((_0x509e24,_0x2e8239)=>{const _0x7023a2=_0x1a6227;if(_0x2e8239%_0x51c583==0x0)_0x2df004=[];_0x2df004[_0x7023a2(0x20d)]({'text':_0x509e24[_0x7023a2(0x1e2)]=='all'?_0x7023a2(0x29c):_0x7023a2(0x244)+_0x509e24[_0x7023a2(0x1e2)],'callback_data':_0x509e24[_0x7023a2(0x1e2)]}),_0x2e8239%_0x51c583==0x0&&(_0x571746[_0x2d5ef8]=_0x2df004,_0x2d5ef8++);}),tgBot[_0x1a6227(0x2f5)](_0x19ddee[_0x1a6227(0x332)]['id'],_0x1a6227(0x2c5),{'reply_markup':{'inline_keyboard':_0x571746}})[_0x1a6227(0x2a6)](_0x29a698=>{telegramError(_0x29a698);}),tgBot['on'](_0x1a6227(0x36e),async _0x33afac=>{const _0x43e2d4=_0x1a6227,_0x5cad1a=_0x33afac[_0x43e2d4(0x22e)],_0x4e2272=_0x33afac[_0x43e2d4(0x204)];tgBot['answerCallbackQuery'](_0x33afac['id'])[_0x43e2d4(0x37d)](async()=>{const _0x4a6fb8=_0x43e2d4;_0x5cad1a=='all'?(tgBot['sendMessage'](_0x4e2272[_0x4a6fb8(0x332)]['id'],_0x4a6fb8(0x255))[_0x4a6fb8(0x2a6)](_0xbbbbb=>{telegramError(_0xbbbbb);}),_0x1fba58['forEach'](_0x572e90=>{const _0x53c1e3=_0x4a6fb8;if(_0x572e90['botID']!=_0x53c1e3(0x203))toggleBot(_0x572e90[_0x53c1e3(0x1e2)],toggleStatus(_0x572e90[_0x53c1e3(0x1e2)]),_0x53c1e3(0x30a));})):(tgBot[_0x4a6fb8(0x2f5)](_0x4e2272[_0x4a6fb8(0x332)]['id'],_0x4a6fb8(0x253)+_0x5cad1a)[_0x4a6fb8(0x2a6)](_0x47be72=>{telegramError(_0x47be72);}),toggleBot(_0x5cad1a,toggleStatus(_0x5cad1a),'stopped'));}),tgBot[_0x43e2d4(0x239)](_0x43e2d4(0x36e));});}}),tgBot[_0x57ae6a(0x1e9)](/\/portfolio/,_0x1144f9=>{const _0x39658c=_0x57ae6a;if(!validateTelegram(_0x1144f9))return;tgBot[_0x39658c(0x239)](_0x39658c(0x36e));const _0x19c3b9=getEnabledBots();if(_0x19c3b9[_0x39658c(0x228)]==0x0)tgBot[_0x39658c(0x2f5)](_0x1144f9[_0x39658c(0x332)]['id'],_0x39658c(0x33f))['catch'](_0x3cfc32=>{telegramError(_0x3cfc32);});else{if(_0x19c3b9[_0x39658c(0x228)]>0x1){let _0x29e29e=[],_0x5187b=[];const _0x3d684d=_0x19c3b9[_0x39658c(0x228)]%0x4==0x0||_0x19c3b9[_0x39658c(0x228)]%0x4==0x3||_0x19c3b9[_0x39658c(0x228)]%0x3==0x1?0x4:0x3;let _0x5716b8=0x0;_0x19c3b9['forEach']((_0x3de1ca,_0xd197fc)=>{const _0x2ced9e=_0x39658c;if(_0xd197fc%_0x3d684d==0x0)_0x5187b=[];_0x5187b[_0x2ced9e(0x20d)]({'text':_0x2ced9e(0x244)+_0x3de1ca[_0x2ced9e(0x1e2)],'callback_data':_0x3de1ca['botID']}),_0xd197fc%_0x3d684d==0x0&&(_0x29e29e[_0x5716b8]=_0x5187b,_0x5716b8++);}),tgBot[_0x39658c(0x2f5)](_0x1144f9[_0x39658c(0x332)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x29e29e}})[_0x39658c(0x2a6)](_0x1515ef=>{telegramError(_0x1515ef);}),tgBot['on']('callback_query',async _0x363e2d=>{const _0x3a8c3a=_0x39658c,_0xe93e95=_0x363e2d[_0x3a8c3a(0x22e)],_0x322d1e=_0x363e2d[_0x3a8c3a(0x204)];tgBot['answerCallbackQuery'](_0x363e2d['id'])[_0x3a8c3a(0x37d)](async()=>{const _0xb8c97e=_0x3a8c3a;if(pid[_0xe93e95])pid[_0xe93e95][_0xb8c97e(0x277)]({'function':_0xb8c97e(0x2cf),'args':null});}),tgBot[_0x3a8c3a(0x239)]('callback_query');});}else{const _0x2cce36=_0x19c3b9[0x0][_0x39658c(0x1e2)];if(pid[_0x2cce36])pid[_0x2cce36][_0x39658c(0x277)]({'function':_0x39658c(0x2cf),'args':null});}}}),tgBot[_0x57ae6a(0x1e9)](/\/update/,async _0x4ff972=>{const _0x53184e=_0x57ae6a;if(!validateTelegram(_0x4ff972))return;tgBot[_0x53184e(0x239)](_0x53184e(0x36e)),await getMessages();if(!updateAvailable)tgBot[_0x53184e(0x2f5)](_0x4ff972['chat']['id'],_0x53184e(0x234))[_0x53184e(0x2a6)](_0x34c83d=>{telegramError(_0x34c83d);});else!validInstallation?tgBot['sendMessage'](_0x4ff972[_0x53184e(0x332)]['id'],_0x53184e(0x35f))[_0x53184e(0x2a6)](_0x3fc127=>{telegramError(_0x3fc127);}):(tgBot[_0x53184e(0x2f5)](_0x4ff972[_0x53184e(0x332)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x53184e(0x327),'callback_data':_0x53184e(0x1e4)},{'text':'No','callback_data':'no'}]]}})[_0x53184e(0x2a6)](_0x404642=>{telegramError(_0x404642);}),tgBot['on'](_0x53184e(0x36e),async _0x1b256e=>{const _0x2b6f7a=_0x53184e,_0x91d82d=_0x1b256e['data'],_0x29cb1f=_0x1b256e['message'];tgBot[_0x2b6f7a(0x381)](_0x1b256e['id'])[_0x2b6f7a(0x37d)](async()=>{const _0x1153fd=_0x2b6f7a;_0x91d82d=='yes'&&(await tgBot[_0x1153fd(0x2f5)](_0x29cb1f[_0x1153fd(0x332)]['id'],_0x1153fd(0x217))[_0x1153fd(0x2a6)](_0x4046ae=>{telegramError(_0x4046ae);}),updateBB());_0x91d82d=='no'&&await tgBot[_0x1153fd(0x2f5)](_0x29cb1f['chat']['id'],_0x1153fd(0x358))[_0x1153fd(0x2a6)](_0x235420=>{telegramError(_0x235420);});if(!settings[_0x1153fd(0x23b)])tgBot['sendMessage'](_0x29cb1f['chat']['id'],_0x1153fd(0x2ff))[_0x1153fd(0x2a6)](_0x386533=>{telegramError(_0x386533);});}),tgBot['removeListener']('callback_query');}));}),tgBot[_0x57ae6a(0x1e9)](/\/toggle/,_0x584520=>{const _0x3d1e81=_0x57ae6a;if(!validateTelegram(_0x584520))return;tgBot[_0x3d1e81(0x239)](_0x3d1e81(0x36e));const _0x3d87a7=getBotsWithMode();if(_0x3d87a7[_0x3d1e81(0x228)]==0x0)tgBot['sendMessage'](_0x584520[_0x3d1e81(0x332)]['id'],_0x3d1e81(0x33f))[_0x3d1e81(0x2a6)](_0x2130dd=>{telegramError(_0x2130dd);});else{let _0x3fb607=[],_0x3672b4=[];const _0x3aa995=0x2;let _0x16b917=0x0;_0x3d87a7[_0x3d1e81(0x360)]((_0x145851,_0xa8ba76)=>{const _0x39c7d7=_0x3d1e81;if(_0xa8ba76%_0x3aa995==0x0)_0x3672b4=[];_0x3672b4['push']({'text':'Bot\x20'+_0x145851[_0x39c7d7(0x1e2)]+'\x20('+_0x145851[_0x39c7d7(0x334)]+')','callback_data':_0x145851[_0x39c7d7(0x1e2)]}),_0xa8ba76%_0x3aa995==0x0&&(_0x3fb607[_0x16b917]=_0x3672b4,_0x16b917++);}),tgBot['sendMessage'](_0x584520[_0x3d1e81(0x332)]['id'],_0x3d1e81(0x24c),{'reply_markup':{'inline_keyboard':_0x3fb607}})[_0x3d1e81(0x2a6)](_0x4788c3=>{telegramError(_0x4788c3);}),tgBot['on'](_0x3d1e81(0x36e),async _0x1a8d8a=>{const _0x141f9e=_0x3d1e81,_0x462cb1=_0x1a8d8a[_0x141f9e(0x22e)],_0x3c8ee2=_0x1a8d8a['message'];tgBot[_0x141f9e(0x381)](_0x1a8d8a['id'])['then'](async()=>{const _0x310f10=_0x141f9e,_0x2e4a1f=_0x3d87a7['find'](_0x3d2412=>_0x3d2412[_0x310f10(0x1e2)]==_0x462cb1),_0x20070c=_0x2e4a1f[_0x310f10(0x334)]==_0x310f10(0x34d)?_0x310f10(0x30d):_0x310f10(0x34d);tgBot[_0x310f10(0x2f5)](_0x3c8ee2[_0x310f10(0x332)]['id'],_0x310f10(0x1e0)+_0x462cb1+'\x20to\x20'+_0x20070c+_0x310f10(0x20f))[_0x310f10(0x2a6)](_0x2d1880=>{telegramError(_0x2d1880);}),toggleBotMode(_0x462cb1);}),tgBot[_0x141f9e(0x239)](_0x141f9e(0x36e));});}}),tgBot[_0x57ae6a(0x1e9)](/\/names/,_0x391e24=>{const _0x4cf2ae=_0x57ae6a;if(!validateTelegram(_0x391e24))return;let _0xf487ef='';config[_0x4cf2ae(0x360)](_0x1a06ed=>{const _0x4175fc=_0x4cf2ae;_0xf487ef+=_0x4175fc(0x244)+_0x1a06ed[_0x4175fc(0x1e2)]+':\x20'+_0x1a06ed[_0x4175fc(0x370)]+'\x0a';}),tgBot[_0x4cf2ae(0x2f5)](_0x391e24['chat']['id'],_0xf487ef,{'parse_mode':_0x4cf2ae(0x2e3)})[_0x4cf2ae(0x2a6)](_0x7ca584=>{telegramError(_0x7ca584);});}),tgBot[_0x57ae6a(0x1e9)](/\/disable/,_0x3f858f=>{const _0x247451=_0x57ae6a;if(!validateTelegram(_0x3f858f))return;tgBot[_0x247451(0x2f5)](_0x3f858f[_0x247451(0x332)]['id'],_0x247451(0x270))[_0x247451(0x2a6)](_0x5eea9f=>{telegramError(_0x5eea9f);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x57ae6a(0x1e9)](/\/help/,_0x12c2b4=>{const _0x18a2cb=_0x57ae6a;if(!validateTelegram(_0x12c2b4))return;tgBot['sendMessage'](_0x12c2b4[_0x18a2cb(0x332)]['id'],_0x487788)[_0x18a2cb(0x2a6)](_0x26ce21=>{telegramError(_0x26ce21);});}),tgBot['on'](_0x57ae6a(0x355),_0x4050a1=>{const _0x3f2e85=_0x57ae6a;_0x4050a1[_0x3f2e85(0x249)]()[_0x3f2e85(0x265)]('404\x20Not\x20Found')&&(logger[_0x3f2e85(0x26c)](_0x3f2e85(0x2a0)),tgBot[_0x3f2e85(0x27a)](),tgBot=null,io['to'](_0x3f2e85(0x34b))[_0x3f2e85(0x2ed)]('notification',_0x3f2e85(0x2a0)));}),process[_0x57ae6a(0x2b0)](_0x57ae6a(0x2e0),()=>{const _0x2f2677=_0x57ae6a;if(tgBot)tgBot[_0x2f2677(0x27a)]();process[_0x2f2677(0x258)](0x1);}),process[_0x57ae6a(0x2b0)](_0x57ae6a(0x356),()=>{const _0x4cac67=_0x57ae6a;if(tgBot)tgBot[_0x4cac67(0x27a)]();process[_0x4cac67(0x258)](0x1);});}}function disableTelegram(){const _0x2dad3e=_0x27e344;tgBot&&(tgBot[_0x2dad3e(0x27a)](),tgBot=null);}function sendTelegram(_0x545d39,_0x4cae90){const _0x140ef1=_0x27e344;if(settings[_0x140ef1(0x2ef)]){if(settings[_0x140ef1(0x348)]==_0x140ef1(0x203)||(_0x4cae90[_0x140ef1(0x2c8)]=='error'||_0x4cae90[_0x140ef1(0x2c8)]==_0x140ef1(0x261)||_0x4cae90[_0x140ef1(0x2c8)]=='success')&&settings[_0x140ef1(0x348)]=='alerts'||_0x4cae90[_0x140ef1(0x2c8)]==_0x140ef1(0x35c)&&settings[_0x140ef1(0x348)]==_0x140ef1(0x1db)){if(tgBot&&settings[_0x140ef1(0x23b)]){if(_0x4cae90[_0x140ef1(0x240)])tgBot[_0x140ef1(0x2f5)](settings[_0x140ef1(0x23b)],_0x4cae90['botname']+'\x20>\x20'+_0x4cae90['event'])['catch'](_0x14cd57=>{telegramError(_0x14cd57);});else tgBot[_0x140ef1(0x2f5)](settings[_0x140ef1(0x23b)],_0x140ef1(0x244)+_0x545d39+'\x20>\x20'+_0x4cae90[_0x140ef1(0x23f)])[_0x140ef1(0x2a6)](_0x2f84d7=>{telegramError(_0x2f84d7);});}}}}async function sendTelegramMsg(_0x138582,_0x48d84c=_0x27e344(0x2e3)){const _0x5df5bb=_0x27e344;return settings[_0x5df5bb(0x2ef)]&&tgBot&&settings['telegramChatId']?(await tgBot[_0x5df5bb(0x2f5)](settings['telegramChatId'],_0x138582,{'parse_mode':_0x48d84c})[_0x5df5bb(0x2a6)](_0x562ddd=>{telegramError(_0x562ddd);}),!![]):![];}function getDeviceWithIp(_0x1ec3bc){const _0x4cc7dc=_0x27e344;return devices[_0x4cc7dc(0x1de)](_0x39eb8a=>_0x39eb8a['ip']===_0x1ec3bc);}function temporaryAccess2FA(_0xe1947c,_0xd0b582){const _0x1bc9cb=_0x27e344;let _0x3fc654=new Date(),_0x2530e6=![];if(lastIpApproval){if(_0x3fc654-lastIpApproval<0x1388)_0x2530e6=!![];}lastIpApproval=new Date();if(_0x2530e6)return;tgBot&&settings[_0x1bc9cb(0x23b)]&&(tgBot['removeListener'](_0x1bc9cb(0x36e)),tgBot['sendMessage'](settings['telegramChatId'],_0x1bc9cb(0x308)+normalizeIP(_0xd0b582)['show']+_0x1bc9cb(0x345),{'parse_mode':_0x1bc9cb(0x2e3),'reply_markup':{'inline_keyboard':[[{'text':_0x1bc9cb(0x357),'callback_data':'5'},{'text':_0x1bc9cb(0x2b3),'callback_data':'15'},{'text':_0x1bc9cb(0x313),'callback_data':'30'},{'text':_0x1bc9cb(0x273),'callback_data':_0x1bc9cb(0x273)}]]}})[_0x1bc9cb(0x2a6)](_0x2820f4=>{telegramError(_0x2820f4);}),tgBot['on'](_0x1bc9cb(0x36e),async _0x50aaf5=>{const _0x511364=_0x1bc9cb,_0xfa5e2b=_0x50aaf5[_0x511364(0x22e)],_0x5c13bd=_0x50aaf5[_0x511364(0x204)];tgBot['answerCallbackQuery'](_0x50aaf5['id'])[_0x511364(0x37d)](async()=>{const _0x5ecc92=_0x511364;devices[_0xe1947c][_0x5ecc92(0x1ef)]={'clientip':_0xd0b582,'timestamp':new Date()[_0x5ecc92(0x326)](),'expiry':_0xfa5e2b},_0xfa5e2b!=_0x5ecc92(0x273)?(await tgBot[_0x5ecc92(0x2f5)](_0x5c13bd[_0x5ecc92(0x332)]['id'],_0x5ecc92(0x380)+_0xfa5e2b+'\x20minutes',{'parse_mode':_0x5ecc92(0x2e3)})[_0x5ecc92(0x2a6)](_0x30e6bd=>{telegramError(_0x30e6bd);}),io['to'](_0xe1947c)[_0x5ecc92(0x2ed)](_0x5ecc92(0x1e1),{'access':{'allow':![],'reason':_0x5ecc92(0x250),'token':null}})):(await tgBot[_0x5ecc92(0x2f5)](_0x5c13bd['chat']['id'],'Temporary\x20access\x20rejected')['catch'](_0x5f6a68=>{telegramError(_0x5f6a68);}),io['to'](_0xe1947c)[_0x5ecc92(0x2ed)](_0x5ecc92(0x1e1),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x511364(0x239)]('callback_query');}));}function loginAccess2FA(_0x297b63,_0x421db0){const _0x1ff29d=_0x27e344;tgBot&&settings[_0x1ff29d(0x23b)]&&(tgBot[_0x1ff29d(0x239)](_0x1ff29d(0x36e)),tgBot[_0x1ff29d(0x2f5)](settings[_0x1ff29d(0x23b)],_0x1ff29d(0x21c)+normalizeIP(_0x421db0)['show']+'</b>\x20?',{'parse_mode':_0x1ff29d(0x2e3),'reply_markup':{'inline_keyboard':[[{'text':_0x1ff29d(0x201),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x1ff29d(0x273)}]]}})[_0x1ff29d(0x2a6)](_0x155a41=>{telegramError(_0x155a41);}),tgBot['on'](_0x1ff29d(0x36e),async _0x4c79c9=>{const _0x3b6754=_0x1ff29d,_0x57dab0=_0x4c79c9['data'],_0x5b179e=_0x4c79c9[_0x3b6754(0x204)];tgBot[_0x3b6754(0x381)](_0x4c79c9['id'])[_0x3b6754(0x37d)](async()=>{const _0x52ea59=_0x3b6754;devices[_0x297b63][_0x52ea59(0x377)]={'clientip':_0x421db0,'timestamp':new Date()[_0x52ea59(0x326)](),'expiry':_0x57dab0},_0x57dab0!=_0x52ea59(0x273)?(await tgBot[_0x52ea59(0x2f5)](_0x5b179e['chat']['id'],_0x52ea59(0x347),{'parse_mode':'HTML'})['catch'](_0x17a5c0=>{telegramError(_0x17a5c0);}),io['to'](_0x297b63)[_0x52ea59(0x2ed)](_0x52ea59(0x1e1),{'access':{'allow':![],'reason':_0x52ea59(0x250),'token':null}})):(await tgBot[_0x52ea59(0x2f5)](_0x5b179e['chat']['id'],_0x52ea59(0x29e))[_0x52ea59(0x2a6)](_0x36f122=>{telegramError(_0x36f122);}),io['to'](_0x297b63)[_0x52ea59(0x2ed)](_0x52ea59(0x1e1),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x3b6754(0x239)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x502499=_0x27e344;return dbConfig['get'](_0x502499(0x23c))[_0x502499(0x295)](_0x502499(0x1e2))[_0x502499(0x2af)]({'status':'enabled'})['value']()||[];}function getDisabledBots(){const _0x3d7900=_0x27e344;return dbConfig[_0x3d7900(0x338)](_0x3d7900(0x23c))['sortBy'](_0x3d7900(0x1e2))[_0x3d7900(0x2af)]({'status':_0x3d7900(0x303)})[_0x3d7900(0x243)]()||[];}function getBotAttributes(_0x49941a){const _0x4d920a=_0x27e344;let _0x35d10e={};const _0x299a92=configpath+_0x4d920a(0x35a)+_0x49941a+_0x4d920a(0x1dd),_0x54b686=fs[_0x4d920a(0x31f)](_0x299a92);if(_0x54b686){const _0x6ef569=fs['readFileSync'](_0x299a92);try{const _0x20e2d8=JSON[_0x4d920a(0x1e6)](_0x6ef569),_0x511742=_0x20e2d8?_0x20e2d8[_0x4d920a(0x1e8)][0x0][_0x4d920a(0x27b)]:![];_0x35d10e[_0x4d920a(0x334)]=_0x511742?_0x4d920a(0x34d):_0x4d920a(0x30d),_0x35d10e['botname']=_0x20e2d8?_0x20e2d8[_0x4d920a(0x1e8)][0x0][_0x4d920a(0x370)]:_0x4d920a(0x244)+_0x49941a;}catch(_0x22fcbc){_0x35d10e[_0x4d920a(0x334)]=_0x4d920a(0x30d),_0x35d10e[_0x4d920a(0x370)]=_0x4d920a(0x244)+_0x49941a;}}else _0x35d10e[_0x4d920a(0x334)]=_0x4d920a(0x30d),_0x35d10e[_0x4d920a(0x370)]='Bot\x20'+_0x49941a;return _0x35d10e;}function getBotsWithMode(){const _0x3dc21e=_0x27e344,_0x156ada=dbConfig[_0x3dc21e(0x338)](_0x3dc21e(0x23c))[_0x3dc21e(0x295)](_0x3dc21e(0x1e2))[_0x3dc21e(0x243)]()||[];return _0x156ada[_0x3dc21e(0x360)](_0x1c340c=>{const _0x502cff=_0x3dc21e;let _0x445acd=getBotAttributes(_0x1c340c[_0x502cff(0x1e2)]);_0x1c340c[_0x502cff(0x334)]=_0x445acd[_0x502cff(0x334)];}),_0x156ada;}async function initUser(){const _0x161a18=_0x27e344;if(!settings[_0x161a18(0x328)]){const _0x18addf=uuidRandom();mixpanel[_0x161a18(0x30e)](_0x18addf),updateSetting('userid',_0x18addf);}}async function initSecure(){const _0x41fb8a=_0x27e344;let _0x5369a9=getSecure();if(!_0x5369a9[_0x41fb8a(0x302)](_0x41fb8a(0x266))){let _0x32613b=await generateKeys();_0x5369a9['publicKey']=_0x32613b[_0x41fb8a(0x28a)],_0x5369a9[_0x41fb8a(0x28b)]=_0x32613b[_0x41fb8a(0x28b)],_0x5369a9[_0x41fb8a(0x266)]=crypto[_0x41fb8a(0x2d1)](0x20)[_0x41fb8a(0x249)](_0x41fb8a(0x212));;storeSecure(_0x5369a9);}}function getSettings(){const _0x163294=_0x27e344;return dbSettings[_0x163294(0x338)](_0x163294(0x35b))[_0x163294(0x243)]()||{};}function getSecure(){const _0x512497=_0x27e344;return dbSecure[_0x512497(0x338)](_0x512497(0x24f))[_0x512497(0x243)]()||{};}function getBlacklist(){const _0x5ce5c0=_0x27e344;return dbSecure[_0x5ce5c0(0x338)](_0x5ce5c0(0x22f))[_0x5ce5c0(0x243)]()||[];}function broadcastToBots(_0x496567,_0x45f560){const _0x80a3a6=_0x27e344;config[_0x80a3a6(0x360)](_0x46a323=>{const _0x2433d1=_0x80a3a6;if(_0x46a323[_0x2433d1(0x1e1)]==_0x2433d1(0x2e4)&&_0x46a323[_0x2433d1(0x2ac)]=='running'){if(pid[_0x46a323['botID']])pid[_0x46a323['botID']]['send']({[_0x496567]:_0x45f560});}});}function storeSettings(_0x4044d3,_0x476533=![]){const _0x26d9d8=_0x27e344;_0x4044d3={...settings,..._0x4044d3};if(_0x476533&&_0x4044d3[_0x26d9d8(0x257)]!='************'&&_0x4044d3[_0x26d9d8(0x257)]!='***'&&_0x4044d3[_0x26d9d8(0x257)]!=''){const _0x250fd9=crypt['decrypt'](secure[_0x26d9d8(0x28b)],_0x4044d3[_0x26d9d8(0x257)])[_0x26d9d8(0x204)][_0x26d9d8(0x247)]('@')[0x0],_0x2ec732=bcrypt[_0x26d9d8(0x29b)](_0x250fd9,saltRounds);_0x4044d3={..._0x4044d3,'bbPassword':_0x2ec732};}if(_0x476533&&_0x4044d3[_0x26d9d8(0x36c)]!=_0x26d9d8(0x28f)&&_0x4044d3[_0x26d9d8(0x36c)]!=_0x26d9d8(0x208)&&_0x4044d3[_0x26d9d8(0x36c)]!=''){const _0x14c87f=crypt[_0x26d9d8(0x2d8)](secure['privateKey'],_0x4044d3[_0x26d9d8(0x36c)])['message'][_0x26d9d8(0x247)]('@')[0x0];_0x4044d3={..._0x4044d3,'telegramToken':_0x14c87f};}const _0x2cf0de=_0x4044d3[_0x26d9d8(0x36c)]!=_0x26d9d8(0x28f)&&_0x4044d3[_0x26d9d8(0x36c)]!=settings['telegramToken']||_0x4044d3[_0x26d9d8(0x206)]!=settings['telegramUsername'],_0x2075f5=_0x4044d3['telegramToken']==''||_0x4044d3[_0x26d9d8(0x206)]=='';if(_0x2cf0de)_0x4044d3[_0x26d9d8(0x348)]=_0x26d9d8(0x203);for(const [_0x13529f,_0x315913]of Object[_0x26d9d8(0x2ca)](_0x4044d3)){if(_0x13529f==_0x26d9d8(0x36c)&&_0x315913==_0x26d9d8(0x28f)){_0x4044d3[_0x26d9d8(0x36c)]=settings[_0x26d9d8(0x36c)];continue;};if(_0x13529f==_0x26d9d8(0x257)&&_0x315913=='************'){_0x4044d3[_0x26d9d8(0x257)]=settings[_0x26d9d8(0x257)];continue;};dbSettings[_0x26d9d8(0x27f)]('settings.'+_0x13529f,_0x315913)['write']();}settings=_0x4044d3,io['to'](_0x26d9d8(0x34b))[_0x26d9d8(0x2ed)](_0x26d9d8(0x35b),cleanSettings()),broadcastToBots('timeshift',settings['timeshift']);if(_0x2cf0de&&!_0x2075f5)initTelegram();if(_0x2cf0de&&_0x2075f5)disableTelegram();getAllClients()[_0x26d9d8(0x360)](_0x44706c=>{const _0x3f1b79=_0x26d9d8;getSocket(_0x44706c['id'])['emit'](_0x3f1b79(0x1e1),{'access':{'allow':![],'reason':_0x3f1b79(0x250),'token':null}});});}function updateSetting(_0x5879c6,_0x4eb7d7){const _0x28680b=_0x27e344;dbSettings[_0x28680b(0x27f)](_0x28680b(0x363)+_0x5879c6,_0x4eb7d7)['write'](),settings=getSettings(),io['to'](_0x28680b(0x34b))['emit']('settings',cleanSettings());}function storeSecure(_0x5d9b86){const _0x444e32=_0x27e344;dbSecure[_0x444e32(0x338)](_0x444e32(0x24f))[_0x444e32(0x20d)](_0x5d9b86)[_0x444e32(0x2df)](),secure=_0x5d9b86;}function addBlacklist(_0x59e3a3){const _0x4a2d7a=_0x27e344;cleanBlacklist();let _0xc4e867;devices[_0x59e3a3][_0x4a2d7a(0x1ef)]?_0xc4e867=Math[_0x4a2d7a(0x32f)](devices[_0x59e3a3][_0x4a2d7a(0x1ef)][_0x4a2d7a(0x26b)],loginExpiry):_0xc4e867=loginExpiry,dbSecure[_0x4a2d7a(0x338)](_0x4a2d7a(0x22f))[_0x4a2d7a(0x20d)]({'expiry':new Date()['getTime']()+_0xc4e867*0x3c*0x3e8,'token':devices[_0x59e3a3][_0x4a2d7a(0x216)][_0x4a2d7a(0x21a)]})[_0x4a2d7a(0x2df)](),blacklist=dbSecure[_0x4a2d7a(0x338)](_0x4a2d7a(0x22f))['value']();}function cleanBlacklist(){const _0x50871e=_0x27e344;let _0x4c45e9=dbSecure[_0x50871e(0x338)]('blacklist')[_0x50871e(0x1ff)]()['value'](),_0x4db7d0=new Date()[_0x50871e(0x326)]();_0x4c45e9['forEach'](_0x3c6f87=>{const _0x3bfe83=_0x50871e;_0x3c6f87[_0x3bfe83(0x26b)]<_0x4db7d0&&dbSecure[_0x3bfe83(0x338)](_0x3bfe83(0x22f))['remove']({'expiry':_0x3c6f87[_0x3bfe83(0x26b)]})[_0x3bfe83(0x2df)]();});}function initStates(){const _0x41f33c=_0x27e344;let _0x3f67a5=getConfiguration();_0x3f67a5[_0x41f33c(0x360)](_0x5097f3=>{const _0x3da39e=_0x41f33c;_0x5097f3[_0x3da39e(0x2ac)]='stopped';}),storeConfiguration(_0x3f67a5);}function onKeys(){const _0x4f264f=new RSA();return new Promise(_0x37f1af=>{const _0x5df3d4=_0x3889;_0x4f264f[_0x5df3d4(0x324)]()[_0x5df3d4(0x37d)](_0x1b3d7c=>{_0x37f1af(_0x1b3d7c);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x361853=_0x27e344;let _0x59e694=getSettings(),_0x5032e=![];!_0x59e694[_0x361853(0x302)](_0x361853(0x2c4))&&(_0x59e694[_0x361853(0x2c4)]=0x0,_0x5032e=!![]);!_0x59e694[_0x361853(0x302)]('lastmsgemitted')&&(_0x59e694[_0x361853(0x2ee)]=0x0,_0x5032e=!![]);!_0x59e694[_0x361853(0x302)](_0x361853(0x230))&&(_0x59e694['latestversion']=_0x361853(0x219),_0x5032e=!![]);if(_0x5032e)storeSettings(_0x59e694);}function storeConfiguration(_0x1ae588){const _0x51cbd9=_0x27e344;dbConfig[_0x51cbd9(0x338)]('bots')[_0x51cbd9(0x27c)]()[_0x51cbd9(0x2df)](),_0x1ae588['forEach'](_0x190f38=>{delete _0x190f38['mode'];}),dbConfig['get'](_0x51cbd9(0x23c))[_0x51cbd9(0x20d)](..._0x1ae588)[_0x51cbd9(0x2df)](),config=_0x1ae588;}function resetPassword(){const _0x2aba42=_0x27e344;tgBot&&settings[_0x2aba42(0x23b)]&&(tgBot[_0x2aba42(0x239)](_0x2aba42(0x36e)),tgBot['sendMessage'](settings['telegramChatId'],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x2aba42(0x2e3),'reply_markup':{'inline_keyboard':[[{'text':_0x2aba42(0x1e4),'callback_data':_0x2aba42(0x1e4)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x475b7e=>{telegramError(_0x475b7e);}),tgBot['on'](_0x2aba42(0x36e),async _0x442d13=>{const _0x556cbc=_0x2aba42,_0x1a6fb2=_0x442d13[_0x556cbc(0x22e)],_0x2076d5=_0x442d13['message'];tgBot[_0x556cbc(0x381)](_0x442d13['id'])[_0x556cbc(0x37d)](async()=>{const _0x4aa175=_0x556cbc;if(_0x1a6fb2!='no'){const _0xf627cf=0xf,_0x2d372f=_0x4aa175(0x213),_0x48b8a2=Array[_0x4aa175(0x286)](crypto[_0x4aa175(0x2ec)](new Uint32Array(_0xf627cf)))['map'](_0x5627bc=>_0x2d372f[_0x5627bc%_0x2d372f[_0x4aa175(0x228)]])[_0x4aa175(0x218)](''),_0x1cca7f=bcrypt[_0x4aa175(0x29b)](_0x48b8a2,saltRounds);storeSettings({'bbPassword':_0x1cca7f}),await tgBot['sendMessage'](_0x2076d5[_0x4aa175(0x332)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x48b8a2,{'parse_mode':'HTML'})[_0x4aa175(0x2a6)](_0x2f206f=>{telegramError(_0x2f206f);});}else await tgBot[_0x4aa175(0x2f5)](_0x2076d5[_0x4aa175(0x332)]['id'],_0x4aa175(0x1fc))[_0x4aa175(0x2a6)](_0x5535f0=>{telegramError(_0x5535f0);});}),tgBot[_0x556cbc(0x239)](_0x556cbc(0x36e));}));}async function confirmRestore(_0x6d3682,_0x20b021){const _0x3ab5dd=_0x27e344;tgBot&&settings[_0x3ab5dd(0x23b)]&&(tgBot['removeListener'](_0x3ab5dd(0x36e)),await tgBot['sendMessage'](settings[_0x3ab5dd(0x23b)],_0x3ab5dd(0x214),{'parse_mode':_0x3ab5dd(0x2e3),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x3ab5dd(0x1e4)},{'text':'no','callback_data':'no'}]]}})[_0x3ab5dd(0x2a6)](_0x227975=>{telegramError(_0x227975);}),tgBot['on'](_0x3ab5dd(0x36e),async _0x24d10e=>{const _0xadcdd5=_0x3ab5dd,_0xe0e36=_0x24d10e[_0xadcdd5(0x22e)],_0x5ae307=_0x24d10e['message'];tgBot[_0xadcdd5(0x381)](_0x24d10e['id'])['then'](async()=>{const _0x2e3e61=_0xadcdd5;_0xe0e36!='no'?(await tgBot[_0x2e3e61(0x2f5)](_0x5ae307[_0x2e3e61(0x332)]['id'],'Restoring\x20bot(s)\x20from\x20backup\x20-\x20Bot\x20Manager\x20will\x20restart\x20once\x20finished',{'parse_mode':_0x2e3e61(0x2e3)})[_0x2e3e61(0x2a6)](_0x533ed7=>{telegramError(_0x533ed7);}),unzipFile(_0x6d3682,_0x20b021)):await tgBot['sendMessage'](_0x5ae307[_0x2e3e61(0x332)]['id'],_0x2e3e61(0x2d6))[_0x2e3e61(0x2a6)](_0x5a3270=>{telegramError(_0x5a3270);});}),tgBot[_0xadcdd5(0x239)](_0xadcdd5(0x36e));}));}function getServerTime(){const _0x25ac6a=_0x27e344,_0x40a64a=new Date();return _0x40a64a['getFullYear']()+'/'+(_0x40a64a[_0x25ac6a(0x268)]()+0x1)['toString']()[_0x25ac6a(0x312)](0x2,'0')+'/'+_0x40a64a[_0x25ac6a(0x2b7)]()[_0x25ac6a(0x249)]()[_0x25ac6a(0x312)](0x2,'0')+'\x20'+_0x40a64a['getHours']()[_0x25ac6a(0x249)]()[_0x25ac6a(0x312)](0x2,'0')+':'+_0x40a64a[_0x25ac6a(0x36d)]()['toString']()[_0x25ac6a(0x312)](0x2,'0')+':'+_0x40a64a[_0x25ac6a(0x1e7)]()['toString']()[_0x25ac6a(0x312)](0x2,'0');}function getTimeStamp(){const _0x46f416=_0x27e344,_0x17648a=shiftedTime();return _0x17648a['getFullYear']()+'/'+(_0x17648a['getMonth']()+0x1)[_0x46f416(0x249)]()[_0x46f416(0x312)](0x2,'0')+'/'+_0x17648a[_0x46f416(0x2b7)]()[_0x46f416(0x249)]()[_0x46f416(0x312)](0x2,'0')+'\x20'+_0x17648a[_0x46f416(0x372)]()[_0x46f416(0x249)]()['padStart'](0x2,'0')+':'+_0x17648a[_0x46f416(0x36d)]()[_0x46f416(0x249)]()[_0x46f416(0x312)](0x2,'0')+':'+_0x17648a['getSeconds']()[_0x46f416(0x249)]()[_0x46f416(0x312)](0x2,'0');}function shiftedTime(){const _0x3ebfde=_0x27e344,_0x3b3c59=new Date();let _0x5d6ed7=_0x3b3c59;if(settings[_0x3ebfde(0x2b1)]&&settings[_0x3ebfde(0x2b1)]!==0x0)_0x5d6ed7=fns[_0x3ebfde(0x304)](_0x3b3c59,{'hours':settings['timeshift']});return _0x5d6ed7;}function _0x3889(_0x2376b1,_0x43f5b5){const _0x30703c=_0x42a1();return _0x3889=function(_0x1eacd7,_0x4634a4){_0x1eacd7=_0x1eacd7-0x1da;let _0x42a1e2=_0x30703c[_0x1eacd7];return _0x42a1e2;},_0x3889(_0x2376b1,_0x43f5b5);}function startScheduler(){const _0x25ef74=_0x27e344,_0x44883a=new Date()[_0x25ef74(0x37e)](),_0x248ca7=shiftedTime()[_0x25ef74(0x372)]();_0x248ca7==0x4&&backupConfigFiles();_0x248ca7==0x0&&rotateLogFiles();_0x44883a%0x6==0x0&&triggerAnalytics();_0x44883a%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function backupConfigFiles(){const _0x4dfaee=_0x27e344;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x4dfaee(0x360)](_0x4cafcc=>{const _0x496395=_0x4dfaee;if(!_0x4cafcc[_0x496395(0x25a)]())fs['copyFileSync'](configpath+_0x4cafcc[_0x496395(0x2e9)],configbackuppath+_0x4cafcc[_0x496395(0x2e9)]);});}function rotateLogFiles(){const _0xd6f13=_0x27e344,_0x35a716=fs[_0xd6f13(0x2e7)](logspath+'output-000.log'),_0x53577f=_0x35a716[_0xd6f13(0x1fe)]/0x400;if(_0x53577f>0x32){let _0x5cfb36=fs[_0xd6f13(0x285)](logspath,{'withFileTypes':!![]});_0x5cfb36[_0xd6f13(0x224)]((_0x14ddbe,_0x1567ab)=>_0x14ddbe[_0xd6f13(0x2e9)]<_0x1567ab[_0xd6f13(0x2e9)]?0x1:_0x1567ab[_0xd6f13(0x2e9)]<_0x14ddbe[_0xd6f13(0x2e9)]?-0x1:0x0),_0x5cfb36[_0xd6f13(0x360)](_0x2dc536=>{const _0x320fc4=_0xd6f13;if(_0x2dc536[_0x320fc4(0x2e9)]==_0x320fc4(0x2ba))fs[_0x320fc4(0x231)](logspath+_0x2dc536['name'],logspath+'output-003.log');if(_0x2dc536[_0x320fc4(0x2e9)]==_0x320fc4(0x267))fs[_0x320fc4(0x231)](logspath+_0x2dc536[_0x320fc4(0x2e9)],logspath+_0x320fc4(0x2ba));_0x2dc536[_0x320fc4(0x2e9)]==_0x320fc4(0x2b6)&&(fs[_0x320fc4(0x231)](logspath+_0x2dc536[_0x320fc4(0x2e9)],logspath+'output-001.log'),fs['writeFileSync'](logspath+_0x2dc536[_0x320fc4(0x2e9)],''));});}}async function zipFiles(_0x153ab2){const _0x253502=_0x27e344;let _0x296919;if(_0x153ab2==_0x253502(0x20b))_0x296919=logspath;if(_0x153ab2=='backup')_0x296919=configpath;let _0xcb6bab=fs[_0x253502(0x285)](_0x296919,{'withFileTypes':!![]});const _0x571e99=new require('node-zip')();_0xcb6bab[_0x253502(0x360)](_0x212111=>{const _0x5ce09c=_0x253502;if(!_0x212111[_0x5ce09c(0x25a)]()){let _0x21c84c=fs[_0x5ce09c(0x331)](_0x296919+_0x212111['name']);const _0x39ec43=/^bot-[0-9]{3}-config.json$/,_0x5c491b=_0x39ec43[_0x5ce09c(0x349)](_0x212111[_0x5ce09c(0x2e9)]);if(_0x5c491b){const _0x477152=JSON['parse'](_0x21c84c);_0x477152[_0x5ce09c(0x1e8)][0x0][_0x5ce09c(0x296)]=_0x5ce09c(0x208),_0x477152[_0x5ce09c(0x1e8)][0x0][_0x5ce09c(0x31c)]='***',_0x21c84c=JSON[_0x5ce09c(0x33d)](_0x477152,null,0x2);}if(_0x212111[_0x5ce09c(0x2e9)]=='bb-settings.json'){const _0x3e46a5=JSON[_0x5ce09c(0x1e6)](_0x21c84c);if(_0x3e46a5[_0x5ce09c(0x35b)][_0x5ce09c(0x297)])_0x3e46a5['settings'][_0x5ce09c(0x297)]=![];if(_0x3e46a5[_0x5ce09c(0x35b)][_0x5ce09c(0x257)])_0x3e46a5[_0x5ce09c(0x35b)][_0x5ce09c(0x257)]=_0x5ce09c(0x208);if(_0x3e46a5[_0x5ce09c(0x35b)][_0x5ce09c(0x36c)])_0x3e46a5[_0x5ce09c(0x35b)]['telegramToken']='***';if(_0x3e46a5[_0x5ce09c(0x35b)][_0x5ce09c(0x23b)])_0x3e46a5[_0x5ce09c(0x35b)][_0x5ce09c(0x23b)]=null;_0x21c84c=JSON[_0x5ce09c(0x33d)](_0x3e46a5,null,0x2);}if(_0x212111[_0x5ce09c(0x2e9)]!=_0x5ce09c(0x205))_0x571e99[_0x5ce09c(0x373)](_0x212111[_0x5ce09c(0x2e9)],_0x21c84c);}});const _0x2b6176=_0x571e99[_0x253502(0x2ad)]({'base64':![],'compression':'DEFLATE'});fs[_0x253502(0x2d7)](zippath+(_0x153ab2+_0x253502(0x2a1)),_0x2b6176,_0x253502(0x366));}async function unzipFile(_0x39b1a5,_0x513d33){const _0x42d759=_0x27e344;await backupConfigFiles(),fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x42d759(0x360)](_0x5b69e0=>{const _0x520e9f=_0x42d759;if(!_0x5b69e0[_0x520e9f(0x25a)]())fs[_0x520e9f(0x376)](configpath+_0x5b69e0[_0x520e9f(0x2e9)]);});const _0x2edb9e=fs[_0x42d759(0x331)](_0x39b1a5+_0x513d33,_0x42d759(0x366)),_0x4bdec5=new require(_0x42d759(0x309))(_0x2edb9e,{'base64':![],'checkCRC32':!![]});Object[_0x42d759(0x1ed)](_0x4bdec5[_0x42d759(0x24b)])[_0x42d759(0x360)](_0x3a48a2=>{const _0x430ba1=_0x42d759,_0x22463f=_0x4bdec5[_0x430ba1(0x24b)][_0x3a48a2];fs['writeFileSync'](configpath+_0x22463f['name'],_0x22463f[_0x430ba1(0x1f2)]);}),process['send']({'restore':!![]},_0x3f8597=>{});}async function getPublicIp(){const _0x1a6011=_0x27e344;try{const _0x573200=await axios['get'](_0x1a6011(0x2c9));publicip=_0x573200[_0x1a6011(0x22e)]['ip'];}catch(_0x2e71c4){}}async function triggerAnalytics(){const _0x7a2d5b=_0x27e344;if(!publicip)await getPublicIp();const _0xa9ff61=getBotsWithMode();let _0x41ea07=0x0;_0xa9ff61[_0x7a2d5b(0x360)](_0x52dafa=>{const _0x24b0bc=_0x7a2d5b;if(_0x52dafa[_0x24b0bc(0x1e1)]===_0x24b0bc(0x2e4))_0x41ea07++;}),mixpanel[_0x7a2d5b(0x2c6)]('Server',{'distinct_id':settings[_0x7a2d5b(0x328)],'ip':publicip,'version':serverversion,'numbots':_0xa9ff61[_0x7a2d5b(0x228)],'numbotsenabled':_0x41ea07});}async function getMessages(){const _0x1c3eb6=_0x27e344,_0x32a2f3=_0x1c3eb6(0x362),_0x4fc16c=new GraphQLClient(_0x32a2f3),_0x5c77a4={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x219441=serverversion[_0x1c3eb6(0x247)]('.'),_0x33aa1f=_0x219441[0x0]+'.'+_0x219441[0x1],_0x5d15f7=Math[_0x1c3eb6(0x22a)](settings['lastmsgtelegram'],settings[_0x1c3eb6(0x2ee)]),_0x11b182={'last':parseInt(_0x5d15f7),'bbm':_0x33aa1f},_0xca9e34=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4e3f1e;try{_0x4e3f1e=await _0x4fc16c['request'](_0xca9e34,_0x11b182,_0x5c77a4);}catch(_0x683d15){}if(_0x4e3f1e&&_0x4e3f1e[_0x1c3eb6(0x1eb)]){let _0x5053a4=settings[_0x1c3eb6(0x2c4)];newMessages=[];for(const _0x40f730 of _0x4e3f1e[_0x1c3eb6(0x1eb)]){newMessages[_0x1c3eb6(0x20d)](_0x40f730);if(_0x40f730[_0x1c3eb6(0x2b4)])updateSetting('latestversion',_0x40f730[_0x1c3eb6(0x2b4)]);let _0x536052=_0x40f730[_0x1c3eb6(0x2b4)]?serverversion>=_0x40f730[_0x1c3eb6(0x2b4)]:![];if(!_0x536052&&_0x40f730[_0x1c3eb6(0x29d)]>_0x5053a4){if(_0x40f730['bbvReceive']===_0x1c3eb6(0x2a5)||serverversion[_0x1c3eb6(0x248)](_0x40f730[_0x1c3eb6(0x279)])){let _0x34c440=''+_0x40f730[_0x1c3eb6(0x20c)]+'\x0a\x0a'+_0x40f730[_0x1c3eb6(0x204)];const _0x10738f=await sendTelegramMsg(toTelegramMarkdown(_0x34c440),'Markdown');if(_0x10738f)_0x5053a4=_0x40f730[_0x1c3eb6(0x29d)];}}}updateAvailable=isNewerVersion(settings[_0x1c3eb6(0x230)],serverversion),updateSetting(_0x1c3eb6(0x2c4),_0x5053a4),emitMessages();}}function emitMessages(){const _0x5b2283=_0x27e344,_0x4825bd=settings[_0x5b2283(0x2ee)];let _0x343b06=[];newMessages['forEach'](_0x952a3b=>{const _0x35c15f=_0x5b2283;_0x952a3b[_0x35c15f(0x29d)]>_0x4825bd&&_0x343b06['push'](_0x952a3b);}),_0x343b06[_0x5b2283(0x228)]>0x0&&getAllClients()[_0x5b2283(0x360)](_0x53f0b3=>{const _0x540e7e=_0x5b2283;getSocket(_0x53f0b3['id'])[_0x540e7e(0x2ed)](_0x540e7e(0x204),_0x343b06);});}function confirmMessage(_0x348b20){const _0x1aea59=_0x27e344;updateSetting(_0x1aea59(0x2ee),Number(_0x348b20));}function isNewerVersion(_0x193bef,_0x30cb3d){const _0x50bd60=_0x27e344,_0x4bc20e=_0x30cb3d['split']('.'),_0x54d333=_0x193bef[_0x50bd60(0x247)]('.');for(var _0x264a59=0x0;_0x264a59<_0x54d333['length'];_0x264a59++){const _0x42e58d=~~_0x54d333[_0x264a59],_0x3bde8a=~~_0x4bc20e[_0x264a59];if(_0x42e58d>_0x3bde8a)return!![];if(_0x42e58d<_0x3bde8a)return![];}return![];}function toTelegramMarkdown(_0x5694de){const _0x4dd63d=_0x27e344,_0x2d0c53=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x1487b1=/\*{2}(.+?)\*{2}/gim;return _0x5694de=_0x5694de['replace'](_0x2d0c53,_0x4dd63d(0x223))[_0x4dd63d(0x290)](_0x1487b1,_0x4dd63d(0x2a9)),_0x5694de;}async function validateConfigFile(){const _0x11e0df=_0x27e344,_0xb3e19b=dbConfig[_0x11e0df(0x338)]('bots')[_0x11e0df(0x295)](_0x11e0df(0x1e2))[_0x11e0df(0x243)]()||[];if(_0xb3e19b[_0x11e0df(0x228)]==0x0){let _0x1b18aa=0x0,_0x3e3711=[];const _0x3b8ce0=/^bot-([0-9]{3})-config.json$/,_0x3353db=fs[_0x11e0df(0x285)](configpath);_0x3353db[_0x11e0df(0x360)](_0x3eb472=>{const _0x18db67=_0x11e0df,_0x5ddc26=_0x3b8ce0[_0x18db67(0x260)](_0x3eb472);if(_0x5ddc26){const _0xf9f64c=_0x5ddc26[0x1];let _0x255109=getBotAttributes(_0xf9f64c);_0x3e3711[_0x18db67(0x20d)]({'botID':_0xf9f64c,'botname':_0x255109[_0x18db67(0x370)],'status':_0x18db67(0x303),'live':'stopped'}),_0x1b18aa++;}}),_0x1b18aa!=0x0&&(dbConfig['get'](_0x11e0df(0x23c))[_0x11e0df(0x23a)](_0x3e3711)['write'](),config=_0x3e3711,restoredConfigFile=_0x1b18aa);}}async function restoreConfigNotify(_0x10f829){const _0x2a0954=_0x27e344;let _0x725ada;if(restoredConfigFile==0x1)_0x725ada=_0x2a0954(0x210);else _0x725ada=_0x2a0954(0x24d);if(_0x10f829)io['to']('botmanager')[_0x2a0954(0x2ed)](_0x2a0954(0x31a),_0x725ada);else{logger[_0x2a0954(0x29f)](_0x2a0954(0x2c1)),logger[_0x2a0954(0x29f)](_0x725ada),logger[_0x2a0954(0x29f)](_0x2a0954(0x2c1)),logger[_0x2a0954(0x29f)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x2a0954(0x348)]!='orders')tgBot[_0x2a0954(0x2f5)](settings[_0x2a0954(0x23b)],_0x2a0954(0x23d)+_0x725ada)[_0x2a0954(0x2a6)](_0x54c3ca=>{telegramError(_0x54c3ca);});}}function validateCredentials(_0x3ca4ba,_0x49aac1){const _0x374736=_0x27e344;if(_0x3ca4ba[_0x374736(0x1f0)]==settings[_0x374736(0x2f3)]&&bcrypt['compareSync'](_0x3ca4ba['password'],settings[_0x374736(0x257)])){if(settings[_0x374736(0x225)])return{'allow':![],'reason':_0x374736(0x236),'token':null};else{const _0x38953c=generateLoginToken(_0x49aac1);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x38953c};}}else return{'allow':![],'reason':_0x374736(0x1f7),'token':null};}function refreshToken(_0x1bc80c){const _0x46033c=_0x27e344,_0xe70604=generateLoginToken(_0x1bc80c);return{'allow':!![],'reason':_0x46033c(0x256),'token':_0xe70604};}function validateAccess(_0x23b057,_0x3ac856,_0x248b23){const _0x3facf9=_0x27e344,_0x57b2dc=_0x248b23?_0x248b23:devices[_0x3ac856]['ip'];let _0x40b9b9;const _0x54a247=_0x1220d8=>{const _0x4f8583=_0x3889;if(settings[_0x4f8583(0x297)]){if(settings[_0x4f8583(0x225)]){if(telegram2FaApproved(_0x3ac856)){const _0x2c3e70=generateLoginToken(_0x3ac856);return{'allow':!![],'reason':_0x4f8583(0x305),'token':_0x2c3e70};}else return{'allow':![],'reason':_0x4f8583(0x282),'token':null};}else return _0x40b9b9=validToken(_0x1220d8,_0x3ac856),_0x40b9b9['hasOwnProperty'](_0x4f8583(0x233))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x1220d8}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x4f8583(0x21f),'token':null};};if(settings[_0x3facf9(0x21d)]){let _0x35a318=[...settings[_0x3facf9(0x2f0)],'::1',_0x3facf9(0x2f6),_0x3facf9(0x2c7)];if(_0x35a318['includes'](_0x57b2dc))return _0x54a247(_0x23b057);else{_0x40b9b9=validToken(_0x23b057,_0x3ac856);if(_0x40b9b9[_0x3facf9(0x302)]('success'))return _0x54a247(_0x23b057);else{if(telegramIpApproved(_0x3ac856)){const _0x5313a2=generateToken(_0x3ac856);return _0x40b9b9=_0x54a247(_0x23b057),_0x40b9b9[_0x3facf9(0x2cb)]?{'allow':!![],'reason':_0x3facf9(0x238),'token':_0x5313a2}:_0x40b9b9;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x54a247(_0x23b057);}function timelyDecrypt(_0x3735cf,_0x42cd69=!![]){const _0x3e7636=_0x27e344;if(_0x3735cf)try{const _0x15e339=crypt[_0x3e7636(0x2d8)](secure['privateKey'],_0x3735cf)['message'],_0x57d16c=_0x15e339[_0x3e7636(0x247)]('@')[0x0],_0x11038e=_0x15e339[_0x3e7636(0x247)]('@')[0x1],_0xe3016e=new Date()[_0x3e7636(0x326)]();if(_0x42cd69){if(_0xe3016e-_0x11038e<maxSecretAge*0x3e8)return _0x57d16c;else return![];}else return _0x57d16c;}catch(_0xd7ff7b){return![];}else return![];}const validToken=(_0x22ff2b,_0x4ba993)=>{const _0xabe208=_0x27e344,_0x298ef1=devices[_0x4ba993]['ip'];if(!_0x22ff2b)return{'error':_0xabe208(0x2bc)};for(let _0x3d7f11 of blacklist){if(_0x3d7f11['token']==_0x22ff2b)return{'error':'Token\x20blacklisted'};}let _0x3d88b8;try{_0x3d88b8=jwt[_0xabe208(0x283)](_0x22ff2b,secure[_0xabe208(0x266)]+_0x4ba993);}catch{return{'error':_0xabe208(0x333)};}if(!_0x3d88b8[_0xabe208(0x302)](_0xabe208(0x24e))&&!_0x3d88b8[_0xabe208(0x302)](_0xabe208(0x1f0))||!_0x3d88b8[_0xabe208(0x302)](_0xabe208(0x310)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x3d88b8[_0xabe208(0x302)](_0xabe208(0x1f0))&&_0x3d88b8[_0xabe208(0x302)](_0xabe208(0x24e))){const {clientip:_0x5db342}=_0x3d88b8;return _0x298ef1==_0x5db342?{'success':_0xabe208(0x369)}:{'error':_0xabe208(0x2f4)};}else{if(_0x3d88b8[_0xabe208(0x302)](_0xabe208(0x1f0))&&_0x3d88b8[_0xabe208(0x302)]('clientip')){const {username:_0x3fbd0d,clientip:_0x1204af}=_0x3d88b8;return settings[_0xabe208(0x2f3)]==_0x3fbd0d&&_0x298ef1==_0x1204af?{'success':_0xabe208(0x369)}:{'error':_0xabe208(0x269)};}}},generateLoginToken=_0x31b47a=>{const _0x59c40a=_0x27e344;if(_0x31b47a){const _0x1a9894=devices[_0x31b47a]['ip'];return jwt[_0x59c40a(0x20e)]({'username':settings[_0x59c40a(0x2f3)],'clientip':_0x1a9894},secure[_0x59c40a(0x266)]+_0x31b47a,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x35b7d3=>{const _0xa49593=_0x27e344;if(_0x35b7d3){const _0x2d94f1=devices[_0x35b7d3]['ip'];return jwt[_0xa49593(0x20e)]({'clientip':_0x2d94f1},secure['secret']+_0x35b7d3,{'expiresIn':devices[_0x35b7d3][_0xa49593(0x1ef)][_0xa49593(0x26b)]*0x3c});}else return![];},telegramIpApproved=_0x4e5cb8=>{const _0x2642b0=_0x27e344;let _0x1df3b2=![];return devices[_0x4e5cb8][_0x2642b0(0x1ef)]&&devices[_0x4e5cb8][_0x2642b0(0x1ef)][_0x2642b0(0x26b)]!=_0x2642b0(0x273)&&(_0x1df3b2=devices[_0x4e5cb8]['telegramIpApproval'][_0x2642b0(0x24e)]==devices[_0x4e5cb8]['ip']&&new Date()[_0x2642b0(0x326)]()-devices[_0x4e5cb8][_0x2642b0(0x1ef)][_0x2642b0(0x2e5)]<devices[_0x4e5cb8][_0x2642b0(0x1ef)]['expiry']*0x3c*0x3e8),_0x1df3b2;},telegram2FaApproved=_0x4070dd=>{const _0xae7914=_0x27e344;let _0x1eb2a5=![];return devices[_0x4070dd]['telegram2FaApproval']&&devices[_0x4070dd]['telegram2FaApproval'][_0xae7914(0x26b)]!=_0xae7914(0x273)&&(_0x1eb2a5=devices[_0x4070dd][_0xae7914(0x377)]['clientip']==devices[_0x4070dd]['ip']&&new Date()[_0xae7914(0x326)]()-devices[_0x4070dd][_0xae7914(0x377)][_0xae7914(0x2e5)]<devices[_0x4070dd]['telegram2FaApproval'][_0xae7914(0x26b)]*0x3c*0x3e8),_0x1eb2a5;},normalizeIP=_0x5381fc=>{const _0x1f8382=_0x27e344;let _0x476085=null,_0x428749=null;if(ipaddr[_0x1f8382(0x2a8)](_0x5381fc)){const _0x35e95b=ipaddr[_0x1f8382(0x1e6)](_0x5381fc);_0x35e95b[_0x1f8382(0x287)]()===_0x1f8382(0x28e)?(_0x35e95b['isIPv4MappedAddress']()&&(_0x476085=_0x35e95b[_0x1f8382(0x280)]()[_0x1f8382(0x249)]()),_0x428749=_0x35e95b[_0x1f8382(0x249)]()):(_0x476085=_0x35e95b[_0x1f8382(0x249)](),_0x428749=_0x35e95b[_0x1f8382(0x29a)]()[_0x1f8382(0x249)]());}return{'show':_0x476085?_0x476085:_0x428749,'store':_0x428749};};function sleep(_0x594fe5){return new Promise(_0xae5bfa=>setTimeout(_0xae5bfa,_0x594fe5));}