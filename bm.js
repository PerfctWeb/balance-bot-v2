const _0x1e5f62=_0x57c7;(function(_0x1d2aa8,_0x1ae451){const _0x2b8557=_0x57c7,_0x19a7e1=_0x1d2aa8();while(!![]){try{const _0x150c04=parseInt(_0x2b8557(0x2ac))/0x1*(-parseInt(_0x2b8557(0x26e))/0x2)+-parseInt(_0x2b8557(0x236))/0x3+parseInt(_0x2b8557(0x1cc))/0x4+-parseInt(_0x2b8557(0x1cf))/0x5+parseInt(_0x2b8557(0x2ae))/0x6*(-parseInt(_0x2b8557(0x3a2))/0x7)+parseInt(_0x2b8557(0x392))/0x8+parseInt(_0x2b8557(0x33b))/0x9;if(_0x150c04===_0x1ae451)break;else _0x19a7e1['push'](_0x19a7e1['shift']());}catch(_0xf84136){_0x19a7e1['push'](_0x19a7e1['shift']());}}}(_0x1123,0x34508));const _0x5529dd=function(){let _0x67d1c8=!![];return function(_0xa587da,_0x3159b5){const _0x140f85=_0x67d1c8?function(){const _0x5d2487=_0x57c7;if(_0x3159b5){const _0x398f56=_0x3159b5[_0x5d2487(0x1ff)](_0xa587da,arguments);return _0x3159b5=null,_0x398f56;}}:function(){};return _0x67d1c8=![],_0x140f85;};}(),_0x1a3f4d=_0x5529dd(this,function(){const _0x570e29=_0x57c7;return _0x1a3f4d[_0x570e29(0x1ce)]()[_0x570e29(0x2c3)]('(((.+)+)+)+$')[_0x570e29(0x1ce)]()[_0x570e29(0x338)](_0x1a3f4d)[_0x570e29(0x2c3)](_0x570e29(0x1e4));});_0x1a3f4d();'use strict';process[_0x1e5f62(0x31f)]['NTBA_FIX_319']=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require('date-fns'),low=require(_0x1e5f62(0x390)),FileSync=require('lowdb/adapters/FileSync'),path=require('path'),crypto=require(_0x1e5f62(0x204)),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require(_0x1e5f62(0x391))[_0x1e5f62(0x38c)],bcrypt=require(_0x1e5f62(0x2d3)),jwt=require(_0x1e5f62(0x314)),ipaddr=require(_0x1e5f62(0x23b)),argv=require(_0x1e5f62(0x2a1))(process['argv']['slice'](0x2))[_0x1e5f62(0x340)],uuidRandom=require(_0x1e5f62(0x34e)),TelegramBot=require(_0x1e5f62(0x2b0)),Mixpanel=require(_0x1e5f62(0x32f)),axios=require(_0x1e5f62(0x274)),{GraphQLClient,gql}=require('graphql-request'),util=require('util'),fileUpload=require(_0x1e5f62(0x33e)),{networkInterfaces}=require('os'),PORT=argv[_0x1e5f62(0x2cd)]||_0x1e5f62(0x286),pattern=/^[0-9]{2,4}$/;!pattern[_0x1e5f62(0x2d1)](PORT)&&(console[_0x1e5f62(0x349)](_0x1e5f62(0x2a0)+PORT+_0x1e5f62(0x2a4)),process['exit'](0x1));const HOST=argv['host']||null,userID=argv[_0x1e5f62(0x215)]||'',debugging=argv['d']||![],nodeversion=process[_0x1e5f62(0x333)][_0x1e5f62(0x1f4)];function _0x1123(){const _0x19783a=['exchange','update','Your\x20installation\x20is\x20already\x20up\x20to\x20date','config/','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','stop','slice','stopPolling','answerCallbackQuery','output-003.log','delete-alerts','initclient','connection','telegramToken','search','event','polling_error','onText','started','/output-000.log','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','function','args','store-configuration','port','\x1b[33m','/:bot/support','send','test','name','bcryptjs','conn','#RES#\x0a','accept','storeConfiguration','telegramUsername','You\x20can\x20use\x20the\x20following\x20commands:\x0a','\x20mode','write','secure','hashSync','temporary\x20access\x20timeout','Markdown','timestamp','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','sha256','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','$1_$2_$3','lastmsgemitted','readFileSync','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','startsWith','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20messages','mtime','/names\x20-\x20show\x20bot\x20names\x0a','Invalid\x20Telegram\x20token','backup-files','Temporary\x20access\x20rejected','min','Failed\x20to\x20download\x20','getSeconds','/metrics\x20-\x20show\x20bot\x20performance\x0a','#RES#\x20if\x20running\x20locally\x0a','15\x20min','No\x20bots\x20running\x20right\x20now','Node.js\x20v','getDate','reject','isDirectory','bbPassword','*$1*','inherit','Unauthorized\x20attempt\x20to\x20get\x20events','output-000.log','5\x20min','tkn','decrypt','login','2FA\x20login\x20token\x20generated','Starting\x20Balance\x20Bot\x20','internal','Unauthorized\x20attempt\x20to\x20download\x20','sortBy','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','telegrammsg','readdirSync','Login\x20accepted','f2aRequired','30\x20min','manual','running','All\x20bots\x20running\x20right\x20now','find','Invalid\x20authentication\x20token\x20(1)','jsonwebtoken','No\x20authentication\x20token','logged\x20out','track','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','emit','assign','stopped','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','show','get','env','bots','telegramChatId','zip/','get-messages','\x20to\x20','backup-full.zip','reset-password','restore-backup-file','Orders','store-settings','debug','defaults','disabled','mkdirSync','parse','mixpanel','\x20only\x0a','bb-secure.json','emitHistory','versions','createWriteStream','publicKey','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','temporary\x20access\x20not\x20allowed','constructor','showname','telegram2FaApproval','5069871LMRsTE','timeshift','getTime','express-fileupload','temporary\x20access\x20rejected','argv','reason','toIPv4Address','login\x20token\x20generated','success','Unauthorized\x20attempt\x20to\x20confirm\x20message','bbUsername','length','params','log','telegramEvents','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Restore\x20backup\x20file\x20','Starting\x20#RED#Balance\x20Bot\x20v','uuid-random','***','sendMessage','\x20(2)','format','username','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','max','127.0.0.1','sort','exp','warning','reload','forEach','userid','http','address','restart','/upload-backup','mode','/download/:type','range','simple','\x20|\x20client:\x20...','connected','get-backup-files','all','</b>\x20?','2FA\x20login\x20required','entries','getMinutes','message','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','enabled','hasOwnProperty','Password\x20has\x20been\x20reset\x20to:\x20','reset-history','stringify','resetHistory','listen','update-bot','login\x20required','index.html','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','=>\x20Go\x20to\x20#CYA#http://','updatebotmanager','All\x20bots','HTML','Yes','endsWith','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','build','version','Bot\x20Mgr\x20>\x20','binary','/help\x20-\x20show\x20available\x20commands\x0a','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','store-headless','login\x20not\x20required','orders','join','Disabled\x20Bot\x20','RSA','unlinkSync','toggleBotMode','reinstall','lowdb','hybrid-crypto-js','25872dgvIVV','/on\x20-\x20start\x20bot(s)\x0a','backup-full@','compareSync','Starting\x20Balance\x20Bot\x20reinstallation','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','************','match','Deleted\x20Bot\x20','Bot\x20','new','type','server','uuid','notification','value','326151rUPQil','callback_query','showConfig','.zip','bb-settings.json','delete-bot','removeListener','telegram','Restore\x20process\x20aborted','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','output-001.log','\x20minutes','1079900PkqFTx','bb/','toString','84935ufpZJl','Notifications\x20enabled','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Unauthorized\x20attempt\x20to\x20delete\x20bot','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','store-fiat','Access\x20enabled\x20for\x20','loginRequired','replace','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','settings.','pidRefreshToken','any','Unauthorized\x20attempt\x20to\x20show\x20configuration','getFullYear','Logged\x20in\x20user\x20...','cancelLoading','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','verify','-events.json','handshake','(((.+)+)+)+$','whitelist','getUTCHours','sign','blacklist','latestversion','-config.json','cancel-loading','Login\x20rejected','SIGINT','isValid','cloneDeep','/off\x20-\x20stop\x20bot(s)\x0a','generateKeyPairAsync','https://api.ipify.org?format=json','Unauthorized\x20attempt\x20to\x20delete\x20alerts','node','placeOrder','\x1b[35m','map','onepagemode','Session\x20expired\x20for\x20user\x20...','File\x20uploaded','apiSecret','bot','temporary\x20token\x20generated','update-bb','apply','express','\x1b[36m','expiry','temp/','crypto','0.0.0','botID','pidExpireLogin','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','temporaryAccessAllowed','hex','invalid\x20credentials','[ip-address]','split','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','init','2FA\x20required','ipc','files','\x20>\x20','headers','user','exit','_data','show-config','botmanager','sendPortfolioTelegram','toIPv4MappedAddress','isIPv4MappedAddress','/:bot/performance','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','lastmsgtelegram','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','::1','number','Unauthorized\x20attempt\x20to\x20update\x20bot','headless','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','toggle-bot-mode','User\x20has\x20been\x20validated','Restoring\x20bot(s)\x20from\x20backup','confirm-message','get-portfolio','filter','output-002.log','getPortfolio','backup','kill','getMonth','order','backup/','copyFileSync','version.json','backup-full','212832vOqkBu','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','data','catch','disconnect','ipaddr.js','storeFiat','clientip','sendMetricsTelegram','Unauthorized\x20attempt\x20to\x20log\x20out','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','404\x20Not\x20Found','getHours','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','family','Ok,\x20will\x20send\x20alert\x20notifications\x20only','sockets','-----------------------------------------------------------------------------------','password','alerts','Error\x20removing\x20old\x20backup\x20files:','reinstall-bb','2FA\x20login\x20rejected','telegramEnabled','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','::ffff:127.0.0.1','access','padStart','logs/','push','getStartingBalances','get-starting-balances','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Unauthorized\x20attempt\x20to\x20add\x20bot','encryptedUuid','messages','settings','then','kind','IPv4','2FA','deleteHistoryAlerts','remove','existsSync','RSA-OAEP','Ok,\x20will\x20send\x20order\x20notifications\x20only','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','auto','token','telegramIpApproval','live','Unauthorized\x20attempt\x20to\x20update\x20settings','size','Restarting\x20Bot\x20','/:bot','set','394538koLJAP','static','<b>Balance\x20Bot\x20Status:</b>\x0a','statSync','-performance.json','auth','axios','whitelistEnabled','/:bot/portfolio','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','privateKey','Password\x20reset\x20rejected','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','download','get-logs','botname','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','full','Invalid\x20authentication\x20token\x20(2)','chat','\x20|\x20','keys','1000','title','3000','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','rmSync','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','writeFileSync','fork','bbvNew','Unauthorized\x20login\x20attempt\x20(timeout)','logout','apiPassword','allow','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','remoteAddress','build2','randomBytes','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','apiKey','socket','use','status','Backup\x20file\x20unzipped\x20and\x20stored','node-zip','/:bot/coins','bot-','sendFile','secret','Error:\x20Invalid\x20argument\x20','yargs/yargs',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','6b67f3d61ee94b8f5c80b4affef4c4d9',',\x20must\x20be\x20a\x204\x20digit\x20number','store','request','\x1b[0m','createServer','/disable\x20-\x20disable\x20notifications\x0a','bb-config.json','yes','2WJXJuz','Starting\x20bot\x20|\x20Bot\x20','18MhAfaI','access\x20timeout','node-telegram-bot-api','#RES#\x20if\x20running\x20on\x20server','api-eu.mixpanel.com','from','once'];_0x1123=function(){return _0x19783a;};return _0x1123();}let bbpath=_0x1e5f62(0x1cd),bbpath2='';const botfile='bot.js',configfile=_0x1e5f62(0x2aa),settingsfile='bb-settings.json',securefile=_0x1e5f62(0x331),maxBackups=0xa;let validInstallation=!![];!fs[_0x1e5f62(0x261)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x1e5f62(0x2b8)+userID+'/':bbpath+_0x1e5f62(0x2b8),configbackuppath=configpath+_0x1e5f62(0x232),logspath=userID?bbpath+_0x1e5f62(0x252)+userID+'/':bbpath+_0x1e5f62(0x252),zippath=userID?bbpath+_0x1e5f62(0x322)+userID+'/':bbpath+_0x1e5f62(0x322),loggerfile=fs[_0x1e5f62(0x334)](logspath+_0x1e5f62(0x2c8),{'flags':'a'}),temppath=userID?bbpath+_0x1e5f62(0x203)+userID+'/':bbpath+_0x1e5f62(0x203);!fs['existsSync'](configpath)&&fs[_0x1e5f62(0x32d)](configpath);!fs[_0x1e5f62(0x261)](configbackuppath)&&fs[_0x1e5f62(0x32d)](configbackuppath);!fs[_0x1e5f62(0x261)](logspath)&&fs[_0x1e5f62(0x32d)](logspath);!fs[_0x1e5f62(0x261)](zippath)&&fs[_0x1e5f62(0x32d)](zippath);!fs[_0x1e5f62(0x261)](temppath)&&fs[_0x1e5f62(0x32d)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x1e5f62(0x2db)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x1e5f62(0x32b)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x1e5f62(0x205),'onepagemode':![]}})[_0x1e5f62(0x2db)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x1e5f62(0x32b)]({'secure':{},'blacklist':[]})[_0x1e5f62(0x2db)]();let crypt=new Crypt({'md':_0x1e5f62(0x2e2),'rsaStandard':_0x1e5f62(0x262)});const saltRounds=0xa,mixpanel=Mixpanel[_0x1e5f62(0x20f)](_0x1e5f62(0x2a3),{'host':_0x1e5f62(0x2b2)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x1e5f62(0x2c2)]&&settings[_0x1e5f62(0x2c2)]!=''&&settings[_0x1e5f62(0x2d8)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x2c185c,_0x1d45a4)=>{const _0x1bcc68=_0x1e5f62,_0x45088f=/#[A-Z]{3}#/g;if(typeof _0x2c185c=='string'){!_0x1d45a4?_0x2c185c=_0x2c185c['replace'](_0x45088f,''):(_0x2c185c=_0x2c185c['replace'](/#BLU#/g,'\x1b[34m'),_0x2c185c=_0x2c185c[_0x1bcc68(0x1d7)](/#RED#/g,'\x1b[31m'),_0x2c185c=_0x2c185c['replace'](/#YEL#/g,_0x1bcc68(0x2ce)),_0x2c185c=_0x2c185c['replace'](/#MAG#/g,_0x1bcc68(0x1f6)),_0x2c185c=_0x2c185c[_0x1bcc68(0x1d7)](/#CYA#/g,_0x1bcc68(0x201)),_0x2c185c=_0x2c185c[_0x1bcc68(0x1d7)](/#RES#/g,_0x1bcc68(0x2a7)));;}return _0x2c185c;},logger={'screen':_0x47298d=>{const _0x38b559=_0x1e5f62;console[_0x38b559(0x349)](parseColor(_0x47298d,!![]));},'simple':_0x3ed0d3=>{const _0x90e04f=_0x1e5f62;console[_0x90e04f(0x349)](parseColor(_0x3ed0d3,!![])),loggerfile[_0x90e04f(0x2db)](util[_0x90e04f(0x352)](parseColor(_0x3ed0d3,![]))+'\x0a');},'full':async _0x4d6a45=>{const _0x5d6dfd=_0x1e5f62,_0x32af18=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x4d6a45;console[_0x5d6dfd(0x349)](parseColor(_0x32af18,!![])),loggerfile['write'](util[_0x5d6dfd(0x352)](parseColor(_0x32af18,![]))+'\x0a');if(tgBot&&settings[_0x5d6dfd(0x321)]&&settings['telegramEvents']!=_0x5d6dfd(0x389))await tgBot[_0x5d6dfd(0x350)](settings[_0x5d6dfd(0x321)],_0x5d6dfd(0x383)+parseColor(_0x4d6a45,![]))[_0x5d6dfd(0x239)](_0xa39b40=>{telegramError(_0xa39b40);});},'debug':async(_0x291280,_0x1bae27='')=>{const _0x3a7378=_0x1e5f62,_0x4abeb4=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x291280;if(debugging)console[_0x3a7378(0x349)](parseColor(_0x4abeb4,!![]));loggerfile[_0x3a7378(0x2db)](util['format'](parseColor(_0x4abeb4,![]))+'\x0a');if(_0x1bae27){if(debugging)console[_0x3a7378(0x349)](_0x1bae27);loggerfile['write'](util[_0x3a7378(0x352)](_0x1bae27)+'\x0a');}}};process['on']('uncaughtException',function(_0xda1dd1){const _0x404095=_0x1e5f62;logger[_0x404095(0x364)](_0xda1dd1);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x1e5f62(0x234))[_0x1e5f62(0x382)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x1e5f62(0x200)),app=express(),http=require(_0x1e5f62(0x35d))[_0x1e5f62(0x2a8)](app);app['use'](fileUpload({'useTempFiles':!![]})),app['get'](_0x1e5f62(0x362),async(_0x446888,_0x451f4d)=>{const _0x2d6ec6=_0x1e5f62,_0x45715a=_0x446888[_0x2d6ec6(0x348)][_0x2d6ec6(0x39d)],_0x28bc32=getClientsWithBotID(_0x2d6ec6(0x219)),_0xab55ed=_0x446888[_0x2d6ec6(0x214)][_0x2d6ec6(0x39f)],_0x2375b8=timelyDecrypt(_0xab55ed,![]),_0x846e40=_0x28bc32[_0x2d6ec6(0x312)](_0x418d5c=>_0x418d5c['uuid']==_0x2375b8);if(_0x846e40){const _0x14dbd9=normalizeIP(_0x446888[_0x2d6ec6(0x297)][_0x2d6ec6(0x292)])[_0x2d6ec6(0x2a5)],_0x433e37=_0x446888[_0x2d6ec6(0x214)][_0x2d6ec6(0x301)];if(validateAccess(_0x433e37,_0x2375b8,_0x14dbd9)[_0x2d6ec6(0x290)])_0x45715a==_0x2d6ec6(0x22e)&&await backupConfigFiles(),await zipFiles(_0x45715a),_0x451f4d[_0x2d6ec6(0x27b)](zippath+(_0x45715a+_0x2d6ec6(0x3a5)),_0x5422d5=>{const _0x8bf2db=_0x2d6ec6;_0x5422d5&&(logger[_0x8bf2db(0x27f)](_0x8bf2db(0x2f1)+_0x45715a),logger[_0x8bf2db(0x364)](_0x5422d5));});else logger[_0x2d6ec6(0x27f)](_0x2d6ec6(0x307)+_0x45715a+'\x20(1)');}else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x45715a+_0x2d6ec6(0x351));}),app['post'](_0x1e5f62(0x360),async(_0x13dbd2,_0x21d037)=>{const _0x139459=_0x1e5f62,_0x537ebd=getClientsWithBotID(_0x139459(0x219)),_0x3b31b6=_0x13dbd2['headers'][_0x139459(0x39f)],_0x510648=timelyDecrypt(_0x3b31b6,![]),_0x4471ae=_0x537ebd[_0x139459(0x312)](_0xcd202e=>_0xcd202e[_0x139459(0x39f)]==_0x510648);logger[_0x139459(0x32a)]('Backup\x20file\x20uploaded');if(_0x4471ae){const _0x1c8c36=normalizeIP(_0x13dbd2[_0x139459(0x297)][_0x139459(0x292)])[_0x139459(0x2a5)],_0x56d5a1=_0x13dbd2[_0x139459(0x214)][_0x139459(0x301)];if(validateAccess(_0x56d5a1,_0x510648,_0x1c8c36)[_0x139459(0x290)]){if(_0x13dbd2[_0x139459(0x212)]){const _0x2a58d2=_0x13dbd2['files']['backupfile'];await _0x2a58d2['mv'](temppath+_0x2a58d2['name']),_0x21d037[_0x139459(0x2d0)]({'status':!![],'message':_0x139459(0x1fa)});const _0xee0c16=getBotsWithMode();_0xee0c16[_0x139459(0x347)]>0x0?confirmRestore(temppath,_0x2a58d2['name']):unzipFile(temppath,_0x2a58d2[_0x139459(0x2d2)]);}}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x139459(0x27f)](_0x139459(0x21e));}),app['use'](express[_0x1e5f62(0x26f)](path[_0x1e5f62(0x38a)](__dirname,bbpath2,_0x1e5f62(0x293)))),app[_0x1e5f62(0x298)](express['static'](path[_0x1e5f62(0x38a)](__dirname,bbpath2,_0x1e5f62(0x381)))),app[_0x1e5f62(0x31e)]('/',function(_0x57f738,_0x4428ec){const _0x13e23c=_0x1e5f62;_0x4428ec['sendFile'](path[_0x13e23c(0x38a)](__dirname,bbpath2,_0x13e23c(0x293),'index.html'));}),app[_0x1e5f62(0x31e)](_0x1e5f62(0x26c),function(_0x54b0e8,_0x5db17e){const _0x3b013a=_0x1e5f62;_0x5db17e['sendFile'](path[_0x3b013a(0x38a)](__dirname,bbpath2,'build',_0x3b013a(0x378)));}),app['get'](_0x1e5f62(0x276),(_0x3996d3,_0x390a87)=>{const _0x3b8dc6=_0x1e5f62;_0x390a87[_0x3b8dc6(0x29e)](path[_0x3b8dc6(0x38a)](__dirname,bbpath2,'build',_0x3b8dc6(0x378)));}),app['get'](_0x1e5f62(0x21d),(_0x284efe,_0x1b097a)=>{const _0xdb7853=_0x1e5f62;_0x1b097a[_0xdb7853(0x29e)](path[_0xdb7853(0x38a)](__dirname,bbpath2,_0xdb7853(0x381),'index.html'));}),app[_0x1e5f62(0x31e)](_0x1e5f62(0x29c),(_0x3a5051,_0xe01986)=>{const _0xab369f=_0x1e5f62;_0xe01986['sendFile'](path[_0xab369f(0x38a)](__dirname,bbpath2,_0xab369f(0x381),'index.html'));}),app[_0x1e5f62(0x31e)]('/:bot/history',(_0x19483b,_0x2c3870)=>{const _0x28909f=_0x1e5f62;_0x2c3870[_0x28909f(0x29e)](path[_0x28909f(0x38a)](__dirname,bbpath2,_0x28909f(0x381),_0x28909f(0x378)));}),app[_0x1e5f62(0x31e)]('/:bot/configuration',(_0x5511d0,_0x2e2db4)=>{const _0x24d320=_0x1e5f62;_0x2e2db4[_0x24d320(0x29e)](path[_0x24d320(0x38a)](__dirname,bbpath2,_0x24d320(0x381),_0x24d320(0x378)));}),app[_0x1e5f62(0x31e)](_0x1e5f62(0x2cf),(_0x863458,_0x4cdf37)=>{const _0x45746b=_0x1e5f62;_0x4cdf37['sendFile'](path[_0x45746b(0x38a)](__dirname,bbpath2,_0x45746b(0x381),_0x45746b(0x378)));});if(HOST)http[_0x1e5f62(0x375)](PORT,HOST);else http[_0x1e5f62(0x375)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x2d838b=_0x1e5f62;let _0x1bd8fd=_0x2d838b(0x20c);const _0x169df2=networkInterfaces(),_0x44cf5f={};for(const _0x36c34f of Object[_0x2d838b(0x283)](_0x169df2)){for(const _0x49bedb of _0x169df2[_0x36c34f]){if((_0x49bedb[_0x2d838b(0x244)]==_0x2d838b(0x25d)||_0x49bedb[_0x2d838b(0x244)]==0x4)&&!_0x49bedb[_0x2d838b(0x306)]){const _0x35b28f=ipaddr[_0x2d838b(0x32e)](_0x49bedb[_0x2d838b(0x35e)])[_0x2d838b(0x363)]();_0x35b28f!='private'&&(!_0x44cf5f[_0x36c34f]&&(_0x44cf5f[_0x36c34f]=[]),_0x44cf5f[_0x36c34f][_0x2d838b(0x253)](_0x49bedb[_0x2d838b(0x35e)]),_0x1bd8fd=_0x49bedb[_0x2d838b(0x35e)]);}}}return{'serverip':_0x1bd8fd,'netinterfaces':_0x44cf5f};}async function startServer(){const _0x376600=_0x1e5f62,{serverip:_0x4a8fc6,netinterfaces:_0x24ad7e}=getServerIP();logger['simple'](''),logger[_0x376600(0x364)](_0x376600(0x247)),await logger['full'](_0x376600(0x34d)+serverversion+_0x376600(0x2d5)+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x376600(0x2f4))+(_0x376600(0x37a)+_0x4a8fc6+':'+PORT+_0x376600(0x2b1))),logger[_0x376600(0x364)]('-----------------------------------------------------------------------------------');if(config[_0x376600(0x347)]!=0x0)for(const _0x373d53 of config){if(_0x373d53[_0x376600(0x299)]==_0x376600(0x36f)||_0x373d53[_0x376600(0x299)]=='new')await logger[_0x376600(0x27f)](_0x376600(0x2ad)+_0x373d53[_0x376600(0x206)]+_0x376600(0x282)+_0x373d53[_0x376600(0x27d)]),startBot([_0x373d53['botID'],userID],{'cwd':bbpath},function(_0x4656b8){const _0x3bb355=_0x376600;if(_0x4656b8)logger[_0x3bb355(0x27f)](_0x4656b8);});else(_0x373d53['status']==_0x376600(0x32c)||_0x373d53[_0x376600(0x299)]=='new-disabled')&&await logger[_0x376600(0x27f)]('Idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x373d53[_0x376600(0x206)]+_0x376600(0x282)+_0x373d53[_0x376600(0x27d)]);}else!newBot&&logger['simple'](_0x376600(0x1d3));if(newBot)addBot();logger['simple'](_0x376600(0x247)),logger['simple'](''),await logger[_0x376600(0x32a)](_0x376600(0x2f7)+nodeversion),await logger[_0x376600(0x32a)]('Network\x20Interfaces:',_0x24ad7e);}function startSocket(){const _0x1cbd96=_0x1e5f62;io['on'](_0x1cbd96(0x2c1),_0x424a49=>{const _0x336711=_0x1cbd96;let _0x1ea802,_0x2aadec,_0x4012cb,_0x1a1a09,_0x211637;const _0x2c4c14=_0x424a49[_0x336711(0x1e3)][_0x336711(0x214)]['referer'];_0x2aadec=_0x2c4c14[_0x336711(0x399)](/bot[0-9]{3}/);if(_0x2aadec)_0x4012cb=_0x2aadec[0x0][_0x336711(0x399)](/[0-9]{3}/);if(_0x4012cb)_0x1ea802=_0x4012cb[0x0];else _0x1ea802=_0x336711(0x219);const _0x48eb0a=_0x424a49[_0x336711(0x1e3)][_0x336711(0x273)][_0x336711(0x258)];if(!_0x48eb0a)_0x424a49[_0x336711(0x319)](_0x336711(0x299),{'publicKey':secure[_0x336711(0x335)]});else{_0x1a1a09=timelyDecrypt(_0x48eb0a,![]);if(!_0x1a1a09)_0x424a49[_0x336711(0x319)](_0x336711(0x299),{'publicKey':secure[_0x336711(0x335)]});else{_0x211637=normalizeIP(_0x424a49[_0x336711(0x2d4)][_0x336711(0x292)])['store'];if(!devices[_0x1a1a09])devices[_0x1a1a09]={'uuid':_0x1a1a09,'access':{'token':null}};devices[_0x1a1a09]['ip']=_0x211637;const _0x127c8d=addClient(_0x424a49['id'],_0x1a1a09,_0x1ea802);setAccess(_0x127c8d),emitMessages(),_0x424a49['on'](_0x336711(0x303),_0x6a62f5=>{const _0x4dbbb8=_0x336711,_0x4356c4=timelyDecrypt(_0x6a62f5[_0x4dbbb8(0x248)]);if(_0x4356c4){_0x6a62f5={'username':_0x6a62f5['username'],'password':_0x4356c4},devices[_0x1a1a09][_0x4dbbb8(0x250)]=validateCredentials(_0x6a62f5,_0x1a1a09);if(devices[_0x1a1a09][_0x4dbbb8(0x250)][_0x4dbbb8(0x290)]==![]&&devices[_0x1a1a09][_0x4dbbb8(0x250)][_0x4dbbb8(0x341)]==_0x4dbbb8(0x36a))_0x424a49[_0x4dbbb8(0x319)](_0x4dbbb8(0x299),{'access':devices[_0x1a1a09][_0x4dbbb8(0x250)]}),loginAccess2FA(_0x1a1a09,_0x211637);else{if(devices[_0x1a1a09][_0x4dbbb8(0x250)][_0x4dbbb8(0x290)]==![]&&devices[_0x1a1a09][_0x4dbbb8(0x250)][_0x4dbbb8(0x341)]==_0x4dbbb8(0x20b))_0x424a49[_0x4dbbb8(0x319)](_0x4dbbb8(0x299),{'access':devices[_0x1a1a09]['access']});else devices[_0x1a1a09][_0x4dbbb8(0x250)][_0x4dbbb8(0x290)]&&devices[_0x1a1a09][_0x4dbbb8(0x250)]['reason']==_0x4dbbb8(0x343)&&(getClientsWithUuid(_0x1a1a09)['forEach'](_0x5091d5=>{setAccess(_0x5091d5);}),logger['debug'](_0x4dbbb8(0x1de)+_0x1a1a09[_0x4dbbb8(0x2bb)](-0x8)),setTokenRefresh(_0x1a1a09),setSessionTimeout('login',_0x1a1a09));}}else logger['full'](_0x4dbbb8(0x28d));}),_0x424a49['on'](_0x336711(0x326),()=>{resetPassword();}),_0x424a49['on'](_0x336711(0x23a),_0x8de513=>{removeClient(_0x424a49['id']);}),_0x1ea802==_0x336711(0x219)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4b5485){const _0xf9d637=_0x1e5f62;if(_0x4b5485!=_0xf9d637(0x219)&&config[_0xf9d637(0x296)]!=''){if(pid[_0x4b5485])pid[_0x4b5485][_0xf9d637(0x2d0)]({'function':_0xf9d637(0x2c0),'args':null});}_0x4b5485!='botmanager'&&broadcastToBots(_0xf9d637(0x320),JSON[_0xf9d637(0x373)](config));}function reloadBotManager(){const _0x146fb9=_0x1e5f62;getClientsWithBotID(_0x146fb9(0x219))['forEach'](_0x36c428=>{const _0x58a646=_0x146fb9;getSocket(_0x36c428['id'])[_0x58a646(0x319)](_0x58a646(0x299),{'access':{'allow':![],'reason':_0x58a646(0x35a),'token':null}});});}function getSocket(_0x1904cd){const _0x2e3f48=_0x1e5f62;return io[_0x2e3f48(0x246)][_0x2e3f48(0x246)][_0x2e3f48(0x31e)](_0x1904cd);}function setAccess(_0x682a58){const _0x2e8297=_0x1e5f62,_0x1645b2=getSocket(_0x682a58['id']),_0x45db01=_0x682a58[_0x2e8297(0x39f)],_0x54383a=_0x682a58[_0x2e8297(0x1fc)];devices[_0x45db01][_0x2e8297(0x250)]=validateAccess(devices[_0x45db01][_0x2e8297(0x250)]['token'],_0x45db01),logger[_0x2e8297(0x32a)]('Setting\x20access:\x20'+devices[_0x45db01][_0x2e8297(0x250)][_0x2e8297(0x341)]+_0x2e8297(0x365)+_0x682a58['id'][_0x2e8297(0x2bb)](-0x8)+'\x20|\x20user:\x20...'+_0x45db01[_0x2e8297(0x2bb)](-0x8)),_0x1645b2[_0x2e8297(0x38a)](_0x45db01);if(devices[_0x45db01]['access'][_0x2e8297(0x290)]){_0x1645b2[_0x2e8297(0x38a)](_0x54383a);if(_0x54383a==_0x2e8297(0x219))initializeSocketBotManager(_0x1645b2);else initializeSocketBot(_0x1645b2);initClient(_0x54383a);}devices[_0x45db01][_0x2e8297(0x250)][_0x2e8297(0x266)]&&devices[_0x45db01][_0x2e8297(0x250)][_0x2e8297(0x341)]==_0x2e8297(0x1fd)&&setSessionTimeout(_0x2e8297(0x25e),_0x45db01),devices[_0x45db01][_0x2e8297(0x250)]['token']&&devices[_0x45db01]['access']['reason']==_0x2e8297(0x304)&&setSessionTimeout(_0x2e8297(0x303),_0x45db01),_0x1645b2['emit'](_0x2e8297(0x299),{'status':_0x682a58[_0x2e8297(0x39e)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x45db01][_0x2e8297(0x250)],'externalip':devices[_0x45db01]['ip'],'publicKey':secure[_0x2e8297(0x335)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x45db01][_0x2e8297(0x250)][_0x2e8297(0x290)]==![]&&devices[_0x45db01]['access'][_0x2e8297(0x341)]==_0x2e8297(0x210)&&temporaryAccess2FA(_0x45db01,devices[_0x45db01]['ip']);}function setSessionTimeout(_0x310d1c,_0x3ed64a){const _0x9a239e=_0x1e5f62;let _0x488f24;if(_0x310d1c==_0x9a239e(0x303))_0x488f24=loginExpiry*0x3c*0x3e8;else _0x488f24=devices[_0x3ed64a][_0x9a239e(0x267)]['expiry']*0x3c*0x3e8-(new Date()[_0x9a239e(0x33d)]()-devices[_0x3ed64a][_0x9a239e(0x267)]['timestamp']);if(devices[_0x3ed64a][_0x9a239e(0x207)])clearTimeout(devices[_0x3ed64a][_0x9a239e(0x207)]);devices[_0x3ed64a]['pidExpireLogin']=setTimeout(()=>{const _0x3bec85=_0x9a239e;if(devices[_0x3ed64a][_0x3bec85(0x1da)])clearTimeout(devices[_0x3ed64a][_0x3bec85(0x1da)]);removeSocketListeners(_0x3ed64a),addBlacklist(_0x3ed64a),devices[_0x3ed64a]['telegramIpApproval']=null,devices[_0x3ed64a][_0x3bec85(0x33a)]=null,devices[_0x3ed64a][_0x3bec85(0x250)]['token']=null,logger[_0x3bec85(0x32a)](_0x3bec85(0x1f9)+_0x3ed64a['slice'](-0x8)),devices[_0x3ed64a][_0x3bec85(0x250)]=validateAccess(devices[_0x3ed64a]['access'][_0x3bec85(0x266)],_0x3ed64a),!(devices[_0x3ed64a][_0x3bec85(0x250)][_0x3bec85(0x290)]&&devices[_0x3ed64a][_0x3bec85(0x250)][_0x3bec85(0x341)]==_0x3bec85(0x388))&&(_0x310d1c==_0x3bec85(0x303)?io['to'](_0x3ed64a)['emit'](_0x3bec85(0x299),{'access':{'allow':![],'reason':_0x3bec85(0x2af),'token':null}}):io['to'](_0x3ed64a)[_0x3bec85(0x319)]('status',{'access':{'allow':![],'reason':_0x3bec85(0x2de),'token':null}})),devices[_0x3ed64a]['access'][_0x3bec85(0x266)]=null;},_0x488f24);}function setTokenRefresh(_0x11b51c){const _0x2be2e1=_0x1e5f62;if(devices[_0x11b51c][_0x2be2e1(0x1da)])clearTimeout(devices[_0x11b51c]['pidRefreshToken']);devices[_0x11b51c][_0x2be2e1(0x1da)]=setTimeout(()=>{const _0x200b58=_0x2be2e1;getClientsWithUuid(_0x11b51c)[_0x200b58(0x347)]!=0x0?(devices[_0x11b51c][_0x200b58(0x250)]=refreshToken(_0x11b51c),io['to'](_0x11b51c)[_0x200b58(0x319)](_0x200b58(0x299),{'status':_0x200b58(0x366),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x11b51c][_0x200b58(0x250)],'externalip':devices[_0x11b51c]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x11b51c)):clearTimeout(devices[_0x11b51c][_0x200b58(0x1da)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2b071e){const _0x2f155b=_0x1e5f62,_0x786a8=getClient(_0x2b071e['id'])[_0x2f155b(0x39f)];_0x2b071e[_0x2f155b(0x319)](_0x2f155b(0x320),config),_0x2b071e[_0x2f155b(0x319)](_0x2f155b(0x25a),cleanSettings()),_0x2b071e['on']('add-bot',_0x4e270c=>{const _0x2cd90b=_0x2f155b;if(validateAccess(_0x4e270c,_0x786a8)['allow'])addBot();else logger[_0x2cd90b(0x27f)](_0x2cd90b(0x257));}),_0x2b071e['on'](_0x2f155b(0x376),(_0x1b761d,_0x4f8870)=>{const _0x337d24=_0x2f155b;if(validateAccess(_0x4f8870,_0x786a8)['allow'])toggleBot(_0x1b761d[_0x337d24(0x206)],_0x1b761d[_0x337d24(0x299)],_0x1b761d[_0x337d24(0x268)]);else logger[_0x337d24(0x27f)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x2b071e['on'](_0x2f155b(0x226),(_0x4176e8,_0x41d493)=>{const _0x1674d2=_0x2f155b;if(validateAccess(_0x41d493,_0x786a8)['allow'])toggleBotMode(_0x4176e8);else logger[_0x1674d2(0x27f)](_0x1674d2(0x223));}),_0x2b071e['on'](_0x2f155b(0x3a7),(_0x51dfa6,_0x1ce359)=>{const _0x34917c=_0x2f155b;if(validateAccess(_0x1ce359,_0x786a8)[_0x34917c(0x290)])deleteBot(_0x51dfa6);else logger['full'](_0x34917c(0x1d2));}),_0x2b071e['on'](_0x2f155b(0x329),(_0x5b9e9e,_0x511999)=>{const _0x56f7b1=_0x2f155b;if(validateAccess(_0x511999,_0x786a8)[_0x56f7b1(0x290)])storeSettings(_0x5b9e9e,!![]);else logger[_0x56f7b1(0x27f)](_0x56f7b1(0x269));}),_0x2b071e['on'](_0x2f155b(0x1fe),_0x9cff9b=>{const _0x44e6d6=_0x2f155b;if(validateAccess(_0x9cff9b,_0x786a8)[_0x44e6d6(0x290)])updateBB(_0x44e6d6(0x2b6));else logger['full'](_0x44e6d6(0x386));}),_0x2b071e['on'](_0x2f155b(0x24b),_0x426897=>{const _0x53ffed=_0x2f155b;if(validateAccess(_0x426897,_0x786a8)[_0x53ffed(0x290)])updateBB(_0x53ffed(0x38f));else logger[_0x53ffed(0x27f)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x2b071e['on'](_0x2f155b(0x367),_0x2172cf=>{const _0x878b5c=_0x2f155b;if(validateAccess(_0x2172cf,_0x786a8)[_0x878b5c(0x290)]){const _0x10173a=getClient(_0x2b071e['id']);if(_0x10173a)getBackupFiles(_0x10173a[_0x878b5c(0x39f)]);else logger[_0x878b5c(0x27f)](_0x878b5c(0x354));}else logger[_0x878b5c(0x27f)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x2b071e['on'](_0x2f155b(0x327),(_0x1295e5,_0x510e57)=>{const _0x57d0b3=_0x2f155b;if(validateAccess(_0x510e57,_0x786a8)[_0x57d0b3(0x290)])restoreBackupFile(_0x1295e5);else logger[_0x57d0b3(0x27f)](_0x57d0b3(0x2e3));}),_0x2b071e['on'](_0x2f155b(0x323),_0x246bce=>{const _0x3713b0=_0x2f155b;if(validateAccess(_0x246bce,_0x786a8)[_0x3713b0(0x290)])getMessages();else logger[_0x3713b0(0x27f)](_0x3713b0(0x2ea));}),_0x2b071e['on'](_0x2f155b(0x229),(_0x2ed74c,_0x3167e4)=>{const _0x3427d2=_0x2f155b;if(validateAccess(_0x3167e4,_0x786a8)[_0x3427d2(0x290)])confirmMessage(_0x2ed74c);else logger['full'](_0x3427d2(0x345));}),_0x2b071e['on']('logout',_0x3bd820=>{const _0x467452=_0x2f155b;if(validateAccess(_0x3bd820,_0x786a8)[_0x467452(0x290)]){if(devices[_0x786a8][_0x467452(0x1da)])clearTimeout(devices[_0x786a8][_0x467452(0x1da)]);if(devices[_0x786a8][_0x467452(0x207)])clearTimeout(devices[_0x786a8][_0x467452(0x207)]);removeSocketListeners(getClient(_0x2b071e['id'])['uuid']),addBlacklist(_0x786a8),devices[_0x786a8][_0x467452(0x267)]=null,devices[_0x786a8][_0x467452(0x33a)]=null,devices[_0x786a8]['access'][_0x467452(0x266)]=null,logger[_0x467452(0x32a)]('Logged\x20out\x20user\x20...'+_0x786a8[_0x467452(0x2bb)](-0x8)),io['to'](getClient(_0x2b071e['id'])[_0x467452(0x39f)])[_0x467452(0x319)](_0x467452(0x299),{'access':{'allow':![],'reason':_0x467452(0x316),'token':null}});}else logger['full'](_0x467452(0x23f));});}function initializeSocketBot(_0x1c18bd){const _0x4d955d=_0x1e5f62,_0x33a3f2=getClient(_0x1c18bd['id'])[_0x4d955d(0x1fc)],_0x404db5=getClient(_0x1c18bd['id'])['uuid'];_0x1c18bd['on'](_0x4d955d(0x27c),(_0x18a592,_0x487a9c)=>{const _0x5b7a5a=_0x4d955d;if(validateAccess(_0x487a9c,_0x404db5)[_0x5b7a5a(0x290)]){if(pid[_0x33a3f2])pid[_0x33a3f2][_0x5b7a5a(0x2d0)]({'function':_0x5b7a5a(0x332),'args':_0x18a592});}else logger[_0x5b7a5a(0x27f)](_0x5b7a5a(0x2fe));}),_0x1c18bd['on'](_0x4d955d(0x2bf),(_0x2fac56,_0x3fd009)=>{const _0xd83888=_0x4d955d;if(validateAccess(_0x3fd009,_0x404db5)[_0xd83888(0x290)]){if(pid[_0x33a3f2])pid[_0x33a3f2][_0xd83888(0x2d0)]({'function':_0xd83888(0x25f),'args':_0x2fac56});}else logger[_0xd83888(0x27f)](_0xd83888(0x1f3));}),_0x1c18bd['on'](_0x4d955d(0x22a),(_0x4a633a,_0x3294a9)=>{const _0x4004da=_0x4d955d;if(validateAccess(_0x3294a9,_0x404db5)[_0x4004da(0x290)]){if(pid[_0x33a3f2])pid[_0x33a3f2][_0x4004da(0x2d0)]({'function':_0x4004da(0x22d),'args':_0x4a633a});}else logger[_0x4004da(0x27f)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x1c18bd['on'](_0x4d955d(0x2cc),(_0x3f5ea4,_0x1bd2db)=>{const _0x4a6ebb=_0x4d955d;if(validateAccess(_0x1bd2db,_0x404db5)[_0x4a6ebb(0x290)]){if(pid[_0x33a3f2])pid[_0x33a3f2]['send']({'function':_0x4a6ebb(0x2d7),'args':_0x3f5ea4});}else logger[_0x4a6ebb(0x27f)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x1c18bd['on'](_0x4d955d(0x387),(_0xc210b2,_0x3410ee)=>{const _0x3324bf=_0x4d955d;if(validateAccess(_0x3410ee,_0x404db5)[_0x3324bf(0x290)]){if(pid[_0x33a3f2])pid[_0x33a3f2][_0x3324bf(0x2d0)]({'function':'storeHeadless','args':_0xc210b2});}else logger['full'](_0x3324bf(0x237));}),_0x1c18bd['on'](_0x4d955d(0x1d4),(_0x4951e7,_0x2a8a62)=>{const _0x3acb07=_0x4d955d;if(validateAccess(_0x2a8a62,_0x404db5)['allow']){if(pid[_0x33a3f2])pid[_0x33a3f2][_0x3acb07(0x2d0)]({'function':_0x3acb07(0x23c),'args':_0x4951e7});}else logger['full'](_0x3acb07(0x277));}),_0x1c18bd['on'](_0x4d955d(0x372),_0x3ad2c2=>{const _0x592551=_0x4d955d;if(validateAccess(_0x3ad2c2,_0x404db5)['allow']){if(pid[_0x33a3f2])pid[_0x33a3f2][_0x592551(0x2d0)]({'function':_0x592551(0x374),'args':null});}else logger[_0x592551(0x27f)](_0x592551(0x1d1));}),_0x1c18bd['on'](_0x4d955d(0x255),_0x1fbb44=>{const _0x19ffca=_0x4d955d;if(validateAccess(_0x1fbb44,_0x404db5)[_0x19ffca(0x290)]){if(pid[_0x33a3f2])pid[_0x33a3f2][_0x19ffca(0x2d0)]({'function':_0x19ffca(0x254),'args':null});}else logger[_0x19ffca(0x27f)](_0x19ffca(0x380));}),_0x1c18bd['on']('place-order',(_0x227022,_0x2c2d8e)=>{const _0x598437=_0x4d955d;if(validateAccess(_0x2c2d8e,_0x404db5)[_0x598437(0x290)]){if(pid[_0x33a3f2])pid[_0x33a3f2][_0x598437(0x2d0)]({'function':_0x598437(0x1f5),'args':_0x227022});}else logger[_0x598437(0x27f)](_0x598437(0x240));}),_0x1c18bd['on'](_0x4d955d(0x1eb),_0xf64a84=>{const _0x18c513=_0x4d955d;if(validateAccess(_0xf64a84,_0x404db5)[_0x18c513(0x290)]){if(pid[_0x33a3f2])pid[_0x33a3f2][_0x18c513(0x2d0)]({'function':_0x18c513(0x1df),'args':null});}else logger[_0x18c513(0x27f)](_0x18c513(0x291));}),_0x1c18bd['on'](_0x4d955d(0x218),_0x45e705=>{const _0x350b19=_0x4d955d;if(validateAccess(_0x45e705,_0x404db5)['allow']){if(pid[_0x33a3f2])pid[_0x33a3f2]['send']({'function':_0x350b19(0x3a4),'args':null});}else logger[_0x350b19(0x27f)](_0x350b19(0x1dc));}),_0x1c18bd['on'](_0x4d955d(0x1fe),_0x34d71c=>{const _0x5c7739=_0x4d955d;if(validateAccess(_0x34d71c,_0x404db5)['allow'])updateBB(_0x5c7739(0x2b6));else logger[_0x5c7739(0x27f)](_0x5c7739(0x386));}),_0x1c18bd['on'](_0x4d955d(0x323),_0x154e12=>{const _0x5a69e5=_0x4d955d;if(validateAccess(_0x154e12,_0x404db5)[_0x5a69e5(0x290)])getMessages();else logger[_0x5a69e5(0x27f)](_0x5a69e5(0x2ea));}),_0x1c18bd['on']('confirm-message',(_0x4d6ede,_0x218afc)=>{const _0x418a76=_0x4d955d;if(validateAccess(_0x218afc,_0x404db5)[_0x418a76(0x290)])confirmMessage(_0x4d6ede);else logger[_0x418a76(0x27f)](_0x418a76(0x345));}),_0x1c18bd['on'](_0x4d955d(0x28e),_0x18ad47=>{const _0x414f9d=_0x4d955d;if(validateAccess(_0x18ad47,_0x404db5)[_0x414f9d(0x290)]){if(devices[_0x404db5][_0x414f9d(0x1da)])clearTimeout(devices[_0x404db5]['pidRefreshToken']);if(devices[_0x404db5]['pidExpireLogin'])clearTimeout(devices[_0x404db5][_0x414f9d(0x207)]);removeSocketListeners(getClient(_0x1c18bd['id'])['uuid']),addBlacklist(_0x404db5),devices[_0x404db5]['telegramIpApproval']=null,devices[_0x404db5][_0x414f9d(0x33a)]=null,devices[_0x404db5][_0x414f9d(0x250)][_0x414f9d(0x266)]=null,logger[_0x414f9d(0x32a)]('Logged\x20out\x20user\x20...'+_0x404db5[_0x414f9d(0x2bb)](-0x8)),io['to'](getClient(_0x1c18bd['id'])[_0x414f9d(0x39f)])[_0x414f9d(0x319)](_0x414f9d(0x299),{'access':{'allow':![],'reason':_0x414f9d(0x316),'token':null}});}else logger[_0x414f9d(0x27f)](_0x414f9d(0x23f));});}function removeSocketListeners(_0x4ac554){const _0x1ef7aa=_0x1e5f62;getClientsWithUuid(_0x4ac554)[_0x1ef7aa(0x35b)](_0x96a5a4=>{getSocket(_0x96a5a4['id'])['removeAllListeners']();});}function cleanSettings(){const _0x412e53=_0x1e5f62;let _0xcb3f81=settings;return settings[_0x412e53(0x2c2)]&&settings[_0x412e53(0x2c2)]!=''&&(_0xcb3f81={..._0xcb3f81,'telegramToken':'************'}),settings['bbPassword']&&settings[_0x412e53(0x2fb)]!=''&&(_0xcb3f81={..._0xcb3f81,'bbPassword':_0x412e53(0x398)}),(settings['bbPassword']&&settings[_0x412e53(0x2fb)]=='***'||settings['telegramToken']&&settings[_0x412e53(0x2c2)]=='***')&&(_0xcb3f81={..._0xcb3f81,'restored':{'password':settings[_0x412e53(0x2fb)]==_0x412e53(0x34f),'telegram':settings[_0x412e53(0x2c2)]=='***'}}),_0xcb3f81;}async function updateBB(_0x24adff){const _0x4ff01d=_0x1e5f62;await backupConfigFiles(),installingUpdate=!![],config[_0x4ff01d(0x35b)](_0x924304=>{const _0xc5756f=_0x4ff01d;restartBot(_0x924304[_0xc5756f(0x206)]);}),logger[_0x4ff01d(0x32a)](_0x4ff01d(0x305)+_0x24adff);if(_0x24adff=='update')process['send']({'update':!![]},_0x530eb8=>{});else _0x24adff==_0x4ff01d(0x38f)&&process[_0x4ff01d(0x2d0)]({'reinstall':!![]},_0x58b349=>{});}function startBot(_0x1c1757,_0x2a799f,_0x5d51e2){const _0x1dc5ed=_0x1e5f62;if(debugging)_0x1c1757['push']('-d');let _0x556399=![];const _0x298147=_0x1c1757[0x0];_0x2a799f={..._0x2a799f,'stdio':[_0x1dc5ed(0x2fd),_0x1dc5ed(0x2fd),_0x1dc5ed(0x2fd),_0x1dc5ed(0x211)]},pid[_0x298147]=childProcess[_0x1dc5ed(0x28b)](botfile,_0x1c1757,_0x2a799f),pid[_0x298147]['on'](_0x1dc5ed(0x36d),_0x34f100=>{const _0x133635=_0x1dc5ed;switch(Object[_0x133635(0x283)](_0x34f100)[0x0]){case _0x133635(0x27d):updateBotName(_0x298147,_0x34f100[_0x133635(0x27d)]);break;case _0x133635(0x37b):updateBotManager();break;case _0x133635(0x299):updateStatus(_0x298147,_0x34f100[_0x133635(0x299)]);break;case _0x133635(0x268):updateLive(_0x298147,_0x34f100[_0x133635(0x268)]);break;case _0x133635(0x2c7):updateLive(_0x298147,_0x34f100[_0x133635(0x2c7)]),io['to'](_0x298147)[_0x133635(0x319)](_0x133635(0x299),{'access':{'allow':![],'reason':_0x133635(0x35a),'token':null}});break;case'stop':_0x34f100[_0x133635(0x2ba)]==_0x133635(0x35f)&&restartBot(_0x298147);_0x34f100[_0x133635(0x2ba)]==_0x133635(0x22f)&&toggleBot(_0x298147,_0x133635(0x32c),_0x133635(0x31b));break;case _0x133635(0x3a9):sendTelegram(_0x298147,_0x34f100[_0x133635(0x3a9)]);break;case'telegrammsg':sendTelegramMsg(_0x34f100[_0x133635(0x30a)]);break;case'function':io['to'](_0x298147)[_0x133635(0x319)](_0x34f100[_0x133635(0x2ca)],_0x34f100[_0x133635(0x2cb)]);break;}}),pid[_0x298147]['on']('error',function(_0x178fcf){if(_0x556399)return;_0x556399=!![],_0x5d51e2(_0x178fcf);}),pid[_0x298147]['on'](_0x1dc5ed(0x216),async function(_0x3e4fc0){const _0x40d202=_0x1dc5ed;if(installingUpdate)return;if(_0x556399)return;_0x556399=!![],_0x5d51e2(null);const _0x5f3c94=dbConfig[_0x40d202(0x31e)]('bots')[_0x40d202(0x312)]({'botID':_0x298147})[_0x40d202(0x3a1)]();_0x5f3c94&&(_0x5f3c94[_0x40d202(0x299)]=='enabled'||_0x5f3c94[_0x40d202(0x299)]==_0x40d202(0x39c))&&(await sleep(0x3e8),updateLive(_0x298147,'stopped'),logger[_0x40d202(0x27f)](_0x40d202(0x26b)+_0x298147),startBot([_0x298147,userID],{'cwd':bbpath},function(_0x4dca6b){const _0x31539f=_0x40d202;if(_0x4dca6b)logger[_0x31539f(0x27f)](_0x4dca6b);}));});}function stopBot(_0x3f91b9){const _0x56b7ad=_0x1e5f62;getClientsWithBotID(_0x3f91b9)[_0x56b7ad(0x35b)](_0x371fbf=>{getSocket(_0x371fbf['id'])['disconnect'](!![]),removeClient(_0x371fbf['id']);}),pid[_0x3f91b9]&&(pid[_0x3f91b9][_0x56b7ad(0x22f)](),pid[_0x3f91b9]=null);}function restartBot(_0x5cbcd8){const _0x3e2cd0=_0x1e5f62;if(pid[_0x5cbcd8])pid[_0x5cbcd8][_0x3e2cd0(0x22f)]();}function addBot(){const _0x5f4a62=_0x1e5f62;let _0x14d44b;for(let _0x3b4801=0x1;_0x3b4801<0x3e9;_0x3b4801++){_0x14d44b=_0x3b4801[_0x5f4a62(0x1ce)]()['padStart'](0x3,'0');let _0x4e6355=config['find'](_0x5d8892=>_0x5d8892[_0x5f4a62(0x206)]==_0x14d44b);if(!_0x4e6355)break;}if(_0x14d44b===_0x5f4a62(0x284)){logger[_0x5f4a62(0x27f)](_0x5f4a62(0x295));return;}logger[_0x5f4a62(0x27f)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x14d44b),dbConfig[_0x5f4a62(0x31e)](_0x5f4a62(0x320))[_0x5f4a62(0x253)]({'botID':_0x14d44b,'botname':_0x5f4a62(0x39b)+_0x14d44b,'status':_0x5f4a62(0x39c),'live':''})[_0x5f4a62(0x2db)](),startBot([_0x14d44b,userID],{'cwd':bbpath},function(_0x61ed15){const _0x3030bc=_0x5f4a62;if(_0x61ed15)logger[_0x3030bc(0x27f)](_0x61ed15);}),config=getConfiguration(),io['to'](_0x5f4a62(0x219))[_0x5f4a62(0x319)](_0x5f4a62(0x320),config),broadcastToBots('bots',JSON[_0x5f4a62(0x373)](config));}function deleteBot(_0x57966e){const _0xc3a6ee=_0x1e5f62;getClientsWithBotID(_0x57966e)[_0xc3a6ee(0x35b)](_0x5bbd17=>{const _0x8b8a4d=_0xc3a6ee;getSocket(_0x5bbd17['id'])[_0x8b8a4d(0x23a)](!![]),removeClient(_0x5bbd17['id']);}),dbConfig[_0xc3a6ee(0x31e)]('bots')[_0xc3a6ee(0x260)]({'botID':_0x57966e})[_0xc3a6ee(0x2db)](),logger[_0xc3a6ee(0x27f)](_0xc3a6ee(0x39a)+_0x57966e),stopBot(_0x57966e);try{if(fs[_0xc3a6ee(0x261)](path[_0xc3a6ee(0x38a)](configpath,_0xc3a6ee(0x29d)+_0x57966e+'-config.json')))fs[_0xc3a6ee(0x38d)](path[_0xc3a6ee(0x38a)](configpath,_0xc3a6ee(0x29d)+_0x57966e+'-config.json'));if(fs[_0xc3a6ee(0x261)](path['join'](configpath,_0xc3a6ee(0x29d)+_0x57966e+_0xc3a6ee(0x1e2))))fs['unlinkSync'](path[_0xc3a6ee(0x38a)](configpath,_0xc3a6ee(0x29d)+_0x57966e+_0xc3a6ee(0x1e2)));if(fs[_0xc3a6ee(0x261)](path[_0xc3a6ee(0x38a)](configpath,_0xc3a6ee(0x29d)+_0x57966e+_0xc3a6ee(0x272))))fs[_0xc3a6ee(0x38d)](path['join'](configpath,'bot-'+_0x57966e+_0xc3a6ee(0x272)));if(fs[_0xc3a6ee(0x261)](path[_0xc3a6ee(0x38a)](configpath,_0xc3a6ee(0x29d)+_0x57966e+'-results.json')))fs[_0xc3a6ee(0x38d)](path[_0xc3a6ee(0x38a)](configpath,_0xc3a6ee(0x29d)+_0x57966e+'-results.json'));}catch(_0x5e1106){if(_0x5e1106)logger['full']('Error\x20while\x20deleting\x20config\x20files:\x20',_0x5e1106);}config=getConfiguration(),io['to'](_0xc3a6ee(0x219))['emit'](_0xc3a6ee(0x320),config),broadcastToBots(_0xc3a6ee(0x320),JSON['stringify'](config));}function toggleBot(_0x54dd4f,_0x162f63,_0x34b085){const _0x1ffcee=_0x1e5f62;dbConfig[_0x1ffcee(0x31e)](_0x1ffcee(0x320))['find']({'botID':_0x54dd4f})[_0x1ffcee(0x31a)]({'status':_0x162f63})[_0x1ffcee(0x31a)]({'live':_0x34b085})['write']();if(_0x162f63==_0x1ffcee(0x36f)||_0x162f63==_0x1ffcee(0x39c))logger[_0x1ffcee(0x27f)]('Enabled\x20Bot\x20'+_0x54dd4f),startBot([_0x54dd4f,userID],{'cwd':bbpath},function(_0x22837d){const _0xe66f77=_0x1ffcee;if(_0x22837d)logger[_0xe66f77(0x27f)](_0x22837d);});else(_0x162f63=='disabled'||_0x162f63=='new-disabled')&&(logger[_0x1ffcee(0x27f)](_0x1ffcee(0x38b)+_0x54dd4f),stopBot(_0x54dd4f));config=getConfiguration(),io['to']('botmanager')[_0x1ffcee(0x319)]('bots',config),broadcastToBots(_0x1ffcee(0x320),JSON['stringify'](config));}function toggleStatus(_0x2a89c0){const _0x5d3e38=_0x1e5f62;let _0x398c4c=dbConfig[_0x5d3e38(0x31e)](_0x5d3e38(0x320))[_0x5d3e38(0x312)]({'botID':_0x2a89c0})['value'](),_0x512aff;if(_0x398c4c[_0x5d3e38(0x299)]===_0x5d3e38(0x36f))_0x512aff=_0x5d3e38(0x32c);else{if(_0x398c4c[_0x5d3e38(0x299)]===_0x5d3e38(0x39c))_0x512aff='new-disabled';else{if(_0x398c4c[_0x5d3e38(0x299)]==='new-disabled')_0x512aff=_0x5d3e38(0x39c);else{if(_0x398c4c[_0x5d3e38(0x299)]===_0x5d3e38(0x32c))_0x512aff='enabled';}}}return _0x512aff;}function updateStatus(_0x48c10a,_0x49148a){const _0x333b3a=_0x1e5f62;dbConfig[_0x333b3a(0x31e)](_0x333b3a(0x320))[_0x333b3a(0x312)]({'botID':_0x48c10a})[_0x333b3a(0x31a)]({'status':_0x49148a})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x333b3a(0x319)](_0x333b3a(0x320),config),broadcastToBots(_0x333b3a(0x320),JSON[_0x333b3a(0x373)](config));}function updateLive(_0x49c221,_0x4828e0){const _0x35739d=_0x1e5f62;dbConfig['get'](_0x35739d(0x320))['find']({'botID':_0x49c221})['assign']({'live':_0x4828e0})[_0x35739d(0x2db)](),config=getConfiguration(),io['to'](_0x35739d(0x219))[_0x35739d(0x319)]('bots',config),broadcastToBots(_0x35739d(0x320),JSON['stringify'](config));}function updateBotName(_0x1393ac,_0x246a4d){const _0xdfa36f=_0x1e5f62;dbConfig['get'](_0xdfa36f(0x320))[_0xdfa36f(0x312)]({'botID':_0x1393ac})[_0xdfa36f(0x31a)]({'botname':_0x246a4d})[_0xdfa36f(0x2db)](),config=getConfiguration(),io['to'](_0xdfa36f(0x219))[_0xdfa36f(0x319)](_0xdfa36f(0x320),config),broadcastToBots(_0xdfa36f(0x320),JSON[_0xdfa36f(0x373)](config));}function updateBotManager(){const _0x53fa8b=_0x1e5f62;config=getConfiguration(),io['to'](_0x53fa8b(0x219))[_0x53fa8b(0x319)](_0x53fa8b(0x320),config),broadcastToBots(_0x53fa8b(0x320),JSON[_0x53fa8b(0x373)](config));}function toggleBotMode(_0x461c21){const _0x36f3eb=_0x1e5f62;if(pid[_0x461c21])pid[_0x461c21][_0x36f3eb(0x2d0)]({'function':_0x36f3eb(0x38e),'args':null});else{const _0xcaaec3=configpath+'bot-'+_0x461c21+_0x36f3eb(0x1ea),_0x1c0d95=fs[_0x36f3eb(0x2e6)](_0xcaaec3),_0x2c9b6d=JSON[_0x36f3eb(0x32e)](_0x1c0d95),_0x297a47=_0x2c9b6d[_0x36f3eb(0x1fc)][0x0][_0x36f3eb(0x224)];_0x2c9b6d['bot'][0x0][_0x36f3eb(0x224)]=!_0x297a47;const _0x21c8bd=JSON[_0x36f3eb(0x373)](_0x2c9b6d,null,0x2);fs['writeFileSync'](_0xcaaec3,_0x21c8bd),config=getConfiguration(),io['to'](_0x36f3eb(0x219))[_0x36f3eb(0x319)]('bots',config),broadcastToBots(_0x36f3eb(0x320),JSON[_0x36f3eb(0x373)](config));}}function telegramError(_0x2791e6){const _0x2d1785=_0x1e5f62;logger['simple'](getTimeStamp()+_0x2d1785(0x2a2));}function validateTelegram(_0xcc4c9f){const _0x1ad58f=_0x1e5f62;if(_0xcc4c9f[_0x1ad58f(0x2b3)][_0x1ad58f(0x353)]!=settings[_0x1ad58f(0x2d8)]&&'@'+_0xcc4c9f[_0x1ad58f(0x2b3)][_0x1ad58f(0x353)]!=settings[_0x1ad58f(0x2d8)])return tgBot['sendMessage'](_0xcc4c9f[_0x1ad58f(0x281)]['id'],_0x1ad58f(0x243),{'parse_mode':_0x1ad58f(0x37d)})[_0x1ad58f(0x239)](_0x29ba7b=>{telegramError(_0x29ba7b);}),![];return!![];}async function initTelegram(){const _0x15543f=_0x1e5f62;if(tgBot)tgBot[_0x15543f(0x2bc)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x15543f(0x2c2)],{'polling':!![]});let _0xaddb90=_0x15543f(0x2d9);_0xaddb90+='\x0a',_0xaddb90+='/enable\x20-\x20enable\x20notifications\x0a',_0xaddb90+=_0x15543f(0x2a9),_0xaddb90+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0xaddb90+='/restart\x20-\x20restart\x20bot(s)\x0a',_0xaddb90+=_0x15543f(0x393),_0xaddb90+=_0x15543f(0x1f0),_0xaddb90+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0xaddb90+=_0x15543f(0x2ec),_0xaddb90+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0xaddb90+=_0x15543f(0x2f3),_0xaddb90+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0xaddb90+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0xaddb90+=_0x15543f(0x289),_0xaddb90+=_0x15543f(0x385);let _0x19ca2e=_0x15543f(0x264);_0x19ca2e+='\x0a',_0x19ca2e+=_0xaddb90,tgBot[_0x15543f(0x2c6)](/\/start/,_0x4ab143=>{const _0x48d8f5=_0x15543f;if(!validateTelegram(_0x4ab143))return;if(settings[_0x48d8f5(0x321)]!=_0x4ab143[_0x48d8f5(0x281)]['id'])updateSetting(_0x48d8f5(0x321),_0x4ab143['chat']['id']);updateSetting(_0x48d8f5(0x24d),!![]),tgBot[_0x48d8f5(0x350)](_0x4ab143['chat']['id'],_0x19ca2e)[_0x48d8f5(0x239)](_0x427471=>{telegramError(_0x427471);});}),tgBot[_0x15543f(0x2c6)](/\/enable/,_0x25564c=>{const _0x51cdcc=_0x15543f;if(!validateTelegram(_0x25564c))return;if(settings[_0x51cdcc(0x321)]!=_0x25564c[_0x51cdcc(0x281)]['id'])updateSetting('telegramChatId',_0x25564c['chat']['id']);updateSetting(_0x51cdcc(0x24d),!![]),tgBot[_0x51cdcc(0x350)](_0x25564c[_0x51cdcc(0x281)]['id'],_0x51cdcc(0x1d0))['catch'](_0x179d6b=>{telegramError(_0x179d6b);});}),tgBot[_0x15543f(0x2c6)](/\/config/,async _0x3135a6=>{const _0x28b9ba=_0x15543f;if(!validateTelegram(_0x3135a6))return;tgBot[_0x28b9ba(0x3a8)](_0x28b9ba(0x3a3)),tgBot['sendMessage'](_0x3135a6[_0x28b9ba(0x281)]['id'],_0x28b9ba(0x2e7),{'reply_markup':{'inline_keyboard':[[{'text':_0x28b9ba(0x328),'callback_data':'orders'},{'text':'Alerts','callback_data':_0x28b9ba(0x249)},{'text':'All','callback_data':'all'}]]}})[_0x28b9ba(0x239)](_0x18a159=>{telegramError(_0x18a159);}),tgBot['on'](_0x28b9ba(0x3a3),async _0x5e8b50=>{const _0x266a6a=_0x28b9ba,_0x3b781a=_0x5e8b50[_0x266a6a(0x238)],_0x4b1c11=_0x5e8b50[_0x266a6a(0x36d)];tgBot[_0x266a6a(0x2bd)](_0x5e8b50['id'])[_0x266a6a(0x25b)](async()=>{const _0x59b574=_0x266a6a;_0x3b781a==_0x59b574(0x389)&&(updateSetting(_0x59b574(0x34a),'orders'),updateSetting(_0x59b574(0x24d),!![]),await tgBot[_0x59b574(0x350)](_0x4b1c11[_0x59b574(0x281)]['id'],_0x59b574(0x263))[_0x59b574(0x239)](_0x5e1068=>{telegramError(_0x5e1068);}));_0x3b781a==_0x59b574(0x249)&&(updateSetting('telegramEvents','alerts'),updateSetting(_0x59b574(0x24d),!![]),await tgBot[_0x59b574(0x350)](_0x4b1c11[_0x59b574(0x281)]['id'],_0x59b574(0x245))['catch'](_0x205ccb=>{telegramError(_0x205ccb);}));_0x3b781a==_0x59b574(0x368)&&(updateSetting('telegramEvents','all'),updateSetting(_0x59b574(0x24d),!![]),await tgBot['sendMessage'](_0x4b1c11[_0x59b574(0x281)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x59b574(0x239)](_0x2289a8=>{telegramError(_0x2289a8);}));if(!settings[_0x59b574(0x321)])tgBot['sendMessage'](_0x4b1c11[_0x59b574(0x281)]['id'],_0x59b574(0x24e))[_0x59b574(0x239)](_0x5596d2=>{telegramError(_0x5596d2);});}),tgBot[_0x266a6a(0x3a8)](_0x266a6a(0x3a3));});}),tgBot['onText'](/\/status/,_0x4da98c=>{const _0x111464=_0x15543f;if(!validateTelegram(_0x4da98c))return;const _0xeb1cc=getBotsWithMode();let _0x55ce5f=_0x111464(0x270);config[_0x111464(0x35b)](_0x546086=>{const _0x5f484c=_0x111464,_0x52939f=_0xeb1cc[_0x5f484c(0x312)](_0x4cf984=>_0x4cf984['botID']==_0x546086[_0x5f484c(0x206)])[_0x5f484c(0x361)];_0x55ce5f+=_0x5f484c(0x39b)+_0x546086[_0x5f484c(0x206)]+':\x20'+_0x546086['status']+_0x5f484c(0x282)+_0x52939f+_0x5f484c(0x282)+_0x546086[_0x5f484c(0x268)]+'\x0a';}),_0x55ce5f+='\x0a',_0x55ce5f+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x55ce5f+=!settings[_0x111464(0x24d)]?'Notifications\x20disabled\x0a':'Notifications\x20enabled\x0a',_0x55ce5f+=settings['telegramEnabled']?settings[_0x111464(0x34a)]==_0x111464(0x368)?_0x111464(0x220):'Notifications\x20types:\x20'+settings[_0x111464(0x34a)]+_0x111464(0x330):'',tgBot['sendMessage'](_0x4da98c[_0x111464(0x281)]['id'],_0x55ce5f,{'parse_mode':_0x111464(0x37d)})[_0x111464(0x239)](_0x41b3e4=>{telegramError(_0x41b3e4);});}),tgBot[_0x15543f(0x2c6)](/\/restart/,_0x185b45=>{const _0x181d95=_0x15543f;if(!validateTelegram(_0x185b45))return;tgBot[_0x181d95(0x3a8)](_0x181d95(0x3a3));const _0x55006f=getEnabledBots();if(_0x55006f[_0x181d95(0x347)]==0x0)tgBot[_0x181d95(0x350)](_0x185b45[_0x181d95(0x281)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x181d95(0x239)](_0x5ccca7=>{telegramError(_0x5ccca7);});else{if(_0x55006f['length']>0x1)_0x55006f['push']({'botID':_0x181d95(0x368)});let _0xdffc07=[],_0x38b80e=[];const _0x2a6f30=_0x55006f[_0x181d95(0x347)]%0x4==0x0||_0x55006f[_0x181d95(0x347)]%0x4==0x3||_0x55006f['length']%0x3==0x1?0x4:0x3;let _0x495720=0x0;_0x55006f[_0x181d95(0x35b)]((_0x10e99a,_0x8c2ce8)=>{const _0x161ca9=_0x181d95;if(_0x8c2ce8%_0x2a6f30==0x0)_0x38b80e=[];_0x38b80e['push']({'text':_0x10e99a['botID']==_0x161ca9(0x368)?'All\x20bots':_0x161ca9(0x39b)+_0x10e99a[_0x161ca9(0x206)],'callback_data':_0x10e99a[_0x161ca9(0x206)]}),_0x8c2ce8%_0x2a6f30==0x0&&(_0xdffc07[_0x495720]=_0x38b80e,_0x495720++);}),tgBot['sendMessage'](_0x185b45['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0xdffc07}})[_0x181d95(0x239)](_0x529da8=>{telegramError(_0x529da8);}),tgBot['on']('callback_query',async _0x2ef045=>{const _0x3302f8=_0x181d95,_0xdaa75c=_0x2ef045[_0x3302f8(0x238)],_0x45d492=_0x2ef045[_0x3302f8(0x36d)];tgBot['answerCallbackQuery'](_0x2ef045['id'])['then'](async()=>{const _0xccf8e3=_0x3302f8;_0xdaa75c==_0xccf8e3(0x368)?config['forEach'](_0x24fdb1=>{const _0x245344=_0xccf8e3;restartBot(_0x24fdb1[_0x245344(0x206)]);}):restartBot(_0xdaa75c);}),tgBot[_0x3302f8(0x3a8)](_0x3302f8(0x3a3));});}}),tgBot[_0x15543f(0x2c6)](/\/on/,_0x1967ff=>{const _0x210af7=_0x15543f;if(!validateTelegram(_0x1967ff))return;tgBot[_0x210af7(0x3a8)](_0x210af7(0x3a3));const _0x27b7be=getDisabledBots();if(_0x27b7be[_0x210af7(0x347)]==0x0)tgBot[_0x210af7(0x350)](_0x1967ff[_0x210af7(0x281)]['id'],_0x210af7(0x311))[_0x210af7(0x239)](_0x2eb269=>{telegramError(_0x2eb269);});else{if(_0x27b7be[_0x210af7(0x347)]>0x1)_0x27b7be[_0x210af7(0x253)]({'botID':'all'});let _0x1b0e8b=[],_0x26821c=[];const _0x4aa9d7=_0x27b7be[_0x210af7(0x347)]%0x4==0x0||_0x27b7be['length']%0x4==0x3||_0x27b7be[_0x210af7(0x347)]%0x3==0x1?0x4:0x3;let _0x4d5e52=0x0;_0x27b7be['forEach']((_0x3fdae0,_0x55c271)=>{const _0x16b763=_0x210af7;if(_0x55c271%_0x4aa9d7==0x0)_0x26821c=[];_0x26821c['push']({'text':_0x3fdae0[_0x16b763(0x206)]==_0x16b763(0x368)?_0x16b763(0x37c):'Bot\x20'+_0x3fdae0['botID'],'callback_data':_0x3fdae0[_0x16b763(0x206)]}),_0x55c271%_0x4aa9d7==0x0&&(_0x1b0e8b[_0x4d5e52]=_0x26821c,_0x4d5e52++);}),tgBot[_0x210af7(0x350)](_0x1967ff[_0x210af7(0x281)]['id'],_0x210af7(0x225),{'reply_markup':{'inline_keyboard':_0x1b0e8b}})[_0x210af7(0x239)](_0x143df1=>{telegramError(_0x143df1);}),tgBot['on'](_0x210af7(0x3a3),async _0x410bd3=>{const _0x2ffa78=_0x210af7,_0x13e11e=_0x410bd3[_0x2ffa78(0x238)],_0x1c2c69=_0x410bd3[_0x2ffa78(0x36d)];tgBot[_0x2ffa78(0x2bd)](_0x410bd3['id'])[_0x2ffa78(0x25b)](async()=>{const _0x5974a3=_0x2ffa78;_0x13e11e==_0x5974a3(0x368)?(tgBot[_0x5974a3(0x350)](_0x1c2c69[_0x5974a3(0x281)]['id'],_0x5974a3(0x20e))[_0x5974a3(0x239)](_0x44d06e=>{telegramError(_0x44d06e);}),_0x27b7be[_0x5974a3(0x35b)](_0xaa7a52=>{const _0x5797af=_0x5974a3;if(_0xaa7a52[_0x5797af(0x206)]!=_0x5797af(0x368))toggleBot(_0xaa7a52[_0x5797af(0x206)],toggleStatus(_0xaa7a52[_0x5797af(0x206)]),_0x5797af(0x31b));})):(tgBot['sendMessage'](_0x1c2c69[_0x5974a3(0x281)]['id'],_0x5974a3(0x2e9)+_0x13e11e)[_0x5974a3(0x239)](_0x2fdb25=>{telegramError(_0x2fdb25);}),toggleBot(_0x13e11e,toggleStatus(_0x13e11e),_0x5974a3(0x31b)));}),tgBot[_0x2ffa78(0x3a8)](_0x2ffa78(0x3a3));});}}),tgBot[_0x15543f(0x2c6)](/\/off/,_0x326741=>{const _0x3776cd=_0x15543f;if(!validateTelegram(_0x326741))return;tgBot[_0x3776cd(0x3a8)](_0x3776cd(0x3a3));const _0x43042b=getEnabledBots();if(_0x43042b[_0x3776cd(0x347)]==0x0)tgBot['sendMessage'](_0x326741[_0x3776cd(0x281)]['id'],_0x3776cd(0x2f6))[_0x3776cd(0x239)](_0x5eb3e8=>{telegramError(_0x5eb3e8);});else{if(_0x43042b['length']>0x1)_0x43042b[_0x3776cd(0x253)]({'botID':'all'});let _0x178c80=[],_0x1eb783=[];const _0x900b27=_0x43042b[_0x3776cd(0x347)]%0x4==0x0||_0x43042b[_0x3776cd(0x347)]%0x4==0x3||_0x43042b[_0x3776cd(0x347)]%0x3==0x1?0x4:0x3;let _0x2ff94c=0x0;_0x43042b['forEach']((_0x1b9cde,_0x2648fe)=>{const _0x41aeae=_0x3776cd;if(_0x2648fe%_0x900b27==0x0)_0x1eb783=[];_0x1eb783['push']({'text':_0x1b9cde['botID']==_0x41aeae(0x368)?'All\x20bots':_0x41aeae(0x39b)+_0x1b9cde['botID'],'callback_data':_0x1b9cde[_0x41aeae(0x206)]}),_0x2648fe%_0x900b27==0x0&&(_0x178c80[_0x2ff94c]=_0x1eb783,_0x2ff94c++);}),tgBot['sendMessage'](_0x326741[_0x3776cd(0x281)]['id'],_0x3776cd(0x379),{'reply_markup':{'inline_keyboard':_0x178c80}})[_0x3776cd(0x239)](_0x54990b=>{telegramError(_0x54990b);}),tgBot['on'](_0x3776cd(0x3a3),async _0x1bff76=>{const _0xc28abe=_0x3776cd,_0x26888d=_0x1bff76[_0xc28abe(0x238)],_0x4f766e=_0x1bff76[_0xc28abe(0x36d)];tgBot['answerCallbackQuery'](_0x1bff76['id'])[_0xc28abe(0x25b)](async()=>{const _0x27d42d=_0xc28abe;_0x26888d==_0x27d42d(0x368)?(tgBot[_0x27d42d(0x350)](_0x4f766e[_0x27d42d(0x281)]['id'],_0x27d42d(0x2b9))[_0x27d42d(0x239)](_0x23a437=>{telegramError(_0x23a437);}),_0x43042b[_0x27d42d(0x35b)](_0x509a28=>{const _0x54ded6=_0x27d42d;if(_0x509a28[_0x54ded6(0x206)]!=_0x54ded6(0x368))toggleBot(_0x509a28['botID'],toggleStatus(_0x509a28[_0x54ded6(0x206)]),_0x54ded6(0x31b));})):(tgBot[_0x27d42d(0x350)](_0x4f766e[_0x27d42d(0x281)]['id'],_0x27d42d(0x1d8)+_0x26888d)['catch'](_0xaf552e=>{telegramError(_0xaf552e);}),toggleBot(_0x26888d,toggleStatus(_0x26888d),_0x27d42d(0x31b)));}),tgBot['removeListener'](_0xc28abe(0x3a3));});}}),tgBot['onText'](/\/metrics/,_0x2d7371=>{const _0x43d1cc=_0x15543f;if(!validateTelegram(_0x2d7371))return;tgBot[_0x43d1cc(0x3a8)]('callback_query');const _0x38c6e4=getEnabledBots();if(_0x38c6e4[_0x43d1cc(0x347)]==0x0)tgBot[_0x43d1cc(0x350)](_0x2d7371[_0x43d1cc(0x281)]['id'],_0x43d1cc(0x2f6))[_0x43d1cc(0x239)](_0x25d443=>{telegramError(_0x25d443);});else{if(_0x38c6e4[_0x43d1cc(0x347)]>0x1){let _0xc1fe89=[],_0x5912c1=[];const _0x4012db=_0x38c6e4[_0x43d1cc(0x347)]%0x4==0x0||_0x38c6e4[_0x43d1cc(0x347)]%0x4==0x3||_0x38c6e4[_0x43d1cc(0x347)]%0x3==0x1?0x4:0x3;let _0x2bd0e5=0x0;_0x38c6e4[_0x43d1cc(0x35b)]((_0x502c13,_0x2e47f2)=>{const _0x5295a9=_0x43d1cc;if(_0x2e47f2%_0x4012db==0x0)_0x5912c1=[];_0x5912c1['push']({'text':_0x5295a9(0x39b)+_0x502c13[_0x5295a9(0x206)],'callback_data':_0x502c13[_0x5295a9(0x206)]}),_0x2e47f2%_0x4012db==0x0&&(_0xc1fe89[_0x2bd0e5]=_0x5912c1,_0x2bd0e5++);}),tgBot['sendMessage'](_0x2d7371[_0x43d1cc(0x281)]['id'],_0x43d1cc(0x208),{'reply_markup':{'inline_keyboard':_0xc1fe89}})[_0x43d1cc(0x239)](_0x2635a2=>{telegramError(_0x2635a2);}),tgBot['on'](_0x43d1cc(0x3a3),async _0x358f43=>{const _0x4f20b3=_0x43d1cc,_0xedab89=_0x358f43['data'],_0x5dab33=_0x358f43[_0x4f20b3(0x36d)];tgBot[_0x4f20b3(0x2bd)](_0x358f43['id'])[_0x4f20b3(0x25b)](async()=>{const _0x4b77cb=_0x4f20b3;if(pid[_0xedab89])pid[_0xedab89][_0x4b77cb(0x2d0)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x4f20b3(0x3a8)](_0x4f20b3(0x3a3));});}else{const _0x675a57=_0x38c6e4[0x0]['botID'];if(pid[_0x675a57])pid[_0x675a57][_0x43d1cc(0x2d0)]({'function':_0x43d1cc(0x23e),'args':null});}}}),tgBot[_0x15543f(0x2c6)](/\/portfolio/,_0xba1e24=>{const _0x168c71=_0x15543f;if(!validateTelegram(_0xba1e24))return;tgBot['removeListener'](_0x168c71(0x3a3));const _0x56eb25=getEnabledBots();if(_0x56eb25[_0x168c71(0x347)]==0x0)tgBot['sendMessage'](_0xba1e24[_0x168c71(0x281)]['id'],_0x168c71(0x2f6))[_0x168c71(0x239)](_0xf12720=>{telegramError(_0xf12720);});else{if(_0x56eb25[_0x168c71(0x347)]>0x1){let _0x32a2d3=[],_0x1dd219=[];const _0x1b1817=_0x56eb25[_0x168c71(0x347)]%0x4==0x0||_0x56eb25[_0x168c71(0x347)]%0x4==0x3||_0x56eb25[_0x168c71(0x347)]%0x3==0x1?0x4:0x3;let _0x2105a0=0x0;_0x56eb25[_0x168c71(0x35b)]((_0x3c4171,_0x3e0351)=>{const _0x4b0b43=_0x168c71;if(_0x3e0351%_0x1b1817==0x0)_0x1dd219=[];_0x1dd219['push']({'text':'Bot\x20'+_0x3c4171[_0x4b0b43(0x206)],'callback_data':_0x3c4171[_0x4b0b43(0x206)]}),_0x3e0351%_0x1b1817==0x0&&(_0x32a2d3[_0x2105a0]=_0x1dd219,_0x2105a0++);}),tgBot['sendMessage'](_0xba1e24[_0x168c71(0x281)]['id'],_0x168c71(0x2c9),{'reply_markup':{'inline_keyboard':_0x32a2d3}})[_0x168c71(0x239)](_0x3e6854=>{telegramError(_0x3e6854);}),tgBot['on']('callback_query',async _0x217f3d=>{const _0x5a42a9=_0x168c71,_0x435861=_0x217f3d[_0x5a42a9(0x238)],_0x1d1187=_0x217f3d[_0x5a42a9(0x36d)];tgBot[_0x5a42a9(0x2bd)](_0x217f3d['id'])[_0x5a42a9(0x25b)](async()=>{if(pid[_0x435861])pid[_0x435861]['send']({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x5a42a9(0x3a8)](_0x5a42a9(0x3a3));});}else{const _0x4f5fd0=_0x56eb25[0x0][_0x168c71(0x206)];if(pid[_0x4f5fd0])pid[_0x4f5fd0]['send']({'function':_0x168c71(0x21a),'args':null});}}}),tgBot[_0x15543f(0x2c6)](/\/update/,async _0x2b7782=>{const _0x2be755=_0x15543f;if(!validateTelegram(_0x2b7782))return;tgBot['removeListener'](_0x2be755(0x3a3)),await getMessages();if(!updateAvailable)tgBot[_0x2be755(0x350)](_0x2b7782[_0x2be755(0x281)]['id'],_0x2be755(0x2b7))['catch'](_0x552967=>{telegramError(_0x552967);});else!validInstallation?tgBot[_0x2be755(0x350)](_0x2b7782[_0x2be755(0x281)]['id'],_0x2be755(0x2e1))[_0x2be755(0x239)](_0x351666=>{telegramError(_0x351666);}):(tgBot['sendMessage'](_0x2b7782[_0x2be755(0x281)]['id'],_0x2be755(0x1c9),{'reply_markup':{'inline_keyboard':[[{'text':_0x2be755(0x37e),'callback_data':_0x2be755(0x2ab)},{'text':'No','callback_data':'no'}]]}})[_0x2be755(0x239)](_0x61e1f3=>{telegramError(_0x61e1f3);}),tgBot['on']('callback_query',async _0x48709b=>{const _0x5877cb=_0x2be755,_0x514d79=_0x48709b[_0x5877cb(0x238)],_0x44aff4=_0x48709b[_0x5877cb(0x36d)];tgBot[_0x5877cb(0x2bd)](_0x48709b['id'])['then'](async()=>{const _0x5bba76=_0x5877cb;_0x514d79==_0x5bba76(0x2ab)&&(await tgBot[_0x5bba76(0x350)](_0x44aff4[_0x5bba76(0x281)]['id'],'Starting\x20Balance\x20Bot\x20update')[_0x5bba76(0x239)](_0x3de9ec=>{telegramError(_0x3de9ec);}),updateBB(_0x5bba76(0x2b6))),_0x514d79=='no'&&await tgBot['sendMessage'](_0x44aff4[_0x5bba76(0x281)]['id'],_0x5bba76(0x318))[_0x5bba76(0x239)](_0x5dddb4=>{telegramError(_0x5dddb4);});}),tgBot['removeListener'](_0x5877cb(0x3a3));}));}),tgBot[_0x15543f(0x2c6)](/\/reinstall/,async _0x10e266=>{const _0x5a532a=_0x15543f;if(!validateTelegram(_0x10e266))return;tgBot[_0x5a532a(0x3a8)](_0x5a532a(0x3a3)),!validInstallation?tgBot['sendMessage'](_0x10e266['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')[_0x5a532a(0x239)](_0x4ee795=>{telegramError(_0x4ee795);}):(tgBot[_0x5a532a(0x350)](_0x10e266['chat']['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x5a532a(0x37e),'callback_data':_0x5a532a(0x2ab)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x46b874=>{telegramError(_0x46b874);}),tgBot['on']('callback_query',async _0x2ed68a=>{const _0x382198=_0x5a532a,_0x36cddf=_0x2ed68a[_0x382198(0x238)],_0x535601=_0x2ed68a[_0x382198(0x36d)];tgBot[_0x382198(0x2bd)](_0x2ed68a['id'])[_0x382198(0x25b)](async()=>{const _0x262062=_0x382198;_0x36cddf==_0x262062(0x2ab)&&(await tgBot['sendMessage'](_0x535601[_0x262062(0x281)]['id'],_0x262062(0x396))[_0x262062(0x239)](_0x2cb785=>{telegramError(_0x2cb785);}),updateBB(_0x262062(0x38f))),_0x36cddf=='no'&&await tgBot[_0x262062(0x350)](_0x535601[_0x262062(0x281)]['id'],_0x262062(0x256))['catch'](_0x48a726=>{telegramError(_0x48a726);});}),tgBot['removeListener'](_0x382198(0x3a3));}));}),tgBot[_0x15543f(0x2c6)](/\/toggle/,_0x2b8695=>{const _0x5c3e3d=_0x15543f;if(!validateTelegram(_0x2b8695))return;tgBot['removeListener'](_0x5c3e3d(0x3a3));const _0x25694f=getBotsWithMode();if(_0x25694f[_0x5c3e3d(0x347)]==0x0)tgBot[_0x5c3e3d(0x350)](_0x2b8695[_0x5c3e3d(0x281)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x5c3e3d(0x239)](_0x28dd98=>{telegramError(_0x28dd98);});else{let _0x65c6ff=[],_0x53afb6=[];const _0x32dd21=0x2;let _0x4e78bb=0x0;_0x25694f['forEach']((_0x4d9fa7,_0x11bf3b)=>{const _0x450843=_0x5c3e3d;if(_0x11bf3b%_0x32dd21==0x0)_0x53afb6=[];_0x53afb6['push']({'text':_0x450843(0x39b)+_0x4d9fa7['botID']+'\x20('+_0x4d9fa7[_0x450843(0x361)]+')','callback_data':_0x4d9fa7[_0x450843(0x206)]}),_0x11bf3b%_0x32dd21==0x0&&(_0x65c6ff[_0x4e78bb]=_0x53afb6,_0x4e78bb++);}),tgBot['sendMessage'](_0x2b8695[_0x5c3e3d(0x281)]['id'],_0x5c3e3d(0x336),{'reply_markup':{'inline_keyboard':_0x65c6ff}})[_0x5c3e3d(0x239)](_0x50a2d6=>{telegramError(_0x50a2d6);}),tgBot['on'](_0x5c3e3d(0x3a3),async _0x142f54=>{const _0x42255f=_0x5c3e3d,_0x5f4218=_0x142f54[_0x42255f(0x238)],_0x4b1021=_0x142f54[_0x42255f(0x36d)];tgBot[_0x42255f(0x2bd)](_0x142f54['id'])[_0x42255f(0x25b)](async()=>{const _0x441e5f=_0x42255f,_0x400cda=_0x25694f[_0x441e5f(0x312)](_0x213a66=>_0x213a66[_0x441e5f(0x206)]==_0x5f4218),_0x4452a0=_0x400cda[_0x441e5f(0x361)]==_0x441e5f(0x265)?_0x441e5f(0x30f):_0x441e5f(0x265);tgBot[_0x441e5f(0x350)](_0x4b1021[_0x441e5f(0x281)]['id'],_0x441e5f(0x34b)+_0x5f4218+_0x441e5f(0x324)+_0x4452a0+_0x441e5f(0x2da))['catch'](_0x58c708=>{telegramError(_0x58c708);}),toggleBotMode(_0x5f4218);}),tgBot[_0x42255f(0x3a8)]('callback_query');});}}),tgBot[_0x15543f(0x2c6)](/\/names/,_0x47ffbf=>{const _0x197b05=_0x15543f;if(!validateTelegram(_0x47ffbf))return;let _0x2bcf3e='';config[_0x197b05(0x35b)](_0x3da938=>{const _0x4b347e=_0x197b05;_0x2bcf3e+=_0x4b347e(0x39b)+_0x3da938['botID']+':\x20'+_0x3da938['botname']+'\x0a';}),tgBot['sendMessage'](_0x47ffbf['chat']['id'],_0x2bcf3e,{'parse_mode':'HTML'})[_0x197b05(0x239)](_0x293dab=>{telegramError(_0x293dab);});}),tgBot[_0x15543f(0x2c6)](/\/disable/,_0x4944cf=>{const _0x29f311=_0x15543f;if(!validateTelegram(_0x4944cf))return;tgBot[_0x29f311(0x350)](_0x4944cf[_0x29f311(0x281)]['id'],'Notifications\x20disabled')[_0x29f311(0x239)](_0x5ba5b0=>{telegramError(_0x5ba5b0);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x15543f(0x2c6)](/\/help/,_0x37fa64=>{const _0x1829a6=_0x15543f;if(!validateTelegram(_0x37fa64))return;tgBot[_0x1829a6(0x350)](_0x37fa64[_0x1829a6(0x281)]['id'],_0xaddb90)[_0x1829a6(0x239)](_0x26760a=>{telegramError(_0x26760a);});}),tgBot['on'](_0x15543f(0x2c5),_0x4d7b34=>{const _0x365f9d=_0x15543f;_0x4d7b34[_0x365f9d(0x1ce)]()['includes'](_0x365f9d(0x241))&&(logger[_0x365f9d(0x27f)](_0x365f9d(0x2ed)),tgBot['stopPolling'](),tgBot=null,io['to']('botmanager')[_0x365f9d(0x319)](_0x365f9d(0x3a0),'Invalid\x20Telegram\x20token'));}),process[_0x15543f(0x2b4)](_0x15543f(0x1ed),()=>{const _0x436a65=_0x15543f;if(tgBot)tgBot[_0x436a65(0x2bc)]();process[_0x436a65(0x216)](0x1);}),process[_0x15543f(0x2b4)]('SIGTERM',()=>{const _0xfe0c4=_0x15543f;if(tgBot)tgBot[_0xfe0c4(0x2bc)]();process['exit'](0x1);});}}function disableTelegram(){const _0x38f806=_0x1e5f62;tgBot&&(tgBot[_0x38f806(0x2bc)](),tgBot=null);}function sendTelegram(_0x42e5d7,_0x157091){const _0x15d577=_0x1e5f62;if(settings[_0x15d577(0x24d)]){if(settings[_0x15d577(0x34a)]==_0x15d577(0x368)||(_0x157091[_0x15d577(0x39d)]=='error'||_0x157091[_0x15d577(0x39d)]==_0x15d577(0x359)||_0x157091[_0x15d577(0x39d)]==_0x15d577(0x344))&&settings['telegramEvents']=='alerts'||_0x157091[_0x15d577(0x39d)]==_0x15d577(0x231)&&settings['telegramEvents']=='orders'){if(tgBot&&settings[_0x15d577(0x321)]){if(_0x157091[_0x15d577(0x339)])tgBot[_0x15d577(0x350)](settings['telegramChatId'],_0x157091[_0x15d577(0x27d)]+_0x15d577(0x213)+_0x157091[_0x15d577(0x2c4)])[_0x15d577(0x239)](_0x271e4a=>{telegramError(_0x271e4a);});else tgBot['sendMessage'](settings[_0x15d577(0x321)],'Bot\x20'+_0x42e5d7+_0x15d577(0x213)+_0x157091[_0x15d577(0x2c4)])['catch'](_0x405b23=>{telegramError(_0x405b23);});}}}}async function sendTelegramMsg(_0x5ce37b,_0x4d5f94='HTML'){const _0x4fe9a7=_0x1e5f62;return settings[_0x4fe9a7(0x24d)]&&tgBot&&settings['telegramChatId']?(await tgBot['sendMessage'](settings[_0x4fe9a7(0x321)],_0x5ce37b,{'parse_mode':_0x4d5f94})[_0x4fe9a7(0x239)](_0x2a40fa=>{telegramError(_0x2a40fa);}),!![]):![];}function getDeviceWithIp(_0x2cabec){return devices['find'](_0x2a6587=>_0x2a6587['ip']===_0x2cabec);}function temporaryAccess2FA(_0x3b10c1,_0x234238){const _0x457457=_0x1e5f62;let _0x3c45af=new Date(),_0x5caf03=![];if(lastIpApproval){if(_0x3c45af-lastIpApproval<0x1388)_0x5caf03=!![];}lastIpApproval=new Date();if(_0x5caf03)return;tgBot&&settings[_0x457457(0x321)]&&(tgBot[_0x457457(0x3a8)](_0x457457(0x3a3)),tgBot[_0x457457(0x350)](settings['telegramChatId'],_0x457457(0x31c)+normalizeIP(_0x234238)[_0x457457(0x31d)]+_0x457457(0x369),{'parse_mode':_0x457457(0x37d),'reply_markup':{'inline_keyboard':[[{'text':_0x457457(0x300),'callback_data':'5'},{'text':_0x457457(0x2f5),'callback_data':'15'},{'text':_0x457457(0x30e),'callback_data':'30'},{'text':_0x457457(0x2f9),'callback_data':_0x457457(0x2f9)}]]}})['catch'](_0x1efeb6=>{telegramError(_0x1efeb6);}),tgBot['on'](_0x457457(0x3a3),async _0x3bab68=>{const _0x2cd6cf=_0x457457,_0xe37614=_0x3bab68[_0x2cd6cf(0x238)],_0x3df13b=_0x3bab68[_0x2cd6cf(0x36d)];tgBot[_0x2cd6cf(0x2bd)](_0x3bab68['id'])[_0x2cd6cf(0x25b)](async()=>{const _0x2085b5=_0x2cd6cf;devices[_0x3b10c1][_0x2085b5(0x267)]={'clientip':_0x234238,'timestamp':new Date()[_0x2085b5(0x33d)](),'expiry':_0xe37614},_0xe37614!='reject'?(await tgBot[_0x2085b5(0x350)](_0x3df13b[_0x2085b5(0x281)]['id'],_0x2085b5(0x1d5)+_0xe37614+_0x2085b5(0x1cb),{'parse_mode':'HTML'})[_0x2085b5(0x239)](_0x4ca693=>{telegramError(_0x4ca693);}),io['to'](_0x3b10c1)[_0x2085b5(0x319)](_0x2085b5(0x299),{'access':{'allow':![],'reason':_0x2085b5(0x35a),'token':null}})):(await tgBot[_0x2085b5(0x350)](_0x3df13b[_0x2085b5(0x281)]['id'],_0x2085b5(0x2ef))[_0x2085b5(0x239)](_0x36ff9f=>{telegramError(_0x36ff9f);}),io['to'](_0x3b10c1)[_0x2085b5(0x319)](_0x2085b5(0x299),{'access':{'allow':![],'reason':_0x2085b5(0x33f),'token':null}}));}),tgBot[_0x2cd6cf(0x3a8)](_0x2cd6cf(0x3a3));}));}function loginAccess2FA(_0x22f0cb,_0x5a0a66){const _0x5c96d3=_0x1e5f62;tgBot&&settings[_0x5c96d3(0x321)]&&(tgBot['removeListener'](_0x5c96d3(0x3a3)),tgBot[_0x5c96d3(0x350)](settings[_0x5c96d3(0x321)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x5a0a66)[_0x5c96d3(0x31d)]+_0x5c96d3(0x369),{'parse_mode':_0x5c96d3(0x37d),'reply_markup':{'inline_keyboard':[[{'text':_0x5c96d3(0x2d6),'callback_data':loginExpiry},{'text':_0x5c96d3(0x2f9),'callback_data':_0x5c96d3(0x2f9)}]]}})[_0x5c96d3(0x239)](_0x1bba63=>{telegramError(_0x1bba63);}),tgBot['on'](_0x5c96d3(0x3a3),async _0x58d2c1=>{const _0x28fb24=_0x5c96d3,_0x8c694b=_0x58d2c1[_0x28fb24(0x238)],_0x5490e2=_0x58d2c1[_0x28fb24(0x36d)];tgBot[_0x28fb24(0x2bd)](_0x58d2c1['id'])[_0x28fb24(0x25b)](async()=>{const _0x47a607=_0x28fb24;devices[_0x22f0cb][_0x47a607(0x33a)]={'clientip':_0x5a0a66,'timestamp':new Date()[_0x47a607(0x33d)](),'expiry':_0x8c694b},_0x8c694b!=_0x47a607(0x2f9)?(await tgBot[_0x47a607(0x350)](_0x5490e2[_0x47a607(0x281)]['id'],_0x47a607(0x30c),{'parse_mode':'HTML'})[_0x47a607(0x239)](_0x4fda47=>{telegramError(_0x4fda47);}),io['to'](_0x22f0cb)[_0x47a607(0x319)](_0x47a607(0x299),{'access':{'allow':![],'reason':_0x47a607(0x35a),'token':null}})):(await tgBot['sendMessage'](_0x5490e2[_0x47a607(0x281)]['id'],_0x47a607(0x1ec))['catch'](_0x573933=>{telegramError(_0x573933);}),io['to'](_0x22f0cb)['emit'](_0x47a607(0x299),{'access':{'allow':![],'reason':_0x47a607(0x24c),'token':null}}));}),tgBot[_0x28fb24(0x3a8)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x20a15c=_0x1e5f62;return dbConfig['get'](_0x20a15c(0x320))[_0x20a15c(0x308)]('botID')[_0x20a15c(0x22b)]({'status':'enabled'})['value']()||[];}function getDisabledBots(){const _0x2da9db=_0x1e5f62;return dbConfig[_0x2da9db(0x31e)](_0x2da9db(0x320))[_0x2da9db(0x308)](_0x2da9db(0x206))[_0x2da9db(0x22b)]({'status':_0x2da9db(0x32c)})[_0x2da9db(0x3a1)]()||[];}function getBotAttributes(_0x2fd8f0){const _0x59d134=_0x1e5f62;let _0xc25ec3={};const _0x2455d5=configpath+_0x59d134(0x29d)+_0x2fd8f0+_0x59d134(0x1ea),_0x5a0d55=fs['existsSync'](_0x2455d5);if(_0x5a0d55){const _0xe94fc6=fs[_0x59d134(0x2e6)](_0x2455d5);try{const _0x42a496=JSON[_0x59d134(0x32e)](_0xe94fc6),_0x325ef7=_0x42a496?_0x42a496[_0x59d134(0x1fc)][0x0][_0x59d134(0x224)]:![];_0xc25ec3[_0x59d134(0x361)]=_0x325ef7?'auto':_0x59d134(0x30f),_0xc25ec3[_0x59d134(0x27d)]=_0x42a496?_0x42a496[_0x59d134(0x1fc)][0x0][_0x59d134(0x27d)]:_0x59d134(0x39b)+_0x2fd8f0;}catch(_0x56dced){_0xc25ec3[_0x59d134(0x361)]=_0x59d134(0x30f),_0xc25ec3[_0x59d134(0x27d)]='Bot\x20'+_0x2fd8f0;}}else _0xc25ec3[_0x59d134(0x361)]='manual',_0xc25ec3['botname']=_0x59d134(0x39b)+_0x2fd8f0;return _0xc25ec3;}function getBotsWithMode(){const _0x141a9c=_0x1e5f62,_0x5918b5=dbConfig[_0x141a9c(0x31e)](_0x141a9c(0x320))[_0x141a9c(0x308)](_0x141a9c(0x206))[_0x141a9c(0x3a1)]()||[];return _0x5918b5[_0x141a9c(0x35b)](_0x2e6c1f=>{const _0x5bb0ee=_0x141a9c;let _0x182116=getBotAttributes(_0x2e6c1f[_0x5bb0ee(0x206)]);_0x2e6c1f[_0x5bb0ee(0x361)]=_0x182116[_0x5bb0ee(0x361)];}),_0x5918b5;}function getBotExchanges(){const _0x5216db=_0x1e5f62;let _0x59397e=[];const _0x423147=dbConfig[_0x5216db(0x31e)]('bots')[_0x5216db(0x308)](_0x5216db(0x206))['value']()||[];_0x423147[_0x5216db(0x35b)](_0x240872=>{const _0x34e216=_0x5216db;if(_0x240872[_0x34e216(0x299)]==_0x34e216(0x36f)){const _0x3f44d3=configpath+_0x34e216(0x29d)+_0x240872[_0x34e216(0x206)]+'-config.json',_0x1a1250=fs[_0x34e216(0x261)](_0x3f44d3);let _0x21c88a;if(_0x1a1250){const _0x559f2c=fs[_0x34e216(0x2e6)](_0x3f44d3);try{const _0x6f5009=JSON[_0x34e216(0x32e)](_0x559f2c);_0x21c88a=_0x6f5009?_0x6f5009[_0x34e216(0x1fc)][0x0][_0x34e216(0x2b5)]:null;}catch(_0x276bc8){}}if(_0x21c88a)_0x59397e[_0x34e216(0x253)](_0x21c88a);}});const _0x1ab5ea=[...new Set(_0x59397e)][_0x5216db(0x357)]();return _0x1ab5ea;}async function initUser(){const _0x545910=_0x1e5f62;if(!settings[_0x545910(0x35c)]){const _0x536dbc=uuidRandom();mixpanel['alias'](_0x536dbc),updateSetting(_0x545910(0x35c),_0x536dbc);}}async function initSecure(){const _0x370227=_0x1e5f62;let _0x2772a2=getSecure();if(!_0x2772a2[_0x370227(0x370)](_0x370227(0x29f))){let _0x335848=await generateKeys();_0x2772a2['publicKey']=_0x335848[_0x370227(0x335)],_0x2772a2['privateKey']=_0x335848[_0x370227(0x278)],_0x2772a2['secret']=crypto[_0x370227(0x294)](0x20)['toString'](_0x370227(0x20a));;storeSecure(_0x2772a2);}}function getSettings(){const _0x4b5196=_0x1e5f62;return dbSettings[_0x4b5196(0x31e)](_0x4b5196(0x25a))['value']()||{};}function getSecure(){const _0xa75799=_0x1e5f62;return dbSecure[_0xa75799(0x31e)](_0xa75799(0x2dc))['value']()||{};}function getBlacklist(){const _0x1f50ef=_0x1e5f62;return dbSecure[_0x1f50ef(0x31e)](_0x1f50ef(0x1e8))[_0x1f50ef(0x3a1)]()||[];}function broadcastToBots(_0xac5279,_0x289c6a){const _0x430a01=_0x1e5f62;config[_0x430a01(0x35b)](_0xe96e49=>{const _0x31461f=_0x430a01;if(_0xe96e49['status']==_0x31461f(0x36f)&&_0xe96e49[_0x31461f(0x268)]==_0x31461f(0x310)||_0xe96e49[_0x31461f(0x299)]==_0x31461f(0x39c)&&_0xe96e49['live']==_0x31461f(0x310)){if(pid[_0xe96e49[_0x31461f(0x206)]])pid[_0xe96e49[_0x31461f(0x206)]]['send']({[_0xac5279]:_0x289c6a});}});}function storeSettings(_0x8c5ac7,_0x32d759=![]){const _0x1001cf=_0x1e5f62;_0x8c5ac7={...settings,..._0x8c5ac7};if(_0x32d759&&_0x8c5ac7[_0x1001cf(0x2fb)]!=_0x1001cf(0x398)&&_0x8c5ac7['bbPassword']!='***'&&_0x8c5ac7[_0x1001cf(0x2fb)]!=''){const _0x452b8f=crypt[_0x1001cf(0x302)](secure[_0x1001cf(0x278)],_0x8c5ac7[_0x1001cf(0x2fb)])[_0x1001cf(0x36d)]['split']('@')[0x0],_0x1baef5=bcrypt[_0x1001cf(0x2dd)](_0x452b8f,saltRounds);_0x8c5ac7={..._0x8c5ac7,'bbPassword':_0x1baef5};}if(_0x32d759&&_0x8c5ac7[_0x1001cf(0x2c2)]!='************'&&_0x8c5ac7['telegramToken']!=_0x1001cf(0x34f)&&_0x8c5ac7[_0x1001cf(0x2c2)]!=''){const _0x2a8a52=crypt['decrypt'](secure[_0x1001cf(0x278)],_0x8c5ac7['telegramToken'])[_0x1001cf(0x36d)]['split']('@')[0x0];_0x8c5ac7={..._0x8c5ac7,'telegramToken':_0x2a8a52};}const _0x1d3752=_0x8c5ac7['telegramToken']!=_0x1001cf(0x398)&&_0x8c5ac7['telegramToken']!=settings['telegramToken']||_0x8c5ac7['telegramUsername']!=settings[_0x1001cf(0x2d8)],_0x29eafc=_0x8c5ac7['telegramToken']==''||_0x8c5ac7[_0x1001cf(0x2d8)]=='';if(_0x1d3752)_0x8c5ac7[_0x1001cf(0x34a)]=_0x1001cf(0x368);for(const [_0x49e494,_0x28b24a]of Object[_0x1001cf(0x36b)](_0x8c5ac7)){if(_0x49e494==_0x1001cf(0x2c2)&&_0x28b24a==_0x1001cf(0x398)){_0x8c5ac7[_0x1001cf(0x2c2)]=settings[_0x1001cf(0x2c2)];continue;};if(_0x49e494==_0x1001cf(0x2fb)&&_0x28b24a==_0x1001cf(0x398)){_0x8c5ac7[_0x1001cf(0x2fb)]=settings[_0x1001cf(0x2fb)];continue;};dbSettings[_0x1001cf(0x26d)](_0x1001cf(0x1d9)+_0x49e494,_0x28b24a)[_0x1001cf(0x2db)]();}settings=_0x8c5ac7,io['to'](_0x1001cf(0x219))[_0x1001cf(0x319)](_0x1001cf(0x25a),cleanSettings()),broadcastToBots(_0x1001cf(0x33c),settings[_0x1001cf(0x33c)]),broadcastToBots(_0x1001cf(0x1f8),settings['onepagemode']);if(_0x1d3752&&!_0x29eafc)initTelegram();if(_0x1d3752&&_0x29eafc)disableTelegram();getAllClients()['forEach'](_0x5846e9=>{const _0x21fc28=_0x1001cf;getSocket(_0x5846e9['id'])['emit']('status',{'access':{'allow':![],'reason':_0x21fc28(0x35a),'token':null}});});}function updateSetting(_0x3c6d34,_0x1061e0){const _0xc216ee=_0x1e5f62;dbSettings[_0xc216ee(0x26d)](_0xc216ee(0x1d9)+_0x3c6d34,_0x1061e0)[_0xc216ee(0x2db)](),settings=getSettings(),io['to'](_0xc216ee(0x219))['emit'](_0xc216ee(0x25a),cleanSettings());}function storeSecure(_0x58ca09){const _0x39b3e3=_0x1e5f62;dbSecure[_0x39b3e3(0x31e)](_0x39b3e3(0x2dc))[_0x39b3e3(0x253)](_0x58ca09)[_0x39b3e3(0x2db)](),secure=_0x58ca09;}function addBlacklist(_0x1bfd34){const _0x56129a=_0x1e5f62;cleanBlacklist();let _0x4de054;devices[_0x1bfd34]['telegramIpApproval']?_0x4de054=Math[_0x56129a(0x355)](devices[_0x1bfd34][_0x56129a(0x267)][_0x56129a(0x202)],loginExpiry):_0x4de054=loginExpiry,dbSecure[_0x56129a(0x31e)](_0x56129a(0x1e8))[_0x56129a(0x253)]({'expiry':new Date()[_0x56129a(0x33d)]()+_0x4de054*0x3c*0x3e8,'token':devices[_0x1bfd34][_0x56129a(0x250)][_0x56129a(0x266)]})['write'](),blacklist=dbSecure[_0x56129a(0x31e)](_0x56129a(0x1e8))['value']();}function cleanBlacklist(){const _0x26a1da=_0x1e5f62;let _0x345561=dbSecure[_0x26a1da(0x31e)](_0x26a1da(0x1e8))[_0x26a1da(0x1ef)]()[_0x26a1da(0x3a1)](),_0x54e852=new Date()[_0x26a1da(0x33d)]();_0x345561['forEach'](_0x3e42bf=>{const _0x37a140=_0x26a1da;_0x3e42bf[_0x37a140(0x202)]<_0x54e852&&dbSecure[_0x37a140(0x31e)](_0x37a140(0x1e8))[_0x37a140(0x260)]({'expiry':_0x3e42bf['expiry']})[_0x37a140(0x2db)]();});}function initStates(){const _0x5c4971=_0x1e5f62;let _0x2a2657=getConfiguration();_0x2a2657[_0x5c4971(0x35b)](_0x4ca02d=>{_0x4ca02d['live']='stopped';}),storeConfiguration(_0x2a2657);}function onKeys(){const _0x446c87=new RSA();return new Promise(_0x2f1797=>{const _0x2a0fa8=_0x57c7;_0x446c87[_0x2a0fa8(0x1f1)]()[_0x2a0fa8(0x25b)](_0xf1fe6f=>{_0x2f1797(_0xf1fe6f);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x4b0887=_0x1e5f62;let _0x5d1038=getSettings(),_0x535064=![];!_0x5d1038[_0x4b0887(0x370)](_0x4b0887(0x21f))&&(_0x5d1038[_0x4b0887(0x21f)]=0x0,_0x535064=!![]);!_0x5d1038[_0x4b0887(0x370)](_0x4b0887(0x2e5))&&(_0x5d1038['lastmsgemitted']=0x0,_0x535064=!![]);!_0x5d1038[_0x4b0887(0x370)](_0x4b0887(0x1e9))&&(_0x5d1038['latestversion']='0.0.0',_0x535064=!![]);!_0x5d1038[_0x4b0887(0x370)](_0x4b0887(0x1f8))&&(_0x5d1038[_0x4b0887(0x1f8)]=![],_0x535064=!![]);if(_0x535064)storeSettings(_0x5d1038);try{fs[_0x4b0887(0x30b)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x298ba8=>{const _0xc41024=_0x4b0887;if(!_0x298ba8['isDirectory']()){if(!_0x298ba8[_0xc41024(0x2d2)]['startsWith'](_0xc41024(0x394)))fs[_0xc41024(0x38d)](configbackuppath+_0x298ba8[_0xc41024(0x2d2)]);}else fs['rmSync'](configbackuppath+_0x298ba8[_0xc41024(0x2d2)],{'recursive':!![]});});}catch(_0x29e72f){logger[_0x4b0887(0x32a)](_0x4b0887(0x24a),_0x29e72f);}}function storeConfiguration(_0x2cad4d){const _0x218284=_0x1e5f62;dbConfig[_0x218284(0x31e)](_0x218284(0x320))[_0x218284(0x260)]()[_0x218284(0x2db)](),_0x2cad4d[_0x218284(0x35b)](_0xc119aa=>{delete _0xc119aa['mode'];}),dbConfig[_0x218284(0x31e)](_0x218284(0x320))['push'](..._0x2cad4d)[_0x218284(0x2db)](),config=_0x2cad4d;}function resetPassword(){const _0x2925d2=_0x1e5f62;tgBot&&settings[_0x2925d2(0x321)]&&(tgBot['removeListener'](_0x2925d2(0x3a3)),tgBot[_0x2925d2(0x350)](settings[_0x2925d2(0x321)],_0x2925d2(0x27e),{'parse_mode':_0x2925d2(0x37d),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x2925d2(0x2ab)},{'text':'no','callback_data':'no'}]]}})[_0x2925d2(0x239)](_0x4a929b=>{telegramError(_0x4a929b);}),tgBot['on'](_0x2925d2(0x3a3),async _0xe744d4=>{const _0x3c1ad5=_0x2925d2,_0x415669=_0xe744d4[_0x3c1ad5(0x238)],_0x2337a4=_0xe744d4['message'];tgBot[_0x3c1ad5(0x2bd)](_0xe744d4['id'])[_0x3c1ad5(0x25b)](async()=>{const _0x320ebe=_0x3c1ad5;if(_0x415669!='no'){const _0x58b799=0xf,_0x17bfa8=_0x320ebe(0x1e0),_0x10bfce=Array[_0x320ebe(0x2b3)](crypto['randomFillSync'](new Uint32Array(_0x58b799)))[_0x320ebe(0x1f7)](_0x198899=>_0x17bfa8[_0x198899%_0x17bfa8['length']])[_0x320ebe(0x38a)](''),_0x35ed06=bcrypt[_0x320ebe(0x2dd)](_0x10bfce,saltRounds);storeSettings({'bbPassword':_0x35ed06}),await tgBot[_0x320ebe(0x350)](_0x2337a4['chat']['id'],_0x320ebe(0x371)+_0x10bfce,{'parse_mode':_0x320ebe(0x37d)})[_0x320ebe(0x239)](_0x442482=>{telegramError(_0x442482);});}else await tgBot[_0x320ebe(0x350)](_0x2337a4[_0x320ebe(0x281)]['id'],_0x320ebe(0x279))[_0x320ebe(0x239)](_0x55e8d3=>{telegramError(_0x55e8d3);});}),tgBot[_0x3c1ad5(0x3a8)](_0x3c1ad5(0x3a3));}));}async function confirmRestore(_0x2126bf,_0x4b3f14){const _0x4b7efb=_0x1e5f62;io['to'](_0x4b7efb(0x219))[_0x4b7efb(0x319)](_0x4b7efb(0x3a0),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x4b7efb(0x344)),tgBot&&settings['telegramChatId']&&(tgBot[_0x4b7efb(0x3a8)](_0x4b7efb(0x3a3)),await tgBot['sendMessage'](settings[_0x4b7efb(0x321)],_0x4b7efb(0x309),{'parse_mode':_0x4b7efb(0x37d),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x4b7efb(0x2ab)},{'text':'no','callback_data':'no'}]]}})[_0x4b7efb(0x239)](_0x1f3c40=>{telegramError(_0x1f3c40);}),tgBot['on']('callback_query',async _0x415212=>{const _0x4da103=_0x4b7efb,_0x22833e=_0x415212['data'],_0x5d0114=_0x415212[_0x4da103(0x36d)];tgBot['answerCallbackQuery'](_0x415212['id'])[_0x4da103(0x25b)](async()=>{const _0x3c8af2=_0x4da103;_0x22833e=='yes'?(await tgBot[_0x3c8af2(0x350)](_0x5d0114['chat']['id'],_0x3c8af2(0x228),{'parse_mode':_0x3c8af2(0x37d)})[_0x3c8af2(0x239)](_0x52977e=>{telegramError(_0x52977e);}),unzipFile(_0x2126bf,_0x4b3f14)):(logger[_0x3c8af2(0x32a)](_0x3c8af2(0x3aa)),await tgBot[_0x3c8af2(0x350)](_0x5d0114[_0x3c8af2(0x281)]['id'],_0x3c8af2(0x3aa))['catch'](_0x377314=>{telegramError(_0x377314);}));}),tgBot[_0x4da103(0x3a8)](_0x4da103(0x3a3));}));}function getServerTime(){const _0x1fa404=_0x1e5f62,_0x5a1b4b=new Date();return _0x5a1b4b['getFullYear']()+'/'+(_0x5a1b4b[_0x1fa404(0x230)]()+0x1)[_0x1fa404(0x1ce)]()[_0x1fa404(0x251)](0x2,'0')+'/'+_0x5a1b4b[_0x1fa404(0x2f8)]()[_0x1fa404(0x1ce)]()[_0x1fa404(0x251)](0x2,'0')+'\x20'+_0x5a1b4b[_0x1fa404(0x242)]()[_0x1fa404(0x1ce)]()['padStart'](0x2,'0')+':'+_0x5a1b4b['getMinutes']()[_0x1fa404(0x1ce)]()[_0x1fa404(0x251)](0x2,'0')+':'+_0x5a1b4b[_0x1fa404(0x2f2)]()[_0x1fa404(0x1ce)]()[_0x1fa404(0x251)](0x2,'0');}function getTimeStamp(){const _0x26059b=_0x1e5f62,_0x7664d1=shiftedTime();return _0x7664d1[_0x26059b(0x1dd)]()+'/'+(_0x7664d1[_0x26059b(0x230)]()+0x1)[_0x26059b(0x1ce)]()[_0x26059b(0x251)](0x2,'0')+'/'+_0x7664d1[_0x26059b(0x2f8)]()[_0x26059b(0x1ce)]()['padStart'](0x2,'0')+'\x20'+_0x7664d1[_0x26059b(0x242)]()[_0x26059b(0x1ce)]()[_0x26059b(0x251)](0x2,'0')+':'+_0x7664d1[_0x26059b(0x36c)]()['toString']()['padStart'](0x2,'0')+':'+_0x7664d1['getSeconds']()[_0x26059b(0x1ce)]()[_0x26059b(0x251)](0x2,'0');}function getCleanTimeStamp(){const _0x4e2094=_0x1e5f62,_0x3ea420=shiftedTime();return _0x3ea420[_0x4e2094(0x1dd)]()+(_0x3ea420[_0x4e2094(0x230)]()+0x1)['toString']()[_0x4e2094(0x251)](0x2,'0')+_0x3ea420[_0x4e2094(0x2f8)]()[_0x4e2094(0x1ce)]()[_0x4e2094(0x251)](0x2,'0')+'-'+_0x3ea420[_0x4e2094(0x242)]()[_0x4e2094(0x1ce)]()['padStart'](0x2,'0')+_0x3ea420[_0x4e2094(0x36c)]()[_0x4e2094(0x1ce)]()['padStart'](0x2,'0')+_0x3ea420[_0x4e2094(0x2f2)]()[_0x4e2094(0x1ce)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x45ae28=_0x1e5f62,_0x30bff3=new Date();let _0x1375ec=_0x30bff3;if(settings[_0x45ae28(0x33c)]&&settings['timeshift']!==0x0)_0x1375ec=fns['add'](_0x30bff3,{'hours':settings[_0x45ae28(0x33c)]});return _0x1375ec;}function startScheduler(){const _0x2d791d=_0x1e5f62,_0x1fbb1f=new Date()[_0x2d791d(0x1e6)](),_0x35880a=shiftedTime()['getHours']();_0x35880a==0x4&&backupConfigFiles();_0x35880a==0x0&&rotateLogFiles();_0x1fbb1f%0x6==0x0&&triggerAnalytics();_0x1fbb1f%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x38658d){const _0xbade2c=_0x1e5f62;logger['debug'](_0xbade2c(0x34c)+_0x38658d);const _0x507efd=getBotsWithMode();_0x507efd['length']>0x0?confirmRestore(configbackuppath,_0x38658d):unzipFile(configbackuppath,_0x38658d);}async function getBackupFiles(_0x47d51f=null){const _0x5cb966=_0x1e5f62;let _0x4ab5bb=[],_0x50e355=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x50e355[_0x5cb966(0x357)]((_0x1f467a,_0x494d78)=>_0x1f467a[_0x5cb966(0x2d2)]<_0x494d78['name']?0x1:_0x494d78[_0x5cb966(0x2d2)]<_0x1f467a[_0x5cb966(0x2d2)]?-0x1:0x0),_0x50e355[_0x5cb966(0x35b)](_0x2c69eb=>{const _0x1dff79=_0x5cb966;if(!_0x2c69eb[_0x1dff79(0x2fa)]()&&_0x2c69eb['name']['startsWith'](_0x1dff79(0x394))&&_0x2c69eb[_0x1dff79(0x2d2)][_0x1dff79(0x37f)](_0x1dff79(0x3a5))){const _0x11be1d=formatDate(fs[_0x1dff79(0x271)](configbackuppath+_0x2c69eb[_0x1dff79(0x2d2)])[_0x1dff79(0x2eb)]);_0x4ab5bb[_0x1dff79(0x253)]({'name':_0x2c69eb[_0x1dff79(0x2d2)],'mtime':_0x11be1d});}});if(_0x47d51f)io['to'](_0x47d51f)['emit'](_0x5cb966(0x2ee),_0x4ab5bb);else return _0x4ab5bb;}async function backupConfigFiles(){const _0x5a68bd=_0x1e5f62;await zipFiles(_0x5a68bd(0x235));const _0x5f2791=getCleanTimeStamp();fs[_0x5a68bd(0x233)](zippath+_0x5a68bd(0x325),configbackuppath+(_0x5a68bd(0x394)+_0x5f2791+'.zip'));let _0x3dc4f6=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x3dc4f6[_0x5a68bd(0x357)]((_0x50f703,_0x10a5d0)=>_0x50f703[_0x5a68bd(0x2d2)]<_0x10a5d0[_0x5a68bd(0x2d2)]?0x1:_0x10a5d0[_0x5a68bd(0x2d2)]<_0x50f703[_0x5a68bd(0x2d2)]?-0x1:0x0),_0x3dc4f6[_0x5a68bd(0x347)]>maxBackups&&fs[_0x5a68bd(0x38d)](configbackuppath+_0x3dc4f6[_0x3dc4f6[_0x5a68bd(0x347)]-0x1][_0x5a68bd(0x2d2)]);}function rotateLogFiles(){const _0x3c79e1=_0x1e5f62,_0xa1deee=fs['statSync'](logspath+_0x3c79e1(0x2ff)),_0x4db2eb=_0xa1deee[_0x3c79e1(0x26a)]/0x400;if(_0x4db2eb>0x64){let _0x498fb7=fs[_0x3c79e1(0x30b)](logspath,{'withFileTypes':!![]});_0x498fb7['sort']((_0x38fb97,_0x420c3f)=>_0x38fb97[_0x3c79e1(0x2d2)]<_0x420c3f[_0x3c79e1(0x2d2)]?0x1:_0x420c3f[_0x3c79e1(0x2d2)]<_0x38fb97[_0x3c79e1(0x2d2)]?-0x1:0x0),_0x498fb7[_0x3c79e1(0x35b)](_0x49cda4=>{const _0x2e57cb=_0x3c79e1;if(_0x49cda4[_0x2e57cb(0x2d2)]==_0x2e57cb(0x22c))fs[_0x2e57cb(0x233)](logspath+_0x49cda4['name'],logspath+_0x2e57cb(0x2be));if(_0x49cda4['name']=='output-001.log')fs['copyFileSync'](logspath+_0x49cda4[_0x2e57cb(0x2d2)],logspath+_0x2e57cb(0x22c));_0x49cda4[_0x2e57cb(0x2d2)]=='output-000.log'&&(fs[_0x2e57cb(0x233)](logspath+_0x49cda4['name'],logspath+_0x2e57cb(0x1ca)),fs[_0x2e57cb(0x28a)](logspath+_0x49cda4[_0x2e57cb(0x2d2)],''));});}}async function zipFiles(_0x2f6cf1){const _0x5487af=_0x1e5f62;let _0x11cb7a;if(_0x2f6cf1=='logs')_0x11cb7a=logspath;if(_0x2f6cf1==_0x5487af(0x22e))_0x11cb7a=configpath;if(_0x2f6cf1==_0x5487af(0x235))_0x11cb7a=configpath;let _0x50d588=fs['readdirSync'](_0x11cb7a,{'withFileTypes':!![]});const _0x3c9fa5=new require(_0x5487af(0x29b))();_0x50d588['forEach'](_0x30b1e3=>{const _0xe5aab8=_0x5487af;if(!_0x30b1e3['isDirectory']()){let _0x34893b=fs[_0xe5aab8(0x2e6)](_0x11cb7a+_0x30b1e3['name']);if(_0x2f6cf1==_0xe5aab8(0x22e)){const _0x4ff1f9=/^bot-[0-9]{3}-config.json$/,_0x242451=_0x4ff1f9['test'](_0x30b1e3[_0xe5aab8(0x2d2)]);if(_0x242451){const _0x129b94=JSON[_0xe5aab8(0x32e)](_0x34893b);if(_0x129b94['bot'][0x0]){_0x129b94[_0xe5aab8(0x1fc)][0x0][_0xe5aab8(0x296)]=_0xe5aab8(0x34f),_0x129b94[_0xe5aab8(0x1fc)][0x0][_0xe5aab8(0x1fb)]=_0xe5aab8(0x34f);if(_0x129b94[_0xe5aab8(0x1fc)][0x0][_0xe5aab8(0x28f)])_0x129b94[_0xe5aab8(0x1fc)][0x0][_0xe5aab8(0x28f)]=_0xe5aab8(0x34f);}_0x34893b=JSON['stringify'](_0x129b94,null,0x2);}if(_0x30b1e3[_0xe5aab8(0x2d2)]==_0xe5aab8(0x3a6)){const _0x1d7f8f=JSON[_0xe5aab8(0x32e)](_0x34893b);if(_0x1d7f8f[_0xe5aab8(0x25a)][_0xe5aab8(0x1d6)])_0x1d7f8f[_0xe5aab8(0x25a)][_0xe5aab8(0x1d6)]=![];if(_0x1d7f8f[_0xe5aab8(0x25a)]['bbPassword'])_0x1d7f8f['settings']['bbPassword']=_0xe5aab8(0x34f);if(_0x1d7f8f[_0xe5aab8(0x25a)][_0xe5aab8(0x2c2)])_0x1d7f8f[_0xe5aab8(0x25a)]['telegramToken']=_0xe5aab8(0x34f);if(_0x1d7f8f[_0xe5aab8(0x25a)][_0xe5aab8(0x321)])_0x1d7f8f[_0xe5aab8(0x25a)]['telegramChatId']=null;_0x34893b=JSON[_0xe5aab8(0x373)](_0x1d7f8f,null,0x2);}if(_0x30b1e3[_0xe5aab8(0x2d2)]!=_0xe5aab8(0x331))_0x3c9fa5['file'](_0x30b1e3[_0xe5aab8(0x2d2)],_0x34893b);}else _0x3c9fa5['file'](_0x30b1e3['name'],_0x34893b);}});const _0x48d46f=_0x3c9fa5['generate']({'base64':![],'compression':'DEFLATE'});fs[_0x5487af(0x28a)](zippath+(_0x2f6cf1+'.zip'),_0x48d46f,_0x5487af(0x384));}async function unzipFile(_0x16fe65,_0x5bcd5d){const _0x14337f=_0x1e5f62;fs[_0x14337f(0x30b)](configpath,{'withFileTypes':!![]})['forEach'](_0x32f56d=>{const _0x5c1629=_0x14337f;if(!_0x32f56d[_0x5c1629(0x2fa)]())fs[_0x5c1629(0x288)](configpath+_0x32f56d[_0x5c1629(0x2d2)]);});const _0x5192de=fs[_0x14337f(0x2e6)](_0x16fe65+_0x5bcd5d,'binary'),_0x415fad=new require(_0x14337f(0x29b))(_0x5192de,{'base64':![],'checkCRC32':!![]});Object[_0x14337f(0x283)](_0x415fad['files'])[_0x14337f(0x35b)](_0x5bd8c0=>{const _0x12be9f=_0x14337f,_0x2b2559=_0x415fad[_0x12be9f(0x212)][_0x5bd8c0];fs[_0x12be9f(0x28a)](configpath+_0x2b2559[_0x12be9f(0x2d2)],_0x2b2559[_0x12be9f(0x217)]);}),fs[_0x14337f(0x30b)](temppath,{'withFileTypes':!![]})[_0x14337f(0x35b)](_0x21306b=>{const _0x3b326d=_0x14337f;if(!_0x21306b[_0x3b326d(0x2fa)]())fs[_0x3b326d(0x288)](temppath+_0x21306b[_0x3b326d(0x2d2)]);}),logger['debug'](_0x14337f(0x29a)),process[_0x14337f(0x2d0)]({'restore':!![]},_0x3fa69b=>{});}async function getPublicIp(){const _0x2e8eb9=_0x1e5f62;try{const _0x3338d6=await axios[_0x2e8eb9(0x31e)](_0x2e8eb9(0x1f2));publicip=_0x3338d6[_0x2e8eb9(0x238)]['ip'];}catch(_0x43b732){}}async function triggerAnalytics(){const _0x50f87b=_0x1e5f62;if(!publicip)await getPublicIp();const _0x27a85e=getBotsWithMode();let _0x5b10d9=0x0;_0x27a85e[_0x50f87b(0x35b)](_0x2e7364=>{const _0x22bdf5=_0x50f87b;if(_0x2e7364[_0x22bdf5(0x299)]==='enabled')_0x5b10d9++;});const _0xd7b0ed=getBotExchanges();mixpanel[_0x50f87b(0x317)]('Server',{'distinct_id':settings[_0x50f87b(0x35c)],'ip':publicip,'version':serverversion,'numbots':_0x27a85e['length'],'numbotsenabled':_0x5b10d9,'exchanges':_0xd7b0ed});}async function getMessages(){const _0x18e677=_0x1e5f62,_0x55e9cf=_0x18e677(0x397),_0x53a588=new GraphQLClient(_0x55e9cf),_0xe3601f={'authorization':_0x18e677(0x36e)},_0x36bb20=serverversion[_0x18e677(0x20d)]('.'),_0xeac89f=_0x36bb20[0x0]+'.'+_0x36bb20[0x1],_0xefa59=Math[_0x18e677(0x2f0)](settings['lastmsgtelegram'],settings['lastmsgemitted']),_0x2dbc55={'last':parseInt(_0xefa59),'bbm':_0xeac89f},_0x326474=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x158323;try{_0x158323=await _0x53a588[_0x18e677(0x2a6)](_0x326474,_0x2dbc55,_0xe3601f);}catch(_0x21f030){}if(_0x158323&&_0x158323[_0x18e677(0x259)]){let _0x1866dc=settings['lastmsgtelegram'];newMessages=[];for(const _0x5c7be4 of _0x158323[_0x18e677(0x259)]){newMessages[_0x18e677(0x253)](_0x5c7be4);if(_0x5c7be4[_0x18e677(0x28c)])updateSetting(_0x18e677(0x1e9),_0x5c7be4['bbvNew']);let _0x516157=_0x5c7be4[_0x18e677(0x28c)]?serverversion>=_0x5c7be4[_0x18e677(0x28c)]:![];if(!_0x516157&&_0x5c7be4['number']>_0x1866dc){if(_0x5c7be4['bbvReceive']===_0x18e677(0x1db)||serverversion[_0x18e677(0x2e8)](_0x5c7be4['bbvReceive'])){let _0x23ca81=''+_0x5c7be4[_0x18e677(0x285)]+'\x0a\x0a'+_0x5c7be4[_0x18e677(0x36d)];const _0x42a656=await sendTelegramMsg(toTelegramMarkdown(_0x23ca81),_0x18e677(0x2df));if(_0x42a656)_0x1866dc=_0x5c7be4[_0x18e677(0x222)];}}}updateAvailable=isNewerVersion(settings[_0x18e677(0x1e9)],serverversion),updateSetting(_0x18e677(0x21f),_0x1866dc),emitMessages();}}function emitMessages(){const _0x7c14d5=_0x1e5f62,_0x18931d=settings[_0x7c14d5(0x2e5)];let _0x3de83c=[];newMessages['forEach'](_0x514828=>{const _0x2c7fb1=_0x7c14d5;_0x514828[_0x2c7fb1(0x222)]>_0x18931d&&_0x3de83c['push'](_0x514828);}),_0x3de83c['length']>0x0&&getAllClients()['forEach'](_0x262640=>{const _0x375978=_0x7c14d5;getSocket(_0x262640['id'])[_0x375978(0x319)](_0x375978(0x36d),_0x3de83c);});}function _0x57c7(_0xf5822c,_0xfe3c07){const _0x2ff409=_0x1123();return _0x57c7=function(_0x1a3f4d,_0x5529dd){_0x1a3f4d=_0x1a3f4d-0x1c9;let _0x112313=_0x2ff409[_0x1a3f4d];return _0x112313;},_0x57c7(_0xf5822c,_0xfe3c07);}function confirmMessage(_0x30f65b){const _0x6b6985=_0x1e5f62;updateSetting(_0x6b6985(0x2e5),Number(_0x30f65b));}function isNewerVersion(_0x2f5dd2,_0x26e8ba){const _0x151315=_0x1e5f62,_0x7f6d3b=_0x26e8ba[_0x151315(0x20d)]('.'),_0x20f822=_0x2f5dd2['split']('.');for(var _0x1cca5b=0x0;_0x1cca5b<_0x20f822['length'];_0x1cca5b++){const _0xc4b7c=~~_0x20f822[_0x1cca5b],_0x18099a=~~_0x7f6d3b[_0x1cca5b];if(_0xc4b7c>_0x18099a)return!![];if(_0xc4b7c<_0x18099a)return![];}return![];}function toTelegramMarkdown(_0x3d5c73){const _0x19e946=_0x1e5f62,_0x30bc32=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x149ee4=/\*{2}(.+?)\*{2}/gim;return _0x3d5c73=_0x3d5c73['replace'](_0x30bc32,_0x19e946(0x2e4))[_0x19e946(0x1d7)](_0x149ee4,_0x19e946(0x2fc)),_0x3d5c73;}async function validateConfigFile(){const _0x2727e5=_0x1e5f62,_0x4793bb=dbConfig[_0x2727e5(0x31e)](_0x2727e5(0x320))[_0x2727e5(0x308)](_0x2727e5(0x206))['value']()||[];if(_0x4793bb[_0x2727e5(0x347)]==0x0){let _0x28e57b=0x0,_0x1baa26=[];const _0x1b5768=/^bot-([0-9]{3})-config.json$/,_0x46478a=fs[_0x2727e5(0x30b)](configpath);_0x46478a[_0x2727e5(0x35b)](_0x1b518a=>{const _0x2cc2f9=_0x2727e5,_0x16ed3f=_0x1b5768['exec'](_0x1b518a);if(_0x16ed3f){const _0x225965=_0x16ed3f[0x1];let _0x4a34ed=getBotAttributes(_0x225965);_0x1baa26[_0x2cc2f9(0x253)]({'botID':_0x225965,'botname':_0x4a34ed[_0x2cc2f9(0x27d)],'status':_0x2cc2f9(0x32c),'live':_0x2cc2f9(0x31b)}),_0x28e57b++;}}),_0x28e57b!=0x0&&(dbConfig[_0x2727e5(0x31e)](_0x2727e5(0x320))['assign'](_0x1baa26)[_0x2727e5(0x2db)](),config=_0x1baa26,restoredConfigFile=_0x28e57b);}}async function restoreConfigNotify(_0x5ddd2f){const _0x19942b=_0x1e5f62;let _0x3955dd;if(restoredConfigFile==0x1)_0x3955dd=_0x19942b(0x287);else _0x3955dd=_0x19942b(0x27a);if(_0x5ddd2f)io['to'](_0x19942b(0x219))[_0x19942b(0x319)]('notification',_0x3955dd);else{logger[_0x19942b(0x364)](_0x19942b(0x247)),logger[_0x19942b(0x364)](_0x3955dd),logger['simple'](_0x19942b(0x247)),logger[_0x19942b(0x364)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x19942b(0x34a)]!=_0x19942b(0x389))tgBot[_0x19942b(0x350)](settings['telegramChatId'],_0x19942b(0x383)+_0x3955dd)[_0x19942b(0x239)](_0xdf2aee=>{telegramError(_0xdf2aee);});}}function validateCredentials(_0x1e6449,_0x20c78a){const _0x36dd6a=_0x1e5f62;if(_0x1e6449[_0x36dd6a(0x353)]==settings[_0x36dd6a(0x346)]&&bcrypt[_0x36dd6a(0x395)](_0x1e6449[_0x36dd6a(0x248)],settings[_0x36dd6a(0x2fb)])){if(settings[_0x36dd6a(0x30d)])return{'allow':![],'reason':_0x36dd6a(0x36a),'token':null};else{const _0x278410=generateLoginToken(_0x20c78a);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x278410};}}else return{'allow':![],'reason':_0x36dd6a(0x20b),'token':null};}function refreshToken(_0x581f3a){const _0x1d9034=_0x1e5f62,_0x412fef=generateLoginToken(_0x581f3a);return{'allow':!![],'reason':_0x1d9034(0x343),'token':_0x412fef};}function validateAccess(_0xc2c131,_0x580048,_0x37446b){const _0x423361=_0x1e5f62,_0x28e2e0=_0x37446b?_0x37446b:devices[_0x580048]['ip'];let _0xe9225f;const _0x18dc4c=_0x6d700d=>{const _0xf1d5c4=_0x57c7;if(settings[_0xf1d5c4(0x1d6)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x580048)){const _0x51b64f=generateLoginToken(_0x580048);return{'allow':!![],'reason':_0xf1d5c4(0x304),'token':_0x51b64f};}else return{'allow':![],'reason':_0xf1d5c4(0x377),'token':null};}else return _0xe9225f=validToken(_0x6d700d,_0x580048),_0xe9225f[_0xf1d5c4(0x370)](_0xf1d5c4(0x344))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x6d700d}:{'allow':![],'reason':_0xf1d5c4(0x377),'token':null};}else return{'allow':!![],'reason':_0xf1d5c4(0x388),'token':null};};if(settings[_0x423361(0x275)]){let _0x34f016=[...settings[_0x423361(0x1e5)],_0x423361(0x221),_0x423361(0x24f),_0x423361(0x356)];if(_0x34f016['includes'](_0x28e2e0))return _0x18dc4c(_0xc2c131);else{_0xe9225f=validToken(_0xc2c131,_0x580048);if(_0xe9225f[_0x423361(0x370)]('success'))return _0x18dc4c(_0xc2c131);else{if(telegramIpApproved(_0x580048)){const _0x24ecc6=generateToken(_0x580048);return _0xe9225f=_0x18dc4c(_0xc2c131),_0xe9225f[_0x423361(0x290)]?{'allow':!![],'reason':_0x423361(0x1fd),'token':_0x24ecc6}:_0xe9225f;}else return settings[_0x423361(0x209)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x423361(0x337),'token':null};}}}else return _0x18dc4c(_0xc2c131);}function timelyDecrypt(_0x3af016,_0x2e46db=!![]){const _0x2abe87=_0x1e5f62;if(_0x3af016)try{const _0x3f3dcf=crypt[_0x2abe87(0x302)](secure[_0x2abe87(0x278)],_0x3af016)[_0x2abe87(0x36d)],_0x50142d=_0x3f3dcf[_0x2abe87(0x20d)]('@')[0x0],_0x597553=_0x3f3dcf[_0x2abe87(0x20d)]('@')[0x1],_0x58b4cb=new Date()['getTime']();if(_0x2e46db){if(_0x58b4cb-_0x597553<maxSecretAge*0x3e8)return _0x50142d;else return![];}else return _0x50142d;}catch(_0x1ff7a5){return![];}else return![];}const validToken=(_0x3911ef,_0x3b7a02)=>{const _0x22de65=_0x1e5f62,_0x2fb687=devices[_0x3b7a02]['ip'];if(!_0x3911ef)return{'error':_0x22de65(0x315)};for(let _0x5d54bf of blacklist){if(_0x5d54bf[_0x22de65(0x266)]==_0x3911ef)return{'error':'Token\x20blacklisted'};}let _0x14c948;try{_0x14c948=jwt[_0x22de65(0x1e1)](_0x3911ef,secure[_0x22de65(0x29f)]+_0x3b7a02);}catch{return{'error':_0x22de65(0x313)};}if(!_0x14c948['hasOwnProperty'](_0x22de65(0x23d))&&!_0x14c948[_0x22de65(0x370)](_0x22de65(0x353))||!_0x14c948['hasOwnProperty'](_0x22de65(0x358)))return{'error':_0x22de65(0x280)};if(!_0x14c948[_0x22de65(0x370)](_0x22de65(0x353))&&_0x14c948[_0x22de65(0x370)]('clientip')){const {clientip:_0x178e04}=_0x14c948;return _0x2fb687==_0x178e04?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x14c948[_0x22de65(0x370)](_0x22de65(0x353))&&_0x14c948['hasOwnProperty']('clientip')){const {username:_0x17cd55,clientip:_0x5b1014}=_0x14c948;return settings[_0x22de65(0x346)]==_0x17cd55&&_0x2fb687==_0x5b1014?{'success':_0x22de65(0x227)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x10fc4f=>{const _0x314e5f=_0x1e5f62;if(_0x10fc4f){const _0x4de22b=devices[_0x10fc4f]['ip'];return jwt[_0x314e5f(0x1e7)]({'username':settings['bbUsername'],'clientip':_0x4de22b},secure[_0x314e5f(0x29f)]+_0x10fc4f,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x49b2ed=>{const _0x45a78b=_0x1e5f62;if(_0x49b2ed){const _0x521442=devices[_0x49b2ed]['ip'];return jwt[_0x45a78b(0x1e7)]({'clientip':_0x521442},secure[_0x45a78b(0x29f)]+_0x49b2ed,{'expiresIn':devices[_0x49b2ed][_0x45a78b(0x267)][_0x45a78b(0x202)]*0x3c});}else return![];},telegramIpApproved=_0x517f44=>{const _0x5a310b=_0x1e5f62;let _0x3282d9=![];return devices[_0x517f44][_0x5a310b(0x267)]&&devices[_0x517f44][_0x5a310b(0x267)][_0x5a310b(0x202)]!='reject'&&(_0x3282d9=devices[_0x517f44][_0x5a310b(0x267)][_0x5a310b(0x23d)]==devices[_0x517f44]['ip']&&new Date()['getTime']()-devices[_0x517f44]['telegramIpApproval'][_0x5a310b(0x2e0)]<devices[_0x517f44][_0x5a310b(0x267)][_0x5a310b(0x202)]*0x3c*0x3e8),_0x3282d9;},telegram2FaApproved=_0xf89789=>{const _0x570024=_0x1e5f62;let _0x44cd94=![];return devices[_0xf89789][_0x570024(0x33a)]&&devices[_0xf89789]['telegram2FaApproval']['expiry']!=_0x570024(0x2f9)&&(_0x44cd94=devices[_0xf89789][_0x570024(0x33a)][_0x570024(0x23d)]==devices[_0xf89789]['ip']&&new Date()['getTime']()-devices[_0xf89789][_0x570024(0x33a)][_0x570024(0x2e0)]<devices[_0xf89789]['telegram2FaApproval'][_0x570024(0x202)]*0x3c*0x3e8),_0x44cd94;},normalizeIP=_0x3b9b37=>{const _0x54881c=_0x1e5f62;let _0x7e510e=null,_0xf3a30f=null;if(ipaddr[_0x54881c(0x1ee)](_0x3b9b37)){const _0x1a68b7=ipaddr[_0x54881c(0x32e)](_0x3b9b37);_0x1a68b7[_0x54881c(0x25c)]()==='ipv6'?(_0x1a68b7[_0x54881c(0x21c)]()&&(_0x7e510e=_0x1a68b7[_0x54881c(0x342)]()[_0x54881c(0x1ce)]()),_0xf3a30f=_0x1a68b7['toString']()):(_0x7e510e=_0x1a68b7[_0x54881c(0x1ce)](),_0xf3a30f=_0x1a68b7[_0x54881c(0x21b)]()['toString']());}return{'show':_0x7e510e?_0x7e510e:_0xf3a30f,'store':_0xf3a30f};};function formatDate(_0x38f849){const _0x590f80=_0x1e5f62;return _0x38f849['getFullYear']()+'/'+(_0x38f849[_0x590f80(0x230)]()+0x1)[_0x590f80(0x1ce)]()[_0x590f80(0x251)](0x2,'0')+'/'+_0x38f849[_0x590f80(0x2f8)]()['toString']()[_0x590f80(0x251)](0x2,'0')+'\x20'+_0x38f849[_0x590f80(0x242)]()['toString']()[_0x590f80(0x251)](0x2,'0')+':'+_0x38f849[_0x590f80(0x36c)]()[_0x590f80(0x1ce)]()[_0x590f80(0x251)](0x2,'0')+':'+_0x38f849[_0x590f80(0x2f2)]()['toString']()[_0x590f80(0x251)](0x2,'0');}function sleep(_0x2b3577){return new Promise(_0x2fada1=>setTimeout(_0x2fada1,_0x2b3577));}