const _0x569596=_0x44e3;(function(_0x3da075,_0xf06cbc){const _0x5b9c84=_0x44e3,_0x1b968f=_0x3da075();while(!![]){try{const _0x4b6579=parseInt(_0x5b9c84(0x20a))/0x1*(parseInt(_0x5b9c84(0x1ee))/0x2)+-parseInt(_0x5b9c84(0xb6))/0x3*(parseInt(_0x5b9c84(0x1fa))/0x4)+-parseInt(_0x5b9c84(0xe2))/0x5+parseInt(_0x5b9c84(0x155))/0x6*(-parseInt(_0x5b9c84(0x130))/0x7)+parseInt(_0x5b9c84(0x12a))/0x8+parseInt(_0x5b9c84(0xae))/0x9+parseInt(_0x5b9c84(0x249))/0xa*(parseInt(_0x5b9c84(0xba))/0xb);if(_0x4b6579===_0xf06cbc)break;else _0x1b968f['push'](_0x1b968f['shift']());}catch(_0x514480){_0x1b968f['push'](_0x1b968f['shift']());}}}(_0x51e3,0xc05a3));const _0xa4a8a4=function(){let _0x442a0f=!![];return function(_0x457689,_0x200468){const _0x57abdf=_0x442a0f?function(){if(_0x200468){const _0x2eac54=_0x200468['apply'](_0x457689,arguments);return _0x200468=null,_0x2eac54;}}:function(){};return _0x442a0f=![],_0x57abdf;};}(),_0x47f4e4=_0xa4a8a4(this,function(){const _0x2858e1=_0x44e3;return _0x47f4e4['toString']()[_0x2858e1(0x84)](_0x2858e1(0x186))[_0x2858e1(0x118)]()[_0x2858e1(0x139)](_0x47f4e4)[_0x2858e1(0x84)](_0x2858e1(0x186));});_0x47f4e4();'use strict';process[_0x569596(0x20f)][_0x569596(0x1dd)]=0x1;const childProcess=require(_0x569596(0x278)),fs=require('fs'),fns=require(_0x569596(0x108)),low=require(_0x569596(0x20d)),FileSync=require('lowdb/adapters/FileSync'),path=require('path'),crypto=require(_0x569596(0x13f)),forge=require(_0x569596(0x1c3)),bcrypt=require(_0x569596(0x1b2)),jwt=require(_0x569596(0x220)),ipaddr=require(_0x569596(0x282)),argv=require('yargs/yargs')(process[_0x569596(0x1ef)][_0x569596(0x263)](0x2))[_0x569596(0x1ef)],uuidRandom=require(_0x569596(0x1c7)),{Telegraf,Markup}=require(_0x569596(0x125)),Mixpanel=require(_0x569596(0x1c1)),axios=require(_0x569596(0x205)),{GraphQLClient,gql}=require(_0x569596(0x15c)),util=require(_0x569596(0xf8)),fileUpload=require(_0x569596(0x161)),{networkInterfaces}=require('os'),JSZip=require('jszip'),PORT=argv['port']||_0x569596(0x168),pattern=/^[0-9]{2,4}$/;!pattern[_0x569596(0x7d)](PORT)&&(console[_0x569596(0xd7)]('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x569596(0x1f8)](0x1));const HOST=argv[_0x569596(0x14a)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x569596(0xf7)];let bbpath=_0x569596(0x1e7),bbpath2='';const botfile=_0x569596(0x159),configfile='bb-config.json',settingsfile=_0x569596(0xb9),securefile=_0x569596(0xf1),environment=require('./'+bbpath2+_0x569596(0xc3))[_0x569596(0x116)]||_0x569596(0x1d7),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x569596(0x271)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients');let configpath=userID?bbpath+_0x569596(0x1ea)+userID+'/':bbpath+'config/';const configbackuppath=configpath+_0x569596(0x16d),logspath=userID?bbpath+_0x569596(0xda)+userID+'/':bbpath+_0x569596(0xda),zippath=userID?bbpath+_0x569596(0x147)+userID+'/':bbpath+_0x569596(0x147),loggerfile=fs[_0x569596(0x230)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x569596(0xb7)+userID+'/':bbpath+_0x569596(0xb7);!fs[_0x569596(0x271)](configpath)&&fs[_0x569596(0x23a)](configpath);!fs[_0x569596(0x271)](configbackuppath)&&fs[_0x569596(0x23a)](configbackuppath);!fs[_0x569596(0x271)](logspath)&&fs[_0x569596(0x23a)](logspath);!fs['existsSync'](zippath)&&fs[_0x569596(0x23a)](zippath);!fs[_0x569596(0x271)](temppath)&&fs[_0x569596(0x23a)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x569596(0x239)]({'bots':[]})[_0x569596(0x19e)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x569596(0x239)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x569596(0x162),'onepagemode':![],'marketcapApi':''}})[_0x569596(0x19e)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x569596(0x239)]({'secure':{},'blacklist':[]})['write']();const saltRounds=0xa,mixpanel=Mixpanel[_0x569596(0x175)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x569596(0xec)]&&(settings['telegramToken']!=''&&settings[_0x569596(0xec)]!='***')&&settings[_0x569596(0x24f)]&&settings[_0x569596(0x24f)]!='')initTelegram();const parseColor=(_0x8c92c9,_0x2b87ad)=>{const _0x50e50f=_0x569596,_0x593eb3=/#[A-Z]{3}#/g;if(typeof _0x8c92c9==_0x50e50f(0x82)){!_0x2b87ad?_0x8c92c9=_0x8c92c9[_0x50e50f(0x19b)](_0x593eb3,''):(_0x8c92c9=_0x8c92c9['replace'](/#BLU#/g,_0x50e50f(0x184)),_0x8c92c9=_0x8c92c9[_0x50e50f(0x19b)](/#RED#/g,_0x50e50f(0x128)),_0x8c92c9=_0x8c92c9[_0x50e50f(0x19b)](/#YEL#/g,_0x50e50f(0x217)),_0x8c92c9=_0x8c92c9[_0x50e50f(0x19b)](/#MAG#/g,_0x50e50f(0x87)),_0x8c92c9=_0x8c92c9[_0x50e50f(0x19b)](/#CYA#/g,_0x50e50f(0x1cf)),_0x8c92c9=_0x8c92c9[_0x50e50f(0x19b)](/#RES#/g,_0x50e50f(0x181)));;}return _0x8c92c9;},logger={'screen':_0xa46429=>{console['log'](parseColor(_0xa46429,!![]));},'simple':_0x42df77=>{const _0x5e092f=_0x569596;console['log'](parseColor(_0x42df77,!![])),loggerfile[_0x5e092f(0x19e)](util['format'](parseColor(_0x42df77,![]))+'\x0a');},'full':async _0x619f72=>{const _0x23d2b9=_0x569596,_0x531ece=getTimeStamp()+_0x23d2b9(0x180)+_0x619f72;console['log'](parseColor(_0x531ece,!![])),loggerfile[_0x23d2b9(0x19e)](util[_0x23d2b9(0x131)](parseColor(_0x531ece,![]))+'\x0a');if(tgBot&&settings[_0x23d2b9(0x1b3)]&&settings['telegramEvents']!=_0x23d2b9(0x243))await sendTelegram(settings[_0x23d2b9(0x1b3)],_0x23d2b9(0x26e)+parseColor(_0x619f72,![]));},'debug':async(_0x34e5a,_0x189ecd='')=>{const _0x2483f0=_0x569596,_0x61fd88=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x34e5a;if(debugging)console[_0x2483f0(0xd7)](parseColor(_0x61fd88,!![]));loggerfile['write'](util[_0x2483f0(0x131)](parseColor(_0x61fd88,![]))+'\x0a');if(_0x189ecd){if(debugging)console[_0x2483f0(0xd7)](_0x189ecd);loggerfile[_0x2483f0(0x19e)](util[_0x2483f0(0x131)](_0x189ecd)+'\x0a');}}};let terminating=![];process['on'](_0x569596(0x10a),function(_0x28b482){const _0x5015d3=_0x569596;_0x28b482[_0x5015d3(0x118)]()[_0x5015d3(0xa7)](_0x5015d3(0x240))?(logger['simple'](_0x5015d3(0x119)+_0x28b482[_0x5015d3(0x136)]+_0x5015d3(0x210)),process[_0x5015d3(0x1f0)]({'terminate':!![]},_0x44250a=>{})):logger[_0x5015d3(0xc9)](_0x28b482);}),process['on'](_0x569596(0x1f8),()=>{const _0x528e4c=_0x569596;stopAllBots(),process[_0x528e4c(0x1f8)](0x0);}),process['on'](_0x569596(0x81),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x569596(0x28c),()=>{const _0xff1f9e=_0x569596;stopAllBots(),process[_0xff1f9e(0x1f8)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x569596(0xc3))[_0x569596(0xaa)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require('http')[_0x569596(0x24e)](app);app[_0x569596(0x107)](fileUpload({'useTempFiles':!![]})),app[_0x569596(0x27e)](_0x569596(0x115),async(_0x24b255,_0x529361)=>{const _0x2aba42=_0x569596,_0x165840=_0x24b255[_0x2aba42(0x252)]['type'],_0x462e67=getClientsWithBotID(_0x2aba42(0x88)),_0x274d53=_0x24b255['headers'][_0x2aba42(0x13e)],_0x29c784=timelyDecrypt(_0x274d53,![]),_0x387b7e=_0x462e67[_0x2aba42(0x16b)](_0x167ccd=>_0x167ccd[_0x2aba42(0x13e)]==_0x29c784);if(_0x387b7e){const _0x47136d=normalizeIP(_0x24b255[_0x2aba42(0x231)][_0x2aba42(0xd5)])['store'],_0x4e05ec=_0x24b255[_0x2aba42(0x127)][_0x2aba42(0x114)];if(validateAccess(_0x4e05ec,_0x29c784,_0x47136d)[_0x2aba42(0x262)])_0x165840==_0x2aba42(0xc2)&&await backupConfigFiles(),await zipFiles(_0x165840),_0x529361[_0x2aba42(0x26c)](zippath+(_0x165840+'.zip'),_0x4a4615=>{const _0x1ad98f=_0x2aba42;_0x4a4615&&(logger['full']('Failed\x20to\x20download\x20'+_0x165840),logger[_0x1ad98f(0xc9)](_0x4a4615));});else logger[_0x2aba42(0x23d)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x165840+_0x2aba42(0x16a));}else logger[_0x2aba42(0x23d)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x165840+_0x2aba42(0x17c));}),app['post'](_0x569596(0x153),async(_0x225463,_0xe7202d)=>{const _0x3386d7=_0x569596,_0x6f6472=getClientsWithBotID(_0x3386d7(0x88)),_0x49330d=_0x225463[_0x3386d7(0x127)][_0x3386d7(0x13e)],_0x3a8053=timelyDecrypt(_0x49330d,![]),_0x2a8b7c=_0x6f6472['find'](_0x537253=>_0x537253[_0x3386d7(0x13e)]==_0x3a8053);logger[_0x3386d7(0x132)]('Backup\x20file\x20uploaded');if(_0x2a8b7c){const _0x166899=normalizeIP(_0x225463[_0x3386d7(0x231)][_0x3386d7(0xd5)])['store'],_0x155140=_0x225463[_0x3386d7(0x127)]['tkn'];if(validateAccess(_0x155140,_0x3a8053,_0x166899)[_0x3386d7(0x262)]){if(_0x225463[_0x3386d7(0x1c5)]){const _0x2d8b7e=_0x225463['files'][_0x3386d7(0x23f)];await _0x2d8b7e['mv'](temppath+_0x2d8b7e['name']),_0xe7202d[_0x3386d7(0x1f0)]({'status':!![],'message':_0x3386d7(0x109)});const _0x1af2d3=getBotsWithMode();_0x1af2d3[_0x3386d7(0x179)]>0x0?confirmRestore(temppath,_0x2d8b7e[_0x3386d7(0x15e)]):unzipFile(temppath,_0x2d8b7e[_0x3386d7(0x15e)]);}}else logger['full'](_0x3386d7(0x1a2));}else logger[_0x3386d7(0x23d)](_0x3386d7(0x24c));}),app[_0x569596(0x107)](express[_0x569596(0x237)](path[_0x569596(0xeb)](__dirname,bbpath2,_0x569596(0x16e)))),app[_0x569596(0x107)](express['static'](path[_0x569596(0xeb)](__dirname,bbpath2,_0x569596(0x1e4)))),app[_0x569596(0x27e)]('/',function(_0x3c82ce,_0xbd8bd6){const _0x3e2ed9=_0x569596;_0xbd8bd6[_0x3e2ed9(0x1cb)](path[_0x3e2ed9(0xeb)](__dirname,bbpath2,_0x3e2ed9(0x16e),'index.html'));}),app['get']('/:bot',function(_0x185051,_0x3a26c8){const _0x1635f1=_0x569596;_0x3a26c8[_0x1635f1(0x1cb)](path['join'](__dirname,bbpath2,_0x1635f1(0x1e4),_0x1635f1(0x204)));}),app[_0x569596(0x27e)](_0x569596(0x111),(_0x2df003,_0x51bb6a)=>{const _0x3e7123=_0x569596;_0x51bb6a['sendFile'](path[_0x3e7123(0xeb)](__dirname,bbpath2,_0x3e7123(0x1e4),_0x3e7123(0x204)));}),app[_0x569596(0x27e)](_0x569596(0x92),(_0x3bb663,_0x18e552)=>{const _0x50f115=_0x569596;_0x18e552['sendFile'](path[_0x50f115(0xeb)](__dirname,bbpath2,'build',_0x50f115(0x204)));}),app[_0x569596(0x27e)](_0x569596(0xa8),(_0x100a64,_0x5a4e2b)=>{const _0xa8417d=_0x569596;_0x5a4e2b['sendFile'](path[_0xa8417d(0xeb)](__dirname,bbpath2,_0xa8417d(0x1e4),_0xa8417d(0x204)));}),app[_0x569596(0x27e)](_0x569596(0x10d),(_0x1c188f,_0x52e683)=>{const _0x36eaa4=_0x569596;_0x52e683[_0x36eaa4(0x1cb)](path[_0x36eaa4(0xeb)](__dirname,bbpath2,_0x36eaa4(0x1e4),_0x36eaa4(0x204)));}),app['get']('/:bot/configuration',(_0x149a51,_0x158256)=>{const _0x2db6fc=_0x569596;_0x158256[_0x2db6fc(0x1cb)](path[_0x2db6fc(0xeb)](__dirname,bbpath2,_0x2db6fc(0x1e4),_0x2db6fc(0x204)));}),app[_0x569596(0x27e)](_0x569596(0x1b1),(_0x37bc23,_0x22c4ca)=>{const _0x1f6ac8=_0x569596;_0x22c4ca['sendFile'](path['join'](__dirname,bbpath2,_0x1f6ac8(0x1e4),'index.html'));});if(HOST)http[_0x569596(0x26f)](PORT,HOST);else http[_0x569596(0x26f)](PORT);const io=require(_0x569596(0x169))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x25a7b2=_0x569596;let _0x23649d=_0x25a7b2(0xe4);const _0x573b67=networkInterfaces(),_0x1997de={};for(const _0x511053 of Object[_0x25a7b2(0x134)](_0x573b67)){for(const _0x4ce04a of _0x573b67[_0x511053]){if((_0x4ce04a[_0x25a7b2(0x137)]==_0x25a7b2(0x1fd)||_0x4ce04a[_0x25a7b2(0x137)]==0x4)&&!_0x4ce04a[_0x25a7b2(0x93)]){const _0x3491b2=ipaddr[_0x25a7b2(0x126)](_0x4ce04a[_0x25a7b2(0x9d)])[_0x25a7b2(0x11e)]();_0x3491b2!=_0x25a7b2(0x176)&&(!_0x1997de[_0x511053]&&(_0x1997de[_0x511053]=[]),_0x1997de[_0x511053][_0x25a7b2(0x13d)](_0x4ce04a[_0x25a7b2(0x9d)]),_0x23649d=_0x4ce04a[_0x25a7b2(0x9d)]);}}}return{'serverip':_0x23649d,'netinterfaces':_0x1997de};}async function startServer(){const _0x21bbaa=_0x569596,{serverip:_0x3496b5,netinterfaces:_0x2ee428}=getServerIP();logger['simple'](''),logger[_0x21bbaa(0xc9)]('-----------------------------------------------------------------------------------'),await logger['full'](_0x21bbaa(0x242)+serverversion+_0x21bbaa(0x261)+(environment==_0x21bbaa(0xde)?_0x21bbaa(0x28b):'')+'\x0a'+(_0x21bbaa(0x89)+PORT+_0x21bbaa(0x22f))+(_0x21bbaa(0x9b)+_0x3496b5+':'+PORT+_0x21bbaa(0x122))),logger[_0x21bbaa(0xc9)](_0x21bbaa(0x10c));if(config[_0x21bbaa(0x179)]!=0x0)for(const _0x85289f of config){const _0x4ff115=_0x85289f[_0x21bbaa(0x18e)]==_0x21bbaa(0x97)?'a':'m';if(_0x85289f[_0x21bbaa(0x182)]=='enabled'||_0x85289f[_0x21bbaa(0x182)]=='new')await logger['full']('Starting\x20('+_0x4ff115+_0x21bbaa(0x16f)+_0x85289f[_0x21bbaa(0xe6)]+_0x21bbaa(0x1b6)+_0x85289f[_0x21bbaa(0x1fc)]),startBot([_0x85289f['botID'],userID],{'cwd':bbpath},function(_0x348f16){const _0x197bc3=_0x21bbaa;if(_0x348f16)logger[_0x197bc3(0x23d)](_0x348f16);});else(_0x85289f['status']==_0x21bbaa(0x27a)||_0x85289f['status']==_0x21bbaa(0x85))&&await logger[_0x21bbaa(0x23d)](_0x21bbaa(0x21b)+_0x4ff115+_0x21bbaa(0x27f)+_0x85289f[_0x21bbaa(0xe6)]+_0x21bbaa(0x1b6)+_0x85289f[_0x21bbaa(0x1fc)]);}else!newBot&&logger['simple'](_0x21bbaa(0xdb));if(newBot)addBot();logger[_0x21bbaa(0xc9)]('-----------------------------------------------------------------------------------'),logger[_0x21bbaa(0xc9)](''),await logger[_0x21bbaa(0x132)](_0x21bbaa(0x165)+nodeversion),await logger[_0x21bbaa(0x132)]('Network\x20Interfaces:',_0x2ee428);}function startSocket(){io['on']('connection',_0xee7ae8=>{const _0x3e3024=_0x44e3;let _0x4f8775,_0x519f62,_0x5035e5,_0xed395b,_0x1e7e9e;const _0x428cba=_0xee7ae8[_0x3e3024(0xfb)][_0x3e3024(0x127)][_0x3e3024(0x178)];_0x519f62=_0x428cba[_0x3e3024(0xcf)](/bot[0-9]{3}/);if(_0x519f62)_0x5035e5=_0x519f62[0x0][_0x3e3024(0xcf)](/[0-9]{3}/);if(_0x5035e5)_0x4f8775=_0x5035e5[0x0];else _0x4f8775=_0x3e3024(0x88);const _0x11d504=_0xee7ae8[_0x3e3024(0xfb)][_0x3e3024(0xe7)][_0x3e3024(0x1c8)];if(!_0x11d504)_0xee7ae8[_0x3e3024(0x280)]('status',{'publicKey':secure[_0x3e3024(0x1a7)]});else{_0xed395b=timelyDecrypt(_0x11d504,![]);if(!_0xed395b)_0xee7ae8[_0x3e3024(0x280)](_0x3e3024(0x182),{'publicKey':secure[_0x3e3024(0x1a7)]});else{_0x1e7e9e=normalizeIP(_0xee7ae8['conn']['remoteAddress'])['store'];if(!devices[_0xed395b])devices[_0xed395b]={'uuid':_0xed395b,'access':{'token':null}};devices[_0xed395b]['ip']=_0x1e7e9e;const _0x13d8d5=addClient(_0xee7ae8['id'],_0xed395b,_0x4f8775);setAccess(_0x13d8d5),emitMessages(),_0xee7ae8['on'](_0x3e3024(0x21d),_0x9302a3=>{const _0x237419=_0x3e3024,_0x369ae5=timelyDecrypt(_0x9302a3[_0x237419(0x1aa)],!![],_0x237419(0x1a8));if(_0x369ae5){_0x9302a3={'username':_0x9302a3[_0x237419(0x20e)],'password':_0x369ae5},devices[_0xed395b]['access']=validateCredentials(_0x9302a3,_0xed395b);if(devices[_0xed395b]['access'][_0x237419(0x262)]==![]&&devices[_0xed395b][_0x237419(0xb3)]['reason']=='2FA\x20login\x20required')_0xee7ae8['emit'](_0x237419(0x182),{'access':devices[_0xed395b][_0x237419(0xb3)]}),loginAccess2FA(_0xed395b,_0x1e7e9e);else{if(devices[_0xed395b]['access'][_0x237419(0x262)]==![]&&devices[_0xed395b][_0x237419(0xb3)][_0x237419(0x27c)]==_0x237419(0xfd))_0xee7ae8[_0x237419(0x280)](_0x237419(0x182),{'access':devices[_0xed395b][_0x237419(0xb3)]});else devices[_0xed395b][_0x237419(0xb3)][_0x237419(0x262)]&&devices[_0xed395b][_0x237419(0xb3)]['reason']==_0x237419(0x91)&&(getClientsWithUuid(_0xed395b)[_0x237419(0x202)](_0x329a68=>{setAccess(_0x329a68);}),logger['debug'](_0x237419(0x273)+_0xed395b['slice'](-0x8)),setTokenRefresh(_0xed395b),setSessionTimeout(_0x237419(0x21d),_0xed395b));}}else logger[_0x237419(0x23d)](_0x237419(0x9c));}),_0xee7ae8['on'](_0x3e3024(0x167),()=>{resetPassword();}),_0xee7ae8['on'](_0x3e3024(0x20b),_0x3dcfc3=>{removeClient(_0xee7ae8['id']);}),_0x4f8775==_0x3e3024(0x88)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4f7870){const _0x4a75ba=_0x569596;if(_0x4f7870!='botmanager'&&config[_0x4a75ba(0xc0)]!=''){if(pid[_0x4f7870])pid[_0x4f7870][_0x4a75ba(0x1f0)]({'function':_0x4a75ba(0x213),'args':null});}_0x4f7870!='botmanager'&&broadcastToBots('bots',JSON[_0x4a75ba(0x226)](config));}function reloadBotManager(){const _0x13d9d8=_0x569596;getClientsWithBotID(_0x13d9d8(0x88))[_0x13d9d8(0x202)](_0x27c4bb=>{const _0x433eea=_0x13d9d8;getSocket(_0x27c4bb['id'])[_0x433eea(0x280)](_0x433eea(0x182),{'access':{'allow':![],'reason':_0x433eea(0x142),'token':null}});});}function getSocket(_0x35aed4){const _0x3b8a28=_0x569596,_0x5bff5f=io['_nsps'][_0x3b8a28(0x27e)]('/');return _0x5bff5f[_0x3b8a28(0xe9)]['get'](_0x35aed4);}function setAccess(_0x1f68d8){const _0x132d2e=_0x569596,_0x5ae770=getSocket(_0x1f68d8['id']),_0x460c59=_0x1f68d8['uuid'],_0x37a78a=_0x1f68d8[_0x132d2e(0x225)];devices[_0x460c59][_0x132d2e(0xb3)]=validateAccess(devices[_0x460c59][_0x132d2e(0xb3)][_0x132d2e(0x255)],_0x460c59),logger[_0x132d2e(0x132)](_0x132d2e(0x25a)+devices[_0x460c59]['access'][_0x132d2e(0x27c)]+_0x132d2e(0x254)+_0x1f68d8['id'][_0x132d2e(0x263)](-0x8)+'\x20|\x20user:\x20...'+_0x460c59['slice'](-0x8)),_0x5ae770['join'](_0x460c59);if(devices[_0x460c59][_0x132d2e(0xb3)]['allow']){_0x5ae770['join'](_0x37a78a);if(_0x37a78a==_0x132d2e(0x88))initializeSocketBotManager(_0x5ae770);else initializeSocketBot(_0x5ae770);initClient(_0x37a78a);}devices[_0x460c59][_0x132d2e(0xb3)][_0x132d2e(0x255)]&&devices[_0x460c59][_0x132d2e(0xb3)]['reason']=='temporary\x20token\x20generated'&&setSessionTimeout(_0x132d2e(0xe0),_0x460c59),devices[_0x460c59][_0x132d2e(0xb3)][_0x132d2e(0x255)]&&devices[_0x460c59]['access']['reason']==_0x132d2e(0x221)&&setSessionTimeout(_0x132d2e(0x21d),_0x460c59),_0x5ae770[_0x132d2e(0x280)](_0x132d2e(0x182),{'status':_0x1f68d8[_0x132d2e(0x1e6)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x460c59][_0x132d2e(0xb3)],'externalip':devices[_0x460c59]['ip'],'publicKey':secure[_0x132d2e(0x1a7)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x460c59]['access'][_0x132d2e(0x262)]==![]&&devices[_0x460c59][_0x132d2e(0xb3)][_0x132d2e(0x27c)]=='2FA\x20required'&&temporaryAccess2FA(_0x460c59,devices[_0x460c59]['ip']);}function setSessionTimeout(_0x4471da,_0x360e34){const _0x2b1658=_0x569596;let _0x1b07fb;if(_0x4471da==_0x2b1658(0x21d))_0x1b07fb=loginExpiry*0x3c*0x3e8;else _0x1b07fb=devices[_0x360e34][_0x2b1658(0x26d)][_0x2b1658(0x146)]*0x3c*0x3e8-(new Date()[_0x2b1658(0xe5)]()-devices[_0x360e34][_0x2b1658(0x26d)]['timestamp']);if(devices[_0x360e34][_0x2b1658(0x9f)])clearTimeout(devices[_0x360e34][_0x2b1658(0x9f)]);devices[_0x360e34][_0x2b1658(0x9f)]=setTimeout(()=>{const _0x45c36d=_0x2b1658;if(devices[_0x360e34]['pidRefreshToken'])clearTimeout(devices[_0x360e34][_0x45c36d(0x25f)]);removeSocketListeners(_0x360e34),addBlacklist(_0x360e34),devices[_0x360e34][_0x45c36d(0x26d)]=null,devices[_0x360e34][_0x45c36d(0x8f)]=null,devices[_0x360e34][_0x45c36d(0xb3)]['token']=null,logger[_0x45c36d(0x132)](_0x45c36d(0x256)+_0x360e34[_0x45c36d(0x263)](-0x8)),devices[_0x360e34][_0x45c36d(0xb3)]=validateAccess(devices[_0x360e34][_0x45c36d(0xb3)][_0x45c36d(0x255)],_0x360e34),!(devices[_0x360e34]['access'][_0x45c36d(0x262)]&&devices[_0x360e34]['access']['reason']==_0x45c36d(0x1de))&&(_0x4471da==_0x45c36d(0x21d)?io['to'](_0x360e34)[_0x45c36d(0x280)](_0x45c36d(0x182),{'access':{'allow':![],'reason':_0x45c36d(0xcc),'token':null}}):io['to'](_0x360e34)[_0x45c36d(0x280)](_0x45c36d(0x182),{'access':{'allow':![],'reason':_0x45c36d(0x10b),'token':null}})),devices[_0x360e34][_0x45c36d(0xb3)][_0x45c36d(0x255)]=null;},_0x1b07fb);}function setTokenRefresh(_0x2ad130){const _0x108366=_0x569596;if(devices[_0x2ad130][_0x108366(0x25f)])clearTimeout(devices[_0x2ad130][_0x108366(0x25f)]);devices[_0x2ad130][_0x108366(0x25f)]=setTimeout(()=>{const _0x548b62=_0x108366;getClientsWithUuid(_0x2ad130)['length']!=0x0?(devices[_0x2ad130][_0x548b62(0xb3)]=refreshToken(_0x2ad130),io['to'](_0x2ad130)[_0x548b62(0x280)](_0x548b62(0x182),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2ad130][_0x548b62(0xb3)],'externalip':devices[_0x2ad130]['ip'],'publicKey':secure[_0x548b62(0x1a7)],'validInstallation':validInstallation}),setTokenRefresh(_0x2ad130)):clearTimeout(devices[_0x2ad130][_0x548b62(0x25f)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x47665a){const _0x425626=_0x569596,_0x452e5a=getClient(_0x47665a['id'])[_0x425626(0x13e)];_0x47665a[_0x425626(0x280)](_0x425626(0x247),config),_0x47665a[_0x425626(0x280)](_0x425626(0x1bd),cleanSettings()),_0x47665a['on']('add-bot',_0x190f20=>{const _0x31155b=_0x425626;if(validateAccess(_0x190f20,_0x452e5a)[_0x31155b(0x262)])addBot();else logger[_0x31155b(0x23d)](_0x31155b(0x284));}),_0x47665a['on']('update-bot',(_0x21d1d8,_0x1104fc)=>{const _0x26c86d=_0x425626;if(validateAccess(_0x1104fc,_0x452e5a)[_0x26c86d(0x262)])toggleBot(_0x21d1d8[_0x26c86d(0xe6)],_0x21d1d8['status'],_0x21d1d8[_0x26c86d(0x246)]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x47665a['on']('toggle-bot-mode',(_0x30a5f9,_0x3c885b)=>{const _0x452df4=_0x425626;if(validateAccess(_0x3c885b,_0x452e5a)[_0x452df4(0x262)])toggleBotMode(_0x30a5f9);else logger[_0x452df4(0x23d)](_0x452df4(0xa0));}),_0x47665a['on']('delete-bot',(_0xd372e3,_0x55787c)=>{const _0x3c44f2=_0x425626;if(validateAccess(_0x55787c,_0x452e5a)['allow'])deleteBot(_0xd372e3);else logger['full'](_0x3c44f2(0x1a9));}),_0x47665a['on'](_0x425626(0x113),(_0x3907a9,_0x536c60)=>{const _0x985da3=_0x425626;if(validateAccess(_0x536c60,_0x452e5a)[_0x985da3(0x262)])storeSettings(_0x3907a9,!![]);else logger[_0x985da3(0x23d)](_0x985da3(0x207));}),_0x47665a['on'](_0x425626(0x194),_0x42c4a8=>{const _0x1748ab=_0x425626;if(validateAccess(_0x42c4a8,_0x452e5a)[_0x1748ab(0x262)])updateBB(_0x1748ab(0xa1));else logger[_0x1748ab(0x23d)](_0x1748ab(0x22e));}),_0x47665a['on']('reinstall-bb',_0x433f27=>{const _0x4c51ff=_0x425626;if(validateAccess(_0x433f27,_0x452e5a)[_0x4c51ff(0x262)])updateBB(_0x4c51ff(0x183));else logger[_0x4c51ff(0x23d)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x47665a['on']('get-backup-files',_0x157ced=>{const _0x33ec42=_0x425626;if(validateAccess(_0x157ced,_0x452e5a)[_0x33ec42(0x262)]){const _0x4f8ae8=getClient(_0x47665a['id']);if(_0x4f8ae8)getBackupFiles(_0x4f8ae8[_0x33ec42(0x13e)]);else logger['full'](_0x33ec42(0xd8));}else logger[_0x33ec42(0x23d)](_0x33ec42(0x140));}),_0x47665a['on'](_0x425626(0xb5),(_0x1d8776,_0x21a330)=>{const _0x23dd42=_0x425626;if(validateAccess(_0x21a330,_0x452e5a)[_0x23dd42(0x262)])restoreBackupFile(_0x1d8776);else logger[_0x23dd42(0x23d)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x47665a['on'](_0x425626(0x11c),_0x34a4d5=>{const _0x5eb403=_0x425626;if(validateAccess(_0x34a4d5,_0x452e5a)[_0x5eb403(0x262)])getMessages();else logger['full'](_0x5eb403(0x26a));}),_0x47665a['on'](_0x425626(0x19d),(_0x213cf7,_0x2b1695)=>{const _0x5a8d2d=_0x425626;if(validateAccess(_0x2b1695,_0x452e5a)['allow'])confirmMessage(_0x213cf7);else logger['full'](_0x5a8d2d(0x1d1));}),_0x47665a['on']('logout',_0x5a03d3=>{const _0x15ba84=_0x425626;if(validateAccess(_0x5a03d3,_0x452e5a)[_0x15ba84(0x262)]){if(devices[_0x452e5a][_0x15ba84(0x25f)])clearTimeout(devices[_0x452e5a]['pidRefreshToken']);if(devices[_0x452e5a][_0x15ba84(0x9f)])clearTimeout(devices[_0x452e5a][_0x15ba84(0x9f)]);removeSocketListeners(getClient(_0x47665a['id'])[_0x15ba84(0x13e)]),addBlacklist(_0x452e5a),devices[_0x452e5a][_0x15ba84(0x26d)]=null,devices[_0x452e5a][_0x15ba84(0x8f)]=null,devices[_0x452e5a][_0x15ba84(0xb3)][_0x15ba84(0x255)]=null,logger[_0x15ba84(0x132)](_0x15ba84(0x253)+_0x452e5a[_0x15ba84(0x263)](-0x8)),io['to'](getClient(_0x47665a['id'])[_0x15ba84(0x13e)])[_0x15ba84(0x280)](_0x15ba84(0x182),{'access':{'allow':![],'reason':_0x15ba84(0x1be),'token':null}});}else logger[_0x15ba84(0x23d)](_0x15ba84(0x1bb));});}function initializeSocketBot(_0x47fe35){const _0x53c272=_0x569596,_0x31c075=getClient(_0x47fe35['id'])[_0x53c272(0x225)],_0x9c749=getClient(_0x47fe35['id'])[_0x53c272(0x13e)];_0x47fe35['on'](_0x53c272(0x22c),(_0x46cc69,_0x5ef814)=>{const _0x2e0e60=_0x53c272;if(validateAccess(_0x5ef814,_0x9c749)[_0x2e0e60(0x262)]){if(pid[_0x31c075])pid[_0x31c075]['send']({'function':_0x2e0e60(0x99),'args':_0x46cc69});}else logger[_0x2e0e60(0x23d)](_0x2e0e60(0x11f));}),_0x47fe35['on']('delete-alerts',(_0x1772a7,_0x74e74f)=>{const _0x44ffc8=_0x53c272;if(validateAccess(_0x74e74f,_0x9c749)[_0x44ffc8(0x262)]){if(pid[_0x31c075])pid[_0x31c075]['send']({'function':_0x44ffc8(0x216),'args':_0x1772a7});}else logger[_0x44ffc8(0x23d)](_0x44ffc8(0xf9));}),_0x47fe35['on'](_0x53c272(0x1d0),(_0x1b5ee8,_0x1f1b09)=>{const _0xc76cd3=_0x53c272;if(validateAccess(_0x1f1b09,_0x9c749)['allow']){if(pid[_0x31c075])pid[_0x31c075][_0xc76cd3(0x1f0)]({'function':_0xc76cd3(0x1f5),'args':_0x1b5ee8});}else logger[_0xc76cd3(0x23d)](_0xc76cd3(0x112));}),_0x47fe35['on'](_0x53c272(0x95),(_0x6c53cb,_0x4af20b)=>{const _0x5f23bd=_0x53c272;if(validateAccess(_0x4af20b,_0x9c749)[_0x5f23bd(0x262)]){if(pid[_0x31c075])pid[_0x31c075]['send']({'function':_0x5f23bd(0x245),'args':_0x6c53cb});}else logger['full'](_0x5f23bd(0x208));}),_0x47fe35['on']('store-headless',(_0x49bd80,_0x587129)=>{const _0xe4238d=_0x53c272;if(validateAccess(_0x587129,_0x9c749)[_0xe4238d(0x262)]){if(pid[_0x31c075])pid[_0x31c075][_0xe4238d(0x1f0)]({'function':_0xe4238d(0x1a5),'args':_0x49bd80});}else logger[_0xe4238d(0x23d)](_0xe4238d(0x218));}),_0x47fe35['on'](_0x53c272(0x272),(_0x317681,_0x1666c6)=>{const _0x2e9e89=_0x53c272;if(validateAccess(_0x1666c6,_0x9c749)[_0x2e9e89(0x262)]){if(pid[_0x31c075])pid[_0x31c075]['send']({'function':_0x2e9e89(0x265),'args':_0x317681});}else logger[_0x2e9e89(0x23d)](_0x2e9e89(0x9a));}),_0x47fe35['on'](_0x53c272(0x129),_0x2b924f=>{const _0x14c987=_0x53c272;if(validateAccess(_0x2b924f,_0x9c749)['allow']){if(pid[_0x31c075])pid[_0x31c075][_0x14c987(0x1f0)]({'function':_0x14c987(0xf0),'args':null});}else logger[_0x14c987(0x23d)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x47fe35['on']('get-starting-balances',_0x5a4e31=>{const _0x37adc2=_0x53c272;if(validateAccess(_0x5a4e31,_0x9c749)[_0x37adc2(0x262)]){if(pid[_0x31c075])pid[_0x31c075][_0x37adc2(0x1f0)]({'function':'getStartingBalances','args':null});}else logger[_0x37adc2(0x23d)](_0x37adc2(0xc8));}),_0x47fe35['on'](_0x53c272(0x1db),(_0x46077a,_0x5d1999)=>{const _0x3a2db4=_0x53c272;if(validateAccess(_0x5d1999,_0x9c749)[_0x3a2db4(0x262)]){if(pid[_0x31c075])pid[_0x31c075]['send']({'function':_0x3a2db4(0x248),'args':_0x46077a});}else logger[_0x3a2db4(0x23d)](_0x3a2db4(0x102));}),_0x47fe35['on'](_0x53c272(0xbd),_0xe006b0=>{const _0x1a58bb=_0x53c272;if(validateAccess(_0xe006b0,_0x9c749)[_0x1a58bb(0x262)]){if(pid[_0x31c075])pid[_0x31c075][_0x1a58bb(0x1f0)]({'function':'cancelLoading','args':null});}else logger[_0x1a58bb(0x23d)](_0x1a58bb(0x13b));}),_0x47fe35['on'](_0x53c272(0xd1),_0xed67fb=>{const _0x3d83aa=_0x53c272;if(validateAccess(_0xed67fb,_0x9c749)['allow']){if(pid[_0x31c075])pid[_0x31c075][_0x3d83aa(0x1f0)]({'function':_0x3d83aa(0xa6),'args':null});}else logger[_0x3d83aa(0x23d)](_0x3d83aa(0x90));}),_0x47fe35['on'](_0x53c272(0x194),_0x5616b7=>{const _0x40fb92=_0x53c272;if(validateAccess(_0x5616b7,_0x9c749)[_0x40fb92(0x262)])updateBB(_0x40fb92(0xa1));else logger[_0x40fb92(0x23d)](_0x40fb92(0x22e));}),_0x47fe35['on']('get-messages',_0x3f2632=>{const _0x1e9f3a=_0x53c272;if(validateAccess(_0x3f2632,_0x9c749)[_0x1e9f3a(0x262)])getMessages();else logger[_0x1e9f3a(0x23d)](_0x1e9f3a(0x26a));}),_0x47fe35['on'](_0x53c272(0x19d),(_0x1e62ca,_0xa5912b)=>{const _0x466786=_0x53c272;if(validateAccess(_0xa5912b,_0x9c749)[_0x466786(0x262)])confirmMessage(_0x1e62ca);else logger[_0x466786(0x23d)](_0x466786(0x1d1));}),_0x47fe35['on'](_0x53c272(0x1e5),_0x308016=>{const _0x17c916=_0x53c272;if(validateAccess(_0x308016,_0x9c749)[_0x17c916(0x262)]){if(devices[_0x9c749][_0x17c916(0x25f)])clearTimeout(devices[_0x9c749][_0x17c916(0x25f)]);if(devices[_0x9c749][_0x17c916(0x9f)])clearTimeout(devices[_0x9c749][_0x17c916(0x9f)]);removeSocketListeners(getClient(_0x47fe35['id'])[_0x17c916(0x13e)]),addBlacklist(_0x9c749),devices[_0x9c749][_0x17c916(0x26d)]=null,devices[_0x9c749][_0x17c916(0x8f)]=null,devices[_0x9c749]['access'][_0x17c916(0x255)]=null,logger[_0x17c916(0x132)](_0x17c916(0x253)+_0x9c749[_0x17c916(0x263)](-0x8)),io['to'](getClient(_0x47fe35['id'])[_0x17c916(0x13e)])[_0x17c916(0x280)](_0x17c916(0x182),{'access':{'allow':![],'reason':_0x17c916(0x1be),'token':null}});}else logger[_0x17c916(0x23d)](_0x17c916(0x1bb));});}function removeSocketListeners(_0x3d0403){getClientsWithUuid(_0x3d0403)['forEach'](_0x4b7126=>{const _0xad9ca5=_0x44e3;getSocket(_0x4b7126['id'])[_0xad9ca5(0x12b)]();});}function cleanSettings(){const _0x1ca0a9=_0x569596;let _0x3eb35f=settings;return settings[_0x1ca0a9(0xec)]&&settings[_0x1ca0a9(0xec)]!=''&&(_0x3eb35f={..._0x3eb35f,'telegramToken':_0x1ca0a9(0x24d)}),settings['bbPassword']&&settings[_0x1ca0a9(0x13a)]!=''&&(_0x3eb35f={..._0x3eb35f,'bbPassword':_0x1ca0a9(0x24d)}),settings[_0x1ca0a9(0x274)]&&settings[_0x1ca0a9(0x274)]!=''&&(_0x3eb35f={..._0x3eb35f,'marketcapApi':_0x1ca0a9(0x24d)}),(settings[_0x1ca0a9(0x13a)]&&settings[_0x1ca0a9(0x13a)]=='***'||settings['telegramToken']&&settings[_0x1ca0a9(0xec)]=='***'||settings[_0x1ca0a9(0x274)]&&settings[_0x1ca0a9(0x274)]==_0x1ca0a9(0xab))&&(_0x3eb35f={..._0x3eb35f,'restored':{'password':settings[_0x1ca0a9(0x13a)]==_0x1ca0a9(0xab),'telegram':settings[_0x1ca0a9(0xec)]==_0x1ca0a9(0xab),'marketcap':settings[_0x1ca0a9(0x274)]==_0x1ca0a9(0xab)}}),_0x3eb35f;}async function updateBB(_0x34b968){const _0x21e803=_0x569596;await backupConfigFiles(),installingUpdate=!![],config[_0x21e803(0x202)](_0x244143=>{const _0x1801ca=_0x21e803;restartBot(_0x244143[_0x1801ca(0xe6)]);});if(_0x34b968==_0x21e803(0xa1))process['send']({'update':!![],'environment':environment},_0x4087c5=>{});else _0x34b968==_0x21e803(0x183)&&process['send']({'reinstall':!![],'environment':environment},_0x368566=>{});}function startBot(_0x563814,_0x4a6b89,_0x3ae4b3){const _0x13afa4=_0x569596;if(debugging)_0x563814['push']('-d');let _0x4d7ffe=![];const _0x4ec2e7=_0x563814[0x0];_0x4a6b89={..._0x4a6b89,'stdio':[_0x13afa4(0x25e),_0x13afa4(0x25e),_0x13afa4(0x25e),_0x13afa4(0x1ba)]},pid[_0x4ec2e7]=childProcess[_0x13afa4(0x145)](botfile,_0x563814,_0x4a6b89),pid[_0x4ec2e7]['on']('message',_0x5022ee=>{const _0x15c9a4=_0x13afa4;switch(Object[_0x15c9a4(0x134)](_0x5022ee)[0x0]){case _0x15c9a4(0x1fc):updateBotName(_0x4ec2e7,_0x5022ee[_0x15c9a4(0x1fc)]);break;case _0x15c9a4(0x185):updateBotManager();break;case _0x15c9a4(0x182):updateStatus(_0x4ec2e7,_0x5022ee['status']);break;case'live':updateLive(_0x4ec2e7,_0x5022ee[_0x15c9a4(0x246)]);break;case'started':updateLive(_0x4ec2e7,_0x5022ee['started']),io['to'](_0x4ec2e7)[_0x15c9a4(0x280)]('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x15c9a4(0x1e1):_0x5022ee[_0x15c9a4(0x1e1)]==_0x15c9a4(0x143)&&restartBot(_0x4ec2e7);_0x5022ee[_0x15c9a4(0x1e1)]==_0x15c9a4(0xdf)&&toggleBot(_0x4ec2e7,_0x15c9a4(0x27a),_0x15c9a4(0x148));break;case _0x15c9a4(0x264):sendTelegramBot(_0x4ec2e7,_0x5022ee[_0x15c9a4(0x264)]);break;case _0x15c9a4(0x20c):sendTelegramMsg(_0x5022ee['telegrammsg']);break;case _0x15c9a4(0x21c):io['to'](_0x4ec2e7)[_0x15c9a4(0x280)](_0x5022ee[_0x15c9a4(0x21c)],_0x5022ee[_0x15c9a4(0x1af)]);break;}}),pid[_0x4ec2e7]['on'](_0x13afa4(0x11a),function(_0xf75a39){if(_0x4d7ffe)return;_0x4d7ffe=!![],_0x3ae4b3(_0xf75a39);}),pid[_0x4ec2e7]['on'](_0x13afa4(0x1f8),async function(_0x1e269d){const _0x235bb3=_0x13afa4;if(terminating)return;if(installingUpdate){logger[_0x235bb3(0x132)](_0x235bb3(0xac)),io[_0x235bb3(0x288)]();return;}if(_0x4d7ffe)return;_0x4d7ffe=!![],_0x3ae4b3(null);const _0x1140d0=dbConfig[_0x235bb3(0x27e)](_0x235bb3(0x247))[_0x235bb3(0x16b)]({'botID':_0x4ec2e7})[_0x235bb3(0xea)]();_0x1140d0&&(_0x1140d0[_0x235bb3(0x182)]==_0x235bb3(0x1c0)||_0x1140d0['status']=='new')&&(await sleep(0x3e8),updateLive(_0x4ec2e7,'stopped'),logger['full']('Restarting\x20Bot\x20'+_0x4ec2e7),startBot([_0x4ec2e7,userID],{'cwd':bbpath},function(_0x40e25b){const _0x2548be=_0x235bb3;if(_0x40e25b)logger[_0x2548be(0x23d)](_0x40e25b);}));});}function stopBot(_0x1b2faf){const _0x20c458=_0x569596;getClientsWithBotID(_0x1b2faf)[_0x20c458(0x202)](_0x144eca=>{const _0xd3f5a1=_0x20c458;getSocket(_0x144eca['id'])[_0xd3f5a1(0x20b)](!![]),removeClient(_0x144eca['id']);}),pid[_0x1b2faf]&&(pid[_0x1b2faf][_0x20c458(0xdf)](),pid[_0x1b2faf]=null);}function stopAllBots(){const _0x12ecc2=_0x569596;terminating=!![];const _0x4c4241=getEnabledBots();_0x4c4241[_0x12ecc2(0x202)](_0x85913c=>{const _0x2b2928=_0x12ecc2;stopBot(_0x85913c[_0x2b2928(0xe6)]);});}function restartBot(_0x594e1c){if(pid[_0x594e1c])pid[_0x594e1c]['kill']();}function _0x51e3(){const _0x4d8590=['isIPv4MappedAddress','access','manual','restore-backup-file','43701DNJHat','temp/','hasOwnProperty','bb-settings.json','8281317kbHeuz','2FA\x20required','restore_no_','cancel-loading','config_alerts','cloneDeep','apiKey','chat','backup','version.json','assign','Allow\x20login\x20from\x20IP\x20address\x20','reinstall_yes','Password\x20reset\x20rejected','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','simple','Password\x20has\x20been\x20reset\x20to:\x20','type','access\x20timeout','ipv6','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','match','temporary\x20access\x20not\x20allowed','show-config','privateKeyFromPem','All\x20bots\x20running\x20right\x20now','temporary\x20access\x20rejected','remoteAddress','launch','log','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','create','logs/','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','new','filter','staging','kill','2FA','HTML','7062110ZluIgj','action','[ip-address]','getTime','botID','auth','generateKeyPair','sockets','value','join','telegramToken','-events.json','start','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','resetHistory','bb-secure.json','Temporary\x20access\x20rejected','Access\x20enabled\x20for\x20','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','remove','button','node','util','Unauthorized\x20attempt\x20to\x20delete\x20alerts','from','handshake','yes','invalid\x20credentials','binary','No\x20authentication\x20token','portfolio','CoinMarketCap\x20API\x20key\x20validated','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','telegramEvents','inlineKeyboard','Bot\x20','Ok,\x20will\x20send\x20alert\x20notifications\x20only','use','date-fns','File\x20uploaded','uncaughtException','temporary\x20access\x20timeout','-----------------------------------------------------------------------------------','/:bot/history','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','running','tempaccess_reject_','/:bot/portfolio','Unauthorized\x20attempt\x20to\x20get\x20portfolio','store-settings','tkn','/download/:type','environment','/names\x20-\x20show\x20bot\x20names\x0a','toString','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','error','notification','get-messages','1000','range','Unauthorized\x20attempt\x20to\x20get\x20events','getMonth','User\x20has\x20been\x20validated','#RES#\x20if\x20running\x20on\x20server','Ok,\x20will\x20send\x20order\x20notifications\x20only','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','telegraf','parse','headers','\x1b[31m','reset-history','10713816XcPSWh','removeAllListeners','metrics_','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','bbvNew','Restore\x20process\x20aborted','8071NkrZud','format','debug','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','keys','f2aRequired','port','family','bbUsername','constructor','bbPassword','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','toggle','push','uuid','crypto','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','alerts','reload','restart','/enable\x20-\x20enable\x20notifications\x0a','fork','expiry','zip/','stopped','kind','host','timestamp','exchange','Restoring\x20bot(s)\x20from\x20backup','ETH','editMessageReplyMarkup','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','isDirectory','Enabled\x20Bot\x20','/upload-backup','*$1*','7386QsdDDX','-config.json','help','data','bot.js','sha256','config_orders','graphql-request','Notifications\x20enabled\x0a','name','track','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','express-fileupload','0.0.0','Restore\x20process\x20confirmed','backup-files','Node.js\x20v','latestversion','reset-password','3000','socket.io','\x20(1)','find','tempaccess_15_','backup/','build2',')\x20|\x20Bot\x20','metrics','Invalid\x20IP\x20address','RSA-OAEP','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','readFileSync','init','private','/off\x20-\x20stop\x20bot(s)\x0a','referer','length','rmSync','privateKeyToPem','\x20(2)','\x20-\x20','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','statSync',':\x20Bot\x20Mgr\x20>\x20','\x1b[0m','status','reinstall','\x1b[34m','updatebotmanager','(((.+)+)+)+$','hashSync','min','clientip','temporaryAccessAllowed','message','apiPassword','Notifications\x20disabled\x0a','mode',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','/help\x20-\x20show\x20available\x20commands\x0a','toIPv4Address','2FA\x20login\x20required','-performance.json','update-bb','compareSync','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','mtime','off','Invalid\x20authentication\x20token\x20(2)','getSeconds','replace','Error\x20removing\x20old\x20backup\x20files:','confirm-message','write','secure','secret','showname','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Markdown','reinstall_no','storeHeadless','getDate','publicKey','|@|','Unauthorized\x20attempt\x20to\x20delete\x20bot','password','Telegraf\x20error:','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','endsWith','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','args','lastmsgemitted','/:bot/support','bcryptjs','telegramChatId','Deleted\x20Bot\x20','15\x20min','\x20|\x20','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','loginRequired','writeFileSync','ipc','Unauthorized\x20attempt\x20to\x20log\x20out','randomBytes','settings','logged\x20out','getFullYear','enabled','mixpanel','messages','node-forge','reject','files','restore_yes_','uuid-random','encryptedUuid','backup-full@','sendMessage','sendFile','/metrics\x20-\x20show\x20bot\x20performance\x0a','Notifications\x20disabled','title','\x1b[36m','get-portfolio','Unauthorized\x20attempt\x20to\x20confirm\x20message','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','set','update_no','add','portfolio_','production','pki','update_yes','success','place-order','output-001.log','NTBA_FIX_319','login\x20not\x20required','once','readdirSync','stop','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','disable','build','logout','server','bb/','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','lastmsgtelegram','config/','bot-','sort','padStart','2aNNStO','argv','send','rsa','toggleBotMode','.zip','all','getPortfolio','headless','Backup\x20file\x20unzipped\x20and\x20stored','exit','command','276XhOXYn','<b>Telegram\x20Bot\x20Status:</b>\x0a','botname','IPv4','$1_$2_$3','sendMetricsTelegram','bbvReceive','All','forEach','No\x20bots\x20running\x20right\x20now','index.html','axios','resetpw_yes','Unauthorized\x20attempt\x20to\x20update\x20settings','Unauthorized\x20attempt\x20to\x20store\x20configuration','sendPortfolioTelegram','286469memEIc','disconnect','telegrammsg','lowdb','username','env','#RES#','show','event','initclient','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','alias','deleteHistoryAlerts','\x1b[33m','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','toggle_','Yes','Idling\x20(','function','login','Telegram\x20error:','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','jsonwebtoken','2FA\x20login\x20token\x20generated','getUTCHours','request','\x20to\x20','bot','stringify','loadAsync','output-000.log','temporary\x20token\x20generated','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','unlinkSync','get-logs','login\x20required','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','#RES#\x20if\x20running\x20locally\x0a','createWriteStream','socket','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','onepagemode','tempaccess_5_','Error\x20while\x20deleting\x20config\x20files:\x20','static','copyFileSync','defaults','mkdirSync','-results.json','All\x20bots','full','map','backupfile','address\x20already\x20in\x20use','order','Starting\x20#RED#Balance\x20Bot\x20v','orders','sortBy','storeConfiguration','live','bots','placeOrder','20kMzqpY','Error\x20details:','backup-full.zip','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','************','createServer','telegramUsername','split','BCT','params','Logged\x20out\x20user\x20...','\x20|\x20client:\x20...','token','Session\x20expired\x20for\x20user\x20...','/on\x20-\x20start\x20bot(s)\x0a','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','hex','Setting\x20access:\x20','verify','Starting\x20Balance\x20Bot\x20update','reply','inherit','pidRefreshToken','config','#RES#\x20','allow','slice','telegram','storeFiat','isValid','Restore\x20backup\x20file\x20','Login\x20rejected','/update\x20-\x20update\x20Balance\x20Bot\x0a','Unauthorized\x20attempt\x20to\x20get\x20messages','logs','download','telegramIpApproval','Bot\x20Mgr\x20>\x20','listen','privateKey','existsSync','store-fiat','Logged\x20in\x20user\x20...','marketcapApi','off_','timeshift','Starting\x20new\x20bot\x20|\x20Bot\x20','child_process','getHours','disabled','settings.','reason','Orders','get',')\x20\x20\x20|\x20Bot\x20','emit','127.0.0.1','ipaddr.js','async','Unauthorized\x20attempt\x20to\x20add\x20bot','\x20>\x20','/restart\x20-\x20restart\x20bot(s)\x0a','exp','close','backup-full','userid','(staging)','SIGINT','status\x20code\x20401','test','whitelist','tempaccess_30_','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','SIGTERM','string','/disable\x20-\x20disable\x20notifications\x0a','search','new-disabled','number','\x1b[35m','botmanager','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','exec','telegramEnabled','blacklist','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','telegram2FaApproval','Unauthorized\x20attempt\x20to\x20show\x20configuration','login\x20token\x20generated','/:bot/performance','internal','code','store-configuration','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','auto','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','emitHistory','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','=>\x20Go\x20to\x20#CYA#http://','Unauthorized\x20login\x20attempt\x20(timeout)','address','Login\x20accepted','pidExpireLogin','Unauthorized\x20attempt\x20to\x20update\x20bot','update','::1','output-002.log','enable','on_','showConfig','includes','/:bot/coins','resetpw_no','version','***','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','getMinutes','13440357UUQUAw','login2fa_','callback','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a'];_0x51e3=function(){return _0x4d8590;};return _0x51e3();}function addBot(){const _0x1c4c7a=_0x569596;let _0x5496b1;for(let _0x38633c=0x1;_0x38633c<0x3e9;_0x38633c++){_0x5496b1=_0x38633c[_0x1c4c7a(0x118)]()[_0x1c4c7a(0x1ed)](0x3,'0');let _0x2e68fc=config[_0x1c4c7a(0x16b)](_0x12f9a8=>_0x12f9a8[_0x1c4c7a(0xe6)]==_0x5496b1);if(!_0x2e68fc)break;}if(_0x5496b1===_0x1c4c7a(0x11d)){logger[_0x1c4c7a(0x23d)](_0x1c4c7a(0x98));return;}logger[_0x1c4c7a(0x23d)](_0x1c4c7a(0x277)+_0x5496b1),dbConfig[_0x1c4c7a(0x27e)](_0x1c4c7a(0x247))[_0x1c4c7a(0x13d)]({'botID':_0x5496b1,'botname':'Bot\x20'+_0x5496b1,'status':_0x1c4c7a(0xdc),'live':''})[_0x1c4c7a(0x19e)](),startBot([_0x5496b1,userID],{'cwd':bbpath},function(_0x540429){if(_0x540429)logger['full'](_0x540429);}),config=getConfiguration(),io['to'](_0x1c4c7a(0x88))[_0x1c4c7a(0x280)](_0x1c4c7a(0x247),config),broadcastToBots(_0x1c4c7a(0x247),JSON['stringify'](config));}function deleteBot(_0x5558d9){const _0x202772=_0x569596;getClientsWithBotID(_0x5558d9)[_0x202772(0x202)](_0x4d7220=>{const _0x4708ae=_0x202772;getSocket(_0x4d7220['id'])[_0x4708ae(0x20b)](!![]),removeClient(_0x4d7220['id']);}),dbConfig[_0x202772(0x27e)]('bots')[_0x202772(0xf5)]({'botID':_0x5558d9})[_0x202772(0x19e)](),logger[_0x202772(0x23d)](_0x202772(0x1b4)+_0x5558d9),stopBot(_0x5558d9);try{if(fs[_0x202772(0x271)](path['join'](configpath,_0x202772(0x1eb)+_0x5558d9+_0x202772(0x156))))fs[_0x202772(0x22b)](path[_0x202772(0xeb)](configpath,_0x202772(0x1eb)+_0x5558d9+_0x202772(0x156)));if(fs[_0x202772(0x271)](path['join'](configpath,_0x202772(0x1eb)+_0x5558d9+_0x202772(0xed))))fs[_0x202772(0x22b)](path['join'](configpath,_0x202772(0x1eb)+_0x5558d9+_0x202772(0xed)));if(fs[_0x202772(0x271)](path[_0x202772(0xeb)](configpath,_0x202772(0x1eb)+_0x5558d9+_0x202772(0x193))))fs[_0x202772(0x22b)](path[_0x202772(0xeb)](configpath,'bot-'+_0x5558d9+'-performance.json'));if(fs['existsSync'](path[_0x202772(0xeb)](configpath,'bot-'+_0x5558d9+_0x202772(0x23b))))fs[_0x202772(0x22b)](path[_0x202772(0xeb)](configpath,_0x202772(0x1eb)+_0x5558d9+_0x202772(0x23b)));}catch(_0x327928){if(_0x327928)logger[_0x202772(0x23d)](_0x202772(0x236),_0x327928);}config=getConfiguration(),io['to'](_0x202772(0x88))[_0x202772(0x280)]('bots',config),broadcastToBots(_0x202772(0x247),JSON['stringify'](config));}function toggleBot(_0x1c393d,_0x53044f,_0x41b1c9){const _0x28719a=_0x569596;dbConfig[_0x28719a(0x27e)](_0x28719a(0x247))[_0x28719a(0x16b)]({'botID':_0x1c393d})[_0x28719a(0xc4)]({'status':_0x53044f})[_0x28719a(0xc4)]({'live':_0x41b1c9})[_0x28719a(0x19e)]();if(_0x53044f==_0x28719a(0x1c0)||_0x53044f==_0x28719a(0xdc))logger[_0x28719a(0x23d)](_0x28719a(0x152)+_0x1c393d),startBot([_0x1c393d,userID],{'cwd':bbpath},function(_0x25317c){if(_0x25317c)logger['full'](_0x25317c);});else(_0x53044f=='disabled'||_0x53044f=='new-disabled')&&(logger[_0x28719a(0x23d)]('Disabled\x20Bot\x20'+_0x1c393d),stopBot(_0x1c393d));config=getConfiguration(),io['to'](_0x28719a(0x88))[_0x28719a(0x280)](_0x28719a(0x247),config),broadcastToBots(_0x28719a(0x247),JSON[_0x28719a(0x226)](config));}function toggleStatus(_0x532048){const _0x5f68b=_0x569596;let _0x26af77=dbConfig['get'](_0x5f68b(0x247))[_0x5f68b(0x16b)]({'botID':_0x532048})[_0x5f68b(0xea)](),_0x2b1307;if(_0x26af77[_0x5f68b(0x182)]===_0x5f68b(0x1c0))_0x2b1307=_0x5f68b(0x27a);else{if(_0x26af77['status']===_0x5f68b(0xdc))_0x2b1307=_0x5f68b(0x85);else{if(_0x26af77['status']===_0x5f68b(0x85))_0x2b1307='new';else{if(_0x26af77['status']===_0x5f68b(0x27a))_0x2b1307=_0x5f68b(0x1c0);}}}return _0x2b1307;}function updateStatus(_0x10c220,_0x55c5ec){const _0x198b75=_0x569596;dbConfig[_0x198b75(0x27e)](_0x198b75(0x247))[_0x198b75(0x16b)]({'botID':_0x10c220})[_0x198b75(0xc4)]({'status':_0x55c5ec})['write'](),config=getConfiguration(),io['to'](_0x198b75(0x88))[_0x198b75(0x280)](_0x198b75(0x247),config),broadcastToBots('bots',JSON[_0x198b75(0x226)](config));}function updateLive(_0xfb202d,_0x4bd06f){const _0x477c06=_0x569596;dbConfig[_0x477c06(0x27e)](_0x477c06(0x247))['find']({'botID':_0xfb202d})['assign']({'live':_0x4bd06f})[_0x477c06(0x19e)](),config=getConfiguration(),io['to'](_0x477c06(0x88))['emit'](_0x477c06(0x247),config),broadcastToBots(_0x477c06(0x247),JSON[_0x477c06(0x226)](config));}function updateBotName(_0xfb1712,_0x38d2b8){const _0x48ed64=_0x569596;dbConfig[_0x48ed64(0x27e)]('bots')[_0x48ed64(0x16b)]({'botID':_0xfb1712})['assign']({'botname':_0x38d2b8})[_0x48ed64(0x19e)](),config=getConfiguration(),io['to']('botmanager')[_0x48ed64(0x280)](_0x48ed64(0x247),config),broadcastToBots(_0x48ed64(0x247),JSON[_0x48ed64(0x226)](config));}function updateBotManager(){const _0x235463=_0x569596;config=getConfiguration(),io['to'](_0x235463(0x88))[_0x235463(0x280)](_0x235463(0x247),config),broadcastToBots(_0x235463(0x247),JSON['stringify'](config));}function toggleBotMode(_0x1cc91c){const _0x144f75=_0x569596;if(pid[_0x1cc91c])pid[_0x1cc91c][_0x144f75(0x1f0)]({'function':_0x144f75(0x1f2),'args':null});else{const _0x4db95c=configpath+'bot-'+_0x1cc91c+_0x144f75(0x156),_0x5bfd1d=fs[_0x144f75(0x174)](_0x4db95c),_0x589f18=JSON[_0x144f75(0x126)](_0x5bfd1d),_0x706ed=_0x589f18[_0x144f75(0x225)][0x0]['headless'];_0x589f18['bot'][0x0][_0x144f75(0x1f6)]=!_0x706ed;const _0x3e639b=JSON['stringify'](_0x589f18,null,0x2);fs[_0x144f75(0x1b9)](_0x4db95c,_0x3e639b),config=getConfiguration(),io['to'](_0x144f75(0x88))[_0x144f75(0x280)](_0x144f75(0x247),config),broadcastToBots(_0x144f75(0x247),JSON['stringify'](config));}}function validateTelegram(_0x1907cf){const _0x19761c=_0x569596;if(_0x1907cf['from']['username']!=settings[_0x19761c(0x24f)]&&'@'+_0x1907cf[_0x19761c(0xfa)][_0x19761c(0x20e)]!=settings[_0x19761c(0x24f)]||_0x1907cf[_0x19761c(0xc1)]['id']!=settings[_0x19761c(0x1b3)])return sendTelegram(_0x1907cf[_0x19761c(0xc1)]['id'],_0x19761c(0x96),{'parse_mode':_0x19761c(0xe1)}),![];return!![];}async function initTelegram(){const _0x21a96d=_0x569596;if(tgBot)tgBot['stop'](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0x417578='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x417578+='\x0a',_0x417578+=_0x21a96d(0x144),_0x417578+=_0x21a96d(0x83),_0x417578+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x417578+=_0x21a96d(0x286),_0x417578+=_0x21a96d(0x257),_0x417578+=_0x21a96d(0x177),_0x417578+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x417578+=_0x21a96d(0x117),_0x417578+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x417578+=_0x21a96d(0x1cc),_0x417578+=_0x21a96d(0x1d2),_0x417578+=_0x21a96d(0x269),_0x417578+=_0x21a96d(0xb1),_0x417578+=_0x21a96d(0x190);let _0x5d750f=_0x21a96d(0x21f);_0x5d750f+='\x0a',_0x5d750f+=_0x417578,tgBot['catch']((_0x47cbe8,_0x961083)=>{const _0x48dbd4=_0x21a96d;logger[_0x48dbd4(0xc9)](getTimeStamp()+_0x48dbd4(0x18f)),logger[_0x48dbd4(0x132)](_0x48dbd4(0x1ab),_0x47cbe8);}),tgBot[_0x21a96d(0x107)](async(_0x240bf7,_0x484e00)=>{const _0x2d9fd8=_0x21a96d;if(!(!settings[_0x2d9fd8(0x1b3)]&&_0x240bf7[_0x2d9fd8(0xa1)][_0x2d9fd8(0x18b)]['text']=='/start')){if(!validateTelegram(_0x240bf7))return;}_0x484e00();}),tgBot[_0x21a96d(0x1f9)](_0x21a96d(0xee),async _0x1927fd=>{const _0x111190=_0x21a96d;if(!settings[_0x111190(0x1b3)])updateSetting(_0x111190(0x1b3),_0x1927fd[_0x111190(0xc1)]['id']);updateSetting(_0x111190(0x8c),!![]);if(!validateTelegram(_0x1927fd))return;await sendTelegram(_0x1927fd['chat']['id'],_0x5d750f);}),tgBot['command'](_0x21a96d(0xa4),async _0x487a78=>{const _0x518d31=_0x21a96d;updateSetting(_0x518d31(0x8c),!![]),await sendTelegram(_0x487a78[_0x518d31(0xc1)]['id'],'Notifications\x20enabled');}),tgBot[_0x21a96d(0x1f9)](_0x21a96d(0x1e3),async _0x40ca7d=>{const _0x224aa3=_0x21a96d;await sendTelegram(_0x40ca7d[_0x224aa3(0xc1)]['id'],_0x224aa3(0x1cd)),updateSetting(_0x224aa3(0x8c),![]);}),tgBot[_0x21a96d(0x1f9)](_0x21a96d(0x260),async _0x3beb5a=>{const _0x99b67f=_0x21a96d,_0x25b9f0=Markup[_0x99b67f(0x104)]([Markup[_0x99b67f(0xf6)][_0x99b67f(0xb0)](_0x99b67f(0x27d),_0x99b67f(0x15b)),Markup['button'][_0x99b67f(0xb0)]('Alerts',_0x99b67f(0xbe)),Markup[_0x99b67f(0xf6)][_0x99b67f(0xb0)](_0x99b67f(0x201),'config_all')]);_0x3beb5a['reply'](_0x99b67f(0x214),_0x25b9f0);}),tgBot[_0x21a96d(0xe3)](_0x21a96d(0x15b),async _0x3521fd=>{const _0x3d9160=_0x21a96d;_0x3521fd[_0x3d9160(0x14f)](),updateSetting(_0x3d9160(0x103),_0x3d9160(0x243)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x3521fd[_0x3d9160(0xc1)]['id'],_0x3d9160(0x123));}),tgBot[_0x21a96d(0xe3)](_0x21a96d(0xbe),async _0x3f9107=>{const _0x4e2646=_0x21a96d;_0x3f9107[_0x4e2646(0x14f)](),updateSetting('telegramEvents',_0x4e2646(0x141)),updateSetting(_0x4e2646(0x8c),!![]),await sendTelegram(_0x3f9107[_0x4e2646(0xc1)]['id'],_0x4e2646(0x106));}),tgBot[_0x21a96d(0xe3)]('config_all',async _0x53f363=>{const _0x40cca9=_0x21a96d;_0x53f363[_0x40cca9(0x14f)](),updateSetting(_0x40cca9(0x103),_0x40cca9(0x1f4)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x53f363[_0x40cca9(0xc1)]['id'],_0x40cca9(0x133));}),tgBot[_0x21a96d(0x1f9)](_0x21a96d(0x182),async _0x575a5e=>{const _0x37c5ad=_0x21a96d,_0x1c06ef=getBotsWithMode();let _0x39e108='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x37c5ad(0x202)](_0x545e93=>{const _0x503de0=_0x37c5ad,_0x3c966d=_0x1c06ef[_0x503de0(0x16b)](_0x7050a6=>_0x7050a6['botID']==_0x545e93[_0x503de0(0xe6)])[_0x503de0(0x18e)];_0x39e108+=_0x503de0(0x105)+_0x545e93['botID']+':\x20'+_0x545e93[_0x503de0(0x182)]+_0x503de0(0x1b6)+_0x3c966d+_0x503de0(0x1b6)+_0x545e93[_0x503de0(0x246)]+'\x0a';}),_0x39e108+='\x0a',_0x39e108+=_0x37c5ad(0x1fb),_0x39e108+=!settings[_0x37c5ad(0x8c)]?_0x37c5ad(0x18d):_0x37c5ad(0x15d),_0x39e108+=settings['telegramEnabled']?settings[_0x37c5ad(0x103)]==_0x37c5ad(0x1f4)?_0x37c5ad(0x233):'Notifications\x20types:\x20'+settings[_0x37c5ad(0x103)]+'\x20only\x0a':'',await sendTelegram(_0x575a5e['chat']['id'],_0x39e108,{'parse_mode':_0x37c5ad(0xe1)});}),tgBot[_0x21a96d(0x1f9)](_0x21a96d(0x143),async _0x4b153f=>{const _0x3c952e=_0x21a96d,_0x43c287=getEnabledBots();if(_0x43c287[_0x3c952e(0x179)]==0x0)await sendTelegram(_0x4b153f[_0x3c952e(0xc1)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x43c287['length']>0x1)_0x43c287['push']({'botID':'all'});let _0x39eb1a=[],_0x14a826=[];const _0x5e7b8a=_0x43c287[_0x3c952e(0x179)]%0x4==0x0||_0x43c287[_0x3c952e(0x179)]%0x4==0x3||_0x43c287[_0x3c952e(0x179)]%0x3==0x1?0x4:0x3;let _0x34f2c7=0x0;_0x43c287[_0x3c952e(0x202)]((_0xcfee3f,_0x43fbfc)=>{const _0x24c5cc=_0x3c952e;if(_0x43fbfc%_0x5e7b8a==0x0)_0x14a826=[];_0x14a826[_0x24c5cc(0x13d)](Markup[_0x24c5cc(0xf6)]['callback'](_0xcfee3f[_0x24c5cc(0xe6)]==_0x24c5cc(0x1f4)?_0x24c5cc(0x23c):_0x24c5cc(0x105)+_0xcfee3f[_0x24c5cc(0xe6)],'restart_'+_0xcfee3f[_0x24c5cc(0xe6)])),_0x43fbfc%_0x5e7b8a==0x0&&(_0x39eb1a[_0x34f2c7]=_0x14a826,_0x34f2c7++);});const _0x50cb12=Markup[_0x3c952e(0x104)](_0x39eb1a);_0x4b153f['reply'](_0x3c952e(0xce),_0x50cb12);}}),tgBot[_0x21a96d(0xe3)](/restart_(.+)/,async _0x3e5d85=>{const _0x4df89c=_0x21a96d,_0x3e2ea7=_0x3e5d85[_0x4df89c(0xcf)][0x1];_0x3e5d85['editMessageReplyMarkup'](),_0x3e2ea7=='all'?config['forEach'](_0x1819f2=>{const _0x4d631c=_0x4df89c;restartBot(_0x1819f2[_0x4d631c(0xe6)]);}):restartBot(_0x3e2ea7);}),tgBot[_0x21a96d(0x1f9)]('on',async _0x5a2088=>{const _0x3640a9=_0x21a96d,_0x51a0bd=getDisabledBots();if(_0x51a0bd[_0x3640a9(0x179)]==0x0)await sendTelegram(_0x5a2088[_0x3640a9(0xc1)]['id'],_0x3640a9(0xd3));else{if(_0x51a0bd[_0x3640a9(0x179)]>0x1)_0x51a0bd[_0x3640a9(0x13d)]({'botID':_0x3640a9(0x1f4)});let _0x2acea5=[],_0x8c820a=[];const _0x321d78=_0x51a0bd['length']%0x4==0x0||_0x51a0bd[_0x3640a9(0x179)]%0x4==0x3||_0x51a0bd[_0x3640a9(0x179)]%0x3==0x1?0x4:0x3;let _0x11904d=0x0;_0x51a0bd['forEach']((_0xa4f137,_0xf9d53d)=>{const _0x32c300=_0x3640a9;if(_0xf9d53d%_0x321d78==0x0)_0x8c820a=[];_0x8c820a[_0x32c300(0x13d)](Markup[_0x32c300(0xf6)][_0x32c300(0xb0)](_0xa4f137[_0x32c300(0xe6)]==_0x32c300(0x1f4)?_0x32c300(0x23c):_0x32c300(0x105)+_0xa4f137[_0x32c300(0xe6)],_0x32c300(0xa5)+_0xa4f137[_0x32c300(0xe6)])),_0xf9d53d%_0x321d78==0x0&&(_0x2acea5[_0x11904d]=_0x8c820a,_0x11904d++);});const _0x3be391=Markup[_0x3640a9(0x104)](_0x2acea5);_0x5a2088[_0x3640a9(0x25d)](_0x3640a9(0x124),_0x3be391);}}),tgBot['action'](/on_(.+)/,async _0x212ade=>{const _0x30b651=_0x21a96d,_0x2dbe09=_0x212ade[_0x30b651(0xcf)][0x1];_0x212ade[_0x30b651(0x14f)]();if(_0x2dbe09==_0x30b651(0x1f4)){const _0x5169c3=getDisabledBots();await sendTelegram(_0x212ade[_0x30b651(0xc1)]['id'],_0x30b651(0x1e8)),_0x5169c3[_0x30b651(0x202)](_0x430a05=>{const _0x2fa330=_0x30b651;if(_0x430a05[_0x2fa330(0xe6)]!='all')toggleBot(_0x430a05[_0x2fa330(0xe6)],toggleStatus(_0x430a05[_0x2fa330(0xe6)]),_0x2fa330(0x148));});}else await sendTelegram(_0x212ade['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x2dbe09),toggleBot(_0x2dbe09,toggleStatus(_0x2dbe09),'stopped');}),tgBot[_0x21a96d(0x1f9)](_0x21a96d(0x198),async _0x5e5d49=>{const _0x5e8696=_0x21a96d,_0x50cb7a=getEnabledBots();if(_0x50cb7a[_0x5e8696(0x179)]==0x0)await sendTelegram(_0x5e5d49['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x50cb7a['length']>0x1)_0x50cb7a['push']({'botID':_0x5e8696(0x1f4)});let _0x571e50=[],_0x40b945=[];const _0x39b330=_0x50cb7a['length']%0x4==0x0||_0x50cb7a[_0x5e8696(0x179)]%0x4==0x3||_0x50cb7a[_0x5e8696(0x179)]%0x3==0x1?0x4:0x3;let _0x5747fb=0x0;_0x50cb7a[_0x5e8696(0x202)]((_0x2d588b,_0xd166f8)=>{const _0x485651=_0x5e8696;if(_0xd166f8%_0x39b330==0x0)_0x40b945=[];_0x40b945[_0x485651(0x13d)](Markup[_0x485651(0xf6)]['callback'](_0x2d588b[_0x485651(0xe6)]==_0x485651(0x1f4)?_0x485651(0x23c):_0x485651(0x105)+_0x2d588b[_0x485651(0xe6)],_0x485651(0x275)+_0x2d588b[_0x485651(0xe6)])),_0xd166f8%_0x39b330==0x0&&(_0x571e50[_0x5747fb]=_0x40b945,_0x5747fb++);});const _0x245b7c=Markup['inlineKeyboard'](_0x571e50);_0x5e5d49[_0x5e8696(0x25d)](_0x5e8696(0x232),_0x245b7c);}}),tgBot[_0x21a96d(0xe3)](/off_(.+)/,async _0xf278a5=>{const _0x2ae3e6=_0x21a96d,_0x4f225d=_0xf278a5[_0x2ae3e6(0xcf)][0x1];_0xf278a5['editMessageReplyMarkup']();if(_0x4f225d=='all'){const _0x4eab64=getEnabledBots();await sendTelegram(_0xf278a5[_0x2ae3e6(0xc1)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots'),_0x4eab64[_0x2ae3e6(0x202)](_0x18519c=>{const _0x45c431=_0x2ae3e6;if(_0x18519c[_0x45c431(0xe6)]!=_0x45c431(0x1f4))toggleBot(_0x18519c['botID'],toggleStatus(_0x18519c['botID']),_0x45c431(0x148));});}else await sendTelegram(_0xf278a5[_0x2ae3e6(0xc1)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x4f225d),toggleBot(_0x4f225d,toggleStatus(_0x4f225d),_0x2ae3e6(0x148));}),tgBot[_0x21a96d(0x1f9)](_0x21a96d(0x170),async _0x935b6c=>{const _0x79f909=_0x21a96d,_0x58577b=getEnabledBots();if(_0x58577b['length']==0x0)await sendTelegram(_0x935b6c[_0x79f909(0xc1)]['id'],_0x79f909(0x203));else{if(_0x58577b[_0x79f909(0x179)]>0x1){let _0xc66aca=[],_0x12566a=[];const _0xfdc230=_0x58577b[_0x79f909(0x179)]%0x4==0x0||_0x58577b[_0x79f909(0x179)]%0x4==0x3||_0x58577b[_0x79f909(0x179)]%0x3==0x1?0x4:0x3;let _0xfdbc11=0x0;_0x58577b[_0x79f909(0x202)]((_0xbdeb45,_0x10e69c)=>{const _0x25e19c=_0x79f909;if(_0x10e69c%_0xfdc230==0x0)_0x12566a=[];_0x12566a[_0x25e19c(0x13d)](Markup[_0x25e19c(0xf6)][_0x25e19c(0xb0)](_0x25e19c(0x105)+_0xbdeb45['botID'],_0x25e19c(0x12c)+_0xbdeb45[_0x25e19c(0xe6)])),_0x10e69c%_0xfdc230==0x0&&(_0xc66aca[_0xfdbc11]=_0x12566a,_0xfdbc11++);});const _0x28a7da=Markup[_0x79f909(0x104)](_0xc66aca);_0x935b6c[_0x79f909(0x25d)](_0x79f909(0x12d),_0x28a7da);}else{const _0x12f240=_0x58577b[0x0][_0x79f909(0xe6)];if(pid[_0x12f240])pid[_0x12f240][_0x79f909(0x1f0)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x21a96d(0xe3)](/metrics_(.+)/,async _0x21435a=>{const _0x472d25=_0x21a96d,_0x3a7142=_0x21435a['match'][0x1];_0x21435a['editMessageReplyMarkup']();if(pid[_0x3a7142])pid[_0x3a7142]['send']({'function':_0x472d25(0x1ff),'args':null});}),tgBot[_0x21a96d(0x1f9)](_0x21a96d(0x100),async _0x20b42f=>{const _0x469323=_0x21a96d,_0x4c2c6a=getEnabledBots();if(_0x4c2c6a[_0x469323(0x179)]==0x0)await sendTelegram(_0x20b42f[_0x469323(0xc1)]['id'],_0x469323(0x203));else{if(_0x4c2c6a[_0x469323(0x179)]>0x1){let _0x5e1b19=[],_0x323ecc=[];const _0x2b5feb=_0x4c2c6a[_0x469323(0x179)]%0x4==0x0||_0x4c2c6a[_0x469323(0x179)]%0x4==0x3||_0x4c2c6a[_0x469323(0x179)]%0x3==0x1?0x4:0x3;let _0x3e61bb=0x0;_0x4c2c6a[_0x469323(0x202)]((_0x3fda41,_0x147cf9)=>{const _0x2b6512=_0x469323;if(_0x147cf9%_0x2b5feb==0x0)_0x323ecc=[];_0x323ecc[_0x2b6512(0x13d)](Markup['button'][_0x2b6512(0xb0)](_0x2b6512(0x105)+_0x3fda41['botID'],_0x2b6512(0x1d6)+_0x3fda41[_0x2b6512(0xe6)])),_0x147cf9%_0x2b5feb==0x0&&(_0x5e1b19[_0x3e61bb]=_0x323ecc,_0x3e61bb++);});const _0xa3484b=Markup[_0x469323(0x104)](_0x5e1b19);_0x20b42f[_0x469323(0x25d)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0xa3484b);}else{const _0x1a8b31=_0x4c2c6a[0x0][_0x469323(0xe6)];if(pid[_0x1a8b31])pid[_0x1a8b31][_0x469323(0x1f0)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x21a96d(0xe3)](/portfolio_(.+)/,async _0x135aff=>{const _0x59521e=_0x21a96d,_0xaf2edf=_0x135aff['match'][0x1];_0x135aff[_0x59521e(0x14f)]();if(pid[_0xaf2edf])pid[_0xaf2edf][_0x59521e(0x1f0)]({'function':_0x59521e(0x209),'args':null});}),tgBot[_0x21a96d(0x1f9)]('update',async _0x392e3f=>{const _0x2c790e=_0x21a96d;await getMessages();if(!updateAvailable)await sendTelegram(_0x392e3f['chat']['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x392e3f['chat']['id'],_0x2c790e(0x258));else{const _0x347030=Markup[_0x2c790e(0x104)]([Markup[_0x2c790e(0xf6)][_0x2c790e(0xb0)](_0x2c790e(0x21a),_0x2c790e(0x1d9)),Markup[_0x2c790e(0xf6)][_0x2c790e(0xb0)]('No',_0x2c790e(0x1d4))]);_0x392e3f[_0x2c790e(0x25d)](_0x2c790e(0xef),_0x347030);}}}),tgBot[_0x21a96d(0xe3)](/update_(.+)/,async _0x377ad9=>{const _0x4c6546=_0x21a96d,_0x547074=_0x377ad9['match'][0x1];_0x377ad9[_0x4c6546(0x14f)](),_0x547074=='yes'&&(await sendTelegram(_0x377ad9[_0x4c6546(0xc1)]['id'],_0x4c6546(0x25c)),updateBB('update')),_0x547074=='no'&&await sendTelegram(_0x377ad9[_0x4c6546(0xc1)]['id'],_0x4c6546(0x196));}),tgBot['command'](_0x21a96d(0x183),async _0x59dd2a=>{const _0x5440bd=_0x21a96d;if(!validInstallation)await sendTelegram(_0x59dd2a[_0x5440bd(0xc1)]['id'],_0x5440bd(0x8a));else{const _0x3671ca=Markup[_0x5440bd(0x104)]([Markup[_0x5440bd(0xf6)][_0x5440bd(0xb0)](_0x5440bd(0x21a),_0x5440bd(0xc6)),Markup['button'][_0x5440bd(0xb0)]('No',_0x5440bd(0x1a4))]);_0x59dd2a[_0x5440bd(0x25d)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x3671ca);}}),tgBot[_0x21a96d(0xe3)](/reinstall_(.+)/,async _0x51fae8=>{const _0x261a45=_0x21a96d,_0x12767d=_0x51fae8['match'][0x1];_0x51fae8[_0x261a45(0x14f)](),_0x12767d==_0x261a45(0xfc)&&(await sendTelegram(_0x51fae8[_0x261a45(0xc1)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x261a45(0x183))),_0x12767d=='no'&&await sendTelegram(_0x51fae8['chat']['id'],_0x261a45(0x1ae));}),tgBot['command'](_0x21a96d(0x13c),async _0x1605fc=>{const _0x5ac342=_0x21a96d,_0x55a7ca=getBotsWithMode();if(_0x55a7ca[_0x5ac342(0x179)]==0x0)await sendTelegram(_0x1605fc[_0x5ac342(0xc1)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x802b45=[],_0x5f01f4=[];const _0x42ce82=0x2;let _0x2c5d7b=0x0;_0x55a7ca[_0x5ac342(0x202)]((_0x3b5cde,_0x5d1482)=>{const _0x2b66ac=_0x5ac342;if(_0x5d1482%_0x42ce82==0x0)_0x5f01f4=[];_0x5f01f4[_0x2b66ac(0x13d)](Markup[_0x2b66ac(0xf6)][_0x2b66ac(0xb0)]('Bot\x20'+_0x3b5cde[_0x2b66ac(0xe6)]+'\x20('+_0x3b5cde['mode']+')',_0x2b66ac(0x219)+_0x3b5cde['botID'])),_0x5d1482%_0x42ce82==0x0&&(_0x802b45[_0x2c5d7b]=_0x5f01f4,_0x2c5d7b++);});const _0xf0c5c9=Markup['inlineKeyboard'](_0x802b45);_0x1605fc[_0x5ac342(0x25d)](_0x5ac342(0x160),_0xf0c5c9);}}),tgBot[_0x21a96d(0xe3)](/toggle_(.+)/,async _0x988ece=>{const _0x5c6da2=_0x21a96d,_0x57d930=_0x988ece[_0x5c6da2(0xcf)][0x1];_0x988ece['editMessageReplyMarkup']();const _0x305c36=getBotsWithMode(),_0x3e3acc=_0x305c36[_0x5c6da2(0x16b)](_0x27313a=>_0x27313a[_0x5c6da2(0xe6)]==_0x57d930),_0x496280=_0x3e3acc[_0x5c6da2(0x18e)]==_0x5c6da2(0x97)?'manual':_0x5c6da2(0x97);await sendTelegram(_0x988ece[_0x5c6da2(0xc1)]['id'],_0x5c6da2(0xf4)+_0x57d930+_0x5c6da2(0x224)+_0x496280+'\x20mode'),toggleBotMode(_0x57d930);}),tgBot['command']('names',async _0x585743=>{const _0x2199c1=_0x21a96d;let _0xa1598d='';config[_0x2199c1(0x202)](_0xf432a6=>{const _0x1e9d46=_0x2199c1;_0xa1598d+=_0x1e9d46(0x105)+_0xf432a6[_0x1e9d46(0xe6)]+':\x20'+_0xf432a6[_0x1e9d46(0x1fc)]+'\x0a';}),await sendTelegram(_0x585743[_0x2199c1(0xc1)]['id'],_0xa1598d,{'parse_mode':_0x2199c1(0xe1)});}),tgBot[_0x21a96d(0x1f9)](_0x21a96d(0x157),async _0x3228ef=>{const _0x1036b0=_0x21a96d;await sendTelegram(_0x3228ef[_0x1036b0(0xc1)]['id'],_0x417578);}),process[_0x21a96d(0x1df)](_0x21a96d(0x28c),()=>tgBot[_0x21a96d(0x1e1)](_0x21a96d(0x28c))),process[_0x21a96d(0x1df)](_0x21a96d(0x81),()=>tgBot[_0x21a96d(0x1e1)]('SIGTERM')),tgBot[_0x21a96d(0xd6)]();}}function disableTelegram(){const _0x24e2a6=_0x569596;tgBot&&tgBot[_0x24e2a6(0x1e1)]();}async function sendTelegram(_0x167a14,_0x85ec03,_0x4096be){const _0x9385cc=_0x569596;_0x4096be={..._0x4096be,'disable_web_page_preview':!![]};try{await tgBot[_0x9385cc(0x264)][_0x9385cc(0x1ca)](_0x167a14,_0x85ec03,_0x4096be);}catch(_0x5de314){console[_0x9385cc(0xd7)](_0x9385cc(0x21e),_0x5de314);}}async function sendTelegramBot(_0x5ea865,_0x569d33){const _0x38f340=_0x569596;if(settings[_0x38f340(0x8c)]){if(settings[_0x38f340(0x103)]==_0x38f340(0x1f4)||(_0x569d33[_0x38f340(0xcb)]==_0x38f340(0x11a)||_0x569d33[_0x38f340(0xcb)]=='warning'||_0x569d33[_0x38f340(0xcb)]==_0x38f340(0x1da))&&settings[_0x38f340(0x103)]==_0x38f340(0x141)||_0x569d33[_0x38f340(0xcb)]==_0x38f340(0x241)&&settings['telegramEvents']==_0x38f340(0x243)){if(tgBot&&settings[_0x38f340(0x1b3)]){if(_0x569d33[_0x38f340(0x1a1)])await sendTelegram(settings[_0x38f340(0x1b3)],_0x569d33[_0x38f340(0x1fc)]+_0x38f340(0x285)+_0x569d33[_0x38f340(0x212)]);else await sendTelegram(settings[_0x38f340(0x1b3)],_0x38f340(0x105)+_0x5ea865+_0x38f340(0x285)+_0x569d33[_0x38f340(0x212)]);}}}}async function sendTelegramMsg(_0x25430b,_0x9c219f=_0x569596(0xe1)){const _0x3be8e1=_0x569596;return settings[_0x3be8e1(0x8c)]&&tgBot&&settings[_0x3be8e1(0x1b3)]?(await sendTelegram(settings[_0x3be8e1(0x1b3)],_0x25430b,{'parse_mode':_0x9c219f}),!![]):![];}function getDeviceWithIp(_0x19abee){const _0x33e864=_0x569596;return devices[_0x33e864(0x16b)](_0x1b7eac=>_0x1b7eac['ip']===_0x19abee);}async function temporaryAccess2FA(_0x3f6447,_0x23f2dc){const _0x207695=_0x569596;let _0x347376=new Date(),_0x98b4ff=![];if(lastIpApproval){if(_0x347376-lastIpApproval<0x1388)_0x98b4ff=!![];}lastIpApproval=new Date();if(_0x98b4ff)return;if(tgBot&&settings[_0x207695(0x1b3)]){const _0x45c98d=uuidRandom();tmpStorage[_0x45c98d]={'uuid':_0x3f6447,'externalip':_0x23f2dc};const _0x18d08c=Markup[_0x207695(0x104)]([Markup[_0x207695(0xf6)]['callback']('5\x20min',_0x207695(0x235)+_0x45c98d),Markup[_0x207695(0xf6)][_0x207695(0xb0)](_0x207695(0x1b5),_0x207695(0x16c)+_0x45c98d),Markup[_0x207695(0xf6)][_0x207695(0xb0)]('30\x20min',_0x207695(0x7f)+_0x45c98d),Markup['button'][_0x207695(0xb0)]('reject',_0x207695(0x110)+_0x45c98d)]);await sendTelegram(settings[_0x207695(0x1b3)],_0x207695(0x1e2)+normalizeIP(_0x23f2dc)['show']+'\x20?',_0x18d08c),tgBot[_0x207695(0xe3)](/tempaccess_(.+)_(.+)/,async _0x1655ab=>{const _0x23b767=_0x207695,_0xbb2a8c=_0x1655ab[_0x23b767(0xcf)][0x1],_0x3203c9=_0x1655ab['match'][0x2],{uuid:_0x220d50,externalip:_0x3d3a3e}=tmpStorage[_0x3203c9];delete tmpStorage[_0x3203c9],_0x1655ab[_0x23b767(0x14f)](),devices[_0x220d50][_0x23b767(0x26d)]={'clientip':_0x3d3a3e,'timestamp':new Date()[_0x23b767(0xe5)](),'expiry':_0xbb2a8c},_0xbb2a8c!=_0x23b767(0x1c4)?(await sendTelegram(_0x1655ab[_0x23b767(0xc1)]['id'],_0x23b767(0xf3)+_0xbb2a8c+'\x20minutes',{'parse_mode':_0x23b767(0xe1)}),io['to'](_0x220d50)[_0x23b767(0x280)](_0x23b767(0x182),{'access':{'allow':![],'reason':_0x23b767(0x142),'token':null}})):(await sendTelegram(_0x1655ab[_0x23b767(0xc1)]['id'],_0x23b767(0xf2)),io['to'](_0x220d50)[_0x23b767(0x280)](_0x23b767(0x182),{'access':{'allow':![],'reason':_0x23b767(0xd4),'token':null}}));});}}async function loginAccess2FA(_0x11f770,_0x2a7a7a){const _0x475585=_0x569596;if(tgBot&&settings[_0x475585(0x1b3)]){const _0x567a1a=uuidRandom();tmpStorage[_0x567a1a]={'uuid':_0x11f770,'externalip':_0x2a7a7a};const _0x27923c=Markup[_0x475585(0x104)]([Markup[_0x475585(0xf6)]['callback']('accept',_0x475585(0xaf)+loginExpiry+'_'+_0x567a1a),Markup[_0x475585(0xf6)][_0x475585(0xb0)](_0x475585(0x1c4),'login2fa_reject_'+_0x567a1a)]);await sendTelegram(settings[_0x475585(0x1b3)],_0x475585(0xc5)+normalizeIP(_0x2a7a7a)[_0x475585(0x211)]+'\x20?',_0x27923c),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x5b09c8=>{const _0x369202=_0x475585,_0x5625bf=_0x5b09c8[_0x369202(0xcf)][0x1],_0x426193=_0x5b09c8['match'][0x2],{uuid:_0x49d295,externalip:_0x2453c9}=tmpStorage[_0x426193];delete tmpStorage[_0x426193],_0x5b09c8[_0x369202(0x14f)](),devices[_0x49d295][_0x369202(0x8f)]={'clientip':_0x2453c9,'timestamp':new Date()['getTime'](),'expiry':_0x5625bf},_0x5625bf!=_0x369202(0x1c4)?(await sendTelegram(_0x5b09c8[_0x369202(0xc1)]['id'],_0x369202(0x9e),{'parse_mode':_0x369202(0xe1)}),io['to'](_0x49d295)['emit']('status',{'access':{'allow':![],'reason':_0x369202(0x142),'token':null}})):(await sendTelegram(_0x5b09c8['chat']['id'],_0x369202(0x268)),io['to'](_0x49d295)['emit'](_0x369202(0x182),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4d5df8=_0x569596;return dbConfig[_0x4d5df8(0x27e)](_0x4d5df8(0x247))[_0x4d5df8(0x244)](_0x4d5df8(0xe6))[_0x4d5df8(0xdd)]({'status':_0x4d5df8(0x1c0)})[_0x4d5df8(0xea)]()||[];}function getDisabledBots(){const _0x1a96d0=_0x569596;return dbConfig[_0x1a96d0(0x27e)](_0x1a96d0(0x247))[_0x1a96d0(0x244)](_0x1a96d0(0xe6))[_0x1a96d0(0xdd)]({'status':_0x1a96d0(0x27a)})[_0x1a96d0(0xea)]()||[];}function getBotAttributes(_0x26bfc5){const _0x5eae0d=_0x569596;let _0x3560cf={};const _0x17cca1=configpath+_0x5eae0d(0x1eb)+_0x26bfc5+'-config.json',_0x2652d2=fs['existsSync'](_0x17cca1);if(_0x2652d2){const _0x426fa7=fs[_0x5eae0d(0x174)](_0x17cca1);try{const _0x1faaea=JSON[_0x5eae0d(0x126)](_0x426fa7),_0x33dbc6=_0x1faaea?_0x1faaea[_0x5eae0d(0x225)][0x0]['headless']:![];_0x3560cf[_0x5eae0d(0x18e)]=_0x33dbc6?_0x5eae0d(0x97):'manual',_0x3560cf[_0x5eae0d(0x1fc)]=_0x1faaea?_0x1faaea['bot'][0x0][_0x5eae0d(0x1fc)]:_0x5eae0d(0x105)+_0x26bfc5;}catch(_0x47a54f){_0x3560cf[_0x5eae0d(0x18e)]=_0x5eae0d(0xb4),_0x3560cf[_0x5eae0d(0x1fc)]='Bot\x20'+_0x26bfc5;}}else _0x3560cf[_0x5eae0d(0x18e)]=_0x5eae0d(0xb4),_0x3560cf[_0x5eae0d(0x1fc)]='Bot\x20'+_0x26bfc5;return _0x3560cf;}function getBotsWithMode(){const _0x13d294=_0x569596,_0x448c21=dbConfig[_0x13d294(0x27e)]('bots')[_0x13d294(0x244)](_0x13d294(0xe6))[_0x13d294(0xea)]()||[];return _0x448c21[_0x13d294(0x202)](_0x5aba47=>{const _0x3e0aa0=_0x13d294;let _0x1578fc=getBotAttributes(_0x5aba47[_0x3e0aa0(0xe6)]);_0x5aba47[_0x3e0aa0(0x18e)]=_0x1578fc[_0x3e0aa0(0x18e)];}),_0x448c21;}function getBotExchanges(){const _0x53a5bb=_0x569596;let _0x2cc900=[];const _0x5d51e9=dbConfig[_0x53a5bb(0x27e)](_0x53a5bb(0x247))['sortBy'](_0x53a5bb(0xe6))['value']()||[];_0x5d51e9['forEach'](_0x33e786=>{const _0x333729=_0x53a5bb;if(_0x33e786[_0x333729(0x182)]==_0x333729(0x1c0)){const _0x33ac2e=configpath+_0x333729(0x1eb)+_0x33e786[_0x333729(0xe6)]+_0x333729(0x156),_0x107288=fs[_0x333729(0x271)](_0x33ac2e);let _0x213c6f;if(_0x107288){const _0x197117=fs[_0x333729(0x174)](_0x33ac2e);try{const _0x3736bd=JSON[_0x333729(0x126)](_0x197117);_0x213c6f=_0x3736bd?_0x3736bd[_0x333729(0x225)][0x0][_0x333729(0x14c)]:null;}catch(_0x814837){}}if(_0x213c6f)_0x2cc900[_0x333729(0x13d)](_0x213c6f);}});const _0x19b110=[...new Set(_0x2cc900)][_0x53a5bb(0x1ec)]();return _0x19b110;}async function initUser(){const _0x3c370d=_0x569596;if(!settings[_0x3c370d(0x28a)]){const _0x4cfcfa=uuidRandom();mixpanel[_0x3c370d(0x215)](_0x4cfcfa),updateSetting(_0x3c370d(0x28a),_0x4cfcfa);}}async function initSecure(){const _0x4e2549=_0x569596;let _0x353bc2=getSecure();if(!_0x353bc2[_0x4e2549(0xb8)](_0x4e2549(0x1a0))){let _0x2499de=await generateKeys();_0x353bc2[_0x4e2549(0x1a7)]=_0x2499de['publicKey'],_0x353bc2[_0x4e2549(0x270)]=_0x2499de[_0x4e2549(0x270)],_0x353bc2['secret']=crypto[_0x4e2549(0x1bc)](0x20)['toString'](_0x4e2549(0x259));;storeSecure(_0x353bc2);}}function getSettings(){const _0x46a4ae=_0x569596;return dbSettings[_0x46a4ae(0x27e)](_0x46a4ae(0x1bd))[_0x46a4ae(0xea)]()||{};}function getSecure(){const _0xd6febb=_0x569596;return dbSecure[_0xd6febb(0x27e)](_0xd6febb(0x19f))[_0xd6febb(0xea)]()||{};}function getBlacklist(){return dbSecure['get']('blacklist')['value']()||[];}function broadcastToBots(_0x4216d0,_0x2bf1a7){config['forEach'](_0x3d449d=>{const _0x860999=_0x44e3;if(_0x3d449d[_0x860999(0x182)]=='enabled'&&_0x3d449d['live']==_0x860999(0x10f)||_0x3d449d[_0x860999(0x182)]==_0x860999(0xdc)&&_0x3d449d[_0x860999(0x246)]==_0x860999(0x10f)){if(pid[_0x3d449d[_0x860999(0xe6)]])pid[_0x3d449d[_0x860999(0xe6)]][_0x860999(0x1f0)]({[_0x4216d0]:_0x2bf1a7});}});}async function storeSettings(_0x1984a2,_0x45cc1b=![]){const _0x8edec5=_0x569596;_0x1984a2={...settings,..._0x1984a2};if(_0x45cc1b&&_0x1984a2[_0x8edec5(0x13a)]!='************'&&_0x1984a2['bbPassword']!=_0x8edec5(0xab)&&_0x1984a2[_0x8edec5(0x13a)]!=''){const _0x5125ab=decryptRSA(secure['privateKey'],_0x1984a2['bbPassword'])[_0x8edec5(0x250)]('|@|')[0x0],_0x3b1a9f=bcrypt['hashSync'](_0x5125ab,saltRounds);_0x1984a2={..._0x1984a2,'bbPassword':_0x3b1a9f};}if(_0x45cc1b&&_0x1984a2[_0x8edec5(0xec)]!=_0x8edec5(0x24d)&&_0x1984a2[_0x8edec5(0xec)]!=_0x8edec5(0xab)&&_0x1984a2[_0x8edec5(0xec)]!=''){const _0x2ddd06=decryptRSA(secure[_0x8edec5(0x270)],_0x1984a2[_0x8edec5(0xec)])['split'](_0x8edec5(0x1a8))[0x0];_0x1984a2={..._0x1984a2,'telegramToken':_0x2ddd06};}if(_0x45cc1b&&_0x1984a2['marketcapApi']!=_0x8edec5(0x24d)&&_0x1984a2[_0x8edec5(0x274)]!=_0x8edec5(0xab)&&_0x1984a2[_0x8edec5(0x274)]!=''){const _0x2fa243=decryptRSA(secure['privateKey'],_0x1984a2[_0x8edec5(0x274)])['split'](_0x8edec5(0x1a8))[0x0];_0x1984a2={..._0x1984a2,'marketcapApi':_0x2fa243};}const _0x337ab5=_0x1984a2[_0x8edec5(0xec)]!='************'&&_0x1984a2[_0x8edec5(0xec)]!=settings['telegramToken']||_0x1984a2[_0x8edec5(0x24f)]!=settings[_0x8edec5(0x24f)],_0x5b8c9d=_0x1984a2[_0x8edec5(0xec)]==''||_0x1984a2[_0x8edec5(0x24f)]=='',_0x35383c=_0x1984a2['marketcapApi']&&_0x1984a2[_0x8edec5(0x274)]!='************'&&_0x1984a2[_0x8edec5(0x274)]!=settings[_0x8edec5(0xec)];_0x337ab5&&(_0x1984a2[_0x8edec5(0x1b3)]=null,_0x1984a2[_0x8edec5(0x103)]=_0x8edec5(0x1f4));for(const [_0x3675b0,_0x519732]of Object['entries'](_0x1984a2)){if(_0x3675b0==_0x8edec5(0xec)&&_0x519732==_0x8edec5(0x24d)){_0x1984a2[_0x8edec5(0xec)]=settings['telegramToken'];continue;};if(_0x3675b0=='bbPassword'&&_0x519732==_0x8edec5(0x24d)){_0x1984a2[_0x8edec5(0x13a)]=settings[_0x8edec5(0x13a)];continue;};if(_0x3675b0=='marketcapApi'&&_0x519732==_0x8edec5(0x24d)){_0x1984a2[_0x8edec5(0x274)]=settings[_0x8edec5(0x274)];continue;};dbSettings[_0x8edec5(0x1d3)](_0x8edec5(0x27b)+_0x3675b0,_0x519732)[_0x8edec5(0x19e)]();}settings=_0x1984a2,io['to'](_0x8edec5(0x88))['emit'](_0x8edec5(0x1bd),cleanSettings()),broadcastToBots(_0x8edec5(0x276),settings[_0x8edec5(0x276)]),broadcastToBots('onepagemode',settings[_0x8edec5(0x234)]),broadcastToBots(_0x8edec5(0x274),settings[_0x8edec5(0x274)]);if(_0x337ab5&&!_0x5b8c9d)initTelegram();if(_0x337ab5&&_0x5b8c9d)disableTelegram();getAllClients()[_0x8edec5(0x202)](_0x664bc6=>{const _0x433d93=_0x8edec5;getSocket(_0x664bc6['id'])[_0x433d93(0x280)](_0x433d93(0x182),{'access':{'allow':![],'reason':_0x433d93(0x142),'token':null}});}),_0x35383c&&(await sleep(0xbb8),testMarketcapApi(_0x1984a2[_0x8edec5(0x274)]));}async function testMarketcapApi(_0x231278){const _0x4914c5=_0x569596,_0x1787df=[_0x4914c5(0x251),_0x4914c5(0x14e)];try{await axios[_0x4914c5(0x27e)](_0x4914c5(0x22a),{'headers':{'X-CMC_PRO_API_KEY':_0x231278},'params':{'symbol':_0x1787df[_0x4914c5(0x118)]()}});}catch(_0x5e5181){_0x5e5181[_0x4914c5(0x118)]()[_0x4914c5(0xa7)](_0x4914c5(0x7c))?(io['to'](_0x4914c5(0x88))[_0x4914c5(0x280)](_0x4914c5(0x11b),'CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x4914c5(0x23d)](_0x4914c5(0x80))):(io['to']('botmanager')[_0x4914c5(0x280)](_0x4914c5(0x11b),'CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x4914c5(0x23d)](_0x4914c5(0x10e)),logger[_0x4914c5(0x132)](_0x4914c5(0x24a),_0x5e5181['toString']()+_0x4914c5(0x17d)+_0x5e5181[_0x4914c5(0x94)]));return;}logger[_0x4914c5(0x132)](_0x4914c5(0x101));}function updateSetting(_0x2402fa,_0x1d8dad){const _0x5281fe=_0x569596;dbSettings[_0x5281fe(0x1d3)]('settings.'+_0x2402fa,_0x1d8dad)[_0x5281fe(0x19e)](),settings=getSettings(),io['to']('botmanager')[_0x5281fe(0x280)](_0x5281fe(0x1bd),cleanSettings());}function storeSecure(_0x2c77f4){const _0x351fd2=_0x569596;dbSecure['get']('secure')[_0x351fd2(0x13d)](_0x2c77f4)['write'](),secure=_0x2c77f4;}function addBlacklist(_0x1fb72c){const _0x57e637=_0x569596;cleanBlacklist();let _0x5ee505;devices[_0x1fb72c][_0x57e637(0x26d)]?_0x5ee505=Math['max'](devices[_0x1fb72c][_0x57e637(0x26d)][_0x57e637(0x146)],loginExpiry):_0x5ee505=loginExpiry,dbSecure['get'](_0x57e637(0x8d))[_0x57e637(0x13d)]({'expiry':new Date()[_0x57e637(0xe5)]()+_0x5ee505*0x3c*0x3e8,'token':devices[_0x1fb72c][_0x57e637(0xb3)][_0x57e637(0x255)]})[_0x57e637(0x19e)](),blacklist=dbSecure[_0x57e637(0x27e)](_0x57e637(0x8d))[_0x57e637(0xea)]();}function cleanBlacklist(){const _0x3079f7=_0x569596;let _0xc1230f=dbSecure[_0x3079f7(0x27e)](_0x3079f7(0x8d))[_0x3079f7(0xbf)]()[_0x3079f7(0xea)](),_0xf3c3d7=new Date()[_0x3079f7(0xe5)]();_0xc1230f[_0x3079f7(0x202)](_0x573cab=>{const _0x21c516=_0x3079f7;_0x573cab['expiry']<_0xf3c3d7&&dbSecure[_0x21c516(0x27e)](_0x21c516(0x8d))[_0x21c516(0xf5)]({'expiry':_0x573cab[_0x21c516(0x146)]})[_0x21c516(0x19e)]();});}function initStates(){const _0xd16f3f=_0x569596;let _0xd0008a=getConfiguration();_0xd0008a[_0xd16f3f(0x202)](_0x48e4d3=>{const _0x42ed20=_0xd16f3f;_0x48e4d3[_0x42ed20(0x246)]=_0x42ed20(0x148);}),storeConfiguration(_0xd0008a);}async function generateKeys(){const _0x5ea523=_0x569596,_0x340963=forge[_0x5ea523(0x1d8)][_0x5ea523(0x1f1)][_0x5ea523(0xe8)]({'bits':0x1000,'e':0x10001}),_0x3293bf=forge[_0x5ea523(0x1d8)][_0x5ea523(0x17b)](_0x340963['privateKey']),_0x2af8bb=forge[_0x5ea523(0x1d8)]['publicKeyToPem'](_0x340963[_0x5ea523(0x1a7)]);return{'privateKey':_0x3293bf,'publicKey':_0x2af8bb};}async function oneTimeMigration(){const _0x3b96e6=_0x569596;let _0x3eee58=getSettings(),_0x4186ae=![];!_0x3eee58[_0x3b96e6(0xb8)](_0x3b96e6(0x1e9))&&(_0x3eee58[_0x3b96e6(0x1e9)]=0x0,_0x4186ae=!![]);!_0x3eee58['hasOwnProperty']('lastmsgemitted')&&(_0x3eee58[_0x3b96e6(0x1b0)]=0x0,_0x4186ae=!![]);!_0x3eee58[_0x3b96e6(0xb8)](_0x3b96e6(0x166))&&(_0x3eee58[_0x3b96e6(0x166)]='0.0.0',_0x4186ae=!![]);!_0x3eee58[_0x3b96e6(0xb8)]('onepagemode')&&(_0x3eee58['onepagemode']=![],_0x4186ae=!![]);!_0x3eee58['hasOwnProperty'](_0x3b96e6(0x274))&&(_0x3eee58[_0x3b96e6(0x274)]='',_0x4186ae=!![]);if(_0x4186ae)storeSettings(_0x3eee58);try{fs[_0x3b96e6(0x1e0)](configbackuppath,{'withFileTypes':!![]})[_0x3b96e6(0x202)](_0x475390=>{const _0x331467=_0x3b96e6;if(!_0x475390[_0x331467(0x151)]()){if(!_0x475390[_0x331467(0x15e)]['startsWith'](_0x331467(0x1c9)))fs[_0x331467(0x22b)](configbackuppath+_0x475390[_0x331467(0x15e)]);}else fs['rmSync'](configbackuppath+_0x475390[_0x331467(0x15e)],{'recursive':!![]});});}catch(_0x58fd3f){logger[_0x3b96e6(0x132)](_0x3b96e6(0x19c),_0x58fd3f);}}function storeConfiguration(_0x1b3e8d){const _0x4ec093=_0x569596;dbConfig[_0x4ec093(0x27e)]('bots')['remove']()[_0x4ec093(0x19e)](),dbConfig[_0x4ec093(0x27e)](_0x4ec093(0x247))['push'](..._0x1b3e8d)[_0x4ec093(0x19e)](),config=_0x1b3e8d;}function _0x44e3(_0x3e1ade,_0x5ad571){const _0x53bd69=_0x51e3();return _0x44e3=function(_0x47f4e4,_0xa4a8a4){_0x47f4e4=_0x47f4e4-0x7c;let _0x51e323=_0x53bd69[_0x47f4e4];return _0x51e323;},_0x44e3(_0x3e1ade,_0x5ad571);}async function resetPassword(){const _0x35043c=_0x569596;if(tgBot&&settings['telegramChatId']){const _0x3f58a4=Markup[_0x35043c(0x104)]([Markup[_0x35043c(0xf6)]['callback'](_0x35043c(0xfc),_0x35043c(0x206)),Markup[_0x35043c(0xf6)][_0x35043c(0xb0)]('no',_0x35043c(0xa9))]);await sendTelegram(settings[_0x35043c(0x1b3)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x3f58a4),tgBot[_0x35043c(0xe3)](/resetpw_(.+)/,async _0x3bcff9=>{const _0x3bea55=_0x35043c,_0x4c6a23=_0x3bcff9[_0x3bea55(0xcf)][0x1];_0x3bcff9[_0x3bea55(0x14f)]();if(_0x4c6a23!='no'){const _0x403a20=0xf,_0x2a9ebd=_0x3bea55(0x1ac),_0x251769=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x403a20)))[_0x3bea55(0x23e)](_0x5e2964=>_0x2a9ebd[_0x5e2964%_0x2a9ebd[_0x3bea55(0x179)]])[_0x3bea55(0xeb)](''),_0xf40607=bcrypt[_0x3bea55(0x187)](_0x251769,saltRounds);storeSettings({'bbPassword':_0xf40607}),await sendTelegram(_0x3bcff9[_0x3bea55(0xc1)]['id'],_0x3bea55(0xca)+_0x251769,{'parse_mode':_0x3bea55(0xe1)});}else await sendTelegram(_0x3bcff9[_0x3bea55(0xc1)]['id'],_0x3bea55(0xc7));});}}async function confirmRestore(_0x559783,_0xf62948){const _0x17c4e8=_0x569596;io['to'](_0x17c4e8(0x88))[_0x17c4e8(0x280)]('notification',_0x17c4e8(0x173),'success');if(tgBot&&settings[_0x17c4e8(0x1b3)]){const _0x1d949a=uuidRandom();tmpStorage[_0x1d949a]={'path':_0x559783,'filename':_0xf62948};const _0x3277e3=Markup[_0x17c4e8(0x104)]([Markup[_0x17c4e8(0xf6)][_0x17c4e8(0xb0)](_0x17c4e8(0xfc),_0x17c4e8(0x1c6)+_0x1d949a),Markup[_0x17c4e8(0xf6)][_0x17c4e8(0xb0)]('no',_0x17c4e8(0xbc)+_0x1d949a)]);await sendTelegram(settings[_0x17c4e8(0x1b3)],_0x17c4e8(0x17e),_0x3277e3),tgBot['action'](/restore_(.+)_(.+)/,async _0x21b450=>{const _0x3f20f4=_0x17c4e8,_0x221887=_0x21b450[_0x3f20f4(0xcf)][0x1],_0x4aff9a=_0x21b450[_0x3f20f4(0xcf)][0x2],{path:_0x49fc8b,filename:_0x2ce9ea}=tmpStorage[_0x4aff9a];delete tmpStorage[_0x4aff9a],_0x21b450['editMessageReplyMarkup'](),_0x221887==_0x3f20f4(0xfc)?(logger[_0x3f20f4(0x132)](_0x3f20f4(0x163)),await sendTelegram(_0x21b450[_0x3f20f4(0xc1)]['id'],_0x3f20f4(0x14d),{'parse_mode':_0x3f20f4(0xe1)}),unzipFile(_0x49fc8b,_0x2ce9ea)):(logger[_0x3f20f4(0x132)](_0x3f20f4(0x12f)),await sendTelegram(_0x21b450['chat']['id'],_0x3f20f4(0x12f)));});}}function getServerTime(){const _0x5d770d=_0x569596,_0x55dcf1=new Date();return _0x55dcf1[_0x5d770d(0x1bf)]()+'/'+(_0x55dcf1['getMonth']()+0x1)[_0x5d770d(0x118)]()['padStart'](0x2,'0')+'/'+_0x55dcf1[_0x5d770d(0x1a6)]()['toString']()[_0x5d770d(0x1ed)](0x2,'0')+'\x20'+_0x55dcf1[_0x5d770d(0x279)]()[_0x5d770d(0x118)]()[_0x5d770d(0x1ed)](0x2,'0')+':'+_0x55dcf1[_0x5d770d(0xad)]()[_0x5d770d(0x118)]()[_0x5d770d(0x1ed)](0x2,'0')+':'+_0x55dcf1['getSeconds']()[_0x5d770d(0x118)]()[_0x5d770d(0x1ed)](0x2,'0');}function getTimeStamp(){const _0x2f6be1=_0x569596,_0x2f8fea=shiftedTime();return _0x2f8fea[_0x2f6be1(0x1bf)]()+'/'+(_0x2f8fea[_0x2f6be1(0x120)]()+0x1)[_0x2f6be1(0x118)]()[_0x2f6be1(0x1ed)](0x2,'0')+'/'+_0x2f8fea[_0x2f6be1(0x1a6)]()[_0x2f6be1(0x118)]()[_0x2f6be1(0x1ed)](0x2,'0')+'\x20'+_0x2f8fea[_0x2f6be1(0x279)]()[_0x2f6be1(0x118)]()[_0x2f6be1(0x1ed)](0x2,'0')+':'+_0x2f8fea[_0x2f6be1(0xad)]()[_0x2f6be1(0x118)]()['padStart'](0x2,'0')+':'+_0x2f8fea[_0x2f6be1(0x19a)]()[_0x2f6be1(0x118)]()[_0x2f6be1(0x1ed)](0x2,'0');}function getCleanTimeStamp(){const _0x5a341b=_0x569596,_0x2f7f8e=shiftedTime();return _0x2f7f8e[_0x5a341b(0x1bf)]()+(_0x2f7f8e['getMonth']()+0x1)[_0x5a341b(0x118)]()[_0x5a341b(0x1ed)](0x2,'0')+_0x2f7f8e[_0x5a341b(0x1a6)]()[_0x5a341b(0x118)]()[_0x5a341b(0x1ed)](0x2,'0')+'-'+_0x2f7f8e[_0x5a341b(0x279)]()['toString']()[_0x5a341b(0x1ed)](0x2,'0')+_0x2f7f8e[_0x5a341b(0xad)]()[_0x5a341b(0x118)]()['padStart'](0x2,'0')+_0x2f7f8e[_0x5a341b(0x19a)]()[_0x5a341b(0x118)]()[_0x5a341b(0x1ed)](0x2,'0');}function shiftedTime(){const _0x4ccef6=_0x569596,_0x590b63=new Date();let _0x54462b=_0x590b63;if(settings[_0x4ccef6(0x276)]&&settings[_0x4ccef6(0x276)]!==0x0)_0x54462b=fns[_0x4ccef6(0x1d5)](_0x590b63,{'hours':settings[_0x4ccef6(0x276)]});return _0x54462b;}async function startScheduler(){const _0x1e7de9=_0x569596,_0x2cf693=new Date()[_0x1e7de9(0x222)](),_0x1f90b4=shiftedTime()['getHours']();_0x1f90b4==0x4&&backupConfigFiles(),_0x1f90b4==0x0&&rotateLogFiles(),_0x2cf693%0x6==0x0&&triggerAnalytics(),_0x2cf693%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x5544c5){const _0x3aea8a=_0x569596;logger[_0x3aea8a(0x132)](_0x3aea8a(0x267)+_0x5544c5);const _0x59b703=getBotsWithMode();_0x59b703[_0x3aea8a(0x179)]>0x0?confirmRestore(configbackuppath,_0x5544c5):unzipFile(configbackuppath,_0x5544c5);}async function getBackupFiles(_0x2b4a29=null){const _0x1f6800=_0x569596;let _0x2849ab=[],_0x30b11c=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x30b11c[_0x1f6800(0x1ec)]((_0x518418,_0x332b35)=>_0x518418[_0x1f6800(0x15e)]<_0x332b35['name']?0x1:_0x332b35['name']<_0x518418[_0x1f6800(0x15e)]?-0x1:0x0),_0x30b11c['forEach'](_0x3faddf=>{const _0x422b98=_0x1f6800;if(!_0x3faddf[_0x422b98(0x151)]()&&_0x3faddf[_0x422b98(0x15e)]['startsWith'](_0x422b98(0x1c9))&&_0x3faddf[_0x422b98(0x15e)][_0x422b98(0x1ad)]('.zip')){const _0x4aa47c=formatDate(fs[_0x422b98(0x17f)](configbackuppath+_0x3faddf[_0x422b98(0x15e)])[_0x422b98(0x197)]);_0x2849ab[_0x422b98(0x13d)]({'name':_0x3faddf[_0x422b98(0x15e)],'mtime':_0x4aa47c});}});if(_0x2b4a29)io['to'](_0x2b4a29)[_0x1f6800(0x280)](_0x1f6800(0x164),_0x2849ab);else return _0x2849ab;}async function backupConfigFiles(){const _0x2bc457=_0x569596;await zipFiles(_0x2bc457(0x289));const _0x2078ba=getCleanTimeStamp();fs[_0x2bc457(0x238)](zippath+_0x2bc457(0x24b),configbackuppath+(_0x2bc457(0x1c9)+_0x2078ba+_0x2bc457(0x1f3)));let _0x30191f=fs[_0x2bc457(0x1e0)](configbackuppath,{'withFileTypes':!![]});_0x30191f['sort']((_0xb9a1f5,_0x43d73d)=>_0xb9a1f5[_0x2bc457(0x15e)]<_0x43d73d[_0x2bc457(0x15e)]?0x1:_0x43d73d[_0x2bc457(0x15e)]<_0xb9a1f5[_0x2bc457(0x15e)]?-0x1:0x0),_0x30191f['length']>maxBackups&&fs['unlinkSync'](configbackuppath+_0x30191f[_0x30191f[_0x2bc457(0x179)]-0x1][_0x2bc457(0x15e)]);}function rotateLogFiles(){const _0x383862=_0x569596,_0x292fcb=fs[_0x383862(0x17f)](logspath+_0x383862(0x228)),_0xbe217f=_0x292fcb['size']/0x400;if(_0xbe217f>0x64){let _0x1a49cf=fs[_0x383862(0x1e0)](logspath,{'withFileTypes':!![]});_0x1a49cf[_0x383862(0x1ec)]((_0x5af285,_0x2fa9f5)=>_0x5af285['name']<_0x2fa9f5[_0x383862(0x15e)]?0x1:_0x2fa9f5[_0x383862(0x15e)]<_0x5af285[_0x383862(0x15e)]?-0x1:0x0),_0x1a49cf[_0x383862(0x202)](_0x13b33d=>{const _0x5b2117=_0x383862;if(_0x13b33d['name']==_0x5b2117(0xa3))fs[_0x5b2117(0x238)](logspath+_0x13b33d[_0x5b2117(0x15e)],logspath+'output-003.log');if(_0x13b33d[_0x5b2117(0x15e)]==_0x5b2117(0x1dc))fs[_0x5b2117(0x238)](logspath+_0x13b33d[_0x5b2117(0x15e)],logspath+_0x5b2117(0xa3));_0x13b33d[_0x5b2117(0x15e)]==_0x5b2117(0x228)&&(fs[_0x5b2117(0x238)](logspath+_0x13b33d[_0x5b2117(0x15e)],logspath+_0x5b2117(0x1dc)),fs[_0x5b2117(0x1b9)](logspath+_0x13b33d['name'],''));});}}async function zipFiles(_0x9bc89a){const _0x478ccf=_0x569596;let _0x1528eb;if(_0x9bc89a==_0x478ccf(0x26b))_0x1528eb=logspath;if(_0x9bc89a=='backup')_0x1528eb=configpath;if(_0x9bc89a==_0x478ccf(0x289))_0x1528eb=configpath;let _0x5488ca=fs[_0x478ccf(0x1e0)](_0x1528eb,{'withFileTypes':!![]});const _0x3cb59a=new JSZip();_0x5488ca[_0x478ccf(0x202)](_0x2d1021=>{const _0x3b4c22=_0x478ccf;if(!_0x2d1021['isDirectory']()){let _0x2aa5c9=fs[_0x3b4c22(0x174)](_0x1528eb+_0x2d1021[_0x3b4c22(0x15e)]);if(_0x9bc89a==_0x3b4c22(0xc2)){const _0x2c1a9f=/^bot-[0-9]{3}-config.json$/,_0x55fc34=_0x2c1a9f['test'](_0x2d1021[_0x3b4c22(0x15e)]);if(_0x55fc34){const _0x4c0487=JSON[_0x3b4c22(0x126)](_0x2aa5c9);if(_0x4c0487['bot'][0x0]){_0x4c0487[_0x3b4c22(0x225)][0x0][_0x3b4c22(0xc0)]=_0x3b4c22(0xab),_0x4c0487[_0x3b4c22(0x225)][0x0]['apiSecret']=_0x3b4c22(0xab);if(_0x4c0487[_0x3b4c22(0x225)][0x0][_0x3b4c22(0x18c)])_0x4c0487[_0x3b4c22(0x225)][0x0][_0x3b4c22(0x18c)]='***';}_0x2aa5c9=JSON[_0x3b4c22(0x226)](_0x4c0487,null,0x2);}if(_0x2d1021[_0x3b4c22(0x15e)]==_0x3b4c22(0xb9)){const _0x1387b6=JSON[_0x3b4c22(0x126)](_0x2aa5c9);if(_0x1387b6[_0x3b4c22(0x1bd)][_0x3b4c22(0x1b8)])_0x1387b6['settings'][_0x3b4c22(0x1b8)]=![];if(_0x1387b6[_0x3b4c22(0x1bd)][_0x3b4c22(0x13a)])_0x1387b6['settings']['bbPassword']=_0x3b4c22(0xab);if(_0x1387b6[_0x3b4c22(0x1bd)][_0x3b4c22(0xec)])_0x1387b6[_0x3b4c22(0x1bd)][_0x3b4c22(0xec)]=_0x3b4c22(0xab);if(_0x1387b6[_0x3b4c22(0x1bd)][_0x3b4c22(0x1b3)])_0x1387b6[_0x3b4c22(0x1bd)][_0x3b4c22(0x1b3)]=null;if(_0x1387b6[_0x3b4c22(0x1bd)][_0x3b4c22(0x274)])_0x1387b6[_0x3b4c22(0x1bd)][_0x3b4c22(0x274)]=_0x3b4c22(0xab);_0x2aa5c9=JSON[_0x3b4c22(0x226)](_0x1387b6,null,0x2);}if(_0x2d1021[_0x3b4c22(0x15e)]!=_0x3b4c22(0xf1))_0x3cb59a['file'](_0x2d1021[_0x3b4c22(0x15e)],_0x2aa5c9);}else _0x3cb59a['file'](_0x2d1021['name'],_0x2aa5c9);}});const _0x5d81b7=await _0x3cb59a['generateAsync']({'type':_0x478ccf(0x82),'base64':![],'compression':'DEFLATE'});fs[_0x478ccf(0x1b9)](zippath+(_0x9bc89a+_0x478ccf(0x1f3)),_0x5d81b7,_0x478ccf(0xfe));}async function unzipFile(_0x2c4062,_0x1d6392){const _0x1dc526=_0x569596;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x1dc526(0x202)](_0x3c491c=>{if(!_0x3c491c['isDirectory']())fs['rmSync'](configpath+_0x3c491c['name']);});const _0x4d7bf1=fs['readFileSync'](_0x2c4062+_0x1d6392,_0x1dc526(0xfe)),_0xa4cc47=await JSZip[_0x1dc526(0x227)](_0x4d7bf1,{'base64':![],'checkCRC32':!![]});for(const _0x3bdb51 of Object[_0x1dc526(0x134)](_0xa4cc47['files'])){const _0x1d7091=_0xa4cc47[_0x1dc526(0x1c5)][_0x3bdb51],_0x416cf0=await _0x1d7091[_0x1dc526(0x283)](_0x1dc526(0x82));fs[_0x1dc526(0x1b9)](configpath+_0x1d7091[_0x1dc526(0x15e)],_0x416cf0);}fs[_0x1dc526(0x1e0)](temppath,{'withFileTypes':!![]})[_0x1dc526(0x202)](_0x33c7eb=>{const _0x1070f6=_0x1dc526;if(!_0x33c7eb[_0x1070f6(0x151)]())fs[_0x1070f6(0x17a)](temppath+_0x33c7eb[_0x1070f6(0x15e)]);}),logger[_0x1dc526(0x132)](_0x1dc526(0x1f7)),process[_0x1dc526(0x1f0)]({'restore':!![]},_0x2be2b1=>{});}async function getPublicIp(){const _0x1155e7=_0x569596;try{const _0x824364=await axios[_0x1155e7(0x27e)]('https://api.ipify.org?format=json');publicip=_0x824364[_0x1155e7(0x158)]['ip'];}catch(_0xd36b44){}}async function triggerAnalytics(){const _0x34e678=_0x569596;if(!publicip)await getPublicIp();const _0x42f3a3=getBotsWithMode();let _0x72eeb=0x0;_0x42f3a3['forEach'](_0x49f450=>{const _0x37809c=_0x44e3;if(_0x49f450[_0x37809c(0x182)]===_0x37809c(0x1c0))_0x72eeb++;});const _0x39fb3a=getBotExchanges();mixpanel[_0x34e678(0x15f)]('Server',{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x42f3a3[_0x34e678(0x179)],'numbotsenabled':_0x72eeb,'exchanges':_0x39fb3a,'environment':environment});}async function getMessages(){const _0x5cbc88=_0x569596,_0x26c16e=_0x5cbc88(0x1b7),_0x27f2c4=new GraphQLClient(_0x26c16e),_0x132be9={'authorization':_0x5cbc88(0x150)},_0x2df1f3=serverversion[_0x5cbc88(0x250)]('.'),_0x53a922=_0x2df1f3[0x0]+'.'+_0x2df1f3[0x1],_0x2df0b1=Math[_0x5cbc88(0x188)](settings[_0x5cbc88(0x1e9)],settings[_0x5cbc88(0x1b0)]),_0xa4b2ab={'last':parseInt(_0x2df0b1),'bbm':_0x53a922},_0x1e4866=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x390e6;try{_0x390e6=await _0x27f2c4[_0x5cbc88(0x223)](_0x1e4866,_0xa4b2ab,_0x132be9);}catch(_0x12202e){}if(_0x390e6&&_0x390e6[_0x5cbc88(0x1c2)]){let _0x76ee20=settings[_0x5cbc88(0x1e9)];newMessages=[];for(const _0x33b3f7 of _0x390e6[_0x5cbc88(0x1c2)]){newMessages[_0x5cbc88(0x13d)](_0x33b3f7);let _0x3f9895=![];_0x33b3f7[_0x5cbc88(0x12e)]&&(updateSetting(_0x5cbc88(0x166),_0x33b3f7['bbvNew']),_0x3f9895=isNewerVersion(serverversion,_0x33b3f7[_0x5cbc88(0x12e)])||serverversion==_0x33b3f7[_0x5cbc88(0x12e)]);if(!_0x3f9895&&_0x33b3f7['number']>_0x76ee20){if(_0x33b3f7[_0x5cbc88(0x200)]==='any'||serverversion['startsWith'](_0x33b3f7['bbvReceive'])){let _0xe3118e=''+_0x33b3f7[_0x5cbc88(0x1ce)]+'\x0a\x0a'+_0x33b3f7[_0x5cbc88(0x18b)];const _0xaa0c89=await sendTelegramMsg(toTelegramMarkdown(_0xe3118e),_0x5cbc88(0x1a3));if(_0xaa0c89)_0x76ee20=_0x33b3f7[_0x5cbc88(0x86)];}}}updateAvailable=isNewerVersion(settings[_0x5cbc88(0x166)],serverversion),updateSetting(_0x5cbc88(0x1e9),_0x76ee20),emitMessages();}}function emitMessages(){const _0x96d9f5=_0x569596,_0x16798c=settings[_0x96d9f5(0x1b0)];let _0x11ca4d=[];newMessages[_0x96d9f5(0x202)](_0x271021=>{const _0x486a47=_0x96d9f5;_0x271021[_0x486a47(0x86)]>_0x16798c&&_0x11ca4d['push'](_0x271021);}),_0x11ca4d['length']>0x0&&getAllClients()[_0x96d9f5(0x202)](_0x73d8ce=>{const _0x564269=_0x96d9f5;getSocket(_0x73d8ce['id'])[_0x564269(0x280)](_0x564269(0x18b),_0x11ca4d);});}function confirmMessage(_0x590495){updateSetting('lastmsgemitted',Number(_0x590495));}function isNewerVersion(_0x16c6b5,_0x16cf2c){const _0x5e1573=_0x569596,_0xd0cea0=_0x16cf2c['split']('.'),_0x1548a7=_0x16c6b5[_0x5e1573(0x250)]('.');for(var _0x3d4d9e=0x0;_0x3d4d9e<_0x1548a7[_0x5e1573(0x179)];_0x3d4d9e++){const _0x8d2a84=~~_0x1548a7[_0x3d4d9e],_0x4be535=~~_0xd0cea0[_0x3d4d9e];if(_0x8d2a84>_0x4be535)return!![];if(_0x8d2a84<_0x4be535)return![];}return![];}function toTelegramMarkdown(_0x4fc38c){const _0x3b6e86=_0x569596,_0x228a7c=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x47af24=/\*{2}(.+?)\*{2}/gim;return _0x4fc38c=_0x4fc38c[_0x3b6e86(0x19b)](_0x228a7c,_0x3b6e86(0x1fe))[_0x3b6e86(0x19b)](_0x47af24,_0x3b6e86(0x154)),_0x4fc38c;}async function validateConfigFile(){const _0xbd088=_0x569596,_0x4a907d=dbConfig[_0xbd088(0x27e)](_0xbd088(0x247))['sortBy'](_0xbd088(0xe6))[_0xbd088(0xea)]()||[];if(_0x4a907d[_0xbd088(0x179)]==0x0){let _0x147603=0x0,_0x186952=[];const _0x211861=/^bot-([0-9]{3})-config.json$/,_0x382028=fs[_0xbd088(0x1e0)](configpath);_0x382028[_0xbd088(0x202)](_0x2f63af=>{const _0x5902fe=_0xbd088,_0x14c900=_0x211861[_0x5902fe(0x8b)](_0x2f63af);if(_0x14c900){const _0x2182f1=_0x14c900[0x1];let _0x24d09c=getBotAttributes(_0x2182f1);_0x186952[_0x5902fe(0x13d)]({'botID':_0x2182f1,'botname':_0x24d09c[_0x5902fe(0x1fc)],'status':_0x5902fe(0x27a),'live':_0x5902fe(0x148)}),_0x147603++;}}),_0x147603!=0x0&&(dbConfig[_0xbd088(0x27e)](_0xbd088(0x247))[_0xbd088(0xc4)](_0x186952)[_0xbd088(0x19e)](),config=_0x186952,restoredConfigFile=_0x147603);}}async function restoreConfigNotify(_0x1ff375){const _0x2fd3e0=_0x569596;let _0x1b3e51;if(restoredConfigFile==0x1)_0x1b3e51=_0x2fd3e0(0x8e);else _0x1b3e51='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x1ff375)io['to'](_0x2fd3e0(0x88))[_0x2fd3e0(0x280)]('notification',_0x1b3e51);else{logger[_0x2fd3e0(0xc9)](_0x2fd3e0(0x10c)),logger[_0x2fd3e0(0xc9)](_0x1b3e51),logger[_0x2fd3e0(0xc9)]('-----------------------------------------------------------------------------------'),logger['simple']('');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x2fd3e0(0x243))await sendTelegram(settings[_0x2fd3e0(0x1b3)],_0x2fd3e0(0x26e)+_0x1b3e51);}}function decryptRSA(_0x405992,_0x397e48){const _0x3be931=_0x569596,_0xed4baf=forge['pki'][_0x3be931(0xd2)](_0x405992),_0x6e26f6=_0xed4baf['decrypt'](forge[_0x3be931(0xf8)]['decode64'](_0x397e48),_0x3be931(0x172),{'md':forge['md'][_0x3be931(0x15a)][_0x3be931(0xd9)](),'mgf1':{'md':forge['md'][_0x3be931(0x15a)][_0x3be931(0xd9)]()}});return _0x6e26f6;}function validateCredentials(_0x2265fc,_0x568890){const _0x23c0a5=_0x569596;if(_0x2265fc[_0x23c0a5(0x20e)]==settings[_0x23c0a5(0x138)]&&bcrypt[_0x23c0a5(0x195)](_0x2265fc[_0x23c0a5(0x1aa)],settings[_0x23c0a5(0x13a)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x23c0a5(0x192),'token':null};else{const _0xfba1cd=generateLoginToken(_0x568890);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0xfba1cd};}}else return{'allow':![],'reason':_0x23c0a5(0xfd),'token':null};}function refreshToken(_0x53233f){const _0xb4a84d=generateLoginToken(_0x53233f);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0xb4a84d};}function validateAccess(_0x47e827,_0x3def09,_0x5bfbd0){const _0x126a23=_0x569596,_0x3e1ad5=_0x5bfbd0?_0x5bfbd0:devices[_0x3def09]['ip'];let _0x542e12;const _0x204237=_0x19d9b6=>{const _0x1dfc4c=_0x44e3;if(settings['loginRequired']){if(settings[_0x1dfc4c(0x135)]){if(telegram2FaApproved(_0x3def09)){const _0x2e0bb4=generateLoginToken(_0x3def09);return{'allow':!![],'reason':_0x1dfc4c(0x221),'token':_0x2e0bb4};}else return{'allow':![],'reason':_0x1dfc4c(0x22d),'token':null};}else return _0x542e12=validToken(_0x19d9b6,_0x3def09),_0x542e12['hasOwnProperty'](_0x1dfc4c(0x1da))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x19d9b6}:{'allow':![],'reason':_0x1dfc4c(0x22d),'token':null};}else return{'allow':!![],'reason':_0x1dfc4c(0x1de),'token':null};};if(settings['whitelistEnabled']){let _0x3194e8=[...settings[_0x126a23(0x7e)],_0x126a23(0xa2),'::ffff:127.0.0.1',_0x126a23(0x281)];if(_0x3194e8[_0x126a23(0xa7)](_0x3e1ad5))return _0x204237(_0x47e827);else{_0x542e12=validToken(_0x47e827,_0x3def09);if(_0x542e12['hasOwnProperty'](_0x126a23(0x1da)))return _0x204237(_0x47e827);else{if(telegramIpApproved(_0x3def09)){const _0x7d6e7a=generateToken(_0x3def09);return _0x542e12=_0x204237(_0x47e827),_0x542e12[_0x126a23(0x262)]?{'allow':!![],'reason':_0x126a23(0x229),'token':_0x7d6e7a}:_0x542e12;}else return settings[_0x126a23(0x18a)]?{'allow':![],'reason':_0x126a23(0xbb),'token':null}:{'allow':![],'reason':_0x126a23(0xd0),'token':null};}}}else return _0x204237(_0x47e827);}function timelyDecrypt(_0x35049c,_0x2e6849,_0x2d7902='@'){const _0x1a1328=_0x569596;if(_0x35049c)try{const _0x3912dd=decryptRSA(secure[_0x1a1328(0x270)],_0x35049c),_0x544f9d=_0x3912dd['split'](_0x2d7902)[0x0],_0x61deb6=_0x3912dd['split'](_0x2d7902)[0x1],_0x23ceb5=new Date()[_0x1a1328(0xe5)]();if(_0x2e6849){if(_0x23ceb5-_0x61deb6<maxSecretAge*0x3e8)return _0x544f9d;else return![];}else return _0x544f9d;}catch(_0x118e71){return![];}else return![];}const validToken=(_0x37bcd9,_0x3e906a)=>{const _0x1a8287=_0x569596,_0x4c6de4=devices[_0x3e906a]['ip'];if(!_0x37bcd9)return{'error':_0x1a8287(0xff)};for(let _0x423fcc of blacklist){if(_0x423fcc[_0x1a8287(0x255)]==_0x37bcd9)return{'error':'Token\x20blacklisted'};}let _0x3034b5;try{_0x3034b5=jwt[_0x1a8287(0x25b)](_0x37bcd9,secure['secret']+_0x3e906a);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x3034b5['hasOwnProperty'](_0x1a8287(0x189))&&!_0x3034b5[_0x1a8287(0xb8)](_0x1a8287(0x20e))||!_0x3034b5['hasOwnProperty'](_0x1a8287(0x287)))return{'error':_0x1a8287(0x199)};if(!_0x3034b5[_0x1a8287(0xb8)](_0x1a8287(0x20e))&&_0x3034b5[_0x1a8287(0xb8)](_0x1a8287(0x189))){const {clientip:_0x20fe88}=_0x3034b5;return _0x4c6de4==_0x20fe88?{'success':_0x1a8287(0x121)}:{'error':_0x1a8287(0x171)};}else{if(_0x3034b5['hasOwnProperty']('username')&&_0x3034b5[_0x1a8287(0xb8)]('clientip')){const {username:_0x2220c0,clientip:_0x23c72c}=_0x3034b5;return settings[_0x1a8287(0x138)]==_0x2220c0&&_0x4c6de4==_0x23c72c?{'success':_0x1a8287(0x121)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x3a9fd8=>{const _0x8b8ef5=_0x569596;if(_0x3a9fd8){const _0x3759d9=devices[_0x3a9fd8]['ip'];return jwt['sign']({'username':settings[_0x8b8ef5(0x138)],'clientip':_0x3759d9},secure['secret']+_0x3a9fd8,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x176e4c=>{const _0x1175de=_0x569596;if(_0x176e4c){const _0x447930=devices[_0x176e4c]['ip'];return jwt['sign']({'clientip':_0x447930},secure[_0x1175de(0x1a0)]+_0x176e4c,{'expiresIn':devices[_0x176e4c][_0x1175de(0x26d)][_0x1175de(0x146)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x32e6c4=>{const _0x5596a8=_0x569596;let _0x3447c9=![];return devices[_0x32e6c4]['telegramIpApproval']&&devices[_0x32e6c4][_0x5596a8(0x26d)]['expiry']!=_0x5596a8(0x1c4)&&(_0x3447c9=devices[_0x32e6c4]['telegramIpApproval'][_0x5596a8(0x189)]==devices[_0x32e6c4]['ip']&&new Date()[_0x5596a8(0xe5)]()-devices[_0x32e6c4][_0x5596a8(0x26d)][_0x5596a8(0x14b)]<devices[_0x32e6c4]['telegramIpApproval'][_0x5596a8(0x146)]*0x3c*0x3e8),_0x3447c9;},telegram2FaApproved=_0x19c6f9=>{const _0x3aee78=_0x569596;let _0x54fb4e=![];return devices[_0x19c6f9][_0x3aee78(0x8f)]&&devices[_0x19c6f9][_0x3aee78(0x8f)][_0x3aee78(0x146)]!=_0x3aee78(0x1c4)&&(_0x54fb4e=devices[_0x19c6f9]['telegram2FaApproval']['clientip']==devices[_0x19c6f9]['ip']&&new Date()[_0x3aee78(0xe5)]()-devices[_0x19c6f9]['telegram2FaApproval'][_0x3aee78(0x14b)]<devices[_0x19c6f9]['telegram2FaApproval'][_0x3aee78(0x146)]*0x3c*0x3e8),_0x54fb4e;},normalizeIP=_0x4e2357=>{const _0x1e85de=_0x569596;let _0x541100=null,_0x323f4f=null;if(ipaddr[_0x1e85de(0x266)](_0x4e2357)){const _0x1b8e6e=ipaddr[_0x1e85de(0x126)](_0x4e2357);_0x1b8e6e[_0x1e85de(0x149)]()===_0x1e85de(0xcd)?(_0x1b8e6e[_0x1e85de(0xb2)]()&&(_0x541100=_0x1b8e6e[_0x1e85de(0x191)]()['toString']()),_0x323f4f=_0x1b8e6e['toString']()):(_0x541100=_0x1b8e6e[_0x1e85de(0x118)](),_0x323f4f=_0x1b8e6e['toIPv4MappedAddress']()[_0x1e85de(0x118)]());}return{'show':_0x541100?_0x541100:_0x323f4f,'store':_0x323f4f};};function formatDate(_0x4fb5f5){const _0x2c7883=_0x569596;return _0x4fb5f5[_0x2c7883(0x1bf)]()+'/'+(_0x4fb5f5['getMonth']()+0x1)['toString']()[_0x2c7883(0x1ed)](0x2,'0')+'/'+_0x4fb5f5['getDate']()[_0x2c7883(0x118)]()[_0x2c7883(0x1ed)](0x2,'0')+'\x20'+_0x4fb5f5['getHours']()[_0x2c7883(0x118)]()['padStart'](0x2,'0')+':'+_0x4fb5f5[_0x2c7883(0xad)]()[_0x2c7883(0x118)]()[_0x2c7883(0x1ed)](0x2,'0')+':'+_0x4fb5f5[_0x2c7883(0x19a)]()[_0x2c7883(0x118)]()['padStart'](0x2,'0');}function sleep(_0x51cb71){return new Promise(_0x6730fb=>setTimeout(_0x6730fb,_0x51cb71));}