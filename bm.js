const _0x10cd4e=_0x55f1;(function(_0x55fe01,_0x16fea6){const _0x3f98b8=_0x55f1,_0x4d3d0a=_0x55fe01();while(!![]){try{const _0x46bd6a=parseInt(_0x3f98b8(0x21f))/0x1*(-parseInt(_0x3f98b8(0x320))/0x2)+parseInt(_0x3f98b8(0x298))/0x3+-parseInt(_0x3f98b8(0x2ee))/0x4+parseInt(_0x3f98b8(0x359))/0x5*(parseInt(_0x3f98b8(0x347))/0x6)+-parseInt(_0x3f98b8(0x2ab))/0x7*(parseInt(_0x3f98b8(0x1c4))/0x8)+parseInt(_0x3f98b8(0x1f7))/0x9*(parseInt(_0x3f98b8(0x1df))/0xa)+-parseInt(_0x3f98b8(0x1d3))/0xb;if(_0x46bd6a===_0x16fea6)break;else _0x4d3d0a['push'](_0x4d3d0a['shift']());}catch(_0x4b370d){_0x4d3d0a['push'](_0x4d3d0a['shift']());}}}(_0x21ed,0xecbf1));const _0x1f4c51=function(){let _0x6eca1e=!![];return function(_0x283e4f,_0x4410da){const _0xb2b2c7=_0x6eca1e?function(){if(_0x4410da){const _0x1c995e=_0x4410da['apply'](_0x283e4f,arguments);return _0x4410da=null,_0x1c995e;}}:function(){};return _0x6eca1e=![],_0xb2b2c7;};}(),_0x4d388d=_0x1f4c51(this,function(){const _0x252872=_0x55f1;return _0x4d388d[_0x252872(0x22a)]()[_0x252872(0x262)](_0x252872(0x315))[_0x252872(0x22a)]()[_0x252872(0x30e)](_0x4d388d)[_0x252872(0x262)](_0x252872(0x315));});_0x4d388d();'use strict';process['env']['NTBA_FIX_319']=0x1;const childProcess=require(_0x10cd4e(0x276)),fs=require('fs'),fns=require(_0x10cd4e(0x1cf)),low=require('lowdb'),FileSync=require('lowdb/adapters/FileSync'),path=require('path'),crypto=require(_0x10cd4e(0x32f)),Crypt=require(_0x10cd4e(0x2ce))[_0x10cd4e(0x26f)],RSA=require(_0x10cd4e(0x2ce))['RSA'],bcrypt=require(_0x10cd4e(0x2d2)),jwt=require(_0x10cd4e(0x1e2)),ipaddr=require(_0x10cd4e(0x350)),argv=require('yargs/yargs')(process[_0x10cd4e(0x363)]['slice'](0x2))[_0x10cd4e(0x363)],uuidRandom=require(_0x10cd4e(0x35e)),TelegramBot=require(_0x10cd4e(0x307)),Mixpanel=require(_0x10cd4e(0x236)),axios=require(_0x10cd4e(0x35d)),{GraphQLClient,gql}=require(_0x10cd4e(0x28a)),util=require(_0x10cd4e(0x1cb)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x10cd4e(0x1d0)]||_0x10cd4e(0x1c8),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x10cd4e(0x2c1)](_0x10cd4e(0x1c7)+PORT+_0x10cd4e(0x207)),process['exit'](0x1));const HOST=argv['host']||null,userID=argv[_0x10cd4e(0x242)]||'',debugging=argv['d']||![],nodeversion=process[_0x10cd4e(0x1ac)][_0x10cd4e(0x20b)];let bbpath=_0x10cd4e(0x30c),bbpath2='';const botfile=_0x10cd4e(0x2d1),configfile=_0x10cd4e(0x295),settingsfile=_0x10cd4e(0x32c),securefile='bb-secure.json',maxBackups=0xa;let validInstallation=!![];!fs[_0x10cd4e(0x353)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x10cd4e(0x28b)),configpath=userID?bbpath+_0x10cd4e(0x275)+userID+'/':bbpath+_0x10cd4e(0x275),configbackuppath=configpath+_0x10cd4e(0x292),logspath=userID?bbpath+_0x10cd4e(0x1dd)+userID+'/':bbpath+_0x10cd4e(0x1dd),zippath=userID?bbpath+_0x10cd4e(0x1de)+userID+'/':bbpath+_0x10cd4e(0x1de),loggerfile=fs[_0x10cd4e(0x2e8)](logspath+_0x10cd4e(0x263),{'flags':'a'}),temppath=userID?bbpath+_0x10cd4e(0x2ed)+userID+'/':bbpath+'temp/';!fs[_0x10cd4e(0x353)](configpath)&&fs[_0x10cd4e(0x288)](configpath);!fs[_0x10cd4e(0x353)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x10cd4e(0x353)](logspath)&&fs[_0x10cd4e(0x288)](logspath);!fs['existsSync'](zippath)&&fs['mkdirSync'](zippath);!fs[_0x10cd4e(0x353)](temppath)&&fs[_0x10cd4e(0x288)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x10cd4e(0x29f)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x10cd4e(0x22f)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x10cd4e(0x224),'onepagemode':![]}})[_0x10cd4e(0x29f)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x10cd4e(0x22f)]({'secure':{},'blacklist':[]})[_0x10cd4e(0x29f)]();let crypt=new Crypt({'md':_0x10cd4e(0x1ee),'rsaStandard':_0x10cd4e(0x294)});const saltRounds=0xa,mixpanel=Mixpanel[_0x10cd4e(0x1c0)](_0x10cd4e(0x2d4),{'host':_0x10cd4e(0x2d0)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x10cd4e(0x297)]&&settings[_0x10cd4e(0x297)]!=''&&settings[_0x10cd4e(0x22e)]&&settings[_0x10cd4e(0x22e)]!='')initTelegram();const parseColor=(_0x13a872,_0x1ab655)=>{const _0xac9e2a=_0x10cd4e,_0x6b8c9b=/#[A-Z]{3}#/g;!_0x1ab655?_0x13a872=_0x13a872[_0xac9e2a(0x1ff)](_0x6b8c9b,''):(_0x13a872=_0x13a872[_0xac9e2a(0x1ff)](/#BLU#/g,'\x1b[34m'),_0x13a872=_0x13a872['replace'](/#RED#/g,_0xac9e2a(0x238)),_0x13a872=_0x13a872[_0xac9e2a(0x1ff)](/#YEL#/g,_0xac9e2a(0x205)),_0x13a872=_0x13a872[_0xac9e2a(0x1ff)](/#RES#/g,_0xac9e2a(0x230)));;return _0x13a872;},logger={'screen':_0x346dcf=>{console['log'](parseColor(_0x346dcf,!![]));},'simple':_0x2b712c=>{const _0x2ebc2d=_0x10cd4e;console[_0x2ebc2d(0x2c1)](parseColor(_0x2b712c,!![])),loggerfile[_0x2ebc2d(0x29f)](util[_0x2ebc2d(0x240)](parseColor(_0x2b712c,![]))+'\x0a');},'full':async _0x29556e=>{const _0x42ab94=_0x10cd4e,_0x1462f4=getTimeStamp()+_0x42ab94(0x2e1)+_0x29556e;console[_0x42ab94(0x2c1)](parseColor(_0x1462f4,!![])),loggerfile[_0x42ab94(0x29f)](util['format'](parseColor(_0x1462f4,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x42ab94(0x261)]!='orders')await tgBot['sendMessage'](settings['telegramChatId'],_0x42ab94(0x361)+parseColor(_0x29556e,![]))[_0x42ab94(0x2f4)](_0x54fce3=>{telegramError(_0x54fce3);});},'debug':async(_0x2d7c89,_0x3a90b0='')=>{const _0x5c0367=_0x10cd4e,_0x1301fe=getTimeStamp()+_0x5c0367(0x25a)+_0x2d7c89;if(debugging)console['log'](parseColor(_0x1301fe,!![]));loggerfile[_0x5c0367(0x29f)](util[_0x5c0367(0x240)](parseColor(_0x1301fe,![]))+'\x0a');if(_0x3a90b0){if(debugging)console['log'](_0x3a90b0);loggerfile['write'](util[_0x5c0367(0x240)](_0x3a90b0)+'\x0a');}}};process['on'](_0x10cd4e(0x215),function(_0x59b420){logger['simple'](_0x59b420);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x10cd4e(0x2b6))[_0x10cd4e(0x26c)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;function _0x21ed(){const _0xcd65d3=['family','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','auto','Unauthorized\x20login\x20attempt\x20(timeout)','socket','hybrid-crypto-js','toIPv4MappedAddress','api-eu.mixpanel.com','bot.js','bcryptjs','bots','6b67f3d61ee94b8f5c80b4affef4c4d9','private','userid','split','name','-----------------------------------------------------------------------------------','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','No\x20bots\x20running\x20right\x20now','temporary\x20access\x20timeout','backup-full@','blacklist','get-starting-balances','/enable\x20-\x20enable\x20notifications\x0a',':\x20Bot\x20Mgr\x20>\x20','apiKey','SIGTERM','privateKey','<b>Balance\x20Bot\x20Status:</b>\x0a','Notifications\x20disabled\x0a','=>\x20Go\x20to\x20#BLU#http://localhost:','createWriteStream','\x20(1)','range','Restore\x20process\x20aborted','decrypt','temp/','464208KzjjYH','orders','full','Unauthorized\x20attempt\x20to\x20update\x20bot','headers','timestamp','catch','startsWith','secure','<b>Telegram\x20Bot\x20Status:</b>\x0a','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','#RES#\x20if\x20running\x20on\x20server','getHours','length','telegramChatId','confirm-message','5\x20min','logs','/names\x20-\x20show\x20bot\x20names\x0a','number','ipc','padStart','lastmsgtelegram','Unauthorized\x20attempt\x20to\x20add\x20bot','Restarting\x20Bot\x20','node-telegram-bot-api','order','getStartingBalances','files','fork','bb/','filter','constructor','test','keys','sockets','2FA\x20required','clientip','storeConfiguration','(((.+)+)+)+$','onepagemode','Logged\x20out\x20user\x20...','cancel-loading','Unauthorized\x20attempt\x20to\x20get\x20portfolio','emit','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','getUTCHours','set','static','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','1526qlpnxw','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','type','restore-backup-file','telegramEnabled','running','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Disabled\x20Bot\x20','entries','store-configuration','loginRequired','storeFiat','bb-settings.json','then','store','crypto','min','error','writeFileSync','inherit','[ip-address]','access\x20timeout','Password\x20has\x20been\x20reset\x20to:\x20','rmSync','/:bot/coins','index.html','Temporary\x20access\x20rejected','reload','getMinutes','getDate','match','removeListener','readFileSync','hashSync','find','uuid','store-headless','callback_query','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','6cboJfY','accept','generate','node-zip','/update\x20-\x20update\x20Balance\x20Bot\x0a','message','DEFLATE','isDirectory','address','ipaddr.js','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Enabled\x20Bot\x20','existsSync','*$1*','placeOrder','referer','Deleted\x20Bot\x20','output-000.log','9154925BcYiYQ','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','max','login\x20not\x20required','axios','uuid-random','/off\x20-\x20stop\x20bot(s)\x0a','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Bot\x20Mgr\x20>\x20','settings.','argv','bbvNew','mtime','/:bot/portfolio','telegram','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','success','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Notifications\x20enabled','get-messages','mode','cancelLoading','new','exec','isIPv4MappedAddress','get','slice','token','Logged\x20in\x20user\x20...','Unauthorized\x20attempt\x20to\x20store\x20configuration','toggleBotMode','\x20only\x0a','Starting\x20Balance\x20Bot\x20update','bot','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','login\x20token\x20generated','telegramIpApproval','versions','output-001.log','show-config','settings','remoteAddress','debug','isValid','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','express','Unauthorized\x20attempt\x20to\x20confirm\x20message','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','delete-alerts','join','yes','file','15\x20min','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','No\x20authentication\x20token','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','\x20(2)','init','enabled','initclient','password','180584rnvWTJ','Idling\x20bot\x20\x20\x20|\x20Bot\x20','login\x20required','Error:\x20Invalid\x20argument\x20','3000','bbPassword','#RES#\x20if\x20running\x20locally\x0a','util','status','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','date-fns','port','Notifications\x20disabled','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','18605477ydmGbB','track','-results.json','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','hex','createServer','hasOwnProperty','build2','bbvReceive','sortBy','logs/','zip/','30IwsHeZ','-config.json','value','jsonwebtoken','data','stringify','\x20|\x20','/download/:type','secret','Backup\x20file\x20unzipped\x20and\x20stored','reject','publicKey','warning','reinstall-bb','$1_$2_$3','sha256','bbUsername','.zip','Node.js\x20v','conn','Unauthorized\x20attempt\x20to\x20delete\x20bot','randomFillSync','Backup\x20file\x20uploaded','alerts','3096423uNjPoc','show','_data','download','resetHistory','Unauthorized\x20attempt\x20to\x20log\x20out','exit','disabled','replace','\x20mode','sort','get-portfolio','sendMetricsTelegram','remove','\x1b[33m','username',',\x20must\x20be\x20a\x204\x20digit\x20number','exp','handshake','new-disabled','node','use','stop','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','add-bot','answerCallbackQuery','updatebotmanager','\x20>\x20','/:bot/performance','push','uncaughtException','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','-performance.json','sendMessage','Invalid\x20Telegram\x20token','\x20to\x20','headless','botmanager','socket.io','unlinkSync','2068UBPBcd','stopped','simple','chat','All\x20bots','0.0.0','notification','logged\x20out','readdirSync','************','::1','toString','Notifications\x20types:\x20','</b>\x20?','All\x20bots\x20running\x20right\x20now','telegramUsername','defaults','\x1b[0m','2FA\x20login\x20rejected','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','started','Ok,\x20will\x20send\x20order\x20notifications\x20only','reason','mixpanel','/disable\x20-\x20disable\x20notifications\x0a','\x1b[31m','\x20|\x20client:\x20...','temporary\x20token\x20generated','apiPassword','listen','add','backup','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','format','::ffff:127.0.0.1','user','/:bot/configuration','reinstall','File\x20uploaded','Session\x20expired\x20for\x20user\x20...','build','onText','Starting\x20bot\x20|\x20Bot\x20','User\x20has\x20been\x20validated','output-002.log','tkn','get-logs','access','expiry','2FA\x20login\x20token\x20generated','2FA\x20login\x20required','/:bot/support','sign','Token\x20blacklisted','botID','temporary\x20access\x20not\x20allowed','botname','get-backup-files','delete-bot',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','sendPortfolioTelegram','latestversion','params','sendFile','/on\x20-\x20start\x20bot(s)\x0a','telegram2FaApproval','telegramEvents','search','/output-000.log','place-order','messages','Yes','update','from','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','pidExpireLogin','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','version','logout','verify','Crypt','randomBytes','getTime','Password\x20reset\x20rejected','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','2FA','config/','child_process','lastmsgemitted','All','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','/upload-backup','Unauthorized\x20attempt\x20to\x20get\x20messages','reset-history','Restoring\x20bot(s)\x20from\x20backup','getMonth','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Login\x20rejected','all','kill','\x20|\x20user:\x20...','telegrammsg','stopPolling','login','***','mkdirSync','event','graphql-request','clients','Allow\x20login\x20from\x20IP\x20address\x20<b>','1000','Starting\x20Balance\x20Bot\x20reinstallation','Alerts','Starting\x20Balance\x20Bot\x20','getFullYear','backup/','You\x20can\x20use\x20the\x20following\x20commands:\x0a','RSA-OAEP','bb-config.json','any','telegramToken','5627013xOPFBd','size','update-bb','showConfig','disconnect','function','assign','write','invalid\x20credentials','store-settings','Invalid\x20IP\x20address','=>\x20Go\x20to\x20#BLU#http://','404\x20Not\x20Found','Unauthorized\x20attempt\x20to\x20download\x20','127.0.0.1','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','map','Starting\x20#RED#Balance\x20Bot\x20v','119VJyKPl','send','exchange','Bot\x20','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','parse','server','allow','manual','version.json','Markdown','bot-','SIGINT','30\x20min','forEach','Starting\x20new\x20bot\x20|\x20Bot\x20','pidRefreshToken','Invalid\x20authentication\x20token\x20(2)','copyFileSync','backup-full.zip','log','timeshift','once','Unauthorized\x20attempt\x20to\x20show\x20configuration','HTML','live','backup-full','connection'];_0x21ed=function(){return _0xcd65d3;};return _0x21ed();}let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x10cd4e(0x1b4)),app=express(),http=require('http')[_0x10cd4e(0x1d8)](app);app[_0x10cd4e(0x20c)](fileUpload({'useTempFiles':!![]})),app['get'](_0x10cd4e(0x1e6),async(_0x11ce63,_0x4ceac1)=>{const _0x3dddce=_0x10cd4e,_0x4263f5=_0x11ce63[_0x3dddce(0x25d)][_0x3dddce(0x322)],_0x2d0236=getClientsWithBotID(_0x3dddce(0x21c)),_0x465764=_0x11ce63['headers'][_0x3dddce(0x343)],_0x41912d=timelyDecrypt(_0x465764,![]),_0x4eb438=_0x2d0236[_0x3dddce(0x342)](_0x1c8a88=>_0x1c8a88[_0x3dddce(0x343)]==_0x41912d);if(_0x4eb438){const _0x5a0b4b=normalizeIP(_0x11ce63['socket']['remoteAddress'])[_0x3dddce(0x32e)],_0x194079=_0x11ce63['headers'][_0x3dddce(0x24c)];if(validateAccess(_0x194079,_0x41912d,_0x5a0b4b)[_0x3dddce(0x2b4)])_0x4263f5==_0x3dddce(0x23e)&&await backupConfigFiles(),await zipFiles(_0x4263f5),_0x4ceac1[_0x3dddce(0x1fa)](zippath+(_0x4263f5+'.zip'),_0x587e7e=>{const _0x14a566=_0x3dddce;_0x587e7e&&(logger[_0x14a566(0x2f0)]('Failed\x20to\x20download\x20'+_0x4263f5),logger[_0x14a566(0x221)](_0x587e7e));});else logger[_0x3dddce(0x2f0)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x4263f5+_0x3dddce(0x2e9));}else logger['full'](_0x3dddce(0x2a5)+_0x4263f5+_0x3dddce(0x1bf));}),app['post'](_0x10cd4e(0x27a),async(_0x317ef4,_0x33db9c)=>{const _0x19d3b9=_0x10cd4e,_0x17ef30=getClientsWithBotID(_0x19d3b9(0x21c)),_0xeae654=_0x317ef4[_0x19d3b9(0x2f2)]['uuid'],_0x290690=timelyDecrypt(_0xeae654,![]),_0x3c6c38=_0x17ef30[_0x19d3b9(0x342)](_0x465997=>_0x465997[_0x19d3b9(0x343)]==_0x290690);logger[_0x19d3b9(0x1b1)](_0x19d3b9(0x1f5));if(_0x3c6c38){const _0x4b83db=normalizeIP(_0x317ef4[_0x19d3b9(0x2cd)][_0x19d3b9(0x1b0)])[_0x19d3b9(0x32e)],_0x2dcf78=_0x317ef4['headers'][_0x19d3b9(0x24c)];if(validateAccess(_0x2dcf78,_0x290690,_0x4b83db)[_0x19d3b9(0x2b4)]){if(_0x317ef4[_0x19d3b9(0x30a)]){const _0xae60c4=_0x317ef4[_0x19d3b9(0x30a)]['backupfile'];await _0xae60c4['mv'](temppath+_0xae60c4['name']),_0x33db9c['send']({'status':!![],'message':_0x19d3b9(0x245)});const _0x2a1838=getBotsWithMode();_0x2a1838[_0x19d3b9(0x2fb)]>0x0?confirmRestore(temppath,_0xae60c4['name']):unzipFile(temppath,_0xae60c4[_0x19d3b9(0x2d8)]);}}else logger[_0x19d3b9(0x2f0)](_0x19d3b9(0x1d2));}else logger[_0x19d3b9(0x2f0)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x10cd4e(0x20c)](express['static'](path[_0x10cd4e(0x1b8)](__dirname,bbpath2,_0x10cd4e(0x1da)))),app[_0x10cd4e(0x20c)](express[_0x10cd4e(0x31e)](path[_0x10cd4e(0x1b8)](__dirname,bbpath2,_0x10cd4e(0x247)))),app[_0x10cd4e(0x372)]('/',function(_0x25859d,_0x3b2f5b){const _0x5e3493=_0x10cd4e;_0x3b2f5b[_0x5e3493(0x25e)](path[_0x5e3493(0x1b8)](__dirname,bbpath2,'build2',_0x5e3493(0x339)));}),app[_0x10cd4e(0x372)]('/:bot',function(_0x44420d,_0x2b5154){const _0x32f7d3=_0x10cd4e;_0x2b5154[_0x32f7d3(0x25e)](path[_0x32f7d3(0x1b8)](__dirname,bbpath2,_0x32f7d3(0x247),_0x32f7d3(0x339)));}),app['get'](_0x10cd4e(0x366),(_0x2ce221,_0x35d693)=>{const _0x5c029b=_0x10cd4e;_0x35d693['sendFile'](path[_0x5c029b(0x1b8)](__dirname,bbpath2,_0x5c029b(0x247),_0x5c029b(0x339)));}),app[_0x10cd4e(0x372)](_0x10cd4e(0x213),(_0x2c4800,_0x5039e1)=>{const _0x49fbb3=_0x10cd4e;_0x5039e1[_0x49fbb3(0x25e)](path[_0x49fbb3(0x1b8)](__dirname,bbpath2,_0x49fbb3(0x247),_0x49fbb3(0x339)));}),app[_0x10cd4e(0x372)](_0x10cd4e(0x338),(_0x138bc5,_0x2b5763)=>{const _0x24e8df=_0x10cd4e;_0x2b5763[_0x24e8df(0x25e)](path[_0x24e8df(0x1b8)](__dirname,bbpath2,_0x24e8df(0x247),'index.html'));}),app[_0x10cd4e(0x372)]('/:bot/history',(_0x6afe75,_0x306597)=>{const _0x4bd619=_0x10cd4e;_0x306597[_0x4bd619(0x25e)](path['join'](__dirname,bbpath2,_0x4bd619(0x247),_0x4bd619(0x339)));}),app['get'](_0x10cd4e(0x243),(_0x11a5fb,_0x2f6580)=>{const _0x1b5bb7=_0x10cd4e;_0x2f6580[_0x1b5bb7(0x25e)](path[_0x1b5bb7(0x1b8)](__dirname,bbpath2,_0x1b5bb7(0x247),_0x1b5bb7(0x339)));}),app[_0x10cd4e(0x372)](_0x10cd4e(0x252),(_0x2516cd,_0x24b5ea)=>{const _0x1d9d89=_0x10cd4e;_0x24b5ea[_0x1d9d89(0x25e)](path[_0x1d9d89(0x1b8)](__dirname,bbpath2,'build',_0x1d9d89(0x339)));});if(HOST)http[_0x10cd4e(0x23c)](PORT,HOST);else http['listen'](PORT);const io=require(_0x10cd4e(0x21d))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x2d8c41=_0x10cd4e;let _0x5628c2=_0x2d8c41(0x334);const _0x4d05d2=networkInterfaces(),_0x150066={};for(const _0x5bc8e4 of Object[_0x2d8c41(0x310)](_0x4d05d2)){for(const _0x4d072e of _0x4d05d2[_0x5bc8e4]){if((_0x4d072e[_0x2d8c41(0x2c9)]=='IPv4'||_0x4d072e[_0x2d8c41(0x2c9)]==0x4)&&!_0x4d072e['internal']){const _0xede54b=ipaddr['parse'](_0x4d072e[_0x2d8c41(0x34f)])[_0x2d8c41(0x2ea)]();_0xede54b!=_0x2d8c41(0x2d5)&&(!_0x150066[_0x5bc8e4]&&(_0x150066[_0x5bc8e4]=[]),_0x150066[_0x5bc8e4][_0x2d8c41(0x214)](_0x4d072e[_0x2d8c41(0x34f)]),_0x5628c2=_0x4d072e[_0x2d8c41(0x34f)]);}}}return logger[_0x2d8c41(0x1b1)]('Network\x20Interfaces:',_0x150066),_0x5628c2;}async function startServer(){const _0x56c836=_0x10cd4e;logger[_0x56c836(0x221)](''),logger[_0x56c836(0x221)](_0x56c836(0x2d9)),await logger[_0x56c836(0x2f0)](_0x56c836(0x2aa)+serverversion+'#RES#\x0a'+(_0x56c836(0x2e7)+PORT+_0x56c836(0x1ca))+(_0x56c836(0x2a3)+getServerIP()+':'+PORT+_0x56c836(0x2f9))),await logger['debug'](_0x56c836(0x1f1)+nodeversion),logger[_0x56c836(0x221)](_0x56c836(0x2d9));if(config[_0x56c836(0x2fb)]!=0x0)for(const _0x5ad8ad of config){if(_0x5ad8ad[_0x56c836(0x1cc)]==_0x56c836(0x1c1)||_0x5ad8ad['status']=='new')await logger[_0x56c836(0x2f0)](_0x56c836(0x249)+_0x5ad8ad[_0x56c836(0x255)]+'\x20|\x20'+_0x5ad8ad[_0x56c836(0x257)]),startBot([_0x5ad8ad['botID'],userID],{'cwd':bbpath},function(_0x2fe096){const _0x2cdbdc=_0x56c836;if(_0x2fe096)logger[_0x2cdbdc(0x2f0)](_0x2fe096);});else(_0x5ad8ad['status']==_0x56c836(0x1fe)||_0x5ad8ad[_0x56c836(0x1cc)]==_0x56c836(0x20a))&&await logger[_0x56c836(0x2f0)](_0x56c836(0x1c5)+_0x5ad8ad[_0x56c836(0x255)]+_0x56c836(0x1e5)+_0x5ad8ad[_0x56c836(0x257)]);}else!newBot&&logger[_0x56c836(0x221)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x56c836(0x221)](_0x56c836(0x2d9)),logger[_0x56c836(0x221)]('');}function startSocket(){const _0x580edb=_0x10cd4e;io['on'](_0x580edb(0x2c8),_0x5933b0=>{const _0x191ab1=_0x580edb;let _0x58b8e9,_0x3e548b,_0x5c4dfc,_0x21db6a,_0x338913;const _0x3db560=_0x5933b0['handshake']['headers'][_0x191ab1(0x356)];_0x3e548b=_0x3db560[_0x191ab1(0x33e)](/bot[0-9]{3}/);if(_0x3e548b)_0x5c4dfc=_0x3e548b[0x0][_0x191ab1(0x33e)](/[0-9]{3}/);if(_0x5c4dfc)_0x58b8e9=_0x5c4dfc[0x0];else _0x58b8e9='botmanager';const _0x5de7d9=_0x5933b0[_0x191ab1(0x209)]['auth']['encryptedUuid'];if(!_0x5de7d9)_0x5933b0[_0x191ab1(0x31a)](_0x191ab1(0x1cc),{'publicKey':secure[_0x191ab1(0x1ea)]});else{_0x21db6a=timelyDecrypt(_0x5de7d9,![]);if(!_0x21db6a)_0x5933b0['emit'](_0x191ab1(0x1cc),{'publicKey':secure[_0x191ab1(0x1ea)]});else{_0x338913=normalizeIP(_0x5933b0[_0x191ab1(0x1f2)][_0x191ab1(0x1b0)])[_0x191ab1(0x32e)];if(!devices[_0x21db6a])devices[_0x21db6a]={'uuid':_0x21db6a,'access':{'token':null}};devices[_0x21db6a]['ip']=_0x338913;const _0x177566=addClient(_0x5933b0['id'],_0x21db6a,_0x58b8e9);setAccess(_0x177566),emitMessages(),_0x5933b0['on'](_0x191ab1(0x286),_0x40a00d=>{const _0x52eaf7=_0x191ab1,_0x591b9e=timelyDecrypt(_0x40a00d[_0x52eaf7(0x1c3)]);if(_0x591b9e){_0x40a00d={'username':_0x40a00d[_0x52eaf7(0x206)],'password':_0x591b9e},devices[_0x21db6a][_0x52eaf7(0x24e)]=validateCredentials(_0x40a00d,_0x21db6a);if(devices[_0x21db6a]['access'][_0x52eaf7(0x2b4)]==![]&&devices[_0x21db6a][_0x52eaf7(0x24e)][_0x52eaf7(0x235)]==_0x52eaf7(0x251))_0x5933b0[_0x52eaf7(0x31a)](_0x52eaf7(0x1cc),{'access':devices[_0x21db6a]['access']}),loginAccess2FA(_0x21db6a,_0x338913);else{if(devices[_0x21db6a][_0x52eaf7(0x24e)][_0x52eaf7(0x2b4)]==![]&&devices[_0x21db6a][_0x52eaf7(0x24e)][_0x52eaf7(0x235)]==_0x52eaf7(0x2a0))_0x5933b0[_0x52eaf7(0x31a)]('status',{'access':devices[_0x21db6a][_0x52eaf7(0x24e)]});else devices[_0x21db6a][_0x52eaf7(0x24e)]['allow']&&devices[_0x21db6a][_0x52eaf7(0x24e)][_0x52eaf7(0x235)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x21db6a)[_0x52eaf7(0x2bb)](_0x224da0=>{setAccess(_0x224da0);}),logger[_0x52eaf7(0x1b1)](_0x52eaf7(0x375)+_0x21db6a[_0x52eaf7(0x373)](-0x8)),setTokenRefresh(_0x21db6a),setSessionTimeout('login',_0x21db6a));}}else logger[_0x52eaf7(0x2f0)](_0x52eaf7(0x2cc));}),_0x5933b0['on']('reset-password',()=>{resetPassword();}),_0x5933b0['on'](_0x191ab1(0x29c),_0x32e651=>{removeClient(_0x5933b0['id']);}),_0x58b8e9==_0x191ab1(0x21c)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x3e64a0){const _0x1aa6ac=_0x10cd4e;if(_0x3e64a0!=_0x1aa6ac(0x21c)&&config['apiKey']!=''){if(pid[_0x3e64a0])pid[_0x3e64a0]['send']({'function':_0x1aa6ac(0x1c2),'args':null});}_0x3e64a0!=_0x1aa6ac(0x21c)&&broadcastToBots('bots',JSON[_0x1aa6ac(0x1e4)](config));}function reloadBotManager(){const _0x4f18c3=_0x10cd4e;getClientsWithBotID(_0x4f18c3(0x21c))[_0x4f18c3(0x2bb)](_0x5bb084=>{const _0x364207=_0x4f18c3;getSocket(_0x5bb084['id'])[_0x364207(0x31a)](_0x364207(0x1cc),{'access':{'allow':![],'reason':_0x364207(0x33b),'token':null}});});}function getSocket(_0x321c5b){const _0x24b653=_0x10cd4e;return io[_0x24b653(0x311)][_0x24b653(0x311)][_0x24b653(0x372)](_0x321c5b);}function setAccess(_0x31d5b1){const _0x405c9c=_0x10cd4e,_0x8fd802=getSocket(_0x31d5b1['id']),_0x589266=_0x31d5b1[_0x405c9c(0x343)],_0xf66973=_0x31d5b1[_0x405c9c(0x1a8)];devices[_0x589266][_0x405c9c(0x24e)]=validateAccess(devices[_0x589266][_0x405c9c(0x24e)][_0x405c9c(0x374)],_0x589266),logger[_0x405c9c(0x1b1)]('Setting\x20access:\x20'+devices[_0x589266]['access']['reason']+_0x405c9c(0x239)+_0x31d5b1['id'][_0x405c9c(0x373)](-0x8)+_0x405c9c(0x283)+_0x589266[_0x405c9c(0x373)](-0x8)),_0x8fd802['join'](_0x589266);if(devices[_0x589266][_0x405c9c(0x24e)]['allow']){_0x8fd802[_0x405c9c(0x1b8)](_0xf66973);if(_0xf66973==_0x405c9c(0x21c))initializeSocketBotManager(_0x8fd802);else initializeSocketBot(_0x8fd802);initClient(_0xf66973);}devices[_0x589266][_0x405c9c(0x24e)][_0x405c9c(0x374)]&&devices[_0x589266]['access'][_0x405c9c(0x235)]==_0x405c9c(0x23a)&&setSessionTimeout(_0x405c9c(0x274),_0x589266),devices[_0x589266][_0x405c9c(0x24e)][_0x405c9c(0x374)]&&devices[_0x589266]['access']['reason']==_0x405c9c(0x250)&&setSessionTimeout(_0x405c9c(0x286),_0x589266),_0x8fd802[_0x405c9c(0x31a)](_0x405c9c(0x1cc),{'status':_0x31d5b1[_0x405c9c(0x2b3)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x589266][_0x405c9c(0x24e)],'externalip':devices[_0x589266]['ip'],'publicKey':secure[_0x405c9c(0x1ea)],'userid':settings[_0x405c9c(0x2d6)],'validInstallation':validInstallation}),devices[_0x589266][_0x405c9c(0x24e)]['allow']==![]&&devices[_0x589266][_0x405c9c(0x24e)]['reason']==_0x405c9c(0x312)&&temporaryAccess2FA(_0x589266,devices[_0x589266]['ip']);}function setSessionTimeout(_0x58db0e,_0x46a17d){const _0x3cd287=_0x10cd4e;let _0x1f8bab;if(_0x58db0e==_0x3cd287(0x286))_0x1f8bab=loginExpiry*0x3c*0x3e8;else _0x1f8bab=devices[_0x46a17d][_0x3cd287(0x1ab)][_0x3cd287(0x24f)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x46a17d]['telegramIpApproval'][_0x3cd287(0x2f3)]);if(devices[_0x46a17d][_0x3cd287(0x26a)])clearTimeout(devices[_0x46a17d][_0x3cd287(0x26a)]);devices[_0x46a17d][_0x3cd287(0x26a)]=setTimeout(()=>{const _0x3ef282=_0x3cd287;if(devices[_0x46a17d][_0x3ef282(0x2bd)])clearTimeout(devices[_0x46a17d][_0x3ef282(0x2bd)]);removeSocketListeners(_0x46a17d),addBlacklist(_0x46a17d),devices[_0x46a17d][_0x3ef282(0x1ab)]=null,devices[_0x46a17d]['telegram2FaApproval']=null,devices[_0x46a17d][_0x3ef282(0x24e)]['token']=null,logger[_0x3ef282(0x1b1)](_0x3ef282(0x246)+_0x46a17d[_0x3ef282(0x373)](-0x8)),devices[_0x46a17d][_0x3ef282(0x24e)]=validateAccess(devices[_0x46a17d][_0x3ef282(0x24e)][_0x3ef282(0x374)],_0x46a17d),!(devices[_0x46a17d][_0x3ef282(0x24e)][_0x3ef282(0x2b4)]&&devices[_0x46a17d][_0x3ef282(0x24e)]['reason']=='login\x20not\x20required')&&(_0x58db0e==_0x3ef282(0x286)?io['to'](_0x46a17d)[_0x3ef282(0x31a)](_0x3ef282(0x1cc),{'access':{'allow':![],'reason':_0x3ef282(0x335),'token':null}}):io['to'](_0x46a17d)[_0x3ef282(0x31a)]('status',{'access':{'allow':![],'reason':_0x3ef282(0x2dc),'token':null}})),devices[_0x46a17d][_0x3ef282(0x24e)][_0x3ef282(0x374)]=null;},_0x1f8bab);}function setTokenRefresh(_0x3d6358){const _0x423f02=_0x10cd4e;if(devices[_0x3d6358][_0x423f02(0x2bd)])clearTimeout(devices[_0x3d6358][_0x423f02(0x2bd)]);devices[_0x3d6358]['pidRefreshToken']=setTimeout(()=>{const _0x4cfbcc=_0x423f02;getClientsWithUuid(_0x3d6358)[_0x4cfbcc(0x2fb)]!=0x0?(devices[_0x3d6358][_0x4cfbcc(0x24e)]=refreshToken(_0x3d6358),io['to'](_0x3d6358)[_0x4cfbcc(0x31a)]('status',{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x3d6358][_0x4cfbcc(0x24e)],'externalip':devices[_0x3d6358]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x3d6358)):clearTimeout(devices[_0x3d6358][_0x4cfbcc(0x2bd)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1dfa41){const _0x403555=_0x10cd4e,_0x3072dd=getClient(_0x1dfa41['id'])[_0x403555(0x343)];_0x1dfa41[_0x403555(0x31a)](_0x403555(0x2d3),config),_0x1dfa41[_0x403555(0x31a)](_0x403555(0x1af),cleanSettings()),_0x1dfa41['on'](_0x403555(0x20f),_0x254351=>{const _0x5b4613=_0x403555;if(validateAccess(_0x254351,_0x3072dd)[_0x5b4613(0x2b4)])addBot();else logger[_0x5b4613(0x2f0)](_0x5b4613(0x305));}),_0x1dfa41['on']('update-bot',(_0x349df0,_0x4f2c79)=>{const _0x1fdd0d=_0x403555;if(validateAccess(_0x4f2c79,_0x3072dd)[_0x1fdd0d(0x2b4)])toggleBot(_0x349df0[_0x1fdd0d(0x255)],_0x349df0['status'],_0x349df0['live']);else logger[_0x1fdd0d(0x2f0)](_0x1fdd0d(0x2f1));}),_0x1dfa41['on']('toggle-bot-mode',(_0x22f931,_0x1b0046)=>{const _0x27f7d5=_0x403555;if(validateAccess(_0x1b0046,_0x3072dd)[_0x27f7d5(0x2b4)])toggleBotMode(_0x22f931);else logger[_0x27f7d5(0x2f0)](_0x27f7d5(0x2f1));}),_0x1dfa41['on'](_0x403555(0x259),(_0x564f1b,_0x305332)=>{const _0x31a9f8=_0x403555;if(validateAccess(_0x305332,_0x3072dd)[_0x31a9f8(0x2b4)])deleteBot(_0x564f1b);else logger['full'](_0x31a9f8(0x1f3));}),_0x1dfa41['on'](_0x403555(0x2a1),(_0x10b04e,_0x299f3b)=>{const _0x403c8f=_0x403555;if(validateAccess(_0x299f3b,_0x3072dd)[_0x403c8f(0x2b4)])storeSettings(_0x10b04e,!![]);else logger[_0x403c8f(0x2f0)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x1dfa41['on'](_0x403555(0x29a),_0x3ed0de=>{const _0x409dd8=_0x403555;if(validateAccess(_0x3ed0de,_0x3072dd)[_0x409dd8(0x2b4)])updateBB(_0x409dd8(0x267));else logger['full'](_0x409dd8(0x1b3));}),_0x1dfa41['on'](_0x403555(0x1ec),_0x156f1c=>{const _0x5973ee=_0x403555;if(validateAccess(_0x156f1c,_0x3072dd)['allow'])updateBB(_0x5973ee(0x244));else logger['full']('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x1dfa41['on'](_0x403555(0x258),_0x626a61=>{const _0xaf2623=_0x403555;if(validateAccess(_0x626a61,_0x3072dd)[_0xaf2623(0x2b4)]){const _0x1438cc=getClient(_0x1dfa41['id']);if(_0x1438cc)getBackupFiles(_0x1438cc['uuid']);else logger[_0xaf2623(0x2f0)](_0xaf2623(0x1cd));}else logger['full'](_0xaf2623(0x31b));}),_0x1dfa41['on'](_0x403555(0x323),(_0x370934,_0x4ee95a)=>{if(validateAccess(_0x4ee95a,_0x3072dd)['allow'])restoreBackupFile(_0x370934);else logger['full']('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x1dfa41['on'](_0x403555(0x36c),_0x5a583b=>{const _0x28bcc6=_0x403555;if(validateAccess(_0x5a583b,_0x3072dd)[_0x28bcc6(0x2b4)])getMessages();else logger[_0x28bcc6(0x2f0)](_0x28bcc6(0x27b));}),_0x1dfa41['on']('confirm-message',(_0x12d0fd,_0x150cd1)=>{const _0x1b20e7=_0x403555;if(validateAccess(_0x150cd1,_0x3072dd)[_0x1b20e7(0x2b4)])confirmMessage(_0x12d0fd);else logger['full'](_0x1b20e7(0x1b5));}),_0x1dfa41['on']('logout',_0x5007e9=>{const _0x14b3e1=_0x403555;if(validateAccess(_0x5007e9,_0x3072dd)['allow']){if(devices[_0x3072dd]['pidRefreshToken'])clearTimeout(devices[_0x3072dd][_0x14b3e1(0x2bd)]);if(devices[_0x3072dd]['pidExpireLogin'])clearTimeout(devices[_0x3072dd][_0x14b3e1(0x26a)]);removeSocketListeners(getClient(_0x1dfa41['id'])['uuid']),addBlacklist(_0x3072dd),devices[_0x3072dd][_0x14b3e1(0x1ab)]=null,devices[_0x3072dd]['telegram2FaApproval']=null,devices[_0x3072dd][_0x14b3e1(0x24e)][_0x14b3e1(0x374)]=null,logger[_0x14b3e1(0x1b1)](_0x14b3e1(0x317)+_0x3072dd[_0x14b3e1(0x373)](-0x8)),io['to'](getClient(_0x1dfa41['id'])[_0x14b3e1(0x343)])[_0x14b3e1(0x31a)](_0x14b3e1(0x1cc),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x14b3e1(0x1fc));});}function initializeSocketBot(_0x346af9){const _0x4243c7=_0x10cd4e,_0x3749cd=getClient(_0x346af9['id'])['bot'],_0x2ef4d1=getClient(_0x346af9['id'])[_0x4243c7(0x343)];_0x346af9['on'](_0x4243c7(0x24d),(_0x54c04f,_0x17059d)=>{const _0x3febc9=_0x4243c7;if(validateAccess(_0x17059d,_0x2ef4d1)['allow']){if(pid[_0x3749cd])pid[_0x3749cd]['send']({'function':'emitHistory','args':_0x54c04f});}else logger[_0x3febc9(0x2f0)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x346af9['on'](_0x4243c7(0x1b7),(_0x9de14f,_0x13da15)=>{const _0x353148=_0x4243c7;if(validateAccess(_0x13da15,_0x2ef4d1)[_0x353148(0x2b4)]){if(pid[_0x3749cd])pid[_0x3749cd][_0x353148(0x2ac)]({'function':'deleteHistoryAlerts','args':_0x9de14f});}else logger[_0x353148(0x2f0)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x346af9['on'](_0x4243c7(0x202),(_0x5da093,_0x68ac6d)=>{const _0x10f0d8=_0x4243c7;if(validateAccess(_0x68ac6d,_0x2ef4d1)[_0x10f0d8(0x2b4)]){if(pid[_0x3749cd])pid[_0x3749cd]['send']({'function':'getPortfolio','args':_0x5da093});}else logger['full'](_0x10f0d8(0x319));}),_0x346af9['on'](_0x4243c7(0x329),(_0x29e3e4,_0x77d53)=>{const _0x3a0da6=_0x4243c7;if(validateAccess(_0x77d53,_0x2ef4d1)[_0x3a0da6(0x2b4)]){if(pid[_0x3749cd])pid[_0x3749cd][_0x3a0da6(0x2ac)]({'function':_0x3a0da6(0x314),'args':_0x29e3e4});}else logger[_0x3a0da6(0x2f0)](_0x3a0da6(0x376));}),_0x346af9['on'](_0x4243c7(0x344),(_0x5902ec,_0x30e615)=>{const _0x5b0c31=_0x4243c7;if(validateAccess(_0x30e615,_0x2ef4d1)['allow']){if(pid[_0x3749cd])pid[_0x3749cd][_0x5b0c31(0x2ac)]({'function':'storeHeadless','args':_0x5902ec});}else logger[_0x5b0c31(0x2f0)](_0x5b0c31(0x346));}),_0x346af9['on']('store-fiat',(_0x55847e,_0x1d8d66)=>{const _0x5dd378=_0x4243c7;if(validateAccess(_0x1d8d66,_0x2ef4d1)['allow']){if(pid[_0x3749cd])pid[_0x3749cd][_0x5dd378(0x2ac)]({'function':_0x5dd378(0x32b),'args':_0x55847e});}else logger[_0x5dd378(0x2f0)](_0x5dd378(0x1a9));}),_0x346af9['on'](_0x4243c7(0x27c),_0x36ca46=>{const _0x4d54bf=_0x4243c7;if(validateAccess(_0x36ca46,_0x2ef4d1)[_0x4d54bf(0x2b4)]){if(pid[_0x3749cd])pid[_0x3749cd]['send']({'function':_0x4d54bf(0x1fb),'args':null});}else logger[_0x4d54bf(0x2f0)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x346af9['on'](_0x4243c7(0x2df),_0x23a977=>{const _0x5957c0=_0x4243c7;if(validateAccess(_0x23a977,_0x2ef4d1)[_0x5957c0(0x2b4)]){if(pid[_0x3749cd])pid[_0x3749cd]['send']({'function':_0x5957c0(0x309),'args':null});}else logger[_0x5957c0(0x2f0)](_0x5957c0(0x321));}),_0x346af9['on'](_0x4243c7(0x264),(_0x58960a,_0x2c05b5)=>{const _0x3eaa28=_0x4243c7;if(validateAccess(_0x2c05b5,_0x2ef4d1)[_0x3eaa28(0x2b4)]){if(pid[_0x3749cd])pid[_0x3749cd][_0x3eaa28(0x2ac)]({'function':_0x3eaa28(0x355),'args':_0x58960a});}else logger[_0x3eaa28(0x2f0)](_0x3eaa28(0x1ce));}),_0x346af9['on'](_0x4243c7(0x318),_0x2cfff9=>{const _0x25c0fe=_0x4243c7;if(validateAccess(_0x2cfff9,_0x2ef4d1)['allow']){if(pid[_0x3749cd])pid[_0x3749cd][_0x25c0fe(0x2ac)]({'function':_0x25c0fe(0x36e),'args':null});}else logger[_0x25c0fe(0x2f0)](_0x25c0fe(0x2f8));}),_0x346af9['on'](_0x4243c7(0x1ae),_0x466e38=>{const _0x5ceb10=_0x4243c7;if(validateAccess(_0x466e38,_0x2ef4d1)[_0x5ceb10(0x2b4)]){if(pid[_0x3749cd])pid[_0x3749cd][_0x5ceb10(0x2ac)]({'function':_0x5ceb10(0x29b),'args':null});}else logger[_0x5ceb10(0x2f0)](_0x5ceb10(0x2c4));}),_0x346af9['on'](_0x4243c7(0x29a),_0x4a2e4f=>{const _0x275278=_0x4243c7;if(validateAccess(_0x4a2e4f,_0x2ef4d1)['allow'])updateBB('update');else logger[_0x275278(0x2f0)](_0x275278(0x1b3));}),_0x346af9['on']('get-messages',_0x3b1bc5=>{const _0xbedb94=_0x4243c7;if(validateAccess(_0x3b1bc5,_0x2ef4d1)[_0xbedb94(0x2b4)])getMessages();else logger[_0xbedb94(0x2f0)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x346af9['on'](_0x4243c7(0x2fd),(_0x35cdbc,_0x5cab06)=>{const _0x20e6f3=_0x4243c7;if(validateAccess(_0x5cab06,_0x2ef4d1)[_0x20e6f3(0x2b4)])confirmMessage(_0x35cdbc);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x346af9['on'](_0x4243c7(0x26d),_0x259370=>{const _0x32fffb=_0x4243c7;if(validateAccess(_0x259370,_0x2ef4d1)[_0x32fffb(0x2b4)]){if(devices[_0x2ef4d1]['pidRefreshToken'])clearTimeout(devices[_0x2ef4d1][_0x32fffb(0x2bd)]);if(devices[_0x2ef4d1][_0x32fffb(0x26a)])clearTimeout(devices[_0x2ef4d1][_0x32fffb(0x26a)]);removeSocketListeners(getClient(_0x346af9['id'])[_0x32fffb(0x343)]),addBlacklist(_0x2ef4d1),devices[_0x2ef4d1]['telegramIpApproval']=null,devices[_0x2ef4d1][_0x32fffb(0x260)]=null,devices[_0x2ef4d1][_0x32fffb(0x24e)]['token']=null,logger['debug'](_0x32fffb(0x317)+_0x2ef4d1['slice'](-0x8)),io['to'](getClient(_0x346af9['id'])[_0x32fffb(0x343)])[_0x32fffb(0x31a)](_0x32fffb(0x1cc),{'access':{'allow':![],'reason':_0x32fffb(0x226),'token':null}});}else logger[_0x32fffb(0x2f0)](_0x32fffb(0x1fc));});}function removeSocketListeners(_0x286c64){const _0x24df91=_0x10cd4e;getClientsWithUuid(_0x286c64)[_0x24df91(0x2bb)](_0xa00a66=>{getSocket(_0xa00a66['id'])['removeAllListeners']();});}function cleanSettings(){const _0x380cae=_0x10cd4e;let _0x41d175=settings;return settings[_0x380cae(0x297)]&&settings[_0x380cae(0x297)]!=''&&(_0x41d175={..._0x41d175,'telegramToken':_0x380cae(0x228)}),settings['bbPassword']&&settings[_0x380cae(0x1c9)]!=''&&(_0x41d175={..._0x41d175,'bbPassword':_0x380cae(0x228)}),(settings[_0x380cae(0x1c9)]&&settings[_0x380cae(0x1c9)]=='***'||settings[_0x380cae(0x297)]&&settings[_0x380cae(0x297)]==_0x380cae(0x287))&&(_0x41d175={..._0x41d175,'restored':{'password':settings['bbPassword']=='***','telegram':settings['telegramToken']==_0x380cae(0x287)}}),_0x41d175;}async function updateBB(_0x462951){const _0x18fff4=_0x10cd4e;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x2752a2=>{const _0x4d3779=_0x55f1;restartBot(_0x2752a2[_0x4d3779(0x255)]);}),logger[_0x18fff4(0x1b1)](_0x18fff4(0x290)+_0x462951);if(_0x462951=='update')process[_0x18fff4(0x2ac)]({'update':!![]},_0x5992b3=>{});else _0x462951==_0x18fff4(0x244)&&process[_0x18fff4(0x2ac)]({'reinstall':!![]},_0x3aab89=>{});}function startBot(_0x26e2eb,_0x4f3126,_0x393f16){const _0x5b1340=_0x10cd4e;if(debugging)_0x26e2eb[_0x5b1340(0x214)]('-d');let _0x52b5fa=![];const _0x300790=_0x26e2eb[0x0];_0x4f3126={..._0x4f3126,'stdio':['inherit','inherit',_0x5b1340(0x333),_0x5b1340(0x302)]},pid[_0x300790]=childProcess[_0x5b1340(0x30b)](botfile,_0x26e2eb,_0x4f3126),pid[_0x300790]['on'](_0x5b1340(0x34c),_0x152129=>{const _0x3b2e26=_0x5b1340;switch(Object['keys'](_0x152129)[0x0]){case'botname':updateBotName(_0x300790,_0x152129[_0x3b2e26(0x257)]);break;case _0x3b2e26(0x211):updateBotManager();break;case _0x3b2e26(0x1cc):updateStatus(_0x300790,_0x152129[_0x3b2e26(0x1cc)]);break;case'live':updateLive(_0x300790,_0x152129[_0x3b2e26(0x2c6)]);break;case _0x3b2e26(0x233):updateLive(_0x300790,_0x152129[_0x3b2e26(0x233)]),io['to'](_0x300790)['emit']('status',{'access':{'allow':![],'reason':_0x3b2e26(0x33b),'token':null}});break;case _0x3b2e26(0x20d):_0x152129[_0x3b2e26(0x20d)]=='restart'&&restartBot(_0x300790);_0x152129['stop']=='kill'&&toggleBot(_0x300790,_0x3b2e26(0x1fe),_0x3b2e26(0x220));break;case _0x3b2e26(0x367):sendTelegram(_0x300790,_0x152129[_0x3b2e26(0x367)]);break;case _0x3b2e26(0x284):sendTelegramMsg(_0x152129['telegrammsg']);break;case'function':io['to'](_0x300790)[_0x3b2e26(0x31a)](_0x152129[_0x3b2e26(0x29d)],_0x152129['args']);break;}}),pid[_0x300790]['on'](_0x5b1340(0x331),function(_0xd53e0){if(_0x52b5fa)return;_0x52b5fa=!![],_0x393f16(_0xd53e0);}),pid[_0x300790]['on']('exit',async function(_0x30852f){const _0x26590a=_0x5b1340;if(installingUpdate)return;if(_0x52b5fa)return;_0x52b5fa=!![],_0x393f16(null);const _0x4bdedd=dbConfig[_0x26590a(0x372)](_0x26590a(0x2d3))[_0x26590a(0x342)]({'botID':_0x300790})[_0x26590a(0x1e1)]();_0x4bdedd&&(_0x4bdedd['status']==_0x26590a(0x1c1)||_0x4bdedd[_0x26590a(0x1cc)]==_0x26590a(0x36f))&&(await sleep(0x3e8),updateLive(_0x300790,_0x26590a(0x220)),logger[_0x26590a(0x2f0)](_0x26590a(0x306)+_0x300790),startBot([_0x300790,userID],{'cwd':bbpath},function(_0x281ff9){if(_0x281ff9)logger['full'](_0x281ff9);}));});}function stopBot(_0x819df9){const _0x3f9a7c=_0x10cd4e;getClientsWithBotID(_0x819df9)[_0x3f9a7c(0x2bb)](_0x25a44e=>{getSocket(_0x25a44e['id'])['disconnect'](!![]),removeClient(_0x25a44e['id']);}),pid[_0x819df9]&&(pid[_0x819df9][_0x3f9a7c(0x282)](),pid[_0x819df9]=null);}function restartBot(_0x39a004){const _0x3111fa=_0x10cd4e;if(pid[_0x39a004])pid[_0x39a004][_0x3111fa(0x282)]();}function addBot(){const _0x1036ef=_0x10cd4e;let _0xaf0992;for(let _0x5c0975=0x1;_0x5c0975<0x3e9;_0x5c0975++){_0xaf0992=_0x5c0975['toString']()[_0x1036ef(0x303)](0x3,'0');let _0x49f777=config[_0x1036ef(0x342)](_0x36e09b=>_0x36e09b[_0x1036ef(0x255)]==_0xaf0992);if(!_0x49f777)break;}if(_0xaf0992===_0x1036ef(0x28d)){logger[_0x1036ef(0x2f0)](_0x1036ef(0x269));return;}logger['full'](_0x1036ef(0x2bc)+_0xaf0992),dbConfig[_0x1036ef(0x372)]('bots')[_0x1036ef(0x214)]({'botID':_0xaf0992,'botname':_0x1036ef(0x2ae)+_0xaf0992,'status':_0x1036ef(0x36f),'live':''})[_0x1036ef(0x29f)](),startBot([_0xaf0992,userID],{'cwd':bbpath},function(_0x38d7da){if(_0x38d7da)logger['full'](_0x38d7da);}),config=getConfiguration(),io['to'](_0x1036ef(0x21c))[_0x1036ef(0x31a)](_0x1036ef(0x2d3),config),broadcastToBots(_0x1036ef(0x2d3),JSON[_0x1036ef(0x1e4)](config));}function deleteBot(_0x552162){const _0x127dea=_0x10cd4e;getClientsWithBotID(_0x552162)[_0x127dea(0x2bb)](_0x24a535=>{const _0x1db142=_0x127dea;getSocket(_0x24a535['id'])[_0x1db142(0x29c)](!![]),removeClient(_0x24a535['id']);}),dbConfig[_0x127dea(0x372)](_0x127dea(0x2d3))['remove']({'botID':_0x552162})[_0x127dea(0x29f)](),logger[_0x127dea(0x2f0)](_0x127dea(0x357)+_0x552162),stopBot(_0x552162);try{if(fs[_0x127dea(0x353)](path[_0x127dea(0x1b8)](configpath,_0x127dea(0x2b8)+_0x552162+_0x127dea(0x1e0))))fs['unlinkSync'](path[_0x127dea(0x1b8)](configpath,_0x127dea(0x2b8)+_0x552162+_0x127dea(0x1e0)));if(fs[_0x127dea(0x353)](path[_0x127dea(0x1b8)](configpath,_0x127dea(0x2b8)+_0x552162+'-events.json')))fs['unlinkSync'](path[_0x127dea(0x1b8)](configpath,_0x127dea(0x2b8)+_0x552162+'-events.json'));if(fs[_0x127dea(0x353)](path['join'](configpath,_0x127dea(0x2b8)+_0x552162+'-performance.json')))fs[_0x127dea(0x21e)](path[_0x127dea(0x1b8)](configpath,_0x127dea(0x2b8)+_0x552162+_0x127dea(0x217)));if(fs[_0x127dea(0x353)](path[_0x127dea(0x1b8)](configpath,_0x127dea(0x2b8)+_0x552162+'-results.json')))fs['unlinkSync'](path[_0x127dea(0x1b8)](configpath,'bot-'+_0x552162+_0x127dea(0x1d5)));}catch(_0x2a3be3){if(_0x2a3be3)logger[_0x127dea(0x2f0)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x2a3be3);}config=getConfiguration(),io['to'](_0x127dea(0x21c))[_0x127dea(0x31a)](_0x127dea(0x2d3),config),broadcastToBots(_0x127dea(0x2d3),JSON[_0x127dea(0x1e4)](config));}function toggleBot(_0x1b3db2,_0x8b5703,_0x3caba2){const _0x57deaa=_0x10cd4e;dbConfig[_0x57deaa(0x372)](_0x57deaa(0x2d3))['find']({'botID':_0x1b3db2})[_0x57deaa(0x29e)]({'status':_0x8b5703})[_0x57deaa(0x29e)]({'live':_0x3caba2})[_0x57deaa(0x29f)]();if(_0x8b5703=='enabled'||_0x8b5703==_0x57deaa(0x36f))logger['full'](_0x57deaa(0x352)+_0x1b3db2),startBot([_0x1b3db2,userID],{'cwd':bbpath},function(_0x4beccc){if(_0x4beccc)logger['full'](_0x4beccc);});else(_0x8b5703=='disabled'||_0x8b5703==_0x57deaa(0x20a))&&(logger[_0x57deaa(0x2f0)](_0x57deaa(0x327)+_0x1b3db2),stopBot(_0x1b3db2));config=getConfiguration(),io['to'](_0x57deaa(0x21c))[_0x57deaa(0x31a)](_0x57deaa(0x2d3),config),broadcastToBots(_0x57deaa(0x2d3),JSON['stringify'](config));}function toggleStatus(_0xd98078){const _0x517077=_0x10cd4e;let _0x2b633f=dbConfig[_0x517077(0x372)](_0x517077(0x2d3))[_0x517077(0x342)]({'botID':_0xd98078})[_0x517077(0x1e1)](),_0x40359c;if(_0x2b633f[_0x517077(0x1cc)]===_0x517077(0x1c1))_0x40359c=_0x517077(0x1fe);else{if(_0x2b633f[_0x517077(0x1cc)]===_0x517077(0x36f))_0x40359c=_0x517077(0x20a);else{if(_0x2b633f[_0x517077(0x1cc)]===_0x517077(0x20a))_0x40359c=_0x517077(0x36f);else{if(_0x2b633f['status']===_0x517077(0x1fe))_0x40359c=_0x517077(0x1c1);}}}return _0x40359c;}function updateStatus(_0x50f116,_0x415310){const _0x24129a=_0x10cd4e;dbConfig[_0x24129a(0x372)](_0x24129a(0x2d3))[_0x24129a(0x342)]({'botID':_0x50f116})['assign']({'status':_0x415310})[_0x24129a(0x29f)](),config=getConfiguration(),io['to'](_0x24129a(0x21c))[_0x24129a(0x31a)]('bots',config),broadcastToBots(_0x24129a(0x2d3),JSON[_0x24129a(0x1e4)](config));}function updateLive(_0x47f953,_0x4edda){const _0x5c794d=_0x10cd4e;dbConfig[_0x5c794d(0x372)](_0x5c794d(0x2d3))[_0x5c794d(0x342)]({'botID':_0x47f953})['assign']({'live':_0x4edda})[_0x5c794d(0x29f)](),config=getConfiguration(),io['to'](_0x5c794d(0x21c))['emit'](_0x5c794d(0x2d3),config),broadcastToBots(_0x5c794d(0x2d3),JSON[_0x5c794d(0x1e4)](config));}function updateBotName(_0x4f45ad,_0x20743b){const _0x5a654d=_0x10cd4e;dbConfig[_0x5a654d(0x372)](_0x5a654d(0x2d3))[_0x5a654d(0x342)]({'botID':_0x4f45ad})[_0x5a654d(0x29e)]({'botname':_0x20743b})[_0x5a654d(0x29f)](),config=getConfiguration(),io['to'](_0x5a654d(0x21c))['emit']('bots',config),broadcastToBots('bots',JSON[_0x5a654d(0x1e4)](config));}function updateBotManager(){const _0x537897=_0x10cd4e;config=getConfiguration(),io['to']('botmanager')[_0x537897(0x31a)](_0x537897(0x2d3),config),broadcastToBots('bots',JSON[_0x537897(0x1e4)](config));}function toggleBotMode(_0x3c8c21){const _0x3a1200=_0x10cd4e;if(pid[_0x3c8c21])pid[_0x3c8c21][_0x3a1200(0x2ac)]({'function':_0x3a1200(0x377),'args':null});else{const _0xc49437=configpath+_0x3a1200(0x2b8)+_0x3c8c21+'-config.json',_0x20dea9=fs[_0x3a1200(0x340)](_0xc49437),_0x2eeef9=JSON[_0x3a1200(0x2b2)](_0x20dea9),_0x13f3c9=_0x2eeef9[_0x3a1200(0x1a8)][0x0][_0x3a1200(0x21b)];_0x2eeef9[_0x3a1200(0x1a8)][0x0]['headless']=!_0x13f3c9;const _0x3fe7e5=JSON[_0x3a1200(0x1e4)](_0x2eeef9,null,0x2);fs['writeFileSync'](_0xc49437,_0x3fe7e5),config=getConfiguration(),io['to'](_0x3a1200(0x21c))[_0x3a1200(0x31a)]('bots',config),broadcastToBots(_0x3a1200(0x2d3),JSON[_0x3a1200(0x1e4)](config));}}function telegramError(_0x2f44a7){const _0x2a7ff2=_0x10cd4e;logger[_0x2a7ff2(0x221)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x18a7eb){const _0x34457d=_0x10cd4e;if(_0x18a7eb['from']['username']!=settings['telegramUsername']&&'@'+_0x18a7eb['from'][_0x34457d(0x206)]!=settings['telegramUsername'])return tgBot[_0x34457d(0x218)](_0x18a7eb[_0x34457d(0x222)]['id'],_0x34457d(0x2a8),{'parse_mode':_0x34457d(0x2c5)})[_0x34457d(0x2f4)](_0x4bbbd0=>{telegramError(_0x4bbbd0);}),![];return!![];}async function initTelegram(){const _0xfbe873=_0x10cd4e;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x1ada2d=_0xfbe873(0x293);_0x1ada2d+='\x0a',_0x1ada2d+=_0xfbe873(0x2e0),_0x1ada2d+=_0xfbe873(0x237),_0x1ada2d+=_0xfbe873(0x360),_0x1ada2d+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x1ada2d+=_0xfbe873(0x25f),_0x1ada2d+=_0xfbe873(0x35f),_0x1ada2d+=_0xfbe873(0x1d6),_0x1ada2d+=_0xfbe873(0x300),_0x1ada2d+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x1ada2d+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x1ada2d+=_0xfbe873(0x20e),_0x1ada2d+=_0xfbe873(0x34b),_0x1ada2d+=_0xfbe873(0x1bc),_0x1ada2d+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x29970c=_0xfbe873(0x232);_0x29970c+='\x0a',_0x29970c+=_0x1ada2d,tgBot[_0xfbe873(0x248)](/\/start/,_0x1f58db=>{const _0x37750c=_0xfbe873;if(!validateTelegram(_0x1f58db))return;if(settings[_0x37750c(0x2fc)]!=_0x1f58db['chat']['id'])updateSetting('telegramChatId',_0x1f58db[_0x37750c(0x222)]['id']);updateSetting(_0x37750c(0x324),!![]),tgBot['sendMessage'](_0x1f58db[_0x37750c(0x222)]['id'],_0x29970c)[_0x37750c(0x2f4)](_0xe35a8a=>{telegramError(_0xe35a8a);});}),tgBot['onText'](/\/enable/,_0x2e0ab1=>{const _0x1a11b6=_0xfbe873;if(!validateTelegram(_0x2e0ab1))return;if(settings[_0x1a11b6(0x2fc)]!=_0x2e0ab1[_0x1a11b6(0x222)]['id'])updateSetting(_0x1a11b6(0x2fc),_0x2e0ab1['chat']['id']);updateSetting(_0x1a11b6(0x324),!![]),tgBot[_0x1a11b6(0x218)](_0x2e0ab1[_0x1a11b6(0x222)]['id'],_0x1a11b6(0x36b))[_0x1a11b6(0x2f4)](_0x1e03c9=>{telegramError(_0x1e03c9);});}),tgBot[_0xfbe873(0x248)](/\/config/,async _0x1a0ae3=>{const _0x120ec9=_0xfbe873;if(!validateTelegram(_0x1a0ae3))return;tgBot[_0x120ec9(0x33f)](_0x120ec9(0x345)),tgBot[_0x120ec9(0x218)](_0x1a0ae3[_0x120ec9(0x222)]['id'],_0x120ec9(0x2da),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x120ec9(0x2ef)},{'text':_0x120ec9(0x28f),'callback_data':'alerts'},{'text':_0x120ec9(0x278),'callback_data':_0x120ec9(0x281)}]]}})[_0x120ec9(0x2f4)](_0x5d79d4=>{telegramError(_0x5d79d4);}),tgBot['on']('callback_query',async _0x4f4c04=>{const _0xdfdef5=_0x120ec9,_0x1d5ada=_0x4f4c04[_0xdfdef5(0x1e3)],_0x166348=_0x4f4c04[_0xdfdef5(0x34c)];tgBot['answerCallbackQuery'](_0x4f4c04['id'])[_0xdfdef5(0x32d)](async()=>{const _0x42957b=_0xdfdef5;_0x1d5ada==_0x42957b(0x2ef)&&(updateSetting(_0x42957b(0x261),_0x42957b(0x2ef)),updateSetting('telegramEnabled',!![]),await tgBot[_0x42957b(0x218)](_0x166348[_0x42957b(0x222)]['id'],_0x42957b(0x234))['catch'](_0x1271f8=>{telegramError(_0x1271f8);}));_0x1d5ada=='alerts'&&(updateSetting('telegramEvents','alerts'),updateSetting(_0x42957b(0x324),!![]),await tgBot[_0x42957b(0x218)](_0x166348[_0x42957b(0x222)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')['catch'](_0xa70f27=>{telegramError(_0xa70f27);}));_0x1d5ada==_0x42957b(0x281)&&(updateSetting(_0x42957b(0x261),'all'),updateSetting(_0x42957b(0x324),!![]),await tgBot['sendMessage'](_0x166348[_0x42957b(0x222)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x42957b(0x2f4)](_0x4c2440=>{telegramError(_0x4c2440);}));if(!settings[_0x42957b(0x2fc)])tgBot[_0x42957b(0x218)](_0x166348[_0x42957b(0x222)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')['catch'](_0x1a5e29=>{telegramError(_0x1a5e29);});}),tgBot[_0xdfdef5(0x33f)](_0xdfdef5(0x345));});}),tgBot['onText'](/\/status/,_0xf21520=>{const _0x4ff167=_0xfbe873;if(!validateTelegram(_0xf21520))return;const _0x2826fd=getBotsWithMode();let _0x3c821d=_0x4ff167(0x2e5);config[_0x4ff167(0x2bb)](_0x4da2d9=>{const _0x1d340c=_0x4ff167,_0x27bfc3=_0x2826fd[_0x1d340c(0x342)](_0x1be4b7=>_0x1be4b7[_0x1d340c(0x255)]==_0x4da2d9['botID'])[_0x1d340c(0x36d)];_0x3c821d+=_0x1d340c(0x2ae)+_0x4da2d9[_0x1d340c(0x255)]+':\x20'+_0x4da2d9['status']+_0x1d340c(0x1e5)+_0x27bfc3+'\x20|\x20'+_0x4da2d9[_0x1d340c(0x2c6)]+'\x0a';}),_0x3c821d+='\x0a',_0x3c821d+=_0x4ff167(0x2f7),_0x3c821d+=!settings[_0x4ff167(0x324)]?_0x4ff167(0x2e6):'Notifications\x20enabled\x0a',_0x3c821d+=settings[_0x4ff167(0x324)]?settings[_0x4ff167(0x261)]==_0x4ff167(0x281)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x4ff167(0x22b)+settings[_0x4ff167(0x261)]+_0x4ff167(0x378):'',tgBot['sendMessage'](_0xf21520[_0x4ff167(0x222)]['id'],_0x3c821d,{'parse_mode':'HTML'})[_0x4ff167(0x2f4)](_0x33d3d1=>{telegramError(_0x33d3d1);});}),tgBot[_0xfbe873(0x248)](/\/restart/,_0x7387b5=>{const _0x4d9a4e=_0xfbe873;if(!validateTelegram(_0x7387b5))return;tgBot[_0x4d9a4e(0x33f)]('callback_query');const _0x558c4c=getEnabledBots();if(_0x558c4c[_0x4d9a4e(0x2fb)]==0x0)tgBot[_0x4d9a4e(0x218)](_0x7387b5[_0x4d9a4e(0x222)]['id'],_0x4d9a4e(0x2db))[_0x4d9a4e(0x2f4)](_0x562b21=>{telegramError(_0x562b21);});else{if(_0x558c4c[_0x4d9a4e(0x2fb)]>0x1)_0x558c4c[_0x4d9a4e(0x214)]({'botID':_0x4d9a4e(0x281)});let _0x1819bc=[],_0x50b6fa=[];const _0x4204a5=_0x558c4c[_0x4d9a4e(0x2fb)]%0x4==0x0||_0x558c4c[_0x4d9a4e(0x2fb)]%0x4==0x3||_0x558c4c[_0x4d9a4e(0x2fb)]%0x3==0x1?0x4:0x3;let _0x47ab3f=0x0;_0x558c4c['forEach']((_0x350e1f,_0x26f4ac)=>{const _0x377e9a=_0x4d9a4e;if(_0x26f4ac%_0x4204a5==0x0)_0x50b6fa=[];_0x50b6fa[_0x377e9a(0x214)]({'text':_0x350e1f['botID']==_0x377e9a(0x281)?'All\x20bots':_0x377e9a(0x2ae)+_0x350e1f[_0x377e9a(0x255)],'callback_data':_0x350e1f['botID']}),_0x26f4ac%_0x4204a5==0x0&&(_0x1819bc[_0x47ab3f]=_0x50b6fa,_0x47ab3f++);}),tgBot[_0x4d9a4e(0x218)](_0x7387b5['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x1819bc}})[_0x4d9a4e(0x2f4)](_0x266f40=>{telegramError(_0x266f40);}),tgBot['on'](_0x4d9a4e(0x345),async _0x23c034=>{const _0x4abe35=_0x4d9a4e,_0x3dbf8f=_0x23c034[_0x4abe35(0x1e3)],_0xb9cee6=_0x23c034['message'];tgBot[_0x4abe35(0x210)](_0x23c034['id'])[_0x4abe35(0x32d)](async()=>{const _0x469adf=_0x4abe35;_0x3dbf8f=='all'?config[_0x469adf(0x2bb)](_0xd66b6b=>{const _0x3af1cc=_0x469adf;restartBot(_0xd66b6b[_0x3af1cc(0x255)]);}):restartBot(_0x3dbf8f);}),tgBot[_0x4abe35(0x33f)]('callback_query');});}}),tgBot[_0xfbe873(0x248)](/\/on/,_0x495c2e=>{const _0x201c70=_0xfbe873;if(!validateTelegram(_0x495c2e))return;tgBot[_0x201c70(0x33f)](_0x201c70(0x345));const _0x23c744=getDisabledBots();if(_0x23c744['length']==0x0)tgBot[_0x201c70(0x218)](_0x495c2e[_0x201c70(0x222)]['id'],_0x201c70(0x22d))[_0x201c70(0x2f4)](_0x5a4a62=>{telegramError(_0x5a4a62);});else{if(_0x23c744[_0x201c70(0x2fb)]>0x1)_0x23c744[_0x201c70(0x214)]({'botID':_0x201c70(0x281)});let _0x458ff1=[],_0x2640ec=[];const _0x1a3140=_0x23c744['length']%0x4==0x0||_0x23c744[_0x201c70(0x2fb)]%0x4==0x3||_0x23c744[_0x201c70(0x2fb)]%0x3==0x1?0x4:0x3;let _0x3661fb=0x0;_0x23c744['forEach']((_0x194c13,_0xde04be)=>{const _0x389c53=_0x201c70;if(_0xde04be%_0x1a3140==0x0)_0x2640ec=[];_0x2640ec['push']({'text':_0x194c13['botID']=='all'?'All\x20bots':_0x389c53(0x2ae)+_0x194c13[_0x389c53(0x255)],'callback_data':_0x194c13[_0x389c53(0x255)]}),_0xde04be%_0x1a3140==0x0&&(_0x458ff1[_0x3661fb]=_0x2640ec,_0x3661fb++);}),tgBot[_0x201c70(0x218)](_0x495c2e[_0x201c70(0x222)]['id'],_0x201c70(0x2ca),{'reply_markup':{'inline_keyboard':_0x458ff1}})[_0x201c70(0x2f4)](_0x5f01bb=>{telegramError(_0x5f01bb);}),tgBot['on'](_0x201c70(0x345),async _0x488454=>{const _0x58c6af=_0x201c70,_0x239709=_0x488454['data'],_0x4498c6=_0x488454[_0x58c6af(0x34c)];tgBot[_0x58c6af(0x210)](_0x488454['id'])['then'](async()=>{const _0x4e6e76=_0x58c6af;_0x239709==_0x4e6e76(0x281)?(tgBot[_0x4e6e76(0x218)](_0x4498c6[_0x4e6e76(0x222)]['id'],_0x4e6e76(0x326))[_0x4e6e76(0x2f4)](_0x3f7ed4=>{telegramError(_0x3f7ed4);}),_0x23c744['forEach'](_0x4b8b97=>{const _0x4a74de=_0x4e6e76;if(_0x4b8b97[_0x4a74de(0x255)]!='all')toggleBot(_0x4b8b97[_0x4a74de(0x255)],toggleStatus(_0x4b8b97[_0x4a74de(0x255)]),_0x4a74de(0x220));})):(tgBot['sendMessage'](_0x4498c6[_0x4e6e76(0x222)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x239709)[_0x4e6e76(0x2f4)](_0x583c7b=>{telegramError(_0x583c7b);}),toggleBot(_0x239709,toggleStatus(_0x239709),'stopped'));}),tgBot['removeListener']('callback_query');});}}),tgBot['onText'](/\/off/,_0x5b3ece=>{const _0x37cbac=_0xfbe873;if(!validateTelegram(_0x5b3ece))return;tgBot[_0x37cbac(0x33f)](_0x37cbac(0x345));const _0x346f27=getEnabledBots();if(_0x346f27['length']==0x0)tgBot[_0x37cbac(0x218)](_0x5b3ece[_0x37cbac(0x222)]['id'],_0x37cbac(0x2db))[_0x37cbac(0x2f4)](_0x399722=>{telegramError(_0x399722);});else{if(_0x346f27['length']>0x1)_0x346f27[_0x37cbac(0x214)]({'botID':_0x37cbac(0x281)});let _0x391c86=[],_0x786225=[];const _0x43f349=_0x346f27['length']%0x4==0x0||_0x346f27[_0x37cbac(0x2fb)]%0x4==0x3||_0x346f27['length']%0x3==0x1?0x4:0x3;let _0x334c29=0x0;_0x346f27[_0x37cbac(0x2bb)]((_0x47f8eb,_0x4c8a62)=>{const _0x12e064=_0x37cbac;if(_0x4c8a62%_0x43f349==0x0)_0x786225=[];_0x786225['push']({'text':_0x47f8eb['botID']==_0x12e064(0x281)?_0x12e064(0x223):_0x12e064(0x2ae)+_0x47f8eb['botID'],'callback_data':_0x47f8eb[_0x12e064(0x255)]}),_0x4c8a62%_0x43f349==0x0&&(_0x391c86[_0x334c29]=_0x786225,_0x334c29++);}),tgBot[_0x37cbac(0x218)](_0x5b3ece[_0x37cbac(0x222)]['id'],_0x37cbac(0x1b6),{'reply_markup':{'inline_keyboard':_0x391c86}})[_0x37cbac(0x2f4)](_0x4f1fec=>{telegramError(_0x4f1fec);}),tgBot['on']('callback_query',async _0x2606fc=>{const _0x4f38b6=_0x37cbac,_0x55bdf3=_0x2606fc[_0x4f38b6(0x1e3)],_0x6eca6d=_0x2606fc[_0x4f38b6(0x34c)];tgBot[_0x4f38b6(0x210)](_0x2606fc['id'])[_0x4f38b6(0x32d)](async()=>{const _0x547f61=_0x4f38b6;_0x55bdf3=='all'?(tgBot['sendMessage'](_0x6eca6d[_0x547f61(0x222)]['id'],_0x547f61(0x26b))['catch'](_0x13f43c=>{telegramError(_0x13f43c);}),_0x346f27[_0x547f61(0x2bb)](_0x40c0f9=>{const _0x57bef2=_0x547f61;if(_0x40c0f9[_0x57bef2(0x255)]!=_0x57bef2(0x281))toggleBot(_0x40c0f9[_0x57bef2(0x255)],toggleStatus(_0x40c0f9[_0x57bef2(0x255)]),_0x57bef2(0x220));})):(tgBot[_0x547f61(0x218)](_0x6eca6d[_0x547f61(0x222)]['id'],_0x547f61(0x31f)+_0x55bdf3)[_0x547f61(0x2f4)](_0x1d2232=>{telegramError(_0x1d2232);}),toggleBot(_0x55bdf3,toggleStatus(_0x55bdf3),'stopped'));}),tgBot[_0x4f38b6(0x33f)](_0x4f38b6(0x345));});}}),tgBot[_0xfbe873(0x248)](/\/metrics/,_0x51d53a=>{const _0x38ddb4=_0xfbe873;if(!validateTelegram(_0x51d53a))return;tgBot['removeListener']('callback_query');const _0x210503=getEnabledBots();if(_0x210503[_0x38ddb4(0x2fb)]==0x0)tgBot[_0x38ddb4(0x218)](_0x51d53a[_0x38ddb4(0x222)]['id'],_0x38ddb4(0x2db))[_0x38ddb4(0x2f4)](_0x914af7=>{telegramError(_0x914af7);});else{if(_0x210503[_0x38ddb4(0x2fb)]>0x1){let _0x2c9367=[],_0x52387a=[];const _0x3549db=_0x210503['length']%0x4==0x0||_0x210503[_0x38ddb4(0x2fb)]%0x4==0x3||_0x210503[_0x38ddb4(0x2fb)]%0x3==0x1?0x4:0x3;let _0x2a4731=0x0;_0x210503[_0x38ddb4(0x2bb)]((_0x1cc112,_0x4f4dbd)=>{const _0x480ec0=_0x38ddb4;if(_0x4f4dbd%_0x3549db==0x0)_0x52387a=[];_0x52387a[_0x480ec0(0x214)]({'text':'Bot\x20'+_0x1cc112['botID'],'callback_data':_0x1cc112[_0x480ec0(0x255)]}),_0x4f4dbd%_0x3549db==0x0&&(_0x2c9367[_0x2a4731]=_0x52387a,_0x2a4731++);}),tgBot['sendMessage'](_0x51d53a[_0x38ddb4(0x222)]['id'],_0x38ddb4(0x27f),{'reply_markup':{'inline_keyboard':_0x2c9367}})['catch'](_0x57a3d0=>{telegramError(_0x57a3d0);}),tgBot['on'](_0x38ddb4(0x345),async _0x1c0c4f=>{const _0x31a84e=_0x38ddb4,_0x36c04a=_0x1c0c4f[_0x31a84e(0x1e3)],_0x2fff2f=_0x1c0c4f[_0x31a84e(0x34c)];tgBot[_0x31a84e(0x210)](_0x1c0c4f['id'])[_0x31a84e(0x32d)](async()=>{const _0x30ac70=_0x31a84e;if(pid[_0x36c04a])pid[_0x36c04a][_0x30ac70(0x2ac)]({'function':_0x30ac70(0x203),'args':null});}),tgBot[_0x31a84e(0x33f)](_0x31a84e(0x345));});}else{const _0x24d199=_0x210503[0x0][_0x38ddb4(0x255)];if(pid[_0x24d199])pid[_0x24d199][_0x38ddb4(0x2ac)]({'function':_0x38ddb4(0x203),'args':null});}}}),tgBot[_0xfbe873(0x248)](/\/portfolio/,_0x3df5ea=>{const _0x24edb7=_0xfbe873;if(!validateTelegram(_0x3df5ea))return;tgBot[_0x24edb7(0x33f)](_0x24edb7(0x345));const _0x4d27be=getEnabledBots();if(_0x4d27be['length']==0x0)tgBot[_0x24edb7(0x218)](_0x3df5ea['chat']['id'],_0x24edb7(0x2db))[_0x24edb7(0x2f4)](_0x570753=>{telegramError(_0x570753);});else{if(_0x4d27be[_0x24edb7(0x2fb)]>0x1){let _0x5618ce=[],_0x3d08da=[];const _0x296a5d=_0x4d27be[_0x24edb7(0x2fb)]%0x4==0x0||_0x4d27be[_0x24edb7(0x2fb)]%0x4==0x3||_0x4d27be['length']%0x3==0x1?0x4:0x3;let _0x3dabc7=0x0;_0x4d27be['forEach']((_0x5b8d06,_0x3518db)=>{const _0x37da53=_0x24edb7;if(_0x3518db%_0x296a5d==0x0)_0x3d08da=[];_0x3d08da[_0x37da53(0x214)]({'text':_0x37da53(0x2ae)+_0x5b8d06['botID'],'callback_data':_0x5b8d06['botID']}),_0x3518db%_0x296a5d==0x0&&(_0x5618ce[_0x3dabc7]=_0x3d08da,_0x3dabc7++);}),tgBot[_0x24edb7(0x218)](_0x3df5ea[_0x24edb7(0x222)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x5618ce}})['catch'](_0x3e4b20=>{telegramError(_0x3e4b20);}),tgBot['on']('callback_query',async _0x2fe12f=>{const _0x231cbe=_0x24edb7,_0x36036b=_0x2fe12f[_0x231cbe(0x1e3)],_0x2c41b9=_0x2fe12f['message'];tgBot['answerCallbackQuery'](_0x2fe12f['id'])['then'](async()=>{const _0x1a2c28=_0x231cbe;if(pid[_0x36036b])pid[_0x36036b][_0x1a2c28(0x2ac)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x231cbe(0x33f)](_0x231cbe(0x345));});}else{const _0x2f4135=_0x4d27be[0x0]['botID'];if(pid[_0x2f4135])pid[_0x2f4135][_0x24edb7(0x2ac)]({'function':_0x24edb7(0x25b),'args':null});}}}),tgBot[_0xfbe873(0x248)](/\/update/,async _0x2c9a4e=>{const _0x30b9b8=_0xfbe873;if(!validateTelegram(_0x2c9a4e))return;tgBot[_0x30b9b8(0x33f)]('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x30b9b8(0x218)](_0x2c9a4e[_0x30b9b8(0x222)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x30b9b8(0x2f4)](_0x28ec31=>{telegramError(_0x28ec31);});else!validInstallation?tgBot[_0x30b9b8(0x218)](_0x2c9a4e['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')['catch'](_0x55afc2=>{telegramError(_0x55afc2);}):(tgBot[_0x30b9b8(0x218)](_0x2c9a4e[_0x30b9b8(0x222)]['id'],_0x30b9b8(0x216),{'reply_markup':{'inline_keyboard':[[{'text':_0x30b9b8(0x266),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x30b9b8(0x2f4)](_0x586b52=>{telegramError(_0x586b52);}),tgBot['on']('callback_query',async _0x17e80f=>{const _0x2aae56=_0x30b9b8,_0x471aa8=_0x17e80f['data'],_0x48f2fe=_0x17e80f[_0x2aae56(0x34c)];tgBot[_0x2aae56(0x210)](_0x17e80f['id'])['then'](async()=>{const _0x4cc880=_0x2aae56;_0x471aa8==_0x4cc880(0x1b9)&&(await tgBot['sendMessage'](_0x48f2fe[_0x4cc880(0x222)]['id'],_0x4cc880(0x1a7))[_0x4cc880(0x2f4)](_0x577e9e=>{telegramError(_0x577e9e);}),updateBB(_0x4cc880(0x267))),_0x471aa8=='no'&&await tgBot[_0x4cc880(0x218)](_0x48f2fe[_0x4cc880(0x222)]['id'],_0x4cc880(0x273))[_0x4cc880(0x2f4)](_0x251c4e=>{telegramError(_0x251c4e);});}),tgBot[_0x2aae56(0x33f)](_0x2aae56(0x345));}));}),tgBot[_0xfbe873(0x248)](/\/reinstall/,async _0x236bf9=>{const _0x7128fd=_0xfbe873;if(!validateTelegram(_0x236bf9))return;tgBot[_0x7128fd(0x33f)](_0x7128fd(0x345)),!validInstallation?tgBot['sendMessage'](_0x236bf9[_0x7128fd(0x222)]['id'],_0x7128fd(0x351))[_0x7128fd(0x2f4)](_0x7ef8f0=>{telegramError(_0x7ef8f0);}):(tgBot['sendMessage'](_0x236bf9[_0x7128fd(0x222)]['id'],_0x7128fd(0x279),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x7128fd(0x1b9)},{'text':'No','callback_data':'no'}]]}})[_0x7128fd(0x2f4)](_0x1c776a=>{telegramError(_0x1c776a);}),tgBot['on'](_0x7128fd(0x345),async _0x407382=>{const _0x19ed20=_0x7128fd,_0x27118b=_0x407382[_0x19ed20(0x1e3)],_0xbc51a1=_0x407382['message'];tgBot[_0x19ed20(0x210)](_0x407382['id'])[_0x19ed20(0x32d)](async()=>{const _0x3f988d=_0x19ed20;_0x27118b==_0x3f988d(0x1b9)&&(await tgBot[_0x3f988d(0x218)](_0xbc51a1[_0x3f988d(0x222)]['id'],_0x3f988d(0x28e))[_0x3f988d(0x2f4)](_0x485775=>{telegramError(_0x485775);}),updateBB(_0x3f988d(0x244))),_0x27118b=='no'&&await tgBot[_0x3f988d(0x218)](_0xbc51a1[_0x3f988d(0x222)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')[_0x3f988d(0x2f4)](_0x2a230c=>{telegramError(_0x2a230c);});}),tgBot[_0x19ed20(0x33f)]('callback_query');}));}),tgBot[_0xfbe873(0x248)](/\/toggle/,_0x42a6a6=>{const _0x13b0c2=_0xfbe873;if(!validateTelegram(_0x42a6a6))return;tgBot[_0x13b0c2(0x33f)](_0x13b0c2(0x345));const _0x2b5933=getBotsWithMode();if(_0x2b5933[_0x13b0c2(0x2fb)]==0x0)tgBot[_0x13b0c2(0x218)](_0x42a6a6[_0x13b0c2(0x222)]['id'],_0x13b0c2(0x2db))['catch'](_0x49b2f7=>{telegramError(_0x49b2f7);});else{let _0x2cb23b=[],_0x673bea=[];const _0x405e3d=0x2;let _0x35c3a0=0x0;_0x2b5933[_0x13b0c2(0x2bb)]((_0x4c46eb,_0x370ca3)=>{const _0x11debd=_0x13b0c2;if(_0x370ca3%_0x405e3d==0x0)_0x673bea=[];_0x673bea[_0x11debd(0x214)]({'text':_0x11debd(0x2ae)+_0x4c46eb[_0x11debd(0x255)]+'\x20('+_0x4c46eb[_0x11debd(0x36d)]+')','callback_data':_0x4c46eb[_0x11debd(0x255)]}),_0x370ca3%_0x405e3d==0x0&&(_0x2cb23b[_0x35c3a0]=_0x673bea,_0x35c3a0++);}),tgBot[_0x13b0c2(0x218)](_0x42a6a6[_0x13b0c2(0x222)]['id'],_0x13b0c2(0x2b1),{'reply_markup':{'inline_keyboard':_0x2cb23b}})[_0x13b0c2(0x2f4)](_0x549b5a=>{telegramError(_0x549b5a);}),tgBot['on'](_0x13b0c2(0x345),async _0x435877=>{const _0x335f6a=_0x13b0c2,_0x1c04e6=_0x435877[_0x335f6a(0x1e3)],_0x4c62fd=_0x435877['message'];tgBot[_0x335f6a(0x210)](_0x435877['id'])[_0x335f6a(0x32d)](async()=>{const _0x7f12dc=_0x335f6a,_0x244269=_0x2b5933[_0x7f12dc(0x342)](_0x44db08=>_0x44db08['botID']==_0x1c04e6),_0x29a498=_0x244269['mode']==_0x7f12dc(0x2cb)?_0x7f12dc(0x2b5):_0x7f12dc(0x2cb);tgBot[_0x7f12dc(0x218)](_0x4c62fd[_0x7f12dc(0x222)]['id'],_0x7f12dc(0x2b0)+_0x1c04e6+_0x7f12dc(0x21a)+_0x29a498+_0x7f12dc(0x200))[_0x7f12dc(0x2f4)](_0x4a49a8=>{telegramError(_0x4a49a8);}),toggleBotMode(_0x1c04e6);}),tgBot[_0x335f6a(0x33f)](_0x335f6a(0x345));});}}),tgBot['onText'](/\/names/,_0x3792c0=>{const _0x5100c4=_0xfbe873;if(!validateTelegram(_0x3792c0))return;let _0x25b042='';config[_0x5100c4(0x2bb)](_0x4d0601=>{const _0x272168=_0x5100c4;_0x25b042+=_0x272168(0x2ae)+_0x4d0601[_0x272168(0x255)]+':\x20'+_0x4d0601[_0x272168(0x257)]+'\x0a';}),tgBot[_0x5100c4(0x218)](_0x3792c0['chat']['id'],_0x25b042,{'parse_mode':_0x5100c4(0x2c5)})[_0x5100c4(0x2f4)](_0x7b8cc4=>{telegramError(_0x7b8cc4);});}),tgBot[_0xfbe873(0x248)](/\/disable/,_0x486a12=>{const _0x541adf=_0xfbe873;if(!validateTelegram(_0x486a12))return;tgBot[_0x541adf(0x218)](_0x486a12[_0x541adf(0x222)]['id'],_0x541adf(0x1d1))[_0x541adf(0x2f4)](_0x1a3298=>{telegramError(_0x1a3298);}),updateSetting(_0x541adf(0x324),![]);}),tgBot[_0xfbe873(0x248)](/\/help/,_0x4b3c2a=>{const _0x4984c7=_0xfbe873;if(!validateTelegram(_0x4b3c2a))return;tgBot[_0x4984c7(0x218)](_0x4b3c2a[_0x4984c7(0x222)]['id'],_0x1ada2d)[_0x4984c7(0x2f4)](_0x2afed4=>{telegramError(_0x2afed4);});}),tgBot['on']('polling_error',_0x2d33cf=>{const _0x463b7a=_0xfbe873;_0x2d33cf['toString']()['includes'](_0x463b7a(0x2a4))&&(logger['full'](_0x463b7a(0x219)),tgBot[_0x463b7a(0x285)](),tgBot=null,io['to'](_0x463b7a(0x21c))[_0x463b7a(0x31a)](_0x463b7a(0x225),_0x463b7a(0x219)));}),process[_0xfbe873(0x2c3)](_0xfbe873(0x2b9),()=>{const _0x4eaf44=_0xfbe873;if(tgBot)tgBot[_0x4eaf44(0x285)]();process['exit'](0x1);}),process[_0xfbe873(0x2c3)](_0xfbe873(0x2e3),()=>{const _0x2ccb21=_0xfbe873;if(tgBot)tgBot[_0x2ccb21(0x285)]();process[_0x2ccb21(0x1fd)](0x1);});}}function disableTelegram(){const _0x9d798=_0x10cd4e;tgBot&&(tgBot[_0x9d798(0x285)](),tgBot=null);}function sendTelegram(_0x514edd,_0x4a91a4){const _0x302f62=_0x10cd4e;if(settings[_0x302f62(0x324)]){if(settings[_0x302f62(0x261)]=='all'||(_0x4a91a4['type']==_0x302f62(0x331)||_0x4a91a4['type']==_0x302f62(0x1eb)||_0x4a91a4[_0x302f62(0x322)]==_0x302f62(0x369))&&settings[_0x302f62(0x261)]==_0x302f62(0x1f6)||_0x4a91a4['type']==_0x302f62(0x308)&&settings[_0x302f62(0x261)]=='orders'){if(tgBot&&settings[_0x302f62(0x2fc)]){if(_0x4a91a4['showname'])tgBot[_0x302f62(0x218)](settings[_0x302f62(0x2fc)],_0x4a91a4['botname']+_0x302f62(0x212)+_0x4a91a4['event'])[_0x302f62(0x2f4)](_0xd4df33=>{telegramError(_0xd4df33);});else tgBot['sendMessage'](settings['telegramChatId'],_0x302f62(0x2ae)+_0x514edd+_0x302f62(0x212)+_0x4a91a4[_0x302f62(0x289)])[_0x302f62(0x2f4)](_0x505cd3=>{telegramError(_0x505cd3);});}}}}async function sendTelegramMsg(_0x1f2f3f,_0x1f809e='HTML'){const _0x4c0bd0=_0x10cd4e;return settings['telegramEnabled']&&tgBot&&settings[_0x4c0bd0(0x2fc)]?(await tgBot[_0x4c0bd0(0x218)](settings[_0x4c0bd0(0x2fc)],_0x1f2f3f,{'parse_mode':_0x1f809e})['catch'](_0x2bfe4b=>{telegramError(_0x2bfe4b);}),!![]):![];}function getDeviceWithIp(_0x24148f){const _0x2a3195=_0x10cd4e;return devices[_0x2a3195(0x342)](_0xaa99a1=>_0xaa99a1['ip']===_0x24148f);}function temporaryAccess2FA(_0x2f35c3,_0x45c607){const _0x193cc7=_0x10cd4e;let _0x525025=new Date(),_0x1f4638=![];if(lastIpApproval){if(_0x525025-lastIpApproval<0x1388)_0x1f4638=!![];}lastIpApproval=new Date();if(_0x1f4638)return;tgBot&&settings[_0x193cc7(0x2fc)]&&(tgBot['removeListener'](_0x193cc7(0x345)),tgBot[_0x193cc7(0x218)](settings[_0x193cc7(0x2fc)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x45c607)[_0x193cc7(0x1f8)]+'</b>\x20?',{'parse_mode':_0x193cc7(0x2c5),'reply_markup':{'inline_keyboard':[[{'text':_0x193cc7(0x2fe),'callback_data':'5'},{'text':_0x193cc7(0x1bb),'callback_data':'15'},{'text':_0x193cc7(0x2ba),'callback_data':'30'},{'text':'reject','callback_data':_0x193cc7(0x1e9)}]]}})[_0x193cc7(0x2f4)](_0x3cdee4=>{telegramError(_0x3cdee4);}),tgBot['on'](_0x193cc7(0x345),async _0x4bb955=>{const _0x5f432b=_0x193cc7,_0x471679=_0x4bb955[_0x5f432b(0x1e3)],_0x48ac89=_0x4bb955[_0x5f432b(0x34c)];tgBot['answerCallbackQuery'](_0x4bb955['id'])[_0x5f432b(0x32d)](async()=>{const _0x17306f=_0x5f432b;devices[_0x2f35c3]['telegramIpApproval']={'clientip':_0x45c607,'timestamp':new Date()[_0x17306f(0x271)](),'expiry':_0x471679},_0x471679!=_0x17306f(0x1e9)?(await tgBot[_0x17306f(0x218)](_0x48ac89[_0x17306f(0x222)]['id'],'Access\x20enabled\x20for\x20'+_0x471679+'\x20minutes',{'parse_mode':_0x17306f(0x2c5)})[_0x17306f(0x2f4)](_0x2360a2=>{telegramError(_0x2360a2);}),io['to'](_0x2f35c3)[_0x17306f(0x31a)](_0x17306f(0x1cc),{'access':{'allow':![],'reason':_0x17306f(0x33b),'token':null}})):(await tgBot[_0x17306f(0x218)](_0x48ac89[_0x17306f(0x222)]['id'],_0x17306f(0x33a))[_0x17306f(0x2f4)](_0x3f6bcf=>{telegramError(_0x3f6bcf);}),io['to'](_0x2f35c3)[_0x17306f(0x31a)](_0x17306f(0x1cc),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x5f432b(0x33f)](_0x5f432b(0x345));}));}function loginAccess2FA(_0x25d3ca,_0x49fbe8){const _0x3be065=_0x10cd4e;tgBot&&settings['telegramChatId']&&(tgBot[_0x3be065(0x33f)](_0x3be065(0x345)),tgBot[_0x3be065(0x218)](settings['telegramChatId'],_0x3be065(0x28c)+normalizeIP(_0x49fbe8)[_0x3be065(0x1f8)]+_0x3be065(0x22c),{'parse_mode':_0x3be065(0x2c5),'reply_markup':{'inline_keyboard':[[{'text':_0x3be065(0x348),'callback_data':loginExpiry},{'text':_0x3be065(0x1e9),'callback_data':_0x3be065(0x1e9)}]]}})[_0x3be065(0x2f4)](_0xb6fed=>{telegramError(_0xb6fed);}),tgBot['on'](_0x3be065(0x345),async _0x11172d=>{const _0x2e3766=_0x3be065,_0x32dc60=_0x11172d['data'],_0x5b1447=_0x11172d[_0x2e3766(0x34c)];tgBot[_0x2e3766(0x210)](_0x11172d['id'])['then'](async()=>{const _0x4179e0=_0x2e3766;devices[_0x25d3ca][_0x4179e0(0x260)]={'clientip':_0x49fbe8,'timestamp':new Date()[_0x4179e0(0x271)](),'expiry':_0x32dc60},_0x32dc60!=_0x4179e0(0x1e9)?(await tgBot[_0x4179e0(0x218)](_0x5b1447['chat']['id'],'Login\x20accepted',{'parse_mode':'HTML'})['catch'](_0x3c9d44=>{telegramError(_0x3c9d44);}),io['to'](_0x25d3ca)[_0x4179e0(0x31a)]('status',{'access':{'allow':![],'reason':_0x4179e0(0x33b),'token':null}})):(await tgBot[_0x4179e0(0x218)](_0x5b1447[_0x4179e0(0x222)]['id'],_0x4179e0(0x280))[_0x4179e0(0x2f4)](_0x486325=>{telegramError(_0x486325);}),io['to'](_0x25d3ca)[_0x4179e0(0x31a)]('status',{'access':{'allow':![],'reason':_0x4179e0(0x231),'token':null}}));}),tgBot[_0x2e3766(0x33f)](_0x2e3766(0x345));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3b72c9=_0x10cd4e;return dbConfig[_0x3b72c9(0x372)]('bots')[_0x3b72c9(0x1dc)](_0x3b72c9(0x255))['filter']({'status':_0x3b72c9(0x1c1)})[_0x3b72c9(0x1e1)]()||[];}function getDisabledBots(){const _0x3b4b6a=_0x10cd4e;return dbConfig['get'](_0x3b4b6a(0x2d3))[_0x3b4b6a(0x1dc)](_0x3b4b6a(0x255))[_0x3b4b6a(0x30d)]({'status':_0x3b4b6a(0x1fe)})[_0x3b4b6a(0x1e1)]()||[];}function getBotAttributes(_0x43faf3){const _0x405125=_0x10cd4e;let _0x3c29cd={};const _0x53bc77=configpath+_0x405125(0x2b8)+_0x43faf3+'-config.json',_0x241a7e=fs[_0x405125(0x353)](_0x53bc77);if(_0x241a7e){const _0x550e3e=fs['readFileSync'](_0x53bc77);try{const _0x50a12c=JSON[_0x405125(0x2b2)](_0x550e3e),_0x3ae140=_0x50a12c?_0x50a12c[_0x405125(0x1a8)][0x0]['headless']:![];_0x3c29cd[_0x405125(0x36d)]=_0x3ae140?'auto':_0x405125(0x2b5),_0x3c29cd[_0x405125(0x257)]=_0x50a12c?_0x50a12c[_0x405125(0x1a8)][0x0][_0x405125(0x257)]:_0x405125(0x2ae)+_0x43faf3;}catch(_0x464c8b){_0x3c29cd[_0x405125(0x36d)]=_0x405125(0x2b5),_0x3c29cd[_0x405125(0x257)]=_0x405125(0x2ae)+_0x43faf3;}}else _0x3c29cd[_0x405125(0x36d)]='manual',_0x3c29cd['botname']=_0x405125(0x2ae)+_0x43faf3;return _0x3c29cd;}function getBotsWithMode(){const _0x39aef0=_0x10cd4e,_0x10251d=dbConfig[_0x39aef0(0x372)]('bots')[_0x39aef0(0x1dc)](_0x39aef0(0x255))[_0x39aef0(0x1e1)]()||[];return _0x10251d['forEach'](_0x231397=>{const _0x19b06a=_0x39aef0;let _0x398155=getBotAttributes(_0x231397[_0x19b06a(0x255)]);_0x231397[_0x19b06a(0x36d)]=_0x398155['mode'];}),_0x10251d;}function getBotExchanges(){const _0x1ed089=_0x10cd4e;let _0x2d2759=[];const _0x2bdd50=dbConfig[_0x1ed089(0x372)](_0x1ed089(0x2d3))[_0x1ed089(0x1dc)](_0x1ed089(0x255))[_0x1ed089(0x1e1)]()||[];_0x2bdd50[_0x1ed089(0x2bb)](_0x4645d5=>{const _0xd9d643=_0x1ed089;if(_0x4645d5[_0xd9d643(0x1cc)]=='enabled'){const _0x1c09a4=configpath+_0xd9d643(0x2b8)+_0x4645d5['botID']+_0xd9d643(0x1e0),_0x16cafb=fs[_0xd9d643(0x353)](_0x1c09a4);let _0x5156eb;if(_0x16cafb){const _0x19c097=fs[_0xd9d643(0x340)](_0x1c09a4);try{const _0x2bab75=JSON['parse'](_0x19c097);_0x5156eb=_0x2bab75?_0x2bab75[_0xd9d643(0x1a8)][0x0][_0xd9d643(0x2ad)]:null;}catch(_0x448a90){}}if(_0x5156eb)_0x2d2759[_0xd9d643(0x214)](_0x5156eb);}});const _0x1b9bf9=[...new Set(_0x2d2759)][_0x1ed089(0x201)]();return _0x1b9bf9;}async function initUser(){const _0x19d3b6=_0x10cd4e;if(!settings['userid']){const _0x2848b9=uuidRandom();mixpanel['alias'](_0x2848b9),updateSetting(_0x19d3b6(0x2d6),_0x2848b9);}}async function initSecure(){const _0x1100c4=_0x10cd4e;let _0x2db315=getSecure();if(!_0x2db315[_0x1100c4(0x1d9)](_0x1100c4(0x1e7))){let _0x445e1b=await generateKeys();_0x2db315['publicKey']=_0x445e1b[_0x1100c4(0x1ea)],_0x2db315['privateKey']=_0x445e1b[_0x1100c4(0x2e4)],_0x2db315['secret']=crypto[_0x1100c4(0x270)](0x20)[_0x1100c4(0x22a)](_0x1100c4(0x1d7));;storeSecure(_0x2db315);}}function getSettings(){const _0x27f521=_0x10cd4e;return dbSettings[_0x27f521(0x372)]('settings')[_0x27f521(0x1e1)]()||{};}function getSecure(){const _0x411c4c=_0x10cd4e;return dbSecure[_0x411c4c(0x372)]('secure')['value']()||{};}function getBlacklist(){const _0x1c1927=_0x10cd4e;return dbSecure[_0x1c1927(0x372)](_0x1c1927(0x2de))[_0x1c1927(0x1e1)]()||[];}function broadcastToBots(_0x477df0,_0x533353){const _0x1e496e=_0x10cd4e;config[_0x1e496e(0x2bb)](_0x40d6c1=>{const _0x52f23d=_0x1e496e;if(_0x40d6c1[_0x52f23d(0x1cc)]==_0x52f23d(0x1c1)&&_0x40d6c1[_0x52f23d(0x2c6)]==_0x52f23d(0x325)||_0x40d6c1[_0x52f23d(0x1cc)]==_0x52f23d(0x36f)&&_0x40d6c1[_0x52f23d(0x2c6)]==_0x52f23d(0x325)){if(pid[_0x40d6c1[_0x52f23d(0x255)]])pid[_0x40d6c1['botID']][_0x52f23d(0x2ac)]({[_0x477df0]:_0x533353});}});}function storeSettings(_0x21d4f1,_0x2e9342=![]){const _0x12113b=_0x10cd4e;_0x21d4f1={...settings,..._0x21d4f1};if(_0x2e9342&&_0x21d4f1[_0x12113b(0x1c9)]!=_0x12113b(0x228)&&_0x21d4f1[_0x12113b(0x1c9)]!='***'&&_0x21d4f1[_0x12113b(0x1c9)]!=''){const _0x436ce3=crypt[_0x12113b(0x2ec)](secure[_0x12113b(0x2e4)],_0x21d4f1[_0x12113b(0x1c9)])['message']['split']('@')[0x0],_0x531c25=bcrypt[_0x12113b(0x341)](_0x436ce3,saltRounds);_0x21d4f1={..._0x21d4f1,'bbPassword':_0x531c25};}if(_0x2e9342&&_0x21d4f1[_0x12113b(0x297)]!=_0x12113b(0x228)&&_0x21d4f1[_0x12113b(0x297)]!=_0x12113b(0x287)&&_0x21d4f1[_0x12113b(0x297)]!=''){const _0x471d18=crypt[_0x12113b(0x2ec)](secure[_0x12113b(0x2e4)],_0x21d4f1[_0x12113b(0x297)])['message'][_0x12113b(0x2d7)]('@')[0x0];_0x21d4f1={..._0x21d4f1,'telegramToken':_0x471d18};}const _0xa5ae87=_0x21d4f1[_0x12113b(0x297)]!=_0x12113b(0x228)&&_0x21d4f1[_0x12113b(0x297)]!=settings['telegramToken']||_0x21d4f1[_0x12113b(0x22e)]!=settings['telegramUsername'],_0x2e800f=_0x21d4f1[_0x12113b(0x297)]==''||_0x21d4f1[_0x12113b(0x22e)]=='';if(_0xa5ae87)_0x21d4f1[_0x12113b(0x261)]=_0x12113b(0x281);for(const [_0x333d05,_0xb7b238]of Object[_0x12113b(0x328)](_0x21d4f1)){if(_0x333d05==_0x12113b(0x297)&&_0xb7b238==_0x12113b(0x228)){_0x21d4f1[_0x12113b(0x297)]=settings[_0x12113b(0x297)];continue;};if(_0x333d05==_0x12113b(0x1c9)&&_0xb7b238==_0x12113b(0x228)){_0x21d4f1[_0x12113b(0x1c9)]=settings[_0x12113b(0x1c9)];continue;};dbSettings[_0x12113b(0x31d)]('settings.'+_0x333d05,_0xb7b238)[_0x12113b(0x29f)]();}settings=_0x21d4f1,io['to'](_0x12113b(0x21c))[_0x12113b(0x31a)](_0x12113b(0x1af),cleanSettings()),broadcastToBots(_0x12113b(0x2c2),settings[_0x12113b(0x2c2)]),broadcastToBots(_0x12113b(0x316),settings[_0x12113b(0x316)]);if(_0xa5ae87&&!_0x2e800f)initTelegram();if(_0xa5ae87&&_0x2e800f)disableTelegram();getAllClients()['forEach'](_0x125a98=>{const _0x4b817a=_0x12113b;getSocket(_0x125a98['id'])['emit'](_0x4b817a(0x1cc),{'access':{'allow':![],'reason':_0x4b817a(0x33b),'token':null}});});}function updateSetting(_0x1ed074,_0x2b0251){const _0x38036c=_0x10cd4e;dbSettings[_0x38036c(0x31d)](_0x38036c(0x362)+_0x1ed074,_0x2b0251)[_0x38036c(0x29f)](),settings=getSettings(),io['to']('botmanager')[_0x38036c(0x31a)](_0x38036c(0x1af),cleanSettings());}function storeSecure(_0x1421d0){const _0x16c61a=_0x10cd4e;dbSecure[_0x16c61a(0x372)](_0x16c61a(0x2f6))['push'](_0x1421d0)[_0x16c61a(0x29f)](),secure=_0x1421d0;}function addBlacklist(_0x5c379b){const _0x300bb9=_0x10cd4e;cleanBlacklist();let _0x466ffb;devices[_0x5c379b][_0x300bb9(0x1ab)]?_0x466ffb=Math[_0x300bb9(0x35b)](devices[_0x5c379b][_0x300bb9(0x1ab)][_0x300bb9(0x24f)],loginExpiry):_0x466ffb=loginExpiry,dbSecure[_0x300bb9(0x372)](_0x300bb9(0x2de))[_0x300bb9(0x214)]({'expiry':new Date()['getTime']()+_0x466ffb*0x3c*0x3e8,'token':devices[_0x5c379b][_0x300bb9(0x24e)]['token']})[_0x300bb9(0x29f)](),blacklist=dbSecure[_0x300bb9(0x372)](_0x300bb9(0x2de))[_0x300bb9(0x1e1)]();}function cleanBlacklist(){const _0x1f5912=_0x10cd4e;let _0x1501a7=dbSecure['get'](_0x1f5912(0x2de))['cloneDeep']()[_0x1f5912(0x1e1)](),_0x5b9afc=new Date()[_0x1f5912(0x271)]();_0x1501a7[_0x1f5912(0x2bb)](_0x295505=>{const _0x47f892=_0x1f5912;_0x295505[_0x47f892(0x24f)]<_0x5b9afc&&dbSecure[_0x47f892(0x372)](_0x47f892(0x2de))[_0x47f892(0x204)]({'expiry':_0x295505[_0x47f892(0x24f)]})[_0x47f892(0x29f)]();});}function initStates(){const _0x40d848=_0x10cd4e;let _0x31d36=getConfiguration();_0x31d36[_0x40d848(0x2bb)](_0x5f123a=>{const _0x50f7db=_0x40d848;_0x5f123a['live']=_0x50f7db(0x220);}),storeConfiguration(_0x31d36);}function onKeys(){const _0x27b578=new RSA();return new Promise(_0x21cbff=>{const _0x392568=_0x55f1;_0x27b578['generateKeyPairAsync']()[_0x392568(0x32d)](_0x3c9624=>{_0x21cbff(_0x3c9624);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x95027b=_0x10cd4e;let _0x4665e6=getSettings(),_0x501d52=![];!_0x4665e6[_0x95027b(0x1d9)](_0x95027b(0x304))&&(_0x4665e6[_0x95027b(0x304)]=0x0,_0x501d52=!![]);!_0x4665e6[_0x95027b(0x1d9)]('lastmsgemitted')&&(_0x4665e6['lastmsgemitted']=0x0,_0x501d52=!![]);!_0x4665e6[_0x95027b(0x1d9)](_0x95027b(0x25c))&&(_0x4665e6[_0x95027b(0x25c)]='0.0.0',_0x501d52=!![]);!_0x4665e6[_0x95027b(0x1d9)](_0x95027b(0x316))&&(_0x4665e6['onepagemode']=![],_0x501d52=!![]);if(_0x501d52)storeSettings(_0x4665e6);}function storeConfiguration(_0x27e808){const _0x357ac9=_0x10cd4e;dbConfig['get'](_0x357ac9(0x2d3))[_0x357ac9(0x204)]()[_0x357ac9(0x29f)](),_0x27e808[_0x357ac9(0x2bb)](_0x4dfd9b=>{const _0x16adcb=_0x357ac9;delete _0x4dfd9b[_0x16adcb(0x36d)];}),dbConfig['get'](_0x357ac9(0x2d3))[_0x357ac9(0x214)](..._0x27e808)[_0x357ac9(0x29f)](),config=_0x27e808;}function resetPassword(){const _0x20a4d5=_0x10cd4e;tgBot&&settings[_0x20a4d5(0x2fc)]&&(tgBot[_0x20a4d5(0x33f)](_0x20a4d5(0x345)),tgBot[_0x20a4d5(0x218)](settings[_0x20a4d5(0x2fc)],_0x20a4d5(0x23f),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x20a4d5(0x1b9),'callback_data':_0x20a4d5(0x1b9)},{'text':'no','callback_data':'no'}]]}})[_0x20a4d5(0x2f4)](_0x10819f=>{telegramError(_0x10819f);}),tgBot['on']('callback_query',async _0x5df07e=>{const _0x2fc704=_0x20a4d5,_0x20d890=_0x5df07e['data'],_0x3da892=_0x5df07e[_0x2fc704(0x34c)];tgBot[_0x2fc704(0x210)](_0x5df07e['id'])[_0x2fc704(0x32d)](async()=>{const _0x51fd91=_0x2fc704;if(_0x20d890!='no'){const _0x2212e5=0xf,_0x2af18a=_0x51fd91(0x1be),_0x372067=Array[_0x51fd91(0x268)](crypto[_0x51fd91(0x1f4)](new Uint32Array(_0x2212e5)))[_0x51fd91(0x2a9)](_0x41f90e=>_0x2af18a[_0x41f90e%_0x2af18a[_0x51fd91(0x2fb)]])[_0x51fd91(0x1b8)](''),_0x4b7a0a=bcrypt[_0x51fd91(0x341)](_0x372067,saltRounds);storeSettings({'bbPassword':_0x4b7a0a}),await tgBot[_0x51fd91(0x218)](_0x3da892['chat']['id'],_0x51fd91(0x336)+_0x372067,{'parse_mode':'HTML'})['catch'](_0x3c4b6e=>{telegramError(_0x3c4b6e);});}else await tgBot[_0x51fd91(0x218)](_0x3da892['chat']['id'],_0x51fd91(0x272))['catch'](_0x1a6962=>{telegramError(_0x1a6962);});}),tgBot[_0x2fc704(0x33f)]('callback_query');}));}async function confirmRestore(_0x27c3ac,_0x4cec53){const _0x316c99=_0x10cd4e;io['to'](_0x316c99(0x21c))[_0x316c99(0x31a)](_0x316c99(0x225),_0x316c99(0x35a),_0x316c99(0x369)),tgBot&&settings[_0x316c99(0x2fc)]&&(tgBot['removeListener'](_0x316c99(0x345)),await tgBot[_0x316c99(0x218)](settings[_0x316c99(0x2fc)],_0x316c99(0x368),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x316c99(0x1b9),'callback_data':_0x316c99(0x1b9)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x75443d=>{telegramError(_0x75443d);}),tgBot['on'](_0x316c99(0x345),async _0x27ebe1=>{const _0x1a50e2=_0x316c99,_0x58239f=_0x27ebe1[_0x1a50e2(0x1e3)],_0x246545=_0x27ebe1[_0x1a50e2(0x34c)];tgBot['answerCallbackQuery'](_0x27ebe1['id'])[_0x1a50e2(0x32d)](async()=>{const _0x7efbab=_0x1a50e2;_0x58239f=='yes'?(await tgBot[_0x7efbab(0x218)](_0x246545[_0x7efbab(0x222)]['id'],_0x7efbab(0x27d),{'parse_mode':_0x7efbab(0x2c5)})[_0x7efbab(0x2f4)](_0x509930=>{telegramError(_0x509930);}),unzipFile(_0x27c3ac,_0x4cec53)):(logger['debug']('Restore\x20process\x20aborted'),await tgBot[_0x7efbab(0x218)](_0x246545[_0x7efbab(0x222)]['id'],_0x7efbab(0x2eb))['catch'](_0x392d63=>{telegramError(_0x392d63);}));}),tgBot[_0x1a50e2(0x33f)](_0x1a50e2(0x345));}));}function getServerTime(){const _0xb6a638=_0x10cd4e,_0x49688e=new Date();return _0x49688e[_0xb6a638(0x291)]()+'/'+(_0x49688e[_0xb6a638(0x27e)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x49688e['getDate']()[_0xb6a638(0x22a)]()['padStart'](0x2,'0')+'\x20'+_0x49688e[_0xb6a638(0x2fa)]()[_0xb6a638(0x22a)]()[_0xb6a638(0x303)](0x2,'0')+':'+_0x49688e[_0xb6a638(0x33c)]()[_0xb6a638(0x22a)]()[_0xb6a638(0x303)](0x2,'0')+':'+_0x49688e['getSeconds']()[_0xb6a638(0x22a)]()[_0xb6a638(0x303)](0x2,'0');}function getTimeStamp(){const _0x5cc488=_0x10cd4e,_0x343ef9=shiftedTime();return _0x343ef9['getFullYear']()+'/'+(_0x343ef9[_0x5cc488(0x27e)]()+0x1)[_0x5cc488(0x22a)]()[_0x5cc488(0x303)](0x2,'0')+'/'+_0x343ef9['getDate']()[_0x5cc488(0x22a)]()['padStart'](0x2,'0')+'\x20'+_0x343ef9[_0x5cc488(0x2fa)]()['toString']()[_0x5cc488(0x303)](0x2,'0')+':'+_0x343ef9['getMinutes']()['toString']()['padStart'](0x2,'0')+':'+_0x343ef9['getSeconds']()['toString']()[_0x5cc488(0x303)](0x2,'0');}function getCleanTimeStamp(){const _0x373bf0=_0x10cd4e,_0x133b60=shiftedTime();return _0x133b60['getFullYear']()+(_0x133b60['getMonth']()+0x1)[_0x373bf0(0x22a)]()[_0x373bf0(0x303)](0x2,'0')+_0x133b60['getDate']()['toString']()[_0x373bf0(0x303)](0x2,'0')+'-'+_0x133b60[_0x373bf0(0x2fa)]()[_0x373bf0(0x22a)]()[_0x373bf0(0x303)](0x2,'0')+_0x133b60[_0x373bf0(0x33c)]()['toString']()[_0x373bf0(0x303)](0x2,'0')+_0x133b60['getSeconds']()[_0x373bf0(0x22a)]()[_0x373bf0(0x303)](0x2,'0');}function shiftedTime(){const _0x4163ef=_0x10cd4e,_0x325633=new Date();let _0x368a73=_0x325633;if(settings['timeshift']&&settings[_0x4163ef(0x2c2)]!==0x0)_0x368a73=fns[_0x4163ef(0x23d)](_0x325633,{'hours':settings[_0x4163ef(0x2c2)]});return _0x368a73;}function startScheduler(){const _0x3a9e3f=_0x10cd4e,_0x2d133b=new Date()[_0x3a9e3f(0x31c)](),_0x46af48=shiftedTime()[_0x3a9e3f(0x2fa)]();_0x46af48==0x4&&backupConfigFiles();_0x46af48==0x0&&rotateLogFiles();_0x2d133b%0x6==0x0&&triggerAnalytics();_0x2d133b%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x345ea9){const _0x1d89b1=_0x10cd4e;logger[_0x1d89b1(0x1b1)]('Restore\x20backup\x20file\x20'+_0x345ea9);const _0x3dd6c0=getBotsWithMode();_0x3dd6c0[_0x1d89b1(0x2fb)]>0x0?confirmRestore(configbackuppath,_0x345ea9):unzipFile(configbackuppath,_0x345ea9);}async function getBackupFiles(_0x59af1b=null){const _0x476e21=_0x10cd4e;let _0xd37254=[],_0x2a7c5a=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x2a7c5a['sort']((_0x7b2b78,_0x2e7c30)=>_0x7b2b78[_0x476e21(0x2d8)]<_0x2e7c30[_0x476e21(0x2d8)]?0x1:_0x2e7c30[_0x476e21(0x2d8)]<_0x7b2b78[_0x476e21(0x2d8)]?-0x1:0x0),_0x2a7c5a[_0x476e21(0x2bb)](_0x138737=>{const _0x950560=_0x476e21;if(!_0x138737[_0x950560(0x34e)]()&&_0x138737['name']['startsWith']('backup-full@')&&_0x138737[_0x950560(0x2d8)]['endsWith'](_0x950560(0x1f0))){const _0x85852e=formatDate(fs['statSync'](configbackuppath+_0x138737[_0x950560(0x2d8)])[_0x950560(0x365)]);_0xd37254[_0x950560(0x214)]({'name':_0x138737[_0x950560(0x2d8)],'mtime':_0x85852e});}});if(_0x59af1b)io['to'](_0x59af1b)[_0x476e21(0x31a)]('backup-files',_0xd37254);else return _0xd37254;}async function backupConfigFiles(){const _0x302652=_0x10cd4e;await zipFiles(_0x302652(0x2c7));const _0x490220=getCleanTimeStamp();fs[_0x302652(0x2bf)](zippath+_0x302652(0x2c0),configbackuppath+(_0x302652(0x2dd)+_0x490220+'.zip'));let _0x113d63=fs[_0x302652(0x227)](configbackuppath,{'withFileTypes':!![]});_0x113d63[_0x302652(0x201)]((_0x5828a1,_0x1a7f62)=>_0x5828a1['name']<_0x1a7f62[_0x302652(0x2d8)]?0x1:_0x1a7f62[_0x302652(0x2d8)]<_0x5828a1[_0x302652(0x2d8)]?-0x1:0x0),_0x113d63[_0x302652(0x2fb)]>maxBackups&&fs[_0x302652(0x21e)](configbackuppath+_0x113d63[maxBackups]['name']);}function rotateLogFiles(){const _0x73106d=_0x10cd4e,_0x179676=fs['statSync'](logspath+_0x73106d(0x358)),_0xdd3a80=_0x179676[_0x73106d(0x299)]/0x400;if(_0xdd3a80>0x64){let _0xe1e3bd=fs[_0x73106d(0x227)](logspath,{'withFileTypes':!![]});_0xe1e3bd[_0x73106d(0x201)]((_0x51b59f,_0x2fb0d8)=>_0x51b59f[_0x73106d(0x2d8)]<_0x2fb0d8[_0x73106d(0x2d8)]?0x1:_0x2fb0d8[_0x73106d(0x2d8)]<_0x51b59f[_0x73106d(0x2d8)]?-0x1:0x0),_0xe1e3bd['forEach'](_0x47453f=>{const _0x30d8a5=_0x73106d;if(_0x47453f[_0x30d8a5(0x2d8)]=='output-002.log')fs['copyFileSync'](logspath+_0x47453f[_0x30d8a5(0x2d8)],logspath+'output-003.log');if(_0x47453f[_0x30d8a5(0x2d8)]=='output-001.log')fs[_0x30d8a5(0x2bf)](logspath+_0x47453f[_0x30d8a5(0x2d8)],logspath+_0x30d8a5(0x24b));_0x47453f[_0x30d8a5(0x2d8)]==_0x30d8a5(0x358)&&(fs['copyFileSync'](logspath+_0x47453f['name'],logspath+_0x30d8a5(0x1ad)),fs[_0x30d8a5(0x332)](logspath+_0x47453f[_0x30d8a5(0x2d8)],''));});}}async function zipFiles(_0x471111){const _0x29d896=_0x10cd4e;let _0x39def8;if(_0x471111==_0x29d896(0x2ff))_0x39def8=logspath;if(_0x471111==_0x29d896(0x23e))_0x39def8=configpath;if(_0x471111==_0x29d896(0x2c7))_0x39def8=configpath;let _0x13ab37=fs[_0x29d896(0x227)](_0x39def8,{'withFileTypes':!![]});const _0x8e0f63=new require(_0x29d896(0x34a))();_0x13ab37[_0x29d896(0x2bb)](_0x88d5d4=>{const _0xec4dd4=_0x29d896;if(!_0x88d5d4[_0xec4dd4(0x34e)]()){let _0x15943d=fs[_0xec4dd4(0x340)](_0x39def8+_0x88d5d4[_0xec4dd4(0x2d8)]);if(_0x471111=='backup'){const _0x365bea=/^bot-[0-9]{3}-config.json$/,_0x1bf4be=_0x365bea[_0xec4dd4(0x30f)](_0x88d5d4[_0xec4dd4(0x2d8)]);if(_0x1bf4be){const _0x3b8b53=JSON[_0xec4dd4(0x2b2)](_0x15943d);if(_0x3b8b53['bot'][0x0]){_0x3b8b53[_0xec4dd4(0x1a8)][0x0][_0xec4dd4(0x2e2)]=_0xec4dd4(0x287),_0x3b8b53[_0xec4dd4(0x1a8)][0x0]['apiSecret']=_0xec4dd4(0x287);if(_0x3b8b53[_0xec4dd4(0x1a8)][0x0][_0xec4dd4(0x23b)])_0x3b8b53[_0xec4dd4(0x1a8)][0x0][_0xec4dd4(0x23b)]=_0xec4dd4(0x287);}_0x15943d=JSON['stringify'](_0x3b8b53,null,0x2);}if(_0x88d5d4['name']==_0xec4dd4(0x32c)){const _0x4e08a9=JSON[_0xec4dd4(0x2b2)](_0x15943d);if(_0x4e08a9[_0xec4dd4(0x1af)]['loginRequired'])_0x4e08a9['settings']['loginRequired']=![];if(_0x4e08a9[_0xec4dd4(0x1af)][_0xec4dd4(0x1c9)])_0x4e08a9['settings'][_0xec4dd4(0x1c9)]=_0xec4dd4(0x287);if(_0x4e08a9[_0xec4dd4(0x1af)]['telegramToken'])_0x4e08a9[_0xec4dd4(0x1af)]['telegramToken']='***';if(_0x4e08a9['settings']['telegramChatId'])_0x4e08a9[_0xec4dd4(0x1af)][_0xec4dd4(0x2fc)]=null;_0x15943d=JSON[_0xec4dd4(0x1e4)](_0x4e08a9,null,0x2);}if(_0x88d5d4[_0xec4dd4(0x2d8)]!='bb-secure.json')_0x8e0f63[_0xec4dd4(0x1ba)](_0x88d5d4[_0xec4dd4(0x2d8)],_0x15943d);}else _0x8e0f63[_0xec4dd4(0x1ba)](_0x88d5d4[_0xec4dd4(0x2d8)],_0x15943d);}});const _0x5db6ff=_0x8e0f63[_0x29d896(0x349)]({'base64':![],'compression':_0x29d896(0x34d)});fs['writeFileSync'](zippath+(_0x471111+'.zip'),_0x5db6ff,'binary');}function _0x55f1(_0x305025,_0x559865){const _0x12773d=_0x21ed();return _0x55f1=function(_0x4d388d,_0x1f4c51){_0x4d388d=_0x4d388d-0x1a7;let _0x21edec=_0x12773d[_0x4d388d];return _0x21edec;},_0x55f1(_0x305025,_0x559865);}async function unzipFile(_0x542bec,_0xe06a24){const _0x180f88=_0x10cd4e;fs['readdirSync'](configpath,{'withFileTypes':!![]})['forEach'](_0x4857f4=>{const _0x5063e9=_0x55f1;if(!_0x4857f4[_0x5063e9(0x34e)]())fs[_0x5063e9(0x337)](configpath+_0x4857f4[_0x5063e9(0x2d8)]);});const _0x281c88=fs[_0x180f88(0x340)](_0x542bec+_0xe06a24,'binary'),_0x41cadb=new require('node-zip')(_0x281c88,{'base64':![],'checkCRC32':!![]});Object[_0x180f88(0x310)](_0x41cadb[_0x180f88(0x30a)])[_0x180f88(0x2bb)](_0x31650d=>{const _0x20547c=_0x180f88,_0x1b1a80=_0x41cadb['files'][_0x31650d];fs[_0x20547c(0x332)](configpath+_0x1b1a80['name'],_0x1b1a80[_0x20547c(0x1f9)]);}),fs[_0x180f88(0x227)](temppath,{'withFileTypes':!![]})['forEach'](_0x40200b=>{const _0x2fc23e=_0x180f88;if(!_0x40200b[_0x2fc23e(0x34e)]())fs[_0x2fc23e(0x337)](temppath+_0x40200b['name']);}),logger['debug'](_0x180f88(0x1e8)),process[_0x180f88(0x2ac)]({'restore':!![]},_0x51a701=>{});}async function getPublicIp(){const _0x2c8763=_0x10cd4e;try{const _0x4e385b=await axios[_0x2c8763(0x372)]('https://api.ipify.org?format=json');publicip=_0x4e385b[_0x2c8763(0x1e3)]['ip'];}catch(_0x31bb7d){}}async function triggerAnalytics(){const _0x219f36=_0x10cd4e;if(!publicip)await getPublicIp();const _0x4814bd=getBotsWithMode();let _0x20218e=0x0;_0x4814bd[_0x219f36(0x2bb)](_0x40dc27=>{const _0x3323da=_0x219f36;if(_0x40dc27[_0x3323da(0x1cc)]===_0x3323da(0x1c1))_0x20218e++;});const _0x4fcc54=getBotExchanges();mixpanel[_0x219f36(0x1d4)]('Server',{'distinct_id':settings[_0x219f36(0x2d6)],'ip':publicip,'version':serverversion,'numbots':_0x4814bd['length'],'numbotsenabled':_0x20218e,'exchanges':_0x4fcc54});}async function getMessages(){const _0x5a740a=_0x10cd4e,_0x210369=_0x5a740a(0x36a),_0x188095=new GraphQLClient(_0x210369),_0x46b161={'authorization':_0x5a740a(0x2af)},_0x3f9ce4=serverversion['split']('.'),_0xaa2bfa=_0x3f9ce4[0x0]+'.'+_0x3f9ce4[0x1],_0x1a555c=Math[_0x5a740a(0x330)](settings[_0x5a740a(0x304)],settings[_0x5a740a(0x277)]),_0x86f394={'last':parseInt(_0x1a555c),'bbm':_0xaa2bfa},_0x4d7957=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x3a4aaa;try{_0x3a4aaa=await _0x188095['request'](_0x4d7957,_0x86f394,_0x46b161);}catch(_0xf9760){}if(_0x3a4aaa&&_0x3a4aaa[_0x5a740a(0x265)]){let _0x18e203=settings[_0x5a740a(0x304)];newMessages=[];for(const _0x4a12ea of _0x3a4aaa[_0x5a740a(0x265)]){newMessages[_0x5a740a(0x214)](_0x4a12ea);if(_0x4a12ea['bbvNew'])updateSetting('latestversion',_0x4a12ea[_0x5a740a(0x364)]);let _0x42034d=_0x4a12ea[_0x5a740a(0x364)]?serverversion>=_0x4a12ea[_0x5a740a(0x364)]:![];if(!_0x42034d&&_0x4a12ea[_0x5a740a(0x301)]>_0x18e203){if(_0x4a12ea[_0x5a740a(0x1db)]===_0x5a740a(0x296)||serverversion[_0x5a740a(0x2f5)](_0x4a12ea[_0x5a740a(0x1db)])){let _0x2600f7=''+_0x4a12ea['title']+'\x0a\x0a'+_0x4a12ea[_0x5a740a(0x34c)];const _0x202a22=await sendTelegramMsg(toTelegramMarkdown(_0x2600f7),_0x5a740a(0x2b7));if(_0x202a22)_0x18e203=_0x4a12ea[_0x5a740a(0x301)];}}}updateAvailable=isNewerVersion(settings[_0x5a740a(0x25c)],serverversion),updateSetting('lastmsgtelegram',_0x18e203),emitMessages();}}function emitMessages(){const _0x388d67=_0x10cd4e,_0x36b4a3=settings['lastmsgemitted'];let _0x123610=[];newMessages[_0x388d67(0x2bb)](_0x4eed36=>{const _0x450f1b=_0x388d67;_0x4eed36['number']>_0x36b4a3&&_0x123610[_0x450f1b(0x214)](_0x4eed36);}),_0x123610[_0x388d67(0x2fb)]>0x0&&getAllClients()[_0x388d67(0x2bb)](_0x1e3232=>{const _0x2c49f9=_0x388d67;getSocket(_0x1e3232['id'])[_0x2c49f9(0x31a)](_0x2c49f9(0x34c),_0x123610);});}function confirmMessage(_0x1dc550){const _0x56397d=_0x10cd4e;updateSetting(_0x56397d(0x277),Number(_0x1dc550));}function isNewerVersion(_0xb4ed18,_0x5b1d90){const _0x1b93aa=_0x10cd4e,_0x1bf66d=_0x5b1d90[_0x1b93aa(0x2d7)]('.'),_0x4158a4=_0xb4ed18[_0x1b93aa(0x2d7)]('.');for(var _0x1b518a=0x0;_0x1b518a<_0x4158a4[_0x1b93aa(0x2fb)];_0x1b518a++){const _0x597950=~~_0x4158a4[_0x1b518a],_0x59b139=~~_0x1bf66d[_0x1b518a];if(_0x597950>_0x59b139)return!![];if(_0x597950<_0x59b139)return![];}return![];}function toTelegramMarkdown(_0xe3a5ac){const _0x5d143c=_0x10cd4e,_0x4d6235=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x451734=/\*{2}(.+?)\*{2}/gim;return _0xe3a5ac=_0xe3a5ac['replace'](_0x4d6235,_0x5d143c(0x1ed))[_0x5d143c(0x1ff)](_0x451734,_0x5d143c(0x354)),_0xe3a5ac;}async function validateConfigFile(){const _0xae532f=_0x10cd4e,_0x28288d=dbConfig[_0xae532f(0x372)](_0xae532f(0x2d3))[_0xae532f(0x1dc)](_0xae532f(0x255))[_0xae532f(0x1e1)]()||[];if(_0x28288d['length']==0x0){let _0x4afc88=0x0,_0x18f2de=[];const _0xbe037c=/^bot-([0-9]{3})-config.json$/,_0x23a3c0=fs['readdirSync'](configpath);_0x23a3c0[_0xae532f(0x2bb)](_0x567e74=>{const _0x45f643=_0xae532f,_0x4d1a4d=_0xbe037c[_0x45f643(0x370)](_0x567e74);if(_0x4d1a4d){const _0x5d6cdc=_0x4d1a4d[0x1];let _0x3dc0bb=getBotAttributes(_0x5d6cdc);_0x18f2de[_0x45f643(0x214)]({'botID':_0x5d6cdc,'botname':_0x3dc0bb['botname'],'status':_0x45f643(0x1fe),'live':_0x45f643(0x220)}),_0x4afc88++;}}),_0x4afc88!=0x0&&(dbConfig[_0xae532f(0x372)](_0xae532f(0x2d3))[_0xae532f(0x29e)](_0x18f2de)[_0xae532f(0x29f)](),config=_0x18f2de,restoredConfigFile=_0x4afc88);}}async function restoreConfigNotify(_0x1d71b2){const _0x236a0a=_0x10cd4e;let _0x495341;if(restoredConfigFile==0x1)_0x495341=_0x236a0a(0x2a7);else _0x495341='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x1d71b2)io['to'](_0x236a0a(0x21c))[_0x236a0a(0x31a)](_0x236a0a(0x225),_0x495341);else{logger[_0x236a0a(0x221)]('-----------------------------------------------------------------------------------'),logger[_0x236a0a(0x221)](_0x495341),logger[_0x236a0a(0x221)](_0x236a0a(0x2d9)),logger['simple']('');if(tgBot&&settings[_0x236a0a(0x2fc)]&&settings['telegramEvents']!=_0x236a0a(0x2ef))tgBot[_0x236a0a(0x218)](settings['telegramChatId'],_0x236a0a(0x361)+_0x495341)['catch'](_0x516537=>{telegramError(_0x516537);});}}function validateCredentials(_0x4d81cc,_0x5e6bc3){const _0x16db81=_0x10cd4e;if(_0x4d81cc['username']==settings[_0x16db81(0x1ef)]&&bcrypt['compareSync'](_0x4d81cc[_0x16db81(0x1c3)],settings[_0x16db81(0x1c9)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x16db81(0x251),'token':null};else{const _0x49013c=generateLoginToken(_0x5e6bc3);return{'allow':!![],'reason':_0x16db81(0x1aa),'token':_0x49013c};}}else return{'allow':![],'reason':_0x16db81(0x2a0),'token':null};}function refreshToken(_0x48b6e6){const _0x1b31b5=_0x10cd4e,_0x519445=generateLoginToken(_0x48b6e6);return{'allow':!![],'reason':_0x1b31b5(0x1aa),'token':_0x519445};}function validateAccess(_0x5828f8,_0x1741b9,_0x39d0b1){const _0x253aaa=_0x10cd4e,_0x332578=_0x39d0b1?_0x39d0b1:devices[_0x1741b9]['ip'];let _0x591197;const _0x405580=_0x5ae880=>{const _0x288f49=_0x55f1;if(settings[_0x288f49(0x32a)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x1741b9)){const _0x37f71b=generateLoginToken(_0x1741b9);return{'allow':!![],'reason':_0x288f49(0x250),'token':_0x37f71b};}else return{'allow':![],'reason':_0x288f49(0x1c6),'token':null};}else return _0x591197=validToken(_0x5ae880,_0x1741b9),_0x591197[_0x288f49(0x1d9)](_0x288f49(0x369))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x5ae880}:{'allow':![],'reason':_0x288f49(0x1c6),'token':null};}else return{'allow':!![],'reason':_0x288f49(0x35c),'token':null};};if(settings['whitelistEnabled']){let _0x19d0f6=[...settings['whitelist'],_0x253aaa(0x229),_0x253aaa(0x241),_0x253aaa(0x2a6)];if(_0x19d0f6['includes'](_0x332578))return _0x405580(_0x5828f8);else{_0x591197=validToken(_0x5828f8,_0x1741b9);if(_0x591197[_0x253aaa(0x1d9)](_0x253aaa(0x369)))return _0x405580(_0x5828f8);else{if(telegramIpApproved(_0x1741b9)){const _0x85e014=generateToken(_0x1741b9);return _0x591197=_0x405580(_0x5828f8),_0x591197[_0x253aaa(0x2b4)]?{'allow':!![],'reason':_0x253aaa(0x23a),'token':_0x85e014}:_0x591197;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x253aaa(0x312),'token':null}:{'allow':![],'reason':_0x253aaa(0x256),'token':null};}}}else return _0x405580(_0x5828f8);}function timelyDecrypt(_0xc7e68e,_0x3a687a=!![]){const _0x37d791=_0x10cd4e;if(_0xc7e68e)try{const _0x20da1b=crypt[_0x37d791(0x2ec)](secure['privateKey'],_0xc7e68e)[_0x37d791(0x34c)],_0x12492c=_0x20da1b[_0x37d791(0x2d7)]('@')[0x0],_0x26a979=_0x20da1b[_0x37d791(0x2d7)]('@')[0x1],_0x5e6462=new Date()[_0x37d791(0x271)]();if(_0x3a687a){if(_0x5e6462-_0x26a979<maxSecretAge*0x3e8)return _0x12492c;else return![];}else return _0x12492c;}catch(_0x1ba7a6){return![];}else return![];}const validToken=(_0x18acc7,_0x16fb50)=>{const _0x35cf26=_0x10cd4e,_0x12dfd4=devices[_0x16fb50]['ip'];if(!_0x18acc7)return{'error':_0x35cf26(0x1bd)};for(let _0x1f70b6 of blacklist){if(_0x1f70b6[_0x35cf26(0x374)]==_0x18acc7)return{'error':_0x35cf26(0x254)};}let _0x14f612;try{_0x14f612=jwt[_0x35cf26(0x26e)](_0x18acc7,secure[_0x35cf26(0x1e7)]+_0x16fb50);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x14f612[_0x35cf26(0x1d9)](_0x35cf26(0x313))&&!_0x14f612['hasOwnProperty']('username')||!_0x14f612[_0x35cf26(0x1d9)](_0x35cf26(0x208)))return{'error':_0x35cf26(0x2be)};if(!_0x14f612[_0x35cf26(0x1d9)](_0x35cf26(0x206))&&_0x14f612['hasOwnProperty'](_0x35cf26(0x313))){const {clientip:_0x4ba3e1}=_0x14f612;return _0x12dfd4==_0x4ba3e1?{'success':_0x35cf26(0x24a)}:{'error':_0x35cf26(0x2a2)};}else{if(_0x14f612[_0x35cf26(0x1d9)](_0x35cf26(0x206))&&_0x14f612[_0x35cf26(0x1d9)](_0x35cf26(0x313))){const {username:_0x2c145f,clientip:_0x4e5f7b}=_0x14f612;return settings[_0x35cf26(0x1ef)]==_0x2c145f&&_0x12dfd4==_0x4e5f7b?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x2898cb=>{const _0x1a10fa=_0x10cd4e;if(_0x2898cb){const _0x5c8cd2=devices[_0x2898cb]['ip'];return jwt[_0x1a10fa(0x253)]({'username':settings[_0x1a10fa(0x1ef)],'clientip':_0x5c8cd2},secure[_0x1a10fa(0x1e7)]+_0x2898cb,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x499a17=>{const _0x4c545b=_0x10cd4e;if(_0x499a17){const _0x1250db=devices[_0x499a17]['ip'];return jwt['sign']({'clientip':_0x1250db},secure[_0x4c545b(0x1e7)]+_0x499a17,{'expiresIn':devices[_0x499a17][_0x4c545b(0x1ab)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x16f595=>{const _0x455037=_0x10cd4e;let _0x3bc3b8=![];return devices[_0x16f595][_0x455037(0x1ab)]&&devices[_0x16f595][_0x455037(0x1ab)]['expiry']!='reject'&&(_0x3bc3b8=devices[_0x16f595][_0x455037(0x1ab)][_0x455037(0x313)]==devices[_0x16f595]['ip']&&new Date()[_0x455037(0x271)]()-devices[_0x16f595][_0x455037(0x1ab)][_0x455037(0x2f3)]<devices[_0x16f595]['telegramIpApproval'][_0x455037(0x24f)]*0x3c*0x3e8),_0x3bc3b8;},telegram2FaApproved=_0x4d374b=>{const _0x12791c=_0x10cd4e;let _0x5c8e38=![];return devices[_0x4d374b][_0x12791c(0x260)]&&devices[_0x4d374b][_0x12791c(0x260)]['expiry']!=_0x12791c(0x1e9)&&(_0x5c8e38=devices[_0x4d374b][_0x12791c(0x260)][_0x12791c(0x313)]==devices[_0x4d374b]['ip']&&new Date()[_0x12791c(0x271)]()-devices[_0x4d374b][_0x12791c(0x260)]['timestamp']<devices[_0x4d374b][_0x12791c(0x260)][_0x12791c(0x24f)]*0x3c*0x3e8),_0x5c8e38;},normalizeIP=_0x1e89f5=>{const _0x17747d=_0x10cd4e;let _0xc8335=null,_0x558190=null;if(ipaddr[_0x17747d(0x1b2)](_0x1e89f5)){const _0x395cbc=ipaddr[_0x17747d(0x2b2)](_0x1e89f5);_0x395cbc['kind']()==='ipv6'?(_0x395cbc[_0x17747d(0x371)]()&&(_0xc8335=_0x395cbc['toIPv4Address']()[_0x17747d(0x22a)]()),_0x558190=_0x395cbc[_0x17747d(0x22a)]()):(_0xc8335=_0x395cbc[_0x17747d(0x22a)](),_0x558190=_0x395cbc[_0x17747d(0x2cf)]()[_0x17747d(0x22a)]());}return{'show':_0xc8335?_0xc8335:_0x558190,'store':_0x558190};};function formatDate(_0x145936){const _0x4e7643=_0x10cd4e;return _0x145936[_0x4e7643(0x291)]()+'/'+(_0x145936[_0x4e7643(0x27e)]()+0x1)[_0x4e7643(0x22a)]()['padStart'](0x2,'0')+'/'+_0x145936[_0x4e7643(0x33d)]()['toString']()[_0x4e7643(0x303)](0x2,'0')+'\x20'+_0x145936['getHours']()[_0x4e7643(0x22a)]()[_0x4e7643(0x303)](0x2,'0')+':'+_0x145936[_0x4e7643(0x33c)]()[_0x4e7643(0x22a)]()['padStart'](0x2,'0')+':'+_0x145936['getSeconds']()[_0x4e7643(0x22a)]()[_0x4e7643(0x303)](0x2,'0');}function sleep(_0x186339){return new Promise(_0x464264=>setTimeout(_0x464264,_0x186339));}