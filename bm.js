const _0x102701=_0x4099;(function(_0x387e05,_0x481095){const _0x49780b=_0x4099,_0x1f45d1=_0x387e05();while(!![]){try{const _0x30273f=parseInt(_0x49780b(0x243))/0x1+-parseInt(_0x49780b(0x24a))/0x2*(-parseInt(_0x49780b(0x1f3))/0x3)+parseInt(_0x49780b(0x202))/0x4+-parseInt(_0x49780b(0x23c))/0x5+parseInt(_0x49780b(0x269))/0x6*(parseInt(_0x49780b(0x1d1))/0x7)+-parseInt(_0x49780b(0x261))/0x8*(parseInt(_0x49780b(0x1be))/0x9)+parseInt(_0x49780b(0x1a6))/0xa;if(_0x30273f===_0x481095)break;else _0x1f45d1['push'](_0x1f45d1['shift']());}catch(_0x286866){_0x1f45d1['push'](_0x1f45d1['shift']());}}}(_0x5f30,0xac3f0));const _0x52479e=function(){let _0x3ea635=!![];return function(_0x4c407e,_0x538ffa){const _0x1e2878=_0x3ea635?function(){const _0x4678f4=_0x4099;if(_0x538ffa){const _0x25192=_0x538ffa[_0x4678f4(0x164)](_0x4c407e,arguments);return _0x538ffa=null,_0x25192;}}:function(){};return _0x3ea635=![],_0x1e2878;};}(),_0x3f3789=_0x52479e(this,function(){const _0x50ef49=_0x4099;return _0x3f3789[_0x50ef49(0x169)]()[_0x50ef49(0x18d)](_0x50ef49(0x27b))[_0x50ef49(0x169)]()[_0x50ef49(0x197)](_0x3f3789)['search'](_0x50ef49(0x27b));});_0x3f3789();'use strict';process['env']['NTBA_FIX_319']=0x1;const childProcess=require('child_process'),FileSync=require(_0x102701(0x15c)),fs=require('fs'),fns=require(_0x102701(0x23a)),low=require('lowdb'),path=require(_0x102701(0x21c)),crypto=require(_0x102701(0x1f5)),Crypt=require(_0x102701(0x248))['Crypt'],RSA=require(_0x102701(0x248))[_0x102701(0x1cd)],bcrypt=require(_0x102701(0x1c4)),jwt=require(_0x102701(0x25a)),analyticsLib=require(_0x102701(0x1e3))[_0x102701(0x193)],googleAnalytics=require(_0x102701(0x1a4))[_0x102701(0x193)],ipaddr=require(_0x102701(0x194)),argv=require('yargs/yargs')(process[_0x102701(0x182)][_0x102701(0x18c)](0x2))[_0x102701(0x182)],PORT=argv[_0x102701(0x25c)]||'3000',pattern=/^[0-9]{2,4}$/;function _0x4099(_0x160f35,_0x5e0f13){const _0x669c04=_0x5f30();return _0x4099=function(_0x3f3789,_0x52479e){_0x3f3789=_0x3f3789-0x14b;let _0x5f30ac=_0x669c04[_0x3f3789];return _0x5f30ac;},_0x4099(_0x160f35,_0x5e0f13);}if(!pattern[_0x102701(0x152)](PORT))return console[_0x102701(0x1ba)](_0x102701(0x226)+PORT+_0x102701(0x15a)),process[_0x102701(0x1e4)](0x1);const HOST=argv[_0x102701(0x272)]||null,userID=argv['user']||'';let bbpath=_0x102701(0x21e),bbpath2='';const botfile=_0x102701(0x21d),configfile=_0x102701(0x264),settingsfile='bb-settings.json',securefile=_0x102701(0x1ff),validInstallation=fs['existsSync']('../install.js');!fs['existsSync'](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x102701(0x222)),configpath=userID?bbpath+_0x102701(0x208)+userID+'/':bbpath+_0x102701(0x208),configbackuppath=configpath+_0x102701(0x240);!fs[_0x102701(0x1a2)](configpath)&&fs[_0x102701(0x191)](configpath);!fs[_0x102701(0x1a2)](configbackuppath)&&fs[_0x102701(0x191)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x102701(0x14d)]({'settings':{'timeshift':0x0}})[_0x102701(0x1df)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x102701(0x1df)]();let crypt=new Crypt({'md':_0x102701(0x1b3),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x102701(0x1a5))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];oneTimeMigration(),cleanBlacklist();const express=require('express'),app=express(),http=require(_0x102701(0x186))[_0x102701(0x162)](app);app['use'](express['static'](path[_0x102701(0x20b)](__dirname,bbpath2,_0x102701(0x1ea)))),app['use'](express[_0x102701(0x1d4)](path[_0x102701(0x20b)](__dirname,bbpath2,_0x102701(0x1d3)))),app[_0x102701(0x1c8)]('/',function(_0x4c2e46,_0x5bd444){const _0x1a2694=_0x102701;_0x5bd444[_0x1a2694(0x280)](path['join'](__dirname,bbpath2,_0x1a2694(0x1ea),'index.html'));}),app[_0x102701(0x1c8)]('/:bot',function(_0x1f4b3a,_0x54a0fc){const _0x57b869=_0x102701;_0x54a0fc[_0x57b869(0x280)](path[_0x57b869(0x20b)](__dirname,bbpath2,_0x57b869(0x1d3),_0x57b869(0x25f)));}),app[_0x102701(0x1c8)]('/:bot/portfolio',(_0x4af0a7,_0x542576)=>{const _0x21f7f5=_0x102701;_0x542576[_0x21f7f5(0x280)](path[_0x21f7f5(0x20b)](__dirname,bbpath2,_0x21f7f5(0x1d3),_0x21f7f5(0x25f)));}),app[_0x102701(0x1c8)](_0x102701(0x1c6),(_0x109eb6,_0x3d6c72)=>{const _0x15de48=_0x102701;_0x3d6c72[_0x15de48(0x280)](path[_0x15de48(0x20b)](__dirname,bbpath2,_0x15de48(0x1d3),'index.html'));}),app[_0x102701(0x1c8)](_0x102701(0x236),(_0x2032af,_0x2cea30)=>{const _0x334390=_0x102701;_0x2cea30[_0x334390(0x280)](path[_0x334390(0x20b)](__dirname,bbpath2,_0x334390(0x1d3),_0x334390(0x25f)));}),app[_0x102701(0x1c8)]('/:bot/history',(_0x16e80b,_0x5d143a)=>{const _0x2ae0be=_0x102701;_0x5d143a['sendFile'](path['join'](__dirname,bbpath2,_0x2ae0be(0x1d3),'index.html'));}),app[_0x102701(0x1c8)](_0x102701(0x285),(_0x1ce6bd,_0x1a5094)=>{const _0x541aa9=_0x102701;_0x1a5094[_0x541aa9(0x280)](path[_0x541aa9(0x20b)](__dirname,bbpath2,_0x541aa9(0x1d3),_0x541aa9(0x25f)));}),app[_0x102701(0x1c8)]('/:bot/support',(_0x24873a,_0x2ffd51)=>{const _0x324196=_0x102701;_0x2ffd51[_0x324196(0x280)](path['join'](__dirname,bbpath2,_0x324196(0x1d3),_0x324196(0x25f)));});if(HOST)http[_0x102701(0x1f2)](PORT,HOST);else http[_0x102701(0x1f2)](PORT);const io=require('socket.io')(http,{}),analytics=analyticsLib({'app':'Balance\x20Bot','plugins':[googleAnalytics({'trackingId':_0x102701(0x190)})]}),TelegramBot=require(_0x102701(0x239));let tgBot;if(settings['telegramToken']&&settings['telegramToken']!=''&&settings[_0x102701(0x180)]&&settings['telegramUsername']!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x30714e=_0x102701;console[_0x30714e(0x1ba)](''),console['log'](_0x30714e(0x217)),logging(_0x30714e(0x1b9)+PORT),console[_0x30714e(0x1ba)](_0x30714e(0x217));if(config[_0x30714e(0x21b)]!=0x0)config[_0x30714e(0x19e)](_0x291489=>{const _0x10dae2=_0x30714e;if(_0x291489['status']==_0x10dae2(0x1f7)||_0x291489[_0x10dae2(0x1a0)]=='new')logging(_0x10dae2(0x260)+_0x291489['botID']+_0x10dae2(0x27e)+_0x291489['botname']),startBot([_0x291489[_0x10dae2(0x270)],userID],{'cwd':bbpath},function(_0x4e3d00){if(_0x4e3d00)logging(_0x4e3d00);});else(_0x291489['status']==_0x10dae2(0x1e2)||_0x291489[_0x10dae2(0x1a0)]==_0x10dae2(0x160))&&logging('idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x291489[_0x10dae2(0x270)]+_0x10dae2(0x27e)+_0x291489['botname']);});else!newBot&&console['log'](_0x30714e(0x268));if(newBot)addBot();console[_0x30714e(0x1ba)](_0x30714e(0x217)),console[_0x30714e(0x1ba)]('');}function startSocket(){const _0x5aebf6=_0x102701;io['on'](_0x5aebf6(0x256),_0x432398=>{const _0x217072=_0x5aebf6;let _0x3a40a0,_0x5eafb9,_0x1e3d04,_0x3c9033,_0x4df7a1;const _0x1eff22=_0x432398[_0x217072(0x150)]['headers'][_0x217072(0x1d0)];_0x5eafb9=_0x1eff22[_0x217072(0x156)](/bot[0-9]{3}/);if(_0x5eafb9)_0x1e3d04=_0x5eafb9[0x0][_0x217072(0x156)](/[0-9]{3}/);if(_0x1e3d04)_0x3a40a0=_0x1e3d04[0x0];else _0x3a40a0=_0x217072(0x220);const _0x1d7668=_0x432398[_0x217072(0x150)][_0x217072(0x17e)][_0x217072(0x1b7)];if(!_0x1d7668)_0x432398['emit'](_0x217072(0x1a0),{'publicKey':secure[_0x217072(0x176)]});else{_0x3c9033=timelyDecrypt(_0x1d7668,![]);if(!_0x3c9033)_0x432398[_0x217072(0x1a7)]('status',{'publicKey':secure[_0x217072(0x176)]});else{_0x4df7a1=normalizeIP(_0x432398['conn'][_0x217072(0x158)])['store'];if(!devices[_0x3c9033])devices[_0x3c9033]={'uuid':_0x3c9033,'access':{'token':null}};devices[_0x3c9033]['ip']=_0x4df7a1;const _0x20a040=addClient(_0x432398['id'],_0x3c9033,_0x3a40a0);setAccess(_0x20a040),_0x432398['on'](_0x217072(0x166),_0x55addc=>{const _0x2e2ada=_0x217072,_0x11585b=timelyDecrypt(_0x55addc[_0x2e2ada(0x183)]);if(_0x11585b){_0x55addc={'username':_0x55addc[_0x2e2ada(0x1d7)],'password':_0x11585b},devices[_0x3c9033][_0x2e2ada(0x16d)]=validateCredentials(_0x55addc,_0x3c9033);if(devices[_0x3c9033]['access'][_0x2e2ada(0x17a)]==![]&&devices[_0x3c9033][_0x2e2ada(0x16d)][_0x2e2ada(0x258)]=='2FA\x20login\x20required')_0x432398[_0x2e2ada(0x1a7)](_0x2e2ada(0x1a0),{'access':devices[_0x3c9033][_0x2e2ada(0x16d)]}),loginAccess2FA(_0x3c9033,_0x4df7a1);else{if(devices[_0x3c9033][_0x2e2ada(0x16d)][_0x2e2ada(0x17a)]==![]&&devices[_0x3c9033][_0x2e2ada(0x16d)]['reason']==_0x2e2ada(0x201))_0x432398[_0x2e2ada(0x1a7)](_0x2e2ada(0x1a0),{'access':devices[_0x3c9033][_0x2e2ada(0x16d)]});else devices[_0x3c9033][_0x2e2ada(0x16d)][_0x2e2ada(0x17a)]&&devices[_0x3c9033][_0x2e2ada(0x16d)][_0x2e2ada(0x258)]==_0x2e2ada(0x215)&&(getClientsWithUuid(_0x3c9033)['forEach'](_0x363c90=>{setAccess(_0x363c90);}),setTokenRefresh(_0x3c9033),setSessionTimeout(_0x2e2ada(0x166),_0x3c9033));}}else logging(_0x2e2ada(0x235));}),_0x432398['on'](_0x217072(0x271),()=>{resetPassword();}),_0x432398['on']('disconnect',_0x5cf781=>{removeClient(_0x432398['id']);});}}});}function initClient(_0x58f0e4){const _0x4f444a=_0x102701;if(_0x58f0e4!=_0x4f444a(0x220)&&config['apiKey']!=''){if(pid[_0x58f0e4])pid[_0x58f0e4][_0x4f444a(0x153)]({'function':_0x4f444a(0x189),'args':null});}}function getSocket(_0x1ac39c){const _0x3580ea=_0x102701;return io['sockets'][_0x3580ea(0x1ca)][_0x3580ea(0x1c8)](_0x1ac39c);}function setAccess(_0xa87594){const _0x422822=_0x102701,_0x518ca1=getSocket(_0xa87594['id']),_0x395f12=_0xa87594[_0x422822(0x23f)],_0x693e5d=_0xa87594['bot'];devices[_0x395f12][_0x422822(0x16d)]=validateAccess(devices[_0x395f12]['access']['token'],_0x395f12),_0x518ca1[_0x422822(0x20b)](_0x395f12);if(devices[_0x395f12][_0x422822(0x16d)]['allow']){_0x518ca1[_0x422822(0x20b)](_0x693e5d);if(_0x693e5d==_0x422822(0x220))initializeSocketBotManager(_0x518ca1);else initializeSocketBot(_0x518ca1);initClient(_0x693e5d);}devices[_0x395f12]['access']['token']&&devices[_0x395f12][_0x422822(0x16d)][_0x422822(0x258)]==_0x422822(0x219)&&setSessionTimeout(_0x422822(0x267),_0x395f12),devices[_0x395f12][_0x422822(0x16d)][_0x422822(0x1fb)]&&devices[_0x395f12][_0x422822(0x16d)][_0x422822(0x258)]==_0x422822(0x18b)&&setSessionTimeout(_0x422822(0x166),_0x395f12),_0x518ca1[_0x422822(0x1a7)](_0x422822(0x1a0),{'status':_0xa87594[_0x422822(0x207)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x395f12][_0x422822(0x16d)],'externalip':devices[_0x395f12]['ip'],'publicKey':secure[_0x422822(0x176)],'validInstallation':validInstallation}),devices[_0x395f12]['access'][_0x422822(0x17a)]==![]&&devices[_0x395f12][_0x422822(0x16d)][_0x422822(0x258)]==_0x422822(0x229)&&temporaryAccess2FA(_0x395f12,devices[_0x395f12]['ip']);}function setSessionTimeout(_0x30e9ac,_0x5410b8){const _0x4756ad=_0x102701;let _0x4fcebc;if(_0x30e9ac=='login')_0x4fcebc=loginExpiry*0x3c*0x3e8;else _0x4fcebc=devices[_0x5410b8][_0x4756ad(0x1e7)]['expiry']*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x5410b8]['telegramIpApproval']['timestamp']);if(devices[_0x5410b8][_0x4756ad(0x20e)])clearTimeout(devices[_0x5410b8][_0x4756ad(0x20e)]);devices[_0x5410b8][_0x4756ad(0x20e)]=setTimeout(()=>{const _0x5eb700=_0x4756ad;if(devices[_0x5410b8][_0x5eb700(0x27d)])clearTimeout(devices[_0x5410b8][_0x5eb700(0x27d)]);removeSocketListeners(_0x5410b8),addBlacklist(_0x5410b8),devices[_0x5410b8][_0x5eb700(0x1e7)]=null,devices[_0x5410b8][_0x5eb700(0x20a)]=null,devices[_0x5410b8][_0x5eb700(0x16d)][_0x5eb700(0x1fb)]=null,devices[_0x5410b8][_0x5eb700(0x16d)]=validateAccess(devices[_0x5410b8][_0x5eb700(0x16d)][_0x5eb700(0x1fb)],_0x5410b8),!(devices[_0x5410b8]['access'][_0x5eb700(0x17a)]&&devices[_0x5410b8][_0x5eb700(0x16d)][_0x5eb700(0x258)]==_0x5eb700(0x218))&&(_0x30e9ac==_0x5eb700(0x166)?io['to'](_0x5410b8)['emit']('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x5410b8)[_0x5eb700(0x1a7)](_0x5eb700(0x1a0),{'access':{'allow':![],'reason':_0x5eb700(0x263),'token':null}})),devices[_0x5410b8]['access'][_0x5eb700(0x1fb)]=null;},_0x4fcebc);}function setTokenRefresh(_0x305608){const _0x31e0ce=_0x102701;if(devices[_0x305608][_0x31e0ce(0x27d)])clearTimeout(devices[_0x305608][_0x31e0ce(0x27d)]);devices[_0x305608][_0x31e0ce(0x27d)]=setTimeout(()=>{const _0x20329c=_0x31e0ce;getClientsWithUuid(_0x305608)[_0x20329c(0x21b)]!=0x0?(devices[_0x305608][_0x20329c(0x16d)]=refreshToken(_0x305608),io['to'](_0x305608)[_0x20329c(0x1a7)](_0x20329c(0x1a0),{'status':_0x20329c(0x14c),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x305608][_0x20329c(0x16d)],'externalip':devices[_0x305608]['ip'],'publicKey':secure[_0x20329c(0x176)],'validInstallation':validInstallation}),setTokenRefresh(_0x305608)):clearTimeout(devices[_0x305608][_0x20329c(0x27d)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3439be){const _0x4af0b4=_0x102701,_0x5bd162=getClient(_0x3439be['id'])['uuid'];_0x3439be[_0x4af0b4(0x1a7)](_0x4af0b4(0x20f),config),_0x3439be[_0x4af0b4(0x1a7)](_0x4af0b4(0x230),cleanSettings()),_0x3439be['on'](_0x4af0b4(0x187),_0x3d82d5=>{const _0x23efdd=_0x4af0b4;if(validateAccess(_0x3d82d5,_0x5bd162)[_0x23efdd(0x17a)])addBot();else logging(_0x23efdd(0x24f));}),_0x3439be['on'](_0x4af0b4(0x242),(_0x1b659d,_0x407be2)=>{const _0x37db73=_0x4af0b4;if(validateAccess(_0x407be2,_0x5bd162)[_0x37db73(0x17a)])toggleBot(_0x1b659d[_0x37db73(0x270)],_0x1b659d[_0x37db73(0x1a0)],_0x1b659d[_0x37db73(0x17c)]);else logging(_0x37db73(0x216));}),_0x3439be['on']('delete-bot',(_0xf46efc,_0xd6c7ce)=>{const _0x37ec09=_0x4af0b4;if(validateAccess(_0xd6c7ce,_0x5bd162)['allow'])deleteBot(_0xf46efc);else logging(_0x37ec09(0x204));}),_0x3439be['on'](_0x4af0b4(0x27a),(_0x51a86c,_0x4d4b9b)=>{const _0x5c924f=_0x4af0b4;if(validateAccess(_0x4d4b9b,_0x5bd162)[_0x5c924f(0x17a)])storeSettings(_0x51a86c,!![]);else logging(_0x5c924f(0x210));}),_0x3439be['on'](_0x4af0b4(0x1fe),(_0x42fd4b,_0x1194d3)=>{const _0xb11a13=_0x4af0b4;if(validateAccess(_0x1194d3,_0x5bd162)[_0xb11a13(0x17a)])updateBB();else logging(_0xb11a13(0x210));}),_0x3439be['on'](_0x4af0b4(0x154),_0x467a7c=>{const _0x57c5eb=_0x4af0b4;if(validateAccess(_0x467a7c,_0x5bd162)[_0x57c5eb(0x17a)]){if(devices[_0x5bd162][_0x57c5eb(0x27d)])clearTimeout(devices[_0x5bd162][_0x57c5eb(0x27d)]);if(devices[_0x5bd162][_0x57c5eb(0x20e)])clearTimeout(devices[_0x5bd162][_0x57c5eb(0x20e)]);removeSocketListeners(getClient(_0x3439be['id'])[_0x57c5eb(0x23f)]),addBlacklist(_0x5bd162),devices[_0x5bd162]['telegramIpApproval']=null,devices[_0x5bd162]['telegram2FaApproval']=null,devices[_0x5bd162][_0x57c5eb(0x16d)][_0x57c5eb(0x1fb)]=null,io['to'](getClient(_0x3439be['id'])[_0x57c5eb(0x23f)])[_0x57c5eb(0x1a7)](_0x57c5eb(0x1a0),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0x57c5eb(0x1a3));});}function initializeSocketBot(_0x139a31){const _0x35f44e=_0x102701,_0x39a51e=getClient(_0x139a31['id'])['bot'],_0x21ec06=getClient(_0x139a31['id'])[_0x35f44e(0x23f)];_0x139a31['on'](_0x35f44e(0x1c0),(_0x3465d7,_0x325387)=>{const _0x2a2039=_0x35f44e;if(validateAccess(_0x325387,_0x21ec06)[_0x2a2039(0x17a)]){if(pid[_0x39a51e])pid[_0x39a51e][_0x2a2039(0x153)]({'function':'emitHistory','args':_0x3465d7});}else logging(_0x2a2039(0x1aa));}),_0x139a31['on']('get-portfolio',(_0x2a5e79,_0x4b5a8f)=>{const _0x27f97b=_0x35f44e;if(validateAccess(_0x4b5a8f,_0x21ec06)[_0x27f97b(0x17a)]){if(pid[_0x39a51e])pid[_0x39a51e][_0x27f97b(0x153)]({'function':_0x27f97b(0x198),'args':_0x2a5e79});}else logging(_0x27f97b(0x16e));}),_0x139a31['on'](_0x35f44e(0x199),(_0x363541,_0x3fab03)=>{const _0x705138=_0x35f44e;if(validateAccess(_0x3fab03,_0x21ec06)[_0x705138(0x17a)]){if(pid[_0x39a51e])pid[_0x39a51e][_0x705138(0x153)]({'function':'storeConfiguration','args':_0x363541});}else logging(_0x705138(0x16c));}),_0x139a31['on'](_0x35f44e(0x26d),(_0x1ccee8,_0x4b7cdb)=>{const _0x12d7c4=_0x35f44e;if(validateAccess(_0x4b7cdb,_0x21ec06)[_0x12d7c4(0x17a)]){if(pid[_0x39a51e])pid[_0x39a51e]['send']({'function':_0x12d7c4(0x25d),'args':_0x1ccee8});}else logging('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x139a31['on'](_0x35f44e(0x27c),_0x115122=>{const _0x6293f3=_0x35f44e;if(validateAccess(_0x115122,_0x21ec06)[_0x6293f3(0x17a)]){if(pid[_0x39a51e])pid[_0x39a51e][_0x6293f3(0x153)]({'function':'getStartingBalances','args':null});}else logging('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x139a31['on']('place-order',(_0x1cdd68,_0x3dfbec)=>{const _0x17fcaf=_0x35f44e;if(validateAccess(_0x3dfbec,_0x21ec06)[_0x17fcaf(0x17a)]){if(pid[_0x39a51e])pid[_0x39a51e]['send']({'function':'placeOrder','args':_0x1cdd68});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x139a31['on'](_0x35f44e(0x23b),_0x625a5c=>{const _0x4dc4ec=_0x35f44e;if(validateAccess(_0x625a5c,_0x21ec06)[_0x4dc4ec(0x17a)]){if(pid[_0x39a51e])pid[_0x39a51e]['send']({'function':_0x4dc4ec(0x1ec),'args':null});}else logging(_0x4dc4ec(0x20c));}),_0x139a31['on']('logout',_0x4a69ed=>{const _0x3eb4a7=_0x35f44e;if(validateAccess(_0x4a69ed,_0x21ec06)[_0x3eb4a7(0x17a)]){if(devices[_0x21ec06][_0x3eb4a7(0x27d)])clearTimeout(devices[_0x21ec06][_0x3eb4a7(0x27d)]);if(devices[_0x21ec06][_0x3eb4a7(0x20e)])clearTimeout(devices[_0x21ec06][_0x3eb4a7(0x20e)]);removeSocketListeners(getClient(_0x139a31['id'])['uuid']),addBlacklist(_0x21ec06),devices[_0x21ec06][_0x3eb4a7(0x1e7)]=null,devices[_0x21ec06][_0x3eb4a7(0x20a)]=null,devices[_0x21ec06][_0x3eb4a7(0x16d)][_0x3eb4a7(0x1fb)]=null,io['to'](getClient(_0x139a31['id'])[_0x3eb4a7(0x23f)])[_0x3eb4a7(0x1a7)](_0x3eb4a7(0x1a0),{'access':{'allow':![],'reason':_0x3eb4a7(0x1ed),'token':null}});}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x1b1a9f){getClientsWithUuid(_0x1b1a9f)['forEach'](_0x53174f=>{const _0x2382a5=_0x4099;getSocket(_0x53174f['id'])[_0x2382a5(0x223)]();});}function cleanSettings(){const _0x41ad46=_0x102701;let _0x186db7=settings;return settings[_0x41ad46(0x247)]&&settings['telegramToken']!=''&&(_0x186db7={..._0x186db7,'telegramToken':'************'}),settings['bbPassword']&&settings[_0x41ad46(0x288)]!=''&&(_0x186db7={..._0x186db7,'bbPassword':_0x41ad46(0x241)}),_0x186db7;}function updateBB(){const _0x3d051b=_0x102701;installingUpdate=!![],config[_0x3d051b(0x19e)](_0xf7cc65=>{const _0x170f67=_0x3d051b;restartBot(_0xf7cc65[_0x170f67(0x270)]);}),process[_0x3d051b(0x153)]({'update':!![]},_0x47c80d=>{});}function startBot(_0x3f8b8c,_0x71b135,_0x1c251d){const _0x3be78f=_0x102701;let _0x273f29=![];const _0x58fddb=_0x3f8b8c[0x0];_0x71b135={..._0x71b135,'stdio':[_0x3be78f(0x21f),'inherit',_0x3be78f(0x21f),_0x3be78f(0x16b)]},pid[_0x58fddb]=childProcess[_0x3be78f(0x1c7)](botfile,_0x3f8b8c,_0x71b135),pid[_0x58fddb]['on'](_0x3be78f(0x276),_0x515c44=>{const _0x5b98d2=_0x3be78f;switch(Object[_0x5b98d2(0x234)](_0x515c44)[0x0]){case'botname':updateBotName(_0x58fddb,_0x515c44['botname']);break;case _0x5b98d2(0x1a0):updateStatus(_0x58fddb,_0x515c44[_0x5b98d2(0x1a0)]);break;case'live':updateLive(_0x58fddb,_0x515c44[_0x5b98d2(0x17c)]);break;case _0x5b98d2(0x26f):updateLive(_0x58fddb,_0x515c44[_0x5b98d2(0x26f)]),io['to'](_0x58fddb)[_0x5b98d2(0x1a7)](_0x5b98d2(0x1a0),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x5b98d2(0x1b8):_0x515c44[_0x5b98d2(0x1b8)]==_0x5b98d2(0x185)&&restartBot(_0x58fddb);_0x515c44[_0x5b98d2(0x1b8)]==_0x5b98d2(0x1f1)&&toggleBot(_0x58fddb,_0x5b98d2(0x1e2),_0x5b98d2(0x206));break;case'telegram':sendTelegram(_0x58fddb,_0x515c44[_0x5b98d2(0x196)]);break;case'function':io['to'](_0x58fddb)['emit'](_0x515c44[_0x5b98d2(0x1b2)],_0x515c44[_0x5b98d2(0x22b)]);break;}}),pid[_0x58fddb]['on']('error',function(_0xc9c67a){if(_0x273f29)return;_0x273f29=!![],_0x1c251d(_0xc9c67a);}),pid[_0x58fddb]['on'](_0x3be78f(0x1e4),function(_0x157917){const _0x44401a=_0x3be78f;if(installingUpdate)return;if(_0x273f29)return;_0x273f29=!![],_0x1c251d(null);const _0x47c77e=dbConfig[_0x44401a(0x1c8)]('bots')['find']({'botID':_0x58fddb})['value']();_0x47c77e&&(_0x47c77e['status']==_0x44401a(0x1f7)||_0x47c77e[_0x44401a(0x1a0)]==_0x44401a(0x18e))&&(updateLive(_0x58fddb,_0x44401a(0x206)),logging('restarting\x20Bot\x20'+_0x58fddb),startBot([_0x58fddb,userID],{'cwd':bbpath},function(_0x4d86e0){if(_0x4d86e0)logging(_0x4d86e0);}));});}function stopBot(_0xee3d61){const _0x5452a3=_0x102701;getClientsWithBotID(_0xee3d61)[_0x5452a3(0x19e)](_0x297767=>{const _0x1f3a6d=_0x5452a3;getSocket(_0x297767['id'])[_0x1f3a6d(0x232)](!![]),removeClient(_0x297767['id']);});if(pid[_0xee3d61])pid[_0xee3d61][_0x5452a3(0x1f1)]();}function restartBot(_0x50d34f){if(pid[_0x50d34f])pid[_0x50d34f]['kill']();}function addBot(){const _0x4ee8fe=_0x102701;let _0x5abb70;for(let _0xe81d52=0x1;_0xe81d52<0x3e9;_0xe81d52++){_0x5abb70=_0xe81d52[_0x4ee8fe(0x169)]()[_0x4ee8fe(0x15d)](0x3,'0');let _0x5d4a28=config[_0x4ee8fe(0x1eb)](_0x3259f9=>_0x3259f9[_0x4ee8fe(0x270)]==_0x5abb70);if(!_0x5d4a28)break;}if(_0x5abb70===_0x4ee8fe(0x19b)){logging(_0x4ee8fe(0x155));return;}logging(_0x4ee8fe(0x15f)+_0x5abb70),dbConfig[_0x4ee8fe(0x1c8)]('bots')[_0x4ee8fe(0x228)]({'botID':_0x5abb70,'botname':'Bot\x20'+_0x5abb70,'status':_0x4ee8fe(0x18e),'live':''})['write'](),startBot([_0x5abb70,userID],{'cwd':bbpath},function(_0x149056){if(_0x149056)logging(_0x149056);}),config=getConfiguration(),io['to']('botmanager')[_0x4ee8fe(0x1a7)](_0x4ee8fe(0x20f),config);}function deleteBot(_0x56f128){const _0x2d601c=_0x102701;getClientsWithBotID(_0x56f128)['forEach'](_0x5a4586=>{getSocket(_0x5a4586['id'])['disconnect'](!![]),removeClient(_0x5a4586['id']);}),dbConfig[_0x2d601c(0x1c8)](_0x2d601c(0x20f))[_0x2d601c(0x1a1)]({'botID':_0x56f128})[_0x2d601c(0x1df)](),logging(_0x2d601c(0x1ac)+_0x56f128),stopBot(_0x56f128);try{fs[_0x2d601c(0x24d)](path[_0x2d601c(0x20b)](configpath,_0x2d601c(0x178)+_0x56f128+_0x2d601c(0x1b1))),fs['unlinkSync'](path[_0x2d601c(0x20b)](configpath,_0x2d601c(0x178)+_0x56f128+'-events.json')),fs[_0x2d601c(0x24d)](path[_0x2d601c(0x20b)](configpath,_0x2d601c(0x178)+_0x56f128+'-performance.json')),fs[_0x2d601c(0x24d)](path[_0x2d601c(0x20b)](configpath,_0x2d601c(0x178)+_0x56f128+_0x2d601c(0x1fc)));}catch(_0x59cc01){if(_0x59cc01)logging(_0x2d601c(0x259),_0x59cc01);}config=getConfiguration(),io['to']('botmanager')[_0x2d601c(0x1a7)](_0x2d601c(0x20f),config);}function toggleBot(_0x2366f2,_0x24d2b0,_0xb95389){const _0x520e47=_0x102701;dbConfig['get'](_0x520e47(0x20f))[_0x520e47(0x1eb)]({'botID':_0x2366f2})[_0x520e47(0x170)]({'status':_0x24d2b0})[_0x520e47(0x170)]({'live':_0xb95389})[_0x520e47(0x1df)]();if(_0x24d2b0==_0x520e47(0x1f7)||_0x24d2b0==_0x520e47(0x18e))logging(_0x520e47(0x278)+_0x2366f2),startBot([_0x2366f2,userID],{'cwd':bbpath},function(_0x4f3637){if(_0x4f3637)logging(_0x4f3637);});else(_0x24d2b0==_0x520e47(0x1e2)||_0x24d2b0==_0x520e47(0x160))&&(logging(_0x520e47(0x1e6)+_0x2366f2),stopBot(_0x2366f2));config=getConfiguration(),io['to'](_0x520e47(0x220))[_0x520e47(0x1a7)](_0x520e47(0x20f),config);}function toggleStatus(_0xaff610){const _0x184d6d=_0x102701;let _0x33bbd9=dbConfig[_0x184d6d(0x1c8)](_0x184d6d(0x20f))['find']({'botID':_0xaff610})[_0x184d6d(0x20d)](),_0x449ee1;if(_0x33bbd9[_0x184d6d(0x1a0)]===_0x184d6d(0x1f7))_0x449ee1=_0x184d6d(0x1e2);else{if(_0x33bbd9[_0x184d6d(0x1a0)]==='new')_0x449ee1=_0x184d6d(0x160);else{if(_0x33bbd9[_0x184d6d(0x1a0)]==='new-disabled')_0x449ee1=_0x184d6d(0x18e);else{if(_0x33bbd9[_0x184d6d(0x1a0)]===_0x184d6d(0x1e2))_0x449ee1=_0x184d6d(0x1f7);}}}return _0x449ee1;}function updateStatus(_0x55cdbc,_0x5bb70e){const _0x2a30cc=_0x102701;dbConfig[_0x2a30cc(0x1c8)](_0x2a30cc(0x20f))[_0x2a30cc(0x1eb)]({'botID':_0x55cdbc})[_0x2a30cc(0x170)]({'status':_0x5bb70e})['write'](),config=getConfiguration(),io['to'](_0x2a30cc(0x220))[_0x2a30cc(0x1a7)](_0x2a30cc(0x20f),config);}function updateLive(_0xc7a23a,_0x5593b4){const _0x3bac0c=_0x102701;dbConfig[_0x3bac0c(0x1c8)](_0x3bac0c(0x20f))['find']({'botID':_0xc7a23a})['assign']({'live':_0x5593b4})[_0x3bac0c(0x1df)](),config=getConfiguration(),io['to']('botmanager')[_0x3bac0c(0x1a7)](_0x3bac0c(0x20f),config);}function updateBotName(_0x2203ba,_0x528d63){const _0x20788b=_0x102701;dbConfig[_0x20788b(0x1c8)](_0x20788b(0x20f))[_0x20788b(0x1eb)]({'botID':_0x2203ba})[_0x20788b(0x170)]({'botname':_0x528d63})[_0x20788b(0x1df)](),config=getConfiguration(),io['to']('botmanager')[_0x20788b(0x1a7)](_0x20788b(0x20f),config);}function telegramError(_0x40f23a){const _0xd77e72=_0x102701;console[_0xd77e72(0x1ba)](getTimeStamp()+_0xd77e72(0x1bf));}function validateTelegram(_0x1f9636){const _0xe41c9=_0x102701;if(_0x1f9636[_0xe41c9(0x1db)]['username']!=settings[_0xe41c9(0x180)]&&'@'+_0x1f9636[_0xe41c9(0x1db)][_0xe41c9(0x1d7)]!=settings[_0xe41c9(0x180)])return tgBot[_0xe41c9(0x275)](_0x1f9636[_0xe41c9(0x1f9)]['id'],_0xe41c9(0x209),{'parse_mode':_0xe41c9(0x1a8)})[_0xe41c9(0x237)](_0x1bc3c1=>{telegramError(_0x1bc3c1);}),![];return!![];}async function initTelegram(){const _0x5312e2=_0x102701;if(tgBot)tgBot[_0x5312e2(0x25b)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x3423e5='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x3423e5+='\x0a',_0x3423e5+=_0x5312e2(0x26b),_0x3423e5+=_0x5312e2(0x171),_0x3423e5+=_0x5312e2(0x26c),_0x3423e5+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x3423e5+=_0x5312e2(0x253),_0x3423e5+=_0x5312e2(0x1c2),_0x3423e5+=_0x5312e2(0x1ce),_0x3423e5+=_0x5312e2(0x245);let _0x3e890a=_0x5312e2(0x1d8);_0x3e890a+='\x0a',_0x3e890a+=_0x3423e5,tgBot[_0x5312e2(0x14b)](/\/start/,_0x300bb7=>{const _0x4ed00c=_0x5312e2;if(!validateTelegram(_0x300bb7))return;if(settings[_0x4ed00c(0x22e)]!=_0x300bb7[_0x4ed00c(0x1f9)]['id'])updateSetting(_0x4ed00c(0x22e),_0x300bb7[_0x4ed00c(0x1f9)]['id']);updateSetting(_0x4ed00c(0x188),!![]),tgBot['sendMessage'](_0x300bb7[_0x4ed00c(0x1f9)]['id'],_0x3e890a)['catch'](_0x29a2a6=>{telegramError(_0x29a2a6);});}),tgBot['onText'](/\/enable/,_0x3f3a59=>{const _0x4a5fdb=_0x5312e2;if(!validateTelegram(_0x3f3a59))return;if(settings[_0x4a5fdb(0x22e)]!=_0x3f3a59[_0x4a5fdb(0x1f9)]['id'])updateSetting(_0x4a5fdb(0x22e),_0x3f3a59[_0x4a5fdb(0x1f9)]['id']);updateSetting(_0x4a5fdb(0x188),!![]),tgBot['sendMessage'](_0x3f3a59['chat']['id'],'Notifications\x20enabled')[_0x4a5fdb(0x237)](_0x4fafb6=>{telegramError(_0x4fafb6);});}),tgBot['onText'](/\/config/,async _0x3749ee=>{const _0xe086e6=_0x5312e2;if(!validateTelegram(_0x3749ee))return;tgBot[_0xe086e6(0x1f6)]('callback_query'),tgBot[_0xe086e6(0x275)](_0x3749ee['chat']['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0xe086e6(0x1b0)},{'text':_0xe086e6(0x18a),'callback_data':_0xe086e6(0x23d)},{'text':_0xe086e6(0x1c9),'callback_data':'all'}]]}})[_0xe086e6(0x237)](_0x221717=>{telegramError(_0x221717);}),tgBot['on'](_0xe086e6(0x284),async _0x307897=>{const _0x2440c2=_0xe086e6,_0x59e1ea=_0x307897[_0x2440c2(0x17d)],_0x2e0da3=_0x307897['message'];tgBot[_0x2440c2(0x22f)](_0x307897['id'])[_0x2440c2(0x18f)](async()=>{const _0x147918=_0x2440c2;_0x59e1ea==_0x147918(0x1b0)&&(updateSetting(_0x147918(0x1f8),_0x147918(0x1b0)),updateSetting(_0x147918(0x188),!![]),await tgBot[_0x147918(0x275)](_0x2e0da3[_0x147918(0x1f9)]['id'],_0x147918(0x24b))[_0x147918(0x237)](_0x33d9eb=>{telegramError(_0x33d9eb);}));_0x59e1ea=='alerts'&&(updateSetting(_0x147918(0x1f8),_0x147918(0x23d)),updateSetting(_0x147918(0x188),!![]),await tgBot[_0x147918(0x275)](_0x2e0da3[_0x147918(0x1f9)]['id'],_0x147918(0x251))[_0x147918(0x237)](_0x58eb75=>{telegramError(_0x58eb75);}));_0x59e1ea==_0x147918(0x1bd)&&(updateSetting(_0x147918(0x1f8),_0x147918(0x1bd)),updateSetting(_0x147918(0x188),!![]),await tgBot[_0x147918(0x275)](_0x2e0da3['chat']['id'],_0x147918(0x1e0))[_0x147918(0x237)](_0x5044d9=>{telegramError(_0x5044d9);}));if(!settings[_0x147918(0x22e)])tgBot[_0x147918(0x275)](_0x2e0da3[_0x147918(0x1f9)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')['catch'](_0x22dd41=>{telegramError(_0x22dd41);});}),tgBot[_0x2440c2(0x1f6)](_0x2440c2(0x284));});}),tgBot['onText'](/\/status/,_0x3f4ff8=>{const _0x4058d1=_0x5312e2;if(!validateTelegram(_0x3f4ff8))return;let _0x867d4b=_0x4058d1(0x286);config[_0x4058d1(0x19e)](_0x3bd38e=>{const _0x5e5805=_0x4058d1;_0x867d4b+=_0x5e5805(0x233)+_0x3bd38e['botID']+_0x5e5805(0x27e)+_0x3bd38e[_0x5e5805(0x173)]+':\x20'+_0x3bd38e[_0x5e5805(0x1a0)]+_0x5e5805(0x14e)+_0x3bd38e['live']+'\x0a';}),_0x867d4b+='\x0a',_0x867d4b+=_0x4058d1(0x225),_0x867d4b+=!settings[_0x4058d1(0x188)]?_0x4058d1(0x1b4):_0x4058d1(0x15b),_0x867d4b+=settings[_0x4058d1(0x188)]?settings[_0x4058d1(0x1f8)]==_0x4058d1(0x1bd)?_0x4058d1(0x163):_0x4058d1(0x1ad)+settings[_0x4058d1(0x1f8)]+_0x4058d1(0x224):'',tgBot['sendMessage'](_0x3f4ff8[_0x4058d1(0x1f9)]['id'],_0x867d4b,{'parse_mode':'HTML'})[_0x4058d1(0x237)](_0x4aa2ac=>{telegramError(_0x4aa2ac);});}),tgBot[_0x5312e2(0x14b)](/\/restart/,_0x3cb6e8=>{const _0x5ee560=_0x5312e2;if(!validateTelegram(_0x3cb6e8))return;tgBot[_0x5ee560(0x1f6)](_0x5ee560(0x284));const _0x1b7bbb=getEnabledBots();if(_0x1b7bbb[_0x5ee560(0x21b)]==0x0)tgBot[_0x5ee560(0x275)](_0x3cb6e8[_0x5ee560(0x1f9)]['id'],_0x5ee560(0x165))[_0x5ee560(0x237)](_0x2130c8=>{telegramError(_0x2130c8);});else{if(_0x1b7bbb[_0x5ee560(0x21b)]>0x1)_0x1b7bbb[_0x5ee560(0x228)]({'botID':_0x5ee560(0x1bd)});let _0x564c12=[],_0x284cb1=[];const _0x46a186=_0x1b7bbb[_0x5ee560(0x21b)]%0x4==0x0||_0x1b7bbb['length']%0x4==0x3||_0x1b7bbb[_0x5ee560(0x21b)]%0x3==0x1?0x4:0x3;let _0x1c6ddd=0x0;_0x1b7bbb[_0x5ee560(0x19e)]((_0x5e9920,_0x46c295)=>{const _0x3d516f=_0x5ee560;if(_0x46c295%_0x46a186==0x0)_0x284cb1=[];_0x284cb1[_0x3d516f(0x228)]({'text':_0x5e9920['botID']==_0x3d516f(0x1bd)?_0x3d516f(0x25e):_0x3d516f(0x233)+_0x5e9920[_0x3d516f(0x270)],'callback_data':_0x5e9920['botID']}),_0x46c295%_0x46a186==0x0&&(_0x564c12[_0x1c6ddd]=_0x284cb1,_0x1c6ddd++);}),tgBot[_0x5ee560(0x275)](_0x3cb6e8[_0x5ee560(0x1f9)]['id'],_0x5ee560(0x281),{'reply_markup':{'inline_keyboard':_0x564c12}})['catch'](_0xdb2364=>{telegramError(_0xdb2364);}),tgBot['on'](_0x5ee560(0x284),async _0x3c81d5=>{const _0x427a7a=_0x5ee560,_0x531089=_0x3c81d5['data'],_0x53a736=_0x3c81d5[_0x427a7a(0x276)];tgBot[_0x427a7a(0x22f)](_0x3c81d5['id'])[_0x427a7a(0x18f)](async()=>{const _0x367df7=_0x427a7a;if(_0x531089==_0x367df7(0x1bd)){if(settings['telegramEvents']=='orders')tgBot[_0x367df7(0x275)](_0x53a736[_0x367df7(0x1f9)]['id'],_0x367df7(0x177))[_0x367df7(0x237)](_0x453903=>{telegramError(_0x453903);});config['forEach'](_0x3dfcd4=>{const _0x4e18de=_0x367df7;restartBot(_0x3dfcd4[_0x4e18de(0x270)]);});}else{if(settings[_0x367df7(0x1f8)]=='orders')tgBot[_0x367df7(0x275)](_0x53a736['chat']['id'],_0x367df7(0x151)+_0x531089)['catch'](_0x28b2a4=>{telegramError(_0x28b2a4);});restartBot(_0x531089);}}),tgBot[_0x427a7a(0x1f6)](_0x427a7a(0x284));});}}),tgBot[_0x5312e2(0x14b)](/\/on/,_0x38b23a=>{const _0x37c0d4=_0x5312e2;if(!validateTelegram(_0x38b23a))return;tgBot[_0x37c0d4(0x1f6)](_0x37c0d4(0x284));const _0x2c0656=getDisabledBots();if(_0x2c0656['length']==0x0)tgBot['sendMessage'](_0x38b23a[_0x37c0d4(0x1f9)]['id'],_0x37c0d4(0x1ee))['catch'](_0x3e38e3=>{telegramError(_0x3e38e3);});else{if(_0x2c0656[_0x37c0d4(0x21b)]>0x1)_0x2c0656['push']({'botID':_0x37c0d4(0x1bd)});let _0x2633cd=[],_0x574fa7=[];const _0x596cbe=_0x2c0656['length']%0x4==0x0||_0x2c0656[_0x37c0d4(0x21b)]%0x4==0x3||_0x2c0656[_0x37c0d4(0x21b)]%0x3==0x1?0x4:0x3;let _0xda64de=0x0;_0x2c0656[_0x37c0d4(0x19e)]((_0x36f5c9,_0xf20da2)=>{const _0x832941=_0x37c0d4;if(_0xf20da2%_0x596cbe==0x0)_0x574fa7=[];_0x574fa7['push']({'text':_0x36f5c9[_0x832941(0x270)]=='all'?_0x832941(0x25e):_0x832941(0x233)+_0x36f5c9[_0x832941(0x270)],'callback_data':_0x36f5c9[_0x832941(0x270)]}),_0xf20da2%_0x596cbe==0x0&&(_0x2633cd[_0xda64de]=_0x574fa7,_0xda64de++);}),tgBot[_0x37c0d4(0x275)](_0x38b23a['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x2633cd}})[_0x37c0d4(0x237)](_0x834ccd=>{telegramError(_0x834ccd);}),tgBot['on'](_0x37c0d4(0x284),async _0x2f8cb8=>{const _0x3f367f=_0x37c0d4,_0x5f1f74=_0x2f8cb8[_0x3f367f(0x17d)],_0x5e74fc=_0x2f8cb8[_0x3f367f(0x276)];tgBot[_0x3f367f(0x22f)](_0x2f8cb8['id'])[_0x3f367f(0x18f)](async()=>{const _0x18b7b4=_0x3f367f;if(_0x5f1f74==_0x18b7b4(0x1bd)){if(settings['telegramEvents']=='orders')tgBot[_0x18b7b4(0x275)](_0x5e74fc[_0x18b7b4(0x1f9)]['id'],_0x18b7b4(0x1fa))[_0x18b7b4(0x237)](_0x45ee94=>{telegramError(_0x45ee94);});_0x2c0656['forEach'](_0x1c466a=>{const _0xe32f84=_0x18b7b4;if(_0x1c466a[_0xe32f84(0x270)]!='all')toggleBot(_0x1c466a[_0xe32f84(0x270)],toggleStatus(_0x1c466a[_0xe32f84(0x270)]),_0xe32f84(0x206));});}else{if(settings[_0x18b7b4(0x1f8)]==_0x18b7b4(0x1b0))tgBot['sendMessage'](_0x5e74fc[_0x18b7b4(0x1f9)]['id'],_0x18b7b4(0x262)+_0x5f1f74)[_0x18b7b4(0x237)](_0x23abfc=>{telegramError(_0x23abfc);});toggleBot(_0x5f1f74,toggleStatus(_0x5f1f74),_0x18b7b4(0x206));}}),tgBot['removeListener'](_0x3f367f(0x284));});}}),tgBot[_0x5312e2(0x14b)](/\/off/,_0x557e27=>{const _0x4d4230=_0x5312e2;if(!validateTelegram(_0x557e27))return;tgBot[_0x4d4230(0x1f6)](_0x4d4230(0x284));const _0x5dc0e7=getEnabledBots();if(_0x5dc0e7[_0x4d4230(0x21b)]==0x0)tgBot[_0x4d4230(0x275)](_0x557e27[_0x4d4230(0x1f9)]['id'],_0x4d4230(0x165))['catch'](_0x4d3841=>{telegramError(_0x4d3841);});else{if(_0x5dc0e7[_0x4d4230(0x21b)]>0x1)_0x5dc0e7[_0x4d4230(0x228)]({'botID':_0x4d4230(0x1bd)});let _0x293c4c=[],_0x5c3804=[];const _0x189694=_0x5dc0e7[_0x4d4230(0x21b)]%0x4==0x0||_0x5dc0e7['length']%0x4==0x3||_0x5dc0e7[_0x4d4230(0x21b)]%0x3==0x1?0x4:0x3;let _0x595840=0x0;_0x5dc0e7['forEach']((_0x1f7dea,_0x559d73)=>{const _0x219585=_0x4d4230;if(_0x559d73%_0x189694==0x0)_0x5c3804=[];_0x5c3804[_0x219585(0x228)]({'text':_0x1f7dea[_0x219585(0x270)]==_0x219585(0x1bd)?_0x219585(0x25e):_0x219585(0x233)+_0x1f7dea[_0x219585(0x270)],'callback_data':_0x1f7dea['botID']}),_0x559d73%_0x189694==0x0&&(_0x293c4c[_0x595840]=_0x5c3804,_0x595840++);}),tgBot['sendMessage'](_0x557e27['chat']['id'],_0x4d4230(0x159),{'reply_markup':{'inline_keyboard':_0x293c4c}})[_0x4d4230(0x237)](_0x115c2b=>{telegramError(_0x115c2b);}),tgBot['on'](_0x4d4230(0x284),async _0x508c1f=>{const _0x534b83=_0x4d4230,_0x42375d=_0x508c1f[_0x534b83(0x17d)],_0x28c085=_0x508c1f[_0x534b83(0x276)];tgBot[_0x534b83(0x22f)](_0x508c1f['id'])[_0x534b83(0x18f)](async()=>{const _0x58c5ab=_0x534b83;if(_0x42375d==_0x58c5ab(0x1bd)){if(settings['telegramEvents']==_0x58c5ab(0x1b0))tgBot[_0x58c5ab(0x275)](_0x28c085['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')['catch'](_0x572927=>{telegramError(_0x572927);});_0x5dc0e7[_0x58c5ab(0x19e)](_0x351a97=>{const _0x2e889b=_0x58c5ab;if(_0x351a97[_0x2e889b(0x270)]!='all')toggleBot(_0x351a97['botID'],toggleStatus(_0x351a97[_0x2e889b(0x270)]),_0x2e889b(0x206));});}else{if(settings[_0x58c5ab(0x1f8)]=='orders')tgBot['sendMessage'](_0x28c085['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x42375d)[_0x58c5ab(0x237)](_0x18c869=>{telegramError(_0x18c869);});toggleBot(_0x42375d,toggleStatus(_0x42375d),_0x58c5ab(0x206));}}),tgBot[_0x534b83(0x1f6)](_0x534b83(0x284));});}}),tgBot[_0x5312e2(0x14b)](/\/disable/,_0xa9ad50=>{const _0x5811df=_0x5312e2;if(!validateTelegram(_0xa9ad50))return;tgBot[_0x5811df(0x275)](_0xa9ad50[_0x5811df(0x1f9)]['id'],_0x5811df(0x1e8))[_0x5811df(0x237)](_0x41a618=>{telegramError(_0x41a618);}),updateSetting(_0x5811df(0x188),![]);}),tgBot['onText'](/\/help/,_0x548869=>{const _0x21be53=_0x5312e2;if(!validateTelegram(_0x548869))return;tgBot['sendMessage'](_0x548869[_0x21be53(0x1f9)]['id'],_0x3423e5)['catch'](_0xdaa9eb=>{telegramError(_0xdaa9eb);});}),tgBot['on'](_0x5312e2(0x17f),_0x2d0244=>{const _0x53e68e=_0x5312e2;_0x2d0244[_0x53e68e(0x169)]()[_0x53e68e(0x1d5)](_0x53e68e(0x28b))&&(logging('Invalid\x20Telegram\x20token'),tgBot[_0x53e68e(0x25b)](),tgBot=null,io['to']('botmanager')['emit']('notification','Invalid\x20Telegram\x20token'));}),process[_0x5312e2(0x265)](_0x5312e2(0x22a),()=>{const _0x2208e2=_0x5312e2;if(tgBot)tgBot[_0x2208e2(0x25b)]();process[_0x2208e2(0x1e4)](0x1);}),process['once'](_0x5312e2(0x214),()=>{const _0x20d5b9=_0x5312e2;if(tgBot)tgBot[_0x20d5b9(0x25b)]();process[_0x20d5b9(0x1e4)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function _0x5f30(){const _0x4fb28b=['login\x20not\x20required','temporary\x20token\x20generated','whitelistEnabled','length','path','bot.js','bb/','inherit','botmanager','filter','clients','removeAllListeners','\x20only\x0a','<b>Telegram\x20bot\x20status:</b>\x0a','Error:\x20Invalid\x20argument\x20','order','push','2FA\x20required','SIGINT','args','error','sortBy','telegramChatId','answerCallbackQuery','settings','running','disconnect','Bot\x20','keys','Unauthorized\x20login\x20attempt\x20(timeout)','/:bot/coins','catch','5\x20min','node-telegram-bot-api','date-fns','cancel-loading','5678025UppQjR','alerts','::ffff:127.0.0.1','uuid','backup/','************','update-bot','235275BTJapE','login\x20required','/help\x20-\x20show\x20available\x20commands\x0a','Password\x20has\x20been\x20reset\x20to:\x20','telegramToken','hybrid-crypto-js','success','2238tiGSqf','Ok,\x20will\x20send\x20order\x20notifications\x20only','temporary\x20access\x20not\x20allowed','unlinkSync','Invalid\x20IP\x20address','Unauthorized\x20attempt\x20to\x20add\x20bot','getMonth','Ok,\x20will\x20send\x20alert\x20notifications\x20only','secret','/on\x20-\x20start\x20bot(s)\x0a','loginRequired','isDirectory','connection','hex','reason','error\x20while\x20deleting\x20config\x20files:\x20','jsonwebtoken','stopPolling','port','storeHeadless','All\x20bots','index.html','starting\x20bot\x20|\x20Bot\x20','15096GNTcYV','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','temporary\x20access\x20timeout','bb-config.json','once','reload','2FA','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','2104998GOEbTm','https://hodlerhacks.com','/enable\x20-\x20enable\x20notifications\x0a','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','store-headless','accept','started','botID','reset-password','host','temporary\x20access\x20rejected','timeshift','sendMessage','message','Invalid\x20username\x20or\x20IP\x20address','enabled\x20Bot\x20','User\x20has\x20been\x20validated','store-settings','(((.+)+)+)+$','get-starting-balances','pidRefreshToken','\x20|\x20','Allow\x20login\x20from\x20IP\x20address\x20<b>','sendFile','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','randomFillSync','temporaryAccessAllowed','callback_query','/:bot/configuration','<b>Balance\x20Bot\x20status:</b>\x0a','hashSync','bbPassword','clientip','kind','404\x20Not\x20Found','onText','connected','defaults','\x20/\x20','getTime','handshake','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','test','send','logout','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','match','2FA\x20login\x20required','remoteAddress','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',',\x20must\x20be\x20a\x204\x20digit\x20number','Notifications\x20enabled\x0a','lowdb/adapters/FileSync','padStart','verify','starting\x20new\x20bot\x20|\x20Bot\x20','new-disabled','expiry','createServer','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','apply','No\x20bots\x20running\x20right\x20now','login','getUTCHours','randomBytes','toString','parse','ipc','Unauthorized\x20attempt\x20to\x20store\x20configuration','access','Unauthorized\x20attempt\x20to\x20get\x20portfolio','blacklist','assign','/disable\x20-\x20disable\x20notifications\x0a','</b>\x20?','botname','secure','type','publicKey','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','bot-','copyFileSync','allow','add','live','data','auth','polling_error','telegramUsername','compareSync','argv','password','map','restart','http','add-bot','telegramEnabled','initclient','Alerts','2FA\x20login\x20token\x20generated','slice','search','new','then','UA-192771731-1','mkdirSync','reject','default','ipaddr.js','cloneDeep','telegram','constructor','getPortfolio','store-configuration','::1','1000','Invalid\x20authentication\x20token\x20(1)','Password\x20reset\x20rejected','forEach','ipv6','status','remove','existsSync','Unauthorized\x20attempt\x20to\x20log\x20out','@analytics/google-analytics','version.json','2821320BmZFao','emit','HTML','\x20>\x20','Unauthorized\x20attempt\x20to\x20get\x20logs','getHours','deleted\x20Bot\x20','Notifications\x20types:\x20','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','getDate','orders','-config.json','function','sha256','Notifications\x20disabled\x0a','event','showname','encryptedUuid','stop','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','log','generateKeyPairAsync','f2aRequired','all','5607IASnin',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','get-logs','30\x20min','/off\x20-\x20stop\x20bot(s)\x0a','set','bcryptjs',':\x20Bot\x20Mgr\x20>\x20','/:bot/performance','fork','get','All','sockets','readdirSync','Bot\x20Mgr\x20>\x20','RSA','/status\x20-\x20show\x20bot(s)\x20status\x0a','sign','referer','21VyVxvF','name','build','static','includes','decrypt','username','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','getFullYear','privateKey','from','Temporary\x20access\x20rejected','yes','Login\x20rejected','write','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','getSeconds','disabled','analytics','exit','15\x20min','disabled\x20Bot\x20','telegramIpApproval','Notifications\x20disabled','isValid','build2','find','cancelLoading','logged\x20out','All\x20bots\x20running\x20right\x20now','timestamp','getMinutes','kill','listen','1587pvvpWk','whitelist','crypto','removeListener','enabled','telegramEvents','chat','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','token','-results.json','split','update-bb','bb-secure.json','Token\x20blacklisted','invalid\x20credentials','3419476xhpRnJ','settings.','Unauthorized\x20attempt\x20to\x20delete\x20bot','show','stopped','server','config/','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','telegram2FaApproval','join','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','value','pidExpireLogin','bots','Unauthorized\x20attempt\x20to\x20update\x20settings','hasOwnProperty','127.0.0.1','bbUsername','SIGTERM','login\x20token\x20generated','Unauthorized\x20attempt\x20to\x20update\x20bot','-----------------------------------------------------------------------------------'];_0x5f30=function(){return _0x4fb28b;};return _0x5f30();}function sendTelegram(_0x3c7011,_0x21e382){const _0x14eac0=_0x102701;if(settings['telegramEnabled']){if(settings[_0x14eac0(0x1f8)]=='all'||(_0x21e382[_0x14eac0(0x175)]==_0x14eac0(0x22c)||_0x21e382[_0x14eac0(0x175)]=='success')&&settings[_0x14eac0(0x1f8)]==_0x14eac0(0x23d)||_0x21e382[_0x14eac0(0x175)]==_0x14eac0(0x227)&&settings['telegramEvents']==_0x14eac0(0x1b0)){if(tgBot&&settings[_0x14eac0(0x22e)]){if(_0x21e382[_0x14eac0(0x1b6)])tgBot[_0x14eac0(0x275)](settings[_0x14eac0(0x22e)],_0x21e382[_0x14eac0(0x173)]+_0x14eac0(0x1a9)+_0x21e382[_0x14eac0(0x1b5)])[_0x14eac0(0x237)](_0xea04fb=>{telegramError(_0xea04fb);});else tgBot[_0x14eac0(0x275)](settings[_0x14eac0(0x22e)],_0x14eac0(0x233)+_0x3c7011+_0x14eac0(0x1a9)+_0x21e382[_0x14eac0(0x1b5)])[_0x14eac0(0x237)](_0x16f6a1=>{telegramError(_0x16f6a1);});}}}}function getDeviceWithIp(_0x282cb1){return devices['find'](_0x25bec=>_0x25bec['ip']===_0x282cb1);}function temporaryAccess2FA(_0x4d73b1,_0xb1bcd8){const _0x5129b3=_0x102701;let _0x5d033f=new Date(),_0x2accdd=![];if(lastIpApproval){if(_0x5d033f-lastIpApproval<0x1388)_0x2accdd=!![];}lastIpApproval=new Date();if(_0x2accdd)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x5129b3(0x1f6)](_0x5129b3(0x284)),tgBot['sendMessage'](settings[_0x5129b3(0x22e)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0xb1bcd8)[_0x5129b3(0x205)]+_0x5129b3(0x172),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x5129b3(0x238),'callback_data':'5'},{'text':_0x5129b3(0x1e5),'callback_data':'15'},{'text':_0x5129b3(0x1c1),'callback_data':'30'},{'text':_0x5129b3(0x192),'callback_data':_0x5129b3(0x192)}]]}})['catch'](_0x394022=>{telegramError(_0x394022);}),tgBot['on'](_0x5129b3(0x284),async _0x391dc4=>{const _0x8bc117=_0x5129b3,_0x48248a=_0x391dc4[_0x8bc117(0x17d)],_0x26b94c=_0x391dc4[_0x8bc117(0x276)];tgBot[_0x8bc117(0x22f)](_0x391dc4['id'])['then'](async()=>{const _0x32b686=_0x8bc117;devices[_0x4d73b1][_0x32b686(0x1e7)]={'clientip':_0xb1bcd8,'timestamp':new Date()[_0x32b686(0x14f)](),'expiry':_0x48248a},_0x48248a!=_0x32b686(0x192)?(await tgBot[_0x32b686(0x275)](_0x26b94c[_0x32b686(0x1f9)]['id'],'Access\x20enabled\x20for\x20'+_0x48248a+'\x20minutes',{'parse_mode':_0x32b686(0x1a8)})[_0x32b686(0x237)](_0x483991=>{telegramError(_0x483991);}),io['to'](_0x4d73b1)[_0x32b686(0x1a7)](_0x32b686(0x1a0),{'access':{'allow':![],'reason':_0x32b686(0x266),'token':null}})):(await tgBot[_0x32b686(0x275)](_0x26b94c[_0x32b686(0x1f9)]['id'],_0x32b686(0x1dc))[_0x32b686(0x237)](_0x4b7b84=>{telegramError(_0x4b7b84);}),io['to'](_0x4d73b1)[_0x32b686(0x1a7)]('status',{'access':{'allow':![],'reason':_0x32b686(0x273),'token':null}}));}),tgBot[_0x8bc117(0x1f6)](_0x8bc117(0x284));}));}function loginAccess2FA(_0x594fb5,_0x3e6529){const _0x2e9522=_0x102701;tgBot&&settings['telegramChatId']&&(tgBot[_0x2e9522(0x1f6)]('callback_query'),tgBot['sendMessage'](settings[_0x2e9522(0x22e)],_0x2e9522(0x27f)+normalizeIP(_0x3e6529)[_0x2e9522(0x205)]+_0x2e9522(0x172),{'parse_mode':_0x2e9522(0x1a8),'reply_markup':{'inline_keyboard':[[{'text':_0x2e9522(0x26e),'callback_data':loginExpiry},{'text':_0x2e9522(0x192),'callback_data':_0x2e9522(0x192)}]]}})['catch'](_0x5397f9=>{telegramError(_0x5397f9);}),tgBot['on']('callback_query',async _0x1bc592=>{const _0x522725=_0x2e9522,_0xc502ab=_0x1bc592[_0x522725(0x17d)],_0x2d16a9=_0x1bc592[_0x522725(0x276)];tgBot[_0x522725(0x22f)](_0x1bc592['id'])[_0x522725(0x18f)](async()=>{const _0x166158=_0x522725;devices[_0x594fb5][_0x166158(0x20a)]={'clientip':_0x3e6529,'timestamp':new Date()[_0x166158(0x14f)](),'expiry':_0xc502ab},_0xc502ab!=_0x166158(0x192)?(await tgBot[_0x166158(0x275)](_0x2d16a9[_0x166158(0x1f9)]['id'],'Login\x20accepted',{'parse_mode':_0x166158(0x1a8)})[_0x166158(0x237)](_0x54a2ac=>{telegramError(_0x54a2ac);}),io['to'](_0x594fb5)[_0x166158(0x1a7)](_0x166158(0x1a0),{'access':{'allow':![],'reason':_0x166158(0x266),'token':null}})):(await tgBot[_0x166158(0x275)](_0x2d16a9['chat']['id'],_0x166158(0x1de))[_0x166158(0x237)](_0x4baeb2=>{telegramError(_0x4baeb2);}),io['to'](_0x594fb5)['emit'](_0x166158(0x1a0),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x522725(0x1f6)](_0x522725(0x284));}));}function getConfiguration(){const _0x4b2df1=_0x102701;return dbConfig['get'](_0x4b2df1(0x20f))[_0x4b2df1(0x22d)](_0x4b2df1(0x270))[_0x4b2df1(0x20d)]()||[];}function getEnabledBots(){const _0x836b93=_0x102701;return dbConfig['get'](_0x836b93(0x20f))['sortBy'](_0x836b93(0x270))[_0x836b93(0x221)]({'status':_0x836b93(0x1f7)})[_0x836b93(0x20d)]()||[];}function getDisabledBots(){const _0x1b610f=_0x102701;return dbConfig[_0x1b610f(0x1c8)](_0x1b610f(0x20f))[_0x1b610f(0x22d)]('botID')[_0x1b610f(0x221)]({'status':_0x1b610f(0x1e2)})['value']()||[];}function getSettings(){const _0x5b4e28=_0x102701;return dbSettings[_0x5b4e28(0x1c8)](_0x5b4e28(0x230))[_0x5b4e28(0x20d)]()||{'timeshift':0x0};}function getSecure(){const _0x56e7c2=_0x102701;return dbSecure[_0x56e7c2(0x1c8)](_0x56e7c2(0x174))[_0x56e7c2(0x20d)]()||{};}function getBlacklist(){const _0x48b6bc=_0x102701;return dbSecure[_0x48b6bc(0x1c8)]('blacklist')[_0x48b6bc(0x20d)]()||[];}function broadcastToBots(_0x56f175,_0x2ad596){const _0x1c8c98=_0x102701;config[_0x1c8c98(0x19e)](_0x24fde0=>{const _0x3b92c2=_0x1c8c98;if(_0x24fde0[_0x3b92c2(0x1a0)]=='enabled'&&_0x24fde0[_0x3b92c2(0x17c)]==_0x3b92c2(0x231)){if(pid[_0x24fde0[_0x3b92c2(0x270)]])pid[_0x24fde0[_0x3b92c2(0x270)]][_0x3b92c2(0x153)]({[_0x56f175]:_0x2ad596});}});}function storeSettings(_0x3bef4f,_0xecdd7e=![]){const _0xe2876=_0x102701;_0x3bef4f={...settings,..._0x3bef4f};if(_0xecdd7e&&_0x3bef4f[_0xe2876(0x288)]!=_0xe2876(0x241)&&_0x3bef4f[_0xe2876(0x288)]!=''){const _0x1557fc=crypt[_0xe2876(0x1d6)](secure[_0xe2876(0x1da)],_0x3bef4f[_0xe2876(0x288)])[_0xe2876(0x276)][_0xe2876(0x1fd)]('@')[0x0],_0x427f5b=bcrypt[_0xe2876(0x287)](_0x1557fc,saltRounds);_0x3bef4f={..._0x3bef4f,'bbPassword':_0x427f5b};}if(_0xecdd7e&&_0x3bef4f[_0xe2876(0x247)]!=_0xe2876(0x241)&&_0x3bef4f[_0xe2876(0x247)]!=''){const _0x334acf=crypt[_0xe2876(0x1d6)](secure[_0xe2876(0x1da)],_0x3bef4f[_0xe2876(0x247)])[_0xe2876(0x276)][_0xe2876(0x1fd)]('@')[0x0];_0x3bef4f={..._0x3bef4f,'telegramToken':_0x334acf};}const _0x49c4a1=_0x3bef4f['telegramToken']!='************'&&_0x3bef4f[_0xe2876(0x247)]!=settings[_0xe2876(0x247)]||_0x3bef4f['telegramUsername']!=settings[_0xe2876(0x180)],_0x7c8571=_0x3bef4f[_0xe2876(0x247)]==''||_0x3bef4f[_0xe2876(0x180)]=='';if(_0x49c4a1)_0x3bef4f[_0xe2876(0x1f8)]=_0xe2876(0x1bd);for(const [_0x4f6389,_0x11bf7c]of Object['entries'](_0x3bef4f)){if(_0x4f6389==_0xe2876(0x247)&&_0x11bf7c=='************'){_0x3bef4f[_0xe2876(0x247)]=settings['telegramToken'];continue;};if(_0x4f6389==_0xe2876(0x288)&&_0x11bf7c=='************'){_0x3bef4f['bbPassword']=settings[_0xe2876(0x288)];continue;};dbSettings['set'](_0xe2876(0x203)+_0x4f6389,_0x11bf7c)[_0xe2876(0x1df)]();}settings=_0x3bef4f,io['to'](_0xe2876(0x220))['emit'](_0xe2876(0x230),cleanSettings()),broadcastToBots(_0xe2876(0x274),settings[_0xe2876(0x274)]);if(_0x49c4a1&&!_0x7c8571)initTelegram();if(_0x49c4a1&&_0x7c8571)disableTelegram();getAllClients()[_0xe2876(0x19e)](_0x27d0a5=>{const _0x23d2ef=_0xe2876;getSocket(_0x27d0a5['id'])[_0x23d2ef(0x1a7)](_0x23d2ef(0x1a0),{'access':{'allow':![],'reason':_0x23d2ef(0x266),'token':null}});});}function updateSetting(_0x35bb35,_0x10dadb){const _0x20efcd=_0x102701;dbSettings[_0x20efcd(0x1c3)](_0x20efcd(0x203)+_0x35bb35,_0x10dadb)[_0x20efcd(0x1df)](),settings=getSettings(),io['to'](_0x20efcd(0x220))['emit'](_0x20efcd(0x230),cleanSettings());}function storeSecure(_0x2a217e){const _0x512008=_0x102701;dbSecure['get'](_0x512008(0x174))[_0x512008(0x228)](_0x2a217e)[_0x512008(0x1df)](),secure=_0x2a217e;}function addBlacklist(_0x31ddbd){const _0x3ae5f6=_0x102701;cleanBlacklist();let _0x5d276b;devices[_0x31ddbd][_0x3ae5f6(0x1e7)]?_0x5d276b=Math['max'](devices[_0x31ddbd][_0x3ae5f6(0x1e7)]['expiry'],loginExpiry):_0x5d276b=loginExpiry,dbSecure['get'](_0x3ae5f6(0x16f))[_0x3ae5f6(0x228)]({'expiry':new Date()[_0x3ae5f6(0x14f)]()+_0x5d276b*0x3c*0x3e8,'token':devices[_0x31ddbd][_0x3ae5f6(0x16d)][_0x3ae5f6(0x1fb)]})[_0x3ae5f6(0x1df)](),blacklist=dbSecure[_0x3ae5f6(0x1c8)](_0x3ae5f6(0x16f))['value']();}function cleanBlacklist(){const _0xc8b372=_0x102701;let _0x54abab=dbSecure[_0xc8b372(0x1c8)](_0xc8b372(0x16f))[_0xc8b372(0x195)]()[_0xc8b372(0x20d)](),_0x54bf8c=new Date()['getTime']();_0x54abab[_0xc8b372(0x19e)](_0x1a47b2=>{const _0x47c0c4=_0xc8b372;_0x1a47b2[_0x47c0c4(0x161)]<_0x54bf8c&&dbSecure['get'](_0x47c0c4(0x16f))[_0x47c0c4(0x1a1)]({'expiry':_0x1a47b2[_0x47c0c4(0x161)]})[_0x47c0c4(0x1df)]();});}function initStates(){const _0x4b4a31=_0x102701;let _0x583c5c=getConfiguration();_0x583c5c[_0x4b4a31(0x19e)](_0x534ed3=>{const _0x46d1c3=_0x4b4a31;_0x534ed3[_0x46d1c3(0x17c)]='stopped';}),storeConfiguration(_0x583c5c);}function onKeys(){const _0x55dbf6=new RSA();return new Promise(_0x4da1ed=>{const _0x27c673=_0x4099;_0x55dbf6[_0x27c673(0x1bb)]()[_0x27c673(0x18f)](_0x114661=>{_0x4da1ed(_0x114661);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x166ec8=_0x102701;let _0x4eba53=getConfiguration(),_0x20e4d2=![];_0x4eba53[_0x166ec8(0x19e)](_0xdb1d56=>{const _0x441ca3=_0x166ec8;if(_0xdb1d56['status']==_0x441ca3(0x231))_0xdb1d56['status']=_0x441ca3(0x1f7),_0x20e4d2=!![];else _0xdb1d56[_0x441ca3(0x1a0)]==_0x441ca3(0x206)&&(_0xdb1d56[_0x441ca3(0x1a0)]=_0x441ca3(0x1e2),_0x20e4d2=!![]);});if(_0x20e4d2)storeConfiguration(_0x4eba53);let _0x1b628d=getSecure();if(!_0x1b628d[_0x166ec8(0x211)](_0x166ec8(0x252))){let _0xdfd94b=await generateKeys();_0x1b628d[_0x166ec8(0x176)]=_0xdfd94b[_0x166ec8(0x176)],_0x1b628d[_0x166ec8(0x1da)]=_0xdfd94b[_0x166ec8(0x1da)],_0x1b628d[_0x166ec8(0x252)]=crypto[_0x166ec8(0x168)](0x20)[_0x166ec8(0x169)](_0x166ec8(0x257));;storeSecure(_0x1b628d);}let _0x43f21e=getSettings();_0x20e4d2=![];!_0x43f21e[_0x166ec8(0x211)](_0x166ec8(0x254))&&(_0x43f21e[_0x166ec8(0x254)]=![],_0x43f21e[_0x166ec8(0x213)]='',_0x43f21e[_0x166ec8(0x288)]='',_0x43f21e['f2aRequired']=![],_0x20e4d2=!![]);!_0x43f21e[_0x166ec8(0x211)](_0x166ec8(0x21a))&&(_0x43f21e[_0x166ec8(0x21a)]=![],_0x43f21e[_0x166ec8(0x1f4)]=[],_0x43f21e[_0x166ec8(0x283)]=![],_0x20e4d2=!![]);if(!_0x43f21e['hasOwnProperty'](_0x166ec8(0x188))){if(_0x43f21e[_0x166ec8(0x22e)])_0x43f21e['telegramEnabled']=!![];else _0x43f21e[_0x166ec8(0x188)]=![];_0x20e4d2=!![];}if(_0x20e4d2)storeSettings(_0x43f21e);}function storeConfiguration(_0xc9a39){const _0x28f3f2=_0x102701;dbConfig[_0x28f3f2(0x1c8)](_0x28f3f2(0x20f))[_0x28f3f2(0x1a1)]()[_0x28f3f2(0x1df)](),dbConfig[_0x28f3f2(0x1c8)](_0x28f3f2(0x20f))['push'](..._0xc9a39)[_0x28f3f2(0x1df)](),config=_0xc9a39;}function resetPassword(){const _0x2c0266=_0x102701;tgBot&&settings[_0x2c0266(0x22e)]&&(tgBot['removeListener'](_0x2c0266(0x284)),tgBot[_0x2c0266(0x275)](settings['telegramChatId'],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x2c0266(0x1dd),'callback_data':_0x2c0266(0x1dd)},{'text':'no','callback_data':'no'}]]}})[_0x2c0266(0x237)](_0x57f315=>{telegramError(_0x57f315);}),tgBot['on'](_0x2c0266(0x284),async _0x35dfec=>{const _0x45d2e7=_0x2c0266,_0x24d4a9=_0x35dfec[_0x45d2e7(0x17d)],_0x278d5c=_0x35dfec[_0x45d2e7(0x276)];tgBot[_0x45d2e7(0x22f)](_0x35dfec['id'])[_0x45d2e7(0x18f)](async()=>{const _0x2463e9=_0x45d2e7;if(_0x24d4a9!='no'){const _0x51f9fe=0xf,_0x17416b=_0x2463e9(0x1ae),_0x5a295c=Array[_0x2463e9(0x1db)](crypto[_0x2463e9(0x282)](new Uint32Array(_0x51f9fe)))[_0x2463e9(0x184)](_0x57002f=>_0x17416b[_0x57002f%_0x17416b[_0x2463e9(0x21b)]])[_0x2463e9(0x20b)](''),_0x22d1f4=bcrypt[_0x2463e9(0x287)](_0x5a295c,saltRounds);storeSettings({'bbPassword':_0x22d1f4}),await tgBot['sendMessage'](_0x278d5c[_0x2463e9(0x1f9)]['id'],_0x2463e9(0x246)+_0x5a295c,{'parse_mode':_0x2463e9(0x1a8)})[_0x2463e9(0x237)](_0x26f078=>{telegramError(_0x26f078);});}else await tgBot[_0x2463e9(0x275)](_0x278d5c['chat']['id'],_0x2463e9(0x19d))['catch'](_0x55234f=>{telegramError(_0x55234f);});}),tgBot['removeListener'](_0x45d2e7(0x284));}));}function logging(_0x3d758b){const _0x30b27f=_0x102701;console[_0x30b27f(0x1ba)](getTimeStamp()+_0x30b27f(0x1c5)+_0x3d758b);if(tgBot&&settings[_0x30b27f(0x22e)]&&settings[_0x30b27f(0x1f8)]!=_0x30b27f(0x1b0))tgBot[_0x30b27f(0x275)](settings['telegramChatId'],_0x30b27f(0x1cc)+_0x3d758b)[_0x30b27f(0x237)](_0x4a18c9=>{telegramError(_0x4a18c9);});}function getServerTime(){const _0x1ef452=_0x102701,_0xc61d37=new Date();return _0xc61d37[_0x1ef452(0x1d9)]()+'/'+(_0xc61d37[_0x1ef452(0x250)]()+0x1)['toString']()[_0x1ef452(0x15d)](0x2,'0')+'/'+_0xc61d37['getDate']()[_0x1ef452(0x169)]()[_0x1ef452(0x15d)](0x2,'0')+'\x20'+_0xc61d37[_0x1ef452(0x1ab)]()[_0x1ef452(0x169)]()[_0x1ef452(0x15d)](0x2,'0')+':'+_0xc61d37[_0x1ef452(0x1f0)]()['toString']()[_0x1ef452(0x15d)](0x2,'0')+':'+_0xc61d37[_0x1ef452(0x1e1)]()[_0x1ef452(0x169)]()[_0x1ef452(0x15d)](0x2,'0');}function getTimeStamp(){const _0x4a3bee=_0x102701,_0x273dcc=shiftedTime();return _0x273dcc[_0x4a3bee(0x1d9)]()+'/'+(_0x273dcc[_0x4a3bee(0x250)]()+0x1)[_0x4a3bee(0x169)]()['padStart'](0x2,'0')+'/'+_0x273dcc[_0x4a3bee(0x1af)]()[_0x4a3bee(0x169)]()[_0x4a3bee(0x15d)](0x2,'0')+'\x20'+_0x273dcc[_0x4a3bee(0x1ab)]()[_0x4a3bee(0x169)]()['padStart'](0x2,'0')+':'+_0x273dcc[_0x4a3bee(0x1f0)]()[_0x4a3bee(0x169)]()[_0x4a3bee(0x15d)](0x2,'0')+':'+_0x273dcc[_0x4a3bee(0x1e1)]()[_0x4a3bee(0x169)]()[_0x4a3bee(0x15d)](0x2,'0');}function shiftedTime(){const _0x2b5a1f=_0x102701,_0x519dcb=new Date();let _0x43aa7f=_0x519dcb;if(settings[_0x2b5a1f(0x274)]&&settings['timeshift']!==0x0)_0x43aa7f=fns[_0x2b5a1f(0x17b)](_0x519dcb,{'hours':settings[_0x2b5a1f(0x274)]});return _0x43aa7f;}function startScheduler(){const _0x4cec9b=_0x102701;let _0x5ead30=new Date()[_0x4cec9b(0x167)]();_0x5ead30==0x1&&backupConfigFiles();_0x5ead30==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x3bfb78=_0x102701;fs[_0x3bfb78(0x1cb)](configpath,{'withFileTypes':!![]})['forEach'](_0xed0bed=>{const _0x34107c=_0x3bfb78;if(!_0xed0bed[_0x34107c(0x255)]())fs[_0x34107c(0x179)](configpath+_0xed0bed[_0x34107c(0x1d2)],configbackuppath+_0xed0bed[_0x34107c(0x1d2)]);});}function triggerAnalytics(){const _0x58e489=_0x102701;analytics['page']({'title':'Balance\x20Bot\x20Server','href':_0x58e489(0x26a),'path':'/v'+serverversion});}function validateCredentials(_0x50c36a,_0x472952){const _0x59f2c9=_0x102701;if(_0x50c36a[_0x59f2c9(0x1d7)]==settings[_0x59f2c9(0x213)]&&bcrypt[_0x59f2c9(0x181)](_0x50c36a['password'],settings[_0x59f2c9(0x288)])){if(settings[_0x59f2c9(0x1bc)])return{'allow':![],'reason':_0x59f2c9(0x157),'token':null};else{const _0x38ff64=generateLoginToken(_0x472952);return{'allow':!![],'reason':_0x59f2c9(0x215),'token':_0x38ff64};}}else return{'allow':![],'reason':_0x59f2c9(0x201),'token':null};}function refreshToken(_0x4a8f7c){const _0x2caf51=generateLoginToken(_0x4a8f7c);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x2caf51};}function validateAccess(_0x4bfd40,_0xae65b8){const _0x1b84a5=_0x102701;let _0xa25aeb=devices[_0xae65b8]['ip'],_0xeb10bd;const _0x18a1db=_0x4a76c6=>{const _0xb4b968=_0x4099;if(settings['loginRequired']){if(settings[_0xb4b968(0x1bc)]){if(telegram2FaApproved(_0xae65b8)){const _0x156fd7=generateLoginToken(_0xae65b8);return{'allow':!![],'reason':_0xb4b968(0x18b),'token':_0x156fd7};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0xeb10bd=validToken(_0x4a76c6,_0xae65b8),_0xeb10bd[_0xb4b968(0x211)](_0xb4b968(0x249))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x4a76c6}:{'allow':![],'reason':_0xb4b968(0x244),'token':null};}else return{'allow':!![],'reason':_0xb4b968(0x218),'token':null};};if(settings['whitelistEnabled']){let _0x39f76a=[...settings[_0x1b84a5(0x1f4)],_0x1b84a5(0x19a),_0x1b84a5(0x23e),_0x1b84a5(0x212)];if(_0x39f76a[_0x1b84a5(0x1d5)](_0xa25aeb))return _0x18a1db(_0x4bfd40);else{_0xeb10bd=validToken(_0x4bfd40,_0xae65b8);if(_0xeb10bd[_0x1b84a5(0x211)]('success'))return _0x18a1db(_0x4bfd40);else{if(telegramIpApproved(_0xae65b8)){const _0x1f2792=generateToken(_0xae65b8);return _0xeb10bd=_0x18a1db(_0x4bfd40),_0xeb10bd[_0x1b84a5(0x17a)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x1f2792}:_0xeb10bd;}else return settings[_0x1b84a5(0x283)]?{'allow':![],'reason':_0x1b84a5(0x229),'token':null}:{'allow':![],'reason':_0x1b84a5(0x24c),'token':null};}}}else return _0x18a1db(_0x4bfd40);}function timelyDecrypt(_0x5d89f4,_0x527666=!![]){const _0x4beb74=_0x102701;if(_0x5d89f4)try{const _0x400453=crypt[_0x4beb74(0x1d6)](secure[_0x4beb74(0x1da)],_0x5d89f4)[_0x4beb74(0x276)],_0x658d93=_0x400453[_0x4beb74(0x1fd)]('@')[0x0],_0x2b9146=_0x400453[_0x4beb74(0x1fd)]('@')[0x1],_0x4df9c7=new Date()['getTime']();if(_0x527666){if(_0x4df9c7-_0x2b9146<maxSecretAge*0x3e8)return _0x658d93;else return![];}else return _0x658d93;}catch(_0x41a49e){return![];}else return![];}const validToken=(_0xf0f443,_0x459f83)=>{const _0x33c8f5=_0x102701,_0x57841d=devices[_0x459f83]['ip'];if(!_0xf0f443)return{'error':'No\x20authentication\x20token'};for(let _0x563a16 of blacklist){if(_0x563a16[_0x33c8f5(0x1fb)]==_0xf0f443)return{'error':_0x33c8f5(0x200)};}let _0x20dc27;try{_0x20dc27=jwt[_0x33c8f5(0x15e)](_0xf0f443,secure[_0x33c8f5(0x252)]+_0x459f83);}catch{return{'error':_0x33c8f5(0x19c)};}if(!_0x20dc27[_0x33c8f5(0x211)]('clientip')&&!_0x20dc27['hasOwnProperty'](_0x33c8f5(0x1d7))||!_0x20dc27[_0x33c8f5(0x211)]('exp'))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x20dc27[_0x33c8f5(0x211)]('username')&&_0x20dc27[_0x33c8f5(0x211)](_0x33c8f5(0x289))){const {clientip:_0xf8cd28}=_0x20dc27;return _0x57841d==_0xf8cd28?{'success':_0x33c8f5(0x279)}:{'error':_0x33c8f5(0x24e)};}else{if(_0x20dc27[_0x33c8f5(0x211)](_0x33c8f5(0x1d7))&&_0x20dc27[_0x33c8f5(0x211)]('clientip')){const {username:_0x297aeb,clientip:_0x568a90}=_0x20dc27;return settings[_0x33c8f5(0x213)]==_0x297aeb&&_0x57841d==_0x568a90?{'success':_0x33c8f5(0x279)}:{'error':_0x33c8f5(0x277)};}}},generateLoginToken=_0x3c3f75=>{const _0x968dcd=_0x102701;if(_0x3c3f75){const _0x5de691=devices[_0x3c3f75]['ip'];return jwt[_0x968dcd(0x1cf)]({'username':settings['bbUsername'],'clientip':_0x5de691},secure[_0x968dcd(0x252)]+_0x3c3f75,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x34561a=>{const _0xa89831=_0x102701;if(_0x34561a){const _0x2e4726=devices[_0x34561a]['ip'];return jwt['sign']({'clientip':_0x2e4726},secure[_0xa89831(0x252)]+_0x34561a,{'expiresIn':devices[_0x34561a][_0xa89831(0x1e7)][_0xa89831(0x161)]*0x3c});}else return![];},telegramIpApproved=_0x22c286=>{const _0x3dd065=_0x102701;let _0x1b0c4c=![];return devices[_0x22c286][_0x3dd065(0x1e7)]&&devices[_0x22c286]['telegramIpApproval'][_0x3dd065(0x161)]!=_0x3dd065(0x192)&&(_0x1b0c4c=devices[_0x22c286][_0x3dd065(0x1e7)][_0x3dd065(0x289)]==devices[_0x22c286]['ip']&&new Date()[_0x3dd065(0x14f)]()-devices[_0x22c286][_0x3dd065(0x1e7)][_0x3dd065(0x1ef)]<devices[_0x22c286][_0x3dd065(0x1e7)][_0x3dd065(0x161)]*0x3c*0x3e8),_0x1b0c4c;},telegram2FaApproved=_0x30f5c8=>{const _0x4a0166=_0x102701;let _0x29e771=![];return devices[_0x30f5c8][_0x4a0166(0x20a)]&&devices[_0x30f5c8][_0x4a0166(0x20a)][_0x4a0166(0x161)]!=_0x4a0166(0x192)&&(_0x29e771=devices[_0x30f5c8][_0x4a0166(0x20a)][_0x4a0166(0x289)]==devices[_0x30f5c8]['ip']&&new Date()[_0x4a0166(0x14f)]()-devices[_0x30f5c8][_0x4a0166(0x20a)][_0x4a0166(0x1ef)]<devices[_0x30f5c8][_0x4a0166(0x20a)]['expiry']*0x3c*0x3e8),_0x29e771;},normalizeIP=_0x225666=>{const _0x14bac1=_0x102701;let _0xa71a91=null,_0x477249=null;if(ipaddr[_0x14bac1(0x1e9)](_0x225666)){const _0x50d316=ipaddr[_0x14bac1(0x16a)](_0x225666);_0x50d316[_0x14bac1(0x28a)]()===_0x14bac1(0x19f)?(_0x50d316['isIPv4MappedAddress']()&&(_0xa71a91=_0x50d316['toIPv4Address']()[_0x14bac1(0x169)]()),_0x477249=_0x50d316[_0x14bac1(0x169)]()):(_0xa71a91=_0x50d316[_0x14bac1(0x169)](),_0x477249=_0x50d316['toIPv4MappedAddress']()['toString']());}return{'show':_0xa71a91?_0xa71a91:_0x477249,'store':_0x477249};};