const _0x482511=_0x4219;(function(_0x124345,_0x10d39c){const _0x40e0b5=_0x4219,_0x26445c=_0x124345();while(!![]){try{const _0x3709f7=-parseInt(_0x40e0b5(0x272))/0x1*(parseInt(_0x40e0b5(0x16d))/0x2)+parseInt(_0x40e0b5(0x25c))/0x3+parseInt(_0x40e0b5(0x293))/0x4+-parseInt(_0x40e0b5(0x21e))/0x5+-parseInt(_0x40e0b5(0x14f))/0x6*(parseInt(_0x40e0b5(0x1f5))/0x7)+parseInt(_0x40e0b5(0x1eb))/0x8+parseInt(_0x40e0b5(0x2d6))/0x9;if(_0x3709f7===_0x10d39c)break;else _0x26445c['push'](_0x26445c['shift']());}catch(_0x32a343){_0x26445c['push'](_0x26445c['shift']());}}}(_0x36d1,0x5bcca));const _0x4bed77=function(){let _0x1c4920=!![];return function(_0x3fe07f,_0x4e0c7b){const _0x3b8724=_0x1c4920?function(){const _0x523c73=_0x4219;if(_0x4e0c7b){const _0x2ec34b=_0x4e0c7b[_0x523c73(0x2bd)](_0x3fe07f,arguments);return _0x4e0c7b=null,_0x2ec34b;}}:function(){};return _0x1c4920=![],_0x3b8724;};}(),_0x3697fe=_0x4bed77(this,function(){const _0x3f38aa=_0x4219;return _0x3697fe['toString']()[_0x3f38aa(0x29c)](_0x3f38aa(0x2c6))['toString']()[_0x3f38aa(0x224)](_0x3697fe)[_0x3f38aa(0x29c)](_0x3f38aa(0x2c6));});_0x3697fe();'use strict';process[_0x482511(0x148)][_0x482511(0x1dc)]=0x1;const childProcess=require(_0x482511(0x2f1)),fs=require('fs'),fns=require(_0x482511(0x220)),low=require(_0x482511(0x201)),FileSync=require(_0x482511(0x2fe)),path=require(_0x482511(0x18f)),crypto=require(_0x482511(0x288)),Crypt=require(_0x482511(0x11b))[_0x482511(0x285)],RSA=require('hybrid-crypto-js')[_0x482511(0x1a4)],bcrypt=require('bcryptjs'),jwt=require(_0x482511(0x13f)),ipaddr=require(_0x482511(0x23b)),argv=require('yargs/yargs')(process[_0x482511(0x2f5)][_0x482511(0x279)](0x2))[_0x482511(0x2f5)],uuidRandom=require(_0x482511(0x29a)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x482511(0x12e)),axios=require(_0x482511(0x274)),{GraphQLClient,gql}=require(_0x482511(0x237)),util=require(_0x482511(0x259)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x482511(0x303)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x482511(0x1a8)](PORT)&&(console[_0x482511(0x260)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x482511(0x156)),process[_0x482511(0x28b)](0x1));const HOST=argv['host']||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x482511(0x21d)][_0x482511(0x255)];let bbpath=_0x482511(0x2cc),bbpath2='';const botfile=_0x482511(0x1c5),configfile=_0x482511(0x23f),settingsfile='bb-settings.json',securefile=_0x482511(0x228),environment=require('./'+bbpath2+_0x482511(0x1f9))[_0x482511(0x183)]||'production',maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x482511(0x301)),configpath=userID?bbpath+_0x482511(0x2b0)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x482511(0x250),logspath=userID?bbpath+_0x482511(0x302)+userID+'/':bbpath+_0x482511(0x302),zippath=userID?bbpath+_0x482511(0x2f4)+userID+'/':bbpath+_0x482511(0x2f4),loggerfile=fs[_0x482511(0x2c4)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+'temp/';!fs[_0x482511(0x158)](configpath)&&fs[_0x482511(0x2f6)](configpath);!fs[_0x482511(0x158)](configbackuppath)&&fs[_0x482511(0x2f6)](configbackuppath);!fs[_0x482511(0x158)](logspath)&&fs[_0x482511(0x2f6)](logspath);!fs[_0x482511(0x158)](zippath)&&fs[_0x482511(0x2f6)](zippath);!fs['existsSync'](temppath)&&fs[_0x482511(0x2f6)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x482511(0x1b0)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![]}})[_0x482511(0x1b3)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x482511(0x1b0)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x482511(0x18a),'rsaStandard':_0x482511(0x1cc)});const saltRounds=0xa,mixpanel=Mixpanel[_0x482511(0x187)](_0x482511(0x180),{'host':_0x482511(0x1f2)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x482511(0x131)]&&(settings[_0x482511(0x131)]!=''&&settings[_0x482511(0x131)]!=_0x482511(0x1bb))&&settings['telegramUsername']&&settings[_0x482511(0x154)]!='')initTelegram();const parseColor=(_0x3b2bde,_0x48d13a)=>{const _0x149fdd=_0x482511,_0x4d328e=/#[A-Z]{3}#/g;if(typeof _0x3b2bde==_0x149fdd(0x15f)){!_0x48d13a?_0x3b2bde=_0x3b2bde[_0x149fdd(0x21c)](_0x4d328e,''):(_0x3b2bde=_0x3b2bde[_0x149fdd(0x21c)](/#BLU#/g,_0x149fdd(0x1d0)),_0x3b2bde=_0x3b2bde[_0x149fdd(0x21c)](/#RED#/g,_0x149fdd(0x1e1)),_0x3b2bde=_0x3b2bde['replace'](/#YEL#/g,_0x149fdd(0x1be)),_0x3b2bde=_0x3b2bde['replace'](/#MAG#/g,_0x149fdd(0x212)),_0x3b2bde=_0x3b2bde[_0x149fdd(0x21c)](/#CYA#/g,_0x149fdd(0x21f)),_0x3b2bde=_0x3b2bde[_0x149fdd(0x21c)](/#RES#/g,_0x149fdd(0x2ab)));;}return _0x3b2bde;},logger={'screen':_0x4ad201=>{const _0x37f308=_0x482511;console[_0x37f308(0x260)](parseColor(_0x4ad201,!![]));},'simple':_0x1aa5c9=>{const _0x48ba01=_0x482511;console[_0x48ba01(0x260)](parseColor(_0x1aa5c9,!![])),loggerfile[_0x48ba01(0x1b3)](util[_0x48ba01(0x19d)](parseColor(_0x1aa5c9,![]))+'\x0a');},'full':async _0x100362=>{const _0x5bf4a7=_0x482511,_0x44e021=getTimeStamp()+_0x5bf4a7(0x1b4)+_0x100362;console[_0x5bf4a7(0x260)](parseColor(_0x44e021,!![])),loggerfile['write'](util[_0x5bf4a7(0x19d)](parseColor(_0x44e021,![]))+'\x0a');if(tgBot&&settings[_0x5bf4a7(0x140)]&&settings[_0x5bf4a7(0x1c4)]!=_0x5bf4a7(0x26d))await sendTelegram(settings[_0x5bf4a7(0x140)],_0x5bf4a7(0x24a)+parseColor(_0x100362,![]));},'debug':async(_0x2e921c,_0x43e208='')=>{const _0x50d44d=_0x482511,_0x51d99d=getTimeStamp()+_0x50d44d(0x17f)+_0x2e921c;if(debugging)console[_0x50d44d(0x260)](parseColor(_0x51d99d,!![]));loggerfile['write'](util[_0x50d44d(0x19d)](parseColor(_0x51d99d,![]))+'\x0a');if(_0x43e208){if(debugging)console['log'](_0x43e208);loggerfile[_0x50d44d(0x1b3)](util['format'](_0x43e208)+'\x0a');}}};let terminating=![];process['on'](_0x482511(0x25b),function(_0x316ba8){const _0x5be049=_0x482511;logger[_0x5be049(0x2dd)](_0x316ba8);}),process['on'](_0x482511(0x28b),()=>{const _0x2e55e5=_0x482511;stopAllBots(),process[_0x2e55e5(0x28b)](0x0);}),process['on'](_0x482511(0x13d),()=>{stopAllBots(),process['exit'](0x0);}),process['on']('SIGINT',()=>{const _0x27d034=_0x482511;stopAllBots(),process[_0x27d034(0x28b)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x482511(0x1f9))[_0x482511(0x28d)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require('http')[_0x482511(0x2b2)](app);app[_0x482511(0x1fe)](fileUpload({'useTempFiles':!![]})),app[_0x482511(0x223)](_0x482511(0x150),async(_0x5390ac,_0x2364be)=>{const _0x45f4a3=_0x482511,_0x22d597=_0x5390ac[_0x45f4a3(0x208)][_0x45f4a3(0x17b)],_0x1c2d2c=getClientsWithBotID('botmanager'),_0x2d8d85=_0x5390ac[_0x45f4a3(0x1b9)][_0x45f4a3(0x1de)],_0x47b829=timelyDecrypt(_0x2d8d85,![]),_0x299de8=_0x1c2d2c[_0x45f4a3(0x1ca)](_0x1eefa1=>_0x1eefa1[_0x45f4a3(0x1de)]==_0x47b829);if(_0x299de8){const _0x2eaa1d=normalizeIP(_0x5390ac[_0x45f4a3(0x24e)][_0x45f4a3(0x1d5)])['store'],_0x3266a5=_0x5390ac[_0x45f4a3(0x1b9)][_0x45f4a3(0x101)];if(validateAccess(_0x3266a5,_0x47b829,_0x2eaa1d)[_0x45f4a3(0x1b2)])_0x22d597==_0x45f4a3(0x135)&&await backupConfigFiles(),await zipFiles(_0x22d597),_0x2364be[_0x45f4a3(0x118)](zippath+(_0x22d597+'.zip'),_0xac4db4=>{const _0xbfa219=_0x45f4a3;_0xac4db4&&(logger[_0xbfa219(0x177)]('Failed\x20to\x20download\x20'+_0x22d597),logger[_0xbfa219(0x2dd)](_0xac4db4));});else logger[_0x45f4a3(0x177)](_0x45f4a3(0x200)+_0x22d597+_0x45f4a3(0x176));}else logger[_0x45f4a3(0x177)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x22d597+_0x45f4a3(0x174));}),app[_0x482511(0x2b8)]('/upload-backup',async(_0x275ecb,_0x5a6dc0)=>{const _0xec1e13=_0x482511,_0x3b321a=getClientsWithBotID(_0xec1e13(0x1db)),_0x28c483=_0x275ecb['headers'][_0xec1e13(0x1de)],_0x5242bb=timelyDecrypt(_0x28c483,![]),_0x304043=_0x3b321a[_0xec1e13(0x1ca)](_0x3ac64d=>_0x3ac64d[_0xec1e13(0x1de)]==_0x5242bb);logger[_0xec1e13(0x22c)]('Backup\x20file\x20uploaded');if(_0x304043){const _0x1529e7=normalizeIP(_0x275ecb[_0xec1e13(0x24e)][_0xec1e13(0x1d5)])[_0xec1e13(0x117)],_0x3c6ec7=_0x275ecb[_0xec1e13(0x1b9)]['tkn'];if(validateAccess(_0x3c6ec7,_0x5242bb,_0x1529e7)[_0xec1e13(0x1b2)]){if(_0x275ecb['files']){const _0x1ea627=_0x275ecb['files'][_0xec1e13(0x17a)];await _0x1ea627['mv'](temppath+_0x1ea627['name']),_0x5a6dc0[_0xec1e13(0x295)]({'status':!![],'message':_0xec1e13(0x144)});const _0xc3010f=getBotsWithMode();_0xc3010f[_0xec1e13(0x1df)]>0x0?confirmRestore(temppath,_0x1ea627[_0xec1e13(0x23a)]):unzipFile(temppath,_0x1ea627[_0xec1e13(0x23a)]);}}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0xec1e13(0x177)](_0xec1e13(0x109));}),app[_0x482511(0x1fe)](express[_0x482511(0x16b)](path[_0x482511(0x278)](__dirname,bbpath2,_0x482511(0x11a)))),app[_0x482511(0x1fe)](express['static'](path[_0x482511(0x278)](__dirname,bbpath2,_0x482511(0x2aa)))),app[_0x482511(0x223)]('/',function(_0x2281e0,_0x5cad43){const _0x2d708f=_0x482511;_0x5cad43[_0x2d708f(0x1cd)](path['join'](__dirname,bbpath2,_0x2d708f(0x11a),'index.html'));}),app[_0x482511(0x223)](_0x482511(0x16e),function(_0x389fc7,_0x3108ea){const _0x2839ae=_0x482511;_0x3108ea['sendFile'](path[_0x2839ae(0x278)](__dirname,bbpath2,'build',_0x2839ae(0x1ce)));}),app[_0x482511(0x223)]('/:bot/portfolio',(_0x46e2c6,_0x40394a)=>{const _0xa97479=_0x482511;_0x40394a[_0xa97479(0x1cd)](path[_0xa97479(0x278)](__dirname,bbpath2,_0xa97479(0x2aa),_0xa97479(0x1ce)));}),app['get'](_0x482511(0x2e2),(_0x11a7bd,_0x568a28)=>{const _0x4dbcda=_0x482511;_0x568a28[_0x4dbcda(0x1cd)](path[_0x4dbcda(0x278)](__dirname,bbpath2,_0x4dbcda(0x2aa),_0x4dbcda(0x1ce)));}),app[_0x482511(0x223)](_0x482511(0x2c1),(_0x46ef5a,_0x129905)=>{const _0x47f0ae=_0x482511;_0x129905[_0x47f0ae(0x1cd)](path[_0x47f0ae(0x278)](__dirname,bbpath2,_0x47f0ae(0x2aa),_0x47f0ae(0x1ce)));}),app[_0x482511(0x223)]('/:bot/history',(_0x32f75a,_0x50faaf)=>{const _0x824deb=_0x482511;_0x50faaf['sendFile'](path[_0x824deb(0x278)](__dirname,bbpath2,_0x824deb(0x2aa),_0x824deb(0x1ce)));}),app[_0x482511(0x223)](_0x482511(0x2e6),(_0x3734ac,_0x568f3f)=>{const _0x443038=_0x482511;_0x568f3f[_0x443038(0x1cd)](path[_0x443038(0x278)](__dirname,bbpath2,'build',_0x443038(0x1ce)));}),app[_0x482511(0x223)]('/:bot/support',(_0x5431e6,_0x5eedfd)=>{const _0x383743=_0x482511;_0x5eedfd[_0x383743(0x1cd)](path['join'](__dirname,bbpath2,'build',_0x383743(0x1ce)));});if(HOST)http['listen'](PORT,HOST);else http[_0x482511(0x1d8)](PORT);const io=require(_0x482511(0x157))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x20dbfd=_0x482511;let _0x30cecd=_0x20dbfd(0x130);const _0x2bc580=networkInterfaces(),_0x5b0139={};for(const _0x2b0841 of Object[_0x20dbfd(0x23e)](_0x2bc580)){for(const _0x54a3dd of _0x2bc580[_0x2b0841]){if((_0x54a3dd[_0x20dbfd(0x24c)]==_0x20dbfd(0x2e5)||_0x54a3dd['family']==0x4)&&!_0x54a3dd[_0x20dbfd(0x1a0)]){const _0x1d1e6b=ipaddr[_0x20dbfd(0x14c)](_0x54a3dd[_0x20dbfd(0x10d)])['range']();_0x1d1e6b!='private'&&(!_0x5b0139[_0x2b0841]&&(_0x5b0139[_0x2b0841]=[]),_0x5b0139[_0x2b0841][_0x20dbfd(0x248)](_0x54a3dd[_0x20dbfd(0x10d)]),_0x30cecd=_0x54a3dd[_0x20dbfd(0x10d)]);}}}return{'serverip':_0x30cecd,'netinterfaces':_0x5b0139};}async function startServer(){const _0x2c1650=_0x482511,{serverip:_0x3ab950,netinterfaces:_0x145bc3}=getServerIP();logger['simple'](''),logger[_0x2c1650(0x2dd)](_0x2c1650(0x1d9)),await logger[_0x2c1650(0x177)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x20'+(environment==_0x2c1650(0x29d)?_0x2c1650(0x1da):'')+'\x0a'+(_0x2c1650(0x232)+PORT+_0x2c1650(0x2a3))+(_0x2c1650(0x2f7)+_0x3ab950+':'+PORT+_0x2c1650(0x2c2))),logger[_0x2c1650(0x2dd)](_0x2c1650(0x1d9));if(config[_0x2c1650(0x1df)]!=0x0)for(const _0x223c36 of config){const _0x24755f=_0x223c36[_0x2c1650(0x202)]==_0x2c1650(0x16f)?'a':'m';if(_0x223c36['status']==_0x2c1650(0x20a)||_0x223c36[_0x2c1650(0x290)]=='new')await logger[_0x2c1650(0x177)](_0x2c1650(0x28e)+_0x24755f+_0x2c1650(0x13b)+_0x223c36[_0x2c1650(0x167)]+'\x20|\x20'+_0x223c36[_0x2c1650(0x2c7)]),startBot([_0x223c36['botID'],userID],{'cwd':bbpath},function(_0x45de84){const _0x3a48f7=_0x2c1650;if(_0x45de84)logger[_0x3a48f7(0x177)](_0x45de84);});else(_0x223c36['status']==_0x2c1650(0x20f)||_0x223c36[_0x2c1650(0x290)]=='new-disabled')&&await logger[_0x2c1650(0x177)](_0x2c1650(0x18d)+_0x24755f+')\x20\x20\x20|\x20Bot\x20'+_0x223c36['botID']+_0x2c1650(0x19e)+_0x223c36[_0x2c1650(0x2c7)]);}else!newBot&&logger[_0x2c1650(0x2dd)](_0x2c1650(0x231));if(newBot)addBot();logger[_0x2c1650(0x2dd)]('-----------------------------------------------------------------------------------'),logger['simple'](''),await logger['debug'](_0x2c1650(0x257)+nodeversion),await logger[_0x2c1650(0x22c)](_0x2c1650(0x21a),_0x145bc3);}function startSocket(){const _0x527571=_0x482511;io['on'](_0x527571(0x2d3),_0x3b0bdd=>{const _0x7fb486=_0x527571;let _0x4564c6,_0x140118,_0x3c7b7f,_0x4cec8a,_0x57b4e9;const _0x123433=_0x3b0bdd[_0x7fb486(0x27f)][_0x7fb486(0x1b9)][_0x7fb486(0x241)];_0x140118=_0x123433[_0x7fb486(0x2ae)](/bot[0-9]{3}/);if(_0x140118)_0x3c7b7f=_0x140118[0x0][_0x7fb486(0x2ae)](/[0-9]{3}/);if(_0x3c7b7f)_0x4564c6=_0x3c7b7f[0x0];else _0x4564c6=_0x7fb486(0x1db);const _0x323056=_0x3b0bdd[_0x7fb486(0x27f)][_0x7fb486(0x215)][_0x7fb486(0x2ff)];if(!_0x323056)_0x3b0bdd['emit'](_0x7fb486(0x290),{'publicKey':secure['publicKey']});else{_0x4cec8a=timelyDecrypt(_0x323056,![]);if(!_0x4cec8a)_0x3b0bdd[_0x7fb486(0x198)](_0x7fb486(0x290),{'publicKey':secure[_0x7fb486(0x1c7)]});else{_0x57b4e9=normalizeIP(_0x3b0bdd[_0x7fb486(0x12d)]['remoteAddress'])[_0x7fb486(0x117)];if(!devices[_0x4cec8a])devices[_0x4cec8a]={'uuid':_0x4cec8a,'access':{'token':null}};devices[_0x4cec8a]['ip']=_0x57b4e9;const _0x206444=addClient(_0x3b0bdd['id'],_0x4cec8a,_0x4564c6);setAccess(_0x206444),emitMessages(),_0x3b0bdd['on']('login',_0x33ccca=>{const _0x3b5b2b=_0x7fb486,_0x58770f=timelyDecrypt(_0x33ccca['password']);if(_0x58770f){_0x33ccca={'username':_0x33ccca['username'],'password':_0x58770f},devices[_0x4cec8a][_0x3b5b2b(0x1dd)]=validateCredentials(_0x33ccca,_0x4cec8a);if(devices[_0x4cec8a]['access']['allow']==![]&&devices[_0x4cec8a][_0x3b5b2b(0x1dd)][_0x3b5b2b(0x28a)]==_0x3b5b2b(0x10c))_0x3b0bdd[_0x3b5b2b(0x198)](_0x3b5b2b(0x290),{'access':devices[_0x4cec8a][_0x3b5b2b(0x1dd)]}),loginAccess2FA(_0x4cec8a,_0x57b4e9);else{if(devices[_0x4cec8a][_0x3b5b2b(0x1dd)]['allow']==![]&&devices[_0x4cec8a][_0x3b5b2b(0x1dd)][_0x3b5b2b(0x28a)]==_0x3b5b2b(0x244))_0x3b0bdd[_0x3b5b2b(0x198)]('status',{'access':devices[_0x4cec8a]['access']});else devices[_0x4cec8a][_0x3b5b2b(0x1dd)][_0x3b5b2b(0x1b2)]&&devices[_0x4cec8a][_0x3b5b2b(0x1dd)][_0x3b5b2b(0x28a)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x4cec8a)[_0x3b5b2b(0x1d6)](_0x145f07=>{setAccess(_0x145f07);}),logger[_0x3b5b2b(0x22c)]('Logged\x20in\x20user\x20...'+_0x4cec8a[_0x3b5b2b(0x279)](-0x8)),setTokenRefresh(_0x4cec8a),setSessionTimeout(_0x3b5b2b(0x26e),_0x4cec8a));}}else logger[_0x3b5b2b(0x177)](_0x3b5b2b(0x20d));}),_0x3b0bdd['on'](_0x7fb486(0xfd),()=>{resetPassword();}),_0x3b0bdd['on']('disconnect',_0x4ed2da=>{removeClient(_0x3b0bdd['id']);}),_0x4564c6==_0x7fb486(0x1db)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0xe7c228){const _0xdbbef4=_0x482511;if(_0xe7c228!=_0xdbbef4(0x1db)&&config[_0xdbbef4(0x27c)]!=''){if(pid[_0xe7c228])pid[_0xe7c228][_0xdbbef4(0x295)]({'function':_0xdbbef4(0x175),'args':null});}_0xe7c228!=_0xdbbef4(0x1db)&&broadcastToBots(_0xdbbef4(0x2c5),JSON[_0xdbbef4(0x1b6)](config));}function reloadBotManager(){const _0x21589a=_0x482511;getClientsWithBotID(_0x21589a(0x1db))[_0x21589a(0x1d6)](_0xac1575=>{const _0x5d47de=_0x21589a;getSocket(_0xac1575['id'])[_0x5d47de(0x198)](_0x5d47de(0x290),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x262896){const _0x191a86=_0x482511;return io[_0x191a86(0x1ae)]['sockets'][_0x191a86(0x223)](_0x262896);}function setAccess(_0x546b78){const _0x3b6edc=_0x482511,_0x5c8f3b=getSocket(_0x546b78['id']),_0x5ec6b9=_0x546b78[_0x3b6edc(0x1de)],_0x4fd7b3=_0x546b78[_0x3b6edc(0x137)];devices[_0x5ec6b9][_0x3b6edc(0x1dd)]=validateAccess(devices[_0x5ec6b9]['access'][_0x3b6edc(0x277)],_0x5ec6b9),logger['debug'](_0x3b6edc(0x216)+devices[_0x5ec6b9]['access']['reason']+_0x3b6edc(0x166)+_0x546b78['id'][_0x3b6edc(0x279)](-0x8)+_0x3b6edc(0x190)+_0x5ec6b9['slice'](-0x8)),_0x5c8f3b[_0x3b6edc(0x278)](_0x5ec6b9);if(devices[_0x5ec6b9]['access'][_0x3b6edc(0x1b2)]){_0x5c8f3b[_0x3b6edc(0x278)](_0x4fd7b3);if(_0x4fd7b3==_0x3b6edc(0x1db))initializeSocketBotManager(_0x5c8f3b);else initializeSocketBot(_0x5c8f3b);initClient(_0x4fd7b3);}devices[_0x5ec6b9][_0x3b6edc(0x1dd)][_0x3b6edc(0x277)]&&devices[_0x5ec6b9][_0x3b6edc(0x1dd)][_0x3b6edc(0x28a)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x3b6edc(0x205),_0x5ec6b9),devices[_0x5ec6b9][_0x3b6edc(0x1dd)][_0x3b6edc(0x277)]&&devices[_0x5ec6b9][_0x3b6edc(0x1dd)]['reason']==_0x3b6edc(0x1d1)&&setSessionTimeout('login',_0x5ec6b9),_0x5c8f3b[_0x3b6edc(0x198)](_0x3b6edc(0x290),{'status':_0x546b78[_0x3b6edc(0x172)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5ec6b9]['access'],'externalip':devices[_0x5ec6b9]['ip'],'publicKey':secure[_0x3b6edc(0x1c7)],'userid':settings[_0x3b6edc(0x184)],'validInstallation':validInstallation}),devices[_0x5ec6b9][_0x3b6edc(0x1dd)][_0x3b6edc(0x1b2)]==![]&&devices[_0x5ec6b9][_0x3b6edc(0x1dd)][_0x3b6edc(0x28a)]==_0x3b6edc(0x186)&&temporaryAccess2FA(_0x5ec6b9,devices[_0x5ec6b9]['ip']);}function setSessionTimeout(_0x404375,_0x1a5789){const _0x37dd0c=_0x482511;let _0x50f700;if(_0x404375==_0x37dd0c(0x26e))_0x50f700=loginExpiry*0x3c*0x3e8;else _0x50f700=devices[_0x1a5789][_0x37dd0c(0x1e6)][_0x37dd0c(0x266)]*0x3c*0x3e8-(new Date()[_0x37dd0c(0x1ea)]()-devices[_0x1a5789][_0x37dd0c(0x1e6)][_0x37dd0c(0x275)]);if(devices[_0x1a5789][_0x37dd0c(0x136)])clearTimeout(devices[_0x1a5789][_0x37dd0c(0x136)]);devices[_0x1a5789]['pidExpireLogin']=setTimeout(()=>{const _0xab815e=_0x37dd0c;if(devices[_0x1a5789]['pidRefreshToken'])clearTimeout(devices[_0x1a5789][_0xab815e(0x2b1)]);removeSocketListeners(_0x1a5789),addBlacklist(_0x1a5789),devices[_0x1a5789][_0xab815e(0x1e6)]=null,devices[_0x1a5789][_0xab815e(0x1e9)]=null,devices[_0x1a5789][_0xab815e(0x1dd)][_0xab815e(0x277)]=null,logger[_0xab815e(0x22c)]('Session\x20expired\x20for\x20user\x20...'+_0x1a5789['slice'](-0x8)),devices[_0x1a5789]['access']=validateAccess(devices[_0x1a5789][_0xab815e(0x1dd)]['token'],_0x1a5789),!(devices[_0x1a5789][_0xab815e(0x1dd)][_0xab815e(0x1b2)]&&devices[_0x1a5789]['access'][_0xab815e(0x28a)]==_0xab815e(0x173))&&(_0x404375==_0xab815e(0x26e)?io['to'](_0x1a5789)[_0xab815e(0x198)](_0xab815e(0x290),{'access':{'allow':![],'reason':_0xab815e(0x2bb),'token':null}}):io['to'](_0x1a5789)['emit'](_0xab815e(0x290),{'access':{'allow':![],'reason':_0xab815e(0x22a),'token':null}})),devices[_0x1a5789][_0xab815e(0x1dd)][_0xab815e(0x277)]=null;},_0x50f700);}function setTokenRefresh(_0x463b58){const _0x16d000=_0x482511;if(devices[_0x463b58][_0x16d000(0x2b1)])clearTimeout(devices[_0x463b58][_0x16d000(0x2b1)]);devices[_0x463b58]['pidRefreshToken']=setTimeout(()=>{const _0x230f0b=_0x16d000;getClientsWithUuid(_0x463b58)['length']!=0x0?(devices[_0x463b58][_0x230f0b(0x1dd)]=refreshToken(_0x463b58),io['to'](_0x463b58)[_0x230f0b(0x198)](_0x230f0b(0x290),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x463b58][_0x230f0b(0x1dd)],'externalip':devices[_0x463b58]['ip'],'publicKey':secure[_0x230f0b(0x1c7)],'validInstallation':validInstallation}),setTokenRefresh(_0x463b58)):clearTimeout(devices[_0x463b58][_0x230f0b(0x2b1)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x31608f){const _0x2621af=_0x482511,_0x11e385=getClient(_0x31608f['id'])['uuid'];_0x31608f[_0x2621af(0x198)]('bots',config),_0x31608f[_0x2621af(0x198)](_0x2621af(0x1c2),cleanSettings()),_0x31608f['on']('add-bot',_0x467da5=>{const _0x5cf49b=_0x2621af;if(validateAccess(_0x467da5,_0x11e385)[_0x5cf49b(0x1b2)])addBot();else logger[_0x5cf49b(0x177)](_0x5cf49b(0x273));}),_0x31608f['on'](_0x2621af(0x1c3),(_0xeef3db,_0x3ece31)=>{const _0xbd1177=_0x2621af;if(validateAccess(_0x3ece31,_0x11e385)['allow'])toggleBot(_0xeef3db['botID'],_0xeef3db[_0xbd1177(0x290)],_0xeef3db[_0xbd1177(0x22d)]);else logger[_0xbd1177(0x177)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x31608f['on']('toggle-bot-mode',(_0x99926d,_0x38dd07)=>{const _0x1291b1=_0x2621af;if(validateAccess(_0x38dd07,_0x11e385)[_0x1291b1(0x1b2)])toggleBotMode(_0x99926d);else logger[_0x1291b1(0x177)](_0x1291b1(0x2b6));}),_0x31608f['on'](_0x2621af(0x1e2),(_0x414d5d,_0x40be4f)=>{const _0x370ea6=_0x2621af;if(validateAccess(_0x40be4f,_0x11e385)[_0x370ea6(0x1b2)])deleteBot(_0x414d5d);else logger['full'](_0x370ea6(0x129));}),_0x31608f['on'](_0x2621af(0x1ef),(_0x205c60,_0x2cf262)=>{const _0x34a054=_0x2621af;if(validateAccess(_0x2cf262,_0x11e385)[_0x34a054(0x1b2)])storeSettings(_0x205c60,!![]);else logger[_0x34a054(0x177)](_0x34a054(0x22e));}),_0x31608f['on'](_0x2621af(0x299),_0x38c28a=>{const _0x76ddc7=_0x2621af;if(validateAccess(_0x38c28a,_0x11e385)['allow'])updateBB(_0x76ddc7(0x233));else logger[_0x76ddc7(0x177)](_0x76ddc7(0x261));}),_0x31608f['on'](_0x2621af(0x229),_0x27a930=>{const _0x4f135f=_0x2621af;if(validateAccess(_0x27a930,_0x11e385)[_0x4f135f(0x1b2)])updateBB(_0x4f135f(0x27e));else logger[_0x4f135f(0x177)](_0x4f135f(0x1f0));}),_0x31608f['on'](_0x2621af(0x1a6),_0x4c8726=>{const _0x3e8c34=_0x2621af;if(validateAccess(_0x4c8726,_0x11e385)[_0x3e8c34(0x1b2)]){const _0x194afc=getClient(_0x31608f['id']);if(_0x194afc)getBackupFiles(_0x194afc[_0x3e8c34(0x1de)]);else logger[_0x3e8c34(0x177)](_0x3e8c34(0x2f9));}else logger[_0x3e8c34(0x177)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x31608f['on']('restore-backup-file',(_0x1115e9,_0x5bfb6a)=>{const _0x4c63df=_0x2621af;if(validateAccess(_0x5bfb6a,_0x11e385)['allow'])restoreBackupFile(_0x1115e9);else logger[_0x4c63df(0x177)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x31608f['on'](_0x2621af(0x16c),_0x1b8c69=>{const _0x4f4fc0=_0x2621af;if(validateAccess(_0x1b8c69,_0x11e385)[_0x4f4fc0(0x1b2)])getMessages();else logger[_0x4f4fc0(0x177)](_0x4f4fc0(0x16a));}),_0x31608f['on']('confirm-message',(_0x17d355,_0x2087aa)=>{const _0x55ca01=_0x2621af;if(validateAccess(_0x2087aa,_0x11e385)[_0x55ca01(0x1b2)])confirmMessage(_0x17d355);else logger[_0x55ca01(0x177)](_0x55ca01(0x242));}),_0x31608f['on'](_0x2621af(0x214),_0x2a731b=>{const _0x55bdab=_0x2621af;if(validateAccess(_0x2a731b,_0x11e385)[_0x55bdab(0x1b2)]){if(devices[_0x11e385]['pidRefreshToken'])clearTimeout(devices[_0x11e385][_0x55bdab(0x2b1)]);if(devices[_0x11e385][_0x55bdab(0x136)])clearTimeout(devices[_0x11e385][_0x55bdab(0x136)]);removeSocketListeners(getClient(_0x31608f['id'])[_0x55bdab(0x1de)]),addBlacklist(_0x11e385),devices[_0x11e385]['telegramIpApproval']=null,devices[_0x11e385][_0x55bdab(0x1e9)]=null,devices[_0x11e385][_0x55bdab(0x1dd)][_0x55bdab(0x277)]=null,logger[_0x55bdab(0x22c)](_0x55bdab(0x15d)+_0x11e385[_0x55bdab(0x279)](-0x8)),io['to'](getClient(_0x31608f['id'])['uuid'])[_0x55bdab(0x198)](_0x55bdab(0x290),{'access':{'allow':![],'reason':_0x55bdab(0x291),'token':null}});}else logger[_0x55bdab(0x177)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x188b2b){const _0x2878ae=_0x482511,_0xb6bceb=getClient(_0x188b2b['id'])[_0x2878ae(0x137)],_0x592489=getClient(_0x188b2b['id'])['uuid'];_0x188b2b['on']('get-logs',(_0x4f4e09,_0x607b5c)=>{const _0xb4c104=_0x2878ae;if(validateAccess(_0x607b5c,_0x592489)[_0xb4c104(0x1b2)]){if(pid[_0xb6bceb])pid[_0xb6bceb]['send']({'function':_0xb4c104(0x221),'args':_0x4f4e09});}else logger[_0xb4c104(0x177)](_0xb4c104(0x23c));}),_0x188b2b['on'](_0x2878ae(0x304),(_0x418444,_0x2e581f)=>{const _0x20dca7=_0x2878ae;if(validateAccess(_0x2e581f,_0x592489)[_0x20dca7(0x1b2)]){if(pid[_0xb6bceb])pid[_0xb6bceb][_0x20dca7(0x295)]({'function':_0x20dca7(0x23d),'args':_0x418444});}else logger[_0x20dca7(0x177)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x188b2b['on'](_0x2878ae(0x19b),(_0x202f50,_0x51835b)=>{const _0x71fd14=_0x2878ae;if(validateAccess(_0x51835b,_0x592489)[_0x71fd14(0x1b2)]){if(pid[_0xb6bceb])pid[_0xb6bceb][_0x71fd14(0x295)]({'function':_0x71fd14(0x262),'args':_0x202f50});}else logger[_0x71fd14(0x177)](_0x71fd14(0x2ce));}),_0x188b2b['on'](_0x2878ae(0x152),(_0xb56f20,_0x56031c)=>{const _0x3bfe52=_0x2878ae;if(validateAccess(_0x56031c,_0x592489)[_0x3bfe52(0x1b2)]){if(pid[_0xb6bceb])pid[_0xb6bceb]['send']({'function':_0x3bfe52(0x122),'args':_0xb56f20});}else logger['full'](_0x3bfe52(0x143));}),_0x188b2b['on'](_0x2878ae(0x27b),(_0xb2f1f7,_0x4375d0)=>{const _0xec57a3=_0x2878ae;if(validateAccess(_0x4375d0,_0x592489)[_0xec57a3(0x1b2)]){if(pid[_0xb6bceb])pid[_0xb6bceb][_0xec57a3(0x295)]({'function':_0xec57a3(0x2ed),'args':_0xb2f1f7});}else logger[_0xec57a3(0x177)](_0xec57a3(0x25e));}),_0x188b2b['on'](_0x2878ae(0x27d),(_0x195149,_0x1e7a54)=>{const _0x1474c5=_0x2878ae;if(validateAccess(_0x1e7a54,_0x592489)[_0x1474c5(0x1b2)]){if(pid[_0xb6bceb])pid[_0xb6bceb][_0x1474c5(0x295)]({'function':_0x1474c5(0x1d4),'args':_0x195149});}else logger[_0x1474c5(0x177)](_0x1474c5(0x127));}),_0x188b2b['on']('reset-history',_0xb3ad89=>{const _0x1c771f=_0x2878ae;if(validateAccess(_0xb3ad89,_0x592489)['allow']){if(pid[_0xb6bceb])pid[_0xb6bceb]['send']({'function':_0x1c771f(0x121),'args':null});}else logger[_0x1c771f(0x177)](_0x1c771f(0x2d9));}),_0x188b2b['on'](_0x2878ae(0x17d),_0x4ee326=>{const _0x3353d8=_0x2878ae;if(validateAccess(_0x4ee326,_0x592489)[_0x3353d8(0x1b2)]){if(pid[_0xb6bceb])pid[_0xb6bceb][_0x3353d8(0x295)]({'function':_0x3353d8(0x2db),'args':null});}else logger[_0x3353d8(0x177)](_0x3353d8(0x206));}),_0x188b2b['on'](_0x2878ae(0x168),(_0x4f4071,_0x40d642)=>{const _0x5c4013=_0x2878ae;if(validateAccess(_0x40d642,_0x592489)['allow']){if(pid[_0xb6bceb])pid[_0xb6bceb][_0x5c4013(0x295)]({'function':_0x5c4013(0x1d7),'args':_0x4f4071});}else logger[_0x5c4013(0x177)](_0x5c4013(0x2eb));}),_0x188b2b['on']('cancel-loading',_0x575b10=>{const _0x5474e3=_0x2878ae;if(validateAccess(_0x575b10,_0x592489)[_0x5474e3(0x1b2)]){if(pid[_0xb6bceb])pid[_0xb6bceb]['send']({'function':'cancelLoading','args':null});}else logger[_0x5474e3(0x177)](_0x5474e3(0x1e7));}),_0x188b2b['on']('show-config',_0x826942=>{const _0x454ef9=_0x2878ae;if(validateAccess(_0x826942,_0x592489)[_0x454ef9(0x1b2)]){if(pid[_0xb6bceb])pid[_0xb6bceb][_0x454ef9(0x295)]({'function':_0x454ef9(0x15c),'args':null});}else logger['full'](_0x454ef9(0x276));}),_0x188b2b['on'](_0x2878ae(0x299),_0x26bff7=>{const _0x836320=_0x2878ae;if(validateAccess(_0x26bff7,_0x592489)[_0x836320(0x1b2)])updateBB(_0x836320(0x233));else logger[_0x836320(0x177)](_0x836320(0x261));}),_0x188b2b['on']('get-messages',_0x330af6=>{const _0x89da35=_0x2878ae;if(validateAccess(_0x330af6,_0x592489)[_0x89da35(0x1b2)])getMessages();else logger[_0x89da35(0x177)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x188b2b['on'](_0x2878ae(0x289),(_0x1afc75,_0x120dc1)=>{const _0x768ad2=_0x2878ae;if(validateAccess(_0x120dc1,_0x592489)[_0x768ad2(0x1b2)])confirmMessage(_0x1afc75);else logger[_0x768ad2(0x177)](_0x768ad2(0x242));}),_0x188b2b['on']('logout',_0x2afaa5=>{const _0xd56270=_0x2878ae;if(validateAccess(_0x2afaa5,_0x592489)[_0xd56270(0x1b2)]){if(devices[_0x592489][_0xd56270(0x2b1)])clearTimeout(devices[_0x592489][_0xd56270(0x2b1)]);if(devices[_0x592489][_0xd56270(0x136)])clearTimeout(devices[_0x592489][_0xd56270(0x136)]);removeSocketListeners(getClient(_0x188b2b['id'])[_0xd56270(0x1de)]),addBlacklist(_0x592489),devices[_0x592489]['telegramIpApproval']=null,devices[_0x592489][_0xd56270(0x1e9)]=null,devices[_0x592489][_0xd56270(0x1dd)][_0xd56270(0x277)]=null,logger['debug'](_0xd56270(0x15d)+_0x592489['slice'](-0x8)),io['to'](getClient(_0x188b2b['id'])[_0xd56270(0x1de)])['emit']('status',{'access':{'allow':![],'reason':_0xd56270(0x291),'token':null}});}else logger['full'](_0xd56270(0x2ba));});}function removeSocketListeners(_0x4f1aba){const _0x21655a=_0x482511;getClientsWithUuid(_0x4f1aba)[_0x21655a(0x1d6)](_0x2b2497=>{const _0x9c3a65=_0x21655a;getSocket(_0x2b2497['id'])[_0x9c3a65(0x2a7)]();});}function cleanSettings(){const _0x2e006f=_0x482511;let _0x3c006e=settings;return settings[_0x2e006f(0x131)]&&settings[_0x2e006f(0x131)]!=''&&(_0x3c006e={..._0x3c006e,'telegramToken':_0x2e006f(0x105)}),settings['bbPassword']&&settings['bbPassword']!=''&&(_0x3c006e={..._0x3c006e,'bbPassword':_0x2e006f(0x105)}),(settings[_0x2e006f(0x296)]&&settings[_0x2e006f(0x296)]==_0x2e006f(0x1bb)||settings['telegramToken']&&settings[_0x2e006f(0x131)]==_0x2e006f(0x1bb))&&(_0x3c006e={..._0x3c006e,'restored':{'password':settings[_0x2e006f(0x296)]==_0x2e006f(0x1bb),'telegram':settings[_0x2e006f(0x131)]==_0x2e006f(0x1bb)}}),_0x3c006e;}async function updateBB(_0x4739f8){const _0x7dfdf6=_0x482511;await backupConfigFiles(),installingUpdate=!![],config[_0x7dfdf6(0x1d6)](_0x41fdfe=>{const _0x29d336=_0x7dfdf6;restartBot(_0x41fdfe[_0x29d336(0x167)]);});if(_0x4739f8==_0x7dfdf6(0x233))process[_0x7dfdf6(0x295)]({'update':!![],'environment':environment},_0x52c89a=>{});else _0x4739f8==_0x7dfdf6(0x27e)&&process['send']({'reinstall':!![],'environment':environment},_0x4f9c65=>{});}function startBot(_0x4a4c68,_0x586915,_0xd4f46a){const _0x545b03=_0x482511;if(debugging)_0x4a4c68['push']('-d');let _0x495819=![];const _0xa40c4b=_0x4a4c68[0x0];_0x586915={..._0x586915,'stdio':[_0x545b03(0x2b7),_0x545b03(0x2b7),_0x545b03(0x2b7),_0x545b03(0x11d)]},pid[_0xa40c4b]=childProcess[_0x545b03(0x1d2)](botfile,_0x4a4c68,_0x586915),pid[_0xa40c4b]['on'](_0x545b03(0x2ec),_0x59532f=>{const _0x2f7d3b=_0x545b03;switch(Object['keys'](_0x59532f)[0x0]){case _0x2f7d3b(0x2c7):updateBotName(_0xa40c4b,_0x59532f[_0x2f7d3b(0x2c7)]);break;case'updatebotmanager':updateBotManager();break;case _0x2f7d3b(0x290):updateStatus(_0xa40c4b,_0x59532f[_0x2f7d3b(0x290)]);break;case _0x2f7d3b(0x22d):updateLive(_0xa40c4b,_0x59532f[_0x2f7d3b(0x22d)]);break;case _0x2f7d3b(0x219):updateLive(_0xa40c4b,_0x59532f[_0x2f7d3b(0x219)]),io['to'](_0xa40c4b)['emit']('status',{'access':{'allow':![],'reason':_0x2f7d3b(0x18e),'token':null}});break;case _0x2f7d3b(0x1fa):_0x59532f[_0x2f7d3b(0x1fa)]==_0x2f7d3b(0x28f)&&restartBot(_0xa40c4b);_0x59532f[_0x2f7d3b(0x1fa)]==_0x2f7d3b(0x20e)&&toggleBot(_0xa40c4b,_0x2f7d3b(0x20f),_0x2f7d3b(0x11f));break;case _0x2f7d3b(0x29e):sendTelegramBot(_0xa40c4b,_0x59532f[_0x2f7d3b(0x29e)]);break;case _0x2f7d3b(0x258):sendTelegramMsg(_0x59532f['telegrammsg']);break;case _0x2f7d3b(0x14d):io['to'](_0xa40c4b)[_0x2f7d3b(0x198)](_0x59532f['function'],_0x59532f[_0x2f7d3b(0x2e8)]);break;}}),pid[_0xa40c4b]['on'](_0x545b03(0x10b),function(_0x4fbde1){if(_0x495819)return;_0x495819=!![],_0xd4f46a(_0x4fbde1);}),pid[_0xa40c4b]['on'](_0x545b03(0x28b),async function(_0x3c94cf){const _0x47e5e1=_0x545b03;if(terminating)return;if(installingUpdate){logger[_0x47e5e1(0x22c)](_0x47e5e1(0x132)),io[_0x47e5e1(0x1bc)]();return;}if(_0x495819)return;_0x495819=!![],_0xd4f46a(null);const _0x2fd07e=dbConfig[_0x47e5e1(0x223)]('bots')['find']({'botID':_0xa40c4b})[_0x47e5e1(0x2e0)]();_0x2fd07e&&(_0x2fd07e[_0x47e5e1(0x290)]==_0x47e5e1(0x20a)||_0x2fd07e[_0x47e5e1(0x290)]==_0x47e5e1(0x1c1))&&(await sleep(0x3e8),updateLive(_0xa40c4b,'stopped'),logger[_0x47e5e1(0x177)](_0x47e5e1(0x2bc)+_0xa40c4b),startBot([_0xa40c4b,userID],{'cwd':bbpath},function(_0x3e06bb){const _0x31fde3=_0x47e5e1;if(_0x3e06bb)logger[_0x31fde3(0x177)](_0x3e06bb);}));});}function stopBot(_0x1e19fe){const _0x29dc87=_0x482511;getClientsWithBotID(_0x1e19fe)['forEach'](_0x3f6b0b=>{const _0x5def43=_0x4219;getSocket(_0x3f6b0b['id'])[_0x5def43(0x111)](!![]),removeClient(_0x3f6b0b['id']);}),pid[_0x1e19fe]&&(pid[_0x1e19fe][_0x29dc87(0x20e)](),pid[_0x1e19fe]=null);}function stopAllBots(){const _0x9c0bf1=_0x482511;terminating=!![];const _0x3dd431=getEnabledBots();_0x3dd431[_0x9c0bf1(0x1d6)](_0x1575fd=>{stopBot(_0x1575fd['botID']);});}function restartBot(_0x440151){const _0x330b41=_0x482511;if(pid[_0x440151])pid[_0x440151][_0x330b41(0x20e)]();}function addBot(){const _0x54f0fb=_0x482511;let _0x3728d1;for(let _0x42acf6=0x1;_0x42acf6<0x3e9;_0x42acf6++){_0x3728d1=_0x42acf6[_0x54f0fb(0x292)]()[_0x54f0fb(0x112)](0x3,'0');let _0x3dfc8a=config['find'](_0x250d00=>_0x250d00[_0x54f0fb(0x167)]==_0x3728d1);if(!_0x3dfc8a)break;}if(_0x3728d1===_0x54f0fb(0x26f)){logger[_0x54f0fb(0x177)](_0x54f0fb(0x1b5));return;}logger[_0x54f0fb(0x177)](_0x54f0fb(0x2c9)+_0x3728d1),dbConfig[_0x54f0fb(0x223)]('bots')[_0x54f0fb(0x248)]({'botID':_0x3728d1,'botname':_0x54f0fb(0x161)+_0x3728d1,'status':'new','live':''})['write'](),startBot([_0x3728d1,userID],{'cwd':bbpath},function(_0x351175){if(_0x351175)logger['full'](_0x351175);}),config=getConfiguration(),io['to'](_0x54f0fb(0x1db))[_0x54f0fb(0x198)]('bots',config),broadcastToBots(_0x54f0fb(0x2c5),JSON[_0x54f0fb(0x1b6)](config));}function _0x36d1(){const _0x5cea6f=['restart_','User\x20has\x20been\x20validated','resetpw_yes','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Crypt','isDirectory','/names\x20-\x20show\x20bot\x20names\x0a','crypto','confirm-message','reason','exit','getMonth','version','Starting\x20(','restart','status','logged\x20out','toString','261016KXbAzK','names','send','bbPassword','Notifications\x20disabled\x0a','order','update-bb','uuid-random','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','search','staging','telegram','Error\x20while\x20deleting\x20config\x20files:\x20','isIPv4MappedAddress','ipv6','whitelist','#RES#\x20if\x20running\x20locally\x0a','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','copyFileSync','bbUsername','removeAllListeners','\x20mode','headless','build','\x1b[0m','30\x20min','hasOwnProperty','match','Yes','config/','pidRefreshToken','createServer','assign','getSeconds','kind','Unauthorized\x20attempt\x20to\x20update\x20bot','inherit','post','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Unauthorized\x20attempt\x20to\x20log\x20out','access\x20timeout','Restarting\x20Bot\x20','apply','endsWith','showname','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','/:bot/coins','#RES#\x20if\x20running\x20on\x20server','f2aRequired','createWriteStream','bots','(((.+)+)+)+$','botname','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Starting\x20new\x20bot\x20|\x20Bot\x20','sort','set','bb/','compareSync','Unauthorized\x20attempt\x20to\x20get\x20portfolio','from','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','-results.json','/enable\x20-\x20enable\x20notifications\x0a','connection','\x20only\x0a','rmSync','8812323CzRqJK','15\x20min','temporary\x20access\x20not\x20allowed','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','You\x20can\x20use\x20the\x20following\x20commands:\x0a','getStartingBalances','Login\x20accepted','simple','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','tempaccess_30_','value','<b>Balance\x20Bot\x20Status:</b>\x0a','/:bot/performance','127.0.0.1','command','IPv4','/:bot/configuration','Restoring\x20bot(s)\x20from\x20backup','args','number','Enabled\x20Bot\x20','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','message','storeHeadless','lastmsgemitted','new-disabled','sendPortfolioTelegram','child_process','map','telegramEnabled','zip/','argv','mkdirSync','=>\x20Go\x20to\x20#CYA#http://','_data','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Restore\x20process\x20confirmed','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','getUTCHours','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','lowdb/adapters/FileSync','encryptedUuid','apiPassword','clients','logs/','port','delete-alerts','reset-password','/help\x20-\x20show\x20available\x20commands\x0a','any','help','tkn','bbvReceive','hashSync','generate','************','text','timeshift','enable','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','exchange','error','2FA\x20login\x20required','address','writeFileSync','temporary\x20token\x20generated','start','disconnect','padStart','data','temporaryAccessAllowed','manual','split','store','download','::ffff:127.0.0.1','build2','hybrid-crypto-js','password','ipc','getMinutes','stopped','/status\x20-\x20show\x20bot(s)\x20status\x0a','resetHistory','storeConfiguration','cloneDeep','Telegraf\x20error:','<b>Telegram\x20Bot\x20Status:</b>\x0a','files','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','node-zip','Unauthorized\x20attempt\x20to\x20delete\x20bot','-events.json','then','update_no','conn','mixpanel','action','[ip-address]','telegramToken','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','button','track','backup','pidExpireLogin','bot','readdirSync','getFullYear','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update',')\x20|\x20Bot\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','SIGTERM','unlinkSync','jsonwebtoken','telegramChatId','exec','tempaccess_5_','Unauthorized\x20attempt\x20to\x20store\x20configuration','File\x20uploaded','output-001.log','No\x20bots\x20running\x20right\x20now','SIGINT','env','login2fa_reject_','onepagemode','Your\x20installation\x20is\x20already\x20up\x20to\x20date','parse','function','username','1646718lyrCUy','/download/:type','Backup\x20file\x20unzipped\x20and\x20stored','store-configuration','readFileSync','telegramUsername','getHours',',\x20must\x20be\x20a\x204\x20digit\x20number','socket.io','existsSync','loginRequired','once','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','showConfig','Logged\x20out\x20user\x20...','portfolio','string','add','Bot\x20','Notifications\x20disabled','alerts','success','sortBy','\x20|\x20client:\x20...','botID','place-order','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20messages','static','get-messages','46YRuFDO','/:bot','auto','hex','remove','server','login\x20not\x20required','\x20(2)','initclient','\x20(1)','full','Orders','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','backupfile','type','Allow\x20login\x20from\x20IP\x20address\x20','get-starting-balances','latestversion',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','6b67f3d61ee94b8f5c80b4affef4c4d9','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','inlineKeyboard','environment','userid','Alerts','2FA\x20required','init','show','resetpw_no','sha256','Deleted\x20Bot\x20','/on\x20-\x20start\x20bot(s)\x0a','Idling\x20(','reload','path','\x20|\x20user:\x20...','metrics_','bot-','statSync','Ok,\x20will\x20send\x20order\x20notifications\x20only','-config.json','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Access\x20enabled\x20for\x20','emit','2FA\x20login\x20rejected','launch','get-portfolio','config','format','\x20|\x20','lastmsgtelegram','internal','-performance.json','off','verify','RSA','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','get-backup-files','\x20minutes','test','\x20>\x20','toggleBotMode','getDate','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','notification','sockets','Markdown','defaults','/off\x20-\x20stop\x20bot(s)\x0a','allow','write',':\x20Bot\x20Mgr\x20>\x20','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','stringify','on_','decrypt','headers','All\x20bots','***','close','editMessageReplyMarkup','\x1b[33m','messages','All','new','settings','update-bot','telegramEvents','bot.js','secret','publicKey','0.0.0','config_orders','find','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','RSA-OAEP','sendFile','index.html','settings.','\x1b[34m','2FA\x20login\x20token\x20generated','fork','.zip','storeFiat','remoteAddress','forEach','placeOrder','listen','-----------------------------------------------------------------------------------','(staging)','botmanager','NTBA_FIX_319','access','uuid','length','login\x20required','\x1b[31m','delete-bot','clientip','temporary\x20access\x20rejected','reply','telegramIpApproval','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','login\x20token\x20generated','telegram2FaApproval','getTime','5883184Kbyhwq','filter','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','HTML','store-settings','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','$1_$2_$3','api-eu.mixpanel.com','backup-full@','chat','14mJkEXY','Notifications\x20enabled\x0a','blacklist','alias','version.json','stop','toIPv4MappedAddress','callback','Notifications\x20enabled','use','yes','Unauthorized\x20attempt\x20to\x20download\x20','lowdb','mode','Invalid\x20authentication\x20token\x20(1)','All\x20bots\x20running\x20right\x20now','2FA','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','params','sendMetricsTelegram','enabled','file','all','Unauthorized\x20login\x20attempt\x20(timeout)','kill','disabled','Invalid\x20username\x20or\x20IP\x20address','bbvNew','\x1b[35m','isValid','logout','auth','Setting\x20access:\x20','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','startsWith','started','Network\x20Interfaces:','Starting\x20Balance\x20Bot\x20update','replace','versions','3132705muajFw','\x1b[36m','date-fns','emitHistory','::1','get','constructor','Error\x20removing\x20old\x20backup\x20files:','event','backup-full','bb-secure.json','reinstall-bb','temporary\x20access\x20timeout','output-000.log','debug','live','Unauthorized\x20attempt\x20to\x20update\x20settings','backup-full.zip','Login\x20rejected','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','update','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Invalid\x20authentication\x20token\x20(2)','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','graphql-request',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','restore_no_','name','ipaddr.js','Unauthorized\x20attempt\x20to\x20get\x20events','deleteHistoryAlerts','keys','bb-config.json','/metrics\x20-\x20show\x20bot\x20performance\x0a','referer','Unauthorized\x20attempt\x20to\x20confirm\x20message','catch','invalid\x20credentials','No\x20authentication\x20token','update_yes','/update\x20-\x20update\x20Balance\x20Bot\x0a','push','mtime','Bot\x20Mgr\x20>\x20','Server','family','sign','socket','generateKeyPairAsync','backup/','*$1*','apiSecret','Starting\x20Balance\x20Bot\x20reinstallation','config_all','node','config_alerts','Node.js\x20v','telegrammsg','util','binary','uncaughtException','233088kybZJT','/disable\x20-\x20disable\x20notifications\x0a','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','privateKey','log','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','getPortfolio','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Invalid\x20IP\x20address','secure','expiry','Restore\x20backup\x20file\x20','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','reject','reinstall_no','/restart\x20-\x20restart\x20bot(s)\x0a','Password\x20reset\x20rejected','orders','login','1000','Disabled\x20Bot\x20','5\x20min','13306UxAUZp','Unauthorized\x20attempt\x20to\x20add\x20bot','axios','timestamp','Unauthorized\x20attempt\x20to\x20show\x20configuration','token','join','slice','DEFLATE','store-headless','apiKey','store-fiat','reinstall','handshake','Restore\x20process\x20aborted'];_0x36d1=function(){return _0x5cea6f;};return _0x36d1();}function deleteBot(_0x5f3617){const _0x2bb40a=_0x482511;getClientsWithBotID(_0x5f3617)[_0x2bb40a(0x1d6)](_0x2173b2=>{getSocket(_0x2173b2['id'])['disconnect'](!![]),removeClient(_0x2173b2['id']);}),dbConfig[_0x2bb40a(0x223)](_0x2bb40a(0x2c5))[_0x2bb40a(0x171)]({'botID':_0x5f3617})[_0x2bb40a(0x1b3)](),logger[_0x2bb40a(0x177)](_0x2bb40a(0x18b)+_0x5f3617),stopBot(_0x5f3617);try{if(fs[_0x2bb40a(0x158)](path[_0x2bb40a(0x278)](configpath,'bot-'+_0x5f3617+_0x2bb40a(0x195))))fs[_0x2bb40a(0x13e)](path[_0x2bb40a(0x278)](configpath,_0x2bb40a(0x192)+_0x5f3617+_0x2bb40a(0x195)));if(fs[_0x2bb40a(0x158)](path['join'](configpath,_0x2bb40a(0x192)+_0x5f3617+_0x2bb40a(0x12a))))fs[_0x2bb40a(0x13e)](path[_0x2bb40a(0x278)](configpath,_0x2bb40a(0x192)+_0x5f3617+_0x2bb40a(0x12a)));if(fs[_0x2bb40a(0x158)](path[_0x2bb40a(0x278)](configpath,_0x2bb40a(0x192)+_0x5f3617+_0x2bb40a(0x1a1))))fs[_0x2bb40a(0x13e)](path[_0x2bb40a(0x278)](configpath,_0x2bb40a(0x192)+_0x5f3617+_0x2bb40a(0x1a1)));if(fs['existsSync'](path[_0x2bb40a(0x278)](configpath,'bot-'+_0x5f3617+_0x2bb40a(0x2d1))))fs[_0x2bb40a(0x13e)](path[_0x2bb40a(0x278)](configpath,'bot-'+_0x5f3617+_0x2bb40a(0x2d1)));}catch(_0x535da6){if(_0x535da6)logger[_0x2bb40a(0x177)](_0x2bb40a(0x29f),_0x535da6);}config=getConfiguration(),io['to']('botmanager')[_0x2bb40a(0x198)](_0x2bb40a(0x2c5),config),broadcastToBots(_0x2bb40a(0x2c5),JSON[_0x2bb40a(0x1b6)](config));}function toggleBot(_0x2b0086,_0x59f777,_0x1e40fe){const _0x4cc7ec=_0x482511;dbConfig[_0x4cc7ec(0x223)](_0x4cc7ec(0x2c5))[_0x4cc7ec(0x1ca)]({'botID':_0x2b0086})[_0x4cc7ec(0x2b3)]({'status':_0x59f777})[_0x4cc7ec(0x2b3)]({'live':_0x1e40fe})[_0x4cc7ec(0x1b3)]();if(_0x59f777==_0x4cc7ec(0x20a)||_0x59f777=='new')logger[_0x4cc7ec(0x177)](_0x4cc7ec(0x2ea)+_0x2b0086),startBot([_0x2b0086,userID],{'cwd':bbpath},function(_0x17e7f1){const _0x111a67=_0x4cc7ec;if(_0x17e7f1)logger[_0x111a67(0x177)](_0x17e7f1);});else(_0x59f777=='disabled'||_0x59f777==_0x4cc7ec(0x2ef))&&(logger[_0x4cc7ec(0x177)](_0x4cc7ec(0x270)+_0x2b0086),stopBot(_0x2b0086));config=getConfiguration(),io['to'](_0x4cc7ec(0x1db))['emit']('bots',config),broadcastToBots(_0x4cc7ec(0x2c5),JSON[_0x4cc7ec(0x1b6)](config));}function toggleStatus(_0x46c2f5){const _0x9ef7d0=_0x482511;let _0x267df4=dbConfig[_0x9ef7d0(0x223)](_0x9ef7d0(0x2c5))[_0x9ef7d0(0x1ca)]({'botID':_0x46c2f5})[_0x9ef7d0(0x2e0)](),_0x134484;if(_0x267df4[_0x9ef7d0(0x290)]==='enabled')_0x134484=_0x9ef7d0(0x20f);else{if(_0x267df4[_0x9ef7d0(0x290)]==='new')_0x134484=_0x9ef7d0(0x2ef);else{if(_0x267df4[_0x9ef7d0(0x290)]===_0x9ef7d0(0x2ef))_0x134484=_0x9ef7d0(0x1c1);else{if(_0x267df4['status']===_0x9ef7d0(0x20f))_0x134484=_0x9ef7d0(0x20a);}}}return _0x134484;}function updateStatus(_0x52d725,_0x404074){const _0x41d843=_0x482511;dbConfig[_0x41d843(0x223)](_0x41d843(0x2c5))[_0x41d843(0x1ca)]({'botID':_0x52d725})[_0x41d843(0x2b3)]({'status':_0x404074})['write'](),config=getConfiguration(),io['to'](_0x41d843(0x1db))[_0x41d843(0x198)]('bots',config),broadcastToBots(_0x41d843(0x2c5),JSON[_0x41d843(0x1b6)](config));}function updateLive(_0x5d4618,_0x4c0eb7){const _0x4ea0b4=_0x482511;dbConfig[_0x4ea0b4(0x223)](_0x4ea0b4(0x2c5))[_0x4ea0b4(0x1ca)]({'botID':_0x5d4618})['assign']({'live':_0x4c0eb7})[_0x4ea0b4(0x1b3)](),config=getConfiguration(),io['to'](_0x4ea0b4(0x1db))[_0x4ea0b4(0x198)](_0x4ea0b4(0x2c5),config),broadcastToBots(_0x4ea0b4(0x2c5),JSON[_0x4ea0b4(0x1b6)](config));}function updateBotName(_0x4fd4d2,_0x1fd892){const _0x127733=_0x482511;dbConfig['get'](_0x127733(0x2c5))[_0x127733(0x1ca)]({'botID':_0x4fd4d2})[_0x127733(0x2b3)]({'botname':_0x1fd892})[_0x127733(0x1b3)](),config=getConfiguration(),io['to'](_0x127733(0x1db))[_0x127733(0x198)](_0x127733(0x2c5),config),broadcastToBots(_0x127733(0x2c5),JSON['stringify'](config));}function updateBotManager(){const _0x40776d=_0x482511;config=getConfiguration(),io['to'](_0x40776d(0x1db))[_0x40776d(0x198)](_0x40776d(0x2c5),config),broadcastToBots(_0x40776d(0x2c5),JSON['stringify'](config));}function toggleBotMode(_0x3cf2ea){const _0xaa2028=_0x482511;if(pid[_0x3cf2ea])pid[_0x3cf2ea][_0xaa2028(0x295)]({'function':_0xaa2028(0x1aa),'args':null});else{const _0xa71dc5=configpath+_0xaa2028(0x192)+_0x3cf2ea+_0xaa2028(0x195),_0x15a657=fs[_0xaa2028(0x153)](_0xa71dc5),_0x50d44f=JSON[_0xaa2028(0x14c)](_0x15a657),_0x1a1fef=_0x50d44f[_0xaa2028(0x137)][0x0][_0xaa2028(0x2a9)];_0x50d44f[_0xaa2028(0x137)][0x0][_0xaa2028(0x2a9)]=!_0x1a1fef;const _0x5b5c6f=JSON[_0xaa2028(0x1b6)](_0x50d44f,null,0x2);fs[_0xaa2028(0x10e)](_0xa71dc5,_0x5b5c6f),config=getConfiguration(),io['to'](_0xaa2028(0x1db))[_0xaa2028(0x198)](_0xaa2028(0x2c5),config),broadcastToBots(_0xaa2028(0x2c5),JSON[_0xaa2028(0x1b6)](config));}}function validateTelegram(_0x589ddb){const _0x2e7607=_0x482511;if(_0x589ddb[_0x2e7607(0x2cf)]['username']!=settings['telegramUsername']&&'@'+_0x589ddb['from'][_0x2e7607(0x14e)]!=settings[_0x2e7607(0x154)]||_0x589ddb[_0x2e7607(0x1f4)]['id']!=settings[_0x2e7607(0x140)])return sendTelegram(_0x589ddb[_0x2e7607(0x1f4)]['id'],_0x2e7607(0x2d0),{'parse_mode':_0x2e7607(0x1ee)}),![];return!![];}async function initTelegram(){const _0x6afc48=_0x482511;if(tgBot)tgBot[_0x6afc48(0x1fa)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0x52e4ba=_0x6afc48(0x2da);_0x52e4ba+='\x0a',_0x52e4ba+=_0x6afc48(0x2d2),_0x52e4ba+=_0x6afc48(0x25d),_0x52e4ba+=_0x6afc48(0x268),_0x52e4ba+=_0x6afc48(0x26b),_0x52e4ba+=_0x6afc48(0x18c),_0x52e4ba+=_0x6afc48(0x1b1),_0x52e4ba+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x52e4ba+=_0x6afc48(0x287),_0x52e4ba+=_0x6afc48(0x120),_0x52e4ba+=_0x6afc48(0x240),_0x52e4ba+=_0x6afc48(0x2c0),_0x52e4ba+=_0x6afc48(0x247),_0x52e4ba+=_0x6afc48(0x234),_0x52e4ba+=_0x6afc48(0xfe);let _0x4dba0a=_0x6afc48(0x207);_0x4dba0a+='\x0a',_0x4dba0a+=_0x52e4ba,tgBot[_0x6afc48(0x243)]((_0x2295ca,_0x3a46f8)=>{const _0x1b10bd=_0x6afc48;logger[_0x1b10bd(0x2dd)](getTimeStamp()+_0x1b10bd(0x238)),logger[_0x1b10bd(0x22c)](_0x1b10bd(0x124),_0x2295ca);}),tgBot[_0x6afc48(0x1fe)](async(_0x1ad755,_0x463839)=>{const _0x4bc7b0=_0x6afc48;if(!(!settings[_0x4bc7b0(0x140)]&&_0x1ad755[_0x4bc7b0(0x233)][_0x4bc7b0(0x2ec)][_0x4bc7b0(0x106)]=='/start')){if(!validateTelegram(_0x1ad755))return;}_0x463839();}),tgBot[_0x6afc48(0x2e4)](_0x6afc48(0x110),async _0xef4af6=>{const _0x156739=_0x6afc48;if(!settings[_0x156739(0x140)])updateSetting('telegramChatId',_0xef4af6[_0x156739(0x1f4)]['id']);updateSetting('telegramEnabled',!![]);if(!validateTelegram(_0xef4af6))return;await sendTelegram(_0xef4af6['chat']['id'],_0x4dba0a);}),tgBot[_0x6afc48(0x2e4)](_0x6afc48(0x108),async _0xfe7540=>{const _0x1e220b=_0x6afc48;updateSetting(_0x1e220b(0x2f3),!![]),await sendTelegram(_0xfe7540[_0x1e220b(0x1f4)]['id'],_0x1e220b(0x1fd));}),tgBot[_0x6afc48(0x2e4)]('disable',async _0x12d172=>{const _0x50f32e=_0x6afc48;await sendTelegram(_0x12d172[_0x50f32e(0x1f4)]['id'],_0x50f32e(0x162)),updateSetting('telegramEnabled',![]);}),tgBot['command'](_0x6afc48(0x19c),async _0x5834c7=>{const _0x5ca018=_0x6afc48,_0x1b022c=Markup['inlineKeyboard']([Markup[_0x5ca018(0x133)][_0x5ca018(0x1fc)](_0x5ca018(0x178),'config_orders'),Markup['button'][_0x5ca018(0x1fc)](_0x5ca018(0x185),_0x5ca018(0x256)),Markup[_0x5ca018(0x133)]['callback'](_0x5ca018(0x1c0),'config_all')]);_0x5834c7[_0x5ca018(0x1e5)](_0x5ca018(0x2de),_0x1b022c);}),tgBot['action'](_0x6afc48(0x1c9),async _0x1cf1db=>{const _0x12a29e=_0x6afc48;_0x1cf1db[_0x12a29e(0x1bd)](),updateSetting(_0x12a29e(0x1c4),_0x12a29e(0x26d)),updateSetting(_0x12a29e(0x2f3),!![]),await sendTelegram(_0x1cf1db[_0x12a29e(0x1f4)]['id'],_0x12a29e(0x194));}),tgBot[_0x6afc48(0x12f)](_0x6afc48(0x256),async _0x35f37b=>{const _0xf4271b=_0x6afc48;_0x35f37b['editMessageReplyMarkup'](),updateSetting(_0xf4271b(0x1c4),_0xf4271b(0x163)),updateSetting(_0xf4271b(0x2f3),!![]),await sendTelegram(_0x35f37b[_0xf4271b(0x1f4)]['id'],_0xf4271b(0x284));}),tgBot['action'](_0x6afc48(0x254),async _0x1ee69d=>{const _0x2b1359=_0x6afc48;_0x1ee69d['editMessageReplyMarkup'](),updateSetting('telegramEvents',_0x2b1359(0x20c)),updateSetting(_0x2b1359(0x2f3),!![]),await sendTelegram(_0x1ee69d[_0x2b1359(0x1f4)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot['command'](_0x6afc48(0x290),async _0x252d25=>{const _0x22be44=_0x6afc48,_0x215d63=getBotsWithMode();let _0x2cdf87=_0x22be44(0x2e1);config[_0x22be44(0x1d6)](_0x3ec7bf=>{const _0x4044c9=_0x22be44,_0x34b883=_0x215d63['find'](_0x2c35f2=>_0x2c35f2['botID']==_0x3ec7bf[_0x4044c9(0x167)])['mode'];_0x2cdf87+=_0x4044c9(0x161)+_0x3ec7bf[_0x4044c9(0x167)]+':\x20'+_0x3ec7bf[_0x4044c9(0x290)]+_0x4044c9(0x19e)+_0x34b883+_0x4044c9(0x19e)+_0x3ec7bf[_0x4044c9(0x22d)]+'\x0a';}),_0x2cdf87+='\x0a',_0x2cdf87+=_0x22be44(0x125),_0x2cdf87+=!settings['telegramEnabled']?_0x22be44(0x297):_0x22be44(0x1f6),_0x2cdf87+=settings[_0x22be44(0x2f3)]?settings[_0x22be44(0x1c4)]==_0x22be44(0x20c)?_0x22be44(0x196):'Notifications\x20types:\x20'+settings[_0x22be44(0x1c4)]+_0x22be44(0x2d4):'',await sendTelegram(_0x252d25[_0x22be44(0x1f4)]['id'],_0x2cdf87,{'parse_mode':_0x22be44(0x1ee)});}),tgBot['command'](_0x6afc48(0x28f),async _0x5236df=>{const _0x276d4b=_0x6afc48,_0x38e713=getEnabledBots();if(_0x38e713[_0x276d4b(0x1df)]==0x0)await sendTelegram(_0x5236df[_0x276d4b(0x1f4)]['id'],_0x276d4b(0x146));else{if(_0x38e713['length']>0x1)_0x38e713[_0x276d4b(0x248)]({'botID':_0x276d4b(0x20c)});let _0x505a1b=[],_0x46accc=[];const _0x140cb0=_0x38e713[_0x276d4b(0x1df)]%0x4==0x0||_0x38e713[_0x276d4b(0x1df)]%0x4==0x3||_0x38e713['length']%0x3==0x1?0x4:0x3;let _0x1e5cce=0x0;_0x38e713[_0x276d4b(0x1d6)]((_0x287fdf,_0x474e28)=>{const _0x592ef0=_0x276d4b;if(_0x474e28%_0x140cb0==0x0)_0x46accc=[];_0x46accc[_0x592ef0(0x248)](Markup['button'][_0x592ef0(0x1fc)](_0x287fdf[_0x592ef0(0x167)]=='all'?'All\x20bots':_0x592ef0(0x161)+_0x287fdf[_0x592ef0(0x167)],_0x592ef0(0x281)+_0x287fdf['botID'])),_0x474e28%_0x140cb0==0x0&&(_0x505a1b[_0x1e5cce]=_0x46accc,_0x1e5cce++);});const _0x27e972=Markup['inlineKeyboard'](_0x505a1b);_0x5236df[_0x276d4b(0x1e5)](_0x276d4b(0x2b9),_0x27e972);}}),tgBot['action'](/restart_(.+)/,async _0xa38248=>{const _0x3e98e2=_0x6afc48,_0x4b6538=_0xa38248['match'][0x1];_0xa38248[_0x3e98e2(0x1bd)](),_0x4b6538==_0x3e98e2(0x20c)?config[_0x3e98e2(0x1d6)](_0x284b3a=>{const _0x217eb1=_0x3e98e2;restartBot(_0x284b3a[_0x217eb1(0x167)]);}):restartBot(_0x4b6538);}),tgBot[_0x6afc48(0x2e4)]('on',async _0x140505=>{const _0x599d59=_0x6afc48,_0x28fbb2=getDisabledBots();if(_0x28fbb2[_0x599d59(0x1df)]==0x0)await sendTelegram(_0x140505['chat']['id'],_0x599d59(0x204));else{if(_0x28fbb2['length']>0x1)_0x28fbb2['push']({'botID':_0x599d59(0x20c)});let _0x4154e4=[],_0x54e314=[];const _0x364813=_0x28fbb2[_0x599d59(0x1df)]%0x4==0x0||_0x28fbb2[_0x599d59(0x1df)]%0x4==0x3||_0x28fbb2[_0x599d59(0x1df)]%0x3==0x1?0x4:0x3;let _0x57cdcd=0x0;_0x28fbb2[_0x599d59(0x1d6)]((_0x112202,_0x34a8ab)=>{const _0x3d8817=_0x599d59;if(_0x34a8ab%_0x364813==0x0)_0x54e314=[];_0x54e314['push'](Markup[_0x3d8817(0x133)]['callback'](_0x112202[_0x3d8817(0x167)]==_0x3d8817(0x20c)?'All\x20bots':'Bot\x20'+_0x112202[_0x3d8817(0x167)],_0x3d8817(0x1b7)+_0x112202['botID'])),_0x34a8ab%_0x364813==0x0&&(_0x4154e4[_0x57cdcd]=_0x54e314,_0x57cdcd++);});const _0x484c49=Markup[_0x599d59(0x182)](_0x4154e4);_0x140505['reply'](_0x599d59(0x29b),_0x484c49);}}),tgBot[_0x6afc48(0x12f)](/on_(.+)/,async _0x3f3987=>{const _0x2ae323=_0x6afc48,_0x4e4b6c=_0x3f3987['match'][0x1];_0x3f3987['editMessageReplyMarkup']();if(_0x4e4b6c=='all'){const _0x4234c3=getDisabledBots();await sendTelegram(_0x3f3987[_0x2ae323(0x1f4)]['id'],_0x2ae323(0x1ed)),_0x4234c3[_0x2ae323(0x1d6)](_0x3bdcd9=>{const _0x59fc2=_0x2ae323;if(_0x3bdcd9[_0x59fc2(0x167)]!=_0x59fc2(0x20c))toggleBot(_0x3bdcd9['botID'],toggleStatus(_0x3bdcd9[_0x59fc2(0x167)]),_0x59fc2(0x11f));});}else await sendTelegram(_0x3f3987[_0x2ae323(0x1f4)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x4e4b6c),toggleBot(_0x4e4b6c,toggleStatus(_0x4e4b6c),_0x2ae323(0x11f));}),tgBot[_0x6afc48(0x2e4)](_0x6afc48(0x1a2),async _0x18f3a5=>{const _0x431551=_0x6afc48,_0x1b823b=getEnabledBots();if(_0x1b823b[_0x431551(0x1df)]==0x0)await sendTelegram(_0x18f3a5[_0x431551(0x1f4)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x1b823b[_0x431551(0x1df)]>0x1)_0x1b823b[_0x431551(0x248)]({'botID':_0x431551(0x20c)});let _0xf17483=[],_0x43f3f3=[];const _0x190f15=_0x1b823b[_0x431551(0x1df)]%0x4==0x0||_0x1b823b[_0x431551(0x1df)]%0x4==0x3||_0x1b823b[_0x431551(0x1df)]%0x3==0x1?0x4:0x3;let _0x5bdfe4=0x0;_0x1b823b['forEach']((_0x511802,_0x383951)=>{const _0x20ce91=_0x431551;if(_0x383951%_0x190f15==0x0)_0x43f3f3=[];_0x43f3f3['push'](Markup[_0x20ce91(0x133)][_0x20ce91(0x1fc)](_0x511802['botID']==_0x20ce91(0x20c)?_0x20ce91(0x1ba):_0x20ce91(0x161)+_0x511802['botID'],'off_'+_0x511802[_0x20ce91(0x167)])),_0x383951%_0x190f15==0x0&&(_0xf17483[_0x5bdfe4]=_0x43f3f3,_0x5bdfe4++);});const _0x2db628=Markup[_0x431551(0x182)](_0xf17483);_0x18f3a5[_0x431551(0x1e5)](_0x431551(0x13c),_0x2db628);}}),tgBot[_0x6afc48(0x12f)](/off_(.+)/,async _0x3e1d76=>{const _0x2163f5=_0x6afc48,_0x392699=_0x3e1d76['match'][0x1];_0x3e1d76['editMessageReplyMarkup']();if(_0x392699=='all'){const _0x8377a=getEnabledBots();await sendTelegram(_0x3e1d76[_0x2163f5(0x1f4)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots'),_0x8377a[_0x2163f5(0x1d6)](_0x4bf425=>{const _0x58c888=_0x2163f5;if(_0x4bf425[_0x58c888(0x167)]!=_0x58c888(0x20c))toggleBot(_0x4bf425[_0x58c888(0x167)],toggleStatus(_0x4bf425[_0x58c888(0x167)]),'stopped');});}else await sendTelegram(_0x3e1d76[_0x2163f5(0x1f4)]['id'],_0x2163f5(0x169)+_0x392699),toggleBot(_0x392699,toggleStatus(_0x392699),'stopped');}),tgBot[_0x6afc48(0x2e4)]('metrics',async _0x47f004=>{const _0xb7cee8=_0x6afc48,_0x5a6798=getEnabledBots();if(_0x5a6798[_0xb7cee8(0x1df)]==0x0)await sendTelegram(_0x47f004[_0xb7cee8(0x1f4)]['id'],_0xb7cee8(0x146));else{if(_0x5a6798['length']>0x1){let _0x314db1=[],_0x46cc51=[];const _0x5dc79c=_0x5a6798[_0xb7cee8(0x1df)]%0x4==0x0||_0x5a6798[_0xb7cee8(0x1df)]%0x4==0x3||_0x5a6798[_0xb7cee8(0x1df)]%0x3==0x1?0x4:0x3;let _0x4d88c6=0x0;_0x5a6798[_0xb7cee8(0x1d6)]((_0x31c0e4,_0x412d8a)=>{const _0x9889d6=_0xb7cee8;if(_0x412d8a%_0x5dc79c==0x0)_0x46cc51=[];_0x46cc51[_0x9889d6(0x248)](Markup[_0x9889d6(0x133)][_0x9889d6(0x1fc)]('Bot\x20'+_0x31c0e4[_0x9889d6(0x167)],_0x9889d6(0x191)+_0x31c0e4[_0x9889d6(0x167)])),_0x412d8a%_0x5dc79c==0x0&&(_0x314db1[_0x4d88c6]=_0x46cc51,_0x4d88c6++);});const _0x19fd1f=Markup['inlineKeyboard'](_0x314db1);_0x47f004[_0xb7cee8(0x1e5)](_0xb7cee8(0x2c8),_0x19fd1f);}else{const _0x2496dd=_0x5a6798[0x0][_0xb7cee8(0x167)];if(pid[_0x2496dd])pid[_0x2496dd][_0xb7cee8(0x295)]({'function':_0xb7cee8(0x209),'args':null});}}}),tgBot[_0x6afc48(0x12f)](/metrics_(.+)/,async _0x1b2b13=>{const _0x578946=_0x6afc48,_0x242ab0=_0x1b2b13[_0x578946(0x2ae)][0x1];_0x1b2b13['editMessageReplyMarkup']();if(pid[_0x242ab0])pid[_0x242ab0][_0x578946(0x295)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x6afc48(0x2e4)](_0x6afc48(0x15e),async _0x57070e=>{const _0x4bcfb3=_0x6afc48,_0x4f9e60=getEnabledBots();if(_0x4f9e60[_0x4bcfb3(0x1df)]==0x0)await sendTelegram(_0x57070e['chat']['id'],_0x4bcfb3(0x146));else{if(_0x4f9e60[_0x4bcfb3(0x1df)]>0x1){let _0x4fe541=[],_0x52d376=[];const _0x5dbb57=_0x4f9e60[_0x4bcfb3(0x1df)]%0x4==0x0||_0x4f9e60[_0x4bcfb3(0x1df)]%0x4==0x3||_0x4f9e60[_0x4bcfb3(0x1df)]%0x3==0x1?0x4:0x3;let _0x5416ce=0x0;_0x4f9e60[_0x4bcfb3(0x1d6)]((_0x531896,_0x1e03a4)=>{const _0x3a36f8=_0x4bcfb3;if(_0x1e03a4%_0x5dbb57==0x0)_0x52d376=[];_0x52d376[_0x3a36f8(0x248)](Markup[_0x3a36f8(0x133)]['callback']('Bot\x20'+_0x531896[_0x3a36f8(0x167)],'portfolio_'+_0x531896[_0x3a36f8(0x167)])),_0x1e03a4%_0x5dbb57==0x0&&(_0x4fe541[_0x5416ce]=_0x52d376,_0x5416ce++);});const _0x56e5eb=Markup['inlineKeyboard'](_0x4fe541);_0x57070e[_0x4bcfb3(0x1e5)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x56e5eb);}else{const _0x70ab26=_0x4f9e60[0x0][_0x4bcfb3(0x167)];if(pid[_0x70ab26])pid[_0x70ab26]['send']({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x6afc48(0x12f)](/portfolio_(.+)/,async _0x3a08fe=>{const _0x5691ef=_0x6afc48,_0x2dd147=_0x3a08fe[_0x5691ef(0x2ae)][0x1];_0x3a08fe[_0x5691ef(0x1bd)]();if(pid[_0x2dd147])pid[_0x2dd147][_0x5691ef(0x295)]({'function':_0x5691ef(0x2f0),'args':null});}),tgBot['command'](_0x6afc48(0x233),async _0x22b1f2=>{const _0xf0e998=_0x6afc48;await getMessages();if(!updateAvailable)await sendTelegram(_0x22b1f2[_0xf0e998(0x1f4)]['id'],_0xf0e998(0x14b));else{if(!validInstallation)await sendTelegram(_0x22b1f2[_0xf0e998(0x1f4)]['id'],_0xf0e998(0x13a));else{const _0x4a9c6b=Markup[_0xf0e998(0x182)]([Markup[_0xf0e998(0x133)]['callback'](_0xf0e998(0x2af),_0xf0e998(0x246)),Markup[_0xf0e998(0x133)][_0xf0e998(0x1fc)]('No',_0xf0e998(0x12c))]);_0x22b1f2[_0xf0e998(0x1e5)](_0xf0e998(0x263),_0x4a9c6b);}}}),tgBot[_0x6afc48(0x12f)](/update_(.+)/,async _0x3125dd=>{const _0x3932dd=_0x6afc48,_0x168630=_0x3125dd['match'][0x1];_0x3125dd[_0x3932dd(0x1bd)](),_0x168630=='yes'&&(await sendTelegram(_0x3125dd[_0x3932dd(0x1f4)]['id'],_0x3932dd(0x21b)),updateBB('update')),_0x168630=='no'&&await sendTelegram(_0x3125dd[_0x3932dd(0x1f4)]['id'],_0x3932dd(0x2fd));}),tgBot['command'](_0x6afc48(0x27e),async _0x45dc92=>{const _0x2a40f2=_0x6afc48;if(!validInstallation)await sendTelegram(_0x45dc92[_0x2a40f2(0x1f4)]['id'],_0x2a40f2(0x1cb));else{const _0x4ae695=Markup[_0x2a40f2(0x182)]([Markup[_0x2a40f2(0x133)][_0x2a40f2(0x1fc)]('Yes','reinstall_yes'),Markup['button']['callback']('No',_0x2a40f2(0x26a))]);_0x45dc92[_0x2a40f2(0x1e5)](_0x2a40f2(0x1ac),_0x4ae695);}}),tgBot[_0x6afc48(0x12f)](/reinstall_(.+)/,async _0x55bba4=>{const _0x320175=_0x6afc48,_0x1330d5=_0x55bba4[_0x320175(0x2ae)][0x1];_0x55bba4[_0x320175(0x1bd)](),_0x1330d5==_0x320175(0x1ff)&&(await sendTelegram(_0x55bba4['chat']['id'],_0x320175(0x253)),updateBB(_0x320175(0x27e))),_0x1330d5=='no'&&await sendTelegram(_0x55bba4[_0x320175(0x1f4)]['id'],_0x320175(0x179));}),tgBot['command']('toggle',async _0x20f766=>{const _0x23d5e6=_0x6afc48,_0x4986ca=getBotsWithMode();if(_0x4986ca[_0x23d5e6(0x1df)]==0x0)await sendTelegram(_0x20f766['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x2bde72=[],_0x225aa1=[];const _0x509631=0x2;let _0x551d28=0x0;_0x4986ca[_0x23d5e6(0x1d6)]((_0x177bd4,_0x30683a)=>{const _0x53cac5=_0x23d5e6;if(_0x30683a%_0x509631==0x0)_0x225aa1=[];_0x225aa1[_0x53cac5(0x248)](Markup[_0x53cac5(0x133)][_0x53cac5(0x1fc)]('Bot\x20'+_0x177bd4['botID']+'\x20('+_0x177bd4[_0x53cac5(0x202)]+')','toggle_'+_0x177bd4[_0x53cac5(0x167)])),_0x30683a%_0x509631==0x0&&(_0x2bde72[_0x551d28]=_0x225aa1,_0x551d28++);});const _0x2c23e9=Markup[_0x23d5e6(0x182)](_0x2bde72);_0x20f766[_0x23d5e6(0x1e5)](_0x23d5e6(0x1a5),_0x2c23e9);}}),tgBot['action'](/toggle_(.+)/,async _0x4188fc=>{const _0x7f804=_0x6afc48,_0x3516de=_0x4188fc[_0x7f804(0x2ae)][0x1];_0x4188fc[_0x7f804(0x1bd)]();const _0x4673c3=getBotsWithMode(),_0x147395=_0x4673c3[_0x7f804(0x1ca)](_0x54bf04=>_0x54bf04[_0x7f804(0x167)]==_0x3516de),_0x4a3369=_0x147395[_0x7f804(0x202)]==_0x7f804(0x16f)?'manual':'auto';await sendTelegram(_0x4188fc['chat']['id'],_0x7f804(0x217)+_0x3516de+'\x20to\x20'+_0x4a3369+_0x7f804(0x2a8)),toggleBotMode(_0x3516de);}),tgBot[_0x6afc48(0x2e4)](_0x6afc48(0x294),async _0x55f7b7=>{const _0x191c2d=_0x6afc48;let _0x356bee='';config[_0x191c2d(0x1d6)](_0x1a85f0=>{const _0x5231d0=_0x191c2d;_0x356bee+=_0x5231d0(0x161)+_0x1a85f0[_0x5231d0(0x167)]+':\x20'+_0x1a85f0[_0x5231d0(0x2c7)]+'\x0a';}),await sendTelegram(_0x55f7b7[_0x191c2d(0x1f4)]['id'],_0x356bee,{'parse_mode':'HTML'});}),tgBot[_0x6afc48(0x2e4)](_0x6afc48(0x100),async _0x42b8c7=>{const _0x5c379f=_0x6afc48;await sendTelegram(_0x42b8c7[_0x5c379f(0x1f4)]['id'],_0x52e4ba);}),process[_0x6afc48(0x15a)](_0x6afc48(0x147),()=>tgBot[_0x6afc48(0x1fa)](_0x6afc48(0x147))),process[_0x6afc48(0x15a)](_0x6afc48(0x13d),()=>tgBot[_0x6afc48(0x1fa)]('SIGTERM')),tgBot[_0x6afc48(0x19a)]();}}function disableTelegram(){const _0x3f09d5=_0x482511;tgBot&&tgBot[_0x3f09d5(0x1fa)]();}async function sendTelegram(_0x1b6b6e,_0x87a416,_0x4689b1){const _0x2e8695=_0x482511;_0x4689b1={..._0x4689b1,'disable_web_page_preview':!![]};try{await tgBot['telegram']['sendMessage'](_0x1b6b6e,_0x87a416,_0x4689b1);}catch(_0x40c089){console[_0x2e8695(0x260)]('Telegram\x20error:',_0x40c089);}}async function sendTelegramBot(_0x4689ad,_0x16e797){const _0x5f4f76=_0x482511;if(settings[_0x5f4f76(0x2f3)]){if(settings['telegramEvents']==_0x5f4f76(0x20c)||(_0x16e797[_0x5f4f76(0x17b)]==_0x5f4f76(0x10b)||_0x16e797['type']=='warning'||_0x16e797['type']==_0x5f4f76(0x164))&&settings[_0x5f4f76(0x1c4)]=='alerts'||_0x16e797[_0x5f4f76(0x17b)]==_0x5f4f76(0x298)&&settings['telegramEvents']==_0x5f4f76(0x26d)){if(tgBot&&settings[_0x5f4f76(0x140)]){if(_0x16e797[_0x5f4f76(0x2bf)])await sendTelegram(settings[_0x5f4f76(0x140)],_0x16e797['botname']+_0x5f4f76(0x1a9)+_0x16e797[_0x5f4f76(0x226)]);else await sendTelegram(settings['telegramChatId'],_0x5f4f76(0x161)+_0x4689ad+_0x5f4f76(0x1a9)+_0x16e797[_0x5f4f76(0x226)]);}}}}async function sendTelegramMsg(_0x1a4572,_0x599478=_0x482511(0x1ee)){const _0x178f9e=_0x482511;return settings[_0x178f9e(0x2f3)]&&tgBot&&settings[_0x178f9e(0x140)]?(await sendTelegram(settings[_0x178f9e(0x140)],_0x1a4572,{'parse_mode':_0x599478}),!![]):![];}function getDeviceWithIp(_0x24da12){const _0x575117=_0x482511;return devices[_0x575117(0x1ca)](_0x3deaab=>_0x3deaab['ip']===_0x24da12);}async function temporaryAccess2FA(_0x589112,_0x25c2ee){const _0x3bd4c2=_0x482511;let _0x510bd7=new Date(),_0x59e8f1=![];if(lastIpApproval){if(_0x510bd7-lastIpApproval<0x1388)_0x59e8f1=!![];}lastIpApproval=new Date();if(_0x59e8f1)return;if(tgBot&&settings[_0x3bd4c2(0x140)]){const _0x3851b1=uuidRandom();tmpStorage[_0x3851b1]={'uuid':_0x589112,'externalip':_0x25c2ee};const _0x5e70b1=Markup[_0x3bd4c2(0x182)]([Markup[_0x3bd4c2(0x133)]['callback'](_0x3bd4c2(0x271),_0x3bd4c2(0x142)+_0x3851b1),Markup[_0x3bd4c2(0x133)][_0x3bd4c2(0x1fc)](_0x3bd4c2(0x2d7),'tempaccess_15_'+_0x3851b1),Markup['button'][_0x3bd4c2(0x1fc)](_0x3bd4c2(0x2ac),_0x3bd4c2(0x2df)+_0x3851b1),Markup[_0x3bd4c2(0x133)][_0x3bd4c2(0x1fc)](_0x3bd4c2(0x269),'tempaccess_reject_'+_0x3851b1)]);await sendTelegram(settings[_0x3bd4c2(0x140)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x25c2ee)[_0x3bd4c2(0x188)]+'\x20?',_0x5e70b1),tgBot[_0x3bd4c2(0x12f)](/tempaccess_(.+)_(.+)/,async _0x379ff2=>{const _0x512e97=_0x3bd4c2,_0x2f35b5=_0x379ff2[_0x512e97(0x2ae)][0x1],_0xd3eac5=_0x379ff2[_0x512e97(0x2ae)][0x2],{uuid:_0x589631,externalip:_0x3c3ccb}=tmpStorage[_0xd3eac5];delete tmpStorage[_0xd3eac5],_0x379ff2[_0x512e97(0x1bd)](),devices[_0x589631][_0x512e97(0x1e6)]={'clientip':_0x3c3ccb,'timestamp':new Date()[_0x512e97(0x1ea)](),'expiry':_0x2f35b5},_0x2f35b5!=_0x512e97(0x269)?(await sendTelegram(_0x379ff2['chat']['id'],_0x512e97(0x197)+_0x2f35b5+_0x512e97(0x1a7),{'parse_mode':'HTML'}),io['to'](_0x589631)[_0x512e97(0x198)](_0x512e97(0x290),{'access':{'allow':![],'reason':_0x512e97(0x18e),'token':null}})):(await sendTelegram(_0x379ff2[_0x512e97(0x1f4)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x589631)['emit'](_0x512e97(0x290),{'access':{'allow':![],'reason':_0x512e97(0x1e4),'token':null}}));});}}async function loginAccess2FA(_0x37ed61,_0x5e9ea3){const _0x45af37=_0x482511;if(tgBot&&settings[_0x45af37(0x140)]){const _0x5cbd39=uuidRandom();tmpStorage[_0x5cbd39]={'uuid':_0x37ed61,'externalip':_0x5e9ea3};const _0x3b749f=Markup[_0x45af37(0x182)]([Markup[_0x45af37(0x133)]['callback']('accept','login2fa_'+loginExpiry+'_'+_0x5cbd39),Markup['button']['callback'](_0x45af37(0x269),_0x45af37(0x149)+_0x5cbd39)]);await sendTelegram(settings['telegramChatId'],_0x45af37(0x17c)+normalizeIP(_0x5e9ea3)[_0x45af37(0x188)]+'\x20?',_0x3b749f),tgBot['action'](/login2fa_(.+)_(.+)/,async _0xcce1f0=>{const _0x53c6c0=_0x45af37,_0x43adb5=_0xcce1f0[_0x53c6c0(0x2ae)][0x1],_0x2a3893=_0xcce1f0[_0x53c6c0(0x2ae)][0x2],{uuid:_0x8b1b86,externalip:_0x1578ae}=tmpStorage[_0x2a3893];delete tmpStorage[_0x2a3893],_0xcce1f0['editMessageReplyMarkup'](),devices[_0x8b1b86][_0x53c6c0(0x1e9)]={'clientip':_0x1578ae,'timestamp':new Date()[_0x53c6c0(0x1ea)](),'expiry':_0x43adb5},_0x43adb5!='reject'?(await sendTelegram(_0xcce1f0[_0x53c6c0(0x1f4)]['id'],_0x53c6c0(0x2dc),{'parse_mode':_0x53c6c0(0x1ee)}),io['to'](_0x8b1b86)[_0x53c6c0(0x198)](_0x53c6c0(0x290),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0xcce1f0[_0x53c6c0(0x1f4)]['id'],_0x53c6c0(0x230)),io['to'](_0x8b1b86)[_0x53c6c0(0x198)](_0x53c6c0(0x290),{'access':{'allow':![],'reason':_0x53c6c0(0x199),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3e5498=_0x482511;return dbConfig['get']('bots')[_0x3e5498(0x165)](_0x3e5498(0x167))[_0x3e5498(0x1ec)]({'status':'enabled'})['value']()||[];}function getDisabledBots(){const _0x2ad493=_0x482511;return dbConfig[_0x2ad493(0x223)](_0x2ad493(0x2c5))[_0x2ad493(0x165)](_0x2ad493(0x167))[_0x2ad493(0x1ec)]({'status':_0x2ad493(0x20f)})[_0x2ad493(0x2e0)]()||[];}function getBotAttributes(_0x22d26d){const _0x1ec885=_0x482511;let _0x377c48={};const _0x244afb=configpath+_0x1ec885(0x192)+_0x22d26d+'-config.json',_0x2ae368=fs['existsSync'](_0x244afb);if(_0x2ae368){const _0x1c2889=fs[_0x1ec885(0x153)](_0x244afb);try{const _0x25ac30=JSON[_0x1ec885(0x14c)](_0x1c2889),_0x1d1f9f=_0x25ac30?_0x25ac30[_0x1ec885(0x137)][0x0][_0x1ec885(0x2a9)]:![];_0x377c48[_0x1ec885(0x202)]=_0x1d1f9f?_0x1ec885(0x16f):'manual',_0x377c48[_0x1ec885(0x2c7)]=_0x25ac30?_0x25ac30[_0x1ec885(0x137)][0x0]['botname']:'Bot\x20'+_0x22d26d;}catch(_0x4fef4a){_0x377c48['mode']=_0x1ec885(0x115),_0x377c48[_0x1ec885(0x2c7)]=_0x1ec885(0x161)+_0x22d26d;}}else _0x377c48[_0x1ec885(0x202)]=_0x1ec885(0x115),_0x377c48['botname']=_0x1ec885(0x161)+_0x22d26d;return _0x377c48;}function getBotsWithMode(){const _0x513ba5=_0x482511,_0x5c5306=dbConfig[_0x513ba5(0x223)](_0x513ba5(0x2c5))[_0x513ba5(0x165)]('botID')['value']()||[];return _0x5c5306[_0x513ba5(0x1d6)](_0x3a0091=>{const _0x2cf217=_0x513ba5;let _0x379def=getBotAttributes(_0x3a0091[_0x2cf217(0x167)]);_0x3a0091[_0x2cf217(0x202)]=_0x379def['mode'];}),_0x5c5306;}function getBotExchanges(){const _0x1dd2a8=_0x482511;let _0x3bdd73=[];const _0x18b88a=dbConfig[_0x1dd2a8(0x223)](_0x1dd2a8(0x2c5))['sortBy'](_0x1dd2a8(0x167))[_0x1dd2a8(0x2e0)]()||[];_0x18b88a[_0x1dd2a8(0x1d6)](_0x5f1fc9=>{const _0x1c88ad=_0x1dd2a8;if(_0x5f1fc9[_0x1c88ad(0x290)]=='enabled'){const _0xf2483f=configpath+_0x1c88ad(0x192)+_0x5f1fc9[_0x1c88ad(0x167)]+_0x1c88ad(0x195),_0x45f297=fs[_0x1c88ad(0x158)](_0xf2483f);let _0x287d4b;if(_0x45f297){const _0xc42fd9=fs[_0x1c88ad(0x153)](_0xf2483f);try{const _0x524ec2=JSON[_0x1c88ad(0x14c)](_0xc42fd9);_0x287d4b=_0x524ec2?_0x524ec2[_0x1c88ad(0x137)][0x0][_0x1c88ad(0x10a)]:null;}catch(_0x304d4f){}}if(_0x287d4b)_0x3bdd73[_0x1c88ad(0x248)](_0x287d4b);}});const _0x31573b=[...new Set(_0x3bdd73)][_0x1dd2a8(0x2ca)]();return _0x31573b;}async function initUser(){const _0x2375d5=_0x482511;if(!settings['userid']){const _0x55c96f=uuidRandom();mixpanel[_0x2375d5(0x1f8)](_0x55c96f),updateSetting(_0x2375d5(0x184),_0x55c96f);}}async function initSecure(){const _0x43697f=_0x482511;let _0x1a8430=getSecure();if(!_0x1a8430[_0x43697f(0x2ad)]('secret')){let _0x2bd01a=await generateKeys();_0x1a8430['publicKey']=_0x2bd01a[_0x43697f(0x1c7)],_0x1a8430[_0x43697f(0x25f)]=_0x2bd01a[_0x43697f(0x25f)],_0x1a8430[_0x43697f(0x1c6)]=crypto['randomBytes'](0x20)[_0x43697f(0x292)](_0x43697f(0x170));;storeSecure(_0x1a8430);}}function getSettings(){const _0x57c27d=_0x482511;return dbSettings['get']('settings')[_0x57c27d(0x2e0)]()||{};}function getSecure(){const _0x143708=_0x482511;return dbSecure[_0x143708(0x223)](_0x143708(0x265))['value']()||{};}function getBlacklist(){const _0x213393=_0x482511;return dbSecure[_0x213393(0x223)](_0x213393(0x1f7))[_0x213393(0x2e0)]()||[];}function broadcastToBots(_0x42f2cf,_0x5b7897){config['forEach'](_0x3c5615=>{const _0x2a7a23=_0x4219;if(_0x3c5615[_0x2a7a23(0x290)]==_0x2a7a23(0x20a)&&_0x3c5615[_0x2a7a23(0x22d)]=='running'||_0x3c5615[_0x2a7a23(0x290)]==_0x2a7a23(0x1c1)&&_0x3c5615[_0x2a7a23(0x22d)]=='running'){if(pid[_0x3c5615[_0x2a7a23(0x167)]])pid[_0x3c5615[_0x2a7a23(0x167)]][_0x2a7a23(0x295)]({[_0x42f2cf]:_0x5b7897});}});}function storeSettings(_0x1d3992,_0x43da03=![]){const _0x469f1b=_0x482511;_0x1d3992={...settings,..._0x1d3992};if(_0x43da03&&_0x1d3992[_0x469f1b(0x296)]!=_0x469f1b(0x105)&&_0x1d3992['bbPassword']!=_0x469f1b(0x1bb)&&_0x1d3992[_0x469f1b(0x296)]!=''){const _0x5170dd=crypt[_0x469f1b(0x1b8)](secure[_0x469f1b(0x25f)],_0x1d3992[_0x469f1b(0x296)])[_0x469f1b(0x2ec)][_0x469f1b(0x116)]('@')[0x0],_0x2fdc51=bcrypt[_0x469f1b(0x103)](_0x5170dd,saltRounds);_0x1d3992={..._0x1d3992,'bbPassword':_0x2fdc51};}if(_0x43da03&&_0x1d3992[_0x469f1b(0x131)]!=_0x469f1b(0x105)&&_0x1d3992[_0x469f1b(0x131)]!='***'&&_0x1d3992['telegramToken']!=''){const _0x5d82ff=crypt['decrypt'](secure[_0x469f1b(0x25f)],_0x1d3992[_0x469f1b(0x131)])['message'][_0x469f1b(0x116)]('@')[0x0];_0x1d3992={..._0x1d3992,'telegramToken':_0x5d82ff};}const _0x2400d4=_0x1d3992['telegramToken']!=_0x469f1b(0x105)&&_0x1d3992[_0x469f1b(0x131)]!=settings[_0x469f1b(0x131)]||_0x1d3992[_0x469f1b(0x154)]!=settings[_0x469f1b(0x154)],_0x339d86=_0x1d3992[_0x469f1b(0x131)]==''||_0x1d3992['telegramUsername']=='';_0x2400d4&&(_0x1d3992['telegramChatId']=null,_0x1d3992[_0x469f1b(0x1c4)]=_0x469f1b(0x20c));for(const [_0x570f88,_0x5db758]of Object['entries'](_0x1d3992)){if(_0x570f88=='telegramToken'&&_0x5db758==_0x469f1b(0x105)){_0x1d3992[_0x469f1b(0x131)]=settings[_0x469f1b(0x131)];continue;};if(_0x570f88=='bbPassword'&&_0x5db758=='************'){_0x1d3992[_0x469f1b(0x296)]=settings[_0x469f1b(0x296)];continue;};dbSettings[_0x469f1b(0x2cb)](_0x469f1b(0x1cf)+_0x570f88,_0x5db758)[_0x469f1b(0x1b3)]();}settings=_0x1d3992,io['to'](_0x469f1b(0x1db))['emit'](_0x469f1b(0x1c2),cleanSettings()),broadcastToBots('timeshift',settings[_0x469f1b(0x107)]),broadcastToBots(_0x469f1b(0x14a),settings[_0x469f1b(0x14a)]);if(_0x2400d4&&!_0x339d86)initTelegram();if(_0x2400d4&&_0x339d86)disableTelegram();getAllClients()[_0x469f1b(0x1d6)](_0x33580c=>{const _0x73df55=_0x469f1b;getSocket(_0x33580c['id'])[_0x73df55(0x198)](_0x73df55(0x290),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x55d250,_0x123140){const _0x122223=_0x482511;dbSettings[_0x122223(0x2cb)](_0x122223(0x1cf)+_0x55d250,_0x123140)[_0x122223(0x1b3)](),settings=getSettings(),io['to'](_0x122223(0x1db))[_0x122223(0x198)](_0x122223(0x1c2),cleanSettings());}function storeSecure(_0x352b92){const _0xcaf58f=_0x482511;dbSecure['get']('secure')['push'](_0x352b92)[_0xcaf58f(0x1b3)](),secure=_0x352b92;}function addBlacklist(_0x1f6bec){const _0x3acae3=_0x482511;cleanBlacklist();let _0x5dfaaa;devices[_0x1f6bec][_0x3acae3(0x1e6)]?_0x5dfaaa=Math['max'](devices[_0x1f6bec][_0x3acae3(0x1e6)]['expiry'],loginExpiry):_0x5dfaaa=loginExpiry,dbSecure[_0x3acae3(0x223)](_0x3acae3(0x1f7))[_0x3acae3(0x248)]({'expiry':new Date()[_0x3acae3(0x1ea)]()+_0x5dfaaa*0x3c*0x3e8,'token':devices[_0x1f6bec]['access']['token']})[_0x3acae3(0x1b3)](),blacklist=dbSecure[_0x3acae3(0x223)](_0x3acae3(0x1f7))[_0x3acae3(0x2e0)]();}function cleanBlacklist(){const _0x11a422=_0x482511;let _0x469c5c=dbSecure['get'](_0x11a422(0x1f7))[_0x11a422(0x123)]()[_0x11a422(0x2e0)](),_0x134bda=new Date()[_0x11a422(0x1ea)]();_0x469c5c[_0x11a422(0x1d6)](_0x441be6=>{const _0x470b8d=_0x11a422;_0x441be6[_0x470b8d(0x266)]<_0x134bda&&dbSecure[_0x470b8d(0x223)](_0x470b8d(0x1f7))['remove']({'expiry':_0x441be6['expiry']})[_0x470b8d(0x1b3)]();});}function initStates(){const _0x4e09af=_0x482511;let _0x1b0339=getConfiguration();_0x1b0339[_0x4e09af(0x1d6)](_0x2ed425=>{const _0x554dd4=_0x4e09af;_0x2ed425[_0x554dd4(0x22d)]=_0x554dd4(0x11f);}),storeConfiguration(_0x1b0339);}function onKeys(){const _0x498cc9=new RSA();return new Promise(_0x37b341=>{const _0x1e5429=_0x4219;_0x498cc9[_0x1e5429(0x24f)]()[_0x1e5429(0x12b)](_0x2cc18f=>{_0x37b341(_0x2cc18f);});});}function _0x4219(_0x4e1d24,_0x2018aa){const _0x3be471=_0x36d1();return _0x4219=function(_0x3697fe,_0x4bed77){_0x3697fe=_0x3697fe-0xfd;let _0x36d140=_0x3be471[_0x3697fe];return _0x36d140;},_0x4219(_0x4e1d24,_0x2018aa);}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x59fd34=_0x482511;let _0x1ad57a=getSettings(),_0x923d00=![];!_0x1ad57a[_0x59fd34(0x2ad)](_0x59fd34(0x19f))&&(_0x1ad57a[_0x59fd34(0x19f)]=0x0,_0x923d00=!![]);!_0x1ad57a['hasOwnProperty'](_0x59fd34(0x2ee))&&(_0x1ad57a[_0x59fd34(0x2ee)]=0x0,_0x923d00=!![]);!_0x1ad57a[_0x59fd34(0x2ad)](_0x59fd34(0x17e))&&(_0x1ad57a[_0x59fd34(0x17e)]=_0x59fd34(0x1c8),_0x923d00=!![]);!_0x1ad57a['hasOwnProperty']('onepagemode')&&(_0x1ad57a['onepagemode']=![],_0x923d00=!![]);if(_0x923d00)storeSettings(_0x1ad57a);try{fs[_0x59fd34(0x138)](configbackuppath,{'withFileTypes':!![]})[_0x59fd34(0x1d6)](_0x2f5d21=>{const _0x103cbf=_0x59fd34;if(!_0x2f5d21[_0x103cbf(0x286)]()){if(!_0x2f5d21[_0x103cbf(0x23a)][_0x103cbf(0x218)](_0x103cbf(0x1f3)))fs['unlinkSync'](configbackuppath+_0x2f5d21[_0x103cbf(0x23a)]);}else fs[_0x103cbf(0x2d5)](configbackuppath+_0x2f5d21[_0x103cbf(0x23a)],{'recursive':!![]});});}catch(_0x213e0f){logger['debug'](_0x59fd34(0x225),_0x213e0f);}}function storeConfiguration(_0x1b2a58){const _0x2e467f=_0x482511;dbConfig[_0x2e467f(0x223)](_0x2e467f(0x2c5))[_0x2e467f(0x171)]()['write'](),dbConfig['get'](_0x2e467f(0x2c5))[_0x2e467f(0x248)](..._0x1b2a58)[_0x2e467f(0x1b3)](),config=_0x1b2a58;}async function resetPassword(){const _0x5ad49d=_0x482511;if(tgBot&&settings['telegramChatId']){const _0x39dfd4=Markup[_0x5ad49d(0x182)]([Markup[_0x5ad49d(0x133)][_0x5ad49d(0x1fc)](_0x5ad49d(0x1ff),_0x5ad49d(0x283)),Markup[_0x5ad49d(0x133)][_0x5ad49d(0x1fc)]('no',_0x5ad49d(0x189))]);await sendTelegram(settings[_0x5ad49d(0x140)],_0x5ad49d(0x181),_0x39dfd4),tgBot[_0x5ad49d(0x12f)](/resetpw_(.+)/,async _0x4fb650=>{const _0x24ae44=_0x5ad49d,_0x274423=_0x4fb650['match'][0x1];_0x4fb650[_0x24ae44(0x1bd)]();if(_0x274423!='no'){const _0x2335b3=0xf,_0x1513fe='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x1db8fc=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x2335b3)))[_0x24ae44(0x2f2)](_0x2ecb45=>_0x1513fe[_0x2ecb45%_0x1513fe[_0x24ae44(0x1df)]])[_0x24ae44(0x278)](''),_0x577b5b=bcrypt[_0x24ae44(0x103)](_0x1db8fc,saltRounds);storeSettings({'bbPassword':_0x577b5b}),await sendTelegram(_0x4fb650[_0x24ae44(0x1f4)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x1db8fc,{'parse_mode':'HTML'});}else await sendTelegram(_0x4fb650['chat']['id'],_0x24ae44(0x26c));});}}async function confirmRestore(_0x313a2e,_0x1e41a4){const _0x3c4ffe=_0x482511;io['to'](_0x3c4ffe(0x1db))[_0x3c4ffe(0x198)](_0x3c4ffe(0x1ad),_0x3c4ffe(0x2fb),_0x3c4ffe(0x164));if(tgBot&&settings[_0x3c4ffe(0x140)]){const _0x56159e=uuidRandom();tmpStorage[_0x56159e]={'path':_0x313a2e,'filename':_0x1e41a4};const _0x3b109d=Markup[_0x3c4ffe(0x182)]([Markup[_0x3c4ffe(0x133)][_0x3c4ffe(0x1fc)](_0x3c4ffe(0x1ff),'restore_yes_'+_0x56159e),Markup[_0x3c4ffe(0x133)][_0x3c4ffe(0x1fc)]('no',_0x3c4ffe(0x239)+_0x56159e)]);await sendTelegram(settings[_0x3c4ffe(0x140)],_0x3c4ffe(0x15b),_0x3b109d),tgBot['action'](/restore_(.+)_(.+)/,async _0x2b203b=>{const _0x5b8321=_0x3c4ffe,_0x333179=_0x2b203b[_0x5b8321(0x2ae)][0x1],_0x1349cb=_0x2b203b['match'][0x2],{path:_0x1cd103,filename:_0x481b36}=tmpStorage[_0x1349cb];delete tmpStorage[_0x1349cb],_0x2b203b[_0x5b8321(0x1bd)](),_0x333179==_0x5b8321(0x1ff)?(logger['debug'](_0x5b8321(0x2fa)),await sendTelegram(_0x2b203b[_0x5b8321(0x1f4)]['id'],_0x5b8321(0x2e7),{'parse_mode':'HTML'}),unzipFile(_0x1cd103,_0x481b36)):(logger[_0x5b8321(0x22c)](_0x5b8321(0x280)),await sendTelegram(_0x2b203b[_0x5b8321(0x1f4)]['id'],_0x5b8321(0x280)));});}}function getServerTime(){const _0x32eed7=_0x482511,_0xa92664=new Date();return _0xa92664[_0x32eed7(0x139)]()+'/'+(_0xa92664[_0x32eed7(0x28c)]()+0x1)[_0x32eed7(0x292)]()[_0x32eed7(0x112)](0x2,'0')+'/'+_0xa92664['getDate']()[_0x32eed7(0x292)]()[_0x32eed7(0x112)](0x2,'0')+'\x20'+_0xa92664['getHours']()[_0x32eed7(0x292)]()[_0x32eed7(0x112)](0x2,'0')+':'+_0xa92664[_0x32eed7(0x11e)]()[_0x32eed7(0x292)]()['padStart'](0x2,'0')+':'+_0xa92664[_0x32eed7(0x2b4)]()[_0x32eed7(0x292)]()[_0x32eed7(0x112)](0x2,'0');}function getTimeStamp(){const _0xa3675b=_0x482511,_0x292d64=shiftedTime();return _0x292d64[_0xa3675b(0x139)]()+'/'+(_0x292d64[_0xa3675b(0x28c)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x292d64[_0xa3675b(0x1ab)]()['toString']()[_0xa3675b(0x112)](0x2,'0')+'\x20'+_0x292d64['getHours']()[_0xa3675b(0x292)]()[_0xa3675b(0x112)](0x2,'0')+':'+_0x292d64['getMinutes']()['toString']()['padStart'](0x2,'0')+':'+_0x292d64[_0xa3675b(0x2b4)]()[_0xa3675b(0x292)]()[_0xa3675b(0x112)](0x2,'0');}function getCleanTimeStamp(){const _0x234655=_0x482511,_0x2474a2=shiftedTime();return _0x2474a2['getFullYear']()+(_0x2474a2[_0x234655(0x28c)]()+0x1)[_0x234655(0x292)]()[_0x234655(0x112)](0x2,'0')+_0x2474a2[_0x234655(0x1ab)]()[_0x234655(0x292)]()['padStart'](0x2,'0')+'-'+_0x2474a2[_0x234655(0x155)]()[_0x234655(0x292)]()[_0x234655(0x112)](0x2,'0')+_0x2474a2[_0x234655(0x11e)]()['toString']()[_0x234655(0x112)](0x2,'0')+_0x2474a2[_0x234655(0x2b4)]()['toString']()[_0x234655(0x112)](0x2,'0');}function shiftedTime(){const _0x158e0c=_0x482511,_0x3f5ed4=new Date();let _0x5422c7=_0x3f5ed4;if(settings['timeshift']&&settings[_0x158e0c(0x107)]!==0x0)_0x5422c7=fns[_0x158e0c(0x160)](_0x3f5ed4,{'hours':settings['timeshift']});return _0x5422c7;}function startScheduler(){const _0x4f55ea=_0x482511,_0x5cdebb=new Date()[_0x4f55ea(0x2fc)](),_0x57b772=shiftedTime()[_0x4f55ea(0x155)]();_0x57b772==0x4&&backupConfigFiles();_0x57b772==0x0&&rotateLogFiles();_0x5cdebb%0x6==0x0&&triggerAnalytics();_0x5cdebb%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x5650bf){const _0x54bfd5=_0x482511;logger[_0x54bfd5(0x22c)](_0x54bfd5(0x267)+_0x5650bf);const _0x2fcfe0=getBotsWithMode();_0x2fcfe0[_0x54bfd5(0x1df)]>0x0?confirmRestore(configbackuppath,_0x5650bf):unzipFile(configbackuppath,_0x5650bf);}async function getBackupFiles(_0x4da5e0=null){const _0x447fa5=_0x482511;let _0x2fd2ed=[],_0x505172=fs[_0x447fa5(0x138)](configbackuppath,{'withFileTypes':!![]});_0x505172[_0x447fa5(0x2ca)]((_0x44b0f0,_0x4365d3)=>_0x44b0f0['name']<_0x4365d3[_0x447fa5(0x23a)]?0x1:_0x4365d3[_0x447fa5(0x23a)]<_0x44b0f0[_0x447fa5(0x23a)]?-0x1:0x0),_0x505172[_0x447fa5(0x1d6)](_0x5ad8e6=>{const _0x1d035f=_0x447fa5;if(!_0x5ad8e6[_0x1d035f(0x286)]()&&_0x5ad8e6[_0x1d035f(0x23a)]['startsWith'](_0x1d035f(0x1f3))&&_0x5ad8e6[_0x1d035f(0x23a)][_0x1d035f(0x2be)](_0x1d035f(0x1d3))){const _0x222d6f=formatDate(fs[_0x1d035f(0x193)](configbackuppath+_0x5ad8e6[_0x1d035f(0x23a)])[_0x1d035f(0x249)]);_0x2fd2ed['push']({'name':_0x5ad8e6['name'],'mtime':_0x222d6f});}});if(_0x4da5e0)io['to'](_0x4da5e0)[_0x447fa5(0x198)]('backup-files',_0x2fd2ed);else return _0x2fd2ed;}async function backupConfigFiles(){const _0xe8efb4=_0x482511;await zipFiles(_0xe8efb4(0x227));const _0x48c3b5=getCleanTimeStamp();fs[_0xe8efb4(0x2a5)](zippath+_0xe8efb4(0x22f),configbackuppath+(_0xe8efb4(0x1f3)+_0x48c3b5+_0xe8efb4(0x1d3)));let _0x9ec69a=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x9ec69a['sort']((_0x4a02ff,_0x4650d1)=>_0x4a02ff[_0xe8efb4(0x23a)]<_0x4650d1[_0xe8efb4(0x23a)]?0x1:_0x4650d1['name']<_0x4a02ff[_0xe8efb4(0x23a)]?-0x1:0x0),_0x9ec69a[_0xe8efb4(0x1df)]>maxBackups&&fs[_0xe8efb4(0x13e)](configbackuppath+_0x9ec69a[_0x9ec69a[_0xe8efb4(0x1df)]-0x1]['name']);}function rotateLogFiles(){const _0x387b13=_0x482511,_0x318c9e=fs[_0x387b13(0x193)](logspath+_0x387b13(0x22b)),_0x5be9e1=_0x318c9e['size']/0x400;if(_0x5be9e1>0x64){let _0x49ba01=fs[_0x387b13(0x138)](logspath,{'withFileTypes':!![]});_0x49ba01[_0x387b13(0x2ca)]((_0x2502eb,_0x588f30)=>_0x2502eb[_0x387b13(0x23a)]<_0x588f30[_0x387b13(0x23a)]?0x1:_0x588f30[_0x387b13(0x23a)]<_0x2502eb['name']?-0x1:0x0),_0x49ba01[_0x387b13(0x1d6)](_0xf16030=>{const _0x186f7d=_0x387b13;if(_0xf16030[_0x186f7d(0x23a)]=='output-002.log')fs['copyFileSync'](logspath+_0xf16030[_0x186f7d(0x23a)],logspath+'output-003.log');if(_0xf16030[_0x186f7d(0x23a)]==_0x186f7d(0x145))fs[_0x186f7d(0x2a5)](logspath+_0xf16030[_0x186f7d(0x23a)],logspath+'output-002.log');_0xf16030[_0x186f7d(0x23a)]==_0x186f7d(0x22b)&&(fs[_0x186f7d(0x2a5)](logspath+_0xf16030[_0x186f7d(0x23a)],logspath+_0x186f7d(0x145)),fs['writeFileSync'](logspath+_0xf16030[_0x186f7d(0x23a)],''));});}}async function zipFiles(_0x2d7975){const _0x23584b=_0x482511;let _0x9edda8;if(_0x2d7975=='logs')_0x9edda8=logspath;if(_0x2d7975==_0x23584b(0x135))_0x9edda8=configpath;if(_0x2d7975==_0x23584b(0x227))_0x9edda8=configpath;let _0x2a0e73=fs['readdirSync'](_0x9edda8,{'withFileTypes':!![]});const _0x18c2e9=new require(_0x23584b(0x128))();_0x2a0e73['forEach'](_0x415eb5=>{const _0x2f0c2f=_0x23584b;if(!_0x415eb5[_0x2f0c2f(0x286)]()){let _0x48888f=fs[_0x2f0c2f(0x153)](_0x9edda8+_0x415eb5[_0x2f0c2f(0x23a)]);if(_0x2d7975=='backup'){const _0x34d96e=/^bot-[0-9]{3}-config.json$/,_0x52069c=_0x34d96e[_0x2f0c2f(0x1a8)](_0x415eb5[_0x2f0c2f(0x23a)]);if(_0x52069c){const _0x58fe85=JSON[_0x2f0c2f(0x14c)](_0x48888f);if(_0x58fe85[_0x2f0c2f(0x137)][0x0]){_0x58fe85[_0x2f0c2f(0x137)][0x0][_0x2f0c2f(0x27c)]=_0x2f0c2f(0x1bb),_0x58fe85[_0x2f0c2f(0x137)][0x0][_0x2f0c2f(0x252)]=_0x2f0c2f(0x1bb);if(_0x58fe85[_0x2f0c2f(0x137)][0x0][_0x2f0c2f(0x300)])_0x58fe85[_0x2f0c2f(0x137)][0x0][_0x2f0c2f(0x300)]=_0x2f0c2f(0x1bb);}_0x48888f=JSON[_0x2f0c2f(0x1b6)](_0x58fe85,null,0x2);}if(_0x415eb5[_0x2f0c2f(0x23a)]=='bb-settings.json'){const _0x13c65c=JSON[_0x2f0c2f(0x14c)](_0x48888f);if(_0x13c65c['settings'][_0x2f0c2f(0x159)])_0x13c65c[_0x2f0c2f(0x1c2)][_0x2f0c2f(0x159)]=![];if(_0x13c65c[_0x2f0c2f(0x1c2)][_0x2f0c2f(0x296)])_0x13c65c['settings'][_0x2f0c2f(0x296)]=_0x2f0c2f(0x1bb);if(_0x13c65c['settings'][_0x2f0c2f(0x131)])_0x13c65c[_0x2f0c2f(0x1c2)][_0x2f0c2f(0x131)]=_0x2f0c2f(0x1bb);if(_0x13c65c[_0x2f0c2f(0x1c2)][_0x2f0c2f(0x140)])_0x13c65c[_0x2f0c2f(0x1c2)][_0x2f0c2f(0x140)]=null;_0x48888f=JSON['stringify'](_0x13c65c,null,0x2);}if(_0x415eb5['name']!='bb-secure.json')_0x18c2e9['file'](_0x415eb5[_0x2f0c2f(0x23a)],_0x48888f);}else _0x18c2e9[_0x2f0c2f(0x20b)](_0x415eb5['name'],_0x48888f);}});const _0x580f78=_0x18c2e9[_0x23584b(0x104)]({'base64':![],'compression':_0x23584b(0x27a)});fs[_0x23584b(0x10e)](zippath+(_0x2d7975+_0x23584b(0x1d3)),_0x580f78,_0x23584b(0x25a));}async function unzipFile(_0x5e4a24,_0x3da38d){const _0x579796=_0x482511;fs[_0x579796(0x138)](configpath,{'withFileTypes':!![]})[_0x579796(0x1d6)](_0x382b35=>{const _0x20e370=_0x579796;if(!_0x382b35[_0x20e370(0x286)]())fs[_0x20e370(0x2d5)](configpath+_0x382b35[_0x20e370(0x23a)]);});const _0x5e44af=fs[_0x579796(0x153)](_0x5e4a24+_0x3da38d,_0x579796(0x25a)),_0x4d1e05=new require(_0x579796(0x128))(_0x5e44af,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x4d1e05['files'])['forEach'](_0x3b5aa2=>{const _0x25bd4d=_0x579796,_0x5e4059=_0x4d1e05[_0x25bd4d(0x126)][_0x3b5aa2];fs[_0x25bd4d(0x10e)](configpath+_0x5e4059['name'],_0x5e4059[_0x25bd4d(0x2f8)]);}),fs[_0x579796(0x138)](temppath,{'withFileTypes':!![]})[_0x579796(0x1d6)](_0x1a7593=>{const _0x4f23bc=_0x579796;if(!_0x1a7593[_0x4f23bc(0x286)]())fs[_0x4f23bc(0x2d5)](temppath+_0x1a7593[_0x4f23bc(0x23a)]);}),logger['debug'](_0x579796(0x151)),process[_0x579796(0x295)]({'restore':!![]},_0xbc0dc5=>{});}async function getPublicIp(){const _0x4de935=_0x482511;try{const _0x44a03b=await axios[_0x4de935(0x223)]('https://api.ipify.org?format=json');publicip=_0x44a03b[_0x4de935(0x113)]['ip'];}catch(_0x21e159){}}async function triggerAnalytics(){const _0x47ed69=_0x482511;if(!publicip)await getPublicIp();const _0x3a7610=getBotsWithMode();let _0x321119=0x0;_0x3a7610[_0x47ed69(0x1d6)](_0x4823bb=>{const _0x577d58=_0x47ed69;if(_0x4823bb[_0x577d58(0x290)]===_0x577d58(0x20a))_0x321119++;});const _0x2e6776=getBotExchanges();mixpanel[_0x47ed69(0x134)](_0x47ed69(0x24b),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x3a7610[_0x47ed69(0x1df)],'numbotsenabled':_0x321119,'exchanges':_0x2e6776,'environment':environment});}async function getMessages(){const _0x65c4a3=_0x482511,_0x5b5b48=_0x65c4a3(0x2a4),_0x593d96=new GraphQLClient(_0x5b5b48),_0x3ebf10={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x5ba141=serverversion[_0x65c4a3(0x116)]('.'),_0x23740b=_0x5ba141[0x0]+'.'+_0x5ba141[0x1],_0x18c82f=Math['min'](settings[_0x65c4a3(0x19f)],settings[_0x65c4a3(0x2ee)]),_0x1fa06d={'last':parseInt(_0x18c82f),'bbm':_0x23740b},_0x55a7b0=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x67ab5d;try{_0x67ab5d=await _0x593d96['request'](_0x55a7b0,_0x1fa06d,_0x3ebf10);}catch(_0x13257a){}if(_0x67ab5d&&_0x67ab5d[_0x65c4a3(0x1bf)]){let _0x5033e4=settings[_0x65c4a3(0x19f)];newMessages=[];for(const _0x251195 of _0x67ab5d[_0x65c4a3(0x1bf)]){newMessages[_0x65c4a3(0x248)](_0x251195);let _0x433fd4=![];_0x251195[_0x65c4a3(0x211)]&&(updateSetting(_0x65c4a3(0x17e),_0x251195[_0x65c4a3(0x211)]),_0x433fd4=isNewerVersion(serverversion,_0x251195['bbvNew'])||serverversion==_0x251195[_0x65c4a3(0x211)]);if(!_0x433fd4&&_0x251195[_0x65c4a3(0x2e9)]>_0x5033e4){if(_0x251195[_0x65c4a3(0x102)]===_0x65c4a3(0xff)||serverversion[_0x65c4a3(0x218)](_0x251195[_0x65c4a3(0x102)])){let _0x7a6dc9=''+_0x251195['title']+'\x0a\x0a'+_0x251195[_0x65c4a3(0x2ec)];const _0xd9585c=await sendTelegramMsg(toTelegramMarkdown(_0x7a6dc9),_0x65c4a3(0x1af));if(_0xd9585c)_0x5033e4=_0x251195[_0x65c4a3(0x2e9)];}}}updateAvailable=isNewerVersion(settings[_0x65c4a3(0x17e)],serverversion),updateSetting(_0x65c4a3(0x19f),_0x5033e4),emitMessages();}}function emitMessages(){const _0x947d71=_0x482511,_0x45dc15=settings[_0x947d71(0x2ee)];let _0x450ef7=[];newMessages[_0x947d71(0x1d6)](_0x223c5a=>{const _0xcd7c1c=_0x947d71;_0x223c5a[_0xcd7c1c(0x2e9)]>_0x45dc15&&_0x450ef7['push'](_0x223c5a);}),_0x450ef7['length']>0x0&&getAllClients()[_0x947d71(0x1d6)](_0x56c8fc=>{const _0x3224da=_0x947d71;getSocket(_0x56c8fc['id'])[_0x3224da(0x198)](_0x3224da(0x2ec),_0x450ef7);});}function confirmMessage(_0x465226){const _0x102a42=_0x482511;updateSetting(_0x102a42(0x2ee),Number(_0x465226));}function isNewerVersion(_0x3362a0,_0x54d815){const _0x32d943=_0x482511,_0x50e459=_0x54d815[_0x32d943(0x116)]('.'),_0x2fba62=_0x3362a0['split']('.');for(var _0x1b48e2=0x0;_0x1b48e2<_0x2fba62['length'];_0x1b48e2++){const _0x35e07c=~~_0x2fba62[_0x1b48e2],_0x4eecc2=~~_0x50e459[_0x1b48e2];if(_0x35e07c>_0x4eecc2)return!![];if(_0x35e07c<_0x4eecc2)return![];}return![];}function toTelegramMarkdown(_0x4768e5){const _0x59eb79=_0x482511,_0x1d0b97=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x1f6e71=/\*{2}(.+?)\*{2}/gim;return _0x4768e5=_0x4768e5[_0x59eb79(0x21c)](_0x1d0b97,_0x59eb79(0x1f1))[_0x59eb79(0x21c)](_0x1f6e71,_0x59eb79(0x251)),_0x4768e5;}async function validateConfigFile(){const _0x43a3ce=_0x482511,_0x438907=dbConfig[_0x43a3ce(0x223)](_0x43a3ce(0x2c5))[_0x43a3ce(0x165)](_0x43a3ce(0x167))[_0x43a3ce(0x2e0)]()||[];if(_0x438907[_0x43a3ce(0x1df)]==0x0){let _0x579e70=0x0,_0x427d9a=[];const _0x13a700=/^bot-([0-9]{3})-config.json$/,_0x3625c6=fs[_0x43a3ce(0x138)](configpath);_0x3625c6['forEach'](_0x4d4842=>{const _0x405c87=_0x43a3ce,_0x34c92f=_0x13a700[_0x405c87(0x141)](_0x4d4842);if(_0x34c92f){const _0x40358d=_0x34c92f[0x1];let _0x37f38d=getBotAttributes(_0x40358d);_0x427d9a[_0x405c87(0x248)]({'botID':_0x40358d,'botname':_0x37f38d['botname'],'status':_0x405c87(0x20f),'live':_0x405c87(0x11f)}),_0x579e70++;}}),_0x579e70!=0x0&&(dbConfig[_0x43a3ce(0x223)](_0x43a3ce(0x2c5))['assign'](_0x427d9a)[_0x43a3ce(0x1b3)](),config=_0x427d9a,restoredConfigFile=_0x579e70);}}async function restoreConfigNotify(_0xa9916f){const _0x54de51=_0x482511;let _0x33a229;if(restoredConfigFile==0x1)_0x33a229='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x33a229=_0x54de51(0x236);if(_0xa9916f)io['to'](_0x54de51(0x1db))[_0x54de51(0x198)](_0x54de51(0x1ad),_0x33a229);else{logger['simple'](_0x54de51(0x1d9)),logger[_0x54de51(0x2dd)](_0x33a229),logger[_0x54de51(0x2dd)](_0x54de51(0x1d9)),logger[_0x54de51(0x2dd)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x54de51(0x1c4)]!='orders')await sendTelegram(settings['telegramChatId'],_0x54de51(0x24a)+_0x33a229);}}function validateCredentials(_0x37e1ea,_0x53aa97){const _0xaed9c9=_0x482511;if(_0x37e1ea[_0xaed9c9(0x14e)]==settings['bbUsername']&&bcrypt[_0xaed9c9(0x2cd)](_0x37e1ea[_0xaed9c9(0x11c)],settings[_0xaed9c9(0x296)])){if(settings[_0xaed9c9(0x2c3)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x4c5550=generateLoginToken(_0x53aa97);return{'allow':!![],'reason':_0xaed9c9(0x1e8),'token':_0x4c5550};}}else return{'allow':![],'reason':_0xaed9c9(0x244),'token':null};}function refreshToken(_0x1e4724){const _0x3dbab7=_0x482511,_0x52c4bc=generateLoginToken(_0x1e4724);return{'allow':!![],'reason':_0x3dbab7(0x1e8),'token':_0x52c4bc};}function validateAccess(_0x5cb124,_0x3d1079,_0x59f8bf){const _0x66b4c4=_0x482511,_0x506ecc=_0x59f8bf?_0x59f8bf:devices[_0x3d1079]['ip'];let _0x17ab80;const _0x4b3dce=_0x3372bf=>{const _0x23ed59=_0x4219;if(settings[_0x23ed59(0x159)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x3d1079)){const _0x4f39ea=generateLoginToken(_0x3d1079);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x4f39ea};}else return{'allow':![],'reason':_0x23ed59(0x1e0),'token':null};}else return _0x17ab80=validToken(_0x3372bf,_0x3d1079),_0x17ab80['hasOwnProperty']('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x3372bf}:{'allow':![],'reason':_0x23ed59(0x1e0),'token':null};}else return{'allow':!![],'reason':_0x23ed59(0x173),'token':null};};if(settings['whitelistEnabled']){let _0xd4924c=[...settings[_0x66b4c4(0x2a2)],_0x66b4c4(0x222),_0x66b4c4(0x119),_0x66b4c4(0x2e3)];if(_0xd4924c['includes'](_0x506ecc))return _0x4b3dce(_0x5cb124);else{_0x17ab80=validToken(_0x5cb124,_0x3d1079);if(_0x17ab80[_0x66b4c4(0x2ad)](_0x66b4c4(0x164)))return _0x4b3dce(_0x5cb124);else{if(telegramIpApproved(_0x3d1079)){const _0x2328ca=generateToken(_0x3d1079);return _0x17ab80=_0x4b3dce(_0x5cb124),_0x17ab80[_0x66b4c4(0x1b2)]?{'allow':!![],'reason':_0x66b4c4(0x10f),'token':_0x2328ca}:_0x17ab80;}else return settings[_0x66b4c4(0x114)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x66b4c4(0x2d8),'token':null};}}}else return _0x4b3dce(_0x5cb124);}function timelyDecrypt(_0x17ff63,_0x70a14e=!![]){const _0x3eb12=_0x482511;if(_0x17ff63)try{const _0x22d05b=crypt[_0x3eb12(0x1b8)](secure['privateKey'],_0x17ff63)['message'],_0x5f0bf0=_0x22d05b[_0x3eb12(0x116)]('@')[0x0],_0x89ebd6=_0x22d05b['split']('@')[0x1],_0x495bc1=new Date()[_0x3eb12(0x1ea)]();if(_0x70a14e){if(_0x495bc1-_0x89ebd6<maxSecretAge*0x3e8)return _0x5f0bf0;else return![];}else return _0x5f0bf0;}catch(_0x4ab90d){return![];}else return![];}const validToken=(_0x11205c,_0x49cf6a)=>{const _0x193e28=_0x482511,_0x50a351=devices[_0x49cf6a]['ip'];if(!_0x11205c)return{'error':_0x193e28(0x245)};for(let _0x57f18a of blacklist){if(_0x57f18a[_0x193e28(0x277)]==_0x11205c)return{'error':'Token\x20blacklisted'};}let _0x4361b5;try{_0x4361b5=jwt[_0x193e28(0x1a3)](_0x11205c,secure[_0x193e28(0x1c6)]+_0x49cf6a);}catch{return{'error':_0x193e28(0x203)};}if(!_0x4361b5[_0x193e28(0x2ad)](_0x193e28(0x1e3))&&!_0x4361b5[_0x193e28(0x2ad)](_0x193e28(0x14e))||!_0x4361b5[_0x193e28(0x2ad)]('exp'))return{'error':_0x193e28(0x235)};if(!_0x4361b5['hasOwnProperty'](_0x193e28(0x14e))&&_0x4361b5['hasOwnProperty'](_0x193e28(0x1e3))){const {clientip:_0x71aa0a}=_0x4361b5;return _0x50a351==_0x71aa0a?{'success':_0x193e28(0x282)}:{'error':_0x193e28(0x264)};}else{if(_0x4361b5[_0x193e28(0x2ad)]('username')&&_0x4361b5['hasOwnProperty'](_0x193e28(0x1e3))){const {username:_0x378361,clientip:_0x40b699}=_0x4361b5;return settings[_0x193e28(0x2a6)]==_0x378361&&_0x50a351==_0x40b699?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x193e28(0x210)};}}},generateLoginToken=_0x322346=>{const _0x1fb86a=_0x482511;if(_0x322346){const _0x2cc05b=devices[_0x322346]['ip'];return jwt[_0x1fb86a(0x24d)]({'username':settings[_0x1fb86a(0x2a6)],'clientip':_0x2cc05b},secure[_0x1fb86a(0x1c6)]+_0x322346,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x1440f5=>{const _0x39a60f=_0x482511;if(_0x1440f5){const _0x5483de=devices[_0x1440f5]['ip'];return jwt['sign']({'clientip':_0x5483de},secure[_0x39a60f(0x1c6)]+_0x1440f5,{'expiresIn':devices[_0x1440f5][_0x39a60f(0x1e6)][_0x39a60f(0x266)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x35c85f=>{const _0x3f4c16=_0x482511;let _0x592f1e=![];return devices[_0x35c85f][_0x3f4c16(0x1e6)]&&devices[_0x35c85f][_0x3f4c16(0x1e6)][_0x3f4c16(0x266)]!='reject'&&(_0x592f1e=devices[_0x35c85f][_0x3f4c16(0x1e6)][_0x3f4c16(0x1e3)]==devices[_0x35c85f]['ip']&&new Date()[_0x3f4c16(0x1ea)]()-devices[_0x35c85f][_0x3f4c16(0x1e6)][_0x3f4c16(0x275)]<devices[_0x35c85f][_0x3f4c16(0x1e6)]['expiry']*0x3c*0x3e8),_0x592f1e;},telegram2FaApproved=_0x42c78b=>{const _0x258d69=_0x482511;let _0x26d101=![];return devices[_0x42c78b]['telegram2FaApproval']&&devices[_0x42c78b][_0x258d69(0x1e9)][_0x258d69(0x266)]!='reject'&&(_0x26d101=devices[_0x42c78b][_0x258d69(0x1e9)][_0x258d69(0x1e3)]==devices[_0x42c78b]['ip']&&new Date()['getTime']()-devices[_0x42c78b][_0x258d69(0x1e9)][_0x258d69(0x275)]<devices[_0x42c78b]['telegram2FaApproval'][_0x258d69(0x266)]*0x3c*0x3e8),_0x26d101;},normalizeIP=_0xa0811a=>{const _0x5012e1=_0x482511;let _0x6bbaef=null,_0x141cd4=null;if(ipaddr[_0x5012e1(0x213)](_0xa0811a)){const _0x1b0541=ipaddr[_0x5012e1(0x14c)](_0xa0811a);_0x1b0541[_0x5012e1(0x2b5)]()===_0x5012e1(0x2a1)?(_0x1b0541[_0x5012e1(0x2a0)]()&&(_0x6bbaef=_0x1b0541['toIPv4Address']()[_0x5012e1(0x292)]()),_0x141cd4=_0x1b0541['toString']()):(_0x6bbaef=_0x1b0541[_0x5012e1(0x292)](),_0x141cd4=_0x1b0541[_0x5012e1(0x1fb)]()[_0x5012e1(0x292)]());}return{'show':_0x6bbaef?_0x6bbaef:_0x141cd4,'store':_0x141cd4};};function formatDate(_0x42b0a2){const _0x5a7287=_0x482511;return _0x42b0a2[_0x5a7287(0x139)]()+'/'+(_0x42b0a2[_0x5a7287(0x28c)]()+0x1)[_0x5a7287(0x292)]()[_0x5a7287(0x112)](0x2,'0')+'/'+_0x42b0a2[_0x5a7287(0x1ab)]()[_0x5a7287(0x292)]()['padStart'](0x2,'0')+'\x20'+_0x42b0a2[_0x5a7287(0x155)]()[_0x5a7287(0x292)]()[_0x5a7287(0x112)](0x2,'0')+':'+_0x42b0a2['getMinutes']()[_0x5a7287(0x292)]()[_0x5a7287(0x112)](0x2,'0')+':'+_0x42b0a2[_0x5a7287(0x2b4)]()[_0x5a7287(0x292)]()[_0x5a7287(0x112)](0x2,'0');}function sleep(_0x4a6071){return new Promise(_0x45957a=>setTimeout(_0x45957a,_0x4a6071));}