const _0x163029=_0x4908;(function(_0x1b8151,_0x18e797){const _0x4a58a7=_0x4908,_0x4776bd=_0x1b8151();while(!![]){try{const _0x593029=-parseInt(_0x4a58a7(0x325))/0x1*(parseInt(_0x4a58a7(0x207))/0x2)+-parseInt(_0x4a58a7(0x23a))/0x3+-parseInt(_0x4a58a7(0x1eb))/0x4+-parseInt(_0x4a58a7(0x290))/0x5+-parseInt(_0x4a58a7(0x223))/0x6*(-parseInt(_0x4a58a7(0x1e9))/0x7)+parseInt(_0x4a58a7(0x396))/0x8+parseInt(_0x4a58a7(0x24a))/0x9;if(_0x593029===_0x18e797)break;else _0x4776bd['push'](_0x4776bd['shift']());}catch(_0x54a704){_0x4776bd['push'](_0x4776bd['shift']());}}}(_0x1b47,0x5b1e6));const _0x1cd5ff=function(){let _0x18891f=!![];return function(_0x5863c1,_0x32bf5b){const _0x2dda2c=_0x18891f?function(){const _0x4cda2a=_0x4908;if(_0x32bf5b){const _0x54daa5=_0x32bf5b[_0x4cda2a(0x266)](_0x5863c1,arguments);return _0x32bf5b=null,_0x54daa5;}}:function(){};return _0x18891f=![],_0x2dda2c;};}(),_0x1fb5dd=_0x1cd5ff(this,function(){const _0x3053cc=_0x4908;return _0x1fb5dd[_0x3053cc(0x2ad)]()[_0x3053cc(0x242)](_0x3053cc(0x2b2))[_0x3053cc(0x2ad)]()[_0x3053cc(0x2e5)](_0x1fb5dd)[_0x3053cc(0x242)](_0x3053cc(0x2b2));});_0x1fb5dd();'use strict';process['env'][_0x163029(0x2f7)]=0x1;const childProcess=require(_0x163029(0x2bf)),fs=require('fs'),fns=require(_0x163029(0x25e)),low=require(_0x163029(0x237)),FileSync=require(_0x163029(0x1ef)),path=require(_0x163029(0x24c)),crypto=require('crypto'),Crypt=require(_0x163029(0x1bc))[_0x163029(0x2e6)],RSA=require(_0x163029(0x1bc))[_0x163029(0x1e3)],bcrypt=require('bcryptjs'),jwt=require(_0x163029(0x342)),ipaddr=require(_0x163029(0x221)),argv=require(_0x163029(0x1c4))(process[_0x163029(0x293)][_0x163029(0x35c)](0x2))[_0x163029(0x293)],uuidRandom=require(_0x163029(0x391)),{Telegraf,Markup}=require(_0x163029(0x272)),Mixpanel=require(_0x163029(0x280)),axios=require(_0x163029(0x1e2)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x163029(0x3a6)),fileUpload=require(_0x163029(0x21b)),{networkInterfaces}=require('os'),PORT=argv[_0x163029(0x398)]||_0x163029(0x3a4),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x163029(0x219)]('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x163029(0x394)](0x1));const HOST=argv['host']||null,userID=argv[_0x163029(0x276)]||'',debugging=argv['d']||![],nodeversion=process[_0x163029(0x34c)][_0x163029(0x32a)];let bbpath='bb/',bbpath2='';const botfile=_0x163029(0x2fb),configfile=_0x163029(0x373),settingsfile='bb-settings.json',securefile=_0x163029(0x1e1),environment=require('./'+bbpath2+_0x163029(0x2cd))[_0x163029(0x1c7)]||_0x163029(0x374),maxBackups=0xa;let validInstallation=!![];!fs[_0x163029(0x2c6)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x163029(0x3b1)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x163029(0x24e),logspath=userID?bbpath+_0x163029(0x392)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x163029(0x2fd),loggerfile=fs[_0x163029(0x2d5)](logspath+_0x163029(0x345),{'flags':'a'}),temppath=userID?bbpath+_0x163029(0x316)+userID+'/':bbpath+_0x163029(0x316);!fs[_0x163029(0x2c6)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x163029(0x2c6)](configbackuppath)&&fs[_0x163029(0x355)](configbackuppath);!fs[_0x163029(0x2c6)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x163029(0x2c6)](zippath)&&fs[_0x163029(0x355)](zippath);!fs[_0x163029(0x2c6)](temppath)&&fs[_0x163029(0x355)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x163029(0x238)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x163029(0x238)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x163029(0x331),'onepagemode':![]}})[_0x163029(0x1f9)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x163029(0x238)]({'secure':{},'blacklist':[]})[_0x163029(0x1f9)]();function _0x1b47(){const _0x39e782=['NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','cancelLoading','Network\x20Interfaces:','blacklist','-results.json','config_orders','89465fwJKsq','startsWith','Failed\x20to\x20download\x20','argv','login\x20required','off','name','15\x20min','backup-full','push','bbPassword','get-portfolio','output-002.log','tempaccess_5','invalid\x20credentials','toIPv4Address','Invalid\x20authentication\x20token\x20(1)','sendFile','Unauthorized\x20attempt\x20to\x20log\x20out','add','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','\x20only\x0a','deleteHistoryAlerts','readFileSync','ipc','reason','test','store-fiat','storeConfiguration','toString','alerts','Restore\x20process\x20aborted','Unauthorized\x20attempt\x20to\x20update\x20bot','value','(((.+)+)+)+$','uuid','temporary\x20access\x20timeout','manual','getPortfolio','output-001.log','settings.','build2','data','pidExpireLogin','getSeconds','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','2FA\x20login\x20rejected','child_process','2FA','settings','\x20(1)','exp','Access\x20enabled\x20for\x20','isIPv4MappedAddress','existsSync','api-eu.mixpanel.com','Password\x20reset\x20rejected','password','update_no','\x1b[31m','/:bot/coins','version.json','Telegraf\x20error:','staging','\x20|\x20client:\x20...','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','remoteAddress','userid','server','createWriteStream','uncaughtException','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','secret','Unauthorized\x20attempt\x20to\x20delete\x20bot','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','telegramIpApproval','All\x20bots','copyFileSync','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','delete-alerts',':\x20Bot\x20Mgr\x20>\x20','reload','socket.io','getHours','Unauthorized\x20attempt\x20to\x20get\x20messages','constructor','Crypt','isValid','sortBy','bot','static','inherit','Deleted\x20Bot\x20','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','place-order','whitelistEnabled','timeshift','config_alerts','[ip-address]','bbUsername','2FA\x20required','telegrammsg','fork','NTBA_FIX_319','************','SIGINT','readdirSync','bot.js','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','zip/','All\x20bots\x20running\x20right\x20now','backup','-performance.json','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','\x20|\x20','Unauthorized\x20login\x20attempt\x20(timeout)','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','backup-full.zip','output-003.log','timestamp','*$1*','catch','alias','rmSync','/start','writeFileSync','post','error','Login\x20rejected','exchange','full','sendMessage','<b>Telegram\x20Bot\x20Status:</b>\x0a','storeHeadless','temp/','tempaccess_30','Password\x20has\x20been\x20reset\x20to:\x20','User\x20has\x20been\x20validated','Restore\x20process\x20confirmed','login\x20token\x20generated','started','join','Notifications\x20enabled\x0a','any','replace','::1','privateKey','find','#RES#\x20if\x20running\x20on\x20server','3088QChbgp','headless','/metrics\x20-\x20show\x20bot\x20performance\x0a','\x20to\x20','toggle_','node','new','remove','filter','restore-backup-file','Unauthorized\x20attempt\x20to\x20download\x20','reinstall_yes','0.0.0','enabled','confirm-message','chat','createServer','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','includes','#RES#\x20if\x20running\x20locally\x0a','IPv4','get','All','allow','get-starting-balances','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Starting\x20new\x20bot\x20|\x20Bot\x20','disabled','getStartingBalances','jsonwebtoken','action','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','/output-000.log','internal','/:bot/portfolio','login2fa_','#RES#\x20','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','reinstall-bb','versions','token','enable','yes','Login\x20accepted','telegramEnabled','getUTCHours','emitHistory','headers','mkdirSync','cancel-loading','tempaccess_reject','telegramToken','portfolio_','auth','connection','slice','Idling\x20(','DEFLATE','store-configuration','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','1000','SIGTERM','once','debug','/on\x20-\x20start\x20bot(s)\x0a','compareSync','add-bot','$1_$2_$3','running','live','Logged\x20out\x20user\x20...','lastmsgtelegram','sockets','telegramEvents','status','/help\x20-\x20show\x20available\x20commands\x0a','\x1b[34m','Notifications\x20enabled','bb-config.json','production','-events.json','update','disconnect','No\x20bots\x20running\x20right\x20now','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','logs',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','onepagemode','conn','resetpw_no','function','::ffff:127.0.0.1','number','binary','Ok,\x20will\x20send\x20alert\x20notifications\x20only','tempaccess_15','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','success','botID','size','store-headless','Enabled\x20Bot\x20','simple','assign','getTime','expiry','publicKey','kill','uuid-random','logs/','\x20mode','exit','Token\x20blacklisted','1517640RxjQHb','temporary\x20access\x20not\x20allowed','port','cloneDeep','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','backup-full@','f2aRequired','Notifications\x20types:\x20','toIPv4MappedAddress','format','config_all','endsWith','output-000.log','secure','3000','keys','util','Disabled\x20Bot\x20','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Setting\x20access:\x20','.zip','Restoring\x20bot(s)\x20from\x20backup','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','***','hasOwnProperty','sendMetricsTelegram','inlineKeyboard','clients','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','order','index.html','update_yes','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','hybrid-crypto-js','bb-settings.json','updatebotmanager','Bot\x20','pidRefreshToken','Notifications\x20disabled\x0a','telegramUsername','stopped','yargs/yargs','stringify','randomBytes','environment','telegramChatId','reset-history','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','metrics_','stop','string','getMinutes','store','-config.json','temporary\x20token\x20generated','notification','ipv6','download','help','tkn','access\x20timeout','clientip','Logged\x20in\x20user\x20...','messages','reject','toggle-bot-mode','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','split','temporaryAccessAllowed','send','bb-secure.json','axios','RSA','bbvReceive','mode','You\x20can\x20use\x20the\x20following\x20commands:\x0a','build','bot-','77ZEmvnh','sha256','473848JpLEbG','HTML','Yes','close','lowdb/adapters/FileSync','Bot\x20Mgr\x20>\x20','Node.js\x20v','update-bb','toggle','Your\x20installation\x20is\x20already\x20up\x20to\x20date','telegram2FaApproval','reply','No\x20authentication\x20token','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','write','update-bot','=>\x20Go\x20to\x20#CYA#http://','orders','/:bot','Starting\x20(','bots','Unauthorized\x20attempt\x20to\x20store\x20configuration','login\x20not\x20required','bbvNew','Error\x20removing\x20old\x20backup\x20files:','generateKeyPairAsync','request','placeOrder','470avrsqm','backup-files','node-zip','referer','files','Backup\x20file\x20unzipped\x20and\x20stored','parse','login','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','args','Unauthorized\x20attempt\x20to\x20get\x20events','\x20(2)','restore_yes','event','Restore\x20backup\x20file\x20','message','range','metrics','log','getFullYear','express-fileupload','reinstall','file','callback','resetHistory','latestversion','ipaddr.js','title','34698qCioQy','apiPassword','telegram','max','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','get-messages','handshake','names','getMonth','launch','editMessageReplyMarkup','match','loginRequired','family','show','forEach','unlinkSync','/enable\x20-\x20enable\x20notifications\x0a','restart','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','lowdb','defaults','storeFiat','881559AaDrLQ','use','5\x20min','30\x20min','Server','show-config',')\x20|\x20Bot\x20','type','search','access','username','temporary\x20access\x20rejected','Error\x20while\x20deleting\x20config\x20files:\x20','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','botname','socket','11482128aWxPcn','RSA-OAEP','path','isDirectory','backup/','padStart','Unauthorized\x20attempt\x20to\x20confirm\x20message','apiSecret','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','text','params','button','config','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','botmanager','/upload-backup','reset-password','emit','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','date-fns','get-backup-files','getDate','disable','mtime','command','Starting\x20Balance\x20Bot\x20reinstallation',')\x20\x20\x20|\x20Bot\x20','apply','delete-bot','Session\x20expired\x20for\x20user\x20...','new-disabled','apiKey','lastmsgemitted','express','Unauthorized\x20attempt\x20to\x20add\x20bot','-----------------------------------------------------------------------------------','init','address','then','telegraf','logout','\x20>\x20','sign','user','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','auto','statSync','length','6b67f3d61ee94b8f5c80b4affef4c4d9','\x1b[36m','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','/off\x20-\x20stop\x20bot(s)\x0a','mixpanel','private','randomFillSync','encryptedUuid','sort','Telegram\x20error:','all','restore_no','\x1b[35m','from'];_0x1b47=function(){return _0x39e782;};return _0x1b47();}let crypt=new Crypt({'md':_0x163029(0x1ea),'rsaStandard':_0x163029(0x24b)});const saltRounds=0xa,mixpanel=Mixpanel[_0x163029(0x26f)](_0x163029(0x27c),{'host':_0x163029(0x2c7)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings[_0x163029(0x358)]!=''&&settings[_0x163029(0x358)]!='***')&&settings[_0x163029(0x1c2)]&&settings[_0x163029(0x1c2)]!='')initTelegram();const parseColor=(_0x501ba8,_0x2f30de)=>{const _0x38c0b0=_0x163029,_0x5005ac=/#[A-Z]{3}#/g;if(typeof _0x501ba8==_0x38c0b0(0x1cd)){!_0x2f30de?_0x501ba8=_0x501ba8['replace'](_0x5005ac,''):(_0x501ba8=_0x501ba8[_0x38c0b0(0x320)](/#BLU#/g,_0x38c0b0(0x371)),_0x501ba8=_0x501ba8['replace'](/#RED#/g,_0x38c0b0(0x2cb)),_0x501ba8=_0x501ba8[_0x38c0b0(0x320)](/#YEL#/g,'\x1b[33m'),_0x501ba8=_0x501ba8[_0x38c0b0(0x320)](/#MAG#/g,_0x38c0b0(0x288)),_0x501ba8=_0x501ba8[_0x38c0b0(0x320)](/#CYA#/g,_0x38c0b0(0x27d)),_0x501ba8=_0x501ba8[_0x38c0b0(0x320)](/#RES#/g,'\x1b[0m'));;}return _0x501ba8;},logger={'screen':_0x42c0e2=>{const _0x5215cc=_0x163029;console[_0x5215cc(0x219)](parseColor(_0x42c0e2,!![]));},'simple':_0x3385df=>{const _0x43e5df=_0x163029;console[_0x43e5df(0x219)](parseColor(_0x3385df,!![])),loggerfile[_0x43e5df(0x1f9)](util[_0x43e5df(0x39f)](parseColor(_0x3385df,![]))+'\x0a');},'full':async _0x5f5aa2=>{const _0x501e75=_0x163029,_0x21b858=getTimeStamp()+_0x501e75(0x2e0)+_0x5f5aa2;console[_0x501e75(0x219)](parseColor(_0x21b858,!![])),loggerfile[_0x501e75(0x1f9)](util[_0x501e75(0x39f)](parseColor(_0x21b858,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!='orders')await sendTelegram(settings[_0x501e75(0x1c8)],_0x501e75(0x1f0)+parseColor(_0x5f5aa2,![]));},'debug':async(_0x42a6d1,_0x1ccf1c='')=>{const _0x44dc51=_0x163029,_0x17b8e9=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x42a6d1;if(debugging)console[_0x44dc51(0x219)](parseColor(_0x17b8e9,!![]));loggerfile[_0x44dc51(0x1f9)](util[_0x44dc51(0x39f)](parseColor(_0x17b8e9,![]))+'\x0a');if(_0x1ccf1c){if(debugging)console[_0x44dc51(0x219)](_0x1ccf1c);loggerfile[_0x44dc51(0x1f9)](util[_0x44dc51(0x39f)](_0x1ccf1c)+'\x0a');}}};process['on'](_0x163029(0x2d6),function(_0xb755e4){const _0x369b9f=_0x163029;logger[_0x369b9f(0x38b)](_0xb755e4);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x163029(0x2cd))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x163029(0x26c)),app=express(),http=require('http')[_0x163029(0x335)](app);app[_0x163029(0x23b)](fileUpload({'useTempFiles':!![]})),app[_0x163029(0x33a)]('/download/:type',async(_0x190ab5,_0x17b783)=>{const _0x4ff20e=_0x163029,_0x45975=_0x190ab5[_0x4ff20e(0x255)][_0x4ff20e(0x241)],_0x467b86=getClientsWithBotID(_0x4ff20e(0x259)),_0xf5ca8f=_0x190ab5[_0x4ff20e(0x354)][_0x4ff20e(0x2b3)],_0x4a7894=timelyDecrypt(_0xf5ca8f,![]),_0x372fd2=_0x467b86[_0x4ff20e(0x323)](_0x570af8=>_0x570af8[_0x4ff20e(0x2b3)]==_0x4a7894);if(_0x372fd2){const _0x40d9c7=normalizeIP(_0x190ab5[_0x4ff20e(0x249)][_0x4ff20e(0x2d2)])[_0x4ff20e(0x1cf)],_0x50a41c=_0x190ab5[_0x4ff20e(0x354)][_0x4ff20e(0x1d6)];if(validateAccess(_0x50a41c,_0x4a7894,_0x40d9c7)['allow'])_0x45975=='backup'&&await backupConfigFiles(),await zipFiles(_0x45975),_0x17b783[_0x4ff20e(0x1d4)](zippath+(_0x45975+_0x4ff20e(0x3aa)),_0x497632=>{const _0x465fa8=_0x4ff20e;_0x497632&&(logger[_0x465fa8(0x312)](_0x465fa8(0x292)+_0x45975),logger[_0x465fa8(0x38b)](_0x497632));});else logger[_0x4ff20e(0x312)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x45975+_0x4ff20e(0x2c2));}else logger['full'](_0x4ff20e(0x32f)+_0x45975+_0x4ff20e(0x212));}),app[_0x163029(0x30e)](_0x163029(0x25a),async(_0x2a96a5,_0x235fbf)=>{const _0x37ed53=_0x163029,_0x4b01a3=getClientsWithBotID(_0x37ed53(0x259)),_0x9f1361=_0x2a96a5[_0x37ed53(0x354)][_0x37ed53(0x2b3)],_0x27142e=timelyDecrypt(_0x9f1361,![]),_0x4b311b=_0x4b01a3[_0x37ed53(0x323)](_0x2733a4=>_0x2733a4[_0x37ed53(0x2b3)]==_0x27142e);logger[_0x37ed53(0x364)]('Backup\x20file\x20uploaded');if(_0x4b311b){const _0xf7f839=normalizeIP(_0x2a96a5[_0x37ed53(0x249)][_0x37ed53(0x2d2)])[_0x37ed53(0x1cf)],_0x29f155=_0x2a96a5[_0x37ed53(0x354)][_0x37ed53(0x1d6)];if(validateAccess(_0x29f155,_0x27142e,_0xf7f839)['allow']){if(_0x2a96a5[_0x37ed53(0x20b)]){const _0x584a1b=_0x2a96a5[_0x37ed53(0x20b)]['backupfile'];await _0x584a1b['mv'](temppath+_0x584a1b[_0x37ed53(0x296)]),_0x235fbf['send']({'status':!![],'message':'File\x20uploaded'});const _0x345c85=getBotsWithMode();_0x345c85[_0x37ed53(0x27b)]>0x0?confirmRestore(temppath,_0x584a1b[_0x37ed53(0x296)]):unzipFile(temppath,_0x584a1b[_0x37ed53(0x296)]);}}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x37ed53(0x312)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x163029(0x23b)](express['static'](path[_0x163029(0x31d)](__dirname,bbpath2,_0x163029(0x2b9)))),app[_0x163029(0x23b)](express[_0x163029(0x2ea)](path['join'](__dirname,bbpath2,_0x163029(0x1e7)))),app[_0x163029(0x33a)]('/',function(_0x2affe3,_0x1df181){const _0x489ab6=_0x163029;_0x1df181['sendFile'](path['join'](__dirname,bbpath2,_0x489ab6(0x2b9),_0x489ab6(0x1b9)));}),app[_0x163029(0x33a)](_0x163029(0x1fd),function(_0x3e59b4,_0xa3b036){const _0x25112a=_0x163029;_0xa3b036[_0x25112a(0x2a1)](path[_0x25112a(0x31d)](__dirname,bbpath2,_0x25112a(0x1e7),'index.html'));}),app[_0x163029(0x33a)](_0x163029(0x347),(_0x48abf6,_0x52218f)=>{const _0x593354=_0x163029;_0x52218f[_0x593354(0x2a1)](path[_0x593354(0x31d)](__dirname,bbpath2,_0x593354(0x1e7),_0x593354(0x1b9)));}),app[_0x163029(0x33a)]('/:bot/performance',(_0x1d64b1,_0x2c0ae6)=>{const _0x464b03=_0x163029;_0x2c0ae6[_0x464b03(0x2a1)](path[_0x464b03(0x31d)](__dirname,bbpath2,'build','index.html'));}),app['get'](_0x163029(0x2cc),(_0x14a82b,_0x30bfa8)=>{const _0x13e737=_0x163029;_0x30bfa8[_0x13e737(0x2a1)](path[_0x13e737(0x31d)](__dirname,bbpath2,_0x13e737(0x1e7),_0x13e737(0x1b9)));}),app[_0x163029(0x33a)]('/:bot/history',(_0x474db9,_0x281e94)=>{const _0x41c797=_0x163029;_0x281e94[_0x41c797(0x2a1)](path[_0x41c797(0x31d)](__dirname,bbpath2,_0x41c797(0x1e7),_0x41c797(0x1b9)));}),app['get']('/:bot/configuration',(_0x301a07,_0x282744)=>{const _0x45a9b2=_0x163029;_0x282744[_0x45a9b2(0x2a1)](path[_0x45a9b2(0x31d)](__dirname,bbpath2,_0x45a9b2(0x1e7),'index.html'));}),app[_0x163029(0x33a)]('/:bot/support',(_0x3da2dc,_0x13ea51)=>{const _0x253827=_0x163029;_0x13ea51['sendFile'](path[_0x253827(0x31d)](__dirname,bbpath2,_0x253827(0x1e7),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require(_0x163029(0x2e2))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x450abc=_0x163029;let _0x1f49b6=_0x450abc(0x2f2);const _0x4cc85a=networkInterfaces(),_0x2d41f6={};for(const _0xba60e9 of Object[_0x450abc(0x3a5)](_0x4cc85a)){for(const _0x1f9fc2 of _0x4cc85a[_0xba60e9]){if((_0x1f9fc2[_0x450abc(0x230)]==_0x450abc(0x339)||_0x1f9fc2['family']==0x4)&&!_0x1f9fc2[_0x450abc(0x346)]){const _0x457978=ipaddr[_0x450abc(0x20d)](_0x1f9fc2['address'])[_0x450abc(0x217)]();_0x457978!=_0x450abc(0x281)&&(!_0x2d41f6[_0xba60e9]&&(_0x2d41f6[_0xba60e9]=[]),_0x2d41f6[_0xba60e9][_0x450abc(0x299)](_0x1f9fc2['address']),_0x1f49b6=_0x1f9fc2[_0x450abc(0x270)]);}}}return{'serverip':_0x1f49b6,'netinterfaces':_0x2d41f6};}async function startServer(){const _0x396cf1=_0x163029,{serverip:_0xc6a94a,netinterfaces:_0x3802dc}=getServerIP();logger[_0x396cf1(0x38b)](''),logger['simple'](_0x396cf1(0x26e)),await logger[_0x396cf1(0x312)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x396cf1(0x349)+(environment==_0x396cf1(0x2cf)?'(staging)':'')+'\x0a'+(_0x396cf1(0x33e)+PORT+_0x396cf1(0x338))+(_0x396cf1(0x1fb)+_0xc6a94a+':'+PORT+_0x396cf1(0x324))),logger[_0x396cf1(0x38b)](_0x396cf1(0x26e));if(config[_0x396cf1(0x27b)]!=0x0)for(const _0x4dc671 of config){const _0x204807=_0x4dc671['mode']==_0x396cf1(0x279)?'a':'m';if(_0x4dc671[_0x396cf1(0x36f)]==_0x396cf1(0x332)||_0x4dc671[_0x396cf1(0x36f)]==_0x396cf1(0x32b))await logger[_0x396cf1(0x312)](_0x396cf1(0x1fe)+_0x204807+_0x396cf1(0x240)+_0x4dc671[_0x396cf1(0x387)]+_0x396cf1(0x302)+_0x4dc671[_0x396cf1(0x248)]),startBot([_0x4dc671[_0x396cf1(0x387)],userID],{'cwd':bbpath},function(_0x5b113c){const _0x5229dc=_0x396cf1;if(_0x5b113c)logger[_0x5229dc(0x312)](_0x5b113c);});else(_0x4dc671[_0x396cf1(0x36f)]==_0x396cf1(0x340)||_0x4dc671[_0x396cf1(0x36f)]=='new-disabled')&&await logger[_0x396cf1(0x312)](_0x396cf1(0x35d)+_0x204807+_0x396cf1(0x265)+_0x4dc671[_0x396cf1(0x387)]+_0x396cf1(0x302)+_0x4dc671[_0x396cf1(0x248)]);}else!newBot&&logger[_0x396cf1(0x38b)](_0x396cf1(0x39a));if(newBot)addBot();logger[_0x396cf1(0x38b)](_0x396cf1(0x26e)),logger[_0x396cf1(0x38b)](''),await logger['debug'](_0x396cf1(0x1f1)+nodeversion),await logger[_0x396cf1(0x364)](_0x396cf1(0x28c),_0x3802dc);}function startSocket(){const _0x21c683=_0x163029;io['on'](_0x21c683(0x35b),_0x430001=>{const _0x25da07=_0x21c683;let _0x334349,_0x362343,_0x764c73,_0x531dee,_0x2b495c;const _0x4a352d=_0x430001['handshake'][_0x25da07(0x354)][_0x25da07(0x20a)];_0x362343=_0x4a352d['match'](/bot[0-9]{3}/);if(_0x362343)_0x764c73=_0x362343[0x0][_0x25da07(0x22e)](/[0-9]{3}/);if(_0x764c73)_0x334349=_0x764c73[0x0];else _0x334349=_0x25da07(0x259);const _0x35ce06=_0x430001[_0x25da07(0x229)][_0x25da07(0x35a)][_0x25da07(0x283)];if(!_0x35ce06)_0x430001[_0x25da07(0x25c)](_0x25da07(0x36f),{'publicKey':secure[_0x25da07(0x38f)]});else{_0x531dee=timelyDecrypt(_0x35ce06,![]);if(!_0x531dee)_0x430001[_0x25da07(0x25c)](_0x25da07(0x36f),{'publicKey':secure['publicKey']});else{_0x2b495c=normalizeIP(_0x430001[_0x25da07(0x37d)][_0x25da07(0x2d2)])[_0x25da07(0x1cf)];if(!devices[_0x531dee])devices[_0x531dee]={'uuid':_0x531dee,'access':{'token':null}};devices[_0x531dee]['ip']=_0x2b495c;const _0x37d831=addClient(_0x430001['id'],_0x531dee,_0x334349);setAccess(_0x37d831),emitMessages(),_0x430001['on'](_0x25da07(0x20e),_0x5a535b=>{const _0x5190d4=_0x25da07,_0x3a06cf=timelyDecrypt(_0x5a535b[_0x5190d4(0x2c9)]);if(_0x3a06cf){_0x5a535b={'username':_0x5a535b[_0x5190d4(0x244)],'password':_0x3a06cf},devices[_0x531dee][_0x5190d4(0x243)]=validateCredentials(_0x5a535b,_0x531dee);if(devices[_0x531dee][_0x5190d4(0x243)]['allow']==![]&&devices[_0x531dee]['access'][_0x5190d4(0x2a9)]=='2FA\x20login\x20required')_0x430001[_0x5190d4(0x25c)](_0x5190d4(0x36f),{'access':devices[_0x531dee][_0x5190d4(0x243)]}),loginAccess2FA(_0x531dee,_0x2b495c);else{if(devices[_0x531dee][_0x5190d4(0x243)]['allow']==![]&&devices[_0x531dee][_0x5190d4(0x243)][_0x5190d4(0x2a9)]==_0x5190d4(0x29e))_0x430001[_0x5190d4(0x25c)]('status',{'access':devices[_0x531dee][_0x5190d4(0x243)]});else devices[_0x531dee]['access']['allow']&&devices[_0x531dee][_0x5190d4(0x243)][_0x5190d4(0x2a9)]==_0x5190d4(0x31b)&&(getClientsWithUuid(_0x531dee)[_0x5190d4(0x232)](_0x15fe5a=>{setAccess(_0x15fe5a);}),logger['debug'](_0x5190d4(0x1d9)+_0x531dee['slice'](-0x8)),setTokenRefresh(_0x531dee),setSessionTimeout(_0x5190d4(0x20e),_0x531dee));}}else logger[_0x5190d4(0x312)](_0x5190d4(0x303));}),_0x430001['on'](_0x25da07(0x25b),()=>{resetPassword();}),_0x430001['on'](_0x25da07(0x377),_0x526b7a=>{removeClient(_0x430001['id']);}),_0x334349==_0x25da07(0x259)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x2eb68a){const _0x1a00e1=_0x163029;if(_0x2eb68a!=_0x1a00e1(0x259)&&config['apiKey']!=''){if(pid[_0x2eb68a])pid[_0x2eb68a]['send']({'function':'initclient','args':null});}_0x2eb68a!=_0x1a00e1(0x259)&&broadcastToBots('bots',JSON['stringify'](config));}function reloadBotManager(){const _0x1686df=_0x163029;getClientsWithBotID(_0x1686df(0x259))[_0x1686df(0x232)](_0x2fb7af=>{const _0x2fde61=_0x1686df;getSocket(_0x2fb7af['id'])[_0x2fde61(0x25c)](_0x2fde61(0x36f),{'access':{'allow':![],'reason':_0x2fde61(0x2e1),'token':null}});});}function getSocket(_0x46b674){const _0xb9e941=_0x163029;return io[_0xb9e941(0x36d)][_0xb9e941(0x36d)][_0xb9e941(0x33a)](_0x46b674);}function setAccess(_0x1875a1){const _0x25b073=_0x163029,_0x3b680d=getSocket(_0x1875a1['id']),_0xf062ce=_0x1875a1[_0x25b073(0x2b3)],_0x14db39=_0x1875a1[_0x25b073(0x2e9)];devices[_0xf062ce][_0x25b073(0x243)]=validateAccess(devices[_0xf062ce][_0x25b073(0x243)]['token'],_0xf062ce),logger['debug'](_0x25b073(0x3a9)+devices[_0xf062ce][_0x25b073(0x243)][_0x25b073(0x2a9)]+_0x25b073(0x2d0)+_0x1875a1['id'][_0x25b073(0x35c)](-0x8)+'\x20|\x20user:\x20...'+_0xf062ce[_0x25b073(0x35c)](-0x8)),_0x3b680d[_0x25b073(0x31d)](_0xf062ce);if(devices[_0xf062ce]['access'][_0x25b073(0x33c)]){_0x3b680d[_0x25b073(0x31d)](_0x14db39);if(_0x14db39==_0x25b073(0x259))initializeSocketBotManager(_0x3b680d);else initializeSocketBot(_0x3b680d);initClient(_0x14db39);}devices[_0xf062ce][_0x25b073(0x243)][_0x25b073(0x34d)]&&devices[_0xf062ce][_0x25b073(0x243)][_0x25b073(0x2a9)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x25b073(0x2c0),_0xf062ce),devices[_0xf062ce][_0x25b073(0x243)][_0x25b073(0x34d)]&&devices[_0xf062ce][_0x25b073(0x243)][_0x25b073(0x2a9)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout('login',_0xf062ce),_0x3b680d['emit'](_0x25b073(0x36f),{'status':_0x1875a1[_0x25b073(0x2d4)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xf062ce]['access'],'externalip':devices[_0xf062ce]['ip'],'publicKey':secure[_0x25b073(0x38f)],'userid':settings[_0x25b073(0x2d3)],'validInstallation':validInstallation}),devices[_0xf062ce][_0x25b073(0x243)]['allow']==![]&&devices[_0xf062ce][_0x25b073(0x243)]['reason']==_0x25b073(0x2f4)&&temporaryAccess2FA(_0xf062ce,devices[_0xf062ce]['ip']);}function setSessionTimeout(_0x4f0807,_0x11521d){const _0x1aed17=_0x163029;let _0x113693;if(_0x4f0807==_0x1aed17(0x20e))_0x113693=loginExpiry*0x3c*0x3e8;else _0x113693=devices[_0x11521d][_0x1aed17(0x2db)]['expiry']*0x3c*0x3e8-(new Date()[_0x1aed17(0x38d)]()-devices[_0x11521d][_0x1aed17(0x2db)][_0x1aed17(0x307)]);if(devices[_0x11521d][_0x1aed17(0x2bb)])clearTimeout(devices[_0x11521d][_0x1aed17(0x2bb)]);devices[_0x11521d][_0x1aed17(0x2bb)]=setTimeout(()=>{const _0x298438=_0x1aed17;if(devices[_0x11521d][_0x298438(0x1c0)])clearTimeout(devices[_0x11521d][_0x298438(0x1c0)]);removeSocketListeners(_0x11521d),addBlacklist(_0x11521d),devices[_0x11521d][_0x298438(0x2db)]=null,devices[_0x11521d]['telegram2FaApproval']=null,devices[_0x11521d]['access'][_0x298438(0x34d)]=null,logger['debug'](_0x298438(0x268)+_0x11521d['slice'](-0x8)),devices[_0x11521d][_0x298438(0x243)]=validateAccess(devices[_0x11521d][_0x298438(0x243)][_0x298438(0x34d)],_0x11521d),!(devices[_0x11521d]['access']['allow']&&devices[_0x11521d][_0x298438(0x243)][_0x298438(0x2a9)]==_0x298438(0x201))&&(_0x4f0807=='login'?io['to'](_0x11521d)['emit'](_0x298438(0x36f),{'access':{'allow':![],'reason':_0x298438(0x1d7),'token':null}}):io['to'](_0x11521d)[_0x298438(0x25c)](_0x298438(0x36f),{'access':{'allow':![],'reason':_0x298438(0x2b4),'token':null}})),devices[_0x11521d]['access'][_0x298438(0x34d)]=null;},_0x113693);}function setTokenRefresh(_0x48d2e9){const _0x3c64c6=_0x163029;if(devices[_0x48d2e9][_0x3c64c6(0x1c0)])clearTimeout(devices[_0x48d2e9]['pidRefreshToken']);devices[_0x48d2e9]['pidRefreshToken']=setTimeout(()=>{const _0xb82f14=_0x3c64c6;getClientsWithUuid(_0x48d2e9)[_0xb82f14(0x27b)]!=0x0?(devices[_0x48d2e9][_0xb82f14(0x243)]=refreshToken(_0x48d2e9),io['to'](_0x48d2e9)['emit'](_0xb82f14(0x36f),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x48d2e9][_0xb82f14(0x243)],'externalip':devices[_0x48d2e9]['ip'],'publicKey':secure[_0xb82f14(0x38f)],'validInstallation':validInstallation}),setTokenRefresh(_0x48d2e9)):clearTimeout(devices[_0x48d2e9][_0xb82f14(0x1c0)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5bcf75){const _0x5a1941=_0x163029,_0x575b6c=getClient(_0x5bcf75['id'])['uuid'];_0x5bcf75[_0x5a1941(0x25c)](_0x5a1941(0x1ff),config),_0x5bcf75[_0x5a1941(0x25c)](_0x5a1941(0x2c1),cleanSettings()),_0x5bcf75['on'](_0x5a1941(0x367),_0x412a11=>{const _0x1c92e6=_0x5a1941;if(validateAccess(_0x412a11,_0x575b6c)[_0x1c92e6(0x33c)])addBot();else logger['full'](_0x1c92e6(0x26d));}),_0x5bcf75['on'](_0x5a1941(0x1fa),(_0x962b4a,_0x3bf400)=>{const _0x4a4b39=_0x5a1941;if(validateAccess(_0x3bf400,_0x575b6c)[_0x4a4b39(0x33c)])toggleBot(_0x962b4a[_0x4a4b39(0x387)],_0x962b4a['status'],_0x962b4a[_0x4a4b39(0x36a)]);else logger[_0x4a4b39(0x312)](_0x4a4b39(0x2b0));}),_0x5bcf75['on'](_0x5a1941(0x1dc),(_0x200cb3,_0x32b2f9)=>{const _0x2ee95a=_0x5a1941;if(validateAccess(_0x32b2f9,_0x575b6c)['allow'])toggleBotMode(_0x200cb3);else logger['full'](_0x2ee95a(0x2b0));}),_0x5bcf75['on'](_0x5a1941(0x267),(_0x14960f,_0x10887c)=>{const _0x525502=_0x5a1941;if(validateAccess(_0x10887c,_0x575b6c)[_0x525502(0x33c)])deleteBot(_0x14960f);else logger[_0x525502(0x312)](_0x525502(0x2d9));}),_0x5bcf75['on']('store-settings',(_0x47b8a0,_0x5d767d)=>{const _0x39e67c=_0x5a1941;if(validateAccess(_0x5d767d,_0x575b6c)['allow'])storeSettings(_0x47b8a0,!![]);else logger[_0x39e67c(0x312)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x5bcf75['on']('update-bb',_0x1e9fcb=>{const _0x1afd46=_0x5a1941;if(validateAccess(_0x1e9fcb,_0x575b6c)[_0x1afd46(0x33c)])updateBB(_0x1afd46(0x376));else logger[_0x1afd46(0x312)](_0x1afd46(0x2a4));}),_0x5bcf75['on'](_0x5a1941(0x34b),_0x21ef5d=>{const _0x325780=_0x5a1941;if(validateAccess(_0x21ef5d,_0x575b6c)[_0x325780(0x33c)])updateBB(_0x325780(0x21c));else logger[_0x325780(0x312)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x5bcf75['on'](_0x5a1941(0x25f),_0x406a35=>{const _0x173b6e=_0x5a1941;if(validateAccess(_0x406a35,_0x575b6c)[_0x173b6e(0x33c)]){const _0x2fb89e=getClient(_0x5bcf75['id']);if(_0x2fb89e)getBackupFiles(_0x2fb89e[_0x173b6e(0x2b3)]);else logger[_0x173b6e(0x312)](_0x173b6e(0x34a));}else logger[_0x173b6e(0x312)](_0x173b6e(0x20f));}),_0x5bcf75['on'](_0x5a1941(0x32e),(_0x2c5da1,_0x29c8ec)=>{const _0xf8f304=_0x5a1941;if(validateAccess(_0x29c8ec,_0x575b6c)['allow'])restoreBackupFile(_0x2c5da1);else logger[_0xf8f304(0x312)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x5bcf75['on'](_0x5a1941(0x228),_0x237b6b=>{const _0x121896=_0x5a1941;if(validateAccess(_0x237b6b,_0x575b6c)[_0x121896(0x33c)])getMessages();else logger['full'](_0x121896(0x2e4));}),_0x5bcf75['on']('confirm-message',(_0x22a314,_0x5d69e8)=>{const _0x2e1044=_0x5a1941;if(validateAccess(_0x5d69e8,_0x575b6c)[_0x2e1044(0x33c)])confirmMessage(_0x22a314);else logger[_0x2e1044(0x312)](_0x2e1044(0x250));}),_0x5bcf75['on'](_0x5a1941(0x273),_0x4d66db=>{const _0x6d158f=_0x5a1941;if(validateAccess(_0x4d66db,_0x575b6c)[_0x6d158f(0x33c)]){if(devices[_0x575b6c][_0x6d158f(0x1c0)])clearTimeout(devices[_0x575b6c][_0x6d158f(0x1c0)]);if(devices[_0x575b6c][_0x6d158f(0x2bb)])clearTimeout(devices[_0x575b6c][_0x6d158f(0x2bb)]);removeSocketListeners(getClient(_0x5bcf75['id'])[_0x6d158f(0x2b3)]),addBlacklist(_0x575b6c),devices[_0x575b6c][_0x6d158f(0x2db)]=null,devices[_0x575b6c][_0x6d158f(0x1f5)]=null,devices[_0x575b6c][_0x6d158f(0x243)][_0x6d158f(0x34d)]=null,logger[_0x6d158f(0x364)](_0x6d158f(0x36b)+_0x575b6c[_0x6d158f(0x35c)](-0x8)),io['to'](getClient(_0x5bcf75['id'])['uuid'])['emit'](_0x6d158f(0x36f),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x6d158f(0x312)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x829abd){const _0x20bca0=_0x163029,_0x2ec4b2=getClient(_0x829abd['id'])[_0x20bca0(0x2e9)],_0x58a097=getClient(_0x829abd['id'])[_0x20bca0(0x2b3)];_0x829abd['on']('get-logs',(_0x381eee,_0x5c5cc2)=>{const _0x1c3142=_0x20bca0;if(validateAccess(_0x5c5cc2,_0x58a097)[_0x1c3142(0x33c)]){if(pid[_0x2ec4b2])pid[_0x2ec4b2][_0x1c3142(0x1e0)]({'function':_0x1c3142(0x353),'args':_0x381eee});}else logger[_0x1c3142(0x312)](_0x1c3142(0x211));}),_0x829abd['on'](_0x20bca0(0x2df),(_0x32c59f,_0x317245)=>{const _0x964fff=_0x20bca0;if(validateAccess(_0x317245,_0x58a097)[_0x964fff(0x33c)]){if(pid[_0x2ec4b2])pid[_0x2ec4b2][_0x964fff(0x1e0)]({'function':_0x964fff(0x2a6),'args':_0x32c59f});}else logger[_0x964fff(0x312)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x829abd['on'](_0x20bca0(0x29b),(_0x1c398d,_0x456e61)=>{const _0xda1e7a=_0x20bca0;if(validateAccess(_0x456e61,_0x58a097)[_0xda1e7a(0x33c)]){if(pid[_0x2ec4b2])pid[_0x2ec4b2][_0xda1e7a(0x1e0)]({'function':_0xda1e7a(0x2b6),'args':_0x1c398d});}else logger[_0xda1e7a(0x312)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x829abd['on'](_0x20bca0(0x35f),(_0x1616b1,_0x3e50cc)=>{const _0x34761a=_0x20bca0;if(validateAccess(_0x3e50cc,_0x58a097)[_0x34761a(0x33c)]){if(pid[_0x2ec4b2])pid[_0x2ec4b2]['send']({'function':_0x34761a(0x2ac),'args':_0x1616b1});}else logger[_0x34761a(0x312)](_0x34761a(0x200));}),_0x829abd['on'](_0x20bca0(0x389),(_0x3fea0b,_0x587508)=>{const _0x395cc1=_0x20bca0;if(validateAccess(_0x587508,_0x58a097)[_0x395cc1(0x33c)]){if(pid[_0x2ec4b2])pid[_0x2ec4b2][_0x395cc1(0x1e0)]({'function':_0x395cc1(0x315),'args':_0x3fea0b});}else logger[_0x395cc1(0x312)](_0x395cc1(0x2fc));}),_0x829abd['on'](_0x20bca0(0x2ab),(_0xb020b9,_0x5a2c64)=>{const _0x120c4c=_0x20bca0;if(validateAccess(_0x5a2c64,_0x58a097)[_0x120c4c(0x33c)]){if(pid[_0x2ec4b2])pid[_0x2ec4b2]['send']({'function':_0x120c4c(0x239),'args':_0xb020b9});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x829abd['on'](_0x20bca0(0x1c9),_0xd9eb5d=>{const _0x298ad7=_0x20bca0;if(validateAccess(_0xd9eb5d,_0x58a097)[_0x298ad7(0x33c)]){if(pid[_0x2ec4b2])pid[_0x2ec4b2][_0x298ad7(0x1e0)]({'function':_0x298ad7(0x21f),'args':null});}else logger[_0x298ad7(0x312)](_0x298ad7(0x379));}),_0x829abd['on'](_0x20bca0(0x33d),_0x22ce1a=>{const _0x4437fa=_0x20bca0;if(validateAccess(_0x22ce1a,_0x58a097)[_0x4437fa(0x33c)]){if(pid[_0x2ec4b2])pid[_0x2ec4b2]['send']({'function':_0x4437fa(0x341),'args':null});}else logger[_0x4437fa(0x312)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x829abd['on'](_0x20bca0(0x2ee),(_0x4112ba,_0x1cc7cc)=>{const _0x1a9ec2=_0x20bca0;if(validateAccess(_0x1cc7cc,_0x58a097)[_0x1a9ec2(0x33c)]){if(pid[_0x2ec4b2])pid[_0x2ec4b2]['send']({'function':_0x1a9ec2(0x206),'args':_0x4112ba});}else logger[_0x1a9ec2(0x312)](_0x1a9ec2(0x1bb));}),_0x829abd['on'](_0x20bca0(0x356),_0x151925=>{const _0x3e3001=_0x20bca0;if(validateAccess(_0x151925,_0x58a097)[_0x3e3001(0x33c)]){if(pid[_0x2ec4b2])pid[_0x2ec4b2][_0x3e3001(0x1e0)]({'function':_0x3e3001(0x28b),'args':null});}else logger[_0x3e3001(0x312)](_0x3e3001(0x344));}),_0x829abd['on'](_0x20bca0(0x23f),_0x21d997=>{const _0x57473f=_0x20bca0;if(validateAccess(_0x21d997,_0x58a097)['allow']){if(pid[_0x2ec4b2])pid[_0x2ec4b2][_0x57473f(0x1e0)]({'function':'showConfig','args':null});}else logger[_0x57473f(0x312)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x829abd['on'](_0x20bca0(0x1f2),_0x2449a7=>{const _0x31e8c8=_0x20bca0;if(validateAccess(_0x2449a7,_0x58a097)[_0x31e8c8(0x33c)])updateBB('update');else logger[_0x31e8c8(0x312)](_0x31e8c8(0x2a4));}),_0x829abd['on'](_0x20bca0(0x228),_0x5ebf1a=>{const _0x4a95ef=_0x20bca0;if(validateAccess(_0x5ebf1a,_0x58a097)[_0x4a95ef(0x33c)])getMessages();else logger[_0x4a95ef(0x312)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x829abd['on'](_0x20bca0(0x333),(_0x17370d,_0x6201a2)=>{const _0x17c2e7=_0x20bca0;if(validateAccess(_0x6201a2,_0x58a097)['allow'])confirmMessage(_0x17370d);else logger[_0x17c2e7(0x312)](_0x17c2e7(0x250));}),_0x829abd['on'](_0x20bca0(0x273),_0x1e10ce=>{const _0x2ec6e9=_0x20bca0;if(validateAccess(_0x1e10ce,_0x58a097)[_0x2ec6e9(0x33c)]){if(devices[_0x58a097][_0x2ec6e9(0x1c0)])clearTimeout(devices[_0x58a097][_0x2ec6e9(0x1c0)]);if(devices[_0x58a097]['pidExpireLogin'])clearTimeout(devices[_0x58a097][_0x2ec6e9(0x2bb)]);removeSocketListeners(getClient(_0x829abd['id'])[_0x2ec6e9(0x2b3)]),addBlacklist(_0x58a097),devices[_0x58a097][_0x2ec6e9(0x2db)]=null,devices[_0x58a097][_0x2ec6e9(0x1f5)]=null,devices[_0x58a097]['access'][_0x2ec6e9(0x34d)]=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x58a097[_0x2ec6e9(0x35c)](-0x8)),io['to'](getClient(_0x829abd['id'])['uuid'])[_0x2ec6e9(0x25c)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x2ec6e9(0x2a2));});}function removeSocketListeners(_0x3b79f8){const _0x1365c9=_0x163029;getClientsWithUuid(_0x3b79f8)[_0x1365c9(0x232)](_0x412cb2=>{getSocket(_0x412cb2['id'])['removeAllListeners']();});}function cleanSettings(){const _0x44aa32=_0x163029;let _0x595d46=settings;return settings['telegramToken']&&settings[_0x44aa32(0x358)]!=''&&(_0x595d46={..._0x595d46,'telegramToken':_0x44aa32(0x2f8)}),settings[_0x44aa32(0x29a)]&&settings[_0x44aa32(0x29a)]!=''&&(_0x595d46={..._0x595d46,'bbPassword':'************'}),(settings['bbPassword']&&settings[_0x44aa32(0x29a)]=='***'||settings[_0x44aa32(0x358)]&&settings['telegramToken']==_0x44aa32(0x3ad))&&(_0x595d46={..._0x595d46,'restored':{'password':settings['bbPassword']=='***','telegram':settings[_0x44aa32(0x358)]==_0x44aa32(0x3ad)}}),_0x595d46;}async function updateBB(_0x80369b){const _0x530918=_0x163029;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x3c4672=>{const _0x4b209c=_0x4908;restartBot(_0x3c4672[_0x4b209c(0x387)]);});if(_0x80369b==_0x530918(0x376))process[_0x530918(0x1e0)]({'update':!![],'environment':environment},_0x40950c=>{});else _0x80369b==_0x530918(0x21c)&&process[_0x530918(0x1e0)]({'reinstall':!![],'environment':environment},_0x304ef=>{});}function startBot(_0x2f797a,_0x2e7ed6,_0x39496a){const _0x110e27=_0x163029;if(debugging)_0x2f797a[_0x110e27(0x299)]('-d');let _0x57317d=![];const _0xcd50ba=_0x2f797a[0x0];_0x2e7ed6={..._0x2e7ed6,'stdio':['inherit','inherit',_0x110e27(0x2eb),_0x110e27(0x2a8)]},pid[_0xcd50ba]=childProcess[_0x110e27(0x2f6)](botfile,_0x2f797a,_0x2e7ed6),pid[_0xcd50ba]['on']('message',_0x49a56a=>{const _0x2fd51e=_0x110e27;switch(Object['keys'](_0x49a56a)[0x0]){case _0x2fd51e(0x248):updateBotName(_0xcd50ba,_0x49a56a[_0x2fd51e(0x248)]);break;case _0x2fd51e(0x1be):updateBotManager();break;case _0x2fd51e(0x36f):updateStatus(_0xcd50ba,_0x49a56a[_0x2fd51e(0x36f)]);break;case _0x2fd51e(0x36a):updateLive(_0xcd50ba,_0x49a56a[_0x2fd51e(0x36a)]);break;case _0x2fd51e(0x31c):updateLive(_0xcd50ba,_0x49a56a[_0x2fd51e(0x31c)]),io['to'](_0xcd50ba)['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case'stop':_0x49a56a[_0x2fd51e(0x1cc)]==_0x2fd51e(0x235)&&restartBot(_0xcd50ba);_0x49a56a[_0x2fd51e(0x1cc)]==_0x2fd51e(0x390)&&toggleBot(_0xcd50ba,_0x2fd51e(0x340),_0x2fd51e(0x1c3));break;case'telegram':sendTelegramBot(_0xcd50ba,_0x49a56a[_0x2fd51e(0x225)]);break;case _0x2fd51e(0x2f5):sendTelegramMsg(_0x49a56a[_0x2fd51e(0x2f5)]);break;case'function':io['to'](_0xcd50ba)[_0x2fd51e(0x25c)](_0x49a56a[_0x2fd51e(0x37f)],_0x49a56a[_0x2fd51e(0x210)]);break;}}),pid[_0xcd50ba]['on']('error',function(_0x46021b){if(_0x57317d)return;_0x57317d=!![],_0x39496a(_0x46021b);}),pid[_0xcd50ba]['on'](_0x110e27(0x394),async function(_0x975e09){const _0x44622e=_0x110e27;if(installingUpdate){logger[_0x44622e(0x364)](_0x44622e(0x3ac)),io[_0x44622e(0x1ee)]();return;}if(_0x57317d)return;_0x57317d=!![],_0x39496a(null);const _0x1de9e7=dbConfig['get'](_0x44622e(0x1ff))[_0x44622e(0x323)]({'botID':_0xcd50ba})[_0x44622e(0x2b1)]();_0x1de9e7&&(_0x1de9e7[_0x44622e(0x36f)]==_0x44622e(0x332)||_0x1de9e7[_0x44622e(0x36f)]==_0x44622e(0x32b))&&(await sleep(0x3e8),updateLive(_0xcd50ba,'stopped'),logger[_0x44622e(0x312)]('Restarting\x20Bot\x20'+_0xcd50ba),startBot([_0xcd50ba,userID],{'cwd':bbpath},function(_0x5f26d7){const _0x2bf424=_0x44622e;if(_0x5f26d7)logger[_0x2bf424(0x312)](_0x5f26d7);}));});}function stopBot(_0x42b135){const _0x2f347b=_0x163029;getClientsWithBotID(_0x42b135)[_0x2f347b(0x232)](_0x13d1b8=>{const _0x1645a7=_0x2f347b;getSocket(_0x13d1b8['id'])[_0x1645a7(0x377)](!![]),removeClient(_0x13d1b8['id']);}),pid[_0x42b135]&&(pid[_0x42b135]['kill'](),pid[_0x42b135]=null);}function restartBot(_0x19bab1){if(pid[_0x19bab1])pid[_0x19bab1]['kill']();}function addBot(){const _0x4a2fdb=_0x163029;let _0x2c2117;for(let _0x328ec8=0x1;_0x328ec8<0x3e9;_0x328ec8++){_0x2c2117=_0x328ec8[_0x4a2fdb(0x2ad)]()[_0x4a2fdb(0x24f)](0x3,'0');let _0x1a3cf2=config[_0x4a2fdb(0x323)](_0x2c6adc=>_0x2c6adc[_0x4a2fdb(0x387)]==_0x2c2117);if(!_0x1a3cf2)break;}if(_0x2c2117===_0x4a2fdb(0x361)){logger['full'](_0x4a2fdb(0x258));return;}logger['full'](_0x4a2fdb(0x33f)+_0x2c2117),dbConfig[_0x4a2fdb(0x33a)](_0x4a2fdb(0x1ff))['push']({'botID':_0x2c2117,'botname':_0x4a2fdb(0x1bf)+_0x2c2117,'status':'new','live':''})[_0x4a2fdb(0x1f9)](),startBot([_0x2c2117,userID],{'cwd':bbpath},function(_0x12603d){if(_0x12603d)logger['full'](_0x12603d);}),config=getConfiguration(),io['to']('botmanager')[_0x4a2fdb(0x25c)]('bots',config),broadcastToBots(_0x4a2fdb(0x1ff),JSON[_0x4a2fdb(0x1c5)](config));}function deleteBot(_0x454a83){const _0x2ee9ee=_0x163029;getClientsWithBotID(_0x454a83)[_0x2ee9ee(0x232)](_0x3ca6e0=>{const _0x3f303a=_0x2ee9ee;getSocket(_0x3ca6e0['id'])[_0x3f303a(0x377)](!![]),removeClient(_0x3ca6e0['id']);}),dbConfig[_0x2ee9ee(0x33a)](_0x2ee9ee(0x1ff))[_0x2ee9ee(0x32c)]({'botID':_0x454a83})[_0x2ee9ee(0x1f9)](),logger[_0x2ee9ee(0x312)](_0x2ee9ee(0x2ec)+_0x454a83),stopBot(_0x454a83);try{if(fs[_0x2ee9ee(0x2c6)](path['join'](configpath,_0x2ee9ee(0x1e8)+_0x454a83+'-config.json')))fs['unlinkSync'](path[_0x2ee9ee(0x31d)](configpath,_0x2ee9ee(0x1e8)+_0x454a83+_0x2ee9ee(0x1d0)));if(fs[_0x2ee9ee(0x2c6)](path[_0x2ee9ee(0x31d)](configpath,_0x2ee9ee(0x1e8)+_0x454a83+_0x2ee9ee(0x375))))fs[_0x2ee9ee(0x233)](path[_0x2ee9ee(0x31d)](configpath,_0x2ee9ee(0x1e8)+_0x454a83+_0x2ee9ee(0x375)));if(fs[_0x2ee9ee(0x2c6)](path[_0x2ee9ee(0x31d)](configpath,_0x2ee9ee(0x1e8)+_0x454a83+_0x2ee9ee(0x300))))fs[_0x2ee9ee(0x233)](path[_0x2ee9ee(0x31d)](configpath,_0x2ee9ee(0x1e8)+_0x454a83+_0x2ee9ee(0x300)));if(fs[_0x2ee9ee(0x2c6)](path[_0x2ee9ee(0x31d)](configpath,_0x2ee9ee(0x1e8)+_0x454a83+_0x2ee9ee(0x28e))))fs[_0x2ee9ee(0x233)](path[_0x2ee9ee(0x31d)](configpath,_0x2ee9ee(0x1e8)+_0x454a83+_0x2ee9ee(0x28e)));}catch(_0x225fba){if(_0x225fba)logger['full'](_0x2ee9ee(0x246),_0x225fba);}config=getConfiguration(),io['to'](_0x2ee9ee(0x259))[_0x2ee9ee(0x25c)](_0x2ee9ee(0x1ff),config),broadcastToBots(_0x2ee9ee(0x1ff),JSON[_0x2ee9ee(0x1c5)](config));}function toggleBot(_0x258bb7,_0x2dbfe2,_0x56d40c){const _0x2a2582=_0x163029;dbConfig[_0x2a2582(0x33a)](_0x2a2582(0x1ff))[_0x2a2582(0x323)]({'botID':_0x258bb7})['assign']({'status':_0x2dbfe2})[_0x2a2582(0x38c)]({'live':_0x56d40c})[_0x2a2582(0x1f9)]();if(_0x2dbfe2==_0x2a2582(0x332)||_0x2dbfe2==_0x2a2582(0x32b))logger[_0x2a2582(0x312)](_0x2a2582(0x38a)+_0x258bb7),startBot([_0x258bb7,userID],{'cwd':bbpath},function(_0x1f981b){const _0x422f5d=_0x2a2582;if(_0x1f981b)logger[_0x422f5d(0x312)](_0x1f981b);});else(_0x2dbfe2==_0x2a2582(0x340)||_0x2dbfe2==_0x2a2582(0x269))&&(logger[_0x2a2582(0x312)](_0x2a2582(0x3a7)+_0x258bb7),stopBot(_0x258bb7));config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots(_0x2a2582(0x1ff),JSON[_0x2a2582(0x1c5)](config));}function toggleStatus(_0x55781d){const _0x442edc=_0x163029;let _0x216a54=dbConfig['get'](_0x442edc(0x1ff))['find']({'botID':_0x55781d})['value'](),_0x5751de;if(_0x216a54[_0x442edc(0x36f)]==='enabled')_0x5751de=_0x442edc(0x340);else{if(_0x216a54[_0x442edc(0x36f)]==='new')_0x5751de=_0x442edc(0x269);else{if(_0x216a54[_0x442edc(0x36f)]===_0x442edc(0x269))_0x5751de=_0x442edc(0x32b);else{if(_0x216a54[_0x442edc(0x36f)]===_0x442edc(0x340))_0x5751de=_0x442edc(0x332);}}}return _0x5751de;}function updateStatus(_0x5e3d3f,_0x34cf6b){const _0x58c147=_0x163029;dbConfig['get'](_0x58c147(0x1ff))[_0x58c147(0x323)]({'botID':_0x5e3d3f})['assign']({'status':_0x34cf6b})['write'](),config=getConfiguration(),io['to'](_0x58c147(0x259))[_0x58c147(0x25c)](_0x58c147(0x1ff),config),broadcastToBots(_0x58c147(0x1ff),JSON[_0x58c147(0x1c5)](config));}function updateLive(_0x3ca078,_0xf82bb1){const _0x5e7f56=_0x163029;dbConfig[_0x5e7f56(0x33a)]('bots')[_0x5e7f56(0x323)]({'botID':_0x3ca078})[_0x5e7f56(0x38c)]({'live':_0xf82bb1})['write'](),config=getConfiguration(),io['to'](_0x5e7f56(0x259))['emit'](_0x5e7f56(0x1ff),config),broadcastToBots(_0x5e7f56(0x1ff),JSON[_0x5e7f56(0x1c5)](config));}function updateBotName(_0x3ffab0,_0x3fb0c0){const _0x1311e7=_0x163029;dbConfig[_0x1311e7(0x33a)](_0x1311e7(0x1ff))[_0x1311e7(0x323)]({'botID':_0x3ffab0})[_0x1311e7(0x38c)]({'botname':_0x3fb0c0})[_0x1311e7(0x1f9)](),config=getConfiguration(),io['to'](_0x1311e7(0x259))[_0x1311e7(0x25c)](_0x1311e7(0x1ff),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0x130aad=_0x163029;config=getConfiguration(),io['to']('botmanager')[_0x130aad(0x25c)](_0x130aad(0x1ff),config),broadcastToBots(_0x130aad(0x1ff),JSON[_0x130aad(0x1c5)](config));}function toggleBotMode(_0x523c75){const _0x385189=_0x163029;if(pid[_0x523c75])pid[_0x523c75][_0x385189(0x1e0)]({'function':'toggleBotMode','args':null});else{const _0x1db953=configpath+_0x385189(0x1e8)+_0x523c75+_0x385189(0x1d0),_0x2c3d6f=fs[_0x385189(0x2a7)](_0x1db953),_0x540845=JSON['parse'](_0x2c3d6f),_0x5b4dab=_0x540845[_0x385189(0x2e9)][0x0][_0x385189(0x326)];_0x540845[_0x385189(0x2e9)][0x0][_0x385189(0x326)]=!_0x5b4dab;const _0x142407=JSON[_0x385189(0x1c5)](_0x540845,null,0x2);fs[_0x385189(0x30d)](_0x1db953,_0x142407),config=getConfiguration(),io['to'](_0x385189(0x259))[_0x385189(0x25c)](_0x385189(0x1ff),config),broadcastToBots(_0x385189(0x1ff),JSON['stringify'](config));}}function validateTelegram(_0x5ed88d){const _0x2cc985=_0x163029;if(_0x5ed88d[_0x2cc985(0x289)][_0x2cc985(0x244)]!=settings['telegramUsername']&&'@'+_0x5ed88d[_0x2cc985(0x289)][_0x2cc985(0x244)]!=settings[_0x2cc985(0x1c2)]||_0x5ed88d[_0x2cc985(0x334)]['id']!=settings[_0x2cc985(0x1c8)])return sendTelegram(_0x5ed88d['chat']['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x2cc985(0x1ec)}),![];return!![];}async function initTelegram(){const _0x44d5dd=_0x163029;if(tgBot)tgBot[_0x44d5dd(0x1cc)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x44d5dd(0x358)]);let _0x1fc557=_0x44d5dd(0x1e6);_0x1fc557+='\x0a',_0x1fc557+=_0x44d5dd(0x234),_0x1fc557+='/disable\x20-\x20disable\x20notifications\x0a',_0x1fc557+=_0x44d5dd(0x1f8),_0x1fc557+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x1fc557+=_0x44d5dd(0x365),_0x1fc557+=_0x44d5dd(0x27f),_0x1fc557+=_0x44d5dd(0x360),_0x1fc557+='/names\x20-\x20show\x20bot\x20names\x0a',_0x1fc557+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x1fc557+=_0x44d5dd(0x327),_0x1fc557+=_0x44d5dd(0x2d1),_0x1fc557+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x1fc557+=_0x44d5dd(0x25d),_0x1fc557+=_0x44d5dd(0x370);let _0x2a6dc4=_0x44d5dd(0x27e);_0x2a6dc4+='\x0a',_0x2a6dc4+=_0x1fc557,tgBot[_0x44d5dd(0x309)]((_0x1ea101,_0x3ffc0e)=>{const _0x4a7cd3=_0x44d5dd;logger[_0x4a7cd3(0x38b)](getTimeStamp()+_0x4a7cd3(0x37b)),logger[_0x4a7cd3(0x364)](_0x4a7cd3(0x2ce),_0x1ea101);}),tgBot[_0x44d5dd(0x23b)](async(_0x5a0fb0,_0x5defda)=>{const _0x2c4756=_0x44d5dd;if(!(!settings[_0x2c4756(0x1c8)]&&_0x5a0fb0[_0x2c4756(0x376)][_0x2c4756(0x216)][_0x2c4756(0x254)]==_0x2c4756(0x30c))){if(!validateTelegram(_0x5a0fb0))return;}_0x5defda();}),tgBot[_0x44d5dd(0x263)]('start',async _0x5e2738=>{const _0x73c6fd=_0x44d5dd;if(!settings[_0x73c6fd(0x1c8)])updateSetting(_0x73c6fd(0x1c8),_0x5e2738[_0x73c6fd(0x334)]['id']);updateSetting(_0x73c6fd(0x351),!![]);if(!validateTelegram(_0x5e2738))return;sendTelegram(_0x5e2738[_0x73c6fd(0x334)]['id'],_0x2a6dc4);}),tgBot[_0x44d5dd(0x263)](_0x44d5dd(0x34e),async _0x129253=>{const _0x144314=_0x44d5dd;updateSetting('telegramEnabled',!![]),sendTelegram(_0x129253['chat']['id'],_0x144314(0x372));}),tgBot[_0x44d5dd(0x263)](_0x44d5dd(0x261),async _0x39f719=>{const _0x132d69=_0x44d5dd;sendTelegram(_0x39f719[_0x132d69(0x334)]['id'],'Notifications\x20disabled'),updateSetting('telegramEnabled',![]);}),tgBot[_0x44d5dd(0x263)](_0x44d5dd(0x257),async _0x355312=>{const _0x5dc8b6=_0x44d5dd,_0xeaf647=Markup[_0x5dc8b6(0x3b0)]([Markup[_0x5dc8b6(0x256)][_0x5dc8b6(0x21e)]('Orders',_0x5dc8b6(0x28f)),Markup['button'][_0x5dc8b6(0x21e)]('Alerts',_0x5dc8b6(0x2f1)),Markup[_0x5dc8b6(0x256)][_0x5dc8b6(0x21e)](_0x5dc8b6(0x33b),_0x5dc8b6(0x3a0))]);_0x355312[_0x5dc8b6(0x1f6)](_0x5dc8b6(0x3b2),_0xeaf647);}),tgBot['action'](_0x44d5dd(0x28f),async _0x496b0e=>{const _0x142c0e=_0x44d5dd;_0x496b0e[_0x142c0e(0x22d)](),updateSetting('telegramEvents',_0x142c0e(0x1fc)),updateSetting(_0x142c0e(0x351),!![]),await sendTelegram(_0x496b0e[_0x142c0e(0x334)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0x44d5dd(0x343)](_0x44d5dd(0x2f1),async _0x32afb7=>{const _0x3e5a57=_0x44d5dd;_0x32afb7[_0x3e5a57(0x22d)](),updateSetting(_0x3e5a57(0x36e),_0x3e5a57(0x2ae)),updateSetting(_0x3e5a57(0x351),!![]),await sendTelegram(_0x32afb7[_0x3e5a57(0x334)]['id'],_0x3e5a57(0x383));}),tgBot[_0x44d5dd(0x343)]('config_all',async _0x385b9e=>{const _0x37b181=_0x44d5dd;_0x385b9e[_0x37b181(0x22d)](),updateSetting(_0x37b181(0x36e),_0x37b181(0x286)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x385b9e['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x44d5dd(0x263)](_0x44d5dd(0x36f),async _0x446758=>{const _0x88228d=_0x44d5dd,_0x1d89be=getBotsWithMode();let _0x49b52a='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x88228d(0x232)](_0x105ffa=>{const _0x2a639c=_0x88228d,_0xf9cee6=_0x1d89be[_0x2a639c(0x323)](_0xfa6e8b=>_0xfa6e8b[_0x2a639c(0x387)]==_0x105ffa[_0x2a639c(0x387)])['mode'];_0x49b52a+=_0x2a639c(0x1bf)+_0x105ffa[_0x2a639c(0x387)]+':\x20'+_0x105ffa[_0x2a639c(0x36f)]+_0x2a639c(0x302)+_0xf9cee6+'\x20|\x20'+_0x105ffa[_0x2a639c(0x36a)]+'\x0a';}),_0x49b52a+='\x0a',_0x49b52a+=_0x88228d(0x314),_0x49b52a+=!settings['telegramEnabled']?_0x88228d(0x1c1):_0x88228d(0x31e),_0x49b52a+=settings[_0x88228d(0x351)]?settings[_0x88228d(0x36e)]==_0x88228d(0x286)?_0x88228d(0x277):_0x88228d(0x39d)+settings[_0x88228d(0x36e)]+_0x88228d(0x2a5):'',sendTelegram(_0x446758[_0x88228d(0x334)]['id'],_0x49b52a,{'parse_mode':_0x88228d(0x1ec)});}),tgBot[_0x44d5dd(0x263)]('restart',async _0x15531b=>{const _0x27a9c3=_0x44d5dd,_0x410138=getEnabledBots();if(_0x410138[_0x27a9c3(0x27b)]==0x0)sendTelegram(_0x15531b[_0x27a9c3(0x334)]['id'],_0x27a9c3(0x378));else{if(_0x410138[_0x27a9c3(0x27b)]>0x1)_0x410138[_0x27a9c3(0x299)]({'botID':_0x27a9c3(0x286)});let _0x5b1d5e=[],_0x187171=[];const _0x9e3b57=_0x410138[_0x27a9c3(0x27b)]%0x4==0x0||_0x410138[_0x27a9c3(0x27b)]%0x4==0x3||_0x410138[_0x27a9c3(0x27b)]%0x3==0x1?0x4:0x3;let _0x14f534=0x0;_0x410138['forEach']((_0x3a7150,_0x2d82a7)=>{const _0xf1bf5c=_0x27a9c3;if(_0x2d82a7%_0x9e3b57==0x0)_0x187171=[];_0x187171['push'](Markup[_0xf1bf5c(0x256)]['callback'](_0x3a7150[_0xf1bf5c(0x387)]=='all'?'All\x20bots':_0xf1bf5c(0x1bf)+_0x3a7150[_0xf1bf5c(0x387)],'restart_'+_0x3a7150['botID'])),_0x2d82a7%_0x9e3b57==0x0&&(_0x5b1d5e[_0x14f534]=_0x187171,_0x14f534++);});const _0x5429a4=Markup['inlineKeyboard'](_0x5b1d5e);_0x15531b['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x5429a4);}}),tgBot[_0x44d5dd(0x343)](/restart_(.+)/,async _0x4d5229=>{const _0x504f70=_0x44d5dd,_0x20ef27=_0x4d5229[_0x504f70(0x22e)][0x1];_0x4d5229[_0x504f70(0x22d)](),_0x20ef27=='all'?config[_0x504f70(0x232)](_0x3ae31f=>{const _0x55aaac=_0x504f70;restartBot(_0x3ae31f[_0x55aaac(0x387)]);}):restartBot(_0x20ef27);}),tgBot[_0x44d5dd(0x263)]('on',async _0x25f8c5=>{const _0x252d4b=_0x44d5dd,_0x41a9bd=getDisabledBots();if(_0x41a9bd['length']==0x0)sendTelegram(_0x25f8c5['chat']['id'],_0x252d4b(0x2fe));else{if(_0x41a9bd[_0x252d4b(0x27b)]>0x1)_0x41a9bd['push']({'botID':_0x252d4b(0x286)});let _0x3caefc=[],_0x5193f0=[];const _0x4fa91c=_0x41a9bd[_0x252d4b(0x27b)]%0x4==0x0||_0x41a9bd['length']%0x4==0x3||_0x41a9bd[_0x252d4b(0x27b)]%0x3==0x1?0x4:0x3;let _0x1e7863=0x0;_0x41a9bd[_0x252d4b(0x232)]((_0x45f6cc,_0x63a1d5)=>{const _0x55a166=_0x252d4b;if(_0x63a1d5%_0x4fa91c==0x0)_0x5193f0=[];_0x5193f0[_0x55a166(0x299)](Markup[_0x55a166(0x256)][_0x55a166(0x21e)](_0x45f6cc['botID']==_0x55a166(0x286)?'All\x20bots':_0x55a166(0x1bf)+_0x45f6cc[_0x55a166(0x387)],'on_'+_0x45f6cc[_0x55a166(0x387)])),_0x63a1d5%_0x4fa91c==0x0&&(_0x3caefc[_0x1e7863]=_0x5193f0,_0x1e7863++);});const _0x876204=Markup[_0x252d4b(0x3b0)](_0x3caefc);_0x25f8c5['reply'](_0x252d4b(0x236),_0x876204);}}),tgBot[_0x44d5dd(0x343)](/on_(.+)/,async _0x55bbd5=>{const _0x397fa9=_0x44d5dd,_0x4613f8=_0x55bbd5[_0x397fa9(0x22e)][0x1];_0x55bbd5[_0x397fa9(0x22d)]();if(_0x4613f8==_0x397fa9(0x286)){const _0x27f16a=getDisabledBots();sendTelegram(_0x55bbd5[_0x397fa9(0x334)]['id'],_0x397fa9(0x252)),_0x27f16a['forEach'](_0x2c6f35=>{const _0x188781=_0x397fa9;if(_0x2c6f35['botID']!=_0x188781(0x286))toggleBot(_0x2c6f35[_0x188781(0x387)],toggleStatus(_0x2c6f35[_0x188781(0x387)]),_0x188781(0x1c3));});}else sendTelegram(_0x55bbd5['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x4613f8),toggleBot(_0x4613f8,toggleStatus(_0x4613f8),_0x397fa9(0x1c3));}),tgBot[_0x44d5dd(0x263)](_0x44d5dd(0x295),async _0x3b1807=>{const _0x31cccd=_0x44d5dd,_0x574065=getEnabledBots();if(_0x574065['length']==0x0)sendTelegram(_0x3b1807[_0x31cccd(0x334)]['id'],_0x31cccd(0x378));else{if(_0x574065[_0x31cccd(0x27b)]>0x1)_0x574065[_0x31cccd(0x299)]({'botID':_0x31cccd(0x286)});let _0x217992=[],_0x3fc131=[];const _0x3058c2=_0x574065['length']%0x4==0x0||_0x574065[_0x31cccd(0x27b)]%0x4==0x3||_0x574065[_0x31cccd(0x27b)]%0x3==0x1?0x4:0x3;let _0x1315cd=0x0;_0x574065[_0x31cccd(0x232)]((_0x1a3b86,_0x23e3aa)=>{const _0x2e8108=_0x31cccd;if(_0x23e3aa%_0x3058c2==0x0)_0x3fc131=[];_0x3fc131[_0x2e8108(0x299)](Markup[_0x2e8108(0x256)][_0x2e8108(0x21e)](_0x1a3b86[_0x2e8108(0x387)]==_0x2e8108(0x286)?_0x2e8108(0x2dc):'Bot\x20'+_0x1a3b86[_0x2e8108(0x387)],'off_'+_0x1a3b86['botID'])),_0x23e3aa%_0x3058c2==0x0&&(_0x217992[_0x1315cd]=_0x3fc131,_0x1315cd++);});const _0x1b99b8=Markup[_0x31cccd(0x3b0)](_0x217992);_0x3b1807[_0x31cccd(0x1f6)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x1b99b8);}}),tgBot[_0x44d5dd(0x343)](/off_(.+)/,async _0x41fb6e=>{const _0x21ab08=_0x44d5dd,_0x5346af=_0x41fb6e['match'][0x1];_0x41fb6e[_0x21ab08(0x22d)]();if(_0x5346af==_0x21ab08(0x286)){const _0x3a2161=getEnabledBots();sendTelegram(_0x41fb6e[_0x21ab08(0x334)]['id'],_0x21ab08(0x253)),_0x3a2161['forEach'](_0x16c914=>{const _0x4baec8=_0x21ab08;if(_0x16c914[_0x4baec8(0x387)]!='all')toggleBot(_0x16c914[_0x4baec8(0x387)],toggleStatus(_0x16c914['botID']),_0x4baec8(0x1c3));});}else sendTelegram(_0x41fb6e['chat']['id'],_0x21ab08(0x1dd)+_0x5346af),toggleBot(_0x5346af,toggleStatus(_0x5346af),_0x21ab08(0x1c3));}),tgBot['command'](_0x44d5dd(0x218),async _0x40078d=>{const _0x472239=_0x44d5dd,_0x5b890d=getEnabledBots();if(_0x5b890d[_0x472239(0x27b)]==0x0)sendTelegram(_0x40078d[_0x472239(0x334)]['id'],_0x472239(0x378));else{if(_0x5b890d[_0x472239(0x27b)]>0x1){let _0x19c435=[],_0x3a1492=[];const _0x1c397a=_0x5b890d[_0x472239(0x27b)]%0x4==0x0||_0x5b890d[_0x472239(0x27b)]%0x4==0x3||_0x5b890d['length']%0x3==0x1?0x4:0x3;let _0x26f012=0x0;_0x5b890d['forEach']((_0x9b0cd,_0x4dd0bb)=>{const _0x1ddf7f=_0x472239;if(_0x4dd0bb%_0x1c397a==0x0)_0x3a1492=[];_0x3a1492[_0x1ddf7f(0x299)](Markup['button']['callback'](_0x1ddf7f(0x1bf)+_0x9b0cd[_0x1ddf7f(0x387)],_0x1ddf7f(0x1cb)+_0x9b0cd['botID'])),_0x4dd0bb%_0x1c397a==0x0&&(_0x19c435[_0x26f012]=_0x3a1492,_0x26f012++);});const _0x2be867=Markup[_0x472239(0x3b0)](_0x19c435);_0x40078d[_0x472239(0x1f6)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x2be867);}else{const _0x380149=_0x5b890d[0x0]['botID'];if(pid[_0x380149])pid[_0x380149][_0x472239(0x1e0)]({'function':_0x472239(0x3af),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x5477ae=>{const _0x589ea5=_0x44d5dd,_0x1ccd6a=_0x5477ae[_0x589ea5(0x22e)][0x1];_0x5477ae[_0x589ea5(0x22d)]();if(pid[_0x1ccd6a])pid[_0x1ccd6a][_0x589ea5(0x1e0)]({'function':_0x589ea5(0x3af),'args':null});}),tgBot[_0x44d5dd(0x263)]('portfolio',async _0x2ad75b=>{const _0x22d4bb=_0x44d5dd,_0x36e11c=getEnabledBots();if(_0x36e11c[_0x22d4bb(0x27b)]==0x0)sendTelegram(_0x2ad75b[_0x22d4bb(0x334)]['id'],_0x22d4bb(0x378));else{if(_0x36e11c[_0x22d4bb(0x27b)]>0x1){let _0x33cd39=[],_0x24578d=[];const _0x3dad88=_0x36e11c[_0x22d4bb(0x27b)]%0x4==0x0||_0x36e11c[_0x22d4bb(0x27b)]%0x4==0x3||_0x36e11c['length']%0x3==0x1?0x4:0x3;let _0x4f2e20=0x0;_0x36e11c[_0x22d4bb(0x232)]((_0x1f7fb7,_0x190b69)=>{const _0x41baae=_0x22d4bb;if(_0x190b69%_0x3dad88==0x0)_0x24578d=[];_0x24578d['push'](Markup[_0x41baae(0x256)][_0x41baae(0x21e)](_0x41baae(0x1bf)+_0x1f7fb7[_0x41baae(0x387)],_0x41baae(0x359)+_0x1f7fb7[_0x41baae(0x387)])),_0x190b69%_0x3dad88==0x0&&(_0x33cd39[_0x4f2e20]=_0x24578d,_0x4f2e20++);});const _0x5c8495=Markup[_0x22d4bb(0x3b0)](_0x33cd39);_0x2ad75b[_0x22d4bb(0x1f6)](_0x22d4bb(0x2da),_0x5c8495);}else{const _0xfcc1cf=_0x36e11c[0x0][_0x22d4bb(0x387)];if(pid[_0xfcc1cf])pid[_0xfcc1cf][_0x22d4bb(0x1e0)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x44d5dd(0x343)](/portfolio_(.+)/,async _0x2f8ed9=>{const _0x48e1e5=_0x44d5dd,_0x3f83f8=_0x2f8ed9['match'][0x1];_0x2f8ed9[_0x48e1e5(0x22d)]();if(pid[_0x3f83f8])pid[_0x3f83f8][_0x48e1e5(0x1e0)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x44d5dd(0x263)](_0x44d5dd(0x376),async _0x15238e=>{const _0x1721e8=_0x44d5dd;await getMessages();if(!updateAvailable)sendTelegram(_0x15238e[_0x1721e8(0x334)]['id'],_0x1721e8(0x1f4));else{if(!validInstallation)sendTelegram(_0x15238e['chat']['id'],_0x1721e8(0x385));else{const _0x3159b1=Markup[_0x1721e8(0x3b0)]([Markup[_0x1721e8(0x256)]['callback'](_0x1721e8(0x1ed),_0x1721e8(0x1ba)),Markup[_0x1721e8(0x256)][_0x1721e8(0x21e)]('No',_0x1721e8(0x2ca))]);_0x15238e['reply'](_0x1721e8(0x2ed),_0x3159b1);}}}),tgBot[_0x44d5dd(0x343)](/update_(.+)/,async _0x15981a=>{const _0x2f864f=_0x44d5dd,_0x52546e=_0x15981a['match'][0x1];_0x15981a['editMessageReplyMarkup'](),_0x52546e==_0x2f864f(0x34f)&&(await sendTelegram(_0x15981a[_0x2f864f(0x334)]['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB(_0x2f864f(0x376))),_0x52546e=='no'&&await sendTelegram(_0x15981a[_0x2f864f(0x334)]['id'],_0x2f864f(0x2bd));}),tgBot['command'](_0x44d5dd(0x21c),async _0x29f0f6=>{const _0x40880e=_0x44d5dd;if(!validInstallation)sendTelegram(_0x29f0f6[_0x40880e(0x334)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x2cf30b=Markup['inlineKeyboard']([Markup[_0x40880e(0x256)][_0x40880e(0x21e)](_0x40880e(0x1ed),_0x40880e(0x330)),Markup[_0x40880e(0x256)][_0x40880e(0x21e)]('No','reinstall_no')]);_0x29f0f6['reply'](_0x40880e(0x1ca),_0x2cf30b);}}),tgBot[_0x44d5dd(0x343)](/reinstall_(.+)/,async _0x2d4ad1=>{const _0x395a4b=_0x44d5dd,_0x513cf9=_0x2d4ad1[_0x395a4b(0x22e)][0x1];_0x2d4ad1[_0x395a4b(0x22d)](),_0x513cf9==_0x395a4b(0x34f)&&(await sendTelegram(_0x2d4ad1[_0x395a4b(0x334)]['id'],_0x395a4b(0x264)),updateBB(_0x395a4b(0x21c))),_0x513cf9=='no'&&await sendTelegram(_0x2d4ad1[_0x395a4b(0x334)]['id'],_0x395a4b(0x2de));}),tgBot[_0x44d5dd(0x263)](_0x44d5dd(0x1f3),async _0xbee66b=>{const _0x48e89e=_0x44d5dd,_0x441b69=getBotsWithMode();if(_0x441b69[_0x48e89e(0x27b)]==0x0)sendTelegram(_0xbee66b[_0x48e89e(0x334)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x1cb004=[],_0x2efd64=[];const _0x35fc34=0x2;let _0x3b5559=0x0;_0x441b69[_0x48e89e(0x232)]((_0x504b3d,_0x21a213)=>{const _0x4a1587=_0x48e89e;if(_0x21a213%_0x35fc34==0x0)_0x2efd64=[];_0x2efd64[_0x4a1587(0x299)](Markup[_0x4a1587(0x256)][_0x4a1587(0x21e)](_0x4a1587(0x1bf)+_0x504b3d['botID']+'\x20('+_0x504b3d[_0x4a1587(0x1e5)]+')',_0x4a1587(0x329)+_0x504b3d[_0x4a1587(0x387)])),_0x21a213%_0x35fc34==0x0&&(_0x1cb004[_0x3b5559]=_0x2efd64,_0x3b5559++);});const _0x3e48ed=Markup['inlineKeyboard'](_0x1cb004);_0xbee66b[_0x48e89e(0x1f6)](_0x48e89e(0x278),_0x3e48ed);}}),tgBot[_0x44d5dd(0x343)](/toggle_(.+)/,async _0x519ba4=>{const _0x3ad290=_0x44d5dd,_0x59531b=_0x519ba4[_0x3ad290(0x22e)][0x1];_0x519ba4['editMessageReplyMarkup']();const _0x1f1485=getBotsWithMode(),_0x4b434c=_0x1f1485[_0x3ad290(0x323)](_0x5fc663=>_0x5fc663['botID']==_0x59531b),_0x4f7e21=_0x4b434c[_0x3ad290(0x1e5)]==_0x3ad290(0x279)?_0x3ad290(0x2b5):_0x3ad290(0x279);sendTelegram(_0x519ba4[_0x3ad290(0x334)]['id'],_0x3ad290(0x3a8)+_0x59531b+_0x3ad290(0x328)+_0x4f7e21+_0x3ad290(0x393)),toggleBotMode(_0x59531b);}),tgBot[_0x44d5dd(0x263)](_0x44d5dd(0x22a),async _0x1a43d0=>{const _0x1a97d8=_0x44d5dd;let _0x4c5355='';config[_0x1a97d8(0x232)](_0x53c940=>{const _0x3d028b=_0x1a97d8;_0x4c5355+=_0x3d028b(0x1bf)+_0x53c940[_0x3d028b(0x387)]+':\x20'+_0x53c940[_0x3d028b(0x248)]+'\x0a';}),sendTelegram(_0x1a43d0['chat']['id'],_0x4c5355,{'parse_mode':_0x1a97d8(0x1ec)});}),tgBot[_0x44d5dd(0x263)](_0x44d5dd(0x1d5),async _0x5b57bb=>{const _0x4b03e3=_0x44d5dd;sendTelegram(_0x5b57bb[_0x4b03e3(0x334)]['id'],_0x1fc557);}),process[_0x44d5dd(0x363)](_0x44d5dd(0x2f9),()=>tgBot[_0x44d5dd(0x1cc)](_0x44d5dd(0x2f9))),process[_0x44d5dd(0x363)](_0x44d5dd(0x362),()=>tgBot[_0x44d5dd(0x1cc)]('SIGTERM')),tgBot[_0x44d5dd(0x22c)]();}}function disableTelegram(){const _0x3803a5=_0x163029;tgBot&&tgBot[_0x3803a5(0x1cc)]();}async function sendTelegram(_0x49ce10,_0x32c038,_0x4df64e){const _0x279e1d=_0x163029;try{await tgBot[_0x279e1d(0x225)][_0x279e1d(0x313)](_0x49ce10,_0x32c038,_0x4df64e);}catch(_0x22cb45){console[_0x279e1d(0x219)](_0x279e1d(0x285),_0x22cb45);}}function sendTelegramBot(_0x53f675,_0x4e4b62){const _0x4f7bc5=_0x163029;if(settings[_0x4f7bc5(0x351)]){if(settings['telegramEvents']==_0x4f7bc5(0x286)||(_0x4e4b62['type']==_0x4f7bc5(0x30f)||_0x4e4b62[_0x4f7bc5(0x241)]=='warning'||_0x4e4b62[_0x4f7bc5(0x241)]=='success')&&settings[_0x4f7bc5(0x36e)]==_0x4f7bc5(0x2ae)||_0x4e4b62[_0x4f7bc5(0x241)]==_0x4f7bc5(0x1b8)&&settings[_0x4f7bc5(0x36e)]=='orders'){if(tgBot&&settings['telegramChatId']){if(_0x4e4b62['showname'])sendTelegram(settings[_0x4f7bc5(0x1c8)],_0x4e4b62[_0x4f7bc5(0x248)]+'\x20>\x20'+_0x4e4b62[_0x4f7bc5(0x214)]);else sendTelegram(settings[_0x4f7bc5(0x1c8)],_0x4f7bc5(0x1bf)+_0x53f675+_0x4f7bc5(0x274)+_0x4e4b62[_0x4f7bc5(0x214)]);}}}}async function sendTelegramMsg(_0x175203,_0x2c2d28=_0x163029(0x1ec)){const _0x249849=_0x163029;return settings[_0x249849(0x351)]&&tgBot&&settings[_0x249849(0x1c8)]?(await sendTelegram(settings[_0x249849(0x1c8)],_0x175203,{'parse_mode':_0x2c2d28}),!![]):![];}function getDeviceWithIp(_0x35a8b3){const _0x49b251=_0x163029;return devices[_0x49b251(0x323)](_0x3da08e=>_0x3da08e['ip']===_0x35a8b3);}function temporaryAccess2FA(_0x49fb97,_0x461eb2){const _0x1adb05=_0x163029;let _0x3f2f4c=new Date(),_0x2fa55a=![];if(lastIpApproval){if(_0x3f2f4c-lastIpApproval<0x1388)_0x2fa55a=!![];}lastIpApproval=new Date();if(_0x2fa55a)return;if(tgBot&&settings[_0x1adb05(0x1c8)]){const _0x3d1841=Markup['inlineKeyboard']([Markup['button'][_0x1adb05(0x21e)](_0x1adb05(0x23c),_0x1adb05(0x29d)),Markup[_0x1adb05(0x256)][_0x1adb05(0x21e)](_0x1adb05(0x297),_0x1adb05(0x384)),Markup[_0x1adb05(0x256)]['callback'](_0x1adb05(0x23d),_0x1adb05(0x317)),Markup[_0x1adb05(0x256)][_0x1adb05(0x21e)](_0x1adb05(0x1db),_0x1adb05(0x357))]);sendTelegram(settings[_0x1adb05(0x1c8)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x461eb2)['show']+'\x20?',_0x3d1841),tgBot[_0x1adb05(0x343)](/tempaccess_(.+)/,async _0x36474d=>{const _0x5c5d8a=_0x1adb05,_0x2b5bdc=_0x36474d[_0x5c5d8a(0x22e)][0x1];_0x36474d['editMessageReplyMarkup'](),devices[_0x49fb97]['telegramIpApproval']={'clientip':_0x461eb2,'timestamp':new Date()['getTime'](),'expiry':_0x2b5bdc},_0x2b5bdc!=_0x5c5d8a(0x1db)?(await sendTelegram(_0x36474d[_0x5c5d8a(0x334)]['id'],_0x5c5d8a(0x2c4)+_0x2b5bdc+'\x20minutes',{'parse_mode':_0x5c5d8a(0x1ec)}),io['to'](_0x49fb97)['emit'](_0x5c5d8a(0x36f),{'access':{'allow':![],'reason':_0x5c5d8a(0x2e1),'token':null}})):(await sendTelegram(_0x36474d[_0x5c5d8a(0x334)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x49fb97)[_0x5c5d8a(0x25c)](_0x5c5d8a(0x36f),{'access':{'allow':![],'reason':_0x5c5d8a(0x245),'token':null}}));});}}function loginAccess2FA(_0x24d985,_0xbb3113){const _0x576177=_0x163029;if(tgBot&&settings[_0x576177(0x1c8)]){const _0x204f2d=Markup[_0x576177(0x3b0)]([Markup[_0x576177(0x256)]['callback']('accept',_0x576177(0x348)+loginExpiry),Markup['button']['callback'](_0x576177(0x1db),'login2fa_reject')]);sendTelegram(settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0xbb3113)[_0x576177(0x231)]+'\x20?',_0x204f2d),tgBot[_0x576177(0x343)](/login2fa_(.+)/,async _0x298db5=>{const _0x5d8c48=_0x576177,_0x3eabae=_0x298db5[_0x5d8c48(0x22e)][0x1];_0x298db5['editMessageReplyMarkup'](),devices[_0x24d985][_0x5d8c48(0x1f5)]={'clientip':_0xbb3113,'timestamp':new Date()[_0x5d8c48(0x38d)](),'expiry':_0x3eabae},_0x3eabae!=_0x5d8c48(0x1db)?(await sendTelegram(_0x298db5[_0x5d8c48(0x334)]['id'],_0x5d8c48(0x350),{'parse_mode':_0x5d8c48(0x1ec)}),io['to'](_0x24d985)[_0x5d8c48(0x25c)]('status',{'access':{'allow':![],'reason':_0x5d8c48(0x2e1),'token':null}})):(await sendTelegram(_0x298db5[_0x5d8c48(0x334)]['id'],_0x5d8c48(0x310)),io['to'](_0x24d985)[_0x5d8c48(0x25c)]('status',{'access':{'allow':![],'reason':_0x5d8c48(0x2be),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x509d1b=_0x163029;return dbConfig[_0x509d1b(0x33a)](_0x509d1b(0x1ff))['sortBy']('botID')[_0x509d1b(0x32d)]({'status':'enabled'})[_0x509d1b(0x2b1)]()||[];}function getDisabledBots(){const _0x4119a3=_0x163029;return dbConfig[_0x4119a3(0x33a)](_0x4119a3(0x1ff))[_0x4119a3(0x2e8)]('botID')[_0x4119a3(0x32d)]({'status':_0x4119a3(0x340)})[_0x4119a3(0x2b1)]()||[];}function getBotAttributes(_0x4ed94a){const _0x452f40=_0x163029;let _0xd6e88a={};const _0x117c12=configpath+_0x452f40(0x1e8)+_0x4ed94a+_0x452f40(0x1d0),_0x5569ea=fs[_0x452f40(0x2c6)](_0x117c12);if(_0x5569ea){const _0x250cf9=fs[_0x452f40(0x2a7)](_0x117c12);try{const _0x491535=JSON[_0x452f40(0x20d)](_0x250cf9),_0x244edd=_0x491535?_0x491535[_0x452f40(0x2e9)][0x0][_0x452f40(0x326)]:![];_0xd6e88a['mode']=_0x244edd?_0x452f40(0x279):_0x452f40(0x2b5),_0xd6e88a[_0x452f40(0x248)]=_0x491535?_0x491535[_0x452f40(0x2e9)][0x0]['botname']:_0x452f40(0x1bf)+_0x4ed94a;}catch(_0x63a208){_0xd6e88a[_0x452f40(0x1e5)]=_0x452f40(0x2b5),_0xd6e88a[_0x452f40(0x248)]='Bot\x20'+_0x4ed94a;}}else _0xd6e88a['mode']=_0x452f40(0x2b5),_0xd6e88a['botname']='Bot\x20'+_0x4ed94a;return _0xd6e88a;}function getBotsWithMode(){const _0x254d30=_0x163029,_0x453065=dbConfig['get'](_0x254d30(0x1ff))[_0x254d30(0x2e8)](_0x254d30(0x387))['value']()||[];return _0x453065[_0x254d30(0x232)](_0x3efa17=>{let _0x532288=getBotAttributes(_0x3efa17['botID']);_0x3efa17['mode']=_0x532288['mode'];}),_0x453065;}function getBotExchanges(){const _0x1f191c=_0x163029;let _0x16eed5=[];const _0x7f0d15=dbConfig[_0x1f191c(0x33a)](_0x1f191c(0x1ff))['sortBy'](_0x1f191c(0x387))[_0x1f191c(0x2b1)]()||[];_0x7f0d15[_0x1f191c(0x232)](_0x569d1a=>{const _0x4763d1=_0x1f191c;if(_0x569d1a[_0x4763d1(0x36f)]=='enabled'){const _0x504855=configpath+_0x4763d1(0x1e8)+_0x569d1a[_0x4763d1(0x387)]+_0x4763d1(0x1d0),_0x38ffed=fs[_0x4763d1(0x2c6)](_0x504855);let _0x2ac598;if(_0x38ffed){const _0x20f3ac=fs[_0x4763d1(0x2a7)](_0x504855);try{const _0x1faabc=JSON[_0x4763d1(0x20d)](_0x20f3ac);_0x2ac598=_0x1faabc?_0x1faabc['bot'][0x0][_0x4763d1(0x311)]:null;}catch(_0x373198){}}if(_0x2ac598)_0x16eed5['push'](_0x2ac598);}});const _0x477483=[...new Set(_0x16eed5)][_0x1f191c(0x284)]();return _0x477483;}async function initUser(){const _0x29d65a=_0x163029;if(!settings[_0x29d65a(0x2d3)]){const _0x3770a9=uuidRandom();mixpanel[_0x29d65a(0x30a)](_0x3770a9),updateSetting(_0x29d65a(0x2d3),_0x3770a9);}}async function initSecure(){const _0x29cc24=_0x163029;let _0x16da90=getSecure();if(!_0x16da90[_0x29cc24(0x3ae)](_0x29cc24(0x2d8))){let _0x45303a=await generateKeys();_0x16da90[_0x29cc24(0x38f)]=_0x45303a[_0x29cc24(0x38f)],_0x16da90[_0x29cc24(0x322)]=_0x45303a[_0x29cc24(0x322)],_0x16da90[_0x29cc24(0x2d8)]=crypto[_0x29cc24(0x1c6)](0x20)[_0x29cc24(0x2ad)]('hex');;storeSecure(_0x16da90);}}function getSettings(){const _0x2d5b45=_0x163029;return dbSettings[_0x2d5b45(0x33a)]('settings')[_0x2d5b45(0x2b1)]()||{};}function getSecure(){const _0x1817f1=_0x163029;return dbSecure['get'](_0x1817f1(0x3a3))[_0x1817f1(0x2b1)]()||{};}function getBlacklist(){const _0x15fd09=_0x163029;return dbSecure[_0x15fd09(0x33a)](_0x15fd09(0x28d))[_0x15fd09(0x2b1)]()||[];}function broadcastToBots(_0x4933d3,_0x1ba3ae){const _0x466cb5=_0x163029;config[_0x466cb5(0x232)](_0x45c91a=>{const _0x1ee362=_0x466cb5;if(_0x45c91a['status']==_0x1ee362(0x332)&&_0x45c91a[_0x1ee362(0x36a)]==_0x1ee362(0x369)||_0x45c91a[_0x1ee362(0x36f)]==_0x1ee362(0x32b)&&_0x45c91a['live']==_0x1ee362(0x369)){if(pid[_0x45c91a[_0x1ee362(0x387)]])pid[_0x45c91a[_0x1ee362(0x387)]]['send']({[_0x4933d3]:_0x1ba3ae});}});}async function storeSettings(_0x5447e6,_0x5063b9=![]){const _0xddfadc=_0x163029;_0x5447e6={...settings,..._0x5447e6};if(_0x5063b9&&_0x5447e6[_0xddfadc(0x29a)]!=_0xddfadc(0x2f8)&&_0x5447e6[_0xddfadc(0x29a)]!=_0xddfadc(0x3ad)&&_0x5447e6[_0xddfadc(0x29a)]!=''){const _0x2235dd=crypt['decrypt'](secure[_0xddfadc(0x322)],_0x5447e6['bbPassword'])[_0xddfadc(0x216)]['split']('@')[0x0],_0x2b6a62=bcrypt['hashSync'](_0x2235dd,saltRounds);_0x5447e6={..._0x5447e6,'bbPassword':_0x2b6a62};}if(_0x5063b9&&_0x5447e6[_0xddfadc(0x358)]!=_0xddfadc(0x2f8)&&_0x5447e6[_0xddfadc(0x358)]!='***'&&_0x5447e6[_0xddfadc(0x358)]!=''){const _0x5ee5a1=crypt['decrypt'](secure[_0xddfadc(0x322)],_0x5447e6[_0xddfadc(0x358)])[_0xddfadc(0x216)]['split']('@')[0x0];_0x5447e6={..._0x5447e6,'telegramToken':_0x5ee5a1};}const _0x3022e2=_0x5447e6[_0xddfadc(0x358)]!=_0xddfadc(0x2f8)&&_0x5447e6[_0xddfadc(0x358)]!=settings[_0xddfadc(0x358)]||_0x5447e6[_0xddfadc(0x1c2)]!=settings['telegramUsername'],_0x4b77e1=_0x5447e6[_0xddfadc(0x358)]==''||_0x5447e6['telegramUsername']=='';_0x3022e2&&(_0x5447e6[_0xddfadc(0x1c8)]=null,_0x5447e6[_0xddfadc(0x36e)]=_0xddfadc(0x286));for(const [_0x56aa22,_0x5b19ae]of Object['entries'](_0x5447e6)){if(_0x56aa22==_0xddfadc(0x358)&&_0x5b19ae==_0xddfadc(0x2f8)){_0x5447e6[_0xddfadc(0x358)]=settings[_0xddfadc(0x358)];continue;};if(_0x56aa22==_0xddfadc(0x29a)&&_0x5b19ae==_0xddfadc(0x2f8)){_0x5447e6['bbPassword']=settings['bbPassword'];continue;};dbSettings['set'](_0xddfadc(0x2b8)+_0x56aa22,_0x5b19ae)[_0xddfadc(0x1f9)]();}settings=_0x5447e6,io['to'](_0xddfadc(0x259))['emit']('settings',cleanSettings()),broadcastToBots(_0xddfadc(0x2f0),settings[_0xddfadc(0x2f0)]),broadcastToBots(_0xddfadc(0x37c),settings[_0xddfadc(0x37c)]);if(_0x3022e2&&!_0x4b77e1)initTelegram();if(_0x3022e2&&_0x4b77e1)disableTelegram();getAllClients()['forEach'](_0xce7e3a=>{const _0x3ef245=_0xddfadc;getSocket(_0xce7e3a['id'])[_0x3ef245(0x25c)](_0x3ef245(0x36f),{'access':{'allow':![],'reason':_0x3ef245(0x2e1),'token':null}});});}function updateSetting(_0x4537ae,_0x5e96b7){const _0xc515a6=_0x163029;dbSettings['set'](_0xc515a6(0x2b8)+_0x4537ae,_0x5e96b7)[_0xc515a6(0x1f9)](),settings=getSettings(),io['to'](_0xc515a6(0x259))[_0xc515a6(0x25c)](_0xc515a6(0x2c1),cleanSettings());}function storeSecure(_0x15b8ae){const _0x205b80=_0x163029;dbSecure[_0x205b80(0x33a)](_0x205b80(0x3a3))['push'](_0x15b8ae)[_0x205b80(0x1f9)](),secure=_0x15b8ae;}function addBlacklist(_0xd9234f){const _0x24ad5a=_0x163029;cleanBlacklist();let _0x325b3e;devices[_0xd9234f][_0x24ad5a(0x2db)]?_0x325b3e=Math[_0x24ad5a(0x226)](devices[_0xd9234f][_0x24ad5a(0x2db)][_0x24ad5a(0x38e)],loginExpiry):_0x325b3e=loginExpiry,dbSecure[_0x24ad5a(0x33a)](_0x24ad5a(0x28d))[_0x24ad5a(0x299)]({'expiry':new Date()[_0x24ad5a(0x38d)]()+_0x325b3e*0x3c*0x3e8,'token':devices[_0xd9234f][_0x24ad5a(0x243)][_0x24ad5a(0x34d)]})[_0x24ad5a(0x1f9)](),blacklist=dbSecure['get'](_0x24ad5a(0x28d))['value']();}function cleanBlacklist(){const _0x31d609=_0x163029;let _0x529c0d=dbSecure['get'](_0x31d609(0x28d))[_0x31d609(0x399)]()[_0x31d609(0x2b1)](),_0x4bf201=new Date()[_0x31d609(0x38d)]();_0x529c0d[_0x31d609(0x232)](_0x15f470=>{const _0x1fbbde=_0x31d609;_0x15f470['expiry']<_0x4bf201&&dbSecure[_0x1fbbde(0x33a)](_0x1fbbde(0x28d))[_0x1fbbde(0x32c)]({'expiry':_0x15f470[_0x1fbbde(0x38e)]})[_0x1fbbde(0x1f9)]();});}function initStates(){let _0x490290=getConfiguration();_0x490290['forEach'](_0x177f0b=>{const _0x293771=_0x4908;_0x177f0b['live']=_0x293771(0x1c3);}),storeConfiguration(_0x490290);}function onKeys(){const _0x6ae6fe=new RSA();return new Promise(_0x4734bd=>{const _0x50dc52=_0x4908;_0x6ae6fe[_0x50dc52(0x204)]()[_0x50dc52(0x271)](_0x503708=>{_0x4734bd(_0x503708);});});}function _0x4908(_0x394fb5,_0x4c6787){const _0xc4b447=_0x1b47();return _0x4908=function(_0x1fb5dd,_0x1cd5ff){_0x1fb5dd=_0x1fb5dd-0x1b8;let _0x1b47f0=_0xc4b447[_0x1fb5dd];return _0x1b47f0;},_0x4908(_0x394fb5,_0x4c6787);}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x114da5=_0x163029;let _0x32fa6a=getSettings(),_0x197ef2=![];!_0x32fa6a['hasOwnProperty'](_0x114da5(0x36c))&&(_0x32fa6a[_0x114da5(0x36c)]=0x0,_0x197ef2=!![]);!_0x32fa6a[_0x114da5(0x3ae)]('lastmsgemitted')&&(_0x32fa6a[_0x114da5(0x26b)]=0x0,_0x197ef2=!![]);!_0x32fa6a[_0x114da5(0x3ae)](_0x114da5(0x220))&&(_0x32fa6a[_0x114da5(0x220)]=_0x114da5(0x331),_0x197ef2=!![]);!_0x32fa6a[_0x114da5(0x3ae)](_0x114da5(0x37c))&&(_0x32fa6a['onepagemode']=![],_0x197ef2=!![]);if(_0x197ef2)storeSettings(_0x32fa6a);try{fs[_0x114da5(0x2fa)](configbackuppath,{'withFileTypes':!![]})[_0x114da5(0x232)](_0x2eb050=>{const _0x858300=_0x114da5;if(!_0x2eb050['isDirectory']()){if(!_0x2eb050[_0x858300(0x296)][_0x858300(0x291)]('backup-full@'))fs[_0x858300(0x233)](configbackuppath+_0x2eb050[_0x858300(0x296)]);}else fs[_0x858300(0x30b)](configbackuppath+_0x2eb050[_0x858300(0x296)],{'recursive':!![]});});}catch(_0xc1eeb8){logger[_0x114da5(0x364)](_0x114da5(0x203),_0xc1eeb8);}}function storeConfiguration(_0x7a5d3f){const _0x4f8f29=_0x163029;dbConfig[_0x4f8f29(0x33a)](_0x4f8f29(0x1ff))[_0x4f8f29(0x32c)]()[_0x4f8f29(0x1f9)](),dbConfig[_0x4f8f29(0x33a)]('bots')[_0x4f8f29(0x299)](..._0x7a5d3f)[_0x4f8f29(0x1f9)](),config=_0x7a5d3f;}function resetPassword(){const _0x2e70c3=_0x163029;if(tgBot&&settings[_0x2e70c3(0x1c8)]){const _0x377fd1=Markup[_0x2e70c3(0x3b0)]([Markup['button'][_0x2e70c3(0x21e)](_0x2e70c3(0x34f),'resetpw_yes'),Markup[_0x2e70c3(0x256)][_0x2e70c3(0x21e)]('no',_0x2e70c3(0x37e))]);sendTelegram(settings[_0x2e70c3(0x1c8)],_0x2e70c3(0x301),_0x377fd1),tgBot[_0x2e70c3(0x343)](/resetpw_(.+)/,async _0x592714=>{const _0x2de747=_0x2e70c3,_0xde50f2=_0x592714['match'][0x1];_0x592714[_0x2de747(0x22d)]();if(_0xde50f2!='no'){const _0x13e5c9=0xf,_0x2657c1=_0x2de747(0x336),_0x49d3b5=Array['from'](crypto[_0x2de747(0x282)](new Uint32Array(_0x13e5c9)))['map'](_0x1ea319=>_0x2657c1[_0x1ea319%_0x2657c1[_0x2de747(0x27b)]])[_0x2de747(0x31d)](''),_0x37733a=bcrypt['hashSync'](_0x49d3b5,saltRounds);storeSettings({'bbPassword':_0x37733a}),await sendTelegram(_0x592714['chat']['id'],_0x2de747(0x318)+_0x49d3b5,{'parse_mode':_0x2de747(0x1ec)});}else await sendTelegram(_0x592714[_0x2de747(0x334)]['id'],_0x2de747(0x2c8));});}}async function confirmRestore(_0x3f6273,_0x30ddd8){const _0xdc5c9d=_0x163029;io['to'](_0xdc5c9d(0x259))[_0xdc5c9d(0x25c)](_0xdc5c9d(0x1d2),_0xdc5c9d(0x227),_0xdc5c9d(0x386));if(tgBot&&settings['telegramChatId']){const _0x5ec46d=Markup[_0xdc5c9d(0x3b0)]([Markup[_0xdc5c9d(0x256)]['callback']('yes',_0xdc5c9d(0x213)),Markup[_0xdc5c9d(0x256)][_0xdc5c9d(0x21e)]('no',_0xdc5c9d(0x287))]);sendTelegram(settings['telegramChatId'],_0xdc5c9d(0x2d7),_0x5ec46d),tgBot['action'](/restore_(.+)/,async _0x5aa11c=>{const _0x2c41d3=_0xdc5c9d,_0x3a8fee=_0x5aa11c[_0x2c41d3(0x22e)][0x1];_0x5aa11c[_0x2c41d3(0x22d)](),_0x3a8fee==_0x2c41d3(0x34f)?(logger[_0x2c41d3(0x364)](_0x2c41d3(0x31a)),await sendTelegram(_0x5aa11c[_0x2c41d3(0x334)]['id'],_0x2c41d3(0x3ab),{'parse_mode':_0x2c41d3(0x1ec)}),unzipFile(_0x3f6273,_0x30ddd8)):(logger[_0x2c41d3(0x364)](_0x2c41d3(0x2af)),await sendTelegram(_0x5aa11c[_0x2c41d3(0x334)]['id'],_0x2c41d3(0x2af)));});}}function getServerTime(){const _0x53e463=_0x163029,_0x37f93f=new Date();return _0x37f93f[_0x53e463(0x21a)]()+'/'+(_0x37f93f[_0x53e463(0x22b)]()+0x1)[_0x53e463(0x2ad)]()[_0x53e463(0x24f)](0x2,'0')+'/'+_0x37f93f[_0x53e463(0x260)]()['toString']()[_0x53e463(0x24f)](0x2,'0')+'\x20'+_0x37f93f[_0x53e463(0x2e3)]()[_0x53e463(0x2ad)]()[_0x53e463(0x24f)](0x2,'0')+':'+_0x37f93f[_0x53e463(0x1ce)]()[_0x53e463(0x2ad)]()[_0x53e463(0x24f)](0x2,'0')+':'+_0x37f93f[_0x53e463(0x2bc)]()[_0x53e463(0x2ad)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x2eb397=_0x163029,_0x486881=shiftedTime();return _0x486881[_0x2eb397(0x21a)]()+'/'+(_0x486881['getMonth']()+0x1)[_0x2eb397(0x2ad)]()[_0x2eb397(0x24f)](0x2,'0')+'/'+_0x486881[_0x2eb397(0x260)]()[_0x2eb397(0x2ad)]()[_0x2eb397(0x24f)](0x2,'0')+'\x20'+_0x486881['getHours']()[_0x2eb397(0x2ad)]()['padStart'](0x2,'0')+':'+_0x486881[_0x2eb397(0x1ce)]()['toString']()[_0x2eb397(0x24f)](0x2,'0')+':'+_0x486881['getSeconds']()[_0x2eb397(0x2ad)]()[_0x2eb397(0x24f)](0x2,'0');}function getCleanTimeStamp(){const _0x2b4015=_0x163029,_0x1ad7eb=shiftedTime();return _0x1ad7eb['getFullYear']()+(_0x1ad7eb[_0x2b4015(0x22b)]()+0x1)[_0x2b4015(0x2ad)]()[_0x2b4015(0x24f)](0x2,'0')+_0x1ad7eb[_0x2b4015(0x260)]()['toString']()[_0x2b4015(0x24f)](0x2,'0')+'-'+_0x1ad7eb['getHours']()[_0x2b4015(0x2ad)]()['padStart'](0x2,'0')+_0x1ad7eb['getMinutes']()[_0x2b4015(0x2ad)]()['padStart'](0x2,'0')+_0x1ad7eb['getSeconds']()[_0x2b4015(0x2ad)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x21de8d=_0x163029,_0x147cb8=new Date();let _0x1e9872=_0x147cb8;if(settings['timeshift']&&settings[_0x21de8d(0x2f0)]!==0x0)_0x1e9872=fns[_0x21de8d(0x2a3)](_0x147cb8,{'hours':settings[_0x21de8d(0x2f0)]});return _0x1e9872;}function startScheduler(){const _0x568521=_0x163029,_0x1a43cd=new Date()[_0x568521(0x352)](),_0x297dbc=shiftedTime()[_0x568521(0x2e3)]();_0x297dbc==0x4&&backupConfigFiles();_0x297dbc==0x0&&rotateLogFiles();_0x1a43cd%0x6==0x0&&triggerAnalytics();_0x1a43cd%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x180415){const _0x454f10=_0x163029;logger[_0x454f10(0x364)](_0x454f10(0x215)+_0x180415);const _0x47cbbd=getBotsWithMode();_0x47cbbd[_0x454f10(0x27b)]>0x0?confirmRestore(configbackuppath,_0x180415):unzipFile(configbackuppath,_0x180415);}async function getBackupFiles(_0x4c8745=null){const _0x518279=_0x163029;let _0x2cc118=[],_0x4f4d6a=fs[_0x518279(0x2fa)](configbackuppath,{'withFileTypes':!![]});_0x4f4d6a[_0x518279(0x284)]((_0x5b1d2f,_0x10b83b)=>_0x5b1d2f[_0x518279(0x296)]<_0x10b83b['name']?0x1:_0x10b83b[_0x518279(0x296)]<_0x5b1d2f['name']?-0x1:0x0),_0x4f4d6a[_0x518279(0x232)](_0x12ffe0=>{const _0x3c8569=_0x518279;if(!_0x12ffe0[_0x3c8569(0x24d)]()&&_0x12ffe0[_0x3c8569(0x296)][_0x3c8569(0x291)](_0x3c8569(0x39b))&&_0x12ffe0['name'][_0x3c8569(0x3a1)](_0x3c8569(0x3aa))){const _0x53d8e1=formatDate(fs[_0x3c8569(0x27a)](configbackuppath+_0x12ffe0['name'])[_0x3c8569(0x262)]);_0x2cc118[_0x3c8569(0x299)]({'name':_0x12ffe0[_0x3c8569(0x296)],'mtime':_0x53d8e1});}});if(_0x4c8745)io['to'](_0x4c8745)[_0x518279(0x25c)](_0x518279(0x208),_0x2cc118);else return _0x2cc118;}async function backupConfigFiles(){const _0x5e16b4=_0x163029;await zipFiles(_0x5e16b4(0x298));const _0x5dd79c=getCleanTimeStamp();fs[_0x5e16b4(0x2dd)](zippath+_0x5e16b4(0x305),configbackuppath+(_0x5e16b4(0x39b)+_0x5dd79c+_0x5e16b4(0x3aa)));let _0x5253a3=fs[_0x5e16b4(0x2fa)](configbackuppath,{'withFileTypes':!![]});_0x5253a3[_0x5e16b4(0x284)]((_0x3976e0,_0x52a410)=>_0x3976e0[_0x5e16b4(0x296)]<_0x52a410['name']?0x1:_0x52a410['name']<_0x3976e0[_0x5e16b4(0x296)]?-0x1:0x0),_0x5253a3['length']>maxBackups&&fs['unlinkSync'](configbackuppath+_0x5253a3[_0x5253a3['length']-0x1]['name']);}function rotateLogFiles(){const _0x5568c4=_0x163029,_0x78ea60=fs[_0x5568c4(0x27a)](logspath+'output-000.log'),_0x4e68b2=_0x78ea60[_0x5568c4(0x388)]/0x400;if(_0x4e68b2>0x64){let _0x2b04f5=fs[_0x5568c4(0x2fa)](logspath,{'withFileTypes':!![]});_0x2b04f5[_0x5568c4(0x284)]((_0x4b9632,_0x1eb6a3)=>_0x4b9632[_0x5568c4(0x296)]<_0x1eb6a3[_0x5568c4(0x296)]?0x1:_0x1eb6a3[_0x5568c4(0x296)]<_0x4b9632[_0x5568c4(0x296)]?-0x1:0x0),_0x2b04f5[_0x5568c4(0x232)](_0x4e9c78=>{const _0x5c5837=_0x5568c4;if(_0x4e9c78['name']=='output-002.log')fs[_0x5c5837(0x2dd)](logspath+_0x4e9c78[_0x5c5837(0x296)],logspath+_0x5c5837(0x306));if(_0x4e9c78['name']==_0x5c5837(0x2b7))fs[_0x5c5837(0x2dd)](logspath+_0x4e9c78[_0x5c5837(0x296)],logspath+_0x5c5837(0x29c));_0x4e9c78[_0x5c5837(0x296)]==_0x5c5837(0x3a2)&&(fs[_0x5c5837(0x2dd)](logspath+_0x4e9c78[_0x5c5837(0x296)],logspath+_0x5c5837(0x2b7)),fs[_0x5c5837(0x30d)](logspath+_0x4e9c78['name'],''));});}}async function zipFiles(_0x310452){const _0x5df40b=_0x163029;let _0x1c5041;if(_0x310452==_0x5df40b(0x37a))_0x1c5041=logspath;if(_0x310452==_0x5df40b(0x2ff))_0x1c5041=configpath;if(_0x310452=='backup-full')_0x1c5041=configpath;let _0x29a4d2=fs[_0x5df40b(0x2fa)](_0x1c5041,{'withFileTypes':!![]});const _0x11e7db=new require('node-zip')();_0x29a4d2['forEach'](_0x6bb4c1=>{const _0x504041=_0x5df40b;if(!_0x6bb4c1['isDirectory']()){let _0x431328=fs['readFileSync'](_0x1c5041+_0x6bb4c1[_0x504041(0x296)]);if(_0x310452==_0x504041(0x2ff)){const _0x970141=/^bot-[0-9]{3}-config.json$/,_0x2f18f3=_0x970141[_0x504041(0x2aa)](_0x6bb4c1[_0x504041(0x296)]);if(_0x2f18f3){const _0x1a3184=JSON[_0x504041(0x20d)](_0x431328);if(_0x1a3184[_0x504041(0x2e9)][0x0]){_0x1a3184[_0x504041(0x2e9)][0x0][_0x504041(0x26a)]=_0x504041(0x3ad),_0x1a3184[_0x504041(0x2e9)][0x0][_0x504041(0x251)]=_0x504041(0x3ad);if(_0x1a3184[_0x504041(0x2e9)][0x0]['apiPassword'])_0x1a3184[_0x504041(0x2e9)][0x0][_0x504041(0x224)]=_0x504041(0x3ad);}_0x431328=JSON[_0x504041(0x1c5)](_0x1a3184,null,0x2);}if(_0x6bb4c1[_0x504041(0x296)]==_0x504041(0x1bd)){const _0x22f4a3=JSON[_0x504041(0x20d)](_0x431328);if(_0x22f4a3['settings'][_0x504041(0x22f)])_0x22f4a3[_0x504041(0x2c1)][_0x504041(0x22f)]=![];if(_0x22f4a3[_0x504041(0x2c1)][_0x504041(0x29a)])_0x22f4a3[_0x504041(0x2c1)][_0x504041(0x29a)]=_0x504041(0x3ad);if(_0x22f4a3[_0x504041(0x2c1)][_0x504041(0x358)])_0x22f4a3[_0x504041(0x2c1)][_0x504041(0x358)]=_0x504041(0x3ad);if(_0x22f4a3['settings'][_0x504041(0x1c8)])_0x22f4a3[_0x504041(0x2c1)][_0x504041(0x1c8)]=null;_0x431328=JSON[_0x504041(0x1c5)](_0x22f4a3,null,0x2);}if(_0x6bb4c1['name']!=_0x504041(0x1e1))_0x11e7db[_0x504041(0x21d)](_0x6bb4c1[_0x504041(0x296)],_0x431328);}else _0x11e7db[_0x504041(0x21d)](_0x6bb4c1[_0x504041(0x296)],_0x431328);}});const _0x3acc4c=_0x11e7db['generate']({'base64':![],'compression':_0x5df40b(0x35e)});fs[_0x5df40b(0x30d)](zippath+(_0x310452+'.zip'),_0x3acc4c,'binary');}async function unzipFile(_0x9606a4,_0x23d26d){const _0x1eb0d4=_0x163029;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x1eb0d4(0x232)](_0x5229be=>{const _0x1b83de=_0x1eb0d4;if(!_0x5229be[_0x1b83de(0x24d)]())fs[_0x1b83de(0x30b)](configpath+_0x5229be[_0x1b83de(0x296)]);});const _0x58a050=fs[_0x1eb0d4(0x2a7)](_0x9606a4+_0x23d26d,_0x1eb0d4(0x382)),_0xb67c84=new require(_0x1eb0d4(0x209))(_0x58a050,{'base64':![],'checkCRC32':!![]});Object[_0x1eb0d4(0x3a5)](_0xb67c84[_0x1eb0d4(0x20b)])[_0x1eb0d4(0x232)](_0x11640e=>{const _0x17f1f7=_0x1eb0d4,_0x179c32=_0xb67c84[_0x17f1f7(0x20b)][_0x11640e];fs[_0x17f1f7(0x30d)](configpath+_0x179c32['name'],_0x179c32['_data']);}),fs[_0x1eb0d4(0x2fa)](temppath,{'withFileTypes':!![]})[_0x1eb0d4(0x232)](_0x146faa=>{const _0xdf2523=_0x1eb0d4;if(!_0x146faa['isDirectory']())fs['rmSync'](temppath+_0x146faa[_0xdf2523(0x296)]);}),logger[_0x1eb0d4(0x364)](_0x1eb0d4(0x20c)),process[_0x1eb0d4(0x1e0)]({'restore':!![]},_0x2649e2=>{});}async function getPublicIp(){const _0x383c47=_0x163029;try{const _0x42db96=await axios[_0x383c47(0x33a)]('https://api.ipify.org?format=json');publicip=_0x42db96[_0x383c47(0x2ba)]['ip'];}catch(_0x57f716){}}async function triggerAnalytics(){const _0x367f48=_0x163029;if(!publicip)await getPublicIp();const _0xb486dd=getBotsWithMode();let _0x61811b=0x0;_0xb486dd[_0x367f48(0x232)](_0x4c9bb8=>{const _0x3e3367=_0x367f48;if(_0x4c9bb8['status']===_0x3e3367(0x332))_0x61811b++;});const _0xe572d3=getBotExchanges();mixpanel['track'](_0x367f48(0x23e),{'distinct_id':settings[_0x367f48(0x2d3)],'ip':publicip,'version':serverversion,'numbots':_0xb486dd[_0x367f48(0x27b)],'numbotsenabled':_0x61811b,'exchanges':_0xe572d3,'environment':environment});}async function getMessages(){const _0x1b0fde=_0x163029,_0x486c71=_0x1b0fde(0x304),_0x10a923=new GraphQLClient(_0x486c71),_0x116e84={'authorization':_0x1b0fde(0x247)},_0x15aa42=serverversion[_0x1b0fde(0x1de)]('.'),_0x317fd5=_0x15aa42[0x0]+'.'+_0x15aa42[0x1],_0x420900=Math['min'](settings[_0x1b0fde(0x36c)],settings[_0x1b0fde(0x26b)]),_0x4ac987={'last':parseInt(_0x420900),'bbm':_0x317fd5},_0x2125fe=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4288ac;try{_0x4288ac=await _0x10a923[_0x1b0fde(0x205)](_0x2125fe,_0x4ac987,_0x116e84);}catch(_0x5a5d08){}if(_0x4288ac&&_0x4288ac[_0x1b0fde(0x1da)]){let _0x13354f=settings['lastmsgtelegram'];newMessages=[];for(const _0x15f736 of _0x4288ac[_0x1b0fde(0x1da)]){newMessages['push'](_0x15f736);let _0x48df70=![];_0x15f736[_0x1b0fde(0x202)]&&(updateSetting(_0x1b0fde(0x220),_0x15f736['bbvNew']),_0x48df70=isNewerVersion(serverversion,_0x15f736[_0x1b0fde(0x202)])||serverversion==_0x15f736['bbvNew']);if(!_0x48df70&&_0x15f736[_0x1b0fde(0x381)]>_0x13354f){if(_0x15f736[_0x1b0fde(0x1e4)]===_0x1b0fde(0x31f)||serverversion[_0x1b0fde(0x291)](_0x15f736[_0x1b0fde(0x1e4)])){let _0x2d19a5=''+_0x15f736[_0x1b0fde(0x222)]+'\x0a\x0a'+_0x15f736['message'];const _0x226fb1=await sendTelegramMsg(toTelegramMarkdown(_0x2d19a5),'Markdown');if(_0x226fb1)_0x13354f=_0x15f736[_0x1b0fde(0x381)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting('lastmsgtelegram',_0x13354f),emitMessages();}}function emitMessages(){const _0x16a103=_0x163029,_0x1ef42f=settings[_0x16a103(0x26b)];let _0x2e71cc=[];newMessages['forEach'](_0x238afe=>{const _0x29042c=_0x16a103;_0x238afe[_0x29042c(0x381)]>_0x1ef42f&&_0x2e71cc[_0x29042c(0x299)](_0x238afe);}),_0x2e71cc[_0x16a103(0x27b)]>0x0&&getAllClients()[_0x16a103(0x232)](_0x2f74a0=>{const _0x593815=_0x16a103;getSocket(_0x2f74a0['id'])[_0x593815(0x25c)](_0x593815(0x216),_0x2e71cc);});}function confirmMessage(_0x42933c){const _0x38cd65=_0x163029;updateSetting(_0x38cd65(0x26b),Number(_0x42933c));}function isNewerVersion(_0x28e3ca,_0xcf6fe1){const _0x9e716a=_0x163029,_0x274a1c=_0xcf6fe1['split']('.'),_0x213efa=_0x28e3ca[_0x9e716a(0x1de)]('.');for(var _0x2f4263=0x0;_0x2f4263<_0x213efa[_0x9e716a(0x27b)];_0x2f4263++){const _0xfa7111=~~_0x213efa[_0x2f4263],_0xf87202=~~_0x274a1c[_0x2f4263];if(_0xfa7111>_0xf87202)return!![];if(_0xfa7111<_0xf87202)return![];}return![];}function toTelegramMarkdown(_0x3f61a6){const _0xafbc2c=_0x163029,_0x20a6d6=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x2ef0c8=/\*{2}(.+?)\*{2}/gim;return _0x3f61a6=_0x3f61a6[_0xafbc2c(0x320)](_0x20a6d6,_0xafbc2c(0x368))[_0xafbc2c(0x320)](_0x2ef0c8,_0xafbc2c(0x308)),_0x3f61a6;}async function validateConfigFile(){const _0x3fec2f=_0x163029,_0x53b797=dbConfig[_0x3fec2f(0x33a)](_0x3fec2f(0x1ff))[_0x3fec2f(0x2e8)]('botID')[_0x3fec2f(0x2b1)]()||[];if(_0x53b797['length']==0x0){let _0x10f390=0x0,_0x4b3b24=[];const _0x579184=/^bot-([0-9]{3})-config.json$/,_0x2b31b4=fs[_0x3fec2f(0x2fa)](configpath);_0x2b31b4[_0x3fec2f(0x232)](_0x5afb53=>{const _0x27a1ca=_0x3fec2f,_0x5c6ea5=_0x579184['exec'](_0x5afb53);if(_0x5c6ea5){const _0x393d83=_0x5c6ea5[0x1];let _0x3a05b9=getBotAttributes(_0x393d83);_0x4b3b24[_0x27a1ca(0x299)]({'botID':_0x393d83,'botname':_0x3a05b9[_0x27a1ca(0x248)],'status':'disabled','live':_0x27a1ca(0x1c3)}),_0x10f390++;}}),_0x10f390!=0x0&&(dbConfig['get'](_0x3fec2f(0x1ff))[_0x3fec2f(0x38c)](_0x4b3b24)[_0x3fec2f(0x1f9)](),config=_0x4b3b24,restoredConfigFile=_0x10f390);}}async function restoreConfigNotify(_0x44b091){const _0x461a30=_0x163029;let _0x199aa0;if(restoredConfigFile==0x1)_0x199aa0=_0x461a30(0x28a);else _0x199aa0='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x44b091)io['to'](_0x461a30(0x259))[_0x461a30(0x25c)]('notification',_0x199aa0);else{logger['simple'](_0x461a30(0x26e)),logger[_0x461a30(0x38b)](_0x199aa0),logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x461a30(0x38b)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x461a30(0x36e)]!=_0x461a30(0x1fc))sendTelegram(settings[_0x461a30(0x1c8)],'Bot\x20Mgr\x20>\x20'+_0x199aa0);}}function validateCredentials(_0x873b65,_0xf94f8d){const _0x5d3b37=_0x163029;if(_0x873b65[_0x5d3b37(0x244)]==settings['bbUsername']&&bcrypt[_0x5d3b37(0x366)](_0x873b65[_0x5d3b37(0x2c9)],settings[_0x5d3b37(0x29a)])){if(settings[_0x5d3b37(0x39c)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x81f45d=generateLoginToken(_0xf94f8d);return{'allow':!![],'reason':_0x5d3b37(0x31b),'token':_0x81f45d};}}else return{'allow':![],'reason':_0x5d3b37(0x29e),'token':null};}function refreshToken(_0x17ad4f){const _0x514ae5=generateLoginToken(_0x17ad4f);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x514ae5};}function validateAccess(_0x3be93b,_0x3eb038,_0x5ed996){const _0x529500=_0x163029,_0x853d49=_0x5ed996?_0x5ed996:devices[_0x3eb038]['ip'];let _0x32b760;const _0x5a13e0=_0x4486f3=>{const _0x1b9cf4=_0x4908;if(settings['loginRequired']){if(settings[_0x1b9cf4(0x39c)]){if(telegram2FaApproved(_0x3eb038)){const _0x566843=generateLoginToken(_0x3eb038);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x566843};}else return{'allow':![],'reason':_0x1b9cf4(0x294),'token':null};}else return _0x32b760=validToken(_0x4486f3,_0x3eb038),_0x32b760['hasOwnProperty'](_0x1b9cf4(0x386))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x4486f3}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x1b9cf4(0x201),'token':null};};if(settings[_0x529500(0x2ef)]){let _0x5bd979=[...settings['whitelist'],_0x529500(0x321),_0x529500(0x380),'127.0.0.1'];if(_0x5bd979[_0x529500(0x337)](_0x853d49))return _0x5a13e0(_0x3be93b);else{_0x32b760=validToken(_0x3be93b,_0x3eb038);if(_0x32b760[_0x529500(0x3ae)](_0x529500(0x386)))return _0x5a13e0(_0x3be93b);else{if(telegramIpApproved(_0x3eb038)){const _0xe3c9fb=generateToken(_0x3eb038);return _0x32b760=_0x5a13e0(_0x3be93b),_0x32b760[_0x529500(0x33c)]?{'allow':!![],'reason':_0x529500(0x1d1),'token':_0xe3c9fb}:_0x32b760;}else return settings[_0x529500(0x1df)]?{'allow':![],'reason':_0x529500(0x2f4),'token':null}:{'allow':![],'reason':_0x529500(0x397),'token':null};}}}else return _0x5a13e0(_0x3be93b);}function timelyDecrypt(_0x461972,_0x775033=!![]){const _0x33efa6=_0x163029;if(_0x461972)try{const _0x3d0f9c=crypt['decrypt'](secure[_0x33efa6(0x322)],_0x461972)[_0x33efa6(0x216)],_0x116f2e=_0x3d0f9c[_0x33efa6(0x1de)]('@')[0x0],_0x53d277=_0x3d0f9c[_0x33efa6(0x1de)]('@')[0x1],_0x305c6a=new Date()[_0x33efa6(0x38d)]();if(_0x775033){if(_0x305c6a-_0x53d277<maxSecretAge*0x3e8)return _0x116f2e;else return![];}else return _0x116f2e;}catch(_0x26a93f){return![];}else return![];}const validToken=(_0xbb400,_0x37e74c)=>{const _0x4ae874=_0x163029,_0x40a602=devices[_0x37e74c]['ip'];if(!_0xbb400)return{'error':_0x4ae874(0x1f7)};for(let _0x5ab90 of blacklist){if(_0x5ab90['token']==_0xbb400)return{'error':_0x4ae874(0x395)};}let _0x9746a6;try{_0x9746a6=jwt['verify'](_0xbb400,secure[_0x4ae874(0x2d8)]+_0x37e74c);}catch{return{'error':_0x4ae874(0x2a0)};}if(!_0x9746a6[_0x4ae874(0x3ae)](_0x4ae874(0x1d8))&&!_0x9746a6['hasOwnProperty'](_0x4ae874(0x244))||!_0x9746a6[_0x4ae874(0x3ae)](_0x4ae874(0x2c3)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x9746a6[_0x4ae874(0x3ae)](_0x4ae874(0x244))&&_0x9746a6['hasOwnProperty'](_0x4ae874(0x1d8))){const {clientip:_0x45d802}=_0x9746a6;return _0x40a602==_0x45d802?{'success':_0x4ae874(0x319)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x9746a6[_0x4ae874(0x3ae)](_0x4ae874(0x244))&&_0x9746a6[_0x4ae874(0x3ae)]('clientip')){const {username:_0x14d2b1,clientip:_0x46de74}=_0x9746a6;return settings['bbUsername']==_0x14d2b1&&_0x40a602==_0x46de74?{'success':_0x4ae874(0x319)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0xf2cde0=>{const _0x5708a7=_0x163029;if(_0xf2cde0){const _0x4010e5=devices[_0xf2cde0]['ip'];return jwt[_0x5708a7(0x275)]({'username':settings[_0x5708a7(0x2f3)],'clientip':_0x4010e5},secure[_0x5708a7(0x2d8)]+_0xf2cde0,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x17c3a4=>{const _0x32cf75=_0x163029;if(_0x17c3a4){const _0x5a792d=devices[_0x17c3a4]['ip'];return jwt['sign']({'clientip':_0x5a792d},secure[_0x32cf75(0x2d8)]+_0x17c3a4,{'expiresIn':devices[_0x17c3a4][_0x32cf75(0x2db)][_0x32cf75(0x38e)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0xfeb4f0=>{const _0x57043f=_0x163029;let _0x48d15e=![];return devices[_0xfeb4f0][_0x57043f(0x2db)]&&devices[_0xfeb4f0]['telegramIpApproval']['expiry']!='reject'&&(_0x48d15e=devices[_0xfeb4f0][_0x57043f(0x2db)][_0x57043f(0x1d8)]==devices[_0xfeb4f0]['ip']&&new Date()[_0x57043f(0x38d)]()-devices[_0xfeb4f0][_0x57043f(0x2db)][_0x57043f(0x307)]<devices[_0xfeb4f0][_0x57043f(0x2db)][_0x57043f(0x38e)]*0x3c*0x3e8),_0x48d15e;},telegram2FaApproved=_0x5eff9e=>{const _0x125d3d=_0x163029;let _0x2165e5=![];return devices[_0x5eff9e][_0x125d3d(0x1f5)]&&devices[_0x5eff9e][_0x125d3d(0x1f5)][_0x125d3d(0x38e)]!='reject'&&(_0x2165e5=devices[_0x5eff9e][_0x125d3d(0x1f5)][_0x125d3d(0x1d8)]==devices[_0x5eff9e]['ip']&&new Date()[_0x125d3d(0x38d)]()-devices[_0x5eff9e][_0x125d3d(0x1f5)][_0x125d3d(0x307)]<devices[_0x5eff9e][_0x125d3d(0x1f5)][_0x125d3d(0x38e)]*0x3c*0x3e8),_0x2165e5;},normalizeIP=_0x3dc4e5=>{const _0x2f0113=_0x163029;let _0x149c51=null,_0xccab53=null;if(ipaddr[_0x2f0113(0x2e7)](_0x3dc4e5)){const _0x121c8e=ipaddr[_0x2f0113(0x20d)](_0x3dc4e5);_0x121c8e['kind']()===_0x2f0113(0x1d3)?(_0x121c8e[_0x2f0113(0x2c5)]()&&(_0x149c51=_0x121c8e[_0x2f0113(0x29f)]()[_0x2f0113(0x2ad)]()),_0xccab53=_0x121c8e['toString']()):(_0x149c51=_0x121c8e[_0x2f0113(0x2ad)](),_0xccab53=_0x121c8e[_0x2f0113(0x39e)]()[_0x2f0113(0x2ad)]());}return{'show':_0x149c51?_0x149c51:_0xccab53,'store':_0xccab53};};function formatDate(_0x3916aa){const _0x467550=_0x163029;return _0x3916aa['getFullYear']()+'/'+(_0x3916aa[_0x467550(0x22b)]()+0x1)[_0x467550(0x2ad)]()[_0x467550(0x24f)](0x2,'0')+'/'+_0x3916aa[_0x467550(0x260)]()['toString']()[_0x467550(0x24f)](0x2,'0')+'\x20'+_0x3916aa[_0x467550(0x2e3)]()[_0x467550(0x2ad)]()[_0x467550(0x24f)](0x2,'0')+':'+_0x3916aa['getMinutes']()[_0x467550(0x2ad)]()[_0x467550(0x24f)](0x2,'0')+':'+_0x3916aa[_0x467550(0x2bc)]()[_0x467550(0x2ad)]()[_0x467550(0x24f)](0x2,'0');}function sleep(_0x54f875){return new Promise(_0x1e7269=>setTimeout(_0x1e7269,_0x54f875));}