const _0x5db121=_0x54c1;(function(_0x189caa,_0x457080){const _0x5c20ed=_0x54c1,_0x19a6c2=_0x189caa();while(!![]){try{const _0x28e89a=-parseInt(_0x5c20ed(0x16e))/0x1*(-parseInt(_0x5c20ed(0x228))/0x2)+-parseInt(_0x5c20ed(0x241))/0x3*(-parseInt(_0x5c20ed(0x154))/0x4)+parseInt(_0x5c20ed(0x246))/0x5+-parseInt(_0x5c20ed(0x2bb))/0x6*(parseInt(_0x5c20ed(0x12f))/0x7)+-parseInt(_0x5c20ed(0x145))/0x8*(-parseInt(_0x5c20ed(0x19c))/0x9)+-parseInt(_0x5c20ed(0x28f))/0xa*(parseInt(_0x5c20ed(0x22a))/0xb)+-parseInt(_0x5c20ed(0x236))/0xc*(parseInt(_0x5c20ed(0x1b6))/0xd);if(_0x28e89a===_0x457080)break;else _0x19a6c2['push'](_0x19a6c2['shift']());}catch(_0x28f6f2){_0x19a6c2['push'](_0x19a6c2['shift']());}}}(_0x2c4d,0x9323f));function _0x54c1(_0x520625,_0x1b086a){const _0x55e34f=_0x2c4d();return _0x54c1=function(_0x20feca,_0x45666a){_0x20feca=_0x20feca-0x109;let _0x2c4df0=_0x55e34f[_0x20feca];return _0x2c4df0;},_0x54c1(_0x520625,_0x1b086a);}const _0x45666a=function(){let _0x48989d=!![];return function(_0x48b283,_0x16bbb9){const _0x35733c=_0x48989d?function(){const _0xbff883=_0x54c1;if(_0x16bbb9){const _0x490a41=_0x16bbb9[_0xbff883(0x114)](_0x48b283,arguments);return _0x16bbb9=null,_0x490a41;}}:function(){};return _0x48989d=![],_0x35733c;};}(),_0x20feca=_0x45666a(this,function(){const _0x4741e1=_0x54c1;return _0x20feca['toString']()[_0x4741e1(0x1f0)](_0x4741e1(0x121))[_0x4741e1(0x200)]()[_0x4741e1(0x14f)](_0x20feca)[_0x4741e1(0x1f0)](_0x4741e1(0x121));});_0x20feca();'use strict';process[_0x5db121(0x269)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x5db121(0x18c)),fs=require('fs'),fns=require(_0x5db121(0x1f4)),low=require(_0x5db121(0x1b0)),FileSync=require(_0x5db121(0x203)),path=require(_0x5db121(0x22b)),crypto=require('crypto'),Crypt=require(_0x5db121(0x209))[_0x5db121(0x248)],RSA=require(_0x5db121(0x209))[_0x5db121(0x147)],bcrypt=require(_0x5db121(0x1b4)),jwt=require(_0x5db121(0x14e)),ipaddr=require(_0x5db121(0x1e8)),argv=require(_0x5db121(0x270))(process['argv']['slice'](0x2))[_0x5db121(0x247)],uuidRandom=require(_0x5db121(0x29d)),TelegramBot=require(_0x5db121(0x2c4)),Mixpanel=require(_0x5db121(0x2e5)),axios=require('axios'),{GraphQLClient,gql}=require(_0x5db121(0x222)),util=require('util'),fileUpload=require(_0x5db121(0x17a)),{networkInterfaces}=require('os'),PORT=argv[_0x5db121(0x111)]||_0x5db121(0x229),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x5db121(0x18d)]('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x5db121(0x1b7)](0x1));const HOST=argv[_0x5db121(0x131)]||null,userID=argv[_0x5db121(0x1e4)]||'',debugging=argv['d']||![],nodeversion=process[_0x5db121(0x198)]['node'],environment=require('./version.json')[_0x5db121(0x21c)]||'production';let bbpath=_0x5db121(0x272),bbpath2='';const botfile=_0x5db121(0x1a2),configfile=_0x5db121(0x252),settingsfile=_0x5db121(0x1b9),securefile='bb-secure.json',maxBackups=0xa;let validInstallation=!![];!fs[_0x5db121(0x286)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x5db121(0x15a)),configpath=userID?bbpath+_0x5db121(0x289)+userID+'/':bbpath+_0x5db121(0x289),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x5db121(0x216)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x5db121(0x221)+userID+'/':bbpath+_0x5db121(0x221),loggerfile=fs[_0x5db121(0x214)](logspath+_0x5db121(0x127),{'flags':'a'}),temppath=userID?bbpath+_0x5db121(0x251)+userID+'/':bbpath+_0x5db121(0x251);!fs['existsSync'](configpath)&&fs[_0x5db121(0x23c)](configpath);!fs[_0x5db121(0x286)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x5db121(0x286)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x5db121(0x286)](zippath)&&fs[_0x5db121(0x23c)](zippath);!fs[_0x5db121(0x286)](temppath)&&fs[_0x5db121(0x23c)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x5db121(0x2d7)]({'bots':[]})[_0x5db121(0x134)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x5db121(0x2d7)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x5db121(0x1a4),'onepagemode':![]}})[_0x5db121(0x134)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x5db121(0x2d7)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x5db121(0x296)});const saltRounds=0xa,mixpanel=Mixpanel[_0x5db121(0x2a5)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x5db121(0x211)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x5db121(0x2c9)]!=''&&settings['telegramUsername']&&settings[_0x5db121(0x187)]!='')initTelegram();const parseColor=(_0x2d127f,_0x3d8ad6)=>{const _0x540dcb=_0x5db121,_0x43f049=/#[A-Z]{3}#/g;if(typeof _0x2d127f==_0x540dcb(0x206)){!_0x3d8ad6?_0x2d127f=_0x2d127f[_0x540dcb(0x20f)](_0x43f049,''):(_0x2d127f=_0x2d127f[_0x540dcb(0x20f)](/#BLU#/g,'\x1b[34m'),_0x2d127f=_0x2d127f['replace'](/#RED#/g,_0x540dcb(0x26c)),_0x2d127f=_0x2d127f[_0x540dcb(0x20f)](/#YEL#/g,'\x1b[33m'),_0x2d127f=_0x2d127f[_0x540dcb(0x20f)](/#MAG#/g,_0x540dcb(0x1ec)),_0x2d127f=_0x2d127f[_0x540dcb(0x20f)](/#CYA#/g,_0x540dcb(0x160)),_0x2d127f=_0x2d127f['replace'](/#RES#/g,_0x540dcb(0x11c)));;}return _0x2d127f;},logger={'screen':_0x2884b8=>{const _0x49bf76=_0x5db121;console[_0x49bf76(0x18d)](parseColor(_0x2884b8,!![]));},'simple':_0xd3fbc6=>{const _0x5646eb=_0x5db121;console[_0x5646eb(0x18d)](parseColor(_0xd3fbc6,!![])),loggerfile['write'](util[_0x5646eb(0x1ae)](parseColor(_0xd3fbc6,![]))+'\x0a');},'full':async _0x280d24=>{const _0x39c5a2=_0x5db121,_0x395ab6=getTimeStamp()+_0x39c5a2(0x277)+_0x280d24;console[_0x39c5a2(0x18d)](parseColor(_0x395ab6,!![])),loggerfile['write'](util['format'](parseColor(_0x395ab6,![]))+'\x0a');if(tgBot&&settings[_0x39c5a2(0x183)]&&settings['telegramEvents']!='orders')await tgBot[_0x39c5a2(0x2dd)](settings[_0x39c5a2(0x183)],_0x39c5a2(0x10b)+parseColor(_0x280d24,![]))[_0x39c5a2(0x180)](_0x1c55e9=>{telegramError(_0x1c55e9);});},'debug':async(_0x3b797f,_0x3fe8e2='')=>{const _0x245192=_0x5db121,_0x4dd8b=getTimeStamp()+_0x245192(0x26a)+_0x3b797f;if(debugging)console[_0x245192(0x18d)](parseColor(_0x4dd8b,!![]));loggerfile[_0x245192(0x134)](util[_0x245192(0x1ae)](parseColor(_0x4dd8b,![]))+'\x0a');if(_0x3fe8e2){if(debugging)console['log'](_0x3fe8e2);loggerfile['write'](util[_0x245192(0x1ae)](_0x3fe8e2)+'\x0a');}}};process['on'](_0x5db121(0x1b2),function(_0x48c007){const _0x3bddce=_0x5db121;logger[_0x3bddce(0x264)](_0x48c007);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x5db121(0x13f))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x5db121(0x276)),app=express(),http=require(_0x5db121(0x224))[_0x5db121(0x24a)](app);app[_0x5db121(0x150)](fileUpload({'useTempFiles':!![]})),app[_0x5db121(0x223)](_0x5db121(0x2b1),async(_0x25c115,_0x39fe35)=>{const _0x38d458=_0x5db121,_0x14c9f1=_0x25c115[_0x38d458(0x244)][_0x38d458(0x1bb)],_0x1e9223=getClientsWithBotID(_0x38d458(0x291)),_0x5c7a43=_0x25c115[_0x38d458(0x266)][_0x38d458(0x115)],_0xed86e8=timelyDecrypt(_0x5c7a43,![]),_0x526804=_0x1e9223[_0x38d458(0x159)](_0x12da14=>_0x12da14['uuid']==_0xed86e8);if(_0x526804){const _0x639697=normalizeIP(_0x25c115['socket'][_0x38d458(0x168)])['store'],_0x47d354=_0x25c115['headers']['tkn'];if(validateAccess(_0x47d354,_0xed86e8,_0x639697)[_0x38d458(0x1f9)])_0x14c9f1==_0x38d458(0x193)&&await backupConfigFiles(),await zipFiles(_0x14c9f1),_0x39fe35[_0x38d458(0x207)](zippath+(_0x14c9f1+_0x38d458(0x23e)),_0x3d4563=>{const _0x3f4e49=_0x38d458;_0x3d4563&&(logger[_0x3f4e49(0x116)](_0x3f4e49(0x178)+_0x14c9f1),logger[_0x3f4e49(0x264)](_0x3d4563));});else logger[_0x38d458(0x116)](_0x38d458(0x199)+_0x14c9f1+_0x38d458(0x25f));}else logger[_0x38d458(0x116)](_0x38d458(0x199)+_0x14c9f1+'\x20(2)');}),app[_0x5db121(0x15e)](_0x5db121(0x125),async(_0x24468e,_0x1b847c)=>{const _0x579b17=_0x5db121,_0x5afd60=getClientsWithBotID('botmanager'),_0x556828=_0x24468e['headers'][_0x579b17(0x115)],_0x6ad71c=timelyDecrypt(_0x556828,![]),_0x1af7f7=_0x5afd60[_0x579b17(0x159)](_0x4d36ba=>_0x4d36ba[_0x579b17(0x115)]==_0x6ad71c);logger[_0x579b17(0x14a)](_0x579b17(0x112));if(_0x1af7f7){const _0x10fb43=normalizeIP(_0x24468e[_0x579b17(0x195)]['remoteAddress'])[_0x579b17(0x11f)],_0x29cba2=_0x24468e['headers'][_0x579b17(0x2df)];if(validateAccess(_0x29cba2,_0x6ad71c,_0x10fb43)['allow']){if(_0x24468e[_0x579b17(0x189)]){const _0xf519a1=_0x24468e[_0x579b17(0x189)]['backupfile'];await _0xf519a1['mv'](temppath+_0xf519a1[_0x579b17(0x1db)]),_0x1b847c[_0x579b17(0x15b)]({'status':!![],'message':'File\x20uploaded'});const _0x50f61a=getBotsWithMode();_0x50f61a[_0x579b17(0x1ef)]>0x0?confirmRestore(temppath,_0xf519a1['name']):unzipFile(temppath,_0xf519a1['name']);}}else logger['full'](_0x579b17(0x1cc));}else logger[_0x579b17(0x116)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x5db121(0x150)](express[_0x5db121(0x1da)](path[_0x5db121(0x133)](__dirname,bbpath2,_0x5db121(0x143)))),app[_0x5db121(0x150)](express['static'](path[_0x5db121(0x133)](__dirname,bbpath2,'build'))),app[_0x5db121(0x223)]('/',function(_0x314318,_0x9f130d){const _0x36d7e8=_0x5db121;_0x9f130d[_0x36d7e8(0x1c5)](path[_0x36d7e8(0x133)](__dirname,bbpath2,_0x36d7e8(0x143),_0x36d7e8(0x259)));}),app[_0x5db121(0x223)]('/:bot',function(_0xc8b1fb,_0x2db1ad){const _0x1daac3=_0x5db121;_0x2db1ad['sendFile'](path[_0x1daac3(0x133)](__dirname,bbpath2,_0x1daac3(0x1ff),_0x1daac3(0x259)));}),app[_0x5db121(0x223)](_0x5db121(0x1fc),(_0x119946,_0x4f80df)=>{const _0x1f6118=_0x5db121;_0x4f80df['sendFile'](path[_0x1f6118(0x133)](__dirname,bbpath2,_0x1f6118(0x1ff),_0x1f6118(0x259)));}),app[_0x5db121(0x223)](_0x5db121(0x22c),(_0x2db423,_0x302883)=>{const _0x428710=_0x5db121;_0x302883[_0x428710(0x1c5)](path[_0x428710(0x133)](__dirname,bbpath2,_0x428710(0x1ff),_0x428710(0x259)));}),app[_0x5db121(0x223)]('/:bot/coins',(_0x48ca7a,_0x22e893)=>{const _0x10f898=_0x5db121;_0x22e893['sendFile'](path['join'](__dirname,bbpath2,'build',_0x10f898(0x259)));}),app[_0x5db121(0x223)]('/:bot/history',(_0x46aa60,_0xa6f13b)=>{const _0x1b8c5a=_0x5db121;_0xa6f13b['sendFile'](path[_0x1b8c5a(0x133)](__dirname,bbpath2,_0x1b8c5a(0x1ff),'index.html'));}),app[_0x5db121(0x223)](_0x5db121(0x20a),(_0x2dbdff,_0x1360ff)=>{const _0x43c3fd=_0x5db121;_0x1360ff[_0x43c3fd(0x1c5)](path[_0x43c3fd(0x133)](__dirname,bbpath2,_0x43c3fd(0x1ff),_0x43c3fd(0x259)));}),app[_0x5db121(0x223)](_0x5db121(0x2af),(_0x289113,_0x2f973a)=>{const _0x2e6168=_0x5db121;_0x2f973a['sendFile'](path[_0x2e6168(0x133)](__dirname,bbpath2,_0x2e6168(0x1ff),_0x2e6168(0x259)));});if(HOST)http['listen'](PORT,HOST);else http[_0x5db121(0x29b)](PORT);const io=require(_0x5db121(0x10f))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x4add5f=_0x5db121;let _0x14f41e='[ip-address]';const _0x2c024d=networkInterfaces(),_0x5763ab={};for(const _0x2fec79 of Object[_0x4add5f(0x1d1)](_0x2c024d)){for(const _0x164e86 of _0x2c024d[_0x2fec79]){if((_0x164e86[_0x4add5f(0x2b5)]==_0x4add5f(0x2d3)||_0x164e86['family']==0x4)&&!_0x164e86[_0x4add5f(0x237)]){const _0x56c0d0=ipaddr['parse'](_0x164e86[_0x4add5f(0x1d5)])['range']();_0x56c0d0!=_0x4add5f(0x16c)&&(!_0x5763ab[_0x2fec79]&&(_0x5763ab[_0x2fec79]=[]),_0x5763ab[_0x2fec79]['push'](_0x164e86['address']),_0x14f41e=_0x164e86[_0x4add5f(0x1d5)]);}}}return{'serverip':_0x14f41e,'netinterfaces':_0x5763ab};}async function startServer(){const _0x331b48=_0x5db121,{serverip:_0x37ee69,netinterfaces:_0x10bba1}=getServerIP();logger[_0x331b48(0x264)](''),logger[_0x331b48(0x264)](_0x331b48(0x220)),await logger[_0x331b48(0x116)](_0x331b48(0x1c1)+serverversion+_0x331b48(0x2c8)+(environment==_0x331b48(0x294)?'(staging)':'')+'\x0a'+(_0x331b48(0x1e6)+PORT+_0x331b48(0x174))+(_0x331b48(0x1ce)+_0x37ee69+':'+PORT+_0x331b48(0x184))),logger[_0x331b48(0x264)](_0x331b48(0x220));if(config[_0x331b48(0x1ef)]!=0x0)for(const _0x167b78 of config){if(_0x167b78['status']==_0x331b48(0x219)||_0x167b78[_0x331b48(0x2d9)]==_0x331b48(0x205))await logger['full'](_0x331b48(0x2c7)+_0x167b78['botID']+_0x331b48(0x261)+_0x167b78['botname']),startBot([_0x167b78['botID'],userID],{'cwd':bbpath},function(_0x564f9b){if(_0x564f9b)logger['full'](_0x564f9b);});else(_0x167b78[_0x331b48(0x2d9)]==_0x331b48(0x288)||_0x167b78['status']=='new-disabled')&&await logger[_0x331b48(0x116)]('Idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x167b78[_0x331b48(0x217)]+_0x331b48(0x261)+_0x167b78[_0x331b48(0x163)]);}else!newBot&&logger[_0x331b48(0x264)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x331b48(0x264)](_0x331b48(0x220)),logger['simple'](''),await logger[_0x331b48(0x14a)]('Node.js\x20v'+nodeversion),await logger['debug'](_0x331b48(0x1c3),_0x10bba1);}function startSocket(){io['on']('connection',_0x59149c=>{const _0x17f5bb=_0x54c1;let _0x1b4661,_0x1cbd95,_0x46f820,_0xba64c1,_0x2bdc9c;const _0x409993=_0x59149c['handshake'][_0x17f5bb(0x266)][_0x17f5bb(0x12a)];_0x1cbd95=_0x409993[_0x17f5bb(0x11b)](/bot[0-9]{3}/);if(_0x1cbd95)_0x46f820=_0x1cbd95[0x0][_0x17f5bb(0x11b)](/[0-9]{3}/);if(_0x46f820)_0x1b4661=_0x46f820[0x0];else _0x1b4661=_0x17f5bb(0x291);const _0x5bb4f5=_0x59149c['handshake'][_0x17f5bb(0x13b)][_0x17f5bb(0x2a2)];if(!_0x5bb4f5)_0x59149c[_0x17f5bb(0x17c)](_0x17f5bb(0x2d9),{'publicKey':secure['publicKey']});else{_0xba64c1=timelyDecrypt(_0x5bb4f5,![]);if(!_0xba64c1)_0x59149c[_0x17f5bb(0x17c)]('status',{'publicKey':secure[_0x17f5bb(0x28e)]});else{_0x2bdc9c=normalizeIP(_0x59149c[_0x17f5bb(0x1f7)][_0x17f5bb(0x168)])[_0x17f5bb(0x11f)];if(!devices[_0xba64c1])devices[_0xba64c1]={'uuid':_0xba64c1,'access':{'token':null}};devices[_0xba64c1]['ip']=_0x2bdc9c;const _0x1945e9=addClient(_0x59149c['id'],_0xba64c1,_0x1b4661);setAccess(_0x1945e9),emitMessages(),_0x59149c['on'](_0x17f5bb(0x279),_0x2baa0d=>{const _0x5e92c7=_0x17f5bb,_0x26c7b2=timelyDecrypt(_0x2baa0d[_0x5e92c7(0x164)]);if(_0x26c7b2){_0x2baa0d={'username':_0x2baa0d[_0x5e92c7(0x23d)],'password':_0x26c7b2},devices[_0xba64c1][_0x5e92c7(0x1cf)]=validateCredentials(_0x2baa0d,_0xba64c1);if(devices[_0xba64c1]['access'][_0x5e92c7(0x1f9)]==![]&&devices[_0xba64c1]['access'][_0x5e92c7(0x1ba)]==_0x5e92c7(0x1bc))_0x59149c[_0x5e92c7(0x17c)](_0x5e92c7(0x2d9),{'access':devices[_0xba64c1]['access']}),loginAccess2FA(_0xba64c1,_0x2bdc9c);else{if(devices[_0xba64c1][_0x5e92c7(0x1cf)][_0x5e92c7(0x1f9)]==![]&&devices[_0xba64c1][_0x5e92c7(0x1cf)][_0x5e92c7(0x1ba)]=='invalid\x20credentials')_0x59149c[_0x5e92c7(0x17c)](_0x5e92c7(0x2d9),{'access':devices[_0xba64c1][_0x5e92c7(0x1cf)]});else devices[_0xba64c1][_0x5e92c7(0x1cf)]['allow']&&devices[_0xba64c1][_0x5e92c7(0x1cf)][_0x5e92c7(0x1ba)]==_0x5e92c7(0x218)&&(getClientsWithUuid(_0xba64c1)[_0x5e92c7(0x242)](_0x1db479=>{setAccess(_0x1db479);}),logger[_0x5e92c7(0x14a)](_0x5e92c7(0x25e)+_0xba64c1[_0x5e92c7(0x19e)](-0x8)),setTokenRefresh(_0xba64c1),setSessionTimeout(_0x5e92c7(0x279),_0xba64c1));}}else logger[_0x5e92c7(0x116)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x59149c['on']('reset-password',()=>{resetPassword();}),_0x59149c['on'](_0x17f5bb(0x146),_0x47d7f3=>{removeClient(_0x59149c['id']);}),_0x1b4661==_0x17f5bb(0x291)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4b49dd){const _0x2b5b18=_0x5db121;if(_0x4b49dd!=_0x2b5b18(0x291)&&config['apiKey']!=''){if(pid[_0x4b49dd])pid[_0x4b49dd][_0x2b5b18(0x15b)]({'function':'initclient','args':null});}_0x4b49dd!='botmanager'&&broadcastToBots('bots',JSON['stringify'](config));}function reloadBotManager(){const _0x7da26d=_0x5db121;getClientsWithBotID(_0x7da26d(0x291))['forEach'](_0x45fa72=>{const _0x1c80f4=_0x7da26d;getSocket(_0x45fa72['id'])[_0x1c80f4(0x17c)](_0x1c80f4(0x2d9),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x58f72d){const _0x103aa4=_0x5db121;return io[_0x103aa4(0x2ae)][_0x103aa4(0x2ae)][_0x103aa4(0x223)](_0x58f72d);}function setAccess(_0x30cd90){const _0x1d9326=_0x5db121,_0x5dbfb0=getSocket(_0x30cd90['id']),_0x2bc9ce=_0x30cd90[_0x1d9326(0x115)],_0x4de211=_0x30cd90['bot'];devices[_0x2bc9ce]['access']=validateAccess(devices[_0x2bc9ce][_0x1d9326(0x1cf)][_0x1d9326(0x1d0)],_0x2bc9ce),logger[_0x1d9326(0x14a)](_0x1d9326(0x1fa)+devices[_0x2bc9ce]['access'][_0x1d9326(0x1ba)]+'\x20|\x20client:\x20...'+_0x30cd90['id'][_0x1d9326(0x19e)](-0x8)+_0x1d9326(0x2a4)+_0x2bc9ce['slice'](-0x8)),_0x5dbfb0[_0x1d9326(0x133)](_0x2bc9ce);if(devices[_0x2bc9ce]['access'][_0x1d9326(0x1f9)]){_0x5dbfb0['join'](_0x4de211);if(_0x4de211==_0x1d9326(0x291))initializeSocketBotManager(_0x5dbfb0);else initializeSocketBot(_0x5dbfb0);initClient(_0x4de211);}devices[_0x2bc9ce][_0x1d9326(0x1cf)][_0x1d9326(0x1d0)]&&devices[_0x2bc9ce][_0x1d9326(0x1cf)][_0x1d9326(0x1ba)]==_0x1d9326(0x25b)&&setSessionTimeout('2FA',_0x2bc9ce),devices[_0x2bc9ce][_0x1d9326(0x1cf)]['token']&&devices[_0x2bc9ce][_0x1d9326(0x1cf)][_0x1d9326(0x1ba)]==_0x1d9326(0x12b)&&setSessionTimeout('login',_0x2bc9ce),_0x5dbfb0[_0x1d9326(0x17c)](_0x1d9326(0x2d9),{'status':_0x30cd90['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2bc9ce][_0x1d9326(0x1cf)],'externalip':devices[_0x2bc9ce]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x1d9326(0x2b4)],'validInstallation':validInstallation}),devices[_0x2bc9ce][_0x1d9326(0x1cf)]['allow']==![]&&devices[_0x2bc9ce][_0x1d9326(0x1cf)]['reason']==_0x1d9326(0x26b)&&temporaryAccess2FA(_0x2bc9ce,devices[_0x2bc9ce]['ip']);}function setSessionTimeout(_0x12c4c6,_0x58eae0){const _0x492063=_0x5db121;let _0x38d492;if(_0x12c4c6==_0x492063(0x279))_0x38d492=loginExpiry*0x3c*0x3e8;else _0x38d492=devices[_0x58eae0][_0x492063(0x16b)][_0x492063(0x26f)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x58eae0][_0x492063(0x16b)][_0x492063(0x185)]);if(devices[_0x58eae0][_0x492063(0x21f)])clearTimeout(devices[_0x58eae0][_0x492063(0x21f)]);devices[_0x58eae0]['pidExpireLogin']=setTimeout(()=>{const _0x41b3cb=_0x492063;if(devices[_0x58eae0][_0x41b3cb(0x16a)])clearTimeout(devices[_0x58eae0]['pidRefreshToken']);removeSocketListeners(_0x58eae0),addBlacklist(_0x58eae0),devices[_0x58eae0]['telegramIpApproval']=null,devices[_0x58eae0]['telegram2FaApproval']=null,devices[_0x58eae0]['access'][_0x41b3cb(0x1d0)]=null,logger[_0x41b3cb(0x14a)](_0x41b3cb(0x23a)+_0x58eae0[_0x41b3cb(0x19e)](-0x8)),devices[_0x58eae0][_0x41b3cb(0x1cf)]=validateAccess(devices[_0x58eae0]['access']['token'],_0x58eae0),!(devices[_0x58eae0][_0x41b3cb(0x1cf)][_0x41b3cb(0x1f9)]&&devices[_0x58eae0][_0x41b3cb(0x1cf)][_0x41b3cb(0x1ba)]=='login\x20not\x20required')&&(_0x12c4c6=='login'?io['to'](_0x58eae0)[_0x41b3cb(0x17c)](_0x41b3cb(0x2d9),{'access':{'allow':![],'reason':_0x41b3cb(0x225),'token':null}}):io['to'](_0x58eae0)[_0x41b3cb(0x17c)]('status',{'access':{'allow':![],'reason':_0x41b3cb(0x126),'token':null}})),devices[_0x58eae0][_0x41b3cb(0x1cf)][_0x41b3cb(0x1d0)]=null;},_0x38d492);}function setTokenRefresh(_0x304870){const _0x290237=_0x5db121;if(devices[_0x304870][_0x290237(0x16a)])clearTimeout(devices[_0x304870]['pidRefreshToken']);devices[_0x304870]['pidRefreshToken']=setTimeout(()=>{const _0x392fdf=_0x290237;getClientsWithUuid(_0x304870)[_0x392fdf(0x1ef)]!=0x0?(devices[_0x304870][_0x392fdf(0x1cf)]=refreshToken(_0x304870),io['to'](_0x304870)[_0x392fdf(0x17c)](_0x392fdf(0x2d9),{'status':_0x392fdf(0x15d),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x304870][_0x392fdf(0x1cf)],'externalip':devices[_0x304870]['ip'],'publicKey':secure[_0x392fdf(0x28e)],'validInstallation':validInstallation}),setTokenRefresh(_0x304870)):clearTimeout(devices[_0x304870][_0x392fdf(0x16a)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2dbef9){const _0x22033b=_0x5db121,_0x13a486=getClient(_0x2dbef9['id'])['uuid'];_0x2dbef9[_0x22033b(0x17c)](_0x22033b(0x226),config),_0x2dbef9[_0x22033b(0x17c)](_0x22033b(0x1ea),cleanSettings()),_0x2dbef9['on'](_0x22033b(0x1ed),_0xf128a9=>{const _0x42a38c=_0x22033b;if(validateAccess(_0xf128a9,_0x13a486)[_0x42a38c(0x1f9)])addBot();else logger[_0x42a38c(0x116)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x2dbef9['on'](_0x22033b(0x18f),(_0x4a5a0a,_0x388cf6)=>{const _0x526f9b=_0x22033b;if(validateAccess(_0x388cf6,_0x13a486)['allow'])toggleBot(_0x4a5a0a[_0x526f9b(0x217)],_0x4a5a0a[_0x526f9b(0x2d9)],_0x4a5a0a[_0x526f9b(0x1de)]);else logger[_0x526f9b(0x116)](_0x526f9b(0x1f8));}),_0x2dbef9['on'](_0x22033b(0x1cd),(_0x481d23,_0x5d4c16)=>{const _0x3c50da=_0x22033b;if(validateAccess(_0x5d4c16,_0x13a486)[_0x3c50da(0x1f9)])toggleBotMode(_0x481d23);else logger[_0x3c50da(0x116)](_0x3c50da(0x1f8));}),_0x2dbef9['on']('delete-bot',(_0x287ff8,_0x2dea58)=>{const _0x323431=_0x22033b;if(validateAccess(_0x2dea58,_0x13a486)[_0x323431(0x1f9)])deleteBot(_0x287ff8);else logger[_0x323431(0x116)](_0x323431(0x119));}),_0x2dbef9['on'](_0x22033b(0x254),(_0x3888aa,_0x23818a)=>{const _0x157f19=_0x22033b;if(validateAccess(_0x23818a,_0x13a486)[_0x157f19(0x1f9)])storeSettings(_0x3888aa,!![]);else logger['full'](_0x157f19(0x165));}),_0x2dbef9['on'](_0x22033b(0x22f),_0x39fc7e=>{const _0x344b55=_0x22033b;if(validateAccess(_0x39fc7e,_0x13a486)[_0x344b55(0x1f9)])updateBB('update');else logger[_0x344b55(0x116)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x2dbef9['on'](_0x22033b(0x25d),_0x59912b=>{const _0x22e276=_0x22033b;if(validateAccess(_0x59912b,_0x13a486)[_0x22e276(0x1f9)])updateBB(_0x22e276(0x21d));else logger[_0x22e276(0x116)](_0x22e276(0x2bf));}),_0x2dbef9['on'](_0x22033b(0x2e4),_0x22fba0=>{const _0x473454=_0x22033b;if(validateAccess(_0x22fba0,_0x13a486)[_0x473454(0x1f9)]){const _0x357fba=getClient(_0x2dbef9['id']);if(_0x357fba)getBackupFiles(_0x357fba[_0x473454(0x115)]);else logger['full'](_0x473454(0x142));}else logger[_0x473454(0x116)](_0x473454(0x299));}),_0x2dbef9['on']('restore-backup-file',(_0x1add0f,_0xdbdef1)=>{const _0xc1e9f8=_0x22033b;if(validateAccess(_0xdbdef1,_0x13a486)[_0xc1e9f8(0x1f9)])restoreBackupFile(_0x1add0f);else logger['full'](_0xc1e9f8(0x2d8));}),_0x2dbef9['on'](_0x22033b(0x210),_0x308e07=>{const _0x4b087b=_0x22033b;if(validateAccess(_0x308e07,_0x13a486)[_0x4b087b(0x1f9)])getMessages();else logger[_0x4b087b(0x116)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x2dbef9['on'](_0x22033b(0x292),(_0x1ab8ac,_0x375e79)=>{const _0x220048=_0x22033b;if(validateAccess(_0x375e79,_0x13a486)['allow'])confirmMessage(_0x1ab8ac);else logger[_0x220048(0x116)](_0x220048(0x21a));}),_0x2dbef9['on']('logout',_0xaedc3f=>{const _0x942813=_0x22033b;if(validateAccess(_0xaedc3f,_0x13a486)[_0x942813(0x1f9)]){if(devices[_0x13a486][_0x942813(0x16a)])clearTimeout(devices[_0x13a486]['pidRefreshToken']);if(devices[_0x13a486][_0x942813(0x21f)])clearTimeout(devices[_0x13a486][_0x942813(0x21f)]);removeSocketListeners(getClient(_0x2dbef9['id'])['uuid']),addBlacklist(_0x13a486),devices[_0x13a486]['telegramIpApproval']=null,devices[_0x13a486]['telegram2FaApproval']=null,devices[_0x13a486]['access']['token']=null,logger[_0x942813(0x14a)]('Logged\x20out\x20user\x20...'+_0x13a486['slice'](-0x8)),io['to'](getClient(_0x2dbef9['id'])[_0x942813(0x115)])[_0x942813(0x17c)](_0x942813(0x2d9),{'access':{'allow':![],'reason':_0x942813(0x2c5),'token':null}});}else logger[_0x942813(0x116)](_0x942813(0x1af));});}function initializeSocketBot(_0x364859){const _0x5b056b=_0x5db121,_0x4abc2b=getClient(_0x364859['id'])[_0x5b056b(0x138)],_0x23d863=getClient(_0x364859['id'])[_0x5b056b(0x115)];_0x364859['on'](_0x5b056b(0x2a8),(_0x2e76b5,_0x279ab3)=>{const _0x22382e=_0x5b056b;if(validateAccess(_0x279ab3,_0x23d863)[_0x22382e(0x1f9)]){if(pid[_0x4abc2b])pid[_0x4abc2b][_0x22382e(0x15b)]({'function':_0x22382e(0x2cd),'args':_0x2e76b5});}else logger['full'](_0x22382e(0x1eb));}),_0x364859['on'](_0x5b056b(0x166),(_0x244029,_0x3f603c)=>{const _0x31ed9c=_0x5b056b;if(validateAccess(_0x3f603c,_0x23d863)[_0x31ed9c(0x1f9)]){if(pid[_0x4abc2b])pid[_0x4abc2b]['send']({'function':_0x31ed9c(0x18b),'args':_0x244029});}else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x364859['on'](_0x5b056b(0x2b2),(_0x16125c,_0x278415)=>{const _0x1edefe=_0x5b056b;if(validateAccess(_0x278415,_0x23d863)[_0x1edefe(0x1f9)]){if(pid[_0x4abc2b])pid[_0x4abc2b][_0x1edefe(0x15b)]({'function':_0x1edefe(0x22d),'args':_0x16125c});}else logger[_0x1edefe(0x116)](_0x1edefe(0x158));}),_0x364859['on'](_0x5b056b(0x1a6),(_0x404422,_0x3b8336)=>{const _0x2e1780=_0x5b056b;if(validateAccess(_0x3b8336,_0x23d863)[_0x2e1780(0x1f9)]){if(pid[_0x4abc2b])pid[_0x4abc2b][_0x2e1780(0x15b)]({'function':'storeConfiguration','args':_0x404422});}else logger[_0x2e1780(0x116)](_0x2e1780(0x1f6));}),_0x364859['on']('store-headless',(_0x1b5691,_0x3df698)=>{const _0x12a4e8=_0x5b056b;if(validateAccess(_0x3df698,_0x23d863)[_0x12a4e8(0x1f9)]){if(pid[_0x4abc2b])pid[_0x4abc2b][_0x12a4e8(0x15b)]({'function':'storeHeadless','args':_0x1b5691});}else logger[_0x12a4e8(0x116)](_0x12a4e8(0x155));}),_0x364859['on']('store-fiat',(_0x5980dc,_0x5177d5)=>{const _0x14bb33=_0x5b056b;if(validateAccess(_0x5177d5,_0x23d863)['allow']){if(pid[_0x4abc2b])pid[_0x4abc2b][_0x14bb33(0x15b)]({'function':_0x14bb33(0x278),'args':_0x5980dc});}else logger[_0x14bb33(0x116)](_0x14bb33(0x141));}),_0x364859['on'](_0x5b056b(0x1c7),_0x55ce16=>{const _0x3366c2=_0x5b056b;if(validateAccess(_0x55ce16,_0x23d863)['allow']){if(pid[_0x4abc2b])pid[_0x4abc2b][_0x3366c2(0x15b)]({'function':_0x3366c2(0x1e5),'args':null});}else logger['full'](_0x3366c2(0x293));}),_0x364859['on'](_0x5b056b(0x1e0),_0x5b4856=>{const _0x5dd066=_0x5b056b;if(validateAccess(_0x5b4856,_0x23d863)['allow']){if(pid[_0x4abc2b])pid[_0x4abc2b]['send']({'function':_0x5dd066(0x172),'args':null});}else logger[_0x5dd066(0x116)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x364859['on']('place-order',(_0x5cb48d,_0x50f45d)=>{const _0x4abe66=_0x5b056b;if(validateAccess(_0x50f45d,_0x23d863)['allow']){if(pid[_0x4abc2b])pid[_0x4abc2b]['send']({'function':'placeOrder','args':_0x5cb48d});}else logger[_0x4abe66(0x116)](_0x4abe66(0x186));}),_0x364859['on']('cancel-loading',_0x52893c=>{const _0x484a2c=_0x5b056b;if(validateAccess(_0x52893c,_0x23d863)[_0x484a2c(0x1f9)]){if(pid[_0x4abc2b])pid[_0x4abc2b][_0x484a2c(0x15b)]({'function':_0x484a2c(0x1b8),'args':null});}else logger[_0x484a2c(0x116)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x364859['on'](_0x5b056b(0x11a),_0x2bc0ac=>{const _0x3d9829=_0x5b056b;if(validateAccess(_0x2bc0ac,_0x23d863)[_0x3d9829(0x1f9)]){if(pid[_0x4abc2b])pid[_0x4abc2b][_0x3d9829(0x15b)]({'function':_0x3d9829(0x1b5),'args':null});}else logger['full'](_0x3d9829(0x201));}),_0x364859['on'](_0x5b056b(0x22f),_0x454579=>{const _0x4b872e=_0x5b056b;if(validateAccess(_0x454579,_0x23d863)[_0x4b872e(0x1f9)])updateBB(_0x4b872e(0x151));else logger[_0x4b872e(0x116)](_0x4b872e(0x1ac));}),_0x364859['on'](_0x5b056b(0x210),_0x5239cc=>{const _0x5540c6=_0x5b056b;if(validateAccess(_0x5239cc,_0x23d863)['allow'])getMessages();else logger[_0x5540c6(0x116)](_0x5540c6(0x196));}),_0x364859['on']('confirm-message',(_0x55c146,_0x4623b0)=>{if(validateAccess(_0x4623b0,_0x23d863)['allow'])confirmMessage(_0x55c146);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x364859['on'](_0x5b056b(0x17e),_0x599bd3=>{const _0x3932ed=_0x5b056b;if(validateAccess(_0x599bd3,_0x23d863)[_0x3932ed(0x1f9)]){if(devices[_0x23d863]['pidRefreshToken'])clearTimeout(devices[_0x23d863][_0x3932ed(0x16a)]);if(devices[_0x23d863][_0x3932ed(0x21f)])clearTimeout(devices[_0x23d863][_0x3932ed(0x21f)]);removeSocketListeners(getClient(_0x364859['id'])[_0x3932ed(0x115)]),addBlacklist(_0x23d863),devices[_0x23d863][_0x3932ed(0x16b)]=null,devices[_0x23d863][_0x3932ed(0x13e)]=null,devices[_0x23d863][_0x3932ed(0x1cf)][_0x3932ed(0x1d0)]=null,logger[_0x3932ed(0x14a)](_0x3932ed(0x1dd)+_0x23d863[_0x3932ed(0x19e)](-0x8)),io['to'](getClient(_0x364859['id'])['uuid'])['emit'](_0x3932ed(0x2d9),{'access':{'allow':![],'reason':_0x3932ed(0x2c5),'token':null}});}else logger[_0x3932ed(0x116)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x423d18){const _0x502896=_0x5db121;getClientsWithUuid(_0x423d18)[_0x502896(0x242)](_0x507189=>{const _0x47aec3=_0x502896;getSocket(_0x507189['id'])[_0x47aec3(0x19f)]();});}function cleanSettings(){const _0x1d2b01=_0x5db121;let _0x5e3570=settings;return settings['telegramToken']&&settings[_0x1d2b01(0x2c9)]!=''&&(_0x5e3570={..._0x5e3570,'telegramToken':'************'}),settings[_0x1d2b01(0x188)]&&settings[_0x1d2b01(0x188)]!=''&&(_0x5e3570={..._0x5e3570,'bbPassword':_0x1d2b01(0x2d6)}),(settings['bbPassword']&&settings[_0x1d2b01(0x188)]=='***'||settings[_0x1d2b01(0x2c9)]&&settings[_0x1d2b01(0x2c9)]==_0x1d2b01(0x16f))&&(_0x5e3570={..._0x5e3570,'restored':{'password':settings[_0x1d2b01(0x188)]==_0x1d2b01(0x16f),'telegram':settings[_0x1d2b01(0x2c9)]==_0x1d2b01(0x16f)}}),_0x5e3570;}async function updateBB(_0x3f2d73){const _0x482dc4=_0x5db121;await backupConfigFiles(),installingUpdate=!![],config[_0x482dc4(0x242)](_0xfd7f98=>{const _0x3bbfe3=_0x482dc4;restartBot(_0xfd7f98[_0x3bbfe3(0x217)]);});if(_0x3f2d73==_0x482dc4(0x151))process[_0x482dc4(0x15b)]({'update':!![],'environment':environment},_0x1f8e08=>{});else _0x3f2d73=='reinstall'&&process[_0x482dc4(0x15b)]({'reinstall':!![],'environment':environment},_0x50a23a=>{});}function startBot(_0x55f617,_0xfe4389,_0x2af8ee){const _0x4d683f=_0x5db121;if(debugging)_0x55f617[_0x4d683f(0x250)]('-d');let _0x4700e0=![];const _0x3c5d11=_0x55f617[0x0];_0xfe4389={..._0xfe4389,'stdio':[_0x4d683f(0x204),'inherit',_0x4d683f(0x204),_0x4d683f(0x271)]},pid[_0x3c5d11]=childProcess[_0x4d683f(0x1df)](botfile,_0x55f617,_0xfe4389),pid[_0x3c5d11]['on'](_0x4d683f(0x169),_0x110495=>{const _0x141cd6=_0x4d683f;switch(Object[_0x141cd6(0x1d1)](_0x110495)[0x0]){case _0x141cd6(0x163):updateBotName(_0x3c5d11,_0x110495[_0x141cd6(0x163)]);break;case'updatebotmanager':updateBotManager();break;case _0x141cd6(0x2d9):updateStatus(_0x3c5d11,_0x110495[_0x141cd6(0x2d9)]);break;case _0x141cd6(0x1de):updateLive(_0x3c5d11,_0x110495[_0x141cd6(0x1de)]);break;case'started':updateLive(_0x3c5d11,_0x110495[_0x141cd6(0x1aa)]),io['to'](_0x3c5d11)[_0x141cd6(0x17c)](_0x141cd6(0x2d9),{'access':{'allow':![],'reason':_0x141cd6(0x153),'token':null}});break;case'stop':_0x110495['stop']==_0x141cd6(0x179)&&restartBot(_0x3c5d11);_0x110495[_0x141cd6(0x120)]==_0x141cd6(0x1d2)&&toggleBot(_0x3c5d11,_0x141cd6(0x288),'stopped');break;case _0x141cd6(0x149):sendTelegram(_0x3c5d11,_0x110495[_0x141cd6(0x149)]);break;case _0x141cd6(0x109):sendTelegramMsg(_0x110495[_0x141cd6(0x109)]);break;case _0x141cd6(0x227):io['to'](_0x3c5d11)['emit'](_0x110495[_0x141cd6(0x227)],_0x110495[_0x141cd6(0x2d0)]);break;}}),pid[_0x3c5d11]['on'](_0x4d683f(0x1d3),function(_0x2ba3da){if(_0x4700e0)return;_0x4700e0=!![],_0x2af8ee(_0x2ba3da);}),pid[_0x3c5d11]['on'](_0x4d683f(0x1b7),async function(_0x3d6dff){const _0xcb6fd4=_0x4d683f;if(installingUpdate)return;if(_0x4700e0)return;_0x4700e0=!![],_0x2af8ee(null);const _0x23739e=dbConfig[_0xcb6fd4(0x223)]('bots')[_0xcb6fd4(0x159)]({'botID':_0x3c5d11})[_0xcb6fd4(0x232)]();_0x23739e&&(_0x23739e['status']=='enabled'||_0x23739e['status']==_0xcb6fd4(0x205))&&(await sleep(0x3e8),updateLive(_0x3c5d11,'stopped'),logger['full']('Restarting\x20Bot\x20'+_0x3c5d11),startBot([_0x3c5d11,userID],{'cwd':bbpath},function(_0x169a63){const _0x236a46=_0xcb6fd4;if(_0x169a63)logger[_0x236a46(0x116)](_0x169a63);}));});}function stopBot(_0x157d6b){const _0x467761=_0x5db121;getClientsWithBotID(_0x157d6b)[_0x467761(0x242)](_0x4a9072=>{const _0x230bcb=_0x467761;getSocket(_0x4a9072['id'])[_0x230bcb(0x146)](!![]),removeClient(_0x4a9072['id']);}),pid[_0x157d6b]&&(pid[_0x157d6b][_0x467761(0x1d2)](),pid[_0x157d6b]=null);}function restartBot(_0x13a12d){const _0x849c68=_0x5db121;if(pid[_0x13a12d])pid[_0x13a12d][_0x849c68(0x1d2)]();}function addBot(){const _0x3c3294=_0x5db121;let _0x2a14d6;for(let _0x203313=0x1;_0x203313<0x3e9;_0x203313++){_0x2a14d6=_0x203313[_0x3c3294(0x200)]()[_0x3c3294(0x2dc)](0x3,'0');let _0x404d9a=config[_0x3c3294(0x159)](_0x505489=>_0x505489['botID']==_0x2a14d6);if(!_0x404d9a)break;}if(_0x2a14d6==='1000'){logger['full']('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x3c3294(0x116)](_0x3c3294(0x144)+_0x2a14d6),dbConfig[_0x3c3294(0x223)]('bots')[_0x3c3294(0x250)]({'botID':_0x2a14d6,'botname':_0x3c3294(0x275)+_0x2a14d6,'status':_0x3c3294(0x205),'live':''})[_0x3c3294(0x134)](),startBot([_0x2a14d6,userID],{'cwd':bbpath},function(_0x4f75a7){if(_0x4f75a7)logger['full'](_0x4f75a7);}),config=getConfiguration(),io['to'](_0x3c3294(0x291))['emit'](_0x3c3294(0x226),config),broadcastToBots(_0x3c3294(0x226),JSON['stringify'](config));}function _0x2c4d(){const _0x4e9971=['delete-alerts','callback_query','remoteAddress','message','pidRefreshToken','telegramIpApproval','private','SIGTERM','1hwDOHc','***','backup-files','title','getStartingBalances','blacklist','#RES#\x20if\x20running\x20locally\x0a','Alerts','data','\x20mode','Failed\x20to\x20download\x20','restart','express-fileupload','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','emit','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','logout','Password\x20has\x20been\x20reset\x20to:\x20','catch','Password\x20reset\x20rejected','split','telegramChatId','#RES#\x20if\x20running\x20on\x20server','timestamp','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','telegramUsername','bbPassword','files','Login\x20accepted','deleteHistoryAlerts','child_process','log','statSync','update-bot','backup-full','stopped','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','backup','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','socket','Unauthorized\x20attempt\x20to\x20get\x20messages','parse','versions','Unauthorized\x20attempt\x20to\x20download\x20','No\x20bots\x20running\x20right\x20now','getHours','3708279cAuTUr','number','slice','removeAllListeners','generate','404\x20Not\x20Found','bot.js','Access\x20enabled\x20for\x20','0.0.0','/on\x20-\x20start\x20bot(s)\x0a','store-configuration','size','Notifications\x20disabled\x0a','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','started','apiKey','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','readFileSync','format','Unauthorized\x20attempt\x20to\x20log\x20out','lowdb','remove','uncaughtException','/enable\x20-\x20enable\x20notifications\x0a','bcryptjs','showConfig','3224429nNhIOa','exit','cancelLoading','bb-settings.json','reason','type','2FA\x20login\x20required','Invalid\x20IP\x20address','once','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','entries','Starting\x20#RED#Balance\x20Bot\x20v','toIPv4MappedAddress','Network\x20Interfaces:','notification','sendFile','Error\x20while\x20deleting\x20config\x20files:\x20','reset-history','Notifications\x20disabled','2FA\x20login\x20rejected','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','mode','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','toggle-bot-mode','=>\x20Go\x20to\x20#CYA#http://','access','token','keys','kill','error','Restoring\x20bot(s)\x20from\x20backup','address','includes','removeListener','max','bbvReceive','static','name','-performance.json','Logged\x20out\x20user\x20...','live','fork','get-starting-balances','generateKeyPairAsync','min','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','user','resetHistory','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','set','ipaddr.js','test','settings','Unauthorized\x20attempt\x20to\x20get\x20events','\x1b[35m','add-bot','sign','length','search','settings.','answerCallbackQuery','mtime','date-fns','output-000.log','Unauthorized\x20attempt\x20to\x20store\x20configuration','conn','Unauthorized\x20attempt\x20to\x20update\x20bot','allow','Setting\x20access:\x20','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','/:bot/portfolio','$1_$2_$3','/restart\x20-\x20restart\x20bot(s)\x0a','build','toString','Unauthorized\x20attempt\x20to\x20show\x20configuration','Login\x20rejected','lowdb/adapters/FileSync','inherit','new','string','download','Invalid\x20authentication\x20token\x20(1)','hybrid-crypto-js','/:bot/configuration','Invalid\x20username\x20or\x20IP\x20address','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','-events.json','readdirSync','replace','get-messages','api-eu.mixpanel.com','verify','then','createWriteStream','\x20>\x20','logs/','botID','login\x20token\x20generated','enabled','Unauthorized\x20attempt\x20to\x20confirm\x20message','Token\x20blacklisted','environment','reinstall','/off\x20-\x20stop\x20bot(s)\x0a','pidExpireLogin','-----------------------------------------------------------------------------------','zip/','graphql-request','get','http','access\x20timeout','bots','function','339372tTgxRM','3000','2211ZjpUVE','path','/:bot/performance','getPortfolio','messages','update-bb','yes','assign','value','Notifications\x20enabled','compareSync','</b>\x20?','60xEAVls','internal','privateKey','-results.json','Session\x20expired\x20for\x20user\x20...','Enabled\x20Bot\x20','mkdirSync','username','.zip','startsWith','getFullYear','132zSZlVc','forEach','from','params','Starting\x20Balance\x20Bot\x20update','4759005gfkfRu','argv','Crypt','<b>Telegram\x20Bot\x20Status:</b>\x0a','createServer','\x20only\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','invalid\x20credentials','getSeconds','order','push','temp/','bb-config.json','toggleBotMode','store-settings','whitelistEnabled','onText','showname','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','index.html','::1','temporary\x20token\x20generated','chat','reinstall-bb','Logged\x20in\x20user\x20...','\x20(1)','clientip','\x20|\x20','latestversion','sortBy','simple','alias','headers','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','\x20minutes','env',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','2FA\x20required','\x1b[31m','SIGINT','secure','expiry','yargs/yargs','ipc','bb/','track','timeshift','Bot\x20','express',':\x20Bot\x20Mgr\x20>\x20','storeFiat','login','15\x20min','getMonth','sort','request','<b>Balance\x20Bot\x20Status:</b>\x0a','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Invalid\x20Telegram\x20token','manual','rmSync','output-003.log','getUTCHours','copyFileSync','existsSync','/update\x20-\x20update\x20Balance\x20Bot\x0a','disabled','config/','all','exec','\x20to\x20','getTime','publicKey','7360VIVPbS','hashSync','botmanager','confirm-message','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','staging','All','RSA-OAEP','exchange','temporary\x20access\x20not\x20allowed','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','listen','telegramEnabled','uuid-random','node-zip','success','_data',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','encryptedUuid','cloneDeep','\x20|\x20user:\x20...','init','HTML','All\x20bots','get-logs','output-002.log','-config.json','hasOwnProperty','Invalid\x20authentication\x20token\x20(2)','lastmsgtelegram','sockets','/:bot/support','logs','/download/:type','get-portfolio','bbUsername','userid','family','You\x20can\x20use\x20the\x20following\x20commands:\x0a','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','toIPv4Address','auto','getMinutes','1940358urFOHP','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','login\x20required','Restore\x20process\x20aborted','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','bot-','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','sendPortfolioTelegram','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','node-telegram-bot-api','logged\x20out','login\x20token\x20valid','Starting\x20bot\x20|\x20Bot\x20','#RES#\x20','telegramToken','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','running','loginRequired','emitHistory','temporaryAccessAllowed','Orders','args','isDirectory','onepagemode','IPv4','stopPolling','bb-secure.json','************','defaults','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','status','add','Ok,\x20will\x20send\x20alert\x20notifications\x20only','padStart','sendMessage','endsWith','tkn','headless','All\x20bots\x20running\x20right\x20now','binary','getDate','get-backup-files','mixpanel','ipv6','telegrammsg','apiSecret','Bot\x20Mgr\x20>\x20','alerts','Markdown','User\x20has\x20been\x20validated','socket.io','Disabled\x20Bot\x20','port','Backup\x20file\x20uploaded','new-disabled','apply','uuid','full','f2aRequired','backup-full@','Unauthorized\x20attempt\x20to\x20delete\x20bot','show-config','match','\x1b[0m','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','bbvNew','store','stop','(((.+)+)+)+$','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','decrypt','*$1*','/upload-backup','temporary\x20access\x20timeout','/output-000.log','Backup\x20file\x20unzipped\x20and\x20stored','filter','referer','2FA\x20login\x20token\x20generated','lastmsgemitted','30\x20min','orders','7kIQvVe','exp','host','stringify','join','write','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','file','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','bot','secret','DEFLATE','auth','Temporary\x20access\x20rejected','reject','telegram2FaApproval','version.json','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','build2','Starting\x20new\x20bot\x20|\x20Bot\x20','16SWLZDE','disconnect','RSA','unlinkSync','telegram','debug','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','apiPassword','Deleted\x20Bot\x20','jsonwebtoken','constructor','use','update','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','reload','33512XzYztz','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','writeFileSync','isValid','Unauthorized\x20attempt\x20to\x20get\x20portfolio','find','clients','send','output-001.log','connected','post','Ok,\x20will\x20send\x20order\x20notifications\x20only','\x1b[36m','telegramEvents','127.0.0.1','botname','password','Unauthorized\x20attempt\x20to\x20update\x20settings'];_0x2c4d=function(){return _0x4e9971;};return _0x2c4d();}function deleteBot(_0x49eceb){const _0x456189=_0x5db121;getClientsWithBotID(_0x49eceb)[_0x456189(0x242)](_0x239ec8=>{const _0x53521b=_0x456189;getSocket(_0x239ec8['id'])[_0x53521b(0x146)](!![]),removeClient(_0x239ec8['id']);}),dbConfig[_0x456189(0x223)]('bots')[_0x456189(0x1b1)]({'botID':_0x49eceb})[_0x456189(0x134)](),logger['full'](_0x456189(0x14d)+_0x49eceb),stopBot(_0x49eceb);try{if(fs[_0x456189(0x286)](path[_0x456189(0x133)](configpath,'bot-'+_0x49eceb+_0x456189(0x2aa))))fs['unlinkSync'](path[_0x456189(0x133)](configpath,_0x456189(0x2c0)+_0x49eceb+_0x456189(0x2aa)));if(fs['existsSync'](path[_0x456189(0x133)](configpath,_0x456189(0x2c0)+_0x49eceb+_0x456189(0x20d))))fs[_0x456189(0x148)](path[_0x456189(0x133)](configpath,_0x456189(0x2c0)+_0x49eceb+_0x456189(0x20d)));if(fs[_0x456189(0x286)](path[_0x456189(0x133)](configpath,_0x456189(0x2c0)+_0x49eceb+_0x456189(0x1dc))))fs[_0x456189(0x148)](path['join'](configpath,_0x456189(0x2c0)+_0x49eceb+'-performance.json'));if(fs['existsSync'](path[_0x456189(0x133)](configpath,_0x456189(0x2c0)+_0x49eceb+_0x456189(0x239))))fs[_0x456189(0x148)](path['join'](configpath,_0x456189(0x2c0)+_0x49eceb+'-results.json'));}catch(_0xcbd6cc){if(_0xcbd6cc)logger[_0x456189(0x116)](_0x456189(0x1c6),_0xcbd6cc);}config=getConfiguration(),io['to'](_0x456189(0x291))['emit']('bots',config),broadcastToBots(_0x456189(0x226),JSON[_0x456189(0x132)](config));}function toggleBot(_0x4f7ee6,_0x263b2e,_0x589be6){const _0x38b60d=_0x5db121;dbConfig['get'](_0x38b60d(0x226))['find']({'botID':_0x4f7ee6})['assign']({'status':_0x263b2e})[_0x38b60d(0x231)]({'live':_0x589be6})[_0x38b60d(0x134)]();if(_0x263b2e=='enabled'||_0x263b2e=='new')logger['full'](_0x38b60d(0x23b)+_0x4f7ee6),startBot([_0x4f7ee6,userID],{'cwd':bbpath},function(_0x1b968d){const _0x4240f2=_0x38b60d;if(_0x1b968d)logger[_0x4240f2(0x116)](_0x1b968d);});else(_0x263b2e==_0x38b60d(0x288)||_0x263b2e=='new-disabled')&&(logger[_0x38b60d(0x116)](_0x38b60d(0x110)+_0x4f7ee6),stopBot(_0x4f7ee6));config=getConfiguration(),io['to'](_0x38b60d(0x291))[_0x38b60d(0x17c)](_0x38b60d(0x226),config),broadcastToBots(_0x38b60d(0x226),JSON[_0x38b60d(0x132)](config));}function toggleStatus(_0x29ef25){const _0x284dc7=_0x5db121;let _0x4b5ecf=dbConfig[_0x284dc7(0x223)](_0x284dc7(0x226))['find']({'botID':_0x29ef25})[_0x284dc7(0x232)](),_0x57d439;if(_0x4b5ecf['status']==='enabled')_0x57d439=_0x284dc7(0x288);else{if(_0x4b5ecf[_0x284dc7(0x2d9)]===_0x284dc7(0x205))_0x57d439=_0x284dc7(0x113);else{if(_0x4b5ecf[_0x284dc7(0x2d9)]===_0x284dc7(0x113))_0x57d439=_0x284dc7(0x205);else{if(_0x4b5ecf['status']===_0x284dc7(0x288))_0x57d439='enabled';}}}return _0x57d439;}function updateStatus(_0x15df85,_0x37d412){const _0x1ced33=_0x5db121;dbConfig['get'](_0x1ced33(0x226))[_0x1ced33(0x159)]({'botID':_0x15df85})[_0x1ced33(0x231)]({'status':_0x37d412})['write'](),config=getConfiguration(),io['to'](_0x1ced33(0x291))[_0x1ced33(0x17c)](_0x1ced33(0x226),config),broadcastToBots(_0x1ced33(0x226),JSON[_0x1ced33(0x132)](config));}function updateLive(_0xecfaf6,_0x254310){const _0x2dca58=_0x5db121;dbConfig[_0x2dca58(0x223)]('bots')[_0x2dca58(0x159)]({'botID':_0xecfaf6})[_0x2dca58(0x231)]({'live':_0x254310})[_0x2dca58(0x134)](),config=getConfiguration(),io['to'](_0x2dca58(0x291))[_0x2dca58(0x17c)](_0x2dca58(0x226),config),broadcastToBots(_0x2dca58(0x226),JSON['stringify'](config));}function updateBotName(_0x50e97a,_0xba3b29){const _0x122a7a=_0x5db121;dbConfig[_0x122a7a(0x223)](_0x122a7a(0x226))[_0x122a7a(0x159)]({'botID':_0x50e97a})[_0x122a7a(0x231)]({'botname':_0xba3b29})[_0x122a7a(0x134)](),config=getConfiguration(),io['to'](_0x122a7a(0x291))[_0x122a7a(0x17c)](_0x122a7a(0x226),config),broadcastToBots(_0x122a7a(0x226),JSON[_0x122a7a(0x132)](config));}function updateBotManager(){const _0x4211f2=_0x5db121;config=getConfiguration(),io['to'](_0x4211f2(0x291))[_0x4211f2(0x17c)](_0x4211f2(0x226),config),broadcastToBots(_0x4211f2(0x226),JSON[_0x4211f2(0x132)](config));}function toggleBotMode(_0x4d396e){const _0x229cf0=_0x5db121;if(pid[_0x4d396e])pid[_0x4d396e][_0x229cf0(0x15b)]({'function':_0x229cf0(0x253),'args':null});else{const _0xc9251b=configpath+_0x229cf0(0x2c0)+_0x4d396e+_0x229cf0(0x2aa),_0x3f555a=fs[_0x229cf0(0x1ad)](_0xc9251b),_0x42d6ca=JSON[_0x229cf0(0x197)](_0x3f555a),_0x4a9d17=_0x42d6ca[_0x229cf0(0x138)][0x0][_0x229cf0(0x2e0)];_0x42d6ca[_0x229cf0(0x138)][0x0][_0x229cf0(0x2e0)]=!_0x4a9d17;const _0x2719e9=JSON[_0x229cf0(0x132)](_0x42d6ca,null,0x2);fs[_0x229cf0(0x156)](_0xc9251b,_0x2719e9),config=getConfiguration(),io['to'](_0x229cf0(0x291))[_0x229cf0(0x17c)](_0x229cf0(0x226),config),broadcastToBots(_0x229cf0(0x226),JSON[_0x229cf0(0x132)](config));}}function telegramError(_0x27d58d){const _0x3987e0=_0x5db121;logger['simple'](getTimeStamp()+_0x3987e0(0x2a1));}function validateTelegram(_0x33a2f7){const _0x2361a6=_0x5db121;if(_0x33a2f7[_0x2361a6(0x243)]['username']!=settings['telegramUsername']&&'@'+_0x33a2f7[_0x2361a6(0x243)][_0x2361a6(0x23d)]!=settings[_0x2361a6(0x187)])return tgBot[_0x2361a6(0x2dd)](_0x33a2f7[_0x2361a6(0x25c)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x2361a6(0x2a6)})[_0x2361a6(0x180)](_0x27107f=>{telegramError(_0x27107f);}),![];return!![];}async function initTelegram(){const _0x4a3f18=_0x5db121;if(tgBot)tgBot[_0x4a3f18(0x2d4)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x4a3f18(0x2c9)],{'polling':!![]});let _0x34d3a8=_0x4a3f18(0x2b6);_0x34d3a8+='\x0a',_0x34d3a8+=_0x4a3f18(0x1b3),_0x34d3a8+='/disable\x20-\x20disable\x20notifications\x0a',_0x34d3a8+=_0x4a3f18(0x258),_0x34d3a8+=_0x4a3f18(0x1fe),_0x34d3a8+=_0x4a3f18(0x1a5),_0x34d3a8+=_0x4a3f18(0x21e),_0x34d3a8+=_0x4a3f18(0x27f),_0x34d3a8+='/names\x20-\x20show\x20bot\x20names\x0a',_0x34d3a8+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x34d3a8+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x34d3a8+=_0x4a3f18(0x135),_0x34d3a8+=_0x4a3f18(0x287),_0x34d3a8+=_0x4a3f18(0x122),_0x34d3a8+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x169822=_0x4a3f18(0x1ca);_0x169822+='\x0a',_0x169822+=_0x34d3a8,tgBot['onText'](/\/start/,_0x51ad9d=>{const _0x1dd2fb=_0x4a3f18;if(!validateTelegram(_0x51ad9d))return;if(settings[_0x1dd2fb(0x183)]!=_0x51ad9d[_0x1dd2fb(0x25c)]['id'])updateSetting(_0x1dd2fb(0x183),_0x51ad9d[_0x1dd2fb(0x25c)]['id']);updateSetting('telegramEnabled',!![]),tgBot['sendMessage'](_0x51ad9d[_0x1dd2fb(0x25c)]['id'],_0x169822)['catch'](_0x5dc0a8=>{telegramError(_0x5dc0a8);});}),tgBot[_0x4a3f18(0x256)](/\/enable/,_0x3a9320=>{const _0x140445=_0x4a3f18;if(!validateTelegram(_0x3a9320))return;if(settings[_0x140445(0x183)]!=_0x3a9320[_0x140445(0x25c)]['id'])updateSetting(_0x140445(0x183),_0x3a9320[_0x140445(0x25c)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x140445(0x2dd)](_0x3a9320['chat']['id'],_0x140445(0x233))['catch'](_0x17ac78=>{telegramError(_0x17ac78);});}),tgBot[_0x4a3f18(0x256)](/\/config/,async _0x4ea1e7=>{const _0x5b2d61=_0x4a3f18;if(!validateTelegram(_0x4ea1e7))return;tgBot[_0x5b2d61(0x1d7)]('callback_query'),tgBot[_0x5b2d61(0x2dd)](_0x4ea1e7['chat']['id'],_0x5b2d61(0x1bf),{'reply_markup':{'inline_keyboard':[[{'text':_0x5b2d61(0x2cf),'callback_data':_0x5b2d61(0x12e)},{'text':_0x5b2d61(0x175),'callback_data':_0x5b2d61(0x10c)},{'text':_0x5b2d61(0x295),'callback_data':_0x5b2d61(0x28a)}]]}})['catch'](_0x285b96=>{telegramError(_0x285b96);}),tgBot['on'](_0x5b2d61(0x167),async _0x150285=>{const _0x1758d2=_0x5b2d61,_0x15bb18=_0x150285['data'],_0x3040b3=_0x150285['message'];tgBot[_0x1758d2(0x1f2)](_0x150285['id'])[_0x1758d2(0x213)](async()=>{const _0x1daa2d=_0x1758d2;_0x15bb18==_0x1daa2d(0x12e)&&(updateSetting('telegramEvents',_0x1daa2d(0x12e)),updateSetting(_0x1daa2d(0x29c),!![]),await tgBot[_0x1daa2d(0x2dd)](_0x3040b3[_0x1daa2d(0x25c)]['id'],_0x1daa2d(0x15f))[_0x1daa2d(0x180)](_0x127eb9=>{telegramError(_0x127eb9);}));_0x15bb18==_0x1daa2d(0x10c)&&(updateSetting(_0x1daa2d(0x161),_0x1daa2d(0x10c)),updateSetting(_0x1daa2d(0x29c),!![]),await tgBot[_0x1daa2d(0x2dd)](_0x3040b3[_0x1daa2d(0x25c)]['id'],_0x1daa2d(0x2db))[_0x1daa2d(0x180)](_0x47e3e3=>{telegramError(_0x47e3e3);}));_0x15bb18==_0x1daa2d(0x28a)&&(updateSetting(_0x1daa2d(0x161),_0x1daa2d(0x28a)),updateSetting(_0x1daa2d(0x29c),!![]),await tgBot[_0x1daa2d(0x2dd)](_0x3040b3[_0x1daa2d(0x25c)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')['catch'](_0x1d3c23=>{telegramError(_0x1d3c23);}));if(!settings[_0x1daa2d(0x183)])tgBot['sendMessage'](_0x3040b3[_0x1daa2d(0x25c)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x1daa2d(0x180)](_0x399bc4=>{telegramError(_0x399bc4);});}),tgBot['removeListener'](_0x1758d2(0x167));});}),tgBot[_0x4a3f18(0x256)](/\/status/,_0x184755=>{const _0x3eccb8=_0x4a3f18;if(!validateTelegram(_0x184755))return;const _0x4f1480=getBotsWithMode();let _0x458d39=_0x3eccb8(0x27e);config[_0x3eccb8(0x242)](_0x25ca6a=>{const _0x3a74d6=_0x3eccb8,_0x3c0193=_0x4f1480[_0x3a74d6(0x159)](_0x3265b3=>_0x3265b3[_0x3a74d6(0x217)]==_0x25ca6a[_0x3a74d6(0x217)])[_0x3a74d6(0x1cb)];_0x458d39+=_0x3a74d6(0x275)+_0x25ca6a[_0x3a74d6(0x217)]+':\x20'+_0x25ca6a[_0x3a74d6(0x2d9)]+_0x3a74d6(0x261)+_0x3c0193+'\x20|\x20'+_0x25ca6a[_0x3a74d6(0x1de)]+'\x0a';}),_0x458d39+='\x0a',_0x458d39+=_0x3eccb8(0x249),_0x458d39+=!settings[_0x3eccb8(0x29c)]?_0x3eccb8(0x1a8):'Notifications\x20enabled\x0a',_0x458d39+=settings['telegramEnabled']?settings['telegramEvents']==_0x3eccb8(0x28a)?_0x3eccb8(0x267):'Notifications\x20types:\x20'+settings[_0x3eccb8(0x161)]+_0x3eccb8(0x24b):'',tgBot[_0x3eccb8(0x2dd)](_0x184755[_0x3eccb8(0x25c)]['id'],_0x458d39,{'parse_mode':_0x3eccb8(0x2a6)})[_0x3eccb8(0x180)](_0x1ae427=>{telegramError(_0x1ae427);});}),tgBot[_0x4a3f18(0x256)](/\/restart/,_0x4830bc=>{const _0x4cad4a=_0x4a3f18;if(!validateTelegram(_0x4830bc))return;tgBot[_0x4cad4a(0x1d7)](_0x4cad4a(0x167));const _0x2b15c4=getEnabledBots();if(_0x2b15c4[_0x4cad4a(0x1ef)]==0x0)tgBot[_0x4cad4a(0x2dd)](_0x4830bc[_0x4cad4a(0x25c)]['id'],_0x4cad4a(0x19a))['catch'](_0x34ca2b=>{telegramError(_0x34ca2b);});else{if(_0x2b15c4[_0x4cad4a(0x1ef)]>0x1)_0x2b15c4[_0x4cad4a(0x250)]({'botID':_0x4cad4a(0x28a)});let _0x49f3fc=[],_0x5dd4ba=[];const _0x4d9156=_0x2b15c4[_0x4cad4a(0x1ef)]%0x4==0x0||_0x2b15c4[_0x4cad4a(0x1ef)]%0x4==0x3||_0x2b15c4['length']%0x3==0x1?0x4:0x3;let _0x324f63=0x0;_0x2b15c4[_0x4cad4a(0x242)]((_0x1a7f10,_0x13b4db)=>{const _0x3a345c=_0x4cad4a;if(_0x13b4db%_0x4d9156==0x0)_0x5dd4ba=[];_0x5dd4ba[_0x3a345c(0x250)]({'text':_0x1a7f10[_0x3a345c(0x217)]=='all'?_0x3a345c(0x2a7):'Bot\x20'+_0x1a7f10[_0x3a345c(0x217)],'callback_data':_0x1a7f10[_0x3a345c(0x217)]}),_0x13b4db%_0x4d9156==0x0&&(_0x49f3fc[_0x324f63]=_0x5dd4ba,_0x324f63++);}),tgBot[_0x4cad4a(0x2dd)](_0x4830bc[_0x4cad4a(0x25c)]['id'],_0x4cad4a(0x17b),{'reply_markup':{'inline_keyboard':_0x49f3fc}})[_0x4cad4a(0x180)](_0x44848f=>{telegramError(_0x44848f);}),tgBot['on'](_0x4cad4a(0x167),async _0xa5d86f=>{const _0xfbc767=_0x4cad4a,_0x2506ed=_0xa5d86f[_0xfbc767(0x176)],_0x2416c8=_0xa5d86f['message'];tgBot[_0xfbc767(0x1f2)](_0xa5d86f['id'])[_0xfbc767(0x213)](async()=>{_0x2506ed=='all'?config['forEach'](_0xd26434=>{const _0x658213=_0x54c1;restartBot(_0xd26434[_0x658213(0x217)]);}):restartBot(_0x2506ed);}),tgBot['removeListener'](_0xfbc767(0x167));});}}),tgBot[_0x4a3f18(0x256)](/\/on/,_0x5ed039=>{const _0x39adbc=_0x4a3f18;if(!validateTelegram(_0x5ed039))return;tgBot[_0x39adbc(0x1d7)](_0x39adbc(0x167));const _0x3901c6=getDisabledBots();if(_0x3901c6['length']==0x0)tgBot[_0x39adbc(0x2dd)](_0x5ed039[_0x39adbc(0x25c)]['id'],_0x39adbc(0x2e1))[_0x39adbc(0x180)](_0x1347f8=>{telegramError(_0x1347f8);});else{if(_0x3901c6[_0x39adbc(0x1ef)]>0x1)_0x3901c6['push']({'botID':'all'});let _0x3fc87b=[],_0x54f418=[];const _0x3c6a0b=_0x3901c6['length']%0x4==0x0||_0x3901c6['length']%0x4==0x3||_0x3901c6[_0x39adbc(0x1ef)]%0x3==0x1?0x4:0x3;let _0x424922=0x0;_0x3901c6[_0x39adbc(0x242)]((_0x3a223a,_0x297011)=>{const _0x4a4588=_0x39adbc;if(_0x297011%_0x3c6a0b==0x0)_0x54f418=[];_0x54f418[_0x4a4588(0x250)]({'text':_0x3a223a[_0x4a4588(0x217)]==_0x4a4588(0x28a)?_0x4a4588(0x2a7):'Bot\x20'+_0x3a223a[_0x4a4588(0x217)],'callback_data':_0x3a223a[_0x4a4588(0x217)]}),_0x297011%_0x3c6a0b==0x0&&(_0x3fc87b[_0x424922]=_0x54f418,_0x424922++);}),tgBot[_0x39adbc(0x2dd)](_0x5ed039[_0x39adbc(0x25c)]['id'],_0x39adbc(0x194),{'reply_markup':{'inline_keyboard':_0x3fc87b}})[_0x39adbc(0x180)](_0x415612=>{telegramError(_0x415612);}),tgBot['on'](_0x39adbc(0x167),async _0x14511f=>{const _0x1a438d=_0x39adbc,_0x4c2bcd=_0x14511f['data'],_0x49db6d=_0x14511f[_0x1a438d(0x169)];tgBot[_0x1a438d(0x1f2)](_0x14511f['id'])[_0x1a438d(0x213)](async()=>{const _0x5b31aa=_0x1a438d;_0x4c2bcd==_0x5b31aa(0x28a)?(tgBot[_0x5b31aa(0x2dd)](_0x49db6d[_0x5b31aa(0x25c)]['id'],_0x5b31aa(0x2bc))[_0x5b31aa(0x180)](_0x5f2b62=>{telegramError(_0x5f2b62);}),_0x3901c6[_0x5b31aa(0x242)](_0x370cf7=>{const _0x31f537=_0x5b31aa;if(_0x370cf7[_0x31f537(0x217)]!=_0x31f537(0x28a))toggleBot(_0x370cf7[_0x31f537(0x217)],toggleStatus(_0x370cf7[_0x31f537(0x217)]),_0x31f537(0x191));})):(tgBot['sendMessage'](_0x49db6d[_0x5b31aa(0x25c)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x4c2bcd)[_0x5b31aa(0x180)](_0x2e8b4a=>{telegramError(_0x2e8b4a);}),toggleBot(_0x4c2bcd,toggleStatus(_0x4c2bcd),'stopped'));}),tgBot[_0x1a438d(0x1d7)](_0x1a438d(0x167));});}}),tgBot['onText'](/\/off/,_0xf60420=>{const _0x106c92=_0x4a3f18;if(!validateTelegram(_0xf60420))return;tgBot[_0x106c92(0x1d7)](_0x106c92(0x167));const _0x2078e1=getEnabledBots();if(_0x2078e1[_0x106c92(0x1ef)]==0x0)tgBot[_0x106c92(0x2dd)](_0xf60420[_0x106c92(0x25c)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x1c6ed7=>{telegramError(_0x1c6ed7);});else{if(_0x2078e1[_0x106c92(0x1ef)]>0x1)_0x2078e1[_0x106c92(0x250)]({'botID':'all'});let _0x40ca05=[],_0x5c0269=[];const _0xa2795b=_0x2078e1[_0x106c92(0x1ef)]%0x4==0x0||_0x2078e1[_0x106c92(0x1ef)]%0x4==0x3||_0x2078e1[_0x106c92(0x1ef)]%0x3==0x1?0x4:0x3;let _0x44c828=0x0;_0x2078e1[_0x106c92(0x242)]((_0x35457b,_0x16ddb2)=>{const _0x322719=_0x106c92;if(_0x16ddb2%_0xa2795b==0x0)_0x5c0269=[];_0x5c0269['push']({'text':_0x35457b[_0x322719(0x217)]=='all'?_0x322719(0x2a7):_0x322719(0x275)+_0x35457b[_0x322719(0x217)],'callback_data':_0x35457b[_0x322719(0x217)]}),_0x16ddb2%_0xa2795b==0x0&&(_0x40ca05[_0x44c828]=_0x5c0269,_0x44c828++);}),tgBot[_0x106c92(0x2dd)](_0xf60420[_0x106c92(0x25c)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x40ca05}})[_0x106c92(0x180)](_0x969c5b=>{telegramError(_0x969c5b);}),tgBot['on'](_0x106c92(0x167),async _0x5f5a1b=>{const _0x1c8ffa=_0x106c92,_0x2e7fc1=_0x5f5a1b[_0x1c8ffa(0x176)],_0x36887e=_0x5f5a1b[_0x1c8ffa(0x169)];tgBot[_0x1c8ffa(0x1f2)](_0x5f5a1b['id'])[_0x1c8ffa(0x213)](async()=>{const _0x3a15a8=_0x1c8ffa;_0x2e7fc1==_0x3a15a8(0x28a)?(tgBot['sendMessage'](_0x36887e[_0x3a15a8(0x25c)]['id'],_0x3a15a8(0x20c))['catch'](_0x5403b0=>{telegramError(_0x5403b0);}),_0x2078e1[_0x3a15a8(0x242)](_0x2ba0a2=>{const _0x2ee79e=_0x3a15a8;if(_0x2ba0a2[_0x2ee79e(0x217)]!=_0x2ee79e(0x28a))toggleBot(_0x2ba0a2['botID'],toggleStatus(_0x2ba0a2[_0x2ee79e(0x217)]),'stopped');})):(tgBot['sendMessage'](_0x36887e['chat']['id'],_0x3a15a8(0x17d)+_0x2e7fc1)[_0x3a15a8(0x180)](_0x2823c3=>{telegramError(_0x2823c3);}),toggleBot(_0x2e7fc1,toggleStatus(_0x2e7fc1),_0x3a15a8(0x191)));}),tgBot[_0x1c8ffa(0x1d7)](_0x1c8ffa(0x167));});}}),tgBot[_0x4a3f18(0x256)](/\/metrics/,_0x6260b9=>{const _0x4a59ba=_0x4a3f18;if(!validateTelegram(_0x6260b9))return;tgBot[_0x4a59ba(0x1d7)](_0x4a59ba(0x167));const _0x2c3bd7=getEnabledBots();if(_0x2c3bd7['length']==0x0)tgBot[_0x4a59ba(0x2dd)](_0x6260b9[_0x4a59ba(0x25c)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x4a59ba(0x180)](_0x1524c2=>{telegramError(_0x1524c2);});else{if(_0x2c3bd7[_0x4a59ba(0x1ef)]>0x1){let _0x3a54ab=[],_0x2717c8=[];const _0x4fe5e3=_0x2c3bd7[_0x4a59ba(0x1ef)]%0x4==0x0||_0x2c3bd7[_0x4a59ba(0x1ef)]%0x4==0x3||_0x2c3bd7[_0x4a59ba(0x1ef)]%0x3==0x1?0x4:0x3;let _0x57ef59=0x0;_0x2c3bd7['forEach']((_0x420669,_0x50f40f)=>{const _0x3fc2d3=_0x4a59ba;if(_0x50f40f%_0x4fe5e3==0x0)_0x2717c8=[];_0x2717c8[_0x3fc2d3(0x250)]({'text':_0x3fc2d3(0x275)+_0x420669[_0x3fc2d3(0x217)],'callback_data':_0x420669[_0x3fc2d3(0x217)]}),_0x50f40f%_0x4fe5e3==0x0&&(_0x3a54ab[_0x57ef59]=_0x2717c8,_0x57ef59++);}),tgBot[_0x4a59ba(0x2dd)](_0x6260b9[_0x4a59ba(0x25c)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x3a54ab}})[_0x4a59ba(0x180)](_0x3e9e7e=>{telegramError(_0x3e9e7e);}),tgBot['on'](_0x4a59ba(0x167),async _0x12dbe1=>{const _0xac1650=_0x4a59ba,_0x325c34=_0x12dbe1['data'],_0x593cb8=_0x12dbe1[_0xac1650(0x169)];tgBot[_0xac1650(0x1f2)](_0x12dbe1['id'])[_0xac1650(0x213)](async()=>{const _0x321f78=_0xac1650;if(pid[_0x325c34])pid[_0x325c34][_0x321f78(0x15b)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0xac1650(0x1d7)](_0xac1650(0x167));});}else{const _0x6b6f68=_0x2c3bd7[0x0]['botID'];if(pid[_0x6b6f68])pid[_0x6b6f68][_0x4a59ba(0x15b)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot['onText'](/\/portfolio/,_0x1d4b19=>{const _0x3370aa=_0x4a3f18;if(!validateTelegram(_0x1d4b19))return;tgBot[_0x3370aa(0x1d7)]('callback_query');const _0x4e1226=getEnabledBots();if(_0x4e1226[_0x3370aa(0x1ef)]==0x0)tgBot[_0x3370aa(0x2dd)](_0x1d4b19[_0x3370aa(0x25c)]['id'],_0x3370aa(0x19a))['catch'](_0xdbfb9=>{telegramError(_0xdbfb9);});else{if(_0x4e1226[_0x3370aa(0x1ef)]>0x1){let _0x586b5e=[],_0xf327d3=[];const _0x489955=_0x4e1226[_0x3370aa(0x1ef)]%0x4==0x0||_0x4e1226['length']%0x4==0x3||_0x4e1226[_0x3370aa(0x1ef)]%0x3==0x1?0x4:0x3;let _0x3f3812=0x0;_0x4e1226[_0x3370aa(0x242)]((_0x33b88e,_0x456534)=>{const _0x37608f=_0x3370aa;if(_0x456534%_0x489955==0x0)_0xf327d3=[];_0xf327d3['push']({'text':'Bot\x20'+_0x33b88e[_0x37608f(0x217)],'callback_data':_0x33b88e['botID']}),_0x456534%_0x489955==0x0&&(_0x586b5e[_0x3f3812]=_0xf327d3,_0x3f3812++);}),tgBot[_0x3370aa(0x2dd)](_0x1d4b19[_0x3370aa(0x25c)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x586b5e}})['catch'](_0x16a7ec=>{telegramError(_0x16a7ec);}),tgBot['on'](_0x3370aa(0x167),async _0x2d092b=>{const _0x1bc4d5=_0x3370aa,_0x4fce16=_0x2d092b[_0x1bc4d5(0x176)],_0x3d562d=_0x2d092b[_0x1bc4d5(0x169)];tgBot['answerCallbackQuery'](_0x2d092b['id'])[_0x1bc4d5(0x213)](async()=>{const _0x169993=_0x1bc4d5;if(pid[_0x4fce16])pid[_0x4fce16][_0x169993(0x15b)]({'function':_0x169993(0x2c2),'args':null});}),tgBot[_0x1bc4d5(0x1d7)]('callback_query');});}else{const _0x162bbc=_0x4e1226[0x0][_0x3370aa(0x217)];if(pid[_0x162bbc])pid[_0x162bbc][_0x3370aa(0x15b)]({'function':_0x3370aa(0x2c2),'args':null});}}}),tgBot[_0x4a3f18(0x256)](/\/update/,async _0x1d1526=>{const _0x21882e=_0x4a3f18;if(!validateTelegram(_0x1d1526))return;tgBot[_0x21882e(0x1d7)](_0x21882e(0x167)),await getMessages();if(!updateAvailable)tgBot[_0x21882e(0x2dd)](_0x1d1526[_0x21882e(0x25c)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x21882e(0x180)](_0x4c5851=>{telegramError(_0x4c5851);});else!validInstallation?tgBot[_0x21882e(0x2dd)](_0x1d1526[_0x21882e(0x25c)]['id'],_0x21882e(0x137))['catch'](_0x36e952=>{telegramError(_0x36e952);}):(tgBot[_0x21882e(0x2dd)](_0x1d1526['chat']['id'],_0x21882e(0x152),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x21882e(0x230)},{'text':'No','callback_data':'no'}]]}})[_0x21882e(0x180)](_0x2dd3b0=>{telegramError(_0x2dd3b0);}),tgBot['on'](_0x21882e(0x167),async _0x4d4e53=>{const _0x57ea07=_0x21882e,_0x1d28ce=_0x4d4e53[_0x57ea07(0x176)],_0x226e02=_0x4d4e53[_0x57ea07(0x169)];tgBot[_0x57ea07(0x1f2)](_0x4d4e53['id'])[_0x57ea07(0x213)](async()=>{const _0x5060f5=_0x57ea07;_0x1d28ce==_0x5060f5(0x230)&&(await tgBot[_0x5060f5(0x2dd)](_0x226e02[_0x5060f5(0x25c)]['id'],_0x5060f5(0x245))['catch'](_0x2914da=>{telegramError(_0x2914da);}),updateBB(_0x5060f5(0x151))),_0x1d28ce=='no'&&await tgBot[_0x5060f5(0x2dd)](_0x226e02[_0x5060f5(0x25c)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')['catch'](_0x1c3c2c=>{telegramError(_0x1c3c2c);});}),tgBot[_0x57ea07(0x1d7)](_0x57ea07(0x167));}));}),tgBot[_0x4a3f18(0x256)](/\/reinstall/,async _0x373c8c=>{const _0x199a6e=_0x4a3f18;if(!validateTelegram(_0x373c8c))return;tgBot[_0x199a6e(0x1d7)](_0x199a6e(0x167)),!validInstallation?tgBot['sendMessage'](_0x373c8c[_0x199a6e(0x25c)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')[_0x199a6e(0x180)](_0x741e31=>{telegramError(_0x741e31);}):(tgBot[_0x199a6e(0x2dd)](_0x373c8c[_0x199a6e(0x25c)]['id'],_0x199a6e(0x2c1),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x199a6e(0x230)},{'text':'No','callback_data':'no'}]]}})['catch'](_0xa1b955=>{telegramError(_0xa1b955);}),tgBot['on'](_0x199a6e(0x167),async _0xc469cc=>{const _0x7612e8=_0x199a6e,_0x427b99=_0xc469cc['data'],_0x509fb2=_0xc469cc[_0x7612e8(0x169)];tgBot[_0x7612e8(0x1f2)](_0xc469cc['id'])[_0x7612e8(0x213)](async()=>{const _0x513bf3=_0x7612e8;_0x427b99=='yes'&&(await tgBot[_0x513bf3(0x2dd)](_0x509fb2[_0x513bf3(0x25c)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation')[_0x513bf3(0x180)](_0x500bb6=>{telegramError(_0x500bb6);}),updateBB(_0x513bf3(0x21d))),_0x427b99=='no'&&await tgBot[_0x513bf3(0x2dd)](_0x509fb2[_0x513bf3(0x25c)]['id'],_0x513bf3(0x2c3))[_0x513bf3(0x180)](_0xbee71f=>{telegramError(_0xbee71f);});}),tgBot[_0x7612e8(0x1d7)](_0x7612e8(0x167));}));}),tgBot[_0x4a3f18(0x256)](/\/toggle/,_0x3bad0c=>{const _0x29d524=_0x4a3f18;if(!validateTelegram(_0x3bad0c))return;tgBot['removeListener'](_0x29d524(0x167));const _0x46d900=getBotsWithMode();if(_0x46d900[_0x29d524(0x1ef)]==0x0)tgBot['sendMessage'](_0x3bad0c[_0x29d524(0x25c)]['id'],_0x29d524(0x19a))[_0x29d524(0x180)](_0x531343=>{telegramError(_0x531343);});else{let _0x280fe7=[],_0x232f2a=[];const _0x11ee94=0x2;let _0x155905=0x0;_0x46d900[_0x29d524(0x242)]((_0x2aff3e,_0x302e03)=>{const _0x4a1e3b=_0x29d524;if(_0x302e03%_0x11ee94==0x0)_0x232f2a=[];_0x232f2a[_0x4a1e3b(0x250)]({'text':_0x4a1e3b(0x275)+_0x2aff3e['botID']+'\x20('+_0x2aff3e[_0x4a1e3b(0x1cb)]+')','callback_data':_0x2aff3e[_0x4a1e3b(0x217)]}),_0x302e03%_0x11ee94==0x0&&(_0x280fe7[_0x155905]=_0x232f2a,_0x155905++);}),tgBot[_0x29d524(0x2dd)](_0x3bad0c[_0x29d524(0x25c)]['id'],_0x29d524(0x24c),{'reply_markup':{'inline_keyboard':_0x280fe7}})['catch'](_0x11ddd8=>{telegramError(_0x11ddd8);}),tgBot['on'](_0x29d524(0x167),async _0x1ebb1f=>{const _0x5e5765=_0x29d524,_0x47f8db=_0x1ebb1f[_0x5e5765(0x176)],_0x9121ce=_0x1ebb1f[_0x5e5765(0x169)];tgBot[_0x5e5765(0x1f2)](_0x1ebb1f['id'])[_0x5e5765(0x213)](async()=>{const _0x423a10=_0x5e5765,_0x57f2d1=_0x46d900[_0x423a10(0x159)](_0x52132b=>_0x52132b[_0x423a10(0x217)]==_0x47f8db),_0x380066=_0x57f2d1[_0x423a10(0x1cb)]=='auto'?_0x423a10(0x281):_0x423a10(0x2b9);tgBot[_0x423a10(0x2dd)](_0x9121ce[_0x423a10(0x25c)]['id'],_0x423a10(0x14b)+_0x47f8db+_0x423a10(0x28c)+_0x380066+_0x423a10(0x177))[_0x423a10(0x180)](_0x1e3ab6=>{telegramError(_0x1e3ab6);}),toggleBotMode(_0x47f8db);}),tgBot[_0x5e5765(0x1d7)]('callback_query');});}}),tgBot['onText'](/\/names/,_0x3f78e2=>{const _0x332171=_0x4a3f18;if(!validateTelegram(_0x3f78e2))return;let _0x244db1='';config[_0x332171(0x242)](_0x2c4f2c=>{const _0x33d66b=_0x332171;_0x244db1+=_0x33d66b(0x275)+_0x2c4f2c[_0x33d66b(0x217)]+':\x20'+_0x2c4f2c['botname']+'\x0a';}),tgBot[_0x332171(0x2dd)](_0x3f78e2['chat']['id'],_0x244db1,{'parse_mode':_0x332171(0x2a6)})[_0x332171(0x180)](_0x22becc=>{telegramError(_0x22becc);});}),tgBot[_0x4a3f18(0x256)](/\/disable/,_0x53cdbf=>{const _0x3b449b=_0x4a3f18;if(!validateTelegram(_0x53cdbf))return;tgBot[_0x3b449b(0x2dd)](_0x53cdbf[_0x3b449b(0x25c)]['id'],_0x3b449b(0x1c8))['catch'](_0x46a223=>{telegramError(_0x46a223);}),updateSetting(_0x3b449b(0x29c),![]);}),tgBot[_0x4a3f18(0x256)](/\/help/,_0x4f872e=>{const _0x50503a=_0x4a3f18;if(!validateTelegram(_0x4f872e))return;tgBot[_0x50503a(0x2dd)](_0x4f872e[_0x50503a(0x25c)]['id'],_0x34d3a8)['catch'](_0x5556f9=>{telegramError(_0x5556f9);});}),tgBot['on']('polling_error',_0x251d31=>{const _0x4dee0f=_0x4a3f18;_0x251d31[_0x4dee0f(0x200)]()[_0x4dee0f(0x1d6)](_0x4dee0f(0x1a1))&&(logger[_0x4dee0f(0x116)](_0x4dee0f(0x280)),tgBot[_0x4dee0f(0x2d4)](),tgBot=null,io['to'](_0x4dee0f(0x291))['emit'](_0x4dee0f(0x1c4),_0x4dee0f(0x280)));}),process['once'](_0x4a3f18(0x26d),()=>{const _0x22413a=_0x4a3f18;if(tgBot)tgBot[_0x22413a(0x2d4)]();process['exit'](0x1);}),process[_0x4a3f18(0x1be)](_0x4a3f18(0x16d),()=>{const _0x4b47a8=_0x4a3f18;if(tgBot)tgBot[_0x4b47a8(0x2d4)]();process['exit'](0x1);});}}function disableTelegram(){const _0x4f0fed=_0x5db121;tgBot&&(tgBot[_0x4f0fed(0x2d4)](),tgBot=null);}function sendTelegram(_0x3890d3,_0x199717){const _0x45c2e9=_0x5db121;if(settings[_0x45c2e9(0x29c)]){if(settings[_0x45c2e9(0x161)]==_0x45c2e9(0x28a)||(_0x199717['type']==_0x45c2e9(0x1d3)||_0x199717[_0x45c2e9(0x1bb)]=='warning'||_0x199717[_0x45c2e9(0x1bb)]==_0x45c2e9(0x29f))&&settings[_0x45c2e9(0x161)]==_0x45c2e9(0x10c)||_0x199717['type']==_0x45c2e9(0x24f)&&settings[_0x45c2e9(0x161)]==_0x45c2e9(0x12e)){if(tgBot&&settings['telegramChatId']){if(_0x199717[_0x45c2e9(0x257)])tgBot[_0x45c2e9(0x2dd)](settings[_0x45c2e9(0x183)],_0x199717['botname']+_0x45c2e9(0x215)+_0x199717['event'])['catch'](_0x28967d=>{telegramError(_0x28967d);});else tgBot[_0x45c2e9(0x2dd)](settings['telegramChatId'],_0x45c2e9(0x275)+_0x3890d3+'\x20>\x20'+_0x199717['event'])[_0x45c2e9(0x180)](_0x155a7d=>{telegramError(_0x155a7d);});}}}}async function sendTelegramMsg(_0x2f8929,_0x593934=_0x5db121(0x2a6)){const _0xe6066e=_0x5db121;return settings['telegramEnabled']&&tgBot&&settings['telegramChatId']?(await tgBot[_0xe6066e(0x2dd)](settings[_0xe6066e(0x183)],_0x2f8929,{'parse_mode':_0x593934})[_0xe6066e(0x180)](_0x581d7f=>{telegramError(_0x581d7f);}),!![]):![];}function getDeviceWithIp(_0xcd5119){const _0x125256=_0x5db121;return devices[_0x125256(0x159)](_0x119b05=>_0x119b05['ip']===_0xcd5119);}function temporaryAccess2FA(_0x355fad,_0x43d577){const _0x5c4966=_0x5db121;let _0x10b2a2=new Date(),_0x3432d2=![];if(lastIpApproval){if(_0x10b2a2-lastIpApproval<0x1388)_0x3432d2=!![];}lastIpApproval=new Date();if(_0x3432d2)return;tgBot&&settings[_0x5c4966(0x183)]&&(tgBot[_0x5c4966(0x1d7)](_0x5c4966(0x167)),tgBot[_0x5c4966(0x2dd)](settings[_0x5c4966(0x183)],_0x5c4966(0x1e3)+normalizeIP(_0x43d577)['show']+_0x5c4966(0x235),{'parse_mode':_0x5c4966(0x2a6),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x5c4966(0x27a),'callback_data':'15'},{'text':_0x5c4966(0x12d),'callback_data':'30'},{'text':_0x5c4966(0x13d),'callback_data':_0x5c4966(0x13d)}]]}})['catch'](_0xc7b69e=>{telegramError(_0xc7b69e);}),tgBot['on'](_0x5c4966(0x167),async _0x41d3bd=>{const _0x4aaecf=_0x5c4966,_0x84c75b=_0x41d3bd[_0x4aaecf(0x176)],_0x67acf9=_0x41d3bd[_0x4aaecf(0x169)];tgBot[_0x4aaecf(0x1f2)](_0x41d3bd['id'])[_0x4aaecf(0x213)](async()=>{const _0x503b85=_0x4aaecf;devices[_0x355fad]['telegramIpApproval']={'clientip':_0x43d577,'timestamp':new Date()[_0x503b85(0x28d)](),'expiry':_0x84c75b},_0x84c75b!='reject'?(await tgBot[_0x503b85(0x2dd)](_0x67acf9['chat']['id'],_0x503b85(0x1a3)+_0x84c75b+_0x503b85(0x268),{'parse_mode':_0x503b85(0x2a6)})[_0x503b85(0x180)](_0x160e2e=>{telegramError(_0x160e2e);}),io['to'](_0x355fad)[_0x503b85(0x17c)]('status',{'access':{'allow':![],'reason':_0x503b85(0x153),'token':null}})):(await tgBot[_0x503b85(0x2dd)](_0x67acf9[_0x503b85(0x25c)]['id'],_0x503b85(0x13c))[_0x503b85(0x180)](_0x1fe950=>{telegramError(_0x1fe950);}),io['to'](_0x355fad)['emit']('status',{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot['removeListener'](_0x4aaecf(0x167));}));}function loginAccess2FA(_0x68b90b,_0x5490c5){const _0x176e0b=_0x5db121;tgBot&&settings[_0x176e0b(0x183)]&&(tgBot[_0x176e0b(0x1d7)](_0x176e0b(0x167)),tgBot[_0x176e0b(0x2dd)](settings[_0x176e0b(0x183)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x5490c5)['show']+_0x176e0b(0x235),{'parse_mode':_0x176e0b(0x2a6),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x176e0b(0x13d),'callback_data':_0x176e0b(0x13d)}]]}})[_0x176e0b(0x180)](_0x2091be=>{telegramError(_0x2091be);}),tgBot['on'](_0x176e0b(0x167),async _0x336fa6=>{const _0x3c68fb=_0x176e0b,_0x596efc=_0x336fa6[_0x3c68fb(0x176)],_0x1ae3a7=_0x336fa6[_0x3c68fb(0x169)];tgBot['answerCallbackQuery'](_0x336fa6['id'])[_0x3c68fb(0x213)](async()=>{const _0x30ec5f=_0x3c68fb;devices[_0x68b90b][_0x30ec5f(0x13e)]={'clientip':_0x5490c5,'timestamp':new Date()[_0x30ec5f(0x28d)](),'expiry':_0x596efc},_0x596efc!=_0x30ec5f(0x13d)?(await tgBot[_0x30ec5f(0x2dd)](_0x1ae3a7[_0x30ec5f(0x25c)]['id'],_0x30ec5f(0x18a),{'parse_mode':_0x30ec5f(0x2a6)})[_0x30ec5f(0x180)](_0x44f7ca=>{telegramError(_0x44f7ca);}),io['to'](_0x68b90b)[_0x30ec5f(0x17c)](_0x30ec5f(0x2d9),{'access':{'allow':![],'reason':_0x30ec5f(0x153),'token':null}})):(await tgBot['sendMessage'](_0x1ae3a7[_0x30ec5f(0x25c)]['id'],_0x30ec5f(0x202))['catch'](_0x590461=>{telegramError(_0x590461);}),io['to'](_0x68b90b)['emit'](_0x30ec5f(0x2d9),{'access':{'allow':![],'reason':_0x30ec5f(0x1c9),'token':null}}));}),tgBot[_0x3c68fb(0x1d7)](_0x3c68fb(0x167));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x443be6=_0x5db121;return dbConfig[_0x443be6(0x223)](_0x443be6(0x226))[_0x443be6(0x263)](_0x443be6(0x217))[_0x443be6(0x129)]({'status':_0x443be6(0x219)})[_0x443be6(0x232)]()||[];}function getDisabledBots(){const _0x2b1f93=_0x5db121;return dbConfig[_0x2b1f93(0x223)](_0x2b1f93(0x226))[_0x2b1f93(0x263)](_0x2b1f93(0x217))[_0x2b1f93(0x129)]({'status':_0x2b1f93(0x288)})[_0x2b1f93(0x232)]()||[];}function getBotAttributes(_0x57175a){const _0x8cf563=_0x5db121;let _0x15d207={};const _0x40c6c3=configpath+_0x8cf563(0x2c0)+_0x57175a+'-config.json',_0x56fd7e=fs['existsSync'](_0x40c6c3);if(_0x56fd7e){const _0x3f0dab=fs[_0x8cf563(0x1ad)](_0x40c6c3);try{const _0x20d198=JSON['parse'](_0x3f0dab),_0x5c896d=_0x20d198?_0x20d198['bot'][0x0][_0x8cf563(0x2e0)]:![];_0x15d207[_0x8cf563(0x1cb)]=_0x5c896d?_0x8cf563(0x2b9):_0x8cf563(0x281),_0x15d207['botname']=_0x20d198?_0x20d198[_0x8cf563(0x138)][0x0][_0x8cf563(0x163)]:_0x8cf563(0x275)+_0x57175a;}catch(_0x3af11c){_0x15d207[_0x8cf563(0x1cb)]=_0x8cf563(0x281),_0x15d207['botname']=_0x8cf563(0x275)+_0x57175a;}}else _0x15d207['mode']=_0x8cf563(0x281),_0x15d207[_0x8cf563(0x163)]='Bot\x20'+_0x57175a;return _0x15d207;}function getBotsWithMode(){const _0x4f5cde=_0x5db121,_0x2f74be=dbConfig['get'](_0x4f5cde(0x226))[_0x4f5cde(0x263)](_0x4f5cde(0x217))[_0x4f5cde(0x232)]()||[];return _0x2f74be[_0x4f5cde(0x242)](_0x2dd058=>{const _0x476af7=_0x4f5cde;let _0xb0c069=getBotAttributes(_0x2dd058['botID']);_0x2dd058[_0x476af7(0x1cb)]=_0xb0c069[_0x476af7(0x1cb)];}),_0x2f74be;}function getBotExchanges(){const _0x19563f=_0x5db121;let _0x5a41a0=[];const _0x437c64=dbConfig[_0x19563f(0x223)](_0x19563f(0x226))['sortBy'](_0x19563f(0x217))[_0x19563f(0x232)]()||[];_0x437c64['forEach'](_0x4ca4cf=>{const _0x45e96b=_0x19563f;if(_0x4ca4cf[_0x45e96b(0x2d9)]=='enabled'){const _0x184b99=configpath+_0x45e96b(0x2c0)+_0x4ca4cf['botID']+_0x45e96b(0x2aa),_0x609d8c=fs[_0x45e96b(0x286)](_0x184b99);let _0x351c08;if(_0x609d8c){const _0x2b454c=fs[_0x45e96b(0x1ad)](_0x184b99);try{const _0x5e89ee=JSON[_0x45e96b(0x197)](_0x2b454c);_0x351c08=_0x5e89ee?_0x5e89ee[_0x45e96b(0x138)][0x0][_0x45e96b(0x297)]:null;}catch(_0x15c087){}}if(_0x351c08)_0x5a41a0[_0x45e96b(0x250)](_0x351c08);}});const _0x2e2d7a=[...new Set(_0x5a41a0)][_0x19563f(0x27c)]();return _0x2e2d7a;}async function initUser(){const _0x145aef=_0x5db121;if(!settings[_0x145aef(0x2b4)]){const _0x337aa8=uuidRandom();mixpanel[_0x145aef(0x265)](_0x337aa8),updateSetting(_0x145aef(0x2b4),_0x337aa8);}}async function initSecure(){const _0x479386=_0x5db121;let _0x2b7e69=getSecure();if(!_0x2b7e69['hasOwnProperty'](_0x479386(0x139))){let _0x2cd650=await generateKeys();_0x2b7e69[_0x479386(0x28e)]=_0x2cd650['publicKey'],_0x2b7e69[_0x479386(0x238)]=_0x2cd650[_0x479386(0x238)],_0x2b7e69[_0x479386(0x139)]=crypto['randomBytes'](0x20)[_0x479386(0x200)]('hex');;storeSecure(_0x2b7e69);}}function getSettings(){const _0x25cbea=_0x5db121;return dbSettings[_0x25cbea(0x223)](_0x25cbea(0x1ea))[_0x25cbea(0x232)]()||{};}function getSecure(){const _0x465b31=_0x5db121;return dbSecure[_0x465b31(0x223)](_0x465b31(0x26e))[_0x465b31(0x232)]()||{};}function getBlacklist(){const _0x46f68e=_0x5db121;return dbSecure[_0x46f68e(0x223)](_0x46f68e(0x173))['value']()||[];}function broadcastToBots(_0x9f348d,_0x421b86){const _0x585529=_0x5db121;config[_0x585529(0x242)](_0x21953a=>{const _0xd6fe87=_0x585529;if(_0x21953a[_0xd6fe87(0x2d9)]==_0xd6fe87(0x219)&&_0x21953a['live']==_0xd6fe87(0x2cb)||_0x21953a[_0xd6fe87(0x2d9)]==_0xd6fe87(0x205)&&_0x21953a['live']==_0xd6fe87(0x2cb)){if(pid[_0x21953a[_0xd6fe87(0x217)]])pid[_0x21953a[_0xd6fe87(0x217)]][_0xd6fe87(0x15b)]({[_0x9f348d]:_0x421b86});}});}function storeSettings(_0x312231,_0x2cee7e=![]){const _0xfd46c9=_0x5db121;_0x312231={...settings,..._0x312231};if(_0x2cee7e&&_0x312231[_0xfd46c9(0x188)]!=_0xfd46c9(0x2d6)&&_0x312231[_0xfd46c9(0x188)]!=_0xfd46c9(0x16f)&&_0x312231[_0xfd46c9(0x188)]!=''){const _0x4a46ec=crypt[_0xfd46c9(0x123)](secure[_0xfd46c9(0x238)],_0x312231[_0xfd46c9(0x188)])['message'][_0xfd46c9(0x182)]('@')[0x0],_0x2d557b=bcrypt[_0xfd46c9(0x290)](_0x4a46ec,saltRounds);_0x312231={..._0x312231,'bbPassword':_0x2d557b};}if(_0x2cee7e&&_0x312231[_0xfd46c9(0x2c9)]!=_0xfd46c9(0x2d6)&&_0x312231[_0xfd46c9(0x2c9)]!=_0xfd46c9(0x16f)&&_0x312231['telegramToken']!=''){const _0x97facc=crypt[_0xfd46c9(0x123)](secure[_0xfd46c9(0x238)],_0x312231['telegramToken'])[_0xfd46c9(0x169)][_0xfd46c9(0x182)]('@')[0x0];_0x312231={..._0x312231,'telegramToken':_0x97facc};}const _0x391ffc=_0x312231['telegramToken']!=_0xfd46c9(0x2d6)&&_0x312231[_0xfd46c9(0x2c9)]!=settings[_0xfd46c9(0x2c9)]||_0x312231['telegramUsername']!=settings[_0xfd46c9(0x187)],_0x52a3dd=_0x312231[_0xfd46c9(0x2c9)]==''||_0x312231['telegramUsername']=='';if(_0x391ffc)_0x312231[_0xfd46c9(0x161)]=_0xfd46c9(0x28a);for(const [_0x1fdb58,_0x5c0764]of Object[_0xfd46c9(0x1c0)](_0x312231)){if(_0x1fdb58==_0xfd46c9(0x2c9)&&_0x5c0764=='************'){_0x312231['telegramToken']=settings[_0xfd46c9(0x2c9)];continue;};if(_0x1fdb58==_0xfd46c9(0x188)&&_0x5c0764=='************'){_0x312231[_0xfd46c9(0x188)]=settings[_0xfd46c9(0x188)];continue;};dbSettings['set'](_0xfd46c9(0x1f1)+_0x1fdb58,_0x5c0764)[_0xfd46c9(0x134)]();}settings=_0x312231,io['to'](_0xfd46c9(0x291))[_0xfd46c9(0x17c)](_0xfd46c9(0x1ea),cleanSettings()),broadcastToBots('timeshift',settings[_0xfd46c9(0x274)]),broadcastToBots(_0xfd46c9(0x2d2),settings[_0xfd46c9(0x2d2)]);if(_0x391ffc&&!_0x52a3dd)initTelegram();if(_0x391ffc&&_0x52a3dd)disableTelegram();getAllClients()[_0xfd46c9(0x242)](_0x55e04b=>{const _0x5b1375=_0xfd46c9;getSocket(_0x55e04b['id'])['emit'](_0x5b1375(0x2d9),{'access':{'allow':![],'reason':_0x5b1375(0x153),'token':null}});});}function updateSetting(_0x285497,_0x25f72c){const _0x2a1f47=_0x5db121;dbSettings[_0x2a1f47(0x1e7)](_0x2a1f47(0x1f1)+_0x285497,_0x25f72c)[_0x2a1f47(0x134)](),settings=getSettings(),io['to'](_0x2a1f47(0x291))[_0x2a1f47(0x17c)](_0x2a1f47(0x1ea),cleanSettings());}function storeSecure(_0x44e468){const _0x4ef577=_0x5db121;dbSecure['get'](_0x4ef577(0x26e))['push'](_0x44e468)[_0x4ef577(0x134)](),secure=_0x44e468;}function addBlacklist(_0x211bf3){const _0x51b81a=_0x5db121;cleanBlacklist();let _0x522f1c;devices[_0x211bf3][_0x51b81a(0x16b)]?_0x522f1c=Math[_0x51b81a(0x1d8)](devices[_0x211bf3]['telegramIpApproval']['expiry'],loginExpiry):_0x522f1c=loginExpiry,dbSecure[_0x51b81a(0x223)](_0x51b81a(0x173))[_0x51b81a(0x250)]({'expiry':new Date()[_0x51b81a(0x28d)]()+_0x522f1c*0x3c*0x3e8,'token':devices[_0x211bf3][_0x51b81a(0x1cf)]['token']})['write'](),blacklist=dbSecure[_0x51b81a(0x223)](_0x51b81a(0x173))[_0x51b81a(0x232)]();}function cleanBlacklist(){const _0x16e3bd=_0x5db121;let _0x4eee32=dbSecure[_0x16e3bd(0x223)]('blacklist')[_0x16e3bd(0x2a3)]()[_0x16e3bd(0x232)](),_0x1adb7f=new Date()[_0x16e3bd(0x28d)]();_0x4eee32[_0x16e3bd(0x242)](_0x26b806=>{const _0x2c7079=_0x16e3bd;_0x26b806[_0x2c7079(0x26f)]<_0x1adb7f&&dbSecure[_0x2c7079(0x223)]('blacklist')[_0x2c7079(0x1b1)]({'expiry':_0x26b806['expiry']})['write']();});}function initStates(){let _0x1c430d=getConfiguration();_0x1c430d['forEach'](_0x4bf410=>{const _0xa49717=_0x54c1;_0x4bf410['live']=_0xa49717(0x191);}),storeConfiguration(_0x1c430d);}function onKeys(){const _0x24c7a8=new RSA();return new Promise(_0x4e314c=>{const _0x10ef41=_0x54c1;_0x24c7a8[_0x10ef41(0x1e1)]()['then'](_0x4d85e4=>{_0x4e314c(_0x4d85e4);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x194a24=_0x5db121;let _0x2d3c87=getSettings(),_0x51cb16=![];!_0x2d3c87['hasOwnProperty']('lastmsgtelegram')&&(_0x2d3c87[_0x194a24(0x2ad)]=0x0,_0x51cb16=!![]);!_0x2d3c87[_0x194a24(0x2ab)](_0x194a24(0x12c))&&(_0x2d3c87[_0x194a24(0x12c)]=0x0,_0x51cb16=!![]);!_0x2d3c87[_0x194a24(0x2ab)]('latestversion')&&(_0x2d3c87[_0x194a24(0x262)]=_0x194a24(0x1a4),_0x51cb16=!![]);!_0x2d3c87['hasOwnProperty'](_0x194a24(0x2d2))&&(_0x2d3c87[_0x194a24(0x2d2)]=![],_0x51cb16=!![]);if(_0x51cb16)storeSettings(_0x2d3c87);try{fs[_0x194a24(0x20e)](configbackuppath,{'withFileTypes':!![]})[_0x194a24(0x242)](_0x490c08=>{const _0x39ddf3=_0x194a24;if(!_0x490c08['isDirectory']()){if(!_0x490c08['name'][_0x39ddf3(0x23f)]('backup-full@'))fs[_0x39ddf3(0x148)](configbackuppath+_0x490c08[_0x39ddf3(0x1db)]);}else fs[_0x39ddf3(0x282)](configbackuppath+_0x490c08['name'],{'recursive':!![]});});}catch(_0x4ae096){logger['debug']('Error\x20removing\x20old\x20backup\x20files:',_0x4ae096);}}function storeConfiguration(_0x527f97){const _0x413148=_0x5db121;dbConfig[_0x413148(0x223)]('bots')['remove']()['write'](),_0x527f97[_0x413148(0x242)](_0x4b2e47=>{delete _0x4b2e47['mode'];}),dbConfig['get'](_0x413148(0x226))[_0x413148(0x250)](..._0x527f97)['write'](),config=_0x527f97;}function resetPassword(){const _0x2ba8d9=_0x5db121;tgBot&&settings[_0x2ba8d9(0x183)]&&(tgBot[_0x2ba8d9(0x1d7)](_0x2ba8d9(0x167)),tgBot['sendMessage'](settings['telegramChatId'],_0x2ba8d9(0x140),{'parse_mode':_0x2ba8d9(0x2a6),'reply_markup':{'inline_keyboard':[[{'text':_0x2ba8d9(0x230),'callback_data':_0x2ba8d9(0x230)},{'text':'no','callback_data':'no'}]]}})[_0x2ba8d9(0x180)](_0x3de2c0=>{telegramError(_0x3de2c0);}),tgBot['on'](_0x2ba8d9(0x167),async _0x59fe95=>{const _0x2b50b6=_0x2ba8d9,_0x42343a=_0x59fe95['data'],_0x329192=_0x59fe95[_0x2b50b6(0x169)];tgBot['answerCallbackQuery'](_0x59fe95['id'])[_0x2b50b6(0x213)](async()=>{const _0xee331a=_0x2b50b6;if(_0x42343a!='no'){const _0x58346e=0xf,_0x144331=_0xee331a(0x11d),_0x5ac73e=Array[_0xee331a(0x243)](crypto['randomFillSync'](new Uint32Array(_0x58346e)))['map'](_0x3dbfe6=>_0x144331[_0x3dbfe6%_0x144331[_0xee331a(0x1ef)]])['join'](''),_0x4b9728=bcrypt[_0xee331a(0x290)](_0x5ac73e,saltRounds);storeSettings({'bbPassword':_0x4b9728}),await tgBot[_0xee331a(0x2dd)](_0x329192[_0xee331a(0x25c)]['id'],_0xee331a(0x17f)+_0x5ac73e,{'parse_mode':_0xee331a(0x2a6)})[_0xee331a(0x180)](_0x23ee3c=>{telegramError(_0x23ee3c);});}else await tgBot[_0xee331a(0x2dd)](_0x329192[_0xee331a(0x25c)]['id'],_0xee331a(0x181))['catch'](_0x27f3eb=>{telegramError(_0x27f3eb);});}),tgBot[_0x2b50b6(0x1d7)]('callback_query');}));}async function confirmRestore(_0x17d663,_0x2e1746){const _0x3675d6=_0x5db121;io['to']('botmanager')[_0x3675d6(0x17c)]('notification',_0x3675d6(0x1a9),_0x3675d6(0x29f)),tgBot&&settings['telegramChatId']&&(tgBot['removeListener']('callback_query'),await tgBot[_0x3675d6(0x2dd)](settings[_0x3675d6(0x183)],_0x3675d6(0x192),{'parse_mode':_0x3675d6(0x2a6),'reply_markup':{'inline_keyboard':[[{'text':_0x3675d6(0x230),'callback_data':_0x3675d6(0x230)},{'text':'no','callback_data':'no'}]]}})[_0x3675d6(0x180)](_0x32d570=>{telegramError(_0x32d570);}),tgBot['on'](_0x3675d6(0x167),async _0x2acd27=>{const _0x342d10=_0x3675d6,_0x1bc495=_0x2acd27[_0x342d10(0x176)],_0x132d9d=_0x2acd27[_0x342d10(0x169)];tgBot[_0x342d10(0x1f2)](_0x2acd27['id'])[_0x342d10(0x213)](async()=>{const _0x3c8a72=_0x342d10;_0x1bc495==_0x3c8a72(0x230)?(await tgBot[_0x3c8a72(0x2dd)](_0x132d9d[_0x3c8a72(0x25c)]['id'],_0x3c8a72(0x1d4),{'parse_mode':_0x3c8a72(0x2a6)})[_0x3c8a72(0x180)](_0x1f8e44=>{telegramError(_0x1f8e44);}),unzipFile(_0x17d663,_0x2e1746)):(logger[_0x3c8a72(0x14a)](_0x3c8a72(0x2be)),await tgBot[_0x3c8a72(0x2dd)](_0x132d9d[_0x3c8a72(0x25c)]['id'],_0x3c8a72(0x2be))[_0x3c8a72(0x180)](_0x46b9c2=>{telegramError(_0x46b9c2);}));}),tgBot['removeListener'](_0x342d10(0x167));}));}function getServerTime(){const _0x5312c=_0x5db121,_0xc2eb9=new Date();return _0xc2eb9[_0x5312c(0x240)]()+'/'+(_0xc2eb9[_0x5312c(0x27b)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0xc2eb9[_0x5312c(0x2e3)]()[_0x5312c(0x200)]()[_0x5312c(0x2dc)](0x2,'0')+'\x20'+_0xc2eb9[_0x5312c(0x19b)]()[_0x5312c(0x200)]()[_0x5312c(0x2dc)](0x2,'0')+':'+_0xc2eb9['getMinutes']()[_0x5312c(0x200)]()[_0x5312c(0x2dc)](0x2,'0')+':'+_0xc2eb9[_0x5312c(0x24e)]()[_0x5312c(0x200)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x4986d0=_0x5db121,_0x2713c7=shiftedTime();return _0x2713c7[_0x4986d0(0x240)]()+'/'+(_0x2713c7[_0x4986d0(0x27b)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x2713c7[_0x4986d0(0x2e3)]()['toString']()[_0x4986d0(0x2dc)](0x2,'0')+'\x20'+_0x2713c7['getHours']()[_0x4986d0(0x200)]()[_0x4986d0(0x2dc)](0x2,'0')+':'+_0x2713c7['getMinutes']()[_0x4986d0(0x200)]()['padStart'](0x2,'0')+':'+_0x2713c7['getSeconds']()['toString']()[_0x4986d0(0x2dc)](0x2,'0');}function getCleanTimeStamp(){const _0xf64679=_0x5db121,_0x11ab13=shiftedTime();return _0x11ab13['getFullYear']()+(_0x11ab13['getMonth']()+0x1)[_0xf64679(0x200)]()[_0xf64679(0x2dc)](0x2,'0')+_0x11ab13[_0xf64679(0x2e3)]()[_0xf64679(0x200)]()[_0xf64679(0x2dc)](0x2,'0')+'-'+_0x11ab13[_0xf64679(0x19b)]()[_0xf64679(0x200)]()['padStart'](0x2,'0')+_0x11ab13[_0xf64679(0x2ba)]()['toString']()['padStart'](0x2,'0')+_0x11ab13['getSeconds']()[_0xf64679(0x200)]()[_0xf64679(0x2dc)](0x2,'0');}function shiftedTime(){const _0x35ac57=_0x5db121,_0xb4e3b0=new Date();let _0x521a49=_0xb4e3b0;if(settings[_0x35ac57(0x274)]&&settings['timeshift']!==0x0)_0x521a49=fns[_0x35ac57(0x2da)](_0xb4e3b0,{'hours':settings['timeshift']});return _0x521a49;}function startScheduler(){const _0x3e8aa5=_0x5db121,_0x4a2bfa=new Date()[_0x3e8aa5(0x284)](),_0x269142=shiftedTime()[_0x3e8aa5(0x19b)]();_0x269142==0x4&&backupConfigFiles();_0x269142==0x0&&rotateLogFiles();_0x4a2bfa%0x6==0x0&&triggerAnalytics();_0x4a2bfa%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x7d2c0b){const _0x53291e=_0x5db121;logger[_0x53291e(0x14a)]('Restore\x20backup\x20file\x20'+_0x7d2c0b);const _0x5c9f50=getBotsWithMode();_0x5c9f50[_0x53291e(0x1ef)]>0x0?confirmRestore(configbackuppath,_0x7d2c0b):unzipFile(configbackuppath,_0x7d2c0b);}async function getBackupFiles(_0x1de013=null){const _0x23cbae=_0x5db121;let _0x418320=[],_0x47a024=fs[_0x23cbae(0x20e)](configbackuppath,{'withFileTypes':!![]});_0x47a024[_0x23cbae(0x27c)]((_0x1de6c0,_0x763dad)=>_0x1de6c0['name']<_0x763dad['name']?0x1:_0x763dad[_0x23cbae(0x1db)]<_0x1de6c0[_0x23cbae(0x1db)]?-0x1:0x0),_0x47a024['forEach'](_0x11a11d=>{const _0x7d3317=_0x23cbae;if(!_0x11a11d[_0x7d3317(0x2d1)]()&&_0x11a11d[_0x7d3317(0x1db)][_0x7d3317(0x23f)](_0x7d3317(0x118))&&_0x11a11d[_0x7d3317(0x1db)][_0x7d3317(0x2de)]('.zip')){const _0xc5b81b=formatDate(fs[_0x7d3317(0x18e)](configbackuppath+_0x11a11d['name'])[_0x7d3317(0x1f3)]);_0x418320[_0x7d3317(0x250)]({'name':_0x11a11d['name'],'mtime':_0xc5b81b});}});if(_0x1de013)io['to'](_0x1de013)[_0x23cbae(0x17c)](_0x23cbae(0x170),_0x418320);else return _0x418320;}async function backupConfigFiles(){const _0x4e90f0=_0x5db121;await zipFiles('backup-full');const _0x2e8822=getCleanTimeStamp();fs[_0x4e90f0(0x285)](zippath+'backup-full.zip',configbackuppath+(_0x4e90f0(0x118)+_0x2e8822+'.zip'));let _0x2cfe85=fs[_0x4e90f0(0x20e)](configbackuppath,{'withFileTypes':!![]});_0x2cfe85[_0x4e90f0(0x27c)]((_0x4eff24,_0x3480c5)=>_0x4eff24[_0x4e90f0(0x1db)]<_0x3480c5['name']?0x1:_0x3480c5[_0x4e90f0(0x1db)]<_0x4eff24[_0x4e90f0(0x1db)]?-0x1:0x0),_0x2cfe85[_0x4e90f0(0x1ef)]>maxBackups&&fs[_0x4e90f0(0x148)](configbackuppath+_0x2cfe85[_0x2cfe85[_0x4e90f0(0x1ef)]-0x1][_0x4e90f0(0x1db)]);}function rotateLogFiles(){const _0x10d5f2=_0x5db121,_0x5364b4=fs['statSync'](logspath+_0x10d5f2(0x1f5)),_0x5f0d7c=_0x5364b4[_0x10d5f2(0x1a7)]/0x400;if(_0x5f0d7c>0x64){let _0xaf6155=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0xaf6155[_0x10d5f2(0x27c)]((_0x3bb140,_0x43fff2)=>_0x3bb140[_0x10d5f2(0x1db)]<_0x43fff2[_0x10d5f2(0x1db)]?0x1:_0x43fff2[_0x10d5f2(0x1db)]<_0x3bb140[_0x10d5f2(0x1db)]?-0x1:0x0),_0xaf6155[_0x10d5f2(0x242)](_0x48d5b9=>{const _0x89f4b1=_0x10d5f2;if(_0x48d5b9[_0x89f4b1(0x1db)]==_0x89f4b1(0x2a9))fs[_0x89f4b1(0x285)](logspath+_0x48d5b9[_0x89f4b1(0x1db)],logspath+_0x89f4b1(0x283));if(_0x48d5b9[_0x89f4b1(0x1db)]==_0x89f4b1(0x15c))fs[_0x89f4b1(0x285)](logspath+_0x48d5b9[_0x89f4b1(0x1db)],logspath+'output-002.log');_0x48d5b9[_0x89f4b1(0x1db)]=='output-000.log'&&(fs['copyFileSync'](logspath+_0x48d5b9[_0x89f4b1(0x1db)],logspath+_0x89f4b1(0x15c)),fs[_0x89f4b1(0x156)](logspath+_0x48d5b9[_0x89f4b1(0x1db)],''));});}}async function zipFiles(_0x295d4a){const _0x51837d=_0x5db121;let _0x111280;if(_0x295d4a==_0x51837d(0x2b0))_0x111280=logspath;if(_0x295d4a==_0x51837d(0x193))_0x111280=configpath;if(_0x295d4a==_0x51837d(0x190))_0x111280=configpath;let _0x2dca0a=fs['readdirSync'](_0x111280,{'withFileTypes':!![]});const _0x35bf9e=new require(_0x51837d(0x29e))();_0x2dca0a[_0x51837d(0x242)](_0x42a755=>{const _0x3e296f=_0x51837d;if(!_0x42a755[_0x3e296f(0x2d1)]()){let _0x2c52ec=fs['readFileSync'](_0x111280+_0x42a755['name']);if(_0x295d4a=='backup'){const _0x185b08=/^bot-[0-9]{3}-config.json$/,_0x2766d8=_0x185b08[_0x3e296f(0x1e9)](_0x42a755[_0x3e296f(0x1db)]);if(_0x2766d8){const _0x1e3046=JSON[_0x3e296f(0x197)](_0x2c52ec);if(_0x1e3046[_0x3e296f(0x138)][0x0]){_0x1e3046[_0x3e296f(0x138)][0x0][_0x3e296f(0x1ab)]=_0x3e296f(0x16f),_0x1e3046[_0x3e296f(0x138)][0x0][_0x3e296f(0x10a)]='***';if(_0x1e3046[_0x3e296f(0x138)][0x0]['apiPassword'])_0x1e3046[_0x3e296f(0x138)][0x0][_0x3e296f(0x14c)]=_0x3e296f(0x16f);}_0x2c52ec=JSON[_0x3e296f(0x132)](_0x1e3046,null,0x2);}if(_0x42a755['name']=='bb-settings.json'){const _0x1650c5=JSON['parse'](_0x2c52ec);if(_0x1650c5['settings'][_0x3e296f(0x2cc)])_0x1650c5[_0x3e296f(0x1ea)]['loginRequired']=![];if(_0x1650c5[_0x3e296f(0x1ea)][_0x3e296f(0x188)])_0x1650c5[_0x3e296f(0x1ea)]['bbPassword']='***';if(_0x1650c5[_0x3e296f(0x1ea)]['telegramToken'])_0x1650c5[_0x3e296f(0x1ea)][_0x3e296f(0x2c9)]=_0x3e296f(0x16f);if(_0x1650c5[_0x3e296f(0x1ea)][_0x3e296f(0x183)])_0x1650c5[_0x3e296f(0x1ea)][_0x3e296f(0x183)]=null;_0x2c52ec=JSON[_0x3e296f(0x132)](_0x1650c5,null,0x2);}if(_0x42a755['name']!=_0x3e296f(0x2d5))_0x35bf9e['file'](_0x42a755[_0x3e296f(0x1db)],_0x2c52ec);}else _0x35bf9e[_0x3e296f(0x136)](_0x42a755['name'],_0x2c52ec);}});const _0xd996f0=_0x35bf9e[_0x51837d(0x1a0)]({'base64':![],'compression':_0x51837d(0x13a)});fs[_0x51837d(0x156)](zippath+(_0x295d4a+_0x51837d(0x23e)),_0xd996f0,_0x51837d(0x2e2));}async function unzipFile(_0x2f9494,_0x52fa19){const _0xaf7ae7=_0x5db121;fs[_0xaf7ae7(0x20e)](configpath,{'withFileTypes':!![]})[_0xaf7ae7(0x242)](_0x4f4ffa=>{const _0x3318ca=_0xaf7ae7;if(!_0x4f4ffa['isDirectory']())fs['rmSync'](configpath+_0x4f4ffa[_0x3318ca(0x1db)]);});const _0x57a211=fs[_0xaf7ae7(0x1ad)](_0x2f9494+_0x52fa19,_0xaf7ae7(0x2e2)),_0x4a9327=new require(_0xaf7ae7(0x29e))(_0x57a211,{'base64':![],'checkCRC32':!![]});Object[_0xaf7ae7(0x1d1)](_0x4a9327[_0xaf7ae7(0x189)])[_0xaf7ae7(0x242)](_0x1ac118=>{const _0x473d31=_0xaf7ae7,_0x1fba73=_0x4a9327[_0x473d31(0x189)][_0x1ac118];fs['writeFileSync'](configpath+_0x1fba73['name'],_0x1fba73[_0x473d31(0x2a0)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0xaf7ae7(0x242)](_0x4f2042=>{const _0x52ba2d=_0xaf7ae7;if(!_0x4f2042[_0x52ba2d(0x2d1)]())fs[_0x52ba2d(0x282)](temppath+_0x4f2042['name']);}),logger['debug'](_0xaf7ae7(0x128)),process[_0xaf7ae7(0x15b)]({'restore':!![]},_0x487615=>{});}async function getPublicIp(){const _0x445399=_0x5db121;try{const _0x5a67b0=await axios['get']('https://api.ipify.org?format=json');publicip=_0x5a67b0[_0x445399(0x176)]['ip'];}catch(_0x38b3cd){}}async function triggerAnalytics(){const _0x42c9e3=_0x5db121;if(!publicip)await getPublicIp();const _0x2dc908=getBotsWithMode();let _0x1f566b=0x0;_0x2dc908[_0x42c9e3(0x242)](_0x450b56=>{const _0x5b499a=_0x42c9e3;if(_0x450b56[_0x5b499a(0x2d9)]==='enabled')_0x1f566b++;});const _0x3171d2=getBotExchanges();mixpanel[_0x42c9e3(0x273)]('Server',{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x2dc908['length'],'numbotsenabled':_0x1f566b,'exchanges':_0x3171d2});}async function getMessages(){const _0x7e508f=_0x5db121,_0x24a678=_0x7e508f(0x2b7),_0x2cc8d4=new GraphQLClient(_0x24a678),_0x406a88={'authorization':_0x7e508f(0x29a)},_0x190094=serverversion[_0x7e508f(0x182)]('.'),_0xb17807=_0x190094[0x0]+'.'+_0x190094[0x1],_0x257655=Math[_0x7e508f(0x1e2)](settings[_0x7e508f(0x2ad)],settings[_0x7e508f(0x12c)]),_0x33b39f={'last':parseInt(_0x257655),'bbm':_0xb17807},_0x51e1d6=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1cec3b;try{_0x1cec3b=await _0x2cc8d4[_0x7e508f(0x27d)](_0x51e1d6,_0x33b39f,_0x406a88);}catch(_0x467a89){}if(_0x1cec3b&&_0x1cec3b[_0x7e508f(0x22e)]){let _0x11377b=settings[_0x7e508f(0x2ad)];newMessages=[];for(const _0x35d69a of _0x1cec3b[_0x7e508f(0x22e)]){newMessages[_0x7e508f(0x250)](_0x35d69a);if(_0x35d69a['bbvNew'])updateSetting(_0x7e508f(0x262),_0x35d69a[_0x7e508f(0x11e)]);let _0x74b810=_0x35d69a['bbvNew']?serverversion>=_0x35d69a[_0x7e508f(0x11e)]:![];if(!_0x74b810&&_0x35d69a[_0x7e508f(0x19d)]>_0x11377b){if(_0x35d69a[_0x7e508f(0x1d9)]==='any'||serverversion[_0x7e508f(0x23f)](_0x35d69a[_0x7e508f(0x1d9)])){let _0x33c488=''+_0x35d69a[_0x7e508f(0x171)]+'\x0a\x0a'+_0x35d69a['message'];const _0x38fd01=await sendTelegramMsg(toTelegramMarkdown(_0x33c488),_0x7e508f(0x10d));if(_0x38fd01)_0x11377b=_0x35d69a[_0x7e508f(0x19d)];}}}updateAvailable=isNewerVersion(settings[_0x7e508f(0x262)],serverversion),updateSetting(_0x7e508f(0x2ad),_0x11377b),emitMessages();}}function emitMessages(){const _0x2b8c4c=_0x5db121,_0x3f78eb=settings[_0x2b8c4c(0x12c)];let _0x14f8fe=[];newMessages[_0x2b8c4c(0x242)](_0x2db035=>{const _0x36e673=_0x2b8c4c;_0x2db035[_0x36e673(0x19d)]>_0x3f78eb&&_0x14f8fe[_0x36e673(0x250)](_0x2db035);}),_0x14f8fe['length']>0x0&&getAllClients()['forEach'](_0x42b9bc=>{const _0x2e0fbb=_0x2b8c4c;getSocket(_0x42b9bc['id'])['emit'](_0x2e0fbb(0x169),_0x14f8fe);});}function confirmMessage(_0x1ac3c6){const _0x410143=_0x5db121;updateSetting(_0x410143(0x12c),Number(_0x1ac3c6));}function isNewerVersion(_0x5d46c1,_0x448a3c){const _0x42d980=_0x5db121,_0xcda0b3=_0x448a3c[_0x42d980(0x182)]('.'),_0x3604c7=_0x5d46c1[_0x42d980(0x182)]('.');for(var _0x349c04=0x0;_0x349c04<_0x3604c7['length'];_0x349c04++){const _0x11683d=~~_0x3604c7[_0x349c04],_0x5e5900=~~_0xcda0b3[_0x349c04];if(_0x11683d>_0x5e5900)return!![];if(_0x11683d<_0x5e5900)return![];}return![];}function toTelegramMarkdown(_0x5bbc60){const _0x10ae34=_0x5db121,_0xb2b507=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x304e65=/\*{2}(.+?)\*{2}/gim;return _0x5bbc60=_0x5bbc60[_0x10ae34(0x20f)](_0xb2b507,_0x10ae34(0x1fd))[_0x10ae34(0x20f)](_0x304e65,_0x10ae34(0x124)),_0x5bbc60;}async function validateConfigFile(){const _0x195d01=_0x5db121,_0x51ca50=dbConfig['get'](_0x195d01(0x226))[_0x195d01(0x263)]('botID')[_0x195d01(0x232)]()||[];if(_0x51ca50['length']==0x0){let _0x3c2c80=0x0,_0x1f910e=[];const _0x126f80=/^bot-([0-9]{3})-config.json$/,_0x21faa1=fs[_0x195d01(0x20e)](configpath);_0x21faa1[_0x195d01(0x242)](_0x59e3fb=>{const _0x32708f=_0x195d01,_0x5006dc=_0x126f80[_0x32708f(0x28b)](_0x59e3fb);if(_0x5006dc){const _0x430855=_0x5006dc[0x1];let _0xd01e23=getBotAttributes(_0x430855);_0x1f910e[_0x32708f(0x250)]({'botID':_0x430855,'botname':_0xd01e23[_0x32708f(0x163)],'status':'disabled','live':'stopped'}),_0x3c2c80++;}}),_0x3c2c80!=0x0&&(dbConfig[_0x195d01(0x223)](_0x195d01(0x226))[_0x195d01(0x231)](_0x1f910e)[_0x195d01(0x134)](),config=_0x1f910e,restoredConfigFile=_0x3c2c80);}}async function restoreConfigNotify(_0x55c835){const _0x51c1ea=_0x5db121;let _0x56a3c3;if(restoredConfigFile==0x1)_0x56a3c3=_0x51c1ea(0x2ca);else _0x56a3c3=_0x51c1ea(0x1fb);if(_0x55c835)io['to'](_0x51c1ea(0x291))['emit'](_0x51c1ea(0x1c4),_0x56a3c3);else{logger['simple'](_0x51c1ea(0x220)),logger[_0x51c1ea(0x264)](_0x56a3c3),logger[_0x51c1ea(0x264)](_0x51c1ea(0x220)),logger[_0x51c1ea(0x264)]('');if(tgBot&&settings[_0x51c1ea(0x183)]&&settings['telegramEvents']!=_0x51c1ea(0x12e))tgBot[_0x51c1ea(0x2dd)](settings[_0x51c1ea(0x183)],_0x51c1ea(0x10b)+_0x56a3c3)[_0x51c1ea(0x180)](_0x16ef5a=>{telegramError(_0x16ef5a);});}}function validateCredentials(_0x3315a2,_0x1dbd43){const _0x23f6e2=_0x5db121;if(_0x3315a2['username']==settings[_0x23f6e2(0x2b3)]&&bcrypt[_0x23f6e2(0x234)](_0x3315a2[_0x23f6e2(0x164)],settings[_0x23f6e2(0x188)])){if(settings[_0x23f6e2(0x117)])return{'allow':![],'reason':_0x23f6e2(0x1bc),'token':null};else{const _0x3b77a5=generateLoginToken(_0x1dbd43);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x3b77a5};}}else return{'allow':![],'reason':_0x23f6e2(0x24d),'token':null};}function refreshToken(_0x38977b){const _0x35786e=generateLoginToken(_0x38977b);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x35786e};}function validateAccess(_0x1dbd44,_0x470628,_0x460a83){const _0x110128=_0x5db121,_0x5a1264=_0x460a83?_0x460a83:devices[_0x470628]['ip'];let _0x1eee61;const _0x2d475b=_0x4cd50d=>{const _0x17d8fd=_0x54c1;if(settings[_0x17d8fd(0x2cc)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x470628)){const _0x1de117=generateLoginToken(_0x470628);return{'allow':!![],'reason':_0x17d8fd(0x12b),'token':_0x1de117};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x1eee61=validToken(_0x4cd50d,_0x470628),_0x1eee61[_0x17d8fd(0x2ab)](_0x17d8fd(0x29f))?{'allow':!![],'reason':_0x17d8fd(0x2c6),'token':_0x4cd50d}:{'allow':![],'reason':_0x17d8fd(0x2bd),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x110128(0x255)]){let _0x272a96=[...settings['whitelist'],_0x110128(0x25a),'::ffff:127.0.0.1',_0x110128(0x162)];if(_0x272a96[_0x110128(0x1d6)](_0x5a1264))return _0x2d475b(_0x1dbd44);else{_0x1eee61=validToken(_0x1dbd44,_0x470628);if(_0x1eee61[_0x110128(0x2ab)](_0x110128(0x29f)))return _0x2d475b(_0x1dbd44);else{if(telegramIpApproved(_0x470628)){const _0x25d79b=generateToken(_0x470628);return _0x1eee61=_0x2d475b(_0x1dbd44),_0x1eee61['allow']?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x25d79b}:_0x1eee61;}else return settings[_0x110128(0x2ce)]?{'allow':![],'reason':_0x110128(0x26b),'token':null}:{'allow':![],'reason':_0x110128(0x298),'token':null};}}}else return _0x2d475b(_0x1dbd44);}function timelyDecrypt(_0x11ffc5,_0x4312ec=!![]){const _0x5b9667=_0x5db121;if(_0x11ffc5)try{const _0xf2d864=crypt[_0x5b9667(0x123)](secure['privateKey'],_0x11ffc5)[_0x5b9667(0x169)],_0x3a2aa8=_0xf2d864[_0x5b9667(0x182)]('@')[0x0],_0x4c8bc9=_0xf2d864[_0x5b9667(0x182)]('@')[0x1],_0x25634d=new Date()['getTime']();if(_0x4312ec){if(_0x25634d-_0x4c8bc9<maxSecretAge*0x3e8)return _0x3a2aa8;else return![];}else return _0x3a2aa8;}catch(_0x1191c8){return![];}else return![];}const validToken=(_0x6d110,_0x34522a)=>{const _0x204d13=_0x5db121,_0x45709c=devices[_0x34522a]['ip'];if(!_0x6d110)return{'error':'No\x20authentication\x20token'};for(let _0x3bded9 of blacklist){if(_0x3bded9[_0x204d13(0x1d0)]==_0x6d110)return{'error':_0x204d13(0x21b)};}let _0x25a0e2;try{_0x25a0e2=jwt[_0x204d13(0x212)](_0x6d110,secure['secret']+_0x34522a);}catch{return{'error':_0x204d13(0x208)};}if(!_0x25a0e2['hasOwnProperty'](_0x204d13(0x260))&&!_0x25a0e2[_0x204d13(0x2ab)](_0x204d13(0x23d))||!_0x25a0e2[_0x204d13(0x2ab)](_0x204d13(0x130)))return{'error':_0x204d13(0x2ac)};if(!_0x25a0e2[_0x204d13(0x2ab)](_0x204d13(0x23d))&&_0x25a0e2[_0x204d13(0x2ab)](_0x204d13(0x260))){const {clientip:_0x5f055a}=_0x25a0e2;return _0x45709c==_0x5f055a?{'success':_0x204d13(0x10e)}:{'error':_0x204d13(0x1bd)};}else{if(_0x25a0e2[_0x204d13(0x2ab)](_0x204d13(0x23d))&&_0x25a0e2['hasOwnProperty'](_0x204d13(0x260))){const {username:_0x12dcb5,clientip:_0x59a809}=_0x25a0e2;return settings[_0x204d13(0x2b3)]==_0x12dcb5&&_0x45709c==_0x59a809?{'success':_0x204d13(0x10e)}:{'error':_0x204d13(0x20b)};}}},generateLoginToken=_0x5d6fcf=>{const _0x7ea371=_0x5db121;if(_0x5d6fcf){const _0x854719=devices[_0x5d6fcf]['ip'];return jwt['sign']({'username':settings[_0x7ea371(0x2b3)],'clientip':_0x854719},secure[_0x7ea371(0x139)]+_0x5d6fcf,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x19817a=>{const _0xc328c3=_0x5db121;if(_0x19817a){const _0x563997=devices[_0x19817a]['ip'];return jwt[_0xc328c3(0x1ee)]({'clientip':_0x563997},secure['secret']+_0x19817a,{'expiresIn':devices[_0x19817a][_0xc328c3(0x16b)][_0xc328c3(0x26f)]*0x3c});}else return![];},telegramIpApproved=_0x5d38d4=>{const _0x3d2814=_0x5db121;let _0x126b24=![];return devices[_0x5d38d4][_0x3d2814(0x16b)]&&devices[_0x5d38d4][_0x3d2814(0x16b)][_0x3d2814(0x26f)]!='reject'&&(_0x126b24=devices[_0x5d38d4][_0x3d2814(0x16b)][_0x3d2814(0x260)]==devices[_0x5d38d4]['ip']&&new Date()[_0x3d2814(0x28d)]()-devices[_0x5d38d4][_0x3d2814(0x16b)][_0x3d2814(0x185)]<devices[_0x5d38d4][_0x3d2814(0x16b)][_0x3d2814(0x26f)]*0x3c*0x3e8),_0x126b24;},telegram2FaApproved=_0x4c5ede=>{const _0x14d732=_0x5db121;let _0x1a4789=![];return devices[_0x4c5ede][_0x14d732(0x13e)]&&devices[_0x4c5ede]['telegram2FaApproval']['expiry']!=_0x14d732(0x13d)&&(_0x1a4789=devices[_0x4c5ede][_0x14d732(0x13e)]['clientip']==devices[_0x4c5ede]['ip']&&new Date()['getTime']()-devices[_0x4c5ede][_0x14d732(0x13e)][_0x14d732(0x185)]<devices[_0x4c5ede][_0x14d732(0x13e)]['expiry']*0x3c*0x3e8),_0x1a4789;},normalizeIP=_0x21250d=>{const _0xa613b1=_0x5db121;let _0x24b0de=null,_0x4d2943=null;if(ipaddr[_0xa613b1(0x157)](_0x21250d)){const _0x5c25ee=ipaddr[_0xa613b1(0x197)](_0x21250d);_0x5c25ee['kind']()===_0xa613b1(0x2e6)?(_0x5c25ee['isIPv4MappedAddress']()&&(_0x24b0de=_0x5c25ee[_0xa613b1(0x2b8)]()[_0xa613b1(0x200)]()),_0x4d2943=_0x5c25ee[_0xa613b1(0x200)]()):(_0x24b0de=_0x5c25ee[_0xa613b1(0x200)](),_0x4d2943=_0x5c25ee[_0xa613b1(0x1c2)]()['toString']());}return{'show':_0x24b0de?_0x24b0de:_0x4d2943,'store':_0x4d2943};};function formatDate(_0x57ce09){const _0x3167f3=_0x5db121;return _0x57ce09[_0x3167f3(0x240)]()+'/'+(_0x57ce09[_0x3167f3(0x27b)]()+0x1)[_0x3167f3(0x200)]()[_0x3167f3(0x2dc)](0x2,'0')+'/'+_0x57ce09[_0x3167f3(0x2e3)]()[_0x3167f3(0x200)]()[_0x3167f3(0x2dc)](0x2,'0')+'\x20'+_0x57ce09[_0x3167f3(0x19b)]()[_0x3167f3(0x200)]()['padStart'](0x2,'0')+':'+_0x57ce09['getMinutes']()[_0x3167f3(0x200)]()['padStart'](0x2,'0')+':'+_0x57ce09[_0x3167f3(0x24e)]()[_0x3167f3(0x200)]()[_0x3167f3(0x2dc)](0x2,'0');}function sleep(_0x44ecba){return new Promise(_0x5a40b0=>setTimeout(_0x5a40b0,_0x44ecba));}