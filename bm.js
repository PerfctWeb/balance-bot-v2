const _0x3b9479=_0x4b9e;(function(_0x19368b,_0x1c5a19){const _0x27df1a=_0x4b9e,_0x17e368=_0x19368b();while(!![]){try{const _0x5cc760=-parseInt(_0x27df1a(0x335))/0x1*(parseInt(_0x27df1a(0x2cd))/0x2)+-parseInt(_0x27df1a(0x373))/0x3*(parseInt(_0x27df1a(0x32d))/0x4)+parseInt(_0x27df1a(0x256))/0x5*(parseInt(_0x27df1a(0x39d))/0x6)+parseInt(_0x27df1a(0x249))/0x7*(-parseInt(_0x27df1a(0x296))/0x8)+parseInt(_0x27df1a(0x25f))/0x9+-parseInt(_0x27df1a(0x214))/0xa*(-parseInt(_0x27df1a(0x284))/0xb)+parseInt(_0x27df1a(0x274))/0xc*(-parseInt(_0x27df1a(0x363))/0xd);if(_0x5cc760===_0x1c5a19)break;else _0x17e368['push'](_0x17e368['shift']());}catch(_0x559995){_0x17e368['push'](_0x17e368['shift']());}}}(_0x3912,0x51e58));const _0x8cecc9=function(){let _0x3e7296=!![];return function(_0x64ca2e,_0x2fbd08){const _0xc8dc2a=_0x3e7296?function(){const _0x375401=_0x4b9e;if(_0x2fbd08){const _0x43a47e=_0x2fbd08[_0x375401(0x221)](_0x64ca2e,arguments);return _0x2fbd08=null,_0x43a47e;}}:function(){};return _0x3e7296=![],_0xc8dc2a;};}(),_0x578ac3=_0x8cecc9(this,function(){const _0x2f9f6e=_0x4b9e;return _0x578ac3[_0x2f9f6e(0x213)]()[_0x2f9f6e(0x3aa)](_0x2f9f6e(0x2a9))['toString']()['constructor'](_0x578ac3)[_0x2f9f6e(0x3aa)](_0x2f9f6e(0x2a9));});_0x578ac3();'use strict';process['env'][_0x3b9479(0x39e)]=0x1;const childProcess=require(_0x3b9479(0x25c)),fs=require('fs'),fns=require(_0x3b9479(0x216)),low=require(_0x3b9479(0x32c)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x3b9479(0x32f)),crypto=require(_0x3b9479(0x215)),Crypt=require(_0x3b9479(0x1fc))['Crypt'],RSA=require(_0x3b9479(0x1fc))[_0x3b9479(0x35f)],bcrypt=require(_0x3b9479(0x23c)),jwt=require(_0x3b9479(0x244)),ipaddr=require(_0x3b9479(0x38a)),argv=require(_0x3b9479(0x243))(process['argv'][_0x3b9479(0x381)](0x2))[_0x3b9479(0x328)],uuidRandom=require(_0x3b9479(0x2f5)),TelegramBot=require(_0x3b9479(0x394)),Mixpanel=require(_0x3b9479(0x323)),axios=require(_0x3b9479(0x300)),{GraphQLClient,gql}=require(_0x3b9479(0x334)),util=require(_0x3b9479(0x2c3)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv['port']||_0x3b9479(0x364),pattern=/^[0-9]{2,4}$/;!pattern[_0x3b9479(0x2e3)](PORT)&&(console[_0x3b9479(0x282)](_0x3b9479(0x2a1)+PORT+_0x3b9479(0x2ac)),process[_0x3b9479(0x361)](0x1));const HOST=argv[_0x3b9479(0x2dc)]||null,userID=argv[_0x3b9479(0x1e9)]||'',debugging=argv['d']||![],nodeversion=process[_0x3b9479(0x1f9)][_0x3b9479(0x242)];let bbpath=_0x3b9479(0x2b9),bbpath2='';const botfile=_0x3b9479(0x2a4),configfile=_0x3b9479(0x356),settingsfile='bb-settings.json',securefile=_0x3b9479(0x28e),maxBackups=0xa;let validInstallation=!![];!fs[_0x3b9479(0x1e4)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3b9479(0x318)),configpath=userID?bbpath+_0x3b9479(0x38e)+userID+'/':bbpath+_0x3b9479(0x38e),configbackuppath=configpath+_0x3b9479(0x29c),logspath=userID?bbpath+_0x3b9479(0x2d1)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x3b9479(0x38b),loggerfile=fs['createWriteStream'](logspath+_0x3b9479(0x37b),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x3b9479(0x1ea);!fs[_0x3b9479(0x1e4)](configpath)&&fs[_0x3b9479(0x2da)](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);function _0x4b9e(_0x37fbde,_0x145466){const _0x333a7c=_0x3912();return _0x4b9e=function(_0x578ac3,_0x8cecc9){_0x578ac3=_0x578ac3-0x1cf;let _0x3912e6=_0x333a7c[_0x578ac3];return _0x3912e6;},_0x4b9e(_0x37fbde,_0x145466);}!fs[_0x3b9479(0x1e4)](logspath)&&fs[_0x3b9479(0x2da)](logspath);!fs['existsSync'](zippath)&&fs[_0x3b9479(0x2da)](zippath);!fs[_0x3b9479(0x1e4)](temppath)&&fs[_0x3b9479(0x2da)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x3b9479(0x24e)]({'bots':[]})[_0x3b9479(0x2e1)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3b9479(0x24e)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x3b9479(0x2fe),'onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x3b9479(0x24e)]({'secure':{},'blacklist':[]})[_0x3b9479(0x2e1)]();let crypt=new Crypt({'md':_0x3b9479(0x37c),'rsaStandard':_0x3b9479(0x27d)});const saltRounds=0xa,mixpanel=Mixpanel[_0x3b9479(0x233)](_0x3b9479(0x339),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x3b9479(0x29d)]&&settings['telegramToken']!=''&&settings[_0x3b9479(0x355)]&&settings[_0x3b9479(0x355)]!='')initTelegram();const parseColor=(_0x5362f1,_0x5a38b5)=>{const _0x4fc773=_0x3b9479,_0x19b5fb=/#[A-Z]{3}#/g;!_0x5a38b5?_0x5362f1=_0x5362f1[_0x4fc773(0x1f2)](_0x19b5fb,''):(_0x5362f1=_0x5362f1[_0x4fc773(0x1f2)](/#BLU#/g,_0x4fc773(0x2c6)),_0x5362f1=_0x5362f1[_0x4fc773(0x1f2)](/#RED#/g,_0x4fc773(0x386)),_0x5362f1=_0x5362f1['replace'](/#YEL#/g,'\x1b[33m'),_0x5362f1=_0x5362f1['replace'](/#RES#/g,_0x4fc773(0x1d5)));;return _0x5362f1;},logger={'screen':_0x4870c5=>{const _0x5a1fd2=_0x3b9479;console[_0x5a1fd2(0x282)](parseColor(_0x4870c5,!![]));},'simple':_0x2ce705=>{const _0x40a259=_0x3b9479;console[_0x40a259(0x282)](parseColor(_0x2ce705,!![])),loggerfile[_0x40a259(0x2e1)](util['format'](parseColor(_0x2ce705,![]))+'\x0a');},'full':async _0x4cfea1=>{const _0x43c3fd=_0x3b9479,_0x4a450b=getTimeStamp()+_0x43c3fd(0x2e8)+_0x4cfea1;console[_0x43c3fd(0x282)](parseColor(_0x4a450b,!![])),loggerfile[_0x43c3fd(0x2e1)](util['format'](parseColor(_0x4a450b,![]))+'\x0a');if(tgBot&&settings[_0x43c3fd(0x1ef)]&&settings[_0x43c3fd(0x232)]!=_0x43c3fd(0x305))await tgBot[_0x43c3fd(0x376)](settings['telegramChatId'],_0x43c3fd(0x37d)+parseColor(_0x4cfea1,![]))[_0x43c3fd(0x32a)](_0x595ea9=>{telegramError(_0x595ea9);});},'debug':async(_0x416f9d,_0x11e484='')=>{const _0x3306b5=_0x3b9479,_0x479886=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x416f9d;if(debugging)console[_0x3306b5(0x282)](parseColor(_0x479886,!![]));loggerfile[_0x3306b5(0x2e1)](util[_0x3306b5(0x255)](parseColor(_0x479886,![]))+'\x0a');if(_0x11e484){if(debugging)console[_0x3306b5(0x282)](_0x11e484);loggerfile['write'](util[_0x3306b5(0x255)](_0x11e484)+'\x0a');}}};process['on'](_0x3b9479(0x396),function(_0x58a9ec){const _0x581fa6=_0x3b9479;logger[_0x581fa6(0x301)](_0x58a9ec);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x3b9479(0x264))[_0x3b9479(0x3b0)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x3b9479(0x2b1)),app=express(),http=require(_0x3b9479(0x322))['createServer'](app);app[_0x3b9479(0x39f)](fileUpload({'useTempFiles':!![]})),app[_0x3b9479(0x342)](_0x3b9479(0x269),async(_0x10ab62,_0x719567)=>{const _0x3cffe5=_0x3b9479,_0x387236=_0x10ab62[_0x3cffe5(0x1f4)][_0x3cffe5(0x283)],_0x3e7c6d=getClientsWithBotID(_0x3cffe5(0x37a)),_0x4e4866=_0x10ab62['headers']['uuid'],_0x34ecd9=timelyDecrypt(_0x4e4866,![]),_0x328159=_0x3e7c6d[_0x3cffe5(0x207)](_0xf03aa3=>_0xf03aa3['uuid']==_0x34ecd9);if(_0x328159){const _0x43d041=normalizeIP(_0x10ab62[_0x3cffe5(0x319)][_0x3cffe5(0x38f)])[_0x3cffe5(0x26b)],_0x335ba6=_0x10ab62[_0x3cffe5(0x3a3)]['tkn'];if(validateAccess(_0x335ba6,_0x34ecd9,_0x43d041)['allow'])_0x387236==_0x3cffe5(0x219)&&await backupConfigFiles(),await zipFiles(_0x387236),_0x719567[_0x3cffe5(0x33b)](zippath+(_0x387236+_0x3cffe5(0x390)),_0x348b35=>{const _0x57ecfe=_0x3cffe5;_0x348b35&&(logger[_0x57ecfe(0x1d0)](_0x57ecfe(0x21f)+_0x387236),logger[_0x57ecfe(0x301)](_0x348b35));});else logger[_0x3cffe5(0x1d0)](_0x3cffe5(0x2ca)+_0x387236+_0x3cffe5(0x2f3));}else logger[_0x3cffe5(0x1d0)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x387236+_0x3cffe5(0x39b));}),app['post']('/upload-backup',async(_0x213d40,_0x2402dd)=>{const _0x355d63=_0x3b9479,_0x5e6e40=getClientsWithBotID(_0x355d63(0x37a)),_0x4daf7f=_0x213d40[_0x355d63(0x3a3)]['uuid'],_0x2c705e=timelyDecrypt(_0x4daf7f,![]),_0x29395e=_0x5e6e40[_0x355d63(0x207)](_0x4671f4=>_0x4671f4[_0x355d63(0x2bd)]==_0x2c705e);logger[_0x355d63(0x1e5)]('Backup\x20file\x20uploaded');if(_0x29395e){const _0x4f258e=normalizeIP(_0x213d40[_0x355d63(0x319)][_0x355d63(0x38f)])[_0x355d63(0x26b)],_0x50cf63=_0x213d40['headers'][_0x355d63(0x2d5)];if(validateAccess(_0x50cf63,_0x2c705e,_0x4f258e)[_0x355d63(0x2c2)]){if(_0x213d40[_0x355d63(0x281)]){const _0x56a309=_0x213d40[_0x355d63(0x281)][_0x355d63(0x27b)];await _0x56a309['mv'](temppath+_0x56a309['name']),_0x2402dd[_0x355d63(0x205)]({'status':!![],'message':'File\x20uploaded'});const _0x1ed9ea=getBotsWithMode();_0x1ed9ea['length']>0x0?confirmRestore(temppath,_0x56a309[_0x355d63(0x2b4)]):unzipFile(temppath,_0x56a309[_0x355d63(0x2b4)]);}}else logger['full'](_0x355d63(0x35a));}else logger[_0x355d63(0x1d0)](_0x355d63(0x3a9));}),app['use'](express[_0x3b9479(0x360)](path[_0x3b9479(0x236)](__dirname,bbpath2,_0x3b9479(0x2b0)))),app[_0x3b9479(0x39f)](express[_0x3b9479(0x360)](path[_0x3b9479(0x236)](__dirname,bbpath2,_0x3b9479(0x1dd)))),app[_0x3b9479(0x342)]('/',function(_0x3d7f62,_0x477fd3){const _0x4de528=_0x3b9479;_0x477fd3['sendFile'](path[_0x4de528(0x236)](__dirname,bbpath2,_0x4de528(0x2b0),'index.html'));}),app[_0x3b9479(0x342)]('/:bot',function(_0x4f457c,_0x20a4c3){const _0x4a0306=_0x3b9479;_0x20a4c3['sendFile'](path[_0x4a0306(0x236)](__dirname,bbpath2,_0x4a0306(0x1dd),_0x4a0306(0x1e0)));}),app['get'](_0x3b9479(0x292),(_0x589123,_0xa07176)=>{const _0x482d95=_0x3b9479;_0xa07176[_0x482d95(0x23f)](path[_0x482d95(0x236)](__dirname,bbpath2,_0x482d95(0x1dd),_0x482d95(0x1e0)));}),app['get'](_0x3b9479(0x2aa),(_0x344d07,_0x55a554)=>{const _0x570952=_0x3b9479;_0x55a554[_0x570952(0x23f)](path['join'](__dirname,bbpath2,_0x570952(0x1dd),_0x570952(0x1e0)));}),app[_0x3b9479(0x342)](_0x3b9479(0x220),(_0x59bcd3,_0x1971dc)=>{const _0x117102=_0x3b9479;_0x1971dc['sendFile'](path['join'](__dirname,bbpath2,_0x117102(0x1dd),_0x117102(0x1e0)));}),app[_0x3b9479(0x342)](_0x3b9479(0x367),(_0x1d8ab2,_0x543ad3)=>{const _0x4c63a0=_0x3b9479;_0x543ad3[_0x4c63a0(0x23f)](path[_0x4c63a0(0x236)](__dirname,bbpath2,_0x4c63a0(0x1dd),'index.html'));}),app[_0x3b9479(0x342)](_0x3b9479(0x1ec),(_0x49864b,_0x5c0bab)=>{const _0x104a53=_0x3b9479;_0x5c0bab[_0x104a53(0x23f)](path['join'](__dirname,bbpath2,'build',_0x104a53(0x1e0)));}),app[_0x3b9479(0x342)](_0x3b9479(0x27f),(_0x3ba8b7,_0x32443e)=>{const _0x387ef4=_0x3b9479;_0x32443e[_0x387ef4(0x23f)](path[_0x387ef4(0x236)](__dirname,bbpath2,_0x387ef4(0x1dd),_0x387ef4(0x1e0)));});if(HOST)http[_0x3b9479(0x26d)](PORT,HOST);else http[_0x3b9479(0x26d)](PORT);const io=require(_0x3b9479(0x30b))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x31b894=_0x3b9479;let _0x9dd8a0=_0x31b894(0x206);const _0x4f9941=networkInterfaces(),_0x405a98={};for(const _0xef97ca of Object['keys'](_0x4f9941)){for(const _0xff30d7 of _0x4f9941[_0xef97ca]){if((_0xff30d7['family']=='IPv4'||_0xff30d7['family']==0x4)&&!_0xff30d7['internal']){const _0x4d0c3d=ipaddr['parse'](_0xff30d7[_0x31b894(0x2be)])[_0x31b894(0x337)]();_0x4d0c3d!=_0x31b894(0x2e4)&&(!_0x405a98[_0xef97ca]&&(_0x405a98[_0xef97ca]=[]),_0x405a98[_0xef97ca][_0x31b894(0x387)](_0xff30d7[_0x31b894(0x2be)]),_0x9dd8a0=_0xff30d7[_0x31b894(0x2be)]);}}}return logger[_0x31b894(0x1e5)]('Network\x20Interfaces:',_0x405a98),_0x9dd8a0;}async function startServer(){const _0x2bfd3c=_0x3b9479;logger[_0x2bfd3c(0x301)](''),logger[_0x2bfd3c(0x301)](_0x2bfd3c(0x30a)),await logger[_0x2bfd3c(0x1d0)](_0x2bfd3c(0x35e)+serverversion+_0x2bfd3c(0x1fa)+(_0x2bfd3c(0x399)+PORT+_0x2bfd3c(0x359))+(_0x2bfd3c(0x3ac)+getServerIP()+':'+PORT+_0x2bfd3c(0x260))),await logger[_0x2bfd3c(0x1e5)](_0x2bfd3c(0x238)+nodeversion),logger[_0x2bfd3c(0x301)](_0x2bfd3c(0x30a));if(config[_0x2bfd3c(0x357)]!=0x0)for(const _0x191376 of config){if(_0x191376[_0x2bfd3c(0x311)]==_0x2bfd3c(0x254)||_0x191376[_0x2bfd3c(0x311)]==_0x2bfd3c(0x224))await logger['full'](_0x2bfd3c(0x26c)+_0x191376[_0x2bfd3c(0x3a1)]+_0x2bfd3c(0x2a0)+_0x191376[_0x2bfd3c(0x28b)]),startBot([_0x191376[_0x2bfd3c(0x3a1)],userID],{'cwd':bbpath},function(_0xf71398){const _0x1d01e8=_0x2bfd3c;if(_0xf71398)logger[_0x1d01e8(0x1d0)](_0xf71398);});else(_0x191376[_0x2bfd3c(0x311)]==_0x2bfd3c(0x21b)||_0x191376[_0x2bfd3c(0x311)]==_0x2bfd3c(0x2c9))&&await logger[_0x2bfd3c(0x1d0)](_0x2bfd3c(0x2c1)+_0x191376[_0x2bfd3c(0x3a1)]+_0x2bfd3c(0x2a0)+_0x191376['botname']);}else!newBot&&logger[_0x2bfd3c(0x301)](_0x2bfd3c(0x22b));if(newBot)addBot();logger[_0x2bfd3c(0x301)](_0x2bfd3c(0x30a)),logger[_0x2bfd3c(0x301)]('');}function startSocket(){const _0x297e71=_0x3b9479;io['on'](_0x297e71(0x2db),_0xb49b35=>{const _0x1c2d71=_0x297e71;let _0x17d263,_0x53ebed,_0x3631c2,_0x8bd412,_0x5a3eb8;const _0x59e05e=_0xb49b35[_0x1c2d71(0x289)][_0x1c2d71(0x3a3)][_0x1c2d71(0x3a4)];_0x53ebed=_0x59e05e[_0x1c2d71(0x34e)](/bot[0-9]{3}/);if(_0x53ebed)_0x3631c2=_0x53ebed[0x0][_0x1c2d71(0x34e)](/[0-9]{3}/);if(_0x3631c2)_0x17d263=_0x3631c2[0x0];else _0x17d263=_0x1c2d71(0x37a);const _0x3a8029=_0xb49b35['handshake'][_0x1c2d71(0x39a)]['encryptedUuid'];if(!_0x3a8029)_0xb49b35['emit'](_0x1c2d71(0x311),{'publicKey':secure[_0x1c2d71(0x3af)]});else{_0x8bd412=timelyDecrypt(_0x3a8029,![]);if(!_0x8bd412)_0xb49b35[_0x1c2d71(0x37e)]('status',{'publicKey':secure[_0x1c2d71(0x3af)]});else{_0x5a3eb8=normalizeIP(_0xb49b35[_0x1c2d71(0x35d)][_0x1c2d71(0x38f)])['store'];if(!devices[_0x8bd412])devices[_0x8bd412]={'uuid':_0x8bd412,'access':{'token':null}};devices[_0x8bd412]['ip']=_0x5a3eb8;const _0x16e0e6=addClient(_0xb49b35['id'],_0x8bd412,_0x17d263);setAccess(_0x16e0e6),emitMessages(),_0xb49b35['on']('login',_0x4e6ca6=>{const _0x2eb897=_0x1c2d71,_0x15b9d8=timelyDecrypt(_0x4e6ca6[_0x2eb897(0x263)]);if(_0x15b9d8){_0x4e6ca6={'username':_0x4e6ca6['username'],'password':_0x15b9d8},devices[_0x8bd412]['access']=validateCredentials(_0x4e6ca6,_0x8bd412);if(devices[_0x8bd412][_0x2eb897(0x28c)][_0x2eb897(0x2c2)]==![]&&devices[_0x8bd412][_0x2eb897(0x28c)][_0x2eb897(0x2ef)]==_0x2eb897(0x1ed))_0xb49b35['emit'](_0x2eb897(0x311),{'access':devices[_0x8bd412][_0x2eb897(0x28c)]}),loginAccess2FA(_0x8bd412,_0x5a3eb8);else{if(devices[_0x8bd412][_0x2eb897(0x28c)][_0x2eb897(0x2c2)]==![]&&devices[_0x8bd412][_0x2eb897(0x28c)][_0x2eb897(0x2ef)]==_0x2eb897(0x1f0))_0xb49b35[_0x2eb897(0x37e)](_0x2eb897(0x311),{'access':devices[_0x8bd412]['access']});else devices[_0x8bd412][_0x2eb897(0x28c)][_0x2eb897(0x2c2)]&&devices[_0x8bd412][_0x2eb897(0x28c)]['reason']==_0x2eb897(0x331)&&(getClientsWithUuid(_0x8bd412)[_0x2eb897(0x38c)](_0x15716c=>{setAccess(_0x15716c);}),logger[_0x2eb897(0x1e5)](_0x2eb897(0x228)+_0x8bd412[_0x2eb897(0x381)](-0x8)),setTokenRefresh(_0x8bd412),setSessionTimeout('login',_0x8bd412));}}else logger[_0x2eb897(0x1d0)](_0x2eb897(0x23a));}),_0xb49b35['on'](_0x1c2d71(0x22e),()=>{resetPassword();}),_0xb49b35['on'](_0x1c2d71(0x293),_0x5c1867=>{removeClient(_0xb49b35['id']);}),_0x17d263==_0x1c2d71(0x37a)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x59c269){const _0x4fb100=_0x3b9479;if(_0x59c269!=_0x4fb100(0x37a)&&config[_0x4fb100(0x22d)]!=''){if(pid[_0x59c269])pid[_0x59c269]['send']({'function':_0x4fb100(0x24d),'args':null});}_0x59c269!='botmanager'&&broadcastToBots(_0x4fb100(0x369),JSON[_0x4fb100(0x32e)](config));}function reloadBotManager(){const _0x23b42f=_0x3b9479;getClientsWithBotID(_0x23b42f(0x37a))[_0x23b42f(0x38c)](_0x203cac=>{const _0x4b739b=_0x23b42f;getSocket(_0x203cac['id'])[_0x4b739b(0x37e)](_0x4b739b(0x311),{'access':{'allow':![],'reason':_0x4b739b(0x352),'token':null}});});}function getSocket(_0x3b61e0){const _0x722a10=_0x3b9479;return io[_0x722a10(0x37f)][_0x722a10(0x37f)][_0x722a10(0x342)](_0x3b61e0);}function setAccess(_0x523f9d){const _0x331c9f=_0x3b9479,_0x5b88b2=getSocket(_0x523f9d['id']),_0xd3218e=_0x523f9d['uuid'],_0x20dd34=_0x523f9d[_0x331c9f(0x266)];devices[_0xd3218e][_0x331c9f(0x28c)]=validateAccess(devices[_0xd3218e]['access']['token'],_0xd3218e),logger[_0x331c9f(0x1e5)](_0x331c9f(0x372)+devices[_0xd3218e][_0x331c9f(0x28c)]['reason']+_0x331c9f(0x2a3)+_0x523f9d['id'][_0x331c9f(0x381)](-0x8)+'\x20|\x20user:\x20...'+_0xd3218e[_0x331c9f(0x381)](-0x8)),_0x5b88b2[_0x331c9f(0x236)](_0xd3218e);if(devices[_0xd3218e][_0x331c9f(0x28c)][_0x331c9f(0x2c2)]){_0x5b88b2[_0x331c9f(0x236)](_0x20dd34);if(_0x20dd34=='botmanager')initializeSocketBotManager(_0x5b88b2);else initializeSocketBot(_0x5b88b2);initClient(_0x20dd34);}devices[_0xd3218e][_0x331c9f(0x28c)][_0x331c9f(0x270)]&&devices[_0xd3218e]['access']['reason']=='temporary\x20token\x20generated'&&setSessionTimeout(_0x331c9f(0x31b),_0xd3218e),devices[_0xd3218e][_0x331c9f(0x28c)]['token']&&devices[_0xd3218e][_0x331c9f(0x28c)][_0x331c9f(0x2ef)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x331c9f(0x24a),_0xd3218e),_0x5b88b2[_0x331c9f(0x37e)](_0x331c9f(0x311),{'status':_0x523f9d[_0x331c9f(0x2b8)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0xd3218e][_0x331c9f(0x28c)],'externalip':devices[_0xd3218e]['ip'],'publicKey':secure[_0x331c9f(0x3af)],'userid':settings[_0x331c9f(0x310)],'validInstallation':validInstallation}),devices[_0xd3218e][_0x331c9f(0x28c)]['allow']==![]&&devices[_0xd3218e]['access'][_0x331c9f(0x2ef)]==_0x331c9f(0x35b)&&temporaryAccess2FA(_0xd3218e,devices[_0xd3218e]['ip']);}function setSessionTimeout(_0x1ba613,_0x1d7585){const _0xe6b647=_0x3b9479;let _0x536e21;if(_0x1ba613=='login')_0x536e21=loginExpiry*0x3c*0x3e8;else _0x536e21=devices[_0x1d7585]['telegramIpApproval'][_0xe6b647(0x34f)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x1d7585]['telegramIpApproval'][_0xe6b647(0x2bb)]);if(devices[_0x1d7585][_0xe6b647(0x2eb)])clearTimeout(devices[_0x1d7585][_0xe6b647(0x2eb)]);devices[_0x1d7585][_0xe6b647(0x2eb)]=setTimeout(()=>{const _0x223158=_0xe6b647;if(devices[_0x1d7585]['pidRefreshToken'])clearTimeout(devices[_0x1d7585][_0x223158(0x33a)]);removeSocketListeners(_0x1d7585),addBlacklist(_0x1d7585),devices[_0x1d7585]['telegramIpApproval']=null,devices[_0x1d7585]['telegram2FaApproval']=null,devices[_0x1d7585][_0x223158(0x28c)][_0x223158(0x270)]=null,logger[_0x223158(0x1e5)](_0x223158(0x20d)+_0x1d7585[_0x223158(0x381)](-0x8)),devices[_0x1d7585][_0x223158(0x28c)]=validateAccess(devices[_0x1d7585][_0x223158(0x28c)]['token'],_0x1d7585),!(devices[_0x1d7585][_0x223158(0x28c)][_0x223158(0x2c2)]&&devices[_0x1d7585][_0x223158(0x28c)][_0x223158(0x2ef)]==_0x223158(0x1d9))&&(_0x1ba613==_0x223158(0x24a)?io['to'](_0x1d7585)['emit'](_0x223158(0x311),{'access':{'allow':![],'reason':_0x223158(0x24c),'token':null}}):io['to'](_0x1d7585)[_0x223158(0x37e)](_0x223158(0x311),{'access':{'allow':![],'reason':_0x223158(0x2fa),'token':null}})),devices[_0x1d7585][_0x223158(0x28c)][_0x223158(0x270)]=null;},_0x536e21);}function setTokenRefresh(_0x592e79){const _0x2e4b73=_0x3b9479;if(devices[_0x592e79][_0x2e4b73(0x33a)])clearTimeout(devices[_0x592e79]['pidRefreshToken']);devices[_0x592e79][_0x2e4b73(0x33a)]=setTimeout(()=>{const _0x114519=_0x2e4b73;getClientsWithUuid(_0x592e79)[_0x114519(0x357)]!=0x0?(devices[_0x592e79][_0x114519(0x28c)]=refreshToken(_0x592e79),io['to'](_0x592e79)[_0x114519(0x37e)]('status',{'status':_0x114519(0x212),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x592e79]['access'],'externalip':devices[_0x592e79]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x592e79)):clearTimeout(devices[_0x592e79][_0x114519(0x33a)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x316285){const _0x27445a=_0x3b9479,_0x4354b1=getClient(_0x316285['id'])[_0x27445a(0x2bd)];_0x316285[_0x27445a(0x37e)](_0x27445a(0x369),config),_0x316285[_0x27445a(0x37e)](_0x27445a(0x225),cleanSettings()),_0x316285['on']('add-bot',_0x1ae6e7=>{const _0x1594b8=_0x27445a;if(validateAccess(_0x1ae6e7,_0x4354b1)[_0x1594b8(0x2c2)])addBot();else logger[_0x1594b8(0x1d0)](_0x1594b8(0x343));}),_0x316285['on'](_0x27445a(0x2bf),(_0x381e70,_0x3270d1)=>{const _0x270798=_0x27445a;if(validateAccess(_0x3270d1,_0x4354b1)[_0x270798(0x2c2)])toggleBot(_0x381e70[_0x270798(0x3a1)],_0x381e70['status'],_0x381e70[_0x270798(0x2ed)]);else logger[_0x270798(0x1d0)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x316285['on'](_0x27445a(0x397),(_0x4c271f,_0x52d334)=>{const _0x3ce678=_0x27445a;if(validateAccess(_0x52d334,_0x4354b1)[_0x3ce678(0x2c2)])toggleBotMode(_0x4c271f);else logger[_0x3ce678(0x1d0)](_0x3ce678(0x1ee));}),_0x316285['on']('delete-bot',(_0x3930fd,_0x50925a)=>{const _0xbac3d0=_0x27445a;if(validateAccess(_0x50925a,_0x4354b1)[_0xbac3d0(0x2c2)])deleteBot(_0x3930fd);else logger[_0xbac3d0(0x1d0)](_0xbac3d0(0x36c));}),_0x316285['on'](_0x27445a(0x320),(_0x42e5f8,_0x2804b8)=>{const _0x5e19b2=_0x27445a;if(validateAccess(_0x2804b8,_0x4354b1)[_0x5e19b2(0x2c2)])storeSettings(_0x42e5f8,!![]);else logger[_0x5e19b2(0x1d0)](_0x5e19b2(0x31a));}),_0x316285['on']('update-bb',_0x195d62=>{const _0x553e5c=_0x27445a;if(validateAccess(_0x195d62,_0x4354b1)['allow'])updateBB(_0x553e5c(0x20c));else logger[_0x553e5c(0x1d0)](_0x553e5c(0x391));}),_0x316285['on']('reinstall-bb',_0x24f6d7=>{const _0x2ad0e2=_0x27445a;if(validateAccess(_0x24f6d7,_0x4354b1)['allow'])updateBB('reinstall');else logger[_0x2ad0e2(0x1d0)](_0x2ad0e2(0x2c8));}),_0x316285['on'](_0x27445a(0x227),_0x44ad5b=>{const _0x4ca176=_0x27445a;if(validateAccess(_0x44ad5b,_0x4354b1)[_0x4ca176(0x2c2)]){const _0x66fbb0=getClient(_0x316285['id']);if(_0x66fbb0)getBackupFiles(_0x66fbb0[_0x4ca176(0x2bd)]);else logger[_0x4ca176(0x1d0)](_0x4ca176(0x28f));}else logger[_0x4ca176(0x1d0)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x316285['on'](_0x27445a(0x295),(_0x1ca323,_0x25f5ae)=>{const _0x42685d=_0x27445a;if(validateAccess(_0x25f5ae,_0x4354b1)[_0x42685d(0x2c2)])restoreBackupFile(_0x1ca323);else logger[_0x42685d(0x1d0)](_0x42685d(0x368));}),_0x316285['on'](_0x27445a(0x2a5),_0x49350c=>{const _0x3b4ec6=_0x27445a;if(validateAccess(_0x49350c,_0x4354b1)[_0x3b4ec6(0x2c2)])getMessages();else logger[_0x3b4ec6(0x1d0)](_0x3b4ec6(0x22c));}),_0x316285['on'](_0x27445a(0x299),(_0x1fbef0,_0x10f3c5)=>{const _0x544e0d=_0x27445a;if(validateAccess(_0x10f3c5,_0x4354b1)[_0x544e0d(0x2c2)])confirmMessage(_0x1fbef0);else logger[_0x544e0d(0x1d0)](_0x544e0d(0x3a7));}),_0x316285['on'](_0x27445a(0x2bc),_0x5b00d8=>{const _0x2cf5c2=_0x27445a;if(validateAccess(_0x5b00d8,_0x4354b1)['allow']){if(devices[_0x4354b1][_0x2cf5c2(0x33a)])clearTimeout(devices[_0x4354b1]['pidRefreshToken']);if(devices[_0x4354b1][_0x2cf5c2(0x2eb)])clearTimeout(devices[_0x4354b1]['pidExpireLogin']);removeSocketListeners(getClient(_0x316285['id'])[_0x2cf5c2(0x2bd)]),addBlacklist(_0x4354b1),devices[_0x4354b1]['telegramIpApproval']=null,devices[_0x4354b1][_0x2cf5c2(0x250)]=null,devices[_0x4354b1]['access']['token']=null,logger['debug'](_0x2cf5c2(0x350)+_0x4354b1[_0x2cf5c2(0x381)](-0x8)),io['to'](getClient(_0x316285['id'])[_0x2cf5c2(0x2bd)])['emit'](_0x2cf5c2(0x311),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x2cf5c2(0x1d0)](_0x2cf5c2(0x1e1));});}function initializeSocketBot(_0x1ceeb8){const _0x3d159f=_0x3b9479,_0x16ac7a=getClient(_0x1ceeb8['id'])[_0x3d159f(0x266)],_0x32064f=getClient(_0x1ceeb8['id'])[_0x3d159f(0x2bd)];_0x1ceeb8['on'](_0x3d159f(0x27e),(_0x49d0d0,_0x38ed28)=>{const _0x536a01=_0x3d159f;if(validateAccess(_0x38ed28,_0x32064f)[_0x536a01(0x2c2)]){if(pid[_0x16ac7a])pid[_0x16ac7a][_0x536a01(0x205)]({'function':_0x536a01(0x2b3),'args':_0x49d0d0});}else logger[_0x536a01(0x1d0)](_0x536a01(0x380));}),_0x1ceeb8['on'](_0x3d159f(0x32b),(_0x9b0847,_0x56c312)=>{const _0x5e02a1=_0x3d159f;if(validateAccess(_0x56c312,_0x32064f)[_0x5e02a1(0x2c2)]){if(pid[_0x16ac7a])pid[_0x16ac7a][_0x5e02a1(0x205)]({'function':_0x5e02a1(0x302),'args':_0x9b0847});}else logger[_0x5e02a1(0x1d0)](_0x5e02a1(0x1fe));}),_0x1ceeb8['on']('get-portfolio',(_0x9c3ae4,_0x360930)=>{const _0x531f2e=_0x3d159f;if(validateAccess(_0x360930,_0x32064f)[_0x531f2e(0x2c2)]){if(pid[_0x16ac7a])pid[_0x16ac7a]['send']({'function':_0x531f2e(0x2ea),'args':_0x9c3ae4});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x1ceeb8['on'](_0x3d159f(0x25a),(_0x36fc50,_0x249c2e)=>{const _0x4a3a41=_0x3d159f;if(validateAccess(_0x249c2e,_0x32064f)['allow']){if(pid[_0x16ac7a])pid[_0x16ac7a]['send']({'function':_0x4a3a41(0x38d),'args':_0x36fc50});}else logger[_0x4a3a41(0x1d0)](_0x4a3a41(0x333));}),_0x1ceeb8['on'](_0x3d159f(0x2d7),(_0x2cfe29,_0x4dc97e)=>{const _0x49d8ce=_0x3d159f;if(validateAccess(_0x4dc97e,_0x32064f)[_0x49d8ce(0x2c2)]){if(pid[_0x16ac7a])pid[_0x16ac7a][_0x49d8ce(0x205)]({'function':_0x49d8ce(0x332),'args':_0x2cfe29});}else logger[_0x49d8ce(0x1d0)](_0x49d8ce(0x22a));}),_0x1ceeb8['on']('store-fiat',(_0x44218f,_0x2ed1a0)=>{const _0x3239c3=_0x3d159f;if(validateAccess(_0x2ed1a0,_0x32064f)[_0x3239c3(0x2c2)]){if(pid[_0x16ac7a])pid[_0x16ac7a]['send']({'function':_0x3239c3(0x267),'args':_0x44218f});}else logger[_0x3239c3(0x1d0)](_0x3239c3(0x210));}),_0x1ceeb8['on']('reset-history',_0x5790ed=>{const _0x2937f8=_0x3d159f;if(validateAccess(_0x5790ed,_0x32064f)[_0x2937f8(0x2c2)]){if(pid[_0x16ac7a])pid[_0x16ac7a][_0x2937f8(0x205)]({'function':'resetHistory','args':null});}else logger[_0x2937f8(0x1d0)](_0x2937f8(0x204));}),_0x1ceeb8['on']('get-starting-balances',_0x482d49=>{const _0x629953=_0x3d159f;if(validateAccess(_0x482d49,_0x32064f)[_0x629953(0x2c2)]){if(pid[_0x16ac7a])pid[_0x16ac7a][_0x629953(0x205)]({'function':'getStartingBalances','args':null});}else logger[_0x629953(0x1d0)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x1ceeb8['on'](_0x3d159f(0x25e),(_0x29a5a0,_0x5eeeb9)=>{const _0x3e33ee=_0x3d159f;if(validateAccess(_0x5eeeb9,_0x32064f)[_0x3e33ee(0x2c2)]){if(pid[_0x16ac7a])pid[_0x16ac7a][_0x3e33ee(0x205)]({'function':_0x3e33ee(0x395),'args':_0x29a5a0});}else logger[_0x3e33ee(0x1d0)](_0x3e33ee(0x34a));}),_0x1ceeb8['on'](_0x3d159f(0x200),_0x409e60=>{const _0x3a2786=_0x3d159f;if(validateAccess(_0x409e60,_0x32064f)['allow']){if(pid[_0x16ac7a])pid[_0x16ac7a][_0x3a2786(0x205)]({'function':_0x3a2786(0x2a7),'args':null});}else logger['full'](_0x3a2786(0x2dd));}),_0x1ceeb8['on']('show-config',_0x52f148=>{const _0x5ae6a2=_0x3d159f;if(validateAccess(_0x52f148,_0x32064f)[_0x5ae6a2(0x2c2)]){if(pid[_0x16ac7a])pid[_0x16ac7a][_0x5ae6a2(0x205)]({'function':_0x5ae6a2(0x265),'args':null});}else logger[_0x5ae6a2(0x1d0)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x1ceeb8['on'](_0x3d159f(0x321),_0x467c26=>{const _0x238f1a=_0x3d159f;if(validateAccess(_0x467c26,_0x32064f)[_0x238f1a(0x2c2)])updateBB(_0x238f1a(0x20c));else logger[_0x238f1a(0x1d0)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x1ceeb8['on'](_0x3d159f(0x2a5),_0x2696cb=>{const _0xd42729=_0x3d159f;if(validateAccess(_0x2696cb,_0x32064f)[_0xd42729(0x2c2)])getMessages();else logger[_0xd42729(0x1d0)](_0xd42729(0x22c));}),_0x1ceeb8['on'](_0x3d159f(0x299),(_0x3214b4,_0x87aeb0)=>{const _0x5aeca2=_0x3d159f;if(validateAccess(_0x87aeb0,_0x32064f)[_0x5aeca2(0x2c2)])confirmMessage(_0x3214b4);else logger[_0x5aeca2(0x1d0)](_0x5aeca2(0x3a7));}),_0x1ceeb8['on'](_0x3d159f(0x2bc),_0x449683=>{const _0x4d9d52=_0x3d159f;if(validateAccess(_0x449683,_0x32064f)[_0x4d9d52(0x2c2)]){if(devices[_0x32064f][_0x4d9d52(0x33a)])clearTimeout(devices[_0x32064f][_0x4d9d52(0x33a)]);if(devices[_0x32064f]['pidExpireLogin'])clearTimeout(devices[_0x32064f][_0x4d9d52(0x2eb)]);removeSocketListeners(getClient(_0x1ceeb8['id'])[_0x4d9d52(0x2bd)]),addBlacklist(_0x32064f),devices[_0x32064f][_0x4d9d52(0x230)]=null,devices[_0x32064f][_0x4d9d52(0x250)]=null,devices[_0x32064f]['access'][_0x4d9d52(0x270)]=null,logger[_0x4d9d52(0x1e5)](_0x4d9d52(0x350)+_0x32064f[_0x4d9d52(0x381)](-0x8)),io['to'](getClient(_0x1ceeb8['id'])['uuid'])['emit']('status',{'access':{'allow':![],'reason':_0x4d9d52(0x202),'token':null}});}else logger[_0x4d9d52(0x1d0)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x1ccba3){getClientsWithUuid(_0x1ccba3)['forEach'](_0x1f2581=>{const _0x2924a1=_0x4b9e;getSocket(_0x1f2581['id'])[_0x2924a1(0x273)]();});}function cleanSettings(){const _0xdec846=_0x3b9479;let _0x137815=settings;return settings[_0xdec846(0x29d)]&&settings[_0xdec846(0x29d)]!=''&&(_0x137815={..._0x137815,'telegramToken':'************'}),settings[_0xdec846(0x1fb)]&&settings[_0xdec846(0x1fb)]!=''&&(_0x137815={..._0x137815,'bbPassword':'************'}),(settings['bbPassword']&&settings[_0xdec846(0x1fb)]==_0xdec846(0x33d)||settings[_0xdec846(0x29d)]&&settings[_0xdec846(0x29d)]==_0xdec846(0x33d))&&(_0x137815={..._0x137815,'restored':{'password':settings[_0xdec846(0x1fb)]==_0xdec846(0x33d),'telegram':settings['telegramToken']==_0xdec846(0x33d)}}),_0x137815;}async function updateBB(_0x455766){const _0x868357=_0x3b9479;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x268340=>{const _0x58f230=_0x4b9e;restartBot(_0x268340[_0x58f230(0x3a1)]);}),logger[_0x868357(0x1e5)](_0x868357(0x389)+_0x455766);if(_0x455766=='update')process[_0x868357(0x205)]({'update':!![]},_0x2d3e35=>{});else _0x455766=='reinstall'&&process[_0x868357(0x205)]({'reinstall':!![]},_0x3830f0=>{});}function startBot(_0x29c5a3,_0x4fd197,_0x802d3){const _0x1a2a2d=_0x3b9479;if(debugging)_0x29c5a3['push']('-d');let _0x253a78=![];const _0xfb2f6a=_0x29c5a3[0x0];_0x4fd197={..._0x4fd197,'stdio':['inherit',_0x1a2a2d(0x30e),_0x1a2a2d(0x30e),_0x1a2a2d(0x262)]},pid[_0xfb2f6a]=childProcess[_0x1a2a2d(0x375)](botfile,_0x29c5a3,_0x4fd197),pid[_0xfb2f6a]['on']('message',_0x2f4345=>{const _0x1f6e85=_0x1a2a2d;switch(Object['keys'](_0x2f4345)[0x0]){case _0x1f6e85(0x28b):updateBotName(_0xfb2f6a,_0x2f4345['botname']);break;case _0x1f6e85(0x392):updateBotManager();break;case _0x1f6e85(0x311):updateStatus(_0xfb2f6a,_0x2f4345[_0x1f6e85(0x311)]);break;case _0x1f6e85(0x2ed):updateLive(_0xfb2f6a,_0x2f4345['live']);break;case _0x1f6e85(0x382):updateLive(_0xfb2f6a,_0x2f4345['started']),io['to'](_0xfb2f6a)['emit'](_0x1f6e85(0x311),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x1f6e85(0x257):_0x2f4345[_0x1f6e85(0x257)]==_0x1f6e85(0x237)&&restartBot(_0xfb2f6a);_0x2f4345[_0x1f6e85(0x257)]=='kill'&&toggleBot(_0xfb2f6a,_0x1f6e85(0x21b),'stopped');break;case _0x1f6e85(0x2b5):sendTelegram(_0xfb2f6a,_0x2f4345[_0x1f6e85(0x2b5)]);break;case _0x1f6e85(0x31e):sendTelegramMsg(_0x2f4345[_0x1f6e85(0x31e)]);break;case _0x1f6e85(0x3a0):io['to'](_0xfb2f6a)[_0x1f6e85(0x37e)](_0x2f4345[_0x1f6e85(0x3a0)],_0x2f4345['args']);break;}}),pid[_0xfb2f6a]['on']('error',function(_0x4767ec){if(_0x253a78)return;_0x253a78=!![],_0x802d3(_0x4767ec);}),pid[_0xfb2f6a]['on']('exit',async function(_0x260f22){const _0x55c28a=_0x1a2a2d;if(installingUpdate)return;if(_0x253a78)return;_0x253a78=!![],_0x802d3(null);const _0x3006a2=dbConfig[_0x55c28a(0x342)](_0x55c28a(0x369))[_0x55c28a(0x207)]({'botID':_0xfb2f6a})[_0x55c28a(0x3a8)]();_0x3006a2&&(_0x3006a2[_0x55c28a(0x311)]==_0x55c28a(0x254)||_0x3006a2[_0x55c28a(0x311)]==_0x55c28a(0x224))&&(await sleep(0x3e8),updateLive(_0xfb2f6a,'stopped'),logger[_0x55c28a(0x1d0)](_0x55c28a(0x1d2)+_0xfb2f6a),startBot([_0xfb2f6a,userID],{'cwd':bbpath},function(_0x384d25){if(_0x384d25)logger['full'](_0x384d25);}));});}function stopBot(_0x802f16){const _0x3d0339=_0x3b9479;getClientsWithBotID(_0x802f16)[_0x3d0339(0x38c)](_0x175f9d=>{const _0x42437b=_0x3d0339;getSocket(_0x175f9d['id'])[_0x42437b(0x293)](!![]),removeClient(_0x175f9d['id']);}),pid[_0x802f16]&&(pid[_0x802f16][_0x3d0339(0x358)](),pid[_0x802f16]=null);}function restartBot(_0x59170c){if(pid[_0x59170c])pid[_0x59170c]['kill']();}function addBot(){const _0x44798f=_0x3b9479;let _0xd2f10;for(let _0x3f4d93=0x1;_0x3f4d93<0x3e9;_0x3f4d93++){_0xd2f10=_0x3f4d93['toString']()[_0x44798f(0x1e7)](0x3,'0');let _0xb3e91f=config[_0x44798f(0x207)](_0x16f396=>_0x16f396['botID']==_0xd2f10);if(!_0xb3e91f)break;}if(_0xd2f10===_0x44798f(0x39c)){logger[_0x44798f(0x1d0)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x44798f(0x1d0)](_0x44798f(0x354)+_0xd2f10),dbConfig[_0x44798f(0x342)](_0x44798f(0x369))['push']({'botID':_0xd2f10,'botname':'Bot\x20'+_0xd2f10,'status':_0x44798f(0x224),'live':''})[_0x44798f(0x2e1)](),startBot([_0xd2f10,userID],{'cwd':bbpath},function(_0x2af37b){if(_0x2af37b)logger['full'](_0x2af37b);}),config=getConfiguration(),io['to'](_0x44798f(0x37a))[_0x44798f(0x37e)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function deleteBot(_0x2bff0e){const _0xeb676c=_0x3b9479;getClientsWithBotID(_0x2bff0e)[_0xeb676c(0x38c)](_0x46f5b2=>{getSocket(_0x46f5b2['id'])['disconnect'](!![]),removeClient(_0x46f5b2['id']);}),dbConfig[_0xeb676c(0x342)](_0xeb676c(0x369))[_0xeb676c(0x2f0)]({'botID':_0x2bff0e})['write'](),logger[_0xeb676c(0x1d0)](_0xeb676c(0x2e6)+_0x2bff0e),stopBot(_0x2bff0e);try{if(fs[_0xeb676c(0x1e4)](path['join'](configpath,_0xeb676c(0x34c)+_0x2bff0e+_0xeb676c(0x36f))))fs['unlinkSync'](path['join'](configpath,_0xeb676c(0x34c)+_0x2bff0e+_0xeb676c(0x36f)));if(fs[_0xeb676c(0x1e4)](path[_0xeb676c(0x236)](configpath,'bot-'+_0x2bff0e+_0xeb676c(0x309))))fs['unlinkSync'](path[_0xeb676c(0x236)](configpath,_0xeb676c(0x34c)+_0x2bff0e+_0xeb676c(0x309)));if(fs['existsSync'](path[_0xeb676c(0x236)](configpath,_0xeb676c(0x34c)+_0x2bff0e+_0xeb676c(0x2a6))))fs[_0xeb676c(0x23d)](path[_0xeb676c(0x236)](configpath,_0xeb676c(0x34c)+_0x2bff0e+_0xeb676c(0x2a6)));if(fs[_0xeb676c(0x1e4)](path[_0xeb676c(0x236)](configpath,'bot-'+_0x2bff0e+'-results.json')))fs[_0xeb676c(0x23d)](path['join'](configpath,'bot-'+_0x2bff0e+'-results.json'));}catch(_0x7f1aa4){if(_0x7f1aa4)logger[_0xeb676c(0x1d0)](_0xeb676c(0x365),_0x7f1aa4);}config=getConfiguration(),io['to'](_0xeb676c(0x37a))['emit'](_0xeb676c(0x369),config),broadcastToBots(_0xeb676c(0x369),JSON['stringify'](config));}function toggleBot(_0x543997,_0x1bf729,_0x31ad65){const _0x5bf9f4=_0x3b9479;dbConfig[_0x5bf9f4(0x342)](_0x5bf9f4(0x369))[_0x5bf9f4(0x207)]({'botID':_0x543997})['assign']({'status':_0x1bf729})[_0x5bf9f4(0x231)]({'live':_0x31ad65})['write']();if(_0x1bf729==_0x5bf9f4(0x254)||_0x1bf729=='new')logger[_0x5bf9f4(0x1d0)](_0x5bf9f4(0x308)+_0x543997),startBot([_0x543997,userID],{'cwd':bbpath},function(_0x447761){const _0x56b62c=_0x5bf9f4;if(_0x447761)logger[_0x56b62c(0x1d0)](_0x447761);});else(_0x1bf729==_0x5bf9f4(0x21b)||_0x1bf729==_0x5bf9f4(0x2c9))&&(logger['full']('Disabled\x20Bot\x20'+_0x543997),stopBot(_0x543997));config=getConfiguration(),io['to'](_0x5bf9f4(0x37a))[_0x5bf9f4(0x37e)]('bots',config),broadcastToBots(_0x5bf9f4(0x369),JSON[_0x5bf9f4(0x32e)](config));}function toggleStatus(_0x49ed6d){const _0x12f818=_0x3b9479;let _0x361c18=dbConfig[_0x12f818(0x342)](_0x12f818(0x369))[_0x12f818(0x207)]({'botID':_0x49ed6d})[_0x12f818(0x3a8)](),_0x3a4374;if(_0x361c18[_0x12f818(0x311)]===_0x12f818(0x254))_0x3a4374=_0x12f818(0x21b);else{if(_0x361c18['status']===_0x12f818(0x224))_0x3a4374='new-disabled';else{if(_0x361c18['status']==='new-disabled')_0x3a4374=_0x12f818(0x224);else{if(_0x361c18[_0x12f818(0x311)]==='disabled')_0x3a4374='enabled';}}}return _0x3a4374;}function updateStatus(_0x51d2a9,_0x114741){const _0x54156a=_0x3b9479;dbConfig[_0x54156a(0x342)](_0x54156a(0x369))[_0x54156a(0x207)]({'botID':_0x51d2a9})[_0x54156a(0x231)]({'status':_0x114741})[_0x54156a(0x2e1)](),config=getConfiguration(),io['to'](_0x54156a(0x37a))[_0x54156a(0x37e)](_0x54156a(0x369),config),broadcastToBots(_0x54156a(0x369),JSON[_0x54156a(0x32e)](config));}function updateLive(_0x399f45,_0x2ecdc3){const _0x57234d=_0x3b9479;dbConfig[_0x57234d(0x342)]('bots')[_0x57234d(0x207)]({'botID':_0x399f45})['assign']({'live':_0x2ecdc3})[_0x57234d(0x2e1)](),config=getConfiguration(),io['to'](_0x57234d(0x37a))[_0x57234d(0x37e)](_0x57234d(0x369),config),broadcastToBots(_0x57234d(0x369),JSON['stringify'](config));}function updateBotName(_0x44752d,_0xdd56f3){const _0x54853e=_0x3b9479;dbConfig[_0x54853e(0x342)](_0x54853e(0x369))['find']({'botID':_0x44752d})[_0x54853e(0x231)]({'botname':_0xdd56f3})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x54853e(0x37e)](_0x54853e(0x369),config),broadcastToBots(_0x54853e(0x369),JSON[_0x54853e(0x32e)](config));}function updateBotManager(){const _0x569607=_0x3b9479;config=getConfiguration(),io['to'](_0x569607(0x37a))[_0x569607(0x37e)](_0x569607(0x369),config),broadcastToBots('bots',JSON[_0x569607(0x32e)](config));}function toggleBotMode(_0x5c510c){const _0x12aa1b=_0x3b9479;if(pid[_0x5c510c])pid[_0x5c510c][_0x12aa1b(0x205)]({'function':_0x12aa1b(0x329),'args':null});else{const _0xdf403=configpath+_0x12aa1b(0x34c)+_0x5c510c+_0x12aa1b(0x36f),_0xa56a38=fs[_0x12aa1b(0x29e)](_0xdf403),_0xc191b8=JSON[_0x12aa1b(0x388)](_0xa56a38),_0xcefba8=_0xc191b8[_0x12aa1b(0x266)][0x0][_0x12aa1b(0x2a2)];_0xc191b8[_0x12aa1b(0x266)][0x0]['headless']=!_0xcefba8;const _0x59b4eb=JSON['stringify'](_0xc191b8,null,0x2);fs[_0x12aa1b(0x2e0)](_0xdf403,_0x59b4eb),config=getConfiguration(),io['to'](_0x12aa1b(0x37a))[_0x12aa1b(0x37e)](_0x12aa1b(0x369),config),broadcastToBots(_0x12aa1b(0x369),JSON[_0x12aa1b(0x32e)](config));}}function telegramError(_0x3d5ab1){const _0x2fb8d9=_0x3b9479;logger[_0x2fb8d9(0x301)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0xe0535f){const _0x205d05=_0x3b9479;if(_0xe0535f[_0x205d05(0x366)]['username']!=settings[_0x205d05(0x355)]&&'@'+_0xe0535f[_0x205d05(0x366)][_0x205d05(0x2ee)]!=settings[_0x205d05(0x355)])return tgBot['sendMessage'](_0xe0535f['chat']['id'],_0x205d05(0x272),{'parse_mode':_0x205d05(0x290)})[_0x205d05(0x32a)](_0x40baa8=>{telegramError(_0x40baa8);}),![];return!![];}async function initTelegram(){const _0x389d65=_0x3b9479;if(tgBot)tgBot[_0x389d65(0x1e3)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x389d65(0x29d)],{'polling':!![]});let _0x176894=_0x389d65(0x251);_0x176894+='\x0a',_0x176894+=_0x389d65(0x2df),_0x176894+=_0x389d65(0x277),_0x176894+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x176894+=_0x389d65(0x201),_0x176894+=_0x389d65(0x36a),_0x176894+=_0x389d65(0x26f),_0x176894+=_0x389d65(0x2d3),_0x176894+=_0x389d65(0x285),_0x176894+=_0x389d65(0x30d),_0x176894+=_0x389d65(0x306),_0x176894+=_0x389d65(0x1e8),_0x176894+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x176894+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x176894+=_0x389d65(0x2e2);let _0x1d3b44='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x1d3b44+='\x0a',_0x1d3b44+=_0x176894,tgBot[_0x389d65(0x2e9)](/\/start/,_0x528bd3=>{const _0xf14ccd=_0x389d65;if(!validateTelegram(_0x528bd3))return;if(settings[_0xf14ccd(0x1ef)]!=_0x528bd3[_0xf14ccd(0x340)]['id'])updateSetting('telegramChatId',_0x528bd3['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot[_0xf14ccd(0x376)](_0x528bd3[_0xf14ccd(0x340)]['id'],_0x1d3b44)[_0xf14ccd(0x32a)](_0x47aee9=>{telegramError(_0x47aee9);});}),tgBot[_0x389d65(0x2e9)](/\/enable/,_0x18e70c=>{const _0xab3143=_0x389d65;if(!validateTelegram(_0x18e70c))return;if(settings[_0xab3143(0x1ef)]!=_0x18e70c[_0xab3143(0x340)]['id'])updateSetting(_0xab3143(0x1ef),_0x18e70c['chat']['id']);updateSetting(_0xab3143(0x393),!![]),tgBot['sendMessage'](_0x18e70c[_0xab3143(0x340)]['id'],_0xab3143(0x2f6))[_0xab3143(0x32a)](_0x3cb61d=>{telegramError(_0x3cb61d);});}),tgBot['onText'](/\/config/,async _0x5a9dc4=>{const _0x582a21=_0x389d65;if(!validateTelegram(_0x5a9dc4))return;tgBot[_0x582a21(0x34b)]('callback_query'),tgBot[_0x582a21(0x376)](_0x5a9dc4[_0x582a21(0x340)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':'orders'},{'text':_0x582a21(0x1d4),'callback_data':_0x582a21(0x1d3)},{'text':_0x582a21(0x327),'callback_data':_0x582a21(0x24f)}]]}})[_0x582a21(0x32a)](_0x2639f9=>{telegramError(_0x2639f9);}),tgBot['on']('callback_query',async _0x30ed9c=>{const _0x4c65c9=_0x582a21,_0x4042d7=_0x30ed9c['data'],_0x171c80=_0x30ed9c['message'];tgBot['answerCallbackQuery'](_0x30ed9c['id'])['then'](async()=>{const _0x189036=_0x4b9e;_0x4042d7==_0x189036(0x305)&&(updateSetting(_0x189036(0x232),_0x189036(0x305)),updateSetting(_0x189036(0x393),!![]),await tgBot['sendMessage'](_0x171c80['chat']['id'],_0x189036(0x2ff))[_0x189036(0x32a)](_0x35d33a=>{telegramError(_0x35d33a);}));_0x4042d7==_0x189036(0x1d3)&&(updateSetting(_0x189036(0x232),_0x189036(0x1d3)),updateSetting(_0x189036(0x393),!![]),await tgBot['sendMessage'](_0x171c80['chat']['id'],_0x189036(0x2d6))[_0x189036(0x32a)](_0x360e1b=>{telegramError(_0x360e1b);}));_0x4042d7=='all'&&(updateSetting('telegramEvents',_0x189036(0x24f)),updateSetting(_0x189036(0x393),!![]),await tgBot[_0x189036(0x376)](_0x171c80[_0x189036(0x340)]['id'],_0x189036(0x378))[_0x189036(0x32a)](_0x233535=>{telegramError(_0x233535);}));if(!settings['telegramChatId'])tgBot[_0x189036(0x376)](_0x171c80[_0x189036(0x340)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x189036(0x32a)](_0xb0cf3e=>{telegramError(_0xb0cf3e);});}),tgBot[_0x4c65c9(0x34b)](_0x4c65c9(0x1ff));});}),tgBot[_0x389d65(0x2e9)](/\/status/,_0x2fa80b=>{const _0xe52dd=_0x389d65;if(!validateTelegram(_0x2fa80b))return;const _0x42a2bb=getBotsWithMode();let _0x37bb56=_0xe52dd(0x2e7);config['forEach'](_0x5343ac=>{const _0x5aa0bb=_0xe52dd,_0x5400d6=_0x42a2bb[_0x5aa0bb(0x207)](_0x1a7bb9=>_0x1a7bb9['botID']==_0x5343ac[_0x5aa0bb(0x3a1)])[_0x5aa0bb(0x1df)];_0x37bb56+=_0x5aa0bb(0x384)+_0x5343ac[_0x5aa0bb(0x3a1)]+':\x20'+_0x5343ac['status']+'\x20|\x20'+_0x5400d6+_0x5aa0bb(0x2a0)+_0x5343ac[_0x5aa0bb(0x2ed)]+'\x0a';}),_0x37bb56+='\x0a',_0x37bb56+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x37bb56+=!settings[_0xe52dd(0x393)]?_0xe52dd(0x29b):'Notifications\x20enabled\x0a',_0x37bb56+=settings['telegramEnabled']?settings['telegramEvents']=='all'?_0xe52dd(0x2d0):'Notifications\x20types:\x20'+settings['telegramEvents']+'\x20only\x0a':'',tgBot[_0xe52dd(0x376)](_0x2fa80b[_0xe52dd(0x340)]['id'],_0x37bb56,{'parse_mode':_0xe52dd(0x290)})[_0xe52dd(0x32a)](_0x2258b2=>{telegramError(_0x2258b2);});}),tgBot[_0x389d65(0x2e9)](/\/restart/,_0x508d95=>{const _0xe6cd0b=_0x389d65;if(!validateTelegram(_0x508d95))return;tgBot[_0xe6cd0b(0x34b)](_0xe6cd0b(0x1ff));const _0x1a0ed9=getEnabledBots();if(_0x1a0ed9[_0xe6cd0b(0x357)]==0x0)tgBot['sendMessage'](_0x508d95[_0xe6cd0b(0x340)]['id'],_0xe6cd0b(0x344))[_0xe6cd0b(0x32a)](_0x3acd66=>{telegramError(_0x3acd66);});else{if(_0x1a0ed9[_0xe6cd0b(0x357)]>0x1)_0x1a0ed9['push']({'botID':'all'});let _0x229108=[],_0x4f83ff=[];const _0x2ab1cc=_0x1a0ed9[_0xe6cd0b(0x357)]%0x4==0x0||_0x1a0ed9[_0xe6cd0b(0x357)]%0x4==0x3||_0x1a0ed9[_0xe6cd0b(0x357)]%0x3==0x1?0x4:0x3;let _0x119a59=0x0;_0x1a0ed9['forEach']((_0x496dc9,_0x342e69)=>{const _0x324e5f=_0xe6cd0b;if(_0x342e69%_0x2ab1cc==0x0)_0x4f83ff=[];_0x4f83ff[_0x324e5f(0x387)]({'text':_0x496dc9['botID']==_0x324e5f(0x24f)?'All\x20bots':_0x324e5f(0x384)+_0x496dc9[_0x324e5f(0x3a1)],'callback_data':_0x496dc9[_0x324e5f(0x3a1)]}),_0x342e69%_0x2ab1cc==0x0&&(_0x229108[_0x119a59]=_0x4f83ff,_0x119a59++);}),tgBot[_0xe6cd0b(0x376)](_0x508d95[_0xe6cd0b(0x340)]['id'],_0xe6cd0b(0x2e5),{'reply_markup':{'inline_keyboard':_0x229108}})[_0xe6cd0b(0x32a)](_0x29f6e7=>{telegramError(_0x29f6e7);}),tgBot['on']('callback_query',async _0x43bfb0=>{const _0x2b6a7d=_0xe6cd0b,_0x3f348c=_0x43bfb0[_0x2b6a7d(0x252)],_0x3f1fc6=_0x43bfb0[_0x2b6a7d(0x20b)];tgBot['answerCallbackQuery'](_0x43bfb0['id'])[_0x2b6a7d(0x246)](async()=>{_0x3f348c=='all'?config['forEach'](_0x4e90a3=>{const _0x35c0c5=_0x4b9e;restartBot(_0x4e90a3[_0x35c0c5(0x3a1)]);}):restartBot(_0x3f348c);}),tgBot[_0x2b6a7d(0x34b)](_0x2b6a7d(0x1ff));});}}),tgBot[_0x389d65(0x2e9)](/\/on/,_0x38dcea=>{const _0x135e37=_0x389d65;if(!validateTelegram(_0x38dcea))return;tgBot[_0x135e37(0x34b)](_0x135e37(0x1ff));const _0x46da29=getDisabledBots();if(_0x46da29[_0x135e37(0x357)]==0x0)tgBot[_0x135e37(0x376)](_0x38dcea[_0x135e37(0x340)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x135e37(0x32a)](_0x564ae3=>{telegramError(_0x564ae3);});else{if(_0x46da29[_0x135e37(0x357)]>0x1)_0x46da29[_0x135e37(0x387)]({'botID':_0x135e37(0x24f)});let _0x33aec8=[],_0x3dcbf5=[];const _0x34591b=_0x46da29[_0x135e37(0x357)]%0x4==0x0||_0x46da29[_0x135e37(0x357)]%0x4==0x3||_0x46da29[_0x135e37(0x357)]%0x3==0x1?0x4:0x3;let _0x19d9d9=0x0;_0x46da29[_0x135e37(0x38c)]((_0x11abd6,_0x33c890)=>{const _0x8e3ccc=_0x135e37;if(_0x33c890%_0x34591b==0x0)_0x3dcbf5=[];_0x3dcbf5[_0x8e3ccc(0x387)]({'text':_0x11abd6[_0x8e3ccc(0x3a1)]=='all'?_0x8e3ccc(0x2ae):_0x8e3ccc(0x384)+_0x11abd6['botID'],'callback_data':_0x11abd6[_0x8e3ccc(0x3a1)]}),_0x33c890%_0x34591b==0x0&&(_0x33aec8[_0x19d9d9]=_0x3dcbf5,_0x19d9d9++);}),tgBot['sendMessage'](_0x38dcea[_0x135e37(0x340)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x33aec8}})[_0x135e37(0x32a)](_0x5260e2=>{telegramError(_0x5260e2);}),tgBot['on'](_0x135e37(0x1ff),async _0x12775b=>{const _0x27fe11=_0x135e37,_0x60cfe3=_0x12775b[_0x27fe11(0x252)],_0x38ce06=_0x12775b['message'];tgBot['answerCallbackQuery'](_0x12775b['id'])[_0x27fe11(0x246)](async()=>{const _0x480a7b=_0x27fe11;_0x60cfe3=='all'?(tgBot['sendMessage'](_0x38ce06[_0x480a7b(0x340)]['id'],_0x480a7b(0x2b6))['catch'](_0x2d812f=>{telegramError(_0x2d812f);}),_0x46da29[_0x480a7b(0x38c)](_0x5848d7=>{const _0xf51e90=_0x480a7b;if(_0x5848d7['botID']!=_0xf51e90(0x24f))toggleBot(_0x5848d7[_0xf51e90(0x3a1)],toggleStatus(_0x5848d7[_0xf51e90(0x3a1)]),_0xf51e90(0x240));})):(tgBot[_0x480a7b(0x376)](_0x38ce06[_0x480a7b(0x340)]['id'],_0x480a7b(0x2c4)+_0x60cfe3)[_0x480a7b(0x32a)](_0xe8a58b=>{telegramError(_0xe8a58b);}),toggleBot(_0x60cfe3,toggleStatus(_0x60cfe3),_0x480a7b(0x240)));}),tgBot[_0x27fe11(0x34b)](_0x27fe11(0x1ff));});}}),tgBot[_0x389d65(0x2e9)](/\/off/,_0x79dfe1=>{const _0x3a5531=_0x389d65;if(!validateTelegram(_0x79dfe1))return;tgBot['removeListener']('callback_query');const _0x2aa78d=getEnabledBots();if(_0x2aa78d[_0x3a5531(0x357)]==0x0)tgBot[_0x3a5531(0x376)](_0x79dfe1[_0x3a5531(0x340)]['id'],_0x3a5531(0x344))[_0x3a5531(0x32a)](_0x5228d0=>{telegramError(_0x5228d0);});else{if(_0x2aa78d[_0x3a5531(0x357)]>0x1)_0x2aa78d['push']({'botID':_0x3a5531(0x24f)});let _0x3f0c15=[],_0x19d6bd=[];const _0x5e0b37=_0x2aa78d[_0x3a5531(0x357)]%0x4==0x0||_0x2aa78d[_0x3a5531(0x357)]%0x4==0x3||_0x2aa78d[_0x3a5531(0x357)]%0x3==0x1?0x4:0x3;let _0x592c9c=0x0;_0x2aa78d[_0x3a5531(0x38c)]((_0x4e35f4,_0x694e89)=>{const _0x51d4eb=_0x3a5531;if(_0x694e89%_0x5e0b37==0x0)_0x19d6bd=[];_0x19d6bd['push']({'text':_0x4e35f4[_0x51d4eb(0x3a1)]==_0x51d4eb(0x24f)?_0x51d4eb(0x2ae):_0x51d4eb(0x384)+_0x4e35f4['botID'],'callback_data':_0x4e35f4['botID']}),_0x694e89%_0x5e0b37==0x0&&(_0x3f0c15[_0x592c9c]=_0x19d6bd,_0x592c9c++);}),tgBot['sendMessage'](_0x79dfe1[_0x3a5531(0x340)]['id'],_0x3a5531(0x314),{'reply_markup':{'inline_keyboard':_0x3f0c15}})['catch'](_0x393255=>{telegramError(_0x393255);}),tgBot['on'](_0x3a5531(0x1ff),async _0x3d3069=>{const _0x285090=_0x3a5531,_0x57b270=_0x3d3069[_0x285090(0x252)],_0x469445=_0x3d3069[_0x285090(0x20b)];tgBot[_0x285090(0x2ce)](_0x3d3069['id'])[_0x285090(0x246)](async()=>{const _0x507eb6=_0x285090;_0x57b270==_0x507eb6(0x24f)?(tgBot[_0x507eb6(0x376)](_0x469445['chat']['id'],_0x507eb6(0x241))[_0x507eb6(0x32a)](_0x3b0510=>{telegramError(_0x3b0510);}),_0x2aa78d[_0x507eb6(0x38c)](_0x31028d=>{const _0x31cbfd=_0x507eb6;if(_0x31028d['botID']!=_0x31cbfd(0x24f))toggleBot(_0x31028d[_0x31cbfd(0x3a1)],toggleStatus(_0x31028d[_0x31cbfd(0x3a1)]),_0x31cbfd(0x240));})):(tgBot['sendMessage'](_0x469445[_0x507eb6(0x340)]['id'],_0x507eb6(0x325)+_0x57b270)[_0x507eb6(0x32a)](_0x4c5b49=>{telegramError(_0x4c5b49);}),toggleBot(_0x57b270,toggleStatus(_0x57b270),_0x507eb6(0x240)));}),tgBot[_0x285090(0x34b)](_0x285090(0x1ff));});}}),tgBot[_0x389d65(0x2e9)](/\/metrics/,_0x567c19=>{const _0x1883a1=_0x389d65;if(!validateTelegram(_0x567c19))return;tgBot[_0x1883a1(0x34b)](_0x1883a1(0x1ff));const _0x1fee4d=getEnabledBots();if(_0x1fee4d[_0x1883a1(0x357)]==0x0)tgBot[_0x1883a1(0x376)](_0x567c19[_0x1883a1(0x340)]['id'],_0x1883a1(0x344))[_0x1883a1(0x32a)](_0x25fd95=>{telegramError(_0x25fd95);});else{if(_0x1fee4d[_0x1883a1(0x357)]>0x1){let _0x12a7e5=[],_0x39182f=[];const _0x52de0c=_0x1fee4d[_0x1883a1(0x357)]%0x4==0x0||_0x1fee4d[_0x1883a1(0x357)]%0x4==0x3||_0x1fee4d[_0x1883a1(0x357)]%0x3==0x1?0x4:0x3;let _0x1c37e2=0x0;_0x1fee4d[_0x1883a1(0x38c)]((_0x5914d8,_0x3a164c)=>{const _0x40e739=_0x1883a1;if(_0x3a164c%_0x52de0c==0x0)_0x39182f=[];_0x39182f['push']({'text':_0x40e739(0x384)+_0x5914d8[_0x40e739(0x3a1)],'callback_data':_0x5914d8[_0x40e739(0x3a1)]}),_0x3a164c%_0x52de0c==0x0&&(_0x12a7e5[_0x1c37e2]=_0x39182f,_0x1c37e2++);}),tgBot[_0x1883a1(0x376)](_0x567c19['chat']['id'],_0x1883a1(0x2fd),{'reply_markup':{'inline_keyboard':_0x12a7e5}})[_0x1883a1(0x32a)](_0x4d1eb0=>{telegramError(_0x4d1eb0);}),tgBot['on']('callback_query',async _0x2657f8=>{const _0x148410=_0x1883a1,_0x18566d=_0x2657f8[_0x148410(0x252)],_0x4d5729=_0x2657f8[_0x148410(0x20b)];tgBot[_0x148410(0x2ce)](_0x2657f8['id'])[_0x148410(0x246)](async()=>{const _0x4bacff=_0x148410;if(pid[_0x18566d])pid[_0x18566d][_0x4bacff(0x205)]({'function':_0x4bacff(0x239),'args':null});}),tgBot[_0x148410(0x34b)]('callback_query');});}else{const _0x44cd49=_0x1fee4d[0x0]['botID'];if(pid[_0x44cd49])pid[_0x44cd49]['send']({'function':'sendMetricsTelegram','args':null});}}}),tgBot['onText'](/\/portfolio/,_0x325f88=>{const _0x545458=_0x389d65;if(!validateTelegram(_0x325f88))return;tgBot[_0x545458(0x34b)](_0x545458(0x1ff));const _0x4cc617=getEnabledBots();if(_0x4cc617[_0x545458(0x357)]==0x0)tgBot[_0x545458(0x376)](_0x325f88[_0x545458(0x340)]['id'],_0x545458(0x344))[_0x545458(0x32a)](_0x3254d5=>{telegramError(_0x3254d5);});else{if(_0x4cc617['length']>0x1){let _0xeb139e=[],_0x1c2c3e=[];const _0x12bb86=_0x4cc617['length']%0x4==0x0||_0x4cc617['length']%0x4==0x3||_0x4cc617[_0x545458(0x357)]%0x3==0x1?0x4:0x3;let _0x188720=0x0;_0x4cc617[_0x545458(0x38c)]((_0x46e2b7,_0x53b68b)=>{const _0x4ce37c=_0x545458;if(_0x53b68b%_0x12bb86==0x0)_0x1c2c3e=[];_0x1c2c3e['push']({'text':_0x4ce37c(0x384)+_0x46e2b7[_0x4ce37c(0x3a1)],'callback_data':_0x46e2b7[_0x4ce37c(0x3a1)]}),_0x53b68b%_0x12bb86==0x0&&(_0xeb139e[_0x188720]=_0x1c2c3e,_0x188720++);}),tgBot[_0x545458(0x376)](_0x325f88[_0x545458(0x340)]['id'],_0x545458(0x326),{'reply_markup':{'inline_keyboard':_0xeb139e}})[_0x545458(0x32a)](_0x17f70f=>{telegramError(_0x17f70f);}),tgBot['on']('callback_query',async _0x2034de=>{const _0x3c31cf=_0x545458,_0x4b4f4c=_0x2034de[_0x3c31cf(0x252)],_0x2fee39=_0x2034de[_0x3c31cf(0x20b)];tgBot[_0x3c31cf(0x2ce)](_0x2034de['id'])['then'](async()=>{const _0x5bd99b=_0x3c31cf;if(pid[_0x4b4f4c])pid[_0x4b4f4c][_0x5bd99b(0x205)]({'function':_0x5bd99b(0x2f9),'args':null});}),tgBot[_0x3c31cf(0x34b)](_0x3c31cf(0x1ff));});}else{const _0x3cdc9c=_0x4cc617[0x0][_0x545458(0x3a1)];if(pid[_0x3cdc9c])pid[_0x3cdc9c][_0x545458(0x205)]({'function':_0x545458(0x2f9),'args':null});}}}),tgBot[_0x389d65(0x2e9)](/\/update/,async _0x10e493=>{const _0x1c2b9c=_0x389d65;if(!validateTelegram(_0x10e493))return;tgBot[_0x1c2b9c(0x34b)](_0x1c2b9c(0x1ff)),await getMessages();if(!updateAvailable)tgBot[_0x1c2b9c(0x376)](_0x10e493[_0x1c2b9c(0x340)]['id'],_0x1c2b9c(0x29f))['catch'](_0x49930f=>{telegramError(_0x49930f);});else!validInstallation?tgBot[_0x1c2b9c(0x376)](_0x10e493[_0x1c2b9c(0x340)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0x1c2b9c(0x32a)](_0xf3ee5e=>{telegramError(_0xf3ee5e);}):(tgBot['sendMessage'](_0x10e493[_0x1c2b9c(0x340)]['id'],_0x1c2b9c(0x2f1),{'reply_markup':{'inline_keyboard':[[{'text':_0x1c2b9c(0x36b),'callback_data':_0x1c2b9c(0x29a)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x568c85=>{telegramError(_0x568c85);}),tgBot['on'](_0x1c2b9c(0x1ff),async _0x33d40e=>{const _0xe9a710=_0x1c2b9c,_0x55f40f=_0x33d40e[_0xe9a710(0x252)],_0x196983=_0x33d40e[_0xe9a710(0x20b)];tgBot[_0xe9a710(0x2ce)](_0x33d40e['id'])['then'](async()=>{const _0x2c75f3=_0xe9a710;_0x55f40f=='yes'&&(await tgBot[_0x2c75f3(0x376)](_0x196983[_0x2c75f3(0x340)]['id'],_0x2c75f3(0x25d))[_0x2c75f3(0x32a)](_0xbfcf28=>{telegramError(_0xbfcf28);}),updateBB(_0x2c75f3(0x20c))),_0x55f40f=='no'&&await tgBot['sendMessage'](_0x196983[_0x2c75f3(0x340)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')[_0x2c75f3(0x32a)](_0x57ef31=>{telegramError(_0x57ef31);});}),tgBot[_0xe9a710(0x34b)](_0xe9a710(0x1ff));}));}),tgBot['onText'](/\/reinstall/,async _0x4d3462=>{const _0x57c25d=_0x389d65;if(!validateTelegram(_0x4d3462))return;tgBot[_0x57c25d(0x34b)](_0x57c25d(0x1ff)),!validInstallation?tgBot[_0x57c25d(0x376)](_0x4d3462[_0x57c25d(0x340)]['id'],_0x57c25d(0x297))[_0x57c25d(0x32a)](_0x290f97=>{telegramError(_0x290f97);}):(tgBot[_0x57c25d(0x376)](_0x4d3462[_0x57c25d(0x340)]['id'],_0x57c25d(0x345),{'reply_markup':{'inline_keyboard':[[{'text':_0x57c25d(0x36b),'callback_data':_0x57c25d(0x29a)},{'text':'No','callback_data':'no'}]]}})[_0x57c25d(0x32a)](_0x45a186=>{telegramError(_0x45a186);}),tgBot['on'](_0x57c25d(0x1ff),async _0x3a50c4=>{const _0x2dd3b9=_0x57c25d,_0xf90a52=_0x3a50c4[_0x2dd3b9(0x252)],_0x4154ae=_0x3a50c4[_0x2dd3b9(0x20b)];tgBot['answerCallbackQuery'](_0x3a50c4['id'])['then'](async()=>{const _0x5794f5=_0x2dd3b9;_0xf90a52==_0x5794f5(0x29a)&&(await tgBot[_0x5794f5(0x376)](_0x4154ae['chat']['id'],'Starting\x20Balance\x20Bot\x20reinstallation')[_0x5794f5(0x32a)](_0xc76fc0=>{telegramError(_0xc76fc0);}),updateBB('reinstall')),_0xf90a52=='no'&&await tgBot['sendMessage'](_0x4154ae['chat']['id'],_0x5794f5(0x348))[_0x5794f5(0x32a)](_0x586017=>{telegramError(_0x586017);});}),tgBot[_0x2dd3b9(0x34b)](_0x2dd3b9(0x1ff));}));}),tgBot['onText'](/\/toggle/,_0x3a6240=>{const _0x572762=_0x389d65;if(!validateTelegram(_0x3a6240))return;tgBot[_0x572762(0x34b)](_0x572762(0x1ff));const _0x21a453=getBotsWithMode();if(_0x21a453[_0x572762(0x357)]==0x0)tgBot[_0x572762(0x376)](_0x3a6240[_0x572762(0x340)]['id'],_0x572762(0x344))[_0x572762(0x32a)](_0x44a564=>{telegramError(_0x44a564);});else{let _0x2aaf37=[],_0x4f02f7=[];const _0x3b4239=0x2;let _0x590082=0x0;_0x21a453[_0x572762(0x38c)]((_0x1643e0,_0x5753e2)=>{const _0x1b92c9=_0x572762;if(_0x5753e2%_0x3b4239==0x0)_0x4f02f7=[];_0x4f02f7[_0x1b92c9(0x387)]({'text':'Bot\x20'+_0x1643e0['botID']+'\x20('+_0x1643e0[_0x1b92c9(0x1df)]+')','callback_data':_0x1643e0[_0x1b92c9(0x3a1)]}),_0x5753e2%_0x3b4239==0x0&&(_0x2aaf37[_0x590082]=_0x4f02f7,_0x590082++);}),tgBot[_0x572762(0x376)](_0x3a6240[_0x572762(0x340)]['id'],_0x572762(0x248),{'reply_markup':{'inline_keyboard':_0x2aaf37}})[_0x572762(0x32a)](_0x3a24b1=>{telegramError(_0x3a24b1);}),tgBot['on'](_0x572762(0x1ff),async _0x33c8d0=>{const _0x627056=_0x572762,_0x477fbe=_0x33c8d0['data'],_0x5e7073=_0x33c8d0[_0x627056(0x20b)];tgBot[_0x627056(0x2ce)](_0x33c8d0['id'])[_0x627056(0x246)](async()=>{const _0x5345eb=_0x627056,_0x437c92=_0x21a453[_0x5345eb(0x207)](_0x585d28=>_0x585d28[_0x5345eb(0x3a1)]==_0x477fbe),_0x3d8743=_0x437c92[_0x5345eb(0x1df)]=='auto'?_0x5345eb(0x278):'auto';tgBot[_0x5345eb(0x376)](_0x5e7073['chat']['id'],_0x5345eb(0x336)+_0x477fbe+_0x5345eb(0x2c5)+_0x3d8743+_0x5345eb(0x1d8))[_0x5345eb(0x32a)](_0x128236=>{telegramError(_0x128236);}),toggleBotMode(_0x477fbe);}),tgBot['removeListener'](_0x627056(0x1ff));});}}),tgBot[_0x389d65(0x2e9)](/\/names/,_0x27d23e=>{const _0xa38c17=_0x389d65;if(!validateTelegram(_0x27d23e))return;let _0x373210='';config[_0xa38c17(0x38c)](_0x250c11=>{const _0x1af9c3=_0xa38c17;_0x373210+=_0x1af9c3(0x384)+_0x250c11[_0x1af9c3(0x3a1)]+':\x20'+_0x250c11['botname']+'\x0a';}),tgBot[_0xa38c17(0x376)](_0x27d23e[_0xa38c17(0x340)]['id'],_0x373210,{'parse_mode':_0xa38c17(0x290)})[_0xa38c17(0x32a)](_0x3557df=>{telegramError(_0x3557df);});}),tgBot[_0x389d65(0x2e9)](/\/disable/,_0x4fd87f=>{const _0x59b31e=_0x389d65;if(!validateTelegram(_0x4fd87f))return;tgBot['sendMessage'](_0x4fd87f[_0x59b31e(0x340)]['id'],_0x59b31e(0x1de))['catch'](_0x3fd7b8=>{telegramError(_0x3fd7b8);}),updateSetting(_0x59b31e(0x393),![]);}),tgBot[_0x389d65(0x2e9)](/\/help/,_0x4fa955=>{const _0x445cea=_0x389d65;if(!validateTelegram(_0x4fa955))return;tgBot[_0x445cea(0x376)](_0x4fa955['chat']['id'],_0x176894)[_0x445cea(0x32a)](_0x2b5dd9=>{telegramError(_0x2b5dd9);});}),tgBot['on'](_0x389d65(0x28d),_0x341887=>{const _0x5ed6f9=_0x389d65;_0x341887[_0x5ed6f9(0x213)]()[_0x5ed6f9(0x324)](_0x5ed6f9(0x26a))&&(logger[_0x5ed6f9(0x1d0)](_0x5ed6f9(0x261)),tgBot[_0x5ed6f9(0x1e3)](),tgBot=null,io['to'](_0x5ed6f9(0x37a))[_0x5ed6f9(0x37e)](_0x5ed6f9(0x208),_0x5ed6f9(0x261)));}),process[_0x389d65(0x245)](_0x389d65(0x338),()=>{const _0x2d4066=_0x389d65;if(tgBot)tgBot[_0x2d4066(0x1e3)]();process[_0x2d4066(0x361)](0x1);}),process['once'](_0x389d65(0x226),()=>{const _0x58679f=_0x389d65;if(tgBot)tgBot['stopPolling']();process[_0x58679f(0x361)](0x1);});}}function disableTelegram(){const _0xd62e4c=_0x3b9479;tgBot&&(tgBot[_0xd62e4c(0x1e3)](),tgBot=null);}function sendTelegram(_0x483351,_0x2d568f){const _0x3d45ee=_0x3b9479;if(settings[_0x3d45ee(0x393)]){if(settings[_0x3d45ee(0x232)]==_0x3d45ee(0x24f)||(_0x2d568f[_0x3d45ee(0x283)]=='error'||_0x2d568f[_0x3d45ee(0x283)]==_0x3d45ee(0x253)||_0x2d568f['type']=='success')&&settings[_0x3d45ee(0x232)]==_0x3d45ee(0x1d3)||_0x2d568f[_0x3d45ee(0x283)]==_0x3d45ee(0x21d)&&settings[_0x3d45ee(0x232)]=='orders'){if(tgBot&&settings['telegramChatId']){if(_0x2d568f[_0x3d45ee(0x288)])tgBot[_0x3d45ee(0x376)](settings['telegramChatId'],_0x2d568f['botname']+_0x3d45ee(0x346)+_0x2d568f[_0x3d45ee(0x21a)])[_0x3d45ee(0x32a)](_0x45bf40=>{telegramError(_0x45bf40);});else tgBot['sendMessage'](settings[_0x3d45ee(0x1ef)],_0x3d45ee(0x384)+_0x483351+'\x20>\x20'+_0x2d568f[_0x3d45ee(0x21a)])[_0x3d45ee(0x32a)](_0x2497e3=>{telegramError(_0x2497e3);});}}}}async function sendTelegramMsg(_0xe51247,_0x44902a=_0x3b9479(0x290)){const _0x51a0ca=_0x3b9479;return settings[_0x51a0ca(0x393)]&&tgBot&&settings[_0x51a0ca(0x1ef)]?(await tgBot[_0x51a0ca(0x376)](settings[_0x51a0ca(0x1ef)],_0xe51247,{'parse_mode':_0x44902a})[_0x51a0ca(0x32a)](_0x3dcbc7=>{telegramError(_0x3dcbc7);}),!![]):![];}function getDeviceWithIp(_0x4a349a){const _0x54bd33=_0x3b9479;return devices[_0x54bd33(0x207)](_0xfb5cac=>_0xfb5cac['ip']===_0x4a349a);}function temporaryAccess2FA(_0x3e507e,_0x1cd574){const _0x144c11=_0x3b9479;let _0x47caab=new Date(),_0x475686=![];if(lastIpApproval){if(_0x47caab-lastIpApproval<0x1388)_0x475686=!![];}lastIpApproval=new Date();if(_0x475686)return;tgBot&&settings[_0x144c11(0x1ef)]&&(tgBot[_0x144c11(0x34b)]('callback_query'),tgBot[_0x144c11(0x376)](settings[_0x144c11(0x1ef)],_0x144c11(0x2fc)+normalizeIP(_0x1cd574)[_0x144c11(0x330)]+_0x144c11(0x1d1),{'parse_mode':_0x144c11(0x290),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x144c11(0x398),'callback_data':'15'},{'text':_0x144c11(0x20f),'callback_data':'30'},{'text':_0x144c11(0x291),'callback_data':'reject'}]]}})['catch'](_0x340c54=>{telegramError(_0x340c54);}),tgBot['on']('callback_query',async _0x57c713=>{const _0x23efe0=_0x144c11,_0x33761b=_0x57c713[_0x23efe0(0x252)],_0xc406b7=_0x57c713[_0x23efe0(0x20b)];tgBot[_0x23efe0(0x2ce)](_0x57c713['id'])['then'](async()=>{const _0x529bad=_0x23efe0;devices[_0x3e507e][_0x529bad(0x230)]={'clientip':_0x1cd574,'timestamp':new Date()[_0x529bad(0x374)](),'expiry':_0x33761b},_0x33761b!='reject'?(await tgBot[_0x529bad(0x376)](_0xc406b7[_0x529bad(0x340)]['id'],_0x529bad(0x304)+_0x33761b+_0x529bad(0x1e2),{'parse_mode':_0x529bad(0x290)})[_0x529bad(0x32a)](_0x5126e8=>{telegramError(_0x5126e8);}),io['to'](_0x3e507e)[_0x529bad(0x37e)](_0x529bad(0x311),{'access':{'allow':![],'reason':_0x529bad(0x352),'token':null}})):(await tgBot[_0x529bad(0x376)](_0xc406b7[_0x529bad(0x340)]['id'],_0x529bad(0x3b1))[_0x529bad(0x32a)](_0x47fc4a=>{telegramError(_0x47fc4a);}),io['to'](_0x3e507e)[_0x529bad(0x37e)](_0x529bad(0x311),{'access':{'allow':![],'reason':_0x529bad(0x362),'token':null}}));}),tgBot['removeListener']('callback_query');}));}function loginAccess2FA(_0x5ab3aa,_0x52ad39){const _0x1f4d87=_0x3b9479;tgBot&&settings[_0x1f4d87(0x1ef)]&&(tgBot[_0x1f4d87(0x34b)](_0x1f4d87(0x1ff)),tgBot[_0x1f4d87(0x376)](settings['telegramChatId'],_0x1f4d87(0x2f4)+normalizeIP(_0x52ad39)[_0x1f4d87(0x330)]+_0x1f4d87(0x1d1),{'parse_mode':_0x1f4d87(0x290),'reply_markup':{'inline_keyboard':[[{'text':_0x1f4d87(0x1f5),'callback_data':loginExpiry},{'text':_0x1f4d87(0x291),'callback_data':_0x1f4d87(0x291)}]]}})['catch'](_0x3b461d=>{telegramError(_0x3b461d);}),tgBot['on'](_0x1f4d87(0x1ff),async _0x1d7dbb=>{const _0x18430d=_0x1f4d87,_0x2eab62=_0x1d7dbb[_0x18430d(0x252)],_0xaffb94=_0x1d7dbb['message'];tgBot[_0x18430d(0x2ce)](_0x1d7dbb['id'])[_0x18430d(0x246)](async()=>{const _0x22be30=_0x18430d;devices[_0x5ab3aa][_0x22be30(0x250)]={'clientip':_0x52ad39,'timestamp':new Date()[_0x22be30(0x374)](),'expiry':_0x2eab62},_0x2eab62!=_0x22be30(0x291)?(await tgBot[_0x22be30(0x376)](_0xaffb94[_0x22be30(0x340)]['id'],'Login\x20accepted',{'parse_mode':'HTML'})['catch'](_0x233a59=>{telegramError(_0x233a59);}),io['to'](_0x5ab3aa)[_0x22be30(0x37e)](_0x22be30(0x311),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x22be30(0x376)](_0xaffb94[_0x22be30(0x340)]['id'],_0x22be30(0x20a))[_0x22be30(0x32a)](_0x18938d=>{telegramError(_0x18938d);}),io['to'](_0x5ab3aa)['emit'](_0x22be30(0x311),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x18430d(0x34b)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0xec7cf0=_0x3b9479;return dbConfig[_0xec7cf0(0x342)](_0xec7cf0(0x369))[_0xec7cf0(0x22f)](_0xec7cf0(0x3a1))[_0xec7cf0(0x2f8)]({'status':_0xec7cf0(0x254)})['value']()||[];}function getDisabledBots(){const _0x5e0161=_0x3b9479;return dbConfig[_0x5e0161(0x342)](_0x5e0161(0x369))[_0x5e0161(0x22f)](_0x5e0161(0x3a1))[_0x5e0161(0x2f8)]({'status':'disabled'})[_0x5e0161(0x3a8)]()||[];}function getBotAttributes(_0x2206c7){const _0x2ad4b9=_0x3b9479;let _0x2d7a96={};const _0x1e39db=configpath+_0x2ad4b9(0x34c)+_0x2206c7+_0x2ad4b9(0x36f),_0x90a1aa=fs[_0x2ad4b9(0x1e4)](_0x1e39db);if(_0x90a1aa){const _0x4e7019=fs[_0x2ad4b9(0x29e)](_0x1e39db);try{const _0x188e33=JSON[_0x2ad4b9(0x388)](_0x4e7019),_0x37f845=_0x188e33?_0x188e33[_0x2ad4b9(0x266)][0x0][_0x2ad4b9(0x2a2)]:![];_0x2d7a96[_0x2ad4b9(0x1df)]=_0x37f845?_0x2ad4b9(0x223):_0x2ad4b9(0x278),_0x2d7a96[_0x2ad4b9(0x28b)]=_0x188e33?_0x188e33[_0x2ad4b9(0x266)][0x0][_0x2ad4b9(0x28b)]:'Bot\x20'+_0x2206c7;}catch(_0x293a1c){_0x2d7a96[_0x2ad4b9(0x1df)]=_0x2ad4b9(0x278),_0x2d7a96['botname']=_0x2ad4b9(0x384)+_0x2206c7;}}else _0x2d7a96[_0x2ad4b9(0x1df)]=_0x2ad4b9(0x278),_0x2d7a96[_0x2ad4b9(0x28b)]=_0x2ad4b9(0x384)+_0x2206c7;return _0x2d7a96;}function getBotsWithMode(){const _0x179083=_0x3b9479,_0x1f3800=dbConfig['get']('bots')[_0x179083(0x22f)](_0x179083(0x3a1))['value']()||[];return _0x1f3800[_0x179083(0x38c)](_0x354746=>{const _0x141317=_0x179083;let _0x25a14d=getBotAttributes(_0x354746[_0x141317(0x3a1)]);_0x354746['mode']=_0x25a14d[_0x141317(0x1df)];}),_0x1f3800;}function getBotExchanges(){const _0x1b9e1a=_0x3b9479;let _0x2ad149=[];const _0x1a3483=dbConfig[_0x1b9e1a(0x342)](_0x1b9e1a(0x369))[_0x1b9e1a(0x22f)](_0x1b9e1a(0x3a1))[_0x1b9e1a(0x3a8)]()||[];_0x1a3483['forEach'](_0x4b1f9b=>{const _0xd6d79e=_0x1b9e1a;if(_0x4b1f9b[_0xd6d79e(0x311)]==_0xd6d79e(0x254)){const _0x315e10=configpath+_0xd6d79e(0x34c)+_0x4b1f9b[_0xd6d79e(0x3a1)]+_0xd6d79e(0x36f),_0x403be3=fs[_0xd6d79e(0x1e4)](_0x315e10);let _0x1d46c6;if(_0x403be3){const _0x2f9ba6=fs['readFileSync'](_0x315e10);try{const _0x285059=JSON[_0xd6d79e(0x388)](_0x2f9ba6);_0x1d46c6=_0x285059?_0x285059['bot'][0x0][_0xd6d79e(0x317)]:null;}catch(_0x1edaf1){}}if(_0x1d46c6)_0x2ad149[_0xd6d79e(0x387)](_0x1d46c6);}});const _0x456d1f=[...new Set(_0x2ad149)]['sort']();return _0x456d1f;}async function initUser(){const _0x4842b6=_0x3b9479;if(!settings[_0x4842b6(0x310)]){const _0x53dc8b=uuidRandom();mixpanel[_0x4842b6(0x316)](_0x53dc8b),updateSetting(_0x4842b6(0x310),_0x53dc8b);}}async function initSecure(){const _0x573c5a=_0x3b9479;let _0x524137=getSecure();if(!_0x524137[_0x573c5a(0x259)](_0x573c5a(0x30f))){let _0x4837b3=await generateKeys();_0x524137['publicKey']=_0x4837b3[_0x573c5a(0x3af)],_0x524137[_0x573c5a(0x27a)]=_0x4837b3['privateKey'],_0x524137[_0x573c5a(0x30f)]=crypto[_0x573c5a(0x315)](0x20)[_0x573c5a(0x213)](_0x573c5a(0x2cb));;storeSecure(_0x524137);}}function getSettings(){const _0x3e1f18=_0x3b9479;return dbSettings[_0x3e1f18(0x342)](_0x3e1f18(0x225))['value']()||{};}function getSecure(){const _0x34f0d1=_0x3b9479;return dbSecure[_0x34f0d1(0x342)](_0x34f0d1(0x36d))[_0x34f0d1(0x3a8)]()||{};}function getBlacklist(){const _0x43f842=_0x3b9479;return dbSecure[_0x43f842(0x342)](_0x43f842(0x26e))[_0x43f842(0x3a8)]()||[];}function _0x3912(){const _0x1b0a04=['connected','toString','2022270KBYiur','crypto','date-fns','sort','backup-full.zip','backup','event','disabled','output-001.log','order','getUTCHours','Failed\x20to\x20download\x20','/:bot/coins','apply','verify','auto','new','settings','SIGTERM','get-backup-files','Logged\x20in\x20user\x20...','success','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Unauthorized\x20attempt\x20to\x20get\x20messages','apiKey','reset-password','sortBy','telegramIpApproval','assign','telegramEvents','init','loginRequired','running','join','restart','Node.js\x20v','sendMetricsTelegram','Unauthorized\x20login\x20attempt\x20(timeout)','messages','bcryptjs','unlinkSync','$1_$2_$3','sendFile','stopped','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','node','yargs/yargs','jsonwebtoken','once','then','isDirectory','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','2610314CQjziX','login','randomFillSync','access\x20timeout','initclient','defaults','all','telegram2FaApproval','You\x20can\x20use\x20the\x20following\x20commands:\x0a','data','warning','enabled','format','379055KyycUZ','stop','settings.','hasOwnProperty','store-configuration','apiPassword','child_process','Starting\x20Balance\x20Bot\x20update','place-order','5547519eqNtrm','#RES#\x20if\x20running\x20on\x20server','Invalid\x20Telegram\x20token','ipc','password','version.json','showConfig','bot','storeFiat','isIPv4MappedAddress','/download/:type','404\x20Not\x20Found','store','Starting\x20bot\x20|\x20Bot\x20','listen','blacklist','/off\x20-\x20stop\x20bot(s)\x0a','token','mtime','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','removeAllListeners','636FciJKb','split','Markdown','/disable\x20-\x20disable\x20notifications\x0a','manual','backup-full@','privateKey','backupfile','bb-settings.json','RSA-OAEP','get-logs','/:bot/support','lastmsgemitted','files','log','type','22SBCiWQ','/names\x20-\x20show\x20bot\x20names\x0a','binary','number','showname','handshake','2FA\x20login\x20token\x20generated','botname','access','polling_error','bb-secure.json','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','HTML','reject','/:bot/portfolio','disconnect','startsWith','restore-backup-file','8lrgVnF','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','lastmsgtelegram','confirm-message','yes','Notifications\x20disabled\x0a','backup/','telegramToken','readFileSync','Your\x20installation\x20is\x20already\x20up\x20to\x20date','\x20|\x20','Error:\x20Invalid\x20argument\x20','headless','\x20|\x20client:\x20...','bot.js','get-messages','-performance.json','cancelLoading','timeshift','(((.+)+)+)+$','/:bot/performance','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U',',\x20must\x20be\x20a\x204\x20digit\x20number','No\x20authentication\x20token','All\x20bots','Token\x20blacklisted','build2','express','Restore\x20process\x20aborted','emitHistory','name','telegram','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','bbUsername','server','bb/','Restoring\x20bot(s)\x20from\x20backup','timestamp','logout','uuid','address','update-bot','getSeconds','Idling\x20bot\x20\x20\x20|\x20Bot\x20','allow','util','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','\x20to\x20','\x1b[34m','track','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','new-disabled','Unauthorized\x20attempt\x20to\x20download\x20','hex','max','2rGEShi','answerCallbackQuery','output-003.log','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','logs/','statSync','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','getDate','tkn','Ok,\x20will\x20send\x20alert\x20notifications\x20only','store-headless','bbvNew','request','mkdirSync','connection','host','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','/enable\x20-\x20enable\x20notifications\x0a','writeFileSync','write','/help\x20-\x20show\x20available\x20commands\x0a','test','private','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Deleted\x20Bot\x20','<b>Balance\x20Bot\x20Status:</b>\x0a',':\x20Bot\x20Mgr\x20>\x20','onText','getPortfolio','pidExpireLogin','readdirSync','live','username','reason','remove','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','toIPv4MappedAddress','\x20(1)','Allow\x20login\x20from\x20IP\x20address\x20<b>','uuid-random','Notifications\x20enabled','rmSync','filter','sendPortfolioTelegram','temporary\x20access\x20timeout','ipv6','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','0.0.0','Ok,\x20will\x20send\x20order\x20notifications\x20only','axios','simple','deleteHistoryAlerts','output-002.log','Access\x20enabled\x20for\x20','orders','/metrics\x20-\x20show\x20bot\x20performance\x0a','kind','Enabled\x20Bot\x20','-events.json','-----------------------------------------------------------------------------------','socket.io','apiSecret','/status\x20-\x20show\x20bot(s)\x20status\x0a','inherit','secret','userid','status','keys','generate','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','randomBytes','alias','exchange','clients','socket','Unauthorized\x20attempt\x20to\x20update\x20settings','2FA','DEFLATE','whitelistEnabled','telegrammsg','127.0.0.1','store-settings','update-bb','http','mixpanel','includes','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','All','argv','toggleBotMode','catch','delete-alerts','lowdb','932rGThQA','stringify','path','show','login\x20token\x20generated','storeHeadless','Unauthorized\x20attempt\x20to\x20store\x20configuration','graphql-request','106625JgexZb','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','range','SIGINT','6b67f3d61ee94b8f5c80b4affef4c4d9','pidRefreshToken','download','temporary\x20token\x20generated','***','getMinutes','f2aRequired','chat','Password\x20reset\x20rejected','get','Unauthorized\x20attempt\x20to\x20add\x20bot','No\x20bots\x20running\x20right\x20now','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','\x20>\x20','_data','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','sign','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','removeListener','bot-','Backup\x20file\x20unzipped\x20and\x20stored','match','expiry','Logged\x20out\x20user\x20...','temporaryAccessAllowed','reload','Server','Starting\x20new\x20bot\x20|\x20Bot\x20','telegramUsername','bb-config.json','length','kill','#RES#\x20if\x20running\x20locally\x0a','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','2FA\x20required','onepagemode','conn','Starting\x20#RED#Balance\x20Bot\x20v','RSA','static','exit','temporary\x20access\x20rejected','8268PcECml','3000','Error\x20while\x20deleting\x20config\x20files:\x20','from','/:bot/history','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','bots','/on\x20-\x20start\x20bot(s)\x0a','Yes','Unauthorized\x20attempt\x20to\x20delete\x20bot','secure','clientip','-config.json','hashSync','min','Setting\x20access:\x20','5145DjaOjK','getTime','fork','sendMessage','temporary\x20access\x20not\x20allowed','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','getHours','botmanager','/output-000.log','sha256','Bot\x20Mgr\x20>\x20','emit','sockets','Unauthorized\x20attempt\x20to\x20get\x20events','slice','started','login\x20required','Bot\x20','decrypt','\x1b[31m','push','parse','Starting\x20Balance\x20Bot\x20','ipaddr.js','zip/','forEach','storeConfiguration','config/','remoteAddress','.zip','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','updatebotmanager','telegramEnabled','node-telegram-bot-api','placeOrder','uncaughtException','toggle-bot-mode','15\x20min','>\x20Open\x20Bot\x20Manager\x20at\x20#BLU#http://localhost:','auth','\x20(2)','1000','18GwnUuc','NTBA_FIX_319','use','function','botID','Invalid\x20authentication\x20token\x20(1)','headers','referer','Restore\x20backup\x20file\x20','::1','Unauthorized\x20attempt\x20to\x20confirm\x20message','value','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','search','getMonth','>\x20Open\x20Bot\x20Manager\x20at\x20#BLU#http://','any','login\x20token\x20valid','publicKey','version','Temporary\x20access\x20rejected','bbvReceive','copyFileSync','full','</b>\x20?','Restarting\x20Bot\x20','alerts','Alerts','\x1b[0m','backup-files','Invalid\x20authentication\x20token\x20(2)','\x20mode','login\x20not\x20required','latestversion','backup-full','isValid','build','Notifications\x20disabled','mode','index.html','Unauthorized\x20attempt\x20to\x20log\x20out','\x20minutes','stopPolling','existsSync','debug','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','padStart','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','user','temp/','node-zip','/:bot/configuration','2FA\x20login\x20required','Unauthorized\x20attempt\x20to\x20update\x20bot','telegramChatId','invalid\x20credentials','exec','replace','set','params','accept','toIPv4Address','getFullYear','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','versions','#RES#\x0a','bbPassword','hybrid-crypto-js','************','Unauthorized\x20attempt\x20to\x20delete\x20alerts','callback_query','cancel-loading','/restart\x20-\x20restart\x20bot(s)\x0a','logged\x20out','exp','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','send','[ip-address]','find','notification','endsWith','Login\x20rejected','message','update','Session\x20expired\x20for\x20user\x20...','User\x20has\x20been\x20validated','30\x20min','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','file'];_0x3912=function(){return _0x1b0a04;};return _0x3912();}function broadcastToBots(_0x4a1151,_0x94436b){config['forEach'](_0x5e3421=>{const _0x312f48=_0x4b9e;if(_0x5e3421['status']==_0x312f48(0x254)&&_0x5e3421[_0x312f48(0x2ed)]==_0x312f48(0x235)||_0x5e3421['status']==_0x312f48(0x224)&&_0x5e3421[_0x312f48(0x2ed)]=='running'){if(pid[_0x5e3421[_0x312f48(0x3a1)]])pid[_0x5e3421[_0x312f48(0x3a1)]]['send']({[_0x4a1151]:_0x94436b});}});}function storeSettings(_0x244945,_0x35ef49=![]){const _0x1e6be3=_0x3b9479;_0x244945={...settings,..._0x244945};if(_0x35ef49&&_0x244945[_0x1e6be3(0x1fb)]!=_0x1e6be3(0x1fd)&&_0x244945[_0x1e6be3(0x1fb)]!=_0x1e6be3(0x33d)&&_0x244945['bbPassword']!=''){const _0x3ff63d=crypt['decrypt'](secure[_0x1e6be3(0x27a)],_0x244945[_0x1e6be3(0x1fb)])[_0x1e6be3(0x20b)][_0x1e6be3(0x275)]('@')[0x0],_0x3100b1=bcrypt[_0x1e6be3(0x370)](_0x3ff63d,saltRounds);_0x244945={..._0x244945,'bbPassword':_0x3100b1};}if(_0x35ef49&&_0x244945[_0x1e6be3(0x29d)]!='************'&&_0x244945[_0x1e6be3(0x29d)]!=_0x1e6be3(0x33d)&&_0x244945[_0x1e6be3(0x29d)]!=''){const _0x52dddc=crypt[_0x1e6be3(0x385)](secure[_0x1e6be3(0x27a)],_0x244945[_0x1e6be3(0x29d)])[_0x1e6be3(0x20b)][_0x1e6be3(0x275)]('@')[0x0];_0x244945={..._0x244945,'telegramToken':_0x52dddc};}const _0x21ebb5=_0x244945[_0x1e6be3(0x29d)]!=_0x1e6be3(0x1fd)&&_0x244945[_0x1e6be3(0x29d)]!=settings['telegramToken']||_0x244945[_0x1e6be3(0x355)]!=settings[_0x1e6be3(0x355)],_0x3c1086=_0x244945[_0x1e6be3(0x29d)]==''||_0x244945[_0x1e6be3(0x355)]=='';if(_0x21ebb5)_0x244945[_0x1e6be3(0x232)]='all';for(const [_0x18a4cc,_0x5acaf9]of Object['entries'](_0x244945)){if(_0x18a4cc==_0x1e6be3(0x29d)&&_0x5acaf9==_0x1e6be3(0x1fd)){_0x244945[_0x1e6be3(0x29d)]=settings['telegramToken'];continue;};if(_0x18a4cc==_0x1e6be3(0x1fb)&&_0x5acaf9=='************'){_0x244945[_0x1e6be3(0x1fb)]=settings['bbPassword'];continue;};dbSettings[_0x1e6be3(0x1f3)](_0x1e6be3(0x258)+_0x18a4cc,_0x5acaf9)['write']();}settings=_0x244945,io['to'](_0x1e6be3(0x37a))[_0x1e6be3(0x37e)]('settings',cleanSettings()),broadcastToBots(_0x1e6be3(0x2a8),settings[_0x1e6be3(0x2a8)]),broadcastToBots(_0x1e6be3(0x35c),settings[_0x1e6be3(0x35c)]);if(_0x21ebb5&&!_0x3c1086)initTelegram();if(_0x21ebb5&&_0x3c1086)disableTelegram();getAllClients()[_0x1e6be3(0x38c)](_0x18e6a2=>{const _0x30e087=_0x1e6be3;getSocket(_0x18e6a2['id'])[_0x30e087(0x37e)](_0x30e087(0x311),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x50a5c0,_0x1c5992){const _0x7c2660=_0x3b9479;dbSettings['set'](_0x7c2660(0x258)+_0x50a5c0,_0x1c5992)[_0x7c2660(0x2e1)](),settings=getSettings(),io['to']('botmanager')[_0x7c2660(0x37e)]('settings',cleanSettings());}function storeSecure(_0xf5e47d){const _0x439491=_0x3b9479;dbSecure[_0x439491(0x342)]('secure')[_0x439491(0x387)](_0xf5e47d)['write'](),secure=_0xf5e47d;}function addBlacklist(_0x5541e3){const _0x535a8f=_0x3b9479;cleanBlacklist();let _0x36ef44;devices[_0x5541e3][_0x535a8f(0x230)]?_0x36ef44=Math[_0x535a8f(0x2cc)](devices[_0x5541e3][_0x535a8f(0x230)][_0x535a8f(0x34f)],loginExpiry):_0x36ef44=loginExpiry,dbSecure[_0x535a8f(0x342)](_0x535a8f(0x26e))[_0x535a8f(0x387)]({'expiry':new Date()['getTime']()+_0x36ef44*0x3c*0x3e8,'token':devices[_0x5541e3]['access'][_0x535a8f(0x270)]})['write'](),blacklist=dbSecure[_0x535a8f(0x342)](_0x535a8f(0x26e))[_0x535a8f(0x3a8)]();}function cleanBlacklist(){const _0x4f541b=_0x3b9479;let _0x4dda52=dbSecure['get'](_0x4f541b(0x26e))['cloneDeep']()[_0x4f541b(0x3a8)](),_0x1d598e=new Date()[_0x4f541b(0x374)]();_0x4dda52[_0x4f541b(0x38c)](_0x10374f=>{const _0x820bd8=_0x4f541b;_0x10374f['expiry']<_0x1d598e&&dbSecure[_0x820bd8(0x342)](_0x820bd8(0x26e))[_0x820bd8(0x2f0)]({'expiry':_0x10374f[_0x820bd8(0x34f)]})['write']();});}function initStates(){const _0x19f19e=_0x3b9479;let _0x3fe2c3=getConfiguration();_0x3fe2c3[_0x19f19e(0x38c)](_0x123314=>{const _0x264086=_0x19f19e;_0x123314['live']=_0x264086(0x240);}),storeConfiguration(_0x3fe2c3);}function onKeys(){const _0x2c9771=new RSA();return new Promise(_0x5296fe=>{const _0x783433=_0x4b9e;_0x2c9771['generateKeyPairAsync']()[_0x783433(0x246)](_0x4228d3=>{_0x5296fe(_0x4228d3);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x47b5b7=_0x3b9479;let _0x4497f3=getSettings(),_0x2889c4=![];!_0x4497f3[_0x47b5b7(0x259)](_0x47b5b7(0x298))&&(_0x4497f3[_0x47b5b7(0x298)]=0x0,_0x2889c4=!![]);!_0x4497f3[_0x47b5b7(0x259)]('lastmsgemitted')&&(_0x4497f3[_0x47b5b7(0x280)]=0x0,_0x2889c4=!![]);!_0x4497f3[_0x47b5b7(0x259)](_0x47b5b7(0x1da))&&(_0x4497f3[_0x47b5b7(0x1da)]=_0x47b5b7(0x2fe),_0x2889c4=!![]);!_0x4497f3[_0x47b5b7(0x259)]('onepagemode')&&(_0x4497f3[_0x47b5b7(0x35c)]=![],_0x2889c4=!![]);if(_0x2889c4)storeSettings(_0x4497f3);}function storeConfiguration(_0xfc3686){const _0x31b063=_0x3b9479;dbConfig['get']('bots')[_0x31b063(0x2f0)]()[_0x31b063(0x2e1)](),_0xfc3686[_0x31b063(0x38c)](_0x257ebe=>{const _0x2ae41b=_0x31b063;delete _0x257ebe[_0x2ae41b(0x1df)];}),dbConfig[_0x31b063(0x342)](_0x31b063(0x369))[_0x31b063(0x387)](..._0xfc3686)[_0x31b063(0x2e1)](),config=_0xfc3686;}function resetPassword(){const _0x1ea26a=_0x3b9479;tgBot&&settings['telegramChatId']&&(tgBot['removeListener'](_0x1ea26a(0x1ff)),tgBot[_0x1ea26a(0x376)](settings[_0x1ea26a(0x1ef)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x1ea26a(0x290),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x1ea26a(0x29a)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x98d5b8=>{telegramError(_0x98d5b8);}),tgBot['on'](_0x1ea26a(0x1ff),async _0x473e71=>{const _0x1ebf42=_0x1ea26a,_0x36a2c9=_0x473e71[_0x1ebf42(0x252)],_0x9a8781=_0x473e71[_0x1ebf42(0x20b)];tgBot[_0x1ebf42(0x2ce)](_0x473e71['id'])['then'](async()=>{const _0x3844c9=_0x1ebf42;if(_0x36a2c9!='no'){const _0x19de12=0xf,_0x483e77='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x1269e5=Array['from'](crypto[_0x3844c9(0x24b)](new Uint32Array(_0x19de12)))['map'](_0x5a879c=>_0x483e77[_0x5a879c%_0x483e77[_0x3844c9(0x357)]])[_0x3844c9(0x236)](''),_0x44b82b=bcrypt[_0x3844c9(0x370)](_0x1269e5,saltRounds);storeSettings({'bbPassword':_0x44b82b}),await tgBot['sendMessage'](_0x9a8781[_0x3844c9(0x340)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x1269e5,{'parse_mode':_0x3844c9(0x290)})[_0x3844c9(0x32a)](_0x55d149=>{telegramError(_0x55d149);});}else await tgBot['sendMessage'](_0x9a8781[_0x3844c9(0x340)]['id'],_0x3844c9(0x341))[_0x3844c9(0x32a)](_0x41851d=>{telegramError(_0x41851d);});}),tgBot['removeListener']('callback_query');}));}async function confirmRestore(_0x120487,_0x414087){const _0x3a2771=_0x3b9479;io['to']('botmanager')[_0x3a2771(0x37e)](_0x3a2771(0x208),_0x3a2771(0x1e6),_0x3a2771(0x229)),tgBot&&settings['telegramChatId']&&(tgBot[_0x3a2771(0x34b)](_0x3a2771(0x1ff)),await tgBot['sendMessage'](settings[_0x3a2771(0x1ef)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':_0x3a2771(0x290),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x3a2771(0x29a)},{'text':'no','callback_data':'no'}]]}})[_0x3a2771(0x32a)](_0x192b01=>{telegramError(_0x192b01);}),tgBot['on']('callback_query',async _0x34cadc=>{const _0x2aa940=_0x3a2771,_0x3fc51b=_0x34cadc[_0x2aa940(0x252)],_0x3710c6=_0x34cadc[_0x2aa940(0x20b)];tgBot[_0x2aa940(0x2ce)](_0x34cadc['id'])['then'](async()=>{const _0x2ca1bb=_0x2aa940;_0x3fc51b==_0x2ca1bb(0x29a)?(await tgBot['sendMessage'](_0x3710c6[_0x2ca1bb(0x340)]['id'],_0x2ca1bb(0x2ba),{'parse_mode':'HTML'})[_0x2ca1bb(0x32a)](_0x54a08a=>{telegramError(_0x54a08a);}),unzipFile(_0x120487,_0x414087)):(logger[_0x2ca1bb(0x1e5)](_0x2ca1bb(0x2b2)),await tgBot[_0x2ca1bb(0x376)](_0x3710c6[_0x2ca1bb(0x340)]['id'],_0x2ca1bb(0x2b2))[_0x2ca1bb(0x32a)](_0x2c64d5=>{telegramError(_0x2c64d5);}));}),tgBot[_0x2aa940(0x34b)](_0x2aa940(0x1ff));}));}function getServerTime(){const _0x2c41dc=_0x3b9479,_0x53dfa4=new Date();return _0x53dfa4['getFullYear']()+'/'+(_0x53dfa4[_0x2c41dc(0x3ab)]()+0x1)[_0x2c41dc(0x213)]()[_0x2c41dc(0x1e7)](0x2,'0')+'/'+_0x53dfa4[_0x2c41dc(0x2d4)]()[_0x2c41dc(0x213)]()[_0x2c41dc(0x1e7)](0x2,'0')+'\x20'+_0x53dfa4[_0x2c41dc(0x379)]()[_0x2c41dc(0x213)]()[_0x2c41dc(0x1e7)](0x2,'0')+':'+_0x53dfa4[_0x2c41dc(0x33e)]()[_0x2c41dc(0x213)]()[_0x2c41dc(0x1e7)](0x2,'0')+':'+_0x53dfa4[_0x2c41dc(0x2c0)]()[_0x2c41dc(0x213)]()[_0x2c41dc(0x1e7)](0x2,'0');}function getTimeStamp(){const _0x13b352=_0x3b9479,_0x21dc6a=shiftedTime();return _0x21dc6a[_0x13b352(0x1f7)]()+'/'+(_0x21dc6a[_0x13b352(0x3ab)]()+0x1)[_0x13b352(0x213)]()['padStart'](0x2,'0')+'/'+_0x21dc6a[_0x13b352(0x2d4)]()[_0x13b352(0x213)]()[_0x13b352(0x1e7)](0x2,'0')+'\x20'+_0x21dc6a[_0x13b352(0x379)]()[_0x13b352(0x213)]()[_0x13b352(0x1e7)](0x2,'0')+':'+_0x21dc6a['getMinutes']()['toString']()[_0x13b352(0x1e7)](0x2,'0')+':'+_0x21dc6a['getSeconds']()[_0x13b352(0x213)]()[_0x13b352(0x1e7)](0x2,'0');}function getCleanTimeStamp(){const _0x43148a=_0x3b9479,_0x53a2c9=shiftedTime();return _0x53a2c9[_0x43148a(0x1f7)]()+(_0x53a2c9['getMonth']()+0x1)[_0x43148a(0x213)]()[_0x43148a(0x1e7)](0x2,'0')+_0x53a2c9[_0x43148a(0x2d4)]()['toString']()[_0x43148a(0x1e7)](0x2,'0')+'-'+_0x53a2c9[_0x43148a(0x379)]()[_0x43148a(0x213)]()[_0x43148a(0x1e7)](0x2,'0')+_0x53a2c9[_0x43148a(0x33e)]()[_0x43148a(0x213)]()[_0x43148a(0x1e7)](0x2,'0')+_0x53a2c9[_0x43148a(0x2c0)]()['toString']()[_0x43148a(0x1e7)](0x2,'0');}function shiftedTime(){const _0x3fd3da=_0x3b9479,_0x5b87b0=new Date();let _0x378d96=_0x5b87b0;if(settings['timeshift']&&settings[_0x3fd3da(0x2a8)]!==0x0)_0x378d96=fns['add'](_0x5b87b0,{'hours':settings['timeshift']});return _0x378d96;}function startScheduler(){const _0x124fed=_0x3b9479,_0x35b01c=new Date()[_0x124fed(0x21e)](),_0x48397c=shiftedTime()['getHours']();_0x48397c==0x4&&backupConfigFiles();_0x48397c==0x0&&rotateLogFiles();_0x35b01c%0x6==0x0&&triggerAnalytics();_0x35b01c%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x55a4a4){const _0x2ff837=_0x3b9479;logger[_0x2ff837(0x1e5)](_0x2ff837(0x3a5)+_0x55a4a4);const _0x5f3d6c=getBotsWithMode();_0x5f3d6c[_0x2ff837(0x357)]>0x0?confirmRestore(configbackuppath,_0x55a4a4):unzipFile(configbackuppath,_0x55a4a4);}async function getBackupFiles(_0x555d11=null){const _0x3aebc9=_0x3b9479;let _0x1f7bc2=[],_0x1d94df=fs[_0x3aebc9(0x2ec)](configbackuppath,{'withFileTypes':!![]});_0x1d94df['sort']((_0x13f4df,_0x35278f)=>_0x13f4df['name']<_0x35278f[_0x3aebc9(0x2b4)]?0x1:_0x35278f[_0x3aebc9(0x2b4)]<_0x13f4df[_0x3aebc9(0x2b4)]?-0x1:0x0),_0x1d94df[_0x3aebc9(0x38c)](_0x5aefe8=>{const _0x562998=_0x3aebc9;if(!_0x5aefe8['isDirectory']()&&_0x5aefe8['name']['startsWith'](_0x562998(0x279))&&_0x5aefe8[_0x562998(0x2b4)][_0x562998(0x209)](_0x562998(0x390))){const _0xb5c8cb=formatDate(fs[_0x562998(0x2d2)](configbackuppath+_0x5aefe8['name'])[_0x562998(0x271)]);_0x1f7bc2[_0x562998(0x387)]({'name':_0x5aefe8['name'],'mtime':_0xb5c8cb});}});if(_0x555d11)io['to'](_0x555d11)[_0x3aebc9(0x37e)](_0x3aebc9(0x1d6),_0x1f7bc2);else return _0x1f7bc2;}async function backupConfigFiles(){const _0x1ca10b=_0x3b9479;await zipFiles('backup-full');const _0x3592ad=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x1ca10b(0x218),configbackuppath+(_0x1ca10b(0x279)+_0x3592ad+_0x1ca10b(0x390)));let _0xcbc2b8=fs[_0x1ca10b(0x2ec)](configbackuppath,{'withFileTypes':!![]});_0xcbc2b8['sort']((_0x21a22d,_0x8bb44e)=>_0x21a22d['name']<_0x8bb44e[_0x1ca10b(0x2b4)]?0x1:_0x8bb44e['name']<_0x21a22d[_0x1ca10b(0x2b4)]?-0x1:0x0),_0xcbc2b8[_0x1ca10b(0x357)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0xcbc2b8[maxBackups][_0x1ca10b(0x2b4)]);}function rotateLogFiles(){const _0x4cd614=_0x3b9479,_0x129b95=fs[_0x4cd614(0x2d2)](logspath+'output-000.log'),_0x13ec6c=_0x129b95['size']/0x400;if(_0x13ec6c>0x64){let _0x5a7d1e=fs[_0x4cd614(0x2ec)](logspath,{'withFileTypes':!![]});_0x5a7d1e[_0x4cd614(0x217)]((_0x5aac48,_0x2e23f8)=>_0x5aac48[_0x4cd614(0x2b4)]<_0x2e23f8[_0x4cd614(0x2b4)]?0x1:_0x2e23f8[_0x4cd614(0x2b4)]<_0x5aac48[_0x4cd614(0x2b4)]?-0x1:0x0),_0x5a7d1e['forEach'](_0x2483bf=>{const _0x1b5645=_0x4cd614;if(_0x2483bf['name']==_0x1b5645(0x303))fs[_0x1b5645(0x1cf)](logspath+_0x2483bf[_0x1b5645(0x2b4)],logspath+_0x1b5645(0x2cf));if(_0x2483bf[_0x1b5645(0x2b4)]=='output-001.log')fs[_0x1b5645(0x1cf)](logspath+_0x2483bf[_0x1b5645(0x2b4)],logspath+_0x1b5645(0x303));_0x2483bf['name']=='output-000.log'&&(fs[_0x1b5645(0x1cf)](logspath+_0x2483bf[_0x1b5645(0x2b4)],logspath+_0x1b5645(0x21c)),fs['writeFileSync'](logspath+_0x2483bf['name'],''));});}}async function zipFiles(_0x12d1d7){const _0x2069ff=_0x3b9479;let _0x1646e8;if(_0x12d1d7=='logs')_0x1646e8=logspath;if(_0x12d1d7=='backup')_0x1646e8=configpath;if(_0x12d1d7==_0x2069ff(0x1db))_0x1646e8=configpath;let _0x1a12c9=fs[_0x2069ff(0x2ec)](_0x1646e8,{'withFileTypes':!![]});const _0x5b56dd=new require(_0x2069ff(0x1eb))();_0x1a12c9[_0x2069ff(0x38c)](_0x48289d=>{const _0x55a766=_0x2069ff;if(!_0x48289d[_0x55a766(0x247)]()){let _0x3a930d=fs[_0x55a766(0x29e)](_0x1646e8+_0x48289d['name']);if(_0x12d1d7==_0x55a766(0x219)){const _0x5a213f=/^bot-[0-9]{3}-config.json$/,_0x388aee=_0x5a213f[_0x55a766(0x2e3)](_0x48289d[_0x55a766(0x2b4)]);if(_0x388aee){const _0x3403e0=JSON[_0x55a766(0x388)](_0x3a930d);if(_0x3403e0[_0x55a766(0x266)][0x0]){_0x3403e0[_0x55a766(0x266)][0x0][_0x55a766(0x22d)]=_0x55a766(0x33d),_0x3403e0[_0x55a766(0x266)][0x0][_0x55a766(0x30c)]='***';if(_0x3403e0[_0x55a766(0x266)][0x0][_0x55a766(0x25b)])_0x3403e0[_0x55a766(0x266)][0x0][_0x55a766(0x25b)]='***';}_0x3a930d=JSON[_0x55a766(0x32e)](_0x3403e0,null,0x2);}if(_0x48289d[_0x55a766(0x2b4)]==_0x55a766(0x27c)){const _0x44feff=JSON[_0x55a766(0x388)](_0x3a930d);if(_0x44feff[_0x55a766(0x225)][_0x55a766(0x234)])_0x44feff['settings']['loginRequired']=![];if(_0x44feff[_0x55a766(0x225)][_0x55a766(0x1fb)])_0x44feff[_0x55a766(0x225)][_0x55a766(0x1fb)]=_0x55a766(0x33d);if(_0x44feff[_0x55a766(0x225)]['telegramToken'])_0x44feff['settings'][_0x55a766(0x29d)]=_0x55a766(0x33d);if(_0x44feff[_0x55a766(0x225)][_0x55a766(0x1ef)])_0x44feff['settings'][_0x55a766(0x1ef)]=null;_0x3a930d=JSON[_0x55a766(0x32e)](_0x44feff,null,0x2);}if(_0x48289d[_0x55a766(0x2b4)]!=_0x55a766(0x28e))_0x5b56dd[_0x55a766(0x211)](_0x48289d[_0x55a766(0x2b4)],_0x3a930d);}else _0x5b56dd['file'](_0x48289d[_0x55a766(0x2b4)],_0x3a930d);}});const _0x436802=_0x5b56dd[_0x2069ff(0x313)]({'base64':![],'compression':_0x2069ff(0x31c)});fs[_0x2069ff(0x2e0)](zippath+(_0x12d1d7+_0x2069ff(0x390)),_0x436802,_0x2069ff(0x286));}async function unzipFile(_0x25c316,_0x37582d){const _0x207995=_0x3b9479;fs[_0x207995(0x2ec)](configpath,{'withFileTypes':!![]})[_0x207995(0x38c)](_0x30af58=>{const _0x4e48d9=_0x207995;if(!_0x30af58[_0x4e48d9(0x247)]())fs[_0x4e48d9(0x2f7)](configpath+_0x30af58[_0x4e48d9(0x2b4)]);});const _0x3ddca2=fs['readFileSync'](_0x25c316+_0x37582d,_0x207995(0x286)),_0x10c0ad=new require(_0x207995(0x1eb))(_0x3ddca2,{'base64':![],'checkCRC32':!![]});Object[_0x207995(0x312)](_0x10c0ad[_0x207995(0x281)])[_0x207995(0x38c)](_0x1c3367=>{const _0x34f36c=_0x207995,_0x551455=_0x10c0ad[_0x34f36c(0x281)][_0x1c3367];fs[_0x34f36c(0x2e0)](configpath+_0x551455[_0x34f36c(0x2b4)],_0x551455[_0x34f36c(0x347)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x207995(0x38c)](_0x201452=>{const _0x2f80b1=_0x207995;if(!_0x201452['isDirectory']())fs[_0x2f80b1(0x2f7)](temppath+_0x201452[_0x2f80b1(0x2b4)]);}),logger[_0x207995(0x1e5)](_0x207995(0x34d)),process[_0x207995(0x205)]({'restore':!![]},_0x17dbbe=>{});}async function getPublicIp(){const _0x1f5741=_0x3b9479;try{const _0x1f021f=await axios[_0x1f5741(0x342)]('https://api.ipify.org?format=json');publicip=_0x1f021f[_0x1f5741(0x252)]['ip'];}catch(_0x2befa7){}}async function triggerAnalytics(){const _0x59573d=_0x3b9479;if(!publicip)await getPublicIp();const _0x2f4b2d=getBotsWithMode();let _0x24fe8b=0x0;_0x2f4b2d[_0x59573d(0x38c)](_0x1657f8=>{if(_0x1657f8['status']==='enabled')_0x24fe8b++;});const _0x3283f8=getBotExchanges();mixpanel[_0x59573d(0x2c7)](_0x59573d(0x353),{'distinct_id':settings[_0x59573d(0x310)],'ip':publicip,'version':serverversion,'numbots':_0x2f4b2d[_0x59573d(0x357)],'numbotsenabled':_0x24fe8b,'exchanges':_0x3283f8});}async function getMessages(){const _0x1b9f9a=_0x3b9479,_0x44367f=_0x1b9f9a(0x2de),_0x582ceb=new GraphQLClient(_0x44367f),_0x28976a={'authorization':_0x1b9f9a(0x2ab)},_0x364541=serverversion['split']('.'),_0x430339=_0x364541[0x0]+'.'+_0x364541[0x1],_0x4fb18d=Math[_0x1b9f9a(0x371)](settings['lastmsgtelegram'],settings[_0x1b9f9a(0x280)]),_0xd37d4e={'last':parseInt(_0x4fb18d),'bbm':_0x430339},_0x143c65=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x24edc7;try{_0x24edc7=await _0x582ceb[_0x1b9f9a(0x2d9)](_0x143c65,_0xd37d4e,_0x28976a);}catch(_0x52cac4){}if(_0x24edc7&&_0x24edc7[_0x1b9f9a(0x23b)]){let _0x650192=settings[_0x1b9f9a(0x298)];newMessages=[];for(const _0x14205c of _0x24edc7[_0x1b9f9a(0x23b)]){newMessages['push'](_0x14205c);if(_0x14205c[_0x1b9f9a(0x2d8)])updateSetting(_0x1b9f9a(0x1da),_0x14205c['bbvNew']);let _0x5e621e=_0x14205c[_0x1b9f9a(0x2d8)]?serverversion>=_0x14205c[_0x1b9f9a(0x2d8)]:![];if(!_0x5e621e&&_0x14205c['number']>_0x650192){if(_0x14205c['bbvReceive']===_0x1b9f9a(0x3ad)||serverversion[_0x1b9f9a(0x294)](_0x14205c[_0x1b9f9a(0x3b2)])){let _0x1a7919=''+_0x14205c['title']+'\x0a\x0a'+_0x14205c['message'];const _0x192493=await sendTelegramMsg(toTelegramMarkdown(_0x1a7919),_0x1b9f9a(0x276));if(_0x192493)_0x650192=_0x14205c[_0x1b9f9a(0x287)];}}}updateAvailable=isNewerVersion(settings[_0x1b9f9a(0x1da)],serverversion),updateSetting(_0x1b9f9a(0x298),_0x650192),emitMessages();}}function emitMessages(){const _0x220271=_0x3b9479,_0x7220d5=settings[_0x220271(0x280)];let _0x4d973b=[];newMessages[_0x220271(0x38c)](_0x34b2c4=>{const _0x5bcc50=_0x220271;_0x34b2c4[_0x5bcc50(0x287)]>_0x7220d5&&_0x4d973b['push'](_0x34b2c4);}),_0x4d973b[_0x220271(0x357)]>0x0&&getAllClients()['forEach'](_0xf7c50e=>{const _0x40c3e0=_0x220271;getSocket(_0xf7c50e['id'])[_0x40c3e0(0x37e)]('message',_0x4d973b);});}function confirmMessage(_0x5cc458){const _0x23e7bc=_0x3b9479;updateSetting(_0x23e7bc(0x280),Number(_0x5cc458));}function isNewerVersion(_0x4d8a0f,_0x247ec8){const _0x407c80=_0x3b9479,_0x1f28b9=_0x247ec8['split']('.'),_0x4b61f7=_0x4d8a0f[_0x407c80(0x275)]('.');for(var _0x1ee0ff=0x0;_0x1ee0ff<_0x4b61f7[_0x407c80(0x357)];_0x1ee0ff++){const _0x2edc16=~~_0x4b61f7[_0x1ee0ff],_0x59ccb4=~~_0x1f28b9[_0x1ee0ff];if(_0x2edc16>_0x59ccb4)return!![];if(_0x2edc16<_0x59ccb4)return![];}return![];}function toTelegramMarkdown(_0x5803f7){const _0x5041c6=_0x3b9479,_0x45f338=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4acb34=/\*{2}(.+?)\*{2}/gim;return _0x5803f7=_0x5803f7[_0x5041c6(0x1f2)](_0x45f338,_0x5041c6(0x23e))[_0x5041c6(0x1f2)](_0x4acb34,'*$1*'),_0x5803f7;}async function validateConfigFile(){const _0x398f4b=_0x3b9479,_0x12e3f3=dbConfig[_0x398f4b(0x342)](_0x398f4b(0x369))[_0x398f4b(0x22f)](_0x398f4b(0x3a1))[_0x398f4b(0x3a8)]()||[];if(_0x12e3f3[_0x398f4b(0x357)]==0x0){let _0x562459=0x0,_0x16fbbd=[];const _0x504786=/^bot-([0-9]{3})-config.json$/,_0x5e95a2=fs['readdirSync'](configpath);_0x5e95a2['forEach'](_0x26bf10=>{const _0x544a9a=_0x398f4b,_0x3e99c3=_0x504786[_0x544a9a(0x1f1)](_0x26bf10);if(_0x3e99c3){const _0x3ab770=_0x3e99c3[0x1];let _0x16a243=getBotAttributes(_0x3ab770);_0x16fbbd[_0x544a9a(0x387)]({'botID':_0x3ab770,'botname':_0x16a243[_0x544a9a(0x28b)],'status':_0x544a9a(0x21b),'live':_0x544a9a(0x240)}),_0x562459++;}}),_0x562459!=0x0&&(dbConfig[_0x398f4b(0x342)](_0x398f4b(0x369))[_0x398f4b(0x231)](_0x16fbbd)[_0x398f4b(0x2e1)](),config=_0x16fbbd,restoredConfigFile=_0x562459);}}async function restoreConfigNotify(_0x4ba3ee){const _0x580b1d=_0x3b9479;let _0x5319f6;if(restoredConfigFile==0x1)_0x5319f6=_0x580b1d(0x1f8);else _0x5319f6='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x4ba3ee)io['to'](_0x580b1d(0x37a))[_0x580b1d(0x37e)](_0x580b1d(0x208),_0x5319f6);else{logger[_0x580b1d(0x301)](_0x580b1d(0x30a)),logger[_0x580b1d(0x301)](_0x5319f6),logger[_0x580b1d(0x301)](_0x580b1d(0x30a)),logger[_0x580b1d(0x301)]('');if(tgBot&&settings[_0x580b1d(0x1ef)]&&settings[_0x580b1d(0x232)]!=_0x580b1d(0x305))tgBot[_0x580b1d(0x376)](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x5319f6)[_0x580b1d(0x32a)](_0x52e29f=>{telegramError(_0x52e29f);});}}function validateCredentials(_0x5e4a1a,_0x3bd6c9){const _0xa961ef=_0x3b9479;if(_0x5e4a1a['username']==settings[_0xa961ef(0x2b7)]&&bcrypt['compareSync'](_0x5e4a1a[_0xa961ef(0x263)],settings[_0xa961ef(0x1fb)])){if(settings[_0xa961ef(0x33f)])return{'allow':![],'reason':_0xa961ef(0x1ed),'token':null};else{const _0x241f6d=generateLoginToken(_0x3bd6c9);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x241f6d};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x373792){const _0x56cd25=_0x3b9479,_0x162589=generateLoginToken(_0x373792);return{'allow':!![],'reason':_0x56cd25(0x331),'token':_0x162589};}function validateAccess(_0x8b3367,_0x5bdaa4,_0x2ace1b){const _0x5a6d9c=_0x3b9479,_0xdf3192=_0x2ace1b?_0x2ace1b:devices[_0x5bdaa4]['ip'];let _0x116821;const _0x58cf67=_0x55019b=>{const _0x3260ea=_0x4b9e;if(settings[_0x3260ea(0x234)]){if(settings[_0x3260ea(0x33f)]){if(telegram2FaApproved(_0x5bdaa4)){const _0x3b7add=generateLoginToken(_0x5bdaa4);return{'allow':!![],'reason':_0x3260ea(0x28a),'token':_0x3b7add};}else return{'allow':![],'reason':_0x3260ea(0x383),'token':null};}else return _0x116821=validToken(_0x55019b,_0x5bdaa4),_0x116821[_0x3260ea(0x259)](_0x3260ea(0x229))?{'allow':!![],'reason':_0x3260ea(0x3ae),'token':_0x55019b}:{'allow':![],'reason':_0x3260ea(0x383),'token':null};}else return{'allow':!![],'reason':_0x3260ea(0x1d9),'token':null};};if(settings[_0x5a6d9c(0x31d)]){let _0x3c422f=[...settings['whitelist'],_0x5a6d9c(0x3a6),'::ffff:127.0.0.1',_0x5a6d9c(0x31f)];if(_0x3c422f['includes'](_0xdf3192))return _0x58cf67(_0x8b3367);else{_0x116821=validToken(_0x8b3367,_0x5bdaa4);if(_0x116821[_0x5a6d9c(0x259)](_0x5a6d9c(0x229)))return _0x58cf67(_0x8b3367);else{if(telegramIpApproved(_0x5bdaa4)){const _0x45d3d0=generateToken(_0x5bdaa4);return _0x116821=_0x58cf67(_0x8b3367),_0x116821[_0x5a6d9c(0x2c2)]?{'allow':!![],'reason':_0x5a6d9c(0x33c),'token':_0x45d3d0}:_0x116821;}else return settings[_0x5a6d9c(0x351)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x5a6d9c(0x377),'token':null};}}}else return _0x58cf67(_0x8b3367);}function timelyDecrypt(_0x35bf00,_0x1a0c99=!![]){const _0x17815c=_0x3b9479;if(_0x35bf00)try{const _0x1aa425=crypt[_0x17815c(0x385)](secure[_0x17815c(0x27a)],_0x35bf00)['message'],_0x427129=_0x1aa425[_0x17815c(0x275)]('@')[0x0],_0xf774c8=_0x1aa425[_0x17815c(0x275)]('@')[0x1],_0x35c9c8=new Date()[_0x17815c(0x374)]();if(_0x1a0c99){if(_0x35c9c8-_0xf774c8<maxSecretAge*0x3e8)return _0x427129;else return![];}else return _0x427129;}catch(_0x561918){return![];}else return![];}const validToken=(_0x355efa,_0x4c6054)=>{const _0x1c9951=_0x3b9479,_0x302668=devices[_0x4c6054]['ip'];if(!_0x355efa)return{'error':_0x1c9951(0x2ad)};for(let _0x4ae431 of blacklist){if(_0x4ae431[_0x1c9951(0x270)]==_0x355efa)return{'error':_0x1c9951(0x2af)};}let _0xa215e3;try{_0xa215e3=jwt[_0x1c9951(0x222)](_0x355efa,secure[_0x1c9951(0x30f)]+_0x4c6054);}catch{return{'error':_0x1c9951(0x3a2)};}if(!_0xa215e3[_0x1c9951(0x259)](_0x1c9951(0x36e))&&!_0xa215e3[_0x1c9951(0x259)](_0x1c9951(0x2ee))||!_0xa215e3[_0x1c9951(0x259)](_0x1c9951(0x203)))return{'error':_0x1c9951(0x1d7)};if(!_0xa215e3[_0x1c9951(0x259)](_0x1c9951(0x2ee))&&_0xa215e3[_0x1c9951(0x259)](_0x1c9951(0x36e))){const {clientip:_0x26569e}=_0xa215e3;return _0x302668==_0x26569e?{'success':_0x1c9951(0x20e)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0xa215e3[_0x1c9951(0x259)](_0x1c9951(0x2ee))&&_0xa215e3[_0x1c9951(0x259)](_0x1c9951(0x36e))){const {username:_0x49a4fa,clientip:_0x482185}=_0xa215e3;return settings[_0x1c9951(0x2b7)]==_0x49a4fa&&_0x302668==_0x482185?{'success':_0x1c9951(0x20e)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x263d52=>{const _0x262fc0=_0x3b9479;if(_0x263d52){const _0x38f162=devices[_0x263d52]['ip'];return jwt[_0x262fc0(0x349)]({'username':settings[_0x262fc0(0x2b7)],'clientip':_0x38f162},secure[_0x262fc0(0x30f)]+_0x263d52,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x6dba21=>{const _0x5cf4d4=_0x3b9479;if(_0x6dba21){const _0x5dc3fb=devices[_0x6dba21]['ip'];return jwt['sign']({'clientip':_0x5dc3fb},secure[_0x5cf4d4(0x30f)]+_0x6dba21,{'expiresIn':devices[_0x6dba21][_0x5cf4d4(0x230)][_0x5cf4d4(0x34f)]*0x3c});}else return![];},telegramIpApproved=_0x35702b=>{const _0x4929ac=_0x3b9479;let _0x3b279d=![];return devices[_0x35702b][_0x4929ac(0x230)]&&devices[_0x35702b]['telegramIpApproval'][_0x4929ac(0x34f)]!=_0x4929ac(0x291)&&(_0x3b279d=devices[_0x35702b][_0x4929ac(0x230)]['clientip']==devices[_0x35702b]['ip']&&new Date()[_0x4929ac(0x374)]()-devices[_0x35702b][_0x4929ac(0x230)][_0x4929ac(0x2bb)]<devices[_0x35702b][_0x4929ac(0x230)][_0x4929ac(0x34f)]*0x3c*0x3e8),_0x3b279d;},telegram2FaApproved=_0x568f7d=>{const _0x43dc40=_0x3b9479;let _0x1bc24d=![];return devices[_0x568f7d][_0x43dc40(0x250)]&&devices[_0x568f7d]['telegram2FaApproval'][_0x43dc40(0x34f)]!=_0x43dc40(0x291)&&(_0x1bc24d=devices[_0x568f7d][_0x43dc40(0x250)][_0x43dc40(0x36e)]==devices[_0x568f7d]['ip']&&new Date()[_0x43dc40(0x374)]()-devices[_0x568f7d][_0x43dc40(0x250)]['timestamp']<devices[_0x568f7d]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x1bc24d;},normalizeIP=_0x393271=>{const _0x690f4d=_0x3b9479;let _0x433fec=null,_0x1efe19=null;if(ipaddr[_0x690f4d(0x1dc)](_0x393271)){const _0x4cfada=ipaddr[_0x690f4d(0x388)](_0x393271);_0x4cfada[_0x690f4d(0x307)]()===_0x690f4d(0x2fb)?(_0x4cfada[_0x690f4d(0x268)]()&&(_0x433fec=_0x4cfada[_0x690f4d(0x1f6)]()[_0x690f4d(0x213)]()),_0x1efe19=_0x4cfada[_0x690f4d(0x213)]()):(_0x433fec=_0x4cfada[_0x690f4d(0x213)](),_0x1efe19=_0x4cfada[_0x690f4d(0x2f2)]()[_0x690f4d(0x213)]());}return{'show':_0x433fec?_0x433fec:_0x1efe19,'store':_0x1efe19};};function formatDate(_0x59beb2){const _0x1290e0=_0x3b9479;return _0x59beb2['getFullYear']()+'/'+(_0x59beb2[_0x1290e0(0x3ab)]()+0x1)[_0x1290e0(0x213)]()['padStart'](0x2,'0')+'/'+_0x59beb2[_0x1290e0(0x2d4)]()[_0x1290e0(0x213)]()[_0x1290e0(0x1e7)](0x2,'0')+'\x20'+_0x59beb2['getHours']()[_0x1290e0(0x213)]()[_0x1290e0(0x1e7)](0x2,'0')+':'+_0x59beb2[_0x1290e0(0x33e)]()['toString']()[_0x1290e0(0x1e7)](0x2,'0')+':'+_0x59beb2[_0x1290e0(0x2c0)]()[_0x1290e0(0x213)]()['padStart'](0x2,'0');}function sleep(_0x10b305){return new Promise(_0x22ed73=>setTimeout(_0x22ed73,_0x10b305));}