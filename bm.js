const _0x3adbf5=_0x3608;(function(_0x26b2b1,_0x3383a3){const _0x1a7da3=_0x3608,_0x5a4d28=_0x26b2b1();while(!![]){try{const _0x11fa0b=parseInt(_0x1a7da3(0x155))/0x1+-parseInt(_0x1a7da3(0x11b))/0x2*(-parseInt(_0x1a7da3(0x19a))/0x3)+-parseInt(_0x1a7da3(0x1e5))/0x4*(parseInt(_0x1a7da3(0x1c7))/0x5)+-parseInt(_0x1a7da3(0xdb))/0x6+-parseInt(_0x1a7da3(0x1de))/0x7*(parseInt(_0x1a7da3(0x146))/0x8)+parseInt(_0x1a7da3(0x182))/0x9*(parseInt(_0x1a7da3(0x13e))/0xa)+parseInt(_0x1a7da3(0x282))/0xb*(parseInt(_0x1a7da3(0x227))/0xc);if(_0x11fa0b===_0x3383a3)break;else _0x5a4d28['push'](_0x5a4d28['shift']());}catch(_0x356353){_0x5a4d28['push'](_0x5a4d28['shift']());}}}(_0x3086,0xdeadf));const _0x80808d=function(){let _0x3b9ab4=!![];return function(_0x183501,_0x5416f4){const _0x51ac80=_0x3b9ab4?function(){const _0x2e9414=_0x3608;if(_0x5416f4){const _0x29cf46=_0x5416f4[_0x2e9414(0x284)](_0x183501,arguments);return _0x5416f4=null,_0x29cf46;}}:function(){};return _0x3b9ab4=![],_0x51ac80;};}(),_0x5b3828=_0x80808d(this,function(){const _0x45bae9=_0x3608;return _0x5b3828['toString']()[_0x45bae9(0x123)]('(((.+)+)+)+$')[_0x45bae9(0x236)]()[_0x45bae9(0x252)](_0x5b3828)['search'](_0x45bae9(0x29b));});_0x5b3828();'use strict';process[_0x3adbf5(0x16c)][_0x3adbf5(0xe5)]=0x1;const childProcess=require(_0x3adbf5(0x193)),fs=require('fs'),fns=require(_0x3adbf5(0x1d3)),low=require(_0x3adbf5(0x231)),FileSync=require(_0x3adbf5(0xe6)),path=require(_0x3adbf5(0x1f8)),crypto=require(_0x3adbf5(0x169)),Crypt=require(_0x3adbf5(0x202))[_0x3adbf5(0x26f)],RSA=require('hybrid-crypto-js')[_0x3adbf5(0x25c)],bcrypt=require(_0x3adbf5(0x29f)),jwt=require('jsonwebtoken'),ipaddr=require(_0x3adbf5(0xf5)),argv=require(_0x3adbf5(0x230))(process[_0x3adbf5(0x13d)][_0x3adbf5(0x25e)](0x2))[_0x3adbf5(0x13d)],uuidRandom=require(_0x3adbf5(0x1cf)),TelegramBot=require(_0x3adbf5(0x19f)),Mixpanel=require(_0x3adbf5(0x287)),axios=require(_0x3adbf5(0x22e)),{GraphQLClient,gql}=require(_0x3adbf5(0x15d)),util=require(_0x3adbf5(0xd1)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x3adbf5(0x28b)]||_0x3adbf5(0x15a),pattern=/^[0-9]{2,4}$/;!pattern[_0x3adbf5(0x1a0)](PORT)&&(console[_0x3adbf5(0x1df)](_0x3adbf5(0x286)+PORT+_0x3adbf5(0x292)),process[_0x3adbf5(0x11d)](0x1));const HOST=argv[_0x3adbf5(0xf1)]||null,userID=argv[_0x3adbf5(0x11f)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x3adbf5(0x154)],environment=require(_0x3adbf5(0x1c5))[_0x3adbf5(0x14a)]||_0x3adbf5(0x105);let bbpath=_0x3adbf5(0xfb),bbpath2='';const botfile=_0x3adbf5(0x24e),configfile=_0x3adbf5(0xee),settingsfile=_0x3adbf5(0x254),securefile='bb-secure.json',maxBackups=0xa;let validInstallation=!![];!fs[_0x3adbf5(0x16f)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3adbf5(0x263)),configpath=userID?bbpath+_0x3adbf5(0x21e)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x3adbf5(0x213),logspath=userID?bbpath+_0x3adbf5(0xe9)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x3adbf5(0x163)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x3adbf5(0x1e7)](logspath+_0x3adbf5(0x190),{'flags':'a'}),temppath=userID?bbpath+_0x3adbf5(0x1d8)+userID+'/':bbpath+_0x3adbf5(0x1d8);!fs[_0x3adbf5(0x16f)](configpath)&&fs[_0x3adbf5(0x285)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x3adbf5(0x285)](configbackuppath);!fs[_0x3adbf5(0x16f)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x3adbf5(0x16f)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x3adbf5(0x16f)](temppath)&&fs[_0x3adbf5(0x285)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x3adbf5(0x240)]({'bots':[]})[_0x3adbf5(0x10e)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3adbf5(0x240)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x3adbf5(0x157),'onepagemode':![]}})[_0x3adbf5(0x10e)]();function _0x3086(){const _0x2790ed=['telegram2FaApproval','express','No\x20bots\x20running\x20right\x20now','search','getHours','statSync','tkn','blacklist','stop','kill','backup-full@','userid','accept','callback_query','confirm-message','show','get','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','sort','telegram','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','exchange','::1','/on\x20-\x20start\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20get\x20messages','getDate','telegramToken','(staging)','access\x20timeout','argv','7315940Wuctju','botID','verify','output-000.log','#RES#\x20if\x20running\x20on\x20server','bbUsername','length','getMonth','558592oSeZXz','Unauthorized\x20attempt\x20to\x20download\x20','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','environment','timestamp','apiSecret','botmanager','https://api.ipify.org?format=json','\x1b[33m','auto','inherit','download','Login\x20accepted','node','685835GDnmUZ','/upload-backup','0.0.0','/disable\x20-\x20disable\x20notifications\x0a','Unauthorized\x20attempt\x20to\x20add\x20bot','3000','getFullYear','alerts','graphql-request','-results.json','uuid','api-eu.mixpanel.com','size','http','zip/',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','connection','format','full','Unauthorized\x20attempt\x20to\x20store\x20configuration','crypto','1000','password','env','parse','getUTCHours','existsSync','\x1b[36m','HTML','number','output-003.log','lastmsgtelegram','timeshift','Your\x20installation\x20is\x20already\x20up\x20to\x20date','/names\x20-\x20show\x20bot\x20names\x0a','\x20(2)','Alerts','store-settings','mtime','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','telegrammsg','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','latestversion','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','18HebTGV','login\x20token\x20generated','login\x20required','alias','All\x20bots','answerCallbackQuery','File\x20uploaded','Bot\x20Mgr\x20>\x20','handshake','Idling\x20bot\x20\x20\x20|\x20Bot\x20','store','push','stringify','Restarting\x20Bot\x20','/output-000.log','initclient','DEFLATE','child_process','logout','data','***','assign','/:bot/performance','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','69DBeSMN','login','writeFileSync','\x20to\x20','toggle-bot-mode','node-telegram-bot-api','test','emit','/:bot/configuration','Token\x20blacklisted','fork','status','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','file','internal','/:bot','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','login\x20not\x20required','hasOwnProperty','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','getSeconds','type','publicKey','place-order','Node.js\x20v','************','sortBy','404\x20Not\x20Found','socket.io','restore-backup-file','use','match','address','f2aRequired','debug','/status\x20-\x20show\x20bot(s)\x20status\x0a','backup-full','username','2FA\x20login\x20rejected','update-bot','getTime','bot-','reinstall-bb','./version.json','\x20|\x20user:\x20...','6816075yMknNl','SIGTERM','Starting\x20Balance\x20Bot\x20reinstallation','sendFile','bbPassword','\x20only\x0a','Network\x20Interfaces:','30\x20min','uuid-random','2FA','bots','post','date-fns','Invalid\x20Telegram\x20token','\x20(1)','ipc','order','temp/','2FA\x20login\x20token\x20generated','hex','sendMessage','#RES#\x20','storeFiat','119vZfcWq','log','once','pidRefreshToken','Unauthorized\x20attempt\x20to\x20delete\x20alerts','removeListener','Invalid\x20authentication\x20token\x20(1)','4MxlMkP','reinstall','createWriteStream','from','sha256','telegramUsername','get-messages','apiKey','/:bot/portfolio','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','readFileSync','secret','Deleted\x20Bot\x20','disabled','keys','init','add-bot','then','settings','path','/restart\x20-\x20restart\x20bot(s)\x0a','Invalid\x20IP\x20address','error','notification','ipv6','Unauthorized\x20attempt\x20to\x20update\x20bot','unlinkSync','token','\x20|\x20client:\x20...','hybrid-crypto-js','set','auth','telegramEnabled','node-zip','IPv4','Error\x20while\x20deleting\x20config\x20files:\x20','removeAllListeners','warning','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','min','reset-history','settings.','/:bot/support','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','rmSync','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','backup/','/update\x20-\x20update\x20Balance\x20Bot\x0a','access','Starting\x20new\x20bot\x20|\x20Bot\x20','delete-alerts','orders','Notifications\x20disabled\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Logged\x20in\x20user\x20...','15\x20min','Server','config/','::ffff:127.0.0.1','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','invalid\x20credentials','-config.json','cancel-loading','SIGINT','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','2FA\x20login\x20required','20808qMDNTO','onepagemode','randomFillSync','join','Yes','temporaryAccessAllowed','disconnect','axios','success','yargs/yargs','lowdb','pidExpireLogin','index.html','temporary\x20access\x20not\x20allowed','live','toString','Invalid\x20authentication\x20token\x20(2)','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','isDirectory','Enabled\x20Bot\x20','-----------------------------------------------------------------------------------','-performance.json','Ok,\x20will\x20send\x20order\x20notifications\x20only','$1_$2_$3','All\x20bots\x20running\x20right\x20now','defaults','binary','updatebotmanager','\x1b[31m','/enable\x20-\x20enable\x20notifications\x0a','RSA-OAEP','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','\x1b[35m','max','emitHistory','toggleBotMode','Bot\x20','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','bot.js','get-backup-files','showConfig','login\x20token\x20valid','constructor','headless','bb-settings.json','.zip','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Unauthorized\x20attempt\x20to\x20confirm\x20message','createServer','range','event','RSA','toIPv4MappedAddress','slice','headers','\x1b[0m','remoteAddress','kind','clients','No\x20authentication\x20token','Starting\x20Balance\x20Bot\x20update','server','allow','expiry','/:bot/coins','exp','showname','isValid','\x20minutes','split','Crypt','message','Logged\x20out\x20user\x20...','/download/:type','enabled','reject','reload','bbvNew','delete-bot','</b>\x20?','new-disabled','5\x20min','storeHeadless','remove','reset-password','Password\x20has\x20been\x20reset\x20to:\x20','sockets','=>\x20Go\x20to\x20#CYA#http://','Unauthorized\x20attempt\x20to\x20get\x20portfolio','5698qqauoa','build','apply','mkdirSync','Error:\x20Invalid\x20argument\x20','mixpanel','Backup\x20file\x20uploaded','backup','listen','port','/metrics\x20-\x20show\x20bot\x20performance\x0a','copyFileSync','telegramChatId','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','startsWith','Bot\x20Mgr\x20>\x20starting\x20all\x20bots',',\x20must\x20be\x20a\x204\x20digit\x20number','onText','\x20mode','update','static','stopped','Temporary\x20access\x20rejected','compareSync','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','(((.+)+)+)+$','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','temporary\x20access\x20rejected','Unauthorized\x20attempt\x20to\x20delete\x20bot','bcryptjs','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','\x1b[34m','Password\x20reset\x20rejected','logged\x20out','files','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','getMinutes','/off\x20-\x20stop\x20bot(s)\x0a','padStart','-events.json','socket','store-configuration','telegramIpApproval','isIPv4MappedAddress','storeConfiguration','telegramEvents','build2','Markdown','all','output-002.log','store-headless','running','Restore\x20process\x20aborted','messages','find','Starting\x20#RED#Balance\x20Bot\x20v','sendMetricsTelegram','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Backup\x20file\x20unzipped\x20and\x20stored','new','2FA\x20required','mode','yes','get-portfolio','bbvReceive','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','replace','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','util','decrypt','Orders','simple','\x20|\x20','Invalid\x20username\x20or\x20IP\x20address','\x20>\x20','get-logs','Unauthorized\x20attempt\x20to\x20show\x20configuration','Disabled\x20Bot\x20','2192808hfBByq','uncaughtException',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','string','privateKey','Access\x20enabled\x20for\x20','botname','send','User\x20has\x20been\x20validated','name','NTBA_FIX_319','lowdb/adapters/FileSync','function','reason','logs/','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','bot','lastmsgemitted','family','bb-config.json','apiPassword','filter','host','clientip','generateKeyPairAsync','loginRequired','ipaddr.js','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','value','Unauthorized\x20attempt\x20to\x20update\x20settings','manual','stopPolling','bb/','sendPortfolioTelegram','placeOrder','chat','forEach','encryptedUuid','Setting\x20access:\x20','get-starting-balances','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','connected','production','127.0.0.1','/:bot/history','readdirSync','sign','params','Restoring\x20bot(s)\x20from\x20backup','started','temporary\x20token\x20generated','write','resetHistory','request','staging','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','getStartingBalances','track','<b>Telegram\x20Bot\x20Status:</b>\x0a','hashSync','temporary\x20access\x20timeout','_data','any','secure','67874kmmVku','cancelLoading','exit','catch','user'];_0x3086=function(){return _0x2790ed;};return _0x3086();}const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x3adbf5(0x240)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x3adbf5(0x1e9),'rsaStandard':_0x3adbf5(0x245)});const saltRounds=0xa,mixpanel=Mixpanel[_0x3adbf5(0x1f4)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x3adbf5(0x160)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x3adbf5(0x13a)]&&settings[_0x3adbf5(0x13a)]!=''&&settings[_0x3adbf5(0x1ea)]&&settings[_0x3adbf5(0x1ea)]!='')initTelegram();const parseColor=(_0x439cea,_0x1f569c)=>{const _0x5abee6=_0x3adbf5,_0xd22dd8=/#[A-Z]{3}#/g;if(typeof _0x439cea==_0x5abee6(0xde)){!_0x1f569c?_0x439cea=_0x439cea[_0x5abee6(0xcf)](_0xd22dd8,''):(_0x439cea=_0x439cea[_0x5abee6(0xcf)](/#BLU#/g,_0x5abee6(0x2a1)),_0x439cea=_0x439cea[_0x5abee6(0xcf)](/#RED#/g,_0x5abee6(0x243)),_0x439cea=_0x439cea[_0x5abee6(0xcf)](/#YEL#/g,_0x5abee6(0x14f)),_0x439cea=_0x439cea[_0x5abee6(0xcf)](/#MAG#/g,_0x5abee6(0x248)),_0x439cea=_0x439cea[_0x5abee6(0xcf)](/#CYA#/g,_0x5abee6(0x170)),_0x439cea=_0x439cea[_0x5abee6(0xcf)](/#RES#/g,_0x5abee6(0x260)));;}return _0x439cea;},logger={'screen':_0x446ffa=>{console['log'](parseColor(_0x446ffa,!![]));},'simple':_0xffa4a4=>{const _0x47dd3d=_0x3adbf5;console[_0x47dd3d(0x1df)](parseColor(_0xffa4a4,!![])),loggerfile[_0x47dd3d(0x10e)](util[_0x47dd3d(0x166)](parseColor(_0xffa4a4,![]))+'\x0a');},'full':async _0x3c2319=>{const _0x160f4c=_0x3adbf5,_0x47e653=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x3c2319;console[_0x160f4c(0x1df)](parseColor(_0x47e653,!![])),loggerfile[_0x160f4c(0x10e)](util[_0x160f4c(0x166)](parseColor(_0x47e653,![]))+'\x0a');if(tgBot&&settings[_0x160f4c(0x28e)]&&settings[_0x160f4c(0x2af)]!=_0x160f4c(0x218))await tgBot['sendMessage'](settings[_0x160f4c(0x28e)],_0x160f4c(0x189)+parseColor(_0x3c2319,![]))['catch'](_0x5cb86b=>{telegramError(_0x5cb86b);});},'debug':async(_0x1ce248,_0x5b88db='')=>{const _0x502a68=_0x3adbf5,_0x2f3a83=getTimeStamp()+_0x502a68(0xdd)+_0x1ce248;if(debugging)console['log'](parseColor(_0x2f3a83,!![]));loggerfile['write'](util['format'](parseColor(_0x2f3a83,![]))+'\x0a');if(_0x5b88db){if(debugging)console['log'](_0x5b88db);loggerfile[_0x502a68(0x10e)](util['format'](_0x5b88db)+'\x0a');}}};process['on'](_0x3adbf5(0xdc),function(_0x3f1455){logger['simple'](_0x3f1455);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x3adbf5(0x121)),app=express(),http=require(_0x3adbf5(0x162))[_0x3adbf5(0x259)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x3adbf5(0x130)](_0x3adbf5(0x272),async(_0x33eeb4,_0xbec31f)=>{const _0x1df66c=_0x3adbf5,_0x4005e8=_0x33eeb4[_0x1df66c(0x10a)][_0x1df66c(0x1af)],_0x27c749=getClientsWithBotID('botmanager'),_0xe8fcba=_0x33eeb4[_0x1df66c(0x25f)][_0x1df66c(0x15f)],_0x4ef1e9=timelyDecrypt(_0xe8fcba,![]),_0x25280f=_0x27c749[_0x1df66c(0x2b8)](_0x2c0708=>_0x2c0708[_0x1df66c(0x15f)]==_0x4ef1e9);if(_0x25280f){const _0x1e53c5=normalizeIP(_0x33eeb4['socket']['remoteAddress'])[_0x1df66c(0x18c)],_0x3c7d93=_0x33eeb4[_0x1df66c(0x25f)][_0x1df66c(0x126)];if(validateAccess(_0x3c7d93,_0x4ef1e9,_0x1e53c5)[_0x1df66c(0x267)])_0x4005e8=='backup'&&await backupConfigFiles(),await zipFiles(_0x4005e8),_0xbec31f[_0x1df66c(0x152)](zippath+(_0x4005e8+_0x1df66c(0x255)),_0x414bf4=>{const _0x4501fb=_0x1df66c;_0x414bf4&&(logger[_0x4501fb(0x167)]('Failed\x20to\x20download\x20'+_0x4005e8),logger[_0x4501fb(0xd4)](_0x414bf4));});else logger[_0x1df66c(0x167)](_0x1df66c(0x147)+_0x4005e8+_0x1df66c(0x1d5));}else logger[_0x1df66c(0x167)](_0x1df66c(0x147)+_0x4005e8+_0x1df66c(0x178));}),app[_0x3adbf5(0x1d2)](_0x3adbf5(0x156),async(_0x48a260,_0x175bdc)=>{const _0x3feea1=_0x3adbf5,_0x301b57=getClientsWithBotID(_0x3feea1(0x14d)),_0x19ff97=_0x48a260[_0x3feea1(0x25f)][_0x3feea1(0x15f)],_0x2f709b=timelyDecrypt(_0x19ff97,![]),_0x5807a9=_0x301b57[_0x3feea1(0x2b8)](_0x3300a8=>_0x3300a8[_0x3feea1(0x15f)]==_0x2f709b);logger[_0x3feea1(0x1bc)](_0x3feea1(0x288));if(_0x5807a9){const _0x1853cf=normalizeIP(_0x48a260[_0x3feea1(0x2aa)][_0x3feea1(0x261)])[_0x3feea1(0x18c)],_0x56b421=_0x48a260[_0x3feea1(0x25f)][_0x3feea1(0x126)];if(validateAccess(_0x56b421,_0x2f709b,_0x1853cf)[_0x3feea1(0x267)]){if(_0x48a260[_0x3feea1(0x2a4)]){const _0x8caf49=_0x48a260[_0x3feea1(0x2a4)]['backupfile'];await _0x8caf49['mv'](temppath+_0x8caf49['name']),_0x175bdc[_0x3feea1(0xe2)]({'status':!![],'message':_0x3feea1(0x188)});const _0x37061b=getBotsWithMode();_0x37061b[_0x3feea1(0x144)]>0x0?confirmRestore(temppath,_0x8caf49[_0x3feea1(0xe4)]):unzipFile(temppath,_0x8caf49[_0x3feea1(0xe4)]);}}else logger[_0x3feea1(0x167)](_0x3feea1(0x148));}else logger[_0x3feea1(0x167)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x3adbf5(0x1b8)](express[_0x3adbf5(0x296)](path[_0x3adbf5(0x22a)](__dirname,bbpath2,_0x3adbf5(0x2b0)))),app[_0x3adbf5(0x1b8)](express[_0x3adbf5(0x296)](path['join'](__dirname,bbpath2,_0x3adbf5(0x283)))),app[_0x3adbf5(0x130)]('/',function(_0x54c024,_0x5a5b8a){const _0x471ee5=_0x3adbf5;_0x5a5b8a['sendFile'](path[_0x471ee5(0x22a)](__dirname,bbpath2,_0x471ee5(0x2b0),'index.html'));}),app['get'](_0x3adbf5(0x1a9),function(_0xf285b8,_0x550bcf){const _0x17674f=_0x3adbf5;_0x550bcf[_0x17674f(0x1ca)](path['join'](__dirname,bbpath2,_0x17674f(0x283),_0x17674f(0x233)));}),app[_0x3adbf5(0x130)](_0x3adbf5(0x1ed),(_0x4bfc13,_0x2278fc)=>{const _0x1d7512=_0x3adbf5;_0x2278fc['sendFile'](path[_0x1d7512(0x22a)](__dirname,bbpath2,_0x1d7512(0x283),'index.html'));}),app['get'](_0x3adbf5(0x198),(_0x3b03a1,_0x276559)=>{const _0xb159b7=_0x3adbf5;_0x276559['sendFile'](path[_0xb159b7(0x22a)](__dirname,bbpath2,_0xb159b7(0x283),'index.html'));}),app[_0x3adbf5(0x130)](_0x3adbf5(0x269),(_0x47662a,_0x1115e7)=>{const _0x57ab4d=_0x3adbf5;_0x1115e7[_0x57ab4d(0x1ca)](path['join'](__dirname,bbpath2,'build','index.html'));}),app[_0x3adbf5(0x130)](_0x3adbf5(0x107),(_0x3d1fab,_0x4b5021)=>{const _0x3c2953=_0x3adbf5;_0x4b5021[_0x3c2953(0x1ca)](path[_0x3c2953(0x22a)](__dirname,bbpath2,_0x3c2953(0x283),_0x3c2953(0x233)));}),app[_0x3adbf5(0x130)](_0x3adbf5(0x1a2),(_0x16ed11,_0x4965e7)=>{const _0x239a43=_0x3adbf5;_0x4965e7[_0x239a43(0x1ca)](path['join'](__dirname,bbpath2,_0x239a43(0x283),'index.html'));}),app[_0x3adbf5(0x130)](_0x3adbf5(0x20f),(_0x4f6d5e,_0x2a7618)=>{const _0x47dd84=_0x3adbf5;_0x2a7618[_0x47dd84(0x1ca)](path[_0x47dd84(0x22a)](__dirname,bbpath2,_0x47dd84(0x283),_0x47dd84(0x233)));});if(HOST)http[_0x3adbf5(0x28a)](PORT,HOST);else http['listen'](PORT);const io=require(_0x3adbf5(0x1b6))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1ede1d=_0x3adbf5;let _0x44fdf3='[ip-address]';const _0x442fe8=networkInterfaces(),_0x9afa37={};for(const _0x193e01 of Object[_0x1ede1d(0x1f3)](_0x442fe8)){for(const _0x3ea7fd of _0x442fe8[_0x193e01]){if((_0x3ea7fd[_0x1ede1d(0xed)]==_0x1ede1d(0x207)||_0x3ea7fd[_0x1ede1d(0xed)]==0x4)&&!_0x3ea7fd[_0x1ede1d(0x1a8)]){const _0x16d3b7=ipaddr[_0x1ede1d(0x16d)](_0x3ea7fd[_0x1ede1d(0x1ba)])[_0x1ede1d(0x25a)]();_0x16d3b7!='private'&&(!_0x9afa37[_0x193e01]&&(_0x9afa37[_0x193e01]=[]),_0x9afa37[_0x193e01][_0x1ede1d(0x18d)](_0x3ea7fd[_0x1ede1d(0x1ba)]),_0x44fdf3=_0x3ea7fd['address']);}}}return{'serverip':_0x44fdf3,'netinterfaces':_0x9afa37};}async function startServer(){const _0x16983d=_0x3adbf5,{serverip:_0x52c2a0,netinterfaces:_0x42a472}=getServerIP();logger['simple'](''),logger[_0x16983d(0xd4)]('-----------------------------------------------------------------------------------'),await logger[_0x16983d(0x167)](_0x16983d(0x2b9)+serverversion+_0x16983d(0x1dc)+(environment==_0x16983d(0x111)?_0x16983d(0x13b):'')+'\x0a'+(_0x16983d(0x256)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x16983d(0x280)+_0x52c2a0+':'+PORT+_0x16983d(0x142))),logger[_0x16983d(0xd4)]('-----------------------------------------------------------------------------------');if(config[_0x16983d(0x144)]!=0x0)for(const _0x5a5dec of config){if(_0x5a5dec[_0x16983d(0x1a5)]==_0x16983d(0x273)||_0x5a5dec['status']==_0x16983d(0x2bd))await logger[_0x16983d(0x167)]('Starting\x20bot\x20|\x20Bot\x20'+_0x5a5dec[_0x16983d(0x13f)]+_0x16983d(0xd5)+_0x5a5dec[_0x16983d(0xe1)]),startBot([_0x5a5dec[_0x16983d(0x13f)],userID],{'cwd':bbpath},function(_0x42aef9){if(_0x42aef9)logger['full'](_0x42aef9);});else(_0x5a5dec[_0x16983d(0x1a5)]=='disabled'||_0x5a5dec[_0x16983d(0x1a5)]==_0x16983d(0x279))&&await logger['full'](_0x16983d(0x18b)+_0x5a5dec[_0x16983d(0x13f)]+_0x16983d(0xd5)+_0x5a5dec[_0x16983d(0xe1)]);}else!newBot&&logger['simple'](_0x16983d(0x17f));if(newBot)addBot();logger[_0x16983d(0xd4)](_0x16983d(0x23b)),logger[_0x16983d(0xd4)](''),await logger[_0x16983d(0x1bc)](_0x16983d(0x1b2)+nodeversion),await logger[_0x16983d(0x1bc)](_0x16983d(0x1cd),_0x42a472);}function startSocket(){const _0x976d54=_0x3adbf5;io['on'](_0x976d54(0x165),_0x4bfee6=>{const _0x4cece0=_0x976d54;let _0x235842,_0x429d4c,_0x5a55d9,_0x43d194,_0x1dace8;const _0x1d887b=_0x4bfee6[_0x4cece0(0x18a)][_0x4cece0(0x25f)]['referer'];_0x429d4c=_0x1d887b[_0x4cece0(0x1b9)](/bot[0-9]{3}/);if(_0x429d4c)_0x5a55d9=_0x429d4c[0x0][_0x4cece0(0x1b9)](/[0-9]{3}/);if(_0x5a55d9)_0x235842=_0x5a55d9[0x0];else _0x235842=_0x4cece0(0x14d);const _0x1db6b2=_0x4bfee6[_0x4cece0(0x18a)][_0x4cece0(0x204)][_0x4cece0(0x100)];if(!_0x1db6b2)_0x4bfee6['emit'](_0x4cece0(0x1a5),{'publicKey':secure['publicKey']});else{_0x43d194=timelyDecrypt(_0x1db6b2,![]);if(!_0x43d194)_0x4bfee6[_0x4cece0(0x1a1)](_0x4cece0(0x1a5),{'publicKey':secure[_0x4cece0(0x1b0)]});else{_0x1dace8=normalizeIP(_0x4bfee6['conn'][_0x4cece0(0x261)])[_0x4cece0(0x18c)];if(!devices[_0x43d194])devices[_0x43d194]={'uuid':_0x43d194,'access':{'token':null}};devices[_0x43d194]['ip']=_0x1dace8;const _0x1817cd=addClient(_0x4bfee6['id'],_0x43d194,_0x235842);setAccess(_0x1817cd),emitMessages(),_0x4bfee6['on']('login',_0x2f851f=>{const _0x4c06d1=_0x4cece0,_0x4036ba=timelyDecrypt(_0x2f851f[_0x4c06d1(0x16b)]);if(_0x4036ba){_0x2f851f={'username':_0x2f851f[_0x4c06d1(0x1bf)],'password':_0x4036ba},devices[_0x43d194][_0x4c06d1(0x215)]=validateCredentials(_0x2f851f,_0x43d194);if(devices[_0x43d194][_0x4c06d1(0x215)][_0x4c06d1(0x267)]==![]&&devices[_0x43d194][_0x4c06d1(0x215)]['reason']==_0x4c06d1(0x226))_0x4bfee6[_0x4c06d1(0x1a1)](_0x4c06d1(0x1a5),{'access':devices[_0x43d194][_0x4c06d1(0x215)]}),loginAccess2FA(_0x43d194,_0x1dace8);else{if(devices[_0x43d194][_0x4c06d1(0x215)]['allow']==![]&&devices[_0x43d194]['access'][_0x4c06d1(0xe8)]==_0x4c06d1(0x221))_0x4bfee6[_0x4c06d1(0x1a1)]('status',{'access':devices[_0x43d194][_0x4c06d1(0x215)]});else devices[_0x43d194][_0x4c06d1(0x215)][_0x4c06d1(0x267)]&&devices[_0x43d194][_0x4c06d1(0x215)]['reason']==_0x4c06d1(0x183)&&(getClientsWithUuid(_0x43d194)[_0x4c06d1(0xff)](_0x2b3270=>{setAccess(_0x2b3270);}),logger[_0x4c06d1(0x1bc)](_0x4c06d1(0x21b)+_0x43d194[_0x4c06d1(0x25e)](-0x8)),setTokenRefresh(_0x43d194),setSessionTimeout(_0x4c06d1(0x19b),_0x43d194));}}else logger[_0x4c06d1(0x167)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x4bfee6['on'](_0x4cece0(0x27d),()=>{resetPassword();}),_0x4bfee6['on'](_0x4cece0(0x22d),_0x59b5a8=>{removeClient(_0x4bfee6['id']);}),_0x235842=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x146a52){const _0x48f917=_0x3adbf5;if(_0x146a52!=_0x48f917(0x14d)&&config[_0x48f917(0x1ec)]!=''){if(pid[_0x146a52])pid[_0x146a52][_0x48f917(0xe2)]({'function':_0x48f917(0x191),'args':null});}_0x146a52!=_0x48f917(0x14d)&&broadcastToBots(_0x48f917(0x1d1),JSON[_0x48f917(0x18e)](config));}function reloadBotManager(){getClientsWithBotID('botmanager')['forEach'](_0x13e48f=>{const _0x2d5144=_0x3608;getSocket(_0x13e48f['id'])['emit'](_0x2d5144(0x1a5),{'access':{'allow':![],'reason':_0x2d5144(0x275),'token':null}});});}function getSocket(_0x1c30a5){const _0x19c234=_0x3adbf5;return io[_0x19c234(0x27f)][_0x19c234(0x27f)][_0x19c234(0x130)](_0x1c30a5);}function setAccess(_0x1a5d43){const _0x4e9629=_0x3adbf5,_0x5c6615=getSocket(_0x1a5d43['id']),_0x3bfd60=_0x1a5d43['uuid'],_0xef36cf=_0x1a5d43['bot'];devices[_0x3bfd60][_0x4e9629(0x215)]=validateAccess(devices[_0x3bfd60][_0x4e9629(0x215)][_0x4e9629(0x200)],_0x3bfd60),logger[_0x4e9629(0x1bc)](_0x4e9629(0x101)+devices[_0x3bfd60]['access']['reason']+_0x4e9629(0x201)+_0x1a5d43['id'][_0x4e9629(0x25e)](-0x8)+_0x4e9629(0x1c6)+_0x3bfd60[_0x4e9629(0x25e)](-0x8)),_0x5c6615[_0x4e9629(0x22a)](_0x3bfd60);if(devices[_0x3bfd60][_0x4e9629(0x215)][_0x4e9629(0x267)]){_0x5c6615[_0x4e9629(0x22a)](_0xef36cf);if(_0xef36cf=='botmanager')initializeSocketBotManager(_0x5c6615);else initializeSocketBot(_0x5c6615);initClient(_0xef36cf);}devices[_0x3bfd60][_0x4e9629(0x215)][_0x4e9629(0x200)]&&devices[_0x3bfd60][_0x4e9629(0x215)][_0x4e9629(0xe8)]==_0x4e9629(0x10d)&&setSessionTimeout(_0x4e9629(0x1d0),_0x3bfd60),devices[_0x3bfd60][_0x4e9629(0x215)][_0x4e9629(0x200)]&&devices[_0x3bfd60][_0x4e9629(0x215)][_0x4e9629(0xe8)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x4e9629(0x19b),_0x3bfd60),_0x5c6615['emit'](_0x4e9629(0x1a5),{'status':_0x1a5d43[_0x4e9629(0x266)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3bfd60][_0x4e9629(0x215)],'externalip':devices[_0x3bfd60]['ip'],'publicKey':secure[_0x4e9629(0x1b0)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x3bfd60][_0x4e9629(0x215)]['allow']==![]&&devices[_0x3bfd60][_0x4e9629(0x215)][_0x4e9629(0xe8)]==_0x4e9629(0x2be)&&temporaryAccess2FA(_0x3bfd60,devices[_0x3bfd60]['ip']);}function setSessionTimeout(_0x182c47,_0x3deea6){const _0x4408da=_0x3adbf5;let _0x1a1747;if(_0x182c47==_0x4408da(0x19b))_0x1a1747=loginExpiry*0x3c*0x3e8;else _0x1a1747=devices[_0x3deea6][_0x4408da(0x2ac)][_0x4408da(0x268)]*0x3c*0x3e8-(new Date()[_0x4408da(0x1c2)]()-devices[_0x3deea6][_0x4408da(0x2ac)][_0x4408da(0x14b)]);if(devices[_0x3deea6]['pidExpireLogin'])clearTimeout(devices[_0x3deea6]['pidExpireLogin']);devices[_0x3deea6][_0x4408da(0x232)]=setTimeout(()=>{const _0x222aa4=_0x4408da;if(devices[_0x3deea6]['pidRefreshToken'])clearTimeout(devices[_0x3deea6]['pidRefreshToken']);removeSocketListeners(_0x3deea6),addBlacklist(_0x3deea6),devices[_0x3deea6]['telegramIpApproval']=null,devices[_0x3deea6][_0x222aa4(0x120)]=null,devices[_0x3deea6][_0x222aa4(0x215)][_0x222aa4(0x200)]=null,logger[_0x222aa4(0x1bc)]('Session\x20expired\x20for\x20user\x20...'+_0x3deea6[_0x222aa4(0x25e)](-0x8)),devices[_0x3deea6]['access']=validateAccess(devices[_0x3deea6][_0x222aa4(0x215)]['token'],_0x3deea6),!(devices[_0x3deea6]['access']['allow']&&devices[_0x3deea6][_0x222aa4(0x215)][_0x222aa4(0xe8)]=='login\x20not\x20required')&&(_0x182c47==_0x222aa4(0x19b)?io['to'](_0x3deea6)[_0x222aa4(0x1a1)](_0x222aa4(0x1a5),{'access':{'allow':![],'reason':_0x222aa4(0x13c),'token':null}}):io['to'](_0x3deea6)['emit']('status',{'access':{'allow':![],'reason':_0x222aa4(0x117),'token':null}})),devices[_0x3deea6][_0x222aa4(0x215)]['token']=null;},_0x1a1747);}function setTokenRefresh(_0x2305d3){const _0x1fe9dc=_0x3adbf5;if(devices[_0x2305d3][_0x1fe9dc(0x1e1)])clearTimeout(devices[_0x2305d3][_0x1fe9dc(0x1e1)]);devices[_0x2305d3][_0x1fe9dc(0x1e1)]=setTimeout(()=>{const _0x197e59=_0x1fe9dc;getClientsWithUuid(_0x2305d3)['length']!=0x0?(devices[_0x2305d3][_0x197e59(0x215)]=refreshToken(_0x2305d3),io['to'](_0x2305d3)[_0x197e59(0x1a1)](_0x197e59(0x1a5),{'status':_0x197e59(0x104),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2305d3][_0x197e59(0x215)],'externalip':devices[_0x2305d3]['ip'],'publicKey':secure[_0x197e59(0x1b0)],'validInstallation':validInstallation}),setTokenRefresh(_0x2305d3)):clearTimeout(devices[_0x2305d3]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x240305){const _0x318ae7=_0x3adbf5,_0x552806=getClient(_0x240305['id'])['uuid'];_0x240305[_0x318ae7(0x1a1)](_0x318ae7(0x1d1),config),_0x240305['emit'](_0x318ae7(0x1f7),cleanSettings()),_0x240305['on'](_0x318ae7(0x1f5),_0x5cc3bc=>{const _0x5ee622=_0x318ae7;if(validateAccess(_0x5cc3bc,_0x552806)[_0x5ee622(0x267)])addBot();else logger[_0x5ee622(0x167)](_0x5ee622(0x159));}),_0x240305['on'](_0x318ae7(0x1c1),(_0x5e40fb,_0x1931b3)=>{const _0x349ee3=_0x318ae7;if(validateAccess(_0x1931b3,_0x552806)[_0x349ee3(0x267)])toggleBot(_0x5e40fb['botID'],_0x5e40fb[_0x349ee3(0x1a5)],_0x5e40fb[_0x349ee3(0x235)]);else logger[_0x349ee3(0x167)](_0x349ee3(0x1fe));}),_0x240305['on'](_0x318ae7(0x19e),(_0x4314da,_0x3a6158)=>{const _0x3beffd=_0x318ae7;if(validateAccess(_0x3a6158,_0x552806)[_0x3beffd(0x267)])toggleBotMode(_0x4314da);else logger[_0x3beffd(0x167)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x240305['on'](_0x318ae7(0x277),(_0x238289,_0x45dcd7)=>{const _0x4e5ae9=_0x318ae7;if(validateAccess(_0x45dcd7,_0x552806)[_0x4e5ae9(0x267)])deleteBot(_0x238289);else logger['full'](_0x4e5ae9(0x29e));}),_0x240305['on'](_0x318ae7(0x17a),(_0x1b7641,_0x559a3d)=>{const _0x377083=_0x318ae7;if(validateAccess(_0x559a3d,_0x552806)[_0x377083(0x267)])storeSettings(_0x1b7641,!![]);else logger['full'](_0x377083(0xf8));}),_0x240305['on']('update-bb',_0x3802ab=>{const _0x50bc66=_0x318ae7;if(validateAccess(_0x3802ab,_0x552806)[_0x50bc66(0x267)])updateBB('update');else logger[_0x50bc66(0x167)](_0x50bc66(0x17d));}),_0x240305['on'](_0x318ae7(0x1c4),_0xef1529=>{const _0x748a04=_0x318ae7;if(validateAccess(_0xef1529,_0x552806)['allow'])updateBB(_0x748a04(0x1e6));else logger[_0x748a04(0x167)](_0x748a04(0xce));}),_0x240305['on'](_0x318ae7(0x24f),_0x247b53=>{const _0x107175=_0x318ae7;if(validateAccess(_0x247b53,_0x552806)[_0x107175(0x267)]){const _0x4314de=getClient(_0x240305['id']);if(_0x4314de)getBackupFiles(_0x4314de[_0x107175(0x15f)]);else logger[_0x107175(0x167)](_0x107175(0x238));}else logger[_0x107175(0x167)](_0x107175(0x1ad));}),_0x240305['on'](_0x318ae7(0x1b7),(_0x2cce6b,_0x115ee2)=>{const _0x343970=_0x318ae7;if(validateAccess(_0x115ee2,_0x552806)[_0x343970(0x267)])restoreBackupFile(_0x2cce6b);else logger[_0x343970(0x167)](_0x343970(0x134));}),_0x240305['on'](_0x318ae7(0x1eb),_0x25a55a=>{const _0x3f1fd7=_0x318ae7;if(validateAccess(_0x25a55a,_0x552806)[_0x3f1fd7(0x267)])getMessages();else logger[_0x3f1fd7(0x167)](_0x3f1fd7(0x138));}),_0x240305['on'](_0x318ae7(0x12e),(_0x58668e,_0x2f5f51)=>{const _0x5d58bc=_0x318ae7;if(validateAccess(_0x2f5f51,_0x552806)[_0x5d58bc(0x267)])confirmMessage(_0x58668e);else logger[_0x5d58bc(0x167)](_0x5d58bc(0x258));}),_0x240305['on'](_0x318ae7(0x194),_0x35f5b1=>{const _0x508e40=_0x318ae7;if(validateAccess(_0x35f5b1,_0x552806)[_0x508e40(0x267)]){if(devices[_0x552806]['pidRefreshToken'])clearTimeout(devices[_0x552806][_0x508e40(0x1e1)]);if(devices[_0x552806][_0x508e40(0x232)])clearTimeout(devices[_0x552806][_0x508e40(0x232)]);removeSocketListeners(getClient(_0x240305['id'])['uuid']),addBlacklist(_0x552806),devices[_0x552806][_0x508e40(0x2ac)]=null,devices[_0x552806][_0x508e40(0x120)]=null,devices[_0x552806][_0x508e40(0x215)][_0x508e40(0x200)]=null,logger[_0x508e40(0x1bc)](_0x508e40(0x271)+_0x552806['slice'](-0x8)),io['to'](getClient(_0x240305['id'])[_0x508e40(0x15f)])[_0x508e40(0x1a1)]('status',{'access':{'allow':![],'reason':_0x508e40(0x2a3),'token':null}});}else logger[_0x508e40(0x167)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x101c6d){const _0x861035=_0x3adbf5,_0x4afbfd=getClient(_0x101c6d['id'])[_0x861035(0xeb)],_0x469544=getClient(_0x101c6d['id'])['uuid'];_0x101c6d['on'](_0x861035(0xd8),(_0x41d4b4,_0x587bb3)=>{const _0x3f21f0=_0x861035;if(validateAccess(_0x587bb3,_0x469544)[_0x3f21f0(0x267)]){if(pid[_0x4afbfd])pid[_0x4afbfd][_0x3f21f0(0xe2)]({'function':_0x3f21f0(0x24a),'args':_0x41d4b4});}else logger[_0x3f21f0(0x167)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x101c6d['on'](_0x861035(0x217),(_0xdb6cf1,_0x26862c)=>{const _0x1d52c2=_0x861035;if(validateAccess(_0x26862c,_0x469544)[_0x1d52c2(0x267)]){if(pid[_0x4afbfd])pid[_0x4afbfd][_0x1d52c2(0xe2)]({'function':'deleteHistoryAlerts','args':_0xdb6cf1});}else logger[_0x1d52c2(0x167)](_0x1d52c2(0x1e2));}),_0x101c6d['on'](_0x861035(0x2c1),(_0x3243df,_0x23e4f2)=>{const _0x11cc0b=_0x861035;if(validateAccess(_0x23e4f2,_0x469544)[_0x11cc0b(0x267)]){if(pid[_0x4afbfd])pid[_0x4afbfd]['send']({'function':'getPortfolio','args':_0x3243df});}else logger[_0x11cc0b(0x167)](_0x11cc0b(0x281));}),_0x101c6d['on'](_0x861035(0x2ab),(_0x889db8,_0xf75d24)=>{const _0x4d8a27=_0x861035;if(validateAccess(_0xf75d24,_0x469544)[_0x4d8a27(0x267)]){if(pid[_0x4afbfd])pid[_0x4afbfd][_0x4d8a27(0xe2)]({'function':_0x4d8a27(0x2ae),'args':_0x889db8});}else logger[_0x4d8a27(0x167)](_0x4d8a27(0x168));}),_0x101c6d['on'](_0x861035(0x2b4),(_0x232d6c,_0x25f6dd)=>{const _0x1dff73=_0x861035;if(validateAccess(_0x25f6dd,_0x469544)[_0x1dff73(0x267)]){if(pid[_0x4afbfd])pid[_0x4afbfd][_0x1dff73(0xe2)]({'function':_0x1dff73(0x27b),'args':_0x232d6c});}else logger[_0x1dff73(0x167)](_0x1dff73(0xf6));}),_0x101c6d['on']('store-fiat',(_0x227d9e,_0x41d8bf)=>{const _0x327e50=_0x861035;if(validateAccess(_0x41d8bf,_0x469544)[_0x327e50(0x267)]){if(pid[_0x4afbfd])pid[_0x4afbfd][_0x327e50(0xe2)]({'function':_0x327e50(0x1dd),'args':_0x227d9e});}else logger[_0x327e50(0x167)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x101c6d['on'](_0x861035(0x20d),_0x5e691b=>{const _0x49de0f=_0x861035;if(validateAccess(_0x5e691b,_0x469544)[_0x49de0f(0x267)]){if(pid[_0x4afbfd])pid[_0x4afbfd][_0x49de0f(0xe2)]({'function':_0x49de0f(0x10f),'args':null});}else logger[_0x49de0f(0x167)](_0x49de0f(0x20b));}),_0x101c6d['on'](_0x861035(0x102),_0x55a79a=>{const _0x51252b=_0x861035;if(validateAccess(_0x55a79a,_0x469544)[_0x51252b(0x267)]){if(pid[_0x4afbfd])pid[_0x4afbfd]['send']({'function':_0x51252b(0x113),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x101c6d['on'](_0x861035(0x1b1),(_0x4d7aed,_0x482ad9)=>{const _0x32633d=_0x861035;if(validateAccess(_0x482ad9,_0x469544)[_0x32633d(0x267)]){if(pid[_0x4afbfd])pid[_0x4afbfd][_0x32633d(0xe2)]({'function':_0x32633d(0xfd),'args':_0x4d7aed});}else logger['full'](_0x32633d(0x220));}),_0x101c6d['on'](_0x861035(0x223),_0xb8a2e6=>{const _0x3b99cb=_0x861035;if(validateAccess(_0xb8a2e6,_0x469544)['allow']){if(pid[_0x4afbfd])pid[_0x4afbfd][_0x3b99cb(0xe2)]({'function':_0x3b99cb(0x11c),'args':null});}else logger[_0x3b99cb(0x167)](_0x3b99cb(0x181));}),_0x101c6d['on']('show-config',_0x278e79=>{const _0x5400a7=_0x861035;if(validateAccess(_0x278e79,_0x469544)[_0x5400a7(0x267)]){if(pid[_0x4afbfd])pid[_0x4afbfd][_0x5400a7(0xe2)]({'function':_0x5400a7(0x250),'args':null});}else logger[_0x5400a7(0x167)](_0x5400a7(0xd9));}),_0x101c6d['on']('update-bb',_0x163a7c=>{const _0x24fdb7=_0x861035;if(validateAccess(_0x163a7c,_0x469544)[_0x24fdb7(0x267)])updateBB(_0x24fdb7(0x295));else logger[_0x24fdb7(0x167)](_0x24fdb7(0x17d));}),_0x101c6d['on'](_0x861035(0x1eb),_0x621c10=>{const _0x341e33=_0x861035;if(validateAccess(_0x621c10,_0x469544)[_0x341e33(0x267)])getMessages();else logger[_0x341e33(0x167)](_0x341e33(0x138));}),_0x101c6d['on'](_0x861035(0x12e),(_0x207e91,_0x166d46)=>{const _0x47f310=_0x861035;if(validateAccess(_0x166d46,_0x469544)[_0x47f310(0x267)])confirmMessage(_0x207e91);else logger[_0x47f310(0x167)](_0x47f310(0x258));}),_0x101c6d['on'](_0x861035(0x194),_0x26aeab=>{const _0x6734de=_0x861035;if(validateAccess(_0x26aeab,_0x469544)['allow']){if(devices[_0x469544][_0x6734de(0x1e1)])clearTimeout(devices[_0x469544]['pidRefreshToken']);if(devices[_0x469544][_0x6734de(0x232)])clearTimeout(devices[_0x469544][_0x6734de(0x232)]);removeSocketListeners(getClient(_0x101c6d['id'])[_0x6734de(0x15f)]),addBlacklist(_0x469544),devices[_0x469544][_0x6734de(0x2ac)]=null,devices[_0x469544]['telegram2FaApproval']=null,devices[_0x469544][_0x6734de(0x215)][_0x6734de(0x200)]=null,logger[_0x6734de(0x1bc)](_0x6734de(0x271)+_0x469544[_0x6734de(0x25e)](-0x8)),io['to'](getClient(_0x101c6d['id'])[_0x6734de(0x15f)])[_0x6734de(0x1a1)](_0x6734de(0x1a5),{'access':{'allow':![],'reason':_0x6734de(0x2a3),'token':null}});}else logger[_0x6734de(0x167)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x1b595a){const _0x13ace7=_0x3adbf5;getClientsWithUuid(_0x1b595a)[_0x13ace7(0xff)](_0x12ec6d=>{const _0x5a4ab6=_0x13ace7;getSocket(_0x12ec6d['id'])[_0x5a4ab6(0x209)]();});}function cleanSettings(){const _0x2fffdc=_0x3adbf5;let _0x57c3a6=settings;return settings[_0x2fffdc(0x13a)]&&settings[_0x2fffdc(0x13a)]!=''&&(_0x57c3a6={..._0x57c3a6,'telegramToken':_0x2fffdc(0x1b3)}),settings['bbPassword']&&settings[_0x2fffdc(0x1cb)]!=''&&(_0x57c3a6={..._0x57c3a6,'bbPassword':_0x2fffdc(0x1b3)}),(settings[_0x2fffdc(0x1cb)]&&settings[_0x2fffdc(0x1cb)]==_0x2fffdc(0x196)||settings['telegramToken']&&settings[_0x2fffdc(0x13a)]=='***')&&(_0x57c3a6={..._0x57c3a6,'restored':{'password':settings['bbPassword']==_0x2fffdc(0x196),'telegram':settings[_0x2fffdc(0x13a)]==_0x2fffdc(0x196)}}),_0x57c3a6;}async function updateBB(_0x3113c2){const _0x15ab20=_0x3adbf5;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x49185e=>{restartBot(_0x49185e['botID']);});if(_0x3113c2==_0x15ab20(0x295))process['send']({'update':!![],'environment':environment},_0x2d5133=>{});else _0x3113c2=='reinstall'&&process[_0x15ab20(0xe2)]({'reinstall':!![],'environment':environment},_0x38cef8=>{});}function startBot(_0x4a1073,_0x2e2af6,_0x1cad9a){const _0x335afe=_0x3adbf5;if(debugging)_0x4a1073['push']('-d');let _0x44496b=![];const _0x52429f=_0x4a1073[0x0];_0x2e2af6={..._0x2e2af6,'stdio':['inherit',_0x335afe(0x151),_0x335afe(0x151),_0x335afe(0x1d6)]},pid[_0x52429f]=childProcess[_0x335afe(0x1a4)](botfile,_0x4a1073,_0x2e2af6),pid[_0x52429f]['on'](_0x335afe(0x270),_0xf730f3=>{const _0x4418d3=_0x335afe;switch(Object[_0x4418d3(0x1f3)](_0xf730f3)[0x0]){case _0x4418d3(0xe1):updateBotName(_0x52429f,_0xf730f3[_0x4418d3(0xe1)]);break;case _0x4418d3(0x242):updateBotManager();break;case'status':updateStatus(_0x52429f,_0xf730f3[_0x4418d3(0x1a5)]);break;case _0x4418d3(0x235):updateLive(_0x52429f,_0xf730f3['live']);break;case _0x4418d3(0x10c):updateLive(_0x52429f,_0xf730f3[_0x4418d3(0x10c)]),io['to'](_0x52429f)[_0x4418d3(0x1a1)](_0x4418d3(0x1a5),{'access':{'allow':![],'reason':_0x4418d3(0x275),'token':null}});break;case _0x4418d3(0x128):_0xf730f3[_0x4418d3(0x128)]=='restart'&&restartBot(_0x52429f);_0xf730f3['stop']=='kill'&&toggleBot(_0x52429f,'disabled',_0x4418d3(0x297));break;case _0x4418d3(0x133):sendTelegram(_0x52429f,_0xf730f3['telegram']);break;case _0x4418d3(0x17e):sendTelegramMsg(_0xf730f3[_0x4418d3(0x17e)]);break;case _0x4418d3(0xe7):io['to'](_0x52429f)[_0x4418d3(0x1a1)](_0xf730f3[_0x4418d3(0xe7)],_0xf730f3['args']);break;}}),pid[_0x52429f]['on'](_0x335afe(0x1fb),function(_0xe04d5a){if(_0x44496b)return;_0x44496b=!![],_0x1cad9a(_0xe04d5a);}),pid[_0x52429f]['on'](_0x335afe(0x11d),async function(_0x1acc62){const _0x74436d=_0x335afe;if(installingUpdate)return;if(_0x44496b)return;_0x44496b=!![],_0x1cad9a(null);const _0x422125=dbConfig[_0x74436d(0x130)](_0x74436d(0x1d1))['find']({'botID':_0x52429f})['value']();_0x422125&&(_0x422125[_0x74436d(0x1a5)]==_0x74436d(0x273)||_0x422125[_0x74436d(0x1a5)]==_0x74436d(0x2bd))&&(await sleep(0x3e8),updateLive(_0x52429f,'stopped'),logger[_0x74436d(0x167)](_0x74436d(0x18f)+_0x52429f),startBot([_0x52429f,userID],{'cwd':bbpath},function(_0x4a02ec){const _0x4da6ec=_0x74436d;if(_0x4a02ec)logger[_0x4da6ec(0x167)](_0x4a02ec);}));});}function stopBot(_0x4054ee){const _0x10aed3=_0x3adbf5;getClientsWithBotID(_0x4054ee)[_0x10aed3(0xff)](_0x1b4323=>{getSocket(_0x1b4323['id'])['disconnect'](!![]),removeClient(_0x1b4323['id']);}),pid[_0x4054ee]&&(pid[_0x4054ee][_0x10aed3(0x129)](),pid[_0x4054ee]=null);}function restartBot(_0x11e165){const _0x28392f=_0x3adbf5;if(pid[_0x11e165])pid[_0x11e165][_0x28392f(0x129)]();}function addBot(){const _0x81a801=_0x3adbf5;let _0x51c505;for(let _0x4a5ab2=0x1;_0x4a5ab2<0x3e9;_0x4a5ab2++){_0x51c505=_0x4a5ab2[_0x81a801(0x236)]()['padStart'](0x3,'0');let _0xcbe72c=config[_0x81a801(0x2b8)](_0x150f9d=>_0x150f9d[_0x81a801(0x13f)]==_0x51c505);if(!_0xcbe72c)break;}if(_0x51c505===_0x81a801(0x16a)){logger['full'](_0x81a801(0x247));return;}logger[_0x81a801(0x167)](_0x81a801(0x216)+_0x51c505),dbConfig['get'](_0x81a801(0x1d1))[_0x81a801(0x18d)]({'botID':_0x51c505,'botname':_0x81a801(0x24c)+_0x51c505,'status':_0x81a801(0x2bd),'live':''})['write'](),startBot([_0x51c505,userID],{'cwd':bbpath},function(_0x548012){const _0x4239bc=_0x81a801;if(_0x548012)logger[_0x4239bc(0x167)](_0x548012);}),config=getConfiguration(),io['to'](_0x81a801(0x14d))[_0x81a801(0x1a1)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function deleteBot(_0x4c89b5){const _0x3ab945=_0x3adbf5;getClientsWithBotID(_0x4c89b5)[_0x3ab945(0xff)](_0x44623b=>{const _0x207832=_0x3ab945;getSocket(_0x44623b['id'])[_0x207832(0x22d)](!![]),removeClient(_0x44623b['id']);}),dbConfig['get']('bots')['remove']({'botID':_0x4c89b5})[_0x3ab945(0x10e)](),logger[_0x3ab945(0x167)](_0x3ab945(0x1f1)+_0x4c89b5),stopBot(_0x4c89b5);try{if(fs[_0x3ab945(0x16f)](path[_0x3ab945(0x22a)](configpath,_0x3ab945(0x1c3)+_0x4c89b5+_0x3ab945(0x222))))fs['unlinkSync'](path[_0x3ab945(0x22a)](configpath,_0x3ab945(0x1c3)+_0x4c89b5+_0x3ab945(0x222)));if(fs[_0x3ab945(0x16f)](path[_0x3ab945(0x22a)](configpath,_0x3ab945(0x1c3)+_0x4c89b5+_0x3ab945(0x2a9))))fs[_0x3ab945(0x1ff)](path[_0x3ab945(0x22a)](configpath,_0x3ab945(0x1c3)+_0x4c89b5+_0x3ab945(0x2a9)));if(fs[_0x3ab945(0x16f)](path[_0x3ab945(0x22a)](configpath,_0x3ab945(0x1c3)+_0x4c89b5+_0x3ab945(0x23c))))fs[_0x3ab945(0x1ff)](path[_0x3ab945(0x22a)](configpath,'bot-'+_0x4c89b5+_0x3ab945(0x23c)));if(fs['existsSync'](path[_0x3ab945(0x22a)](configpath,'bot-'+_0x4c89b5+_0x3ab945(0x15e))))fs[_0x3ab945(0x1ff)](path[_0x3ab945(0x22a)](configpath,_0x3ab945(0x1c3)+_0x4c89b5+'-results.json'));}catch(_0x3f36aa){if(_0x3f36aa)logger['full'](_0x3ab945(0x208),_0x3f36aa);}config=getConfiguration(),io['to']('botmanager')[_0x3ab945(0x1a1)](_0x3ab945(0x1d1),config),broadcastToBots(_0x3ab945(0x1d1),JSON['stringify'](config));}function toggleBot(_0xe39ac4,_0x1d8d45,_0x4b1b60){const _0x3ab355=_0x3adbf5;dbConfig[_0x3ab355(0x130)](_0x3ab355(0x1d1))['find']({'botID':_0xe39ac4})['assign']({'status':_0x1d8d45})[_0x3ab355(0x197)]({'live':_0x4b1b60})['write']();if(_0x1d8d45=='enabled'||_0x1d8d45==_0x3ab355(0x2bd))logger['full'](_0x3ab355(0x23a)+_0xe39ac4),startBot([_0xe39ac4,userID],{'cwd':bbpath},function(_0x1bc2a1){if(_0x1bc2a1)logger['full'](_0x1bc2a1);});else(_0x1d8d45==_0x3ab355(0x1f2)||_0x1d8d45=='new-disabled')&&(logger[_0x3ab355(0x167)](_0x3ab355(0xda)+_0xe39ac4),stopBot(_0xe39ac4));config=getConfiguration(),io['to'](_0x3ab355(0x14d))[_0x3ab355(0x1a1)](_0x3ab355(0x1d1),config),broadcastToBots('bots',JSON[_0x3ab355(0x18e)](config));}function toggleStatus(_0x1425bf){const _0x359d92=_0x3adbf5;let _0x846348=dbConfig[_0x359d92(0x130)]('bots')[_0x359d92(0x2b8)]({'botID':_0x1425bf})[_0x359d92(0xf7)](),_0x4d9789;if(_0x846348[_0x359d92(0x1a5)]===_0x359d92(0x273))_0x4d9789=_0x359d92(0x1f2);else{if(_0x846348['status']===_0x359d92(0x2bd))_0x4d9789=_0x359d92(0x279);else{if(_0x846348[_0x359d92(0x1a5)]===_0x359d92(0x279))_0x4d9789=_0x359d92(0x2bd);else{if(_0x846348[_0x359d92(0x1a5)]===_0x359d92(0x1f2))_0x4d9789=_0x359d92(0x273);}}}return _0x4d9789;}function updateStatus(_0x52fd79,_0x4efa91){const _0x15f5d0=_0x3adbf5;dbConfig['get'](_0x15f5d0(0x1d1))[_0x15f5d0(0x2b8)]({'botID':_0x52fd79})[_0x15f5d0(0x197)]({'status':_0x4efa91})['write'](),config=getConfiguration(),io['to'](_0x15f5d0(0x14d))[_0x15f5d0(0x1a1)]('bots',config),broadcastToBots(_0x15f5d0(0x1d1),JSON[_0x15f5d0(0x18e)](config));}function updateLive(_0x3c4c2d,_0x33cbe6){const _0x4090df=_0x3adbf5;dbConfig['get'](_0x4090df(0x1d1))[_0x4090df(0x2b8)]({'botID':_0x3c4c2d})[_0x4090df(0x197)]({'live':_0x33cbe6})[_0x4090df(0x10e)](),config=getConfiguration(),io['to']('botmanager')[_0x4090df(0x1a1)](_0x4090df(0x1d1),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotName(_0x432adf,_0x347f6f){const _0x57caf2=_0x3adbf5;dbConfig[_0x57caf2(0x130)](_0x57caf2(0x1d1))['find']({'botID':_0x432adf})[_0x57caf2(0x197)]({'botname':_0x347f6f})['write'](),config=getConfiguration(),io['to'](_0x57caf2(0x14d))[_0x57caf2(0x1a1)](_0x57caf2(0x1d1),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0x1f7a0c=_0x3adbf5;config=getConfiguration(),io['to'](_0x1f7a0c(0x14d))[_0x1f7a0c(0x1a1)](_0x1f7a0c(0x1d1),config),broadcastToBots(_0x1f7a0c(0x1d1),JSON[_0x1f7a0c(0x18e)](config));}function toggleBotMode(_0x171123){const _0x36b7a4=_0x3adbf5;if(pid[_0x171123])pid[_0x171123]['send']({'function':_0x36b7a4(0x24b),'args':null});else{const _0x4d3d7e=configpath+_0x36b7a4(0x1c3)+_0x171123+_0x36b7a4(0x222),_0xb307bf=fs['readFileSync'](_0x4d3d7e),_0x5192f5=JSON[_0x36b7a4(0x16d)](_0xb307bf),_0x35b873=_0x5192f5['bot'][0x0]['headless'];_0x5192f5[_0x36b7a4(0xeb)][0x0][_0x36b7a4(0x253)]=!_0x35b873;const _0x37d2da=JSON[_0x36b7a4(0x18e)](_0x5192f5,null,0x2);fs[_0x36b7a4(0x19c)](_0x4d3d7e,_0x37d2da),config=getConfiguration(),io['to'](_0x36b7a4(0x14d))['emit'](_0x36b7a4(0x1d1),config),broadcastToBots('bots',JSON[_0x36b7a4(0x18e)](config));}}function telegramError(_0x1543d7){const _0x5bf384=_0x3adbf5;logger[_0x5bf384(0xd4)](getTimeStamp()+_0x5bf384(0x164));}function validateTelegram(_0x4d80b7){const _0x4f85da=_0x3adbf5;if(_0x4d80b7[_0x4f85da(0x1e8)][_0x4f85da(0x1bf)]!=settings[_0x4f85da(0x1ea)]&&'@'+_0x4d80b7[_0x4f85da(0x1e8)][_0x4f85da(0x1bf)]!=settings['telegramUsername'])return tgBot[_0x4f85da(0x1db)](_0x4d80b7[_0x4f85da(0xfe)]['id'],_0x4f85da(0xea),{'parse_mode':_0x4f85da(0x171)})[_0x4f85da(0x11e)](_0x1f3952=>{telegramError(_0x1f3952);}),![];return!![];}async function initTelegram(){const _0x1c278c=_0x3adbf5;if(tgBot)tgBot[_0x1c278c(0xfa)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x1c278c(0x13a)],{'polling':!![]});let _0x3d88b0='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x3d88b0+='\x0a',_0x3d88b0+=_0x1c278c(0x244),_0x3d88b0+=_0x1c278c(0x158),_0x3d88b0+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x3d88b0+=_0x1c278c(0x1f9),_0x3d88b0+=_0x1c278c(0x137),_0x3d88b0+=_0x1c278c(0x2a7),_0x3d88b0+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x3d88b0+=_0x1c278c(0x177),_0x3d88b0+=_0x1c278c(0x1bd),_0x3d88b0+=_0x1c278c(0x28c),_0x3d88b0+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x3d88b0+=_0x1c278c(0x214),_0x3d88b0+=_0x1c278c(0x1aa),_0x3d88b0+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x379798=_0x1c278c(0x212);_0x379798+='\x0a',_0x379798+=_0x3d88b0,tgBot['onText'](/\/start/,_0x2114df=>{const _0x2ff1dd=_0x1c278c;if(!validateTelegram(_0x2114df))return;if(settings[_0x2ff1dd(0x28e)]!=_0x2114df[_0x2ff1dd(0xfe)]['id'])updateSetting(_0x2ff1dd(0x28e),_0x2114df[_0x2ff1dd(0xfe)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x2ff1dd(0x1db)](_0x2114df[_0x2ff1dd(0xfe)]['id'],_0x379798)[_0x2ff1dd(0x11e)](_0x347c3a=>{telegramError(_0x347c3a);});}),tgBot[_0x1c278c(0x293)](/\/enable/,_0x3af26e=>{const _0x3e41b9=_0x1c278c;if(!validateTelegram(_0x3af26e))return;if(settings[_0x3e41b9(0x28e)]!=_0x3af26e[_0x3e41b9(0xfe)]['id'])updateSetting('telegramChatId',_0x3af26e[_0x3e41b9(0xfe)]['id']);updateSetting(_0x3e41b9(0x205),!![]),tgBot[_0x3e41b9(0x1db)](_0x3af26e['chat']['id'],'Notifications\x20enabled')[_0x3e41b9(0x11e)](_0x18e33e=>{telegramError(_0x18e33e);});}),tgBot['onText'](/\/config/,async _0x488f3f=>{const _0xead1c0=_0x1c278c;if(!validateTelegram(_0x488f3f))return;tgBot['removeListener'](_0xead1c0(0x12d)),tgBot[_0xead1c0(0x1db)](_0x488f3f['chat']['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0xead1c0(0xd3),'callback_data':'orders'},{'text':_0xead1c0(0x179),'callback_data':_0xead1c0(0x15c)},{'text':'All','callback_data':_0xead1c0(0x2b2)}]]}})[_0xead1c0(0x11e)](_0x37344c=>{telegramError(_0x37344c);}),tgBot['on'](_0xead1c0(0x12d),async _0x169f96=>{const _0x608022=_0xead1c0,_0x1ae3ae=_0x169f96[_0x608022(0x195)],_0x238bd0=_0x169f96[_0x608022(0x270)];tgBot['answerCallbackQuery'](_0x169f96['id'])[_0x608022(0x1f6)](async()=>{const _0x226811=_0x608022;_0x1ae3ae==_0x226811(0x218)&&(updateSetting(_0x226811(0x2af),_0x226811(0x218)),updateSetting(_0x226811(0x205),!![]),await tgBot[_0x226811(0x1db)](_0x238bd0[_0x226811(0xfe)]['id'],_0x226811(0x23d))[_0x226811(0x11e)](_0x78db36=>{telegramError(_0x78db36);}));_0x1ae3ae==_0x226811(0x15c)&&(updateSetting('telegramEvents',_0x226811(0x15c)),updateSetting('telegramEnabled',!![]),await tgBot[_0x226811(0x1db)](_0x238bd0[_0x226811(0xfe)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x226811(0x11e)](_0x44392f=>{telegramError(_0x44392f);}));_0x1ae3ae==_0x226811(0x2b2)&&(updateSetting(_0x226811(0x2af),_0x226811(0x2b2)),updateSetting(_0x226811(0x205),!![]),await tgBot[_0x226811(0x1db)](_0x238bd0[_0x226811(0xfe)]['id'],_0x226811(0x1a6))[_0x226811(0x11e)](_0x75e72b=>{telegramError(_0x75e72b);}));if(!settings[_0x226811(0x28e)])tgBot['sendMessage'](_0x238bd0['chat']['id'],_0x226811(0x149))['catch'](_0x2731a3=>{telegramError(_0x2731a3);});}),tgBot[_0x608022(0x1e3)](_0x608022(0x12d));});}),tgBot[_0x1c278c(0x293)](/\/status/,_0x1e58d3=>{const _0x21e039=_0x1c278c;if(!validateTelegram(_0x1e58d3))return;const _0x5e5e6a=getBotsWithMode();let _0x5ab210='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x21e039(0xff)](_0x118f9c=>{const _0x40b9b7=_0x21e039,_0x2334ea=_0x5e5e6a[_0x40b9b7(0x2b8)](_0x2d093a=>_0x2d093a[_0x40b9b7(0x13f)]==_0x118f9c[_0x40b9b7(0x13f)])[_0x40b9b7(0x2bf)];_0x5ab210+=_0x40b9b7(0x24c)+_0x118f9c[_0x40b9b7(0x13f)]+':\x20'+_0x118f9c[_0x40b9b7(0x1a5)]+_0x40b9b7(0xd5)+_0x2334ea+_0x40b9b7(0xd5)+_0x118f9c[_0x40b9b7(0x235)]+'\x0a';}),_0x5ab210+='\x0a',_0x5ab210+=_0x21e039(0x115),_0x5ab210+=!settings[_0x21e039(0x205)]?_0x21e039(0x219):'Notifications\x20enabled\x0a',_0x5ab210+=settings[_0x21e039(0x205)]?settings[_0x21e039(0x2af)]=='all'?_0x21e039(0x29a):'Notifications\x20types:\x20'+settings[_0x21e039(0x2af)]+_0x21e039(0x1cc):'',tgBot[_0x21e039(0x1db)](_0x1e58d3[_0x21e039(0xfe)]['id'],_0x5ab210,{'parse_mode':_0x21e039(0x171)})[_0x21e039(0x11e)](_0x42403d=>{telegramError(_0x42403d);});}),tgBot[_0x1c278c(0x293)](/\/restart/,_0x22565b=>{const _0x3b7944=_0x1c278c;if(!validateTelegram(_0x22565b))return;tgBot[_0x3b7944(0x1e3)](_0x3b7944(0x12d));const _0x348c5e=getEnabledBots();if(_0x348c5e[_0x3b7944(0x144)]==0x0)tgBot[_0x3b7944(0x1db)](_0x22565b[_0x3b7944(0xfe)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x3b7944(0x11e)](_0x2732d2=>{telegramError(_0x2732d2);});else{if(_0x348c5e[_0x3b7944(0x144)]>0x1)_0x348c5e['push']({'botID':_0x3b7944(0x2b2)});let _0xcb92ec=[],_0xf74ece=[];const _0x413f94=_0x348c5e[_0x3b7944(0x144)]%0x4==0x0||_0x348c5e['length']%0x4==0x3||_0x348c5e['length']%0x3==0x1?0x4:0x3;let _0x5e4a37=0x0;_0x348c5e[_0x3b7944(0xff)]((_0x1054aa,_0x1faf31)=>{const _0x1580bd=_0x3b7944;if(_0x1faf31%_0x413f94==0x0)_0xf74ece=[];_0xf74ece[_0x1580bd(0x18d)]({'text':_0x1054aa[_0x1580bd(0x13f)]==_0x1580bd(0x2b2)?_0x1580bd(0x186):_0x1580bd(0x24c)+_0x1054aa[_0x1580bd(0x13f)],'callback_data':_0x1054aa[_0x1580bd(0x13f)]}),_0x1faf31%_0x413f94==0x0&&(_0xcb92ec[_0x5e4a37]=_0xf74ece,_0x5e4a37++);}),tgBot['sendMessage'](_0x22565b[_0x3b7944(0xfe)]['id'],_0x3b7944(0x225),{'reply_markup':{'inline_keyboard':_0xcb92ec}})['catch'](_0x2076d8=>{telegramError(_0x2076d8);}),tgBot['on']('callback_query',async _0x372615=>{const _0x241555=_0x3b7944,_0x2365f4=_0x372615[_0x241555(0x195)],_0x67ff5f=_0x372615[_0x241555(0x270)];tgBot[_0x241555(0x187)](_0x372615['id'])[_0x241555(0x1f6)](async()=>{const _0x40928b=_0x241555;_0x2365f4==_0x40928b(0x2b2)?config[_0x40928b(0xff)](_0x48e63e=>{const _0x23cf83=_0x40928b;restartBot(_0x48e63e[_0x23cf83(0x13f)]);}):restartBot(_0x2365f4);}),tgBot[_0x241555(0x1e3)](_0x241555(0x12d));});}}),tgBot[_0x1c278c(0x293)](/\/on/,_0x555224=>{const _0x601734=_0x1c278c;if(!validateTelegram(_0x555224))return;tgBot[_0x601734(0x1e3)]('callback_query');const _0x1b1ab9=getDisabledBots();if(_0x1b1ab9['length']==0x0)tgBot[_0x601734(0x1db)](_0x555224['chat']['id'],_0x601734(0x23f))['catch'](_0x3a7068=>{telegramError(_0x3a7068);});else{if(_0x1b1ab9[_0x601734(0x144)]>0x1)_0x1b1ab9[_0x601734(0x18d)]({'botID':_0x601734(0x2b2)});let _0x4d722d=[],_0x450aa1=[];const _0x26580e=_0x1b1ab9[_0x601734(0x144)]%0x4==0x0||_0x1b1ab9[_0x601734(0x144)]%0x4==0x3||_0x1b1ab9[_0x601734(0x144)]%0x3==0x1?0x4:0x3;let _0x5a3c1d=0x0;_0x1b1ab9['forEach']((_0x4b16f9,_0x290770)=>{const _0x25b1c5=_0x601734;if(_0x290770%_0x26580e==0x0)_0x450aa1=[];_0x450aa1[_0x25b1c5(0x18d)]({'text':_0x4b16f9['botID']==_0x25b1c5(0x2b2)?'All\x20bots':_0x25b1c5(0x24c)+_0x4b16f9['botID'],'callback_data':_0x4b16f9['botID']}),_0x290770%_0x26580e==0x0&&(_0x4d722d[_0x5a3c1d]=_0x450aa1,_0x5a3c1d++);}),tgBot[_0x601734(0x1db)](_0x555224[_0x601734(0xfe)]['id'],_0x601734(0x2a5),{'reply_markup':{'inline_keyboard':_0x4d722d}})[_0x601734(0x11e)](_0x250758=>{telegramError(_0x250758);}),tgBot['on'](_0x601734(0x12d),async _0xec95fb=>{const _0x31a134=_0x601734,_0xf093bc=_0xec95fb[_0x31a134(0x195)],_0x18e66c=_0xec95fb['message'];tgBot[_0x31a134(0x187)](_0xec95fb['id'])[_0x31a134(0x1f6)](async()=>{const _0x15e0f3=_0x31a134;_0xf093bc=='all'?(tgBot[_0x15e0f3(0x1db)](_0x18e66c[_0x15e0f3(0xfe)]['id'],_0x15e0f3(0x291))[_0x15e0f3(0x11e)](_0x39c4c6=>{telegramError(_0x39c4c6);}),_0x1b1ab9[_0x15e0f3(0xff)](_0x2c200d=>{const _0xdc009f=_0x15e0f3;if(_0x2c200d[_0xdc009f(0x13f)]!='all')toggleBot(_0x2c200d[_0xdc009f(0x13f)],toggleStatus(_0x2c200d[_0xdc009f(0x13f)]),_0xdc009f(0x297));})):(tgBot[_0x15e0f3(0x1db)](_0x18e66c[_0x15e0f3(0xfe)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0xf093bc)[_0x15e0f3(0x11e)](_0x1a29fd=>{telegramError(_0x1a29fd);}),toggleBot(_0xf093bc,toggleStatus(_0xf093bc),_0x15e0f3(0x297)));}),tgBot[_0x31a134(0x1e3)]('callback_query');});}}),tgBot['onText'](/\/off/,_0x362153=>{const _0x267495=_0x1c278c;if(!validateTelegram(_0x362153))return;tgBot[_0x267495(0x1e3)]('callback_query');const _0x2081c1=getEnabledBots();if(_0x2081c1['length']==0x0)tgBot['sendMessage'](_0x362153[_0x267495(0xfe)]['id'],_0x267495(0x122))[_0x267495(0x11e)](_0x2be4d3=>{telegramError(_0x2be4d3);});else{if(_0x2081c1['length']>0x1)_0x2081c1['push']({'botID':'all'});let _0xf9991=[],_0x362f8d=[];const _0x455a7b=_0x2081c1['length']%0x4==0x0||_0x2081c1[_0x267495(0x144)]%0x4==0x3||_0x2081c1[_0x267495(0x144)]%0x3==0x1?0x4:0x3;let _0x8f4a40=0x0;_0x2081c1[_0x267495(0xff)]((_0x157044,_0x27de5d)=>{const _0x4618df=_0x267495;if(_0x27de5d%_0x455a7b==0x0)_0x362f8d=[];_0x362f8d[_0x4618df(0x18d)]({'text':_0x157044[_0x4618df(0x13f)]=='all'?_0x4618df(0x186):_0x4618df(0x24c)+_0x157044[_0x4618df(0x13f)],'callback_data':_0x157044['botID']}),_0x27de5d%_0x455a7b==0x0&&(_0xf9991[_0x8f4a40]=_0x362f8d,_0x8f4a40++);}),tgBot[_0x267495(0x1db)](_0x362153[_0x267495(0xfe)]['id'],_0x267495(0x257),{'reply_markup':{'inline_keyboard':_0xf9991}})['catch'](_0x16e5da=>{telegramError(_0x16e5da);}),tgBot['on'](_0x267495(0x12d),async _0x47ce9b=>{const _0x41c6ce=_0x267495,_0x5cd1af=_0x47ce9b[_0x41c6ce(0x195)],_0x2962cc=_0x47ce9b['message'];tgBot[_0x41c6ce(0x187)](_0x47ce9b['id'])[_0x41c6ce(0x1f6)](async()=>{const _0xc2396a=_0x41c6ce;_0x5cd1af==_0xc2396a(0x2b2)?(tgBot['sendMessage'](_0x2962cc[_0xc2396a(0xfe)]['id'],_0xc2396a(0x2bb))[_0xc2396a(0x11e)](_0x2e1388=>{telegramError(_0x2e1388);}),_0x2081c1[_0xc2396a(0xff)](_0x1438e9=>{const _0x41f8da=_0xc2396a;if(_0x1438e9[_0x41f8da(0x13f)]!=_0x41f8da(0x2b2))toggleBot(_0x1438e9[_0x41f8da(0x13f)],toggleStatus(_0x1438e9[_0x41f8da(0x13f)]),_0x41f8da(0x297));})):(tgBot['sendMessage'](_0x2962cc[_0xc2396a(0xfe)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x5cd1af)[_0xc2396a(0x11e)](_0x2b8142=>{telegramError(_0x2b8142);}),toggleBot(_0x5cd1af,toggleStatus(_0x5cd1af),_0xc2396a(0x297)));}),tgBot[_0x41c6ce(0x1e3)](_0x41c6ce(0x12d));});}}),tgBot[_0x1c278c(0x293)](/\/metrics/,_0x3e6dde=>{const _0x2d74ee=_0x1c278c;if(!validateTelegram(_0x3e6dde))return;tgBot[_0x2d74ee(0x1e3)](_0x2d74ee(0x12d));const _0x36fd4b=getEnabledBots();if(_0x36fd4b[_0x2d74ee(0x144)]==0x0)tgBot[_0x2d74ee(0x1db)](_0x3e6dde['chat']['id'],_0x2d74ee(0x122))[_0x2d74ee(0x11e)](_0x51f329=>{telegramError(_0x51f329);});else{if(_0x36fd4b['length']>0x1){let _0x21f8fc=[],_0x211922=[];const _0x3b3872=_0x36fd4b[_0x2d74ee(0x144)]%0x4==0x0||_0x36fd4b[_0x2d74ee(0x144)]%0x4==0x3||_0x36fd4b[_0x2d74ee(0x144)]%0x3==0x1?0x4:0x3;let _0x16ba8b=0x0;_0x36fd4b[_0x2d74ee(0xff)]((_0x13052f,_0x269f85)=>{const _0xe37cae=_0x2d74ee;if(_0x269f85%_0x3b3872==0x0)_0x211922=[];_0x211922['push']({'text':_0xe37cae(0x24c)+_0x13052f[_0xe37cae(0x13f)],'callback_data':_0x13052f['botID']}),_0x269f85%_0x3b3872==0x0&&(_0x21f8fc[_0x16ba8b]=_0x211922,_0x16ba8b++);}),tgBot['sendMessage'](_0x3e6dde[_0x2d74ee(0xfe)]['id'],_0x2d74ee(0x29c),{'reply_markup':{'inline_keyboard':_0x21f8fc}})[_0x2d74ee(0x11e)](_0x4721d0=>{telegramError(_0x4721d0);}),tgBot['on']('callback_query',async _0x4d2bb3=>{const _0x43f336=_0x2d74ee,_0x2bd437=_0x4d2bb3[_0x43f336(0x195)],_0x3fa974=_0x4d2bb3[_0x43f336(0x270)];tgBot[_0x43f336(0x187)](_0x4d2bb3['id'])['then'](async()=>{const _0x59d743=_0x43f336;if(pid[_0x2bd437])pid[_0x2bd437][_0x59d743(0xe2)]({'function':_0x59d743(0x2ba),'args':null});}),tgBot['removeListener'](_0x43f336(0x12d));});}else{const _0x495fbc=_0x36fd4b[0x0][_0x2d74ee(0x13f)];if(pid[_0x495fbc])pid[_0x495fbc][_0x2d74ee(0xe2)]({'function':_0x2d74ee(0x2ba),'args':null});}}}),tgBot[_0x1c278c(0x293)](/\/portfolio/,_0x4597f1=>{const _0x5486d5=_0x1c278c;if(!validateTelegram(_0x4597f1))return;tgBot[_0x5486d5(0x1e3)](_0x5486d5(0x12d));const _0x505396=getEnabledBots();if(_0x505396[_0x5486d5(0x144)]==0x0)tgBot['sendMessage'](_0x4597f1[_0x5486d5(0xfe)]['id'],_0x5486d5(0x122))['catch'](_0x420159=>{telegramError(_0x420159);});else{if(_0x505396[_0x5486d5(0x144)]>0x1){let _0xd716b8=[],_0x205c01=[];const _0x46cd58=_0x505396[_0x5486d5(0x144)]%0x4==0x0||_0x505396[_0x5486d5(0x144)]%0x4==0x3||_0x505396['length']%0x3==0x1?0x4:0x3;let _0x4a163a=0x0;_0x505396['forEach']((_0x5106d2,_0x3e3324)=>{const _0x554476=_0x5486d5;if(_0x3e3324%_0x46cd58==0x0)_0x205c01=[];_0x205c01['push']({'text':_0x554476(0x24c)+_0x5106d2['botID'],'callback_data':_0x5106d2[_0x554476(0x13f)]}),_0x3e3324%_0x46cd58==0x0&&(_0xd716b8[_0x4a163a]=_0x205c01,_0x4a163a++);}),tgBot[_0x5486d5(0x1db)](_0x4597f1[_0x5486d5(0xfe)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0xd716b8}})[_0x5486d5(0x11e)](_0x386148=>{telegramError(_0x386148);}),tgBot['on'](_0x5486d5(0x12d),async _0x71395e=>{const _0x4a5a42=_0x5486d5,_0x387d4c=_0x71395e['data'],_0x15c882=_0x71395e[_0x4a5a42(0x270)];tgBot[_0x4a5a42(0x187)](_0x71395e['id'])[_0x4a5a42(0x1f6)](async()=>{const _0x17feab=_0x4a5a42;if(pid[_0x387d4c])pid[_0x387d4c]['send']({'function':_0x17feab(0xfc),'args':null});}),tgBot[_0x4a5a42(0x1e3)](_0x4a5a42(0x12d));});}else{const _0x328d2a=_0x505396[0x0][_0x5486d5(0x13f)];if(pid[_0x328d2a])pid[_0x328d2a][_0x5486d5(0xe2)]({'function':_0x5486d5(0xfc),'args':null});}}}),tgBot[_0x1c278c(0x293)](/\/update/,async _0x31d5c3=>{const _0x213c62=_0x1c278c;if(!validateTelegram(_0x31d5c3))return;tgBot[_0x213c62(0x1e3)]('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x213c62(0x1db)](_0x31d5c3['chat']['id'],_0x213c62(0x176))['catch'](_0x31d9bc=>{telegramError(_0x31d9bc);});else!validInstallation?tgBot['sendMessage'](_0x31d5c3[_0x213c62(0xfe)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0x213c62(0x11e)](_0x5bc543=>{telegramError(_0x5bc543);}):(tgBot[_0x213c62(0x1db)](_0x31d5c3[_0x213c62(0xfe)]['id'],_0x213c62(0x103),{'reply_markup':{'inline_keyboard':[[{'text':_0x213c62(0x22b),'callback_data':_0x213c62(0x2c0)},{'text':'No','callback_data':'no'}]]}})[_0x213c62(0x11e)](_0x5978b8=>{telegramError(_0x5978b8);}),tgBot['on'](_0x213c62(0x12d),async _0x44c39c=>{const _0x4f8de2=_0x213c62,_0x40727f=_0x44c39c[_0x4f8de2(0x195)],_0x3f9c09=_0x44c39c['message'];tgBot[_0x4f8de2(0x187)](_0x44c39c['id'])[_0x4f8de2(0x1f6)](async()=>{const _0x37b9aa=_0x4f8de2;_0x40727f==_0x37b9aa(0x2c0)&&(await tgBot['sendMessage'](_0x3f9c09['chat']['id'],_0x37b9aa(0x265))[_0x37b9aa(0x11e)](_0x221a3d=>{telegramError(_0x221a3d);}),updateBB(_0x37b9aa(0x295))),_0x40727f=='no'&&await tgBot[_0x37b9aa(0x1db)](_0x3f9c09['chat']['id'],_0x37b9aa(0x2a0))['catch'](_0x1fba3a=>{telegramError(_0x1fba3a);});}),tgBot[_0x4f8de2(0x1e3)](_0x4f8de2(0x12d));}));}),tgBot[_0x1c278c(0x293)](/\/reinstall/,async _0x1f8e9e=>{const _0x55d4d3=_0x1c278c;if(!validateTelegram(_0x1f8e9e))return;tgBot[_0x55d4d3(0x1e3)](_0x55d4d3(0x12d)),!validInstallation?tgBot[_0x55d4d3(0x1db)](_0x1f8e9e[_0x55d4d3(0xfe)]['id'],_0x55d4d3(0x1ee))[_0x55d4d3(0x11e)](_0x2b2562=>{telegramError(_0x2b2562);}):(tgBot[_0x55d4d3(0x1db)](_0x1f8e9e[_0x55d4d3(0xfe)]['id'],_0x55d4d3(0x24d),{'reply_markup':{'inline_keyboard':[[{'text':_0x55d4d3(0x22b),'callback_data':_0x55d4d3(0x2c0)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x3603ad=>{telegramError(_0x3603ad);}),tgBot['on'](_0x55d4d3(0x12d),async _0x435d4f=>{const _0x33a3d1=_0x55d4d3,_0x14cfee=_0x435d4f[_0x33a3d1(0x195)],_0x1e34c2=_0x435d4f[_0x33a3d1(0x270)];tgBot[_0x33a3d1(0x187)](_0x435d4f['id'])[_0x33a3d1(0x1f6)](async()=>{const _0x3ddbe0=_0x33a3d1;_0x14cfee==_0x3ddbe0(0x2c0)&&(await tgBot[_0x3ddbe0(0x1db)](_0x1e34c2[_0x3ddbe0(0xfe)]['id'],_0x3ddbe0(0x1c9))[_0x3ddbe0(0x11e)](_0x3455e6=>{telegramError(_0x3455e6);}),updateBB(_0x3ddbe0(0x1e6))),_0x14cfee=='no'&&await tgBot[_0x3ddbe0(0x1db)](_0x1e34c2[_0x3ddbe0(0xfe)]['id'],_0x3ddbe0(0x17c))[_0x3ddbe0(0x11e)](_0x32cb90=>{telegramError(_0x32cb90);});}),tgBot[_0x33a3d1(0x1e3)]('callback_query');}));}),tgBot[_0x1c278c(0x293)](/\/toggle/,_0x22d787=>{const _0x9ea136=_0x1c278c;if(!validateTelegram(_0x22d787))return;tgBot['removeListener']('callback_query');const _0x49646c=getBotsWithMode();if(_0x49646c[_0x9ea136(0x144)]==0x0)tgBot[_0x9ea136(0x1db)](_0x22d787[_0x9ea136(0xfe)]['id'],_0x9ea136(0x122))[_0x9ea136(0x11e)](_0x9f9e1f=>{telegramError(_0x9f9e1f);});else{let _0x4b88f1=[],_0x52f526=[];const _0x14c3e0=0x2;let _0x168666=0x0;_0x49646c['forEach']((_0x4fec3b,_0x613bc1)=>{const _0x4d4c50=_0x9ea136;if(_0x613bc1%_0x14c3e0==0x0)_0x52f526=[];_0x52f526[_0x4d4c50(0x18d)]({'text':_0x4d4c50(0x24c)+_0x4fec3b[_0x4d4c50(0x13f)]+'\x20('+_0x4fec3b[_0x4d4c50(0x2bf)]+')','callback_data':_0x4fec3b['botID']}),_0x613bc1%_0x14c3e0==0x0&&(_0x4b88f1[_0x168666]=_0x52f526,_0x168666++);}),tgBot[_0x9ea136(0x1db)](_0x22d787[_0x9ea136(0xfe)]['id'],_0x9ea136(0x21a),{'reply_markup':{'inline_keyboard':_0x4b88f1}})['catch'](_0x3ced33=>{telegramError(_0x3ced33);}),tgBot['on'](_0x9ea136(0x12d),async _0x5e154e=>{const _0x699707=_0x9ea136,_0xf49e86=_0x5e154e['data'],_0x56d911=_0x5e154e[_0x699707(0x270)];tgBot[_0x699707(0x187)](_0x5e154e['id'])[_0x699707(0x1f6)](async()=>{const _0x5ea9c5=_0x699707,_0x2b0181=_0x49646c[_0x5ea9c5(0x2b8)](_0x2ac597=>_0x2ac597[_0x5ea9c5(0x13f)]==_0xf49e86),_0x5c1fb8=_0x2b0181['mode']==_0x5ea9c5(0x150)?'manual':_0x5ea9c5(0x150);tgBot['sendMessage'](_0x56d911['chat']['id'],_0x5ea9c5(0x246)+_0xf49e86+_0x5ea9c5(0x19d)+_0x5c1fb8+_0x5ea9c5(0x294))['catch'](_0x168fbb=>{telegramError(_0x168fbb);}),toggleBotMode(_0xf49e86);}),tgBot[_0x699707(0x1e3)](_0x699707(0x12d));});}}),tgBot[_0x1c278c(0x293)](/\/names/,_0x2bb321=>{const _0x1ef8ca=_0x1c278c;if(!validateTelegram(_0x2bb321))return;let _0x231e4e='';config[_0x1ef8ca(0xff)](_0x5f45bb=>{const _0x2e9ef4=_0x1ef8ca;_0x231e4e+=_0x2e9ef4(0x24c)+_0x5f45bb[_0x2e9ef4(0x13f)]+':\x20'+_0x5f45bb[_0x2e9ef4(0xe1)]+'\x0a';}),tgBot[_0x1ef8ca(0x1db)](_0x2bb321[_0x1ef8ca(0xfe)]['id'],_0x231e4e,{'parse_mode':_0x1ef8ca(0x171)})[_0x1ef8ca(0x11e)](_0x3568c2=>{telegramError(_0x3568c2);});}),tgBot['onText'](/\/disable/,_0x995456=>{const _0x3bef9d=_0x1c278c;if(!validateTelegram(_0x995456))return;tgBot[_0x3bef9d(0x1db)](_0x995456[_0x3bef9d(0xfe)]['id'],'Notifications\x20disabled')[_0x3bef9d(0x11e)](_0x29719a=>{telegramError(_0x29719a);}),updateSetting(_0x3bef9d(0x205),![]);}),tgBot[_0x1c278c(0x293)](/\/help/,_0x4c7591=>{const _0x5d6751=_0x1c278c;if(!validateTelegram(_0x4c7591))return;tgBot[_0x5d6751(0x1db)](_0x4c7591[_0x5d6751(0xfe)]['id'],_0x3d88b0)[_0x5d6751(0x11e)](_0xe35b29=>{telegramError(_0xe35b29);});}),tgBot['on']('polling_error',_0x464948=>{const _0xf844a2=_0x1c278c;_0x464948[_0xf844a2(0x236)]()['includes'](_0xf844a2(0x1b5))&&(logger[_0xf844a2(0x167)](_0xf844a2(0x1d4)),tgBot[_0xf844a2(0xfa)](),tgBot=null,io['to'](_0xf844a2(0x14d))[_0xf844a2(0x1a1)](_0xf844a2(0x1fc),_0xf844a2(0x1d4)));}),process[_0x1c278c(0x1e0)](_0x1c278c(0x224),()=>{const _0x32c084=_0x1c278c;if(tgBot)tgBot[_0x32c084(0xfa)]();process['exit'](0x1);}),process[_0x1c278c(0x1e0)](_0x1c278c(0x1c8),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);});}}function disableTelegram(){const _0x20b5b7=_0x3adbf5;tgBot&&(tgBot[_0x20b5b7(0xfa)](),tgBot=null);}function sendTelegram(_0x78fe9,_0x38d44b){const _0x2dc01c=_0x3adbf5;if(settings[_0x2dc01c(0x205)]){if(settings[_0x2dc01c(0x2af)]==_0x2dc01c(0x2b2)||(_0x38d44b[_0x2dc01c(0x1af)]==_0x2dc01c(0x1fb)||_0x38d44b[_0x2dc01c(0x1af)]==_0x2dc01c(0x20a)||_0x38d44b['type']==_0x2dc01c(0x22f))&&settings['telegramEvents']==_0x2dc01c(0x15c)||_0x38d44b['type']==_0x2dc01c(0x1d7)&&settings[_0x2dc01c(0x2af)]==_0x2dc01c(0x218)){if(tgBot&&settings[_0x2dc01c(0x28e)]){if(_0x38d44b[_0x2dc01c(0x26b)])tgBot[_0x2dc01c(0x1db)](settings[_0x2dc01c(0x28e)],_0x38d44b['botname']+_0x2dc01c(0xd7)+_0x38d44b[_0x2dc01c(0x25b)])[_0x2dc01c(0x11e)](_0x22efb1=>{telegramError(_0x22efb1);});else tgBot[_0x2dc01c(0x1db)](settings[_0x2dc01c(0x28e)],_0x2dc01c(0x24c)+_0x78fe9+_0x2dc01c(0xd7)+_0x38d44b[_0x2dc01c(0x25b)])[_0x2dc01c(0x11e)](_0x5d9e60=>{telegramError(_0x5d9e60);});}}}}async function sendTelegramMsg(_0x490347,_0x16ea62='HTML'){const _0x459fe4=_0x3adbf5;return settings[_0x459fe4(0x205)]&&tgBot&&settings[_0x459fe4(0x28e)]?(await tgBot[_0x459fe4(0x1db)](settings[_0x459fe4(0x28e)],_0x490347,{'parse_mode':_0x16ea62})['catch'](_0x1a0380=>{telegramError(_0x1a0380);}),!![]):![];}function getDeviceWithIp(_0x3bf708){const _0x4a1ea1=_0x3adbf5;return devices[_0x4a1ea1(0x2b8)](_0x289a3c=>_0x289a3c['ip']===_0x3bf708);}function temporaryAccess2FA(_0x5b62b2,_0x52d3df){const _0x22550e=_0x3adbf5;let _0x3d57a0=new Date(),_0x48a5d2=![];if(lastIpApproval){if(_0x3d57a0-lastIpApproval<0x1388)_0x48a5d2=!![];}lastIpApproval=new Date();if(_0x48a5d2)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x22550e(0x1e3)]('callback_query'),tgBot[_0x22550e(0x1db)](settings[_0x22550e(0x28e)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x52d3df)['show']+_0x22550e(0x278),{'parse_mode':_0x22550e(0x171),'reply_markup':{'inline_keyboard':[[{'text':_0x22550e(0x27a),'callback_data':'5'},{'text':_0x22550e(0x21c),'callback_data':'15'},{'text':_0x22550e(0x1ce),'callback_data':'30'},{'text':_0x22550e(0x274),'callback_data':_0x22550e(0x274)}]]}})[_0x22550e(0x11e)](_0x13919a=>{telegramError(_0x13919a);}),tgBot['on'](_0x22550e(0x12d),async _0x260bef=>{const _0x5d76fb=_0x22550e,_0x59086c=_0x260bef[_0x5d76fb(0x195)],_0x243a16=_0x260bef[_0x5d76fb(0x270)];tgBot[_0x5d76fb(0x187)](_0x260bef['id'])[_0x5d76fb(0x1f6)](async()=>{const _0x1c26ac=_0x5d76fb;devices[_0x5b62b2][_0x1c26ac(0x2ac)]={'clientip':_0x52d3df,'timestamp':new Date()[_0x1c26ac(0x1c2)](),'expiry':_0x59086c},_0x59086c!=_0x1c26ac(0x274)?(await tgBot[_0x1c26ac(0x1db)](_0x243a16[_0x1c26ac(0xfe)]['id'],_0x1c26ac(0xe0)+_0x59086c+_0x1c26ac(0x26d),{'parse_mode':'HTML'})[_0x1c26ac(0x11e)](_0x2da84d=>{telegramError(_0x2da84d);}),io['to'](_0x5b62b2)[_0x1c26ac(0x1a1)](_0x1c26ac(0x1a5),{'access':{'allow':![],'reason':_0x1c26ac(0x275),'token':null}})):(await tgBot[_0x1c26ac(0x1db)](_0x243a16['chat']['id'],_0x1c26ac(0x298))[_0x1c26ac(0x11e)](_0x477b3f=>{telegramError(_0x477b3f);}),io['to'](_0x5b62b2)[_0x1c26ac(0x1a1)](_0x1c26ac(0x1a5),{'access':{'allow':![],'reason':_0x1c26ac(0x29d),'token':null}}));}),tgBot['removeListener']('callback_query');}));}function loginAccess2FA(_0x3736e2,_0x18ca1c){const _0x479c01=_0x3adbf5;tgBot&&settings[_0x479c01(0x28e)]&&(tgBot['removeListener'](_0x479c01(0x12d)),tgBot['sendMessage'](settings[_0x479c01(0x28e)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x18ca1c)[_0x479c01(0x12f)]+_0x479c01(0x278),{'parse_mode':_0x479c01(0x171),'reply_markup':{'inline_keyboard':[[{'text':_0x479c01(0x12c),'callback_data':loginExpiry},{'text':_0x479c01(0x274),'callback_data':'reject'}]]}})[_0x479c01(0x11e)](_0x1f2699=>{telegramError(_0x1f2699);}),tgBot['on']('callback_query',async _0x460289=>{const _0x5c7526=_0x479c01,_0x166c80=_0x460289[_0x5c7526(0x195)],_0x4ae8ec=_0x460289[_0x5c7526(0x270)];tgBot[_0x5c7526(0x187)](_0x460289['id'])[_0x5c7526(0x1f6)](async()=>{const _0x2161df=_0x5c7526;devices[_0x3736e2][_0x2161df(0x120)]={'clientip':_0x18ca1c,'timestamp':new Date()[_0x2161df(0x1c2)](),'expiry':_0x166c80},_0x166c80!='reject'?(await tgBot['sendMessage'](_0x4ae8ec[_0x2161df(0xfe)]['id'],_0x2161df(0x153),{'parse_mode':_0x2161df(0x171)})[_0x2161df(0x11e)](_0x33f472=>{telegramError(_0x33f472);}),io['to'](_0x3736e2)[_0x2161df(0x1a1)](_0x2161df(0x1a5),{'access':{'allow':![],'reason':_0x2161df(0x275),'token':null}})):(await tgBot[_0x2161df(0x1db)](_0x4ae8ec[_0x2161df(0xfe)]['id'],'Login\x20rejected')[_0x2161df(0x11e)](_0x20020c=>{telegramError(_0x20020c);}),io['to'](_0x3736e2)['emit'](_0x2161df(0x1a5),{'access':{'allow':![],'reason':_0x2161df(0x1c0),'token':null}}));}),tgBot[_0x5c7526(0x1e3)](_0x5c7526(0x12d));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3c0ccc=_0x3adbf5;return dbConfig[_0x3c0ccc(0x130)](_0x3c0ccc(0x1d1))[_0x3c0ccc(0x1b4)]('botID')[_0x3c0ccc(0xf0)]({'status':_0x3c0ccc(0x273)})['value']()||[];}function getDisabledBots(){const _0x3fc335=_0x3adbf5;return dbConfig[_0x3fc335(0x130)](_0x3fc335(0x1d1))[_0x3fc335(0x1b4)]('botID')[_0x3fc335(0xf0)]({'status':_0x3fc335(0x1f2)})['value']()||[];}function getBotAttributes(_0xe27ac5){const _0x269398=_0x3adbf5;let _0x71567e={};const _0x6a78fd=configpath+'bot-'+_0xe27ac5+_0x269398(0x222),_0x2cf8d0=fs[_0x269398(0x16f)](_0x6a78fd);if(_0x2cf8d0){const _0x1c8e55=fs[_0x269398(0x1ef)](_0x6a78fd);try{const _0x5a6688=JSON[_0x269398(0x16d)](_0x1c8e55),_0x34ac4e=_0x5a6688?_0x5a6688['bot'][0x0][_0x269398(0x253)]:![];_0x71567e[_0x269398(0x2bf)]=_0x34ac4e?_0x269398(0x150):_0x269398(0xf9),_0x71567e[_0x269398(0xe1)]=_0x5a6688?_0x5a6688[_0x269398(0xeb)][0x0][_0x269398(0xe1)]:_0x269398(0x24c)+_0xe27ac5;}catch(_0x73bf75){_0x71567e[_0x269398(0x2bf)]=_0x269398(0xf9),_0x71567e[_0x269398(0xe1)]='Bot\x20'+_0xe27ac5;}}else _0x71567e[_0x269398(0x2bf)]='manual',_0x71567e[_0x269398(0xe1)]=_0x269398(0x24c)+_0xe27ac5;return _0x71567e;}function getBotsWithMode(){const _0x11fa7f=_0x3adbf5,_0x2611c6=dbConfig[_0x11fa7f(0x130)]('bots')['sortBy'](_0x11fa7f(0x13f))[_0x11fa7f(0xf7)]()||[];return _0x2611c6[_0x11fa7f(0xff)](_0x4f68a3=>{const _0x306f1b=_0x11fa7f;let _0x518271=getBotAttributes(_0x4f68a3['botID']);_0x4f68a3['mode']=_0x518271[_0x306f1b(0x2bf)];}),_0x2611c6;}function getBotExchanges(){const _0x3aefc2=_0x3adbf5;let _0x38ab7b=[];const _0x4ab945=dbConfig['get'](_0x3aefc2(0x1d1))[_0x3aefc2(0x1b4)]('botID')[_0x3aefc2(0xf7)]()||[];_0x4ab945[_0x3aefc2(0xff)](_0x529e5e=>{const _0x3bc747=_0x3aefc2;if(_0x529e5e[_0x3bc747(0x1a5)]==_0x3bc747(0x273)){const _0x3c0bf7=configpath+'bot-'+_0x529e5e[_0x3bc747(0x13f)]+_0x3bc747(0x222),_0x214e97=fs[_0x3bc747(0x16f)](_0x3c0bf7);let _0x25e80f;if(_0x214e97){const _0x2d5677=fs['readFileSync'](_0x3c0bf7);try{const _0x557bb8=JSON['parse'](_0x2d5677);_0x25e80f=_0x557bb8?_0x557bb8[_0x3bc747(0xeb)][0x0][_0x3bc747(0x135)]:null;}catch(_0x5e3d60){}}if(_0x25e80f)_0x38ab7b[_0x3bc747(0x18d)](_0x25e80f);}});const _0x58810b=[...new Set(_0x38ab7b)][_0x3aefc2(0x132)]();return _0x58810b;}async function initUser(){const _0x480c28=_0x3adbf5;if(!settings[_0x480c28(0x12b)]){const _0x1bb880=uuidRandom();mixpanel[_0x480c28(0x185)](_0x1bb880),updateSetting(_0x480c28(0x12b),_0x1bb880);}}async function initSecure(){const _0x552d44=_0x3adbf5;let _0x58591c=getSecure();if(!_0x58591c[_0x552d44(0x1ac)](_0x552d44(0x1f0))){let _0x47f3de=await generateKeys();_0x58591c['publicKey']=_0x47f3de[_0x552d44(0x1b0)],_0x58591c[_0x552d44(0xdf)]=_0x47f3de[_0x552d44(0xdf)],_0x58591c[_0x552d44(0x1f0)]=crypto['randomBytes'](0x20)[_0x552d44(0x236)](_0x552d44(0x1da));;storeSecure(_0x58591c);}}function getSettings(){const _0x18faba=_0x3adbf5;return dbSettings[_0x18faba(0x130)]('settings')['value']()||{};}function getSecure(){const _0x1d33e1=_0x3adbf5;return dbSecure[_0x1d33e1(0x130)](_0x1d33e1(0x11a))[_0x1d33e1(0xf7)]()||{};}function getBlacklist(){const _0x26921a=_0x3adbf5;return dbSecure[_0x26921a(0x130)]('blacklist')[_0x26921a(0xf7)]()||[];}function broadcastToBots(_0x5c380f,_0xcbe3dc){const _0x557496=_0x3adbf5;config[_0x557496(0xff)](_0x500874=>{const _0x38f80d=_0x557496;if(_0x500874[_0x38f80d(0x1a5)]==_0x38f80d(0x273)&&_0x500874[_0x38f80d(0x235)]=='running'||_0x500874['status']==_0x38f80d(0x2bd)&&_0x500874[_0x38f80d(0x235)]==_0x38f80d(0x2b5)){if(pid[_0x500874[_0x38f80d(0x13f)]])pid[_0x500874[_0x38f80d(0x13f)]][_0x38f80d(0xe2)]({[_0x5c380f]:_0xcbe3dc});}});}function storeSettings(_0x31a3e5,_0x454b90=![]){const _0x10e1b5=_0x3adbf5;_0x31a3e5={...settings,..._0x31a3e5};if(_0x454b90&&_0x31a3e5[_0x10e1b5(0x1cb)]!=_0x10e1b5(0x1b3)&&_0x31a3e5['bbPassword']!=_0x10e1b5(0x196)&&_0x31a3e5[_0x10e1b5(0x1cb)]!=''){const _0x4d1dad=crypt[_0x10e1b5(0xd2)](secure['privateKey'],_0x31a3e5['bbPassword'])[_0x10e1b5(0x270)][_0x10e1b5(0x26e)]('@')[0x0],_0x3f7308=bcrypt['hashSync'](_0x4d1dad,saltRounds);_0x31a3e5={..._0x31a3e5,'bbPassword':_0x3f7308};}if(_0x454b90&&_0x31a3e5[_0x10e1b5(0x13a)]!=_0x10e1b5(0x1b3)&&_0x31a3e5[_0x10e1b5(0x13a)]!=_0x10e1b5(0x196)&&_0x31a3e5['telegramToken']!=''){const _0x5d21f8=crypt['decrypt'](secure[_0x10e1b5(0xdf)],_0x31a3e5['telegramToken'])['message']['split']('@')[0x0];_0x31a3e5={..._0x31a3e5,'telegramToken':_0x5d21f8};}const _0x364939=_0x31a3e5[_0x10e1b5(0x13a)]!=_0x10e1b5(0x1b3)&&_0x31a3e5[_0x10e1b5(0x13a)]!=settings['telegramToken']||_0x31a3e5[_0x10e1b5(0x1ea)]!=settings[_0x10e1b5(0x1ea)],_0x19dc32=_0x31a3e5[_0x10e1b5(0x13a)]==''||_0x31a3e5['telegramUsername']=='';if(_0x364939)_0x31a3e5[_0x10e1b5(0x2af)]=_0x10e1b5(0x2b2);for(const [_0x3c5baa,_0x7aba2f]of Object['entries'](_0x31a3e5)){if(_0x3c5baa==_0x10e1b5(0x13a)&&_0x7aba2f=='************'){_0x31a3e5['telegramToken']=settings['telegramToken'];continue;};if(_0x3c5baa=='bbPassword'&&_0x7aba2f=='************'){_0x31a3e5[_0x10e1b5(0x1cb)]=settings[_0x10e1b5(0x1cb)];continue;};dbSettings[_0x10e1b5(0x203)](_0x10e1b5(0x20e)+_0x3c5baa,_0x7aba2f)[_0x10e1b5(0x10e)]();}settings=_0x31a3e5,io['to']('botmanager')['emit'](_0x10e1b5(0x1f7),cleanSettings()),broadcastToBots(_0x10e1b5(0x175),settings[_0x10e1b5(0x175)]),broadcastToBots(_0x10e1b5(0x228),settings[_0x10e1b5(0x228)]);if(_0x364939&&!_0x19dc32)initTelegram();if(_0x364939&&_0x19dc32)disableTelegram();getAllClients()[_0x10e1b5(0xff)](_0x36f90b=>{const _0x34c26b=_0x10e1b5;getSocket(_0x36f90b['id'])['emit']('status',{'access':{'allow':![],'reason':_0x34c26b(0x275),'token':null}});});}function updateSetting(_0x5a3748,_0xc3f5a8){const _0x4e3cdb=_0x3adbf5;dbSettings[_0x4e3cdb(0x203)](_0x4e3cdb(0x20e)+_0x5a3748,_0xc3f5a8)[_0x4e3cdb(0x10e)](),settings=getSettings(),io['to'](_0x4e3cdb(0x14d))[_0x4e3cdb(0x1a1)](_0x4e3cdb(0x1f7),cleanSettings());}function storeSecure(_0x2fdff8){const _0x1d1e47=_0x3adbf5;dbSecure[_0x1d1e47(0x130)]('secure')[_0x1d1e47(0x18d)](_0x2fdff8)[_0x1d1e47(0x10e)](),secure=_0x2fdff8;}function addBlacklist(_0x12b2b3){const _0x59d0fd=_0x3adbf5;cleanBlacklist();let _0x10c5b3;devices[_0x12b2b3][_0x59d0fd(0x2ac)]?_0x10c5b3=Math[_0x59d0fd(0x249)](devices[_0x12b2b3][_0x59d0fd(0x2ac)]['expiry'],loginExpiry):_0x10c5b3=loginExpiry,dbSecure['get'](_0x59d0fd(0x127))[_0x59d0fd(0x18d)]({'expiry':new Date()[_0x59d0fd(0x1c2)]()+_0x10c5b3*0x3c*0x3e8,'token':devices[_0x12b2b3][_0x59d0fd(0x215)][_0x59d0fd(0x200)]})[_0x59d0fd(0x10e)](),blacklist=dbSecure[_0x59d0fd(0x130)](_0x59d0fd(0x127))['value']();}function cleanBlacklist(){const _0x3db6fd=_0x3adbf5;let _0x4fee5a=dbSecure[_0x3db6fd(0x130)]('blacklist')['cloneDeep']()[_0x3db6fd(0xf7)](),_0x20db28=new Date()[_0x3db6fd(0x1c2)]();_0x4fee5a[_0x3db6fd(0xff)](_0x1012f2=>{const _0x3facd2=_0x3db6fd;_0x1012f2[_0x3facd2(0x268)]<_0x20db28&&dbSecure['get'](_0x3facd2(0x127))['remove']({'expiry':_0x1012f2[_0x3facd2(0x268)]})[_0x3facd2(0x10e)]();});}function initStates(){const _0x2277a9=_0x3adbf5;let _0x11a7ab=getConfiguration();_0x11a7ab[_0x2277a9(0xff)](_0x1a0476=>{const _0x1bc5db=_0x2277a9;_0x1a0476[_0x1bc5db(0x235)]=_0x1bc5db(0x297);}),storeConfiguration(_0x11a7ab);}function onKeys(){const _0x5dcf41=new RSA();return new Promise(_0x570b95=>{const _0x282b25=_0x3608;_0x5dcf41[_0x282b25(0xf3)]()['then'](_0x58cb8c=>{_0x570b95(_0x58cb8c);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x316bd8=_0x3adbf5;let _0x1292da=getSettings(),_0x155cc9=![];!_0x1292da[_0x316bd8(0x1ac)](_0x316bd8(0x174))&&(_0x1292da[_0x316bd8(0x174)]=0x0,_0x155cc9=!![]);!_0x1292da[_0x316bd8(0x1ac)]('lastmsgemitted')&&(_0x1292da[_0x316bd8(0xec)]=0x0,_0x155cc9=!![]);!_0x1292da['hasOwnProperty'](_0x316bd8(0x180))&&(_0x1292da['latestversion']=_0x316bd8(0x157),_0x155cc9=!![]);!_0x1292da[_0x316bd8(0x1ac)](_0x316bd8(0x228))&&(_0x1292da[_0x316bd8(0x228)]=![],_0x155cc9=!![]);if(_0x155cc9)storeSettings(_0x1292da);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x316bd8(0xff)](_0xaae85f=>{const _0x26aa0e=_0x316bd8;if(!_0xaae85f[_0x26aa0e(0x239)]()){if(!_0xaae85f[_0x26aa0e(0xe4)]['startsWith'](_0x26aa0e(0x12a)))fs[_0x26aa0e(0x1ff)](configbackuppath+_0xaae85f[_0x26aa0e(0xe4)]);}else fs[_0x26aa0e(0x211)](configbackuppath+_0xaae85f[_0x26aa0e(0xe4)],{'recursive':!![]});});}catch(_0x38abe3){logger[_0x316bd8(0x1bc)]('Error\x20removing\x20old\x20backup\x20files:',_0x38abe3);}}function storeConfiguration(_0xba2a0d){const _0x546292=_0x3adbf5;dbConfig['get'](_0x546292(0x1d1))[_0x546292(0x27c)]()['write'](),_0xba2a0d['forEach'](_0x2ede01=>{const _0x542845=_0x546292;delete _0x2ede01[_0x542845(0x2bf)];}),dbConfig[_0x546292(0x130)](_0x546292(0x1d1))[_0x546292(0x18d)](..._0xba2a0d)['write'](),config=_0xba2a0d;}function resetPassword(){const _0x3d1ba2=_0x3adbf5;tgBot&&settings[_0x3d1ba2(0x28e)]&&(tgBot[_0x3d1ba2(0x1e3)](_0x3d1ba2(0x12d)),tgBot[_0x3d1ba2(0x1db)](settings['telegramChatId'],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x3d1ba2(0x2c0)},{'text':'no','callback_data':'no'}]]}})[_0x3d1ba2(0x11e)](_0x577291=>{telegramError(_0x577291);}),tgBot['on'](_0x3d1ba2(0x12d),async _0x2cbc78=>{const _0x530293=_0x3d1ba2,_0x5d38d2=_0x2cbc78[_0x530293(0x195)],_0x1f4012=_0x2cbc78[_0x530293(0x270)];tgBot[_0x530293(0x187)](_0x2cbc78['id'])[_0x530293(0x1f6)](async()=>{const _0x2635f1=_0x530293;if(_0x5d38d2!='no'){const _0x1d18b7=0xf,_0xb2c270='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x2efa0a=Array[_0x2635f1(0x1e8)](crypto[_0x2635f1(0x229)](new Uint32Array(_0x1d18b7)))['map'](_0x80d7db=>_0xb2c270[_0x80d7db%_0xb2c270[_0x2635f1(0x144)]])[_0x2635f1(0x22a)](''),_0x3becd6=bcrypt[_0x2635f1(0x116)](_0x2efa0a,saltRounds);storeSettings({'bbPassword':_0x3becd6}),await tgBot[_0x2635f1(0x1db)](_0x1f4012[_0x2635f1(0xfe)]['id'],_0x2635f1(0x27e)+_0x2efa0a,{'parse_mode':_0x2635f1(0x171)})['catch'](_0x2d3a25=>{telegramError(_0x2d3a25);});}else await tgBot['sendMessage'](_0x1f4012['chat']['id'],_0x2635f1(0x2a2))['catch'](_0x3d952c=>{telegramError(_0x3d952c);});}),tgBot[_0x530293(0x1e3)](_0x530293(0x12d));}));}async function confirmRestore(_0xc54dc6,_0x5532c6){const _0x1eb413=_0x3adbf5;io['to'](_0x1eb413(0x14d))['emit']('notification',_0x1eb413(0xd0),_0x1eb413(0x22f)),tgBot&&settings[_0x1eb413(0x28e)]&&(tgBot['removeListener']('callback_query'),await tgBot[_0x1eb413(0x1db)](settings[_0x1eb413(0x28e)],_0x1eb413(0x210),{'parse_mode':_0x1eb413(0x171),'reply_markup':{'inline_keyboard':[[{'text':_0x1eb413(0x2c0),'callback_data':_0x1eb413(0x2c0)},{'text':'no','callback_data':'no'}]]}})[_0x1eb413(0x11e)](_0x28322e=>{telegramError(_0x28322e);}),tgBot['on']('callback_query',async _0x496f78=>{const _0x22b977=_0x1eb413,_0x326f25=_0x496f78['data'],_0x3e8e45=_0x496f78[_0x22b977(0x270)];tgBot[_0x22b977(0x187)](_0x496f78['id'])[_0x22b977(0x1f6)](async()=>{const _0x307019=_0x22b977;_0x326f25==_0x307019(0x2c0)?(await tgBot[_0x307019(0x1db)](_0x3e8e45[_0x307019(0xfe)]['id'],_0x307019(0x10b),{'parse_mode':_0x307019(0x171)})[_0x307019(0x11e)](_0x6ccf87=>{telegramError(_0x6ccf87);}),unzipFile(_0xc54dc6,_0x5532c6)):(logger[_0x307019(0x1bc)](_0x307019(0x2b6)),await tgBot[_0x307019(0x1db)](_0x3e8e45[_0x307019(0xfe)]['id'],_0x307019(0x2b6))[_0x307019(0x11e)](_0x503892=>{telegramError(_0x503892);}));}),tgBot['removeListener'](_0x22b977(0x12d));}));}function getServerTime(){const _0x5e5609=_0x3adbf5,_0x33b0f7=new Date();return _0x33b0f7[_0x5e5609(0x15b)]()+'/'+(_0x33b0f7['getMonth']()+0x1)['toString']()[_0x5e5609(0x2a8)](0x2,'0')+'/'+_0x33b0f7[_0x5e5609(0x139)]()[_0x5e5609(0x236)]()[_0x5e5609(0x2a8)](0x2,'0')+'\x20'+_0x33b0f7[_0x5e5609(0x124)]()[_0x5e5609(0x236)]()['padStart'](0x2,'0')+':'+_0x33b0f7[_0x5e5609(0x2a6)]()[_0x5e5609(0x236)]()[_0x5e5609(0x2a8)](0x2,'0')+':'+_0x33b0f7[_0x5e5609(0x1ae)]()[_0x5e5609(0x236)]()[_0x5e5609(0x2a8)](0x2,'0');}function getTimeStamp(){const _0x49ca72=_0x3adbf5,_0x41dd24=shiftedTime();return _0x41dd24[_0x49ca72(0x15b)]()+'/'+(_0x41dd24[_0x49ca72(0x145)]()+0x1)[_0x49ca72(0x236)]()[_0x49ca72(0x2a8)](0x2,'0')+'/'+_0x41dd24['getDate']()[_0x49ca72(0x236)]()[_0x49ca72(0x2a8)](0x2,'0')+'\x20'+_0x41dd24[_0x49ca72(0x124)]()[_0x49ca72(0x236)]()[_0x49ca72(0x2a8)](0x2,'0')+':'+_0x41dd24[_0x49ca72(0x2a6)]()['toString']()['padStart'](0x2,'0')+':'+_0x41dd24[_0x49ca72(0x1ae)]()[_0x49ca72(0x236)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0xc534c9=_0x3adbf5,_0x17ad7e=shiftedTime();return _0x17ad7e[_0xc534c9(0x15b)]()+(_0x17ad7e['getMonth']()+0x1)[_0xc534c9(0x236)]()[_0xc534c9(0x2a8)](0x2,'0')+_0x17ad7e['getDate']()['toString']()[_0xc534c9(0x2a8)](0x2,'0')+'-'+_0x17ad7e[_0xc534c9(0x124)]()[_0xc534c9(0x236)]()[_0xc534c9(0x2a8)](0x2,'0')+_0x17ad7e['getMinutes']()[_0xc534c9(0x236)]()['padStart'](0x2,'0')+_0x17ad7e[_0xc534c9(0x1ae)]()[_0xc534c9(0x236)]()[_0xc534c9(0x2a8)](0x2,'0');}function shiftedTime(){const _0x2802ff=_0x3adbf5,_0x5cd966=new Date();let _0x54b8c9=_0x5cd966;if(settings[_0x2802ff(0x175)]&&settings['timeshift']!==0x0)_0x54b8c9=fns['add'](_0x5cd966,{'hours':settings[_0x2802ff(0x175)]});return _0x54b8c9;}function startScheduler(){const _0x13b470=_0x3adbf5,_0x586d37=new Date()[_0x13b470(0x16e)](),_0x361d22=shiftedTime()[_0x13b470(0x124)]();_0x361d22==0x4&&backupConfigFiles();_0x361d22==0x0&&rotateLogFiles();_0x586d37%0x6==0x0&&triggerAnalytics();_0x586d37%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x3b0e6e){logger['debug']('Restore\x20backup\x20file\x20'+_0x3b0e6e);const _0xd2e08b=getBotsWithMode();_0xd2e08b['length']>0x0?confirmRestore(configbackuppath,_0x3b0e6e):unzipFile(configbackuppath,_0x3b0e6e);}async function getBackupFiles(_0xaabe51=null){const _0x198500=_0x3adbf5;let _0x283869=[],_0x130a2c=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x130a2c[_0x198500(0x132)]((_0x40724c,_0xa5192e)=>_0x40724c[_0x198500(0xe4)]<_0xa5192e[_0x198500(0xe4)]?0x1:_0xa5192e[_0x198500(0xe4)]<_0x40724c[_0x198500(0xe4)]?-0x1:0x0),_0x130a2c['forEach'](_0xa8b488=>{const _0x2cc0b0=_0x198500;if(!_0xa8b488[_0x2cc0b0(0x239)]()&&_0xa8b488[_0x2cc0b0(0xe4)][_0x2cc0b0(0x290)](_0x2cc0b0(0x12a))&&_0xa8b488[_0x2cc0b0(0xe4)]['endsWith'](_0x2cc0b0(0x255))){const _0x5ceac1=formatDate(fs[_0x2cc0b0(0x125)](configbackuppath+_0xa8b488[_0x2cc0b0(0xe4)])[_0x2cc0b0(0x17b)]);_0x283869[_0x2cc0b0(0x18d)]({'name':_0xa8b488['name'],'mtime':_0x5ceac1});}});if(_0xaabe51)io['to'](_0xaabe51)[_0x198500(0x1a1)]('backup-files',_0x283869);else return _0x283869;}async function backupConfigFiles(){const _0x2ec7fd=_0x3adbf5;await zipFiles(_0x2ec7fd(0x1be));const _0x22961d=getCleanTimeStamp();fs[_0x2ec7fd(0x28d)](zippath+'backup-full.zip',configbackuppath+('backup-full@'+_0x22961d+_0x2ec7fd(0x255)));let _0x223abe=fs[_0x2ec7fd(0x108)](configbackuppath,{'withFileTypes':!![]});_0x223abe['sort']((_0x1fd2f1,_0x7bc634)=>_0x1fd2f1['name']<_0x7bc634['name']?0x1:_0x7bc634[_0x2ec7fd(0xe4)]<_0x1fd2f1[_0x2ec7fd(0xe4)]?-0x1:0x0),_0x223abe['length']>maxBackups&&fs['unlinkSync'](configbackuppath+_0x223abe[_0x223abe[_0x2ec7fd(0x144)]-0x1][_0x2ec7fd(0xe4)]);}function rotateLogFiles(){const _0x3a59b9=_0x3adbf5,_0x13027f=fs[_0x3a59b9(0x125)](logspath+_0x3a59b9(0x141)),_0x236f8f=_0x13027f[_0x3a59b9(0x161)]/0x400;if(_0x236f8f>0x64){let _0x402149=fs[_0x3a59b9(0x108)](logspath,{'withFileTypes':!![]});_0x402149[_0x3a59b9(0x132)]((_0xcf4a81,_0x482e1e)=>_0xcf4a81[_0x3a59b9(0xe4)]<_0x482e1e[_0x3a59b9(0xe4)]?0x1:_0x482e1e['name']<_0xcf4a81[_0x3a59b9(0xe4)]?-0x1:0x0),_0x402149['forEach'](_0x5ca622=>{const _0x4bcfa6=_0x3a59b9;if(_0x5ca622[_0x4bcfa6(0xe4)]==_0x4bcfa6(0x2b3))fs[_0x4bcfa6(0x28d)](logspath+_0x5ca622[_0x4bcfa6(0xe4)],logspath+_0x4bcfa6(0x173));if(_0x5ca622[_0x4bcfa6(0xe4)]=='output-001.log')fs[_0x4bcfa6(0x28d)](logspath+_0x5ca622[_0x4bcfa6(0xe4)],logspath+'output-002.log');_0x5ca622[_0x4bcfa6(0xe4)]==_0x4bcfa6(0x141)&&(fs[_0x4bcfa6(0x28d)](logspath+_0x5ca622['name'],logspath+'output-001.log'),fs['writeFileSync'](logspath+_0x5ca622[_0x4bcfa6(0xe4)],''));});}}async function zipFiles(_0x35eadc){const _0x230691=_0x3adbf5;let _0x377d92;if(_0x35eadc=='logs')_0x377d92=logspath;if(_0x35eadc==_0x230691(0x289))_0x377d92=configpath;if(_0x35eadc==_0x230691(0x1be))_0x377d92=configpath;let _0x19edbd=fs[_0x230691(0x108)](_0x377d92,{'withFileTypes':!![]});const _0x18b752=new require(_0x230691(0x206))();_0x19edbd[_0x230691(0xff)](_0x27de66=>{const _0x4ec415=_0x230691;if(!_0x27de66[_0x4ec415(0x239)]()){let _0xdb2535=fs[_0x4ec415(0x1ef)](_0x377d92+_0x27de66[_0x4ec415(0xe4)]);if(_0x35eadc=='backup'){const _0x291207=/^bot-[0-9]{3}-config.json$/,_0x27e478=_0x291207[_0x4ec415(0x1a0)](_0x27de66['name']);if(_0x27e478){const _0x135b7f=JSON[_0x4ec415(0x16d)](_0xdb2535);if(_0x135b7f[_0x4ec415(0xeb)][0x0]){_0x135b7f[_0x4ec415(0xeb)][0x0][_0x4ec415(0x1ec)]='***',_0x135b7f[_0x4ec415(0xeb)][0x0][_0x4ec415(0x14c)]=_0x4ec415(0x196);if(_0x135b7f[_0x4ec415(0xeb)][0x0][_0x4ec415(0xef)])_0x135b7f[_0x4ec415(0xeb)][0x0][_0x4ec415(0xef)]=_0x4ec415(0x196);}_0xdb2535=JSON[_0x4ec415(0x18e)](_0x135b7f,null,0x2);}if(_0x27de66['name']==_0x4ec415(0x254)){const _0x5186d2=JSON['parse'](_0xdb2535);if(_0x5186d2['settings'][_0x4ec415(0xf4)])_0x5186d2[_0x4ec415(0x1f7)][_0x4ec415(0xf4)]=![];if(_0x5186d2[_0x4ec415(0x1f7)][_0x4ec415(0x1cb)])_0x5186d2['settings'][_0x4ec415(0x1cb)]=_0x4ec415(0x196);if(_0x5186d2[_0x4ec415(0x1f7)][_0x4ec415(0x13a)])_0x5186d2[_0x4ec415(0x1f7)][_0x4ec415(0x13a)]='***';if(_0x5186d2[_0x4ec415(0x1f7)][_0x4ec415(0x28e)])_0x5186d2[_0x4ec415(0x1f7)][_0x4ec415(0x28e)]=null;_0xdb2535=JSON[_0x4ec415(0x18e)](_0x5186d2,null,0x2);}if(_0x27de66['name']!='bb-secure.json')_0x18b752['file'](_0x27de66['name'],_0xdb2535);}else _0x18b752[_0x4ec415(0x1a7)](_0x27de66[_0x4ec415(0xe4)],_0xdb2535);}});const _0x49f39e=_0x18b752['generate']({'base64':![],'compression':_0x230691(0x192)});fs['writeFileSync'](zippath+(_0x35eadc+_0x230691(0x255)),_0x49f39e,_0x230691(0x241));}async function unzipFile(_0x85c42d,_0x833ac){const _0x2aa0fd=_0x3adbf5;fs[_0x2aa0fd(0x108)](configpath,{'withFileTypes':!![]})['forEach'](_0x3e950b=>{const _0x4450e1=_0x2aa0fd;if(!_0x3e950b['isDirectory']())fs['rmSync'](configpath+_0x3e950b[_0x4450e1(0xe4)]);});const _0x5efe77=fs['readFileSync'](_0x85c42d+_0x833ac,_0x2aa0fd(0x241)),_0x2f9875=new require(_0x2aa0fd(0x206))(_0x5efe77,{'base64':![],'checkCRC32':!![]});Object[_0x2aa0fd(0x1f3)](_0x2f9875['files'])[_0x2aa0fd(0xff)](_0x4d58ec=>{const _0x44d2e8=_0x2aa0fd,_0x149186=_0x2f9875[_0x44d2e8(0x2a4)][_0x4d58ec];fs[_0x44d2e8(0x19c)](configpath+_0x149186['name'],_0x149186[_0x44d2e8(0x118)]);}),fs[_0x2aa0fd(0x108)](temppath,{'withFileTypes':!![]})[_0x2aa0fd(0xff)](_0x2e48a3=>{const _0x2e4240=_0x2aa0fd;if(!_0x2e48a3[_0x2e4240(0x239)]())fs[_0x2e4240(0x211)](temppath+_0x2e48a3[_0x2e4240(0xe4)]);}),logger['debug'](_0x2aa0fd(0x2bc)),process[_0x2aa0fd(0xe2)]({'restore':!![]},_0x2988b1=>{});}async function getPublicIp(){const _0x5c60d4=_0x3adbf5;try{const _0xed2c2=await axios['get'](_0x5c60d4(0x14e));publicip=_0xed2c2[_0x5c60d4(0x195)]['ip'];}catch(_0x1b98a3){}}async function triggerAnalytics(){const _0x30d4fc=_0x3adbf5;if(!publicip)await getPublicIp();const _0x18fe8d=getBotsWithMode();let _0x193e28=0x0;_0x18fe8d[_0x30d4fc(0xff)](_0xeadfb3=>{const _0x6a14ba=_0x30d4fc;if(_0xeadfb3[_0x6a14ba(0x1a5)]===_0x6a14ba(0x273))_0x193e28++;});const _0x919f35=getBotExchanges();mixpanel[_0x30d4fc(0x114)](_0x30d4fc(0x21d),{'distinct_id':settings[_0x30d4fc(0x12b)],'ip':publicip,'version':serverversion,'numbots':_0x18fe8d[_0x30d4fc(0x144)],'numbotsenabled':_0x193e28,'exchanges':_0x919f35});}async function getMessages(){const _0x15081c=_0x3adbf5,_0x241324=_0x15081c(0x28f),_0x4cba6e=new GraphQLClient(_0x241324),_0x1a20f2={'authorization':_0x15081c(0x112)},_0x5d4d9e=serverversion[_0x15081c(0x26e)]('.'),_0x4b6c89=_0x5d4d9e[0x0]+'.'+_0x5d4d9e[0x1],_0x1f113d=Math[_0x15081c(0x20c)](settings[_0x15081c(0x174)],settings[_0x15081c(0xec)]),_0x56d1a5={'last':parseInt(_0x1f113d),'bbm':_0x4b6c89},_0x1d5011=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x220aa5;try{_0x220aa5=await _0x4cba6e[_0x15081c(0x110)](_0x1d5011,_0x56d1a5,_0x1a20f2);}catch(_0x49172c){}if(_0x220aa5&&_0x220aa5['messages']){let _0x3138a0=settings[_0x15081c(0x174)];newMessages=[];for(const _0x11ff49 of _0x220aa5[_0x15081c(0x2b7)]){newMessages[_0x15081c(0x18d)](_0x11ff49);if(_0x11ff49[_0x15081c(0x276)])updateSetting(_0x15081c(0x180),_0x11ff49[_0x15081c(0x276)]);let _0x32b8d6=_0x11ff49[_0x15081c(0x276)]?serverversion>=_0x11ff49[_0x15081c(0x276)]:![];if(!_0x32b8d6&&_0x11ff49['number']>_0x3138a0){if(_0x11ff49[_0x15081c(0xcd)]===_0x15081c(0x119)||serverversion[_0x15081c(0x290)](_0x11ff49[_0x15081c(0xcd)])){let _0x1b3381=''+_0x11ff49['title']+'\x0a\x0a'+_0x11ff49[_0x15081c(0x270)];const _0x5e9313=await sendTelegramMsg(toTelegramMarkdown(_0x1b3381),_0x15081c(0x2b1));if(_0x5e9313)_0x3138a0=_0x11ff49[_0x15081c(0x172)];}}}updateAvailable=isNewerVersion(settings[_0x15081c(0x180)],serverversion),updateSetting('lastmsgtelegram',_0x3138a0),emitMessages();}}function emitMessages(){const _0x3e5af7=_0x3adbf5,_0x182c0c=settings[_0x3e5af7(0xec)];let _0x3a0fe4=[];newMessages['forEach'](_0x28705f=>{const _0x323801=_0x3e5af7;_0x28705f[_0x323801(0x172)]>_0x182c0c&&_0x3a0fe4[_0x323801(0x18d)](_0x28705f);}),_0x3a0fe4['length']>0x0&&getAllClients()['forEach'](_0x22c418=>{const _0xf579d5=_0x3e5af7;getSocket(_0x22c418['id'])[_0xf579d5(0x1a1)](_0xf579d5(0x270),_0x3a0fe4);});}function confirmMessage(_0x1489f3){updateSetting('lastmsgemitted',Number(_0x1489f3));}function _0x3608(_0x21ba1e,_0x1ff332){const _0x46e44a=_0x3086();return _0x3608=function(_0x5b3828,_0x80808d){_0x5b3828=_0x5b3828-0xcd;let _0x308649=_0x46e44a[_0x5b3828];return _0x308649;},_0x3608(_0x21ba1e,_0x1ff332);}function isNewerVersion(_0x57dd01,_0x467596){const _0x5192d0=_0x3adbf5,_0x23685b=_0x467596['split']('.'),_0x521257=_0x57dd01[_0x5192d0(0x26e)]('.');for(var _0x5a0e31=0x0;_0x5a0e31<_0x521257[_0x5192d0(0x144)];_0x5a0e31++){const _0x1dce77=~~_0x521257[_0x5a0e31],_0x1ee291=~~_0x23685b[_0x5a0e31];if(_0x1dce77>_0x1ee291)return!![];if(_0x1dce77<_0x1ee291)return![];}return![];}function toTelegramMarkdown(_0x28bb31){const _0x1f6ea1=_0x3adbf5,_0x5d1d29=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4f2cf0=/\*{2}(.+?)\*{2}/gim;return _0x28bb31=_0x28bb31['replace'](_0x5d1d29,_0x1f6ea1(0x23e))[_0x1f6ea1(0xcf)](_0x4f2cf0,'*$1*'),_0x28bb31;}async function validateConfigFile(){const _0x351e10=_0x3adbf5,_0x4022d0=dbConfig[_0x351e10(0x130)](_0x351e10(0x1d1))[_0x351e10(0x1b4)](_0x351e10(0x13f))['value']()||[];if(_0x4022d0[_0x351e10(0x144)]==0x0){let _0x4fb293=0x0,_0x1b21bb=[];const _0x4bccb2=/^bot-([0-9]{3})-config.json$/,_0x3fe1c5=fs[_0x351e10(0x108)](configpath);_0x3fe1c5[_0x351e10(0xff)](_0x2ed367=>{const _0x2aa7e8=_0x351e10,_0x46f2f8=_0x4bccb2['exec'](_0x2ed367);if(_0x46f2f8){const _0x2deaac=_0x46f2f8[0x1];let _0x25ac7b=getBotAttributes(_0x2deaac);_0x1b21bb[_0x2aa7e8(0x18d)]({'botID':_0x2deaac,'botname':_0x25ac7b[_0x2aa7e8(0xe1)],'status':'disabled','live':'stopped'}),_0x4fb293++;}}),_0x4fb293!=0x0&&(dbConfig[_0x351e10(0x130)](_0x351e10(0x1d1))[_0x351e10(0x197)](_0x1b21bb)[_0x351e10(0x10e)](),config=_0x1b21bb,restoredConfigFile=_0x4fb293);}}async function restoreConfigNotify(_0xbd0a95){const _0x3bcf67=_0x3adbf5;let _0xb8da62;if(restoredConfigFile==0x1)_0xb8da62=_0x3bcf67(0x131);else _0xb8da62=_0x3bcf67(0x199);if(_0xbd0a95)io['to'](_0x3bcf67(0x14d))[_0x3bcf67(0x1a1)](_0x3bcf67(0x1fc),_0xb8da62);else{logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x3bcf67(0xd4)](_0xb8da62),logger[_0x3bcf67(0xd4)]('-----------------------------------------------------------------------------------'),logger[_0x3bcf67(0xd4)]('');if(tgBot&&settings[_0x3bcf67(0x28e)]&&settings[_0x3bcf67(0x2af)]!=_0x3bcf67(0x218))tgBot[_0x3bcf67(0x1db)](settings[_0x3bcf67(0x28e)],'Bot\x20Mgr\x20>\x20'+_0xb8da62)['catch'](_0x4e2530=>{telegramError(_0x4e2530);});}}function validateCredentials(_0x3133fd,_0x425bb5){const _0x46c39b=_0x3adbf5;if(_0x3133fd[_0x46c39b(0x1bf)]==settings[_0x46c39b(0x143)]&&bcrypt[_0x46c39b(0x299)](_0x3133fd['password'],settings['bbPassword'])){if(settings[_0x46c39b(0x1bb)])return{'allow':![],'reason':_0x46c39b(0x226),'token':null};else{const _0x49d945=generateLoginToken(_0x425bb5);return{'allow':!![],'reason':_0x46c39b(0x183),'token':_0x49d945};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x22c082){const _0x5af59b=generateLoginToken(_0x22c082);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x5af59b};}function validateAccess(_0x132d29,_0xced92a,_0x696d02){const _0x31581e=_0x3adbf5,_0x31eeed=_0x696d02?_0x696d02:devices[_0xced92a]['ip'];let _0xd27ca2;const _0x5597f5=_0xc0b18f=>{const _0x54fec2=_0x3608;if(settings[_0x54fec2(0xf4)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0xced92a)){const _0x54e1c3=generateLoginToken(_0xced92a);return{'allow':!![],'reason':_0x54fec2(0x1d9),'token':_0x54e1c3};}else return{'allow':![],'reason':_0x54fec2(0x184),'token':null};}else return _0xd27ca2=validToken(_0xc0b18f,_0xced92a),_0xd27ca2[_0x54fec2(0x1ac)](_0x54fec2(0x22f))?{'allow':!![],'reason':_0x54fec2(0x251),'token':_0xc0b18f}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x54fec2(0x1ab),'token':null};};if(settings['whitelistEnabled']){let _0x5f27e5=[...settings['whitelist'],_0x31581e(0x136),_0x31581e(0x21f),_0x31581e(0x106)];if(_0x5f27e5['includes'](_0x31eeed))return _0x5597f5(_0x132d29);else{_0xd27ca2=validToken(_0x132d29,_0xced92a);if(_0xd27ca2['hasOwnProperty']('success'))return _0x5597f5(_0x132d29);else{if(telegramIpApproved(_0xced92a)){const _0x3c9f0c=generateToken(_0xced92a);return _0xd27ca2=_0x5597f5(_0x132d29),_0xd27ca2['allow']?{'allow':!![],'reason':_0x31581e(0x10d),'token':_0x3c9f0c}:_0xd27ca2;}else return settings[_0x31581e(0x22c)]?{'allow':![],'reason':_0x31581e(0x2be),'token':null}:{'allow':![],'reason':_0x31581e(0x234),'token':null};}}}else return _0x5597f5(_0x132d29);}function timelyDecrypt(_0x52cd9b,_0x9b5148=!![]){const _0x5c069d=_0x3adbf5;if(_0x52cd9b)try{const _0x5d20c7=crypt[_0x5c069d(0xd2)](secure[_0x5c069d(0xdf)],_0x52cd9b)[_0x5c069d(0x270)],_0x474462=_0x5d20c7[_0x5c069d(0x26e)]('@')[0x0],_0xe67e90=_0x5d20c7[_0x5c069d(0x26e)]('@')[0x1],_0xc0a743=new Date()['getTime']();if(_0x9b5148){if(_0xc0a743-_0xe67e90<maxSecretAge*0x3e8)return _0x474462;else return![];}else return _0x474462;}catch(_0x1f92e){return![];}else return![];}const validToken=(_0x478b82,_0xf5c4d6)=>{const _0x49fc82=_0x3adbf5,_0x5b908f=devices[_0xf5c4d6]['ip'];if(!_0x478b82)return{'error':_0x49fc82(0x264)};for(let _0x4fb9c7 of blacklist){if(_0x4fb9c7[_0x49fc82(0x200)]==_0x478b82)return{'error':_0x49fc82(0x1a3)};}let _0x5e731c;try{_0x5e731c=jwt[_0x49fc82(0x140)](_0x478b82,secure[_0x49fc82(0x1f0)]+_0xf5c4d6);}catch{return{'error':_0x49fc82(0x1e4)};}if(!_0x5e731c[_0x49fc82(0x1ac)](_0x49fc82(0xf2))&&!_0x5e731c[_0x49fc82(0x1ac)](_0x49fc82(0x1bf))||!_0x5e731c[_0x49fc82(0x1ac)](_0x49fc82(0x26a)))return{'error':_0x49fc82(0x237)};if(!_0x5e731c[_0x49fc82(0x1ac)](_0x49fc82(0x1bf))&&_0x5e731c[_0x49fc82(0x1ac)](_0x49fc82(0xf2))){const {clientip:_0x2dd2c1}=_0x5e731c;return _0x5b908f==_0x2dd2c1?{'success':_0x49fc82(0xe3)}:{'error':_0x49fc82(0x1fa)};}else{if(_0x5e731c[_0x49fc82(0x1ac)]('username')&&_0x5e731c[_0x49fc82(0x1ac)](_0x49fc82(0xf2))){const {username:_0x46ad07,clientip:_0x5a5376}=_0x5e731c;return settings[_0x49fc82(0x143)]==_0x46ad07&&_0x5b908f==_0x5a5376?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x49fc82(0xd6)};}}},generateLoginToken=_0xf7329c=>{const _0xe71481=_0x3adbf5;if(_0xf7329c){const _0x12493d=devices[_0xf7329c]['ip'];return jwt[_0xe71481(0x109)]({'username':settings['bbUsername'],'clientip':_0x12493d},secure[_0xe71481(0x1f0)]+_0xf7329c,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x2d050d=>{const _0x3fc019=_0x3adbf5;if(_0x2d050d){const _0x3a5aa5=devices[_0x2d050d]['ip'];return jwt[_0x3fc019(0x109)]({'clientip':_0x3a5aa5},secure[_0x3fc019(0x1f0)]+_0x2d050d,{'expiresIn':devices[_0x2d050d][_0x3fc019(0x2ac)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x274ea3=>{const _0x34302f=_0x3adbf5;let _0x3312be=![];return devices[_0x274ea3][_0x34302f(0x2ac)]&&devices[_0x274ea3][_0x34302f(0x2ac)][_0x34302f(0x268)]!=_0x34302f(0x274)&&(_0x3312be=devices[_0x274ea3][_0x34302f(0x2ac)][_0x34302f(0xf2)]==devices[_0x274ea3]['ip']&&new Date()[_0x34302f(0x1c2)]()-devices[_0x274ea3][_0x34302f(0x2ac)]['timestamp']<devices[_0x274ea3][_0x34302f(0x2ac)][_0x34302f(0x268)]*0x3c*0x3e8),_0x3312be;},telegram2FaApproved=_0x1193f9=>{const _0x4148af=_0x3adbf5;let _0x2f64d1=![];return devices[_0x1193f9]['telegram2FaApproval']&&devices[_0x1193f9][_0x4148af(0x120)][_0x4148af(0x268)]!=_0x4148af(0x274)&&(_0x2f64d1=devices[_0x1193f9]['telegram2FaApproval'][_0x4148af(0xf2)]==devices[_0x1193f9]['ip']&&new Date()[_0x4148af(0x1c2)]()-devices[_0x1193f9][_0x4148af(0x120)][_0x4148af(0x14b)]<devices[_0x1193f9][_0x4148af(0x120)]['expiry']*0x3c*0x3e8),_0x2f64d1;},normalizeIP=_0x35c2a6=>{const _0x1616d1=_0x3adbf5;let _0x1793b4=null,_0x1a5ec6=null;if(ipaddr[_0x1616d1(0x26c)](_0x35c2a6)){const _0x2566ed=ipaddr[_0x1616d1(0x16d)](_0x35c2a6);_0x2566ed[_0x1616d1(0x262)]()===_0x1616d1(0x1fd)?(_0x2566ed[_0x1616d1(0x2ad)]()&&(_0x1793b4=_0x2566ed['toIPv4Address']()[_0x1616d1(0x236)]()),_0x1a5ec6=_0x2566ed[_0x1616d1(0x236)]()):(_0x1793b4=_0x2566ed[_0x1616d1(0x236)](),_0x1a5ec6=_0x2566ed[_0x1616d1(0x25d)]()[_0x1616d1(0x236)]());}return{'show':_0x1793b4?_0x1793b4:_0x1a5ec6,'store':_0x1a5ec6};};function formatDate(_0x5cad93){const _0x268964=_0x3adbf5;return _0x5cad93[_0x268964(0x15b)]()+'/'+(_0x5cad93[_0x268964(0x145)]()+0x1)[_0x268964(0x236)]()[_0x268964(0x2a8)](0x2,'0')+'/'+_0x5cad93['getDate']()[_0x268964(0x236)]()[_0x268964(0x2a8)](0x2,'0')+'\x20'+_0x5cad93[_0x268964(0x124)]()[_0x268964(0x236)]()['padStart'](0x2,'0')+':'+_0x5cad93[_0x268964(0x2a6)]()[_0x268964(0x236)]()[_0x268964(0x2a8)](0x2,'0')+':'+_0x5cad93[_0x268964(0x1ae)]()[_0x268964(0x236)]()[_0x268964(0x2a8)](0x2,'0');}function sleep(_0x8c0698){return new Promise(_0x4dc7ac=>setTimeout(_0x4dc7ac,_0x8c0698));}