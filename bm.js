const _0x1ba0fc=_0x56ff;(function(_0x4033d5,_0x48d0d0){const _0x1c581f=_0x56ff,_0x154198=_0x4033d5();while(!![]){try{const _0x1ed3e7=-parseInt(_0x1c581f(0x15f))/0x1+parseInt(_0x1c581f(0x335))/0x2+-parseInt(_0x1c581f(0x269))/0x3+-parseInt(_0x1c581f(0x2f1))/0x4+-parseInt(_0x1c581f(0x31b))/0x5*(parseInt(_0x1c581f(0x1ed))/0x6)+-parseInt(_0x1c581f(0x2da))/0x7*(-parseInt(_0x1c581f(0x327))/0x8)+parseInt(_0x1c581f(0x154))/0x9;if(_0x1ed3e7===_0x48d0d0)break;else _0x154198['push'](_0x154198['shift']());}catch(_0x1bcddb){_0x154198['push'](_0x154198['shift']());}}}(_0x4b98,0x92453));const _0x2c4023=function(){let _0x522ae6=!![];return function(_0x45fac0,_0x204def){const _0x2892ec=_0x522ae6?function(){if(_0x204def){const _0x31fa15=_0x204def['apply'](_0x45fac0,arguments);return _0x204def=null,_0x31fa15;}}:function(){};return _0x522ae6=![],_0x2892ec;};}(),_0x2e2a1e=_0x2c4023(this,function(){const _0x152e40=_0x56ff;return _0x2e2a1e[_0x152e40(0x340)]()[_0x152e40(0x190)](_0x152e40(0x31a))[_0x152e40(0x340)]()['constructor'](_0x2e2a1e)[_0x152e40(0x190)](_0x152e40(0x31a));});_0x2e2a1e();'use strict';process[_0x1ba0fc(0x2db)][_0x1ba0fc(0x197)]=0x1;const childProcess=require(_0x1ba0fc(0x24b)),fs=require('fs'),fns=require(_0x1ba0fc(0x14f)),low=require('lowdb'),FileSync=require(_0x1ba0fc(0x295)),path=require(_0x1ba0fc(0x334)),crypto=require(_0x1ba0fc(0x160)),Crypt=require(_0x1ba0fc(0x307))['Crypt'],RSA=require('hybrid-crypto-js')[_0x1ba0fc(0x1c9)],bcrypt=require(_0x1ba0fc(0x316)),jwt=require(_0x1ba0fc(0x28e)),ipaddr=require(_0x1ba0fc(0x2e2)),argv=require(_0x1ba0fc(0x225))(process[_0x1ba0fc(0x1ac)]['slice'](0x2))[_0x1ba0fc(0x1ac)],uuidRandom=require('uuid-random'),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x1ba0fc(0x157)),axios=require(_0x1ba0fc(0x2ce)),{GraphQLClient,gql}=require(_0x1ba0fc(0x297)),util=require('util'),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv['port']||_0x1ba0fc(0x324),pattern=/^[0-9]{2,4}$/;!pattern[_0x1ba0fc(0x317)](PORT)&&(console[_0x1ba0fc(0x255)]('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x1ba0fc(0x231)](0x1));const HOST=argv[_0x1ba0fc(0x2ec)]||null,userID=argv[_0x1ba0fc(0x248)]||'',debugging=argv['d']||![],nodeversion=process[_0x1ba0fc(0x287)][_0x1ba0fc(0x275)];let bbpath=_0x1ba0fc(0x1bf),bbpath2='';const botfile=_0x1ba0fc(0x347),configfile=_0x1ba0fc(0x2f9),settingsfile=_0x1ba0fc(0x1f9),securefile=_0x1ba0fc(0x2c7),environment=require('./'+bbpath2+_0x1ba0fc(0x27f))['environment']||_0x1ba0fc(0x2e4),maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x1ba0fc(0x2e8)),configpath=userID?bbpath+_0x1ba0fc(0x2f8)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x1ba0fc(0x205),logspath=userID?bbpath+_0x1ba0fc(0x2d1)+userID+'/':bbpath+_0x1ba0fc(0x2d1),zippath=userID?bbpath+_0x1ba0fc(0x294)+userID+'/':bbpath+_0x1ba0fc(0x294),loggerfile=fs[_0x1ba0fc(0x18b)](logspath+_0x1ba0fc(0x1d4),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x1ba0fc(0x2a9);!fs[_0x1ba0fc(0x210)](configpath)&&fs[_0x1ba0fc(0x21d)](configpath);!fs[_0x1ba0fc(0x210)](configbackuppath)&&fs[_0x1ba0fc(0x21d)](configbackuppath);!fs[_0x1ba0fc(0x210)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x1ba0fc(0x210)](zippath)&&fs[_0x1ba0fc(0x21d)](zippath);!fs['existsSync'](temppath)&&fs[_0x1ba0fc(0x21d)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x1ba0fc(0x310)]({'bots':[]})[_0x1ba0fc(0x1d3)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x1ba0fc(0x310)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x1ba0fc(0x140),'onepagemode':![]}})[_0x1ba0fc(0x1d3)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x1ba0fc(0x310)]({'secure':{},'blacklist':[]})[_0x1ba0fc(0x1d3)]();let crypt=new Crypt({'md':_0x1ba0fc(0x199),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x1ba0fc(0x2cd)](_0x1ba0fc(0x203),{'host':_0x1ba0fc(0x2a5)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x1ba0fc(0x298)]&&(settings[_0x1ba0fc(0x298)]!=''&&settings['telegramToken']!=_0x1ba0fc(0x2b0))&&settings[_0x1ba0fc(0x1c6)]&&settings[_0x1ba0fc(0x1c6)]!='')initTelegram();const parseColor=(_0x46aa93,_0x5e71f3)=>{const _0x2f0dfe=_0x1ba0fc,_0x3dc9f7=/#[A-Z]{3}#/g;if(typeof _0x46aa93==_0x2f0dfe(0x319)){!_0x5e71f3?_0x46aa93=_0x46aa93['replace'](_0x3dc9f7,''):(_0x46aa93=_0x46aa93['replace'](/#BLU#/g,_0x2f0dfe(0x145)),_0x46aa93=_0x46aa93[_0x2f0dfe(0x312)](/#RED#/g,_0x2f0dfe(0x2f2)),_0x46aa93=_0x46aa93['replace'](/#YEL#/g,_0x2f0dfe(0x326)),_0x46aa93=_0x46aa93['replace'](/#MAG#/g,'\x1b[35m'),_0x46aa93=_0x46aa93[_0x2f0dfe(0x312)](/#CYA#/g,_0x2f0dfe(0x21e)),_0x46aa93=_0x46aa93[_0x2f0dfe(0x312)](/#RES#/g,_0x2f0dfe(0x246)));;}return _0x46aa93;},logger={'screen':_0x23a950=>{const _0x40917d=_0x1ba0fc;console[_0x40917d(0x255)](parseColor(_0x23a950,!![]));},'simple':_0x18905f=>{const _0x2ff74a=_0x1ba0fc;console[_0x2ff74a(0x255)](parseColor(_0x18905f,!![])),loggerfile['write'](util[_0x2ff74a(0x257)](parseColor(_0x18905f,![]))+'\x0a');},'full':async _0x36a272=>{const _0x42f3af=_0x1ba0fc,_0x29a392=getTimeStamp()+_0x42f3af(0x1fb)+_0x36a272;console['log'](parseColor(_0x29a392,!![])),loggerfile[_0x42f3af(0x1d3)](util[_0x42f3af(0x257)](parseColor(_0x29a392,![]))+'\x0a');if(tgBot&&settings[_0x42f3af(0x288)]&&settings['telegramEvents']!='orders')await sendTelegram(settings[_0x42f3af(0x288)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x36a272,![]));},'debug':async(_0x509eb1,_0x358457='')=>{const _0x1e9cee=_0x1ba0fc,_0x1d9e71=getTimeStamp()+_0x1e9cee(0x28f)+_0x509eb1;if(debugging)console[_0x1e9cee(0x255)](parseColor(_0x1d9e71,!![]));loggerfile[_0x1e9cee(0x1d3)](util[_0x1e9cee(0x257)](parseColor(_0x1d9e71,![]))+'\x0a');if(_0x358457){if(debugging)console[_0x1e9cee(0x255)](_0x358457);loggerfile[_0x1e9cee(0x1d3)](util['format'](_0x358457)+'\x0a');}}};let terminating=![];process['on'](_0x1ba0fc(0x1a3),function(_0x3bada8){const _0x5ea92c=_0x1ba0fc;logger[_0x5ea92c(0x2b6)](_0x3bada8);}),process['on'](_0x1ba0fc(0x231),()=>{const _0xdd8729=_0x1ba0fc;console[_0xdd8729(0x255)]('BM\x20received\x20exit\x20signal'),stopAllBots();}),process['on'](_0x1ba0fc(0x281),()=>{const _0x55c20d=_0x1ba0fc;console[_0x55c20d(0x255)](_0x55c20d(0x325)),stopAllBots();}),process['on'](_0x1ba0fc(0x1ce),()=>{const _0x3368be=_0x1ba0fc;console['log'](_0x3368be(0x15e)),stopAllBots();});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x1ba0fc(0x27f))[_0x1ba0fc(0x1f3)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];function _0x56ff(_0x23b1e0,_0x4c375c){const _0x129b78=_0x4b98();return _0x56ff=function(_0x2e2a1e,_0x2c4023){_0x2e2a1e=_0x2e2a1e-0x13b;let _0x4b98e2=_0x129b78[_0x2e2a1e];return _0x4b98e2;},_0x56ff(_0x23b1e0,_0x4c375c);}const express=require(_0x1ba0fc(0x2d8)),app=express(),http=require(_0x1ba0fc(0x2eb))[_0x1ba0fc(0x2de)](app);app[_0x1ba0fc(0x262)](fileUpload({'useTempFiles':!![]})),app[_0x1ba0fc(0x211)](_0x1ba0fc(0x174),async(_0x52695e,_0x303b46)=>{const _0x1d5b82=_0x1ba0fc,_0x2afb1c=_0x52695e['params'][_0x1d5b82(0x27d)],_0x22566d=getClientsWithBotID(_0x1d5b82(0x301)),_0x171068=_0x52695e[_0x1d5b82(0x152)][_0x1d5b82(0x1e0)],_0x173326=timelyDecrypt(_0x171068,![]),_0x8a6982=_0x22566d[_0x1d5b82(0x1f8)](_0x49f1ac=>_0x49f1ac[_0x1d5b82(0x1e0)]==_0x173326);if(_0x8a6982){const _0x19a075=normalizeIP(_0x52695e[_0x1d5b82(0x2ef)]['remoteAddress'])[_0x1d5b82(0x198)],_0x172a00=_0x52695e[_0x1d5b82(0x152)][_0x1d5b82(0x185)];if(validateAccess(_0x172a00,_0x173326,_0x19a075)[_0x1d5b82(0x240)])_0x2afb1c==_0x1d5b82(0x221)&&await backupConfigFiles(),await zipFiles(_0x2afb1c),_0x303b46[_0x1d5b82(0x289)](zippath+(_0x2afb1c+_0x1d5b82(0x2ad)),_0xd8c7a3=>{const _0x1c833b=_0x1d5b82;_0xd8c7a3&&(logger[_0x1c833b(0x184)](_0x1c833b(0x2f4)+_0x2afb1c),logger['simple'](_0xd8c7a3));});else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x2afb1c+_0x1d5b82(0x17e));}else logger['full'](_0x1d5b82(0x201)+_0x2afb1c+_0x1d5b82(0x1b7));}),app[_0x1ba0fc(0x322)](_0x1ba0fc(0x2a6),async(_0x43f5a6,_0x147d50)=>{const _0x465970=_0x1ba0fc,_0x4a5888=getClientsWithBotID('botmanager'),_0x18b6a8=_0x43f5a6[_0x465970(0x152)][_0x465970(0x1e0)],_0x35871f=timelyDecrypt(_0x18b6a8,![]),_0xd10209=_0x4a5888[_0x465970(0x1f8)](_0x43a8e1=>_0x43a8e1[_0x465970(0x1e0)]==_0x35871f);logger['debug'](_0x465970(0x2ea));if(_0xd10209){const _0xd2d090=normalizeIP(_0x43f5a6[_0x465970(0x2ef)][_0x465970(0x2d5)])['store'],_0x397cfc=_0x43f5a6[_0x465970(0x152)][_0x465970(0x185)];if(validateAccess(_0x397cfc,_0x35871f,_0xd2d090)[_0x465970(0x240)]){if(_0x43f5a6[_0x465970(0x328)]){const _0x429cc4=_0x43f5a6[_0x465970(0x328)][_0x465970(0x158)];await _0x429cc4['mv'](temppath+_0x429cc4['name']),_0x147d50[_0x465970(0x1de)]({'status':!![],'message':_0x465970(0x338)});const _0x44e961=getBotsWithMode();_0x44e961[_0x465970(0x343)]>0x0?confirmRestore(temppath,_0x429cc4[_0x465970(0x165)]):unzipFile(temppath,_0x429cc4[_0x465970(0x165)]);}}else logger[_0x465970(0x184)](_0x465970(0x243));}else logger[_0x465970(0x184)](_0x465970(0x224));}),app[_0x1ba0fc(0x262)](express[_0x1ba0fc(0x33e)](path[_0x1ba0fc(0x222)](__dirname,bbpath2,'build2'))),app[_0x1ba0fc(0x262)](express['static'](path[_0x1ba0fc(0x222)](__dirname,bbpath2,'build'))),app[_0x1ba0fc(0x211)]('/',function(_0x384e07,_0x113194){const _0x406eef=_0x1ba0fc;_0x113194['sendFile'](path['join'](__dirname,bbpath2,_0x406eef(0x188),'index.html'));}),app[_0x1ba0fc(0x211)](_0x1ba0fc(0x18c),function(_0x531580,_0x4af7ef){const _0x7cb7bd=_0x1ba0fc;_0x4af7ef['sendFile'](path['join'](__dirname,bbpath2,_0x7cb7bd(0x2c9),_0x7cb7bd(0x282)));}),app[_0x1ba0fc(0x211)](_0x1ba0fc(0x19a),(_0x182f46,_0x315fc1)=>{const _0x4b032b=_0x1ba0fc;_0x315fc1['sendFile'](path[_0x4b032b(0x222)](__dirname,bbpath2,_0x4b032b(0x2c9),'index.html'));}),app[_0x1ba0fc(0x211)](_0x1ba0fc(0x161),(_0x53fce3,_0x4ac596)=>{const _0x27a28d=_0x1ba0fc;_0x4ac596[_0x27a28d(0x2e9)](path['join'](__dirname,bbpath2,_0x27a28d(0x2c9),_0x27a28d(0x282)));}),app[_0x1ba0fc(0x211)](_0x1ba0fc(0x2d9),(_0x26b1ca,_0x27bfa0)=>{const _0x4dabc0=_0x1ba0fc;_0x27bfa0[_0x4dabc0(0x2e9)](path[_0x4dabc0(0x222)](__dirname,bbpath2,_0x4dabc0(0x2c9),_0x4dabc0(0x282)));}),app[_0x1ba0fc(0x211)]('/:bot/history',(_0x46c8b4,_0x522f7d)=>{const _0x13d538=_0x1ba0fc;_0x522f7d['sendFile'](path['join'](__dirname,bbpath2,_0x13d538(0x2c9),_0x13d538(0x282)));}),app[_0x1ba0fc(0x211)](_0x1ba0fc(0x2ee),(_0x5a65fb,_0x285975)=>{const _0x1433db=_0x1ba0fc;_0x285975[_0x1433db(0x2e9)](path[_0x1433db(0x222)](__dirname,bbpath2,'build',_0x1433db(0x282)));}),app['get']('/:bot/support',(_0x2e2dce,_0x453d71)=>{const _0x425448=_0x1ba0fc;_0x453d71[_0x425448(0x2e9)](path[_0x425448(0x222)](__dirname,bbpath2,_0x425448(0x2c9),'index.html'));});if(HOST)http[_0x1ba0fc(0x336)](PORT,HOST);else http[_0x1ba0fc(0x336)](PORT);const io=require(_0x1ba0fc(0x2a7))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x44a5d9=_0x1ba0fc;let _0x3eb5b5=_0x44a5d9(0x273);const _0x2d4d17=networkInterfaces(),_0x3d1b05={};for(const _0x3f04d4 of Object[_0x44a5d9(0x26e)](_0x2d4d17)){for(const _0x4fd226 of _0x2d4d17[_0x3f04d4]){if((_0x4fd226[_0x44a5d9(0x206)]==_0x44a5d9(0x30d)||_0x4fd226[_0x44a5d9(0x206)]==0x4)&&!_0x4fd226[_0x44a5d9(0x1a1)]){const _0xb19473=ipaddr[_0x44a5d9(0x238)](_0x4fd226['address'])[_0x44a5d9(0x314)]();_0xb19473!=_0x44a5d9(0x143)&&(!_0x3d1b05[_0x3f04d4]&&(_0x3d1b05[_0x3f04d4]=[]),_0x3d1b05[_0x3f04d4][_0x44a5d9(0x250)](_0x4fd226[_0x44a5d9(0x2b2)]),_0x3eb5b5=_0x4fd226['address']);}}}return{'serverip':_0x3eb5b5,'netinterfaces':_0x3d1b05};}async function startServer(){const _0x5672d3=_0x1ba0fc,{serverip:_0xe90317,netinterfaces:_0xf39494}=getServerIP();logger['simple'](''),logger[_0x5672d3(0x2b6)](_0x5672d3(0x266)),await logger[_0x5672d3(0x184)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x5672d3(0x1b5)+(environment==_0x5672d3(0x200)?_0x5672d3(0x1cb):'')+'\x0a'+(_0x5672d3(0x29d)+PORT+_0x5672d3(0x279))+(_0x5672d3(0x1b1)+_0xe90317+':'+PORT+_0x5672d3(0x2c8))),logger[_0x5672d3(0x2b6)](_0x5672d3(0x266));if(config['length']!=0x0)for(const _0x3b4348 of config){const _0xfbbf93=_0x3b4348['mode']=='auto'?'a':'m';if(_0x3b4348[_0x5672d3(0x20e)]==_0x5672d3(0x331)||_0x3b4348[_0x5672d3(0x20e)]==_0x5672d3(0x191))await logger[_0x5672d3(0x184)](_0x5672d3(0x168)+_0xfbbf93+_0x5672d3(0x308)+_0x3b4348[_0x5672d3(0x271)]+_0x5672d3(0x27e)+_0x3b4348[_0x5672d3(0x1a4)]),startBot([_0x3b4348['botID'],userID],{'cwd':bbpath},function(_0x3047aa){const _0x54c2f1=_0x5672d3;if(_0x3047aa)logger[_0x54c2f1(0x184)](_0x3047aa);});else(_0x3b4348[_0x5672d3(0x20e)]==_0x5672d3(0x179)||_0x3b4348[_0x5672d3(0x20e)]==_0x5672d3(0x2bf))&&await logger['full'](_0x5672d3(0x1b0)+_0xfbbf93+_0x5672d3(0x2b8)+_0x3b4348[_0x5672d3(0x271)]+'\x20|\x20'+_0x3b4348[_0x5672d3(0x1a4)]);}else!newBot&&logger[_0x5672d3(0x2b6)](_0x5672d3(0x1a2));if(newBot)addBot();logger[_0x5672d3(0x2b6)](_0x5672d3(0x266)),logger['simple'](''),await logger[_0x5672d3(0x1dd)](_0x5672d3(0x237)+nodeversion),await logger[_0x5672d3(0x1dd)](_0x5672d3(0x13f),_0xf39494);}function _0x4b98(){const _0x5fe71b=['login2fa_','#RES#\x20if\x20running\x20locally\x0a','f2aRequired','sockets','writeFileSync','type','\x20|\x20','version.json','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','SIGTERM','index.html','Login\x20rejected','tempaccess_15_','rmSync','loginRequired','versions','telegramChatId','download','forEach','store-fiat','latestversion','Unauthorized\x20attempt\x20to\x20delete\x20bot','jsonwebtoken',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','randomBytes','config_alerts','Bot\x20Mgr\x20>\x20','readdirSync','zip/','lowdb/adapters/FileSync','auto','graphql-request','telegramToken','backup-full@','inherit','encryptedUuid','names','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','getPortfolio','cloneDeep','clientip','Enabled\x20Bot\x20','Unauthorized\x20login\x20attempt\x20(timeout)','Markdown','-performance.json','api-eu.mixpanel.com','/upload-backup','socket.io','close','temp/','Bot\x20','ipv6','2FA\x20required','.zip','chat','temporary\x20token\x20generated','***','Restarting\x20Bot\x20','address','\x20to\x20','Restore\x20process\x20aborted','temporary\x20access\x20not\x20allowed','simple','access\x20timeout',')\x20\x20\x20|\x20Bot\x20','slice','bbvNew','timeshift','stopped','get-portfolio','bot-','new-disabled','username','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','apiSecret','started','off_','assign','HTML','bb-secure.json','#RES#\x20if\x20running\x20on\x20server','build','hex','catch',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','init','axios','max','logs','logs/','ipc','sign','order','remoteAddress','exp','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','express','/:bot/coins','91756jSjMXu','env','reinstall','any','createServer','message','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','show-config','ipaddr.js','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','production','showConfig','logout','pidExpireLogin','clients','sendFile','Backup\x20file\x20uploaded','http','host','\x20|\x20client:\x20...','/:bot/configuration','socket','$1_$2_$3','1274216jpWUvy','\x1b[31m','update-bb','Failed\x20to\x20download\x20','/start','action','editMessageReplyMarkup','config/','bb-config.json','reply','telegramEvents','Restore\x20process\x20confirmed','/on\x20-\x20start\x20bot(s)\x0a','get-messages','launch','callback','botmanager','command','entries','1000','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','title','hybrid-crypto-js',')\x20|\x20Bot\x20','/off\x20-\x20stop\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20get\x20messages','onepagemode','copyFileSync','IPv4','event','filter','defaults','/help\x20-\x20show\x20available\x20commands\x0a','replace','Unauthorized\x20attempt\x20to\x20delete\x20alerts','range','emit','bcryptjs','test','::ffff:127.0.0.1','string','(((.+)+)+)+$','545znBrYf','publicKey','Backup\x20file\x20unzipped\x20and\x20stored','Starting\x20Balance\x20Bot\x20update','warning','showname','\x20minutes','post','manual','3000','BM\x20received\x20sigterm\x20signal','\x1b[33m','176CBTGAq','files','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','resetpw_yes','Logged\x20out\x20user\x20...','Invalid\x20authentication\x20token\x20(2)','toIPv4Address','stringify','padStart','temporary\x20access\x20timeout','enabled','Ok,\x20will\x20send\x20order\x20notifications\x20only','readFileSync','path','328210olpcJf','listen','get-starting-balances','File\x20uploaded','generate','storeHeadless','Server','telegram','live','static','reject','toString','restart_','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','length','toggle-bot-mode','output-001.log','Password\x20has\x20been\x20reset\x20to:\x20','bot.js','on_','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','output-003.log','DEFLATE','Network\x20Interfaces:','0.0.0','isIPv4MappedAddress','notification','private','isValid','\x1b[34m','-events.json','Invalid\x20authentication\x20token\x20(1)','decrypt','bot','track','telegramIpApproval','exec','Unauthorized\x20attempt\x20to\x20confirm\x20message','temporaryAccessAllowed','date-fns','store-configuration','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','headers','Session\x20expired\x20for\x20user\x20...','17381736ZyeeWS','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','\x20mode','mixpanel','backupfile','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','server','start','emitHistory','value','BM\x20received\x20sigint\x20signal','113251RtYNrR','crypto','/:bot/performance','<b>Balance\x20Bot\x20Status:</b>\x0a','place-order','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','name','verify','2FA\x20login\x20rejected','Starting\x20(','alerts','telegram2FaApproval','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','5\x20min','headless','-config.json','min','disable','enable','get-logs','Yes','/download/:type','hasOwnProperty','Allow\x20login\x20from\x20IP\x20address\x20','restart','isDirectory','disabled','accept','Deleted\x20Bot\x20','sendMetricsTelegram','bots','\x20(1)','split','apiKey','\x20>\x20','getDate','No\x20bots\x20running\x20right\x20now','full','tkn','restore_yes_','resetpw_no','build2','messages','tempaccess_5_','createWriteStream','/:bot','statSync','Notifications\x20disabled\x0a','whitelist','search','new','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','initclient','30\x20min','stop','kill','NTBA_FIX_319','store','sha256','/:bot/portfolio','2FA\x20login\x20required','sendPortfolioTelegram','getStartingBalances','Unauthorized\x20attempt\x20to\x20update\x20settings','getHours','telegramEnabled','internal','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','uncaughtException','botname','sortBy','<b>Telegram\x20Bot\x20Status:</b>\x0a','confirm-message','lastmsgemitted','/status\x20-\x20show\x20bot(s)\x20status\x0a','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','file','argv','sendMessage','::1','delete-alerts','Idling\x20(','=>\x20Go\x20to\x20#CYA#http://','*$1*','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','match','#RES#\x20','get-backup-files','\x20(2)','Restoring\x20bot(s)\x20from\x20backup','from','2FA\x20login\x20token\x20generated','reload','login\x20token\x20generated','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','All','bb/','User\x20has\x20been\x20validated','generateKeyPairAsync','startsWith','output-000.log','show','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','telegramUsername','Disabled\x20Bot\x20','yes','RSA','Unauthorized\x20attempt\x20to\x20log\x20out','(staging)','No\x20authentication\x20token','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','SIGINT','help','password','Notifications\x20enabled\x0a','Ok,\x20will\x20send\x20alert\x20notifications\x20only','write','/output-000.log','fork','disconnect','\x20|\x20user:\x20...','tempaccess_reject_','secure','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','output-002.log','login\x20required','debug','send','mode','uuid','update','Token\x20blacklisted','Orders','secret','bbUsername','sort','15\x20min','reset-history','blacklist','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','endsWith','Starting\x20new\x20bot\x20|\x20Bot\x20','64038vxSOKN','pidRefreshToken','\x20only\x0a','node-zip','orders','apiPassword','version','backup-full','settings.','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','/restart\x20-\x20restart\x20bot(s)\x0a','find','bb-settings.json','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history',':\x20Bot\x20Mgr\x20>\x20','reason','Starting\x20Balance\x20Bot\x20reinstallation','conn','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','staging','Unauthorized\x20attempt\x20to\x20download\x20','expiry','6b67f3d61ee94b8f5c80b4affef4c4d9','all','backup/','family','deleteHistoryAlerts','exchange','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','store-headless','/names\x20-\x20show\x20bot\x20names\x0a','login\x20not\x20required','status','All\x20bots\x20running\x20right\x20now','existsSync','get','connected','getFullYear','error','timestamp','************','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','metrics','/update\x20-\x20update\x20Balance\x20Bot\x0a','Alerts','alias','delete-bot','mkdirSync','\x1b[36m','off','toggle','backup','join','inlineKeyboard','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','yargs/yargs','referer','Notifications\x20enabled','userid','Setting\x20access:\x20','reinstall_no','includes','mtime','tempaccess_30_','data','backup-full.zip','function','exit','token','auth','button','127.0.0.1','Unauthorized\x20attempt\x20to\x20show\x20configuration','Node.js\x20v','parse','temporary\x20access\x20rejected','Restore\x20backup\x20file\x20','number','portfolio_','getSeconds','storeConfiguration','login2fa_reject_','allow','Unauthorized\x20attempt\x20to\x20get\x20events','handshake','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','size','lastmsgtelegram','\x1b[0m','login','user','access','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','child_process','/disable\x20-\x20disable\x20notifications\x0a','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Error\x20while\x20deleting\x20config\x20files:\x20','config_all','push','success','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','bbPassword','unlinkSync','log','invalid\x20credentials','format','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','binary','once','logged\x20out','bbvReceive','telegrammsg','Unauthorized\x20attempt\x20to\x20update\x20bot','Invalid\x20IP\x20address','privateKey','reinstall-bb','use','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','whitelistEnabled','metrics_','-----------------------------------------------------------------------------------','hashSync','backup-files','568500EkYyKD','restore-backup-file','getMinutes','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','keys','Logged\x20in\x20user\x20...','getMonth','botID','settings','[ip-address]','remove','node','getTime','config_orders'];_0x4b98=function(){return _0x5fe71b;};return _0x4b98();}function startSocket(){io['on']('connection',_0x42c27a=>{const _0x253770=_0x56ff;let _0x1233d4,_0x1b94fe,_0x4ba419,_0x3da716,_0x3f0c81;const _0x4ad142=_0x42c27a[_0x253770(0x242)][_0x253770(0x152)][_0x253770(0x226)];_0x1b94fe=_0x4ad142[_0x253770(0x1b4)](/bot[0-9]{3}/);if(_0x1b94fe)_0x4ba419=_0x1b94fe[0x0][_0x253770(0x1b4)](/[0-9]{3}/);if(_0x4ba419)_0x1233d4=_0x4ba419[0x0];else _0x1233d4='botmanager';const _0x11068a=_0x42c27a[_0x253770(0x242)][_0x253770(0x233)][_0x253770(0x29b)];if(!_0x11068a)_0x42c27a[_0x253770(0x315)](_0x253770(0x20e),{'publicKey':secure[_0x253770(0x31c)]});else{_0x3da716=timelyDecrypt(_0x11068a,![]);if(!_0x3da716)_0x42c27a[_0x253770(0x315)](_0x253770(0x20e),{'publicKey':secure['publicKey']});else{_0x3f0c81=normalizeIP(_0x42c27a[_0x253770(0x1fe)][_0x253770(0x2d5)])[_0x253770(0x198)];if(!devices[_0x3da716])devices[_0x3da716]={'uuid':_0x3da716,'access':{'token':null}};devices[_0x3da716]['ip']=_0x3f0c81;const _0x2bf4af=addClient(_0x42c27a['id'],_0x3da716,_0x1233d4);setAccess(_0x2bf4af),emitMessages(),_0x42c27a['on'](_0x253770(0x247),_0x390855=>{const _0xefb73c=_0x253770,_0x3c1f5e=timelyDecrypt(_0x390855[_0xefb73c(0x1d0)]);if(_0x3c1f5e){_0x390855={'username':_0x390855[_0xefb73c(0x2c0)],'password':_0x3c1f5e},devices[_0x3da716]['access']=validateCredentials(_0x390855,_0x3da716);if(devices[_0x3da716][_0xefb73c(0x249)][_0xefb73c(0x240)]==![]&&devices[_0x3da716][_0xefb73c(0x249)][_0xefb73c(0x1fc)]==_0xefb73c(0x19b))_0x42c27a[_0xefb73c(0x315)](_0xefb73c(0x20e),{'access':devices[_0x3da716]['access']}),loginAccess2FA(_0x3da716,_0x3f0c81);else{if(devices[_0x3da716]['access'][_0xefb73c(0x240)]==![]&&devices[_0x3da716][_0xefb73c(0x249)][_0xefb73c(0x1fc)]=='invalid\x20credentials')_0x42c27a[_0xefb73c(0x315)](_0xefb73c(0x20e),{'access':devices[_0x3da716][_0xefb73c(0x249)]});else devices[_0x3da716]['access'][_0xefb73c(0x240)]&&devices[_0x3da716][_0xefb73c(0x249)]['reason']==_0xefb73c(0x1bc)&&(getClientsWithUuid(_0x3da716)['forEach'](_0x14d727=>{setAccess(_0x14d727);}),logger['debug'](_0xefb73c(0x26f)+_0x3da716['slice'](-0x8)),setTokenRefresh(_0x3da716),setSessionTimeout('login',_0x3da716));}}else logger['full'](_0xefb73c(0x2a2));}),_0x42c27a['on']('reset-password',()=>{resetPassword();}),_0x42c27a['on'](_0x253770(0x1d6),_0x3838d1=>{removeClient(_0x42c27a['id']);}),_0x1233d4==_0x253770(0x301)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x30c240){const _0x21e5a6=_0x1ba0fc;if(_0x30c240!=_0x21e5a6(0x301)&&config[_0x21e5a6(0x180)]!=''){if(pid[_0x30c240])pid[_0x30c240][_0x21e5a6(0x1de)]({'function':_0x21e5a6(0x193),'args':null});}_0x30c240!=_0x21e5a6(0x301)&&broadcastToBots('bots',JSON[_0x21e5a6(0x32e)](config));}function reloadBotManager(){const _0x526bf1=_0x1ba0fc;getClientsWithBotID(_0x526bf1(0x301))[_0x526bf1(0x28a)](_0x2a1c54=>{const _0x4dbd39=_0x526bf1;getSocket(_0x2a1c54['id'])[_0x4dbd39(0x315)](_0x4dbd39(0x20e),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x275f2a){const _0x5e5c91=_0x1ba0fc;return io[_0x5e5c91(0x27b)][_0x5e5c91(0x27b)][_0x5e5c91(0x211)](_0x275f2a);}function setAccess(_0x331602){const _0x4309ea=_0x1ba0fc,_0x23c56c=getSocket(_0x331602['id']),_0x329caa=_0x331602[_0x4309ea(0x1e0)],_0x33b224=_0x331602[_0x4309ea(0x149)];devices[_0x329caa]['access']=validateAccess(devices[_0x329caa][_0x4309ea(0x249)][_0x4309ea(0x232)],_0x329caa),logger[_0x4309ea(0x1dd)](_0x4309ea(0x229)+devices[_0x329caa][_0x4309ea(0x249)]['reason']+_0x4309ea(0x2ed)+_0x331602['id'][_0x4309ea(0x2b9)](-0x8)+_0x4309ea(0x1d7)+_0x329caa[_0x4309ea(0x2b9)](-0x8)),_0x23c56c[_0x4309ea(0x222)](_0x329caa);if(devices[_0x329caa][_0x4309ea(0x249)][_0x4309ea(0x240)]){_0x23c56c[_0x4309ea(0x222)](_0x33b224);if(_0x33b224==_0x4309ea(0x301))initializeSocketBotManager(_0x23c56c);else initializeSocketBot(_0x23c56c);initClient(_0x33b224);}devices[_0x329caa][_0x4309ea(0x249)]['token']&&devices[_0x329caa]['access'][_0x4309ea(0x1fc)]==_0x4309ea(0x2af)&&setSessionTimeout('2FA',_0x329caa),devices[_0x329caa][_0x4309ea(0x249)][_0x4309ea(0x232)]&&devices[_0x329caa]['access'][_0x4309ea(0x1fc)]==_0x4309ea(0x1ba)&&setSessionTimeout(_0x4309ea(0x247),_0x329caa),_0x23c56c[_0x4309ea(0x315)]('status',{'status':_0x331602[_0x4309ea(0x15a)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x329caa][_0x4309ea(0x249)],'externalip':devices[_0x329caa]['ip'],'publicKey':secure[_0x4309ea(0x31c)],'userid':settings[_0x4309ea(0x228)],'validInstallation':validInstallation}),devices[_0x329caa][_0x4309ea(0x249)][_0x4309ea(0x240)]==![]&&devices[_0x329caa][_0x4309ea(0x249)][_0x4309ea(0x1fc)]==_0x4309ea(0x2ac)&&temporaryAccess2FA(_0x329caa,devices[_0x329caa]['ip']);}function setSessionTimeout(_0x409c07,_0x1192bc){const _0x82bacf=_0x1ba0fc;let _0x59e912;if(_0x409c07==_0x82bacf(0x247))_0x59e912=loginExpiry*0x3c*0x3e8;else _0x59e912=devices[_0x1192bc][_0x82bacf(0x14b)]['expiry']*0x3c*0x3e8-(new Date()[_0x82bacf(0x276)]()-devices[_0x1192bc][_0x82bacf(0x14b)][_0x82bacf(0x215)]);if(devices[_0x1192bc]['pidExpireLogin'])clearTimeout(devices[_0x1192bc]['pidExpireLogin']);devices[_0x1192bc]['pidExpireLogin']=setTimeout(()=>{const _0x3687c8=_0x82bacf;if(devices[_0x1192bc]['pidRefreshToken'])clearTimeout(devices[_0x1192bc]['pidRefreshToken']);removeSocketListeners(_0x1192bc),addBlacklist(_0x1192bc),devices[_0x1192bc][_0x3687c8(0x14b)]=null,devices[_0x1192bc][_0x3687c8(0x16a)]=null,devices[_0x1192bc]['access'][_0x3687c8(0x232)]=null,logger[_0x3687c8(0x1dd)](_0x3687c8(0x153)+_0x1192bc[_0x3687c8(0x2b9)](-0x8)),devices[_0x1192bc][_0x3687c8(0x249)]=validateAccess(devices[_0x1192bc][_0x3687c8(0x249)]['token'],_0x1192bc),!(devices[_0x1192bc][_0x3687c8(0x249)]['allow']&&devices[_0x1192bc][_0x3687c8(0x249)][_0x3687c8(0x1fc)]==_0x3687c8(0x20d))&&(_0x409c07==_0x3687c8(0x247)?io['to'](_0x1192bc)[_0x3687c8(0x315)](_0x3687c8(0x20e),{'access':{'allow':![],'reason':_0x3687c8(0x2b7),'token':null}}):io['to'](_0x1192bc)[_0x3687c8(0x315)]('status',{'access':{'allow':![],'reason':_0x3687c8(0x330),'token':null}})),devices[_0x1192bc][_0x3687c8(0x249)]['token']=null;},_0x59e912);}function setTokenRefresh(_0x3f1c7c){const _0x1c662f=_0x1ba0fc;if(devices[_0x3f1c7c]['pidRefreshToken'])clearTimeout(devices[_0x3f1c7c][_0x1c662f(0x1ee)]);devices[_0x3f1c7c]['pidRefreshToken']=setTimeout(()=>{const _0x5df0e8=_0x1c662f;getClientsWithUuid(_0x3f1c7c)['length']!=0x0?(devices[_0x3f1c7c][_0x5df0e8(0x249)]=refreshToken(_0x3f1c7c),io['to'](_0x3f1c7c)['emit'](_0x5df0e8(0x20e),{'status':_0x5df0e8(0x212),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3f1c7c]['access'],'externalip':devices[_0x3f1c7c]['ip'],'publicKey':secure[_0x5df0e8(0x31c)],'validInstallation':validInstallation}),setTokenRefresh(_0x3f1c7c)):clearTimeout(devices[_0x3f1c7c]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3c3cb8){const _0x5b1d05=_0x1ba0fc,_0x37a028=getClient(_0x3c3cb8['id'])[_0x5b1d05(0x1e0)];_0x3c3cb8['emit'](_0x5b1d05(0x17d),config),_0x3c3cb8[_0x5b1d05(0x315)](_0x5b1d05(0x272),cleanSettings()),_0x3c3cb8['on']('add-bot',_0x207365=>{const _0x31edaf=_0x5b1d05;if(validateAccess(_0x207365,_0x37a028)[_0x31edaf(0x240)])addBot();else logger[_0x31edaf(0x184)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x3c3cb8['on']('update-bot',(_0x2120df,_0x4360d3)=>{const _0x33b80a=_0x5b1d05;if(validateAccess(_0x4360d3,_0x37a028)['allow'])toggleBot(_0x2120df[_0x33b80a(0x271)],_0x2120df[_0x33b80a(0x20e)],_0x2120df['live']);else logger[_0x33b80a(0x184)](_0x33b80a(0x25e));}),_0x3c3cb8['on'](_0x5b1d05(0x344),(_0x5cd05a,_0x4a50b4)=>{const _0x14d76a=_0x5b1d05;if(validateAccess(_0x4a50b4,_0x37a028)[_0x14d76a(0x240)])toggleBotMode(_0x5cd05a);else logger[_0x14d76a(0x184)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x3c3cb8['on'](_0x5b1d05(0x21c),(_0x4c5184,_0x3ef578)=>{const _0x149326=_0x5b1d05;if(validateAccess(_0x3ef578,_0x37a028)[_0x149326(0x240)])deleteBot(_0x4c5184);else logger[_0x149326(0x184)](_0x149326(0x28d));}),_0x3c3cb8['on']('store-settings',(_0x32161c,_0x2fc1ab)=>{const _0xf1feca=_0x5b1d05;if(validateAccess(_0x2fc1ab,_0x37a028)[_0xf1feca(0x240)])storeSettings(_0x32161c,!![]);else logger[_0xf1feca(0x184)](_0xf1feca(0x19e));}),_0x3c3cb8['on'](_0x5b1d05(0x2f3),_0x1b2098=>{const _0x42426d=_0x5b1d05;if(validateAccess(_0x1b2098,_0x37a028)[_0x42426d(0x240)])updateBB('update');else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x3c3cb8['on'](_0x5b1d05(0x261),_0x4fc5d0=>{const _0x9abda6=_0x5b1d05;if(validateAccess(_0x4fc5d0,_0x37a028)[_0x9abda6(0x240)])updateBB(_0x9abda6(0x2dc));else logger[_0x9abda6(0x184)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x3c3cb8['on'](_0x5b1d05(0x1b6),_0x50fadd=>{const _0x3b66b7=_0x5b1d05;if(validateAccess(_0x50fadd,_0x37a028)[_0x3b66b7(0x240)]){const _0x1ce485=getClient(_0x3c3cb8['id']);if(_0x1ce485)getBackupFiles(_0x1ce485[_0x3b66b7(0x1e0)]);else logger['full'](_0x3b66b7(0x252));}else logger['full'](_0x3b66b7(0x13c));}),_0x3c3cb8['on'](_0x5b1d05(0x26a),(_0x3ee2ee,_0x27bf17)=>{const _0x3f1157=_0x5b1d05;if(validateAccess(_0x27bf17,_0x37a028)[_0x3f1157(0x240)])restoreBackupFile(_0x3ee2ee);else logger['full'](_0x3f1157(0x16b));}),_0x3c3cb8['on'](_0x5b1d05(0x2fe),_0x336415=>{const _0x552f9e=_0x5b1d05;if(validateAccess(_0x336415,_0x37a028)[_0x552f9e(0x240)])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x3c3cb8['on'](_0x5b1d05(0x1a7),(_0x2e5364,_0x52c6cc)=>{const _0x4d17d4=_0x5b1d05;if(validateAccess(_0x52c6cc,_0x37a028)['allow'])confirmMessage(_0x2e5364);else logger[_0x4d17d4(0x184)](_0x4d17d4(0x14d));}),_0x3c3cb8['on']('logout',_0x23d403=>{const _0x506ee9=_0x5b1d05;if(validateAccess(_0x23d403,_0x37a028)[_0x506ee9(0x240)]){if(devices[_0x37a028][_0x506ee9(0x1ee)])clearTimeout(devices[_0x37a028][_0x506ee9(0x1ee)]);if(devices[_0x37a028][_0x506ee9(0x2e7)])clearTimeout(devices[_0x37a028][_0x506ee9(0x2e7)]);removeSocketListeners(getClient(_0x3c3cb8['id'])['uuid']),addBlacklist(_0x37a028),devices[_0x37a028][_0x506ee9(0x14b)]=null,devices[_0x37a028]['telegram2FaApproval']=null,devices[_0x37a028][_0x506ee9(0x249)]['token']=null,logger[_0x506ee9(0x1dd)](_0x506ee9(0x32b)+_0x37a028[_0x506ee9(0x2b9)](-0x8)),io['to'](getClient(_0x3c3cb8['id'])[_0x506ee9(0x1e0)])[_0x506ee9(0x315)](_0x506ee9(0x20e),{'access':{'allow':![],'reason':_0x506ee9(0x25b),'token':null}});}else logger[_0x506ee9(0x184)](_0x506ee9(0x1ca));});}function initializeSocketBot(_0x51c5c9){const _0x3dd4c6=_0x1ba0fc,_0xeb8325=getClient(_0x51c5c9['id'])[_0x3dd4c6(0x149)],_0x5cdf60=getClient(_0x51c5c9['id'])[_0x3dd4c6(0x1e0)];_0x51c5c9['on'](_0x3dd4c6(0x172),(_0x3b403d,_0x58d7e3)=>{const _0x26a808=_0x3dd4c6;if(validateAccess(_0x58d7e3,_0x5cdf60)['allow']){if(pid[_0xeb8325])pid[_0xeb8325][_0x26a808(0x1de)]({'function':_0x26a808(0x15c),'args':_0x3b403d});}else logger['full'](_0x26a808(0x241));}),_0x51c5c9['on'](_0x3dd4c6(0x1af),(_0xd3416a,_0x22f6a2)=>{const _0x580fdf=_0x3dd4c6;if(validateAccess(_0x22f6a2,_0x5cdf60)[_0x580fdf(0x240)]){if(pid[_0xeb8325])pid[_0xeb8325][_0x580fdf(0x1de)]({'function':_0x580fdf(0x207),'args':_0xd3416a});}else logger['full'](_0x580fdf(0x313));}),_0x51c5c9['on'](_0x3dd4c6(0x2bd),(_0x8cb6ca,_0x507d94)=>{const _0x45727f=_0x3dd4c6;if(validateAccess(_0x507d94,_0x5cdf60)['allow']){if(pid[_0xeb8325])pid[_0xeb8325][_0x45727f(0x1de)]({'function':_0x45727f(0x29e),'args':_0x8cb6ca});}else logger[_0x45727f(0x184)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x51c5c9['on'](_0x3dd4c6(0x150),(_0x598f28,_0x2497e0)=>{const _0x2eb1ca=_0x3dd4c6;if(validateAccess(_0x2497e0,_0x5cdf60)[_0x2eb1ca(0x240)]){if(pid[_0xeb8325])pid[_0xeb8325][_0x2eb1ca(0x1de)]({'function':_0x2eb1ca(0x23e),'args':_0x598f28});}else logger[_0x2eb1ca(0x184)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x51c5c9['on'](_0x3dd4c6(0x20b),(_0x5a5649,_0x5721bf)=>{const _0x57d55a=_0x3dd4c6;if(validateAccess(_0x5721bf,_0x5cdf60)['allow']){if(pid[_0xeb8325])pid[_0xeb8325]['send']({'function':_0x57d55a(0x33a),'args':_0x5a5649});}else logger['full'](_0x57d55a(0x1aa));}),_0x51c5c9['on'](_0x3dd4c6(0x28b),(_0x365e36,_0x27829a)=>{const _0x587d28=_0x3dd4c6;if(validateAccess(_0x27829a,_0x5cdf60)[_0x587d28(0x240)]){if(pid[_0xeb8325])pid[_0xeb8325][_0x587d28(0x1de)]({'function':'storeFiat','args':_0x365e36});}else logger[_0x587d28(0x184)](_0x587d28(0x217));}),_0x51c5c9['on'](_0x3dd4c6(0x1e8),_0x9f68d1=>{const _0x36fb3b=_0x3dd4c6;if(validateAccess(_0x9f68d1,_0x5cdf60)[_0x36fb3b(0x240)]){if(pid[_0xeb8325])pid[_0xeb8325][_0x36fb3b(0x1de)]({'function':'resetHistory','args':null});}else logger[_0x36fb3b(0x184)](_0x36fb3b(0x1fa));}),_0x51c5c9['on'](_0x3dd4c6(0x337),_0x67c808=>{const _0x1c919c=_0x3dd4c6;if(validateAccess(_0x67c808,_0x5cdf60)[_0x1c919c(0x240)]){if(pid[_0xeb8325])pid[_0xeb8325][_0x1c919c(0x1de)]({'function':_0x1c919c(0x19d),'args':null});}else logger[_0x1c919c(0x184)](_0x1c919c(0x280));}),_0x51c5c9['on'](_0x3dd4c6(0x163),(_0x591e75,_0x29f9fd)=>{const _0x52eb97=_0x3dd4c6;if(validateAccess(_0x29f9fd,_0x5cdf60)[_0x52eb97(0x240)]){if(pid[_0xeb8325])pid[_0xeb8325][_0x52eb97(0x1de)]({'function':'placeOrder','args':_0x591e75});}else logger['full'](_0x52eb97(0x2c1));}),_0x51c5c9['on']('cancel-loading',_0x56fb36=>{const _0x2a30b9=_0x3dd4c6;if(validateAccess(_0x56fb36,_0x5cdf60)[_0x2a30b9(0x240)]){if(pid[_0xeb8325])pid[_0xeb8325][_0x2a30b9(0x1de)]({'function':'cancelLoading','args':null});}else logger[_0x2a30b9(0x184)](_0x2a30b9(0x26d));}),_0x51c5c9['on'](_0x3dd4c6(0x2e1),_0x465cf3=>{const _0x2839d6=_0x3dd4c6;if(validateAccess(_0x465cf3,_0x5cdf60)['allow']){if(pid[_0xeb8325])pid[_0xeb8325][_0x2839d6(0x1de)]({'function':_0x2839d6(0x2e5),'args':null});}else logger[_0x2839d6(0x184)](_0x2839d6(0x236));}),_0x51c5c9['on'](_0x3dd4c6(0x2f3),_0x565212=>{const _0x3c3811=_0x3dd4c6;if(validateAccess(_0x565212,_0x5cdf60)[_0x3c3811(0x240)])updateBB(_0x3c3811(0x1e1));else logger[_0x3c3811(0x184)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x51c5c9['on'](_0x3dd4c6(0x2fe),_0x33a057=>{const _0x38f2c5=_0x3dd4c6;if(validateAccess(_0x33a057,_0x5cdf60)['allow'])getMessages();else logger[_0x38f2c5(0x184)](_0x38f2c5(0x30a));}),_0x51c5c9['on'](_0x3dd4c6(0x1a7),(_0x16702e,_0x5f202f)=>{const _0x2de50e=_0x3dd4c6;if(validateAccess(_0x5f202f,_0x5cdf60)[_0x2de50e(0x240)])confirmMessage(_0x16702e);else logger[_0x2de50e(0x184)](_0x2de50e(0x14d));}),_0x51c5c9['on'](_0x3dd4c6(0x2e6),_0x37ab34=>{const _0x559d10=_0x3dd4c6;if(validateAccess(_0x37ab34,_0x5cdf60)[_0x559d10(0x240)]){if(devices[_0x5cdf60][_0x559d10(0x1ee)])clearTimeout(devices[_0x5cdf60][_0x559d10(0x1ee)]);if(devices[_0x5cdf60][_0x559d10(0x2e7)])clearTimeout(devices[_0x5cdf60][_0x559d10(0x2e7)]);removeSocketListeners(getClient(_0x51c5c9['id'])[_0x559d10(0x1e0)]),addBlacklist(_0x5cdf60),devices[_0x5cdf60][_0x559d10(0x14b)]=null,devices[_0x5cdf60]['telegram2FaApproval']=null,devices[_0x5cdf60]['access'][_0x559d10(0x232)]=null,logger[_0x559d10(0x1dd)](_0x559d10(0x32b)+_0x5cdf60[_0x559d10(0x2b9)](-0x8)),io['to'](getClient(_0x51c5c9['id'])[_0x559d10(0x1e0)])[_0x559d10(0x315)](_0x559d10(0x20e),{'access':{'allow':![],'reason':_0x559d10(0x25b),'token':null}});}else logger['full'](_0x559d10(0x1ca));});}function removeSocketListeners(_0x405094){const _0x44a686=_0x1ba0fc;getClientsWithUuid(_0x405094)[_0x44a686(0x28a)](_0x463e68=>{getSocket(_0x463e68['id'])['removeAllListeners']();});}function cleanSettings(){const _0x53a8e1=_0x1ba0fc;let _0x2046d7=settings;return settings[_0x53a8e1(0x298)]&&settings[_0x53a8e1(0x298)]!=''&&(_0x2046d7={..._0x2046d7,'telegramToken':_0x53a8e1(0x216)}),settings[_0x53a8e1(0x253)]&&settings[_0x53a8e1(0x253)]!=''&&(_0x2046d7={..._0x2046d7,'bbPassword':_0x53a8e1(0x216)}),(settings['bbPassword']&&settings[_0x53a8e1(0x253)]==_0x53a8e1(0x2b0)||settings[_0x53a8e1(0x298)]&&settings[_0x53a8e1(0x298)]=='***')&&(_0x2046d7={..._0x2046d7,'restored':{'password':settings[_0x53a8e1(0x253)]==_0x53a8e1(0x2b0),'telegram':settings[_0x53a8e1(0x298)]=='***'}}),_0x2046d7;}async function updateBB(_0x8bbd08){const _0x3f3eae=_0x1ba0fc;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x327a6e=>{const _0x5bb007=_0x56ff;restartBot(_0x327a6e[_0x5bb007(0x271)]);});if(_0x8bbd08==_0x3f3eae(0x1e1))process['send']({'update':!![],'environment':environment},_0x50b806=>{});else _0x8bbd08=='reinstall'&&process[_0x3f3eae(0x1de)]({'reinstall':!![],'environment':environment},_0x53a955=>{});}function startBot(_0x2be4c6,_0x229105,_0x5c69bb){const _0x349bda=_0x1ba0fc;if(debugging)_0x2be4c6['push']('-d');let _0x471e0c=![];const _0x5f1bee=_0x2be4c6[0x0];_0x229105={..._0x229105,'stdio':['inherit',_0x349bda(0x29a),_0x349bda(0x29a),_0x349bda(0x2d2)]},pid[_0x5f1bee]=childProcess[_0x349bda(0x1d5)](botfile,_0x2be4c6,_0x229105),pid[_0x5f1bee]['on'](_0x349bda(0x2df),_0x5bdf7b=>{const _0x4e43e2=_0x349bda;switch(Object[_0x4e43e2(0x26e)](_0x5bdf7b)[0x0]){case'botname':updateBotName(_0x5f1bee,_0x5bdf7b[_0x4e43e2(0x1a4)]);break;case'updatebotmanager':updateBotManager();break;case'status':updateStatus(_0x5f1bee,_0x5bdf7b['status']);break;case'live':updateLive(_0x5f1bee,_0x5bdf7b[_0x4e43e2(0x33d)]);break;case _0x4e43e2(0x2c3):updateLive(_0x5f1bee,_0x5bdf7b[_0x4e43e2(0x2c3)]),io['to'](_0x5f1bee)[_0x4e43e2(0x315)]('status',{'access':{'allow':![],'reason':_0x4e43e2(0x1bb),'token':null}});break;case'stop':_0x5bdf7b[_0x4e43e2(0x195)]==_0x4e43e2(0x177)&&restartBot(_0x5f1bee);_0x5bdf7b[_0x4e43e2(0x195)]==_0x4e43e2(0x196)&&toggleBot(_0x5f1bee,'disabled',_0x4e43e2(0x2bc));break;case _0x4e43e2(0x33c):sendTelegramBot(_0x5f1bee,_0x5bdf7b['telegram']);break;case'telegrammsg':sendTelegramMsg(_0x5bdf7b[_0x4e43e2(0x25d)]);break;case _0x4e43e2(0x230):io['to'](_0x5f1bee)[_0x4e43e2(0x315)](_0x5bdf7b['function'],_0x5bdf7b['args']);break;}}),pid[_0x5f1bee]['on'](_0x349bda(0x214),function(_0x45012d){if(_0x471e0c)return;_0x471e0c=!![],_0x5c69bb(_0x45012d);}),pid[_0x5f1bee]['on'](_0x349bda(0x231),async function(_0x3e8d02){const _0x36391f=_0x349bda;if(terminating)return;if(installingUpdate){logger['debug'](_0x36391f(0x263)),io[_0x36391f(0x2a8)]();return;}if(_0x471e0c)return;_0x471e0c=!![],_0x5c69bb(null);const _0x5bfc9a=dbConfig[_0x36391f(0x211)](_0x36391f(0x17d))['find']({'botID':_0x5f1bee})[_0x36391f(0x15d)]();_0x5bfc9a&&(_0x5bfc9a['status']==_0x36391f(0x331)||_0x5bfc9a['status']==_0x36391f(0x191))&&(await sleep(0x3e8),updateLive(_0x5f1bee,_0x36391f(0x2bc)),logger['full'](_0x36391f(0x2b1)+_0x5f1bee),startBot([_0x5f1bee,userID],{'cwd':bbpath},function(_0x47964e){if(_0x47964e)logger['full'](_0x47964e);}));});}function stopBot(_0x2b9068){const _0x5355d7=_0x1ba0fc;getClientsWithBotID(_0x2b9068)['forEach'](_0xa5a519=>{const _0x9c2dd3=_0x56ff;getSocket(_0xa5a519['id'])[_0x9c2dd3(0x1d6)](!![]),removeClient(_0xa5a519['id']);}),pid[_0x2b9068]&&(pid[_0x2b9068][_0x5355d7(0x196)](),pid[_0x2b9068]=null);}function stopAllBots(){const _0x10114d=_0x1ba0fc;terminating=!![];const _0x28cbd3=getEnabledBots();_0x28cbd3[_0x10114d(0x28a)](_0x1ec50e=>{const _0x253409=_0x10114d;stopBot(_0x1ec50e[_0x253409(0x271)]);});}function restartBot(_0x5e6cd9){const _0x4eaeb3=_0x1ba0fc;if(pid[_0x5e6cd9])pid[_0x5e6cd9][_0x4eaeb3(0x196)]();}function addBot(){const _0x4d37e1=_0x1ba0fc;let _0x32bff3;for(let _0x352ba0=0x1;_0x352ba0<0x3e9;_0x352ba0++){_0x32bff3=_0x352ba0[_0x4d37e1(0x340)]()[_0x4d37e1(0x32f)](0x3,'0');let _0x46daa7=config['find'](_0x5908e5=>_0x5908e5[_0x4d37e1(0x271)]==_0x32bff3);if(!_0x46daa7)break;}if(_0x32bff3===_0x4d37e1(0x304)){logger[_0x4d37e1(0x184)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger['full'](_0x4d37e1(0x1ec)+_0x32bff3),dbConfig[_0x4d37e1(0x211)](_0x4d37e1(0x17d))[_0x4d37e1(0x250)]({'botID':_0x32bff3,'botname':_0x4d37e1(0x2aa)+_0x32bff3,'status':'new','live':''})[_0x4d37e1(0x1d3)](),startBot([_0x32bff3,userID],{'cwd':bbpath},function(_0x25cf73){const _0x399ef9=_0x4d37e1;if(_0x25cf73)logger[_0x399ef9(0x184)](_0x25cf73);}),config=getConfiguration(),io['to'](_0x4d37e1(0x301))[_0x4d37e1(0x315)](_0x4d37e1(0x17d),config),broadcastToBots('bots',JSON[_0x4d37e1(0x32e)](config));}function deleteBot(_0x3cf63f){const _0x2dd2ee=_0x1ba0fc;getClientsWithBotID(_0x3cf63f)[_0x2dd2ee(0x28a)](_0x5de828=>{const _0x5484ca=_0x2dd2ee;getSocket(_0x5de828['id'])[_0x5484ca(0x1d6)](!![]),removeClient(_0x5de828['id']);}),dbConfig['get'](_0x2dd2ee(0x17d))[_0x2dd2ee(0x274)]({'botID':_0x3cf63f})['write'](),logger[_0x2dd2ee(0x184)](_0x2dd2ee(0x17b)+_0x3cf63f),stopBot(_0x3cf63f);try{if(fs[_0x2dd2ee(0x210)](path[_0x2dd2ee(0x222)](configpath,_0x2dd2ee(0x2be)+_0x3cf63f+_0x2dd2ee(0x16e))))fs['unlinkSync'](path[_0x2dd2ee(0x222)](configpath,'bot-'+_0x3cf63f+_0x2dd2ee(0x16e)));if(fs[_0x2dd2ee(0x210)](path[_0x2dd2ee(0x222)](configpath,_0x2dd2ee(0x2be)+_0x3cf63f+'-events.json')))fs[_0x2dd2ee(0x254)](path[_0x2dd2ee(0x222)](configpath,'bot-'+_0x3cf63f+_0x2dd2ee(0x146)));if(fs['existsSync'](path[_0x2dd2ee(0x222)](configpath,_0x2dd2ee(0x2be)+_0x3cf63f+_0x2dd2ee(0x2a4))))fs[_0x2dd2ee(0x254)](path[_0x2dd2ee(0x222)](configpath,_0x2dd2ee(0x2be)+_0x3cf63f+_0x2dd2ee(0x2a4)));if(fs[_0x2dd2ee(0x210)](path[_0x2dd2ee(0x222)](configpath,_0x2dd2ee(0x2be)+_0x3cf63f+'-results.json')))fs[_0x2dd2ee(0x254)](path[_0x2dd2ee(0x222)](configpath,_0x2dd2ee(0x2be)+_0x3cf63f+'-results.json'));}catch(_0x3d6f0b){if(_0x3d6f0b)logger['full'](_0x2dd2ee(0x24e),_0x3d6f0b);}config=getConfiguration(),io['to'](_0x2dd2ee(0x301))[_0x2dd2ee(0x315)](_0x2dd2ee(0x17d),config),broadcastToBots(_0x2dd2ee(0x17d),JSON[_0x2dd2ee(0x32e)](config));}function toggleBot(_0x576ca9,_0x494eac,_0x24937b){const _0x4fb469=_0x1ba0fc;dbConfig['get']('bots')[_0x4fb469(0x1f8)]({'botID':_0x576ca9})[_0x4fb469(0x2c5)]({'status':_0x494eac})[_0x4fb469(0x2c5)]({'live':_0x24937b})[_0x4fb469(0x1d3)]();if(_0x494eac=='enabled'||_0x494eac=='new')logger[_0x4fb469(0x184)](_0x4fb469(0x2a1)+_0x576ca9),startBot([_0x576ca9,userID],{'cwd':bbpath},function(_0x1d5531){const _0x5e086b=_0x4fb469;if(_0x1d5531)logger[_0x5e086b(0x184)](_0x1d5531);});else(_0x494eac=='disabled'||_0x494eac=='new-disabled')&&(logger['full'](_0x4fb469(0x1c7)+_0x576ca9),stopBot(_0x576ca9));config=getConfiguration(),io['to'](_0x4fb469(0x301))[_0x4fb469(0x315)]('bots',config),broadcastToBots(_0x4fb469(0x17d),JSON[_0x4fb469(0x32e)](config));}function toggleStatus(_0x8b27f){const _0x342fc0=_0x1ba0fc;let _0x208699=dbConfig[_0x342fc0(0x211)](_0x342fc0(0x17d))['find']({'botID':_0x8b27f})[_0x342fc0(0x15d)](),_0x55528e;if(_0x208699['status']===_0x342fc0(0x331))_0x55528e=_0x342fc0(0x179);else{if(_0x208699[_0x342fc0(0x20e)]===_0x342fc0(0x191))_0x55528e=_0x342fc0(0x2bf);else{if(_0x208699[_0x342fc0(0x20e)]===_0x342fc0(0x2bf))_0x55528e='new';else{if(_0x208699['status']===_0x342fc0(0x179))_0x55528e=_0x342fc0(0x331);}}}return _0x55528e;}function updateStatus(_0x352e8a,_0xadece0){const _0x3ea402=_0x1ba0fc;dbConfig[_0x3ea402(0x211)]('bots')[_0x3ea402(0x1f8)]({'botID':_0x352e8a})[_0x3ea402(0x2c5)]({'status':_0xadece0})[_0x3ea402(0x1d3)](),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots(_0x3ea402(0x17d),JSON[_0x3ea402(0x32e)](config));}function updateLive(_0x43c0b9,_0x35ade8){const _0x43b2ab=_0x1ba0fc;dbConfig[_0x43b2ab(0x211)](_0x43b2ab(0x17d))[_0x43b2ab(0x1f8)]({'botID':_0x43c0b9})[_0x43b2ab(0x2c5)]({'live':_0x35ade8})[_0x43b2ab(0x1d3)](),config=getConfiguration(),io['to'](_0x43b2ab(0x301))[_0x43b2ab(0x315)](_0x43b2ab(0x17d),config),broadcastToBots(_0x43b2ab(0x17d),JSON[_0x43b2ab(0x32e)](config));}function updateBotName(_0x245350,_0x5307c6){const _0x5bc883=_0x1ba0fc;dbConfig['get'](_0x5bc883(0x17d))[_0x5bc883(0x1f8)]({'botID':_0x245350})['assign']({'botname':_0x5307c6})['write'](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x5bc883(0x17d),config),broadcastToBots(_0x5bc883(0x17d),JSON[_0x5bc883(0x32e)](config));}function updateBotManager(){const _0xffc19e=_0x1ba0fc;config=getConfiguration(),io['to']('botmanager')[_0xffc19e(0x315)](_0xffc19e(0x17d),config),broadcastToBots(_0xffc19e(0x17d),JSON[_0xffc19e(0x32e)](config));}function toggleBotMode(_0x26812b){const _0x4a3332=_0x1ba0fc;if(pid[_0x26812b])pid[_0x26812b][_0x4a3332(0x1de)]({'function':'toggleBotMode','args':null});else{const _0x1211a0=configpath+_0x4a3332(0x2be)+_0x26812b+_0x4a3332(0x16e),_0xfbede3=fs[_0x4a3332(0x333)](_0x1211a0),_0x1a095b=JSON[_0x4a3332(0x238)](_0xfbede3),_0x38ff63=_0x1a095b[_0x4a3332(0x149)][0x0][_0x4a3332(0x16d)];_0x1a095b[_0x4a3332(0x149)][0x0][_0x4a3332(0x16d)]=!_0x38ff63;const _0x59af33=JSON[_0x4a3332(0x32e)](_0x1a095b,null,0x2);fs[_0x4a3332(0x27c)](_0x1211a0,_0x59af33),config=getConfiguration(),io['to']('botmanager')[_0x4a3332(0x315)](_0x4a3332(0x17d),config),broadcastToBots(_0x4a3332(0x17d),JSON['stringify'](config));}}function validateTelegram(_0x6a9708){const _0x403415=_0x1ba0fc;if(_0x6a9708['from'][_0x403415(0x2c0)]!=settings[_0x403415(0x1c6)]&&'@'+_0x6a9708[_0x403415(0x1b9)][_0x403415(0x2c0)]!=settings[_0x403415(0x1c6)]||_0x6a9708[_0x403415(0x2ae)]['id']!=settings[_0x403415(0x288)])return sendTelegram(_0x6a9708[_0x403415(0x2ae)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x403415(0x2c6)}),![];return!![];}async function initTelegram(){const _0x43f64f=_0x1ba0fc;if(tgBot)tgBot[_0x43f64f(0x195)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x43f64f(0x298)]);let _0xa1f96a='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0xa1f96a+='\x0a',_0xa1f96a+='/enable\x20-\x20enable\x20notifications\x0a',_0xa1f96a+=_0x43f64f(0x24c),_0xa1f96a+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0xa1f96a+=_0x43f64f(0x1f7),_0xa1f96a+=_0x43f64f(0x2fd),_0xa1f96a+=_0x43f64f(0x309),_0xa1f96a+=_0x43f64f(0x24d),_0xa1f96a+=_0x43f64f(0x20c),_0xa1f96a+=_0x43f64f(0x1a9),_0xa1f96a+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0xa1f96a+=_0x43f64f(0x258),_0xa1f96a+=_0x43f64f(0x219),_0xa1f96a+=_0x43f64f(0x164),_0xa1f96a+=_0x43f64f(0x311);let _0x23fd88=_0x43f64f(0x159);_0x23fd88+='\x0a',_0x23fd88+=_0xa1f96a,tgBot[_0x43f64f(0x2cb)]((_0x4a638d,_0x27e43b)=>{const _0x50c788=_0x43f64f;logger[_0x50c788(0x2b6)](getTimeStamp()+_0x50c788(0x2cc)),logger[_0x50c788(0x1dd)]('Telegraf\x20error:',_0x4a638d);}),tgBot['use'](async(_0x1a970f,_0x1c4fd1)=>{const _0x19b0a1=_0x43f64f;if(!(!settings['telegramChatId']&&_0x1a970f[_0x19b0a1(0x1e1)]['message']['text']==_0x19b0a1(0x2f5))){if(!validateTelegram(_0x1a970f))return;}_0x1c4fd1();}),tgBot[_0x43f64f(0x302)](_0x43f64f(0x15b),async _0x4a2589=>{const _0x3d45fc=_0x43f64f;if(!settings[_0x3d45fc(0x288)])updateSetting(_0x3d45fc(0x288),_0x4a2589['chat']['id']);updateSetting(_0x3d45fc(0x1a0),!![]);if(!validateTelegram(_0x4a2589))return;await sendTelegram(_0x4a2589[_0x3d45fc(0x2ae)]['id'],_0x23fd88);}),tgBot[_0x43f64f(0x302)](_0x43f64f(0x171),async _0x3b9bdb=>{const _0x1e88fc=_0x43f64f;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x3b9bdb['chat']['id'],_0x1e88fc(0x227));}),tgBot[_0x43f64f(0x302)](_0x43f64f(0x170),async _0x260d48=>{const _0x3e524f=_0x43f64f;await sendTelegram(_0x260d48['chat']['id'],'Notifications\x20disabled'),updateSetting(_0x3e524f(0x1a0),![]);}),tgBot['command']('config',async _0x5a8e88=>{const _0x2afc88=_0x43f64f,_0x2e458b=Markup[_0x2afc88(0x223)]([Markup[_0x2afc88(0x234)][_0x2afc88(0x300)](_0x2afc88(0x1e3),'config_orders'),Markup[_0x2afc88(0x234)][_0x2afc88(0x300)](_0x2afc88(0x21a),_0x2afc88(0x291)),Markup[_0x2afc88(0x234)][_0x2afc88(0x300)](_0x2afc88(0x1be),_0x2afc88(0x24f))]);_0x5a8e88[_0x2afc88(0x2fa)](_0x2afc88(0x2d7),_0x2e458b);}),tgBot[_0x43f64f(0x2f6)](_0x43f64f(0x277),async _0x1ead3c=>{const _0x35d7d2=_0x43f64f;_0x1ead3c[_0x35d7d2(0x2f7)](),updateSetting(_0x35d7d2(0x2fb),_0x35d7d2(0x1f1)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x1ead3c[_0x35d7d2(0x2ae)]['id'],_0x35d7d2(0x332));}),tgBot[_0x43f64f(0x2f6)]('config_alerts',async _0xee731a=>{const _0x48ab1e=_0x43f64f;_0xee731a[_0x48ab1e(0x2f7)](),updateSetting('telegramEvents',_0x48ab1e(0x169)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0xee731a[_0x48ab1e(0x2ae)]['id'],_0x48ab1e(0x1d2));}),tgBot[_0x43f64f(0x2f6)](_0x43f64f(0x24f),async _0x516b8d=>{const _0x45f26c=_0x43f64f;_0x516b8d['editMessageReplyMarkup'](),updateSetting(_0x45f26c(0x2fb),_0x45f26c(0x204)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x516b8d['chat']['id'],_0x45f26c(0x1ea));}),tgBot[_0x43f64f(0x302)](_0x43f64f(0x20e),async _0x47f61e=>{const _0x1ad340=_0x43f64f,_0x53146f=getBotsWithMode();let _0x20bf09=_0x1ad340(0x162);config[_0x1ad340(0x28a)](_0x487ce5=>{const _0x31462e=_0x1ad340,_0x4a65bd=_0x53146f[_0x31462e(0x1f8)](_0x561a52=>_0x561a52[_0x31462e(0x271)]==_0x487ce5[_0x31462e(0x271)])[_0x31462e(0x1df)];_0x20bf09+=_0x31462e(0x2aa)+_0x487ce5['botID']+':\x20'+_0x487ce5[_0x31462e(0x20e)]+_0x31462e(0x27e)+_0x4a65bd+_0x31462e(0x27e)+_0x487ce5[_0x31462e(0x33d)]+'\x0a';}),_0x20bf09+='\x0a',_0x20bf09+=_0x1ad340(0x1a6),_0x20bf09+=!settings['telegramEnabled']?_0x1ad340(0x18e):_0x1ad340(0x1d1),_0x20bf09+=settings[_0x1ad340(0x1a0)]?settings[_0x1ad340(0x2fb)]==_0x1ad340(0x204)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings[_0x1ad340(0x2fb)]+_0x1ad340(0x1ef):'',await sendTelegram(_0x47f61e[_0x1ad340(0x2ae)]['id'],_0x20bf09,{'parse_mode':_0x1ad340(0x2c6)});}),tgBot[_0x43f64f(0x302)](_0x43f64f(0x177),async _0x9d6aef=>{const _0x2b6f94=_0x43f64f,_0x36a5ff=getEnabledBots();if(_0x36a5ff[_0x2b6f94(0x343)]==0x0)await sendTelegram(_0x9d6aef[_0x2b6f94(0x2ae)]['id'],_0x2b6f94(0x183));else{if(_0x36a5ff[_0x2b6f94(0x343)]>0x1)_0x36a5ff['push']({'botID':'all'});let _0x46e446=[],_0x6b357c=[];const _0x322acc=_0x36a5ff[_0x2b6f94(0x343)]%0x4==0x0||_0x36a5ff[_0x2b6f94(0x343)]%0x4==0x3||_0x36a5ff['length']%0x3==0x1?0x4:0x3;let _0x476ec5=0x0;_0x36a5ff['forEach']((_0x1a3e99,_0x19fd6c)=>{const _0x44abff=_0x2b6f94;if(_0x19fd6c%_0x322acc==0x0)_0x6b357c=[];_0x6b357c[_0x44abff(0x250)](Markup[_0x44abff(0x234)][_0x44abff(0x300)](_0x1a3e99[_0x44abff(0x271)]==_0x44abff(0x204)?'All\x20bots':'Bot\x20'+_0x1a3e99[_0x44abff(0x271)],_0x44abff(0x341)+_0x1a3e99['botID'])),_0x19fd6c%_0x322acc==0x0&&(_0x46e446[_0x476ec5]=_0x6b357c,_0x476ec5++);});const _0x496ba3=Markup[_0x2b6f94(0x223)](_0x46e446);_0x9d6aef[_0x2b6f94(0x2fa)](_0x2b6f94(0x151),_0x496ba3);}}),tgBot[_0x43f64f(0x2f6)](/restart_(.+)/,async _0x1f6d01=>{const _0x2a9ddd=_0x43f64f,_0x5b39c6=_0x1f6d01[_0x2a9ddd(0x1b4)][0x1];_0x1f6d01[_0x2a9ddd(0x2f7)](),_0x5b39c6=='all'?config[_0x2a9ddd(0x28a)](_0x4b1b92=>{const _0x24f89f=_0x2a9ddd;restartBot(_0x4b1b92[_0x24f89f(0x271)]);}):restartBot(_0x5b39c6);}),tgBot[_0x43f64f(0x302)]('on',async _0x56c251=>{const _0x351205=_0x43f64f,_0x2c3cf9=getDisabledBots();if(_0x2c3cf9['length']==0x0)await sendTelegram(_0x56c251['chat']['id'],_0x351205(0x20f));else{if(_0x2c3cf9['length']>0x1)_0x2c3cf9[_0x351205(0x250)]({'botID':_0x351205(0x204)});let _0x40261a=[],_0x513ccb=[];const _0xf37808=_0x2c3cf9[_0x351205(0x343)]%0x4==0x0||_0x2c3cf9[_0x351205(0x343)]%0x4==0x3||_0x2c3cf9[_0x351205(0x343)]%0x3==0x1?0x4:0x3;let _0x7a2e23=0x0;_0x2c3cf9['forEach']((_0x104e9a,_0x289a2d)=>{const _0x5dd338=_0x351205;if(_0x289a2d%_0xf37808==0x0)_0x513ccb=[];_0x513ccb[_0x5dd338(0x250)](Markup[_0x5dd338(0x234)][_0x5dd338(0x300)](_0x104e9a[_0x5dd338(0x271)]=='all'?'All\x20bots':_0x5dd338(0x2aa)+_0x104e9a[_0x5dd338(0x271)],_0x5dd338(0x13b)+_0x104e9a[_0x5dd338(0x271)])),_0x289a2d%_0xf37808==0x0&&(_0x40261a[_0x7a2e23]=_0x513ccb,_0x7a2e23++);});const _0x2e758f=Markup[_0x351205(0x223)](_0x40261a);_0x56c251[_0x351205(0x2fa)](_0x351205(0x1da),_0x2e758f);}}),tgBot[_0x43f64f(0x2f6)](/on_(.+)/,async _0x3b464f=>{const _0x330fca=_0x43f64f,_0x2ae03d=_0x3b464f[_0x330fca(0x1b4)][0x1];_0x3b464f['editMessageReplyMarkup']();if(_0x2ae03d==_0x330fca(0x204)){const _0x55b68b=getDisabledBots();await sendTelegram(_0x3b464f[_0x330fca(0x2ae)]['id'],_0x330fca(0x1f6)),_0x55b68b['forEach'](_0x560324=>{const _0x4991ef=_0x330fca;if(_0x560324[_0x4991ef(0x271)]!=_0x4991ef(0x204))toggleBot(_0x560324[_0x4991ef(0x271)],toggleStatus(_0x560324['botID']),'stopped');});}else await sendTelegram(_0x3b464f['chat']['id'],_0x330fca(0x26c)+_0x2ae03d),toggleBot(_0x2ae03d,toggleStatus(_0x2ae03d),_0x330fca(0x2bc));}),tgBot[_0x43f64f(0x302)](_0x43f64f(0x21f),async _0x31e0b3=>{const _0x1469ef=_0x43f64f,_0x31f1c1=getEnabledBots();if(_0x31f1c1[_0x1469ef(0x343)]==0x0)await sendTelegram(_0x31e0b3[_0x1469ef(0x2ae)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x31f1c1[_0x1469ef(0x343)]>0x1)_0x31f1c1['push']({'botID':'all'});let _0x36db6a=[],_0x33677c=[];const _0x5972c0=_0x31f1c1[_0x1469ef(0x343)]%0x4==0x0||_0x31f1c1['length']%0x4==0x3||_0x31f1c1[_0x1469ef(0x343)]%0x3==0x1?0x4:0x3;let _0x242eb6=0x0;_0x31f1c1[_0x1469ef(0x28a)]((_0x3755d4,_0x16349a)=>{const _0x3f603f=_0x1469ef;if(_0x16349a%_0x5972c0==0x0)_0x33677c=[];_0x33677c[_0x3f603f(0x250)](Markup['button'][_0x3f603f(0x300)](_0x3755d4[_0x3f603f(0x271)]==_0x3f603f(0x204)?'All\x20bots':_0x3f603f(0x2aa)+_0x3755d4[_0x3f603f(0x271)],_0x3f603f(0x2c4)+_0x3755d4[_0x3f603f(0x271)])),_0x16349a%_0x5972c0==0x0&&(_0x36db6a[_0x242eb6]=_0x33677c,_0x242eb6++);});const _0x14cd0d=Markup[_0x1469ef(0x223)](_0x36db6a);_0x31e0b3[_0x1469ef(0x2fa)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x14cd0d);}}),tgBot[_0x43f64f(0x2f6)](/off_(.+)/,async _0x30ae40=>{const _0x490963=_0x43f64f,_0x507421=_0x30ae40['match'][0x1];_0x30ae40[_0x490963(0x2f7)]();if(_0x507421=='all'){const _0x53f2f6=getEnabledBots();await sendTelegram(_0x30ae40['chat']['id'],_0x490963(0x329)),_0x53f2f6['forEach'](_0xf44df0=>{const _0x358d17=_0x490963;if(_0xf44df0[_0x358d17(0x271)]!=_0x358d17(0x204))toggleBot(_0xf44df0[_0x358d17(0x271)],toggleStatus(_0xf44df0[_0x358d17(0x271)]),_0x358d17(0x2bc));});}else await sendTelegram(_0x30ae40[_0x490963(0x2ae)]['id'],_0x490963(0x1ff)+_0x507421),toggleBot(_0x507421,toggleStatus(_0x507421),_0x490963(0x2bc));}),tgBot[_0x43f64f(0x302)](_0x43f64f(0x218),async _0x1045c9=>{const _0xdabae8=_0x43f64f,_0x14b7cb=getEnabledBots();if(_0x14b7cb[_0xdabae8(0x343)]==0x0)await sendTelegram(_0x1045c9[_0xdabae8(0x2ae)]['id'],_0xdabae8(0x183));else{if(_0x14b7cb[_0xdabae8(0x343)]>0x1){let _0x388202=[],_0x514571=[];const _0x40ba73=_0x14b7cb[_0xdabae8(0x343)]%0x4==0x0||_0x14b7cb[_0xdabae8(0x343)]%0x4==0x3||_0x14b7cb['length']%0x3==0x1?0x4:0x3;let _0x567839=0x0;_0x14b7cb['forEach']((_0x644ee1,_0x4cdc98)=>{const _0x418caa=_0xdabae8;if(_0x4cdc98%_0x40ba73==0x0)_0x514571=[];_0x514571[_0x418caa(0x250)](Markup[_0x418caa(0x234)][_0x418caa(0x300)]('Bot\x20'+_0x644ee1[_0x418caa(0x271)],_0x418caa(0x265)+_0x644ee1[_0x418caa(0x271)])),_0x4cdc98%_0x40ba73==0x0&&(_0x388202[_0x567839]=_0x514571,_0x567839++);});const _0x1c91cf=Markup[_0xdabae8(0x223)](_0x388202);_0x1045c9[_0xdabae8(0x2fa)](_0xdabae8(0x2e0),_0x1c91cf);}else{const _0x28ed7f=_0x14b7cb[0x0][_0xdabae8(0x271)];if(pid[_0x28ed7f])pid[_0x28ed7f]['send']({'function':_0xdabae8(0x17c),'args':null});}}}),tgBot[_0x43f64f(0x2f6)](/metrics_(.+)/,async _0x41ec51=>{const _0x1e08fb=_0x43f64f,_0x8c76a4=_0x41ec51[_0x1e08fb(0x1b4)][0x1];_0x41ec51[_0x1e08fb(0x2f7)]();if(pid[_0x8c76a4])pid[_0x8c76a4][_0x1e08fb(0x1de)]({'function':_0x1e08fb(0x17c),'args':null});}),tgBot['command']('portfolio',async _0x4d8f91=>{const _0x2b5915=_0x43f64f,_0x3d589c=getEnabledBots();if(_0x3d589c['length']==0x0)await sendTelegram(_0x4d8f91[_0x2b5915(0x2ae)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x3d589c[_0x2b5915(0x343)]>0x1){let _0x4777b6=[],_0xf9bf2d=[];const _0x54e03f=_0x3d589c[_0x2b5915(0x343)]%0x4==0x0||_0x3d589c[_0x2b5915(0x343)]%0x4==0x3||_0x3d589c['length']%0x3==0x1?0x4:0x3;let _0x27533b=0x0;_0x3d589c[_0x2b5915(0x28a)]((_0x27720f,_0x57d8e8)=>{const _0x4aff42=_0x2b5915;if(_0x57d8e8%_0x54e03f==0x0)_0xf9bf2d=[];_0xf9bf2d[_0x4aff42(0x250)](Markup[_0x4aff42(0x234)][_0x4aff42(0x300)](_0x4aff42(0x2aa)+_0x27720f[_0x4aff42(0x271)],_0x4aff42(0x23c)+_0x27720f[_0x4aff42(0x271)])),_0x57d8e8%_0x54e03f==0x0&&(_0x4777b6[_0x27533b]=_0xf9bf2d,_0x27533b++);});const _0x25c248=Markup[_0x2b5915(0x223)](_0x4777b6);_0x4d8f91['reply'](_0x2b5915(0x1bd),_0x25c248);}else{const _0x503b17=_0x3d589c[0x0][_0x2b5915(0x271)];if(pid[_0x503b17])pid[_0x503b17][_0x2b5915(0x1de)]({'function':_0x2b5915(0x19c),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x7e3f82=>{const _0x2d8636=_0x43f64f,_0x268c50=_0x7e3f82[_0x2d8636(0x1b4)][0x1];_0x7e3f82[_0x2d8636(0x2f7)]();if(pid[_0x268c50])pid[_0x268c50][_0x2d8636(0x1de)]({'function':_0x2d8636(0x19c),'args':null});}),tgBot[_0x43f64f(0x302)](_0x43f64f(0x1e1),async _0x2951b0=>{const _0x35a1c0=_0x43f64f;await getMessages();if(!updateAvailable)await sendTelegram(_0x2951b0['chat']['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x2951b0[_0x35a1c0(0x2ae)]['id'],_0x35a1c0(0x24a));else{const _0x5766b4=Markup[_0x35a1c0(0x223)]([Markup[_0x35a1c0(0x234)]['callback'](_0x35a1c0(0x173),'update_yes'),Markup[_0x35a1c0(0x234)][_0x35a1c0(0x300)]('No','update_no')]);_0x2951b0['reply']('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x5766b4);}}}),tgBot[_0x43f64f(0x2f6)](/update_(.+)/,async _0x37a40d=>{const _0x1ed140=_0x43f64f,_0x2957ee=_0x37a40d[_0x1ed140(0x1b4)][0x1];_0x37a40d['editMessageReplyMarkup'](),_0x2957ee==_0x1ed140(0x1c8)&&(await sendTelegram(_0x37a40d[_0x1ed140(0x2ae)]['id'],_0x1ed140(0x31e)),updateBB(_0x1ed140(0x1e1))),_0x2957ee=='no'&&await sendTelegram(_0x37a40d[_0x1ed140(0x2ae)]['id'],_0x1ed140(0x305));}),tgBot['command'](_0x43f64f(0x2dc),async _0x130640=>{const _0x897bc9=_0x43f64f;if(!validInstallation)await sendTelegram(_0x130640[_0x897bc9(0x2ae)]['id'],_0x897bc9(0x1b3));else{const _0x2395fe=Markup[_0x897bc9(0x223)]([Markup['button']['callback'](_0x897bc9(0x173),'reinstall_yes'),Markup[_0x897bc9(0x234)][_0x897bc9(0x300)]('No',_0x897bc9(0x22a))]);_0x130640[_0x897bc9(0x2fa)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x2395fe);}}),tgBot[_0x43f64f(0x2f6)](/reinstall_(.+)/,async _0x3a7144=>{const _0x106a42=_0x43f64f,_0x28fe4b=_0x3a7144[_0x106a42(0x1b4)][0x1];_0x3a7144[_0x106a42(0x2f7)](),_0x28fe4b==_0x106a42(0x1c8)&&(await sendTelegram(_0x3a7144[_0x106a42(0x2ae)]['id'],_0x106a42(0x1fd)),updateBB(_0x106a42(0x2dc))),_0x28fe4b=='no'&&await sendTelegram(_0x3a7144[_0x106a42(0x2ae)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x43f64f(0x302)](_0x43f64f(0x220),async _0x9171fe=>{const _0xc4a3e0=_0x43f64f,_0x393650=getBotsWithMode();if(_0x393650['length']==0x0)await sendTelegram(_0x9171fe[_0xc4a3e0(0x2ae)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x5c5ce1=[],_0x1d936c=[];const _0x23d6e7=0x2;let _0x3edb8a=0x0;_0x393650['forEach']((_0x1f7876,_0x172b4d)=>{const _0x50006e=_0xc4a3e0;if(_0x172b4d%_0x23d6e7==0x0)_0x1d936c=[];_0x1d936c[_0x50006e(0x250)](Markup[_0x50006e(0x234)][_0x50006e(0x300)](_0x50006e(0x2aa)+_0x1f7876[_0x50006e(0x271)]+'\x20('+_0x1f7876[_0x50006e(0x1df)]+')','toggle_'+_0x1f7876[_0x50006e(0x271)])),_0x172b4d%_0x23d6e7==0x0&&(_0x5c5ce1[_0x3edb8a]=_0x1d936c,_0x3edb8a++);});const _0x2c754d=Markup['inlineKeyboard'](_0x5c5ce1);_0x9171fe[_0xc4a3e0(0x2fa)](_0xc4a3e0(0x2e3),_0x2c754d);}}),tgBot[_0x43f64f(0x2f6)](/toggle_(.+)/,async _0x50d5b2=>{const _0x588f29=_0x43f64f,_0x5647bf=_0x50d5b2[_0x588f29(0x1b4)][0x1];_0x50d5b2[_0x588f29(0x2f7)]();const _0x200708=getBotsWithMode(),_0x480330=_0x200708[_0x588f29(0x1f8)](_0x2ce7ee=>_0x2ce7ee[_0x588f29(0x271)]==_0x5647bf),_0x3ab9fa=_0x480330[_0x588f29(0x1df)]==_0x588f29(0x296)?_0x588f29(0x323):'auto';await sendTelegram(_0x50d5b2[_0x588f29(0x2ae)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x5647bf+_0x588f29(0x2b3)+_0x3ab9fa+_0x588f29(0x156)),toggleBotMode(_0x5647bf);}),tgBot[_0x43f64f(0x302)](_0x43f64f(0x29c),async _0x5d403d=>{const _0x350945=_0x43f64f;let _0x3e7982='';config[_0x350945(0x28a)](_0x2fc594=>{const _0x128460=_0x350945;_0x3e7982+=_0x128460(0x2aa)+_0x2fc594[_0x128460(0x271)]+':\x20'+_0x2fc594['botname']+'\x0a';}),await sendTelegram(_0x5d403d[_0x350945(0x2ae)]['id'],_0x3e7982,{'parse_mode':_0x350945(0x2c6)});}),tgBot[_0x43f64f(0x302)](_0x43f64f(0x1cf),async _0x6906bd=>{const _0x15ccf4=_0x43f64f;await sendTelegram(_0x6906bd[_0x15ccf4(0x2ae)]['id'],_0xa1f96a);}),process[_0x43f64f(0x25a)](_0x43f64f(0x1ce),()=>tgBot['stop'](_0x43f64f(0x1ce))),process['once']('SIGTERM',()=>tgBot[_0x43f64f(0x195)](_0x43f64f(0x281))),tgBot[_0x43f64f(0x2ff)]();}}function disableTelegram(){const _0x2d80e4=_0x1ba0fc;tgBot&&tgBot[_0x2d80e4(0x195)]();}async function sendTelegram(_0x41b654,_0x620800,_0x318d13){const _0x2d521f=_0x1ba0fc;try{await tgBot['telegram'][_0x2d521f(0x1ad)](_0x41b654,_0x620800,_0x318d13);}catch(_0x43a389){console[_0x2d521f(0x255)]('Telegram\x20error:',_0x43a389);}}async function sendTelegramBot(_0x2152cb,_0x1d89bb){const _0x5c4cb3=_0x1ba0fc;if(settings[_0x5c4cb3(0x1a0)]){if(settings['telegramEvents']==_0x5c4cb3(0x204)||(_0x1d89bb[_0x5c4cb3(0x27d)]==_0x5c4cb3(0x214)||_0x1d89bb['type']==_0x5c4cb3(0x31f)||_0x1d89bb[_0x5c4cb3(0x27d)]==_0x5c4cb3(0x251))&&settings[_0x5c4cb3(0x2fb)]==_0x5c4cb3(0x169)||_0x1d89bb['type']==_0x5c4cb3(0x2d4)&&settings['telegramEvents']==_0x5c4cb3(0x1f1)){if(tgBot&&settings[_0x5c4cb3(0x288)]){if(_0x1d89bb[_0x5c4cb3(0x320)])await sendTelegram(settings[_0x5c4cb3(0x288)],_0x1d89bb[_0x5c4cb3(0x1a4)]+_0x5c4cb3(0x181)+_0x1d89bb['event']);else await sendTelegram(settings[_0x5c4cb3(0x288)],_0x5c4cb3(0x2aa)+_0x2152cb+_0x5c4cb3(0x181)+_0x1d89bb[_0x5c4cb3(0x30e)]);}}}}async function sendTelegramMsg(_0x486949,_0x359445=_0x1ba0fc(0x2c6)){const _0x5e8d3b=_0x1ba0fc;return settings['telegramEnabled']&&tgBot&&settings[_0x5e8d3b(0x288)]?(await sendTelegram(settings[_0x5e8d3b(0x288)],_0x486949,{'parse_mode':_0x359445}),!![]):![];}function getDeviceWithIp(_0x4df325){return devices['find'](_0x44d530=>_0x44d530['ip']===_0x4df325);}async function temporaryAccess2FA(_0x229063,_0x1c6773){const _0x145fcc=_0x1ba0fc;let _0x490ae4=new Date(),_0x390e11=![];if(lastIpApproval){if(_0x490ae4-lastIpApproval<0x1388)_0x390e11=!![];}lastIpApproval=new Date();if(_0x390e11)return;if(tgBot&&settings[_0x145fcc(0x288)]){const _0x536a67=uuidRandom();tmpStorage[_0x536a67]={'uuid':_0x229063,'externalip':_0x1c6773};const _0x295b13=Markup['inlineKeyboard']([Markup[_0x145fcc(0x234)][_0x145fcc(0x300)](_0x145fcc(0x16c),_0x145fcc(0x18a)+_0x536a67),Markup[_0x145fcc(0x234)]['callback'](_0x145fcc(0x1e7),_0x145fcc(0x284)+_0x536a67),Markup[_0x145fcc(0x234)][_0x145fcc(0x300)](_0x145fcc(0x194),_0x145fcc(0x22d)+_0x536a67),Markup[_0x145fcc(0x234)][_0x145fcc(0x300)](_0x145fcc(0x33f),_0x145fcc(0x1d8)+_0x536a67)]);await sendTelegram(settings['telegramChatId'],_0x145fcc(0x209)+normalizeIP(_0x1c6773)[_0x145fcc(0x1c4)]+'\x20?',_0x295b13),tgBot[_0x145fcc(0x2f6)](/tempaccess_(.+)_(.+)/,async _0x32ac20=>{const _0x5aff32=_0x145fcc,_0x56ca86=_0x32ac20[_0x5aff32(0x1b4)][0x1],_0x4eefbd=_0x32ac20['match'][0x2],{uuid:_0x3508d9,externalip:_0x3b031a}=tmpStorage[_0x4eefbd];delete tmpStorage[_0x4eefbd],_0x32ac20[_0x5aff32(0x2f7)](),devices[_0x3508d9][_0x5aff32(0x14b)]={'clientip':_0x3b031a,'timestamp':new Date()[_0x5aff32(0x276)](),'expiry':_0x56ca86},_0x56ca86!=_0x5aff32(0x33f)?(await sendTelegram(_0x32ac20['chat']['id'],'Access\x20enabled\x20for\x20'+_0x56ca86+_0x5aff32(0x321),{'parse_mode':_0x5aff32(0x2c6)}),io['to'](_0x3508d9)[_0x5aff32(0x315)](_0x5aff32(0x20e),{'access':{'allow':![],'reason':_0x5aff32(0x1bb),'token':null}})):(await sendTelegram(_0x32ac20[_0x5aff32(0x2ae)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x3508d9)[_0x5aff32(0x315)](_0x5aff32(0x20e),{'access':{'allow':![],'reason':_0x5aff32(0x239),'token':null}}));});}}async function loginAccess2FA(_0x2f11ac,_0x329e19){const _0x431fd6=_0x1ba0fc;if(tgBot&&settings['telegramChatId']){const _0x7290d8=uuidRandom();tmpStorage[_0x7290d8]={'uuid':_0x2f11ac,'externalip':_0x329e19};const _0x946ca9=Markup[_0x431fd6(0x223)]([Markup[_0x431fd6(0x234)][_0x431fd6(0x300)](_0x431fd6(0x17a),_0x431fd6(0x278)+loginExpiry+'_'+_0x7290d8),Markup[_0x431fd6(0x234)][_0x431fd6(0x300)](_0x431fd6(0x33f),_0x431fd6(0x23f)+_0x7290d8)]);await sendTelegram(settings[_0x431fd6(0x288)],_0x431fd6(0x176)+normalizeIP(_0x329e19)[_0x431fd6(0x1c4)]+'\x20?',_0x946ca9),tgBot[_0x431fd6(0x2f6)](/login2fa_(.+)_(.+)/,async _0x530a8d=>{const _0x46e3c1=_0x431fd6,_0x400eb7=_0x530a8d[_0x46e3c1(0x1b4)][0x1],_0x4fdde7=_0x530a8d[_0x46e3c1(0x1b4)][0x2],{uuid:_0xebfbd4,externalip:_0x23b6e9}=tmpStorage[_0x4fdde7];delete tmpStorage[_0x4fdde7],_0x530a8d['editMessageReplyMarkup'](),devices[_0xebfbd4][_0x46e3c1(0x16a)]={'clientip':_0x23b6e9,'timestamp':new Date()['getTime'](),'expiry':_0x400eb7},_0x400eb7!='reject'?(await sendTelegram(_0x530a8d['chat']['id'],'Login\x20accepted',{'parse_mode':_0x46e3c1(0x2c6)}),io['to'](_0xebfbd4)[_0x46e3c1(0x315)](_0x46e3c1(0x20e),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x530a8d[_0x46e3c1(0x2ae)]['id'],_0x46e3c1(0x283)),io['to'](_0xebfbd4)[_0x46e3c1(0x315)](_0x46e3c1(0x20e),{'access':{'allow':![],'reason':_0x46e3c1(0x167),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x471bbc=_0x1ba0fc;return dbConfig[_0x471bbc(0x211)](_0x471bbc(0x17d))[_0x471bbc(0x1a5)](_0x471bbc(0x271))[_0x471bbc(0x30f)]({'status':'enabled'})['value']()||[];}function getDisabledBots(){const _0x15c5af=_0x1ba0fc;return dbConfig['get'](_0x15c5af(0x17d))['sortBy']('botID')[_0x15c5af(0x30f)]({'status':_0x15c5af(0x179)})[_0x15c5af(0x15d)]()||[];}function getBotAttributes(_0x50d879){const _0x1c9e06=_0x1ba0fc;let _0x2f44f1={};const _0x32ef90=configpath+_0x1c9e06(0x2be)+_0x50d879+'-config.json',_0xdf3e2=fs[_0x1c9e06(0x210)](_0x32ef90);if(_0xdf3e2){const _0x52be1b=fs[_0x1c9e06(0x333)](_0x32ef90);try{const _0x11dc47=JSON[_0x1c9e06(0x238)](_0x52be1b),_0x5ecf25=_0x11dc47?_0x11dc47[_0x1c9e06(0x149)][0x0][_0x1c9e06(0x16d)]:![];_0x2f44f1['mode']=_0x5ecf25?_0x1c9e06(0x296):'manual',_0x2f44f1[_0x1c9e06(0x1a4)]=_0x11dc47?_0x11dc47[_0x1c9e06(0x149)][0x0][_0x1c9e06(0x1a4)]:_0x1c9e06(0x2aa)+_0x50d879;}catch(_0x31020a){_0x2f44f1[_0x1c9e06(0x1df)]='manual',_0x2f44f1[_0x1c9e06(0x1a4)]=_0x1c9e06(0x2aa)+_0x50d879;}}else _0x2f44f1['mode']='manual',_0x2f44f1['botname']=_0x1c9e06(0x2aa)+_0x50d879;return _0x2f44f1;}function getBotsWithMode(){const _0x580b70=_0x1ba0fc,_0x5332d7=dbConfig[_0x580b70(0x211)](_0x580b70(0x17d))['sortBy'](_0x580b70(0x271))[_0x580b70(0x15d)]()||[];return _0x5332d7['forEach'](_0x18d3e6=>{const _0x35915d=_0x580b70;let _0x9d164e=getBotAttributes(_0x18d3e6[_0x35915d(0x271)]);_0x18d3e6[_0x35915d(0x1df)]=_0x9d164e['mode'];}),_0x5332d7;}function getBotExchanges(){const _0x1fb197=_0x1ba0fc;let _0x53a03f=[];const _0x57f85a=dbConfig[_0x1fb197(0x211)](_0x1fb197(0x17d))[_0x1fb197(0x1a5)](_0x1fb197(0x271))[_0x1fb197(0x15d)]()||[];_0x57f85a[_0x1fb197(0x28a)](_0x1ba5bb=>{const _0xe0b40f=_0x1fb197;if(_0x1ba5bb[_0xe0b40f(0x20e)]==_0xe0b40f(0x331)){const _0x22b611=configpath+'bot-'+_0x1ba5bb['botID']+_0xe0b40f(0x16e),_0x4186c5=fs[_0xe0b40f(0x210)](_0x22b611);let _0x4f15ff;if(_0x4186c5){const _0x31932d=fs['readFileSync'](_0x22b611);try{const _0x5155f2=JSON[_0xe0b40f(0x238)](_0x31932d);_0x4f15ff=_0x5155f2?_0x5155f2[_0xe0b40f(0x149)][0x0][_0xe0b40f(0x208)]:null;}catch(_0x16756e){}}if(_0x4f15ff)_0x53a03f['push'](_0x4f15ff);}});const _0x2f59e3=[...new Set(_0x53a03f)][_0x1fb197(0x1e6)]();return _0x2f59e3;}async function initUser(){const _0x585f23=_0x1ba0fc;if(!settings['userid']){const _0x168714=uuidRandom();mixpanel[_0x585f23(0x21b)](_0x168714),updateSetting('userid',_0x168714);}}async function initSecure(){const _0x19033a=_0x1ba0fc;let _0x5278a7=getSecure();if(!_0x5278a7[_0x19033a(0x175)]('secret')){let _0x1b1545=await generateKeys();_0x5278a7[_0x19033a(0x31c)]=_0x1b1545['publicKey'],_0x5278a7['privateKey']=_0x1b1545[_0x19033a(0x260)],_0x5278a7[_0x19033a(0x1e4)]=crypto[_0x19033a(0x290)](0x20)['toString'](_0x19033a(0x2ca));;storeSecure(_0x5278a7);}}function getSettings(){const _0x592d24=_0x1ba0fc;return dbSettings[_0x592d24(0x211)](_0x592d24(0x272))[_0x592d24(0x15d)]()||{};}function getSecure(){const _0x347b26=_0x1ba0fc;return dbSecure[_0x347b26(0x211)](_0x347b26(0x1d9))[_0x347b26(0x15d)]()||{};}function getBlacklist(){const _0x98b15b=_0x1ba0fc;return dbSecure['get'](_0x98b15b(0x1e9))[_0x98b15b(0x15d)]()||[];}function broadcastToBots(_0x395abf,_0x3ec50f){config['forEach'](_0x564553=>{const _0x2292fa=_0x56ff;if(_0x564553[_0x2292fa(0x20e)]==_0x2292fa(0x331)&&_0x564553['live']=='running'||_0x564553[_0x2292fa(0x20e)]=='new'&&_0x564553['live']=='running'){if(pid[_0x564553[_0x2292fa(0x271)]])pid[_0x564553[_0x2292fa(0x271)]][_0x2292fa(0x1de)]({[_0x395abf]:_0x3ec50f});}});}function storeSettings(_0x4bbcef,_0x155dec=![]){const _0x22cafc=_0x1ba0fc;_0x4bbcef={...settings,..._0x4bbcef};if(_0x155dec&&_0x4bbcef[_0x22cafc(0x253)]!=_0x22cafc(0x216)&&_0x4bbcef[_0x22cafc(0x253)]!=_0x22cafc(0x2b0)&&_0x4bbcef['bbPassword']!=''){const _0x38086f=crypt[_0x22cafc(0x148)](secure['privateKey'],_0x4bbcef['bbPassword'])[_0x22cafc(0x2df)]['split']('@')[0x0],_0x8ef5a1=bcrypt[_0x22cafc(0x267)](_0x38086f,saltRounds);_0x4bbcef={..._0x4bbcef,'bbPassword':_0x8ef5a1};}if(_0x155dec&&_0x4bbcef[_0x22cafc(0x298)]!=_0x22cafc(0x216)&&_0x4bbcef[_0x22cafc(0x298)]!=_0x22cafc(0x2b0)&&_0x4bbcef[_0x22cafc(0x298)]!=''){const _0x1985ef=crypt['decrypt'](secure['privateKey'],_0x4bbcef[_0x22cafc(0x298)])[_0x22cafc(0x2df)]['split']('@')[0x0];_0x4bbcef={..._0x4bbcef,'telegramToken':_0x1985ef};}const _0x302046=_0x4bbcef[_0x22cafc(0x298)]!=_0x22cafc(0x216)&&_0x4bbcef['telegramToken']!=settings['telegramToken']||_0x4bbcef[_0x22cafc(0x1c6)]!=settings[_0x22cafc(0x1c6)],_0x915bad=_0x4bbcef[_0x22cafc(0x298)]==''||_0x4bbcef['telegramUsername']=='';_0x302046&&(_0x4bbcef[_0x22cafc(0x288)]=null,_0x4bbcef[_0x22cafc(0x2fb)]=_0x22cafc(0x204));for(const [_0x4e6b9f,_0x12e891]of Object[_0x22cafc(0x303)](_0x4bbcef)){if(_0x4e6b9f=='telegramToken'&&_0x12e891==_0x22cafc(0x216)){_0x4bbcef[_0x22cafc(0x298)]=settings[_0x22cafc(0x298)];continue;};if(_0x4e6b9f==_0x22cafc(0x253)&&_0x12e891==_0x22cafc(0x216)){_0x4bbcef['bbPassword']=settings['bbPassword'];continue;};dbSettings['set'](_0x22cafc(0x1f5)+_0x4e6b9f,_0x12e891)['write']();}settings=_0x4bbcef,io['to'](_0x22cafc(0x301))['emit'](_0x22cafc(0x272),cleanSettings()),broadcastToBots(_0x22cafc(0x2bb),settings[_0x22cafc(0x2bb)]),broadcastToBots('onepagemode',settings[_0x22cafc(0x30b)]);if(_0x302046&&!_0x915bad)initTelegram();if(_0x302046&&_0x915bad)disableTelegram();getAllClients()[_0x22cafc(0x28a)](_0x3e9a92=>{const _0x1c5359=_0x22cafc;getSocket(_0x3e9a92['id'])[_0x1c5359(0x315)](_0x1c5359(0x20e),{'access':{'allow':![],'reason':_0x1c5359(0x1bb),'token':null}});});}function updateSetting(_0x4b760a,_0x58161f){const _0x21024e=_0x1ba0fc;dbSettings['set'](_0x21024e(0x1f5)+_0x4b760a,_0x58161f)[_0x21024e(0x1d3)](),settings=getSettings(),io['to'](_0x21024e(0x301))[_0x21024e(0x315)]('settings',cleanSettings());}function storeSecure(_0xc3eaa4){const _0x1767d7=_0x1ba0fc;dbSecure['get'](_0x1767d7(0x1d9))[_0x1767d7(0x250)](_0xc3eaa4)[_0x1767d7(0x1d3)](),secure=_0xc3eaa4;}function addBlacklist(_0x368ee9){const _0x49eba9=_0x1ba0fc;cleanBlacklist();let _0x49131f;devices[_0x368ee9][_0x49eba9(0x14b)]?_0x49131f=Math[_0x49eba9(0x2cf)](devices[_0x368ee9][_0x49eba9(0x14b)][_0x49eba9(0x202)],loginExpiry):_0x49131f=loginExpiry,dbSecure[_0x49eba9(0x211)](_0x49eba9(0x1e9))[_0x49eba9(0x250)]({'expiry':new Date()['getTime']()+_0x49131f*0x3c*0x3e8,'token':devices[_0x368ee9][_0x49eba9(0x249)][_0x49eba9(0x232)]})[_0x49eba9(0x1d3)](),blacklist=dbSecure[_0x49eba9(0x211)]('blacklist')[_0x49eba9(0x15d)]();}function cleanBlacklist(){const _0x10bb5b=_0x1ba0fc;let _0x475ae5=dbSecure[_0x10bb5b(0x211)](_0x10bb5b(0x1e9))[_0x10bb5b(0x29f)]()[_0x10bb5b(0x15d)](),_0x51b6fd=new Date()[_0x10bb5b(0x276)]();_0x475ae5['forEach'](_0x5d7120=>{const _0x24b602=_0x10bb5b;_0x5d7120['expiry']<_0x51b6fd&&dbSecure[_0x24b602(0x211)](_0x24b602(0x1e9))['remove']({'expiry':_0x5d7120[_0x24b602(0x202)]})['write']();});}function initStates(){let _0x3c3ab4=getConfiguration();_0x3c3ab4['forEach'](_0x5913e1=>{const _0x5c8062=_0x56ff;_0x5913e1[_0x5c8062(0x33d)]=_0x5c8062(0x2bc);}),storeConfiguration(_0x3c3ab4);}function onKeys(){const _0x2ffa69=new RSA();return new Promise(_0x5771e9=>{const _0x2b953d=_0x56ff;_0x2ffa69[_0x2b953d(0x1c1)]()['then'](_0x431dbd=>{_0x5771e9(_0x431dbd);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x487fb5=_0x1ba0fc;let _0x4863b2=getSettings(),_0x30de22=![];!_0x4863b2[_0x487fb5(0x175)](_0x487fb5(0x245))&&(_0x4863b2[_0x487fb5(0x245)]=0x0,_0x30de22=!![]);!_0x4863b2[_0x487fb5(0x175)](_0x487fb5(0x1a8))&&(_0x4863b2[_0x487fb5(0x1a8)]=0x0,_0x30de22=!![]);!_0x4863b2[_0x487fb5(0x175)](_0x487fb5(0x28c))&&(_0x4863b2[_0x487fb5(0x28c)]=_0x487fb5(0x140),_0x30de22=!![]);!_0x4863b2['hasOwnProperty'](_0x487fb5(0x30b))&&(_0x4863b2[_0x487fb5(0x30b)]=![],_0x30de22=!![]);if(_0x30de22)storeSettings(_0x4863b2);try{fs[_0x487fb5(0x293)](configbackuppath,{'withFileTypes':!![]})[_0x487fb5(0x28a)](_0x107201=>{const _0x7c7680=_0x487fb5;if(!_0x107201[_0x7c7680(0x178)]()){if(!_0x107201['name'][_0x7c7680(0x1c2)](_0x7c7680(0x299)))fs['unlinkSync'](configbackuppath+_0x107201['name']);}else fs[_0x7c7680(0x285)](configbackuppath+_0x107201[_0x7c7680(0x165)],{'recursive':!![]});});}catch(_0xe22674){logger[_0x487fb5(0x1dd)]('Error\x20removing\x20old\x20backup\x20files:',_0xe22674);}}function storeConfiguration(_0x14cb89){const _0x20bf82=_0x1ba0fc;dbConfig[_0x20bf82(0x211)]('bots')['remove']()['write'](),dbConfig[_0x20bf82(0x211)](_0x20bf82(0x17d))[_0x20bf82(0x250)](..._0x14cb89)[_0x20bf82(0x1d3)](),config=_0x14cb89;}async function resetPassword(){const _0x122cc5=_0x1ba0fc;if(tgBot&&settings['telegramChatId']){const _0x14b023=Markup['inlineKeyboard']([Markup[_0x122cc5(0x234)][_0x122cc5(0x300)](_0x122cc5(0x1c8),_0x122cc5(0x32a)),Markup['button'][_0x122cc5(0x300)]('no',_0x122cc5(0x187))]);await sendTelegram(settings['telegramChatId'],_0x122cc5(0x1cd),_0x14b023),tgBot['action'](/resetpw_(.+)/,async _0x490bf0=>{const _0x350d69=_0x122cc5,_0x47814b=_0x490bf0['match'][0x1];_0x490bf0['editMessageReplyMarkup']();if(_0x47814b!='no'){const _0x370b70=0xf,_0x47666a=_0x350d69(0x1c5),_0x4fe6b4=Array[_0x350d69(0x1b9)](crypto['randomFillSync'](new Uint32Array(_0x370b70)))['map'](_0x3fd734=>_0x47666a[_0x3fd734%_0x47666a[_0x350d69(0x343)]])[_0x350d69(0x222)](''),_0x5d7311=bcrypt[_0x350d69(0x267)](_0x4fe6b4,saltRounds);storeSettings({'bbPassword':_0x5d7311}),await sendTelegram(_0x490bf0[_0x350d69(0x2ae)]['id'],_0x350d69(0x346)+_0x4fe6b4,{'parse_mode':'HTML'});}else await sendTelegram(_0x490bf0[_0x350d69(0x2ae)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x2a5954,_0x1e79f1){const _0x4bfc24=_0x1ba0fc;io['to'](_0x4bfc24(0x301))[_0x4bfc24(0x315)]('notification',_0x4bfc24(0x155),_0x4bfc24(0x251));if(tgBot&&settings[_0x4bfc24(0x288)]){const _0x8ed0d4=uuidRandom();tmpStorage[_0x8ed0d4]={'path':_0x2a5954,'filename':_0x1e79f1};const _0x511d58=Markup[_0x4bfc24(0x223)]([Markup[_0x4bfc24(0x234)][_0x4bfc24(0x300)](_0x4bfc24(0x1c8),_0x4bfc24(0x186)+_0x8ed0d4),Markup[_0x4bfc24(0x234)][_0x4bfc24(0x300)]('no','restore_no_'+_0x8ed0d4)]);await sendTelegram(settings['telegramChatId'],_0x4bfc24(0x342),_0x511d58),tgBot['action'](/restore_(.+)_(.+)/,async _0x27b57d=>{const _0x2d81b4=_0x4bfc24,_0x15beb2=_0x27b57d[_0x2d81b4(0x1b4)][0x1],_0x49c36b=_0x27b57d[_0x2d81b4(0x1b4)][0x2],{path:_0x1e2a0a,filename:_0x2c8272}=tmpStorage[_0x49c36b];delete tmpStorage[_0x49c36b],_0x27b57d[_0x2d81b4(0x2f7)](),_0x15beb2==_0x2d81b4(0x1c8)?(logger[_0x2d81b4(0x1dd)](_0x2d81b4(0x2fc)),await sendTelegram(_0x27b57d[_0x2d81b4(0x2ae)]['id'],_0x2d81b4(0x1b8),{'parse_mode':_0x2d81b4(0x2c6)}),unzipFile(_0x1e2a0a,_0x2c8272)):(logger[_0x2d81b4(0x1dd)](_0x2d81b4(0x2b4)),await sendTelegram(_0x27b57d[_0x2d81b4(0x2ae)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x4805c0=_0x1ba0fc,_0x4c038d=new Date();return _0x4c038d[_0x4805c0(0x213)]()+'/'+(_0x4c038d[_0x4805c0(0x270)]()+0x1)['toString']()[_0x4805c0(0x32f)](0x2,'0')+'/'+_0x4c038d[_0x4805c0(0x182)]()[_0x4805c0(0x340)]()[_0x4805c0(0x32f)](0x2,'0')+'\x20'+_0x4c038d[_0x4805c0(0x19f)]()[_0x4805c0(0x340)]()[_0x4805c0(0x32f)](0x2,'0')+':'+_0x4c038d[_0x4805c0(0x26b)]()['toString']()['padStart'](0x2,'0')+':'+_0x4c038d[_0x4805c0(0x23d)]()[_0x4805c0(0x340)]()[_0x4805c0(0x32f)](0x2,'0');}function getTimeStamp(){const _0x20cddb=_0x1ba0fc,_0x561670=shiftedTime();return _0x561670[_0x20cddb(0x213)]()+'/'+(_0x561670[_0x20cddb(0x270)]()+0x1)[_0x20cddb(0x340)]()[_0x20cddb(0x32f)](0x2,'0')+'/'+_0x561670[_0x20cddb(0x182)]()[_0x20cddb(0x340)]()[_0x20cddb(0x32f)](0x2,'0')+'\x20'+_0x561670[_0x20cddb(0x19f)]()[_0x20cddb(0x340)]()[_0x20cddb(0x32f)](0x2,'0')+':'+_0x561670['getMinutes']()[_0x20cddb(0x340)]()['padStart'](0x2,'0')+':'+_0x561670[_0x20cddb(0x23d)]()[_0x20cddb(0x340)]()[_0x20cddb(0x32f)](0x2,'0');}function getCleanTimeStamp(){const _0x3d13f9=_0x1ba0fc,_0x5d197e=shiftedTime();return _0x5d197e[_0x3d13f9(0x213)]()+(_0x5d197e['getMonth']()+0x1)[_0x3d13f9(0x340)]()[_0x3d13f9(0x32f)](0x2,'0')+_0x5d197e[_0x3d13f9(0x182)]()[_0x3d13f9(0x340)]()[_0x3d13f9(0x32f)](0x2,'0')+'-'+_0x5d197e['getHours']()[_0x3d13f9(0x340)]()['padStart'](0x2,'0')+_0x5d197e[_0x3d13f9(0x26b)]()[_0x3d13f9(0x340)]()['padStart'](0x2,'0')+_0x5d197e[_0x3d13f9(0x23d)]()[_0x3d13f9(0x340)]()[_0x3d13f9(0x32f)](0x2,'0');}function shiftedTime(){const _0x3906fd=_0x1ba0fc,_0x489f91=new Date();let _0x14daae=_0x489f91;if(settings[_0x3906fd(0x2bb)]&&settings[_0x3906fd(0x2bb)]!==0x0)_0x14daae=fns['add'](_0x489f91,{'hours':settings[_0x3906fd(0x2bb)]});return _0x14daae;}function startScheduler(){const _0x529e0e=_0x1ba0fc,_0x58809c=new Date()['getUTCHours'](),_0x44cec8=shiftedTime()[_0x529e0e(0x19f)]();_0x44cec8==0x4&&backupConfigFiles();_0x44cec8==0x0&&rotateLogFiles();_0x58809c%0x6==0x0&&triggerAnalytics();_0x58809c%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x461abb){const _0x377199=_0x1ba0fc;logger['debug'](_0x377199(0x23a)+_0x461abb);const _0x5d0651=getBotsWithMode();_0x5d0651[_0x377199(0x343)]>0x0?confirmRestore(configbackuppath,_0x461abb):unzipFile(configbackuppath,_0x461abb);}async function getBackupFiles(_0x569bfb=null){const _0xb43b56=_0x1ba0fc;let _0x2fe89f=[],_0x31c17b=fs[_0xb43b56(0x293)](configbackuppath,{'withFileTypes':!![]});_0x31c17b[_0xb43b56(0x1e6)]((_0x1bdccd,_0x5ec71d)=>_0x1bdccd['name']<_0x5ec71d['name']?0x1:_0x5ec71d[_0xb43b56(0x165)]<_0x1bdccd[_0xb43b56(0x165)]?-0x1:0x0),_0x31c17b[_0xb43b56(0x28a)](_0x3497d4=>{const _0x54725a=_0xb43b56;if(!_0x3497d4[_0x54725a(0x178)]()&&_0x3497d4[_0x54725a(0x165)][_0x54725a(0x1c2)](_0x54725a(0x299))&&_0x3497d4[_0x54725a(0x165)][_0x54725a(0x1eb)](_0x54725a(0x2ad))){const _0x6bd41b=formatDate(fs[_0x54725a(0x18d)](configbackuppath+_0x3497d4[_0x54725a(0x165)])[_0x54725a(0x22c)]);_0x2fe89f['push']({'name':_0x3497d4[_0x54725a(0x165)],'mtime':_0x6bd41b});}});if(_0x569bfb)io['to'](_0x569bfb)[_0xb43b56(0x315)](_0xb43b56(0x268),_0x2fe89f);else return _0x2fe89f;}async function backupConfigFiles(){const _0x1fe79b=_0x1ba0fc;await zipFiles('backup-full');const _0x3c9926=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x1fe79b(0x22f),configbackuppath+(_0x1fe79b(0x299)+_0x3c9926+_0x1fe79b(0x2ad)));let _0x9a19f9=fs[_0x1fe79b(0x293)](configbackuppath,{'withFileTypes':!![]});_0x9a19f9['sort']((_0x46917d,_0x1d7773)=>_0x46917d[_0x1fe79b(0x165)]<_0x1d7773['name']?0x1:_0x1d7773['name']<_0x46917d['name']?-0x1:0x0),_0x9a19f9['length']>maxBackups&&fs[_0x1fe79b(0x254)](configbackuppath+_0x9a19f9[_0x9a19f9[_0x1fe79b(0x343)]-0x1][_0x1fe79b(0x165)]);}function rotateLogFiles(){const _0x2469cf=_0x1ba0fc,_0x25d492=fs[_0x2469cf(0x18d)](logspath+_0x2469cf(0x1c3)),_0x4c7da2=_0x25d492[_0x2469cf(0x244)]/0x400;if(_0x4c7da2>0x64){let _0x2504aa=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x2504aa[_0x2469cf(0x1e6)]((_0x3243d3,_0x57cdfe)=>_0x3243d3[_0x2469cf(0x165)]<_0x57cdfe[_0x2469cf(0x165)]?0x1:_0x57cdfe[_0x2469cf(0x165)]<_0x3243d3[_0x2469cf(0x165)]?-0x1:0x0),_0x2504aa['forEach'](_0x5a79c3=>{const _0xbeaa51=_0x2469cf;if(_0x5a79c3[_0xbeaa51(0x165)]=='output-002.log')fs[_0xbeaa51(0x30c)](logspath+_0x5a79c3[_0xbeaa51(0x165)],logspath+_0xbeaa51(0x13d));if(_0x5a79c3['name']=='output-001.log')fs[_0xbeaa51(0x30c)](logspath+_0x5a79c3[_0xbeaa51(0x165)],logspath+_0xbeaa51(0x1db));_0x5a79c3[_0xbeaa51(0x165)]==_0xbeaa51(0x1c3)&&(fs[_0xbeaa51(0x30c)](logspath+_0x5a79c3[_0xbeaa51(0x165)],logspath+_0xbeaa51(0x345)),fs[_0xbeaa51(0x27c)](logspath+_0x5a79c3[_0xbeaa51(0x165)],''));});}}async function zipFiles(_0x285f35){const _0x496207=_0x1ba0fc;let _0x4b6e49;if(_0x285f35==_0x496207(0x2d0))_0x4b6e49=logspath;if(_0x285f35=='backup')_0x4b6e49=configpath;if(_0x285f35==_0x496207(0x1f4))_0x4b6e49=configpath;let _0x157e50=fs[_0x496207(0x293)](_0x4b6e49,{'withFileTypes':!![]});const _0x44d346=new require('node-zip')();_0x157e50[_0x496207(0x28a)](_0x213030=>{const _0xe1f422=_0x496207;if(!_0x213030[_0xe1f422(0x178)]()){let _0x4592bd=fs[_0xe1f422(0x333)](_0x4b6e49+_0x213030[_0xe1f422(0x165)]);if(_0x285f35==_0xe1f422(0x221)){const _0x3ce9f1=/^bot-[0-9]{3}-config.json$/,_0x3a0dd6=_0x3ce9f1[_0xe1f422(0x317)](_0x213030[_0xe1f422(0x165)]);if(_0x3a0dd6){const _0x5ef9af=JSON[_0xe1f422(0x238)](_0x4592bd);if(_0x5ef9af['bot'][0x0]){_0x5ef9af['bot'][0x0]['apiKey']=_0xe1f422(0x2b0),_0x5ef9af[_0xe1f422(0x149)][0x0][_0xe1f422(0x2c2)]=_0xe1f422(0x2b0);if(_0x5ef9af['bot'][0x0][_0xe1f422(0x1f2)])_0x5ef9af[_0xe1f422(0x149)][0x0][_0xe1f422(0x1f2)]=_0xe1f422(0x2b0);}_0x4592bd=JSON[_0xe1f422(0x32e)](_0x5ef9af,null,0x2);}if(_0x213030['name']==_0xe1f422(0x1f9)){const _0x26deb1=JSON[_0xe1f422(0x238)](_0x4592bd);if(_0x26deb1[_0xe1f422(0x272)][_0xe1f422(0x286)])_0x26deb1[_0xe1f422(0x272)][_0xe1f422(0x286)]=![];if(_0x26deb1[_0xe1f422(0x272)][_0xe1f422(0x253)])_0x26deb1['settings'][_0xe1f422(0x253)]='***';if(_0x26deb1[_0xe1f422(0x272)][_0xe1f422(0x298)])_0x26deb1[_0xe1f422(0x272)][_0xe1f422(0x298)]='***';if(_0x26deb1[_0xe1f422(0x272)][_0xe1f422(0x288)])_0x26deb1['settings'][_0xe1f422(0x288)]=null;_0x4592bd=JSON['stringify'](_0x26deb1,null,0x2);}if(_0x213030[_0xe1f422(0x165)]!=_0xe1f422(0x2c7))_0x44d346['file'](_0x213030[_0xe1f422(0x165)],_0x4592bd);}else _0x44d346[_0xe1f422(0x1ab)](_0x213030['name'],_0x4592bd);}});const _0x158db4=_0x44d346[_0x496207(0x339)]({'base64':![],'compression':_0x496207(0x13e)});fs[_0x496207(0x27c)](zippath+(_0x285f35+_0x496207(0x2ad)),_0x158db4,_0x496207(0x259));}async function unzipFile(_0x760f8b,_0x3e8779){const _0x26bb79=_0x1ba0fc;fs[_0x26bb79(0x293)](configpath,{'withFileTypes':!![]})[_0x26bb79(0x28a)](_0x1d60a2=>{const _0x2c8720=_0x26bb79;if(!_0x1d60a2[_0x2c8720(0x178)]())fs[_0x2c8720(0x285)](configpath+_0x1d60a2[_0x2c8720(0x165)]);});const _0x4c25b5=fs[_0x26bb79(0x333)](_0x760f8b+_0x3e8779,_0x26bb79(0x259)),_0x2c57ba=new require(_0x26bb79(0x1f0))(_0x4c25b5,{'base64':![],'checkCRC32':!![]});Object[_0x26bb79(0x26e)](_0x2c57ba[_0x26bb79(0x328)])[_0x26bb79(0x28a)](_0x54c31d=>{const _0x4a04e6=_0x26bb79,_0x129326=_0x2c57ba[_0x4a04e6(0x328)][_0x54c31d];fs[_0x4a04e6(0x27c)](configpath+_0x129326[_0x4a04e6(0x165)],_0x129326['_data']);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})['forEach'](_0x553b9f=>{const _0x448b84=_0x26bb79;if(!_0x553b9f[_0x448b84(0x178)]())fs[_0x448b84(0x285)](temppath+_0x553b9f[_0x448b84(0x165)]);}),logger['debug'](_0x26bb79(0x31d)),process['send']({'restore':!![]},_0x1988f7=>{});}async function getPublicIp(){const _0x438003=_0x1ba0fc;try{const _0x417902=await axios[_0x438003(0x211)]('https://api.ipify.org?format=json');publicip=_0x417902[_0x438003(0x22e)]['ip'];}catch(_0x24a9c4){}}async function triggerAnalytics(){const _0x4f6507=_0x1ba0fc;if(!publicip)await getPublicIp();const _0x56c378=getBotsWithMode();let _0x190a62=0x0;_0x56c378[_0x4f6507(0x28a)](_0x3f81a3=>{const _0x124f0a=_0x4f6507;if(_0x3f81a3['status']===_0x124f0a(0x331))_0x190a62++;});const _0x5c3792=getBotExchanges();mixpanel[_0x4f6507(0x14a)](_0x4f6507(0x33b),{'distinct_id':settings[_0x4f6507(0x228)],'ip':publicip,'version':serverversion,'numbots':_0x56c378['length'],'numbotsenabled':_0x190a62,'exchanges':_0x5c3792,'environment':environment});}async function getMessages(){const _0x35372f=_0x1ba0fc,_0x2df893='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x1afd31=new GraphQLClient(_0x2df893),_0x5b7ac0={'authorization':_0x35372f(0x192)},_0x29206a=serverversion[_0x35372f(0x17f)]('.'),_0x26a62e=_0x29206a[0x0]+'.'+_0x29206a[0x1],_0x1fa2fe=Math[_0x35372f(0x16f)](settings[_0x35372f(0x245)],settings[_0x35372f(0x1a8)]),_0x58f473={'last':parseInt(_0x1fa2fe),'bbm':_0x26a62e},_0x4b6e0a=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x45731d;try{_0x45731d=await _0x1afd31['request'](_0x4b6e0a,_0x58f473,_0x5b7ac0);}catch(_0xda4f4c){}if(_0x45731d&&_0x45731d[_0x35372f(0x189)]){let _0x42be31=settings[_0x35372f(0x245)];newMessages=[];for(const _0x347d58 of _0x45731d['messages']){newMessages[_0x35372f(0x250)](_0x347d58);let _0x56b867=![];_0x347d58[_0x35372f(0x2ba)]&&(updateSetting(_0x35372f(0x28c),_0x347d58[_0x35372f(0x2ba)]),_0x56b867=isNewerVersion(serverversion,_0x347d58[_0x35372f(0x2ba)])||serverversion==_0x347d58[_0x35372f(0x2ba)]);if(!_0x56b867&&_0x347d58['number']>_0x42be31){if(_0x347d58[_0x35372f(0x25c)]===_0x35372f(0x2dd)||serverversion[_0x35372f(0x1c2)](_0x347d58[_0x35372f(0x25c)])){let _0x2def61=''+_0x347d58[_0x35372f(0x306)]+'\x0a\x0a'+_0x347d58[_0x35372f(0x2df)];const _0x340009=await sendTelegramMsg(toTelegramMarkdown(_0x2def61),_0x35372f(0x2a3));if(_0x340009)_0x42be31=_0x347d58[_0x35372f(0x23b)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x35372f(0x245),_0x42be31),emitMessages();}}function emitMessages(){const _0x5aa6c4=_0x1ba0fc,_0x28f91a=settings[_0x5aa6c4(0x1a8)];let _0x205bae=[];newMessages[_0x5aa6c4(0x28a)](_0xe9e500=>{const _0x4fc313=_0x5aa6c4;_0xe9e500[_0x4fc313(0x23b)]>_0x28f91a&&_0x205bae[_0x4fc313(0x250)](_0xe9e500);}),_0x205bae[_0x5aa6c4(0x343)]>0x0&&getAllClients()['forEach'](_0x493336=>{getSocket(_0x493336['id'])['emit']('message',_0x205bae);});}function confirmMessage(_0x2851b8){const _0x10ab7e=_0x1ba0fc;updateSetting(_0x10ab7e(0x1a8),Number(_0x2851b8));}function isNewerVersion(_0x4754a0,_0xb711e1){const _0xbc7783=_0x1ba0fc,_0xdff242=_0xb711e1[_0xbc7783(0x17f)]('.'),_0x247625=_0x4754a0[_0xbc7783(0x17f)]('.');for(var _0x500574=0x0;_0x500574<_0x247625[_0xbc7783(0x343)];_0x500574++){const _0x889652=~~_0x247625[_0x500574],_0x5ba259=~~_0xdff242[_0x500574];if(_0x889652>_0x5ba259)return!![];if(_0x889652<_0x5ba259)return![];}return![];}function toTelegramMarkdown(_0x1b451b){const _0x13f5f=_0x1ba0fc,_0x5194e5=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3e6fb3=/\*{2}(.+?)\*{2}/gim;return _0x1b451b=_0x1b451b[_0x13f5f(0x312)](_0x5194e5,_0x13f5f(0x2f0))[_0x13f5f(0x312)](_0x3e6fb3,_0x13f5f(0x1b2)),_0x1b451b;}async function validateConfigFile(){const _0x208643=_0x1ba0fc,_0x5885e8=dbConfig[_0x208643(0x211)](_0x208643(0x17d))[_0x208643(0x1a5)]('botID')[_0x208643(0x15d)]()||[];if(_0x5885e8['length']==0x0){let _0x4c8ae9=0x0,_0x17a866=[];const _0x2c6889=/^bot-([0-9]{3})-config.json$/,_0x4f97b5=fs[_0x208643(0x293)](configpath);_0x4f97b5['forEach'](_0xc605c=>{const _0x1c670f=_0x208643,_0x42b8ea=_0x2c6889[_0x1c670f(0x14c)](_0xc605c);if(_0x42b8ea){const _0x1646f3=_0x42b8ea[0x1];let _0x33c4a1=getBotAttributes(_0x1646f3);_0x17a866[_0x1c670f(0x250)]({'botID':_0x1646f3,'botname':_0x33c4a1[_0x1c670f(0x1a4)],'status':'disabled','live':_0x1c670f(0x2bc)}),_0x4c8ae9++;}}),_0x4c8ae9!=0x0&&(dbConfig[_0x208643(0x211)]('bots')['assign'](_0x17a866)[_0x208643(0x1d3)](),config=_0x17a866,restoredConfigFile=_0x4c8ae9);}}async function restoreConfigNotify(_0x18696d){const _0x5e9458=_0x1ba0fc;let _0x4f8fe;if(restoredConfigFile==0x1)_0x4f8fe='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x4f8fe=_0x5e9458(0x20a);if(_0x18696d)io['to'](_0x5e9458(0x301))[_0x5e9458(0x315)](_0x5e9458(0x142),_0x4f8fe);else{logger[_0x5e9458(0x2b6)]('-----------------------------------------------------------------------------------'),logger[_0x5e9458(0x2b6)](_0x4f8fe),logger[_0x5e9458(0x2b6)]('-----------------------------------------------------------------------------------'),logger['simple']('');if(tgBot&&settings[_0x5e9458(0x288)]&&settings[_0x5e9458(0x2fb)]!=_0x5e9458(0x1f1))await sendTelegram(settings[_0x5e9458(0x288)],_0x5e9458(0x292)+_0x4f8fe);}}function validateCredentials(_0x3ea786,_0x4abf32){const _0x2f85d8=_0x1ba0fc;if(_0x3ea786[_0x2f85d8(0x2c0)]==settings['bbUsername']&&bcrypt['compareSync'](_0x3ea786[_0x2f85d8(0x1d0)],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x2f85d8(0x19b),'token':null};else{const _0x2c3ab4=generateLoginToken(_0x4abf32);return{'allow':!![],'reason':_0x2f85d8(0x1bc),'token':_0x2c3ab4};}}else return{'allow':![],'reason':_0x2f85d8(0x256),'token':null};}function refreshToken(_0x4f22f5){const _0x2f559a=_0x1ba0fc,_0xb5e608=generateLoginToken(_0x4f22f5);return{'allow':!![],'reason':_0x2f559a(0x1bc),'token':_0xb5e608};}function validateAccess(_0x133928,_0x3db730,_0x36d8d0){const _0x4c84af=_0x1ba0fc,_0x175bfb=_0x36d8d0?_0x36d8d0:devices[_0x3db730]['ip'];let _0x44e024;const _0x4b79f7=_0x2ab764=>{const _0x1c03d6=_0x56ff;if(settings['loginRequired']){if(settings[_0x1c03d6(0x27a)]){if(telegram2FaApproved(_0x3db730)){const _0x14ac36=generateLoginToken(_0x3db730);return{'allow':!![],'reason':_0x1c03d6(0x1ba),'token':_0x14ac36};}else return{'allow':![],'reason':_0x1c03d6(0x1dc),'token':null};}else return _0x44e024=validToken(_0x2ab764,_0x3db730),_0x44e024[_0x1c03d6(0x175)](_0x1c03d6(0x251))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x2ab764}:{'allow':![],'reason':_0x1c03d6(0x1dc),'token':null};}else return{'allow':!![],'reason':_0x1c03d6(0x20d),'token':null};};if(settings[_0x4c84af(0x264)]){let _0x509d0a=[...settings[_0x4c84af(0x18f)],_0x4c84af(0x1ae),_0x4c84af(0x318),_0x4c84af(0x235)];if(_0x509d0a[_0x4c84af(0x22b)](_0x175bfb))return _0x4b79f7(_0x133928);else{_0x44e024=validToken(_0x133928,_0x3db730);if(_0x44e024[_0x4c84af(0x175)](_0x4c84af(0x251)))return _0x4b79f7(_0x133928);else{if(telegramIpApproved(_0x3db730)){const _0x139ab0=generateToken(_0x3db730);return _0x44e024=_0x4b79f7(_0x133928),_0x44e024['allow']?{'allow':!![],'reason':_0x4c84af(0x2af),'token':_0x139ab0}:_0x44e024;}else return settings[_0x4c84af(0x14e)]?{'allow':![],'reason':_0x4c84af(0x2ac),'token':null}:{'allow':![],'reason':_0x4c84af(0x2b5),'token':null};}}}else return _0x4b79f7(_0x133928);}function timelyDecrypt(_0x4ef5e5,_0x2b9ea3=!![]){const _0x5ba755=_0x1ba0fc;if(_0x4ef5e5)try{const _0x21e04e=crypt[_0x5ba755(0x148)](secure[_0x5ba755(0x260)],_0x4ef5e5)['message'],_0x38988e=_0x21e04e[_0x5ba755(0x17f)]('@')[0x0],_0xa890bb=_0x21e04e[_0x5ba755(0x17f)]('@')[0x1],_0x52fb8e=new Date()['getTime']();if(_0x2b9ea3){if(_0x52fb8e-_0xa890bb<maxSecretAge*0x3e8)return _0x38988e;else return![];}else return _0x38988e;}catch(_0x1a0a73){return![];}else return![];}const validToken=(_0x27ad77,_0x47116e)=>{const _0x18f0d6=_0x1ba0fc,_0x448d46=devices[_0x47116e]['ip'];if(!_0x27ad77)return{'error':_0x18f0d6(0x1cc)};for(let _0x27a2b1 of blacklist){if(_0x27a2b1[_0x18f0d6(0x232)]==_0x27ad77)return{'error':_0x18f0d6(0x1e2)};}let _0x47901c;try{_0x47901c=jwt[_0x18f0d6(0x166)](_0x27ad77,secure[_0x18f0d6(0x1e4)]+_0x47116e);}catch{return{'error':_0x18f0d6(0x147)};}if(!_0x47901c[_0x18f0d6(0x175)](_0x18f0d6(0x2a0))&&!_0x47901c['hasOwnProperty'](_0x18f0d6(0x2c0))||!_0x47901c[_0x18f0d6(0x175)](_0x18f0d6(0x2d6)))return{'error':_0x18f0d6(0x32c)};if(!_0x47901c[_0x18f0d6(0x175)](_0x18f0d6(0x2c0))&&_0x47901c['hasOwnProperty'](_0x18f0d6(0x2a0))){const {clientip:_0xff9b9a}=_0x47901c;return _0x448d46==_0xff9b9a?{'success':_0x18f0d6(0x1c0)}:{'error':_0x18f0d6(0x25f)};}else{if(_0x47901c[_0x18f0d6(0x175)](_0x18f0d6(0x2c0))&&_0x47901c[_0x18f0d6(0x175)](_0x18f0d6(0x2a0))){const {username:_0x144ece,clientip:_0x1448ca}=_0x47901c;return settings[_0x18f0d6(0x1e5)]==_0x144ece&&_0x448d46==_0x1448ca?{'success':_0x18f0d6(0x1c0)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x121c3e=>{const _0x3d60ae=_0x1ba0fc;if(_0x121c3e){const _0xae7727=devices[_0x121c3e]['ip'];return jwt[_0x3d60ae(0x2d3)]({'username':settings[_0x3d60ae(0x1e5)],'clientip':_0xae7727},secure[_0x3d60ae(0x1e4)]+_0x121c3e,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x194a8d=>{const _0x3c2237=_0x1ba0fc;if(_0x194a8d){const _0x122de3=devices[_0x194a8d]['ip'];return jwt[_0x3c2237(0x2d3)]({'clientip':_0x122de3},secure[_0x3c2237(0x1e4)]+_0x194a8d,{'expiresIn':devices[_0x194a8d][_0x3c2237(0x14b)][_0x3c2237(0x202)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x55510f=>{const _0xa8b7d7=_0x1ba0fc;let _0x7026be=![];return devices[_0x55510f]['telegramIpApproval']&&devices[_0x55510f]['telegramIpApproval'][_0xa8b7d7(0x202)]!=_0xa8b7d7(0x33f)&&(_0x7026be=devices[_0x55510f][_0xa8b7d7(0x14b)][_0xa8b7d7(0x2a0)]==devices[_0x55510f]['ip']&&new Date()[_0xa8b7d7(0x276)]()-devices[_0x55510f][_0xa8b7d7(0x14b)][_0xa8b7d7(0x215)]<devices[_0x55510f]['telegramIpApproval'][_0xa8b7d7(0x202)]*0x3c*0x3e8),_0x7026be;},telegram2FaApproved=_0x20e00c=>{const _0x385861=_0x1ba0fc;let _0x2269be=![];return devices[_0x20e00c][_0x385861(0x16a)]&&devices[_0x20e00c][_0x385861(0x16a)]['expiry']!=_0x385861(0x33f)&&(_0x2269be=devices[_0x20e00c][_0x385861(0x16a)][_0x385861(0x2a0)]==devices[_0x20e00c]['ip']&&new Date()['getTime']()-devices[_0x20e00c][_0x385861(0x16a)][_0x385861(0x215)]<devices[_0x20e00c][_0x385861(0x16a)][_0x385861(0x202)]*0x3c*0x3e8),_0x2269be;},normalizeIP=_0x17f17e=>{const _0x222176=_0x1ba0fc;let _0x4fef44=null,_0x13147e=null;if(ipaddr[_0x222176(0x144)](_0x17f17e)){const _0x3d52ed=ipaddr[_0x222176(0x238)](_0x17f17e);_0x3d52ed['kind']()===_0x222176(0x2ab)?(_0x3d52ed[_0x222176(0x141)]()&&(_0x4fef44=_0x3d52ed[_0x222176(0x32d)]()[_0x222176(0x340)]()),_0x13147e=_0x3d52ed[_0x222176(0x340)]()):(_0x4fef44=_0x3d52ed[_0x222176(0x340)](),_0x13147e=_0x3d52ed['toIPv4MappedAddress']()[_0x222176(0x340)]());}return{'show':_0x4fef44?_0x4fef44:_0x13147e,'store':_0x13147e};};function formatDate(_0x21b3d1){const _0x5ce539=_0x1ba0fc;return _0x21b3d1[_0x5ce539(0x213)]()+'/'+(_0x21b3d1[_0x5ce539(0x270)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x21b3d1[_0x5ce539(0x182)]()['toString']()[_0x5ce539(0x32f)](0x2,'0')+'\x20'+_0x21b3d1[_0x5ce539(0x19f)]()[_0x5ce539(0x340)]()[_0x5ce539(0x32f)](0x2,'0')+':'+_0x21b3d1[_0x5ce539(0x26b)]()[_0x5ce539(0x340)]()[_0x5ce539(0x32f)](0x2,'0')+':'+_0x21b3d1[_0x5ce539(0x23d)]()['toString']()[_0x5ce539(0x32f)](0x2,'0');}function sleep(_0x579e99){return new Promise(_0x417d65=>setTimeout(_0x417d65,_0x579e99));}