const _0x27f97a=_0xaeff;(function(_0x348aee,_0x22db89){const _0x10ff1f=_0xaeff,_0x2e75ce=_0x348aee();while(!![]){try{const _0x47647c=parseInt(_0x10ff1f(0x104))/0x1*(-parseInt(_0x10ff1f(0x15f))/0x2)+parseInt(_0x10ff1f(0x105))/0x3*(parseInt(_0x10ff1f(0x255))/0x4)+parseInt(_0x10ff1f(0x1c7))/0x5*(parseInt(_0x10ff1f(0x175))/0x6)+-parseInt(_0x10ff1f(0xda))/0x7+parseInt(_0x10ff1f(0x1f1))/0x8*(parseInt(_0x10ff1f(0x100))/0x9)+parseInt(_0x10ff1f(0x1b3))/0xa*(-parseInt(_0x10ff1f(0x274))/0xb)+-parseInt(_0x10ff1f(0x256))/0xc*(-parseInt(_0x10ff1f(0xf8))/0xd);if(_0x47647c===_0x22db89)break;else _0x2e75ce['push'](_0x2e75ce['shift']());}catch(_0x39890d){_0x2e75ce['push'](_0x2e75ce['shift']());}}}(_0x4483,0x1b1f0));const _0x119cbb=function(){let _0x5f3795=!![];return function(_0x464f42,_0x33de1c){const _0xd585c4=_0x5f3795?function(){const _0x3f2cd7=_0xaeff;if(_0x33de1c){const _0x28f838=_0x33de1c[_0x3f2cd7(0x14a)](_0x464f42,arguments);return _0x33de1c=null,_0x28f838;}}:function(){};return _0x5f3795=![],_0xd585c4;};}(),_0x31d583=_0x119cbb(this,function(){const _0x148c84=_0xaeff;return _0x31d583[_0x148c84(0x239)]()[_0x148c84(0x151)](_0x148c84(0xf7))['toString']()[_0x148c84(0x155)](_0x31d583)[_0x148c84(0x151)](_0x148c84(0xf7));});_0x31d583();'use strict';process['env'][_0x27f97a(0x18b)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x27f97a(0x26c)),low=require('lowdb'),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x27f97a(0x1d9)),crypto=require(_0x27f97a(0x11d)),Crypt=require(_0x27f97a(0x158))[_0x27f97a(0x1d5)],RSA=require(_0x27f97a(0x158))[_0x27f97a(0x220)],bcrypt=require(_0x27f97a(0x159)),jwt=require('jsonwebtoken'),ipaddr=require('ipaddr.js'),argv=require(_0x27f97a(0x218))(process[_0x27f97a(0x132)][_0x27f97a(0x143)](0x2))[_0x27f97a(0x132)],uuidRandom=require(_0x27f97a(0x1c0)),TelegramBot=require(_0x27f97a(0x179)),Mixpanel=require('mixpanel'),axios=require(_0x27f97a(0xf4)),{GraphQLClient,gql}=require(_0x27f97a(0xa0)),util=require(_0x27f97a(0xe4)),fileUpload=require(_0x27f97a(0x222)),{networkInterfaces}=require('os'),PORT=argv[_0x27f97a(0x27e)]||_0x27f97a(0x236),pattern=/^[0-9]{2,4}$/;!pattern[_0x27f97a(0x1d6)](PORT)&&(console['log'](_0x27f97a(0x23b)+PORT+_0x27f97a(0x202)),process['exit'](0x1));const HOST=argv['host']||null,userID=argv[_0x27f97a(0x12c)]||'',debugging=argv['d']||![],nodeversion=process[_0x27f97a(0x172)][_0x27f97a(0x1de)];let bbpath=_0x27f97a(0x128),bbpath2='';const botfile=_0x27f97a(0x1e6),configfile=_0x27f97a(0x168),settingsfile=_0x27f97a(0x1a1),securefile=_0x27f97a(0x21c),maxBackups=0xa;let validInstallation=!![];!fs[_0x27f97a(0x1b6)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x27f97a(0x17f)),configpath=userID?bbpath+_0x27f97a(0xe7)+userID+'/':bbpath+'config/',configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x27f97a(0x1bc)+userID+'/':bbpath+_0x27f97a(0x1bc),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x27f97a(0x1ee),loggerfile=fs['createWriteStream'](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x27f97a(0x1e7)+userID+'/':bbpath+_0x27f97a(0x1e7);!fs[_0x27f97a(0x1b6)](configpath)&&fs['mkdirSync'](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs['existsSync'](logspath)&&fs['mkdirSync'](logspath);!fs[_0x27f97a(0x1b6)](zippath)&&fs[_0x27f97a(0x26a)](zippath);!fs[_0x27f97a(0x1b6)](temppath)&&fs[_0x27f97a(0x26a)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);function _0x4483(){const _0x17bc66=['/:bot/support','Unauthorized\x20attempt\x20to\x20show\x20configuration','2336DSKWje','use','Invalid\x20IP\x20address','\x20|\x20','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','storeConfiguration','login\x20required','removeAllListeners','all','0.0.0','family','readFileSync','1000','min','\x20(2)','format','get',',\x20must\x20be\x20a\x204\x20digit\x20number','enabled','$1_$2_$3','30\x20min','reload','alerts','botID','login\x20token\x20generated','Server','download','isIPv4MappedAddress','Ok,\x20will\x20send\x20order\x20notifications\x20only','getFullYear','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','output-003.log','handshake','settings','Unauthorized\x20attempt\x20to\x20get\x20portfolio','internal','auto','HTML','telegramChatId','yargs/yargs','reset-history','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','store-fiat','bb-secure.json','event','telegram','hasOwnProperty','RSA','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','express-fileupload','https://api.ipify.org?format=json','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','stop','once','index.html','headless','backupfile','pidExpireLogin','pidRefreshToken','kind','2FA\x20login\x20required','getDate','Starting\x20Balance\x20Bot\x20','Node.js\x20v','from','running','::1','\x1b[31m','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','3000','f2aRequired','/:bot/coins','toString','IPv4','Error:\x20Invalid\x20argument\x20','invalid\x20credentials','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','backup-files','Session\x20expired\x20for\x20user\x20...','\x20|\x20user:\x20...','Unauthorized\x20attempt\x20to\x20delete\x20alerts','listen','map','writeFileSync','remove','Invalid\x20authentication\x20token\x20(1)','404\x20Not\x20Found','callback_query','onepagemode','apiSecret','show','sendMessage','getPortfolio','Invalid\x20Telegram\x20token','Restarting\x20Bot\x20','binary',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','\x1b[0m','telegramIpApproval','Notifications\x20disabled\x0a','48068PmIJPt','12XfQUeZ','expiry','backup','botname','uuid','push','settings.','find','Error\x20while\x20deleting\x20config\x20files:\x20','update','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','unlinkSync','You\x20can\x20use\x20the\x20following\x20commands:\x0a','private','#RES#\x20if\x20running\x20locally\x0a','reset-password','Password\x20has\x20been\x20reset\x20to:\x20','alias','Unauthorized\x20attempt\x20to\x20delete\x20bot','then','mkdirSync','string','date-fns','file','answerCallbackQuery','*$1*','confirm-message','/:bot/configuration','getHours','copyFileSync','6886OXtLJy','/upload-backup','latestversion','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','name','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','encryptedUuid','/metrics\x20-\x20show\x20bot\x20performance\x0a','Restore\x20backup\x20file\x20','polling_error','port','match','endsWith','***','includes','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','clientip','Unauthorized\x20attempt\x20to\x20update\x20bot','graphql-request','exp','size','forEach','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','conn','stopped','access','SIGTERM','output-002.log','127.0.0.1','headers','/help\x20-\x20show\x20available\x20commands\x0a','simple','telegramEnabled','value','exit','mtime','getSeconds','************','temporary\x20access\x20not\x20allowed','Password\x20reset\x20rejected','stringify','store-configuration','whitelistEnabled','emitHistory','2FA','status','Unauthorized\x20attempt\x20to\x20download\x20','messages','</b>\x20?','No\x20bots\x20running\x20right\x20now','-events.json','data','replace','getMinutes','randomFillSync','sendPortfolioTelegram','join','catch','cancelLoading','success','remoteAddress','isDirectory','\x20only\x0a','logout','node-zip','Invalid\x20username\x20or\x20IP\x20address','2FA\x20required','Your\x20installation\x20is\x20already\x20up\x20to\x20date','init','allow','ipc','generateKeyPairAsync','Unauthorized\x20attempt\x20to\x20get\x20events','login','Enabled\x20Bot\x20','initclient','1253224WcuPol','accept','connected','resetHistory','\x20>\x20','apiKey','defaults',':\x20Bot\x20Mgr\x20>\x20','get-portfolio','userid','util','function','Restore\x20process\x20aborted','config/','timestamp','stopPolling','getStartingBalances','token','warning','secure','Disabled\x20Bot\x20','post','2FA\x20login\x20rejected','connection','title','bot','axios','sha256','manual','(((.+)+)+)+$','4225325SJSmxG','getUTCHours','Notifications\x20enabled','=>\x20Go\x20to\x20#CYA#http://','Starting\x20new\x20bot\x20|\x20Bot\x20','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','length','Notifications\x20enabled\x0a','1044QvGUsn','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','/on\x20-\x20start\x20bot(s)\x0a','add','200382FDmgcN','3LCCUQX','Markdown','deleteHistoryAlerts','SIGINT','Backup\x20file\x20uploaded','sign','number','Login\x20rejected','build2','whitelist','secret','type','yes','store','Unauthorized\x20attempt\x20to\x20confirm\x20message','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','telegram2FaApproval','bot-','sockets','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','mode','split','temporary\x20token\x20generated','crypto','cancel-loading','#RES#\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','live','kill','update-bot','RSA-OAEP','readdirSync','hashSync','\x1b[35m','bb/','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','uncaughtException','lastmsgtelegram','user','/names\x20-\x20show\x20bot\x20names\x0a','temporary\x20access\x20timeout','updatebotmanager','/:bot/history','6b67f3d61ee94b8f5c80b4affef4c4d9','argv','\x20mode','get-backup-files','range','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Access\x20enabled\x20for\x20','Network\x20Interfaces:','Starting\x20#RED#Balance\x20Bot\x20v','request','Ok,\x20will\x20send\x20alert\x20notifications\x20only','createServer','Yes','backup-full','inherit','http','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','slice','version','bbvReceive','reject','error','get-messages','order','apply','debug','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','apiPassword','Unauthorized\x20attempt\x20to\x20add\x20bot','Starting\x20bot\x20|\x20Bot\x20','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','search','version.json','Notifications\x20disabled','Orders','constructor','login\x20token\x20valid',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','hybrid-crypto-js','bcryptjs','get-starting-balances','full','Alerts','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','.zip','2bjYxTD','set','log','telegramEvents','onText','chat','telegrammsg','address','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','bb-config.json','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Deleted\x20Bot\x20','emit','-performance.json','Error\x20removing\x20old\x20backup\x20files:','botmanager','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','statSync','loginRequired','versions','args','startsWith','111942AUXMKp','Logged\x20out\x20user\x20...','any','[ip-address]','node-telegram-bot-api','::ffff:127.0.0.1','store-settings','add-bot','Allow\x20login\x20from\x20IP\x20address\x20<b>','\x20(1)','clients','publicKey','sortBy','bots','/status\x20-\x20show\x20bot(s)\x20status\x0a','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','\x1b[36m','referer','storeHeadless','timeshift','Unauthorized\x20attempt\x20to\x20get\x20messages','bbUsername','NTBA_FIX_319','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','5\x20min','reason','reinstall','Failed\x20to\x20download\x20','sendMetricsTelegram','lastmsgemitted','username','keys','logged\x20out','write','telegramToken','login\x20not\x20required','get-logs','All\x20bots\x20running\x20right\x20now','telegramUsername','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','filter','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','send','Unauthorized\x20login\x20attempt\x20(timeout)','bb-settings.json','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','-config.json','files','toIPv4MappedAddress','getTime','message','File\x20uploaded','auth','<b>Telegram\x20Bot\x20Status:</b>\x0a','show-config','decrypt','User\x20has\x20been\x20validated','store-headless','compareSync','\x20to\x20','update-bb','exec','1070KyFZuc','padStart','/enable\x20-\x20enable\x20notifications\x0a','existsSync','getMonth','rmSync','restart','output-000.log','Backup\x20file\x20unzipped\x20and\x20stored','logs/','static','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','orders','uuid-random','disconnect','cloneDeep','started','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','exchange','output-001.log','50AnHWha','backup-full@','\x20|\x20client:\x20...','blacklist','access\x20timeout','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','bbvNew','-results.json','/:bot','2FA\x20login\x20token\x20generated','bbPassword','privateKey','placeOrder','Unauthorized\x20attempt\x20to\x20log\x20out','Crypt','test','logs','new','path','sendFile','entries','removeListener','assign','node','api-eu.mixpanel.com','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','build','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','-----------------------------------------------------------------------------------','parse','disabled','bot.js','temp/','sort','new-disabled','params','showConfig','/disable\x20-\x20disable\x20notifications\x0a','Bot\x20','zip/'];_0x4483=function(){return _0x17bc66;};return _0x4483();}dbConfig[_0x27f97a(0xe0)]({'bots':[]})[_0x27f97a(0x196)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x27f97a(0xe0)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x27f97a(0x1fa),'onepagemode':![]}})[_0x27f97a(0x196)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x27f97a(0xe0)]({'secure':{},'blacklist':[]})[_0x27f97a(0x196)]();let crypt=new Crypt({'md':_0x27f97a(0xf5),'rsaStandard':_0x27f97a(0x124)});const saltRounds=0xa,mixpanel=Mixpanel[_0x27f97a(0xd2)](_0x27f97a(0x131),{'host':_0x27f97a(0x1df)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x27f97a(0x197)]&&settings['telegramToken']!=''&&settings[_0x27f97a(0x19b)]&&settings[_0x27f97a(0x19b)]!='')initTelegram();const parseColor=(_0x319c6e,_0x202e29)=>{const _0x4e6a7a=_0x27f97a,_0x2b3b69=/#[A-Z]{3}#/g;if(typeof _0x319c6e==_0x4e6a7a(0x26b)){!_0x202e29?_0x319c6e=_0x319c6e[_0x4e6a7a(0xc2)](_0x2b3b69,''):(_0x319c6e=_0x319c6e[_0x4e6a7a(0xc2)](/#BLU#/g,'\x1b[34m'),_0x319c6e=_0x319c6e[_0x4e6a7a(0xc2)](/#RED#/g,_0x4e6a7a(0x234)),_0x319c6e=_0x319c6e[_0x4e6a7a(0xc2)](/#YEL#/g,'\x1b[33m'),_0x319c6e=_0x319c6e['replace'](/#MAG#/g,_0x4e6a7a(0x127)),_0x319c6e=_0x319c6e['replace'](/#CYA#/g,_0x4e6a7a(0x185)),_0x319c6e=_0x319c6e[_0x4e6a7a(0xc2)](/#RES#/g,_0x4e6a7a(0x252)));;}return _0x319c6e;},logger={'screen':_0x3c3647=>{const _0x15fa88=_0x27f97a;console[_0x15fa88(0x161)](parseColor(_0x3c3647,!![]));},'simple':_0x2b8d0a=>{const _0xa76036=_0x27f97a;console[_0xa76036(0x161)](parseColor(_0x2b8d0a,!![])),loggerfile[_0xa76036(0x196)](util[_0xa76036(0x200)](parseColor(_0x2b8d0a,![]))+'\x0a');},'full':async _0x326b6b=>{const _0x2ee0ae=_0x27f97a,_0x19038d=getTimeStamp()+_0x2ee0ae(0xe1)+_0x326b6b;console[_0x2ee0ae(0x161)](parseColor(_0x19038d,!![])),loggerfile[_0x2ee0ae(0x196)](util[_0x2ee0ae(0x200)](parseColor(_0x19038d,![]))+'\x0a');if(tgBot&&settings[_0x2ee0ae(0x217)]&&settings[_0x2ee0ae(0x162)]!=_0x2ee0ae(0x1bf))await tgBot[_0x2ee0ae(0x24c)](settings[_0x2ee0ae(0x217)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x326b6b,![]))[_0x2ee0ae(0xc7)](_0xb382bc=>{telegramError(_0xb382bc);});},'debug':async(_0x165d47,_0x39aa12='')=>{const _0x4f0e85=_0x27f97a,_0x5e7d9=getTimeStamp()+_0x4f0e85(0x251)+_0x165d47;if(debugging)console[_0x4f0e85(0x161)](parseColor(_0x5e7d9,!![]));loggerfile['write'](util[_0x4f0e85(0x200)](parseColor(_0x5e7d9,![]))+'\x0a');if(_0x39aa12){if(debugging)console[_0x4f0e85(0x161)](_0x39aa12);loggerfile[_0x4f0e85(0x196)](util['format'](_0x39aa12)+'\x0a');}}};process['on'](_0x27f97a(0x12a),function(_0x2daaf8){const _0x4e6d48=_0x27f97a;logger[_0x4e6d48(0xad)](_0x2daaf8);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x27f97a(0x152))[_0x27f97a(0x144)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x27f97a(0x140))[_0x27f97a(0x13c)](app);app[_0x27f97a(0x1f2)](fileUpload({'useTempFiles':!![]})),app[_0x27f97a(0x201)]('/download/:type',async(_0x51cf32,_0x4a2746)=>{const _0x2cb721=_0x27f97a,_0x175117=_0x51cf32[_0x2cb721(0x1ea)][_0x2cb721(0x110)],_0x1318c1=getClientsWithBotID('botmanager'),_0x199691=_0x51cf32[_0x2cb721(0xab)][_0x2cb721(0x25a)],_0x4bdd0d=timelyDecrypt(_0x199691,![]),_0x261187=_0x1318c1['find'](_0x8a6f70=>_0x8a6f70[_0x2cb721(0x25a)]==_0x4bdd0d);if(_0x261187){const _0x41d87d=normalizeIP(_0x51cf32['socket'][_0x2cb721(0xca)])[_0x2cb721(0x112)],_0x21eb4f=_0x51cf32[_0x2cb721(0xab)]['tkn'];if(validateAccess(_0x21eb4f,_0x4bdd0d,_0x41d87d)[_0x2cb721(0xd3)])_0x175117==_0x2cb721(0x258)&&await backupConfigFiles(),await zipFiles(_0x175117),_0x4a2746[_0x2cb721(0x20b)](zippath+(_0x175117+_0x2cb721(0x15e)),_0x5dcb86=>{const _0x34ad3a=_0x2cb721;_0x5dcb86&&(logger[_0x34ad3a(0x15b)](_0x34ad3a(0x190)+_0x175117),logger['simple'](_0x5dcb86));});else logger['full'](_0x2cb721(0xbc)+_0x175117+_0x2cb721(0x17e));}else logger['full'](_0x2cb721(0xbc)+_0x175117+_0x2cb721(0x1ff));}),app[_0x27f97a(0xef)](_0x27f97a(0x275),async(_0x35dd88,_0xc4ce13)=>{const _0x5420b8=_0x27f97a,_0x8755b2=getClientsWithBotID(_0x5420b8(0x16e)),_0x2edd8a=_0x35dd88[_0x5420b8(0xab)][_0x5420b8(0x25a)],_0x270168=timelyDecrypt(_0x2edd8a,![]),_0x4e2faa=_0x8755b2[_0x5420b8(0x25d)](_0x101a47=>_0x101a47[_0x5420b8(0x25a)]==_0x270168);logger[_0x5420b8(0x14b)](_0x5420b8(0x109));if(_0x4e2faa){const _0x4c7479=normalizeIP(_0x35dd88['socket'][_0x5420b8(0xca)])[_0x5420b8(0x112)],_0x1a86cd=_0x35dd88[_0x5420b8(0xab)]['tkn'];if(validateAccess(_0x1a86cd,_0x270168,_0x4c7479)[_0x5420b8(0xd3)]){if(_0x35dd88[_0x5420b8(0x1a4)]){const _0x1c4897=_0x35dd88[_0x5420b8(0x1a4)][_0x5420b8(0x229)];await _0x1c4897['mv'](temppath+_0x1c4897['name']),_0xc4ce13[_0x5420b8(0x19f)]({'status':!![],'message':_0x5420b8(0x1a8)});const _0x538402=getBotsWithMode();_0x538402[_0x5420b8(0xfe)]>0x0?confirmRestore(temppath,_0x1c4897['name']):unzipFile(temppath,_0x1c4897[_0x5420b8(0x278)]);}}else logger[_0x5420b8(0x15b)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x5420b8(0x15b)](_0x5420b8(0x1e2));}),app[_0x27f97a(0x1f2)](express[_0x27f97a(0x1bd)](path[_0x27f97a(0xc6)](__dirname,bbpath2,_0x27f97a(0x10d)))),app[_0x27f97a(0x1f2)](express[_0x27f97a(0x1bd)](path[_0x27f97a(0xc6)](__dirname,bbpath2,'build'))),app['get']('/',function(_0x451401,_0x4631d1){const _0x360b90=_0x27f97a;_0x4631d1[_0x360b90(0x1da)](path['join'](__dirname,bbpath2,_0x360b90(0x10d),_0x360b90(0x227)));}),app[_0x27f97a(0x201)](_0x27f97a(0x1cf),function(_0x2ba9e7,_0x524f38){const _0x13e863=_0x27f97a;_0x524f38[_0x13e863(0x1da)](path[_0x13e863(0xc6)](__dirname,bbpath2,_0x13e863(0x1e1),'index.html'));}),app[_0x27f97a(0x201)]('/:bot/portfolio',(_0x4f8187,_0x43b4ac)=>{const _0x3a55b8=_0x27f97a;_0x43b4ac[_0x3a55b8(0x1da)](path[_0x3a55b8(0xc6)](__dirname,bbpath2,_0x3a55b8(0x1e1),_0x3a55b8(0x227)));}),app[_0x27f97a(0x201)]('/:bot/performance',(_0x2fab27,_0x16981f)=>{const _0x2cd1da=_0x27f97a;_0x16981f['sendFile'](path[_0x2cd1da(0xc6)](__dirname,bbpath2,_0x2cd1da(0x1e1),'index.html'));}),app[_0x27f97a(0x201)](_0x27f97a(0x238),(_0x476521,_0x5c9a1b)=>{const _0x4fb32e=_0x27f97a;_0x5c9a1b['sendFile'](path[_0x4fb32e(0xc6)](__dirname,bbpath2,_0x4fb32e(0x1e1),_0x4fb32e(0x227)));}),app[_0x27f97a(0x201)](_0x27f97a(0x130),(_0x48608d,_0x3da108)=>{const _0x3be21e=_0x27f97a;_0x3da108[_0x3be21e(0x1da)](path[_0x3be21e(0xc6)](__dirname,bbpath2,_0x3be21e(0x1e1),_0x3be21e(0x227)));}),app['get'](_0x27f97a(0x271),(_0x1f6222,_0x4dc34f)=>{const _0x2c493a=_0x27f97a;_0x4dc34f[_0x2c493a(0x1da)](path['join'](__dirname,bbpath2,_0x2c493a(0x1e1),'index.html'));}),app['get'](_0x27f97a(0x1ef),(_0x59a56c,_0x27b5c3)=>{const _0x44835d=_0x27f97a;_0x27b5c3[_0x44835d(0x1da)](path[_0x44835d(0xc6)](__dirname,bbpath2,'build',_0x44835d(0x227)));});if(HOST)http[_0x27f97a(0x242)](PORT,HOST);else http['listen'](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x4b0541=_0x27f97a;let _0x10ceff=_0x4b0541(0x178);const _0x5a56ea=networkInterfaces(),_0x7e833f={};for(const _0x2ddc43 of Object[_0x4b0541(0x194)](_0x5a56ea)){for(const _0x21ca6d of _0x5a56ea[_0x2ddc43]){if((_0x21ca6d[_0x4b0541(0x1fb)]==_0x4b0541(0x23a)||_0x21ca6d[_0x4b0541(0x1fb)]==0x4)&&!_0x21ca6d[_0x4b0541(0x214)]){const _0x3838ca=ipaddr[_0x4b0541(0x1e4)](_0x21ca6d[_0x4b0541(0x166)])[_0x4b0541(0x135)]();_0x3838ca!=_0x4b0541(0x263)&&(!_0x7e833f[_0x2ddc43]&&(_0x7e833f[_0x2ddc43]=[]),_0x7e833f[_0x2ddc43]['push'](_0x21ca6d[_0x4b0541(0x166)]),_0x10ceff=_0x21ca6d[_0x4b0541(0x166)]);}}}return{'serverip':_0x10ceff,'netinterfaces':_0x7e833f};}async function startServer(){const _0x49d79f=_0x27f97a,{serverip:_0x10d900,netinterfaces:_0x45d97c}=getServerIP();logger[_0x49d79f(0xad)](''),logger[_0x49d79f(0xad)]('-----------------------------------------------------------------------------------'),await logger['full'](_0x49d79f(0x139)+serverversion+_0x49d79f(0x11f)+(_0x49d79f(0x15d)+PORT+_0x49d79f(0x264))+(_0x49d79f(0xfb)+_0x10d900+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger['simple'](_0x49d79f(0x1e3));if(config['length']!=0x0)for(const _0xd4cd12 of config){if(_0xd4cd12[_0x49d79f(0xbb)]=='enabled'||_0xd4cd12[_0x49d79f(0xbb)]==_0x49d79f(0x1d8))await logger[_0x49d79f(0x15b)](_0x49d79f(0x14f)+_0xd4cd12[_0x49d79f(0x208)]+_0x49d79f(0x1f4)+_0xd4cd12[_0x49d79f(0x259)]),startBot([_0xd4cd12[_0x49d79f(0x208)],userID],{'cwd':bbpath},function(_0x138388){const _0x2b264b=_0x49d79f;if(_0x138388)logger[_0x2b264b(0x15b)](_0x138388);});else(_0xd4cd12['status']==_0x49d79f(0x1e5)||_0xd4cd12[_0x49d79f(0xbb)]==_0x49d79f(0x1e9))&&await logger[_0x49d79f(0x15b)]('Idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0xd4cd12['botID']+_0x49d79f(0x1f4)+_0xd4cd12[_0x49d79f(0x259)]);}else!newBot&&logger['simple'](_0x49d79f(0x169));if(newBot)addBot();logger[_0x49d79f(0xad)](_0x49d79f(0x1e3)),logger['simple'](''),await logger[_0x49d79f(0x14b)](_0x49d79f(0x230)+nodeversion),await logger[_0x49d79f(0x14b)](_0x49d79f(0x138),_0x45d97c);}function startSocket(){const _0x3428d8=_0x27f97a;io['on'](_0x3428d8(0xf1),_0x44ab65=>{const _0x4b56e5=_0x3428d8;let _0x220679,_0x2a44ce,_0x309b66,_0x1e6a8b,_0x59e8ea;const _0x4117e4=_0x44ab65[_0x4b56e5(0x211)][_0x4b56e5(0xab)][_0x4b56e5(0x186)];_0x2a44ce=_0x4117e4[_0x4b56e5(0x27f)](/bot[0-9]{3}/);if(_0x2a44ce)_0x309b66=_0x2a44ce[0x0][_0x4b56e5(0x27f)](/[0-9]{3}/);if(_0x309b66)_0x220679=_0x309b66[0x0];else _0x220679='botmanager';const _0xc227db=_0x44ab65[_0x4b56e5(0x211)][_0x4b56e5(0x1a9)][_0x4b56e5(0x27a)];if(!_0xc227db)_0x44ab65['emit'](_0x4b56e5(0xbb),{'publicKey':secure[_0x4b56e5(0x180)]});else{_0x1e6a8b=timelyDecrypt(_0xc227db,![]);if(!_0x1e6a8b)_0x44ab65[_0x4b56e5(0x16b)]('status',{'publicKey':secure[_0x4b56e5(0x180)]});else{_0x59e8ea=normalizeIP(_0x44ab65[_0x4b56e5(0xa5)][_0x4b56e5(0xca)])[_0x4b56e5(0x112)];if(!devices[_0x1e6a8b])devices[_0x1e6a8b]={'uuid':_0x1e6a8b,'access':{'token':null}};devices[_0x1e6a8b]['ip']=_0x59e8ea;const _0x40e4f1=addClient(_0x44ab65['id'],_0x1e6a8b,_0x220679);setAccess(_0x40e4f1),emitMessages(),_0x44ab65['on'](_0x4b56e5(0xd7),_0x2d028c=>{const _0x14504e=_0x4b56e5,_0x526f94=timelyDecrypt(_0x2d028c['password']);if(_0x526f94){_0x2d028c={'username':_0x2d028c[_0x14504e(0x193)],'password':_0x526f94},devices[_0x1e6a8b][_0x14504e(0xa7)]=validateCredentials(_0x2d028c,_0x1e6a8b);if(devices[_0x1e6a8b][_0x14504e(0xa7)][_0x14504e(0xd3)]==![]&&devices[_0x1e6a8b][_0x14504e(0xa7)]['reason']==_0x14504e(0x22d))_0x44ab65[_0x14504e(0x16b)](_0x14504e(0xbb),{'access':devices[_0x1e6a8b][_0x14504e(0xa7)]}),loginAccess2FA(_0x1e6a8b,_0x59e8ea);else{if(devices[_0x1e6a8b][_0x14504e(0xa7)]['allow']==![]&&devices[_0x1e6a8b]['access'][_0x14504e(0x18e)]=='invalid\x20credentials')_0x44ab65[_0x14504e(0x16b)](_0x14504e(0xbb),{'access':devices[_0x1e6a8b][_0x14504e(0xa7)]});else devices[_0x1e6a8b]['access'][_0x14504e(0xd3)]&&devices[_0x1e6a8b][_0x14504e(0xa7)][_0x14504e(0x18e)]==_0x14504e(0x209)&&(getClientsWithUuid(_0x1e6a8b)[_0x14504e(0xa3)](_0x1576df=>{setAccess(_0x1576df);}),logger[_0x14504e(0x14b)]('Logged\x20in\x20user\x20...'+_0x1e6a8b['slice'](-0x8)),setTokenRefresh(_0x1e6a8b),setSessionTimeout(_0x14504e(0xd7),_0x1e6a8b));}}else logger[_0x14504e(0x15b)](_0x14504e(0x1a0));}),_0x44ab65['on'](_0x4b56e5(0x265),()=>{resetPassword();}),_0x44ab65['on']('disconnect',_0x39c31f=>{removeClient(_0x44ab65['id']);}),_0x220679=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4a8854){const _0xc2c081=_0x27f97a;if(_0x4a8854!=_0xc2c081(0x16e)&&config['apiKey']!=''){if(pid[_0x4a8854])pid[_0x4a8854]['send']({'function':_0xc2c081(0xd9),'args':null});}_0x4a8854!='botmanager'&&broadcastToBots('bots',JSON[_0xc2c081(0xb6)](config));}function reloadBotManager(){const _0x38f359=_0x27f97a;getClientsWithBotID(_0x38f359(0x16e))[_0x38f359(0xa3)](_0x1b7123=>{const _0x90f77b=_0x38f359;getSocket(_0x1b7123['id'])[_0x90f77b(0x16b)]('status',{'access':{'allow':![],'reason':_0x90f77b(0x206),'token':null}});});}function getSocket(_0x34c990){const _0x143e09=_0x27f97a;return io[_0x143e09(0x118)][_0x143e09(0x118)][_0x143e09(0x201)](_0x34c990);}function setAccess(_0x4cea56){const _0x3f665c=_0x27f97a,_0x5f4c66=getSocket(_0x4cea56['id']),_0x47cf8c=_0x4cea56[_0x3f665c(0x25a)],_0x417700=_0x4cea56[_0x3f665c(0xf3)];devices[_0x47cf8c][_0x3f665c(0xa7)]=validateAccess(devices[_0x47cf8c][_0x3f665c(0xa7)][_0x3f665c(0xeb)],_0x47cf8c),logger['debug']('Setting\x20access:\x20'+devices[_0x47cf8c]['access'][_0x3f665c(0x18e)]+_0x3f665c(0x1c9)+_0x4cea56['id'][_0x3f665c(0x143)](-0x8)+_0x3f665c(0x240)+_0x47cf8c[_0x3f665c(0x143)](-0x8)),_0x5f4c66['join'](_0x47cf8c);if(devices[_0x47cf8c]['access']['allow']){_0x5f4c66[_0x3f665c(0xc6)](_0x417700);if(_0x417700==_0x3f665c(0x16e))initializeSocketBotManager(_0x5f4c66);else initializeSocketBot(_0x5f4c66);initClient(_0x417700);}devices[_0x47cf8c][_0x3f665c(0xa7)][_0x3f665c(0xeb)]&&devices[_0x47cf8c][_0x3f665c(0xa7)]['reason']==_0x3f665c(0x11c)&&setSessionTimeout(_0x3f665c(0xba),_0x47cf8c),devices[_0x47cf8c][_0x3f665c(0xa7)]['token']&&devices[_0x47cf8c]['access'][_0x3f665c(0x18e)]==_0x3f665c(0x1d0)&&setSessionTimeout(_0x3f665c(0xd7),_0x47cf8c),_0x5f4c66[_0x3f665c(0x16b)]('status',{'status':_0x4cea56['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x47cf8c][_0x3f665c(0xa7)],'externalip':devices[_0x47cf8c]['ip'],'publicKey':secure[_0x3f665c(0x180)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x47cf8c][_0x3f665c(0xa7)]['allow']==![]&&devices[_0x47cf8c]['access'][_0x3f665c(0x18e)]=='2FA\x20required'&&temporaryAccess2FA(_0x47cf8c,devices[_0x47cf8c]['ip']);}function setSessionTimeout(_0x551f25,_0x4ecc6b){const _0x969b43=_0x27f97a;let _0xa3e502;if(_0x551f25=='login')_0xa3e502=loginExpiry*0x3c*0x3e8;else _0xa3e502=devices[_0x4ecc6b][_0x969b43(0x253)][_0x969b43(0x257)]*0x3c*0x3e8-(new Date()[_0x969b43(0x1a6)]()-devices[_0x4ecc6b][_0x969b43(0x253)][_0x969b43(0xe8)]);if(devices[_0x4ecc6b][_0x969b43(0x22a)])clearTimeout(devices[_0x4ecc6b]['pidExpireLogin']);devices[_0x4ecc6b][_0x969b43(0x22a)]=setTimeout(()=>{const _0x1215c3=_0x969b43;if(devices[_0x4ecc6b][_0x1215c3(0x22b)])clearTimeout(devices[_0x4ecc6b][_0x1215c3(0x22b)]);removeSocketListeners(_0x4ecc6b),addBlacklist(_0x4ecc6b),devices[_0x4ecc6b]['telegramIpApproval']=null,devices[_0x4ecc6b][_0x1215c3(0x116)]=null,devices[_0x4ecc6b][_0x1215c3(0xa7)]['token']=null,logger[_0x1215c3(0x14b)](_0x1215c3(0x23f)+_0x4ecc6b[_0x1215c3(0x143)](-0x8)),devices[_0x4ecc6b]['access']=validateAccess(devices[_0x4ecc6b][_0x1215c3(0xa7)][_0x1215c3(0xeb)],_0x4ecc6b),!(devices[_0x4ecc6b][_0x1215c3(0xa7)]['allow']&&devices[_0x4ecc6b][_0x1215c3(0xa7)][_0x1215c3(0x18e)]==_0x1215c3(0x198))&&(_0x551f25==_0x1215c3(0xd7)?io['to'](_0x4ecc6b)[_0x1215c3(0x16b)](_0x1215c3(0xbb),{'access':{'allow':![],'reason':_0x1215c3(0x1cb),'token':null}}):io['to'](_0x4ecc6b)[_0x1215c3(0x16b)](_0x1215c3(0xbb),{'access':{'allow':![],'reason':_0x1215c3(0x12e),'token':null}})),devices[_0x4ecc6b]['access'][_0x1215c3(0xeb)]=null;},_0xa3e502);}function setTokenRefresh(_0x1665c1){const _0x4a03f1=_0x27f97a;if(devices[_0x1665c1][_0x4a03f1(0x22b)])clearTimeout(devices[_0x1665c1][_0x4a03f1(0x22b)]);devices[_0x1665c1][_0x4a03f1(0x22b)]=setTimeout(()=>{const _0x59d78c=_0x4a03f1;getClientsWithUuid(_0x1665c1)[_0x59d78c(0xfe)]!=0x0?(devices[_0x1665c1][_0x59d78c(0xa7)]=refreshToken(_0x1665c1),io['to'](_0x1665c1)['emit'](_0x59d78c(0xbb),{'status':_0x59d78c(0xdc),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x1665c1][_0x59d78c(0xa7)],'externalip':devices[_0x1665c1]['ip'],'publicKey':secure[_0x59d78c(0x180)],'validInstallation':validInstallation}),setTokenRefresh(_0x1665c1)):clearTimeout(devices[_0x1665c1][_0x59d78c(0x22b)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4f635b){const _0x25ffef=_0x27f97a,_0x16828e=getClient(_0x4f635b['id'])[_0x25ffef(0x25a)];_0x4f635b[_0x25ffef(0x16b)]('bots',config),_0x4f635b[_0x25ffef(0x16b)](_0x25ffef(0x212),cleanSettings()),_0x4f635b['on'](_0x25ffef(0x17c),_0x400157=>{const _0x52cb12=_0x25ffef;if(validateAccess(_0x400157,_0x16828e)[_0x52cb12(0xd3)])addBot();else logger['full'](_0x52cb12(0x14e));}),_0x4f635b['on'](_0x25ffef(0x123),(_0x9b02c0,_0x26ea06)=>{const _0x3a285b=_0x25ffef;if(validateAccess(_0x26ea06,_0x16828e)[_0x3a285b(0xd3)])toggleBot(_0x9b02c0[_0x3a285b(0x208)],_0x9b02c0[_0x3a285b(0xbb)],_0x9b02c0['live']);else logger[_0x3a285b(0x15b)](_0x3a285b(0x9f));}),_0x4f635b['on']('toggle-bot-mode',(_0x2e676c,_0x10636e)=>{const _0x4145b9=_0x25ffef;if(validateAccess(_0x10636e,_0x16828e)[_0x4145b9(0xd3)])toggleBotMode(_0x2e676c);else logger[_0x4145b9(0x15b)](_0x4145b9(0x9f));}),_0x4f635b['on']('delete-bot',(_0x2aa2c3,_0x4dab33)=>{const _0x5a679a=_0x25ffef;if(validateAccess(_0x4dab33,_0x16828e)[_0x5a679a(0xd3)])deleteBot(_0x2aa2c3);else logger[_0x5a679a(0x15b)](_0x5a679a(0x268));}),_0x4f635b['on'](_0x25ffef(0x17b),(_0x16e2b0,_0x2ded21)=>{const _0x1e3757=_0x25ffef;if(validateAccess(_0x2ded21,_0x16828e)[_0x1e3757(0xd3)])storeSettings(_0x16e2b0,!![]);else logger[_0x1e3757(0x15b)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x4f635b['on'](_0x25ffef(0x1b1),_0x3b2851=>{const _0xc0590b=_0x25ffef;if(validateAccess(_0x3b2851,_0x16828e)[_0xc0590b(0xd3)])updateBB(_0xc0590b(0x25f));else logger['full'](_0xc0590b(0x1cc));}),_0x4f635b['on']('reinstall-bb',_0x327142=>{const _0x456029=_0x25ffef;if(validateAccess(_0x327142,_0x16828e)[_0x456029(0xd3)])updateBB(_0x456029(0x18f));else logger[_0x456029(0x15b)](_0x456029(0x167));}),_0x4f635b['on'](_0x25ffef(0x134),_0x5274ff=>{const _0x48b983=_0x25ffef;if(validateAccess(_0x5274ff,_0x16828e)['allow']){const _0x20b2db=getClient(_0x4f635b['id']);if(_0x20b2db)getBackupFiles(_0x20b2db[_0x48b983(0x25a)]);else logger[_0x48b983(0x15b)](_0x48b983(0x224));}else logger[_0x48b983(0x15b)](_0x48b983(0x21a));}),_0x4f635b['on']('restore-backup-file',(_0x21d16e,_0x5b9839)=>{const _0x4df69d=_0x25ffef;if(validateAccess(_0x5b9839,_0x16828e)[_0x4df69d(0xd3)])restoreBackupFile(_0x21d16e);else logger[_0x4df69d(0x15b)](_0x4df69d(0x235));}),_0x4f635b['on']('get-messages',_0x3b45df=>{const _0x338123=_0x25ffef;if(validateAccess(_0x3b45df,_0x16828e)[_0x338123(0xd3)])getMessages();else logger[_0x338123(0x15b)](_0x338123(0x189));}),_0x4f635b['on'](_0x25ffef(0x270),(_0x2c8ea8,_0x33ec47)=>{const _0x298ed6=_0x25ffef;if(validateAccess(_0x33ec47,_0x16828e)[_0x298ed6(0xd3)])confirmMessage(_0x2c8ea8);else logger[_0x298ed6(0x15b)](_0x298ed6(0x113));}),_0x4f635b['on']('logout',_0xd2ec88=>{const _0x4d4c3c=_0x25ffef;if(validateAccess(_0xd2ec88,_0x16828e)[_0x4d4c3c(0xd3)]){if(devices[_0x16828e][_0x4d4c3c(0x22b)])clearTimeout(devices[_0x16828e]['pidRefreshToken']);if(devices[_0x16828e]['pidExpireLogin'])clearTimeout(devices[_0x16828e]['pidExpireLogin']);removeSocketListeners(getClient(_0x4f635b['id'])[_0x4d4c3c(0x25a)]),addBlacklist(_0x16828e),devices[_0x16828e][_0x4d4c3c(0x253)]=null,devices[_0x16828e][_0x4d4c3c(0x116)]=null,devices[_0x16828e][_0x4d4c3c(0xa7)]['token']=null,logger['debug'](_0x4d4c3c(0x176)+_0x16828e[_0x4d4c3c(0x143)](-0x8)),io['to'](getClient(_0x4f635b['id'])['uuid'])[_0x4d4c3c(0x16b)](_0x4d4c3c(0xbb),{'access':{'allow':![],'reason':_0x4d4c3c(0x195),'token':null}});}else logger['full'](_0x4d4c3c(0x1d4));});}function initializeSocketBot(_0x8c4fe9){const _0xbc7711=_0x27f97a,_0x42588a=getClient(_0x8c4fe9['id'])[_0xbc7711(0xf3)],_0x811574=getClient(_0x8c4fe9['id'])[_0xbc7711(0x25a)];_0x8c4fe9['on'](_0xbc7711(0x199),(_0x3dfd1f,_0x414483)=>{const _0x148fc6=_0xbc7711;if(validateAccess(_0x414483,_0x811574)[_0x148fc6(0xd3)]){if(pid[_0x42588a])pid[_0x42588a][_0x148fc6(0x19f)]({'function':_0x148fc6(0xb9),'args':_0x3dfd1f});}else logger[_0x148fc6(0x15b)](_0x148fc6(0xd6));}),_0x8c4fe9['on']('delete-alerts',(_0x62105a,_0x13c581)=>{const _0x424718=_0xbc7711;if(validateAccess(_0x13c581,_0x811574)[_0x424718(0xd3)]){if(pid[_0x42588a])pid[_0x42588a][_0x424718(0x19f)]({'function':_0x424718(0x107),'args':_0x62105a});}else logger['full'](_0x424718(0x241));}),_0x8c4fe9['on'](_0xbc7711(0xe2),(_0x1cbbcb,_0x5cbb8c)=>{const _0x589cf7=_0xbc7711;if(validateAccess(_0x5cbb8c,_0x811574)[_0x589cf7(0xd3)]){if(pid[_0x42588a])pid[_0x42588a][_0x589cf7(0x19f)]({'function':_0x589cf7(0x24d),'args':_0x1cbbcb});}else logger[_0x589cf7(0x15b)](_0x589cf7(0x213));}),_0x8c4fe9['on'](_0xbc7711(0xb7),(_0x396d76,_0x8beb5f)=>{const _0x40637d=_0xbc7711;if(validateAccess(_0x8beb5f,_0x811574)[_0x40637d(0xd3)]){if(pid[_0x42588a])pid[_0x42588a][_0x40637d(0x19f)]({'function':_0x40637d(0x1f6),'args':_0x396d76});}else logger[_0x40637d(0x15b)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x8c4fe9['on'](_0xbc7711(0x1ae),(_0xc22afa,_0x35588d)=>{const _0x1858bb=_0xbc7711;if(validateAccess(_0x35588d,_0x811574)[_0x1858bb(0xd3)]){if(pid[_0x42588a])pid[_0x42588a][_0x1858bb(0x19f)]({'function':_0x1858bb(0x187),'args':_0xc22afa});}else logger['full'](_0x1858bb(0x14c));}),_0x8c4fe9['on'](_0xbc7711(0x21b),(_0x846c0b,_0x30c32f)=>{const _0x3e854c=_0xbc7711;if(validateAccess(_0x30c32f,_0x811574)[_0x3e854c(0xd3)]){if(pid[_0x42588a])pid[_0x42588a]['send']({'function':'storeFiat','args':_0x846c0b});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x8c4fe9['on'](_0xbc7711(0x219),_0x3d8297=>{const _0x2366eb=_0xbc7711;if(validateAccess(_0x3d8297,_0x811574)['allow']){if(pid[_0x42588a])pid[_0x42588a][_0x2366eb(0x19f)]({'function':_0x2366eb(0xdd),'args':null});}else logger[_0x2366eb(0x15b)](_0x2366eb(0x119));}),_0x8c4fe9['on'](_0xbc7711(0x15a),_0x32f692=>{const _0x43b639=_0xbc7711;if(validateAccess(_0x32f692,_0x811574)[_0x43b639(0xd3)]){if(pid[_0x42588a])pid[_0x42588a]['send']({'function':_0x43b639(0xea),'args':null});}else logger[_0x43b639(0x15b)](_0x43b639(0x1c4));}),_0x8c4fe9['on']('place-order',(_0x35c23d,_0x2361b7)=>{const _0x5e1d8a=_0xbc7711;if(validateAccess(_0x2361b7,_0x811574)['allow']){if(pid[_0x42588a])pid[_0x42588a]['send']({'function':_0x5e1d8a(0x1d3),'args':_0x35c23d});}else logger[_0x5e1d8a(0x15b)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x8c4fe9['on'](_0xbc7711(0x11e),_0x3e9abf=>{const _0x128466=_0xbc7711;if(validateAccess(_0x3e9abf,_0x811574)[_0x128466(0xd3)]){if(pid[_0x42588a])pid[_0x42588a][_0x128466(0x19f)]({'function':_0x128466(0xc8),'args':null});}else logger[_0x128466(0x15b)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x8c4fe9['on'](_0xbc7711(0x1ab),_0x12438a=>{const _0x49d4ac=_0xbc7711;if(validateAccess(_0x12438a,_0x811574)[_0x49d4ac(0xd3)]){if(pid[_0x42588a])pid[_0x42588a]['send']({'function':_0x49d4ac(0x1eb),'args':null});}else logger['full'](_0x49d4ac(0x1f0));}),_0x8c4fe9['on'](_0xbc7711(0x1b1),_0x24b1b8=>{const _0x215163=_0xbc7711;if(validateAccess(_0x24b1b8,_0x811574)[_0x215163(0xd3)])updateBB(_0x215163(0x25f));else logger[_0x215163(0x15b)](_0x215163(0x1cc));}),_0x8c4fe9['on'](_0xbc7711(0x148),_0xe52ae6=>{const _0x90caea=_0xbc7711;if(validateAccess(_0xe52ae6,_0x811574)[_0x90caea(0xd3)])getMessages();else logger['full'](_0x90caea(0x189));}),_0x8c4fe9['on'](_0xbc7711(0x270),(_0x12a739,_0x6ec6d4)=>{const _0xe6e4de=_0xbc7711;if(validateAccess(_0x6ec6d4,_0x811574)['allow'])confirmMessage(_0x12a739);else logger[_0xe6e4de(0x15b)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x8c4fe9['on'](_0xbc7711(0xcd),_0x149ad7=>{const _0x500d08=_0xbc7711;if(validateAccess(_0x149ad7,_0x811574)[_0x500d08(0xd3)]){if(devices[_0x811574][_0x500d08(0x22b)])clearTimeout(devices[_0x811574][_0x500d08(0x22b)]);if(devices[_0x811574][_0x500d08(0x22a)])clearTimeout(devices[_0x811574][_0x500d08(0x22a)]);removeSocketListeners(getClient(_0x8c4fe9['id'])[_0x500d08(0x25a)]),addBlacklist(_0x811574),devices[_0x811574][_0x500d08(0x253)]=null,devices[_0x811574]['telegram2FaApproval']=null,devices[_0x811574]['access'][_0x500d08(0xeb)]=null,logger[_0x500d08(0x14b)](_0x500d08(0x176)+_0x811574[_0x500d08(0x143)](-0x8)),io['to'](getClient(_0x8c4fe9['id'])['uuid'])[_0x500d08(0x16b)]('status',{'access':{'allow':![],'reason':_0x500d08(0x195),'token':null}});}else logger['full'](_0x500d08(0x1d4));});}function removeSocketListeners(_0x2d9316){getClientsWithUuid(_0x2d9316)['forEach'](_0x44633e=>{const _0x5ebb77=_0xaeff;getSocket(_0x44633e['id'])[_0x5ebb77(0x1f8)]();});}function cleanSettings(){const _0x43ec3d=_0x27f97a;let _0x57d50b=settings;return settings['telegramToken']&&settings[_0x43ec3d(0x197)]!=''&&(_0x57d50b={..._0x57d50b,'telegramToken':_0x43ec3d(0xb3)}),settings['bbPassword']&&settings[_0x43ec3d(0x1d1)]!=''&&(_0x57d50b={..._0x57d50b,'bbPassword':_0x43ec3d(0xb3)}),(settings['bbPassword']&&settings[_0x43ec3d(0x1d1)]=='***'||settings[_0x43ec3d(0x197)]&&settings['telegramToken']==_0x43ec3d(0x9b))&&(_0x57d50b={..._0x57d50b,'restored':{'password':settings['bbPassword']==_0x43ec3d(0x9b),'telegram':settings[_0x43ec3d(0x197)]=='***'}}),_0x57d50b;}async function updateBB(_0x435a35){const _0x5f3e83=_0x27f97a;await backupConfigFiles(),installingUpdate=!![],config[_0x5f3e83(0xa3)](_0x48e26e=>{const _0x471ae0=_0x5f3e83;restartBot(_0x48e26e[_0x471ae0(0x208)]);}),logger[_0x5f3e83(0x14b)](_0x5f3e83(0x22f)+_0x435a35);if(_0x435a35==_0x5f3e83(0x25f))process[_0x5f3e83(0x19f)]({'update':!![]},_0x655b15=>{});else _0x435a35==_0x5f3e83(0x18f)&&process['send']({'reinstall':!![]},_0x17ec92=>{});}function startBot(_0x2e005f,_0x5185ea,_0x2d5d00){const _0x177852=_0x27f97a;if(debugging)_0x2e005f[_0x177852(0x25b)]('-d');let _0x3718fe=![];const _0x10c2a0=_0x2e005f[0x0];_0x5185ea={..._0x5185ea,'stdio':[_0x177852(0x13f),_0x177852(0x13f),_0x177852(0x13f),_0x177852(0xd4)]},pid[_0x10c2a0]=childProcess['fork'](botfile,_0x2e005f,_0x5185ea),pid[_0x10c2a0]['on'](_0x177852(0x1a7),_0x1ae108=>{const _0x2ad982=_0x177852;switch(Object[_0x2ad982(0x194)](_0x1ae108)[0x0]){case _0x2ad982(0x259):updateBotName(_0x10c2a0,_0x1ae108[_0x2ad982(0x259)]);break;case _0x2ad982(0x12f):updateBotManager();break;case _0x2ad982(0xbb):updateStatus(_0x10c2a0,_0x1ae108[_0x2ad982(0xbb)]);break;case'live':updateLive(_0x10c2a0,_0x1ae108[_0x2ad982(0x121)]);break;case _0x2ad982(0x1c3):updateLive(_0x10c2a0,_0x1ae108[_0x2ad982(0x1c3)]),io['to'](_0x10c2a0)[_0x2ad982(0x16b)](_0x2ad982(0xbb),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x2ad982(0x225):_0x1ae108[_0x2ad982(0x225)]==_0x2ad982(0x1b9)&&restartBot(_0x10c2a0);_0x1ae108[_0x2ad982(0x225)]==_0x2ad982(0x122)&&toggleBot(_0x10c2a0,'disabled','stopped');break;case _0x2ad982(0x21e):sendTelegram(_0x10c2a0,_0x1ae108['telegram']);break;case'telegrammsg':sendTelegramMsg(_0x1ae108[_0x2ad982(0x165)]);break;case _0x2ad982(0xe5):io['to'](_0x10c2a0)['emit'](_0x1ae108[_0x2ad982(0xe5)],_0x1ae108[_0x2ad982(0x173)]);break;}}),pid[_0x10c2a0]['on']('error',function(_0x586922){if(_0x3718fe)return;_0x3718fe=!![],_0x2d5d00(_0x586922);}),pid[_0x10c2a0]['on'](_0x177852(0xb0),async function(_0x5a3b43){const _0x510027=_0x177852;if(installingUpdate)return;if(_0x3718fe)return;_0x3718fe=!![],_0x2d5d00(null);const _0xee12fd=dbConfig[_0x510027(0x201)](_0x510027(0x182))[_0x510027(0x25d)]({'botID':_0x10c2a0})[_0x510027(0xaf)]();_0xee12fd&&(_0xee12fd['status']==_0x510027(0x203)||_0xee12fd[_0x510027(0xbb)]==_0x510027(0x1d8))&&(await sleep(0x3e8),updateLive(_0x10c2a0,_0x510027(0xa6)),logger[_0x510027(0x15b)](_0x510027(0x24f)+_0x10c2a0),startBot([_0x10c2a0,userID],{'cwd':bbpath},function(_0x2214f3){if(_0x2214f3)logger['full'](_0x2214f3);}));});}function stopBot(_0x225f50){const _0xa6e1f0=_0x27f97a;getClientsWithBotID(_0x225f50)[_0xa6e1f0(0xa3)](_0x237093=>{const _0x1d670a=_0xa6e1f0;getSocket(_0x237093['id'])[_0x1d670a(0x1c1)](!![]),removeClient(_0x237093['id']);}),pid[_0x225f50]&&(pid[_0x225f50]['kill'](),pid[_0x225f50]=null);}function restartBot(_0x28913f){const _0xccf3e1=_0x27f97a;if(pid[_0x28913f])pid[_0x28913f][_0xccf3e1(0x122)]();}function addBot(){const _0x385492=_0x27f97a;let _0x376f9e;for(let _0x28a867=0x1;_0x28a867<0x3e9;_0x28a867++){_0x376f9e=_0x28a867[_0x385492(0x239)]()['padStart'](0x3,'0');let _0x53fe1e=config[_0x385492(0x25d)](_0x33b2b5=>_0x33b2b5[_0x385492(0x208)]==_0x376f9e);if(!_0x53fe1e)break;}if(_0x376f9e===_0x385492(0x1fd)){logger['full'](_0x385492(0x23d));return;}logger[_0x385492(0x15b)](_0x385492(0xfc)+_0x376f9e),dbConfig[_0x385492(0x201)](_0x385492(0x182))['push']({'botID':_0x376f9e,'botname':_0x385492(0x1ed)+_0x376f9e,'status':'new','live':''})[_0x385492(0x196)](),startBot([_0x376f9e,userID],{'cwd':bbpath},function(_0x3263aa){const _0x306069=_0x385492;if(_0x3263aa)logger[_0x306069(0x15b)](_0x3263aa);}),config=getConfiguration(),io['to'](_0x385492(0x16e))[_0x385492(0x16b)](_0x385492(0x182),config),broadcastToBots('bots',JSON['stringify'](config));}function deleteBot(_0x5778a5){const _0x53bb3e=_0x27f97a;getClientsWithBotID(_0x5778a5)[_0x53bb3e(0xa3)](_0x462f94=>{const _0x1f0578=_0x53bb3e;getSocket(_0x462f94['id'])[_0x1f0578(0x1c1)](!![]),removeClient(_0x462f94['id']);}),dbConfig['get'](_0x53bb3e(0x182))[_0x53bb3e(0x245)]({'botID':_0x5778a5})[_0x53bb3e(0x196)](),logger[_0x53bb3e(0x15b)](_0x53bb3e(0x16a)+_0x5778a5),stopBot(_0x5778a5);try{if(fs[_0x53bb3e(0x1b6)](path[_0x53bb3e(0xc6)](configpath,_0x53bb3e(0x117)+_0x5778a5+_0x53bb3e(0x1a3))))fs[_0x53bb3e(0x261)](path[_0x53bb3e(0xc6)](configpath,_0x53bb3e(0x117)+_0x5778a5+'-config.json'));if(fs['existsSync'](path[_0x53bb3e(0xc6)](configpath,'bot-'+_0x5778a5+'-events.json')))fs[_0x53bb3e(0x261)](path[_0x53bb3e(0xc6)](configpath,_0x53bb3e(0x117)+_0x5778a5+_0x53bb3e(0xc0)));if(fs['existsSync'](path[_0x53bb3e(0xc6)](configpath,_0x53bb3e(0x117)+_0x5778a5+_0x53bb3e(0x16c))))fs['unlinkSync'](path[_0x53bb3e(0xc6)](configpath,_0x53bb3e(0x117)+_0x5778a5+_0x53bb3e(0x16c)));if(fs['existsSync'](path[_0x53bb3e(0xc6)](configpath,_0x53bb3e(0x117)+_0x5778a5+_0x53bb3e(0x1ce))))fs[_0x53bb3e(0x261)](path['join'](configpath,_0x53bb3e(0x117)+_0x5778a5+_0x53bb3e(0x1ce)));}catch(_0x48377a){if(_0x48377a)logger[_0x53bb3e(0x15b)](_0x53bb3e(0x25e),_0x48377a);}config=getConfiguration(),io['to']('botmanager')[_0x53bb3e(0x16b)](_0x53bb3e(0x182),config),broadcastToBots(_0x53bb3e(0x182),JSON[_0x53bb3e(0xb6)](config));}function toggleBot(_0x59d56b,_0x353b42,_0x10197a){const _0x5b73dd=_0x27f97a;dbConfig[_0x5b73dd(0x201)](_0x5b73dd(0x182))[_0x5b73dd(0x25d)]({'botID':_0x59d56b})[_0x5b73dd(0x1dd)]({'status':_0x353b42})[_0x5b73dd(0x1dd)]({'live':_0x10197a})[_0x5b73dd(0x196)]();if(_0x353b42==_0x5b73dd(0x203)||_0x353b42=='new')logger['full'](_0x5b73dd(0xd8)+_0x59d56b),startBot([_0x59d56b,userID],{'cwd':bbpath},function(_0x34df2d){if(_0x34df2d)logger['full'](_0x34df2d);});else(_0x353b42==_0x5b73dd(0x1e5)||_0x353b42==_0x5b73dd(0x1e9))&&(logger['full'](_0x5b73dd(0xee)+_0x59d56b),stopBot(_0x59d56b));config=getConfiguration(),io['to'](_0x5b73dd(0x16e))[_0x5b73dd(0x16b)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function toggleStatus(_0x2d4e2b){const _0x1b7501=_0x27f97a;let _0x3b904a=dbConfig[_0x1b7501(0x201)](_0x1b7501(0x182))[_0x1b7501(0x25d)]({'botID':_0x2d4e2b})[_0x1b7501(0xaf)](),_0x5cc39e;if(_0x3b904a['status']===_0x1b7501(0x203))_0x5cc39e='disabled';else{if(_0x3b904a[_0x1b7501(0xbb)]===_0x1b7501(0x1d8))_0x5cc39e=_0x1b7501(0x1e9);else{if(_0x3b904a[_0x1b7501(0xbb)]===_0x1b7501(0x1e9))_0x5cc39e='new';else{if(_0x3b904a['status']===_0x1b7501(0x1e5))_0x5cc39e='enabled';}}}return _0x5cc39e;}function updateStatus(_0x1efbaf,_0x23943c){const _0x51667c=_0x27f97a;dbConfig[_0x51667c(0x201)](_0x51667c(0x182))[_0x51667c(0x25d)]({'botID':_0x1efbaf})['assign']({'status':_0x23943c})[_0x51667c(0x196)](),config=getConfiguration(),io['to'](_0x51667c(0x16e))['emit'](_0x51667c(0x182),config),broadcastToBots(_0x51667c(0x182),JSON[_0x51667c(0xb6)](config));}function updateLive(_0x190955,_0x454bca){const _0x1cdfa2=_0x27f97a;dbConfig['get'](_0x1cdfa2(0x182))[_0x1cdfa2(0x25d)]({'botID':_0x190955})[_0x1cdfa2(0x1dd)]({'live':_0x454bca})[_0x1cdfa2(0x196)](),config=getConfiguration(),io['to']('botmanager')[_0x1cdfa2(0x16b)](_0x1cdfa2(0x182),config),broadcastToBots(_0x1cdfa2(0x182),JSON[_0x1cdfa2(0xb6)](config));}function updateBotName(_0x14719c,_0x2bd8df){const _0x10dafc=_0x27f97a;dbConfig['get'](_0x10dafc(0x182))[_0x10dafc(0x25d)]({'botID':_0x14719c})[_0x10dafc(0x1dd)]({'botname':_0x2bd8df})[_0x10dafc(0x196)](),config=getConfiguration(),io['to'](_0x10dafc(0x16e))[_0x10dafc(0x16b)](_0x10dafc(0x182),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0x43fe1a=_0x27f97a;config=getConfiguration(),io['to'](_0x43fe1a(0x16e))[_0x43fe1a(0x16b)](_0x43fe1a(0x182),config),broadcastToBots(_0x43fe1a(0x182),JSON[_0x43fe1a(0xb6)](config));}function toggleBotMode(_0x5b8cfd){const _0x2f7027=_0x27f97a;if(pid[_0x5b8cfd])pid[_0x5b8cfd]['send']({'function':'toggleBotMode','args':null});else{const _0x303136=configpath+_0x2f7027(0x117)+_0x5b8cfd+_0x2f7027(0x1a3),_0x416241=fs['readFileSync'](_0x303136),_0xf7f7=JSON[_0x2f7027(0x1e4)](_0x416241),_0x2f854c=_0xf7f7[_0x2f7027(0xf3)][0x0][_0x2f7027(0x228)];_0xf7f7['bot'][0x0][_0x2f7027(0x228)]=!_0x2f854c;const _0x1f4f41=JSON[_0x2f7027(0xb6)](_0xf7f7,null,0x2);fs[_0x2f7027(0x244)](_0x303136,_0x1f4f41),config=getConfiguration(),io['to'](_0x2f7027(0x16e))['emit'](_0x2f7027(0x182),config),broadcastToBots(_0x2f7027(0x182),JSON[_0x2f7027(0xb6)](config));}}function telegramError(_0x22a6d3){const _0x5b3007=_0x27f97a;logger[_0x5b3007(0xad)](getTimeStamp()+_0x5b3007(0x157));}function validateTelegram(_0x3050df){const _0x39a76a=_0x27f97a;if(_0x3050df[_0x39a76a(0x231)][_0x39a76a(0x193)]!=settings['telegramUsername']&&'@'+_0x3050df[_0x39a76a(0x231)][_0x39a76a(0x193)]!=settings['telegramUsername'])return tgBot[_0x39a76a(0x24c)](_0x3050df[_0x39a76a(0x164)]['id'],_0x39a76a(0x20f),{'parse_mode':_0x39a76a(0x216)})[_0x39a76a(0xc7)](_0x4b5e5b=>{telegramError(_0x4b5e5b);}),![];return!![];}async function initTelegram(){const _0x19b61d=_0x27f97a;if(tgBot)tgBot[_0x19b61d(0xe9)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x19b61d(0x197)],{'polling':!![]});let _0x3c6794=_0x19b61d(0x262);_0x3c6794+='\x0a',_0x3c6794+=_0x19b61d(0x1b5),_0x3c6794+=_0x19b61d(0x1ec),_0x3c6794+=_0x19b61d(0x129),_0x3c6794+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x3c6794+=_0x19b61d(0x102),_0x3c6794+='/off\x20-\x20stop\x20bot(s)\x0a',_0x3c6794+=_0x19b61d(0x1a2),_0x3c6794+=_0x19b61d(0x12d),_0x3c6794+=_0x19b61d(0x183),_0x3c6794+=_0x19b61d(0x27b),_0x3c6794+=_0x19b61d(0x114),_0x3c6794+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x3c6794+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x3c6794+=_0x19b61d(0xac);let _0x4857e4=_0x19b61d(0x184);_0x4857e4+='\x0a',_0x4857e4+=_0x3c6794,tgBot[_0x19b61d(0x163)](/\/start/,_0xe92cc3=>{const _0x4dd72f=_0x19b61d;if(!validateTelegram(_0xe92cc3))return;if(settings[_0x4dd72f(0x217)]!=_0xe92cc3['chat']['id'])updateSetting(_0x4dd72f(0x217),_0xe92cc3[_0x4dd72f(0x164)]['id']);updateSetting(_0x4dd72f(0xae),!![]),tgBot[_0x4dd72f(0x24c)](_0xe92cc3[_0x4dd72f(0x164)]['id'],_0x4857e4)[_0x4dd72f(0xc7)](_0x32a7ee=>{telegramError(_0x32a7ee);});}),tgBot['onText'](/\/enable/,_0x5d0482=>{const _0x3c691b=_0x19b61d;if(!validateTelegram(_0x5d0482))return;if(settings[_0x3c691b(0x217)]!=_0x5d0482[_0x3c691b(0x164)]['id'])updateSetting(_0x3c691b(0x217),_0x5d0482[_0x3c691b(0x164)]['id']);updateSetting(_0x3c691b(0xae),!![]),tgBot[_0x3c691b(0x24c)](_0x5d0482[_0x3c691b(0x164)]['id'],_0x3c691b(0xfa))[_0x3c691b(0xc7)](_0x3f1abf=>{telegramError(_0x3f1abf);});}),tgBot['onText'](/\/config/,async _0x3b0725=>{const _0x585df0=_0x19b61d;if(!validateTelegram(_0x3b0725))return;tgBot['removeListener'](_0x585df0(0x248)),tgBot['sendMessage'](_0x3b0725[_0x585df0(0x164)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x585df0(0x154),'callback_data':_0x585df0(0x1bf)},{'text':_0x585df0(0x15c),'callback_data':_0x585df0(0x207)},{'text':'All','callback_data':_0x585df0(0x1f9)}]]}})[_0x585df0(0xc7)](_0xf3cd4b=>{telegramError(_0xf3cd4b);}),tgBot['on'](_0x585df0(0x248),async _0x10b98f=>{const _0x4305a9=_0x585df0,_0x570c92=_0x10b98f[_0x4305a9(0xc1)],_0x3566b9=_0x10b98f[_0x4305a9(0x1a7)];tgBot[_0x4305a9(0x26e)](_0x10b98f['id'])[_0x4305a9(0x269)](async()=>{const _0x32d95e=_0x4305a9;_0x570c92==_0x32d95e(0x1bf)&&(updateSetting('telegramEvents',_0x32d95e(0x1bf)),updateSetting(_0x32d95e(0xae),!![]),await tgBot[_0x32d95e(0x24c)](_0x3566b9[_0x32d95e(0x164)]['id'],_0x32d95e(0x20d))['catch'](_0x5cfc6f=>{telegramError(_0x5cfc6f);}));_0x570c92==_0x32d95e(0x207)&&(updateSetting(_0x32d95e(0x162),'alerts'),updateSetting(_0x32d95e(0xae),!![]),await tgBot[_0x32d95e(0x24c)](_0x3566b9[_0x32d95e(0x164)]['id'],_0x32d95e(0x13b))['catch'](_0x151e37=>{telegramError(_0x151e37);}));_0x570c92=='all'&&(updateSetting(_0x32d95e(0x162),_0x32d95e(0x1f9)),updateSetting(_0x32d95e(0xae),!![]),await tgBot[_0x32d95e(0x24c)](_0x3566b9[_0x32d95e(0x164)]['id'],_0x32d95e(0x1e0))[_0x32d95e(0xc7)](_0x45a65f=>{telegramError(_0x45a65f);}));if(!settings[_0x32d95e(0x217)])tgBot[_0x32d95e(0x24c)](_0x3566b9[_0x32d95e(0x164)]['id'],_0x32d95e(0x16f))['catch'](_0x326392=>{telegramError(_0x326392);});}),tgBot[_0x4305a9(0x1dc)]('callback_query');});}),tgBot['onText'](/\/status/,_0x213d17=>{const _0xc17539=_0x19b61d;if(!validateTelegram(_0x213d17))return;const _0x3e12ca=getBotsWithMode();let _0x35ca55='<b>Balance\x20Bot\x20Status:</b>\x0a';config['forEach'](_0x294bbf=>{const _0x322d66=_0xaeff,_0x5e1a4b=_0x3e12ca[_0x322d66(0x25d)](_0x594a5e=>_0x594a5e[_0x322d66(0x208)]==_0x294bbf[_0x322d66(0x208)])[_0x322d66(0x11a)];_0x35ca55+='Bot\x20'+_0x294bbf[_0x322d66(0x208)]+':\x20'+_0x294bbf[_0x322d66(0xbb)]+_0x322d66(0x1f4)+_0x5e1a4b+'\x20|\x20'+_0x294bbf[_0x322d66(0x121)]+'\x0a';}),_0x35ca55+='\x0a',_0x35ca55+=_0xc17539(0x1aa),_0x35ca55+=!settings[_0xc17539(0xae)]?_0xc17539(0x254):_0xc17539(0xff),_0x35ca55+=settings[_0xc17539(0xae)]?settings[_0xc17539(0x162)]==_0xc17539(0x1f9)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings['telegramEvents']+_0xc17539(0xcc):'',tgBot[_0xc17539(0x24c)](_0x213d17[_0xc17539(0x164)]['id'],_0x35ca55,{'parse_mode':_0xc17539(0x216)})[_0xc17539(0xc7)](_0x595955=>{telegramError(_0x595955);});}),tgBot[_0x19b61d(0x163)](/\/restart/,_0x23d64e=>{const _0x5d5b81=_0x19b61d;if(!validateTelegram(_0x23d64e))return;tgBot[_0x5d5b81(0x1dc)](_0x5d5b81(0x248));const _0x350241=getEnabledBots();if(_0x350241[_0x5d5b81(0xfe)]==0x0)tgBot[_0x5d5b81(0x24c)](_0x23d64e['chat']['id'],_0x5d5b81(0xbf))[_0x5d5b81(0xc7)](_0x36263f=>{telegramError(_0x36263f);});else{if(_0x350241[_0x5d5b81(0xfe)]>0x1)_0x350241[_0x5d5b81(0x25b)]({'botID':_0x5d5b81(0x1f9)});let _0x4fd6a4=[],_0x5e9140=[];const _0x136457=_0x350241['length']%0x4==0x0||_0x350241[_0x5d5b81(0xfe)]%0x4==0x3||_0x350241[_0x5d5b81(0xfe)]%0x3==0x1?0x4:0x3;let _0xc411c1=0x0;_0x350241[_0x5d5b81(0xa3)]((_0x58a5a9,_0x17c991)=>{const _0x2ed321=_0x5d5b81;if(_0x17c991%_0x136457==0x0)_0x5e9140=[];_0x5e9140[_0x2ed321(0x25b)]({'text':_0x58a5a9[_0x2ed321(0x208)]==_0x2ed321(0x1f9)?'All\x20bots':'Bot\x20'+_0x58a5a9[_0x2ed321(0x208)],'callback_data':_0x58a5a9[_0x2ed321(0x208)]}),_0x17c991%_0x136457==0x0&&(_0x4fd6a4[_0xc411c1]=_0x5e9140,_0xc411c1++);}),tgBot[_0x5d5b81(0x24c)](_0x23d64e['chat']['id'],_0x5d5b81(0x1be),{'reply_markup':{'inline_keyboard':_0x4fd6a4}})[_0x5d5b81(0xc7)](_0x987cdc=>{telegramError(_0x987cdc);}),tgBot['on']('callback_query',async _0x303127=>{const _0x4b43fc=_0x5d5b81,_0x263566=_0x303127['data'],_0x4d03e9=_0x303127[_0x4b43fc(0x1a7)];tgBot[_0x4b43fc(0x26e)](_0x303127['id'])[_0x4b43fc(0x269)](async()=>{const _0xbbfbd9=_0x4b43fc;_0x263566==_0xbbfbd9(0x1f9)?config[_0xbbfbd9(0xa3)](_0x47a377=>{const _0x4f2696=_0xbbfbd9;restartBot(_0x47a377[_0x4f2696(0x208)]);}):restartBot(_0x263566);}),tgBot[_0x4b43fc(0x1dc)](_0x4b43fc(0x248));});}}),tgBot[_0x19b61d(0x163)](/\/on/,_0x46f979=>{const _0x29a91a=_0x19b61d;if(!validateTelegram(_0x46f979))return;tgBot[_0x29a91a(0x1dc)](_0x29a91a(0x248));const _0x1f7c8d=getDisabledBots();if(_0x1f7c8d[_0x29a91a(0xfe)]==0x0)tgBot[_0x29a91a(0x24c)](_0x46f979[_0x29a91a(0x164)]['id'],_0x29a91a(0x19a))[_0x29a91a(0xc7)](_0x4c81a4=>{telegramError(_0x4c81a4);});else{if(_0x1f7c8d['length']>0x1)_0x1f7c8d[_0x29a91a(0x25b)]({'botID':_0x29a91a(0x1f9)});let _0x269ed6=[],_0x298ec1=[];const _0x4dd242=_0x1f7c8d[_0x29a91a(0xfe)]%0x4==0x0||_0x1f7c8d[_0x29a91a(0xfe)]%0x4==0x3||_0x1f7c8d[_0x29a91a(0xfe)]%0x3==0x1?0x4:0x3;let _0x33fcdb=0x0;_0x1f7c8d[_0x29a91a(0xa3)]((_0x1abd5c,_0x4f30f5)=>{const _0x13af1e=_0x29a91a;if(_0x4f30f5%_0x4dd242==0x0)_0x298ec1=[];_0x298ec1[_0x13af1e(0x25b)]({'text':_0x1abd5c[_0x13af1e(0x208)]==_0x13af1e(0x1f9)?'All\x20bots':_0x13af1e(0x1ed)+_0x1abd5c['botID'],'callback_data':_0x1abd5c[_0x13af1e(0x208)]}),_0x4f30f5%_0x4dd242==0x0&&(_0x269ed6[_0x33fcdb]=_0x298ec1,_0x33fcdb++);}),tgBot[_0x29a91a(0x24c)](_0x46f979[_0x29a91a(0x164)]['id'],_0x29a91a(0x120),{'reply_markup':{'inline_keyboard':_0x269ed6}})[_0x29a91a(0xc7)](_0x395ca6=>{telegramError(_0x395ca6);}),tgBot['on'](_0x29a91a(0x248),async _0x441e8c=>{const _0x3bceff=_0x29a91a,_0x55ce29=_0x441e8c['data'],_0x2bc537=_0x441e8c[_0x3bceff(0x1a7)];tgBot[_0x3bceff(0x26e)](_0x441e8c['id'])['then'](async()=>{const _0x1254a9=_0x3bceff;_0x55ce29=='all'?(tgBot['sendMessage'](_0x2bc537[_0x1254a9(0x164)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x1254a9(0xc7)](_0x42883a=>{telegramError(_0x42883a);}),_0x1f7c8d[_0x1254a9(0xa3)](_0x8bfe0c=>{const _0x3f5f26=_0x1254a9;if(_0x8bfe0c[_0x3f5f26(0x208)]!=_0x3f5f26(0x1f9))toggleBot(_0x8bfe0c[_0x3f5f26(0x208)],toggleStatus(_0x8bfe0c[_0x3f5f26(0x208)]),'stopped');})):(tgBot['sendMessage'](_0x2bc537[_0x1254a9(0x164)]['id'],_0x1254a9(0x1f5)+_0x55ce29)[_0x1254a9(0xc7)](_0x409a54=>{telegramError(_0x409a54);}),toggleBot(_0x55ce29,toggleStatus(_0x55ce29),'stopped'));}),tgBot[_0x3bceff(0x1dc)](_0x3bceff(0x248));});}}),tgBot[_0x19b61d(0x163)](/\/off/,_0x15c9f1=>{const _0xef7f8=_0x19b61d;if(!validateTelegram(_0x15c9f1))return;tgBot[_0xef7f8(0x1dc)](_0xef7f8(0x248));const _0x21f048=getEnabledBots();if(_0x21f048[_0xef7f8(0xfe)]==0x0)tgBot[_0xef7f8(0x24c)](_0x15c9f1['chat']['id'],_0xef7f8(0xbf))[_0xef7f8(0xc7)](_0x53cb7c=>{telegramError(_0x53cb7c);});else{if(_0x21f048[_0xef7f8(0xfe)]>0x1)_0x21f048[_0xef7f8(0x25b)]({'botID':_0xef7f8(0x1f9)});let _0x26cb64=[],_0x13a12c=[];const _0x5f248a=_0x21f048[_0xef7f8(0xfe)]%0x4==0x0||_0x21f048[_0xef7f8(0xfe)]%0x4==0x3||_0x21f048['length']%0x3==0x1?0x4:0x3;let _0x1f0e76=0x0;_0x21f048[_0xef7f8(0xa3)]((_0x3c38b9,_0x4527a4)=>{const _0x5bf503=_0xef7f8;if(_0x4527a4%_0x5f248a==0x0)_0x13a12c=[];_0x13a12c[_0x5bf503(0x25b)]({'text':_0x3c38b9[_0x5bf503(0x208)]=='all'?'All\x20bots':_0x5bf503(0x1ed)+_0x3c38b9[_0x5bf503(0x208)],'callback_data':_0x3c38b9['botID']}),_0x4527a4%_0x5f248a==0x0&&(_0x26cb64[_0x1f0e76]=_0x13a12c,_0x1f0e76++);}),tgBot['sendMessage'](_0x15c9f1['chat']['id'],_0xef7f8(0x260),{'reply_markup':{'inline_keyboard':_0x26cb64}})['catch'](_0x20d741=>{telegramError(_0x20d741);}),tgBot['on']('callback_query',async _0x482b1c=>{const _0x3e2b6d=_0xef7f8,_0x1b8657=_0x482b1c[_0x3e2b6d(0xc1)],_0xaa3466=_0x482b1c[_0x3e2b6d(0x1a7)];tgBot[_0x3e2b6d(0x26e)](_0x482b1c['id'])[_0x3e2b6d(0x269)](async()=>{const _0x39daae=_0x3e2b6d;_0x1b8657=='all'?(tgBot[_0x39daae(0x24c)](_0xaa3466[_0x39daae(0x164)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')['catch'](_0xef2b43=>{telegramError(_0xef2b43);}),_0x21f048[_0x39daae(0xa3)](_0x4ee677=>{const _0x5191b0=_0x39daae;if(_0x4ee677[_0x5191b0(0x208)]!=_0x5191b0(0x1f9))toggleBot(_0x4ee677['botID'],toggleStatus(_0x4ee677[_0x5191b0(0x208)]),_0x5191b0(0xa6));})):(tgBot[_0x39daae(0x24c)](_0xaa3466['chat']['id'],_0x39daae(0x142)+_0x1b8657)['catch'](_0x1fa785=>{telegramError(_0x1fa785);}),toggleBot(_0x1b8657,toggleStatus(_0x1b8657),_0x39daae(0xa6)));}),tgBot[_0x3e2b6d(0x1dc)]('callback_query');});}}),tgBot[_0x19b61d(0x163)](/\/metrics/,_0x57dfb2=>{const _0x17f4f3=_0x19b61d;if(!validateTelegram(_0x57dfb2))return;tgBot['removeListener']('callback_query');const _0x34b44c=getEnabledBots();if(_0x34b44c[_0x17f4f3(0xfe)]==0x0)tgBot[_0x17f4f3(0x24c)](_0x57dfb2[_0x17f4f3(0x164)]['id'],_0x17f4f3(0xbf))['catch'](_0x13517f=>{telegramError(_0x13517f);});else{if(_0x34b44c[_0x17f4f3(0xfe)]>0x1){let _0x1333c3=[],_0x3436c5=[];const _0xd79012=_0x34b44c[_0x17f4f3(0xfe)]%0x4==0x0||_0x34b44c['length']%0x4==0x3||_0x34b44c[_0x17f4f3(0xfe)]%0x3==0x1?0x4:0x3;let _0x309a04=0x0;_0x34b44c['forEach']((_0x2d43df,_0x363ed8)=>{const _0x4abfb2=_0x17f4f3;if(_0x363ed8%_0xd79012==0x0)_0x3436c5=[];_0x3436c5[_0x4abfb2(0x25b)]({'text':_0x4abfb2(0x1ed)+_0x2d43df[_0x4abfb2(0x208)],'callback_data':_0x2d43df['botID']}),_0x363ed8%_0xd79012==0x0&&(_0x1333c3[_0x309a04]=_0x3436c5,_0x309a04++);}),tgBot[_0x17f4f3(0x24c)](_0x57dfb2[_0x17f4f3(0x164)]['id'],_0x17f4f3(0x101),{'reply_markup':{'inline_keyboard':_0x1333c3}})[_0x17f4f3(0xc7)](_0x116cc1=>{telegramError(_0x116cc1);}),tgBot['on'](_0x17f4f3(0x248),async _0x48d6b2=>{const _0x288896=_0x17f4f3,_0x38a9ae=_0x48d6b2[_0x288896(0xc1)],_0x362538=_0x48d6b2[_0x288896(0x1a7)];tgBot[_0x288896(0x26e)](_0x48d6b2['id'])[_0x288896(0x269)](async()=>{const _0x3b1edc=_0x288896;if(pid[_0x38a9ae])pid[_0x38a9ae][_0x3b1edc(0x19f)]({'function':_0x3b1edc(0x191),'args':null});}),tgBot['removeListener']('callback_query');});}else{const _0x4e3d12=_0x34b44c[0x0][_0x17f4f3(0x208)];if(pid[_0x4e3d12])pid[_0x4e3d12]['send']({'function':_0x17f4f3(0x191),'args':null});}}}),tgBot['onText'](/\/portfolio/,_0x5c4563=>{const _0x1d5e67=_0x19b61d;if(!validateTelegram(_0x5c4563))return;tgBot[_0x1d5e67(0x1dc)](_0x1d5e67(0x248));const _0x21bf4e=getEnabledBots();if(_0x21bf4e[_0x1d5e67(0xfe)]==0x0)tgBot[_0x1d5e67(0x24c)](_0x5c4563['chat']['id'],_0x1d5e67(0xbf))[_0x1d5e67(0xc7)](_0x1917ef=>{telegramError(_0x1917ef);});else{if(_0x21bf4e[_0x1d5e67(0xfe)]>0x1){let _0x385072=[],_0x2b0da0=[];const _0x2156a0=_0x21bf4e[_0x1d5e67(0xfe)]%0x4==0x0||_0x21bf4e[_0x1d5e67(0xfe)]%0x4==0x3||_0x21bf4e[_0x1d5e67(0xfe)]%0x3==0x1?0x4:0x3;let _0x20f212=0x0;_0x21bf4e[_0x1d5e67(0xa3)]((_0x47c466,_0x4f56ea)=>{const _0x564251=_0x1d5e67;if(_0x4f56ea%_0x2156a0==0x0)_0x2b0da0=[];_0x2b0da0[_0x564251(0x25b)]({'text':_0x564251(0x1ed)+_0x47c466[_0x564251(0x208)],'callback_data':_0x47c466[_0x564251(0x208)]}),_0x4f56ea%_0x2156a0==0x0&&(_0x385072[_0x20f212]=_0x2b0da0,_0x20f212++);}),tgBot[_0x1d5e67(0x24c)](_0x5c4563[_0x1d5e67(0x164)]['id'],_0x1d5e67(0x19c),{'reply_markup':{'inline_keyboard':_0x385072}})['catch'](_0x455439=>{telegramError(_0x455439);}),tgBot['on'](_0x1d5e67(0x248),async _0x3f1d8d=>{const _0x3b26c6=_0x1d5e67,_0xe9a57f=_0x3f1d8d['data'],_0xc5a0d=_0x3f1d8d[_0x3b26c6(0x1a7)];tgBot[_0x3b26c6(0x26e)](_0x3f1d8d['id'])['then'](async()=>{const _0x11ba60=_0x3b26c6;if(pid[_0xe9a57f])pid[_0xe9a57f][_0x11ba60(0x19f)]({'function':_0x11ba60(0xc5),'args':null});}),tgBot[_0x3b26c6(0x1dc)]('callback_query');});}else{const _0x425b80=_0x21bf4e[0x0][_0x1d5e67(0x208)];if(pid[_0x425b80])pid[_0x425b80][_0x1d5e67(0x19f)]({'function':_0x1d5e67(0xc5),'args':null});}}}),tgBot[_0x19b61d(0x163)](/\/update/,async _0x53ca5c=>{const _0x286a67=_0x19b61d;if(!validateTelegram(_0x53ca5c))return;tgBot[_0x286a67(0x1dc)]('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x286a67(0x24c)](_0x53ca5c[_0x286a67(0x164)]['id'],_0x286a67(0xd1))[_0x286a67(0xc7)](_0x5b3bac=>{telegramError(_0x5b3bac);});else!validInstallation?tgBot[_0x286a67(0x24c)](_0x53ca5c['chat']['id'],_0x286a67(0x136))[_0x286a67(0xc7)](_0x527290=>{telegramError(_0x527290);}):(tgBot[_0x286a67(0x24c)](_0x53ca5c[_0x286a67(0x164)]['id'],_0x286a67(0x221),{'reply_markup':{'inline_keyboard':[[{'text':_0x286a67(0x13d),'callback_data':_0x286a67(0x111)},{'text':'No','callback_data':'no'}]]}})[_0x286a67(0xc7)](_0xfdc08d=>{telegramError(_0xfdc08d);}),tgBot['on']('callback_query',async _0x2aca26=>{const _0x47931a=_0x286a67,_0x10464e=_0x2aca26[_0x47931a(0xc1)],_0x4a608c=_0x2aca26[_0x47931a(0x1a7)];tgBot[_0x47931a(0x26e)](_0x2aca26['id'])[_0x47931a(0x269)](async()=>{const _0x20b961=_0x47931a;_0x10464e==_0x20b961(0x111)&&(await tgBot[_0x20b961(0x24c)](_0x4a608c[_0x20b961(0x164)]['id'],'Starting\x20Balance\x20Bot\x20update')[_0x20b961(0xc7)](_0x520291=>{telegramError(_0x520291);}),updateBB('update')),_0x10464e=='no'&&await tgBot[_0x20b961(0x24c)](_0x4a608c[_0x20b961(0x164)]['id'],_0x20b961(0x19e))[_0x20b961(0xc7)](_0x3f3ec3=>{telegramError(_0x3f3ec3);});}),tgBot['removeListener'](_0x47931a(0x248));}));}),tgBot[_0x19b61d(0x163)](/\/reinstall/,async _0x504a8f=>{const _0x2d2485=_0x19b61d;if(!validateTelegram(_0x504a8f))return;tgBot[_0x2d2485(0x1dc)](_0x2d2485(0x248)),!validInstallation?tgBot[_0x2d2485(0x24c)](_0x504a8f[_0x2d2485(0x164)]['id'],_0x2d2485(0x150))[_0x2d2485(0xc7)](_0x41f545=>{telegramError(_0x41f545);}):(tgBot[_0x2d2485(0x24c)](_0x504a8f['chat']['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x2d2485(0x111)},{'text':'No','callback_data':'no'}]]}})[_0x2d2485(0xc7)](_0x3555f4=>{telegramError(_0x3555f4);}),tgBot['on']('callback_query',async _0x993f89=>{const _0x361ff4=_0x2d2485,_0x2f4719=_0x993f89[_0x361ff4(0xc1)],_0x4d4eb3=_0x993f89['message'];tgBot[_0x361ff4(0x26e)](_0x993f89['id'])[_0x361ff4(0x269)](async()=>{const _0x30aa8=_0x361ff4;_0x2f4719==_0x30aa8(0x111)&&(await tgBot[_0x30aa8(0x24c)](_0x4d4eb3[_0x30aa8(0x164)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation')[_0x30aa8(0xc7)](_0x473926=>{telegramError(_0x473926);}),updateBB(_0x30aa8(0x18f))),_0x2f4719=='no'&&await tgBot[_0x30aa8(0x24c)](_0x4d4eb3['chat']['id'],_0x30aa8(0xfd))[_0x30aa8(0xc7)](_0x245586=>{telegramError(_0x245586);});}),tgBot[_0x361ff4(0x1dc)](_0x361ff4(0x248));}));}),tgBot['onText'](/\/toggle/,_0x83145c=>{const _0x3e12f3=_0x19b61d;if(!validateTelegram(_0x83145c))return;tgBot['removeListener']('callback_query');const _0x5ec068=getBotsWithMode();if(_0x5ec068[_0x3e12f3(0xfe)]==0x0)tgBot[_0x3e12f3(0x24c)](_0x83145c['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x3e12f3(0xc7)](_0x4ec1b8=>{telegramError(_0x4ec1b8);});else{let _0x31a0b8=[],_0x188b77=[];const _0x2062c2=0x2;let _0x19d964=0x0;_0x5ec068[_0x3e12f3(0xa3)]((_0x49b08e,_0x449f63)=>{const _0x59e107=_0x3e12f3;if(_0x449f63%_0x2062c2==0x0)_0x188b77=[];_0x188b77[_0x59e107(0x25b)]({'text':_0x59e107(0x1ed)+_0x49b08e[_0x59e107(0x208)]+'\x20('+_0x49b08e[_0x59e107(0x11a)]+')','callback_data':_0x49b08e[_0x59e107(0x208)]}),_0x449f63%_0x2062c2==0x0&&(_0x31a0b8[_0x19d964]=_0x188b77,_0x19d964++);}),tgBot[_0x3e12f3(0x24c)](_0x83145c[_0x3e12f3(0x164)]['id'],_0x3e12f3(0x141),{'reply_markup':{'inline_keyboard':_0x31a0b8}})['catch'](_0x2ce864=>{telegramError(_0x2ce864);}),tgBot['on'](_0x3e12f3(0x248),async _0x598873=>{const _0x28dca5=_0x3e12f3,_0x459cd4=_0x598873[_0x28dca5(0xc1)],_0x5d576f=_0x598873[_0x28dca5(0x1a7)];tgBot[_0x28dca5(0x26e)](_0x598873['id'])['then'](async()=>{const _0x539c15=_0x28dca5,_0x15b63f=_0x5ec068[_0x539c15(0x25d)](_0x2cc677=>_0x2cc677[_0x539c15(0x208)]==_0x459cd4),_0x125ed3=_0x15b63f[_0x539c15(0x11a)]==_0x539c15(0x215)?_0x539c15(0xf6):_0x539c15(0x215);tgBot['sendMessage'](_0x5d576f['chat']['id'],_0x539c15(0x279)+_0x459cd4+_0x539c15(0x1b0)+_0x125ed3+_0x539c15(0x133))[_0x539c15(0xc7)](_0x1db969=>{telegramError(_0x1db969);}),toggleBotMode(_0x459cd4);}),tgBot[_0x28dca5(0x1dc)]('callback_query');});}}),tgBot[_0x19b61d(0x163)](/\/names/,_0x292129=>{const _0x4eb6a0=_0x19b61d;if(!validateTelegram(_0x292129))return;let _0x42aa17='';config[_0x4eb6a0(0xa3)](_0x3e2aff=>{const _0xeff961=_0x4eb6a0;_0x42aa17+=_0xeff961(0x1ed)+_0x3e2aff['botID']+':\x20'+_0x3e2aff[_0xeff961(0x259)]+'\x0a';}),tgBot[_0x4eb6a0(0x24c)](_0x292129['chat']['id'],_0x42aa17,{'parse_mode':'HTML'})[_0x4eb6a0(0xc7)](_0x58308d=>{telegramError(_0x58308d);});}),tgBot[_0x19b61d(0x163)](/\/disable/,_0x594066=>{const _0x48d166=_0x19b61d;if(!validateTelegram(_0x594066))return;tgBot[_0x48d166(0x24c)](_0x594066['chat']['id'],_0x48d166(0x153))[_0x48d166(0xc7)](_0x274bd7=>{telegramError(_0x274bd7);}),updateSetting(_0x48d166(0xae),![]);}),tgBot[_0x19b61d(0x163)](/\/help/,_0x32bd4e=>{const _0x553483=_0x19b61d;if(!validateTelegram(_0x32bd4e))return;tgBot['sendMessage'](_0x32bd4e[_0x553483(0x164)]['id'],_0x3c6794)['catch'](_0x25478f=>{telegramError(_0x25478f);});}),tgBot['on'](_0x19b61d(0x27d),_0x51d0e5=>{const _0x428ceb=_0x19b61d;_0x51d0e5[_0x428ceb(0x239)]()[_0x428ceb(0x9c)](_0x428ceb(0x247))&&(logger['full']('Invalid\x20Telegram\x20token'),tgBot[_0x428ceb(0xe9)](),tgBot=null,io['to'](_0x428ceb(0x16e))[_0x428ceb(0x16b)]('notification',_0x428ceb(0x24e)));}),process[_0x19b61d(0x226)](_0x19b61d(0x108),()=>{const _0x819e2c=_0x19b61d;if(tgBot)tgBot[_0x819e2c(0xe9)]();process[_0x819e2c(0xb0)](0x1);}),process[_0x19b61d(0x226)](_0x19b61d(0xa8),()=>{const _0x42a203=_0x19b61d;if(tgBot)tgBot['stopPolling']();process[_0x42a203(0xb0)](0x1);});}}function disableTelegram(){const _0x5be829=_0x27f97a;tgBot&&(tgBot[_0x5be829(0xe9)](),tgBot=null);}function sendTelegram(_0x46dcfe,_0x1816ec){const _0x422a13=_0x27f97a;if(settings[_0x422a13(0xae)]){if(settings['telegramEvents']==_0x422a13(0x1f9)||(_0x1816ec['type']==_0x422a13(0x147)||_0x1816ec[_0x422a13(0x110)]==_0x422a13(0xec)||_0x1816ec['type']==_0x422a13(0xc9))&&settings['telegramEvents']=='alerts'||_0x1816ec[_0x422a13(0x110)]==_0x422a13(0x149)&&settings[_0x422a13(0x162)]==_0x422a13(0x1bf)){if(tgBot&&settings[_0x422a13(0x217)]){if(_0x1816ec['showname'])tgBot[_0x422a13(0x24c)](settings['telegramChatId'],_0x1816ec[_0x422a13(0x259)]+_0x422a13(0xde)+_0x1816ec[_0x422a13(0x21d)])[_0x422a13(0xc7)](_0x364eab=>{telegramError(_0x364eab);});else tgBot['sendMessage'](settings[_0x422a13(0x217)],_0x422a13(0x1ed)+_0x46dcfe+_0x422a13(0xde)+_0x1816ec[_0x422a13(0x21d)])[_0x422a13(0xc7)](_0x55bcf6=>{telegramError(_0x55bcf6);});}}}}async function sendTelegramMsg(_0x4ae83e,_0x3b0273=_0x27f97a(0x216)){const _0x438b1b=_0x27f97a;return settings[_0x438b1b(0xae)]&&tgBot&&settings[_0x438b1b(0x217)]?(await tgBot['sendMessage'](settings[_0x438b1b(0x217)],_0x4ae83e,{'parse_mode':_0x3b0273})[_0x438b1b(0xc7)](_0x4bc19e=>{telegramError(_0x4bc19e);}),!![]):![];}function getDeviceWithIp(_0x395ad7){const _0x78b3d0=_0x27f97a;return devices[_0x78b3d0(0x25d)](_0x5d898d=>_0x5d898d['ip']===_0x395ad7);}function temporaryAccess2FA(_0x19828d,_0x32d845){const _0x36c2a5=_0x27f97a;let _0x281911=new Date(),_0x5bb21c=![];if(lastIpApproval){if(_0x281911-lastIpApproval<0x1388)_0x5bb21c=!![];}lastIpApproval=new Date();if(_0x5bb21c)return;tgBot&&settings[_0x36c2a5(0x217)]&&(tgBot[_0x36c2a5(0x1dc)](_0x36c2a5(0x248)),tgBot[_0x36c2a5(0x24c)](settings['telegramChatId'],_0x36c2a5(0x277)+normalizeIP(_0x32d845)[_0x36c2a5(0x24b)]+_0x36c2a5(0xbe),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x36c2a5(0x18d),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x36c2a5(0x205),'callback_data':'30'},{'text':_0x36c2a5(0x146),'callback_data':'reject'}]]}})[_0x36c2a5(0xc7)](_0x3244d0=>{telegramError(_0x3244d0);}),tgBot['on'](_0x36c2a5(0x248),async _0x13a033=>{const _0x1a6731=_0x36c2a5,_0x4169b5=_0x13a033[_0x1a6731(0xc1)],_0x3754f0=_0x13a033[_0x1a6731(0x1a7)];tgBot[_0x1a6731(0x26e)](_0x13a033['id'])['then'](async()=>{const _0x1d91c6=_0x1a6731;devices[_0x19828d]['telegramIpApproval']={'clientip':_0x32d845,'timestamp':new Date()[_0x1d91c6(0x1a6)](),'expiry':_0x4169b5},_0x4169b5!=_0x1d91c6(0x146)?(await tgBot[_0x1d91c6(0x24c)](_0x3754f0['chat']['id'],_0x1d91c6(0x137)+_0x4169b5+'\x20minutes',{'parse_mode':'HTML'})[_0x1d91c6(0xc7)](_0x2dc9b0=>{telegramError(_0x2dc9b0);}),io['to'](_0x19828d)['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot['sendMessage'](_0x3754f0[_0x1d91c6(0x164)]['id'],'Temporary\x20access\x20rejected')[_0x1d91c6(0xc7)](_0x2db9cf=>{telegramError(_0x2db9cf);}),io['to'](_0x19828d)[_0x1d91c6(0x16b)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x1a6731(0x1dc)](_0x1a6731(0x248));}));}function loginAccess2FA(_0x31dcd3,_0x13dbb2){const _0x463616=_0x27f97a;tgBot&&settings[_0x463616(0x217)]&&(tgBot[_0x463616(0x1dc)](_0x463616(0x248)),tgBot['sendMessage'](settings[_0x463616(0x217)],_0x463616(0x17d)+normalizeIP(_0x13dbb2)[_0x463616(0x24b)]+_0x463616(0xbe),{'parse_mode':_0x463616(0x216),'reply_markup':{'inline_keyboard':[[{'text':_0x463616(0xdb),'callback_data':loginExpiry},{'text':_0x463616(0x146),'callback_data':_0x463616(0x146)}]]}})['catch'](_0x3a1112=>{telegramError(_0x3a1112);}),tgBot['on'](_0x463616(0x248),async _0x4b7ede=>{const _0x582c35=_0x463616,_0x32063c=_0x4b7ede[_0x582c35(0xc1)],_0x29d1d9=_0x4b7ede[_0x582c35(0x1a7)];tgBot['answerCallbackQuery'](_0x4b7ede['id'])[_0x582c35(0x269)](async()=>{const _0x311bce=_0x582c35;devices[_0x31dcd3]['telegram2FaApproval']={'clientip':_0x13dbb2,'timestamp':new Date()[_0x311bce(0x1a6)](),'expiry':_0x32063c},_0x32063c!=_0x311bce(0x146)?(await tgBot[_0x311bce(0x24c)](_0x29d1d9[_0x311bce(0x164)]['id'],'Login\x20accepted',{'parse_mode':_0x311bce(0x216)})[_0x311bce(0xc7)](_0x548b07=>{telegramError(_0x548b07);}),io['to'](_0x31dcd3)['emit'](_0x311bce(0xbb),{'access':{'allow':![],'reason':_0x311bce(0x206),'token':null}})):(await tgBot['sendMessage'](_0x29d1d9[_0x311bce(0x164)]['id'],_0x311bce(0x10c))[_0x311bce(0xc7)](_0x365fc6=>{telegramError(_0x365fc6);}),io['to'](_0x31dcd3)[_0x311bce(0x16b)](_0x311bce(0xbb),{'access':{'allow':![],'reason':_0x311bce(0xf0),'token':null}}));}),tgBot[_0x582c35(0x1dc)](_0x582c35(0x248));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1d3281=_0x27f97a;return dbConfig[_0x1d3281(0x201)](_0x1d3281(0x182))[_0x1d3281(0x181)](_0x1d3281(0x208))[_0x1d3281(0x19d)]({'status':_0x1d3281(0x203)})[_0x1d3281(0xaf)]()||[];}function getDisabledBots(){const _0x64d279=_0x27f97a;return dbConfig['get'](_0x64d279(0x182))[_0x64d279(0x181)](_0x64d279(0x208))[_0x64d279(0x19d)]({'status':_0x64d279(0x1e5)})[_0x64d279(0xaf)]()||[];}function getBotAttributes(_0x49d48b){const _0xb43a48=_0x27f97a;let _0x31430a={};const _0x5c4e5c=configpath+'bot-'+_0x49d48b+_0xb43a48(0x1a3),_0x36799c=fs[_0xb43a48(0x1b6)](_0x5c4e5c);if(_0x36799c){const _0x1a6079=fs[_0xb43a48(0x1fc)](_0x5c4e5c);try{const _0x43fd45=JSON[_0xb43a48(0x1e4)](_0x1a6079),_0x22c9a5=_0x43fd45?_0x43fd45['bot'][0x0][_0xb43a48(0x228)]:![];_0x31430a[_0xb43a48(0x11a)]=_0x22c9a5?_0xb43a48(0x215):_0xb43a48(0xf6),_0x31430a['botname']=_0x43fd45?_0x43fd45['bot'][0x0][_0xb43a48(0x259)]:_0xb43a48(0x1ed)+_0x49d48b;}catch(_0x46b89c){_0x31430a[_0xb43a48(0x11a)]=_0xb43a48(0xf6),_0x31430a[_0xb43a48(0x259)]=_0xb43a48(0x1ed)+_0x49d48b;}}else _0x31430a[_0xb43a48(0x11a)]=_0xb43a48(0xf6),_0x31430a[_0xb43a48(0x259)]=_0xb43a48(0x1ed)+_0x49d48b;return _0x31430a;}function _0xaeff(_0x236ec9,_0x383853){const _0x475dde=_0x4483();return _0xaeff=function(_0x31d583,_0x119cbb){_0x31d583=_0x31d583-0x9a;let _0x448324=_0x475dde[_0x31d583];return _0x448324;},_0xaeff(_0x236ec9,_0x383853);}function getBotsWithMode(){const _0x211f4f=_0x27f97a,_0x14fa87=dbConfig[_0x211f4f(0x201)]('bots')[_0x211f4f(0x181)](_0x211f4f(0x208))[_0x211f4f(0xaf)]()||[];return _0x14fa87[_0x211f4f(0xa3)](_0x179247=>{const _0x28e145=_0x211f4f;let _0x492f1d=getBotAttributes(_0x179247[_0x28e145(0x208)]);_0x179247[_0x28e145(0x11a)]=_0x492f1d[_0x28e145(0x11a)];}),_0x14fa87;}function getBotExchanges(){const _0x812dc5=_0x27f97a;let _0x33d528=[];const _0x34ae60=dbConfig['get'](_0x812dc5(0x182))['sortBy'](_0x812dc5(0x208))[_0x812dc5(0xaf)]()||[];_0x34ae60[_0x812dc5(0xa3)](_0x2735e5=>{const _0x1958aa=_0x812dc5;if(_0x2735e5[_0x1958aa(0xbb)]=='enabled'){const _0x48e8d3=configpath+_0x1958aa(0x117)+_0x2735e5[_0x1958aa(0x208)]+_0x1958aa(0x1a3),_0x2a1d8d=fs[_0x1958aa(0x1b6)](_0x48e8d3);let _0x492bf1;if(_0x2a1d8d){const _0xed379d=fs['readFileSync'](_0x48e8d3);try{const _0x301ec8=JSON[_0x1958aa(0x1e4)](_0xed379d);_0x492bf1=_0x301ec8?_0x301ec8['bot'][0x0][_0x1958aa(0x1c5)]:null;}catch(_0x18ced3){}}if(_0x492bf1)_0x33d528[_0x1958aa(0x25b)](_0x492bf1);}});const _0x4771d9=[...new Set(_0x33d528)][_0x812dc5(0x1e8)]();return _0x4771d9;}async function initUser(){const _0x304214=_0x27f97a;if(!settings[_0x304214(0xe3)]){const _0x19980e=uuidRandom();mixpanel[_0x304214(0x267)](_0x19980e),updateSetting(_0x304214(0xe3),_0x19980e);}}async function initSecure(){const _0x25e850=_0x27f97a;let _0x4b32e6=getSecure();if(!_0x4b32e6[_0x25e850(0x21f)](_0x25e850(0x10f))){let _0x57a584=await generateKeys();_0x4b32e6[_0x25e850(0x180)]=_0x57a584['publicKey'],_0x4b32e6['privateKey']=_0x57a584[_0x25e850(0x1d2)],_0x4b32e6[_0x25e850(0x10f)]=crypto['randomBytes'](0x20)[_0x25e850(0x239)]('hex');;storeSecure(_0x4b32e6);}}function getSettings(){const _0x4cc6a8=_0x27f97a;return dbSettings[_0x4cc6a8(0x201)](_0x4cc6a8(0x212))[_0x4cc6a8(0xaf)]()||{};}function getSecure(){const _0x225367=_0x27f97a;return dbSecure[_0x225367(0x201)](_0x225367(0xed))[_0x225367(0xaf)]()||{};}function getBlacklist(){const _0x2b19f6=_0x27f97a;return dbSecure[_0x2b19f6(0x201)](_0x2b19f6(0x1ca))[_0x2b19f6(0xaf)]()||[];}function broadcastToBots(_0x17debb,_0x1c1968){config['forEach'](_0x51b3b5=>{const _0x489fad=_0xaeff;if(_0x51b3b5[_0x489fad(0xbb)]==_0x489fad(0x203)&&_0x51b3b5[_0x489fad(0x121)]==_0x489fad(0x232)||_0x51b3b5[_0x489fad(0xbb)]==_0x489fad(0x1d8)&&_0x51b3b5['live']==_0x489fad(0x232)){if(pid[_0x51b3b5['botID']])pid[_0x51b3b5[_0x489fad(0x208)]]['send']({[_0x17debb]:_0x1c1968});}});}function storeSettings(_0x1a3eeb,_0x2b3a8b=![]){const _0xd31843=_0x27f97a;_0x1a3eeb={...settings,..._0x1a3eeb};if(_0x2b3a8b&&_0x1a3eeb[_0xd31843(0x1d1)]!=_0xd31843(0xb3)&&_0x1a3eeb[_0xd31843(0x1d1)]!=_0xd31843(0x9b)&&_0x1a3eeb[_0xd31843(0x1d1)]!=''){const _0x384dae=crypt[_0xd31843(0x1ac)](secure[_0xd31843(0x1d2)],_0x1a3eeb[_0xd31843(0x1d1)])[_0xd31843(0x1a7)][_0xd31843(0x11b)]('@')[0x0],_0x301baf=bcrypt[_0xd31843(0x126)](_0x384dae,saltRounds);_0x1a3eeb={..._0x1a3eeb,'bbPassword':_0x301baf};}if(_0x2b3a8b&&_0x1a3eeb['telegramToken']!=_0xd31843(0xb3)&&_0x1a3eeb[_0xd31843(0x197)]!='***'&&_0x1a3eeb[_0xd31843(0x197)]!=''){const _0x47797e=crypt[_0xd31843(0x1ac)](secure['privateKey'],_0x1a3eeb['telegramToken'])['message']['split']('@')[0x0];_0x1a3eeb={..._0x1a3eeb,'telegramToken':_0x47797e};}const _0x148c42=_0x1a3eeb[_0xd31843(0x197)]!='************'&&_0x1a3eeb['telegramToken']!=settings['telegramToken']||_0x1a3eeb[_0xd31843(0x19b)]!=settings[_0xd31843(0x19b)],_0x579b9e=_0x1a3eeb[_0xd31843(0x197)]==''||_0x1a3eeb[_0xd31843(0x19b)]=='';if(_0x148c42)_0x1a3eeb[_0xd31843(0x162)]='all';for(const [_0x43aed5,_0xd8607c]of Object[_0xd31843(0x1db)](_0x1a3eeb)){if(_0x43aed5==_0xd31843(0x197)&&_0xd8607c==_0xd31843(0xb3)){_0x1a3eeb[_0xd31843(0x197)]=settings[_0xd31843(0x197)];continue;};if(_0x43aed5==_0xd31843(0x1d1)&&_0xd8607c==_0xd31843(0xb3)){_0x1a3eeb[_0xd31843(0x1d1)]=settings[_0xd31843(0x1d1)];continue;};dbSettings[_0xd31843(0x160)](_0xd31843(0x25c)+_0x43aed5,_0xd8607c)[_0xd31843(0x196)]();}settings=_0x1a3eeb,io['to'](_0xd31843(0x16e))[_0xd31843(0x16b)]('settings',cleanSettings()),broadcastToBots(_0xd31843(0x188),settings[_0xd31843(0x188)]),broadcastToBots(_0xd31843(0x249),settings[_0xd31843(0x249)]);if(_0x148c42&&!_0x579b9e)initTelegram();if(_0x148c42&&_0x579b9e)disableTelegram();getAllClients()[_0xd31843(0xa3)](_0x36e21f=>{const _0x2a05b3=_0xd31843;getSocket(_0x36e21f['id'])[_0x2a05b3(0x16b)](_0x2a05b3(0xbb),{'access':{'allow':![],'reason':_0x2a05b3(0x206),'token':null}});});}function updateSetting(_0x2c473f,_0xa9e57e){const _0x4f1a3e=_0x27f97a;dbSettings[_0x4f1a3e(0x160)](_0x4f1a3e(0x25c)+_0x2c473f,_0xa9e57e)[_0x4f1a3e(0x196)](),settings=getSettings(),io['to'](_0x4f1a3e(0x16e))[_0x4f1a3e(0x16b)](_0x4f1a3e(0x212),cleanSettings());}function storeSecure(_0x1a7d39){const _0x8d52aa=_0x27f97a;dbSecure[_0x8d52aa(0x201)](_0x8d52aa(0xed))['push'](_0x1a7d39)[_0x8d52aa(0x196)](),secure=_0x1a7d39;}function addBlacklist(_0x1d3530){const _0x4c493e=_0x27f97a;cleanBlacklist();let _0x46506d;devices[_0x1d3530]['telegramIpApproval']?_0x46506d=Math['max'](devices[_0x1d3530]['telegramIpApproval'][_0x4c493e(0x257)],loginExpiry):_0x46506d=loginExpiry,dbSecure[_0x4c493e(0x201)](_0x4c493e(0x1ca))[_0x4c493e(0x25b)]({'expiry':new Date()[_0x4c493e(0x1a6)]()+_0x46506d*0x3c*0x3e8,'token':devices[_0x1d3530][_0x4c493e(0xa7)]['token']})[_0x4c493e(0x196)](),blacklist=dbSecure[_0x4c493e(0x201)]('blacklist')[_0x4c493e(0xaf)]();}function cleanBlacklist(){const _0x511fca=_0x27f97a;let _0x256836=dbSecure[_0x511fca(0x201)]('blacklist')[_0x511fca(0x1c2)]()[_0x511fca(0xaf)](),_0x4a38f4=new Date()[_0x511fca(0x1a6)]();_0x256836['forEach'](_0x277ca8=>{const _0x37455e=_0x511fca;_0x277ca8[_0x37455e(0x257)]<_0x4a38f4&&dbSecure['get'](_0x37455e(0x1ca))[_0x37455e(0x245)]({'expiry':_0x277ca8['expiry']})['write']();});}function initStates(){const _0xe1fb1e=_0x27f97a;let _0x5c59e7=getConfiguration();_0x5c59e7[_0xe1fb1e(0xa3)](_0x57525a=>{const _0xcafa2b=_0xe1fb1e;_0x57525a[_0xcafa2b(0x121)]=_0xcafa2b(0xa6);}),storeConfiguration(_0x5c59e7);}function onKeys(){const _0x565ce3=new RSA();return new Promise(_0xd7f57a=>{const _0xf15fb=_0xaeff;_0x565ce3[_0xf15fb(0xd5)]()[_0xf15fb(0x269)](_0x5ded53=>{_0xd7f57a(_0x5ded53);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x40bedc=_0x27f97a;let _0x1e8578=getSettings(),_0x271c74=![];!_0x1e8578[_0x40bedc(0x21f)](_0x40bedc(0x12b))&&(_0x1e8578['lastmsgtelegram']=0x0,_0x271c74=!![]);!_0x1e8578['hasOwnProperty'](_0x40bedc(0x192))&&(_0x1e8578[_0x40bedc(0x192)]=0x0,_0x271c74=!![]);!_0x1e8578[_0x40bedc(0x21f)](_0x40bedc(0x276))&&(_0x1e8578[_0x40bedc(0x276)]=_0x40bedc(0x1fa),_0x271c74=!![]);!_0x1e8578[_0x40bedc(0x21f)](_0x40bedc(0x249))&&(_0x1e8578[_0x40bedc(0x249)]=![],_0x271c74=!![]);if(_0x271c74)storeSettings(_0x1e8578);try{fs[_0x40bedc(0x125)](configbackuppath,{'withFileTypes':!![]})[_0x40bedc(0xa3)](_0x5ab4c5=>{const _0x5eb23e=_0x40bedc;if(!_0x5ab4c5[_0x5eb23e(0xcb)]()){if(!_0x5ab4c5['name'][_0x5eb23e(0x174)](_0x5eb23e(0x1c8)))fs['unlinkSync'](configbackuppath+_0x5ab4c5['name']);}else fs[_0x5eb23e(0x1b8)](configbackuppath+_0x5ab4c5['name'],{'recursive':!![]});});}catch(_0x2d8aa9){logger[_0x40bedc(0x14b)](_0x40bedc(0x16d),_0x2d8aa9);}}function storeConfiguration(_0x9cfa0b){const _0x40bb31=_0x27f97a;dbConfig[_0x40bb31(0x201)](_0x40bb31(0x182))['remove']()['write'](),_0x9cfa0b[_0x40bb31(0xa3)](_0x2db40a=>{const _0x383c17=_0x40bb31;delete _0x2db40a[_0x383c17(0x11a)];}),dbConfig['get'](_0x40bb31(0x182))[_0x40bb31(0x25b)](..._0x9cfa0b)[_0x40bb31(0x196)](),config=_0x9cfa0b;}function resetPassword(){const _0x5872dc=_0x27f97a;tgBot&&settings[_0x5872dc(0x217)]&&(tgBot[_0x5872dc(0x1dc)](_0x5872dc(0x248)),tgBot[_0x5872dc(0x24c)](settings['telegramChatId'],_0x5872dc(0xa4),{'parse_mode':_0x5872dc(0x216),'reply_markup':{'inline_keyboard':[[{'text':_0x5872dc(0x111),'callback_data':_0x5872dc(0x111)},{'text':'no','callback_data':'no'}]]}})[_0x5872dc(0xc7)](_0x4df6f7=>{telegramError(_0x4df6f7);}),tgBot['on'](_0x5872dc(0x248),async _0xa1742a=>{const _0x19e711=_0x5872dc,_0x11c600=_0xa1742a[_0x19e711(0xc1)],_0x4b8e2d=_0xa1742a['message'];tgBot[_0x19e711(0x26e)](_0xa1742a['id'])[_0x19e711(0x269)](async()=>{const _0x579453=_0x19e711;if(_0x11c600!='no'){const _0x5edf27=0xf,_0x1e35b8='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0xf4a06d=Array['from'](crypto[_0x579453(0xc4)](new Uint32Array(_0x5edf27)))[_0x579453(0x243)](_0x55518a=>_0x1e35b8[_0x55518a%_0x1e35b8['length']])[_0x579453(0xc6)](''),_0x4722a7=bcrypt[_0x579453(0x126)](_0xf4a06d,saltRounds);storeSettings({'bbPassword':_0x4722a7}),await tgBot[_0x579453(0x24c)](_0x4b8e2d[_0x579453(0x164)]['id'],_0x579453(0x266)+_0xf4a06d,{'parse_mode':_0x579453(0x216)})['catch'](_0x57bcae=>{telegramError(_0x57bcae);});}else await tgBot[_0x579453(0x24c)](_0x4b8e2d['chat']['id'],_0x579453(0xb5))['catch'](_0x53de5f=>{telegramError(_0x53de5f);});}),tgBot[_0x19e711(0x1dc)]('callback_query');}));}async function confirmRestore(_0x571baf,_0x22c91a){const _0x52f91d=_0x27f97a;io['to'](_0x52f91d(0x16e))['emit']('notification',_0x52f91d(0x9d),_0x52f91d(0xc9)),tgBot&&settings[_0x52f91d(0x217)]&&(tgBot['removeListener'](_0x52f91d(0x248)),await tgBot[_0x52f91d(0x24c)](settings['telegramChatId'],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x52f91d(0x111),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x52f91d(0xc7)](_0x585f2c=>{telegramError(_0x585f2c);}),tgBot['on'](_0x52f91d(0x248),async _0x38bb90=>{const _0xe45295=_0x52f91d,_0x59404e=_0x38bb90['data'],_0x3c1429=_0x38bb90[_0xe45295(0x1a7)];tgBot[_0xe45295(0x26e)](_0x38bb90['id'])[_0xe45295(0x269)](async()=>{const _0x5ab504=_0xe45295;_0x59404e==_0x5ab504(0x111)?(await tgBot[_0x5ab504(0x24c)](_0x3c1429[_0x5ab504(0x164)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x5ab504(0x216)})[_0x5ab504(0xc7)](_0x43ac20=>{telegramError(_0x43ac20);}),unzipFile(_0x571baf,_0x22c91a)):(logger[_0x5ab504(0x14b)](_0x5ab504(0xe6)),await tgBot[_0x5ab504(0x24c)](_0x3c1429['chat']['id'],'Restore\x20process\x20aborted')[_0x5ab504(0xc7)](_0x7b627e=>{telegramError(_0x7b627e);}));}),tgBot[_0xe45295(0x1dc)](_0xe45295(0x248));}));}function getServerTime(){const _0x2d4a47=_0x27f97a,_0x3e0a7a=new Date();return _0x3e0a7a[_0x2d4a47(0x20e)]()+'/'+(_0x3e0a7a[_0x2d4a47(0x1b7)]()+0x1)[_0x2d4a47(0x239)]()[_0x2d4a47(0x1b4)](0x2,'0')+'/'+_0x3e0a7a[_0x2d4a47(0x22e)]()[_0x2d4a47(0x239)]()[_0x2d4a47(0x1b4)](0x2,'0')+'\x20'+_0x3e0a7a[_0x2d4a47(0x272)]()['toString']()[_0x2d4a47(0x1b4)](0x2,'0')+':'+_0x3e0a7a[_0x2d4a47(0xc3)]()[_0x2d4a47(0x239)]()[_0x2d4a47(0x1b4)](0x2,'0')+':'+_0x3e0a7a['getSeconds']()[_0x2d4a47(0x239)]()[_0x2d4a47(0x1b4)](0x2,'0');}function getTimeStamp(){const _0x2fa549=_0x27f97a,_0x58d340=shiftedTime();return _0x58d340[_0x2fa549(0x20e)]()+'/'+(_0x58d340[_0x2fa549(0x1b7)]()+0x1)[_0x2fa549(0x239)]()[_0x2fa549(0x1b4)](0x2,'0')+'/'+_0x58d340[_0x2fa549(0x22e)]()[_0x2fa549(0x239)]()[_0x2fa549(0x1b4)](0x2,'0')+'\x20'+_0x58d340[_0x2fa549(0x272)]()[_0x2fa549(0x239)]()[_0x2fa549(0x1b4)](0x2,'0')+':'+_0x58d340[_0x2fa549(0xc3)]()[_0x2fa549(0x239)]()['padStart'](0x2,'0')+':'+_0x58d340[_0x2fa549(0xb2)]()[_0x2fa549(0x239)]()[_0x2fa549(0x1b4)](0x2,'0');}function getCleanTimeStamp(){const _0x8d3183=_0x27f97a,_0x436535=shiftedTime();return _0x436535[_0x8d3183(0x20e)]()+(_0x436535[_0x8d3183(0x1b7)]()+0x1)['toString']()[_0x8d3183(0x1b4)](0x2,'0')+_0x436535[_0x8d3183(0x22e)]()['toString']()[_0x8d3183(0x1b4)](0x2,'0')+'-'+_0x436535[_0x8d3183(0x272)]()[_0x8d3183(0x239)]()[_0x8d3183(0x1b4)](0x2,'0')+_0x436535['getMinutes']()[_0x8d3183(0x239)]()[_0x8d3183(0x1b4)](0x2,'0')+_0x436535['getSeconds']()[_0x8d3183(0x239)]()[_0x8d3183(0x1b4)](0x2,'0');}function shiftedTime(){const _0x8078d2=_0x27f97a,_0x51b27d=new Date();let _0x321bff=_0x51b27d;if(settings[_0x8078d2(0x188)]&&settings[_0x8078d2(0x188)]!==0x0)_0x321bff=fns[_0x8078d2(0x103)](_0x51b27d,{'hours':settings[_0x8078d2(0x188)]});return _0x321bff;}function startScheduler(){const _0x1dac94=_0x27f97a,_0x14467a=new Date()[_0x1dac94(0xf9)](),_0x23993f=shiftedTime()[_0x1dac94(0x272)]();_0x23993f==0x4&&backupConfigFiles();_0x23993f==0x0&&rotateLogFiles();_0x14467a%0x6==0x0&&triggerAnalytics();_0x14467a%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x5dc62e){const _0x407dcd=_0x27f97a;logger[_0x407dcd(0x14b)](_0x407dcd(0x27c)+_0x5dc62e);const _0x10cb8c=getBotsWithMode();_0x10cb8c[_0x407dcd(0xfe)]>0x0?confirmRestore(configbackuppath,_0x5dc62e):unzipFile(configbackuppath,_0x5dc62e);}async function getBackupFiles(_0x5e2895=null){const _0x3bacce=_0x27f97a;let _0x42e92d=[],_0x48cf19=fs[_0x3bacce(0x125)](configbackuppath,{'withFileTypes':!![]});_0x48cf19['sort']((_0x4f784c,_0x246c49)=>_0x4f784c[_0x3bacce(0x278)]<_0x246c49[_0x3bacce(0x278)]?0x1:_0x246c49[_0x3bacce(0x278)]<_0x4f784c['name']?-0x1:0x0),_0x48cf19['forEach'](_0x267852=>{const _0x37601c=_0x3bacce;if(!_0x267852[_0x37601c(0xcb)]()&&_0x267852[_0x37601c(0x278)][_0x37601c(0x174)](_0x37601c(0x1c8))&&_0x267852[_0x37601c(0x278)][_0x37601c(0x9a)]('.zip')){const _0x535295=formatDate(fs[_0x37601c(0x170)](configbackuppath+_0x267852[_0x37601c(0x278)])[_0x37601c(0xb1)]);_0x42e92d[_0x37601c(0x25b)]({'name':_0x267852['name'],'mtime':_0x535295});}});if(_0x5e2895)io['to'](_0x5e2895)[_0x3bacce(0x16b)](_0x3bacce(0x23e),_0x42e92d);else return _0x42e92d;}async function backupConfigFiles(){const _0x5deaec=_0x27f97a;await zipFiles(_0x5deaec(0x13e));const _0xe84168=getCleanTimeStamp();fs[_0x5deaec(0x273)](zippath+'backup-full.zip',configbackuppath+(_0x5deaec(0x1c8)+_0xe84168+_0x5deaec(0x15e)));let _0x2aec7f=fs[_0x5deaec(0x125)](configbackuppath,{'withFileTypes':!![]});_0x2aec7f[_0x5deaec(0x1e8)]((_0x2e315a,_0x203084)=>_0x2e315a['name']<_0x203084[_0x5deaec(0x278)]?0x1:_0x203084[_0x5deaec(0x278)]<_0x2e315a[_0x5deaec(0x278)]?-0x1:0x0),_0x2aec7f[_0x5deaec(0xfe)]>maxBackups&&fs[_0x5deaec(0x261)](configbackuppath+_0x2aec7f[maxBackups][_0x5deaec(0x278)]);}function rotateLogFiles(){const _0x56bda7=_0x27f97a,_0x54f20a=fs[_0x56bda7(0x170)](logspath+_0x56bda7(0x1ba)),_0x55cca8=_0x54f20a[_0x56bda7(0xa2)]/0x400;if(_0x55cca8>0x64){let _0x4be876=fs[_0x56bda7(0x125)](logspath,{'withFileTypes':!![]});_0x4be876['sort']((_0x51977e,_0x430830)=>_0x51977e[_0x56bda7(0x278)]<_0x430830[_0x56bda7(0x278)]?0x1:_0x430830['name']<_0x51977e[_0x56bda7(0x278)]?-0x1:0x0),_0x4be876['forEach'](_0x50813f=>{const _0x18a90e=_0x56bda7;if(_0x50813f[_0x18a90e(0x278)]==_0x18a90e(0xa9))fs[_0x18a90e(0x273)](logspath+_0x50813f[_0x18a90e(0x278)],logspath+_0x18a90e(0x210));if(_0x50813f[_0x18a90e(0x278)]==_0x18a90e(0x1c6))fs['copyFileSync'](logspath+_0x50813f[_0x18a90e(0x278)],logspath+_0x18a90e(0xa9));_0x50813f[_0x18a90e(0x278)]==_0x18a90e(0x1ba)&&(fs[_0x18a90e(0x273)](logspath+_0x50813f[_0x18a90e(0x278)],logspath+_0x18a90e(0x1c6)),fs['writeFileSync'](logspath+_0x50813f[_0x18a90e(0x278)],''));});}}async function zipFiles(_0x31ed7c){const _0x1c0da1=_0x27f97a;let _0x29dc7e;if(_0x31ed7c==_0x1c0da1(0x1d7))_0x29dc7e=logspath;if(_0x31ed7c==_0x1c0da1(0x258))_0x29dc7e=configpath;if(_0x31ed7c=='backup-full')_0x29dc7e=configpath;let _0x433ce7=fs[_0x1c0da1(0x125)](_0x29dc7e,{'withFileTypes':!![]});const _0x43cfeb=new require(_0x1c0da1(0xce))();_0x433ce7[_0x1c0da1(0xa3)](_0xdafb17=>{const _0x1964a5=_0x1c0da1;if(!_0xdafb17[_0x1964a5(0xcb)]()){let _0x2d1acf=fs['readFileSync'](_0x29dc7e+_0xdafb17[_0x1964a5(0x278)]);if(_0x31ed7c==_0x1964a5(0x258)){const _0x36ad1e=/^bot-[0-9]{3}-config.json$/,_0x1c28e2=_0x36ad1e[_0x1964a5(0x1d6)](_0xdafb17[_0x1964a5(0x278)]);if(_0x1c28e2){const _0x2a5f37=JSON[_0x1964a5(0x1e4)](_0x2d1acf);if(_0x2a5f37[_0x1964a5(0xf3)][0x0]){_0x2a5f37[_0x1964a5(0xf3)][0x0][_0x1964a5(0xdf)]=_0x1964a5(0x9b),_0x2a5f37[_0x1964a5(0xf3)][0x0][_0x1964a5(0x24a)]='***';if(_0x2a5f37[_0x1964a5(0xf3)][0x0][_0x1964a5(0x14d)])_0x2a5f37[_0x1964a5(0xf3)][0x0][_0x1964a5(0x14d)]=_0x1964a5(0x9b);}_0x2d1acf=JSON['stringify'](_0x2a5f37,null,0x2);}if(_0xdafb17[_0x1964a5(0x278)]==_0x1964a5(0x1a1)){const _0x5ed50b=JSON[_0x1964a5(0x1e4)](_0x2d1acf);if(_0x5ed50b[_0x1964a5(0x212)][_0x1964a5(0x171)])_0x5ed50b[_0x1964a5(0x212)][_0x1964a5(0x171)]=![];if(_0x5ed50b[_0x1964a5(0x212)][_0x1964a5(0x1d1)])_0x5ed50b[_0x1964a5(0x212)][_0x1964a5(0x1d1)]='***';if(_0x5ed50b['settings'][_0x1964a5(0x197)])_0x5ed50b['settings'][_0x1964a5(0x197)]=_0x1964a5(0x9b);if(_0x5ed50b['settings']['telegramChatId'])_0x5ed50b[_0x1964a5(0x212)][_0x1964a5(0x217)]=null;_0x2d1acf=JSON[_0x1964a5(0xb6)](_0x5ed50b,null,0x2);}if(_0xdafb17[_0x1964a5(0x278)]!=_0x1964a5(0x21c))_0x43cfeb['file'](_0xdafb17[_0x1964a5(0x278)],_0x2d1acf);}else _0x43cfeb[_0x1964a5(0x26d)](_0xdafb17['name'],_0x2d1acf);}});const _0x38f189=_0x43cfeb['generate']({'base64':![],'compression':'DEFLATE'});fs[_0x1c0da1(0x244)](zippath+(_0x31ed7c+'.zip'),_0x38f189,_0x1c0da1(0x250));}async function unzipFile(_0x470fd7,_0x1b1ce6){const _0x13e437=_0x27f97a;fs[_0x13e437(0x125)](configpath,{'withFileTypes':!![]})['forEach'](_0x361a4d=>{const _0x2744f4=_0x13e437;if(!_0x361a4d[_0x2744f4(0xcb)]())fs[_0x2744f4(0x1b8)](configpath+_0x361a4d['name']);});const _0x138d53=fs[_0x13e437(0x1fc)](_0x470fd7+_0x1b1ce6,_0x13e437(0x250)),_0x1f30f1=new require('node-zip')(_0x138d53,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x1f30f1[_0x13e437(0x1a4)])[_0x13e437(0xa3)](_0x34a9e8=>{const _0x3206ab=_0x13e437,_0xe4a122=_0x1f30f1[_0x3206ab(0x1a4)][_0x34a9e8];fs[_0x3206ab(0x244)](configpath+_0xe4a122[_0x3206ab(0x278)],_0xe4a122['_data']);}),fs[_0x13e437(0x125)](temppath,{'withFileTypes':!![]})[_0x13e437(0xa3)](_0x4301c6=>{const _0xb744c7=_0x13e437;if(!_0x4301c6[_0xb744c7(0xcb)]())fs[_0xb744c7(0x1b8)](temppath+_0x4301c6[_0xb744c7(0x278)]);}),logger['debug'](_0x13e437(0x1bb)),process[_0x13e437(0x19f)]({'restore':!![]},_0x524a9a=>{});}async function getPublicIp(){const _0x5c2a83=_0x27f97a;try{const _0x4780e5=await axios[_0x5c2a83(0x201)](_0x5c2a83(0x223));publicip=_0x4780e5[_0x5c2a83(0xc1)]['ip'];}catch(_0x313da3){}}async function triggerAnalytics(){const _0x5c007a=_0x27f97a;if(!publicip)await getPublicIp();const _0x50c6b4=getBotsWithMode();let _0x2525e5=0x0;_0x50c6b4[_0x5c007a(0xa3)](_0x24f614=>{const _0x55b516=_0x5c007a;if(_0x24f614[_0x55b516(0xbb)]===_0x55b516(0x203))_0x2525e5++;});const _0x5d1f3e=getBotExchanges();mixpanel['track'](_0x5c007a(0x20a),{'distinct_id':settings[_0x5c007a(0xe3)],'ip':publicip,'version':serverversion,'numbots':_0x50c6b4[_0x5c007a(0xfe)],'numbotsenabled':_0x2525e5,'exchanges':_0x5d1f3e});}async function getMessages(){const _0x113fa9=_0x27f97a,_0x26d9d='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x287b58=new GraphQLClient(_0x26d9d),_0x1bf6dd={'authorization':_0x113fa9(0x18c)},_0x2c98a9=serverversion[_0x113fa9(0x11b)]('.'),_0x5444b6=_0x2c98a9[0x0]+'.'+_0x2c98a9[0x1],_0x355c98=Math[_0x113fa9(0x1fe)](settings['lastmsgtelegram'],settings['lastmsgemitted']),_0xd791de={'last':parseInt(_0x355c98),'bbm':_0x5444b6},_0x26f08e=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1b4e5c;try{_0x1b4e5c=await _0x287b58[_0x113fa9(0x13a)](_0x26f08e,_0xd791de,_0x1bf6dd);}catch(_0x8fd379){}if(_0x1b4e5c&&_0x1b4e5c[_0x113fa9(0xbd)]){let _0x34a796=settings['lastmsgtelegram'];newMessages=[];for(const _0x2d263d of _0x1b4e5c[_0x113fa9(0xbd)]){newMessages['push'](_0x2d263d);if(_0x2d263d['bbvNew'])updateSetting(_0x113fa9(0x276),_0x2d263d[_0x113fa9(0x1cd)]);let _0x38918a=_0x2d263d[_0x113fa9(0x1cd)]?serverversion>=_0x2d263d['bbvNew']:![];if(!_0x38918a&&_0x2d263d['number']>_0x34a796){if(_0x2d263d[_0x113fa9(0x145)]===_0x113fa9(0x177)||serverversion[_0x113fa9(0x174)](_0x2d263d[_0x113fa9(0x145)])){let _0x34c0d2=''+_0x2d263d[_0x113fa9(0xf2)]+'\x0a\x0a'+_0x2d263d[_0x113fa9(0x1a7)];const _0x557123=await sendTelegramMsg(toTelegramMarkdown(_0x34c0d2),_0x113fa9(0x106));if(_0x557123)_0x34a796=_0x2d263d[_0x113fa9(0x10b)];}}}updateAvailable=isNewerVersion(settings[_0x113fa9(0x276)],serverversion),updateSetting(_0x113fa9(0x12b),_0x34a796),emitMessages();}}function emitMessages(){const _0x40d56d=_0x27f97a,_0xbcc0ba=settings['lastmsgemitted'];let _0x5db512=[];newMessages[_0x40d56d(0xa3)](_0x58f3a3=>{const _0x2c12f4=_0x40d56d;_0x58f3a3[_0x2c12f4(0x10b)]>_0xbcc0ba&&_0x5db512[_0x2c12f4(0x25b)](_0x58f3a3);}),_0x5db512[_0x40d56d(0xfe)]>0x0&&getAllClients()[_0x40d56d(0xa3)](_0x30ab69=>{const _0x355da0=_0x40d56d;getSocket(_0x30ab69['id'])[_0x355da0(0x16b)](_0x355da0(0x1a7),_0x5db512);});}function confirmMessage(_0x5a917b){const _0x4b6c99=_0x27f97a;updateSetting(_0x4b6c99(0x192),Number(_0x5a917b));}function isNewerVersion(_0x32605a,_0x677eb){const _0x46ab5a=_0x27f97a,_0xc5b740=_0x677eb[_0x46ab5a(0x11b)]('.'),_0x196bb1=_0x32605a['split']('.');for(var _0x6332f3=0x0;_0x6332f3<_0x196bb1[_0x46ab5a(0xfe)];_0x6332f3++){const _0x597b38=~~_0x196bb1[_0x6332f3],_0x23e6d5=~~_0xc5b740[_0x6332f3];if(_0x597b38>_0x23e6d5)return!![];if(_0x597b38<_0x23e6d5)return![];}return![];}function toTelegramMarkdown(_0x432d1c){const _0x5cdd51=_0x27f97a,_0x5891ce=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x1712df=/\*{2}(.+?)\*{2}/gim;return _0x432d1c=_0x432d1c[_0x5cdd51(0xc2)](_0x5891ce,_0x5cdd51(0x204))[_0x5cdd51(0xc2)](_0x1712df,_0x5cdd51(0x26f)),_0x432d1c;}async function validateConfigFile(){const _0x500649=_0x27f97a,_0x2d8576=dbConfig[_0x500649(0x201)](_0x500649(0x182))['sortBy'](_0x500649(0x208))[_0x500649(0xaf)]()||[];if(_0x2d8576['length']==0x0){let _0x3810bc=0x0,_0x15a436=[];const _0x25d911=/^bot-([0-9]{3})-config.json$/,_0x368bf6=fs[_0x500649(0x125)](configpath);_0x368bf6['forEach'](_0x57363c=>{const _0x2d143a=_0x500649,_0x4edaf0=_0x25d911[_0x2d143a(0x1b2)](_0x57363c);if(_0x4edaf0){const _0x5e79b3=_0x4edaf0[0x1];let _0x3e8f62=getBotAttributes(_0x5e79b3);_0x15a436[_0x2d143a(0x25b)]({'botID':_0x5e79b3,'botname':_0x3e8f62['botname'],'status':_0x2d143a(0x1e5),'live':'stopped'}),_0x3810bc++;}}),_0x3810bc!=0x0&&(dbConfig['get'](_0x500649(0x182))[_0x500649(0x1dd)](_0x15a436)[_0x500649(0x196)](),config=_0x15a436,restoredConfigFile=_0x3810bc);}}async function restoreConfigNotify(_0x4950d8){const _0x52caac=_0x27f97a;let _0x2fdbc2;if(restoredConfigFile==0x1)_0x2fdbc2=_0x52caac(0x115);else _0x2fdbc2='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x4950d8)io['to'](_0x52caac(0x16e))['emit']('notification',_0x2fdbc2);else{logger[_0x52caac(0xad)]('-----------------------------------------------------------------------------------'),logger[_0x52caac(0xad)](_0x2fdbc2),logger[_0x52caac(0xad)]('-----------------------------------------------------------------------------------'),logger[_0x52caac(0xad)]('');if(tgBot&&settings[_0x52caac(0x217)]&&settings[_0x52caac(0x162)]!=_0x52caac(0x1bf))tgBot['sendMessage'](settings[_0x52caac(0x217)],'Bot\x20Mgr\x20>\x20'+_0x2fdbc2)[_0x52caac(0xc7)](_0x465693=>{telegramError(_0x465693);});}}function validateCredentials(_0x5bc0ca,_0x21d935){const _0x40c205=_0x27f97a;if(_0x5bc0ca['username']==settings[_0x40c205(0x18a)]&&bcrypt[_0x40c205(0x1af)](_0x5bc0ca['password'],settings[_0x40c205(0x1d1)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x40c205(0x22d),'token':null};else{const _0x2897c3=generateLoginToken(_0x21d935);return{'allow':!![],'reason':_0x40c205(0x209),'token':_0x2897c3};}}else return{'allow':![],'reason':_0x40c205(0x23c),'token':null};}function refreshToken(_0x1185b2){const _0x35fb78=_0x27f97a,_0x3ce91f=generateLoginToken(_0x1185b2);return{'allow':!![],'reason':_0x35fb78(0x209),'token':_0x3ce91f};}function validateAccess(_0x59b697,_0xc6ea74,_0x1a91f7){const _0x2a4e50=_0x27f97a,_0x465df6=_0x1a91f7?_0x1a91f7:devices[_0xc6ea74]['ip'];let _0x1b5c50;const _0x200773=_0x255292=>{const _0x207e27=_0xaeff;if(settings[_0x207e27(0x171)]){if(settings[_0x207e27(0x237)]){if(telegram2FaApproved(_0xc6ea74)){const _0x1710a3=generateLoginToken(_0xc6ea74);return{'allow':!![],'reason':_0x207e27(0x1d0),'token':_0x1710a3};}else return{'allow':![],'reason':_0x207e27(0x1f7),'token':null};}else return _0x1b5c50=validToken(_0x255292,_0xc6ea74),_0x1b5c50[_0x207e27(0x21f)]('success')?{'allow':!![],'reason':_0x207e27(0x156),'token':_0x255292}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x2a4e50(0xb8)]){let _0x17787f=[...settings[_0x2a4e50(0x10e)],_0x2a4e50(0x233),_0x2a4e50(0x17a),_0x2a4e50(0xaa)];if(_0x17787f[_0x2a4e50(0x9c)](_0x465df6))return _0x200773(_0x59b697);else{_0x1b5c50=validToken(_0x59b697,_0xc6ea74);if(_0x1b5c50[_0x2a4e50(0x21f)](_0x2a4e50(0xc9)))return _0x200773(_0x59b697);else{if(telegramIpApproved(_0xc6ea74)){const _0x1c518c=generateToken(_0xc6ea74);return _0x1b5c50=_0x200773(_0x59b697),_0x1b5c50['allow']?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x1c518c}:_0x1b5c50;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x2a4e50(0xd0),'token':null}:{'allow':![],'reason':_0x2a4e50(0xb4),'token':null};}}}else return _0x200773(_0x59b697);}function timelyDecrypt(_0x4ed92b,_0x373d67=!![]){const _0x127e8d=_0x27f97a;if(_0x4ed92b)try{const _0x186426=crypt['decrypt'](secure['privateKey'],_0x4ed92b)[_0x127e8d(0x1a7)],_0x5f568f=_0x186426[_0x127e8d(0x11b)]('@')[0x0],_0x5b4d26=_0x186426[_0x127e8d(0x11b)]('@')[0x1],_0x31fb20=new Date()['getTime']();if(_0x373d67){if(_0x31fb20-_0x5b4d26<maxSecretAge*0x3e8)return _0x5f568f;else return![];}else return _0x5f568f;}catch(_0xa57c93){return![];}else return![];}const validToken=(_0x1906d0,_0x3af165)=>{const _0xbefd56=_0x27f97a,_0x16535b=devices[_0x3af165]['ip'];if(!_0x1906d0)return{'error':'No\x20authentication\x20token'};for(let _0x292195 of blacklist){if(_0x292195[_0xbefd56(0xeb)]==_0x1906d0)return{'error':'Token\x20blacklisted'};}let _0x5693f2;try{_0x5693f2=jwt['verify'](_0x1906d0,secure[_0xbefd56(0x10f)]+_0x3af165);}catch{return{'error':_0xbefd56(0x246)};}if(!_0x5693f2[_0xbefd56(0x21f)](_0xbefd56(0x9e))&&!_0x5693f2['hasOwnProperty'](_0xbefd56(0x193))||!_0x5693f2['hasOwnProperty'](_0xbefd56(0xa1)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x5693f2[_0xbefd56(0x21f)](_0xbefd56(0x193))&&_0x5693f2[_0xbefd56(0x21f)]('clientip')){const {clientip:_0x114067}=_0x5693f2;return _0x16535b==_0x114067?{'success':_0xbefd56(0x1ad)}:{'error':_0xbefd56(0x1f3)};}else{if(_0x5693f2[_0xbefd56(0x21f)](_0xbefd56(0x193))&&_0x5693f2[_0xbefd56(0x21f)](_0xbefd56(0x9e))){const {username:_0x263222,clientip:_0x3743ab}=_0x5693f2;return settings['bbUsername']==_0x263222&&_0x16535b==_0x3743ab?{'success':_0xbefd56(0x1ad)}:{'error':_0xbefd56(0xcf)};}}},generateLoginToken=_0x436cc2=>{const _0x232603=_0x27f97a;if(_0x436cc2){const _0x5b1ca2=devices[_0x436cc2]['ip'];return jwt[_0x232603(0x10a)]({'username':settings[_0x232603(0x18a)],'clientip':_0x5b1ca2},secure[_0x232603(0x10f)]+_0x436cc2,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x275d4c=>{const _0x3ad5ce=_0x27f97a;if(_0x275d4c){const _0x376752=devices[_0x275d4c]['ip'];return jwt[_0x3ad5ce(0x10a)]({'clientip':_0x376752},secure[_0x3ad5ce(0x10f)]+_0x275d4c,{'expiresIn':devices[_0x275d4c][_0x3ad5ce(0x253)][_0x3ad5ce(0x257)]*0x3c});}else return![];},telegramIpApproved=_0x4ffc1a=>{const _0x462de0=_0x27f97a;let _0x303678=![];return devices[_0x4ffc1a][_0x462de0(0x253)]&&devices[_0x4ffc1a]['telegramIpApproval'][_0x462de0(0x257)]!=_0x462de0(0x146)&&(_0x303678=devices[_0x4ffc1a][_0x462de0(0x253)][_0x462de0(0x9e)]==devices[_0x4ffc1a]['ip']&&new Date()['getTime']()-devices[_0x4ffc1a][_0x462de0(0x253)][_0x462de0(0xe8)]<devices[_0x4ffc1a]['telegramIpApproval'][_0x462de0(0x257)]*0x3c*0x3e8),_0x303678;},telegram2FaApproved=_0x385eb8=>{const _0x52b218=_0x27f97a;let _0x1bf9aa=![];return devices[_0x385eb8]['telegram2FaApproval']&&devices[_0x385eb8][_0x52b218(0x116)][_0x52b218(0x257)]!='reject'&&(_0x1bf9aa=devices[_0x385eb8][_0x52b218(0x116)][_0x52b218(0x9e)]==devices[_0x385eb8]['ip']&&new Date()[_0x52b218(0x1a6)]()-devices[_0x385eb8][_0x52b218(0x116)][_0x52b218(0xe8)]<devices[_0x385eb8][_0x52b218(0x116)][_0x52b218(0x257)]*0x3c*0x3e8),_0x1bf9aa;},normalizeIP=_0x2afce7=>{const _0x5abab6=_0x27f97a;let _0xc8bdb=null,_0x72ee57=null;if(ipaddr['isValid'](_0x2afce7)){const _0x43345a=ipaddr[_0x5abab6(0x1e4)](_0x2afce7);_0x43345a[_0x5abab6(0x22c)]()==='ipv6'?(_0x43345a[_0x5abab6(0x20c)]()&&(_0xc8bdb=_0x43345a['toIPv4Address']()['toString']()),_0x72ee57=_0x43345a[_0x5abab6(0x239)]()):(_0xc8bdb=_0x43345a[_0x5abab6(0x239)](),_0x72ee57=_0x43345a[_0x5abab6(0x1a5)]()[_0x5abab6(0x239)]());}return{'show':_0xc8bdb?_0xc8bdb:_0x72ee57,'store':_0x72ee57};};function formatDate(_0x12df81){const _0x237a69=_0x27f97a;return _0x12df81[_0x237a69(0x20e)]()+'/'+(_0x12df81[_0x237a69(0x1b7)]()+0x1)[_0x237a69(0x239)]()['padStart'](0x2,'0')+'/'+_0x12df81[_0x237a69(0x22e)]()['toString']()[_0x237a69(0x1b4)](0x2,'0')+'\x20'+_0x12df81[_0x237a69(0x272)]()[_0x237a69(0x239)]()['padStart'](0x2,'0')+':'+_0x12df81[_0x237a69(0xc3)]()[_0x237a69(0x239)]()[_0x237a69(0x1b4)](0x2,'0')+':'+_0x12df81[_0x237a69(0xb2)]()[_0x237a69(0x239)]()[_0x237a69(0x1b4)](0x2,'0');}function sleep(_0x52510b){return new Promise(_0x3e2026=>setTimeout(_0x3e2026,_0x52510b));}