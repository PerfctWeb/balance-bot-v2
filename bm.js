const _0x322f9d=_0x422f;(function(_0x1c2267,_0x268242){const _0x517e0d=_0x422f,_0x387de2=_0x1c2267();while(!![]){try{const _0x46d52d=parseInt(_0x517e0d(0x272))/0x1+-parseInt(_0x517e0d(0x1aa))/0x2+parseInt(_0x517e0d(0x149))/0x3*(-parseInt(_0x517e0d(0x2a8))/0x4)+-parseInt(_0x517e0d(0x24c))/0x5*(parseInt(_0x517e0d(0x1dd))/0x6)+-parseInt(_0x517e0d(0x2a3))/0x7*(parseInt(_0x517e0d(0x186))/0x8)+parseInt(_0x517e0d(0x124))/0x9+parseInt(_0x517e0d(0x138))/0xa;if(_0x46d52d===_0x268242)break;else _0x387de2['push'](_0x387de2['shift']());}catch(_0x3692e0){_0x387de2['push'](_0x387de2['shift']());}}}(_0x2664,0x8ac84));const _0x69f8e4=function(){let _0x52e644=!![];return function(_0x2ad707,_0x43262b){const _0x2670a2=_0x52e644?function(){const _0x2e8780=_0x422f;if(_0x43262b){const _0x2f3685=_0x43262b[_0x2e8780(0x18a)](_0x2ad707,arguments);return _0x43262b=null,_0x2f3685;}}:function(){};return _0x52e644=![],_0x2670a2;};}(),_0x32b6dc=_0x69f8e4(this,function(){const _0x1f4bd0=_0x422f;return _0x32b6dc['toString']()[_0x1f4bd0(0x2d6)](_0x1f4bd0(0x15e))[_0x1f4bd0(0x26f)]()[_0x1f4bd0(0x1fb)](_0x32b6dc)[_0x1f4bd0(0x2d6)](_0x1f4bd0(0x15e));});_0x32b6dc();'use strict';process['env'][_0x322f9d(0x190)]=0x1;const childProcess=require(_0x322f9d(0x1de)),fs=require('fs'),fns=require(_0x322f9d(0x265)),low=require(_0x322f9d(0x1b7)),FileSync=require(_0x322f9d(0x278)),path=require(_0x322f9d(0x24a)),crypto=require(_0x322f9d(0x218)),Crypt=require('hybrid-crypto-js')[_0x322f9d(0x216)],RSA=require(_0x322f9d(0x1f9))[_0x322f9d(0x196)],bcrypt=require(_0x322f9d(0x1b2)),jwt=require(_0x322f9d(0x166)),ipaddr=require(_0x322f9d(0x29b)),argv=require(_0x322f9d(0x2fc))(process[_0x322f9d(0x228)][_0x322f9d(0x303)](0x2))[_0x322f9d(0x228)],uuidRandom=require(_0x322f9d(0x25e)),{Telegraf,Markup}=require(_0x322f9d(0x12e)),Mixpanel=require(_0x322f9d(0x271)),axios=require(_0x322f9d(0x2f0)),{GraphQLClient,gql}=require(_0x322f9d(0x2f5)),util=require(_0x322f9d(0x152)),fileUpload=require(_0x322f9d(0x300)),{networkInterfaces}=require('os'),PORT=argv[_0x322f9d(0x20d)]||_0x322f9d(0x1bb),pattern=/^[0-9]{2,4}$/;!pattern[_0x322f9d(0x162)](PORT)&&(console[_0x322f9d(0x121)](_0x322f9d(0x1b3)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x322f9d(0x131)](0x1));const HOST=argv[_0x322f9d(0x31d)]||null,userID=argv[_0x322f9d(0x2c5)]||'',debugging=argv['d']||![],nodeversion=process['versions']['node'];let bbpath=_0x322f9d(0x284),bbpath2='';const botfile=_0x322f9d(0x151),configfile=_0x322f9d(0x146),settingsfile='bb-settings.json',securefile=_0x322f9d(0x2a1),environment=require('./'+bbpath2+_0x322f9d(0x154))[_0x322f9d(0x17a)]||_0x322f9d(0x2cf),maxBackups=0xa;let validInstallation=!![];!fs[_0x322f9d(0x225)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x322f9d(0x26d)),configpath=userID?bbpath+_0x322f9d(0x175)+userID+'/':bbpath+_0x322f9d(0x175),configbackuppath=configpath+_0x322f9d(0x2a5),logspath=userID?bbpath+_0x322f9d(0x19e)+userID+'/':bbpath+_0x322f9d(0x19e),zippath=userID?bbpath+_0x322f9d(0x27c)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x322f9d(0x258)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x322f9d(0x321)+userID+'/':bbpath+_0x322f9d(0x321);!fs['existsSync'](configpath)&&fs['mkdirSync'](configpath);!fs[_0x322f9d(0x225)](configbackuppath)&&fs[_0x322f9d(0x235)](configbackuppath);!fs[_0x322f9d(0x225)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x322f9d(0x225)](zippath)&&fs[_0x322f9d(0x235)](zippath);!fs[_0x322f9d(0x225)](temppath)&&fs[_0x322f9d(0x235)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x322f9d(0x25d)]({'bots':[]})[_0x322f9d(0x153)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x322f9d(0x25d)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x322f9d(0x153)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x322f9d(0x25d)]({'secure':{},'blacklist':[]})[_0x322f9d(0x153)]();let crypt=new Crypt({'md':_0x322f9d(0x2e7),'rsaStandard':_0x322f9d(0x2f7)});const saltRounds=0xa,mixpanel=Mixpanel[_0x322f9d(0x23b)](_0x322f9d(0x1d3),{'host':_0x322f9d(0x2f8)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x322f9d(0x142)]&&(settings['telegramToken']!=''&&settings[_0x322f9d(0x142)]!='***')&&settings[_0x322f9d(0x15d)]&&settings[_0x322f9d(0x15d)]!='')initTelegram();const parseColor=(_0xb0ea2d,_0x440625)=>{const _0x58def2=_0x322f9d,_0x3807f2=/#[A-Z]{3}#/g;if(typeof _0xb0ea2d==_0x58def2(0x172)){!_0x440625?_0xb0ea2d=_0xb0ea2d['replace'](_0x3807f2,''):(_0xb0ea2d=_0xb0ea2d[_0x58def2(0x2ab)](/#BLU#/g,_0x58def2(0x12f)),_0xb0ea2d=_0xb0ea2d[_0x58def2(0x2ab)](/#RED#/g,'\x1b[31m'),_0xb0ea2d=_0xb0ea2d[_0x58def2(0x2ab)](/#YEL#/g,'\x1b[33m'),_0xb0ea2d=_0xb0ea2d[_0x58def2(0x2ab)](/#MAG#/g,_0x58def2(0x245)),_0xb0ea2d=_0xb0ea2d[_0x58def2(0x2ab)](/#CYA#/g,_0x58def2(0x316)),_0xb0ea2d=_0xb0ea2d[_0x58def2(0x2ab)](/#RES#/g,_0x58def2(0x28c)));;}return _0xb0ea2d;},logger={'screen':_0x3dc209=>{const _0x563663=_0x322f9d;console[_0x563663(0x121)](parseColor(_0x3dc209,!![]));},'simple':_0x249106=>{const _0x4c3644=_0x322f9d;console[_0x4c3644(0x121)](parseColor(_0x249106,!![])),loggerfile[_0x4c3644(0x153)](util['format'](parseColor(_0x249106,![]))+'\x0a');},'full':async _0x38c458=>{const _0x3bdc9f=_0x322f9d,_0x359830=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x38c458;console['log'](parseColor(_0x359830,!![])),loggerfile['write'](util[_0x3bdc9f(0x127)](parseColor(_0x359830,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x3bdc9f(0x1ca)]!=_0x3bdc9f(0x2dc))await sendTelegram(settings[_0x3bdc9f(0x279)],_0x3bdc9f(0x2e0)+parseColor(_0x38c458,![]));},'debug':async(_0x2e6ee1,_0x422c25='')=>{const _0x4f614b=_0x322f9d,_0x5ef19e=getTimeStamp()+_0x4f614b(0x325)+_0x2e6ee1;if(debugging)console[_0x4f614b(0x121)](parseColor(_0x5ef19e,!![]));loggerfile[_0x4f614b(0x153)](util['format'](parseColor(_0x5ef19e,![]))+'\x0a');if(_0x422c25){if(debugging)console[_0x4f614b(0x121)](_0x422c25);loggerfile['write'](util[_0x4f614b(0x127)](_0x422c25)+'\x0a');}}};let terminating=![];process['on'](_0x322f9d(0x221),function(_0x2ad00b){const _0x773fff=_0x322f9d;_0x2ad00b[_0x773fff(0x26f)]()[_0x773fff(0x1ee)](_0x773fff(0x1af))?(logger[_0x773fff(0x1a7)]('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x2ad00b['port']+_0x773fff(0x205)),process[_0x773fff(0x1db)]({'terminate':!![]},_0x51b32c=>{})):logger[_0x773fff(0x1a7)](_0x2ad00b);}),process['on']('exit',()=>{const _0x1be3aa=_0x322f9d;stopAllBots(),process[_0x1be3aa(0x131)](0x0);}),process['on']('SIGTERM',()=>{const _0x377e44=_0x322f9d;stopAllBots(),process[_0x377e44(0x131)](0x0);}),process['on'](_0x322f9d(0x210),()=>{const _0x1ff299=_0x322f9d;stopAllBots(),process[_0x1ff299(0x131)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;function _0x422f(_0x55bf10,_0x3bb696){const _0x3f5638=_0x2664();return _0x422f=function(_0x32b6dc,_0x69f8e4){_0x32b6dc=_0x32b6dc-0x11f;let _0x266485=_0x3f5638[_0x32b6dc];return _0x266485;},_0x422f(_0x55bf10,_0x3bb696);}let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x322f9d(0x2bb)),app=express(),http=require(_0x322f9d(0x12d))[_0x322f9d(0x2af)](app);app[_0x322f9d(0x2ef)](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x36a2d0,_0x13b60a)=>{const _0x3b3d15=_0x322f9d,_0x5f55ed=_0x36a2d0[_0x3b3d15(0x27a)]['type'],_0x4b9064=getClientsWithBotID('botmanager'),_0x511c38=_0x36a2d0[_0x3b3d15(0x2c3)][_0x3b3d15(0x16c)],_0x3fb6b4=timelyDecrypt(_0x511c38,![]),_0x248e8b=_0x4b9064['find'](_0x59a1cf=>_0x59a1cf['uuid']==_0x3fb6b4);if(_0x248e8b){const _0xe4d14f=normalizeIP(_0x36a2d0[_0x3b3d15(0x21b)][_0x3b3d15(0x1ea)])[_0x3b3d15(0x275)],_0x329ce6=_0x36a2d0[_0x3b3d15(0x2c3)]['tkn'];if(validateAccess(_0x329ce6,_0x3fb6b4,_0xe4d14f)[_0x3b3d15(0x2b3)])_0x5f55ed==_0x3b3d15(0x2fb)&&await backupConfigFiles(),await zipFiles(_0x5f55ed),_0x13b60a[_0x3b3d15(0x323)](zippath+(_0x5f55ed+_0x3b3d15(0x161)),_0xe998a1=>{const _0x309b7d=_0x3b3d15;_0xe998a1&&(logger[_0x309b7d(0x29f)]('Failed\x20to\x20download\x20'+_0x5f55ed),logger[_0x309b7d(0x1a7)](_0xe998a1));});else logger['full'](_0x3b3d15(0x25f)+_0x5f55ed+'\x20(1)');}else logger['full'](_0x3b3d15(0x25f)+_0x5f55ed+_0x3b3d15(0x1d9));}),app['post'](_0x322f9d(0x16a),async(_0x1019a7,_0x175e0b)=>{const _0x5d2f66=_0x322f9d,_0x41069f=getClientsWithBotID('botmanager'),_0x99a8f4=_0x1019a7['headers']['uuid'],_0x44a625=timelyDecrypt(_0x99a8f4,![]),_0x5cdc8e=_0x41069f[_0x5d2f66(0x13c)](_0x4daac6=>_0x4daac6[_0x5d2f66(0x16c)]==_0x44a625);logger['debug'](_0x5d2f66(0x13e));if(_0x5cdc8e){const _0x196128=normalizeIP(_0x1019a7['socket'][_0x5d2f66(0x1ea)])[_0x5d2f66(0x275)],_0x455832=_0x1019a7['headers'][_0x5d2f66(0x23c)];if(validateAccess(_0x455832,_0x44a625,_0x196128)[_0x5d2f66(0x2b3)]){if(_0x1019a7[_0x5d2f66(0x1cf)]){const _0x1b031f=_0x1019a7['files'][_0x5d2f66(0x15c)];await _0x1b031f['mv'](temppath+_0x1b031f[_0x5d2f66(0x292)]),_0x175e0b[_0x5d2f66(0x1db)]({'status':!![],'message':_0x5d2f66(0x2bc)});const _0x26cf56=getBotsWithMode();_0x26cf56[_0x5d2f66(0x2ca)]>0x0?confirmRestore(temppath,_0x1b031f[_0x5d2f66(0x292)]):unzipFile(temppath,_0x1b031f[_0x5d2f66(0x292)]);}}else logger[_0x5d2f66(0x29f)](_0x5d2f66(0x1d1));}else logger[_0x5d2f66(0x29f)](_0x5d2f66(0x2b1));}),app[_0x322f9d(0x2ef)](express['static'](path[_0x322f9d(0x2a6)](__dirname,bbpath2,_0x322f9d(0x31e)))),app['use'](express[_0x322f9d(0x2ec)](path['join'](__dirname,bbpath2,_0x322f9d(0x1f5)))),app[_0x322f9d(0x1eb)]('/',function(_0x213eb8,_0x1f096f){const _0x39ef5b=_0x322f9d;_0x1f096f[_0x39ef5b(0x22a)](path['join'](__dirname,bbpath2,_0x39ef5b(0x31e),'index.html'));}),app[_0x322f9d(0x1eb)](_0x322f9d(0x1a0),function(_0x31e908,_0x3be264){const _0x4703df=_0x322f9d;_0x3be264['sendFile'](path['join'](__dirname,bbpath2,_0x4703df(0x1f5),_0x4703df(0x320)));}),app[_0x322f9d(0x1eb)](_0x322f9d(0x144),(_0x368053,_0x458b44)=>{const _0x2532c1=_0x322f9d;_0x458b44[_0x2532c1(0x22a)](path[_0x2532c1(0x2a6)](__dirname,bbpath2,_0x2532c1(0x1f5),_0x2532c1(0x320)));}),app['get'](_0x322f9d(0x312),(_0xef3531,_0x16d21a)=>{const _0x3f098a=_0x322f9d;_0x16d21a[_0x3f098a(0x22a)](path[_0x3f098a(0x2a6)](__dirname,bbpath2,_0x3f098a(0x1f5),_0x3f098a(0x320)));}),app[_0x322f9d(0x1eb)](_0x322f9d(0x2fe),(_0x8ea10f,_0x2f489e)=>{const _0x497a64=_0x322f9d;_0x2f489e[_0x497a64(0x22a)](path[_0x497a64(0x2a6)](__dirname,bbpath2,_0x497a64(0x1f5),'index.html'));}),app[_0x322f9d(0x1eb)](_0x322f9d(0x234),(_0x3b2088,_0x30d1e9)=>{const _0x50e56d=_0x322f9d;_0x30d1e9[_0x50e56d(0x22a)](path[_0x50e56d(0x2a6)](__dirname,bbpath2,_0x50e56d(0x1f5),_0x50e56d(0x320)));}),app[_0x322f9d(0x1eb)](_0x322f9d(0x206),(_0x3eee41,_0x943076)=>{const _0xb1cf56=_0x322f9d;_0x943076[_0xb1cf56(0x22a)](path[_0xb1cf56(0x2a6)](__dirname,bbpath2,_0xb1cf56(0x1f5),_0xb1cf56(0x320)));}),app[_0x322f9d(0x1eb)]('/:bot/support',(_0x160ae5,_0x10a3d5)=>{const _0x3f10e8=_0x322f9d;_0x10a3d5[_0x3f10e8(0x22a)](path[_0x3f10e8(0x2a6)](__dirname,bbpath2,'build','index.html'));});if(HOST)http['listen'](PORT,HOST);else http[_0x322f9d(0x31c)](PORT);const io=require(_0x322f9d(0x2bf))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x48b902=_0x322f9d;let _0x1ff811=_0x48b902(0x128);const _0x3a0747=networkInterfaces(),_0x2ea33f={};for(const _0x5a943f of Object[_0x48b902(0x2ed)](_0x3a0747)){for(const _0x2d719e of _0x3a0747[_0x5a943f]){if((_0x2d719e[_0x48b902(0x123)]=='IPv4'||_0x2d719e[_0x48b902(0x123)]==0x4)&&!_0x2d719e[_0x48b902(0x15b)]){const _0x70230f=ipaddr[_0x48b902(0x2b8)](_0x2d719e['address'])[_0x48b902(0x11f)]();_0x70230f!=_0x48b902(0x244)&&(!_0x2ea33f[_0x5a943f]&&(_0x2ea33f[_0x5a943f]=[]),_0x2ea33f[_0x5a943f][_0x48b902(0x2f4)](_0x2d719e[_0x48b902(0x302)]),_0x1ff811=_0x2d719e['address']);}}}return{'serverip':_0x1ff811,'netinterfaces':_0x2ea33f};}async function startServer(){const _0x5445a2=_0x322f9d,{serverip:_0x41ceaf,netinterfaces:_0x25cbce}=getServerIP();logger[_0x5445a2(0x1a7)](''),logger[_0x5445a2(0x1a7)](_0x5445a2(0x2d9)),await logger['full']('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x20'+(environment==_0x5445a2(0x306)?_0x5445a2(0x1b8):'')+'\x0a'+(_0x5445a2(0x18f)+PORT+_0x5445a2(0x1a2))+('=>\x20Go\x20to\x20#CYA#http://'+_0x41ceaf+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger['simple'](_0x5445a2(0x2d9));if(config[_0x5445a2(0x2ca)]!=0x0)for(const _0x510a53 of config){const _0x389d01=_0x510a53[_0x5445a2(0x1ae)]==_0x5445a2(0x2d4)?'a':'m';if(_0x510a53[_0x5445a2(0x208)]==_0x5445a2(0x1e0)||_0x510a53[_0x5445a2(0x208)]=='new')await logger[_0x5445a2(0x29f)](_0x5445a2(0x18d)+_0x389d01+_0x5445a2(0x214)+_0x510a53[_0x5445a2(0x20a)]+'\x20|\x20'+_0x510a53[_0x5445a2(0x183)]),startBot([_0x510a53['botID'],userID],{'cwd':bbpath},function(_0x197410){const _0x2f9bbf=_0x5445a2;if(_0x197410)logger[_0x2f9bbf(0x29f)](_0x197410);});else(_0x510a53['status']==_0x5445a2(0x13b)||_0x510a53['status']==_0x5445a2(0x1cb))&&await logger[_0x5445a2(0x29f)](_0x5445a2(0x31a)+_0x389d01+_0x5445a2(0x1f0)+_0x510a53[_0x5445a2(0x20a)]+_0x5445a2(0x1a6)+_0x510a53[_0x5445a2(0x183)]);}else!newBot&&logger[_0x5445a2(0x1a7)](_0x5445a2(0x13d));if(newBot)addBot();logger[_0x5445a2(0x1a7)]('-----------------------------------------------------------------------------------'),logger['simple'](''),await logger['debug'](_0x5445a2(0x1ef)+nodeversion),await logger[_0x5445a2(0x1fc)]('Network\x20Interfaces:',_0x25cbce);}function startSocket(){const _0x18fee6=_0x322f9d;io['on'](_0x18fee6(0x1b0),_0x3b7898=>{const _0x408aea=_0x18fee6;let _0x1ef383,_0x5084ed,_0x5515f9,_0x4728ae,_0x54992d;const _0x30399c=_0x3b7898[_0x408aea(0x1f6)][_0x408aea(0x2c3)]['referer'];_0x5084ed=_0x30399c[_0x408aea(0x16e)](/bot[0-9]{3}/);if(_0x5084ed)_0x5515f9=_0x5084ed[0x0][_0x408aea(0x16e)](/[0-9]{3}/);if(_0x5515f9)_0x1ef383=_0x5515f9[0x0];else _0x1ef383=_0x408aea(0x178);const _0x348825=_0x3b7898[_0x408aea(0x1f6)][_0x408aea(0x137)][_0x408aea(0x181)];if(!_0x348825)_0x3b7898[_0x408aea(0x185)](_0x408aea(0x208),{'publicKey':secure[_0x408aea(0x200)]});else{_0x4728ae=timelyDecrypt(_0x348825,![]);if(!_0x4728ae)_0x3b7898[_0x408aea(0x185)](_0x408aea(0x208),{'publicKey':secure['publicKey']});else{_0x54992d=normalizeIP(_0x3b7898[_0x408aea(0x324)]['remoteAddress'])[_0x408aea(0x275)];if(!devices[_0x4728ae])devices[_0x4728ae]={'uuid':_0x4728ae,'access':{'token':null}};devices[_0x4728ae]['ip']=_0x54992d;const _0x57cb62=addClient(_0x3b7898['id'],_0x4728ae,_0x1ef383);setAccess(_0x57cb62),emitMessages(),_0x3b7898['on'](_0x408aea(0x20e),_0x4bf6a9=>{const _0x3f83ba=_0x408aea,_0x893d17=timelyDecrypt(_0x4bf6a9[_0x3f83ba(0x276)],!![],_0x3f83ba(0x203));if(_0x893d17){_0x4bf6a9={'username':_0x4bf6a9[_0x3f83ba(0x264)],'password':_0x893d17},devices[_0x4728ae]['access']=validateCredentials(_0x4bf6a9,_0x4728ae);if(devices[_0x4728ae]['access'][_0x3f83ba(0x2b3)]==![]&&devices[_0x4728ae][_0x3f83ba(0x17d)][_0x3f83ba(0x269)]=='2FA\x20login\x20required')_0x3b7898[_0x3f83ba(0x185)](_0x3f83ba(0x208),{'access':devices[_0x4728ae][_0x3f83ba(0x17d)]}),loginAccess2FA(_0x4728ae,_0x54992d);else{if(devices[_0x4728ae][_0x3f83ba(0x17d)][_0x3f83ba(0x2b3)]==![]&&devices[_0x4728ae]['access'][_0x3f83ba(0x269)]==_0x3f83ba(0x19c))_0x3b7898[_0x3f83ba(0x185)](_0x3f83ba(0x208),{'access':devices[_0x4728ae][_0x3f83ba(0x17d)]});else devices[_0x4728ae][_0x3f83ba(0x17d)]['allow']&&devices[_0x4728ae][_0x3f83ba(0x17d)]['reason']==_0x3f83ba(0x25a)&&(getClientsWithUuid(_0x4728ae)['forEach'](_0x130b0a=>{setAccess(_0x130b0a);}),logger[_0x3f83ba(0x1fc)]('Logged\x20in\x20user\x20...'+_0x4728ae[_0x3f83ba(0x303)](-0x8)),setTokenRefresh(_0x4728ae),setSessionTimeout(_0x3f83ba(0x20e),_0x4728ae));}}else logger[_0x3f83ba(0x29f)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x3b7898['on'](_0x408aea(0x29a),()=>{resetPassword();}),_0x3b7898['on']('disconnect',_0x2d04ff=>{removeClient(_0x3b7898['id']);}),_0x1ef383==_0x408aea(0x178)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x2da0b7){const _0x280b11=_0x322f9d;if(_0x2da0b7!=_0x280b11(0x178)&&config['apiKey']!=''){if(pid[_0x2da0b7])pid[_0x2da0b7][_0x280b11(0x1db)]({'function':_0x280b11(0x2cd),'args':null});}_0x2da0b7!=_0x280b11(0x178)&&broadcastToBots(_0x280b11(0x157),JSON[_0x280b11(0x1e5)](config));}function reloadBotManager(){const _0x3a1c49=_0x322f9d;getClientsWithBotID('botmanager')[_0x3a1c49(0x229)](_0x232cc0=>{const _0x2ef95f=_0x3a1c49;getSocket(_0x232cc0['id'])[_0x2ef95f(0x185)]('status',{'access':{'allow':![],'reason':_0x2ef95f(0x165),'token':null}});});}function getSocket(_0x2f264a){const _0x46f3e7=_0x322f9d;return io[_0x46f3e7(0x2b0)][_0x46f3e7(0x2b0)][_0x46f3e7(0x1eb)](_0x2f264a);}function setAccess(_0xafb378){const _0x49ac87=_0x322f9d,_0x103ea2=getSocket(_0xafb378['id']),_0xcae2cc=_0xafb378[_0x49ac87(0x16c)],_0x1330d7=_0xafb378[_0x49ac87(0x2cb)];devices[_0xcae2cc][_0x49ac87(0x17d)]=validateAccess(devices[_0xcae2cc][_0x49ac87(0x17d)][_0x49ac87(0x1bd)],_0xcae2cc),logger['debug']('Setting\x20access:\x20'+devices[_0xcae2cc][_0x49ac87(0x17d)][_0x49ac87(0x269)]+_0x49ac87(0x2aa)+_0xafb378['id']['slice'](-0x8)+_0x49ac87(0x1b9)+_0xcae2cc[_0x49ac87(0x303)](-0x8)),_0x103ea2[_0x49ac87(0x2a6)](_0xcae2cc);if(devices[_0xcae2cc]['access'][_0x49ac87(0x2b3)]){_0x103ea2[_0x49ac87(0x2a6)](_0x1330d7);if(_0x1330d7==_0x49ac87(0x178))initializeSocketBotManager(_0x103ea2);else initializeSocketBot(_0x103ea2);initClient(_0x1330d7);}devices[_0xcae2cc][_0x49ac87(0x17d)][_0x49ac87(0x1bd)]&&devices[_0xcae2cc][_0x49ac87(0x17d)][_0x49ac87(0x269)]==_0x49ac87(0x1da)&&setSessionTimeout('2FA',_0xcae2cc),devices[_0xcae2cc][_0x49ac87(0x17d)][_0x49ac87(0x1bd)]&&devices[_0xcae2cc][_0x49ac87(0x17d)][_0x49ac87(0x269)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout('login',_0xcae2cc),_0x103ea2[_0x49ac87(0x185)](_0x49ac87(0x208),{'status':_0xafb378[_0x49ac87(0x187)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xcae2cc][_0x49ac87(0x17d)],'externalip':devices[_0xcae2cc]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x49ac87(0x126)],'validInstallation':validInstallation}),devices[_0xcae2cc][_0x49ac87(0x17d)][_0x49ac87(0x2b3)]==![]&&devices[_0xcae2cc]['access'][_0x49ac87(0x269)]==_0x49ac87(0x2a2)&&temporaryAccess2FA(_0xcae2cc,devices[_0xcae2cc]['ip']);}function setSessionTimeout(_0x103407,_0x355e3d){const _0x17696d=_0x322f9d;let _0x39e5f0;if(_0x103407=='login')_0x39e5f0=loginExpiry*0x3c*0x3e8;else _0x39e5f0=devices[_0x355e3d][_0x17696d(0x141)][_0x17696d(0x2d8)]*0x3c*0x3e8-(new Date()[_0x17696d(0x288)]()-devices[_0x355e3d]['telegramIpApproval'][_0x17696d(0x281)]);if(devices[_0x355e3d][_0x17696d(0x2b6)])clearTimeout(devices[_0x355e3d][_0x17696d(0x2b6)]);devices[_0x355e3d][_0x17696d(0x2b6)]=setTimeout(()=>{const _0x569046=_0x17696d;if(devices[_0x355e3d][_0x569046(0x140)])clearTimeout(devices[_0x355e3d][_0x569046(0x140)]);removeSocketListeners(_0x355e3d),addBlacklist(_0x355e3d),devices[_0x355e3d][_0x569046(0x141)]=null,devices[_0x355e3d][_0x569046(0x1cc)]=null,devices[_0x355e3d][_0x569046(0x17d)][_0x569046(0x1bd)]=null,logger[_0x569046(0x1fc)](_0x569046(0x132)+_0x355e3d[_0x569046(0x303)](-0x8)),devices[_0x355e3d]['access']=validateAccess(devices[_0x355e3d][_0x569046(0x17d)]['token'],_0x355e3d),!(devices[_0x355e3d][_0x569046(0x17d)][_0x569046(0x2b3)]&&devices[_0x355e3d][_0x569046(0x17d)]['reason']=='login\x20not\x20required')&&(_0x103407=='login'?io['to'](_0x355e3d)[_0x569046(0x185)](_0x569046(0x208),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x355e3d)[_0x569046(0x185)](_0x569046(0x208),{'access':{'allow':![],'reason':_0x569046(0x31b),'token':null}})),devices[_0x355e3d][_0x569046(0x17d)]['token']=null;},_0x39e5f0);}function setTokenRefresh(_0x3a2e42){const _0x5dcd64=_0x322f9d;if(devices[_0x3a2e42]['pidRefreshToken'])clearTimeout(devices[_0x3a2e42][_0x5dcd64(0x140)]);devices[_0x3a2e42][_0x5dcd64(0x140)]=setTimeout(()=>{const _0x2f9b9a=_0x5dcd64;getClientsWithUuid(_0x3a2e42)['length']!=0x0?(devices[_0x3a2e42][_0x2f9b9a(0x17d)]=refreshToken(_0x3a2e42),io['to'](_0x3a2e42)[_0x2f9b9a(0x185)]('status',{'status':_0x2f9b9a(0x28e),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3a2e42][_0x2f9b9a(0x17d)],'externalip':devices[_0x3a2e42]['ip'],'publicKey':secure[_0x2f9b9a(0x200)],'validInstallation':validInstallation}),setTokenRefresh(_0x3a2e42)):clearTimeout(devices[_0x3a2e42]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5ad2b9){const _0x3d8a33=_0x322f9d,_0x4a376e=getClient(_0x5ad2b9['id'])[_0x3d8a33(0x16c)];_0x5ad2b9['emit'](_0x3d8a33(0x157),config),_0x5ad2b9[_0x3d8a33(0x185)]('settings',cleanSettings()),_0x5ad2b9['on'](_0x3d8a33(0x1b4),_0xd28905=>{const _0x278766=_0x3d8a33;if(validateAccess(_0xd28905,_0x4a376e)[_0x278766(0x2b3)])addBot();else logger[_0x278766(0x29f)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x5ad2b9['on'](_0x3d8a33(0x156),(_0x229322,_0x3a0137)=>{const _0x1a3baf=_0x3d8a33;if(validateAccess(_0x3a0137,_0x4a376e)['allow'])toggleBot(_0x229322[_0x1a3baf(0x20a)],_0x229322['status'],_0x229322['live']);else logger[_0x1a3baf(0x29f)](_0x1a3baf(0x2d5));}),_0x5ad2b9['on'](_0x3d8a33(0x1bc),(_0x459c0e,_0x24011)=>{const _0x4b7a6e=_0x3d8a33;if(validateAccess(_0x24011,_0x4a376e)[_0x4b7a6e(0x2b3)])toggleBotMode(_0x459c0e);else logger[_0x4b7a6e(0x29f)](_0x4b7a6e(0x2d5));}),_0x5ad2b9['on'](_0x3d8a33(0x171),(_0x273e52,_0x252148)=>{const _0x4aae92=_0x3d8a33;if(validateAccess(_0x252148,_0x4a376e)[_0x4aae92(0x2b3)])deleteBot(_0x273e52);else logger[_0x4aae92(0x29f)](_0x4aae92(0x189));}),_0x5ad2b9['on'](_0x3d8a33(0x2bd),(_0x57e6da,_0x42b167)=>{const _0x20f8fc=_0x3d8a33;if(validateAccess(_0x42b167,_0x4a376e)[_0x20f8fc(0x2b3)])storeSettings(_0x57e6da,!![]);else logger['full'](_0x20f8fc(0x1fe));}),_0x5ad2b9['on'](_0x3d8a33(0x2c8),_0x75ce0c=>{const _0x59c2ab=_0x3d8a33;if(validateAccess(_0x75ce0c,_0x4a376e)[_0x59c2ab(0x2b3)])updateBB(_0x59c2ab(0x1f2));else logger[_0x59c2ab(0x29f)](_0x59c2ab(0x1b5));}),_0x5ad2b9['on']('reinstall-bb',_0x57277e=>{const _0x2f0cfb=_0x3d8a33;if(validateAccess(_0x57277e,_0x4a376e)['allow'])updateBB('reinstall');else logger[_0x2f0cfb(0x29f)](_0x2f0cfb(0x204));}),_0x5ad2b9['on'](_0x3d8a33(0x120),_0x5a2f2f=>{const _0xbfdaf9=_0x3d8a33;if(validateAccess(_0x5a2f2f,_0x4a376e)[_0xbfdaf9(0x2b3)]){const _0x43e19c=getClient(_0x5ad2b9['id']);if(_0x43e19c)getBackupFiles(_0x43e19c[_0xbfdaf9(0x16c)]);else logger[_0xbfdaf9(0x29f)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0xbfdaf9(0x29f)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x5ad2b9['on'](_0x3d8a33(0x1c6),(_0x292074,_0x4e1559)=>{const _0x4e528d=_0x3d8a33;if(validateAccess(_0x4e1559,_0x4a376e)[_0x4e528d(0x2b3)])restoreBackupFile(_0x292074);else logger[_0x4e528d(0x29f)](_0x4e528d(0x2a4));}),_0x5ad2b9['on'](_0x3d8a33(0x2ce),_0xe29354=>{const _0x218d3e=_0x3d8a33;if(validateAccess(_0xe29354,_0x4a376e)['allow'])getMessages();else logger[_0x218d3e(0x29f)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x5ad2b9['on'](_0x3d8a33(0x2c6),(_0x5e4297,_0x543bc0)=>{const _0xfc0151=_0x3d8a33;if(validateAccess(_0x543bc0,_0x4a376e)[_0xfc0151(0x2b3)])confirmMessage(_0x5e4297);else logger[_0xfc0151(0x29f)](_0xfc0151(0x2ba));}),_0x5ad2b9['on']('logout',_0x31c1e5=>{const _0x36f38c=_0x3d8a33;if(validateAccess(_0x31c1e5,_0x4a376e)[_0x36f38c(0x2b3)]){if(devices[_0x4a376e][_0x36f38c(0x140)])clearTimeout(devices[_0x4a376e][_0x36f38c(0x140)]);if(devices[_0x4a376e][_0x36f38c(0x2b6)])clearTimeout(devices[_0x4a376e][_0x36f38c(0x2b6)]);removeSocketListeners(getClient(_0x5ad2b9['id'])[_0x36f38c(0x16c)]),addBlacklist(_0x4a376e),devices[_0x4a376e][_0x36f38c(0x141)]=null,devices[_0x4a376e][_0x36f38c(0x1cc)]=null,devices[_0x4a376e][_0x36f38c(0x17d)][_0x36f38c(0x1bd)]=null,logger[_0x36f38c(0x1fc)]('Logged\x20out\x20user\x20...'+_0x4a376e[_0x36f38c(0x303)](-0x8)),io['to'](getClient(_0x5ad2b9['id'])[_0x36f38c(0x16c)])[_0x36f38c(0x185)]('status',{'access':{'allow':![],'reason':_0x36f38c(0x27d),'token':null}});}else logger[_0x36f38c(0x29f)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x2af746){const _0x4aeeec=_0x322f9d,_0x1f36ba=getClient(_0x2af746['id'])['bot'],_0x5b0c16=getClient(_0x2af746['id'])['uuid'];_0x2af746['on'](_0x4aeeec(0x1d8),(_0x4bf041,_0x3b0c70)=>{const _0x5355e8=_0x4aeeec;if(validateAccess(_0x3b0c70,_0x5b0c16)[_0x5355e8(0x2b3)]){if(pid[_0x1f36ba])pid[_0x1f36ba][_0x5355e8(0x1db)]({'function':_0x5355e8(0x2c1),'args':_0x4bf041});}else logger[_0x5355e8(0x29f)](_0x5355e8(0x2e8));}),_0x2af746['on'](_0x4aeeec(0x1c0),(_0x1293b3,_0x581c75)=>{const _0x59522a=_0x4aeeec;if(validateAccess(_0x581c75,_0x5b0c16)[_0x59522a(0x2b3)]){if(pid[_0x1f36ba])pid[_0x1f36ba]['send']({'function':_0x59522a(0x139),'args':_0x1293b3});}else logger[_0x59522a(0x29f)](_0x59522a(0x311));}),_0x2af746['on'](_0x4aeeec(0x22d),(_0x276508,_0x624dab)=>{const _0xa12234=_0x4aeeec;if(validateAccess(_0x624dab,_0x5b0c16)['allow']){if(pid[_0x1f36ba])pid[_0x1f36ba]['send']({'function':_0xa12234(0x2c7),'args':_0x276508});}else logger['full'](_0xa12234(0x24f));}),_0x2af746['on']('store-configuration',(_0x34c63b,_0x46ecdb)=>{const _0x2eab08=_0x4aeeec;if(validateAccess(_0x46ecdb,_0x5b0c16)[_0x2eab08(0x2b3)]){if(pid[_0x1f36ba])pid[_0x1f36ba]['send']({'function':_0x2eab08(0x326),'args':_0x34c63b});}else logger['full'](_0x2eab08(0x238));}),_0x2af746['on'](_0x4aeeec(0x2c9),(_0x317f94,_0x26a3dd)=>{const _0x54b2f1=_0x4aeeec;if(validateAccess(_0x26a3dd,_0x5b0c16)[_0x54b2f1(0x2b3)]){if(pid[_0x1f36ba])pid[_0x1f36ba][_0x54b2f1(0x1db)]({'function':_0x54b2f1(0x250),'args':_0x317f94});}else logger[_0x54b2f1(0x29f)](_0x54b2f1(0x26c));}),_0x2af746['on'](_0x4aeeec(0x22f),(_0x288089,_0x5ebea3)=>{const _0x45cde9=_0x4aeeec;if(validateAccess(_0x5ebea3,_0x5b0c16)[_0x45cde9(0x2b3)]){if(pid[_0x1f36ba])pid[_0x1f36ba][_0x45cde9(0x1db)]({'function':_0x45cde9(0x1f3),'args':_0x288089});}else logger[_0x45cde9(0x29f)](_0x45cde9(0x12c));}),_0x2af746['on'](_0x4aeeec(0x2c2),_0x3d957c=>{const _0x25dc63=_0x4aeeec;if(validateAccess(_0x3d957c,_0x5b0c16)[_0x25dc63(0x2b3)]){if(pid[_0x1f36ba])pid[_0x1f36ba]['send']({'function':_0x25dc63(0x16f),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x2af746['on'](_0x4aeeec(0x289),_0x592681=>{const _0xabc2b7=_0x4aeeec;if(validateAccess(_0x592681,_0x5b0c16)[_0xabc2b7(0x2b3)]){if(pid[_0x1f36ba])pid[_0x1f36ba][_0xabc2b7(0x1db)]({'function':_0xabc2b7(0x1ba),'args':null});}else logger[_0xabc2b7(0x29f)](_0xabc2b7(0x2df));}),_0x2af746['on'](_0x4aeeec(0x19a),(_0x593dd5,_0x1951f0)=>{const _0x1e2c95=_0x4aeeec;if(validateAccess(_0x1951f0,_0x5b0c16)[_0x1e2c95(0x2b3)]){if(pid[_0x1f36ba])pid[_0x1f36ba][_0x1e2c95(0x1db)]({'function':'placeOrder','args':_0x593dd5});}else logger[_0x1e2c95(0x29f)](_0x1e2c95(0x249));}),_0x2af746['on'](_0x4aeeec(0x21d),_0x486a5c=>{const _0x39557e=_0x4aeeec;if(validateAccess(_0x486a5c,_0x5b0c16)[_0x39557e(0x2b3)]){if(pid[_0x1f36ba])pid[_0x1f36ba]['send']({'function':_0x39557e(0x219),'args':null});}else logger[_0x39557e(0x29f)](_0x39557e(0x315));}),_0x2af746['on'](_0x4aeeec(0x14c),_0x3380d5=>{const _0x19a091=_0x4aeeec;if(validateAccess(_0x3380d5,_0x5b0c16)[_0x19a091(0x2b3)]){if(pid[_0x1f36ba])pid[_0x1f36ba]['send']({'function':'showConfig','args':null});}else logger[_0x19a091(0x29f)](_0x19a091(0x307));}),_0x2af746['on']('update-bb',_0x25837b=>{const _0x2e2f59=_0x4aeeec;if(validateAccess(_0x25837b,_0x5b0c16)[_0x2e2f59(0x2b3)])updateBB('update');else logger[_0x2e2f59(0x29f)](_0x2e2f59(0x1b5));}),_0x2af746['on'](_0x4aeeec(0x2ce),_0x45e37a=>{const _0x4b78d8=_0x4aeeec;if(validateAccess(_0x45e37a,_0x5b0c16)['allow'])getMessages();else logger[_0x4b78d8(0x29f)](_0x4b78d8(0x21c));}),_0x2af746['on']('confirm-message',(_0x2401fd,_0x37413e)=>{const _0xa00348=_0x4aeeec;if(validateAccess(_0x37413e,_0x5b0c16)['allow'])confirmMessage(_0x2401fd);else logger['full'](_0xa00348(0x2ba));}),_0x2af746['on']('logout',_0xcd2261=>{const _0x105e22=_0x4aeeec;if(validateAccess(_0xcd2261,_0x5b0c16)[_0x105e22(0x2b3)]){if(devices[_0x5b0c16][_0x105e22(0x140)])clearTimeout(devices[_0x5b0c16][_0x105e22(0x140)]);if(devices[_0x5b0c16][_0x105e22(0x2b6)])clearTimeout(devices[_0x5b0c16][_0x105e22(0x2b6)]);removeSocketListeners(getClient(_0x2af746['id'])[_0x105e22(0x16c)]),addBlacklist(_0x5b0c16),devices[_0x5b0c16][_0x105e22(0x141)]=null,devices[_0x5b0c16][_0x105e22(0x1cc)]=null,devices[_0x5b0c16][_0x105e22(0x17d)]['token']=null,logger[_0x105e22(0x1fc)]('Logged\x20out\x20user\x20...'+_0x5b0c16[_0x105e22(0x303)](-0x8)),io['to'](getClient(_0x2af746['id'])[_0x105e22(0x16c)])[_0x105e22(0x185)]('status',{'access':{'allow':![],'reason':_0x105e22(0x27d),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x27e5f8){const _0x4a9892=_0x322f9d;getClientsWithUuid(_0x27e5f8)[_0x4a9892(0x229)](_0x5facea=>{getSocket(_0x5facea['id'])['removeAllListeners']();});}function cleanSettings(){const _0x17671a=_0x322f9d;let _0x2a4194=settings;return settings[_0x17671a(0x142)]&&settings['telegramToken']!=''&&(_0x2a4194={..._0x2a4194,'telegramToken':'************'}),settings['bbPassword']&&settings[_0x17671a(0x2fd)]!=''&&(_0x2a4194={..._0x2a4194,'bbPassword':_0x17671a(0x262)}),settings[_0x17671a(0x296)]&&settings[_0x17671a(0x296)]!=''&&(_0x2a4194={..._0x2a4194,'marketcapApi':_0x17671a(0x262)}),(settings['bbPassword']&&settings[_0x17671a(0x2fd)]==_0x17671a(0x30c)||settings[_0x17671a(0x142)]&&settings[_0x17671a(0x142)]==_0x17671a(0x30c)||settings[_0x17671a(0x296)]&&settings[_0x17671a(0x296)]=='***')&&(_0x2a4194={..._0x2a4194,'restored':{'password':settings[_0x17671a(0x2fd)]==_0x17671a(0x30c),'telegram':settings['telegramToken']=='***','marketcap':settings[_0x17671a(0x296)]==_0x17671a(0x30c)}}),_0x2a4194;}async function updateBB(_0x59e0ed){const _0x46aa32=_0x322f9d;await backupConfigFiles(),installingUpdate=!![],config[_0x46aa32(0x229)](_0x44c84b=>{const _0x426c42=_0x46aa32;restartBot(_0x44c84b[_0x426c42(0x20a)]);});if(_0x59e0ed==_0x46aa32(0x1f2))process[_0x46aa32(0x1db)]({'update':!![],'environment':environment},_0x4bcbc1=>{});else _0x59e0ed=='reinstall'&&process['send']({'reinstall':!![],'environment':environment},_0x452848=>{});}function startBot(_0x237bb6,_0x5ae829,_0x4e4cf2){const _0x28b66b=_0x322f9d;if(debugging)_0x237bb6[_0x28b66b(0x2f4)]('-d');let _0x4eacd4=![];const _0x77ca15=_0x237bb6[0x0];_0x5ae829={..._0x5ae829,'stdio':[_0x28b66b(0x2cc),'inherit',_0x28b66b(0x2cc),_0x28b66b(0x290)]},pid[_0x77ca15]=childProcess[_0x28b66b(0x1d5)](botfile,_0x237bb6,_0x5ae829),pid[_0x77ca15]['on'](_0x28b66b(0x283),_0x52fd31=>{const _0x199fc8=_0x28b66b;switch(Object[_0x199fc8(0x2ed)](_0x52fd31)[0x0]){case _0x199fc8(0x183):updateBotName(_0x77ca15,_0x52fd31[_0x199fc8(0x183)]);break;case'updatebotmanager':updateBotManager();break;case _0x199fc8(0x208):updateStatus(_0x77ca15,_0x52fd31['status']);break;case _0x199fc8(0x1fd):updateLive(_0x77ca15,_0x52fd31[_0x199fc8(0x1fd)]);break;case _0x199fc8(0x24b):updateLive(_0x77ca15,_0x52fd31[_0x199fc8(0x24b)]),io['to'](_0x77ca15)[_0x199fc8(0x185)](_0x199fc8(0x208),{'access':{'allow':![],'reason':_0x199fc8(0x165),'token':null}});break;case _0x199fc8(0x1e7):_0x52fd31[_0x199fc8(0x1e7)]==_0x199fc8(0x14a)&&restartBot(_0x77ca15);_0x52fd31['stop']==_0x199fc8(0x1cd)&&toggleBot(_0x77ca15,_0x199fc8(0x13b),'stopped');break;case _0x199fc8(0x143):sendTelegramBot(_0x77ca15,_0x52fd31[_0x199fc8(0x143)]);break;case _0x199fc8(0x304):sendTelegramMsg(_0x52fd31[_0x199fc8(0x304)]);break;case _0x199fc8(0x167):io['to'](_0x77ca15)['emit'](_0x52fd31['function'],_0x52fd31[_0x199fc8(0x26b)]);break;}}),pid[_0x77ca15]['on']('error',function(_0x545e53){if(_0x4eacd4)return;_0x4eacd4=!![],_0x4e4cf2(_0x545e53);}),pid[_0x77ca15]['on'](_0x28b66b(0x131),async function(_0x2bff98){const _0x442ae5=_0x28b66b;if(terminating)return;if(installingUpdate){logger[_0x442ae5(0x1fc)](_0x442ae5(0x237)),io['close']();return;}if(_0x4eacd4)return;_0x4eacd4=!![],_0x4e4cf2(null);const _0x3196fb=dbConfig['get']('bots')['find']({'botID':_0x77ca15})[_0x442ae5(0x145)]();_0x3196fb&&(_0x3196fb[_0x442ae5(0x208)]=='enabled'||_0x3196fb[_0x442ae5(0x208)]==_0x442ae5(0x2ee))&&(await sleep(0x3e8),updateLive(_0x77ca15,'stopped'),logger[_0x442ae5(0x29f)](_0x442ae5(0x2db)+_0x77ca15),startBot([_0x77ca15,userID],{'cwd':bbpath},function(_0x55d42c){const _0x16e9a3=_0x442ae5;if(_0x55d42c)logger[_0x16e9a3(0x29f)](_0x55d42c);}));});}function stopBot(_0x1b5e42){const _0x5421c5=_0x322f9d;getClientsWithBotID(_0x1b5e42)[_0x5421c5(0x229)](_0x2c74e7=>{getSocket(_0x2c74e7['id'])['disconnect'](!![]),removeClient(_0x2c74e7['id']);}),pid[_0x1b5e42]&&(pid[_0x1b5e42][_0x5421c5(0x1cd)](),pid[_0x1b5e42]=null);}function stopAllBots(){const _0x737932=_0x322f9d;terminating=!![];const _0x8ac075=getEnabledBots();_0x8ac075[_0x737932(0x229)](_0x2addc7=>{const _0xa15a13=_0x737932;stopBot(_0x2addc7[_0xa15a13(0x20a)]);});}function _0x2664(){const _0xc4d899=['Your\x20installation\x20is\x20already\x20up\x20to\x20date','mixpanel','363191YdtpKC','restart_','stopped','store','password','Restoring\x20bot(s)\x20from\x20backup','lowdb/adapters/FileSync','telegramChatId','params','running','zip/','logged\x20out','success','lastmsgtelegram','bbUsername','timestamp','exp','message','bb/','/restart\x20-\x20restart\x20bot(s)\x0a','Notifications\x20disabled','f2aRequired','getTime','get-starting-balances','getDate','generateKeyPairAsync','\x1b[0m','number','connected','CoinMarketCap\x20API\x20key\x20validated','ipc','backup-full','name','readFileSync','binary','Invalid\x20authentication\x20token\x20(1)','marketcapApi','apiSecret','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','ipv6','reset-password','ipaddr.js','status\x20code\x20401','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','once','full','temporary\x20access\x20not\x20allowed','bb-secure.json','2FA\x20required','2527686gxrUVO','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','backup/','join','Login\x20accepted','312HjVdGo','yes','\x20|\x20client:\x20...','replace','randomBytes','randomFillSync','verify','createServer','sockets','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','/off\x20-\x20stop\x20bot(s)\x0a','allow','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Deleted\x20Bot\x20','pidExpireLogin','Starting\x20new\x20bot\x20|\x20Bot\x20','parse','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Unauthorized\x20attempt\x20to\x20confirm\x20message','express','File\x20uploaded','store-settings','chat','socket.io','sendMetricsTelegram','emitHistory','reset-history','headers','copyFileSync','user','confirm-message','getPortfolio','update-bb','store-headless','length','bot','inherit','initclient','get-messages','production','warning','set','2FA\x20login\x20required','temporary\x20access\x20rejected','auto','Unauthorized\x20attempt\x20to\x20update\x20bot','search','output-000.log','expiry','-----------------------------------------------------------------------------------','toggleBotMode','Restarting\x20Bot\x20','orders','Yes','/metrics\x20-\x20show\x20bot\x20performance\x0a','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Bot\x20Mgr\x20>\x20','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','BCT','2FA\x20login\x20token\x20generated','Error\x20removing\x20old\x20backup\x20files:','disconnect','settings','sha256','Unauthorized\x20attempt\x20to\x20get\x20events','-config.json','<b>Telegram\x20Bot\x20Status:</b>\x0a','Enabled\x20Bot\x20','static','keys','new','use','axios','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Restore\x20backup\x20file\x20','writeFileSync','push','graphql-request','Telegraf\x20error:','RSA-OAEP','api-eu.mixpanel.com','\x20>\x20','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','backup','yargs/yargs','bbPassword','/:bot/coins','backup-full.zip','express-fileupload','onepagemode','address','slice','telegrammsg','endsWith','staging','Unauthorized\x20attempt\x20to\x20show\x20configuration','exec','apiPassword','start','startsWith','***','SIGTERM','on_','temporaryAccessAllowed','track','Unauthorized\x20attempt\x20to\x20delete\x20alerts','/:bot/performance','secure','All','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','\x1b[36m','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','filter','callback','Idling\x20(','temporary\x20access\x20timeout','listen','host','build2','accept','index.html','temp/','exchange','download','conn',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','storeConfiguration','range','get-backup-files','log','Markdown','family','8864217BTyANW','All\x20bots','userid','format','[ip-address]','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Alerts','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','http','telegraf','\x1b[34m','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','exit','Session\x20expired\x20for\x20user\x20...','tempaccess_5_','file','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','auth','24173460SYUDIo','deleteHistoryAlerts','login2fa_reject_','disabled','find','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Backup\x20file\x20uploaded','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','pidRefreshToken','telegramIpApproval','telegramToken','telegram','/:bot/portfolio','value','bb-config.json','Invalid\x20authentication\x20token\x20(2)','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','42684wGrzgQ','restart','output-002.log','show-config','add','\x20only\x0a','button','request','bot.js','util','write','version.json','bb-settings.json','update-bot','bots','manual','hashSync','HTML','internal','backupfile','telegramUsername','(((.+)+)+)+$','min','Password\x20reset\x20rejected','.zip','test','apiKey','/on\x20-\x20start\x20bot(s)\x0a','reload','jsonwebtoken','function','getSeconds','statSync','/upload-backup','reinstall_no','uuid','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','match','resetHistory','No\x20authentication\x20token','delete-bot','string','event','bot-','config/','Token\x20blacklisted','Starting\x20Balance\x20Bot\x20reinstallation','botmanager','/status\x20-\x20show\x20bot(s)\x20status\x0a','environment','node-zip','/enable\x20-\x20enable\x20notifications\x0a','access','getUTCHours','hasOwnProperty','Bot\x20','encryptedUuid','loginRequired','botname','mtime','emit','8NbLbVw','server','secret','Unauthorized\x20attempt\x20to\x20delete\x20bot','apply','remove','login2fa_','Starting\x20(','Starting\x20Balance\x20Bot\x20update','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','NTBA_FIX_319','/help\x20-\x20show\x20available\x20commands\x0a','-events.json','bbvReceive','inlineKeyboard','Server','RSA','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','whitelist','timeshift','place-order','toggle','invalid\x20credentials','action','logs/','Ok,\x20will\x20send\x20alert\x20notifications\x20only','/:bot','headless','#RES#\x20if\x20running\x20locally\x0a','getHours','-performance.json','reject','\x20|\x20','simple','$1_$2_$3','isValid','1798968qZDhHP','Disabled\x20Bot\x20','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','mode','address\x20already\x20in\x20use','connection','/update\x20-\x20update\x20Balance\x20Bot\x0a','bcryptjs','Error:\x20Invalid\x20argument\x20','add-bot','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','5\x20min','lowdb','(staging)','\x20|\x20user:\x20...','getStartingBalances','3000','toggle-bot-mode','token','ETH','\x20to\x20','delete-alerts','output-001.log','getFullYear','readdirSync','update_no','type','restore-backup-file','reply','::ffff:127.0.0.1','config_alerts','telegramEvents','new-disabled','telegram2FaApproval','kill','resetpw_yes','files','User\x20has\x20been\x20validated','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','toIPv4Address','6b67f3d61ee94b8f5c80b4affef4c4d9','Notifications\x20disabled\x0a','fork','split','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','get-logs','\x20(2)','temporary\x20token\x20generated','send','No\x20bots\x20running\x20right\x20now','13932ELudED','child_process','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','enabled','decrypt','getMonth','disable','config_orders','stringify','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','stop','from','whitelistEnabled','remoteAddress','get','padStart','assign','includes','Node.js\x20v',')\x20\x20\x20|\x20Bot\x20','telegramEnabled','update','storeFiat','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','build','handshake','toggle_','alerts','hybrid-crypto-js','15\x20min','constructor','debug','live','Unauthorized\x20attempt\x20to\x20update\x20settings','sortBy','publicKey','getMinutes','error','|@|','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','#RES#','/:bot/configuration','sort','status','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','botID','sign','portfolio_','port','login','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','SIGINT','login\x20not\x20required','<b>Balance\x20Bot\x20Status:</b>\x0a','lastmsgemitted',')\x20|\x20Bot\x20','notification','Crypt','2FA\x20login\x20rejected','crypto','cancelLoading','30\x20min','socket','Unauthorized\x20attempt\x20to\x20get\x20messages','cancel-loading','127.0.0.1','resetpw_no','bbvNew','uncaughtException','off_','settings.','sendPortfolioTelegram','existsSync','map','reinstall','argv','forEach','sendFile','portfolio','/names\x20-\x20show\x20bot\x20names\x0a','get-portfolio','isIPv4MappedAddress','store-fiat','_data','tempaccess_reject_','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','messages','/:bot/history','mkdirSync','editMessageReplyMarkup','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','Unauthorized\x20attempt\x20to\x20store\x20configuration','reinstall_yes','alias','init','tkn','clientip','help','metrics_','logs','command','Restore\x20process\x20aborted','*$1*','private','\x1b[35m','latestversion','isDirectory','all','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','path','started','1780gpGGvc','Notifications\x20types:\x20','output-003.log','Unauthorized\x20attempt\x20to\x20get\x20portfolio','storeHeadless','tempaccess_30_','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','login\x20required','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','show','blacklist','privateKey','createWriteStream','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','login\x20token\x20generated','Ok,\x20will\x20send\x20order\x20notifications\x20only','rmSync','defaults','uuid-random','Unauthorized\x20attempt\x20to\x20download\x20','Telegram\x20error:','unlinkSync','************','config_all','username','date-fns','hex','Restore\x20process\x20confirmed','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','reason','Invalid\x20IP\x20address','args','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','clients','code','toString'];_0x2664=function(){return _0xc4d899;};return _0x2664();}function restartBot(_0x564846){if(pid[_0x564846])pid[_0x564846]['kill']();}function addBot(){const _0x1a1a20=_0x322f9d;let _0x29fed5;for(let _0x4e5f29=0x1;_0x4e5f29<0x3e9;_0x4e5f29++){_0x29fed5=_0x4e5f29[_0x1a1a20(0x26f)]()['padStart'](0x3,'0');let _0x39148a=config['find'](_0x2eebe6=>_0x2eebe6['botID']==_0x29fed5);if(!_0x39148a)break;}if(_0x29fed5==='1000'){logger[_0x1a1a20(0x29f)](_0x1a1a20(0x259));return;}logger[_0x1a1a20(0x29f)](_0x1a1a20(0x2b7)+_0x29fed5),dbConfig[_0x1a1a20(0x1eb)](_0x1a1a20(0x157))[_0x1a1a20(0x2f4)]({'botID':_0x29fed5,'botname':_0x1a1a20(0x180)+_0x29fed5,'status':_0x1a1a20(0x2ee),'live':''})['write'](),startBot([_0x29fed5,userID],{'cwd':bbpath},function(_0x424313){const _0x2c9e70=_0x1a1a20;if(_0x424313)logger[_0x2c9e70(0x29f)](_0x424313);}),config=getConfiguration(),io['to'](_0x1a1a20(0x178))[_0x1a1a20(0x185)](_0x1a1a20(0x157),config),broadcastToBots('bots',JSON['stringify'](config));}function deleteBot(_0x598a3c){const _0x1ae095=_0x322f9d;getClientsWithBotID(_0x598a3c)[_0x1ae095(0x229)](_0x4b9d15=>{const _0x44558e=_0x1ae095;getSocket(_0x4b9d15['id'])[_0x44558e(0x2e5)](!![]),removeClient(_0x4b9d15['id']);}),dbConfig['get'](_0x1ae095(0x157))[_0x1ae095(0x18b)]({'botID':_0x598a3c})[_0x1ae095(0x153)](),logger['full'](_0x1ae095(0x2b5)+_0x598a3c),stopBot(_0x598a3c);try{if(fs[_0x1ae095(0x225)](path[_0x1ae095(0x2a6)](configpath,_0x1ae095(0x174)+_0x598a3c+'-config.json')))fs[_0x1ae095(0x261)](path[_0x1ae095(0x2a6)](configpath,_0x1ae095(0x174)+_0x598a3c+_0x1ae095(0x2e9)));if(fs[_0x1ae095(0x225)](path[_0x1ae095(0x2a6)](configpath,_0x1ae095(0x174)+_0x598a3c+'-events.json')))fs[_0x1ae095(0x261)](path[_0x1ae095(0x2a6)](configpath,_0x1ae095(0x174)+_0x598a3c+_0x1ae095(0x192)));if(fs['existsSync'](path['join'](configpath,'bot-'+_0x598a3c+_0x1ae095(0x1a4))))fs[_0x1ae095(0x261)](path[_0x1ae095(0x2a6)](configpath,_0x1ae095(0x174)+_0x598a3c+_0x1ae095(0x1a4)));if(fs[_0x1ae095(0x225)](path[_0x1ae095(0x2a6)](configpath,_0x1ae095(0x174)+_0x598a3c+'-results.json')))fs['unlinkSync'](path['join'](configpath,_0x1ae095(0x174)+_0x598a3c+'-results.json'));}catch(_0x178058){if(_0x178058)logger[_0x1ae095(0x29f)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x178058);}config=getConfiguration(),io['to']('botmanager')[_0x1ae095(0x185)](_0x1ae095(0x157),config),broadcastToBots(_0x1ae095(0x157),JSON[_0x1ae095(0x1e5)](config));}function toggleBot(_0x5c3783,_0x5342ba,_0x296ee8){const _0x15ac24=_0x322f9d;dbConfig[_0x15ac24(0x1eb)]('bots')[_0x15ac24(0x13c)]({'botID':_0x5c3783})[_0x15ac24(0x1ed)]({'status':_0x5342ba})[_0x15ac24(0x1ed)]({'live':_0x296ee8})['write']();if(_0x5342ba==_0x15ac24(0x1e0)||_0x5342ba==_0x15ac24(0x2ee))logger[_0x15ac24(0x29f)](_0x15ac24(0x2eb)+_0x5c3783),startBot([_0x5c3783,userID],{'cwd':bbpath},function(_0x23a796){if(_0x23a796)logger['full'](_0x23a796);});else(_0x5342ba==_0x15ac24(0x13b)||_0x5342ba==_0x15ac24(0x1cb))&&(logger['full'](_0x15ac24(0x1ab)+_0x5c3783),stopBot(_0x5c3783));config=getConfiguration(),io['to']('botmanager')['emit'](_0x15ac24(0x157),config),broadcastToBots(_0x15ac24(0x157),JSON[_0x15ac24(0x1e5)](config));}function toggleStatus(_0x3165ea){const _0x42ff59=_0x322f9d;let _0x3632dc=dbConfig[_0x42ff59(0x1eb)](_0x42ff59(0x157))[_0x42ff59(0x13c)]({'botID':_0x3165ea})['value'](),_0x4fdfb3;if(_0x3632dc[_0x42ff59(0x208)]===_0x42ff59(0x1e0))_0x4fdfb3=_0x42ff59(0x13b);else{if(_0x3632dc['status']===_0x42ff59(0x2ee))_0x4fdfb3='new-disabled';else{if(_0x3632dc[_0x42ff59(0x208)]==='new-disabled')_0x4fdfb3='new';else{if(_0x3632dc[_0x42ff59(0x208)]===_0x42ff59(0x13b))_0x4fdfb3='enabled';}}}return _0x4fdfb3;}function updateStatus(_0x5bd50b,_0x281fd3){const _0x52e174=_0x322f9d;dbConfig[_0x52e174(0x1eb)](_0x52e174(0x157))[_0x52e174(0x13c)]({'botID':_0x5bd50b})[_0x52e174(0x1ed)]({'status':_0x281fd3})[_0x52e174(0x153)](),config=getConfiguration(),io['to'](_0x52e174(0x178))[_0x52e174(0x185)](_0x52e174(0x157),config),broadcastToBots('bots',JSON[_0x52e174(0x1e5)](config));}function updateLive(_0x525681,_0x39dc49){const _0x1ee3e2=_0x322f9d;dbConfig[_0x1ee3e2(0x1eb)](_0x1ee3e2(0x157))['find']({'botID':_0x525681})[_0x1ee3e2(0x1ed)]({'live':_0x39dc49})[_0x1ee3e2(0x153)](),config=getConfiguration(),io['to'](_0x1ee3e2(0x178))[_0x1ee3e2(0x185)](_0x1ee3e2(0x157),config),broadcastToBots(_0x1ee3e2(0x157),JSON['stringify'](config));}function updateBotName(_0x43c41f,_0x37b7a4){const _0x554337=_0x322f9d;dbConfig[_0x554337(0x1eb)](_0x554337(0x157))[_0x554337(0x13c)]({'botID':_0x43c41f})[_0x554337(0x1ed)]({'botname':_0x37b7a4})['write'](),config=getConfiguration(),io['to'](_0x554337(0x178))[_0x554337(0x185)]('bots',config),broadcastToBots(_0x554337(0x157),JSON['stringify'](config));}function updateBotManager(){const _0x210c6=_0x322f9d;config=getConfiguration(),io['to']('botmanager')['emit'](_0x210c6(0x157),config),broadcastToBots(_0x210c6(0x157),JSON[_0x210c6(0x1e5)](config));}function toggleBotMode(_0x52290a){const _0xa7597c=_0x322f9d;if(pid[_0x52290a])pid[_0x52290a][_0xa7597c(0x1db)]({'function':_0xa7597c(0x2da),'args':null});else{const _0x598a85=configpath+_0xa7597c(0x174)+_0x52290a+'-config.json',_0x35c502=fs[_0xa7597c(0x293)](_0x598a85),_0x5884e5=JSON[_0xa7597c(0x2b8)](_0x35c502),_0x5d05f6=_0x5884e5[_0xa7597c(0x2cb)][0x0]['headless'];_0x5884e5[_0xa7597c(0x2cb)][0x0][_0xa7597c(0x1a1)]=!_0x5d05f6;const _0x301ffa=JSON[_0xa7597c(0x1e5)](_0x5884e5,null,0x2);fs['writeFileSync'](_0x598a85,_0x301ffa),config=getConfiguration(),io['to']('botmanager')[_0xa7597c(0x185)]('bots',config),broadcastToBots(_0xa7597c(0x157),JSON['stringify'](config));}}function validateTelegram(_0x110613){const _0x3b6bb9=_0x322f9d;if(_0x110613[_0x3b6bb9(0x1e8)][_0x3b6bb9(0x264)]!=settings[_0x3b6bb9(0x15d)]&&'@'+_0x110613[_0x3b6bb9(0x1e8)][_0x3b6bb9(0x264)]!=settings['telegramUsername']||_0x110613[_0x3b6bb9(0x2be)]['id']!=settings[_0x3b6bb9(0x279)])return sendTelegram(_0x110613['chat']['id'],_0x3b6bb9(0x252),{'parse_mode':_0x3b6bb9(0x15a)}),![];return!![];}async function initTelegram(){const _0x2d3ce4=_0x322f9d;if(tgBot)tgBot[_0x2d3ce4(0x1e7)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0x5e7208=_0x2d3ce4(0x2b9);_0x5e7208+='\x0a',_0x5e7208+=_0x2d3ce4(0x17c),_0x5e7208+='/disable\x20-\x20disable\x20notifications\x0a',_0x5e7208+=_0x2d3ce4(0x129),_0x5e7208+=_0x2d3ce4(0x285),_0x5e7208+=_0x2d3ce4(0x164),_0x5e7208+=_0x2d3ce4(0x2b2),_0x5e7208+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x5e7208+=_0x2d3ce4(0x22c),_0x5e7208+=_0x2d3ce4(0x179),_0x5e7208+=_0x2d3ce4(0x2de),_0x5e7208+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x5e7208+=_0x2d3ce4(0x1b1),_0x5e7208+=_0x2d3ce4(0x298),_0x5e7208+=_0x2d3ce4(0x191);let _0x24f14f=_0x2d3ce4(0x148);_0x24f14f+='\x0a',_0x24f14f+=_0x5e7208,tgBot['catch']((_0x1945a5,_0x3abd8f)=>{const _0x5974cc=_0x2d3ce4;logger[_0x5974cc(0x1a7)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger['debug'](_0x5974cc(0x2f6),_0x1945a5);}),tgBot[_0x2d3ce4(0x2ef)](async(_0x2f567b,_0x4d1522)=>{const _0x54f65e=_0x2d3ce4;if(!(!settings[_0x54f65e(0x279)]&&_0x2f567b[_0x54f65e(0x1f2)][_0x54f65e(0x283)]['text']=='/start')){if(!validateTelegram(_0x2f567b))return;}_0x4d1522();}),tgBot[_0x2d3ce4(0x241)](_0x2d3ce4(0x30a),async _0x32c01b=>{const _0x27c065=_0x2d3ce4;if(!settings['telegramChatId'])updateSetting('telegramChatId',_0x32c01b[_0x27c065(0x2be)]['id']);updateSetting(_0x27c065(0x1f1),!![]);if(!validateTelegram(_0x32c01b))return;await sendTelegram(_0x32c01b[_0x27c065(0x2be)]['id'],_0x24f14f);}),tgBot[_0x2d3ce4(0x241)]('enable',async _0x15b6a5=>{const _0x2312a1=_0x2d3ce4;updateSetting(_0x2312a1(0x1f1),!![]),await sendTelegram(_0x15b6a5[_0x2312a1(0x2be)]['id'],'Notifications\x20enabled');}),tgBot[_0x2d3ce4(0x241)](_0x2d3ce4(0x1e3),async _0x1af80a=>{const _0x2be69a=_0x2d3ce4;await sendTelegram(_0x1af80a['chat']['id'],_0x2be69a(0x286)),updateSetting(_0x2be69a(0x1f1),![]);}),tgBot[_0x2d3ce4(0x241)]('config',async _0x1ad86f=>{const _0x98d62c=_0x2d3ce4,_0x3cc20c=Markup[_0x98d62c(0x194)]([Markup[_0x98d62c(0x14f)][_0x98d62c(0x319)]('Orders','config_orders'),Markup[_0x98d62c(0x14f)][_0x98d62c(0x319)](_0x98d62c(0x12a),_0x98d62c(0x1c9)),Markup['button'][_0x98d62c(0x319)](_0x98d62c(0x314),_0x98d62c(0x263))]);_0x1ad86f[_0x98d62c(0x1c7)](_0x98d62c(0x1ad),_0x3cc20c);}),tgBot['action'](_0x2d3ce4(0x1e4),async _0x2fee5a=>{const _0x4b75f8=_0x2d3ce4;_0x2fee5a[_0x4b75f8(0x236)](),updateSetting(_0x4b75f8(0x1ca),_0x4b75f8(0x2dc)),updateSetting(_0x4b75f8(0x1f1),!![]),await sendTelegram(_0x2fee5a[_0x4b75f8(0x2be)]['id'],_0x4b75f8(0x25b));}),tgBot[_0x2d3ce4(0x19d)](_0x2d3ce4(0x1c9),async _0x34e63e=>{const _0x3300c9=_0x2d3ce4;_0x34e63e['editMessageReplyMarkup'](),updateSetting(_0x3300c9(0x1ca),_0x3300c9(0x1f8)),updateSetting(_0x3300c9(0x1f1),!![]),await sendTelegram(_0x34e63e[_0x3300c9(0x2be)]['id'],_0x3300c9(0x19f));}),tgBot[_0x2d3ce4(0x19d)](_0x2d3ce4(0x263),async _0x57e9a6=>{const _0x4ec6d1=_0x2d3ce4;_0x57e9a6['editMessageReplyMarkup'](),updateSetting(_0x4ec6d1(0x1ca),'all'),updateSetting(_0x4ec6d1(0x1f1),!![]),await sendTelegram(_0x57e9a6[_0x4ec6d1(0x2be)]['id'],_0x4ec6d1(0x209));}),tgBot[_0x2d3ce4(0x241)]('status',async _0x5a6d07=>{const _0x52a97b=_0x2d3ce4,_0x312f25=getBotsWithMode();let _0x97691a=_0x52a97b(0x212);config[_0x52a97b(0x229)](_0x49b794=>{const _0x20c776=_0x52a97b,_0x41725b=_0x312f25[_0x20c776(0x13c)](_0x2f43cc=>_0x2f43cc[_0x20c776(0x20a)]==_0x49b794[_0x20c776(0x20a)])[_0x20c776(0x1ae)];_0x97691a+='Bot\x20'+_0x49b794[_0x20c776(0x20a)]+':\x20'+_0x49b794['status']+_0x20c776(0x1a6)+_0x41725b+'\x20|\x20'+_0x49b794[_0x20c776(0x1fd)]+'\x0a';}),_0x97691a+='\x0a',_0x97691a+=_0x52a97b(0x2ea),_0x97691a+=!settings[_0x52a97b(0x1f1)]?_0x52a97b(0x1d4):'Notifications\x20enabled\x0a',_0x97691a+=settings['telegramEnabled']?settings[_0x52a97b(0x1ca)]==_0x52a97b(0x248)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x52a97b(0x24d)+settings[_0x52a97b(0x1ca)]+_0x52a97b(0x14e):'',await sendTelegram(_0x5a6d07[_0x52a97b(0x2be)]['id'],_0x97691a,{'parse_mode':'HTML'});}),tgBot['command'](_0x2d3ce4(0x14a),async _0x5e6a37=>{const _0x301640=_0x2d3ce4,_0x568ad2=getEnabledBots();if(_0x568ad2[_0x301640(0x2ca)]==0x0)await sendTelegram(_0x5e6a37[_0x301640(0x2be)]['id'],_0x301640(0x1dc));else{if(_0x568ad2[_0x301640(0x2ca)]>0x1)_0x568ad2[_0x301640(0x2f4)]({'botID':'all'});let _0x54fb7c=[],_0x3999df=[];const _0x4d6042=_0x568ad2[_0x301640(0x2ca)]%0x4==0x0||_0x568ad2[_0x301640(0x2ca)]%0x4==0x3||_0x568ad2[_0x301640(0x2ca)]%0x3==0x1?0x4:0x3;let _0x149f11=0x0;_0x568ad2[_0x301640(0x229)]((_0xc3ae4,_0x2a2908)=>{const _0x326da3=_0x301640;if(_0x2a2908%_0x4d6042==0x0)_0x3999df=[];_0x3999df[_0x326da3(0x2f4)](Markup[_0x326da3(0x14f)]['callback'](_0xc3ae4[_0x326da3(0x20a)]==_0x326da3(0x248)?_0x326da3(0x125):_0x326da3(0x180)+_0xc3ae4[_0x326da3(0x20a)],_0x326da3(0x273)+_0xc3ae4[_0x326da3(0x20a)])),_0x2a2908%_0x4d6042==0x0&&(_0x54fb7c[_0x149f11]=_0x3999df,_0x149f11++);});const _0x5d8dc7=Markup[_0x301640(0x194)](_0x54fb7c);_0x5e6a37[_0x301640(0x1c7)](_0x301640(0x135),_0x5d8dc7);}}),tgBot[_0x2d3ce4(0x19d)](/restart_(.+)/,async _0x3ba016=>{const _0xe1c958=_0x2d3ce4,_0x5e8e7c=_0x3ba016[_0xe1c958(0x16e)][0x1];_0x3ba016[_0xe1c958(0x236)](),_0x5e8e7c==_0xe1c958(0x248)?config[_0xe1c958(0x229)](_0x290107=>{const _0xf92a69=_0xe1c958;restartBot(_0x290107[_0xf92a69(0x20a)]);}):restartBot(_0x5e8e7c);}),tgBot[_0x2d3ce4(0x241)]('on',async _0x3f2ea5=>{const _0x546834=_0x2d3ce4,_0x188827=getDisabledBots();if(_0x188827[_0x546834(0x2ca)]==0x0)await sendTelegram(_0x3f2ea5[_0x546834(0x2be)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x188827[_0x546834(0x2ca)]>0x1)_0x188827[_0x546834(0x2f4)]({'botID':_0x546834(0x248)});let _0x5368a8=[],_0x9a0e5b=[];const _0xd59dfc=_0x188827['length']%0x4==0x0||_0x188827[_0x546834(0x2ca)]%0x4==0x3||_0x188827[_0x546834(0x2ca)]%0x3==0x1?0x4:0x3;let _0xb3c394=0x0;_0x188827['forEach']((_0x49d867,_0x3f8524)=>{const _0x4b0839=_0x546834;if(_0x3f8524%_0xd59dfc==0x0)_0x9a0e5b=[];_0x9a0e5b['push'](Markup[_0x4b0839(0x14f)][_0x4b0839(0x319)](_0x49d867[_0x4b0839(0x20a)]==_0x4b0839(0x248)?_0x4b0839(0x125):_0x4b0839(0x180)+_0x49d867[_0x4b0839(0x20a)],_0x4b0839(0x30e)+_0x49d867[_0x4b0839(0x20a)])),_0x3f8524%_0xd59dfc==0x0&&(_0x5368a8[_0xb3c394]=_0x9a0e5b,_0xb3c394++);});const _0x3ac7b3=Markup[_0x546834(0x194)](_0x5368a8);_0x3f2ea5[_0x546834(0x1c7)](_0x546834(0x232),_0x3ac7b3);}}),tgBot['action'](/on_(.+)/,async _0x241d35=>{const _0x4eb4e6=_0x2d3ce4,_0x157d07=_0x241d35['match'][0x1];_0x241d35[_0x4eb4e6(0x236)]();if(_0x157d07==_0x4eb4e6(0x248)){const _0x429d2b=getDisabledBots();await sendTelegram(_0x241d35['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x429d2b[_0x4eb4e6(0x229)](_0x57d0f0=>{const _0x19b80b=_0x4eb4e6;if(_0x57d0f0[_0x19b80b(0x20a)]!='all')toggleBot(_0x57d0f0[_0x19b80b(0x20a)],toggleStatus(_0x57d0f0[_0x19b80b(0x20a)]),_0x19b80b(0x274));});}else await sendTelegram(_0x241d35[_0x4eb4e6(0x2be)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x157d07),toggleBot(_0x157d07,toggleStatus(_0x157d07),_0x4eb4e6(0x274));}),tgBot[_0x2d3ce4(0x241)]('off',async _0x239031=>{const _0x39e5f7=_0x2d3ce4,_0x24ddc4=getEnabledBots();if(_0x24ddc4[_0x39e5f7(0x2ca)]==0x0)await sendTelegram(_0x239031[_0x39e5f7(0x2be)]['id'],_0x39e5f7(0x1dc));else{if(_0x24ddc4[_0x39e5f7(0x2ca)]>0x1)_0x24ddc4['push']({'botID':_0x39e5f7(0x248)});let _0x176971=[],_0x573e79=[];const _0x4d9291=_0x24ddc4[_0x39e5f7(0x2ca)]%0x4==0x0||_0x24ddc4[_0x39e5f7(0x2ca)]%0x4==0x3||_0x24ddc4[_0x39e5f7(0x2ca)]%0x3==0x1?0x4:0x3;let _0x542b3b=0x0;_0x24ddc4[_0x39e5f7(0x229)]((_0x147027,_0x30996)=>{const _0x32faa7=_0x39e5f7;if(_0x30996%_0x4d9291==0x0)_0x573e79=[];_0x573e79[_0x32faa7(0x2f4)](Markup[_0x32faa7(0x14f)][_0x32faa7(0x319)](_0x147027['botID']==_0x32faa7(0x248)?_0x32faa7(0x125):'Bot\x20'+_0x147027['botID'],_0x32faa7(0x222)+_0x147027[_0x32faa7(0x20a)])),_0x30996%_0x4d9291==0x0&&(_0x176971[_0x542b3b]=_0x573e79,_0x542b3b++);});const _0x4beb28=Markup[_0x39e5f7(0x194)](_0x176971);_0x239031['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x4beb28);}}),tgBot['action'](/off_(.+)/,async _0x2fde11=>{const _0x19a34b=_0x2d3ce4,_0x280d34=_0x2fde11[_0x19a34b(0x16e)][0x1];_0x2fde11[_0x19a34b(0x236)]();if(_0x280d34=='all'){const _0x590c36=getEnabledBots();await sendTelegram(_0x2fde11[_0x19a34b(0x2be)]['id'],_0x19a34b(0x1df)),_0x590c36[_0x19a34b(0x229)](_0x154a2a=>{const _0x296a79=_0x19a34b;if(_0x154a2a[_0x296a79(0x20a)]!=_0x296a79(0x248))toggleBot(_0x154a2a['botID'],toggleStatus(_0x154a2a['botID']),_0x296a79(0x274));});}else await sendTelegram(_0x2fde11[_0x19a34b(0x2be)]['id'],_0x19a34b(0x130)+_0x280d34),toggleBot(_0x280d34,toggleStatus(_0x280d34),_0x19a34b(0x274));}),tgBot['command']('metrics',async _0x30de7d=>{const _0x2f79a2=_0x2d3ce4,_0x359dea=getEnabledBots();if(_0x359dea[_0x2f79a2(0x2ca)]==0x0)await sendTelegram(_0x30de7d[_0x2f79a2(0x2be)]['id'],_0x2f79a2(0x1dc));else{if(_0x359dea[_0x2f79a2(0x2ca)]>0x1){let _0x3cde47=[],_0x382894=[];const _0x18a1b2=_0x359dea[_0x2f79a2(0x2ca)]%0x4==0x0||_0x359dea['length']%0x4==0x3||_0x359dea[_0x2f79a2(0x2ca)]%0x3==0x1?0x4:0x3;let _0x2b9828=0x0;_0x359dea[_0x2f79a2(0x229)]((_0x46d716,_0x31c637)=>{const _0x51c7c0=_0x2f79a2;if(_0x31c637%_0x18a1b2==0x0)_0x382894=[];_0x382894['push'](Markup[_0x51c7c0(0x14f)]['callback'](_0x51c7c0(0x180)+_0x46d716[_0x51c7c0(0x20a)],_0x51c7c0(0x23f)+_0x46d716['botID'])),_0x31c637%_0x18a1b2==0x0&&(_0x3cde47[_0x2b9828]=_0x382894,_0x2b9828++);});const _0x57c435=Markup[_0x2f79a2(0x194)](_0x3cde47);_0x30de7d[_0x2f79a2(0x1c7)](_0x2f79a2(0x136),_0x57c435);}else{const _0x262e5f=_0x359dea[0x0][_0x2f79a2(0x20a)];if(pid[_0x262e5f])pid[_0x262e5f][_0x2f79a2(0x1db)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x1ccdfa=>{const _0x338fcd=_0x2d3ce4,_0x332ac6=_0x1ccdfa[_0x338fcd(0x16e)][0x1];_0x1ccdfa['editMessageReplyMarkup']();if(pid[_0x332ac6])pid[_0x332ac6][_0x338fcd(0x1db)]({'function':_0x338fcd(0x2c0),'args':null});}),tgBot[_0x2d3ce4(0x241)](_0x2d3ce4(0x22b),async _0x281e40=>{const _0x4c1ef7=_0x2d3ce4,_0x3c806e=getEnabledBots();if(_0x3c806e['length']==0x0)await sendTelegram(_0x281e40[_0x4c1ef7(0x2be)]['id'],_0x4c1ef7(0x1dc));else{if(_0x3c806e[_0x4c1ef7(0x2ca)]>0x1){let _0x15470e=[],_0x32c99a=[];const _0x1fee60=_0x3c806e[_0x4c1ef7(0x2ca)]%0x4==0x0||_0x3c806e[_0x4c1ef7(0x2ca)]%0x4==0x3||_0x3c806e[_0x4c1ef7(0x2ca)]%0x3==0x1?0x4:0x3;let _0x13684d=0x0;_0x3c806e[_0x4c1ef7(0x229)]((_0x284191,_0x35ef77)=>{const _0x4e3c49=_0x4c1ef7;if(_0x35ef77%_0x1fee60==0x0)_0x32c99a=[];_0x32c99a[_0x4e3c49(0x2f4)](Markup['button'][_0x4e3c49(0x319)]('Bot\x20'+_0x284191[_0x4e3c49(0x20a)],_0x4e3c49(0x20c)+_0x284191[_0x4e3c49(0x20a)])),_0x35ef77%_0x1fee60==0x0&&(_0x15470e[_0x13684d]=_0x32c99a,_0x13684d++);});const _0x4e369b=Markup['inlineKeyboard'](_0x15470e);_0x281e40[_0x4c1ef7(0x1c7)](_0x4c1ef7(0x1f4),_0x4e369b);}else{const _0x2272aa=_0x3c806e[0x0]['botID'];if(pid[_0x2272aa])pid[_0x2272aa][_0x4c1ef7(0x1db)]({'function':_0x4c1ef7(0x224),'args':null});}}}),tgBot[_0x2d3ce4(0x19d)](/portfolio_(.+)/,async _0x59f9e9=>{const _0x5f2b4f=_0x2d3ce4,_0x135747=_0x59f9e9[_0x5f2b4f(0x16e)][0x1];_0x59f9e9[_0x5f2b4f(0x236)]();if(pid[_0x135747])pid[_0x135747][_0x5f2b4f(0x1db)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x2d3ce4(0x241)]('update',async _0x366a86=>{const _0x4be3ac=_0x2d3ce4;await getMessages();if(!updateAvailable)await sendTelegram(_0x366a86[_0x4be3ac(0x2be)]['id'],_0x4be3ac(0x270));else{if(!validInstallation)await sendTelegram(_0x366a86['chat']['id'],_0x4be3ac(0x2b4));else{const _0x38f154=Markup[_0x4be3ac(0x194)]([Markup[_0x4be3ac(0x14f)][_0x4be3ac(0x319)](_0x4be3ac(0x2dd),'update_yes'),Markup[_0x4be3ac(0x14f)][_0x4be3ac(0x319)]('No',_0x4be3ac(0x1c4))]);_0x366a86[_0x4be3ac(0x1c7)](_0x4be3ac(0x12b),_0x38f154);}}}),tgBot[_0x2d3ce4(0x19d)](/update_(.+)/,async _0x44afbe=>{const _0x582d0e=_0x2d3ce4,_0x2fa4c7=_0x44afbe[_0x582d0e(0x16e)][0x1];_0x44afbe[_0x582d0e(0x236)](),_0x2fa4c7==_0x582d0e(0x2a9)&&(await sendTelegram(_0x44afbe[_0x582d0e(0x2be)]['id'],_0x582d0e(0x18e)),updateBB(_0x582d0e(0x1f2))),_0x2fa4c7=='no'&&await sendTelegram(_0x44afbe[_0x582d0e(0x2be)]['id'],_0x582d0e(0x268));}),tgBot[_0x2d3ce4(0x241)]('reinstall',async _0x23f602=>{const _0x49a9fb=_0x2d3ce4;if(!validInstallation)await sendTelegram(_0x23f602[_0x49a9fb(0x2be)]['id'],_0x49a9fb(0x197));else{const _0x2d58b8=Markup['inlineKeyboard']([Markup['button'][_0x49a9fb(0x319)]('Yes',_0x49a9fb(0x239)),Markup[_0x49a9fb(0x14f)][_0x49a9fb(0x319)]('No',_0x49a9fb(0x16b))]);_0x23f602[_0x49a9fb(0x1c7)](_0x49a9fb(0x2f1),_0x2d58b8);}}),tgBot[_0x2d3ce4(0x19d)](/reinstall_(.+)/,async _0x2b3c73=>{const _0x368878=_0x2d3ce4,_0x461b13=_0x2b3c73['match'][0x1];_0x2b3c73[_0x368878(0x236)](),_0x461b13=='yes'&&(await sendTelegram(_0x2b3c73[_0x368878(0x2be)]['id'],_0x368878(0x177)),updateBB(_0x368878(0x227))),_0x461b13=='no'&&await sendTelegram(_0x2b3c73[_0x368878(0x2be)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x2d3ce4(0x241)](_0x2d3ce4(0x19b),async _0x257890=>{const _0x32aee2=_0x2d3ce4,_0xe7546d=getBotsWithMode();if(_0xe7546d[_0x32aee2(0x2ca)]==0x0)await sendTelegram(_0x257890[_0x32aee2(0x2be)]['id'],_0x32aee2(0x1dc));else{let _0xaa6410=[],_0x50f635=[];const _0x36e671=0x2;let _0x5323e0=0x0;_0xe7546d[_0x32aee2(0x229)]((_0x141478,_0x598309)=>{const _0x46011c=_0x32aee2;if(_0x598309%_0x36e671==0x0)_0x50f635=[];_0x50f635[_0x46011c(0x2f4)](Markup[_0x46011c(0x14f)]['callback'](_0x46011c(0x180)+_0x141478['botID']+'\x20('+_0x141478['mode']+')',_0x46011c(0x1f7)+_0x141478['botID'])),_0x598309%_0x36e671==0x0&&(_0xaa6410[_0x5323e0]=_0x50f635,_0x5323e0++);});const _0x454d4d=Markup[_0x32aee2(0x194)](_0xaa6410);_0x257890['reply'](_0x32aee2(0x1e6),_0x454d4d);}}),tgBot[_0x2d3ce4(0x19d)](/toggle_(.+)/,async _0x4030ae=>{const _0x141c27=_0x2d3ce4,_0x11fd20=_0x4030ae['match'][0x1];_0x4030ae[_0x141c27(0x236)]();const _0x570d01=getBotsWithMode(),_0x3879a1=_0x570d01[_0x141c27(0x13c)](_0xa85c1e=>_0xa85c1e[_0x141c27(0x20a)]==_0x11fd20),_0x54c696=_0x3879a1[_0x141c27(0x1ae)]==_0x141c27(0x2d4)?_0x141c27(0x158):'auto';await sendTelegram(_0x4030ae[_0x141c27(0x2be)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x11fd20+_0x141c27(0x1bf)+_0x54c696+'\x20mode'),toggleBotMode(_0x11fd20);}),tgBot[_0x2d3ce4(0x241)]('names',async _0x2f329c=>{const _0x8b091b=_0x2d3ce4;let _0x1e4ad3='';config[_0x8b091b(0x229)](_0x1def6b=>{const _0x439cde=_0x8b091b;_0x1e4ad3+='Bot\x20'+_0x1def6b[_0x439cde(0x20a)]+':\x20'+_0x1def6b[_0x439cde(0x183)]+'\x0a';}),await sendTelegram(_0x2f329c[_0x8b091b(0x2be)]['id'],_0x1e4ad3,{'parse_mode':_0x8b091b(0x15a)});}),tgBot[_0x2d3ce4(0x241)](_0x2d3ce4(0x23e),async _0x1049ef=>{await sendTelegram(_0x1049ef['chat']['id'],_0x5e7208);}),process[_0x2d3ce4(0x29e)]('SIGINT',()=>tgBot[_0x2d3ce4(0x1e7)]('SIGINT')),process[_0x2d3ce4(0x29e)](_0x2d3ce4(0x30d),()=>tgBot[_0x2d3ce4(0x1e7)](_0x2d3ce4(0x30d))),tgBot['launch']();}}function disableTelegram(){const _0xf38bdf=_0x322f9d;tgBot&&tgBot[_0xf38bdf(0x1e7)]();}async function sendTelegram(_0x552e55,_0x5bd4b8,_0x53e5b7){const _0x1c889a=_0x322f9d;_0x53e5b7={..._0x53e5b7,'disable_web_page_preview':!![]};try{await tgBot[_0x1c889a(0x143)]['sendMessage'](_0x552e55,_0x5bd4b8,_0x53e5b7);}catch(_0x1a5143){console[_0x1c889a(0x121)](_0x1c889a(0x260),_0x1a5143);}}async function sendTelegramBot(_0x259eb1,_0x1600ba){const _0x5cb6a0=_0x322f9d;if(settings[_0x5cb6a0(0x1f1)]){if(settings['telegramEvents']==_0x5cb6a0(0x248)||(_0x1600ba['type']==_0x5cb6a0(0x202)||_0x1600ba['type']==_0x5cb6a0(0x2d0)||_0x1600ba['type']==_0x5cb6a0(0x27e))&&settings[_0x5cb6a0(0x1ca)]=='alerts'||_0x1600ba[_0x5cb6a0(0x1c5)]=='order'&&settings['telegramEvents']==_0x5cb6a0(0x2dc)){if(tgBot&&settings[_0x5cb6a0(0x279)]){if(_0x1600ba['showname'])await sendTelegram(settings[_0x5cb6a0(0x279)],_0x1600ba[_0x5cb6a0(0x183)]+_0x5cb6a0(0x2f9)+_0x1600ba[_0x5cb6a0(0x173)]);else await sendTelegram(settings['telegramChatId'],_0x5cb6a0(0x180)+_0x259eb1+'\x20>\x20'+_0x1600ba[_0x5cb6a0(0x173)]);}}}}async function sendTelegramMsg(_0x1bf344,_0x5b47cf=_0x322f9d(0x15a)){const _0x14b1dc=_0x322f9d;return settings[_0x14b1dc(0x1f1)]&&tgBot&&settings[_0x14b1dc(0x279)]?(await sendTelegram(settings[_0x14b1dc(0x279)],_0x1bf344,{'parse_mode':_0x5b47cf}),!![]):![];}function getDeviceWithIp(_0x502f8b){const _0x292b18=_0x322f9d;return devices[_0x292b18(0x13c)](_0x2b051c=>_0x2b051c['ip']===_0x502f8b);}async function temporaryAccess2FA(_0x42641f,_0x488ffc){const _0x156e32=_0x322f9d;let _0x3d9ff9=new Date(),_0x530fa3=![];if(lastIpApproval){if(_0x3d9ff9-lastIpApproval<0x1388)_0x530fa3=!![];}lastIpApproval=new Date();if(_0x530fa3)return;if(tgBot&&settings[_0x156e32(0x279)]){const _0x1ac41a=uuidRandom();tmpStorage[_0x1ac41a]={'uuid':_0x42641f,'externalip':_0x488ffc};const _0x4db881=Markup[_0x156e32(0x194)]([Markup[_0x156e32(0x14f)][_0x156e32(0x319)](_0x156e32(0x1b6),_0x156e32(0x133)+_0x1ac41a),Markup['button'][_0x156e32(0x319)](_0x156e32(0x1fa),'tempaccess_15_'+_0x1ac41a),Markup[_0x156e32(0x14f)][_0x156e32(0x319)](_0x156e32(0x21a),_0x156e32(0x251)+_0x1ac41a),Markup[_0x156e32(0x14f)][_0x156e32(0x319)]('reject',_0x156e32(0x231)+_0x1ac41a)]);await sendTelegram(settings['telegramChatId'],_0x156e32(0x254)+normalizeIP(_0x488ffc)[_0x156e32(0x255)]+'\x20?',_0x4db881),tgBot[_0x156e32(0x19d)](/tempaccess_(.+)_(.+)/,async _0x40541f=>{const _0x583fbf=_0x156e32,_0x38328d=_0x40541f[_0x583fbf(0x16e)][0x1],_0x3883c1=_0x40541f[_0x583fbf(0x16e)][0x2],{uuid:_0x230984,externalip:_0x2be233}=tmpStorage[_0x3883c1];delete tmpStorage[_0x3883c1],_0x40541f['editMessageReplyMarkup'](),devices[_0x230984][_0x583fbf(0x141)]={'clientip':_0x2be233,'timestamp':new Date()['getTime'](),'expiry':_0x38328d},_0x38328d!=_0x583fbf(0x1a5)?(await sendTelegram(_0x40541f[_0x583fbf(0x2be)]['id'],'Access\x20enabled\x20for\x20'+_0x38328d+'\x20minutes',{'parse_mode':_0x583fbf(0x15a)}),io['to'](_0x230984)['emit'](_0x583fbf(0x208),{'access':{'allow':![],'reason':_0x583fbf(0x165),'token':null}})):(await sendTelegram(_0x40541f['chat']['id'],'Temporary\x20access\x20rejected'),io['to'](_0x230984)[_0x583fbf(0x185)]('status',{'access':{'allow':![],'reason':_0x583fbf(0x2d3),'token':null}}));});}}async function loginAccess2FA(_0x2690de,_0xcc8d0d){const _0x5280fa=_0x322f9d;if(tgBot&&settings[_0x5280fa(0x279)]){const _0x25e418=uuidRandom();tmpStorage[_0x25e418]={'uuid':_0x2690de,'externalip':_0xcc8d0d};const _0x123c7f=Markup[_0x5280fa(0x194)]([Markup['button'][_0x5280fa(0x319)](_0x5280fa(0x31f),_0x5280fa(0x18c)+loginExpiry+'_'+_0x25e418),Markup[_0x5280fa(0x14f)][_0x5280fa(0x319)](_0x5280fa(0x1a5),_0x5280fa(0x13a)+_0x25e418)]);await sendTelegram(settings[_0x5280fa(0x279)],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0xcc8d0d)[_0x5280fa(0x255)]+'\x20?',_0x123c7f),tgBot[_0x5280fa(0x19d)](/login2fa_(.+)_(.+)/,async _0x189245=>{const _0x1d0825=_0x5280fa,_0x368ec8=_0x189245[_0x1d0825(0x16e)][0x1],_0x338f2e=_0x189245['match'][0x2],{uuid:_0x122afa,externalip:_0x14b353}=tmpStorage[_0x338f2e];delete tmpStorage[_0x338f2e],_0x189245['editMessageReplyMarkup'](),devices[_0x122afa][_0x1d0825(0x1cc)]={'clientip':_0x14b353,'timestamp':new Date()[_0x1d0825(0x288)](),'expiry':_0x368ec8},_0x368ec8!=_0x1d0825(0x1a5)?(await sendTelegram(_0x189245['chat']['id'],_0x1d0825(0x2a7),{'parse_mode':_0x1d0825(0x15a)}),io['to'](_0x122afa)[_0x1d0825(0x185)](_0x1d0825(0x208),{'access':{'allow':![],'reason':_0x1d0825(0x165),'token':null}})):(await sendTelegram(_0x189245[_0x1d0825(0x2be)]['id'],'Login\x20rejected'),io['to'](_0x122afa)[_0x1d0825(0x185)](_0x1d0825(0x208),{'access':{'allow':![],'reason':_0x1d0825(0x217),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x46456=_0x322f9d;return dbConfig[_0x46456(0x1eb)](_0x46456(0x157))[_0x46456(0x1ff)]('botID')[_0x46456(0x318)]({'status':_0x46456(0x1e0)})[_0x46456(0x145)]()||[];}function getDisabledBots(){const _0x433d32=_0x322f9d;return dbConfig[_0x433d32(0x1eb)](_0x433d32(0x157))[_0x433d32(0x1ff)](_0x433d32(0x20a))[_0x433d32(0x318)]({'status':_0x433d32(0x13b)})[_0x433d32(0x145)]()||[];}function getBotAttributes(_0x452637){const _0x513439=_0x322f9d;let _0xaa316e={};const _0x3907e6=configpath+'bot-'+_0x452637+'-config.json',_0x5bdcac=fs[_0x513439(0x225)](_0x3907e6);if(_0x5bdcac){const _0x648d64=fs['readFileSync'](_0x3907e6);try{const _0xbaaf91=JSON[_0x513439(0x2b8)](_0x648d64),_0xc2d262=_0xbaaf91?_0xbaaf91['bot'][0x0][_0x513439(0x1a1)]:![];_0xaa316e[_0x513439(0x1ae)]=_0xc2d262?_0x513439(0x2d4):'manual',_0xaa316e[_0x513439(0x183)]=_0xbaaf91?_0xbaaf91[_0x513439(0x2cb)][0x0][_0x513439(0x183)]:'Bot\x20'+_0x452637;}catch(_0x32138c){_0xaa316e[_0x513439(0x1ae)]=_0x513439(0x158),_0xaa316e[_0x513439(0x183)]=_0x513439(0x180)+_0x452637;}}else _0xaa316e['mode']=_0x513439(0x158),_0xaa316e['botname']=_0x513439(0x180)+_0x452637;return _0xaa316e;}function getBotsWithMode(){const _0xe6824=_0x322f9d,_0x25726e=dbConfig['get'](_0xe6824(0x157))['sortBy'](_0xe6824(0x20a))[_0xe6824(0x145)]()||[];return _0x25726e[_0xe6824(0x229)](_0xbc1e87=>{const _0x16fde7=_0xe6824;let _0x40683d=getBotAttributes(_0xbc1e87[_0x16fde7(0x20a)]);_0xbc1e87[_0x16fde7(0x1ae)]=_0x40683d[_0x16fde7(0x1ae)];}),_0x25726e;}function getBotExchanges(){const _0x22759e=_0x322f9d;let _0x25c9c7=[];const _0x222755=dbConfig['get']('bots')[_0x22759e(0x1ff)](_0x22759e(0x20a))['value']()||[];_0x222755['forEach'](_0x20cfff=>{const _0x420277=_0x22759e;if(_0x20cfff['status']=='enabled'){const _0x136394=configpath+_0x420277(0x174)+_0x20cfff[_0x420277(0x20a)]+_0x420277(0x2e9),_0x295035=fs['existsSync'](_0x136394);let _0x200e01;if(_0x295035){const _0x5033bd=fs['readFileSync'](_0x136394);try{const _0x176eb2=JSON[_0x420277(0x2b8)](_0x5033bd);_0x200e01=_0x176eb2?_0x176eb2[_0x420277(0x2cb)][0x0][_0x420277(0x322)]:null;}catch(_0x535960){}}if(_0x200e01)_0x25c9c7['push'](_0x200e01);}});const _0x23f60f=[...new Set(_0x25c9c7)][_0x22759e(0x207)]();return _0x23f60f;}async function initUser(){const _0x4fdea7=_0x322f9d;if(!settings[_0x4fdea7(0x126)]){const _0x29725c=uuidRandom();mixpanel[_0x4fdea7(0x23a)](_0x29725c),updateSetting(_0x4fdea7(0x126),_0x29725c);}}async function initSecure(){const _0x11dec5=_0x322f9d;let _0x31ddbe=getSecure();if(!_0x31ddbe[_0x11dec5(0x17f)]('secret')){let _0x152bfe=await generateKeys();_0x31ddbe[_0x11dec5(0x200)]=_0x152bfe[_0x11dec5(0x200)],_0x31ddbe['privateKey']=_0x152bfe['privateKey'],_0x31ddbe[_0x11dec5(0x188)]=crypto[_0x11dec5(0x2ac)](0x20)[_0x11dec5(0x26f)](_0x11dec5(0x266));;storeSecure(_0x31ddbe);}}function getSettings(){const _0x549f59=_0x322f9d;return dbSettings[_0x549f59(0x1eb)](_0x549f59(0x2e6))[_0x549f59(0x145)]()||{};}function getSecure(){const _0x1f4550=_0x322f9d;return dbSecure[_0x1f4550(0x1eb)](_0x1f4550(0x313))[_0x1f4550(0x145)]()||{};}function getBlacklist(){const _0x13f32b=_0x322f9d;return dbSecure[_0x13f32b(0x1eb)]('blacklist')[_0x13f32b(0x145)]()||[];}function broadcastToBots(_0xaab5ad,_0x4403b5){const _0x244769=_0x322f9d;config[_0x244769(0x229)](_0x46c318=>{const _0x13ff14=_0x244769;if(_0x46c318[_0x13ff14(0x208)]=='enabled'&&_0x46c318['live']==_0x13ff14(0x27b)||_0x46c318[_0x13ff14(0x208)]==_0x13ff14(0x2ee)&&_0x46c318[_0x13ff14(0x1fd)]==_0x13ff14(0x27b)){if(pid[_0x46c318['botID']])pid[_0x46c318['botID']]['send']({[_0xaab5ad]:_0x4403b5});}});}async function storeSettings(_0x4d87ca,_0x288897=![]){const _0x2d1f59=_0x322f9d;_0x4d87ca={...settings,..._0x4d87ca};if(_0x288897&&_0x4d87ca[_0x2d1f59(0x2fd)]!=_0x2d1f59(0x262)&&_0x4d87ca[_0x2d1f59(0x2fd)]!=_0x2d1f59(0x30c)&&_0x4d87ca[_0x2d1f59(0x2fd)]!=''){const _0x5edd93=crypt['decrypt'](secure[_0x2d1f59(0x257)],_0x4d87ca[_0x2d1f59(0x2fd)])[_0x2d1f59(0x283)][_0x2d1f59(0x1d6)]('|@|')[0x0],_0x3a8af3=bcrypt[_0x2d1f59(0x159)](_0x5edd93,saltRounds);_0x4d87ca={..._0x4d87ca,'bbPassword':_0x3a8af3};}if(_0x288897&&_0x4d87ca[_0x2d1f59(0x142)]!=_0x2d1f59(0x262)&&_0x4d87ca['telegramToken']!=_0x2d1f59(0x30c)&&_0x4d87ca[_0x2d1f59(0x142)]!=''){const _0x5f0a62=crypt['decrypt'](secure[_0x2d1f59(0x257)],_0x4d87ca['telegramToken'])[_0x2d1f59(0x283)]['split'](_0x2d1f59(0x203))[0x0];_0x4d87ca={..._0x4d87ca,'telegramToken':_0x5f0a62};}if(_0x288897&&_0x4d87ca['marketcapApi']!='************'&&_0x4d87ca[_0x2d1f59(0x296)]!=_0x2d1f59(0x30c)&&_0x4d87ca[_0x2d1f59(0x296)]!=''){const _0x4300b3=crypt[_0x2d1f59(0x1e1)](secure[_0x2d1f59(0x257)],_0x4d87ca['marketcapApi'])['message'][_0x2d1f59(0x1d6)]('|@|')[0x0];_0x4d87ca={..._0x4d87ca,'marketcapApi':_0x4300b3};}const _0x408c41=_0x4d87ca[_0x2d1f59(0x142)]!=_0x2d1f59(0x262)&&_0x4d87ca[_0x2d1f59(0x142)]!=settings['telegramToken']||_0x4d87ca[_0x2d1f59(0x15d)]!=settings[_0x2d1f59(0x15d)],_0x509ffa=_0x4d87ca[_0x2d1f59(0x142)]==''||_0x4d87ca['telegramUsername']=='',_0x5417b3=_0x4d87ca[_0x2d1f59(0x296)]&&_0x4d87ca[_0x2d1f59(0x296)]!=_0x2d1f59(0x262)&&_0x4d87ca['marketcapApi']!=settings[_0x2d1f59(0x142)];_0x408c41&&(_0x4d87ca[_0x2d1f59(0x279)]=null,_0x4d87ca[_0x2d1f59(0x1ca)]=_0x2d1f59(0x248));for(const [_0x28965c,_0x2b2864]of Object['entries'](_0x4d87ca)){if(_0x28965c==_0x2d1f59(0x142)&&_0x2b2864=='************'){_0x4d87ca[_0x2d1f59(0x142)]=settings[_0x2d1f59(0x142)];continue;};if(_0x28965c=='bbPassword'&&_0x2b2864==_0x2d1f59(0x262)){_0x4d87ca['bbPassword']=settings[_0x2d1f59(0x2fd)];continue;};if(_0x28965c==_0x2d1f59(0x296)&&_0x2b2864==_0x2d1f59(0x262)){_0x4d87ca[_0x2d1f59(0x296)]=settings[_0x2d1f59(0x296)];continue;};dbSettings[_0x2d1f59(0x2d1)](_0x2d1f59(0x223)+_0x28965c,_0x2b2864)['write']();}settings=_0x4d87ca,io['to']('botmanager')[_0x2d1f59(0x185)](_0x2d1f59(0x2e6),cleanSettings()),broadcastToBots('timeshift',settings[_0x2d1f59(0x199)]),broadcastToBots(_0x2d1f59(0x301),settings['onepagemode']),broadcastToBots('marketcapApi',settings[_0x2d1f59(0x296)]);if(_0x408c41&&!_0x509ffa)initTelegram();if(_0x408c41&&_0x509ffa)disableTelegram();getAllClients()[_0x2d1f59(0x229)](_0x516978=>{const _0x58cb36=_0x2d1f59;getSocket(_0x516978['id'])[_0x58cb36(0x185)](_0x58cb36(0x208),{'access':{'allow':![],'reason':_0x58cb36(0x165),'token':null}});}),_0x5417b3&&(await sleep(0xbb8),testMarketcapApi(_0x4d87ca[_0x2d1f59(0x296)]));}async function testMarketcapApi(_0xf9273){const _0x379943=_0x322f9d,_0x9f5f3=[_0x379943(0x2e2),_0x379943(0x1be)];try{await axios[_0x379943(0x1eb)](_0x379943(0x29d),{'headers':{'X-CMC_PRO_API_KEY':_0xf9273},'params':{'symbol':_0x9f5f3['toString']()}});}catch(_0x24bc1e){_0x24bc1e[_0x379943(0x26f)]()[_0x379943(0x1ee)](_0x379943(0x29c))?(io['to'](_0x379943(0x178))[_0x379943(0x185)]('notification',_0x379943(0x16d)),logger[_0x379943(0x29f)](_0x379943(0x16d))):(io['to'](_0x379943(0x178))['emit'](_0x379943(0x215),_0x379943(0x13f)),logger['full'](_0x379943(0x13f)),logger[_0x379943(0x1fc)]('Error\x20details:',_0x24bc1e[_0x379943(0x26f)]()+'\x20-\x20'+_0x24bc1e[_0x379943(0x26e)]));return;}logger['debug'](_0x379943(0x28f));}function updateSetting(_0x1c80f1,_0x18c796){const _0x575623=_0x322f9d;dbSettings['set'](_0x575623(0x223)+_0x1c80f1,_0x18c796)[_0x575623(0x153)](),settings=getSettings(),io['to'](_0x575623(0x178))['emit'](_0x575623(0x2e6),cleanSettings());}function storeSecure(_0x239d18){const _0x382cc8=_0x322f9d;dbSecure[_0x382cc8(0x1eb)](_0x382cc8(0x313))[_0x382cc8(0x2f4)](_0x239d18)[_0x382cc8(0x153)](),secure=_0x239d18;}function addBlacklist(_0x3e0a0e){const _0x353fb7=_0x322f9d;cleanBlacklist();let _0x311866;devices[_0x3e0a0e]['telegramIpApproval']?_0x311866=Math['max'](devices[_0x3e0a0e][_0x353fb7(0x141)][_0x353fb7(0x2d8)],loginExpiry):_0x311866=loginExpiry,dbSecure[_0x353fb7(0x1eb)](_0x353fb7(0x256))[_0x353fb7(0x2f4)]({'expiry':new Date()[_0x353fb7(0x288)]()+_0x311866*0x3c*0x3e8,'token':devices[_0x3e0a0e]['access']['token']})[_0x353fb7(0x153)](),blacklist=dbSecure[_0x353fb7(0x1eb)](_0x353fb7(0x256))[_0x353fb7(0x145)]();}function cleanBlacklist(){const _0x317252=_0x322f9d;let _0x621006=dbSecure[_0x317252(0x1eb)](_0x317252(0x256))['cloneDeep']()[_0x317252(0x145)](),_0x578958=new Date()['getTime']();_0x621006['forEach'](_0xa45962=>{const _0x2aa415=_0x317252;_0xa45962[_0x2aa415(0x2d8)]<_0x578958&&dbSecure[_0x2aa415(0x1eb)](_0x2aa415(0x256))[_0x2aa415(0x18b)]({'expiry':_0xa45962['expiry']})['write']();});}function initStates(){const _0x18ae52=_0x322f9d;let _0x2ae057=getConfiguration();_0x2ae057[_0x18ae52(0x229)](_0x5b7a49=>{_0x5b7a49['live']='stopped';}),storeConfiguration(_0x2ae057);}function onKeys(){const _0x4d9fd1=new RSA();return new Promise(_0xa1363e=>{const _0x502d17=_0x422f;_0x4d9fd1[_0x502d17(0x28b)]()['then'](_0x2bd127=>{_0xa1363e(_0x2bd127);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x58c77c=_0x322f9d;let _0x1a8d61=getSettings(),_0x47637c=![];!_0x1a8d61['hasOwnProperty'](_0x58c77c(0x27f))&&(_0x1a8d61[_0x58c77c(0x27f)]=0x0,_0x47637c=!![]);!_0x1a8d61[_0x58c77c(0x17f)](_0x58c77c(0x213))&&(_0x1a8d61['lastmsgemitted']=0x0,_0x47637c=!![]);!_0x1a8d61[_0x58c77c(0x17f)](_0x58c77c(0x246))&&(_0x1a8d61['latestversion']='0.0.0',_0x47637c=!![]);!_0x1a8d61[_0x58c77c(0x17f)](_0x58c77c(0x301))&&(_0x1a8d61[_0x58c77c(0x301)]=![],_0x47637c=!![]);!_0x1a8d61[_0x58c77c(0x17f)](_0x58c77c(0x296))&&(_0x1a8d61[_0x58c77c(0x296)]='',_0x47637c=!![]);if(_0x47637c)storeSettings(_0x1a8d61);try{fs[_0x58c77c(0x1c3)](configbackuppath,{'withFileTypes':!![]})[_0x58c77c(0x229)](_0x1afbd1=>{const _0x809286=_0x58c77c;if(!_0x1afbd1[_0x809286(0x247)]()){if(!_0x1afbd1[_0x809286(0x292)][_0x809286(0x30b)]('backup-full@'))fs[_0x809286(0x261)](configbackuppath+_0x1afbd1[_0x809286(0x292)]);}else fs[_0x809286(0x25c)](configbackuppath+_0x1afbd1['name'],{'recursive':!![]});});}catch(_0x1525ba){logger[_0x58c77c(0x1fc)](_0x58c77c(0x2e4),_0x1525ba);}}function storeConfiguration(_0x4ea68f){const _0x569a54=_0x322f9d;dbConfig[_0x569a54(0x1eb)](_0x569a54(0x157))['remove']()['write'](),dbConfig[_0x569a54(0x1eb)](_0x569a54(0x157))['push'](..._0x4ea68f)['write'](),config=_0x4ea68f;}async function resetPassword(){const _0x14ee88=_0x322f9d;if(tgBot&&settings['telegramChatId']){const _0x42fed6=Markup[_0x14ee88(0x194)]([Markup[_0x14ee88(0x14f)][_0x14ee88(0x319)]('yes',_0x14ee88(0x1ce)),Markup['button']['callback']('no',_0x14ee88(0x21f))]);await sendTelegram(settings['telegramChatId'],_0x14ee88(0x20f),_0x42fed6),tgBot[_0x14ee88(0x19d)](/resetpw_(.+)/,async _0x258419=>{const _0x3be71a=_0x14ee88,_0x3f669a=_0x258419[_0x3be71a(0x16e)][0x1];_0x258419[_0x3be71a(0x236)]();if(_0x3f669a!='no'){const _0x2c2031=0xf,_0x28c4f9=_0x3be71a(0x317),_0x4cb8c2=Array[_0x3be71a(0x1e8)](crypto[_0x3be71a(0x2ad)](new Uint32Array(_0x2c2031)))[_0x3be71a(0x226)](_0x3bb413=>_0x28c4f9[_0x3bb413%_0x28c4f9[_0x3be71a(0x2ca)]])[_0x3be71a(0x2a6)](''),_0x1dac43=bcrypt[_0x3be71a(0x159)](_0x4cb8c2,saltRounds);storeSettings({'bbPassword':_0x1dac43}),await sendTelegram(_0x258419[_0x3be71a(0x2be)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x4cb8c2,{'parse_mode':_0x3be71a(0x15a)});}else await sendTelegram(_0x258419[_0x3be71a(0x2be)]['id'],_0x3be71a(0x160));});}}async function confirmRestore(_0x487f4a,_0x5f3b0a){const _0x4ca5c5=_0x322f9d;io['to'](_0x4ca5c5(0x178))[_0x4ca5c5(0x185)](_0x4ca5c5(0x215),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x4ca5c5(0x27e));if(tgBot&&settings['telegramChatId']){const _0x9f4867=uuidRandom();tmpStorage[_0x9f4867]={'path':_0x487f4a,'filename':_0x5f3b0a};const _0x10b1a8=Markup[_0x4ca5c5(0x194)]([Markup[_0x4ca5c5(0x14f)]['callback']('yes','restore_yes_'+_0x9f4867),Markup['button'][_0x4ca5c5(0x319)]('no','restore_no_'+_0x9f4867)]);await sendTelegram(settings[_0x4ca5c5(0x279)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x10b1a8),tgBot['action'](/restore_(.+)_(.+)/,async _0x3cf94a=>{const _0x251aa=_0x4ca5c5,_0x5e8b3a=_0x3cf94a[_0x251aa(0x16e)][0x1],_0x486949=_0x3cf94a[_0x251aa(0x16e)][0x2],{path:_0x50ac0b,filename:_0x13a4d2}=tmpStorage[_0x486949];delete tmpStorage[_0x486949],_0x3cf94a[_0x251aa(0x236)](),_0x5e8b3a==_0x251aa(0x2a9)?(logger[_0x251aa(0x1fc)](_0x251aa(0x267)),await sendTelegram(_0x3cf94a['chat']['id'],_0x251aa(0x277),{'parse_mode':_0x251aa(0x15a)}),unzipFile(_0x50ac0b,_0x13a4d2)):(logger[_0x251aa(0x1fc)](_0x251aa(0x242)),await sendTelegram(_0x3cf94a[_0x251aa(0x2be)]['id'],_0x251aa(0x242)));});}}function getServerTime(){const _0xca4743=_0x322f9d,_0x5f5cb6=new Date();return _0x5f5cb6[_0xca4743(0x1c2)]()+'/'+(_0x5f5cb6[_0xca4743(0x1e2)]()+0x1)[_0xca4743(0x26f)]()[_0xca4743(0x1ec)](0x2,'0')+'/'+_0x5f5cb6[_0xca4743(0x28a)]()['toString']()[_0xca4743(0x1ec)](0x2,'0')+'\x20'+_0x5f5cb6['getHours']()[_0xca4743(0x26f)]()[_0xca4743(0x1ec)](0x2,'0')+':'+_0x5f5cb6['getMinutes']()['toString']()[_0xca4743(0x1ec)](0x2,'0')+':'+_0x5f5cb6[_0xca4743(0x168)]()[_0xca4743(0x26f)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0xd456ab=_0x322f9d,_0x1526b9=shiftedTime();return _0x1526b9[_0xd456ab(0x1c2)]()+'/'+(_0x1526b9[_0xd456ab(0x1e2)]()+0x1)[_0xd456ab(0x26f)]()[_0xd456ab(0x1ec)](0x2,'0')+'/'+_0x1526b9[_0xd456ab(0x28a)]()[_0xd456ab(0x26f)]()[_0xd456ab(0x1ec)](0x2,'0')+'\x20'+_0x1526b9[_0xd456ab(0x1a3)]()[_0xd456ab(0x26f)]()[_0xd456ab(0x1ec)](0x2,'0')+':'+_0x1526b9[_0xd456ab(0x201)]()[_0xd456ab(0x26f)]()[_0xd456ab(0x1ec)](0x2,'0')+':'+_0x1526b9['getSeconds']()[_0xd456ab(0x26f)]()[_0xd456ab(0x1ec)](0x2,'0');}function getCleanTimeStamp(){const _0x5ed089=_0x322f9d,_0x2df8a9=shiftedTime();return _0x2df8a9[_0x5ed089(0x1c2)]()+(_0x2df8a9['getMonth']()+0x1)['toString']()[_0x5ed089(0x1ec)](0x2,'0')+_0x2df8a9[_0x5ed089(0x28a)]()[_0x5ed089(0x26f)]()[_0x5ed089(0x1ec)](0x2,'0')+'-'+_0x2df8a9[_0x5ed089(0x1a3)]()[_0x5ed089(0x26f)]()[_0x5ed089(0x1ec)](0x2,'0')+_0x2df8a9[_0x5ed089(0x201)]()[_0x5ed089(0x26f)]()['padStart'](0x2,'0')+_0x2df8a9[_0x5ed089(0x168)]()[_0x5ed089(0x26f)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x1b7044=_0x322f9d,_0x4045f5=new Date();let _0x89819b=_0x4045f5;if(settings[_0x1b7044(0x199)]&&settings['timeshift']!==0x0)_0x89819b=fns[_0x1b7044(0x14d)](_0x4045f5,{'hours':settings[_0x1b7044(0x199)]});return _0x89819b;}function startScheduler(){const _0x1243f1=_0x322f9d,_0x5e4069=new Date()[_0x1243f1(0x17e)](),_0x570d17=shiftedTime()[_0x1243f1(0x1a3)]();_0x570d17==0x4&&backupConfigFiles();_0x570d17==0x0&&rotateLogFiles();_0x5e4069%0x6==0x0&&triggerAnalytics();_0x5e4069%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0xe3a977){const _0x50ae96=_0x322f9d;logger[_0x50ae96(0x1fc)](_0x50ae96(0x2f2)+_0xe3a977);const _0x252848=getBotsWithMode();_0x252848[_0x50ae96(0x2ca)]>0x0?confirmRestore(configbackuppath,_0xe3a977):unzipFile(configbackuppath,_0xe3a977);}async function getBackupFiles(_0x3aff11=null){const _0x87b43a=_0x322f9d;let _0xe78ade=[],_0x1e8e3b=fs[_0x87b43a(0x1c3)](configbackuppath,{'withFileTypes':!![]});_0x1e8e3b[_0x87b43a(0x207)]((_0x5253e1,_0x41ec37)=>_0x5253e1[_0x87b43a(0x292)]<_0x41ec37[_0x87b43a(0x292)]?0x1:_0x41ec37['name']<_0x5253e1['name']?-0x1:0x0),_0x1e8e3b[_0x87b43a(0x229)](_0x3e14fe=>{const _0x3d9f76=_0x87b43a;if(!_0x3e14fe['isDirectory']()&&_0x3e14fe['name']['startsWith']('backup-full@')&&_0x3e14fe['name'][_0x3d9f76(0x305)](_0x3d9f76(0x161))){const _0x53df57=formatDate(fs[_0x3d9f76(0x169)](configbackuppath+_0x3e14fe[_0x3d9f76(0x292)])[_0x3d9f76(0x184)]);_0xe78ade[_0x3d9f76(0x2f4)]({'name':_0x3e14fe[_0x3d9f76(0x292)],'mtime':_0x53df57});}});if(_0x3aff11)io['to'](_0x3aff11)[_0x87b43a(0x185)]('backup-files',_0xe78ade);else return _0xe78ade;}async function backupConfigFiles(){const _0x8a12e1=_0x322f9d;await zipFiles('backup-full');const _0x5c15b0=getCleanTimeStamp();fs[_0x8a12e1(0x2c4)](zippath+_0x8a12e1(0x2ff),configbackuppath+('backup-full@'+_0x5c15b0+_0x8a12e1(0x161)));let _0x4f4e5c=fs[_0x8a12e1(0x1c3)](configbackuppath,{'withFileTypes':!![]});_0x4f4e5c['sort']((_0x2af15c,_0x19326c)=>_0x2af15c[_0x8a12e1(0x292)]<_0x19326c[_0x8a12e1(0x292)]?0x1:_0x19326c[_0x8a12e1(0x292)]<_0x2af15c[_0x8a12e1(0x292)]?-0x1:0x0),_0x4f4e5c['length']>maxBackups&&fs[_0x8a12e1(0x261)](configbackuppath+_0x4f4e5c[_0x4f4e5c[_0x8a12e1(0x2ca)]-0x1][_0x8a12e1(0x292)]);}function rotateLogFiles(){const _0x5f4649=_0x322f9d,_0x66732b=fs[_0x5f4649(0x169)](logspath+_0x5f4649(0x2d7)),_0xfcac9e=_0x66732b['size']/0x400;if(_0xfcac9e>0x64){let _0x279f74=fs[_0x5f4649(0x1c3)](logspath,{'withFileTypes':!![]});_0x279f74[_0x5f4649(0x207)]((_0xec8d78,_0x150978)=>_0xec8d78[_0x5f4649(0x292)]<_0x150978[_0x5f4649(0x292)]?0x1:_0x150978[_0x5f4649(0x292)]<_0xec8d78['name']?-0x1:0x0),_0x279f74['forEach'](_0x23f30d=>{const _0x95428b=_0x5f4649;if(_0x23f30d[_0x95428b(0x292)]==_0x95428b(0x14b))fs['copyFileSync'](logspath+_0x23f30d[_0x95428b(0x292)],logspath+_0x95428b(0x24e));if(_0x23f30d[_0x95428b(0x292)]==_0x95428b(0x1c1))fs[_0x95428b(0x2c4)](logspath+_0x23f30d[_0x95428b(0x292)],logspath+_0x95428b(0x14b));_0x23f30d['name']==_0x95428b(0x2d7)&&(fs[_0x95428b(0x2c4)](logspath+_0x23f30d[_0x95428b(0x292)],logspath+'output-001.log'),fs['writeFileSync'](logspath+_0x23f30d['name'],''));});}}async function zipFiles(_0x3d8444){const _0x284329=_0x322f9d;let _0x411a7c;if(_0x3d8444==_0x284329(0x240))_0x411a7c=logspath;if(_0x3d8444==_0x284329(0x2fb))_0x411a7c=configpath;if(_0x3d8444==_0x284329(0x291))_0x411a7c=configpath;let _0x16800b=fs[_0x284329(0x1c3)](_0x411a7c,{'withFileTypes':!![]});const _0x3ef760=new require(_0x284329(0x17b))();_0x16800b[_0x284329(0x229)](_0x19f160=>{const _0x3bc62b=_0x284329;if(!_0x19f160[_0x3bc62b(0x247)]()){let _0x474f15=fs[_0x3bc62b(0x293)](_0x411a7c+_0x19f160['name']);if(_0x3d8444==_0x3bc62b(0x2fb)){const _0x2ec696=/^bot-[0-9]{3}-config.json$/,_0x164bb7=_0x2ec696['test'](_0x19f160[_0x3bc62b(0x292)]);if(_0x164bb7){const _0x3db347=JSON[_0x3bc62b(0x2b8)](_0x474f15);if(_0x3db347[_0x3bc62b(0x2cb)][0x0]){_0x3db347[_0x3bc62b(0x2cb)][0x0][_0x3bc62b(0x163)]=_0x3bc62b(0x30c),_0x3db347[_0x3bc62b(0x2cb)][0x0][_0x3bc62b(0x297)]=_0x3bc62b(0x30c);if(_0x3db347[_0x3bc62b(0x2cb)][0x0][_0x3bc62b(0x309)])_0x3db347[_0x3bc62b(0x2cb)][0x0][_0x3bc62b(0x309)]=_0x3bc62b(0x30c);}_0x474f15=JSON[_0x3bc62b(0x1e5)](_0x3db347,null,0x2);}if(_0x19f160['name']==_0x3bc62b(0x155)){const _0x238bae=JSON[_0x3bc62b(0x2b8)](_0x474f15);if(_0x238bae['settings'][_0x3bc62b(0x182)])_0x238bae['settings'][_0x3bc62b(0x182)]=![];if(_0x238bae[_0x3bc62b(0x2e6)][_0x3bc62b(0x2fd)])_0x238bae['settings'][_0x3bc62b(0x2fd)]=_0x3bc62b(0x30c);if(_0x238bae[_0x3bc62b(0x2e6)]['telegramToken'])_0x238bae['settings'][_0x3bc62b(0x142)]='***';if(_0x238bae['settings'][_0x3bc62b(0x279)])_0x238bae[_0x3bc62b(0x2e6)][_0x3bc62b(0x279)]=null;if(_0x238bae['settings'][_0x3bc62b(0x296)])_0x238bae['settings'][_0x3bc62b(0x296)]=_0x3bc62b(0x30c);_0x474f15=JSON['stringify'](_0x238bae,null,0x2);}if(_0x19f160[_0x3bc62b(0x292)]!=_0x3bc62b(0x2a1))_0x3ef760[_0x3bc62b(0x134)](_0x19f160[_0x3bc62b(0x292)],_0x474f15);}else _0x3ef760[_0x3bc62b(0x134)](_0x19f160[_0x3bc62b(0x292)],_0x474f15);}});const _0x3793fd=_0x3ef760['generate']({'base64':![],'compression':'DEFLATE'});fs[_0x284329(0x2f3)](zippath+(_0x3d8444+_0x284329(0x161)),_0x3793fd,_0x284329(0x294));}async function unzipFile(_0x44b81d,_0x5d1072){const _0x5461d4=_0x322f9d;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x5461d4(0x229)](_0x2fca93=>{const _0x355d7a=_0x5461d4;if(!_0x2fca93[_0x355d7a(0x247)]())fs[_0x355d7a(0x25c)](configpath+_0x2fca93[_0x355d7a(0x292)]);});const _0x463f5e=fs[_0x5461d4(0x293)](_0x44b81d+_0x5d1072,_0x5461d4(0x294)),_0x446f76=new require(_0x5461d4(0x17b))(_0x463f5e,{'base64':![],'checkCRC32':!![]});Object[_0x5461d4(0x2ed)](_0x446f76[_0x5461d4(0x1cf)])[_0x5461d4(0x229)](_0x5a82c9=>{const _0x1c566a=_0x5461d4,_0x3b4ffd=_0x446f76[_0x1c566a(0x1cf)][_0x5a82c9];fs[_0x1c566a(0x2f3)](configpath+_0x3b4ffd[_0x1c566a(0x292)],_0x3b4ffd[_0x1c566a(0x230)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x5461d4(0x229)](_0x302219=>{const _0x1be1cb=_0x5461d4;if(!_0x302219[_0x1be1cb(0x247)]())fs['rmSync'](temppath+_0x302219[_0x1be1cb(0x292)]);}),logger['debug']('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x5461d4(0x1db)]({'restore':!![]},_0x4e0452=>{});}async function getPublicIp(){const _0x60f01f=_0x322f9d;try{const _0x4d3287=await axios[_0x60f01f(0x1eb)]('https://api.ipify.org?format=json');publicip=_0x4d3287['data']['ip'];}catch(_0x5d4312){}}async function triggerAnalytics(){const _0x56a579=_0x322f9d;if(!publicip)await getPublicIp();const _0x189896=getBotsWithMode();let _0x4e059c=0x0;_0x189896[_0x56a579(0x229)](_0x331493=>{const _0x42decb=_0x56a579;if(_0x331493['status']===_0x42decb(0x1e0))_0x4e059c++;});const _0x33490f=getBotExchanges();mixpanel[_0x56a579(0x310)](_0x56a579(0x195),{'distinct_id':settings[_0x56a579(0x126)],'ip':publicip,'version':serverversion,'numbots':_0x189896['length'],'numbotsenabled':_0x4e059c,'exchanges':_0x33490f,'environment':environment});}async function getMessages(){const _0x12bec2=_0x322f9d,_0x5b429c=_0x12bec2(0x2e1),_0x4473c0=new GraphQLClient(_0x5b429c),_0x91a793={'authorization':_0x12bec2(0x2fa)},_0x17840d=serverversion['split']('.'),_0x4648c9=_0x17840d[0x0]+'.'+_0x17840d[0x1],_0x14b2ea=Math[_0x12bec2(0x15f)](settings['lastmsgtelegram'],settings[_0x12bec2(0x213)]),_0xd58567={'last':parseInt(_0x14b2ea),'bbm':_0x4648c9},_0x5b607f=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4bf330;try{_0x4bf330=await _0x4473c0[_0x12bec2(0x150)](_0x5b607f,_0xd58567,_0x91a793);}catch(_0x1df173){}if(_0x4bf330&&_0x4bf330[_0x12bec2(0x233)]){let _0xb474a5=settings[_0x12bec2(0x27f)];newMessages=[];for(const _0x50be21 of _0x4bf330[_0x12bec2(0x233)]){newMessages['push'](_0x50be21);let _0x137b46=![];_0x50be21[_0x12bec2(0x220)]&&(updateSetting(_0x12bec2(0x246),_0x50be21[_0x12bec2(0x220)]),_0x137b46=isNewerVersion(serverversion,_0x50be21[_0x12bec2(0x220)])||serverversion==_0x50be21['bbvNew']);if(!_0x137b46&&_0x50be21[_0x12bec2(0x28d)]>_0xb474a5){if(_0x50be21[_0x12bec2(0x193)]==='any'||serverversion[_0x12bec2(0x30b)](_0x50be21[_0x12bec2(0x193)])){let _0x23b5e8=''+_0x50be21['title']+'\x0a\x0a'+_0x50be21[_0x12bec2(0x283)];const _0x3b4af2=await sendTelegramMsg(toTelegramMarkdown(_0x23b5e8),_0x12bec2(0x122));if(_0x3b4af2)_0xb474a5=_0x50be21[_0x12bec2(0x28d)];}}}updateAvailable=isNewerVersion(settings[_0x12bec2(0x246)],serverversion),updateSetting(_0x12bec2(0x27f),_0xb474a5),emitMessages();}}function emitMessages(){const _0x21d807=_0x322f9d,_0x2547b1=settings['lastmsgemitted'];let _0x1c268d=[];newMessages[_0x21d807(0x229)](_0x4ae55a=>{const _0x3c8073=_0x21d807;_0x4ae55a[_0x3c8073(0x28d)]>_0x2547b1&&_0x1c268d[_0x3c8073(0x2f4)](_0x4ae55a);}),_0x1c268d[_0x21d807(0x2ca)]>0x0&&getAllClients()['forEach'](_0x71b55f=>{const _0x16045a=_0x21d807;getSocket(_0x71b55f['id'])[_0x16045a(0x185)]('message',_0x1c268d);});}function confirmMessage(_0x4d1497){const _0x1b7aa4=_0x322f9d;updateSetting(_0x1b7aa4(0x213),Number(_0x4d1497));}function isNewerVersion(_0x8d6dcf,_0x29c385){const _0x9bfafa=_0x322f9d,_0x4ac040=_0x29c385['split']('.'),_0x1310ea=_0x8d6dcf[_0x9bfafa(0x1d6)]('.');for(var _0x160f26=0x0;_0x160f26<_0x1310ea[_0x9bfafa(0x2ca)];_0x160f26++){const _0x2ea341=~~_0x1310ea[_0x160f26],_0x1cc2ae=~~_0x4ac040[_0x160f26];if(_0x2ea341>_0x1cc2ae)return!![];if(_0x2ea341<_0x1cc2ae)return![];}return![];}function toTelegramMarkdown(_0x458330){const _0x31dce1=_0x322f9d,_0x12daa0=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x28bb4d=/\*{2}(.+?)\*{2}/gim;return _0x458330=_0x458330[_0x31dce1(0x2ab)](_0x12daa0,_0x31dce1(0x1a8))['replace'](_0x28bb4d,_0x31dce1(0x243)),_0x458330;}async function validateConfigFile(){const _0x26e0d6=_0x322f9d,_0x49f80a=dbConfig['get'](_0x26e0d6(0x157))[_0x26e0d6(0x1ff)](_0x26e0d6(0x20a))[_0x26e0d6(0x145)]()||[];if(_0x49f80a[_0x26e0d6(0x2ca)]==0x0){let _0x214fb8=0x0,_0x3d8c89=[];const _0xed0ce5=/^bot-([0-9]{3})-config.json$/,_0x1c540a=fs[_0x26e0d6(0x1c3)](configpath);_0x1c540a[_0x26e0d6(0x229)](_0x4d9cbc=>{const _0x443f9a=_0x26e0d6,_0x577216=_0xed0ce5[_0x443f9a(0x308)](_0x4d9cbc);if(_0x577216){const _0xcf5298=_0x577216[0x1];let _0x25a7c2=getBotAttributes(_0xcf5298);_0x3d8c89[_0x443f9a(0x2f4)]({'botID':_0xcf5298,'botname':_0x25a7c2[_0x443f9a(0x183)],'status':_0x443f9a(0x13b),'live':_0x443f9a(0x274)}),_0x214fb8++;}}),_0x214fb8!=0x0&&(dbConfig[_0x26e0d6(0x1eb)](_0x26e0d6(0x157))[_0x26e0d6(0x1ed)](_0x3d8c89)[_0x26e0d6(0x153)](),config=_0x3d8c89,restoredConfigFile=_0x214fb8);}}async function restoreConfigNotify(_0x148847){const _0x362f5e=_0x322f9d;let _0x5d510e;if(restoredConfigFile==0x1)_0x5d510e=_0x362f5e(0x1ac);else _0x5d510e=_0x362f5e(0x1d7);if(_0x148847)io['to'](_0x362f5e(0x178))[_0x362f5e(0x185)]('notification',_0x5d510e);else{logger['simple'](_0x362f5e(0x2d9)),logger[_0x362f5e(0x1a7)](_0x5d510e),logger[_0x362f5e(0x1a7)](_0x362f5e(0x2d9)),logger[_0x362f5e(0x1a7)]('');if(tgBot&&settings[_0x362f5e(0x279)]&&settings[_0x362f5e(0x1ca)]!=_0x362f5e(0x2dc))await sendTelegram(settings[_0x362f5e(0x279)],_0x362f5e(0x2e0)+_0x5d510e);}}function validateCredentials(_0xc9ac38,_0x508cd6){const _0x46d1cb=_0x322f9d;if(_0xc9ac38[_0x46d1cb(0x264)]==settings[_0x46d1cb(0x280)]&&bcrypt['compareSync'](_0xc9ac38[_0x46d1cb(0x276)],settings[_0x46d1cb(0x2fd)])){if(settings[_0x46d1cb(0x287)])return{'allow':![],'reason':_0x46d1cb(0x2d2),'token':null};else{const _0x45cc96=generateLoginToken(_0x508cd6);return{'allow':!![],'reason':_0x46d1cb(0x25a),'token':_0x45cc96};}}else return{'allow':![],'reason':_0x46d1cb(0x19c),'token':null};}function refreshToken(_0x3e0c77){const _0x36053f=_0x322f9d,_0x17c7a5=generateLoginToken(_0x3e0c77);return{'allow':!![],'reason':_0x36053f(0x25a),'token':_0x17c7a5};}function validateAccess(_0x1a8f98,_0x333184,_0x1baea0){const _0x1d985b=_0x322f9d,_0x46a1a5=_0x1baea0?_0x1baea0:devices[_0x333184]['ip'];let _0x7997a3;const _0x392b57=_0x3aafe8=>{const _0x495ebf=_0x422f;if(settings[_0x495ebf(0x182)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x333184)){const _0x3b55c6=generateLoginToken(_0x333184);return{'allow':!![],'reason':_0x495ebf(0x2e3),'token':_0x3b55c6};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x7997a3=validToken(_0x3aafe8,_0x333184),_0x7997a3[_0x495ebf(0x17f)](_0x495ebf(0x27e))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x3aafe8}:{'allow':![],'reason':_0x495ebf(0x253),'token':null};}else return{'allow':!![],'reason':_0x495ebf(0x211),'token':null};};if(settings[_0x1d985b(0x1e9)]){let _0x4ee03a=[...settings[_0x1d985b(0x198)],'::1',_0x1d985b(0x1c8),_0x1d985b(0x21e)];if(_0x4ee03a[_0x1d985b(0x1ee)](_0x46a1a5))return _0x392b57(_0x1a8f98);else{_0x7997a3=validToken(_0x1a8f98,_0x333184);if(_0x7997a3[_0x1d985b(0x17f)]('success'))return _0x392b57(_0x1a8f98);else{if(telegramIpApproved(_0x333184)){const _0x51cf0e=generateToken(_0x333184);return _0x7997a3=_0x392b57(_0x1a8f98),_0x7997a3['allow']?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x51cf0e}:_0x7997a3;}else return settings[_0x1d985b(0x30f)]?{'allow':![],'reason':_0x1d985b(0x2a2),'token':null}:{'allow':![],'reason':_0x1d985b(0x2a0),'token':null};}}}else return _0x392b57(_0x1a8f98);}function timelyDecrypt(_0x23265d,_0x595dc6,_0x1ffcad='@'){const _0x456690=_0x322f9d;if(_0x23265d)try{const _0x328314=crypt[_0x456690(0x1e1)](secure['privateKey'],_0x23265d)[_0x456690(0x283)],_0xba0343=_0x328314[_0x456690(0x1d6)](_0x1ffcad)[0x0],_0x421940=_0x328314[_0x456690(0x1d6)](_0x1ffcad)[0x1],_0x39cb60=new Date()[_0x456690(0x288)]();if(_0x595dc6){if(_0x39cb60-_0x421940<maxSecretAge*0x3e8)return _0xba0343;else return![];}else return _0xba0343;}catch(_0x36df5a){return![];}else return![];}const validToken=(_0x40da40,_0x4e5b44)=>{const _0xd42a3a=_0x322f9d,_0x111726=devices[_0x4e5b44]['ip'];if(!_0x40da40)return{'error':_0xd42a3a(0x170)};for(let _0x158977 of blacklist){if(_0x158977[_0xd42a3a(0x1bd)]==_0x40da40)return{'error':_0xd42a3a(0x176)};}let _0x7ed958;try{_0x7ed958=jwt[_0xd42a3a(0x2ae)](_0x40da40,secure[_0xd42a3a(0x188)]+_0x4e5b44);}catch{return{'error':_0xd42a3a(0x295)};}if(!_0x7ed958[_0xd42a3a(0x17f)](_0xd42a3a(0x23d))&&!_0x7ed958[_0xd42a3a(0x17f)](_0xd42a3a(0x264))||!_0x7ed958['hasOwnProperty'](_0xd42a3a(0x282)))return{'error':_0xd42a3a(0x147)};if(!_0x7ed958[_0xd42a3a(0x17f)](_0xd42a3a(0x264))&&_0x7ed958['hasOwnProperty'](_0xd42a3a(0x23d))){const {clientip:_0x1f0dc0}=_0x7ed958;return _0x111726==_0x1f0dc0?{'success':_0xd42a3a(0x1d0)}:{'error':_0xd42a3a(0x26a)};}else{if(_0x7ed958[_0xd42a3a(0x17f)]('username')&&_0x7ed958[_0xd42a3a(0x17f)](_0xd42a3a(0x23d))){const {username:_0x2b2cf4,clientip:_0x41a626}=_0x7ed958;return settings['bbUsername']==_0x2b2cf4&&_0x111726==_0x41a626?{'success':_0xd42a3a(0x1d0)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x1a00c1=>{const _0x3bd2ac=_0x322f9d;if(_0x1a00c1){const _0x5df298=devices[_0x1a00c1]['ip'];return jwt[_0x3bd2ac(0x20b)]({'username':settings[_0x3bd2ac(0x280)],'clientip':_0x5df298},secure[_0x3bd2ac(0x188)]+_0x1a00c1,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x223569=>{const _0x31406b=_0x322f9d;if(_0x223569){const _0x4e6c7a=devices[_0x223569]['ip'];return jwt[_0x31406b(0x20b)]({'clientip':_0x4e6c7a},secure[_0x31406b(0x188)]+_0x223569,{'expiresIn':devices[_0x223569][_0x31406b(0x141)][_0x31406b(0x2d8)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x337459=>{const _0xe162e4=_0x322f9d;let _0x4d8d89=![];return devices[_0x337459][_0xe162e4(0x141)]&&devices[_0x337459][_0xe162e4(0x141)]['expiry']!='reject'&&(_0x4d8d89=devices[_0x337459]['telegramIpApproval'][_0xe162e4(0x23d)]==devices[_0x337459]['ip']&&new Date()[_0xe162e4(0x288)]()-devices[_0x337459]['telegramIpApproval'][_0xe162e4(0x281)]<devices[_0x337459]['telegramIpApproval'][_0xe162e4(0x2d8)]*0x3c*0x3e8),_0x4d8d89;},telegram2FaApproved=_0xa2eb57=>{const _0x1be45d=_0x322f9d;let _0x22a64b=![];return devices[_0xa2eb57][_0x1be45d(0x1cc)]&&devices[_0xa2eb57][_0x1be45d(0x1cc)][_0x1be45d(0x2d8)]!=_0x1be45d(0x1a5)&&(_0x22a64b=devices[_0xa2eb57][_0x1be45d(0x1cc)][_0x1be45d(0x23d)]==devices[_0xa2eb57]['ip']&&new Date()[_0x1be45d(0x288)]()-devices[_0xa2eb57]['telegram2FaApproval'][_0x1be45d(0x281)]<devices[_0xa2eb57]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x22a64b;},normalizeIP=_0x2d77ad=>{const _0x951580=_0x322f9d;let _0x1efb0e=null,_0x15d0d4=null;if(ipaddr[_0x951580(0x1a9)](_0x2d77ad)){const _0x56cff6=ipaddr['parse'](_0x2d77ad);_0x56cff6['kind']()===_0x951580(0x299)?(_0x56cff6[_0x951580(0x22e)]()&&(_0x1efb0e=_0x56cff6[_0x951580(0x1d2)]()['toString']()),_0x15d0d4=_0x56cff6[_0x951580(0x26f)]()):(_0x1efb0e=_0x56cff6[_0x951580(0x26f)](),_0x15d0d4=_0x56cff6['toIPv4MappedAddress']()['toString']());}return{'show':_0x1efb0e?_0x1efb0e:_0x15d0d4,'store':_0x15d0d4};};function formatDate(_0x1104ff){const _0x35d001=_0x322f9d;return _0x1104ff['getFullYear']()+'/'+(_0x1104ff[_0x35d001(0x1e2)]()+0x1)[_0x35d001(0x26f)]()['padStart'](0x2,'0')+'/'+_0x1104ff[_0x35d001(0x28a)]()['toString']()[_0x35d001(0x1ec)](0x2,'0')+'\x20'+_0x1104ff[_0x35d001(0x1a3)]()[_0x35d001(0x26f)]()['padStart'](0x2,'0')+':'+_0x1104ff[_0x35d001(0x201)]()['toString']()[_0x35d001(0x1ec)](0x2,'0')+':'+_0x1104ff[_0x35d001(0x168)]()['toString']()[_0x35d001(0x1ec)](0x2,'0');}function sleep(_0x2eaa1a){return new Promise(_0x2b95c9=>setTimeout(_0x2b95c9,_0x2eaa1a));}