const _0x418075=_0x5769;(function(_0x1c8d99,_0x1bb17c){const _0x47e51a=_0x5769,_0xd344cb=_0x1c8d99();while(!![]){try{const _0x163b56=parseInt(_0x47e51a(0x233))/0x1*(parseInt(_0x47e51a(0x17e))/0x2)+parseInt(_0x47e51a(0x22f))/0x3+-parseInt(_0x47e51a(0x24b))/0x4+-parseInt(_0x47e51a(0x182))/0x5+parseInt(_0x47e51a(0x144))/0x6+-parseInt(_0x47e51a(0x1d1))/0x7+parseInt(_0x47e51a(0x25b))/0x8;if(_0x163b56===_0x1bb17c)break;else _0xd344cb['push'](_0xd344cb['shift']());}catch(_0x2bf760){_0xd344cb['push'](_0xd344cb['shift']());}}}(_0x2335,0xb7051));const _0x371de3=function(){let _0x22e0ca=!![];return function(_0x4ba492,_0x4becb3){const _0x4b7f55=_0x22e0ca?function(){if(_0x4becb3){const _0x21dd03=_0x4becb3['apply'](_0x4ba492,arguments);return _0x4becb3=null,_0x21dd03;}}:function(){};return _0x22e0ca=![],_0x4b7f55;};}(),_0x319471=_0x371de3(this,function(){const _0x155973=_0x5769;return _0x319471['toString']()[_0x155973(0x18e)](_0x155973(0x246))[_0x155973(0x13c)]()[_0x155973(0x1c3)](_0x319471)[_0x155973(0x18e)](_0x155973(0x246));});_0x319471();'use strict';process[_0x418075(0x1ea)][_0x418075(0x21b)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x418075(0x1ae)),low=require(_0x418075(0x11e)),FileSync=require(_0x418075(0x212)),path=require(_0x418075(0x295)),crypto=require('crypto'),forge=require(_0x418075(0x226)),bcrypt=require(_0x418075(0x1e8)),jwt=require('jsonwebtoken'),ipaddr=require(_0x418075(0x12c)),argv=require(_0x418075(0xaf))(process[_0x418075(0x1ca)][_0x418075(0x22e)](0x2))[_0x418075(0x1ca)],uuidRandom=require(_0x418075(0x11b)),{Telegraf,Markup}=require(_0x418075(0x100)),Mixpanel=require(_0x418075(0x15e)),axios=require(_0x418075(0xda)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x418075(0x105)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require(_0x418075(0xa8)),PORT=argv['port']||_0x418075(0x249),pattern=/^[0-9]{2,4}$/;!pattern[_0x418075(0x195)](PORT)&&(console['log']('Error:\x20Invalid\x20argument\x20'+PORT+_0x418075(0x1db)),process[_0x418075(0x107)](0x1));function _0x2335(){const _0x44e5b6=['endsWith','uuid','login','No\x20bots\x20running\x20right\x20now','use','-events.json',':\x20Bot\x20Mgr\x20>\x20','startsWith','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','lastmsgtelegram','mixpanel','environment','auto','static','access','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','telegramEvents','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','copyFileSync','\x20|\x20','alias','onepagemode','address\x20already\x20in\x20use','timestamp','notification','entries','getMonth','/:bot/portfolio','generateKeyPair','backup','apiPassword','-----------------------------------------------------------------------------------','running','Starting\x20Balance\x20Bot\x20update','login\x20token\x20generated','Invalid\x20authentication\x20token\x20(2)','Notifications\x20disabled\x0a','Password\x20has\x20been\x20reset\x20to:\x20','node','inlineKeyboard','sendPortfolioTelegram','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','2268396crDVRt','logs','bot.js','Unauthorized\x20attempt\x20to\x20download\x20','3697350SEvuOy','config_orders','bbvNew','emitHistory','existsSync','/on\x20-\x20start\x20bot(s)\x0a','backup-full@','keys','build2','init','mode','expiry','search','#RES#\x20if\x20running\x20locally\x0a','isIPv4MappedAddress','#RES#','SIGTERM','Restore\x20backup\x20file\x20','output-000.log','test','config/','handshake',')\x20|\x20Bot\x20','30\x20min','-config.json','store-configuration','publicKeyToPem','Starting\x20new\x20bot\x20|\x20Bot\x20','mkdirSync','inherit','secure','ETH','start','write','accept','getDate','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','getUTCHours','pidRefreshToken','SIGINT','params','command','event','sort','date-fns','version.json','Server','portfolio','remoteAddress','sortBy','sockets','log','_nsps','Orders','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','any','login\x20required','on_','kind','************','lastmsgemitted','button','Your\x20installation\x20is\x20already\x20up\x20to\x20date','new','timeshift','constructor','host','http','config','build','Allow\x20login\x20from\x20IP\x20address\x20','store','argv','Setting\x20access:\x20','started','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Unauthorized\x20attempt\x20to\x20get\x20messages','request','close','9225286StDSiX','whitelistEnabled','bot-','filter','output-002.log','2FA\x20required','\x20mode','Backup\x20file\x20uploaded','chat','resetpw_no',',\x20must\x20be\x20a\x204\x20digit\x20number','error','sendMetricsTelegram','All','::ffff:127.0.0.1','-results.json','update-bot','sendFile','headers','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','once','resetpw_yes','Ok,\x20will\x20send\x20order\x20notifications\x20only','bcryptjs','send','env','bb-secure.json','\x20(2)','telegramToken','/disable\x20-\x20disable\x20notifications\x0a','Failed\x20to\x20download\x20','Error\x20removing\x20old\x20backup\x20files:','Notifications\x20disabled','Logged\x20out\x20user\x20...','User\x20has\x20been\x20validated','clientip','Temporary\x20access\x20rejected','socket.io','getMinutes','***','getHours','title','exchange','\x20>\x20','latestversion','compareSync','/enable\x20-\x20enable\x20notifications\x0a','bots','Restoring\x20bot(s)\x20from\x20backup','0.0.0','Bot\x20Mgr\x20>\x20','bb-settings.json','\x1b[31m','Error\x20while\x20deleting\x20config\x20files:\x20','file','logout','hasOwnProperty','/names\x20-\x20show\x20bot\x20names\x0a','status\x20code\x20401','args','bbPassword','manual','encryptedUuid','bb/','get-backup-files','lowdb/adapters/FileSync','updatebotmanager',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','/start','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','output-003.log','\x1b[36m','remove','All\x20bots\x20running\x20right\x20now','NTBA_FIX_319','version','telegramChatId','cloneDeep','placeOrder','Invalid\x20username\x20or\x20IP\x20address','toggleBotMode','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Starting\x20(','toggle_','sign','node-forge','No\x20authentication\x20token','invalid\x20credentials','fork','push','function','$1_$2_$3','find','slice','1869105CUdjpM','Enabled\x20Bot\x20','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','tempaccess_15_','1liWcna','Unauthorized\x20attempt\x20to\x20log\x20out','clients','reload','disconnect','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','hex','\x20minutes','status','socket','headless','bot','telegram','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','marketcapApi','metrics','rsa','stringify','(((.+)+)+)+$','off','https://api.ipify.org?format=json','3000','Restore\x20process\x20aborted','1346376AWKvhJ','split','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','reinstall','loadAsync','decrypt','settings','backupfile','Notifications\x20enabled\x0a','delete-bot','show-config','6b67f3d61ee94b8f5c80b4affef4c4d9','blacklist','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','temporary\x20access\x20not\x20allowed','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','1993712djeogZ','login\x20not\x20required','secret','reject','Notifications\x20enabled','async','|@|','5\x20min','userid','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','tempaccess_30_','privateKeyFromPem','f2aRequired','disable','exp','tempaccess_5_','reply','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','CoinMarketCap\x20API\x20key\x20validated','track','loginRequired','replace','randomBytes','hashSync','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','randomFillSync','pidExpireLogin','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','showname','production','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','sha256','output-001.log','\x20to\x20','Unauthorized\x20attempt\x20to\x20add\x20bot','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','createServer','disabled','\x20|\x20client:\x20...','family','botname','cancelLoading','Unauthorized\x20attempt\x20to\x20get\x20events','.zip','Network\x20Interfaces:','readFileSync','Node.js\x20v','size','Access\x20enabled\x20for\x20','Starting\x20#RED#Balance\x20Bot\x20v','simple','login2fa_','create','Restarting\x20Bot\x20','Unauthorized\x20login\x20attempt\x20(timeout)','removeAllListeners','reset-history','path','name','get-portfolio',')\x20\x20\x20|\x20Bot\x20','Bot\x20','temp/','File\x20uploaded','settings.','parse','versions','showConfig','includes','index.html','writeFileSync','length','jszip','restart','token','debug','(staging)','toggle','referer','yargs/yargs','forEach','readdirSync','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','generateAsync','post','temporaryAccessAllowed','emit','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','restore_no_','RSA-OAEP','yes','add-bot','live','restart_','/metrics\x20-\x20show\x20bot\x20performance\x0a','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','get-logs','isDirectory','set','logs/','unlinkSync','action','backup-full.zip','listen','2FA\x20login\x20rejected','callback','pki','access\x20timeout','verify','password','string','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','internal','bbvReceive','/:bot/support','success','join','reinstall-bb','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','full','statSync','axios','allow','login2fa_reject_','api-eu.mixpanel.com','getFullYear','Alerts','show','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','\x20|\x20user:\x20...','alerts','/:bot/history','IPv4','stop','tkn','temporary\x20token\x20generated','telegram2FaApproval','new-disabled','padStart','kill','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','tempaccess_reject_','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','getSeconds','botID','zip/','Ok,\x20will\x20send\x20alert\x20notifications\x20only','/:bot/performance','15\x20min','defaults','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','editMessageReplyMarkup','reason','connection','publicKey','enabled','launch','ipc','type','telegraf','/status\x20-\x20show\x20bot(s)\x20status\x0a','apiKey','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Unauthorized\x20attempt\x20to\x20confirm\x20message','util','uncaughtException','exit','number','from','getTime','private','catch','files','-performance.json','/:bot/configuration','match','telegramUsername','message','createWriteStream','/update\x20-\x20update\x20Balance\x20Bot\x0a','Invalid\x20authentication\x20token\x20(1)','[ip-address]','#RES#\x20','get','format','sendMessage','uuid-random','telegrammsg','privateKeyToPem','lowdb','get-starting-balances','update','decode64','download','config_alerts','reinstall_yes','backup-files','off_','Session\x20expired\x20for\x20user\x20...','Telegraf\x20error:','store-headless','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','logged\x20out','ipaddr.js','code','update-bb','Backup\x20file\x20unzipped\x20and\x20stored','backup-full','assign','text','connected','bbUsername','/:bot/coins','You\x20can\x20use\x20the\x20following\x20commands:\x0a','telegramEnabled','value','backup/','getPortfolio','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','toString','\x1b[33m','HTML','orders','Unauthorized\x20attempt\x20to\x20update\x20bot','Unauthorized\x20attempt\x20to\x20delete\x20bot','127.0.0.1','telegramIpApproval','6822984ZDEvgt','rmSync','privateKey','/upload-backup','botmanager','config_all','server','messages','2FA\x20login\x20required','Unauthorized\x20attempt\x20to\x20update\x20settings','username','2FA\x20login\x20token\x20generated','all','stopped','get-messages','reinstall_no'];_0x2335=function(){return _0x44e5b6;};return _0x2335();}const HOST=argv[_0x418075(0x1c4)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x418075(0xa2)][_0x418075(0x17a)];let bbpath=_0x418075(0x210),bbpath2='';const botfile=_0x418075(0x180),configfile='bb-config.json',settingsfile=_0x418075(0x204),securefile=_0x418075(0x1eb),environment=require('./'+bbpath2+_0x418075(0x1af))[_0x418075(0x15f)]||_0x418075(0x279),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x418075(0x186)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x418075(0x235)),configpath=userID?bbpath+_0x418075(0x196)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x418075(0x139),logspath=userID?bbpath+_0x418075(0xc4)+userID+'/':bbpath+_0x418075(0xc4),zippath=userID?bbpath+_0x418075(0xf2)+userID+'/':bbpath+_0x418075(0xf2),loggerfile=fs[_0x418075(0x113)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x418075(0x9e);!fs[_0x418075(0x186)](configpath)&&fs[_0x418075(0x19e)](configpath);!fs[_0x418075(0x186)](configbackuppath)&&fs[_0x418075(0x19e)](configbackuppath);!fs[_0x418075(0x186)](logspath)&&fs[_0x418075(0x19e)](logspath);!fs[_0x418075(0x186)](zippath)&&fs[_0x418075(0x19e)](zippath);!fs[_0x418075(0x186)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x418075(0x1a3)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x418075(0x202),'onepagemode':![],'marketcapApi':''}})[_0x418075(0x1a3)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x418075(0xf6)]({'secure':{},'blacklist':[]})['write']();const saltRounds=0xa,mixpanel=Mixpanel[_0x418075(0x18b)](_0x418075(0x256),{'host':_0x418075(0xdd)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x418075(0x1ed)]&&(settings[_0x418075(0x1ed)]!=''&&settings[_0x418075(0x1ed)]!=_0x418075(0x1f8))&&settings['telegramUsername']&&settings[_0x418075(0x111)]!='')initTelegram();const parseColor=(_0x3aace5,_0x3fc78d)=>{const _0x1730d4=_0x418075,_0x49d6cd=/#[A-Z]{3}#/g;if(typeof _0x3aace5==_0x1730d4(0xcf)){!_0x3fc78d?_0x3aace5=_0x3aace5['replace'](_0x49d6cd,''):(_0x3aace5=_0x3aace5[_0x1730d4(0x270)](/#BLU#/g,'\x1b[34m'),_0x3aace5=_0x3aace5[_0x1730d4(0x270)](/#RED#/g,_0x1730d4(0x205)),_0x3aace5=_0x3aace5[_0x1730d4(0x270)](/#YEL#/g,_0x1730d4(0x13d)),_0x3aace5=_0x3aace5['replace'](/#MAG#/g,'\x1b[35m'),_0x3aace5=_0x3aace5[_0x1730d4(0x270)](/#CYA#/g,_0x1730d4(0x218)),_0x3aace5=_0x3aace5[_0x1730d4(0x270)](/#RES#/g,'\x1b[0m'));;}return _0x3aace5;},logger={'screen':_0x3cfd07=>{const _0x55f59e=_0x418075;console[_0x55f59e(0x1b5)](parseColor(_0x3cfd07,!![]));},'simple':_0x58ca9b=>{const _0xb59a91=_0x418075;console[_0xb59a91(0x1b5)](parseColor(_0x58ca9b,!![])),loggerfile[_0xb59a91(0x1a3)](util['format'](parseColor(_0x58ca9b,![]))+'\x0a');},'full':async _0x3b7cf8=>{const _0x24d860=_0x418075,_0x1fc874=getTimeStamp()+_0x24d860(0x15a)+_0x3b7cf8;console['log'](parseColor(_0x1fc874,!![])),loggerfile[_0x24d860(0x1a3)](util[_0x24d860(0x119)](parseColor(_0x1fc874,![]))+'\x0a');if(tgBot&&settings[_0x24d860(0x21d)]&&settings[_0x24d860(0x164)]!=_0x24d860(0x13f))await sendTelegram(settings[_0x24d860(0x21d)],_0x24d860(0x203)+parseColor(_0x3b7cf8,![]));},'debug':async(_0x15060d,_0x403b1b='')=>{const _0x3ac2b6=_0x418075,_0xabd037=getTimeStamp()+_0x3ac2b6(0x214)+_0x15060d;if(debugging)console[_0x3ac2b6(0x1b5)](parseColor(_0xabd037,!![]));loggerfile[_0x3ac2b6(0x1a3)](util['format'](parseColor(_0xabd037,![]))+'\x0a');if(_0x403b1b){if(debugging)console[_0x3ac2b6(0x1b5)](_0x403b1b);loggerfile[_0x3ac2b6(0x1a3)](util['format'](_0x403b1b)+'\x0a');}}};let terminating=![];process['on'](_0x418075(0x106),function(_0x594a8a){const _0xd0c82d=_0x418075;_0x594a8a[_0xd0c82d(0x13c)]()[_0xd0c82d(0xa4)](_0xd0c82d(0x16a))?(logger[_0xd0c82d(0x28e)](_0xd0c82d(0xb8)+_0x594a8a['port']+_0xd0c82d(0x191)),process[_0xd0c82d(0x1e9)]({'terminate':!![]},_0x3c0837=>{})):logger[_0xd0c82d(0x28e)](_0x594a8a);}),process['on'](_0x418075(0x107),()=>{const _0x8fbe36=_0x418075;stopAllBots(),process[_0x8fbe36(0x107)](0x0);}),process['on'](_0x418075(0x192),()=>{const _0x5dafe5=_0x418075;stopAllBots(),process[_0x5dafe5(0x107)](0x0);}),process['on']('SIGINT',()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x418075(0x1af))[_0x418075(0x21c)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x418075(0x1c5))[_0x418075(0x280)](app);app[_0x418075(0x158)](fileUpload({'useTempFiles':!![]})),app[_0x418075(0x118)]('/download/:type',async(_0x30b151,_0x35a487)=>{const _0x38afb4=_0x418075,_0xaaa9c=_0x30b151[_0x38afb4(0x1aa)][_0x38afb4(0xff)],_0x248acc=getClientsWithBotID(_0x38afb4(0x148)),_0x58c5e7=_0x30b151['headers'][_0x38afb4(0x155)],_0x4c8454=timelyDecrypt(_0x58c5e7,![]),_0x3b222b=_0x248acc[_0x38afb4(0x22d)](_0x59ca03=>_0x59ca03['uuid']==_0x4c8454);if(_0x3b222b){const _0x22eb88=normalizeIP(_0x30b151[_0x38afb4(0x23d)][_0x38afb4(0x1b2)])[_0x38afb4(0x1c9)],_0x28fde0=_0x30b151[_0x38afb4(0x1e3)][_0x38afb4(0xe7)];if(validateAccess(_0x28fde0,_0x4c8454,_0x22eb88)[_0x38afb4(0xdb)])_0xaaa9c==_0x38afb4(0x171)&&await backupConfigFiles(),await zipFiles(_0xaaa9c),_0x35a487[_0x38afb4(0x122)](zippath+(_0xaaa9c+'.zip'),_0x1f045e=>{const _0x5c073a=_0x38afb4;_0x1f045e&&(logger[_0x5c073a(0xd8)](_0x5c073a(0x1ef)+_0xaaa9c),logger[_0x5c073a(0x28e)](_0x1f045e));});else logger[_0x38afb4(0xd8)](_0x38afb4(0x181)+_0xaaa9c+'\x20(1)');}else logger[_0x38afb4(0xd8)](_0x38afb4(0x181)+_0xaaa9c+_0x38afb4(0x1ec));}),app[_0x418075(0xb4)](_0x418075(0x147),async(_0x1bfadc,_0xace9ee)=>{const _0x49c086=_0x418075,_0x157636=getClientsWithBotID(_0x49c086(0x148)),_0x2f0a36=_0x1bfadc[_0x49c086(0x1e3)][_0x49c086(0x155)],_0x36fe77=timelyDecrypt(_0x2f0a36,![]),_0x513134=_0x157636[_0x49c086(0x22d)](_0x73c975=>_0x73c975[_0x49c086(0x155)]==_0x36fe77);logger[_0x49c086(0xab)](_0x49c086(0x1d8));if(_0x513134){const _0x47010e=normalizeIP(_0x1bfadc[_0x49c086(0x23d)][_0x49c086(0x1b2)])[_0x49c086(0x1c9)],_0x3f6c4c=_0x1bfadc[_0x49c086(0x1e3)][_0x49c086(0xe7)];if(validateAccess(_0x3f6c4c,_0x36fe77,_0x47010e)[_0x49c086(0xdb)]){if(_0x1bfadc[_0x49c086(0x10d)]){const _0x58c5f9=_0x1bfadc[_0x49c086(0x10d)][_0x49c086(0x252)];await _0x58c5f9['mv'](temppath+_0x58c5f9[_0x49c086(0x296)]),_0xace9ee[_0x49c086(0x1e9)]({'status':!![],'message':_0x49c086(0x9f)});const _0x40f02e=getBotsWithMode();_0x40f02e['length']>0x0?confirmRestore(temppath,_0x58c5f9[_0x49c086(0x296)]):unzipFile(temppath,_0x58c5f9[_0x49c086(0x296)]);}}else logger[_0x49c086(0xd8)](_0x49c086(0x274));}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x418075(0x158)](express[_0x418075(0x161)](path[_0x418075(0xd5)](__dirname,bbpath2,_0x418075(0x18a)))),app[_0x418075(0x158)](express[_0x418075(0x161)](path['join'](__dirname,bbpath2,_0x418075(0x1c7)))),app['get']('/',function(_0x2a9b6,_0x35bffa){const _0x2f67d4=_0x418075;_0x35bffa['sendFile'](path[_0x2f67d4(0xd5)](__dirname,bbpath2,'build2',_0x2f67d4(0xa5)));}),app[_0x418075(0x118)]('/:bot',function(_0x1bb33b,_0x3785ec){const _0x158d4b=_0x418075;_0x3785ec[_0x158d4b(0x1e2)](path['join'](__dirname,bbpath2,_0x158d4b(0x1c7),'index.html'));}),app[_0x418075(0x118)](_0x418075(0x16f),(_0x374c4d,_0x2acfbd)=>{const _0xd986a2=_0x418075;_0x2acfbd[_0xd986a2(0x1e2)](path[_0xd986a2(0xd5)](__dirname,bbpath2,_0xd986a2(0x1c7),_0xd986a2(0xa5)));}),app['get'](_0x418075(0xf4),(_0x5d8633,_0x10951d)=>{const _0x3450b9=_0x418075;_0x10951d['sendFile'](path[_0x3450b9(0xd5)](__dirname,bbpath2,_0x3450b9(0x1c7),'index.html'));}),app[_0x418075(0x118)](_0x418075(0x135),(_0x42ba90,_0x4a7764)=>{const _0x34bda7=_0x418075;_0x4a7764[_0x34bda7(0x1e2)](path['join'](__dirname,bbpath2,_0x34bda7(0x1c7),_0x34bda7(0xa5)));}),app[_0x418075(0x118)](_0x418075(0xe4),(_0x2756f7,_0x4423c3)=>{const _0x4df735=_0x418075;_0x4423c3[_0x4df735(0x1e2)](path[_0x4df735(0xd5)](__dirname,bbpath2,_0x4df735(0x1c7),_0x4df735(0xa5)));}),app[_0x418075(0x118)](_0x418075(0x10f),(_0x48be41,_0x59a25e)=>{const _0x52bd81=_0x418075;_0x59a25e[_0x52bd81(0x1e2)](path[_0x52bd81(0xd5)](__dirname,bbpath2,_0x52bd81(0x1c7),_0x52bd81(0xa5)));}),app[_0x418075(0x118)](_0x418075(0xd3),(_0x17f6e3,_0x3b4903)=>{const _0x462fe3=_0x418075;_0x3b4903[_0x462fe3(0x1e2)](path['join'](__dirname,bbpath2,_0x462fe3(0x1c7),_0x462fe3(0xa5)));});if(HOST)http[_0x418075(0xc8)](PORT,HOST);else http[_0x418075(0xc8)](PORT);const io=require(_0x418075(0x1f6))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x528603=_0x418075;let _0x291ecb=_0x528603(0x116);const _0x10ea8b=networkInterfaces(),_0x15d23c={};for(const _0x383b14 of Object[_0x528603(0x189)](_0x10ea8b)){for(const _0x5542bb of _0x10ea8b[_0x383b14]){if((_0x5542bb[_0x528603(0x283)]==_0x528603(0xe5)||_0x5542bb[_0x528603(0x283)]==0x4)&&!_0x5542bb[_0x528603(0xd1)]){const _0x167ee6=ipaddr[_0x528603(0xa1)](_0x5542bb['address'])['range']();_0x167ee6!=_0x528603(0x10b)&&(!_0x15d23c[_0x383b14]&&(_0x15d23c[_0x383b14]=[]),_0x15d23c[_0x383b14]['push'](_0x5542bb['address']),_0x291ecb=_0x5542bb['address']);}}}return{'serverip':_0x291ecb,'netinterfaces':_0x15d23c};}async function startServer(){const _0x3bf0f2=_0x418075,{serverip:_0x42d4b3,netinterfaces:_0x3435f0}=getServerIP();logger[_0x3bf0f2(0x28e)](''),logger[_0x3bf0f2(0x28e)](_0x3bf0f2(0x173)),await logger[_0x3bf0f2(0xd8)](_0x3bf0f2(0x28d)+serverversion+_0x3bf0f2(0x117)+(environment=='staging'?_0x3bf0f2(0xac):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x3bf0f2(0x18f))+('=>\x20Go\x20to\x20#CYA#http://'+_0x42d4b3+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x3bf0f2(0x28e)]('-----------------------------------------------------------------------------------');if(config['length']!=0x0)for(const _0xa780ad of config){const _0xeab34c=_0xa780ad['mode']==_0x3bf0f2(0x160)?'a':'m';if(_0xa780ad[_0x3bf0f2(0x23c)]==_0x3bf0f2(0xfc)||_0xa780ad[_0x3bf0f2(0x23c)]=='new')await logger[_0x3bf0f2(0xd8)](_0x3bf0f2(0x223)+_0xeab34c+_0x3bf0f2(0x198)+_0xa780ad[_0x3bf0f2(0xf1)]+_0x3bf0f2(0x167)+_0xa780ad[_0x3bf0f2(0x284)]),startBot([_0xa780ad['botID'],userID],{'cwd':bbpath},function(_0x359be9){const _0x55d0a3=_0x3bf0f2;if(_0x359be9)logger[_0x55d0a3(0xd8)](_0x359be9);});else(_0xa780ad[_0x3bf0f2(0x23c)]==_0x3bf0f2(0x281)||_0xa780ad['status']=='new-disabled')&&await logger[_0x3bf0f2(0xd8)]('Idling\x20('+_0xeab34c+_0x3bf0f2(0x9c)+_0xa780ad[_0x3bf0f2(0xf1)]+_0x3bf0f2(0x167)+_0xa780ad[_0x3bf0f2(0x284)]);}else!newBot&&logger[_0x3bf0f2(0x28e)](_0x3bf0f2(0xd7));if(newBot)addBot();logger['simple'](_0x3bf0f2(0x173)),logger[_0x3bf0f2(0x28e)](''),await logger[_0x3bf0f2(0xab)](_0x3bf0f2(0x28a)+nodeversion),await logger[_0x3bf0f2(0xab)](_0x3bf0f2(0x288),_0x3435f0);}function startSocket(){const _0x3811c9=_0x418075;io['on'](_0x3811c9(0xfa),_0x2591a8=>{const _0x1a33f0=_0x3811c9;let _0x43d6f4,_0x4401ba,_0x54b246,_0x4a551e,_0x1ea5c1;const _0x3a0fcb=_0x2591a8[_0x1a33f0(0x197)][_0x1a33f0(0x1e3)][_0x1a33f0(0xae)];_0x4401ba=_0x3a0fcb[_0x1a33f0(0x110)](/bot[0-9]{3}/);if(_0x4401ba)_0x54b246=_0x4401ba[0x0][_0x1a33f0(0x110)](/[0-9]{3}/);if(_0x54b246)_0x43d6f4=_0x54b246[0x0];else _0x43d6f4=_0x1a33f0(0x148);const _0xb1d100=_0x2591a8['handshake']['auth'][_0x1a33f0(0x20f)];if(!_0xb1d100)_0x2591a8[_0x1a33f0(0xb6)](_0x1a33f0(0x23c),{'publicKey':secure['publicKey']});else{_0x4a551e=timelyDecrypt(_0xb1d100,![]);if(!_0x4a551e)_0x2591a8['emit'](_0x1a33f0(0x23c),{'publicKey':secure['publicKey']});else{_0x1ea5c1=normalizeIP(_0x2591a8['conn'][_0x1a33f0(0x1b2)])[_0x1a33f0(0x1c9)];if(!devices[_0x4a551e])devices[_0x4a551e]={'uuid':_0x4a551e,'access':{'token':null}};devices[_0x4a551e]['ip']=_0x1ea5c1;const _0x51ff48=addClient(_0x2591a8['id'],_0x4a551e,_0x43d6f4);setAccess(_0x51ff48),emitMessages(),_0x2591a8['on'](_0x1a33f0(0x156),_0xc36b01=>{const _0xdff8c6=_0x1a33f0,_0x26a073=timelyDecrypt(_0xc36b01[_0xdff8c6(0xce)],!![],_0xdff8c6(0x261));if(_0x26a073){_0xc36b01={'username':_0xc36b01[_0xdff8c6(0x14e)],'password':_0x26a073},devices[_0x4a551e][_0xdff8c6(0x162)]=validateCredentials(_0xc36b01,_0x4a551e);if(devices[_0x4a551e][_0xdff8c6(0x162)][_0xdff8c6(0xdb)]==![]&&devices[_0x4a551e][_0xdff8c6(0x162)][_0xdff8c6(0xf9)]==_0xdff8c6(0x14c))_0x2591a8[_0xdff8c6(0xb6)](_0xdff8c6(0x23c),{'access':devices[_0x4a551e][_0xdff8c6(0x162)]}),loginAccess2FA(_0x4a551e,_0x1ea5c1);else{if(devices[_0x4a551e][_0xdff8c6(0x162)][_0xdff8c6(0xdb)]==![]&&devices[_0x4a551e][_0xdff8c6(0x162)]['reason']==_0xdff8c6(0x228))_0x2591a8[_0xdff8c6(0xb6)](_0xdff8c6(0x23c),{'access':devices[_0x4a551e][_0xdff8c6(0x162)]});else devices[_0x4a551e]['access'][_0xdff8c6(0xdb)]&&devices[_0x4a551e][_0xdff8c6(0x162)][_0xdff8c6(0xf9)]==_0xdff8c6(0x176)&&(getClientsWithUuid(_0x4a551e)[_0xdff8c6(0xb0)](_0x204914=>{setAccess(_0x204914);}),logger['debug']('Logged\x20in\x20user\x20...'+_0x4a551e[_0xdff8c6(0x22e)](-0x8)),setTokenRefresh(_0x4a551e),setSessionTimeout(_0xdff8c6(0x156),_0x4a551e));}}else logger[_0xdff8c6(0xd8)](_0xdff8c6(0x292));}),_0x2591a8['on']('reset-password',()=>{resetPassword();}),_0x2591a8['on'](_0x1a33f0(0x237),_0x17e87c=>{removeClient(_0x2591a8['id']);}),_0x43d6f4==_0x1a33f0(0x148)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5e4339){const _0x504005=_0x418075;if(_0x5e4339!=_0x504005(0x148)&&config[_0x504005(0x102)]!=''){if(pid[_0x5e4339])pid[_0x5e4339][_0x504005(0x1e9)]({'function':'initclient','args':null});}_0x5e4339!=_0x504005(0x148)&&broadcastToBots(_0x504005(0x200),JSON[_0x504005(0x245)](config));}function reloadBotManager(){const _0x47ebe0=_0x418075;getClientsWithBotID('botmanager')[_0x47ebe0(0xb0)](_0x1aaa43=>{const _0x5597f5=_0x47ebe0;getSocket(_0x1aaa43['id'])[_0x5597f5(0xb6)]('status',{'access':{'allow':![],'reason':_0x5597f5(0x236),'token':null}});});}function getSocket(_0x5d7b78){const _0x53e157=_0x418075,_0x5d59a3=io[_0x53e157(0x1b6)][_0x53e157(0x118)]('/');return _0x5d59a3[_0x53e157(0x1b4)]['get'](_0x5d7b78);}function setAccess(_0x5468f0){const _0x3c5855=_0x418075,_0x460b6e=getSocket(_0x5468f0['id']),_0xf075fb=_0x5468f0[_0x3c5855(0x155)],_0x2bdedf=_0x5468f0[_0x3c5855(0x23f)];devices[_0xf075fb][_0x3c5855(0x162)]=validateAccess(devices[_0xf075fb][_0x3c5855(0x162)]['token'],_0xf075fb),logger[_0x3c5855(0xab)](_0x3c5855(0x1cb)+devices[_0xf075fb][_0x3c5855(0x162)][_0x3c5855(0xf9)]+_0x3c5855(0x282)+_0x5468f0['id'][_0x3c5855(0x22e)](-0x8)+_0x3c5855(0xe2)+_0xf075fb[_0x3c5855(0x22e)](-0x8)),_0x460b6e[_0x3c5855(0xd5)](_0xf075fb);if(devices[_0xf075fb]['access'][_0x3c5855(0xdb)]){_0x460b6e[_0x3c5855(0xd5)](_0x2bdedf);if(_0x2bdedf==_0x3c5855(0x148))initializeSocketBotManager(_0x460b6e);else initializeSocketBot(_0x460b6e);initClient(_0x2bdedf);}devices[_0xf075fb][_0x3c5855(0x162)]['token']&&devices[_0xf075fb][_0x3c5855(0x162)][_0x3c5855(0xf9)]==_0x3c5855(0xe8)&&setSessionTimeout('2FA',_0xf075fb),devices[_0xf075fb][_0x3c5855(0x162)][_0x3c5855(0xaa)]&&devices[_0xf075fb][_0x3c5855(0x162)][_0x3c5855(0xf9)]==_0x3c5855(0x14f)&&setSessionTimeout(_0x3c5855(0x156),_0xf075fb),_0x460b6e['emit'](_0x3c5855(0x23c),{'status':_0x5468f0[_0x3c5855(0x14a)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xf075fb]['access'],'externalip':devices[_0xf075fb]['ip'],'publicKey':secure[_0x3c5855(0xfb)],'userid':settings[_0x3c5855(0x263)],'validInstallation':validInstallation}),devices[_0xf075fb]['access'][_0x3c5855(0xdb)]==![]&&devices[_0xf075fb][_0x3c5855(0x162)][_0x3c5855(0xf9)]==_0x3c5855(0x1d6)&&temporaryAccess2FA(_0xf075fb,devices[_0xf075fb]['ip']);}function setSessionTimeout(_0x8ccf5a,_0x3f7cd0){const _0x4ae7a9=_0x418075;let _0x3eb6cb;if(_0x8ccf5a==_0x4ae7a9(0x156))_0x3eb6cb=loginExpiry*0x3c*0x3e8;else _0x3eb6cb=devices[_0x3f7cd0][_0x4ae7a9(0x143)][_0x4ae7a9(0x18d)]*0x3c*0x3e8-(new Date()[_0x4ae7a9(0x10a)]()-devices[_0x3f7cd0][_0x4ae7a9(0x143)][_0x4ae7a9(0x16b)]);if(devices[_0x3f7cd0][_0x4ae7a9(0x276)])clearTimeout(devices[_0x3f7cd0][_0x4ae7a9(0x276)]);devices[_0x3f7cd0]['pidExpireLogin']=setTimeout(()=>{const _0x29060d=_0x4ae7a9;if(devices[_0x3f7cd0][_0x29060d(0x1a8)])clearTimeout(devices[_0x3f7cd0][_0x29060d(0x1a8)]);removeSocketListeners(_0x3f7cd0),addBlacklist(_0x3f7cd0),devices[_0x3f7cd0]['telegramIpApproval']=null,devices[_0x3f7cd0][_0x29060d(0xe9)]=null,devices[_0x3f7cd0][_0x29060d(0x162)][_0x29060d(0xaa)]=null,logger[_0x29060d(0xab)](_0x29060d(0x127)+_0x3f7cd0['slice'](-0x8)),devices[_0x3f7cd0][_0x29060d(0x162)]=validateAccess(devices[_0x3f7cd0][_0x29060d(0x162)][_0x29060d(0xaa)],_0x3f7cd0),!(devices[_0x3f7cd0]['access'][_0x29060d(0xdb)]&&devices[_0x3f7cd0][_0x29060d(0x162)][_0x29060d(0xf9)]==_0x29060d(0x25c))&&(_0x8ccf5a==_0x29060d(0x156)?io['to'](_0x3f7cd0)[_0x29060d(0xb6)](_0x29060d(0x23c),{'access':{'allow':![],'reason':_0x29060d(0xcc),'token':null}}):io['to'](_0x3f7cd0)[_0x29060d(0xb6)](_0x29060d(0x23c),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x3f7cd0][_0x29060d(0x162)]['token']=null;},_0x3eb6cb);}function setTokenRefresh(_0x1784f9){const _0x5c3f9b=_0x418075;if(devices[_0x1784f9][_0x5c3f9b(0x1a8)])clearTimeout(devices[_0x1784f9][_0x5c3f9b(0x1a8)]);devices[_0x1784f9][_0x5c3f9b(0x1a8)]=setTimeout(()=>{const _0x547f6c=_0x5c3f9b;getClientsWithUuid(_0x1784f9)[_0x547f6c(0xa7)]!=0x0?(devices[_0x1784f9]['access']=refreshToken(_0x1784f9),io['to'](_0x1784f9)[_0x547f6c(0xb6)]('status',{'status':_0x547f6c(0x133),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1784f9][_0x547f6c(0x162)],'externalip':devices[_0x1784f9]['ip'],'publicKey':secure[_0x547f6c(0xfb)],'validInstallation':validInstallation}),setTokenRefresh(_0x1784f9)):clearTimeout(devices[_0x1784f9][_0x547f6c(0x1a8)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1aaa80){const _0x4c2520=_0x418075,_0x4d5434=getClient(_0x1aaa80['id'])[_0x4c2520(0x155)];_0x1aaa80['emit'](_0x4c2520(0x200),config),_0x1aaa80[_0x4c2520(0xb6)](_0x4c2520(0x251),cleanSettings()),_0x1aaa80['on'](_0x4c2520(0xbc),_0x45aab5=>{const _0x26cbeb=_0x4c2520;if(validateAccess(_0x45aab5,_0x4d5434)[_0x26cbeb(0xdb)])addBot();else logger[_0x26cbeb(0xd8)](_0x26cbeb(0x27e));}),_0x1aaa80['on'](_0x4c2520(0x1e1),(_0xbc241c,_0x11f948)=>{const _0x59dee2=_0x4c2520;if(validateAccess(_0x11f948,_0x4d5434)[_0x59dee2(0xdb)])toggleBot(_0xbc241c[_0x59dee2(0xf1)],_0xbc241c['status'],_0xbc241c[_0x59dee2(0xbd)]);else logger[_0x59dee2(0xd8)](_0x59dee2(0x140));}),_0x1aaa80['on']('toggle-bot-mode',(_0x4e20a6,_0x4e5a33)=>{const _0x3b3f81=_0x4c2520;if(validateAccess(_0x4e5a33,_0x4d5434)[_0x3b3f81(0xdb)])toggleBotMode(_0x4e20a6);else logger[_0x3b3f81(0xd8)](_0x3b3f81(0x140));}),_0x1aaa80['on'](_0x4c2520(0x254),(_0x2f75cd,_0x5b1e26)=>{const _0x13190c=_0x4c2520;if(validateAccess(_0x5b1e26,_0x4d5434)[_0x13190c(0xdb)])deleteBot(_0x2f75cd);else logger[_0x13190c(0xd8)](_0x13190c(0x141));}),_0x1aaa80['on']('store-settings',(_0x31b594,_0x47d396)=>{const _0xcf3c3f=_0x4c2520;if(validateAccess(_0x47d396,_0x4d5434)[_0xcf3c3f(0xdb)])storeSettings(_0x31b594,!![]);else logger[_0xcf3c3f(0xd8)](_0xcf3c3f(0x14d));}),_0x1aaa80['on']('update-bb',_0x353f0f=>{const _0x3d46f1=_0x4c2520;if(validateAccess(_0x353f0f,_0x4d5434)[_0x3d46f1(0xdb)])updateBB(_0x3d46f1(0x120));else logger[_0x3d46f1(0xd8)](_0x3d46f1(0x165));}),_0x1aaa80['on'](_0x4c2520(0xd6),_0x5a4dfd=>{const _0x583397=_0x4c2520;if(validateAccess(_0x5a4dfd,_0x4d5434)['allow'])updateBB(_0x583397(0x24e));else logger['full'](_0x583397(0x277));}),_0x1aaa80['on'](_0x4c2520(0x211),_0xe20faa=>{const _0x24c42e=_0x4c2520;if(validateAccess(_0xe20faa,_0x4d5434)[_0x24c42e(0xdb)]){const _0x2fb559=getClient(_0x1aaa80['id']);if(_0x2fb559)getBackupFiles(_0x2fb559['uuid']);else logger[_0x24c42e(0xd8)](_0x24c42e(0x238));}else logger[_0x24c42e(0xd8)](_0x24c42e(0x231));}),_0x1aaa80['on']('restore-backup-file',(_0x1dd2d0,_0x1bdbd2)=>{const _0x301d9e=_0x4c2520;if(validateAccess(_0x1bdbd2,_0x4d5434)[_0x301d9e(0xdb)])restoreBackupFile(_0x1dd2d0);else logger[_0x301d9e(0xd8)](_0x301d9e(0x222));}),_0x1aaa80['on'](_0x4c2520(0x152),_0x5fb8b4=>{const _0x42551d=_0x4c2520;if(validateAccess(_0x5fb8b4,_0x4d5434)[_0x42551d(0xdb)])getMessages();else logger[_0x42551d(0xd8)](_0x42551d(0x1ce));}),_0x1aaa80['on']('confirm-message',(_0x11d6a1,_0xca87f1)=>{const _0x385ed6=_0x4c2520;if(validateAccess(_0xca87f1,_0x4d5434)[_0x385ed6(0xdb)])confirmMessage(_0x11d6a1);else logger['full'](_0x385ed6(0x104));}),_0x1aaa80['on'](_0x4c2520(0x208),_0x829ed8=>{const _0x359965=_0x4c2520;if(validateAccess(_0x829ed8,_0x4d5434)[_0x359965(0xdb)]){if(devices[_0x4d5434][_0x359965(0x1a8)])clearTimeout(devices[_0x4d5434]['pidRefreshToken']);if(devices[_0x4d5434][_0x359965(0x276)])clearTimeout(devices[_0x4d5434][_0x359965(0x276)]);removeSocketListeners(getClient(_0x1aaa80['id'])[_0x359965(0x155)]),addBlacklist(_0x4d5434),devices[_0x4d5434][_0x359965(0x143)]=null,devices[_0x4d5434]['telegram2FaApproval']=null,devices[_0x4d5434][_0x359965(0x162)][_0x359965(0xaa)]=null,logger[_0x359965(0xab)](_0x359965(0x1f2)+_0x4d5434[_0x359965(0x22e)](-0x8)),io['to'](getClient(_0x1aaa80['id'])[_0x359965(0x155)])[_0x359965(0xb6)]('status',{'access':{'allow':![],'reason':_0x359965(0x12b),'token':null}});}else logger['full'](_0x359965(0x234));});}function initializeSocketBot(_0x48fc1b){const _0x1a87a4=_0x418075,_0x8d492c=getClient(_0x48fc1b['id'])[_0x1a87a4(0x23f)],_0x585ad3=getClient(_0x48fc1b['id'])['uuid'];_0x48fc1b['on'](_0x1a87a4(0xc1),(_0x48bf51,_0x12739a)=>{const _0x4d31c3=_0x1a87a4;if(validateAccess(_0x12739a,_0x585ad3)['allow']){if(pid[_0x8d492c])pid[_0x8d492c][_0x4d31c3(0x1e9)]({'function':_0x4d31c3(0x185),'args':_0x48bf51});}else logger[_0x4d31c3(0xd8)](_0x4d31c3(0x286));}),_0x48fc1b['on']('delete-alerts',(_0x20372b,_0x57f00e)=>{const _0x4cf33b=_0x1a87a4;if(validateAccess(_0x57f00e,_0x585ad3)['allow']){if(pid[_0x8d492c])pid[_0x8d492c][_0x4cf33b(0x1e9)]({'function':'deleteHistoryAlerts','args':_0x20372b});}else logger[_0x4cf33b(0xd8)](_0x4cf33b(0x103));}),_0x48fc1b['on'](_0x1a87a4(0x297),(_0x32e28e,_0x1a8a73)=>{const _0x249290=_0x1a87a4;if(validateAccess(_0x1a8a73,_0x585ad3)[_0x249290(0xdb)]){if(pid[_0x8d492c])pid[_0x8d492c][_0x249290(0x1e9)]({'function':_0x249290(0x13a),'args':_0x32e28e});}else logger[_0x249290(0xd8)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x48fc1b['on'](_0x1a87a4(0x19b),(_0x50f6b9,_0x5f32bb)=>{const _0xa5f4d2=_0x1a87a4;if(validateAccess(_0x5f32bb,_0x585ad3)['allow']){if(pid[_0x8d492c])pid[_0x8d492c][_0xa5f4d2(0x1e9)]({'function':'storeConfiguration','args':_0x50f6b9});}else logger[_0xa5f4d2(0xd8)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x48fc1b['on'](_0x1a87a4(0x129),(_0x29755b,_0x53f9dd)=>{const _0x2f38c9=_0x1a87a4;if(validateAccess(_0x53f9dd,_0x585ad3)[_0x2f38c9(0xdb)]){if(pid[_0x8d492c])pid[_0x8d492c][_0x2f38c9(0x1e9)]({'function':'storeHeadless','args':_0x29755b});}else logger['full'](_0x2f38c9(0x1b8));}),_0x48fc1b['on']('store-fiat',(_0x509a9e,_0x1f0c6f)=>{const _0x3b9e3d=_0x1a87a4;if(validateAccess(_0x1f0c6f,_0x585ad3)['allow']){if(pid[_0x8d492c])pid[_0x8d492c]['send']({'function':'storeFiat','args':_0x509a9e});}else logger[_0x3b9e3d(0xd8)](_0x3b9e3d(0xf7));}),_0x48fc1b['on'](_0x1a87a4(0x294),_0x4b952f=>{const _0xb59da2=_0x1a87a4;if(validateAccess(_0x4b952f,_0x585ad3)['allow']){if(pid[_0x8d492c])pid[_0x8d492c][_0xb59da2(0x1e9)]({'function':'resetHistory','args':null});}else logger[_0xb59da2(0xd8)](_0xb59da2(0x25a));}),_0x48fc1b['on'](_0x1a87a4(0x11f),_0x474a8d=>{const _0x56d2b5=_0x1a87a4;if(validateAccess(_0x474a8d,_0x585ad3)[_0x56d2b5(0xdb)]){if(pid[_0x8d492c])pid[_0x8d492c][_0x56d2b5(0x1e9)]({'function':'getStartingBalances','args':null});}else logger['full'](_0x56d2b5(0x15c));}),_0x48fc1b['on']('place-order',(_0xfeb76d,_0xe7295)=>{const _0x4d303a=_0x1a87a4;if(validateAccess(_0xe7295,_0x585ad3)[_0x4d303a(0xdb)]){if(pid[_0x8d492c])pid[_0x8d492c]['send']({'function':_0x4d303a(0x21f),'args':_0xfeb76d});}else logger[_0x4d303a(0xd8)](_0x4d303a(0x1cd));}),_0x48fc1b['on']('cancel-loading',_0x49e02e=>{const _0x22deb5=_0x1a87a4;if(validateAccess(_0x49e02e,_0x585ad3)[_0x22deb5(0xdb)]){if(pid[_0x8d492c])pid[_0x8d492c]['send']({'function':_0x22deb5(0x285),'args':null});}else logger[_0x22deb5(0xd8)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x48fc1b['on'](_0x1a87a4(0x255),_0x3e2c1b=>{const _0x1227f7=_0x1a87a4;if(validateAccess(_0x3e2c1b,_0x585ad3)[_0x1227f7(0xdb)]){if(pid[_0x8d492c])pid[_0x8d492c][_0x1227f7(0x1e9)]({'function':_0x1227f7(0xa3),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x48fc1b['on'](_0x1a87a4(0x12e),_0x1f9cc9=>{const _0x3380f4=_0x1a87a4;if(validateAccess(_0x1f9cc9,_0x585ad3)[_0x3380f4(0xdb)])updateBB(_0x3380f4(0x120));else logger['full'](_0x3380f4(0x165));}),_0x48fc1b['on']('get-messages',_0x1f523a=>{const _0x210563=_0x1a87a4;if(validateAccess(_0x1f523a,_0x585ad3)[_0x210563(0xdb)])getMessages();else logger['full'](_0x210563(0x1ce));}),_0x48fc1b['on']('confirm-message',(_0x12bc79,_0x4e9506)=>{const _0x4c5d06=_0x1a87a4;if(validateAccess(_0x4e9506,_0x585ad3)['allow'])confirmMessage(_0x12bc79);else logger[_0x4c5d06(0xd8)](_0x4c5d06(0x104));}),_0x48fc1b['on'](_0x1a87a4(0x208),_0x50be99=>{const _0xdba8d1=_0x1a87a4;if(validateAccess(_0x50be99,_0x585ad3)[_0xdba8d1(0xdb)]){if(devices[_0x585ad3][_0xdba8d1(0x1a8)])clearTimeout(devices[_0x585ad3]['pidRefreshToken']);if(devices[_0x585ad3][_0xdba8d1(0x276)])clearTimeout(devices[_0x585ad3][_0xdba8d1(0x276)]);removeSocketListeners(getClient(_0x48fc1b['id'])[_0xdba8d1(0x155)]),addBlacklist(_0x585ad3),devices[_0x585ad3][_0xdba8d1(0x143)]=null,devices[_0x585ad3]['telegram2FaApproval']=null,devices[_0x585ad3][_0xdba8d1(0x162)][_0xdba8d1(0xaa)]=null,logger[_0xdba8d1(0xab)]('Logged\x20out\x20user\x20...'+_0x585ad3['slice'](-0x8)),io['to'](getClient(_0x48fc1b['id'])[_0xdba8d1(0x155)])[_0xdba8d1(0xb6)](_0xdba8d1(0x23c),{'access':{'allow':![],'reason':_0xdba8d1(0x12b),'token':null}});}else logger[_0xdba8d1(0xd8)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x4f61ac){const _0x4b2a87=_0x418075;getClientsWithUuid(_0x4f61ac)[_0x4b2a87(0xb0)](_0x597aaf=>{const _0x44c58f=_0x4b2a87;getSocket(_0x597aaf['id'])[_0x44c58f(0x293)]();});}function cleanSettings(){const _0x514687=_0x418075;let _0x4d553e=settings;return settings[_0x514687(0x1ed)]&&settings[_0x514687(0x1ed)]!=''&&(_0x4d553e={..._0x4d553e,'telegramToken':'************'}),settings[_0x514687(0x20d)]&&settings['bbPassword']!=''&&(_0x4d553e={..._0x4d553e,'bbPassword':_0x514687(0x1bd)}),settings[_0x514687(0x242)]&&settings[_0x514687(0x242)]!=''&&(_0x4d553e={..._0x4d553e,'marketcapApi':'************'}),(settings[_0x514687(0x20d)]&&settings[_0x514687(0x20d)]==_0x514687(0x1f8)||settings[_0x514687(0x1ed)]&&settings[_0x514687(0x1ed)]=='***'||settings[_0x514687(0x242)]&&settings[_0x514687(0x242)]==_0x514687(0x1f8))&&(_0x4d553e={..._0x4d553e,'restored':{'password':settings[_0x514687(0x20d)]==_0x514687(0x1f8),'telegram':settings[_0x514687(0x1ed)]==_0x514687(0x1f8),'marketcap':settings['marketcapApi']=='***'}}),_0x4d553e;}async function updateBB(_0x23fc5b){const _0x371c15=_0x418075;await backupConfigFiles(),installingUpdate=!![],config[_0x371c15(0xb0)](_0x3221f8=>{const _0x357f6b=_0x371c15;restartBot(_0x3221f8[_0x357f6b(0xf1)]);});if(_0x23fc5b=='update')process['send']({'update':!![],'environment':environment},_0x839b43=>{});else _0x23fc5b==_0x371c15(0x24e)&&process['send']({'reinstall':!![],'environment':environment},_0x4086e1=>{});}function startBot(_0x141367,_0x16b2f3,_0xda59c0){const _0x50b541=_0x418075;if(debugging)_0x141367[_0x50b541(0x22a)]('-d');let _0x55da2c=![];const _0x530e30=_0x141367[0x0];_0x16b2f3={..._0x16b2f3,'stdio':['inherit',_0x50b541(0x19f),'inherit',_0x50b541(0xfe)]},pid[_0x530e30]=childProcess[_0x50b541(0x229)](botfile,_0x141367,_0x16b2f3),pid[_0x530e30]['on'](_0x50b541(0x112),_0x5928f4=>{const _0x582a24=_0x50b541;switch(Object[_0x582a24(0x189)](_0x5928f4)[0x0]){case'botname':updateBotName(_0x530e30,_0x5928f4[_0x582a24(0x284)]);break;case _0x582a24(0x213):updateBotManager();break;case _0x582a24(0x23c):updateStatus(_0x530e30,_0x5928f4['status']);break;case'live':updateLive(_0x530e30,_0x5928f4[_0x582a24(0xbd)]);break;case _0x582a24(0x1cc):updateLive(_0x530e30,_0x5928f4[_0x582a24(0x1cc)]),io['to'](_0x530e30)[_0x582a24(0xb6)](_0x582a24(0x23c),{'access':{'allow':![],'reason':'reload','token':null}});break;case'stop':_0x5928f4[_0x582a24(0xe6)]=='restart'&&restartBot(_0x530e30);_0x5928f4[_0x582a24(0xe6)]=='kill'&&toggleBot(_0x530e30,_0x582a24(0x281),'stopped');break;case _0x582a24(0x240):sendTelegramBot(_0x530e30,_0x5928f4['telegram']);break;case'telegrammsg':sendTelegramMsg(_0x5928f4[_0x582a24(0x11c)]);break;case'function':io['to'](_0x530e30)[_0x582a24(0xb6)](_0x5928f4[_0x582a24(0x22b)],_0x5928f4[_0x582a24(0x20c)]);break;}}),pid[_0x530e30]['on'](_0x50b541(0x1dc),function(_0x33c10c){if(_0x55da2c)return;_0x55da2c=!![],_0xda59c0(_0x33c10c);}),pid[_0x530e30]['on'](_0x50b541(0x107),async function(_0x486c7d){const _0x348efc=_0x50b541;if(terminating)return;if(installingUpdate){io[_0x348efc(0x1d0)]();return;}if(_0x55da2c)return;_0x55da2c=!![],_0xda59c0(null);const _0x30d4f3=dbConfig[_0x348efc(0x118)]('bots')['find']({'botID':_0x530e30})[_0x348efc(0x138)]();_0x30d4f3&&(_0x30d4f3[_0x348efc(0x23c)]=='enabled'||_0x30d4f3[_0x348efc(0x23c)]==_0x348efc(0x1c1))&&(await sleep(0x3e8),updateLive(_0x530e30,_0x348efc(0x151)),logger[_0x348efc(0xd8)](_0x348efc(0x291)+_0x530e30),startBot([_0x530e30,userID],{'cwd':bbpath},function(_0x5e31ab){const _0x5c0696=_0x348efc;if(_0x5e31ab)logger[_0x5c0696(0xd8)](_0x5e31ab);}));});}function stopBot(_0x4083f6){const _0xbd8e77=_0x418075;getClientsWithBotID(_0x4083f6)[_0xbd8e77(0xb0)](_0x1390a5=>{const _0xcf3abc=_0xbd8e77;getSocket(_0x1390a5['id'])[_0xcf3abc(0x237)](!![]),removeClient(_0x1390a5['id']);}),pid[_0x4083f6]&&(pid[_0x4083f6][_0xbd8e77(0xec)](),pid[_0x4083f6]=null);}function stopAllBots(){const _0x3e543d=_0x418075;terminating=!![];const _0xbe7d21=getEnabledBots();_0xbe7d21[_0x3e543d(0xb0)](_0x43bfd8=>{stopBot(_0x43bfd8['botID']);});}function restartBot(_0x5a3ceb){if(pid[_0x5a3ceb])pid[_0x5a3ceb]['kill']();}function addBot(){const _0xa9de60=_0x418075;let _0x35ad3f;for(let _0xbc011b=0x1;_0xbc011b<0x3e9;_0xbc011b++){_0x35ad3f=_0xbc011b[_0xa9de60(0x13c)]()[_0xa9de60(0xeb)](0x3,'0');let _0x5d5807=config[_0xa9de60(0x22d)](_0x351f4e=>_0x351f4e[_0xa9de60(0xf1)]==_0x35ad3f);if(!_0x5d5807)break;}if(_0x35ad3f==='1000'){logger[_0xa9de60(0xd8)](_0xa9de60(0x12a));return;}logger[_0xa9de60(0xd8)](_0xa9de60(0x19d)+_0x35ad3f),dbConfig[_0xa9de60(0x118)](_0xa9de60(0x200))[_0xa9de60(0x22a)]({'botID':_0x35ad3f,'botname':_0xa9de60(0x9d)+_0x35ad3f,'status':'new','live':''})[_0xa9de60(0x1a3)](),startBot([_0x35ad3f,userID],{'cwd':bbpath},function(_0x53c8f0){const _0x4ae451=_0xa9de60;if(_0x53c8f0)logger[_0x4ae451(0xd8)](_0x53c8f0);}),config=getConfiguration(),io['to'](_0xa9de60(0x148))['emit'](_0xa9de60(0x200),config),broadcastToBots('bots',JSON[_0xa9de60(0x245)](config));}function deleteBot(_0x101bc8){const _0x17dab6=_0x418075;getClientsWithBotID(_0x101bc8)[_0x17dab6(0xb0)](_0x3ee053=>{const _0x3cf3a9=_0x17dab6;getSocket(_0x3ee053['id'])[_0x3cf3a9(0x237)](!![]),removeClient(_0x3ee053['id']);}),dbConfig[_0x17dab6(0x118)](_0x17dab6(0x200))[_0x17dab6(0x219)]({'botID':_0x101bc8})[_0x17dab6(0x1a3)](),logger[_0x17dab6(0xd8)]('Deleted\x20Bot\x20'+_0x101bc8),stopBot(_0x101bc8);try{if(fs['existsSync'](path[_0x17dab6(0xd5)](configpath,_0x17dab6(0x1d3)+_0x101bc8+_0x17dab6(0x19a))))fs[_0x17dab6(0xc5)](path[_0x17dab6(0xd5)](configpath,_0x17dab6(0x1d3)+_0x101bc8+_0x17dab6(0x19a)));if(fs[_0x17dab6(0x186)](path[_0x17dab6(0xd5)](configpath,_0x17dab6(0x1d3)+_0x101bc8+_0x17dab6(0x159))))fs[_0x17dab6(0xc5)](path[_0x17dab6(0xd5)](configpath,'bot-'+_0x101bc8+_0x17dab6(0x159)));if(fs[_0x17dab6(0x186)](path[_0x17dab6(0xd5)](configpath,_0x17dab6(0x1d3)+_0x101bc8+_0x17dab6(0x10e))))fs[_0x17dab6(0xc5)](path[_0x17dab6(0xd5)](configpath,_0x17dab6(0x1d3)+_0x101bc8+_0x17dab6(0x10e)));if(fs[_0x17dab6(0x186)](path[_0x17dab6(0xd5)](configpath,_0x17dab6(0x1d3)+_0x101bc8+_0x17dab6(0x1e0))))fs[_0x17dab6(0xc5)](path[_0x17dab6(0xd5)](configpath,_0x17dab6(0x1d3)+_0x101bc8+_0x17dab6(0x1e0)));}catch(_0x3c352f){if(_0x3c352f)logger['full'](_0x17dab6(0x206),_0x3c352f);}config=getConfiguration(),io['to']('botmanager')[_0x17dab6(0xb6)](_0x17dab6(0x200),config),broadcastToBots(_0x17dab6(0x200),JSON[_0x17dab6(0x245)](config));}function toggleBot(_0x29bdbf,_0x24bcb4,_0x1d0c1d){const _0x39017a=_0x418075;dbConfig[_0x39017a(0x118)]('bots')[_0x39017a(0x22d)]({'botID':_0x29bdbf})[_0x39017a(0x131)]({'status':_0x24bcb4})['assign']({'live':_0x1d0c1d})[_0x39017a(0x1a3)]();if(_0x24bcb4==_0x39017a(0xfc)||_0x24bcb4==_0x39017a(0x1c1))logger[_0x39017a(0xd8)](_0x39017a(0x230)+_0x29bdbf),startBot([_0x29bdbf,userID],{'cwd':bbpath},function(_0x388fa9){if(_0x388fa9)logger['full'](_0x388fa9);});else(_0x24bcb4=='disabled'||_0x24bcb4==_0x39017a(0xea))&&(logger[_0x39017a(0xd8)]('Disabled\x20Bot\x20'+_0x29bdbf),stopBot(_0x29bdbf));config=getConfiguration(),io['to'](_0x39017a(0x148))[_0x39017a(0xb6)](_0x39017a(0x200),config),broadcastToBots(_0x39017a(0x200),JSON[_0x39017a(0x245)](config));}function toggleStatus(_0x4c2522){const _0x4d049a=_0x418075;let _0x22abe0=dbConfig[_0x4d049a(0x118)](_0x4d049a(0x200))[_0x4d049a(0x22d)]({'botID':_0x4c2522})['value'](),_0x335512;if(_0x22abe0[_0x4d049a(0x23c)]===_0x4d049a(0xfc))_0x335512=_0x4d049a(0x281);else{if(_0x22abe0[_0x4d049a(0x23c)]==='new')_0x335512=_0x4d049a(0xea);else{if(_0x22abe0['status']===_0x4d049a(0xea))_0x335512=_0x4d049a(0x1c1);else{if(_0x22abe0['status']===_0x4d049a(0x281))_0x335512=_0x4d049a(0xfc);}}}return _0x335512;}function updateStatus(_0x573625,_0x412c8e){const _0xad0a72=_0x418075;dbConfig['get'](_0xad0a72(0x200))[_0xad0a72(0x22d)]({'botID':_0x573625})[_0xad0a72(0x131)]({'status':_0x412c8e})[_0xad0a72(0x1a3)](),config=getConfiguration(),io['to'](_0xad0a72(0x148))['emit'](_0xad0a72(0x200),config),broadcastToBots('bots',JSON[_0xad0a72(0x245)](config));}function updateLive(_0x466f78,_0x54d471){const _0x5e8a62=_0x418075;dbConfig[_0x5e8a62(0x118)](_0x5e8a62(0x200))[_0x5e8a62(0x22d)]({'botID':_0x466f78})[_0x5e8a62(0x131)]({'live':_0x54d471})[_0x5e8a62(0x1a3)](),config=getConfiguration(),io['to']('botmanager')[_0x5e8a62(0xb6)](_0x5e8a62(0x200),config),broadcastToBots(_0x5e8a62(0x200),JSON[_0x5e8a62(0x245)](config));}function updateBotName(_0x4d1612,_0x332d6f){const _0x479abb=_0x418075;dbConfig[_0x479abb(0x118)](_0x479abb(0x200))['find']({'botID':_0x4d1612})['assign']({'botname':_0x332d6f})[_0x479abb(0x1a3)](),config=getConfiguration(),io['to'](_0x479abb(0x148))['emit'](_0x479abb(0x200),config),broadcastToBots(_0x479abb(0x200),JSON[_0x479abb(0x245)](config));}function updateBotManager(){const _0x546a2b=_0x418075;config=getConfiguration(),io['to'](_0x546a2b(0x148))[_0x546a2b(0xb6)](_0x546a2b(0x200),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBotMode(_0x2b0d4f){const _0x41622e=_0x418075;if(pid[_0x2b0d4f])pid[_0x2b0d4f][_0x41622e(0x1e9)]({'function':_0x41622e(0x221),'args':null});else{const _0x1d268b=configpath+_0x41622e(0x1d3)+_0x2b0d4f+_0x41622e(0x19a),_0x525618=fs['readFileSync'](_0x1d268b),_0x239d71=JSON[_0x41622e(0xa1)](_0x525618),_0x33c5a3=_0x239d71[_0x41622e(0x23f)][0x0][_0x41622e(0x23e)];_0x239d71['bot'][0x0][_0x41622e(0x23e)]=!_0x33c5a3;const _0x9da6b2=JSON[_0x41622e(0x245)](_0x239d71,null,0x2);fs['writeFileSync'](_0x1d268b,_0x9da6b2),config=getConfiguration(),io['to'](_0x41622e(0x148))[_0x41622e(0xb6)](_0x41622e(0x200),config),broadcastToBots(_0x41622e(0x200),JSON[_0x41622e(0x245)](config));}}function validateTelegram(_0x2ce00f){const _0x47d46c=_0x418075;if(_0x2ce00f[_0x47d46c(0x109)]['username']!=settings['telegramUsername']&&'@'+_0x2ce00f[_0x47d46c(0x109)]['username']!=settings[_0x47d46c(0x111)]||_0x2ce00f[_0x47d46c(0x1d9)]['id']!=settings[_0x47d46c(0x21d)])return sendTelegram(_0x2ce00f[_0x47d46c(0x1d9)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x47d46c(0x13e)}),![];return!![];}async function initTelegram(){const _0x82e17b=_0x418075;if(tgBot)tgBot['stop'](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x82e17b(0x1ed)]);let _0x3b6bd4=_0x82e17b(0x136);_0x3b6bd4+='\x0a',_0x3b6bd4+=_0x82e17b(0x1ff),_0x3b6bd4+=_0x82e17b(0x1ee),_0x3b6bd4+=_0x82e17b(0x1a6),_0x3b6bd4+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x3b6bd4+=_0x82e17b(0x187),_0x3b6bd4+='/off\x20-\x20stop\x20bot(s)\x0a',_0x3b6bd4+=_0x82e17b(0x27a),_0x3b6bd4+=_0x82e17b(0x20a),_0x3b6bd4+=_0x82e17b(0x101),_0x3b6bd4+=_0x82e17b(0xbf),_0x3b6bd4+=_0x82e17b(0xb7),_0x3b6bd4+=_0x82e17b(0x114),_0x3b6bd4+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x3b6bd4+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x4c49c6='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x4c49c6+='\x0a',_0x4c49c6+=_0x3b6bd4,tgBot[_0x82e17b(0x10c)]((_0xd67c2d,_0x5ec402)=>{const _0x5ee9a2=_0x82e17b;logger[_0x5ee9a2(0x28e)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger[_0x5ee9a2(0xab)](_0x5ee9a2(0x128),_0xd67c2d);}),tgBot[_0x82e17b(0x158)](async(_0x59cbc4,_0x55376a)=>{const _0x5d20e0=_0x82e17b;if(!(!settings[_0x5d20e0(0x21d)]&&_0x59cbc4[_0x5d20e0(0x120)][_0x5d20e0(0x112)][_0x5d20e0(0x132)]==_0x5d20e0(0x215))){if(!validateTelegram(_0x59cbc4))return;}_0x55376a();}),tgBot[_0x82e17b(0x1ab)](_0x82e17b(0x1a2),async _0x274499=>{const _0x3b4c21=_0x82e17b;if(!settings[_0x3b4c21(0x21d)])updateSetting(_0x3b4c21(0x21d),_0x274499['chat']['id']);updateSetting('telegramEnabled',!![]);if(!validateTelegram(_0x274499))return;await sendTelegram(_0x274499['chat']['id'],_0x4c49c6);}),tgBot[_0x82e17b(0x1ab)]('enable',async _0x50053b=>{const _0x15b9e8=_0x82e17b;updateSetting(_0x15b9e8(0x137),!![]),await sendTelegram(_0x50053b[_0x15b9e8(0x1d9)]['id'],_0x15b9e8(0x25f));}),tgBot[_0x82e17b(0x1ab)](_0x82e17b(0x268),async _0x5562fe=>{const _0x57a174=_0x82e17b;await sendTelegram(_0x5562fe['chat']['id'],_0x57a174(0x1f1)),updateSetting('telegramEnabled',![]);}),tgBot['command'](_0x82e17b(0x1c6),async _0x1b3402=>{const _0x44aa5b=_0x82e17b,_0x4753eb=Markup[_0x44aa5b(0x17b)]([Markup[_0x44aa5b(0x1bf)][_0x44aa5b(0xca)](_0x44aa5b(0x1b7),'config_orders'),Markup[_0x44aa5b(0x1bf)][_0x44aa5b(0xca)](_0x44aa5b(0xdf),'config_alerts'),Markup[_0x44aa5b(0x1bf)][_0x44aa5b(0xca)](_0x44aa5b(0x1de),_0x44aa5b(0x149))]);_0x1b3402[_0x44aa5b(0x26b)](_0x44aa5b(0x241),_0x4753eb);}),tgBot['action'](_0x82e17b(0x183),async _0x9d9dae=>{const _0x448371=_0x82e17b;_0x9d9dae['editMessageReplyMarkup'](),updateSetting(_0x448371(0x164),_0x448371(0x13f)),updateSetting(_0x448371(0x137),!![]),await sendTelegram(_0x9d9dae[_0x448371(0x1d9)]['id'],_0x448371(0x1e7));}),tgBot[_0x82e17b(0xc6)](_0x82e17b(0x123),async _0x5934d4=>{const _0x13e3a2=_0x82e17b;_0x5934d4[_0x13e3a2(0xf8)](),updateSetting(_0x13e3a2(0x164),'alerts'),updateSetting(_0x13e3a2(0x137),!![]),await sendTelegram(_0x5934d4[_0x13e3a2(0x1d9)]['id'],_0x13e3a2(0xf3));}),tgBot[_0x82e17b(0xc6)](_0x82e17b(0x149),async _0x2af952=>{const _0x2a9337=_0x82e17b;_0x2af952[_0x2a9337(0xf8)](),updateSetting(_0x2a9337(0x164),_0x2a9337(0x150)),updateSetting(_0x2a9337(0x137),!![]),await sendTelegram(_0x2af952[_0x2a9337(0x1d9)]['id'],_0x2a9337(0x216));}),tgBot[_0x82e17b(0x1ab)](_0x82e17b(0x23c),async _0x7e8798=>{const _0x1335d2=_0x82e17b,_0x5d9fbb=getBotsWithMode();let _0x7a5c07='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x1335d2(0xb0)](_0x28069b=>{const _0x4cb258=_0x1335d2,_0x4f9034=_0x5d9fbb['find'](_0x16b93f=>_0x16b93f[_0x4cb258(0xf1)]==_0x28069b[_0x4cb258(0xf1)])[_0x4cb258(0x18c)];_0x7a5c07+='Bot\x20'+_0x28069b['botID']+':\x20'+_0x28069b['status']+'\x20|\x20'+_0x4f9034+_0x4cb258(0x167)+_0x28069b[_0x4cb258(0xbd)]+'\x0a';}),_0x7a5c07+='\x0a',_0x7a5c07+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x7a5c07+=!settings['telegramEnabled']?_0x1335d2(0x178):_0x1335d2(0x253),_0x7a5c07+=settings[_0x1335d2(0x137)]?settings['telegramEvents']==_0x1335d2(0x150)?_0x1335d2(0x273):'Notifications\x20types:\x20'+settings[_0x1335d2(0x164)]+'\x20only\x0a':'',await sendTelegram(_0x7e8798[_0x1335d2(0x1d9)]['id'],_0x7a5c07,{'parse_mode':_0x1335d2(0x13e)});}),tgBot[_0x82e17b(0x1ab)](_0x82e17b(0xa9),async _0x5f391d=>{const _0x5e6052=_0x82e17b,_0x4e47a9=getEnabledBots();if(_0x4e47a9['length']==0x0)await sendTelegram(_0x5f391d[_0x5e6052(0x1d9)]['id'],_0x5e6052(0x157));else{if(_0x4e47a9[_0x5e6052(0xa7)]>0x1)_0x4e47a9[_0x5e6052(0x22a)]({'botID':_0x5e6052(0x150)});let _0x2101e2=[],_0x4c9806=[];const _0x2ea4f4=_0x4e47a9['length']%0x4==0x0||_0x4e47a9[_0x5e6052(0xa7)]%0x4==0x3||_0x4e47a9[_0x5e6052(0xa7)]%0x3==0x1?0x4:0x3;let _0x31ad58=0x0;_0x4e47a9['forEach']((_0x3184a5,_0x358d62)=>{const _0x443ea8=_0x5e6052;if(_0x358d62%_0x2ea4f4==0x0)_0x4c9806=[];_0x4c9806[_0x443ea8(0x22a)](Markup[_0x443ea8(0x1bf)]['callback'](_0x3184a5[_0x443ea8(0xf1)]==_0x443ea8(0x150)?'All\x20bots':_0x443ea8(0x9d)+_0x3184a5[_0x443ea8(0xf1)],_0x443ea8(0xbe)+_0x3184a5[_0x443ea8(0xf1)])),_0x358d62%_0x2ea4f4==0x0&&(_0x2101e2[_0x31ad58]=_0x4c9806,_0x31ad58++);});const _0x1b30a4=Markup[_0x5e6052(0x17b)](_0x2101e2);_0x5f391d[_0x5e6052(0x26b)](_0x5e6052(0x13b),_0x1b30a4);}}),tgBot[_0x82e17b(0xc6)](/restart_(.+)/,async _0x27b052=>{const _0x31b3a8=_0x82e17b,_0x431636=_0x27b052[_0x31b3a8(0x110)][0x1];_0x27b052[_0x31b3a8(0xf8)](),_0x431636==_0x31b3a8(0x150)?config[_0x31b3a8(0xb0)](_0x5f0da5=>{restartBot(_0x5f0da5['botID']);}):restartBot(_0x431636);}),tgBot[_0x82e17b(0x1ab)]('on',async _0x36fa5e=>{const _0x313eb2=_0x82e17b,_0x34f7c1=getDisabledBots();if(_0x34f7c1['length']==0x0)await sendTelegram(_0x36fa5e[_0x313eb2(0x1d9)]['id'],_0x313eb2(0x21a));else{if(_0x34f7c1[_0x313eb2(0xa7)]>0x1)_0x34f7c1[_0x313eb2(0x22a)]({'botID':_0x313eb2(0x150)});let _0x3fed41=[],_0x181edd=[];const _0xd6c471=_0x34f7c1[_0x313eb2(0xa7)]%0x4==0x0||_0x34f7c1['length']%0x4==0x3||_0x34f7c1[_0x313eb2(0xa7)]%0x3==0x1?0x4:0x3;let _0x6109b3=0x0;_0x34f7c1[_0x313eb2(0xb0)]((_0x424733,_0x25ea8f)=>{const _0x47d81b=_0x313eb2;if(_0x25ea8f%_0xd6c471==0x0)_0x181edd=[];_0x181edd[_0x47d81b(0x22a)](Markup['button'][_0x47d81b(0xca)](_0x424733[_0x47d81b(0xf1)]==_0x47d81b(0x150)?'All\x20bots':_0x47d81b(0x9d)+_0x424733[_0x47d81b(0xf1)],_0x47d81b(0x1bb)+_0x424733[_0x47d81b(0xf1)])),_0x25ea8f%_0xd6c471==0x0&&(_0x3fed41[_0x6109b3]=_0x181edd,_0x6109b3++);});const _0x3f51ba=Markup[_0x313eb2(0x17b)](_0x3fed41);_0x36fa5e['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x3f51ba);}}),tgBot['action'](/on_(.+)/,async _0x23ef2a=>{const _0x1841e5=_0x82e17b,_0x5c4cbe=_0x23ef2a['match'][0x1];_0x23ef2a['editMessageReplyMarkup']();if(_0x5c4cbe==_0x1841e5(0x150)){const _0x53a68d=getDisabledBots();await sendTelegram(_0x23ef2a['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x53a68d['forEach'](_0x1443f2=>{const _0x2ee4bd=_0x1841e5;if(_0x1443f2[_0x2ee4bd(0xf1)]!=_0x2ee4bd(0x150))toggleBot(_0x1443f2['botID'],toggleStatus(_0x1443f2[_0x2ee4bd(0xf1)]),'stopped');});}else await sendTelegram(_0x23ef2a[_0x1841e5(0x1d9)]['id'],_0x1841e5(0x239)+_0x5c4cbe),toggleBot(_0x5c4cbe,toggleStatus(_0x5c4cbe),_0x1841e5(0x151));}),tgBot[_0x82e17b(0x1ab)](_0x82e17b(0x247),async _0x1d9e54=>{const _0xa8d5ad=_0x82e17b,_0x3997b4=getEnabledBots();if(_0x3997b4['length']==0x0)await sendTelegram(_0x1d9e54[_0xa8d5ad(0x1d9)]['id'],_0xa8d5ad(0x157));else{if(_0x3997b4[_0xa8d5ad(0xa7)]>0x1)_0x3997b4['push']({'botID':_0xa8d5ad(0x150)});let _0x564603=[],_0xdf1165=[];const _0x65afe9=_0x3997b4['length']%0x4==0x0||_0x3997b4[_0xa8d5ad(0xa7)]%0x4==0x3||_0x3997b4[_0xa8d5ad(0xa7)]%0x3==0x1?0x4:0x3;let _0x2d6965=0x0;_0x3997b4[_0xa8d5ad(0xb0)]((_0x582fcc,_0x68ec22)=>{const _0x1d8172=_0xa8d5ad;if(_0x68ec22%_0x65afe9==0x0)_0xdf1165=[];_0xdf1165['push'](Markup[_0x1d8172(0x1bf)]['callback'](_0x582fcc[_0x1d8172(0xf1)]==_0x1d8172(0x150)?'All\x20bots':'Bot\x20'+_0x582fcc[_0x1d8172(0xf1)],_0x1d8172(0x126)+_0x582fcc[_0x1d8172(0xf1)])),_0x68ec22%_0x65afe9==0x0&&(_0x564603[_0x2d6965]=_0xdf1165,_0x2d6965++);});const _0x44a2aa=Markup[_0xa8d5ad(0x17b)](_0x564603);_0x1d9e54[_0xa8d5ad(0x26b)](_0xa8d5ad(0xed),_0x44a2aa);}}),tgBot[_0x82e17b(0xc6)](/off_(.+)/,async _0x3ceddf=>{const _0x3b31e7=_0x82e17b,_0x1534fd=_0x3ceddf[_0x3b31e7(0x110)][0x1];_0x3ceddf[_0x3b31e7(0xf8)]();if(_0x1534fd==_0x3b31e7(0x150)){const _0x17b79d=getEnabledBots();await sendTelegram(_0x3ceddf['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots'),_0x17b79d[_0x3b31e7(0xb0)](_0x35a62d=>{const _0x1621ec=_0x3b31e7;if(_0x35a62d[_0x1621ec(0xf1)]!=_0x1621ec(0x150))toggleBot(_0x35a62d[_0x1621ec(0xf1)],toggleStatus(_0x35a62d[_0x1621ec(0xf1)]),'stopped');});}else await sendTelegram(_0x3ceddf[_0x3b31e7(0x1d9)]['id'],_0x3b31e7(0x24d)+_0x1534fd),toggleBot(_0x1534fd,toggleStatus(_0x1534fd),_0x3b31e7(0x151));}),tgBot[_0x82e17b(0x1ab)](_0x82e17b(0x243),async _0x7a0f89=>{const _0x123d24=_0x82e17b,_0x71e70=getEnabledBots();if(_0x71e70[_0x123d24(0xa7)]==0x0)await sendTelegram(_0x7a0f89[_0x123d24(0x1d9)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x71e70['length']>0x1){let _0x3d1f72=[],_0x1a3b3b=[];const _0x3dd001=_0x71e70[_0x123d24(0xa7)]%0x4==0x0||_0x71e70[_0x123d24(0xa7)]%0x4==0x3||_0x71e70[_0x123d24(0xa7)]%0x3==0x1?0x4:0x3;let _0x35a611=0x0;_0x71e70[_0x123d24(0xb0)]((_0x1ff141,_0x5c17d6)=>{const _0x35c9ef=_0x123d24;if(_0x5c17d6%_0x3dd001==0x0)_0x1a3b3b=[];_0x1a3b3b[_0x35c9ef(0x22a)](Markup['button'][_0x35c9ef(0xca)](_0x35c9ef(0x9d)+_0x1ff141[_0x35c9ef(0xf1)],'metrics_'+_0x1ff141['botID'])),_0x5c17d6%_0x3dd001==0x0&&(_0x3d1f72[_0x35a611]=_0x1a3b3b,_0x35a611++);});const _0x24fe1a=Markup[_0x123d24(0x17b)](_0x3d1f72);_0x7a0f89[_0x123d24(0x26b)](_0x123d24(0xc0),_0x24fe1a);}else{const _0x54b609=_0x71e70[0x0][_0x123d24(0xf1)];if(pid[_0x54b609])pid[_0x54b609][_0x123d24(0x1e9)]({'function':_0x123d24(0x1dd),'args':null});}}}),tgBot[_0x82e17b(0xc6)](/metrics_(.+)/,async _0x5c1058=>{const _0x338717=_0x82e17b,_0x50b2ba=_0x5c1058[_0x338717(0x110)][0x1];_0x5c1058[_0x338717(0xf8)]();if(pid[_0x50b2ba])pid[_0x50b2ba][_0x338717(0x1e9)]({'function':_0x338717(0x1dd),'args':null});}),tgBot['command'](_0x82e17b(0x1b1),async _0x3c9915=>{const _0x4d9a4c=_0x82e17b,_0x27de23=getEnabledBots();if(_0x27de23['length']==0x0)await sendTelegram(_0x3c9915[_0x4d9a4c(0x1d9)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x27de23[_0x4d9a4c(0xa7)]>0x1){let _0x9cc7fa=[],_0x2ebe83=[];const _0x228af8=_0x27de23[_0x4d9a4c(0xa7)]%0x4==0x0||_0x27de23['length']%0x4==0x3||_0x27de23[_0x4d9a4c(0xa7)]%0x3==0x1?0x4:0x3;let _0x48e366=0x0;_0x27de23[_0x4d9a4c(0xb0)]((_0x3b239e,_0x2cbc76)=>{const _0x30b107=_0x4d9a4c;if(_0x2cbc76%_0x228af8==0x0)_0x2ebe83=[];_0x2ebe83[_0x30b107(0x22a)](Markup['button'][_0x30b107(0xca)](_0x30b107(0x9d)+_0x3b239e[_0x30b107(0xf1)],'portfolio_'+_0x3b239e[_0x30b107(0xf1)])),_0x2cbc76%_0x228af8==0x0&&(_0x9cc7fa[_0x48e366]=_0x2ebe83,_0x48e366++);});const _0x375511=Markup[_0x4d9a4c(0x17b)](_0x9cc7fa);_0x3c9915[_0x4d9a4c(0x26b)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x375511);}else{const _0xfd7f9a=_0x27de23[0x0][_0x4d9a4c(0xf1)];if(pid[_0xfd7f9a])pid[_0xfd7f9a]['send']({'function':'sendPortfolioTelegram','args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x469c8f=>{const _0x26c782=_0x82e17b,_0xf3f156=_0x469c8f[_0x26c782(0x110)][0x1];_0x469c8f[_0x26c782(0xf8)]();if(pid[_0xf3f156])pid[_0xf3f156][_0x26c782(0x1e9)]({'function':_0x26c782(0x17c),'args':null});}),tgBot[_0x82e17b(0x1ab)](_0x82e17b(0x120),async _0x4e4a86=>{const _0x47a9a3=_0x82e17b;await getMessages();if(!updateAvailable)await sendTelegram(_0x4e4a86['chat']['id'],_0x47a9a3(0x1c0));else{if(!validInstallation)await sendTelegram(_0x4e4a86['chat']['id'],_0x47a9a3(0x26c));else{const _0x20aa0d=Markup['inlineKeyboard']([Markup[_0x47a9a3(0x1bf)][_0x47a9a3(0xca)]('Yes','update_yes'),Markup[_0x47a9a3(0x1bf)][_0x47a9a3(0xca)]('No','update_no')]);_0x4e4a86[_0x47a9a3(0x26b)]('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x20aa0d);}}}),tgBot[_0x82e17b(0xc6)](/update_(.+)/,async _0x4c78a2=>{const _0x30d84b=_0x82e17b,_0xa995aa=_0x4c78a2[_0x30d84b(0x110)][0x1];_0x4c78a2[_0x30d84b(0xf8)](),_0xa995aa=='yes'&&(await sendTelegram(_0x4c78a2[_0x30d84b(0x1d9)]['id'],_0x30d84b(0x175)),updateBB(_0x30d84b(0x120))),_0xa995aa=='no'&&await sendTelegram(_0x4c78a2[_0x30d84b(0x1d9)]['id'],_0x30d84b(0x17d));}),tgBot[_0x82e17b(0x1ab)](_0x82e17b(0x24e),async _0x10e85f=>{const _0x3fb0e4=_0x82e17b;if(!validInstallation)await sendTelegram(_0x10e85f['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x4d2b9e=Markup[_0x3fb0e4(0x17b)]([Markup[_0x3fb0e4(0x1bf)][_0x3fb0e4(0xca)]('Yes',_0x3fb0e4(0x124)),Markup[_0x3fb0e4(0x1bf)][_0x3fb0e4(0xca)]('No',_0x3fb0e4(0x153))]);_0x10e85f['reply']('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x4d2b9e);}}),tgBot['action'](/reinstall_(.+)/,async _0x52bd74=>{const _0x4bfd1e=_0x82e17b,_0x1821de=_0x52bd74[_0x4bfd1e(0x110)][0x1];_0x52bd74[_0x4bfd1e(0xf8)](),_0x1821de==_0x4bfd1e(0xbb)&&(await sendTelegram(_0x52bd74['chat']['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB('reinstall')),_0x1821de=='no'&&await sendTelegram(_0x52bd74[_0x4bfd1e(0x1d9)]['id'],_0x4bfd1e(0xb2));}),tgBot['command'](_0x82e17b(0xad),async _0x3f698b=>{const _0x2c151f=_0x82e17b,_0x318289=getBotsWithMode();if(_0x318289[_0x2c151f(0xa7)]==0x0)await sendTelegram(_0x3f698b[_0x2c151f(0x1d9)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x26bf6f=[],_0x75aaf0=[];const _0x29a688=0x2;let _0x2ba84f=0x0;_0x318289[_0x2c151f(0xb0)]((_0x319ede,_0x38bf6d)=>{const _0x31ac5a=_0x2c151f;if(_0x38bf6d%_0x29a688==0x0)_0x75aaf0=[];_0x75aaf0[_0x31ac5a(0x22a)](Markup[_0x31ac5a(0x1bf)][_0x31ac5a(0xca)](_0x31ac5a(0x9d)+_0x319ede[_0x31ac5a(0xf1)]+'\x20('+_0x319ede[_0x31ac5a(0x18c)]+')',_0x31ac5a(0x224)+_0x319ede['botID'])),_0x38bf6d%_0x29a688==0x0&&(_0x26bf6f[_0x2ba84f]=_0x75aaf0,_0x2ba84f++);});const _0xec7b87=Markup['inlineKeyboard'](_0x26bf6f);_0x3f698b[_0x2c151f(0x26b)](_0x2c151f(0xe1),_0xec7b87);}}),tgBot[_0x82e17b(0xc6)](/toggle_(.+)/,async _0x5de28d=>{const _0x5168a6=_0x82e17b,_0x53f49b=_0x5de28d[_0x5168a6(0x110)][0x1];_0x5de28d[_0x5168a6(0xf8)]();const _0x1c732b=getBotsWithMode(),_0x20d79c=_0x1c732b[_0x5168a6(0x22d)](_0x4d5ba5=>_0x4d5ba5['botID']==_0x53f49b),_0x578fbe=_0x20d79c[_0x5168a6(0x18c)]==_0x5168a6(0x160)?_0x5168a6(0x20e):_0x5168a6(0x160);await sendTelegram(_0x5de28d[_0x5168a6(0x1d9)]['id'],_0x5168a6(0x163)+_0x53f49b+_0x5168a6(0x27d)+_0x578fbe+_0x5168a6(0x1d7)),toggleBotMode(_0x53f49b);}),tgBot[_0x82e17b(0x1ab)]('names',async _0x258eb1=>{const _0x28d014=_0x82e17b;let _0x5db449='';config[_0x28d014(0xb0)](_0x5d3c97=>{const _0x17fe93=_0x28d014;_0x5db449+=_0x17fe93(0x9d)+_0x5d3c97[_0x17fe93(0xf1)]+':\x20'+_0x5d3c97[_0x17fe93(0x284)]+'\x0a';}),await sendTelegram(_0x258eb1['chat']['id'],_0x5db449,{'parse_mode':'HTML'});}),tgBot[_0x82e17b(0x1ab)]('help',async _0x9899bf=>{const _0x2b3b61=_0x82e17b;await sendTelegram(_0x9899bf[_0x2b3b61(0x1d9)]['id'],_0x3b6bd4);}),process[_0x82e17b(0x1e5)](_0x82e17b(0x1a9),()=>tgBot[_0x82e17b(0xe6)](_0x82e17b(0x1a9))),process[_0x82e17b(0x1e5)](_0x82e17b(0x192),()=>tgBot[_0x82e17b(0xe6)](_0x82e17b(0x192))),tgBot[_0x82e17b(0xfd)]();}}function disableTelegram(){const _0x1483ce=_0x418075;tgBot&&tgBot[_0x1483ce(0xe6)]();}async function sendTelegram(_0xea4fc,_0x571873,_0x5f4f88){const _0x44eaf4=_0x418075;_0x5f4f88={..._0x5f4f88,'disable_web_page_preview':!![]};try{await tgBot['telegram'][_0x44eaf4(0x11a)](_0xea4fc,_0x571873,_0x5f4f88);}catch(_0x37cac9){console[_0x44eaf4(0x1b5)]('Telegram\x20error:',_0x37cac9);}}async function sendTelegramBot(_0x15c0b0,_0x1221ee){const _0x214cc6=_0x418075;if(settings[_0x214cc6(0x137)]){if(settings[_0x214cc6(0x164)]==_0x214cc6(0x150)||(_0x1221ee[_0x214cc6(0xff)]==_0x214cc6(0x1dc)||_0x1221ee[_0x214cc6(0xff)]=='warning'||_0x1221ee['type']==_0x214cc6(0xd4))&&settings[_0x214cc6(0x164)]==_0x214cc6(0xe3)||_0x1221ee[_0x214cc6(0xff)]=='order'&&settings[_0x214cc6(0x164)]=='orders'){if(tgBot&&settings['telegramChatId']){if(_0x1221ee[_0x214cc6(0x278)])await sendTelegram(settings[_0x214cc6(0x21d)],_0x1221ee[_0x214cc6(0x284)]+'\x20>\x20'+_0x1221ee[_0x214cc6(0x1ac)]);else await sendTelegram(settings[_0x214cc6(0x21d)],_0x214cc6(0x9d)+_0x15c0b0+_0x214cc6(0x1fc)+_0x1221ee[_0x214cc6(0x1ac)]);}}}}async function sendTelegramMsg(_0x419510,_0x8939fc=_0x418075(0x13e)){const _0x4d91cb=_0x418075;return settings[_0x4d91cb(0x137)]&&tgBot&&settings[_0x4d91cb(0x21d)]?(await sendTelegram(settings[_0x4d91cb(0x21d)],_0x419510,{'parse_mode':_0x8939fc}),!![]):![];}function getDeviceWithIp(_0x4001d6){return devices['find'](_0x192cea=>_0x192cea['ip']===_0x4001d6);}async function temporaryAccess2FA(_0x477bb9,_0x3e0f02){const _0x8fdbe9=_0x418075;let _0x5550d2=new Date(),_0x5e71d3=![];if(lastIpApproval){if(_0x5550d2-lastIpApproval<0x1388)_0x5e71d3=!![];}lastIpApproval=new Date();if(_0x5e71d3)return;if(tgBot&&settings[_0x8fdbe9(0x21d)]){const _0x4d6973=uuidRandom();tmpStorage[_0x4d6973]={'uuid':_0x477bb9,'externalip':_0x3e0f02};const _0x1754f4=Markup[_0x8fdbe9(0x17b)]([Markup[_0x8fdbe9(0x1bf)][_0x8fdbe9(0xca)](_0x8fdbe9(0x262),_0x8fdbe9(0x26a)+_0x4d6973),Markup[_0x8fdbe9(0x1bf)][_0x8fdbe9(0xca)](_0x8fdbe9(0xf5),_0x8fdbe9(0x232)+_0x4d6973),Markup[_0x8fdbe9(0x1bf)]['callback'](_0x8fdbe9(0x199),_0x8fdbe9(0x265)+_0x4d6973),Markup[_0x8fdbe9(0x1bf)]['callback'](_0x8fdbe9(0x25e),_0x8fdbe9(0xee)+_0x4d6973)]);await sendTelegram(settings[_0x8fdbe9(0x21d)],_0x8fdbe9(0x258)+normalizeIP(_0x3e0f02)[_0x8fdbe9(0xe0)]+'\x20?',_0x1754f4),tgBot[_0x8fdbe9(0xc6)](/tempaccess_(.+)_(.+)/,async _0x2c1cc6=>{const _0x3fa587=_0x8fdbe9,_0x22b981=_0x2c1cc6[_0x3fa587(0x110)][0x1],_0x53ef31=_0x2c1cc6[_0x3fa587(0x110)][0x2],{uuid:_0x2625a,externalip:_0x875bb4}=tmpStorage[_0x53ef31];delete tmpStorage[_0x53ef31],_0x2c1cc6[_0x3fa587(0xf8)](),devices[_0x2625a][_0x3fa587(0x143)]={'clientip':_0x875bb4,'timestamp':new Date()[_0x3fa587(0x10a)](),'expiry':_0x22b981},_0x22b981!=_0x3fa587(0x25e)?(await sendTelegram(_0x2c1cc6[_0x3fa587(0x1d9)]['id'],_0x3fa587(0x28c)+_0x22b981+_0x3fa587(0x23b),{'parse_mode':'HTML'}),io['to'](_0x2625a)['emit']('status',{'access':{'allow':![],'reason':_0x3fa587(0x236),'token':null}})):(await sendTelegram(_0x2c1cc6[_0x3fa587(0x1d9)]['id'],_0x3fa587(0x1f5)),io['to'](_0x2625a)[_0x3fa587(0xb6)](_0x3fa587(0x23c),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0x32b83e,_0x5b8310){const _0x31ee20=_0x418075;if(tgBot&&settings[_0x31ee20(0x21d)]){const _0x59fb7c=uuidRandom();tmpStorage[_0x59fb7c]={'uuid':_0x32b83e,'externalip':_0x5b8310};const _0x36a598=Markup[_0x31ee20(0x17b)]([Markup[_0x31ee20(0x1bf)][_0x31ee20(0xca)](_0x31ee20(0x1a4),_0x31ee20(0x28f)+loginExpiry+'_'+_0x59fb7c),Markup[_0x31ee20(0x1bf)]['callback'](_0x31ee20(0x25e),_0x31ee20(0xdc)+_0x59fb7c)]);await sendTelegram(settings[_0x31ee20(0x21d)],_0x31ee20(0x1c8)+normalizeIP(_0x5b8310)[_0x31ee20(0xe0)]+'\x20?',_0x36a598),tgBot[_0x31ee20(0xc6)](/login2fa_(.+)_(.+)/,async _0x18ad00=>{const _0x43eae5=_0x31ee20,_0x599d92=_0x18ad00[_0x43eae5(0x110)][0x1],_0x5b0f88=_0x18ad00[_0x43eae5(0x110)][0x2],{uuid:_0x541d87,externalip:_0xdcf8a8}=tmpStorage[_0x5b0f88];delete tmpStorage[_0x5b0f88],_0x18ad00['editMessageReplyMarkup'](),devices[_0x541d87][_0x43eae5(0xe9)]={'clientip':_0xdcf8a8,'timestamp':new Date()[_0x43eae5(0x10a)](),'expiry':_0x599d92},_0x599d92!=_0x43eae5(0x25e)?(await sendTelegram(_0x18ad00[_0x43eae5(0x1d9)]['id'],'Login\x20accepted',{'parse_mode':_0x43eae5(0x13e)}),io['to'](_0x541d87)[_0x43eae5(0xb6)](_0x43eae5(0x23c),{'access':{'allow':![],'reason':_0x43eae5(0x236),'token':null}})):(await sendTelegram(_0x18ad00[_0x43eae5(0x1d9)]['id'],'Login\x20rejected'),io['to'](_0x541d87)[_0x43eae5(0xb6)](_0x43eae5(0x23c),{'access':{'allow':![],'reason':_0x43eae5(0xc9),'token':null}}));});}}function _0x5769(_0x551e7e,_0x39bff2){const _0x3aaf11=_0x2335();return _0x5769=function(_0x319471,_0x371de3){_0x319471=_0x319471-0x9c;let _0x233553=_0x3aaf11[_0x319471];return _0x233553;},_0x5769(_0x551e7e,_0x39bff2);}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x297646=_0x418075;return dbConfig[_0x297646(0x118)]('bots')[_0x297646(0x1b3)](_0x297646(0xf1))[_0x297646(0x1d4)]({'status':_0x297646(0xfc)})[_0x297646(0x138)]()||[];}function getDisabledBots(){const _0x50ec44=_0x418075;return dbConfig['get'](_0x50ec44(0x200))['sortBy'](_0x50ec44(0xf1))['filter']({'status':'disabled'})['value']()||[];}function getBotAttributes(_0x515530){const _0x5c0e93=_0x418075;let _0x423058={};const _0x5d63a7=configpath+_0x5c0e93(0x1d3)+_0x515530+_0x5c0e93(0x19a),_0x28188f=fs[_0x5c0e93(0x186)](_0x5d63a7);if(_0x28188f){const _0x1053dd=fs[_0x5c0e93(0x289)](_0x5d63a7);try{const _0x1c8ec4=JSON[_0x5c0e93(0xa1)](_0x1053dd),_0x3230e1=_0x1c8ec4?_0x1c8ec4[_0x5c0e93(0x23f)][0x0][_0x5c0e93(0x23e)]:![];_0x423058[_0x5c0e93(0x18c)]=_0x3230e1?_0x5c0e93(0x160):'manual',_0x423058[_0x5c0e93(0x284)]=_0x1c8ec4?_0x1c8ec4[_0x5c0e93(0x23f)][0x0]['botname']:'Bot\x20'+_0x515530;}catch(_0x1ed133){_0x423058[_0x5c0e93(0x18c)]='manual',_0x423058['botname']='Bot\x20'+_0x515530;}}else _0x423058[_0x5c0e93(0x18c)]='manual',_0x423058[_0x5c0e93(0x284)]=_0x5c0e93(0x9d)+_0x515530;return _0x423058;}function getBotsWithMode(){const _0x8353e9=_0x418075,_0x3dc12c=dbConfig[_0x8353e9(0x118)](_0x8353e9(0x200))[_0x8353e9(0x1b3)](_0x8353e9(0xf1))['value']()||[];return _0x3dc12c[_0x8353e9(0xb0)](_0xb1e06d=>{const _0x44f7cb=_0x8353e9;let _0x21ba04=getBotAttributes(_0xb1e06d[_0x44f7cb(0xf1)]);_0xb1e06d[_0x44f7cb(0x18c)]=_0x21ba04[_0x44f7cb(0x18c)];}),_0x3dc12c;}function getBotExchanges(){const _0xd9d1aa=_0x418075;let _0x1960cd=[];const _0x108888=dbConfig[_0xd9d1aa(0x118)](_0xd9d1aa(0x200))[_0xd9d1aa(0x1b3)]('botID')[_0xd9d1aa(0x138)]()||[];_0x108888[_0xd9d1aa(0xb0)](_0x5efa6f=>{const _0xd4d8a4=_0xd9d1aa;if(_0x5efa6f['status']==_0xd4d8a4(0xfc)){const _0x387a59=configpath+_0xd4d8a4(0x1d3)+_0x5efa6f['botID']+'-config.json',_0x2376aa=fs[_0xd4d8a4(0x186)](_0x387a59);let _0x3fca5;if(_0x2376aa){const _0x4651a5=fs[_0xd4d8a4(0x289)](_0x387a59);try{const _0x2f8ea7=JSON['parse'](_0x4651a5);_0x3fca5=_0x2f8ea7?_0x2f8ea7[_0xd4d8a4(0x23f)][0x0][_0xd4d8a4(0x1fb)]:null;}catch(_0xa5e420){}}if(_0x3fca5)_0x1960cd['push'](_0x3fca5);}});const _0x2fbf48=[...new Set(_0x1960cd)][_0xd9d1aa(0x1ad)]();return _0x2fbf48;}async function initUser(){const _0x143c76=_0x418075;if(!settings[_0x143c76(0x263)]){const _0x218757=uuidRandom();mixpanel[_0x143c76(0x168)](_0x218757),updateSetting(_0x143c76(0x263),_0x218757);}}async function initSecure(){const _0x3454c8=_0x418075;let _0x5ee190=getSecure();if(!_0x5ee190[_0x3454c8(0x209)](_0x3454c8(0x25d))){let _0x43ec15=await generateKeys();_0x5ee190['publicKey']=_0x43ec15[_0x3454c8(0xfb)],_0x5ee190[_0x3454c8(0x146)]=_0x43ec15['privateKey'],_0x5ee190[_0x3454c8(0x25d)]=crypto[_0x3454c8(0x271)](0x20)[_0x3454c8(0x13c)](_0x3454c8(0x23a));;storeSecure(_0x5ee190);}}function getSettings(){const _0x455873=_0x418075;return dbSettings[_0x455873(0x118)](_0x455873(0x251))[_0x455873(0x138)]()||{};}function getSecure(){const _0xca1f70=_0x418075;return dbSecure[_0xca1f70(0x118)](_0xca1f70(0x1a0))['value']()||{};}function getBlacklist(){const _0x24f0bf=_0x418075;return dbSecure[_0x24f0bf(0x118)](_0x24f0bf(0x257))[_0x24f0bf(0x138)]()||[];}function broadcastToBots(_0x219eee,_0x5bfd58){config['forEach'](_0xc4caed=>{const _0x1b666e=_0x5769;if(_0xc4caed[_0x1b666e(0x23c)]==_0x1b666e(0xfc)&&_0xc4caed['live']==_0x1b666e(0x174)||_0xc4caed[_0x1b666e(0x23c)]==_0x1b666e(0x1c1)&&_0xc4caed[_0x1b666e(0xbd)]=='running'){if(pid[_0xc4caed[_0x1b666e(0xf1)]])pid[_0xc4caed[_0x1b666e(0xf1)]][_0x1b666e(0x1e9)]({[_0x219eee]:_0x5bfd58});}});}async function storeSettings(_0x3cab48,_0x57c477=![]){const _0x451949=_0x418075;_0x3cab48={...settings,..._0x3cab48};if(_0x57c477&&_0x3cab48[_0x451949(0x20d)]!='************'&&_0x3cab48[_0x451949(0x20d)]!='***'&&_0x3cab48[_0x451949(0x20d)]!=''){const _0xa26a26=decryptRSA(secure[_0x451949(0x146)],_0x3cab48[_0x451949(0x20d)])[_0x451949(0x24c)](_0x451949(0x261))[0x0],_0x5ed4fd=bcrypt[_0x451949(0x272)](_0xa26a26,saltRounds);_0x3cab48={..._0x3cab48,'bbPassword':_0x5ed4fd};}if(_0x57c477&&_0x3cab48[_0x451949(0x1ed)]!='************'&&_0x3cab48[_0x451949(0x1ed)]!=_0x451949(0x1f8)&&_0x3cab48[_0x451949(0x1ed)]!=''){const _0x5854ab=decryptRSA(secure[_0x451949(0x146)],_0x3cab48[_0x451949(0x1ed)])[_0x451949(0x24c)](_0x451949(0x261))[0x0];_0x3cab48={..._0x3cab48,'telegramToken':_0x5854ab};}if(_0x57c477&&_0x3cab48[_0x451949(0x242)]!='************'&&_0x3cab48[_0x451949(0x242)]!=_0x451949(0x1f8)&&_0x3cab48[_0x451949(0x242)]!=''){const _0x5ab793=decryptRSA(secure['privateKey'],_0x3cab48[_0x451949(0x242)])[_0x451949(0x24c)]('|@|')[0x0];_0x3cab48={..._0x3cab48,'marketcapApi':_0x5ab793};}const _0x4b1be7=_0x3cab48[_0x451949(0x1ed)]!=_0x451949(0x1bd)&&_0x3cab48[_0x451949(0x1ed)]!=settings[_0x451949(0x1ed)]||_0x3cab48[_0x451949(0x111)]!=settings[_0x451949(0x111)],_0x1ebfc7=_0x3cab48['telegramToken']==''||_0x3cab48[_0x451949(0x111)]=='',_0x105503=_0x3cab48['marketcapApi']&&_0x3cab48[_0x451949(0x242)]!=_0x451949(0x1bd)&&_0x3cab48[_0x451949(0x242)]!=settings[_0x451949(0x1ed)];_0x4b1be7&&(_0x3cab48['telegramChatId']=null,_0x3cab48[_0x451949(0x164)]=_0x451949(0x150));for(const [_0x3d5a40,_0x4c94e4]of Object[_0x451949(0x16d)](_0x3cab48)){if(_0x3d5a40=='telegramToken'&&_0x4c94e4==_0x451949(0x1bd)){_0x3cab48['telegramToken']=settings['telegramToken'];continue;};if(_0x3d5a40==_0x451949(0x20d)&&_0x4c94e4==_0x451949(0x1bd)){_0x3cab48[_0x451949(0x20d)]=settings['bbPassword'];continue;};if(_0x3d5a40=='marketcapApi'&&_0x4c94e4=='************'){_0x3cab48[_0x451949(0x242)]=settings[_0x451949(0x242)];continue;};dbSettings[_0x451949(0xc3)](_0x451949(0xa0)+_0x3d5a40,_0x4c94e4)['write']();}settings=_0x3cab48,io['to']('botmanager')['emit'](_0x451949(0x251),cleanSettings()),broadcastToBots(_0x451949(0x1c2),settings[_0x451949(0x1c2)]),broadcastToBots(_0x451949(0x169),settings[_0x451949(0x169)]),broadcastToBots(_0x451949(0x242),settings[_0x451949(0x242)]);if(_0x4b1be7&&!_0x1ebfc7)initTelegram();if(_0x4b1be7&&_0x1ebfc7)disableTelegram();getAllClients()['forEach'](_0x2849d3=>{const _0x51218e=_0x451949;getSocket(_0x2849d3['id'])[_0x51218e(0xb6)]('status',{'access':{'allow':![],'reason':'reload','token':null}});}),_0x105503&&(await sleep(0xbb8),testMarketcapApi(_0x3cab48[_0x451949(0x242)]));}async function testMarketcapApi(_0x507bfd){const _0x51a53a=_0x418075,_0x35bcae=['BCT',_0x51a53a(0x1a1)];try{await axios['get']('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0x507bfd},'params':{'symbol':_0x35bcae[_0x51a53a(0x13c)]()}});}catch(_0x25e897){_0x25e897[_0x51a53a(0x13c)]()[_0x51a53a(0xa4)](_0x51a53a(0x20b))?(io['to']('botmanager')['emit'](_0x51a53a(0x16c),_0x51a53a(0x264)),logger[_0x51a53a(0xd8)](_0x51a53a(0x264))):(io['to'](_0x51a53a(0x148))['emit'](_0x51a53a(0x16c),_0x51a53a(0x1e4)),logger['full']('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x51a53a(0xab)]('Error\x20details:',_0x25e897[_0x51a53a(0x13c)]()+'\x20-\x20'+_0x25e897[_0x51a53a(0x12d)]));return;}logger[_0x51a53a(0xab)](_0x51a53a(0x26d));}function updateSetting(_0x202cf9,_0x97f10f){const _0x86c013=_0x418075;dbSettings[_0x86c013(0xc3)](_0x86c013(0xa0)+_0x202cf9,_0x97f10f)[_0x86c013(0x1a3)](),settings=getSettings(),io['to'](_0x86c013(0x148))['emit'](_0x86c013(0x251),cleanSettings());}function storeSecure(_0x269d4e){const _0x50a191=_0x418075;dbSecure[_0x50a191(0x118)](_0x50a191(0x1a0))['push'](_0x269d4e)[_0x50a191(0x1a3)](),secure=_0x269d4e;}function addBlacklist(_0x228550){const _0x349106=_0x418075;cleanBlacklist();let _0x114649;devices[_0x228550][_0x349106(0x143)]?_0x114649=Math['max'](devices[_0x228550][_0x349106(0x143)][_0x349106(0x18d)],loginExpiry):_0x114649=loginExpiry,dbSecure[_0x349106(0x118)]('blacklist')[_0x349106(0x22a)]({'expiry':new Date()[_0x349106(0x10a)]()+_0x114649*0x3c*0x3e8,'token':devices[_0x228550][_0x349106(0x162)][_0x349106(0xaa)]})[_0x349106(0x1a3)](),blacklist=dbSecure[_0x349106(0x118)](_0x349106(0x257))[_0x349106(0x138)]();}function cleanBlacklist(){const _0x19ff1c=_0x418075;let _0x5ddbbc=dbSecure['get']('blacklist')[_0x19ff1c(0x21e)]()['value'](),_0xad7f93=new Date()['getTime']();_0x5ddbbc['forEach'](_0x32f236=>{const _0x48b64b=_0x19ff1c;_0x32f236[_0x48b64b(0x18d)]<_0xad7f93&&dbSecure[_0x48b64b(0x118)](_0x48b64b(0x257))[_0x48b64b(0x219)]({'expiry':_0x32f236[_0x48b64b(0x18d)]})['write']();});}function initStates(){const _0xf9624c=_0x418075;let _0x4ad1f3=getConfiguration();_0x4ad1f3[_0xf9624c(0xb0)](_0x26e214=>{const _0x47a2e7=_0xf9624c;_0x26e214[_0x47a2e7(0xbd)]=_0x47a2e7(0x151);}),storeConfiguration(_0x4ad1f3);}async function generateKeys(){const _0x340d43=_0x418075,_0x5370bb=forge[_0x340d43(0xcb)][_0x340d43(0x244)][_0x340d43(0x170)]({'bits':0x1000,'e':0x10001}),_0x20eb10=forge[_0x340d43(0xcb)][_0x340d43(0x11d)](_0x5370bb[_0x340d43(0x146)]),_0xa42ea2=forge['pki'][_0x340d43(0x19c)](_0x5370bb[_0x340d43(0xfb)]);return{'privateKey':_0x20eb10,'publicKey':_0xa42ea2};}async function oneTimeMigration(){const _0x120747=_0x418075;let _0xebe4ec=getSettings(),_0x4ebb28=![];!_0xebe4ec[_0x120747(0x209)]('lastmsgtelegram')&&(_0xebe4ec['lastmsgtelegram']=0x0,_0x4ebb28=!![]);!_0xebe4ec[_0x120747(0x209)](_0x120747(0x1be))&&(_0xebe4ec[_0x120747(0x1be)]=0x0,_0x4ebb28=!![]);!_0xebe4ec[_0x120747(0x209)]('latestversion')&&(_0xebe4ec[_0x120747(0x1fd)]=_0x120747(0x202),_0x4ebb28=!![]);!_0xebe4ec[_0x120747(0x209)]('onepagemode')&&(_0xebe4ec[_0x120747(0x169)]=![],_0x4ebb28=!![]);!_0xebe4ec[_0x120747(0x209)](_0x120747(0x242))&&(_0xebe4ec[_0x120747(0x242)]='',_0x4ebb28=!![]);if(_0x4ebb28)storeSettings(_0xebe4ec);try{fs[_0x120747(0xb1)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x2504f0=>{const _0xfe7628=_0x120747;if(!_0x2504f0[_0xfe7628(0xc2)]()){if(!_0x2504f0[_0xfe7628(0x296)][_0xfe7628(0x15b)]('backup-full@'))fs[_0xfe7628(0xc5)](configbackuppath+_0x2504f0[_0xfe7628(0x296)]);}else fs[_0xfe7628(0x145)](configbackuppath+_0x2504f0[_0xfe7628(0x296)],{'recursive':!![]});});}catch(_0x556f4e){logger['debug'](_0x120747(0x1f0),_0x556f4e);}}function storeConfiguration(_0x3953c1){const _0x7e33b3=_0x418075;dbConfig[_0x7e33b3(0x118)]('bots')[_0x7e33b3(0x219)]()[_0x7e33b3(0x1a3)](),dbConfig[_0x7e33b3(0x118)](_0x7e33b3(0x200))[_0x7e33b3(0x22a)](..._0x3953c1)[_0x7e33b3(0x1a3)](),config=_0x3953c1;}async function resetPassword(){const _0x2dad8b=_0x418075;if(tgBot&&settings['telegramChatId']){const _0x282166=Markup['inlineKeyboard']([Markup['button'][_0x2dad8b(0xca)](_0x2dad8b(0xbb),_0x2dad8b(0x1e6)),Markup[_0x2dad8b(0x1bf)][_0x2dad8b(0xca)]('no',_0x2dad8b(0x1da))]);await sendTelegram(settings['telegramChatId'],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x282166),tgBot[_0x2dad8b(0xc6)](/resetpw_(.+)/,async _0x5e53e2=>{const _0x13e2ca=_0x2dad8b,_0x50a24c=_0x5e53e2[_0x13e2ca(0x110)][0x1];_0x5e53e2['editMessageReplyMarkup']();if(_0x50a24c!='no'){const _0x302bac=0xf,_0x674ba0='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x2923e5=Array[_0x13e2ca(0x109)](crypto[_0x13e2ca(0x275)](new Uint32Array(_0x302bac)))['map'](_0x501594=>_0x674ba0[_0x501594%_0x674ba0['length']])[_0x13e2ca(0xd5)](''),_0x3d98c7=bcrypt[_0x13e2ca(0x272)](_0x2923e5,saltRounds);storeSettings({'bbPassword':_0x3d98c7}),await sendTelegram(_0x5e53e2[_0x13e2ca(0x1d9)]['id'],_0x13e2ca(0x179)+_0x2923e5,{'parse_mode':_0x13e2ca(0x13e)});}else await sendTelegram(_0x5e53e2[_0x13e2ca(0x1d9)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x5d0c97,_0x416565){const _0x1cf61f=_0x418075;io['to'](_0x1cf61f(0x148))[_0x1cf61f(0xb6)](_0x1cf61f(0x16c),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x1cf61f(0xd4));if(tgBot&&settings['telegramChatId']){const _0x554bdd=uuidRandom();tmpStorage[_0x554bdd]={'path':_0x5d0c97,'filename':_0x416565};const _0x5bd1cd=Markup['inlineKeyboard']([Markup['button'][_0x1cf61f(0xca)](_0x1cf61f(0xbb),'restore_yes_'+_0x554bdd),Markup[_0x1cf61f(0x1bf)][_0x1cf61f(0xca)]('no',_0x1cf61f(0xb9)+_0x554bdd)]);await sendTelegram(settings[_0x1cf61f(0x21d)],_0x1cf61f(0x27f),_0x5bd1cd),tgBot[_0x1cf61f(0xc6)](/restore_(.+)_(.+)/,async _0x34e643=>{const _0x4c8bbf=_0x1cf61f,_0x113559=_0x34e643[_0x4c8bbf(0x110)][0x1],_0x192d8a=_0x34e643[_0x4c8bbf(0x110)][0x2],{path:_0x56a2e8,filename:_0x3b65bf}=tmpStorage[_0x192d8a];delete tmpStorage[_0x192d8a],_0x34e643[_0x4c8bbf(0xf8)](),_0x113559=='yes'?(logger[_0x4c8bbf(0xab)]('Restore\x20process\x20confirmed'),await sendTelegram(_0x34e643[_0x4c8bbf(0x1d9)]['id'],_0x4c8bbf(0x201),{'parse_mode':_0x4c8bbf(0x13e)}),unzipFile(_0x56a2e8,_0x3b65bf)):(logger['debug'](_0x4c8bbf(0x24a)),await sendTelegram(_0x34e643[_0x4c8bbf(0x1d9)]['id'],_0x4c8bbf(0x24a)));});}}function getServerTime(){const _0x513010=_0x418075,_0x598f04=new Date();return _0x598f04[_0x513010(0xde)]()+'/'+(_0x598f04['getMonth']()+0x1)[_0x513010(0x13c)]()[_0x513010(0xeb)](0x2,'0')+'/'+_0x598f04[_0x513010(0x1a5)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x598f04[_0x513010(0x1f9)]()['toString']()['padStart'](0x2,'0')+':'+_0x598f04['getMinutes']()[_0x513010(0x13c)]()[_0x513010(0xeb)](0x2,'0')+':'+_0x598f04[_0x513010(0xf0)]()[_0x513010(0x13c)]()[_0x513010(0xeb)](0x2,'0');}function getTimeStamp(){const _0x5bb5d3=_0x418075,_0x223494=shiftedTime();return _0x223494['getFullYear']()+'/'+(_0x223494[_0x5bb5d3(0x16e)]()+0x1)[_0x5bb5d3(0x13c)]()[_0x5bb5d3(0xeb)](0x2,'0')+'/'+_0x223494[_0x5bb5d3(0x1a5)]()[_0x5bb5d3(0x13c)]()['padStart'](0x2,'0')+'\x20'+_0x223494['getHours']()[_0x5bb5d3(0x13c)]()['padStart'](0x2,'0')+':'+_0x223494[_0x5bb5d3(0x1f7)]()['toString']()['padStart'](0x2,'0')+':'+_0x223494['getSeconds']()[_0x5bb5d3(0x13c)]()[_0x5bb5d3(0xeb)](0x2,'0');}function getCleanTimeStamp(){const _0x22ed9e=_0x418075,_0x562bf6=shiftedTime();return _0x562bf6[_0x22ed9e(0xde)]()+(_0x562bf6[_0x22ed9e(0x16e)]()+0x1)[_0x22ed9e(0x13c)]()[_0x22ed9e(0xeb)](0x2,'0')+_0x562bf6[_0x22ed9e(0x1a5)]()[_0x22ed9e(0x13c)]()[_0x22ed9e(0xeb)](0x2,'0')+'-'+_0x562bf6[_0x22ed9e(0x1f9)]()[_0x22ed9e(0x13c)]()[_0x22ed9e(0xeb)](0x2,'0')+_0x562bf6['getMinutes']()['toString']()[_0x22ed9e(0xeb)](0x2,'0')+_0x562bf6[_0x22ed9e(0xf0)]()[_0x22ed9e(0x13c)]()[_0x22ed9e(0xeb)](0x2,'0');}function shiftedTime(){const _0x240c3d=_0x418075,_0x3e574b=new Date();let _0x2e2b57=_0x3e574b;if(settings[_0x240c3d(0x1c2)]&&settings['timeshift']!==0x0)_0x2e2b57=fns['add'](_0x3e574b,{'hours':settings[_0x240c3d(0x1c2)]});return _0x2e2b57;}async function startScheduler(){const _0x4cf5e3=_0x418075,_0x128180=new Date()[_0x4cf5e3(0x1a7)](),_0x461d60=shiftedTime()[_0x4cf5e3(0x1f9)]();_0x461d60==0x4&&backupConfigFiles(),_0x461d60==0x0&&rotateLogFiles(),_0x128180%0x6==0x0&&triggerAnalytics(),_0x128180%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0xd1937){const _0x1f06f4=_0x418075;logger[_0x1f06f4(0xab)](_0x1f06f4(0x193)+_0xd1937);const _0x434e0c=getBotsWithMode();_0x434e0c[_0x1f06f4(0xa7)]>0x0?confirmRestore(configbackuppath,_0xd1937):unzipFile(configbackuppath,_0xd1937);}async function getBackupFiles(_0xde88f1=null){const _0xe518a2=_0x418075;let _0x3f4e90=[],_0x340a3a=fs[_0xe518a2(0xb1)](configbackuppath,{'withFileTypes':!![]});_0x340a3a['sort']((_0x101120,_0x48310d)=>_0x101120[_0xe518a2(0x296)]<_0x48310d[_0xe518a2(0x296)]?0x1:_0x48310d[_0xe518a2(0x296)]<_0x101120[_0xe518a2(0x296)]?-0x1:0x0),_0x340a3a[_0xe518a2(0xb0)](_0x584119=>{const _0xf07e96=_0xe518a2;if(!_0x584119[_0xf07e96(0xc2)]()&&_0x584119[_0xf07e96(0x296)]['startsWith'](_0xf07e96(0x188))&&_0x584119[_0xf07e96(0x296)][_0xf07e96(0x154)]('.zip')){const _0xcc35f8=formatDate(fs[_0xf07e96(0xd9)](configbackuppath+_0x584119[_0xf07e96(0x296)])['mtime']);_0x3f4e90[_0xf07e96(0x22a)]({'name':_0x584119[_0xf07e96(0x296)],'mtime':_0xcc35f8});}});if(_0xde88f1)io['to'](_0xde88f1)[_0xe518a2(0xb6)](_0xe518a2(0x125),_0x3f4e90);else return _0x3f4e90;}async function backupConfigFiles(){const _0xdbdc58=_0x418075;await zipFiles(_0xdbdc58(0x130));const _0x5dfeab=getCleanTimeStamp();fs[_0xdbdc58(0x166)](zippath+_0xdbdc58(0xc7),configbackuppath+(_0xdbdc58(0x188)+_0x5dfeab+_0xdbdc58(0x287)));let _0x3446ab=fs[_0xdbdc58(0xb1)](configbackuppath,{'withFileTypes':!![]});_0x3446ab[_0xdbdc58(0x1ad)]((_0x307572,_0x1fbf66)=>_0x307572[_0xdbdc58(0x296)]<_0x1fbf66['name']?0x1:_0x1fbf66[_0xdbdc58(0x296)]<_0x307572['name']?-0x1:0x0),_0x3446ab['length']>maxBackups&&fs[_0xdbdc58(0xc5)](configbackuppath+_0x3446ab[_0x3446ab[_0xdbdc58(0xa7)]-0x1][_0xdbdc58(0x296)]);}function rotateLogFiles(){const _0x23b7fe=_0x418075,_0x57da0f=fs['statSync'](logspath+'output-000.log'),_0x5165a1=_0x57da0f[_0x23b7fe(0x28b)]/0x400;if(_0x5165a1>0x64){let _0x2e0f50=fs[_0x23b7fe(0xb1)](logspath,{'withFileTypes':!![]});_0x2e0f50['sort']((_0x3caa5c,_0x2c865f)=>_0x3caa5c[_0x23b7fe(0x296)]<_0x2c865f[_0x23b7fe(0x296)]?0x1:_0x2c865f[_0x23b7fe(0x296)]<_0x3caa5c[_0x23b7fe(0x296)]?-0x1:0x0),_0x2e0f50[_0x23b7fe(0xb0)](_0x26192b=>{const _0x133e6c=_0x23b7fe;if(_0x26192b[_0x133e6c(0x296)]==_0x133e6c(0x1d5))fs[_0x133e6c(0x166)](logspath+_0x26192b[_0x133e6c(0x296)],logspath+_0x133e6c(0x217));if(_0x26192b[_0x133e6c(0x296)]==_0x133e6c(0x27c))fs[_0x133e6c(0x166)](logspath+_0x26192b['name'],logspath+_0x133e6c(0x1d5));_0x26192b[_0x133e6c(0x296)]==_0x133e6c(0x194)&&(fs['copyFileSync'](logspath+_0x26192b[_0x133e6c(0x296)],logspath+_0x133e6c(0x27c)),fs[_0x133e6c(0xa6)](logspath+_0x26192b[_0x133e6c(0x296)],''));});}}async function zipFiles(_0x51d6d0){const _0x143668=_0x418075;let _0x4fb47b;if(_0x51d6d0==_0x143668(0x17f))_0x4fb47b=logspath;if(_0x51d6d0==_0x143668(0x171))_0x4fb47b=configpath;if(_0x51d6d0==_0x143668(0x130))_0x4fb47b=configpath;let _0x3697ac=fs[_0x143668(0xb1)](_0x4fb47b,{'withFileTypes':!![]});const _0x55f01b=new JSZip();_0x3697ac['forEach'](_0x9bf311=>{const _0xdf1ac5=_0x143668;if(!_0x9bf311[_0xdf1ac5(0xc2)]()){let _0x19f5bb=fs[_0xdf1ac5(0x289)](_0x4fb47b+_0x9bf311[_0xdf1ac5(0x296)]);if(_0x51d6d0==_0xdf1ac5(0x171)){const _0x35e0c1=/^bot-[0-9]{3}-config.json$/,_0x10d7e0=_0x35e0c1[_0xdf1ac5(0x195)](_0x9bf311[_0xdf1ac5(0x296)]);if(_0x10d7e0){const _0x9fe327=JSON[_0xdf1ac5(0xa1)](_0x19f5bb);if(_0x9fe327[_0xdf1ac5(0x23f)][0x0]){_0x9fe327[_0xdf1ac5(0x23f)][0x0][_0xdf1ac5(0x102)]=_0xdf1ac5(0x1f8),_0x9fe327[_0xdf1ac5(0x23f)][0x0]['apiSecret']='***';if(_0x9fe327[_0xdf1ac5(0x23f)][0x0]['apiPassword'])_0x9fe327[_0xdf1ac5(0x23f)][0x0][_0xdf1ac5(0x172)]=_0xdf1ac5(0x1f8);}_0x19f5bb=JSON['stringify'](_0x9fe327,null,0x2);}if(_0x9bf311[_0xdf1ac5(0x296)]=='bb-settings.json'){const _0x1f9e54=JSON[_0xdf1ac5(0xa1)](_0x19f5bb);if(_0x1f9e54[_0xdf1ac5(0x251)][_0xdf1ac5(0x26f)])_0x1f9e54[_0xdf1ac5(0x251)][_0xdf1ac5(0x26f)]=![];if(_0x1f9e54[_0xdf1ac5(0x251)]['bbPassword'])_0x1f9e54[_0xdf1ac5(0x251)][_0xdf1ac5(0x20d)]=_0xdf1ac5(0x1f8);if(_0x1f9e54[_0xdf1ac5(0x251)][_0xdf1ac5(0x1ed)])_0x1f9e54[_0xdf1ac5(0x251)][_0xdf1ac5(0x1ed)]=_0xdf1ac5(0x1f8);if(_0x1f9e54[_0xdf1ac5(0x251)][_0xdf1ac5(0x21d)])_0x1f9e54['settings'][_0xdf1ac5(0x21d)]=null;if(_0x1f9e54['settings'][_0xdf1ac5(0x242)])_0x1f9e54[_0xdf1ac5(0x251)][_0xdf1ac5(0x242)]=_0xdf1ac5(0x1f8);_0x19f5bb=JSON['stringify'](_0x1f9e54,null,0x2);}if(_0x9bf311[_0xdf1ac5(0x296)]!=_0xdf1ac5(0x1eb))_0x55f01b[_0xdf1ac5(0x207)](_0x9bf311[_0xdf1ac5(0x296)],_0x19f5bb);}else _0x55f01b['file'](_0x9bf311['name'],_0x19f5bb);}});const _0x52a1eb=await _0x55f01b[_0x143668(0xb3)]({'type':_0x143668(0xcf),'base64':![],'compression':'DEFLATE'});fs[_0x143668(0xa6)](zippath+(_0x51d6d0+_0x143668(0x287)),_0x52a1eb,'binary');}async function unzipFile(_0x543d95,_0x23c17a){const _0x1bf509=_0x418075;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x1bf509(0xb0)](_0x1dee34=>{const _0x2ecc55=_0x1bf509;if(!_0x1dee34[_0x2ecc55(0xc2)]())fs[_0x2ecc55(0x145)](configpath+_0x1dee34['name']);});const _0x4249a0=fs[_0x1bf509(0x289)](_0x543d95+_0x23c17a,'binary'),_0x37b47a=await JSZip[_0x1bf509(0x24f)](_0x4249a0,{'base64':![],'checkCRC32':!![]});for(const _0x2e5e15 of Object['keys'](_0x37b47a[_0x1bf509(0x10d)])){const _0x474e34=_0x37b47a[_0x1bf509(0x10d)][_0x2e5e15],_0x3052d0=await _0x474e34[_0x1bf509(0x260)]('string');fs[_0x1bf509(0xa6)](configpath+_0x474e34['name'],_0x3052d0);}fs[_0x1bf509(0xb1)](temppath,{'withFileTypes':!![]})[_0x1bf509(0xb0)](_0x16a4e4=>{const _0xe5e176=_0x1bf509;if(!_0x16a4e4[_0xe5e176(0xc2)]())fs[_0xe5e176(0x145)](temppath+_0x16a4e4[_0xe5e176(0x296)]);}),logger[_0x1bf509(0xab)](_0x1bf509(0x12f)),process[_0x1bf509(0x1e9)]({'restore':!![]},_0x4dcf0e=>{});}async function getPublicIp(){const _0x202359=_0x418075;try{const _0xed9abb=await axios['get'](_0x202359(0x248));publicip=_0xed9abb['data']['ip'];}catch(_0x60b6e0){}}async function triggerAnalytics(){const _0x3b3c2b=_0x418075;if(!publicip)await getPublicIp();const _0x9ae4b=getBotsWithMode();let _0x38160b=0x0;_0x9ae4b[_0x3b3c2b(0xb0)](_0x415a8b=>{const _0x1a108d=_0x3b3c2b;if(_0x415a8b[_0x1a108d(0x23c)]===_0x1a108d(0xfc))_0x38160b++;});const _0x8a31fe=getBotExchanges();mixpanel[_0x3b3c2b(0x26e)](_0x3b3c2b(0x1b0),{'distinct_id':settings[_0x3b3c2b(0x263)],'ip':publicip,'version':serverversion,'numbots':_0x9ae4b[_0x3b3c2b(0xa7)],'numbotsenabled':_0x38160b,'exchanges':_0x8a31fe,'environment':environment});}async function getMessages(){const _0x587c27=_0x418075,_0x530b69=_0x587c27(0xd0),_0x3c83d6=new GraphQLClient(_0x530b69),_0xf8ad0a={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x1b7d08=serverversion[_0x587c27(0x24c)]('.'),_0x2c3892=_0x1b7d08[0x0]+'.'+_0x1b7d08[0x1],_0x24004d=Math['min'](settings[_0x587c27(0x15d)],settings[_0x587c27(0x1be)]),_0x588b7d={'last':parseInt(_0x24004d),'bbm':_0x2c3892},_0x8678f0=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x56475a;try{_0x56475a=await _0x3c83d6[_0x587c27(0x1cf)](_0x8678f0,_0x588b7d,_0xf8ad0a);}catch(_0x1de7e9){}if(_0x56475a&&_0x56475a[_0x587c27(0x14b)]){let _0x45b9c7=settings[_0x587c27(0x15d)];newMessages=[];for(const _0x3314c3 of _0x56475a['messages']){newMessages[_0x587c27(0x22a)](_0x3314c3);let _0x19a671=![];_0x3314c3[_0x587c27(0x184)]&&(updateSetting(_0x587c27(0x1fd),_0x3314c3[_0x587c27(0x184)]),_0x19a671=isNewerVersion(serverversion,_0x3314c3[_0x587c27(0x184)])||serverversion==_0x3314c3[_0x587c27(0x184)]);if(!_0x19a671&&_0x3314c3[_0x587c27(0x108)]>_0x45b9c7){if(_0x3314c3[_0x587c27(0xd2)]===_0x587c27(0x1b9)||serverversion[_0x587c27(0x15b)](_0x3314c3[_0x587c27(0xd2)])){let _0x21c4e7=''+_0x3314c3[_0x587c27(0x1fa)]+'\x0a\x0a'+_0x3314c3['message'];const _0x214526=await sendTelegramMsg(toTelegramMarkdown(_0x21c4e7),'Markdown');if(_0x214526)_0x45b9c7=_0x3314c3[_0x587c27(0x108)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x587c27(0x15d),_0x45b9c7),emitMessages();}}function emitMessages(){const _0x38d7c7=_0x418075,_0x411184=settings[_0x38d7c7(0x1be)];let _0x39d2ab=[];newMessages[_0x38d7c7(0xb0)](_0x12a872=>{const _0x3c6ccb=_0x38d7c7;_0x12a872[_0x3c6ccb(0x108)]>_0x411184&&_0x39d2ab[_0x3c6ccb(0x22a)](_0x12a872);}),_0x39d2ab['length']>0x0&&getAllClients()[_0x38d7c7(0xb0)](_0x1e7990=>{const _0x56aaa6=_0x38d7c7;getSocket(_0x1e7990['id'])[_0x56aaa6(0xb6)](_0x56aaa6(0x112),_0x39d2ab);});}function confirmMessage(_0x5b25f4){updateSetting('lastmsgemitted',Number(_0x5b25f4));}function isNewerVersion(_0x5aacea,_0x3a799d){const _0x59004d=_0x418075,_0x1b8b89=_0x3a799d[_0x59004d(0x24c)]('.'),_0x349c6e=_0x5aacea[_0x59004d(0x24c)]('.');for(var _0x149ed8=0x0;_0x149ed8<_0x349c6e[_0x59004d(0xa7)];_0x149ed8++){const _0x2f5ba3=~~_0x349c6e[_0x149ed8],_0x13bf4e=~~_0x1b8b89[_0x149ed8];if(_0x2f5ba3>_0x13bf4e)return!![];if(_0x2f5ba3<_0x13bf4e)return![];}return![];}function toTelegramMarkdown(_0x4cd9be){const _0x117a2a=_0x418075,_0xbd2139=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3d72d3=/\*{2}(.+?)\*{2}/gim;return _0x4cd9be=_0x4cd9be[_0x117a2a(0x270)](_0xbd2139,_0x117a2a(0x22c))['replace'](_0x3d72d3,'*$1*'),_0x4cd9be;}async function validateConfigFile(){const _0x5d0530=_0x418075,_0xe52a54=dbConfig[_0x5d0530(0x118)](_0x5d0530(0x200))[_0x5d0530(0x1b3)](_0x5d0530(0xf1))[_0x5d0530(0x138)]()||[];if(_0xe52a54[_0x5d0530(0xa7)]==0x0){let _0x4545b8=0x0,_0x4e290d=[];const _0x432187=/^bot-([0-9]{3})-config.json$/,_0x26ebb1=fs[_0x5d0530(0xb1)](configpath);_0x26ebb1[_0x5d0530(0xb0)](_0x323d8e=>{const _0x4fdc5b=_0x5d0530,_0x4db05b=_0x432187['exec'](_0x323d8e);if(_0x4db05b){const _0x49064f=_0x4db05b[0x1];let _0x4db593=getBotAttributes(_0x49064f);_0x4e290d[_0x4fdc5b(0x22a)]({'botID':_0x49064f,'botname':_0x4db593[_0x4fdc5b(0x284)],'status':_0x4fdc5b(0x281),'live':_0x4fdc5b(0x151)}),_0x4545b8++;}}),_0x4545b8!=0x0&&(dbConfig['get']('bots')[_0x5d0530(0x131)](_0x4e290d)[_0x5d0530(0x1a3)](),config=_0x4e290d,restoredConfigFile=_0x4545b8);}}async function restoreConfigNotify(_0xe90620){const _0xa21e54=_0x418075;let _0x1419c4;if(restoredConfigFile==0x1)_0x1419c4=_0xa21e54(0xef);else _0x1419c4='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0xe90620)io['to'](_0xa21e54(0x148))[_0xa21e54(0xb6)](_0xa21e54(0x16c),_0x1419c4);else{logger['simple'](_0xa21e54(0x173)),logger['simple'](_0x1419c4),logger['simple'](_0xa21e54(0x173)),logger['simple']('');if(tgBot&&settings['telegramChatId']&&settings[_0xa21e54(0x164)]!=_0xa21e54(0x13f))await sendTelegram(settings[_0xa21e54(0x21d)],'Bot\x20Mgr\x20>\x20'+_0x1419c4);}}function decryptRSA(_0x39fdeb,_0x438f2d){const _0x4c3d2e=_0x418075,_0x45909a=forge[_0x4c3d2e(0xcb)][_0x4c3d2e(0x266)](_0x39fdeb),_0x2028d6=_0x45909a[_0x4c3d2e(0x250)](forge[_0x4c3d2e(0x105)][_0x4c3d2e(0x121)](_0x438f2d),_0x4c3d2e(0xba),{'md':forge['md'][_0x4c3d2e(0x27b)]['create'](),'mgf1':{'md':forge['md'][_0x4c3d2e(0x27b)][_0x4c3d2e(0x290)]()}});return _0x2028d6;}function validateCredentials(_0xfae16b,_0x23fa2d){const _0x4ac538=_0x418075;if(_0xfae16b[_0x4ac538(0x14e)]==settings[_0x4ac538(0x134)]&&bcrypt[_0x4ac538(0x1fe)](_0xfae16b['password'],settings[_0x4ac538(0x20d)])){if(settings[_0x4ac538(0x267)])return{'allow':![],'reason':_0x4ac538(0x14c),'token':null};else{const _0x5c86c4=generateLoginToken(_0x23fa2d);return{'allow':!![],'reason':_0x4ac538(0x176),'token':_0x5c86c4};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x543639){const _0xecd7e3=_0x418075,_0x4a695b=generateLoginToken(_0x543639);return{'allow':!![],'reason':_0xecd7e3(0x176),'token':_0x4a695b};}function validateAccess(_0x35335e,_0x4bcbd0,_0x3151f2){const _0x369fcb=_0x418075,_0x4befe0=_0x3151f2?_0x3151f2:devices[_0x4bcbd0]['ip'];let _0xcab5eb;const _0x21da43=_0x4fab06=>{const _0x1a0c80=_0x5769;if(settings[_0x1a0c80(0x26f)]){if(settings[_0x1a0c80(0x267)]){if(telegram2FaApproved(_0x4bcbd0)){const _0x5729fe=generateLoginToken(_0x4bcbd0);return{'allow':!![],'reason':_0x1a0c80(0x14f),'token':_0x5729fe};}else return{'allow':![],'reason':_0x1a0c80(0x1ba),'token':null};}else return _0xcab5eb=validToken(_0x4fab06,_0x4bcbd0),_0xcab5eb['hasOwnProperty'](_0x1a0c80(0xd4))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x4fab06}:{'allow':![],'reason':_0x1a0c80(0x1ba),'token':null};}else return{'allow':!![],'reason':_0x1a0c80(0x25c),'token':null};};if(settings[_0x369fcb(0x1d2)]){let _0x57658c=[...settings['whitelist'],'::1',_0x369fcb(0x1df),_0x369fcb(0x142)];if(_0x57658c[_0x369fcb(0xa4)](_0x4befe0))return _0x21da43(_0x35335e);else{_0xcab5eb=validToken(_0x35335e,_0x4bcbd0);if(_0xcab5eb[_0x369fcb(0x209)](_0x369fcb(0xd4)))return _0x21da43(_0x35335e);else{if(telegramIpApproved(_0x4bcbd0)){const _0x4dba9d=generateToken(_0x4bcbd0);return _0xcab5eb=_0x21da43(_0x35335e),_0xcab5eb['allow']?{'allow':!![],'reason':_0x369fcb(0xe8),'token':_0x4dba9d}:_0xcab5eb;}else return settings[_0x369fcb(0xb5)]?{'allow':![],'reason':_0x369fcb(0x1d6),'token':null}:{'allow':![],'reason':_0x369fcb(0x259),'token':null};}}}else return _0x21da43(_0x35335e);}function timelyDecrypt(_0x25d4d2,_0x56e821,_0x23894d='@'){const _0x2a180e=_0x418075;if(_0x25d4d2)try{const _0x48e37a=decryptRSA(secure['privateKey'],_0x25d4d2),_0x5933a9=_0x48e37a[_0x2a180e(0x24c)](_0x23894d)[0x0],_0x4d1f6f=_0x48e37a['split'](_0x23894d)[0x1],_0x15167d=new Date()['getTime']();if(_0x56e821){if(_0x15167d-_0x4d1f6f<maxSecretAge*0x3e8)return _0x5933a9;else return![];}else return _0x5933a9;}catch(_0x1966d9){return![];}else return![];}const validToken=(_0x58e659,_0x28eef5)=>{const _0x256dac=_0x418075,_0x4ff076=devices[_0x28eef5]['ip'];if(!_0x58e659)return{'error':_0x256dac(0x227)};for(let _0x200b9b of blacklist){if(_0x200b9b[_0x256dac(0xaa)]==_0x58e659)return{'error':'Token\x20blacklisted'};}let _0x25e831;try{_0x25e831=jwt[_0x256dac(0xcd)](_0x58e659,secure[_0x256dac(0x25d)]+_0x28eef5);}catch{return{'error':_0x256dac(0x115)};}if(!_0x25e831[_0x256dac(0x209)](_0x256dac(0x1f4))&&!_0x25e831[_0x256dac(0x209)](_0x256dac(0x14e))||!_0x25e831[_0x256dac(0x209)](_0x256dac(0x269)))return{'error':_0x256dac(0x177)};if(!_0x25e831[_0x256dac(0x209)](_0x256dac(0x14e))&&_0x25e831['hasOwnProperty'](_0x256dac(0x1f4))){const {clientip:_0x5189a1}=_0x25e831;return _0x4ff076==_0x5189a1?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x25e831[_0x256dac(0x209)](_0x256dac(0x14e))&&_0x25e831['hasOwnProperty']('clientip')){const {username:_0x1a2f0a,clientip:_0x4b02d0}=_0x25e831;return settings[_0x256dac(0x134)]==_0x1a2f0a&&_0x4ff076==_0x4b02d0?{'success':_0x256dac(0x1f3)}:{'error':_0x256dac(0x220)};}}},generateLoginToken=_0xbaf065=>{const _0xd925af=_0x418075;if(_0xbaf065){const _0x5f0777=devices[_0xbaf065]['ip'];return jwt[_0xd925af(0x225)]({'username':settings[_0xd925af(0x134)],'clientip':_0x5f0777},secure['secret']+_0xbaf065,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x4235da=>{const _0x365178=_0x418075;if(_0x4235da){const _0x47c941=devices[_0x4235da]['ip'];return jwt[_0x365178(0x225)]({'clientip':_0x47c941},secure['secret']+_0x4235da,{'expiresIn':devices[_0x4235da][_0x365178(0x143)][_0x365178(0x18d)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x5117c0=>{const _0x1830e4=_0x418075;let _0x3d4c60=![];return devices[_0x5117c0]['telegramIpApproval']&&devices[_0x5117c0]['telegramIpApproval'][_0x1830e4(0x18d)]!=_0x1830e4(0x25e)&&(_0x3d4c60=devices[_0x5117c0][_0x1830e4(0x143)][_0x1830e4(0x1f4)]==devices[_0x5117c0]['ip']&&new Date()[_0x1830e4(0x10a)]()-devices[_0x5117c0][_0x1830e4(0x143)][_0x1830e4(0x16b)]<devices[_0x5117c0]['telegramIpApproval'][_0x1830e4(0x18d)]*0x3c*0x3e8),_0x3d4c60;},telegram2FaApproved=_0x3dcf26=>{const _0x36b61d=_0x418075;let _0x3016c1=![];return devices[_0x3dcf26]['telegram2FaApproval']&&devices[_0x3dcf26][_0x36b61d(0xe9)][_0x36b61d(0x18d)]!='reject'&&(_0x3016c1=devices[_0x3dcf26][_0x36b61d(0xe9)][_0x36b61d(0x1f4)]==devices[_0x3dcf26]['ip']&&new Date()[_0x36b61d(0x10a)]()-devices[_0x3dcf26][_0x36b61d(0xe9)]['timestamp']<devices[_0x3dcf26][_0x36b61d(0xe9)][_0x36b61d(0x18d)]*0x3c*0x3e8),_0x3016c1;},normalizeIP=_0x1ac7fe=>{const _0x1ae922=_0x418075;let _0xccd76f=null,_0xb4d166=null;if(ipaddr['isValid'](_0x1ac7fe)){const _0x4416d6=ipaddr[_0x1ae922(0xa1)](_0x1ac7fe);_0x4416d6[_0x1ae922(0x1bc)]()==='ipv6'?(_0x4416d6[_0x1ae922(0x190)]()&&(_0xccd76f=_0x4416d6['toIPv4Address']()[_0x1ae922(0x13c)]()),_0xb4d166=_0x4416d6[_0x1ae922(0x13c)]()):(_0xccd76f=_0x4416d6['toString'](),_0xb4d166=_0x4416d6['toIPv4MappedAddress']()['toString']());}return{'show':_0xccd76f?_0xccd76f:_0xb4d166,'store':_0xb4d166};};function formatDate(_0x420e1b){const _0x30e924=_0x418075;return _0x420e1b[_0x30e924(0xde)]()+'/'+(_0x420e1b[_0x30e924(0x16e)]()+0x1)[_0x30e924(0x13c)]()[_0x30e924(0xeb)](0x2,'0')+'/'+_0x420e1b[_0x30e924(0x1a5)]()[_0x30e924(0x13c)]()[_0x30e924(0xeb)](0x2,'0')+'\x20'+_0x420e1b[_0x30e924(0x1f9)]()[_0x30e924(0x13c)]()[_0x30e924(0xeb)](0x2,'0')+':'+_0x420e1b['getMinutes']()['toString']()[_0x30e924(0xeb)](0x2,'0')+':'+_0x420e1b[_0x30e924(0xf0)]()[_0x30e924(0x13c)]()[_0x30e924(0xeb)](0x2,'0');}function sleep(_0x2527b6){return new Promise(_0x528617=>setTimeout(_0x528617,_0x2527b6));}