const _0x168baa=_0x167f;(function(_0x351871,_0x5524db){const _0x488367=_0x167f,_0x4d6bb7=_0x351871();while(!![]){try{const _0x44aded=-parseInt(_0x488367(0x232))/0x1*(parseInt(_0x488367(0x294))/0x2)+-parseInt(_0x488367(0x167))/0x3+-parseInt(_0x488367(0x195))/0x4+-parseInt(_0x488367(0x1f6))/0x5*(parseInt(_0x488367(0x282))/0x6)+parseInt(_0x488367(0x241))/0x7*(parseInt(_0x488367(0x175))/0x8)+parseInt(_0x488367(0x16c))/0x9*(-parseInt(_0x488367(0x271))/0xa)+-parseInt(_0x488367(0x1fd))/0xb*(-parseInt(_0x488367(0x1f0))/0xc);if(_0x44aded===_0x5524db)break;else _0x4d6bb7['push'](_0x4d6bb7['shift']());}catch(_0x564c48){_0x4d6bb7['push'](_0x4d6bb7['shift']());}}}(_0x2f03,0x2969d));const _0x3da7ad=function(){let _0x1edeea=!![];return function(_0x123782,_0x3390aa){const _0xe2cfe5=_0x1edeea?function(){if(_0x3390aa){const _0x28cb9a=_0x3390aa['apply'](_0x123782,arguments);return _0x3390aa=null,_0x28cb9a;}}:function(){};return _0x1edeea=![],_0xe2cfe5;};}(),_0x1b6945=_0x3da7ad(this,function(){const _0x16f36f=_0x167f;return _0x1b6945['toString']()['search'](_0x16f36f(0x24e))['toString']()[_0x16f36f(0x262)](_0x1b6945)['search'](_0x16f36f(0x24e));});_0x1b6945();'use strict';process[_0x168baa(0x298)][_0x168baa(0x299)]=0x1;const childProcess=require(_0x168baa(0x210)),fs=require('fs'),fns=require(_0x168baa(0x128)),low=require(_0x168baa(0x2aa)),FileSync=require(_0x168baa(0x2e9)),path=require(_0x168baa(0x2ce)),crypto=require('crypto'),Crypt=require(_0x168baa(0x1b4))[_0x168baa(0x162)],RSA=require(_0x168baa(0x1b4))[_0x168baa(0x27a)],bcrypt=require('bcryptjs'),jwt=require(_0x168baa(0x285)),ipaddr=require(_0x168baa(0x1ec)),argv=require(_0x168baa(0x171))(process[_0x168baa(0x276)]['slice'](0x2))[_0x168baa(0x276)],uuidRandom=require('uuid-random'),TelegramBot=require(_0x168baa(0x1c4)),Mixpanel=require(_0x168baa(0x272)),axios=require(_0x168baa(0x22c)),{GraphQLClient,gql}=require(_0x168baa(0x142)),util=require(_0x168baa(0x2df)),fileUpload=require(_0x168baa(0x189)),PORT=argv[_0x168baa(0x28a)]||_0x168baa(0x18f),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console['log'](_0x168baa(0x21b)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x168baa(0x1fa)](0x1));const HOST=argv['host']||null,userID=argv[_0x168baa(0x29b)]||'',debugging=argv['d']||![];let bbpath=_0x168baa(0x26a),bbpath2='';const botfile=_0x168baa(0x280),configfile='bb-config.json',settingsfile=_0x168baa(0x172),securefile=_0x168baa(0x12c),maxBackups=0xa;let validInstallation=!![];!fs[_0x168baa(0x2cb)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x168baa(0x160)),configpath=userID?bbpath+_0x168baa(0x2b5)+userID+'/':bbpath+_0x168baa(0x2b5),configbackuppath=configpath+_0x168baa(0x28d),logspath=userID?bbpath+_0x168baa(0x2b3)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x168baa(0x19c)+userID+'/':bbpath+_0x168baa(0x19c),loggerfile=fs['createWriteStream'](logspath+_0x168baa(0x144),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x168baa(0x16f);!fs[_0x168baa(0x2cb)](configpath)&&fs[_0x168baa(0x211)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x168baa(0x211)](configbackuppath);!fs[_0x168baa(0x2cb)](logspath)&&fs[_0x168baa(0x211)](logspath);!fs['existsSync'](zippath)&&fs[_0x168baa(0x211)](zippath);!fs[_0x168baa(0x2cb)](temppath)&&fs[_0x168baa(0x211)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x168baa(0x26f)]({'bots':[]})[_0x168baa(0x1eb)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x168baa(0x26f)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x168baa(0x131),'onepagemode':![]}})[_0x168baa(0x1eb)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x168baa(0x26f)]({'secure':{},'blacklist':[]})[_0x168baa(0x1eb)]();let crypt=new Crypt({'md':_0x168baa(0x249),'rsaStandard':_0x168baa(0x263)});const saltRounds=0xa,mixpanel=Mixpanel[_0x168baa(0x206)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x168baa(0x28e)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&settings[_0x168baa(0x1b5)]!=''&&settings[_0x168baa(0x1d0)]&&settings[_0x168baa(0x1d0)]!='')initTelegram();const logger={'screen':_0x35727f=>{console['log'](_0x35727f);},'simple':_0x2cc29f=>{const _0x5f56df=_0x168baa;console[_0x5f56df(0x252)](_0x2cc29f),loggerfile[_0x5f56df(0x1eb)](util[_0x5f56df(0x19e)](_0x2cc29f)+'\x0a');},'full':async _0x58871c=>{const _0x3ddb2f=_0x168baa,_0x58e6d5=getTimeStamp()+_0x3ddb2f(0x2b4)+_0x58871c;console[_0x3ddb2f(0x252)](_0x58e6d5),loggerfile[_0x3ddb2f(0x1eb)](util[_0x3ddb2f(0x19e)](_0x58e6d5)+'\x0a');if(tgBot&&settings[_0x3ddb2f(0x1dd)]&&settings['telegramEvents']!='orders')await tgBot[_0x3ddb2f(0x2d3)](settings[_0x3ddb2f(0x1dd)],_0x3ddb2f(0x264)+_0x58871c)[_0x3ddb2f(0x2e2)](_0x3d5190=>{telegramError(_0x3d5190);});},'debug':async(_0x298c12,_0x12fea5='')=>{const _0x319744=_0x168baa,_0x50c0f9=getTimeStamp()+_0x319744(0x17f)+_0x298c12;if(debugging)console[_0x319744(0x252)](_0x50c0f9);loggerfile[_0x319744(0x1eb)](util[_0x319744(0x19e)](_0x50c0f9)+'\x0a');if(_0x12fea5){if(debugging)console['log'](_0x12fea5);loggerfile['write'](util[_0x319744(0x19e)](_0x12fea5)+'\x0a');}}};process['on'](_0x168baa(0x1fc),function(_0x32c511){const _0x47da5c=_0x168baa;logger[_0x47da5c(0x2e8)](_0x32c511);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x168baa(0x289))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x168baa(0x29a))[_0x168baa(0x2d1)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x168baa(0x2d9)](_0x168baa(0x1f9),async(_0x215a3b,_0x4a6df4)=>{const _0x1a48f6=_0x168baa,_0x4b9489=_0x215a3b[_0x1a48f6(0x229)]['type'],_0x4ebb08=getClientsWithBotID(_0x1a48f6(0x14d)),_0x14b7ed=_0x215a3b['headers'][_0x1a48f6(0x22b)],_0x2667a2=timelyDecrypt(_0x14b7ed,![]),_0x2f20e5=_0x4ebb08[_0x1a48f6(0x2ac)](_0x4df3f7=>_0x4df3f7[_0x1a48f6(0x22b)]==_0x2667a2);if(_0x2f20e5){const _0x27a012=normalizeIP(_0x215a3b[_0x1a48f6(0x21a)]['remoteAddress'])[_0x1a48f6(0x1ab)],_0x285783=_0x215a3b[_0x1a48f6(0x24c)][_0x1a48f6(0x2b7)];if(validateAccess(_0x285783,_0x2667a2,_0x27a012)[_0x1a48f6(0x143)])_0x4b9489==_0x1a48f6(0x154)&&await backupConfigFiles(),await zipFiles(_0x4b9489),_0x4a6df4[_0x1a48f6(0x126)](zippath+(_0x4b9489+_0x1a48f6(0x22a)),_0x14e079=>{const _0x132e68=_0x1a48f6;_0x14e079&&(logger[_0x132e68(0x1dc)](_0x132e68(0x1d6)+_0x4b9489),logger[_0x132e68(0x2e8)](_0x14e079));});else logger[_0x1a48f6(0x1dc)](_0x1a48f6(0x224)+_0x4b9489+'\x20(1)');}else logger[_0x1a48f6(0x1dc)](_0x1a48f6(0x224)+_0x4b9489+_0x1a48f6(0x191));}),app[_0x168baa(0x185)](_0x168baa(0x240),async(_0x1fad88,_0x40070c)=>{const _0xf14578=_0x168baa,_0x2ee99b=getClientsWithBotID(_0xf14578(0x14d)),_0x2a257b=_0x1fad88[_0xf14578(0x24c)][_0xf14578(0x22b)],_0x1587e8=timelyDecrypt(_0x2a257b,![]),_0x5c09fc=_0x2ee99b[_0xf14578(0x2ac)](_0xf9e3ae=>_0xf9e3ae[_0xf14578(0x22b)]==_0x1587e8);logger[_0xf14578(0x292)](_0xf14578(0x137));if(_0x5c09fc){const _0x4bccad=normalizeIP(_0x1fad88[_0xf14578(0x21a)][_0xf14578(0x2bc)])['store'],_0x2cdb0c=_0x1fad88[_0xf14578(0x24c)]['tkn'];if(validateAccess(_0x2cdb0c,_0x1587e8,_0x4bccad)[_0xf14578(0x143)]){if(_0x1fad88['files']){const _0x247a95=_0x1fad88[_0xf14578(0x1c6)]['backupfile'];await _0x247a95['mv'](temppath+_0x247a95['name']),_0x40070c[_0xf14578(0x23b)]({'status':!![],'message':_0xf14578(0x2b0)});const _0x4abb45=getBotsWithMode();_0x4abb45['length']>0x0?confirmRestore(temppath,_0x247a95[_0xf14578(0x2d0)]):unzipFile(temppath,_0x247a95[_0xf14578(0x2d0)]);}}else logger[_0xf14578(0x1dc)](_0xf14578(0x151));}else logger[_0xf14578(0x1dc)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x168baa(0x12e)](express['static'](path[_0x168baa(0x218)](__dirname,bbpath2,_0x168baa(0x159)))),app[_0x168baa(0x12e)](express[_0x168baa(0x248)](path['join'](__dirname,bbpath2,'build'))),app['get']('/',function(_0xc3c367,_0x5c7973){const _0x4d3c18=_0x168baa;_0x5c7973[_0x4d3c18(0x13b)](path[_0x4d3c18(0x218)](__dirname,bbpath2,'build2','index.html'));}),app[_0x168baa(0x2d9)](_0x168baa(0x186),function(_0x11068b,_0x4d5bba){const _0x25f513=_0x168baa;_0x4d5bba['sendFile'](path['join'](__dirname,bbpath2,_0x25f513(0x1df),_0x25f513(0x2bb)));}),app['get'](_0x168baa(0x14a),(_0x576e4d,_0x4a4d5c)=>{const _0x2d8b5a=_0x168baa;_0x4a4d5c[_0x2d8b5a(0x13b)](path[_0x2d8b5a(0x218)](__dirname,bbpath2,_0x2d8b5a(0x1df),_0x2d8b5a(0x2bb)));}),app[_0x168baa(0x2d9)](_0x168baa(0x29e),(_0x176055,_0xd25c68)=>{const _0x1b37b9=_0x168baa;_0xd25c68[_0x1b37b9(0x13b)](path[_0x1b37b9(0x218)](__dirname,bbpath2,_0x1b37b9(0x1df),_0x1b37b9(0x2bb)));}),app['get'](_0x168baa(0x17b),(_0xb8bb42,_0x2acf5b)=>{const _0x44af62=_0x168baa;_0x2acf5b[_0x44af62(0x13b)](path['join'](__dirname,bbpath2,'build',_0x44af62(0x2bb)));}),app['get'](_0x168baa(0x28f),(_0x3667f2,_0x1bdbab)=>{const _0x344917=_0x168baa;_0x1bdbab[_0x344917(0x13b)](path[_0x344917(0x218)](__dirname,bbpath2,_0x344917(0x1df),_0x344917(0x2bb)));}),app[_0x168baa(0x2d9)]('/:bot/configuration',(_0x3ea98d,_0x27b8a0)=>{const _0xccff76=_0x168baa;_0x27b8a0['sendFile'](path['join'](__dirname,bbpath2,'build',_0xccff76(0x2bb)));}),app['get']('/:bot/support',(_0x2bfeb4,_0x510356)=>{const _0xfa55a4=_0x168baa;_0x510356['sendFile'](path[_0xfa55a4(0x218)](__dirname,bbpath2,_0xfa55a4(0x1df),_0xfa55a4(0x2bb)));});if(HOST)http[_0x168baa(0x234)](PORT,HOST);else http[_0x168baa(0x234)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function _0x167f(_0x484d19,_0x21ca88){const _0x12b470=_0x2f03();return _0x167f=function(_0x1b6945,_0x3da7ad){_0x1b6945=_0x1b6945-0x120;let _0x2f03f7=_0x12b470[_0x1b6945];return _0x2f03f7;},_0x167f(_0x484d19,_0x21ca88);}async function startServer(){const _0xf859a7=_0x168baa;logger[_0xf859a7(0x2e8)](''),logger[_0xf859a7(0x2e8)](_0xf859a7(0x1bd)),await logger[_0xf859a7(0x1dc)](_0xf859a7(0x202)+PORT),logger[_0xf859a7(0x2e8)](_0xf859a7(0x1bd));if(config[_0xf859a7(0x180)]!=0x0)for(const _0x6c7349 of config){if(_0x6c7349[_0xf859a7(0x12a)]==_0xf859a7(0x1ad)||_0x6c7349[_0xf859a7(0x12a)]=='new')await logger[_0xf859a7(0x1dc)](_0xf859a7(0x152)+_0x6c7349[_0xf859a7(0x2ae)]+'\x20|\x20'+_0x6c7349[_0xf859a7(0x1b8)]),startBot([_0x6c7349[_0xf859a7(0x2ae)],userID],{'cwd':bbpath},function(_0x3cc6b6){const _0xef1353=_0xf859a7;if(_0x3cc6b6)logger[_0xef1353(0x1dc)](_0x3cc6b6);});else(_0x6c7349[_0xf859a7(0x12a)]==_0xf859a7(0x147)||_0x6c7349[_0xf859a7(0x12a)]==_0xf859a7(0x165))&&await logger[_0xf859a7(0x1dc)](_0xf859a7(0x17e)+_0x6c7349['botID']+_0xf859a7(0x138)+_0x6c7349['botname']);}else!newBot&&logger['simple'](_0xf859a7(0x2e0));if(newBot)addBot();logger[_0xf859a7(0x2e8)](_0xf859a7(0x1bd)),logger[_0xf859a7(0x2e8)]('');}function startSocket(){io['on']('connection',_0x58b07f=>{const _0x1260b7=_0x167f;let _0x23d062,_0x27cfab,_0x5e57fc,_0x6db1c1,_0x5b6ba1;const _0x2d3cf0=_0x58b07f['handshake'][_0x1260b7(0x24c)][_0x1260b7(0x22d)];_0x27cfab=_0x2d3cf0[_0x1260b7(0x23a)](/bot[0-9]{3}/);if(_0x27cfab)_0x5e57fc=_0x27cfab[0x0][_0x1260b7(0x23a)](/[0-9]{3}/);if(_0x5e57fc)_0x23d062=_0x5e57fc[0x0];else _0x23d062=_0x1260b7(0x14d);const _0x49b0e3=_0x58b07f[_0x1260b7(0x1d5)][_0x1260b7(0x278)][_0x1260b7(0x2d7)];if(!_0x49b0e3)_0x58b07f[_0x1260b7(0x297)]('status',{'publicKey':secure[_0x1260b7(0x247)]});else{_0x6db1c1=timelyDecrypt(_0x49b0e3,![]);if(!_0x6db1c1)_0x58b07f['emit'](_0x1260b7(0x12a),{'publicKey':secure[_0x1260b7(0x247)]});else{_0x5b6ba1=normalizeIP(_0x58b07f[_0x1260b7(0x201)][_0x1260b7(0x2bc)])[_0x1260b7(0x1ab)];if(!devices[_0x6db1c1])devices[_0x6db1c1]={'uuid':_0x6db1c1,'access':{'token':null}};devices[_0x6db1c1]['ip']=_0x5b6ba1;const _0x56bbde=addClient(_0x58b07f['id'],_0x6db1c1,_0x23d062);setAccess(_0x56bbde),emitMessages(),_0x58b07f['on'](_0x1260b7(0x25f),_0x504d8a=>{const _0x2d19a8=_0x1260b7,_0x5602bf=timelyDecrypt(_0x504d8a[_0x2d19a8(0x1ee)]);if(_0x5602bf){_0x504d8a={'username':_0x504d8a[_0x2d19a8(0x2eb)],'password':_0x5602bf},devices[_0x6db1c1][_0x2d19a8(0x215)]=validateCredentials(_0x504d8a,_0x6db1c1);if(devices[_0x6db1c1][_0x2d19a8(0x215)][_0x2d19a8(0x143)]==![]&&devices[_0x6db1c1]['access'][_0x2d19a8(0x2c4)]=='2FA\x20login\x20required')_0x58b07f[_0x2d19a8(0x297)](_0x2d19a8(0x12a),{'access':devices[_0x6db1c1][_0x2d19a8(0x215)]}),loginAccess2FA(_0x6db1c1,_0x5b6ba1);else{if(devices[_0x6db1c1][_0x2d19a8(0x215)][_0x2d19a8(0x143)]==![]&&devices[_0x6db1c1][_0x2d19a8(0x215)][_0x2d19a8(0x2c4)]==_0x2d19a8(0x15e))_0x58b07f['emit'](_0x2d19a8(0x12a),{'access':devices[_0x6db1c1]['access']});else devices[_0x6db1c1][_0x2d19a8(0x215)][_0x2d19a8(0x143)]&&devices[_0x6db1c1][_0x2d19a8(0x215)][_0x2d19a8(0x2c4)]==_0x2d19a8(0x1b6)&&(getClientsWithUuid(_0x6db1c1)[_0x2d19a8(0x13f)](_0x492ceb=>{setAccess(_0x492ceb);}),logger[_0x2d19a8(0x292)](_0x2d19a8(0x233)+_0x6db1c1['slice'](-0x8)),setTokenRefresh(_0x6db1c1),setSessionTimeout(_0x2d19a8(0x25f),_0x6db1c1));}}else logger['full'](_0x2d19a8(0x284));}),_0x58b07f['on']('reset-password',()=>{resetPassword();}),_0x58b07f['on']('disconnect',_0x4ca28d=>{removeClient(_0x58b07f['id']);}),_0x23d062=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x46698b){const _0x19d216=_0x168baa;if(_0x46698b!=_0x19d216(0x14d)&&config[_0x19d216(0x1db)]!=''){if(pid[_0x46698b])pid[_0x46698b]['send']({'function':_0x19d216(0x135),'args':null});}_0x46698b!=_0x19d216(0x14d)&&broadcastToBots(_0x19d216(0x158),JSON[_0x19d216(0x1ba)](config));}function reloadBotManager(){const _0x4effcc=_0x168baa;getClientsWithBotID(_0x4effcc(0x14d))[_0x4effcc(0x13f)](_0x38e6ef=>{const _0x2faaf4=_0x4effcc;getSocket(_0x38e6ef['id'])[_0x2faaf4(0x297)]('status',{'access':{'allow':![],'reason':_0x2faaf4(0x1a0),'token':null}});});}function getSocket(_0x55bf51){const _0x868d40=_0x168baa;return io[_0x868d40(0x18b)][_0x868d40(0x18b)][_0x868d40(0x2d9)](_0x55bf51);}function setAccess(_0xbc6163){const _0x1dc9c7=_0x168baa,_0x2e8f5b=getSocket(_0xbc6163['id']),_0x25271b=_0xbc6163[_0x1dc9c7(0x22b)],_0x3f0165=_0xbc6163[_0x1dc9c7(0x2de)];devices[_0x25271b]['access']=validateAccess(devices[_0x25271b][_0x1dc9c7(0x215)][_0x1dc9c7(0x281)],_0x25271b),logger['debug'](_0x1dc9c7(0x2a0)+devices[_0x25271b]['access'][_0x1dc9c7(0x2c4)]+'\x20|\x20client:\x20...'+_0xbc6163['id'][_0x1dc9c7(0x25b)](-0x8)+_0x1dc9c7(0x28b)+_0x25271b[_0x1dc9c7(0x25b)](-0x8)),_0x2e8f5b[_0x1dc9c7(0x218)](_0x25271b);if(devices[_0x25271b][_0x1dc9c7(0x215)][_0x1dc9c7(0x143)]){_0x2e8f5b[_0x1dc9c7(0x218)](_0x3f0165);if(_0x3f0165==_0x1dc9c7(0x14d))initializeSocketBotManager(_0x2e8f5b);else initializeSocketBot(_0x2e8f5b);initClient(_0x3f0165);}devices[_0x25271b]['access'][_0x1dc9c7(0x281)]&&devices[_0x25271b]['access'][_0x1dc9c7(0x2c4)]==_0x1dc9c7(0x14e)&&setSessionTimeout(_0x1dc9c7(0x273),_0x25271b),devices[_0x25271b]['access']['token']&&devices[_0x25271b]['access']['reason']==_0x1dc9c7(0x223)&&setSessionTimeout('login',_0x25271b),_0x2e8f5b[_0x1dc9c7(0x297)](_0x1dc9c7(0x12a),{'status':_0xbc6163[_0x1dc9c7(0x2a1)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x25271b][_0x1dc9c7(0x215)],'externalip':devices[_0x25271b]['ip'],'publicKey':secure[_0x1dc9c7(0x247)],'userid':settings[_0x1dc9c7(0x193)],'validInstallation':validInstallation}),devices[_0x25271b][_0x1dc9c7(0x215)]['allow']==![]&&devices[_0x25271b][_0x1dc9c7(0x215)][_0x1dc9c7(0x2c4)]=='2FA\x20required'&&temporaryAccess2FA(_0x25271b,devices[_0x25271b]['ip']);}function setSessionTimeout(_0x37f671,_0x1f7508){const _0x4e2c3a=_0x168baa;let _0x24c744;if(_0x37f671==_0x4e2c3a(0x25f))_0x24c744=loginExpiry*0x3c*0x3e8;else _0x24c744=devices[_0x1f7508][_0x4e2c3a(0x19d)][_0x4e2c3a(0x238)]*0x3c*0x3e8-(new Date()[_0x4e2c3a(0x1da)]()-devices[_0x1f7508]['telegramIpApproval'][_0x4e2c3a(0x174)]);if(devices[_0x1f7508][_0x4e2c3a(0x231)])clearTimeout(devices[_0x1f7508]['pidExpireLogin']);devices[_0x1f7508][_0x4e2c3a(0x231)]=setTimeout(()=>{const _0x107f08=_0x4e2c3a;if(devices[_0x1f7508]['pidRefreshToken'])clearTimeout(devices[_0x1f7508][_0x107f08(0x20b)]);removeSocketListeners(_0x1f7508),addBlacklist(_0x1f7508),devices[_0x1f7508][_0x107f08(0x19d)]=null,devices[_0x1f7508]['telegram2FaApproval']=null,devices[_0x1f7508][_0x107f08(0x215)][_0x107f08(0x281)]=null,logger[_0x107f08(0x292)](_0x107f08(0x1de)+_0x1f7508[_0x107f08(0x25b)](-0x8)),devices[_0x1f7508]['access']=validateAccess(devices[_0x1f7508][_0x107f08(0x215)][_0x107f08(0x281)],_0x1f7508),!(devices[_0x1f7508][_0x107f08(0x215)][_0x107f08(0x143)]&&devices[_0x1f7508]['access'][_0x107f08(0x2c4)]==_0x107f08(0x156))&&(_0x37f671=='login'?io['to'](_0x1f7508)['emit']('status',{'access':{'allow':![],'reason':_0x107f08(0x1f7),'token':null}}):io['to'](_0x1f7508)['emit']('status',{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x1f7508]['access'][_0x107f08(0x281)]=null;},_0x24c744);}function setTokenRefresh(_0x3b91a5){const _0xf5fca4=_0x168baa;if(devices[_0x3b91a5]['pidRefreshToken'])clearTimeout(devices[_0x3b91a5][_0xf5fca4(0x20b)]);devices[_0x3b91a5]['pidRefreshToken']=setTimeout(()=>{const _0xffa66d=_0xf5fca4;getClientsWithUuid(_0x3b91a5)[_0xffa66d(0x180)]!=0x0?(devices[_0x3b91a5][_0xffa66d(0x215)]=refreshToken(_0x3b91a5),io['to'](_0x3b91a5)[_0xffa66d(0x297)](_0xffa66d(0x12a),{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x3b91a5]['access'],'externalip':devices[_0x3b91a5]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x3b91a5)):clearTimeout(devices[_0x3b91a5][_0xffa66d(0x20b)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4c12a5){const _0x5bb617=_0x168baa,_0x331a21=getClient(_0x4c12a5['id'])['uuid'];_0x4c12a5[_0x5bb617(0x297)](_0x5bb617(0x158),config),_0x4c12a5[_0x5bb617(0x297)](_0x5bb617(0x1aa),cleanSettings()),_0x4c12a5['on'](_0x5bb617(0x2cc),_0x38a148=>{const _0xa424a9=_0x5bb617;if(validateAccess(_0x38a148,_0x331a21)[_0xa424a9(0x143)])addBot();else logger[_0xa424a9(0x1dc)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x4c12a5['on'](_0x5bb617(0x177),(_0x2f2f3a,_0x5590ae)=>{const _0x1c99cf=_0x5bb617;if(validateAccess(_0x5590ae,_0x331a21)[_0x1c99cf(0x143)])toggleBot(_0x2f2f3a[_0x1c99cf(0x2ae)],_0x2f2f3a[_0x1c99cf(0x12a)],_0x2f2f3a[_0x1c99cf(0x2cf)]);else logger[_0x1c99cf(0x1dc)](_0x1c99cf(0x19a));}),_0x4c12a5['on'](_0x5bb617(0x1e5),(_0x2aab68,_0x490334)=>{const _0x5d2a86=_0x5bb617;if(validateAccess(_0x490334,_0x331a21)[_0x5d2a86(0x143)])toggleBotMode(_0x2aab68);else logger[_0x5d2a86(0x1dc)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x4c12a5['on'](_0x5bb617(0x237),(_0x330b36,_0x23cc23)=>{if(validateAccess(_0x23cc23,_0x331a21)['allow'])deleteBot(_0x330b36);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x4c12a5['on'](_0x5bb617(0x161),(_0x318de1,_0x345fbb)=>{const _0x522bd8=_0x5bb617;if(validateAccess(_0x345fbb,_0x331a21)[_0x522bd8(0x143)])storeSettings(_0x318de1,!![]);else logger[_0x522bd8(0x1dc)](_0x522bd8(0x2dd));}),_0x4c12a5['on'](_0x5bb617(0x169),_0x4f8ed1=>{const _0x5c7e40=_0x5bb617;if(validateAccess(_0x4f8ed1,_0x331a21)['allow'])updateBB(_0x5c7e40(0x1a4));else logger[_0x5c7e40(0x1dc)](_0x5c7e40(0x14c));}),_0x4c12a5['on']('reinstall-bb',_0x31fe33=>{const _0x46bd0a=_0x5bb617;if(validateAccess(_0x31fe33,_0x331a21)[_0x46bd0a(0x143)])updateBB('reinstall');else logger[_0x46bd0a(0x1dc)](_0x46bd0a(0x29c));}),_0x4c12a5['on'](_0x5bb617(0x29d),_0x45a5e9=>{const _0x240438=_0x5bb617;if(validateAccess(_0x45a5e9,_0x331a21)[_0x240438(0x143)]){const _0x56e522=getClient(_0x4c12a5['id']);if(_0x56e522)getBackupFiles(_0x56e522['uuid']);else logger['full'](_0x240438(0x2cd));}else logger[_0x240438(0x1dc)](_0x240438(0x127));}),_0x4c12a5['on'](_0x5bb617(0x212),(_0x296046,_0x166cec)=>{const _0x357a81=_0x5bb617;if(validateAccess(_0x166cec,_0x331a21)[_0x357a81(0x143)])restoreBackupFile(_0x296046);else logger[_0x357a81(0x1dc)](_0x357a81(0x16d));}),_0x4c12a5['on']('get-messages',_0x3bb1db=>{const _0x4b89bf=_0x5bb617;if(validateAccess(_0x3bb1db,_0x331a21)[_0x4b89bf(0x143)])getMessages();else logger[_0x4b89bf(0x1dc)](_0x4b89bf(0x190));}),_0x4c12a5['on']('confirm-message',(_0x5da57c,_0x5942a6)=>{const _0x85c321=_0x5bb617;if(validateAccess(_0x5942a6,_0x331a21)[_0x85c321(0x143)])confirmMessage(_0x5da57c);else logger['full'](_0x85c321(0x2e6));}),_0x4c12a5['on'](_0x5bb617(0x1c3),_0xf6254f=>{const _0x1c8b6e=_0x5bb617;if(validateAccess(_0xf6254f,_0x331a21)[_0x1c8b6e(0x143)]){if(devices[_0x331a21]['pidRefreshToken'])clearTimeout(devices[_0x331a21][_0x1c8b6e(0x20b)]);if(devices[_0x331a21][_0x1c8b6e(0x231)])clearTimeout(devices[_0x331a21][_0x1c8b6e(0x231)]);removeSocketListeners(getClient(_0x4c12a5['id'])[_0x1c8b6e(0x22b)]),addBlacklist(_0x331a21),devices[_0x331a21][_0x1c8b6e(0x19d)]=null,devices[_0x331a21]['telegram2FaApproval']=null,devices[_0x331a21]['access'][_0x1c8b6e(0x281)]=null,logger[_0x1c8b6e(0x292)](_0x1c8b6e(0x2e5)+_0x331a21[_0x1c8b6e(0x25b)](-0x8)),io['to'](getClient(_0x4c12a5['id'])[_0x1c8b6e(0x22b)])[_0x1c8b6e(0x297)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x34786b){const _0x1ac3c0=_0x168baa,_0xe22cbe=getClient(_0x34786b['id'])[_0x1ac3c0(0x2de)],_0x522e31=getClient(_0x34786b['id'])[_0x1ac3c0(0x22b)];_0x34786b['on']('get-logs',(_0x484ee6,_0x3981eb)=>{const _0x440459=_0x1ac3c0;if(validateAccess(_0x3981eb,_0x522e31)['allow']){if(pid[_0xe22cbe])pid[_0xe22cbe][_0x440459(0x23b)]({'function':_0x440459(0x1d8),'args':_0x484ee6});}else logger[_0x440459(0x1dc)](_0x440459(0x2ca));}),_0x34786b['on']('delete-alerts',(_0x20528f,_0x804e66)=>{const _0x54c800=_0x1ac3c0;if(validateAccess(_0x804e66,_0x522e31)[_0x54c800(0x143)]){if(pid[_0xe22cbe])pid[_0xe22cbe][_0x54c800(0x23b)]({'function':_0x54c800(0x12f),'args':_0x20528f});}else logger[_0x54c800(0x1dc)](_0x54c800(0x130));}),_0x34786b['on']('get-portfolio',(_0x26a3fb,_0x54ee46)=>{const _0x1b7d44=_0x1ac3c0;if(validateAccess(_0x54ee46,_0x522e31)[_0x1b7d44(0x143)]){if(pid[_0xe22cbe])pid[_0xe22cbe][_0x1b7d44(0x23b)]({'function':_0x1b7d44(0x23f),'args':_0x26a3fb});}else logger[_0x1b7d44(0x1dc)](_0x1b7d44(0x288));}),_0x34786b['on'](_0x1ac3c0(0x2a9),(_0x12f575,_0x12e9ad)=>{const _0x3217a8=_0x1ac3c0;if(validateAccess(_0x12e9ad,_0x522e31)[_0x3217a8(0x143)]){if(pid[_0xe22cbe])pid[_0xe22cbe][_0x3217a8(0x23b)]({'function':_0x3217a8(0x1b1),'args':_0x12f575});}else logger[_0x3217a8(0x1dc)](_0x3217a8(0x181));}),_0x34786b['on'](_0x1ac3c0(0x2c5),(_0x26d193,_0xe6079b)=>{const _0x226d8e=_0x1ac3c0;if(validateAccess(_0xe6079b,_0x522e31)[_0x226d8e(0x143)]){if(pid[_0xe22cbe])pid[_0xe22cbe]['send']({'function':_0x226d8e(0x275),'args':_0x26d193});}else logger[_0x226d8e(0x1dc)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x34786b['on'](_0x1ac3c0(0x27d),(_0x50b7b5,_0x4e6cdd)=>{const _0x51561e=_0x1ac3c0;if(validateAccess(_0x4e6cdd,_0x522e31)['allow']){if(pid[_0xe22cbe])pid[_0xe22cbe][_0x51561e(0x23b)]({'function':_0x51561e(0x150),'args':_0x50b7b5});}else logger[_0x51561e(0x1dc)](_0x51561e(0x1a7));}),_0x34786b['on'](_0x1ac3c0(0x2ab),_0x2fdc4c=>{const _0x27651b=_0x1ac3c0;if(validateAccess(_0x2fdc4c,_0x522e31)['allow']){if(pid[_0xe22cbe])pid[_0xe22cbe][_0x27651b(0x23b)]({'function':_0x27651b(0x258),'args':null});}else logger[_0x27651b(0x1dc)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x34786b['on'](_0x1ac3c0(0x261),_0x20bbc0=>{const _0x28c230=_0x1ac3c0;if(validateAccess(_0x20bbc0,_0x522e31)[_0x28c230(0x143)]){if(pid[_0xe22cbe])pid[_0xe22cbe][_0x28c230(0x23b)]({'function':'getStartingBalances','args':null});}else logger[_0x28c230(0x1dc)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x34786b['on'](_0x1ac3c0(0x2c7),(_0x411417,_0x4ca11d)=>{const _0x2d8e2f=_0x1ac3c0;if(validateAccess(_0x4ca11d,_0x522e31)[_0x2d8e2f(0x143)]){if(pid[_0xe22cbe])pid[_0xe22cbe][_0x2d8e2f(0x23b)]({'function':_0x2d8e2f(0x14f),'args':_0x411417});}else logger[_0x2d8e2f(0x1dc)](_0x2d8e2f(0x217));}),_0x34786b['on'](_0x1ac3c0(0x148),_0x2c9706=>{const _0x1af6bc=_0x1ac3c0;if(validateAccess(_0x2c9706,_0x522e31)[_0x1af6bc(0x143)]){if(pid[_0xe22cbe])pid[_0xe22cbe][_0x1af6bc(0x23b)]({'function':'cancelLoading','args':null});}else logger['full'](_0x1af6bc(0x205));}),_0x34786b['on'](_0x1ac3c0(0x1a9),_0x32a1c1=>{const _0x5a5598=_0x1ac3c0;if(validateAccess(_0x32a1c1,_0x522e31)[_0x5a5598(0x143)]){if(pid[_0xe22cbe])pid[_0xe22cbe][_0x5a5598(0x23b)]({'function':'showConfig','args':null});}else logger[_0x5a5598(0x1dc)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x34786b['on'](_0x1ac3c0(0x169),_0x194e0e=>{const _0x254960=_0x1ac3c0;if(validateAccess(_0x194e0e,_0x522e31)[_0x254960(0x143)])updateBB(_0x254960(0x1a4));else logger[_0x254960(0x1dc)](_0x254960(0x14c));}),_0x34786b['on']('get-messages',_0x241bc8=>{const _0x184ede=_0x1ac3c0;if(validateAccess(_0x241bc8,_0x522e31)[_0x184ede(0x143)])getMessages();else logger[_0x184ede(0x1dc)](_0x184ede(0x190));}),_0x34786b['on']('confirm-message',(_0x13a798,_0x2105a5)=>{const _0x333869=_0x1ac3c0;if(validateAccess(_0x2105a5,_0x522e31)[_0x333869(0x143)])confirmMessage(_0x13a798);else logger[_0x333869(0x1dc)](_0x333869(0x2e6));}),_0x34786b['on']('logout',_0x16d47b=>{const _0x2f3f13=_0x1ac3c0;if(validateAccess(_0x16d47b,_0x522e31)[_0x2f3f13(0x143)]){if(devices[_0x522e31][_0x2f3f13(0x20b)])clearTimeout(devices[_0x522e31][_0x2f3f13(0x20b)]);if(devices[_0x522e31]['pidExpireLogin'])clearTimeout(devices[_0x522e31]['pidExpireLogin']);removeSocketListeners(getClient(_0x34786b['id'])[_0x2f3f13(0x22b)]),addBlacklist(_0x522e31),devices[_0x522e31][_0x2f3f13(0x19d)]=null,devices[_0x522e31][_0x2f3f13(0x1be)]=null,devices[_0x522e31][_0x2f3f13(0x215)][_0x2f3f13(0x281)]=null,logger['debug'](_0x2f3f13(0x2e5)+_0x522e31[_0x2f3f13(0x25b)](-0x8)),io['to'](getClient(_0x34786b['id'])['uuid'])[_0x2f3f13(0x297)](_0x2f3f13(0x12a),{'access':{'allow':![],'reason':_0x2f3f13(0x23c),'token':null}});}else logger['full'](_0x2f3f13(0x146));});}function removeSocketListeners(_0x57f569){const _0x5e6e98=_0x168baa;getClientsWithUuid(_0x57f569)[_0x5e6e98(0x13f)](_0x3c51b8=>{const _0xed45cf=_0x5e6e98;getSocket(_0x3c51b8['id'])[_0xed45cf(0x24f)]();});}function cleanSettings(){const _0x19a6b1=_0x168baa;let _0xe85c3c=settings;return settings[_0x19a6b1(0x1b5)]&&settings[_0x19a6b1(0x1b5)]!=''&&(_0xe85c3c={..._0xe85c3c,'telegramToken':'************'}),settings['bbPassword']&&settings[_0x19a6b1(0x219)]!=''&&(_0xe85c3c={..._0xe85c3c,'bbPassword':_0x19a6b1(0x256)}),(settings['bbPassword']&&settings[_0x19a6b1(0x219)]=='***'||settings['telegramToken']&&settings[_0x19a6b1(0x1b5)]=='***')&&(_0xe85c3c={..._0xe85c3c,'restored':{'password':settings['bbPassword']==_0x19a6b1(0x1a2),'telegram':settings['telegramToken']=='***'}}),_0xe85c3c;}async function updateBB(_0x3ebc22){const _0x49730d=_0x168baa;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x58d22a=>{const _0x515d17=_0x167f;restartBot(_0x58d22a[_0x515d17(0x2ae)]);}),logger[_0x49730d(0x292)](_0x49730d(0x29f)+_0x3ebc22);if(_0x3ebc22==_0x49730d(0x1a4))process['send']({'update':!![]},_0x3f2be3=>{});else _0x3ebc22==_0x49730d(0x1fe)&&process[_0x49730d(0x23b)]({'reinstall':!![]},_0x4c82b7=>{});}function startBot(_0x1f2621,_0x21f554,_0x118231){const _0x2ba606=_0x168baa;if(debugging)_0x1f2621[_0x2ba606(0x124)]('-d');let _0x29747d=![];const _0x26e64e=_0x1f2621[0x0];_0x21f554={..._0x21f554,'stdio':[_0x2ba606(0x1e8),_0x2ba606(0x1e8),_0x2ba606(0x1e8),_0x2ba606(0x290)]},pid[_0x26e64e]=childProcess[_0x2ba606(0x1d4)](botfile,_0x1f2621,_0x21f554),pid[_0x26e64e]['on'](_0x2ba606(0x17c),_0x47099b=>{const _0x510491=_0x2ba606;switch(Object[_0x510491(0x1cb)](_0x47099b)[0x0]){case _0x510491(0x1b8):updateBotName(_0x26e64e,_0x47099b[_0x510491(0x1b8)]);break;case _0x510491(0x2d4):updateBotManager();break;case _0x510491(0x12a):updateStatus(_0x26e64e,_0x47099b[_0x510491(0x12a)]);break;case'live':updateLive(_0x26e64e,_0x47099b[_0x510491(0x2cf)]);break;case _0x510491(0x1ae):updateLive(_0x26e64e,_0x47099b[_0x510491(0x1ae)]),io['to'](_0x26e64e)[_0x510491(0x297)](_0x510491(0x12a),{'access':{'allow':![],'reason':_0x510491(0x1a0),'token':null}});break;case'stop':_0x47099b[_0x510491(0x207)]=='restart'&&restartBot(_0x26e64e);_0x47099b['stop']==_0x510491(0x225)&&toggleBot(_0x26e64e,_0x510491(0x147),_0x510491(0x26c));break;case _0x510491(0x2c8):sendTelegram(_0x26e64e,_0x47099b[_0x510491(0x2c8)]);break;case'telegrammsg':sendTelegramMsg(_0x47099b['telegrammsg']);break;case _0x510491(0x24d):io['to'](_0x26e64e)[_0x510491(0x297)](_0x47099b[_0x510491(0x24d)],_0x47099b[_0x510491(0x1b2)]);break;}}),pid[_0x26e64e]['on'](_0x2ba606(0x13d),function(_0x152083){if(_0x29747d)return;_0x29747d=!![],_0x118231(_0x152083);}),pid[_0x26e64e]['on'](_0x2ba606(0x1fa),async function(_0x47ed09){const _0x32eaaa=_0x2ba606;if(installingUpdate)return;if(_0x29747d)return;_0x29747d=!![],_0x118231(null);const _0x3d78f8=dbConfig['get']('bots')[_0x32eaaa(0x2ac)]({'botID':_0x26e64e})['value']();_0x3d78f8&&(_0x3d78f8[_0x32eaaa(0x12a)]==_0x32eaaa(0x1ad)||_0x3d78f8[_0x32eaaa(0x12a)]==_0x32eaaa(0x1cf))&&(await sleep(0x3e8),updateLive(_0x26e64e,_0x32eaaa(0x26c)),logger[_0x32eaaa(0x1dc)](_0x32eaaa(0x20c)+_0x26e64e),startBot([_0x26e64e,userID],{'cwd':bbpath},function(_0x1375ac){if(_0x1375ac)logger['full'](_0x1375ac);}));});}function stopBot(_0x24b24d){const _0x31d867=_0x168baa;getClientsWithBotID(_0x24b24d)[_0x31d867(0x13f)](_0x1dc0d4=>{const _0x1ea36f=_0x31d867;getSocket(_0x1dc0d4['id'])[_0x1ea36f(0x1f5)](!![]),removeClient(_0x1dc0d4['id']);}),pid[_0x24b24d]&&(pid[_0x24b24d]['kill'](),pid[_0x24b24d]=null);}function restartBot(_0x40ebda){const _0x535f2c=_0x168baa;if(pid[_0x40ebda])pid[_0x40ebda][_0x535f2c(0x225)]();}function addBot(){const _0x2ad3c5=_0x168baa;let _0x4d6cfc;for(let _0x1ea3eb=0x1;_0x1ea3eb<0x3e9;_0x1ea3eb++){_0x4d6cfc=_0x1ea3eb['toString']()[_0x2ad3c5(0x173)](0x3,'0');let _0x17e371=config[_0x2ad3c5(0x2ac)](_0x59b291=>_0x59b291[_0x2ad3c5(0x2ae)]==_0x4d6cfc);if(!_0x17e371)break;}if(_0x4d6cfc==='1000'){logger[_0x2ad3c5(0x1dc)](_0x2ad3c5(0x121));return;}logger[_0x2ad3c5(0x1dc)](_0x2ad3c5(0x145)+_0x4d6cfc),dbConfig['get']('bots')['push']({'botID':_0x4d6cfc,'botname':_0x2ad3c5(0x2c2)+_0x4d6cfc,'status':'new','live':''})[_0x2ad3c5(0x1eb)](),startBot([_0x4d6cfc,userID],{'cwd':bbpath},function(_0x2c9796){const _0x3bc21c=_0x2ad3c5;if(_0x2c9796)logger[_0x3bc21c(0x1dc)](_0x2c9796);}),config=getConfiguration(),io['to'](_0x2ad3c5(0x14d))[_0x2ad3c5(0x297)](_0x2ad3c5(0x158),config),broadcastToBots(_0x2ad3c5(0x158),JSON[_0x2ad3c5(0x1ba)](config));}function deleteBot(_0x4fadf5){const _0x3f13d9=_0x168baa;getClientsWithBotID(_0x4fadf5)[_0x3f13d9(0x13f)](_0x36f36b=>{const _0x3a53ae=_0x3f13d9;getSocket(_0x36f36b['id'])[_0x3a53ae(0x1f5)](!![]),removeClient(_0x36f36b['id']);}),dbConfig['get'](_0x3f13d9(0x158))[_0x3f13d9(0x2b9)]({'botID':_0x4fadf5})[_0x3f13d9(0x1eb)](),logger[_0x3f13d9(0x1dc)]('deleted\x20Bot\x20'+_0x4fadf5),stopBot(_0x4fadf5);try{if(fs[_0x3f13d9(0x2cb)](path[_0x3f13d9(0x218)](configpath,_0x3f13d9(0x1bb)+_0x4fadf5+_0x3f13d9(0x203))))fs[_0x3f13d9(0x1ed)](path[_0x3f13d9(0x218)](configpath,'bot-'+_0x4fadf5+_0x3f13d9(0x203)));if(fs[_0x3f13d9(0x2cb)](path[_0x3f13d9(0x218)](configpath,_0x3f13d9(0x1bb)+_0x4fadf5+_0x3f13d9(0x27b))))fs[_0x3f13d9(0x1ed)](path[_0x3f13d9(0x218)](configpath,'bot-'+_0x4fadf5+_0x3f13d9(0x27b)));if(fs[_0x3f13d9(0x2cb)](path['join'](configpath,_0x3f13d9(0x1bb)+_0x4fadf5+_0x3f13d9(0x1cd))))fs[_0x3f13d9(0x1ed)](path[_0x3f13d9(0x218)](configpath,_0x3f13d9(0x1bb)+_0x4fadf5+_0x3f13d9(0x1cd)));if(fs[_0x3f13d9(0x2cb)](path[_0x3f13d9(0x218)](configpath,_0x3f13d9(0x1bb)+_0x4fadf5+_0x3f13d9(0x188))))fs[_0x3f13d9(0x1ed)](path[_0x3f13d9(0x218)](configpath,_0x3f13d9(0x1bb)+_0x4fadf5+'-results.json'));}catch(_0x16e7c1){if(_0x16e7c1)logger[_0x3f13d9(0x1dc)](_0x3f13d9(0x129),_0x16e7c1);}config=getConfiguration(),io['to'](_0x3f13d9(0x14d))['emit'](_0x3f13d9(0x158),config),broadcastToBots(_0x3f13d9(0x158),JSON['stringify'](config));}function toggleBot(_0x43d7d1,_0x378765,_0x2cbe96){const _0x452d4d=_0x168baa;dbConfig[_0x452d4d(0x2d9)](_0x452d4d(0x158))['find']({'botID':_0x43d7d1})[_0x452d4d(0x178)]({'status':_0x378765})['assign']({'live':_0x2cbe96})['write']();if(_0x378765==_0x452d4d(0x1ad)||_0x378765==_0x452d4d(0x1cf))logger['full']('enabled\x20Bot\x20'+_0x43d7d1),startBot([_0x43d7d1,userID],{'cwd':bbpath},function(_0x1e6ba2){const _0x3e8e49=_0x452d4d;if(_0x1e6ba2)logger[_0x3e8e49(0x1dc)](_0x1e6ba2);});else(_0x378765==_0x452d4d(0x147)||_0x378765==_0x452d4d(0x165))&&(logger[_0x452d4d(0x1dc)](_0x452d4d(0x20d)+_0x43d7d1),stopBot(_0x43d7d1));config=getConfiguration(),io['to']('botmanager')[_0x452d4d(0x297)](_0x452d4d(0x158),config),broadcastToBots(_0x452d4d(0x158),JSON['stringify'](config));}function toggleStatus(_0x1fa64b){const _0x59948c=_0x168baa;let _0x3a700e=dbConfig[_0x59948c(0x2d9)](_0x59948c(0x158))[_0x59948c(0x2ac)]({'botID':_0x1fa64b})[_0x59948c(0x2e4)](),_0x2d3eb7;if(_0x3a700e[_0x59948c(0x12a)]===_0x59948c(0x1ad))_0x2d3eb7=_0x59948c(0x147);else{if(_0x3a700e[_0x59948c(0x12a)]===_0x59948c(0x1cf))_0x2d3eb7='new-disabled';else{if(_0x3a700e[_0x59948c(0x12a)]===_0x59948c(0x165))_0x2d3eb7='new';else{if(_0x3a700e[_0x59948c(0x12a)]===_0x59948c(0x147))_0x2d3eb7=_0x59948c(0x1ad);}}}return _0x2d3eb7;}function updateStatus(_0x1ee1c1,_0x15b08){const _0x29f409=_0x168baa;dbConfig[_0x29f409(0x2d9)](_0x29f409(0x158))[_0x29f409(0x2ac)]({'botID':_0x1ee1c1})['assign']({'status':_0x15b08})[_0x29f409(0x1eb)](),config=getConfiguration(),io['to']('botmanager')[_0x29f409(0x297)]('bots',config),broadcastToBots(_0x29f409(0x158),JSON[_0x29f409(0x1ba)](config));}function updateLive(_0x9e8e88,_0x4d8252){const _0x447645=_0x168baa;dbConfig[_0x447645(0x2d9)](_0x447645(0x158))[_0x447645(0x2ac)]({'botID':_0x9e8e88})[_0x447645(0x178)]({'live':_0x4d8252})[_0x447645(0x1eb)](),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots(_0x447645(0x158),JSON[_0x447645(0x1ba)](config));}function updateBotName(_0x4a7221,_0x499709){const _0x51c4c5=_0x168baa;dbConfig[_0x51c4c5(0x2d9)](_0x51c4c5(0x158))[_0x51c4c5(0x2ac)]({'botID':_0x4a7221})[_0x51c4c5(0x178)]({'botname':_0x499709})[_0x51c4c5(0x1eb)](),config=getConfiguration(),io['to']('botmanager')[_0x51c4c5(0x297)](_0x51c4c5(0x158),config),broadcastToBots(_0x51c4c5(0x158),JSON[_0x51c4c5(0x1ba)](config));}function _0x2f03(){const _0x17ccd5=['/:bot/coins','message','readdirSync','idling\x20bot\x20\x20\x20|\x20Bot\x20',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','length','Unauthorized\x20attempt\x20to\x20store\x20configuration','Invalid\x20username\x20or\x20IP\x20address','track','isIPv4MappedAddress','post','/:bot','verify','-results.json','express-fileupload','callback_query','sockets','getDate','once','Invalid\x20Telegram\x20token','3000','Unauthorized\x20attempt\x20to\x20get\x20messages','\x20(2)','lastmsgemitted','userid','rmSync','1008388PapBId','entries','toggleBotMode','latestversion','auto','Unauthorized\x20attempt\x20to\x20update\x20bot','statSync','zip/','telegramIpApproval','format','randomBytes','reload','accept','***','exp','update','any','Password\x20has\x20been\x20reset\x20to:\x20','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','parse','show-config','settings','store','Allow\x20login\x20from\x20IP\x20address\x20<b>','enabled','started','All\x20bots','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','storeConfiguration','args','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','hybrid-crypto-js','telegramToken','login\x20token\x20generated','getFullYear','botname','startsWith','stringify','bot-','*$1*','-----------------------------------------------------------------------------------','telegram2FaApproval','2FA\x20required','answerCallbackQuery','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','127.0.0.1','logout','node-telegram-bot-api','Temporary\x20access\x20rejected','files','Login\x20accepted','sign','hasOwnProperty','set','keys','</b>\x20?','-performance.json','lastmsgtelegram','new','telegramUsername','bbvReceive','output-003.log','Invalid\x20authentication\x20token\x20(2)','fork','handshake','Failed\x20to\x20download\x20','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','emitHistory','output-000.log','getTime','apiKey','full','telegramChatId','Session\x20expired\x20for\x20user\x20...','build','blacklist','f2aRequired','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','exchange','stopPolling','toggle-bot-mode','map','15\x20min','inherit','_data','SIGINT','write','ipaddr.js','unlinkSync','password','::ffff:127.0.0.1','22104ZafplJ','yes','Starting\x20Balance\x20Bot\x20reinstallation','messages','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','disconnect','9385SZrcBA','access\x20timeout','No\x20authentication\x20token','/download/:type','exit','backup-full','uncaughtException','5258dshkZT','reinstall','Invalid\x20authentication\x20token\x20(1)','add','conn','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','-config.json','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','init','stop',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','sortBy','pidRefreshToken','restarting\x20Bot\x20','disabled\x20Bot\x20','generate','sendMetricsTelegram','child_process','mkdirSync','restore-backup-file','Backup\x20file\x20unzipped\x20and\x20stored','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','access','secret','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','join','bbPassword','socket','Error:\x20Invalid\x20argument\x20','decrypt','toIPv4MappedAddress','No\x20bots\x20running\x20right\x20now','backup-full@','warning','\x20only\x0a','bbUsername','2FA\x20login\x20token\x20generated','Unauthorized\x20attempt\x20to\x20download\x20','kill','backup-files','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','params','.zip','uuid','axios','referer','/enable\x20-\x20enable\x20notifications\x0a','cloneDeep','sort','pidExpireLogin','19069sXPoGG','Logged\x20in\x20user\x20...','listen','Restore\x20process\x20aborted','telegramEnabled','delete-bot','expiry','Notifications\x20disabled\x0a','match','send','logged\x20out','file','/status\x20-\x20show\x20bot(s)\x20status\x0a','getPortfolio','/upload-backup','547246lEmHiS','sendPortfolioTelegram','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','/on\x20-\x20start\x20bot(s)\x0a','Login\x20rejected','login\x20token\x20valid','publicKey','static','sha256','event','privateKey','headers','function','(((.+)+)+)+$','removeAllListeners','min','/disable\x20-\x20disable\x20notifications\x0a','log','Yes','isDirectory','clientip','************','binary','resetHistory','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','show','slice','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','2FA\x20login\x20required','login','output-001.log','get-starting-balances','constructor','RSA-OAEP','Bot\x20Mgr\x20>\x20','\x20mode','hashSync','getMinutes','Password\x20reset\x20rejected','showname','bb/','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','stopped','Markdown','max','defaults','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','10DzrQHa','mixpanel','2FA','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','storeHeadless','argv','backup-full.zip','auth','writeFileSync','RSA','-events.json','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','store-fiat','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Notifications\x20enabled','bot.js','token','870PjwzJQ','getSeconds','Unauthorized\x20login\x20attempt\x20(timeout)','jsonwebtoken','Alerts','telegramEvents','Unauthorized\x20attempt\x20to\x20get\x20portfolio','version.json','port','\x20|\x20user:\x20...','\x20minutes','backup/','api-eu.mixpanel.com','/:bot/history','ipc','toString','debug','temporary\x20access\x20not\x20allowed','2hFvDeu','then','https://api.ipify.org?format=json','emit','env','NTBA_FIX_319','http','user','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','get-backup-files','/:bot/performance','Starting\x20Balance\x20Bot\x20','Setting\x20access:\x20','server','login\x20required','temporary\x20access\x20rejected','reject','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','onText','exec','store-configuration','lowdb','reset-history','find','User\x20has\x20been\x20validated','botID','hex','File\x20uploaded','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','You\x20can\x20use\x20the\x20following\x20commands:\x0a','logs/',':\x20Bot\x20Mgr\x20>\x20','config/','timeshift','tkn','whitelistEnabled','remove','headless','index.html','remoteAddress','HTML','from','output-002.log','generateKeyPairAsync','includes','Bot\x20','<b>Telegram\x20Bot\x20Status:</b>\x0a','reason','store-headless','mode','place-order','telegram','Restore\x20backup\x20file\x20','Unauthorized\x20attempt\x20to\x20get\x20events','existsSync','add-bot','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','path','live','name','createServer','Notifications\x20disabled','sendMessage','updatebotmanager','Starting\x20Balance\x20Bot\x20update','order','encryptedUuid','filter','get','5\x20min','all','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Unauthorized\x20attempt\x20to\x20update\x20settings','bot','util','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','type','catch','success','value','Logged\x20out\x20user\x20...','Unauthorized\x20attempt\x20to\x20confirm\x20message','orders','simple','lowdb/adapters/FileSync','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','username','manual','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','endsWith','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','push','node-zip','download','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','date-fns','error\x20while\x20deleting\x20config\x20files:\x20','status','onepagemode','bb-secure.json','\x20>\x20','use','deleteHistoryAlerts','Unauthorized\x20attempt\x20to\x20delete\x20alerts','0.0.0','number','alias','kind','initclient','randomFillSync','Backup\x20file\x20uploaded','\x20|\x20','/restart\x20-\x20restart\x20bot(s)\x0a','/names\x20-\x20show\x20bot\x20names\x0a','sendFile','toIPv4Address','error','loginRequired','forEach','alerts','apiSecret','graphql-request','allow','/output-000.log','starting\x20new\x20bot\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20log\x20out','disabled','cancel-loading','/metrics\x20-\x20show\x20bot\x20performance\x0a','/:bot/portfolio','polling_error','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','botmanager','temporary\x20token\x20generated','placeOrder','storeFiat','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','starting\x20bot\x20|\x20Bot\x20','chat','backup','Ok,\x20will\x20send\x20order\x20notifications\x20only','login\x20not\x20required','bbvNew','bots','build2','getMonth','settings.','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','getHours','invalid\x20credentials','compareSync','clients','store-settings','Crypt','removeListener','404\x20Not\x20Found','new-disabled','getUTCHours','100383qHmBur','running','update-bb','readFileSync','SIGTERM','1910097NTAuLu','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','notification','temp/','split','yargs/yargs','bb-settings.json','padStart','timestamp','8BPcvtH','copyFileSync','update-bot','assign','data','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?'];_0x2f03=function(){return _0x17ccd5;};return _0x2f03();}function updateBotManager(){const _0x255df8=_0x168baa;config=getConfiguration(),io['to'](_0x255df8(0x14d))[_0x255df8(0x297)](_0x255df8(0x158),config),broadcastToBots(_0x255df8(0x158),JSON[_0x255df8(0x1ba)](config));}function toggleBotMode(_0x5bd6d0){const _0xa97ad2=_0x168baa;if(pid[_0x5bd6d0])pid[_0x5bd6d0][_0xa97ad2(0x23b)]({'function':_0xa97ad2(0x197),'args':null});else{const _0x2f69ca=configpath+_0xa97ad2(0x1bb)+_0x5bd6d0+_0xa97ad2(0x203),_0x36cc71=fs[_0xa97ad2(0x16a)](_0x2f69ca),_0x449cb3=JSON['parse'](_0x36cc71),_0xb5d874=_0x449cb3[_0xa97ad2(0x2de)][0x0][_0xa97ad2(0x2ba)];_0x449cb3[_0xa97ad2(0x2de)][0x0][_0xa97ad2(0x2ba)]=!_0xb5d874;const _0x29e143=JSON[_0xa97ad2(0x1ba)](_0x449cb3,null,0x2);fs[_0xa97ad2(0x279)](_0x2f69ca,_0x29e143),config=getConfiguration(),io['to'](_0xa97ad2(0x14d))[_0xa97ad2(0x297)](_0xa97ad2(0x158),config),broadcastToBots('bots',JSON[_0xa97ad2(0x1ba)](config));}}function telegramError(_0x46caac){const _0x5e0641=_0x168baa;logger[_0x5e0641(0x2e8)](getTimeStamp()+_0x5e0641(0x208));}function validateTelegram(_0x245656){const _0x23d28b=_0x168baa;if(_0x245656[_0x23d28b(0x2be)][_0x23d28b(0x2eb)]!=settings[_0x23d28b(0x1d0)]&&'@'+_0x245656[_0x23d28b(0x2be)][_0x23d28b(0x2eb)]!=settings[_0x23d28b(0x1d0)])return tgBot[_0x23d28b(0x2d3)](_0x245656[_0x23d28b(0x153)]['id'],_0x23d28b(0x227),{'parse_mode':_0x23d28b(0x2bd)})[_0x23d28b(0x2e2)](_0x265d2a=>{telegramError(_0x265d2a);}),![];return!![];}async function initTelegram(){const _0x1b58db=_0x168baa;if(tgBot)tgBot[_0x1b58db(0x1e4)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x1b58db(0x1b5)],{'polling':!![]});let _0x53be3d=_0x1b58db(0x2b2);_0x53be3d+='\x0a',_0x53be3d+=_0x1b58db(0x22e),_0x53be3d+=_0x1b58db(0x251),_0x53be3d+=_0x1b58db(0x204),_0x53be3d+=_0x1b58db(0x139),_0x53be3d+=_0x1b58db(0x244),_0x53be3d+='/off\x20-\x20stop\x20bot(s)\x0a',_0x53be3d+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x53be3d+=_0x1b58db(0x13a),_0x53be3d+=_0x1b58db(0x23e),_0x53be3d+=_0x1b58db(0x149),_0x53be3d+=_0x1b58db(0x25c),_0x53be3d+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x53be3d+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x53be3d+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x310b3d=_0x1b58db(0x1b3);_0x310b3d+='\x0a',_0x310b3d+=_0x53be3d,tgBot[_0x1b58db(0x2a7)](/\/start/,_0x25cb96=>{const _0x13b42b=_0x1b58db;if(!validateTelegram(_0x25cb96))return;if(settings['telegramChatId']!=_0x25cb96[_0x13b42b(0x153)]['id'])updateSetting(_0x13b42b(0x1dd),_0x25cb96[_0x13b42b(0x153)]['id']);updateSetting(_0x13b42b(0x236),!![]),tgBot[_0x13b42b(0x2d3)](_0x25cb96[_0x13b42b(0x153)]['id'],_0x310b3d)['catch'](_0x38fb8f=>{telegramError(_0x38fb8f);});}),tgBot[_0x1b58db(0x2a7)](/\/enable/,_0x56e47b=>{const _0x32456b=_0x1b58db;if(!validateTelegram(_0x56e47b))return;if(settings[_0x32456b(0x1dd)]!=_0x56e47b[_0x32456b(0x153)]['id'])updateSetting(_0x32456b(0x1dd),_0x56e47b[_0x32456b(0x153)]['id']);updateSetting(_0x32456b(0x236),!![]),tgBot[_0x32456b(0x2d3)](_0x56e47b['chat']['id'],_0x32456b(0x27f))[_0x32456b(0x2e2)](_0x3cce41=>{telegramError(_0x3cce41);});}),tgBot['onText'](/\/config/,async _0x43ee50=>{const _0x4f52de=_0x1b58db;if(!validateTelegram(_0x43ee50))return;tgBot['removeListener']('callback_query'),tgBot[_0x4f52de(0x2d3)](_0x43ee50['chat']['id'],_0x4f52de(0x274),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x4f52de(0x2e7)},{'text':_0x4f52de(0x286),'callback_data':_0x4f52de(0x140)},{'text':'All','callback_data':_0x4f52de(0x2db)}]]}})['catch'](_0x23c6a3=>{telegramError(_0x23c6a3);}),tgBot['on']('callback_query',async _0x205ca1=>{const _0x57c78a=_0x4f52de,_0x3df87d=_0x205ca1[_0x57c78a(0x179)],_0x23d217=_0x205ca1[_0x57c78a(0x17c)];tgBot[_0x57c78a(0x1c0)](_0x205ca1['id'])['then'](async()=>{const _0x5598f8=_0x57c78a;_0x3df87d=='orders'&&(updateSetting('telegramEvents',_0x5598f8(0x2e7)),updateSetting('telegramEnabled',!![]),await tgBot[_0x5598f8(0x2d3)](_0x23d217[_0x5598f8(0x153)]['id'],_0x5598f8(0x155))['catch'](_0xfd2940=>{telegramError(_0xfd2940);}));_0x3df87d==_0x5598f8(0x140)&&(updateSetting(_0x5598f8(0x287),_0x5598f8(0x140)),updateSetting(_0x5598f8(0x236),!![]),await tgBot['sendMessage'](_0x23d217[_0x5598f8(0x153)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x5598f8(0x2e2)](_0x55f3a0=>{telegramError(_0x55f3a0);}));_0x3df87d=='all'&&(updateSetting(_0x5598f8(0x287),'all'),updateSetting(_0x5598f8(0x236),!![]),await tgBot[_0x5598f8(0x2d3)](_0x23d217[_0x5598f8(0x153)]['id'],_0x5598f8(0x2b1))[_0x5598f8(0x2e2)](_0x4b26fa=>{telegramError(_0x4b26fa);}));if(!settings[_0x5598f8(0x1dd)])tgBot[_0x5598f8(0x2d3)](_0x23d217[_0x5598f8(0x153)]['id'],_0x5598f8(0x15c))[_0x5598f8(0x2e2)](_0x1d1826=>{telegramError(_0x1d1826);});}),tgBot[_0x57c78a(0x163)](_0x57c78a(0x18a));});}),tgBot[_0x1b58db(0x2a7)](/\/status/,_0x326cba=>{const _0x49371f=_0x1b58db;if(!validateTelegram(_0x326cba))return;const _0x4ef310=getBotsWithMode();let _0x28447e='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x49371f(0x13f)](_0x4efcc1=>{const _0xe34c53=_0x49371f,_0x55a247=_0x4ef310['find'](_0x449de5=>_0x449de5[_0xe34c53(0x2ae)]==_0x4efcc1[_0xe34c53(0x2ae)])['mode'];_0x28447e+=_0xe34c53(0x2c2)+_0x4efcc1[_0xe34c53(0x2ae)]+':\x20'+_0x4efcc1['status']+_0xe34c53(0x138)+_0x55a247+_0xe34c53(0x138)+_0x4efcc1['live']+'\x0a';}),_0x28447e+='\x0a',_0x28447e+=_0x49371f(0x2c3),_0x28447e+=!settings['telegramEnabled']?_0x49371f(0x239):'Notifications\x20enabled\x0a',_0x28447e+=settings[_0x49371f(0x236)]?settings[_0x49371f(0x287)]==_0x49371f(0x2db)?_0x49371f(0x27c):'Notifications\x20types:\x20'+settings['telegramEvents']+_0x49371f(0x221):'',tgBot[_0x49371f(0x2d3)](_0x326cba[_0x49371f(0x153)]['id'],_0x28447e,{'parse_mode':_0x49371f(0x2bd)})[_0x49371f(0x2e2)](_0x5bae88=>{telegramError(_0x5bae88);});}),tgBot['onText'](/\/restart/,_0x3db2cd=>{const _0x4ce314=_0x1b58db;if(!validateTelegram(_0x3db2cd))return;tgBot[_0x4ce314(0x163)](_0x4ce314(0x18a));const _0x4072f0=getEnabledBots();if(_0x4072f0[_0x4ce314(0x180)]==0x0)tgBot[_0x4ce314(0x2d3)](_0x3db2cd['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x4ce314(0x2e2)](_0xd43938=>{telegramError(_0xd43938);});else{if(_0x4072f0[_0x4ce314(0x180)]>0x1)_0x4072f0[_0x4ce314(0x124)]({'botID':_0x4ce314(0x2db)});let _0x70531b=[],_0x1ab856=[];const _0x1491b0=_0x4072f0['length']%0x4==0x0||_0x4072f0[_0x4ce314(0x180)]%0x4==0x3||_0x4072f0[_0x4ce314(0x180)]%0x3==0x1?0x4:0x3;let _0x55ec41=0x0;_0x4072f0[_0x4ce314(0x13f)]((_0x3f3d33,_0x1b7c55)=>{const _0x54f79c=_0x4ce314;if(_0x1b7c55%_0x1491b0==0x0)_0x1ab856=[];_0x1ab856['push']({'text':_0x3f3d33['botID']=='all'?_0x54f79c(0x1af):_0x54f79c(0x2c2)+_0x3f3d33[_0x54f79c(0x2ae)],'callback_data':_0x3f3d33[_0x54f79c(0x2ae)]}),_0x1b7c55%_0x1491b0==0x0&&(_0x70531b[_0x55ec41]=_0x1ab856,_0x55ec41++);}),tgBot['sendMessage'](_0x3db2cd[_0x4ce314(0x153)]['id'],_0x4ce314(0x17a),{'reply_markup':{'inline_keyboard':_0x70531b}})[_0x4ce314(0x2e2)](_0x508e13=>{telegramError(_0x508e13);}),tgBot['on'](_0x4ce314(0x18a),async _0x5b7dc8=>{const _0x4fa97c=_0x4ce314,_0x41aec5=_0x5b7dc8[_0x4fa97c(0x179)],_0x1d7971=_0x5b7dc8[_0x4fa97c(0x17c)];tgBot[_0x4fa97c(0x1c0)](_0x5b7dc8['id'])[_0x4fa97c(0x295)](async()=>{const _0x41a886=_0x4fa97c;_0x41aec5==_0x41a886(0x2db)?config[_0x41a886(0x13f)](_0x141fd4=>{const _0x4c16ac=_0x41a886;restartBot(_0x141fd4[_0x4c16ac(0x2ae)]);}):restartBot(_0x41aec5);}),tgBot[_0x4fa97c(0x163)]('callback_query');});}}),tgBot[_0x1b58db(0x2a7)](/\/on/,_0x465078=>{const _0x791171=_0x1b58db;if(!validateTelegram(_0x465078))return;tgBot[_0x791171(0x163)](_0x791171(0x18a));const _0xc0bd3=getDisabledBots();if(_0xc0bd3['length']==0x0)tgBot[_0x791171(0x2d3)](_0x465078[_0x791171(0x153)]['id'],'All\x20bots\x20running\x20right\x20now')['catch'](_0x2cb3f7=>{telegramError(_0x2cb3f7);});else{if(_0xc0bd3[_0x791171(0x180)]>0x1)_0xc0bd3[_0x791171(0x124)]({'botID':_0x791171(0x2db)});let _0x6bd612=[],_0x5b2ba5=[];const _0x3b8619=_0xc0bd3[_0x791171(0x180)]%0x4==0x0||_0xc0bd3[_0x791171(0x180)]%0x4==0x3||_0xc0bd3[_0x791171(0x180)]%0x3==0x1?0x4:0x3;let _0x24877a=0x0;_0xc0bd3[_0x791171(0x13f)]((_0xbf8618,_0x10fb12)=>{const _0x25a562=_0x791171;if(_0x10fb12%_0x3b8619==0x0)_0x5b2ba5=[];_0x5b2ba5['push']({'text':_0xbf8618[_0x25a562(0x2ae)]==_0x25a562(0x2db)?_0x25a562(0x1af):_0x25a562(0x2c2)+_0xbf8618['botID'],'callback_data':_0xbf8618[_0x25a562(0x2ae)]}),_0x10fb12%_0x3b8619==0x0&&(_0x6bd612[_0x24877a]=_0x5b2ba5,_0x24877a++);}),tgBot[_0x791171(0x2d3)](_0x465078[_0x791171(0x153)]['id'],_0x791171(0x243),{'reply_markup':{'inline_keyboard':_0x6bd612}})[_0x791171(0x2e2)](_0x4c027a=>{telegramError(_0x4c027a);}),tgBot['on'](_0x791171(0x18a),async _0x4e2d8d=>{const _0x269b03=_0x791171,_0x53a1cc=_0x4e2d8d['data'],_0x234d5c=_0x4e2d8d[_0x269b03(0x17c)];tgBot[_0x269b03(0x1c0)](_0x4e2d8d['id'])[_0x269b03(0x295)](async()=>{const _0x312028=_0x269b03;_0x53a1cc==_0x312028(0x2db)?(tgBot['sendMessage'](_0x234d5c[_0x312028(0x153)]['id'],_0x312028(0x1d7))[_0x312028(0x2e2)](_0x41b4b0=>{telegramError(_0x41b4b0);}),_0xc0bd3['forEach'](_0x1ec079=>{const _0x28eefb=_0x312028;if(_0x1ec079[_0x28eefb(0x2ae)]!=_0x28eefb(0x2db))toggleBot(_0x1ec079[_0x28eefb(0x2ae)],toggleStatus(_0x1ec079['botID']),_0x28eefb(0x26c));})):(tgBot['sendMessage'](_0x234d5c['chat']['id'],_0x312028(0x270)+_0x53a1cc)[_0x312028(0x2e2)](_0x2886ac=>{telegramError(_0x2886ac);}),toggleBot(_0x53a1cc,toggleStatus(_0x53a1cc),_0x312028(0x26c)));}),tgBot[_0x269b03(0x163)]('callback_query');});}}),tgBot[_0x1b58db(0x2a7)](/\/off/,_0x3b90ca=>{const _0x50e576=_0x1b58db;if(!validateTelegram(_0x3b90ca))return;tgBot['removeListener'](_0x50e576(0x18a));const _0x5bf316=getEnabledBots();if(_0x5bf316['length']==0x0)tgBot[_0x50e576(0x2d3)](_0x3b90ca[_0x50e576(0x153)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x50e576(0x2e2)](_0x1c921d=>{telegramError(_0x1c921d);});else{if(_0x5bf316['length']>0x1)_0x5bf316['push']({'botID':_0x50e576(0x2db)});let _0x56f150=[],_0x5146ae=[];const _0x1a36d8=_0x5bf316[_0x50e576(0x180)]%0x4==0x0||_0x5bf316[_0x50e576(0x180)]%0x4==0x3||_0x5bf316[_0x50e576(0x180)]%0x3==0x1?0x4:0x3;let _0x13867f=0x0;_0x5bf316['forEach']((_0x261420,_0x800d14)=>{const _0xb4410b=_0x50e576;if(_0x800d14%_0x1a36d8==0x0)_0x5146ae=[];_0x5146ae[_0xb4410b(0x124)]({'text':_0x261420[_0xb4410b(0x2ae)]==_0xb4410b(0x2db)?_0xb4410b(0x1af):'Bot\x20'+_0x261420[_0xb4410b(0x2ae)],'callback_data':_0x261420['botID']}),_0x800d14%_0x1a36d8==0x0&&(_0x56f150[_0x13867f]=_0x5146ae,_0x13867f++);}),tgBot['sendMessage'](_0x3b90ca['chat']['id'],_0x50e576(0x228),{'reply_markup':{'inline_keyboard':_0x56f150}})[_0x50e576(0x2e2)](_0x20e58e=>{telegramError(_0x20e58e);}),tgBot['on'](_0x50e576(0x18a),async _0x4bce60=>{const _0x4a200d=_0x50e576,_0x17fed9=_0x4bce60[_0x4a200d(0x179)],_0x3a8006=_0x4bce60[_0x4a200d(0x17c)];tgBot['answerCallbackQuery'](_0x4bce60['id'])['then'](async()=>{const _0x5c2606=_0x4a200d;_0x17fed9==_0x5c2606(0x2db)?(tgBot[_0x5c2606(0x2d3)](_0x3a8006[_0x5c2606(0x153)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x5c2606(0x2e2)](_0x171819=>{telegramError(_0x171819);}),_0x5bf316[_0x5c2606(0x13f)](_0x10788b=>{const _0x1113c7=_0x5c2606;if(_0x10788b[_0x1113c7(0x2ae)]!=_0x1113c7(0x2db))toggleBot(_0x10788b[_0x1113c7(0x2ae)],toggleStatus(_0x10788b[_0x1113c7(0x2ae)]),_0x1113c7(0x26c));})):(tgBot[_0x5c2606(0x2d3)](_0x3a8006[_0x5c2606(0x153)]['id'],_0x5c2606(0x209)+_0x17fed9)['catch'](_0x239a78=>{telegramError(_0x239a78);}),toggleBot(_0x17fed9,toggleStatus(_0x17fed9),_0x5c2606(0x26c)));}),tgBot[_0x4a200d(0x163)](_0x4a200d(0x18a));});}}),tgBot['onText'](/\/metrics/,_0x569069=>{const _0x32ae19=_0x1b58db;if(!validateTelegram(_0x569069))return;tgBot[_0x32ae19(0x163)](_0x32ae19(0x18a));const _0x49dc6a=getEnabledBots();if(_0x49dc6a[_0x32ae19(0x180)]==0x0)tgBot[_0x32ae19(0x2d3)](_0x569069[_0x32ae19(0x153)]['id'],_0x32ae19(0x21e))['catch'](_0x354721=>{telegramError(_0x354721);});else{if(_0x49dc6a[_0x32ae19(0x180)]>0x1){let _0x553f8f=[],_0x1a3d64=[];const _0x10eac2=_0x49dc6a[_0x32ae19(0x180)]%0x4==0x0||_0x49dc6a[_0x32ae19(0x180)]%0x4==0x3||_0x49dc6a[_0x32ae19(0x180)]%0x3==0x1?0x4:0x3;let _0xc3f450=0x0;_0x49dc6a[_0x32ae19(0x13f)]((_0x2ee3dc,_0xbfe33b)=>{const _0x227452=_0x32ae19;if(_0xbfe33b%_0x10eac2==0x0)_0x1a3d64=[];_0x1a3d64[_0x227452(0x124)]({'text':_0x227452(0x2c2)+_0x2ee3dc[_0x227452(0x2ae)],'callback_data':_0x2ee3dc['botID']}),_0xbfe33b%_0x10eac2==0x0&&(_0x553f8f[_0xc3f450]=_0x1a3d64,_0xc3f450++);}),tgBot['sendMessage'](_0x569069[_0x32ae19(0x153)]['id'],_0x32ae19(0x2a5),{'reply_markup':{'inline_keyboard':_0x553f8f}})[_0x32ae19(0x2e2)](_0x25a1a2=>{telegramError(_0x25a1a2);}),tgBot['on'](_0x32ae19(0x18a),async _0x3eceb6=>{const _0x2c803d=_0x32ae19,_0x250c50=_0x3eceb6[_0x2c803d(0x179)],_0x38b048=_0x3eceb6[_0x2c803d(0x17c)];tgBot[_0x2c803d(0x1c0)](_0x3eceb6['id'])[_0x2c803d(0x295)](async()=>{const _0x489302=_0x2c803d;if(pid[_0x250c50])pid[_0x250c50][_0x489302(0x23b)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x2c803d(0x163)]('callback_query');});}else{const _0x56aee2=_0x49dc6a[0x0][_0x32ae19(0x2ae)];if(pid[_0x56aee2])pid[_0x56aee2][_0x32ae19(0x23b)]({'function':_0x32ae19(0x20f),'args':null});}}}),tgBot[_0x1b58db(0x2a7)](/\/portfolio/,_0x2d3072=>{const _0x1ed76a=_0x1b58db;if(!validateTelegram(_0x2d3072))return;tgBot['removeListener'](_0x1ed76a(0x18a));const _0x28f72e=getEnabledBots();if(_0x28f72e['length']==0x0)tgBot[_0x1ed76a(0x2d3)](_0x2d3072[_0x1ed76a(0x153)]['id'],_0x1ed76a(0x21e))['catch'](_0xd649db=>{telegramError(_0xd649db);});else{if(_0x28f72e['length']>0x1){let _0x208b0e=[],_0x42930a=[];const _0x448449=_0x28f72e[_0x1ed76a(0x180)]%0x4==0x0||_0x28f72e[_0x1ed76a(0x180)]%0x4==0x3||_0x28f72e[_0x1ed76a(0x180)]%0x3==0x1?0x4:0x3;let _0x57f5dc=0x0;_0x28f72e[_0x1ed76a(0x13f)]((_0x34e1c3,_0x1ca29a)=>{const _0x3cca43=_0x1ed76a;if(_0x1ca29a%_0x448449==0x0)_0x42930a=[];_0x42930a['push']({'text':_0x3cca43(0x2c2)+_0x34e1c3['botID'],'callback_data':_0x34e1c3[_0x3cca43(0x2ae)]}),_0x1ca29a%_0x448449==0x0&&(_0x208b0e[_0x57f5dc]=_0x42930a,_0x57f5dc++);}),tgBot[_0x1ed76a(0x2d3)](_0x2d3072[_0x1ed76a(0x153)]['id'],_0x1ed76a(0x2ea),{'reply_markup':{'inline_keyboard':_0x208b0e}})[_0x1ed76a(0x2e2)](_0x1e9387=>{telegramError(_0x1e9387);}),tgBot['on'](_0x1ed76a(0x18a),async _0x10f680=>{const _0xa955b0=_0x1ed76a,_0x11ae5d=_0x10f680['data'],_0x444bc9=_0x10f680['message'];tgBot[_0xa955b0(0x1c0)](_0x10f680['id'])['then'](async()=>{if(pid[_0x11ae5d])pid[_0x11ae5d]['send']({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0xa955b0(0x163)](_0xa955b0(0x18a));});}else{const _0x31eb0c=_0x28f72e[0x0]['botID'];if(pid[_0x31eb0c])pid[_0x31eb0c]['send']({'function':_0x1ed76a(0x242),'args':null});}}}),tgBot[_0x1b58db(0x2a7)](/\/update/,async _0x5b3ea7=>{const _0x44ac23=_0x1b58db;if(!validateTelegram(_0x5b3ea7))return;tgBot[_0x44ac23(0x163)](_0x44ac23(0x18a)),await getMessages();if(!updateAvailable)tgBot[_0x44ac23(0x2d3)](_0x5b3ea7['chat']['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')['catch'](_0x1a6af1=>{telegramError(_0x1a6af1);});else!validInstallation?tgBot[_0x44ac23(0x2d3)](_0x5b3ea7[_0x44ac23(0x153)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0x44ac23(0x2e2)](_0xf99866=>{telegramError(_0xf99866);}):(tgBot[_0x44ac23(0x2d3)](_0x5b3ea7[_0x44ac23(0x153)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x44ac23(0x253),'callback_data':_0x44ac23(0x1f1)},{'text':'No','callback_data':'no'}]]}})[_0x44ac23(0x2e2)](_0x2894d8=>{telegramError(_0x2894d8);}),tgBot['on'](_0x44ac23(0x18a),async _0x265419=>{const _0x52102a=_0x44ac23,_0x58f845=_0x265419[_0x52102a(0x179)],_0x25ef0a=_0x265419[_0x52102a(0x17c)];tgBot[_0x52102a(0x1c0)](_0x265419['id'])['then'](async()=>{const _0x25a176=_0x52102a;_0x58f845==_0x25a176(0x1f1)&&(await tgBot[_0x25a176(0x2d3)](_0x25ef0a[_0x25a176(0x153)]['id'],_0x25a176(0x2d5))[_0x25a176(0x2e2)](_0x2abec8=>{telegramError(_0x2abec8);}),updateBB('update')),_0x58f845=='no'&&await tgBot['sendMessage'](_0x25ef0a[_0x25a176(0x153)]['id'],_0x25a176(0x2dc))[_0x25a176(0x2e2)](_0x2a20a9=>{telegramError(_0x2a20a9);});}),tgBot['removeListener'](_0x52102a(0x18a));}));}),tgBot[_0x1b58db(0x2a7)](/\/reinstall/,async _0x5a0715=>{const _0x15db9c=_0x1b58db;if(!validateTelegram(_0x5a0715))return;tgBot[_0x15db9c(0x163)](_0x15db9c(0x18a)),!validInstallation?tgBot[_0x15db9c(0x2d3)](_0x5a0715[_0x15db9c(0x153)]['id'],_0x15db9c(0x214))['catch'](_0x301e13=>{telegramError(_0x301e13);}):(tgBot['sendMessage'](_0x5a0715[_0x15db9c(0x153)]['id'],_0x15db9c(0x2a6),{'reply_markup':{'inline_keyboard':[[{'text':_0x15db9c(0x253),'callback_data':_0x15db9c(0x1f1)},{'text':'No','callback_data':'no'}]]}})[_0x15db9c(0x2e2)](_0x441c8c=>{telegramError(_0x441c8c);}),tgBot['on'](_0x15db9c(0x18a),async _0x5d625d=>{const _0x6676ee=_0x15db9c,_0x399958=_0x5d625d['data'],_0xe536f1=_0x5d625d[_0x6676ee(0x17c)];tgBot[_0x6676ee(0x1c0)](_0x5d625d['id'])['then'](async()=>{const _0x299e9d=_0x6676ee;_0x399958==_0x299e9d(0x1f1)&&(await tgBot['sendMessage'](_0xe536f1['chat']['id'],_0x299e9d(0x1f2))[_0x299e9d(0x2e2)](_0x155d4d=>{telegramError(_0x155d4d);}),updateBB(_0x299e9d(0x1fe))),_0x399958=='no'&&await tgBot[_0x299e9d(0x2d3)](_0xe536f1['chat']['id'],_0x299e9d(0x1e2))[_0x299e9d(0x2e2)](_0xeccd41=>{telegramError(_0xeccd41);});}),tgBot[_0x6676ee(0x163)]('callback_query');}));}),tgBot[_0x1b58db(0x2a7)](/\/toggle/,_0xc0e342=>{const _0x3a1151=_0x1b58db;if(!validateTelegram(_0xc0e342))return;tgBot['removeListener'](_0x3a1151(0x18a));const _0x2c8b02=getBotsWithMode();if(_0x2c8b02['length']==0x0)tgBot[_0x3a1151(0x2d3)](_0xc0e342[_0x3a1151(0x153)]['id'],_0x3a1151(0x21e))['catch'](_0x4c37ad=>{telegramError(_0x4c37ad);});else{let _0x29b847=[],_0x287f98=[];const _0x1d9e95=0x2;let _0x2458d9=0x0;_0x2c8b02['forEach']((_0x4aeac2,_0x185c19)=>{const _0xc8fec2=_0x3a1151;if(_0x185c19%_0x1d9e95==0x0)_0x287f98=[];_0x287f98[_0xc8fec2(0x124)]({'text':_0xc8fec2(0x2c2)+_0x4aeac2[_0xc8fec2(0x2ae)]+'\x20('+_0x4aeac2[_0xc8fec2(0x2c6)]+')','callback_data':_0x4aeac2[_0xc8fec2(0x2ae)]}),_0x185c19%_0x1d9e95==0x0&&(_0x29b847[_0x2458d9]=_0x287f98,_0x2458d9++);}),tgBot[_0x3a1151(0x2d3)](_0xc0e342[_0x3a1151(0x153)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0x29b847}})[_0x3a1151(0x2e2)](_0x3d5a9d=>{telegramError(_0x3d5a9d);}),tgBot['on']('callback_query',async _0x249a72=>{const _0x55163b=_0x3a1151,_0x400e2e=_0x249a72[_0x55163b(0x179)],_0x164046=_0x249a72[_0x55163b(0x17c)];tgBot[_0x55163b(0x1c0)](_0x249a72['id'])['then'](async()=>{const _0x20270e=_0x55163b,_0x3221f9=_0x2c8b02[_0x20270e(0x2ac)](_0x18f7cf=>_0x18f7cf[_0x20270e(0x2ae)]==_0x400e2e),_0x1fb479=_0x3221f9['mode']=='auto'?_0x20270e(0x120):_0x20270e(0x199);tgBot[_0x20270e(0x2d3)](_0x164046[_0x20270e(0x153)]['id'],_0x20270e(0x1b0)+_0x400e2e+'\x20to\x20'+_0x1fb479+_0x20270e(0x265))[_0x20270e(0x2e2)](_0x22a681=>{telegramError(_0x22a681);}),toggleBotMode(_0x400e2e);}),tgBot['removeListener'](_0x55163b(0x18a));});}}),tgBot[_0x1b58db(0x2a7)](/\/names/,_0x49c179=>{const _0x266d93=_0x1b58db;if(!validateTelegram(_0x49c179))return;let _0x58821a='';config[_0x266d93(0x13f)](_0x4c7b25=>{const _0x43c5c3=_0x266d93;_0x58821a+=_0x43c5c3(0x2c2)+_0x4c7b25[_0x43c5c3(0x2ae)]+':\x20'+_0x4c7b25['botname']+'\x0a';}),tgBot[_0x266d93(0x2d3)](_0x49c179[_0x266d93(0x153)]['id'],_0x58821a,{'parse_mode':_0x266d93(0x2bd)})[_0x266d93(0x2e2)](_0x5d8aa0=>{telegramError(_0x5d8aa0);});}),tgBot[_0x1b58db(0x2a7)](/\/disable/,_0x64e6fe=>{const _0x247571=_0x1b58db;if(!validateTelegram(_0x64e6fe))return;tgBot['sendMessage'](_0x64e6fe[_0x247571(0x153)]['id'],_0x247571(0x2d2))[_0x247571(0x2e2)](_0x3cb391=>{telegramError(_0x3cb391);}),updateSetting(_0x247571(0x236),![]);}),tgBot[_0x1b58db(0x2a7)](/\/help/,_0x35a4b0=>{const _0x197bf0=_0x1b58db;if(!validateTelegram(_0x35a4b0))return;tgBot[_0x197bf0(0x2d3)](_0x35a4b0['chat']['id'],_0x53be3d)[_0x197bf0(0x2e2)](_0xcae3c1=>{telegramError(_0xcae3c1);});}),tgBot['on'](_0x1b58db(0x14b),_0x2acc53=>{const _0x3b0782=_0x1b58db;_0x2acc53['toString']()[_0x3b0782(0x2c1)](_0x3b0782(0x164))&&(logger['full'](_0x3b0782(0x18e)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x3b0782(0x14d))[_0x3b0782(0x297)]('notification',_0x3b0782(0x18e)));}),process['once'](_0x1b58db(0x1ea),()=>{const _0x163887=_0x1b58db;if(tgBot)tgBot[_0x163887(0x1e4)]();process[_0x163887(0x1fa)](0x1);}),process[_0x1b58db(0x18d)](_0x1b58db(0x16b),()=>{const _0x48b688=_0x1b58db;if(tgBot)tgBot[_0x48b688(0x1e4)]();process[_0x48b688(0x1fa)](0x1);});}}function disableTelegram(){const _0x53937e=_0x168baa;tgBot&&(tgBot[_0x53937e(0x1e4)](),tgBot=null);}function sendTelegram(_0x6a99a1,_0x3f03d9){const _0x2497ff=_0x168baa;if(settings[_0x2497ff(0x236)]){if(settings[_0x2497ff(0x287)]==_0x2497ff(0x2db)||(_0x3f03d9[_0x2497ff(0x2e1)]==_0x2497ff(0x13d)||_0x3f03d9['type']==_0x2497ff(0x220)||_0x3f03d9['type']==_0x2497ff(0x2e3))&&settings[_0x2497ff(0x287)]==_0x2497ff(0x140)||_0x3f03d9[_0x2497ff(0x2e1)]==_0x2497ff(0x2d6)&&settings[_0x2497ff(0x287)]==_0x2497ff(0x2e7)){if(tgBot&&settings[_0x2497ff(0x1dd)]){if(_0x3f03d9[_0x2497ff(0x269)])tgBot[_0x2497ff(0x2d3)](settings[_0x2497ff(0x1dd)],_0x3f03d9[_0x2497ff(0x1b8)]+_0x2497ff(0x12d)+_0x3f03d9[_0x2497ff(0x24a)])[_0x2497ff(0x2e2)](_0x314235=>{telegramError(_0x314235);});else tgBot['sendMessage'](settings[_0x2497ff(0x1dd)],_0x2497ff(0x2c2)+_0x6a99a1+'\x20>\x20'+_0x3f03d9[_0x2497ff(0x24a)])[_0x2497ff(0x2e2)](_0x1e28d0=>{telegramError(_0x1e28d0);});}}}}async function sendTelegramMsg(_0x2271a7,_0x1c58a8=_0x168baa(0x2bd)){const _0x1f45b0=_0x168baa;return settings[_0x1f45b0(0x236)]&&tgBot&&settings[_0x1f45b0(0x1dd)]?(await tgBot[_0x1f45b0(0x2d3)](settings[_0x1f45b0(0x1dd)],_0x2271a7,{'parse_mode':_0x1c58a8})[_0x1f45b0(0x2e2)](_0x235b8e=>{telegramError(_0x235b8e);}),!![]):![];}function getDeviceWithIp(_0x36c14a){return devices['find'](_0x5f414b=>_0x5f414b['ip']===_0x36c14a);}function temporaryAccess2FA(_0x17948a,_0x339e64){const _0x9f3429=_0x168baa;let _0xc5d943=new Date(),_0x1aa1d4=![];if(lastIpApproval){if(_0xc5d943-lastIpApproval<0x1388)_0x1aa1d4=!![];}lastIpApproval=new Date();if(_0x1aa1d4)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x9f3429(0x163)]('callback_query'),tgBot['sendMessage'](settings[_0x9f3429(0x1dd)],_0x9f3429(0x26b)+normalizeIP(_0x339e64)[_0x9f3429(0x25a)]+_0x9f3429(0x1cc),{'parse_mode':_0x9f3429(0x2bd),'reply_markup':{'inline_keyboard':[[{'text':_0x9f3429(0x2da),'callback_data':'5'},{'text':_0x9f3429(0x1e7),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x9f3429(0x2a4),'callback_data':'reject'}]]}})['catch'](_0x3e317b=>{telegramError(_0x3e317b);}),tgBot['on'](_0x9f3429(0x18a),async _0x112a85=>{const _0x2a85eb=_0x9f3429,_0x27495f=_0x112a85['data'],_0xe630a1=_0x112a85[_0x2a85eb(0x17c)];tgBot[_0x2a85eb(0x1c0)](_0x112a85['id'])['then'](async()=>{const _0x20a6a8=_0x2a85eb;devices[_0x17948a][_0x20a6a8(0x19d)]={'clientip':_0x339e64,'timestamp':new Date()[_0x20a6a8(0x1da)](),'expiry':_0x27495f},_0x27495f!=_0x20a6a8(0x2a4)?(await tgBot[_0x20a6a8(0x2d3)](_0xe630a1['chat']['id'],'Access\x20enabled\x20for\x20'+_0x27495f+_0x20a6a8(0x28c),{'parse_mode':_0x20a6a8(0x2bd)})[_0x20a6a8(0x2e2)](_0xe7cef7=>{telegramError(_0xe7cef7);}),io['to'](_0x17948a)[_0x20a6a8(0x297)](_0x20a6a8(0x12a),{'access':{'allow':![],'reason':_0x20a6a8(0x1a0),'token':null}})):(await tgBot[_0x20a6a8(0x2d3)](_0xe630a1[_0x20a6a8(0x153)]['id'],_0x20a6a8(0x1c5))[_0x20a6a8(0x2e2)](_0x28f76a=>{telegramError(_0x28f76a);}),io['to'](_0x17948a)[_0x20a6a8(0x297)](_0x20a6a8(0x12a),{'access':{'allow':![],'reason':_0x20a6a8(0x2a3),'token':null}}));}),tgBot[_0x2a85eb(0x163)](_0x2a85eb(0x18a));}));}function loginAccess2FA(_0x1de802,_0x19c920){const _0x5213d1=_0x168baa;tgBot&&settings['telegramChatId']&&(tgBot[_0x5213d1(0x163)]('callback_query'),tgBot[_0x5213d1(0x2d3)](settings[_0x5213d1(0x1dd)],_0x5213d1(0x1ac)+normalizeIP(_0x19c920)['show']+_0x5213d1(0x1cc),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x5213d1(0x1a1),'callback_data':loginExpiry},{'text':_0x5213d1(0x2a4),'callback_data':_0x5213d1(0x2a4)}]]}})[_0x5213d1(0x2e2)](_0x80245=>{telegramError(_0x80245);}),tgBot['on']('callback_query',async _0xc0ab32=>{const _0x249e1b=_0x5213d1,_0x1937c9=_0xc0ab32[_0x249e1b(0x179)],_0xb2cce7=_0xc0ab32[_0x249e1b(0x17c)];tgBot[_0x249e1b(0x1c0)](_0xc0ab32['id'])[_0x249e1b(0x295)](async()=>{const _0x4a401a=_0x249e1b;devices[_0x1de802][_0x4a401a(0x1be)]={'clientip':_0x19c920,'timestamp':new Date()['getTime'](),'expiry':_0x1937c9},_0x1937c9!='reject'?(await tgBot[_0x4a401a(0x2d3)](_0xb2cce7[_0x4a401a(0x153)]['id'],_0x4a401a(0x1c7),{'parse_mode':_0x4a401a(0x2bd)})['catch'](_0x24850b=>{telegramError(_0x24850b);}),io['to'](_0x1de802)[_0x4a401a(0x297)](_0x4a401a(0x12a),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x4a401a(0x2d3)](_0xb2cce7[_0x4a401a(0x153)]['id'],_0x4a401a(0x245))[_0x4a401a(0x2e2)](_0xa3c629=>{telegramError(_0xa3c629);}),io['to'](_0x1de802)[_0x4a401a(0x297)]('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x249e1b(0x163)](_0x249e1b(0x18a));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x68c443=_0x168baa;return dbConfig[_0x68c443(0x2d9)](_0x68c443(0x158))[_0x68c443(0x20a)](_0x68c443(0x2ae))[_0x68c443(0x2d8)]({'status':_0x68c443(0x1ad)})[_0x68c443(0x2e4)]()||[];}function getDisabledBots(){const _0x50ae15=_0x168baa;return dbConfig['get'](_0x50ae15(0x158))[_0x50ae15(0x20a)](_0x50ae15(0x2ae))['filter']({'status':_0x50ae15(0x147)})[_0x50ae15(0x2e4)]()||[];}function getBotAttributes(_0xac2d0c){const _0x35858c=_0x168baa;let _0x49691b={};const _0x111f6f=configpath+_0x35858c(0x1bb)+_0xac2d0c+_0x35858c(0x203),_0x5914f5=fs[_0x35858c(0x2cb)](_0x111f6f);if(_0x5914f5){const _0x424d5e=fs[_0x35858c(0x16a)](_0x111f6f);try{const _0x4655ac=JSON['parse'](_0x424d5e),_0x19cc4d=_0x4655ac?_0x4655ac[_0x35858c(0x2de)][0x0][_0x35858c(0x2ba)]:![];_0x49691b['mode']=_0x19cc4d?_0x35858c(0x199):_0x35858c(0x120),_0x49691b[_0x35858c(0x1b8)]=_0x4655ac?_0x4655ac[_0x35858c(0x2de)][0x0][_0x35858c(0x1b8)]:_0x35858c(0x2c2)+_0xac2d0c;}catch(_0x31d1b9){_0x49691b[_0x35858c(0x2c6)]=_0x35858c(0x120),_0x49691b[_0x35858c(0x1b8)]='Bot\x20'+_0xac2d0c;}}else _0x49691b['mode']=_0x35858c(0x120),_0x49691b['botname']=_0x35858c(0x2c2)+_0xac2d0c;return _0x49691b;}function getBotsWithMode(){const _0x1eb57e=_0x168baa,_0xb80e0b=dbConfig[_0x1eb57e(0x2d9)](_0x1eb57e(0x158))[_0x1eb57e(0x20a)]('botID')[_0x1eb57e(0x2e4)]()||[];return _0xb80e0b['forEach'](_0x421a63=>{const _0x501191=_0x1eb57e;let _0x1505f0=getBotAttributes(_0x421a63[_0x501191(0x2ae)]);_0x421a63[_0x501191(0x2c6)]=_0x1505f0['mode'];}),_0xb80e0b;}function getBotExchanges(){const _0xbcb4cb=_0x168baa;let _0x49595b=[];const _0x1031bb=dbConfig['get'](_0xbcb4cb(0x158))[_0xbcb4cb(0x20a)](_0xbcb4cb(0x2ae))[_0xbcb4cb(0x2e4)]()||[];_0x1031bb[_0xbcb4cb(0x13f)](_0x126016=>{const _0x1e908d=_0xbcb4cb;if(_0x126016[_0x1e908d(0x12a)]=='enabled'){const _0x491ddf=configpath+'bot-'+_0x126016[_0x1e908d(0x2ae)]+'-config.json',_0x307d54=fs[_0x1e908d(0x2cb)](_0x491ddf);let _0x5e84bd;if(_0x307d54){const _0x4763f7=fs[_0x1e908d(0x16a)](_0x491ddf);try{const _0x430fad=JSON[_0x1e908d(0x1a8)](_0x4763f7);_0x5e84bd=_0x430fad?_0x430fad[_0x1e908d(0x2de)][0x0][_0x1e908d(0x1e3)]:null;}catch(_0x5780c2){}}if(_0x5e84bd)_0x49595b['push'](_0x5e84bd);}});const _0x24fd88=[...new Set(_0x49595b)][_0xbcb4cb(0x230)]();return _0x24fd88;}async function initUser(){const _0x8fbb52=_0x168baa;if(!settings[_0x8fbb52(0x193)]){const _0x121b46=uuidRandom();mixpanel[_0x8fbb52(0x133)](_0x121b46),updateSetting(_0x8fbb52(0x193),_0x121b46);}}async function initSecure(){const _0x12cc4f=_0x168baa;let _0x5f09b7=getSecure();if(!_0x5f09b7[_0x12cc4f(0x1c9)](_0x12cc4f(0x216))){let _0x15db4c=await generateKeys();_0x5f09b7[_0x12cc4f(0x247)]=_0x15db4c[_0x12cc4f(0x247)],_0x5f09b7[_0x12cc4f(0x24b)]=_0x15db4c[_0x12cc4f(0x24b)],_0x5f09b7[_0x12cc4f(0x216)]=crypto[_0x12cc4f(0x19f)](0x20)[_0x12cc4f(0x291)](_0x12cc4f(0x2af));;storeSecure(_0x5f09b7);}}function getSettings(){const _0x19a22c=_0x168baa;return dbSettings[_0x19a22c(0x2d9)](_0x19a22c(0x1aa))[_0x19a22c(0x2e4)]()||{};}function getSecure(){const _0x38cd8a=_0x168baa;return dbSecure[_0x38cd8a(0x2d9)]('secure')[_0x38cd8a(0x2e4)]()||{};}function getBlacklist(){const _0x36c768=_0x168baa;return dbSecure[_0x36c768(0x2d9)](_0x36c768(0x1e0))['value']()||[];}function broadcastToBots(_0x37c672,_0x31a957){const _0x1b9cc2=_0x168baa;config[_0x1b9cc2(0x13f)](_0x24b5bb=>{const _0x4b54ed=_0x1b9cc2;if(_0x24b5bb['status']=='enabled'&&_0x24b5bb[_0x4b54ed(0x2cf)]==_0x4b54ed(0x168)){if(pid[_0x24b5bb[_0x4b54ed(0x2ae)]])pid[_0x24b5bb[_0x4b54ed(0x2ae)]]['send']({[_0x37c672]:_0x31a957});}});}function storeSettings(_0x5425df,_0x5b97c9=![]){const _0x2d5431=_0x168baa;_0x5425df={...settings,..._0x5425df};if(_0x5b97c9&&_0x5425df[_0x2d5431(0x219)]!=_0x2d5431(0x256)&&_0x5425df[_0x2d5431(0x219)]!='***'&&_0x5425df[_0x2d5431(0x219)]!=''){const _0x5e1e0b=crypt[_0x2d5431(0x21c)](secure[_0x2d5431(0x24b)],_0x5425df[_0x2d5431(0x219)])[_0x2d5431(0x17c)]['split']('@')[0x0],_0x5b8ae0=bcrypt['hashSync'](_0x5e1e0b,saltRounds);_0x5425df={..._0x5425df,'bbPassword':_0x5b8ae0};}if(_0x5b97c9&&_0x5425df[_0x2d5431(0x1b5)]!=_0x2d5431(0x256)&&_0x5425df[_0x2d5431(0x1b5)]!=_0x2d5431(0x1a2)&&_0x5425df[_0x2d5431(0x1b5)]!=''){const _0x5a7ebf=crypt[_0x2d5431(0x21c)](secure['privateKey'],_0x5425df[_0x2d5431(0x1b5)])[_0x2d5431(0x17c)][_0x2d5431(0x170)]('@')[0x0];_0x5425df={..._0x5425df,'telegramToken':_0x5a7ebf};}const _0x2130ef=_0x5425df[_0x2d5431(0x1b5)]!='************'&&_0x5425df['telegramToken']!=settings[_0x2d5431(0x1b5)]||_0x5425df[_0x2d5431(0x1d0)]!=settings[_0x2d5431(0x1d0)],_0x38c071=_0x5425df[_0x2d5431(0x1b5)]==''||_0x5425df[_0x2d5431(0x1d0)]=='';if(_0x2130ef)_0x5425df['telegramEvents']='all';for(const [_0x5568c4,_0x19048c]of Object[_0x2d5431(0x196)](_0x5425df)){if(_0x5568c4==_0x2d5431(0x1b5)&&_0x19048c==_0x2d5431(0x256)){_0x5425df['telegramToken']=settings['telegramToken'];continue;};if(_0x5568c4=='bbPassword'&&_0x19048c=='************'){_0x5425df[_0x2d5431(0x219)]=settings['bbPassword'];continue;};dbSettings[_0x2d5431(0x1ca)](_0x2d5431(0x15b)+_0x5568c4,_0x19048c)['write']();}settings=_0x5425df,io['to'](_0x2d5431(0x14d))['emit'](_0x2d5431(0x1aa),cleanSettings()),broadcastToBots(_0x2d5431(0x2b6),settings[_0x2d5431(0x2b6)]),broadcastToBots(_0x2d5431(0x12b),settings[_0x2d5431(0x12b)]);if(_0x2130ef&&!_0x38c071)initTelegram();if(_0x2130ef&&_0x38c071)disableTelegram();getAllClients()[_0x2d5431(0x13f)](_0x3e8092=>{const _0x1817d7=_0x2d5431;getSocket(_0x3e8092['id'])['emit'](_0x1817d7(0x12a),{'access':{'allow':![],'reason':_0x1817d7(0x1a0),'token':null}});});}function updateSetting(_0x3c3f5f,_0x5e7308){const _0x493377=_0x168baa;dbSettings[_0x493377(0x1ca)]('settings.'+_0x3c3f5f,_0x5e7308)['write'](),settings=getSettings(),io['to'](_0x493377(0x14d))['emit'](_0x493377(0x1aa),cleanSettings());}function storeSecure(_0x2acc3c){const _0x56d2cd=_0x168baa;dbSecure[_0x56d2cd(0x2d9)]('secure')[_0x56d2cd(0x124)](_0x2acc3c)[_0x56d2cd(0x1eb)](),secure=_0x2acc3c;}function addBlacklist(_0x505c20){const _0x4df238=_0x168baa;cleanBlacklist();let _0x2c1e6f;devices[_0x505c20][_0x4df238(0x19d)]?_0x2c1e6f=Math[_0x4df238(0x26e)](devices[_0x505c20][_0x4df238(0x19d)][_0x4df238(0x238)],loginExpiry):_0x2c1e6f=loginExpiry,dbSecure[_0x4df238(0x2d9)]('blacklist')[_0x4df238(0x124)]({'expiry':new Date()[_0x4df238(0x1da)]()+_0x2c1e6f*0x3c*0x3e8,'token':devices[_0x505c20]['access'][_0x4df238(0x281)]})[_0x4df238(0x1eb)](),blacklist=dbSecure[_0x4df238(0x2d9)](_0x4df238(0x1e0))['value']();}function cleanBlacklist(){const _0x28737f=_0x168baa;let _0x305580=dbSecure[_0x28737f(0x2d9)]('blacklist')[_0x28737f(0x22f)]()[_0x28737f(0x2e4)](),_0x4bb1dd=new Date()[_0x28737f(0x1da)]();_0x305580[_0x28737f(0x13f)](_0x10b8d7=>{const _0x99bf54=_0x28737f;_0x10b8d7[_0x99bf54(0x238)]<_0x4bb1dd&&dbSecure['get'](_0x99bf54(0x1e0))['remove']({'expiry':_0x10b8d7[_0x99bf54(0x238)]})[_0x99bf54(0x1eb)]();});}function initStates(){let _0x570ff8=getConfiguration();_0x570ff8['forEach'](_0x411d83=>{const _0x137fdb=_0x167f;_0x411d83[_0x137fdb(0x2cf)]=_0x137fdb(0x26c);}),storeConfiguration(_0x570ff8);}function onKeys(){const _0x492713=new RSA();return new Promise(_0x5495b9=>{const _0x1db826=_0x167f;_0x492713[_0x1db826(0x2c0)]()['then'](_0x362115=>{_0x5495b9(_0x362115);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x34c0cd=_0x168baa;let _0x3b3675=getSettings(),_0x1843c2=![];!_0x3b3675[_0x34c0cd(0x1c9)]('lastmsgtelegram')&&(_0x3b3675[_0x34c0cd(0x1ce)]=0x0,_0x1843c2=!![]);!_0x3b3675['hasOwnProperty'](_0x34c0cd(0x192))&&(_0x3b3675[_0x34c0cd(0x192)]=0x0,_0x1843c2=!![]);!_0x3b3675[_0x34c0cd(0x1c9)](_0x34c0cd(0x198))&&(_0x3b3675[_0x34c0cd(0x198)]=_0x34c0cd(0x131),_0x1843c2=!![]);!_0x3b3675[_0x34c0cd(0x1c9)](_0x34c0cd(0x12b))&&(_0x3b3675['onepagemode']=![],_0x1843c2=!![]);if(_0x1843c2)storeSettings(_0x3b3675);}function storeConfiguration(_0xf36aca){const _0x232940=_0x168baa;dbConfig['get']('bots')[_0x232940(0x2b9)]()[_0x232940(0x1eb)](),_0xf36aca[_0x232940(0x13f)](_0x23a4eb=>{const _0x53822d=_0x232940;delete _0x23a4eb[_0x53822d(0x2c6)];}),dbConfig[_0x232940(0x2d9)](_0x232940(0x158))[_0x232940(0x124)](..._0xf36aca)['write'](),config=_0xf36aca;}function resetPassword(){const _0x449014=_0x168baa;tgBot&&settings['telegramChatId']&&(tgBot[_0x449014(0x163)](_0x449014(0x18a)),tgBot['sendMessage'](settings[_0x449014(0x1dd)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x449014(0x2bd),'reply_markup':{'inline_keyboard':[[{'text':_0x449014(0x1f1),'callback_data':_0x449014(0x1f1)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x18c51b=>{telegramError(_0x18c51b);}),tgBot['on'](_0x449014(0x18a),async _0x430cdc=>{const _0x5caf2a=_0x449014,_0x4ebdd2=_0x430cdc['data'],_0x70bd80=_0x430cdc[_0x5caf2a(0x17c)];tgBot['answerCallbackQuery'](_0x430cdc['id'])[_0x5caf2a(0x295)](async()=>{const _0x43a16b=_0x5caf2a;if(_0x4ebdd2!='no'){const _0x5a0637=0xf,_0x1fb344=_0x43a16b(0x25d),_0x305b6a=Array[_0x43a16b(0x2be)](crypto[_0x43a16b(0x136)](new Uint32Array(_0x5a0637)))[_0x43a16b(0x1e6)](_0x461019=>_0x1fb344[_0x461019%_0x1fb344[_0x43a16b(0x180)]])[_0x43a16b(0x218)](''),_0x464351=bcrypt[_0x43a16b(0x266)](_0x305b6a,saltRounds);storeSettings({'bbPassword':_0x464351}),await tgBot[_0x43a16b(0x2d3)](_0x70bd80[_0x43a16b(0x153)]['id'],_0x43a16b(0x1a6)+_0x305b6a,{'parse_mode':'HTML'})[_0x43a16b(0x2e2)](_0x1b9878=>{telegramError(_0x1b9878);});}else await tgBot[_0x43a16b(0x2d3)](_0x70bd80[_0x43a16b(0x153)]['id'],_0x43a16b(0x268))[_0x43a16b(0x2e2)](_0x127ece=>{telegramError(_0x127ece);});}),tgBot[_0x5caf2a(0x163)](_0x5caf2a(0x18a));}));}async function confirmRestore(_0x55722f,_0x378e67){const _0x5cddec=_0x168baa;io['to'](_0x5cddec(0x14d))[_0x5cddec(0x297)](_0x5cddec(0x16e),_0x5cddec(0x123),'success'),tgBot&&settings['telegramChatId']&&(tgBot[_0x5cddec(0x163)]('callback_query'),await tgBot['sendMessage'](settings[_0x5cddec(0x1dd)],_0x5cddec(0x259),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x5cddec(0x1f1),'callback_data':_0x5cddec(0x1f1)},{'text':'no','callback_data':'no'}]]}})[_0x5cddec(0x2e2)](_0x213f25=>{telegramError(_0x213f25);}),tgBot['on'](_0x5cddec(0x18a),async _0xf1605a=>{const _0x3e82d6=_0x5cddec,_0x3eb7c5=_0xf1605a[_0x3e82d6(0x179)],_0x110167=_0xf1605a[_0x3e82d6(0x17c)];tgBot[_0x3e82d6(0x1c0)](_0xf1605a['id'])[_0x3e82d6(0x295)](async()=>{const _0x2c8630=_0x3e82d6;_0x3eb7c5==_0x2c8630(0x1f1)?(await tgBot[_0x2c8630(0x2d3)](_0x110167[_0x2c8630(0x153)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':'HTML'})[_0x2c8630(0x2e2)](_0x171d32=>{telegramError(_0x171d32);}),unzipFile(_0x55722f,_0x378e67)):(logger[_0x2c8630(0x292)]('Restore\x20process\x20aborted'),await tgBot['sendMessage'](_0x110167[_0x2c8630(0x153)]['id'],_0x2c8630(0x235))[_0x2c8630(0x2e2)](_0x5f3e19=>{telegramError(_0x5f3e19);}));}),tgBot[_0x3e82d6(0x163)](_0x3e82d6(0x18a));}));}function getServerTime(){const _0x5510bd=_0x168baa,_0x415d5e=new Date();return _0x415d5e[_0x5510bd(0x1b7)]()+'/'+(_0x415d5e['getMonth']()+0x1)['toString']()[_0x5510bd(0x173)](0x2,'0')+'/'+_0x415d5e['getDate']()[_0x5510bd(0x291)]()[_0x5510bd(0x173)](0x2,'0')+'\x20'+_0x415d5e[_0x5510bd(0x15d)]()[_0x5510bd(0x291)]()[_0x5510bd(0x173)](0x2,'0')+':'+_0x415d5e[_0x5510bd(0x267)]()[_0x5510bd(0x291)]()[_0x5510bd(0x173)](0x2,'0')+':'+_0x415d5e['getSeconds']()['toString']()[_0x5510bd(0x173)](0x2,'0');}function getTimeStamp(){const _0x161ca4=_0x168baa,_0x10196f=shiftedTime();return _0x10196f['getFullYear']()+'/'+(_0x10196f[_0x161ca4(0x15a)]()+0x1)['toString']()[_0x161ca4(0x173)](0x2,'0')+'/'+_0x10196f['getDate']()[_0x161ca4(0x291)]()[_0x161ca4(0x173)](0x2,'0')+'\x20'+_0x10196f[_0x161ca4(0x15d)]()[_0x161ca4(0x291)]()[_0x161ca4(0x173)](0x2,'0')+':'+_0x10196f[_0x161ca4(0x267)]()[_0x161ca4(0x291)]()[_0x161ca4(0x173)](0x2,'0')+':'+_0x10196f['getSeconds']()[_0x161ca4(0x291)]()[_0x161ca4(0x173)](0x2,'0');}function getCleanTimeStamp(){const _0x2a1495=_0x168baa,_0x2ba834=shiftedTime();return _0x2ba834[_0x2a1495(0x1b7)]()+(_0x2ba834[_0x2a1495(0x15a)]()+0x1)['toString']()[_0x2a1495(0x173)](0x2,'0')+_0x2ba834[_0x2a1495(0x18c)]()[_0x2a1495(0x291)]()[_0x2a1495(0x173)](0x2,'0')+'-'+_0x2ba834[_0x2a1495(0x15d)]()['toString']()[_0x2a1495(0x173)](0x2,'0')+_0x2ba834[_0x2a1495(0x267)]()[_0x2a1495(0x291)]()[_0x2a1495(0x173)](0x2,'0')+_0x2ba834[_0x2a1495(0x283)]()[_0x2a1495(0x291)]()[_0x2a1495(0x173)](0x2,'0');}function shiftedTime(){const _0x487322=_0x168baa,_0xfe23be=new Date();let _0x1610dd=_0xfe23be;if(settings[_0x487322(0x2b6)]&&settings[_0x487322(0x2b6)]!==0x0)_0x1610dd=fns[_0x487322(0x200)](_0xfe23be,{'hours':settings['timeshift']});return _0x1610dd;}function startScheduler(){const _0x8cac74=_0x168baa,_0x2ee544=new Date()[_0x8cac74(0x166)](),_0x23ebdc=shiftedTime()[_0x8cac74(0x15d)]();_0x23ebdc==0x4&&backupConfigFiles();_0x23ebdc==0x0&&rotateLogFiles();_0x2ee544%0x6==0x0&&triggerAnalytics();_0x2ee544%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x2ddd7a){const _0x1d09f8=_0x168baa;logger[_0x1d09f8(0x292)](_0x1d09f8(0x2c9)+_0x2ddd7a);const _0x329143=getBotsWithMode();_0x329143[_0x1d09f8(0x180)]>0x0?confirmRestore(configbackuppath,_0x2ddd7a):unzipFile(configbackuppath,_0x2ddd7a);}async function getBackupFiles(_0x9cbaea=null){const _0x38e006=_0x168baa;let _0x36b145=[],_0x19945e=fs[_0x38e006(0x17d)](configbackuppath,{'withFileTypes':!![]});_0x19945e['sort']((_0x56a203,_0x2c2479)=>_0x56a203[_0x38e006(0x2d0)]<_0x2c2479[_0x38e006(0x2d0)]?0x1:_0x2c2479[_0x38e006(0x2d0)]<_0x56a203[_0x38e006(0x2d0)]?-0x1:0x0),_0x19945e[_0x38e006(0x13f)](_0x11fbf7=>{const _0x5c24de=_0x38e006;if(!_0x11fbf7[_0x5c24de(0x254)]()&&_0x11fbf7[_0x5c24de(0x2d0)][_0x5c24de(0x1b9)](_0x5c24de(0x21f))&&_0x11fbf7['name'][_0x5c24de(0x122)](_0x5c24de(0x22a))){const _0x32a896=formatDate(fs[_0x5c24de(0x19b)](configbackuppath+_0x11fbf7[_0x5c24de(0x2d0)])['mtime']);_0x36b145[_0x5c24de(0x124)]({'name':_0x11fbf7[_0x5c24de(0x2d0)],'mtime':_0x32a896});}});if(_0x9cbaea)io['to'](_0x9cbaea)[_0x38e006(0x297)](_0x38e006(0x226),_0x36b145);else return _0x36b145;}async function backupConfigFiles(){const _0x3c9360=_0x168baa;await zipFiles(_0x3c9360(0x1fb));const _0x58fd6f=getCleanTimeStamp();fs[_0x3c9360(0x176)](zippath+_0x3c9360(0x277),configbackuppath+(_0x3c9360(0x21f)+_0x58fd6f+_0x3c9360(0x22a)));let _0x4f91e3=fs[_0x3c9360(0x17d)](configbackuppath,{'withFileTypes':!![]});_0x4f91e3[_0x3c9360(0x230)]((_0x35b959,_0x1f5764)=>_0x35b959[_0x3c9360(0x2d0)]<_0x1f5764[_0x3c9360(0x2d0)]?0x1:_0x1f5764[_0x3c9360(0x2d0)]<_0x35b959[_0x3c9360(0x2d0)]?-0x1:0x0),_0x4f91e3['length']>maxBackups&&fs['unlinkSync'](configbackuppath+_0x4f91e3[maxBackups][_0x3c9360(0x2d0)]);}function rotateLogFiles(){const _0x1c635b=_0x168baa,_0xc92c82=fs[_0x1c635b(0x19b)](logspath+_0x1c635b(0x1d9)),_0x483822=_0xc92c82['size']/0x400;if(_0x483822>0x64){let _0x37a140=fs[_0x1c635b(0x17d)](logspath,{'withFileTypes':!![]});_0x37a140[_0x1c635b(0x230)]((_0x5f8bbb,_0x29e9b6)=>_0x5f8bbb[_0x1c635b(0x2d0)]<_0x29e9b6['name']?0x1:_0x29e9b6[_0x1c635b(0x2d0)]<_0x5f8bbb[_0x1c635b(0x2d0)]?-0x1:0x0),_0x37a140[_0x1c635b(0x13f)](_0x540ec1=>{const _0x2b737b=_0x1c635b;if(_0x540ec1[_0x2b737b(0x2d0)]==_0x2b737b(0x2bf))fs[_0x2b737b(0x176)](logspath+_0x540ec1[_0x2b737b(0x2d0)],logspath+_0x2b737b(0x1d2));if(_0x540ec1['name']==_0x2b737b(0x260))fs[_0x2b737b(0x176)](logspath+_0x540ec1['name'],logspath+_0x2b737b(0x2bf));_0x540ec1[_0x2b737b(0x2d0)]==_0x2b737b(0x1d9)&&(fs[_0x2b737b(0x176)](logspath+_0x540ec1[_0x2b737b(0x2d0)],logspath+_0x2b737b(0x260)),fs['writeFileSync'](logspath+_0x540ec1['name'],''));});}}async function zipFiles(_0x21edb0){const _0x283e24=_0x168baa;let _0x3d096f;if(_0x21edb0=='logs')_0x3d096f=logspath;if(_0x21edb0==_0x283e24(0x154))_0x3d096f=configpath;if(_0x21edb0==_0x283e24(0x1fb))_0x3d096f=configpath;let _0x3726c5=fs[_0x283e24(0x17d)](_0x3d096f,{'withFileTypes':!![]});const _0x32aca9=new require(_0x283e24(0x125))();_0x3726c5[_0x283e24(0x13f)](_0x5dad92=>{const _0x59d761=_0x283e24;if(!_0x5dad92[_0x59d761(0x254)]()){let _0x5b5429=fs['readFileSync'](_0x3d096f+_0x5dad92[_0x59d761(0x2d0)]);if(_0x21edb0=='backup'){const _0xc81d07=/^bot-[0-9]{3}-config.json$/,_0x57dd32=_0xc81d07['test'](_0x5dad92[_0x59d761(0x2d0)]);if(_0x57dd32){const _0x1e6023=JSON[_0x59d761(0x1a8)](_0x5b5429);_0x1e6023['bot'][0x0]&&(_0x1e6023['bot'][0x0][_0x59d761(0x1db)]=_0x59d761(0x1a2),_0x1e6023[_0x59d761(0x2de)][0x0][_0x59d761(0x141)]='***'),_0x5b5429=JSON[_0x59d761(0x1ba)](_0x1e6023,null,0x2);}if(_0x5dad92[_0x59d761(0x2d0)]==_0x59d761(0x172)){const _0xf6e241=JSON[_0x59d761(0x1a8)](_0x5b5429);if(_0xf6e241[_0x59d761(0x1aa)][_0x59d761(0x13e)])_0xf6e241[_0x59d761(0x1aa)][_0x59d761(0x13e)]=![];if(_0xf6e241[_0x59d761(0x1aa)][_0x59d761(0x219)])_0xf6e241[_0x59d761(0x1aa)][_0x59d761(0x219)]='***';if(_0xf6e241[_0x59d761(0x1aa)][_0x59d761(0x1b5)])_0xf6e241['settings'][_0x59d761(0x1b5)]=_0x59d761(0x1a2);if(_0xf6e241[_0x59d761(0x1aa)][_0x59d761(0x1dd)])_0xf6e241['settings'][_0x59d761(0x1dd)]=null;_0x5b5429=JSON['stringify'](_0xf6e241,null,0x2);}if(_0x5dad92['name']!=_0x59d761(0x12c))_0x32aca9[_0x59d761(0x23d)](_0x5dad92['name'],_0x5b5429);}else _0x32aca9[_0x59d761(0x23d)](_0x5dad92[_0x59d761(0x2d0)],_0x5b5429);}});const _0x1dfb45=_0x32aca9[_0x283e24(0x20e)]({'base64':![],'compression':'DEFLATE'});fs['writeFileSync'](zippath+(_0x21edb0+'.zip'),_0x1dfb45,'binary');}async function unzipFile(_0x19274f,_0x310028){const _0x4e7ce3=_0x168baa;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x4e7ce3(0x13f)](_0x2b2582=>{const _0x32f709=_0x4e7ce3;if(!_0x2b2582['isDirectory']())fs[_0x32f709(0x194)](configpath+_0x2b2582[_0x32f709(0x2d0)]);});const _0x4259e5=fs[_0x4e7ce3(0x16a)](_0x19274f+_0x310028,_0x4e7ce3(0x257)),_0x59f388=new require(_0x4e7ce3(0x125))(_0x4259e5,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x59f388[_0x4e7ce3(0x1c6)])[_0x4e7ce3(0x13f)](_0x48a83b=>{const _0x2fa4b0=_0x4e7ce3,_0x2a1a16=_0x59f388[_0x2fa4b0(0x1c6)][_0x48a83b];fs['writeFileSync'](configpath+_0x2a1a16[_0x2fa4b0(0x2d0)],_0x2a1a16[_0x2fa4b0(0x1e9)]);}),fs[_0x4e7ce3(0x17d)](temppath,{'withFileTypes':!![]})[_0x4e7ce3(0x13f)](_0x26fa9f=>{const _0x121554=_0x4e7ce3;if(!_0x26fa9f[_0x121554(0x254)]())fs[_0x121554(0x194)](temppath+_0x26fa9f[_0x121554(0x2d0)]);}),logger[_0x4e7ce3(0x292)](_0x4e7ce3(0x213)),process[_0x4e7ce3(0x23b)]({'restore':!![]},_0xf7f929=>{});}async function getPublicIp(){const _0x1b157c=_0x168baa;try{const _0x37953f=await axios[_0x1b157c(0x2d9)](_0x1b157c(0x296));publicip=_0x37953f['data']['ip'];}catch(_0x55e357){}}async function triggerAnalytics(){const _0x2f74d9=_0x168baa;if(!publicip)await getPublicIp();const _0x30b4b3=getBotsWithMode();let _0x30b1ac=0x0;_0x30b4b3[_0x2f74d9(0x13f)](_0xb6a23e=>{const _0x43a0c9=_0x2f74d9;if(_0xb6a23e[_0x43a0c9(0x12a)]===_0x43a0c9(0x1ad))_0x30b1ac++;});const _0x3427ad=getBotExchanges();mixpanel[_0x2f74d9(0x183)]('Server',{'distinct_id':settings[_0x2f74d9(0x193)],'ip':publicip,'version':serverversion,'numbots':_0x30b4b3['length'],'numbotsenabled':_0x30b1ac,'exchanges':_0x3427ad});}async function getMessages(){const _0x16dd9b=_0x168baa,_0x4b0bb9=_0x16dd9b(0x1c1),_0xe98490=new GraphQLClient(_0x4b0bb9),_0x108abe={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x32925b=serverversion[_0x16dd9b(0x170)]('.'),_0x143365=_0x32925b[0x0]+'.'+_0x32925b[0x1],_0x490e3d=Math[_0x16dd9b(0x250)](settings['lastmsgtelegram'],settings['lastmsgemitted']),_0x435942={'last':parseInt(_0x490e3d),'bbm':_0x143365},_0x3ee4e0=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x34b7c4;try{_0x34b7c4=await _0xe98490['request'](_0x3ee4e0,_0x435942,_0x108abe);}catch(_0x50f1cc){}if(_0x34b7c4&&_0x34b7c4[_0x16dd9b(0x1f3)]){let _0x434f6b=settings[_0x16dd9b(0x1ce)];newMessages=[];for(const _0x5e7313 of _0x34b7c4[_0x16dd9b(0x1f3)]){newMessages[_0x16dd9b(0x124)](_0x5e7313);if(_0x5e7313[_0x16dd9b(0x157)])updateSetting(_0x16dd9b(0x198),_0x5e7313[_0x16dd9b(0x157)]);let _0x694b6c=_0x5e7313[_0x16dd9b(0x157)]?serverversion>=_0x5e7313[_0x16dd9b(0x157)]:![];if(!_0x694b6c&&_0x5e7313[_0x16dd9b(0x132)]>_0x434f6b){if(_0x5e7313[_0x16dd9b(0x1d1)]===_0x16dd9b(0x1a5)||serverversion[_0x16dd9b(0x1b9)](_0x5e7313['bbvReceive'])){let _0x385e53=''+_0x5e7313['title']+'\x0a\x0a'+_0x5e7313[_0x16dd9b(0x17c)];const _0x57ef19=await sendTelegramMsg(toTelegramMarkdown(_0x385e53),_0x16dd9b(0x26d));if(_0x57ef19)_0x434f6b=_0x5e7313[_0x16dd9b(0x132)];}}}updateAvailable=isNewerVersion(settings[_0x16dd9b(0x198)],serverversion),updateSetting(_0x16dd9b(0x1ce),_0x434f6b),emitMessages();}}function emitMessages(){const _0x496141=_0x168baa,_0x2ee855=settings['lastmsgemitted'];let _0x421bdf=[];newMessages[_0x496141(0x13f)](_0x3bf7ff=>{const _0x3f4c76=_0x496141;_0x3bf7ff[_0x3f4c76(0x132)]>_0x2ee855&&_0x421bdf[_0x3f4c76(0x124)](_0x3bf7ff);}),_0x421bdf['length']>0x0&&getAllClients()[_0x496141(0x13f)](_0x236142=>{const _0x12dddc=_0x496141;getSocket(_0x236142['id'])[_0x12dddc(0x297)](_0x12dddc(0x17c),_0x421bdf);});}function confirmMessage(_0x404936){const _0x30600e=_0x168baa;updateSetting(_0x30600e(0x192),Number(_0x404936));}function isNewerVersion(_0x3b1d4f,_0x1be29c){const _0x5db958=_0x168baa,_0x38ba4a=_0x1be29c[_0x5db958(0x170)]('.'),_0x292612=_0x3b1d4f['split']('.');for(var _0x31f38b=0x0;_0x31f38b<_0x292612['length'];_0x31f38b++){const _0x30bb13=~~_0x292612[_0x31f38b],_0x2c4948=~~_0x38ba4a[_0x31f38b];if(_0x30bb13>_0x2c4948)return!![];if(_0x30bb13<_0x2c4948)return![];}return![];}function toTelegramMarkdown(_0x3e2db0){const _0x53530d=_0x168baa,_0x9a6559=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x524327=/\*{2}(.+?)\*{2}/gim;return _0x3e2db0=_0x3e2db0['replace'](_0x9a6559,'$1_$2_$3')['replace'](_0x524327,_0x53530d(0x1bc)),_0x3e2db0;}async function validateConfigFile(){const _0x415680=_0x168baa,_0x37b30f=dbConfig['get'](_0x415680(0x158))['sortBy'](_0x415680(0x2ae))[_0x415680(0x2e4)]()||[];if(_0x37b30f[_0x415680(0x180)]==0x0){let _0x976102=0x0,_0x3d9739=[];const _0x32be52=/^bot-([0-9]{3})-config.json$/,_0x45a2fd=fs[_0x415680(0x17d)](configpath);_0x45a2fd[_0x415680(0x13f)](_0x14df14=>{const _0xadd2da=_0x415680,_0x37b5cc=_0x32be52[_0xadd2da(0x2a8)](_0x14df14);if(_0x37b5cc){const _0x282a5a=_0x37b5cc[0x1];let _0x2c9c15=getBotAttributes(_0x282a5a);_0x3d9739['push']({'botID':_0x282a5a,'botname':_0x2c9c15[_0xadd2da(0x1b8)],'status':'disabled','live':_0xadd2da(0x26c)}),_0x976102++;}}),_0x976102!=0x0&&(dbConfig[_0x415680(0x2d9)]('bots')[_0x415680(0x178)](_0x3d9739)[_0x415680(0x1eb)](),config=_0x3d9739,restoredConfigFile=_0x976102);}}async function restoreConfigNotify(_0x504d1e){const _0x24bcb6=_0x168baa;let _0x588810;if(restoredConfigFile==0x1)_0x588810=_0x24bcb6(0x1f4);else _0x588810=_0x24bcb6(0x27e);if(_0x504d1e)io['to'](_0x24bcb6(0x14d))[_0x24bcb6(0x297)](_0x24bcb6(0x16e),_0x588810);else{logger[_0x24bcb6(0x2e8)](_0x24bcb6(0x1bd)),logger[_0x24bcb6(0x2e8)](_0x588810),logger[_0x24bcb6(0x2e8)](_0x24bcb6(0x1bd)),logger[_0x24bcb6(0x2e8)]('');if(tgBot&&settings[_0x24bcb6(0x1dd)]&&settings[_0x24bcb6(0x287)]!=_0x24bcb6(0x2e7))tgBot[_0x24bcb6(0x2d3)](settings[_0x24bcb6(0x1dd)],_0x24bcb6(0x264)+_0x588810)[_0x24bcb6(0x2e2)](_0x22447e=>{telegramError(_0x22447e);});}}function validateCredentials(_0x178e5d,_0xd9e9c2){const _0x28a284=_0x168baa;if(_0x178e5d['username']==settings[_0x28a284(0x222)]&&bcrypt[_0x28a284(0x15f)](_0x178e5d[_0x28a284(0x1ee)],settings[_0x28a284(0x219)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x28a284(0x25e),'token':null};else{const _0xe8fc98=generateLoginToken(_0xd9e9c2);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0xe8fc98};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x46488a){const _0x107961=_0x168baa,_0x5eb5aa=generateLoginToken(_0x46488a);return{'allow':!![],'reason':_0x107961(0x1b6),'token':_0x5eb5aa};}function validateAccess(_0xbed867,_0x4f9382,_0x34aeae){const _0x2c0491=_0x168baa,_0xa14678=_0x34aeae?_0x34aeae:devices[_0x4f9382]['ip'];let _0x58b96f;const _0x284733=_0x5750c9=>{const _0x4fca65=_0x167f;if(settings[_0x4fca65(0x13e)]){if(settings[_0x4fca65(0x1e1)]){if(telegram2FaApproved(_0x4f9382)){const _0x151a28=generateLoginToken(_0x4f9382);return{'allow':!![],'reason':_0x4fca65(0x223),'token':_0x151a28};}else return{'allow':![],'reason':_0x4fca65(0x2a2),'token':null};}else return _0x58b96f=validToken(_0x5750c9,_0x4f9382),_0x58b96f[_0x4fca65(0x1c9)]('success')?{'allow':!![],'reason':_0x4fca65(0x246),'token':_0x5750c9}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x2c0491(0x2b8)]){let _0x2b0aaf=[...settings['whitelist'],'::1',_0x2c0491(0x1ef),_0x2c0491(0x1c2)];if(_0x2b0aaf['includes'](_0xa14678))return _0x284733(_0xbed867);else{_0x58b96f=validToken(_0xbed867,_0x4f9382);if(_0x58b96f[_0x2c0491(0x1c9)]('success'))return _0x284733(_0xbed867);else{if(telegramIpApproved(_0x4f9382)){const _0x4cb94c=generateToken(_0x4f9382);return _0x58b96f=_0x284733(_0xbed867),_0x58b96f[_0x2c0491(0x143)]?{'allow':!![],'reason':_0x2c0491(0x14e),'token':_0x4cb94c}:_0x58b96f;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x2c0491(0x1bf),'token':null}:{'allow':![],'reason':_0x2c0491(0x293),'token':null};}}}else return _0x284733(_0xbed867);}function timelyDecrypt(_0x2d49c9,_0x3bb3d7=!![]){const _0x9b59ee=_0x168baa;if(_0x2d49c9)try{const _0x11dc92=crypt['decrypt'](secure[_0x9b59ee(0x24b)],_0x2d49c9)[_0x9b59ee(0x17c)],_0x2eea21=_0x11dc92['split']('@')[0x0],_0x193777=_0x11dc92[_0x9b59ee(0x170)]('@')[0x1],_0x1da816=new Date()[_0x9b59ee(0x1da)]();if(_0x3bb3d7){if(_0x1da816-_0x193777<maxSecretAge*0x3e8)return _0x2eea21;else return![];}else return _0x2eea21;}catch(_0x537f40){return![];}else return![];}const validToken=(_0x53fd5f,_0x55337c)=>{const _0xfd986b=_0x168baa,_0x17235c=devices[_0x55337c]['ip'];if(!_0x53fd5f)return{'error':_0xfd986b(0x1f8)};for(let _0x810718 of blacklist){if(_0x810718['token']==_0x53fd5f)return{'error':'Token\x20blacklisted'};}let _0xac6ed5;try{_0xac6ed5=jwt[_0xfd986b(0x187)](_0x53fd5f,secure[_0xfd986b(0x216)]+_0x55337c);}catch{return{'error':_0xfd986b(0x1ff)};}if(!_0xac6ed5[_0xfd986b(0x1c9)](_0xfd986b(0x255))&&!_0xac6ed5['hasOwnProperty']('username')||!_0xac6ed5['hasOwnProperty'](_0xfd986b(0x1a3)))return{'error':_0xfd986b(0x1d3)};if(!_0xac6ed5[_0xfd986b(0x1c9)](_0xfd986b(0x2eb))&&_0xac6ed5[_0xfd986b(0x1c9)]('clientip')){const {clientip:_0x47435e}=_0xac6ed5;return _0x17235c==_0x47435e?{'success':_0xfd986b(0x2ad)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0xac6ed5[_0xfd986b(0x1c9)](_0xfd986b(0x2eb))&&_0xac6ed5[_0xfd986b(0x1c9)](_0xfd986b(0x255))){const {username:_0x56545c,clientip:_0x75ad2e}=_0xac6ed5;return settings['bbUsername']==_0x56545c&&_0x17235c==_0x75ad2e?{'success':'User\x20has\x20been\x20validated'}:{'error':_0xfd986b(0x182)};}}},generateLoginToken=_0x38cf99=>{const _0x5a8b22=_0x168baa;if(_0x38cf99){const _0x25d5d5=devices[_0x38cf99]['ip'];return jwt['sign']({'username':settings[_0x5a8b22(0x222)],'clientip':_0x25d5d5},secure['secret']+_0x38cf99,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x281042=>{const _0x402362=_0x168baa;if(_0x281042){const _0x20b2a5=devices[_0x281042]['ip'];return jwt[_0x402362(0x1c8)]({'clientip':_0x20b2a5},secure[_0x402362(0x216)]+_0x281042,{'expiresIn':devices[_0x281042][_0x402362(0x19d)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x49996e=>{const _0xb1afae=_0x168baa;let _0x717d9e=![];return devices[_0x49996e][_0xb1afae(0x19d)]&&devices[_0x49996e]['telegramIpApproval'][_0xb1afae(0x238)]!=_0xb1afae(0x2a4)&&(_0x717d9e=devices[_0x49996e][_0xb1afae(0x19d)][_0xb1afae(0x255)]==devices[_0x49996e]['ip']&&new Date()[_0xb1afae(0x1da)]()-devices[_0x49996e]['telegramIpApproval'][_0xb1afae(0x174)]<devices[_0x49996e][_0xb1afae(0x19d)][_0xb1afae(0x238)]*0x3c*0x3e8),_0x717d9e;},telegram2FaApproved=_0x325d3b=>{const _0x54cd19=_0x168baa;let _0x524fa2=![];return devices[_0x325d3b]['telegram2FaApproval']&&devices[_0x325d3b][_0x54cd19(0x1be)][_0x54cd19(0x238)]!='reject'&&(_0x524fa2=devices[_0x325d3b]['telegram2FaApproval'][_0x54cd19(0x255)]==devices[_0x325d3b]['ip']&&new Date()[_0x54cd19(0x1da)]()-devices[_0x325d3b][_0x54cd19(0x1be)][_0x54cd19(0x174)]<devices[_0x325d3b][_0x54cd19(0x1be)][_0x54cd19(0x238)]*0x3c*0x3e8),_0x524fa2;},normalizeIP=_0x3951fa=>{const _0x161c62=_0x168baa;let _0x9d33be=null,_0x56d711=null;if(ipaddr['isValid'](_0x3951fa)){const _0x9a4261=ipaddr['parse'](_0x3951fa);_0x9a4261[_0x161c62(0x134)]()==='ipv6'?(_0x9a4261[_0x161c62(0x184)]()&&(_0x9d33be=_0x9a4261[_0x161c62(0x13c)]()[_0x161c62(0x291)]()),_0x56d711=_0x9a4261['toString']()):(_0x9d33be=_0x9a4261['toString'](),_0x56d711=_0x9a4261[_0x161c62(0x21d)]()['toString']());}return{'show':_0x9d33be?_0x9d33be:_0x56d711,'store':_0x56d711};};function formatDate(_0x3bc27a){const _0x258c68=_0x168baa;return _0x3bc27a['getFullYear']()+'/'+(_0x3bc27a['getMonth']()+0x1)['toString']()[_0x258c68(0x173)](0x2,'0')+'/'+_0x3bc27a[_0x258c68(0x18c)]()[_0x258c68(0x291)]()[_0x258c68(0x173)](0x2,'0')+'\x20'+_0x3bc27a[_0x258c68(0x15d)]()[_0x258c68(0x291)]()[_0x258c68(0x173)](0x2,'0')+':'+_0x3bc27a['getMinutes']()[_0x258c68(0x291)]()[_0x258c68(0x173)](0x2,'0')+':'+_0x3bc27a[_0x258c68(0x283)]()[_0x258c68(0x291)]()[_0x258c68(0x173)](0x2,'0');}function sleep(_0x142df0){return new Promise(_0x392d8b=>setTimeout(_0x392d8b,_0x142df0));}