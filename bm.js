const _0x231898=_0x1d28;(function(_0xbef5ac,_0x6a1df9){const _0x10233f=_0x1d28,_0x92815c=_0xbef5ac();while(!![]){try{const _0x167cf4=-parseInt(_0x10233f(0x148))/0x1*(-parseInt(_0x10233f(0xed))/0x2)+parseInt(_0x10233f(0x13e))/0x3*(-parseInt(_0x10233f(0x20e))/0x4)+parseInt(_0x10233f(0x1a8))/0x5+parseInt(_0x10233f(0x1a0))/0x6+-parseInt(_0x10233f(0xde))/0x7*(-parseInt(_0x10233f(0x127))/0x8)+parseInt(_0x10233f(0x12f))/0x9+-parseInt(_0x10233f(0x1c3))/0xa;if(_0x167cf4===_0x6a1df9)break;else _0x92815c['push'](_0x92815c['shift']());}catch(_0x148396){_0x92815c['push'](_0x92815c['shift']());}}}(_0x25f6,0x75a7c));const _0x1c01fa=function(){let _0x451390=!![];return function(_0x50af97,_0x312555){const _0x4cea5b=_0x451390?function(){const _0x25109f=_0x1d28;if(_0x312555){const _0xc8648d=_0x312555[_0x25109f(0x18e)](_0x50af97,arguments);return _0x312555=null,_0xc8648d;}}:function(){};return _0x451390=![],_0x4cea5b;};}(),_0x3ce972=_0x1c01fa(this,function(){const _0x17a4da=_0x1d28;return _0x3ce972[_0x17a4da(0x1c2)]()[_0x17a4da(0x113)]('(((.+)+)+)+$')[_0x17a4da(0x1c2)]()[_0x17a4da(0xfb)](_0x3ce972)['search'](_0x17a4da(0x1a5));});_0x3ce972();'use strict';process['env'][_0x231898(0x17b)]=0x1;const childProcess=require(_0x231898(0x192)),FileSync=require('lowdb/adapters/FileSync'),fs=require('fs'),fns=require(_0x231898(0x14c)),low=require(_0x231898(0x1c7)),path=require('path'),crypto=require('crypto'),Crypt=require(_0x231898(0x1ff))[_0x231898(0x159)],RSA=require(_0x231898(0x1ff))['RSA'],bcrypt=require(_0x231898(0x178)),jwt=require(_0x231898(0x154)),analyticsLib=require(_0x231898(0x188))[_0x231898(0x18d)],googleAnalytics=require(_0x231898(0x14b))[_0x231898(0x18d)],ipaddr=require(_0x231898(0x202)),argv=require('yargs/yargs')(process[_0x231898(0x212)][_0x231898(0x17d)](0x2))['argv'],PORT=argv[_0x231898(0x125)]||_0x231898(0x14f),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x231898(0x16b)](PORT))return console[_0x231898(0x155)](_0x231898(0x205)+PORT+_0x231898(0x182)),process[_0x231898(0x158)](0x1);const HOST=argv[_0x231898(0x1a9)]||null,userID=argv[_0x231898(0x1fa)]||'';let bbpath=_0x231898(0x1e7),bbpath2='';const botfile=_0x231898(0xe6),configfile=_0x231898(0x1ba),settingsfile='bb-settings.json',securefile=_0x231898(0xf9);!fs[_0x231898(0x13b)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x231898(0x19a)),configpath=userID?bbpath+_0x231898(0x1fd)+userID+'/':bbpath+_0x231898(0x1fd),configbackuppath=configpath+'backup/';!fs[_0x231898(0x13b)](configpath)&&fs[_0x231898(0x15d)](configpath);!fs[_0x231898(0x13b)](configbackuppath)&&fs[_0x231898(0x15d)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x231898(0x173)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x231898(0x173)]({'settings':{'timeshift':0x0}})[_0x231898(0x1bc)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x231898(0x1bc)]();let crypt=new Crypt({'md':_0x231898(0x116),'rsaStandard':_0x231898(0xf1)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x231898(0x167))[_0x231898(0xe5)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;function _0x1d28(_0x3f121e,_0x5d4037){const _0x1f0f4c=_0x25f6();return _0x1d28=function(_0x3ce972,_0x1c01fa){_0x3ce972=_0x3ce972-0xcc;let _0x25f66c=_0x1f0f4c[_0x3ce972];return _0x25f66c;},_0x1d28(_0x3f121e,_0x5d4037);}let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require(_0x231898(0x1f8)),app=express(),http=require(_0x231898(0xfc))[_0x231898(0x1d5)](app);app[_0x231898(0x1a1)](express['static'](path[_0x231898(0x10a)](__dirname,bbpath2,_0x231898(0xce)))),app[_0x231898(0x1a1)](express['static'](path[_0x231898(0x10a)](__dirname,bbpath2,_0x231898(0x196)))),app[_0x231898(0x19b)]('/',function(_0x14f430,_0x1fddfd){const _0x59d1d6=_0x231898;_0x1fddfd[_0x59d1d6(0x104)](path[_0x59d1d6(0x10a)](__dirname,bbpath2,_0x59d1d6(0xce),_0x59d1d6(0x1b6)));}),app[_0x231898(0x19b)]('/:bot',function(_0x2ebeb1,_0xe68ce4){const _0x485222=_0x231898;_0xe68ce4[_0x485222(0x104)](path['join'](__dirname,bbpath2,_0x485222(0x196),_0x485222(0x1b6)));}),app[_0x231898(0x19b)]('/:bot/portfolio',(_0x25c508,_0x3af245)=>{const _0x1da8e3=_0x231898;_0x3af245[_0x1da8e3(0x104)](path[_0x1da8e3(0x10a)](__dirname,bbpath2,_0x1da8e3(0x196),_0x1da8e3(0x1b6)));}),app[_0x231898(0x19b)](_0x231898(0x14a),(_0x2ee766,_0x35863d)=>{const _0x51f236=_0x231898;_0x35863d['sendFile'](path[_0x51f236(0x10a)](__dirname,bbpath2,_0x51f236(0x196),_0x51f236(0x1b6)));}),app['get'](_0x231898(0x18c),(_0x3d7b87,_0x1276f8)=>{const _0x1d5208=_0x231898;_0x1276f8[_0x1d5208(0x104)](path[_0x1d5208(0x10a)](__dirname,bbpath2,_0x1d5208(0x196),_0x1d5208(0x1b6)));}),app[_0x231898(0x19b)](_0x231898(0x191),(_0x1707bd,_0x372f96)=>{const _0x24b8c2=_0x231898;_0x372f96[_0x24b8c2(0x104)](path['join'](__dirname,bbpath2,_0x24b8c2(0x196),'index.html'));}),app['get']('/:bot/configuration',(_0x1674bb,_0x2c9341)=>{const _0x5caf02=_0x231898;_0x2c9341[_0x5caf02(0x104)](path[_0x5caf02(0x10a)](__dirname,bbpath2,_0x5caf02(0x196),'index.html'));}),app[_0x231898(0x19b)]('/:bot/support',(_0x5c0f9f,_0x2706dd)=>{const _0xe572a9=_0x231898;_0x2706dd[_0xe572a9(0x104)](path['join'](__dirname,bbpath2,_0xe572a9(0x196),_0xe572a9(0x1b6)));});if(HOST)http[_0x231898(0xfa)](PORT,HOST);else http[_0x231898(0xfa)](PORT);const io=require(_0x231898(0x177))(http,{}),analytics=analyticsLib({'app':_0x231898(0x145),'plugins':[googleAnalytics({'trackingId':_0x231898(0x129)})]}),TelegramBot=require(_0x231898(0xdb));let tgBot;if(settings['telegramToken']&&settings[_0x231898(0x1c9)]!=''&&settings[_0x231898(0x1b7)]&&settings[_0x231898(0x1b7)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x59cfaf=_0x231898;console[_0x59cfaf(0x155)](''),console[_0x59cfaf(0x155)](_0x59cfaf(0x10b)),logging(_0x59cfaf(0x207)+PORT),console[_0x59cfaf(0x155)]('-----------------------------------------------------------------------------------');if(config[_0x59cfaf(0x1f5)]!=0x0)config[_0x59cfaf(0x1f9)](_0x5b7316=>{const _0x31e2cf=_0x59cfaf;if(_0x5b7316['status']==_0x31e2cf(0x152)||_0x5b7316[_0x31e2cf(0x110)]==_0x31e2cf(0x210))logging(_0x31e2cf(0x1fc)+_0x5b7316[_0x31e2cf(0x19d)]+_0x31e2cf(0x136)+_0x5b7316[_0x31e2cf(0x16e)]),startBot([_0x5b7316['botID'],userID],{'cwd':bbpath},function(_0x1200a8){if(_0x1200a8)logging(_0x1200a8);});else(_0x5b7316['status']==_0x31e2cf(0x1ac)||_0x5b7316['status']==_0x31e2cf(0x1a6))&&logging(_0x31e2cf(0x12d)+_0x5b7316[_0x31e2cf(0x19d)]+_0x31e2cf(0x136)+_0x5b7316[_0x31e2cf(0x16e)]);});else!newBot&&console[_0x59cfaf(0x155)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();console['log'](_0x59cfaf(0x10b)),console[_0x59cfaf(0x155)]('');}function startSocket(){const _0x3074d3=_0x231898;io['on'](_0x3074d3(0xd8),_0x5d0031=>{const _0x48e8f0=_0x3074d3;let _0xd1c52,_0x52fc2f,_0xf0481b,_0x160ad0,_0x1f62b3;const _0x171d1e=_0x5d0031[_0x48e8f0(0x20d)]['headers']['referer'];_0x52fc2f=_0x171d1e[_0x48e8f0(0x163)](/bot[0-9]{3}/);if(_0x52fc2f)_0xf0481b=_0x52fc2f[0x0][_0x48e8f0(0x163)](/[0-9]{3}/);if(_0xf0481b)_0xd1c52=_0xf0481b[0x0];else _0xd1c52=_0x48e8f0(0x19e);const _0x4962df=_0x5d0031[_0x48e8f0(0x20d)][_0x48e8f0(0x176)][_0x48e8f0(0x11b)];if(!_0x4962df)_0x5d0031[_0x48e8f0(0x17f)]('status',{'publicKey':secure[_0x48e8f0(0x10f)]});else{_0x160ad0=timelyDecrypt(_0x4962df,![]);if(!_0x160ad0)_0x5d0031[_0x48e8f0(0x17f)](_0x48e8f0(0x110),{'publicKey':secure[_0x48e8f0(0x10f)]});else{_0x1f62b3=normalizeIP(_0x5d0031[_0x48e8f0(0xd0)]['remoteAddress'])[_0x48e8f0(0x1eb)];if(!devices[_0x160ad0])devices[_0x160ad0]={'uuid':_0x160ad0,'access':{'token':null}};devices[_0x160ad0]['ip']=_0x1f62b3;const _0x5d083d=addClient(_0x5d0031['id'],_0x160ad0,_0xd1c52);setAccess(_0x5d083d),_0x5d0031['on'](_0x48e8f0(0x1f7),_0xc5b35f=>{const _0x161977=_0x48e8f0,_0x5e621d=timelyDecrypt(_0xc5b35f[_0x161977(0x101)]);if(_0x5e621d){_0xc5b35f={'username':_0xc5b35f[_0x161977(0x172)],'password':_0x5e621d},devices[_0x160ad0]['access']=validateCredentials(_0xc5b35f,_0x160ad0);if(devices[_0x160ad0][_0x161977(0x1ea)]['allow']==![]&&devices[_0x160ad0][_0x161977(0x1ea)][_0x161977(0x119)]=='2FA\x20login\x20required')_0x5d0031[_0x161977(0x17f)](_0x161977(0x110),{'access':devices[_0x160ad0][_0x161977(0x1ea)]}),loginAccess2FA(_0x160ad0,_0x1f62b3);else{if(devices[_0x160ad0][_0x161977(0x1ea)][_0x161977(0x175)]==![]&&devices[_0x160ad0][_0x161977(0x1ea)]['reason']==_0x161977(0x181))_0x5d0031[_0x161977(0x17f)](_0x161977(0x110),{'access':devices[_0x160ad0]['access']});else devices[_0x160ad0]['access'][_0x161977(0x175)]&&devices[_0x160ad0][_0x161977(0x1ea)][_0x161977(0x119)]==_0x161977(0x142)&&(getClientsWithUuid(_0x160ad0)[_0x161977(0x1f9)](_0x47e766=>{setAccess(_0x47e766);}),setTokenRefresh(_0x160ad0),setSessionTimeout('login',_0x160ad0));}}else logging('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x5d0031['on'](_0x48e8f0(0xf7),()=>{resetPassword();}),_0x5d0031['on'](_0x48e8f0(0x146),_0x17d31a=>{removeClient(_0x5d0031['id']);});}}});}function initClient(_0xe4372d){const _0x3b597a=_0x231898;if(_0xe4372d!='botmanager'&&config[_0x3b597a(0x1bb)]!=''){if(pid[_0xe4372d])pid[_0xe4372d][_0x3b597a(0x1d6)]({'function':_0x3b597a(0x186),'args':null});}}function getSocket(_0x1329df){const _0x43e175=_0x231898;return io[_0x43e175(0x137)]['sockets']['get'](_0x1329df);}function setAccess(_0x35c741){const _0x1e2f47=_0x231898,_0x1ec617=getSocket(_0x35c741['id']),_0x275fc6=_0x35c741['uuid'],_0x364728=_0x35c741['bot'];devices[_0x275fc6][_0x1e2f47(0x1ea)]=validateAccess(devices[_0x275fc6][_0x1e2f47(0x1ea)][_0x1e2f47(0x1e9)],_0x275fc6),_0x1ec617[_0x1e2f47(0x10a)](_0x275fc6);if(devices[_0x275fc6][_0x1e2f47(0x1ea)][_0x1e2f47(0x175)]){_0x1ec617[_0x1e2f47(0x10a)](_0x364728);if(_0x364728==_0x1e2f47(0x19e))initializeSocketBotManager(_0x1ec617);else initializeSocketBot(_0x1ec617);initClient(_0x364728);}devices[_0x275fc6][_0x1e2f47(0x1ea)][_0x1e2f47(0x1e9)]&&devices[_0x275fc6][_0x1e2f47(0x1ea)][_0x1e2f47(0x119)]==_0x1e2f47(0x20b)&&setSessionTimeout(_0x1e2f47(0xcc),_0x275fc6),devices[_0x275fc6]['access'][_0x1e2f47(0x1e9)]&&devices[_0x275fc6]['access'][_0x1e2f47(0x119)]==_0x1e2f47(0x102)&&setSessionTimeout('login',_0x275fc6),_0x1ec617['emit']('status',{'status':_0x35c741[_0x1e2f47(0x139)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x275fc6][_0x1e2f47(0x1ea)],'externalip':devices[_0x275fc6]['ip'],'publicKey':secure[_0x1e2f47(0x10f)]}),devices[_0x275fc6][_0x1e2f47(0x1ea)][_0x1e2f47(0x175)]==![]&&devices[_0x275fc6][_0x1e2f47(0x1ea)][_0x1e2f47(0x119)]==_0x1e2f47(0x1b3)&&temporaryAccess2FA(_0x275fc6,devices[_0x275fc6]['ip']);}function setSessionTimeout(_0x49f26e,_0x263c03){const _0x54d935=_0x231898;let _0xcacd7b;if(_0x49f26e==_0x54d935(0x1f7))_0xcacd7b=loginExpiry*0x3c*0x3e8;else _0xcacd7b=devices[_0x263c03]['telegramIpApproval']['expiry']*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x263c03][_0x54d935(0x17a)][_0x54d935(0x118)]);if(devices[_0x263c03][_0x54d935(0x1fb)])clearTimeout(devices[_0x263c03]['pidExpireLogin']);devices[_0x263c03][_0x54d935(0x1fb)]=setTimeout(()=>{const _0x54492d=_0x54d935;if(devices[_0x263c03][_0x54492d(0x208)])clearTimeout(devices[_0x263c03]['pidRefreshToken']);removeSocketListeners(_0x263c03),addBlacklist(_0x263c03),devices[_0x263c03][_0x54492d(0x17a)]=null,devices[_0x263c03][_0x54492d(0x203)]=null,devices[_0x263c03][_0x54492d(0x1ea)]['token']=null,devices[_0x263c03][_0x54492d(0x1ea)]=validateAccess(devices[_0x263c03][_0x54492d(0x1ea)]['token'],_0x263c03),!(devices[_0x263c03][_0x54492d(0x1ea)][_0x54492d(0x175)]&&devices[_0x263c03][_0x54492d(0x1ea)][_0x54492d(0x119)]==_0x54492d(0x1bd))&&(_0x49f26e==_0x54492d(0x1f7)?io['to'](_0x263c03)['emit'](_0x54492d(0x110),{'access':{'allow':![],'reason':_0x54492d(0xd2),'token':null}}):io['to'](_0x263c03)[_0x54492d(0x17f)](_0x54492d(0x110),{'access':{'allow':![],'reason':_0x54492d(0x109),'token':null}})),devices[_0x263c03][_0x54492d(0x1ea)][_0x54492d(0x1e9)]=null;},_0xcacd7b);}function setTokenRefresh(_0x1a4326){const _0x4765ba=_0x231898;if(devices[_0x1a4326][_0x4765ba(0x208)])clearTimeout(devices[_0x1a4326]['pidRefreshToken']);devices[_0x1a4326]['pidRefreshToken']=setTimeout(()=>{const _0xa33380=_0x4765ba;getClientsWithUuid(_0x1a4326)[_0xa33380(0x1f5)]!=0x0?(devices[_0x1a4326][_0xa33380(0x1ea)]=refreshToken(_0x1a4326),io['to'](_0x1a4326)[_0xa33380(0x17f)](_0xa33380(0x110),{'status':_0xa33380(0x180),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x1a4326][_0xa33380(0x1ea)],'externalip':devices[_0x1a4326]['ip'],'publicKey':secure['publicKey']}),setTokenRefresh(_0x1a4326)):clearTimeout(devices[_0x1a4326][_0xa33380(0x208)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5c9088){const _0x1409f5=_0x231898,_0xe1883a=getClient(_0x5c9088['id'])[_0x1409f5(0x138)];_0x5c9088['emit'](_0x1409f5(0x18a),config),_0x5c9088['emit'](_0x1409f5(0x1c8),cleanSettings()),_0x5c9088['on'](_0x1409f5(0xe4),_0x1f91cb=>{const _0x551a56=_0x1409f5;if(validateAccess(_0x1f91cb,_0xe1883a)[_0x551a56(0x175)])addBot();else logging('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x5c9088['on'](_0x1409f5(0x17e),(_0x314e69,_0xfe217e)=>{const _0x436dc8=_0x1409f5;if(validateAccess(_0xfe217e,_0xe1883a)[_0x436dc8(0x175)])toggleBot(_0x314e69[_0x436dc8(0x19d)],_0x314e69[_0x436dc8(0x110)],_0x314e69[_0x436dc8(0x120)]);else logging(_0x436dc8(0x15f));}),_0x5c9088['on'](_0x1409f5(0x1aa),(_0x4e1276,_0xb9a88b)=>{const _0x32fc76=_0x1409f5;if(validateAccess(_0xb9a88b,_0xe1883a)[_0x32fc76(0x175)])deleteBot(_0x4e1276);else logging('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x5c9088['on']('store-settings',(_0x1d9eea,_0x39cddc)=>{const _0xdcd1a9=_0x1409f5;if(validateAccess(_0x39cddc,_0xe1883a)[_0xdcd1a9(0x175)])storeSettings(_0x1d9eea,!![]);else logging(_0xdcd1a9(0x128));}),_0x5c9088['on']('update-bb',(_0x35e00d,_0x637c97)=>{const _0x3d6a90=_0x1409f5;if(validateAccess(_0x637c97,_0xe1883a)['allow'])updateBB();else logging(_0x3d6a90(0x128));}),_0x5c9088['on'](_0x1409f5(0x185),_0x3d1640=>{const _0x165de3=_0x1409f5;if(validateAccess(_0x3d1640,_0xe1883a)['allow']){if(devices[_0xe1883a]['pidRefreshToken'])clearTimeout(devices[_0xe1883a][_0x165de3(0x208)]);if(devices[_0xe1883a]['pidExpireLogin'])clearTimeout(devices[_0xe1883a][_0x165de3(0x1fb)]);removeSocketListeners(getClient(_0x5c9088['id'])[_0x165de3(0x138)]),addBlacklist(_0xe1883a),devices[_0xe1883a][_0x165de3(0x17a)]=null,devices[_0xe1883a][_0x165de3(0x203)]=null,devices[_0xe1883a][_0x165de3(0x1ea)][_0x165de3(0x1e9)]=null,io['to'](getClient(_0x5c9088['id'])[_0x165de3(0x138)])[_0x165de3(0x17f)](_0x165de3(0x110),{'access':{'allow':![],'reason':_0x165de3(0x19f),'token':null}});}else logging(_0x165de3(0x1b1));});}function initializeSocketBot(_0x57963f){const _0x1e5110=_0x231898,_0x45c1c3=getClient(_0x57963f['id'])[_0x1e5110(0x151)],_0x25eac5=getClient(_0x57963f['id'])[_0x1e5110(0x138)];_0x57963f['on']('get-logs',(_0x4a944e,_0x48fec1)=>{const _0x2ca66a=_0x1e5110;if(validateAccess(_0x48fec1,_0x25eac5)[_0x2ca66a(0x175)]){if(pid[_0x45c1c3])pid[_0x45c1c3][_0x2ca66a(0x1d6)]({'function':_0x2ca66a(0xfe),'args':_0x4a944e});}else logging(_0x2ca66a(0x1cd));}),_0x57963f['on'](_0x1e5110(0xf0),(_0x4dfb17,_0x29d465)=>{const _0x404e9a=_0x1e5110;if(validateAccess(_0x29d465,_0x25eac5)[_0x404e9a(0x175)]){if(pid[_0x45c1c3])pid[_0x45c1c3]['send']({'function':'getPortfolio','args':_0x4dfb17});}else logging(_0x404e9a(0x1cf));}),_0x57963f['on'](_0x1e5110(0x13f),(_0x427015,_0x3d1052)=>{const _0x66d56c=_0x1e5110;if(validateAccess(_0x3d1052,_0x25eac5)['allow']){if(pid[_0x45c1c3])pid[_0x45c1c3][_0x66d56c(0x1d6)]({'function':_0x66d56c(0xdc),'args':_0x427015});}else logging(_0x66d56c(0x198));}),_0x57963f['on'](_0x1e5110(0x165),(_0x53267a,_0x1bf925)=>{const _0x4ee026=_0x1e5110;if(validateAccess(_0x1bf925,_0x25eac5)['allow']){if(pid[_0x45c1c3])pid[_0x45c1c3]['send']({'function':'storeHeadless','args':_0x53267a});}else logging(_0x4ee026(0x10d));}),_0x57963f['on'](_0x1e5110(0x1a3),_0x3d4141=>{if(validateAccess(_0x3d4141,_0x25eac5)['allow']){if(pid[_0x45c1c3])pid[_0x45c1c3]['send']({'function':'getStartingBalances','args':null});}else logging('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x57963f['on'](_0x1e5110(0x162),(_0x3561f5,_0x4f5502)=>{const _0x3f55b6=_0x1e5110;if(validateAccess(_0x4f5502,_0x25eac5)[_0x3f55b6(0x175)]){if(pid[_0x45c1c3])pid[_0x45c1c3][_0x3f55b6(0x1d6)]({'function':'placeOrder','args':_0x3561f5});}else logging(_0x3f55b6(0xe7));}),_0x57963f['on'](_0x1e5110(0x15a),_0x2ef3b9=>{const _0x23a1d6=_0x1e5110;if(validateAccess(_0x2ef3b9,_0x25eac5)[_0x23a1d6(0x175)]){if(pid[_0x45c1c3])pid[_0x45c1c3][_0x23a1d6(0x1d6)]({'function':'cancelLoading','args':null});}else logging('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x57963f['on'](_0x1e5110(0x185),_0x5a49d3=>{const _0x298caa=_0x1e5110;if(validateAccess(_0x5a49d3,_0x25eac5)['allow']){if(devices[_0x25eac5][_0x298caa(0x208)])clearTimeout(devices[_0x25eac5][_0x298caa(0x208)]);if(devices[_0x25eac5]['pidExpireLogin'])clearTimeout(devices[_0x25eac5][_0x298caa(0x1fb)]);removeSocketListeners(getClient(_0x57963f['id'])[_0x298caa(0x138)]),addBlacklist(_0x25eac5),devices[_0x25eac5]['telegramIpApproval']=null,devices[_0x25eac5][_0x298caa(0x203)]=null,devices[_0x25eac5][_0x298caa(0x1ea)][_0x298caa(0x1e9)]=null,io['to'](getClient(_0x57963f['id'])['uuid'])['emit'](_0x298caa(0x110),{'access':{'allow':![],'reason':_0x298caa(0x19f),'token':null}});}else logging(_0x298caa(0x1b1));});}function removeSocketListeners(_0x208468){const _0x36c782=_0x231898;getClientsWithUuid(_0x208468)[_0x36c782(0x1f9)](_0x1784f9=>{const _0x29b1d5=_0x36c782;getSocket(_0x1784f9['id'])[_0x29b1d5(0x170)]();});}function cleanSettings(){const _0x1e163b=_0x231898;let _0x3b6181=settings;return settings[_0x1e163b(0x1c9)]&&settings[_0x1e163b(0x1c9)]!=''&&(_0x3b6181={..._0x3b6181,'telegramToken':'************'}),settings['bbPassword']&&settings[_0x1e163b(0x161)]!=''&&(_0x3b6181={..._0x3b6181,'bbPassword':_0x1e163b(0x13c)}),_0x3b6181;}function updateBB(){process['send']({'update':!![]},_0x10df0f=>{});}function startBot(_0x53049f,_0x7ca798,_0x3f25f7){const _0x430d76=_0x231898;let _0x583f4b=![];const _0x215642=_0x53049f[0x0];_0x7ca798={..._0x7ca798,'stdio':[_0x430d76(0xd4),_0x430d76(0xd4),_0x430d76(0xd4),_0x430d76(0x122)]},pid[_0x215642]=childProcess[_0x430d76(0x1e0)](botfile,_0x53049f,_0x7ca798),pid[_0x215642]['on'](_0x430d76(0x10c),_0xaa829d=>{const _0x26b8b6=_0x430d76;switch(Object['keys'](_0xaa829d)[0x0]){case'botname':updateBotName(_0x215642,_0xaa829d[_0x26b8b6(0x16e)]);break;case _0x26b8b6(0x110):updateStatus(_0x215642,_0xaa829d[_0x26b8b6(0x110)]);break;case _0x26b8b6(0x120):updateLive(_0x215642,_0xaa829d['live']);break;case _0x26b8b6(0x1ec):updateLive(_0x215642,_0xaa829d[_0x26b8b6(0x1ec)]),io['to'](_0x215642)[_0x26b8b6(0x17f)](_0x26b8b6(0x110),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x26b8b6(0x1c6):_0xaa829d[_0x26b8b6(0x1c6)]==_0x26b8b6(0x1de)&&stopBot(_0x215642);_0xaa829d[_0x26b8b6(0x1c6)]=='kill'&&toggleBot(_0x215642,'disabled',_0x26b8b6(0xf5));break;case _0x26b8b6(0x11c):sendTelegram(_0x215642,_0xaa829d[_0x26b8b6(0x11c)]);break;case _0x26b8b6(0xe8):io['to'](_0x215642)[_0x26b8b6(0x17f)](_0xaa829d['function'],_0xaa829d[_0x26b8b6(0x1ce)]);break;}}),pid[_0x215642]['on'](_0x430d76(0x1b2),function(_0x72f798){if(_0x583f4b)return;_0x583f4b=!![],_0x3f25f7(_0x72f798);}),pid[_0x215642]['on'](_0x430d76(0x158),function(_0x28d47f){const _0x53ff00=_0x430d76;if(_0x583f4b)return;_0x583f4b=!![],_0x3f25f7(null);const _0x4f0426=dbConfig[_0x53ff00(0x19b)](_0x53ff00(0x18a))[_0x53ff00(0xd5)]({'botID':_0x215642})[_0x53ff00(0x11d)]();_0x4f0426&&(_0x4f0426['status']==_0x53ff00(0x152)||_0x4f0426[_0x53ff00(0x110)]=='new')&&(updateLive(_0x215642,_0x53ff00(0xf5)),logging(_0x53ff00(0x17c)+_0x215642),startBot([_0x215642,userID],{'cwd':bbpath},function(_0x422c90){if(_0x422c90)logging(_0x422c90);}));});}function stopBot(_0x2ff0d7){const _0x19f149=_0x231898;getClientsWithBotID(_0x2ff0d7)['forEach'](_0x4129f9=>{const _0x511983=_0x1d28;getSocket(_0x4129f9['id'])[_0x511983(0x146)](!![]),removeClient(_0x4129f9['id']);});if(pid[_0x2ff0d7])pid[_0x2ff0d7][_0x19f149(0x147)]();}function addBot(){const _0x4acde5=_0x231898;let _0x46b3fc;for(let _0x51fc88=0x1;_0x51fc88<0x3e9;_0x51fc88++){_0x46b3fc=_0x51fc88[_0x4acde5(0x1c2)]()[_0x4acde5(0xe3)](0x3,'0');let _0x57bd4a=config[_0x4acde5(0xd5)](_0x141682=>_0x141682[_0x4acde5(0x19d)]==_0x46b3fc);if(!_0x57bd4a)break;}if(_0x46b3fc===_0x4acde5(0x1e3)){logging(_0x4acde5(0x112));return;}logging('starting\x20new\x20bot\x20|\x20Bot\x20'+_0x46b3fc),dbConfig[_0x4acde5(0x19b)](_0x4acde5(0x18a))['push']({'botID':_0x46b3fc,'botname':'Bot\x20'+_0x46b3fc,'status':_0x4acde5(0x210),'live':''})[_0x4acde5(0x1bc)](),startBot([_0x46b3fc,userID],{'cwd':bbpath},function(_0x519921){if(_0x519921)logging(_0x519921);}),config=getConfiguration(),io['to'](_0x4acde5(0x19e))[_0x4acde5(0x17f)](_0x4acde5(0x18a),config);}function deleteBot(_0x596c16){const _0x56b53b=_0x231898;getClientsWithBotID(_0x596c16)[_0x56b53b(0x1f9)](_0x1406ef=>{const _0x1cbcb3=_0x56b53b;getSocket(_0x1406ef['id'])[_0x1cbcb3(0x146)](!![]),removeClient(_0x1406ef['id']);}),dbConfig[_0x56b53b(0x19b)](_0x56b53b(0x18a))[_0x56b53b(0x193)]({'botID':_0x596c16})[_0x56b53b(0x1bc)](),logging('deleted\x20Bot\x20'+_0x596c16),stopBot(_0x596c16);try{fs[_0x56b53b(0x1df)](path['join'](configpath,_0x56b53b(0x1ca)+_0x596c16+_0x56b53b(0x20f))),fs[_0x56b53b(0x1df)](path[_0x56b53b(0x10a)](configpath,'bot-'+_0x596c16+'-events.json')),fs[_0x56b53b(0x1df)](path[_0x56b53b(0x10a)](configpath,'bot-'+_0x596c16+_0x56b53b(0x1ed))),fs[_0x56b53b(0x1df)](path[_0x56b53b(0x10a)](configpath,_0x56b53b(0x1ca)+_0x596c16+_0x56b53b(0x213)));}catch(_0x4e3c48){if(_0x4e3c48)logging(_0x56b53b(0x157),_0x4e3c48);}config=getConfiguration(),io['to'](_0x56b53b(0x19e))[_0x56b53b(0x17f)](_0x56b53b(0x18a),config);}function toggleBot(_0x1d7954,_0x46e227,_0xc0c56c){const _0x18e326=_0x231898;dbConfig['get'](_0x18e326(0x18a))[_0x18e326(0xd5)]({'botID':_0x1d7954})[_0x18e326(0x15e)]({'status':_0x46e227})[_0x18e326(0x15e)]({'live':_0xc0c56c})[_0x18e326(0x1bc)]();if(_0x46e227==_0x18e326(0x152)||_0x46e227==_0x18e326(0x210))logging(_0x18e326(0x1dd)+_0x1d7954),startBot([_0x1d7954,userID],{'cwd':bbpath},function(_0x1a3797){if(_0x1a3797)logging(_0x1a3797);});else(_0x46e227=='disabled'||_0x46e227==_0x18e326(0x1a6))&&(logging(_0x18e326(0x10e)+_0x1d7954),stopBot(_0x1d7954));config=getConfiguration(),io['to'](_0x18e326(0x19e))[_0x18e326(0x17f)]('bots',config);}function toggleStatus(_0x5e767c){const _0x1b77c7=_0x231898;let _0x85a24c=dbConfig[_0x1b77c7(0x19b)]('bots')['find']({'botID':_0x5e767c})[_0x1b77c7(0x11d)](),_0x4ae870;if(_0x85a24c[_0x1b77c7(0x110)]===_0x1b77c7(0x152))_0x4ae870=_0x1b77c7(0x1ac);else{if(_0x85a24c[_0x1b77c7(0x110)]==='new')_0x4ae870=_0x1b77c7(0x1a6);else{if(_0x85a24c[_0x1b77c7(0x110)]===_0x1b77c7(0x1a6))_0x4ae870='new';else{if(_0x85a24c[_0x1b77c7(0x110)]===_0x1b77c7(0x1ac))_0x4ae870=_0x1b77c7(0x152);}}}return _0x4ae870;}function updateStatus(_0xf39b03,_0x43826f){const _0x2d3212=_0x231898;dbConfig[_0x2d3212(0x19b)](_0x2d3212(0x18a))[_0x2d3212(0xd5)]({'botID':_0xf39b03})[_0x2d3212(0x15e)]({'status':_0x43826f})[_0x2d3212(0x1bc)](),config=getConfiguration(),io['to'](_0x2d3212(0x19e))[_0x2d3212(0x17f)](_0x2d3212(0x18a),config);}function updateLive(_0x15a81c,_0x3cf82e){const _0x489753=_0x231898;dbConfig['get'](_0x489753(0x18a))['find']({'botID':_0x15a81c})['assign']({'live':_0x3cf82e})[_0x489753(0x1bc)](),config=getConfiguration(),io['to'](_0x489753(0x19e))[_0x489753(0x17f)](_0x489753(0x18a),config);}function updateBotName(_0x4b37f9,_0x22386b){const _0x1a4351=_0x231898;dbConfig[_0x1a4351(0x19b)](_0x1a4351(0x18a))[_0x1a4351(0xd5)]({'botID':_0x4b37f9})['assign']({'botname':_0x22386b})['write'](),config=getConfiguration(),io['to'](_0x1a4351(0x19e))[_0x1a4351(0x17f)](_0x1a4351(0x18a),config);}function telegramError(_0x24e000){const _0x1ee1d0=_0x231898;console[_0x1ee1d0(0x155)](getTimeStamp()+_0x1ee1d0(0xdd));}function validateTelegram(_0x422c41){const _0x53d6a3=_0x231898;if(_0x422c41[_0x53d6a3(0x206)][_0x53d6a3(0x172)]!=settings[_0x53d6a3(0x1b7)]&&'@'+_0x422c41[_0x53d6a3(0x206)][_0x53d6a3(0x172)]!=settings['telegramUsername'])return tgBot['sendMessage'](_0x422c41['chat']['id'],_0x53d6a3(0x115),{'parse_mode':'HTML'})[_0x53d6a3(0x124)](_0x200061=>{telegramError(_0x200061);}),![];return!![];}async function initTelegram(){const _0x17b90b=_0x231898;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x17b90b(0x1c9)],{'polling':!![]});let _0x2cdc8a='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x2cdc8a+='\x0a',_0x2cdc8a+=_0x17b90b(0x183),_0x2cdc8a+=_0x17b90b(0xe2),_0x2cdc8a+=_0x17b90b(0x1e8),_0x2cdc8a+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x2cdc8a+='/on\x20-\x20start\x20bot(s)\x0a',_0x2cdc8a+=_0x17b90b(0xf3),_0x2cdc8a+=_0x17b90b(0x18b),_0x2cdc8a+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x4be430=_0x17b90b(0x169);_0x4be430+='\x0a',_0x4be430+=_0x2cdc8a,tgBot[_0x17b90b(0xf8)](/\/start/,_0x40ffd7=>{const _0xaabefa=_0x17b90b;if(!validateTelegram(_0x40ffd7))return;if(settings[_0xaabefa(0x1d7)]!=_0x40ffd7[_0xaabefa(0x108)]['id'])updateSetting(_0xaabefa(0x1d7),_0x40ffd7[_0xaabefa(0x108)]['id']);updateSetting(_0xaabefa(0x1e5),!![]),tgBot[_0xaabefa(0x12e)](_0x40ffd7['chat']['id'],_0x4be430)[_0xaabefa(0x124)](_0x4992a9=>{telegramError(_0x4992a9);});}),tgBot[_0x17b90b(0xf8)](/\/enable/,_0x20dfd5=>{const _0x4a1f9f=_0x17b90b;if(!validateTelegram(_0x20dfd5))return;if(settings[_0x4a1f9f(0x1d7)]!=_0x20dfd5[_0x4a1f9f(0x108)]['id'])updateSetting('telegramChatId',_0x20dfd5[_0x4a1f9f(0x108)]['id']);updateSetting(_0x4a1f9f(0x1e5),!![]),tgBot[_0x4a1f9f(0x12e)](_0x20dfd5[_0x4a1f9f(0x108)]['id'],_0x4a1f9f(0xee))[_0x4a1f9f(0x124)](_0x424cd6=>{telegramError(_0x424cd6);});}),tgBot[_0x17b90b(0xf8)](/\/config/,async _0x4a6169=>{const _0x353905=_0x17b90b;if(!validateTelegram(_0x4a6169))return;tgBot[_0x353905(0x209)](_0x353905(0x179)),tgBot[_0x353905(0x12e)](_0x4a6169[_0x353905(0x108)]['id'],_0x353905(0x1da),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x353905(0x13d)},{'text':_0x353905(0x130),'callback_data':_0x353905(0x1b5)},{'text':_0x353905(0x1b9),'callback_data':'all'}]]}})[_0x353905(0x124)](_0x5bd0d2=>{telegramError(_0x5bd0d2);}),tgBot['on'](_0x353905(0x179),async _0x11515b=>{const _0x140fe8=_0x353905,_0x47fe80=_0x11515b['data'],_0x2b2150=_0x11515b[_0x140fe8(0x10c)];tgBot[_0x140fe8(0x1ad)](_0x11515b['id'])[_0x140fe8(0x12c)](async()=>{const _0x4e185d=_0x140fe8;_0x47fe80=='orders'&&(updateSetting(_0x4e185d(0x164),_0x4e185d(0x13d)),updateSetting(_0x4e185d(0x1e5),!![]),await tgBot[_0x4e185d(0x12e)](_0x2b2150['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x4e185d(0x124)](_0xd84710=>{telegramError(_0xd84710);}));_0x47fe80=='alerts'&&(updateSetting(_0x4e185d(0x164),_0x4e185d(0x1b5)),updateSetting(_0x4e185d(0x1e5),!![]),await tgBot[_0x4e185d(0x12e)](_0x2b2150['chat']['id'],_0x4e185d(0x1a7))[_0x4e185d(0x124)](_0x333cc1=>{telegramError(_0x333cc1);}));_0x47fe80==_0x4e185d(0xd3)&&(updateSetting(_0x4e185d(0x164),_0x4e185d(0xd3)),updateSetting(_0x4e185d(0x1e5),!![]),await tgBot[_0x4e185d(0x12e)](_0x2b2150[_0x4e185d(0x108)]['id'],_0x4e185d(0xef))['catch'](_0x462bbb=>{telegramError(_0x462bbb);}));if(!settings[_0x4e185d(0x1d7)])tgBot[_0x4e185d(0x12e)](_0x2b2150[_0x4e185d(0x108)]['id'],_0x4e185d(0x149))[_0x4e185d(0x124)](_0x1242df=>{telegramError(_0x1242df);});}),tgBot['removeListener'](_0x140fe8(0x179));});}),tgBot['onText'](/\/status/,_0x3ee03c=>{const _0x20e5c4=_0x17b90b;if(!validateTelegram(_0x3ee03c))return;let _0x53d606=_0x20e5c4(0x12b);config[_0x20e5c4(0x1f9)](_0x480a7b=>{const _0x29636b=_0x20e5c4;_0x53d606+=_0x29636b(0x106)+_0x480a7b['botID']+_0x29636b(0x136)+_0x480a7b[_0x29636b(0x16e)]+':\x20'+_0x480a7b[_0x29636b(0x110)]+_0x29636b(0x18f)+_0x480a7b[_0x29636b(0x120)]+'\x0a';}),_0x53d606+='\x0a',_0x53d606+='<b>Telegram\x20bot\x20status:</b>\x0a',_0x53d606+=!settings[_0x20e5c4(0x1e5)]?_0x20e5c4(0x1d3):_0x20e5c4(0x1e4),_0x53d606+=settings[_0x20e5c4(0x1e5)]?settings[_0x20e5c4(0x164)]=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x20e5c4(0x1d1)+settings[_0x20e5c4(0x164)]+_0x20e5c4(0x100):'',tgBot[_0x20e5c4(0x12e)](_0x3ee03c[_0x20e5c4(0x108)]['id'],_0x53d606,{'parse_mode':_0x20e5c4(0x20a)})[_0x20e5c4(0x124)](_0x248afb=>{telegramError(_0x248afb);});}),tgBot['onText'](/\/restart/,_0x1ee919=>{const _0x14f36b=_0x17b90b;if(!validateTelegram(_0x1ee919))return;tgBot[_0x14f36b(0x209)](_0x14f36b(0x179));const _0x3be062=getEnabledBots();if(_0x3be062[_0x14f36b(0x1f5)]==0x0)tgBot['sendMessage'](_0x1ee919['chat']['id'],_0x14f36b(0x160))[_0x14f36b(0x124)](_0xb4fd94=>{telegramError(_0xb4fd94);});else{if(_0x3be062[_0x14f36b(0x1f5)]>0x1)_0x3be062[_0x14f36b(0x1f6)]({'botID':_0x14f36b(0xd3)});let _0x3aa416=[],_0x26ab5a=[];const _0x5d6467=_0x3be062['length']%0x4==0x0||_0x3be062[_0x14f36b(0x1f5)]%0x4==0x3||_0x3be062[_0x14f36b(0x1f5)]%0x3==0x1?0x4:0x3;let _0x9afbdd=0x0;_0x3be062[_0x14f36b(0x1f9)]((_0x5d3f3b,_0x124490)=>{const _0x3a2590=_0x14f36b;if(_0x124490%_0x5d6467==0x0)_0x26ab5a=[];_0x26ab5a['push']({'text':_0x5d3f3b['botID']==_0x3a2590(0xd3)?'All\x20bots':_0x3a2590(0x106)+_0x5d3f3b[_0x3a2590(0x19d)],'callback_data':_0x5d3f3b[_0x3a2590(0x19d)]}),_0x124490%_0x5d6467==0x0&&(_0x3aa416[_0x9afbdd]=_0x26ab5a,_0x9afbdd++);}),tgBot[_0x14f36b(0x12e)](_0x1ee919['chat']['id'],_0x14f36b(0x1d0),{'reply_markup':{'inline_keyboard':_0x3aa416}})['catch'](_0x4a4e9b=>{telegramError(_0x4a4e9b);}),tgBot['on'](_0x14f36b(0x179),async _0x5ddb70=>{const _0x35d40d=_0x14f36b,_0x319262=_0x5ddb70[_0x35d40d(0xd1)],_0x3f080d=_0x5ddb70[_0x35d40d(0x10c)];tgBot[_0x35d40d(0x1ad)](_0x5ddb70['id'])[_0x35d40d(0x12c)](async()=>{const _0x41a7c3=_0x35d40d;if(_0x319262==_0x41a7c3(0xd3)){if(settings['telegramEvents']==_0x41a7c3(0x13d))tgBot[_0x41a7c3(0x12e)](_0x3f080d[_0x41a7c3(0x108)]['id'],_0x41a7c3(0x16d))[_0x41a7c3(0x124)](_0x9505ca=>{telegramError(_0x9505ca);});config['forEach'](_0x1f5d5d=>{const _0x4101f0=_0x41a7c3;stopBot(_0x1f5d5d[_0x4101f0(0x19d)]);});}else{if(settings['telegramEvents']==_0x41a7c3(0x13d))tgBot[_0x41a7c3(0x12e)](_0x3f080d[_0x41a7c3(0x108)]['id'],_0x41a7c3(0x1d2)+_0x319262)['catch'](_0xf7f3b9=>{telegramError(_0xf7f3b9);});stopBot(_0x319262);}}),tgBot['removeListener'](_0x35d40d(0x179));});}}),tgBot[_0x17b90b(0xf8)](/\/on/,_0x10f32a=>{const _0x162e94=_0x17b90b;if(!validateTelegram(_0x10f32a))return;tgBot[_0x162e94(0x209)]('callback_query');const _0x5c14e2=getDisabledBots();if(_0x5c14e2['length']==0x0)tgBot[_0x162e94(0x12e)](_0x10f32a[_0x162e94(0x108)]['id'],_0x162e94(0x1ab))[_0x162e94(0x124)](_0xdf1448=>{telegramError(_0xdf1448);});else{if(_0x5c14e2['length']>0x1)_0x5c14e2[_0x162e94(0x1f6)]({'botID':_0x162e94(0xd3)});let _0x5d052=[],_0xf986cb=[];const _0x50d176=_0x5c14e2[_0x162e94(0x1f5)]%0x4==0x0||_0x5c14e2[_0x162e94(0x1f5)]%0x4==0x3||_0x5c14e2[_0x162e94(0x1f5)]%0x3==0x1?0x4:0x3;let _0x860728=0x0;_0x5c14e2[_0x162e94(0x1f9)]((_0x596a68,_0x1cd183)=>{const _0x4548a6=_0x162e94;if(_0x1cd183%_0x50d176==0x0)_0xf986cb=[];_0xf986cb[_0x4548a6(0x1f6)]({'text':_0x596a68[_0x4548a6(0x19d)]==_0x4548a6(0xd3)?_0x4548a6(0x187):_0x4548a6(0x106)+_0x596a68['botID'],'callback_data':_0x596a68['botID']}),_0x1cd183%_0x50d176==0x0&&(_0x5d052[_0x860728]=_0xf986cb,_0x860728++);}),tgBot[_0x162e94(0x12e)](_0x10f32a[_0x162e94(0x108)]['id'],_0x162e94(0x141),{'reply_markup':{'inline_keyboard':_0x5d052}})['catch'](_0x376ce5=>{telegramError(_0x376ce5);}),tgBot['on'](_0x162e94(0x179),async _0x3af786=>{const _0x1599e2=_0x162e94,_0x31d93b=_0x3af786[_0x1599e2(0xd1)],_0x5493da=_0x3af786['message'];tgBot['answerCallbackQuery'](_0x3af786['id'])[_0x1599e2(0x12c)](async()=>{const _0x1ee529=_0x1599e2;if(_0x31d93b==_0x1ee529(0xd3)){if(settings[_0x1ee529(0x164)]=='orders')tgBot[_0x1ee529(0x12e)](_0x5493da[_0x1ee529(0x108)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x1ee529(0x124)](_0x283cbb=>{telegramError(_0x283cbb);});_0x5c14e2[_0x1ee529(0x1f9)](_0x17868f=>{const _0x219adf=_0x1ee529;if(_0x17868f[_0x219adf(0x19d)]!=_0x219adf(0xd3))toggleBot(_0x17868f[_0x219adf(0x19d)],toggleStatus(_0x17868f['botID']),_0x219adf(0xf5));});}else{if(settings[_0x1ee529(0x164)]=='orders')tgBot[_0x1ee529(0x12e)](_0x5493da[_0x1ee529(0x108)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x31d93b)[_0x1ee529(0x124)](_0x12c778=>{telegramError(_0x12c778);});toggleBot(_0x31d93b,toggleStatus(_0x31d93b),_0x1ee529(0xf5));}}),tgBot[_0x1599e2(0x209)](_0x1599e2(0x179));});}}),tgBot[_0x17b90b(0xf8)](/\/off/,_0x123919=>{const _0x55007f=_0x17b90b;if(!validateTelegram(_0x123919))return;tgBot[_0x55007f(0x209)]('callback_query');const _0x5cf28a=getEnabledBots();if(_0x5cf28a[_0x55007f(0x1f5)]==0x0)tgBot[_0x55007f(0x12e)](_0x123919[_0x55007f(0x108)]['id'],_0x55007f(0x160))[_0x55007f(0x124)](_0x117958=>{telegramError(_0x117958);});else{if(_0x5cf28a[_0x55007f(0x1f5)]>0x1)_0x5cf28a[_0x55007f(0x1f6)]({'botID':'all'});let _0x35870a=[],_0x15316e=[];const _0x22082e=_0x5cf28a[_0x55007f(0x1f5)]%0x4==0x0||_0x5cf28a[_0x55007f(0x1f5)]%0x4==0x3||_0x5cf28a['length']%0x3==0x1?0x4:0x3;let _0x5b3ba9=0x0;_0x5cf28a[_0x55007f(0x1f9)]((_0x2d36f9,_0x2a9471)=>{const _0x38c181=_0x55007f;if(_0x2a9471%_0x22082e==0x0)_0x15316e=[];_0x15316e[_0x38c181(0x1f6)]({'text':_0x2d36f9[_0x38c181(0x19d)]==_0x38c181(0xd3)?_0x38c181(0x187):_0x38c181(0x106)+_0x2d36f9[_0x38c181(0x19d)],'callback_data':_0x2d36f9[_0x38c181(0x19d)]}),_0x2a9471%_0x22082e==0x0&&(_0x35870a[_0x5b3ba9]=_0x15316e,_0x5b3ba9++);}),tgBot[_0x55007f(0x12e)](_0x123919['chat']['id'],_0x55007f(0x1cc),{'reply_markup':{'inline_keyboard':_0x35870a}})[_0x55007f(0x124)](_0x4ca702=>{telegramError(_0x4ca702);}),tgBot['on'](_0x55007f(0x179),async _0x551bcc=>{const _0x4b911c=_0x55007f,_0x2c5912=_0x551bcc[_0x4b911c(0xd1)],_0x384ee5=_0x551bcc[_0x4b911c(0x10c)];tgBot['answerCallbackQuery'](_0x551bcc['id'])[_0x4b911c(0x12c)](async()=>{const _0x17510d=_0x4b911c;if(_0x2c5912==_0x17510d(0xd3)){if(settings['telegramEvents']==_0x17510d(0x13d))tgBot['sendMessage'](_0x384ee5['chat']['id'],_0x17510d(0x20c))[_0x17510d(0x124)](_0x43fadd=>{telegramError(_0x43fadd);});_0x5cf28a['forEach'](_0x4ede49=>{const _0x45ff18=_0x17510d;if(_0x4ede49[_0x45ff18(0x19d)]!=_0x45ff18(0xd3))toggleBot(_0x4ede49['botID'],toggleStatus(_0x4ede49[_0x45ff18(0x19d)]),'stopped');});}else{if(settings['telegramEvents']=='orders')tgBot[_0x17510d(0x12e)](_0x384ee5[_0x17510d(0x108)]['id'],_0x17510d(0xff)+_0x2c5912)[_0x17510d(0x124)](_0x3bb697=>{telegramError(_0x3bb697);});toggleBot(_0x2c5912,toggleStatus(_0x2c5912),_0x17510d(0xf5));}}),tgBot[_0x4b911c(0x209)](_0x4b911c(0x179));});}}),tgBot['onText'](/\/disable/,_0x421583=>{const _0x23ac27=_0x17b90b;if(!validateTelegram(_0x421583))return;tgBot['sendMessage'](_0x421583['chat']['id'],_0x23ac27(0x1b0))['catch'](_0x1f7cdd=>{telegramError(_0x1f7cdd);}),updateSetting('telegramEnabled',![]);}),tgBot['onText'](/\/help/,_0x5d1c89=>{const _0x501b58=_0x17b90b;if(!validateTelegram(_0x5d1c89))return;tgBot[_0x501b58(0x12e)](_0x5d1c89[_0x501b58(0x108)]['id'],_0x2cdc8a)[_0x501b58(0x124)](_0x5b6e1b=>{telegramError(_0x5b6e1b);});}),tgBot['on'](_0x17b90b(0xfd),_0x4e3ca1=>{const _0x4c1e6e=_0x17b90b;_0x4e3ca1[_0x4c1e6e(0x1c2)]()['includes']('404\x20Not\x20Found')&&(logging(_0x4c1e6e(0xe0)),tgBot[_0x4c1e6e(0x1f2)](),tgBot=null,io['to']('botmanager')[_0x4c1e6e(0x17f)](_0x4c1e6e(0x1f0),_0x4c1e6e(0xe0)));}),process[_0x17b90b(0x105)](_0x17b90b(0x1f4),()=>{const _0x2c629d=_0x17b90b;if(tgBot)tgBot['stopPolling']();process[_0x2c629d(0x158)](0x1);}),process[_0x17b90b(0x105)](_0x17b90b(0x14e),()=>{const _0xddfffa=_0x17b90b;if(tgBot)tgBot[_0xddfffa(0x1f2)]();process[_0xddfffa(0x158)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x54b1de,_0x431c39){const _0x2d91d3=_0x231898;if(settings[_0x2d91d3(0x1e5)]){if(settings['telegramEvents']==_0x2d91d3(0xd3)||(_0x431c39[_0x2d91d3(0x12a)]==_0x2d91d3(0x1b2)||_0x431c39['type']==_0x2d91d3(0x204))&&settings[_0x2d91d3(0x164)]==_0x2d91d3(0x1b5)||_0x431c39['type']==_0x2d91d3(0x123)&&settings[_0x2d91d3(0x164)]==_0x2d91d3(0x13d)){if(tgBot&&settings[_0x2d91d3(0x1d7)]){if(_0x431c39[_0x2d91d3(0xf6)])tgBot[_0x2d91d3(0x12e)](settings[_0x2d91d3(0x1d7)],_0x431c39[_0x2d91d3(0x16e)]+_0x2d91d3(0xea)+_0x431c39['event'])[_0x2d91d3(0x124)](_0x28b9a4=>{telegramError(_0x28b9a4);});else tgBot[_0x2d91d3(0x12e)](settings['telegramChatId'],_0x2d91d3(0x106)+_0x54b1de+'\x20>\x20'+_0x431c39[_0x2d91d3(0x1e6)])[_0x2d91d3(0x124)](_0x533156=>{telegramError(_0x533156);});}}}}function getDeviceWithIp(_0x415f95){const _0x4222be=_0x231898;return devices[_0x4222be(0xd5)](_0x4c12fd=>_0x4c12fd['ip']===_0x415f95);}function temporaryAccess2FA(_0x5a15c9,_0x3ba8aa){const _0x54d64f=_0x231898;let _0x34279a=new Date(),_0x5cb0e8=![];if(lastIpApproval){if(_0x34279a-lastIpApproval<0x1388)_0x5cb0e8=!![];}lastIpApproval=new Date();if(_0x5cb0e8)return;tgBot&&settings[_0x54d64f(0x1d7)]&&(tgBot[_0x54d64f(0x209)](_0x54d64f(0x179)),tgBot['sendMessage'](settings[_0x54d64f(0x1d7)],_0x54d64f(0xd9)+normalizeIP(_0x3ba8aa)['show']+_0x54d64f(0x1fe),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x54d64f(0x1b4),'callback_data':'5'},{'text':_0x54d64f(0x201),'callback_data':'15'},{'text':_0x54d64f(0xdf),'callback_data':'30'},{'text':_0x54d64f(0x107),'callback_data':_0x54d64f(0x107)}]]}})['catch'](_0x278539=>{telegramError(_0x278539);}),tgBot['on']('callback_query',async _0x1da917=>{const _0x549e93=_0x54d64f,_0x2b55c2=_0x1da917['data'],_0x244d32=_0x1da917['message'];tgBot['answerCallbackQuery'](_0x1da917['id'])[_0x549e93(0x12c)](async()=>{const _0xd0553e=_0x549e93;devices[_0x5a15c9][_0xd0553e(0x17a)]={'clientip':_0x3ba8aa,'timestamp':new Date()[_0xd0553e(0x13a)](),'expiry':_0x2b55c2},_0x2b55c2!='reject'?(await tgBot[_0xd0553e(0x12e)](_0x244d32['chat']['id'],_0xd0553e(0x114)+_0x2b55c2+_0xd0553e(0x1cb),{'parse_mode':_0xd0553e(0x20a)})[_0xd0553e(0x124)](_0x2b4e30=>{telegramError(_0x2b4e30);}),io['to'](_0x5a15c9)[_0xd0553e(0x17f)]('status',{'access':{'allow':![],'reason':_0xd0553e(0x1d4),'token':null}})):(await tgBot[_0xd0553e(0x12e)](_0x244d32[_0xd0553e(0x108)]['id'],_0xd0553e(0xd6))[_0xd0553e(0x124)](_0x32d9d7=>{telegramError(_0x32d9d7);}),io['to'](_0x5a15c9)[_0xd0553e(0x17f)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot['removeListener'](_0x549e93(0x179));}));}function loginAccess2FA(_0x54f334,_0x28494f){const _0xedc2b6=_0x231898;tgBot&&settings[_0xedc2b6(0x1d7)]&&(tgBot[_0xedc2b6(0x209)](_0xedc2b6(0x179)),tgBot[_0xedc2b6(0x12e)](settings['telegramChatId'],_0xedc2b6(0x16f)+normalizeIP(_0x28494f)[_0xedc2b6(0x103)]+'</b>\x20?',{'parse_mode':_0xedc2b6(0x20a),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':'reject','callback_data':_0xedc2b6(0x107)}]]}})[_0xedc2b6(0x124)](_0x4d6625=>{telegramError(_0x4d6625);}),tgBot['on']('callback_query',async _0xcb9043=>{const _0xacc521=_0xedc2b6,_0x3dba3a=_0xcb9043[_0xacc521(0xd1)],_0xdccfee=_0xcb9043[_0xacc521(0x10c)];tgBot[_0xacc521(0x1ad)](_0xcb9043['id'])[_0xacc521(0x12c)](async()=>{const _0x54dc7f=_0xacc521;devices[_0x54f334]['telegram2FaApproval']={'clientip':_0x28494f,'timestamp':new Date()['getTime'](),'expiry':_0x3dba3a},_0x3dba3a!=_0x54dc7f(0x107)?(await tgBot[_0x54dc7f(0x12e)](_0xdccfee[_0x54dc7f(0x108)]['id'],'Login\x20accepted',{'parse_mode':'HTML'})[_0x54dc7f(0x124)](_0x4325dc=>{telegramError(_0x4325dc);}),io['to'](_0x54f334)[_0x54dc7f(0x17f)](_0x54dc7f(0x110),{'access':{'allow':![],'reason':_0x54dc7f(0x1d4),'token':null}})):(await tgBot[_0x54dc7f(0x12e)](_0xdccfee['chat']['id'],_0x54dc7f(0x184))['catch'](_0x429718=>{telegramError(_0x429718);}),io['to'](_0x54f334)[_0x54dc7f(0x17f)](_0x54dc7f(0x110),{'access':{'allow':![],'reason':_0x54dc7f(0x1af),'token':null}}));}),tgBot[_0xacc521(0x209)]('callback_query');}));}function getConfiguration(){const _0x3cf89e=_0x231898;return dbConfig[_0x3cf89e(0x19b)](_0x3cf89e(0x18a))['sortBy'](_0x3cf89e(0x19d))[_0x3cf89e(0x11d)]()||[];}function getEnabledBots(){const _0x46c0be=_0x231898;return dbConfig[_0x46c0be(0x19b)](_0x46c0be(0x18a))['sortBy'](_0x46c0be(0x19d))[_0x46c0be(0x199)]({'status':'enabled'})[_0x46c0be(0x11d)]()||[];}function getDisabledBots(){const _0x5ac92d=_0x231898;return dbConfig[_0x5ac92d(0x19b)](_0x5ac92d(0x18a))[_0x5ac92d(0x111)]('botID')[_0x5ac92d(0x199)]({'status':'disabled'})['value']()||[];}function getSettings(){const _0x58c558=_0x231898;return dbSettings[_0x58c558(0x19b)](_0x58c558(0x1c8))[_0x58c558(0x11d)]()||{'timeshift':0x0};}function getSecure(){const _0x4d03e7=_0x231898;return dbSecure[_0x4d03e7(0x19b)](_0x4d03e7(0x126))[_0x4d03e7(0x11d)]()||{};}function getBlacklist(){const _0x2ab12e=_0x231898;return dbSecure[_0x2ab12e(0x19b)]('blacklist')[_0x2ab12e(0x11d)]()||[];}function broadcastToBots(_0x47a604,_0x53a29f){const _0x3e926e=_0x231898;config[_0x3e926e(0x1f9)](_0x2d28f7=>{const _0x5d5c4e=_0x3e926e;if(_0x2d28f7[_0x5d5c4e(0x110)]==_0x5d5c4e(0x152)&&_0x2d28f7[_0x5d5c4e(0x120)]=='running'){if(pid[_0x2d28f7[_0x5d5c4e(0x19d)]])pid[_0x2d28f7[_0x5d5c4e(0x19d)]]['send']({[_0x47a604]:_0x53a29f});}});}function _0x25f6(){const _0x1c2d0b=['use','hex','get-starting-balances','Invalid\x20authentication\x20token\x20(1)','(((.+)+)+)+$','new-disabled','Ok,\x20will\x20send\x20alert\x20notifications\x20only','1657490qfTGhE','host','delete-bot','All\x20bots\x20running\x20right\x20now','disabled','answerCallbackQuery','max','2FA\x20login\x20rejected','Notifications\x20disabled','Unauthorized\x20attempt\x20to\x20log\x20out','error','2FA\x20required','5\x20min','alerts','index.html','telegramUsername','temporaryAccessAllowed','All','bb-config.json','apiKey','write','login\x20not\x20required','clientip','privateKey','map','timeshift','toString','13488980GkFExN','name','toIPv4Address','stop','lowdb','settings','telegramToken','bot-','\x20minutes','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Unauthorized\x20attempt\x20to\x20get\x20logs','args','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Notifications\x20types:\x20','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','Notifications\x20disabled\x0a','reload','createServer','send','telegramChatId','login\x20token\x20valid','sign','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','getMonth','secret','enabled\x20Bot\x20','restart','unlinkSync','fork','isValid','Invalid\x20authentication\x20token\x20(2)','1000','Notifications\x20enabled\x0a','telegramEnabled','event','bb/','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','token','access','store','started','-performance.json','isIPv4MappedAddress','includes','notification','set','stopPolling','whitelistEnabled','SIGINT','length','push','login','express','forEach','user','pidExpireLogin','starting\x20bot\x20|\x20Bot\x20','config/','</b>\x20?','hybrid-crypto-js','loginRequired','15\x20min','ipaddr.js','telegram2FaApproval','success','Error:\x20Invalid\x20argument\x20','from','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','pidRefreshToken','removeListener','HTML','temporary\x20token\x20generated','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','handshake','21260QENnZG','-config.json','new','::ffff:127.0.0.1','argv','-results.json','2FA','No\x20authentication\x20token','build2','::1','conn','data','access\x20timeout','all','inherit','find','Temporary\x20access\x20rejected','generateKeyPairAsync','connection','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','Balance\x20Bot\x20Server','node-telegram-bot-api','storeConfiguration',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','14CSUBtR','30\x20min','Invalid\x20Telegram\x20token','hashSync','/disable\x20-\x20disable\x20notifications\x0a','padStart','add-bot','version','bot.js','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','function','verify','\x20>\x20','Token\x20blacklisted','cloneDeep','52998KtEwtp','Notifications\x20enabled','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','get-portfolio','RSA-OAEP','exp','/off\x20-\x20stop\x20bot(s)\x0a','2FA\x20login\x20required','stopped','showname','reset-password','onText','bb-secure.json','listen','constructor','http','polling_error','emitHistory','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','\x20only\x0a','password','2FA\x20login\x20token\x20generated','show','sendFile','once','Bot\x20','reject','chat','temporary\x20access\x20timeout','join','-----------------------------------------------------------------------------------','message','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','disabled\x20Bot\x20','publicKey','status','sortBy','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','search','Access\x20enabled\x20for\x20','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','sha256','whitelist','timestamp','reason','https://hodlerhacks.com','encryptedUuid','telegram','value','copyFileSync','settings.','live','expiry','ipc','order','catch','port','secure','1324968vqmZqs','Unauthorized\x20attempt\x20to\x20update\x20settings','UA-192771731-1','type','<b>Balance\x20Bot\x20status:</b>\x0a','then','idling\x20bot\x20\x20\x20|\x20Bot\x20','sendMessage','4876614AOsFKK','Alerts','bbUsername','decrypt','isDirectory','blacklist','f2aRequired','\x20|\x20','sockets','uuid','server','getTime','existsSync','************','orders','219jlYhhl','store-configuration','hasOwnProperty','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','login\x20token\x20generated','Bot\x20Mgr\x20>\x20','getFullYear','Balance\x20Bot','disconnect','kill','11JwRdst','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','/:bot/performance','@analytics/google-analytics','date-fns','getMinutes','SIGTERM','3000','running','bot','enabled','getHours','jsonwebtoken','log','127.0.0.1','error\x20while\x20deleting\x20config\x20files:\x20','exit','Crypt','cancel-loading','getUTCHours','Invalid\x20IP\x20address','mkdirSync','assign','Unauthorized\x20attempt\x20to\x20update\x20bot','No\x20bots\x20running\x20right\x20now','bbPassword','place-order','match','telegramEvents','store-headless','add','version.json','kind','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a',':\x20Bot\x20Mgr\x20>\x20','test','getSeconds','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','botname','Allow\x20login\x20from\x20IP\x20address\x20<b>','removeAllListeners','yes','username','defaults','page','allow','auth','socket.io','bcryptjs','callback_query','telegramIpApproval','NTBA_FIX_319','restarting\x20Bot\x20','slice','update-bot','emit','connected','invalid\x20credentials',',\x20must\x20be\x20a\x204\x20digit\x20number','/enable\x20-\x20enable\x20notifications\x0a','Login\x20rejected','logout','initclient','All\x20bots','analytics','Password\x20reset\x20rejected','bots','/status\x20-\x20show\x20bot(s)\x20status\x0a','/:bot/coins','default','apply','\x20/\x20','randomFillSync','/:bot/history','child_process','remove','randomBytes','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','build','getDate','Unauthorized\x20attempt\x20to\x20store\x20configuration','filter','clients','get','readdirSync','botID','botmanager','logged\x20out','4336404drSWpv'];_0x25f6=function(){return _0x1c2d0b;};return _0x25f6();}function storeSettings(_0x55034a,_0x4bc97f=![]){const _0x3a198e=_0x231898;_0x55034a={...settings,..._0x55034a};if(_0x4bc97f&&_0x55034a[_0x3a198e(0x161)]!='************'&&_0x55034a[_0x3a198e(0x161)]!=''){const _0x13aad1=crypt[_0x3a198e(0x132)](secure['privateKey'],_0x55034a[_0x3a198e(0x161)])[_0x3a198e(0x10c)]['split']('@')[0x0],_0x331c6a=bcrypt['hashSync'](_0x13aad1,saltRounds);_0x55034a={..._0x55034a,'bbPassword':_0x331c6a};}if(_0x4bc97f&&_0x55034a['telegramToken']!=_0x3a198e(0x13c)&&_0x55034a[_0x3a198e(0x1c9)]!=''){const _0x35d925=crypt[_0x3a198e(0x132)](secure[_0x3a198e(0x1bf)],_0x55034a['telegramToken'])[_0x3a198e(0x10c)]['split']('@')[0x0];_0x55034a={..._0x55034a,'telegramToken':_0x35d925};}const _0x9e02a6=_0x55034a['telegramToken']!=_0x3a198e(0x13c)&&_0x55034a[_0x3a198e(0x1c9)]!=settings[_0x3a198e(0x1c9)]||_0x55034a[_0x3a198e(0x1b7)]!=settings[_0x3a198e(0x1b7)],_0x35e91b=_0x55034a[_0x3a198e(0x1c9)]==''||_0x55034a[_0x3a198e(0x1b7)]=='';if(_0x9e02a6)_0x55034a[_0x3a198e(0x164)]=_0x3a198e(0xd3);for(const [_0x29c707,_0x3ce665]of Object['entries'](_0x55034a)){if(_0x29c707==_0x3a198e(0x1c9)&&_0x3ce665=='************'){_0x55034a[_0x3a198e(0x1c9)]=settings[_0x3a198e(0x1c9)];continue;};if(_0x29c707==_0x3a198e(0x161)&&_0x3ce665==_0x3a198e(0x13c)){_0x55034a[_0x3a198e(0x161)]=settings[_0x3a198e(0x161)];continue;};dbSettings[_0x3a198e(0x1f1)]('settings.'+_0x29c707,_0x3ce665)[_0x3a198e(0x1bc)]();}settings=_0x55034a,io['to']('botmanager')[_0x3a198e(0x17f)](_0x3a198e(0x1c8),cleanSettings()),broadcastToBots(_0x3a198e(0x1c1),settings[_0x3a198e(0x1c1)]);if(_0x9e02a6&&!_0x35e91b)initTelegram();if(_0x9e02a6&&_0x35e91b)disableTelegram();getAllClients()[_0x3a198e(0x1f9)](_0x1a8109=>{const _0x310847=_0x3a198e;getSocket(_0x1a8109['id'])[_0x310847(0x17f)](_0x310847(0x110),{'access':{'allow':![],'reason':_0x310847(0x1d4),'token':null}});});}function updateSetting(_0x1c2a4e,_0xc4b5a3){const _0x1befc2=_0x231898;dbSettings[_0x1befc2(0x1f1)](_0x1befc2(0x11f)+_0x1c2a4e,_0xc4b5a3)['write'](),settings=getSettings(),io['to'](_0x1befc2(0x19e))[_0x1befc2(0x17f)](_0x1befc2(0x1c8),cleanSettings());}function storeSecure(_0x5deec7){const _0x5c2c0d=_0x231898;dbSecure[_0x5c2c0d(0x19b)](_0x5c2c0d(0x126))[_0x5c2c0d(0x1f6)](_0x5deec7)['write'](),secure=_0x5deec7;}function addBlacklist(_0x16393b){const _0x461bf4=_0x231898;cleanBlacklist();let _0x36fe8a;devices[_0x16393b][_0x461bf4(0x17a)]?_0x36fe8a=Math[_0x461bf4(0x1ae)](devices[_0x16393b][_0x461bf4(0x17a)]['expiry'],loginExpiry):_0x36fe8a=loginExpiry,dbSecure['get']('blacklist')['push']({'expiry':new Date()[_0x461bf4(0x13a)]()+_0x36fe8a*0x3c*0x3e8,'token':devices[_0x16393b][_0x461bf4(0x1ea)][_0x461bf4(0x1e9)]})[_0x461bf4(0x1bc)](),blacklist=dbSecure['get'](_0x461bf4(0x134))['value']();}function cleanBlacklist(){const _0x141247=_0x231898;let _0x2edf78=dbSecure[_0x141247(0x19b)](_0x141247(0x134))[_0x141247(0xec)]()[_0x141247(0x11d)](),_0x1b7c31=new Date()[_0x141247(0x13a)]();_0x2edf78[_0x141247(0x1f9)](_0x3b4b27=>{const _0x9c446=_0x141247;_0x3b4b27[_0x9c446(0x121)]<_0x1b7c31&&dbSecure[_0x9c446(0x19b)]('blacklist')['remove']({'expiry':_0x3b4b27['expiry']})[_0x9c446(0x1bc)]();});}function initStates(){let _0x48c9c6=getConfiguration();_0x48c9c6['forEach'](_0x1f727f=>{const _0x240037=_0x1d28;_0x1f727f[_0x240037(0x120)]=_0x240037(0xf5);}),storeConfiguration(_0x48c9c6);}function onKeys(){const _0x187aa9=new RSA();return new Promise(_0x170f1d=>{const _0x2e5bf1=_0x1d28;_0x187aa9[_0x2e5bf1(0xd7)]()['then'](_0x85b0=>{_0x170f1d(_0x85b0);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x8432ee=_0x231898;let _0x244a3c=getConfiguration(),_0x49f97e=![];_0x244a3c[_0x8432ee(0x1f9)](_0x56fcdb=>{const _0x554338=_0x8432ee;if(_0x56fcdb[_0x554338(0x110)]==_0x554338(0x150))_0x56fcdb[_0x554338(0x110)]=_0x554338(0x152),_0x49f97e=!![];else _0x56fcdb[_0x554338(0x110)]==_0x554338(0xf5)&&(_0x56fcdb[_0x554338(0x110)]=_0x554338(0x1ac),_0x49f97e=!![]);});if(_0x49f97e)storeConfiguration(_0x244a3c);let _0x1d7980=getSecure();if(!_0x1d7980[_0x8432ee(0x140)]('secret')){let _0x3cc99e=await generateKeys();_0x1d7980['publicKey']=_0x3cc99e[_0x8432ee(0x10f)],_0x1d7980[_0x8432ee(0x1bf)]=_0x3cc99e['privateKey'],_0x1d7980[_0x8432ee(0x1dc)]=crypto[_0x8432ee(0x194)](0x20)['toString'](_0x8432ee(0x1a2));;storeSecure(_0x1d7980);}let _0x2046b4=getSettings();_0x49f97e=![];!_0x2046b4[_0x8432ee(0x140)]('loginRequired')&&(_0x2046b4[_0x8432ee(0x200)]=![],_0x2046b4[_0x8432ee(0x131)]='',_0x2046b4[_0x8432ee(0x161)]='',_0x2046b4[_0x8432ee(0x135)]=![],_0x49f97e=!![]);!_0x2046b4[_0x8432ee(0x140)](_0x8432ee(0x1f3))&&(_0x2046b4[_0x8432ee(0x1f3)]=![],_0x2046b4[_0x8432ee(0x117)]=[],_0x2046b4[_0x8432ee(0x1b8)]=![],_0x49f97e=!![]);if(!_0x2046b4['hasOwnProperty'](_0x8432ee(0x1e5))){if(_0x2046b4['telegramChatId'])_0x2046b4[_0x8432ee(0x1e5)]=!![];else _0x2046b4['telegramEnabled']=![];_0x49f97e=!![];}if(_0x49f97e)storeSettings(_0x2046b4);}function storeConfiguration(_0x43a8f3){const _0x1d75cb=_0x231898;dbConfig[_0x1d75cb(0x19b)](_0x1d75cb(0x18a))['remove']()['write'](),dbConfig['get'](_0x1d75cb(0x18a))[_0x1d75cb(0x1f6)](..._0x43a8f3)[_0x1d75cb(0x1bc)](),config=_0x43a8f3;}function resetPassword(){const _0x4140fb=_0x231898;tgBot&&settings[_0x4140fb(0x1d7)]&&(tgBot['removeListener'](_0x4140fb(0x179)),tgBot['sendMessage'](settings['telegramChatId'],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x4140fb(0x20a),'reply_markup':{'inline_keyboard':[[{'text':_0x4140fb(0x171),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x4140fb(0x124)](_0x4e8dba=>{telegramError(_0x4e8dba);}),tgBot['on']('callback_query',async _0x553053=>{const _0x403566=_0x4140fb,_0x599988=_0x553053[_0x403566(0xd1)],_0x5cc008=_0x553053['message'];tgBot[_0x403566(0x1ad)](_0x553053['id'])[_0x403566(0x12c)](async()=>{const _0x5c46c3=_0x403566;if(_0x599988!='no'){const _0x3fd54a=0xf,_0x348042=_0x5c46c3(0x195),_0x1216d5=Array[_0x5c46c3(0x206)](crypto[_0x5c46c3(0x190)](new Uint32Array(_0x3fd54a)))[_0x5c46c3(0x1c0)](_0x47701e=>_0x348042[_0x47701e%_0x348042['length']])[_0x5c46c3(0x10a)](''),_0xe2fc31=bcrypt[_0x5c46c3(0xe1)](_0x1216d5,saltRounds);storeSettings({'bbPassword':_0xe2fc31}),await tgBot['sendMessage'](_0x5cc008[_0x5c46c3(0x108)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x1216d5,{'parse_mode':'HTML'})[_0x5c46c3(0x124)](_0xcfffed=>{telegramError(_0xcfffed);});}else await tgBot['sendMessage'](_0x5cc008['chat']['id'],_0x5c46c3(0x189))[_0x5c46c3(0x124)](_0x5a575a=>{telegramError(_0x5a575a);});}),tgBot[_0x403566(0x209)]('callback_query');}));}function logging(_0x2cd834){const _0x36063d=_0x231898;console[_0x36063d(0x155)](getTimeStamp()+_0x36063d(0x16a)+_0x2cd834);if(tgBot&&settings[_0x36063d(0x1d7)]&&settings['telegramEvents']!=_0x36063d(0x13d))tgBot['sendMessage'](settings[_0x36063d(0x1d7)],_0x36063d(0x143)+_0x2cd834)[_0x36063d(0x124)](_0x4f09f8=>{telegramError(_0x4f09f8);});}function getServerTime(){const _0x5be386=_0x231898,_0xb8410d=new Date();return _0xb8410d[_0x5be386(0x144)]()+'/'+(_0xb8410d[_0x5be386(0x1db)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0xb8410d[_0x5be386(0x197)]()[_0x5be386(0x1c2)]()[_0x5be386(0xe3)](0x2,'0')+'\x20'+_0xb8410d[_0x5be386(0x153)]()[_0x5be386(0x1c2)]()['padStart'](0x2,'0')+':'+_0xb8410d[_0x5be386(0x14d)]()[_0x5be386(0x1c2)]()[_0x5be386(0xe3)](0x2,'0')+':'+_0xb8410d['getSeconds']()[_0x5be386(0x1c2)]()[_0x5be386(0xe3)](0x2,'0');}function getTimeStamp(){const _0x11bdb6=_0x231898,_0x2412c5=shiftedTime();return _0x2412c5[_0x11bdb6(0x144)]()+'/'+(_0x2412c5['getMonth']()+0x1)[_0x11bdb6(0x1c2)]()[_0x11bdb6(0xe3)](0x2,'0')+'/'+_0x2412c5[_0x11bdb6(0x197)]()[_0x11bdb6(0x1c2)]()[_0x11bdb6(0xe3)](0x2,'0')+'\x20'+_0x2412c5[_0x11bdb6(0x153)]()['toString']()['padStart'](0x2,'0')+':'+_0x2412c5[_0x11bdb6(0x14d)]()[_0x11bdb6(0x1c2)]()[_0x11bdb6(0xe3)](0x2,'0')+':'+_0x2412c5[_0x11bdb6(0x16c)]()[_0x11bdb6(0x1c2)]()[_0x11bdb6(0xe3)](0x2,'0');}function shiftedTime(){const _0x1ef248=_0x231898,_0x5c4749=new Date();let _0x4385b6=_0x5c4749;if(settings[_0x1ef248(0x1c1)]&&settings[_0x1ef248(0x1c1)]!==0x0)_0x4385b6=fns[_0x1ef248(0x166)](_0x5c4749,{'hours':settings[_0x1ef248(0x1c1)]});return _0x4385b6;}function startScheduler(){const _0xeab7cd=_0x231898;let _0x20b168=new Date()[_0xeab7cd(0x15b)]();_0x20b168==0x1&&backupConfigFiles();_0x20b168==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x3d9a6d=_0x231898;fs[_0x3d9a6d(0x19c)](configpath,{'withFileTypes':!![]})[_0x3d9a6d(0x1f9)](_0x167ebc=>{const _0x24c49c=_0x3d9a6d;if(!_0x167ebc[_0x24c49c(0x133)]())fs[_0x24c49c(0x11e)](configpath+_0x167ebc[_0x24c49c(0x1c4)],configbackuppath+_0x167ebc[_0x24c49c(0x1c4)]);});}function triggerAnalytics(){const _0x405024=_0x231898;analytics[_0x405024(0x174)]({'title':_0x405024(0xda),'href':_0x405024(0x11a),'path':'/v'+serverversion});}function validateCredentials(_0x47d9fa,_0x19cec8){const _0x317985=_0x231898;if(_0x47d9fa['username']==settings[_0x317985(0x131)]&&bcrypt['compareSync'](_0x47d9fa[_0x317985(0x101)],settings[_0x317985(0x161)])){if(settings[_0x317985(0x135)])return{'allow':![],'reason':_0x317985(0xf4),'token':null};else{const _0x5dac4c=generateLoginToken(_0x19cec8);return{'allow':!![],'reason':_0x317985(0x142),'token':_0x5dac4c};}}else return{'allow':![],'reason':_0x317985(0x181),'token':null};}function refreshToken(_0x4e4ad8){const _0x4dcde7=_0x231898,_0x2808f2=generateLoginToken(_0x4e4ad8);return{'allow':!![],'reason':_0x4dcde7(0x142),'token':_0x2808f2};}function validateAccess(_0x382f0b,_0x3f0829){const _0x4f03e5=_0x231898;let _0x335020=devices[_0x3f0829]['ip'],_0x13c82a;const _0x30e0d5=_0x399d22=>{const _0x46996a=_0x1d28;if(settings[_0x46996a(0x200)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x3f0829)){const _0x48890e=generateLoginToken(_0x3f0829);return{'allow':!![],'reason':_0x46996a(0x102),'token':_0x48890e};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x13c82a=validToken(_0x399d22,_0x3f0829),_0x13c82a['hasOwnProperty']('success')?{'allow':!![],'reason':_0x46996a(0x1d8),'token':_0x399d22}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x46996a(0x1bd),'token':null};};if(settings['whitelistEnabled']){let _0x2e91ee=[...settings[_0x4f03e5(0x117)],_0x4f03e5(0xcf),_0x4f03e5(0x211),_0x4f03e5(0x156)];if(_0x2e91ee[_0x4f03e5(0x1ef)](_0x335020))return _0x30e0d5(_0x382f0b);else{_0x13c82a=validToken(_0x382f0b,_0x3f0829);if(_0x13c82a['hasOwnProperty'](_0x4f03e5(0x204)))return _0x30e0d5(_0x382f0b);else{if(telegramIpApproved(_0x3f0829)){const _0x18b32f=generateToken(_0x3f0829);return _0x13c82a=_0x30e0d5(_0x382f0b),_0x13c82a[_0x4f03e5(0x175)]?{'allow':!![],'reason':_0x4f03e5(0x20b),'token':_0x18b32f}:_0x13c82a;}else return settings[_0x4f03e5(0x1b8)]?{'allow':![],'reason':_0x4f03e5(0x1b3),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x30e0d5(_0x382f0b);}function timelyDecrypt(_0x3afab9,_0x215561=!![]){const _0x11b879=_0x231898;if(_0x3afab9)try{const _0x4dc8af=crypt[_0x11b879(0x132)](secure['privateKey'],_0x3afab9)[_0x11b879(0x10c)],_0x49a842=_0x4dc8af['split']('@')[0x0],_0x1f23f7=_0x4dc8af['split']('@')[0x1],_0x10d86a=new Date()[_0x11b879(0x13a)]();if(_0x215561){if(_0x10d86a-_0x1f23f7<maxSecretAge*0x3e8)return _0x49a842;else return![];}else return _0x49a842;}catch(_0x2c74c6){return![];}else return![];}const validToken=(_0x165adc,_0x401cdb)=>{const _0x2d8a75=_0x231898,_0x13f9d2=devices[_0x401cdb]['ip'];if(!_0x165adc)return{'error':_0x2d8a75(0xcd)};for(let _0x4351eb of blacklist){if(_0x4351eb[_0x2d8a75(0x1e9)]==_0x165adc)return{'error':_0x2d8a75(0xeb)};}let _0x36b4e6;try{_0x36b4e6=jwt[_0x2d8a75(0xe9)](_0x165adc,secure['secret']+_0x401cdb);}catch{return{'error':_0x2d8a75(0x1a4)};}if(!_0x36b4e6[_0x2d8a75(0x140)](_0x2d8a75(0x1be))&&!_0x36b4e6[_0x2d8a75(0x140)](_0x2d8a75(0x172))||!_0x36b4e6[_0x2d8a75(0x140)](_0x2d8a75(0xf2)))return{'error':_0x2d8a75(0x1e2)};if(!_0x36b4e6[_0x2d8a75(0x140)](_0x2d8a75(0x172))&&_0x36b4e6['hasOwnProperty']('clientip')){const {clientip:_0x4ca497}=_0x36b4e6;return _0x13f9d2==_0x4ca497?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x2d8a75(0x15c)};}else{if(_0x36b4e6[_0x2d8a75(0x140)](_0x2d8a75(0x172))&&_0x36b4e6[_0x2d8a75(0x140)]('clientip')){const {username:_0x463a10,clientip:_0x14baf4}=_0x36b4e6;return settings[_0x2d8a75(0x131)]==_0x463a10&&_0x13f9d2==_0x14baf4?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x4c3847=>{const _0xb380b5=_0x231898;if(_0x4c3847){const _0x52db5a=devices[_0x4c3847]['ip'];return jwt[_0xb380b5(0x1d9)]({'username':settings['bbUsername'],'clientip':_0x52db5a},secure[_0xb380b5(0x1dc)]+_0x4c3847,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x144fa5=>{const _0x169ff7=_0x231898;if(_0x144fa5){const _0x41f5f0=devices[_0x144fa5]['ip'];return jwt[_0x169ff7(0x1d9)]({'clientip':_0x41f5f0},secure['secret']+_0x144fa5,{'expiresIn':devices[_0x144fa5][_0x169ff7(0x17a)][_0x169ff7(0x121)]*0x3c});}else return![];},telegramIpApproved=_0x18ba63=>{const _0x2215bb=_0x231898;let _0x3ee94b=![];return devices[_0x18ba63][_0x2215bb(0x17a)]&&devices[_0x18ba63][_0x2215bb(0x17a)][_0x2215bb(0x121)]!=_0x2215bb(0x107)&&(_0x3ee94b=devices[_0x18ba63][_0x2215bb(0x17a)]['clientip']==devices[_0x18ba63]['ip']&&new Date()[_0x2215bb(0x13a)]()-devices[_0x18ba63][_0x2215bb(0x17a)][_0x2215bb(0x118)]<devices[_0x18ba63][_0x2215bb(0x17a)]['expiry']*0x3c*0x3e8),_0x3ee94b;},telegram2FaApproved=_0x37b457=>{const _0x4518fa=_0x231898;let _0x4d8d2e=![];return devices[_0x37b457][_0x4518fa(0x203)]&&devices[_0x37b457][_0x4518fa(0x203)][_0x4518fa(0x121)]!=_0x4518fa(0x107)&&(_0x4d8d2e=devices[_0x37b457][_0x4518fa(0x203)][_0x4518fa(0x1be)]==devices[_0x37b457]['ip']&&new Date()[_0x4518fa(0x13a)]()-devices[_0x37b457][_0x4518fa(0x203)][_0x4518fa(0x118)]<devices[_0x37b457]['telegram2FaApproval'][_0x4518fa(0x121)]*0x3c*0x3e8),_0x4d8d2e;},normalizeIP=_0x12d1a3=>{const _0x12fa8c=_0x231898;let _0x393933=null,_0x2dcc2b=null;if(ipaddr[_0x12fa8c(0x1e1)](_0x12d1a3)){const _0x3410de=ipaddr['parse'](_0x12d1a3);_0x3410de[_0x12fa8c(0x168)]()==='ipv6'?(_0x3410de[_0x12fa8c(0x1ee)]()&&(_0x393933=_0x3410de[_0x12fa8c(0x1c5)]()[_0x12fa8c(0x1c2)]()),_0x2dcc2b=_0x3410de[_0x12fa8c(0x1c2)]()):(_0x393933=_0x3410de[_0x12fa8c(0x1c2)](),_0x2dcc2b=_0x3410de['toIPv4MappedAddress']()[_0x12fa8c(0x1c2)]());}return{'show':_0x393933?_0x393933:_0x2dcc2b,'store':_0x2dcc2b};};