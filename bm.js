const _0x348b51=_0x2236;(function(_0x103d2c,_0x325399){const _0x774aae=_0x2236,_0x32be4a=_0x103d2c();while(!![]){try{const _0x46a3a6=-parseInt(_0x774aae(0xb1))/0x1+-parseInt(_0x774aae(0x29e))/0x2*(parseInt(_0x774aae(0x200))/0x3)+-parseInt(_0x774aae(0xe6))/0x4*(parseInt(_0x774aae(0x134))/0x5)+-parseInt(_0x774aae(0x16f))/0x6*(-parseInt(_0x774aae(0x268))/0x7)+parseInt(_0x774aae(0x1bd))/0x8+parseInt(_0x774aae(0x1f4))/0x9+parseInt(_0x774aae(0x137))/0xa*(parseInt(_0x774aae(0x281))/0xb);if(_0x46a3a6===_0x325399)break;else _0x32be4a['push'](_0x32be4a['shift']());}catch(_0x59d53e){_0x32be4a['push'](_0x32be4a['shift']());}}}(_0x418d,0x422a2));const _0x211539=function(){let _0x181f62=!![];return function(_0x3eb4f2,_0x7cf117){const _0x577be3=_0x181f62?function(){const _0x290a82=_0x2236;if(_0x7cf117){const _0x4c5a36=_0x7cf117[_0x290a82(0x241)](_0x3eb4f2,arguments);return _0x7cf117=null,_0x4c5a36;}}:function(){};return _0x181f62=![],_0x577be3;};}(),_0x1bded9=_0x211539(this,function(){const _0x140283=_0x2236;return _0x1bded9[_0x140283(0x9b)]()[_0x140283(0x264)](_0x140283(0x106))['toString']()['constructor'](_0x1bded9)[_0x140283(0x264)](_0x140283(0x106));});_0x1bded9();'use strict';process[_0x348b51(0x142)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x348b51(0x1d4)),fs=require('fs'),fns=require(_0x348b51(0x1cf)),low=require('lowdb'),FileSync=require(_0x348b51(0xad)),path=require(_0x348b51(0x19b)),crypto=require(_0x348b51(0x1a3)),Crypt=require(_0x348b51(0x129))[_0x348b51(0x10f)],RSA=require(_0x348b51(0x129))[_0x348b51(0x1bf)],bcrypt=require(_0x348b51(0xa2)),jwt=require(_0x348b51(0x254)),ipaddr=require(_0x348b51(0x1db)),argv=require('yargs/yargs')(process['argv'][_0x348b51(0x1d6)](0x2))[_0x348b51(0x17e)],uuidRandom=require(_0x348b51(0xda)),{Telegraf,Markup}=require(_0x348b51(0x18f)),Mixpanel=require(_0x348b51(0xc8)),axios=require(_0x348b51(0x240)),{GraphQLClient,gql}=require(_0x348b51(0xc2)),util=require('util'),fileUpload=require(_0x348b51(0x26a)),{networkInterfaces}=require('os'),PORT=argv[_0x348b51(0xcd)]||_0x348b51(0x1ee),pattern=/^[0-9]{2,4}$/;!pattern[_0x348b51(0x198)](PORT)&&(console['log'](_0x348b51(0x15b)+PORT+_0x348b51(0x27e)),process['exit'](0x1));const HOST=argv[_0x348b51(0x1dd)]||null,userID=argv[_0x348b51(0x156)]||'',debugging=argv['d']||![],nodeversion=process[_0x348b51(0x199)][_0x348b51(0xdf)];let bbpath='bb/',bbpath2='';const botfile=_0x348b51(0x19f),configfile=_0x348b51(0x190),settingsfile='bb-settings.json',securefile=_0x348b51(0xba),environment=require('./'+bbpath2+_0x348b51(0x226))[_0x348b51(0x143)]||'production',maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x348b51(0xbf)),configpath=userID?bbpath+_0x348b51(0x29d)+userID+'/':bbpath+_0x348b51(0x29d),configbackuppath=configpath+_0x348b51(0xa6),logspath=userID?bbpath+_0x348b51(0x131)+userID+'/':bbpath+_0x348b51(0x131),zippath=userID?bbpath+_0x348b51(0x1e6)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x348b51(0x179)](logspath+_0x348b51(0x222),{'flags':'a'}),temppath=userID?bbpath+_0x348b51(0x258)+userID+'/':bbpath+_0x348b51(0x258);!fs[_0x348b51(0x121)](configpath)&&fs[_0x348b51(0x1d3)](configpath);!fs[_0x348b51(0x121)](configbackuppath)&&fs[_0x348b51(0x1d3)](configbackuppath);!fs[_0x348b51(0x121)](logspath)&&fs[_0x348b51(0x1d3)](logspath);!fs[_0x348b51(0x121)](zippath)&&fs[_0x348b51(0x1d3)](zippath);!fs['existsSync'](temppath)&&fs[_0x348b51(0x1d3)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x348b51(0x152)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x348b51(0x25b)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x348b51(0x14e),'onepagemode':![]}})[_0x348b51(0x152)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x348b51(0x21c),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x348b51(0x257),{'host':_0x348b51(0x1e7)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x348b51(0x1c0)]&&(settings['telegramToken']!=''&&settings[_0x348b51(0x1c0)]!=_0x348b51(0x161))&&settings['telegramUsername']&&settings[_0x348b51(0x22b)]!='')initTelegram();const parseColor=(_0xfc6538,_0x128364)=>{const _0x4e55a1=_0x348b51,_0x4383f6=/#[A-Z]{3}#/g;if(typeof _0xfc6538=='string'){!_0x128364?_0xfc6538=_0xfc6538[_0x4e55a1(0x12a)](_0x4383f6,''):(_0xfc6538=_0xfc6538[_0x4e55a1(0x12a)](/#BLU#/g,_0x4e55a1(0xe3)),_0xfc6538=_0xfc6538[_0x4e55a1(0x12a)](/#RED#/g,'\x1b[31m'),_0xfc6538=_0xfc6538[_0x4e55a1(0x12a)](/#YEL#/g,_0x4e55a1(0x28f)),_0xfc6538=_0xfc6538[_0x4e55a1(0x12a)](/#MAG#/g,'\x1b[35m'),_0xfc6538=_0xfc6538[_0x4e55a1(0x12a)](/#CYA#/g,_0x4e55a1(0xf9)),_0xfc6538=_0xfc6538[_0x4e55a1(0x12a)](/#RES#/g,'\x1b[0m'));;}return _0xfc6538;},logger={'screen':_0x372549=>{console['log'](parseColor(_0x372549,!![]));},'simple':_0x408b3e=>{const _0x217ed6=_0x348b51;console['log'](parseColor(_0x408b3e,!![])),loggerfile[_0x217ed6(0x152)](util[_0x217ed6(0x28c)](parseColor(_0x408b3e,![]))+'\x0a');},'full':async _0x2bce82=>{const _0x198fec=_0x348b51,_0x2fa8ee=getTimeStamp()+_0x198fec(0x165)+_0x2bce82;console[_0x198fec(0xbc)](parseColor(_0x2fa8ee,!![])),loggerfile[_0x198fec(0x152)](util[_0x198fec(0x28c)](parseColor(_0x2fa8ee,![]))+'\x0a');if(tgBot&&settings[_0x198fec(0x285)]&&settings[_0x198fec(0x194)]!='orders')await sendTelegram(settings[_0x198fec(0x285)],_0x198fec(0x130)+parseColor(_0x2bce82,![]));},'debug':async(_0x1e6b89,_0x1194d7='')=>{const _0x1d162b=_0x348b51,_0x17b4ba=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x1e6b89;if(debugging)console['log'](parseColor(_0x17b4ba,!![]));loggerfile[_0x1d162b(0x152)](util['format'](parseColor(_0x17b4ba,![]))+'\x0a');if(_0x1194d7){if(debugging)console['log'](_0x1194d7);loggerfile['write'](util[_0x1d162b(0x28c)](_0x1194d7)+'\x0a');}}};let terminating=![];process['on'](_0x348b51(0x284),function(_0x1d9d43){const _0x1be844=_0x348b51;logger[_0x1be844(0x26d)](_0x1d9d43);}),process['on'](_0x348b51(0xe8),()=>{const _0x340352=_0x348b51;console['log'](_0x340352(0x1e8)),stopAllBots(),process['exit'](0x0);}),process['on'](_0x348b51(0x117),()=>{const _0x162c5d=_0x348b51;console[_0x162c5d(0xbc)](_0x162c5d(0x238)),stopAllBots(),process[_0x162c5d(0xe8)](0x0);}),process['on'](_0x348b51(0xcb),()=>{const _0x202b9a=_0x348b51;console[_0x202b9a(0xbc)](_0x202b9a(0xd4)),stopAllBots(),process[_0x202b9a(0xe8)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x348b51(0x226))[_0x348b51(0x138)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x348b51(0x1f3)),app=express(),http=require('http')['createServer'](app);app[_0x348b51(0x101)](fileUpload({'useTempFiles':!![]})),app[_0x348b51(0x15f)](_0x348b51(0x24e),async(_0x52cac8,_0x3f77ca)=>{const _0x54973c=_0x348b51,_0x19a126=_0x52cac8[_0x54973c(0x1b3)][_0x54973c(0x1a1)],_0x927254=getClientsWithBotID(_0x54973c(0x1ed)),_0x45e506=_0x52cac8['headers'][_0x54973c(0x28e)],_0x4be1b7=timelyDecrypt(_0x45e506,![]),_0x25f310=_0x927254[_0x54973c(0x136)](_0x55095e=>_0x55095e['uuid']==_0x4be1b7);if(_0x25f310){const _0x3ae05b=normalizeIP(_0x52cac8[_0x54973c(0x185)][_0x54973c(0xa8)])['store'],_0x9f635f=_0x52cac8[_0x54973c(0x1d9)][_0x54973c(0xed)];if(validateAccess(_0x9f635f,_0x4be1b7,_0x3ae05b)[_0x54973c(0x105)])_0x19a126==_0x54973c(0x18b)&&await backupConfigFiles(),await zipFiles(_0x19a126),_0x3f77ca[_0x54973c(0x1de)](zippath+(_0x19a126+_0x54973c(0x1f2)),_0x257f20=>{const _0x514a50=_0x54973c;_0x257f20&&(logger[_0x514a50(0x144)](_0x514a50(0xe2)+_0x19a126),logger[_0x514a50(0x26d)](_0x257f20));});else logger[_0x54973c(0x144)](_0x54973c(0x1e5)+_0x19a126+_0x54973c(0x24f));}else logger[_0x54973c(0x144)](_0x54973c(0x1e5)+_0x19a126+_0x54973c(0xd0));}),app['post'](_0x348b51(0x246),async(_0x5d2165,_0x23b996)=>{const _0x265b45=_0x348b51,_0x29ac3c=getClientsWithBotID(_0x265b45(0x1ed)),_0x3c1824=_0x5d2165[_0x265b45(0x1d9)][_0x265b45(0x28e)],_0x58c9cd=timelyDecrypt(_0x3c1824,![]),_0x10f570=_0x29ac3c['find'](_0x491e18=>_0x491e18[_0x265b45(0x28e)]==_0x58c9cd);logger[_0x265b45(0x23e)](_0x265b45(0x1a2));if(_0x10f570){const _0x2a5c1f=normalizeIP(_0x5d2165['socket'][_0x265b45(0xa8)])[_0x265b45(0x1c9)],_0x589503=_0x5d2165[_0x265b45(0x1d9)][_0x265b45(0xed)];if(validateAccess(_0x589503,_0x58c9cd,_0x2a5c1f)[_0x265b45(0x105)]){if(_0x5d2165[_0x265b45(0x27b)]){const _0x5a8b27=_0x5d2165[_0x265b45(0x27b)]['backupfile'];await _0x5a8b27['mv'](temppath+_0x5a8b27[_0x265b45(0xa1)]),_0x23b996['send']({'status':!![],'message':_0x265b45(0xcc)});const _0x92e149=getBotsWithMode();_0x92e149['length']>0x0?confirmRestore(temppath,_0x5a8b27['name']):unzipFile(temppath,_0x5a8b27[_0x265b45(0xa1)]);}}else logger['full'](_0x265b45(0x158));}else logger[_0x265b45(0x144)](_0x265b45(0x110));}),app['use'](express[_0x348b51(0x1c4)](path[_0x348b51(0x114)](__dirname,bbpath2,_0x348b51(0x237)))),app[_0x348b51(0x101)](express[_0x348b51(0x1c4)](path[_0x348b51(0x114)](__dirname,bbpath2,'build'))),app['get']('/',function(_0x3fc7f5,_0x345e76){const _0x4609cc=_0x348b51;_0x345e76['sendFile'](path['join'](__dirname,bbpath2,_0x4609cc(0x237),'index.html'));}),app[_0x348b51(0x15f)](_0x348b51(0x116),function(_0x3508c0,_0x17d91a){const _0x3a0b34=_0x348b51;_0x17d91a['sendFile'](path['join'](__dirname,bbpath2,_0x3a0b34(0x277),_0x3a0b34(0xb2)));}),app[_0x348b51(0x15f)](_0x348b51(0x294),(_0x57674a,_0x59fb5b)=>{const _0x59a870=_0x348b51;_0x59fb5b[_0x59a870(0x28d)](path[_0x59a870(0x114)](__dirname,bbpath2,_0x59a870(0x277),_0x59a870(0xb2)));}),app['get']('/:bot/performance',(_0x29f3c8,_0x153c81)=>{const _0x8a6613=_0x348b51;_0x153c81[_0x8a6613(0x28d)](path['join'](__dirname,bbpath2,'build',_0x8a6613(0xb2)));}),app[_0x348b51(0x15f)](_0x348b51(0x260),(_0x7ec6d5,_0x36f259)=>{const _0x40ee25=_0x348b51;_0x36f259[_0x40ee25(0x28d)](path[_0x40ee25(0x114)](__dirname,bbpath2,_0x40ee25(0x277),_0x40ee25(0xb2)));}),app[_0x348b51(0x15f)]('/:bot/history',(_0x244c0c,_0x1c646a)=>{const _0x18b316=_0x348b51;_0x1c646a[_0x18b316(0x28d)](path[_0x18b316(0x114)](__dirname,bbpath2,_0x18b316(0x277),_0x18b316(0xb2)));}),app['get']('/:bot/configuration',(_0x298e69,_0x5555d3)=>{const _0x22e4b3=_0x348b51;_0x5555d3[_0x22e4b3(0x28d)](path[_0x22e4b3(0x114)](__dirname,bbpath2,_0x22e4b3(0x277),_0x22e4b3(0xb2)));}),app[_0x348b51(0x15f)](_0x348b51(0x27f),(_0x5a6c45,_0x2db5a8)=>{const _0x210245=_0x348b51;_0x2db5a8[_0x210245(0x28d)](path[_0x210245(0x114)](__dirname,bbpath2,_0x210245(0x277),_0x210245(0xb2)));});if(HOST)http[_0x348b51(0x21f)](PORT,HOST);else http['listen'](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x15dd60=_0x348b51;let _0x3d6340='[ip-address]';const _0x21425a=networkInterfaces(),_0x41724f={};for(const _0x51c838 of Object[_0x15dd60(0xb6)](_0x21425a)){for(const _0x38b40f of _0x21425a[_0x51c838]){if((_0x38b40f[_0x15dd60(0x128)]==_0x15dd60(0x13a)||_0x38b40f[_0x15dd60(0x128)]==0x4)&&!_0x38b40f[_0x15dd60(0x22f)]){const _0x213b6e=ipaddr[_0x15dd60(0x175)](_0x38b40f[_0x15dd60(0x286)])[_0x15dd60(0x1d0)]();_0x213b6e!=_0x15dd60(0x14b)&&(!_0x41724f[_0x51c838]&&(_0x41724f[_0x51c838]=[]),_0x41724f[_0x51c838]['push'](_0x38b40f['address']),_0x3d6340=_0x38b40f[_0x15dd60(0x286)]);}}}return{'serverip':_0x3d6340,'netinterfaces':_0x41724f};}async function startServer(){const _0x214048=_0x348b51,{serverip:_0xd53ecc,netinterfaces:_0x309f48}=getServerIP();logger[_0x214048(0x26d)](''),logger['simple'](_0x214048(0xbb)),await logger['full']('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x214048(0x13d)+(environment=='staging'?_0x214048(0x24c):'')+'\x0a'+(_0x214048(0x189)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x214048(0x24d)+_0xd53ecc+':'+PORT+_0x214048(0x196))),logger[_0x214048(0x26d)](_0x214048(0xbb));if(config[_0x214048(0x26b)]!=0x0)for(const _0x4f8682 of config){const _0x402b23=_0x4f8682[_0x214048(0xd9)]==_0x214048(0xbd)?'a':'m';if(_0x4f8682[_0x214048(0x1d2)]=='enabled'||_0x4f8682[_0x214048(0x1d2)]==_0x214048(0x102))await logger[_0x214048(0x144)](_0x214048(0x170)+_0x402b23+_0x214048(0x168)+_0x4f8682[_0x214048(0x23f)]+_0x214048(0xb5)+_0x4f8682['botname']),startBot([_0x4f8682[_0x214048(0x23f)],userID],{'cwd':bbpath},function(_0x54aced){if(_0x54aced)logger['full'](_0x54aced);});else(_0x4f8682[_0x214048(0x1d2)]=='disabled'||_0x4f8682['status']==_0x214048(0x287))&&await logger['full'](_0x214048(0x239)+_0x402b23+_0x214048(0x1d5)+_0x4f8682[_0x214048(0x23f)]+_0x214048(0xb5)+_0x4f8682['botname']);}else!newBot&&logger[_0x214048(0x26d)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x214048(0x26d)](_0x214048(0xbb)),logger[_0x214048(0x26d)](''),await logger['debug'](_0x214048(0x220)+nodeversion),await logger[_0x214048(0x23e)](_0x214048(0x10b),_0x309f48);}function startSocket(){io['on']('connection',_0xd48307=>{const _0x1fa351=_0x2236;let _0x5db873,_0x369909,_0x871b9e,_0x36f29f,_0x49ceb8;const _0x4adb1a=_0xd48307[_0x1fa351(0x202)][_0x1fa351(0x1d9)][_0x1fa351(0x151)];_0x369909=_0x4adb1a[_0x1fa351(0x1ea)](/bot[0-9]{3}/);if(_0x369909)_0x871b9e=_0x369909[0x0]['match'](/[0-9]{3}/);if(_0x871b9e)_0x5db873=_0x871b9e[0x0];else _0x5db873=_0x1fa351(0x1ed);const _0x51e1d4=_0xd48307[_0x1fa351(0x202)][_0x1fa351(0x265)][_0x1fa351(0x1fe)];if(!_0x51e1d4)_0xd48307[_0x1fa351(0x124)](_0x1fa351(0x1d2),{'publicKey':secure[_0x1fa351(0x26f)]});else{_0x36f29f=timelyDecrypt(_0x51e1d4,![]);if(!_0x36f29f)_0xd48307[_0x1fa351(0x124)](_0x1fa351(0x1d2),{'publicKey':secure[_0x1fa351(0x26f)]});else{_0x49ceb8=normalizeIP(_0xd48307[_0x1fa351(0x159)][_0x1fa351(0xa8)])[_0x1fa351(0x1c9)];if(!devices[_0x36f29f])devices[_0x36f29f]={'uuid':_0x36f29f,'access':{'token':null}};devices[_0x36f29f]['ip']=_0x49ceb8;const _0x2a084e=addClient(_0xd48307['id'],_0x36f29f,_0x5db873);setAccess(_0x2a084e),emitMessages(),_0xd48307['on']('login',_0x231628=>{const _0x572b73=_0x1fa351,_0x2342c3=timelyDecrypt(_0x231628[_0x572b73(0x205)]);if(_0x2342c3){_0x231628={'username':_0x231628[_0x572b73(0x28b)],'password':_0x2342c3},devices[_0x36f29f][_0x572b73(0x13c)]=validateCredentials(_0x231628,_0x36f29f);if(devices[_0x36f29f]['access'][_0x572b73(0x105)]==![]&&devices[_0x36f29f][_0x572b73(0x13c)][_0x572b73(0x21e)]==_0x572b73(0x1c6))_0xd48307[_0x572b73(0x124)](_0x572b73(0x1d2),{'access':devices[_0x36f29f][_0x572b73(0x13c)]}),loginAccess2FA(_0x36f29f,_0x49ceb8);else{if(devices[_0x36f29f][_0x572b73(0x13c)][_0x572b73(0x105)]==![]&&devices[_0x36f29f][_0x572b73(0x13c)][_0x572b73(0x21e)]==_0x572b73(0xc3))_0xd48307[_0x572b73(0x124)](_0x572b73(0x1d2),{'access':devices[_0x36f29f][_0x572b73(0x13c)]});else devices[_0x36f29f][_0x572b73(0x13c)][_0x572b73(0x105)]&&devices[_0x36f29f]['access'][_0x572b73(0x21e)]==_0x572b73(0x1c3)&&(getClientsWithUuid(_0x36f29f)[_0x572b73(0x148)](_0x5751df=>{setAccess(_0x5751df);}),logger['debug'](_0x572b73(0x109)+_0x36f29f[_0x572b73(0x1d6)](-0x8)),setTokenRefresh(_0x36f29f),setSessionTimeout('login',_0x36f29f));}}else logger[_0x572b73(0x144)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0xd48307['on'](_0x1fa351(0x133),()=>{resetPassword();}),_0xd48307['on'](_0x1fa351(0x1ff),_0x156ea8=>{removeClient(_0xd48307['id']);}),_0x5db873==_0x1fa351(0x1ed)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x57dd55){const _0x229a01=_0x348b51;if(_0x57dd55!='botmanager'&&config[_0x229a01(0x290)]!=''){if(pid[_0x57dd55])pid[_0x57dd55]['send']({'function':_0x229a01(0x111),'args':null});}_0x57dd55!=_0x229a01(0x1ed)&&broadcastToBots(_0x229a01(0x15a),JSON[_0x229a01(0x115)](config));}function reloadBotManager(){const _0x43f0c3=_0x348b51;getClientsWithBotID(_0x43f0c3(0x1ed))[_0x43f0c3(0x148)](_0x1ec0f8=>{const _0x3dccda=_0x43f0c3;getSocket(_0x1ec0f8['id'])['emit'](_0x3dccda(0x1d2),{'access':{'allow':![],'reason':_0x3dccda(0x186),'token':null}});});}function getSocket(_0x35e661){const _0x841b43=_0x348b51;return io[_0x841b43(0x1fb)][_0x841b43(0x1fb)][_0x841b43(0x15f)](_0x35e661);}function setAccess(_0x188000){const _0x80d555=_0x348b51,_0x72d2b0=getSocket(_0x188000['id']),_0x28aef1=_0x188000[_0x80d555(0x28e)],_0x1fda75=_0x188000[_0x80d555(0x147)];devices[_0x28aef1][_0x80d555(0x13c)]=validateAccess(devices[_0x28aef1]['access'][_0x80d555(0x112)],_0x28aef1),logger[_0x80d555(0x23e)](_0x80d555(0x25e)+devices[_0x28aef1][_0x80d555(0x13c)][_0x80d555(0x21e)]+'\x20|\x20client:\x20...'+_0x188000['id'][_0x80d555(0x1d6)](-0x8)+_0x80d555(0x25c)+_0x28aef1[_0x80d555(0x1d6)](-0x8)),_0x72d2b0['join'](_0x28aef1);if(devices[_0x28aef1][_0x80d555(0x13c)][_0x80d555(0x105)]){_0x72d2b0[_0x80d555(0x114)](_0x1fda75);if(_0x1fda75=='botmanager')initializeSocketBotManager(_0x72d2b0);else initializeSocketBot(_0x72d2b0);initClient(_0x1fda75);}devices[_0x28aef1][_0x80d555(0x13c)][_0x80d555(0x112)]&&devices[_0x28aef1]['access'][_0x80d555(0x21e)]=='temporary\x20token\x20generated'&&setSessionTimeout('2FA',_0x28aef1),devices[_0x28aef1][_0x80d555(0x13c)]['token']&&devices[_0x28aef1]['access'][_0x80d555(0x21e)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x80d555(0x10d),_0x28aef1),_0x72d2b0[_0x80d555(0x124)](_0x80d555(0x1d2),{'status':_0x188000['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x28aef1][_0x80d555(0x13c)],'externalip':devices[_0x28aef1]['ip'],'publicKey':secure[_0x80d555(0x26f)],'userid':settings[_0x80d555(0x25a)],'validInstallation':validInstallation}),devices[_0x28aef1]['access'][_0x80d555(0x105)]==![]&&devices[_0x28aef1][_0x80d555(0x13c)]['reason']=='2FA\x20required'&&temporaryAccess2FA(_0x28aef1,devices[_0x28aef1]['ip']);}function setSessionTimeout(_0x2149b2,_0x2d9428){const _0x15de64=_0x348b51;let _0x326981;if(_0x2149b2=='login')_0x326981=loginExpiry*0x3c*0x3e8;else _0x326981=devices[_0x2d9428]['telegramIpApproval'][_0x15de64(0xce)]*0x3c*0x3e8-(new Date()[_0x15de64(0x280)]()-devices[_0x2d9428][_0x15de64(0x299)][_0x15de64(0x297)]);if(devices[_0x2d9428][_0x15de64(0x1d1)])clearTimeout(devices[_0x2d9428][_0x15de64(0x1d1)]);devices[_0x2d9428]['pidExpireLogin']=setTimeout(()=>{const _0x1ec3a9=_0x15de64;if(devices[_0x2d9428]['pidRefreshToken'])clearTimeout(devices[_0x2d9428][_0x1ec3a9(0x1da)]);removeSocketListeners(_0x2d9428),addBlacklist(_0x2d9428),devices[_0x2d9428][_0x1ec3a9(0x299)]=null,devices[_0x2d9428][_0x1ec3a9(0x29b)]=null,devices[_0x2d9428][_0x1ec3a9(0x13c)][_0x1ec3a9(0x112)]=null,logger[_0x1ec3a9(0x23e)](_0x1ec3a9(0x273)+_0x2d9428[_0x1ec3a9(0x1d6)](-0x8)),devices[_0x2d9428][_0x1ec3a9(0x13c)]=validateAccess(devices[_0x2d9428][_0x1ec3a9(0x13c)]['token'],_0x2d9428),!(devices[_0x2d9428]['access'][_0x1ec3a9(0x105)]&&devices[_0x2d9428][_0x1ec3a9(0x13c)][_0x1ec3a9(0x21e)]==_0x1ec3a9(0x12c))&&(_0x2149b2==_0x1ec3a9(0x10d)?io['to'](_0x2d9428)['emit'](_0x1ec3a9(0x1d2),{'access':{'allow':![],'reason':_0x1ec3a9(0x278),'token':null}}):io['to'](_0x2d9428)[_0x1ec3a9(0x124)](_0x1ec3a9(0x1d2),{'access':{'allow':![],'reason':_0x1ec3a9(0x216),'token':null}})),devices[_0x2d9428][_0x1ec3a9(0x13c)][_0x1ec3a9(0x112)]=null;},_0x326981);}function setTokenRefresh(_0x430578){const _0xd2ee95=_0x348b51;if(devices[_0x430578][_0xd2ee95(0x1da)])clearTimeout(devices[_0x430578][_0xd2ee95(0x1da)]);devices[_0x430578][_0xd2ee95(0x1da)]=setTimeout(()=>{const _0x142e99=_0xd2ee95;getClientsWithUuid(_0x430578)[_0x142e99(0x26b)]!=0x0?(devices[_0x430578][_0x142e99(0x13c)]=refreshToken(_0x430578),io['to'](_0x430578)[_0x142e99(0x124)]('status',{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x430578]['access'],'externalip':devices[_0x430578]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x430578)):clearTimeout(devices[_0x430578][_0x142e99(0x1da)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1170de){const _0x1a9eeb=_0x348b51,_0x123c00=getClient(_0x1170de['id'])[_0x1a9eeb(0x28e)];_0x1170de['emit'](_0x1a9eeb(0x15a),config),_0x1170de[_0x1a9eeb(0x124)](_0x1a9eeb(0x15c),cleanSettings()),_0x1170de['on']('add-bot',_0x5735b8=>{const _0x24a536=_0x1a9eeb;if(validateAccess(_0x5735b8,_0x123c00)[_0x24a536(0x105)])addBot();else logger[_0x24a536(0x144)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x1170de['on'](_0x1a9eeb(0x11b),(_0x3abe51,_0x16c775)=>{const _0x1cd19a=_0x1a9eeb;if(validateAccess(_0x16c775,_0x123c00)[_0x1cd19a(0x105)])toggleBot(_0x3abe51[_0x1cd19a(0x23f)],_0x3abe51[_0x1cd19a(0x1d2)],_0x3abe51[_0x1cd19a(0xe0)]);else logger[_0x1cd19a(0x144)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x1170de['on'](_0x1a9eeb(0x1fa),(_0x1b87ad,_0x2f4488)=>{const _0xffa56f=_0x1a9eeb;if(validateAccess(_0x2f4488,_0x123c00)['allow'])toggleBotMode(_0x1b87ad);else logger[_0xffa56f(0x144)](_0xffa56f(0x104));}),_0x1170de['on'](_0x1a9eeb(0x163),(_0x566a48,_0x16b5c6)=>{const _0x22dd7c=_0x1a9eeb;if(validateAccess(_0x16b5c6,_0x123c00)['allow'])deleteBot(_0x566a48);else logger[_0x22dd7c(0x144)](_0x22dd7c(0x1b8));}),_0x1170de['on']('store-settings',(_0x4ee76e,_0x526f51)=>{const _0x3ff93f=_0x1a9eeb;if(validateAccess(_0x526f51,_0x123c00)[_0x3ff93f(0x105)])storeSettings(_0x4ee76e,!![]);else logger[_0x3ff93f(0x144)](_0x3ff93f(0x145));}),_0x1170de['on'](_0x1a9eeb(0xdb),_0x250160=>{const _0x5d98da=_0x1a9eeb;if(validateAccess(_0x250160,_0x123c00)['allow'])updateBB('update');else logger[_0x5d98da(0x144)](_0x5d98da(0x11d));}),_0x1170de['on'](_0x1a9eeb(0xaf),_0x2a6c82=>{const _0x28fd5a=_0x1a9eeb;if(validateAccess(_0x2a6c82,_0x123c00)[_0x28fd5a(0x105)])updateBB(_0x28fd5a(0x14d));else logger[_0x28fd5a(0x144)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x1170de['on']('get-backup-files',_0x337ca2=>{const _0x1bd4e0=_0x1a9eeb;if(validateAccess(_0x337ca2,_0x123c00)[_0x1bd4e0(0x105)]){const _0x513d40=getClient(_0x1170de['id']);if(_0x513d40)getBackupFiles(_0x513d40[_0x1bd4e0(0x28e)]);else logger[_0x1bd4e0(0x144)](_0x1bd4e0(0x197));}else logger[_0x1bd4e0(0x144)](_0x1bd4e0(0x23a));}),_0x1170de['on']('restore-backup-file',(_0x107485,_0x4db64a)=>{const _0x2a9d37=_0x1a9eeb;if(validateAccess(_0x4db64a,_0x123c00)['allow'])restoreBackupFile(_0x107485);else logger[_0x2a9d37(0x144)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x1170de['on']('get-messages',_0x2364a5=>{const _0x1fd309=_0x1a9eeb;if(validateAccess(_0x2364a5,_0x123c00)['allow'])getMessages();else logger[_0x1fd309(0x144)](_0x1fd309(0x127));}),_0x1170de['on'](_0x1a9eeb(0xd3),(_0x571413,_0x56ec26)=>{const _0x1a4c51=_0x1a9eeb;if(validateAccess(_0x56ec26,_0x123c00)[_0x1a4c51(0x105)])confirmMessage(_0x571413);else logger[_0x1a4c51(0x144)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x1170de['on'](_0x1a9eeb(0x232),_0x343680=>{const _0x100269=_0x1a9eeb;if(validateAccess(_0x343680,_0x123c00)[_0x100269(0x105)]){if(devices[_0x123c00]['pidRefreshToken'])clearTimeout(devices[_0x123c00][_0x100269(0x1da)]);if(devices[_0x123c00][_0x100269(0x1d1)])clearTimeout(devices[_0x123c00][_0x100269(0x1d1)]);removeSocketListeners(getClient(_0x1170de['id'])[_0x100269(0x28e)]),addBlacklist(_0x123c00),devices[_0x123c00][_0x100269(0x299)]=null,devices[_0x123c00][_0x100269(0x29b)]=null,devices[_0x123c00][_0x100269(0x13c)][_0x100269(0x112)]=null,logger[_0x100269(0x23e)](_0x100269(0x11a)+_0x123c00[_0x100269(0x1d6)](-0x8)),io['to'](getClient(_0x1170de['id'])[_0x100269(0x28e)])['emit'](_0x100269(0x1d2),{'access':{'allow':![],'reason':_0x100269(0x162),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x460a2a){const _0x548ca9=_0x348b51,_0x298b33=getClient(_0x460a2a['id'])[_0x548ca9(0x147)],_0x29e7f7=getClient(_0x460a2a['id'])[_0x548ca9(0x28e)];_0x460a2a['on']('get-logs',(_0x440703,_0x4ce2b7)=>{const _0x5607b2=_0x548ca9;if(validateAccess(_0x4ce2b7,_0x29e7f7)[_0x5607b2(0x105)]){if(pid[_0x298b33])pid[_0x298b33][_0x5607b2(0x1ef)]({'function':_0x5607b2(0x140),'args':_0x440703});}else logger[_0x5607b2(0x144)](_0x5607b2(0x1a8));}),_0x460a2a['on'](_0x548ca9(0x171),(_0x2fa65d,_0x37a6db)=>{const _0x5f4b1c=_0x548ca9;if(validateAccess(_0x37a6db,_0x29e7f7)['allow']){if(pid[_0x298b33])pid[_0x298b33][_0x5f4b1c(0x1ef)]({'function':_0x5f4b1c(0x1b0),'args':_0x2fa65d});}else logger[_0x5f4b1c(0x144)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x460a2a['on'](_0x548ca9(0xc6),(_0x109ac7,_0x1c5d30)=>{const _0x3582d6=_0x548ca9;if(validateAccess(_0x1c5d30,_0x29e7f7)[_0x3582d6(0x105)]){if(pid[_0x298b33])pid[_0x298b33][_0x3582d6(0x1ef)]({'function':_0x3582d6(0x18a),'args':_0x109ac7});}else logger['full'](_0x3582d6(0x10c));}),_0x460a2a['on']('store-configuration',(_0xd8b658,_0x28acbe)=>{const _0x460d2c=_0x548ca9;if(validateAccess(_0x28acbe,_0x29e7f7)[_0x460d2c(0x105)]){if(pid[_0x298b33])pid[_0x298b33][_0x460d2c(0x1ef)]({'function':_0x460d2c(0x1ac),'args':_0xd8b658});}else logger[_0x460d2c(0x144)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x460a2a['on']('store-headless',(_0x5cd995,_0x106add)=>{const _0xbf372e=_0x548ca9;if(validateAccess(_0x106add,_0x29e7f7)[_0xbf372e(0x105)]){if(pid[_0x298b33])pid[_0x298b33]['send']({'function':_0xbf372e(0xb4),'args':_0x5cd995});}else logger[_0xbf372e(0x144)](_0xbf372e(0xac));}),_0x460a2a['on'](_0x548ca9(0x1a4),(_0x39bbe4,_0x1624f3)=>{const _0x202f61=_0x548ca9;if(validateAccess(_0x1624f3,_0x29e7f7)[_0x202f61(0x105)]){if(pid[_0x298b33])pid[_0x298b33]['send']({'function':_0x202f61(0xfe),'args':_0x39bbe4});}else logger[_0x202f61(0x144)](_0x202f61(0x12e));}),_0x460a2a['on'](_0x548ca9(0x1f6),_0x3f4db0=>{const _0x18a179=_0x548ca9;if(validateAccess(_0x3f4db0,_0x29e7f7)[_0x18a179(0x105)]){if(pid[_0x298b33])pid[_0x298b33]['send']({'function':_0x18a179(0x251),'args':null});}else logger[_0x18a179(0x144)](_0x18a179(0xf0));}),_0x460a2a['on'](_0x548ca9(0x23b),_0x5ac979=>{const _0x505499=_0x548ca9;if(validateAccess(_0x5ac979,_0x29e7f7)[_0x505499(0x105)]){if(pid[_0x298b33])pid[_0x298b33][_0x505499(0x1ef)]({'function':_0x505499(0xdd),'args':null});}else logger['full'](_0x505499(0x201));}),_0x460a2a['on'](_0x548ca9(0x1e3),(_0x287af1,_0x45e729)=>{const _0x418aad=_0x548ca9;if(validateAccess(_0x45e729,_0x29e7f7)['allow']){if(pid[_0x298b33])pid[_0x298b33][_0x418aad(0x1ef)]({'function':_0x418aad(0x211),'args':_0x287af1});}else logger[_0x418aad(0x144)](_0x418aad(0x103));}),_0x460a2a['on'](_0x548ca9(0x1b2),_0x7b8a4b=>{const _0x36fa96=_0x548ca9;if(validateAccess(_0x7b8a4b,_0x29e7f7)[_0x36fa96(0x105)]){if(pid[_0x298b33])pid[_0x298b33][_0x36fa96(0x1ef)]({'function':_0x36fa96(0x209),'args':null});}else logger[_0x36fa96(0x144)](_0x36fa96(0xc9));}),_0x460a2a['on'](_0x548ca9(0x219),_0x13c09c=>{const _0x336bb0=_0x548ca9;if(validateAccess(_0x13c09c,_0x29e7f7)[_0x336bb0(0x105)]){if(pid[_0x298b33])pid[_0x298b33][_0x336bb0(0x1ef)]({'function':'showConfig','args':null});}else logger[_0x336bb0(0x144)](_0x336bb0(0x1a0));}),_0x460a2a['on'](_0x548ca9(0xdb),_0x57f1d6=>{const _0x35d2fa=_0x548ca9;if(validateAccess(_0x57f1d6,_0x29e7f7)['allow'])updateBB('update');else logger[_0x35d2fa(0x144)](_0x35d2fa(0x11d));}),_0x460a2a['on'](_0x548ca9(0x20a),_0x212626=>{const _0x1b0811=_0x548ca9;if(validateAccess(_0x212626,_0x29e7f7)[_0x1b0811(0x105)])getMessages();else logger['full'](_0x1b0811(0x127));}),_0x460a2a['on']('confirm-message',(_0x34815c,_0x2e7d16)=>{const _0x4f2caa=_0x548ca9;if(validateAccess(_0x2e7d16,_0x29e7f7)[_0x4f2caa(0x105)])confirmMessage(_0x34815c);else logger[_0x4f2caa(0x144)](_0x4f2caa(0x17b));}),_0x460a2a['on']('logout',_0x233891=>{const _0x430554=_0x548ca9;if(validateAccess(_0x233891,_0x29e7f7)[_0x430554(0x105)]){if(devices[_0x29e7f7][_0x430554(0x1da)])clearTimeout(devices[_0x29e7f7][_0x430554(0x1da)]);if(devices[_0x29e7f7][_0x430554(0x1d1)])clearTimeout(devices[_0x29e7f7]['pidExpireLogin']);removeSocketListeners(getClient(_0x460a2a['id'])[_0x430554(0x28e)]),addBlacklist(_0x29e7f7),devices[_0x29e7f7][_0x430554(0x299)]=null,devices[_0x29e7f7][_0x430554(0x29b)]=null,devices[_0x29e7f7][_0x430554(0x13c)][_0x430554(0x112)]=null,logger[_0x430554(0x23e)](_0x430554(0x11a)+_0x29e7f7[_0x430554(0x1d6)](-0x8)),io['to'](getClient(_0x460a2a['id'])['uuid'])[_0x430554(0x124)](_0x430554(0x1d2),{'access':{'allow':![],'reason':_0x430554(0x162),'token':null}});}else logger[_0x430554(0x144)](_0x430554(0x234));});}function removeSocketListeners(_0x527bd4){const _0x5cfc72=_0x348b51;getClientsWithUuid(_0x527bd4)[_0x5cfc72(0x148)](_0x55f819=>{const _0xfccc73=_0x5cfc72;getSocket(_0x55f819['id'])[_0xfccc73(0x1d8)]();});}function cleanSettings(){const _0x5dd002=_0x348b51;let _0x1c3443=settings;return settings[_0x5dd002(0x1c0)]&&settings[_0x5dd002(0x1c0)]!=''&&(_0x1c3443={..._0x1c3443,'telegramToken':_0x5dd002(0x218)}),settings['bbPassword']&&settings['bbPassword']!=''&&(_0x1c3443={..._0x1c3443,'bbPassword':_0x5dd002(0x218)}),(settings[_0x5dd002(0xc1)]&&settings[_0x5dd002(0xc1)]==_0x5dd002(0x161)||settings['telegramToken']&&settings[_0x5dd002(0x1c0)]==_0x5dd002(0x161))&&(_0x1c3443={..._0x1c3443,'restored':{'password':settings[_0x5dd002(0xc1)]==_0x5dd002(0x161),'telegram':settings[_0x5dd002(0x1c0)]=='***'}}),_0x1c3443;}async function updateBB(_0x3ae718){const _0x2b3aa3=_0x348b51;await backupConfigFiles(),installingUpdate=!![],config[_0x2b3aa3(0x148)](_0x4cd8a9=>{const _0x51d69a=_0x2b3aa3;restartBot(_0x4cd8a9[_0x51d69a(0x23f)]);});if(_0x3ae718==_0x2b3aa3(0x1ce))process[_0x2b3aa3(0x1ef)]({'update':!![],'environment':environment},_0x46f982=>{});else _0x3ae718==_0x2b3aa3(0x14d)&&process[_0x2b3aa3(0x1ef)]({'reinstall':!![],'environment':environment},_0x126d0e=>{});}function startBot(_0x1ab697,_0x3e3d93,_0x24fad9){const _0x3dfa4c=_0x348b51;if(debugging)_0x1ab697[_0x3dfa4c(0x255)]('-d');let _0x281d05=![];const _0x5a3ecc=_0x1ab697[0x0];_0x3e3d93={..._0x3e3d93,'stdio':[_0x3dfa4c(0xd5),_0x3dfa4c(0xd5),_0x3dfa4c(0xd5),_0x3dfa4c(0x1eb)]},pid[_0x5a3ecc]=childProcess[_0x3dfa4c(0xbe)](botfile,_0x1ab697,_0x3e3d93),pid[_0x5a3ecc]['on']('message',_0x20ae27=>{const _0x522b9d=_0x3dfa4c;switch(Object['keys'](_0x20ae27)[0x0]){case _0x522b9d(0x18e):updateBotName(_0x5a3ecc,_0x20ae27[_0x522b9d(0x18e)]);break;case _0x522b9d(0x1b1):updateBotManager();break;case _0x522b9d(0x1d2):updateStatus(_0x5a3ecc,_0x20ae27[_0x522b9d(0x1d2)]);break;case _0x522b9d(0xe0):updateLive(_0x5a3ecc,_0x20ae27[_0x522b9d(0xe0)]);break;case _0x522b9d(0x160):updateLive(_0x5a3ecc,_0x20ae27[_0x522b9d(0x160)]),io['to'](_0x5a3ecc)[_0x522b9d(0x124)](_0x522b9d(0x1d2),{'access':{'allow':![],'reason':_0x522b9d(0x186),'token':null}});break;case _0x522b9d(0xc0):_0x20ae27[_0x522b9d(0xc0)]==_0x522b9d(0x213)&&restartBot(_0x5a3ecc);_0x20ae27[_0x522b9d(0xc0)]==_0x522b9d(0x276)&&toggleBot(_0x5a3ecc,_0x522b9d(0x1b9),_0x522b9d(0x18d));break;case _0x522b9d(0x177):sendTelegramBot(_0x5a3ecc,_0x20ae27['telegram']);break;case _0x522b9d(0x25f):sendTelegramMsg(_0x20ae27['telegrammsg']);break;case _0x522b9d(0x107):io['to'](_0x5a3ecc)[_0x522b9d(0x124)](_0x20ae27[_0x522b9d(0x107)],_0x20ae27[_0x522b9d(0x23c)]);break;}}),pid[_0x5a3ecc]['on'](_0x3dfa4c(0xec),function(_0x28335e){if(_0x281d05)return;_0x281d05=!![],_0x24fad9(_0x28335e);}),pid[_0x5a3ecc]['on'](_0x3dfa4c(0xe8),async function(_0x2550b9){const _0x490f9a=_0x3dfa4c;if(terminating)return;if(installingUpdate){logger[_0x490f9a(0x23e)](_0x490f9a(0xd6)),io[_0x490f9a(0x288)]();return;}if(_0x281d05)return;_0x281d05=!![],_0x24fad9(null);const _0x544c14=dbConfig[_0x490f9a(0x15f)](_0x490f9a(0x15a))[_0x490f9a(0x136)]({'botID':_0x5a3ecc})[_0x490f9a(0x28a)]();_0x544c14&&(_0x544c14['status']=='enabled'||_0x544c14[_0x490f9a(0x1d2)]==_0x490f9a(0x102))&&(await sleep(0x3e8),updateLive(_0x5a3ecc,_0x490f9a(0x18d)),logger['full']('Restarting\x20Bot\x20'+_0x5a3ecc),startBot([_0x5a3ecc,userID],{'cwd':bbpath},function(_0x4a85a7){const _0x1d340e=_0x490f9a;if(_0x4a85a7)logger[_0x1d340e(0x144)](_0x4a85a7);}));});}function stopBot(_0x5c904f){const _0x4b7e1a=_0x348b51;getClientsWithBotID(_0x5c904f)[_0x4b7e1a(0x148)](_0x13c6b8=>{getSocket(_0x13c6b8['id'])['disconnect'](!![]),removeClient(_0x13c6b8['id']);}),pid[_0x5c904f]&&(pid[_0x5c904f][_0x4b7e1a(0x276)](),pid[_0x5c904f]=null);}function stopAllBots(){const _0x4d94ef=_0x348b51;terminating=!![];const _0x2ee804=getEnabledBots();_0x2ee804[_0x4d94ef(0x148)](_0xc4d42a=>{const _0x1442fc=_0x4d94ef;stopBot(_0xc4d42a[_0x1442fc(0x23f)]);});}function restartBot(_0x2abb9a){const _0x4ee1dd=_0x348b51;if(pid[_0x2abb9a])pid[_0x2abb9a][_0x4ee1dd(0x276)]();}function addBot(){const _0xe41f48=_0x348b51;let _0x35504d;for(let _0x44ea37=0x1;_0x44ea37<0x3e9;_0x44ea37++){_0x35504d=_0x44ea37['toString']()[_0xe41f48(0x262)](0x3,'0');let _0x17aba4=config[_0xe41f48(0x136)](_0x59e00b=>_0x59e00b[_0xe41f48(0x23f)]==_0x35504d);if(!_0x17aba4)break;}if(_0x35504d==='1000'){logger[_0xe41f48(0x144)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0xe41f48(0x144)](_0xe41f48(0x21d)+_0x35504d),dbConfig[_0xe41f48(0x15f)](_0xe41f48(0x15a))[_0xe41f48(0x255)]({'botID':_0x35504d,'botname':_0xe41f48(0x293)+_0x35504d,'status':'new','live':''})[_0xe41f48(0x152)](),startBot([_0x35504d,userID],{'cwd':bbpath},function(_0x3c28d3){const _0x549563=_0xe41f48;if(_0x3c28d3)logger[_0x549563(0x144)](_0x3c28d3);}),config=getConfiguration(),io['to'](_0xe41f48(0x1ed))[_0xe41f48(0x124)](_0xe41f48(0x15a),config),broadcastToBots(_0xe41f48(0x15a),JSON[_0xe41f48(0x115)](config));}function deleteBot(_0x5f18c2){const _0x2cb639=_0x348b51;getClientsWithBotID(_0x5f18c2)['forEach'](_0x241b28=>{const _0x4a9094=_0x2236;getSocket(_0x241b28['id'])[_0x4a9094(0x1ff)](!![]),removeClient(_0x241b28['id']);}),dbConfig['get'](_0x2cb639(0x15a))[_0x2cb639(0x21a)]({'botID':_0x5f18c2})['write'](),logger['full'](_0x2cb639(0x19e)+_0x5f18c2),stopBot(_0x5f18c2);try{if(fs[_0x2cb639(0x121)](path[_0x2cb639(0x114)](configpath,_0x2cb639(0x1f5)+_0x5f18c2+_0x2cb639(0x225))))fs[_0x2cb639(0x27d)](path[_0x2cb639(0x114)](configpath,_0x2cb639(0x1f5)+_0x5f18c2+_0x2cb639(0x225)));if(fs['existsSync'](path[_0x2cb639(0x114)](configpath,_0x2cb639(0x1f5)+_0x5f18c2+_0x2cb639(0x1a6))))fs[_0x2cb639(0x27d)](path[_0x2cb639(0x114)](configpath,_0x2cb639(0x1f5)+_0x5f18c2+_0x2cb639(0x1a6)));if(fs[_0x2cb639(0x121)](path[_0x2cb639(0x114)](configpath,_0x2cb639(0x1f5)+_0x5f18c2+_0x2cb639(0x123))))fs[_0x2cb639(0x27d)](path[_0x2cb639(0x114)](configpath,_0x2cb639(0x1f5)+_0x5f18c2+_0x2cb639(0x123)));if(fs[_0x2cb639(0x121)](path[_0x2cb639(0x114)](configpath,_0x2cb639(0x1f5)+_0x5f18c2+_0x2cb639(0x9c))))fs[_0x2cb639(0x27d)](path[_0x2cb639(0x114)](configpath,'bot-'+_0x5f18c2+_0x2cb639(0x9c)));}catch(_0x1b1494){if(_0x1b1494)logger[_0x2cb639(0x144)](_0x2cb639(0xf8),_0x1b1494);}config=getConfiguration(),io['to']('botmanager')['emit'](_0x2cb639(0x15a),config),broadcastToBots(_0x2cb639(0x15a),JSON[_0x2cb639(0x115)](config));}function toggleBot(_0xacb0f1,_0x58d54f,_0x37b704){const _0x11cb56=_0x348b51;dbConfig['get'](_0x11cb56(0x15a))['find']({'botID':_0xacb0f1})[_0x11cb56(0x252)]({'status':_0x58d54f})[_0x11cb56(0x252)]({'live':_0x37b704})[_0x11cb56(0x152)]();if(_0x58d54f==_0x11cb56(0x1c7)||_0x58d54f=='new')logger[_0x11cb56(0x144)]('Enabled\x20Bot\x20'+_0xacb0f1),startBot([_0xacb0f1,userID],{'cwd':bbpath},function(_0x46ef18){const _0x1e1d72=_0x11cb56;if(_0x46ef18)logger[_0x1e1d72(0x144)](_0x46ef18);});else(_0x58d54f==_0x11cb56(0x1b9)||_0x58d54f==_0x11cb56(0x287))&&(logger['full'](_0x11cb56(0x1f1)+_0xacb0f1),stopBot(_0xacb0f1));config=getConfiguration(),io['to'](_0x11cb56(0x1ed))[_0x11cb56(0x124)](_0x11cb56(0x15a),config),broadcastToBots(_0x11cb56(0x15a),JSON[_0x11cb56(0x115)](config));}function toggleStatus(_0x47583d){const _0x55a11a=_0x348b51;let _0xd69b48=dbConfig[_0x55a11a(0x15f)](_0x55a11a(0x15a))[_0x55a11a(0x136)]({'botID':_0x47583d})['value'](),_0x160447;if(_0xd69b48[_0x55a11a(0x1d2)]===_0x55a11a(0x1c7))_0x160447=_0x55a11a(0x1b9);else{if(_0xd69b48[_0x55a11a(0x1d2)]===_0x55a11a(0x102))_0x160447=_0x55a11a(0x287);else{if(_0xd69b48[_0x55a11a(0x1d2)]==='new-disabled')_0x160447='new';else{if(_0xd69b48[_0x55a11a(0x1d2)]===_0x55a11a(0x1b9))_0x160447=_0x55a11a(0x1c7);}}}return _0x160447;}function updateStatus(_0x1e8c38,_0x3f73ce){const _0x366236=_0x348b51;dbConfig[_0x366236(0x15f)]('bots')[_0x366236(0x136)]({'botID':_0x1e8c38})[_0x366236(0x252)]({'status':_0x3f73ce})[_0x366236(0x152)](),config=getConfiguration(),io['to'](_0x366236(0x1ed))['emit'](_0x366236(0x15a),config),broadcastToBots(_0x366236(0x15a),JSON[_0x366236(0x115)](config));}function updateLive(_0x19cfcb,_0xb4d36){const _0x2ba0fa=_0x348b51;dbConfig[_0x2ba0fa(0x15f)](_0x2ba0fa(0x15a))[_0x2ba0fa(0x136)]({'botID':_0x19cfcb})[_0x2ba0fa(0x252)]({'live':_0xb4d36})[_0x2ba0fa(0x152)](),config=getConfiguration(),io['to'](_0x2ba0fa(0x1ed))[_0x2ba0fa(0x124)](_0x2ba0fa(0x15a),config),broadcastToBots(_0x2ba0fa(0x15a),JSON[_0x2ba0fa(0x115)](config));}function updateBotName(_0x4c9b0d,_0x167705){const _0x5dbe8a=_0x348b51;dbConfig['get'](_0x5dbe8a(0x15a))[_0x5dbe8a(0x136)]({'botID':_0x4c9b0d})[_0x5dbe8a(0x252)]({'botname':_0x167705})[_0x5dbe8a(0x152)](),config=getConfiguration(),io['to'](_0x5dbe8a(0x1ed))[_0x5dbe8a(0x124)]('bots',config),broadcastToBots('bots',JSON[_0x5dbe8a(0x115)](config));}function updateBotManager(){const _0x2a1516=_0x348b51;config=getConfiguration(),io['to'](_0x2a1516(0x1ed))[_0x2a1516(0x124)]('bots',config),broadcastToBots('bots',JSON[_0x2a1516(0x115)](config));}function toggleBotMode(_0x28144e){const _0x3cae31=_0x348b51;if(pid[_0x28144e])pid[_0x28144e]['send']({'function':_0x3cae31(0xdc),'args':null});else{const _0x4e1d19=configpath+_0x3cae31(0x1f5)+_0x28144e+_0x3cae31(0x225),_0x2b5892=fs[_0x3cae31(0x135)](_0x4e1d19),_0x7efd7c=JSON[_0x3cae31(0x175)](_0x2b5892),_0x269ace=_0x7efd7c[_0x3cae31(0x147)][0x0][_0x3cae31(0x1e0)];_0x7efd7c['bot'][0x0]['headless']=!_0x269ace;const _0xcb0c3e=JSON['stringify'](_0x7efd7c,null,0x2);fs[_0x3cae31(0x19d)](_0x4e1d19,_0xcb0c3e),config=getConfiguration(),io['to'](_0x3cae31(0x1ed))['emit'](_0x3cae31(0x15a),config),broadcastToBots(_0x3cae31(0x15a),JSON['stringify'](config));}}function validateTelegram(_0x40a19e){const _0xb6587=_0x348b51;if(_0x40a19e[_0xb6587(0xb8)][_0xb6587(0x28b)]!=settings[_0xb6587(0x22b)]&&'@'+_0x40a19e[_0xb6587(0xb8)]['username']!=settings[_0xb6587(0x22b)]||_0x40a19e[_0xb6587(0x272)]['id']!=settings[_0xb6587(0x285)])return sendTelegram(_0x40a19e[_0xb6587(0x272)]['id'],_0xb6587(0xe4),{'parse_mode':_0xb6587(0x206)}),![];return!![];}async function initTelegram(){const _0x5d7a35=_0x348b51;if(tgBot)tgBot['stop'](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x5d7a35(0x1c0)]);let _0x4509a9='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x4509a9+='\x0a',_0x4509a9+=_0x5d7a35(0xca),_0x4509a9+=_0x5d7a35(0xfb),_0x4509a9+=_0x5d7a35(0xd1),_0x4509a9+=_0x5d7a35(0x20d),_0x4509a9+='/on\x20-\x20start\x20bot(s)\x0a',_0x4509a9+=_0x5d7a35(0x141),_0x4509a9+=_0x5d7a35(0xd2),_0x4509a9+=_0x5d7a35(0xee),_0x4509a9+=_0x5d7a35(0x11f),_0x4509a9+=_0x5d7a35(0x150),_0x4509a9+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x4509a9+=_0x5d7a35(0x266),_0x4509a9+=_0x5d7a35(0x119),_0x4509a9+=_0x5d7a35(0x193);let _0x40acdb=_0x5d7a35(0x1ae);_0x40acdb+='\x0a',_0x40acdb+=_0x4509a9,tgBot['catch']((_0x205ad8,_0x15ff6e)=>{const _0x137751=_0x5d7a35;logger[_0x137751(0x26d)](getTimeStamp()+_0x137751(0x192)),logger[_0x137751(0x23e)](_0x137751(0xf6),_0x205ad8);}),tgBot[_0x5d7a35(0x101)](async(_0x2be76d,_0x130718)=>{const _0x4d48fb=_0x5d7a35;if(!(!settings['telegramChatId']&&_0x2be76d[_0x4d48fb(0x1ce)]['message'][_0x4d48fb(0x15d)]=='/start')){if(!validateTelegram(_0x2be76d))return;}_0x130718();}),tgBot[_0x5d7a35(0x207)](_0x5d7a35(0x1ca),async _0xe03108=>{const _0x29b2e6=_0x5d7a35;if(!settings[_0x29b2e6(0x285)])updateSetting('telegramChatId',_0xe03108[_0x29b2e6(0x272)]['id']);updateSetting(_0x29b2e6(0x22d),!![]);if(!validateTelegram(_0xe03108))return;await sendTelegram(_0xe03108[_0x29b2e6(0x272)]['id'],_0x40acdb);}),tgBot[_0x5d7a35(0x207)](_0x5d7a35(0x191),async _0x35e014=>{const _0x2e7f82=_0x5d7a35;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x35e014[_0x2e7f82(0x272)]['id'],_0x2e7f82(0x2a0));}),tgBot['command'](_0x5d7a35(0x1b4),async _0x457b12=>{const _0x473a0a=_0x5d7a35;await sendTelegram(_0x457b12[_0x473a0a(0x272)]['id'],_0x473a0a(0x167)),updateSetting(_0x473a0a(0x22d),![]);}),tgBot['command'](_0x5d7a35(0x1f7),async _0x5d2db2=>{const _0x120eec=_0x5d7a35,_0x27ba53=Markup['inlineKeyboard']([Markup[_0x120eec(0x139)][_0x120eec(0x153)](_0x120eec(0xa9),_0x120eec(0x1f8)),Markup[_0x120eec(0x139)][_0x120eec(0x153)](_0x120eec(0x269),_0x120eec(0x12b)),Markup['button']['callback'](_0x120eec(0x1f0),_0x120eec(0x271))]);_0x5d2db2[_0x120eec(0x169)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x27ba53);}),tgBot[_0x5d7a35(0x14c)](_0x5d7a35(0x1f8),async _0x34716b=>{const _0x3d19f0=_0x5d7a35;_0x34716b[_0x3d19f0(0x172)](),updateSetting('telegramEvents',_0x3d19f0(0x1a5)),updateSetting(_0x3d19f0(0x22d),!![]),await sendTelegram(_0x34716b[_0x3d19f0(0x272)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0x5d7a35(0x14c)]('config_alerts',async _0x59d1bd=>{const _0x2ed449=_0x5d7a35;_0x59d1bd[_0x2ed449(0x172)](),updateSetting('telegramEvents',_0x2ed449(0x1aa)),updateSetting(_0x2ed449(0x22d),!![]),await sendTelegram(_0x59d1bd[_0x2ed449(0x272)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0x5d7a35(0x14c)](_0x5d7a35(0x271),async _0x3edeb4=>{const _0x54d674=_0x5d7a35;_0x3edeb4['editMessageReplyMarkup'](),updateSetting(_0x54d674(0x194),_0x54d674(0xc7)),updateSetting(_0x54d674(0x22d),!![]),await sendTelegram(_0x3edeb4[_0x54d674(0x272)]['id'],_0x54d674(0x184));}),tgBot[_0x5d7a35(0x207)](_0x5d7a35(0x1d2),async _0xa7c8f7=>{const _0x4f05be=_0x5d7a35,_0x176caf=getBotsWithMode();let _0x38664d='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x4f05be(0x148)](_0x572cc4=>{const _0x1818b6=_0x4f05be,_0x81e4f1=_0x176caf['find'](_0x6cc47f=>_0x6cc47f[_0x1818b6(0x23f)]==_0x572cc4[_0x1818b6(0x23f)])[_0x1818b6(0xd9)];_0x38664d+=_0x1818b6(0x293)+_0x572cc4[_0x1818b6(0x23f)]+':\x20'+_0x572cc4['status']+'\x20|\x20'+_0x81e4f1+'\x20|\x20'+_0x572cc4['live']+'\x0a';}),_0x38664d+='\x0a',_0x38664d+=_0x4f05be(0xef),_0x38664d+=!settings['telegramEnabled']?'Notifications\x20disabled\x0a':_0x4f05be(0x263),_0x38664d+=settings[_0x4f05be(0x22d)]?settings[_0x4f05be(0x194)]==_0x4f05be(0xc7)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x4f05be(0x235)+settings[_0x4f05be(0x194)]+_0x4f05be(0x108):'',await sendTelegram(_0xa7c8f7[_0x4f05be(0x272)]['id'],_0x38664d,{'parse_mode':_0x4f05be(0x206)});}),tgBot[_0x5d7a35(0x207)]('restart',async _0x29eef8=>{const _0x169c55=_0x5d7a35,_0x1f1cdd=getEnabledBots();if(_0x1f1cdd[_0x169c55(0x26b)]==0x0)await sendTelegram(_0x29eef8[_0x169c55(0x272)]['id'],_0x169c55(0x1c2));else{if(_0x1f1cdd['length']>0x1)_0x1f1cdd['push']({'botID':_0x169c55(0xc7)});let _0x17d672=[],_0x708cc8=[];const _0x28f3a6=_0x1f1cdd[_0x169c55(0x26b)]%0x4==0x0||_0x1f1cdd['length']%0x4==0x3||_0x1f1cdd[_0x169c55(0x26b)]%0x3==0x1?0x4:0x3;let _0x336407=0x0;_0x1f1cdd[_0x169c55(0x148)]((_0x45d38e,_0xbd7c8)=>{const _0xc0b848=_0x169c55;if(_0xbd7c8%_0x28f3a6==0x0)_0x708cc8=[];_0x708cc8['push'](Markup[_0xc0b848(0x139)][_0xc0b848(0x153)](_0x45d38e[_0xc0b848(0x23f)]==_0xc0b848(0xc7)?'All\x20bots':'Bot\x20'+_0x45d38e[_0xc0b848(0x23f)],_0xc0b848(0x1c5)+_0x45d38e['botID'])),_0xbd7c8%_0x28f3a6==0x0&&(_0x17d672[_0x336407]=_0x708cc8,_0x336407++);});const _0xd297f4=Markup[_0x169c55(0x1bc)](_0x17d672);_0x29eef8[_0x169c55(0x169)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0xd297f4);}}),tgBot['action'](/restart_(.+)/,async _0xe54182=>{const _0x184a51=_0x5d7a35,_0xe4a450=_0xe54182[_0x184a51(0x1ea)][0x1];_0xe54182[_0x184a51(0x172)](),_0xe4a450==_0x184a51(0xc7)?config[_0x184a51(0x148)](_0x191f7b=>{const _0x16eda4=_0x184a51;restartBot(_0x191f7b[_0x16eda4(0x23f)]);}):restartBot(_0xe4a450);}),tgBot[_0x5d7a35(0x207)]('on',async _0x4bc88a=>{const _0x138870=_0x5d7a35,_0x2050f5=getDisabledBots();if(_0x2050f5[_0x138870(0x26b)]==0x0)await sendTelegram(_0x4bc88a[_0x138870(0x272)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x2050f5[_0x138870(0x26b)]>0x1)_0x2050f5[_0x138870(0x255)]({'botID':'all'});let _0x35556b=[],_0x2054d7=[];const _0x354d3c=_0x2050f5[_0x138870(0x26b)]%0x4==0x0||_0x2050f5['length']%0x4==0x3||_0x2050f5[_0x138870(0x26b)]%0x3==0x1?0x4:0x3;let _0x392afd=0x0;_0x2050f5['forEach']((_0x7a9b60,_0x1bd6c7)=>{const _0x427c77=_0x138870;if(_0x1bd6c7%_0x354d3c==0x0)_0x2054d7=[];_0x2054d7[_0x427c77(0x255)](Markup[_0x427c77(0x139)]['callback'](_0x7a9b60[_0x427c77(0x23f)]==_0x427c77(0xc7)?_0x427c77(0x229):'Bot\x20'+_0x7a9b60[_0x427c77(0x23f)],_0x427c77(0x26c)+_0x7a9b60['botID'])),_0x1bd6c7%_0x354d3c==0x0&&(_0x35556b[_0x392afd]=_0x2054d7,_0x392afd++);});const _0xee1658=Markup['inlineKeyboard'](_0x35556b);_0x4bc88a[_0x138870(0x169)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0xee1658);}}),tgBot[_0x5d7a35(0x14c)](/on_(.+)/,async _0x15d9b3=>{const _0x199871=_0x5d7a35,_0xe08206=_0x15d9b3[_0x199871(0x1ea)][0x1];_0x15d9b3[_0x199871(0x172)]();if(_0xe08206=='all'){const _0x4b626b=getDisabledBots();await sendTelegram(_0x15d9b3[_0x199871(0x272)]['id'],_0x199871(0x164)),_0x4b626b[_0x199871(0x148)](_0x36ae46=>{const _0x4ea942=_0x199871;if(_0x36ae46[_0x4ea942(0x23f)]!='all')toggleBot(_0x36ae46[_0x4ea942(0x23f)],toggleStatus(_0x36ae46['botID']),'stopped');});}else await sendTelegram(_0x15d9b3[_0x199871(0x272)]['id'],_0x199871(0x296)+_0xe08206),toggleBot(_0xe08206,toggleStatus(_0xe08206),_0x199871(0x18d));}),tgBot[_0x5d7a35(0x207)](_0x5d7a35(0x166),async _0x322b33=>{const _0x8c861c=_0x5d7a35,_0x140fad=getEnabledBots();if(_0x140fad[_0x8c861c(0x26b)]==0x0)await sendTelegram(_0x322b33[_0x8c861c(0x272)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x140fad['length']>0x1)_0x140fad[_0x8c861c(0x255)]({'botID':_0x8c861c(0xc7)});let _0x426f94=[],_0x26626b=[];const _0x437ed6=_0x140fad[_0x8c861c(0x26b)]%0x4==0x0||_0x140fad['length']%0x4==0x3||_0x140fad[_0x8c861c(0x26b)]%0x3==0x1?0x4:0x3;let _0x497bf9=0x0;_0x140fad[_0x8c861c(0x148)]((_0x266e05,_0x31cb5a)=>{const _0x45ae58=_0x8c861c;if(_0x31cb5a%_0x437ed6==0x0)_0x26626b=[];_0x26626b[_0x45ae58(0x255)](Markup['button'][_0x45ae58(0x153)](_0x266e05[_0x45ae58(0x23f)]==_0x45ae58(0xc7)?'All\x20bots':_0x45ae58(0x293)+_0x266e05[_0x45ae58(0x23f)],_0x45ae58(0x289)+_0x266e05['botID'])),_0x31cb5a%_0x437ed6==0x0&&(_0x426f94[_0x497bf9]=_0x26626b,_0x497bf9++);});const _0x296872=Markup[_0x8c861c(0x1bc)](_0x426f94);_0x322b33[_0x8c861c(0x169)](_0x8c861c(0xeb),_0x296872);}}),tgBot[_0x5d7a35(0x14c)](/off_(.+)/,async _0x3aac63=>{const _0x1c07c4=_0x5d7a35,_0x1b4c70=_0x3aac63[_0x1c07c4(0x1ea)][0x1];_0x3aac63[_0x1c07c4(0x172)]();if(_0x1b4c70==_0x1c07c4(0xc7)){const _0x4a97a2=getEnabledBots();await sendTelegram(_0x3aac63[_0x1c07c4(0x272)]['id'],_0x1c07c4(0x221)),_0x4a97a2[_0x1c07c4(0x148)](_0xe4f82b=>{const _0x28a7ad=_0x1c07c4;if(_0xe4f82b[_0x28a7ad(0x23f)]!='all')toggleBot(_0xe4f82b[_0x28a7ad(0x23f)],toggleStatus(_0xe4f82b[_0x28a7ad(0x23f)]),_0x28a7ad(0x18d));});}else await sendTelegram(_0x3aac63[_0x1c07c4(0x272)]['id'],_0x1c07c4(0x9d)+_0x1b4c70),toggleBot(_0x1b4c70,toggleStatus(_0x1b4c70),_0x1c07c4(0x18d));}),tgBot[_0x5d7a35(0x207)](_0x5d7a35(0x15e),async _0x47c94f=>{const _0x499196=_0x5d7a35,_0x3b8ce1=getEnabledBots();if(_0x3b8ce1[_0x499196(0x26b)]==0x0)await sendTelegram(_0x47c94f[_0x499196(0x272)]['id'],_0x499196(0x1c2));else{if(_0x3b8ce1['length']>0x1){let _0x128239=[],_0x457b50=[];const _0x336691=_0x3b8ce1['length']%0x4==0x0||_0x3b8ce1[_0x499196(0x26b)]%0x4==0x3||_0x3b8ce1[_0x499196(0x26b)]%0x3==0x1?0x4:0x3;let _0x1519a4=0x0;_0x3b8ce1[_0x499196(0x148)]((_0x595ed4,_0x22406f)=>{const _0x466961=_0x499196;if(_0x22406f%_0x336691==0x0)_0x457b50=[];_0x457b50[_0x466961(0x255)](Markup[_0x466961(0x139)][_0x466961(0x153)](_0x466961(0x293)+_0x595ed4['botID'],'metrics_'+_0x595ed4[_0x466961(0x23f)])),_0x22406f%_0x336691==0x0&&(_0x128239[_0x1519a4]=_0x457b50,_0x1519a4++);});const _0x47fa73=Markup[_0x499196(0x1bc)](_0x128239);_0x47c94f[_0x499196(0x169)](_0x499196(0xe1),_0x47fa73);}else{const _0x4d78b5=_0x3b8ce1[0x0][_0x499196(0x23f)];if(pid[_0x4d78b5])pid[_0x4d78b5]['send']({'function':_0x499196(0xb3),'args':null});}}}),tgBot[_0x5d7a35(0x14c)](/metrics_(.+)/,async _0x300409=>{const _0x5a8381=_0x5d7a35,_0xdc2e07=_0x300409[_0x5a8381(0x1ea)][0x1];_0x300409[_0x5a8381(0x172)]();if(pid[_0xdc2e07])pid[_0xdc2e07][_0x5a8381(0x1ef)]({'function':_0x5a8381(0xb3),'args':null});}),tgBot[_0x5d7a35(0x207)]('portfolio',async _0x27f352=>{const _0x3680b0=_0x5d7a35,_0x218292=getEnabledBots();if(_0x218292[_0x3680b0(0x26b)]==0x0)await sendTelegram(_0x27f352['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x218292[_0x3680b0(0x26b)]>0x1){let _0x25f58d=[],_0x4d8137=[];const _0x255c32=_0x218292[_0x3680b0(0x26b)]%0x4==0x0||_0x218292[_0x3680b0(0x26b)]%0x4==0x3||_0x218292[_0x3680b0(0x26b)]%0x3==0x1?0x4:0x3;let _0x51ccc0=0x0;_0x218292[_0x3680b0(0x148)]((_0x1253d6,_0x8ce02c)=>{const _0x18436f=_0x3680b0;if(_0x8ce02c%_0x255c32==0x0)_0x4d8137=[];_0x4d8137[_0x18436f(0x255)](Markup[_0x18436f(0x139)][_0x18436f(0x153)](_0x18436f(0x293)+_0x1253d6['botID'],_0x18436f(0x100)+_0x1253d6[_0x18436f(0x23f)])),_0x8ce02c%_0x255c32==0x0&&(_0x25f58d[_0x51ccc0]=_0x4d8137,_0x51ccc0++);});const _0x4a352b=Markup[_0x3680b0(0x1bc)](_0x25f58d);_0x27f352[_0x3680b0(0x169)](_0x3680b0(0x228),_0x4a352b);}else{const _0x37360e=_0x218292[0x0]['botID'];if(pid[_0x37360e])pid[_0x37360e][_0x3680b0(0x1ef)]({'function':_0x3680b0(0x298),'args':null});}}}),tgBot[_0x5d7a35(0x14c)](/portfolio_(.+)/,async _0x390fee=>{const _0x3cbf62=_0x5d7a35,_0x226375=_0x390fee[_0x3cbf62(0x1ea)][0x1];_0x390fee['editMessageReplyMarkup']();if(pid[_0x226375])pid[_0x226375][_0x3cbf62(0x1ef)]({'function':_0x3cbf62(0x298),'args':null});}),tgBot['command'](_0x5d7a35(0x1ce),async _0xcd62be=>{const _0x41bd39=_0x5d7a35;await getMessages();if(!updateAvailable)await sendTelegram(_0xcd62be[_0x41bd39(0x272)]['id'],_0x41bd39(0x14a));else{if(!validInstallation)await sendTelegram(_0xcd62be[_0x41bd39(0x272)]['id'],_0x41bd39(0xf5));else{const _0x34a833=Markup[_0x41bd39(0x1bc)]([Markup[_0x41bd39(0x139)]['callback'](_0x41bd39(0x125),_0x41bd39(0x1ec)),Markup['button'][_0x41bd39(0x153)]('No',_0x41bd39(0x18c))]);_0xcd62be[_0x41bd39(0x169)]('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x34a833);}}}),tgBot['action'](/update_(.+)/,async _0x183ee6=>{const _0x405ab2=_0x5d7a35,_0x54b595=_0x183ee6[_0x405ab2(0x1ea)][0x1];_0x183ee6[_0x405ab2(0x172)](),_0x54b595==_0x405ab2(0x275)&&(await sendTelegram(_0x183ee6[_0x405ab2(0x272)]['id'],_0x405ab2(0x292)),updateBB(_0x405ab2(0x1ce))),_0x54b595=='no'&&await sendTelegram(_0x183ee6[_0x405ab2(0x272)]['id'],_0x405ab2(0x1bb));}),tgBot[_0x5d7a35(0x207)](_0x5d7a35(0x14d),async _0x2aeac7=>{const _0x413fbf=_0x5d7a35;if(!validInstallation)await sendTelegram(_0x2aeac7[_0x413fbf(0x272)]['id'],_0x413fbf(0xc5));else{const _0x195ed0=Markup[_0x413fbf(0x1bc)]([Markup['button'][_0x413fbf(0x153)](_0x413fbf(0x125),'reinstall_yes'),Markup[_0x413fbf(0x139)][_0x413fbf(0x153)]('No',_0x413fbf(0x22a))]);_0x2aeac7['reply'](_0x413fbf(0x182),_0x195ed0);}}),tgBot[_0x5d7a35(0x14c)](/reinstall_(.+)/,async _0x1a961a=>{const _0x50abef=_0x5d7a35,_0x15f2e0=_0x1a961a[_0x50abef(0x1ea)][0x1];_0x1a961a[_0x50abef(0x172)](),_0x15f2e0==_0x50abef(0x275)&&(await sendTelegram(_0x1a961a[_0x50abef(0x272)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x50abef(0x14d))),_0x15f2e0=='no'&&await sendTelegram(_0x1a961a[_0x50abef(0x272)]['id'],_0x50abef(0x282));}),tgBot[_0x5d7a35(0x207)]('toggle',async _0x1f1d3c=>{const _0x375fff=_0x5d7a35,_0x2c0f68=getBotsWithMode();if(_0x2c0f68[_0x375fff(0x26b)]==0x0)await sendTelegram(_0x1f1d3c[_0x375fff(0x272)]['id'],_0x375fff(0x1c2));else{let _0x45f8e0=[],_0x357673=[];const _0x1a466f=0x2;let _0x4ef730=0x0;_0x2c0f68[_0x375fff(0x148)]((_0x53d203,_0x357791)=>{const _0x5f28da=_0x375fff;if(_0x357791%_0x1a466f==0x0)_0x357673=[];_0x357673[_0x5f28da(0x255)](Markup[_0x5f28da(0x139)][_0x5f28da(0x153)](_0x5f28da(0x293)+_0x53d203[_0x5f28da(0x23f)]+'\x20('+_0x53d203[_0x5f28da(0xd9)]+')',_0x5f28da(0x122)+_0x53d203[_0x5f28da(0x23f)])),_0x357791%_0x1a466f==0x0&&(_0x45f8e0[_0x4ef730]=_0x357673,_0x4ef730++);});const _0x518c31=Markup[_0x375fff(0x1bc)](_0x45f8e0);_0x1f1d3c[_0x375fff(0x169)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x518c31);}}),tgBot[_0x5d7a35(0x14c)](/toggle_(.+)/,async _0x11345b=>{const _0x256833=_0x5d7a35,_0x46e3de=_0x11345b[_0x256833(0x1ea)][0x1];_0x11345b[_0x256833(0x172)]();const _0x49d7c4=getBotsWithMode(),_0x541921=_0x49d7c4[_0x256833(0x136)](_0x2c966c=>_0x2c966c[_0x256833(0x23f)]==_0x46e3de),_0x34dbee=_0x541921['mode']==_0x256833(0xbd)?_0x256833(0x146):_0x256833(0xbd);await sendTelegram(_0x11345b['chat']['id'],_0x256833(0xa0)+_0x46e3de+_0x256833(0x17a)+_0x34dbee+_0x256833(0x19c)),toggleBotMode(_0x46e3de);}),tgBot[_0x5d7a35(0x207)](_0x5d7a35(0xff),async _0x38fe16=>{const _0x111d9a=_0x5d7a35;let _0x3d0d28='';config[_0x111d9a(0x148)](_0x6f8508=>{const _0x5a3743=_0x111d9a;_0x3d0d28+=_0x5a3743(0x293)+_0x6f8508[_0x5a3743(0x23f)]+':\x20'+_0x6f8508[_0x5a3743(0x18e)]+'\x0a';}),await sendTelegram(_0x38fe16[_0x111d9a(0x272)]['id'],_0x3d0d28,{'parse_mode':_0x111d9a(0x206)});}),tgBot[_0x5d7a35(0x207)](_0x5d7a35(0x21b),async _0x1bac7b=>{const _0x6d9698=_0x5d7a35;await sendTelegram(_0x1bac7b[_0x6d9698(0x272)]['id'],_0x4509a9);}),process[_0x5d7a35(0xea)](_0x5d7a35(0xcb),()=>tgBot['stop'](_0x5d7a35(0xcb))),process['once']('SIGTERM',()=>tgBot[_0x5d7a35(0xc0)](_0x5d7a35(0x117))),tgBot[_0x5d7a35(0xa3)]();}}function disableTelegram(){const _0x15fbd7=_0x348b51;tgBot&&tgBot[_0x15fbd7(0xc0)]();}async function sendTelegram(_0x423ad1,_0x4558f2,_0x2009f0){const _0x55d01a=_0x348b51;try{await tgBot[_0x55d01a(0x177)][_0x55d01a(0x1b5)](_0x423ad1,_0x4558f2,_0x2009f0);}catch(_0x156835){console[_0x55d01a(0xbc)](_0x55d01a(0x20e),_0x156835);}}async function sendTelegramBot(_0x2054f4,_0x35c838){const _0xebbe9e=_0x348b51;if(settings[_0xebbe9e(0x22d)]){if(settings['telegramEvents']==_0xebbe9e(0xc7)||(_0x35c838[_0xebbe9e(0x1a1)]==_0xebbe9e(0xec)||_0x35c838[_0xebbe9e(0x1a1)]==_0xebbe9e(0x176)||_0x35c838[_0xebbe9e(0x1a1)]=='success')&&settings[_0xebbe9e(0x194)]==_0xebbe9e(0x1aa)||_0x35c838[_0xebbe9e(0x1a1)]==_0xebbe9e(0x14f)&&settings[_0xebbe9e(0x194)]=='orders'){if(tgBot&&settings[_0xebbe9e(0x285)]){if(_0x35c838[_0xebbe9e(0x259)])await sendTelegram(settings['telegramChatId'],_0x35c838['botname']+_0xebbe9e(0x1b6)+_0x35c838[_0xebbe9e(0x1cd)]);else await sendTelegram(settings[_0xebbe9e(0x285)],_0xebbe9e(0x293)+_0x2054f4+_0xebbe9e(0x1b6)+_0x35c838[_0xebbe9e(0x1cd)]);}}}}async function sendTelegramMsg(_0x1290a5,_0x22cc33=_0x348b51(0x206)){const _0xa95442=_0x348b51;return settings[_0xa95442(0x22d)]&&tgBot&&settings[_0xa95442(0x285)]?(await sendTelegram(settings['telegramChatId'],_0x1290a5,{'parse_mode':_0x22cc33}),!![]):![];}function getDeviceWithIp(_0x13d37f){const _0x406976=_0x348b51;return devices[_0x406976(0x136)](_0x35155d=>_0x35155d['ip']===_0x13d37f);}async function temporaryAccess2FA(_0x2cbf64,_0x26c1da){const _0x25f0f5=_0x348b51;let _0x98084e=new Date(),_0x3535ea=![];if(lastIpApproval){if(_0x98084e-lastIpApproval<0x1388)_0x3535ea=!![];}lastIpApproval=new Date();if(_0x3535ea)return;if(tgBot&&settings[_0x25f0f5(0x285)]){const _0x1deaa8=uuidRandom();tmpStorage[_0x1deaa8]={'uuid':_0x2cbf64,'externalip':_0x26c1da};const _0x3ce385=Markup['inlineKeyboard']([Markup['button'][_0x25f0f5(0x153)](_0x25f0f5(0x27c),_0x25f0f5(0x26e)+_0x1deaa8),Markup[_0x25f0f5(0x139)]['callback'](_0x25f0f5(0xf3),_0x25f0f5(0x231)+_0x1deaa8),Markup[_0x25f0f5(0x139)]['callback'](_0x25f0f5(0x180),'tempaccess_30_'+_0x1deaa8),Markup['button']['callback']('reject',_0x25f0f5(0x1fd)+_0x1deaa8)]);await sendTelegram(settings[_0x25f0f5(0x285)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x26c1da)['show']+'\x20?',_0x3ce385),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x174565=>{const _0x2b63bc=_0x25f0f5,_0x57dcd9=_0x174565[_0x2b63bc(0x1ea)][0x1],_0xdf9174=_0x174565[_0x2b63bc(0x1ea)][0x2],{uuid:_0x5a2a00,externalip:_0x4d283d}=tmpStorage[_0xdf9174];delete tmpStorage[_0xdf9174],_0x174565[_0x2b63bc(0x172)](),devices[_0x5a2a00][_0x2b63bc(0x299)]={'clientip':_0x4d283d,'timestamp':new Date()['getTime'](),'expiry':_0x57dcd9},_0x57dcd9!=_0x2b63bc(0x233)?(await sendTelegram(_0x174565[_0x2b63bc(0x272)]['id'],_0x2b63bc(0x270)+_0x57dcd9+'\x20minutes',{'parse_mode':_0x2b63bc(0x206)}),io['to'](_0x5a2a00)[_0x2b63bc(0x124)](_0x2b63bc(0x1d2),{'access':{'allow':![],'reason':_0x2b63bc(0x186),'token':null}})):(await sendTelegram(_0x174565[_0x2b63bc(0x272)]['id'],_0x2b63bc(0x256)),io['to'](_0x5a2a00)[_0x2b63bc(0x124)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}function _0x418d(){const _0x4147ea=['(((.+)+)+)+$','function','\x20only\x0a','Logged\x20in\x20user\x20...','blacklist','Network\x20Interfaces:','Unauthorized\x20attempt\x20to\x20get\x20portfolio','login','isIPv4MappedAddress','Crypt','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','initclient','token','loginRequired','join','stringify','/:bot','SIGTERM','request','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Logged\x20out\x20user\x20...','update-bot','Restoring\x20bot(s)\x20from\x20backup','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','logs','/status\x20-\x20show\x20bot(s)\x20status\x0a','binary','existsSync','toggle_','-performance.json','emit','Yes','randomFillSync','Unauthorized\x20attempt\x20to\x20get\x20messages','family','hybrid-crypto-js','replace','config_alerts','login\x20not\x20required','login2fa_','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','readdirSync','Bot\x20Mgr\x20>\x20','logs/','bb-settings.json','reset-password','5kgpgNE','readFileSync','find','115930XsbUeC','version','button','IPv4','toIPv4Address','access','#RES#\x20','getFullYear','isValid','emitHistory','/off\x20-\x20stop\x20bot(s)\x0a','env','environment','full','Unauthorized\x20attempt\x20to\x20update\x20settings','manual','bot','forEach','track','Your\x20installation\x20is\x20already\x20up\x20to\x20date','private','action','reinstall','0.0.0','order','/metrics\x20-\x20show\x20bot\x20performance\x0a','referer','write','callback','mtime','decrypt','user','success','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','conn','bots','Error:\x20Invalid\x20argument\x20','settings','text','metrics','get','started','***','logged\x20out','delete-bot','Bot\x20Mgr\x20>\x20starting\x20all\x20bots',':\x20Bot\x20Mgr\x20>\x20','off','Notifications\x20disabled',')\x20|\x20Bot\x20','reply','bbvReceive','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','resetpw_yes','Allow\x20login\x20from\x20IP\x20address\x20','secure','27462xmkdya','Starting\x20(','delete-alerts','editMessageReplyMarkup','getSeconds','onepagemode','parse','warning','telegram','split','createWriteStream','\x20to\x20','Unauthorized\x20attempt\x20to\x20confirm\x20message','Restore\x20process\x20confirmed','latestversion','argv','Invalid\x20username\x20or\x20IP\x20address','30\x20min','DEFLATE','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','isDirectory','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','socket','reload','Restore\x20backup\x20file\x20','node-zip','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','getPortfolio','backup','update_no','stopped','botname','telegraf','bb-config.json','enable',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','/help\x20-\x20show\x20available\x20commands\x0a','telegramEvents','set','#RES#\x20if\x20running\x20on\x20server','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','test','versions','running','path','\x20mode','writeFileSync','Deleted\x20Bot\x20','bot.js','Unauthorized\x20attempt\x20to\x20show\x20configuration','type','Backup\x20file\x20uploaded','crypto','store-fiat','orders','-events.json','output-002.log','Unauthorized\x20attempt\x20to\x20get\x20events','any','alerts','cloneDeep','storeConfiguration','map','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','includes','deleteHistoryAlerts','updatebotmanager','cancel-loading','params','disable','sendMessage','\x20>\x20','backup-full','Unauthorized\x20attempt\x20to\x20delete\x20bot','disabled','backup-full.zip','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','inlineKeyboard','3988832SelkqL','entries','RSA','telegramToken','127.0.0.1','No\x20bots\x20running\x20right\x20now','login\x20token\x20generated','static','restart_','2FA\x20login\x20required','enabled','backup-files','store','start','min','output-001.log','event','update','date-fns','range','pidExpireLogin','status','mkdirSync','child_process',')\x20\x20\x20|\x20Bot\x20','slice','_data','removeAllListeners','headers','pidRefreshToken','ipaddr.js','output-003.log','host','download','2FA\x20login\x20token\x20generated','headless','f2aRequired','::1','place-order','compareSync','Unauthorized\x20attempt\x20to\x20download\x20','zip/','api-eu.mixpanel.com','BM\x20received\x20exit\x20signal','sortBy','match','ipc','update_yes','botmanager','3000','send','All','Disabled\x20Bot\x20','.zip','express','2556639girCdo','bot-','reset-history','config','config_orders','lastmsgemitted','toggle-bot-mode','sockets','generate','tempaccess_reject_','encryptedUuid','disconnect','279381EroVCm','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','handshake','Invalid\x20authentication\x20token\x20(1)','getDate','password','HTML','command','then','cancelLoading','get-messages','Token\x20blacklisted','resetpw_no','/restart\x20-\x20restart\x20bot(s)\x0a','Telegram\x20error:','getHours','alias','placeOrder','rmSync','restart','secret','Markdown','temporary\x20access\x20timeout','apiSecret','************','show-config','remove','help','sha256','Starting\x20new\x20bot\x20|\x20Bot\x20','reason','listen','Node.js\x20v','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','/output-000.log','login\x20required','restore_yes_','-config.json','version.json','backup-full@','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','All\x20bots','reinstall_no','telegramUsername','No\x20authentication\x20token','telegramEnabled','hashSync','internal','number','tempaccess_15_','logout','reject','Unauthorized\x20attempt\x20to\x20log\x20out','Notifications\x20types:\x20','Password\x20has\x20been\x20reset\x20to:\x20','build2','BM\x20received\x20sigterm\x20signal','Idling\x20(','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','get-starting-balances','args','getMonth','debug','botID','axios','apply','privateKey','bbUsername','lastmsgtelegram','endsWith','/upload-backup','https://api.ipify.org?format=json','login2fa_reject_','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','sort','(staging)','=>\x20Go\x20to\x20#CYA#http://','/download/:type','\x20(1)','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','resetHistory','assign','getMinutes','jsonwebtoken','push','Temporary\x20access\x20rejected','6b67f3d61ee94b8f5c80b4affef4c4d9','temp/','showname','userid','defaults','\x20|\x20user:\x20...','::ffff:127.0.0.1','Setting\x20access:\x20','telegrammsg','/:bot/coins','exec','padStart','Notifications\x20enabled\x0a','search','auth','/update\x20-\x20update\x20Balance\x20Bot\x0a','restore_no_','469XCZKtx','Alerts','express-fileupload','length','on_','simple','tempaccess_5_','publicKey','Access\x20enabled\x20for\x20','config_all','chat','Session\x20expired\x20for\x20user\x20...','filter','yes','kill','build','access\x20timeout','apiPassword','message','files','5\x20min','unlinkSync',',\x20must\x20be\x20a\x204\x20digit\x20number','/:bot/support','getTime','187BzTFJE','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','login\x20token\x20valid','uncaughtException','telegramChatId','address','new-disabled','close','off_','value','username','format','sendFile','uuid','\x1b[33m','apiKey','notification','Starting\x20Balance\x20Bot\x20update','Bot\x20','/:bot/portfolio','2FA\x20required','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','timestamp','sendPortfolioTelegram','telegramIpApproval','copyFileSync','telegram2FaApproval','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','config/','2DybKKQ','getUTCHours','Notifications\x20enabled','bbvNew','toString','-results.json','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','whitelist','Error\x20removing\x20old\x20backup\x20files:','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','name','bcryptjs','launch','Restore\x20process\x20aborted','*$1*','backup/','generateKeyPairAsync','remoteAddress','Orders','toIPv4MappedAddress','2FA\x20login\x20rejected','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','lowdb/adapters/FileSync','output-000.log','reinstall-bb','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','448459aNObLH','index.html','sendMetricsTelegram','storeHeadless','\x20|\x20','keys','file','from','Server','bb-secure.json','-----------------------------------------------------------------------------------','log','auto','fork','clients','stop','bbPassword','graphql-request','invalid\x20credentials','add','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','get-portfolio','all','mixpanel','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','/enable\x20-\x20enable\x20notifications\x0a','SIGINT','File\x20uploaded','port','expiry','temporaryAccessAllowed','\x20(2)','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','confirm-message','BM\x20received\x20sigint\x20signal','inherit','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','startsWith','Backup\x20file\x20unzipped\x20and\x20stored','mode','uuid-random','update-bb','toggleBotMode','getStartingBalances','hasOwnProperty','node','live','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Failed\x20to\x20download\x20','\x1b[34m','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Login\x20accepted','1895276KpexQS','sign','exit','Password\x20reset\x20rejected','once','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','error','tkn','/names\x20-\x20show\x20bot\x20names\x0a','<b>Telegram\x20Bot\x20Status:</b>\x0a','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','kind','clientip','15\x20min','Invalid\x20authentication\x20token\x20(2)','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Telegraf\x20error:','settings.','Error\x20while\x20deleting\x20config\x20files:\x20','\x1b[36m','messages','/disable\x20-\x20disable\x20notifications\x0a','User\x20has\x20been\x20validated','timeshift','storeFiat','names','portfolio_','use','new','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Unauthorized\x20attempt\x20to\x20update\x20bot','allow'];_0x418d=function(){return _0x4147ea;};return _0x418d();}async function loginAccess2FA(_0x4e031f,_0x2d2896){const _0x2fa534=_0x348b51;if(tgBot&&settings[_0x2fa534(0x285)]){const _0x52dda5=uuidRandom();tmpStorage[_0x52dda5]={'uuid':_0x4e031f,'externalip':_0x2d2896};const _0x4342c0=Markup[_0x2fa534(0x1bc)]([Markup[_0x2fa534(0x139)]['callback']('accept',_0x2fa534(0x12d)+loginExpiry+'_'+_0x52dda5),Markup[_0x2fa534(0x139)][_0x2fa534(0x153)](_0x2fa534(0x233),_0x2fa534(0x248)+_0x52dda5)]);await sendTelegram(settings[_0x2fa534(0x285)],_0x2fa534(0x16d)+normalizeIP(_0x2d2896)['show']+'\x20?',_0x4342c0),tgBot[_0x2fa534(0x14c)](/login2fa_(.+)_(.+)/,async _0x4467aa=>{const _0x262cde=_0x2fa534,_0x31df8f=_0x4467aa[_0x262cde(0x1ea)][0x1],_0x59e980=_0x4467aa[_0x262cde(0x1ea)][0x2],{uuid:_0x4bb86d,externalip:_0x532309}=tmpStorage[_0x59e980];delete tmpStorage[_0x59e980],_0x4467aa[_0x262cde(0x172)](),devices[_0x4bb86d][_0x262cde(0x29b)]={'clientip':_0x532309,'timestamp':new Date()[_0x262cde(0x280)](),'expiry':_0x31df8f},_0x31df8f!=_0x262cde(0x233)?(await sendTelegram(_0x4467aa[_0x262cde(0x272)]['id'],_0x262cde(0xe5),{'parse_mode':_0x262cde(0x206)}),io['to'](_0x4bb86d)[_0x262cde(0x124)](_0x262cde(0x1d2),{'access':{'allow':![],'reason':_0x262cde(0x186),'token':null}})):(await sendTelegram(_0x4467aa[_0x262cde(0x272)]['id'],'Login\x20rejected'),io['to'](_0x4bb86d)['emit']('status',{'access':{'allow':![],'reason':_0x262cde(0xab),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x563614=_0x348b51;return dbConfig[_0x563614(0x15f)](_0x563614(0x15a))[_0x563614(0x1e9)](_0x563614(0x23f))[_0x563614(0x274)]({'status':'enabled'})[_0x563614(0x28a)]()||[];}function getDisabledBots(){const _0x51bfe7=_0x348b51;return dbConfig[_0x51bfe7(0x15f)](_0x51bfe7(0x15a))['sortBy'](_0x51bfe7(0x23f))['filter']({'status':_0x51bfe7(0x1b9)})[_0x51bfe7(0x28a)]()||[];}function getBotAttributes(_0x5be8b2){const _0x3ada91=_0x348b51;let _0x40e587={};const _0x11b07a=configpath+_0x3ada91(0x1f5)+_0x5be8b2+_0x3ada91(0x225),_0x2a3344=fs[_0x3ada91(0x121)](_0x11b07a);if(_0x2a3344){const _0x5aa6f1=fs[_0x3ada91(0x135)](_0x11b07a);try{const _0x2127ac=JSON[_0x3ada91(0x175)](_0x5aa6f1),_0x36e19c=_0x2127ac?_0x2127ac[_0x3ada91(0x147)][0x0]['headless']:![];_0x40e587[_0x3ada91(0xd9)]=_0x36e19c?_0x3ada91(0xbd):'manual',_0x40e587[_0x3ada91(0x18e)]=_0x2127ac?_0x2127ac[_0x3ada91(0x147)][0x0][_0x3ada91(0x18e)]:_0x3ada91(0x293)+_0x5be8b2;}catch(_0x34037d){_0x40e587[_0x3ada91(0xd9)]=_0x3ada91(0x146),_0x40e587[_0x3ada91(0x18e)]=_0x3ada91(0x293)+_0x5be8b2;}}else _0x40e587[_0x3ada91(0xd9)]=_0x3ada91(0x146),_0x40e587['botname']='Bot\x20'+_0x5be8b2;return _0x40e587;}function getBotsWithMode(){const _0x238de7=_0x348b51,_0x582d52=dbConfig[_0x238de7(0x15f)](_0x238de7(0x15a))[_0x238de7(0x1e9)](_0x238de7(0x23f))['value']()||[];return _0x582d52[_0x238de7(0x148)](_0x1fb842=>{const _0x26819c=_0x238de7;let _0x4e28ee=getBotAttributes(_0x1fb842['botID']);_0x1fb842['mode']=_0x4e28ee[_0x26819c(0xd9)];}),_0x582d52;}function getBotExchanges(){const _0x11bceb=_0x348b51;let _0x2aad96=[];const _0x55e784=dbConfig[_0x11bceb(0x15f)](_0x11bceb(0x15a))[_0x11bceb(0x1e9)](_0x11bceb(0x23f))[_0x11bceb(0x28a)]()||[];_0x55e784[_0x11bceb(0x148)](_0x2708a9=>{const _0x43bef2=_0x11bceb;if(_0x2708a9[_0x43bef2(0x1d2)]==_0x43bef2(0x1c7)){const _0x48a5b9=configpath+_0x43bef2(0x1f5)+_0x2708a9[_0x43bef2(0x23f)]+'-config.json',_0x20036a=fs[_0x43bef2(0x121)](_0x48a5b9);let _0x4a0fe9;if(_0x20036a){const _0x3b9020=fs[_0x43bef2(0x135)](_0x48a5b9);try{const _0x42f0ac=JSON[_0x43bef2(0x175)](_0x3b9020);_0x4a0fe9=_0x42f0ac?_0x42f0ac['bot'][0x0]['exchange']:null;}catch(_0xc0f74){}}if(_0x4a0fe9)_0x2aad96[_0x43bef2(0x255)](_0x4a0fe9);}});const _0x485551=[...new Set(_0x2aad96)][_0x11bceb(0x24b)]();return _0x485551;}async function initUser(){const _0x51b0f9=_0x348b51;if(!settings[_0x51b0f9(0x25a)]){const _0x400f7f=uuidRandom();mixpanel[_0x51b0f9(0x210)](_0x400f7f),updateSetting(_0x51b0f9(0x25a),_0x400f7f);}}async function initSecure(){const _0x2854ba=_0x348b51;let _0x107a9c=getSecure();if(!_0x107a9c[_0x2854ba(0xde)]('secret')){let _0x358b29=await generateKeys();_0x107a9c[_0x2854ba(0x26f)]=_0x358b29[_0x2854ba(0x26f)],_0x107a9c[_0x2854ba(0x242)]=_0x358b29[_0x2854ba(0x242)],_0x107a9c[_0x2854ba(0x214)]=crypto['randomBytes'](0x20)[_0x2854ba(0x9b)]('hex');;storeSecure(_0x107a9c);}}function getSettings(){const _0x42401e=_0x348b51;return dbSettings[_0x42401e(0x15f)](_0x42401e(0x15c))['value']()||{};}function getSecure(){const _0x331190=_0x348b51;return dbSecure[_0x331190(0x15f)](_0x331190(0x16e))[_0x331190(0x28a)]()||{};}function getBlacklist(){const _0x2b94a7=_0x348b51;return dbSecure[_0x2b94a7(0x15f)](_0x2b94a7(0x10a))[_0x2b94a7(0x28a)]()||[];}function broadcastToBots(_0x1706bc,_0x522392){const _0x3cd1fa=_0x348b51;config[_0x3cd1fa(0x148)](_0x395339=>{const _0x30b553=_0x3cd1fa;if(_0x395339[_0x30b553(0x1d2)]==_0x30b553(0x1c7)&&_0x395339[_0x30b553(0xe0)]=='running'||_0x395339[_0x30b553(0x1d2)]==_0x30b553(0x102)&&_0x395339[_0x30b553(0xe0)]==_0x30b553(0x19a)){if(pid[_0x395339[_0x30b553(0x23f)]])pid[_0x395339[_0x30b553(0x23f)]][_0x30b553(0x1ef)]({[_0x1706bc]:_0x522392});}});}function storeSettings(_0x4af472,_0x12743b=![]){const _0x48b99a=_0x348b51;_0x4af472={...settings,..._0x4af472};if(_0x12743b&&_0x4af472[_0x48b99a(0xc1)]!='************'&&_0x4af472[_0x48b99a(0xc1)]!=_0x48b99a(0x161)&&_0x4af472[_0x48b99a(0xc1)]!=''){const _0x553258=crypt['decrypt'](secure[_0x48b99a(0x242)],_0x4af472[_0x48b99a(0xc1)])['message']['split']('@')[0x0],_0x3e9ca9=bcrypt['hashSync'](_0x553258,saltRounds);_0x4af472={..._0x4af472,'bbPassword':_0x3e9ca9};}if(_0x12743b&&_0x4af472[_0x48b99a(0x1c0)]!=_0x48b99a(0x218)&&_0x4af472[_0x48b99a(0x1c0)]!='***'&&_0x4af472['telegramToken']!=''){const _0x1d69ea=crypt[_0x48b99a(0x155)](secure['privateKey'],_0x4af472[_0x48b99a(0x1c0)])[_0x48b99a(0x27a)][_0x48b99a(0x178)]('@')[0x0];_0x4af472={..._0x4af472,'telegramToken':_0x1d69ea};}const _0x2f2c81=_0x4af472[_0x48b99a(0x1c0)]!=_0x48b99a(0x218)&&_0x4af472[_0x48b99a(0x1c0)]!=settings[_0x48b99a(0x1c0)]||_0x4af472['telegramUsername']!=settings[_0x48b99a(0x22b)],_0x46296c=_0x4af472[_0x48b99a(0x1c0)]==''||_0x4af472[_0x48b99a(0x22b)]=='';_0x2f2c81&&(_0x4af472[_0x48b99a(0x285)]=null,_0x4af472[_0x48b99a(0x194)]=_0x48b99a(0xc7));for(const [_0xb77535,_0x5447fa]of Object[_0x48b99a(0x1be)](_0x4af472)){if(_0xb77535==_0x48b99a(0x1c0)&&_0x5447fa==_0x48b99a(0x218)){_0x4af472[_0x48b99a(0x1c0)]=settings[_0x48b99a(0x1c0)];continue;};if(_0xb77535==_0x48b99a(0xc1)&&_0x5447fa==_0x48b99a(0x218)){_0x4af472[_0x48b99a(0xc1)]=settings[_0x48b99a(0xc1)];continue;};dbSettings[_0x48b99a(0x195)](_0x48b99a(0xf7)+_0xb77535,_0x5447fa)[_0x48b99a(0x152)]();}settings=_0x4af472,io['to'](_0x48b99a(0x1ed))[_0x48b99a(0x124)]('settings',cleanSettings()),broadcastToBots(_0x48b99a(0xfd),settings[_0x48b99a(0xfd)]),broadcastToBots(_0x48b99a(0x174),settings[_0x48b99a(0x174)]);if(_0x2f2c81&&!_0x46296c)initTelegram();if(_0x2f2c81&&_0x46296c)disableTelegram();getAllClients()['forEach'](_0x5dee99=>{const _0x22c025=_0x48b99a;getSocket(_0x5dee99['id'])[_0x22c025(0x124)](_0x22c025(0x1d2),{'access':{'allow':![],'reason':_0x22c025(0x186),'token':null}});});}function updateSetting(_0xe572cf,_0x301fb1){const _0x1485b0=_0x348b51;dbSettings[_0x1485b0(0x195)](_0x1485b0(0xf7)+_0xe572cf,_0x301fb1)[_0x1485b0(0x152)](),settings=getSettings(),io['to']('botmanager')[_0x1485b0(0x124)](_0x1485b0(0x15c),cleanSettings());}function storeSecure(_0x1df34b){const _0x50d802=_0x348b51;dbSecure[_0x50d802(0x15f)](_0x50d802(0x16e))[_0x50d802(0x255)](_0x1df34b)[_0x50d802(0x152)](),secure=_0x1df34b;}function addBlacklist(_0x2755a2){const _0x49e1fd=_0x348b51;cleanBlacklist();let _0x47b8c3;devices[_0x2755a2][_0x49e1fd(0x299)]?_0x47b8c3=Math['max'](devices[_0x2755a2]['telegramIpApproval'][_0x49e1fd(0xce)],loginExpiry):_0x47b8c3=loginExpiry,dbSecure[_0x49e1fd(0x15f)]('blacklist')['push']({'expiry':new Date()[_0x49e1fd(0x280)]()+_0x47b8c3*0x3c*0x3e8,'token':devices[_0x2755a2][_0x49e1fd(0x13c)][_0x49e1fd(0x112)]})[_0x49e1fd(0x152)](),blacklist=dbSecure[_0x49e1fd(0x15f)](_0x49e1fd(0x10a))[_0x49e1fd(0x28a)]();}function cleanBlacklist(){const _0x9b8059=_0x348b51;let _0x28a125=dbSecure[_0x9b8059(0x15f)](_0x9b8059(0x10a))[_0x9b8059(0x1ab)]()[_0x9b8059(0x28a)](),_0x130ae2=new Date()['getTime']();_0x28a125[_0x9b8059(0x148)](_0x4314e2=>{const _0x463aff=_0x9b8059;_0x4314e2[_0x463aff(0xce)]<_0x130ae2&&dbSecure[_0x463aff(0x15f)](_0x463aff(0x10a))['remove']({'expiry':_0x4314e2[_0x463aff(0xce)]})[_0x463aff(0x152)]();});}function initStates(){const _0x4d07bc=_0x348b51;let _0x2391ce=getConfiguration();_0x2391ce[_0x4d07bc(0x148)](_0x466135=>{const _0xcf72f0=_0x4d07bc;_0x466135[_0xcf72f0(0xe0)]='stopped';}),storeConfiguration(_0x2391ce);}function onKeys(){const _0x3392cc=new RSA();return new Promise(_0x20ab70=>{const _0x30dccc=_0x2236;_0x3392cc[_0x30dccc(0xa7)]()[_0x30dccc(0x208)](_0x34be4a=>{_0x20ab70(_0x34be4a);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1e07f3=_0x348b51;let _0x2b9ce8=getSettings(),_0x27ad9d=![];!_0x2b9ce8[_0x1e07f3(0xde)](_0x1e07f3(0x244))&&(_0x2b9ce8[_0x1e07f3(0x244)]=0x0,_0x27ad9d=!![]);!_0x2b9ce8[_0x1e07f3(0xde)]('lastmsgemitted')&&(_0x2b9ce8[_0x1e07f3(0x1f9)]=0x0,_0x27ad9d=!![]);!_0x2b9ce8['hasOwnProperty'](_0x1e07f3(0x17d))&&(_0x2b9ce8[_0x1e07f3(0x17d)]=_0x1e07f3(0x14e),_0x27ad9d=!![]);!_0x2b9ce8[_0x1e07f3(0xde)](_0x1e07f3(0x174))&&(_0x2b9ce8[_0x1e07f3(0x174)]=![],_0x27ad9d=!![]);if(_0x27ad9d)storeSettings(_0x2b9ce8);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x1e07f3(0x148)](_0x75215b=>{const _0x5bfec6=_0x1e07f3;if(!_0x75215b[_0x5bfec6(0x183)]()){if(!_0x75215b[_0x5bfec6(0xa1)][_0x5bfec6(0xd7)]('backup-full@'))fs['unlinkSync'](configbackuppath+_0x75215b[_0x5bfec6(0xa1)]);}else fs[_0x5bfec6(0x212)](configbackuppath+_0x75215b[_0x5bfec6(0xa1)],{'recursive':!![]});});}catch(_0x4670fe){logger[_0x1e07f3(0x23e)](_0x1e07f3(0x9f),_0x4670fe);}}function storeConfiguration(_0xd657f1){const _0x5c32c5=_0x348b51;dbConfig['get']('bots')[_0x5c32c5(0x21a)]()[_0x5c32c5(0x152)](),dbConfig[_0x5c32c5(0x15f)]('bots')[_0x5c32c5(0x255)](..._0xd657f1)[_0x5c32c5(0x152)](),config=_0xd657f1;}async function resetPassword(){const _0x559eae=_0x348b51;if(tgBot&&settings[_0x559eae(0x285)]){const _0x3bbd49=Markup['inlineKeyboard']([Markup[_0x559eae(0x139)]['callback'](_0x559eae(0x275),_0x559eae(0x16c)),Markup[_0x559eae(0x139)][_0x559eae(0x153)]('no',_0x559eae(0x20c))]);await sendTelegram(settings[_0x559eae(0x285)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x3bbd49),tgBot[_0x559eae(0x14c)](/resetpw_(.+)/,async _0x52bc94=>{const _0x424268=_0x559eae,_0x332524=_0x52bc94[_0x424268(0x1ea)][0x1];_0x52bc94['editMessageReplyMarkup']();if(_0x332524!='no'){const _0x216891=0xf,_0x3f3159=_0x424268(0xb0),_0x31af40=Array[_0x424268(0xb8)](crypto[_0x424268(0x126)](new Uint32Array(_0x216891)))[_0x424268(0x1ad)](_0x39896e=>_0x3f3159[_0x39896e%_0x3f3159['length']])[_0x424268(0x114)](''),_0x1f1f0f=bcrypt[_0x424268(0x22e)](_0x31af40,saltRounds);storeSettings({'bbPassword':_0x1f1f0f}),await sendTelegram(_0x52bc94['chat']['id'],_0x424268(0x236)+_0x31af40,{'parse_mode':_0x424268(0x206)});}else await sendTelegram(_0x52bc94[_0x424268(0x272)]['id'],_0x424268(0xe9));});}}async function confirmRestore(_0x3ca99d,_0x2242a1){const _0x4b7a8a=_0x348b51;io['to'](_0x4b7a8a(0x1ed))['emit'](_0x4b7a8a(0x291),_0x4b7a8a(0x29c),_0x4b7a8a(0x157));if(tgBot&&settings[_0x4b7a8a(0x285)]){const _0x34dae0=uuidRandom();tmpStorage[_0x34dae0]={'path':_0x3ca99d,'filename':_0x2242a1};const _0x2e2307=Markup[_0x4b7a8a(0x1bc)]([Markup['button']['callback'](_0x4b7a8a(0x275),_0x4b7a8a(0x224)+_0x34dae0),Markup[_0x4b7a8a(0x139)][_0x4b7a8a(0x153)]('no',_0x4b7a8a(0x267)+_0x34dae0)]);await sendTelegram(settings[_0x4b7a8a(0x285)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x2e2307),tgBot[_0x4b7a8a(0x14c)](/restore_(.+)_(.+)/,async _0x29b334=>{const _0x5357ed=_0x4b7a8a,_0x51ee30=_0x29b334[_0x5357ed(0x1ea)][0x1],_0xea2efa=_0x29b334[_0x5357ed(0x1ea)][0x2],{path:_0x3c29a1,filename:_0xbff3f}=tmpStorage[_0xea2efa];delete tmpStorage[_0xea2efa],_0x29b334[_0x5357ed(0x172)](),_0x51ee30==_0x5357ed(0x275)?(logger[_0x5357ed(0x23e)](_0x5357ed(0x17c)),await sendTelegram(_0x29b334[_0x5357ed(0x272)]['id'],_0x5357ed(0x11c),{'parse_mode':_0x5357ed(0x206)}),unzipFile(_0x3c29a1,_0xbff3f)):(logger[_0x5357ed(0x23e)](_0x5357ed(0xa4)),await sendTelegram(_0x29b334['chat']['id'],_0x5357ed(0xa4)));});}}function getServerTime(){const _0x4d9184=_0x348b51,_0x43acbe=new Date();return _0x43acbe[_0x4d9184(0x13e)]()+'/'+(_0x43acbe[_0x4d9184(0x23d)]()+0x1)[_0x4d9184(0x9b)]()['padStart'](0x2,'0')+'/'+_0x43acbe[_0x4d9184(0x204)]()['toString']()[_0x4d9184(0x262)](0x2,'0')+'\x20'+_0x43acbe[_0x4d9184(0x20f)]()['toString']()['padStart'](0x2,'0')+':'+_0x43acbe[_0x4d9184(0x253)]()[_0x4d9184(0x9b)]()[_0x4d9184(0x262)](0x2,'0')+':'+_0x43acbe[_0x4d9184(0x173)]()[_0x4d9184(0x9b)]()[_0x4d9184(0x262)](0x2,'0');}function getTimeStamp(){const _0x585248=_0x348b51,_0x50b478=shiftedTime();return _0x50b478[_0x585248(0x13e)]()+'/'+(_0x50b478[_0x585248(0x23d)]()+0x1)[_0x585248(0x9b)]()['padStart'](0x2,'0')+'/'+_0x50b478['getDate']()[_0x585248(0x9b)]()[_0x585248(0x262)](0x2,'0')+'\x20'+_0x50b478[_0x585248(0x20f)]()[_0x585248(0x9b)]()['padStart'](0x2,'0')+':'+_0x50b478['getMinutes']()[_0x585248(0x9b)]()[_0x585248(0x262)](0x2,'0')+':'+_0x50b478[_0x585248(0x173)]()['toString']()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0xe7127=_0x348b51,_0x98f26f=shiftedTime();return _0x98f26f[_0xe7127(0x13e)]()+(_0x98f26f[_0xe7127(0x23d)]()+0x1)['toString']()[_0xe7127(0x262)](0x2,'0')+_0x98f26f[_0xe7127(0x204)]()[_0xe7127(0x9b)]()[_0xe7127(0x262)](0x2,'0')+'-'+_0x98f26f[_0xe7127(0x20f)]()[_0xe7127(0x9b)]()['padStart'](0x2,'0')+_0x98f26f[_0xe7127(0x253)]()['toString']()['padStart'](0x2,'0')+_0x98f26f[_0xe7127(0x173)]()[_0xe7127(0x9b)]()[_0xe7127(0x262)](0x2,'0');}function shiftedTime(){const _0x1841eb=_0x348b51,_0x3e40cc=new Date();let _0x44738b=_0x3e40cc;if(settings['timeshift']&&settings[_0x1841eb(0xfd)]!==0x0)_0x44738b=fns[_0x1841eb(0xc4)](_0x3e40cc,{'hours':settings['timeshift']});return _0x44738b;}function startScheduler(){const _0x219eee=_0x348b51,_0x2f935a=new Date()[_0x219eee(0x29f)](),_0x581de3=shiftedTime()[_0x219eee(0x20f)]();_0x581de3==0x4&&backupConfigFiles();_0x581de3==0x0&&rotateLogFiles();_0x2f935a%0x6==0x0&&triggerAnalytics();_0x2f935a%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x2e5fe2){const _0x6fc282=_0x348b51;logger[_0x6fc282(0x23e)](_0x6fc282(0x187)+_0x2e5fe2);const _0xc65ad5=getBotsWithMode();_0xc65ad5['length']>0x0?confirmRestore(configbackuppath,_0x2e5fe2):unzipFile(configbackuppath,_0x2e5fe2);}async function getBackupFiles(_0x1a476a=null){const _0x4268fd=_0x348b51;let _0x5508b3=[],_0x32ba7f=fs[_0x4268fd(0x12f)](configbackuppath,{'withFileTypes':!![]});_0x32ba7f[_0x4268fd(0x24b)]((_0x4fd0f7,_0xcd7c01)=>_0x4fd0f7[_0x4268fd(0xa1)]<_0xcd7c01[_0x4268fd(0xa1)]?0x1:_0xcd7c01[_0x4268fd(0xa1)]<_0x4fd0f7[_0x4268fd(0xa1)]?-0x1:0x0),_0x32ba7f[_0x4268fd(0x148)](_0x23495a=>{const _0x290812=_0x4268fd;if(!_0x23495a['isDirectory']()&&_0x23495a['name'][_0x290812(0xd7)](_0x290812(0x227))&&_0x23495a[_0x290812(0xa1)][_0x290812(0x245)](_0x290812(0x1f2))){const _0x506b11=formatDate(fs['statSync'](configbackuppath+_0x23495a[_0x290812(0xa1)])[_0x290812(0x154)]);_0x5508b3[_0x290812(0x255)]({'name':_0x23495a[_0x290812(0xa1)],'mtime':_0x506b11});}});if(_0x1a476a)io['to'](_0x1a476a)[_0x4268fd(0x124)](_0x4268fd(0x1c8),_0x5508b3);else return _0x5508b3;}async function backupConfigFiles(){const _0x24153b=_0x348b51;await zipFiles(_0x24153b(0x1b7));const _0x40792f=getCleanTimeStamp();fs[_0x24153b(0x29a)](zippath+_0x24153b(0x1ba),configbackuppath+('backup-full@'+_0x40792f+_0x24153b(0x1f2)));let _0x1871f0=fs[_0x24153b(0x12f)](configbackuppath,{'withFileTypes':!![]});_0x1871f0['sort']((_0x40a6e0,_0x43ecbf)=>_0x40a6e0[_0x24153b(0xa1)]<_0x43ecbf['name']?0x1:_0x43ecbf['name']<_0x40a6e0[_0x24153b(0xa1)]?-0x1:0x0),_0x1871f0[_0x24153b(0x26b)]>maxBackups&&fs[_0x24153b(0x27d)](configbackuppath+_0x1871f0[_0x1871f0['length']-0x1]['name']);}function rotateLogFiles(){const _0x5e286e=_0x348b51,_0x22a49d=fs['statSync'](logspath+_0x5e286e(0xae)),_0x48150e=_0x22a49d['size']/0x400;if(_0x48150e>0x64){let _0x29d951=fs[_0x5e286e(0x12f)](logspath,{'withFileTypes':!![]});_0x29d951['sort']((_0x52627a,_0x329614)=>_0x52627a[_0x5e286e(0xa1)]<_0x329614['name']?0x1:_0x329614[_0x5e286e(0xa1)]<_0x52627a[_0x5e286e(0xa1)]?-0x1:0x0),_0x29d951[_0x5e286e(0x148)](_0x49f205=>{const _0x1fc9a5=_0x5e286e;if(_0x49f205[_0x1fc9a5(0xa1)]==_0x1fc9a5(0x1a7))fs[_0x1fc9a5(0x29a)](logspath+_0x49f205[_0x1fc9a5(0xa1)],logspath+_0x1fc9a5(0x1dc));if(_0x49f205[_0x1fc9a5(0xa1)]==_0x1fc9a5(0x1cc))fs[_0x1fc9a5(0x29a)](logspath+_0x49f205[_0x1fc9a5(0xa1)],logspath+_0x1fc9a5(0x1a7));_0x49f205[_0x1fc9a5(0xa1)]==_0x1fc9a5(0xae)&&(fs[_0x1fc9a5(0x29a)](logspath+_0x49f205[_0x1fc9a5(0xa1)],logspath+_0x1fc9a5(0x1cc)),fs['writeFileSync'](logspath+_0x49f205['name'],''));});}}async function zipFiles(_0x7eb958){const _0x37ea48=_0x348b51;let _0x16600d;if(_0x7eb958==_0x37ea48(0x11e))_0x16600d=logspath;if(_0x7eb958==_0x37ea48(0x18b))_0x16600d=configpath;if(_0x7eb958=='backup-full')_0x16600d=configpath;let _0x1924ac=fs[_0x37ea48(0x12f)](_0x16600d,{'withFileTypes':!![]});const _0x395850=new require(_0x37ea48(0x188))();_0x1924ac['forEach'](_0x1ea03c=>{const _0x88c9a6=_0x37ea48;if(!_0x1ea03c[_0x88c9a6(0x183)]()){let _0x5d5028=fs['readFileSync'](_0x16600d+_0x1ea03c[_0x88c9a6(0xa1)]);if(_0x7eb958==_0x88c9a6(0x18b)){const _0x2cc1a1=/^bot-[0-9]{3}-config.json$/,_0x547288=_0x2cc1a1[_0x88c9a6(0x198)](_0x1ea03c[_0x88c9a6(0xa1)]);if(_0x547288){const _0x51d09b=JSON[_0x88c9a6(0x175)](_0x5d5028);if(_0x51d09b['bot'][0x0]){_0x51d09b[_0x88c9a6(0x147)][0x0][_0x88c9a6(0x290)]='***',_0x51d09b['bot'][0x0][_0x88c9a6(0x217)]=_0x88c9a6(0x161);if(_0x51d09b[_0x88c9a6(0x147)][0x0][_0x88c9a6(0x279)])_0x51d09b[_0x88c9a6(0x147)][0x0][_0x88c9a6(0x279)]='***';}_0x5d5028=JSON[_0x88c9a6(0x115)](_0x51d09b,null,0x2);}if(_0x1ea03c[_0x88c9a6(0xa1)]==_0x88c9a6(0x132)){const _0x2a62f8=JSON[_0x88c9a6(0x175)](_0x5d5028);if(_0x2a62f8['settings'][_0x88c9a6(0x113)])_0x2a62f8['settings'][_0x88c9a6(0x113)]=![];if(_0x2a62f8[_0x88c9a6(0x15c)][_0x88c9a6(0xc1)])_0x2a62f8[_0x88c9a6(0x15c)][_0x88c9a6(0xc1)]=_0x88c9a6(0x161);if(_0x2a62f8[_0x88c9a6(0x15c)][_0x88c9a6(0x1c0)])_0x2a62f8[_0x88c9a6(0x15c)]['telegramToken']='***';if(_0x2a62f8[_0x88c9a6(0x15c)][_0x88c9a6(0x285)])_0x2a62f8['settings']['telegramChatId']=null;_0x5d5028=JSON[_0x88c9a6(0x115)](_0x2a62f8,null,0x2);}if(_0x1ea03c[_0x88c9a6(0xa1)]!=_0x88c9a6(0xba))_0x395850['file'](_0x1ea03c['name'],_0x5d5028);}else _0x395850[_0x88c9a6(0xb7)](_0x1ea03c[_0x88c9a6(0xa1)],_0x5d5028);}});const _0x15ec0b=_0x395850[_0x37ea48(0x1fc)]({'base64':![],'compression':_0x37ea48(0x181)});fs[_0x37ea48(0x19d)](zippath+(_0x7eb958+_0x37ea48(0x1f2)),_0x15ec0b,_0x37ea48(0x120));}async function unzipFile(_0x1bd796,_0x4b9f39){const _0x3ea03c=_0x348b51;fs['readdirSync'](configpath,{'withFileTypes':!![]})['forEach'](_0x217ee3=>{const _0x83d3f3=_0x2236;if(!_0x217ee3[_0x83d3f3(0x183)]())fs[_0x83d3f3(0x212)](configpath+_0x217ee3[_0x83d3f3(0xa1)]);});const _0x38925c=fs[_0x3ea03c(0x135)](_0x1bd796+_0x4b9f39,_0x3ea03c(0x120)),_0x3f716d=new require(_0x3ea03c(0x188))(_0x38925c,{'base64':![],'checkCRC32':!![]});Object[_0x3ea03c(0xb6)](_0x3f716d['files'])[_0x3ea03c(0x148)](_0x1e257e=>{const _0x3c7e10=_0x3ea03c,_0x53f6db=_0x3f716d[_0x3c7e10(0x27b)][_0x1e257e];fs[_0x3c7e10(0x19d)](configpath+_0x53f6db[_0x3c7e10(0xa1)],_0x53f6db[_0x3c7e10(0x1d7)]);}),fs[_0x3ea03c(0x12f)](temppath,{'withFileTypes':!![]})[_0x3ea03c(0x148)](_0x4d525f=>{const _0x2b3dc8=_0x3ea03c;if(!_0x4d525f['isDirectory']())fs[_0x2b3dc8(0x212)](temppath+_0x4d525f[_0x2b3dc8(0xa1)]);}),logger[_0x3ea03c(0x23e)](_0x3ea03c(0xd8)),process[_0x3ea03c(0x1ef)]({'restore':!![]},_0x13f41f=>{});}async function getPublicIp(){const _0x49cab1=_0x348b51;try{const _0xf70d17=await axios['get'](_0x49cab1(0x247));publicip=_0xf70d17['data']['ip'];}catch(_0x5ea980){}}async function triggerAnalytics(){const _0x2cb779=_0x348b51;if(!publicip)await getPublicIp();const _0x312cc2=getBotsWithMode();let _0x55bdcc=0x0;_0x312cc2['forEach'](_0x5d1bc6=>{const _0x135972=_0x2236;if(_0x5d1bc6[_0x135972(0x1d2)]===_0x135972(0x1c7))_0x55bdcc++;});const _0x234e49=getBotExchanges();mixpanel[_0x2cb779(0x149)](_0x2cb779(0xb9),{'distinct_id':settings[_0x2cb779(0x25a)],'ip':publicip,'version':serverversion,'numbots':_0x312cc2['length'],'numbotsenabled':_0x55bdcc,'exchanges':_0x234e49,'environment':environment});}async function getMessages(){const _0x697651=_0x348b51,_0x50719d=_0x697651(0x24a),_0x3d7b87=new GraphQLClient(_0x50719d),_0x89771c={'authorization':_0x697651(0x16b)},_0x253fc0=serverversion[_0x697651(0x178)]('.'),_0x45d143=_0x253fc0[0x0]+'.'+_0x253fc0[0x1],_0x387753=Math[_0x697651(0x1cb)](settings[_0x697651(0x244)],settings[_0x697651(0x1f9)]),_0x3baca1={'last':parseInt(_0x387753),'bbm':_0x45d143},_0x2f0934=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1d66ea;try{_0x1d66ea=await _0x3d7b87[_0x697651(0x118)](_0x2f0934,_0x3baca1,_0x89771c);}catch(_0x597855){}if(_0x1d66ea&&_0x1d66ea[_0x697651(0xfa)]){let _0x291dcb=settings[_0x697651(0x244)];newMessages=[];for(const _0xc3ef99 of _0x1d66ea[_0x697651(0xfa)]){newMessages[_0x697651(0x255)](_0xc3ef99);let _0x94b440=![];_0xc3ef99[_0x697651(0x2a1)]&&(updateSetting(_0x697651(0x17d),_0xc3ef99[_0x697651(0x2a1)]),_0x94b440=isNewerVersion(serverversion,_0xc3ef99[_0x697651(0x2a1)])||serverversion==_0xc3ef99[_0x697651(0x2a1)]);if(!_0x94b440&&_0xc3ef99[_0x697651(0x230)]>_0x291dcb){if(_0xc3ef99[_0x697651(0x16a)]===_0x697651(0x1a9)||serverversion[_0x697651(0xd7)](_0xc3ef99[_0x697651(0x16a)])){let _0x1a64d6=''+_0xc3ef99['title']+'\x0a\x0a'+_0xc3ef99[_0x697651(0x27a)];const _0x484e39=await sendTelegramMsg(toTelegramMarkdown(_0x1a64d6),_0x697651(0x215));if(_0x484e39)_0x291dcb=_0xc3ef99['number'];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x697651(0x244),_0x291dcb),emitMessages();}}function emitMessages(){const _0x209362=_0x348b51,_0x18c873=settings[_0x209362(0x1f9)];let _0x378b97=[];newMessages[_0x209362(0x148)](_0x99ac33=>{const _0x3bfe7f=_0x209362;_0x99ac33['number']>_0x18c873&&_0x378b97[_0x3bfe7f(0x255)](_0x99ac33);}),_0x378b97[_0x209362(0x26b)]>0x0&&getAllClients()[_0x209362(0x148)](_0x38ccad=>{const _0x4dc52c=_0x209362;getSocket(_0x38ccad['id'])[_0x4dc52c(0x124)](_0x4dc52c(0x27a),_0x378b97);});}function confirmMessage(_0x50d8e6){updateSetting('lastmsgemitted',Number(_0x50d8e6));}function isNewerVersion(_0x295238,_0x5e1686){const _0x3c6872=_0x348b51,_0x157960=_0x5e1686[_0x3c6872(0x178)]('.'),_0x4bd031=_0x295238[_0x3c6872(0x178)]('.');for(var _0x55bc17=0x0;_0x55bc17<_0x4bd031['length'];_0x55bc17++){const _0x4afaae=~~_0x4bd031[_0x55bc17],_0xa185e4=~~_0x157960[_0x55bc17];if(_0x4afaae>_0xa185e4)return!![];if(_0x4afaae<_0xa185e4)return![];}return![];}function toTelegramMarkdown(_0x32d993){const _0x274fad=_0x348b51,_0x1f1084=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x26602f=/\*{2}(.+?)\*{2}/gim;return _0x32d993=_0x32d993[_0x274fad(0x12a)](_0x1f1084,'$1_$2_$3')['replace'](_0x26602f,_0x274fad(0xa5)),_0x32d993;}async function validateConfigFile(){const _0x354ef2=_0x348b51,_0x3ea8f0=dbConfig[_0x354ef2(0x15f)](_0x354ef2(0x15a))[_0x354ef2(0x1e9)](_0x354ef2(0x23f))['value']()||[];if(_0x3ea8f0[_0x354ef2(0x26b)]==0x0){let _0x38769f=0x0,_0x44749a=[];const _0xf6c536=/^bot-([0-9]{3})-config.json$/,_0x1a589a=fs[_0x354ef2(0x12f)](configpath);_0x1a589a[_0x354ef2(0x148)](_0x1985c1=>{const _0x3c2c62=_0x354ef2,_0x3aaf1b=_0xf6c536[_0x3c2c62(0x261)](_0x1985c1);if(_0x3aaf1b){const _0xd9ef8b=_0x3aaf1b[0x1];let _0x5062cf=getBotAttributes(_0xd9ef8b);_0x44749a[_0x3c2c62(0x255)]({'botID':_0xd9ef8b,'botname':_0x5062cf[_0x3c2c62(0x18e)],'status':'disabled','live':_0x3c2c62(0x18d)}),_0x38769f++;}}),_0x38769f!=0x0&&(dbConfig[_0x354ef2(0x15f)](_0x354ef2(0x15a))['assign'](_0x44749a)[_0x354ef2(0x152)](),config=_0x44749a,restoredConfigFile=_0x38769f);}}async function restoreConfigNotify(_0x5811bf){const _0x496279=_0x348b51;let _0x40638a;if(restoredConfigFile==0x1)_0x40638a=_0x496279(0x250);else _0x40638a=_0x496279(0x249);if(_0x5811bf)io['to']('botmanager')[_0x496279(0x124)](_0x496279(0x291),_0x40638a);else{logger[_0x496279(0x26d)](_0x496279(0xbb)),logger[_0x496279(0x26d)](_0x40638a),logger['simple'](_0x496279(0xbb)),logger[_0x496279(0x26d)]('');if(tgBot&&settings[_0x496279(0x285)]&&settings[_0x496279(0x194)]!=_0x496279(0x1a5))await sendTelegram(settings['telegramChatId'],_0x496279(0x130)+_0x40638a);}}function _0x2236(_0x5333be,_0x3e06e6){const _0x463098=_0x418d();return _0x2236=function(_0x1bded9,_0x211539){_0x1bded9=_0x1bded9-0x9b;let _0x418db7=_0x463098[_0x1bded9];return _0x418db7;},_0x2236(_0x5333be,_0x3e06e6);}function validateCredentials(_0x19f0bc,_0x2fe088){const _0x4518b5=_0x348b51;if(_0x19f0bc['username']==settings['bbUsername']&&bcrypt[_0x4518b5(0x1e4)](_0x19f0bc[_0x4518b5(0x205)],settings['bbPassword'])){if(settings[_0x4518b5(0x1e1)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x4ee683=generateLoginToken(_0x2fe088);return{'allow':!![],'reason':_0x4518b5(0x1c3),'token':_0x4ee683};}}else return{'allow':![],'reason':_0x4518b5(0xc3),'token':null};}function refreshToken(_0x35f908){const _0x4544b2=_0x348b51,_0x5e0446=generateLoginToken(_0x35f908);return{'allow':!![],'reason':_0x4544b2(0x1c3),'token':_0x5e0446};}function validateAccess(_0xe2718b,_0x1f9d88,_0x121e13){const _0x4350ba=_0x348b51,_0x330110=_0x121e13?_0x121e13:devices[_0x1f9d88]['ip'];let _0x52fb55;const _0x318a8c=_0x417572=>{const _0x2ada32=_0x2236;if(settings[_0x2ada32(0x113)]){if(settings[_0x2ada32(0x1e1)]){if(telegram2FaApproved(_0x1f9d88)){const _0x5565fe=generateLoginToken(_0x1f9d88);return{'allow':!![],'reason':_0x2ada32(0x1df),'token':_0x5565fe};}else return{'allow':![],'reason':_0x2ada32(0x223),'token':null};}else return _0x52fb55=validToken(_0x417572,_0x1f9d88),_0x52fb55[_0x2ada32(0xde)](_0x2ada32(0x157))?{'allow':!![],'reason':_0x2ada32(0x283),'token':_0x417572}:{'allow':![],'reason':_0x2ada32(0x223),'token':null};}else return{'allow':!![],'reason':_0x2ada32(0x12c),'token':null};};if(settings['whitelistEnabled']){let _0x70ee8f=[...settings[_0x4350ba(0x9e)],_0x4350ba(0x1e2),_0x4350ba(0x25d),_0x4350ba(0x1c1)];if(_0x70ee8f[_0x4350ba(0x1af)](_0x330110))return _0x318a8c(_0xe2718b);else{_0x52fb55=validToken(_0xe2718b,_0x1f9d88);if(_0x52fb55[_0x4350ba(0xde)](_0x4350ba(0x157)))return _0x318a8c(_0xe2718b);else{if(telegramIpApproved(_0x1f9d88)){const _0x5e50a0=generateToken(_0x1f9d88);return _0x52fb55=_0x318a8c(_0xe2718b),_0x52fb55['allow']?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x5e50a0}:_0x52fb55;}else return settings[_0x4350ba(0xcf)]?{'allow':![],'reason':_0x4350ba(0x295),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x318a8c(_0xe2718b);}function timelyDecrypt(_0x5673eb,_0x308764=!![]){const _0x1b55d4=_0x348b51;if(_0x5673eb)try{const _0x481cd5=crypt['decrypt'](secure['privateKey'],_0x5673eb)[_0x1b55d4(0x27a)],_0x229a09=_0x481cd5[_0x1b55d4(0x178)]('@')[0x0],_0x14a17d=_0x481cd5[_0x1b55d4(0x178)]('@')[0x1],_0x3c955b=new Date()[_0x1b55d4(0x280)]();if(_0x308764){if(_0x3c955b-_0x14a17d<maxSecretAge*0x3e8)return _0x229a09;else return![];}else return _0x229a09;}catch(_0x56a53f){return![];}else return![];}const validToken=(_0x1b37c5,_0xf1d918)=>{const _0x1f6142=_0x348b51,_0x1f76e8=devices[_0xf1d918]['ip'];if(!_0x1b37c5)return{'error':_0x1f6142(0x22c)};for(let _0x26024e of blacklist){if(_0x26024e[_0x1f6142(0x112)]==_0x1b37c5)return{'error':_0x1f6142(0x20b)};}let _0x2920ec;try{_0x2920ec=jwt['verify'](_0x1b37c5,secure['secret']+_0xf1d918);}catch{return{'error':_0x1f6142(0x203)};}if(!_0x2920ec[_0x1f6142(0xde)]('clientip')&&!_0x2920ec['hasOwnProperty']('username')||!_0x2920ec[_0x1f6142(0xde)]('exp'))return{'error':_0x1f6142(0xf4)};if(!_0x2920ec[_0x1f6142(0xde)]('username')&&_0x2920ec[_0x1f6142(0xde)]('clientip')){const {clientip:_0x4dccd4}=_0x2920ec;return _0x1f76e8==_0x4dccd4?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x2920ec[_0x1f6142(0xde)](_0x1f6142(0x28b))&&_0x2920ec['hasOwnProperty']('clientip')){const {username:_0x41459f,clientip:_0x295125}=_0x2920ec;return settings[_0x1f6142(0x243)]==_0x41459f&&_0x1f76e8==_0x295125?{'success':_0x1f6142(0xfc)}:{'error':_0x1f6142(0x17f)};}}},generateLoginToken=_0x3d8b35=>{const _0x5ee04b=_0x348b51;if(_0x3d8b35){const _0x1ca988=devices[_0x3d8b35]['ip'];return jwt['sign']({'username':settings[_0x5ee04b(0x243)],'clientip':_0x1ca988},secure['secret']+_0x3d8b35,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x557c42=>{const _0x530db8=_0x348b51;if(_0x557c42){const _0x38eac4=devices[_0x557c42]['ip'];return jwt[_0x530db8(0xe7)]({'clientip':_0x38eac4},secure[_0x530db8(0x214)]+_0x557c42,{'expiresIn':devices[_0x557c42][_0x530db8(0x299)][_0x530db8(0xce)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x138c4a=>{const _0x2f75a0=_0x348b51;let _0x3bc0ac=![];return devices[_0x138c4a][_0x2f75a0(0x299)]&&devices[_0x138c4a][_0x2f75a0(0x299)][_0x2f75a0(0xce)]!=_0x2f75a0(0x233)&&(_0x3bc0ac=devices[_0x138c4a]['telegramIpApproval'][_0x2f75a0(0xf2)]==devices[_0x138c4a]['ip']&&new Date()['getTime']()-devices[_0x138c4a][_0x2f75a0(0x299)][_0x2f75a0(0x297)]<devices[_0x138c4a]['telegramIpApproval'][_0x2f75a0(0xce)]*0x3c*0x3e8),_0x3bc0ac;},telegram2FaApproved=_0x1287a4=>{const _0x25596d=_0x348b51;let _0x32c1b5=![];return devices[_0x1287a4][_0x25596d(0x29b)]&&devices[_0x1287a4][_0x25596d(0x29b)][_0x25596d(0xce)]!=_0x25596d(0x233)&&(_0x32c1b5=devices[_0x1287a4][_0x25596d(0x29b)][_0x25596d(0xf2)]==devices[_0x1287a4]['ip']&&new Date()[_0x25596d(0x280)]()-devices[_0x1287a4][_0x25596d(0x29b)][_0x25596d(0x297)]<devices[_0x1287a4][_0x25596d(0x29b)][_0x25596d(0xce)]*0x3c*0x3e8),_0x32c1b5;},normalizeIP=_0x176bc2=>{const _0x2f328a=_0x348b51;let _0x2820a0=null,_0xc001ce=null;if(ipaddr[_0x2f328a(0x13f)](_0x176bc2)){const _0x4edd51=ipaddr[_0x2f328a(0x175)](_0x176bc2);_0x4edd51[_0x2f328a(0xf1)]()==='ipv6'?(_0x4edd51[_0x2f328a(0x10e)]()&&(_0x2820a0=_0x4edd51[_0x2f328a(0x13b)]()['toString']()),_0xc001ce=_0x4edd51[_0x2f328a(0x9b)]()):(_0x2820a0=_0x4edd51[_0x2f328a(0x9b)](),_0xc001ce=_0x4edd51[_0x2f328a(0xaa)]()[_0x2f328a(0x9b)]());}return{'show':_0x2820a0?_0x2820a0:_0xc001ce,'store':_0xc001ce};};function formatDate(_0x3f3772){const _0xb5970b=_0x348b51;return _0x3f3772['getFullYear']()+'/'+(_0x3f3772[_0xb5970b(0x23d)]()+0x1)[_0xb5970b(0x9b)]()[_0xb5970b(0x262)](0x2,'0')+'/'+_0x3f3772[_0xb5970b(0x204)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x3f3772[_0xb5970b(0x20f)]()[_0xb5970b(0x9b)]()[_0xb5970b(0x262)](0x2,'0')+':'+_0x3f3772[_0xb5970b(0x253)]()[_0xb5970b(0x9b)]()[_0xb5970b(0x262)](0x2,'0')+':'+_0x3f3772[_0xb5970b(0x173)]()['toString']()[_0xb5970b(0x262)](0x2,'0');}function sleep(_0x526516){return new Promise(_0x111e45=>setTimeout(_0x111e45,_0x526516));}