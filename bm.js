const _0x51fe33=_0x21f2;(function(_0x4a2f5e,_0x4d689d){const _0x495d9d=_0x21f2,_0x21bdc7=_0x4a2f5e();while(!![]){try{const _0x47450a=parseInt(_0x495d9d(0x2ce))/0x1+-parseInt(_0x495d9d(0x201))/0x2*(-parseInt(_0x495d9d(0x255))/0x3)+-parseInt(_0x495d9d(0x302))/0x4+parseInt(_0x495d9d(0x215))/0x5+-parseInt(_0x495d9d(0x1ca))/0x6*(parseInt(_0x495d9d(0x230))/0x7)+parseInt(_0x495d9d(0x301))/0x8+-parseInt(_0x495d9d(0x1f4))/0x9;if(_0x47450a===_0x4d689d)break;else _0x21bdc7['push'](_0x21bdc7['shift']());}catch(_0x1cc071){_0x21bdc7['push'](_0x21bdc7['shift']());}}}(_0x382b,0xd2ff2));const _0x2196be=function(){let _0x151db0=!![];return function(_0x3198c6,_0x526b20){const _0x603226=_0x151db0?function(){if(_0x526b20){const _0x1462ac=_0x526b20['apply'](_0x3198c6,arguments);return _0x526b20=null,_0x1462ac;}}:function(){};return _0x151db0=![],_0x603226;};}(),_0x1eb327=_0x2196be(this,function(){const _0x16e9bb=_0x21f2;return _0x1eb327['toString']()[_0x16e9bb(0x333)](_0x16e9bb(0x229))[_0x16e9bb(0x33f)]()['constructor'](_0x1eb327)['search'](_0x16e9bb(0x229));});_0x1eb327();'use strict';process[_0x51fe33(0x2d9)][_0x51fe33(0x224)]=0x1;const childProcess=require(_0x51fe33(0x2dc)),fs=require('fs'),fns=require(_0x51fe33(0x21f)),low=require('lowdb'),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x51fe33(0x246)),crypto=require(_0x51fe33(0x342)),Crypt=require(_0x51fe33(0x2f7))['Crypt'],RSA=require(_0x51fe33(0x2f7))[_0x51fe33(0x1c3)],bcrypt=require('bcryptjs'),jwt=require(_0x51fe33(0x2a3)),ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process[_0x51fe33(0x2bf)][_0x51fe33(0x2c3)](0x2))[_0x51fe33(0x2bf)],uuidRandom=require(_0x51fe33(0x21d)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require('mixpanel'),axios=require(_0x51fe33(0x30f)),{GraphQLClient,gql}=require(_0x51fe33(0x23c)),util=require(_0x51fe33(0x26f)),fileUpload=require('express-fileupload'),PORT=argv[_0x51fe33(0x305)]||_0x51fe33(0x1d9),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console['log'](_0x51fe33(0x219)+PORT+_0x51fe33(0x1f6)),process[_0x51fe33(0x1aa)](0x1));const HOST=argv['host']||null,userID=argv[_0x51fe33(0x2bd)]||'';let bbpath=_0x51fe33(0x253),bbpath2='';const botfile=_0x51fe33(0x290),configfile='bb-config.json',settingsfile=_0x51fe33(0x338),securefile='bb-secure.json';let validInstallation=!![];!fs[_0x51fe33(0x282)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x51fe33(0x293)),configpath=userID?bbpath+_0x51fe33(0x2b7)+userID+'/':bbpath+_0x51fe33(0x2b7),configbackuppath=configpath+_0x51fe33(0x251),logspath=userID?bbpath+_0x51fe33(0x1cc)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x51fe33(0x31a),loggerfile=fs[_0x51fe33(0x1d7)](logspath+_0x51fe33(0x1cf),{'flags':'a'}),temppath=userID?bbpath+_0x51fe33(0x2ca)+userID+'/':bbpath+'temp/';!fs[_0x51fe33(0x282)](configpath)&&fs[_0x51fe33(0x24d)](configpath);!fs[_0x51fe33(0x282)](configbackuppath)&&fs[_0x51fe33(0x24d)](configbackuppath);!fs[_0x51fe33(0x282)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x51fe33(0x282)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x51fe33(0x282)](temppath)&&fs[_0x51fe33(0x24d)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x51fe33(0x234)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x51fe33(0x1c0)}})[_0x51fe33(0x346)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x51fe33(0x234)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x51fe33(0x227),'rsaStandard':_0x51fe33(0x1b9)});const saltRounds=0xa,mixpanel=Mixpanel[_0x51fe33(0x32e)](_0x51fe33(0x1d5),{'host':_0x51fe33(0x2e5)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x51fe33(0x259)]&&settings['telegramToken']!=''&&settings[_0x51fe33(0x1ac)]&&settings[_0x51fe33(0x1ac)]!='')initTelegram();const logger={'screen':_0x16eb3f=>{const _0x357edf=_0x51fe33;console[_0x357edf(0x2a5)](_0x16eb3f);},'simple':_0xe3a8e5=>{const _0x55e099=_0x51fe33;console['log'](_0xe3a8e5),loggerfile['write'](util[_0x55e099(0x2e6)](_0xe3a8e5)+'\x0a');},'full':async _0x11770c=>{const _0x4144b1=_0x51fe33,_0x2b7d85=getTimeStamp()+_0x4144b1(0x32b)+_0x11770c;console[_0x4144b1(0x2a5)](_0x2b7d85),loggerfile['write'](util[_0x4144b1(0x2e6)](_0x2b7d85)+'\x0a');if(tgBot&&settings[_0x4144b1(0x328)]&&settings[_0x4144b1(0x33d)]!=_0x4144b1(0x243))await tgBot[_0x4144b1(0x324)](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x11770c)[_0x4144b1(0x25b)](_0x1f4e1c=>{telegramError(_0x1f4e1c);});}};process['on']('uncaughtException',function(_0x1ec7df){logger['simple'](_0x1ec7df);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x51fe33(0x25e))[_0x51fe33(0x2f3)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x51fe33(0x316)),app=express(),http=require(_0x51fe33(0x20f))['createServer'](app);app[_0x51fe33(0x1bd)](fileUpload({'useTempFiles':!![]})),app[_0x51fe33(0x1fe)](_0x51fe33(0x1bb),async(_0x43aaba,_0x46b355)=>{const _0x4d58da=_0x51fe33,_0xb058f4=_0x43aaba['params'][_0x4d58da(0x30c)],_0x45cb56=getClientsWithBotID(_0x4d58da(0x228)),_0x335ab2=_0x43aaba[_0x4d58da(0x340)]['uuid'],_0x4616d6=timelyDecrypt(_0x335ab2,![]),_0x38ce01=_0x45cb56['find'](_0x1de5a3=>_0x1de5a3[_0x4d58da(0x29e)]==_0x4616d6);if(_0x38ce01){const _0x30462b=normalizeIP(_0x43aaba[_0x4d58da(0x343)][_0x4d58da(0x23a)])[_0x4d58da(0x2c4)],_0x390800=_0x43aaba[_0x4d58da(0x340)][_0x4d58da(0x307)];if(validateAccess(_0x390800,_0x4616d6,_0x30462b)[_0x4d58da(0x329)])await zipFiles(_0xb058f4),_0x46b355[_0x4d58da(0x2ef)](zippath+(_0xb058f4+_0x4d58da(0x2b3)),_0x275d00=>{const _0x1ed894=_0x4d58da;_0x275d00&&(logger[_0x1ed894(0x1df)](_0x1ed894(0x2af)+_0xb058f4),logger['simple'](_0x275d00));});else logger['full'](_0x4d58da(0x2e2)+_0xb058f4+_0x4d58da(0x2b4));}else logger[_0x4d58da(0x1df)](_0x4d58da(0x2e2)+_0xb058f4+_0x4d58da(0x279));}),app[_0x51fe33(0x33e)](_0x51fe33(0x1dc),async(_0x2d10f4,_0x5957ec)=>{const _0x5a1609=_0x51fe33,_0x34a235=getClientsWithBotID(_0x5a1609(0x228)),_0xee4932=_0x2d10f4[_0x5a1609(0x340)][_0x5a1609(0x29e)],_0x5aae95=timelyDecrypt(_0xee4932,![]),_0x11b52b=_0x34a235[_0x5a1609(0x25c)](_0x24f9eb=>_0x24f9eb['uuid']==_0x5aae95);if(_0x11b52b){const _0x1f0e7b=normalizeIP(_0x2d10f4[_0x5a1609(0x343)][_0x5a1609(0x23a)])['store'],_0x1b8294=_0x2d10f4[_0x5a1609(0x340)][_0x5a1609(0x307)];if(validateAccess(_0x1b8294,_0x5aae95,_0x1f0e7b)['allow']){if(_0x2d10f4[_0x5a1609(0x236)]){const _0x1d7819=_0x2d10f4[_0x5a1609(0x236)][_0x5a1609(0x292)];await _0x1d7819['mv'](temppath+_0x1d7819[_0x5a1609(0x1e0)]),_0x5957ec['send']({'status':!![],'message':_0x5a1609(0x239)}),confirmRestore(temppath,_0x1d7819[_0x5a1609(0x1e0)]);}}else logger[_0x5a1609(0x1df)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x5a1609(0x1df)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x51fe33(0x1bd)](express['static'](path['join'](__dirname,bbpath2,_0x51fe33(0x265)))),app['use'](express[_0x51fe33(0x273)](path[_0x51fe33(0x31d)](__dirname,bbpath2,_0x51fe33(0x2b8)))),app[_0x51fe33(0x1fe)]('/',function(_0x238c0b,_0x3cc1ec){const _0x1bbb4a=_0x51fe33;_0x3cc1ec[_0x1bbb4a(0x31c)](path['join'](__dirname,bbpath2,_0x1bbb4a(0x265),_0x1bbb4a(0x311)));}),app[_0x51fe33(0x1fe)](_0x51fe33(0x1c4),function(_0x287980,_0x3a2c45){const _0x8f2e89=_0x51fe33;_0x3a2c45[_0x8f2e89(0x31c)](path[_0x8f2e89(0x31d)](__dirname,bbpath2,_0x8f2e89(0x2b8),_0x8f2e89(0x311)));}),app[_0x51fe33(0x1fe)](_0x51fe33(0x306),(_0x20e5ac,_0x17258d)=>{const _0xaedc7b=_0x51fe33;_0x17258d[_0xaedc7b(0x31c)](path[_0xaedc7b(0x31d)](__dirname,bbpath2,_0xaedc7b(0x2b8),_0xaedc7b(0x311)));}),app['get'](_0x51fe33(0x317),(_0x22672a,_0x205021)=>{const _0x199126=_0x51fe33;_0x205021[_0x199126(0x31c)](path[_0x199126(0x31d)](__dirname,bbpath2,'build','index.html'));}),app[_0x51fe33(0x1fe)]('/:bot/coins',(_0x25776b,_0x816a9b)=>{const _0x39d224=_0x51fe33;_0x816a9b['sendFile'](path['join'](__dirname,bbpath2,_0x39d224(0x2b8),_0x39d224(0x311)));}),app['get'](_0x51fe33(0x21a),(_0xa73d1c,_0x39038a)=>{const _0x5174fd=_0x51fe33;_0x39038a[_0x5174fd(0x31c)](path['join'](__dirname,bbpath2,_0x5174fd(0x2b8),_0x5174fd(0x311)));}),app[_0x51fe33(0x1fe)](_0x51fe33(0x241),(_0x1da691,_0x38a095)=>{const _0x5a8e61=_0x51fe33;_0x38a095[_0x5a8e61(0x31c)](path[_0x5a8e61(0x31d)](__dirname,bbpath2,_0x5a8e61(0x2b8),'index.html'));}),app[_0x51fe33(0x1fe)]('/:bot/support',(_0x1a5850,_0x3f969a)=>{const _0x2b992b=_0x51fe33;_0x3f969a[_0x2b992b(0x31c)](path['join'](__dirname,bbpath2,'build',_0x2b992b(0x311)));});function _0x382b(){const _0x4dfa16=['set','new-disabled','messages','217252iqWdAX','get-logs','HTML','2FA\x20required','defaults','/names\x20-\x20show\x20bot\x20names\x0a','files','<b>Telegram\x20Bot\x20Status:</b>\x0a','Restoring\x20bot(s)\x20from\x20backup','File\x20uploaded','remoteAddress','blacklist','graphql-request','-results.json','reset-password','password','secure','/:bot/configuration','Ok,\x20will\x20send\x20alert\x20notifications\x20only','orders','Orders','telegram2FaApproval','path','access','secret','/status\x20-\x20show\x20bot(s)\x20status\x0a','starting\x20new\x20bot\x20|\x20Bot\x20','stringify','/restart\x20-\x20restart\x20bot(s)\x0a','mkdirSync','logout','removeListener','number','backup/','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','bb/','conn','3kfyMWC','parse','node-zip','bbvNew','telegramToken','Password\x20reset\x20rejected','catch','find','settings.','version.json','size','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','-config.json','Unauthorized\x20attempt\x20to\x20confirm\x20message','bots','get-portfolio','build2','/on\x20-\x20start\x20bot(s)\x0a','running','enabled','SIGINT','toggleBotMode','send','No\x20authentication\x20token','forEach','Unauthorized\x20attempt\x20to\x20update\x20bot','util','toIPv4Address','store-configuration','cancelLoading','static','notification','remove','update-bb','SIGTERM','reject','\x20(2)','getFullYear','connected','getSeconds','Access\x20enabled\x20for\x20','get-messages','onText','test','logs','existsSync','sendPortfolioTelegram','f2aRequired','Temporary\x20access\x20rejected','5\x20min','disconnect','hashSync','\x20>\x20','auth','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','***','2FA\x20login\x20required','sort','function','bot.js','output-000.log','backupfile','clients','</b>\x20?','store-settings','127.0.0.1','$1_$2_$3','pidRefreshToken','copyFileSync','track','output-002.log','Unauthorized\x20attempt\x20to\x20log\x20out','toIPv4MappedAddress','uuid','max','show','warning','output-003.log','jsonwebtoken','************','log','2FA','getPortfolio','listen','login\x20required','pidExpireLogin','getStartingBalances','backup','404\x20Not\x20Found','getDate','Failed\x20to\x20download\x20','all','min','chat','.zip','\x20(1)','access\x20timeout','expiry','config/','build','delete-alerts','login\x20token\x20generated','place-order','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','user','manual','argv','handshake','login\x20not\x20required','logged\x20out','slice','store','initclient','apiKey','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Unauthorized\x20attempt\x20to\x20get\x20portfolio','2FA\x20login\x20token\x20generated','temp/','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','order','mode','103679GgwBTc','push','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','yes','You\x20can\x20use\x20the\x20following\x20commands:\x0a','*$1*','\x20to\x20','callback_query','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Restore\x20process\x20aborted','Invalid\x20username\x20or\x20IP\x20address','env','Markdown','alias','child_process','emit','reason','auto','bbUsername','ipc','Unauthorized\x20attempt\x20to\x20download\x20','Unauthorized\x20attempt\x20to\x20store\x20configuration','simple','api-eu.mixpanel.com','format','sign','Notifications\x20enabled\x0a','polling_error','confirm-message','Invalid\x20authentication\x20token\x20(1)','success','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','toggle-bot-mode','download','Unauthorized\x20attempt\x20to\x20delete\x20bot','disabled\x20Bot\x20','All\x20bots','version','statSync','invalid\x20credentials','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','hybrid-crypto-js','add','assign','Bot\x20Mgr\x20>\x20','unlinkSync','temporary\x20access\x20rejected','emitHistory','stopPolling','telegramEnabled','30\x20min','2386080dCjdhn','4077796jkcasa','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','temporary\x20token\x20generated','port','/:bot/portfolio','tkn','/update\x20-\x20update\x20Balance\x20Bot\x0a','username','Alerts','started','type','getUTCHours','removeAllListeners','axios','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','index.html','bot-','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','socket.io','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','express','/:bot/performance','Bot\x20','lastmsgtelegram','zip/','answerCallbackQuery','sendFile','join','getTime','inherit','filter','data','All','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','sendMessage','Notifications\x20disabled','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','stopped','telegramChatId','allow','getMinutes',':\x20Bot\x20Mgr\x20>\x20','latestversion','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','init','writeFileSync','new','\x20only\x0a','file','search','match','sockets','once','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','bb-settings.json','timestamp','live','from','starting\x20bot\x20|\x20Bot\x20','telegramEvents','post','toString','headers','_data','crypto','socket','whitelist','hasOwnProperty','write','delete-bot','bbvReceive','showname','exit','Login\x20accepted','telegramUsername','includes','message','keys','get-starting-balances','deleteHistoryAlerts','/disable\x20-\x20disable\x20notifications\x0a','reload','Unauthorized\x20attempt\x20to\x20update\x20settings','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','lastmsgemitted','any','User\x20has\x20been\x20validated','RSA-OAEP','split','/download/:type','storeConfiguration','use','\x20minutes','output-001.log','0.0.0','botID','whitelistEnabled','RSA','/:bot','telegrammsg','stop','clientip','All\x20bots\x20running\x20right\x20now','/off\x20-\x20stop\x20bot(s)\x0a','96ZhPUzd','apiSecret','logs/','enabled\x20Bot\x20','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','/output-000.log','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','fork','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','readFileSync','6b67f3d61ee94b8f5c80b4affef4c4d9','padStart','createWriteStream','then','3000','error','event','/upload-backup','Unauthorized\x20attempt\x20to\x20get\x20messages','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','full','name','hex','map','login\x20token\x20valid','settings','isDirectory','readdirSync','bot','Notifications\x20types:\x20','alerts','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Notifications\x20enabled','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','status','replace','login',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','disabled','decrypt','title','4620060AeYQBJ','Do\x20you\x20want\x20to\x20reset\x20your\x20password?',',\x20must\x20be\x20a\x204\x20digit\x20number','add-bot','\x20|\x20','bbPassword','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Token\x20blacklisted','-----------------------------------------------------------------------------------','kill','get','encryptedUuid','exec','3046444ncqlBM','temporary\x20access\x20not\x20allowed','isIPv4MappedAddress','kind','Unauthorized\x20login\x20attempt\x20(timeout)','getHours','sortBy','token','loginRequired','15\x20min','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','telegram','https://api.ipify.org?format=json','Unauthorized\x20attempt\x20to\x20get\x20logs','http','verify','userid','privateKey','2FA\x20login\x20rejected','publicKey','4842230nhRDgp','error\x20while\x20deleting\x20config\x20files:\x20','getMonth','timeshift','Error:\x20Invalid\x20argument\x20','/:bot/history','generate','1000','uuid-random','randomBytes','date-fns','No\x20bots\x20running\x20right\x20now','length','botname','value','NTBA_FIX_319','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','binary','sha256','botmanager','(((.+)+)+)+$','Ok,\x20will\x20send\x20order\x20notifications\x20only','Invalid\x20IP\x20address','telegramIpApproval'];_0x382b=function(){return _0x4dfa16;};return _0x382b();}if(HOST)http[_0x51fe33(0x2a8)](PORT,HOST);else http['listen'](PORT);const io=require(_0x51fe33(0x314))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0xb5c7fb=_0x51fe33;logger['simple'](''),logger['simple']('-----------------------------------------------------------------------------------'),await logger[_0xb5c7fb(0x1df)](_0xb5c7fb(0x2cb)+PORT),logger[_0xb5c7fb(0x2e4)]('-----------------------------------------------------------------------------------');if(config[_0xb5c7fb(0x221)]!=0x0)for(const _0x59ffe6 of config){if(_0x59ffe6['status']==_0xb5c7fb(0x268)||_0x59ffe6[_0xb5c7fb(0x1ed)]==_0xb5c7fb(0x330))await logger['full'](_0xb5c7fb(0x33c)+_0x59ffe6[_0xb5c7fb(0x1c1)]+_0xb5c7fb(0x1f8)+_0x59ffe6[_0xb5c7fb(0x222)]),startBot([_0x59ffe6['botID'],userID],{'cwd':bbpath},function(_0x45da34){if(_0x45da34)logger['full'](_0x45da34);});else(_0x59ffe6[_0xb5c7fb(0x1ed)]=='disabled'||_0x59ffe6['status']==_0xb5c7fb(0x22e))&&await logger[_0xb5c7fb(0x1df)]('idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x59ffe6[_0xb5c7fb(0x1c1)]+_0xb5c7fb(0x1f8)+_0x59ffe6[_0xb5c7fb(0x222)]);}else!newBot&&logger[_0xb5c7fb(0x2e4)](_0xb5c7fb(0x1fa));if(newBot)addBot();logger['simple'](_0xb5c7fb(0x1fc)),logger[_0xb5c7fb(0x2e4)]('');}function startSocket(){io['on']('connection',_0xedf1b0=>{const _0x1e0390=_0x21f2;let _0x37c385,_0x22650a,_0x530872,_0x541c67,_0xb95ba7;const _0x382cc5=_0xedf1b0[_0x1e0390(0x2c0)][_0x1e0390(0x340)]['referer'];_0x22650a=_0x382cc5[_0x1e0390(0x334)](/bot[0-9]{3}/);if(_0x22650a)_0x530872=_0x22650a[0x0][_0x1e0390(0x334)](/[0-9]{3}/);if(_0x530872)_0x37c385=_0x530872[0x0];else _0x37c385=_0x1e0390(0x228);const _0x1c5a1e=_0xedf1b0[_0x1e0390(0x2c0)][_0x1e0390(0x28a)][_0x1e0390(0x1ff)];if(!_0x1c5a1e)_0xedf1b0['emit']('status',{'publicKey':secure['publicKey']});else{_0x541c67=timelyDecrypt(_0x1c5a1e,![]);if(!_0x541c67)_0xedf1b0[_0x1e0390(0x2dd)]('status',{'publicKey':secure[_0x1e0390(0x214)]});else{_0xb95ba7=normalizeIP(_0xedf1b0[_0x1e0390(0x254)]['remoteAddress'])[_0x1e0390(0x2c4)];if(!devices[_0x541c67])devices[_0x541c67]={'uuid':_0x541c67,'access':{'token':null}};devices[_0x541c67]['ip']=_0xb95ba7;const _0x234d46=addClient(_0xedf1b0['id'],_0x541c67,_0x37c385);setAccess(_0x234d46),emitMessages(),_0xedf1b0['on'](_0x1e0390(0x1ef),_0x42ae7b=>{const _0x7260dc=_0x1e0390,_0x489e21=timelyDecrypt(_0x42ae7b[_0x7260dc(0x23f)]);if(_0x489e21){_0x42ae7b={'username':_0x42ae7b[_0x7260dc(0x309)],'password':_0x489e21},devices[_0x541c67][_0x7260dc(0x247)]=validateCredentials(_0x42ae7b,_0x541c67);if(devices[_0x541c67]['access'][_0x7260dc(0x329)]==![]&&devices[_0x541c67][_0x7260dc(0x247)][_0x7260dc(0x2de)]=='2FA\x20login\x20required')_0xedf1b0[_0x7260dc(0x2dd)](_0x7260dc(0x1ed),{'access':devices[_0x541c67]['access']}),loginAccess2FA(_0x541c67,_0xb95ba7);else{if(devices[_0x541c67][_0x7260dc(0x247)][_0x7260dc(0x329)]==![]&&devices[_0x541c67][_0x7260dc(0x247)][_0x7260dc(0x2de)]==_0x7260dc(0x2f5))_0xedf1b0[_0x7260dc(0x2dd)](_0x7260dc(0x1ed),{'access':devices[_0x541c67][_0x7260dc(0x247)]});else devices[_0x541c67]['access'][_0x7260dc(0x329)]&&devices[_0x541c67]['access'][_0x7260dc(0x2de)]==_0x7260dc(0x2ba)&&(getClientsWithUuid(_0x541c67)[_0x7260dc(0x26d)](_0x13b907=>{setAccess(_0x13b907);}),setTokenRefresh(_0x541c67),setSessionTimeout(_0x7260dc(0x1ef),_0x541c67));}}else logger[_0x7260dc(0x1df)](_0x7260dc(0x205));}),_0xedf1b0['on'](_0x1e0390(0x23e),()=>{resetPassword();}),_0xedf1b0['on'](_0x1e0390(0x287),_0x55acd6=>{removeClient(_0xedf1b0['id']);}),_0x37c385==_0x1e0390(0x228)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x124d95){const _0x55129d=_0x51fe33;if(_0x124d95!=_0x55129d(0x228)&&config[_0x55129d(0x2c6)]!=''){if(pid[_0x124d95])pid[_0x124d95][_0x55129d(0x26b)]({'function':_0x55129d(0x2c5),'args':null});}}function reloadBotManager(){const _0x1289ef=_0x51fe33;getClientsWithBotID(_0x1289ef(0x228))[_0x1289ef(0x26d)](_0x43989e=>{const _0x3a0c3f=_0x1289ef;getSocket(_0x43989e['id'])[_0x3a0c3f(0x2dd)](_0x3a0c3f(0x1ed),{'access':{'allow':![],'reason':_0x3a0c3f(0x1b3),'token':null}});});}function getSocket(_0x268f75){const _0x1a5524=_0x51fe33;return io[_0x1a5524(0x335)]['sockets']['get'](_0x268f75);}function setAccess(_0x4e1abe){const _0x1dff38=_0x51fe33,_0x5cd42d=getSocket(_0x4e1abe['id']),_0x552916=_0x4e1abe[_0x1dff38(0x29e)],_0x23249f=_0x4e1abe[_0x1dff38(0x1e7)];devices[_0x552916][_0x1dff38(0x247)]=validateAccess(devices[_0x552916][_0x1dff38(0x247)][_0x1dff38(0x208)],_0x552916),_0x5cd42d['join'](_0x552916);if(devices[_0x552916][_0x1dff38(0x247)][_0x1dff38(0x329)]){_0x5cd42d['join'](_0x23249f);if(_0x23249f=='botmanager')initializeSocketBotManager(_0x5cd42d);else initializeSocketBot(_0x5cd42d);initClient(_0x23249f);}devices[_0x552916][_0x1dff38(0x247)][_0x1dff38(0x208)]&&devices[_0x552916][_0x1dff38(0x247)]['reason']==_0x1dff38(0x304)&&setSessionTimeout(_0x1dff38(0x2a6),_0x552916),devices[_0x552916][_0x1dff38(0x247)][_0x1dff38(0x208)]&&devices[_0x552916][_0x1dff38(0x247)][_0x1dff38(0x2de)]==_0x1dff38(0x2c9)&&setSessionTimeout(_0x1dff38(0x1ef),_0x552916),_0x5cd42d[_0x1dff38(0x2dd)](_0x1dff38(0x1ed),{'status':_0x4e1abe['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x552916][_0x1dff38(0x247)],'externalip':devices[_0x552916]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x552916]['access'][_0x1dff38(0x329)]==![]&&devices[_0x552916]['access']['reason']==_0x1dff38(0x233)&&temporaryAccess2FA(_0x552916,devices[_0x552916]['ip']);}function setSessionTimeout(_0x4a6d9f,_0x4c3af1){const _0x47ee95=_0x51fe33;let _0x3bea23;if(_0x4a6d9f==_0x47ee95(0x1ef))_0x3bea23=loginExpiry*0x3c*0x3e8;else _0x3bea23=devices[_0x4c3af1][_0x47ee95(0x22c)][_0x47ee95(0x2b6)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x4c3af1][_0x47ee95(0x22c)][_0x47ee95(0x339)]);if(devices[_0x4c3af1]['pidExpireLogin'])clearTimeout(devices[_0x4c3af1]['pidExpireLogin']);devices[_0x4c3af1][_0x47ee95(0x2aa)]=setTimeout(()=>{const _0x1614ee=_0x47ee95;if(devices[_0x4c3af1][_0x1614ee(0x298)])clearTimeout(devices[_0x4c3af1][_0x1614ee(0x298)]);removeSocketListeners(_0x4c3af1),addBlacklist(_0x4c3af1),devices[_0x4c3af1]['telegramIpApproval']=null,devices[_0x4c3af1][_0x1614ee(0x245)]=null,devices[_0x4c3af1][_0x1614ee(0x247)][_0x1614ee(0x208)]=null,devices[_0x4c3af1][_0x1614ee(0x247)]=validateAccess(devices[_0x4c3af1][_0x1614ee(0x247)][_0x1614ee(0x208)],_0x4c3af1),!(devices[_0x4c3af1][_0x1614ee(0x247)][_0x1614ee(0x329)]&&devices[_0x4c3af1][_0x1614ee(0x247)][_0x1614ee(0x2de)]==_0x1614ee(0x2c1))&&(_0x4a6d9f=='login'?io['to'](_0x4c3af1)['emit'](_0x1614ee(0x1ed),{'access':{'allow':![],'reason':_0x1614ee(0x2b5),'token':null}}):io['to'](_0x4c3af1)[_0x1614ee(0x2dd)](_0x1614ee(0x1ed),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x4c3af1][_0x1614ee(0x247)][_0x1614ee(0x208)]=null;},_0x3bea23);}function setTokenRefresh(_0x3125e7){const _0x46d86b=_0x51fe33;if(devices[_0x3125e7][_0x46d86b(0x298)])clearTimeout(devices[_0x3125e7][_0x46d86b(0x298)]);devices[_0x3125e7]['pidRefreshToken']=setTimeout(()=>{const _0x32cee6=_0x46d86b;getClientsWithUuid(_0x3125e7)[_0x32cee6(0x221)]!=0x0?(devices[_0x3125e7][_0x32cee6(0x247)]=refreshToken(_0x3125e7),io['to'](_0x3125e7)[_0x32cee6(0x2dd)]('status',{'status':_0x32cee6(0x27b),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x3125e7][_0x32cee6(0x247)],'externalip':devices[_0x3125e7]['ip'],'publicKey':secure[_0x32cee6(0x214)],'validInstallation':validInstallation}),setTokenRefresh(_0x3125e7)):clearTimeout(devices[_0x3125e7]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x9347b2){const _0xaf980f=_0x51fe33,_0x30cdba=getClient(_0x9347b2['id'])[_0xaf980f(0x29e)];_0x9347b2[_0xaf980f(0x2dd)](_0xaf980f(0x263),config),_0x9347b2['emit'](_0xaf980f(0x1e4),cleanSettings()),_0x9347b2['on'](_0xaf980f(0x1f7),_0x256201=>{const _0x756f01=_0xaf980f;if(validateAccess(_0x256201,_0x30cdba)[_0x756f01(0x329)])addBot();else logger[_0x756f01(0x1df)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x9347b2['on']('update-bot',(_0x51b236,_0xf53997)=>{const _0x3a1033=_0xaf980f;if(validateAccess(_0xf53997,_0x30cdba)[_0x3a1033(0x329)])toggleBot(_0x51b236[_0x3a1033(0x1c1)],_0x51b236['status'],_0x51b236[_0x3a1033(0x33a)]);else logger['full'](_0x3a1033(0x26e));}),_0x9347b2['on'](_0xaf980f(0x2ee),(_0x48b477,_0x377c0b)=>{const _0x5eca0a=_0xaf980f;if(validateAccess(_0x377c0b,_0x30cdba)[_0x5eca0a(0x329)])toggleBotMode(_0x48b477);else logger[_0x5eca0a(0x1df)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x9347b2['on'](_0xaf980f(0x347),(_0x3c285c,_0xfc78c3)=>{const _0x43cd0e=_0xaf980f;if(validateAccess(_0xfc78c3,_0x30cdba)[_0x43cd0e(0x329)])deleteBot(_0x3c285c);else logger['full'](_0x43cd0e(0x2f0));}),_0x9347b2['on'](_0xaf980f(0x295),(_0x5bb8b8,_0x4e279e)=>{const _0x5447ab=_0xaf980f;if(validateAccess(_0x4e279e,_0x30cdba)[_0x5447ab(0x329)])storeSettings(_0x5bb8b8,!![]);else logger['full'](_0x5447ab(0x1b4));}),_0x9347b2['on'](_0xaf980f(0x276),_0xf3f2c=>{const _0x5d6195=_0xaf980f;if(validateAccess(_0xf3f2c,_0x30cdba)['allow'])updateBB();else logger[_0x5d6195(0x1df)](_0x5d6195(0x2c7));}),_0x9347b2['on'](_0xaf980f(0x27e),_0x28f278=>{const _0x2418da=_0xaf980f;if(validateAccess(_0x28f278,_0x30cdba)[_0x2418da(0x329)])getMessages();else logger[_0x2418da(0x1df)](_0x2418da(0x1dd));}),_0x9347b2['on'](_0xaf980f(0x2ea),(_0x361750,_0x2d1df6)=>{const _0x116b9a=_0xaf980f;if(validateAccess(_0x2d1df6,_0x30cdba)[_0x116b9a(0x329)])confirmMessage(_0x361750);else logger[_0x116b9a(0x1df)](_0x116b9a(0x262));}),_0x9347b2['on'](_0xaf980f(0x24e),_0x1aefc0=>{const _0x549a91=_0xaf980f;if(validateAccess(_0x1aefc0,_0x30cdba)['allow']){if(devices[_0x30cdba][_0x549a91(0x298)])clearTimeout(devices[_0x30cdba][_0x549a91(0x298)]);if(devices[_0x30cdba][_0x549a91(0x2aa)])clearTimeout(devices[_0x30cdba][_0x549a91(0x2aa)]);removeSocketListeners(getClient(_0x9347b2['id'])[_0x549a91(0x29e)]),addBlacklist(_0x30cdba),devices[_0x30cdba]['telegramIpApproval']=null,devices[_0x30cdba]['telegram2FaApproval']=null,devices[_0x30cdba][_0x549a91(0x247)]['token']=null,io['to'](getClient(_0x9347b2['id'])['uuid'])[_0x549a91(0x2dd)](_0x549a91(0x1ed),{'access':{'allow':![],'reason':_0x549a91(0x2c2),'token':null}});}else logger['full'](_0x549a91(0x29c));});}function initializeSocketBot(_0xb9409e){const _0x198275=_0x51fe33,_0x134212=getClient(_0xb9409e['id'])[_0x198275(0x1e7)],_0x49fffa=getClient(_0xb9409e['id'])[_0x198275(0x29e)];_0xb9409e['on'](_0x198275(0x231),(_0x1b3230,_0x19eace)=>{const _0x3bd64e=_0x198275;if(validateAccess(_0x19eace,_0x49fffa)[_0x3bd64e(0x329)]){if(pid[_0x134212])pid[_0x134212][_0x3bd64e(0x26b)]({'function':_0x3bd64e(0x2fd),'args':_0x1b3230});}else logger[_0x3bd64e(0x1df)](_0x3bd64e(0x20e));}),_0xb9409e['on'](_0x198275(0x2b9),(_0x399abb,_0x1ab541)=>{const _0x589876=_0x198275;if(validateAccess(_0x1ab541,_0x49fffa)[_0x589876(0x329)]){if(pid[_0x134212])pid[_0x134212]['send']({'function':_0x589876(0x1b1),'args':_0x399abb});}else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0xb9409e['on'](_0x198275(0x264),(_0x5d4152,_0x7b99f)=>{const _0x1f9169=_0x198275;if(validateAccess(_0x7b99f,_0x49fffa)[_0x1f9169(0x329)]){if(pid[_0x134212])pid[_0x134212][_0x1f9169(0x26b)]({'function':_0x1f9169(0x2a7),'args':_0x5d4152});}else logger[_0x1f9169(0x1df)](_0x1f9169(0x2c8));}),_0xb9409e['on'](_0x198275(0x271),(_0x5d00a3,_0x596700)=>{const _0x545c0c=_0x198275;if(validateAccess(_0x596700,_0x49fffa)[_0x545c0c(0x329)]){if(pid[_0x134212])pid[_0x134212][_0x545c0c(0x26b)]({'function':_0x545c0c(0x1bc),'args':_0x5d00a3});}else logger['full'](_0x545c0c(0x2e3));}),_0xb9409e['on']('store-headless',(_0x4c39a9,_0x495911)=>{const _0x1a9cbc=_0x198275;if(validateAccess(_0x495911,_0x49fffa)[_0x1a9cbc(0x329)]){if(pid[_0x134212])pid[_0x134212][_0x1a9cbc(0x26b)]({'function':'storeHeadless','args':_0x4c39a9});}else logger[_0x1a9cbc(0x1df)](_0x1a9cbc(0x1ea));}),_0xb9409e['on'](_0x198275(0x1b0),_0x3d18e8=>{const _0x48b04a=_0x198275;if(validateAccess(_0x3d18e8,_0x49fffa)[_0x48b04a(0x329)]){if(pid[_0x134212])pid[_0x134212]['send']({'function':_0x48b04a(0x2ab),'args':null});}else logger[_0x48b04a(0x1df)](_0x48b04a(0x2f6));}),_0xb9409e['on'](_0x198275(0x2bb),(_0x404736,_0x1c83c8)=>{const _0x267cb2=_0x198275;if(validateAccess(_0x1c83c8,_0x49fffa)[_0x267cb2(0x329)]){if(pid[_0x134212])pid[_0x134212]['send']({'function':'placeOrder','args':_0x404736});}else logger[_0x267cb2(0x1df)](_0x267cb2(0x32d));}),_0xb9409e['on']('cancel-loading',_0x3c3e7b=>{const _0x3cde7c=_0x198275;if(validateAccess(_0x3c3e7b,_0x49fffa)[_0x3cde7c(0x329)]){if(pid[_0x134212])pid[_0x134212][_0x3cde7c(0x26b)]({'function':_0x3cde7c(0x272),'args':null});}else logger['full'](_0x3cde7c(0x326));}),_0xb9409e['on']('update-bb',_0x33ceca=>{const _0x296487=_0x198275;if(validateAccess(_0x33ceca,_0x49fffa)[_0x296487(0x329)])updateBB();else logger[_0x296487(0x1df)](_0x296487(0x2c7));}),_0xb9409e['on'](_0x198275(0x27e),_0x2f8dad=>{const _0xf2155f=_0x198275;if(validateAccess(_0x2f8dad,_0x49fffa)[_0xf2155f(0x329)])getMessages();else logger['full'](_0xf2155f(0x1dd));}),_0xb9409e['on'](_0x198275(0x2ea),(_0x1b43f7,_0x1eaed9)=>{const _0x42a5bf=_0x198275;if(validateAccess(_0x1eaed9,_0x49fffa)['allow'])confirmMessage(_0x1b43f7);else logger[_0x42a5bf(0x1df)](_0x42a5bf(0x262));}),_0xb9409e['on']('logout',_0x5675c5=>{const _0x22c9f4=_0x198275;if(validateAccess(_0x5675c5,_0x49fffa)['allow']){if(devices[_0x49fffa]['pidRefreshToken'])clearTimeout(devices[_0x49fffa][_0x22c9f4(0x298)]);if(devices[_0x49fffa]['pidExpireLogin'])clearTimeout(devices[_0x49fffa][_0x22c9f4(0x2aa)]);removeSocketListeners(getClient(_0xb9409e['id'])[_0x22c9f4(0x29e)]),addBlacklist(_0x49fffa),devices[_0x49fffa][_0x22c9f4(0x22c)]=null,devices[_0x49fffa][_0x22c9f4(0x245)]=null,devices[_0x49fffa][_0x22c9f4(0x247)]['token']=null,io['to'](getClient(_0xb9409e['id'])[_0x22c9f4(0x29e)])[_0x22c9f4(0x2dd)](_0x22c9f4(0x1ed),{'access':{'allow':![],'reason':_0x22c9f4(0x2c2),'token':null}});}else logger['full'](_0x22c9f4(0x29c));});}function removeSocketListeners(_0x5cc8ca){const _0x142647=_0x51fe33;getClientsWithUuid(_0x5cc8ca)[_0x142647(0x26d)](_0x474e86=>{const _0x1eb670=_0x142647;getSocket(_0x474e86['id'])[_0x1eb670(0x30e)]();});}function cleanSettings(){const _0x2d9d2d=_0x51fe33;let _0x1ad08a=settings;return settings['telegramToken']&&settings[_0x2d9d2d(0x259)]!=''&&(_0x1ad08a={..._0x1ad08a,'telegramToken':_0x2d9d2d(0x2a4)}),settings[_0x2d9d2d(0x1f9)]&&settings[_0x2d9d2d(0x1f9)]!=''&&(_0x1ad08a={..._0x1ad08a,'bbPassword':_0x2d9d2d(0x2a4)}),(settings[_0x2d9d2d(0x1f9)]&&settings['bbPassword']==_0x2d9d2d(0x28c)||settings['telegramToken']&&settings[_0x2d9d2d(0x259)]==_0x2d9d2d(0x28c))&&(_0x1ad08a={..._0x1ad08a,'restored':{'password':settings['bbPassword']=='***','telegram':settings['telegramToken']=='***'}}),_0x1ad08a;}function updateBB(){const _0x551a67=_0x51fe33;installingUpdate=!![],config[_0x551a67(0x26d)](_0x55f6d3=>{restartBot(_0x55f6d3['botID']);}),process['send']({'update':!![]},_0x28a46d=>{});}function startBot(_0x493694,_0xeb6b50,_0x552ff4){const _0x278003=_0x51fe33;let _0x11b692=![];const _0x272dc7=_0x493694[0x0];_0xeb6b50={..._0xeb6b50,'stdio':[_0x278003(0x31f),_0x278003(0x31f),_0x278003(0x31f),_0x278003(0x2e1)]},pid[_0x272dc7]=childProcess[_0x278003(0x1d1)](botfile,_0x493694,_0xeb6b50),pid[_0x272dc7]['on'](_0x278003(0x1ae),_0x301342=>{const _0x5da867=_0x278003;switch(Object['keys'](_0x301342)[0x0]){case'botname':updateBotName(_0x272dc7,_0x301342['botname']);break;case'updatebotmanager':updateBotManager();break;case _0x5da867(0x1ed):updateStatus(_0x272dc7,_0x301342[_0x5da867(0x1ed)]);break;case _0x5da867(0x33a):updateLive(_0x272dc7,_0x301342[_0x5da867(0x33a)]);break;case _0x5da867(0x30b):updateLive(_0x272dc7,_0x301342[_0x5da867(0x30b)]),io['to'](_0x272dc7)['emit'](_0x5da867(0x1ed),{'access':{'allow':![],'reason':'reload','token':null}});break;case'stop':_0x301342[_0x5da867(0x1c6)]=='restart'&&restartBot(_0x272dc7);_0x301342[_0x5da867(0x1c6)]==_0x5da867(0x1fd)&&toggleBot(_0x272dc7,_0x5da867(0x1f1),_0x5da867(0x327));break;case'telegram':sendTelegram(_0x272dc7,_0x301342[_0x5da867(0x20c)]);break;case _0x5da867(0x1c5):sendTelegramMsg(_0x301342[_0x5da867(0x1c5)]);break;case _0x5da867(0x28f):io['to'](_0x272dc7)[_0x5da867(0x2dd)](_0x301342[_0x5da867(0x28f)],_0x301342['args']);break;}}),pid[_0x272dc7]['on']('error',function(_0x52d271){if(_0x11b692)return;_0x11b692=!![],_0x552ff4(_0x52d271);}),pid[_0x272dc7]['on'](_0x278003(0x1aa),async function(_0x567475){const _0x4c97ee=_0x278003;if(installingUpdate)return;if(_0x11b692)return;_0x11b692=!![],_0x552ff4(null);const _0x35140d=dbConfig['get'](_0x4c97ee(0x263))[_0x4c97ee(0x25c)]({'botID':_0x272dc7})[_0x4c97ee(0x223)]();_0x35140d&&(_0x35140d[_0x4c97ee(0x1ed)]==_0x4c97ee(0x268)||_0x35140d[_0x4c97ee(0x1ed)]==_0x4c97ee(0x330))&&(await sleep(0x3e8),updateLive(_0x272dc7,_0x4c97ee(0x327)),logger[_0x4c97ee(0x1df)]('restarting\x20Bot\x20'+_0x272dc7),startBot([_0x272dc7,userID],{'cwd':bbpath},function(_0x39b4d3){const _0x4926f7=_0x4c97ee;if(_0x39b4d3)logger[_0x4926f7(0x1df)](_0x39b4d3);}));});}function stopBot(_0x3b4554){const _0x50aefb=_0x51fe33;getClientsWithBotID(_0x3b4554)[_0x50aefb(0x26d)](_0x1152bc=>{const _0xbc5fde=_0x50aefb;getSocket(_0x1152bc['id'])[_0xbc5fde(0x287)](!![]),removeClient(_0x1152bc['id']);}),pid[_0x3b4554]&&(pid[_0x3b4554][_0x50aefb(0x1fd)](),pid[_0x3b4554]=null);}function restartBot(_0x3b6b3b){const _0x43ecd4=_0x51fe33;if(pid[_0x3b6b3b])pid[_0x3b6b3b][_0x43ecd4(0x1fd)]();}function addBot(){const _0x10a02d=_0x51fe33;let _0x1d4a56;for(let _0x48acc2=0x1;_0x48acc2<0x3e9;_0x48acc2++){_0x1d4a56=_0x48acc2['toString']()['padStart'](0x3,'0');let _0x3cee6e=config[_0x10a02d(0x25c)](_0x5daa69=>_0x5daa69[_0x10a02d(0x1c1)]==_0x1d4a56);if(!_0x3cee6e)break;}if(_0x1d4a56===_0x10a02d(0x21c)){logger[_0x10a02d(0x1df)](_0x10a02d(0x310));return;}logger[_0x10a02d(0x1df)](_0x10a02d(0x24a)+_0x1d4a56),dbConfig[_0x10a02d(0x1fe)](_0x10a02d(0x263))[_0x10a02d(0x2cf)]({'botID':_0x1d4a56,'botname':_0x10a02d(0x318)+_0x1d4a56,'status':_0x10a02d(0x330),'live':''})['write'](),startBot([_0x1d4a56,userID],{'cwd':bbpath},function(_0x5d12dd){if(_0x5d12dd)logger['full'](_0x5d12dd);}),config=getConfiguration(),io['to'](_0x10a02d(0x228))[_0x10a02d(0x2dd)](_0x10a02d(0x263),config);}function deleteBot(_0x388d4a){const _0x58a19b=_0x51fe33;getClientsWithBotID(_0x388d4a)[_0x58a19b(0x26d)](_0x55da7f=>{const _0x14904b=_0x58a19b;getSocket(_0x55da7f['id'])[_0x14904b(0x287)](!![]),removeClient(_0x55da7f['id']);}),dbConfig[_0x58a19b(0x1fe)](_0x58a19b(0x263))[_0x58a19b(0x275)]({'botID':_0x388d4a})[_0x58a19b(0x346)](),logger[_0x58a19b(0x1df)]('deleted\x20Bot\x20'+_0x388d4a),stopBot(_0x388d4a);try{fs[_0x58a19b(0x2fb)](path[_0x58a19b(0x31d)](configpath,_0x58a19b(0x312)+_0x388d4a+_0x58a19b(0x261))),fs[_0x58a19b(0x2fb)](path['join'](configpath,_0x58a19b(0x312)+_0x388d4a+'-events.json')),fs['unlinkSync'](path[_0x58a19b(0x31d)](configpath,_0x58a19b(0x312)+_0x388d4a+'-performance.json')),fs[_0x58a19b(0x2fb)](path[_0x58a19b(0x31d)](configpath,_0x58a19b(0x312)+_0x388d4a+_0x58a19b(0x23d)));}catch(_0x36e248){if(_0x36e248)logger['full'](_0x58a19b(0x216),_0x36e248);}config=getConfiguration(),io['to'](_0x58a19b(0x228))[_0x58a19b(0x2dd)](_0x58a19b(0x263),config);}function toggleBot(_0x39e7eb,_0x5a1198,_0x49eb62){const _0xeeac25=_0x51fe33;dbConfig[_0xeeac25(0x1fe)]('bots')[_0xeeac25(0x25c)]({'botID':_0x39e7eb})['assign']({'status':_0x5a1198})['assign']({'live':_0x49eb62})[_0xeeac25(0x346)]();if(_0x5a1198=='enabled'||_0x5a1198==_0xeeac25(0x330))logger[_0xeeac25(0x1df)](_0xeeac25(0x1cd)+_0x39e7eb),startBot([_0x39e7eb,userID],{'cwd':bbpath},function(_0x1f0e18){const _0x3f67ba=_0xeeac25;if(_0x1f0e18)logger[_0x3f67ba(0x1df)](_0x1f0e18);});else(_0x5a1198==_0xeeac25(0x1f1)||_0x5a1198==_0xeeac25(0x22e))&&(logger[_0xeeac25(0x1df)](_0xeeac25(0x2f1)+_0x39e7eb),stopBot(_0x39e7eb));config=getConfiguration(),io['to'](_0xeeac25(0x228))[_0xeeac25(0x2dd)](_0xeeac25(0x263),config);}function toggleStatus(_0x26fedf){const _0x8f9a0d=_0x51fe33;let _0x3b10e9=dbConfig['get']('bots')['find']({'botID':_0x26fedf})[_0x8f9a0d(0x223)](),_0x1be85d;if(_0x3b10e9['status']===_0x8f9a0d(0x268))_0x1be85d='disabled';else{if(_0x3b10e9['status']===_0x8f9a0d(0x330))_0x1be85d=_0x8f9a0d(0x22e);else{if(_0x3b10e9['status']==='new-disabled')_0x1be85d='new';else{if(_0x3b10e9[_0x8f9a0d(0x1ed)]==='disabled')_0x1be85d=_0x8f9a0d(0x268);}}}return _0x1be85d;}function updateStatus(_0x404a60,_0x5cdf84){const _0x35e761=_0x51fe33;dbConfig[_0x35e761(0x1fe)](_0x35e761(0x263))[_0x35e761(0x25c)]({'botID':_0x404a60})[_0x35e761(0x2f9)]({'status':_0x5cdf84})[_0x35e761(0x346)](),config=getConfiguration(),io['to'](_0x35e761(0x228))[_0x35e761(0x2dd)](_0x35e761(0x263),config);}function updateLive(_0x4d04d8,_0x383724){const _0x5824c6=_0x51fe33;dbConfig[_0x5824c6(0x1fe)]('bots')[_0x5824c6(0x25c)]({'botID':_0x4d04d8})[_0x5824c6(0x2f9)]({'live':_0x383724})[_0x5824c6(0x346)](),config=getConfiguration(),io['to'](_0x5824c6(0x228))[_0x5824c6(0x2dd)]('bots',config);}function updateBotName(_0x472241,_0x9c714){const _0x4f18ca=_0x51fe33;dbConfig[_0x4f18ca(0x1fe)]('bots')[_0x4f18ca(0x25c)]({'botID':_0x472241})[_0x4f18ca(0x2f9)]({'botname':_0x9c714})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x4f18ca(0x2dd)](_0x4f18ca(0x263),config);}function updateBotManager(){const _0x2a5831=_0x51fe33;config=getConfiguration(),io['to'](_0x2a5831(0x228))['emit'](_0x2a5831(0x263),config);}function toggleBotMode(_0x5bf20b){const _0x534ffc=_0x51fe33;if(pid[_0x5bf20b])pid[_0x5bf20b]['send']({'function':_0x534ffc(0x26a),'args':null});else{const _0x731d01=configpath+_0x534ffc(0x312)+_0x5bf20b+_0x534ffc(0x261),_0x34d9e9=fs[_0x534ffc(0x1d4)](_0x731d01),_0x4374c8=JSON[_0x534ffc(0x256)](_0x34d9e9),_0x36c860=_0x4374c8[_0x534ffc(0x1e7)][0x0]['headless'];_0x4374c8[_0x534ffc(0x1e7)][0x0]['headless']=!_0x36c860;const _0x182264=JSON[_0x534ffc(0x24b)](_0x4374c8,null,0x2);fs[_0x534ffc(0x32f)](_0x731d01,_0x182264),config=getConfiguration(),io['to'](_0x534ffc(0x228))[_0x534ffc(0x2dd)](_0x534ffc(0x263),config);}}function telegramError(_0x5b6881){const _0xaf32e=_0x51fe33;logger['simple'](getTimeStamp()+_0xaf32e(0x1f0));}function validateTelegram(_0x440796){const _0x38cb45=_0x51fe33;if(_0x440796['from']['username']!=settings[_0x38cb45(0x1ac)]&&'@'+_0x440796[_0x38cb45(0x33b)]['username']!=settings[_0x38cb45(0x1ac)])return tgBot[_0x38cb45(0x324)](_0x440796[_0x38cb45(0x2b2)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x38cb45(0x232)})[_0x38cb45(0x25b)](_0x518e7f=>{telegramError(_0x518e7f);}),![];return!![];}async function initTelegram(){const _0x943e6d=_0x51fe33;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x943e6d(0x259)],{'polling':!![]});let _0x18b36d=_0x943e6d(0x2d2);_0x18b36d+='\x0a',_0x18b36d+='/enable\x20-\x20enable\x20notifications\x0a',_0x18b36d+=_0x943e6d(0x1b2),_0x18b36d+=_0x943e6d(0x28b),_0x18b36d+=_0x943e6d(0x24c),_0x18b36d+=_0x943e6d(0x266),_0x18b36d+=_0x943e6d(0x1c9),_0x18b36d+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x18b36d+=_0x943e6d(0x235),_0x18b36d+=_0x943e6d(0x249),_0x18b36d+=_0x943e6d(0x1ce),_0x18b36d+=_0x943e6d(0x308),_0x18b36d+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x6d47b='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x6d47b+='\x0a',_0x6d47b+=_0x18b36d,tgBot[_0x943e6d(0x27f)](/\/start/,_0x271b49=>{const _0x27d61a=_0x943e6d;if(!validateTelegram(_0x271b49))return;if(settings['telegramChatId']!=_0x271b49['chat']['id'])updateSetting(_0x27d61a(0x328),_0x271b49[_0x27d61a(0x2b2)]['id']);updateSetting(_0x27d61a(0x2ff),!![]),tgBot[_0x27d61a(0x324)](_0x271b49[_0x27d61a(0x2b2)]['id'],_0x6d47b)['catch'](_0xdd1982=>{telegramError(_0xdd1982);});}),tgBot[_0x943e6d(0x27f)](/\/enable/,_0x26ae67=>{const _0x3b1096=_0x943e6d;if(!validateTelegram(_0x26ae67))return;if(settings[_0x3b1096(0x328)]!=_0x26ae67['chat']['id'])updateSetting(_0x3b1096(0x328),_0x26ae67[_0x3b1096(0x2b2)]['id']);updateSetting(_0x3b1096(0x2ff),!![]),tgBot[_0x3b1096(0x324)](_0x26ae67['chat']['id'],_0x3b1096(0x1eb))[_0x3b1096(0x25b)](_0x5dd326=>{telegramError(_0x5dd326);});}),tgBot[_0x943e6d(0x27f)](/\/config/,async _0x50e28e=>{const _0xded48c=_0x943e6d;if(!validateTelegram(_0x50e28e))return;tgBot['removeListener'](_0xded48c(0x2d5)),tgBot[_0xded48c(0x324)](_0x50e28e[_0xded48c(0x2b2)]['id'],_0xded48c(0x2d0),{'reply_markup':{'inline_keyboard':[[{'text':_0xded48c(0x244),'callback_data':_0xded48c(0x243)},{'text':_0xded48c(0x30a),'callback_data':'alerts'},{'text':_0xded48c(0x322),'callback_data':'all'}]]}})['catch'](_0x5971f4=>{telegramError(_0x5971f4);}),tgBot['on'](_0xded48c(0x2d5),async _0x59b6c0=>{const _0x41f8de=_0xded48c,_0x2061cd=_0x59b6c0[_0x41f8de(0x321)],_0xae4f3f=_0x59b6c0['message'];tgBot[_0x41f8de(0x31b)](_0x59b6c0['id'])[_0x41f8de(0x1d8)](async()=>{const _0x420c3d=_0x41f8de;_0x2061cd==_0x420c3d(0x243)&&(updateSetting(_0x420c3d(0x33d),_0x420c3d(0x243)),updateSetting('telegramEnabled',!![]),await tgBot[_0x420c3d(0x324)](_0xae4f3f['chat']['id'],_0x420c3d(0x22a))[_0x420c3d(0x25b)](_0xb91bc3=>{telegramError(_0xb91bc3);}));_0x2061cd==_0x420c3d(0x1e9)&&(updateSetting('telegramEvents',_0x420c3d(0x1e9)),updateSetting(_0x420c3d(0x2ff),!![]),await tgBot[_0x420c3d(0x324)](_0xae4f3f[_0x420c3d(0x2b2)]['id'],_0x420c3d(0x242))[_0x420c3d(0x25b)](_0x1fbb1e=>{telegramError(_0x1fbb1e);}));_0x2061cd=='all'&&(updateSetting('telegramEvents',_0x420c3d(0x2b0)),updateSetting('telegramEnabled',!![]),await tgBot[_0x420c3d(0x324)](_0xae4f3f[_0x420c3d(0x2b2)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x420c3d(0x25b)](_0xc8a519=>{telegramError(_0xc8a519);}));if(!settings[_0x420c3d(0x328)])tgBot[_0x420c3d(0x324)](_0xae4f3f['chat']['id'],_0x420c3d(0x225))[_0x420c3d(0x25b)](_0xc6d0e=>{telegramError(_0xc6d0e);});}),tgBot[_0x41f8de(0x24f)](_0x41f8de(0x2d5));});}),tgBot[_0x943e6d(0x27f)](/\/status/,_0x621a6f=>{const _0x18c2db=_0x943e6d;if(!validateTelegram(_0x621a6f))return;const _0x1a37eb=getBotsWithMode();let _0x2d9faa='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x18c2db(0x26d)](_0x16932e=>{const _0x4152e2=_0x18c2db,_0x487be0=_0x1a37eb[_0x4152e2(0x25c)](_0x15b792=>_0x15b792[_0x4152e2(0x1c1)]==_0x16932e[_0x4152e2(0x1c1)])[_0x4152e2(0x2cd)];_0x2d9faa+=_0x4152e2(0x318)+_0x16932e['botID']+':\x20'+_0x16932e[_0x4152e2(0x1ed)]+_0x4152e2(0x1f8)+_0x487be0+'\x20|\x20'+_0x16932e[_0x4152e2(0x33a)]+'\x0a';}),_0x2d9faa+='\x0a',_0x2d9faa+=_0x18c2db(0x237),_0x2d9faa+=!settings[_0x18c2db(0x2ff)]?'Notifications\x20disabled\x0a':_0x18c2db(0x2e8),_0x2d9faa+=settings[_0x18c2db(0x2ff)]?settings[_0x18c2db(0x33d)]=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x18c2db(0x1e8)+settings[_0x18c2db(0x33d)]+_0x18c2db(0x331):'',tgBot[_0x18c2db(0x324)](_0x621a6f[_0x18c2db(0x2b2)]['id'],_0x2d9faa,{'parse_mode':_0x18c2db(0x232)})[_0x18c2db(0x25b)](_0x3940c2=>{telegramError(_0x3940c2);});}),tgBot['onText'](/\/restart/,_0x5ec50c=>{const _0x1c3033=_0x943e6d;if(!validateTelegram(_0x5ec50c))return;tgBot['removeListener']('callback_query');const _0x486a0c=getEnabledBots();if(_0x486a0c['length']==0x0)tgBot[_0x1c3033(0x324)](_0x5ec50c[_0x1c3033(0x2b2)]['id'],_0x1c3033(0x220))[_0x1c3033(0x25b)](_0x5179b4=>{telegramError(_0x5179b4);});else{if(_0x486a0c[_0x1c3033(0x221)]>0x1)_0x486a0c[_0x1c3033(0x2cf)]({'botID':_0x1c3033(0x2b0)});let _0x1eb515=[],_0x34da41=[];const _0x5bcdca=_0x486a0c[_0x1c3033(0x221)]%0x4==0x0||_0x486a0c[_0x1c3033(0x221)]%0x4==0x3||_0x486a0c[_0x1c3033(0x221)]%0x3==0x1?0x4:0x3;let _0x5e41fe=0x0;_0x486a0c[_0x1c3033(0x26d)]((_0x14efa5,_0x3a046e)=>{const _0x27b63a=_0x1c3033;if(_0x3a046e%_0x5bcdca==0x0)_0x34da41=[];_0x34da41[_0x27b63a(0x2cf)]({'text':_0x14efa5[_0x27b63a(0x1c1)]==_0x27b63a(0x2b0)?'All\x20bots':'Bot\x20'+_0x14efa5['botID'],'callback_data':_0x14efa5[_0x27b63a(0x1c1)]}),_0x3a046e%_0x5bcdca==0x0&&(_0x1eb515[_0x5e41fe]=_0x34da41,_0x5e41fe++);}),tgBot[_0x1c3033(0x324)](_0x5ec50c[_0x1c3033(0x2b2)]['id'],_0x1c3033(0x252),{'reply_markup':{'inline_keyboard':_0x1eb515}})['catch'](_0x55dd84=>{telegramError(_0x55dd84);}),tgBot['on'](_0x1c3033(0x2d5),async _0x515b48=>{const _0x4d2579=_0x1c3033,_0x3459a6=_0x515b48[_0x4d2579(0x321)],_0x22798f=_0x515b48[_0x4d2579(0x1ae)];tgBot[_0x4d2579(0x31b)](_0x515b48['id'])['then'](async()=>{const _0x1b95ac=_0x4d2579;_0x3459a6==_0x1b95ac(0x2b0)?config[_0x1b95ac(0x26d)](_0x34a32d=>{const _0x5414a9=_0x1b95ac;restartBot(_0x34a32d[_0x5414a9(0x1c1)]);}):restartBot(_0x3459a6);}),tgBot[_0x4d2579(0x24f)](_0x4d2579(0x2d5));});}}),tgBot[_0x943e6d(0x27f)](/\/on/,_0x82a34a=>{const _0xb28b09=_0x943e6d;if(!validateTelegram(_0x82a34a))return;tgBot[_0xb28b09(0x24f)](_0xb28b09(0x2d5));const _0x1920dc=getDisabledBots();if(_0x1920dc[_0xb28b09(0x221)]==0x0)tgBot[_0xb28b09(0x324)](_0x82a34a['chat']['id'],_0xb28b09(0x1c8))[_0xb28b09(0x25b)](_0x29023f=>{telegramError(_0x29023f);});else{if(_0x1920dc[_0xb28b09(0x221)]>0x1)_0x1920dc[_0xb28b09(0x2cf)]({'botID':'all'});let _0x16e992=[],_0x3dc18f=[];const _0xa71990=_0x1920dc[_0xb28b09(0x221)]%0x4==0x0||_0x1920dc[_0xb28b09(0x221)]%0x4==0x3||_0x1920dc['length']%0x3==0x1?0x4:0x3;let _0x4d9bb3=0x0;_0x1920dc[_0xb28b09(0x26d)]((_0x334231,_0x22801e)=>{const _0x40567e=_0xb28b09;if(_0x22801e%_0xa71990==0x0)_0x3dc18f=[];_0x3dc18f[_0x40567e(0x2cf)]({'text':_0x334231[_0x40567e(0x1c1)]=='all'?_0x40567e(0x2f2):_0x40567e(0x318)+_0x334231['botID'],'callback_data':_0x334231['botID']}),_0x22801e%_0xa71990==0x0&&(_0x16e992[_0x4d9bb3]=_0x3dc18f,_0x4d9bb3++);}),tgBot[_0xb28b09(0x324)](_0x82a34a['chat']['id'],_0xb28b09(0x1d3),{'reply_markup':{'inline_keyboard':_0x16e992}})[_0xb28b09(0x25b)](_0x5e9e57=>{telegramError(_0x5e9e57);}),tgBot['on']('callback_query',async _0xc1dfbb=>{const _0x51372b=_0xb28b09,_0x3d169c=_0xc1dfbb['data'],_0xff7a68=_0xc1dfbb[_0x51372b(0x1ae)];tgBot[_0x51372b(0x31b)](_0xc1dfbb['id'])['then'](async()=>{const _0x3ee2d=_0x51372b;_0x3d169c==_0x3ee2d(0x2b0)?(tgBot[_0x3ee2d(0x324)](_0xff7a68['chat']['id'],_0x3ee2d(0x1d0))['catch'](_0x34ed97=>{telegramError(_0x34ed97);}),_0x1920dc['forEach'](_0x42fc4f=>{const _0x85f7=_0x3ee2d;if(_0x42fc4f['botID']!='all')toggleBot(_0x42fc4f[_0x85f7(0x1c1)],toggleStatus(_0x42fc4f['botID']),_0x85f7(0x327));})):(tgBot[_0x3ee2d(0x324)](_0xff7a68[_0x3ee2d(0x2b2)]['id'],_0x3ee2d(0x2ed)+_0x3d169c)['catch'](_0x49ad91=>{telegramError(_0x49ad91);}),toggleBot(_0x3d169c,toggleStatus(_0x3d169c),_0x3ee2d(0x327)));}),tgBot[_0x51372b(0x24f)]('callback_query');});}}),tgBot[_0x943e6d(0x27f)](/\/off/,_0x1a138a=>{const _0x4a65fa=_0x943e6d;if(!validateTelegram(_0x1a138a))return;tgBot[_0x4a65fa(0x24f)]('callback_query');const _0x3154ec=getEnabledBots();if(_0x3154ec[_0x4a65fa(0x221)]==0x0)tgBot[_0x4a65fa(0x324)](_0x1a138a[_0x4a65fa(0x2b2)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x4a65fa(0x25b)](_0x9f793c=>{telegramError(_0x9f793c);});else{if(_0x3154ec[_0x4a65fa(0x221)]>0x1)_0x3154ec['push']({'botID':_0x4a65fa(0x2b0)});let _0x41c78e=[],_0x160c58=[];const _0x519ccd=_0x3154ec[_0x4a65fa(0x221)]%0x4==0x0||_0x3154ec[_0x4a65fa(0x221)]%0x4==0x3||_0x3154ec[_0x4a65fa(0x221)]%0x3==0x1?0x4:0x3;let _0xda5f84=0x0;_0x3154ec['forEach']((_0x14bad6,_0xd784af)=>{const _0x4c0470=_0x4a65fa;if(_0xd784af%_0x519ccd==0x0)_0x160c58=[];_0x160c58['push']({'text':_0x14bad6[_0x4c0470(0x1c1)]=='all'?_0x4c0470(0x2f2):_0x4c0470(0x318)+_0x14bad6[_0x4c0470(0x1c1)],'callback_data':_0x14bad6[_0x4c0470(0x1c1)]}),_0xd784af%_0x519ccd==0x0&&(_0x41c78e[_0xda5f84]=_0x160c58,_0xda5f84++);}),tgBot[_0x4a65fa(0x324)](_0x1a138a[_0x4a65fa(0x2b2)]['id'],_0x4a65fa(0x20b),{'reply_markup':{'inline_keyboard':_0x41c78e}})[_0x4a65fa(0x25b)](_0x33fcd7=>{telegramError(_0x33fcd7);}),tgBot['on'](_0x4a65fa(0x2d5),async _0x4d6e13=>{const _0x28fc66=_0x4a65fa,_0x14723b=_0x4d6e13[_0x28fc66(0x321)],_0x3a0968=_0x4d6e13[_0x28fc66(0x1ae)];tgBot[_0x28fc66(0x31b)](_0x4d6e13['id'])[_0x28fc66(0x1d8)](async()=>{const _0x3237d3=_0x28fc66;_0x14723b==_0x3237d3(0x2b0)?(tgBot[_0x3237d3(0x324)](_0x3a0968[_0x3237d3(0x2b2)]['id'],_0x3237d3(0x303))[_0x3237d3(0x25b)](_0x4513b5=>{telegramError(_0x4513b5);}),_0x3154ec[_0x3237d3(0x26d)](_0x1c4cf2=>{const _0x2a1fbc=_0x3237d3;if(_0x1c4cf2['botID']!='all')toggleBot(_0x1c4cf2['botID'],toggleStatus(_0x1c4cf2['botID']),_0x2a1fbc(0x327));})):(tgBot[_0x3237d3(0x324)](_0x3a0968[_0x3237d3(0x2b2)]['id'],_0x3237d3(0x1de)+_0x14723b)['catch'](_0xb07eeb=>{telegramError(_0xb07eeb);}),toggleBot(_0x14723b,toggleStatus(_0x14723b),_0x3237d3(0x327)));}),tgBot[_0x28fc66(0x24f)](_0x28fc66(0x2d5));});}}),tgBot[_0x943e6d(0x27f)](/\/portfolio/,_0x2223b9=>{const _0x3932b0=_0x943e6d;if(!validateTelegram(_0x2223b9))return;tgBot[_0x3932b0(0x24f)](_0x3932b0(0x2d5));const _0x5d5d01=getEnabledBots();if(_0x5d5d01[_0x3932b0(0x221)]==0x0)tgBot[_0x3932b0(0x324)](_0x2223b9[_0x3932b0(0x2b2)]['id'],_0x3932b0(0x220))[_0x3932b0(0x25b)](_0x57420c=>{telegramError(_0x57420c);});else{if(_0x5d5d01[_0x3932b0(0x221)]>0x1){let _0x7fdbf1=[],_0x2f8ff2=[];const _0x51c5da=_0x5d5d01['length']%0x4==0x0||_0x5d5d01[_0x3932b0(0x221)]%0x4==0x3||_0x5d5d01[_0x3932b0(0x221)]%0x3==0x1?0x4:0x3;let _0x31d22a=0x0;_0x5d5d01[_0x3932b0(0x26d)]((_0x1b55a3,_0x3f05b8)=>{const _0x3cd7d9=_0x3932b0;if(_0x3f05b8%_0x51c5da==0x0)_0x2f8ff2=[];_0x2f8ff2[_0x3cd7d9(0x2cf)]({'text':_0x3cd7d9(0x318)+_0x1b55a3[_0x3cd7d9(0x1c1)],'callback_data':_0x1b55a3[_0x3cd7d9(0x1c1)]}),_0x3f05b8%_0x51c5da==0x0&&(_0x7fdbf1[_0x31d22a]=_0x2f8ff2,_0x31d22a++);}),tgBot[_0x3932b0(0x324)](_0x2223b9['chat']['id'],_0x3932b0(0x313),{'reply_markup':{'inline_keyboard':_0x7fdbf1}})[_0x3932b0(0x25b)](_0x163171=>{telegramError(_0x163171);}),tgBot['on'](_0x3932b0(0x2d5),async _0x4cc6f1=>{const _0x17d1b7=_0x3932b0,_0x30b6e0=_0x4cc6f1[_0x17d1b7(0x321)],_0x35818f=_0x4cc6f1[_0x17d1b7(0x1ae)];tgBot[_0x17d1b7(0x31b)](_0x4cc6f1['id'])['then'](async()=>{const _0x2dc66d=_0x17d1b7;if(pid[_0x30b6e0])pid[_0x30b6e0][_0x2dc66d(0x26b)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x17d1b7(0x24f)](_0x17d1b7(0x2d5));});}else{const _0x46c52c=_0x5d5d01[0x0][_0x3932b0(0x1c1)];if(pid[_0x46c52c])pid[_0x46c52c]['send']({'function':_0x3932b0(0x283),'args':null});}}}),tgBot['onText'](/\/update/,async _0x187ada=>{const _0xda5403=_0x943e6d;if(!validateTelegram(_0x187ada))return;tgBot[_0xda5403(0x24f)]('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0xda5403(0x324)](_0x187ada[_0xda5403(0x2b2)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')['catch'](_0x176baf=>{telegramError(_0x176baf);});else!validInstallation?tgBot[_0xda5403(0x324)](_0x187ada['chat']['id'],_0xda5403(0x2bc))['catch'](_0x4a6cfb=>{telegramError(_0x4a6cfb);}):(tgBot['sendMessage'](_0x187ada[_0xda5403(0x2b2)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0xda5403(0x2d1)},{'text':'No','callback_data':'no'}]]}})[_0xda5403(0x25b)](_0x307705=>{telegramError(_0x307705);}),tgBot['on'](_0xda5403(0x2d5),async _0x5235cd=>{const _0x4b03f6=_0xda5403,_0x77f9e2=_0x5235cd[_0x4b03f6(0x321)],_0x293678=_0x5235cd[_0x4b03f6(0x1ae)];tgBot[_0x4b03f6(0x31b)](_0x5235cd['id'])[_0x4b03f6(0x1d8)](async()=>{const _0x1da273=_0x4b03f6;_0x77f9e2==_0x1da273(0x2d1)&&(await tgBot[_0x1da273(0x324)](_0x293678['chat']['id'],'Starting\x20Balance\x20Bot\x20update')['catch'](_0x455e2e=>{telegramError(_0x455e2e);}),updateBB());_0x77f9e2=='no'&&await tgBot['sendMessage'](_0x293678[_0x1da273(0x2b2)]['id'],_0x1da273(0x1ec))[_0x1da273(0x25b)](_0x5b14b7=>{telegramError(_0x5b14b7);});if(!settings[_0x1da273(0x328)])tgBot[_0x1da273(0x324)](_0x293678[_0x1da273(0x2b2)]['id'],_0x1da273(0x225))[_0x1da273(0x25b)](_0x43a0ee=>{telegramError(_0x43a0ee);});}),tgBot[_0x4b03f6(0x24f)](_0x4b03f6(0x2d5));}));}),tgBot[_0x943e6d(0x27f)](/\/toggle/,_0x157565=>{const _0x2111ec=_0x943e6d;if(!validateTelegram(_0x157565))return;tgBot[_0x2111ec(0x24f)](_0x2111ec(0x2d5));const _0x5c9f29=getBotsWithMode();if(_0x5c9f29[_0x2111ec(0x221)]==0x0)tgBot[_0x2111ec(0x324)](_0x157565['chat']['id'],_0x2111ec(0x220))[_0x2111ec(0x25b)](_0x4ca87d=>{telegramError(_0x4ca87d);});else{let _0x1ad262=[],_0xc30425=[];const _0x2ced90=0x2;let _0x35e903=0x0;_0x5c9f29[_0x2111ec(0x26d)]((_0x289f0a,_0x1c086f)=>{const _0x171ae4=_0x2111ec;if(_0x1c086f%_0x2ced90==0x0)_0xc30425=[];_0xc30425[_0x171ae4(0x2cf)]({'text':_0x171ae4(0x318)+_0x289f0a['botID']+'\x20('+_0x289f0a['mode']+')','callback_data':_0x289f0a[_0x171ae4(0x1c1)]}),_0x1c086f%_0x2ced90==0x0&&(_0x1ad262[_0x35e903]=_0xc30425,_0x35e903++);}),tgBot[_0x2111ec(0x324)](_0x157565[_0x2111ec(0x2b2)]['id'],_0x2111ec(0x1b5),{'reply_markup':{'inline_keyboard':_0x1ad262}})['catch'](_0x1d8e46=>{telegramError(_0x1d8e46);}),tgBot['on']('callback_query',async _0x4d74d8=>{const _0x2fbc55=_0x2111ec,_0x3ac9d1=_0x4d74d8[_0x2fbc55(0x321)],_0x57bd26=_0x4d74d8[_0x2fbc55(0x1ae)];tgBot[_0x2fbc55(0x31b)](_0x4d74d8['id'])[_0x2fbc55(0x1d8)](async()=>{const _0x52cd8=_0x2fbc55,_0x93323c=_0x5c9f29['find'](_0x159928=>_0x159928['botID']==_0x3ac9d1),_0x320117=_0x93323c[_0x52cd8(0x2cd)]==_0x52cd8(0x2df)?_0x52cd8(0x2be):_0x52cd8(0x2df);tgBot[_0x52cd8(0x324)](_0x57bd26['chat']['id'],_0x52cd8(0x323)+_0x3ac9d1+_0x52cd8(0x2d4)+_0x320117+'\x20mode')['catch'](_0x13cf4c=>{telegramError(_0x13cf4c);}),toggleBotMode(_0x3ac9d1);}),tgBot['removeListener'](_0x2fbc55(0x2d5));});}}),tgBot[_0x943e6d(0x27f)](/\/names/,_0xca7aa3=>{const _0x3cbfed=_0x943e6d;if(!validateTelegram(_0xca7aa3))return;let _0x3dfedc='';config[_0x3cbfed(0x26d)](_0x589eab=>{const _0x5afb6f=_0x3cbfed;_0x3dfedc+=_0x5afb6f(0x318)+_0x589eab[_0x5afb6f(0x1c1)]+':\x20'+_0x589eab[_0x5afb6f(0x222)]+'\x0a';}),tgBot[_0x3cbfed(0x324)](_0xca7aa3[_0x3cbfed(0x2b2)]['id'],_0x3dfedc,{'parse_mode':_0x3cbfed(0x232)})[_0x3cbfed(0x25b)](_0x5b2669=>{telegramError(_0x5b2669);});}),tgBot['onText'](/\/disable/,_0x5135d2=>{const _0x28531c=_0x943e6d;if(!validateTelegram(_0x5135d2))return;tgBot['sendMessage'](_0x5135d2[_0x28531c(0x2b2)]['id'],_0x28531c(0x325))[_0x28531c(0x25b)](_0x315522=>{telegramError(_0x315522);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x943e6d(0x27f)](/\/help/,_0x341953=>{const _0x5cc4d2=_0x943e6d;if(!validateTelegram(_0x341953))return;tgBot[_0x5cc4d2(0x324)](_0x341953[_0x5cc4d2(0x2b2)]['id'],_0x18b36d)['catch'](_0x1534a6=>{telegramError(_0x1534a6);});}),tgBot['on'](_0x943e6d(0x2e9),_0x1f3f3b=>{const _0x2f9d2c=_0x943e6d;_0x1f3f3b[_0x2f9d2c(0x33f)]()[_0x2f9d2c(0x1ad)](_0x2f9d2c(0x2ad))&&(logger['full']('Invalid\x20Telegram\x20token'),tgBot[_0x2f9d2c(0x2fe)](),tgBot=null,io['to'](_0x2f9d2c(0x228))[_0x2f9d2c(0x2dd)](_0x2f9d2c(0x274),'Invalid\x20Telegram\x20token'));}),process[_0x943e6d(0x336)](_0x943e6d(0x269),()=>{const _0x438f13=_0x943e6d;if(tgBot)tgBot[_0x438f13(0x2fe)]();process[_0x438f13(0x1aa)](0x1);}),process[_0x943e6d(0x336)](_0x943e6d(0x277),()=>{const _0x448b34=_0x943e6d;if(tgBot)tgBot[_0x448b34(0x2fe)]();process['exit'](0x1);});}}function disableTelegram(){const _0x24ef1d=_0x51fe33;tgBot&&(tgBot[_0x24ef1d(0x2fe)](),tgBot=null);}function sendTelegram(_0x5b01a6,_0x4a8501){const _0x11ed9d=_0x51fe33;if(settings['telegramEnabled']){if(settings['telegramEvents']==_0x11ed9d(0x2b0)||(_0x4a8501[_0x11ed9d(0x30c)]==_0x11ed9d(0x1da)||_0x4a8501['type']==_0x11ed9d(0x2a1)||_0x4a8501[_0x11ed9d(0x30c)]==_0x11ed9d(0x2ec))&&settings[_0x11ed9d(0x33d)]==_0x11ed9d(0x1e9)||_0x4a8501[_0x11ed9d(0x30c)]==_0x11ed9d(0x2cc)&&settings[_0x11ed9d(0x33d)]==_0x11ed9d(0x243)){if(tgBot&&settings['telegramChatId']){if(_0x4a8501[_0x11ed9d(0x349)])tgBot[_0x11ed9d(0x324)](settings[_0x11ed9d(0x328)],_0x4a8501[_0x11ed9d(0x222)]+_0x11ed9d(0x289)+_0x4a8501[_0x11ed9d(0x1db)])[_0x11ed9d(0x25b)](_0xcecd6a=>{telegramError(_0xcecd6a);});else tgBot['sendMessage'](settings[_0x11ed9d(0x328)],_0x11ed9d(0x318)+_0x5b01a6+_0x11ed9d(0x289)+_0x4a8501['event'])[_0x11ed9d(0x25b)](_0x173087=>{telegramError(_0x173087);});}}}}async function sendTelegramMsg(_0x3c59ee,_0x4090b7=_0x51fe33(0x232)){const _0x32658e=_0x51fe33;return settings[_0x32658e(0x2ff)]&&tgBot&&settings[_0x32658e(0x328)]?(await tgBot[_0x32658e(0x324)](settings[_0x32658e(0x328)],_0x3c59ee,{'parse_mode':_0x4090b7})['catch'](_0x3ec963=>{telegramError(_0x3ec963);}),!![]):![];}function getDeviceWithIp(_0x4386c4){const _0x1cfe3a=_0x51fe33;return devices[_0x1cfe3a(0x25c)](_0x460760=>_0x460760['ip']===_0x4386c4);}function temporaryAccess2FA(_0x527fac,_0x49ccd9){const _0x821f73=_0x51fe33;let _0x911cfa=new Date(),_0xc00fe6=![];if(lastIpApproval){if(_0x911cfa-lastIpApproval<0x1388)_0xc00fe6=!![];}lastIpApproval=new Date();if(_0xc00fe6)return;tgBot&&settings[_0x821f73(0x328)]&&(tgBot['removeListener'](_0x821f73(0x2d5)),tgBot[_0x821f73(0x324)](settings[_0x821f73(0x328)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x49ccd9)[_0x821f73(0x2a0)]+_0x821f73(0x294),{'parse_mode':_0x821f73(0x232),'reply_markup':{'inline_keyboard':[[{'text':_0x821f73(0x286),'callback_data':'5'},{'text':_0x821f73(0x20a),'callback_data':'15'},{'text':_0x821f73(0x300),'callback_data':'30'},{'text':'reject','callback_data':_0x821f73(0x278)}]]}})[_0x821f73(0x25b)](_0x322740=>{telegramError(_0x322740);}),tgBot['on'](_0x821f73(0x2d5),async _0x24dd97=>{const _0x58f9c6=_0x821f73,_0x4384a3=_0x24dd97['data'],_0x58114c=_0x24dd97[_0x58f9c6(0x1ae)];tgBot[_0x58f9c6(0x31b)](_0x24dd97['id'])[_0x58f9c6(0x1d8)](async()=>{const _0x104f36=_0x58f9c6;devices[_0x527fac][_0x104f36(0x22c)]={'clientip':_0x49ccd9,'timestamp':new Date()[_0x104f36(0x31e)](),'expiry':_0x4384a3},_0x4384a3!=_0x104f36(0x278)?(await tgBot['sendMessage'](_0x58114c[_0x104f36(0x2b2)]['id'],_0x104f36(0x27d)+_0x4384a3+_0x104f36(0x1be),{'parse_mode':'HTML'})[_0x104f36(0x25b)](_0x6976c6=>{telegramError(_0x6976c6);}),io['to'](_0x527fac)['emit'](_0x104f36(0x1ed),{'access':{'allow':![],'reason':_0x104f36(0x1b3),'token':null}})):(await tgBot[_0x104f36(0x324)](_0x58114c[_0x104f36(0x2b2)]['id'],_0x104f36(0x285))[_0x104f36(0x25b)](_0x460a86=>{telegramError(_0x460a86);}),io['to'](_0x527fac)['emit'](_0x104f36(0x1ed),{'access':{'allow':![],'reason':_0x104f36(0x2fc),'token':null}}));}),tgBot['removeListener'](_0x58f9c6(0x2d5));}));}function loginAccess2FA(_0x59021c,_0x2d5ad9){const _0x5e71e5=_0x51fe33;tgBot&&settings[_0x5e71e5(0x328)]&&(tgBot[_0x5e71e5(0x24f)](_0x5e71e5(0x2d5)),tgBot[_0x5e71e5(0x324)](settings[_0x5e71e5(0x328)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x2d5ad9)[_0x5e71e5(0x2a0)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x5e71e5(0x278),'callback_data':'reject'}]]}})[_0x5e71e5(0x25b)](_0xe0bfd2=>{telegramError(_0xe0bfd2);}),tgBot['on']('callback_query',async _0x483846=>{const _0x4be897=_0x5e71e5,_0x521ff6=_0x483846[_0x4be897(0x321)],_0x4af9aa=_0x483846[_0x4be897(0x1ae)];tgBot[_0x4be897(0x31b)](_0x483846['id'])[_0x4be897(0x1d8)](async()=>{const _0xedb7e9=_0x4be897;devices[_0x59021c][_0xedb7e9(0x245)]={'clientip':_0x2d5ad9,'timestamp':new Date()[_0xedb7e9(0x31e)](),'expiry':_0x521ff6},_0x521ff6!=_0xedb7e9(0x278)?(await tgBot['sendMessage'](_0x4af9aa[_0xedb7e9(0x2b2)]['id'],_0xedb7e9(0x1ab),{'parse_mode':'HTML'})[_0xedb7e9(0x25b)](_0x17e0eb=>{telegramError(_0x17e0eb);}),io['to'](_0x59021c)[_0xedb7e9(0x2dd)](_0xedb7e9(0x1ed),{'access':{'allow':![],'reason':_0xedb7e9(0x1b3),'token':null}})):(await tgBot[_0xedb7e9(0x324)](_0x4af9aa[_0xedb7e9(0x2b2)]['id'],'Login\x20rejected')[_0xedb7e9(0x25b)](_0x188c51=>{telegramError(_0x188c51);}),io['to'](_0x59021c)[_0xedb7e9(0x2dd)](_0xedb7e9(0x1ed),{'access':{'allow':![],'reason':_0xedb7e9(0x213),'token':null}}));}),tgBot[_0x4be897(0x24f)](_0x4be897(0x2d5));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x37a255=_0x51fe33;return dbConfig[_0x37a255(0x1fe)](_0x37a255(0x263))[_0x37a255(0x207)](_0x37a255(0x1c1))[_0x37a255(0x320)]({'status':_0x37a255(0x268)})[_0x37a255(0x223)]()||[];}function getDisabledBots(){const _0x2f6761=_0x51fe33;return dbConfig[_0x2f6761(0x1fe)](_0x2f6761(0x263))[_0x2f6761(0x207)](_0x2f6761(0x1c1))[_0x2f6761(0x320)]({'status':_0x2f6761(0x1f1)})['value']()||[];}function getBotAttributes(_0x146b03){const _0x29c9a7=_0x51fe33;let _0x444602={};const _0x49af1b=configpath+_0x29c9a7(0x312)+_0x146b03+'-config.json',_0x720190=fs[_0x29c9a7(0x282)](_0x49af1b);if(_0x720190){const _0x34e9f7=fs['readFileSync'](_0x49af1b);try{const _0x2d03c4=JSON[_0x29c9a7(0x256)](_0x34e9f7),_0x11aa31=_0x2d03c4?_0x2d03c4[_0x29c9a7(0x1e7)][0x0]['headless']:![];_0x444602[_0x29c9a7(0x2cd)]=_0x11aa31?_0x29c9a7(0x2df):_0x29c9a7(0x2be),_0x444602[_0x29c9a7(0x222)]=_0x2d03c4?_0x2d03c4['bot'][0x0][_0x29c9a7(0x222)]:_0x29c9a7(0x318)+_0x146b03;}catch(_0x138c44){_0x444602['mode']=_0x29c9a7(0x2be),_0x444602[_0x29c9a7(0x222)]=_0x29c9a7(0x318)+_0x146b03;}}else _0x444602[_0x29c9a7(0x2cd)]=_0x29c9a7(0x2be),_0x444602[_0x29c9a7(0x222)]=_0x29c9a7(0x318)+_0x146b03;return _0x444602;}function getBotsWithMode(){const _0x211784=_0x51fe33,_0x20d3f6=dbConfig['get'](_0x211784(0x263))[_0x211784(0x207)](_0x211784(0x1c1))[_0x211784(0x223)]()||[];return _0x20d3f6[_0x211784(0x26d)](_0x380ed5=>{const _0x1c0716=_0x211784;let _0x30ba4b=getBotAttributes(_0x380ed5[_0x1c0716(0x1c1)]);_0x380ed5[_0x1c0716(0x2cd)]=_0x30ba4b['mode'];}),_0x20d3f6;}async function initUser(){const _0x3b7a7b=_0x51fe33;if(!settings['userid']){const _0x57df3c=uuidRandom();mixpanel[_0x3b7a7b(0x2db)](_0x57df3c),updateSetting(_0x3b7a7b(0x211),_0x57df3c);}}function _0x21f2(_0x971bc8,_0x1465be){const _0x411712=_0x382b();return _0x21f2=function(_0x1eb327,_0x2196be){_0x1eb327=_0x1eb327-0x1aa;let _0x382b83=_0x411712[_0x1eb327];return _0x382b83;},_0x21f2(_0x971bc8,_0x1465be);}async function initSecure(){const _0x42ee6a=_0x51fe33;let _0x327830=getSecure();if(!_0x327830['hasOwnProperty'](_0x42ee6a(0x248))){let _0x2868b1=await generateKeys();_0x327830['publicKey']=_0x2868b1[_0x42ee6a(0x214)],_0x327830['privateKey']=_0x2868b1[_0x42ee6a(0x212)],_0x327830['secret']=crypto[_0x42ee6a(0x21e)](0x20)[_0x42ee6a(0x33f)](_0x42ee6a(0x1e1));;storeSecure(_0x327830);}}function getSettings(){const _0x145acb=_0x51fe33;return dbSettings[_0x145acb(0x1fe)](_0x145acb(0x1e4))[_0x145acb(0x223)]()||{};}function getSecure(){const _0x274f38=_0x51fe33;return dbSecure[_0x274f38(0x1fe)]('secure')['value']()||{};}function getBlacklist(){const _0x1ba903=_0x51fe33;return dbSecure[_0x1ba903(0x1fe)](_0x1ba903(0x23b))[_0x1ba903(0x223)]()||[];}function broadcastToBots(_0x35c55c,_0x390398){const _0x416aab=_0x51fe33;config[_0x416aab(0x26d)](_0x1f9fc8=>{const _0x50a54c=_0x416aab;if(_0x1f9fc8[_0x50a54c(0x1ed)]==_0x50a54c(0x268)&&_0x1f9fc8[_0x50a54c(0x33a)]==_0x50a54c(0x267)){if(pid[_0x1f9fc8[_0x50a54c(0x1c1)]])pid[_0x1f9fc8[_0x50a54c(0x1c1)]][_0x50a54c(0x26b)]({[_0x35c55c]:_0x390398});}});}function storeSettings(_0x545705,_0x401798=![]){const _0xfeedb6=_0x51fe33;_0x545705={...settings,..._0x545705};if(_0x401798&&_0x545705[_0xfeedb6(0x1f9)]!='************'&&_0x545705[_0xfeedb6(0x1f9)]!='***'&&_0x545705['bbPassword']!=''){const _0x4d5638=crypt[_0xfeedb6(0x1f2)](secure['privateKey'],_0x545705[_0xfeedb6(0x1f9)])['message'][_0xfeedb6(0x1ba)]('@')[0x0],_0x383bb8=bcrypt[_0xfeedb6(0x288)](_0x4d5638,saltRounds);_0x545705={..._0x545705,'bbPassword':_0x383bb8};}if(_0x401798&&_0x545705['telegramToken']!=_0xfeedb6(0x2a4)&&_0x545705[_0xfeedb6(0x259)]!=_0xfeedb6(0x28c)&&_0x545705['telegramToken']!=''){const _0x853cb9=crypt[_0xfeedb6(0x1f2)](secure[_0xfeedb6(0x212)],_0x545705[_0xfeedb6(0x259)])[_0xfeedb6(0x1ae)][_0xfeedb6(0x1ba)]('@')[0x0];_0x545705={..._0x545705,'telegramToken':_0x853cb9};}const _0x312aa8=_0x545705['telegramToken']!='************'&&_0x545705[_0xfeedb6(0x259)]!=settings[_0xfeedb6(0x259)]||_0x545705[_0xfeedb6(0x1ac)]!=settings[_0xfeedb6(0x1ac)],_0x3c2950=_0x545705[_0xfeedb6(0x259)]==''||_0x545705[_0xfeedb6(0x1ac)]=='';if(_0x312aa8)_0x545705[_0xfeedb6(0x33d)]=_0xfeedb6(0x2b0);for(const [_0x133756,_0x428d69]of Object['entries'](_0x545705)){if(_0x133756==_0xfeedb6(0x259)&&_0x428d69=='************'){_0x545705[_0xfeedb6(0x259)]=settings[_0xfeedb6(0x259)];continue;};if(_0x133756==_0xfeedb6(0x1f9)&&_0x428d69==_0xfeedb6(0x2a4)){_0x545705[_0xfeedb6(0x1f9)]=settings['bbPassword'];continue;};dbSettings[_0xfeedb6(0x22d)]('settings.'+_0x133756,_0x428d69)[_0xfeedb6(0x346)]();}settings=_0x545705,io['to'](_0xfeedb6(0x228))[_0xfeedb6(0x2dd)](_0xfeedb6(0x1e4),cleanSettings()),broadcastToBots(_0xfeedb6(0x218),settings[_0xfeedb6(0x218)]);if(_0x312aa8&&!_0x3c2950)initTelegram();if(_0x312aa8&&_0x3c2950)disableTelegram();getAllClients()[_0xfeedb6(0x26d)](_0x46f61c=>{const _0x2ccfdd=_0xfeedb6;getSocket(_0x46f61c['id'])[_0x2ccfdd(0x2dd)](_0x2ccfdd(0x1ed),{'access':{'allow':![],'reason':_0x2ccfdd(0x1b3),'token':null}});});}function updateSetting(_0x1636fa,_0x540ba1){const _0x481690=_0x51fe33;dbSettings[_0x481690(0x22d)](_0x481690(0x25d)+_0x1636fa,_0x540ba1)[_0x481690(0x346)](),settings=getSettings(),io['to'](_0x481690(0x228))[_0x481690(0x2dd)](_0x481690(0x1e4),cleanSettings());}function storeSecure(_0x5571b4){const _0xc36ffa=_0x51fe33;dbSecure[_0xc36ffa(0x1fe)](_0xc36ffa(0x240))[_0xc36ffa(0x2cf)](_0x5571b4)['write'](),secure=_0x5571b4;}function addBlacklist(_0x2c699d){const _0x5315c5=_0x51fe33;cleanBlacklist();let _0x5e35d1;devices[_0x2c699d]['telegramIpApproval']?_0x5e35d1=Math[_0x5315c5(0x29f)](devices[_0x2c699d][_0x5315c5(0x22c)][_0x5315c5(0x2b6)],loginExpiry):_0x5e35d1=loginExpiry,dbSecure[_0x5315c5(0x1fe)](_0x5315c5(0x23b))[_0x5315c5(0x2cf)]({'expiry':new Date()[_0x5315c5(0x31e)]()+_0x5e35d1*0x3c*0x3e8,'token':devices[_0x2c699d][_0x5315c5(0x247)][_0x5315c5(0x208)]})[_0x5315c5(0x346)](),blacklist=dbSecure['get'](_0x5315c5(0x23b))['value']();}function cleanBlacklist(){const _0x450653=_0x51fe33;let _0x3e9f50=dbSecure[_0x450653(0x1fe)](_0x450653(0x23b))['cloneDeep']()[_0x450653(0x223)](),_0xdb0014=new Date()['getTime']();_0x3e9f50['forEach'](_0xb9a52e=>{const _0x6fca96=_0x450653;_0xb9a52e[_0x6fca96(0x2b6)]<_0xdb0014&&dbSecure[_0x6fca96(0x1fe)](_0x6fca96(0x23b))[_0x6fca96(0x275)]({'expiry':_0xb9a52e[_0x6fca96(0x2b6)]})[_0x6fca96(0x346)]();});}function initStates(){const _0x38e8cd=_0x51fe33;let _0x1ca555=getConfiguration();_0x1ca555[_0x38e8cd(0x26d)](_0x48d3a9=>{const _0xf76269=_0x38e8cd;_0x48d3a9['live']=_0xf76269(0x327);}),storeConfiguration(_0x1ca555);}function onKeys(){const _0x3929c1=new RSA();return new Promise(_0x39d048=>{const _0x43c39b=_0x21f2;_0x3929c1['generateKeyPairAsync']()[_0x43c39b(0x1d8)](_0x441811=>{_0x39d048(_0x441811);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x23e9d6=_0x51fe33;let _0x23cf70=getSettings(),_0x51f5b2=![];!_0x23cf70[_0x23e9d6(0x345)](_0x23e9d6(0x319))&&(_0x23cf70[_0x23e9d6(0x319)]=0x0,_0x51f5b2=!![]);!_0x23cf70[_0x23e9d6(0x345)](_0x23e9d6(0x1b6))&&(_0x23cf70[_0x23e9d6(0x1b6)]=0x0,_0x51f5b2=!![]);!_0x23cf70[_0x23e9d6(0x345)](_0x23e9d6(0x32c))&&(_0x23cf70['latestversion']=_0x23e9d6(0x1c0),_0x51f5b2=!![]);if(_0x51f5b2)storeSettings(_0x23cf70);}function storeConfiguration(_0x1c605a){const _0xa29b8e=_0x51fe33;dbConfig[_0xa29b8e(0x1fe)](_0xa29b8e(0x263))[_0xa29b8e(0x275)]()[_0xa29b8e(0x346)](),_0x1c605a[_0xa29b8e(0x26d)](_0x4eff4b=>{const _0x372504=_0xa29b8e;delete _0x4eff4b[_0x372504(0x2cd)];}),dbConfig[_0xa29b8e(0x1fe)](_0xa29b8e(0x263))['push'](..._0x1c605a)['write'](),config=_0x1c605a;}function resetPassword(){const _0x4d5a01=_0x51fe33;tgBot&&settings['telegramChatId']&&(tgBot[_0x4d5a01(0x24f)](_0x4d5a01(0x2d5)),tgBot[_0x4d5a01(0x324)](settings['telegramChatId'],_0x4d5a01(0x1f5),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x4d5a01(0x2d1),'callback_data':_0x4d5a01(0x2d1)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x45759f=>{telegramError(_0x45759f);}),tgBot['on']('callback_query',async _0x253b9c=>{const _0x4468b9=_0x4d5a01,_0x18242b=_0x253b9c['data'],_0x58262d=_0x253b9c['message'];tgBot[_0x4468b9(0x31b)](_0x253b9c['id'])['then'](async()=>{const _0x1e11d3=_0x4468b9;if(_0x18242b!='no'){const _0x149a23=0xf,_0x3bf23b=_0x1e11d3(0x337),_0x19a69a=Array[_0x1e11d3(0x33b)](crypto['randomFillSync'](new Uint32Array(_0x149a23)))[_0x1e11d3(0x1e2)](_0x39ae3f=>_0x3bf23b[_0x39ae3f%_0x3bf23b[_0x1e11d3(0x221)]])['join'](''),_0x4a59ef=bcrypt[_0x1e11d3(0x288)](_0x19a69a,saltRounds);storeSettings({'bbPassword':_0x4a59ef}),await tgBot[_0x1e11d3(0x324)](_0x58262d[_0x1e11d3(0x2b2)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x19a69a,{'parse_mode':_0x1e11d3(0x232)})['catch'](_0xca6ef2=>{telegramError(_0xca6ef2);});}else await tgBot['sendMessage'](_0x58262d[_0x1e11d3(0x2b2)]['id'],_0x1e11d3(0x25a))[_0x1e11d3(0x25b)](_0x1722c7=>{telegramError(_0x1722c7);});}),tgBot[_0x4468b9(0x24f)](_0x4468b9(0x2d5));}));}async function confirmRestore(_0x158258,_0x34def4){const _0x4f3429=_0x51fe33;tgBot&&settings[_0x4f3429(0x328)]&&(tgBot[_0x4f3429(0x24f)](_0x4f3429(0x2d5)),await tgBot[_0x4f3429(0x324)](settings[_0x4f3429(0x328)],_0x4f3429(0x260),{'parse_mode':_0x4f3429(0x232),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x4f3429(0x2d1)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x1a4da5=>{telegramError(_0x1a4da5);}),tgBot['on'](_0x4f3429(0x2d5),async _0x467590=>{const _0x3b8cfa=_0x4f3429,_0x2d165c=_0x467590['data'],_0x1c90ce=_0x467590['message'];tgBot[_0x3b8cfa(0x31b)](_0x467590['id'])['then'](async()=>{const _0x31804c=_0x3b8cfa;_0x2d165c!='no'?(await tgBot[_0x31804c(0x324)](_0x1c90ce[_0x31804c(0x2b2)]['id'],_0x31804c(0x238),{'parse_mode':_0x31804c(0x232)})[_0x31804c(0x25b)](_0x1263dd=>{telegramError(_0x1263dd);}),unzipFile(_0x158258,_0x34def4)):await tgBot[_0x31804c(0x324)](_0x1c90ce[_0x31804c(0x2b2)]['id'],_0x31804c(0x2d7))['catch'](_0x51157a=>{telegramError(_0x51157a);});}),tgBot[_0x3b8cfa(0x24f)](_0x3b8cfa(0x2d5));}));}function getServerTime(){const _0x129440=_0x51fe33,_0xff2321=new Date();return _0xff2321[_0x129440(0x27a)]()+'/'+(_0xff2321[_0x129440(0x217)]()+0x1)[_0x129440(0x33f)]()[_0x129440(0x1d6)](0x2,'0')+'/'+_0xff2321[_0x129440(0x2ae)]()['toString']()[_0x129440(0x1d6)](0x2,'0')+'\x20'+_0xff2321[_0x129440(0x206)]()[_0x129440(0x33f)]()[_0x129440(0x1d6)](0x2,'0')+':'+_0xff2321['getMinutes']()['toString']()[_0x129440(0x1d6)](0x2,'0')+':'+_0xff2321[_0x129440(0x27c)]()['toString']()['padStart'](0x2,'0');}function getTimeStamp(){const _0x239af3=_0x51fe33,_0x5aa99c=shiftedTime();return _0x5aa99c['getFullYear']()+'/'+(_0x5aa99c['getMonth']()+0x1)['toString']()[_0x239af3(0x1d6)](0x2,'0')+'/'+_0x5aa99c[_0x239af3(0x2ae)]()['toString']()[_0x239af3(0x1d6)](0x2,'0')+'\x20'+_0x5aa99c['getHours']()[_0x239af3(0x33f)]()[_0x239af3(0x1d6)](0x2,'0')+':'+_0x5aa99c[_0x239af3(0x32a)]()[_0x239af3(0x33f)]()[_0x239af3(0x1d6)](0x2,'0')+':'+_0x5aa99c['getSeconds']()[_0x239af3(0x33f)]()[_0x239af3(0x1d6)](0x2,'0');}function shiftedTime(){const _0x4d4ab8=_0x51fe33,_0xb2265=new Date();let _0x29b590=_0xb2265;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x29b590=fns[_0x4d4ab8(0x2f8)](_0xb2265,{'hours':settings[_0x4d4ab8(0x218)]});return _0x29b590;}function startScheduler(){const _0x28edeb=_0x51fe33,_0x31f442=new Date()[_0x28edeb(0x30d)](),_0x3f5081=shiftedTime()[_0x28edeb(0x206)]();_0x3f5081==0x4&&backupConfigFiles();_0x3f5081==0x0&&rotateLogFiles();_0x31f442%0x6==0x0&&triggerAnalytics();_0x31f442%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function backupConfigFiles(){const _0x5e57cc=_0x51fe33;fs[_0x5e57cc(0x1e6)](configpath,{'withFileTypes':!![]})[_0x5e57cc(0x26d)](_0x20c673=>{const _0x1f9b7c=_0x5e57cc;if(!_0x20c673['isDirectory']())fs[_0x1f9b7c(0x299)](configpath+_0x20c673[_0x1f9b7c(0x1e0)],configbackuppath+_0x20c673[_0x1f9b7c(0x1e0)]);});}function rotateLogFiles(){const _0x48b023=_0x51fe33,_0x4404ea=fs[_0x48b023(0x2f4)](logspath+_0x48b023(0x291)),_0x569c0a=_0x4404ea[_0x48b023(0x25f)]/0x400;if(_0x569c0a>0x32){let _0x1b534a=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x1b534a[_0x48b023(0x28e)]((_0x49b9c4,_0x50183e)=>_0x49b9c4[_0x48b023(0x1e0)]<_0x50183e[_0x48b023(0x1e0)]?0x1:_0x50183e['name']<_0x49b9c4[_0x48b023(0x1e0)]?-0x1:0x0),_0x1b534a[_0x48b023(0x26d)](_0x324490=>{const _0x350be2=_0x48b023;if(_0x324490[_0x350be2(0x1e0)]==_0x350be2(0x29b))fs['copyFileSync'](logspath+_0x324490[_0x350be2(0x1e0)],logspath+_0x350be2(0x2a2));if(_0x324490[_0x350be2(0x1e0)]=='output-001.log')fs[_0x350be2(0x299)](logspath+_0x324490['name'],logspath+_0x350be2(0x29b));_0x324490[_0x350be2(0x1e0)]==_0x350be2(0x291)&&(fs[_0x350be2(0x299)](logspath+_0x324490[_0x350be2(0x1e0)],logspath+_0x350be2(0x1bf)),fs['writeFileSync'](logspath+_0x324490['name'],''));});}}async function zipFiles(_0x37480c){const _0x1174f4=_0x51fe33;let _0x1a11b5;if(_0x37480c==_0x1174f4(0x281))_0x1a11b5=logspath;if(_0x37480c==_0x1174f4(0x2ac))_0x1a11b5=configpath;let _0x39ad0f=fs[_0x1174f4(0x1e6)](_0x1a11b5,{'withFileTypes':!![]});const _0x52d930=new require('node-zip')();_0x39ad0f[_0x1174f4(0x26d)](_0x819ac2=>{const _0x179fd2=_0x1174f4;if(!_0x819ac2[_0x179fd2(0x1e5)]()){let _0x28e50c=fs[_0x179fd2(0x1d4)](_0x1a11b5+_0x819ac2['name']);const _0x59446f=/^bot-[0-9]{3}-config.json$/,_0x2c9645=_0x59446f[_0x179fd2(0x280)](_0x819ac2['name']);if(_0x2c9645){const _0x4ef0b1=JSON[_0x179fd2(0x256)](_0x28e50c);_0x4ef0b1[_0x179fd2(0x1e7)][0x0]['apiKey']='***',_0x4ef0b1[_0x179fd2(0x1e7)][0x0][_0x179fd2(0x1cb)]=_0x179fd2(0x28c),_0x28e50c=JSON[_0x179fd2(0x24b)](_0x4ef0b1,null,0x2);}if(_0x819ac2[_0x179fd2(0x1e0)]==_0x179fd2(0x338)){const _0x3b0289=JSON[_0x179fd2(0x256)](_0x28e50c);if(_0x3b0289[_0x179fd2(0x1e4)]['loginRequired'])_0x3b0289[_0x179fd2(0x1e4)][_0x179fd2(0x209)]=![];if(_0x3b0289[_0x179fd2(0x1e4)]['bbPassword'])_0x3b0289[_0x179fd2(0x1e4)]['bbPassword']='***';if(_0x3b0289['settings']['telegramToken'])_0x3b0289[_0x179fd2(0x1e4)][_0x179fd2(0x259)]=_0x179fd2(0x28c);if(_0x3b0289[_0x179fd2(0x1e4)][_0x179fd2(0x328)])_0x3b0289[_0x179fd2(0x1e4)][_0x179fd2(0x328)]=null;_0x28e50c=JSON[_0x179fd2(0x24b)](_0x3b0289,null,0x2);}if(_0x819ac2[_0x179fd2(0x1e0)]!='bb-secure.json')_0x52d930[_0x179fd2(0x332)](_0x819ac2[_0x179fd2(0x1e0)],_0x28e50c);}});const _0x58ecc1=_0x52d930[_0x1174f4(0x21b)]({'base64':![],'compression':'DEFLATE'});fs[_0x1174f4(0x32f)](zippath+(_0x37480c+_0x1174f4(0x2b3)),_0x58ecc1,_0x1174f4(0x226));}async function unzipFile(_0x4541d0,_0xf41fdb){const _0x1a75b7=_0x51fe33;await backupConfigFiles(),fs[_0x1a75b7(0x1e6)](configpath,{'withFileTypes':!![]})['forEach'](_0x376e79=>{const _0x9f138c=_0x1a75b7;if(!_0x376e79[_0x9f138c(0x1e5)]())fs['rmSync'](configpath+_0x376e79[_0x9f138c(0x1e0)]);});const _0x9ceb15=fs[_0x1a75b7(0x1d4)](_0x4541d0+_0xf41fdb,_0x1a75b7(0x226)),_0x8d7dcd=new require(_0x1a75b7(0x257))(_0x9ceb15,{'base64':![],'checkCRC32':!![]});Object[_0x1a75b7(0x1af)](_0x8d7dcd[_0x1a75b7(0x236)])[_0x1a75b7(0x26d)](_0x170697=>{const _0x597f6a=_0x1a75b7,_0x248ffa=_0x8d7dcd[_0x597f6a(0x236)][_0x170697];fs[_0x597f6a(0x32f)](configpath+_0x248ffa[_0x597f6a(0x1e0)],_0x248ffa[_0x597f6a(0x341)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x1a75b7(0x26d)](_0x1366e6=>{const _0x3de152=_0x1a75b7;if(!_0x1366e6[_0x3de152(0x1e5)]())fs['rmSync'](temppath+_0x1366e6['name']);}),process[_0x1a75b7(0x26b)]({'restore':!![]},_0x40038d=>{});}async function getPublicIp(){const _0x3ea3c4=_0x51fe33;try{const _0x37aa28=await axios['get'](_0x3ea3c4(0x20d));publicip=_0x37aa28[_0x3ea3c4(0x321)]['ip'];}catch(_0x4f6f0e){}}async function triggerAnalytics(){const _0x17f854=_0x51fe33;if(!publicip)await getPublicIp();const _0x16bf43=getBotsWithMode();let _0x448258=0x0;_0x16bf43[_0x17f854(0x26d)](_0x1e6460=>{const _0x330c44=_0x17f854;if(_0x1e6460[_0x330c44(0x1ed)]===_0x330c44(0x268))_0x448258++;}),mixpanel[_0x17f854(0x29a)]('Server',{'distinct_id':settings[_0x17f854(0x211)],'ip':publicip,'version':serverversion,'numbots':_0x16bf43[_0x17f854(0x221)],'numbotsenabled':_0x448258});}async function getMessages(){const _0x39effd=_0x51fe33,_0x5d076f='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x1efea9=new GraphQLClient(_0x5d076f),_0x299427={'authorization':_0x39effd(0x2d6)},_0x3cdd4b=serverversion[_0x39effd(0x1ba)]('.'),_0x103150=_0x3cdd4b[0x0]+'.'+_0x3cdd4b[0x1],_0x311db7=Math[_0x39effd(0x2b1)](settings['lastmsgtelegram'],settings[_0x39effd(0x1b6)]),_0x366d57={'last':parseInt(_0x311db7),'bbm':_0x103150},_0x5c64a1=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1458e1;try{_0x1458e1=await _0x1efea9['request'](_0x5c64a1,_0x366d57,_0x299427);}catch(_0x3d99b5){}if(_0x1458e1&&_0x1458e1[_0x39effd(0x22f)]){let _0x612fa8=settings[_0x39effd(0x319)];newMessages=[];for(const _0x24313d of _0x1458e1[_0x39effd(0x22f)]){newMessages[_0x39effd(0x2cf)](_0x24313d);if(_0x24313d[_0x39effd(0x258)])updateSetting('latestversion',_0x24313d[_0x39effd(0x258)]);let _0x174455=_0x24313d[_0x39effd(0x258)]?serverversion>=_0x24313d['bbvNew']:![];if(!_0x174455&&_0x24313d[_0x39effd(0x250)]>_0x612fa8){if(_0x24313d[_0x39effd(0x348)]===_0x39effd(0x1b7)||serverversion['startsWith'](_0x24313d[_0x39effd(0x348)])){let _0xaffdc0=''+_0x24313d[_0x39effd(0x1f3)]+'\x0a\x0a'+_0x24313d['message'];const _0xabe3f8=await sendTelegramMsg(toTelegramMarkdown(_0xaffdc0),_0x39effd(0x2da));if(_0xabe3f8)_0x612fa8=_0x24313d[_0x39effd(0x250)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x39effd(0x319),_0x612fa8),emitMessages();}}function emitMessages(){const _0x37e0e5=_0x51fe33,_0x33e596=settings[_0x37e0e5(0x1b6)];let _0xe03683=[];newMessages[_0x37e0e5(0x26d)](_0x306fcc=>{const _0x4ee752=_0x37e0e5;_0x306fcc[_0x4ee752(0x250)]>_0x33e596&&_0xe03683[_0x4ee752(0x2cf)](_0x306fcc);}),_0xe03683['length']>0x0&&getAllClients()[_0x37e0e5(0x26d)](_0x18b1d7=>{getSocket(_0x18b1d7['id'])['emit']('message',_0xe03683);});}function confirmMessage(_0x2b3a3c){const _0x4f1362=_0x51fe33;updateSetting(_0x4f1362(0x1b6),Number(_0x2b3a3c));}function isNewerVersion(_0x25878a,_0x56c5bf){const _0x1cc060=_0x51fe33,_0x52834e=_0x56c5bf[_0x1cc060(0x1ba)]('.'),_0x4d697a=_0x25878a[_0x1cc060(0x1ba)]('.');for(var _0x53aef0=0x0;_0x53aef0<_0x4d697a[_0x1cc060(0x221)];_0x53aef0++){const _0xd0626c=~~_0x4d697a[_0x53aef0],_0x57c3bc=~~_0x52834e[_0x53aef0];if(_0xd0626c>_0x57c3bc)return!![];if(_0xd0626c<_0x57c3bc)return![];}return![];}function toTelegramMarkdown(_0x2ef0c8){const _0x8ca4bd=_0x51fe33,_0x5cb437=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0xdbf827=/\*{2}(.+?)\*{2}/gim;return _0x2ef0c8=_0x2ef0c8['replace'](_0x5cb437,_0x8ca4bd(0x297))[_0x8ca4bd(0x1ee)](_0xdbf827,_0x8ca4bd(0x2d3)),_0x2ef0c8;}async function validateConfigFile(){const _0x537a86=_0x51fe33,_0x100ff3=dbConfig[_0x537a86(0x1fe)]('bots')['sortBy'](_0x537a86(0x1c1))[_0x537a86(0x223)]()||[];if(_0x100ff3[_0x537a86(0x221)]==0x0){let _0x401c07=0x0,_0x5f5536=[];const _0x5134a4=/^bot-([0-9]{3})-config.json$/,_0x2d81f5=fs[_0x537a86(0x1e6)](configpath);_0x2d81f5[_0x537a86(0x26d)](_0x32467b=>{const _0x271b89=_0x537a86,_0x343922=_0x5134a4[_0x271b89(0x200)](_0x32467b);if(_0x343922){const _0x267504=_0x343922[0x1];let _0x57a2d5=getBotAttributes(_0x267504);_0x5f5536[_0x271b89(0x2cf)]({'botID':_0x267504,'botname':_0x57a2d5[_0x271b89(0x222)],'status':'disabled','live':'stopped'}),_0x401c07++;}}),_0x401c07!=0x0&&(dbConfig['get'](_0x537a86(0x263))[_0x537a86(0x2f9)](_0x5f5536)[_0x537a86(0x346)](),config=_0x5f5536,restoredConfigFile=_0x401c07);}}async function restoreConfigNotify(_0x49fe86){const _0xcd51dc=_0x51fe33;let _0x5a0e8c;if(restoredConfigFile==0x1)_0x5a0e8c=_0xcd51dc(0x315);else _0x5a0e8c=_0xcd51dc(0x1d2);if(_0x49fe86)io['to']('botmanager')[_0xcd51dc(0x2dd)]('notification',_0x5a0e8c);else{logger[_0xcd51dc(0x2e4)](_0xcd51dc(0x1fc)),logger[_0xcd51dc(0x2e4)](_0x5a0e8c),logger[_0xcd51dc(0x2e4)](_0xcd51dc(0x1fc)),logger['simple']('');if(tgBot&&settings[_0xcd51dc(0x328)]&&settings[_0xcd51dc(0x33d)]!=_0xcd51dc(0x243))tgBot[_0xcd51dc(0x324)](settings['telegramChatId'],_0xcd51dc(0x2fa)+_0x5a0e8c)[_0xcd51dc(0x25b)](_0x3162cf=>{telegramError(_0x3162cf);});}}function validateCredentials(_0x474b5b,_0x7369b2){const _0x57b440=_0x51fe33;if(_0x474b5b['username']==settings[_0x57b440(0x2e0)]&&bcrypt['compareSync'](_0x474b5b[_0x57b440(0x23f)],settings[_0x57b440(0x1f9)])){if(settings[_0x57b440(0x284)])return{'allow':![],'reason':_0x57b440(0x28d),'token':null};else{const _0x1496c4=generateLoginToken(_0x7369b2);return{'allow':!![],'reason':_0x57b440(0x2ba),'token':_0x1496c4};}}else return{'allow':![],'reason':_0x57b440(0x2f5),'token':null};}function refreshToken(_0x5411d9){const _0xbeeab7=_0x51fe33,_0x550bef=generateLoginToken(_0x5411d9);return{'allow':!![],'reason':_0xbeeab7(0x2ba),'token':_0x550bef};}function validateAccess(_0x4b290d,_0x9bfdca,_0x620da7){const _0x400caf=_0x51fe33,_0x23fd4c=_0x620da7?_0x620da7:devices[_0x9bfdca]['ip'];let _0x4420c5;const _0x2c74f9=_0x3bbd5b=>{const _0x4c0393=_0x21f2;if(settings[_0x4c0393(0x209)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x9bfdca)){const _0x3da90a=generateLoginToken(_0x9bfdca);return{'allow':!![],'reason':_0x4c0393(0x2c9),'token':_0x3da90a};}else return{'allow':![],'reason':_0x4c0393(0x2a9),'token':null};}else return _0x4420c5=validToken(_0x3bbd5b,_0x9bfdca),_0x4420c5[_0x4c0393(0x345)](_0x4c0393(0x2ec))?{'allow':!![],'reason':_0x4c0393(0x1e3),'token':_0x3bbd5b}:{'allow':![],'reason':_0x4c0393(0x2a9),'token':null};}else return{'allow':!![],'reason':_0x4c0393(0x2c1),'token':null};};if(settings[_0x400caf(0x1c2)]){let _0x392010=[...settings[_0x400caf(0x344)],'::1','::ffff:127.0.0.1',_0x400caf(0x296)];if(_0x392010['includes'](_0x23fd4c))return _0x2c74f9(_0x4b290d);else{_0x4420c5=validToken(_0x4b290d,_0x9bfdca);if(_0x4420c5['hasOwnProperty'](_0x400caf(0x2ec)))return _0x2c74f9(_0x4b290d);else{if(telegramIpApproved(_0x9bfdca)){const _0x464d82=generateToken(_0x9bfdca);return _0x4420c5=_0x2c74f9(_0x4b290d),_0x4420c5['allow']?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x464d82}:_0x4420c5;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x400caf(0x233),'token':null}:{'allow':![],'reason':_0x400caf(0x202),'token':null};}}}else return _0x2c74f9(_0x4b290d);}function timelyDecrypt(_0x5ccf67,_0x2030d1=!![]){const _0x2dad3c=_0x51fe33;if(_0x5ccf67)try{const _0x582379=crypt['decrypt'](secure[_0x2dad3c(0x212)],_0x5ccf67)[_0x2dad3c(0x1ae)],_0x158510=_0x582379[_0x2dad3c(0x1ba)]('@')[0x0],_0x4d457e=_0x582379['split']('@')[0x1],_0x31c1b8=new Date()['getTime']();if(_0x2030d1){if(_0x31c1b8-_0x4d457e<maxSecretAge*0x3e8)return _0x158510;else return![];}else return _0x158510;}catch(_0x53a630){return![];}else return![];}const validToken=(_0x27be15,_0x3291ab)=>{const _0x5133b3=_0x51fe33,_0x31d071=devices[_0x3291ab]['ip'];if(!_0x27be15)return{'error':_0x5133b3(0x26c)};for(let _0x52486b of blacklist){if(_0x52486b[_0x5133b3(0x208)]==_0x27be15)return{'error':_0x5133b3(0x1fb)};}let _0x3c093c;try{_0x3c093c=jwt[_0x5133b3(0x210)](_0x27be15,secure[_0x5133b3(0x248)]+_0x3291ab);}catch{return{'error':_0x5133b3(0x2eb)};}if(!_0x3c093c[_0x5133b3(0x345)]('clientip')&&!_0x3c093c[_0x5133b3(0x345)](_0x5133b3(0x309))||!_0x3c093c[_0x5133b3(0x345)]('exp'))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x3c093c['hasOwnProperty']('username')&&_0x3c093c['hasOwnProperty'](_0x5133b3(0x1c7))){const {clientip:_0x5391df}=_0x3c093c;return _0x31d071==_0x5391df?{'success':_0x5133b3(0x1b8)}:{'error':_0x5133b3(0x22b)};}else{if(_0x3c093c[_0x5133b3(0x345)](_0x5133b3(0x309))&&_0x3c093c[_0x5133b3(0x345)]('clientip')){const {username:_0x275fa0,clientip:_0x55006f}=_0x3c093c;return settings[_0x5133b3(0x2e0)]==_0x275fa0&&_0x31d071==_0x55006f?{'success':_0x5133b3(0x1b8)}:{'error':_0x5133b3(0x2d8)};}}},generateLoginToken=_0x21c155=>{const _0x3255d3=_0x51fe33;if(_0x21c155){const _0x4f5ac4=devices[_0x21c155]['ip'];return jwt['sign']({'username':settings['bbUsername'],'clientip':_0x4f5ac4},secure[_0x3255d3(0x248)]+_0x21c155,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0xafe552=>{const _0x19a287=_0x51fe33;if(_0xafe552){const _0x470d6f=devices[_0xafe552]['ip'];return jwt[_0x19a287(0x2e7)]({'clientip':_0x470d6f},secure[_0x19a287(0x248)]+_0xafe552,{'expiresIn':devices[_0xafe552][_0x19a287(0x22c)][_0x19a287(0x2b6)]*0x3c});}else return![];},telegramIpApproved=_0x19f084=>{const _0x5e1fc1=_0x51fe33;let _0x544aa5=![];return devices[_0x19f084][_0x5e1fc1(0x22c)]&&devices[_0x19f084][_0x5e1fc1(0x22c)][_0x5e1fc1(0x2b6)]!=_0x5e1fc1(0x278)&&(_0x544aa5=devices[_0x19f084]['telegramIpApproval'][_0x5e1fc1(0x1c7)]==devices[_0x19f084]['ip']&&new Date()[_0x5e1fc1(0x31e)]()-devices[_0x19f084][_0x5e1fc1(0x22c)][_0x5e1fc1(0x339)]<devices[_0x19f084][_0x5e1fc1(0x22c)][_0x5e1fc1(0x2b6)]*0x3c*0x3e8),_0x544aa5;},telegram2FaApproved=_0x101d89=>{const _0xe7439e=_0x51fe33;let _0x491909=![];return devices[_0x101d89][_0xe7439e(0x245)]&&devices[_0x101d89][_0xe7439e(0x245)][_0xe7439e(0x2b6)]!=_0xe7439e(0x278)&&(_0x491909=devices[_0x101d89][_0xe7439e(0x245)][_0xe7439e(0x1c7)]==devices[_0x101d89]['ip']&&new Date()[_0xe7439e(0x31e)]()-devices[_0x101d89][_0xe7439e(0x245)]['timestamp']<devices[_0x101d89][_0xe7439e(0x245)][_0xe7439e(0x2b6)]*0x3c*0x3e8),_0x491909;},normalizeIP=_0x5a3016=>{const _0x4681c6=_0x51fe33;let _0x352e4d=null,_0x148ce3=null;if(ipaddr['isValid'](_0x5a3016)){const _0x27ef32=ipaddr[_0x4681c6(0x256)](_0x5a3016);_0x27ef32[_0x4681c6(0x204)]()==='ipv6'?(_0x27ef32[_0x4681c6(0x203)]()&&(_0x352e4d=_0x27ef32[_0x4681c6(0x270)]()['toString']()),_0x148ce3=_0x27ef32['toString']()):(_0x352e4d=_0x27ef32[_0x4681c6(0x33f)](),_0x148ce3=_0x27ef32[_0x4681c6(0x29d)]()['toString']());}return{'show':_0x352e4d?_0x352e4d:_0x148ce3,'store':_0x148ce3};};function sleep(_0x4c9ce3){return new Promise(_0x30f9ce=>setTimeout(_0x30f9ce,_0x4c9ce3));}