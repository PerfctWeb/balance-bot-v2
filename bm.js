const _0x50ea8b=_0x5441;(function(_0x2be78e,_0x1c6364){const _0x20b1d4=_0x5441,_0x3ca420=_0x2be78e();while(!![]){try{const _0xba1eaa=-parseInt(_0x20b1d4(0x183))/0x1+parseInt(_0x20b1d4(0x136))/0x2+parseInt(_0x20b1d4(0x1d6))/0x3*(parseInt(_0x20b1d4(0x20d))/0x4)+-parseInt(_0x20b1d4(0x13c))/0x5+-parseInt(_0x20b1d4(0x1ad))/0x6*(-parseInt(_0x20b1d4(0x1e0))/0x7)+parseInt(_0x20b1d4(0x124))/0x8+parseInt(_0x20b1d4(0xd6))/0x9;if(_0xba1eaa===_0x1c6364)break;else _0x3ca420['push'](_0x3ca420['shift']());}catch(_0xaed077){_0x3ca420['push'](_0x3ca420['shift']());}}}(_0x3481,0x44378));const _0x454b1b=function(){let _0x30852d=!![];return function(_0x36cf45,_0x1413b5){const _0x364e82=_0x30852d?function(){const _0x83e9fa=_0x5441;if(_0x1413b5){const _0x37887e=_0x1413b5[_0x83e9fa(0x1f7)](_0x36cf45,arguments);return _0x1413b5=null,_0x37887e;}}:function(){};return _0x30852d=![],_0x364e82;};}(),_0x19a212=_0x454b1b(this,function(){const _0x220cf2=_0x5441;return _0x19a212[_0x220cf2(0x160)]()[_0x220cf2(0x206)](_0x220cf2(0x14d))[_0x220cf2(0x160)]()[_0x220cf2(0x166)](_0x19a212)[_0x220cf2(0x206)](_0x220cf2(0x14d));});_0x19a212();'use strict';process[_0x50ea8b(0x19d)][_0x50ea8b(0x225)]=0x1;const childProcess=require(_0x50ea8b(0x12b)),fs=require('fs'),fns=require('date-fns'),low=require(_0x50ea8b(0x1b1)),FileSync=require(_0x50ea8b(0x205)),path=require('path'),crypto=require(_0x50ea8b(0x10e)),Crypt=require('hybrid-crypto-js')[_0x50ea8b(0x128)],RSA=require(_0x50ea8b(0xfe))['RSA'],bcrypt=require(_0x50ea8b(0x164)),jwt=require(_0x50ea8b(0x219)),{Analytics}=require(_0x50ea8b(0x1ce)),googleAnalyticsV3Plugin=require('@analytics/google-analytics-v3')[_0x50ea8b(0x1db)],ipaddr=require(_0x50ea8b(0x15f)),argv=require('yargs/yargs')(process['argv'][_0x50ea8b(0x10a)](0x2))[_0x50ea8b(0x220)],uuidRandom=require('uuid-random'),Mixpanel=require(_0x50ea8b(0x1bc)),axios=require('axios'),{GraphQLClient,gql}=require(_0x50ea8b(0x175)),PORT=argv['port']||_0x50ea8b(0xea),pattern=/^[0-9]{2,4}$/;!pattern[_0x50ea8b(0x207)](PORT)&&(console[_0x50ea8b(0xb8)](_0x50ea8b(0x174)+PORT+_0x50ea8b(0xf8)),process[_0x50ea8b(0x1c5)](0x1));const HOST=argv['host']||null,userID=argv[_0x50ea8b(0xd5)]||'';let bbpath='bb/',bbpath2='';const botfile=_0x50ea8b(0xb5),configfile=_0x50ea8b(0xdf),settingsfile=_0x50ea8b(0x17b),securefile='bb-secure.json';let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x50ea8b(0x1be)+userID+'/':bbpath+_0x50ea8b(0x1be),configbackuppath=configpath+'backup/';!fs['existsSync'](configpath)&&fs['mkdirSync'](configpath);!fs[_0x50ea8b(0x123)](configbackuppath)&&fs[_0x50ea8b(0x15e)](configbackuppath);function _0x3481(){const _0x2f1ebb=['Unauthorized\x20attempt\x20to\x20place\x20market\x20order','cloneDeep','-config.json','login\x20not\x20required','auto','write',',\x20must\x20be\x20a\x204\x20digit\x20number','Invalid\x20authentication\x20token\x20(2)','::ffff:127.0.0.1','-----------------------------------------------------------------------------------','remoteAddress','new','hybrid-crypto-js','headless','onText','Notifications\x20disabled\x0a','any','stop','all','store','decrypt','show','alias','telegramUsername','slice','from','getSeconds','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','crypto','replace','temporaryAccessAllowed','telegram','telegram2FaApproval','</b>\x20?','bbvNew','restarting\x20Bot\x20','privateKey','split','timestamp','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','disabled','enabled','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','running','bbPassword','orders','restart','toIPv4MappedAddress','headers','existsSync','1616992VUeCXY',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','Unauthorized\x20attempt\x20to\x20delete\x20bot','getPortfolio','Crypt','title','removeAllListeners','child_process','writeFileSync','Notifications\x20enabled','/status\x20-\x20show\x20bot(s)\x20status\x0a','storeHeadless','page','telegramChatId','success','mode','express','get-portfolio','30066zkegTo','disconnect','/:bot/configuration','/:bot/performance','bots','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','1481190IxWNcT','verify','temporary\x20access\x20timeout','map','uuid','node-telegram-bot-api','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','sendFile','No\x20authentication\x20token','latestversion','bbvReceive','access','handshake','parse','pidExpireLogin','confirm-message','Bot\x20','(((.+)+)+)+$','/help\x20-\x20show\x20available\x20commands\x0a',':\x20Bot\x20Mgr\x20>\x20','/:bot','kill','emit','0.0.0','hashSync','Temporary\x20access\x20rejected','generateKeyPairAsync','storeConfiguration','update-bot','All\x20bots','number','connected','lastmsgemitted','cancel-loading','mkdirSync','ipaddr.js','toString','Allow\x20login\x20from\x20IP\x20address\x20<b>','bbUsername','\x20mode','bcryptjs','encryptedUuid','constructor','add','userid','removeListener','lastmsgtelegram','Invalid\x20IP\x20address','data','Alerts','************','getDate','getTime','sortBy','isDirectory','new-disabled','Error:\x20Invalid\x20argument\x20','graphql-request','Invalid\x20authentication\x20token\x20(1)','live','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','/:bot/coins','bb-settings.json','auth','Unauthorized\x20attempt\x20to\x20store\x20configuration','allow','No\x20bots\x20running\x20right\x20now','connection','callback_query','then','540751rDiFlL','15\x20min','expiry','alerts','-performance.json','remove','Notifications\x20types:\x20','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','sign','\x20|\x20','conn','order','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','invalid\x20credentials','Unauthorized\x20attempt\x20to\x20log\x20out','whitelistEnabled','get-starting-balances','bot','version.json','pidRefreshToken','readFileSync','/restart\x20-\x20restart\x20bot(s)\x0a','max','createServer','telegramToken','listen','env','stringify','Bot\x20Mgr\x20>\x20','showname','Notifications\x20disabled','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','copyFileSync','idling\x20bot\x20\x20\x20|\x20Bot\x20','referer','f2aRequired','Ok,\x20will\x20send\x20order\x20notifications\x20only','whitelist','toggleBotMode','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Balance\x20Bot\x20Server','438XWvcch','send','6b67f3d61ee94b8f5c80b4affef4c4d9','token','lowdb','Login\x20rejected','getMonth','reload','answerCallbackQuery','server','HTML','password','Server','use','toIPv4Address','mixpanel','inherit','config/','<b>Telegram\x20Bot\x20Status:</b>\x0a','join','defaults','init','store-configuration','build2','exit','login\x20token\x20generated','disabled\x20Bot\x20','botname','name','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','startsWith','getFullYear','bot-','analytics','telegramEvents','Unauthorized\x20attempt\x20to\x20add\x20bot','update-bb','30\x20min','includes','entries','once','10698cdvoAf','apiKey','Unauthorized\x20attempt\x20to\x20confirm\x20message','status','build','default','::1','2FA\x20login\x20token\x20generated','sendPortfolioTelegram','stopped','5103RKgRwN','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','getUTCHours','messages','2FA\x20required','All\x20bots\x20running\x20right\x20now','Token\x20blacklisted','match','botmanager','keys','login','publicKey','temporary\x20access\x20rejected','telegramIpApproval','Markdown','getMinutes','manual','api-eu.mixpanel.com','/names\x20-\x20show\x20bot\x20names\x0a','access\x20timeout','https://api.ipify.org?format=json','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','apply','blacklist','enabled\x20Bot\x20','static','SIGINT','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','https://hodlerhacks.com','\x20only\x0a','yes','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','telegramEnabled','temporary\x20token\x20generated','type','lowdb/adapters/FileSync','search','test','isIPv4MappedAddress','-events.json','/on\x20-\x20start\x20bot(s)\x0a','get','exp','268OATLcS','compareSync','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','User\x20has\x20been\x20validated','deleted\x20Bot\x20','secure','reject','accept','Invalid\x20Telegram\x20token','sendMessage','secret','127.0.0.1','jsonwebtoken','notification','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','/enable\x20-\x20enable\x20notifications\x0a','Ok,\x20will\x20send\x20alert\x20notifications\x20only','started','store-headless','argv','push','settings','randomBytes','logout','NTBA_FIX_319','clientip','filter','min','catch','\x20minutes','index.html','bot.js','find','padStart','log','Unauthorized\x20attempt\x20to\x20get\x20messages','track','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','\x20to\x20','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','login\x20required','Unauthorized\x20attempt\x20to\x20update\x20bot','chat','Unauthorized\x20login\x20attempt\x20(timeout)','updatebotmanager','settings.','Starting\x20Balance\x20Bot\x20update','readdirSync','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','logged\x20out','reason','add-bot','get-messages','function','error\x20while\x20deleting\x20config\x20files:\x20','error','You\x20can\x20use\x20the\x20following\x20commands:\x0a','stopPolling','hasOwnProperty','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','message','ipc','timeshift','user','5463981sJFisG','length','/:bot/history','set','/:bot/support','store-settings','Unauthorized\x20attempt\x20to\x20get\x20portfolio','2FA','/disable\x20-\x20disable\x20notifications\x0a','bb-config.json','Password\x20reset\x20rejected','value','assign','UA-192771731-1','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','place-order','botID','username','*$1*','404\x20Not\x20Found','3000','<b>Balance\x20Bot\x20Status:</b>\x0a','isValid','forEach','Invalid\x20username\x20or\x20IP\x20address','getHours','unlinkSync','sockets'];_0x3481=function(){return _0x2f1ebb;};return _0x3481();}const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x50ea8b(0xf7)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x50ea8b(0x153)}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x50ea8b(0x1c1)]({'secure':{},'blacklist':[]})[_0x50ea8b(0xf7)]();let crypt=new Crypt({'md':'sha256','rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x50ea8b(0x1c2)](_0x50ea8b(0x1af),{'host':_0x50ea8b(0x1f2)}),analytics=Analytics({'app':'Balance\x20Bot','plugins':[googleAnalyticsV3Plugin({'trackingId':_0x50ea8b(0xe3)})]});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x50ea8b(0x195))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x50ea8b(0x134)),app=express(),http=require('http')[_0x50ea8b(0x19a)](app);app[_0x50ea8b(0x1ba)](express[_0x50ea8b(0x1fa)](path[_0x50ea8b(0x1c0)](__dirname,bbpath2,_0x50ea8b(0x1c4)))),app[_0x50ea8b(0x1ba)](express['static'](path[_0x50ea8b(0x1c0)](__dirname,bbpath2,'build'))),app[_0x50ea8b(0x20b)]('/',function(_0x2e209a,_0x520b2d){const _0x8f1423=_0x50ea8b;_0x520b2d['sendFile'](path['join'](__dirname,bbpath2,_0x8f1423(0x1c4),_0x8f1423(0xb4)));}),app['get'](_0x50ea8b(0x150),function(_0x1ee4b0,_0x24783b){const _0x1a124d=_0x50ea8b;_0x24783b[_0x1a124d(0x143)](path['join'](__dirname,bbpath2,_0x1a124d(0x1da),_0x1a124d(0xb4)));}),app[_0x50ea8b(0x20b)]('/:bot/portfolio',(_0x3305df,_0x1549e1)=>{const _0x421d1b=_0x50ea8b;_0x1549e1['sendFile'](path[_0x421d1b(0x1c0)](__dirname,bbpath2,'build','index.html'));}),app['get'](_0x50ea8b(0x139),(_0x441e42,_0x34aa2f)=>{const _0x3fe2f6=_0x50ea8b;_0x34aa2f[_0x3fe2f6(0x143)](path[_0x3fe2f6(0x1c0)](__dirname,bbpath2,_0x3fe2f6(0x1da),_0x3fe2f6(0xb4)));}),app[_0x50ea8b(0x20b)](_0x50ea8b(0x17a),(_0xf94e54,_0x30845a)=>{const _0x1818af=_0x50ea8b;_0x30845a[_0x1818af(0x143)](path[_0x1818af(0x1c0)](__dirname,bbpath2,_0x1818af(0x1da),_0x1818af(0xb4)));}),app[_0x50ea8b(0x20b)](_0x50ea8b(0xd8),(_0x132642,_0x5efdbb)=>{const _0x48ae31=_0x50ea8b;_0x5efdbb['sendFile'](path[_0x48ae31(0x1c0)](__dirname,bbpath2,_0x48ae31(0x1da),_0x48ae31(0xb4)));}),app[_0x50ea8b(0x20b)](_0x50ea8b(0x138),(_0x5a8f1d,_0x38df58)=>{const _0x210cf5=_0x50ea8b;_0x38df58['sendFile'](path[_0x210cf5(0x1c0)](__dirname,bbpath2,_0x210cf5(0x1da),_0x210cf5(0xb4)));}),app['get'](_0x50ea8b(0xda),(_0x20299c,_0xda0a33)=>{const _0x49fc65=_0x50ea8b;_0xda0a33[_0x49fc65(0x143)](path[_0x49fc65(0x1c0)](__dirname,bbpath2,_0x49fc65(0x1da),_0x49fc65(0xb4)));});if(HOST)http[_0x50ea8b(0x19c)](PORT,HOST);else http[_0x50ea8b(0x19c)](PORT);const io=require('socket.io')(http,{}),TelegramBot=require(_0x50ea8b(0x141));let tgBot;if(settings[_0x50ea8b(0x19b)]&&settings['telegramToken']!=''&&settings['telegramUsername']&&settings[_0x50ea8b(0x109)]!='')initTelegram();init();async function init(){await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),startServer(),startSocket(),startScheduler(),triggerAnalytics(!![]),getMessages();}function startServer(){const _0xad549c=_0x50ea8b;console['log'](''),console['log'](_0xad549c(0xfb)),logging(_0xad549c(0xbb)+PORT),console[_0xad549c(0xb8)]('-----------------------------------------------------------------------------------');if(config[_0xad549c(0xd7)]!=0x0)config['forEach'](_0x1b6d1d=>{const _0x9b1839=_0xad549c;if(_0x1b6d1d[_0x9b1839(0x1d9)]==_0x9b1839(0x11b)||_0x1b6d1d[_0x9b1839(0x1d9)]=='new')logging('starting\x20bot\x20|\x20Bot\x20'+_0x1b6d1d['botID']+_0x9b1839(0x18c)+_0x1b6d1d[_0x9b1839(0x1c8)]),startBot([_0x1b6d1d['botID'],userID],{'cwd':bbpath},function(_0x3ef389){if(_0x3ef389)logging(_0x3ef389);});else(_0x1b6d1d[_0x9b1839(0x1d9)]==_0x9b1839(0x11a)||_0x1b6d1d[_0x9b1839(0x1d9)]=='new-disabled')&&logging(_0x9b1839(0x1a5)+_0x1b6d1d[_0x9b1839(0xe6)]+_0x9b1839(0x18c)+_0x1b6d1d[_0x9b1839(0x1c8)]);});else!newBot&&console[_0xad549c(0xb8)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();console[_0xad549c(0xb8)](_0xad549c(0xfb)),console[_0xad549c(0xb8)]('');}function startSocket(){const _0x18fdc2=_0x50ea8b;io['on'](_0x18fdc2(0x180),_0x2d3570=>{const _0x324dce=_0x18fdc2;let _0x549d61,_0x3272a4,_0x311046,_0x295573,_0x36b648;const _0x3080ae=_0x2d3570[_0x324dce(0x148)][_0x324dce(0x122)][_0x324dce(0x1a6)];_0x3272a4=_0x3080ae['match'](/bot[0-9]{3}/);if(_0x3272a4)_0x311046=_0x3272a4[0x0][_0x324dce(0x1e8)](/[0-9]{3}/);if(_0x311046)_0x549d61=_0x311046[0x0];else _0x549d61=_0x324dce(0x1e9);const _0x3a35b5=_0x2d3570['handshake'][_0x324dce(0x17c)][_0x324dce(0x165)];if(!_0x3a35b5)_0x2d3570['emit']('status',{'publicKey':secure[_0x324dce(0x1ec)]});else{_0x295573=timelyDecrypt(_0x3a35b5,![]);if(!_0x295573)_0x2d3570['emit'](_0x324dce(0x1d9),{'publicKey':secure[_0x324dce(0x1ec)]});else{_0x36b648=normalizeIP(_0x2d3570[_0x324dce(0x18d)][_0x324dce(0xfc)])[_0x324dce(0x105)];if(!devices[_0x295573])devices[_0x295573]={'uuid':_0x295573,'access':{'token':null}};devices[_0x295573]['ip']=_0x36b648;const _0x3a4c1a=addClient(_0x2d3570['id'],_0x295573,_0x549d61);setAccess(_0x3a4c1a),emitMessages(),_0x2d3570['on'](_0x324dce(0x1eb),_0x276a1d=>{const _0x1d37a3=_0x324dce,_0x355d90=timelyDecrypt(_0x276a1d['password']);if(_0x355d90){_0x276a1d={'username':_0x276a1d[_0x1d37a3(0xe7)],'password':_0x355d90},devices[_0x295573][_0x1d37a3(0x147)]=validateCredentials(_0x276a1d,_0x295573);if(devices[_0x295573]['access'][_0x1d37a3(0x17e)]==![]&&devices[_0x295573][_0x1d37a3(0x147)][_0x1d37a3(0xc8)]=='2FA\x20login\x20required')_0x2d3570[_0x1d37a3(0x152)](_0x1d37a3(0x1d9),{'access':devices[_0x295573][_0x1d37a3(0x147)]}),loginAccess2FA(_0x295573,_0x36b648);else{if(devices[_0x295573][_0x1d37a3(0x147)][_0x1d37a3(0x17e)]==![]&&devices[_0x295573][_0x1d37a3(0x147)]['reason']=='invalid\x20credentials')_0x2d3570[_0x1d37a3(0x152)](_0x1d37a3(0x1d9),{'access':devices[_0x295573]['access']});else devices[_0x295573][_0x1d37a3(0x147)][_0x1d37a3(0x17e)]&&devices[_0x295573]['access'][_0x1d37a3(0xc8)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x295573)[_0x1d37a3(0xed)](_0x4394b0=>{setAccess(_0x4394b0);}),setTokenRefresh(_0x295573),setSessionTimeout(_0x1d37a3(0x1eb),_0x295573));}}else logging(_0x1d37a3(0xc1));}),_0x2d3570['on']('reset-password',()=>{resetPassword();}),_0x2d3570['on'](_0x324dce(0x137),_0x43f7e7=>{removeClient(_0x2d3570['id']);});}}});}function initClient(_0x3e194c){const _0x3f5b9c=_0x50ea8b;if(_0x3e194c!=_0x3f5b9c(0x1e9)&&config[_0x3f5b9c(0x1d7)]!=''){if(pid[_0x3e194c])pid[_0x3e194c][_0x3f5b9c(0x1ae)]({'function':'initclient','args':null});}}function getSocket(_0x171691){const _0x7cb1b0=_0x50ea8b;return io[_0x7cb1b0(0xf1)][_0x7cb1b0(0xf1)][_0x7cb1b0(0x20b)](_0x171691);}function setAccess(_0x5aa90e){const _0x51ed99=_0x50ea8b,_0x2c68fc=getSocket(_0x5aa90e['id']),_0x15ad59=_0x5aa90e[_0x51ed99(0x140)],_0x19d713=_0x5aa90e['bot'];devices[_0x15ad59][_0x51ed99(0x147)]=validateAccess(devices[_0x15ad59][_0x51ed99(0x147)][_0x51ed99(0x1b0)],_0x15ad59),_0x2c68fc[_0x51ed99(0x1c0)](_0x15ad59);if(devices[_0x15ad59][_0x51ed99(0x147)][_0x51ed99(0x17e)]){_0x2c68fc[_0x51ed99(0x1c0)](_0x19d713);if(_0x19d713==_0x51ed99(0x1e9))initializeSocketBotManager(_0x2c68fc);else initializeSocketBot(_0x2c68fc);initClient(_0x19d713);}devices[_0x15ad59]['access']['token']&&devices[_0x15ad59][_0x51ed99(0x147)][_0x51ed99(0xc8)]==_0x51ed99(0x203)&&setSessionTimeout(_0x51ed99(0xdd),_0x15ad59),devices[_0x15ad59][_0x51ed99(0x147)][_0x51ed99(0x1b0)]&&devices[_0x15ad59][_0x51ed99(0x147)][_0x51ed99(0xc8)]==_0x51ed99(0x1dd)&&setSessionTimeout(_0x51ed99(0x1eb),_0x15ad59),_0x2c68fc[_0x51ed99(0x152)](_0x51ed99(0x1d9),{'status':_0x5aa90e[_0x51ed99(0x1b6)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x15ad59][_0x51ed99(0x147)],'externalip':devices[_0x15ad59]['ip'],'publicKey':secure[_0x51ed99(0x1ec)],'userid':settings[_0x51ed99(0x168)],'validInstallation':validInstallation}),devices[_0x15ad59][_0x51ed99(0x147)][_0x51ed99(0x17e)]==![]&&devices[_0x15ad59][_0x51ed99(0x147)][_0x51ed99(0xc8)]==_0x51ed99(0x1e5)&&temporaryAccess2FA(_0x15ad59,devices[_0x15ad59]['ip']);}function setSessionTimeout(_0x259596,_0x55299e){const _0x1a239d=_0x50ea8b;let _0x2a9628;if(_0x259596==_0x1a239d(0x1eb))_0x2a9628=loginExpiry*0x3c*0x3e8;else _0x2a9628=devices[_0x55299e][_0x1a239d(0x1ee)][_0x1a239d(0x185)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x55299e]['telegramIpApproval'][_0x1a239d(0x118)]);if(devices[_0x55299e][_0x1a239d(0x14a)])clearTimeout(devices[_0x55299e]['pidExpireLogin']);devices[_0x55299e]['pidExpireLogin']=setTimeout(()=>{const _0x509a9f=_0x1a239d;if(devices[_0x55299e][_0x509a9f(0x196)])clearTimeout(devices[_0x55299e][_0x509a9f(0x196)]);removeSocketListeners(_0x55299e),addBlacklist(_0x55299e),devices[_0x55299e]['telegramIpApproval']=null,devices[_0x55299e][_0x509a9f(0x112)]=null,devices[_0x55299e][_0x509a9f(0x147)][_0x509a9f(0x1b0)]=null,devices[_0x55299e]['access']=validateAccess(devices[_0x55299e][_0x509a9f(0x147)][_0x509a9f(0x1b0)],_0x55299e),!(devices[_0x55299e]['access'][_0x509a9f(0x17e)]&&devices[_0x55299e]['access'][_0x509a9f(0xc8)]==_0x509a9f(0xf5))&&(_0x259596==_0x509a9f(0x1eb)?io['to'](_0x55299e)[_0x509a9f(0x152)]('status',{'access':{'allow':![],'reason':_0x509a9f(0x1f4),'token':null}}):io['to'](_0x55299e)[_0x509a9f(0x152)](_0x509a9f(0x1d9),{'access':{'allow':![],'reason':_0x509a9f(0x13e),'token':null}})),devices[_0x55299e][_0x509a9f(0x147)][_0x509a9f(0x1b0)]=null;},_0x2a9628);}function setTokenRefresh(_0x41f64e){const _0x25ad29=_0x50ea8b;if(devices[_0x41f64e][_0x25ad29(0x196)])clearTimeout(devices[_0x41f64e][_0x25ad29(0x196)]);devices[_0x41f64e][_0x25ad29(0x196)]=setTimeout(()=>{const _0x3d1230=_0x25ad29;getClientsWithUuid(_0x41f64e)[_0x3d1230(0xd7)]!=0x0?(devices[_0x41f64e]['access']=refreshToken(_0x41f64e),io['to'](_0x41f64e)[_0x3d1230(0x152)](_0x3d1230(0x1d9),{'status':_0x3d1230(0x15b),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x41f64e][_0x3d1230(0x147)],'externalip':devices[_0x41f64e]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x41f64e)):clearTimeout(devices[_0x41f64e]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2dd459){const _0x449af0=_0x50ea8b,_0x412562=getClient(_0x2dd459['id'])['uuid'];_0x2dd459[_0x449af0(0x152)](_0x449af0(0x13a),config),_0x2dd459[_0x449af0(0x152)](_0x449af0(0x222),cleanSettings()),_0x2dd459['on'](_0x449af0(0xc9),_0x4eb029=>{const _0x83ffaa=_0x449af0;if(validateAccess(_0x4eb029,_0x412562)[_0x83ffaa(0x17e)])addBot();else logging(_0x83ffaa(0x1d0));}),_0x2dd459['on'](_0x449af0(0x158),(_0x20c565,_0x1c35ef)=>{const _0x2039df=_0x449af0;if(validateAccess(_0x1c35ef,_0x412562)[_0x2039df(0x17e)])toggleBot(_0x20c565[_0x2039df(0xe6)],_0x20c565[_0x2039df(0x1d9)],_0x20c565['live']);else logging(_0x2039df(0xbf));}),_0x2dd459['on']('toggle-bot-mode',(_0x33787f,_0x135174)=>{const _0x42cc52=_0x449af0;if(validateAccess(_0x135174,_0x412562)['allow'])toggleBotMode(_0x33787f);else logging(_0x42cc52(0xbf));}),_0x2dd459['on']('delete-bot',(_0x2cfeec,_0x19a3db)=>{const _0x3da58a=_0x449af0;if(validateAccess(_0x19a3db,_0x412562)[_0x3da58a(0x17e)])deleteBot(_0x2cfeec);else logging(_0x3da58a(0x126));}),_0x2dd459['on'](_0x449af0(0xdb),(_0x543980,_0x51cb52)=>{if(validateAccess(_0x51cb52,_0x412562)['allow'])storeSettings(_0x543980,!![]);else logging('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x2dd459['on'](_0x449af0(0x1d1),_0x3a9d0f=>{const _0x542726=_0x449af0;if(validateAccess(_0x3a9d0f,_0x412562)['allow'])updateBB();else logging(_0x542726(0x178));}),_0x2dd459['on'](_0x449af0(0xca),_0x71eb59=>{const _0x1e7c2d=_0x449af0;if(validateAccess(_0x71eb59,_0x412562)[_0x1e7c2d(0x17e)])getMessages();else logging(_0x1e7c2d(0xb9));}),_0x2dd459['on']('confirm-message',(_0x3fc792,_0x2f0df3)=>{const _0x1e12ac=_0x449af0;if(validateAccess(_0x2f0df3,_0x412562)[_0x1e12ac(0x17e)])confirmMessage(_0x3fc792);else logging(_0x1e12ac(0x1d8));}),_0x2dd459['on'](_0x449af0(0x224),_0x5f1397=>{const _0x120bd7=_0x449af0;if(validateAccess(_0x5f1397,_0x412562)['allow']){if(devices[_0x412562][_0x120bd7(0x196)])clearTimeout(devices[_0x412562][_0x120bd7(0x196)]);if(devices[_0x412562][_0x120bd7(0x14a)])clearTimeout(devices[_0x412562][_0x120bd7(0x14a)]);removeSocketListeners(getClient(_0x2dd459['id'])[_0x120bd7(0x140)]),addBlacklist(_0x412562),devices[_0x412562][_0x120bd7(0x1ee)]=null,devices[_0x412562][_0x120bd7(0x112)]=null,devices[_0x412562]['access'][_0x120bd7(0x1b0)]=null,io['to'](getClient(_0x2dd459['id'])['uuid'])[_0x120bd7(0x152)]('status',{'access':{'allow':![],'reason':_0x120bd7(0xc7),'token':null}});}else logging(_0x120bd7(0x191));});}function initializeSocketBot(_0x21f24c){const _0xf19f62=_0x50ea8b,_0x32aaf7=getClient(_0x21f24c['id'])[_0xf19f62(0x194)],_0x13f658=getClient(_0x21f24c['id'])[_0xf19f62(0x140)];_0x21f24c['on']('get-logs',(_0x3a896a,_0x3b65a4)=>{const _0x55f313=_0xf19f62;if(validateAccess(_0x3b65a4,_0x13f658)[_0x55f313(0x17e)]){if(pid[_0x32aaf7])pid[_0x32aaf7][_0x55f313(0x1ae)]({'function':'emitHistory','args':_0x3a896a});}else logging('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0x21f24c['on']('delete-alerts',(_0x4717db,_0x5075b0)=>{const _0x324088=_0xf19f62;if(validateAccess(_0x5075b0,_0x13f658)['allow']){if(pid[_0x32aaf7])pid[_0x32aaf7][_0x324088(0x1ae)]({'function':'deleteHistoryAlerts','args':_0x4717db});}else logging('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x21f24c['on'](_0xf19f62(0x135),(_0x5d8f18,_0x3f51a6)=>{const _0x574cd5=_0xf19f62;if(validateAccess(_0x3f51a6,_0x13f658)[_0x574cd5(0x17e)]){if(pid[_0x32aaf7])pid[_0x32aaf7]['send']({'function':_0x574cd5(0x127),'args':_0x5d8f18});}else logging(_0x574cd5(0xdc));}),_0x21f24c['on'](_0xf19f62(0x1c3),(_0x2518b9,_0x400527)=>{const _0xf7610a=_0xf19f62;if(validateAccess(_0x400527,_0x13f658)[_0xf7610a(0x17e)]){if(pid[_0x32aaf7])pid[_0x32aaf7][_0xf7610a(0x1ae)]({'function':_0xf7610a(0x157),'args':_0x2518b9});}else logging(_0xf7610a(0x17d));}),_0x21f24c['on'](_0xf19f62(0x21f),(_0x25614c,_0x492e01)=>{const _0xbaf9b4=_0xf19f62;if(validateAccess(_0x492e01,_0x13f658)[_0xbaf9b4(0x17e)]){if(pid[_0x32aaf7])pid[_0x32aaf7][_0xbaf9b4(0x1ae)]({'function':_0xbaf9b4(0x12f),'args':_0x25614c});}else logging(_0xbaf9b4(0xd1));}),_0x21f24c['on'](_0xf19f62(0x193),_0x10d72b=>{const _0x13bebb=_0xf19f62;if(validateAccess(_0x10d72b,_0x13f658)[_0x13bebb(0x17e)]){if(pid[_0x32aaf7])pid[_0x32aaf7][_0x13bebb(0x1ae)]({'function':'getStartingBalances','args':null});}else logging(_0x13bebb(0x119));}),_0x21f24c['on'](_0xf19f62(0xe5),(_0x4606f2,_0x41bea3)=>{const _0x2899f0=_0xf19f62;if(validateAccess(_0x41bea3,_0x13f658)[_0x2899f0(0x17e)]){if(pid[_0x32aaf7])pid[_0x32aaf7]['send']({'function':'placeOrder','args':_0x4606f2});}else logging(_0x2899f0(0xf2));}),_0x21f24c['on'](_0xf19f62(0x15d),_0x554c52=>{const _0x3407a1=_0xf19f62;if(validateAccess(_0x554c52,_0x13f658)[_0x3407a1(0x17e)]){if(pid[_0x32aaf7])pid[_0x32aaf7]['send']({'function':'cancelLoading','args':null});}else logging(_0x3407a1(0x20f));}),_0x21f24c['on'](_0xf19f62(0x1d1),_0x53399a=>{const _0x2990f3=_0xf19f62;if(validateAccess(_0x53399a,_0x13f658)[_0x2990f3(0x17e)])updateBB();else logging('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x21f24c['on']('get-messages',_0x56aadc=>{const _0x54bfbc=_0xf19f62;if(validateAccess(_0x56aadc,_0x13f658)[_0x54bfbc(0x17e)])getMessages();else logging('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x21f24c['on'](_0xf19f62(0x14b),(_0x2ec68c,_0x332b6b)=>{const _0x3b648a=_0xf19f62;if(validateAccess(_0x332b6b,_0x13f658)[_0x3b648a(0x17e)])confirmMessage(_0x2ec68c);else logging(_0x3b648a(0x1d8));}),_0x21f24c['on'](_0xf19f62(0x224),_0x3b4e07=>{const _0x230034=_0xf19f62;if(validateAccess(_0x3b4e07,_0x13f658)[_0x230034(0x17e)]){if(devices[_0x13f658]['pidRefreshToken'])clearTimeout(devices[_0x13f658][_0x230034(0x196)]);if(devices[_0x13f658][_0x230034(0x14a)])clearTimeout(devices[_0x13f658][_0x230034(0x14a)]);removeSocketListeners(getClient(_0x21f24c['id'])[_0x230034(0x140)]),addBlacklist(_0x13f658),devices[_0x13f658][_0x230034(0x1ee)]=null,devices[_0x13f658]['telegram2FaApproval']=null,devices[_0x13f658][_0x230034(0x147)][_0x230034(0x1b0)]=null,io['to'](getClient(_0x21f24c['id'])[_0x230034(0x140)])[_0x230034(0x152)](_0x230034(0x1d9),{'access':{'allow':![],'reason':_0x230034(0xc7),'token':null}});}else logging(_0x230034(0x191));});}function removeSocketListeners(_0x32c798){const _0x529e4a=_0x50ea8b;getClientsWithUuid(_0x32c798)[_0x529e4a(0xed)](_0x13a856=>{const _0x4eee8d=_0x529e4a;getSocket(_0x13a856['id'])[_0x4eee8d(0x12a)]();});}function cleanSettings(){const _0x182bd8=_0x50ea8b;let _0x3825d6=settings;return settings[_0x182bd8(0x19b)]&&settings[_0x182bd8(0x19b)]!=''&&(_0x3825d6={..._0x3825d6,'telegramToken':'************'}),settings['bbPassword']&&settings['bbPassword']!=''&&(_0x3825d6={..._0x3825d6,'bbPassword':_0x182bd8(0x16e)}),_0x3825d6;}function updateBB(){const _0xa3ee1c=_0x50ea8b;installingUpdate=!![],config[_0xa3ee1c(0xed)](_0x3691a3=>{const _0x44c210=_0xa3ee1c;restartBot(_0x3691a3[_0x44c210(0xe6)]);}),process[_0xa3ee1c(0x1ae)]({'update':!![]},_0xa67740=>{});}function startBot(_0x5b3699,_0x31d360,_0x557ed6){const _0x12ec70=_0x50ea8b;let _0x573e57=![];const _0x2b2b4c=_0x5b3699[0x0];_0x31d360={..._0x31d360,'stdio':[_0x12ec70(0x1bd),_0x12ec70(0x1bd),'inherit',_0x12ec70(0xd3)]},pid[_0x2b2b4c]=childProcess['fork'](botfile,_0x5b3699,_0x31d360),pid[_0x2b2b4c]['on'](_0x12ec70(0xd2),_0x57e8e7=>{const _0xc39e1d=_0x12ec70;switch(Object[_0xc39e1d(0x1ea)](_0x57e8e7)[0x0]){case'botname':updateBotName(_0x2b2b4c,_0x57e8e7[_0xc39e1d(0x1c8)]);break;case _0xc39e1d(0xc2):updateBotManager();break;case'status':updateStatus(_0x2b2b4c,_0x57e8e7[_0xc39e1d(0x1d9)]);break;case _0xc39e1d(0x177):updateLive(_0x2b2b4c,_0x57e8e7[_0xc39e1d(0x177)]);break;case _0xc39e1d(0x21e):updateLive(_0x2b2b4c,_0x57e8e7[_0xc39e1d(0x21e)]),io['to'](_0x2b2b4c)[_0xc39e1d(0x152)](_0xc39e1d(0x1d9),{'access':{'allow':![],'reason':_0xc39e1d(0x1b4),'token':null}});break;case _0xc39e1d(0x103):_0x57e8e7['stop']==_0xc39e1d(0x120)&&restartBot(_0x2b2b4c);_0x57e8e7[_0xc39e1d(0x103)]=='kill'&&toggleBot(_0x2b2b4c,'disabled',_0xc39e1d(0x1df));break;case _0xc39e1d(0x111):sendTelegram(_0x2b2b4c,_0x57e8e7[_0xc39e1d(0x111)]);break;case'telegrammsg':sendTelegramMsg(_0x57e8e7['telegrammsg']);break;case _0xc39e1d(0xcb):io['to'](_0x2b2b4c)[_0xc39e1d(0x152)](_0x57e8e7['function'],_0x57e8e7['args']);break;}}),pid[_0x2b2b4c]['on'](_0x12ec70(0xcd),function(_0x3a6dad){if(_0x573e57)return;_0x573e57=!![],_0x557ed6(_0x3a6dad);}),pid[_0x2b2b4c]['on'](_0x12ec70(0x1c5),function(_0x217d87){const _0x2f5443=_0x12ec70;if(installingUpdate)return;if(_0x573e57)return;_0x573e57=!![],_0x557ed6(null);const _0x3acfe7=dbConfig['get'](_0x2f5443(0x13a))['find']({'botID':_0x2b2b4c})[_0x2f5443(0xe1)]();_0x3acfe7&&(_0x3acfe7[_0x2f5443(0x1d9)]==_0x2f5443(0x11b)||_0x3acfe7[_0x2f5443(0x1d9)]==_0x2f5443(0xfd))&&(updateLive(_0x2b2b4c,'stopped'),logging(_0x2f5443(0x115)+_0x2b2b4c),startBot([_0x2b2b4c,userID],{'cwd':bbpath},function(_0x5922a4){if(_0x5922a4)logging(_0x5922a4);}));});}function stopBot(_0x46ad1d){const _0x4a72d1=_0x50ea8b;getClientsWithBotID(_0x46ad1d)['forEach'](_0x8c88a8=>{const _0x346f70=_0x5441;getSocket(_0x8c88a8['id'])[_0x346f70(0x137)](!![]),removeClient(_0x8c88a8['id']);}),pid[_0x46ad1d]&&(pid[_0x46ad1d][_0x4a72d1(0x151)](),pid[_0x46ad1d]=null);}function restartBot(_0x4a0000){const _0x308689=_0x50ea8b;if(pid[_0x4a0000])pid[_0x4a0000][_0x308689(0x151)]();}function addBot(){const _0x520031=_0x50ea8b;let _0x1cf155;for(let _0xf199bb=0x1;_0xf199bb<0x3e9;_0xf199bb++){_0x1cf155=_0xf199bb[_0x520031(0x160)]()[_0x520031(0xb7)](0x3,'0');let _0x242e26=config[_0x520031(0xb6)](_0x1152f0=>_0x1152f0[_0x520031(0xe6)]==_0x1cf155);if(!_0x242e26)break;}if(_0x1cf155==='1000'){logging('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logging('starting\x20new\x20bot\x20|\x20Bot\x20'+_0x1cf155),dbConfig['get'](_0x520031(0x13a))[_0x520031(0x221)]({'botID':_0x1cf155,'botname':'Bot\x20'+_0x1cf155,'status':_0x520031(0xfd),'live':''})[_0x520031(0xf7)](),startBot([_0x1cf155,userID],{'cwd':bbpath},function(_0x3dca69){if(_0x3dca69)logging(_0x3dca69);}),config=getConfiguration(),io['to'](_0x520031(0x1e9))[_0x520031(0x152)](_0x520031(0x13a),config);}function deleteBot(_0x21de98){const _0x15b42e=_0x50ea8b;getClientsWithBotID(_0x21de98)[_0x15b42e(0xed)](_0x5bcb3e=>{const _0x341ef1=_0x15b42e;getSocket(_0x5bcb3e['id'])[_0x341ef1(0x137)](!![]),removeClient(_0x5bcb3e['id']);}),dbConfig['get']('bots')['remove']({'botID':_0x21de98})[_0x15b42e(0xf7)](),logging(_0x15b42e(0x211)+_0x21de98),stopBot(_0x21de98);try{fs[_0x15b42e(0xf0)](path[_0x15b42e(0x1c0)](configpath,_0x15b42e(0x1cd)+_0x21de98+'-config.json')),fs['unlinkSync'](path['join'](configpath,'bot-'+_0x21de98+_0x15b42e(0x209))),fs['unlinkSync'](path[_0x15b42e(0x1c0)](configpath,_0x15b42e(0x1cd)+_0x21de98+_0x15b42e(0x187))),fs[_0x15b42e(0xf0)](path['join'](configpath,_0x15b42e(0x1cd)+_0x21de98+'-results.json'));}catch(_0x3f8135){if(_0x3f8135)logging(_0x15b42e(0xcc),_0x3f8135);}config=getConfiguration(),io['to'](_0x15b42e(0x1e9))['emit']('bots',config);}function toggleBot(_0x574c9b,_0x1fe4e1,_0x1c7c49){const _0x535b8f=_0x50ea8b;dbConfig[_0x535b8f(0x20b)](_0x535b8f(0x13a))[_0x535b8f(0xb6)]({'botID':_0x574c9b})[_0x535b8f(0xe2)]({'status':_0x1fe4e1})[_0x535b8f(0xe2)]({'live':_0x1c7c49})['write']();if(_0x1fe4e1==_0x535b8f(0x11b)||_0x1fe4e1==_0x535b8f(0xfd))logging(_0x535b8f(0x1f9)+_0x574c9b),startBot([_0x574c9b,userID],{'cwd':bbpath},function(_0x407ac2){if(_0x407ac2)logging(_0x407ac2);});else(_0x1fe4e1==_0x535b8f(0x11a)||_0x1fe4e1==_0x535b8f(0x173))&&(logging(_0x535b8f(0x1c7)+_0x574c9b),stopBot(_0x574c9b));config=getConfiguration(),io['to'](_0x535b8f(0x1e9))[_0x535b8f(0x152)](_0x535b8f(0x13a),config);}function toggleStatus(_0x3fa3b9){const _0x340f24=_0x50ea8b;let _0x14dd6f=dbConfig[_0x340f24(0x20b)]('bots')[_0x340f24(0xb6)]({'botID':_0x3fa3b9})[_0x340f24(0xe1)](),_0x5d8ea3;if(_0x14dd6f[_0x340f24(0x1d9)]===_0x340f24(0x11b))_0x5d8ea3='disabled';else{if(_0x14dd6f[_0x340f24(0x1d9)]===_0x340f24(0xfd))_0x5d8ea3=_0x340f24(0x173);else{if(_0x14dd6f[_0x340f24(0x1d9)]===_0x340f24(0x173))_0x5d8ea3=_0x340f24(0xfd);else{if(_0x14dd6f[_0x340f24(0x1d9)]===_0x340f24(0x11a))_0x5d8ea3='enabled';}}}return _0x5d8ea3;}function updateStatus(_0x5c59f6,_0xb8958f){const _0x12524e=_0x50ea8b;dbConfig[_0x12524e(0x20b)](_0x12524e(0x13a))[_0x12524e(0xb6)]({'botID':_0x5c59f6})[_0x12524e(0xe2)]({'status':_0xb8958f})['write'](),config=getConfiguration(),io['to'](_0x12524e(0x1e9))[_0x12524e(0x152)]('bots',config);}function updateLive(_0x5a5827,_0x209d51){const _0x5b28ed=_0x50ea8b;dbConfig[_0x5b28ed(0x20b)](_0x5b28ed(0x13a))[_0x5b28ed(0xb6)]({'botID':_0x5a5827})[_0x5b28ed(0xe2)]({'live':_0x209d51})[_0x5b28ed(0xf7)](),config=getConfiguration(),io['to'](_0x5b28ed(0x1e9))['emit'](_0x5b28ed(0x13a),config);}function updateBotName(_0x41c75e,_0x499e66){const _0x133d32=_0x50ea8b;dbConfig['get'](_0x133d32(0x13a))[_0x133d32(0xb6)]({'botID':_0x41c75e})[_0x133d32(0xe2)]({'botname':_0x499e66})['write'](),config=getConfiguration(),io['to'](_0x133d32(0x1e9))['emit'](_0x133d32(0x13a),config);}function updateBotManager(){const _0x3a9fd8=_0x50ea8b;config=getConfiguration(),io['to'](_0x3a9fd8(0x1e9))[_0x3a9fd8(0x152)](_0x3a9fd8(0x13a),config);}function toggleBotMode(_0x461698){const _0x25ee89=_0x50ea8b;if(pid[_0x461698])pid[_0x461698]['send']({'function':_0x25ee89(0x1aa),'args':null});else{const _0x4adc13=configpath+'bot-'+_0x461698+_0x25ee89(0xf4),_0x414231=fs['readFileSync'](_0x4adc13),_0x440321=JSON[_0x25ee89(0x149)](_0x414231),_0x922ec4=_0x440321['bot'][0x0][_0x25ee89(0xff)];_0x440321[_0x25ee89(0x194)][0x0]['headless']=!_0x922ec4;const _0x3cfde1=JSON[_0x25ee89(0x19e)](_0x440321,null,0x2);fs[_0x25ee89(0x12c)](_0x4adc13,_0x3cfde1),config=getConfiguration(),io['to'](_0x25ee89(0x1e9))[_0x25ee89(0x152)]('bots',config);}}function telegramError(_0x450fe6){const _0x338b00=_0x50ea8b;console['log'](getTimeStamp()+_0x338b00(0x125));}function validateTelegram(_0x367776){const _0x298f0d=_0x50ea8b;if(_0x367776[_0x298f0d(0x10b)][_0x298f0d(0xe7)]!=settings[_0x298f0d(0x109)]&&'@'+_0x367776[_0x298f0d(0x10b)][_0x298f0d(0xe7)]!=settings[_0x298f0d(0x109)])return tgBot[_0x298f0d(0x216)](_0x367776['chat']['id'],_0x298f0d(0x1fc),{'parse_mode':_0x298f0d(0x1b7)})[_0x298f0d(0xb2)](_0x4c1de4=>{telegramError(_0x4c1de4);}),![];return!![];}async function initTelegram(){const _0x226652=_0x50ea8b;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x226652(0x19b)],{'polling':!![]});let _0x40de6f=_0x226652(0xce);_0x40de6f+='\x0a',_0x40de6f+=_0x226652(0x21c),_0x40de6f+=_0x226652(0xde),_0x40de6f+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x40de6f+=_0x226652(0x198),_0x40de6f+=_0x226652(0x20a),_0x40de6f+='/off\x20-\x20stop\x20bot(s)\x0a',_0x40de6f+=_0x226652(0x13b),_0x40de6f+=_0x226652(0x1f3),_0x40de6f+=_0x226652(0x12e),_0x40de6f+=_0x226652(0xe4),_0x40de6f+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x40de6f+=_0x226652(0x14e);let _0x2a885c=_0x226652(0x1ab);_0x2a885c+='\x0a',_0x2a885c+=_0x40de6f,tgBot['onText'](/\/start/,_0x3a29e5=>{const _0x5e0efa=_0x226652;if(!validateTelegram(_0x3a29e5))return;if(settings['telegramChatId']!=_0x3a29e5[_0x5e0efa(0xc0)]['id'])updateSetting(_0x5e0efa(0x131),_0x3a29e5['chat']['id']);updateSetting(_0x5e0efa(0x202),!![]),tgBot[_0x5e0efa(0x216)](_0x3a29e5['chat']['id'],_0x2a885c)[_0x5e0efa(0xb2)](_0x378b42=>{telegramError(_0x378b42);});}),tgBot[_0x226652(0x100)](/\/enable/,_0xbd3781=>{const _0x4b7a99=_0x226652;if(!validateTelegram(_0xbd3781))return;if(settings[_0x4b7a99(0x131)]!=_0xbd3781['chat']['id'])updateSetting(_0x4b7a99(0x131),_0xbd3781[_0x4b7a99(0xc0)]['id']);updateSetting(_0x4b7a99(0x202),!![]),tgBot[_0x4b7a99(0x216)](_0xbd3781['chat']['id'],_0x4b7a99(0x12d))[_0x4b7a99(0xb2)](_0x33b96d=>{telegramError(_0x33b96d);});}),tgBot['onText'](/\/config/,async _0x2fc8fe=>{const _0x39651a=_0x226652;if(!validateTelegram(_0x2fc8fe))return;tgBot['removeListener'](_0x39651a(0x181)),tgBot[_0x39651a(0x216)](_0x2fc8fe['chat']['id'],_0x39651a(0x1e1),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x39651a(0x11f)},{'text':_0x39651a(0x16d),'callback_data':_0x39651a(0x186)},{'text':'All','callback_data':_0x39651a(0x104)}]]}})[_0x39651a(0xb2)](_0x32eef3=>{telegramError(_0x32eef3);}),tgBot['on'](_0x39651a(0x181),async _0x596dff=>{const _0x10290b=_0x39651a,_0x3db9be=_0x596dff[_0x10290b(0x16c)],_0x451d68=_0x596dff[_0x10290b(0xd2)];tgBot[_0x10290b(0x1b5)](_0x596dff['id'])[_0x10290b(0x182)](async()=>{const _0x5950f7=_0x10290b;_0x3db9be==_0x5950f7(0x11f)&&(updateSetting(_0x5950f7(0x1cf),'orders'),updateSetting('telegramEnabled',!![]),await tgBot[_0x5950f7(0x216)](_0x451d68['chat']['id'],_0x5950f7(0x1a8))[_0x5950f7(0xb2)](_0x2a0ac0=>{telegramError(_0x2a0ac0);}));_0x3db9be==_0x5950f7(0x186)&&(updateSetting(_0x5950f7(0x1cf),_0x5950f7(0x186)),updateSetting('telegramEnabled',!![]),await tgBot[_0x5950f7(0x216)](_0x451d68['chat']['id'],_0x5950f7(0x21d))['catch'](_0x4eb44e=>{telegramError(_0x4eb44e);}));_0x3db9be==_0x5950f7(0x104)&&(updateSetting(_0x5950f7(0x1cf),_0x5950f7(0x104)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x451d68[_0x5950f7(0xc0)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')['catch'](_0x4e000d=>{telegramError(_0x4e000d);}));if(!settings[_0x5950f7(0x131)])tgBot[_0x5950f7(0x216)](_0x451d68['chat']['id'],_0x5950f7(0xbd))[_0x5950f7(0xb2)](_0x44a527=>{telegramError(_0x44a527);});}),tgBot['removeListener']('callback_query');});}),tgBot['onText'](/\/status/,_0x2a0485=>{const _0x5b9c6c=_0x226652;if(!validateTelegram(_0x2a0485))return;const _0x52e188=getBotsWithMode();let _0x3a88e0=_0x5b9c6c(0xeb);config[_0x5b9c6c(0xed)](_0x2397ac=>{const _0x481261=_0x5b9c6c,_0x261499=_0x52e188[_0x481261(0xb6)](_0x82a1e3=>_0x82a1e3['botID']==_0x2397ac[_0x481261(0xe6)])[_0x481261(0x133)];_0x3a88e0+=_0x481261(0x14c)+_0x2397ac[_0x481261(0xe6)]+':\x20'+_0x2397ac[_0x481261(0x1d9)]+_0x481261(0x18c)+_0x261499+_0x481261(0x18c)+_0x2397ac[_0x481261(0x177)]+'\x0a';}),_0x3a88e0+='\x0a',_0x3a88e0+=_0x5b9c6c(0x1bf),_0x3a88e0+=!settings['telegramEnabled']?_0x5b9c6c(0x101):'Notifications\x20enabled\x0a',_0x3a88e0+=settings['telegramEnabled']?settings['telegramEvents']==_0x5b9c6c(0x104)?_0x5b9c6c(0x18a):_0x5b9c6c(0x189)+settings[_0x5b9c6c(0x1cf)]+_0x5b9c6c(0x1fe):'',tgBot['sendMessage'](_0x2a0485[_0x5b9c6c(0xc0)]['id'],_0x3a88e0,{'parse_mode':_0x5b9c6c(0x1b7)})[_0x5b9c6c(0xb2)](_0x514f10=>{telegramError(_0x514f10);});}),tgBot['onText'](/\/restart/,_0x45cf15=>{const _0xbce250=_0x226652;if(!validateTelegram(_0x45cf15))return;tgBot[_0xbce250(0x169)](_0xbce250(0x181));const _0x49636e=getEnabledBots();if(_0x49636e[_0xbce250(0xd7)]==0x0)tgBot[_0xbce250(0x216)](_0x45cf15[_0xbce250(0xc0)]['id'],_0xbce250(0x17f))[_0xbce250(0xb2)](_0x1d6064=>{telegramError(_0x1d6064);});else{if(_0x49636e[_0xbce250(0xd7)]>0x1)_0x49636e[_0xbce250(0x221)]({'botID':_0xbce250(0x104)});let _0x3046fe=[],_0x41b72b=[];const _0x51b93a=_0x49636e[_0xbce250(0xd7)]%0x4==0x0||_0x49636e[_0xbce250(0xd7)]%0x4==0x3||_0x49636e[_0xbce250(0xd7)]%0x3==0x1?0x4:0x3;let _0x35c4fe=0x0;_0x49636e[_0xbce250(0xed)]((_0x24376c,_0xfc9744)=>{const _0x38f574=_0xbce250;if(_0xfc9744%_0x51b93a==0x0)_0x41b72b=[];_0x41b72b['push']({'text':_0x24376c[_0x38f574(0xe6)]=='all'?'All\x20bots':_0x38f574(0x14c)+_0x24376c[_0x38f574(0xe6)],'callback_data':_0x24376c[_0x38f574(0xe6)]}),_0xfc9744%_0x51b93a==0x0&&(_0x3046fe[_0x35c4fe]=_0x41b72b,_0x35c4fe++);}),tgBot[_0xbce250(0x216)](_0x45cf15[_0xbce250(0xc0)]['id'],_0xbce250(0x200),{'reply_markup':{'inline_keyboard':_0x3046fe}})[_0xbce250(0xb2)](_0x47b669=>{telegramError(_0x47b669);}),tgBot['on'](_0xbce250(0x181),async _0x2088a3=>{const _0x2fa4a8=_0xbce250,_0x40325e=_0x2088a3[_0x2fa4a8(0x16c)],_0x38be23=_0x2088a3[_0x2fa4a8(0xd2)];tgBot[_0x2fa4a8(0x1b5)](_0x2088a3['id'])[_0x2fa4a8(0x182)](async()=>{const _0x373bd2=_0x2fa4a8;_0x40325e==_0x373bd2(0x104)?(tgBot[_0x373bd2(0x216)](_0x38be23['chat']['id'],_0x373bd2(0x142))[_0x373bd2(0xb2)](_0x437bf9=>{telegramError(_0x437bf9);}),config[_0x373bd2(0xed)](_0x3fb7ad=>{const _0x5685a1=_0x373bd2;restartBot(_0x3fb7ad[_0x5685a1(0xe6)]);})):(tgBot[_0x373bd2(0x216)](_0x38be23[_0x373bd2(0xc0)]['id'],_0x373bd2(0xc6)+_0x40325e)[_0x373bd2(0xb2)](_0x325547=>{telegramError(_0x325547);}),restartBot(_0x40325e));}),tgBot['removeListener'](_0x2fa4a8(0x181));});}}),tgBot[_0x226652(0x100)](/\/on/,_0x11cc82=>{const _0x11ca2f=_0x226652;if(!validateTelegram(_0x11cc82))return;tgBot[_0x11ca2f(0x169)](_0x11ca2f(0x181));const _0x5db7b8=getDisabledBots();if(_0x5db7b8[_0x11ca2f(0xd7)]==0x0)tgBot[_0x11ca2f(0x216)](_0x11cc82[_0x11ca2f(0xc0)]['id'],_0x11ca2f(0x1e6))[_0x11ca2f(0xb2)](_0x176272=>{telegramError(_0x176272);});else{if(_0x5db7b8[_0x11ca2f(0xd7)]>0x1)_0x5db7b8[_0x11ca2f(0x221)]({'botID':_0x11ca2f(0x104)});let _0x413519=[],_0x33ccb1=[];const _0x552de4=_0x5db7b8[_0x11ca2f(0xd7)]%0x4==0x0||_0x5db7b8[_0x11ca2f(0xd7)]%0x4==0x3||_0x5db7b8['length']%0x3==0x1?0x4:0x3;let _0x460aad=0x0;_0x5db7b8[_0x11ca2f(0xed)]((_0x509773,_0x2f5d03)=>{const _0x378331=_0x11ca2f;if(_0x2f5d03%_0x552de4==0x0)_0x33ccb1=[];_0x33ccb1[_0x378331(0x221)]({'text':_0x509773[_0x378331(0xe6)]==_0x378331(0x104)?_0x378331(0x159):_0x378331(0x14c)+_0x509773[_0x378331(0xe6)],'callback_data':_0x509773[_0x378331(0xe6)]}),_0x2f5d03%_0x552de4==0x0&&(_0x413519[_0x460aad]=_0x33ccb1,_0x460aad++);}),tgBot[_0x11ca2f(0x216)](_0x11cc82['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x413519}})[_0x11ca2f(0xb2)](_0x1d6163=>{telegramError(_0x1d6163);}),tgBot['on'](_0x11ca2f(0x181),async _0x1d3f89=>{const _0x25063a=_0x11ca2f,_0x56d707=_0x1d3f89[_0x25063a(0x16c)],_0x5383f9=_0x1d3f89['message'];tgBot[_0x25063a(0x1b5)](_0x1d3f89['id'])[_0x25063a(0x182)](async()=>{const _0x1c9ac6=_0x25063a;_0x56d707=='all'?(tgBot['sendMessage'](_0x5383f9['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x1c9ac6(0xb2)](_0x12a0a1=>{telegramError(_0x12a0a1);}),_0x5db7b8[_0x1c9ac6(0xed)](_0x106ce4=>{const _0x48f79a=_0x1c9ac6;if(_0x106ce4[_0x48f79a(0xe6)]!=_0x48f79a(0x104))toggleBot(_0x106ce4['botID'],toggleStatus(_0x106ce4['botID']),'stopped');})):(tgBot[_0x1c9ac6(0x216)](_0x5383f9[_0x1c9ac6(0xc0)]['id'],_0x1c9ac6(0x1ca)+_0x56d707)[_0x1c9ac6(0xb2)](_0x2aceea=>{telegramError(_0x2aceea);}),toggleBot(_0x56d707,toggleStatus(_0x56d707),_0x1c9ac6(0x1df)));}),tgBot[_0x25063a(0x169)]('callback_query');});}}),tgBot[_0x226652(0x100)](/\/off/,_0x4b83f7=>{const _0x82438b=_0x226652;if(!validateTelegram(_0x4b83f7))return;tgBot[_0x82438b(0x169)](_0x82438b(0x181));const _0x2f38dc=getEnabledBots();if(_0x2f38dc[_0x82438b(0xd7)]==0x0)tgBot[_0x82438b(0x216)](_0x4b83f7[_0x82438b(0xc0)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x17a281=>{telegramError(_0x17a281);});else{if(_0x2f38dc[_0x82438b(0xd7)]>0x1)_0x2f38dc['push']({'botID':_0x82438b(0x104)});let _0x5d96ba=[],_0xb05b4=[];const _0x47851a=_0x2f38dc[_0x82438b(0xd7)]%0x4==0x0||_0x2f38dc[_0x82438b(0xd7)]%0x4==0x3||_0x2f38dc['length']%0x3==0x1?0x4:0x3;let _0x50e59a=0x0;_0x2f38dc['forEach']((_0x45b5b1,_0x17d88f)=>{const _0x3b008c=_0x82438b;if(_0x17d88f%_0x47851a==0x0)_0xb05b4=[];_0xb05b4[_0x3b008c(0x221)]({'text':_0x45b5b1['botID']==_0x3b008c(0x104)?_0x3b008c(0x159):'Bot\x20'+_0x45b5b1[_0x3b008c(0xe6)],'callback_data':_0x45b5b1['botID']}),_0x17d88f%_0x47851a==0x0&&(_0x5d96ba[_0x50e59a]=_0xb05b4,_0x50e59a++);}),tgBot[_0x82438b(0x216)](_0x4b83f7[_0x82438b(0xc0)]['id'],_0x82438b(0x1f6),{'reply_markup':{'inline_keyboard':_0x5d96ba}})[_0x82438b(0xb2)](_0x5bd5f2=>{telegramError(_0x5bd5f2);}),tgBot['on'](_0x82438b(0x181),async _0x53b650=>{const _0x4d727d=_0x82438b,_0x395ad8=_0x53b650[_0x4d727d(0x16c)],_0x8d0dd4=_0x53b650['message'];tgBot[_0x4d727d(0x1b5)](_0x53b650['id'])['then'](async()=>{const _0x58697b=_0x4d727d;_0x395ad8==_0x58697b(0x104)?(tgBot[_0x58697b(0x216)](_0x8d0dd4[_0x58697b(0xc0)]['id'],_0x58697b(0x21b))[_0x58697b(0xb2)](_0x4bf411=>{telegramError(_0x4bf411);}),_0x2f38dc[_0x58697b(0xed)](_0x1999d6=>{const _0x36302f=_0x58697b;if(_0x1999d6[_0x36302f(0xe6)]!=_0x36302f(0x104))toggleBot(_0x1999d6[_0x36302f(0xe6)],toggleStatus(_0x1999d6[_0x36302f(0xe6)]),_0x36302f(0x1df));})):(tgBot[_0x58697b(0x216)](_0x8d0dd4['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x395ad8)[_0x58697b(0xb2)](_0x35a631=>{telegramError(_0x35a631);}),toggleBot(_0x395ad8,toggleStatus(_0x395ad8),_0x58697b(0x1df)));}),tgBot[_0x4d727d(0x169)](_0x4d727d(0x181));});}}),tgBot[_0x226652(0x100)](/\/portfolio/,_0x4bc3fd=>{const _0x443011=_0x226652;if(!validateTelegram(_0x4bc3fd))return;tgBot[_0x443011(0x169)](_0x443011(0x181));const _0x550f15=getEnabledBots();if(_0x550f15[_0x443011(0xd7)]==0x0)tgBot[_0x443011(0x216)](_0x4bc3fd[_0x443011(0xc0)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x443011(0xb2)](_0x5f4bd7=>{telegramError(_0x5f4bd7);});else{if(_0x550f15[_0x443011(0xd7)]>0x1){let _0x9ae5a4=[],_0x4f33f7=[];const _0x39f084=_0x550f15[_0x443011(0xd7)]%0x4==0x0||_0x550f15[_0x443011(0xd7)]%0x4==0x3||_0x550f15[_0x443011(0xd7)]%0x3==0x1?0x4:0x3;let _0x49dcd5=0x0;_0x550f15['forEach']((_0x1a1511,_0x3820b9)=>{const _0x301053=_0x443011;if(_0x3820b9%_0x39f084==0x0)_0x4f33f7=[];_0x4f33f7[_0x301053(0x221)]({'text':_0x301053(0x14c)+_0x1a1511[_0x301053(0xe6)],'callback_data':_0x1a1511['botID']}),_0x3820b9%_0x39f084==0x0&&(_0x9ae5a4[_0x49dcd5]=_0x4f33f7,_0x49dcd5++);}),tgBot[_0x443011(0x216)](_0x4bc3fd[_0x443011(0xc0)]['id'],_0x443011(0x11c),{'reply_markup':{'inline_keyboard':_0x9ae5a4}})[_0x443011(0xb2)](_0x3eab54=>{telegramError(_0x3eab54);}),tgBot['on'](_0x443011(0x181),async _0x25e922=>{const _0x29b88f=_0x443011,_0x1b4161=_0x25e922[_0x29b88f(0x16c)],_0x46a5be=_0x25e922['message'];tgBot[_0x29b88f(0x1b5)](_0x25e922['id'])[_0x29b88f(0x182)](async()=>{const _0x342cf6=_0x29b88f;if(pid[_0x1b4161])pid[_0x1b4161]['send']({'function':_0x342cf6(0x1de),'args':null});}),tgBot['removeListener'](_0x29b88f(0x181));});}else{const _0x23b10f=_0x550f15[0x0][_0x443011(0xe6)];if(pid[_0x23b10f])pid[_0x23b10f][_0x443011(0x1ae)]({'function':_0x443011(0x1de),'args':null});}}}),tgBot['onText'](/\/update/,async _0x185d6d=>{const _0x56dd1a=_0x226652;if(!validateTelegram(_0x185d6d))return;tgBot[_0x56dd1a(0x169)](_0x56dd1a(0x181)),await getMessages();if(!updateAvailable)tgBot[_0x56dd1a(0x216)](_0x185d6d[_0x56dd1a(0xc0)]['id'],_0x56dd1a(0x1a2))[_0x56dd1a(0xb2)](_0x378a15=>{telegramError(_0x378a15);});else!validInstallation?tgBot['sendMessage'](_0x185d6d[_0x56dd1a(0xc0)]['id'],_0x56dd1a(0x179))[_0x56dd1a(0xb2)](_0x39128e=>{telegramError(_0x39128e);}):(tgBot[_0x56dd1a(0x216)](_0x185d6d[_0x56dd1a(0xc0)]['id'],_0x56dd1a(0x18f),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x56dd1a(0xb2)](_0x554473=>{telegramError(_0x554473);}),tgBot['on'](_0x56dd1a(0x181),async _0x16110e=>{const _0x4e714c=_0x56dd1a,_0xfb92a7=_0x16110e[_0x4e714c(0x16c)],_0x1a91f8=_0x16110e[_0x4e714c(0xd2)];tgBot[_0x4e714c(0x1b5)](_0x16110e['id'])[_0x4e714c(0x182)](async()=>{const _0x174938=_0x4e714c;_0xfb92a7==_0x174938(0x1ff)&&(await tgBot[_0x174938(0x216)](_0x1a91f8[_0x174938(0xc0)]['id'],_0x174938(0xc4))['catch'](_0x3395dd=>{telegramError(_0x3395dd);}),updateBB());_0xfb92a7=='no'&&await tgBot[_0x174938(0x216)](_0x1a91f8[_0x174938(0xc0)]['id'],_0x174938(0x201))[_0x174938(0xb2)](_0x46759d=>{telegramError(_0x46759d);});if(!settings[_0x174938(0x131)])tgBot[_0x174938(0x216)](_0x1a91f8[_0x174938(0xc0)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')['catch'](_0x26d17a=>{telegramError(_0x26d17a);});}),tgBot[_0x4e714c(0x169)](_0x4e714c(0x181));}));}),tgBot['onText'](/\/toggle/,_0x1cbbd6=>{const _0x4cf25c=_0x226652;if(!validateTelegram(_0x1cbbd6))return;tgBot[_0x4cf25c(0x169)](_0x4cf25c(0x181));const _0x287f95=getBotsWithMode();if(_0x287f95[_0x4cf25c(0xd7)]==0x0)tgBot[_0x4cf25c(0x216)](_0x1cbbd6[_0x4cf25c(0xc0)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x4cf25c(0xb2)](_0x4cbbd8=>{telegramError(_0x4cbbd8);});else{let _0x539051=[],_0x4e6962=[];const _0x736a3e=0x2;let _0x1c1ac6=0x0;_0x287f95[_0x4cf25c(0xed)]((_0x32e46d,_0xdf5db4)=>{const _0x5d1eed=_0x4cf25c;if(_0xdf5db4%_0x736a3e==0x0)_0x4e6962=[];_0x4e6962[_0x5d1eed(0x221)]({'text':_0x5d1eed(0x14c)+_0x32e46d[_0x5d1eed(0xe6)]+'\x20('+_0x32e46d[_0x5d1eed(0x133)]+')','callback_data':_0x32e46d[_0x5d1eed(0xe6)]}),_0xdf5db4%_0x736a3e==0x0&&(_0x539051[_0x1c1ac6]=_0x4e6962,_0x1c1ac6++);}),tgBot[_0x4cf25c(0x216)](_0x1cbbd6[_0x4cf25c(0xc0)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0x539051}})[_0x4cf25c(0xb2)](_0x45c2c7=>{telegramError(_0x45c2c7);}),tgBot['on'](_0x4cf25c(0x181),async _0x4a32af=>{const _0x19fcf8=_0x4cf25c,_0xe9fd14=_0x4a32af[_0x19fcf8(0x16c)],_0x141a48=_0x4a32af[_0x19fcf8(0xd2)];tgBot['answerCallbackQuery'](_0x4a32af['id'])['then'](async()=>{const _0x58731c=_0x19fcf8,_0x1b3650=_0x287f95[_0x58731c(0xb6)](_0x3a03e2=>_0x3a03e2['botID']==_0xe9fd14),_0x213bb1=_0x1b3650[_0x58731c(0x133)]==_0x58731c(0xf6)?_0x58731c(0x1f1):'auto';tgBot[_0x58731c(0x216)](_0x141a48[_0x58731c(0xc0)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0xe9fd14+_0x58731c(0xbc)+_0x213bb1+_0x58731c(0x163))['catch'](_0x1371e7=>{telegramError(_0x1371e7);}),toggleBotMode(_0xe9fd14);}),tgBot['removeListener'](_0x19fcf8(0x181));});}}),tgBot[_0x226652(0x100)](/\/names/,_0xa5a62f=>{const _0x33a199=_0x226652;if(!validateTelegram(_0xa5a62f))return;let _0x31000a='';config['forEach'](_0x33ecaa=>{const _0x2a03e1=_0x5441;_0x31000a+=_0x2a03e1(0x14c)+_0x33ecaa[_0x2a03e1(0xe6)]+':\x20'+_0x33ecaa['botname']+'\x0a';}),tgBot[_0x33a199(0x216)](_0xa5a62f[_0x33a199(0xc0)]['id'],_0x31000a,{'parse_mode':_0x33a199(0x1b7)})[_0x33a199(0xb2)](_0x306dc7=>{telegramError(_0x306dc7);});}),tgBot['onText'](/\/disable/,_0x54c704=>{const _0x17fa30=_0x226652;if(!validateTelegram(_0x54c704))return;tgBot[_0x17fa30(0x216)](_0x54c704[_0x17fa30(0xc0)]['id'],_0x17fa30(0x1a1))['catch'](_0x3df71b=>{telegramError(_0x3df71b);}),updateSetting(_0x17fa30(0x202),![]);}),tgBot[_0x226652(0x100)](/\/help/,_0x82b132=>{const _0x285f84=_0x226652;if(!validateTelegram(_0x82b132))return;tgBot[_0x285f84(0x216)](_0x82b132[_0x285f84(0xc0)]['id'],_0x40de6f)[_0x285f84(0xb2)](_0x302d31=>{telegramError(_0x302d31);});}),tgBot['on']('polling_error',_0x431536=>{const _0x5e92fe=_0x226652;_0x431536[_0x5e92fe(0x160)]()[_0x5e92fe(0x1d3)](_0x5e92fe(0xe9))&&(logging('Invalid\x20Telegram\x20token'),tgBot[_0x5e92fe(0xcf)](),tgBot=null,io['to'](_0x5e92fe(0x1e9))[_0x5e92fe(0x152)](_0x5e92fe(0x21a),_0x5e92fe(0x215)));}),process['once'](_0x226652(0x1fb),()=>{const _0x58d6be=_0x226652;if(tgBot)tgBot[_0x58d6be(0xcf)]();process[_0x58d6be(0x1c5)](0x1);}),process[_0x226652(0x1d5)]('SIGTERM',()=>{const _0x25a90a=_0x226652;if(tgBot)tgBot['stopPolling']();process[_0x25a90a(0x1c5)](0x1);});}}function disableTelegram(){const _0x23cc7e=_0x50ea8b;tgBot&&(tgBot[_0x23cc7e(0xcf)](),tgBot=null);}function sendTelegram(_0x44ebe6,_0x343988){const _0x2ec70f=_0x50ea8b;if(settings['telegramEnabled']){if(settings['telegramEvents']==_0x2ec70f(0x104)||(_0x343988[_0x2ec70f(0x204)]==_0x2ec70f(0xcd)||_0x343988[_0x2ec70f(0x204)]==_0x2ec70f(0x132))&&settings[_0x2ec70f(0x1cf)]==_0x2ec70f(0x186)||_0x343988[_0x2ec70f(0x204)]==_0x2ec70f(0x18e)&&settings[_0x2ec70f(0x1cf)]==_0x2ec70f(0x11f)){if(tgBot&&settings[_0x2ec70f(0x131)]){if(_0x343988[_0x2ec70f(0x1a0)])tgBot[_0x2ec70f(0x216)](settings['telegramChatId'],_0x343988[_0x2ec70f(0x1c8)]+'\x20>\x20'+_0x343988['event'])[_0x2ec70f(0xb2)](_0x2f4082=>{telegramError(_0x2f4082);});else tgBot[_0x2ec70f(0x216)](settings[_0x2ec70f(0x131)],_0x2ec70f(0x14c)+_0x44ebe6+'\x20>\x20'+_0x343988['event'])[_0x2ec70f(0xb2)](_0x17eb43=>{telegramError(_0x17eb43);});}}}}async function sendTelegramMsg(_0xa0674f,_0x5b925a=_0x50ea8b(0x1b7)){const _0x194301=_0x50ea8b;return settings[_0x194301(0x202)]&&tgBot&&settings[_0x194301(0x131)]?(await tgBot[_0x194301(0x216)](settings[_0x194301(0x131)],_0xa0674f,{'parse_mode':_0x5b925a})[_0x194301(0xb2)](_0x2d76e9=>{telegramError(_0x2d76e9);}),!![]):![];}function getDeviceWithIp(_0x788783){const _0x783364=_0x50ea8b;return devices[_0x783364(0xb6)](_0x34d32e=>_0x34d32e['ip']===_0x788783);}function _0x5441(_0x308af5,_0x2c7c03){const _0x25fec2=_0x3481();return _0x5441=function(_0x19a212,_0x454b1b){_0x19a212=_0x19a212-0xb1;let _0x348147=_0x25fec2[_0x19a212];return _0x348147;},_0x5441(_0x308af5,_0x2c7c03);}function temporaryAccess2FA(_0x4945fa,_0x40d9a8){const _0x27aa07=_0x50ea8b;let _0xb8c2a7=new Date(),_0x1ac385=![];if(lastIpApproval){if(_0xb8c2a7-lastIpApproval<0x1388)_0x1ac385=!![];}lastIpApproval=new Date();if(_0x1ac385)return;tgBot&&settings[_0x27aa07(0x131)]&&(tgBot[_0x27aa07(0x169)]('callback_query'),tgBot[_0x27aa07(0x216)](settings[_0x27aa07(0x131)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x40d9a8)[_0x27aa07(0x107)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x27aa07(0x184),'callback_data':'15'},{'text':_0x27aa07(0x1d2),'callback_data':'30'},{'text':_0x27aa07(0x213),'callback_data':_0x27aa07(0x213)}]]}})[_0x27aa07(0xb2)](_0x537cc8=>{telegramError(_0x537cc8);}),tgBot['on']('callback_query',async _0x41d701=>{const _0x195c51=_0x27aa07,_0x5607bd=_0x41d701['data'],_0x58cb9e=_0x41d701[_0x195c51(0xd2)];tgBot[_0x195c51(0x1b5)](_0x41d701['id'])[_0x195c51(0x182)](async()=>{const _0x17a589=_0x195c51;devices[_0x4945fa][_0x17a589(0x1ee)]={'clientip':_0x40d9a8,'timestamp':new Date()['getTime'](),'expiry':_0x5607bd},_0x5607bd!='reject'?(await tgBot[_0x17a589(0x216)](_0x58cb9e[_0x17a589(0xc0)]['id'],'Access\x20enabled\x20for\x20'+_0x5607bd+_0x17a589(0xb3),{'parse_mode':_0x17a589(0x1b7)})['catch'](_0x48f050=>{telegramError(_0x48f050);}),io['to'](_0x4945fa)['emit'](_0x17a589(0x1d9),{'access':{'allow':![],'reason':_0x17a589(0x1b4),'token':null}})):(await tgBot[_0x17a589(0x216)](_0x58cb9e[_0x17a589(0xc0)]['id'],_0x17a589(0x155))[_0x17a589(0xb2)](_0x2a9048=>{telegramError(_0x2a9048);}),io['to'](_0x4945fa)[_0x17a589(0x152)]('status',{'access':{'allow':![],'reason':_0x17a589(0x1ed),'token':null}}));}),tgBot[_0x195c51(0x169)](_0x195c51(0x181));}));}function loginAccess2FA(_0x3bf572,_0x57932e){const _0x356edf=_0x50ea8b;tgBot&&settings['telegramChatId']&&(tgBot[_0x356edf(0x169)](_0x356edf(0x181)),tgBot['sendMessage'](settings[_0x356edf(0x131)],_0x356edf(0x161)+normalizeIP(_0x57932e)['show']+_0x356edf(0x113),{'parse_mode':_0x356edf(0x1b7),'reply_markup':{'inline_keyboard':[[{'text':_0x356edf(0x214),'callback_data':loginExpiry},{'text':_0x356edf(0x213),'callback_data':_0x356edf(0x213)}]]}})[_0x356edf(0xb2)](_0x14a9de=>{telegramError(_0x14a9de);}),tgBot['on'](_0x356edf(0x181),async _0x3b44ce=>{const _0x379ac1=_0x356edf,_0xca23e5=_0x3b44ce[_0x379ac1(0x16c)],_0xa1e145=_0x3b44ce[_0x379ac1(0xd2)];tgBot[_0x379ac1(0x1b5)](_0x3b44ce['id'])[_0x379ac1(0x182)](async()=>{const _0x35134=_0x379ac1;devices[_0x3bf572][_0x35134(0x112)]={'clientip':_0x57932e,'timestamp':new Date()[_0x35134(0x170)](),'expiry':_0xca23e5},_0xca23e5!='reject'?(await tgBot['sendMessage'](_0xa1e145['chat']['id'],'Login\x20accepted',{'parse_mode':'HTML'})['catch'](_0x41a7b4=>{telegramError(_0x41a7b4);}),io['to'](_0x3bf572)[_0x35134(0x152)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x35134(0x216)](_0xa1e145[_0x35134(0xc0)]['id'],_0x35134(0x1b2))[_0x35134(0xb2)](_0x137318=>{telegramError(_0x137318);}),io['to'](_0x3bf572)[_0x35134(0x152)](_0x35134(0x1d9),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot['removeListener'](_0x379ac1(0x181));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x14b554=_0x50ea8b;return dbConfig['get'](_0x14b554(0x13a))[_0x14b554(0x171)](_0x14b554(0xe6))[_0x14b554(0x227)]({'status':_0x14b554(0x11b)})[_0x14b554(0xe1)]()||[];}function getDisabledBots(){const _0x40c64f=_0x50ea8b;return dbConfig['get'](_0x40c64f(0x13a))['sortBy']('botID')[_0x40c64f(0x227)]({'status':_0x40c64f(0x11a)})['value']()||[];}function getBotsWithMode(){const _0x28fc55=_0x50ea8b,_0x3ff210=dbConfig[_0x28fc55(0x20b)](_0x28fc55(0x13a))[_0x28fc55(0x171)](_0x28fc55(0xe6))[_0x28fc55(0xe1)]()||[];return _0x3ff210[_0x28fc55(0xed)](_0x4a7b74=>{const _0x36a103=_0x28fc55,_0x4c4667=configpath+_0x36a103(0x1cd)+_0x4a7b74[_0x36a103(0xe6)]+_0x36a103(0xf4),_0x1c39e3=fs[_0x36a103(0x123)](_0x4c4667);if(_0x1c39e3){const _0x5807b5=fs[_0x36a103(0x197)](_0x4c4667);try{const _0x1881bd=JSON[_0x36a103(0x149)](_0x5807b5),_0x26f651=_0x1881bd?_0x1881bd[_0x36a103(0x194)][0x0][_0x36a103(0xff)]:![];_0x4a7b74[_0x36a103(0x133)]=_0x26f651?'auto':_0x36a103(0x1f1);}catch(_0x165f49){_0x4a7b74['mode']=_0x36a103(0x1f1);}}else _0x4a7b74['mode']=_0x36a103(0x1f1);}),_0x3ff210;}async function initUser(){const _0x47cf49=_0x50ea8b;if(!settings[_0x47cf49(0x168)]){const _0x18727e=uuidRandom();mixpanel[_0x47cf49(0x108)](_0x18727e),updateSetting(_0x47cf49(0x168),_0x18727e);}}async function initSecure(){const _0xdcccd3=_0x50ea8b;let _0x44cce8=getSecure();if(!_0x44cce8['hasOwnProperty']('secret')){let _0x416560=await generateKeys();_0x44cce8[_0xdcccd3(0x1ec)]=_0x416560[_0xdcccd3(0x1ec)],_0x44cce8[_0xdcccd3(0x116)]=_0x416560[_0xdcccd3(0x116)],_0x44cce8[_0xdcccd3(0x217)]=crypto[_0xdcccd3(0x223)](0x20)[_0xdcccd3(0x160)]('hex');;storeSecure(_0x44cce8);}}function getSettings(){const _0x1a441e=_0x50ea8b;return dbSettings[_0x1a441e(0x20b)](_0x1a441e(0x222))[_0x1a441e(0xe1)]()||{};}function getSecure(){const _0x107f7f=_0x50ea8b;return dbSecure[_0x107f7f(0x20b)](_0x107f7f(0x212))[_0x107f7f(0xe1)]()||{};}function getBlacklist(){const _0x3df06a=_0x50ea8b;return dbSecure[_0x3df06a(0x20b)]('blacklist')[_0x3df06a(0xe1)]()||[];}function broadcastToBots(_0x381830,_0x2be050){const _0xf2faba=_0x50ea8b;config[_0xf2faba(0xed)](_0x125f61=>{const _0x2a80b6=_0xf2faba;if(_0x125f61[_0x2a80b6(0x1d9)]==_0x2a80b6(0x11b)&&_0x125f61[_0x2a80b6(0x177)]==_0x2a80b6(0x11d)){if(pid[_0x125f61[_0x2a80b6(0xe6)]])pid[_0x125f61[_0x2a80b6(0xe6)]]['send']({[_0x381830]:_0x2be050});}});}function storeSettings(_0x5df7dc,_0x590ecf=![]){const _0x230ab5=_0x50ea8b;_0x5df7dc={...settings,..._0x5df7dc};if(_0x590ecf&&_0x5df7dc['bbPassword']!=_0x230ab5(0x16e)&&_0x5df7dc['bbPassword']!=''){const _0x5e8d88=crypt[_0x230ab5(0x106)](secure['privateKey'],_0x5df7dc['bbPassword'])[_0x230ab5(0xd2)]['split']('@')[0x0],_0x191f51=bcrypt[_0x230ab5(0x154)](_0x5e8d88,saltRounds);_0x5df7dc={..._0x5df7dc,'bbPassword':_0x191f51};}if(_0x590ecf&&_0x5df7dc[_0x230ab5(0x19b)]!='************'&&_0x5df7dc['telegramToken']!=''){const _0x4039c8=crypt[_0x230ab5(0x106)](secure[_0x230ab5(0x116)],_0x5df7dc[_0x230ab5(0x19b)])[_0x230ab5(0xd2)][_0x230ab5(0x117)]('@')[0x0];_0x5df7dc={..._0x5df7dc,'telegramToken':_0x4039c8};}const _0x3290bf=_0x5df7dc['telegramToken']!=_0x230ab5(0x16e)&&_0x5df7dc[_0x230ab5(0x19b)]!=settings[_0x230ab5(0x19b)]||_0x5df7dc[_0x230ab5(0x109)]!=settings[_0x230ab5(0x109)],_0x5e1346=_0x5df7dc['telegramToken']==''||_0x5df7dc[_0x230ab5(0x109)]=='';if(_0x3290bf)_0x5df7dc['telegramEvents']=_0x230ab5(0x104);for(const [_0x264e79,_0x55ab29]of Object[_0x230ab5(0x1d4)](_0x5df7dc)){if(_0x264e79==_0x230ab5(0x19b)&&_0x55ab29=='************'){_0x5df7dc[_0x230ab5(0x19b)]=settings[_0x230ab5(0x19b)];continue;};if(_0x264e79==_0x230ab5(0x11e)&&_0x55ab29==_0x230ab5(0x16e)){_0x5df7dc[_0x230ab5(0x11e)]=settings[_0x230ab5(0x11e)];continue;};dbSettings[_0x230ab5(0xd9)](_0x230ab5(0xc3)+_0x264e79,_0x55ab29)['write']();}settings=_0x5df7dc,io['to'](_0x230ab5(0x1e9))[_0x230ab5(0x152)](_0x230ab5(0x222),cleanSettings()),broadcastToBots(_0x230ab5(0xd4),settings[_0x230ab5(0xd4)]);if(_0x3290bf&&!_0x5e1346)initTelegram();if(_0x3290bf&&_0x5e1346)disableTelegram();getAllClients()[_0x230ab5(0xed)](_0x1b4e63=>{const _0x1ec8d3=_0x230ab5;getSocket(_0x1b4e63['id'])['emit'](_0x1ec8d3(0x1d9),{'access':{'allow':![],'reason':_0x1ec8d3(0x1b4),'token':null}});});}function updateSetting(_0xcab84d,_0x4b5620){const _0x43d34b=_0x50ea8b;dbSettings[_0x43d34b(0xd9)]('settings.'+_0xcab84d,_0x4b5620)['write'](),settings=getSettings(),io['to']('botmanager')[_0x43d34b(0x152)](_0x43d34b(0x222),cleanSettings());}function storeSecure(_0x1cebc1){const _0x2d7709=_0x50ea8b;dbSecure['get'](_0x2d7709(0x212))[_0x2d7709(0x221)](_0x1cebc1)[_0x2d7709(0xf7)](),secure=_0x1cebc1;}function addBlacklist(_0x20a8f3){const _0x12cac1=_0x50ea8b;cleanBlacklist();let _0x33e4e8;devices[_0x20a8f3][_0x12cac1(0x1ee)]?_0x33e4e8=Math[_0x12cac1(0x199)](devices[_0x20a8f3][_0x12cac1(0x1ee)][_0x12cac1(0x185)],loginExpiry):_0x33e4e8=loginExpiry,dbSecure[_0x12cac1(0x20b)]('blacklist')[_0x12cac1(0x221)]({'expiry':new Date()[_0x12cac1(0x170)]()+_0x33e4e8*0x3c*0x3e8,'token':devices[_0x20a8f3][_0x12cac1(0x147)][_0x12cac1(0x1b0)]})[_0x12cac1(0xf7)](),blacklist=dbSecure[_0x12cac1(0x20b)](_0x12cac1(0x1f8))[_0x12cac1(0xe1)]();}function cleanBlacklist(){const _0x133acd=_0x50ea8b;let _0x58e89d=dbSecure[_0x133acd(0x20b)](_0x133acd(0x1f8))[_0x133acd(0xf3)]()[_0x133acd(0xe1)](),_0x351cfa=new Date()['getTime']();_0x58e89d[_0x133acd(0xed)](_0x1e10e4=>{const _0x1b82c1=_0x133acd;_0x1e10e4[_0x1b82c1(0x185)]<_0x351cfa&&dbSecure[_0x1b82c1(0x20b)]('blacklist')['remove']({'expiry':_0x1e10e4['expiry']})[_0x1b82c1(0xf7)]();});}function initStates(){let _0x5b590b=getConfiguration();_0x5b590b['forEach'](_0x481238=>{const _0x5c18cc=_0x5441;_0x481238['live']=_0x5c18cc(0x1df);}),storeConfiguration(_0x5b590b);}function onKeys(){const _0xf96337=new RSA();return new Promise(_0x5809ec=>{const _0x1ce6a3=_0x5441;_0xf96337[_0x1ce6a3(0x156)]()[_0x1ce6a3(0x182)](_0x5f0b9a=>{_0x5809ec(_0x5f0b9a);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1591fb=_0x50ea8b;let _0x350b15=getSettings(),_0x4ab332=![];!_0x350b15[_0x1591fb(0xd0)](_0x1591fb(0x16a))&&(_0x350b15[_0x1591fb(0x16a)]=0x0,_0x4ab332=!![]);!_0x350b15[_0x1591fb(0xd0)](_0x1591fb(0x15c))&&(_0x350b15[_0x1591fb(0x15c)]=0x0,_0x4ab332=!![]);!_0x350b15[_0x1591fb(0xd0)]('latestversion')&&(_0x350b15['latestversion']='0.0.0',_0x4ab332=!![]);if(_0x4ab332)storeSettings(_0x350b15);}function storeConfiguration(_0x45b921){const _0x429771=_0x50ea8b;dbConfig[_0x429771(0x20b)](_0x429771(0x13a))[_0x429771(0x188)]()[_0x429771(0xf7)](),_0x45b921[_0x429771(0xed)](_0x56a3a6=>{const _0x5ae835=_0x429771;delete _0x56a3a6[_0x5ae835(0x133)];}),dbConfig[_0x429771(0x20b)](_0x429771(0x13a))[_0x429771(0x221)](..._0x45b921)[_0x429771(0xf7)](),config=_0x45b921;}function resetPassword(){const _0x3d8f5b=_0x50ea8b;tgBot&&settings['telegramChatId']&&(tgBot['removeListener'](_0x3d8f5b(0x181)),tgBot['sendMessage'](settings['telegramChatId'],_0x3d8f5b(0x1e2),{'parse_mode':_0x3d8f5b(0x1b7),'reply_markup':{'inline_keyboard':[[{'text':_0x3d8f5b(0x1ff),'callback_data':_0x3d8f5b(0x1ff)},{'text':'no','callback_data':'no'}]]}})[_0x3d8f5b(0xb2)](_0x2991aa=>{telegramError(_0x2991aa);}),tgBot['on'](_0x3d8f5b(0x181),async _0x523ecf=>{const _0x3ac51b=_0x3d8f5b,_0x1b87d4=_0x523ecf['data'],_0x18cf2c=_0x523ecf[_0x3ac51b(0xd2)];tgBot[_0x3ac51b(0x1b5)](_0x523ecf['id'])[_0x3ac51b(0x182)](async()=>{const _0x30279a=_0x3ac51b;if(_0x1b87d4!='no'){const _0x4db4c2=0xf,_0xfd1dc7=_0x30279a(0x10d),_0x564061=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x4db4c2)))[_0x30279a(0x13f)](_0x551dc7=>_0xfd1dc7[_0x551dc7%_0xfd1dc7[_0x30279a(0xd7)]])['join'](''),_0x2a41ec=bcrypt['hashSync'](_0x564061,saltRounds);storeSettings({'bbPassword':_0x2a41ec}),await tgBot['sendMessage'](_0x18cf2c[_0x30279a(0xc0)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x564061,{'parse_mode':_0x30279a(0x1b7)})[_0x30279a(0xb2)](_0x4b9660=>{telegramError(_0x4b9660);});}else await tgBot[_0x30279a(0x216)](_0x18cf2c[_0x30279a(0xc0)]['id'],_0x30279a(0xe0))[_0x30279a(0xb2)](_0x50a018=>{telegramError(_0x50a018);});}),tgBot[_0x3ac51b(0x169)]('callback_query');}));}function logging(_0x34d4e8){const _0x1f4206=_0x50ea8b;console[_0x1f4206(0xb8)](getTimeStamp()+_0x1f4206(0x14f)+_0x34d4e8);if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x1f4206(0x11f))tgBot[_0x1f4206(0x216)](settings[_0x1f4206(0x131)],_0x1f4206(0x19f)+_0x34d4e8)['catch'](_0x5e3821=>{telegramError(_0x5e3821);});}function getServerTime(){const _0x300e18=_0x50ea8b,_0x1ff160=new Date();return _0x1ff160[_0x300e18(0x1cc)]()+'/'+(_0x1ff160[_0x300e18(0x1b3)]()+0x1)[_0x300e18(0x160)]()[_0x300e18(0xb7)](0x2,'0')+'/'+_0x1ff160[_0x300e18(0x16f)]()[_0x300e18(0x160)]()[_0x300e18(0xb7)](0x2,'0')+'\x20'+_0x1ff160[_0x300e18(0xef)]()[_0x300e18(0x160)]()['padStart'](0x2,'0')+':'+_0x1ff160[_0x300e18(0x1f0)]()[_0x300e18(0x160)]()[_0x300e18(0xb7)](0x2,'0')+':'+_0x1ff160['getSeconds']()[_0x300e18(0x160)]()[_0x300e18(0xb7)](0x2,'0');}function getTimeStamp(){const _0x34ce70=_0x50ea8b,_0x57749f=shiftedTime();return _0x57749f['getFullYear']()+'/'+(_0x57749f[_0x34ce70(0x1b3)]()+0x1)[_0x34ce70(0x160)]()[_0x34ce70(0xb7)](0x2,'0')+'/'+_0x57749f[_0x34ce70(0x16f)]()[_0x34ce70(0x160)]()[_0x34ce70(0xb7)](0x2,'0')+'\x20'+_0x57749f[_0x34ce70(0xef)]()[_0x34ce70(0x160)]()[_0x34ce70(0xb7)](0x2,'0')+':'+_0x57749f[_0x34ce70(0x1f0)]()[_0x34ce70(0x160)]()['padStart'](0x2,'0')+':'+_0x57749f[_0x34ce70(0x10c)]()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0x20bee6=_0x50ea8b,_0x5d8f9c=new Date();let _0x3c9e4d=_0x5d8f9c;if(settings[_0x20bee6(0xd4)]&&settings[_0x20bee6(0xd4)]!==0x0)_0x3c9e4d=fns[_0x20bee6(0x167)](_0x5d8f9c,{'hours':settings['timeshift']});return _0x3c9e4d;}function startScheduler(){const _0x39d2b4=_0x50ea8b;let _0x3daf2c=new Date()[_0x39d2b4(0x1e3)]();_0x3daf2c==0x1&&backupConfigFiles();_0x3daf2c==0x9&&triggerAnalytics();_0x3daf2c%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x13ec45=_0x50ea8b;fs[_0x13ec45(0xc5)](configpath,{'withFileTypes':!![]})['forEach'](_0x3ff3cf=>{const _0x42e8be=_0x13ec45;if(!_0x3ff3cf[_0x42e8be(0x172)]())fs[_0x42e8be(0x1a4)](configpath+_0x3ff3cf[_0x42e8be(0x1c9)],configbackuppath+_0x3ff3cf[_0x42e8be(0x1c9)]);});}async function getPublicIp(){const _0x5e78d4=_0x50ea8b;try{const _0x527cb1=await axios[_0x5e78d4(0x20b)](_0x5e78d4(0x1f5));publicip=_0x527cb1['data']['ip'];}catch(_0x5b91d7){}}async function triggerAnalytics(_0x3a8e97=![]){const _0x5ef513=_0x50ea8b;if(!publicip)await getPublicIp();const _0x28610a=getBotsWithMode();let _0x3971aa=0x0;_0x28610a['forEach'](_0x3e3d7f=>{const _0x5785fd=_0x5441;if(_0x3e3d7f[_0x5785fd(0x1d9)]===_0x5785fd(0x11b))_0x3971aa++;}),mixpanel[_0x5ef513(0xba)](_0x5ef513(0x1b9),{'distinct_id':settings[_0x5ef513(0x168)],'ip':publicip,'version':serverversion,'numbots':_0x28610a[_0x5ef513(0xd7)],'numbotsenabled':_0x3971aa}),!_0x3a8e97&&analytics[_0x5ef513(0x130)]({'title':_0x5ef513(0x1ac),'href':_0x5ef513(0x1fd),'path':'/v'+serverversion});}async function getMessages(){const _0xce636a=_0x50ea8b,_0x7e5fcb='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0xe6decd=new GraphQLClient(_0x7e5fcb),_0x36731d={'authorization':_0xce636a(0x1a3)},_0x477f09=serverversion[_0xce636a(0x117)]('.'),_0x40b2e1=_0x477f09[0x0]+'.'+_0x477f09[0x1],_0x32a638=Math[_0xce636a(0xb1)](settings['lastmsgtelegram'],settings[_0xce636a(0x15c)]),_0x3c19b3={'last':parseInt(_0x32a638),'bbm':_0x40b2e1},_0x438f06=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4176e3;try{_0x4176e3=await _0xe6decd['request'](_0x438f06,_0x3c19b3,_0x36731d);}catch(_0x568e63){}if(_0x4176e3&&_0x4176e3[_0xce636a(0x1e4)]){let _0x4cf0ed=settings[_0xce636a(0x16a)];newMessages=[];for(const _0x48ef1f of _0x4176e3[_0xce636a(0x1e4)]){newMessages['push'](_0x48ef1f);if(_0x48ef1f[_0xce636a(0x114)])updateSetting('latestversion',_0x48ef1f[_0xce636a(0x114)]);let _0x4b9b82=_0x48ef1f['bbvNew']?serverversion>=_0x48ef1f[_0xce636a(0x114)]:![];if(!_0x4b9b82&&_0x48ef1f[_0xce636a(0x15a)]>_0x4cf0ed){if(_0x48ef1f[_0xce636a(0x146)]===_0xce636a(0x102)||serverversion[_0xce636a(0x1cb)](_0x48ef1f['bbvReceive'])){let _0x5e2a37=''+_0x48ef1f[_0xce636a(0x129)]+'\x0a\x0a'+_0x48ef1f[_0xce636a(0xd2)];const _0x32d0fa=await sendTelegramMsg(toTelegramMarkdown(_0x5e2a37),_0xce636a(0x1ef));if(_0x32d0fa)_0x4cf0ed=_0x48ef1f[_0xce636a(0x15a)];}}}updateAvailable=isNewerVersion(settings[_0xce636a(0x145)],serverversion),updateSetting(_0xce636a(0x16a),_0x4cf0ed),emitMessages();}}function emitMessages(){const _0x53f343=_0x50ea8b,_0xd1bd72=settings[_0x53f343(0x15c)];let _0x422ded=[];newMessages[_0x53f343(0xed)](_0x2dd9e1=>{const _0x3d7f1f=_0x53f343;_0x2dd9e1[_0x3d7f1f(0x15a)]>_0xd1bd72&&_0x422ded[_0x3d7f1f(0x221)](_0x2dd9e1);}),_0x422ded[_0x53f343(0xd7)]>0x0&&getAllClients()[_0x53f343(0xed)](_0x339f70=>{const _0x5d0c30=_0x53f343;getSocket(_0x339f70['id'])[_0x5d0c30(0x152)](_0x5d0c30(0xd2),_0x422ded);});}function confirmMessage(_0xf63a44){updateSetting('lastmsgemitted',Number(_0xf63a44));}function isNewerVersion(_0x3536b6,_0x315bf9){const _0x20845d=_0x50ea8b,_0x59b20e=_0x315bf9[_0x20845d(0x117)]('.'),_0x38d8d0=_0x3536b6[_0x20845d(0x117)]('.');for(var _0x57258c=0x0;_0x57258c<_0x38d8d0[_0x20845d(0xd7)];_0x57258c++){const _0x3c6375=~~_0x38d8d0[_0x57258c],_0x4e5856=~~_0x59b20e[_0x57258c];if(_0x3c6375>_0x4e5856)return!![];if(_0x3c6375<_0x4e5856)return![];}return![];}function toTelegramMarkdown(_0x175a85){const _0x479b63=_0x50ea8b,_0x34889a=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x352bcf=/\*{2}(.+?)\*{2}/gim;return _0x175a85=_0x175a85[_0x479b63(0x10f)](_0x34889a,'$1_$2_$3')['replace'](_0x352bcf,_0x479b63(0xe8)),_0x175a85;}function validateCredentials(_0xf3cc76,_0xd848db){const _0x1bf6e9=_0x50ea8b;if(_0xf3cc76['username']==settings[_0x1bf6e9(0x162)]&&bcrypt[_0x1bf6e9(0x20e)](_0xf3cc76[_0x1bf6e9(0x1b8)],settings[_0x1bf6e9(0x11e)])){if(settings[_0x1bf6e9(0x1a7)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x2699a1=generateLoginToken(_0xd848db);return{'allow':!![],'reason':_0x1bf6e9(0x1c6),'token':_0x2699a1};}}else return{'allow':![],'reason':_0x1bf6e9(0x190),'token':null};}function refreshToken(_0x3d85f0){const _0x3902ac=generateLoginToken(_0x3d85f0);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x3902ac};}function validateAccess(_0x247289,_0x279a4b){const _0x4c0c6e=_0x50ea8b;let _0x5d132e=devices[_0x279a4b]['ip'],_0x3023ef;const _0x28e7fc=_0x5eb8b8=>{const _0x11c5a6=_0x5441;if(settings['loginRequired']){if(settings[_0x11c5a6(0x1a7)]){if(telegram2FaApproved(_0x279a4b)){const _0x582520=generateLoginToken(_0x279a4b);return{'allow':!![],'reason':_0x11c5a6(0x1dd),'token':_0x582520};}else return{'allow':![],'reason':_0x11c5a6(0xbe),'token':null};}else return _0x3023ef=validToken(_0x5eb8b8,_0x279a4b),_0x3023ef['hasOwnProperty'](_0x11c5a6(0x132))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x5eb8b8}:{'allow':![],'reason':_0x11c5a6(0xbe),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x4c0c6e(0x192)]){let _0x56038d=[...settings[_0x4c0c6e(0x1a9)],_0x4c0c6e(0x1dc),_0x4c0c6e(0xfa),_0x4c0c6e(0x218)];if(_0x56038d[_0x4c0c6e(0x1d3)](_0x5d132e))return _0x28e7fc(_0x247289);else{_0x3023ef=validToken(_0x247289,_0x279a4b);if(_0x3023ef[_0x4c0c6e(0xd0)]('success'))return _0x28e7fc(_0x247289);else{if(telegramIpApproved(_0x279a4b)){const _0x39b108=generateToken(_0x279a4b);return _0x3023ef=_0x28e7fc(_0x247289),_0x3023ef['allow']?{'allow':!![],'reason':_0x4c0c6e(0x203),'token':_0x39b108}:_0x3023ef;}else return settings[_0x4c0c6e(0x110)]?{'allow':![],'reason':_0x4c0c6e(0x1e5),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x28e7fc(_0x247289);}function timelyDecrypt(_0x432603,_0x1fe15d=!![]){const _0x34f559=_0x50ea8b;if(_0x432603)try{const _0xc451f3=crypt['decrypt'](secure[_0x34f559(0x116)],_0x432603)[_0x34f559(0xd2)],_0x505c7f=_0xc451f3['split']('@')[0x0],_0x113460=_0xc451f3[_0x34f559(0x117)]('@')[0x1],_0x2be8d1=new Date()[_0x34f559(0x170)]();if(_0x1fe15d){if(_0x2be8d1-_0x113460<maxSecretAge*0x3e8)return _0x505c7f;else return![];}else return _0x505c7f;}catch(_0xe8eb43){return![];}else return![];}const validToken=(_0x4657ca,_0x2f29a9)=>{const _0x214edd=_0x50ea8b,_0x3d3367=devices[_0x2f29a9]['ip'];if(!_0x4657ca)return{'error':_0x214edd(0x144)};for(let _0x42c923 of blacklist){if(_0x42c923['token']==_0x4657ca)return{'error':_0x214edd(0x1e7)};}let _0x540ad9;try{_0x540ad9=jwt[_0x214edd(0x13d)](_0x4657ca,secure['secret']+_0x2f29a9);}catch{return{'error':_0x214edd(0x176)};}if(!_0x540ad9[_0x214edd(0xd0)](_0x214edd(0x226))&&!_0x540ad9[_0x214edd(0xd0)](_0x214edd(0xe7))||!_0x540ad9['hasOwnProperty'](_0x214edd(0x20c)))return{'error':_0x214edd(0xf9)};if(!_0x540ad9[_0x214edd(0xd0)]('username')&&_0x540ad9['hasOwnProperty'](_0x214edd(0x226))){const {clientip:_0x231285}=_0x540ad9;return _0x3d3367==_0x231285?{'success':_0x214edd(0x210)}:{'error':_0x214edd(0x16b)};}else{if(_0x540ad9['hasOwnProperty']('username')&&_0x540ad9[_0x214edd(0xd0)]('clientip')){const {username:_0x4477b1,clientip:_0x50451d}=_0x540ad9;return settings['bbUsername']==_0x4477b1&&_0x3d3367==_0x50451d?{'success':_0x214edd(0x210)}:{'error':_0x214edd(0xee)};}}},generateLoginToken=_0x40cfd3=>{const _0x52f2b0=_0x50ea8b;if(_0x40cfd3){const _0x1da10a=devices[_0x40cfd3]['ip'];return jwt[_0x52f2b0(0x18b)]({'username':settings[_0x52f2b0(0x162)],'clientip':_0x1da10a},secure[_0x52f2b0(0x217)]+_0x40cfd3,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x48a184=>{const _0x102ca8=_0x50ea8b;if(_0x48a184){const _0x98edc=devices[_0x48a184]['ip'];return jwt[_0x102ca8(0x18b)]({'clientip':_0x98edc},secure['secret']+_0x48a184,{'expiresIn':devices[_0x48a184][_0x102ca8(0x1ee)][_0x102ca8(0x185)]*0x3c});}else return![];},telegramIpApproved=_0x2c767d=>{const _0x2e3d17=_0x50ea8b;let _0x9b4e8b=![];return devices[_0x2c767d][_0x2e3d17(0x1ee)]&&devices[_0x2c767d]['telegramIpApproval']['expiry']!=_0x2e3d17(0x213)&&(_0x9b4e8b=devices[_0x2c767d][_0x2e3d17(0x1ee)][_0x2e3d17(0x226)]==devices[_0x2c767d]['ip']&&new Date()[_0x2e3d17(0x170)]()-devices[_0x2c767d][_0x2e3d17(0x1ee)]['timestamp']<devices[_0x2c767d]['telegramIpApproval'][_0x2e3d17(0x185)]*0x3c*0x3e8),_0x9b4e8b;},telegram2FaApproved=_0x25f587=>{const _0x3881af=_0x50ea8b;let _0x520b16=![];return devices[_0x25f587][_0x3881af(0x112)]&&devices[_0x25f587][_0x3881af(0x112)]['expiry']!=_0x3881af(0x213)&&(_0x520b16=devices[_0x25f587][_0x3881af(0x112)]['clientip']==devices[_0x25f587]['ip']&&new Date()[_0x3881af(0x170)]()-devices[_0x25f587][_0x3881af(0x112)][_0x3881af(0x118)]<devices[_0x25f587][_0x3881af(0x112)][_0x3881af(0x185)]*0x3c*0x3e8),_0x520b16;},normalizeIP=_0x24b001=>{const _0x5cd225=_0x50ea8b;let _0x3a26f5=null,_0x26e0a3=null;if(ipaddr[_0x5cd225(0xec)](_0x24b001)){const _0x2e88f4=ipaddr['parse'](_0x24b001);_0x2e88f4['kind']()==='ipv6'?(_0x2e88f4[_0x5cd225(0x208)]()&&(_0x3a26f5=_0x2e88f4[_0x5cd225(0x1bb)]()[_0x5cd225(0x160)]()),_0x26e0a3=_0x2e88f4['toString']()):(_0x3a26f5=_0x2e88f4[_0x5cd225(0x160)](),_0x26e0a3=_0x2e88f4[_0x5cd225(0x121)]()['toString']());}return{'show':_0x3a26f5?_0x3a26f5:_0x26e0a3,'store':_0x26e0a3};};function sleep(_0x427ee0){return new Promise(_0x565068=>setTimeout(_0x565068,_0x427ee0));}