const _0x3e90d5=_0x56be;function _0xa18a(){const _0x163254=['CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','username','0.0.0','hashSync','sendMetricsTelegram','success','binary','type','Unauthorized\x20attempt\x20to\x20confirm\x20message','express-fileupload','fork','get','bots','env','exchange','login\x20not\x20required','log','alerts','help','sendFile','config/','get-messages','length','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','editMessageReplyMarkup','telegramEvents','Idling\x20(','Starting\x20new\x20bot\x20|\x20Bot\x20','$1_$2_$3','value','************','rmSync','config','logged\x20out','range','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','\x20|\x20','date-fns','#RES#\x20if\x20running\x20on\x20server','simple','exit','deleteHistoryAlerts','toIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','get-starting-balances','secret','filter','reset-password','removeAllListeners','Unauthorized\x20attempt\x20to\x20store\x20configuration','54tzYjkr','mkdirSync','search','restart_','bb-config.json','3000','Starting\x20Balance\x20Bot\x20update','IPv4','error','telegrammsg','botID','handshake','getSeconds','file','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','/:bot/portfolio','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','endsWith','uncaughtException','tempaccess_reject_','number','\x20>\x20','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','tempaccess_30_','names','clientip','showname','hybrid-crypto-js','DEFLATE','privateKey','Bot\x20','sendPortfolioTelegram','createServer','Restoring\x20bot(s)\x20from\x20backup','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','get-logs','/off\x20-\x20stop\x20bot(s)\x0a','SIGINT','Unauthorized\x20login\x20attempt\x20(timeout)','All\x20bots','lastmsgtelegram','reinstall_yes','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','RSA','(staging)','toggleBotMode','uuid-random','reinstall-bb','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','login\x20required','Allow\x20login\x20from\x20IP\x20address\x20','Unauthorized\x20attempt\x20to\x20show\x20configuration','Enabled\x20Bot\x20','name','ETH','startsWith','2177722YpAvjk','readdirSync','tempaccess_5_','login','then','Notifications\x20enabled\x0a','marketcapApi','bcryptjs','RSA-OAEP','apply','Alerts','15RkgbGi','randomFillSync','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','password','/disable\x20-\x20disable\x20notifications\x0a','isValid','-----------------------------------------------------------------------------------','store','backupfile','https://api.ipify.org?format=json','userid','readFileSync','notification','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','bbPassword','store-headless','/start','expiry','settings.','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','#RES#\x20if\x20running\x20locally\x0a','send','\x1b[35m','127.0.0.1','secure','showConfig','command','child_process','telegramIpApproval','Starting\x20#RED#Balance\x20Bot\x20v','tempaccess_15_','login\x20token\x20generated','/download/:type','assign','Ok,\x20will\x20send\x20alert\x20notifications\x20only','replace','-performance.json','randomBytes','enable','restore_yes_','min','getDate','inherit','2FA\x20required','status','inlineKeyboard','telegram','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','running','parse','conn',')\x20|\x20Bot\x20','storeFiat','Invalid\x20IP\x20address','map','File\x20uploaded','All\x20bots\x20running\x20right\x20now','access','Telegram\x20error:','node-zip','2345170GGLnzT','off','storeHeadless','split','api-eu.mixpanel.com','files','confirm-message','Unauthorized\x20attempt\x20to\x20get\x20messages','add','getTime','Invalid\x20username\x20or\x20IP\x20address','path','bot-','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Password\x20reset\x20rejected','5565744zxILoE','isDirectory','Unauthorized\x20attempt\x20to\x20delete\x20alerts','allow','token','\x20mode','\x1b[36m','bot','generate','/restart\x20-\x20restart\x20bot(s)\x0a','Login\x20rejected','Network\x20Interfaces:','socket','BCT','copyFileSync','order','<b>Balance\x20Bot\x20Status:</b>\x0a','title','reject','1437452aQuSyF','Bot\x20Mgr\x20>\x20','Error:\x20Invalid\x20argument\x20','No\x20bots\x20running\x20right\x20now','new','emit','environment','add-bot','disable','build2','Unauthorized\x20attempt\x20to\x20log\x20out','unlinkSync','apiPassword','all','address\x20already\x20in\x20use','CoinMarketCap\x20API\x20key\x20validated','show','timestamp','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','from','ipc','string','reinstall_no','\x1b[34m','(((.+)+)+)+$','delete-bot','exp','config_all','[ip-address]','sockets','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','reload','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','loginRequired','.zip','mixpanel','toString','stopped','padStart','encryptedUuid','forEach','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','portfolio','bbvNew','chat','connection','tkn','createWriteStream','ipaddr.js','build','invalid\x20credentials','host','publicKey','config_alerts','button','temporary\x20access\x20rejected','getFullYear','get-backup-files','max','2FA\x20login\x20required','download','accept','live','2FA\x20login\x20rejected','access\x20timeout','\x20|\x20client:\x20...','exec','initclient','slice','Unauthorized\x20attempt\x20to\x20delete\x20bot','reply','pidRefreshToken','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','30\x20min','Notifications\x20disabled','bb/','format','You\x20can\x20use\x20the\x20following\x20commands:\x0a','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','test','restore-backup-file','|@|','Unauthorized\x20attempt\x20to\x20download\x20','sha256','enabled','reinstall','Restore\x20backup\x20file\x20','isIPv4MappedAddress','uuid','output-003.log','portfolio_','start','*$1*','version.json','remoteAddress','::1','internal','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','getPortfolio','apiKey','remove','restart','temporary\x20token\x20generated','-events.json','Notifications\x20types:\x20','toIPv4Address','bb-settings.json','\x1b[33m','/names\x20-\x20show\x20bot\x20names\x0a','any','\x20(2)','write','settings','update_yes','full','user','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','/:bot/coins',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','versions','getMonth','bbUsername','logout','NTBA_FIX_319','telegramEnabled','blacklist','staging','5\x20min','6kymgSR','new-disabled','backup-full@','408501vPTYtK','backup-full','/status\x20-\x20show\x20bot(s)\x20status\x0a','verify','-config.json','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Logged\x20in\x20user\x20...','util','output-002.log','Login\x20accepted','constructor','Yes','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','All','delete-alerts','resetpw_yes','stringify','Unauthorized\x20attempt\x20to\x20update\x20bot','started','#RES#\x20','output-000.log','***','express','No\x20authentication\x20token','Token\x20blacklisted','headless','backup','production','decrypt','Restore\x20process\x20aborted','Temporary\x20access\x20rejected','metrics_','server','close','f2aRequired','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','mode','catch','cancelLoading','Password\x20has\x20been\x20reset\x20to:\x20','Orders','<b>Telegram\x20Bot\x20Status:</b>\x0a','bb-secure.json','hasOwnProperty','Access\x20enabled\x20for\x20','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','socket.io','family','compareSync','sortBy','\x20(1)','resetpw_no','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','botmanager','yes','metrics',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','telegram2FaApproval','Ok,\x20will\x20send\x20order\x20notifications\x20only','1000','2FA\x20login\x20token\x20generated','index.html','kill','manual','event','includes','kind',')\x20\x20\x20|\x20Bot\x20','reason','timeshift','login2fa_','Unauthorized\x20attempt\x20to\x20add\x20bot','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','ipv6','onepagemode','Unauthorized\x20attempt\x20to\x20get\x20events','orders','Invalid\x20authentication\x20token\x20(2)','graphql-request','disconnect','set','cancel-loading','sign','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Markdown','find','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','telegramChatId','referer','auto','update-bot','telegramUsername','User\x20has\x20been\x20validated','node','SIGTERM','store-fiat','HTML','/:bot','logs/','backup/','Deleted\x20Bot\x20','update-bb','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','::ffff:127.0.0.1','/enable\x20-\x20enable\x20notifications\x0a','writeFileSync','bbvReceive','Restarting\x20Bot\x20','entries','request','params','join','/:bot/support','/:bot/performance','=>\x20Go\x20to\x20#CYA#http://','debug','2418668WCMOez','Setting\x20access:\x20','hex','listen','args','Logged\x20out\x20user\x20...','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','post','botname','keys','4247975XIzsFW','\x20-\x20','use','match','message','getMinutes','launch','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','restore_no_','telegramToken','pidExpireLogin','statSync','update','toggle-bot-mode','Starting\x20(','defaults','static','push','existsSync','sort','2FA','lastmsgemitted','headers','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','on_','argv','latestversion','function','data','track','action','temp/','/on\x20-\x20start\x20bot(s)\x0a','messages','getHours','output-001.log','once','Unauthorized\x20attempt\x20to\x20update\x20settings','\x20|\x20user:\x20...','Telegraf\x20error:','cloneDeep','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','reset-history','bot.js','generateKeyPairAsync','logs','Crypt','disabled','apiSecret','update_no','getUTCHours','port','Node.js\x20v','init','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','address','stop','callback'];_0xa18a=function(){return _0x163254;};return _0xa18a();}(function(_0x466e2e,_0x49c3b3){const _0x1340eb=_0x56be,_0x443420=_0x466e2e();while(!![]){try{const _0x1924ff=parseInt(_0x1340eb(0x3c7))/0x1+-parseInt(_0x1340eb(0x2da))/0x2+-parseInt(_0x1340eb(0x2e5))/0x3*(-parseInt(_0x1340eb(0x343))/0x4)+parseInt(_0x1340eb(0x235))/0x5+parseInt(_0x1340eb(0x3c4))/0x6*(-parseInt(_0x1340eb(0x22b))/0x7)+parseInt(_0x1340eb(0x330))/0x8+-parseInt(_0x1340eb(0x2a1))/0x9*(parseInt(_0x1340eb(0x321))/0xa);if(_0x1924ff===_0x49c3b3)break;else _0x443420['push'](_0x443420['shift']());}catch(_0xb15901){_0x443420['push'](_0x443420['shift']());}}}(_0xa18a,0xddf56));const _0x30f32f=function(){let _0x4b5577=!![];return function(_0xa8c9e1,_0x3df38a){const _0x4507d8=_0x4b5577?function(){const _0x10dc76=_0x56be;if(_0x3df38a){const _0x3cc51e=_0x3df38a[_0x10dc76(0x2e3)](_0xa8c9e1,arguments);return _0x3df38a=null,_0x3cc51e;}}:function(){};return _0x4b5577=![],_0x4507d8;};}(),_0xe45cb7=_0x30f32f(this,function(){const _0x3ef428=_0x56be;return _0xe45cb7['toString']()[_0x3ef428(0x2a3)](_0x3ef428(0x35b))[_0x3ef428(0x367)]()[_0x3ef428(0x3d1)](_0xe45cb7)[_0x3ef428(0x2a3)](_0x3ef428(0x35b));});_0xe45cb7();'use strict';process[_0x3e90d5(0x27c)][_0x3e90d5(0x3bf)]=0x1;const childProcess=require(_0x3e90d5(0x300)),fs=require('fs'),fns=require(_0x3e90d5(0x294)),low=require('lowdb'),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x3e90d5(0x32c)),crypto=require('crypto'),Crypt=require(_0x3e90d5(0x2bd))[_0x3e90d5(0x263)],RSA=require(_0x3e90d5(0x2bd))[_0x3e90d5(0x2cd)],bcrypt=require(_0x3e90d5(0x2e1)),jwt=require('jsonwebtoken'),ipaddr=require(_0x3e90d5(0x373)),argv=require('yargs/yargs')(process[_0x3e90d5(0x24e)][_0x3e90d5(0x387)](0x2))['argv'],uuidRandom=require(_0x3e90d5(0x2d0)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x3e90d5(0x366)),axios=require('axios'),{GraphQLClient,gql}=require(_0x3e90d5(0x204)),util=require(_0x3e90d5(0x3ce)),fileUpload=require(_0x3e90d5(0x278)),{networkInterfaces}=require('os'),PORT=argv[_0x3e90d5(0x268)]||_0x3e90d5(0x2a6),pattern=/^[0-9]{2,4}$/;!pattern[_0x3e90d5(0x392)](PORT)&&(console['log'](_0x3e90d5(0x345)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x3e90d5(0x297)](0x1));const HOST=argv[_0x3e90d5(0x376)]||null,userID=argv[_0x3e90d5(0x3b6)]||'',debugging=argv['d']||![],nodeversion=process[_0x3e90d5(0x3bb)][_0x3e90d5(0x213)];let bbpath=_0x3e90d5(0x38e),bbpath2='';const botfile=_0x3e90d5(0x260),configfile=_0x3e90d5(0x2a5),settingsfile=_0x3e90d5(0x3ad),securefile=_0x3e90d5(0x1e0),environment=require('./'+bbpath2+_0x3e90d5(0x3a0))[_0x3e90d5(0x349)]||_0x3e90d5(0x1d1),maxBackups=0xa;let validInstallation=!![];!fs[_0x3e90d5(0x247)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x3e90d5(0x283)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x3e90d5(0x219),logspath=userID?bbpath+_0x3e90d5(0x218)+userID+'/':bbpath+_0x3e90d5(0x218),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+'zip/',loggerfile=fs[_0x3e90d5(0x372)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x3e90d5(0x254)+userID+'/':bbpath+'temp/';!fs['existsSync'](configpath)&&fs[_0x3e90d5(0x2a2)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x3e90d5(0x2a2)](configbackuppath);!fs[_0x3e90d5(0x247)](logspath)&&fs[_0x3e90d5(0x2a2)](logspath);!fs[_0x3e90d5(0x247)](zippath)&&fs[_0x3e90d5(0x2a2)](zippath);!fs[_0x3e90d5(0x247)](temppath)&&fs[_0x3e90d5(0x2a2)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x3e90d5(0x244)]({'bots':[]})[_0x3e90d5(0x3b2)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3e90d5(0x244)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x3e90d5(0x3b2)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x3e90d5(0x244)]({'secure':{},'blacklist':[]})[_0x3e90d5(0x3b2)]();let crypt=new Crypt({'md':_0x3e90d5(0x396),'rsaStandard':_0x3e90d5(0x2e2)});const saltRounds=0xa,mixpanel=Mixpanel[_0x3e90d5(0x26a)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x3e90d5(0x325)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x3e90d5(0x23e)]&&(settings[_0x3e90d5(0x23e)]!=''&&settings[_0x3e90d5(0x23e)]!='***')&&settings[_0x3e90d5(0x211)]&&settings[_0x3e90d5(0x211)]!='')initTelegram();const parseColor=(_0x2a975d,_0x565c64)=>{const _0x3a6849=_0x3e90d5,_0x1e6233=/#[A-Z]{3}#/g;if(typeof _0x2a975d==_0x3a6849(0x358)){!_0x565c64?_0x2a975d=_0x2a975d[_0x3a6849(0x308)](_0x1e6233,''):(_0x2a975d=_0x2a975d['replace'](/#BLU#/g,_0x3a6849(0x35a)),_0x2a975d=_0x2a975d['replace'](/#RED#/g,'\x1b[31m'),_0x2a975d=_0x2a975d[_0x3a6849(0x308)](/#YEL#/g,_0x3a6849(0x3ae)),_0x2a975d=_0x2a975d[_0x3a6849(0x308)](/#MAG#/g,_0x3a6849(0x2fb)),_0x2a975d=_0x2a975d[_0x3a6849(0x308)](/#CYA#/g,_0x3a6849(0x336)),_0x2a975d=_0x2a975d['replace'](/#RES#/g,'\x1b[0m'));;}return _0x2a975d;},logger={'screen':_0x32821f=>{console['log'](parseColor(_0x32821f,!![]));},'simple':_0x4b60f3=>{const _0x48496d=_0x3e90d5;console[_0x48496d(0x27f)](parseColor(_0x4b60f3,!![])),loggerfile[_0x48496d(0x3b2)](util[_0x48496d(0x38f)](parseColor(_0x4b60f3,![]))+'\x0a');},'full':async _0x5351bc=>{const _0x4c35d9=_0x3e90d5,_0x53b18f=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x5351bc;console[_0x4c35d9(0x27f)](parseColor(_0x53b18f,!![])),loggerfile[_0x4c35d9(0x3b2)](util[_0x4c35d9(0x38f)](parseColor(_0x53b18f,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x4c35d9(0x288)]!=_0x4c35d9(0x202))await sendTelegram(settings[_0x4c35d9(0x20d)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x5351bc,![]));},'debug':async(_0x1ffe15,_0x4bf6f6='')=>{const _0x46f41a=_0x3e90d5,_0x3a6477=getTimeStamp()+_0x46f41a(0x1ee)+_0x1ffe15;if(debugging)console[_0x46f41a(0x27f)](parseColor(_0x3a6477,!![]));loggerfile[_0x46f41a(0x3b2)](util[_0x46f41a(0x38f)](parseColor(_0x3a6477,![]))+'\x0a');if(_0x4bf6f6){if(debugging)console[_0x46f41a(0x27f)](_0x4bf6f6);loggerfile[_0x46f41a(0x3b2)](util['format'](_0x4bf6f6)+'\x0a');}}};let terminating=![];process['on'](_0x3e90d5(0x2b4),function(_0x20b8da){const _0x446ba5=_0x3e90d5;_0x20b8da[_0x446ba5(0x367)]()['includes'](_0x446ba5(0x351))?(logger[_0x446ba5(0x296)](_0x446ba5(0x361)+_0x20b8da[_0x446ba5(0x268)]+'#RES#'),process[_0x446ba5(0x2fa)]({'terminate':!![]},_0x2f4ab9=>{})):logger[_0x446ba5(0x296)](_0x20b8da);}),process['on'](_0x3e90d5(0x297),()=>{const _0x529d13=_0x3e90d5;stopAllBots(),process[_0x529d13(0x297)](0x0);}),process['on'](_0x3e90d5(0x214),()=>{const _0x3403fc=_0x3e90d5;stopAllBots(),process[_0x3403fc(0x297)](0x0);}),process['on'](_0x3e90d5(0x2c7),()=>{const _0x26eed5=_0x3e90d5;stopAllBots(),process[_0x26eed5(0x297)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x3e90d5(0x3a0))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x3e90d5(0x1cc)),app=express(),http=require('http')[_0x3e90d5(0x2c2)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x3e90d5(0x27a)](_0x3e90d5(0x305),async(_0x40e74e,_0x5bf173)=>{const _0x745b3c=_0x3e90d5,_0x49d041=_0x40e74e[_0x745b3c(0x225)]['type'],_0x5e32e8=getClientsWithBotID(_0x745b3c(0x1eb)),_0x5f41c2=_0x40e74e[_0x745b3c(0x24b)][_0x745b3c(0x39b)],_0x2c9435=timelyDecrypt(_0x5f41c2,![]),_0x2e7335=_0x5e32e8[_0x745b3c(0x20b)](_0x2d69b5=>_0x2d69b5[_0x745b3c(0x39b)]==_0x2c9435);if(_0x2e7335){const _0x30f5c3=normalizeIP(_0x40e74e[_0x745b3c(0x33c)][_0x745b3c(0x3a1)])[_0x745b3c(0x2ec)],_0x11355c=_0x40e74e['headers'][_0x745b3c(0x371)];if(validateAccess(_0x11355c,_0x2c9435,_0x30f5c3)[_0x745b3c(0x333)])_0x49d041=='backup'&&await backupConfigFiles(),await zipFiles(_0x49d041),_0x5bf173[_0x745b3c(0x37f)](zippath+(_0x49d041+_0x745b3c(0x365)),_0x54c439=>{const _0x13606f=_0x745b3c;_0x54c439&&(logger['full']('Failed\x20to\x20download\x20'+_0x49d041),logger[_0x13606f(0x296)](_0x54c439));});else logger['full'](_0x745b3c(0x395)+_0x49d041+_0x745b3c(0x1e8));}else logger[_0x745b3c(0x3b5)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x49d041+_0x745b3c(0x3b1));}),app[_0x3e90d5(0x232)]('/upload-backup',async(_0x54e407,_0x552921)=>{const _0x259312=_0x3e90d5,_0x39837e=getClientsWithBotID(_0x259312(0x1eb)),_0x157bd8=_0x54e407[_0x259312(0x24b)][_0x259312(0x39b)],_0x480214=timelyDecrypt(_0x157bd8,![]),_0x24213a=_0x39837e[_0x259312(0x20b)](_0x4a3e4e=>_0x4a3e4e[_0x259312(0x39b)]==_0x480214);logger[_0x259312(0x22a)]('Backup\x20file\x20uploaded');if(_0x24213a){const _0x3f758a=normalizeIP(_0x54e407[_0x259312(0x33c)][_0x259312(0x3a1)])[_0x259312(0x2ec)],_0x50c3a1=_0x54e407['headers'][_0x259312(0x371)];if(validateAccess(_0x50c3a1,_0x480214,_0x3f758a)[_0x259312(0x333)]){if(_0x54e407[_0x259312(0x326)]){const _0x568ec7=_0x54e407[_0x259312(0x326)][_0x259312(0x2ed)];await _0x568ec7['mv'](temppath+_0x568ec7[_0x259312(0x2d7)]),_0x552921[_0x259312(0x2fa)]({'status':!![],'message':_0x259312(0x31c)});const _0x4df8c6=getBotsWithMode();_0x4df8c6[_0x259312(0x285)]>0x0?confirmRestore(temppath,_0x568ec7[_0x259312(0x2d7)]):unzipFile(temppath,_0x568ec7[_0x259312(0x2d7)]);}}else logger[_0x259312(0x3b5)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x259312(0x3b5)](_0x259312(0x26b));}),app[_0x3e90d5(0x237)](express[_0x3e90d5(0x245)](path[_0x3e90d5(0x226)](__dirname,bbpath2,'build2'))),app['use'](express[_0x3e90d5(0x245)](path[_0x3e90d5(0x226)](__dirname,bbpath2,_0x3e90d5(0x374)))),app['get']('/',function(_0x15da27,_0x475bd3){const _0x15d7ad=_0x3e90d5;_0x475bd3[_0x15d7ad(0x282)](path['join'](__dirname,bbpath2,_0x15d7ad(0x34c),_0x15d7ad(0x1f3)));}),app[_0x3e90d5(0x27a)](_0x3e90d5(0x217),function(_0x1f083e,_0x5c3019){const _0x1fadf3=_0x3e90d5;_0x5c3019[_0x1fadf3(0x282)](path[_0x1fadf3(0x226)](__dirname,bbpath2,_0x1fadf3(0x374),'index.html'));}),app[_0x3e90d5(0x27a)](_0x3e90d5(0x2b1),(_0x4990a0,_0x2f29fd)=>{const _0x25bc83=_0x3e90d5;_0x2f29fd[_0x25bc83(0x282)](path[_0x25bc83(0x226)](__dirname,bbpath2,_0x25bc83(0x374),_0x25bc83(0x1f3)));}),app['get'](_0x3e90d5(0x228),(_0xccdf64,_0x4b202c)=>{const _0x2993bd=_0x3e90d5;_0x4b202c[_0x2993bd(0x282)](path['join'](__dirname,bbpath2,_0x2993bd(0x374),_0x2993bd(0x1f3)));}),app[_0x3e90d5(0x27a)](_0x3e90d5(0x3b8),(_0xa18ea4,_0x2001c2)=>{const _0x19eded=_0x3e90d5;_0x2001c2[_0x19eded(0x282)](path['join'](__dirname,bbpath2,_0x19eded(0x374),'index.html'));}),app[_0x3e90d5(0x27a)]('/:bot/history',(_0x21b0c6,_0x254d34)=>{const _0x4adec8=_0x3e90d5;_0x254d34[_0x4adec8(0x282)](path['join'](__dirname,bbpath2,'build','index.html'));}),app[_0x3e90d5(0x27a)]('/:bot/configuration',(_0x248faf,_0x4def54)=>{const _0x27abba=_0x3e90d5;_0x4def54[_0x27abba(0x282)](path[_0x27abba(0x226)](__dirname,bbpath2,'build',_0x27abba(0x1f3)));}),app['get'](_0x3e90d5(0x227),(_0x10e3bd,_0x35a9cc)=>{const _0x4fed28=_0x3e90d5;_0x35a9cc[_0x4fed28(0x282)](path[_0x4fed28(0x226)](__dirname,bbpath2,_0x4fed28(0x374),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http[_0x3e90d5(0x22e)](PORT);const io=require(_0x3e90d5(0x1e4))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x3c971e=_0x3e90d5;let _0x508d2c=_0x3c971e(0x35f);const _0x75c6e3=networkInterfaces(),_0x303553={};for(const _0x29472e of Object[_0x3c971e(0x234)](_0x75c6e3)){for(const _0x19cb07 of _0x75c6e3[_0x29472e]){if((_0x19cb07[_0x3c971e(0x1e5)]==_0x3c971e(0x2a8)||_0x19cb07[_0x3c971e(0x1e5)]==0x4)&&!_0x19cb07[_0x3c971e(0x3a3)]){const _0x19701f=ipaddr['parse'](_0x19cb07[_0x3c971e(0x26c)])[_0x3c971e(0x291)]();_0x19701f!='private'&&(!_0x303553[_0x29472e]&&(_0x303553[_0x29472e]=[]),_0x303553[_0x29472e][_0x3c971e(0x246)](_0x19cb07[_0x3c971e(0x26c)]),_0x508d2c=_0x19cb07['address']);}}}return{'serverip':_0x508d2c,'netinterfaces':_0x303553};}async function startServer(){const _0x19982d=_0x3e90d5,{serverip:_0x57a96a,netinterfaces:_0x5a57af}=getServerIP();logger[_0x19982d(0x296)](''),logger[_0x19982d(0x296)](_0x19982d(0x2eb)),await logger['full'](_0x19982d(0x302)+serverversion+_0x19982d(0x1c9)+(environment==_0x19982d(0x3c2)?_0x19982d(0x2ce):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x19982d(0x2f9))+(_0x19982d(0x229)+_0x57a96a+':'+PORT+_0x19982d(0x295))),logger[_0x19982d(0x296)](_0x19982d(0x2eb));if(config[_0x19982d(0x285)]!=0x0)for(const _0x4fe6cb of config){const _0x333dd6=_0x4fe6cb[_0x19982d(0x1da)]==_0x19982d(0x20f)?'a':'m';if(_0x4fe6cb[_0x19982d(0x311)]=='enabled'||_0x4fe6cb['status']=='new')await logger[_0x19982d(0x3b5)](_0x19982d(0x243)+_0x333dd6+_0x19982d(0x318)+_0x4fe6cb[_0x19982d(0x2ab)]+_0x19982d(0x293)+_0x4fe6cb[_0x19982d(0x233)]),startBot([_0x4fe6cb[_0x19982d(0x2ab)],userID],{'cwd':bbpath},function(_0x395d0){const _0x4475b8=_0x19982d;if(_0x395d0)logger[_0x4475b8(0x3b5)](_0x395d0);});else(_0x4fe6cb[_0x19982d(0x311)]=='disabled'||_0x4fe6cb['status']=='new-disabled')&&await logger[_0x19982d(0x3b5)](_0x19982d(0x289)+_0x333dd6+_0x19982d(0x1f9)+_0x4fe6cb[_0x19982d(0x2ab)]+_0x19982d(0x293)+_0x4fe6cb[_0x19982d(0x233)]);}else!newBot&&logger['simple'](_0x19982d(0x2e7));if(newBot)addBot();logger[_0x19982d(0x296)](_0x19982d(0x2eb)),logger[_0x19982d(0x296)](''),await logger['debug'](_0x19982d(0x269)+nodeversion),await logger[_0x19982d(0x22a)](_0x19982d(0x33b),_0x5a57af);}function startSocket(){const _0x2a39bf=_0x3e90d5;io['on'](_0x2a39bf(0x370),_0x500d41=>{const _0x13bd7b=_0x2a39bf;let _0x58b670,_0x3d94d7,_0xca80ac,_0x2b6860,_0x1f427f;const _0x37dee7=_0x500d41[_0x13bd7b(0x2ac)][_0x13bd7b(0x24b)][_0x13bd7b(0x20e)];_0x3d94d7=_0x37dee7[_0x13bd7b(0x238)](/bot[0-9]{3}/);if(_0x3d94d7)_0xca80ac=_0x3d94d7[0x0][_0x13bd7b(0x238)](/[0-9]{3}/);if(_0xca80ac)_0x58b670=_0xca80ac[0x0];else _0x58b670=_0x13bd7b(0x1eb);const _0x334b4a=_0x500d41[_0x13bd7b(0x2ac)]['auth'][_0x13bd7b(0x36a)];if(!_0x334b4a)_0x500d41[_0x13bd7b(0x348)](_0x13bd7b(0x311),{'publicKey':secure[_0x13bd7b(0x377)]});else{_0x2b6860=timelyDecrypt(_0x334b4a,![]);if(!_0x2b6860)_0x500d41[_0x13bd7b(0x348)]('status',{'publicKey':secure[_0x13bd7b(0x377)]});else{_0x1f427f=normalizeIP(_0x500d41[_0x13bd7b(0x317)][_0x13bd7b(0x3a1)])[_0x13bd7b(0x2ec)];if(!devices[_0x2b6860])devices[_0x2b6860]={'uuid':_0x2b6860,'access':{'token':null}};devices[_0x2b6860]['ip']=_0x1f427f;const _0xa5ceb2=addClient(_0x500d41['id'],_0x2b6860,_0x58b670);setAccess(_0xa5ceb2),emitMessages(),_0x500d41['on'](_0x13bd7b(0x2dd),_0x42c63e=>{const _0x45e14d=_0x13bd7b,_0x12969a=timelyDecrypt(_0x42c63e[_0x45e14d(0x2e8)],!![],'|@|');if(_0x12969a){_0x42c63e={'username':_0x42c63e[_0x45e14d(0x270)],'password':_0x12969a},devices[_0x2b6860][_0x45e14d(0x31e)]=validateCredentials(_0x42c63e,_0x2b6860);if(devices[_0x2b6860][_0x45e14d(0x31e)][_0x45e14d(0x333)]==![]&&devices[_0x2b6860][_0x45e14d(0x31e)][_0x45e14d(0x1fa)]==_0x45e14d(0x37e))_0x500d41['emit']('status',{'access':devices[_0x2b6860][_0x45e14d(0x31e)]}),loginAccess2FA(_0x2b6860,_0x1f427f);else{if(devices[_0x2b6860][_0x45e14d(0x31e)]['allow']==![]&&devices[_0x2b6860][_0x45e14d(0x31e)][_0x45e14d(0x1fa)]==_0x45e14d(0x375))_0x500d41[_0x45e14d(0x348)](_0x45e14d(0x311),{'access':devices[_0x2b6860][_0x45e14d(0x31e)]});else devices[_0x2b6860][_0x45e14d(0x31e)][_0x45e14d(0x333)]&&devices[_0x2b6860][_0x45e14d(0x31e)][_0x45e14d(0x1fa)]==_0x45e14d(0x304)&&(getClientsWithUuid(_0x2b6860)[_0x45e14d(0x36b)](_0x1175bb=>{setAccess(_0x1175bb);}),logger['debug'](_0x45e14d(0x3cd)+_0x2b6860[_0x45e14d(0x387)](-0x8)),setTokenRefresh(_0x2b6860),setSessionTimeout(_0x45e14d(0x2dd),_0x2b6860));}}else logger['full'](_0x45e14d(0x2c8));}),_0x500d41['on'](_0x13bd7b(0x29e),()=>{resetPassword();}),_0x500d41['on'](_0x13bd7b(0x205),_0x5cdde0=>{removeClient(_0x500d41['id']);}),_0x58b670==_0x13bd7b(0x1eb)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0xb99b0e){const _0x2ddb45=_0x3e90d5;if(_0xb99b0e!=_0x2ddb45(0x1eb)&&config[_0x2ddb45(0x3a6)]!=''){if(pid[_0xb99b0e])pid[_0xb99b0e][_0x2ddb45(0x2fa)]({'function':_0x2ddb45(0x386),'args':null});}_0xb99b0e!=_0x2ddb45(0x1eb)&&broadcastToBots('bots',JSON[_0x2ddb45(0x1c6)](config));}function reloadBotManager(){const _0x557eff=_0x3e90d5;getClientsWithBotID(_0x557eff(0x1eb))['forEach'](_0x4bde27=>{const _0x274c35=_0x557eff;getSocket(_0x4bde27['id'])[_0x274c35(0x348)](_0x274c35(0x311),{'access':{'allow':![],'reason':_0x274c35(0x362),'token':null}});});}function getSocket(_0x58d4bc){const _0x4671ad=_0x3e90d5;return io[_0x4671ad(0x360)][_0x4671ad(0x360)]['get'](_0x58d4bc);}function setAccess(_0x3778cc){const _0x19baa7=_0x3e90d5,_0x322cf6=getSocket(_0x3778cc['id']),_0x17aac6=_0x3778cc[_0x19baa7(0x39b)],_0x1e3e48=_0x3778cc[_0x19baa7(0x337)];devices[_0x17aac6]['access']=validateAccess(devices[_0x17aac6][_0x19baa7(0x31e)][_0x19baa7(0x334)],_0x17aac6),logger[_0x19baa7(0x22a)](_0x19baa7(0x22c)+devices[_0x17aac6][_0x19baa7(0x31e)]['reason']+_0x19baa7(0x384)+_0x3778cc['id'][_0x19baa7(0x387)](-0x8)+_0x19baa7(0x25b)+_0x17aac6['slice'](-0x8)),_0x322cf6[_0x19baa7(0x226)](_0x17aac6);if(devices[_0x17aac6][_0x19baa7(0x31e)][_0x19baa7(0x333)]){_0x322cf6[_0x19baa7(0x226)](_0x1e3e48);if(_0x1e3e48==_0x19baa7(0x1eb))initializeSocketBotManager(_0x322cf6);else initializeSocketBot(_0x322cf6);initClient(_0x1e3e48);}devices[_0x17aac6][_0x19baa7(0x31e)]['token']&&devices[_0x17aac6]['access'][_0x19baa7(0x1fa)]==_0x19baa7(0x3a9)&&setSessionTimeout(_0x19baa7(0x249),_0x17aac6),devices[_0x17aac6][_0x19baa7(0x31e)][_0x19baa7(0x334)]&&devices[_0x17aac6][_0x19baa7(0x31e)][_0x19baa7(0x1fa)]==_0x19baa7(0x1f2)&&setSessionTimeout('login',_0x17aac6),_0x322cf6[_0x19baa7(0x348)](_0x19baa7(0x311),{'status':_0x3778cc[_0x19baa7(0x1d6)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x17aac6][_0x19baa7(0x31e)],'externalip':devices[_0x17aac6]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x17aac6][_0x19baa7(0x31e)]['allow']==![]&&devices[_0x17aac6][_0x19baa7(0x31e)][_0x19baa7(0x1fa)]==_0x19baa7(0x310)&&temporaryAccess2FA(_0x17aac6,devices[_0x17aac6]['ip']);}function setSessionTimeout(_0x1478d5,_0x14e6d3){const _0x1b0432=_0x3e90d5;let _0x2f1e64;if(_0x1478d5=='login')_0x2f1e64=loginExpiry*0x3c*0x3e8;else _0x2f1e64=devices[_0x14e6d3][_0x1b0432(0x301)][_0x1b0432(0x2f6)]*0x3c*0x3e8-(new Date()[_0x1b0432(0x32a)]()-devices[_0x14e6d3][_0x1b0432(0x301)]['timestamp']);if(devices[_0x14e6d3][_0x1b0432(0x23f)])clearTimeout(devices[_0x14e6d3][_0x1b0432(0x23f)]);devices[_0x14e6d3][_0x1b0432(0x23f)]=setTimeout(()=>{const _0x3a31e3=_0x1b0432;if(devices[_0x14e6d3]['pidRefreshToken'])clearTimeout(devices[_0x14e6d3][_0x3a31e3(0x38a)]);removeSocketListeners(_0x14e6d3),addBlacklist(_0x14e6d3),devices[_0x14e6d3][_0x3a31e3(0x301)]=null,devices[_0x14e6d3][_0x3a31e3(0x1ef)]=null,devices[_0x14e6d3][_0x3a31e3(0x31e)][_0x3a31e3(0x334)]=null,logger[_0x3a31e3(0x22a)]('Session\x20expired\x20for\x20user\x20...'+_0x14e6d3[_0x3a31e3(0x387)](-0x8)),devices[_0x14e6d3][_0x3a31e3(0x31e)]=validateAccess(devices[_0x14e6d3][_0x3a31e3(0x31e)][_0x3a31e3(0x334)],_0x14e6d3),!(devices[_0x14e6d3]['access'][_0x3a31e3(0x333)]&&devices[_0x14e6d3][_0x3a31e3(0x31e)][_0x3a31e3(0x1fa)]==_0x3a31e3(0x27e))&&(_0x1478d5==_0x3a31e3(0x2dd)?io['to'](_0x14e6d3)[_0x3a31e3(0x348)](_0x3a31e3(0x311),{'access':{'allow':![],'reason':_0x3a31e3(0x383),'token':null}}):io['to'](_0x14e6d3)[_0x3a31e3(0x348)](_0x3a31e3(0x311),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x14e6d3][_0x3a31e3(0x31e)][_0x3a31e3(0x334)]=null;},_0x2f1e64);}function setTokenRefresh(_0x1eb59d){const _0x45ce9e=_0x3e90d5;if(devices[_0x1eb59d]['pidRefreshToken'])clearTimeout(devices[_0x1eb59d]['pidRefreshToken']);devices[_0x1eb59d][_0x45ce9e(0x38a)]=setTimeout(()=>{const _0x2d14c9=_0x45ce9e;getClientsWithUuid(_0x1eb59d)['length']!=0x0?(devices[_0x1eb59d][_0x2d14c9(0x31e)]=refreshToken(_0x1eb59d),io['to'](_0x1eb59d)[_0x2d14c9(0x348)](_0x2d14c9(0x311),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1eb59d][_0x2d14c9(0x31e)],'externalip':devices[_0x1eb59d]['ip'],'publicKey':secure[_0x2d14c9(0x377)],'validInstallation':validInstallation}),setTokenRefresh(_0x1eb59d)):clearTimeout(devices[_0x1eb59d][_0x2d14c9(0x38a)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1573f8){const _0x1d6d3e=_0x3e90d5,_0x1ca526=getClient(_0x1573f8['id'])[_0x1d6d3e(0x39b)];_0x1573f8[_0x1d6d3e(0x348)]('bots',config),_0x1573f8[_0x1d6d3e(0x348)](_0x1d6d3e(0x3b3),cleanSettings()),_0x1573f8['on'](_0x1d6d3e(0x34a),_0x3c2663=>{const _0x3c7040=_0x1d6d3e;if(validateAccess(_0x3c2663,_0x1ca526)[_0x3c7040(0x333)])addBot();else logger[_0x3c7040(0x3b5)](_0x3c7040(0x1fd));}),_0x1573f8['on'](_0x1d6d3e(0x210),(_0x5cf982,_0x2d11d5)=>{const _0x357b8f=_0x1d6d3e;if(validateAccess(_0x2d11d5,_0x1ca526)[_0x357b8f(0x333)])toggleBot(_0x5cf982[_0x357b8f(0x2ab)],_0x5cf982[_0x357b8f(0x311)],_0x5cf982[_0x357b8f(0x381)]);else logger[_0x357b8f(0x3b5)](_0x357b8f(0x1c7));}),_0x1573f8['on'](_0x1d6d3e(0x242),(_0x411faa,_0x25b130)=>{const _0x113bb8=_0x1d6d3e;if(validateAccess(_0x25b130,_0x1ca526)[_0x113bb8(0x333)])toggleBotMode(_0x411faa);else logger['full'](_0x113bb8(0x1c7));}),_0x1573f8['on'](_0x1d6d3e(0x35c),(_0x26796f,_0x229ff9)=>{const _0x16625e=_0x1d6d3e;if(validateAccess(_0x229ff9,_0x1ca526)[_0x16625e(0x333)])deleteBot(_0x26796f);else logger['full'](_0x16625e(0x388));}),_0x1573f8['on']('store-settings',(_0x4bafb2,_0x257b26)=>{const _0x36404c=_0x1d6d3e;if(validateAccess(_0x257b26,_0x1ca526)['allow'])storeSettings(_0x4bafb2,!![]);else logger[_0x36404c(0x3b5)](_0x36404c(0x25a));}),_0x1573f8['on'](_0x1d6d3e(0x21b),_0x8e9336=>{const _0x561064=_0x1d6d3e;if(validateAccess(_0x8e9336,_0x1ca526)[_0x561064(0x333)])updateBB(_0x561064(0x241));else logger['full'](_0x561064(0x1d9));}),_0x1573f8['on'](_0x1d6d3e(0x2d1),_0x543bd4=>{const _0x5ba073=_0x1d6d3e;if(validateAccess(_0x543bd4,_0x1ca526)[_0x5ba073(0x333)])updateBB(_0x5ba073(0x398));else logger['full'](_0x5ba073(0x2d2));}),_0x1573f8['on'](_0x1d6d3e(0x37c),_0x1a7b96=>{const _0x48e451=_0x1d6d3e;if(validateAccess(_0x1a7b96,_0x1ca526)[_0x48e451(0x333)]){const _0x19eb0e=getClient(_0x1573f8['id']);if(_0x19eb0e)getBackupFiles(_0x19eb0e[_0x48e451(0x39b)]);else logger[_0x48e451(0x3b5)](_0x48e451(0x3cc));}else logger['full']('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x1573f8['on'](_0x1d6d3e(0x393),(_0x5e47b5,_0x325865)=>{const _0x549556=_0x1d6d3e;if(validateAccess(_0x325865,_0x1ca526)[_0x549556(0x333)])restoreBackupFile(_0x5e47b5);else logger[_0x549556(0x3b5)](_0x549556(0x3d3));}),_0x1573f8['on']('get-messages',_0x4f6ab5=>{const _0x246a99=_0x1d6d3e;if(validateAccess(_0x4f6ab5,_0x1ca526)['allow'])getMessages();else logger[_0x246a99(0x3b5)](_0x246a99(0x328));}),_0x1573f8['on'](_0x1d6d3e(0x327),(_0x1cd638,_0x3a8ac3)=>{const _0x5f5a34=_0x1d6d3e;if(validateAccess(_0x3a8ac3,_0x1ca526)['allow'])confirmMessage(_0x1cd638);else logger['full'](_0x5f5a34(0x277));}),_0x1573f8['on'](_0x1d6d3e(0x3be),_0x337fa5=>{const _0x696f85=_0x1d6d3e;if(validateAccess(_0x337fa5,_0x1ca526)[_0x696f85(0x333)]){if(devices[_0x1ca526][_0x696f85(0x38a)])clearTimeout(devices[_0x1ca526]['pidRefreshToken']);if(devices[_0x1ca526][_0x696f85(0x23f)])clearTimeout(devices[_0x1ca526]['pidExpireLogin']);removeSocketListeners(getClient(_0x1573f8['id'])[_0x696f85(0x39b)]),addBlacklist(_0x1ca526),devices[_0x1ca526][_0x696f85(0x301)]=null,devices[_0x1ca526][_0x696f85(0x1ef)]=null,devices[_0x1ca526][_0x696f85(0x31e)][_0x696f85(0x334)]=null,logger[_0x696f85(0x22a)](_0x696f85(0x230)+_0x1ca526[_0x696f85(0x387)](-0x8)),io['to'](getClient(_0x1573f8['id'])[_0x696f85(0x39b)])[_0x696f85(0x348)](_0x696f85(0x311),{'access':{'allow':![],'reason':_0x696f85(0x290),'token':null}});}else logger[_0x696f85(0x3b5)](_0x696f85(0x34d));});}function initializeSocketBot(_0x56aee1){const _0x4ea564=_0x3e90d5,_0x3010cc=getClient(_0x56aee1['id'])[_0x4ea564(0x337)],_0x2a5f19=getClient(_0x56aee1['id'])[_0x4ea564(0x39b)];_0x56aee1['on'](_0x4ea564(0x2c5),(_0x5bb8e5,_0x3039f9)=>{const _0x5d73d2=_0x4ea564;if(validateAccess(_0x3039f9,_0x2a5f19)['allow']){if(pid[_0x3010cc])pid[_0x3010cc]['send']({'function':'emitHistory','args':_0x5bb8e5});}else logger[_0x5d73d2(0x3b5)](_0x5d73d2(0x201));}),_0x56aee1['on'](_0x4ea564(0x3d5),(_0x6495a7,_0x28aeb4)=>{const _0xfe5d3c=_0x4ea564;if(validateAccess(_0x28aeb4,_0x2a5f19)[_0xfe5d3c(0x333)]){if(pid[_0x3010cc])pid[_0x3010cc]['send']({'function':_0xfe5d3c(0x298),'args':_0x6495a7});}else logger[_0xfe5d3c(0x3b5)](_0xfe5d3c(0x332));}),_0x56aee1['on']('get-portfolio',(_0x191676,_0x79adcf)=>{const _0x386e66=_0x4ea564;if(validateAccess(_0x79adcf,_0x2a5f19)[_0x386e66(0x333)]){if(pid[_0x3010cc])pid[_0x3010cc][_0x386e66(0x2fa)]({'function':_0x386e66(0x3a5),'args':_0x191676});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x56aee1['on']('store-configuration',(_0x1cc5e7,_0x3c1933)=>{const _0x112bde=_0x4ea564;if(validateAccess(_0x3c1933,_0x2a5f19)[_0x112bde(0x333)]){if(pid[_0x3010cc])pid[_0x3010cc]['send']({'function':'storeConfiguration','args':_0x1cc5e7});}else logger[_0x112bde(0x3b5)](_0x112bde(0x2a0));}),_0x56aee1['on'](_0x4ea564(0x2f4),(_0x332a1d,_0x32f374)=>{const _0x16c610=_0x4ea564;if(validateAccess(_0x32f374,_0x2a5f19)[_0x16c610(0x333)]){if(pid[_0x3010cc])pid[_0x3010cc][_0x16c610(0x2fa)]({'function':_0x16c610(0x323),'args':_0x332a1d});}else logger['full'](_0x16c610(0x1ea));}),_0x56aee1['on'](_0x4ea564(0x215),(_0x1c813f,_0x326f13)=>{const _0x4666ef=_0x4ea564;if(validateAccess(_0x326f13,_0x2a5f19)[_0x4666ef(0x333)]){if(pid[_0x3010cc])pid[_0x3010cc][_0x4666ef(0x2fa)]({'function':_0x4666ef(0x319),'args':_0x1c813f});}else logger['full'](_0x4666ef(0x363));}),_0x56aee1['on'](_0x4ea564(0x25f),_0x1d647b=>{const _0x234171=_0x4ea564;if(validateAccess(_0x1d647b,_0x2a5f19)[_0x234171(0x333)]){if(pid[_0x3010cc])pid[_0x3010cc][_0x234171(0x2fa)]({'function':'resetHistory','args':null});}else logger['full'](_0x234171(0x29a));}),_0x56aee1['on'](_0x4ea564(0x29b),_0x4c5cc8=>{const _0x153978=_0x4ea564;if(validateAccess(_0x4c5cc8,_0x2a5f19)[_0x153978(0x333)]){if(pid[_0x3010cc])pid[_0x3010cc][_0x153978(0x2fa)]({'function':'getStartingBalances','args':null});}else logger['full'](_0x153978(0x2c4));}),_0x56aee1['on']('place-order',(_0x2c4508,_0x36c21a)=>{const _0x3168c5=_0x4ea564;if(validateAccess(_0x36c21a,_0x2a5f19)[_0x3168c5(0x333)]){if(pid[_0x3010cc])pid[_0x3010cc]['send']({'function':'placeOrder','args':_0x2c4508});}else logger['full'](_0x3168c5(0x286));}),_0x56aee1['on'](_0x4ea564(0x207),_0x13f006=>{const _0x6feb3a=_0x4ea564;if(validateAccess(_0x13f006,_0x2a5f19)[_0x6feb3a(0x333)]){if(pid[_0x3010cc])pid[_0x3010cc][_0x6feb3a(0x2fa)]({'function':_0x6feb3a(0x1dc),'args':null});}else logger[_0x6feb3a(0x3b5)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x56aee1['on']('show-config',_0x428827=>{const _0x5afdfe=_0x4ea564;if(validateAccess(_0x428827,_0x2a5f19)['allow']){if(pid[_0x3010cc])pid[_0x3010cc][_0x5afdfe(0x2fa)]({'function':_0x5afdfe(0x2fe),'args':null});}else logger[_0x5afdfe(0x3b5)](_0x5afdfe(0x2d5));}),_0x56aee1['on'](_0x4ea564(0x21b),_0x4f6adc=>{const _0x571f04=_0x4ea564;if(validateAccess(_0x4f6adc,_0x2a5f19)['allow'])updateBB(_0x571f04(0x241));else logger[_0x571f04(0x3b5)](_0x571f04(0x1d9));}),_0x56aee1['on'](_0x4ea564(0x284),_0x4db9f3=>{const _0x34d332=_0x4ea564;if(validateAccess(_0x4db9f3,_0x2a5f19)[_0x34d332(0x333)])getMessages();else logger[_0x34d332(0x3b5)](_0x34d332(0x328));}),_0x56aee1['on'](_0x4ea564(0x327),(_0x514a5c,_0x2865ad)=>{const _0x4f5256=_0x4ea564;if(validateAccess(_0x2865ad,_0x2a5f19)[_0x4f5256(0x333)])confirmMessage(_0x514a5c);else logger['full'](_0x4f5256(0x277));}),_0x56aee1['on'](_0x4ea564(0x3be),_0x2b2a55=>{const _0x5f022a=_0x4ea564;if(validateAccess(_0x2b2a55,_0x2a5f19)['allow']){if(devices[_0x2a5f19][_0x5f022a(0x38a)])clearTimeout(devices[_0x2a5f19]['pidRefreshToken']);if(devices[_0x2a5f19][_0x5f022a(0x23f)])clearTimeout(devices[_0x2a5f19][_0x5f022a(0x23f)]);removeSocketListeners(getClient(_0x56aee1['id'])[_0x5f022a(0x39b)]),addBlacklist(_0x2a5f19),devices[_0x2a5f19]['telegramIpApproval']=null,devices[_0x2a5f19][_0x5f022a(0x1ef)]=null,devices[_0x2a5f19][_0x5f022a(0x31e)][_0x5f022a(0x334)]=null,logger[_0x5f022a(0x22a)](_0x5f022a(0x230)+_0x2a5f19[_0x5f022a(0x387)](-0x8)),io['to'](getClient(_0x56aee1['id'])[_0x5f022a(0x39b)])[_0x5f022a(0x348)](_0x5f022a(0x311),{'access':{'allow':![],'reason':_0x5f022a(0x290),'token':null}});}else logger[_0x5f022a(0x3b5)](_0x5f022a(0x34d));});}function removeSocketListeners(_0x5a1d73){const _0x3933a8=_0x3e90d5;getClientsWithUuid(_0x5a1d73)[_0x3933a8(0x36b)](_0x4cc3a7=>{const _0x27364b=_0x3933a8;getSocket(_0x4cc3a7['id'])[_0x27364b(0x29f)]();});}function cleanSettings(){const _0x4589c3=_0x3e90d5;let _0x52f513=settings;return settings[_0x4589c3(0x23e)]&&settings[_0x4589c3(0x23e)]!=''&&(_0x52f513={..._0x52f513,'telegramToken':_0x4589c3(0x28d)}),settings[_0x4589c3(0x2f3)]&&settings[_0x4589c3(0x2f3)]!=''&&(_0x52f513={..._0x52f513,'bbPassword':_0x4589c3(0x28d)}),settings[_0x4589c3(0x2e0)]&&settings[_0x4589c3(0x2e0)]!=''&&(_0x52f513={..._0x52f513,'marketcapApi':_0x4589c3(0x28d)}),(settings['bbPassword']&&settings[_0x4589c3(0x2f3)]==_0x4589c3(0x1cb)||settings['telegramToken']&&settings[_0x4589c3(0x23e)]=='***'||settings[_0x4589c3(0x2e0)]&&settings[_0x4589c3(0x2e0)]=='***')&&(_0x52f513={..._0x52f513,'restored':{'password':settings['bbPassword']==_0x4589c3(0x1cb),'telegram':settings[_0x4589c3(0x23e)]==_0x4589c3(0x1cb),'marketcap':settings[_0x4589c3(0x2e0)]==_0x4589c3(0x1cb)}}),_0x52f513;}async function updateBB(_0x2d1f60){const _0x231da6=_0x3e90d5;await backupConfigFiles(),installingUpdate=!![],config[_0x231da6(0x36b)](_0x46c62c=>{const _0x3d1ddd=_0x231da6;restartBot(_0x46c62c[_0x3d1ddd(0x2ab)]);});if(_0x2d1f60==_0x231da6(0x241))process[_0x231da6(0x2fa)]({'update':!![],'environment':environment},_0x14aff6=>{});else _0x2d1f60==_0x231da6(0x398)&&process[_0x231da6(0x2fa)]({'reinstall':!![],'environment':environment},_0x48e1cd=>{});}function startBot(_0x1653f3,_0x4e475d,_0xbf3048){const _0x39bcd7=_0x3e90d5;if(debugging)_0x1653f3[_0x39bcd7(0x246)]('-d');let _0x431bb9=![];const _0x539db3=_0x1653f3[0x0];_0x4e475d={..._0x4e475d,'stdio':[_0x39bcd7(0x30f),_0x39bcd7(0x30f),_0x39bcd7(0x30f),_0x39bcd7(0x357)]},pid[_0x539db3]=childProcess[_0x39bcd7(0x279)](botfile,_0x1653f3,_0x4e475d),pid[_0x539db3]['on'](_0x39bcd7(0x239),_0x5ed793=>{const _0x54be5c=_0x39bcd7;switch(Object[_0x54be5c(0x234)](_0x5ed793)[0x0]){case _0x54be5c(0x233):updateBotName(_0x539db3,_0x5ed793[_0x54be5c(0x233)]);break;case'updatebotmanager':updateBotManager();break;case _0x54be5c(0x311):updateStatus(_0x539db3,_0x5ed793['status']);break;case _0x54be5c(0x381):updateLive(_0x539db3,_0x5ed793['live']);break;case _0x54be5c(0x1c8):updateLive(_0x539db3,_0x5ed793[_0x54be5c(0x1c8)]),io['to'](_0x539db3)[_0x54be5c(0x348)](_0x54be5c(0x311),{'access':{'allow':![],'reason':_0x54be5c(0x362),'token':null}});break;case _0x54be5c(0x26d):_0x5ed793[_0x54be5c(0x26d)]==_0x54be5c(0x3a8)&&restartBot(_0x539db3);_0x5ed793[_0x54be5c(0x26d)]==_0x54be5c(0x1f4)&&toggleBot(_0x539db3,_0x54be5c(0x264),'stopped');break;case _0x54be5c(0x313):sendTelegramBot(_0x539db3,_0x5ed793[_0x54be5c(0x313)]);break;case _0x54be5c(0x2aa):sendTelegramMsg(_0x5ed793[_0x54be5c(0x2aa)]);break;case'function':io['to'](_0x539db3)[_0x54be5c(0x348)](_0x5ed793[_0x54be5c(0x250)],_0x5ed793[_0x54be5c(0x22f)]);break;}}),pid[_0x539db3]['on'](_0x39bcd7(0x2a9),function(_0x4b395a){if(_0x431bb9)return;_0x431bb9=!![],_0xbf3048(_0x4b395a);}),pid[_0x539db3]['on'](_0x39bcd7(0x297),async function(_0xe46a7e){const _0xafbe01=_0x39bcd7;if(terminating)return;if(installingUpdate){logger[_0xafbe01(0x22a)](_0xafbe01(0x20c)),io[_0xafbe01(0x1d7)]();return;}if(_0x431bb9)return;_0x431bb9=!![],_0xbf3048(null);const _0x2ca993=dbConfig['get'](_0xafbe01(0x27b))[_0xafbe01(0x20b)]({'botID':_0x539db3})['value']();_0x2ca993&&(_0x2ca993['status']=='enabled'||_0x2ca993['status']==_0xafbe01(0x347))&&(await sleep(0x3e8),updateLive(_0x539db3,_0xafbe01(0x368)),logger[_0xafbe01(0x3b5)](_0xafbe01(0x222)+_0x539db3),startBot([_0x539db3,userID],{'cwd':bbpath},function(_0x52475d){const _0x1929f6=_0xafbe01;if(_0x52475d)logger[_0x1929f6(0x3b5)](_0x52475d);}));});}function stopBot(_0x2a22b4){const _0xf7a9f9=_0x3e90d5;getClientsWithBotID(_0x2a22b4)[_0xf7a9f9(0x36b)](_0x5f50ac=>{getSocket(_0x5f50ac['id'])['disconnect'](!![]),removeClient(_0x5f50ac['id']);}),pid[_0x2a22b4]&&(pid[_0x2a22b4][_0xf7a9f9(0x1f4)](),pid[_0x2a22b4]=null);}function stopAllBots(){const _0x4bb617=_0x3e90d5;terminating=!![];const _0x16913d=getEnabledBots();_0x16913d[_0x4bb617(0x36b)](_0x50042f=>{const _0x5a2f0c=_0x4bb617;stopBot(_0x50042f[_0x5a2f0c(0x2ab)]);});}function restartBot(_0x39ab79){const _0x531c26=_0x3e90d5;if(pid[_0x39ab79])pid[_0x39ab79][_0x531c26(0x1f4)]();}function addBot(){const _0x516a60=_0x3e90d5;let _0x475ef4;for(let _0x1558db=0x1;_0x1558db<0x3e9;_0x1558db++){_0x475ef4=_0x1558db[_0x516a60(0x367)]()[_0x516a60(0x369)](0x3,'0');let _0x22c2e1=config[_0x516a60(0x20b)](_0x12a5e5=>_0x12a5e5[_0x516a60(0x2ab)]==_0x475ef4);if(!_0x22c2e1)break;}if(_0x475ef4===_0x516a60(0x1f1)){logger[_0x516a60(0x3b5)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger['full'](_0x516a60(0x28a)+_0x475ef4),dbConfig['get']('bots')[_0x516a60(0x246)]({'botID':_0x475ef4,'botname':_0x516a60(0x2c0)+_0x475ef4,'status':_0x516a60(0x347),'live':''})[_0x516a60(0x3b2)](),startBot([_0x475ef4,userID],{'cwd':bbpath},function(_0x1ef8ad){const _0x190ebb=_0x516a60;if(_0x1ef8ad)logger[_0x190ebb(0x3b5)](_0x1ef8ad);}),config=getConfiguration(),io['to'](_0x516a60(0x1eb))[_0x516a60(0x348)](_0x516a60(0x27b),config),broadcastToBots(_0x516a60(0x27b),JSON[_0x516a60(0x1c6)](config));}function deleteBot(_0x765110){const _0x3650cd=_0x3e90d5;getClientsWithBotID(_0x765110)['forEach'](_0x3b4382=>{const _0x1009f7=_0x56be;getSocket(_0x3b4382['id'])[_0x1009f7(0x205)](!![]),removeClient(_0x3b4382['id']);}),dbConfig[_0x3650cd(0x27a)](_0x3650cd(0x27b))[_0x3650cd(0x3a7)]({'botID':_0x765110})[_0x3650cd(0x3b2)](),logger[_0x3650cd(0x3b5)](_0x3650cd(0x21a)+_0x765110),stopBot(_0x765110);try{if(fs['existsSync'](path[_0x3650cd(0x226)](configpath,'bot-'+_0x765110+_0x3650cd(0x3cb))))fs['unlinkSync'](path[_0x3650cd(0x226)](configpath,_0x3650cd(0x32d)+_0x765110+'-config.json'));if(fs[_0x3650cd(0x247)](path['join'](configpath,_0x3650cd(0x32d)+_0x765110+'-events.json')))fs[_0x3650cd(0x34e)](path[_0x3650cd(0x226)](configpath,_0x3650cd(0x32d)+_0x765110+_0x3650cd(0x3aa)));if(fs[_0x3650cd(0x247)](path[_0x3650cd(0x226)](configpath,_0x3650cd(0x32d)+_0x765110+_0x3650cd(0x309))))fs[_0x3650cd(0x34e)](path[_0x3650cd(0x226)](configpath,_0x3650cd(0x32d)+_0x765110+_0x3650cd(0x309)));if(fs['existsSync'](path[_0x3650cd(0x226)](configpath,_0x3650cd(0x32d)+_0x765110+'-results.json')))fs[_0x3650cd(0x34e)](path[_0x3650cd(0x226)](configpath,_0x3650cd(0x32d)+_0x765110+'-results.json'));}catch(_0x3df76f){if(_0x3df76f)logger['full']('Error\x20while\x20deleting\x20config\x20files:\x20',_0x3df76f);}config=getConfiguration(),io['to'](_0x3650cd(0x1eb))[_0x3650cd(0x348)](_0x3650cd(0x27b),config),broadcastToBots(_0x3650cd(0x27b),JSON[_0x3650cd(0x1c6)](config));}function toggleBot(_0x543434,_0x59e688,_0x273622){const _0x3da317=_0x3e90d5;dbConfig[_0x3da317(0x27a)](_0x3da317(0x27b))[_0x3da317(0x20b)]({'botID':_0x543434})[_0x3da317(0x306)]({'status':_0x59e688})[_0x3da317(0x306)]({'live':_0x273622})[_0x3da317(0x3b2)]();if(_0x59e688==_0x3da317(0x397)||_0x59e688==_0x3da317(0x347))logger[_0x3da317(0x3b5)](_0x3da317(0x2d6)+_0x543434),startBot([_0x543434,userID],{'cwd':bbpath},function(_0x48dd0c){const _0x5f08c7=_0x3da317;if(_0x48dd0c)logger[_0x5f08c7(0x3b5)](_0x48dd0c);});else(_0x59e688=='disabled'||_0x59e688=='new-disabled')&&(logger[_0x3da317(0x3b5)]('Disabled\x20Bot\x20'+_0x543434),stopBot(_0x543434));config=getConfiguration(),io['to'](_0x3da317(0x1eb))[_0x3da317(0x348)](_0x3da317(0x27b),config),broadcastToBots(_0x3da317(0x27b),JSON[_0x3da317(0x1c6)](config));}function toggleStatus(_0x2a9a3c){const _0xaa82ae=_0x3e90d5;let _0x2a8b90=dbConfig[_0xaa82ae(0x27a)](_0xaa82ae(0x27b))[_0xaa82ae(0x20b)]({'botID':_0x2a9a3c})[_0xaa82ae(0x28c)](),_0x3cca2d;if(_0x2a8b90[_0xaa82ae(0x311)]===_0xaa82ae(0x397))_0x3cca2d='disabled';else{if(_0x2a8b90['status']===_0xaa82ae(0x347))_0x3cca2d=_0xaa82ae(0x3c5);else{if(_0x2a8b90['status']==='new-disabled')_0x3cca2d='new';else{if(_0x2a8b90[_0xaa82ae(0x311)]===_0xaa82ae(0x264))_0x3cca2d=_0xaa82ae(0x397);}}}return _0x3cca2d;}function updateStatus(_0x224dfd,_0xe9e44){const _0x40aeac=_0x3e90d5;dbConfig[_0x40aeac(0x27a)](_0x40aeac(0x27b))[_0x40aeac(0x20b)]({'botID':_0x224dfd})[_0x40aeac(0x306)]({'status':_0xe9e44})['write'](),config=getConfiguration(),io['to'](_0x40aeac(0x1eb))[_0x40aeac(0x348)]('bots',config),broadcastToBots(_0x40aeac(0x27b),JSON['stringify'](config));}function updateLive(_0x385d27,_0x1b4d85){const _0x5a532e=_0x3e90d5;dbConfig['get'](_0x5a532e(0x27b))[_0x5a532e(0x20b)]({'botID':_0x385d27})[_0x5a532e(0x306)]({'live':_0x1b4d85})[_0x5a532e(0x3b2)](),config=getConfiguration(),io['to']('botmanager')[_0x5a532e(0x348)](_0x5a532e(0x27b),config),broadcastToBots(_0x5a532e(0x27b),JSON[_0x5a532e(0x1c6)](config));}function updateBotName(_0x5c1ceb,_0x332d6a){const _0x291840=_0x3e90d5;dbConfig[_0x291840(0x27a)](_0x291840(0x27b))[_0x291840(0x20b)]({'botID':_0x5c1ceb})[_0x291840(0x306)]({'botname':_0x332d6a})[_0x291840(0x3b2)](),config=getConfiguration(),io['to'](_0x291840(0x1eb))[_0x291840(0x348)](_0x291840(0x27b),config),broadcastToBots('bots',JSON[_0x291840(0x1c6)](config));}function updateBotManager(){const _0x1e403d=_0x3e90d5;config=getConfiguration(),io['to'](_0x1e403d(0x1eb))[_0x1e403d(0x348)]('bots',config),broadcastToBots(_0x1e403d(0x27b),JSON[_0x1e403d(0x1c6)](config));}function toggleBotMode(_0x39eddd){const _0x1003f0=_0x3e90d5;if(pid[_0x39eddd])pid[_0x39eddd][_0x1003f0(0x2fa)]({'function':_0x1003f0(0x2cf),'args':null});else{const _0x421ce0=configpath+_0x1003f0(0x32d)+_0x39eddd+'-config.json',_0x4c6a2d=fs['readFileSync'](_0x421ce0),_0x1e5def=JSON[_0x1003f0(0x316)](_0x4c6a2d),_0x5f0602=_0x1e5def[_0x1003f0(0x337)][0x0][_0x1003f0(0x1cf)];_0x1e5def[_0x1003f0(0x337)][0x0][_0x1003f0(0x1cf)]=!_0x5f0602;const _0x23ece6=JSON[_0x1003f0(0x1c6)](_0x1e5def,null,0x2);fs['writeFileSync'](_0x421ce0,_0x23ece6),config=getConfiguration(),io['to'](_0x1003f0(0x1eb))[_0x1003f0(0x348)](_0x1003f0(0x27b),config),broadcastToBots(_0x1003f0(0x27b),JSON[_0x1003f0(0x1c6)](config));}}function validateTelegram(_0x485e3a){const _0x1f386c=_0x3e90d5;if(_0x485e3a['from'][_0x1f386c(0x270)]!=settings['telegramUsername']&&'@'+_0x485e3a['from'][_0x1f386c(0x270)]!=settings['telegramUsername']||_0x485e3a[_0x1f386c(0x36f)]['id']!=settings[_0x1f386c(0x20d)])return sendTelegram(_0x485e3a[_0x1f386c(0x36f)]['id'],_0x1f386c(0x25e),{'parse_mode':_0x1f386c(0x216)}),![];return!![];}async function initTelegram(){const _0x403d7b=_0x3e90d5;if(tgBot)tgBot[_0x403d7b(0x26d)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x403d7b(0x23e)]);let _0x16709e=_0x403d7b(0x390);_0x16709e+='\x0a',_0x16709e+=_0x403d7b(0x21f),_0x16709e+=_0x403d7b(0x2e9),_0x16709e+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x16709e+=_0x403d7b(0x339),_0x16709e+=_0x403d7b(0x255),_0x16709e+=_0x403d7b(0x2c6),_0x16709e+=_0x403d7b(0x2cc),_0x16709e+=_0x403d7b(0x3af),_0x16709e+=_0x403d7b(0x3c9),_0x16709e+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x16709e+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x16709e+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x16709e+=_0x403d7b(0x391),_0x16709e+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x501652='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x501652+='\x0a',_0x501652+=_0x16709e,tgBot[_0x403d7b(0x1db)]((_0x3ce40c,_0xb1364a)=>{const _0x2c0c93=_0x403d7b;logger[_0x2c0c93(0x296)](getTimeStamp()+_0x2c0c93(0x3b9)),logger['debug'](_0x2c0c93(0x25c),_0x3ce40c);}),tgBot[_0x403d7b(0x237)](async(_0x394304,_0x53d0f4)=>{const _0x32237f=_0x403d7b;if(!(!settings['telegramChatId']&&_0x394304[_0x32237f(0x241)][_0x32237f(0x239)]['text']==_0x32237f(0x2f5))){if(!validateTelegram(_0x394304))return;}_0x53d0f4();}),tgBot[_0x403d7b(0x2ff)](_0x403d7b(0x39e),async _0x289f10=>{const _0xdf4aa8=_0x403d7b;if(!settings[_0xdf4aa8(0x20d)])updateSetting(_0xdf4aa8(0x20d),_0x289f10[_0xdf4aa8(0x36f)]['id']);updateSetting(_0xdf4aa8(0x3c0),!![]);if(!validateTelegram(_0x289f10))return;await sendTelegram(_0x289f10['chat']['id'],_0x501652);}),tgBot[_0x403d7b(0x2ff)](_0x403d7b(0x30b),async _0x306cb0=>{const _0x47f358=_0x403d7b;updateSetting(_0x47f358(0x3c0),!![]),await sendTelegram(_0x306cb0['chat']['id'],'Notifications\x20enabled');}),tgBot['command'](_0x403d7b(0x34b),async _0x399035=>{const _0x370f7d=_0x403d7b;await sendTelegram(_0x399035[_0x370f7d(0x36f)]['id'],_0x370f7d(0x38d)),updateSetting(_0x370f7d(0x3c0),![]);}),tgBot['command'](_0x403d7b(0x28f),async _0x35d22f=>{const _0x93d8e7=_0x403d7b,_0x43fafd=Markup['inlineKeyboard']([Markup[_0x93d8e7(0x379)][_0x93d8e7(0x26e)](_0x93d8e7(0x1de),'config_orders'),Markup[_0x93d8e7(0x379)][_0x93d8e7(0x26e)](_0x93d8e7(0x2e4),_0x93d8e7(0x378)),Markup[_0x93d8e7(0x379)][_0x93d8e7(0x26e)](_0x93d8e7(0x3d4),_0x93d8e7(0x35e))]);_0x35d22f[_0x93d8e7(0x389)](_0x93d8e7(0x2b8),_0x43fafd);}),tgBot[_0x403d7b(0x253)]('config_orders',async _0x62a25f=>{const _0x5ce70b=_0x403d7b;_0x62a25f[_0x5ce70b(0x287)](),updateSetting(_0x5ce70b(0x288),_0x5ce70b(0x202)),updateSetting(_0x5ce70b(0x3c0),!![]),await sendTelegram(_0x62a25f[_0x5ce70b(0x36f)]['id'],_0x5ce70b(0x1f0));}),tgBot['action'](_0x403d7b(0x378),async _0x108817=>{const _0x424d5c=_0x403d7b;_0x108817['editMessageReplyMarkup'](),updateSetting(_0x424d5c(0x288),_0x424d5c(0x280)),updateSetting(_0x424d5c(0x3c0),!![]),await sendTelegram(_0x108817[_0x424d5c(0x36f)]['id'],_0x424d5c(0x307));}),tgBot[_0x403d7b(0x253)](_0x403d7b(0x35e),async _0x2d9d78=>{const _0x28624b=_0x403d7b;_0x2d9d78[_0x28624b(0x287)](),updateSetting(_0x28624b(0x288),_0x28624b(0x350)),updateSetting(_0x28624b(0x3c0),!![]),await sendTelegram(_0x2d9d78[_0x28624b(0x36f)]['id'],_0x28624b(0x231));}),tgBot[_0x403d7b(0x2ff)](_0x403d7b(0x311),async _0x134b1d=>{const _0x27c9f8=_0x403d7b,_0x5abc43=getBotsWithMode();let _0x4d702b=_0x27c9f8(0x340);config[_0x27c9f8(0x36b)](_0x2d60e6=>{const _0x2cd667=_0x27c9f8,_0x534742=_0x5abc43[_0x2cd667(0x20b)](_0x2a1320=>_0x2a1320[_0x2cd667(0x2ab)]==_0x2d60e6[_0x2cd667(0x2ab)])['mode'];_0x4d702b+=_0x2cd667(0x2c0)+_0x2d60e6[_0x2cd667(0x2ab)]+':\x20'+_0x2d60e6['status']+_0x2cd667(0x293)+_0x534742+_0x2cd667(0x293)+_0x2d60e6['live']+'\x0a';}),_0x4d702b+='\x0a',_0x4d702b+=_0x27c9f8(0x1df),_0x4d702b+=!settings[_0x27c9f8(0x3c0)]?'Notifications\x20disabled\x0a':_0x27c9f8(0x2df),_0x4d702b+=settings['telegramEnabled']?settings[_0x27c9f8(0x288)]==_0x27c9f8(0x350)?_0x27c9f8(0x32e):_0x27c9f8(0x3ab)+settings['telegramEvents']+'\x20only\x0a':'',await sendTelegram(_0x134b1d['chat']['id'],_0x4d702b,{'parse_mode':_0x27c9f8(0x216)});}),tgBot['command'](_0x403d7b(0x3a8),async _0x3dc269=>{const _0x36014d=_0x403d7b,_0x5594cd=getEnabledBots();if(_0x5594cd[_0x36014d(0x285)]==0x0)await sendTelegram(_0x3dc269[_0x36014d(0x36f)]['id'],_0x36014d(0x346));else{if(_0x5594cd[_0x36014d(0x285)]>0x1)_0x5594cd['push']({'botID':'all'});let _0x5a0fd2=[],_0x35c509=[];const _0x2869f7=_0x5594cd['length']%0x4==0x0||_0x5594cd[_0x36014d(0x285)]%0x4==0x3||_0x5594cd['length']%0x3==0x1?0x4:0x3;let _0x9b4bcb=0x0;_0x5594cd['forEach']((_0x1b2d87,_0x5c9d61)=>{const _0x4cc3f9=_0x36014d;if(_0x5c9d61%_0x2869f7==0x0)_0x35c509=[];_0x35c509[_0x4cc3f9(0x246)](Markup[_0x4cc3f9(0x379)][_0x4cc3f9(0x26e)](_0x1b2d87['botID']==_0x4cc3f9(0x350)?_0x4cc3f9(0x2c9):'Bot\x20'+_0x1b2d87[_0x4cc3f9(0x2ab)],_0x4cc3f9(0x2a4)+_0x1b2d87[_0x4cc3f9(0x2ab)])),_0x5c9d61%_0x2869f7==0x0&&(_0x5a0fd2[_0x9b4bcb]=_0x35c509,_0x9b4bcb++);});const _0x4399a0=Markup[_0x36014d(0x312)](_0x5a0fd2);_0x3dc269[_0x36014d(0x389)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x4399a0);}}),tgBot[_0x403d7b(0x253)](/restart_(.+)/,async _0x5b5aaa=>{const _0x4360b2=_0x403d7b,_0x73d509=_0x5b5aaa[_0x4360b2(0x238)][0x1];_0x5b5aaa['editMessageReplyMarkup'](),_0x73d509=='all'?config[_0x4360b2(0x36b)](_0x43a201=>{const _0x2b8216=_0x4360b2;restartBot(_0x43a201[_0x2b8216(0x2ab)]);}):restartBot(_0x73d509);}),tgBot[_0x403d7b(0x2ff)]('on',async _0x2b69f6=>{const _0x2e7b6c=_0x403d7b,_0x199ff8=getDisabledBots();if(_0x199ff8[_0x2e7b6c(0x285)]==0x0)await sendTelegram(_0x2b69f6[_0x2e7b6c(0x36f)]['id'],_0x2e7b6c(0x31d));else{if(_0x199ff8[_0x2e7b6c(0x285)]>0x1)_0x199ff8['push']({'botID':_0x2e7b6c(0x350)});let _0x11fbca=[],_0x38b027=[];const _0x554923=_0x199ff8[_0x2e7b6c(0x285)]%0x4==0x0||_0x199ff8[_0x2e7b6c(0x285)]%0x4==0x3||_0x199ff8[_0x2e7b6c(0x285)]%0x3==0x1?0x4:0x3;let _0x597742=0x0;_0x199ff8[_0x2e7b6c(0x36b)]((_0x2a5ce6,_0x50f0e5)=>{const _0x175342=_0x2e7b6c;if(_0x50f0e5%_0x554923==0x0)_0x38b027=[];_0x38b027['push'](Markup[_0x175342(0x379)][_0x175342(0x26e)](_0x2a5ce6[_0x175342(0x2ab)]==_0x175342(0x350)?_0x175342(0x2c9):_0x175342(0x2c0)+_0x2a5ce6[_0x175342(0x2ab)],_0x175342(0x24d)+_0x2a5ce6['botID'])),_0x50f0e5%_0x554923==0x0&&(_0x11fbca[_0x597742]=_0x38b027,_0x597742++);});const _0x2d0a58=Markup[_0x2e7b6c(0x312)](_0x11fbca);_0x2b69f6[_0x2e7b6c(0x389)](_0x2e7b6c(0x314),_0x2d0a58);}}),tgBot[_0x403d7b(0x253)](/on_(.+)/,async _0x3a1a28=>{const _0x5e426d=_0x403d7b,_0x1275c7=_0x3a1a28[_0x5e426d(0x238)][0x1];_0x3a1a28[_0x5e426d(0x287)]();if(_0x1275c7=='all'){const _0x3b1ad1=getDisabledBots();await sendTelegram(_0x3a1a28[_0x5e426d(0x36f)]['id'],_0x5e426d(0x1fe)),_0x3b1ad1[_0x5e426d(0x36b)](_0x3367f4=>{const _0x3f9b95=_0x5e426d;if(_0x3367f4['botID']!=_0x3f9b95(0x350))toggleBot(_0x3367f4['botID'],toggleStatus(_0x3367f4[_0x3f9b95(0x2ab)]),_0x3f9b95(0x368));});}else await sendTelegram(_0x3a1a28[_0x5e426d(0x36f)]['id'],_0x5e426d(0x24c)+_0x1275c7),toggleBot(_0x1275c7,toggleStatus(_0x1275c7),'stopped');}),tgBot['command'](_0x403d7b(0x322),async _0x281a9d=>{const _0x78b975=_0x403d7b,_0x22320e=getEnabledBots();if(_0x22320e[_0x78b975(0x285)]==0x0)await sendTelegram(_0x281a9d[_0x78b975(0x36f)]['id'],_0x78b975(0x346));else{if(_0x22320e[_0x78b975(0x285)]>0x1)_0x22320e[_0x78b975(0x246)]({'botID':_0x78b975(0x350)});let _0x31629f=[],_0x4178c6=[];const _0x35e503=_0x22320e['length']%0x4==0x0||_0x22320e[_0x78b975(0x285)]%0x4==0x3||_0x22320e['length']%0x3==0x1?0x4:0x3;let _0x4b7e79=0x0;_0x22320e[_0x78b975(0x36b)]((_0x1fb20c,_0x1e7b62)=>{const _0x3a50f6=_0x78b975;if(_0x1e7b62%_0x35e503==0x0)_0x4178c6=[];_0x4178c6[_0x3a50f6(0x246)](Markup[_0x3a50f6(0x379)][_0x3a50f6(0x26e)](_0x1fb20c[_0x3a50f6(0x2ab)]=='all'?_0x3a50f6(0x2c9):'Bot\x20'+_0x1fb20c['botID'],'off_'+_0x1fb20c[_0x3a50f6(0x2ab)])),_0x1e7b62%_0x35e503==0x0&&(_0x31629f[_0x4b7e79]=_0x4178c6,_0x4b7e79++);});const _0x53ee0c=Markup['inlineKeyboard'](_0x31629f);_0x281a9d[_0x78b975(0x389)](_0x78b975(0x2af),_0x53ee0c);}}),tgBot[_0x403d7b(0x253)](/off_(.+)/,async _0x48499e=>{const _0x77f8b8=_0x403d7b,_0x596ced=_0x48499e['match'][0x1];_0x48499e[_0x77f8b8(0x287)]();if(_0x596ced==_0x77f8b8(0x350)){const _0x3c7daf=getEnabledBots();await sendTelegram(_0x48499e[_0x77f8b8(0x36f)]['id'],_0x77f8b8(0x2b0)),_0x3c7daf[_0x77f8b8(0x36b)](_0x988a3d=>{const _0x5b46d8=_0x77f8b8;if(_0x988a3d[_0x5b46d8(0x2ab)]!='all')toggleBot(_0x988a3d['botID'],toggleStatus(_0x988a3d[_0x5b46d8(0x2ab)]),_0x5b46d8(0x368));});}else await sendTelegram(_0x48499e[_0x77f8b8(0x36f)]['id'],_0x77f8b8(0x23c)+_0x596ced),toggleBot(_0x596ced,toggleStatus(_0x596ced),_0x77f8b8(0x368));}),tgBot[_0x403d7b(0x2ff)](_0x403d7b(0x1ed),async _0x139324=>{const _0xd5db5=_0x403d7b,_0x57b88c=getEnabledBots();if(_0x57b88c[_0xd5db5(0x285)]==0x0)await sendTelegram(_0x139324[_0xd5db5(0x36f)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x57b88c[_0xd5db5(0x285)]>0x1){let _0xeee0ab=[],_0x38f4c6=[];const _0x304dc7=_0x57b88c[_0xd5db5(0x285)]%0x4==0x0||_0x57b88c[_0xd5db5(0x285)]%0x4==0x3||_0x57b88c[_0xd5db5(0x285)]%0x3==0x1?0x4:0x3;let _0x3c520d=0x0;_0x57b88c[_0xd5db5(0x36b)]((_0x368e42,_0x30a1f2)=>{const _0x4e8b76=_0xd5db5;if(_0x30a1f2%_0x304dc7==0x0)_0x38f4c6=[];_0x38f4c6[_0x4e8b76(0x246)](Markup[_0x4e8b76(0x379)][_0x4e8b76(0x26e)](_0x4e8b76(0x2c0)+_0x368e42[_0x4e8b76(0x2ab)],_0x4e8b76(0x1d5)+_0x368e42[_0x4e8b76(0x2ab)])),_0x30a1f2%_0x304dc7==0x0&&(_0xeee0ab[_0x3c520d]=_0x38f4c6,_0x3c520d++);});const _0x296053=Markup[_0xd5db5(0x312)](_0xeee0ab);_0x139324[_0xd5db5(0x389)](_0xd5db5(0x2f8),_0x296053);}else{const _0x397f56=_0x57b88c[0x0]['botID'];if(pid[_0x397f56])pid[_0x397f56][_0xd5db5(0x2fa)]({'function':_0xd5db5(0x273),'args':null});}}}),tgBot[_0x403d7b(0x253)](/metrics_(.+)/,async _0x41ef38=>{const _0x20afc5=_0x403d7b,_0x5ae96b=_0x41ef38[_0x20afc5(0x238)][0x1];_0x41ef38[_0x20afc5(0x287)]();if(pid[_0x5ae96b])pid[_0x5ae96b][_0x20afc5(0x2fa)]({'function':_0x20afc5(0x273),'args':null});}),tgBot[_0x403d7b(0x2ff)](_0x403d7b(0x36d),async _0x13663b=>{const _0x4e722f=_0x403d7b,_0x61d5b=getEnabledBots();if(_0x61d5b[_0x4e722f(0x285)]==0x0)await sendTelegram(_0x13663b[_0x4e722f(0x36f)]['id'],_0x4e722f(0x346));else{if(_0x61d5b[_0x4e722f(0x285)]>0x1){let _0x5d45ed=[],_0x39b27a=[];const _0x3a1828=_0x61d5b['length']%0x4==0x0||_0x61d5b['length']%0x4==0x3||_0x61d5b[_0x4e722f(0x285)]%0x3==0x1?0x4:0x3;let _0x4920dd=0x0;_0x61d5b[_0x4e722f(0x36b)]((_0x58ac4c,_0x4d687e)=>{const _0x5815b3=_0x4e722f;if(_0x4d687e%_0x3a1828==0x0)_0x39b27a=[];_0x39b27a[_0x5815b3(0x246)](Markup[_0x5815b3(0x379)][_0x5815b3(0x26e)](_0x5815b3(0x2c0)+_0x58ac4c['botID'],_0x5815b3(0x39d)+_0x58ac4c[_0x5815b3(0x2ab)])),_0x4d687e%_0x3a1828==0x0&&(_0x5d45ed[_0x4920dd]=_0x39b27a,_0x4920dd++);});const _0x31ce91=Markup['inlineKeyboard'](_0x5d45ed);_0x13663b[_0x4e722f(0x389)](_0x4e722f(0x292),_0x31ce91);}else{const _0x5c4316=_0x61d5b[0x0][_0x4e722f(0x2ab)];if(pid[_0x5c4316])pid[_0x5c4316][_0x4e722f(0x2fa)]({'function':_0x4e722f(0x2c1),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0xc76f5e=>{const _0x3ced21=_0x403d7b,_0x13f76a=_0xc76f5e[_0x3ced21(0x238)][0x1];_0xc76f5e[_0x3ced21(0x287)]();if(pid[_0x13f76a])pid[_0x13f76a]['send']({'function':_0x3ced21(0x2c1),'args':null});}),tgBot[_0x403d7b(0x2ff)]('update',async _0xc29b59=>{const _0x190a83=_0x403d7b;await getMessages();if(!updateAvailable)await sendTelegram(_0xc29b59['chat']['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0xc29b59[_0x190a83(0x36f)]['id'],_0x190a83(0x209));else{const _0x51756a=Markup['inlineKeyboard']([Markup[_0x190a83(0x379)]['callback']('Yes',_0x190a83(0x3b4)),Markup[_0x190a83(0x379)][_0x190a83(0x26e)]('No',_0x190a83(0x266))]);_0xc29b59[_0x190a83(0x389)](_0x190a83(0x355),_0x51756a);}}}),tgBot[_0x403d7b(0x253)](/update_(.+)/,async _0x46d8af=>{const _0x58540a=_0x403d7b,_0x5d3e65=_0x46d8af['match'][0x1];_0x46d8af[_0x58540a(0x287)](),_0x5d3e65==_0x58540a(0x1ec)&&(await sendTelegram(_0x46d8af[_0x58540a(0x36f)]['id'],_0x58540a(0x2a7)),updateBB(_0x58540a(0x241))),_0x5d3e65=='no'&&await sendTelegram(_0x46d8af['chat']['id'],_0x58540a(0x21d));}),tgBot[_0x403d7b(0x2ff)](_0x403d7b(0x398),async _0x592907=>{const _0x5db8a3=_0x403d7b;if(!validInstallation)await sendTelegram(_0x592907[_0x5db8a3(0x36f)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x244d22=Markup[_0x5db8a3(0x312)]([Markup['button'][_0x5db8a3(0x26e)](_0x5db8a3(0x3d2),_0x5db8a3(0x2cb)),Markup['button']['callback']('No',_0x5db8a3(0x359))]);_0x592907['reply'](_0x5db8a3(0x3a4),_0x244d22);}}),tgBot[_0x403d7b(0x253)](/reinstall_(.+)/,async _0x23388c=>{const _0x1d75c4=_0x403d7b,_0x3fd7f1=_0x23388c[_0x1d75c4(0x238)][0x1];_0x23388c[_0x1d75c4(0x287)](),_0x3fd7f1=='yes'&&(await sendTelegram(_0x23388c['chat']['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x1d75c4(0x398))),_0x3fd7f1=='no'&&await sendTelegram(_0x23388c[_0x1d75c4(0x36f)]['id'],_0x1d75c4(0x38b));}),tgBot[_0x403d7b(0x2ff)]('toggle',async _0x58be36=>{const _0x4368db=_0x403d7b,_0x51ebd8=getBotsWithMode();if(_0x51ebd8['length']==0x0)await sendTelegram(_0x58be36[_0x4368db(0x36f)]['id'],_0x4368db(0x346));else{let _0x25ce98=[],_0x2b96d7=[];const _0x4da7c2=0x2;let _0x3609d9=0x0;_0x51ebd8[_0x4368db(0x36b)]((_0x5112da,_0x33aaa8)=>{const _0x3cdcec=_0x4368db;if(_0x33aaa8%_0x4da7c2==0x0)_0x2b96d7=[];_0x2b96d7[_0x3cdcec(0x246)](Markup['button'][_0x3cdcec(0x26e)](_0x3cdcec(0x2c0)+_0x5112da[_0x3cdcec(0x2ab)]+'\x20('+_0x5112da[_0x3cdcec(0x1da)]+')','toggle_'+_0x5112da[_0x3cdcec(0x2ab)])),_0x33aaa8%_0x4da7c2==0x0&&(_0x25ce98[_0x3609d9]=_0x2b96d7,_0x3609d9++);});const _0x1c7a08=Markup[_0x4368db(0x312)](_0x25ce98);_0x58be36['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x1c7a08);}}),tgBot[_0x403d7b(0x253)](/toggle_(.+)/,async _0x505a7a=>{const _0x1d8c34=_0x403d7b,_0x124849=_0x505a7a['match'][0x1];_0x505a7a['editMessageReplyMarkup']();const _0x3007e3=getBotsWithMode(),_0x18d73b=_0x3007e3[_0x1d8c34(0x20b)](_0xb414b=>_0xb414b[_0x1d8c34(0x2ab)]==_0x124849),_0x1c8848=_0x18d73b['mode']==_0x1d8c34(0x20f)?'manual':_0x1d8c34(0x20f);await sendTelegram(_0x505a7a['chat']['id'],_0x1d8c34(0x36c)+_0x124849+'\x20to\x20'+_0x1c8848+_0x1d8c34(0x335)),toggleBotMode(_0x124849);}),tgBot[_0x403d7b(0x2ff)](_0x403d7b(0x2ba),async _0x277b5f=>{const _0x577f1a=_0x403d7b;let _0x3de572='';config[_0x577f1a(0x36b)](_0x109be2=>{_0x3de572+='Bot\x20'+_0x109be2['botID']+':\x20'+_0x109be2['botname']+'\x0a';}),await sendTelegram(_0x277b5f[_0x577f1a(0x36f)]['id'],_0x3de572,{'parse_mode':_0x577f1a(0x216)});}),tgBot['command'](_0x403d7b(0x281),async _0x326e4d=>{await sendTelegram(_0x326e4d['chat']['id'],_0x16709e);}),process[_0x403d7b(0x259)]('SIGINT',()=>tgBot[_0x403d7b(0x26d)]('SIGINT')),process['once'](_0x403d7b(0x214),()=>tgBot[_0x403d7b(0x26d)](_0x403d7b(0x214))),tgBot[_0x403d7b(0x23b)]();}}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x8f82dd,_0x3b5158,_0x25309e){const _0x55c24f=_0x3e90d5;_0x25309e={..._0x25309e,'disable_web_page_preview':!![]};try{await tgBot[_0x55c24f(0x313)]['sendMessage'](_0x8f82dd,_0x3b5158,_0x25309e);}catch(_0x191843){console[_0x55c24f(0x27f)](_0x55c24f(0x31f),_0x191843);}}async function sendTelegramBot(_0x4c6e02,_0x3564ec){const _0x2d4ac2=_0x3e90d5;if(settings[_0x2d4ac2(0x3c0)]){if(settings[_0x2d4ac2(0x288)]==_0x2d4ac2(0x350)||(_0x3564ec[_0x2d4ac2(0x276)]=='error'||_0x3564ec[_0x2d4ac2(0x276)]=='warning'||_0x3564ec[_0x2d4ac2(0x276)]==_0x2d4ac2(0x274))&&settings['telegramEvents']==_0x2d4ac2(0x280)||_0x3564ec[_0x2d4ac2(0x276)]==_0x2d4ac2(0x33f)&&settings[_0x2d4ac2(0x288)]==_0x2d4ac2(0x202)){if(tgBot&&settings[_0x2d4ac2(0x20d)]){if(_0x3564ec[_0x2d4ac2(0x2bc)])await sendTelegram(settings['telegramChatId'],_0x3564ec['botname']+_0x2d4ac2(0x2b7)+_0x3564ec[_0x2d4ac2(0x1f6)]);else await sendTelegram(settings[_0x2d4ac2(0x20d)],_0x2d4ac2(0x2c0)+_0x4c6e02+_0x2d4ac2(0x2b7)+_0x3564ec[_0x2d4ac2(0x1f6)]);}}}}async function sendTelegramMsg(_0x338f19,_0x1aa611='HTML'){const _0x46ca03=_0x3e90d5;return settings[_0x46ca03(0x3c0)]&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x46ca03(0x20d)],_0x338f19,{'parse_mode':_0x1aa611}),!![]):![];}function getDeviceWithIp(_0x359b86){const _0x3710bd=_0x3e90d5;return devices[_0x3710bd(0x20b)](_0x19af03=>_0x19af03['ip']===_0x359b86);}async function temporaryAccess2FA(_0x1f7588,_0x2cd5a6){const _0x2dae53=_0x3e90d5;let _0x22a524=new Date(),_0x3b6de8=![];if(lastIpApproval){if(_0x22a524-lastIpApproval<0x1388)_0x3b6de8=!![];}lastIpApproval=new Date();if(_0x3b6de8)return;if(tgBot&&settings[_0x2dae53(0x20d)]){const _0x210e70=uuidRandom();tmpStorage[_0x210e70]={'uuid':_0x1f7588,'externalip':_0x2cd5a6};const _0x168dbd=Markup[_0x2dae53(0x312)]([Markup['button']['callback'](_0x2dae53(0x3c3),_0x2dae53(0x2dc)+_0x210e70),Markup[_0x2dae53(0x379)][_0x2dae53(0x26e)]('15\x20min',_0x2dae53(0x303)+_0x210e70),Markup[_0x2dae53(0x379)][_0x2dae53(0x26e)](_0x2dae53(0x38c),_0x2dae53(0x2b9)+_0x210e70),Markup['button'][_0x2dae53(0x26e)](_0x2dae53(0x342),_0x2dae53(0x2b5)+_0x210e70)]);await sendTelegram(settings[_0x2dae53(0x20d)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x2cd5a6)[_0x2dae53(0x353)]+'\x20?',_0x168dbd),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x34e0bc=>{const _0x313fe1=_0x2dae53,_0x3f26cf=_0x34e0bc[_0x313fe1(0x238)][0x1],_0x5a096b=_0x34e0bc['match'][0x2],{uuid:_0x46f40f,externalip:_0x1ea27a}=tmpStorage[_0x5a096b];delete tmpStorage[_0x5a096b],_0x34e0bc[_0x313fe1(0x287)](),devices[_0x46f40f][_0x313fe1(0x301)]={'clientip':_0x1ea27a,'timestamp':new Date()[_0x313fe1(0x32a)](),'expiry':_0x3f26cf},_0x3f26cf!=_0x313fe1(0x342)?(await sendTelegram(_0x34e0bc[_0x313fe1(0x36f)]['id'],_0x313fe1(0x1e2)+_0x3f26cf+'\x20minutes',{'parse_mode':_0x313fe1(0x216)}),io['to'](_0x46f40f)['emit'](_0x313fe1(0x311),{'access':{'allow':![],'reason':_0x313fe1(0x362),'token':null}})):(await sendTelegram(_0x34e0bc[_0x313fe1(0x36f)]['id'],_0x313fe1(0x1d4)),io['to'](_0x46f40f)[_0x313fe1(0x348)](_0x313fe1(0x311),{'access':{'allow':![],'reason':_0x313fe1(0x37a),'token':null}}));});}}async function loginAccess2FA(_0x15ec53,_0x500e3a){const _0x3e14e8=_0x3e90d5;if(tgBot&&settings[_0x3e14e8(0x20d)]){const _0x428bc3=uuidRandom();tmpStorage[_0x428bc3]={'uuid':_0x15ec53,'externalip':_0x500e3a};const _0x477eec=Markup[_0x3e14e8(0x312)]([Markup[_0x3e14e8(0x379)][_0x3e14e8(0x26e)](_0x3e14e8(0x380),_0x3e14e8(0x1fc)+loginExpiry+'_'+_0x428bc3),Markup[_0x3e14e8(0x379)][_0x3e14e8(0x26e)]('reject','login2fa_reject_'+_0x428bc3)]);await sendTelegram(settings[_0x3e14e8(0x20d)],_0x3e14e8(0x2d4)+normalizeIP(_0x500e3a)[_0x3e14e8(0x353)]+'\x20?',_0x477eec),tgBot[_0x3e14e8(0x253)](/login2fa_(.+)_(.+)/,async _0x22689f=>{const _0x46c630=_0x3e14e8,_0x3e1d3c=_0x22689f['match'][0x1],_0x4d2067=_0x22689f[_0x46c630(0x238)][0x2],{uuid:_0x2e140f,externalip:_0x29668a}=tmpStorage[_0x4d2067];delete tmpStorage[_0x4d2067],_0x22689f[_0x46c630(0x287)](),devices[_0x2e140f][_0x46c630(0x1ef)]={'clientip':_0x29668a,'timestamp':new Date()[_0x46c630(0x32a)](),'expiry':_0x3e1d3c},_0x3e1d3c!=_0x46c630(0x342)?(await sendTelegram(_0x22689f[_0x46c630(0x36f)]['id'],_0x46c630(0x3d0),{'parse_mode':_0x46c630(0x216)}),io['to'](_0x2e140f)[_0x46c630(0x348)]('status',{'access':{'allow':![],'reason':_0x46c630(0x362),'token':null}})):(await sendTelegram(_0x22689f['chat']['id'],_0x46c630(0x33a)),io['to'](_0x2e140f)[_0x46c630(0x348)](_0x46c630(0x311),{'access':{'allow':![],'reason':_0x46c630(0x382),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x354d0b=_0x3e90d5;return dbConfig[_0x354d0b(0x27a)](_0x354d0b(0x27b))[_0x354d0b(0x1e7)](_0x354d0b(0x2ab))[_0x354d0b(0x29d)]({'status':'enabled'})[_0x354d0b(0x28c)]()||[];}function getDisabledBots(){const _0x224c23=_0x3e90d5;return dbConfig[_0x224c23(0x27a)](_0x224c23(0x27b))[_0x224c23(0x1e7)](_0x224c23(0x2ab))[_0x224c23(0x29d)]({'status':_0x224c23(0x264)})[_0x224c23(0x28c)]()||[];}function getBotAttributes(_0x5d7594){const _0x5da507=_0x3e90d5;let _0x49e481={};const _0x79def9=configpath+_0x5da507(0x32d)+_0x5d7594+_0x5da507(0x3cb),_0x323b09=fs['existsSync'](_0x79def9);if(_0x323b09){const _0x3c9e5f=fs['readFileSync'](_0x79def9);try{const _0x2a0c3f=JSON['parse'](_0x3c9e5f),_0x1b2270=_0x2a0c3f?_0x2a0c3f['bot'][0x0][_0x5da507(0x1cf)]:![];_0x49e481['mode']=_0x1b2270?_0x5da507(0x20f):_0x5da507(0x1f5),_0x49e481[_0x5da507(0x233)]=_0x2a0c3f?_0x2a0c3f['bot'][0x0][_0x5da507(0x233)]:'Bot\x20'+_0x5d7594;}catch(_0x1e6fc6){_0x49e481[_0x5da507(0x1da)]=_0x5da507(0x1f5),_0x49e481[_0x5da507(0x233)]=_0x5da507(0x2c0)+_0x5d7594;}}else _0x49e481[_0x5da507(0x1da)]=_0x5da507(0x1f5),_0x49e481['botname']=_0x5da507(0x2c0)+_0x5d7594;return _0x49e481;}function getBotsWithMode(){const _0xc32f3c=_0x3e90d5,_0x5b0e88=dbConfig[_0xc32f3c(0x27a)](_0xc32f3c(0x27b))['sortBy'](_0xc32f3c(0x2ab))[_0xc32f3c(0x28c)]()||[];return _0x5b0e88[_0xc32f3c(0x36b)](_0xa7e59=>{const _0x3ef4b5=_0xc32f3c;let _0x1cdc47=getBotAttributes(_0xa7e59[_0x3ef4b5(0x2ab)]);_0xa7e59[_0x3ef4b5(0x1da)]=_0x1cdc47[_0x3ef4b5(0x1da)];}),_0x5b0e88;}function getBotExchanges(){const _0x49bd71=_0x3e90d5;let _0x311574=[];const _0xb84fd2=dbConfig['get'](_0x49bd71(0x27b))[_0x49bd71(0x1e7)](_0x49bd71(0x2ab))['value']()||[];_0xb84fd2[_0x49bd71(0x36b)](_0x4f0465=>{const _0x11a7e1=_0x49bd71;if(_0x4f0465['status']==_0x11a7e1(0x397)){const _0x25fea8=configpath+_0x11a7e1(0x32d)+_0x4f0465[_0x11a7e1(0x2ab)]+_0x11a7e1(0x3cb),_0x1a971e=fs[_0x11a7e1(0x247)](_0x25fea8);let _0x11858d;if(_0x1a971e){const _0x13eee9=fs['readFileSync'](_0x25fea8);try{const _0x18c8c6=JSON[_0x11a7e1(0x316)](_0x13eee9);_0x11858d=_0x18c8c6?_0x18c8c6[_0x11a7e1(0x337)][0x0][_0x11a7e1(0x27d)]:null;}catch(_0xc1f87a){}}if(_0x11858d)_0x311574[_0x11a7e1(0x246)](_0x11858d);}});const _0x2773a6=[...new Set(_0x311574)][_0x49bd71(0x248)]();return _0x2773a6;}async function initUser(){const _0x828e84=_0x3e90d5;if(!settings[_0x828e84(0x2ef)]){const _0x348512=uuidRandom();mixpanel['alias'](_0x348512),updateSetting(_0x828e84(0x2ef),_0x348512);}}async function initSecure(){const _0xbb41fe=_0x3e90d5;let _0x55300e=getSecure();if(!_0x55300e[_0xbb41fe(0x1e1)](_0xbb41fe(0x29c))){let _0x2837ea=await generateKeys();_0x55300e[_0xbb41fe(0x377)]=_0x2837ea['publicKey'],_0x55300e[_0xbb41fe(0x2bf)]=_0x2837ea['privateKey'],_0x55300e[_0xbb41fe(0x29c)]=crypto[_0xbb41fe(0x30a)](0x20)[_0xbb41fe(0x367)](_0xbb41fe(0x22d));;storeSecure(_0x55300e);}}function getSettings(){const _0xba1880=_0x3e90d5;return dbSettings[_0xba1880(0x27a)](_0xba1880(0x3b3))[_0xba1880(0x28c)]()||{};}function getSecure(){const _0x23cd6c=_0x3e90d5;return dbSecure['get']('secure')[_0x23cd6c(0x28c)]()||{};}function getBlacklist(){const _0xc9a359=_0x3e90d5;return dbSecure[_0xc9a359(0x27a)](_0xc9a359(0x3c1))['value']()||[];}function broadcastToBots(_0x5156ca,_0x59c15d){const _0xc928a6=_0x3e90d5;config[_0xc928a6(0x36b)](_0x1365f8=>{const _0x563791=_0xc928a6;if(_0x1365f8[_0x563791(0x311)]=='enabled'&&_0x1365f8['live']==_0x563791(0x315)||_0x1365f8[_0x563791(0x311)]==_0x563791(0x347)&&_0x1365f8[_0x563791(0x381)]==_0x563791(0x315)){if(pid[_0x1365f8['botID']])pid[_0x1365f8[_0x563791(0x2ab)]]['send']({[_0x5156ca]:_0x59c15d});}});}async function storeSettings(_0x286756,_0xa291f3=![]){const _0x58b2c8=_0x3e90d5;_0x286756={...settings,..._0x286756};if(_0xa291f3&&_0x286756[_0x58b2c8(0x2f3)]!=_0x58b2c8(0x28d)&&_0x286756['bbPassword']!=_0x58b2c8(0x1cb)&&_0x286756[_0x58b2c8(0x2f3)]!=''){const _0x42ea25=crypt[_0x58b2c8(0x1d2)](secure[_0x58b2c8(0x2bf)],_0x286756[_0x58b2c8(0x2f3)])[_0x58b2c8(0x239)][_0x58b2c8(0x324)](_0x58b2c8(0x394))[0x0],_0x2c7dea=bcrypt[_0x58b2c8(0x272)](_0x42ea25,saltRounds);_0x286756={..._0x286756,'bbPassword':_0x2c7dea};}if(_0xa291f3&&_0x286756['telegramToken']!='************'&&_0x286756[_0x58b2c8(0x23e)]!=_0x58b2c8(0x1cb)&&_0x286756[_0x58b2c8(0x23e)]!=''){const _0x404e97=crypt[_0x58b2c8(0x1d2)](secure[_0x58b2c8(0x2bf)],_0x286756[_0x58b2c8(0x23e)])[_0x58b2c8(0x239)]['split'](_0x58b2c8(0x394))[0x0];_0x286756={..._0x286756,'telegramToken':_0x404e97};}if(_0xa291f3&&_0x286756['marketcapApi']!=_0x58b2c8(0x28d)&&_0x286756[_0x58b2c8(0x2e0)]!=_0x58b2c8(0x1cb)&&_0x286756[_0x58b2c8(0x2e0)]!=''){const _0x4dedce=crypt[_0x58b2c8(0x1d2)](secure[_0x58b2c8(0x2bf)],_0x286756[_0x58b2c8(0x2e0)])[_0x58b2c8(0x239)][_0x58b2c8(0x324)](_0x58b2c8(0x394))[0x0];_0x286756={..._0x286756,'marketcapApi':_0x4dedce};}const _0x2256e9=_0x286756[_0x58b2c8(0x23e)]!='************'&&_0x286756[_0x58b2c8(0x23e)]!=settings[_0x58b2c8(0x23e)]||_0x286756[_0x58b2c8(0x211)]!=settings[_0x58b2c8(0x211)],_0x1019d2=_0x286756[_0x58b2c8(0x23e)]==''||_0x286756[_0x58b2c8(0x211)]=='',_0x164952=_0x286756['marketcapApi']&&_0x286756[_0x58b2c8(0x2e0)]!=_0x58b2c8(0x28d)&&_0x286756[_0x58b2c8(0x2e0)]!=settings['telegramToken'];_0x2256e9&&(_0x286756[_0x58b2c8(0x20d)]=null,_0x286756[_0x58b2c8(0x288)]=_0x58b2c8(0x350));for(const [_0x4d7d23,_0x26173a]of Object[_0x58b2c8(0x223)](_0x286756)){if(_0x4d7d23==_0x58b2c8(0x23e)&&_0x26173a=='************'){_0x286756['telegramToken']=settings[_0x58b2c8(0x23e)];continue;};if(_0x4d7d23==_0x58b2c8(0x2f3)&&_0x26173a=='************'){_0x286756[_0x58b2c8(0x2f3)]=settings[_0x58b2c8(0x2f3)];continue;};if(_0x4d7d23==_0x58b2c8(0x2e0)&&_0x26173a=='************'){_0x286756[_0x58b2c8(0x2e0)]=settings[_0x58b2c8(0x2e0)];continue;};dbSettings['set'](_0x58b2c8(0x2f7)+_0x4d7d23,_0x26173a)[_0x58b2c8(0x3b2)]();}settings=_0x286756,io['to'](_0x58b2c8(0x1eb))[_0x58b2c8(0x348)](_0x58b2c8(0x3b3),cleanSettings()),broadcastToBots('timeshift',settings[_0x58b2c8(0x1fb)]),broadcastToBots(_0x58b2c8(0x200),settings[_0x58b2c8(0x200)]),broadcastToBots(_0x58b2c8(0x2e0),settings['marketcapApi']);if(_0x2256e9&&!_0x1019d2)initTelegram();if(_0x2256e9&&_0x1019d2)disableTelegram();getAllClients()['forEach'](_0x4f1369=>{const _0x510621=_0x58b2c8;getSocket(_0x4f1369['id'])['emit'](_0x510621(0x311),{'access':{'allow':![],'reason':'reload','token':null}});}),_0x164952&&(await sleep(0xbb8),testMarketcapApi(_0x286756[_0x58b2c8(0x2e0)]));}async function testMarketcapApi(_0xd15fc){const _0x59a8f0=_0x3e90d5,_0x3835ee=[_0x59a8f0(0x33d),_0x59a8f0(0x2d8)];try{await axios[_0x59a8f0(0x27a)]('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0xd15fc},'params':{'symbol':_0x3835ee['toString']()}});}catch(_0x18ed6b){_0x18ed6b[_0x59a8f0(0x367)]()[_0x59a8f0(0x1f7)]('status\x20code\x20401')?(io['to'](_0x59a8f0(0x1eb))['emit'](_0x59a8f0(0x2f1),_0x59a8f0(0x2b2)),logger[_0x59a8f0(0x3b5)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to'](_0x59a8f0(0x1eb))[_0x59a8f0(0x348)](_0x59a8f0(0x2f1),'CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x59a8f0(0x3b5)](_0x59a8f0(0x26f)),logger['debug']('Error\x20details:',_0x18ed6b[_0x59a8f0(0x367)]()+_0x59a8f0(0x236)+_0x18ed6b['code']));return;}logger['debug'](_0x59a8f0(0x352));}function updateSetting(_0x3b7507,_0x47f294){const _0x454b92=_0x3e90d5;dbSettings[_0x454b92(0x206)](_0x454b92(0x2f7)+_0x3b7507,_0x47f294)['write'](),settings=getSettings(),io['to']('botmanager')['emit'](_0x454b92(0x3b3),cleanSettings());}function storeSecure(_0x31bf6f){const _0x1b6574=_0x3e90d5;dbSecure[_0x1b6574(0x27a)](_0x1b6574(0x2fd))[_0x1b6574(0x246)](_0x31bf6f)[_0x1b6574(0x3b2)](),secure=_0x31bf6f;}function addBlacklist(_0x41ef0a){const _0x1cde95=_0x3e90d5;cleanBlacklist();let _0x317ce1;devices[_0x41ef0a][_0x1cde95(0x301)]?_0x317ce1=Math[_0x1cde95(0x37d)](devices[_0x41ef0a][_0x1cde95(0x301)][_0x1cde95(0x2f6)],loginExpiry):_0x317ce1=loginExpiry,dbSecure[_0x1cde95(0x27a)]('blacklist')[_0x1cde95(0x246)]({'expiry':new Date()[_0x1cde95(0x32a)]()+_0x317ce1*0x3c*0x3e8,'token':devices[_0x41ef0a][_0x1cde95(0x31e)][_0x1cde95(0x334)]})[_0x1cde95(0x3b2)](),blacklist=dbSecure[_0x1cde95(0x27a)](_0x1cde95(0x3c1))[_0x1cde95(0x28c)]();}function cleanBlacklist(){const _0x4dcd14=_0x3e90d5;let _0x2dc177=dbSecure[_0x4dcd14(0x27a)]('blacklist')[_0x4dcd14(0x25d)]()[_0x4dcd14(0x28c)](),_0x389a7c=new Date()['getTime']();_0x2dc177[_0x4dcd14(0x36b)](_0x5c1316=>{const _0x3d2b85=_0x4dcd14;_0x5c1316[_0x3d2b85(0x2f6)]<_0x389a7c&&dbSecure[_0x3d2b85(0x27a)](_0x3d2b85(0x3c1))[_0x3d2b85(0x3a7)]({'expiry':_0x5c1316['expiry']})[_0x3d2b85(0x3b2)]();});}function initStates(){const _0x3dd3a4=_0x3e90d5;let _0x422ecd=getConfiguration();_0x422ecd[_0x3dd3a4(0x36b)](_0x5c4006=>{_0x5c4006['live']='stopped';}),storeConfiguration(_0x422ecd);}function onKeys(){const _0x334c70=new RSA();return new Promise(_0x1039fd=>{const _0x1dc7dd=_0x56be;_0x334c70[_0x1dc7dd(0x261)]()[_0x1dc7dd(0x2de)](_0x277d8c=>{_0x1039fd(_0x277d8c);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0xab9004=_0x3e90d5;let _0x784cd=getSettings(),_0x2836f9=![];!_0x784cd['hasOwnProperty'](_0xab9004(0x2ca))&&(_0x784cd[_0xab9004(0x2ca)]=0x0,_0x2836f9=!![]);!_0x784cd[_0xab9004(0x1e1)](_0xab9004(0x24a))&&(_0x784cd['lastmsgemitted']=0x0,_0x2836f9=!![]);!_0x784cd[_0xab9004(0x1e1)](_0xab9004(0x24f))&&(_0x784cd[_0xab9004(0x24f)]=_0xab9004(0x271),_0x2836f9=!![]);!_0x784cd['hasOwnProperty'](_0xab9004(0x200))&&(_0x784cd[_0xab9004(0x200)]=![],_0x2836f9=!![]);!_0x784cd[_0xab9004(0x1e1)](_0xab9004(0x2e0))&&(_0x784cd[_0xab9004(0x2e0)]='',_0x2836f9=!![]);if(_0x2836f9)storeSettings(_0x784cd);try{fs[_0xab9004(0x2db)](configbackuppath,{'withFileTypes':!![]})[_0xab9004(0x36b)](_0x15de65=>{const _0x136e90=_0xab9004;if(!_0x15de65[_0x136e90(0x331)]()){if(!_0x15de65[_0x136e90(0x2d7)][_0x136e90(0x2d9)](_0x136e90(0x3c6)))fs[_0x136e90(0x34e)](configbackuppath+_0x15de65[_0x136e90(0x2d7)]);}else fs[_0x136e90(0x28e)](configbackuppath+_0x15de65['name'],{'recursive':!![]});});}catch(_0xf03e4c){logger[_0xab9004(0x22a)]('Error\x20removing\x20old\x20backup\x20files:',_0xf03e4c);}}function storeConfiguration(_0x258de2){const _0x505270=_0x3e90d5;dbConfig[_0x505270(0x27a)](_0x505270(0x27b))[_0x505270(0x3a7)]()[_0x505270(0x3b2)](),dbConfig[_0x505270(0x27a)](_0x505270(0x27b))[_0x505270(0x246)](..._0x258de2)[_0x505270(0x3b2)](),config=_0x258de2;}async function resetPassword(){const _0x593670=_0x3e90d5;if(tgBot&&settings[_0x593670(0x20d)]){const _0x27de42=Markup[_0x593670(0x312)]([Markup['button'][_0x593670(0x26e)](_0x593670(0x1ec),_0x593670(0x3d6)),Markup[_0x593670(0x379)][_0x593670(0x26e)]('no',_0x593670(0x1e9))]);await sendTelegram(settings[_0x593670(0x20d)],_0x593670(0x3b7),_0x27de42),tgBot['action'](/resetpw_(.+)/,async _0xc706d3=>{const _0x4fb7bc=_0x593670,_0x2fc501=_0xc706d3[_0x4fb7bc(0x238)][0x1];_0xc706d3[_0x4fb7bc(0x287)]();if(_0x2fc501!='no'){const _0x1f32a8=0xf,_0x513ce6='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x6b4e85=Array[_0x4fb7bc(0x356)](crypto[_0x4fb7bc(0x2e6)](new Uint32Array(_0x1f32a8)))[_0x4fb7bc(0x31b)](_0x1609a0=>_0x513ce6[_0x1609a0%_0x513ce6[_0x4fb7bc(0x285)]])['join'](''),_0x4ad5d3=bcrypt[_0x4fb7bc(0x272)](_0x6b4e85,saltRounds);storeSettings({'bbPassword':_0x4ad5d3}),await sendTelegram(_0xc706d3[_0x4fb7bc(0x36f)]['id'],_0x4fb7bc(0x1dd)+_0x6b4e85,{'parse_mode':_0x4fb7bc(0x216)});}else await sendTelegram(_0xc706d3[_0x4fb7bc(0x36f)]['id'],_0x4fb7bc(0x32f));});}}async function confirmRestore(_0x4f1843,_0x45471b){const _0xa00718=_0x3e90d5;io['to']('botmanager')[_0xa00718(0x348)](_0xa00718(0x2f1),_0xa00718(0x3ba),_0xa00718(0x274));if(tgBot&&settings[_0xa00718(0x20d)]){const _0x28c0ea=uuidRandom();tmpStorage[_0x28c0ea]={'path':_0x4f1843,'filename':_0x45471b};const _0xf6c7d=Markup[_0xa00718(0x312)]([Markup[_0xa00718(0x379)]['callback'](_0xa00718(0x1ec),_0xa00718(0x30c)+_0x28c0ea),Markup[_0xa00718(0x379)][_0xa00718(0x26e)]('no',_0xa00718(0x23d)+_0x28c0ea)]);await sendTelegram(settings[_0xa00718(0x20d)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0xf6c7d),tgBot[_0xa00718(0x253)](/restore_(.+)_(.+)/,async _0x2f1a7c=>{const _0x1cd9cb=_0xa00718,_0x3b7cfc=_0x2f1a7c[_0x1cd9cb(0x238)][0x1],_0x30bd93=_0x2f1a7c['match'][0x2],{path:_0x5a9c77,filename:_0x5e0237}=tmpStorage[_0x30bd93];delete tmpStorage[_0x30bd93],_0x2f1a7c['editMessageReplyMarkup'](),_0x3b7cfc==_0x1cd9cb(0x1ec)?(logger['debug']('Restore\x20process\x20confirmed'),await sendTelegram(_0x2f1a7c[_0x1cd9cb(0x36f)]['id'],_0x1cd9cb(0x2c3),{'parse_mode':_0x1cd9cb(0x216)}),unzipFile(_0x5a9c77,_0x5e0237)):(logger['debug'](_0x1cd9cb(0x1d3)),await sendTelegram(_0x2f1a7c[_0x1cd9cb(0x36f)]['id'],_0x1cd9cb(0x1d3)));});}}function getServerTime(){const _0x2505eb=_0x3e90d5,_0x40876e=new Date();return _0x40876e[_0x2505eb(0x37b)]()+'/'+(_0x40876e['getMonth']()+0x1)[_0x2505eb(0x367)]()['padStart'](0x2,'0')+'/'+_0x40876e['getDate']()[_0x2505eb(0x367)]()['padStart'](0x2,'0')+'\x20'+_0x40876e[_0x2505eb(0x257)]()[_0x2505eb(0x367)]()['padStart'](0x2,'0')+':'+_0x40876e[_0x2505eb(0x23a)]()[_0x2505eb(0x367)]()[_0x2505eb(0x369)](0x2,'0')+':'+_0x40876e['getSeconds']()[_0x2505eb(0x367)]()[_0x2505eb(0x369)](0x2,'0');}function getTimeStamp(){const _0x4b9a91=_0x3e90d5,_0x1ec224=shiftedTime();return _0x1ec224[_0x4b9a91(0x37b)]()+'/'+(_0x1ec224[_0x4b9a91(0x3bc)]()+0x1)[_0x4b9a91(0x367)]()['padStart'](0x2,'0')+'/'+_0x1ec224['getDate']()[_0x4b9a91(0x367)]()['padStart'](0x2,'0')+'\x20'+_0x1ec224[_0x4b9a91(0x257)]()[_0x4b9a91(0x367)]()[_0x4b9a91(0x369)](0x2,'0')+':'+_0x1ec224[_0x4b9a91(0x23a)]()['toString']()['padStart'](0x2,'0')+':'+_0x1ec224[_0x4b9a91(0x2ad)]()[_0x4b9a91(0x367)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x3e4f0d=_0x3e90d5,_0x1f3fd6=shiftedTime();return _0x1f3fd6[_0x3e4f0d(0x37b)]()+(_0x1f3fd6[_0x3e4f0d(0x3bc)]()+0x1)[_0x3e4f0d(0x367)]()[_0x3e4f0d(0x369)](0x2,'0')+_0x1f3fd6[_0x3e4f0d(0x30e)]()[_0x3e4f0d(0x367)]()[_0x3e4f0d(0x369)](0x2,'0')+'-'+_0x1f3fd6[_0x3e4f0d(0x257)]()[_0x3e4f0d(0x367)]()[_0x3e4f0d(0x369)](0x2,'0')+_0x1f3fd6[_0x3e4f0d(0x23a)]()[_0x3e4f0d(0x367)]()[_0x3e4f0d(0x369)](0x2,'0')+_0x1f3fd6[_0x3e4f0d(0x2ad)]()[_0x3e4f0d(0x367)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x517245=_0x3e90d5,_0xd8cbd2=new Date();let _0x170081=_0xd8cbd2;if(settings[_0x517245(0x1fb)]&&settings[_0x517245(0x1fb)]!==0x0)_0x170081=fns[_0x517245(0x329)](_0xd8cbd2,{'hours':settings[_0x517245(0x1fb)]});return _0x170081;}function startScheduler(){const _0x440bc9=_0x3e90d5,_0x30112e=new Date()[_0x440bc9(0x267)](),_0x2dbf0f=shiftedTime()[_0x440bc9(0x257)]();_0x2dbf0f==0x4&&backupConfigFiles();_0x2dbf0f==0x0&&rotateLogFiles();_0x30112e%0x6==0x0&&triggerAnalytics();_0x30112e%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x29e367){const _0x1cc4a9=_0x3e90d5;logger[_0x1cc4a9(0x22a)](_0x1cc4a9(0x399)+_0x29e367);const _0xff152e=getBotsWithMode();_0xff152e[_0x1cc4a9(0x285)]>0x0?confirmRestore(configbackuppath,_0x29e367):unzipFile(configbackuppath,_0x29e367);}async function getBackupFiles(_0x12e94f=null){const _0x3a9164=_0x3e90d5;let _0x53a365=[],_0xa7a31=fs[_0x3a9164(0x2db)](configbackuppath,{'withFileTypes':!![]});_0xa7a31[_0x3a9164(0x248)]((_0x9d40d8,_0x4e7b8b)=>_0x9d40d8[_0x3a9164(0x2d7)]<_0x4e7b8b['name']?0x1:_0x4e7b8b[_0x3a9164(0x2d7)]<_0x9d40d8[_0x3a9164(0x2d7)]?-0x1:0x0),_0xa7a31[_0x3a9164(0x36b)](_0x2455fe=>{const _0x4ea114=_0x3a9164;if(!_0x2455fe[_0x4ea114(0x331)]()&&_0x2455fe['name'][_0x4ea114(0x2d9)](_0x4ea114(0x3c6))&&_0x2455fe[_0x4ea114(0x2d7)][_0x4ea114(0x2b3)](_0x4ea114(0x365))){const _0x55827a=formatDate(fs['statSync'](configbackuppath+_0x2455fe[_0x4ea114(0x2d7)])['mtime']);_0x53a365[_0x4ea114(0x246)]({'name':_0x2455fe['name'],'mtime':_0x55827a});}});if(_0x12e94f)io['to'](_0x12e94f)[_0x3a9164(0x348)]('backup-files',_0x53a365);else return _0x53a365;}async function backupConfigFiles(){const _0x5b59d7=_0x3e90d5;await zipFiles(_0x5b59d7(0x3c8));const _0x28388e=getCleanTimeStamp();fs[_0x5b59d7(0x33e)](zippath+'backup-full.zip',configbackuppath+(_0x5b59d7(0x3c6)+_0x28388e+_0x5b59d7(0x365)));let _0x3bf9d8=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x3bf9d8['sort']((_0x323092,_0xf25bf5)=>_0x323092[_0x5b59d7(0x2d7)]<_0xf25bf5['name']?0x1:_0xf25bf5[_0x5b59d7(0x2d7)]<_0x323092['name']?-0x1:0x0),_0x3bf9d8[_0x5b59d7(0x285)]>maxBackups&&fs[_0x5b59d7(0x34e)](configbackuppath+_0x3bf9d8[_0x3bf9d8[_0x5b59d7(0x285)]-0x1][_0x5b59d7(0x2d7)]);}function rotateLogFiles(){const _0x14252e=_0x3e90d5,_0x55ee4=fs[_0x14252e(0x240)](logspath+_0x14252e(0x1ca)),_0x591211=_0x55ee4['size']/0x400;if(_0x591211>0x64){let _0x9f6549=fs[_0x14252e(0x2db)](logspath,{'withFileTypes':!![]});_0x9f6549['sort']((_0x4e8473,_0x5124a4)=>_0x4e8473[_0x14252e(0x2d7)]<_0x5124a4[_0x14252e(0x2d7)]?0x1:_0x5124a4[_0x14252e(0x2d7)]<_0x4e8473[_0x14252e(0x2d7)]?-0x1:0x0),_0x9f6549[_0x14252e(0x36b)](_0x517d6b=>{const _0x2d2ad7=_0x14252e;if(_0x517d6b[_0x2d2ad7(0x2d7)]==_0x2d2ad7(0x3cf))fs['copyFileSync'](logspath+_0x517d6b[_0x2d2ad7(0x2d7)],logspath+_0x2d2ad7(0x39c));if(_0x517d6b[_0x2d2ad7(0x2d7)]==_0x2d2ad7(0x258))fs[_0x2d2ad7(0x33e)](logspath+_0x517d6b['name'],logspath+_0x2d2ad7(0x3cf));_0x517d6b[_0x2d2ad7(0x2d7)]==_0x2d2ad7(0x1ca)&&(fs[_0x2d2ad7(0x33e)](logspath+_0x517d6b['name'],logspath+_0x2d2ad7(0x258)),fs[_0x2d2ad7(0x220)](logspath+_0x517d6b[_0x2d2ad7(0x2d7)],''));});}}async function zipFiles(_0x3c7314){const _0x179289=_0x3e90d5;let _0x498669;if(_0x3c7314==_0x179289(0x262))_0x498669=logspath;if(_0x3c7314==_0x179289(0x1d0))_0x498669=configpath;if(_0x3c7314==_0x179289(0x3c8))_0x498669=configpath;let _0x467b7a=fs[_0x179289(0x2db)](_0x498669,{'withFileTypes':!![]});const _0x5e37bf=new require(_0x179289(0x320))();_0x467b7a[_0x179289(0x36b)](_0xc6f2b=>{const _0x2bea3f=_0x179289;if(!_0xc6f2b[_0x2bea3f(0x331)]()){let _0x5c82ee=fs[_0x2bea3f(0x2f0)](_0x498669+_0xc6f2b[_0x2bea3f(0x2d7)]);if(_0x3c7314=='backup'){const _0x338717=/^bot-[0-9]{3}-config.json$/,_0x595fe6=_0x338717[_0x2bea3f(0x392)](_0xc6f2b[_0x2bea3f(0x2d7)]);if(_0x595fe6){const _0x15941b=JSON[_0x2bea3f(0x316)](_0x5c82ee);if(_0x15941b[_0x2bea3f(0x337)][0x0]){_0x15941b[_0x2bea3f(0x337)][0x0][_0x2bea3f(0x3a6)]=_0x2bea3f(0x1cb),_0x15941b[_0x2bea3f(0x337)][0x0][_0x2bea3f(0x265)]='***';if(_0x15941b[_0x2bea3f(0x337)][0x0][_0x2bea3f(0x34f)])_0x15941b[_0x2bea3f(0x337)][0x0][_0x2bea3f(0x34f)]=_0x2bea3f(0x1cb);}_0x5c82ee=JSON[_0x2bea3f(0x1c6)](_0x15941b,null,0x2);}if(_0xc6f2b[_0x2bea3f(0x2d7)]=='bb-settings.json'){const _0x412532=JSON[_0x2bea3f(0x316)](_0x5c82ee);if(_0x412532[_0x2bea3f(0x3b3)]['loginRequired'])_0x412532['settings'][_0x2bea3f(0x364)]=![];if(_0x412532[_0x2bea3f(0x3b3)][_0x2bea3f(0x2f3)])_0x412532[_0x2bea3f(0x3b3)][_0x2bea3f(0x2f3)]=_0x2bea3f(0x1cb);if(_0x412532[_0x2bea3f(0x3b3)]['telegramToken'])_0x412532[_0x2bea3f(0x3b3)]['telegramToken']='***';if(_0x412532['settings'][_0x2bea3f(0x20d)])_0x412532['settings'][_0x2bea3f(0x20d)]=null;if(_0x412532[_0x2bea3f(0x3b3)][_0x2bea3f(0x2e0)])_0x412532[_0x2bea3f(0x3b3)]['marketcapApi']=_0x2bea3f(0x1cb);_0x5c82ee=JSON[_0x2bea3f(0x1c6)](_0x412532,null,0x2);}if(_0xc6f2b[_0x2bea3f(0x2d7)]!=_0x2bea3f(0x1e0))_0x5e37bf['file'](_0xc6f2b[_0x2bea3f(0x2d7)],_0x5c82ee);}else _0x5e37bf[_0x2bea3f(0x2ae)](_0xc6f2b[_0x2bea3f(0x2d7)],_0x5c82ee);}});const _0x179dcd=_0x5e37bf[_0x179289(0x338)]({'base64':![],'compression':_0x179289(0x2be)});fs[_0x179289(0x220)](zippath+(_0x3c7314+_0x179289(0x365)),_0x179dcd,_0x179289(0x275));}async function unzipFile(_0x144aad,_0x431c42){const _0xbc3869=_0x3e90d5;fs[_0xbc3869(0x2db)](configpath,{'withFileTypes':!![]})[_0xbc3869(0x36b)](_0x1bfe1e=>{const _0x5ce2ae=_0xbc3869;if(!_0x1bfe1e[_0x5ce2ae(0x331)]())fs[_0x5ce2ae(0x28e)](configpath+_0x1bfe1e['name']);});const _0x2228e2=fs[_0xbc3869(0x2f0)](_0x144aad+_0x431c42,_0xbc3869(0x275)),_0x1cc891=new require(_0xbc3869(0x320))(_0x2228e2,{'base64':![],'checkCRC32':!![]});Object[_0xbc3869(0x234)](_0x1cc891['files'])[_0xbc3869(0x36b)](_0x5c3178=>{const _0x3d461d=_0xbc3869,_0x37a18d=_0x1cc891[_0x3d461d(0x326)][_0x5c3178];fs['writeFileSync'](configpath+_0x37a18d[_0x3d461d(0x2d7)],_0x37a18d['_data']);}),fs[_0xbc3869(0x2db)](temppath,{'withFileTypes':!![]})[_0xbc3869(0x36b)](_0x1b35a8=>{const _0x5f5b08=_0xbc3869;if(!_0x1b35a8[_0x5f5b08(0x331)]())fs['rmSync'](temppath+_0x1b35a8[_0x5f5b08(0x2d7)]);}),logger[_0xbc3869(0x22a)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0xbc3869(0x2fa)]({'restore':!![]},_0x7df130=>{});}async function getPublicIp(){const _0x70373d=_0x3e90d5;try{const _0x938e12=await axios[_0x70373d(0x27a)](_0x70373d(0x2ee));publicip=_0x938e12[_0x70373d(0x251)]['ip'];}catch(_0x45cb22){}}async function triggerAnalytics(){const _0x10b913=_0x3e90d5;if(!publicip)await getPublicIp();const _0x1bfb17=getBotsWithMode();let _0xdcad21=0x0;_0x1bfb17['forEach'](_0x448d3c=>{const _0x59b38a=_0x56be;if(_0x448d3c[_0x59b38a(0x311)]===_0x59b38a(0x397))_0xdcad21++;});const _0x1212a5=getBotExchanges();mixpanel[_0x10b913(0x252)]('Server',{'distinct_id':settings[_0x10b913(0x2ef)],'ip':publicip,'version':serverversion,'numbots':_0x1bfb17['length'],'numbotsenabled':_0xdcad21,'exchanges':_0x1212a5,'environment':environment});}async function getMessages(){const _0x1aad87=_0x3e90d5,_0x7fd6e1='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x2cfc60=new GraphQLClient(_0x7fd6e1),_0x108084={'authorization':_0x1aad87(0x21c)},_0x25f619=serverversion[_0x1aad87(0x324)]('.'),_0x31ad40=_0x25f619[0x0]+'.'+_0x25f619[0x1],_0xc15d2=Math[_0x1aad87(0x30d)](settings[_0x1aad87(0x2ca)],settings[_0x1aad87(0x24a)]),_0x37834b={'last':parseInt(_0xc15d2),'bbm':_0x31ad40},_0xd4cf21=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x35c8c2;try{_0x35c8c2=await _0x2cfc60[_0x1aad87(0x224)](_0xd4cf21,_0x37834b,_0x108084);}catch(_0x38f3c1){}if(_0x35c8c2&&_0x35c8c2[_0x1aad87(0x256)]){let _0x5cf19c=settings['lastmsgtelegram'];newMessages=[];for(const _0x554b74 of _0x35c8c2['messages']){newMessages[_0x1aad87(0x246)](_0x554b74);let _0x53d214=![];_0x554b74[_0x1aad87(0x36e)]&&(updateSetting(_0x1aad87(0x24f),_0x554b74[_0x1aad87(0x36e)]),_0x53d214=isNewerVersion(serverversion,_0x554b74[_0x1aad87(0x36e)])||serverversion==_0x554b74[_0x1aad87(0x36e)]);if(!_0x53d214&&_0x554b74[_0x1aad87(0x2b6)]>_0x5cf19c){if(_0x554b74[_0x1aad87(0x221)]===_0x1aad87(0x3b0)||serverversion['startsWith'](_0x554b74[_0x1aad87(0x221)])){let _0x3fc0a2=''+_0x554b74[_0x1aad87(0x341)]+'\x0a\x0a'+_0x554b74[_0x1aad87(0x239)];const _0x61d171=await sendTelegramMsg(toTelegramMarkdown(_0x3fc0a2),_0x1aad87(0x20a));if(_0x61d171)_0x5cf19c=_0x554b74[_0x1aad87(0x2b6)];}}}updateAvailable=isNewerVersion(settings[_0x1aad87(0x24f)],serverversion),updateSetting(_0x1aad87(0x2ca),_0x5cf19c),emitMessages();}}function _0x56be(_0x1ed17a,_0x450966){const _0x373c17=_0xa18a();return _0x56be=function(_0xe45cb7,_0x30f32f){_0xe45cb7=_0xe45cb7-0x1c6;let _0xa18a57=_0x373c17[_0xe45cb7];return _0xa18a57;},_0x56be(_0x1ed17a,_0x450966);}function emitMessages(){const _0x53e32c=_0x3e90d5,_0x891d7a=settings[_0x53e32c(0x24a)];let _0x518eea=[];newMessages['forEach'](_0x3a9235=>{const _0x4ecb85=_0x53e32c;_0x3a9235[_0x4ecb85(0x2b6)]>_0x891d7a&&_0x518eea[_0x4ecb85(0x246)](_0x3a9235);}),_0x518eea[_0x53e32c(0x285)]>0x0&&getAllClients()['forEach'](_0x50e23f=>{const _0x2e8564=_0x53e32c;getSocket(_0x50e23f['id'])['emit'](_0x2e8564(0x239),_0x518eea);});}function confirmMessage(_0x59dd18){updateSetting('lastmsgemitted',Number(_0x59dd18));}function isNewerVersion(_0x5f4017,_0x4d71d9){const _0x254dec=_0x3e90d5,_0x210379=_0x4d71d9[_0x254dec(0x324)]('.'),_0xfd5937=_0x5f4017[_0x254dec(0x324)]('.');for(var _0x5bc5d9=0x0;_0x5bc5d9<_0xfd5937[_0x254dec(0x285)];_0x5bc5d9++){const _0x589bd3=~~_0xfd5937[_0x5bc5d9],_0x2c09e1=~~_0x210379[_0x5bc5d9];if(_0x589bd3>_0x2c09e1)return!![];if(_0x589bd3<_0x2c09e1)return![];}return![];}function toTelegramMarkdown(_0x2d6c77){const _0x2b96ff=_0x3e90d5,_0x5864ad=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x16365b=/\*{2}(.+?)\*{2}/gim;return _0x2d6c77=_0x2d6c77['replace'](_0x5864ad,_0x2b96ff(0x28b))[_0x2b96ff(0x308)](_0x16365b,_0x2b96ff(0x39f)),_0x2d6c77;}async function validateConfigFile(){const _0x56e0ac=_0x3e90d5,_0x349b37=dbConfig[_0x56e0ac(0x27a)](_0x56e0ac(0x27b))['sortBy'](_0x56e0ac(0x2ab))['value']()||[];if(_0x349b37[_0x56e0ac(0x285)]==0x0){let _0x15fe80=0x0,_0x59989d=[];const _0x2e38ae=/^bot-([0-9]{3})-config.json$/,_0x1874bf=fs[_0x56e0ac(0x2db)](configpath);_0x1874bf[_0x56e0ac(0x36b)](_0x19ae5b=>{const _0x27d3ca=_0x56e0ac,_0x2e621b=_0x2e38ae[_0x27d3ca(0x385)](_0x19ae5b);if(_0x2e621b){const _0x529481=_0x2e621b[0x1];let _0x3556a8=getBotAttributes(_0x529481);_0x59989d[_0x27d3ca(0x246)]({'botID':_0x529481,'botname':_0x3556a8[_0x27d3ca(0x233)],'status':_0x27d3ca(0x264),'live':_0x27d3ca(0x368)}),_0x15fe80++;}}),_0x15fe80!=0x0&&(dbConfig[_0x56e0ac(0x27a)](_0x56e0ac(0x27b))[_0x56e0ac(0x306)](_0x59989d)[_0x56e0ac(0x3b2)](),config=_0x59989d,restoredConfigFile=_0x15fe80);}}async function restoreConfigNotify(_0x5d97b9){const _0x3203be=_0x3e90d5;let _0x312db1;if(restoredConfigFile==0x1)_0x312db1=_0x3203be(0x1e3);else _0x312db1=_0x3203be(0x2f2);if(_0x5d97b9)io['to'](_0x3203be(0x1eb))[_0x3203be(0x348)](_0x3203be(0x2f1),_0x312db1);else{logger[_0x3203be(0x296)](_0x3203be(0x2eb)),logger[_0x3203be(0x296)](_0x312db1),logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x3203be(0x296)]('');if(tgBot&&settings[_0x3203be(0x20d)]&&settings[_0x3203be(0x288)]!='orders')await sendTelegram(settings[_0x3203be(0x20d)],_0x3203be(0x344)+_0x312db1);}}function validateCredentials(_0x5390fb,_0x32968c){const _0x16715c=_0x3e90d5;if(_0x5390fb[_0x16715c(0x270)]==settings[_0x16715c(0x3bd)]&&bcrypt[_0x16715c(0x1e6)](_0x5390fb[_0x16715c(0x2e8)],settings['bbPassword'])){if(settings[_0x16715c(0x1d8)])return{'allow':![],'reason':_0x16715c(0x37e),'token':null};else{const _0x19e41e=generateLoginToken(_0x32968c);return{'allow':!![],'reason':_0x16715c(0x304),'token':_0x19e41e};}}else return{'allow':![],'reason':_0x16715c(0x375),'token':null};}function refreshToken(_0x948aeb){const _0x38938b=_0x3e90d5,_0x58ddd0=generateLoginToken(_0x948aeb);return{'allow':!![],'reason':_0x38938b(0x304),'token':_0x58ddd0};}function validateAccess(_0x25e240,_0x3b14b7,_0x25b4ac){const _0x3dd7eb=_0x3e90d5,_0x2671f0=_0x25b4ac?_0x25b4ac:devices[_0x3b14b7]['ip'];let _0x8271d5;const _0x37a0f2=_0x4244dc=>{const _0x5a11fd=_0x56be;if(settings[_0x5a11fd(0x364)]){if(settings[_0x5a11fd(0x1d8)]){if(telegram2FaApproved(_0x3b14b7)){const _0x11cd27=generateLoginToken(_0x3b14b7);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x11cd27};}else return{'allow':![],'reason':_0x5a11fd(0x2d3),'token':null};}else return _0x8271d5=validToken(_0x4244dc,_0x3b14b7),_0x8271d5['hasOwnProperty']('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x4244dc}:{'allow':![],'reason':_0x5a11fd(0x2d3),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings['whitelistEnabled']){let _0x5d78fc=[...settings['whitelist'],_0x3dd7eb(0x3a2),_0x3dd7eb(0x21e),_0x3dd7eb(0x2fc)];if(_0x5d78fc[_0x3dd7eb(0x1f7)](_0x2671f0))return _0x37a0f2(_0x25e240);else{_0x8271d5=validToken(_0x25e240,_0x3b14b7);if(_0x8271d5[_0x3dd7eb(0x1e1)](_0x3dd7eb(0x274)))return _0x37a0f2(_0x25e240);else{if(telegramIpApproved(_0x3b14b7)){const _0x2e7018=generateToken(_0x3b14b7);return _0x8271d5=_0x37a0f2(_0x25e240),_0x8271d5[_0x3dd7eb(0x333)]?{'allow':!![],'reason':_0x3dd7eb(0x3a9),'token':_0x2e7018}:_0x8271d5;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x3dd7eb(0x310),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x37a0f2(_0x25e240);}function timelyDecrypt(_0x321073,_0x580493,_0xcd78be='@'){const _0x4becf0=_0x3e90d5;if(_0x321073)try{const _0x5c5963=crypt[_0x4becf0(0x1d2)](secure[_0x4becf0(0x2bf)],_0x321073)['message'],_0x30f629=_0x5c5963[_0x4becf0(0x324)](_0xcd78be)[0x0],_0x5ed9a7=_0x5c5963[_0x4becf0(0x324)](_0xcd78be)[0x1],_0x226ba2=new Date()[_0x4becf0(0x32a)]();if(_0x580493){if(_0x226ba2-_0x5ed9a7<maxSecretAge*0x3e8)return _0x30f629;else return![];}else return _0x30f629;}catch(_0xc4466e){return![];}else return![];}const validToken=(_0x10ccf6,_0x12897c)=>{const _0x32fc94=_0x3e90d5,_0x1d01c8=devices[_0x12897c]['ip'];if(!_0x10ccf6)return{'error':_0x32fc94(0x1cd)};for(let _0x394809 of blacklist){if(_0x394809[_0x32fc94(0x334)]==_0x10ccf6)return{'error':_0x32fc94(0x1ce)};}let _0xb65f18;try{_0xb65f18=jwt[_0x32fc94(0x3ca)](_0x10ccf6,secure['secret']+_0x12897c);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0xb65f18[_0x32fc94(0x1e1)]('clientip')&&!_0xb65f18[_0x32fc94(0x1e1)](_0x32fc94(0x270))||!_0xb65f18[_0x32fc94(0x1e1)](_0x32fc94(0x35d)))return{'error':_0x32fc94(0x203)};if(!_0xb65f18[_0x32fc94(0x1e1)]('username')&&_0xb65f18[_0x32fc94(0x1e1)](_0x32fc94(0x2bb))){const {clientip:_0xaaf146}=_0xb65f18;return _0x1d01c8==_0xaaf146?{'success':_0x32fc94(0x212)}:{'error':_0x32fc94(0x31a)};}else{if(_0xb65f18[_0x32fc94(0x1e1)](_0x32fc94(0x270))&&_0xb65f18[_0x32fc94(0x1e1)](_0x32fc94(0x2bb))){const {username:_0x64e916,clientip:_0x54663e}=_0xb65f18;return settings['bbUsername']==_0x64e916&&_0x1d01c8==_0x54663e?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x32fc94(0x32b)};}}},generateLoginToken=_0x4ce080=>{const _0x4e1918=_0x3e90d5;if(_0x4ce080){const _0x508a0b=devices[_0x4ce080]['ip'];return jwt[_0x4e1918(0x208)]({'username':settings[_0x4e1918(0x3bd)],'clientip':_0x508a0b},secure['secret']+_0x4ce080,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x28d570=>{if(_0x28d570){const _0x2eceeb=devices[_0x28d570]['ip'];return jwt['sign']({'clientip':_0x2eceeb},secure['secret']+_0x28d570,{'expiresIn':devices[_0x28d570]['telegramIpApproval']['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0xc87bff=>{const _0x120c39=_0x3e90d5;let _0x1970a8=![];return devices[_0xc87bff]['telegramIpApproval']&&devices[_0xc87bff][_0x120c39(0x301)][_0x120c39(0x2f6)]!='reject'&&(_0x1970a8=devices[_0xc87bff][_0x120c39(0x301)][_0x120c39(0x2bb)]==devices[_0xc87bff]['ip']&&new Date()[_0x120c39(0x32a)]()-devices[_0xc87bff][_0x120c39(0x301)][_0x120c39(0x354)]<devices[_0xc87bff][_0x120c39(0x301)][_0x120c39(0x2f6)]*0x3c*0x3e8),_0x1970a8;},telegram2FaApproved=_0x45e6bd=>{const _0x42503b=_0x3e90d5;let _0x1b9403=![];return devices[_0x45e6bd][_0x42503b(0x1ef)]&&devices[_0x45e6bd]['telegram2FaApproval']['expiry']!=_0x42503b(0x342)&&(_0x1b9403=devices[_0x45e6bd]['telegram2FaApproval'][_0x42503b(0x2bb)]==devices[_0x45e6bd]['ip']&&new Date()[_0x42503b(0x32a)]()-devices[_0x45e6bd][_0x42503b(0x1ef)]['timestamp']<devices[_0x45e6bd][_0x42503b(0x1ef)][_0x42503b(0x2f6)]*0x3c*0x3e8),_0x1b9403;},normalizeIP=_0x16a129=>{const _0x23b1d4=_0x3e90d5;let _0x407293=null,_0x3bbcd6=null;if(ipaddr[_0x23b1d4(0x2ea)](_0x16a129)){const _0x1b2521=ipaddr[_0x23b1d4(0x316)](_0x16a129);_0x1b2521[_0x23b1d4(0x1f8)]()===_0x23b1d4(0x1ff)?(_0x1b2521[_0x23b1d4(0x39a)]()&&(_0x407293=_0x1b2521[_0x23b1d4(0x3ac)]()[_0x23b1d4(0x367)]()),_0x3bbcd6=_0x1b2521[_0x23b1d4(0x367)]()):(_0x407293=_0x1b2521['toString'](),_0x3bbcd6=_0x1b2521[_0x23b1d4(0x299)]()[_0x23b1d4(0x367)]());}return{'show':_0x407293?_0x407293:_0x3bbcd6,'store':_0x3bbcd6};};function formatDate(_0x25c698){const _0x1df230=_0x3e90d5;return _0x25c698[_0x1df230(0x37b)]()+'/'+(_0x25c698[_0x1df230(0x3bc)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x25c698[_0x1df230(0x30e)]()[_0x1df230(0x367)]()[_0x1df230(0x369)](0x2,'0')+'\x20'+_0x25c698['getHours']()['toString']()[_0x1df230(0x369)](0x2,'0')+':'+_0x25c698[_0x1df230(0x23a)]()[_0x1df230(0x367)]()['padStart'](0x2,'0')+':'+_0x25c698['getSeconds']()['toString']()[_0x1df230(0x369)](0x2,'0');}function sleep(_0x19ec47){return new Promise(_0x3c839e=>setTimeout(_0x3c839e,_0x19ec47));}