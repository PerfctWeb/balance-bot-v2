const _0x3fc133=_0x2f00;(function(_0x1d3850,_0x104438){const _0x3dbbb0=_0x2f00,_0x3804f5=_0x1d3850();while(!![]){try{const _0x32e52f=-parseInt(_0x3dbbb0(0x268))/0x1+-parseInt(_0x3dbbb0(0x16b))/0x2+-parseInt(_0x3dbbb0(0x1b2))/0x3*(-parseInt(_0x3dbbb0(0x148))/0x4)+parseInt(_0x3dbbb0(0x211))/0x5+parseInt(_0x3dbbb0(0x212))/0x6+parseInt(_0x3dbbb0(0x213))/0x7*(parseInt(_0x3dbbb0(0x2c7))/0x8)+-parseInt(_0x3dbbb0(0x2d1))/0x9;if(_0x32e52f===_0x104438)break;else _0x3804f5['push'](_0x3804f5['shift']());}catch(_0x28ad00){_0x3804f5['push'](_0x3804f5['shift']());}}}(_0x13b7,0x35a29));const _0x577d86=function(){let _0x3ad0d0=!![];return function(_0x2fed04,_0x4345a7){const _0x2fae06=_0x3ad0d0?function(){const _0x467376=_0x2f00;if(_0x4345a7){const _0x101cfd=_0x4345a7[_0x467376(0x25f)](_0x2fed04,arguments);return _0x4345a7=null,_0x101cfd;}}:function(){};return _0x3ad0d0=![],_0x2fae06;};}(),_0x346040=_0x577d86(this,function(){const _0x46be46=_0x2f00;return _0x346040[_0x46be46(0x220)]()['search']('(((.+)+)+)+$')[_0x46be46(0x220)]()[_0x46be46(0x23c)](_0x346040)[_0x46be46(0x1bb)](_0x46be46(0x2cf));});_0x346040();'use strict';process['env'][_0x3fc133(0x169)]=0x1;const childProcess=require(_0x3fc133(0x1a9)),fs=require('fs'),fns=require(_0x3fc133(0x19b)),low=require('lowdb'),FileSync=require('lowdb/adapters/FileSync'),path=require('path'),crypto=require('crypto'),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require('hybrid-crypto-js')[_0x3fc133(0x196)],bcrypt=require(_0x3fc133(0x2ba)),jwt=require(_0x3fc133(0x19f)),ipaddr=require(_0x3fc133(0x21f)),argv=require('yargs/yargs')(process[_0x3fc133(0x19a)]['slice'](0x2))[_0x3fc133(0x19a)],uuidRandom=require('uuid-random'),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require('mixpanel'),axios=require(_0x3fc133(0x188)),{GraphQLClient,gql}=require(_0x3fc133(0x239)),util=require(_0x3fc133(0x1bc)),fileUpload=require('express-fileupload'),PORT=argv[_0x3fc133(0x275)]||_0x3fc133(0x2dc),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console['log']('Error:\x20Invalid\x20argument\x20'+PORT+_0x3fc133(0x21b)),process['exit'](0x1));const HOST=argv[_0x3fc133(0x2af)]||null,userID=argv[_0x3fc133(0x191)]||'';let bbpath=_0x3fc133(0x287),bbpath2='';const botfile=_0x3fc133(0x2b4),configfile=_0x3fc133(0x1a3),settingsfile=_0x3fc133(0x226),securefile=_0x3fc133(0x2b2);let validInstallation=!![];!fs[_0x3fc133(0x18a)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3fc133(0x255)),configpath=userID?bbpath+_0x3fc133(0x2b5)+userID+'/':bbpath+_0x3fc133(0x2b5),configbackuppath=configpath+_0x3fc133(0x28b),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x3fc133(0x284),zippath=userID?bbpath+_0x3fc133(0x2a3)+userID+'/':bbpath+_0x3fc133(0x2a3),loggerfile=fs[_0x3fc133(0x14f)](logspath+_0x3fc133(0x26f),{'flags':'a'}),temppath=userID?bbpath+_0x3fc133(0x23d)+userID+'/':bbpath+_0x3fc133(0x23d);!fs[_0x3fc133(0x18a)](configpath)&&fs[_0x3fc133(0x22b)](configpath);!fs[_0x3fc133(0x18a)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x3fc133(0x18a)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x3fc133(0x18a)](zippath)&&fs[_0x3fc133(0x22b)](zippath);!fs['existsSync'](temppath)&&fs[_0x3fc133(0x22b)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x3fc133(0x190)]({'bots':[]})[_0x3fc133(0x16c)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3fc133(0x190)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x3fc133(0x29a)}})[_0x3fc133(0x16c)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x3fc133(0x16c)]();let crypt=new Crypt({'md':_0x3fc133(0x175),'rsaStandard':_0x3fc133(0x1a1)});const saltRounds=0xa,mixpanel=Mixpanel[_0x3fc133(0x177)](_0x3fc133(0x271),{'host':_0x3fc133(0x183)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x3fc133(0x2aa)]&&settings['telegramToken']!=''&&settings['telegramUsername']&&settings[_0x3fc133(0x28e)]!='')initTelegram();const logger={'screen':_0x5bb4c0=>{const _0x3c8255=_0x3fc133;console[_0x3c8255(0x189)](_0x5bb4c0);},'simple':_0x53117f=>{const _0x3d5462=_0x3fc133;console[_0x3d5462(0x189)](_0x53117f),loggerfile[_0x3d5462(0x16c)](util[_0x3d5462(0x1b4)](_0x53117f)+'\x0a');},'full':async _0xb92307=>{const _0x4203c8=_0x3fc133,_0xfdbd85=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0xb92307;console[_0x4203c8(0x189)](_0xfdbd85),loggerfile[_0x4203c8(0x16c)](util[_0x4203c8(0x1b4)](_0xfdbd85)+'\x0a');if(tgBot&&settings[_0x4203c8(0x2d5)]&&settings[_0x4203c8(0x144)]!=_0x4203c8(0x292))await tgBot[_0x4203c8(0x261)](settings[_0x4203c8(0x2d5)],_0x4203c8(0x22a)+_0xb92307)[_0x4203c8(0x2a8)](_0x4b4f83=>{telegramError(_0x4b4f83);});}};process['on'](_0x3fc133(0x1f0),function(_0x285515){const _0x17cbaf=_0x3fc133;logger[_0x17cbaf(0x199)](_0x285515);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x3fc133(0x1e5))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x3fc133(0x2a1)),app=express(),http=require('http')[_0x3fc133(0x241)](app);app[_0x3fc133(0x299)](fileUpload({'useTempFiles':!![]})),app[_0x3fc133(0x2de)](_0x3fc133(0x20e),async(_0x8307eb,_0x47c326)=>{const _0x36b1a5=_0x3fc133,_0x256650=_0x8307eb[_0x36b1a5(0x2bb)][_0x36b1a5(0x170)],_0x35d54b=getClientsWithBotID(_0x36b1a5(0x1f1)),_0x268794=_0x8307eb[_0x36b1a5(0x244)][_0x36b1a5(0x1f8)],_0x3024fe=timelyDecrypt(_0x268794,![]),_0x12d0ea=_0x35d54b['find'](_0x3ba76c=>_0x3ba76c[_0x36b1a5(0x1f8)]==_0x3024fe);if(_0x12d0ea){const _0x47ca94=normalizeIP(_0x8307eb[_0x36b1a5(0x233)][_0x36b1a5(0x26c)])[_0x36b1a5(0x2b3)],_0x36e588=_0x8307eb[_0x36b1a5(0x244)]['tkn'];if(validateAccess(_0x36e588,_0x3024fe,_0x47ca94)[_0x36b1a5(0x15c)])await zipFiles(_0x256650),_0x47c326[_0x36b1a5(0x26a)](zippath+(_0x256650+_0x36b1a5(0x273)),_0x3731c1=>{const _0x42cd63=_0x36b1a5;_0x3731c1&&(logger[_0x42cd63(0x27e)](_0x42cd63(0x228)+_0x256650),logger[_0x42cd63(0x199)](_0x3731c1));});else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x256650+'\x20(1)');}else logger[_0x36b1a5(0x27e)](_0x36b1a5(0x178)+_0x256650+_0x36b1a5(0x1ee));}),app[_0x3fc133(0x29b)]('/upload-backup',async(_0x3701a1,_0x1e32b2)=>{const _0x379403=_0x3fc133,_0xd34d1b=getClientsWithBotID(_0x379403(0x1f1)),_0x3be09e=_0x3701a1[_0x379403(0x244)][_0x379403(0x1f8)],_0x36b5da=timelyDecrypt(_0x3be09e,![]),_0x20f1cb=_0xd34d1b[_0x379403(0x159)](_0x5e39b3=>_0x5e39b3[_0x379403(0x1f8)]==_0x36b5da);if(_0x20f1cb){const _0x1ad050=normalizeIP(_0x3701a1[_0x379403(0x233)][_0x379403(0x26c)])['store'],_0x398e30=_0x3701a1[_0x379403(0x244)][_0x379403(0x274)];if(validateAccess(_0x398e30,_0x36b5da,_0x1ad050)['allow']){if(_0x3701a1[_0x379403(0x1eb)]){const _0x1bdf7b=_0x3701a1['files'][_0x379403(0x2bc)];await _0x1bdf7b['mv'](temppath+_0x1bdf7b['name']),_0x1e32b2[_0x379403(0x231)]({'status':!![],'message':_0x379403(0x206)}),confirmRestore(temppath,_0x1bdf7b[_0x379403(0x1e0)]);}}else logger[_0x379403(0x27e)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x379403(0x27e)](_0x379403(0x227));}),app['use'](express[_0x3fc133(0x27f)](path['join'](__dirname,bbpath2,'build2'))),app[_0x3fc133(0x299)](express[_0x3fc133(0x27f)](path['join'](__dirname,bbpath2,_0x3fc133(0x2a6)))),app[_0x3fc133(0x2de)]('/',function(_0x52be7f,_0x7b309a){const _0x4ba1a4=_0x3fc133;_0x7b309a[_0x4ba1a4(0x1e7)](path[_0x4ba1a4(0x240)](__dirname,bbpath2,_0x4ba1a4(0x2a9),_0x4ba1a4(0x204)));}),app['get']('/:bot',function(_0x36db76,_0x3b1b91){const _0x2abc16=_0x3fc133;_0x3b1b91['sendFile'](path[_0x2abc16(0x240)](__dirname,bbpath2,_0x2abc16(0x2a6),_0x2abc16(0x204)));}),app[_0x3fc133(0x2de)](_0x3fc133(0x224),(_0x407f2d,_0x38fe80)=>{const _0x42cb8d=_0x3fc133;_0x38fe80[_0x42cb8d(0x1e7)](path[_0x42cb8d(0x240)](__dirname,bbpath2,'build',_0x42cb8d(0x204)));}),app[_0x3fc133(0x2de)](_0x3fc133(0x2cb),(_0x5dfb2d,_0x1bea71)=>{const _0x3873fd=_0x3fc133;_0x1bea71[_0x3873fd(0x1e7)](path['join'](__dirname,bbpath2,_0x3873fd(0x2a6),_0x3873fd(0x204)));}),app[_0x3fc133(0x2de)](_0x3fc133(0x16e),(_0x7d1476,_0x336ce8)=>{const _0x2ef550=_0x3fc133;_0x336ce8[_0x2ef550(0x1e7)](path[_0x2ef550(0x240)](__dirname,bbpath2,_0x2ef550(0x2a6),'index.html'));}),app['get'](_0x3fc133(0x1c5),(_0x5be2d5,_0xc4192e)=>{const _0xe95cc6=_0x3fc133;_0xc4192e[_0xe95cc6(0x1e7)](path['join'](__dirname,bbpath2,_0xe95cc6(0x2a6),_0xe95cc6(0x204)));}),app['get']('/:bot/configuration',(_0x1346b3,_0x483037)=>{const _0x354604=_0x3fc133;_0x483037[_0x354604(0x1e7)](path[_0x354604(0x240)](__dirname,bbpath2,'build','index.html'));}),app[_0x3fc133(0x2de)](_0x3fc133(0x1e4),(_0x22c0da,_0x52fdce)=>{const _0x13c47e=_0x3fc133;_0x52fdce['sendFile'](path[_0x13c47e(0x240)](__dirname,bbpath2,_0x13c47e(0x2a6),_0x13c47e(0x204)));});function _0x13b7(){const _0x3a9688=['\x20(2)','function','uncaughtException','botmanager','randomBytes','onText','userid','handshake','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','sortBy','uuid','showname','telegram','node-zip','telegram2FaApproval','store-headless','entries','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Unauthorized\x20attempt\x20to\x20update\x20settings','whitelistEnabled','Unauthorized\x20login\x20attempt\x20(timeout)','reset-password','index.html','privateKey','File\x20uploaded','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','stringify','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','chat','Invalid\x20authentication\x20token\x20(2)','referer','exec','/download/:type','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','polling_error','258375GUqoXI','2565198oQBIhl','1161258TixWJK','No\x20bots\x20running\x20right\x20now','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','reject','Notifications\x20types:\x20','/off\x20-\x20stop\x20bot(s)\x0a','\x20minutes','update-bb',',\x20must\x20be\x20a\x204\x20digit\x20number','Unauthorized\x20attempt\x20to\x20confirm\x20message','reason','get-messages','ipaddr.js','toString','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','exit','-----------------------------------------------------------------------------------','/:bot/portfolio','Alerts','bb-settings.json','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Failed\x20to\x20download\x20','/on\x20-\x20start\x20bot(s)\x0a','Bot\x20Mgr\x20>\x20','mkdirSync','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Server','logout','starting\x20new\x20bot\x20|\x20Bot\x20','You\x20can\x20use\x20the\x20following\x20commands:\x0a','send','includes','socket','hasOwnProperty','length','Bot\x20','placeOrder','/disable\x20-\x20disable\x20notifications\x0a','graphql-request','Unauthorized\x20attempt\x20to\x20get\x20logs','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','constructor','temp/','Unauthorized\x20attempt\x20to\x20update\x20bot','store-settings','join','createServer','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','success','headers','Notifications\x20disabled\x0a','access','headless','removeAllListeners','add','disabled\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20messages','generate','***','secure','place-order','DEFLATE','from','bbvNew','data','ipv6','clients','updatebotmanager','127.0.0.1','message','botID','output-003.log','any','value','Restore\x20process\x20aborted','settings','apply','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','sendMessage','readFileSync','Invalid\x20username\x20or\x20IP\x20address','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','</b>\x20?','confirm-message','Orders','96865zbBAbJ','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','download','\x20>\x20','remoteAddress','*$1*','stopPolling','/output-000.log','2FA\x20login\x20token\x20generated','6b67f3d61ee94b8f5c80b4affef4c4d9','bbUsername','.zip','tkn','port','timestamp','alerts','login','Password\x20has\x20been\x20reset\x20to:\x20','fork','once','track','new','full','static','pidRefreshToken','f2aRequired','::ffff:127.0.0.1','output-001.log','logs/','1000','cancelLoading','bb/','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','padStart','All','backup/','30\x20min','password','telegramUsername','deleted\x20Bot\x20','push','binary','orders','map','min','invalid\x20credentials','delete-alerts','bbPassword','assign','use','0.0.0','post','forEach','Restoring\x20bot(s)\x20from\x20backup','getDate','pidExpireLogin','bot','express','15\x20min','zip/','settings.','login\x20not\x20required','build','latestversion','catch','build2','telegramToken','hex','error\x20while\x20deleting\x20config\x20files:\x20','then','unlinkSync','host','Temporary\x20access\x20rejected','\x20mode','bb-secure.json','store','bot.js','config/','idling\x20bot\x20\x20\x20|\x20Bot\x20','expiry','kill','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','bcryptjs','params','backupfile','isDirectory','logged\x20out','2FA\x20required','username','inherit','size','login\x20token\x20generated','restart','exp','HTML','8zbCSQa','yes','\x20|\x20','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','/:bot/performance','secret','telegrammsg','file','(((.+)+)+)+$','Starting\x20Balance\x20Bot\x20update','5217192chqmzO','isIPv4MappedAddress','getMinutes','readdirSync','telegramChatId','<b>Balance\x20Bot\x20Status:</b>\x0a','number','Invalid\x20Telegram\x20token','restarting\x20Bot\x20','output-002.log','lastmsgtelegram','3000','add-bot','get','\x20only\x0a','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Unauthorized\x20attempt\x20to\x20log\x20out','login\x20token\x20valid','telegramEvents','bot-','test','encryptedUuid','1527368NOLUzA','sendPortfolioTelegram','Markdown','started','cancel-loading','stop','Your\x20installation\x20is\x20already\x20up\x20to\x20date','createWriteStream','https://api.ipify.org?format=json','decrypt','logs','writeFileSync','publicKey','deleteHistoryAlerts','temporary\x20access\x20not\x20allowed','output-000.log','enabled','find','_data','server','allow','telegramIpApproval','loginRequired','2FA','getTime','-config.json','Unauthorized\x20attempt\x20to\x20add\x20bot','auto','removeListener','rmSync','isValid','/status\x20-\x20show\x20bot(s)\x20status\x0a','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','NTBA_FIX_319','new-disabled','261404SHnypI','write','status','/:bot/coins','whitelist','type','getHours','getSeconds','disconnect','remove','sha256','answerCallbackQuery','init','Unauthorized\x20attempt\x20to\x20download\x20','token','temporary\x20token\x20generated','lastmsgemitted','getMonth','disabled','::1','replace','all','SIGINT','title','api-eu.mixpanel.com','set','randomFillSync','warning','telegramEnabled','axios','log','existsSync','filter','404\x20Not\x20Found','/help\x20-\x20show\x20available\x20commands\x0a','emit','getUTCHours','defaults','user','get-logs','mode','Ok,\x20will\x20send\x20alert\x20notifications\x20only','/restart\x20-\x20restart\x20bot(s)\x0a','RSA','emitHistory','order','simple','argv','date-fns','split','2FA\x20login\x20rejected','get-portfolio','jsonwebtoken','toggle-bot-mode','RSA-OAEP','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','bb-config.json','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','compareSync','Unauthorized\x20attempt\x20to\x20get\x20portfolio','bots','child_process','parse','copyFileSync','2FA\x20login\x20required','toIPv4Address','sign','toIPv4MappedAddress','temporary\x20access\x20rejected','Notifications\x20enabled\x0a','3KNBZxX','notification','format','Allow\x20login\x20from\x20IP\x20address\x20<b>','clientip','starting\x20bot\x20|\x20Bot\x20','hashSync','callback_query','show','search','util','Login\x20accepted','socket.io','SIGTERM','blacklist','auth','Notifications\x20disabled','keys','live','/:bot/history','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','botname','getFullYear','************','Notifications\x20enabled','request','enabled\x20Bot\x20','sockets','All\x20bots','alias','bbvReceive','messages','Ok,\x20will\x20send\x20order\x20notifications\x20only','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','stopped','Token\x20blacklisted','store-configuration','error','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','delete-bot','manual','Password\x20reset\x20rejected','update-bot','accept','apiSecret','name','args','event','match','/:bot/support','version.json','listen','sendFile','timeshift','apiKey','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','files','max','reload'];_0x13b7=function(){return _0x3a9688;};return _0x13b7();}if(HOST)http['listen'](PORT,HOST);else http[_0x3fc133(0x1e6)](PORT);const io=require(_0x3fc133(0x1be))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x21c841=_0x3fc133;logger[_0x21c841(0x199)](''),logger[_0x21c841(0x199)]('-----------------------------------------------------------------------------------'),await logger[_0x21c841(0x27e)](_0x21c841(0x1a5)+PORT),logger[_0x21c841(0x199)]('-----------------------------------------------------------------------------------');if(config[_0x21c841(0x235)]!=0x0)for(const _0x277dcb of config){if(_0x277dcb[_0x21c841(0x16d)]==_0x21c841(0x158)||_0x277dcb['status']=='new')await logger['full'](_0x21c841(0x1b7)+_0x277dcb[_0x21c841(0x259)]+_0x21c841(0x2c9)+_0x277dcb['botname']),startBot([_0x277dcb[_0x21c841(0x259)],userID],{'cwd':bbpath},function(_0x14fa12){if(_0x14fa12)logger['full'](_0x14fa12);});else(_0x277dcb[_0x21c841(0x16d)]=='disabled'||_0x277dcb[_0x21c841(0x16d)]==_0x21c841(0x16a))&&await logger[_0x21c841(0x27e)](_0x21c841(0x2b6)+_0x277dcb[_0x21c841(0x259)]+_0x21c841(0x2c9)+_0x277dcb['botname']);}else!newBot&&logger[_0x21c841(0x199)](_0x21c841(0x288));if(newBot)addBot();logger['simple'](_0x21c841(0x223)),logger['simple']('');}function startSocket(){io['on']('connection',_0x3c9ed3=>{const _0x4b444a=_0x2f00;let _0x5ba82f,_0x8d9b27,_0x21dc22,_0x3d2f8f,_0x1b89a1;const _0x1de702=_0x3c9ed3[_0x4b444a(0x1f5)]['headers'][_0x4b444a(0x20c)];_0x8d9b27=_0x1de702[_0x4b444a(0x1e3)](/bot[0-9]{3}/);if(_0x8d9b27)_0x21dc22=_0x8d9b27[0x0][_0x4b444a(0x1e3)](/[0-9]{3}/);if(_0x21dc22)_0x5ba82f=_0x21dc22[0x0];else _0x5ba82f=_0x4b444a(0x1f1);const _0x4e89ce=_0x3c9ed3[_0x4b444a(0x1f5)][_0x4b444a(0x1c1)][_0x4b444a(0x147)];if(!_0x4e89ce)_0x3c9ed3[_0x4b444a(0x18e)](_0x4b444a(0x16d),{'publicKey':secure[_0x4b444a(0x154)]});else{_0x3d2f8f=timelyDecrypt(_0x4e89ce,![]);if(!_0x3d2f8f)_0x3c9ed3[_0x4b444a(0x18e)](_0x4b444a(0x16d),{'publicKey':secure[_0x4b444a(0x154)]});else{_0x1b89a1=normalizeIP(_0x3c9ed3['conn']['remoteAddress'])[_0x4b444a(0x2b3)];if(!devices[_0x3d2f8f])devices[_0x3d2f8f]={'uuid':_0x3d2f8f,'access':{'token':null}};devices[_0x3d2f8f]['ip']=_0x1b89a1;const _0x6d8ab1=addClient(_0x3c9ed3['id'],_0x3d2f8f,_0x5ba82f);setAccess(_0x6d8ab1),emitMessages(),_0x3c9ed3['on'](_0x4b444a(0x278),_0x3923f2=>{const _0x3cf6ab=_0x4b444a,_0xf04e30=timelyDecrypt(_0x3923f2[_0x3cf6ab(0x28d)]);if(_0xf04e30){_0x3923f2={'username':_0x3923f2[_0x3cf6ab(0x2c0)],'password':_0xf04e30},devices[_0x3d2f8f][_0x3cf6ab(0x246)]=validateCredentials(_0x3923f2,_0x3d2f8f);if(devices[_0x3d2f8f][_0x3cf6ab(0x246)][_0x3cf6ab(0x15c)]==![]&&devices[_0x3d2f8f][_0x3cf6ab(0x246)]['reason']==_0x3cf6ab(0x1ac))_0x3c9ed3[_0x3cf6ab(0x18e)](_0x3cf6ab(0x16d),{'access':devices[_0x3d2f8f][_0x3cf6ab(0x246)]}),loginAccess2FA(_0x3d2f8f,_0x1b89a1);else{if(devices[_0x3d2f8f][_0x3cf6ab(0x246)]['allow']==![]&&devices[_0x3d2f8f][_0x3cf6ab(0x246)][_0x3cf6ab(0x21d)]=='invalid\x20credentials')_0x3c9ed3[_0x3cf6ab(0x18e)](_0x3cf6ab(0x16d),{'access':devices[_0x3d2f8f][_0x3cf6ab(0x246)]});else devices[_0x3d2f8f][_0x3cf6ab(0x246)][_0x3cf6ab(0x15c)]&&devices[_0x3d2f8f][_0x3cf6ab(0x246)]['reason']==_0x3cf6ab(0x2c3)&&(getClientsWithUuid(_0x3d2f8f)[_0x3cf6ab(0x29c)](_0x25dfe1=>{setAccess(_0x25dfe1);}),setTokenRefresh(_0x3d2f8f),setSessionTimeout('login',_0x3d2f8f));}}else logger[_0x3cf6ab(0x27e)](_0x3cf6ab(0x202));}),_0x3c9ed3['on'](_0x4b444a(0x203),()=>{resetPassword();}),_0x3c9ed3['on'](_0x4b444a(0x173),_0x4ad2cb=>{removeClient(_0x3c9ed3['id']);}),_0x5ba82f=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4bf930){const _0x249d9f=_0x3fc133;if(_0x4bf930!=_0x249d9f(0x1f1)&&config[_0x249d9f(0x1e9)]!=''){if(pid[_0x4bf930])pid[_0x4bf930][_0x249d9f(0x231)]({'function':'initclient','args':null});}}function reloadBotManager(){const _0x87154=_0x3fc133;getClientsWithBotID(_0x87154(0x1f1))['forEach'](_0x1d2d72=>{const _0x36cbb5=_0x87154;getSocket(_0x1d2d72['id'])['emit']('status',{'access':{'allow':![],'reason':_0x36cbb5(0x1ed),'token':null}});});}function getSocket(_0x1ef77c){const _0x1221a0=_0x3fc133;return io[_0x1221a0(0x1ce)][_0x1221a0(0x1ce)]['get'](_0x1ef77c);}function setAccess(_0x1d4c39){const _0x2aa486=_0x3fc133,_0x4704fa=getSocket(_0x1d4c39['id']),_0x4bcb21=_0x1d4c39['uuid'],_0x502857=_0x1d4c39[_0x2aa486(0x2a0)];devices[_0x4bcb21][_0x2aa486(0x246)]=validateAccess(devices[_0x4bcb21][_0x2aa486(0x246)][_0x2aa486(0x179)],_0x4bcb21),_0x4704fa['join'](_0x4bcb21);if(devices[_0x4bcb21][_0x2aa486(0x246)][_0x2aa486(0x15c)]){_0x4704fa[_0x2aa486(0x240)](_0x502857);if(_0x502857==_0x2aa486(0x1f1))initializeSocketBotManager(_0x4704fa);else initializeSocketBot(_0x4704fa);initClient(_0x502857);}devices[_0x4bcb21][_0x2aa486(0x246)]['token']&&devices[_0x4bcb21][_0x2aa486(0x246)][_0x2aa486(0x21d)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x2aa486(0x15f),_0x4bcb21),devices[_0x4bcb21]['access']['token']&&devices[_0x4bcb21][_0x2aa486(0x246)][_0x2aa486(0x21d)]==_0x2aa486(0x270)&&setSessionTimeout(_0x2aa486(0x278),_0x4bcb21),_0x4704fa[_0x2aa486(0x18e)](_0x2aa486(0x16d),{'status':_0x1d4c39[_0x2aa486(0x15b)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x4bcb21][_0x2aa486(0x246)],'externalip':devices[_0x4bcb21]['ip'],'publicKey':secure[_0x2aa486(0x154)],'userid':settings[_0x2aa486(0x1f4)],'validInstallation':validInstallation}),devices[_0x4bcb21][_0x2aa486(0x246)][_0x2aa486(0x15c)]==![]&&devices[_0x4bcb21][_0x2aa486(0x246)]['reason']=='2FA\x20required'&&temporaryAccess2FA(_0x4bcb21,devices[_0x4bcb21]['ip']);}function setSessionTimeout(_0x537839,_0x5d42a0){const _0x2cbf6c=_0x3fc133;let _0x599650;if(_0x537839==_0x2cbf6c(0x278))_0x599650=loginExpiry*0x3c*0x3e8;else _0x599650=devices[_0x5d42a0][_0x2cbf6c(0x15d)][_0x2cbf6c(0x2b7)]*0x3c*0x3e8-(new Date()[_0x2cbf6c(0x160)]()-devices[_0x5d42a0][_0x2cbf6c(0x15d)][_0x2cbf6c(0x276)]);if(devices[_0x5d42a0]['pidExpireLogin'])clearTimeout(devices[_0x5d42a0][_0x2cbf6c(0x29f)]);devices[_0x5d42a0][_0x2cbf6c(0x29f)]=setTimeout(()=>{const _0x283d37=_0x2cbf6c;if(devices[_0x5d42a0]['pidRefreshToken'])clearTimeout(devices[_0x5d42a0][_0x283d37(0x280)]);removeSocketListeners(_0x5d42a0),addBlacklist(_0x5d42a0),devices[_0x5d42a0]['telegramIpApproval']=null,devices[_0x5d42a0][_0x283d37(0x1fc)]=null,devices[_0x5d42a0]['access']['token']=null,devices[_0x5d42a0][_0x283d37(0x246)]=validateAccess(devices[_0x5d42a0][_0x283d37(0x246)][_0x283d37(0x179)],_0x5d42a0),!(devices[_0x5d42a0][_0x283d37(0x246)][_0x283d37(0x15c)]&&devices[_0x5d42a0][_0x283d37(0x246)][_0x283d37(0x21d)]==_0x283d37(0x2a5))&&(_0x537839==_0x283d37(0x278)?io['to'](_0x5d42a0)[_0x283d37(0x18e)]('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x5d42a0)['emit'](_0x283d37(0x16d),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x5d42a0][_0x283d37(0x246)][_0x283d37(0x179)]=null;},_0x599650);}function setTokenRefresh(_0x2e9846){const _0x148160=_0x3fc133;if(devices[_0x2e9846][_0x148160(0x280)])clearTimeout(devices[_0x2e9846][_0x148160(0x280)]);devices[_0x2e9846][_0x148160(0x280)]=setTimeout(()=>{const _0x133b41=_0x148160;getClientsWithUuid(_0x2e9846)[_0x133b41(0x235)]!=0x0?(devices[_0x2e9846]['access']=refreshToken(_0x2e9846),io['to'](_0x2e9846)[_0x133b41(0x18e)](_0x133b41(0x16d),{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x2e9846][_0x133b41(0x246)],'externalip':devices[_0x2e9846]['ip'],'publicKey':secure[_0x133b41(0x154)],'validInstallation':validInstallation}),setTokenRefresh(_0x2e9846)):clearTimeout(devices[_0x2e9846][_0x133b41(0x280)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x395637){const _0x5d3ff6=_0x3fc133,_0x306a06=getClient(_0x395637['id'])[_0x5d3ff6(0x1f8)];_0x395637[_0x5d3ff6(0x18e)](_0x5d3ff6(0x1a8),config),_0x395637[_0x5d3ff6(0x18e)](_0x5d3ff6(0x25e),cleanSettings()),_0x395637['on'](_0x5d3ff6(0x2dd),_0x108946=>{const _0x6f8d81=_0x5d3ff6;if(validateAccess(_0x108946,_0x306a06)[_0x6f8d81(0x15c)])addBot();else logger[_0x6f8d81(0x27e)](_0x6f8d81(0x162));}),_0x395637['on'](_0x5d3ff6(0x1dd),(_0x3215c1,_0x2f734e)=>{const _0x2d66b5=_0x5d3ff6;if(validateAccess(_0x2f734e,_0x306a06)[_0x2d66b5(0x15c)])toggleBot(_0x3215c1[_0x2d66b5(0x259)],_0x3215c1[_0x2d66b5(0x16d)],_0x3215c1[_0x2d66b5(0x1c4)]);else logger[_0x2d66b5(0x27e)](_0x2d66b5(0x23e));}),_0x395637['on'](_0x5d3ff6(0x1a0),(_0x4ccace,_0x180ccb)=>{const _0x400373=_0x5d3ff6;if(validateAccess(_0x180ccb,_0x306a06)[_0x400373(0x15c)])toggleBotMode(_0x4ccace);else logger[_0x400373(0x27e)](_0x400373(0x23e));}),_0x395637['on'](_0x5d3ff6(0x1da),(_0x4c082f,_0x193352)=>{const _0x543691=_0x5d3ff6;if(validateAccess(_0x193352,_0x306a06)[_0x543691(0x15c)])deleteBot(_0x4c082f);else logger[_0x543691(0x27e)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x395637['on'](_0x5d3ff6(0x23f),(_0x1ed4e8,_0x3d32db)=>{const _0x27e24f=_0x5d3ff6;if(validateAccess(_0x3d32db,_0x306a06)['allow'])storeSettings(_0x1ed4e8,!![]);else logger['full'](_0x27e24f(0x200));}),_0x395637['on'](_0x5d3ff6(0x21a),_0x36f121=>{const _0x5c536e=_0x5d3ff6;if(validateAccess(_0x36f121,_0x306a06)[_0x5c536e(0x15c)])updateBB();else logger[_0x5c536e(0x27e)](_0x5c536e(0x207));}),_0x395637['on'](_0x5d3ff6(0x21e),_0xe65359=>{const _0x432b78=_0x5d3ff6;if(validateAccess(_0xe65359,_0x306a06)[_0x432b78(0x15c)])getMessages();else logger[_0x432b78(0x27e)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x395637['on'](_0x5d3ff6(0x266),(_0x1f82bb,_0x50a6f6)=>{const _0x26f22c=_0x5d3ff6;if(validateAccess(_0x50a6f6,_0x306a06)['allow'])confirmMessage(_0x1f82bb);else logger[_0x26f22c(0x27e)](_0x26f22c(0x21c));}),_0x395637['on'](_0x5d3ff6(0x22e),_0x442924=>{const _0x3c6222=_0x5d3ff6;if(validateAccess(_0x442924,_0x306a06)[_0x3c6222(0x15c)]){if(devices[_0x306a06][_0x3c6222(0x280)])clearTimeout(devices[_0x306a06][_0x3c6222(0x280)]);if(devices[_0x306a06][_0x3c6222(0x29f)])clearTimeout(devices[_0x306a06][_0x3c6222(0x29f)]);removeSocketListeners(getClient(_0x395637['id'])[_0x3c6222(0x1f8)]),addBlacklist(_0x306a06),devices[_0x306a06]['telegramIpApproval']=null,devices[_0x306a06][_0x3c6222(0x1fc)]=null,devices[_0x306a06][_0x3c6222(0x246)]['token']=null,io['to'](getClient(_0x395637['id'])['uuid'])['emit'](_0x3c6222(0x16d),{'access':{'allow':![],'reason':_0x3c6222(0x2be),'token':null}});}else logger[_0x3c6222(0x27e)](_0x3c6222(0x142));});}function initializeSocketBot(_0xf18bd4){const _0x5781f5=_0x3fc133,_0x569f5c=getClient(_0xf18bd4['id'])['bot'],_0x521637=getClient(_0xf18bd4['id'])[_0x5781f5(0x1f8)];_0xf18bd4['on'](_0x5781f5(0x192),(_0x511cb5,_0x4dc587)=>{const _0x1f476f=_0x5781f5;if(validateAccess(_0x4dc587,_0x521637)[_0x1f476f(0x15c)]){if(pid[_0x569f5c])pid[_0x569f5c]['send']({'function':_0x1f476f(0x197),'args':_0x511cb5});}else logger[_0x1f476f(0x27e)](_0x1f476f(0x23a));}),_0xf18bd4['on'](_0x5781f5(0x296),(_0x1c9806,_0x4d29da)=>{const _0x48ab5b=_0x5781f5;if(validateAccess(_0x4d29da,_0x521637)[_0x48ab5b(0x15c)]){if(pid[_0x569f5c])pid[_0x569f5c][_0x48ab5b(0x231)]({'function':_0x48ab5b(0x155),'args':_0x1c9806});}else logger[_0x48ab5b(0x27e)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0xf18bd4['on'](_0x5781f5(0x19e),(_0x437a10,_0x35001c)=>{const _0x23122b=_0x5781f5;if(validateAccess(_0x35001c,_0x521637)[_0x23122b(0x15c)]){if(pid[_0x569f5c])pid[_0x569f5c][_0x23122b(0x231)]({'function':'getPortfolio','args':_0x437a10});}else logger[_0x23122b(0x27e)](_0x23122b(0x1a7));}),_0xf18bd4['on'](_0x5781f5(0x1d7),(_0x2e890d,_0xbb4b84)=>{const _0x566a53=_0x5781f5;if(validateAccess(_0xbb4b84,_0x521637)[_0x566a53(0x15c)]){if(pid[_0x569f5c])pid[_0x569f5c][_0x566a53(0x231)]({'function':'storeConfiguration','args':_0x2e890d});}else logger[_0x566a53(0x27e)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0xf18bd4['on'](_0x5781f5(0x1fd),(_0x85d1a0,_0x18c5e6)=>{const _0x5ae233=_0x5781f5;if(validateAccess(_0x18c5e6,_0x521637)['allow']){if(pid[_0x569f5c])pid[_0x569f5c][_0x5ae233(0x231)]({'function':'storeHeadless','args':_0x85d1a0});}else logger[_0x5ae233(0x27e)](_0x5ae233(0x2ca));}),_0xf18bd4['on']('get-starting-balances',_0x2ea8b2=>{const _0x59fc7e=_0x5781f5;if(validateAccess(_0x2ea8b2,_0x521637)['allow']){if(pid[_0x569f5c])pid[_0x569f5c][_0x59fc7e(0x231)]({'function':'getStartingBalances','args':null});}else logger[_0x59fc7e(0x27e)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0xf18bd4['on'](_0x5781f5(0x24f),(_0x5c9b2c,_0x7e2380)=>{const _0xc0852=_0x5781f5;if(validateAccess(_0x7e2380,_0x521637)[_0xc0852(0x15c)]){if(pid[_0x569f5c])pid[_0x569f5c][_0xc0852(0x231)]({'function':_0xc0852(0x237),'args':_0x5c9b2c});}else logger[_0xc0852(0x27e)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0xf18bd4['on'](_0x5781f5(0x14c),_0x6f695d=>{const _0x15f6e1=_0x5781f5;if(validateAccess(_0x6f695d,_0x521637)[_0x15f6e1(0x15c)]){if(pid[_0x569f5c])pid[_0x569f5c][_0x15f6e1(0x231)]({'function':_0x15f6e1(0x286),'args':null});}else logger[_0x15f6e1(0x27e)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0xf18bd4['on']('update-bb',_0x3d0cdc=>{const _0x477348=_0x5781f5;if(validateAccess(_0x3d0cdc,_0x521637)[_0x477348(0x15c)])updateBB();else logger[_0x477348(0x27e)](_0x477348(0x207));}),_0xf18bd4['on'](_0x5781f5(0x21e),_0x515ebd=>{const _0x1e56cb=_0x5781f5;if(validateAccess(_0x515ebd,_0x521637)[_0x1e56cb(0x15c)])getMessages();else logger[_0x1e56cb(0x27e)](_0x1e56cb(0x24b));}),_0xf18bd4['on'](_0x5781f5(0x266),(_0xc6b911,_0x420363)=>{const _0x5ba897=_0x5781f5;if(validateAccess(_0x420363,_0x521637)[_0x5ba897(0x15c)])confirmMessage(_0xc6b911);else logger[_0x5ba897(0x27e)](_0x5ba897(0x21c));}),_0xf18bd4['on'](_0x5781f5(0x22e),_0x266fe3=>{const _0x17f8fa=_0x5781f5;if(validateAccess(_0x266fe3,_0x521637)['allow']){if(devices[_0x521637][_0x17f8fa(0x280)])clearTimeout(devices[_0x521637][_0x17f8fa(0x280)]);if(devices[_0x521637][_0x17f8fa(0x29f)])clearTimeout(devices[_0x521637][_0x17f8fa(0x29f)]);removeSocketListeners(getClient(_0xf18bd4['id'])['uuid']),addBlacklist(_0x521637),devices[_0x521637][_0x17f8fa(0x15d)]=null,devices[_0x521637]['telegram2FaApproval']=null,devices[_0x521637][_0x17f8fa(0x246)][_0x17f8fa(0x179)]=null,io['to'](getClient(_0xf18bd4['id'])[_0x17f8fa(0x1f8)])['emit'](_0x17f8fa(0x16d),{'access':{'allow':![],'reason':_0x17f8fa(0x2be),'token':null}});}else logger[_0x17f8fa(0x27e)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x3851f8){const _0x182485=_0x3fc133;getClientsWithUuid(_0x3851f8)[_0x182485(0x29c)](_0x4ece7b=>{const _0x427e73=_0x182485;getSocket(_0x4ece7b['id'])[_0x427e73(0x248)]();});}function cleanSettings(){const _0x56b550=_0x3fc133;let _0x5699ee=settings;return settings[_0x56b550(0x2aa)]&&settings[_0x56b550(0x2aa)]!=''&&(_0x5699ee={..._0x5699ee,'telegramToken':_0x56b550(0x1ca)}),settings['bbPassword']&&settings[_0x56b550(0x297)]!=''&&(_0x5699ee={..._0x5699ee,'bbPassword':_0x56b550(0x1ca)}),(settings[_0x56b550(0x297)]&&settings[_0x56b550(0x297)]==_0x56b550(0x24d)||settings[_0x56b550(0x2aa)]&&settings[_0x56b550(0x2aa)]==_0x56b550(0x24d))&&(_0x5699ee={..._0x5699ee,'restored':{'password':settings[_0x56b550(0x297)]==_0x56b550(0x24d),'telegram':settings[_0x56b550(0x2aa)]==_0x56b550(0x24d)}}),_0x5699ee;}function updateBB(){const _0x26193c=_0x3fc133;installingUpdate=!![],config[_0x26193c(0x29c)](_0x553d33=>{const _0x563d90=_0x26193c;restartBot(_0x553d33[_0x563d90(0x259)]);}),process[_0x26193c(0x231)]({'update':!![]},_0x42711c=>{});}function startBot(_0x1edd5f,_0x2389f2,_0x45a425){const _0x4a3093=_0x3fc133;let _0x34d59f=![];const _0x4917cb=_0x1edd5f[0x0];_0x2389f2={..._0x2389f2,'stdio':[_0x4a3093(0x2c1),'inherit',_0x4a3093(0x2c1),'ipc']},pid[_0x4917cb]=childProcess[_0x4a3093(0x27a)](botfile,_0x1edd5f,_0x2389f2),pid[_0x4917cb]['on']('message',_0x54a785=>{const _0x168787=_0x4a3093;switch(Object[_0x168787(0x1c3)](_0x54a785)[0x0]){case _0x168787(0x1c8):updateBotName(_0x4917cb,_0x54a785[_0x168787(0x1c8)]);break;case _0x168787(0x256):updateBotManager();break;case'status':updateStatus(_0x4917cb,_0x54a785[_0x168787(0x16d)]);break;case _0x168787(0x1c4):updateLive(_0x4917cb,_0x54a785[_0x168787(0x1c4)]);break;case _0x168787(0x14b):updateLive(_0x4917cb,_0x54a785[_0x168787(0x14b)]),io['to'](_0x4917cb)[_0x168787(0x18e)](_0x168787(0x16d),{'access':{'allow':![],'reason':_0x168787(0x1ed),'token':null}});break;case _0x168787(0x14d):_0x54a785[_0x168787(0x14d)]==_0x168787(0x2c4)&&restartBot(_0x4917cb);_0x54a785[_0x168787(0x14d)]==_0x168787(0x2b8)&&toggleBot(_0x4917cb,_0x168787(0x17d),'stopped');break;case _0x168787(0x1fa):sendTelegram(_0x4917cb,_0x54a785[_0x168787(0x1fa)]);break;case'telegrammsg':sendTelegramMsg(_0x54a785[_0x168787(0x2cd)]);break;case _0x168787(0x1ef):io['to'](_0x4917cb)[_0x168787(0x18e)](_0x54a785[_0x168787(0x1ef)],_0x54a785[_0x168787(0x1e1)]);break;}}),pid[_0x4917cb]['on'](_0x4a3093(0x1d8),function(_0x1abc2b){if(_0x34d59f)return;_0x34d59f=!![],_0x45a425(_0x1abc2b);}),pid[_0x4917cb]['on']('exit',async function(_0x4d0700){const _0x484731=_0x4a3093;if(installingUpdate)return;if(_0x34d59f)return;_0x34d59f=!![],_0x45a425(null);const _0x1a6f0e=dbConfig['get'](_0x484731(0x1a8))[_0x484731(0x159)]({'botID':_0x4917cb})[_0x484731(0x25c)]();_0x1a6f0e&&(_0x1a6f0e[_0x484731(0x16d)]==_0x484731(0x158)||_0x1a6f0e[_0x484731(0x16d)]=='new')&&(await sleep(0x3e8),updateLive(_0x4917cb,'stopped'),logger[_0x484731(0x27e)](_0x484731(0x2d9)+_0x4917cb),startBot([_0x4917cb,userID],{'cwd':bbpath},function(_0xd1b42d){const _0x35ce83=_0x484731;if(_0xd1b42d)logger[_0x35ce83(0x27e)](_0xd1b42d);}));});}function stopBot(_0x484fcb){const _0x4d8eee=_0x3fc133;getClientsWithBotID(_0x484fcb)['forEach'](_0x52f217=>{const _0xffba10=_0x2f00;getSocket(_0x52f217['id'])[_0xffba10(0x173)](!![]),removeClient(_0x52f217['id']);}),pid[_0x484fcb]&&(pid[_0x484fcb][_0x4d8eee(0x2b8)](),pid[_0x484fcb]=null);}function restartBot(_0x2dda1e){const _0x2a0ba1=_0x3fc133;if(pid[_0x2dda1e])pid[_0x2dda1e][_0x2a0ba1(0x2b8)]();}function addBot(){const _0x4641a2=_0x3fc133;let _0x290d62;for(let _0x153d38=0x1;_0x153d38<0x3e9;_0x153d38++){_0x290d62=_0x153d38[_0x4641a2(0x220)]()[_0x4641a2(0x289)](0x3,'0');let _0x33d724=config[_0x4641a2(0x159)](_0x2b8be1=>_0x2b8be1[_0x4641a2(0x259)]==_0x290d62);if(!_0x33d724)break;}if(_0x290d62===_0x4641a2(0x285)){logger[_0x4641a2(0x27e)](_0x4641a2(0x20f));return;}logger[_0x4641a2(0x27e)](_0x4641a2(0x22f)+_0x290d62),dbConfig['get']('bots')[_0x4641a2(0x290)]({'botID':_0x290d62,'botname':'Bot\x20'+_0x290d62,'status':_0x4641a2(0x27d),'live':''})['write'](),startBot([_0x290d62,userID],{'cwd':bbpath},function(_0xd1a70b){const _0x5dd86e=_0x4641a2;if(_0xd1a70b)logger[_0x5dd86e(0x27e)](_0xd1a70b);}),config=getConfiguration(),io['to'](_0x4641a2(0x1f1))[_0x4641a2(0x18e)](_0x4641a2(0x1a8),config);}function deleteBot(_0x58efac){const _0x56e4fe=_0x3fc133;getClientsWithBotID(_0x58efac)['forEach'](_0x23ea7b=>{const _0x730ace=_0x2f00;getSocket(_0x23ea7b['id'])[_0x730ace(0x173)](!![]),removeClient(_0x23ea7b['id']);}),dbConfig[_0x56e4fe(0x2de)]('bots')[_0x56e4fe(0x174)]({'botID':_0x58efac})[_0x56e4fe(0x16c)](),logger[_0x56e4fe(0x27e)](_0x56e4fe(0x28f)+_0x58efac),stopBot(_0x58efac);try{fs['unlinkSync'](path[_0x56e4fe(0x240)](configpath,_0x56e4fe(0x145)+_0x58efac+_0x56e4fe(0x161))),fs[_0x56e4fe(0x2ae)](path[_0x56e4fe(0x240)](configpath,_0x56e4fe(0x145)+_0x58efac+'-events.json')),fs['unlinkSync'](path[_0x56e4fe(0x240)](configpath,'bot-'+_0x58efac+'-performance.json')),fs[_0x56e4fe(0x2ae)](path['join'](configpath,'bot-'+_0x58efac+'-results.json'));}catch(_0x3fe350){if(_0x3fe350)logger[_0x56e4fe(0x27e)](_0x56e4fe(0x2ac),_0x3fe350);}config=getConfiguration(),io['to']('botmanager')[_0x56e4fe(0x18e)](_0x56e4fe(0x1a8),config);}function toggleBot(_0x25391b,_0x43bf32,_0x26c3fb){const _0x5d5ee8=_0x3fc133;dbConfig['get'](_0x5d5ee8(0x1a8))[_0x5d5ee8(0x159)]({'botID':_0x25391b})[_0x5d5ee8(0x298)]({'status':_0x43bf32})[_0x5d5ee8(0x298)]({'live':_0x26c3fb})['write']();if(_0x43bf32==_0x5d5ee8(0x158)||_0x43bf32=='new')logger[_0x5d5ee8(0x27e)](_0x5d5ee8(0x1cd)+_0x25391b),startBot([_0x25391b,userID],{'cwd':bbpath},function(_0x4be1c0){const _0x40bd43=_0x5d5ee8;if(_0x4be1c0)logger[_0x40bd43(0x27e)](_0x4be1c0);});else(_0x43bf32==_0x5d5ee8(0x17d)||_0x43bf32==_0x5d5ee8(0x16a))&&(logger[_0x5d5ee8(0x27e)](_0x5d5ee8(0x24a)+_0x25391b),stopBot(_0x25391b));config=getConfiguration(),io['to']('botmanager')[_0x5d5ee8(0x18e)](_0x5d5ee8(0x1a8),config);}function toggleStatus(_0x6e2c4f){const _0x3020a2=_0x3fc133;let _0x34bd28=dbConfig['get'](_0x3020a2(0x1a8))[_0x3020a2(0x159)]({'botID':_0x6e2c4f})['value'](),_0x16d19f;if(_0x34bd28[_0x3020a2(0x16d)]===_0x3020a2(0x158))_0x16d19f=_0x3020a2(0x17d);else{if(_0x34bd28[_0x3020a2(0x16d)]==='new')_0x16d19f=_0x3020a2(0x16a);else{if(_0x34bd28['status']===_0x3020a2(0x16a))_0x16d19f=_0x3020a2(0x27d);else{if(_0x34bd28[_0x3020a2(0x16d)]===_0x3020a2(0x17d))_0x16d19f=_0x3020a2(0x158);}}}return _0x16d19f;}function updateStatus(_0x526389,_0xc7bf7d){const _0x4ba506=_0x3fc133;dbConfig['get']('bots')[_0x4ba506(0x159)]({'botID':_0x526389})[_0x4ba506(0x298)]({'status':_0xc7bf7d})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x4ba506(0x18e)](_0x4ba506(0x1a8),config);}function updateLive(_0x50249e,_0x26e420){const _0x213bbd=_0x3fc133;dbConfig[_0x213bbd(0x2de)](_0x213bbd(0x1a8))[_0x213bbd(0x159)]({'botID':_0x50249e})[_0x213bbd(0x298)]({'live':_0x26e420})[_0x213bbd(0x16c)](),config=getConfiguration(),io['to'](_0x213bbd(0x1f1))['emit'](_0x213bbd(0x1a8),config);}function updateBotName(_0x53cfed,_0x485103){const _0x5c0242=_0x3fc133;dbConfig[_0x5c0242(0x2de)](_0x5c0242(0x1a8))['find']({'botID':_0x53cfed})[_0x5c0242(0x298)]({'botname':_0x485103})['write'](),config=getConfiguration(),io['to'](_0x5c0242(0x1f1))['emit'](_0x5c0242(0x1a8),config);}function updateBotManager(){const _0x349a95=_0x3fc133;config=getConfiguration(),io['to'](_0x349a95(0x1f1))['emit'](_0x349a95(0x1a8),config);}function toggleBotMode(_0xa3bf5e){const _0x15bbfe=_0x3fc133;if(pid[_0xa3bf5e])pid[_0xa3bf5e][_0x15bbfe(0x231)]({'function':'toggleBotMode','args':null});else{const _0x28a97c=configpath+_0x15bbfe(0x145)+_0xa3bf5e+'-config.json',_0xaac1c4=fs['readFileSync'](_0x28a97c),_0x2ff1cf=JSON[_0x15bbfe(0x1aa)](_0xaac1c4),_0x5da75a=_0x2ff1cf['bot'][0x0][_0x15bbfe(0x247)];_0x2ff1cf[_0x15bbfe(0x2a0)][0x0][_0x15bbfe(0x247)]=!_0x5da75a;const _0x21c1d0=JSON[_0x15bbfe(0x208)](_0x2ff1cf,null,0x2);fs[_0x15bbfe(0x153)](_0x28a97c,_0x21c1d0),config=getConfiguration(),io['to'](_0x15bbfe(0x1f1))['emit'](_0x15bbfe(0x1a8),config);}}function telegramError(_0x41d96b){const _0x7215ce=_0x3fc133;logger[_0x7215ce(0x199)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x4e4cef){const _0x11bba6=_0x3fc133;if(_0x4e4cef[_0x11bba6(0x251)][_0x11bba6(0x2c0)]!=settings[_0x11bba6(0x28e)]&&'@'+_0x4e4cef[_0x11bba6(0x251)][_0x11bba6(0x2c0)]!=settings['telegramUsername'])return tgBot[_0x11bba6(0x261)](_0x4e4cef[_0x11bba6(0x20a)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x11bba6(0x2c6)})[_0x11bba6(0x2a8)](_0xb26b9b=>{telegramError(_0xb26b9b);}),![];return!![];}async function initTelegram(){const _0x58c215=_0x3fc133;if(tgBot)tgBot[_0x58c215(0x26e)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x58c215(0x2aa)],{'polling':!![]});let _0x5739b4=_0x58c215(0x230);_0x5739b4+='\x0a',_0x5739b4+='/enable\x20-\x20enable\x20notifications\x0a',_0x5739b4+=_0x58c215(0x238),_0x5739b4+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x5739b4+=_0x58c215(0x195),_0x5739b4+=_0x58c215(0x229),_0x5739b4+=_0x58c215(0x218),_0x5739b4+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x5739b4+='/names\x20-\x20show\x20bot\x20names\x0a',_0x5739b4+=_0x58c215(0x167),_0x5739b4+=_0x58c215(0x209),_0x5739b4+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x5739b4+=_0x58c215(0x18d);let _0x3355a2='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x3355a2+='\x0a',_0x3355a2+=_0x5739b4,tgBot[_0x58c215(0x1f3)](/\/start/,_0x1d80b0=>{const _0x4c6288=_0x58c215;if(!validateTelegram(_0x1d80b0))return;if(settings[_0x4c6288(0x2d5)]!=_0x1d80b0[_0x4c6288(0x20a)]['id'])updateSetting(_0x4c6288(0x2d5),_0x1d80b0['chat']['id']);updateSetting(_0x4c6288(0x187),!![]),tgBot[_0x4c6288(0x261)](_0x1d80b0[_0x4c6288(0x20a)]['id'],_0x3355a2)[_0x4c6288(0x2a8)](_0x3d7dba=>{telegramError(_0x3d7dba);});}),tgBot['onText'](/\/enable/,_0xea122e=>{const _0xba1ce=_0x58c215;if(!validateTelegram(_0xea122e))return;if(settings['telegramChatId']!=_0xea122e['chat']['id'])updateSetting(_0xba1ce(0x2d5),_0xea122e[_0xba1ce(0x20a)]['id']);updateSetting(_0xba1ce(0x187),!![]),tgBot[_0xba1ce(0x261)](_0xea122e[_0xba1ce(0x20a)]['id'],_0xba1ce(0x1cb))[_0xba1ce(0x2a8)](_0x16fdf6=>{telegramError(_0x16fdf6);});}),tgBot[_0x58c215(0x1f3)](/\/config/,async _0x574d33=>{const _0x5beaf4=_0x58c215;if(!validateTelegram(_0x574d33))return;tgBot[_0x5beaf4(0x164)](_0x5beaf4(0x1b9)),tgBot[_0x5beaf4(0x261)](_0x574d33[_0x5beaf4(0x20a)]['id'],_0x5beaf4(0x1c6),{'reply_markup':{'inline_keyboard':[[{'text':_0x5beaf4(0x267),'callback_data':'orders'},{'text':_0x5beaf4(0x225),'callback_data':_0x5beaf4(0x277)},{'text':_0x5beaf4(0x28a),'callback_data':_0x5beaf4(0x180)}]]}})[_0x5beaf4(0x2a8)](_0x398d4e=>{telegramError(_0x398d4e);}),tgBot['on'](_0x5beaf4(0x1b9),async _0x2dc69a=>{const _0x3b93ed=_0x5beaf4,_0x4b9ca5=_0x2dc69a['data'],_0x38150d=_0x2dc69a['message'];tgBot[_0x3b93ed(0x176)](_0x2dc69a['id'])[_0x3b93ed(0x2ad)](async()=>{const _0x3318e9=_0x3b93ed;_0x4b9ca5=='orders'&&(updateSetting(_0x3318e9(0x144),'orders'),updateSetting(_0x3318e9(0x187),!![]),await tgBot[_0x3318e9(0x261)](_0x38150d[_0x3318e9(0x20a)]['id'],_0x3318e9(0x1d3))[_0x3318e9(0x2a8)](_0x593df4=>{telegramError(_0x593df4);}));_0x4b9ca5==_0x3318e9(0x277)&&(updateSetting('telegramEvents',_0x3318e9(0x277)),updateSetting(_0x3318e9(0x187),!![]),await tgBot[_0x3318e9(0x261)](_0x38150d['chat']['id'],_0x3318e9(0x194))['catch'](_0x9f3e28=>{telegramError(_0x9f3e28);}));_0x4b9ca5==_0x3318e9(0x180)&&(updateSetting(_0x3318e9(0x144),_0x3318e9(0x180)),updateSetting(_0x3318e9(0x187),!![]),await tgBot[_0x3318e9(0x261)](_0x38150d[_0x3318e9(0x20a)]['id'],_0x3318e9(0x1a4))['catch'](_0x19488f=>{telegramError(_0x19488f);}));if(!settings[_0x3318e9(0x2d5)])tgBot[_0x3318e9(0x261)](_0x38150d[_0x3318e9(0x20a)]['id'],_0x3318e9(0x23b))[_0x3318e9(0x2a8)](_0x77987=>{telegramError(_0x77987);});}),tgBot[_0x3b93ed(0x164)](_0x3b93ed(0x1b9));});}),tgBot[_0x58c215(0x1f3)](/\/status/,_0x358684=>{const _0x769099=_0x58c215;if(!validateTelegram(_0x358684))return;const _0x492cbf=getBotsWithMode();let _0x214c8d=_0x769099(0x2d6);config[_0x769099(0x29c)](_0x21926e=>{const _0x30048e=_0x769099,_0x4a0658=_0x492cbf[_0x30048e(0x159)](_0x558235=>_0x558235['botID']==_0x21926e[_0x30048e(0x259)])[_0x30048e(0x193)];_0x214c8d+=_0x30048e(0x236)+_0x21926e[_0x30048e(0x259)]+':\x20'+_0x21926e[_0x30048e(0x16d)]+_0x30048e(0x2c9)+_0x4a0658+_0x30048e(0x2c9)+_0x21926e[_0x30048e(0x1c4)]+'\x0a';}),_0x214c8d+='\x0a',_0x214c8d+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x214c8d+=!settings['telegramEnabled']?_0x769099(0x245):_0x769099(0x1b1),_0x214c8d+=settings[_0x769099(0x187)]?settings[_0x769099(0x144)]=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x769099(0x217)+settings['telegramEvents']+_0x769099(0x2df):'',tgBot[_0x769099(0x261)](_0x358684[_0x769099(0x20a)]['id'],_0x214c8d,{'parse_mode':'HTML'})['catch'](_0x2463d3=>{telegramError(_0x2463d3);});}),tgBot[_0x58c215(0x1f3)](/\/restart/,_0x420a29=>{const _0x533169=_0x58c215;if(!validateTelegram(_0x420a29))return;tgBot[_0x533169(0x164)]('callback_query');const _0x2f6a98=getEnabledBots();if(_0x2f6a98['length']==0x0)tgBot[_0x533169(0x261)](_0x420a29[_0x533169(0x20a)]['id'],_0x533169(0x214))[_0x533169(0x2a8)](_0x149572=>{telegramError(_0x149572);});else{if(_0x2f6a98[_0x533169(0x235)]>0x1)_0x2f6a98[_0x533169(0x290)]({'botID':'all'});let _0x1b8fc3=[],_0x3db828=[];const _0x273586=_0x2f6a98['length']%0x4==0x0||_0x2f6a98[_0x533169(0x235)]%0x4==0x3||_0x2f6a98[_0x533169(0x235)]%0x3==0x1?0x4:0x3;let _0x9955eb=0x0;_0x2f6a98[_0x533169(0x29c)]((_0x4c17ae,_0x3be80e)=>{const _0x53c492=_0x533169;if(_0x3be80e%_0x273586==0x0)_0x3db828=[];_0x3db828[_0x53c492(0x290)]({'text':_0x4c17ae['botID']=='all'?_0x53c492(0x1cf):'Bot\x20'+_0x4c17ae[_0x53c492(0x259)],'callback_data':_0x4c17ae['botID']}),_0x3be80e%_0x273586==0x0&&(_0x1b8fc3[_0x9955eb]=_0x3db828,_0x9955eb++);}),tgBot['sendMessage'](_0x420a29[_0x533169(0x20a)]['id'],_0x533169(0x1a2),{'reply_markup':{'inline_keyboard':_0x1b8fc3}})[_0x533169(0x2a8)](_0x187f80=>{telegramError(_0x187f80);}),tgBot['on'](_0x533169(0x1b9),async _0x4db440=>{const _0x2eaad3=_0x533169,_0x10fbf2=_0x4db440[_0x2eaad3(0x253)],_0xd1f2f6=_0x4db440[_0x2eaad3(0x258)];tgBot[_0x2eaad3(0x176)](_0x4db440['id'])['then'](async()=>{const _0x29f3df=_0x2eaad3;_0x10fbf2==_0x29f3df(0x180)?config[_0x29f3df(0x29c)](_0x5e97cb=>{const _0x19eabc=_0x29f3df;restartBot(_0x5e97cb[_0x19eabc(0x259)]);}):restartBot(_0x10fbf2);}),tgBot[_0x2eaad3(0x164)]('callback_query');});}}),tgBot['onText'](/\/on/,_0x33bcaf=>{const _0x5b1c30=_0x58c215;if(!validateTelegram(_0x33bcaf))return;tgBot[_0x5b1c30(0x164)]('callback_query');const _0x110844=getDisabledBots();if(_0x110844['length']==0x0)tgBot[_0x5b1c30(0x261)](_0x33bcaf['chat']['id'],'All\x20bots\x20running\x20right\x20now')['catch'](_0x50ed43=>{telegramError(_0x50ed43);});else{if(_0x110844[_0x5b1c30(0x235)]>0x1)_0x110844[_0x5b1c30(0x290)]({'botID':_0x5b1c30(0x180)});let _0x4c3243=[],_0x58f358=[];const _0x33a74b=_0x110844[_0x5b1c30(0x235)]%0x4==0x0||_0x110844[_0x5b1c30(0x235)]%0x4==0x3||_0x110844[_0x5b1c30(0x235)]%0x3==0x1?0x4:0x3;let _0x1bec7d=0x0;_0x110844[_0x5b1c30(0x29c)]((_0xb2eaa6,_0x554653)=>{const _0x5987c6=_0x5b1c30;if(_0x554653%_0x33a74b==0x0)_0x58f358=[];_0x58f358['push']({'text':_0xb2eaa6[_0x5987c6(0x259)]==_0x5987c6(0x180)?'All\x20bots':_0x5987c6(0x236)+_0xb2eaa6[_0x5987c6(0x259)],'callback_data':_0xb2eaa6[_0x5987c6(0x259)]}),_0x554653%_0x33a74b==0x0&&(_0x4c3243[_0x1bec7d]=_0x58f358,_0x1bec7d++);}),tgBot[_0x5b1c30(0x261)](_0x33bcaf[_0x5b1c30(0x20a)]['id'],_0x5b1c30(0x221),{'reply_markup':{'inline_keyboard':_0x4c3243}})[_0x5b1c30(0x2a8)](_0x4c84fa=>{telegramError(_0x4c84fa);}),tgBot['on'](_0x5b1c30(0x1b9),async _0x3b54c0=>{const _0x308a3a=_0x5b1c30,_0x5159fe=_0x3b54c0[_0x308a3a(0x253)],_0x588df6=_0x3b54c0[_0x308a3a(0x258)];tgBot['answerCallbackQuery'](_0x3b54c0['id'])['then'](async()=>{const _0x2867f3=_0x308a3a;_0x5159fe==_0x2867f3(0x180)?(tgBot[_0x2867f3(0x261)](_0x588df6[_0x2867f3(0x20a)]['id'],_0x2867f3(0x1c7))['catch'](_0xc284ff=>{telegramError(_0xc284ff);}),_0x110844[_0x2867f3(0x29c)](_0x2f743f=>{const _0x15afe0=_0x2867f3;if(_0x2f743f[_0x15afe0(0x259)]!='all')toggleBot(_0x2f743f[_0x15afe0(0x259)],toggleStatus(_0x2f743f[_0x15afe0(0x259)]),_0x15afe0(0x1d5));})):(tgBot[_0x2867f3(0x261)](_0x588df6[_0x2867f3(0x20a)]['id'],_0x2867f3(0x1f6)+_0x5159fe)[_0x2867f3(0x2a8)](_0x13f42c=>{telegramError(_0x13f42c);}),toggleBot(_0x5159fe,toggleStatus(_0x5159fe),_0x2867f3(0x1d5)));}),tgBot[_0x308a3a(0x164)]('callback_query');});}}),tgBot[_0x58c215(0x1f3)](/\/off/,_0x5ef292=>{const _0x30a055=_0x58c215;if(!validateTelegram(_0x5ef292))return;tgBot[_0x30a055(0x164)](_0x30a055(0x1b9));const _0x37af2c=getEnabledBots();if(_0x37af2c[_0x30a055(0x235)]==0x0)tgBot[_0x30a055(0x261)](_0x5ef292[_0x30a055(0x20a)]['id'],_0x30a055(0x214))['catch'](_0x377d91=>{telegramError(_0x377d91);});else{if(_0x37af2c[_0x30a055(0x235)]>0x1)_0x37af2c['push']({'botID':'all'});let _0x4625d4=[],_0x2c3a8f=[];const _0x214b14=_0x37af2c[_0x30a055(0x235)]%0x4==0x0||_0x37af2c['length']%0x4==0x3||_0x37af2c['length']%0x3==0x1?0x4:0x3;let _0x1ad7dd=0x0;_0x37af2c[_0x30a055(0x29c)]((_0x5c1012,_0x4368af)=>{const _0x41a736=_0x30a055;if(_0x4368af%_0x214b14==0x0)_0x2c3a8f=[];_0x2c3a8f['push']({'text':_0x5c1012[_0x41a736(0x259)]==_0x41a736(0x180)?_0x41a736(0x1cf):'Bot\x20'+_0x5c1012['botID'],'callback_data':_0x5c1012[_0x41a736(0x259)]}),_0x4368af%_0x214b14==0x0&&(_0x4625d4[_0x1ad7dd]=_0x2c3a8f,_0x1ad7dd++);}),tgBot[_0x30a055(0x261)](_0x5ef292[_0x30a055(0x20a)]['id'],_0x30a055(0x22c),{'reply_markup':{'inline_keyboard':_0x4625d4}})[_0x30a055(0x2a8)](_0x4ca237=>{telegramError(_0x4ca237);}),tgBot['on'](_0x30a055(0x1b9),async _0x4a9d22=>{const _0x4d29b5=_0x30a055,_0x564464=_0x4a9d22['data'],_0xc32ffe=_0x4a9d22[_0x4d29b5(0x258)];tgBot[_0x4d29b5(0x176)](_0x4a9d22['id'])[_0x4d29b5(0x2ad)](async()=>{const _0x4e0eff=_0x4d29b5;_0x564464=='all'?(tgBot['sendMessage'](_0xc32ffe[_0x4e0eff(0x20a)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')['catch'](_0x5acc31=>{telegramError(_0x5acc31);}),_0x37af2c[_0x4e0eff(0x29c)](_0x1ed57c=>{const _0x5dfc95=_0x4e0eff;if(_0x1ed57c[_0x5dfc95(0x259)]!='all')toggleBot(_0x1ed57c[_0x5dfc95(0x259)],toggleStatus(_0x1ed57c[_0x5dfc95(0x259)]),_0x5dfc95(0x1d5));})):(tgBot[_0x4e0eff(0x261)](_0xc32ffe[_0x4e0eff(0x20a)]['id'],_0x4e0eff(0x1d9)+_0x564464)[_0x4e0eff(0x2a8)](_0x5d0bc5=>{telegramError(_0x5d0bc5);}),toggleBot(_0x564464,toggleStatus(_0x564464),_0x4e0eff(0x1d5)));}),tgBot[_0x4d29b5(0x164)](_0x4d29b5(0x1b9));});}}),tgBot[_0x58c215(0x1f3)](/\/portfolio/,_0x4353e0=>{const _0x2610bf=_0x58c215;if(!validateTelegram(_0x4353e0))return;tgBot[_0x2610bf(0x164)](_0x2610bf(0x1b9));const _0x400bf2=getEnabledBots();if(_0x400bf2[_0x2610bf(0x235)]==0x0)tgBot[_0x2610bf(0x261)](_0x4353e0[_0x2610bf(0x20a)]['id'],_0x2610bf(0x214))[_0x2610bf(0x2a8)](_0x330225=>{telegramError(_0x330225);});else{if(_0x400bf2[_0x2610bf(0x235)]>0x1){let _0x490ca7=[],_0x34f3ba=[];const _0x16b419=_0x400bf2[_0x2610bf(0x235)]%0x4==0x0||_0x400bf2[_0x2610bf(0x235)]%0x4==0x3||_0x400bf2['length']%0x3==0x1?0x4:0x3;let _0xf8d110=0x0;_0x400bf2[_0x2610bf(0x29c)]((_0x6ff2c3,_0x576c94)=>{const _0x3e0a14=_0x2610bf;if(_0x576c94%_0x16b419==0x0)_0x34f3ba=[];_0x34f3ba[_0x3e0a14(0x290)]({'text':_0x3e0a14(0x236)+_0x6ff2c3[_0x3e0a14(0x259)],'callback_data':_0x6ff2c3['botID']}),_0x576c94%_0x16b419==0x0&&(_0x490ca7[_0xf8d110]=_0x34f3ba,_0xf8d110++);}),tgBot[_0x2610bf(0x261)](_0x4353e0[_0x2610bf(0x20a)]['id'],_0x2610bf(0x1d4),{'reply_markup':{'inline_keyboard':_0x490ca7}})[_0x2610bf(0x2a8)](_0xa51f0e=>{telegramError(_0xa51f0e);}),tgBot['on'](_0x2610bf(0x1b9),async _0x492cf5=>{const _0x3f793e=_0x2610bf,_0x3c3a84=_0x492cf5[_0x3f793e(0x253)],_0x3ca19d=_0x492cf5['message'];tgBot['answerCallbackQuery'](_0x492cf5['id'])[_0x3f793e(0x2ad)](async()=>{if(pid[_0x3c3a84])pid[_0x3c3a84]['send']({'function':'sendPortfolioTelegram','args':null});}),tgBot['removeListener']('callback_query');});}else{const _0x302260=_0x400bf2[0x0][_0x2610bf(0x259)];if(pid[_0x302260])pid[_0x302260][_0x2610bf(0x231)]({'function':_0x2610bf(0x149),'args':null});}}}),tgBot[_0x58c215(0x1f3)](/\/update/,async _0x20632b=>{const _0x162fd0=_0x58c215;if(!validateTelegram(_0x20632b))return;tgBot['removeListener'](_0x162fd0(0x1b9)),await getMessages();if(!updateAvailable)tgBot['sendMessage'](_0x20632b[_0x162fd0(0x20a)]['id'],_0x162fd0(0x14e))[_0x162fd0(0x2a8)](_0x894feb=>{telegramError(_0x894feb);});else!validInstallation?tgBot[_0x162fd0(0x261)](_0x20632b[_0x162fd0(0x20a)]['id'],_0x162fd0(0x242))[_0x162fd0(0x2a8)](_0x5391b5=>{telegramError(_0x5391b5);}):(tgBot[_0x162fd0(0x261)](_0x20632b[_0x162fd0(0x20a)]['id'],_0x162fd0(0x269),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x162fd0(0x2c8)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x1baf8d=>{telegramError(_0x1baf8d);}),tgBot['on'](_0x162fd0(0x1b9),async _0x2b4f35=>{const _0x1d86b3=_0x162fd0,_0x9367c=_0x2b4f35['data'],_0x4705d9=_0x2b4f35[_0x1d86b3(0x258)];tgBot[_0x1d86b3(0x176)](_0x2b4f35['id'])[_0x1d86b3(0x2ad)](async()=>{const _0x500c26=_0x1d86b3;_0x9367c==_0x500c26(0x2c8)&&(await tgBot['sendMessage'](_0x4705d9['chat']['id'],_0x500c26(0x2d0))['catch'](_0x54631b=>{telegramError(_0x54631b);}),updateBB());_0x9367c=='no'&&await tgBot[_0x500c26(0x261)](_0x4705d9[_0x500c26(0x20a)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')[_0x500c26(0x2a8)](_0x2cb7d1=>{telegramError(_0x2cb7d1);});if(!settings[_0x500c26(0x2d5)])tgBot[_0x500c26(0x261)](_0x4705d9['chat']['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x500c26(0x2a8)](_0x5a50f5=>{telegramError(_0x5a50f5);});}),tgBot['removeListener']('callback_query');}));}),tgBot['onText'](/\/toggle/,_0x1396cd=>{const _0x1c63c7=_0x58c215;if(!validateTelegram(_0x1396cd))return;tgBot[_0x1c63c7(0x164)](_0x1c63c7(0x1b9));const _0x4a3635=getBotsWithMode();if(_0x4a3635[_0x1c63c7(0x235)]==0x0)tgBot[_0x1c63c7(0x261)](_0x1396cd['chat']['id'],_0x1c63c7(0x214))['catch'](_0x2fe9af=>{telegramError(_0x2fe9af);});else{let _0x313246=[],_0x5833d3=[];const _0x36313d=0x2;let _0x54d60=0x0;_0x4a3635['forEach']((_0xf25942,_0x5554af)=>{const _0x7cd44f=_0x1c63c7;if(_0x5554af%_0x36313d==0x0)_0x5833d3=[];_0x5833d3['push']({'text':_0x7cd44f(0x236)+_0xf25942['botID']+'\x20('+_0xf25942[_0x7cd44f(0x193)]+')','callback_data':_0xf25942[_0x7cd44f(0x259)]}),_0x5554af%_0x36313d==0x0&&(_0x313246[_0x54d60]=_0x5833d3,_0x54d60++);}),tgBot[_0x1c63c7(0x261)](_0x1396cd['chat']['id'],_0x1c63c7(0x2b9),{'reply_markup':{'inline_keyboard':_0x313246}})[_0x1c63c7(0x2a8)](_0xd86b42=>{telegramError(_0xd86b42);}),tgBot['on'](_0x1c63c7(0x1b9),async _0x2d9d01=>{const _0x2504c7=_0x1c63c7,_0x2c8233=_0x2d9d01[_0x2504c7(0x253)],_0x371830=_0x2d9d01[_0x2504c7(0x258)];tgBot[_0x2504c7(0x176)](_0x2d9d01['id'])[_0x2504c7(0x2ad)](async()=>{const _0x256411=_0x2504c7,_0x1ad44d=_0x4a3635[_0x256411(0x159)](_0x49c7fe=>_0x49c7fe['botID']==_0x2c8233),_0x401988=_0x1ad44d[_0x256411(0x193)]==_0x256411(0x163)?_0x256411(0x1db):_0x256411(0x163);tgBot[_0x256411(0x261)](_0x371830[_0x256411(0x20a)]['id'],_0x256411(0x168)+_0x2c8233+'\x20to\x20'+_0x401988+_0x256411(0x2b1))[_0x256411(0x2a8)](_0x24a40f=>{telegramError(_0x24a40f);}),toggleBotMode(_0x2c8233);}),tgBot[_0x2504c7(0x164)](_0x2504c7(0x1b9));});}}),tgBot[_0x58c215(0x1f3)](/\/names/,_0x2d891f=>{const _0x34a7ff=_0x58c215;if(!validateTelegram(_0x2d891f))return;let _0x11f9bf='';config[_0x34a7ff(0x29c)](_0x5e8346=>{const _0x3d6e84=_0x34a7ff;_0x11f9bf+=_0x3d6e84(0x236)+_0x5e8346[_0x3d6e84(0x259)]+':\x20'+_0x5e8346[_0x3d6e84(0x1c8)]+'\x0a';}),tgBot[_0x34a7ff(0x261)](_0x2d891f[_0x34a7ff(0x20a)]['id'],_0x11f9bf,{'parse_mode':_0x34a7ff(0x2c6)})['catch'](_0x445b30=>{telegramError(_0x445b30);});}),tgBot[_0x58c215(0x1f3)](/\/disable/,_0x58b3ff=>{const _0x330eab=_0x58c215;if(!validateTelegram(_0x58b3ff))return;tgBot[_0x330eab(0x261)](_0x58b3ff[_0x330eab(0x20a)]['id'],_0x330eab(0x1c2))[_0x330eab(0x2a8)](_0x2ddd98=>{telegramError(_0x2ddd98);}),updateSetting(_0x330eab(0x187),![]);}),tgBot[_0x58c215(0x1f3)](/\/help/,_0xe8cd59=>{const _0x4bc141=_0x58c215;if(!validateTelegram(_0xe8cd59))return;tgBot[_0x4bc141(0x261)](_0xe8cd59[_0x4bc141(0x20a)]['id'],_0x5739b4)[_0x4bc141(0x2a8)](_0x39e12c=>{telegramError(_0x39e12c);});}),tgBot['on'](_0x58c215(0x210),_0x101a59=>{const _0x2f3fa3=_0x58c215;_0x101a59['toString']()[_0x2f3fa3(0x232)](_0x2f3fa3(0x18c))&&(logger[_0x2f3fa3(0x27e)](_0x2f3fa3(0x2d8)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x2f3fa3(0x1f1))[_0x2f3fa3(0x18e)](_0x2f3fa3(0x1b3),_0x2f3fa3(0x2d8)));}),process[_0x58c215(0x27b)](_0x58c215(0x181),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);}),process[_0x58c215(0x27b)](_0x58c215(0x1bf),()=>{const _0xbea499=_0x58c215;if(tgBot)tgBot[_0xbea499(0x26e)]();process[_0xbea499(0x222)](0x1);});}}function disableTelegram(){const _0x821c13=_0x3fc133;tgBot&&(tgBot[_0x821c13(0x26e)](),tgBot=null);}function sendTelegram(_0x294478,_0xe5a485){const _0x1eaa93=_0x3fc133;if(settings[_0x1eaa93(0x187)]){if(settings['telegramEvents']=='all'||(_0xe5a485[_0x1eaa93(0x170)]==_0x1eaa93(0x1d8)||_0xe5a485['type']==_0x1eaa93(0x186)||_0xe5a485['type']==_0x1eaa93(0x243))&&settings[_0x1eaa93(0x144)]==_0x1eaa93(0x277)||_0xe5a485['type']==_0x1eaa93(0x198)&&settings[_0x1eaa93(0x144)]==_0x1eaa93(0x292)){if(tgBot&&settings[_0x1eaa93(0x2d5)]){if(_0xe5a485[_0x1eaa93(0x1f9)])tgBot[_0x1eaa93(0x261)](settings[_0x1eaa93(0x2d5)],_0xe5a485[_0x1eaa93(0x1c8)]+_0x1eaa93(0x26b)+_0xe5a485[_0x1eaa93(0x1e2)])[_0x1eaa93(0x2a8)](_0x392a88=>{telegramError(_0x392a88);});else tgBot[_0x1eaa93(0x261)](settings[_0x1eaa93(0x2d5)],_0x1eaa93(0x236)+_0x294478+_0x1eaa93(0x26b)+_0xe5a485[_0x1eaa93(0x1e2)])[_0x1eaa93(0x2a8)](_0x372482=>{telegramError(_0x372482);});}}}}async function sendTelegramMsg(_0x49cd24,_0x31b664=_0x3fc133(0x2c6)){const _0x549bc5=_0x3fc133;return settings[_0x549bc5(0x187)]&&tgBot&&settings[_0x549bc5(0x2d5)]?(await tgBot[_0x549bc5(0x261)](settings[_0x549bc5(0x2d5)],_0x49cd24,{'parse_mode':_0x31b664})[_0x549bc5(0x2a8)](_0x18728d=>{telegramError(_0x18728d);}),!![]):![];}function getDeviceWithIp(_0x267305){const _0x50a2b9=_0x3fc133;return devices[_0x50a2b9(0x159)](_0x4e4d54=>_0x4e4d54['ip']===_0x267305);}function _0x2f00(_0x2ef5b1,_0x5a09da){const _0x586614=_0x13b7();return _0x2f00=function(_0x346040,_0x577d86){_0x346040=_0x346040-0x141;let _0x13b7a1=_0x586614[_0x346040];return _0x13b7a1;},_0x2f00(_0x2ef5b1,_0x5a09da);}function temporaryAccess2FA(_0x65fcd0,_0x28d0bc){const _0x5415ba=_0x3fc133;let _0x5b6841=new Date(),_0x34c898=![];if(lastIpApproval){if(_0x5b6841-lastIpApproval<0x1388)_0x34c898=!![];}lastIpApproval=new Date();if(_0x34c898)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x5415ba(0x164)](_0x5415ba(0x1b9)),tgBot[_0x5415ba(0x261)](settings[_0x5415ba(0x2d5)],_0x5415ba(0x215)+normalizeIP(_0x28d0bc)[_0x5415ba(0x1ba)]+_0x5415ba(0x265),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x5415ba(0x2a2),'callback_data':'15'},{'text':_0x5415ba(0x28c),'callback_data':'30'},{'text':'reject','callback_data':_0x5415ba(0x216)}]]}})[_0x5415ba(0x2a8)](_0x3fe8ae=>{telegramError(_0x3fe8ae);}),tgBot['on']('callback_query',async _0x299203=>{const _0x207e76=_0x5415ba,_0x561a1f=_0x299203['data'],_0x1dbf7f=_0x299203[_0x207e76(0x258)];tgBot['answerCallbackQuery'](_0x299203['id'])[_0x207e76(0x2ad)](async()=>{const _0x1fd8c2=_0x207e76;devices[_0x65fcd0][_0x1fd8c2(0x15d)]={'clientip':_0x28d0bc,'timestamp':new Date()['getTime'](),'expiry':_0x561a1f},_0x561a1f!=_0x1fd8c2(0x216)?(await tgBot['sendMessage'](_0x1dbf7f[_0x1fd8c2(0x20a)]['id'],'Access\x20enabled\x20for\x20'+_0x561a1f+_0x1fd8c2(0x219),{'parse_mode':_0x1fd8c2(0x2c6)})['catch'](_0x1a9faa=>{telegramError(_0x1a9faa);}),io['to'](_0x65fcd0)[_0x1fd8c2(0x18e)](_0x1fd8c2(0x16d),{'access':{'allow':![],'reason':_0x1fd8c2(0x1ed),'token':null}})):(await tgBot[_0x1fd8c2(0x261)](_0x1dbf7f[_0x1fd8c2(0x20a)]['id'],_0x1fd8c2(0x2b0))[_0x1fd8c2(0x2a8)](_0x3cbc75=>{telegramError(_0x3cbc75);}),io['to'](_0x65fcd0)[_0x1fd8c2(0x18e)](_0x1fd8c2(0x16d),{'access':{'allow':![],'reason':_0x1fd8c2(0x1b0),'token':null}}));}),tgBot['removeListener'](_0x207e76(0x1b9));}));}function loginAccess2FA(_0xaada0c,_0x1d8e47){const _0x4fd083=_0x3fc133;tgBot&&settings[_0x4fd083(0x2d5)]&&(tgBot[_0x4fd083(0x164)](_0x4fd083(0x1b9)),tgBot[_0x4fd083(0x261)](settings[_0x4fd083(0x2d5)],_0x4fd083(0x1b5)+normalizeIP(_0x1d8e47)['show']+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x4fd083(0x1de),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x4fd083(0x216)}]]}})[_0x4fd083(0x2a8)](_0x74b7c1=>{telegramError(_0x74b7c1);}),tgBot['on']('callback_query',async _0x960d0f=>{const _0x5082ce=_0x4fd083,_0xab29d4=_0x960d0f['data'],_0x3ab94c=_0x960d0f[_0x5082ce(0x258)];tgBot[_0x5082ce(0x176)](_0x960d0f['id'])['then'](async()=>{const _0x3761f4=_0x5082ce;devices[_0xaada0c][_0x3761f4(0x1fc)]={'clientip':_0x1d8e47,'timestamp':new Date()['getTime'](),'expiry':_0xab29d4},_0xab29d4!=_0x3761f4(0x216)?(await tgBot[_0x3761f4(0x261)](_0x3ab94c[_0x3761f4(0x20a)]['id'],_0x3761f4(0x1bd),{'parse_mode':'HTML'})[_0x3761f4(0x2a8)](_0x1d2f7b=>{telegramError(_0x1d2f7b);}),io['to'](_0xaada0c)[_0x3761f4(0x18e)](_0x3761f4(0x16d),{'access':{'allow':![],'reason':_0x3761f4(0x1ed),'token':null}})):(await tgBot[_0x3761f4(0x261)](_0x3ab94c[_0x3761f4(0x20a)]['id'],'Login\x20rejected')['catch'](_0x28c497=>{telegramError(_0x28c497);}),io['to'](_0xaada0c)[_0x3761f4(0x18e)](_0x3761f4(0x16d),{'access':{'allow':![],'reason':_0x3761f4(0x19d),'token':null}}));}),tgBot[_0x5082ce(0x164)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1663be=_0x3fc133;return dbConfig[_0x1663be(0x2de)](_0x1663be(0x1a8))[_0x1663be(0x1f7)](_0x1663be(0x259))[_0x1663be(0x18b)]({'status':_0x1663be(0x158)})[_0x1663be(0x25c)]()||[];}function getDisabledBots(){const _0x56410a=_0x3fc133;return dbConfig[_0x56410a(0x2de)]('bots')[_0x56410a(0x1f7)](_0x56410a(0x259))[_0x56410a(0x18b)]({'status':_0x56410a(0x17d)})[_0x56410a(0x25c)]()||[];}function getBotAttributes(_0x3161db){const _0x46ac9d=_0x3fc133;let _0x31d20f={};const _0xbb5f32=configpath+_0x46ac9d(0x145)+_0x3161db+'-config.json',_0x2c2587=fs[_0x46ac9d(0x18a)](_0xbb5f32);if(_0x2c2587){const _0xa7157f=fs[_0x46ac9d(0x262)](_0xbb5f32);try{const _0x3a4ee6=JSON[_0x46ac9d(0x1aa)](_0xa7157f),_0x7b3cba=_0x3a4ee6?_0x3a4ee6[_0x46ac9d(0x2a0)][0x0][_0x46ac9d(0x247)]:![];_0x31d20f['mode']=_0x7b3cba?_0x46ac9d(0x163):_0x46ac9d(0x1db),_0x31d20f['botname']=_0x3a4ee6?_0x3a4ee6[_0x46ac9d(0x2a0)][0x0][_0x46ac9d(0x1c8)]:_0x46ac9d(0x236)+_0x3161db;}catch(_0x2e3f11){_0x31d20f[_0x46ac9d(0x193)]=_0x46ac9d(0x1db),_0x31d20f[_0x46ac9d(0x1c8)]='Bot\x20'+_0x3161db;}}else _0x31d20f[_0x46ac9d(0x193)]=_0x46ac9d(0x1db),_0x31d20f[_0x46ac9d(0x1c8)]=_0x46ac9d(0x236)+_0x3161db;return _0x31d20f;}function getBotsWithMode(){const _0x6a0162=_0x3fc133,_0x23791e=dbConfig[_0x6a0162(0x2de)]('bots')[_0x6a0162(0x1f7)](_0x6a0162(0x259))[_0x6a0162(0x25c)]()||[];return _0x23791e[_0x6a0162(0x29c)](_0x1c7a3e=>{const _0x795ff6=_0x6a0162;let _0x3c9ba2=getBotAttributes(_0x1c7a3e[_0x795ff6(0x259)]);_0x1c7a3e[_0x795ff6(0x193)]=_0x3c9ba2[_0x795ff6(0x193)];}),_0x23791e;}async function initUser(){const _0x469d53=_0x3fc133;if(!settings[_0x469d53(0x1f4)]){const _0xcaf703=uuidRandom();mixpanel[_0x469d53(0x1d0)](_0xcaf703),updateSetting(_0x469d53(0x1f4),_0xcaf703);}}async function initSecure(){const _0x1e9ba=_0x3fc133;let _0x25de92=getSecure();if(!_0x25de92[_0x1e9ba(0x234)](_0x1e9ba(0x2cc))){let _0x430c1b=await generateKeys();_0x25de92[_0x1e9ba(0x154)]=_0x430c1b['publicKey'],_0x25de92['privateKey']=_0x430c1b[_0x1e9ba(0x205)],_0x25de92['secret']=crypto[_0x1e9ba(0x1f2)](0x20)[_0x1e9ba(0x220)](_0x1e9ba(0x2ab));;storeSecure(_0x25de92);}}function getSettings(){const _0x318076=_0x3fc133;return dbSettings[_0x318076(0x2de)](_0x318076(0x25e))[_0x318076(0x25c)]()||{};}function getSecure(){const _0x44ad1d=_0x3fc133;return dbSecure[_0x44ad1d(0x2de)](_0x44ad1d(0x24e))[_0x44ad1d(0x25c)]()||{};}function getBlacklist(){const _0x5cc16d=_0x3fc133;return dbSecure[_0x5cc16d(0x2de)](_0x5cc16d(0x1c0))['value']()||[];}function broadcastToBots(_0x527b81,_0x305caa){config['forEach'](_0x2f301f=>{const _0xbd9349=_0x2f00;if(_0x2f301f['status']==_0xbd9349(0x158)&&_0x2f301f['live']=='running'){if(pid[_0x2f301f['botID']])pid[_0x2f301f[_0xbd9349(0x259)]][_0xbd9349(0x231)]({[_0x527b81]:_0x305caa});}});}function storeSettings(_0x4f9109,_0x526280=![]){const _0x209b73=_0x3fc133;_0x4f9109={...settings,..._0x4f9109};if(_0x526280&&_0x4f9109[_0x209b73(0x297)]!=_0x209b73(0x1ca)&&_0x4f9109[_0x209b73(0x297)]!='***'&&_0x4f9109[_0x209b73(0x297)]!=''){const _0x22edb2=crypt[_0x209b73(0x151)](secure[_0x209b73(0x205)],_0x4f9109[_0x209b73(0x297)])[_0x209b73(0x258)]['split']('@')[0x0],_0x56ee71=bcrypt[_0x209b73(0x1b8)](_0x22edb2,saltRounds);_0x4f9109={..._0x4f9109,'bbPassword':_0x56ee71};}if(_0x526280&&_0x4f9109[_0x209b73(0x2aa)]!='************'&&_0x4f9109[_0x209b73(0x2aa)]!=_0x209b73(0x24d)&&_0x4f9109[_0x209b73(0x2aa)]!=''){const _0x87e929=crypt[_0x209b73(0x151)](secure['privateKey'],_0x4f9109['telegramToken'])[_0x209b73(0x258)][_0x209b73(0x19c)]('@')[0x0];_0x4f9109={..._0x4f9109,'telegramToken':_0x87e929};}const _0x3321a7=_0x4f9109['telegramToken']!='************'&&_0x4f9109[_0x209b73(0x2aa)]!=settings[_0x209b73(0x2aa)]||_0x4f9109[_0x209b73(0x28e)]!=settings['telegramUsername'],_0x415e7b=_0x4f9109[_0x209b73(0x2aa)]==''||_0x4f9109['telegramUsername']=='';if(_0x3321a7)_0x4f9109[_0x209b73(0x144)]='all';for(const [_0x924cb2,_0x25a0fc]of Object[_0x209b73(0x1fe)](_0x4f9109)){if(_0x924cb2==_0x209b73(0x2aa)&&_0x25a0fc==_0x209b73(0x1ca)){_0x4f9109['telegramToken']=settings['telegramToken'];continue;};if(_0x924cb2=='bbPassword'&&_0x25a0fc==_0x209b73(0x1ca)){_0x4f9109['bbPassword']=settings[_0x209b73(0x297)];continue;};dbSettings[_0x209b73(0x184)](_0x209b73(0x2a4)+_0x924cb2,_0x25a0fc)[_0x209b73(0x16c)]();}settings=_0x4f9109,io['to'](_0x209b73(0x1f1))[_0x209b73(0x18e)](_0x209b73(0x25e),cleanSettings()),broadcastToBots(_0x209b73(0x1e8),settings[_0x209b73(0x1e8)]);if(_0x3321a7&&!_0x415e7b)initTelegram();if(_0x3321a7&&_0x415e7b)disableTelegram();getAllClients()['forEach'](_0x434e71=>{const _0x252cf1=_0x209b73;getSocket(_0x434e71['id'])[_0x252cf1(0x18e)](_0x252cf1(0x16d),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0xea3ea5,_0x29c8ca){const _0x418c87=_0x3fc133;dbSettings[_0x418c87(0x184)](_0x418c87(0x2a4)+_0xea3ea5,_0x29c8ca)[_0x418c87(0x16c)](),settings=getSettings(),io['to'](_0x418c87(0x1f1))[_0x418c87(0x18e)](_0x418c87(0x25e),cleanSettings());}function storeSecure(_0x1b7974){const _0x399e18=_0x3fc133;dbSecure['get']('secure')[_0x399e18(0x290)](_0x1b7974)[_0x399e18(0x16c)](),secure=_0x1b7974;}function addBlacklist(_0x3124c3){const _0x4c4180=_0x3fc133;cleanBlacklist();let _0x18c193;devices[_0x3124c3][_0x4c4180(0x15d)]?_0x18c193=Math[_0x4c4180(0x1ec)](devices[_0x3124c3][_0x4c4180(0x15d)][_0x4c4180(0x2b7)],loginExpiry):_0x18c193=loginExpiry,dbSecure['get']('blacklist')[_0x4c4180(0x290)]({'expiry':new Date()[_0x4c4180(0x160)]()+_0x18c193*0x3c*0x3e8,'token':devices[_0x3124c3][_0x4c4180(0x246)][_0x4c4180(0x179)]})[_0x4c4180(0x16c)](),blacklist=dbSecure['get'](_0x4c4180(0x1c0))[_0x4c4180(0x25c)]();}function cleanBlacklist(){const _0x1e67ec=_0x3fc133;let _0x4d2fb7=dbSecure[_0x1e67ec(0x2de)](_0x1e67ec(0x1c0))['cloneDeep']()[_0x1e67ec(0x25c)](),_0x4f100c=new Date()[_0x1e67ec(0x160)]();_0x4d2fb7[_0x1e67ec(0x29c)](_0x12527f=>{const _0x427a34=_0x1e67ec;_0x12527f[_0x427a34(0x2b7)]<_0x4f100c&&dbSecure[_0x427a34(0x2de)]('blacklist')['remove']({'expiry':_0x12527f[_0x427a34(0x2b7)]})[_0x427a34(0x16c)]();});}function initStates(){const _0x15c683=_0x3fc133;let _0x1b8066=getConfiguration();_0x1b8066[_0x15c683(0x29c)](_0x5b5f9b=>{const _0x535521=_0x15c683;_0x5b5f9b['live']=_0x535521(0x1d5);}),storeConfiguration(_0x1b8066);}function onKeys(){const _0x2541d9=new RSA();return new Promise(_0x2644e5=>{_0x2541d9['generateKeyPairAsync']()['then'](_0x1e3497=>{_0x2644e5(_0x1e3497);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2fd3f3=_0x3fc133;let _0x1ca5fe=getSettings(),_0x13a871=![];!_0x1ca5fe[_0x2fd3f3(0x234)](_0x2fd3f3(0x2db))&&(_0x1ca5fe[_0x2fd3f3(0x2db)]=0x0,_0x13a871=!![]);!_0x1ca5fe['hasOwnProperty']('lastmsgemitted')&&(_0x1ca5fe[_0x2fd3f3(0x17b)]=0x0,_0x13a871=!![]);!_0x1ca5fe[_0x2fd3f3(0x234)](_0x2fd3f3(0x2a7))&&(_0x1ca5fe['latestversion']='0.0.0',_0x13a871=!![]);if(_0x13a871)storeSettings(_0x1ca5fe);}function storeConfiguration(_0x329e88){const _0x35e81a=_0x3fc133;dbConfig[_0x35e81a(0x2de)](_0x35e81a(0x1a8))[_0x35e81a(0x174)]()['write'](),_0x329e88[_0x35e81a(0x29c)](_0x2fb57b=>{delete _0x2fb57b['mode'];}),dbConfig[_0x35e81a(0x2de)]('bots')[_0x35e81a(0x290)](..._0x329e88)[_0x35e81a(0x16c)](),config=_0x329e88;}function resetPassword(){const _0x3f51cd=_0x3fc133;tgBot&&settings[_0x3f51cd(0x2d5)]&&(tgBot[_0x3f51cd(0x164)](_0x3f51cd(0x1b9)),tgBot['sendMessage'](settings[_0x3f51cd(0x2d5)],_0x3f51cd(0x1ea),{'parse_mode':_0x3f51cd(0x2c6),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x3f51cd(0x2c8)},{'text':'no','callback_data':'no'}]]}})[_0x3f51cd(0x2a8)](_0x113479=>{telegramError(_0x113479);}),tgBot['on'](_0x3f51cd(0x1b9),async _0x5ed092=>{const _0x211f71=_0x3f51cd,_0x3a73ac=_0x5ed092['data'],_0x1dd00f=_0x5ed092[_0x211f71(0x258)];tgBot[_0x211f71(0x176)](_0x5ed092['id'])['then'](async()=>{const _0x57f8d6=_0x211f71;if(_0x3a73ac!='no'){const _0x59d73a=0xf,_0x1363e2=_0x57f8d6(0x260),_0x3ab43e=Array[_0x57f8d6(0x251)](crypto[_0x57f8d6(0x185)](new Uint32Array(_0x59d73a)))[_0x57f8d6(0x293)](_0x1b7488=>_0x1363e2[_0x1b7488%_0x1363e2[_0x57f8d6(0x235)]])[_0x57f8d6(0x240)](''),_0xc09ed7=bcrypt[_0x57f8d6(0x1b8)](_0x3ab43e,saltRounds);storeSettings({'bbPassword':_0xc09ed7}),await tgBot[_0x57f8d6(0x261)](_0x1dd00f[_0x57f8d6(0x20a)]['id'],_0x57f8d6(0x279)+_0x3ab43e,{'parse_mode':_0x57f8d6(0x2c6)})[_0x57f8d6(0x2a8)](_0x2d3ef7=>{telegramError(_0x2d3ef7);});}else await tgBot[_0x57f8d6(0x261)](_0x1dd00f[_0x57f8d6(0x20a)]['id'],_0x57f8d6(0x1dc))['catch'](_0x141f4c=>{telegramError(_0x141f4c);});}),tgBot[_0x211f71(0x164)]('callback_query');}));}async function confirmRestore(_0x3b6f56,_0x138dff){const _0x4d6ed7=_0x3fc133;tgBot&&settings[_0x4d6ed7(0x2d5)]&&(tgBot[_0x4d6ed7(0x164)](_0x4d6ed7(0x1b9)),await tgBot[_0x4d6ed7(0x261)](settings[_0x4d6ed7(0x2d5)],_0x4d6ed7(0x141),{'parse_mode':_0x4d6ed7(0x2c6),'reply_markup':{'inline_keyboard':[[{'text':_0x4d6ed7(0x2c8),'callback_data':_0x4d6ed7(0x2c8)},{'text':'no','callback_data':'no'}]]}})[_0x4d6ed7(0x2a8)](_0x516767=>{telegramError(_0x516767);}),tgBot['on'](_0x4d6ed7(0x1b9),async _0x40ad4c=>{const _0x3c89ec=_0x4d6ed7,_0x197f33=_0x40ad4c[_0x3c89ec(0x253)],_0x96bdd1=_0x40ad4c[_0x3c89ec(0x258)];tgBot[_0x3c89ec(0x176)](_0x40ad4c['id'])[_0x3c89ec(0x2ad)](async()=>{const _0x304ecd=_0x3c89ec;_0x197f33!='no'?(await tgBot[_0x304ecd(0x261)](_0x96bdd1[_0x304ecd(0x20a)]['id'],_0x304ecd(0x29d),{'parse_mode':'HTML'})[_0x304ecd(0x2a8)](_0x5e261e=>{telegramError(_0x5e261e);}),unzipFile(_0x3b6f56,_0x138dff)):await tgBot[_0x304ecd(0x261)](_0x96bdd1['chat']['id'],_0x304ecd(0x25d))['catch'](_0x5e40e1=>{telegramError(_0x5e40e1);});}),tgBot[_0x3c89ec(0x164)](_0x3c89ec(0x1b9));}));}function getServerTime(){const _0x2648cb=_0x3fc133,_0x2d6e93=new Date();return _0x2d6e93[_0x2648cb(0x1c9)]()+'/'+(_0x2d6e93[_0x2648cb(0x17c)]()+0x1)[_0x2648cb(0x220)]()[_0x2648cb(0x289)](0x2,'0')+'/'+_0x2d6e93[_0x2648cb(0x29e)]()['toString']()[_0x2648cb(0x289)](0x2,'0')+'\x20'+_0x2d6e93[_0x2648cb(0x171)]()[_0x2648cb(0x220)]()[_0x2648cb(0x289)](0x2,'0')+':'+_0x2d6e93[_0x2648cb(0x2d3)]()['toString']()[_0x2648cb(0x289)](0x2,'0')+':'+_0x2d6e93[_0x2648cb(0x172)]()['toString']()[_0x2648cb(0x289)](0x2,'0');}function getTimeStamp(){const _0x5b7cda=_0x3fc133,_0x4fecae=shiftedTime();return _0x4fecae[_0x5b7cda(0x1c9)]()+'/'+(_0x4fecae[_0x5b7cda(0x17c)]()+0x1)[_0x5b7cda(0x220)]()['padStart'](0x2,'0')+'/'+_0x4fecae[_0x5b7cda(0x29e)]()[_0x5b7cda(0x220)]()[_0x5b7cda(0x289)](0x2,'0')+'\x20'+_0x4fecae[_0x5b7cda(0x171)]()[_0x5b7cda(0x220)]()[_0x5b7cda(0x289)](0x2,'0')+':'+_0x4fecae[_0x5b7cda(0x2d3)]()[_0x5b7cda(0x220)]()[_0x5b7cda(0x289)](0x2,'0')+':'+_0x4fecae[_0x5b7cda(0x172)]()['toString']()[_0x5b7cda(0x289)](0x2,'0');}function shiftedTime(){const _0x44677b=_0x3fc133,_0x44f1fd=new Date();let _0x25dc70=_0x44f1fd;if(settings['timeshift']&&settings[_0x44677b(0x1e8)]!==0x0)_0x25dc70=fns[_0x44677b(0x249)](_0x44f1fd,{'hours':settings[_0x44677b(0x1e8)]});return _0x25dc70;}function startScheduler(){const _0x7817e4=_0x3fc133,_0x430711=new Date()[_0x7817e4(0x18f)](),_0x2e677a=shiftedTime()[_0x7817e4(0x171)]();_0x2e677a==0x4&&backupConfigFiles();_0x2e677a==0x0&&rotateLogFiles();_0x430711%0x6==0x0&&triggerAnalytics();_0x430711%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function backupConfigFiles(){const _0x3b2141=_0x3fc133;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x3b2141(0x29c)](_0x1e364d=>{const _0x588c42=_0x3b2141;if(!_0x1e364d[_0x588c42(0x2bd)]())fs[_0x588c42(0x1ab)](configpath+_0x1e364d[_0x588c42(0x1e0)],configbackuppath+_0x1e364d['name']);});}function rotateLogFiles(){const _0x30f917=_0x3fc133,_0x2d9a87=fs['statSync'](logspath+_0x30f917(0x157)),_0xa8a63f=_0x2d9a87[_0x30f917(0x2c2)]/0x400;if(_0xa8a63f>0x32){let _0x1e0364=fs[_0x30f917(0x2d4)](logspath,{'withFileTypes':!![]});_0x1e0364['sort']((_0x2114ec,_0xcec752)=>_0x2114ec[_0x30f917(0x1e0)]<_0xcec752[_0x30f917(0x1e0)]?0x1:_0xcec752[_0x30f917(0x1e0)]<_0x2114ec[_0x30f917(0x1e0)]?-0x1:0x0),_0x1e0364[_0x30f917(0x29c)](_0x1e7a1b=>{const _0x16fc1f=_0x30f917;if(_0x1e7a1b[_0x16fc1f(0x1e0)]=='output-002.log')fs[_0x16fc1f(0x1ab)](logspath+_0x1e7a1b[_0x16fc1f(0x1e0)],logspath+_0x16fc1f(0x25a));if(_0x1e7a1b[_0x16fc1f(0x1e0)]==_0x16fc1f(0x283))fs[_0x16fc1f(0x1ab)](logspath+_0x1e7a1b[_0x16fc1f(0x1e0)],logspath+_0x16fc1f(0x2da));_0x1e7a1b[_0x16fc1f(0x1e0)]==_0x16fc1f(0x157)&&(fs[_0x16fc1f(0x1ab)](logspath+_0x1e7a1b[_0x16fc1f(0x1e0)],logspath+_0x16fc1f(0x283)),fs['writeFileSync'](logspath+_0x1e7a1b['name'],''));});}}async function zipFiles(_0x1113f0){const _0x27c08a=_0x3fc133;let _0x550816;if(_0x1113f0==_0x27c08a(0x152))_0x550816=logspath;if(_0x1113f0=='backup')_0x550816=configpath;let _0x2237d2=fs[_0x27c08a(0x2d4)](_0x550816,{'withFileTypes':!![]});const _0x554102=new require(_0x27c08a(0x1fb))();_0x2237d2[_0x27c08a(0x29c)](_0x539f81=>{const _0x477aad=_0x27c08a;if(!_0x539f81['isDirectory']()){let _0x3b55fc=fs['readFileSync'](_0x550816+_0x539f81['name']);const _0x2a454f=/^bot-[0-9]{3}-config.json$/,_0x2c14b1=_0x2a454f[_0x477aad(0x146)](_0x539f81[_0x477aad(0x1e0)]);if(_0x2c14b1){const _0x1923d2=JSON[_0x477aad(0x1aa)](_0x3b55fc);_0x1923d2[_0x477aad(0x2a0)][0x0][_0x477aad(0x1e9)]=_0x477aad(0x24d),_0x1923d2[_0x477aad(0x2a0)][0x0][_0x477aad(0x1df)]=_0x477aad(0x24d),_0x3b55fc=JSON[_0x477aad(0x208)](_0x1923d2,null,0x2);}if(_0x539f81[_0x477aad(0x1e0)]=='bb-settings.json'){const _0x2c4eea=JSON[_0x477aad(0x1aa)](_0x3b55fc);if(_0x2c4eea['settings'][_0x477aad(0x15e)])_0x2c4eea[_0x477aad(0x25e)]['loginRequired']=![];if(_0x2c4eea['settings']['bbPassword'])_0x2c4eea['settings'][_0x477aad(0x297)]=_0x477aad(0x24d);if(_0x2c4eea[_0x477aad(0x25e)]['telegramToken'])_0x2c4eea['settings'][_0x477aad(0x2aa)]=_0x477aad(0x24d);if(_0x2c4eea['settings']['telegramChatId'])_0x2c4eea['settings']['telegramChatId']=null;_0x3b55fc=JSON[_0x477aad(0x208)](_0x2c4eea,null,0x2);}if(_0x539f81[_0x477aad(0x1e0)]!=_0x477aad(0x2b2))_0x554102[_0x477aad(0x2ce)](_0x539f81[_0x477aad(0x1e0)],_0x3b55fc);}});const _0x1492af=_0x554102[_0x27c08a(0x24c)]({'base64':![],'compression':_0x27c08a(0x250)});fs[_0x27c08a(0x153)](zippath+(_0x1113f0+_0x27c08a(0x273)),_0x1492af,_0x27c08a(0x291));}async function unzipFile(_0x1dc425,_0x388abe){const _0x547f3e=_0x3fc133;await backupConfigFiles(),fs[_0x547f3e(0x2d4)](configpath,{'withFileTypes':!![]})[_0x547f3e(0x29c)](_0x19c765=>{const _0xa50976=_0x547f3e;if(!_0x19c765[_0xa50976(0x2bd)]())fs[_0xa50976(0x165)](configpath+_0x19c765[_0xa50976(0x1e0)]);});const _0xa24804=fs[_0x547f3e(0x262)](_0x1dc425+_0x388abe,_0x547f3e(0x291)),_0x54b3ec=new require(_0x547f3e(0x1fb))(_0xa24804,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x54b3ec[_0x547f3e(0x1eb)])[_0x547f3e(0x29c)](_0xe14d9e=>{const _0xeeed78=_0x547f3e,_0x2df539=_0x54b3ec['files'][_0xe14d9e];fs[_0xeeed78(0x153)](configpath+_0x2df539[_0xeeed78(0x1e0)],_0x2df539[_0xeeed78(0x15a)]);}),fs[_0x547f3e(0x2d4)](temppath,{'withFileTypes':!![]})[_0x547f3e(0x29c)](_0x11b8df=>{const _0x63a687=_0x547f3e;if(!_0x11b8df[_0x63a687(0x2bd)]())fs[_0x63a687(0x165)](temppath+_0x11b8df['name']);}),process[_0x547f3e(0x231)]({'restore':!![]},_0x3d7304=>{});}async function getPublicIp(){const _0x38b242=_0x3fc133;try{const _0x4fedee=await axios['get'](_0x38b242(0x150));publicip=_0x4fedee[_0x38b242(0x253)]['ip'];}catch(_0x1719e9){}}async function triggerAnalytics(){const _0x1a5a68=_0x3fc133;if(!publicip)await getPublicIp();const _0x1f946a=getBotsWithMode();let _0x3ce262=0x0;_0x1f946a['forEach'](_0x57108f=>{const _0x15b931=_0x2f00;if(_0x57108f[_0x15b931(0x16d)]===_0x15b931(0x158))_0x3ce262++;}),mixpanel[_0x1a5a68(0x27c)](_0x1a5a68(0x22d),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x1f946a[_0x1a5a68(0x235)],'numbotsenabled':_0x3ce262});}async function getMessages(){const _0x47487c=_0x3fc133,_0xba5766=_0x47487c(0x1ff),_0x2bfd97=new GraphQLClient(_0xba5766),_0xcfd581={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x387abe=serverversion['split']('.'),_0x3c871a=_0x387abe[0x0]+'.'+_0x387abe[0x1],_0x4e75da=Math[_0x47487c(0x294)](settings[_0x47487c(0x2db)],settings['lastmsgemitted']),_0x24e3f9={'last':parseInt(_0x4e75da),'bbm':_0x3c871a},_0x231648=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x47a404;try{_0x47a404=await _0x2bfd97[_0x47487c(0x1cc)](_0x231648,_0x24e3f9,_0xcfd581);}catch(_0x4401a9){}if(_0x47a404&&_0x47a404[_0x47487c(0x1d2)]){let _0xcfc903=settings[_0x47487c(0x2db)];newMessages=[];for(const _0x44b46a of _0x47a404['messages']){newMessages[_0x47487c(0x290)](_0x44b46a);if(_0x44b46a[_0x47487c(0x252)])updateSetting('latestversion',_0x44b46a[_0x47487c(0x252)]);let _0x119ae0=_0x44b46a['bbvNew']?serverversion>=_0x44b46a[_0x47487c(0x252)]:![];if(!_0x119ae0&&_0x44b46a[_0x47487c(0x2d7)]>_0xcfc903){if(_0x44b46a[_0x47487c(0x1d1)]===_0x47487c(0x25b)||serverversion['startsWith'](_0x44b46a[_0x47487c(0x1d1)])){let _0x4bc840=''+_0x44b46a[_0x47487c(0x182)]+'\x0a\x0a'+_0x44b46a[_0x47487c(0x258)];const _0x185001=await sendTelegramMsg(toTelegramMarkdown(_0x4bc840),_0x47487c(0x14a));if(_0x185001)_0xcfc903=_0x44b46a[_0x47487c(0x2d7)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x47487c(0x2db),_0xcfc903),emitMessages();}}function emitMessages(){const _0x3b6a36=_0x3fc133,_0x3d07cb=settings[_0x3b6a36(0x17b)];let _0x2e9b54=[];newMessages[_0x3b6a36(0x29c)](_0x4c7cbc=>{const _0x46afe5=_0x3b6a36;_0x4c7cbc[_0x46afe5(0x2d7)]>_0x3d07cb&&_0x2e9b54[_0x46afe5(0x290)](_0x4c7cbc);}),_0x2e9b54['length']>0x0&&getAllClients()['forEach'](_0x1c2e0d=>{const _0x51edbe=_0x3b6a36;getSocket(_0x1c2e0d['id'])[_0x51edbe(0x18e)]('message',_0x2e9b54);});}function confirmMessage(_0x541011){updateSetting('lastmsgemitted',Number(_0x541011));}function isNewerVersion(_0x34075e,_0x1bbdf6){const _0x5d7c2a=_0x3fc133,_0x350914=_0x1bbdf6[_0x5d7c2a(0x19c)]('.'),_0x23dacc=_0x34075e['split']('.');for(var _0x4b4b0d=0x0;_0x4b4b0d<_0x23dacc[_0x5d7c2a(0x235)];_0x4b4b0d++){const _0xd7115b=~~_0x23dacc[_0x4b4b0d],_0x4b9d1f=~~_0x350914[_0x4b4b0d];if(_0xd7115b>_0x4b9d1f)return!![];if(_0xd7115b<_0x4b9d1f)return![];}return![];}function toTelegramMarkdown(_0x4e19c4){const _0x17d56d=_0x3fc133,_0x24bb4b=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x48d4ef=/\*{2}(.+?)\*{2}/gim;return _0x4e19c4=_0x4e19c4[_0x17d56d(0x17f)](_0x24bb4b,'$1_$2_$3')[_0x17d56d(0x17f)](_0x48d4ef,_0x17d56d(0x26d)),_0x4e19c4;}async function validateConfigFile(){const _0x36b045=_0x3fc133,_0x4a914c=dbConfig[_0x36b045(0x2de)]('bots')[_0x36b045(0x1f7)](_0x36b045(0x259))['value']()||[];if(_0x4a914c['length']==0x0){let _0x15015a=0x0,_0x5134da=[];const _0x2bc131=/^bot-([0-9]{3})-config.json$/,_0x3c1814=fs[_0x36b045(0x2d4)](configpath);_0x3c1814[_0x36b045(0x29c)](_0x501f5b=>{const _0xef14bc=_0x36b045,_0x12e321=_0x2bc131[_0xef14bc(0x20d)](_0x501f5b);if(_0x12e321){const _0x42225d=_0x12e321[0x1];let _0x371fbf=getBotAttributes(_0x42225d);_0x5134da['push']({'botID':_0x42225d,'botname':_0x371fbf['botname'],'status':_0xef14bc(0x17d),'live':_0xef14bc(0x1d5)}),_0x15015a++;}}),_0x15015a!=0x0&&(dbConfig[_0x36b045(0x2de)](_0x36b045(0x1a8))[_0x36b045(0x298)](_0x5134da)[_0x36b045(0x16c)](),config=_0x5134da,restoredConfigFile=_0x15015a);}}async function restoreConfigNotify(_0x46e357){const _0x5e29b4=_0x3fc133;let _0x2a156f;if(restoredConfigFile==0x1)_0x2a156f='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x2a156f=_0x5e29b4(0x264);if(_0x46e357)io['to'](_0x5e29b4(0x1f1))[_0x5e29b4(0x18e)](_0x5e29b4(0x1b3),_0x2a156f);else{logger['simple'](_0x5e29b4(0x223)),logger['simple'](_0x2a156f),logger[_0x5e29b4(0x199)](_0x5e29b4(0x223)),logger[_0x5e29b4(0x199)]('');if(tgBot&&settings[_0x5e29b4(0x2d5)]&&settings[_0x5e29b4(0x144)]!=_0x5e29b4(0x292))tgBot['sendMessage'](settings[_0x5e29b4(0x2d5)],_0x5e29b4(0x22a)+_0x2a156f)[_0x5e29b4(0x2a8)](_0x487ad8=>{telegramError(_0x487ad8);});}}function validateCredentials(_0x31a69b,_0xf7e3b2){const _0x43750d=_0x3fc133;if(_0x31a69b[_0x43750d(0x2c0)]==settings[_0x43750d(0x272)]&&bcrypt[_0x43750d(0x1a6)](_0x31a69b[_0x43750d(0x28d)],settings[_0x43750d(0x297)])){if(settings[_0x43750d(0x281)])return{'allow':![],'reason':_0x43750d(0x1ac),'token':null};else{const _0x2dfed9=generateLoginToken(_0xf7e3b2);return{'allow':!![],'reason':_0x43750d(0x2c3),'token':_0x2dfed9};}}else return{'allow':![],'reason':_0x43750d(0x295),'token':null};}function refreshToken(_0x2edcde){const _0xcd8a43=_0x3fc133,_0x5c6486=generateLoginToken(_0x2edcde);return{'allow':!![],'reason':_0xcd8a43(0x2c3),'token':_0x5c6486};}function validateAccess(_0x203029,_0x2b3dd2,_0x5870c2){const _0x45a6ff=_0x3fc133,_0x4d26fe=_0x5870c2?_0x5870c2:devices[_0x2b3dd2]['ip'];let _0x273492;const _0x1bf7b7=_0x3f8665=>{const _0x3ece27=_0x2f00;if(settings['loginRequired']){if(settings[_0x3ece27(0x281)]){if(telegram2FaApproved(_0x2b3dd2)){const _0x21d001=generateLoginToken(_0x2b3dd2);return{'allow':!![],'reason':_0x3ece27(0x270),'token':_0x21d001};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x273492=validToken(_0x3f8665,_0x2b3dd2),_0x273492['hasOwnProperty'](_0x3ece27(0x243))?{'allow':!![],'reason':_0x3ece27(0x143),'token':_0x3f8665}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x45a6ff(0x201)]){let _0x306b58=[...settings[_0x45a6ff(0x16f)],_0x45a6ff(0x17e),_0x45a6ff(0x282),_0x45a6ff(0x257)];if(_0x306b58[_0x45a6ff(0x232)](_0x4d26fe))return _0x1bf7b7(_0x203029);else{_0x273492=validToken(_0x203029,_0x2b3dd2);if(_0x273492['hasOwnProperty'](_0x45a6ff(0x243)))return _0x1bf7b7(_0x203029);else{if(telegramIpApproved(_0x2b3dd2)){const _0x5f0bd1=generateToken(_0x2b3dd2);return _0x273492=_0x1bf7b7(_0x203029),_0x273492[_0x45a6ff(0x15c)]?{'allow':!![],'reason':_0x45a6ff(0x17a),'token':_0x5f0bd1}:_0x273492;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x45a6ff(0x2bf),'token':null}:{'allow':![],'reason':_0x45a6ff(0x156),'token':null};}}}else return _0x1bf7b7(_0x203029);}function timelyDecrypt(_0x306e5f,_0x15a0f6=!![]){const _0x22e613=_0x3fc133;if(_0x306e5f)try{const _0x23ff96=crypt['decrypt'](secure[_0x22e613(0x205)],_0x306e5f)[_0x22e613(0x258)],_0x310369=_0x23ff96[_0x22e613(0x19c)]('@')[0x0],_0x2e9ef4=_0x23ff96[_0x22e613(0x19c)]('@')[0x1],_0x1d2d53=new Date()['getTime']();if(_0x15a0f6){if(_0x1d2d53-_0x2e9ef4<maxSecretAge*0x3e8)return _0x310369;else return![];}else return _0x310369;}catch(_0x467e28){return![];}else return![];}const validToken=(_0x2c1a13,_0x3443aa)=>{const _0xb1465=_0x3fc133,_0x15bc99=devices[_0x3443aa]['ip'];if(!_0x2c1a13)return{'error':'No\x20authentication\x20token'};for(let _0x5e60f6 of blacklist){if(_0x5e60f6[_0xb1465(0x179)]==_0x2c1a13)return{'error':_0xb1465(0x1d6)};}let _0x487241;try{_0x487241=jwt['verify'](_0x2c1a13,secure['secret']+_0x3443aa);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x487241[_0xb1465(0x234)](_0xb1465(0x1b6))&&!_0x487241[_0xb1465(0x234)](_0xb1465(0x2c0))||!_0x487241['hasOwnProperty'](_0xb1465(0x2c5)))return{'error':_0xb1465(0x20b)};if(!_0x487241[_0xb1465(0x234)]('username')&&_0x487241[_0xb1465(0x234)](_0xb1465(0x1b6))){const {clientip:_0x4bb573}=_0x487241;return _0x15bc99==_0x4bb573?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x487241[_0xb1465(0x234)]('username')&&_0x487241[_0xb1465(0x234)](_0xb1465(0x1b6))){const {username:_0x4d873e,clientip:_0x2054ac}=_0x487241;return settings[_0xb1465(0x272)]==_0x4d873e&&_0x15bc99==_0x2054ac?{'success':'User\x20has\x20been\x20validated'}:{'error':_0xb1465(0x263)};}}},generateLoginToken=_0x94490b=>{const _0x5837dc=_0x3fc133;if(_0x94490b){const _0x1f9abd=devices[_0x94490b]['ip'];return jwt[_0x5837dc(0x1ae)]({'username':settings['bbUsername'],'clientip':_0x1f9abd},secure['secret']+_0x94490b,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x20e742=>{const _0x5985cc=_0x3fc133;if(_0x20e742){const _0x10bb91=devices[_0x20e742]['ip'];return jwt['sign']({'clientip':_0x10bb91},secure[_0x5985cc(0x2cc)]+_0x20e742,{'expiresIn':devices[_0x20e742][_0x5985cc(0x15d)][_0x5985cc(0x2b7)]*0x3c});}else return![];},telegramIpApproved=_0x5ffb78=>{const _0xe15f97=_0x3fc133;let _0x1def72=![];return devices[_0x5ffb78]['telegramIpApproval']&&devices[_0x5ffb78][_0xe15f97(0x15d)][_0xe15f97(0x2b7)]!=_0xe15f97(0x216)&&(_0x1def72=devices[_0x5ffb78][_0xe15f97(0x15d)][_0xe15f97(0x1b6)]==devices[_0x5ffb78]['ip']&&new Date()[_0xe15f97(0x160)]()-devices[_0x5ffb78][_0xe15f97(0x15d)][_0xe15f97(0x276)]<devices[_0x5ffb78]['telegramIpApproval'][_0xe15f97(0x2b7)]*0x3c*0x3e8),_0x1def72;},telegram2FaApproved=_0x137969=>{const _0x4209c9=_0x3fc133;let _0x4ea94f=![];return devices[_0x137969][_0x4209c9(0x1fc)]&&devices[_0x137969][_0x4209c9(0x1fc)][_0x4209c9(0x2b7)]!=_0x4209c9(0x216)&&(_0x4ea94f=devices[_0x137969][_0x4209c9(0x1fc)][_0x4209c9(0x1b6)]==devices[_0x137969]['ip']&&new Date()[_0x4209c9(0x160)]()-devices[_0x137969][_0x4209c9(0x1fc)][_0x4209c9(0x276)]<devices[_0x137969][_0x4209c9(0x1fc)][_0x4209c9(0x2b7)]*0x3c*0x3e8),_0x4ea94f;},normalizeIP=_0x48a981=>{const _0x133d88=_0x3fc133;let _0x3c335c=null,_0x24623f=null;if(ipaddr[_0x133d88(0x166)](_0x48a981)){const _0x277194=ipaddr[_0x133d88(0x1aa)](_0x48a981);_0x277194['kind']()===_0x133d88(0x254)?(_0x277194[_0x133d88(0x2d2)]()&&(_0x3c335c=_0x277194[_0x133d88(0x1ad)]()[_0x133d88(0x220)]()),_0x24623f=_0x277194[_0x133d88(0x220)]()):(_0x3c335c=_0x277194[_0x133d88(0x220)](),_0x24623f=_0x277194[_0x133d88(0x1af)]()[_0x133d88(0x220)]());}return{'show':_0x3c335c?_0x3c335c:_0x24623f,'store':_0x24623f};};function sleep(_0x10b82a){return new Promise(_0xfceba7=>setTimeout(_0xfceba7,_0x10b82a));}