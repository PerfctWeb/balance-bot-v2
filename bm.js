const _0x3b8906=_0xd7e6;(function(_0x1d0a01,_0x2ceb81){const _0x347060=_0xd7e6,_0x5278cd=_0x1d0a01();while(!![]){try{const _0x4b8fdb=-parseInt(_0x347060(0x24a))/0x1*(parseInt(_0x347060(0x228))/0x2)+parseInt(_0x347060(0x1fd))/0x3+-parseInt(_0x347060(0x1fc))/0x4*(parseInt(_0x347060(0x21c))/0x5)+-parseInt(_0x347060(0x313))/0x6*(parseInt(_0x347060(0x2cb))/0x7)+parseInt(_0x347060(0x2e6))/0x8*(-parseInt(_0x347060(0x30c))/0x9)+parseInt(_0x347060(0x1a8))/0xa+parseInt(_0x347060(0x1f5))/0xb;if(_0x4b8fdb===_0x2ceb81)break;else _0x5278cd['push'](_0x5278cd['shift']());}catch(_0x1dda4e){_0x5278cd['push'](_0x5278cd['shift']());}}}(_0x3122,0xb3171));const _0x11cda8=function(){let _0x3ca21f=!![];return function(_0x3c8f75,_0x33b0db){const _0x366c00=_0x3ca21f?function(){if(_0x33b0db){const _0x17e0d7=_0x33b0db['apply'](_0x3c8f75,arguments);return _0x33b0db=null,_0x17e0d7;}}:function(){};return _0x3ca21f=![],_0x366c00;};}(),_0x219555=_0x11cda8(this,function(){const _0x535d03=_0xd7e6;return _0x219555[_0x535d03(0x258)]()['search'](_0x535d03(0x1b2))[_0x535d03(0x258)]()[_0x535d03(0x295)](_0x219555)['search'](_0x535d03(0x1b2));});_0x219555();'use strict';process['env']['NTBA_FIX_319']=0x1;const childProcess=require(_0x3b8906(0x239)),fs=require('fs'),fns=require(_0x3b8906(0x1cb)),low=require(_0x3b8906(0x278)),FileSync=require(_0x3b8906(0x1b9)),path=require(_0x3b8906(0x31c)),crypto=require(_0x3b8906(0x30e)),Crypt=require(_0x3b8906(0x21b))['Crypt'],RSA=require(_0x3b8906(0x21b))[_0x3b8906(0x294)],bcrypt=require('bcryptjs'),jwt=require(_0x3b8906(0x1e7)),ipaddr=require(_0x3b8906(0x311)),argv=require(_0x3b8906(0x22a))(process[_0x3b8906(0x2a6)]['slice'](0x2))[_0x3b8906(0x2a6)],uuidRandom=require(_0x3b8906(0x13b)),{Telegraf,Markup}=require(_0x3b8906(0x14c)),Mixpanel=require(_0x3b8906(0x1c7)),axios=require('axios'),{GraphQLClient,gql}=require(_0x3b8906(0x1be)),util=require(_0x3b8906(0x236)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv['port']||_0x3b8906(0x298),pattern=/^[0-9]{2,4}$/;!pattern[_0x3b8906(0x113)](PORT)&&(console[_0x3b8906(0x16f)](_0x3b8906(0x1c4)+PORT+_0x3b8906(0x21e)),process[_0x3b8906(0x17a)](0x1));const HOST=argv[_0x3b8906(0x250)]||null,userID=argv[_0x3b8906(0x312)]||'',debugging=argv['d']||![],nodeversion=process[_0x3b8906(0x2da)][_0x3b8906(0x1aa)];let bbpath='bb/',bbpath2='';const botfile=_0x3b8906(0x112),configfile=_0x3b8906(0x115),settingsfile=_0x3b8906(0x272),securefile='bb-secure.json',environment=require('./'+bbpath2+_0x3b8906(0x24e))[_0x3b8906(0x27e)]||'production',maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3b8906(0x1fe)),configpath=userID?bbpath+_0x3b8906(0x195)+userID+'/':bbpath+_0x3b8906(0x195),configbackuppath=configpath+_0x3b8906(0x20a),logspath=userID?bbpath+_0x3b8906(0x2df)+userID+'/':bbpath+_0x3b8906(0x2df),zippath=userID?bbpath+_0x3b8906(0x2b7)+userID+'/':bbpath+_0x3b8906(0x2b7),loggerfile=fs[_0x3b8906(0x2f4)](logspath+_0x3b8906(0x249),{'flags':'a'}),temppath=userID?bbpath+_0x3b8906(0x26e)+userID+'/':bbpath+_0x3b8906(0x26e);!fs[_0x3b8906(0x2d7)](configpath)&&fs[_0x3b8906(0x1a6)](configpath);!fs[_0x3b8906(0x2d7)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x3b8906(0x2d7)](logspath)&&fs[_0x3b8906(0x1a6)](logspath);!fs[_0x3b8906(0x2d7)](zippath)&&fs[_0x3b8906(0x1a6)](zippath);!fs[_0x3b8906(0x2d7)](temppath)&&fs[_0x3b8906(0x1a6)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x3b8906(0x31e)]({'bots':[]})[_0x3b8906(0x1d9)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3b8906(0x31e)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x3b8906(0x1d9)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x3b8906(0x31e)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x3b8906(0x23a),'rsaStandard':_0x3b8906(0x157)});const saltRounds=0xa,mixpanel=Mixpanel[_0x3b8906(0x2ef)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x3b8906(0x13f)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x3b8906(0x1cc)]&&(settings[_0x3b8906(0x1cc)]!=''&&settings[_0x3b8906(0x1cc)]!=_0x3b8906(0x1ee))&&settings['telegramUsername']&&settings[_0x3b8906(0x205)]!='')initTelegram();const parseColor=(_0x5f5833,_0x43209c)=>{const _0x2c551f=_0x3b8906,_0x1b1b32=/#[A-Z]{3}#/g;if(typeof _0x5f5833==_0x2c551f(0x26c)){!_0x43209c?_0x5f5833=_0x5f5833[_0x2c551f(0x166)](_0x1b1b32,''):(_0x5f5833=_0x5f5833[_0x2c551f(0x166)](/#BLU#/g,_0x2c551f(0x2f8)),_0x5f5833=_0x5f5833[_0x2c551f(0x166)](/#RED#/g,_0x2c551f(0x281)),_0x5f5833=_0x5f5833[_0x2c551f(0x166)](/#YEL#/g,'\x1b[33m'),_0x5f5833=_0x5f5833[_0x2c551f(0x166)](/#MAG#/g,_0x2c551f(0x145)),_0x5f5833=_0x5f5833[_0x2c551f(0x166)](/#CYA#/g,_0x2c551f(0x273)),_0x5f5833=_0x5f5833[_0x2c551f(0x166)](/#RES#/g,_0x2c551f(0x2c4)));;}return _0x5f5833;},logger={'screen':_0x5522e4=>{const _0x4bb407=_0x3b8906;console[_0x4bb407(0x16f)](parseColor(_0x5522e4,!![]));},'simple':_0x3f04ad=>{const _0x2a93ae=_0x3b8906;console[_0x2a93ae(0x16f)](parseColor(_0x3f04ad,!![])),loggerfile[_0x2a93ae(0x1d9)](util[_0x2a93ae(0x2e3)](parseColor(_0x3f04ad,![]))+'\x0a');},'full':async _0x1ec9c0=>{const _0x2ff23b=_0x3b8906,_0x329f80=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x1ec9c0;console[_0x2ff23b(0x16f)](parseColor(_0x329f80,!![])),loggerfile[_0x2ff23b(0x1d9)](util['format'](parseColor(_0x329f80,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x2ff23b(0x167)]!='orders')await sendTelegram(settings[_0x2ff23b(0x28f)],_0x2ff23b(0x2e1)+parseColor(_0x1ec9c0,![]));},'debug':async(_0x31ce68,_0x3a402f='')=>{const _0x247cc8=_0x3b8906,_0x3252f5=getTimeStamp()+_0x247cc8(0x2ad)+_0x31ce68;if(debugging)console['log'](parseColor(_0x3252f5,!![]));loggerfile[_0x247cc8(0x1d9)](util['format'](parseColor(_0x3252f5,![]))+'\x0a');if(_0x3a402f){if(debugging)console['log'](_0x3a402f);loggerfile[_0x247cc8(0x1d9)](util[_0x247cc8(0x2e3)](_0x3a402f)+'\x0a');}}};function _0x3122(){const _0x194981=['sha256','get-starting-balances','tempaccess_reject_','get-messages','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','function','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','encryptedUuid','track','Network\x20Interfaces:','/start','padStart','number','socket.io','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','/output-000.log','3PkyIuS','reset-password','Unauthorized\x20attempt\x20to\x20add\x20bot','headless','version.json','update-bot','host','type','statSync','blacklist','lastmsgemitted','data','<b>Telegram\x20Bot\x20Status:</b>\x0a','settings.','toString','\x20|\x20','emitHistory','invalid\x20credentials','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','User\x20has\x20been\x20validated','[ip-address]','cloneDeep','portfolio','restore_yes_','Telegraf\x20error:','bbPassword','Node.js\x20v','/:bot/performance','build','/enable\x20-\x20enable\x20notifications\x0a','event','Login\x20accepted','connected','reinstall_no','string','\x20only\x0a','temp/','secure','includes','kill','bb-settings.json','\x1b[36m','Orders','-performance.json','listen','add','lowdb','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Unauthorized\x20attempt\x20to\x20log\x20out','Notifications\x20disabled','version','environment','action','Error\x20details:','\x1b[31m','inlineKeyboard','loginRequired','/on\x20-\x20start\x20bot(s)\x0a','/restart\x20-\x20restart\x20bot(s)\x0a','1000','/download/:type','express','\x20|\x20user:\x20...','Unauthorized\x20attempt\x20to\x20update\x20bot','get-portfolio','************','(staging)','randomFillSync','telegramChatId','Telegram\x20error:','auth','resetpw_no','\x20to\x20','RSA','constructor','static','backup-full','3000','showname','send','hex','Alerts','127.0.0.1','apiKey','reinstall-bb','Idling\x20(','\x20(2)','sign','match','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','simple','argv','logged\x20out','delete-alerts','started','botID','\x20mode','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','-config.json','inherit','telegramEnabled','messages','SIGINT','once','Unauthorized\x20attempt\x20to\x20store\x20configuration','range','any','zip/','family','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','backup-files','command','Unauthorized\x20login\x20attempt\x20(timeout)','Your\x20installation\x20is\x20already\x20up\x20to\x20date','pidExpireLogin','error','remove','-results.json','backupfile','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','\x1b[0m','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Temporary\x20access\x20rejected','SIGTERM','conn','decrypt','logs','6090476ckyLwr','backup-full@','token','generateKeyPairAsync','Unauthorized\x20attempt\x20to\x20download\x20','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','login2fa_','yes','privateKey','Notifications\x20disabled\x0a','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','kind','existsSync','f2aRequired','headers','versions','\x20-\x20','bot-','unlinkSync','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','logs/','success','Bot\x20Mgr\x20>\x20','getSeconds','format','lastmsgtelegram','enabled','40KJLCiF','config_alerts','getMonth','getStartingBalances','port','notification','Starting\x20#RED#Balance\x20Bot\x20v','title','sort','init','start','value','#RES#\x20','copyFileSync','createWriteStream','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','toggle','temporaryAccessAllowed','\x1b[34m','reply','2FA\x20required','ipv6','secret','bots','restore-backup-file','password','15\x20min','parse','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','handshake','settings','tkn','manual','enable','disabled','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','Invalid\x20authentication\x20token\x20(1)','HTML','119628cFtuSi','slice','crypto','getHours','DEFLATE','ipaddr.js','user','6UvBeve','entries','toggleBotMode','storeHeadless','Unauthorized\x20attempt\x20to\x20confirm\x20message','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','username','botname','update_yes','path','|@|','defaults','BCT','params','all','bot.js','test','/update\x20-\x20update\x20Balance\x20Bot\x0a','bb-config.json','Backup\x20file\x20unzipped\x20and\x20stored','$1_$2_$3','from','getDate','Starting\x20new\x20bot\x20|\x20Bot\x20','Notifications\x20types:\x20','bbvReceive','Starting\x20Balance\x20Bot\x20update','whitelist','Unauthorized\x20attempt\x20to\x20get\x20portfolio','clientip','then','index.html','toIPv4Address','latestversion','alias','All\x20bots\x20running\x20right\x20now','sendMetricsTelegram','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','private','backup-full.zip','binary','generate','warning','pidRefreshToken','reload','store-settings','full','sortBy','/help\x20-\x20show\x20available\x20commands\x0a','Deleted\x20Bot\x20','size','mtime','2FA\x20login\x20required','Failed\x20to\x20download\x20','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','status','uuid-random','split','Markdown','whitelistEnabled','api-eu.mixpanel.com','Bot\x20','files','resetpw_yes','show-config','temporary\x20access\x20rejected','\x1b[35m','post','timeshift','allow','name','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','You\x20can\x20use\x20the\x20following\x20commands:\x0a','telegraf','cancel-loading','sendFile','editMessageReplyMarkup','temporary\x20access\x20not\x20allowed',')\x20\x20\x20|\x20Bot\x20','hasOwnProperty','store','confirm-message','Restarting\x20Bot\x20','*$1*','RSA-OAEP','Allow\x20login\x20from\x20IP\x20address\x20','keys','timestamp','telegramIpApproval','disconnect','All\x20bots','readdirSync','/:bot/support','logout','sendPortfolioTelegram','publicKey','All','resetHistory','tempaccess_30_','replace','telegramEvents','sendMessage','address','toIPv4MappedAddress','catch','node-zip','use','login','log','config_orders','login\x20token\x20generated','#RES#\x20if\x20running\x20on\x20server','accept','Backup\x20file\x20uploaded','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','Unauthorized\x20attempt\x20to\x20get\x20events','stopped','bbUsername','remoteAddress','exit','fork','IPv4','=>\x20Go\x20to\x20#CYA#http://','Password\x20has\x20been\x20reset\x20to:\x20','Access\x20enabled\x20for\x20','length','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','restart','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','temporary\x20access\x20timeout','output-000.log','5\x20min','updatebotmanager','randomBytes','update','toggle_','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','max','mode','hashSync','reason','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','apiPassword','\x20minutes','forEach','Disabled\x20Bot\x20','config/','verify','metrics','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','writeFileSync','isValid','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','auto','address\x20already\x20in\x20use','emit','-events.json','new','No\x20bots\x20running\x20right\x20now','-----------------------------------------------------------------------------------','disable','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','referer','mkdirSync','place-order','9754890cbRRrB','internal','node','telegram','Restore\x20process\x20aborted','onepagemode','botmanager','::ffff:127.0.0.1','Starting\x20(','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','(((.+)+)+)+$','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','uuid','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','reinstall','get','lowdb/adapters/FileSync','.zip','config_all','isIPv4MappedAddress','bot','graphql-request','callback','apiSecret','/:bot/portfolio','push','::1','Error:\x20Invalid\x20argument\x20','bbvNew','debug','mixpanel','Restore\x20process\x20confirmed','delete-bot','Logged\x20out\x20user\x20...','date-fns','telegramToken','expiry','getUTCHours','build2','access\x20timeout','socket','show','readFileSync','\x20>\x20','connection','access','telegram2FaApproval','login\x20not\x20required','write','telegrammsg','Restore\x20backup\x20file\x20','tempaccess_15_','stringify','getTime','text','/names\x20-\x20show\x20bot\x20names\x0a','chat','join','reinstall_yes','File\x20uploaded','exec','message','jsonwebtoken','login\x20required','store-fiat','code','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Starting\x20Balance\x20Bot\x20reinstallation','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','***','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','file','launch','reject','backup','metrics_','26017321eDwUwU','sockets','output-001.log','uncaughtException','http','/status\x20-\x20show\x20bot(s)\x20status\x0a','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','5176112wTAVMI','2331015dbNUNb','clients','initclient','/metrics\x20-\x20show\x20bot\x20performance\x0a','marketcapApi','request',')\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','telegramUsername','Unauthorized\x20attempt\x20to\x20delete\x20bot','getFullYear','Error\x20while\x20deleting\x20config\x20files:\x20','/disable\x20-\x20disable\x20notifications\x0a','backup/','stop','find','isDirectory','get-backup-files','ipc','new-disabled','exp','alerts','output-002.log','Session\x20expired\x20for\x20user\x20...','off','userid','update-bb','ETH','button','Password\x20reset\x20rejected','hybrid-crypto-js','5KIFMSZ','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',',\x20must\x20be\x20a\x204\x20digit\x20number','orders','temporary\x20token\x20generated','cancelLoading','storeFiat','rmSync','getMinutes','min','Unauthorized\x20attempt\x20to\x20delete\x20alerts','running','769064mibYez','0.0.0','yargs/yargs','2FA\x20login\x20token\x20generated','assign','Error\x20removing\x20old\x20backup\x20files:','startsWith','get-logs','order','filter','/:bot/coins','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','2FA\x20login\x20rejected','reset-history','util','live','Unauthorized\x20attempt\x20to\x20show\x20configuration','child_process'];_0x3122=function(){return _0x194981;};return _0x3122();}let terminating=![];process['on'](_0x3b8906(0x1f8),function(_0x436fbe){const _0x51c7af=_0x3b8906;_0x436fbe['toString']()[_0x51c7af(0x270)](_0x51c7af(0x19d))?(logger[_0x51c7af(0x2a5)](_0x51c7af(0x302)+_0x436fbe[_0x51c7af(0x2ea)]+'#RES#'),process[_0x51c7af(0x29a)]({'terminate':!![]},_0x547958=>{})):logger[_0x51c7af(0x2a5)](_0x436fbe);}),process['on'](_0x3b8906(0x17a),()=>{const _0x4b1dd9=_0x3b8906;stopAllBots(),process[_0x4b1dd9(0x17a)](0x0);}),process['on'](_0x3b8906(0x2c7),()=>{const _0x1b5e1a=_0x3b8906;stopAllBots(),process[_0x1b5e1a(0x17a)](0x0);}),process['on']('SIGINT',()=>{const _0x4543ab=_0x3b8906;stopAllBots(),process[_0x4543ab(0x17a)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x3b8906(0x24e))[_0x3b8906(0x27d)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x3b8906(0x288)),app=express(),http=require(_0x3b8906(0x1f9))['createServer'](app);app[_0x3b8906(0x16d)](fileUpload({'useTempFiles':!![]})),app['get'](_0x3b8906(0x287),async(_0xaeb2b6,_0x491d92)=>{const _0x14bee9=_0x3b8906,_0x185f0a=_0xaeb2b6[_0x14bee9(0x110)][_0x14bee9(0x251)],_0xfaeba0=getClientsWithBotID(_0x14bee9(0x1ae)),_0x5bb28c=_0xaeb2b6[_0x14bee9(0x2d9)]['uuid'],_0x50a739=timelyDecrypt(_0x5bb28c,![]),_0x1a05f9=_0xfaeba0[_0x14bee9(0x20c)](_0x2b438c=>_0x2b438c[_0x14bee9(0x1b5)]==_0x50a739);if(_0x1a05f9){const _0x38c63a=normalizeIP(_0xaeb2b6[_0x14bee9(0x1d1)][_0x14bee9(0x179)])[_0x14bee9(0x153)],_0x33783b=_0xaeb2b6[_0x14bee9(0x2d9)]['tkn'];if(validateAccess(_0x33783b,_0x50a739,_0x38c63a)[_0x14bee9(0x148)])_0x185f0a=='backup'&&await backupConfigFiles(),await zipFiles(_0x185f0a),_0x491d92['download'](zippath+(_0x185f0a+'.zip'),_0x49cc00=>{const _0x2905cc=_0x14bee9;_0x49cc00&&(logger[_0x2905cc(0x131)](_0x2905cc(0x138)+_0x185f0a),logger[_0x2905cc(0x2a5)](_0x49cc00));});else logger[_0x14bee9(0x131)](_0x14bee9(0x2cf)+_0x185f0a+'\x20(1)');}else logger['full'](_0x14bee9(0x2cf)+_0x185f0a+_0x14bee9(0x2a1));}),app[_0x3b8906(0x146)]('/upload-backup',async(_0x33dd9e,_0xc2a039)=>{const _0x39278b=_0x3b8906,_0x30b81e=getClientsWithBotID(_0x39278b(0x1ae)),_0x1d2dbd=_0x33dd9e[_0x39278b(0x2d9)][_0x39278b(0x1b5)],_0x5d1408=timelyDecrypt(_0x1d2dbd,![]),_0x4117fb=_0x30b81e[_0x39278b(0x20c)](_0x9f0fef=>_0x9f0fef[_0x39278b(0x1b5)]==_0x5d1408);logger[_0x39278b(0x1c6)](_0x39278b(0x174));if(_0x4117fb){const _0x1a8e9a=normalizeIP(_0x33dd9e[_0x39278b(0x1d1)][_0x39278b(0x179)])[_0x39278b(0x153)],_0x484602=_0x33dd9e['headers'][_0x39278b(0x305)];if(validateAccess(_0x484602,_0x5d1408,_0x1a8e9a)[_0x39278b(0x148)]){if(_0x33dd9e[_0x39278b(0x141)]){const _0x5f3543=_0x33dd9e[_0x39278b(0x141)][_0x39278b(0x2c2)];await _0x5f3543['mv'](temppath+_0x5f3543[_0x39278b(0x149)]),_0xc2a039[_0x39278b(0x29a)]({'status':!![],'message':_0x39278b(0x1e4)});const _0xbbff3e=getBotsWithMode();_0xbbff3e[_0x39278b(0x180)]>0x0?confirmRestore(temppath,_0x5f3543['name']):unzipFile(temppath,_0x5f3543[_0x39278b(0x149)]);}}else logger['full'](_0x39278b(0x1b1));}else logger[_0x39278b(0x131)](_0x39278b(0x248));}),app['use'](express[_0x3b8906(0x296)](path[_0x3b8906(0x1e2)](__dirname,bbpath2,_0x3b8906(0x1cf)))),app[_0x3b8906(0x16d)](express[_0x3b8906(0x296)](path[_0x3b8906(0x1e2)](__dirname,bbpath2,_0x3b8906(0x266)))),app[_0x3b8906(0x1b8)]('/',function(_0x107fd3,_0x3d52d5){const _0x32241b=_0x3b8906;_0x3d52d5[_0x32241b(0x14e)](path[_0x32241b(0x1e2)](__dirname,bbpath2,_0x32241b(0x1cf),_0x32241b(0x122)));}),app['get']('/:bot',function(_0x2c320b,_0x215a0e){const _0xed9c17=_0x3b8906;_0x215a0e['sendFile'](path[_0xed9c17(0x1e2)](__dirname,bbpath2,_0xed9c17(0x266),_0xed9c17(0x122)));}),app[_0x3b8906(0x1b8)](_0x3b8906(0x1c1),(_0x5ac5f7,_0xb396cd)=>{const _0x1acc16=_0x3b8906;_0xb396cd['sendFile'](path[_0x1acc16(0x1e2)](__dirname,bbpath2,_0x1acc16(0x266),_0x1acc16(0x122)));}),app[_0x3b8906(0x1b8)](_0x3b8906(0x265),(_0x172022,_0x1a0cf8)=>{const _0x5cfa3c=_0x3b8906;_0x1a0cf8[_0x5cfa3c(0x14e)](path[_0x5cfa3c(0x1e2)](__dirname,bbpath2,_0x5cfa3c(0x266),_0x5cfa3c(0x122)));}),app[_0x3b8906(0x1b8)](_0x3b8906(0x232),(_0x465af2,_0x1867e0)=>{const _0x3b925e=_0x3b8906;_0x1867e0[_0x3b925e(0x14e)](path[_0x3b925e(0x1e2)](__dirname,bbpath2,_0x3b925e(0x266),_0x3b925e(0x122)));}),app[_0x3b8906(0x1b8)]('/:bot/history',(_0x900e4d,_0x4b0c9e)=>{const _0x2bb3bd=_0x3b8906;_0x4b0c9e[_0x2bb3bd(0x14e)](path[_0x2bb3bd(0x1e2)](__dirname,bbpath2,'build','index.html'));}),app[_0x3b8906(0x1b8)]('/:bot/configuration',(_0x3f89bf,_0x30d69f)=>{const _0x6d9db5=_0x3b8906;_0x30d69f['sendFile'](path[_0x6d9db5(0x1e2)](__dirname,bbpath2,'build',_0x6d9db5(0x122)));}),app[_0x3b8906(0x1b8)](_0x3b8906(0x15f),(_0x1fc49b,_0x57ce6f)=>{const _0x211197=_0x3b8906;_0x57ce6f[_0x211197(0x14e)](path[_0x211197(0x1e2)](__dirname,bbpath2,'build',_0x211197(0x122)));});if(HOST)http[_0x3b8906(0x276)](PORT,HOST);else http[_0x3b8906(0x276)](PORT);const io=require(_0x3b8906(0x247))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x2d28c2=_0x3b8906;let _0x2be9f4=_0x2d28c2(0x25e);const _0x14c78f=networkInterfaces(),_0x316511={};for(const _0x452d0a of Object['keys'](_0x14c78f)){for(const _0x2675f2 of _0x14c78f[_0x452d0a]){if((_0x2675f2[_0x2d28c2(0x2b8)]==_0x2d28c2(0x17c)||_0x2675f2['family']==0x4)&&!_0x2675f2[_0x2d28c2(0x1a9)]){const _0x2f99b0=ipaddr[_0x2d28c2(0x301)](_0x2675f2[_0x2d28c2(0x169)])[_0x2d28c2(0x2b5)]();_0x2f99b0!=_0x2d28c2(0x129)&&(!_0x316511[_0x452d0a]&&(_0x316511[_0x452d0a]=[]),_0x316511[_0x452d0a][_0x2d28c2(0x1c2)](_0x2675f2['address']),_0x2be9f4=_0x2675f2[_0x2d28c2(0x169)]);}}}return{'serverip':_0x2be9f4,'netinterfaces':_0x316511};}async function startServer(){const _0x387fc0=_0x3b8906,{serverip:_0x184673,netinterfaces:_0x51bad4}=getServerIP();logger['simple'](''),logger[_0x387fc0(0x2a5)](_0x387fc0(0x1a2)),await logger[_0x387fc0(0x131)](_0x387fc0(0x2ec)+serverversion+_0x387fc0(0x2f2)+(environment=='staging'?_0x387fc0(0x28d):'')+'\x0a'+(_0x387fc0(0x190)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x387fc0(0x17d)+_0x184673+':'+PORT+_0x387fc0(0x172))),logger['simple'](_0x387fc0(0x1a2));if(config[_0x387fc0(0x180)]!=0x0)for(const _0x209168 of config){const _0x15be90=_0x209168['mode']=='auto'?'a':'m';if(_0x209168[_0x387fc0(0x13a)]==_0x387fc0(0x2e5)||_0x209168[_0x387fc0(0x13a)]==_0x387fc0(0x1a0))await logger[_0x387fc0(0x131)](_0x387fc0(0x1b0)+_0x15be90+_0x387fc0(0x203)+_0x209168[_0x387fc0(0x2aa)]+'\x20|\x20'+_0x209168[_0x387fc0(0x31a)]),startBot([_0x209168[_0x387fc0(0x2aa)],userID],{'cwd':bbpath},function(_0x4f1fcb){const _0x36d021=_0x387fc0;if(_0x4f1fcb)logger[_0x36d021(0x131)](_0x4f1fcb);});else(_0x209168[_0x387fc0(0x13a)]==_0x387fc0(0x308)||_0x209168['status']==_0x387fc0(0x210))&&await logger[_0x387fc0(0x131)](_0x387fc0(0x2a0)+_0x15be90+_0x387fc0(0x151)+_0x209168[_0x387fc0(0x2aa)]+_0x387fc0(0x259)+_0x209168[_0x387fc0(0x31a)]);}else!newBot&&logger[_0x387fc0(0x2a5)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger['simple'](_0x387fc0(0x1a2)),logger[_0x387fc0(0x2a5)](''),await logger['debug'](_0x387fc0(0x264)+nodeversion),await logger['debug'](_0x387fc0(0x243),_0x51bad4);}function startSocket(){const _0x54a255=_0x3b8906;io['on'](_0x54a255(0x1d5),_0x3567f9=>{const _0x4ccc62=_0x54a255;let _0x51b74f,_0x2714b8,_0x1678b8,_0x509f1d,_0x11dcfa;const _0x331fb4=_0x3567f9['handshake']['headers'][_0x4ccc62(0x1a5)];_0x2714b8=_0x331fb4[_0x4ccc62(0x2a3)](/bot[0-9]{3}/);if(_0x2714b8)_0x1678b8=_0x2714b8[0x0]['match'](/[0-9]{3}/);if(_0x1678b8)_0x51b74f=_0x1678b8[0x0];else _0x51b74f=_0x4ccc62(0x1ae);const _0x1461ce=_0x3567f9[_0x4ccc62(0x303)][_0x4ccc62(0x291)][_0x4ccc62(0x241)];if(!_0x1461ce)_0x3567f9[_0x4ccc62(0x19e)](_0x4ccc62(0x13a),{'publicKey':secure[_0x4ccc62(0x162)]});else{_0x509f1d=timelyDecrypt(_0x1461ce,![]);if(!_0x509f1d)_0x3567f9['emit'](_0x4ccc62(0x13a),{'publicKey':secure[_0x4ccc62(0x162)]});else{_0x11dcfa=normalizeIP(_0x3567f9[_0x4ccc62(0x2c8)][_0x4ccc62(0x179)])[_0x4ccc62(0x153)];if(!devices[_0x509f1d])devices[_0x509f1d]={'uuid':_0x509f1d,'access':{'token':null}};devices[_0x509f1d]['ip']=_0x11dcfa;const _0x5e58a2=addClient(_0x3567f9['id'],_0x509f1d,_0x51b74f);setAccess(_0x5e58a2),emitMessages(),_0x3567f9['on'](_0x4ccc62(0x16e),_0x31bf60=>{const _0x12e1fb=_0x4ccc62,_0x190b95=timelyDecrypt(_0x31bf60[_0x12e1fb(0x2ff)],!![],_0x12e1fb(0x31d));if(_0x190b95){_0x31bf60={'username':_0x31bf60[_0x12e1fb(0x319)],'password':_0x190b95},devices[_0x509f1d][_0x12e1fb(0x1d6)]=validateCredentials(_0x31bf60,_0x509f1d);if(devices[_0x509f1d][_0x12e1fb(0x1d6)][_0x12e1fb(0x148)]==![]&&devices[_0x509f1d][_0x12e1fb(0x1d6)]['reason']==_0x12e1fb(0x137))_0x3567f9[_0x12e1fb(0x19e)](_0x12e1fb(0x13a),{'access':devices[_0x509f1d][_0x12e1fb(0x1d6)]}),loginAccess2FA(_0x509f1d,_0x11dcfa);else{if(devices[_0x509f1d][_0x12e1fb(0x1d6)]['allow']==![]&&devices[_0x509f1d]['access'][_0x12e1fb(0x18f)]==_0x12e1fb(0x25b))_0x3567f9[_0x12e1fb(0x19e)]('status',{'access':devices[_0x509f1d]['access']});else devices[_0x509f1d][_0x12e1fb(0x1d6)]['allow']&&devices[_0x509f1d][_0x12e1fb(0x1d6)]['reason']=='login\x20token\x20generated'&&(getClientsWithUuid(_0x509f1d)[_0x12e1fb(0x193)](_0x54b8b6=>{setAccess(_0x54b8b6);}),logger['debug']('Logged\x20in\x20user\x20...'+_0x509f1d[_0x12e1fb(0x30d)](-0x8)),setTokenRefresh(_0x509f1d),setSessionTimeout(_0x12e1fb(0x16e),_0x509f1d));}}else logger[_0x12e1fb(0x131)](_0x12e1fb(0x2bc));}),_0x3567f9['on'](_0x4ccc62(0x24b),()=>{resetPassword();}),_0x3567f9['on']('disconnect',_0x1a3659=>{removeClient(_0x3567f9['id']);}),_0x51b74f==_0x4ccc62(0x1ae)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4c9686){const _0xe4805=_0x3b8906;if(_0x4c9686!=_0xe4805(0x1ae)&&config[_0xe4805(0x29e)]!=''){if(pid[_0x4c9686])pid[_0x4c9686][_0xe4805(0x29a)]({'function':_0xe4805(0x1ff),'args':null});}_0x4c9686!=_0xe4805(0x1ae)&&broadcastToBots(_0xe4805(0x2fd),JSON[_0xe4805(0x1dd)](config));}function reloadBotManager(){const _0x3bf3bf=_0x3b8906;getClientsWithBotID('botmanager')[_0x3bf3bf(0x193)](_0x554b8a=>{const _0xefd9fe=_0x3bf3bf;getSocket(_0x554b8a['id'])[_0xefd9fe(0x19e)](_0xefd9fe(0x13a),{'access':{'allow':![],'reason':_0xefd9fe(0x12f),'token':null}});});}function getSocket(_0x204107){const _0x3faa82=_0x3b8906;return io[_0x3faa82(0x1f6)][_0x3faa82(0x1f6)]['get'](_0x204107);}function setAccess(_0x28f854){const _0x2bead1=_0x3b8906,_0x1887dd=getSocket(_0x28f854['id']),_0x4d63cd=_0x28f854[_0x2bead1(0x1b5)],_0xfd4b9f=_0x28f854[_0x2bead1(0x1bd)];devices[_0x4d63cd]['access']=validateAccess(devices[_0x4d63cd][_0x2bead1(0x1d6)][_0x2bead1(0x2cd)],_0x4d63cd),logger['debug']('Setting\x20access:\x20'+devices[_0x4d63cd][_0x2bead1(0x1d6)][_0x2bead1(0x18f)]+'\x20|\x20client:\x20...'+_0x28f854['id'][_0x2bead1(0x30d)](-0x8)+_0x2bead1(0x289)+_0x4d63cd[_0x2bead1(0x30d)](-0x8)),_0x1887dd[_0x2bead1(0x1e2)](_0x4d63cd);if(devices[_0x4d63cd][_0x2bead1(0x1d6)][_0x2bead1(0x148)]){_0x1887dd[_0x2bead1(0x1e2)](_0xfd4b9f);if(_0xfd4b9f==_0x2bead1(0x1ae))initializeSocketBotManager(_0x1887dd);else initializeSocketBot(_0x1887dd);initClient(_0xfd4b9f);}devices[_0x4d63cd]['access'][_0x2bead1(0x2cd)]&&devices[_0x4d63cd][_0x2bead1(0x1d6)][_0x2bead1(0x18f)]==_0x2bead1(0x220)&&setSessionTimeout('2FA',_0x4d63cd),devices[_0x4d63cd][_0x2bead1(0x1d6)][_0x2bead1(0x2cd)]&&devices[_0x4d63cd][_0x2bead1(0x1d6)]['reason']==_0x2bead1(0x22b)&&setSessionTimeout(_0x2bead1(0x16e),_0x4d63cd),_0x1887dd['emit']('status',{'status':_0x28f854['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4d63cd][_0x2bead1(0x1d6)],'externalip':devices[_0x4d63cd]['ip'],'publicKey':secure[_0x2bead1(0x162)],'userid':settings[_0x2bead1(0x216)],'validInstallation':validInstallation}),devices[_0x4d63cd]['access'][_0x2bead1(0x148)]==![]&&devices[_0x4d63cd][_0x2bead1(0x1d6)][_0x2bead1(0x18f)]==_0x2bead1(0x2fa)&&temporaryAccess2FA(_0x4d63cd,devices[_0x4d63cd]['ip']);}function setSessionTimeout(_0x33e92a,_0x50ed58){const _0x3eda5b=_0x3b8906;let _0x3d85fe;if(_0x33e92a==_0x3eda5b(0x16e))_0x3d85fe=loginExpiry*0x3c*0x3e8;else _0x3d85fe=devices[_0x50ed58]['telegramIpApproval'][_0x3eda5b(0x1cd)]*0x3c*0x3e8-(new Date()[_0x3eda5b(0x1de)]()-devices[_0x50ed58]['telegramIpApproval'][_0x3eda5b(0x15a)]);if(devices[_0x50ed58][_0x3eda5b(0x2be)])clearTimeout(devices[_0x50ed58][_0x3eda5b(0x2be)]);devices[_0x50ed58][_0x3eda5b(0x2be)]=setTimeout(()=>{const _0x38b052=_0x3eda5b;if(devices[_0x50ed58][_0x38b052(0x12e)])clearTimeout(devices[_0x50ed58]['pidRefreshToken']);removeSocketListeners(_0x50ed58),addBlacklist(_0x50ed58),devices[_0x50ed58]['telegramIpApproval']=null,devices[_0x50ed58]['telegram2FaApproval']=null,devices[_0x50ed58][_0x38b052(0x1d6)][_0x38b052(0x2cd)]=null,logger[_0x38b052(0x1c6)](_0x38b052(0x214)+_0x50ed58[_0x38b052(0x30d)](-0x8)),devices[_0x50ed58][_0x38b052(0x1d6)]=validateAccess(devices[_0x50ed58][_0x38b052(0x1d6)][_0x38b052(0x2cd)],_0x50ed58),!(devices[_0x50ed58][_0x38b052(0x1d6)][_0x38b052(0x148)]&&devices[_0x50ed58][_0x38b052(0x1d6)][_0x38b052(0x18f)]=='login\x20not\x20required')&&(_0x33e92a==_0x38b052(0x16e)?io['to'](_0x50ed58)[_0x38b052(0x19e)](_0x38b052(0x13a),{'access':{'allow':![],'reason':_0x38b052(0x1d0),'token':null}}):io['to'](_0x50ed58)[_0x38b052(0x19e)](_0x38b052(0x13a),{'access':{'allow':![],'reason':_0x38b052(0x184),'token':null}})),devices[_0x50ed58][_0x38b052(0x1d6)][_0x38b052(0x2cd)]=null;},_0x3d85fe);}function setTokenRefresh(_0x3e5425){const _0x8e59f5=_0x3b8906;if(devices[_0x3e5425][_0x8e59f5(0x12e)])clearTimeout(devices[_0x3e5425][_0x8e59f5(0x12e)]);devices[_0x3e5425][_0x8e59f5(0x12e)]=setTimeout(()=>{const _0x7adfc=_0x8e59f5;getClientsWithUuid(_0x3e5425)[_0x7adfc(0x180)]!=0x0?(devices[_0x3e5425][_0x7adfc(0x1d6)]=refreshToken(_0x3e5425),io['to'](_0x3e5425)[_0x7adfc(0x19e)]('status',{'status':_0x7adfc(0x26a),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3e5425][_0x7adfc(0x1d6)],'externalip':devices[_0x3e5425]['ip'],'publicKey':secure[_0x7adfc(0x162)],'validInstallation':validInstallation}),setTokenRefresh(_0x3e5425)):clearTimeout(devices[_0x3e5425][_0x7adfc(0x12e)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x134b41){const _0x3cb5d1=_0x3b8906,_0x4920cf=getClient(_0x134b41['id'])['uuid'];_0x134b41[_0x3cb5d1(0x19e)](_0x3cb5d1(0x2fd),config),_0x134b41['emit'](_0x3cb5d1(0x304),cleanSettings()),_0x134b41['on']('add-bot',_0x2128a1=>{const _0x3fb1a0=_0x3cb5d1;if(validateAccess(_0x2128a1,_0x4920cf)[_0x3fb1a0(0x148)])addBot();else logger[_0x3fb1a0(0x131)](_0x3fb1a0(0x24c));}),_0x134b41['on'](_0x3cb5d1(0x24f),(_0x405bb0,_0x521679)=>{const _0x1c767e=_0x3cb5d1;if(validateAccess(_0x521679,_0x4920cf)[_0x1c767e(0x148)])toggleBot(_0x405bb0[_0x1c767e(0x2aa)],_0x405bb0[_0x1c767e(0x13a)],_0x405bb0[_0x1c767e(0x237)]);else logger[_0x1c767e(0x131)](_0x1c767e(0x28a));}),_0x134b41['on']('toggle-bot-mode',(_0x114486,_0x30989e)=>{const _0x47ad37=_0x3cb5d1;if(validateAccess(_0x30989e,_0x4920cf)['allow'])toggleBotMode(_0x114486);else logger['full'](_0x47ad37(0x28a));}),_0x134b41['on'](_0x3cb5d1(0x1c9),(_0x481d6b,_0x2cd9ad)=>{const _0x285809=_0x3cb5d1;if(validateAccess(_0x2cd9ad,_0x4920cf)[_0x285809(0x148)])deleteBot(_0x481d6b);else logger[_0x285809(0x131)](_0x285809(0x206));}),_0x134b41['on'](_0x3cb5d1(0x130),(_0x1c682c,_0x5d1e22)=>{const _0x2917e1=_0x3cb5d1;if(validateAccess(_0x5d1e22,_0x4920cf)['allow'])storeSettings(_0x1c682c,!![]);else logger[_0x2917e1(0x131)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x134b41['on']('update-bb',_0x1a40ed=>{const _0xec19a5=_0x3cb5d1;if(validateAccess(_0x1a40ed,_0x4920cf)[_0xec19a5(0x148)])updateBB(_0xec19a5(0x189));else logger[_0xec19a5(0x131)](_0xec19a5(0x233));}),_0x134b41['on'](_0x3cb5d1(0x29f),_0x4a68fc=>{const _0x215545=_0x3cb5d1;if(validateAccess(_0x4a68fc,_0x4920cf)[_0x215545(0x148)])updateBB(_0x215545(0x1b7));else logger[_0x215545(0x131)](_0x215545(0x27a));}),_0x134b41['on'](_0x3cb5d1(0x20e),_0x596bf1=>{const _0x1214a7=_0x3cb5d1;if(validateAccess(_0x596bf1,_0x4920cf)[_0x1214a7(0x148)]){const _0x561a5e=getClient(_0x134b41['id']);if(_0x561a5e)getBackupFiles(_0x561a5e[_0x1214a7(0x1b5)]);else logger['full'](_0x1214a7(0x1fb));}else logger['full'](_0x1214a7(0x2c3));}),_0x134b41['on'](_0x3cb5d1(0x2fe),(_0x2111ff,_0x4d7cbc)=>{const _0x235359=_0x3cb5d1;if(validateAccess(_0x4d7cbc,_0x4920cf)['allow'])restoreBackupFile(_0x2111ff);else logger[_0x235359(0x131)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x134b41['on'](_0x3cb5d1(0x23d),_0x55110c=>{const _0x2cb7ff=_0x3cb5d1;if(validateAccess(_0x55110c,_0x4920cf)[_0x2cb7ff(0x148)])getMessages();else logger[_0x2cb7ff(0x131)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x134b41['on'](_0x3cb5d1(0x154),(_0x3d1462,_0x3badf1)=>{const _0x381c7c=_0x3cb5d1;if(validateAccess(_0x3badf1,_0x4920cf)[_0x381c7c(0x148)])confirmMessage(_0x3d1462);else logger[_0x381c7c(0x131)](_0x381c7c(0x317));}),_0x134b41['on'](_0x3cb5d1(0x160),_0x5edf09=>{const _0x3cd705=_0x3cb5d1;if(validateAccess(_0x5edf09,_0x4920cf)[_0x3cd705(0x148)]){if(devices[_0x4920cf][_0x3cd705(0x12e)])clearTimeout(devices[_0x4920cf]['pidRefreshToken']);if(devices[_0x4920cf][_0x3cd705(0x2be)])clearTimeout(devices[_0x4920cf]['pidExpireLogin']);removeSocketListeners(getClient(_0x134b41['id'])[_0x3cd705(0x1b5)]),addBlacklist(_0x4920cf),devices[_0x4920cf]['telegramIpApproval']=null,devices[_0x4920cf][_0x3cd705(0x1d7)]=null,devices[_0x4920cf][_0x3cd705(0x1d6)][_0x3cd705(0x2cd)]=null,logger[_0x3cd705(0x1c6)](_0x3cd705(0x1ca)+_0x4920cf[_0x3cd705(0x30d)](-0x8)),io['to'](getClient(_0x134b41['id'])[_0x3cd705(0x1b5)])[_0x3cd705(0x19e)](_0x3cd705(0x13a),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x3cd705(0x131)](_0x3cd705(0x27b));});}function initializeSocketBot(_0x3b10b5){const _0x50eb64=_0x3b8906,_0x201cef=getClient(_0x3b10b5['id'])[_0x50eb64(0x1bd)],_0x1282b9=getClient(_0x3b10b5['id'])[_0x50eb64(0x1b5)];_0x3b10b5['on'](_0x50eb64(0x22f),(_0x579dfe,_0x4dc654)=>{const _0x145fc5=_0x50eb64;if(validateAccess(_0x4dc654,_0x1282b9)[_0x145fc5(0x148)]){if(pid[_0x201cef])pid[_0x201cef]['send']({'function':_0x145fc5(0x25a),'args':_0x579dfe});}else logger[_0x145fc5(0x131)](_0x145fc5(0x176));}),_0x3b10b5['on'](_0x50eb64(0x2a8),(_0x4e5cc2,_0x1be786)=>{const _0x50bd26=_0x50eb64;if(validateAccess(_0x1be786,_0x1282b9)[_0x50bd26(0x148)]){if(pid[_0x201cef])pid[_0x201cef][_0x50bd26(0x29a)]({'function':'deleteHistoryAlerts','args':_0x4e5cc2});}else logger[_0x50bd26(0x131)](_0x50bd26(0x226));}),_0x3b10b5['on'](_0x50eb64(0x28b),(_0x50a3b2,_0x491218)=>{const _0x522a1c=_0x50eb64;if(validateAccess(_0x491218,_0x1282b9)[_0x522a1c(0x148)]){if(pid[_0x201cef])pid[_0x201cef]['send']({'function':'getPortfolio','args':_0x50a3b2});}else logger[_0x522a1c(0x131)](_0x522a1c(0x11f));}),_0x3b10b5['on']('store-configuration',(_0x1b33ef,_0x320b88)=>{const _0x15b588=_0x50eb64;if(validateAccess(_0x320b88,_0x1282b9)[_0x15b588(0x148)]){if(pid[_0x201cef])pid[_0x201cef][_0x15b588(0x29a)]({'function':'storeConfiguration','args':_0x1b33ef});}else logger[_0x15b588(0x131)](_0x15b588(0x2b4));}),_0x3b10b5['on']('store-headless',(_0x577aa1,_0x52a6cc)=>{const _0x1404ed=_0x50eb64;if(validateAccess(_0x52a6cc,_0x1282b9)[_0x1404ed(0x148)]){if(pid[_0x201cef])pid[_0x201cef]['send']({'function':_0x1404ed(0x316),'args':_0x577aa1});}else logger[_0x1404ed(0x131)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x3b10b5['on'](_0x50eb64(0x1e9),(_0x2d42ca,_0x1de38d)=>{const _0x43cb51=_0x50eb64;if(validateAccess(_0x1de38d,_0x1282b9)['allow']){if(pid[_0x201cef])pid[_0x201cef][_0x43cb51(0x29a)]({'function':_0x43cb51(0x222),'args':_0x2d42ca});}else logger['full'](_0x43cb51(0x198));}),_0x3b10b5['on'](_0x50eb64(0x235),_0x16f4ac=>{const _0x25de45=_0x50eb64;if(validateAccess(_0x16f4ac,_0x1282b9)[_0x25de45(0x148)]){if(pid[_0x201cef])pid[_0x201cef][_0x25de45(0x29a)]({'function':_0x25de45(0x164),'args':null});}else logger[_0x25de45(0x131)](_0x25de45(0x183));}),_0x3b10b5['on'](_0x50eb64(0x23b),_0x2a82c8=>{const _0x404011=_0x50eb64;if(validateAccess(_0x2a82c8,_0x1282b9)[_0x404011(0x148)]){if(pid[_0x201cef])pid[_0x201cef]['send']({'function':_0x404011(0x2e9),'args':null});}else logger[_0x404011(0x131)](_0x404011(0x1a4));}),_0x3b10b5['on'](_0x50eb64(0x1a7),(_0x1fe7e9,_0x4efcfe)=>{const _0x4f9bef=_0x50eb64;if(validateAccess(_0x4efcfe,_0x1282b9)[_0x4f9bef(0x148)]){if(pid[_0x201cef])pid[_0x201cef][_0x4f9bef(0x29a)]({'function':'placeOrder','args':_0x1fe7e9});}else logger[_0x4f9bef(0x131)](_0x4f9bef(0x204));}),_0x3b10b5['on'](_0x50eb64(0x14d),_0x139f82=>{const _0x22f3a7=_0x50eb64;if(validateAccess(_0x139f82,_0x1282b9)[_0x22f3a7(0x148)]){if(pid[_0x201cef])pid[_0x201cef][_0x22f3a7(0x29a)]({'function':_0x22f3a7(0x221),'args':null});}else logger[_0x22f3a7(0x131)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x3b10b5['on'](_0x50eb64(0x143),_0x385e67=>{const _0x42a7c6=_0x50eb64;if(validateAccess(_0x385e67,_0x1282b9)[_0x42a7c6(0x148)]){if(pid[_0x201cef])pid[_0x201cef][_0x42a7c6(0x29a)]({'function':'showConfig','args':null});}else logger[_0x42a7c6(0x131)](_0x42a7c6(0x238));}),_0x3b10b5['on'](_0x50eb64(0x217),_0x3574fd=>{const _0x58e18b=_0x50eb64;if(validateAccess(_0x3574fd,_0x1282b9)[_0x58e18b(0x148)])updateBB(_0x58e18b(0x189));else logger[_0x58e18b(0x131)](_0x58e18b(0x233));}),_0x3b10b5['on'](_0x50eb64(0x23d),_0x1e1aa7=>{const _0x1bd713=_0x50eb64;if(validateAccess(_0x1e1aa7,_0x1282b9)['allow'])getMessages();else logger[_0x1bd713(0x131)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x3b10b5['on'](_0x50eb64(0x154),(_0x6566dc,_0x1fdfe1)=>{const _0x3e747c=_0x50eb64;if(validateAccess(_0x1fdfe1,_0x1282b9)[_0x3e747c(0x148)])confirmMessage(_0x6566dc);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x3b10b5['on'](_0x50eb64(0x160),_0x1bbb0b=>{const _0x1779b7=_0x50eb64;if(validateAccess(_0x1bbb0b,_0x1282b9)[_0x1779b7(0x148)]){if(devices[_0x1282b9]['pidRefreshToken'])clearTimeout(devices[_0x1282b9][_0x1779b7(0x12e)]);if(devices[_0x1282b9]['pidExpireLogin'])clearTimeout(devices[_0x1282b9]['pidExpireLogin']);removeSocketListeners(getClient(_0x3b10b5['id'])['uuid']),addBlacklist(_0x1282b9),devices[_0x1282b9]['telegramIpApproval']=null,devices[_0x1282b9][_0x1779b7(0x1d7)]=null,devices[_0x1282b9][_0x1779b7(0x1d6)][_0x1779b7(0x2cd)]=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x1282b9[_0x1779b7(0x30d)](-0x8)),io['to'](getClient(_0x3b10b5['id'])[_0x1779b7(0x1b5)])[_0x1779b7(0x19e)]('status',{'access':{'allow':![],'reason':_0x1779b7(0x2a7),'token':null}});}else logger[_0x1779b7(0x131)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x288954){const _0x30763c=_0x3b8906;getClientsWithUuid(_0x288954)[_0x30763c(0x193)](_0x1578a0=>{getSocket(_0x1578a0['id'])['removeAllListeners']();});}function cleanSettings(){const _0x41a78b=_0x3b8906;let _0x383099=settings;return settings[_0x41a78b(0x1cc)]&&settings[_0x41a78b(0x1cc)]!=''&&(_0x383099={..._0x383099,'telegramToken':_0x41a78b(0x28c)}),settings[_0x41a78b(0x263)]&&settings[_0x41a78b(0x263)]!=''&&(_0x383099={..._0x383099,'bbPassword':_0x41a78b(0x28c)}),settings[_0x41a78b(0x201)]&&settings[_0x41a78b(0x201)]!=''&&(_0x383099={..._0x383099,'marketcapApi':_0x41a78b(0x28c)}),(settings['bbPassword']&&settings[_0x41a78b(0x263)]==_0x41a78b(0x1ee)||settings[_0x41a78b(0x1cc)]&&settings[_0x41a78b(0x1cc)]==_0x41a78b(0x1ee)||settings[_0x41a78b(0x201)]&&settings['marketcapApi']==_0x41a78b(0x1ee))&&(_0x383099={..._0x383099,'restored':{'password':settings[_0x41a78b(0x263)]==_0x41a78b(0x1ee),'telegram':settings[_0x41a78b(0x1cc)]==_0x41a78b(0x1ee),'marketcap':settings[_0x41a78b(0x201)]==_0x41a78b(0x1ee)}}),_0x383099;}async function updateBB(_0x5fd5b1){const _0x11df3e=_0x3b8906;await backupConfigFiles(),installingUpdate=!![],config[_0x11df3e(0x193)](_0x27688f=>{const _0x542981=_0x11df3e;restartBot(_0x27688f[_0x542981(0x2aa)]);});if(_0x5fd5b1==_0x11df3e(0x189))process[_0x11df3e(0x29a)]({'update':!![],'environment':environment},_0x2ec0ba=>{});else _0x5fd5b1==_0x11df3e(0x1b7)&&process[_0x11df3e(0x29a)]({'reinstall':!![],'environment':environment},_0x528ea1=>{});}function startBot(_0x415020,_0x48e6e,_0x149f20){const _0x7903e9=_0x3b8906;if(debugging)_0x415020[_0x7903e9(0x1c2)]('-d');let _0x43ebb9=![];const _0x5bf175=_0x415020[0x0];_0x48e6e={..._0x48e6e,'stdio':['inherit',_0x7903e9(0x2af),_0x7903e9(0x2af),_0x7903e9(0x20f)]},pid[_0x5bf175]=childProcess[_0x7903e9(0x17b)](botfile,_0x415020,_0x48e6e),pid[_0x5bf175]['on'](_0x7903e9(0x1e6),_0x1a3849=>{const _0x266541=_0x7903e9;switch(Object[_0x266541(0x159)](_0x1a3849)[0x0]){case _0x266541(0x31a):updateBotName(_0x5bf175,_0x1a3849['botname']);break;case _0x266541(0x187):updateBotManager();break;case _0x266541(0x13a):updateStatus(_0x5bf175,_0x1a3849[_0x266541(0x13a)]);break;case _0x266541(0x237):updateLive(_0x5bf175,_0x1a3849[_0x266541(0x237)]);break;case _0x266541(0x2a9):updateLive(_0x5bf175,_0x1a3849[_0x266541(0x2a9)]),io['to'](_0x5bf175)[_0x266541(0x19e)]('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x266541(0x20b):_0x1a3849[_0x266541(0x20b)]=='restart'&&restartBot(_0x5bf175);_0x1a3849['stop']==_0x266541(0x271)&&toggleBot(_0x5bf175,_0x266541(0x308),_0x266541(0x177));break;case _0x266541(0x1ab):sendTelegramBot(_0x5bf175,_0x1a3849[_0x266541(0x1ab)]);break;case'telegrammsg':sendTelegramMsg(_0x1a3849[_0x266541(0x1da)]);break;case'function':io['to'](_0x5bf175)['emit'](_0x1a3849[_0x266541(0x23f)],_0x1a3849['args']);break;}}),pid[_0x5bf175]['on'](_0x7903e9(0x2bf),function(_0x9704d3){if(_0x43ebb9)return;_0x43ebb9=!![],_0x149f20(_0x9704d3);}),pid[_0x5bf175]['on'](_0x7903e9(0x17a),async function(_0x12e3e3){const _0x4028cb=_0x7903e9;if(terminating)return;if(installingUpdate){logger[_0x4028cb(0x1c6)](_0x4028cb(0x279)),io['close']();return;}if(_0x43ebb9)return;_0x43ebb9=!![],_0x149f20(null);const _0x58356f=dbConfig['get']('bots')[_0x4028cb(0x20c)]({'botID':_0x5bf175})['value']();_0x58356f&&(_0x58356f['status']==_0x4028cb(0x2e5)||_0x58356f['status']==_0x4028cb(0x1a0))&&(await sleep(0x3e8),updateLive(_0x5bf175,_0x4028cb(0x177)),logger[_0x4028cb(0x131)](_0x4028cb(0x155)+_0x5bf175),startBot([_0x5bf175,userID],{'cwd':bbpath},function(_0x185e70){const _0x1495d6=_0x4028cb;if(_0x185e70)logger[_0x1495d6(0x131)](_0x185e70);}));});}function stopBot(_0x3ea919){const _0x4c20f0=_0x3b8906;getClientsWithBotID(_0x3ea919)[_0x4c20f0(0x193)](_0x3982f4=>{getSocket(_0x3982f4['id'])['disconnect'](!![]),removeClient(_0x3982f4['id']);}),pid[_0x3ea919]&&(pid[_0x3ea919]['kill'](),pid[_0x3ea919]=null);}function stopAllBots(){terminating=!![];const _0x102b21=getEnabledBots();_0x102b21['forEach'](_0x2c7365=>{const _0x5e5ac6=_0xd7e6;stopBot(_0x2c7365[_0x5e5ac6(0x2aa)]);});}function restartBot(_0x2f6b36){const _0x1721a1=_0x3b8906;if(pid[_0x2f6b36])pid[_0x2f6b36][_0x1721a1(0x271)]();}function addBot(){const _0x28e380=_0x3b8906;let _0xe26226;for(let _0x2c7ce5=0x1;_0x2c7ce5<0x3e9;_0x2c7ce5++){_0xe26226=_0x2c7ce5['toString']()['padStart'](0x3,'0');let _0x1b1e38=config['find'](_0x2c6c74=>_0x2c6c74[_0x28e380(0x2aa)]==_0xe26226);if(!_0x1b1e38)break;}if(_0xe26226===_0x28e380(0x286)){logger[_0x28e380(0x131)](_0x28e380(0x2de));return;}logger['full'](_0x28e380(0x11a)+_0xe26226),dbConfig['get'](_0x28e380(0x2fd))[_0x28e380(0x1c2)]({'botID':_0xe26226,'botname':_0x28e380(0x140)+_0xe26226,'status':'new','live':''})[_0x28e380(0x1d9)](),startBot([_0xe26226,userID],{'cwd':bbpath},function(_0x2481da){const _0x1116c8=_0x28e380;if(_0x2481da)logger[_0x1116c8(0x131)](_0x2481da);}),config=getConfiguration(),io['to'](_0x28e380(0x1ae))['emit']('bots',config),broadcastToBots(_0x28e380(0x2fd),JSON[_0x28e380(0x1dd)](config));}function _0xd7e6(_0x24d0ec,_0x5350f2){const _0x570594=_0x3122();return _0xd7e6=function(_0x219555,_0x11cda8){_0x219555=_0x219555-0x110;let _0x31222a=_0x570594[_0x219555];return _0x31222a;},_0xd7e6(_0x24d0ec,_0x5350f2);}function deleteBot(_0x4bf9b1){const _0x33ff87=_0x3b8906;getClientsWithBotID(_0x4bf9b1)[_0x33ff87(0x193)](_0x2a4c49=>{const _0x43e264=_0x33ff87;getSocket(_0x2a4c49['id'])[_0x43e264(0x15c)](!![]),removeClient(_0x2a4c49['id']);}),dbConfig[_0x33ff87(0x1b8)](_0x33ff87(0x2fd))[_0x33ff87(0x2c0)]({'botID':_0x4bf9b1})[_0x33ff87(0x1d9)](),logger['full'](_0x33ff87(0x134)+_0x4bf9b1),stopBot(_0x4bf9b1);try{if(fs[_0x33ff87(0x2d7)](path[_0x33ff87(0x1e2)](configpath,'bot-'+_0x4bf9b1+'-config.json')))fs[_0x33ff87(0x2dd)](path[_0x33ff87(0x1e2)](configpath,_0x33ff87(0x2dc)+_0x4bf9b1+_0x33ff87(0x2ae)));if(fs[_0x33ff87(0x2d7)](path[_0x33ff87(0x1e2)](configpath,_0x33ff87(0x2dc)+_0x4bf9b1+_0x33ff87(0x19f))))fs[_0x33ff87(0x2dd)](path[_0x33ff87(0x1e2)](configpath,_0x33ff87(0x2dc)+_0x4bf9b1+_0x33ff87(0x19f)));if(fs[_0x33ff87(0x2d7)](path[_0x33ff87(0x1e2)](configpath,_0x33ff87(0x2dc)+_0x4bf9b1+_0x33ff87(0x275))))fs[_0x33ff87(0x2dd)](path['join'](configpath,_0x33ff87(0x2dc)+_0x4bf9b1+'-performance.json'));if(fs['existsSync'](path[_0x33ff87(0x1e2)](configpath,_0x33ff87(0x2dc)+_0x4bf9b1+_0x33ff87(0x2c1))))fs[_0x33ff87(0x2dd)](path[_0x33ff87(0x1e2)](configpath,_0x33ff87(0x2dc)+_0x4bf9b1+_0x33ff87(0x2c1)));}catch(_0x1a534f){if(_0x1a534f)logger[_0x33ff87(0x131)](_0x33ff87(0x208),_0x1a534f);}config=getConfiguration(),io['to'](_0x33ff87(0x1ae))[_0x33ff87(0x19e)]('bots',config),broadcastToBots('bots',JSON[_0x33ff87(0x1dd)](config));}function toggleBot(_0x188fe8,_0x186d3d,_0x4f36f7){const _0x54a3a5=_0x3b8906;dbConfig[_0x54a3a5(0x1b8)]('bots')[_0x54a3a5(0x20c)]({'botID':_0x188fe8})[_0x54a3a5(0x22c)]({'status':_0x186d3d})[_0x54a3a5(0x22c)]({'live':_0x4f36f7})['write']();if(_0x186d3d==_0x54a3a5(0x2e5)||_0x186d3d==_0x54a3a5(0x1a0))logger['full']('Enabled\x20Bot\x20'+_0x188fe8),startBot([_0x188fe8,userID],{'cwd':bbpath},function(_0x1287c0){const _0x3e11c5=_0x54a3a5;if(_0x1287c0)logger[_0x3e11c5(0x131)](_0x1287c0);});else(_0x186d3d==_0x54a3a5(0x308)||_0x186d3d==_0x54a3a5(0x210))&&(logger['full'](_0x54a3a5(0x194)+_0x188fe8),stopBot(_0x188fe8));config=getConfiguration(),io['to'](_0x54a3a5(0x1ae))[_0x54a3a5(0x19e)]('bots',config),broadcastToBots('bots',JSON[_0x54a3a5(0x1dd)](config));}function toggleStatus(_0x27c6e6){const _0x47f8f2=_0x3b8906;let _0x31b55f=dbConfig[_0x47f8f2(0x1b8)]('bots')[_0x47f8f2(0x20c)]({'botID':_0x27c6e6})[_0x47f8f2(0x2f1)](),_0x563824;if(_0x31b55f['status']==='enabled')_0x563824=_0x47f8f2(0x308);else{if(_0x31b55f[_0x47f8f2(0x13a)]===_0x47f8f2(0x1a0))_0x563824='new-disabled';else{if(_0x31b55f[_0x47f8f2(0x13a)]===_0x47f8f2(0x210))_0x563824=_0x47f8f2(0x1a0);else{if(_0x31b55f[_0x47f8f2(0x13a)]===_0x47f8f2(0x308))_0x563824=_0x47f8f2(0x2e5);}}}return _0x563824;}function updateStatus(_0x4f4665,_0x307e7e){const _0x25bce6=_0x3b8906;dbConfig[_0x25bce6(0x1b8)](_0x25bce6(0x2fd))[_0x25bce6(0x20c)]({'botID':_0x4f4665})[_0x25bce6(0x22c)]({'status':_0x307e7e})[_0x25bce6(0x1d9)](),config=getConfiguration(),io['to']('botmanager')[_0x25bce6(0x19e)](_0x25bce6(0x2fd),config),broadcastToBots(_0x25bce6(0x2fd),JSON[_0x25bce6(0x1dd)](config));}function updateLive(_0x346bca,_0x39f75b){const _0x4ff35d=_0x3b8906;dbConfig[_0x4ff35d(0x1b8)]('bots')['find']({'botID':_0x346bca})[_0x4ff35d(0x22c)]({'live':_0x39f75b})[_0x4ff35d(0x1d9)](),config=getConfiguration(),io['to']('botmanager')[_0x4ff35d(0x19e)](_0x4ff35d(0x2fd),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotName(_0x7d1d74,_0x52ef6b){const _0x5ae7d9=_0x3b8906;dbConfig[_0x5ae7d9(0x1b8)](_0x5ae7d9(0x2fd))['find']({'botID':_0x7d1d74})[_0x5ae7d9(0x22c)]({'botname':_0x52ef6b})[_0x5ae7d9(0x1d9)](),config=getConfiguration(),io['to'](_0x5ae7d9(0x1ae))[_0x5ae7d9(0x19e)](_0x5ae7d9(0x2fd),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0x869266=_0x3b8906;config=getConfiguration(),io['to'](_0x869266(0x1ae))['emit'](_0x869266(0x2fd),config),broadcastToBots('bots',JSON[_0x869266(0x1dd)](config));}function toggleBotMode(_0x5933b3){const _0x2e79a1=_0x3b8906;if(pid[_0x5933b3])pid[_0x5933b3][_0x2e79a1(0x29a)]({'function':_0x2e79a1(0x315),'args':null});else{const _0x2864ac=configpath+'bot-'+_0x5933b3+_0x2e79a1(0x2ae),_0x443836=fs['readFileSync'](_0x2864ac),_0x556af6=JSON['parse'](_0x443836),_0x474c5b=_0x556af6[_0x2e79a1(0x1bd)][0x0][_0x2e79a1(0x24d)];_0x556af6['bot'][0x0]['headless']=!_0x474c5b;const _0x4902d4=JSON[_0x2e79a1(0x1dd)](_0x556af6,null,0x2);fs[_0x2e79a1(0x199)](_0x2864ac,_0x4902d4),config=getConfiguration(),io['to'](_0x2e79a1(0x1ae))[_0x2e79a1(0x19e)]('bots',config),broadcastToBots(_0x2e79a1(0x2fd),JSON[_0x2e79a1(0x1dd)](config));}}function validateTelegram(_0x2ccf8e){const _0x13118f=_0x3b8906;if(_0x2ccf8e[_0x13118f(0x118)][_0x13118f(0x319)]!=settings[_0x13118f(0x205)]&&'@'+_0x2ccf8e['from'][_0x13118f(0x319)]!=settings[_0x13118f(0x205)]||_0x2ccf8e[_0x13118f(0x1e1)]['id']!=settings[_0x13118f(0x28f)])return sendTelegram(_0x2ccf8e[_0x13118f(0x1e1)]['id'],_0x13118f(0x240),{'parse_mode':_0x13118f(0x30b)}),![];return!![];}async function initTelegram(){const _0x4d0910=_0x3b8906;if(tgBot)tgBot[_0x4d0910(0x20b)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0x2c700e=_0x4d0910(0x14b);_0x2c700e+='\x0a',_0x2c700e+=_0x4d0910(0x267),_0x2c700e+=_0x4d0910(0x209),_0x2c700e+=_0x4d0910(0x2d0),_0x2c700e+=_0x4d0910(0x285),_0x2c700e+=_0x4d0910(0x284),_0x2c700e+='/off\x20-\x20stop\x20bot(s)\x0a',_0x2c700e+=_0x4d0910(0x2ac),_0x2c700e+=_0x4d0910(0x1e0),_0x2c700e+=_0x4d0910(0x1fa),_0x2c700e+=_0x4d0910(0x200),_0x2c700e+=_0x4d0910(0x1ef),_0x2c700e+=_0x4d0910(0x114),_0x2c700e+=_0x4d0910(0x2d5),_0x2c700e+=_0x4d0910(0x133);let _0x3eaa93='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x3eaa93+='\x0a',_0x3eaa93+=_0x2c700e,tgBot[_0x4d0910(0x16b)]((_0x2d06a3,_0x89a51b)=>{const _0x5a3c76=_0x4d0910;logger[_0x5a3c76(0x2a5)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger['debug'](_0x5a3c76(0x262),_0x2d06a3);}),tgBot[_0x4d0910(0x16d)](async(_0x2369bd,_0x3354c3)=>{const _0x4d7dda=_0x4d0910;if(!(!settings[_0x4d7dda(0x28f)]&&_0x2369bd['update']['message'][_0x4d7dda(0x1df)]==_0x4d7dda(0x244))){if(!validateTelegram(_0x2369bd))return;}_0x3354c3();}),tgBot[_0x4d0910(0x2bb)](_0x4d0910(0x2f0),async _0x2bd6e4=>{const _0x3fdac7=_0x4d0910;if(!settings[_0x3fdac7(0x28f)])updateSetting('telegramChatId',_0x2bd6e4['chat']['id']);updateSetting('telegramEnabled',!![]);if(!validateTelegram(_0x2bd6e4))return;await sendTelegram(_0x2bd6e4[_0x3fdac7(0x1e1)]['id'],_0x3eaa93);}),tgBot[_0x4d0910(0x2bb)](_0x4d0910(0x307),async _0x1252f9=>{updateSetting('telegramEnabled',!![]),await sendTelegram(_0x1252f9['chat']['id'],'Notifications\x20enabled');}),tgBot[_0x4d0910(0x2bb)](_0x4d0910(0x1a3),async _0x138d7f=>{const _0x55ac58=_0x4d0910;await sendTelegram(_0x138d7f[_0x55ac58(0x1e1)]['id'],_0x55ac58(0x27c)),updateSetting(_0x55ac58(0x2b0),![]);}),tgBot[_0x4d0910(0x2bb)]('config',async _0x287432=>{const _0x1e9135=_0x4d0910,_0x455712=Markup[_0x1e9135(0x282)]([Markup[_0x1e9135(0x219)][_0x1e9135(0x1bf)](_0x1e9135(0x274),_0x1e9135(0x170)),Markup[_0x1e9135(0x219)][_0x1e9135(0x1bf)](_0x1e9135(0x29c),_0x1e9135(0x2e7)),Markup['button'][_0x1e9135(0x1bf)](_0x1e9135(0x163),'config_all')]);_0x287432[_0x1e9135(0x2f9)](_0x1e9135(0x318),_0x455712);}),tgBot[_0x4d0910(0x27f)]('config_orders',async _0x2f4630=>{const _0x46d7f8=_0x4d0910;_0x2f4630[_0x46d7f8(0x14f)](),updateSetting(_0x46d7f8(0x167),_0x46d7f8(0x21f)),updateSetting(_0x46d7f8(0x2b0),!![]),await sendTelegram(_0x2f4630['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0x4d0910(0x27f)](_0x4d0910(0x2e7),async _0x551d98=>{const _0x316f8f=_0x4d0910;_0x551d98[_0x316f8f(0x14f)](),updateSetting(_0x316f8f(0x167),_0x316f8f(0x212)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x551d98[_0x316f8f(0x1e1)]['id'],_0x316f8f(0x1eb));}),tgBot['action'](_0x4d0910(0x1bb),async _0x5e1b19=>{const _0x1931ff=_0x4d0910;_0x5e1b19[_0x1931ff(0x14f)](),updateSetting(_0x1931ff(0x167),_0x1931ff(0x111)),updateSetting(_0x1931ff(0x2b0),!![]),await sendTelegram(_0x5e1b19[_0x1931ff(0x1e1)]['id'],_0x1931ff(0x1b6));}),tgBot[_0x4d0910(0x2bb)](_0x4d0910(0x13a),async _0x52f86a=>{const _0x48bb2d=_0x4d0910,_0x8e803f=getBotsWithMode();let _0x25e53f='<b>Balance\x20Bot\x20Status:</b>\x0a';config['forEach'](_0x179bbb=>{const _0x39e2cd=_0xd7e6,_0x50fd06=_0x8e803f[_0x39e2cd(0x20c)](_0x584ec4=>_0x584ec4['botID']==_0x179bbb[_0x39e2cd(0x2aa)])[_0x39e2cd(0x18d)];_0x25e53f+=_0x39e2cd(0x140)+_0x179bbb['botID']+':\x20'+_0x179bbb[_0x39e2cd(0x13a)]+'\x20|\x20'+_0x50fd06+_0x39e2cd(0x259)+_0x179bbb['live']+'\x0a';}),_0x25e53f+='\x0a',_0x25e53f+=_0x48bb2d(0x256),_0x25e53f+=!settings[_0x48bb2d(0x2b0)]?_0x48bb2d(0x2d4):'Notifications\x20enabled\x0a',_0x25e53f+=settings['telegramEnabled']?settings[_0x48bb2d(0x167)]==_0x48bb2d(0x111)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x48bb2d(0x11b)+settings[_0x48bb2d(0x167)]+_0x48bb2d(0x26d):'',await sendTelegram(_0x52f86a['chat']['id'],_0x25e53f,{'parse_mode':_0x48bb2d(0x30b)});}),tgBot[_0x4d0910(0x2bb)](_0x4d0910(0x182),async _0x5ae252=>{const _0x2143bf=_0x4d0910,_0x3e8640=getEnabledBots();if(_0x3e8640[_0x2143bf(0x180)]==0x0)await sendTelegram(_0x5ae252[_0x2143bf(0x1e1)]['id'],_0x2143bf(0x1a1));else{if(_0x3e8640[_0x2143bf(0x180)]>0x1)_0x3e8640[_0x2143bf(0x1c2)]({'botID':'all'});let _0x5ea5cf=[],_0x4cdc6c=[];const _0x1d3756=_0x3e8640['length']%0x4==0x0||_0x3e8640[_0x2143bf(0x180)]%0x4==0x3||_0x3e8640[_0x2143bf(0x180)]%0x3==0x1?0x4:0x3;let _0x1cb2a5=0x0;_0x3e8640[_0x2143bf(0x193)]((_0x52989d,_0x525484)=>{const _0x14c079=_0x2143bf;if(_0x525484%_0x1d3756==0x0)_0x4cdc6c=[];_0x4cdc6c[_0x14c079(0x1c2)](Markup[_0x14c079(0x219)]['callback'](_0x52989d[_0x14c079(0x2aa)]==_0x14c079(0x111)?_0x14c079(0x15d):_0x14c079(0x140)+_0x52989d[_0x14c079(0x2aa)],'restart_'+_0x52989d[_0x14c079(0x2aa)])),_0x525484%_0x1d3756==0x0&&(_0x5ea5cf[_0x1cb2a5]=_0x4cdc6c,_0x1cb2a5++);});const _0x1c2128=Markup[_0x2143bf(0x282)](_0x5ea5cf);_0x5ae252[_0x2143bf(0x2f9)](_0x2143bf(0x14a),_0x1c2128);}}),tgBot[_0x4d0910(0x27f)](/restart_(.+)/,async _0x195e60=>{const _0x59e9ad=_0x4d0910,_0x10cd34=_0x195e60[_0x59e9ad(0x2a3)][0x1];_0x195e60[_0x59e9ad(0x14f)](),_0x10cd34=='all'?config['forEach'](_0x340c57=>{const _0x599ada=_0x59e9ad;restartBot(_0x340c57[_0x599ada(0x2aa)]);}):restartBot(_0x10cd34);}),tgBot[_0x4d0910(0x2bb)]('on',async _0x27e1f9=>{const _0x475312=_0x4d0910,_0x10ea8e=getDisabledBots();if(_0x10ea8e[_0x475312(0x180)]==0x0)await sendTelegram(_0x27e1f9[_0x475312(0x1e1)]['id'],_0x475312(0x126));else{if(_0x10ea8e[_0x475312(0x180)]>0x1)_0x10ea8e[_0x475312(0x1c2)]({'botID':'all'});let _0x3b4f2e=[],_0x405d9d=[];const _0x2f9501=_0x10ea8e[_0x475312(0x180)]%0x4==0x0||_0x10ea8e[_0x475312(0x180)]%0x4==0x3||_0x10ea8e[_0x475312(0x180)]%0x3==0x1?0x4:0x3;let _0x294c89=0x0;_0x10ea8e[_0x475312(0x193)]((_0x41af2b,_0x51e64b)=>{const _0x239440=_0x475312;if(_0x51e64b%_0x2f9501==0x0)_0x405d9d=[];_0x405d9d[_0x239440(0x1c2)](Markup[_0x239440(0x219)][_0x239440(0x1bf)](_0x41af2b[_0x239440(0x2aa)]==_0x239440(0x111)?_0x239440(0x15d):'Bot\x20'+_0x41af2b[_0x239440(0x2aa)],'on_'+_0x41af2b[_0x239440(0x2aa)])),_0x51e64b%_0x2f9501==0x0&&(_0x3b4f2e[_0x294c89]=_0x405d9d,_0x294c89++);});const _0x3f1ea1=Markup['inlineKeyboard'](_0x3b4f2e);_0x27e1f9[_0x475312(0x2f9)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x3f1ea1);}}),tgBot[_0x4d0910(0x27f)](/on_(.+)/,async _0x15cf6f=>{const _0x3f8a5c=_0x4d0910,_0x2e9a00=_0x15cf6f[_0x3f8a5c(0x2a3)][0x1];_0x15cf6f[_0x3f8a5c(0x14f)]();if(_0x2e9a00==_0x3f8a5c(0x111)){const _0x263c89=getDisabledBots();await sendTelegram(_0x15cf6f['chat']['id'],_0x3f8a5c(0x23e)),_0x263c89[_0x3f8a5c(0x193)](_0x14877f=>{const _0x3f6b1e=_0x3f8a5c;if(_0x14877f[_0x3f6b1e(0x2aa)]!=_0x3f6b1e(0x111))toggleBot(_0x14877f[_0x3f6b1e(0x2aa)],toggleStatus(_0x14877f[_0x3f6b1e(0x2aa)]),'stopped');});}else await sendTelegram(_0x15cf6f[_0x3f8a5c(0x1e1)]['id'],_0x3f8a5c(0x25c)+_0x2e9a00),toggleBot(_0x2e9a00,toggleStatus(_0x2e9a00),'stopped');}),tgBot[_0x4d0910(0x2bb)](_0x4d0910(0x215),async _0x39e00c=>{const _0x5de845=_0x4d0910,_0x21a141=getEnabledBots();if(_0x21a141[_0x5de845(0x180)]==0x0)await sendTelegram(_0x39e00c[_0x5de845(0x1e1)]['id'],_0x5de845(0x1a1));else{if(_0x21a141['length']>0x1)_0x21a141[_0x5de845(0x1c2)]({'botID':'all'});let _0x5f04ac=[],_0x25ee3d=[];const _0x175284=_0x21a141[_0x5de845(0x180)]%0x4==0x0||_0x21a141[_0x5de845(0x180)]%0x4==0x3||_0x21a141['length']%0x3==0x1?0x4:0x3;let _0x2bdd15=0x0;_0x21a141['forEach']((_0x222ab4,_0x38fa77)=>{const _0x1fbc3b=_0x5de845;if(_0x38fa77%_0x175284==0x0)_0x25ee3d=[];_0x25ee3d[_0x1fbc3b(0x1c2)](Markup[_0x1fbc3b(0x219)][_0x1fbc3b(0x1bf)](_0x222ab4['botID']==_0x1fbc3b(0x111)?'All\x20bots':_0x1fbc3b(0x140)+_0x222ab4[_0x1fbc3b(0x2aa)],'off_'+_0x222ab4[_0x1fbc3b(0x2aa)])),_0x38fa77%_0x175284==0x0&&(_0x5f04ac[_0x2bdd15]=_0x25ee3d,_0x2bdd15++);});const _0x4d8682=Markup[_0x5de845(0x282)](_0x5f04ac);_0x39e00c[_0x5de845(0x2f9)](_0x5de845(0x1b3),_0x4d8682);}}),tgBot[_0x4d0910(0x27f)](/off_(.+)/,async _0x47348b=>{const _0x276887=_0x4d0910,_0x52c334=_0x47348b[_0x276887(0x2a3)][0x1];_0x47348b['editMessageReplyMarkup']();if(_0x52c334==_0x276887(0x111)){const _0x3dfa5a=getEnabledBots();await sendTelegram(_0x47348b['chat']['id'],_0x276887(0x1ed)),_0x3dfa5a[_0x276887(0x193)](_0x279456=>{const _0x2e6955=_0x276887;if(_0x279456[_0x2e6955(0x2aa)]!=_0x2e6955(0x111))toggleBot(_0x279456[_0x2e6955(0x2aa)],toggleStatus(_0x279456[_0x2e6955(0x2aa)]),_0x2e6955(0x177));});}else await sendTelegram(_0x47348b[_0x276887(0x1e1)]['id'],_0x276887(0x19b)+_0x52c334),toggleBot(_0x52c334,toggleStatus(_0x52c334),_0x276887(0x177));}),tgBot[_0x4d0910(0x2bb)](_0x4d0910(0x197),async _0x34bb88=>{const _0x7d6b71=_0x4d0910,_0xaf70fa=getEnabledBots();if(_0xaf70fa[_0x7d6b71(0x180)]==0x0)await sendTelegram(_0x34bb88[_0x7d6b71(0x1e1)]['id'],_0x7d6b71(0x1a1));else{if(_0xaf70fa['length']>0x1){let _0x1319ca=[],_0x5c76e0=[];const _0x3d75bf=_0xaf70fa[_0x7d6b71(0x180)]%0x4==0x0||_0xaf70fa['length']%0x4==0x3||_0xaf70fa['length']%0x3==0x1?0x4:0x3;let _0x38f586=0x0;_0xaf70fa[_0x7d6b71(0x193)]((_0x44b75a,_0x5f44c1)=>{const _0x1f6a01=_0x7d6b71;if(_0x5f44c1%_0x3d75bf==0x0)_0x5c76e0=[];_0x5c76e0['push'](Markup['button'][_0x1f6a01(0x1bf)](_0x1f6a01(0x140)+_0x44b75a['botID'],_0x1f6a01(0x1f4)+_0x44b75a[_0x1f6a01(0x2aa)])),_0x5f44c1%_0x3d75bf==0x0&&(_0x1319ca[_0x38f586]=_0x5c76e0,_0x38f586++);});const _0xcd29a6=Markup[_0x7d6b71(0x282)](_0x1319ca);_0x34bb88[_0x7d6b71(0x2f9)](_0x7d6b71(0x1b4),_0xcd29a6);}else{const _0x59f24c=_0xaf70fa[0x0][_0x7d6b71(0x2aa)];if(pid[_0x59f24c])pid[_0x59f24c][_0x7d6b71(0x29a)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x4d0910(0x27f)](/metrics_(.+)/,async _0x3843c9=>{const _0x1b38df=_0x4d0910,_0x2c04fd=_0x3843c9[_0x1b38df(0x2a3)][0x1];_0x3843c9[_0x1b38df(0x14f)]();if(pid[_0x2c04fd])pid[_0x2c04fd][_0x1b38df(0x29a)]({'function':_0x1b38df(0x127),'args':null});}),tgBot[_0x4d0910(0x2bb)](_0x4d0910(0x260),async _0x3dab29=>{const _0x5cad6e=_0x4d0910,_0x18d510=getEnabledBots();if(_0x18d510['length']==0x0)await sendTelegram(_0x3dab29[_0x5cad6e(0x1e1)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x18d510[_0x5cad6e(0x180)]>0x1){let _0x47779b=[],_0x1b5f21=[];const _0x2653a7=_0x18d510[_0x5cad6e(0x180)]%0x4==0x0||_0x18d510[_0x5cad6e(0x180)]%0x4==0x3||_0x18d510[_0x5cad6e(0x180)]%0x3==0x1?0x4:0x3;let _0x2f5e85=0x0;_0x18d510[_0x5cad6e(0x193)]((_0x1bbfdf,_0x3717c9)=>{const _0x3a4fd9=_0x5cad6e;if(_0x3717c9%_0x2653a7==0x0)_0x1b5f21=[];_0x1b5f21[_0x3a4fd9(0x1c2)](Markup[_0x3a4fd9(0x219)][_0x3a4fd9(0x1bf)]('Bot\x20'+_0x1bbfdf[_0x3a4fd9(0x2aa)],'portfolio_'+_0x1bbfdf['botID'])),_0x3717c9%_0x2653a7==0x0&&(_0x47779b[_0x2f5e85]=_0x1b5f21,_0x2f5e85++);});const _0x51032b=Markup[_0x5cad6e(0x282)](_0x47779b);_0x3dab29['reply'](_0x5cad6e(0x181),_0x51032b);}else{const _0x2d1538=_0x18d510[0x0][_0x5cad6e(0x2aa)];if(pid[_0x2d1538])pid[_0x2d1538][_0x5cad6e(0x29a)]({'function':_0x5cad6e(0x161),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0xb92a54=>{const _0x4bbde6=_0x4d0910,_0xd40360=_0xb92a54[_0x4bbde6(0x2a3)][0x1];_0xb92a54['editMessageReplyMarkup']();if(pid[_0xd40360])pid[_0xd40360][_0x4bbde6(0x29a)]({'function':_0x4bbde6(0x161),'args':null});}),tgBot['command'](_0x4d0910(0x189),async _0x278987=>{const _0x3012b4=_0x4d0910;await getMessages();if(!updateAvailable)await sendTelegram(_0x278987[_0x3012b4(0x1e1)]['id'],_0x3012b4(0x2bd));else{if(!validInstallation)await sendTelegram(_0x278987[_0x3012b4(0x1e1)]['id'],_0x3012b4(0x18b));else{const _0x579c83=Markup[_0x3012b4(0x282)]([Markup[_0x3012b4(0x219)]['callback']('Yes',_0x3012b4(0x31b)),Markup[_0x3012b4(0x219)][_0x3012b4(0x1bf)]('No','update_no')]);_0x278987[_0x3012b4(0x2f9)](_0x3012b4(0x21d),_0x579c83);}}}),tgBot[_0x4d0910(0x27f)](/update_(.+)/,async _0x1ae28e=>{const _0x143aa6=_0x4d0910,_0x3d7ccc=_0x1ae28e['match'][0x1];_0x1ae28e['editMessageReplyMarkup'](),_0x3d7ccc==_0x143aa6(0x2d2)&&(await sendTelegram(_0x1ae28e[_0x143aa6(0x1e1)]['id'],_0x143aa6(0x11d)),updateBB('update')),_0x3d7ccc=='no'&&await sendTelegram(_0x1ae28e[_0x143aa6(0x1e1)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot['command'](_0x4d0910(0x1b7),async _0x1d1f14=>{const _0x3b9043=_0x4d0910;if(!validInstallation)await sendTelegram(_0x1d1f14['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0xdc1769=Markup[_0x3b9043(0x282)]([Markup['button'][_0x3b9043(0x1bf)]('Yes',_0x3b9043(0x1e3)),Markup[_0x3b9043(0x219)][_0x3b9043(0x1bf)]('No',_0x3b9043(0x26b))]);_0x1d1f14[_0x3b9043(0x2f9)](_0x3b9043(0x2c5),_0xdc1769);}}),tgBot['action'](/reinstall_(.+)/,async _0xdcf18e=>{const _0x4c3fe0=_0x4d0910,_0x1cf9ec=_0xdcf18e['match'][0x1];_0xdcf18e[_0x4c3fe0(0x14f)](),_0x1cf9ec==_0x4c3fe0(0x2d2)&&(await sendTelegram(_0xdcf18e[_0x4c3fe0(0x1e1)]['id'],_0x4c3fe0(0x1ec)),updateBB(_0x4c3fe0(0x1b7))),_0x1cf9ec=='no'&&await sendTelegram(_0xdcf18e['chat']['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x4d0910(0x2bb)](_0x4d0910(0x2f6),async _0x497047=>{const _0x3dd0b0=_0x4d0910,_0x3341a5=getBotsWithMode();if(_0x3341a5['length']==0x0)await sendTelegram(_0x497047['chat']['id'],_0x3dd0b0(0x1a1));else{let _0x226631=[],_0x332c14=[];const _0x2b2fe2=0x2;let _0x24e231=0x0;_0x3341a5[_0x3dd0b0(0x193)]((_0x18345a,_0x1de367)=>{const _0x28e5d8=_0x3dd0b0;if(_0x1de367%_0x2b2fe2==0x0)_0x332c14=[];_0x332c14[_0x28e5d8(0x1c2)](Markup[_0x28e5d8(0x219)][_0x28e5d8(0x1bf)](_0x28e5d8(0x140)+_0x18345a[_0x28e5d8(0x2aa)]+'\x20('+_0x18345a['mode']+')',_0x28e5d8(0x18a)+_0x18345a['botID'])),_0x1de367%_0x2b2fe2==0x0&&(_0x226631[_0x24e231]=_0x332c14,_0x24e231++);});const _0x4336a2=Markup[_0x3dd0b0(0x282)](_0x226631);_0x497047[_0x3dd0b0(0x2f9)](_0x3dd0b0(0x2b9),_0x4336a2);}}),tgBot[_0x4d0910(0x27f)](/toggle_(.+)/,async _0xbe23b=>{const _0x5b10a6=_0x4d0910,_0x5da88b=_0xbe23b[_0x5b10a6(0x2a3)][0x1];_0xbe23b[_0x5b10a6(0x14f)]();const _0x549001=getBotsWithMode(),_0x4e642a=_0x549001[_0x5b10a6(0x20c)](_0x541e17=>_0x541e17[_0x5b10a6(0x2aa)]==_0x5da88b),_0x575041=_0x4e642a[_0x5b10a6(0x18d)]==_0x5b10a6(0x19c)?_0x5b10a6(0x306):'auto';await sendTelegram(_0xbe23b['chat']['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x5da88b+_0x5b10a6(0x293)+_0x575041+_0x5b10a6(0x2ab)),toggleBotMode(_0x5da88b);}),tgBot[_0x4d0910(0x2bb)]('names',async _0x8c3d9e=>{const _0x31d612=_0x4d0910;let _0x2e25ac='';config[_0x31d612(0x193)](_0x183260=>{const _0x1caefe=_0x31d612;_0x2e25ac+='Bot\x20'+_0x183260[_0x1caefe(0x2aa)]+':\x20'+_0x183260['botname']+'\x0a';}),await sendTelegram(_0x8c3d9e['chat']['id'],_0x2e25ac,{'parse_mode':_0x31d612(0x30b)});}),tgBot['command']('help',async _0x480b02=>{const _0x53970d=_0x4d0910;await sendTelegram(_0x480b02[_0x53970d(0x1e1)]['id'],_0x2c700e);}),process[_0x4d0910(0x2b3)](_0x4d0910(0x2b2),()=>tgBot['stop']('SIGINT')),process[_0x4d0910(0x2b3)](_0x4d0910(0x2c7),()=>tgBot['stop'](_0x4d0910(0x2c7))),tgBot[_0x4d0910(0x1f1)]();}}function disableTelegram(){const _0x52d3f4=_0x3b8906;tgBot&&tgBot[_0x52d3f4(0x20b)]();}async function sendTelegram(_0x54fe6b,_0x49d8b6,_0x537d21){const _0x7e2b4=_0x3b8906;_0x537d21={..._0x537d21,'disable_web_page_preview':!![]};try{await tgBot[_0x7e2b4(0x1ab)][_0x7e2b4(0x168)](_0x54fe6b,_0x49d8b6,_0x537d21);}catch(_0x1c619d){console[_0x7e2b4(0x16f)](_0x7e2b4(0x290),_0x1c619d);}}async function sendTelegramBot(_0x3b1807,_0x35aba9){const _0x68bac6=_0x3b8906;if(settings[_0x68bac6(0x2b0)]){if(settings[_0x68bac6(0x167)]=='all'||(_0x35aba9['type']=='error'||_0x35aba9[_0x68bac6(0x251)]==_0x68bac6(0x12d)||_0x35aba9['type']==_0x68bac6(0x2e0))&&settings['telegramEvents']=='alerts'||_0x35aba9[_0x68bac6(0x251)]==_0x68bac6(0x230)&&settings[_0x68bac6(0x167)]==_0x68bac6(0x21f)){if(tgBot&&settings[_0x68bac6(0x28f)]){if(_0x35aba9[_0x68bac6(0x299)])await sendTelegram(settings['telegramChatId'],_0x35aba9[_0x68bac6(0x31a)]+_0x68bac6(0x1d4)+_0x35aba9[_0x68bac6(0x268)]);else await sendTelegram(settings['telegramChatId'],_0x68bac6(0x140)+_0x3b1807+_0x68bac6(0x1d4)+_0x35aba9['event']);}}}}async function sendTelegramMsg(_0xcd0196,_0x93dc1c=_0x3b8906(0x30b)){const _0x5daba3=_0x3b8906;return settings[_0x5daba3(0x2b0)]&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings['telegramChatId'],_0xcd0196,{'parse_mode':_0x93dc1c}),!![]):![];}function getDeviceWithIp(_0x43cfb7){const _0x4d7e2c=_0x3b8906;return devices[_0x4d7e2c(0x20c)](_0x173a6e=>_0x173a6e['ip']===_0x43cfb7);}async function temporaryAccess2FA(_0x249825,_0x35d97a){const _0x3c526d=_0x3b8906;let _0x576305=new Date(),_0x4155aa=![];if(lastIpApproval){if(_0x576305-lastIpApproval<0x1388)_0x4155aa=!![];}lastIpApproval=new Date();if(_0x4155aa)return;if(tgBot&&settings[_0x3c526d(0x28f)]){const _0x1df0e4=uuidRandom();tmpStorage[_0x1df0e4]={'uuid':_0x249825,'externalip':_0x35d97a};const _0x50722a=Markup['inlineKeyboard']([Markup[_0x3c526d(0x219)]['callback'](_0x3c526d(0x186),'tempaccess_5_'+_0x1df0e4),Markup[_0x3c526d(0x219)][_0x3c526d(0x1bf)](_0x3c526d(0x300),_0x3c526d(0x1dc)+_0x1df0e4),Markup[_0x3c526d(0x219)][_0x3c526d(0x1bf)]('30\x20min',_0x3c526d(0x165)+_0x1df0e4),Markup[_0x3c526d(0x219)][_0x3c526d(0x1bf)]('reject',_0x3c526d(0x23c)+_0x1df0e4)]);await sendTelegram(settings[_0x3c526d(0x28f)],_0x3c526d(0x2a4)+normalizeIP(_0x35d97a)['show']+'\x20?',_0x50722a),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x26c6aa=>{const _0x340a7e=_0x3c526d,_0x84eaa8=_0x26c6aa['match'][0x1],_0xe648b1=_0x26c6aa[_0x340a7e(0x2a3)][0x2],{uuid:_0x5717b9,externalip:_0x4d25b7}=tmpStorage[_0xe648b1];delete tmpStorage[_0xe648b1],_0x26c6aa[_0x340a7e(0x14f)](),devices[_0x5717b9][_0x340a7e(0x15b)]={'clientip':_0x4d25b7,'timestamp':new Date()[_0x340a7e(0x1de)](),'expiry':_0x84eaa8},_0x84eaa8!=_0x340a7e(0x1f2)?(await sendTelegram(_0x26c6aa[_0x340a7e(0x1e1)]['id'],_0x340a7e(0x17f)+_0x84eaa8+_0x340a7e(0x192),{'parse_mode':_0x340a7e(0x30b)}),io['to'](_0x5717b9)[_0x340a7e(0x19e)](_0x340a7e(0x13a),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x26c6aa[_0x340a7e(0x1e1)]['id'],_0x340a7e(0x2c6)),io['to'](_0x5717b9)[_0x340a7e(0x19e)](_0x340a7e(0x13a),{'access':{'allow':![],'reason':_0x340a7e(0x144),'token':null}}));});}}async function loginAccess2FA(_0x27bd3c,_0x447b98){const _0x57e742=_0x3b8906;if(tgBot&&settings[_0x57e742(0x28f)]){const _0x4c42f3=uuidRandom();tmpStorage[_0x4c42f3]={'uuid':_0x27bd3c,'externalip':_0x447b98};const _0x1f5373=Markup[_0x57e742(0x282)]([Markup[_0x57e742(0x219)][_0x57e742(0x1bf)](_0x57e742(0x173),_0x57e742(0x2d1)+loginExpiry+'_'+_0x4c42f3),Markup[_0x57e742(0x219)][_0x57e742(0x1bf)](_0x57e742(0x1f2),'login2fa_reject_'+_0x4c42f3)]);await sendTelegram(settings[_0x57e742(0x28f)],_0x57e742(0x158)+normalizeIP(_0x447b98)[_0x57e742(0x1d2)]+'\x20?',_0x1f5373),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x36dc16=>{const _0x1a924=_0x57e742,_0x3f8650=_0x36dc16[_0x1a924(0x2a3)][0x1],_0xa9cf9e=_0x36dc16[_0x1a924(0x2a3)][0x2],{uuid:_0x3a699b,externalip:_0x30e863}=tmpStorage[_0xa9cf9e];delete tmpStorage[_0xa9cf9e],_0x36dc16['editMessageReplyMarkup'](),devices[_0x3a699b]['telegram2FaApproval']={'clientip':_0x30e863,'timestamp':new Date()[_0x1a924(0x1de)](),'expiry':_0x3f8650},_0x3f8650!='reject'?(await sendTelegram(_0x36dc16[_0x1a924(0x1e1)]['id'],_0x1a924(0x269),{'parse_mode':_0x1a924(0x30b)}),io['to'](_0x3a699b)['emit']('status',{'access':{'allow':![],'reason':_0x1a924(0x12f),'token':null}})):(await sendTelegram(_0x36dc16['chat']['id'],'Login\x20rejected'),io['to'](_0x3a699b)[_0x1a924(0x19e)]('status',{'access':{'allow':![],'reason':_0x1a924(0x234),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x5df5cf=_0x3b8906;return dbConfig[_0x5df5cf(0x1b8)]('bots')[_0x5df5cf(0x132)](_0x5df5cf(0x2aa))[_0x5df5cf(0x231)]({'status':_0x5df5cf(0x2e5)})['value']()||[];}function getDisabledBots(){const _0x3ec817=_0x3b8906;return dbConfig['get']('bots')[_0x3ec817(0x132)]('botID')['filter']({'status':_0x3ec817(0x308)})[_0x3ec817(0x2f1)]()||[];}function getBotAttributes(_0x22ae89){const _0xde91e0=_0x3b8906;let _0x3b97f8={};const _0x2f1c2d=configpath+_0xde91e0(0x2dc)+_0x22ae89+_0xde91e0(0x2ae),_0xa1b8d6=fs[_0xde91e0(0x2d7)](_0x2f1c2d);if(_0xa1b8d6){const _0x223643=fs[_0xde91e0(0x1d3)](_0x2f1c2d);try{const _0x3b5066=JSON['parse'](_0x223643),_0x3d829e=_0x3b5066?_0x3b5066[_0xde91e0(0x1bd)][0x0][_0xde91e0(0x24d)]:![];_0x3b97f8[_0xde91e0(0x18d)]=_0x3d829e?_0xde91e0(0x19c):_0xde91e0(0x306),_0x3b97f8['botname']=_0x3b5066?_0x3b5066[_0xde91e0(0x1bd)][0x0][_0xde91e0(0x31a)]:_0xde91e0(0x140)+_0x22ae89;}catch(_0x1adc0f){_0x3b97f8[_0xde91e0(0x18d)]=_0xde91e0(0x306),_0x3b97f8['botname']=_0xde91e0(0x140)+_0x22ae89;}}else _0x3b97f8[_0xde91e0(0x18d)]='manual',_0x3b97f8[_0xde91e0(0x31a)]='Bot\x20'+_0x22ae89;return _0x3b97f8;}function getBotsWithMode(){const _0x1a3e9b=_0x3b8906,_0x3138ae=dbConfig[_0x1a3e9b(0x1b8)](_0x1a3e9b(0x2fd))['sortBy'](_0x1a3e9b(0x2aa))[_0x1a3e9b(0x2f1)]()||[];return _0x3138ae[_0x1a3e9b(0x193)](_0x2452cf=>{const _0x8d362b=_0x1a3e9b;let _0xa15f63=getBotAttributes(_0x2452cf[_0x8d362b(0x2aa)]);_0x2452cf[_0x8d362b(0x18d)]=_0xa15f63['mode'];}),_0x3138ae;}function getBotExchanges(){const _0x56afb5=_0x3b8906;let _0x4788d6=[];const _0x5d9d01=dbConfig['get']('bots')[_0x56afb5(0x132)](_0x56afb5(0x2aa))[_0x56afb5(0x2f1)]()||[];_0x5d9d01[_0x56afb5(0x193)](_0x4e80b4=>{const _0x4162de=_0x56afb5;if(_0x4e80b4[_0x4162de(0x13a)]==_0x4162de(0x2e5)){const _0x21c48d=configpath+_0x4162de(0x2dc)+_0x4e80b4[_0x4162de(0x2aa)]+_0x4162de(0x2ae),_0xbbfc33=fs[_0x4162de(0x2d7)](_0x21c48d);let _0x4c82cf;if(_0xbbfc33){const _0x148989=fs[_0x4162de(0x1d3)](_0x21c48d);try{const _0x35cf27=JSON[_0x4162de(0x301)](_0x148989);_0x4c82cf=_0x35cf27?_0x35cf27[_0x4162de(0x1bd)][0x0]['exchange']:null;}catch(_0x10fd9f){}}if(_0x4c82cf)_0x4788d6['push'](_0x4c82cf);}});const _0x149b16=[...new Set(_0x4788d6)]['sort']();return _0x149b16;}async function initUser(){const _0x405e6d=_0x3b8906;if(!settings[_0x405e6d(0x216)]){const _0x535171=uuidRandom();mixpanel[_0x405e6d(0x125)](_0x535171),updateSetting('userid',_0x535171);}}async function initSecure(){const _0x3dc548=_0x3b8906;let _0x545945=getSecure();if(!_0x545945[_0x3dc548(0x152)]('secret')){let _0x44a8a7=await generateKeys();_0x545945['publicKey']=_0x44a8a7[_0x3dc548(0x162)],_0x545945[_0x3dc548(0x2d3)]=_0x44a8a7[_0x3dc548(0x2d3)],_0x545945[_0x3dc548(0x2fc)]=crypto[_0x3dc548(0x188)](0x20)[_0x3dc548(0x258)](_0x3dc548(0x29b));;storeSecure(_0x545945);}}function getSettings(){const _0x49ad0f=_0x3b8906;return dbSettings['get'](_0x49ad0f(0x304))['value']()||{};}function getSecure(){const _0x3b25b0=_0x3b8906;return dbSecure['get'](_0x3b25b0(0x26f))[_0x3b25b0(0x2f1)]()||{};}function getBlacklist(){const _0x1f1b37=_0x3b8906;return dbSecure[_0x1f1b37(0x1b8)](_0x1f1b37(0x253))[_0x1f1b37(0x2f1)]()||[];}function broadcastToBots(_0x13d43a,_0x3092bc){const _0x4ca9bb=_0x3b8906;config[_0x4ca9bb(0x193)](_0x1d5abf=>{const _0x5196a5=_0x4ca9bb;if(_0x1d5abf[_0x5196a5(0x13a)]==_0x5196a5(0x2e5)&&_0x1d5abf[_0x5196a5(0x237)]=='running'||_0x1d5abf[_0x5196a5(0x13a)]=='new'&&_0x1d5abf[_0x5196a5(0x237)]==_0x5196a5(0x227)){if(pid[_0x1d5abf[_0x5196a5(0x2aa)]])pid[_0x1d5abf[_0x5196a5(0x2aa)]][_0x5196a5(0x29a)]({[_0x13d43a]:_0x3092bc});}});}async function storeSettings(_0x27fb04,_0x485aa2=![]){const _0x584812=_0x3b8906;_0x27fb04={...settings,..._0x27fb04};if(_0x485aa2&&_0x27fb04['bbPassword']!=_0x584812(0x28c)&&_0x27fb04['bbPassword']!=_0x584812(0x1ee)&&_0x27fb04[_0x584812(0x263)]!=''){const _0x521ca8=crypt[_0x584812(0x2c9)](secure['privateKey'],_0x27fb04[_0x584812(0x263)])[_0x584812(0x1e6)][_0x584812(0x13c)]('|@|')[0x0],_0x8de313=bcrypt[_0x584812(0x18e)](_0x521ca8,saltRounds);_0x27fb04={..._0x27fb04,'bbPassword':_0x8de313};}if(_0x485aa2&&_0x27fb04['telegramToken']!=_0x584812(0x28c)&&_0x27fb04['telegramToken']!=_0x584812(0x1ee)&&_0x27fb04['telegramToken']!=''){const _0x494273=crypt['decrypt'](secure['privateKey'],_0x27fb04[_0x584812(0x1cc)])[_0x584812(0x1e6)][_0x584812(0x13c)](_0x584812(0x31d))[0x0];_0x27fb04={..._0x27fb04,'telegramToken':_0x494273};}if(_0x485aa2&&_0x27fb04[_0x584812(0x201)]!=_0x584812(0x28c)&&_0x27fb04[_0x584812(0x201)]!=_0x584812(0x1ee)&&_0x27fb04[_0x584812(0x201)]!=''){const _0x864a7d=crypt[_0x584812(0x2c9)](secure[_0x584812(0x2d3)],_0x27fb04['marketcapApi'])[_0x584812(0x1e6)][_0x584812(0x13c)]('|@|')[0x0];_0x27fb04={..._0x27fb04,'marketcapApi':_0x864a7d};}const _0x32a06d=_0x27fb04['telegramToken']!='************'&&_0x27fb04['telegramToken']!=settings['telegramToken']||_0x27fb04[_0x584812(0x205)]!=settings[_0x584812(0x205)],_0xd332ae=_0x27fb04[_0x584812(0x1cc)]==''||_0x27fb04['telegramUsername']=='',_0x5a7bbe=_0x27fb04[_0x584812(0x201)]&&_0x27fb04['marketcapApi']!='************'&&_0x27fb04['marketcapApi']!=settings['telegramToken'];_0x32a06d&&(_0x27fb04[_0x584812(0x28f)]=null,_0x27fb04['telegramEvents']='all');for(const [_0x10cbc2,_0x553ce2]of Object[_0x584812(0x314)](_0x27fb04)){if(_0x10cbc2==_0x584812(0x1cc)&&_0x553ce2=='************'){_0x27fb04[_0x584812(0x1cc)]=settings[_0x584812(0x1cc)];continue;};if(_0x10cbc2==_0x584812(0x263)&&_0x553ce2=='************'){_0x27fb04[_0x584812(0x263)]=settings[_0x584812(0x263)];continue;};if(_0x10cbc2==_0x584812(0x201)&&_0x553ce2=='************'){_0x27fb04['marketcapApi']=settings[_0x584812(0x201)];continue;};dbSettings['set'](_0x584812(0x257)+_0x10cbc2,_0x553ce2)[_0x584812(0x1d9)]();}settings=_0x27fb04,io['to'](_0x584812(0x1ae))['emit'](_0x584812(0x304),cleanSettings()),broadcastToBots('timeshift',settings['timeshift']),broadcastToBots(_0x584812(0x1ad),settings[_0x584812(0x1ad)]),broadcastToBots(_0x584812(0x201),settings[_0x584812(0x201)]);if(_0x32a06d&&!_0xd332ae)initTelegram();if(_0x32a06d&&_0xd332ae)disableTelegram();getAllClients()[_0x584812(0x193)](_0x574353=>{const _0x951936=_0x584812;getSocket(_0x574353['id'])[_0x951936(0x19e)](_0x951936(0x13a),{'access':{'allow':![],'reason':'reload','token':null}});}),_0x5a7bbe&&(await sleep(0xbb8),testMarketcapApi(_0x27fb04[_0x584812(0x201)]));}async function testMarketcapApi(_0x536bdd){const _0x3f8440=_0x3b8906,_0x5f4ef4=[_0x3f8440(0x31f),_0x3f8440(0x218)];try{await axios[_0x3f8440(0x1b8)]('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0x536bdd},'params':{'symbol':_0x5f4ef4[_0x3f8440(0x258)]()}});}catch(_0x34d15e){_0x34d15e[_0x3f8440(0x258)]()[_0x3f8440(0x270)]('status\x20code\x20401')?(io['to']('botmanager')[_0x3f8440(0x19e)](_0x3f8440(0x2eb),'CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x3f8440(0x131)](_0x3f8440(0x175))):(io['to'](_0x3f8440(0x1ae))[_0x3f8440(0x19e)](_0x3f8440(0x2eb),_0x3f8440(0x309)),logger[_0x3f8440(0x131)]('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x3f8440(0x1c6)](_0x3f8440(0x280),_0x34d15e[_0x3f8440(0x258)]()+_0x3f8440(0x2db)+_0x34d15e[_0x3f8440(0x1ea)]));return;}logger[_0x3f8440(0x1c6)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0xacfc01,_0x41bb23){const _0x1072d1=_0x3b8906;dbSettings['set'](_0x1072d1(0x257)+_0xacfc01,_0x41bb23)['write'](),settings=getSettings(),io['to'](_0x1072d1(0x1ae))[_0x1072d1(0x19e)](_0x1072d1(0x304),cleanSettings());}function storeSecure(_0xe932b3){const _0x595cf5=_0x3b8906;dbSecure[_0x595cf5(0x1b8)](_0x595cf5(0x26f))[_0x595cf5(0x1c2)](_0xe932b3)[_0x595cf5(0x1d9)](),secure=_0xe932b3;}function addBlacklist(_0x39c477){const _0x3648e2=_0x3b8906;cleanBlacklist();let _0x57ef4c;devices[_0x39c477][_0x3648e2(0x15b)]?_0x57ef4c=Math[_0x3648e2(0x18c)](devices[_0x39c477]['telegramIpApproval'][_0x3648e2(0x1cd)],loginExpiry):_0x57ef4c=loginExpiry,dbSecure[_0x3648e2(0x1b8)](_0x3648e2(0x253))[_0x3648e2(0x1c2)]({'expiry':new Date()[_0x3648e2(0x1de)]()+_0x57ef4c*0x3c*0x3e8,'token':devices[_0x39c477]['access'][_0x3648e2(0x2cd)]})['write'](),blacklist=dbSecure['get'](_0x3648e2(0x253))[_0x3648e2(0x2f1)]();}function cleanBlacklist(){const _0x17496d=_0x3b8906;let _0x4d8b45=dbSecure['get'](_0x17496d(0x253))[_0x17496d(0x25f)]()[_0x17496d(0x2f1)](),_0x1cd57d=new Date()[_0x17496d(0x1de)]();_0x4d8b45[_0x17496d(0x193)](_0x398253=>{const _0xc30ae5=_0x17496d;_0x398253[_0xc30ae5(0x1cd)]<_0x1cd57d&&dbSecure[_0xc30ae5(0x1b8)]('blacklist')['remove']({'expiry':_0x398253[_0xc30ae5(0x1cd)]})[_0xc30ae5(0x1d9)]();});}function initStates(){const _0x1df040=_0x3b8906;let _0x2c25a9=getConfiguration();_0x2c25a9[_0x1df040(0x193)](_0xc98d46=>{const _0x498d1e=_0x1df040;_0xc98d46[_0x498d1e(0x237)]=_0x498d1e(0x177);}),storeConfiguration(_0x2c25a9);}function onKeys(){const _0x3fb4ae=new RSA();return new Promise(_0x3ecfd2=>{const _0x318cb0=_0xd7e6;_0x3fb4ae[_0x318cb0(0x2ce)]()[_0x318cb0(0x121)](_0x16befe=>{_0x3ecfd2(_0x16befe);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5f1778=_0x3b8906;let _0x51cfaf=getSettings(),_0x24eab3=![];!_0x51cfaf['hasOwnProperty'](_0x5f1778(0x2e4))&&(_0x51cfaf[_0x5f1778(0x2e4)]=0x0,_0x24eab3=!![]);!_0x51cfaf['hasOwnProperty'](_0x5f1778(0x254))&&(_0x51cfaf[_0x5f1778(0x254)]=0x0,_0x24eab3=!![]);!_0x51cfaf[_0x5f1778(0x152)](_0x5f1778(0x124))&&(_0x51cfaf['latestversion']=_0x5f1778(0x229),_0x24eab3=!![]);!_0x51cfaf[_0x5f1778(0x152)]('onepagemode')&&(_0x51cfaf[_0x5f1778(0x1ad)]=![],_0x24eab3=!![]);!_0x51cfaf[_0x5f1778(0x152)](_0x5f1778(0x201))&&(_0x51cfaf[_0x5f1778(0x201)]='',_0x24eab3=!![]);if(_0x24eab3)storeSettings(_0x51cfaf);try{fs[_0x5f1778(0x15e)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x58ce84=>{const _0x454ebf=_0x5f1778;if(!_0x58ce84[_0x454ebf(0x20d)]()){if(!_0x58ce84[_0x454ebf(0x149)]['startsWith']('backup-full@'))fs[_0x454ebf(0x2dd)](configbackuppath+_0x58ce84[_0x454ebf(0x149)]);}else fs[_0x454ebf(0x223)](configbackuppath+_0x58ce84['name'],{'recursive':!![]});});}catch(_0x3d5da2){logger[_0x5f1778(0x1c6)](_0x5f1778(0x22d),_0x3d5da2);}}function storeConfiguration(_0x37ab02){const _0xecfff5=_0x3b8906;dbConfig[_0xecfff5(0x1b8)](_0xecfff5(0x2fd))[_0xecfff5(0x2c0)]()[_0xecfff5(0x1d9)](),dbConfig[_0xecfff5(0x1b8)](_0xecfff5(0x2fd))[_0xecfff5(0x1c2)](..._0x37ab02)['write'](),config=_0x37ab02;}async function resetPassword(){const _0x4a9812=_0x3b8906;if(tgBot&&settings[_0x4a9812(0x28f)]){const _0x59217d=Markup['inlineKeyboard']([Markup[_0x4a9812(0x219)][_0x4a9812(0x1bf)](_0x4a9812(0x2d2),_0x4a9812(0x142)),Markup[_0x4a9812(0x219)]['callback']('no',_0x4a9812(0x292))]);await sendTelegram(settings[_0x4a9812(0x28f)],_0x4a9812(0x2f5),_0x59217d),tgBot['action'](/resetpw_(.+)/,async _0x355825=>{const _0x361e35=_0x4a9812,_0x29b487=_0x355825['match'][0x1];_0x355825[_0x361e35(0x14f)]();if(_0x29b487!='no'){const _0x260b02=0xf,_0x2b9b21='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x59f55e=Array[_0x361e35(0x118)](crypto[_0x361e35(0x28e)](new Uint32Array(_0x260b02)))['map'](_0x2e54f8=>_0x2b9b21[_0x2e54f8%_0x2b9b21[_0x361e35(0x180)]])[_0x361e35(0x1e2)](''),_0x29ed62=bcrypt[_0x361e35(0x18e)](_0x59f55e,saltRounds);storeSettings({'bbPassword':_0x29ed62}),await sendTelegram(_0x355825[_0x361e35(0x1e1)]['id'],_0x361e35(0x17e)+_0x59f55e,{'parse_mode':_0x361e35(0x30b)});}else await sendTelegram(_0x355825[_0x361e35(0x1e1)]['id'],_0x361e35(0x21a));});}}async function confirmRestore(_0x4ac30b,_0x3b3409){const _0xb7d0be=_0x3b8906;io['to'](_0xb7d0be(0x1ae))['emit'](_0xb7d0be(0x2eb),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0xb7d0be(0x2e0));if(tgBot&&settings[_0xb7d0be(0x28f)]){const _0x5112d3=uuidRandom();tmpStorage[_0x5112d3]={'path':_0x4ac30b,'filename':_0x3b3409};const _0x3bcbd9=Markup['inlineKeyboard']([Markup[_0xb7d0be(0x219)][_0xb7d0be(0x1bf)](_0xb7d0be(0x2d2),_0xb7d0be(0x261)+_0x5112d3),Markup['button'][_0xb7d0be(0x1bf)]('no','restore_no_'+_0x5112d3)]);await sendTelegram(settings[_0xb7d0be(0x28f)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x3bcbd9),tgBot[_0xb7d0be(0x27f)](/restore_(.+)_(.+)/,async _0x4ad16c=>{const _0x41bdb9=_0xb7d0be,_0x553723=_0x4ad16c[_0x41bdb9(0x2a3)][0x1],_0x2e6704=_0x4ad16c[_0x41bdb9(0x2a3)][0x2],{path:_0x14f6a9,filename:_0x3e1a54}=tmpStorage[_0x2e6704];delete tmpStorage[_0x2e6704],_0x4ad16c[_0x41bdb9(0x14f)](),_0x553723=='yes'?(logger[_0x41bdb9(0x1c6)](_0x41bdb9(0x1c8)),await sendTelegram(_0x4ad16c[_0x41bdb9(0x1e1)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x41bdb9(0x30b)}),unzipFile(_0x14f6a9,_0x3e1a54)):(logger['debug']('Restore\x20process\x20aborted'),await sendTelegram(_0x4ad16c['chat']['id'],_0x41bdb9(0x1ac)));});}}function getServerTime(){const _0x217821=_0x3b8906,_0xaddec=new Date();return _0xaddec[_0x217821(0x207)]()+'/'+(_0xaddec[_0x217821(0x2e8)]()+0x1)[_0x217821(0x258)]()[_0x217821(0x245)](0x2,'0')+'/'+_0xaddec[_0x217821(0x119)]()[_0x217821(0x258)]()[_0x217821(0x245)](0x2,'0')+'\x20'+_0xaddec[_0x217821(0x30f)]()[_0x217821(0x258)]()[_0x217821(0x245)](0x2,'0')+':'+_0xaddec[_0x217821(0x224)]()['toString']()[_0x217821(0x245)](0x2,'0')+':'+_0xaddec[_0x217821(0x2e2)]()[_0x217821(0x258)]()[_0x217821(0x245)](0x2,'0');}function getTimeStamp(){const _0x3b138f=_0x3b8906,_0x3d00cb=shiftedTime();return _0x3d00cb[_0x3b138f(0x207)]()+'/'+(_0x3d00cb[_0x3b138f(0x2e8)]()+0x1)[_0x3b138f(0x258)]()['padStart'](0x2,'0')+'/'+_0x3d00cb[_0x3b138f(0x119)]()[_0x3b138f(0x258)]()[_0x3b138f(0x245)](0x2,'0')+'\x20'+_0x3d00cb[_0x3b138f(0x30f)]()[_0x3b138f(0x258)]()[_0x3b138f(0x245)](0x2,'0')+':'+_0x3d00cb[_0x3b138f(0x224)]()[_0x3b138f(0x258)]()['padStart'](0x2,'0')+':'+_0x3d00cb[_0x3b138f(0x2e2)]()[_0x3b138f(0x258)]()[_0x3b138f(0x245)](0x2,'0');}function getCleanTimeStamp(){const _0x29f67d=_0x3b8906,_0x589cc6=shiftedTime();return _0x589cc6[_0x29f67d(0x207)]()+(_0x589cc6[_0x29f67d(0x2e8)]()+0x1)['toString']()['padStart'](0x2,'0')+_0x589cc6[_0x29f67d(0x119)]()[_0x29f67d(0x258)]()['padStart'](0x2,'0')+'-'+_0x589cc6[_0x29f67d(0x30f)]()[_0x29f67d(0x258)]()[_0x29f67d(0x245)](0x2,'0')+_0x589cc6['getMinutes']()[_0x29f67d(0x258)]()['padStart'](0x2,'0')+_0x589cc6[_0x29f67d(0x2e2)]()[_0x29f67d(0x258)]()[_0x29f67d(0x245)](0x2,'0');}function shiftedTime(){const _0x473c03=_0x3b8906,_0xe6647=new Date();let _0x5b3ff7=_0xe6647;if(settings[_0x473c03(0x147)]&&settings[_0x473c03(0x147)]!==0x0)_0x5b3ff7=fns[_0x473c03(0x277)](_0xe6647,{'hours':settings[_0x473c03(0x147)]});return _0x5b3ff7;}function startScheduler(){const _0xbe87ba=_0x3b8906,_0x3b0281=new Date()[_0xbe87ba(0x1ce)](),_0x31c7b8=shiftedTime()['getHours']();_0x31c7b8==0x4&&backupConfigFiles();_0x31c7b8==0x0&&rotateLogFiles();_0x3b0281%0x6==0x0&&triggerAnalytics();_0x3b0281%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x433f16){const _0x5399bf=_0x3b8906;logger[_0x5399bf(0x1c6)](_0x5399bf(0x1db)+_0x433f16);const _0x271c51=getBotsWithMode();_0x271c51[_0x5399bf(0x180)]>0x0?confirmRestore(configbackuppath,_0x433f16):unzipFile(configbackuppath,_0x433f16);}async function getBackupFiles(_0x3e4691=null){const _0x590a2b=_0x3b8906;let _0x11dbed=[],_0x3187ec=fs[_0x590a2b(0x15e)](configbackuppath,{'withFileTypes':!![]});_0x3187ec[_0x590a2b(0x2ee)]((_0x462141,_0x9a37a3)=>_0x462141[_0x590a2b(0x149)]<_0x9a37a3['name']?0x1:_0x9a37a3[_0x590a2b(0x149)]<_0x462141['name']?-0x1:0x0),_0x3187ec['forEach'](_0x3029d8=>{const _0x3e2009=_0x590a2b;if(!_0x3029d8[_0x3e2009(0x20d)]()&&_0x3029d8[_0x3e2009(0x149)][_0x3e2009(0x22e)](_0x3e2009(0x2cc))&&_0x3029d8[_0x3e2009(0x149)]['endsWith'](_0x3e2009(0x1ba))){const _0x37a5fd=formatDate(fs[_0x3e2009(0x252)](configbackuppath+_0x3029d8[_0x3e2009(0x149)])[_0x3e2009(0x136)]);_0x11dbed['push']({'name':_0x3029d8[_0x3e2009(0x149)],'mtime':_0x37a5fd});}});if(_0x3e4691)io['to'](_0x3e4691)['emit'](_0x590a2b(0x2ba),_0x11dbed);else return _0x11dbed;}async function backupConfigFiles(){const _0x545202=_0x3b8906;await zipFiles(_0x545202(0x297));const _0x36ef65=getCleanTimeStamp();fs[_0x545202(0x2f3)](zippath+_0x545202(0x12a),configbackuppath+(_0x545202(0x2cc)+_0x36ef65+'.zip'));let _0x38f7f6=fs[_0x545202(0x15e)](configbackuppath,{'withFileTypes':!![]});_0x38f7f6['sort']((_0x2559a5,_0x2afcd4)=>_0x2559a5[_0x545202(0x149)]<_0x2afcd4[_0x545202(0x149)]?0x1:_0x2afcd4[_0x545202(0x149)]<_0x2559a5[_0x545202(0x149)]?-0x1:0x0),_0x38f7f6[_0x545202(0x180)]>maxBackups&&fs[_0x545202(0x2dd)](configbackuppath+_0x38f7f6[_0x38f7f6[_0x545202(0x180)]-0x1]['name']);}function rotateLogFiles(){const _0x255096=_0x3b8906,_0x53774d=fs[_0x255096(0x252)](logspath+_0x255096(0x185)),_0x4a2ace=_0x53774d[_0x255096(0x135)]/0x400;if(_0x4a2ace>0x64){let _0x173a06=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x173a06[_0x255096(0x2ee)]((_0x4f4451,_0x400654)=>_0x4f4451[_0x255096(0x149)]<_0x400654[_0x255096(0x149)]?0x1:_0x400654[_0x255096(0x149)]<_0x4f4451[_0x255096(0x149)]?-0x1:0x0),_0x173a06[_0x255096(0x193)](_0x34b03e=>{const _0x5114b3=_0x255096;if(_0x34b03e['name']=='output-002.log')fs[_0x5114b3(0x2f3)](logspath+_0x34b03e[_0x5114b3(0x149)],logspath+'output-003.log');if(_0x34b03e[_0x5114b3(0x149)]=='output-001.log')fs[_0x5114b3(0x2f3)](logspath+_0x34b03e[_0x5114b3(0x149)],logspath+_0x5114b3(0x213));_0x34b03e[_0x5114b3(0x149)]==_0x5114b3(0x185)&&(fs['copyFileSync'](logspath+_0x34b03e['name'],logspath+_0x5114b3(0x1f7)),fs[_0x5114b3(0x199)](logspath+_0x34b03e[_0x5114b3(0x149)],''));});}}async function zipFiles(_0x2f560a){const _0x212ed8=_0x3b8906;let _0x1a873b;if(_0x2f560a==_0x212ed8(0x2ca))_0x1a873b=logspath;if(_0x2f560a==_0x212ed8(0x1f3))_0x1a873b=configpath;if(_0x2f560a==_0x212ed8(0x297))_0x1a873b=configpath;let _0x5b20bc=fs[_0x212ed8(0x15e)](_0x1a873b,{'withFileTypes':!![]});const _0x2d2972=new require(_0x212ed8(0x16c))();_0x5b20bc['forEach'](_0x9b66ca=>{const _0x168e38=_0x212ed8;if(!_0x9b66ca[_0x168e38(0x20d)]()){let _0x32a0ac=fs[_0x168e38(0x1d3)](_0x1a873b+_0x9b66ca[_0x168e38(0x149)]);if(_0x2f560a==_0x168e38(0x1f3)){const _0x12a835=/^bot-[0-9]{3}-config.json$/,_0x78da4=_0x12a835[_0x168e38(0x113)](_0x9b66ca[_0x168e38(0x149)]);if(_0x78da4){const _0x5d1b3d=JSON['parse'](_0x32a0ac);if(_0x5d1b3d[_0x168e38(0x1bd)][0x0]){_0x5d1b3d['bot'][0x0][_0x168e38(0x29e)]=_0x168e38(0x1ee),_0x5d1b3d[_0x168e38(0x1bd)][0x0][_0x168e38(0x1c0)]='***';if(_0x5d1b3d[_0x168e38(0x1bd)][0x0][_0x168e38(0x191)])_0x5d1b3d[_0x168e38(0x1bd)][0x0][_0x168e38(0x191)]=_0x168e38(0x1ee);}_0x32a0ac=JSON['stringify'](_0x5d1b3d,null,0x2);}if(_0x9b66ca['name']==_0x168e38(0x272)){const _0x1df01f=JSON[_0x168e38(0x301)](_0x32a0ac);if(_0x1df01f[_0x168e38(0x304)]['loginRequired'])_0x1df01f['settings'][_0x168e38(0x283)]=![];if(_0x1df01f['settings'][_0x168e38(0x263)])_0x1df01f['settings'][_0x168e38(0x263)]=_0x168e38(0x1ee);if(_0x1df01f['settings'][_0x168e38(0x1cc)])_0x1df01f[_0x168e38(0x304)][_0x168e38(0x1cc)]=_0x168e38(0x1ee);if(_0x1df01f[_0x168e38(0x304)][_0x168e38(0x28f)])_0x1df01f['settings']['telegramChatId']=null;if(_0x1df01f[_0x168e38(0x304)][_0x168e38(0x201)])_0x1df01f[_0x168e38(0x304)][_0x168e38(0x201)]=_0x168e38(0x1ee);_0x32a0ac=JSON[_0x168e38(0x1dd)](_0x1df01f,null,0x2);}if(_0x9b66ca['name']!='bb-secure.json')_0x2d2972[_0x168e38(0x1f0)](_0x9b66ca[_0x168e38(0x149)],_0x32a0ac);}else _0x2d2972[_0x168e38(0x1f0)](_0x9b66ca[_0x168e38(0x149)],_0x32a0ac);}});const _0x2d133d=_0x2d2972[_0x212ed8(0x12c)]({'base64':![],'compression':_0x212ed8(0x310)});fs[_0x212ed8(0x199)](zippath+(_0x2f560a+'.zip'),_0x2d133d,_0x212ed8(0x12b));}async function unzipFile(_0x4b6f0c,_0x77de2e){const _0x2d2ae1=_0x3b8906;fs[_0x2d2ae1(0x15e)](configpath,{'withFileTypes':!![]})['forEach'](_0xb5afc0=>{const _0xf6997a=_0x2d2ae1;if(!_0xb5afc0['isDirectory']())fs[_0xf6997a(0x223)](configpath+_0xb5afc0[_0xf6997a(0x149)]);});const _0x4621cc=fs[_0x2d2ae1(0x1d3)](_0x4b6f0c+_0x77de2e,_0x2d2ae1(0x12b)),_0x2f5b9d=new require(_0x2d2ae1(0x16c))(_0x4621cc,{'base64':![],'checkCRC32':!![]});Object[_0x2d2ae1(0x159)](_0x2f5b9d[_0x2d2ae1(0x141)])[_0x2d2ae1(0x193)](_0x496b93=>{const _0x28219d=_0x2d2ae1,_0x532100=_0x2f5b9d[_0x28219d(0x141)][_0x496b93];fs[_0x28219d(0x199)](configpath+_0x532100[_0x28219d(0x149)],_0x532100['_data']);}),fs[_0x2d2ae1(0x15e)](temppath,{'withFileTypes':!![]})['forEach'](_0x402335=>{const _0x5aff61=_0x2d2ae1;if(!_0x402335[_0x5aff61(0x20d)]())fs[_0x5aff61(0x223)](temppath+_0x402335[_0x5aff61(0x149)]);}),logger[_0x2d2ae1(0x1c6)](_0x2d2ae1(0x116)),process[_0x2d2ae1(0x29a)]({'restore':!![]},_0x2f0e13=>{});}async function getPublicIp(){const _0x74523f=_0x3b8906;try{const _0x34ebc0=await axios[_0x74523f(0x1b8)]('https://api.ipify.org?format=json');publicip=_0x34ebc0[_0x74523f(0x255)]['ip'];}catch(_0x3c6e7c){}}async function triggerAnalytics(){const _0x201105=_0x3b8906;if(!publicip)await getPublicIp();const _0x136d14=getBotsWithMode();let _0x18accf=0x0;_0x136d14[_0x201105(0x193)](_0x11ab57=>{const _0x47e90d=_0x201105;if(_0x11ab57[_0x47e90d(0x13a)]==='enabled')_0x18accf++;});const _0x411e03=getBotExchanges();mixpanel[_0x201105(0x242)]('Server',{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x136d14[_0x201105(0x180)],'numbotsenabled':_0x18accf,'exchanges':_0x411e03,'environment':environment});}async function getMessages(){const _0x4d2ff6=_0x3b8906,_0x20dcae=_0x4d2ff6(0x139),_0x5c0b52=new GraphQLClient(_0x20dcae),_0x2bbd99={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x2d91bd=serverversion[_0x4d2ff6(0x13c)]('.'),_0x5d7e37=_0x2d91bd[0x0]+'.'+_0x2d91bd[0x1],_0x5bf6a4=Math[_0x4d2ff6(0x225)](settings[_0x4d2ff6(0x2e4)],settings[_0x4d2ff6(0x254)]),_0x365e5c={'last':parseInt(_0x5bf6a4),'bbm':_0x5d7e37},_0x4dbe1b=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4f01e9;try{_0x4f01e9=await _0x5c0b52[_0x4d2ff6(0x202)](_0x4dbe1b,_0x365e5c,_0x2bbd99);}catch(_0x4f197f){}if(_0x4f01e9&&_0x4f01e9[_0x4d2ff6(0x2b1)]){let _0x53ac7b=settings[_0x4d2ff6(0x2e4)];newMessages=[];for(const _0x19cba4 of _0x4f01e9[_0x4d2ff6(0x2b1)]){newMessages[_0x4d2ff6(0x1c2)](_0x19cba4);let _0x585eb3=![];_0x19cba4[_0x4d2ff6(0x1c5)]&&(updateSetting(_0x4d2ff6(0x124),_0x19cba4[_0x4d2ff6(0x1c5)]),_0x585eb3=isNewerVersion(serverversion,_0x19cba4[_0x4d2ff6(0x1c5)])||serverversion==_0x19cba4[_0x4d2ff6(0x1c5)]);if(!_0x585eb3&&_0x19cba4['number']>_0x53ac7b){if(_0x19cba4[_0x4d2ff6(0x11c)]===_0x4d2ff6(0x2b6)||serverversion[_0x4d2ff6(0x22e)](_0x19cba4[_0x4d2ff6(0x11c)])){let _0xbbc26a=''+_0x19cba4[_0x4d2ff6(0x2ed)]+'\x0a\x0a'+_0x19cba4[_0x4d2ff6(0x1e6)];const _0x26b532=await sendTelegramMsg(toTelegramMarkdown(_0xbbc26a),_0x4d2ff6(0x13d));if(_0x26b532)_0x53ac7b=_0x19cba4[_0x4d2ff6(0x246)];}}}updateAvailable=isNewerVersion(settings[_0x4d2ff6(0x124)],serverversion),updateSetting(_0x4d2ff6(0x2e4),_0x53ac7b),emitMessages();}}function emitMessages(){const _0x417a17=_0x3b8906,_0x59f847=settings[_0x417a17(0x254)];let _0x4825ba=[];newMessages[_0x417a17(0x193)](_0x173798=>{const _0x37c80d=_0x417a17;_0x173798[_0x37c80d(0x246)]>_0x59f847&&_0x4825ba['push'](_0x173798);}),_0x4825ba[_0x417a17(0x180)]>0x0&&getAllClients()[_0x417a17(0x193)](_0x3fb0ae=>{const _0x37fb82=_0x417a17;getSocket(_0x3fb0ae['id'])[_0x37fb82(0x19e)]('message',_0x4825ba);});}function confirmMessage(_0x3f81c2){updateSetting('lastmsgemitted',Number(_0x3f81c2));}function isNewerVersion(_0x255782,_0x43d662){const _0x47fbe7=_0x3b8906,_0x3316d2=_0x43d662[_0x47fbe7(0x13c)]('.'),_0x51f463=_0x255782['split']('.');for(var _0x42633c=0x0;_0x42633c<_0x51f463[_0x47fbe7(0x180)];_0x42633c++){const _0x10d64d=~~_0x51f463[_0x42633c],_0x16ee68=~~_0x3316d2[_0x42633c];if(_0x10d64d>_0x16ee68)return!![];if(_0x10d64d<_0x16ee68)return![];}return![];}function toTelegramMarkdown(_0x345808){const _0x177182=_0x3b8906,_0x6ddaef=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0xf8697b=/\*{2}(.+?)\*{2}/gim;return _0x345808=_0x345808['replace'](_0x6ddaef,_0x177182(0x117))[_0x177182(0x166)](_0xf8697b,_0x177182(0x156)),_0x345808;}async function validateConfigFile(){const _0x47d1f2=_0x3b8906,_0x3ceb14=dbConfig[_0x47d1f2(0x1b8)](_0x47d1f2(0x2fd))[_0x47d1f2(0x132)](_0x47d1f2(0x2aa))[_0x47d1f2(0x2f1)]()||[];if(_0x3ceb14[_0x47d1f2(0x180)]==0x0){let _0x1bf6f8=0x0,_0x4674c3=[];const _0x5ba0b9=/^bot-([0-9]{3})-config.json$/,_0x26483e=fs[_0x47d1f2(0x15e)](configpath);_0x26483e['forEach'](_0x47db20=>{const _0x5c0b0a=_0x47d1f2,_0x1712a3=_0x5ba0b9[_0x5c0b0a(0x1e5)](_0x47db20);if(_0x1712a3){const _0x1d16fa=_0x1712a3[0x1];let _0x2d1688=getBotAttributes(_0x1d16fa);_0x4674c3[_0x5c0b0a(0x1c2)]({'botID':_0x1d16fa,'botname':_0x2d1688[_0x5c0b0a(0x31a)],'status':_0x5c0b0a(0x308),'live':_0x5c0b0a(0x177)}),_0x1bf6f8++;}}),_0x1bf6f8!=0x0&&(dbConfig['get'](_0x47d1f2(0x2fd))['assign'](_0x4674c3)['write'](),config=_0x4674c3,restoredConfigFile=_0x1bf6f8);}}async function restoreConfigNotify(_0x58fbeb){const _0x72e0eb=_0x3b8906;let _0x10f0b6;if(restoredConfigFile==0x1)_0x10f0b6='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x10f0b6=_0x72e0eb(0x128);if(_0x58fbeb)io['to'](_0x72e0eb(0x1ae))['emit'](_0x72e0eb(0x2eb),_0x10f0b6);else{logger[_0x72e0eb(0x2a5)](_0x72e0eb(0x1a2)),logger[_0x72e0eb(0x2a5)](_0x10f0b6),logger[_0x72e0eb(0x2a5)](_0x72e0eb(0x1a2)),logger['simple']('');if(tgBot&&settings[_0x72e0eb(0x28f)]&&settings[_0x72e0eb(0x167)]!=_0x72e0eb(0x21f))await sendTelegram(settings[_0x72e0eb(0x28f)],_0x72e0eb(0x2e1)+_0x10f0b6);}}function validateCredentials(_0x2719c4,_0x3f2464){const _0x127d81=_0x3b8906;if(_0x2719c4['username']==settings[_0x127d81(0x178)]&&bcrypt['compareSync'](_0x2719c4[_0x127d81(0x2ff)],settings[_0x127d81(0x263)])){if(settings[_0x127d81(0x2d8)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x56f718=generateLoginToken(_0x3f2464);return{'allow':!![],'reason':_0x127d81(0x171),'token':_0x56f718};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x34980d){const _0x59ad39=generateLoginToken(_0x34980d);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x59ad39};}function validateAccess(_0x21247d,_0x1ca6d4,_0x16ced8){const _0x5b7673=_0x3b8906,_0x12fa4a=_0x16ced8?_0x16ced8:devices[_0x1ca6d4]['ip'];let _0xcf7479;const _0x44eb54=_0x5dea5a=>{const _0xd5b6ad=_0xd7e6;if(settings['loginRequired']){if(settings[_0xd5b6ad(0x2d8)]){if(telegram2FaApproved(_0x1ca6d4)){const _0xc25853=generateLoginToken(_0x1ca6d4);return{'allow':!![],'reason':_0xd5b6ad(0x22b),'token':_0xc25853};}else return{'allow':![],'reason':_0xd5b6ad(0x1e8),'token':null};}else return _0xcf7479=validToken(_0x5dea5a,_0x1ca6d4),_0xcf7479[_0xd5b6ad(0x152)](_0xd5b6ad(0x2e0))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x5dea5a}:{'allow':![],'reason':_0xd5b6ad(0x1e8),'token':null};}else return{'allow':!![],'reason':_0xd5b6ad(0x1d8),'token':null};};if(settings[_0x5b7673(0x13e)]){let _0x3d471e=[...settings[_0x5b7673(0x11e)],_0x5b7673(0x1c3),_0x5b7673(0x1af),_0x5b7673(0x29d)];if(_0x3d471e[_0x5b7673(0x270)](_0x12fa4a))return _0x44eb54(_0x21247d);else{_0xcf7479=validToken(_0x21247d,_0x1ca6d4);if(_0xcf7479['hasOwnProperty'](_0x5b7673(0x2e0)))return _0x44eb54(_0x21247d);else{if(telegramIpApproved(_0x1ca6d4)){const _0x42cafe=generateToken(_0x1ca6d4);return _0xcf7479=_0x44eb54(_0x21247d),_0xcf7479[_0x5b7673(0x148)]?{'allow':!![],'reason':_0x5b7673(0x220),'token':_0x42cafe}:_0xcf7479;}else return settings[_0x5b7673(0x2f7)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x5b7673(0x150),'token':null};}}}else return _0x44eb54(_0x21247d);}function timelyDecrypt(_0x2b13c3,_0x270938,_0x597ece='@'){const _0x4d20ce=_0x3b8906;if(_0x2b13c3)try{const _0x15a5cb=crypt['decrypt'](secure[_0x4d20ce(0x2d3)],_0x2b13c3)[_0x4d20ce(0x1e6)],_0x1efc97=_0x15a5cb[_0x4d20ce(0x13c)](_0x597ece)[0x0],_0x24a5fb=_0x15a5cb[_0x4d20ce(0x13c)](_0x597ece)[0x1],_0x36c79f=new Date()['getTime']();if(_0x270938){if(_0x36c79f-_0x24a5fb<maxSecretAge*0x3e8)return _0x1efc97;else return![];}else return _0x1efc97;}catch(_0x25b481){return![];}else return![];}const validToken=(_0x3bd8fc,_0xaf9006)=>{const _0x2fe1d7=_0x3b8906,_0x1ca2cd=devices[_0xaf9006]['ip'];if(!_0x3bd8fc)return{'error':'No\x20authentication\x20token'};for(let _0x24c425 of blacklist){if(_0x24c425[_0x2fe1d7(0x2cd)]==_0x3bd8fc)return{'error':'Token\x20blacklisted'};}let _0x27c632;try{_0x27c632=jwt[_0x2fe1d7(0x196)](_0x3bd8fc,secure[_0x2fe1d7(0x2fc)]+_0xaf9006);}catch{return{'error':_0x2fe1d7(0x30a)};}if(!_0x27c632[_0x2fe1d7(0x152)](_0x2fe1d7(0x120))&&!_0x27c632[_0x2fe1d7(0x152)](_0x2fe1d7(0x319))||!_0x27c632['hasOwnProperty'](_0x2fe1d7(0x211)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x27c632[_0x2fe1d7(0x152)](_0x2fe1d7(0x319))&&_0x27c632[_0x2fe1d7(0x152)](_0x2fe1d7(0x120))){const {clientip:_0x6551ff}=_0x27c632;return _0x1ca2cd==_0x6551ff?{'success':_0x2fe1d7(0x25d)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x27c632['hasOwnProperty'](_0x2fe1d7(0x319))&&_0x27c632[_0x2fe1d7(0x152)](_0x2fe1d7(0x120))){const {username:_0x171739,clientip:_0x462008}=_0x27c632;return settings[_0x2fe1d7(0x178)]==_0x171739&&_0x1ca2cd==_0x462008?{'success':_0x2fe1d7(0x25d)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x350e9d=>{const _0x4bb67b=_0x3b8906;if(_0x350e9d){const _0x5a5c6e=devices[_0x350e9d]['ip'];return jwt[_0x4bb67b(0x2a2)]({'username':settings[_0x4bb67b(0x178)],'clientip':_0x5a5c6e},secure[_0x4bb67b(0x2fc)]+_0x350e9d,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x373532=>{const _0x437893=_0x3b8906;if(_0x373532){const _0x3892d9=devices[_0x373532]['ip'];return jwt['sign']({'clientip':_0x3892d9},secure[_0x437893(0x2fc)]+_0x373532,{'expiresIn':devices[_0x373532][_0x437893(0x15b)][_0x437893(0x1cd)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x59dffb=>{const _0x4e16bd=_0x3b8906;let _0x34e834=![];return devices[_0x59dffb][_0x4e16bd(0x15b)]&&devices[_0x59dffb]['telegramIpApproval'][_0x4e16bd(0x1cd)]!=_0x4e16bd(0x1f2)&&(_0x34e834=devices[_0x59dffb]['telegramIpApproval'][_0x4e16bd(0x120)]==devices[_0x59dffb]['ip']&&new Date()[_0x4e16bd(0x1de)]()-devices[_0x59dffb][_0x4e16bd(0x15b)]['timestamp']<devices[_0x59dffb][_0x4e16bd(0x15b)][_0x4e16bd(0x1cd)]*0x3c*0x3e8),_0x34e834;},telegram2FaApproved=_0x2c3645=>{const _0x29add0=_0x3b8906;let _0x5101d7=![];return devices[_0x2c3645][_0x29add0(0x1d7)]&&devices[_0x2c3645][_0x29add0(0x1d7)]['expiry']!=_0x29add0(0x1f2)&&(_0x5101d7=devices[_0x2c3645][_0x29add0(0x1d7)][_0x29add0(0x120)]==devices[_0x2c3645]['ip']&&new Date()[_0x29add0(0x1de)]()-devices[_0x2c3645][_0x29add0(0x1d7)][_0x29add0(0x15a)]<devices[_0x2c3645][_0x29add0(0x1d7)][_0x29add0(0x1cd)]*0x3c*0x3e8),_0x5101d7;},normalizeIP=_0x23317d=>{const _0xdcf106=_0x3b8906;let _0x358695=null,_0x2163e7=null;if(ipaddr[_0xdcf106(0x19a)](_0x23317d)){const _0x1070c6=ipaddr[_0xdcf106(0x301)](_0x23317d);_0x1070c6[_0xdcf106(0x2d6)]()===_0xdcf106(0x2fb)?(_0x1070c6[_0xdcf106(0x1bc)]()&&(_0x358695=_0x1070c6[_0xdcf106(0x123)]()[_0xdcf106(0x258)]()),_0x2163e7=_0x1070c6['toString']()):(_0x358695=_0x1070c6[_0xdcf106(0x258)](),_0x2163e7=_0x1070c6[_0xdcf106(0x16a)]()[_0xdcf106(0x258)]());}return{'show':_0x358695?_0x358695:_0x2163e7,'store':_0x2163e7};};function formatDate(_0x463d24){const _0x4df9a9=_0x3b8906;return _0x463d24[_0x4df9a9(0x207)]()+'/'+(_0x463d24[_0x4df9a9(0x2e8)]()+0x1)[_0x4df9a9(0x258)]()[_0x4df9a9(0x245)](0x2,'0')+'/'+_0x463d24[_0x4df9a9(0x119)]()[_0x4df9a9(0x258)]()[_0x4df9a9(0x245)](0x2,'0')+'\x20'+_0x463d24[_0x4df9a9(0x30f)]()[_0x4df9a9(0x258)]()[_0x4df9a9(0x245)](0x2,'0')+':'+_0x463d24['getMinutes']()['toString']()[_0x4df9a9(0x245)](0x2,'0')+':'+_0x463d24['getSeconds']()[_0x4df9a9(0x258)]()[_0x4df9a9(0x245)](0x2,'0');}function sleep(_0xd0880f){return new Promise(_0x5c9b88=>setTimeout(_0x5c9b88,_0xd0880f));}