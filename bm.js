const _0xfbfeb9=_0x2b31;(function(_0x3e8f2e,_0x2545f6){const _0x3c19ea=_0x2b31,_0x4bf110=_0x3e8f2e();while(!![]){try{const _0x43cc66=-parseInt(_0x3c19ea(0x163))/0x1+parseInt(_0x3c19ea(0x273))/0x2*(-parseInt(_0x3c19ea(0x18d))/0x3)+-parseInt(_0x3c19ea(0x257))/0x4*(-parseInt(_0x3c19ea(0x2ab))/0x5)+parseInt(_0x3c19ea(0x20c))/0x6*(-parseInt(_0x3c19ea(0x1cf))/0x7)+parseInt(_0x3c19ea(0x11f))/0x8+-parseInt(_0x3c19ea(0x1fb))/0x9+parseInt(_0x3c19ea(0x19d))/0xa*(parseInt(_0x3c19ea(0x2c8))/0xb);if(_0x43cc66===_0x2545f6)break;else _0x4bf110['push'](_0x4bf110['shift']());}catch(_0x425696){_0x4bf110['push'](_0x4bf110['shift']());}}}(_0x488a,0x1a133));const _0x555b06=function(){let _0x291bc2=!![];return function(_0x376eaf,_0x18bd45){const _0x4fd3b5=_0x291bc2?function(){const _0x936fb3=_0x2b31;if(_0x18bd45){const _0x57882b=_0x18bd45[_0x936fb3(0x2b6)](_0x376eaf,arguments);return _0x18bd45=null,_0x57882b;}}:function(){};return _0x291bc2=![],_0x4fd3b5;};}(),_0x5b169b=_0x555b06(this,function(){const _0x1da8b2=_0x2b31;return _0x5b169b[_0x1da8b2(0x11a)]()[_0x1da8b2(0x289)]('(((.+)+)+)+$')[_0x1da8b2(0x11a)]()['constructor'](_0x5b169b)[_0x1da8b2(0x289)](_0x1da8b2(0x295));});_0x5b169b();'use strict';process['env'][_0xfbfeb9(0x28a)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require('date-fns'),low=require(_0xfbfeb9(0x133)),FileSync=require(_0xfbfeb9(0x197)),path=require(_0xfbfeb9(0x240)),crypto=require('crypto'),Crypt=require(_0xfbfeb9(0x15c))['Crypt'],RSA=require(_0xfbfeb9(0x15c))[_0xfbfeb9(0x285)],bcrypt=require(_0xfbfeb9(0x2e5)),jwt=require(_0xfbfeb9(0xec)),ipaddr=require(_0xfbfeb9(0x1ea)),argv=require(_0xfbfeb9(0x1e4))(process[_0xfbfeb9(0x1d4)][_0xfbfeb9(0x2cb)](0x2))[_0xfbfeb9(0x1d4)],uuidRandom=require(_0xfbfeb9(0x29e)),{Telegraf,Markup}=require(_0xfbfeb9(0x19c)),Mixpanel=require('mixpanel'),axios=require(_0xfbfeb9(0x29f)),{GraphQLClient,gql}=require(_0xfbfeb9(0xee)),util=require(_0xfbfeb9(0xfe)),fileUpload=require(_0xfbfeb9(0x275)),{networkInterfaces}=require('os'),PORT=argv[_0xfbfeb9(0x210)]||_0xfbfeb9(0x2cd),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0xfbfeb9(0x182)](_0xfbfeb9(0x228)+PORT+_0xfbfeb9(0x1c3)),process[_0xfbfeb9(0x16c)](0x1));const HOST=argv[_0xfbfeb9(0x19f)]||null,userID=argv[_0xfbfeb9(0x219)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0xfbfeb9(0x2e2)];let bbpath=_0xfbfeb9(0x276),bbpath2='';const botfile=_0xfbfeb9(0x114),configfile='bb-config.json',settingsfile=_0xfbfeb9(0x108),securefile='bb-secure.json',environment=require('./'+bbpath2+_0xfbfeb9(0x204))[_0xfbfeb9(0x2dc)]||_0xfbfeb9(0x162),maxBackups=0xa;let validInstallation=!![];!fs[_0xfbfeb9(0x281)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0xfbfeb9(0x1b9)),configpath=userID?bbpath+_0xfbfeb9(0x1b8)+userID+'/':bbpath+_0xfbfeb9(0x1b8),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0xfbfeb9(0x2d6)+userID+'/':bbpath+_0xfbfeb9(0x2d6),zippath=userID?bbpath+_0xfbfeb9(0x27c)+userID+'/':bbpath+_0xfbfeb9(0x27c),loggerfile=fs[_0xfbfeb9(0x217)](logspath+_0xfbfeb9(0x1c8),{'flags':'a'}),temppath=userID?bbpath+_0xfbfeb9(0x21d)+userID+'/':bbpath+_0xfbfeb9(0x21d);!fs[_0xfbfeb9(0x281)](configpath)&&fs[_0xfbfeb9(0x18c)](configpath);!fs[_0xfbfeb9(0x281)](configbackuppath)&&fs[_0xfbfeb9(0x18c)](configbackuppath);!fs[_0xfbfeb9(0x281)](logspath)&&fs[_0xfbfeb9(0x18c)](logspath);!fs[_0xfbfeb9(0x281)](zippath)&&fs[_0xfbfeb9(0x18c)](zippath);!fs[_0xfbfeb9(0x281)](temppath)&&fs[_0xfbfeb9(0x18c)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0xfbfeb9(0x15d)]({'bots':[]})[_0xfbfeb9(0x1d9)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0xfbfeb9(0x15d)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0xfbfeb9(0x196),'onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0xfbfeb9(0x15d)]({'secure':{},'blacklist':[]})[_0xfbfeb9(0x1d9)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0xfbfeb9(0x269)});const saltRounds=0xa,mixpanel=Mixpanel[_0xfbfeb9(0x24b)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0xfbfeb9(0x22d)]&&(settings[_0xfbfeb9(0x22d)]!=''&&settings[_0xfbfeb9(0x22d)]!=_0xfbfeb9(0x1ca))&&settings[_0xfbfeb9(0x2d2)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x2cfa03,_0x1ae8f2)=>{const _0x31e466=_0xfbfeb9,_0x1dd5e2=/#[A-Z]{3}#/g;if(typeof _0x2cfa03==_0x31e466(0x1ba)){!_0x1ae8f2?_0x2cfa03=_0x2cfa03['replace'](_0x1dd5e2,''):(_0x2cfa03=_0x2cfa03[_0x31e466(0x139)](/#BLU#/g,'\x1b[34m'),_0x2cfa03=_0x2cfa03['replace'](/#RED#/g,'\x1b[31m'),_0x2cfa03=_0x2cfa03[_0x31e466(0x139)](/#YEL#/g,_0x31e466(0x11e)),_0x2cfa03=_0x2cfa03[_0x31e466(0x139)](/#MAG#/g,_0x31e466(0x2b1)),_0x2cfa03=_0x2cfa03[_0x31e466(0x139)](/#CYA#/g,_0x31e466(0x2b7)),_0x2cfa03=_0x2cfa03[_0x31e466(0x139)](/#RES#/g,_0x31e466(0x2e6)));;}return _0x2cfa03;},logger={'screen':_0x1a7944=>{const _0x2e07ff=_0xfbfeb9;console[_0x2e07ff(0x182)](parseColor(_0x1a7944,!![]));},'simple':_0x2ce0f3=>{const _0x4aad11=_0xfbfeb9;console[_0x4aad11(0x182)](parseColor(_0x2ce0f3,!![])),loggerfile[_0x4aad11(0x1d9)](util[_0x4aad11(0x17c)](parseColor(_0x2ce0f3,![]))+'\x0a');},'full':async _0xf4e70a=>{const _0x2dda70=_0xfbfeb9,_0x3c7d5f=getTimeStamp()+_0x2dda70(0xf0)+_0xf4e70a;console[_0x2dda70(0x182)](parseColor(_0x3c7d5f,!![])),loggerfile[_0x2dda70(0x1d9)](util[_0x2dda70(0x17c)](parseColor(_0x3c7d5f,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x2dda70(0x224)]!=_0x2dda70(0x29a))await sendTelegram(settings['telegramChatId'],_0x2dda70(0x1e1)+parseColor(_0xf4e70a,![]));},'debug':async(_0x23bb09,_0x456777='')=>{const _0x2cdaa8=_0xfbfeb9,_0x5dcae2=getTimeStamp()+_0x2cdaa8(0x1ee)+_0x23bb09;if(debugging)console[_0x2cdaa8(0x182)](parseColor(_0x5dcae2,!![]));loggerfile[_0x2cdaa8(0x1d9)](util[_0x2cdaa8(0x17c)](parseColor(_0x5dcae2,![]))+'\x0a');if(_0x456777){if(debugging)console[_0x2cdaa8(0x182)](_0x456777);loggerfile[_0x2cdaa8(0x1d9)](util[_0x2cdaa8(0x17c)](_0x456777)+'\x0a');}}};let terminating=![];process['on'](_0xfbfeb9(0x209),function(_0x1ebb6e){const _0x5eda48=_0xfbfeb9;logger[_0x5eda48(0x1e9)](_0x1ebb6e);}),process['on'](_0xfbfeb9(0x16c),()=>{stopAllBots();}),process['on'](_0xfbfeb9(0x151),()=>{stopAllBots();});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0xfbfeb9(0x1f3)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0xfbfeb9(0x252)),app=express(),http=require(_0xfbfeb9(0x2de))[_0xfbfeb9(0x1c9)](app);app[_0xfbfeb9(0x2c6)](fileUpload({'useTempFiles':!![]})),app[_0xfbfeb9(0xf3)](_0xfbfeb9(0x1ff),async(_0x44b685,_0x22bf59)=>{const _0x3f2eb6=_0xfbfeb9,_0xc4534f=_0x44b685[_0x3f2eb6(0x234)]['type'],_0x355c4a=getClientsWithBotID(_0x3f2eb6(0x1b7)),_0x212dfc=_0x44b685['headers'][_0x3f2eb6(0x1bc)],_0x2a02b7=timelyDecrypt(_0x212dfc,![]),_0x4a32cd=_0x355c4a['find'](_0x59ae94=>_0x59ae94[_0x3f2eb6(0x1bc)]==_0x2a02b7);if(_0x4a32cd){const _0x35c289=normalizeIP(_0x44b685['socket'][_0x3f2eb6(0x216)])[_0x3f2eb6(0x20a)],_0xecb31=_0x44b685['headers'][_0x3f2eb6(0x250)];if(validateAccess(_0xecb31,_0x2a02b7,_0x35c289)[_0x3f2eb6(0x23d)])_0xc4534f==_0x3f2eb6(0x136)&&await backupConfigFiles(),await zipFiles(_0xc4534f),_0x22bf59[_0x3f2eb6(0x27f)](zippath+(_0xc4534f+_0x3f2eb6(0x1c4)),_0xe2f3a1=>{const _0x210e23=_0x3f2eb6;_0xe2f3a1&&(logger[_0x210e23(0x245)]('Failed\x20to\x20download\x20'+_0xc4534f),logger[_0x210e23(0x1e9)](_0xe2f3a1));});else logger[_0x3f2eb6(0x245)](_0x3f2eb6(0x211)+_0xc4534f+_0x3f2eb6(0x278));}else logger[_0x3f2eb6(0x245)](_0x3f2eb6(0x211)+_0xc4534f+'\x20(2)');}),app[_0xfbfeb9(0x2a3)](_0xfbfeb9(0x138),async(_0x54fada,_0x3ef2fe)=>{const _0x2d7c00=_0xfbfeb9,_0x4f53dc=getClientsWithBotID('botmanager'),_0x28b0cd=_0x54fada['headers'][_0x2d7c00(0x1bc)],_0x1c2a5e=timelyDecrypt(_0x28b0cd,![]),_0x5afcf7=_0x4f53dc[_0x2d7c00(0x153)](_0x3277ef=>_0x3277ef[_0x2d7c00(0x1bc)]==_0x1c2a5e);logger[_0x2d7c00(0x2c4)]('Backup\x20file\x20uploaded');if(_0x5afcf7){const _0x177b71=normalizeIP(_0x54fada['socket'][_0x2d7c00(0x216)])[_0x2d7c00(0x20a)],_0x23d490=_0x54fada['headers']['tkn'];if(validateAccess(_0x23d490,_0x1c2a5e,_0x177b71)[_0x2d7c00(0x23d)]){if(_0x54fada[_0x2d7c00(0x284)]){const _0x530571=_0x54fada[_0x2d7c00(0x284)][_0x2d7c00(0xed)];await _0x530571['mv'](temppath+_0x530571[_0x2d7c00(0x2a2)]),_0x3ef2fe['send']({'status':!![],'message':_0x2d7c00(0x291)});const _0x561c10=getBotsWithMode();_0x561c10[_0x2d7c00(0x16f)]>0x0?confirmRestore(temppath,_0x530571[_0x2d7c00(0x2a2)]):unzipFile(temppath,_0x530571[_0x2d7c00(0x2a2)]);}}else logger[_0x2d7c00(0x245)](_0x2d7c00(0x2bc));}else logger[_0x2d7c00(0x245)](_0x2d7c00(0x2b4));}),app['use'](express[_0xfbfeb9(0x2cf)](path[_0xfbfeb9(0x147)](__dirname,bbpath2,_0xfbfeb9(0x10c)))),app[_0xfbfeb9(0x2c6)](express[_0xfbfeb9(0x2cf)](path[_0xfbfeb9(0x147)](__dirname,bbpath2,_0xfbfeb9(0x2c1)))),app[_0xfbfeb9(0xf3)]('/',function(_0x113dd7,_0x1f429c){const _0x5c5976=_0xfbfeb9;_0x1f429c[_0x5c5976(0x235)](path[_0x5c5976(0x147)](__dirname,bbpath2,'build2',_0x5c5976(0x2d1)));}),app['get']('/:bot',function(_0x25aaab,_0x5404b6){const _0x5ce9e=_0xfbfeb9;_0x5404b6[_0x5ce9e(0x235)](path[_0x5ce9e(0x147)](__dirname,bbpath2,_0x5ce9e(0x2c1),'index.html'));}),app['get'](_0xfbfeb9(0xf8),(_0x5cd33b,_0x43b741)=>{const _0x4b33be=_0xfbfeb9;_0x43b741[_0x4b33be(0x235)](path[_0x4b33be(0x147)](__dirname,bbpath2,_0x4b33be(0x2c1),_0x4b33be(0x2d1)));}),app['get'](_0xfbfeb9(0x232),(_0x31e7b9,_0x109e3d)=>{const _0x4c0452=_0xfbfeb9;_0x109e3d[_0x4c0452(0x235)](path[_0x4c0452(0x147)](__dirname,bbpath2,_0x4c0452(0x2c1),_0x4c0452(0x2d1)));}),app['get'](_0xfbfeb9(0x146),(_0x2c8998,_0x4a323c)=>{const _0x2d71be=_0xfbfeb9;_0x4a323c[_0x2d71be(0x235)](path[_0x2d71be(0x147)](__dirname,bbpath2,_0x2d71be(0x2c1),_0x2d71be(0x2d1)));}),app['get'](_0xfbfeb9(0x19b),(_0x530d51,_0x51f7f1)=>{const _0x213df4=_0xfbfeb9;_0x51f7f1[_0x213df4(0x235)](path[_0x213df4(0x147)](__dirname,bbpath2,'build',_0x213df4(0x2d1)));}),app[_0xfbfeb9(0xf3)](_0xfbfeb9(0x21e),(_0x23e834,_0x687d7d)=>{const _0x5ae99e=_0xfbfeb9;_0x687d7d[_0x5ae99e(0x235)](path[_0x5ae99e(0x147)](__dirname,bbpath2,_0x5ae99e(0x2c1),_0x5ae99e(0x2d1)));}),app[_0xfbfeb9(0xf3)](_0xfbfeb9(0x15b),(_0x152257,_0x593fae)=>{const _0x566764=_0xfbfeb9;_0x593fae[_0x566764(0x235)](path[_0x566764(0x147)](__dirname,bbpath2,_0x566764(0x2c1),'index.html'));});if(HOST)http[_0xfbfeb9(0x1f7)](PORT,HOST);else http['listen'](PORT);const io=require(_0xfbfeb9(0x1df))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0xbe2a96=_0xfbfeb9;let _0x5c6ff1=_0xbe2a96(0x26d);const _0x1f67ac=networkInterfaces(),_0x5b6827={};for(const _0x58bd8d of Object[_0xbe2a96(0x1a7)](_0x1f67ac)){for(const _0x54e6db of _0x1f67ac[_0x58bd8d]){if((_0x54e6db[_0xbe2a96(0x191)]==_0xbe2a96(0x14e)||_0x54e6db[_0xbe2a96(0x191)]==0x4)&&!_0x54e6db[_0xbe2a96(0x290)]){const _0x5aadcd=ipaddr['parse'](_0x54e6db['address'])['range']();_0x5aadcd!=_0xbe2a96(0x2a0)&&(!_0x5b6827[_0x58bd8d]&&(_0x5b6827[_0x58bd8d]=[]),_0x5b6827[_0x58bd8d][_0xbe2a96(0x161)](_0x54e6db['address']),_0x5c6ff1=_0x54e6db[_0xbe2a96(0x1c6)]);}}}return{'serverip':_0x5c6ff1,'netinterfaces':_0x5b6827};}async function startServer(){const _0x10fbda=_0xfbfeb9,{serverip:_0x3303fc,netinterfaces:_0xce66f4}=getServerIP();logger[_0x10fbda(0x1e9)](''),logger['simple'](_0x10fbda(0xfd)),await logger[_0x10fbda(0x245)](_0x10fbda(0x17b)+serverversion+_0x10fbda(0x1d2)+(environment==_0x10fbda(0x1d0)?'(staging)':'')+'\x0a'+(_0x10fbda(0x1f5)+PORT+_0x10fbda(0x1e0))+(_0x10fbda(0x1e8)+_0x3303fc+':'+PORT+_0x10fbda(0x1aa))),logger[_0x10fbda(0x1e9)](_0x10fbda(0xfd));if(config[_0x10fbda(0x16f)]!=0x0)for(const _0x5af8b9 of config){const _0x35dd9f=_0x5af8b9[_0x10fbda(0x1b5)]==_0x10fbda(0x239)?'a':'m';if(_0x5af8b9[_0x10fbda(0x2d0)]==_0x10fbda(0x15f)||_0x5af8b9[_0x10fbda(0x2d0)]==_0x10fbda(0x1cb))await logger['full'](_0x10fbda(0x15e)+_0x35dd9f+_0x10fbda(0x16a)+_0x5af8b9[_0x10fbda(0xfc)]+_0x10fbda(0x2be)+_0x5af8b9[_0x10fbda(0x268)]),startBot([_0x5af8b9[_0x10fbda(0xfc)],userID],{'cwd':bbpath},function(_0x216cda){if(_0x216cda)logger['full'](_0x216cda);});else(_0x5af8b9[_0x10fbda(0x2d0)]=='disabled'||_0x5af8b9[_0x10fbda(0x2d0)]==_0x10fbda(0x2b9))&&await logger[_0x10fbda(0x245)](_0x10fbda(0x202)+_0x35dd9f+_0x10fbda(0xf6)+_0x5af8b9[_0x10fbda(0xfc)]+_0x10fbda(0x2be)+_0x5af8b9[_0x10fbda(0x268)]);}else!newBot&&logger[_0x10fbda(0x1e9)](_0x10fbda(0x1f6));if(newBot)addBot();logger[_0x10fbda(0x1e9)](_0x10fbda(0xfd)),logger['simple'](''),await logger[_0x10fbda(0x2c4)](_0x10fbda(0x150)+nodeversion),await logger['debug'](_0x10fbda(0x246),_0xce66f4);}function startSocket(){const _0x42048b=_0xfbfeb9;io['on'](_0x42048b(0x2af),_0x476eda=>{const _0x31f500=_0x42048b;let _0x1ec397,_0x3bdf08,_0x21bb39,_0x3fc3b8,_0x2e8d85;const _0x5c36eb=_0x476eda[_0x31f500(0xf2)][_0x31f500(0x1d3)][_0x31f500(0x22b)];_0x3bdf08=_0x5c36eb[_0x31f500(0x1a3)](/bot[0-9]{3}/);if(_0x3bdf08)_0x21bb39=_0x3bdf08[0x0][_0x31f500(0x1a3)](/[0-9]{3}/);if(_0x21bb39)_0x1ec397=_0x21bb39[0x0];else _0x1ec397=_0x31f500(0x1b7);const _0x1861c8=_0x476eda[_0x31f500(0xf2)]['auth']['encryptedUuid'];if(!_0x1861c8)_0x476eda[_0x31f500(0x1bf)](_0x31f500(0x2d0),{'publicKey':secure[_0x31f500(0x120)]});else{_0x3fc3b8=timelyDecrypt(_0x1861c8,![]);if(!_0x3fc3b8)_0x476eda[_0x31f500(0x1bf)](_0x31f500(0x2d0),{'publicKey':secure[_0x31f500(0x120)]});else{_0x2e8d85=normalizeIP(_0x476eda[_0x31f500(0x2d3)][_0x31f500(0x216)])[_0x31f500(0x20a)];if(!devices[_0x3fc3b8])devices[_0x3fc3b8]={'uuid':_0x3fc3b8,'access':{'token':null}};devices[_0x3fc3b8]['ip']=_0x2e8d85;const _0x2be36c=addClient(_0x476eda['id'],_0x3fc3b8,_0x1ec397);setAccess(_0x2be36c),emitMessages(),_0x476eda['on']('login',_0x385d94=>{const _0xf3beb2=_0x31f500,_0x1b2e3e=timelyDecrypt(_0x385d94['password']);if(_0x1b2e3e){_0x385d94={'username':_0x385d94[_0xf3beb2(0x2a9)],'password':_0x1b2e3e},devices[_0x3fc3b8][_0xf3beb2(0x244)]=validateCredentials(_0x385d94,_0x3fc3b8);if(devices[_0x3fc3b8][_0xf3beb2(0x244)][_0xf3beb2(0x23d)]==![]&&devices[_0x3fc3b8]['access'][_0xf3beb2(0x105)]==_0xf3beb2(0x213))_0x476eda['emit']('status',{'access':devices[_0x3fc3b8][_0xf3beb2(0x244)]}),loginAccess2FA(_0x3fc3b8,_0x2e8d85);else{if(devices[_0x3fc3b8]['access'][_0xf3beb2(0x23d)]==![]&&devices[_0x3fc3b8][_0xf3beb2(0x244)][_0xf3beb2(0x105)]==_0xf3beb2(0x17a))_0x476eda[_0xf3beb2(0x1bf)]('status',{'access':devices[_0x3fc3b8][_0xf3beb2(0x244)]});else devices[_0x3fc3b8][_0xf3beb2(0x244)][_0xf3beb2(0x23d)]&&devices[_0x3fc3b8]['access'][_0xf3beb2(0x105)]==_0xf3beb2(0x1f2)&&(getClientsWithUuid(_0x3fc3b8)[_0xf3beb2(0x144)](_0x3bed59=>{setAccess(_0x3bed59);}),logger['debug'](_0xf3beb2(0x1d1)+_0x3fc3b8['slice'](-0x8)),setTokenRefresh(_0x3fc3b8),setSessionTimeout(_0xf3beb2(0x194),_0x3fc3b8));}}else logger[_0xf3beb2(0x245)](_0xf3beb2(0x193));}),_0x476eda['on']('reset-password',()=>{resetPassword();}),_0x476eda['on'](_0x31f500(0x23a),_0x45c585=>{removeClient(_0x476eda['id']);}),_0x1ec397==_0x31f500(0x1b7)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0xba5713){const _0x38e327=_0xfbfeb9;if(_0xba5713!='botmanager'&&config[_0x38e327(0x279)]!=''){if(pid[_0xba5713])pid[_0xba5713]['send']({'function':'initclient','args':null});}_0xba5713!=_0x38e327(0x1b7)&&broadcastToBots('bots',JSON[_0x38e327(0xef)](config));}function reloadBotManager(){const _0x358718=_0xfbfeb9;getClientsWithBotID(_0x358718(0x1b7))[_0x358718(0x144)](_0xeee716=>{const _0x5cf338=_0x358718;getSocket(_0xeee716['id'])[_0x5cf338(0x1bf)]('status',{'access':{'allow':![],'reason':_0x5cf338(0x1ed),'token':null}});});}function getSocket(_0x1317ae){const _0x22c1d9=_0xfbfeb9;return io[_0x22c1d9(0x149)]['sockets']['get'](_0x1317ae);}function setAccess(_0x259b6f){const _0x28ea79=_0xfbfeb9,_0x1f878e=getSocket(_0x259b6f['id']),_0x407802=_0x259b6f['uuid'],_0x424444=_0x259b6f[_0x28ea79(0x221)];devices[_0x407802][_0x28ea79(0x244)]=validateAccess(devices[_0x407802][_0x28ea79(0x244)][_0x28ea79(0x1a4)],_0x407802),logger[_0x28ea79(0x2c4)](_0x28ea79(0x1db)+devices[_0x407802]['access'][_0x28ea79(0x105)]+'\x20|\x20client:\x20...'+_0x259b6f['id'][_0x28ea79(0x2cb)](-0x8)+'\x20|\x20user:\x20...'+_0x407802[_0x28ea79(0x2cb)](-0x8)),_0x1f878e[_0x28ea79(0x147)](_0x407802);if(devices[_0x407802][_0x28ea79(0x244)]['allow']){_0x1f878e[_0x28ea79(0x147)](_0x424444);if(_0x424444==_0x28ea79(0x1b7))initializeSocketBotManager(_0x1f878e);else initializeSocketBot(_0x1f878e);initClient(_0x424444);}devices[_0x407802][_0x28ea79(0x244)][_0x28ea79(0x1a4)]&&devices[_0x407802][_0x28ea79(0x244)]['reason']==_0x28ea79(0x155)&&setSessionTimeout(_0x28ea79(0x287),_0x407802),devices[_0x407802]['access'][_0x28ea79(0x1a4)]&&devices[_0x407802]['access'][_0x28ea79(0x105)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x28ea79(0x194),_0x407802),_0x1f878e[_0x28ea79(0x1bf)]('status',{'status':_0x259b6f[_0x28ea79(0x2dd)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x407802][_0x28ea79(0x244)],'externalip':devices[_0x407802]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x28ea79(0x199)],'validInstallation':validInstallation}),devices[_0x407802][_0x28ea79(0x244)][_0x28ea79(0x23d)]==![]&&devices[_0x407802][_0x28ea79(0x244)]['reason']==_0x28ea79(0x238)&&temporaryAccess2FA(_0x407802,devices[_0x407802]['ip']);}function setSessionTimeout(_0x3a70bd,_0x59ef6f){const _0x510b38=_0xfbfeb9;let _0x7df8f4;if(_0x3a70bd=='login')_0x7df8f4=loginExpiry*0x3c*0x3e8;else _0x7df8f4=devices[_0x59ef6f]['telegramIpApproval'][_0x510b38(0x1a8)]*0x3c*0x3e8-(new Date()[_0x510b38(0x24e)]()-devices[_0x59ef6f][_0x510b38(0x2ce)][_0x510b38(0x10e)]);if(devices[_0x59ef6f][_0x510b38(0x26c)])clearTimeout(devices[_0x59ef6f]['pidExpireLogin']);devices[_0x59ef6f][_0x510b38(0x26c)]=setTimeout(()=>{const _0x20a864=_0x510b38;if(devices[_0x59ef6f][_0x20a864(0x230)])clearTimeout(devices[_0x59ef6f][_0x20a864(0x230)]);removeSocketListeners(_0x59ef6f),addBlacklist(_0x59ef6f),devices[_0x59ef6f][_0x20a864(0x2ce)]=null,devices[_0x59ef6f][_0x20a864(0x1da)]=null,devices[_0x59ef6f][_0x20a864(0x244)][_0x20a864(0x1a4)]=null,logger[_0x20a864(0x2c4)](_0x20a864(0x18a)+_0x59ef6f[_0x20a864(0x2cb)](-0x8)),devices[_0x59ef6f][_0x20a864(0x244)]=validateAccess(devices[_0x59ef6f][_0x20a864(0x244)][_0x20a864(0x1a4)],_0x59ef6f),!(devices[_0x59ef6f]['access'][_0x20a864(0x23d)]&&devices[_0x59ef6f][_0x20a864(0x244)][_0x20a864(0x105)]==_0x20a864(0x1a5))&&(_0x3a70bd=='login'?io['to'](_0x59ef6f)[_0x20a864(0x1bf)]('status',{'access':{'allow':![],'reason':_0x20a864(0x117),'token':null}}):io['to'](_0x59ef6f)[_0x20a864(0x1bf)](_0x20a864(0x2d0),{'access':{'allow':![],'reason':_0x20a864(0x1ab),'token':null}})),devices[_0x59ef6f]['access']['token']=null;},_0x7df8f4);}function setTokenRefresh(_0x922d82){const _0x423a2e=_0xfbfeb9;if(devices[_0x922d82]['pidRefreshToken'])clearTimeout(devices[_0x922d82]['pidRefreshToken']);devices[_0x922d82][_0x423a2e(0x230)]=setTimeout(()=>{const _0x372102=_0x423a2e;getClientsWithUuid(_0x922d82)[_0x372102(0x16f)]!=0x0?(devices[_0x922d82][_0x372102(0x244)]=refreshToken(_0x922d82),io['to'](_0x922d82)[_0x372102(0x1bf)](_0x372102(0x2d0),{'status':_0x372102(0x1f1),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x922d82][_0x372102(0x244)],'externalip':devices[_0x922d82]['ip'],'publicKey':secure[_0x372102(0x120)],'validInstallation':validInstallation}),setTokenRefresh(_0x922d82)):clearTimeout(devices[_0x922d82]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4524a4){const _0x5d741e=_0xfbfeb9,_0x2f2cd9=getClient(_0x4524a4['id'])[_0x5d741e(0x1bc)];_0x4524a4[_0x5d741e(0x1bf)](_0x5d741e(0x154),config),_0x4524a4[_0x5d741e(0x1bf)]('settings',cleanSettings()),_0x4524a4['on'](_0x5d741e(0x25e),_0x50d915=>{const _0x5f340c=_0x5d741e;if(validateAccess(_0x50d915,_0x2f2cd9)[_0x5f340c(0x23d)])addBot();else logger[_0x5f340c(0x245)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x4524a4['on'](_0x5d741e(0x112),(_0x4b9b62,_0x2b18d6)=>{const _0x43ca14=_0x5d741e;if(validateAccess(_0x2b18d6,_0x2f2cd9)[_0x43ca14(0x23d)])toggleBot(_0x4b9b62[_0x43ca14(0xfc)],_0x4b9b62[_0x43ca14(0x2d0)],_0x4b9b62['live']);else logger[_0x43ca14(0x245)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x4524a4['on'](_0x5d741e(0x18e),(_0x9cf4,_0x2450ab)=>{const _0x26bdb4=_0x5d741e;if(validateAccess(_0x2450ab,_0x2f2cd9)['allow'])toggleBotMode(_0x9cf4);else logger['full'](_0x26bdb4(0xf9));}),_0x4524a4['on'](_0x5d741e(0x222),(_0x1c395c,_0x5b0ee3)=>{const _0x5b791d=_0x5d741e;if(validateAccess(_0x5b0ee3,_0x2f2cd9)['allow'])deleteBot(_0x1c395c);else logger['full'](_0x5b791d(0x1ad));}),_0x4524a4['on']('store-settings',(_0x52c6e8,_0x463281)=>{const _0x4e9521=_0x5d741e;if(validateAccess(_0x463281,_0x2f2cd9)[_0x4e9521(0x23d)])storeSettings(_0x52c6e8,!![]);else logger[_0x4e9521(0x245)](_0x4e9521(0x231));}),_0x4524a4['on'](_0x5d741e(0x2c7),_0x159223=>{const _0xe5b94=_0x5d741e;if(validateAccess(_0x159223,_0x2f2cd9)[_0xe5b94(0x23d)])updateBB(_0xe5b94(0x29b));else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x4524a4['on'](_0x5d741e(0x1fe),_0x1c5174=>{const _0x33ed4b=_0x5d741e;if(validateAccess(_0x1c5174,_0x2f2cd9)[_0x33ed4b(0x23d)])updateBB('reinstall');else logger[_0x33ed4b(0x245)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x4524a4['on'](_0x5d741e(0x2ca),_0x243669=>{const _0x3cc8b4=_0x5d741e;if(validateAccess(_0x243669,_0x2f2cd9)[_0x3cc8b4(0x23d)]){const _0x138e43=getClient(_0x4524a4['id']);if(_0x138e43)getBackupFiles(_0x138e43[_0x3cc8b4(0x1bc)]);else logger[_0x3cc8b4(0x245)](_0x3cc8b4(0x173));}else logger[_0x3cc8b4(0x245)](_0x3cc8b4(0x1a1));}),_0x4524a4['on'](_0x5d741e(0x1a0),(_0x5605f0,_0x729f3f)=>{const _0x499b93=_0x5d741e;if(validateAccess(_0x729f3f,_0x2f2cd9)[_0x499b93(0x23d)])restoreBackupFile(_0x5605f0);else logger[_0x499b93(0x245)](_0x499b93(0x2a7));}),_0x4524a4['on']('get-messages',_0x471441=>{const _0x1cfa0d=_0x5d741e;if(validateAccess(_0x471441,_0x2f2cd9)[_0x1cfa0d(0x23d)])getMessages();else logger[_0x1cfa0d(0x245)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x4524a4['on'](_0x5d741e(0x14b),(_0x1a21a8,_0x5780b9)=>{const _0x252a2d=_0x5d741e;if(validateAccess(_0x5780b9,_0x2f2cd9)[_0x252a2d(0x23d)])confirmMessage(_0x1a21a8);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x4524a4['on']('logout',_0xc0ef3e=>{const _0x33a14a=_0x5d741e;if(validateAccess(_0xc0ef3e,_0x2f2cd9)['allow']){if(devices[_0x2f2cd9]['pidRefreshToken'])clearTimeout(devices[_0x2f2cd9][_0x33a14a(0x230)]);if(devices[_0x2f2cd9][_0x33a14a(0x26c)])clearTimeout(devices[_0x2f2cd9]['pidExpireLogin']);removeSocketListeners(getClient(_0x4524a4['id'])[_0x33a14a(0x1bc)]),addBlacklist(_0x2f2cd9),devices[_0x2f2cd9][_0x33a14a(0x2ce)]=null,devices[_0x2f2cd9][_0x33a14a(0x1da)]=null,devices[_0x2f2cd9][_0x33a14a(0x244)][_0x33a14a(0x1a4)]=null,logger[_0x33a14a(0x2c4)]('Logged\x20out\x20user\x20...'+_0x2f2cd9[_0x33a14a(0x2cb)](-0x8)),io['to'](getClient(_0x4524a4['id'])['uuid'])[_0x33a14a(0x1bf)](_0x33a14a(0x2d0),{'access':{'allow':![],'reason':_0x33a14a(0x2e4),'token':null}});}else logger[_0x33a14a(0x245)](_0x33a14a(0x10b));});}function initializeSocketBot(_0x4e3df7){const _0x1caac4=_0xfbfeb9,_0x5d6d47=getClient(_0x4e3df7['id'])[_0x1caac4(0x221)],_0x19c743=getClient(_0x4e3df7['id'])[_0x1caac4(0x1bc)];_0x4e3df7['on'](_0x1caac4(0x2d9),(_0x521913,_0x4165a2)=>{const _0x1aadea=_0x1caac4;if(validateAccess(_0x4165a2,_0x19c743)['allow']){if(pid[_0x5d6d47])pid[_0x5d6d47]['send']({'function':_0x1aadea(0x132),'args':_0x521913});}else logger[_0x1aadea(0x245)](_0x1aadea(0x1c0));}),_0x4e3df7['on'](_0x1caac4(0x160),(_0xd4d82c,_0x3d5652)=>{const _0x5bd022=_0x1caac4;if(validateAccess(_0x3d5652,_0x19c743)['allow']){if(pid[_0x5d6d47])pid[_0x5d6d47][_0x5bd022(0x1e7)]({'function':_0x5bd022(0x1a2),'args':_0xd4d82c});}else logger[_0x5bd022(0x245)](_0x5bd022(0x1bb));}),_0x4e3df7['on']('get-portfolio',(_0x18718b,_0x5106e6)=>{const _0x1eb37f=_0x1caac4;if(validateAccess(_0x5106e6,_0x19c743)[_0x1eb37f(0x23d)]){if(pid[_0x5d6d47])pid[_0x5d6d47][_0x1eb37f(0x1e7)]({'function':_0x1eb37f(0x1bd),'args':_0x18718b});}else logger[_0x1eb37f(0x245)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x4e3df7['on'](_0x1caac4(0x264),(_0x10c0f8,_0x3812a9)=>{const _0x57d090=_0x1caac4;if(validateAccess(_0x3812a9,_0x19c743)[_0x57d090(0x23d)]){if(pid[_0x5d6d47])pid[_0x5d6d47][_0x57d090(0x1e7)]({'function':_0x57d090(0x1be),'args':_0x10c0f8});}else logger[_0x57d090(0x245)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x4e3df7['on'](_0x1caac4(0x265),(_0x11136e,_0x27c913)=>{const _0x2ebc49=_0x1caac4;if(validateAccess(_0x27c913,_0x19c743)['allow']){if(pid[_0x5d6d47])pid[_0x5d6d47]['send']({'function':_0x2ebc49(0x13e),'args':_0x11136e});}else logger[_0x2ebc49(0x245)](_0x2ebc49(0x165));}),_0x4e3df7['on']('store-fiat',(_0x1a16ae,_0x4eb899)=>{const _0x7bef9e=_0x1caac4;if(validateAccess(_0x4eb899,_0x19c743)[_0x7bef9e(0x23d)]){if(pid[_0x5d6d47])pid[_0x5d6d47][_0x7bef9e(0x1e7)]({'function':'storeFiat','args':_0x1a16ae});}else logger[_0x7bef9e(0x245)](_0x7bef9e(0x215));}),_0x4e3df7['on'](_0x1caac4(0x2cc),_0x4f0b38=>{const _0x578919=_0x1caac4;if(validateAccess(_0x4f0b38,_0x19c743)['allow']){if(pid[_0x5d6d47])pid[_0x5d6d47]['send']({'function':_0x578919(0x249),'args':null});}else logger[_0x578919(0x245)](_0x578919(0x1b3));}),_0x4e3df7['on']('get-starting-balances',_0x4b0d52=>{const _0x3db97a=_0x1caac4;if(validateAccess(_0x4b0d52,_0x19c743)['allow']){if(pid[_0x5d6d47])pid[_0x5d6d47][_0x3db97a(0x1e7)]({'function':'getStartingBalances','args':null});}else logger[_0x3db97a(0x245)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x4e3df7['on'](_0x1caac4(0x1e6),(_0x24d15f,_0x1433c5)=>{const _0x45fa5c=_0x1caac4;if(validateAccess(_0x1433c5,_0x19c743)[_0x45fa5c(0x23d)]){if(pid[_0x5d6d47])pid[_0x5d6d47][_0x45fa5c(0x1e7)]({'function':_0x45fa5c(0x2b2),'args':_0x24d15f});}else logger['full'](_0x45fa5c(0x205));}),_0x4e3df7['on']('cancel-loading',_0x360714=>{const _0x578a88=_0x1caac4;if(validateAccess(_0x360714,_0x19c743)['allow']){if(pid[_0x5d6d47])pid[_0x5d6d47]['send']({'function':_0x578a88(0x1eb),'args':null});}else logger['full'](_0x578a88(0x189));}),_0x4e3df7['on'](_0x1caac4(0x280),_0x2346b9=>{const _0x3686a0=_0x1caac4;if(validateAccess(_0x2346b9,_0x19c743)[_0x3686a0(0x23d)]){if(pid[_0x5d6d47])pid[_0x5d6d47][_0x3686a0(0x1e7)]({'function':'showConfig','args':null});}else logger['full'](_0x3686a0(0xfa));}),_0x4e3df7['on'](_0x1caac4(0x2c7),_0x1f6d4d=>{const _0x28db08=_0x1caac4;if(validateAccess(_0x1f6d4d,_0x19c743)[_0x28db08(0x23d)])updateBB(_0x28db08(0x29b));else logger[_0x28db08(0x245)](_0x28db08(0x1c2));}),_0x4e3df7['on'](_0x1caac4(0x140),_0x402067=>{const _0x5ce249=_0x1caac4;if(validateAccess(_0x402067,_0x19c743)[_0x5ce249(0x23d)])getMessages();else logger[_0x5ce249(0x245)](_0x5ce249(0x251));}),_0x4e3df7['on'](_0x1caac4(0x14b),(_0xc23182,_0x23c202)=>{const _0x5ef65c=_0x1caac4;if(validateAccess(_0x23c202,_0x19c743)[_0x5ef65c(0x23d)])confirmMessage(_0xc23182);else logger['full'](_0x5ef65c(0x226));}),_0x4e3df7['on'](_0x1caac4(0x102),_0x2e8f43=>{const _0x28395e=_0x1caac4;if(validateAccess(_0x2e8f43,_0x19c743)[_0x28395e(0x23d)]){if(devices[_0x19c743]['pidRefreshToken'])clearTimeout(devices[_0x19c743][_0x28395e(0x230)]);if(devices[_0x19c743]['pidExpireLogin'])clearTimeout(devices[_0x19c743][_0x28395e(0x26c)]);removeSocketListeners(getClient(_0x4e3df7['id'])['uuid']),addBlacklist(_0x19c743),devices[_0x19c743][_0x28395e(0x2ce)]=null,devices[_0x19c743]['telegram2FaApproval']=null,devices[_0x19c743][_0x28395e(0x244)][_0x28395e(0x1a4)]=null,logger[_0x28395e(0x2c4)]('Logged\x20out\x20user\x20...'+_0x19c743[_0x28395e(0x2cb)](-0x8)),io['to'](getClient(_0x4e3df7['id'])['uuid'])['emit'](_0x28395e(0x2d0),{'access':{'allow':![],'reason':_0x28395e(0x2e4),'token':null}});}else logger['full'](_0x28395e(0x10b));});}function removeSocketListeners(_0x4119c9){const _0x202e27=_0xfbfeb9;getClientsWithUuid(_0x4119c9)[_0x202e27(0x144)](_0x132c00=>{getSocket(_0x132c00['id'])['removeAllListeners']();});}function cleanSettings(){const _0x84ef7=_0xfbfeb9;let _0x397354=settings;return settings['telegramToken']&&settings['telegramToken']!=''&&(_0x397354={..._0x397354,'telegramToken':_0x84ef7(0x137)}),settings[_0x84ef7(0x159)]&&settings[_0x84ef7(0x159)]!=''&&(_0x397354={..._0x397354,'bbPassword':_0x84ef7(0x137)}),(settings[_0x84ef7(0x159)]&&settings[_0x84ef7(0x159)]==_0x84ef7(0x1ca)||settings['telegramToken']&&settings[_0x84ef7(0x22d)]==_0x84ef7(0x1ca))&&(_0x397354={..._0x397354,'restored':{'password':settings[_0x84ef7(0x159)]=='***','telegram':settings[_0x84ef7(0x22d)]==_0x84ef7(0x1ca)}}),_0x397354;}async function updateBB(_0x57312d){const _0x25fba8=_0xfbfeb9;await backupConfigFiles(),installingUpdate=!![],config[_0x25fba8(0x144)](_0x60f65a=>{const _0x4f1731=_0x25fba8;restartBot(_0x60f65a[_0x4f1731(0xfc)]);});if(_0x57312d==_0x25fba8(0x29b))process[_0x25fba8(0x1e7)]({'update':!![],'environment':environment},_0x5647e9=>{});else _0x57312d==_0x25fba8(0x248)&&process[_0x25fba8(0x1e7)]({'reinstall':!![],'environment':environment},_0x1c0ad1=>{});}function startBot(_0x20c6a0,_0x568ea1,_0x38275c){const _0x170400=_0xfbfeb9;if(debugging)_0x20c6a0['push']('-d');let _0x42983d=![];const _0x4ba62b=_0x20c6a0[0x0];_0x568ea1={..._0x568ea1,'stdio':[_0x170400(0x171),'inherit',_0x170400(0x171),_0x170400(0x274)]},pid[_0x4ba62b]=childProcess[_0x170400(0x1af)](botfile,_0x20c6a0,_0x568ea1),pid[_0x4ba62b]['on'](_0x170400(0x2a6),_0x3c2169=>{const _0x7581a4=_0x170400;switch(Object[_0x7581a4(0x1a7)](_0x3c2169)[0x0]){case _0x7581a4(0x268):updateBotName(_0x4ba62b,_0x3c2169[_0x7581a4(0x268)]);break;case _0x7581a4(0x158):updateBotManager();break;case'status':updateStatus(_0x4ba62b,_0x3c2169[_0x7581a4(0x2d0)]);break;case _0x7581a4(0x266):updateLive(_0x4ba62b,_0x3c2169[_0x7581a4(0x266)]);break;case _0x7581a4(0x223):updateLive(_0x4ba62b,_0x3c2169[_0x7581a4(0x223)]),io['to'](_0x4ba62b)[_0x7581a4(0x1bf)]('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x7581a4(0x115):_0x3c2169[_0x7581a4(0x115)]==_0x7581a4(0x2d8)&&restartBot(_0x4ba62b);_0x3c2169[_0x7581a4(0x115)]==_0x7581a4(0x20f)&&toggleBot(_0x4ba62b,_0x7581a4(0x1fd),_0x7581a4(0x1d7));break;case _0x7581a4(0x111):sendTelegramBot(_0x4ba62b,_0x3c2169[_0x7581a4(0x111)]);break;case'telegrammsg':sendTelegramMsg(_0x3c2169['telegrammsg']);break;case _0x7581a4(0xf1):io['to'](_0x4ba62b)[_0x7581a4(0x1bf)](_0x3c2169['function'],_0x3c2169[_0x7581a4(0x253)]);break;}}),pid[_0x4ba62b]['on']('error',function(_0x173a4f){if(_0x42983d)return;_0x42983d=!![],_0x38275c(_0x173a4f);}),pid[_0x4ba62b]['on'](_0x170400(0x16c),async function(_0x5aae16){const _0x1621bb=_0x170400;if(terminating)return;if(installingUpdate){logger[_0x1621bb(0x2c4)](_0x1621bb(0x1ec)),io['close']();return;}if(_0x42983d)return;_0x42983d=!![],_0x38275c(null);const _0x103e48=dbConfig['get'](_0x1621bb(0x154))[_0x1621bb(0x153)]({'botID':_0x4ba62b})[_0x1621bb(0x225)]();_0x103e48&&(_0x103e48[_0x1621bb(0x2d0)]=='enabled'||_0x103e48[_0x1621bb(0x2d0)]==_0x1621bb(0x1cb))&&(await sleep(0x3e8),updateLive(_0x4ba62b,_0x1621bb(0x1d7)),logger[_0x1621bb(0x245)](_0x1621bb(0x282)+_0x4ba62b),startBot([_0x4ba62b,userID],{'cwd':bbpath},function(_0x55b020){if(_0x55b020)logger['full'](_0x55b020);}));});}function stopBot(_0x4445d3){getClientsWithBotID(_0x4445d3)['forEach'](_0x33dbd0=>{getSocket(_0x33dbd0['id'])['disconnect'](!![]),removeClient(_0x33dbd0['id']);}),pid[_0x4445d3]&&(pid[_0x4445d3]['kill'](),pid[_0x4445d3]=null);}function stopAllBots(){terminating=!![];const _0x3af8a5=getEnabledBots();_0x3af8a5['forEach'](_0x553904=>{const _0x125fec=_0x2b31;stopBot(_0x553904[_0x125fec(0xfc)]);});}function _0x2b31(_0x3c49a0,_0x5d9a94){const _0x1a2475=_0x488a();return _0x2b31=function(_0x5b169b,_0x555b06){_0x5b169b=_0x5b169b-0xeb;let _0x488a24=_0x1a2475[_0x5b169b];return _0x488a24;},_0x2b31(_0x3c49a0,_0x5d9a94);}function restartBot(_0x5dc2ed){const _0x9c7f2c=_0xfbfeb9;if(pid[_0x5dc2ed])pid[_0x5dc2ed][_0x9c7f2c(0x20f)]();}function addBot(){const _0x32ea71=_0xfbfeb9;let _0x5a50a4;for(let _0x24e0fe=0x1;_0x24e0fe<0x3e9;_0x24e0fe++){_0x5a50a4=_0x24e0fe[_0x32ea71(0x11a)]()[_0x32ea71(0x127)](0x3,'0');let _0xcf2d94=config['find'](_0x56bd47=>_0x56bd47[_0x32ea71(0xfc)]==_0x5a50a4);if(!_0xcf2d94)break;}if(_0x5a50a4===_0x32ea71(0x277)){logger['full']('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x32ea71(0x245)](_0x32ea71(0x12c)+_0x5a50a4),dbConfig[_0x32ea71(0xf3)](_0x32ea71(0x154))[_0x32ea71(0x161)]({'botID':_0x5a50a4,'botname':_0x32ea71(0x247)+_0x5a50a4,'status':_0x32ea71(0x1cb),'live':''})[_0x32ea71(0x1d9)](),startBot([_0x5a50a4,userID],{'cwd':bbpath},function(_0x2259e8){if(_0x2259e8)logger['full'](_0x2259e8);}),config=getConfiguration(),io['to'](_0x32ea71(0x1b7))[_0x32ea71(0x1bf)](_0x32ea71(0x154),config),broadcastToBots(_0x32ea71(0x154),JSON[_0x32ea71(0xef)](config));}function deleteBot(_0x3bffdc){const _0xd7a333=_0xfbfeb9;getClientsWithBotID(_0x3bffdc)[_0xd7a333(0x144)](_0x2a6889=>{const _0x104cf3=_0xd7a333;getSocket(_0x2a6889['id'])[_0x104cf3(0x23a)](!![]),removeClient(_0x2a6889['id']);}),dbConfig[_0xd7a333(0xf3)](_0xd7a333(0x154))[_0xd7a333(0x22f)]({'botID':_0x3bffdc})[_0xd7a333(0x1d9)](),logger['full'](_0xd7a333(0x297)+_0x3bffdc),stopBot(_0x3bffdc);try{if(fs[_0xd7a333(0x281)](path['join'](configpath,_0xd7a333(0x21c)+_0x3bffdc+_0xd7a333(0x293))))fs[_0xd7a333(0x104)](path['join'](configpath,_0xd7a333(0x21c)+_0x3bffdc+'-config.json'));if(fs['existsSync'](path[_0xd7a333(0x147)](configpath,_0xd7a333(0x21c)+_0x3bffdc+_0xd7a333(0x13d))))fs[_0xd7a333(0x104)](path['join'](configpath,_0xd7a333(0x21c)+_0x3bffdc+_0xd7a333(0x13d)));if(fs[_0xd7a333(0x281)](path[_0xd7a333(0x147)](configpath,_0xd7a333(0x21c)+_0x3bffdc+_0xd7a333(0x110))))fs['unlinkSync'](path[_0xd7a333(0x147)](configpath,_0xd7a333(0x21c)+_0x3bffdc+_0xd7a333(0x110)));if(fs[_0xd7a333(0x281)](path[_0xd7a333(0x147)](configpath,_0xd7a333(0x21c)+_0x3bffdc+_0xd7a333(0x126))))fs[_0xd7a333(0x104)](path[_0xd7a333(0x147)](configpath,'bot-'+_0x3bffdc+_0xd7a333(0x126)));}catch(_0x15236c){if(_0x15236c)logger[_0xd7a333(0x245)](_0xd7a333(0x229),_0x15236c);}config=getConfiguration(),io['to'](_0xd7a333(0x1b7))[_0xd7a333(0x1bf)]('bots',config),broadcastToBots(_0xd7a333(0x154),JSON[_0xd7a333(0xef)](config));}function toggleBot(_0x1d9c78,_0x32cdad,_0x392ef2){const _0x15b877=_0xfbfeb9;dbConfig['get']('bots')[_0x15b877(0x153)]({'botID':_0x1d9c78})['assign']({'status':_0x32cdad})[_0x15b877(0xf5)]({'live':_0x392ef2})[_0x15b877(0x1d9)]();if(_0x32cdad=='enabled'||_0x32cdad==_0x15b877(0x1cb))logger[_0x15b877(0x245)]('Enabled\x20Bot\x20'+_0x1d9c78),startBot([_0x1d9c78,userID],{'cwd':bbpath},function(_0x8ded23){const _0x3b8e24=_0x15b877;if(_0x8ded23)logger[_0x3b8e24(0x245)](_0x8ded23);});else(_0x32cdad==_0x15b877(0x1fd)||_0x32cdad==_0x15b877(0x2b9))&&(logger[_0x15b877(0x245)]('Disabled\x20Bot\x20'+_0x1d9c78),stopBot(_0x1d9c78));config=getConfiguration(),io['to'](_0x15b877(0x1b7))['emit']('bots',config),broadcastToBots(_0x15b877(0x154),JSON[_0x15b877(0xef)](config));}function toggleStatus(_0x5ed241){const _0x5bd1b0=_0xfbfeb9;let _0x3b40be=dbConfig[_0x5bd1b0(0xf3)](_0x5bd1b0(0x154))[_0x5bd1b0(0x153)]({'botID':_0x5ed241})['value'](),_0x4c0afb;if(_0x3b40be['status']==='enabled')_0x4c0afb=_0x5bd1b0(0x1fd);else{if(_0x3b40be[_0x5bd1b0(0x2d0)]===_0x5bd1b0(0x1cb))_0x4c0afb=_0x5bd1b0(0x2b9);else{if(_0x3b40be[_0x5bd1b0(0x2d0)]==='new-disabled')_0x4c0afb=_0x5bd1b0(0x1cb);else{if(_0x3b40be[_0x5bd1b0(0x2d0)]===_0x5bd1b0(0x1fd))_0x4c0afb=_0x5bd1b0(0x15f);}}}return _0x4c0afb;}function updateStatus(_0x3e5c34,_0x54d596){const _0x15f409=_0xfbfeb9;dbConfig[_0x15f409(0xf3)](_0x15f409(0x154))[_0x15f409(0x153)]({'botID':_0x3e5c34})[_0x15f409(0xf5)]({'status':_0x54d596})[_0x15f409(0x1d9)](),config=getConfiguration(),io['to'](_0x15f409(0x1b7))[_0x15f409(0x1bf)](_0x15f409(0x154),config),broadcastToBots('bots',JSON[_0x15f409(0xef)](config));}function updateLive(_0x437110,_0x33bb5e){const _0x12a62b=_0xfbfeb9;dbConfig[_0x12a62b(0xf3)]('bots')[_0x12a62b(0x153)]({'botID':_0x437110})[_0x12a62b(0xf5)]({'live':_0x33bb5e})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x12a62b(0x1bf)]('bots',config),broadcastToBots(_0x12a62b(0x154),JSON[_0x12a62b(0xef)](config));}function updateBotName(_0x1663bc,_0x4cc678){const _0x2f6a8e=_0xfbfeb9;dbConfig['get'](_0x2f6a8e(0x154))[_0x2f6a8e(0x153)]({'botID':_0x1663bc})['assign']({'botname':_0x4cc678})[_0x2f6a8e(0x1d9)](),config=getConfiguration(),io['to'](_0x2f6a8e(0x1b7))[_0x2f6a8e(0x1bf)](_0x2f6a8e(0x154),config),broadcastToBots('bots',JSON[_0x2f6a8e(0xef)](config));}function updateBotManager(){const _0x4ebd1e=_0xfbfeb9;config=getConfiguration(),io['to'](_0x4ebd1e(0x1b7))[_0x4ebd1e(0x1bf)](_0x4ebd1e(0x154),config),broadcastToBots(_0x4ebd1e(0x154),JSON[_0x4ebd1e(0xef)](config));}function toggleBotMode(_0x4efb76){const _0x49b00a=_0xfbfeb9;if(pid[_0x4efb76])pid[_0x4efb76][_0x49b00a(0x1e7)]({'function':_0x49b00a(0x1dd),'args':null});else{const _0x29243e=configpath+_0x49b00a(0x21c)+_0x4efb76+'-config.json',_0x24992e=fs[_0x49b00a(0x1f9)](_0x29243e),_0x559a59=JSON[_0x49b00a(0x28e)](_0x24992e),_0x101854=_0x559a59[_0x49b00a(0x221)][0x0][_0x49b00a(0x29d)];_0x559a59[_0x49b00a(0x221)][0x0]['headless']=!_0x101854;const _0x20efc3=JSON[_0x49b00a(0xef)](_0x559a59,null,0x2);fs['writeFileSync'](_0x29243e,_0x20efc3),config=getConfiguration(),io['to'](_0x49b00a(0x1b7))[_0x49b00a(0x1bf)]('bots',config),broadcastToBots(_0x49b00a(0x154),JSON[_0x49b00a(0xef)](config));}}function validateTelegram(_0x4907a3){const _0x23238c=_0xfbfeb9;if(_0x4907a3[_0x23238c(0x220)]['username']!=settings[_0x23238c(0x2d2)]&&'@'+_0x4907a3[_0x23238c(0x220)]['username']!=settings['telegramUsername']||_0x4907a3['chat']['id']!=settings[_0x23238c(0x11b)])return sendTelegram(_0x4907a3[_0x23238c(0x286)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0x42aa95=_0xfbfeb9;if(tgBot)tgBot[_0x42aa95(0x115)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0x3c7d94=_0x42aa95(0x1fa);_0x3c7d94+='\x0a',_0x3c7d94+=_0x42aa95(0x2ad),_0x3c7d94+=_0x42aa95(0x1e5),_0x3c7d94+=_0x42aa95(0x23f),_0x3c7d94+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x3c7d94+=_0x42aa95(0x207),_0x3c7d94+=_0x42aa95(0x1b0),_0x3c7d94+=_0x42aa95(0x1ce),_0x3c7d94+=_0x42aa95(0x134),_0x3c7d94+=_0x42aa95(0x185),_0x3c7d94+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x3c7d94+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x3c7d94+=_0x42aa95(0x167),_0x3c7d94+=_0x42aa95(0x13f),_0x3c7d94+=_0x42aa95(0x296);let _0x38ad7b=_0x42aa95(0x125);_0x38ad7b+='\x0a',_0x38ad7b+=_0x3c7d94,tgBot['catch']((_0x4e0bde,_0x54cc55)=>{const _0x317c9c=_0x42aa95;logger[_0x317c9c(0x1e9)](getTimeStamp()+_0x317c9c(0x24d)),logger[_0x317c9c(0x2c4)]('Telegraf\x20error:',_0x4e0bde);}),tgBot[_0x42aa95(0x2c6)](async(_0x1e1a45,_0xf05c7f)=>{const _0x5283fb=_0x42aa95;if(!(!settings['telegramChatId']&&_0x1e1a45[_0x5283fb(0x29b)][_0x5283fb(0x2a6)][_0x5283fb(0x2a4)]==_0x5283fb(0x177))){if(!validateTelegram(_0x1e1a45))return;}_0xf05c7f();}),tgBot['command']('start',async _0x922c5e=>{const _0x142466=_0x42aa95;if(!settings[_0x142466(0x11b)])updateSetting('telegramChatId',_0x922c5e[_0x142466(0x286)]['id']);updateSetting(_0x142466(0x27e),!![]);if(!validateTelegram(_0x922c5e))return;await sendTelegram(_0x922c5e[_0x142466(0x286)]['id'],_0x38ad7b);}),tgBot['command'](_0x42aa95(0x10d),async _0x13baff=>{const _0x1b7517=_0x42aa95;updateSetting(_0x1b7517(0x27e),!![]),await sendTelegram(_0x13baff['chat']['id'],_0x1b7517(0x236));}),tgBot[_0x42aa95(0x23e)](_0x42aa95(0x1cc),async _0x167a51=>{const _0x5b3306=_0x42aa95;await sendTelegram(_0x167a51[_0x5b3306(0x286)]['id'],'Notifications\x20disabled'),updateSetting('telegramEnabled',![]);}),tgBot[_0x42aa95(0x23e)](_0x42aa95(0x212),async _0x5034=>{const _0x259cea=_0x42aa95,_0x286b6b=Markup['inlineKeyboard']([Markup[_0x259cea(0x12b)][_0x259cea(0x233)](_0x259cea(0x2aa),'config_orders'),Markup[_0x259cea(0x12b)][_0x259cea(0x233)](_0x259cea(0x135),'config_alerts'),Markup[_0x259cea(0x12b)][_0x259cea(0x233)]('All',_0x259cea(0x263))]);_0x5034[_0x259cea(0x241)](_0x259cea(0x24c),_0x286b6b);}),tgBot[_0x42aa95(0x259)](_0x42aa95(0x200),async _0x484b3e=>{const _0x1e4847=_0x42aa95;_0x484b3e[_0x1e4847(0x169)](),updateSetting('telegramEvents',_0x1e4847(0x29a)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x484b3e[_0x1e4847(0x286)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0x42aa95(0x259)](_0x42aa95(0x14f),async _0x464272=>{const _0x35460c=_0x42aa95;_0x464272[_0x35460c(0x169)](),updateSetting(_0x35460c(0x224),_0x35460c(0x294)),updateSetting(_0x35460c(0x27e),!![]),await sendTelegram(_0x464272['chat']['id'],_0x35460c(0x28b));}),tgBot[_0x42aa95(0x259)]('config_all',async _0x1234d0=>{const _0xf95ddd=_0x42aa95;_0x1234d0[_0xf95ddd(0x169)](),updateSetting(_0xf95ddd(0x224),'all'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x1234d0[_0xf95ddd(0x286)]['id'],_0xf95ddd(0x12e));}),tgBot[_0x42aa95(0x23e)]('status',async _0x3b81d7=>{const _0x4a4a9d=_0x42aa95,_0x5bd35c=getBotsWithMode();let _0x4097b8=_0x4a4a9d(0x1f4);config[_0x4a4a9d(0x144)](_0x15b7ce=>{const _0x7e77bc=_0x4a4a9d,_0x272279=_0x5bd35c['find'](_0x206449=>_0x206449[_0x7e77bc(0xfc)]==_0x15b7ce[_0x7e77bc(0xfc)])[_0x7e77bc(0x1b5)];_0x4097b8+='Bot\x20'+_0x15b7ce[_0x7e77bc(0xfc)]+':\x20'+_0x15b7ce[_0x7e77bc(0x2d0)]+_0x7e77bc(0x2be)+_0x272279+_0x7e77bc(0x2be)+_0x15b7ce['live']+'\x0a';}),_0x4097b8+='\x0a',_0x4097b8+=_0x4a4a9d(0x198),_0x4097b8+=!settings[_0x4a4a9d(0x27e)]?_0x4a4a9d(0x179):_0x4a4a9d(0x299),_0x4097b8+=settings[_0x4a4a9d(0x27e)]?settings[_0x4a4a9d(0x224)]==_0x4a4a9d(0x188)?_0x4a4a9d(0x2bd):_0x4a4a9d(0x261)+settings[_0x4a4a9d(0x224)]+_0x4a4a9d(0x170):'',await sendTelegram(_0x3b81d7[_0x4a4a9d(0x286)]['id'],_0x4097b8,{'parse_mode':_0x4a4a9d(0x2c2)});}),tgBot[_0x42aa95(0x23e)]('restart',async _0x292282=>{const _0x107fb2=_0x42aa95,_0x58f118=getEnabledBots();if(_0x58f118[_0x107fb2(0x16f)]==0x0)await sendTelegram(_0x292282[_0x107fb2(0x286)]['id'],_0x107fb2(0x184));else{if(_0x58f118[_0x107fb2(0x16f)]>0x1)_0x58f118['push']({'botID':_0x107fb2(0x188)});let _0xc8a5cc=[],_0x35c861=[];const _0x515e68=_0x58f118[_0x107fb2(0x16f)]%0x4==0x0||_0x58f118[_0x107fb2(0x16f)]%0x4==0x3||_0x58f118[_0x107fb2(0x16f)]%0x3==0x1?0x4:0x3;let _0x464bf9=0x0;_0x58f118[_0x107fb2(0x144)]((_0x5bd8c1,_0x5f287e)=>{const _0x21e531=_0x107fb2;if(_0x5f287e%_0x515e68==0x0)_0x35c861=[];_0x35c861['push'](Markup[_0x21e531(0x12b)][_0x21e531(0x233)](_0x5bd8c1['botID']==_0x21e531(0x188)?'All\x20bots':_0x21e531(0x247)+_0x5bd8c1[_0x21e531(0xfc)],'restart_'+_0x5bd8c1[_0x21e531(0xfc)])),_0x5f287e%_0x515e68==0x0&&(_0xc8a5cc[_0x464bf9]=_0x35c861,_0x464bf9++);});const _0x1d62bd=Markup[_0x107fb2(0x1fc)](_0xc8a5cc);_0x292282[_0x107fb2(0x241)](_0x107fb2(0x157),_0x1d62bd);}}),tgBot[_0x42aa95(0x259)](/restart_(.+)/,async _0x2d2107=>{const _0x358d2f=_0x42aa95,_0x313a5f=_0x2d2107[_0x358d2f(0x1a3)][0x1];_0x2d2107['editMessageReplyMarkup'](),_0x313a5f==_0x358d2f(0x188)?config[_0x358d2f(0x144)](_0x4e328a=>{const _0x1bd720=_0x358d2f;restartBot(_0x4e328a[_0x1bd720(0xfc)]);}):restartBot(_0x313a5f);}),tgBot[_0x42aa95(0x23e)]('on',async _0x557bab=>{const _0x517fe8=_0x42aa95,_0x1284e4=getDisabledBots();if(_0x1284e4['length']==0x0)await sendTelegram(_0x557bab['chat']['id'],_0x517fe8(0x183));else{if(_0x1284e4[_0x517fe8(0x16f)]>0x1)_0x1284e4[_0x517fe8(0x161)]({'botID':_0x517fe8(0x188)});let _0x2451f5=[],_0x27750f=[];const _0x4c370e=_0x1284e4['length']%0x4==0x0||_0x1284e4[_0x517fe8(0x16f)]%0x4==0x3||_0x1284e4[_0x517fe8(0x16f)]%0x3==0x1?0x4:0x3;let _0x17a5bb=0x0;_0x1284e4[_0x517fe8(0x144)]((_0x4e9fcf,_0x13e9f2)=>{const _0x4e52b3=_0x517fe8;if(_0x13e9f2%_0x4c370e==0x0)_0x27750f=[];_0x27750f[_0x4e52b3(0x161)](Markup['button'][_0x4e52b3(0x233)](_0x4e9fcf[_0x4e52b3(0xfc)]==_0x4e52b3(0x188)?'All\x20bots':'Bot\x20'+_0x4e9fcf[_0x4e52b3(0xfc)],'on_'+_0x4e9fcf[_0x4e52b3(0xfc)])),_0x13e9f2%_0x4c370e==0x0&&(_0x2451f5[_0x17a5bb]=_0x27750f,_0x17a5bb++);});const _0x1b6173=Markup[_0x517fe8(0x1fc)](_0x2451f5);_0x557bab['reply'](_0x517fe8(0x1b1),_0x1b6173);}}),tgBot[_0x42aa95(0x259)](/on_(.+)/,async _0x221865=>{const _0x5b285f=_0x42aa95,_0x25cb10=_0x221865[_0x5b285f(0x1a3)][0x1];_0x221865['editMessageReplyMarkup']();if(_0x25cb10=='all'){const _0x5a28fa=getDisabledBots();await sendTelegram(_0x221865[_0x5b285f(0x286)]['id'],_0x5b285f(0x25f)),_0x5a28fa[_0x5b285f(0x144)](_0x49197d=>{const _0x4da234=_0x5b285f;if(_0x49197d['botID']!=_0x4da234(0x188))toggleBot(_0x49197d[_0x4da234(0xfc)],toggleStatus(_0x49197d[_0x4da234(0xfc)]),_0x4da234(0x1d7));});}else await sendTelegram(_0x221865['chat']['id'],_0x5b285f(0x116)+_0x25cb10),toggleBot(_0x25cb10,toggleStatus(_0x25cb10),_0x5b285f(0x1d7));}),tgBot[_0x42aa95(0x23e)](_0x42aa95(0x1d6),async _0x5616fc=>{const _0x38b3a7=_0x42aa95,_0x2f4cda=getEnabledBots();if(_0x2f4cda[_0x38b3a7(0x16f)]==0x0)await sendTelegram(_0x5616fc[_0x38b3a7(0x286)]['id'],_0x38b3a7(0x184));else{if(_0x2f4cda[_0x38b3a7(0x16f)]>0x1)_0x2f4cda[_0x38b3a7(0x161)]({'botID':_0x38b3a7(0x188)});let _0x2c0c56=[],_0x4b4520=[];const _0x3daa98=_0x2f4cda[_0x38b3a7(0x16f)]%0x4==0x0||_0x2f4cda[_0x38b3a7(0x16f)]%0x4==0x3||_0x2f4cda[_0x38b3a7(0x16f)]%0x3==0x1?0x4:0x3;let _0x486d5e=0x0;_0x2f4cda[_0x38b3a7(0x144)]((_0x2d5039,_0x272492)=>{const _0x105d04=_0x38b3a7;if(_0x272492%_0x3daa98==0x0)_0x4b4520=[];_0x4b4520[_0x105d04(0x161)](Markup[_0x105d04(0x12b)][_0x105d04(0x233)](_0x2d5039['botID']=='all'?'All\x20bots':'Bot\x20'+_0x2d5039[_0x105d04(0xfc)],'off_'+_0x2d5039['botID'])),_0x272492%_0x3daa98==0x0&&(_0x2c0c56[_0x486d5e]=_0x4b4520,_0x486d5e++);});const _0xd04483=Markup['inlineKeyboard'](_0x2c0c56);_0x5616fc[_0x38b3a7(0x241)](_0x38b3a7(0x206),_0xd04483);}}),tgBot[_0x42aa95(0x259)](/off_(.+)/,async _0x32a7dd=>{const _0x400620=_0x42aa95,_0x171914=_0x32a7dd[_0x400620(0x1a3)][0x1];_0x32a7dd[_0x400620(0x169)]();if(_0x171914==_0x400620(0x188)){const _0x31c8dd=getEnabledBots();await sendTelegram(_0x32a7dd[_0x400620(0x286)]['id'],_0x400620(0x1c1)),_0x31c8dd[_0x400620(0x144)](_0x51882c=>{const _0x43ca96=_0x400620;if(_0x51882c[_0x43ca96(0xfc)]!=_0x43ca96(0x188))toggleBot(_0x51882c[_0x43ca96(0xfc)],toggleStatus(_0x51882c['botID']),'stopped');});}else await sendTelegram(_0x32a7dd[_0x400620(0x286)]['id'],_0x400620(0x208)+_0x171914),toggleBot(_0x171914,toggleStatus(_0x171914),_0x400620(0x1d7));}),tgBot[_0x42aa95(0x23e)](_0x42aa95(0x20d),async _0x27942d=>{const _0x491e55=_0x42aa95,_0x94602=getEnabledBots();if(_0x94602[_0x491e55(0x16f)]==0x0)await sendTelegram(_0x27942d[_0x491e55(0x286)]['id'],_0x491e55(0x184));else{if(_0x94602[_0x491e55(0x16f)]>0x1){let _0x3e3f07=[],_0xc9cbe0=[];const _0x161fed=_0x94602['length']%0x4==0x0||_0x94602[_0x491e55(0x16f)]%0x4==0x3||_0x94602['length']%0x3==0x1?0x4:0x3;let _0x44747f=0x0;_0x94602[_0x491e55(0x144)]((_0x494bb3,_0x1d756c)=>{const _0x27ec84=_0x491e55;if(_0x1d756c%_0x161fed==0x0)_0xc9cbe0=[];_0xc9cbe0[_0x27ec84(0x161)](Markup[_0x27ec84(0x12b)]['callback']('Bot\x20'+_0x494bb3[_0x27ec84(0xfc)],_0x27ec84(0x17e)+_0x494bb3['botID'])),_0x1d756c%_0x161fed==0x0&&(_0x3e3f07[_0x44747f]=_0xc9cbe0,_0x44747f++);});const _0x35744e=Markup['inlineKeyboard'](_0x3e3f07);_0x27942d[_0x491e55(0x241)](_0x491e55(0x1dc),_0x35744e);}else{const _0x171167=_0x94602[0x0][_0x491e55(0xfc)];if(pid[_0x171167])pid[_0x171167][_0x491e55(0x1e7)]({'function':_0x491e55(0x23c),'args':null});}}}),tgBot[_0x42aa95(0x259)](/metrics_(.+)/,async _0x505913=>{const _0x526121=_0x42aa95,_0x272fc3=_0x505913[_0x526121(0x1a3)][0x1];_0x505913[_0x526121(0x169)]();if(pid[_0x272fc3])pid[_0x272fc3]['send']({'function':_0x526121(0x23c),'args':null});}),tgBot[_0x42aa95(0x23e)](_0x42aa95(0x16e),async _0x275627=>{const _0x93136b=_0x42aa95,_0x2f8f21=getEnabledBots();if(_0x2f8f21[_0x93136b(0x16f)]==0x0)await sendTelegram(_0x275627[_0x93136b(0x286)]['id'],_0x93136b(0x184));else{if(_0x2f8f21[_0x93136b(0x16f)]>0x1){let _0x4cbfb6=[],_0x3133f3=[];const _0x39bc2a=_0x2f8f21[_0x93136b(0x16f)]%0x4==0x0||_0x2f8f21[_0x93136b(0x16f)]%0x4==0x3||_0x2f8f21['length']%0x3==0x1?0x4:0x3;let _0x212f89=0x0;_0x2f8f21['forEach']((_0x581e55,_0x5d6310)=>{const _0x472819=_0x93136b;if(_0x5d6310%_0x39bc2a==0x0)_0x3133f3=[];_0x3133f3[_0x472819(0x161)](Markup[_0x472819(0x12b)][_0x472819(0x233)](_0x472819(0x247)+_0x581e55[_0x472819(0xfc)],_0x472819(0x1e2)+_0x581e55[_0x472819(0xfc)])),_0x5d6310%_0x39bc2a==0x0&&(_0x4cbfb6[_0x212f89]=_0x3133f3,_0x212f89++);});const _0x37131a=Markup[_0x93136b(0x1fc)](_0x4cbfb6);_0x275627[_0x93136b(0x241)](_0x93136b(0x28d),_0x37131a);}else{const _0x3f7198=_0x2f8f21[0x0][_0x93136b(0xfc)];if(pid[_0x3f7198])pid[_0x3f7198][_0x93136b(0x1e7)]({'function':_0x93136b(0x19e),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0xf6b77c=>{const _0x10dc32=_0x42aa95,_0x5125d9=_0xf6b77c[_0x10dc32(0x1a3)][0x1];_0xf6b77c['editMessageReplyMarkup']();if(pid[_0x5125d9])pid[_0x5125d9][_0x10dc32(0x1e7)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x42aa95(0x23e)](_0x42aa95(0x29b),async _0x1e8a9d=>{const _0x44396a=_0x42aa95;await getMessages();if(!updateAvailable)await sendTelegram(_0x1e8a9d[_0x44396a(0x286)]['id'],_0x44396a(0x172));else{if(!validInstallation)await sendTelegram(_0x1e8a9d['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x20486e=Markup['inlineKeyboard']([Markup[_0x44396a(0x12b)][_0x44396a(0x233)](_0x44396a(0x17f),_0x44396a(0x214)),Markup[_0x44396a(0x12b)][_0x44396a(0x233)]('No',_0x44396a(0x18f))]);_0x1e8a9d[_0x44396a(0x241)](_0x44396a(0x13a),_0x20486e);}}}),tgBot[_0x42aa95(0x259)](/update_(.+)/,async _0xd49ed6=>{const _0x218842=_0x42aa95,_0x42aed6=_0xd49ed6['match'][0x1];_0xd49ed6['editMessageReplyMarkup'](),_0x42aed6==_0x218842(0x22a)&&(await sendTelegram(_0xd49ed6[_0x218842(0x286)]['id'],_0x218842(0x16d)),updateBB(_0x218842(0x29b))),_0x42aed6=='no'&&await sendTelegram(_0xd49ed6[_0x218842(0x286)]['id'],_0x218842(0x2c0));}),tgBot[_0x42aa95(0x23e)](_0x42aa95(0x248),async _0x3d2fdf=>{const _0x345d3c=_0x42aa95;if(!validInstallation)await sendTelegram(_0x3d2fdf[_0x345d3c(0x286)]['id'],_0x345d3c(0x1cd));else{const _0xc7c3a0=Markup[_0x345d3c(0x1fc)]([Markup[_0x345d3c(0x12b)]['callback'](_0x345d3c(0x17f),'reinstall_yes'),Markup[_0x345d3c(0x12b)][_0x345d3c(0x233)]('No','reinstall_no')]);_0x3d2fdf['reply'](_0x345d3c(0x181),_0xc7c3a0);}}),tgBot[_0x42aa95(0x259)](/reinstall_(.+)/,async _0x6e7439=>{const _0x1ef04e=_0x42aa95,_0xc72b47=_0x6e7439[_0x1ef04e(0x1a3)][0x1];_0x6e7439['editMessageReplyMarkup'](),_0xc72b47=='yes'&&(await sendTelegram(_0x6e7439[_0x1ef04e(0x286)]['id'],_0x1ef04e(0x11c)),updateBB(_0x1ef04e(0x248))),_0xc72b47=='no'&&await sendTelegram(_0x6e7439[_0x1ef04e(0x286)]['id'],_0x1ef04e(0x227));}),tgBot[_0x42aa95(0x23e)](_0x42aa95(0x1de),async _0x16669d=>{const _0x36a09e=_0x42aa95,_0x4c81e3=getBotsWithMode();if(_0x4c81e3[_0x36a09e(0x16f)]==0x0)await sendTelegram(_0x16669d[_0x36a09e(0x286)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x2703d9=[],_0x326fb1=[];const _0x4fc050=0x2;let _0x383d0d=0x0;_0x4c81e3[_0x36a09e(0x144)]((_0x33e6ae,_0x3b6e69)=>{const _0x1144ca=_0x36a09e;if(_0x3b6e69%_0x4fc050==0x0)_0x326fb1=[];_0x326fb1['push'](Markup[_0x1144ca(0x12b)][_0x1144ca(0x233)](_0x1144ca(0x247)+_0x33e6ae[_0x1144ca(0xfc)]+'\x20('+_0x33e6ae[_0x1144ca(0x1b5)]+')',_0x1144ca(0x29c)+_0x33e6ae[_0x1144ca(0xfc)])),_0x3b6e69%_0x4fc050==0x0&&(_0x2703d9[_0x383d0d]=_0x326fb1,_0x383d0d++);});const _0x43122d=Markup[_0x36a09e(0x1fc)](_0x2703d9);_0x16669d[_0x36a09e(0x241)](_0x36a09e(0x20b),_0x43122d);}}),tgBot[_0x42aa95(0x259)](/toggle_(.+)/,async _0x5769aa=>{const _0x4f1df5=_0x42aa95,_0x97a620=_0x5769aa[_0x4f1df5(0x1a3)][0x1];_0x5769aa['editMessageReplyMarkup']();const _0x39da4d=getBotsWithMode(),_0x1319cf=_0x39da4d['find'](_0x2a37d9=>_0x2a37d9[_0x4f1df5(0xfc)]==_0x97a620),_0x8cf487=_0x1319cf['mode']==_0x4f1df5(0x239)?_0x4f1df5(0x26f):_0x4f1df5(0x239);await sendTelegram(_0x5769aa[_0x4f1df5(0x286)]['id'],_0x4f1df5(0x145)+_0x97a620+_0x4f1df5(0x17d)+_0x8cf487+_0x4f1df5(0x262)),toggleBotMode(_0x97a620);}),tgBot[_0x42aa95(0x23e)](_0x42aa95(0x1c7),async _0x101c06=>{const _0x4be3a4=_0x42aa95;let _0x49bcf5='';config[_0x4be3a4(0x144)](_0x7678dc=>{const _0x42ea69=_0x4be3a4;_0x49bcf5+=_0x42ea69(0x247)+_0x7678dc[_0x42ea69(0xfc)]+':\x20'+_0x7678dc[_0x42ea69(0x268)]+'\x0a';}),await sendTelegram(_0x101c06['chat']['id'],_0x49bcf5,{'parse_mode':_0x4be3a4(0x2c2)});}),tgBot[_0x42aa95(0x23e)](_0x42aa95(0x25d),async _0x53aae8=>{const _0xbdb4ff=_0x42aa95;await sendTelegram(_0x53aae8[_0xbdb4ff(0x286)]['id'],_0x3c7d94);}),process[_0x42aa95(0x1ac)](_0x42aa95(0x151),()=>tgBot[_0x42aa95(0x115)](_0x42aa95(0x151))),process[_0x42aa95(0x1ac)]('SIGTERM',()=>tgBot[_0x42aa95(0x115)]('SIGTERM')),tgBot[_0x42aa95(0x2e1)]();}}function disableTelegram(){const _0x6f49f3=_0xfbfeb9;tgBot&&tgBot[_0x6f49f3(0x115)]();}async function sendTelegram(_0x2d04e3,_0x3bee08,_0x40612c){const _0x1de79f=_0xfbfeb9;try{await tgBot[_0x1de79f(0x111)][_0x1de79f(0x130)](_0x2d04e3,_0x3bee08,_0x40612c);}catch(_0x473163){console[_0x1de79f(0x182)](_0x1de79f(0x1e3),_0x473163);}}async function sendTelegramBot(_0xdeb07f,_0x4a70e8){const _0x2b1b9e=_0xfbfeb9;if(settings['telegramEnabled']){if(settings[_0x2b1b9e(0x224)]==_0x2b1b9e(0x188)||(_0x4a70e8['type']==_0x2b1b9e(0x14a)||_0x4a70e8[_0x2b1b9e(0x2bf)]=='warning'||_0x4a70e8[_0x2b1b9e(0x2bf)]==_0x2b1b9e(0x26a))&&settings[_0x2b1b9e(0x224)]==_0x2b1b9e(0x294)||_0x4a70e8['type']=='order'&&settings[_0x2b1b9e(0x224)]=='orders'){if(tgBot&&settings[_0x2b1b9e(0x11b)]){if(_0x4a70e8['showname'])await sendTelegram(settings[_0x2b1b9e(0x11b)],_0x4a70e8['botname']+_0x2b1b9e(0x1d5)+_0x4a70e8['event']);else await sendTelegram(settings[_0x2b1b9e(0x11b)],'Bot\x20'+_0xdeb07f+'\x20>\x20'+_0x4a70e8[_0x2b1b9e(0x2b3)]);}}}}async function sendTelegramMsg(_0x12a2a8,_0x453b9c='HTML'){const _0x1b949a=_0xfbfeb9;return settings[_0x1b949a(0x27e)]&&tgBot&&settings[_0x1b949a(0x11b)]?(await sendTelegram(settings[_0x1b949a(0x11b)],_0x12a2a8,{'parse_mode':_0x453b9c}),!![]):![];}function getDeviceWithIp(_0x2ccf75){return devices['find'](_0x4917f4=>_0x4917f4['ip']===_0x2ccf75);}async function temporaryAccess2FA(_0x22b16f,_0x2db713){const _0x4ad36f=_0xfbfeb9;let _0x2ed968=new Date(),_0x4fde69=![];if(lastIpApproval){if(_0x2ed968-lastIpApproval<0x1388)_0x4fde69=!![];}lastIpApproval=new Date();if(_0x4fde69)return;if(tgBot&&settings[_0x4ad36f(0x11b)]){const _0x1aeb03=uuidRandom();tmpStorage[_0x1aeb03]={'uuid':_0x22b16f,'externalip':_0x2db713};const _0x16eb0b=Markup[_0x4ad36f(0x1fc)]([Markup['button'][_0x4ad36f(0x233)](_0x4ad36f(0x1ef),_0x4ad36f(0x25b)+_0x1aeb03),Markup[_0x4ad36f(0x12b)]['callback'](_0x4ad36f(0x142),'tempaccess_15_'+_0x1aeb03),Markup['button']['callback'](_0x4ad36f(0x10a),_0x4ad36f(0x12a)+_0x1aeb03),Markup[_0x4ad36f(0x12b)][_0x4ad36f(0x233)]('reject',_0x4ad36f(0x2e0)+_0x1aeb03)]);await sendTelegram(settings[_0x4ad36f(0x11b)],_0x4ad36f(0x19a)+normalizeIP(_0x2db713)[_0x4ad36f(0x23b)]+'\x20?',_0x16eb0b),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x2fe7c=>{const _0x1ae7b9=_0x4ad36f,_0x31785a=_0x2fe7c[_0x1ae7b9(0x1a3)][0x1],_0x1e6a4d=_0x2fe7c[_0x1ae7b9(0x1a3)][0x2],{uuid:_0x1f1539,externalip:_0x147eba}=tmpStorage[_0x1e6a4d];delete tmpStorage[_0x1e6a4d],_0x2fe7c[_0x1ae7b9(0x169)](),devices[_0x1f1539][_0x1ae7b9(0x2ce)]={'clientip':_0x147eba,'timestamp':new Date()['getTime'](),'expiry':_0x31785a},_0x31785a!='reject'?(await sendTelegram(_0x2fe7c[_0x1ae7b9(0x286)]['id'],'Access\x20enabled\x20for\x20'+_0x31785a+_0x1ae7b9(0x15a),{'parse_mode':_0x1ae7b9(0x2c2)}),io['to'](_0x1f1539)[_0x1ae7b9(0x1bf)]('status',{'access':{'allow':![],'reason':_0x1ae7b9(0x1ed),'token':null}})):(await sendTelegram(_0x2fe7c[_0x1ae7b9(0x286)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x1f1539)[_0x1ae7b9(0x1bf)](_0x1ae7b9(0x2d0),{'access':{'allow':![],'reason':_0x1ae7b9(0x2a8),'token':null}}));});}}async function loginAccess2FA(_0x1a7c44,_0xb3499e){const _0x4856ee=_0xfbfeb9;if(tgBot&&settings[_0x4856ee(0x11b)]){const _0x1e95c6=uuidRandom();tmpStorage[_0x1e95c6]={'uuid':_0x1a7c44,'externalip':_0xb3499e};const _0xb75b88=Markup[_0x4856ee(0x1fc)]([Markup[_0x4856ee(0x12b)]['callback'](_0x4856ee(0x26e),'login2fa_'+loginExpiry+'_'+_0x1e95c6),Markup[_0x4856ee(0x12b)][_0x4856ee(0x233)](_0x4856ee(0x176),_0x4856ee(0x288)+_0x1e95c6)]);await sendTelegram(settings[_0x4856ee(0x11b)],_0x4856ee(0x1a9)+normalizeIP(_0xb3499e)['show']+'\x20?',_0xb75b88),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x4637bc=>{const _0x47ac5c=_0x4856ee,_0x2b0093=_0x4637bc[_0x47ac5c(0x1a3)][0x1],_0x4eb362=_0x4637bc['match'][0x2],{uuid:_0x1b25dd,externalip:_0x3981c1}=tmpStorage[_0x4eb362];delete tmpStorage[_0x4eb362],_0x4637bc[_0x47ac5c(0x169)](),devices[_0x1b25dd][_0x47ac5c(0x1da)]={'clientip':_0x3981c1,'timestamp':new Date()[_0x47ac5c(0x24e)](),'expiry':_0x2b0093},_0x2b0093!=_0x47ac5c(0x176)?(await sendTelegram(_0x4637bc['chat']['id'],'Login\x20accepted',{'parse_mode':'HTML'}),io['to'](_0x1b25dd)[_0x47ac5c(0x1bf)]('status',{'access':{'allow':![],'reason':_0x47ac5c(0x1ed),'token':null}})):(await sendTelegram(_0x4637bc[_0x47ac5c(0x286)]['id'],_0x47ac5c(0x113)),io['to'](_0x1b25dd)[_0x47ac5c(0x1bf)](_0x47ac5c(0x2d0),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4331c5=_0xfbfeb9;return dbConfig[_0x4331c5(0xf3)]('bots')[_0x4331c5(0x2ac)](_0x4331c5(0xfc))['filter']({'status':_0x4331c5(0x15f)})[_0x4331c5(0x225)]()||[];}function getDisabledBots(){const _0x815bad=_0xfbfeb9;return dbConfig[_0x815bad(0xf3)]('bots')[_0x815bad(0x2ac)]('botID')[_0x815bad(0x152)]({'status':_0x815bad(0x1fd)})[_0x815bad(0x225)]()||[];}function getBotAttributes(_0x2b760f){const _0x340678=_0xfbfeb9;let _0x355f36={};const _0x2925d4=configpath+'bot-'+_0x2b760f+_0x340678(0x293),_0x49811b=fs['existsSync'](_0x2925d4);if(_0x49811b){const _0x4e657f=fs[_0x340678(0x1f9)](_0x2925d4);try{const _0x1bea39=JSON[_0x340678(0x28e)](_0x4e657f),_0x54bc73=_0x1bea39?_0x1bea39['bot'][0x0][_0x340678(0x29d)]:![];_0x355f36[_0x340678(0x1b5)]=_0x54bc73?_0x340678(0x239):_0x340678(0x26f),_0x355f36[_0x340678(0x268)]=_0x1bea39?_0x1bea39[_0x340678(0x221)][0x0][_0x340678(0x268)]:'Bot\x20'+_0x2b760f;}catch(_0x2a6c6a){_0x355f36[_0x340678(0x1b5)]=_0x340678(0x26f),_0x355f36[_0x340678(0x268)]=_0x340678(0x247)+_0x2b760f;}}else _0x355f36[_0x340678(0x1b5)]=_0x340678(0x26f),_0x355f36[_0x340678(0x268)]='Bot\x20'+_0x2b760f;return _0x355f36;}function getBotsWithMode(){const _0x24c626=_0xfbfeb9,_0x268e63=dbConfig[_0x24c626(0xf3)]('bots')[_0x24c626(0x2ac)]('botID')[_0x24c626(0x225)]()||[];return _0x268e63[_0x24c626(0x144)](_0xb4e3ce=>{const _0x174cda=_0x24c626;let _0x424a2c=getBotAttributes(_0xb4e3ce[_0x174cda(0xfc)]);_0xb4e3ce[_0x174cda(0x1b5)]=_0x424a2c[_0x174cda(0x1b5)];}),_0x268e63;}function getBotExchanges(){const _0x103ae4=_0xfbfeb9;let _0x3f4cf0=[];const _0x4cca67=dbConfig[_0x103ae4(0xf3)]('bots')[_0x103ae4(0x2ac)](_0x103ae4(0xfc))[_0x103ae4(0x225)]()||[];_0x4cca67[_0x103ae4(0x144)](_0x5283e=>{const _0x4842af=_0x103ae4;if(_0x5283e['status']=='enabled'){const _0x159973=configpath+_0x4842af(0x21c)+_0x5283e[_0x4842af(0xfc)]+'-config.json',_0x197f09=fs[_0x4842af(0x281)](_0x159973);let _0x55c803;if(_0x197f09){const _0x3e1205=fs[_0x4842af(0x1f9)](_0x159973);try{const _0x3196fd=JSON[_0x4842af(0x28e)](_0x3e1205);_0x55c803=_0x3196fd?_0x3196fd[_0x4842af(0x221)][0x0][_0x4842af(0x271)]:null;}catch(_0xab479b){}}if(_0x55c803)_0x3f4cf0[_0x4842af(0x161)](_0x55c803);}});const _0x3cfb98=[...new Set(_0x3f4cf0)][_0x103ae4(0x174)]();return _0x3cfb98;}async function initUser(){const _0x4b0a33=_0xfbfeb9;if(!settings[_0x4b0a33(0x199)]){const _0x138343=uuidRandom();mixpanel[_0x4b0a33(0x2c9)](_0x138343),updateSetting(_0x4b0a33(0x199),_0x138343);}}async function initSecure(){const _0x179ace=_0xfbfeb9;let _0x100e27=getSecure();if(!_0x100e27[_0x179ace(0x243)](_0x179ace(0x129))){let _0x56094e=await generateKeys();_0x100e27['publicKey']=_0x56094e[_0x179ace(0x120)],_0x100e27[_0x179ace(0x187)]=_0x56094e[_0x179ace(0x187)],_0x100e27[_0x179ace(0x129)]=crypto[_0x179ace(0x1c5)](0x20)[_0x179ace(0x11a)]('hex');;storeSecure(_0x100e27);}}function getSettings(){const _0x222b0f=_0xfbfeb9;return dbSettings[_0x222b0f(0xf3)](_0x222b0f(0x2c3))[_0x222b0f(0x225)]()||{};}function getSecure(){const _0x3cc03d=_0xfbfeb9;return dbSecure[_0x3cc03d(0xf3)](_0x3cc03d(0x2b8))[_0x3cc03d(0x225)]()||{};}function getBlacklist(){const _0x4472c0=_0xfbfeb9;return dbSecure['get'](_0x4472c0(0x28c))[_0x4472c0(0x225)]()||[];}function broadcastToBots(_0x58f481,_0x16cbb0){const _0x120fdc=_0xfbfeb9;config[_0x120fdc(0x144)](_0x187816=>{const _0x59db69=_0x120fdc;if(_0x187816[_0x59db69(0x2d0)]==_0x59db69(0x15f)&&_0x187816['live']==_0x59db69(0x1b6)||_0x187816[_0x59db69(0x2d0)]=='new'&&_0x187816[_0x59db69(0x266)]==_0x59db69(0x1b6)){if(pid[_0x187816[_0x59db69(0xfc)]])pid[_0x187816[_0x59db69(0xfc)]][_0x59db69(0x1e7)]({[_0x58f481]:_0x16cbb0});}});}function storeSettings(_0x5c1c5c,_0x4cc195=![]){const _0x57170c=_0xfbfeb9;_0x5c1c5c={...settings,..._0x5c1c5c};if(_0x4cc195&&_0x5c1c5c[_0x57170c(0x159)]!='************'&&_0x5c1c5c[_0x57170c(0x159)]!=_0x57170c(0x1ca)&&_0x5c1c5c[_0x57170c(0x159)]!=''){const _0x3a09a8=crypt[_0x57170c(0x101)](secure[_0x57170c(0x187)],_0x5c1c5c[_0x57170c(0x159)])[_0x57170c(0x2a6)][_0x57170c(0x201)]('@')[0x0],_0x2792d9=bcrypt[_0x57170c(0x2e3)](_0x3a09a8,saltRounds);_0x5c1c5c={..._0x5c1c5c,'bbPassword':_0x2792d9};}if(_0x4cc195&&_0x5c1c5c['telegramToken']!=_0x57170c(0x137)&&_0x5c1c5c['telegramToken']!=_0x57170c(0x1ca)&&_0x5c1c5c[_0x57170c(0x22d)]!=''){const _0x611c10=crypt[_0x57170c(0x101)](secure[_0x57170c(0x187)],_0x5c1c5c[_0x57170c(0x22d)])[_0x57170c(0x2a6)][_0x57170c(0x201)]('@')[0x0];_0x5c1c5c={..._0x5c1c5c,'telegramToken':_0x611c10};}const _0x358e97=_0x5c1c5c[_0x57170c(0x22d)]!=_0x57170c(0x137)&&_0x5c1c5c[_0x57170c(0x22d)]!=settings[_0x57170c(0x22d)]||_0x5c1c5c[_0x57170c(0x2d2)]!=settings[_0x57170c(0x2d2)],_0x481ccc=_0x5c1c5c[_0x57170c(0x22d)]==''||_0x5c1c5c[_0x57170c(0x2d2)]=='';_0x358e97&&(_0x5c1c5c[_0x57170c(0x11b)]=null,_0x5c1c5c[_0x57170c(0x224)]=_0x57170c(0x188));for(const [_0x1aa1ce,_0x13bdf3]of Object[_0x57170c(0x267)](_0x5c1c5c)){if(_0x1aa1ce=='telegramToken'&&_0x13bdf3==_0x57170c(0x137)){_0x5c1c5c[_0x57170c(0x22d)]=settings[_0x57170c(0x22d)];continue;};if(_0x1aa1ce==_0x57170c(0x159)&&_0x13bdf3=='************'){_0x5c1c5c['bbPassword']=settings[_0x57170c(0x159)];continue;};dbSettings[_0x57170c(0x1ae)](_0x57170c(0x25a)+_0x1aa1ce,_0x13bdf3)[_0x57170c(0x1d9)]();}settings=_0x5c1c5c,io['to'](_0x57170c(0x1b7))[_0x57170c(0x1bf)](_0x57170c(0x2c3),cleanSettings()),broadcastToBots('timeshift',settings[_0x57170c(0x1f8)]),broadcastToBots(_0x57170c(0x242),settings[_0x57170c(0x242)]);if(_0x358e97&&!_0x481ccc)initTelegram();if(_0x358e97&&_0x481ccc)disableTelegram();getAllClients()['forEach'](_0x2972c9=>{const _0x375e71=_0x57170c;getSocket(_0x2972c9['id'])[_0x375e71(0x1bf)](_0x375e71(0x2d0),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x84683e,_0x52bf4f){const _0x18bbc4=_0xfbfeb9;dbSettings[_0x18bbc4(0x1ae)](_0x18bbc4(0x25a)+_0x84683e,_0x52bf4f)[_0x18bbc4(0x1d9)](),settings=getSettings(),io['to'](_0x18bbc4(0x1b7))[_0x18bbc4(0x1bf)](_0x18bbc4(0x2c3),cleanSettings());}function storeSecure(_0x5b431c){const _0x2c8f6b=_0xfbfeb9;dbSecure[_0x2c8f6b(0xf3)]('secure')[_0x2c8f6b(0x161)](_0x5b431c)['write'](),secure=_0x5b431c;}function addBlacklist(_0x666b0b){const _0x5729d2=_0xfbfeb9;cleanBlacklist();let _0x49032e;devices[_0x666b0b][_0x5729d2(0x2ce)]?_0x49032e=Math[_0x5729d2(0x128)](devices[_0x666b0b][_0x5729d2(0x2ce)][_0x5729d2(0x1a8)],loginExpiry):_0x49032e=loginExpiry,dbSecure['get']('blacklist')[_0x5729d2(0x161)]({'expiry':new Date()['getTime']()+_0x49032e*0x3c*0x3e8,'token':devices[_0x666b0b][_0x5729d2(0x244)][_0x5729d2(0x1a4)]})[_0x5729d2(0x1d9)](),blacklist=dbSecure[_0x5729d2(0xf3)](_0x5729d2(0x28c))['value']();}function cleanBlacklist(){const _0x4dcdd4=_0xfbfeb9;let _0x2ddaa0=dbSecure['get'](_0x4dcdd4(0x28c))[_0x4dcdd4(0x178)]()[_0x4dcdd4(0x225)](),_0xf2c532=new Date()[_0x4dcdd4(0x24e)]();_0x2ddaa0['forEach'](_0x5f0e05=>{const _0x825c83=_0x4dcdd4;_0x5f0e05[_0x825c83(0x1a8)]<_0xf2c532&&dbSecure[_0x825c83(0xf3)]('blacklist')[_0x825c83(0x22f)]({'expiry':_0x5f0e05[_0x825c83(0x1a8)]})[_0x825c83(0x1d9)]();});}function initStates(){let _0x3518f2=getConfiguration();_0x3518f2['forEach'](_0x1c7ffc=>{const _0x50c890=_0x2b31;_0x1c7ffc[_0x50c890(0x266)]=_0x50c890(0x1d7);}),storeConfiguration(_0x3518f2);}function onKeys(){const _0x538f8a=new RSA();return new Promise(_0x3bea1a=>{const _0x4b5620=_0x2b31;_0x538f8a[_0x4b5620(0x186)]()[_0x4b5620(0x10f)](_0x2b782b=>{_0x3bea1a(_0x2b782b);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1b33d6=_0xfbfeb9;let _0x1743b9=getSettings(),_0x36f3e8=![];!_0x1743b9['hasOwnProperty'](_0x1b33d6(0x26b))&&(_0x1743b9['lastmsgtelegram']=0x0,_0x36f3e8=!![]);!_0x1743b9['hasOwnProperty'](_0x1b33d6(0x27a))&&(_0x1743b9[_0x1b33d6(0x27a)]=0x0,_0x36f3e8=!![]);!_0x1743b9[_0x1b33d6(0x243)]('latestversion')&&(_0x1743b9[_0x1b33d6(0x121)]=_0x1b33d6(0x196),_0x36f3e8=!![]);!_0x1743b9[_0x1b33d6(0x243)](_0x1b33d6(0x242))&&(_0x1743b9[_0x1b33d6(0x242)]=![],_0x36f3e8=!![]);if(_0x36f3e8)storeSettings(_0x1743b9);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x1b33d6(0x144)](_0x1e7aae=>{const _0x4e2fe6=_0x1b33d6;if(!_0x1e7aae[_0x4e2fe6(0x255)]()){if(!_0x1e7aae[_0x4e2fe6(0x2a2)][_0x4e2fe6(0x22e)]('backup-full@'))fs[_0x4e2fe6(0x104)](configbackuppath+_0x1e7aae[_0x4e2fe6(0x2a2)]);}else fs['rmSync'](configbackuppath+_0x1e7aae[_0x4e2fe6(0x2a2)],{'recursive':!![]});});}catch(_0xac166b){logger[_0x1b33d6(0x2c4)]('Error\x20removing\x20old\x20backup\x20files:',_0xac166b);}}function storeConfiguration(_0xd8ee82){const _0x594fb7=_0xfbfeb9;dbConfig[_0x594fb7(0xf3)]('bots')[_0x594fb7(0x22f)]()['write'](),dbConfig[_0x594fb7(0xf3)](_0x594fb7(0x154))['push'](..._0xd8ee82)[_0x594fb7(0x1d9)](),config=_0xd8ee82;}async function resetPassword(){const _0xa63115=_0xfbfeb9;if(tgBot&&settings[_0xa63115(0x11b)]){const _0x531f43=Markup['inlineKeyboard']([Markup[_0xa63115(0x12b)][_0xa63115(0x233)](_0xa63115(0x22a),'resetpw_yes'),Markup[_0xa63115(0x12b)][_0xa63115(0x233)]('no',_0xa63115(0xfb))]);await sendTelegram(settings[_0xa63115(0x11b)],_0xa63115(0x141),_0x531f43),tgBot[_0xa63115(0x259)](/resetpw_(.+)/,async _0x1a78b3=>{const _0x13a2b3=_0xa63115,_0x21f2c3=_0x1a78b3[_0x13a2b3(0x1a3)][0x1];_0x1a78b3[_0x13a2b3(0x169)]();if(_0x21f2c3!='no'){const _0x247e90=0xf,_0x1ab535=_0x13a2b3(0x292),_0x359be2=Array[_0x13a2b3(0x220)](crypto[_0x13a2b3(0x2da)](new Uint32Array(_0x247e90)))[_0x13a2b3(0x100)](_0x2cf808=>_0x1ab535[_0x2cf808%_0x1ab535[_0x13a2b3(0x16f)]])[_0x13a2b3(0x147)](''),_0x3c0de1=bcrypt['hashSync'](_0x359be2,saltRounds);storeSettings({'bbPassword':_0x3c0de1}),await sendTelegram(_0x1a78b3[_0x13a2b3(0x286)]['id'],_0x13a2b3(0x254)+_0x359be2,{'parse_mode':'HTML'});}else await sendTelegram(_0x1a78b3['chat']['id'],_0x13a2b3(0x11d));});}}async function confirmRestore(_0xd02150,_0x2ef463){const _0x59fdbc=_0xfbfeb9;io['to'](_0x59fdbc(0x1b7))['emit'](_0x59fdbc(0x2d5),_0x59fdbc(0x168),'success');if(tgBot&&settings['telegramChatId']){const _0x47bfcf=uuidRandom();tmpStorage[_0x47bfcf]={'path':_0xd02150,'filename':_0x2ef463};const _0xbb28a=Markup[_0x59fdbc(0x1fc)]([Markup[_0x59fdbc(0x12b)][_0x59fdbc(0x233)]('yes',_0x59fdbc(0x1a6)+_0x47bfcf),Markup['button'][_0x59fdbc(0x233)]('no',_0x59fdbc(0x166)+_0x47bfcf)]);await sendTelegram(settings[_0x59fdbc(0x11b)],_0x59fdbc(0x180),_0xbb28a),tgBot[_0x59fdbc(0x259)](/restore_(.+)_(.+)/,async _0x39af66=>{const _0x13001e=_0x59fdbc,_0x1acb65=_0x39af66[_0x13001e(0x1a3)][0x1],_0x2664cc=_0x39af66[_0x13001e(0x1a3)][0x2],{path:_0x143412,filename:_0x48aa56}=tmpStorage[_0x2664cc];delete tmpStorage[_0x2664cc],_0x39af66[_0x13001e(0x169)](),_0x1acb65==_0x13001e(0x22a)?(logger['debug'](_0x13001e(0x14d)),await sendTelegram(_0x39af66[_0x13001e(0x286)]['id'],_0x13001e(0x2c5),{'parse_mode':_0x13001e(0x2c2)}),unzipFile(_0x143412,_0x48aa56)):(logger[_0x13001e(0x2c4)]('Restore\x20process\x20aborted'),await sendTelegram(_0x39af66[_0x13001e(0x286)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x58d921=_0xfbfeb9,_0x51e369=new Date();return _0x51e369[_0x58d921(0x12d)]()+'/'+(_0x51e369[_0x58d921(0x119)]()+0x1)[_0x58d921(0x11a)]()[_0x58d921(0x127)](0x2,'0')+'/'+_0x51e369[_0x58d921(0x1b2)]()['toString']()[_0x58d921(0x127)](0x2,'0')+'\x20'+_0x51e369[_0x58d921(0x2ba)]()['toString']()[_0x58d921(0x127)](0x2,'0')+':'+_0x51e369[_0x58d921(0x28f)]()[_0x58d921(0x11a)]()[_0x58d921(0x127)](0x2,'0')+':'+_0x51e369['getSeconds']()[_0x58d921(0x11a)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x32775e=_0xfbfeb9,_0x5f591c=shiftedTime();return _0x5f591c['getFullYear']()+'/'+(_0x5f591c[_0x32775e(0x119)]()+0x1)[_0x32775e(0x11a)]()[_0x32775e(0x127)](0x2,'0')+'/'+_0x5f591c['getDate']()[_0x32775e(0x11a)]()[_0x32775e(0x127)](0x2,'0')+'\x20'+_0x5f591c[_0x32775e(0x2ba)]()[_0x32775e(0x11a)]()['padStart'](0x2,'0')+':'+_0x5f591c[_0x32775e(0x28f)]()['toString']()[_0x32775e(0x127)](0x2,'0')+':'+_0x5f591c[_0x32775e(0x164)]()[_0x32775e(0x11a)]()[_0x32775e(0x127)](0x2,'0');}function getCleanTimeStamp(){const _0x1cdc23=_0xfbfeb9,_0x1ea224=shiftedTime();return _0x1ea224[_0x1cdc23(0x12d)]()+(_0x1ea224[_0x1cdc23(0x119)]()+0x1)[_0x1cdc23(0x11a)]()[_0x1cdc23(0x127)](0x2,'0')+_0x1ea224[_0x1cdc23(0x1b2)]()[_0x1cdc23(0x11a)]()[_0x1cdc23(0x127)](0x2,'0')+'-'+_0x1ea224['getHours']()[_0x1cdc23(0x11a)]()[_0x1cdc23(0x127)](0x2,'0')+_0x1ea224[_0x1cdc23(0x28f)]()[_0x1cdc23(0x11a)]()['padStart'](0x2,'0')+_0x1ea224[_0x1cdc23(0x164)]()['toString']()[_0x1cdc23(0x127)](0x2,'0');}function shiftedTime(){const _0x22ad4e=_0xfbfeb9,_0x3178df=new Date();let _0x192d0d=_0x3178df;if(settings[_0x22ad4e(0x1f8)]&&settings[_0x22ad4e(0x1f8)]!==0x0)_0x192d0d=fns['add'](_0x3178df,{'hours':settings['timeshift']});return _0x192d0d;}function startScheduler(){const _0x5a4be3=_0xfbfeb9,_0x3f0ac7=new Date()['getUTCHours'](),_0x1b4da0=shiftedTime()[_0x5a4be3(0x2ba)]();_0x1b4da0==0x4&&backupConfigFiles();_0x1b4da0==0x0&&rotateLogFiles();_0x3f0ac7%0x6==0x0&&triggerAnalytics();_0x3f0ac7%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x5c0b8f){const _0x272b01=_0xfbfeb9;logger[_0x272b01(0x2c4)](_0x272b01(0x195)+_0x5c0b8f);const _0x30f953=getBotsWithMode();_0x30f953[_0x272b01(0x16f)]>0x0?confirmRestore(configbackuppath,_0x5c0b8f):unzipFile(configbackuppath,_0x5c0b8f);}async function getBackupFiles(_0x47f574=null){const _0xef30ce=_0xfbfeb9;let _0x35eb6c=[],_0x836c81=fs[_0xef30ce(0x103)](configbackuppath,{'withFileTypes':!![]});_0x836c81[_0xef30ce(0x174)]((_0x80e995,_0x15201d)=>_0x80e995[_0xef30ce(0x2a2)]<_0x15201d['name']?0x1:_0x15201d[_0xef30ce(0x2a2)]<_0x80e995[_0xef30ce(0x2a2)]?-0x1:0x0),_0x836c81['forEach'](_0x29bd7c=>{const _0x479c09=_0xef30ce;if(!_0x29bd7c[_0x479c09(0x255)]()&&_0x29bd7c[_0x479c09(0x2a2)]['startsWith'](_0x479c09(0xf7))&&_0x29bd7c[_0x479c09(0x2a2)][_0x479c09(0x258)](_0x479c09(0x1c4))){const _0xa2ba87=formatDate(fs[_0x479c09(0x1f0)](configbackuppath+_0x29bd7c[_0x479c09(0x2a2)])[_0x479c09(0x14c)]);_0x35eb6c['push']({'name':_0x29bd7c[_0x479c09(0x2a2)],'mtime':_0xa2ba87});}});if(_0x47f574)io['to'](_0x47f574)[_0xef30ce(0x1bf)](_0xef30ce(0x22c),_0x35eb6c);else return _0x35eb6c;}async function backupConfigFiles(){const _0x29ee6a=_0xfbfeb9;await zipFiles(_0x29ee6a(0x27b));const _0xfe14c3=getCleanTimeStamp();fs[_0x29ee6a(0x260)](zippath+_0x29ee6a(0x2d7),configbackuppath+(_0x29ee6a(0xf7)+_0xfe14c3+_0x29ee6a(0x1c4)));let _0x1f7e67=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x1f7e67[_0x29ee6a(0x174)]((_0x37d3eb,_0x4c6f72)=>_0x37d3eb[_0x29ee6a(0x2a2)]<_0x4c6f72[_0x29ee6a(0x2a2)]?0x1:_0x4c6f72[_0x29ee6a(0x2a2)]<_0x37d3eb['name']?-0x1:0x0),_0x1f7e67[_0x29ee6a(0x16f)]>maxBackups&&fs[_0x29ee6a(0x104)](configbackuppath+_0x1f7e67[_0x1f7e67['length']-0x1][_0x29ee6a(0x2a2)]);}function rotateLogFiles(){const _0x47c5c1=_0xfbfeb9,_0x34cd6e=fs[_0x47c5c1(0x1f0)](logspath+_0x47c5c1(0x21a)),_0x7c3b68=_0x34cd6e[_0x47c5c1(0x107)]/0x400;if(_0x7c3b68>0x64){let _0x4fd755=fs[_0x47c5c1(0x103)](logspath,{'withFileTypes':!![]});_0x4fd755[_0x47c5c1(0x174)]((_0x22223a,_0x544e9b)=>_0x22223a[_0x47c5c1(0x2a2)]<_0x544e9b[_0x47c5c1(0x2a2)]?0x1:_0x544e9b[_0x47c5c1(0x2a2)]<_0x22223a[_0x47c5c1(0x2a2)]?-0x1:0x0),_0x4fd755[_0x47c5c1(0x144)](_0x36a4b2=>{const _0x229b8c=_0x47c5c1;if(_0x36a4b2[_0x229b8c(0x2a2)]=='output-002.log')fs[_0x229b8c(0x260)](logspath+_0x36a4b2[_0x229b8c(0x2a2)],logspath+_0x229b8c(0x256));if(_0x36a4b2['name']=='output-001.log')fs[_0x229b8c(0x260)](logspath+_0x36a4b2[_0x229b8c(0x2a2)],logspath+_0x229b8c(0x106));_0x36a4b2[_0x229b8c(0x2a2)]==_0x229b8c(0x21a)&&(fs[_0x229b8c(0x260)](logspath+_0x36a4b2['name'],logspath+'output-001.log'),fs['writeFileSync'](logspath+_0x36a4b2['name'],''));});}}async function zipFiles(_0x4f122b){const _0x4032cd=_0xfbfeb9;let _0x4b318a;if(_0x4f122b==_0x4032cd(0x131))_0x4b318a=logspath;if(_0x4f122b=='backup')_0x4b318a=configpath;if(_0x4f122b=='backup-full')_0x4b318a=configpath;let _0x120e1f=fs['readdirSync'](_0x4b318a,{'withFileTypes':!![]});const _0x2f33dd=new require('node-zip')();_0x120e1f[_0x4032cd(0x144)](_0x578b85=>{const _0x129689=_0x4032cd;if(!_0x578b85[_0x129689(0x255)]()){let _0x3750ac=fs[_0x129689(0x1f9)](_0x4b318a+_0x578b85[_0x129689(0x2a2)]);if(_0x4f122b==_0x129689(0x136)){const _0xcf6540=/^bot-[0-9]{3}-config.json$/,_0x1bb6a6=_0xcf6540['test'](_0x578b85[_0x129689(0x2a2)]);if(_0x1bb6a6){const _0x408851=JSON[_0x129689(0x28e)](_0x3750ac);if(_0x408851[_0x129689(0x221)][0x0]){_0x408851[_0x129689(0x221)][0x0][_0x129689(0x279)]=_0x129689(0x1ca),_0x408851[_0x129689(0x221)][0x0][_0x129689(0x2df)]=_0x129689(0x1ca);if(_0x408851[_0x129689(0x221)][0x0][_0x129689(0x124)])_0x408851[_0x129689(0x221)][0x0][_0x129689(0x124)]='***';}_0x3750ac=JSON['stringify'](_0x408851,null,0x2);}if(_0x578b85['name']=='bb-settings.json'){const _0x12230d=JSON[_0x129689(0x28e)](_0x3750ac);if(_0x12230d[_0x129689(0x2c3)][_0x129689(0x12f)])_0x12230d['settings'][_0x129689(0x12f)]=![];if(_0x12230d[_0x129689(0x2c3)]['bbPassword'])_0x12230d['settings']['bbPassword']=_0x129689(0x1ca);if(_0x12230d['settings'][_0x129689(0x22d)])_0x12230d['settings'][_0x129689(0x22d)]=_0x129689(0x1ca);if(_0x12230d['settings'][_0x129689(0x11b)])_0x12230d['settings']['telegramChatId']=null;_0x3750ac=JSON[_0x129689(0xef)](_0x12230d,null,0x2);}if(_0x578b85[_0x129689(0x2a2)]!=_0x129689(0xeb))_0x2f33dd[_0x129689(0x175)](_0x578b85['name'],_0x3750ac);}else _0x2f33dd[_0x129689(0x175)](_0x578b85[_0x129689(0x2a2)],_0x3750ac);}});const _0xed508=_0x2f33dd[_0x4032cd(0x118)]({'base64':![],'compression':'DEFLATE'});fs[_0x4032cd(0x122)](zippath+(_0x4f122b+_0x4032cd(0x1c4)),_0xed508,_0x4032cd(0xff));}async function unzipFile(_0x32c97c,_0x50c944){const _0x632de5=_0xfbfeb9;fs[_0x632de5(0x103)](configpath,{'withFileTypes':!![]})[_0x632de5(0x144)](_0x5cd5c1=>{if(!_0x5cd5c1['isDirectory']())fs['rmSync'](configpath+_0x5cd5c1['name']);});const _0x3b2c94=fs[_0x632de5(0x1f9)](_0x32c97c+_0x50c944,_0x632de5(0xff)),_0x39f773=new require('node-zip')(_0x3b2c94,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x39f773[_0x632de5(0x284)])['forEach'](_0x1b6f36=>{const _0x4905e8=_0x632de5,_0x276d25=_0x39f773['files'][_0x1b6f36];fs[_0x4905e8(0x122)](configpath+_0x276d25[_0x4905e8(0x2a2)],_0x276d25[_0x4905e8(0x16b)]);}),fs[_0x632de5(0x103)](temppath,{'withFileTypes':!![]})[_0x632de5(0x144)](_0x7c9ab5=>{const _0x2bca42=_0x632de5;if(!_0x7c9ab5[_0x2bca42(0x255)]())fs[_0x2bca42(0x218)](temppath+_0x7c9ab5['name']);}),logger[_0x632de5(0x2c4)]('Backup\x20file\x20unzipped\x20and\x20stored'),process['send']({'restore':!![]},_0xd880b0=>{});}async function getPublicIp(){const _0x2fa5d7=_0xfbfeb9;try{const _0x357121=await axios[_0x2fa5d7(0xf3)](_0x2fa5d7(0x190));publicip=_0x357121[_0x2fa5d7(0x21f)]['ip'];}catch(_0x7053e9){}}async function triggerAnalytics(){const _0x1fd795=_0xfbfeb9;if(!publicip)await getPublicIp();const _0x5bcf3a=getBotsWithMode();let _0x3cbd77=0x0;_0x5bcf3a[_0x1fd795(0x144)](_0x46cfe9=>{const _0xfe81=_0x1fd795;if(_0x46cfe9['status']===_0xfe81(0x15f))_0x3cbd77++;});const _0x41b11c=getBotExchanges();mixpanel['track'](_0x1fd795(0x18b),{'distinct_id':settings[_0x1fd795(0x199)],'ip':publicip,'version':serverversion,'numbots':_0x5bcf3a[_0x1fd795(0x16f)],'numbotsenabled':_0x3cbd77,'exchanges':_0x41b11c,'environment':environment});}async function getMessages(){const _0x2800f5=_0xfbfeb9,_0x57c7f6='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x58298b=new GraphQLClient(_0x57c7f6),_0x3b1450={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x36926f=serverversion['split']('.'),_0x3a801e=_0x36926f[0x0]+'.'+_0x36926f[0x1],_0x135aed=Math[_0x2800f5(0x24f)](settings[_0x2800f5(0x26b)],settings['lastmsgemitted']),_0x434c95={'last':parseInt(_0x135aed),'bbm':_0x3a801e},_0x13411f=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4cb896;try{_0x4cb896=await _0x58298b[_0x2800f5(0x21b)](_0x13411f,_0x434c95,_0x3b1450);}catch(_0x12c140){}if(_0x4cb896&&_0x4cb896['messages']){let _0x9026fe=settings[_0x2800f5(0x26b)];newMessages=[];for(const _0x30136b of _0x4cb896['messages']){newMessages[_0x2800f5(0x161)](_0x30136b);let _0x3c60e9=![];_0x30136b[_0x2800f5(0x2a5)]&&(updateSetting(_0x2800f5(0x121),_0x30136b[_0x2800f5(0x2a5)]),_0x3c60e9=isNewerVersion(serverversion,_0x30136b[_0x2800f5(0x2a5)])||serverversion==_0x30136b['bbvNew']);if(!_0x3c60e9&&_0x30136b['number']>_0x9026fe){if(_0x30136b['bbvReceive']===_0x2800f5(0x192)||serverversion['startsWith'](_0x30136b[_0x2800f5(0x109)])){let _0x287864=''+_0x30136b[_0x2800f5(0x283)]+'\x0a\x0a'+_0x30136b['message'];const _0x4133f9=await sendTelegramMsg(toTelegramMarkdown(_0x287864),_0x2800f5(0x2bb));if(_0x4133f9)_0x9026fe=_0x30136b[_0x2800f5(0x203)];}}}updateAvailable=isNewerVersion(settings[_0x2800f5(0x121)],serverversion),updateSetting('lastmsgtelegram',_0x9026fe),emitMessages();}}function emitMessages(){const _0x4dc66d=_0xfbfeb9,_0xfa2693=settings[_0x4dc66d(0x27a)];let _0x8ea7ed=[];newMessages[_0x4dc66d(0x144)](_0xa52de3=>{const _0x4c14dd=_0x4dc66d;_0xa52de3[_0x4c14dd(0x203)]>_0xfa2693&&_0x8ea7ed[_0x4c14dd(0x161)](_0xa52de3);}),_0x8ea7ed[_0x4dc66d(0x16f)]>0x0&&getAllClients()[_0x4dc66d(0x144)](_0xda7dc7=>{const _0x20e5de=_0x4dc66d;getSocket(_0xda7dc7['id'])['emit'](_0x20e5de(0x2a6),_0x8ea7ed);});}function confirmMessage(_0x14ede5){updateSetting('lastmsgemitted',Number(_0x14ede5));}function isNewerVersion(_0x2dac48,_0x170b19){const _0x3e2182=_0xfbfeb9,_0x519ea5=_0x170b19[_0x3e2182(0x201)]('.'),_0x89b8f6=_0x2dac48[_0x3e2182(0x201)]('.');for(var _0x136dcc=0x0;_0x136dcc<_0x89b8f6[_0x3e2182(0x16f)];_0x136dcc++){const _0x27e97d=~~_0x89b8f6[_0x136dcc],_0x42a39f=~~_0x519ea5[_0x136dcc];if(_0x27e97d>_0x42a39f)return!![];if(_0x27e97d<_0x42a39f)return![];}return![];}function toTelegramMarkdown(_0x594c73){const _0x11fb71=_0xfbfeb9,_0x182288=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x22d6d6=/\*{2}(.+?)\*{2}/gim;return _0x594c73=_0x594c73[_0x11fb71(0x139)](_0x182288,'$1_$2_$3')['replace'](_0x22d6d6,_0x11fb71(0x13b)),_0x594c73;}async function validateConfigFile(){const _0x224c3a=_0xfbfeb9,_0x36ec74=dbConfig[_0x224c3a(0xf3)](_0x224c3a(0x154))[_0x224c3a(0x2ac)](_0x224c3a(0xfc))[_0x224c3a(0x225)]()||[];if(_0x36ec74[_0x224c3a(0x16f)]==0x0){let _0x5ce8e2=0x0,_0x53e32b=[];const _0x1d54dd=/^bot-([0-9]{3})-config.json$/,_0x247ac9=fs[_0x224c3a(0x103)](configpath);_0x247ac9[_0x224c3a(0x144)](_0xe73a99=>{const _0x1b3a2a=_0x224c3a,_0x590925=_0x1d54dd[_0x1b3a2a(0x1d8)](_0xe73a99);if(_0x590925){const _0xa2d457=_0x590925[0x1];let _0x58fee7=getBotAttributes(_0xa2d457);_0x53e32b[_0x1b3a2a(0x161)]({'botID':_0xa2d457,'botname':_0x58fee7['botname'],'status':_0x1b3a2a(0x1fd),'live':_0x1b3a2a(0x1d7)}),_0x5ce8e2++;}}),_0x5ce8e2!=0x0&&(dbConfig[_0x224c3a(0xf3)](_0x224c3a(0x154))[_0x224c3a(0xf5)](_0x53e32b)[_0x224c3a(0x1d9)](),config=_0x53e32b,restoredConfigFile=_0x5ce8e2);}}async function restoreConfigNotify(_0x240bf9){const _0x36b68d=_0xfbfeb9;let _0x34e590;if(restoredConfigFile==0x1)_0x34e590='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x34e590=_0x36b68d(0x2b5);if(_0x240bf9)io['to'](_0x36b68d(0x1b7))[_0x36b68d(0x1bf)](_0x36b68d(0x2d5),_0x34e590);else{logger[_0x36b68d(0x1e9)](_0x36b68d(0xfd)),logger['simple'](_0x34e590),logger[_0x36b68d(0x1e9)](_0x36b68d(0xfd)),logger[_0x36b68d(0x1e9)]('');if(tgBot&&settings[_0x36b68d(0x11b)]&&settings['telegramEvents']!='orders')await sendTelegram(settings[_0x36b68d(0x11b)],_0x36b68d(0x1e1)+_0x34e590);}}function validateCredentials(_0x4f2711,_0x19e0a6){const _0x382905=_0xfbfeb9;if(_0x4f2711['username']==settings[_0x382905(0x2ae)]&&bcrypt['compareSync'](_0x4f2711[_0x382905(0x298)],settings[_0x382905(0x159)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x382905(0x213),'token':null};else{const _0x58cdae=generateLoginToken(_0x19e0a6);return{'allow':!![],'reason':_0x382905(0x1f2),'token':_0x58cdae};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x4e0d87){const _0x453c62=_0xfbfeb9,_0x16a539=generateLoginToken(_0x4e0d87);return{'allow':!![],'reason':_0x453c62(0x1f2),'token':_0x16a539};}function validateAccess(_0x2035fb,_0x45e6e8,_0x5168ad){const _0xc373a8=_0xfbfeb9,_0x134782=_0x5168ad?_0x5168ad:devices[_0x45e6e8]['ip'];let _0x1ccf5a;const _0x2fab7f=_0x5a7dbc=>{const _0x1f5e22=_0x2b31;if(settings[_0x1f5e22(0x12f)]){if(settings[_0x1f5e22(0x2d4)]){if(telegram2FaApproved(_0x45e6e8)){const _0x3f47f0=generateLoginToken(_0x45e6e8);return{'allow':!![],'reason':_0x1f5e22(0x237),'token':_0x3f47f0};}else return{'allow':![],'reason':_0x1f5e22(0x24a),'token':null};}else return _0x1ccf5a=validToken(_0x5a7dbc,_0x45e6e8),_0x1ccf5a['hasOwnProperty'](_0x1f5e22(0x26a))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x5a7dbc}:{'allow':![],'reason':_0x1f5e22(0x24a),'token':null};}else return{'allow':!![],'reason':_0x1f5e22(0x1a5),'token':null};};if(settings[_0xc373a8(0x272)]){let _0x25d87c=[...settings[_0xc373a8(0x2a1)],_0xc373a8(0x156),_0xc373a8(0x1b4),'127.0.0.1'];if(_0x25d87c[_0xc373a8(0x2db)](_0x134782))return _0x2fab7f(_0x2035fb);else{_0x1ccf5a=validToken(_0x2035fb,_0x45e6e8);if(_0x1ccf5a[_0xc373a8(0x243)](_0xc373a8(0x26a)))return _0x2fab7f(_0x2035fb);else{if(telegramIpApproved(_0x45e6e8)){const _0x359424=generateToken(_0x45e6e8);return _0x1ccf5a=_0x2fab7f(_0x2035fb),_0x1ccf5a[_0xc373a8(0x23d)]?{'allow':!![],'reason':_0xc373a8(0x155),'token':_0x359424}:_0x1ccf5a;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0xc373a8(0x123),'token':null};}}}else return _0x2fab7f(_0x2035fb);}function _0x488a(){const _0x4e9924=['restore_yes_','keys','expiry','Allow\x20login\x20from\x20IP\x20address\x20','#RES#\x20if\x20running\x20on\x20server','temporary\x20access\x20timeout','once','Unauthorized\x20attempt\x20to\x20delete\x20bot','set','fork','/off\x20-\x20stop\x20bot(s)\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','getDate','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','::ffff:127.0.0.1','mode','running','botmanager','config/','clients','string','Unauthorized\x20attempt\x20to\x20delete\x20alerts','uuid','getPortfolio','storeConfiguration','emit','Unauthorized\x20attempt\x20to\x20get\x20events','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot',',\x20must\x20be\x20a\x204\x20digit\x20number','.zip','randomBytes','address','names','/output-000.log','createServer','***','new','disable','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','1435vGaqdl','staging','Logged\x20in\x20user\x20...','#RES#\x20','headers','argv','\x20>\x20','off','stopped','exec','write','telegram2FaApproval','Setting\x20access:\x20','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','toggleBotMode','toggle','socket.io','#RES#\x20if\x20running\x20locally\x0a','Bot\x20Mgr\x20>\x20','portfolio_','Telegram\x20error:','yargs/yargs','/disable\x20-\x20disable\x20notifications\x0a','place-order','send','=>\x20Go\x20to\x20#CYA#http://','simple','ipaddr.js','cancelLoading','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','reload',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','5\x20min','statSync','connected','login\x20token\x20generated','version','<b>Balance\x20Bot\x20Status:</b>\x0a','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','listen','timeshift','readFileSync','You\x20can\x20use\x20the\x20following\x20commands:\x0a','408159MiOJqz','inlineKeyboard','disabled','reinstall-bb','/download/:type','config_orders','split','Idling\x20(','number','version.json','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','/on\x20-\x20start\x20bot(s)\x0a','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','uncaughtException','store','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','2526mBzsjR','metrics','Token\x20blacklisted','kill','port','Unauthorized\x20attempt\x20to\x20download\x20','config','2FA\x20login\x20required','update_yes','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','remoteAddress','createWriteStream','rmSync','user','output-000.log','request','bot-','temp/','/:bot/configuration','data','from','bot','delete-bot','started','telegramEvents','value','Unauthorized\x20attempt\x20to\x20confirm\x20message','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Error:\x20Invalid\x20argument\x20','Error\x20while\x20deleting\x20config\x20files:\x20','yes','referer','backup-files','telegramToken','startsWith','remove','pidRefreshToken','Unauthorized\x20attempt\x20to\x20update\x20settings','/:bot/performance','callback','params','sendFile','Notifications\x20enabled','2FA\x20login\x20token\x20generated','2FA\x20required','auto','disconnect','show','sendMetricsTelegram','allow','command','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','path','reply','onepagemode','hasOwnProperty','access','full','Network\x20Interfaces:','Bot\x20','reinstall','resetHistory','login\x20required','init','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','getTime','min','tkn','Unauthorized\x20attempt\x20to\x20get\x20messages','express','args','Password\x20has\x20been\x20reset\x20to:\x20','isDirectory','output-003.log','44yRYLtz','endsWith','action','settings.','tempaccess_5_','isValid','help','add-bot','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','copyFileSync','Notifications\x20types:\x20','\x20mode','config_all','store-configuration','store-headless','live','entries','botname','RSA-OAEP','success','lastmsgtelegram','pidExpireLogin','[ip-address]','accept','manual','User\x20has\x20been\x20validated','exchange','whitelistEnabled','60YIpkHy','ipc','express-fileupload','bb/','1000','\x20(1)','apiKey','lastmsgemitted','backup-full','zip/','kind','telegramEnabled','download','show-config','existsSync','Restarting\x20Bot\x20','title','files','RSA','chat','2FA','login2fa_reject_','search','NTBA_FIX_319','Ok,\x20will\x20send\x20alert\x20notifications\x20only','blacklist','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','parse','getMinutes','internal','File\x20uploaded','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','-config.json','alerts','(((.+)+)+)+$','/help\x20-\x20show\x20available\x20commands\x0a','Deleted\x20Bot\x20','password','Notifications\x20enabled\x0a','orders','update','toggle_','headless','uuid-random','axios','private','whitelist','name','post','text','bbvNew','message','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','temporary\x20access\x20rejected','username','Orders','78915NMTdhY','sortBy','/enable\x20-\x20enable\x20notifications\x0a','bbUsername','connection','clientip','\x1b[35m','placeOrder','event','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','apply','\x1b[36m','secure','new-disabled','getHours','Markdown','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','\x20|\x20','type','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','build','HTML','settings','debug','Restoring\x20bot(s)\x20from\x20backup','use','update-bb','2069287eMtpcs','alias','get-backup-files','slice','reset-history','3000','telegramIpApproval','static','status','index.html','telegramUsername','conn','f2aRequired','notification','logs/','backup-full.zip','restart','get-logs','randomFillSync','includes','environment','server','http','apiSecret','tempaccess_reject_','launch','node','hashSync','logged\x20out','bcryptjs','\x1b[0m','bb-secure.json','jsonwebtoken','backupfile','graphql-request','stringify',':\x20Bot\x20Mgr\x20>\x20','function','handshake','get','sign','assign',')\x20\x20\x20|\x20Bot\x20','backup-full@','/:bot/portfolio','Unauthorized\x20attempt\x20to\x20update\x20bot','Unauthorized\x20attempt\x20to\x20show\x20configuration','resetpw_no','botID','-----------------------------------------------------------------------------------','util','binary','map','decrypt','logout','readdirSync','unlinkSync','reason','output-002.log','size','bb-settings.json','bbvReceive','30\x20min','Unauthorized\x20attempt\x20to\x20log\x20out','build2','enable','timestamp','then','-performance.json','telegram','update-bot','Login\x20rejected','bot.js','stop','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','access\x20timeout','generate','getMonth','toString','telegramChatId','Starting\x20Balance\x20Bot\x20reinstallation','Password\x20reset\x20rejected','\x1b[33m','1111368Wyvkpx','publicKey','latestversion','writeFileSync','temporary\x20access\x20not\x20allowed','apiPassword','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','-results.json','padStart','max','secret','tempaccess_30_','button','Starting\x20new\x20bot\x20|\x20Bot\x20','getFullYear','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','loginRequired','sendMessage','logs','emitHistory','lowdb','/names\x20-\x20show\x20bot\x20names\x0a','Alerts','backup','************','/upload-backup','replace','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','*$1*','Invalid\x20authentication\x20token\x20(1)','-events.json','storeHeadless','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','get-messages','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','15\x20min','isIPv4MappedAddress','forEach','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','/:bot/coins','join','Invalid\x20username\x20or\x20IP\x20address','sockets','error','confirm-message','mtime','Restore\x20process\x20confirmed','IPv4','config_alerts','Node.js\x20v','SIGINT','filter','find','bots','temporary\x20token\x20generated','::1','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','updatebotmanager','bbPassword','\x20minutes','/:bot/support','hybrid-crypto-js','defaults','Starting\x20(','enabled','delete-alerts','push','production','82822NqSxqa','getSeconds','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','restore_no_','/update\x20-\x20update\x20Balance\x20Bot\x0a','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','editMessageReplyMarkup',')\x20|\x20Bot\x20','_data','exit','Starting\x20Balance\x20Bot\x20update','portfolio','length','\x20only\x0a','inherit','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','sort','file','reject','/start','cloneDeep','Notifications\x20disabled\x0a','invalid\x20credentials','Starting\x20#RED#Balance\x20Bot\x20v','format','\x20to\x20','metrics_','Yes','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','log','All\x20bots\x20running\x20right\x20now','No\x20bots\x20running\x20right\x20now','/status\x20-\x20show\x20bot(s)\x20status\x0a','generateKeyPairAsync','privateKey','all','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Session\x20expired\x20for\x20user\x20...','Server','mkdirSync','17937CQtmvo','toggle-bot-mode','update_no','https://api.ipify.org?format=json','family','any','Unauthorized\x20login\x20attempt\x20(timeout)','login','Restore\x20backup\x20file\x20','0.0.0','lowdb/adapters/FileSync','<b>Telegram\x20Bot\x20Status:</b>\x0a','userid','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','/:bot/history','telegraf','10KCyOpX','sendPortfolioTelegram','host','restore-backup-file','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','deleteHistoryAlerts','match','token','login\x20not\x20required'];_0x488a=function(){return _0x4e9924;};return _0x488a();}function timelyDecrypt(_0xb04b6d,_0x4e298c=!![]){const _0x1a4a63=_0xfbfeb9;if(_0xb04b6d)try{const _0x8af5ff=crypt['decrypt'](secure[_0x1a4a63(0x187)],_0xb04b6d)[_0x1a4a63(0x2a6)],_0x425f09=_0x8af5ff['split']('@')[0x0],_0x41d4f4=_0x8af5ff[_0x1a4a63(0x201)]('@')[0x1],_0x30b0f2=new Date()[_0x1a4a63(0x24e)]();if(_0x4e298c){if(_0x30b0f2-_0x41d4f4<maxSecretAge*0x3e8)return _0x425f09;else return![];}else return _0x425f09;}catch(_0xd3bc99){return![];}else return![];}const validToken=(_0x3a94a7,_0x291ac1)=>{const _0x2fe028=_0xfbfeb9,_0x585f47=devices[_0x291ac1]['ip'];if(!_0x3a94a7)return{'error':'No\x20authentication\x20token'};for(let _0x51726e of blacklist){if(_0x51726e[_0x2fe028(0x1a4)]==_0x3a94a7)return{'error':_0x2fe028(0x20e)};}let _0x36ce67;try{_0x36ce67=jwt['verify'](_0x3a94a7,secure['secret']+_0x291ac1);}catch{return{'error':_0x2fe028(0x13c)};}if(!_0x36ce67[_0x2fe028(0x243)](_0x2fe028(0x2b0))&&!_0x36ce67['hasOwnProperty'](_0x2fe028(0x2a9))||!_0x36ce67[_0x2fe028(0x243)]('exp'))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x36ce67[_0x2fe028(0x243)]('username')&&_0x36ce67[_0x2fe028(0x243)](_0x2fe028(0x2b0))){const {clientip:_0x29f160}=_0x36ce67;return _0x585f47==_0x29f160?{'success':_0x2fe028(0x270)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x36ce67[_0x2fe028(0x243)](_0x2fe028(0x2a9))&&_0x36ce67[_0x2fe028(0x243)](_0x2fe028(0x2b0))){const {username:_0xea0caa,clientip:_0x1cc27b}=_0x36ce67;return settings['bbUsername']==_0xea0caa&&_0x585f47==_0x1cc27b?{'success':_0x2fe028(0x270)}:{'error':_0x2fe028(0x148)};}}},generateLoginToken=_0x166d0a=>{if(_0x166d0a){const _0x1e279c=devices[_0x166d0a]['ip'];return jwt['sign']({'username':settings['bbUsername'],'clientip':_0x1e279c},secure['secret']+_0x166d0a,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x1cdd54=>{const _0x4cf5c8=_0xfbfeb9;if(_0x1cdd54){const _0x10353c=devices[_0x1cdd54]['ip'];return jwt[_0x4cf5c8(0xf4)]({'clientip':_0x10353c},secure[_0x4cf5c8(0x129)]+_0x1cdd54,{'expiresIn':devices[_0x1cdd54][_0x4cf5c8(0x2ce)][_0x4cf5c8(0x1a8)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x32dc3a=>{const _0x4ba3fc=_0xfbfeb9;let _0x4a493c=![];return devices[_0x32dc3a][_0x4ba3fc(0x2ce)]&&devices[_0x32dc3a]['telegramIpApproval'][_0x4ba3fc(0x1a8)]!='reject'&&(_0x4a493c=devices[_0x32dc3a][_0x4ba3fc(0x2ce)][_0x4ba3fc(0x2b0)]==devices[_0x32dc3a]['ip']&&new Date()[_0x4ba3fc(0x24e)]()-devices[_0x32dc3a][_0x4ba3fc(0x2ce)][_0x4ba3fc(0x10e)]<devices[_0x32dc3a][_0x4ba3fc(0x2ce)][_0x4ba3fc(0x1a8)]*0x3c*0x3e8),_0x4a493c;},telegram2FaApproved=_0x50b37a=>{const _0x26494a=_0xfbfeb9;let _0x13bc03=![];return devices[_0x50b37a][_0x26494a(0x1da)]&&devices[_0x50b37a][_0x26494a(0x1da)][_0x26494a(0x1a8)]!=_0x26494a(0x176)&&(_0x13bc03=devices[_0x50b37a]['telegram2FaApproval'][_0x26494a(0x2b0)]==devices[_0x50b37a]['ip']&&new Date()[_0x26494a(0x24e)]()-devices[_0x50b37a][_0x26494a(0x1da)][_0x26494a(0x10e)]<devices[_0x50b37a][_0x26494a(0x1da)][_0x26494a(0x1a8)]*0x3c*0x3e8),_0x13bc03;},normalizeIP=_0x18d741=>{const _0x12a93b=_0xfbfeb9;let _0x166033=null,_0x1c1f25=null;if(ipaddr[_0x12a93b(0x25c)](_0x18d741)){const _0xf240a9=ipaddr[_0x12a93b(0x28e)](_0x18d741);_0xf240a9[_0x12a93b(0x27d)]()==='ipv6'?(_0xf240a9[_0x12a93b(0x143)]()&&(_0x166033=_0xf240a9['toIPv4Address']()[_0x12a93b(0x11a)]()),_0x1c1f25=_0xf240a9[_0x12a93b(0x11a)]()):(_0x166033=_0xf240a9[_0x12a93b(0x11a)](),_0x1c1f25=_0xf240a9['toIPv4MappedAddress']()[_0x12a93b(0x11a)]());}return{'show':_0x166033?_0x166033:_0x1c1f25,'store':_0x1c1f25};};function formatDate(_0x3d0839){const _0x2fbfb2=_0xfbfeb9;return _0x3d0839[_0x2fbfb2(0x12d)]()+'/'+(_0x3d0839['getMonth']()+0x1)[_0x2fbfb2(0x11a)]()[_0x2fbfb2(0x127)](0x2,'0')+'/'+_0x3d0839[_0x2fbfb2(0x1b2)]()[_0x2fbfb2(0x11a)]()[_0x2fbfb2(0x127)](0x2,'0')+'\x20'+_0x3d0839['getHours']()[_0x2fbfb2(0x11a)]()[_0x2fbfb2(0x127)](0x2,'0')+':'+_0x3d0839['getMinutes']()[_0x2fbfb2(0x11a)]()[_0x2fbfb2(0x127)](0x2,'0')+':'+_0x3d0839[_0x2fbfb2(0x164)]()[_0x2fbfb2(0x11a)]()[_0x2fbfb2(0x127)](0x2,'0');}function sleep(_0x44a95e){return new Promise(_0x5eca3d=>setTimeout(_0x5eca3d,_0x44a95e));}