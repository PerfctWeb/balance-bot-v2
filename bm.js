const _0x4daf42=_0xbc42;(function(_0x4e578d,_0x252343){const _0xe8976d=_0xbc42,_0x431546=_0x4e578d();while(!![]){try{const _0x783faf=-parseInt(_0xe8976d(0x37e))/0x1*(parseInt(_0xe8976d(0x226))/0x2)+-parseInt(_0xe8976d(0x27a))/0x3*(-parseInt(_0xe8976d(0x269))/0x4)+-parseInt(_0xe8976d(0x1dc))/0x5+parseInt(_0xe8976d(0x315))/0x6*(parseInt(_0xe8976d(0x36a))/0x7)+parseInt(_0xe8976d(0x2f6))/0x8*(parseInt(_0xe8976d(0x2e8))/0x9)+parseInt(_0xe8976d(0x1ce))/0xa*(-parseInt(_0xe8976d(0x2e6))/0xb)+parseInt(_0xe8976d(0x273))/0xc;if(_0x783faf===_0x252343)break;else _0x431546['push'](_0x431546['shift']());}catch(_0x449a1d){_0x431546['push'](_0x431546['shift']());}}}(_0x4e1a,0xb051d));const _0x2aec08=function(){let _0xe6fb83=!![];return function(_0x54d9a8,_0x293284){const _0x4e7e4e=_0xe6fb83?function(){if(_0x293284){const _0x5e6a85=_0x293284['apply'](_0x54d9a8,arguments);return _0x293284=null,_0x5e6a85;}}:function(){};return _0xe6fb83=![],_0x4e7e4e;};}(),_0x3808c2=_0x2aec08(this,function(){const _0x364545=_0xbc42;return _0x3808c2[_0x364545(0x30f)]()[_0x364545(0x311)](_0x364545(0x26d))[_0x364545(0x30f)]()['constructor'](_0x3808c2)[_0x364545(0x311)]('(((.+)+)+)+$');});_0x3808c2();'use strict';process[_0x4daf42(0x388)][_0x4daf42(0x221)]=0x1;const childProcess=require(_0x4daf42(0x370)),fs=require('fs'),fns=require(_0x4daf42(0x2a7)),low=require(_0x4daf42(0x208)),FileSync=require(_0x4daf42(0x341)),path=require(_0x4daf42(0x244)),crypto=require('crypto'),Crypt=require('hybrid-crypto-js')[_0x4daf42(0x32f)],RSA=require(_0x4daf42(0x2c8))[_0x4daf42(0x2b2)],bcrypt=require(_0x4daf42(0x21b)),jwt=require(_0x4daf42(0x25e)),ipaddr=require(_0x4daf42(0x245)),argv=require(_0x4daf42(0x223))(process['argv']['slice'](0x2))[_0x4daf42(0x2ea)],uuidRandom=require('uuid-random'),TelegramBot=require(_0x4daf42(0x393)),Mixpanel=require('mixpanel'),axios=require(_0x4daf42(0x34a)),{GraphQLClient,gql}=require('graphql-request'),util=require('util'),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x4daf42(0x336)]||_0x4daf42(0x1fc),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console['log']('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1));const HOST=argv['host']||null,userID=argv[_0x4daf42(0x230)]||'',debugging=argv['d']||![],nodeversion=process[_0x4daf42(0x25d)]['node'];let bbpath=_0x4daf42(0x350),bbpath2='';const botfile=_0x4daf42(0x25c),configfile='bb-config.json',settingsfile='bb-settings.json',securefile='bb-secure.json',environment=require('./'+bbpath2+'version.json')[_0x4daf42(0x291)]||'production',maxBackups=0xa;let validInstallation=!![];!fs[_0x4daf42(0x2e2)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x4daf42(0x284)),configpath=userID?bbpath+_0x4daf42(0x264)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x4daf42(0x29b),logspath=userID?bbpath+_0x4daf42(0x294)+userID+'/':bbpath+_0x4daf42(0x294),zippath=userID?bbpath+_0x4daf42(0x1ea)+userID+'/':bbpath+_0x4daf42(0x1ea),loggerfile=fs['createWriteStream'](logspath+_0x4daf42(0x239),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x4daf42(0x321);!fs[_0x4daf42(0x2e2)](configpath)&&fs[_0x4daf42(0x229)](configpath);!fs[_0x4daf42(0x2e2)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x4daf42(0x2e2)](logspath)&&fs['mkdirSync'](logspath);!fs['existsSync'](zippath)&&fs[_0x4daf42(0x229)](zippath);!fs[_0x4daf42(0x2e2)](temppath)&&fs[_0x4daf42(0x229)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x4daf42(0x392)]({'bots':[]})[_0x4daf42(0x233)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x4daf42(0x392)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x4daf42(0x282),'onepagemode':![]}})[_0x4daf42(0x233)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4daf42(0x392)]({'secure':{},'blacklist':[]})[_0x4daf42(0x233)]();let crypt=new Crypt({'md':_0x4daf42(0x326),'rsaStandard':_0x4daf42(0x302)});const saltRounds=0xa,mixpanel=Mixpanel[_0x4daf42(0x2e0)](_0x4daf42(0x1db),{'host':_0x4daf42(0x2a0)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x4daf42(0x307)]&&settings['telegramToken']!=''&&settings[_0x4daf42(0x2d9)]&&settings[_0x4daf42(0x2d9)]!='')initTelegram();const parseColor=(_0x4fa249,_0x911ba9)=>{const _0x8c0ca0=_0x4daf42,_0x503f83=/#[A-Z]{3}#/g;if(typeof _0x4fa249=='string'){!_0x911ba9?_0x4fa249=_0x4fa249[_0x8c0ca0(0x1f6)](_0x503f83,''):(_0x4fa249=_0x4fa249[_0x8c0ca0(0x1f6)](/#BLU#/g,_0x8c0ca0(0x33b)),_0x4fa249=_0x4fa249['replace'](/#RED#/g,_0x8c0ca0(0x39a)),_0x4fa249=_0x4fa249[_0x8c0ca0(0x1f6)](/#YEL#/g,_0x8c0ca0(0x29c)),_0x4fa249=_0x4fa249[_0x8c0ca0(0x1f6)](/#MAG#/g,_0x8c0ca0(0x27f)),_0x4fa249=_0x4fa249[_0x8c0ca0(0x1f6)](/#CYA#/g,_0x8c0ca0(0x32d)),_0x4fa249=_0x4fa249[_0x8c0ca0(0x1f6)](/#RES#/g,_0x8c0ca0(0x263)));;}return _0x4fa249;},logger={'screen':_0x36a897=>{const _0x1cc621=_0x4daf42;console[_0x1cc621(0x281)](parseColor(_0x36a897,!![]));},'simple':_0x26ceee=>{const _0x58868e=_0x4daf42;console[_0x58868e(0x281)](parseColor(_0x26ceee,!![])),loggerfile[_0x58868e(0x233)](util[_0x58868e(0x23d)](parseColor(_0x26ceee,![]))+'\x0a');},'full':async _0x370c89=>{const _0x2c21d9=_0x4daf42,_0x378e60=getTimeStamp()+_0x2c21d9(0x240)+_0x370c89;console[_0x2c21d9(0x281)](parseColor(_0x378e60,!![])),loggerfile['write'](util[_0x2c21d9(0x23d)](parseColor(_0x378e60,![]))+'\x0a');if(tgBot&&settings[_0x2c21d9(0x2ee)]&&settings['telegramEvents']!='orders')await tgBot['sendMessage'](settings['telegramChatId'],_0x2c21d9(0x36f)+parseColor(_0x370c89,![]))['catch'](_0x2e5c91=>{telegramError(_0x2e5c91);});},'debug':async(_0x58dfdb,_0xb0f716='')=>{const _0x567e59=_0x4daf42,_0x11ba42=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x58dfdb;if(debugging)console[_0x567e59(0x281)](parseColor(_0x11ba42,!![]));loggerfile['write'](util[_0x567e59(0x23d)](parseColor(_0x11ba42,![]))+'\x0a');if(_0xb0f716){if(debugging)console[_0x567e59(0x281)](_0xb0f716);loggerfile['write'](util[_0x567e59(0x23d)](_0xb0f716)+'\x0a');}}};process['on']('uncaughtException',function(_0x518175){const _0x405121=_0x4daf42;logger[_0x405121(0x205)](_0x518175);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x4daf42(0x215))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x4daf42(0x31d)),app=express(),http=require(_0x4daf42(0x2b3))[_0x4daf42(0x39e)](app);app[_0x4daf42(0x390)](fileUpload({'useTempFiles':!![]})),app['get'](_0x4daf42(0x399),async(_0x4cce56,_0x2de120)=>{const _0x23280d=_0x4daf42,_0x3d238d=_0x4cce56[_0x23280d(0x234)][_0x23280d(0x2d3)],_0x598fe2=getClientsWithBotID(_0x23280d(0x2b4)),_0x1a6a1e=_0x4cce56['headers'][_0x23280d(0x288)],_0xe2e80a=timelyDecrypt(_0x1a6a1e,![]),_0x22cf90=_0x598fe2[_0x23280d(0x280)](_0x2da754=>_0x2da754[_0x23280d(0x288)]==_0xe2e80a);if(_0x22cf90){const _0x3e86d5=normalizeIP(_0x4cce56[_0x23280d(0x31f)][_0x23280d(0x344)])[_0x23280d(0x367)],_0x35115f=_0x4cce56['headers'][_0x23280d(0x386)];if(validateAccess(_0x35115f,_0xe2e80a,_0x3e86d5)[_0x23280d(0x385)])_0x3d238d==_0x23280d(0x2ec)&&await backupConfigFiles(),await zipFiles(_0x3d238d),_0x2de120[_0x23280d(0x268)](zippath+(_0x3d238d+_0x23280d(0x342)),_0x545cb4=>{const _0x2ac785=_0x23280d;_0x545cb4&&(logger[_0x2ac785(0x38a)]('Failed\x20to\x20download\x20'+_0x3d238d),logger[_0x2ac785(0x205)](_0x545cb4));});else logger[_0x23280d(0x38a)](_0x23280d(0x201)+_0x3d238d+_0x23280d(0x216));}else logger[_0x23280d(0x38a)](_0x23280d(0x201)+_0x3d238d+_0x23280d(0x319));}),app[_0x4daf42(0x1f0)](_0x4daf42(0x355),async(_0x3c05a5,_0xe3b6c6)=>{const _0x2692ee=_0x4daf42,_0xfece0c=getClientsWithBotID(_0x2692ee(0x2b4)),_0x2ecac5=_0x3c05a5['headers'][_0x2692ee(0x288)],_0x8e88dd=timelyDecrypt(_0x2ecac5,![]),_0x53cdf2=_0xfece0c[_0x2692ee(0x280)](_0x5f080f=>_0x5f080f['uuid']==_0x8e88dd);logger[_0x2692ee(0x2fb)](_0x2692ee(0x206));if(_0x53cdf2){const _0x3b260d=normalizeIP(_0x3c05a5[_0x2692ee(0x31f)][_0x2692ee(0x344)])[_0x2692ee(0x367)],_0x3b8b0d=_0x3c05a5[_0x2692ee(0x1f5)][_0x2692ee(0x386)];if(validateAccess(_0x3b8b0d,_0x8e88dd,_0x3b260d)[_0x2692ee(0x385)]){if(_0x3c05a5['files']){const _0x24f831=_0x3c05a5[_0x2692ee(0x34c)][_0x2692ee(0x25a)];await _0x24f831['mv'](temppath+_0x24f831[_0x2692ee(0x29f)]),_0xe3b6c6[_0x2692ee(0x349)]({'status':!![],'message':'File\x20uploaded'});const _0x1e0840=getBotsWithMode();_0x1e0840['length']>0x0?confirmRestore(temppath,_0x24f831['name']):unzipFile(temppath,_0x24f831['name']);}}else logger[_0x2692ee(0x38a)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x2692ee(0x38a)](_0x2692ee(0x31e));}),app[_0x4daf42(0x390)](express[_0x4daf42(0x2d7)](path[_0x4daf42(0x29a)](__dirname,bbpath2,_0x4daf42(0x32a)))),app[_0x4daf42(0x390)](express['static'](path[_0x4daf42(0x29a)](__dirname,bbpath2,_0x4daf42(0x2c6)))),app[_0x4daf42(0x382)]('/',function(_0x316798,_0x5835cc){const _0x1af98c=_0x4daf42;_0x5835cc['sendFile'](path[_0x1af98c(0x29a)](__dirname,bbpath2,_0x1af98c(0x32a),_0x1af98c(0x210)));}),app[_0x4daf42(0x382)]('/:bot',function(_0x537ff7,_0x54699e){const _0x2d38ec=_0x4daf42;_0x54699e[_0x2d38ec(0x228)](path['join'](__dirname,bbpath2,_0x2d38ec(0x2c6),_0x2d38ec(0x210)));}),app['get'](_0x4daf42(0x31b),(_0x39c5d0,_0x28a7a7)=>{const _0x2a78e7=_0x4daf42;_0x28a7a7[_0x2a78e7(0x228)](path[_0x2a78e7(0x29a)](__dirname,bbpath2,_0x2a78e7(0x2c6),_0x2a78e7(0x210)));}),app[_0x4daf42(0x382)](_0x4daf42(0x39b),(_0x283cc2,_0xcc821d)=>{const _0x44cd50=_0x4daf42;_0xcc821d['sendFile'](path[_0x44cd50(0x29a)](__dirname,bbpath2,_0x44cd50(0x2c6),_0x44cd50(0x210)));}),app['get'](_0x4daf42(0x36d),(_0x38d959,_0x5d96c2)=>{const _0x2785eb=_0x4daf42;_0x5d96c2[_0x2785eb(0x228)](path[_0x2785eb(0x29a)](__dirname,bbpath2,_0x2785eb(0x2c6),'index.html'));}),app[_0x4daf42(0x382)](_0x4daf42(0x21f),(_0x5ed246,_0x30a13b)=>{const _0x188bbb=_0x4daf42;_0x30a13b[_0x188bbb(0x228)](path[_0x188bbb(0x29a)](__dirname,bbpath2,_0x188bbb(0x2c6),_0x188bbb(0x210)));}),app[_0x4daf42(0x382)](_0x4daf42(0x2f7),(_0x26a825,_0xd604d6)=>{const _0x27155a=_0x4daf42;_0xd604d6['sendFile'](path['join'](__dirname,bbpath2,_0x27155a(0x2c6),_0x27155a(0x210)));}),app['get']('/:bot/support',(_0x4f1075,_0x3cfa14)=>{const _0x26f232=_0x4daf42;_0x3cfa14['sendFile'](path['join'](__dirname,bbpath2,_0x26f232(0x2c6),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require(_0x4daf42(0x295))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x48ff33=_0x4daf42;let _0x35182a=_0x48ff33(0x21e);const _0x18370a=networkInterfaces(),_0x137e88={};for(const _0x63f32f of Object[_0x48ff33(0x2de)](_0x18370a)){for(const _0x516d of _0x18370a[_0x63f32f]){if((_0x516d[_0x48ff33(0x2ce)]==_0x48ff33(0x364)||_0x516d['family']==0x4)&&!_0x516d[_0x48ff33(0x384)]){const _0x27d429=ipaddr[_0x48ff33(0x34e)](_0x516d[_0x48ff33(0x308)])[_0x48ff33(0x36c)]();_0x27d429!='private'&&(!_0x137e88[_0x63f32f]&&(_0x137e88[_0x63f32f]=[]),_0x137e88[_0x63f32f][_0x48ff33(0x1cf)](_0x516d[_0x48ff33(0x308)]),_0x35182a=_0x516d[_0x48ff33(0x308)]);}}}return{'serverip':_0x35182a,'netinterfaces':_0x137e88};}async function startServer(){const _0xcc65bd=_0x4daf42,{serverip:_0x2a4813,netinterfaces:_0x51567e}=getServerIP();logger[_0xcc65bd(0x205)](''),logger[_0xcc65bd(0x205)]('-----------------------------------------------------------------------------------'),await logger[_0xcc65bd(0x38a)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0xcc65bd(0x2b0)+(environment=='staging'?_0xcc65bd(0x25b):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0xcc65bd(0x2af))+('=>\x20Go\x20to\x20#CYA#http://'+_0x2a4813+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0xcc65bd(0x205)](_0xcc65bd(0x2e5));if(config[_0xcc65bd(0x220)]!=0x0)for(const _0x315a5c of config){if(_0x315a5c[_0xcc65bd(0x2cc)]==_0xcc65bd(0x1d4)||_0x315a5c[_0xcc65bd(0x2cc)]==_0xcc65bd(0x1fe))await logger['full'](_0xcc65bd(0x371)+_0x315a5c[_0xcc65bd(0x2eb)]+_0xcc65bd(0x304)+_0x315a5c['botname']),startBot([_0x315a5c['botID'],userID],{'cwd':bbpath},function(_0x286354){if(_0x286354)logger['full'](_0x286354);});else(_0x315a5c[_0xcc65bd(0x2cc)]=='disabled'||_0x315a5c[_0xcc65bd(0x2cc)]==_0xcc65bd(0x35a))&&await logger[_0xcc65bd(0x38a)](_0xcc65bd(0x1d5)+_0x315a5c[_0xcc65bd(0x2eb)]+'\x20|\x20'+_0x315a5c['botname']);}else!newBot&&logger['simple'](_0xcc65bd(0x2dd));if(newBot)addBot();logger[_0xcc65bd(0x205)]('-----------------------------------------------------------------------------------'),logger[_0xcc65bd(0x205)](''),await logger['debug'](_0xcc65bd(0x1d6)+nodeversion),await logger[_0xcc65bd(0x2fb)]('Network\x20Interfaces:',_0x51567e);}function startSocket(){io['on']('connection',_0x2987a5=>{const _0x4c5438=_0xbc42;let _0x300ed1,_0x31677f,_0x3be3dc,_0x5eedee,_0x992980;const _0x127c4b=_0x2987a5[_0x4c5438(0x1dd)][_0x4c5438(0x1f5)]['referer'];_0x31677f=_0x127c4b[_0x4c5438(0x323)](/bot[0-9]{3}/);if(_0x31677f)_0x3be3dc=_0x31677f[0x0][_0x4c5438(0x323)](/[0-9]{3}/);if(_0x3be3dc)_0x300ed1=_0x3be3dc[0x0];else _0x300ed1=_0x4c5438(0x2b4);const _0x264dce=_0x2987a5[_0x4c5438(0x1dd)]['auth'][_0x4c5438(0x247)];if(!_0x264dce)_0x2987a5[_0x4c5438(0x334)](_0x4c5438(0x2cc),{'publicKey':secure[_0x4c5438(0x389)]});else{_0x5eedee=timelyDecrypt(_0x264dce,![]);if(!_0x5eedee)_0x2987a5[_0x4c5438(0x334)](_0x4c5438(0x2cc),{'publicKey':secure['publicKey']});else{_0x992980=normalizeIP(_0x2987a5['conn']['remoteAddress'])[_0x4c5438(0x367)];if(!devices[_0x5eedee])devices[_0x5eedee]={'uuid':_0x5eedee,'access':{'token':null}};devices[_0x5eedee]['ip']=_0x992980;const _0x2556c6=addClient(_0x2987a5['id'],_0x5eedee,_0x300ed1);setAccess(_0x2556c6),emitMessages(),_0x2987a5['on'](_0x4c5438(0x1ec),_0x32ab5b=>{const _0xacfa01=_0x4c5438,_0x531784=timelyDecrypt(_0x32ab5b[_0xacfa01(0x290)]);if(_0x531784){_0x32ab5b={'username':_0x32ab5b[_0xacfa01(0x258)],'password':_0x531784},devices[_0x5eedee][_0xacfa01(0x306)]=validateCredentials(_0x32ab5b,_0x5eedee);if(devices[_0x5eedee][_0xacfa01(0x306)]['allow']==![]&&devices[_0x5eedee][_0xacfa01(0x306)][_0xacfa01(0x32c)]=='2FA\x20login\x20required')_0x2987a5[_0xacfa01(0x334)](_0xacfa01(0x2cc),{'access':devices[_0x5eedee][_0xacfa01(0x306)]}),loginAccess2FA(_0x5eedee,_0x992980);else{if(devices[_0x5eedee][_0xacfa01(0x306)]['allow']==![]&&devices[_0x5eedee]['access'][_0xacfa01(0x32c)]==_0xacfa01(0x2fc))_0x2987a5[_0xacfa01(0x334)]('status',{'access':devices[_0x5eedee][_0xacfa01(0x306)]});else devices[_0x5eedee][_0xacfa01(0x306)][_0xacfa01(0x385)]&&devices[_0x5eedee]['access'][_0xacfa01(0x32c)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x5eedee)[_0xacfa01(0x20c)](_0x191360=>{setAccess(_0x191360);}),logger['debug'](_0xacfa01(0x34b)+_0x5eedee[_0xacfa01(0x24b)](-0x8)),setTokenRefresh(_0x5eedee),setSessionTimeout(_0xacfa01(0x1ec),_0x5eedee));}}else logger[_0xacfa01(0x38a)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x2987a5['on'](_0x4c5438(0x30c),()=>{resetPassword();}),_0x2987a5['on']('disconnect',_0x146ded=>{removeClient(_0x2987a5['id']);}),_0x300ed1==_0x4c5438(0x2b4)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x371006){const _0x284800=_0x4daf42;if(_0x371006!=_0x284800(0x2b4)&&config[_0x284800(0x21d)]!=''){if(pid[_0x371006])pid[_0x371006][_0x284800(0x349)]({'function':'initclient','args':null});}_0x371006!=_0x284800(0x2b4)&&broadcastToBots(_0x284800(0x333),JSON[_0x284800(0x2cf)](config));}function reloadBotManager(){const _0x43532d=_0x4daf42;getClientsWithBotID(_0x43532d(0x2b4))['forEach'](_0x21d12e=>{const _0x3f5f6b=_0x43532d;getSocket(_0x21d12e['id'])['emit'](_0x3f5f6b(0x2cc),{'access':{'allow':![],'reason':_0x3f5f6b(0x1e0),'token':null}});});}function getSocket(_0x1f40d4){const _0x413521=_0x4daf42;return io[_0x413521(0x227)][_0x413521(0x227)]['get'](_0x1f40d4);}function setAccess(_0x558241){const _0x1eeb34=_0x4daf42,_0x36bf01=getSocket(_0x558241['id']),_0x268c05=_0x558241[_0x1eeb34(0x288)],_0x10d46c=_0x558241[_0x1eeb34(0x332)];devices[_0x268c05][_0x1eeb34(0x306)]=validateAccess(devices[_0x268c05][_0x1eeb34(0x306)][_0x1eeb34(0x248)],_0x268c05),logger[_0x1eeb34(0x2fb)](_0x1eeb34(0x3a0)+devices[_0x268c05][_0x1eeb34(0x306)]['reason']+_0x1eeb34(0x23b)+_0x558241['id'][_0x1eeb34(0x24b)](-0x8)+_0x1eeb34(0x301)+_0x268c05[_0x1eeb34(0x24b)](-0x8)),_0x36bf01[_0x1eeb34(0x29a)](_0x268c05);if(devices[_0x268c05][_0x1eeb34(0x306)]['allow']){_0x36bf01[_0x1eeb34(0x29a)](_0x10d46c);if(_0x10d46c=='botmanager')initializeSocketBotManager(_0x36bf01);else initializeSocketBot(_0x36bf01);initClient(_0x10d46c);}devices[_0x268c05][_0x1eeb34(0x306)][_0x1eeb34(0x248)]&&devices[_0x268c05]['access']['reason']==_0x1eeb34(0x23a)&&setSessionTimeout(_0x1eeb34(0x359),_0x268c05),devices[_0x268c05][_0x1eeb34(0x306)][_0x1eeb34(0x248)]&&devices[_0x268c05]['access']['reason']==_0x1eeb34(0x2ac)&&setSessionTimeout(_0x1eeb34(0x1ec),_0x268c05),_0x36bf01[_0x1eeb34(0x334)](_0x1eeb34(0x2cc),{'status':_0x558241[_0x1eeb34(0x32b)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x268c05][_0x1eeb34(0x306)],'externalip':devices[_0x268c05]['ip'],'publicKey':secure[_0x1eeb34(0x389)],'userid':settings[_0x1eeb34(0x1e4)],'validInstallation':validInstallation}),devices[_0x268c05][_0x1eeb34(0x306)]['allow']==![]&&devices[_0x268c05][_0x1eeb34(0x306)][_0x1eeb34(0x32c)]==_0x1eeb34(0x1d0)&&temporaryAccess2FA(_0x268c05,devices[_0x268c05]['ip']);}function setSessionTimeout(_0x58ef15,_0x1443b6){const _0x5ad160=_0x4daf42;let _0x54c4d5;if(_0x58ef15==_0x5ad160(0x1ec))_0x54c4d5=loginExpiry*0x3c*0x3e8;else _0x54c4d5=devices[_0x1443b6][_0x5ad160(0x2e3)][_0x5ad160(0x314)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x1443b6][_0x5ad160(0x2e3)]['timestamp']);if(devices[_0x1443b6][_0x5ad160(0x212)])clearTimeout(devices[_0x1443b6][_0x5ad160(0x212)]);devices[_0x1443b6][_0x5ad160(0x212)]=setTimeout(()=>{const _0xe0915c=_0x5ad160;if(devices[_0x1443b6][_0xe0915c(0x330)])clearTimeout(devices[_0x1443b6]['pidRefreshToken']);removeSocketListeners(_0x1443b6),addBlacklist(_0x1443b6),devices[_0x1443b6][_0xe0915c(0x2e3)]=null,devices[_0x1443b6][_0xe0915c(0x1e5)]=null,devices[_0x1443b6][_0xe0915c(0x306)][_0xe0915c(0x248)]=null,logger['debug']('Session\x20expired\x20for\x20user\x20...'+_0x1443b6[_0xe0915c(0x24b)](-0x8)),devices[_0x1443b6][_0xe0915c(0x306)]=validateAccess(devices[_0x1443b6][_0xe0915c(0x306)][_0xe0915c(0x248)],_0x1443b6),!(devices[_0x1443b6]['access'][_0xe0915c(0x385)]&&devices[_0x1443b6][_0xe0915c(0x306)][_0xe0915c(0x32c)]==_0xe0915c(0x270))&&(_0x58ef15==_0xe0915c(0x1ec)?io['to'](_0x1443b6)[_0xe0915c(0x334)](_0xe0915c(0x2cc),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x1443b6)[_0xe0915c(0x334)](_0xe0915c(0x2cc),{'access':{'allow':![],'reason':_0xe0915c(0x272),'token':null}})),devices[_0x1443b6][_0xe0915c(0x306)][_0xe0915c(0x248)]=null;},_0x54c4d5);}function setTokenRefresh(_0x448dd7){const _0x40707a=_0x4daf42;if(devices[_0x448dd7][_0x40707a(0x330)])clearTimeout(devices[_0x448dd7][_0x40707a(0x330)]);devices[_0x448dd7][_0x40707a(0x330)]=setTimeout(()=>{const _0x385f1a=_0x40707a;getClientsWithUuid(_0x448dd7)[_0x385f1a(0x220)]!=0x0?(devices[_0x448dd7]['access']=refreshToken(_0x448dd7),io['to'](_0x448dd7)[_0x385f1a(0x334)](_0x385f1a(0x2cc),{'status':_0x385f1a(0x2b7),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x448dd7][_0x385f1a(0x306)],'externalip':devices[_0x448dd7]['ip'],'publicKey':secure[_0x385f1a(0x389)],'validInstallation':validInstallation}),setTokenRefresh(_0x448dd7)):clearTimeout(devices[_0x448dd7]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x17da96){const _0x5e5ad8=_0x4daf42,_0x674811=getClient(_0x17da96['id'])[_0x5e5ad8(0x288)];_0x17da96['emit'](_0x5e5ad8(0x333),config),_0x17da96[_0x5e5ad8(0x334)](_0x5e5ad8(0x30d),cleanSettings()),_0x17da96['on'](_0x5e5ad8(0x2cd),_0x36d043=>{const _0x198aa5=_0x5e5ad8;if(validateAccess(_0x36d043,_0x674811)[_0x198aa5(0x385)])addBot();else logger[_0x198aa5(0x38a)](_0x198aa5(0x20b));}),_0x17da96['on'](_0x5e5ad8(0x324),(_0x2dbb09,_0x2b5046)=>{const _0xa07a64=_0x5e5ad8;if(validateAccess(_0x2b5046,_0x674811)[_0xa07a64(0x385)])toggleBot(_0x2dbb09['botID'],_0x2dbb09[_0xa07a64(0x2cc)],_0x2dbb09[_0xa07a64(0x2e1)]);else logger[_0xa07a64(0x38a)](_0xa07a64(0x22f));}),_0x17da96['on']('toggle-bot-mode',(_0xae8b33,_0x66ebcb)=>{const _0x36e9a2=_0x5e5ad8;if(validateAccess(_0x66ebcb,_0x674811)[_0x36e9a2(0x385)])toggleBotMode(_0xae8b33);else logger[_0x36e9a2(0x38a)](_0x36e9a2(0x22f));}),_0x17da96['on'](_0x5e5ad8(0x271),(_0x294d07,_0x3dbd60)=>{const _0x5d0fa4=_0x5e5ad8;if(validateAccess(_0x3dbd60,_0x674811)[_0x5d0fa4(0x385)])deleteBot(_0x294d07);else logger[_0x5d0fa4(0x38a)](_0x5d0fa4(0x368));}),_0x17da96['on'](_0x5e5ad8(0x352),(_0x5a6bc2,_0x1a0bac)=>{const _0x589a50=_0x5e5ad8;if(validateAccess(_0x1a0bac,_0x674811)[_0x589a50(0x385)])storeSettings(_0x5a6bc2,!![]);else logger[_0x589a50(0x38a)](_0x589a50(0x39f));}),_0x17da96['on'](_0x5e5ad8(0x267),_0x4bfb9c=>{const _0xebe0b6=_0x5e5ad8;if(validateAccess(_0x4bfb9c,_0x674811)[_0xebe0b6(0x385)])updateBB(_0xebe0b6(0x34f));else logger[_0xebe0b6(0x38a)](_0xebe0b6(0x391));}),_0x17da96['on'](_0x5e5ad8(0x39c),_0x37fd4e=>{const _0x47f31e=_0x5e5ad8;if(validateAccess(_0x37fd4e,_0x674811)['allow'])updateBB(_0x47f31e(0x360));else logger[_0x47f31e(0x38a)](_0x47f31e(0x1e8));}),_0x17da96['on'](_0x5e5ad8(0x35b),_0x2a9cc1=>{const _0x3aea72=_0x5e5ad8;if(validateAccess(_0x2a9cc1,_0x674811)[_0x3aea72(0x385)]){const _0x754a14=getClient(_0x17da96['id']);if(_0x754a14)getBackupFiles(_0x754a14['uuid']);else logger[_0x3aea72(0x38a)](_0x3aea72(0x2c5));}else logger[_0x3aea72(0x38a)](_0x3aea72(0x235));}),_0x17da96['on'](_0x5e5ad8(0x1eb),(_0x51445a,_0x5e8263)=>{const _0x379353=_0x5e5ad8;if(validateAccess(_0x5e8263,_0x674811)['allow'])restoreBackupFile(_0x51445a);else logger[_0x379353(0x38a)](_0x379353(0x242));}),_0x17da96['on']('get-messages',_0x3c6899=>{const _0x22ca47=_0x5e5ad8;if(validateAccess(_0x3c6899,_0x674811)['allow'])getMessages();else logger[_0x22ca47(0x38a)](_0x22ca47(0x27d));}),_0x17da96['on'](_0x5e5ad8(0x20e),(_0x60cc5a,_0x182aa2)=>{const _0x1bd76f=_0x5e5ad8;if(validateAccess(_0x182aa2,_0x674811)[_0x1bd76f(0x385)])confirmMessage(_0x60cc5a);else logger[_0x1bd76f(0x38a)](_0x1bd76f(0x222));}),_0x17da96['on'](_0x5e5ad8(0x2a9),_0x58e82a=>{const _0x33ce73=_0x5e5ad8;if(validateAccess(_0x58e82a,_0x674811)[_0x33ce73(0x385)]){if(devices[_0x674811]['pidRefreshToken'])clearTimeout(devices[_0x674811]['pidRefreshToken']);if(devices[_0x674811][_0x33ce73(0x212)])clearTimeout(devices[_0x674811]['pidExpireLogin']);removeSocketListeners(getClient(_0x17da96['id'])['uuid']),addBlacklist(_0x674811),devices[_0x674811]['telegramIpApproval']=null,devices[_0x674811]['telegram2FaApproval']=null,devices[_0x674811][_0x33ce73(0x306)]['token']=null,logger[_0x33ce73(0x2fb)](_0x33ce73(0x27b)+_0x674811[_0x33ce73(0x24b)](-0x8)),io['to'](getClient(_0x17da96['id'])[_0x33ce73(0x288)])[_0x33ce73(0x334)](_0x33ce73(0x2cc),{'access':{'allow':![],'reason':_0x33ce73(0x356),'token':null}});}else logger[_0x33ce73(0x38a)](_0x33ce73(0x279));});}function initializeSocketBot(_0xa413bd){const _0x4a4d60=_0x4daf42,_0x3bcd4a=getClient(_0xa413bd['id'])[_0x4a4d60(0x332)],_0x5d5a08=getClient(_0xa413bd['id'])[_0x4a4d60(0x288)];_0xa413bd['on'](_0x4a4d60(0x329),(_0xc159ee,_0x29155b)=>{const _0xc276bd=_0x4a4d60;if(validateAccess(_0x29155b,_0x5d5a08)[_0xc276bd(0x385)]){if(pid[_0x3bcd4a])pid[_0x3bcd4a][_0xc276bd(0x349)]({'function':'emitHistory','args':_0xc159ee});}else logger[_0xc276bd(0x38a)](_0xc276bd(0x2e9));}),_0xa413bd['on'](_0x4a4d60(0x232),(_0x5a11f6,_0x66b768)=>{const _0x21bb75=_0x4a4d60;if(validateAccess(_0x66b768,_0x5d5a08)[_0x21bb75(0x385)]){if(pid[_0x3bcd4a])pid[_0x3bcd4a][_0x21bb75(0x349)]({'function':'deleteHistoryAlerts','args':_0x5a11f6});}else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0xa413bd['on'](_0x4a4d60(0x241),(_0x2e200b,_0x449e23)=>{const _0x2c4a7f=_0x4a4d60;if(validateAccess(_0x449e23,_0x5d5a08)[_0x2c4a7f(0x385)]){if(pid[_0x3bcd4a])pid[_0x3bcd4a][_0x2c4a7f(0x349)]({'function':_0x2c4a7f(0x278),'args':_0x2e200b});}else logger[_0x2c4a7f(0x38a)](_0x2c4a7f(0x254));}),_0xa413bd['on'](_0x4a4d60(0x2ca),(_0xef0fee,_0x12f1ee)=>{const _0x177f94=_0x4a4d60;if(validateAccess(_0x12f1ee,_0x5d5a08)[_0x177f94(0x385)]){if(pid[_0x3bcd4a])pid[_0x3bcd4a][_0x177f94(0x349)]({'function':'storeConfiguration','args':_0xef0fee});}else logger[_0x177f94(0x38a)](_0x177f94(0x22c));}),_0xa413bd['on'](_0x4a4d60(0x2d6),(_0x20e4f6,_0x48232c)=>{const _0x456794=_0x4a4d60;if(validateAccess(_0x48232c,_0x5d5a08)['allow']){if(pid[_0x3bcd4a])pid[_0x3bcd4a][_0x456794(0x349)]({'function':'storeHeadless','args':_0x20e4f6});}else logger['full'](_0x456794(0x1f1));}),_0xa413bd['on'](_0x4a4d60(0x2b8),(_0x5aa986,_0x906994)=>{const _0xcbbac6=_0x4a4d60;if(validateAccess(_0x906994,_0x5d5a08)['allow']){if(pid[_0x3bcd4a])pid[_0x3bcd4a][_0xcbbac6(0x349)]({'function':_0xcbbac6(0x38f),'args':_0x5aa986});}else logger[_0xcbbac6(0x38a)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0xa413bd['on']('reset-history',_0x27d43=>{const _0x1783d6=_0x4a4d60;if(validateAccess(_0x27d43,_0x5d5a08)[_0x1783d6(0x385)]){if(pid[_0x3bcd4a])pid[_0x3bcd4a]['send']({'function':_0x1783d6(0x32e),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0xa413bd['on'](_0x4a4d60(0x22d),_0x2539f0=>{const _0x446870=_0x4a4d60;if(validateAccess(_0x2539f0,_0x5d5a08)[_0x446870(0x385)]){if(pid[_0x3bcd4a])pid[_0x3bcd4a][_0x446870(0x349)]({'function':'getStartingBalances','args':null});}else logger[_0x446870(0x38a)](_0x446870(0x1e2));}),_0xa413bd['on']('place-order',(_0x356b23,_0x39a4d9)=>{const _0x297553=_0x4a4d60;if(validateAccess(_0x39a4d9,_0x5d5a08)[_0x297553(0x385)]){if(pid[_0x3bcd4a])pid[_0x3bcd4a][_0x297553(0x349)]({'function':_0x297553(0x26c),'args':_0x356b23});}else logger[_0x297553(0x38a)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0xa413bd['on']('cancel-loading',_0x42c3c2=>{const _0x5b8c1d=_0x4a4d60;if(validateAccess(_0x42c3c2,_0x5d5a08)['allow']){if(pid[_0x3bcd4a])pid[_0x3bcd4a][_0x5b8c1d(0x349)]({'function':'cancelLoading','args':null});}else logger['full'](_0x5b8c1d(0x1ee));}),_0xa413bd['on']('show-config',_0x137d59=>{const _0x11a008=_0x4a4d60;if(validateAccess(_0x137d59,_0x5d5a08)['allow']){if(pid[_0x3bcd4a])pid[_0x3bcd4a][_0x11a008(0x349)]({'function':_0x11a008(0x2cb),'args':null});}else logger[_0x11a008(0x38a)](_0x11a008(0x2bd));}),_0xa413bd['on'](_0x4a4d60(0x267),_0xa322a9=>{const _0x331a86=_0x4a4d60;if(validateAccess(_0xa322a9,_0x5d5a08)['allow'])updateBB(_0x331a86(0x34f));else logger[_0x331a86(0x38a)](_0x331a86(0x391));}),_0xa413bd['on']('get-messages',_0x37fd4c=>{if(validateAccess(_0x37fd4c,_0x5d5a08)['allow'])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0xa413bd['on']('confirm-message',(_0x161ae3,_0x4939a8)=>{const _0x2f8f16=_0x4a4d60;if(validateAccess(_0x4939a8,_0x5d5a08)[_0x2f8f16(0x385)])confirmMessage(_0x161ae3);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0xa413bd['on'](_0x4a4d60(0x2a9),_0x117dfa=>{const _0x15d11a=_0x4a4d60;if(validateAccess(_0x117dfa,_0x5d5a08)[_0x15d11a(0x385)]){if(devices[_0x5d5a08]['pidRefreshToken'])clearTimeout(devices[_0x5d5a08]['pidRefreshToken']);if(devices[_0x5d5a08][_0x15d11a(0x212)])clearTimeout(devices[_0x5d5a08][_0x15d11a(0x212)]);removeSocketListeners(getClient(_0xa413bd['id'])[_0x15d11a(0x288)]),addBlacklist(_0x5d5a08),devices[_0x5d5a08][_0x15d11a(0x2e3)]=null,devices[_0x5d5a08]['telegram2FaApproval']=null,devices[_0x5d5a08][_0x15d11a(0x306)][_0x15d11a(0x248)]=null,logger[_0x15d11a(0x2fb)]('Logged\x20out\x20user\x20...'+_0x5d5a08[_0x15d11a(0x24b)](-0x8)),io['to'](getClient(_0xa413bd['id'])[_0x15d11a(0x288)])[_0x15d11a(0x334)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x15d11a(0x38a)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x31a9bb){const _0x2d76e0=_0x4daf42;getClientsWithUuid(_0x31a9bb)[_0x2d76e0(0x20c)](_0x45413d=>{getSocket(_0x45413d['id'])['removeAllListeners']();});}function cleanSettings(){const _0x16d787=_0x4daf42;let _0x25f7b1=settings;return settings[_0x16d787(0x307)]&&settings[_0x16d787(0x307)]!=''&&(_0x25f7b1={..._0x25f7b1,'telegramToken':_0x16d787(0x29d)}),settings[_0x16d787(0x2c0)]&&settings['bbPassword']!=''&&(_0x25f7b1={..._0x25f7b1,'bbPassword':_0x16d787(0x29d)}),(settings['bbPassword']&&settings[_0x16d787(0x2c0)]=='***'||settings['telegramToken']&&settings[_0x16d787(0x307)]==_0x16d787(0x2e7))&&(_0x25f7b1={..._0x25f7b1,'restored':{'password':settings['bbPassword']==_0x16d787(0x2e7),'telegram':settings[_0x16d787(0x307)]==_0x16d787(0x2e7)}}),_0x25f7b1;}function _0xbc42(_0x3c8a22,_0x22d441){const _0x4ceba5=_0x4e1a();return _0xbc42=function(_0x3808c2,_0x2aec08){_0x3808c2=_0x3808c2-0x1ce;let _0x4e1a3f=_0x4ceba5[_0x3808c2];return _0x4e1a3f;},_0xbc42(_0x3c8a22,_0x22d441);}async function updateBB(_0x701725){const _0x554246=_0x4daf42;await backupConfigFiles(),installingUpdate=!![],config[_0x554246(0x20c)](_0xfd537a=>{const _0x2dcbc1=_0x554246;restartBot(_0xfd537a[_0x2dcbc1(0x2eb)]);});if(_0x701725==_0x554246(0x34f))process[_0x554246(0x349)]({'update':!![],'environment':environment},_0x187ecc=>{});else _0x701725==_0x554246(0x360)&&process['send']({'reinstall':!![],'environment':environment},_0x19445e=>{});}function startBot(_0x4ea16d,_0x30b3f8,_0x1ed70d){const _0x21016a=_0x4daf42;if(debugging)_0x4ea16d[_0x21016a(0x1cf)]('-d');let _0x2d559f=![];const _0x2984de=_0x4ea16d[0x0];_0x30b3f8={..._0x30b3f8,'stdio':[_0x21016a(0x363),_0x21016a(0x363),_0x21016a(0x363),_0x21016a(0x1d3)]},pid[_0x2984de]=childProcess[_0x21016a(0x35d)](botfile,_0x4ea16d,_0x30b3f8),pid[_0x2984de]['on'](_0x21016a(0x38e),_0x3736bb=>{const _0x1b69f3=_0x21016a;switch(Object[_0x1b69f3(0x2de)](_0x3736bb)[0x0]){case'botname':updateBotName(_0x2984de,_0x3736bb['botname']);break;case _0x1b69f3(0x327):updateBotManager();break;case _0x1b69f3(0x2cc):updateStatus(_0x2984de,_0x3736bb[_0x1b69f3(0x2cc)]);break;case _0x1b69f3(0x2e1):updateLive(_0x2984de,_0x3736bb[_0x1b69f3(0x2e1)]);break;case _0x1b69f3(0x347):updateLive(_0x2984de,_0x3736bb['started']),io['to'](_0x2984de)[_0x1b69f3(0x334)](_0x1b69f3(0x2cc),{'access':{'allow':![],'reason':_0x1b69f3(0x1e0),'token':null}});break;case _0x1b69f3(0x259):_0x3736bb['stop']=='restart'&&restartBot(_0x2984de);_0x3736bb[_0x1b69f3(0x259)]==_0x1b69f3(0x30e)&&toggleBot(_0x2984de,_0x1b69f3(0x250),'stopped');break;case'telegram':sendTelegram(_0x2984de,_0x3736bb[_0x1b69f3(0x2c9)]);break;case _0x1b69f3(0x200):sendTelegramMsg(_0x3736bb[_0x1b69f3(0x200)]);break;case _0x1b69f3(0x2ed):io['to'](_0x2984de)[_0x1b69f3(0x334)](_0x3736bb['function'],_0x3736bb[_0x1b69f3(0x38b)]);break;}}),pid[_0x2984de]['on'](_0x21016a(0x209),function(_0x7d23db){if(_0x2d559f)return;_0x2d559f=!![],_0x1ed70d(_0x7d23db);}),pid[_0x2984de]['on'](_0x21016a(0x2d8),async function(_0x3a0286){const _0x5d77ea=_0x21016a;if(installingUpdate)return;if(_0x2d559f)return;_0x2d559f=!![],_0x1ed70d(null);const _0x55aa70=dbConfig[_0x5d77ea(0x382)](_0x5d77ea(0x333))[_0x5d77ea(0x280)]({'botID':_0x2984de})[_0x5d77ea(0x238)]();_0x55aa70&&(_0x55aa70[_0x5d77ea(0x2cc)]==_0x5d77ea(0x1d4)||_0x55aa70[_0x5d77ea(0x2cc)]==_0x5d77ea(0x1fe))&&(await sleep(0x3e8),updateLive(_0x2984de,_0x5d77ea(0x2a4)),logger[_0x5d77ea(0x38a)](_0x5d77ea(0x26e)+_0x2984de),startBot([_0x2984de,userID],{'cwd':bbpath},function(_0x31b3c7){const _0x6a4714=_0x5d77ea;if(_0x31b3c7)logger[_0x6a4714(0x38a)](_0x31b3c7);}));});}function stopBot(_0x16e01e){const _0x43b6d2=_0x4daf42;getClientsWithBotID(_0x16e01e)['forEach'](_0x2e4b66=>{const _0x1506e8=_0xbc42;getSocket(_0x2e4b66['id'])[_0x1506e8(0x251)](!![]),removeClient(_0x2e4b66['id']);}),pid[_0x16e01e]&&(pid[_0x16e01e][_0x43b6d2(0x30e)](),pid[_0x16e01e]=null);}function restartBot(_0x3d3983){if(pid[_0x3d3983])pid[_0x3d3983]['kill']();}function addBot(){const _0x562b00=_0x4daf42;let _0x53eea4;for(let _0x1ecdd6=0x1;_0x1ecdd6<0x3e9;_0x1ecdd6++){_0x53eea4=_0x1ecdd6[_0x562b00(0x30f)]()[_0x562b00(0x2c1)](0x3,'0');let _0x228c00=config[_0x562b00(0x280)](_0xd2cd9d=>_0xd2cd9d[_0x562b00(0x2eb)]==_0x53eea4);if(!_0x228c00)break;}if(_0x53eea4===_0x562b00(0x204)){logger[_0x562b00(0x38a)](_0x562b00(0x1f4));return;}logger['full']('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x53eea4),dbConfig['get'](_0x562b00(0x333))[_0x562b00(0x1cf)]({'botID':_0x53eea4,'botname':_0x562b00(0x2c4)+_0x53eea4,'status':'new','live':''})[_0x562b00(0x233)](),startBot([_0x53eea4,userID],{'cwd':bbpath},function(_0x17c4bb){const _0x5585cc=_0x562b00;if(_0x17c4bb)logger[_0x5585cc(0x38a)](_0x17c4bb);}),config=getConfiguration(),io['to']('botmanager')[_0x562b00(0x334)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function deleteBot(_0x5ab018){const _0x127802=_0x4daf42;getClientsWithBotID(_0x5ab018)[_0x127802(0x20c)](_0x7171d6=>{const _0x35960d=_0x127802;getSocket(_0x7171d6['id'])[_0x35960d(0x251)](!![]),removeClient(_0x7171d6['id']);}),dbConfig['get'](_0x127802(0x333))[_0x127802(0x249)]({'botID':_0x5ab018})[_0x127802(0x233)](),logger[_0x127802(0x38a)]('Deleted\x20Bot\x20'+_0x5ab018),stopBot(_0x5ab018);try{if(fs[_0x127802(0x2e2)](path[_0x127802(0x29a)](configpath,_0x127802(0x21c)+_0x5ab018+_0x127802(0x2b1))))fs[_0x127802(0x27e)](path[_0x127802(0x29a)](configpath,_0x127802(0x21c)+_0x5ab018+'-config.json'));if(fs[_0x127802(0x2e2)](path[_0x127802(0x29a)](configpath,_0x127802(0x21c)+_0x5ab018+_0x127802(0x2f9))))fs[_0x127802(0x27e)](path['join'](configpath,'bot-'+_0x5ab018+_0x127802(0x2f9)));if(fs[_0x127802(0x2e2)](path[_0x127802(0x29a)](configpath,_0x127802(0x21c)+_0x5ab018+_0x127802(0x375))))fs[_0x127802(0x27e)](path[_0x127802(0x29a)](configpath,_0x127802(0x21c)+_0x5ab018+_0x127802(0x375)));if(fs[_0x127802(0x2e2)](path[_0x127802(0x29a)](configpath,_0x127802(0x21c)+_0x5ab018+_0x127802(0x27c))))fs[_0x127802(0x27e)](path[_0x127802(0x29a)](configpath,'bot-'+_0x5ab018+_0x127802(0x27c)));}catch(_0x27b604){if(_0x27b604)logger[_0x127802(0x38a)](_0x127802(0x1f8),_0x27b604);}config=getConfiguration(),io['to'](_0x127802(0x2b4))[_0x127802(0x334)](_0x127802(0x333),config),broadcastToBots(_0x127802(0x333),JSON[_0x127802(0x2cf)](config));}function toggleBot(_0x59af1f,_0x160040,_0x408ce1){const _0x3711d3=_0x4daf42;dbConfig[_0x3711d3(0x382)](_0x3711d3(0x333))[_0x3711d3(0x280)]({'botID':_0x59af1f})[_0x3711d3(0x1e1)]({'status':_0x160040})['assign']({'live':_0x408ce1})[_0x3711d3(0x233)]();if(_0x160040==_0x3711d3(0x1d4)||_0x160040==_0x3711d3(0x1fe))logger[_0x3711d3(0x38a)]('Enabled\x20Bot\x20'+_0x59af1f),startBot([_0x59af1f,userID],{'cwd':bbpath},function(_0x3aab9b){const _0x52fbed=_0x3711d3;if(_0x3aab9b)logger[_0x52fbed(0x38a)](_0x3aab9b);});else(_0x160040=='disabled'||_0x160040==_0x3711d3(0x35a))&&(logger[_0x3711d3(0x38a)](_0x3711d3(0x2d2)+_0x59af1f),stopBot(_0x59af1f));config=getConfiguration(),io['to']('botmanager')[_0x3711d3(0x334)](_0x3711d3(0x333),config),broadcastToBots(_0x3711d3(0x333),JSON[_0x3711d3(0x2cf)](config));}function toggleStatus(_0x59d214){const _0x104bf8=_0x4daf42;let _0x7dda3d=dbConfig[_0x104bf8(0x382)](_0x104bf8(0x333))[_0x104bf8(0x280)]({'botID':_0x59d214})[_0x104bf8(0x238)](),_0x5e8481;if(_0x7dda3d[_0x104bf8(0x2cc)]===_0x104bf8(0x1d4))_0x5e8481=_0x104bf8(0x250);else{if(_0x7dda3d['status']==='new')_0x5e8481=_0x104bf8(0x35a);else{if(_0x7dda3d[_0x104bf8(0x2cc)]===_0x104bf8(0x35a))_0x5e8481=_0x104bf8(0x1fe);else{if(_0x7dda3d[_0x104bf8(0x2cc)]===_0x104bf8(0x250))_0x5e8481=_0x104bf8(0x1d4);}}}return _0x5e8481;}function updateStatus(_0x33f63f,_0x2352ce){const _0x120886=_0x4daf42;dbConfig[_0x120886(0x382)](_0x120886(0x333))[_0x120886(0x280)]({'botID':_0x33f63f})[_0x120886(0x1e1)]({'status':_0x2352ce})[_0x120886(0x233)](),config=getConfiguration(),io['to']('botmanager')[_0x120886(0x334)]('bots',config),broadcastToBots(_0x120886(0x333),JSON[_0x120886(0x2cf)](config));}function _0x4e1a(){const _0x567e78=['callback_query','copyFileSync','getUTCHours','join','backup/','\x1b[33m','************','/status\x20-\x20show\x20bot(s)\x20status\x0a','name','api-eu.mixpanel.com','clientip','yes','statSync','stopped','size','127.0.0.1','date-fns','<b>Balance\x20Bot\x20Status:</b>\x0a','logout','once','readdirSync','2FA\x20login\x20token\x20generated','Invalid\x20authentication\x20token\x20(2)','User\x20has\x20been\x20validated','#RES#\x20if\x20running\x20locally\x0a','#RES#\x20','-config.json','RSA','http','botmanager','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','backup-full','connected','store-fiat','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','file','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Password\x20has\x20been\x20reset\x20to:\x20','Unauthorized\x20attempt\x20to\x20show\x20configuration','getTime','includes','bbPassword','padStart','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','filter','Bot\x20','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','build','Notifications\x20enabled','hybrid-crypto-js','telegram','store-configuration','showConfig','status','add-bot','family','stringify','Allow\x20login\x20from\x20IP\x20address\x20<b>','Login\x20rejected','Disabled\x20Bot\x20','type','Token\x20blacklisted','secret','store-headless','static','exit','telegramUsername','No\x20authentication\x20token','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','sortBy','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','keys','headless','init','live','existsSync','telegramIpApproval','Restore\x20process\x20aborted','-----------------------------------------------------------------------------------','99iFhmMJ','***','68211hpSuTo','Unauthorized\x20attempt\x20to\x20get\x20events','argv','botID','backup','function','telegramChatId','temporaryAccessAllowed','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','f2aRequired','whitelistEnabled','orders','output-002.log','</b>\x20?','744TUCPFG','/:bot/configuration','apiPassword','-events.json',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','debug','invalid\x20credentials','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','::1','apiSecret','getMonth','\x20|\x20user:\x20...','RSA-OAEP','Notifications\x20types:\x20','\x20|\x20','then','access','telegramToken','address','sendPortfolioTelegram','temporary\x20access\x20rejected','decrypt','reset-password','settings','kill','toString','cloneDeep','search','login\x20token\x20generated','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','expiry','948QeSbCw','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','secure','Password\x20reset\x20rejected','\x20(2)','hashSync','/:bot/portfolio','latestversion','express','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','socket','telegramEnabled','temp/','onText','match','update-bot','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','sha256','updatebotmanager','chat','get-logs','build2','server','reason','\x1b[36m','resetHistory','Crypt','pidRefreshToken','https://api.ipify.org?format=json','bot','bots','emit','order','port','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','stopPolling','whitelist','login\x20token\x20valid','\x1b[34m','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','compareSync','writeFileSync','<b>Telegram\x20Bot\x20Status:</b>\x0a','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','lowdb/adapters/FileSync','.zip','/off\x20-\x20stop\x20bot(s)\x0a','remoteAddress','timeshift','SIGINT','started','rmSync','send','axios','Logged\x20in\x20user\x20...','files','backup-files','parse','update','bb/','botname','store-settings','Orders','toggleBotMode','/upload-backup','logged\x20out','hasOwnProperty','settings.','2FA','new-disabled','get-backup-files','bbvNew','fork','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','set','reinstall','lastmsgemitted','Invalid\x20Telegram\x20token','inherit','IPv4','test','data','store','Unauthorized\x20attempt\x20to\x20delete\x20bot','404\x20Not\x20Found','37457sakJVG','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','range','/:bot/coins','getFullYear','Bot\x20Mgr\x20>\x20','child_process','Starting\x20bot\x20|\x20Bot\x20','all','privateKey','timestamp','-performance.json','track','Alerts','generateKeyPairAsync','number','success','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','verify','1tYUmRY','Temporary\x20access\x20rejected','max','\x20>\x20','get','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','internal','allow','tkn','onepagemode','env','publicKey','full','args','notification','/disable\x20-\x20disable\x20notifications\x0a','message','storeFiat','use','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','defaults','node-telegram-bot-api','bb-secure.json','split','kind','running','removeListener','/download/:type','\x1b[31m','/:bot/performance','reinstall-bb','generate','createServer','Unauthorized\x20attempt\x20to\x20update\x20settings','Setting\x20access:\x20','598110InJOuq','push','2FA\x20required','node-zip','Notifications\x20disabled\x0a','ipc','enabled','Idling\x20bot\x20\x20\x20|\x20Bot\x20','Node.js\x20v','sort','from','output-000.log','Starting\x20Balance\x20Bot\x20reinstallation','6b67f3d61ee94b8f5c80b4affef4c4d9','2139320FFjlFw','handshake','alias','\x20minutes','reload','assign','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','bbvReceive','userid','telegram2FaApproval','sign','All\x20bots','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Invalid\x20username\x20or\x20IP\x20address','zip/','restore-backup-file','login','ipv6','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','lastmsgtelegram','post','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','telegramEvents','answerCallbackQuery','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','headers','replace','$1_$2_$3','Error\x20while\x20deleting\x20config\x20files:\x20','backup-full@','catch','Yes','3000','alerts','new','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','telegrammsg','Unauthorized\x20attempt\x20to\x20download\x20','mtime','/update\x20-\x20update\x20Balance\x20Bot\x0a','1000','simple','Backup\x20file\x20uploaded','isDirectory','lowdb','error','Starting\x20Balance\x20Bot\x20update','Unauthorized\x20attempt\x20to\x20add\x20bot','forEach','output-001.log','confirm-message','isIPv4MappedAddress','index.html','SIGTERM','pidExpireLogin','exchange','exp','version.json','\x20(1)','Server','Notifications\x20disabled','/enable\x20-\x20enable\x20notifications\x0a','reject','bcryptjs','bot-','apiKey','[ip-address]','/:bot/history','length','NTBA_FIX_319','Unauthorized\x20attempt\x20to\x20confirm\x20message','yargs/yargs','login\x20required','/metrics\x20-\x20show\x20bot\x20performance\x0a','1366558NqvdEj','sockets','sendFile','mkdirSync','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Unauthorized\x20attempt\x20to\x20store\x20configuration','get-starting-balances','getHours','Unauthorized\x20attempt\x20to\x20update\x20bot','user','::ffff:127.0.0.1','delete-alerts','write','params','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','readFileSync','warning','value','/output-000.log','temporary\x20token\x20generated','\x20|\x20client:\x20...','auto','format','Invalid\x20authentication\x20token\x20(1)','getDate',':\x20Bot\x20Mgr\x20>\x20','get-portfolio','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','path','ipaddr.js','/help\x20-\x20show\x20available\x20commands\x0a','encryptedUuid','token','remove','exec','slice','loginRequired','showname','Login\x20accepted','accept','disabled','disconnect','5\x20min','getSeconds','Unauthorized\x20attempt\x20to\x20get\x20portfolio','polling_error','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','\x20mode','username','stop','backupfile','(staging)','bot.js','versions','jsonwebtoken','startsWith','HTML','sendMetricsTelegram','binary','\x1b[0m','config/','manual','mode','update-bb','download','4852EmAUGA','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','placeOrder','(((.+)+)+)+$','Restarting\x20Bot\x20','entries','login\x20not\x20required','delete-bot','temporary\x20access\x20timeout','962388ocRAyE','randomBytes','sendMessage','Invalid\x20IP\x20address','blacklist','getPortfolio','Unauthorized\x20attempt\x20to\x20log\x20out','1833KFZHKx','Logged\x20out\x20user\x20...','-results.json','Unauthorized\x20attempt\x20to\x20get\x20messages','unlinkSync','\x1b[35m','find','log','0.0.0','No\x20bots\x20running\x20right\x20now','clients','All\x20bots\x20running\x20right\x20now','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Restoring\x20bot(s)\x20from\x20backup','uuid','event','Ok,\x20will\x20send\x20order\x20notifications\x20only','bbUsername','show','2FA\x20login\x20required','toIPv4Address','Ok,\x20will\x20send\x20alert\x20notifications\x20only','password','environment','getMinutes','Backup\x20file\x20unzipped\x20and\x20stored','logs/','socket.io','_data'];_0x4e1a=function(){return _0x567e78;};return _0x4e1a();}function updateLive(_0x239e64,_0x53d476){const _0x4852b5=_0x4daf42;dbConfig[_0x4852b5(0x382)]('bots')[_0x4852b5(0x280)]({'botID':_0x239e64})[_0x4852b5(0x1e1)]({'live':_0x53d476})[_0x4852b5(0x233)](),config=getConfiguration(),io['to'](_0x4852b5(0x2b4))['emit'](_0x4852b5(0x333),config),broadcastToBots(_0x4852b5(0x333),JSON['stringify'](config));}function updateBotName(_0x1203a3,_0x5b2c7c){const _0x15cbe1=_0x4daf42;dbConfig[_0x15cbe1(0x382)](_0x15cbe1(0x333))[_0x15cbe1(0x280)]({'botID':_0x1203a3})[_0x15cbe1(0x1e1)]({'botname':_0x5b2c7c})['write'](),config=getConfiguration(),io['to'](_0x15cbe1(0x2b4))[_0x15cbe1(0x334)](_0x15cbe1(0x333),config),broadcastToBots(_0x15cbe1(0x333),JSON[_0x15cbe1(0x2cf)](config));}function updateBotManager(){const _0x249a85=_0x4daf42;config=getConfiguration(),io['to'](_0x249a85(0x2b4))[_0x249a85(0x334)](_0x249a85(0x333),config),broadcastToBots('bots',JSON[_0x249a85(0x2cf)](config));}function toggleBotMode(_0x2c8cc4){const _0x1e3220=_0x4daf42;if(pid[_0x2c8cc4])pid[_0x2c8cc4][_0x1e3220(0x349)]({'function':_0x1e3220(0x354),'args':null});else{const _0x1e2f94=configpath+_0x1e3220(0x21c)+_0x2c8cc4+'-config.json',_0x4780f1=fs[_0x1e3220(0x236)](_0x1e2f94),_0x5262cf=JSON[_0x1e3220(0x34e)](_0x4780f1),_0x280cc7=_0x5262cf[_0x1e3220(0x332)][0x0][_0x1e3220(0x2df)];_0x5262cf['bot'][0x0][_0x1e3220(0x2df)]=!_0x280cc7;const _0x1ea7ac=JSON[_0x1e3220(0x2cf)](_0x5262cf,null,0x2);fs['writeFileSync'](_0x1e2f94,_0x1ea7ac),config=getConfiguration(),io['to'](_0x1e3220(0x2b4))[_0x1e3220(0x334)](_0x1e3220(0x333),config),broadcastToBots(_0x1e3220(0x333),JSON[_0x1e3220(0x2cf)](config));}}function telegramError(_0x27f50b){const _0x482bb8=_0x4daf42;logger[_0x482bb8(0x205)](getTimeStamp()+_0x482bb8(0x2fa));}function validateTelegram(_0x74b003){const _0x190b7e=_0x4daf42;if(_0x74b003[_0x190b7e(0x1d8)][_0x190b7e(0x258)]!=settings['telegramUsername']&&'@'+_0x74b003[_0x190b7e(0x1d8)]['username']!=settings[_0x190b7e(0x2d9)])return tgBot[_0x190b7e(0x275)](_0x74b003[_0x190b7e(0x328)]['id'],_0x190b7e(0x37c),{'parse_mode':_0x190b7e(0x260)})[_0x190b7e(0x1fa)](_0x120919=>{telegramError(_0x120919);}),![];return!![];}async function initTelegram(){const _0x46d588=_0x4daf42;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x46d588(0x307)],{'polling':!![]});let _0x6f7a49=_0x46d588(0x286);_0x6f7a49+='\x0a',_0x6f7a49+=_0x46d588(0x219),_0x6f7a49+=_0x46d588(0x38d),_0x6f7a49+=_0x46d588(0x325),_0x6f7a49+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x6f7a49+='/on\x20-\x20start\x20bot(s)\x0a',_0x6f7a49+=_0x46d588(0x343),_0x6f7a49+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x6f7a49+='/names\x20-\x20show\x20bot\x20names\x0a',_0x6f7a49+=_0x46d588(0x29e),_0x6f7a49+=_0x46d588(0x225),_0x6f7a49+=_0x46d588(0x316),_0x6f7a49+=_0x46d588(0x203),_0x6f7a49+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x6f7a49+=_0x46d588(0x246);let _0x5670e1=_0x46d588(0x36b);_0x5670e1+='\x0a',_0x5670e1+=_0x6f7a49,tgBot[_0x46d588(0x322)](/\/start/,_0x4c28d1=>{const _0x1bdccf=_0x46d588;if(!validateTelegram(_0x4c28d1))return;if(settings[_0x1bdccf(0x2ee)]!=_0x4c28d1[_0x1bdccf(0x328)]['id'])updateSetting('telegramChatId',_0x4c28d1[_0x1bdccf(0x328)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x1bdccf(0x275)](_0x4c28d1[_0x1bdccf(0x328)]['id'],_0x5670e1)[_0x1bdccf(0x1fa)](_0x1376b9=>{telegramError(_0x1376b9);});}),tgBot[_0x46d588(0x322)](/\/enable/,_0x382ce2=>{const _0x541d43=_0x46d588;if(!validateTelegram(_0x382ce2))return;if(settings[_0x541d43(0x2ee)]!=_0x382ce2[_0x541d43(0x328)]['id'])updateSetting(_0x541d43(0x2ee),_0x382ce2[_0x541d43(0x328)]['id']);updateSetting('telegramEnabled',!![]),tgBot['sendMessage'](_0x382ce2[_0x541d43(0x328)]['id'],_0x541d43(0x2c7))[_0x541d43(0x1fa)](_0x4d6184=>{telegramError(_0x4d6184);});}),tgBot[_0x46d588(0x322)](/\/config/,async _0x39f8ee=>{const _0x3c0712=_0x46d588;if(!validateTelegram(_0x39f8ee))return;tgBot[_0x3c0712(0x398)](_0x3c0712(0x297)),tgBot[_0x3c0712(0x275)](_0x39f8ee[_0x3c0712(0x328)]['id'],_0x3c0712(0x2db),{'reply_markup':{'inline_keyboard':[[{'text':_0x3c0712(0x353),'callback_data':_0x3c0712(0x2f3)},{'text':_0x3c0712(0x377),'callback_data':_0x3c0712(0x1fd)},{'text':'All','callback_data':_0x3c0712(0x372)}]]}})[_0x3c0712(0x1fa)](_0x59a07f=>{telegramError(_0x59a07f);}),tgBot['on'](_0x3c0712(0x297),async _0x15e556=>{const _0x374fa9=_0x3c0712,_0x3e3d90=_0x15e556[_0x374fa9(0x366)],_0x298788=_0x15e556[_0x374fa9(0x38e)];tgBot[_0x374fa9(0x1f3)](_0x15e556['id'])[_0x374fa9(0x305)](async()=>{const _0x106fc4=_0x374fa9;_0x3e3d90==_0x106fc4(0x2f3)&&(updateSetting(_0x106fc4(0x1f2),_0x106fc4(0x2f3)),updateSetting(_0x106fc4(0x320),!![]),await tgBot['sendMessage'](_0x298788['chat']['id'],_0x106fc4(0x28a))[_0x106fc4(0x1fa)](_0x1468b4=>{telegramError(_0x1468b4);}));_0x3e3d90==_0x106fc4(0x1fd)&&(updateSetting(_0x106fc4(0x1f2),_0x106fc4(0x1fd)),updateSetting(_0x106fc4(0x320),!![]),await tgBot['sendMessage'](_0x298788[_0x106fc4(0x328)]['id'],_0x106fc4(0x28f))[_0x106fc4(0x1fa)](_0x50f744=>{telegramError(_0x50f744);}));_0x3e3d90==_0x106fc4(0x372)&&(updateSetting(_0x106fc4(0x1f2),_0x106fc4(0x372)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x298788[_0x106fc4(0x328)]['id'],_0x106fc4(0x2b5))[_0x106fc4(0x1fa)](_0x4d3c31=>{telegramError(_0x4d3c31);}));if(!settings[_0x106fc4(0x2ee)])tgBot[_0x106fc4(0x275)](_0x298788[_0x106fc4(0x328)]['id'],_0x106fc4(0x37b))[_0x106fc4(0x1fa)](_0x484f63=>{telegramError(_0x484f63);});}),tgBot[_0x374fa9(0x398)]('callback_query');});}),tgBot[_0x46d588(0x322)](/\/status/,_0x1f7fec=>{const _0x3760b2=_0x46d588;if(!validateTelegram(_0x1f7fec))return;const _0x3968e7=getBotsWithMode();let _0x328f48=_0x3760b2(0x2a8);config[_0x3760b2(0x20c)](_0x525f6a=>{const _0x347ad9=_0x3760b2,_0x46a2df=_0x3968e7[_0x347ad9(0x280)](_0x5926a9=>_0x5926a9[_0x347ad9(0x2eb)]==_0x525f6a[_0x347ad9(0x2eb)])[_0x347ad9(0x266)];_0x328f48+=_0x347ad9(0x2c4)+_0x525f6a['botID']+':\x20'+_0x525f6a['status']+_0x347ad9(0x304)+_0x46a2df+_0x347ad9(0x304)+_0x525f6a['live']+'\x0a';}),_0x328f48+='\x0a',_0x328f48+=_0x3760b2(0x33f),_0x328f48+=!settings[_0x3760b2(0x320)]?_0x3760b2(0x1d2):'Notifications\x20enabled\x0a',_0x328f48+=settings[_0x3760b2(0x320)]?settings[_0x3760b2(0x1f2)]=='all'?_0x3760b2(0x2b9):_0x3760b2(0x303)+settings[_0x3760b2(0x1f2)]+'\x20only\x0a':'',tgBot[_0x3760b2(0x275)](_0x1f7fec[_0x3760b2(0x328)]['id'],_0x328f48,{'parse_mode':_0x3760b2(0x260)})[_0x3760b2(0x1fa)](_0x2af97d=>{telegramError(_0x2af97d);});}),tgBot['onText'](/\/restart/,_0x4abc8e=>{const _0x157a40=_0x46d588;if(!validateTelegram(_0x4abc8e))return;tgBot[_0x157a40(0x398)](_0x157a40(0x297));const _0x4fa22a=getEnabledBots();if(_0x4fa22a[_0x157a40(0x220)]==0x0)tgBot[_0x157a40(0x275)](_0x4abc8e['chat']['id'],_0x157a40(0x283))['catch'](_0x5b38fd=>{telegramError(_0x5b38fd);});else{if(_0x4fa22a[_0x157a40(0x220)]>0x1)_0x4fa22a[_0x157a40(0x1cf)]({'botID':'all'});let _0x5b8155=[],_0x2dc775=[];const _0x1c437a=_0x4fa22a[_0x157a40(0x220)]%0x4==0x0||_0x4fa22a['length']%0x4==0x3||_0x4fa22a[_0x157a40(0x220)]%0x3==0x1?0x4:0x3;let _0x5b3e03=0x0;_0x4fa22a[_0x157a40(0x20c)]((_0x48d301,_0x554275)=>{const _0x7230ef=_0x157a40;if(_0x554275%_0x1c437a==0x0)_0x2dc775=[];_0x2dc775[_0x7230ef(0x1cf)]({'text':_0x48d301['botID']==_0x7230ef(0x372)?_0x7230ef(0x1e7):_0x7230ef(0x2c4)+_0x48d301['botID'],'callback_data':_0x48d301[_0x7230ef(0x2eb)]}),_0x554275%_0x1c437a==0x0&&(_0x5b8155[_0x5b3e03]=_0x2dc775,_0x5b3e03++);}),tgBot[_0x157a40(0x275)](_0x4abc8e[_0x157a40(0x328)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x5b8155}})[_0x157a40(0x1fa)](_0x2df1d0=>{telegramError(_0x2df1d0);}),tgBot['on']('callback_query',async _0x58801b=>{const _0x374188=_0x157a40,_0x35a013=_0x58801b[_0x374188(0x366)],_0x2c9c39=_0x58801b[_0x374188(0x38e)];tgBot['answerCallbackQuery'](_0x58801b['id'])[_0x374188(0x305)](async()=>{_0x35a013=='all'?config['forEach'](_0x18054b=>{const _0x421d13=_0xbc42;restartBot(_0x18054b[_0x421d13(0x2eb)]);}):restartBot(_0x35a013);}),tgBot[_0x374188(0x398)](_0x374188(0x297));});}}),tgBot[_0x46d588(0x322)](/\/on/,_0x3760be=>{const _0x1c7d46=_0x46d588;if(!validateTelegram(_0x3760be))return;tgBot[_0x1c7d46(0x398)](_0x1c7d46(0x297));const _0xab57b3=getDisabledBots();if(_0xab57b3['length']==0x0)tgBot[_0x1c7d46(0x275)](_0x3760be[_0x1c7d46(0x328)]['id'],_0x1c7d46(0x285))[_0x1c7d46(0x1fa)](_0x5d276b=>{telegramError(_0x5d276b);});else{if(_0xab57b3[_0x1c7d46(0x220)]>0x1)_0xab57b3[_0x1c7d46(0x1cf)]({'botID':_0x1c7d46(0x372)});let _0x55692a=[],_0x457a4b=[];const _0x2b6c1e=_0xab57b3[_0x1c7d46(0x220)]%0x4==0x0||_0xab57b3[_0x1c7d46(0x220)]%0x4==0x3||_0xab57b3[_0x1c7d46(0x220)]%0x3==0x1?0x4:0x3;let _0xe9f12b=0x0;_0xab57b3[_0x1c7d46(0x20c)]((_0x58f5d4,_0xe95f33)=>{const _0xd28385=_0x1c7d46;if(_0xe95f33%_0x2b6c1e==0x0)_0x457a4b=[];_0x457a4b['push']({'text':_0x58f5d4['botID']==_0xd28385(0x372)?_0xd28385(0x1e7):'Bot\x20'+_0x58f5d4[_0xd28385(0x2eb)],'callback_data':_0x58f5d4['botID']}),_0xe95f33%_0x2b6c1e==0x0&&(_0x55692a[_0xe9f12b]=_0x457a4b,_0xe9f12b++);}),tgBot['sendMessage'](_0x3760be['chat']['id'],_0x1c7d46(0x26a),{'reply_markup':{'inline_keyboard':_0x55692a}})[_0x1c7d46(0x1fa)](_0x1904dd=>{telegramError(_0x1904dd);}),tgBot['on'](_0x1c7d46(0x297),async _0x3301a7=>{const _0x3deffa=_0x1c7d46,_0x3e387d=_0x3301a7[_0x3deffa(0x366)],_0x352294=_0x3301a7[_0x3deffa(0x38e)];tgBot[_0x3deffa(0x1f3)](_0x3301a7['id'])[_0x3deffa(0x305)](async()=>{const _0x34c8d5=_0x3deffa;_0x3e387d==_0x34c8d5(0x372)?(tgBot[_0x34c8d5(0x275)](_0x352294['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x34c8d5(0x1fa)](_0x53717e=>{telegramError(_0x53717e);}),_0xab57b3[_0x34c8d5(0x20c)](_0x561d3e=>{const _0x534edf=_0x34c8d5;if(_0x561d3e['botID']!=_0x534edf(0x372))toggleBot(_0x561d3e[_0x534edf(0x2eb)],toggleStatus(_0x561d3e[_0x534edf(0x2eb)]),_0x534edf(0x2a4));})):(tgBot['sendMessage'](_0x352294[_0x34c8d5(0x328)]['id'],_0x34c8d5(0x22b)+_0x3e387d)[_0x34c8d5(0x1fa)](_0x30b9d6=>{telegramError(_0x30b9d6);}),toggleBot(_0x3e387d,toggleStatus(_0x3e387d),'stopped'));}),tgBot[_0x3deffa(0x398)]('callback_query');});}}),tgBot[_0x46d588(0x322)](/\/off/,_0x1f6e75=>{const _0x430d29=_0x46d588;if(!validateTelegram(_0x1f6e75))return;tgBot[_0x430d29(0x398)](_0x430d29(0x297));const _0x1fc704=getEnabledBots();if(_0x1fc704[_0x430d29(0x220)]==0x0)tgBot[_0x430d29(0x275)](_0x1f6e75[_0x430d29(0x328)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x5db1ea=>{telegramError(_0x5db1ea);});else{if(_0x1fc704[_0x430d29(0x220)]>0x1)_0x1fc704[_0x430d29(0x1cf)]({'botID':_0x430d29(0x372)});let _0x5af448=[],_0x17ae31=[];const _0xf44d4=_0x1fc704['length']%0x4==0x0||_0x1fc704[_0x430d29(0x220)]%0x4==0x3||_0x1fc704[_0x430d29(0x220)]%0x3==0x1?0x4:0x3;let _0x12d152=0x0;_0x1fc704[_0x430d29(0x20c)]((_0x47bd7f,_0x3dd8a8)=>{const _0x2ece07=_0x430d29;if(_0x3dd8a8%_0xf44d4==0x0)_0x17ae31=[];_0x17ae31[_0x2ece07(0x1cf)]({'text':_0x47bd7f[_0x2ece07(0x2eb)]==_0x2ece07(0x372)?'All\x20bots':_0x2ece07(0x2c4)+_0x47bd7f['botID'],'callback_data':_0x47bd7f['botID']}),_0x3dd8a8%_0xf44d4==0x0&&(_0x5af448[_0x12d152]=_0x17ae31,_0x12d152++);}),tgBot['sendMessage'](_0x1f6e75[_0x430d29(0x328)]['id'],_0x430d29(0x337),{'reply_markup':{'inline_keyboard':_0x5af448}})[_0x430d29(0x1fa)](_0x3af064=>{telegramError(_0x3af064);}),tgBot['on'](_0x430d29(0x297),async _0x2d0bff=>{const _0x3f06a9=_0x430d29,_0x5d587c=_0x2d0bff[_0x3f06a9(0x366)],_0x5de3f9=_0x2d0bff[_0x3f06a9(0x38e)];tgBot[_0x3f06a9(0x1f3)](_0x2d0bff['id'])[_0x3f06a9(0x305)](async()=>{const _0x39cf03=_0x3f06a9;_0x5d587c==_0x39cf03(0x372)?(tgBot[_0x39cf03(0x275)](_0x5de3f9['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')['catch'](_0x43b717=>{telegramError(_0x43b717);}),_0x1fc704[_0x39cf03(0x20c)](_0x474d74=>{const _0x2bd402=_0x39cf03;if(_0x474d74[_0x2bd402(0x2eb)]!='all')toggleBot(_0x474d74[_0x2bd402(0x2eb)],toggleStatus(_0x474d74[_0x2bd402(0x2eb)]),_0x2bd402(0x2a4));})):(tgBot[_0x39cf03(0x275)](_0x5de3f9[_0x39cf03(0x328)]['id'],_0x39cf03(0x340)+_0x5d587c)[_0x39cf03(0x1fa)](_0x2855b6=>{telegramError(_0x2855b6);}),toggleBot(_0x5d587c,toggleStatus(_0x5d587c),_0x39cf03(0x2a4)));}),tgBot[_0x3f06a9(0x398)](_0x3f06a9(0x297));});}}),tgBot[_0x46d588(0x322)](/\/metrics/,_0xa8f4cc=>{const _0x285cae=_0x46d588;if(!validateTelegram(_0xa8f4cc))return;tgBot[_0x285cae(0x398)](_0x285cae(0x297));const _0x40c79e=getEnabledBots();if(_0x40c79e[_0x285cae(0x220)]==0x0)tgBot[_0x285cae(0x275)](_0xa8f4cc[_0x285cae(0x328)]['id'],_0x285cae(0x283))[_0x285cae(0x1fa)](_0x194927=>{telegramError(_0x194927);});else{if(_0x40c79e[_0x285cae(0x220)]>0x1){let _0xf21dcb=[],_0x1604ab=[];const _0x4e5714=_0x40c79e['length']%0x4==0x0||_0x40c79e['length']%0x4==0x3||_0x40c79e[_0x285cae(0x220)]%0x3==0x1?0x4:0x3;let _0x3c6302=0x0;_0x40c79e['forEach']((_0x3aefc1,_0x15f681)=>{const _0x58236c=_0x285cae;if(_0x15f681%_0x4e5714==0x0)_0x1604ab=[];_0x1604ab['push']({'text':_0x58236c(0x2c4)+_0x3aefc1[_0x58236c(0x2eb)],'callback_data':_0x3aefc1[_0x58236c(0x2eb)]}),_0x15f681%_0x4e5714==0x0&&(_0xf21dcb[_0x3c6302]=_0x1604ab,_0x3c6302++);}),tgBot[_0x285cae(0x275)](_0xa8f4cc[_0x285cae(0x328)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0xf21dcb}})[_0x285cae(0x1fa)](_0x9bf5f0=>{telegramError(_0x9bf5f0);}),tgBot['on'](_0x285cae(0x297),async _0x450abe=>{const _0x5d20c9=_0x285cae,_0xcd7f2e=_0x450abe['data'],_0x14067d=_0x450abe['message'];tgBot['answerCallbackQuery'](_0x450abe['id'])[_0x5d20c9(0x305)](async()=>{const _0x3c99a5=_0x5d20c9;if(pid[_0xcd7f2e])pid[_0xcd7f2e][_0x3c99a5(0x349)]({'function':'sendMetricsTelegram','args':null});}),tgBot['removeListener'](_0x5d20c9(0x297));});}else{const _0x3a54ad=_0x40c79e[0x0]['botID'];if(pid[_0x3a54ad])pid[_0x3a54ad][_0x285cae(0x349)]({'function':_0x285cae(0x261),'args':null});}}}),tgBot[_0x46d588(0x322)](/\/portfolio/,_0x463ba2=>{const _0x15cb37=_0x46d588;if(!validateTelegram(_0x463ba2))return;tgBot[_0x15cb37(0x398)]('callback_query');const _0x127ed5=getEnabledBots();if(_0x127ed5[_0x15cb37(0x220)]==0x0)tgBot[_0x15cb37(0x275)](_0x463ba2[_0x15cb37(0x328)]['id'],_0x15cb37(0x283))['catch'](_0x20d36d=>{telegramError(_0x20d36d);});else{if(_0x127ed5['length']>0x1){let _0x565e1e=[],_0x25ee40=[];const _0x3e5450=_0x127ed5[_0x15cb37(0x220)]%0x4==0x0||_0x127ed5[_0x15cb37(0x220)]%0x4==0x3||_0x127ed5[_0x15cb37(0x220)]%0x3==0x1?0x4:0x3;let _0x453971=0x0;_0x127ed5[_0x15cb37(0x20c)]((_0x4ff8fc,_0xf92b12)=>{const _0x3b300a=_0x15cb37;if(_0xf92b12%_0x3e5450==0x0)_0x25ee40=[];_0x25ee40[_0x3b300a(0x1cf)]({'text':_0x3b300a(0x2c4)+_0x4ff8fc[_0x3b300a(0x2eb)],'callback_data':_0x4ff8fc['botID']}),_0xf92b12%_0x3e5450==0x0&&(_0x565e1e[_0x453971]=_0x25ee40,_0x453971++);}),tgBot[_0x15cb37(0x275)](_0x463ba2[_0x15cb37(0x328)]['id'],_0x15cb37(0x33c),{'reply_markup':{'inline_keyboard':_0x565e1e}})[_0x15cb37(0x1fa)](_0x96659e=>{telegramError(_0x96659e);}),tgBot['on'](_0x15cb37(0x297),async _0x3e49f9=>{const _0x13487c=_0x15cb37,_0x296a0c=_0x3e49f9[_0x13487c(0x366)],_0x568c13=_0x3e49f9['message'];tgBot['answerCallbackQuery'](_0x3e49f9['id'])['then'](async()=>{const _0x38985b=_0x13487c;if(pid[_0x296a0c])pid[_0x296a0c]['send']({'function':_0x38985b(0x309),'args':null});}),tgBot[_0x13487c(0x398)]('callback_query');});}else{const _0x9fd47e=_0x127ed5[0x0][_0x15cb37(0x2eb)];if(pid[_0x9fd47e])pid[_0x9fd47e][_0x15cb37(0x349)]({'function':_0x15cb37(0x309),'args':null});}}}),tgBot[_0x46d588(0x322)](/\/update/,async _0xed69d5=>{const _0x288a24=_0x46d588;if(!validateTelegram(_0xed69d5))return;tgBot[_0x288a24(0x398)](_0x288a24(0x297)),await getMessages();if(!updateAvailable)tgBot[_0x288a24(0x275)](_0xed69d5[_0x288a24(0x328)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x288a24(0x1fa)](_0x16cefb=>{telegramError(_0x16cefb);});else!validInstallation?tgBot[_0x288a24(0x275)](_0xed69d5[_0x288a24(0x328)]['id'],_0x288a24(0x2fd))[_0x288a24(0x1fa)](_0x212428=>{telegramError(_0x212428);}):(tgBot['sendMessage'](_0xed69d5[_0x288a24(0x328)]['id'],_0x288a24(0x313),{'reply_markup':{'inline_keyboard':[[{'text':_0x288a24(0x1fb),'callback_data':_0x288a24(0x2a2)},{'text':'No','callback_data':'no'}]]}})[_0x288a24(0x1fa)](_0x42e28d=>{telegramError(_0x42e28d);}),tgBot['on'](_0x288a24(0x297),async _0x408c6e=>{const _0x10e750=_0x288a24,_0x1cdbfb=_0x408c6e[_0x10e750(0x366)],_0x130065=_0x408c6e[_0x10e750(0x38e)];tgBot[_0x10e750(0x1f3)](_0x408c6e['id'])[_0x10e750(0x305)](async()=>{const _0x4d04f3=_0x10e750;_0x1cdbfb==_0x4d04f3(0x2a2)&&(await tgBot['sendMessage'](_0x130065[_0x4d04f3(0x328)]['id'],_0x4d04f3(0x20a))['catch'](_0x13e4c2=>{telegramError(_0x13e4c2);}),updateBB('update')),_0x1cdbfb=='no'&&await tgBot[_0x4d04f3(0x275)](_0x130065[_0x4d04f3(0x328)]['id'],_0x4d04f3(0x256))[_0x4d04f3(0x1fa)](_0x35e3be=>{telegramError(_0x35e3be);});}),tgBot[_0x10e750(0x398)](_0x10e750(0x297));}));}),tgBot[_0x46d588(0x322)](/\/reinstall/,async _0x30c619=>{const _0x81c797=_0x46d588;if(!validateTelegram(_0x30c619))return;tgBot[_0x81c797(0x398)](_0x81c797(0x297)),!validInstallation?tgBot['sendMessage'](_0x30c619[_0x81c797(0x328)]['id'],_0x81c797(0x26b))[_0x81c797(0x1fa)](_0x3a60b9=>{telegramError(_0x3a60b9);}):(tgBot[_0x81c797(0x275)](_0x30c619[_0x81c797(0x328)]['id'],_0x81c797(0x22a),{'reply_markup':{'inline_keyboard':[[{'text':_0x81c797(0x1fb),'callback_data':_0x81c797(0x2a2)},{'text':'No','callback_data':'no'}]]}})[_0x81c797(0x1fa)](_0xa0757b=>{telegramError(_0xa0757b);}),tgBot['on'](_0x81c797(0x297),async _0x3ffa02=>{const _0x51a201=_0x81c797,_0x49e820=_0x3ffa02[_0x51a201(0x366)],_0x18e31a=_0x3ffa02[_0x51a201(0x38e)];tgBot[_0x51a201(0x1f3)](_0x3ffa02['id'])[_0x51a201(0x305)](async()=>{const _0x2e89dc=_0x51a201;_0x49e820=='yes'&&(await tgBot[_0x2e89dc(0x275)](_0x18e31a['chat']['id'],_0x2e89dc(0x1da))[_0x2e89dc(0x1fa)](_0x41dd8f=>{telegramError(_0x41dd8f);}),updateBB(_0x2e89dc(0x360))),_0x49e820=='no'&&await tgBot[_0x2e89dc(0x275)](_0x18e31a[_0x2e89dc(0x328)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')[_0x2e89dc(0x1fa)](_0x5cb001=>{telegramError(_0x5cb001);});}),tgBot[_0x51a201(0x398)](_0x51a201(0x297));}));}),tgBot[_0x46d588(0x322)](/\/toggle/,_0x5b7493=>{const _0x4ee020=_0x46d588;if(!validateTelegram(_0x5b7493))return;tgBot['removeListener'](_0x4ee020(0x297));const _0x51c5f8=getBotsWithMode();if(_0x51c5f8[_0x4ee020(0x220)]==0x0)tgBot[_0x4ee020(0x275)](_0x5b7493['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x4ee020(0x1fa)](_0x479967=>{telegramError(_0x479967);});else{let _0xe02110=[],_0x46d2ad=[];const _0x6ba359=0x2;let _0x1923a0=0x0;_0x51c5f8[_0x4ee020(0x20c)]((_0x241006,_0x161995)=>{const _0x3ef70c=_0x4ee020;if(_0x161995%_0x6ba359==0x0)_0x46d2ad=[];_0x46d2ad[_0x3ef70c(0x1cf)]({'text':'Bot\x20'+_0x241006['botID']+'\x20('+_0x241006['mode']+')','callback_data':_0x241006[_0x3ef70c(0x2eb)]}),_0x161995%_0x6ba359==0x0&&(_0xe02110[_0x1923a0]=_0x46d2ad,_0x1923a0++);}),tgBot[_0x4ee020(0x275)](_0x5b7493[_0x4ee020(0x328)]['id'],_0x4ee020(0x243),{'reply_markup':{'inline_keyboard':_0xe02110}})[_0x4ee020(0x1fa)](_0x218176=>{telegramError(_0x218176);}),tgBot['on'](_0x4ee020(0x297),async _0x57e92f=>{const _0x6589e5=_0x4ee020,_0x278c2d=_0x57e92f['data'],_0x345e9d=_0x57e92f[_0x6589e5(0x38e)];tgBot[_0x6589e5(0x1f3)](_0x57e92f['id'])['then'](async()=>{const _0x561646=_0x6589e5,_0x13cded=_0x51c5f8[_0x561646(0x280)](_0x19c4bf=>_0x19c4bf[_0x561646(0x2eb)]==_0x278c2d),_0x5e9cb6=_0x13cded['mode']==_0x561646(0x23c)?'manual':_0x561646(0x23c);tgBot[_0x561646(0x275)](_0x345e9d[_0x561646(0x328)]['id'],_0x561646(0x383)+_0x278c2d+'\x20to\x20'+_0x5e9cb6+_0x561646(0x257))[_0x561646(0x1fa)](_0x8e8894=>{telegramError(_0x8e8894);}),toggleBotMode(_0x278c2d);}),tgBot[_0x6589e5(0x398)](_0x6589e5(0x297));});}}),tgBot[_0x46d588(0x322)](/\/names/,_0x54a5af=>{const _0x3f1cce=_0x46d588;if(!validateTelegram(_0x54a5af))return;let _0x196cba='';config[_0x3f1cce(0x20c)](_0x3b3ecb=>{const _0x196198=_0x3f1cce;_0x196cba+=_0x196198(0x2c4)+_0x3b3ecb['botID']+':\x20'+_0x3b3ecb[_0x196198(0x351)]+'\x0a';}),tgBot['sendMessage'](_0x54a5af['chat']['id'],_0x196cba,{'parse_mode':_0x3f1cce(0x260)})['catch'](_0x44704a=>{telegramError(_0x44704a);});}),tgBot[_0x46d588(0x322)](/\/disable/,_0x3c6293=>{const _0x3a9cc9=_0x46d588;if(!validateTelegram(_0x3c6293))return;tgBot[_0x3a9cc9(0x275)](_0x3c6293[_0x3a9cc9(0x328)]['id'],_0x3a9cc9(0x218))['catch'](_0x3c662d=>{telegramError(_0x3c662d);}),updateSetting(_0x3a9cc9(0x320),![]);}),tgBot[_0x46d588(0x322)](/\/help/,_0x2868ee=>{const _0x1ebb65=_0x46d588;if(!validateTelegram(_0x2868ee))return;tgBot[_0x1ebb65(0x275)](_0x2868ee['chat']['id'],_0x6f7a49)[_0x1ebb65(0x1fa)](_0x264a54=>{telegramError(_0x264a54);});}),tgBot['on'](_0x46d588(0x255),_0x4f8464=>{const _0x13f266=_0x46d588;_0x4f8464[_0x13f266(0x30f)]()[_0x13f266(0x2bf)](_0x13f266(0x369))&&(logger[_0x13f266(0x38a)]('Invalid\x20Telegram\x20token'),tgBot[_0x13f266(0x338)](),tgBot=null,io['to']('botmanager')[_0x13f266(0x334)](_0x13f266(0x38c),_0x13f266(0x362)));}),process[_0x46d588(0x2aa)](_0x46d588(0x346),()=>{const _0x847698=_0x46d588;if(tgBot)tgBot[_0x847698(0x338)]();process['exit'](0x1);}),process[_0x46d588(0x2aa)](_0x46d588(0x211),()=>{const _0x4de7e3=_0x46d588;if(tgBot)tgBot[_0x4de7e3(0x338)]();process[_0x4de7e3(0x2d8)](0x1);});}}function disableTelegram(){const _0x36e29f=_0x4daf42;tgBot&&(tgBot[_0x36e29f(0x338)](),tgBot=null);}function sendTelegram(_0x274a62,_0x171505){const _0x441297=_0x4daf42;if(settings[_0x441297(0x320)]){if(settings['telegramEvents']=='all'||(_0x171505['type']==_0x441297(0x209)||_0x171505[_0x441297(0x2d3)]==_0x441297(0x237)||_0x171505['type']==_0x441297(0x37a))&&settings[_0x441297(0x1f2)]==_0x441297(0x1fd)||_0x171505[_0x441297(0x2d3)]==_0x441297(0x335)&&settings['telegramEvents']=='orders'){if(tgBot&&settings[_0x441297(0x2ee)]){if(_0x171505[_0x441297(0x24d)])tgBot[_0x441297(0x275)](settings[_0x441297(0x2ee)],_0x171505[_0x441297(0x351)]+_0x441297(0x381)+_0x171505[_0x441297(0x289)])['catch'](_0x30432e=>{telegramError(_0x30432e);});else tgBot[_0x441297(0x275)](settings[_0x441297(0x2ee)],_0x441297(0x2c4)+_0x274a62+_0x441297(0x381)+_0x171505['event'])[_0x441297(0x1fa)](_0xca1997=>{telegramError(_0xca1997);});}}}}async function sendTelegramMsg(_0x1322e4,_0xa1ac56=_0x4daf42(0x260)){const _0x22bc1c=_0x4daf42;return settings[_0x22bc1c(0x320)]&&tgBot&&settings[_0x22bc1c(0x2ee)]?(await tgBot[_0x22bc1c(0x275)](settings[_0x22bc1c(0x2ee)],_0x1322e4,{'parse_mode':_0xa1ac56})['catch'](_0x2c049c=>{telegramError(_0x2c049c);}),!![]):![];}function getDeviceWithIp(_0x560b35){const _0x49c58b=_0x4daf42;return devices[_0x49c58b(0x280)](_0x38df66=>_0x38df66['ip']===_0x560b35);}function temporaryAccess2FA(_0x55bf21,_0x4823fb){const _0x1c94de=_0x4daf42;let _0x39f355=new Date(),_0xcafa57=![];if(lastIpApproval){if(_0x39f355-lastIpApproval<0x1388)_0xcafa57=!![];}lastIpApproval=new Date();if(_0xcafa57)return;tgBot&&settings[_0x1c94de(0x2ee)]&&(tgBot['removeListener'](_0x1c94de(0x297)),tgBot[_0x1c94de(0x275)](settings[_0x1c94de(0x2ee)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x4823fb)[_0x1c94de(0x28c)]+_0x1c94de(0x2f5),{'parse_mode':_0x1c94de(0x260),'reply_markup':{'inline_keyboard':[[{'text':_0x1c94de(0x252),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x1c94de(0x21a),'callback_data':_0x1c94de(0x21a)}]]}})[_0x1c94de(0x1fa)](_0xd27fd5=>{telegramError(_0xd27fd5);}),tgBot['on']('callback_query',async _0x556ead=>{const _0x5f4d59=_0x1c94de,_0x2ea5fd=_0x556ead[_0x5f4d59(0x366)],_0xb4f51f=_0x556ead[_0x5f4d59(0x38e)];tgBot[_0x5f4d59(0x1f3)](_0x556ead['id'])[_0x5f4d59(0x305)](async()=>{const _0x3875b0=_0x5f4d59;devices[_0x55bf21][_0x3875b0(0x2e3)]={'clientip':_0x4823fb,'timestamp':new Date()[_0x3875b0(0x2be)](),'expiry':_0x2ea5fd},_0x2ea5fd!=_0x3875b0(0x21a)?(await tgBot[_0x3875b0(0x275)](_0xb4f51f[_0x3875b0(0x328)]['id'],'Access\x20enabled\x20for\x20'+_0x2ea5fd+_0x3875b0(0x1df),{'parse_mode':_0x3875b0(0x260)})[_0x3875b0(0x1fa)](_0x13dea5=>{telegramError(_0x13dea5);}),io['to'](_0x55bf21)[_0x3875b0(0x334)](_0x3875b0(0x2cc),{'access':{'allow':![],'reason':_0x3875b0(0x1e0),'token':null}})):(await tgBot[_0x3875b0(0x275)](_0xb4f51f['chat']['id'],_0x3875b0(0x37f))[_0x3875b0(0x1fa)](_0x354751=>{telegramError(_0x354751);}),io['to'](_0x55bf21)['emit'](_0x3875b0(0x2cc),{'access':{'allow':![],'reason':_0x3875b0(0x30a),'token':null}}));}),tgBot[_0x5f4d59(0x398)](_0x5f4d59(0x297));}));}function loginAccess2FA(_0x5b8d42,_0x1f28a8){const _0x275c2e=_0x4daf42;tgBot&&settings[_0x275c2e(0x2ee)]&&(tgBot[_0x275c2e(0x398)]('callback_query'),tgBot['sendMessage'](settings[_0x275c2e(0x2ee)],_0x275c2e(0x2d0)+normalizeIP(_0x1f28a8)['show']+'</b>\x20?',{'parse_mode':_0x275c2e(0x260),'reply_markup':{'inline_keyboard':[[{'text':_0x275c2e(0x24f),'callback_data':loginExpiry},{'text':_0x275c2e(0x21a),'callback_data':'reject'}]]}})['catch'](_0x1212f1=>{telegramError(_0x1212f1);}),tgBot['on'](_0x275c2e(0x297),async _0x1b89fb=>{const _0x3e25e7=_0x275c2e,_0x39730f=_0x1b89fb[_0x3e25e7(0x366)],_0x1bd826=_0x1b89fb['message'];tgBot[_0x3e25e7(0x1f3)](_0x1b89fb['id'])[_0x3e25e7(0x305)](async()=>{const _0x374702=_0x3e25e7;devices[_0x5b8d42][_0x374702(0x1e5)]={'clientip':_0x1f28a8,'timestamp':new Date()[_0x374702(0x2be)](),'expiry':_0x39730f},_0x39730f!='reject'?(await tgBot[_0x374702(0x275)](_0x1bd826[_0x374702(0x328)]['id'],_0x374702(0x24e),{'parse_mode':_0x374702(0x260)})[_0x374702(0x1fa)](_0x87a767=>{telegramError(_0x87a767);}),io['to'](_0x5b8d42)[_0x374702(0x334)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x374702(0x275)](_0x1bd826[_0x374702(0x328)]['id'],_0x374702(0x2d1))['catch'](_0x433115=>{telegramError(_0x433115);}),io['to'](_0x5b8d42)[_0x374702(0x334)]('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x3e25e7(0x398)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x21f0e2=_0x4daf42;return dbConfig[_0x21f0e2(0x382)](_0x21f0e2(0x333))[_0x21f0e2(0x2dc)]('botID')['filter']({'status':_0x21f0e2(0x1d4)})[_0x21f0e2(0x238)]()||[];}function getDisabledBots(){const _0x119775=_0x4daf42;return dbConfig['get'](_0x119775(0x333))[_0x119775(0x2dc)](_0x119775(0x2eb))[_0x119775(0x2c3)]({'status':_0x119775(0x250)})[_0x119775(0x238)]()||[];}function getBotAttributes(_0x4a39c3){const _0x4aa125=_0x4daf42;let _0x4ba3be={};const _0x50e6b0=configpath+_0x4aa125(0x21c)+_0x4a39c3+'-config.json',_0x43522f=fs['existsSync'](_0x50e6b0);if(_0x43522f){const _0x263849=fs[_0x4aa125(0x236)](_0x50e6b0);try{const _0x35464e=JSON[_0x4aa125(0x34e)](_0x263849),_0x253767=_0x35464e?_0x35464e[_0x4aa125(0x332)][0x0][_0x4aa125(0x2df)]:![];_0x4ba3be[_0x4aa125(0x266)]=_0x253767?'auto':_0x4aa125(0x265),_0x4ba3be['botname']=_0x35464e?_0x35464e[_0x4aa125(0x332)][0x0][_0x4aa125(0x351)]:_0x4aa125(0x2c4)+_0x4a39c3;}catch(_0x4acd0b){_0x4ba3be['mode']=_0x4aa125(0x265),_0x4ba3be[_0x4aa125(0x351)]=_0x4aa125(0x2c4)+_0x4a39c3;}}else _0x4ba3be[_0x4aa125(0x266)]=_0x4aa125(0x265),_0x4ba3be[_0x4aa125(0x351)]=_0x4aa125(0x2c4)+_0x4a39c3;return _0x4ba3be;}function getBotsWithMode(){const _0x64960a=_0x4daf42,_0x5009c0=dbConfig[_0x64960a(0x382)](_0x64960a(0x333))[_0x64960a(0x2dc)](_0x64960a(0x2eb))[_0x64960a(0x238)]()||[];return _0x5009c0[_0x64960a(0x20c)](_0x3950fb=>{const _0x3e9c88=_0x64960a;let _0x52303e=getBotAttributes(_0x3950fb[_0x3e9c88(0x2eb)]);_0x3950fb['mode']=_0x52303e[_0x3e9c88(0x266)];}),_0x5009c0;}function getBotExchanges(){const _0x419ccd=_0x4daf42;let _0x375d77=[];const _0x5f1b2f=dbConfig[_0x419ccd(0x382)]('bots')[_0x419ccd(0x2dc)](_0x419ccd(0x2eb))[_0x419ccd(0x238)]()||[];_0x5f1b2f[_0x419ccd(0x20c)](_0x3c343a=>{const _0x3a2ce4=_0x419ccd;if(_0x3c343a[_0x3a2ce4(0x2cc)]=='enabled'){const _0x5c4c07=configpath+_0x3a2ce4(0x21c)+_0x3c343a[_0x3a2ce4(0x2eb)]+_0x3a2ce4(0x2b1),_0x328e2e=fs[_0x3a2ce4(0x2e2)](_0x5c4c07);let _0x2015da;if(_0x328e2e){const _0x275f8d=fs[_0x3a2ce4(0x236)](_0x5c4c07);try{const _0x3fdd1d=JSON['parse'](_0x275f8d);_0x2015da=_0x3fdd1d?_0x3fdd1d['bot'][0x0][_0x3a2ce4(0x213)]:null;}catch(_0x2d3d3e){}}if(_0x2015da)_0x375d77[_0x3a2ce4(0x1cf)](_0x2015da);}});const _0x429aac=[...new Set(_0x375d77)][_0x419ccd(0x1d7)]();return _0x429aac;}async function initUser(){const _0x34de8c=_0x4daf42;if(!settings[_0x34de8c(0x1e4)]){const _0x1aecfb=uuidRandom();mixpanel[_0x34de8c(0x1de)](_0x1aecfb),updateSetting(_0x34de8c(0x1e4),_0x1aecfb);}}async function initSecure(){const _0x10fefc=_0x4daf42;let _0x21635a=getSecure();if(!_0x21635a[_0x10fefc(0x357)](_0x10fefc(0x2d5))){let _0x1331ff=await generateKeys();_0x21635a['publicKey']=_0x1331ff[_0x10fefc(0x389)],_0x21635a[_0x10fefc(0x373)]=_0x1331ff[_0x10fefc(0x373)],_0x21635a[_0x10fefc(0x2d5)]=crypto[_0x10fefc(0x274)](0x20)[_0x10fefc(0x30f)]('hex');;storeSecure(_0x21635a);}}function getSettings(){const _0x460769=_0x4daf42;return dbSettings[_0x460769(0x382)](_0x460769(0x30d))[_0x460769(0x238)]()||{};}function getSecure(){const _0x4b90cb=_0x4daf42;return dbSecure[_0x4b90cb(0x382)]('secure')[_0x4b90cb(0x238)]()||{};}function getBlacklist(){const _0x4fa2c4=_0x4daf42;return dbSecure[_0x4fa2c4(0x382)]('blacklist')[_0x4fa2c4(0x238)]()||[];}function broadcastToBots(_0x24ddb1,_0x908573){const _0x566882=_0x4daf42;config[_0x566882(0x20c)](_0x51d752=>{const _0x38b1a2=_0x566882;if(_0x51d752[_0x38b1a2(0x2cc)]==_0x38b1a2(0x1d4)&&_0x51d752[_0x38b1a2(0x2e1)]==_0x38b1a2(0x397)||_0x51d752[_0x38b1a2(0x2cc)]==_0x38b1a2(0x1fe)&&_0x51d752[_0x38b1a2(0x2e1)]==_0x38b1a2(0x397)){if(pid[_0x51d752[_0x38b1a2(0x2eb)]])pid[_0x51d752[_0x38b1a2(0x2eb)]][_0x38b1a2(0x349)]({[_0x24ddb1]:_0x908573});}});}function storeSettings(_0x23d984,_0x45180a=![]){const _0x4da640=_0x4daf42;_0x23d984={...settings,..._0x23d984};if(_0x45180a&&_0x23d984['bbPassword']!=_0x4da640(0x29d)&&_0x23d984[_0x4da640(0x2c0)]!='***'&&_0x23d984['bbPassword']!=''){const _0x5d9cfd=crypt[_0x4da640(0x30b)](secure[_0x4da640(0x373)],_0x23d984[_0x4da640(0x2c0)])['message'][_0x4da640(0x395)]('@')[0x0],_0x2078e4=bcrypt['hashSync'](_0x5d9cfd,saltRounds);_0x23d984={..._0x23d984,'bbPassword':_0x2078e4};}if(_0x45180a&&_0x23d984['telegramToken']!=_0x4da640(0x29d)&&_0x23d984['telegramToken']!=_0x4da640(0x2e7)&&_0x23d984[_0x4da640(0x307)]!=''){const _0x50721a=crypt['decrypt'](secure['privateKey'],_0x23d984[_0x4da640(0x307)])[_0x4da640(0x38e)]['split']('@')[0x0];_0x23d984={..._0x23d984,'telegramToken':_0x50721a};}const _0x2cbf2c=_0x23d984[_0x4da640(0x307)]!=_0x4da640(0x29d)&&_0x23d984[_0x4da640(0x307)]!=settings[_0x4da640(0x307)]||_0x23d984[_0x4da640(0x2d9)]!=settings[_0x4da640(0x2d9)],_0x5ea7e2=_0x23d984[_0x4da640(0x307)]==''||_0x23d984[_0x4da640(0x2d9)]=='';if(_0x2cbf2c)_0x23d984['telegramEvents']='all';for(const [_0x337cfd,_0x3adf7f]of Object[_0x4da640(0x26f)](_0x23d984)){if(_0x337cfd=='telegramToken'&&_0x3adf7f==_0x4da640(0x29d)){_0x23d984[_0x4da640(0x307)]=settings['telegramToken'];continue;};if(_0x337cfd==_0x4da640(0x2c0)&&_0x3adf7f==_0x4da640(0x29d)){_0x23d984[_0x4da640(0x2c0)]=settings[_0x4da640(0x2c0)];continue;};dbSettings[_0x4da640(0x35f)]('settings.'+_0x337cfd,_0x3adf7f)[_0x4da640(0x233)]();}settings=_0x23d984,io['to'](_0x4da640(0x2b4))[_0x4da640(0x334)](_0x4da640(0x30d),cleanSettings()),broadcastToBots(_0x4da640(0x345),settings['timeshift']),broadcastToBots(_0x4da640(0x387),settings[_0x4da640(0x387)]);if(_0x2cbf2c&&!_0x5ea7e2)initTelegram();if(_0x2cbf2c&&_0x5ea7e2)disableTelegram();getAllClients()['forEach'](_0x303c30=>{const _0x2789d4=_0x4da640;getSocket(_0x303c30['id'])['emit'](_0x2789d4(0x2cc),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x5ae26a,_0x3b5cfd){const _0x3e434f=_0x4daf42;dbSettings[_0x3e434f(0x35f)](_0x3e434f(0x358)+_0x5ae26a,_0x3b5cfd)['write'](),settings=getSettings(),io['to'](_0x3e434f(0x2b4))[_0x3e434f(0x334)]('settings',cleanSettings());}function storeSecure(_0x399343){const _0x5e76a0=_0x4daf42;dbSecure[_0x5e76a0(0x382)](_0x5e76a0(0x317))['push'](_0x399343)[_0x5e76a0(0x233)](),secure=_0x399343;}function addBlacklist(_0xe9764a){const _0x61233e=_0x4daf42;cleanBlacklist();let _0x202886;devices[_0xe9764a][_0x61233e(0x2e3)]?_0x202886=Math[_0x61233e(0x380)](devices[_0xe9764a][_0x61233e(0x2e3)][_0x61233e(0x314)],loginExpiry):_0x202886=loginExpiry,dbSecure[_0x61233e(0x382)](_0x61233e(0x277))[_0x61233e(0x1cf)]({'expiry':new Date()[_0x61233e(0x2be)]()+_0x202886*0x3c*0x3e8,'token':devices[_0xe9764a]['access'][_0x61233e(0x248)]})['write'](),blacklist=dbSecure[_0x61233e(0x382)](_0x61233e(0x277))[_0x61233e(0x238)]();}function cleanBlacklist(){const _0x1844ed=_0x4daf42;let _0x32d3c6=dbSecure[_0x1844ed(0x382)](_0x1844ed(0x277))[_0x1844ed(0x310)]()[_0x1844ed(0x238)](),_0x2300e2=new Date()[_0x1844ed(0x2be)]();_0x32d3c6[_0x1844ed(0x20c)](_0x2ede69=>{const _0x316a54=_0x1844ed;_0x2ede69[_0x316a54(0x314)]<_0x2300e2&&dbSecure['get'](_0x316a54(0x277))[_0x316a54(0x249)]({'expiry':_0x2ede69[_0x316a54(0x314)]})[_0x316a54(0x233)]();});}function initStates(){const _0x51f88a=_0x4daf42;let _0xffc821=getConfiguration();_0xffc821[_0x51f88a(0x20c)](_0x43e158=>{const _0x5b1202=_0x51f88a;_0x43e158['live']=_0x5b1202(0x2a4);}),storeConfiguration(_0xffc821);}function onKeys(){const _0xb11947=new RSA();return new Promise(_0x5700a9=>{const _0x29b6d5=_0xbc42;_0xb11947[_0x29b6d5(0x378)]()[_0x29b6d5(0x305)](_0x5f3e17=>{_0x5700a9(_0x5f3e17);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x3df434=_0x4daf42;let _0x5cbd51=getSettings(),_0x488847=![];!_0x5cbd51[_0x3df434(0x357)](_0x3df434(0x1ef))&&(_0x5cbd51[_0x3df434(0x1ef)]=0x0,_0x488847=!![]);!_0x5cbd51[_0x3df434(0x357)](_0x3df434(0x361))&&(_0x5cbd51[_0x3df434(0x361)]=0x0,_0x488847=!![]);!_0x5cbd51['hasOwnProperty'](_0x3df434(0x31c))&&(_0x5cbd51['latestversion']=_0x3df434(0x282),_0x488847=!![]);!_0x5cbd51['hasOwnProperty'](_0x3df434(0x387))&&(_0x5cbd51[_0x3df434(0x387)]=![],_0x488847=!![]);if(_0x488847)storeSettings(_0x5cbd51);try{fs[_0x3df434(0x2ab)](configbackuppath,{'withFileTypes':!![]})[_0x3df434(0x20c)](_0x2fa758=>{const _0x4df16c=_0x3df434;if(!_0x2fa758[_0x4df16c(0x207)]()){if(!_0x2fa758['name']['startsWith']('backup-full@'))fs['unlinkSync'](configbackuppath+_0x2fa758[_0x4df16c(0x29f)]);}else fs[_0x4df16c(0x348)](configbackuppath+_0x2fa758[_0x4df16c(0x29f)],{'recursive':!![]});});}catch(_0x32fca3){logger[_0x3df434(0x2fb)]('Error\x20removing\x20old\x20backup\x20files:',_0x32fca3);}}function storeConfiguration(_0x5f003f){const _0x5c8601=_0x4daf42;dbConfig[_0x5c8601(0x382)](_0x5c8601(0x333))['remove']()[_0x5c8601(0x233)](),_0x5f003f[_0x5c8601(0x20c)](_0x2273b8=>{delete _0x2273b8['mode'];}),dbConfig[_0x5c8601(0x382)](_0x5c8601(0x333))['push'](..._0x5f003f)[_0x5c8601(0x233)](),config=_0x5f003f;}function resetPassword(){const _0x47c7e2=_0x4daf42;tgBot&&settings['telegramChatId']&&(tgBot[_0x47c7e2(0x398)](_0x47c7e2(0x297)),tgBot[_0x47c7e2(0x275)](settings[_0x47c7e2(0x2ee)],_0x47c7e2(0x1ff),{'parse_mode':_0x47c7e2(0x260),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x47c7e2(0x1fa)](_0x351fd3=>{telegramError(_0x351fd3);}),tgBot['on'](_0x47c7e2(0x297),async _0x42b867=>{const _0x5c1a75=_0x47c7e2,_0x481bae=_0x42b867['data'],_0x5dbc0e=_0x42b867['message'];tgBot['answerCallbackQuery'](_0x42b867['id'])['then'](async()=>{const _0x71a5e=_0xbc42;if(_0x481bae!='no'){const _0xcf00e4=0xf,_0x1a4a6c=_0x71a5e(0x2bb),_0x2f1238=Array[_0x71a5e(0x1d8)](crypto['randomFillSync'](new Uint32Array(_0xcf00e4)))['map'](_0x5838ac=>_0x1a4a6c[_0x5838ac%_0x1a4a6c[_0x71a5e(0x220)]])[_0x71a5e(0x29a)](''),_0x23e3cb=bcrypt[_0x71a5e(0x31a)](_0x2f1238,saltRounds);storeSettings({'bbPassword':_0x23e3cb}),await tgBot[_0x71a5e(0x275)](_0x5dbc0e[_0x71a5e(0x328)]['id'],_0x71a5e(0x2bc)+_0x2f1238,{'parse_mode':_0x71a5e(0x260)})['catch'](_0x5e9919=>{telegramError(_0x5e9919);});}else await tgBot[_0x71a5e(0x275)](_0x5dbc0e[_0x71a5e(0x328)]['id'],_0x71a5e(0x318))[_0x71a5e(0x1fa)](_0x3ee098=>{telegramError(_0x3ee098);});}),tgBot[_0x5c1a75(0x398)](_0x5c1a75(0x297));}));}async function confirmRestore(_0x2efc85,_0x40f614){const _0x2c37a1=_0x4daf42;io['to'](_0x2c37a1(0x2b4))['emit'](_0x2c37a1(0x38c),_0x2c37a1(0x2f0),'success'),tgBot&&settings['telegramChatId']&&(tgBot['removeListener'](_0x2c37a1(0x297)),await tgBot['sendMessage'](settings[_0x2c37a1(0x2ee)],_0x2c37a1(0x2c2),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x2c37a1(0x2a2)},{'text':'no','callback_data':'no'}]]}})[_0x2c37a1(0x1fa)](_0x1686af=>{telegramError(_0x1686af);}),tgBot['on'](_0x2c37a1(0x297),async _0x2ade75=>{const _0x565527=_0x2c37a1,_0x1bfc50=_0x2ade75[_0x565527(0x366)],_0x60de5b=_0x2ade75[_0x565527(0x38e)];tgBot[_0x565527(0x1f3)](_0x2ade75['id'])['then'](async()=>{const _0x763c6=_0x565527;_0x1bfc50==_0x763c6(0x2a2)?(await tgBot[_0x763c6(0x275)](_0x60de5b['chat']['id'],_0x763c6(0x287),{'parse_mode':_0x763c6(0x260)})[_0x763c6(0x1fa)](_0x50f2d7=>{telegramError(_0x50f2d7);}),unzipFile(_0x2efc85,_0x40f614)):(logger['debug'](_0x763c6(0x2e4)),await tgBot[_0x763c6(0x275)](_0x60de5b['chat']['id'],_0x763c6(0x2e4))[_0x763c6(0x1fa)](_0x33f415=>{telegramError(_0x33f415);}));}),tgBot['removeListener']('callback_query');}));}function getServerTime(){const _0x5e2551=_0x4daf42,_0x16e45b=new Date();return _0x16e45b[_0x5e2551(0x36e)]()+'/'+(_0x16e45b['getMonth']()+0x1)[_0x5e2551(0x30f)]()[_0x5e2551(0x2c1)](0x2,'0')+'/'+_0x16e45b['getDate']()[_0x5e2551(0x30f)]()['padStart'](0x2,'0')+'\x20'+_0x16e45b[_0x5e2551(0x22e)]()[_0x5e2551(0x30f)]()['padStart'](0x2,'0')+':'+_0x16e45b[_0x5e2551(0x292)]()[_0x5e2551(0x30f)]()[_0x5e2551(0x2c1)](0x2,'0')+':'+_0x16e45b[_0x5e2551(0x253)]()[_0x5e2551(0x30f)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x498a98=_0x4daf42,_0x434693=shiftedTime();return _0x434693[_0x498a98(0x36e)]()+'/'+(_0x434693['getMonth']()+0x1)[_0x498a98(0x30f)]()[_0x498a98(0x2c1)](0x2,'0')+'/'+_0x434693[_0x498a98(0x23f)]()[_0x498a98(0x30f)]()[_0x498a98(0x2c1)](0x2,'0')+'\x20'+_0x434693['getHours']()[_0x498a98(0x30f)]()[_0x498a98(0x2c1)](0x2,'0')+':'+_0x434693[_0x498a98(0x292)]()[_0x498a98(0x30f)]()['padStart'](0x2,'0')+':'+_0x434693['getSeconds']()[_0x498a98(0x30f)]()[_0x498a98(0x2c1)](0x2,'0');}function getCleanTimeStamp(){const _0x3cfbdb=_0x4daf42,_0xf8b8a7=shiftedTime();return _0xf8b8a7['getFullYear']()+(_0xf8b8a7['getMonth']()+0x1)[_0x3cfbdb(0x30f)]()[_0x3cfbdb(0x2c1)](0x2,'0')+_0xf8b8a7[_0x3cfbdb(0x23f)]()[_0x3cfbdb(0x30f)]()[_0x3cfbdb(0x2c1)](0x2,'0')+'-'+_0xf8b8a7['getHours']()[_0x3cfbdb(0x30f)]()[_0x3cfbdb(0x2c1)](0x2,'0')+_0xf8b8a7[_0x3cfbdb(0x292)]()['toString']()[_0x3cfbdb(0x2c1)](0x2,'0')+_0xf8b8a7[_0x3cfbdb(0x253)]()[_0x3cfbdb(0x30f)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x46e7f6=_0x4daf42,_0x3e67d6=new Date();let _0x46df0=_0x3e67d6;if(settings[_0x46e7f6(0x345)]&&settings[_0x46e7f6(0x345)]!==0x0)_0x46df0=fns['add'](_0x3e67d6,{'hours':settings[_0x46e7f6(0x345)]});return _0x46df0;}function startScheduler(){const _0x1852ab=_0x4daf42,_0x5c736b=new Date()[_0x1852ab(0x299)](),_0x5d5055=shiftedTime()[_0x1852ab(0x22e)]();_0x5d5055==0x4&&backupConfigFiles();_0x5d5055==0x0&&rotateLogFiles();_0x5c736b%0x6==0x0&&triggerAnalytics();_0x5c736b%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x280224){const _0x1573e8=_0x4daf42;logger[_0x1573e8(0x2fb)]('Restore\x20backup\x20file\x20'+_0x280224);const _0x34ca5b=getBotsWithMode();_0x34ca5b[_0x1573e8(0x220)]>0x0?confirmRestore(configbackuppath,_0x280224):unzipFile(configbackuppath,_0x280224);}async function getBackupFiles(_0x468712=null){const _0x5ed59a=_0x4daf42;let _0x1e32f5=[],_0x38f260=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x38f260[_0x5ed59a(0x1d7)]((_0xc56c5e,_0x308502)=>_0xc56c5e[_0x5ed59a(0x29f)]<_0x308502[_0x5ed59a(0x29f)]?0x1:_0x308502['name']<_0xc56c5e['name']?-0x1:0x0),_0x38f260[_0x5ed59a(0x20c)](_0x3b286a=>{const _0x365367=_0x5ed59a;if(!_0x3b286a[_0x365367(0x207)]()&&_0x3b286a[_0x365367(0x29f)][_0x365367(0x25f)](_0x365367(0x1f9))&&_0x3b286a[_0x365367(0x29f)]['endsWith'](_0x365367(0x342))){const _0xb5ddde=formatDate(fs[_0x365367(0x2a3)](configbackuppath+_0x3b286a[_0x365367(0x29f)])[_0x365367(0x202)]);_0x1e32f5[_0x365367(0x1cf)]({'name':_0x3b286a[_0x365367(0x29f)],'mtime':_0xb5ddde});}});if(_0x468712)io['to'](_0x468712)[_0x5ed59a(0x334)](_0x5ed59a(0x34d),_0x1e32f5);else return _0x1e32f5;}async function backupConfigFiles(){const _0xa3932c=_0x4daf42;await zipFiles(_0xa3932c(0x2b6));const _0x1b6013=getCleanTimeStamp();fs[_0xa3932c(0x298)](zippath+'backup-full.zip',configbackuppath+(_0xa3932c(0x1f9)+_0x1b6013+'.zip'));let _0x1cf4b9=fs[_0xa3932c(0x2ab)](configbackuppath,{'withFileTypes':!![]});_0x1cf4b9[_0xa3932c(0x1d7)]((_0x56b394,_0x5c14e6)=>_0x56b394[_0xa3932c(0x29f)]<_0x5c14e6['name']?0x1:_0x5c14e6['name']<_0x56b394[_0xa3932c(0x29f)]?-0x1:0x0),_0x1cf4b9['length']>maxBackups&&fs[_0xa3932c(0x27e)](configbackuppath+_0x1cf4b9[_0x1cf4b9[_0xa3932c(0x220)]-0x1]['name']);}function rotateLogFiles(){const _0x496b4f=_0x4daf42,_0x297185=fs[_0x496b4f(0x2a3)](logspath+_0x496b4f(0x1d9)),_0x396c35=_0x297185[_0x496b4f(0x2a5)]/0x400;if(_0x396c35>0x64){let _0x47ef8e=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x47ef8e['sort']((_0x112918,_0xb6ce75)=>_0x112918[_0x496b4f(0x29f)]<_0xb6ce75['name']?0x1:_0xb6ce75['name']<_0x112918[_0x496b4f(0x29f)]?-0x1:0x0),_0x47ef8e['forEach'](_0x50aad3=>{const _0x65f3a7=_0x496b4f;if(_0x50aad3[_0x65f3a7(0x29f)]==_0x65f3a7(0x2f4))fs['copyFileSync'](logspath+_0x50aad3['name'],logspath+'output-003.log');if(_0x50aad3[_0x65f3a7(0x29f)]==_0x65f3a7(0x20d))fs[_0x65f3a7(0x298)](logspath+_0x50aad3[_0x65f3a7(0x29f)],logspath+_0x65f3a7(0x2f4));_0x50aad3[_0x65f3a7(0x29f)]==_0x65f3a7(0x1d9)&&(fs[_0x65f3a7(0x298)](logspath+_0x50aad3[_0x65f3a7(0x29f)],logspath+'output-001.log'),fs[_0x65f3a7(0x33e)](logspath+_0x50aad3['name'],''));});}}async function zipFiles(_0x21abc1){const _0xf64b05=_0x4daf42;let _0xee7aa;if(_0x21abc1=='logs')_0xee7aa=logspath;if(_0x21abc1==_0xf64b05(0x2ec))_0xee7aa=configpath;if(_0x21abc1==_0xf64b05(0x2b6))_0xee7aa=configpath;let _0x307a21=fs['readdirSync'](_0xee7aa,{'withFileTypes':!![]});const _0x1c556e=new require('node-zip')();_0x307a21[_0xf64b05(0x20c)](_0x2c0e67=>{const _0x5413b3=_0xf64b05;if(!_0x2c0e67[_0x5413b3(0x207)]()){let _0x413160=fs[_0x5413b3(0x236)](_0xee7aa+_0x2c0e67['name']);if(_0x21abc1==_0x5413b3(0x2ec)){const _0x44744f=/^bot-[0-9]{3}-config.json$/,_0xcbe54a=_0x44744f[_0x5413b3(0x365)](_0x2c0e67['name']);if(_0xcbe54a){const _0x1867c9=JSON['parse'](_0x413160);if(_0x1867c9['bot'][0x0]){_0x1867c9['bot'][0x0][_0x5413b3(0x21d)]='***',_0x1867c9[_0x5413b3(0x332)][0x0][_0x5413b3(0x2ff)]=_0x5413b3(0x2e7);if(_0x1867c9['bot'][0x0][_0x5413b3(0x2f8)])_0x1867c9[_0x5413b3(0x332)][0x0][_0x5413b3(0x2f8)]=_0x5413b3(0x2e7);}_0x413160=JSON[_0x5413b3(0x2cf)](_0x1867c9,null,0x2);}if(_0x2c0e67['name']=='bb-settings.json'){const _0x2ac435=JSON['parse'](_0x413160);if(_0x2ac435['settings']['loginRequired'])_0x2ac435[_0x5413b3(0x30d)][_0x5413b3(0x24c)]=![];if(_0x2ac435[_0x5413b3(0x30d)][_0x5413b3(0x2c0)])_0x2ac435[_0x5413b3(0x30d)][_0x5413b3(0x2c0)]=_0x5413b3(0x2e7);if(_0x2ac435[_0x5413b3(0x30d)][_0x5413b3(0x307)])_0x2ac435[_0x5413b3(0x30d)][_0x5413b3(0x307)]=_0x5413b3(0x2e7);if(_0x2ac435[_0x5413b3(0x30d)][_0x5413b3(0x2ee)])_0x2ac435[_0x5413b3(0x30d)][_0x5413b3(0x2ee)]=null;_0x413160=JSON['stringify'](_0x2ac435,null,0x2);}if(_0x2c0e67[_0x5413b3(0x29f)]!=_0x5413b3(0x394))_0x1c556e[_0x5413b3(0x2ba)](_0x2c0e67['name'],_0x413160);}else _0x1c556e[_0x5413b3(0x2ba)](_0x2c0e67[_0x5413b3(0x29f)],_0x413160);}});const _0x47487d=_0x1c556e[_0xf64b05(0x39d)]({'base64':![],'compression':'DEFLATE'});fs[_0xf64b05(0x33e)](zippath+(_0x21abc1+'.zip'),_0x47487d,'binary');}async function unzipFile(_0x4458d1,_0x370f73){const _0x5b4864=_0x4daf42;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x5b4864(0x20c)](_0x5562ea=>{const _0x4d7ddf=_0x5b4864;if(!_0x5562ea[_0x4d7ddf(0x207)]())fs[_0x4d7ddf(0x348)](configpath+_0x5562ea[_0x4d7ddf(0x29f)]);});const _0x433d6f=fs['readFileSync'](_0x4458d1+_0x370f73,_0x5b4864(0x262)),_0xf3d5e7=new require(_0x5b4864(0x1d1))(_0x433d6f,{'base64':![],'checkCRC32':!![]});Object['keys'](_0xf3d5e7[_0x5b4864(0x34c)])[_0x5b4864(0x20c)](_0x3195e7=>{const _0x5b6df0=_0x5b4864,_0x537880=_0xf3d5e7[_0x5b6df0(0x34c)][_0x3195e7];fs[_0x5b6df0(0x33e)](configpath+_0x537880[_0x5b6df0(0x29f)],_0x537880[_0x5b6df0(0x296)]);}),fs[_0x5b4864(0x2ab)](temppath,{'withFileTypes':!![]})[_0x5b4864(0x20c)](_0x10db3e=>{const _0x59c0a9=_0x5b4864;if(!_0x10db3e[_0x59c0a9(0x207)]())fs[_0x59c0a9(0x348)](temppath+_0x10db3e[_0x59c0a9(0x29f)]);}),logger[_0x5b4864(0x2fb)](_0x5b4864(0x293)),process[_0x5b4864(0x349)]({'restore':!![]},_0xba25bd=>{});}async function getPublicIp(){const _0x40b425=_0x4daf42;try{const _0x410f50=await axios[_0x40b425(0x382)](_0x40b425(0x331));publicip=_0x410f50[_0x40b425(0x366)]['ip'];}catch(_0xccf5ff){}}async function triggerAnalytics(){const _0x3bd1be=_0x4daf42;if(!publicip)await getPublicIp();const _0x592b8a=getBotsWithMode();let _0x2f4acc=0x0;_0x592b8a['forEach'](_0x1f6b73=>{const _0x36d24e=_0xbc42;if(_0x1f6b73[_0x36d24e(0x2cc)]==='enabled')_0x2f4acc++;});const _0x3228ef=getBotExchanges();mixpanel[_0x3bd1be(0x376)](_0x3bd1be(0x217),{'distinct_id':settings[_0x3bd1be(0x1e4)],'ip':publicip,'version':serverversion,'numbots':_0x592b8a[_0x3bd1be(0x220)],'numbotsenabled':_0x2f4acc,'exchanges':_0x3228ef,'environment':environment});}async function getMessages(){const _0xb567b0=_0x4daf42,_0x368dd1='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x48e565=new GraphQLClient(_0x368dd1),_0x1cc60a={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x286834=serverversion[_0xb567b0(0x395)]('.'),_0x414e53=_0x286834[0x0]+'.'+_0x286834[0x1],_0x4bc539=Math['min'](settings[_0xb567b0(0x1ef)],settings[_0xb567b0(0x361)]),_0x3662bb={'last':parseInt(_0x4bc539),'bbm':_0x414e53},_0x18a7da=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x2c885c;try{_0x2c885c=await _0x48e565['request'](_0x18a7da,_0x3662bb,_0x1cc60a);}catch(_0x89c1f){}if(_0x2c885c&&_0x2c885c['messages']){let _0x28af30=settings[_0xb567b0(0x1ef)];newMessages=[];for(const _0x4b8a2d of _0x2c885c['messages']){newMessages[_0xb567b0(0x1cf)](_0x4b8a2d);let _0x5c8202=![];_0x4b8a2d[_0xb567b0(0x35c)]&&(updateSetting(_0xb567b0(0x31c),_0x4b8a2d[_0xb567b0(0x35c)]),_0x5c8202=isNewerVersion(serverversion,_0x4b8a2d[_0xb567b0(0x35c)])||serverversion==_0x4b8a2d[_0xb567b0(0x35c)]);if(!_0x5c8202&&_0x4b8a2d[_0xb567b0(0x379)]>_0x28af30){if(_0x4b8a2d['bbvReceive']==='any'||serverversion[_0xb567b0(0x25f)](_0x4b8a2d[_0xb567b0(0x1e3)])){let _0x468050=''+_0x4b8a2d['title']+'\x0a\x0a'+_0x4b8a2d['message'];const _0x32ef89=await sendTelegramMsg(toTelegramMarkdown(_0x468050),'Markdown');if(_0x32ef89)_0x28af30=_0x4b8a2d[_0xb567b0(0x379)];}}}updateAvailable=isNewerVersion(settings[_0xb567b0(0x31c)],serverversion),updateSetting('lastmsgtelegram',_0x28af30),emitMessages();}}function emitMessages(){const _0x216ac2=_0x4daf42,_0x114cc0=settings['lastmsgemitted'];let _0x500ef1=[];newMessages[_0x216ac2(0x20c)](_0x2634c0=>{const _0x2035a5=_0x216ac2;_0x2634c0['number']>_0x114cc0&&_0x500ef1[_0x2035a5(0x1cf)](_0x2634c0);}),_0x500ef1['length']>0x0&&getAllClients()[_0x216ac2(0x20c)](_0x2647e1=>{const _0x579739=_0x216ac2;getSocket(_0x2647e1['id'])[_0x579739(0x334)](_0x579739(0x38e),_0x500ef1);});}function confirmMessage(_0x437286){const _0x3a1eba=_0x4daf42;updateSetting(_0x3a1eba(0x361),Number(_0x437286));}function isNewerVersion(_0x25cc0e,_0x443813){const _0x1181ea=_0x4daf42,_0xacf748=_0x443813['split']('.'),_0x28b73a=_0x25cc0e[_0x1181ea(0x395)]('.');for(var _0x1149cb=0x0;_0x1149cb<_0x28b73a[_0x1181ea(0x220)];_0x1149cb++){const _0x53764e=~~_0x28b73a[_0x1149cb],_0x41f585=~~_0xacf748[_0x1149cb];if(_0x53764e>_0x41f585)return!![];if(_0x53764e<_0x41f585)return![];}return![];}function toTelegramMarkdown(_0x52aa15){const _0x2a4916=_0x4daf42,_0x2cdce4=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4205f7=/\*{2}(.+?)\*{2}/gim;return _0x52aa15=_0x52aa15[_0x2a4916(0x1f6)](_0x2cdce4,_0x2a4916(0x1f7))[_0x2a4916(0x1f6)](_0x4205f7,'*$1*'),_0x52aa15;}async function validateConfigFile(){const _0x1cb79b=_0x4daf42,_0x22f151=dbConfig['get'](_0x1cb79b(0x333))[_0x1cb79b(0x2dc)](_0x1cb79b(0x2eb))[_0x1cb79b(0x238)]()||[];if(_0x22f151[_0x1cb79b(0x220)]==0x0){let _0x1f041c=0x0,_0x1c4457=[];const _0x23e2c5=/^bot-([0-9]{3})-config.json$/,_0x24c39c=fs[_0x1cb79b(0x2ab)](configpath);_0x24c39c[_0x1cb79b(0x20c)](_0x390c9a=>{const _0x52eb7d=_0x1cb79b,_0x30e51d=_0x23e2c5[_0x52eb7d(0x24a)](_0x390c9a);if(_0x30e51d){const _0x58f27b=_0x30e51d[0x1];let _0x1274f2=getBotAttributes(_0x58f27b);_0x1c4457[_0x52eb7d(0x1cf)]({'botID':_0x58f27b,'botname':_0x1274f2[_0x52eb7d(0x351)],'status':_0x52eb7d(0x250),'live':'stopped'}),_0x1f041c++;}}),_0x1f041c!=0x0&&(dbConfig[_0x1cb79b(0x382)]('bots')[_0x1cb79b(0x1e1)](_0x1c4457)[_0x1cb79b(0x233)](),config=_0x1c4457,restoredConfigFile=_0x1f041c);}}async function restoreConfigNotify(_0xd911c0){const _0x127b48=_0x4daf42;let _0x5656ef;if(restoredConfigFile==0x1)_0x5656ef='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x5656ef=_0x127b48(0x35e);if(_0xd911c0)io['to'](_0x127b48(0x2b4))[_0x127b48(0x334)](_0x127b48(0x38c),_0x5656ef);else{logger[_0x127b48(0x205)]('-----------------------------------------------------------------------------------'),logger[_0x127b48(0x205)](_0x5656ef),logger[_0x127b48(0x205)](_0x127b48(0x2e5)),logger[_0x127b48(0x205)]('');if(tgBot&&settings[_0x127b48(0x2ee)]&&settings[_0x127b48(0x1f2)]!='orders')tgBot['sendMessage'](settings['telegramChatId'],_0x127b48(0x36f)+_0x5656ef)['catch'](_0x520347=>{telegramError(_0x520347);});}}function validateCredentials(_0x4ad91f,_0xdead60){const _0x3bccfb=_0x4daf42;if(_0x4ad91f[_0x3bccfb(0x258)]==settings[_0x3bccfb(0x28b)]&&bcrypt[_0x3bccfb(0x33d)](_0x4ad91f[_0x3bccfb(0x290)],settings[_0x3bccfb(0x2c0)])){if(settings[_0x3bccfb(0x2f1)])return{'allow':![],'reason':_0x3bccfb(0x28d),'token':null};else{const _0x2dcf5f=generateLoginToken(_0xdead60);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x2dcf5f};}}else return{'allow':![],'reason':_0x3bccfb(0x2fc),'token':null};}function refreshToken(_0x529f45){const _0x2f6b6c=_0x4daf42,_0x505a9d=generateLoginToken(_0x529f45);return{'allow':!![],'reason':_0x2f6b6c(0x312),'token':_0x505a9d};}function validateAccess(_0x131e0a,_0x4a57a8,_0x169b67){const _0x5e8191=_0x4daf42,_0x1ed494=_0x169b67?_0x169b67:devices[_0x4a57a8]['ip'];let _0x47a90c;const _0x44638a=_0x458a5d=>{const _0x3226f0=_0xbc42;if(settings[_0x3226f0(0x24c)]){if(settings[_0x3226f0(0x2f1)]){if(telegram2FaApproved(_0x4a57a8)){const _0x59c8c9=generateLoginToken(_0x4a57a8);return{'allow':!![],'reason':_0x3226f0(0x2ac),'token':_0x59c8c9};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x47a90c=validToken(_0x458a5d,_0x4a57a8),_0x47a90c['hasOwnProperty'](_0x3226f0(0x37a))?{'allow':!![],'reason':_0x3226f0(0x33a),'token':_0x458a5d}:{'allow':![],'reason':_0x3226f0(0x224),'token':null};}else return{'allow':!![],'reason':_0x3226f0(0x270),'token':null};};if(settings[_0x5e8191(0x2f2)]){let _0x4b7cbf=[...settings[_0x5e8191(0x339)],_0x5e8191(0x2fe),_0x5e8191(0x231),_0x5e8191(0x2a6)];if(_0x4b7cbf[_0x5e8191(0x2bf)](_0x1ed494))return _0x44638a(_0x131e0a);else{_0x47a90c=validToken(_0x131e0a,_0x4a57a8);if(_0x47a90c[_0x5e8191(0x357)](_0x5e8191(0x37a)))return _0x44638a(_0x131e0a);else{if(telegramIpApproved(_0x4a57a8)){const _0xb1b957=generateToken(_0x4a57a8);return _0x47a90c=_0x44638a(_0x131e0a),_0x47a90c[_0x5e8191(0x385)]?{'allow':!![],'reason':_0x5e8191(0x23a),'token':_0xb1b957}:_0x47a90c;}else return settings[_0x5e8191(0x2ef)]?{'allow':![],'reason':_0x5e8191(0x1d0),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x44638a(_0x131e0a);}function timelyDecrypt(_0x514f02,_0x55837c=!![]){const _0x37a019=_0x4daf42;if(_0x514f02)try{const _0x12fb63=crypt[_0x37a019(0x30b)](secure[_0x37a019(0x373)],_0x514f02)[_0x37a019(0x38e)],_0x301923=_0x12fb63[_0x37a019(0x395)]('@')[0x0],_0x1c22ae=_0x12fb63[_0x37a019(0x395)]('@')[0x1],_0xd4373c=new Date()[_0x37a019(0x2be)]();if(_0x55837c){if(_0xd4373c-_0x1c22ae<maxSecretAge*0x3e8)return _0x301923;else return![];}else return _0x301923;}catch(_0x91d52d){return![];}else return![];}const validToken=(_0x31fb5c,_0x2f5380)=>{const _0xe3edd2=_0x4daf42,_0x188078=devices[_0x2f5380]['ip'];if(!_0x31fb5c)return{'error':_0xe3edd2(0x2da)};for(let _0x47c9c1 of blacklist){if(_0x47c9c1['token']==_0x31fb5c)return{'error':_0xe3edd2(0x2d4)};}let _0x2955bc;try{_0x2955bc=jwt[_0xe3edd2(0x37d)](_0x31fb5c,secure[_0xe3edd2(0x2d5)]+_0x2f5380);}catch{return{'error':_0xe3edd2(0x23e)};}if(!_0x2955bc['hasOwnProperty'](_0xe3edd2(0x2a1))&&!_0x2955bc[_0xe3edd2(0x357)](_0xe3edd2(0x258))||!_0x2955bc[_0xe3edd2(0x357)](_0xe3edd2(0x214)))return{'error':_0xe3edd2(0x2ad)};if(!_0x2955bc['hasOwnProperty'](_0xe3edd2(0x258))&&_0x2955bc[_0xe3edd2(0x357)]('clientip')){const {clientip:_0x1f17ec}=_0x2955bc;return _0x188078==_0x1f17ec?{'success':_0xe3edd2(0x2ae)}:{'error':_0xe3edd2(0x276)};}else{if(_0x2955bc[_0xe3edd2(0x357)](_0xe3edd2(0x258))&&_0x2955bc[_0xe3edd2(0x357)](_0xe3edd2(0x2a1))){const {username:_0x32309c,clientip:_0x346110}=_0x2955bc;return settings[_0xe3edd2(0x28b)]==_0x32309c&&_0x188078==_0x346110?{'success':_0xe3edd2(0x2ae)}:{'error':_0xe3edd2(0x1e9)};}}},generateLoginToken=_0x3e70e6=>{const _0x125c02=_0x4daf42;if(_0x3e70e6){const _0x175712=devices[_0x3e70e6]['ip'];return jwt[_0x125c02(0x1e6)]({'username':settings[_0x125c02(0x28b)],'clientip':_0x175712},secure[_0x125c02(0x2d5)]+_0x3e70e6,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0xb3c97f=>{const _0x2bf041=_0x4daf42;if(_0xb3c97f){const _0x3f336d=devices[_0xb3c97f]['ip'];return jwt[_0x2bf041(0x1e6)]({'clientip':_0x3f336d},secure[_0x2bf041(0x2d5)]+_0xb3c97f,{'expiresIn':devices[_0xb3c97f][_0x2bf041(0x2e3)][_0x2bf041(0x314)]*0x3c});}else return![];},telegramIpApproved=_0x1f71ac=>{const _0x259960=_0x4daf42;let _0xdf778f=![];return devices[_0x1f71ac]['telegramIpApproval']&&devices[_0x1f71ac][_0x259960(0x2e3)][_0x259960(0x314)]!='reject'&&(_0xdf778f=devices[_0x1f71ac][_0x259960(0x2e3)][_0x259960(0x2a1)]==devices[_0x1f71ac]['ip']&&new Date()[_0x259960(0x2be)]()-devices[_0x1f71ac][_0x259960(0x2e3)]['timestamp']<devices[_0x1f71ac][_0x259960(0x2e3)][_0x259960(0x314)]*0x3c*0x3e8),_0xdf778f;},telegram2FaApproved=_0x22f11d=>{const _0x2ddac5=_0x4daf42;let _0x2f00b1=![];return devices[_0x22f11d][_0x2ddac5(0x1e5)]&&devices[_0x22f11d]['telegram2FaApproval']['expiry']!='reject'&&(_0x2f00b1=devices[_0x22f11d][_0x2ddac5(0x1e5)][_0x2ddac5(0x2a1)]==devices[_0x22f11d]['ip']&&new Date()[_0x2ddac5(0x2be)]()-devices[_0x22f11d][_0x2ddac5(0x1e5)][_0x2ddac5(0x374)]<devices[_0x22f11d][_0x2ddac5(0x1e5)][_0x2ddac5(0x314)]*0x3c*0x3e8),_0x2f00b1;},normalizeIP=_0x22a228=>{const _0x4f1ea1=_0x4daf42;let _0x3935ad=null,_0x35996b=null;if(ipaddr['isValid'](_0x22a228)){const _0x5599fa=ipaddr[_0x4f1ea1(0x34e)](_0x22a228);_0x5599fa[_0x4f1ea1(0x396)]()===_0x4f1ea1(0x1ed)?(_0x5599fa[_0x4f1ea1(0x20f)]()&&(_0x3935ad=_0x5599fa[_0x4f1ea1(0x28e)]()['toString']()),_0x35996b=_0x5599fa[_0x4f1ea1(0x30f)]()):(_0x3935ad=_0x5599fa['toString'](),_0x35996b=_0x5599fa['toIPv4MappedAddress']()[_0x4f1ea1(0x30f)]());}return{'show':_0x3935ad?_0x3935ad:_0x35996b,'store':_0x35996b};};function formatDate(_0x2c27b0){const _0x4b322d=_0x4daf42;return _0x2c27b0['getFullYear']()+'/'+(_0x2c27b0[_0x4b322d(0x300)]()+0x1)['toString']()[_0x4b322d(0x2c1)](0x2,'0')+'/'+_0x2c27b0['getDate']()['toString']()[_0x4b322d(0x2c1)](0x2,'0')+'\x20'+_0x2c27b0[_0x4b322d(0x22e)]()[_0x4b322d(0x30f)]()[_0x4b322d(0x2c1)](0x2,'0')+':'+_0x2c27b0[_0x4b322d(0x292)]()[_0x4b322d(0x30f)]()['padStart'](0x2,'0')+':'+_0x2c27b0['getSeconds']()['toString']()[_0x4b322d(0x2c1)](0x2,'0');}function sleep(_0xec0431){return new Promise(_0x393555=>setTimeout(_0x393555,_0xec0431));}