const _0x405f3c=_0x5949;function _0x2a4a(){const _0x59b127=['rmSync','isValid','************','reject','reset-password','getFullYear','removeAllListeners','/:bot/support','kill','isDirectory','Password\x20has\x20been\x20reset\x20to:\x20','slice','messages','settings.','toIPv4MappedAddress','store-configuration','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','confirm-message','live','family','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','backupfile','<b>Telegram\x20Bot\x20Status:</b>\x0a','build2','Error\x20removing\x20old\x20backup\x20files:','resetHistory','place-order','/on\x20-\x20start\x20bot(s)\x0a','timestamp','exec','2436505gyzkJP','full','_data','telegram2FaApproval','file','jsonwebtoken','new-disabled','0.0.0','address','username','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','message','cloneDeep','backup-full@','-----------------------------------------------------------------------------------','running','whitelistEnabled','token','index.html','botname','getHours','hashSync','\x20|\x20','publicKey','stop','child_process','use','#RES#\x20if\x20running\x20locally\x0a','bots','40bgWexj','sendMessage','temp/','backup-files','store','Logged\x20out\x20user\x20...','\x1b[33m','alerts','telegramChatId','secure','pidRefreshToken','sign','allow','lastmsgtelegram','whitelist','Starting\x20Balance\x20Bot\x20reinstallation','port','Orders','get','kind','auto','copyFileSync','apiSecret','exit','sendMetricsTelegram','privateKey','status','entries','server','createServer','Unauthorized\x20attempt\x20to\x20delete\x20bot','https://api.ipify.org?format=json','apiPassword','defaults','connected','password','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','sortBy','deleteHistoryAlerts','15\x20min','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Unauthorized\x20attempt\x20to\x20confirm\x20message','hasOwnProperty','NTBA_FIX_319','Temporary\x20access\x20rejected','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Deleted\x20Bot\x20','push','build','access\x20timeout','bbvNew','4341716yXJoKn','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Unauthorized\x20attempt\x20to\x20add\x20bot','::1','yes','botID','Bot\x20Mgr\x20>\x20','/upload-backup','new','546nuCGVy','title','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','apiKey','node-zip','existsSync','express-fileupload','split','remove','logout','unlinkSync','1000','onText','/:bot/performance','sendFile','emit','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','backup-full','storeHeadless','from','bcryptjs','number','disconnect','parse','sendPortfolioTelegram','No\x20bots\x20running\x20right\x20now','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','#RES#\x20if\x20running\x20on\x20server','getTime','bot','HTML','temporaryAccessAllowed','version','latestversion','axios','static','data','/download/:type','-config.json','bbPassword','No\x20authentication\x20token','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Backup\x20file\x20unzipped\x20and\x20stored','graphql-request','508364NZXYPl','secret','keys','Unauthorized\x20login\x20attempt\x20(timeout)','stringify','mode','track','http','\x20(2)','referer','\x1b[0m','match','lastmsgemitted','store-fiat','output-001.log','\x1b[31m','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','set','startsWith','All\x20bots','stopPolling','lowdb','type','fork','Unauthorized\x20attempt\x20to\x20store\x20configuration','format','botmanager','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','ipc','show-config','Disabled\x20Bot\x20','randomFillSync','404\x20Not\x20Found','simple','temporary\x20access\x20not\x20allowed','Unauthorized\x20attempt\x20to\x20log\x20out','\x1b[35m','6b67f3d61ee94b8f5c80b4affef4c4d9','encryptedUuid','***','lowdb/adapters/FileSync','Unauthorized\x20attempt\x20to\x20download\x20','readdirSync','bb-config.json','telegramUsername','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','removeListener','callback_query','temporary\x20access\x20timeout','once','temporary\x20access\x20rejected','restore-backup-file','uuid','/enable\x20-\x20enable\x20notifications\x0a','connection','Unauthorized\x20attempt\x20to\x20update\x20bot','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','find','*$1*','logged\x20out','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','add','All\x20bots\x20running\x20right\x20now','notification','uuid-random','telegramToken','\x1b[34m','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','logs/','Logged\x20in\x20user\x20...','Restarting\x20Bot\x20','2686590AHYfzC','update-bb','telegram','2FA\x20login\x20required','Allow\x20login\x20from\x20IP\x20address\x20<b>','search','replace','remoteAddress','version.json','output-002.log','join','range','listen','settings','f2aRequired','toggleBotMode','Unauthorized\x20attempt\x20to\x20update\x20settings','hybrid-crypto-js','reinstall','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','\x20only\x0a','versions','(((.+)+)+)+$','All','manual','crypto','reinstall-bb','path','login','host','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','uncaughtException','apply','config/','writeFileSync','telegramEvents','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','get-starting-balances','/status\x20-\x20show\x20bot(s)\x20status\x0a','\x20|\x20client:\x20...','ipaddr.js','sha256','reason','-performance.json','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','10EDgPaf','/restart\x20-\x20restart\x20bot(s)\x0a','Notifications\x20disabled\x0a','constructor','order','Invalid\x20authentication\x20token\x20(1)','\x20(1)','socket.io','all','bbUsername','bb/','write','telegrammsg','2FA\x20login\x20token\x20generated','3000','statSync','bot-','=>\x20Go\x20to\x20#CYA#http://','zip/','\x20to\x20','getUTCHours','onepagemode','mkdirSync','invalid\x20credentials','Password\x20reset\x20rejected','enabled','catch','forEach','<b>Balance\x20Bot\x20Status:</b>\x0a','login\x20not\x20required','/output-000.log','loginRequired','decrypt','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','</b>\x20?','$1_$2_$3','expiry','getMonth','express','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','-events.json','get-portfolio',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','disabled','Restore\x20process\x20aborted','/help\x20-\x20show\x20available\x20commands\x0a','160413ttKfCP','length','success','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','socket','get-messages','delete-alerts','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','log','.zip','temporary\x20token\x20generated','\x20>\x20','/off\x20-\x20stop\x20bot(s)\x0a','telegramEnabled','Enabled\x20Bot\x20','size','verify','updatebotmanager','sockets','Invalid\x20IP\x20address','name','reload','bot.js','output-000.log','pidExpireLogin','Login\x20accepted','production','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','timeshift','get-backup-files','\x20|\x20user:\x20...','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','auth','getDate','endsWith','assign','backup-full.zip','readFileSync','Session\x20expired\x20for\x20user\x20...','tkn','getSeconds','init','blacklist','userid','accept','Error\x20while\x20deleting\x20config\x20files:\x20','DEFLATE','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','clients','filter','9354128magExp','test','warning','User\x20has\x20been\x20validated','Restore\x20backup\x20file\x20','storeFiat','reset-history','includes','show','Starting\x20bot\x20|\x20Bot\x20','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','node-telegram-bot-api','then','function','getMinutes','debug','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Unauthorized\x20attempt\x20to\x20delete\x20alerts','cancelLoading','bb-secure.json','Unauthorized\x20attempt\x20to\x20get\x20messages','mixpanel','access','store-headless','headless','handshake','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Invalid\x20Telegram\x20token','post','binary','send','get-logs','clientip','inherit','argv','Notifications\x20disabled','bb-settings.json','cancel-loading','isIPv4MappedAddress','Crypt','Bot\x20',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','environment','2FA','60624wXGLGt','Notifications\x20enabled','SIGTERM','emitHistory','Idling\x20bot\x20\x20\x20|\x20Bot\x20','files','Starting\x20#RED#Balance\x20Bot\x20v','Error:\x20Invalid\x20argument\x20','/disable\x20-\x20disable\x20notifications\x0a','\x20minutes','string','mtime','value','/:bot/history','bbvReceive','update','storeConfiguration','padStart','backup','getStartingBalances','sort','2FA\x20required','2FA\x20login\x20rejected','store-settings','Network\x20Interfaces:','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','toString','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','telegramIpApproval','Yes','getPortfolio','RSA-OAEP','stopped','login\x20required','min','chat','generate','Access\x20enabled\x20for\x20','Notifications\x20types:\x20','Unauthorized\x20attempt\x20to\x20show\x20configuration','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','127.0.0.1','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Starting\x20Balance\x20Bot\x20update','event','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','headers','orders','download','(staging)','Alerts','answerCallbackQuery','Starting\x20new\x20bot\x20|\x20Bot\x20','Notifications\x20enabled\x0a'];_0x2a4a=function(){return _0x59b127;};return _0x2a4a();}(function(_0x171398,_0x186564){const _0x22bec4=_0x5949,_0x20bdfd=_0x171398();while(!![]){try{const _0x19000c=-parseInt(_0x22bec4(0x135))/0x1+parseInt(_0x22bec4(0xcc))/0x2*(parseInt(_0x22bec4(0x1d9))/0x3)+-parseInt(_0x22bec4(0xff))/0x4+parseInt(_0x22bec4(0xaf))/0x5+parseInt(_0x22bec4(0x237))/0x6*(-parseInt(_0x22bec4(0x109))/0x7)+parseInt(_0x22bec4(0x20b))/0x8+parseInt(_0x22bec4(0x17d))/0x9*(parseInt(_0x22bec4(0x1aa))/0xa);if(_0x19000c===_0x186564)break;else _0x20bdfd['push'](_0x20bdfd['shift']());}catch(_0x4ca33c){_0x20bdfd['push'](_0x20bdfd['shift']());}}}(_0x2a4a,0x9ce20));const _0x115199=function(){let _0x55fb47=!![];return function(_0x1a2ce3,_0x295cb1){const _0x215018=_0x55fb47?function(){const _0x5cd5d1=_0x5949;if(_0x295cb1){const _0x3e27c2=_0x295cb1[_0x5cd5d1(0x19d)](_0x1a2ce3,arguments);return _0x295cb1=null,_0x3e27c2;}}:function(){};return _0x55fb47=![],_0x215018;};}(),_0x585902=_0x115199(this,function(){const _0x4c2db2=_0x5949;return _0x585902[_0x4c2db2(0x75)]()[_0x4c2db2(0x182)](_0x4c2db2(0x193))[_0x4c2db2(0x75)]()[_0x4c2db2(0x1ad)](_0x585902)[_0x4c2db2(0x182)]('(((.+)+)+)+$');});_0x585902();'use strict';process['env'][_0x405f3c(0xf7)]=0x1;const childProcess=require(_0x405f3c(0xc8)),fs=require('fs'),fns=require('date-fns'),low=require(_0x405f3c(0x14a)),FileSync=require(_0x405f3c(0x15d)),path=require(_0x405f3c(0x198)),crypto=require(_0x405f3c(0x196)),Crypt=require(_0x405f3c(0x18e))[_0x405f3c(0x232)],RSA=require('hybrid-crypto-js')['RSA'],bcrypt=require(_0x405f3c(0x11d)),jwt=require(_0x405f3c(0xb4)),ipaddr=require(_0x405f3c(0x1a5)),argv=require('yargs/yargs')(process[_0x405f3c(0x22d)]['slice'](0x2))[_0x405f3c(0x22d)],uuidRandom=require(_0x405f3c(0x175)),TelegramBot=require(_0x405f3c(0x216)),Mixpanel=require(_0x405f3c(0x220)),axios=require(_0x405f3c(0x12b)),{GraphQLClient,gql}=require(_0x405f3c(0x134)),util=require('util'),fileUpload=require(_0x405f3c(0x10f)),{networkInterfaces}=require('os'),PORT=argv[_0x405f3c(0xdc)]||_0x405f3c(0x1b8),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console['log'](_0x405f3c(0x23e)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1));const HOST=argv[_0x405f3c(0x19a)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x405f3c(0x192)]['node'];let bbpath=_0x405f3c(0x1b4),bbpath2='';const botfile=_0x405f3c(0x1ef),configfile=_0x405f3c(0x160),settingsfile=_0x405f3c(0x22f),securefile=_0x405f3c(0x21e),environment=require('./'+bbpath2+_0x405f3c(0x185))[_0x405f3c(0x235)]||_0x405f3c(0x1f3),maxBackups=0xa;let validInstallation=!![];!fs[_0x405f3c(0x10e)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x405f3c(0x209)),configpath=userID?bbpath+_0x405f3c(0x19e)+userID+'/':bbpath+_0x405f3c(0x19e),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x405f3c(0x17a)+userID+'/':bbpath+_0x405f3c(0x17a),zippath=userID?bbpath+_0x405f3c(0x1bc)+userID+'/':bbpath+_0x405f3c(0x1bc),loggerfile=fs['createWriteStream'](logspath+_0x405f3c(0x1c8),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x405f3c(0xce);!fs[_0x405f3c(0x10e)](configpath)&&fs[_0x405f3c(0x1c0)](configpath);!fs[_0x405f3c(0x10e)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x405f3c(0x10e)](logspath)&&fs[_0x405f3c(0x1c0)](logspath);!fs[_0x405f3c(0x10e)](zippath)&&fs[_0x405f3c(0x1c0)](zippath);!fs[_0x405f3c(0x10e)](temppath)&&fs[_0x405f3c(0x1c0)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x405f3c(0xed)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x405f3c(0xb6),'onepagemode':![]}})[_0x405f3c(0x1b5)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x405f3c(0xed)]({'secure':{},'blacklist':[]})[_0x405f3c(0x1b5)]();let crypt=new Crypt({'md':_0x405f3c(0x1a6),'rsaStandard':_0x405f3c(0x7a)});const saltRounds=0xa,mixpanel=Mixpanel[_0x405f3c(0x202)](_0x405f3c(0x15a),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x405f3c(0x176)]&&settings[_0x405f3c(0x176)]!=''&&settings[_0x405f3c(0x161)]&&settings[_0x405f3c(0x161)]!='')initTelegram();const parseColor=(_0x542c20,_0x26bd6e)=>{const _0x2852c1=_0x405f3c,_0x3b382c=/#[A-Z]{3}#/g;if(typeof _0x542c20==_0x2852c1(0x241)){!_0x26bd6e?_0x542c20=_0x542c20['replace'](_0x3b382c,''):(_0x542c20=_0x542c20[_0x2852c1(0x183)](/#BLU#/g,_0x2852c1(0x177)),_0x542c20=_0x542c20['replace'](/#RED#/g,_0x2852c1(0x144)),_0x542c20=_0x542c20[_0x2852c1(0x183)](/#YEL#/g,_0x2852c1(0xd2)),_0x542c20=_0x542c20['replace'](/#MAG#/g,_0x2852c1(0x159)),_0x542c20=_0x542c20[_0x2852c1(0x183)](/#CYA#/g,'\x1b[36m'),_0x542c20=_0x542c20[_0x2852c1(0x183)](/#RES#/g,_0x2852c1(0x13f)));;}return _0x542c20;},logger={'screen':_0xcd2974=>{const _0x486795=_0x405f3c;console[_0x486795(0x1e1)](parseColor(_0xcd2974,!![]));},'simple':_0x3e6082=>{const _0x500ec0=_0x405f3c;console[_0x500ec0(0x1e1)](parseColor(_0x3e6082,!![])),loggerfile['write'](util[_0x500ec0(0x14e)](parseColor(_0x3e6082,![]))+'\x0a');},'full':async _0x2679d3=>{const _0x457e9c=_0x405f3c,_0x349c09=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x2679d3;console[_0x457e9c(0x1e1)](parseColor(_0x349c09,!![])),loggerfile[_0x457e9c(0x1b5)](util[_0x457e9c(0x14e)](parseColor(_0x349c09,![]))+'\x0a');if(tgBot&&settings[_0x457e9c(0xd4)]&&settings[_0x457e9c(0x1a0)]!=_0x457e9c(0x8a))await tgBot[_0x457e9c(0xcd)](settings[_0x457e9c(0xd4)],_0x457e9c(0x106)+parseColor(_0x2679d3,![]))[_0x457e9c(0x1c4)](_0x47c6fc=>{telegramError(_0x47c6fc);});},'debug':async(_0x20ccc6,_0x92841b='')=>{const _0x53dd44=_0x405f3c,_0x443a9e=getTimeStamp()+_0x53dd44(0x234)+_0x20ccc6;if(debugging)console['log'](parseColor(_0x443a9e,!![]));loggerfile[_0x53dd44(0x1b5)](util['format'](parseColor(_0x443a9e,![]))+'\x0a');if(_0x92841b){if(debugging)console['log'](_0x92841b);loggerfile['write'](util[_0x53dd44(0x14e)](_0x92841b)+'\x0a');}}};process['on'](_0x405f3c(0x19c),function(_0x46b53e){logger['simple'](_0x46b53e);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x405f3c(0x185))[_0x405f3c(0x129)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x405f3c(0x1d0)),app=express(),http=require(_0x405f3c(0x13c))[_0x405f3c(0xe9)](app);app[_0x405f3c(0xc9)](fileUpload({'useTempFiles':!![]})),app[_0x405f3c(0xde)](_0x405f3c(0x12e),async(_0x5b05e5,_0x1b287c)=>{const _0x46ef06=_0x405f3c,_0x1f5bab=_0x5b05e5['params'][_0x46ef06(0x14b)],_0x880ad3=getClientsWithBotID(_0x46ef06(0x14f)),_0x159c69=_0x5b05e5[_0x46ef06(0x89)][_0x46ef06(0x169)],_0x50d7b1=timelyDecrypt(_0x159c69,![]),_0x55d45d=_0x880ad3[_0x46ef06(0x16e)](_0x50f013=>_0x50f013[_0x46ef06(0x169)]==_0x50d7b1);if(_0x55d45d){const _0x5b4f47=normalizeIP(_0x5b05e5['socket']['remoteAddress'])[_0x46ef06(0xd0)],_0x17c2da=_0x5b05e5['headers']['tkn'];if(validateAccess(_0x17c2da,_0x50d7b1,_0x5b4f47)[_0x46ef06(0xd8)])_0x1f5bab==_0x46ef06(0x6d)&&await backupConfigFiles(),await zipFiles(_0x1f5bab),_0x1b287c[_0x46ef06(0x8b)](zippath+(_0x1f5bab+_0x46ef06(0x1e2)),_0x550eff=>{const _0x3e8e06=_0x46ef06;_0x550eff&&(logger[_0x3e8e06(0xb0)]('Failed\x20to\x20download\x20'+_0x1f5bab),logger['simple'](_0x550eff));});else logger['full'](_0x46ef06(0x15e)+_0x1f5bab+_0x46ef06(0x1b0));}else logger[_0x46ef06(0xb0)](_0x46ef06(0x15e)+_0x1f5bab+_0x46ef06(0x13d));}),app[_0x405f3c(0x227)](_0x405f3c(0x107),async(_0x385573,_0x43ce02)=>{const _0x5933c4=_0x405f3c,_0x556eab=getClientsWithBotID(_0x5933c4(0x14f)),_0x17e8c1=_0x385573[_0x5933c4(0x89)][_0x5933c4(0x169)],_0x5ad4d4=timelyDecrypt(_0x17e8c1,![]),_0x2de6c7=_0x556eab[_0x5933c4(0x16e)](_0x41d0ee=>_0x41d0ee[_0x5933c4(0x169)]==_0x5ad4d4);logger[_0x5933c4(0x21a)]('Backup\x20file\x20uploaded');if(_0x2de6c7){const _0x2359c0=normalizeIP(_0x385573[_0x5933c4(0x1dd)][_0x5933c4(0x184)])['store'],_0x581e84=_0x385573[_0x5933c4(0x89)][_0x5933c4(0x200)];if(validateAccess(_0x581e84,_0x5ad4d4,_0x2359c0)[_0x5933c4(0xd8)]){if(_0x385573['files']){const _0x5a0e98=_0x385573[_0x5933c4(0x23c)][_0x5933c4(0xa6)];await _0x5a0e98['mv'](temppath+_0x5a0e98['name']),_0x43ce02[_0x5933c4(0x229)]({'status':!![],'message':'File\x20uploaded'});const _0x258598=getBotsWithMode();_0x258598[_0x5933c4(0x1da)]>0x0?confirmRestore(temppath,_0x5a0e98[_0x5933c4(0x1ed)]):unzipFile(temppath,_0x5a0e98[_0x5933c4(0x1ed)]);}}else logger[_0x5933c4(0xb0)](_0x5933c4(0x1f8));}else logger[_0x5933c4(0xb0)](_0x5933c4(0x1d2));}),app[_0x405f3c(0xc9)](express[_0x405f3c(0x12c)](path[_0x405f3c(0x187)](__dirname,bbpath2,'build2'))),app[_0x405f3c(0xc9)](express[_0x405f3c(0x12c)](path[_0x405f3c(0x187)](__dirname,bbpath2,'build'))),app[_0x405f3c(0xde)]('/',function(_0x783f8e,_0x532a56){const _0x20c59c=_0x405f3c;_0x532a56['sendFile'](path[_0x20c59c(0x187)](__dirname,bbpath2,_0x20c59c(0xa8),_0x20c59c(0xc1)));}),app[_0x405f3c(0xde)]('/:bot',function(_0x3cda14,_0x50295d){const _0x530789=_0x405f3c;_0x50295d[_0x530789(0x117)](path[_0x530789(0x187)](__dirname,bbpath2,'build',_0x530789(0xc1)));}),app[_0x405f3c(0xde)]('/:bot/portfolio',(_0x1ec1eb,_0x5b0f95)=>{const _0x492ff3=_0x405f3c;_0x5b0f95['sendFile'](path[_0x492ff3(0x187)](__dirname,bbpath2,_0x492ff3(0xfc),_0x492ff3(0xc1)));}),app[_0x405f3c(0xde)](_0x405f3c(0x116),(_0x1cda4d,_0x36bc31)=>{const _0x5c7171=_0x405f3c;_0x36bc31['sendFile'](path[_0x5c7171(0x187)](__dirname,bbpath2,_0x5c7171(0xfc),_0x5c7171(0xc1)));}),app[_0x405f3c(0xde)]('/:bot/coins',(_0x4a6805,_0x2ee091)=>{const _0x443e77=_0x405f3c;_0x2ee091['sendFile'](path[_0x443e77(0x187)](__dirname,bbpath2,_0x443e77(0xfc),_0x443e77(0xc1)));}),app[_0x405f3c(0xde)](_0x405f3c(0x244),(_0x56651b,_0x41976c)=>{const _0x4dcdaf=_0x405f3c;_0x41976c[_0x4dcdaf(0x117)](path[_0x4dcdaf(0x187)](__dirname,bbpath2,_0x4dcdaf(0xfc),'index.html'));}),app[_0x405f3c(0xde)]('/:bot/configuration',(_0x2408b1,_0x9d13f6)=>{const _0xa74405=_0x405f3c;_0x9d13f6[_0xa74405(0x117)](path['join'](__dirname,bbpath2,_0xa74405(0xfc),_0xa74405(0xc1)));}),app['get'](_0x405f3c(0x98),(_0x22bd0e,_0x180037)=>{const _0x45e7c5=_0x405f3c;_0x180037[_0x45e7c5(0x117)](path['join'](__dirname,bbpath2,_0x45e7c5(0xfc),_0x45e7c5(0xc1)));});if(HOST)http['listen'](PORT,HOST);else http[_0x405f3c(0x189)](PORT);const io=require(_0x405f3c(0x1b1))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x4d80f5=_0x405f3c;let _0x4187e3='[ip-address]';const _0x289b5e=networkInterfaces(),_0x4cecbf={};for(const _0x43e9d5 of Object[_0x4d80f5(0x137)](_0x289b5e)){for(const _0x1b3817 of _0x289b5e[_0x43e9d5]){if((_0x1b3817[_0x4d80f5(0xa4)]=='IPv4'||_0x1b3817[_0x4d80f5(0xa4)]==0x4)&&!_0x1b3817['internal']){const _0x27bb2d=ipaddr[_0x4d80f5(0x120)](_0x1b3817[_0x4d80f5(0xb7)])[_0x4d80f5(0x188)]();_0x27bb2d!='private'&&(!_0x4cecbf[_0x43e9d5]&&(_0x4cecbf[_0x43e9d5]=[]),_0x4cecbf[_0x43e9d5][_0x4d80f5(0xfb)](_0x1b3817[_0x4d80f5(0xb7)]),_0x4187e3=_0x1b3817[_0x4d80f5(0xb7)]);}}}return{'serverip':_0x4187e3,'netinterfaces':_0x4cecbf};}async function startServer(){const _0x42154b=_0x405f3c,{serverip:_0x4d1567,netinterfaces:_0x1263db}=getServerIP();logger['simple'](''),logger[_0x42154b(0x156)](_0x42154b(0xbd)),await logger[_0x42154b(0xb0)](_0x42154b(0x23d)+serverversion+'#RES#\x20'+(environment=='staging'?_0x42154b(0x8c):'')+'\x0a'+(_0x42154b(0x74)+PORT+_0x42154b(0xca))+(_0x42154b(0x1bb)+_0x4d1567+':'+PORT+_0x42154b(0x124))),logger['simple']('-----------------------------------------------------------------------------------');if(config['length']!=0x0)for(const _0xa443ce of config){if(_0xa443ce[_0x42154b(0xe6)]==_0x42154b(0x1c3)||_0xa443ce[_0x42154b(0xe6)]==_0x42154b(0x108))await logger['full'](_0x42154b(0x214)+_0xa443ce[_0x42154b(0x105)]+_0x42154b(0xc5)+_0xa443ce['botname']),startBot([_0xa443ce['botID'],userID],{'cwd':bbpath},function(_0x90fd57){if(_0x90fd57)logger['full'](_0x90fd57);});else(_0xa443ce['status']==_0x42154b(0x1d6)||_0xa443ce[_0x42154b(0xe6)]==_0x42154b(0xb5))&&await logger[_0x42154b(0xb0)](_0x42154b(0x23b)+_0xa443ce[_0x42154b(0x105)]+_0x42154b(0xc5)+_0xa443ce[_0x42154b(0xc2)]);}else!newBot&&logger[_0x42154b(0x156)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x42154b(0x156)]('-----------------------------------------------------------------------------------'),logger[_0x42154b(0x156)](''),await logger[_0x42154b(0x21a)]('Node.js\x20v'+nodeversion),await logger['debug'](_0x42154b(0x73),_0x1263db);}function startSocket(){const _0x374173=_0x405f3c;io['on'](_0x374173(0x16b),_0x2d9c90=>{const _0x37c559=_0x374173;let _0x404f15,_0x5d2099,_0x2056e7,_0x50ce69,_0x32b9b3;const _0x541d8d=_0x2d9c90['handshake'][_0x37c559(0x89)][_0x37c559(0x13e)];_0x5d2099=_0x541d8d['match'](/bot[0-9]{3}/);if(_0x5d2099)_0x2056e7=_0x5d2099[0x0][_0x37c559(0x140)](/[0-9]{3}/);if(_0x2056e7)_0x404f15=_0x2056e7[0x0];else _0x404f15=_0x37c559(0x14f);const _0x40f696=_0x2d9c90[_0x37c559(0x224)][_0x37c559(0x1f9)][_0x37c559(0x15b)];if(!_0x40f696)_0x2d9c90[_0x37c559(0x118)](_0x37c559(0xe6),{'publicKey':secure[_0x37c559(0xc6)]});else{_0x50ce69=timelyDecrypt(_0x40f696,![]);if(!_0x50ce69)_0x2d9c90[_0x37c559(0x118)](_0x37c559(0xe6),{'publicKey':secure[_0x37c559(0xc6)]});else{_0x32b9b3=normalizeIP(_0x2d9c90['conn'][_0x37c559(0x184)])[_0x37c559(0xd0)];if(!devices[_0x50ce69])devices[_0x50ce69]={'uuid':_0x50ce69,'access':{'token':null}};devices[_0x50ce69]['ip']=_0x32b9b3;const _0x680c6c=addClient(_0x2d9c90['id'],_0x50ce69,_0x404f15);setAccess(_0x680c6c),emitMessages(),_0x2d9c90['on'](_0x37c559(0x199),_0x19f4f6=>{const _0x531c48=_0x37c559,_0x2b1564=timelyDecrypt(_0x19f4f6[_0x531c48(0xef)]);if(_0x2b1564){_0x19f4f6={'username':_0x19f4f6[_0x531c48(0xb8)],'password':_0x2b1564},devices[_0x50ce69][_0x531c48(0x221)]=validateCredentials(_0x19f4f6,_0x50ce69);if(devices[_0x50ce69][_0x531c48(0x221)][_0x531c48(0xd8)]==![]&&devices[_0x50ce69][_0x531c48(0x221)][_0x531c48(0x1a7)]==_0x531c48(0x180))_0x2d9c90[_0x531c48(0x118)]('status',{'access':devices[_0x50ce69]['access']}),loginAccess2FA(_0x50ce69,_0x32b9b3);else{if(devices[_0x50ce69]['access'][_0x531c48(0xd8)]==![]&&devices[_0x50ce69][_0x531c48(0x221)][_0x531c48(0x1a7)]==_0x531c48(0x1c1))_0x2d9c90['emit']('status',{'access':devices[_0x50ce69][_0x531c48(0x221)]});else devices[_0x50ce69][_0x531c48(0x221)][_0x531c48(0xd8)]&&devices[_0x50ce69]['access'][_0x531c48(0x1a7)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x50ce69)['forEach'](_0x283922=>{setAccess(_0x283922);}),logger[_0x531c48(0x21a)](_0x531c48(0x17b)+_0x50ce69[_0x531c48(0x9c)](-0x8)),setTokenRefresh(_0x50ce69),setSessionTimeout(_0x531c48(0x199),_0x50ce69));}}else logger[_0x531c48(0xb0)](_0x531c48(0x138));}),_0x2d9c90['on'](_0x37c559(0x95),()=>{resetPassword();}),_0x2d9c90['on'](_0x37c559(0x11f),_0x55b77e=>{removeClient(_0x2d9c90['id']);}),_0x404f15==_0x37c559(0x14f)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x1f431b){const _0x31c557=_0x405f3c;if(_0x1f431b!=_0x31c557(0x14f)&&config[_0x31c557(0x10c)]!=''){if(pid[_0x1f431b])pid[_0x1f431b][_0x31c557(0x229)]({'function':'initclient','args':null});}_0x1f431b!=_0x31c557(0x14f)&&broadcastToBots(_0x31c557(0xcb),JSON[_0x31c557(0x139)](config));}function reloadBotManager(){const _0x73d64d=_0x405f3c;getClientsWithBotID(_0x73d64d(0x14f))[_0x73d64d(0x1c5)](_0x3d4753=>{getSocket(_0x3d4753['id'])['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x4e1aee){const _0x499464=_0x405f3c;return io[_0x499464(0x1eb)][_0x499464(0x1eb)][_0x499464(0xde)](_0x4e1aee);}function setAccess(_0x44ae36){const _0x5df632=_0x405f3c,_0xd31704=getSocket(_0x44ae36['id']),_0x5b22ef=_0x44ae36['uuid'],_0x1eebe3=_0x44ae36[_0x5df632(0x126)];devices[_0x5b22ef][_0x5df632(0x221)]=validateAccess(devices[_0x5b22ef][_0x5df632(0x221)]['token'],_0x5b22ef),logger[_0x5df632(0x21a)]('Setting\x20access:\x20'+devices[_0x5b22ef][_0x5df632(0x221)]['reason']+_0x5df632(0x1a4)+_0x44ae36['id'][_0x5df632(0x9c)](-0x8)+_0x5df632(0x1f7)+_0x5b22ef[_0x5df632(0x9c)](-0x8)),_0xd31704[_0x5df632(0x187)](_0x5b22ef);if(devices[_0x5b22ef][_0x5df632(0x221)][_0x5df632(0xd8)]){_0xd31704[_0x5df632(0x187)](_0x1eebe3);if(_0x1eebe3==_0x5df632(0x14f))initializeSocketBotManager(_0xd31704);else initializeSocketBot(_0xd31704);initClient(_0x1eebe3);}devices[_0x5b22ef][_0x5df632(0x221)][_0x5df632(0xc0)]&&devices[_0x5b22ef][_0x5df632(0x221)][_0x5df632(0x1a7)]==_0x5df632(0x1e3)&&setSessionTimeout(_0x5df632(0x236),_0x5b22ef),devices[_0x5b22ef][_0x5df632(0x221)][_0x5df632(0xc0)]&&devices[_0x5b22ef][_0x5df632(0x221)][_0x5df632(0x1a7)]==_0x5df632(0x1b7)&&setSessionTimeout(_0x5df632(0x199),_0x5b22ef),_0xd31704[_0x5df632(0x118)]('status',{'status':_0x44ae36[_0x5df632(0xe8)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5b22ef]['access'],'externalip':devices[_0x5b22ef]['ip'],'publicKey':secure[_0x5df632(0xc6)],'userid':settings[_0x5df632(0x204)],'validInstallation':validInstallation}),devices[_0x5b22ef][_0x5df632(0x221)][_0x5df632(0xd8)]==![]&&devices[_0x5b22ef]['access'][_0x5df632(0x1a7)]==_0x5df632(0x70)&&temporaryAccess2FA(_0x5b22ef,devices[_0x5b22ef]['ip']);}function setSessionTimeout(_0x58a49c,_0x13b5bf){const _0x2dd573=_0x405f3c;let _0x205f3c;if(_0x58a49c=='login')_0x205f3c=loginExpiry*0x3c*0x3e8;else _0x205f3c=devices[_0x13b5bf][_0x2dd573(0x77)][_0x2dd573(0x1ce)]*0x3c*0x3e8-(new Date()[_0x2dd573(0x125)]()-devices[_0x13b5bf][_0x2dd573(0x77)][_0x2dd573(0xad)]);if(devices[_0x13b5bf][_0x2dd573(0x1f1)])clearTimeout(devices[_0x13b5bf][_0x2dd573(0x1f1)]);devices[_0x13b5bf][_0x2dd573(0x1f1)]=setTimeout(()=>{const _0x24b153=_0x2dd573;if(devices[_0x13b5bf][_0x24b153(0xd6)])clearTimeout(devices[_0x13b5bf]['pidRefreshToken']);removeSocketListeners(_0x13b5bf),addBlacklist(_0x13b5bf),devices[_0x13b5bf]['telegramIpApproval']=null,devices[_0x13b5bf][_0x24b153(0xb2)]=null,devices[_0x13b5bf][_0x24b153(0x221)][_0x24b153(0xc0)]=null,logger[_0x24b153(0x21a)](_0x24b153(0x1ff)+_0x13b5bf[_0x24b153(0x9c)](-0x8)),devices[_0x13b5bf][_0x24b153(0x221)]=validateAccess(devices[_0x13b5bf][_0x24b153(0x221)]['token'],_0x13b5bf),!(devices[_0x13b5bf]['access'][_0x24b153(0xd8)]&&devices[_0x13b5bf]['access'][_0x24b153(0x1a7)]==_0x24b153(0x1c7))&&(_0x58a49c=='login'?io['to'](_0x13b5bf)[_0x24b153(0x118)]('status',{'access':{'allow':![],'reason':_0x24b153(0xfd),'token':null}}):io['to'](_0x13b5bf)[_0x24b153(0x118)](_0x24b153(0xe6),{'access':{'allow':![],'reason':_0x24b153(0x165),'token':null}})),devices[_0x13b5bf]['access'][_0x24b153(0xc0)]=null;},_0x205f3c);}function setTokenRefresh(_0x124b77){const _0x231835=_0x405f3c;if(devices[_0x124b77][_0x231835(0xd6)])clearTimeout(devices[_0x124b77][_0x231835(0xd6)]);devices[_0x124b77][_0x231835(0xd6)]=setTimeout(()=>{const _0x1383e3=_0x231835;getClientsWithUuid(_0x124b77)['length']!=0x0?(devices[_0x124b77]['access']=refreshToken(_0x124b77),io['to'](_0x124b77)[_0x1383e3(0x118)](_0x1383e3(0xe6),{'status':_0x1383e3(0xee),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x124b77][_0x1383e3(0x221)],'externalip':devices[_0x124b77]['ip'],'publicKey':secure[_0x1383e3(0xc6)],'validInstallation':validInstallation}),setTokenRefresh(_0x124b77)):clearTimeout(devices[_0x124b77][_0x1383e3(0xd6)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1f5865){const _0xb244d9=_0x405f3c,_0x9a6ed7=getClient(_0x1f5865['id'])[_0xb244d9(0x169)];_0x1f5865[_0xb244d9(0x118)]('bots',config),_0x1f5865[_0xb244d9(0x118)](_0xb244d9(0x18a),cleanSettings()),_0x1f5865['on']('add-bot',_0xe9d722=>{const _0x4762c6=_0xb244d9;if(validateAccess(_0xe9d722,_0x9a6ed7)[_0x4762c6(0xd8)])addBot();else logger[_0x4762c6(0xb0)](_0x4762c6(0x102));}),_0x1f5865['on']('update-bot',(_0x195cec,_0x3254c5)=>{const _0x85d449=_0xb244d9;if(validateAccess(_0x3254c5,_0x9a6ed7)[_0x85d449(0xd8)])toggleBot(_0x195cec[_0x85d449(0x105)],_0x195cec[_0x85d449(0xe6)],_0x195cec[_0x85d449(0xa3)]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x1f5865['on']('toggle-bot-mode',(_0x5b3756,_0x25a306)=>{const _0x39e68b=_0xb244d9;if(validateAccess(_0x25a306,_0x9a6ed7)['allow'])toggleBotMode(_0x5b3756);else logger[_0x39e68b(0xb0)](_0x39e68b(0x16c));}),_0x1f5865['on']('delete-bot',(_0x554d25,_0x5786b1)=>{const _0x4b315e=_0xb244d9;if(validateAccess(_0x5786b1,_0x9a6ed7)[_0x4b315e(0xd8)])deleteBot(_0x554d25);else logger[_0x4b315e(0xb0)](_0x4b315e(0xea));}),_0x1f5865['on'](_0xb244d9(0x72),(_0x5b86bd,_0x5b6a0b)=>{const _0x183729=_0xb244d9;if(validateAccess(_0x5b6a0b,_0x9a6ed7)[_0x183729(0xd8)])storeSettings(_0x5b86bd,!![]);else logger[_0x183729(0xb0)](_0x183729(0x18d));}),_0x1f5865['on']('update-bb',_0x1ce8b4=>{const _0x15c3e4=_0xb244d9;if(validateAccess(_0x1ce8b4,_0x9a6ed7)['allow'])updateBB('update');else logger[_0x15c3e4(0xb0)](_0x15c3e4(0x119));}),_0x1f5865['on'](_0xb244d9(0x197),_0x32e378=>{const _0x180045=_0xb244d9;if(validateAccess(_0x32e378,_0x9a6ed7)[_0x180045(0xd8)])updateBB(_0x180045(0x18f));else logger[_0x180045(0xb0)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x1f5865['on'](_0xb244d9(0x1f6),_0x2524dd=>{const _0x19e2b9=_0xb244d9;if(validateAccess(_0x2524dd,_0x9a6ed7)[_0x19e2b9(0xd8)]){const _0x4e8343=getClient(_0x1f5865['id']);if(_0x4e8343)getBackupFiles(_0x4e8343[_0x19e2b9(0x169)]);else logger[_0x19e2b9(0xb0)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x19e2b9(0xb0)](_0x19e2b9(0x10b));}),_0x1f5865['on'](_0xb244d9(0x168),(_0x55f826,_0x51907f)=>{const _0x36c4dc=_0xb244d9;if(validateAccess(_0x51907f,_0x9a6ed7)[_0x36c4dc(0xd8)])restoreBackupFile(_0x55f826);else logger[_0x36c4dc(0xb0)](_0x36c4dc(0x150));}),_0x1f5865['on'](_0xb244d9(0x1de),_0x268705=>{const _0x286f97=_0xb244d9;if(validateAccess(_0x268705,_0x9a6ed7)[_0x286f97(0xd8)])getMessages();else logger[_0x286f97(0xb0)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x1f5865['on'](_0xb244d9(0xa2),(_0x476933,_0x3fcdd3)=>{const _0xfd7842=_0xb244d9;if(validateAccess(_0x3fcdd3,_0x9a6ed7)[_0xfd7842(0xd8)])confirmMessage(_0x476933);else logger[_0xfd7842(0xb0)](_0xfd7842(0xf5));}),_0x1f5865['on']('logout',_0x3172a9=>{const _0x4af0d0=_0xb244d9;if(validateAccess(_0x3172a9,_0x9a6ed7)[_0x4af0d0(0xd8)]){if(devices[_0x9a6ed7][_0x4af0d0(0xd6)])clearTimeout(devices[_0x9a6ed7][_0x4af0d0(0xd6)]);if(devices[_0x9a6ed7][_0x4af0d0(0x1f1)])clearTimeout(devices[_0x9a6ed7][_0x4af0d0(0x1f1)]);removeSocketListeners(getClient(_0x1f5865['id'])[_0x4af0d0(0x169)]),addBlacklist(_0x9a6ed7),devices[_0x9a6ed7][_0x4af0d0(0x77)]=null,devices[_0x9a6ed7][_0x4af0d0(0xb2)]=null,devices[_0x9a6ed7]['access'][_0x4af0d0(0xc0)]=null,logger[_0x4af0d0(0x21a)](_0x4af0d0(0xd1)+_0x9a6ed7[_0x4af0d0(0x9c)](-0x8)),io['to'](getClient(_0x1f5865['id'])['uuid'])['emit']('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x4af0d0(0x158));});}function initializeSocketBot(_0x284b08){const _0x4cf149=_0x405f3c,_0x45872b=getClient(_0x284b08['id'])[_0x4cf149(0x126)],_0xa37cf9=getClient(_0x284b08['id'])['uuid'];_0x284b08['on'](_0x4cf149(0x22a),(_0x20c769,_0x5cc619)=>{const _0x5bcb75=_0x4cf149;if(validateAccess(_0x5cc619,_0xa37cf9)[_0x5bcb75(0xd8)]){if(pid[_0x45872b])pid[_0x45872b][_0x5bcb75(0x229)]({'function':_0x5bcb75(0x23a),'args':_0x20c769});}else logger[_0x5bcb75(0xb0)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x284b08['on'](_0x4cf149(0x1df),(_0x17fbcd,_0x45a62c)=>{const _0x181876=_0x4cf149;if(validateAccess(_0x45a62c,_0xa37cf9)[_0x181876(0xd8)]){if(pid[_0x45872b])pid[_0x45872b][_0x181876(0x229)]({'function':_0x181876(0xf2),'args':_0x17fbcd});}else logger['full'](_0x181876(0x21c));}),_0x284b08['on'](_0x4cf149(0x1d4),(_0x2131d1,_0x3cf57c)=>{const _0x391a3d=_0x4cf149;if(validateAccess(_0x3cf57c,_0xa37cf9)[_0x391a3d(0xd8)]){if(pid[_0x45872b])pid[_0x45872b]['send']({'function':_0x391a3d(0x79),'args':_0x2131d1});}else logger[_0x391a3d(0xb0)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x284b08['on'](_0x4cf149(0xa0),(_0x1699a1,_0x564ff5)=>{const _0x175a73=_0x4cf149;if(validateAccess(_0x564ff5,_0xa37cf9)[_0x175a73(0xd8)]){if(pid[_0x45872b])pid[_0x45872b][_0x175a73(0x229)]({'function':_0x175a73(0x6b),'args':_0x1699a1});}else logger[_0x175a73(0xb0)](_0x175a73(0x14d));}),_0x284b08['on'](_0x4cf149(0x222),(_0x27033a,_0x400b45)=>{const _0x37c33b=_0x4cf149;if(validateAccess(_0x400b45,_0xa37cf9)[_0x37c33b(0xd8)]){if(pid[_0x45872b])pid[_0x45872b][_0x37c33b(0x229)]({'function':_0x37c33b(0x11b),'args':_0x27033a});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x284b08['on'](_0x4cf149(0x142),(_0x10de68,_0x30ed2b)=>{const _0x348fa9=_0x4cf149;if(validateAccess(_0x30ed2b,_0xa37cf9)[_0x348fa9(0xd8)]){if(pid[_0x45872b])pid[_0x45872b][_0x348fa9(0x229)]({'function':_0x348fa9(0x210),'args':_0x10de68});}else logger[_0x348fa9(0xb0)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x284b08['on'](_0x4cf149(0x211),_0x28b948=>{const _0x12277b=_0x4cf149;if(validateAccess(_0x28b948,_0xa37cf9)['allow']){if(pid[_0x45872b])pid[_0x45872b][_0x12277b(0x229)]({'function':_0x12277b(0xaa),'args':null});}else logger[_0x12277b(0xb0)](_0x12277b(0xa1));}),_0x284b08['on'](_0x4cf149(0x1a2),_0x13bb48=>{const _0x38e3f6=_0x4cf149;if(validateAccess(_0x13bb48,_0xa37cf9)[_0x38e3f6(0xd8)]){if(pid[_0x45872b])pid[_0x45872b]['send']({'function':_0x38e3f6(0x6e),'args':null});}else logger['full'](_0x38e3f6(0xf0));}),_0x284b08['on'](_0x4cf149(0xab),(_0x3288ec,_0x376ae5)=>{const _0x2ac373=_0x4cf149;if(validateAccess(_0x376ae5,_0xa37cf9)[_0x2ac373(0xd8)]){if(pid[_0x45872b])pid[_0x45872b][_0x2ac373(0x229)]({'function':'placeOrder','args':_0x3288ec});}else logger[_0x2ac373(0xb0)](_0x2ac373(0x1d1));}),_0x284b08['on'](_0x4cf149(0x230),_0x255780=>{const _0x551979=_0x4cf149;if(validateAccess(_0x255780,_0xa37cf9)[_0x551979(0xd8)]){if(pid[_0x45872b])pid[_0x45872b][_0x551979(0x229)]({'function':_0x551979(0x21d),'args':null});}else logger[_0x551979(0xb0)](_0x551979(0x225));}),_0x284b08['on'](_0x4cf149(0x152),_0x5f4b5c=>{const _0x19b318=_0x4cf149;if(validateAccess(_0x5f4b5c,_0xa37cf9)[_0x19b318(0xd8)]){if(pid[_0x45872b])pid[_0x45872b][_0x19b318(0x229)]({'function':'showConfig','args':null});}else logger[_0x19b318(0xb0)](_0x19b318(0x82));}),_0x284b08['on'](_0x4cf149(0x17e),_0xf27dcd=>{const _0x538229=_0x4cf149;if(validateAccess(_0xf27dcd,_0xa37cf9)[_0x538229(0xd8)])updateBB(_0x538229(0x246));else logger[_0x538229(0xb0)](_0x538229(0x119));}),_0x284b08['on'](_0x4cf149(0x1de),_0x596fac=>{const _0x196cb1=_0x4cf149;if(validateAccess(_0x596fac,_0xa37cf9)[_0x196cb1(0xd8)])getMessages();else logger[_0x196cb1(0xb0)](_0x196cb1(0x21f));}),_0x284b08['on'](_0x4cf149(0xa2),(_0x201fbd,_0x3488da)=>{const _0x1655e9=_0x4cf149;if(validateAccess(_0x3488da,_0xa37cf9)[_0x1655e9(0xd8)])confirmMessage(_0x201fbd);else logger[_0x1655e9(0xb0)](_0x1655e9(0xf5));}),_0x284b08['on'](_0x4cf149(0x112),_0x17b7b4=>{const _0x3e3d20=_0x4cf149;if(validateAccess(_0x17b7b4,_0xa37cf9)[_0x3e3d20(0xd8)]){if(devices[_0xa37cf9][_0x3e3d20(0xd6)])clearTimeout(devices[_0xa37cf9]['pidRefreshToken']);if(devices[_0xa37cf9]['pidExpireLogin'])clearTimeout(devices[_0xa37cf9][_0x3e3d20(0x1f1)]);removeSocketListeners(getClient(_0x284b08['id'])[_0x3e3d20(0x169)]),addBlacklist(_0xa37cf9),devices[_0xa37cf9][_0x3e3d20(0x77)]=null,devices[_0xa37cf9][_0x3e3d20(0xb2)]=null,devices[_0xa37cf9][_0x3e3d20(0x221)][_0x3e3d20(0xc0)]=null,logger[_0x3e3d20(0x21a)](_0x3e3d20(0xd1)+_0xa37cf9[_0x3e3d20(0x9c)](-0x8)),io['to'](getClient(_0x284b08['id'])[_0x3e3d20(0x169)])[_0x3e3d20(0x118)](_0x3e3d20(0xe6),{'access':{'allow':![],'reason':_0x3e3d20(0x170),'token':null}});}else logger[_0x3e3d20(0xb0)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x4f444c){const _0x34e344=_0x405f3c;getClientsWithUuid(_0x4f444c)[_0x34e344(0x1c5)](_0x3fce5f=>{const _0x3afa80=_0x34e344;getSocket(_0x3fce5f['id'])[_0x3afa80(0x97)]();});}function cleanSettings(){const _0x49c23a=_0x405f3c;let _0x5e703e=settings;return settings[_0x49c23a(0x176)]&&settings[_0x49c23a(0x176)]!=''&&(_0x5e703e={..._0x5e703e,'telegramToken':'************'}),settings[_0x49c23a(0x130)]&&settings[_0x49c23a(0x130)]!=''&&(_0x5e703e={..._0x5e703e,'bbPassword':'************'}),(settings['bbPassword']&&settings[_0x49c23a(0x130)]=='***'||settings[_0x49c23a(0x176)]&&settings[_0x49c23a(0x176)]==_0x49c23a(0x15c))&&(_0x5e703e={..._0x5e703e,'restored':{'password':settings[_0x49c23a(0x130)]==_0x49c23a(0x15c),'telegram':settings['telegramToken']=='***'}}),_0x5e703e;}async function updateBB(_0x723183){const _0x7c6de9=_0x405f3c;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x185576=>{const _0x3ba956=_0x5949;restartBot(_0x185576[_0x3ba956(0x105)]);});if(_0x723183==_0x7c6de9(0x246))process['send']({'update':!![],'environment':environment},_0x210e65=>{});else _0x723183==_0x7c6de9(0x18f)&&process['send']({'reinstall':!![],'environment':environment},_0xa93f0f=>{});}function startBot(_0x5aa237,_0x3febfc,_0x3d6c5c){const _0x2ffd4e=_0x405f3c;if(debugging)_0x5aa237[_0x2ffd4e(0xfb)]('-d');let _0x3a4dc4=![];const _0x3b5072=_0x5aa237[0x0];_0x3febfc={..._0x3febfc,'stdio':['inherit','inherit',_0x2ffd4e(0x22c),_0x2ffd4e(0x151)]},pid[_0x3b5072]=childProcess[_0x2ffd4e(0x14c)](botfile,_0x5aa237,_0x3febfc),pid[_0x3b5072]['on']('message',_0x412dbf=>{const _0x402afb=_0x2ffd4e;switch(Object[_0x402afb(0x137)](_0x412dbf)[0x0]){case _0x402afb(0xc2):updateBotName(_0x3b5072,_0x412dbf[_0x402afb(0xc2)]);break;case _0x402afb(0x1ea):updateBotManager();break;case _0x402afb(0xe6):updateStatus(_0x3b5072,_0x412dbf[_0x402afb(0xe6)]);break;case'live':updateLive(_0x3b5072,_0x412dbf['live']);break;case'started':updateLive(_0x3b5072,_0x412dbf['started']),io['to'](_0x3b5072)['emit'](_0x402afb(0xe6),{'access':{'allow':![],'reason':_0x402afb(0x1ee),'token':null}});break;case'stop':_0x412dbf[_0x402afb(0xc7)]=='restart'&&restartBot(_0x3b5072);_0x412dbf[_0x402afb(0xc7)]==_0x402afb(0x99)&&toggleBot(_0x3b5072,'disabled','stopped');break;case _0x402afb(0x17f):sendTelegram(_0x3b5072,_0x412dbf['telegram']);break;case'telegrammsg':sendTelegramMsg(_0x412dbf[_0x402afb(0x1b6)]);break;case _0x402afb(0x218):io['to'](_0x3b5072)[_0x402afb(0x118)](_0x412dbf['function'],_0x412dbf['args']);break;}}),pid[_0x3b5072]['on']('error',function(_0x26276a){if(_0x3a4dc4)return;_0x3a4dc4=!![],_0x3d6c5c(_0x26276a);}),pid[_0x3b5072]['on'](_0x2ffd4e(0xe3),async function(_0x4bab3b){const _0xd8c91f=_0x2ffd4e;if(installingUpdate)return;if(_0x3a4dc4)return;_0x3a4dc4=!![],_0x3d6c5c(null);const _0x1a3e12=dbConfig[_0xd8c91f(0xde)](_0xd8c91f(0xcb))[_0xd8c91f(0x16e)]({'botID':_0x3b5072})[_0xd8c91f(0x243)]();_0x1a3e12&&(_0x1a3e12[_0xd8c91f(0xe6)]==_0xd8c91f(0x1c3)||_0x1a3e12[_0xd8c91f(0xe6)]==_0xd8c91f(0x108))&&(await sleep(0x3e8),updateLive(_0x3b5072,_0xd8c91f(0x7b)),logger[_0xd8c91f(0xb0)](_0xd8c91f(0x17c)+_0x3b5072),startBot([_0x3b5072,userID],{'cwd':bbpath},function(_0x1c389c){if(_0x1c389c)logger['full'](_0x1c389c);}));});}function stopBot(_0x58ce93){const _0x100ef8=_0x405f3c;getClientsWithBotID(_0x58ce93)[_0x100ef8(0x1c5)](_0x8ccf20=>{const _0x49abce=_0x100ef8;getSocket(_0x8ccf20['id'])[_0x49abce(0x11f)](!![]),removeClient(_0x8ccf20['id']);}),pid[_0x58ce93]&&(pid[_0x58ce93]['kill'](),pid[_0x58ce93]=null);}function restartBot(_0xc45955){if(pid[_0xc45955])pid[_0xc45955]['kill']();}function addBot(){const _0x2544b6=_0x405f3c;let _0x9f2f96;for(let _0x5664bc=0x1;_0x5664bc<0x3e9;_0x5664bc++){_0x9f2f96=_0x5664bc[_0x2544b6(0x75)]()[_0x2544b6(0x6c)](0x3,'0');let _0x454f4e=config[_0x2544b6(0x16e)](_0x3163c9=>_0x3163c9[_0x2544b6(0x105)]==_0x9f2f96);if(!_0x454f4e)break;}if(_0x9f2f96===_0x2544b6(0x114)){logger[_0x2544b6(0xb0)](_0x2544b6(0x16d));return;}logger[_0x2544b6(0xb0)](_0x2544b6(0x8f)+_0x9f2f96),dbConfig['get'](_0x2544b6(0xcb))[_0x2544b6(0xfb)]({'botID':_0x9f2f96,'botname':_0x2544b6(0x233)+_0x9f2f96,'status':_0x2544b6(0x108),'live':''})[_0x2544b6(0x1b5)](),startBot([_0x9f2f96,userID],{'cwd':bbpath},function(_0x3c6ff3){const _0x122867=_0x2544b6;if(_0x3c6ff3)logger[_0x122867(0xb0)](_0x3c6ff3);}),config=getConfiguration(),io['to']('botmanager')['emit'](_0x2544b6(0xcb),config),broadcastToBots(_0x2544b6(0xcb),JSON[_0x2544b6(0x139)](config));}function deleteBot(_0x18481e){const _0x3499c3=_0x405f3c;getClientsWithBotID(_0x18481e)[_0x3499c3(0x1c5)](_0x468085=>{const _0xe2ba34=_0x3499c3;getSocket(_0x468085['id'])[_0xe2ba34(0x11f)](!![]),removeClient(_0x468085['id']);}),dbConfig['get'](_0x3499c3(0xcb))['remove']({'botID':_0x18481e})['write'](),logger['full'](_0x3499c3(0xfa)+_0x18481e),stopBot(_0x18481e);try{if(fs[_0x3499c3(0x10e)](path[_0x3499c3(0x187)](configpath,'bot-'+_0x18481e+_0x3499c3(0x12f))))fs[_0x3499c3(0x113)](path[_0x3499c3(0x187)](configpath,_0x3499c3(0x1ba)+_0x18481e+_0x3499c3(0x12f)));if(fs[_0x3499c3(0x10e)](path[_0x3499c3(0x187)](configpath,_0x3499c3(0x1ba)+_0x18481e+_0x3499c3(0x1d3))))fs[_0x3499c3(0x113)](path['join'](configpath,_0x3499c3(0x1ba)+_0x18481e+_0x3499c3(0x1d3)));if(fs[_0x3499c3(0x10e)](path[_0x3499c3(0x187)](configpath,_0x3499c3(0x1ba)+_0x18481e+_0x3499c3(0x1a8))))fs[_0x3499c3(0x113)](path[_0x3499c3(0x187)](configpath,'bot-'+_0x18481e+_0x3499c3(0x1a8)));if(fs[_0x3499c3(0x10e)](path[_0x3499c3(0x187)](configpath,'bot-'+_0x18481e+'-results.json')))fs['unlinkSync'](path[_0x3499c3(0x187)](configpath,_0x3499c3(0x1ba)+_0x18481e+'-results.json'));}catch(_0x566b41){if(_0x566b41)logger['full'](_0x3499c3(0x206),_0x566b41);}config=getConfiguration(),io['to'](_0x3499c3(0x14f))[_0x3499c3(0x118)](_0x3499c3(0xcb),config),broadcastToBots(_0x3499c3(0xcb),JSON[_0x3499c3(0x139)](config));}function toggleBot(_0x336f77,_0x7d92c7,_0x14e5bd){const _0x143c0e=_0x405f3c;dbConfig[_0x143c0e(0xde)](_0x143c0e(0xcb))[_0x143c0e(0x16e)]({'botID':_0x336f77})[_0x143c0e(0x1fc)]({'status':_0x7d92c7})['assign']({'live':_0x14e5bd})[_0x143c0e(0x1b5)]();if(_0x7d92c7==_0x143c0e(0x1c3)||_0x7d92c7==_0x143c0e(0x108))logger['full'](_0x143c0e(0x1e7)+_0x336f77),startBot([_0x336f77,userID],{'cwd':bbpath},function(_0x212ee9){const _0x1fea15=_0x143c0e;if(_0x212ee9)logger[_0x1fea15(0xb0)](_0x212ee9);});else(_0x7d92c7==_0x143c0e(0x1d6)||_0x7d92c7==_0x143c0e(0xb5))&&(logger[_0x143c0e(0xb0)](_0x143c0e(0x153)+_0x336f77),stopBot(_0x336f77));config=getConfiguration(),io['to'](_0x143c0e(0x14f))[_0x143c0e(0x118)]('bots',config),broadcastToBots('bots',JSON[_0x143c0e(0x139)](config));}function toggleStatus(_0x47d4fb){const _0x1d4ef6=_0x405f3c;let _0x339c68=dbConfig['get'](_0x1d4ef6(0xcb))[_0x1d4ef6(0x16e)]({'botID':_0x47d4fb})[_0x1d4ef6(0x243)](),_0x248246;if(_0x339c68[_0x1d4ef6(0xe6)]===_0x1d4ef6(0x1c3))_0x248246=_0x1d4ef6(0x1d6);else{if(_0x339c68['status']===_0x1d4ef6(0x108))_0x248246=_0x1d4ef6(0xb5);else{if(_0x339c68[_0x1d4ef6(0xe6)]==='new-disabled')_0x248246=_0x1d4ef6(0x108);else{if(_0x339c68[_0x1d4ef6(0xe6)]===_0x1d4ef6(0x1d6))_0x248246='enabled';}}}return _0x248246;}function updateStatus(_0x17fc7f,_0x403197){const _0x1134de=_0x405f3c;dbConfig[_0x1134de(0xde)](_0x1134de(0xcb))[_0x1134de(0x16e)]({'botID':_0x17fc7f})['assign']({'status':_0x403197})[_0x1134de(0x1b5)](),config=getConfiguration(),io['to'](_0x1134de(0x14f))[_0x1134de(0x118)](_0x1134de(0xcb),config),broadcastToBots(_0x1134de(0xcb),JSON[_0x1134de(0x139)](config));}function updateLive(_0x5daf62,_0x521a30){const _0x4857a2=_0x405f3c;dbConfig[_0x4857a2(0xde)](_0x4857a2(0xcb))[_0x4857a2(0x16e)]({'botID':_0x5daf62})[_0x4857a2(0x1fc)]({'live':_0x521a30})[_0x4857a2(0x1b5)](),config=getConfiguration(),io['to'](_0x4857a2(0x14f))[_0x4857a2(0x118)]('bots',config),broadcastToBots('bots',JSON[_0x4857a2(0x139)](config));}function _0x5949(_0x2130a1,_0x1b00f4){const _0x2a7d23=_0x2a4a();return _0x5949=function(_0x585902,_0x115199){_0x585902=_0x585902-0x6b;let _0x2a4a70=_0x2a7d23[_0x585902];return _0x2a4a70;},_0x5949(_0x2130a1,_0x1b00f4);}function updateBotName(_0x493a19,_0x185547){const _0x3412fc=_0x405f3c;dbConfig[_0x3412fc(0xde)](_0x3412fc(0xcb))['find']({'botID':_0x493a19})[_0x3412fc(0x1fc)]({'botname':_0x185547})[_0x3412fc(0x1b5)](),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots(_0x3412fc(0xcb),JSON[_0x3412fc(0x139)](config));}function updateBotManager(){const _0x1964b0=_0x405f3c;config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots(_0x1964b0(0xcb),JSON['stringify'](config));}function toggleBotMode(_0x103e6f){const _0x1819b7=_0x405f3c;if(pid[_0x103e6f])pid[_0x103e6f][_0x1819b7(0x229)]({'function':_0x1819b7(0x18c),'args':null});else{const _0x3a1193=configpath+_0x1819b7(0x1ba)+_0x103e6f+_0x1819b7(0x12f),_0xeebec7=fs['readFileSync'](_0x3a1193),_0x4113db=JSON[_0x1819b7(0x120)](_0xeebec7),_0x325131=_0x4113db['bot'][0x0]['headless'];_0x4113db['bot'][0x0][_0x1819b7(0x223)]=!_0x325131;const _0x551b68=JSON[_0x1819b7(0x139)](_0x4113db,null,0x2);fs[_0x1819b7(0x19f)](_0x3a1193,_0x551b68),config=getConfiguration(),io['to'](_0x1819b7(0x14f))[_0x1819b7(0x118)](_0x1819b7(0xcb),config),broadcastToBots(_0x1819b7(0xcb),JSON[_0x1819b7(0x139)](config));}}function telegramError(_0x559ecd){const _0x1b2cdd=_0x405f3c;logger[_0x1b2cdd(0x156)](getTimeStamp()+_0x1b2cdd(0x1d5));}function validateTelegram(_0x5af113){const _0x13b18a=_0x405f3c;if(_0x5af113['from'][_0x13b18a(0xb8)]!=settings[_0x13b18a(0x161)]&&'@'+_0x5af113['from']['username']!=settings[_0x13b18a(0x161)])return tgBot[_0x13b18a(0xcd)](_0x5af113[_0x13b18a(0x7e)]['id'],_0x13b18a(0x1dc),{'parse_mode':_0x13b18a(0x127)})['catch'](_0x5b7b22=>{telegramError(_0x5b7b22);}),![];return!![];}async function initTelegram(){const _0x4e18e0=_0x405f3c;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x4e18e0(0x176)],{'polling':!![]});let _0x1360f6='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x1360f6+='\x0a',_0x1360f6+=_0x4e18e0(0x16a),_0x1360f6+=_0x4e18e0(0x23f),_0x1360f6+=_0x4e18e0(0x178),_0x1360f6+=_0x4e18e0(0x1ab),_0x1360f6+=_0x4e18e0(0xac),_0x1360f6+=_0x4e18e0(0x1e5),_0x1360f6+=_0x4e18e0(0x162),_0x1360f6+='/names\x20-\x20show\x20bot\x20names\x0a',_0x1360f6+=_0x4e18e0(0x1a3),_0x1360f6+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x1360f6+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x1360f6+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x1360f6+=_0x4e18e0(0x1cb),_0x1360f6+=_0x4e18e0(0x1d8);let _0x2327e7='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x2327e7+='\x0a',_0x2327e7+=_0x1360f6,tgBot[_0x4e18e0(0x115)](/\/start/,_0x3713cf=>{const _0x43b909=_0x4e18e0;if(!validateTelegram(_0x3713cf))return;if(settings[_0x43b909(0xd4)]!=_0x3713cf[_0x43b909(0x7e)]['id'])updateSetting(_0x43b909(0xd4),_0x3713cf[_0x43b909(0x7e)]['id']);updateSetting(_0x43b909(0x1e6),!![]),tgBot[_0x43b909(0xcd)](_0x3713cf[_0x43b909(0x7e)]['id'],_0x2327e7)[_0x43b909(0x1c4)](_0x237999=>{telegramError(_0x237999);});}),tgBot['onText'](/\/enable/,_0x22d229=>{const _0x3fdd4a=_0x4e18e0;if(!validateTelegram(_0x22d229))return;if(settings[_0x3fdd4a(0xd4)]!=_0x22d229[_0x3fdd4a(0x7e)]['id'])updateSetting(_0x3fdd4a(0xd4),_0x22d229['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x3fdd4a(0xcd)](_0x22d229[_0x3fdd4a(0x7e)]['id'],_0x3fdd4a(0x238))[_0x3fdd4a(0x1c4)](_0x110feb=>{telegramError(_0x110feb);});}),tgBot[_0x4e18e0(0x115)](/\/config/,async _0x1c247b=>{const _0x43c628=_0x4e18e0;if(!validateTelegram(_0x1c247b))return;tgBot[_0x43c628(0x163)](_0x43c628(0x164)),tgBot['sendMessage'](_0x1c247b[_0x43c628(0x7e)]['id'],_0x43c628(0x1e0),{'reply_markup':{'inline_keyboard':[[{'text':_0x43c628(0xdd),'callback_data':_0x43c628(0x8a)},{'text':_0x43c628(0x8d),'callback_data':_0x43c628(0xd3)},{'text':_0x43c628(0x194),'callback_data':_0x43c628(0x1b2)}]]}})[_0x43c628(0x1c4)](_0x3a95ad=>{telegramError(_0x3a95ad);}),tgBot['on'](_0x43c628(0x164),async _0x24cf78=>{const _0x2b5bbd=_0x43c628,_0x53e50d=_0x24cf78[_0x2b5bbd(0x12d)],_0x34c6dc=_0x24cf78[_0x2b5bbd(0xba)];tgBot[_0x2b5bbd(0x8e)](_0x24cf78['id'])['then'](async()=>{const _0x52a993=_0x2b5bbd;_0x53e50d==_0x52a993(0x8a)&&(updateSetting('telegramEvents','orders'),updateSetting('telegramEnabled',!![]),await tgBot[_0x52a993(0xcd)](_0x34c6dc['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')['catch'](_0x494f7a=>{telegramError(_0x494f7a);}));_0x53e50d=='alerts'&&(updateSetting(_0x52a993(0x1a0),_0x52a993(0xd3)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x34c6dc[_0x52a993(0x7e)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x52a993(0x1c4)](_0x3f867e=>{telegramError(_0x3f867e);}));_0x53e50d==_0x52a993(0x1b2)&&(updateSetting(_0x52a993(0x1a0),_0x52a993(0x1b2)),updateSetting(_0x52a993(0x1e6),!![]),await tgBot[_0x52a993(0xcd)](_0x34c6dc[_0x52a993(0x7e)]['id'],_0x52a993(0xf4))[_0x52a993(0x1c4)](_0x1387dc=>{telegramError(_0x1387dc);}));if(!settings[_0x52a993(0xd4)])tgBot['sendMessage'](_0x34c6dc['chat']['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')['catch'](_0x69477d=>{telegramError(_0x69477d);});}),tgBot[_0x2b5bbd(0x163)](_0x2b5bbd(0x164));});}),tgBot[_0x4e18e0(0x115)](/\/status/,_0x2cba02=>{const _0x15a947=_0x4e18e0;if(!validateTelegram(_0x2cba02))return;const _0x14db21=getBotsWithMode();let _0x220524=_0x15a947(0x1c6);config['forEach'](_0x522ec9=>{const _0x1ca27e=_0x15a947,_0xa85949=_0x14db21[_0x1ca27e(0x16e)](_0x189568=>_0x189568[_0x1ca27e(0x105)]==_0x522ec9[_0x1ca27e(0x105)])['mode'];_0x220524+=_0x1ca27e(0x233)+_0x522ec9['botID']+':\x20'+_0x522ec9[_0x1ca27e(0xe6)]+'\x20|\x20'+_0xa85949+_0x1ca27e(0xc5)+_0x522ec9[_0x1ca27e(0xa3)]+'\x0a';}),_0x220524+='\x0a',_0x220524+=_0x15a947(0xa7),_0x220524+=!settings['telegramEnabled']?_0x15a947(0x1ac):_0x15a947(0x90),_0x220524+=settings[_0x15a947(0x1e6)]?settings[_0x15a947(0x1a0)]==_0x15a947(0x1b2)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x15a947(0x81)+settings[_0x15a947(0x1a0)]+_0x15a947(0x191):'',tgBot[_0x15a947(0xcd)](_0x2cba02[_0x15a947(0x7e)]['id'],_0x220524,{'parse_mode':_0x15a947(0x127)})[_0x15a947(0x1c4)](_0x5351d5=>{telegramError(_0x5351d5);});}),tgBot[_0x4e18e0(0x115)](/\/restart/,_0x527657=>{const _0x4be56a=_0x4e18e0;if(!validateTelegram(_0x527657))return;tgBot[_0x4be56a(0x163)](_0x4be56a(0x164));const _0x51e072=getEnabledBots();if(_0x51e072[_0x4be56a(0x1da)]==0x0)tgBot['sendMessage'](_0x527657[_0x4be56a(0x7e)]['id'],_0x4be56a(0x122))[_0x4be56a(0x1c4)](_0x496410=>{telegramError(_0x496410);});else{if(_0x51e072[_0x4be56a(0x1da)]>0x1)_0x51e072[_0x4be56a(0xfb)]({'botID':'all'});let _0x296680=[],_0x17906b=[];const _0x376b00=_0x51e072['length']%0x4==0x0||_0x51e072['length']%0x4==0x3||_0x51e072[_0x4be56a(0x1da)]%0x3==0x1?0x4:0x3;let _0x17d659=0x0;_0x51e072['forEach']((_0x200e37,_0x47c0e6)=>{const _0x90c806=_0x4be56a;if(_0x47c0e6%_0x376b00==0x0)_0x17906b=[];_0x17906b[_0x90c806(0xfb)]({'text':_0x200e37[_0x90c806(0x105)]=='all'?_0x90c806(0x148):_0x90c806(0x233)+_0x200e37['botID'],'callback_data':_0x200e37[_0x90c806(0x105)]}),_0x47c0e6%_0x376b00==0x0&&(_0x296680[_0x17d659]=_0x17906b,_0x17d659++);}),tgBot[_0x4be56a(0xcd)](_0x527657[_0x4be56a(0x7e)]['id'],_0x4be56a(0x88),{'reply_markup':{'inline_keyboard':_0x296680}})[_0x4be56a(0x1c4)](_0x541deb=>{telegramError(_0x541deb);}),tgBot['on'](_0x4be56a(0x164),async _0x5a2feb=>{const _0x480411=_0x4be56a,_0x426ec1=_0x5a2feb['data'],_0x4625c4=_0x5a2feb[_0x480411(0xba)];tgBot['answerCallbackQuery'](_0x5a2feb['id'])[_0x480411(0x217)](async()=>{const _0x1bf9f6=_0x480411;_0x426ec1==_0x1bf9f6(0x1b2)?config[_0x1bf9f6(0x1c5)](_0x561ca4=>{restartBot(_0x561ca4['botID']);}):restartBot(_0x426ec1);}),tgBot[_0x480411(0x163)]('callback_query');});}}),tgBot[_0x4e18e0(0x115)](/\/on/,_0x26c7a6=>{const _0x4a927c=_0x4e18e0;if(!validateTelegram(_0x26c7a6))return;tgBot[_0x4a927c(0x163)](_0x4a927c(0x164));const _0x2422d8=getDisabledBots();if(_0x2422d8[_0x4a927c(0x1da)]==0x0)tgBot[_0x4a927c(0xcd)](_0x26c7a6[_0x4a927c(0x7e)]['id'],_0x4a927c(0x173))[_0x4a927c(0x1c4)](_0x3c107d=>{telegramError(_0x3c107d);});else{if(_0x2422d8[_0x4a927c(0x1da)]>0x1)_0x2422d8[_0x4a927c(0xfb)]({'botID':'all'});let _0x5b7882=[],_0x5e03ae=[];const _0x4628b5=_0x2422d8['length']%0x4==0x0||_0x2422d8[_0x4a927c(0x1da)]%0x4==0x3||_0x2422d8['length']%0x3==0x1?0x4:0x3;let _0x5a1b82=0x0;_0x2422d8[_0x4a927c(0x1c5)]((_0x5a3d70,_0x1a993b)=>{const _0x2de42c=_0x4a927c;if(_0x1a993b%_0x4628b5==0x0)_0x5e03ae=[];_0x5e03ae['push']({'text':_0x5a3d70['botID']=='all'?_0x2de42c(0x148):_0x2de42c(0x233)+_0x5a3d70[_0x2de42c(0x105)],'callback_data':_0x5a3d70[_0x2de42c(0x105)]}),_0x1a993b%_0x4628b5==0x0&&(_0x5b7882[_0x5a1b82]=_0x5e03ae,_0x5a1b82++);}),tgBot[_0x4a927c(0xcd)](_0x26c7a6[_0x4a927c(0x7e)]['id'],_0x4a927c(0x145),{'reply_markup':{'inline_keyboard':_0x5b7882}})[_0x4a927c(0x1c4)](_0x32a7af=>{telegramError(_0x32a7af);}),tgBot['on']('callback_query',async _0xfeeb57=>{const _0xb64920=_0x4a927c,_0x4446a4=_0xfeeb57[_0xb64920(0x12d)],_0x174f1b=_0xfeeb57[_0xb64920(0xba)];tgBot[_0xb64920(0x8e)](_0xfeeb57['id'])[_0xb64920(0x217)](async()=>{const _0x5ad8ed=_0xb64920;_0x4446a4==_0x5ad8ed(0x1b2)?(tgBot[_0x5ad8ed(0xcd)](_0x174f1b['chat']['id'],_0x5ad8ed(0x83))[_0x5ad8ed(0x1c4)](_0xc9dbd=>{telegramError(_0xc9dbd);}),_0x2422d8[_0x5ad8ed(0x1c5)](_0x826cef=>{const _0x2a8448=_0x5ad8ed;if(_0x826cef['botID']!=_0x2a8448(0x1b2))toggleBot(_0x826cef[_0x2a8448(0x105)],toggleStatus(_0x826cef['botID']),_0x2a8448(0x7b));})):(tgBot[_0x5ad8ed(0xcd)](_0x174f1b[_0x5ad8ed(0x7e)]['id'],_0x5ad8ed(0x101)+_0x4446a4)[_0x5ad8ed(0x1c4)](_0x1cfd37=>{telegramError(_0x1cfd37);}),toggleBot(_0x4446a4,toggleStatus(_0x4446a4),_0x5ad8ed(0x7b)));}),tgBot[_0xb64920(0x163)](_0xb64920(0x164));});}}),tgBot[_0x4e18e0(0x115)](/\/off/,_0x375f18=>{const _0x40c06b=_0x4e18e0;if(!validateTelegram(_0x375f18))return;tgBot[_0x40c06b(0x163)](_0x40c06b(0x164));const _0x136c82=getEnabledBots();if(_0x136c82[_0x40c06b(0x1da)]==0x0)tgBot[_0x40c06b(0xcd)](_0x375f18[_0x40c06b(0x7e)]['id'],_0x40c06b(0x122))[_0x40c06b(0x1c4)](_0x3a5ba8=>{telegramError(_0x3a5ba8);});else{if(_0x136c82[_0x40c06b(0x1da)]>0x1)_0x136c82[_0x40c06b(0xfb)]({'botID':_0x40c06b(0x1b2)});let _0x4cb83f=[],_0x42f8f1=[];const _0x4a2064=_0x136c82['length']%0x4==0x0||_0x136c82[_0x40c06b(0x1da)]%0x4==0x3||_0x136c82[_0x40c06b(0x1da)]%0x3==0x1?0x4:0x3;let _0x144749=0x0;_0x136c82['forEach']((_0x250c30,_0x330147)=>{const _0x1cce20=_0x40c06b;if(_0x330147%_0x4a2064==0x0)_0x42f8f1=[];_0x42f8f1['push']({'text':_0x250c30[_0x1cce20(0x105)]==_0x1cce20(0x1b2)?_0x1cce20(0x148):'Bot\x20'+_0x250c30[_0x1cce20(0x105)],'callback_data':_0x250c30[_0x1cce20(0x105)]}),_0x330147%_0x4a2064==0x0&&(_0x4cb83f[_0x144749]=_0x42f8f1,_0x144749++);}),tgBot[_0x40c06b(0xcd)](_0x375f18[_0x40c06b(0x7e)]['id'],_0x40c06b(0x76),{'reply_markup':{'inline_keyboard':_0x4cb83f}})[_0x40c06b(0x1c4)](_0xe1ac5c=>{telegramError(_0xe1ac5c);}),tgBot['on'](_0x40c06b(0x164),async _0x241d63=>{const _0x57105d=_0x40c06b,_0x565c58=_0x241d63['data'],_0x33eca8=_0x241d63['message'];tgBot[_0x57105d(0x8e)](_0x241d63['id'])[_0x57105d(0x217)](async()=>{const _0x20146d=_0x57105d;_0x565c58=='all'?(tgBot[_0x20146d(0xcd)](_0x33eca8[_0x20146d(0x7e)]['id'],_0x20146d(0x1a1))[_0x20146d(0x1c4)](_0xc8c4a4=>{telegramError(_0xc8c4a4);}),_0x136c82[_0x20146d(0x1c5)](_0x3dc340=>{const _0xf53535=_0x20146d;if(_0x3dc340[_0xf53535(0x105)]!=_0xf53535(0x1b2))toggleBot(_0x3dc340['botID'],toggleStatus(_0x3dc340[_0xf53535(0x105)]),_0xf53535(0x7b));})):(tgBot[_0x20146d(0xcd)](_0x33eca8['chat']['id'],_0x20146d(0x171)+_0x565c58)[_0x20146d(0x1c4)](_0x19acdd=>{telegramError(_0x19acdd);}),toggleBot(_0x565c58,toggleStatus(_0x565c58),_0x20146d(0x7b)));}),tgBot[_0x57105d(0x163)](_0x57105d(0x164));});}}),tgBot[_0x4e18e0(0x115)](/\/metrics/,_0x41ec80=>{const _0x256dbf=_0x4e18e0;if(!validateTelegram(_0x41ec80))return;tgBot[_0x256dbf(0x163)]('callback_query');const _0x9fa443=getEnabledBots();if(_0x9fa443[_0x256dbf(0x1da)]==0x0)tgBot[_0x256dbf(0xcd)](_0x41ec80[_0x256dbf(0x7e)]['id'],_0x256dbf(0x122))['catch'](_0x15ce0b=>{telegramError(_0x15ce0b);});else{if(_0x9fa443['length']>0x1){let _0x410e56=[],_0xc78080=[];const _0x1580bd=_0x9fa443['length']%0x4==0x0||_0x9fa443[_0x256dbf(0x1da)]%0x4==0x3||_0x9fa443[_0x256dbf(0x1da)]%0x3==0x1?0x4:0x3;let _0x204f4e=0x0;_0x9fa443[_0x256dbf(0x1c5)]((_0x530d4f,_0x49ad3a)=>{const _0x19a4d2=_0x256dbf;if(_0x49ad3a%_0x1580bd==0x0)_0xc78080=[];_0xc78080[_0x19a4d2(0xfb)]({'text':_0x19a4d2(0x233)+_0x530d4f[_0x19a4d2(0x105)],'callback_data':_0x530d4f[_0x19a4d2(0x105)]}),_0x49ad3a%_0x1580bd==0x0&&(_0x410e56[_0x204f4e]=_0xc78080,_0x204f4e++);}),tgBot['sendMessage'](_0x41ec80['chat']['id'],_0x256dbf(0x100),{'reply_markup':{'inline_keyboard':_0x410e56}})[_0x256dbf(0x1c4)](_0x2b3246=>{telegramError(_0x2b3246);}),tgBot['on'](_0x256dbf(0x164),async _0x4ca98c=>{const _0x22d9f5=_0x256dbf,_0x57d41c=_0x4ca98c[_0x22d9f5(0x12d)],_0x14418b=_0x4ca98c[_0x22d9f5(0xba)];tgBot[_0x22d9f5(0x8e)](_0x4ca98c['id'])['then'](async()=>{const _0x57827=_0x22d9f5;if(pid[_0x57d41c])pid[_0x57d41c][_0x57827(0x229)]({'function':'sendMetricsTelegram','args':null});}),tgBot['removeListener'](_0x22d9f5(0x164));});}else{const _0x2a4219=_0x9fa443[0x0]['botID'];if(pid[_0x2a4219])pid[_0x2a4219]['send']({'function':_0x256dbf(0xe4),'args':null});}}}),tgBot[_0x4e18e0(0x115)](/\/portfolio/,_0x71d32b=>{const _0x32194b=_0x4e18e0;if(!validateTelegram(_0x71d32b))return;tgBot[_0x32194b(0x163)](_0x32194b(0x164));const _0x366409=getEnabledBots();if(_0x366409[_0x32194b(0x1da)]==0x0)tgBot[_0x32194b(0xcd)](_0x71d32b[_0x32194b(0x7e)]['id'],_0x32194b(0x122))[_0x32194b(0x1c4)](_0x4f9713=>{telegramError(_0x4f9713);});else{if(_0x366409[_0x32194b(0x1da)]>0x1){let _0x1b8411=[],_0x3ec7c9=[];const _0x3896cb=_0x366409[_0x32194b(0x1da)]%0x4==0x0||_0x366409[_0x32194b(0x1da)]%0x4==0x3||_0x366409[_0x32194b(0x1da)]%0x3==0x1?0x4:0x3;let _0x532b9b=0x0;_0x366409['forEach']((_0x504459,_0x1941bc)=>{const _0xf50eec=_0x32194b;if(_0x1941bc%_0x3896cb==0x0)_0x3ec7c9=[];_0x3ec7c9[_0xf50eec(0xfb)]({'text':_0xf50eec(0x233)+_0x504459['botID'],'callback_data':_0x504459[_0xf50eec(0x105)]}),_0x1941bc%_0x3896cb==0x0&&(_0x1b8411[_0x532b9b]=_0x3ec7c9,_0x532b9b++);}),tgBot[_0x32194b(0xcd)](_0x71d32b[_0x32194b(0x7e)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x1b8411}})[_0x32194b(0x1c4)](_0x1cb962=>{telegramError(_0x1cb962);}),tgBot['on'](_0x32194b(0x164),async _0x4bb104=>{const _0x326ad7=_0x32194b,_0x1a06b7=_0x4bb104[_0x326ad7(0x12d)],_0x17d99e=_0x4bb104[_0x326ad7(0xba)];tgBot['answerCallbackQuery'](_0x4bb104['id'])[_0x326ad7(0x217)](async()=>{const _0x2ff763=_0x326ad7;if(pid[_0x1a06b7])pid[_0x1a06b7][_0x2ff763(0x229)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x326ad7(0x163)](_0x326ad7(0x164));});}else{const _0x42dcd6=_0x366409[0x0][_0x32194b(0x105)];if(pid[_0x42dcd6])pid[_0x42dcd6][_0x32194b(0x229)]({'function':_0x32194b(0x121),'args':null});}}}),tgBot[_0x4e18e0(0x115)](/\/update/,async _0x388a03=>{const _0x242982=_0x4e18e0;if(!validateTelegram(_0x388a03))return;tgBot['removeListener'](_0x242982(0x164)),await getMessages();if(!updateAvailable)tgBot[_0x242982(0xcd)](_0x388a03[_0x242982(0x7e)]['id'],_0x242982(0x21b))[_0x242982(0x1c4)](_0x3ba7ff=>{telegramError(_0x3ba7ff);});else!validInstallation?tgBot[_0x242982(0xcd)](_0x388a03[_0x242982(0x7e)]['id'],_0x242982(0x208))[_0x242982(0x1c4)](_0x1fa76c=>{telegramError(_0x1fa76c);}):(tgBot[_0x242982(0xcd)](_0x388a03[_0x242982(0x7e)]['id'],_0x242982(0xa5),{'reply_markup':{'inline_keyboard':[[{'text':_0x242982(0x78),'callback_data':_0x242982(0x104)},{'text':'No','callback_data':'no'}]]}})[_0x242982(0x1c4)](_0x1986f4=>{telegramError(_0x1986f4);}),tgBot['on']('callback_query',async _0x5d3799=>{const _0x48ef8c=_0x242982,_0x288deb=_0x5d3799[_0x48ef8c(0x12d)],_0x193fa5=_0x5d3799[_0x48ef8c(0xba)];tgBot[_0x48ef8c(0x8e)](_0x5d3799['id'])[_0x48ef8c(0x217)](async()=>{const _0x577d5a=_0x48ef8c;_0x288deb==_0x577d5a(0x104)&&(await tgBot[_0x577d5a(0xcd)](_0x193fa5[_0x577d5a(0x7e)]['id'],_0x577d5a(0x86))[_0x577d5a(0x1c4)](_0x37141e=>{telegramError(_0x37141e);}),updateBB('update')),_0x288deb=='no'&&await tgBot[_0x577d5a(0xcd)](_0x193fa5['chat']['id'],_0x577d5a(0x132))[_0x577d5a(0x1c4)](_0x576cd2=>{telegramError(_0x576cd2);});}),tgBot[_0x48ef8c(0x163)](_0x48ef8c(0x164));}));}),tgBot[_0x4e18e0(0x115)](/\/reinstall/,async _0x204dfb=>{const _0x35e967=_0x4e18e0;if(!validateTelegram(_0x204dfb))return;tgBot[_0x35e967(0x163)](_0x35e967(0x164)),!validInstallation?tgBot[_0x35e967(0xcd)](_0x204dfb['chat']['id'],_0x35e967(0xf9))[_0x35e967(0x1c4)](_0x531b94=>{telegramError(_0x531b94);}):(tgBot[_0x35e967(0xcd)](_0x204dfb[_0x35e967(0x7e)]['id'],_0x35e967(0x1a9),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})['catch'](_0x97d164=>{telegramError(_0x97d164);}),tgBot['on'](_0x35e967(0x164),async _0x4c288d=>{const _0x227bef=_0x35e967,_0x4b24be=_0x4c288d[_0x227bef(0x12d)],_0x29f155=_0x4c288d['message'];tgBot['answerCallbackQuery'](_0x4c288d['id'])['then'](async()=>{const _0x188dbe=_0x227bef;_0x4b24be==_0x188dbe(0x104)&&(await tgBot[_0x188dbe(0xcd)](_0x29f155[_0x188dbe(0x7e)]['id'],_0x188dbe(0xdb))[_0x188dbe(0x1c4)](_0x58115b=>{telegramError(_0x58115b);}),updateBB('reinstall')),_0x4b24be=='no'&&await tgBot[_0x188dbe(0xcd)](_0x29f155[_0x188dbe(0x7e)]['id'],_0x188dbe(0x19b))[_0x188dbe(0x1c4)](_0x574598=>{telegramError(_0x574598);});}),tgBot[_0x227bef(0x163)](_0x227bef(0x164));}));}),tgBot[_0x4e18e0(0x115)](/\/toggle/,_0x3cc874=>{const _0x59ebf8=_0x4e18e0;if(!validateTelegram(_0x3cc874))return;tgBot[_0x59ebf8(0x163)](_0x59ebf8(0x164));const _0x9975c9=getBotsWithMode();if(_0x9975c9[_0x59ebf8(0x1da)]==0x0)tgBot['sendMessage'](_0x3cc874['chat']['id'],_0x59ebf8(0x122))['catch'](_0x1099fb=>{telegramError(_0x1099fb);});else{let _0x504981=[],_0x4dff87=[];const _0x4638ab=0x2;let _0x5e41f8=0x0;_0x9975c9['forEach']((_0x124402,_0x247ba8)=>{const _0x4a13db=_0x59ebf8;if(_0x247ba8%_0x4638ab==0x0)_0x4dff87=[];_0x4dff87[_0x4a13db(0xfb)]({'text':_0x4a13db(0x233)+_0x124402[_0x4a13db(0x105)]+'\x20('+_0x124402[_0x4a13db(0x13a)]+')','callback_data':_0x124402['botID']}),_0x247ba8%_0x4638ab==0x0&&(_0x504981[_0x5e41f8]=_0x4dff87,_0x5e41f8++);}),tgBot[_0x59ebf8(0xcd)](_0x3cc874['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0x504981}})[_0x59ebf8(0x1c4)](_0xa15eb8=>{telegramError(_0xa15eb8);}),tgBot['on'](_0x59ebf8(0x164),async _0x501259=>{const _0x43b458=_0x59ebf8,_0x5a4418=_0x501259[_0x43b458(0x12d)],_0xfa8621=_0x501259[_0x43b458(0xba)];tgBot[_0x43b458(0x8e)](_0x501259['id'])[_0x43b458(0x217)](async()=>{const _0x57170=_0x43b458,_0x3bcca6=_0x9975c9[_0x57170(0x16e)](_0x2306e3=>_0x2306e3['botID']==_0x5a4418),_0x25b31c=_0x3bcca6['mode']==_0x57170(0xe0)?_0x57170(0x195):_0x57170(0xe0);tgBot['sendMessage'](_0xfa8621[_0x57170(0x7e)]['id'],_0x57170(0x1f4)+_0x5a4418+_0x57170(0x1bd)+_0x25b31c+'\x20mode')['catch'](_0x57a765=>{telegramError(_0x57a765);}),toggleBotMode(_0x5a4418);}),tgBot['removeListener']('callback_query');});}}),tgBot[_0x4e18e0(0x115)](/\/names/,_0x151af8=>{const _0x1bee13=_0x4e18e0;if(!validateTelegram(_0x151af8))return;let _0x565080='';config[_0x1bee13(0x1c5)](_0x3fe569=>{const _0x18aed9=_0x1bee13;_0x565080+='Bot\x20'+_0x3fe569[_0x18aed9(0x105)]+':\x20'+_0x3fe569['botname']+'\x0a';}),tgBot[_0x1bee13(0xcd)](_0x151af8[_0x1bee13(0x7e)]['id'],_0x565080,{'parse_mode':'HTML'})['catch'](_0x569f13=>{telegramError(_0x569f13);});}),tgBot[_0x4e18e0(0x115)](/\/disable/,_0x19459e=>{const _0x153af0=_0x4e18e0;if(!validateTelegram(_0x19459e))return;tgBot[_0x153af0(0xcd)](_0x19459e['chat']['id'],_0x153af0(0x22e))[_0x153af0(0x1c4)](_0x466121=>{telegramError(_0x466121);}),updateSetting(_0x153af0(0x1e6),![]);}),tgBot[_0x4e18e0(0x115)](/\/help/,_0x146fc8=>{const _0x5e2bd1=_0x4e18e0;if(!validateTelegram(_0x146fc8))return;tgBot[_0x5e2bd1(0xcd)](_0x146fc8['chat']['id'],_0x1360f6)[_0x5e2bd1(0x1c4)](_0x282355=>{telegramError(_0x282355);});}),tgBot['on']('polling_error',_0x3dcbec=>{const _0x4963de=_0x4e18e0;_0x3dcbec[_0x4963de(0x75)]()[_0x4963de(0x212)](_0x4963de(0x155))&&(logger[_0x4963de(0xb0)](_0x4963de(0x226)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x4963de(0x14f))[_0x4963de(0x118)](_0x4963de(0x174),_0x4963de(0x226)));}),process[_0x4e18e0(0x166)]('SIGINT',()=>{const _0x185430=_0x4e18e0;if(tgBot)tgBot[_0x185430(0x149)]();process[_0x185430(0xe3)](0x1);}),process[_0x4e18e0(0x166)](_0x4e18e0(0x239),()=>{const _0x274c6e=_0x4e18e0;if(tgBot)tgBot[_0x274c6e(0x149)]();process[_0x274c6e(0xe3)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x514557,_0x1a75d0){const _0x14fb7d=_0x405f3c;if(settings['telegramEnabled']){if(settings[_0x14fb7d(0x1a0)]=='all'||(_0x1a75d0['type']=='error'||_0x1a75d0[_0x14fb7d(0x14b)]==_0x14fb7d(0x20d)||_0x1a75d0['type']==_0x14fb7d(0x1db))&&settings[_0x14fb7d(0x1a0)]==_0x14fb7d(0xd3)||_0x1a75d0[_0x14fb7d(0x14b)]==_0x14fb7d(0x1ae)&&settings[_0x14fb7d(0x1a0)]=='orders'){if(tgBot&&settings[_0x14fb7d(0xd4)]){if(_0x1a75d0['showname'])tgBot[_0x14fb7d(0xcd)](settings['telegramChatId'],_0x1a75d0['botname']+_0x14fb7d(0x1e4)+_0x1a75d0[_0x14fb7d(0x87)])[_0x14fb7d(0x1c4)](_0x26a4ed=>{telegramError(_0x26a4ed);});else tgBot['sendMessage'](settings['telegramChatId'],_0x14fb7d(0x233)+_0x514557+_0x14fb7d(0x1e4)+_0x1a75d0['event'])['catch'](_0x9476b4=>{telegramError(_0x9476b4);});}}}}async function sendTelegramMsg(_0x524e39,_0x30efce=_0x405f3c(0x127)){const _0x53ccd5=_0x405f3c;return settings[_0x53ccd5(0x1e6)]&&tgBot&&settings[_0x53ccd5(0xd4)]?(await tgBot['sendMessage'](settings[_0x53ccd5(0xd4)],_0x524e39,{'parse_mode':_0x30efce})[_0x53ccd5(0x1c4)](_0x3b786f=>{telegramError(_0x3b786f);}),!![]):![];}function getDeviceWithIp(_0x89d1ff){const _0x308546=_0x405f3c;return devices[_0x308546(0x16e)](_0x43c1c1=>_0x43c1c1['ip']===_0x89d1ff);}function temporaryAccess2FA(_0x152e4a,_0x2afc30){const _0x31fc8b=_0x405f3c;let _0x62dabd=new Date(),_0x306905=![];if(lastIpApproval){if(_0x62dabd-lastIpApproval<0x1388)_0x306905=!![];}lastIpApproval=new Date();if(_0x306905)return;tgBot&&settings[_0x31fc8b(0xd4)]&&(tgBot[_0x31fc8b(0x163)](_0x31fc8b(0x164)),tgBot['sendMessage'](settings[_0x31fc8b(0xd4)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x2afc30)[_0x31fc8b(0x213)]+'</b>\x20?',{'parse_mode':_0x31fc8b(0x127),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x31fc8b(0xf3),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x31fc8b(0x94),'callback_data':'reject'}]]}})[_0x31fc8b(0x1c4)](_0x1f653f=>{telegramError(_0x1f653f);}),tgBot['on'](_0x31fc8b(0x164),async _0x2ef271=>{const _0x2b2576=_0x31fc8b,_0xef529e=_0x2ef271['data'],_0x3a65c8=_0x2ef271['message'];tgBot[_0x2b2576(0x8e)](_0x2ef271['id'])['then'](async()=>{const _0x5a4347=_0x2b2576;devices[_0x152e4a][_0x5a4347(0x77)]={'clientip':_0x2afc30,'timestamp':new Date()[_0x5a4347(0x125)](),'expiry':_0xef529e},_0xef529e!=_0x5a4347(0x94)?(await tgBot[_0x5a4347(0xcd)](_0x3a65c8['chat']['id'],_0x5a4347(0x80)+_0xef529e+_0x5a4347(0x240),{'parse_mode':_0x5a4347(0x127)})[_0x5a4347(0x1c4)](_0x1db6b5=>{telegramError(_0x1db6b5);}),io['to'](_0x152e4a)[_0x5a4347(0x118)](_0x5a4347(0xe6),{'access':{'allow':![],'reason':_0x5a4347(0x1ee),'token':null}})):(await tgBot[_0x5a4347(0xcd)](_0x3a65c8[_0x5a4347(0x7e)]['id'],_0x5a4347(0xf8))[_0x5a4347(0x1c4)](_0x5c5033=>{telegramError(_0x5c5033);}),io['to'](_0x152e4a)['emit'](_0x5a4347(0xe6),{'access':{'allow':![],'reason':_0x5a4347(0x167),'token':null}}));}),tgBot[_0x2b2576(0x163)]('callback_query');}));}function loginAccess2FA(_0x46ebea,_0x1b5aaf){const _0x1cef50=_0x405f3c;tgBot&&settings[_0x1cef50(0xd4)]&&(tgBot[_0x1cef50(0x163)]('callback_query'),tgBot[_0x1cef50(0xcd)](settings[_0x1cef50(0xd4)],_0x1cef50(0x181)+normalizeIP(_0x1b5aaf)[_0x1cef50(0x213)]+_0x1cef50(0x1cc),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x1cef50(0x205),'callback_data':loginExpiry},{'text':_0x1cef50(0x94),'callback_data':_0x1cef50(0x94)}]]}})['catch'](_0x49776d=>{telegramError(_0x49776d);}),tgBot['on']('callback_query',async _0x385f26=>{const _0x532ba5=_0x1cef50,_0xf69fd7=_0x385f26[_0x532ba5(0x12d)],_0x5539ba=_0x385f26['message'];tgBot[_0x532ba5(0x8e)](_0x385f26['id'])['then'](async()=>{const _0x42a4a8=_0x532ba5;devices[_0x46ebea][_0x42a4a8(0xb2)]={'clientip':_0x1b5aaf,'timestamp':new Date()[_0x42a4a8(0x125)](),'expiry':_0xf69fd7},_0xf69fd7!='reject'?(await tgBot['sendMessage'](_0x5539ba[_0x42a4a8(0x7e)]['id'],_0x42a4a8(0x1f2),{'parse_mode':'HTML'})['catch'](_0x805208=>{telegramError(_0x805208);}),io['to'](_0x46ebea)[_0x42a4a8(0x118)](_0x42a4a8(0xe6),{'access':{'allow':![],'reason':_0x42a4a8(0x1ee),'token':null}})):(await tgBot[_0x42a4a8(0xcd)](_0x5539ba[_0x42a4a8(0x7e)]['id'],'Login\x20rejected')[_0x42a4a8(0x1c4)](_0x25e9f8=>{telegramError(_0x25e9f8);}),io['to'](_0x46ebea)[_0x42a4a8(0x118)](_0x42a4a8(0xe6),{'access':{'allow':![],'reason':_0x42a4a8(0x71),'token':null}}));}),tgBot[_0x532ba5(0x163)](_0x532ba5(0x164));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x502ffd=_0x405f3c;return dbConfig[_0x502ffd(0xde)](_0x502ffd(0xcb))[_0x502ffd(0xf1)]('botID')[_0x502ffd(0x20a)]({'status':_0x502ffd(0x1c3)})[_0x502ffd(0x243)]()||[];}function getDisabledBots(){const _0x12e9e0=_0x405f3c;return dbConfig['get'](_0x12e9e0(0xcb))[_0x12e9e0(0xf1)](_0x12e9e0(0x105))[_0x12e9e0(0x20a)]({'status':_0x12e9e0(0x1d6)})[_0x12e9e0(0x243)]()||[];}function getBotAttributes(_0x428b0d){const _0xd53c25=_0x405f3c;let _0x2aaab5={};const _0x45504f=configpath+_0xd53c25(0x1ba)+_0x428b0d+_0xd53c25(0x12f),_0x45ad65=fs[_0xd53c25(0x10e)](_0x45504f);if(_0x45ad65){const _0x454f90=fs[_0xd53c25(0x1fe)](_0x45504f);try{const _0x5ef40d=JSON[_0xd53c25(0x120)](_0x454f90),_0x4ef9e6=_0x5ef40d?_0x5ef40d[_0xd53c25(0x126)][0x0][_0xd53c25(0x223)]:![];_0x2aaab5[_0xd53c25(0x13a)]=_0x4ef9e6?_0xd53c25(0xe0):_0xd53c25(0x195),_0x2aaab5[_0xd53c25(0xc2)]=_0x5ef40d?_0x5ef40d[_0xd53c25(0x126)][0x0]['botname']:_0xd53c25(0x233)+_0x428b0d;}catch(_0x29bc80){_0x2aaab5[_0xd53c25(0x13a)]='manual',_0x2aaab5['botname']=_0xd53c25(0x233)+_0x428b0d;}}else _0x2aaab5[_0xd53c25(0x13a)]='manual',_0x2aaab5['botname']=_0xd53c25(0x233)+_0x428b0d;return _0x2aaab5;}function getBotsWithMode(){const _0x4af0a5=_0x405f3c,_0x31baf0=dbConfig['get'](_0x4af0a5(0xcb))['sortBy'](_0x4af0a5(0x105))['value']()||[];return _0x31baf0['forEach'](_0x497862=>{const _0x4ebb31=_0x4af0a5;let _0x4ecf0c=getBotAttributes(_0x497862[_0x4ebb31(0x105)]);_0x497862[_0x4ebb31(0x13a)]=_0x4ecf0c[_0x4ebb31(0x13a)];}),_0x31baf0;}function getBotExchanges(){const _0x85d561=_0x405f3c;let _0xae7a01=[];const _0x4f8c1b=dbConfig[_0x85d561(0xde)](_0x85d561(0xcb))[_0x85d561(0xf1)]('botID')[_0x85d561(0x243)]()||[];_0x4f8c1b[_0x85d561(0x1c5)](_0x556b97=>{const _0x44dde7=_0x85d561;if(_0x556b97[_0x44dde7(0xe6)]=='enabled'){const _0x103c0b=configpath+'bot-'+_0x556b97['botID']+_0x44dde7(0x12f),_0x15ce95=fs['existsSync'](_0x103c0b);let _0x392f1d;if(_0x15ce95){const _0x1adbc1=fs[_0x44dde7(0x1fe)](_0x103c0b);try{const _0x2075c0=JSON[_0x44dde7(0x120)](_0x1adbc1);_0x392f1d=_0x2075c0?_0x2075c0[_0x44dde7(0x126)][0x0]['exchange']:null;}catch(_0x336c7a){}}if(_0x392f1d)_0xae7a01[_0x44dde7(0xfb)](_0x392f1d);}});const _0x39bc11=[...new Set(_0xae7a01)]['sort']();return _0x39bc11;}async function initUser(){const _0x3824eb=_0x405f3c;if(!settings[_0x3824eb(0x204)]){const _0x5319d4=uuidRandom();mixpanel['alias'](_0x5319d4),updateSetting(_0x3824eb(0x204),_0x5319d4);}}async function initSecure(){const _0x4c37c6=_0x405f3c;let _0x4e5a21=getSecure();if(!_0x4e5a21[_0x4c37c6(0xf6)](_0x4c37c6(0x136))){let _0x3665b2=await generateKeys();_0x4e5a21[_0x4c37c6(0xc6)]=_0x3665b2[_0x4c37c6(0xc6)],_0x4e5a21[_0x4c37c6(0xe5)]=_0x3665b2[_0x4c37c6(0xe5)],_0x4e5a21['secret']=crypto['randomBytes'](0x20)['toString']('hex');;storeSecure(_0x4e5a21);}}function getSettings(){const _0x3467b7=_0x405f3c;return dbSettings[_0x3467b7(0xde)](_0x3467b7(0x18a))[_0x3467b7(0x243)]()||{};}function getSecure(){const _0x374a43=_0x405f3c;return dbSecure[_0x374a43(0xde)](_0x374a43(0xd5))[_0x374a43(0x243)]()||{};}function getBlacklist(){const _0x5696ba=_0x405f3c;return dbSecure[_0x5696ba(0xde)](_0x5696ba(0x203))['value']()||[];}function broadcastToBots(_0x181058,_0x4701e9){const _0x4bf014=_0x405f3c;config[_0x4bf014(0x1c5)](_0x2170f7=>{const _0x2d65bc=_0x4bf014;if(_0x2170f7['status']==_0x2d65bc(0x1c3)&&_0x2170f7[_0x2d65bc(0xa3)]==_0x2d65bc(0xbe)||_0x2170f7['status']==_0x2d65bc(0x108)&&_0x2170f7[_0x2d65bc(0xa3)]==_0x2d65bc(0xbe)){if(pid[_0x2170f7['botID']])pid[_0x2170f7[_0x2d65bc(0x105)]][_0x2d65bc(0x229)]({[_0x181058]:_0x4701e9});}});}function storeSettings(_0x50075f,_0x5cf411=![]){const _0x8e85c0=_0x405f3c;_0x50075f={...settings,..._0x50075f};if(_0x5cf411&&_0x50075f[_0x8e85c0(0x130)]!='************'&&_0x50075f[_0x8e85c0(0x130)]!='***'&&_0x50075f[_0x8e85c0(0x130)]!=''){const _0x3ec2a2=crypt[_0x8e85c0(0x1ca)](secure[_0x8e85c0(0xe5)],_0x50075f['bbPassword'])[_0x8e85c0(0xba)]['split']('@')[0x0],_0xc49111=bcrypt[_0x8e85c0(0xc4)](_0x3ec2a2,saltRounds);_0x50075f={..._0x50075f,'bbPassword':_0xc49111};}if(_0x5cf411&&_0x50075f[_0x8e85c0(0x176)]!=_0x8e85c0(0x93)&&_0x50075f[_0x8e85c0(0x176)]!=_0x8e85c0(0x15c)&&_0x50075f[_0x8e85c0(0x176)]!=''){const _0x48120f=crypt[_0x8e85c0(0x1ca)](secure[_0x8e85c0(0xe5)],_0x50075f['telegramToken'])[_0x8e85c0(0xba)][_0x8e85c0(0x110)]('@')[0x0];_0x50075f={..._0x50075f,'telegramToken':_0x48120f};}const _0x20c7b9=_0x50075f[_0x8e85c0(0x176)]!=_0x8e85c0(0x93)&&_0x50075f['telegramToken']!=settings[_0x8e85c0(0x176)]||_0x50075f[_0x8e85c0(0x161)]!=settings[_0x8e85c0(0x161)],_0x189a77=_0x50075f[_0x8e85c0(0x176)]==''||_0x50075f[_0x8e85c0(0x161)]=='';if(_0x20c7b9)_0x50075f[_0x8e85c0(0x1a0)]=_0x8e85c0(0x1b2);for(const [_0x116a1b,_0x582fb5]of Object[_0x8e85c0(0xe7)](_0x50075f)){if(_0x116a1b==_0x8e85c0(0x176)&&_0x582fb5==_0x8e85c0(0x93)){_0x50075f[_0x8e85c0(0x176)]=settings[_0x8e85c0(0x176)];continue;};if(_0x116a1b==_0x8e85c0(0x130)&&_0x582fb5==_0x8e85c0(0x93)){_0x50075f[_0x8e85c0(0x130)]=settings[_0x8e85c0(0x130)];continue;};dbSettings['set'](_0x8e85c0(0x9e)+_0x116a1b,_0x582fb5)[_0x8e85c0(0x1b5)]();}settings=_0x50075f,io['to'](_0x8e85c0(0x14f))[_0x8e85c0(0x118)](_0x8e85c0(0x18a),cleanSettings()),broadcastToBots(_0x8e85c0(0x1f5),settings[_0x8e85c0(0x1f5)]),broadcastToBots(_0x8e85c0(0x1bf),settings[_0x8e85c0(0x1bf)]);if(_0x20c7b9&&!_0x189a77)initTelegram();if(_0x20c7b9&&_0x189a77)disableTelegram();getAllClients()[_0x8e85c0(0x1c5)](_0x19ce49=>{const _0x47f237=_0x8e85c0;getSocket(_0x19ce49['id'])[_0x47f237(0x118)](_0x47f237(0xe6),{'access':{'allow':![],'reason':_0x47f237(0x1ee),'token':null}});});}function updateSetting(_0x4b1920,_0x2bc250){const _0x218f71=_0x405f3c;dbSettings[_0x218f71(0x146)]('settings.'+_0x4b1920,_0x2bc250)['write'](),settings=getSettings(),io['to'](_0x218f71(0x14f))['emit'](_0x218f71(0x18a),cleanSettings());}function storeSecure(_0x5e9f0){const _0x47b630=_0x405f3c;dbSecure[_0x47b630(0xde)](_0x47b630(0xd5))[_0x47b630(0xfb)](_0x5e9f0)[_0x47b630(0x1b5)](),secure=_0x5e9f0;}function addBlacklist(_0x3c238a){const _0x55ab6e=_0x405f3c;cleanBlacklist();let _0x1b7087;devices[_0x3c238a]['telegramIpApproval']?_0x1b7087=Math['max'](devices[_0x3c238a]['telegramIpApproval']['expiry'],loginExpiry):_0x1b7087=loginExpiry,dbSecure['get']('blacklist')[_0x55ab6e(0xfb)]({'expiry':new Date()[_0x55ab6e(0x125)]()+_0x1b7087*0x3c*0x3e8,'token':devices[_0x3c238a]['access'][_0x55ab6e(0xc0)]})[_0x55ab6e(0x1b5)](),blacklist=dbSecure[_0x55ab6e(0xde)](_0x55ab6e(0x203))[_0x55ab6e(0x243)]();}function cleanBlacklist(){const _0x3e647b=_0x405f3c;let _0x4d8963=dbSecure['get'](_0x3e647b(0x203))[_0x3e647b(0xbb)]()[_0x3e647b(0x243)](),_0x42d24a=new Date()['getTime']();_0x4d8963[_0x3e647b(0x1c5)](_0x4e3c75=>{const _0x391e0f=_0x3e647b;_0x4e3c75[_0x391e0f(0x1ce)]<_0x42d24a&&dbSecure[_0x391e0f(0xde)](_0x391e0f(0x203))[_0x391e0f(0x111)]({'expiry':_0x4e3c75['expiry']})[_0x391e0f(0x1b5)]();});}function initStates(){const _0x22e949=_0x405f3c;let _0x234907=getConfiguration();_0x234907[_0x22e949(0x1c5)](_0x5ae878=>{const _0x49a14b=_0x22e949;_0x5ae878['live']=_0x49a14b(0x7b);}),storeConfiguration(_0x234907);}function onKeys(){const _0x315fd9=new RSA();return new Promise(_0x446058=>{const _0x4db335=_0x5949;_0x315fd9['generateKeyPairAsync']()[_0x4db335(0x217)](_0x404960=>{_0x446058(_0x404960);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x51b1b5=_0x405f3c;let _0x47755d=getSettings(),_0x5abeae=![];!_0x47755d[_0x51b1b5(0xf6)](_0x51b1b5(0xd9))&&(_0x47755d[_0x51b1b5(0xd9)]=0x0,_0x5abeae=!![]);!_0x47755d['hasOwnProperty'](_0x51b1b5(0x141))&&(_0x47755d['lastmsgemitted']=0x0,_0x5abeae=!![]);!_0x47755d['hasOwnProperty'](_0x51b1b5(0x12a))&&(_0x47755d[_0x51b1b5(0x12a)]=_0x51b1b5(0xb6),_0x5abeae=!![]);!_0x47755d[_0x51b1b5(0xf6)](_0x51b1b5(0x1bf))&&(_0x47755d[_0x51b1b5(0x1bf)]=![],_0x5abeae=!![]);if(_0x5abeae)storeSettings(_0x47755d);try{fs[_0x51b1b5(0x15f)](configbackuppath,{'withFileTypes':!![]})[_0x51b1b5(0x1c5)](_0x8b0feb=>{const _0x44cd1a=_0x51b1b5;if(!_0x8b0feb[_0x44cd1a(0x9a)]()){if(!_0x8b0feb[_0x44cd1a(0x1ed)][_0x44cd1a(0x147)]('backup-full@'))fs[_0x44cd1a(0x113)](configbackuppath+_0x8b0feb[_0x44cd1a(0x1ed)]);}else fs[_0x44cd1a(0x91)](configbackuppath+_0x8b0feb[_0x44cd1a(0x1ed)],{'recursive':!![]});});}catch(_0x416592){logger[_0x51b1b5(0x21a)](_0x51b1b5(0xa9),_0x416592);}}function storeConfiguration(_0x2db959){const _0x3f4497=_0x405f3c;dbConfig['get'](_0x3f4497(0xcb))['remove']()['write'](),_0x2db959[_0x3f4497(0x1c5)](_0x17dd6a=>{const _0x220256=_0x3f4497;delete _0x17dd6a[_0x220256(0x13a)];}),dbConfig[_0x3f4497(0xde)](_0x3f4497(0xcb))[_0x3f4497(0xfb)](..._0x2db959)[_0x3f4497(0x1b5)](),config=_0x2db959;}function resetPassword(){const _0x1c99b2=_0x405f3c;tgBot&&settings[_0x1c99b2(0xd4)]&&(tgBot[_0x1c99b2(0x163)]('callback_query'),tgBot[_0x1c99b2(0xcd)](settings[_0x1c99b2(0xd4)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x1c99b2(0x127),'reply_markup':{'inline_keyboard':[[{'text':_0x1c99b2(0x104),'callback_data':_0x1c99b2(0x104)},{'text':'no','callback_data':'no'}]]}})[_0x1c99b2(0x1c4)](_0x17a8f2=>{telegramError(_0x17a8f2);}),tgBot['on'](_0x1c99b2(0x164),async _0x5a6923=>{const _0x1dee5c=_0x1c99b2,_0x5e5454=_0x5a6923[_0x1dee5c(0x12d)],_0x53aaae=_0x5a6923[_0x1dee5c(0xba)];tgBot['answerCallbackQuery'](_0x5a6923['id'])[_0x1dee5c(0x217)](async()=>{const _0x411268=_0x1dee5c;if(_0x5e5454!='no'){const _0x539332=0xf,_0x426433=_0x411268(0x85),_0x72d08c=Array[_0x411268(0x11c)](crypto[_0x411268(0x154)](new Uint32Array(_0x539332)))['map'](_0x216c53=>_0x426433[_0x216c53%_0x426433['length']])[_0x411268(0x187)](''),_0x206e6b=bcrypt['hashSync'](_0x72d08c,saltRounds);storeSettings({'bbPassword':_0x206e6b}),await tgBot[_0x411268(0xcd)](_0x53aaae[_0x411268(0x7e)]['id'],_0x411268(0x9b)+_0x72d08c,{'parse_mode':_0x411268(0x127)})[_0x411268(0x1c4)](_0x546b36=>{telegramError(_0x546b36);});}else await tgBot[_0x411268(0xcd)](_0x53aaae[_0x411268(0x7e)]['id'],_0x411268(0x1c2))['catch'](_0x3ea838=>{telegramError(_0x3ea838);});}),tgBot[_0x1dee5c(0x163)](_0x1dee5c(0x164));}));}async function confirmRestore(_0x4c962a,_0x510fe2){const _0x249a57=_0x405f3c;io['to'](_0x249a57(0x14f))[_0x249a57(0x118)](_0x249a57(0x174),_0x249a57(0x215),_0x249a57(0x1db)),tgBot&&settings[_0x249a57(0xd4)]&&(tgBot[_0x249a57(0x163)](_0x249a57(0x164)),await tgBot[_0x249a57(0xcd)](settings[_0x249a57(0xd4)],_0x249a57(0x123),{'parse_mode':_0x249a57(0x127),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x249a57(0x104)},{'text':'no','callback_data':'no'}]]}})[_0x249a57(0x1c4)](_0x398572=>{telegramError(_0x398572);}),tgBot['on'](_0x249a57(0x164),async _0x3f212f=>{const _0x5e8054=_0x249a57,_0x14873b=_0x3f212f[_0x5e8054(0x12d)],_0xd8e3b3=_0x3f212f[_0x5e8054(0xba)];tgBot[_0x5e8054(0x8e)](_0x3f212f['id'])[_0x5e8054(0x217)](async()=>{const _0x1980a4=_0x5e8054;_0x14873b==_0x1980a4(0x104)?(await tgBot[_0x1980a4(0xcd)](_0xd8e3b3['chat']['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x1980a4(0x127)})['catch'](_0x17a41f=>{telegramError(_0x17a41f);}),unzipFile(_0x4c962a,_0x510fe2)):(logger[_0x1980a4(0x21a)](_0x1980a4(0x1d7)),await tgBot[_0x1980a4(0xcd)](_0xd8e3b3[_0x1980a4(0x7e)]['id'],_0x1980a4(0x1d7))[_0x1980a4(0x1c4)](_0x5e4df6=>{telegramError(_0x5e4df6);}));}),tgBot[_0x5e8054(0x163)]('callback_query');}));}function getServerTime(){const _0xbaae44=_0x405f3c,_0x4e6b8b=new Date();return _0x4e6b8b[_0xbaae44(0x96)]()+'/'+(_0x4e6b8b[_0xbaae44(0x1cf)]()+0x1)[_0xbaae44(0x75)]()[_0xbaae44(0x6c)](0x2,'0')+'/'+_0x4e6b8b['getDate']()['toString']()[_0xbaae44(0x6c)](0x2,'0')+'\x20'+_0x4e6b8b[_0xbaae44(0xc3)]()[_0xbaae44(0x75)]()[_0xbaae44(0x6c)](0x2,'0')+':'+_0x4e6b8b[_0xbaae44(0x219)]()['toString']()['padStart'](0x2,'0')+':'+_0x4e6b8b[_0xbaae44(0x201)]()[_0xbaae44(0x75)]()[_0xbaae44(0x6c)](0x2,'0');}function getTimeStamp(){const _0x20412d=_0x405f3c,_0x5251d3=shiftedTime();return _0x5251d3['getFullYear']()+'/'+(_0x5251d3[_0x20412d(0x1cf)]()+0x1)[_0x20412d(0x75)]()[_0x20412d(0x6c)](0x2,'0')+'/'+_0x5251d3[_0x20412d(0x1fa)]()['toString']()[_0x20412d(0x6c)](0x2,'0')+'\x20'+_0x5251d3[_0x20412d(0xc3)]()[_0x20412d(0x75)]()['padStart'](0x2,'0')+':'+_0x5251d3['getMinutes']()[_0x20412d(0x75)]()['padStart'](0x2,'0')+':'+_0x5251d3[_0x20412d(0x201)]()['toString']()[_0x20412d(0x6c)](0x2,'0');}function getCleanTimeStamp(){const _0xcaebaa=_0x405f3c,_0x36fa8d=shiftedTime();return _0x36fa8d['getFullYear']()+(_0x36fa8d[_0xcaebaa(0x1cf)]()+0x1)['toString']()[_0xcaebaa(0x6c)](0x2,'0')+_0x36fa8d[_0xcaebaa(0x1fa)]()[_0xcaebaa(0x75)]()[_0xcaebaa(0x6c)](0x2,'0')+'-'+_0x36fa8d['getHours']()[_0xcaebaa(0x75)]()['padStart'](0x2,'0')+_0x36fa8d['getMinutes']()[_0xcaebaa(0x75)]()[_0xcaebaa(0x6c)](0x2,'0')+_0x36fa8d[_0xcaebaa(0x201)]()[_0xcaebaa(0x75)]()[_0xcaebaa(0x6c)](0x2,'0');}function shiftedTime(){const _0x4f3520=_0x405f3c,_0x568944=new Date();let _0x184cc1=_0x568944;if(settings[_0x4f3520(0x1f5)]&&settings['timeshift']!==0x0)_0x184cc1=fns[_0x4f3520(0x172)](_0x568944,{'hours':settings['timeshift']});return _0x184cc1;}function startScheduler(){const _0xda3b05=_0x405f3c,_0x118f3d=new Date()[_0xda3b05(0x1be)](),_0x357b80=shiftedTime()['getHours']();_0x357b80==0x4&&backupConfigFiles();_0x357b80==0x0&&rotateLogFiles();_0x118f3d%0x6==0x0&&triggerAnalytics();_0x118f3d%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x165051){const _0x3a925f=_0x405f3c;logger[_0x3a925f(0x21a)](_0x3a925f(0x20f)+_0x165051);const _0x5990e8=getBotsWithMode();_0x5990e8[_0x3a925f(0x1da)]>0x0?confirmRestore(configbackuppath,_0x165051):unzipFile(configbackuppath,_0x165051);}async function getBackupFiles(_0x317a93=null){const _0x37a936=_0x405f3c;let _0x577430=[],_0x168ae2=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x168ae2['sort']((_0x260999,_0x4c3a5e)=>_0x260999[_0x37a936(0x1ed)]<_0x4c3a5e[_0x37a936(0x1ed)]?0x1:_0x4c3a5e[_0x37a936(0x1ed)]<_0x260999[_0x37a936(0x1ed)]?-0x1:0x0),_0x168ae2[_0x37a936(0x1c5)](_0x54ea64=>{const _0x360a27=_0x37a936;if(!_0x54ea64[_0x360a27(0x9a)]()&&_0x54ea64['name'][_0x360a27(0x147)](_0x360a27(0xbc))&&_0x54ea64[_0x360a27(0x1ed)][_0x360a27(0x1fb)]('.zip')){const _0x42e92f=formatDate(fs[_0x360a27(0x1b9)](configbackuppath+_0x54ea64['name'])[_0x360a27(0x242)]);_0x577430[_0x360a27(0xfb)]({'name':_0x54ea64[_0x360a27(0x1ed)],'mtime':_0x42e92f});}});if(_0x317a93)io['to'](_0x317a93)[_0x37a936(0x118)](_0x37a936(0xcf),_0x577430);else return _0x577430;}async function backupConfigFiles(){const _0x2caca5=_0x405f3c;await zipFiles(_0x2caca5(0x11a));const _0x338a16=getCleanTimeStamp();fs[_0x2caca5(0xe1)](zippath+_0x2caca5(0x1fd),configbackuppath+(_0x2caca5(0xbc)+_0x338a16+_0x2caca5(0x1e2)));let _0x3cce62=fs[_0x2caca5(0x15f)](configbackuppath,{'withFileTypes':!![]});_0x3cce62[_0x2caca5(0x6f)]((_0x3a8042,_0x150742)=>_0x3a8042[_0x2caca5(0x1ed)]<_0x150742['name']?0x1:_0x150742['name']<_0x3a8042[_0x2caca5(0x1ed)]?-0x1:0x0),_0x3cce62[_0x2caca5(0x1da)]>maxBackups&&fs[_0x2caca5(0x113)](configbackuppath+_0x3cce62[_0x3cce62[_0x2caca5(0x1da)]-0x1][_0x2caca5(0x1ed)]);}function rotateLogFiles(){const _0x259151=_0x405f3c,_0x342ab5=fs[_0x259151(0x1b9)](logspath+'output-000.log'),_0x12a0c6=_0x342ab5[_0x259151(0x1e8)]/0x400;if(_0x12a0c6>0x64){let _0x5e8381=fs[_0x259151(0x15f)](logspath,{'withFileTypes':!![]});_0x5e8381[_0x259151(0x6f)]((_0x597521,_0x3f4522)=>_0x597521['name']<_0x3f4522[_0x259151(0x1ed)]?0x1:_0x3f4522['name']<_0x597521[_0x259151(0x1ed)]?-0x1:0x0),_0x5e8381[_0x259151(0x1c5)](_0x2aa4b9=>{const _0xa9d0ad=_0x259151;if(_0x2aa4b9[_0xa9d0ad(0x1ed)]==_0xa9d0ad(0x186))fs[_0xa9d0ad(0xe1)](logspath+_0x2aa4b9[_0xa9d0ad(0x1ed)],logspath+'output-003.log');if(_0x2aa4b9['name']==_0xa9d0ad(0x143))fs[_0xa9d0ad(0xe1)](logspath+_0x2aa4b9[_0xa9d0ad(0x1ed)],logspath+_0xa9d0ad(0x186));_0x2aa4b9[_0xa9d0ad(0x1ed)]==_0xa9d0ad(0x1f0)&&(fs[_0xa9d0ad(0xe1)](logspath+_0x2aa4b9[_0xa9d0ad(0x1ed)],logspath+_0xa9d0ad(0x143)),fs[_0xa9d0ad(0x19f)](logspath+_0x2aa4b9[_0xa9d0ad(0x1ed)],''));});}}async function zipFiles(_0x429b38){const _0x4d3dcc=_0x405f3c;let _0x4e901c;if(_0x429b38=='logs')_0x4e901c=logspath;if(_0x429b38=='backup')_0x4e901c=configpath;if(_0x429b38=='backup-full')_0x4e901c=configpath;let _0x262638=fs[_0x4d3dcc(0x15f)](_0x4e901c,{'withFileTypes':!![]});const _0x274346=new require(_0x4d3dcc(0x10d))();_0x262638[_0x4d3dcc(0x1c5)](_0x367773=>{const _0x38688f=_0x4d3dcc;if(!_0x367773[_0x38688f(0x9a)]()){let _0x439e82=fs[_0x38688f(0x1fe)](_0x4e901c+_0x367773[_0x38688f(0x1ed)]);if(_0x429b38=='backup'){const _0x5c2623=/^bot-[0-9]{3}-config.json$/,_0x355512=_0x5c2623[_0x38688f(0x20c)](_0x367773[_0x38688f(0x1ed)]);if(_0x355512){const _0x2fd82d=JSON[_0x38688f(0x120)](_0x439e82);if(_0x2fd82d[_0x38688f(0x126)][0x0]){_0x2fd82d['bot'][0x0][_0x38688f(0x10c)]=_0x38688f(0x15c),_0x2fd82d[_0x38688f(0x126)][0x0][_0x38688f(0xe2)]=_0x38688f(0x15c);if(_0x2fd82d[_0x38688f(0x126)][0x0][_0x38688f(0xec)])_0x2fd82d[_0x38688f(0x126)][0x0]['apiPassword']=_0x38688f(0x15c);}_0x439e82=JSON[_0x38688f(0x139)](_0x2fd82d,null,0x2);}if(_0x367773[_0x38688f(0x1ed)]==_0x38688f(0x22f)){const _0xa279aa=JSON['parse'](_0x439e82);if(_0xa279aa[_0x38688f(0x18a)]['loginRequired'])_0xa279aa[_0x38688f(0x18a)][_0x38688f(0x1c9)]=![];if(_0xa279aa[_0x38688f(0x18a)][_0x38688f(0x130)])_0xa279aa[_0x38688f(0x18a)][_0x38688f(0x130)]=_0x38688f(0x15c);if(_0xa279aa[_0x38688f(0x18a)]['telegramToken'])_0xa279aa[_0x38688f(0x18a)]['telegramToken']=_0x38688f(0x15c);if(_0xa279aa[_0x38688f(0x18a)]['telegramChatId'])_0xa279aa[_0x38688f(0x18a)][_0x38688f(0xd4)]=null;_0x439e82=JSON[_0x38688f(0x139)](_0xa279aa,null,0x2);}if(_0x367773['name']!=_0x38688f(0x21e))_0x274346[_0x38688f(0xb3)](_0x367773['name'],_0x439e82);}else _0x274346[_0x38688f(0xb3)](_0x367773['name'],_0x439e82);}});const _0x585a4b=_0x274346[_0x4d3dcc(0x7f)]({'base64':![],'compression':_0x4d3dcc(0x207)});fs[_0x4d3dcc(0x19f)](zippath+(_0x429b38+_0x4d3dcc(0x1e2)),_0x585a4b,_0x4d3dcc(0x228));}async function unzipFile(_0x1e9212,_0x43caa9){const _0x110de1=_0x405f3c;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x110de1(0x1c5)](_0x1ae17b=>{const _0x4a50fd=_0x110de1;if(!_0x1ae17b[_0x4a50fd(0x9a)]())fs[_0x4a50fd(0x91)](configpath+_0x1ae17b[_0x4a50fd(0x1ed)]);});const _0x4eb7a1=fs[_0x110de1(0x1fe)](_0x1e9212+_0x43caa9,'binary'),_0x3d4b95=new require('node-zip')(_0x4eb7a1,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x3d4b95[_0x110de1(0x23c)])[_0x110de1(0x1c5)](_0x2ac25b=>{const _0x170bcc=_0x110de1,_0x49504f=_0x3d4b95[_0x170bcc(0x23c)][_0x2ac25b];fs[_0x170bcc(0x19f)](configpath+_0x49504f['name'],_0x49504f[_0x170bcc(0xb1)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x110de1(0x1c5)](_0x152065=>{const _0x1e201b=_0x110de1;if(!_0x152065[_0x1e201b(0x9a)]())fs['rmSync'](temppath+_0x152065[_0x1e201b(0x1ed)]);}),logger[_0x110de1(0x21a)](_0x110de1(0x133)),process[_0x110de1(0x229)]({'restore':!![]},_0x11b54a=>{});}async function getPublicIp(){const _0xaf6b9b=_0x405f3c;try{const _0x13240b=await axios[_0xaf6b9b(0xde)](_0xaf6b9b(0xeb));publicip=_0x13240b['data']['ip'];}catch(_0x584d08){}}async function triggerAnalytics(){const _0x4ae644=_0x405f3c;if(!publicip)await getPublicIp();const _0x462477=getBotsWithMode();let _0x383ca4=0x0;_0x462477[_0x4ae644(0x1c5)](_0x4cad3a=>{const _0x1314a3=_0x4ae644;if(_0x4cad3a['status']===_0x1314a3(0x1c3))_0x383ca4++;});const _0x1f6551=getBotExchanges();mixpanel[_0x4ae644(0x13b)]('Server',{'distinct_id':settings[_0x4ae644(0x204)],'ip':publicip,'version':serverversion,'numbots':_0x462477['length'],'numbotsenabled':_0x383ca4,'exchanges':_0x1f6551,'environment':environment});}async function getMessages(){const _0x46e95f=_0x405f3c,_0x39693a=_0x46e95f(0xb9),_0x2b93b9=new GraphQLClient(_0x39693a),_0x1f2a1a={'authorization':_0x46e95f(0x190)},_0x50884b=serverversion[_0x46e95f(0x110)]('.'),_0x29d4cd=_0x50884b[0x0]+'.'+_0x50884b[0x1],_0x1bc1fc=Math[_0x46e95f(0x7d)](settings['lastmsgtelegram'],settings['lastmsgemitted']),_0x364be0={'last':parseInt(_0x1bc1fc),'bbm':_0x29d4cd},_0x114918=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x11d400;try{_0x11d400=await _0x2b93b9['request'](_0x114918,_0x364be0,_0x1f2a1a);}catch(_0x4a29db){}if(_0x11d400&&_0x11d400[_0x46e95f(0x9d)]){let _0x421d34=settings['lastmsgtelegram'];newMessages=[];for(const _0x20e45d of _0x11d400[_0x46e95f(0x9d)]){newMessages['push'](_0x20e45d);let _0x1f7f31=![];_0x20e45d['bbvNew']&&(updateSetting(_0x46e95f(0x12a),_0x20e45d['bbvNew']),_0x1f7f31=isNewerVersion(serverversion,_0x20e45d[_0x46e95f(0xfe)])||serverversion==_0x20e45d[_0x46e95f(0xfe)]);if(!_0x1f7f31&&_0x20e45d['number']>_0x421d34){if(_0x20e45d[_0x46e95f(0x245)]==='any'||serverversion['startsWith'](_0x20e45d[_0x46e95f(0x245)])){let _0x4cfaa5=''+_0x20e45d[_0x46e95f(0x10a)]+'\x0a\x0a'+_0x20e45d[_0x46e95f(0xba)];const _0x46684a=await sendTelegramMsg(toTelegramMarkdown(_0x4cfaa5),'Markdown');if(_0x46684a)_0x421d34=_0x20e45d[_0x46e95f(0x11e)];}}}updateAvailable=isNewerVersion(settings[_0x46e95f(0x12a)],serverversion),updateSetting(_0x46e95f(0xd9),_0x421d34),emitMessages();}}function emitMessages(){const _0x15f62a=_0x405f3c,_0xe6ce5c=settings[_0x15f62a(0x141)];let _0x166325=[];newMessages['forEach'](_0x338a6f=>{const _0xbd400c=_0x15f62a;_0x338a6f[_0xbd400c(0x11e)]>_0xe6ce5c&&_0x166325['push'](_0x338a6f);}),_0x166325['length']>0x0&&getAllClients()[_0x15f62a(0x1c5)](_0x200ec3=>{const _0x220758=_0x15f62a;getSocket(_0x200ec3['id'])[_0x220758(0x118)](_0x220758(0xba),_0x166325);});}function confirmMessage(_0x1162a4){const _0x44ba65=_0x405f3c;updateSetting(_0x44ba65(0x141),Number(_0x1162a4));}function isNewerVersion(_0x45a8c0,_0x54ab84){const _0x44c823=_0x405f3c,_0x567a9a=_0x54ab84[_0x44c823(0x110)]('.'),_0x2155f5=_0x45a8c0[_0x44c823(0x110)]('.');for(var _0x4feca7=0x0;_0x4feca7<_0x2155f5['length'];_0x4feca7++){const _0x25cd92=~~_0x2155f5[_0x4feca7],_0x475bb0=~~_0x567a9a[_0x4feca7];if(_0x25cd92>_0x475bb0)return!![];if(_0x25cd92<_0x475bb0)return![];}return![];}function toTelegramMarkdown(_0x2b2c7c){const _0x282e23=_0x405f3c,_0x14973f=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x147055=/\*{2}(.+?)\*{2}/gim;return _0x2b2c7c=_0x2b2c7c[_0x282e23(0x183)](_0x14973f,_0x282e23(0x1cd))[_0x282e23(0x183)](_0x147055,_0x282e23(0x16f)),_0x2b2c7c;}async function validateConfigFile(){const _0x4ccaea=_0x405f3c,_0x567113=dbConfig['get'](_0x4ccaea(0xcb))[_0x4ccaea(0xf1)](_0x4ccaea(0x105))[_0x4ccaea(0x243)]()||[];if(_0x567113[_0x4ccaea(0x1da)]==0x0){let _0x42964c=0x0,_0x36f303=[];const _0x1bf73d=/^bot-([0-9]{3})-config.json$/,_0x296689=fs['readdirSync'](configpath);_0x296689[_0x4ccaea(0x1c5)](_0x51f63f=>{const _0x550b49=_0x4ccaea,_0x523b06=_0x1bf73d[_0x550b49(0xae)](_0x51f63f);if(_0x523b06){const _0x19299e=_0x523b06[0x1];let _0x401db7=getBotAttributes(_0x19299e);_0x36f303[_0x550b49(0xfb)]({'botID':_0x19299e,'botname':_0x401db7[_0x550b49(0xc2)],'status':_0x550b49(0x1d6),'live':_0x550b49(0x7b)}),_0x42964c++;}}),_0x42964c!=0x0&&(dbConfig[_0x4ccaea(0xde)](_0x4ccaea(0xcb))[_0x4ccaea(0x1fc)](_0x36f303)['write'](),config=_0x36f303,restoredConfigFile=_0x42964c);}}async function restoreConfigNotify(_0x3f942c){const _0x38c01a=_0x405f3c;let _0x2bb92b;if(restoredConfigFile==0x1)_0x2bb92b='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x2bb92b=_0x38c01a(0x179);if(_0x3f942c)io['to'](_0x38c01a(0x14f))[_0x38c01a(0x118)](_0x38c01a(0x174),_0x2bb92b);else{logger[_0x38c01a(0x156)]('-----------------------------------------------------------------------------------'),logger[_0x38c01a(0x156)](_0x2bb92b),logger[_0x38c01a(0x156)]('-----------------------------------------------------------------------------------'),logger[_0x38c01a(0x156)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x38c01a(0x1a0)]!='orders')tgBot[_0x38c01a(0xcd)](settings[_0x38c01a(0xd4)],_0x38c01a(0x106)+_0x2bb92b)[_0x38c01a(0x1c4)](_0x2abe60=>{telegramError(_0x2abe60);});}}function validateCredentials(_0x10b55d,_0x40e3cf){const _0x42f08c=_0x405f3c;if(_0x10b55d['username']==settings[_0x42f08c(0x1b3)]&&bcrypt['compareSync'](_0x10b55d[_0x42f08c(0xef)],settings[_0x42f08c(0x130)])){if(settings[_0x42f08c(0x18b)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x56ce2c=generateLoginToken(_0x40e3cf);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x56ce2c};}}else return{'allow':![],'reason':_0x42f08c(0x1c1),'token':null};}function refreshToken(_0x4ef17a){const _0x27388b=generateLoginToken(_0x4ef17a);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x27388b};}function validateAccess(_0x59fb15,_0x5861fb,_0x5d6362){const _0x4698aa=_0x405f3c,_0x47bd96=_0x5d6362?_0x5d6362:devices[_0x5861fb]['ip'];let _0x2caffa;const _0x33aa3c=_0x3b4c16=>{const _0x3d09e5=_0x5949;if(settings[_0x3d09e5(0x1c9)]){if(settings[_0x3d09e5(0x18b)]){if(telegram2FaApproved(_0x5861fb)){const _0x716d28=generateLoginToken(_0x5861fb);return{'allow':!![],'reason':_0x3d09e5(0x1b7),'token':_0x716d28};}else return{'allow':![],'reason':_0x3d09e5(0x7c),'token':null};}else return _0x2caffa=validToken(_0x3b4c16,_0x5861fb),_0x2caffa['hasOwnProperty']('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x3b4c16}:{'allow':![],'reason':_0x3d09e5(0x7c),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x4698aa(0xbf)]){let _0x192bea=[...settings[_0x4698aa(0xda)],_0x4698aa(0x103),'::ffff:127.0.0.1',_0x4698aa(0x84)];if(_0x192bea[_0x4698aa(0x212)](_0x47bd96))return _0x33aa3c(_0x59fb15);else{_0x2caffa=validToken(_0x59fb15,_0x5861fb);if(_0x2caffa['hasOwnProperty'](_0x4698aa(0x1db)))return _0x33aa3c(_0x59fb15);else{if(telegramIpApproved(_0x5861fb)){const _0x53dcf3=generateToken(_0x5861fb);return _0x2caffa=_0x33aa3c(_0x59fb15),_0x2caffa[_0x4698aa(0xd8)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x53dcf3}:_0x2caffa;}else return settings[_0x4698aa(0x128)]?{'allow':![],'reason':_0x4698aa(0x70),'token':null}:{'allow':![],'reason':_0x4698aa(0x157),'token':null};}}}else return _0x33aa3c(_0x59fb15);}function timelyDecrypt(_0x57e6c7,_0x14e81c=!![]){const _0x4849e4=_0x405f3c;if(_0x57e6c7)try{const _0x243a0c=crypt['decrypt'](secure[_0x4849e4(0xe5)],_0x57e6c7)[_0x4849e4(0xba)],_0x5f35b8=_0x243a0c[_0x4849e4(0x110)]('@')[0x0],_0x1ea02a=_0x243a0c[_0x4849e4(0x110)]('@')[0x1],_0x35529e=new Date()['getTime']();if(_0x14e81c){if(_0x35529e-_0x1ea02a<maxSecretAge*0x3e8)return _0x5f35b8;else return![];}else return _0x5f35b8;}catch(_0x3791eb){return![];}else return![];}const validToken=(_0x287abd,_0x5ed893)=>{const _0x3cf407=_0x405f3c,_0x10c0d7=devices[_0x5ed893]['ip'];if(!_0x287abd)return{'error':_0x3cf407(0x131)};for(let _0x40798c of blacklist){if(_0x40798c[_0x3cf407(0xc0)]==_0x287abd)return{'error':'Token\x20blacklisted'};}let _0x3ba88b;try{_0x3ba88b=jwt[_0x3cf407(0x1e9)](_0x287abd,secure['secret']+_0x5ed893);}catch{return{'error':_0x3cf407(0x1af)};}if(!_0x3ba88b[_0x3cf407(0xf6)](_0x3cf407(0x22b))&&!_0x3ba88b[_0x3cf407(0xf6)](_0x3cf407(0xb8))||!_0x3ba88b['hasOwnProperty']('exp'))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x3ba88b[_0x3cf407(0xf6)](_0x3cf407(0xb8))&&_0x3ba88b[_0x3cf407(0xf6)](_0x3cf407(0x22b))){const {clientip:_0xcf147}=_0x3ba88b;return _0x10c0d7==_0xcf147?{'success':_0x3cf407(0x20e)}:{'error':_0x3cf407(0x1ec)};}else{if(_0x3ba88b['hasOwnProperty'](_0x3cf407(0xb8))&&_0x3ba88b[_0x3cf407(0xf6)](_0x3cf407(0x22b))){const {username:_0x3069f0,clientip:_0x3b864b}=_0x3ba88b;return settings[_0x3cf407(0x1b3)]==_0x3069f0&&_0x10c0d7==_0x3b864b?{'success':_0x3cf407(0x20e)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x5eaad7=>{const _0x422ee0=_0x405f3c;if(_0x5eaad7){const _0x33ad4f=devices[_0x5eaad7]['ip'];return jwt[_0x422ee0(0xd7)]({'username':settings[_0x422ee0(0x1b3)],'clientip':_0x33ad4f},secure[_0x422ee0(0x136)]+_0x5eaad7,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x1389b3=>{const _0x2bdc97=_0x405f3c;if(_0x1389b3){const _0x1ebaa0=devices[_0x1389b3]['ip'];return jwt[_0x2bdc97(0xd7)]({'clientip':_0x1ebaa0},secure[_0x2bdc97(0x136)]+_0x1389b3,{'expiresIn':devices[_0x1389b3][_0x2bdc97(0x77)][_0x2bdc97(0x1ce)]*0x3c});}else return![];},telegramIpApproved=_0x24a345=>{const _0x4259f1=_0x405f3c;let _0x2f8215=![];return devices[_0x24a345][_0x4259f1(0x77)]&&devices[_0x24a345][_0x4259f1(0x77)][_0x4259f1(0x1ce)]!='reject'&&(_0x2f8215=devices[_0x24a345]['telegramIpApproval']['clientip']==devices[_0x24a345]['ip']&&new Date()[_0x4259f1(0x125)]()-devices[_0x24a345][_0x4259f1(0x77)]['timestamp']<devices[_0x24a345][_0x4259f1(0x77)][_0x4259f1(0x1ce)]*0x3c*0x3e8),_0x2f8215;},telegram2FaApproved=_0x33746e=>{const _0x16b76a=_0x405f3c;let _0x19bf18=![];return devices[_0x33746e][_0x16b76a(0xb2)]&&devices[_0x33746e]['telegram2FaApproval'][_0x16b76a(0x1ce)]!=_0x16b76a(0x94)&&(_0x19bf18=devices[_0x33746e][_0x16b76a(0xb2)][_0x16b76a(0x22b)]==devices[_0x33746e]['ip']&&new Date()[_0x16b76a(0x125)]()-devices[_0x33746e][_0x16b76a(0xb2)][_0x16b76a(0xad)]<devices[_0x33746e][_0x16b76a(0xb2)]['expiry']*0x3c*0x3e8),_0x19bf18;},normalizeIP=_0x413bc6=>{const _0x3ea93a=_0x405f3c;let _0x449052=null,_0x7bdf9a=null;if(ipaddr[_0x3ea93a(0x92)](_0x413bc6)){const _0x53bc78=ipaddr['parse'](_0x413bc6);_0x53bc78[_0x3ea93a(0xdf)]()==='ipv6'?(_0x53bc78[_0x3ea93a(0x231)]()&&(_0x449052=_0x53bc78['toIPv4Address']()[_0x3ea93a(0x75)]()),_0x7bdf9a=_0x53bc78[_0x3ea93a(0x75)]()):(_0x449052=_0x53bc78[_0x3ea93a(0x75)](),_0x7bdf9a=_0x53bc78[_0x3ea93a(0x9f)]()[_0x3ea93a(0x75)]());}return{'show':_0x449052?_0x449052:_0x7bdf9a,'store':_0x7bdf9a};};function formatDate(_0xb39635){const _0x1fc85e=_0x405f3c;return _0xb39635[_0x1fc85e(0x96)]()+'/'+(_0xb39635[_0x1fc85e(0x1cf)]()+0x1)['toString']()[_0x1fc85e(0x6c)](0x2,'0')+'/'+_0xb39635[_0x1fc85e(0x1fa)]()['toString']()[_0x1fc85e(0x6c)](0x2,'0')+'\x20'+_0xb39635[_0x1fc85e(0xc3)]()['toString']()['padStart'](0x2,'0')+':'+_0xb39635['getMinutes']()[_0x1fc85e(0x75)]()[_0x1fc85e(0x6c)](0x2,'0')+':'+_0xb39635['getSeconds']()[_0x1fc85e(0x75)]()[_0x1fc85e(0x6c)](0x2,'0');}function sleep(_0x2c2e09){return new Promise(_0x1176d1=>setTimeout(_0x1176d1,_0x2c2e09));}