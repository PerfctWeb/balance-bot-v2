const _0x3df1ba=_0xf9ea;(function(_0x503817,_0x1fed12){const _0x232cec=_0xf9ea,_0x603af8=_0x503817();while(!![]){try{const _0x1f2e10=parseInt(_0x232cec(0x154))/0x1*(-parseInt(_0x232cec(0x137))/0x2)+-parseInt(_0x232cec(0x156))/0x3*(parseInt(_0x232cec(0x183))/0x4)+-parseInt(_0x232cec(0x14b))/0x5+-parseInt(_0x232cec(0x20b))/0x6*(parseInt(_0x232cec(0x197))/0x7)+-parseInt(_0x232cec(0x18b))/0x8+-parseInt(_0x232cec(0x25c))/0x9+-parseInt(_0x232cec(0x194))/0xa*(-parseInt(_0x232cec(0x210))/0xb);if(_0x1f2e10===_0x1fed12)break;else _0x603af8['push'](_0x603af8['shift']());}catch(_0x4e1b76){_0x603af8['push'](_0x603af8['shift']());}}}(_0x27ac,0x32e76));const _0x3ffc2b=function(){let _0x23e283=!![];return function(_0x41001e,_0x52bd36){const _0x49841b=_0x23e283?function(){const _0x50d24f=_0xf9ea;if(_0x52bd36){const _0x3bf282=_0x52bd36[_0x50d24f(0x1e4)](_0x41001e,arguments);return _0x52bd36=null,_0x3bf282;}}:function(){};return _0x23e283=![],_0x49841b;};}(),_0x25b937=_0x3ffc2b(this,function(){const _0x16aa0d=_0xf9ea;return _0x25b937[_0x16aa0d(0x20d)]()[_0x16aa0d(0x1b3)](_0x16aa0d(0x19f))[_0x16aa0d(0x20d)]()[_0x16aa0d(0x1b4)](_0x25b937)[_0x16aa0d(0x1b3)](_0x16aa0d(0x19f));});_0x25b937();'use strict';process[_0x3df1ba(0x172)][_0x3df1ba(0x13c)]=0x1;const childProcess=require(_0x3df1ba(0x184)),FileSync=require(_0x3df1ba(0x252)),fs=require('fs'),fns=require(_0x3df1ba(0x11d)),low=require(_0x3df1ba(0x163)),path=require('path'),crypto=require(_0x3df1ba(0x126)),Crypt=require(_0x3df1ba(0x23e))['Crypt'],RSA=require(_0x3df1ba(0x23e))[_0x3df1ba(0x1ed)],bcrypt=require(_0x3df1ba(0x1bf)),jwt=require('jsonwebtoken'),analyticsLib=require(_0x3df1ba(0x1a2))[_0x3df1ba(0x1ce)],googleAnalytics=require('@analytics/google-analytics')[_0x3df1ba(0x1ce)],ipaddr=require(_0x3df1ba(0x185)),argv=require(_0x3df1ba(0x1b7))(process[_0x3df1ba(0x261)][_0x3df1ba(0x19a)](0x2))[_0x3df1ba(0x261)],PORT=argv[_0x3df1ba(0x239)]||'3000',pattern=/^[0-9]{2,4}$/;if(!pattern[_0x3df1ba(0x23c)](PORT))return console[_0x3df1ba(0x138)](_0x3df1ba(0x1b8)+PORT+_0x3df1ba(0x24c)),process['exit'](0x1);function _0x27ac(){const _0xc7eed2=['Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Notifications\x20disabled','stopped','getHours','emitHistory','Token\x20blacklisted','pidRefreshToken',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','initclient','ipc','name','bb-config.json','existsSync','bots','telegramEvents','1162110zgqpnh','<b>Balance\x20Bot\x20status:</b>\x0a','toString','publicKey','\x20>\x20','154JiIEou','all','getSeconds','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','order','Balance\x20Bot','Password\x20reset\x20rejected','store-settings','isDirectory','encryptedUuid','show','getFullYear','handshake','live','catch','/status\x20-\x20show\x20bot(s)\x20status\x0a','listen','decrypt','/on\x20-\x20start\x20bot(s)\x0a','reason','get','onText','password','started','createServer','from','-results.json','restarting\x20Bot\x20','bot-','build2','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','30\x20min','sendFile','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','bbPassword','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','/help\x20-\x20show\x20available\x20commands\x0a',':\x20Bot\x20Mgr\x20>\x20','telegramEnabled','index.html','kill','port','build','answerCallbackQuery','test','whitelistEnabled','hybrid-crypto-js','Invalid\x20Telegram\x20token','sortBy','whitelist','once','temporary\x20token\x20generated','data','send','write','delete-bot','readdirSync','restart','getMonth','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots',',\x20must\x20be\x20a\x204\x20digit\x20number','type','Invalid\x20IP\x20address','entries','storeHeadless','Unauthorized\x20attempt\x20to\x20delete\x20bot','lowdb/adapters/FileSync','new','All\x20bots','No\x20bots\x20running\x20right\x20now','static','notification','You\x20can\x20use\x20the\x20following\x20commands:\x0a','invalid\x20credentials','login\x20required','place-order','1834974IhpGBU','store','telegramUsername','remoteAddress','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','argv','Ok,\x20will\x20send\x20alert\x20notifications\x20only','privateKey','callback_query','date-fns','************','Ok,\x20will\x20send\x20order\x20notifications\x20only','/:bot/portfolio','find','uuid','socket.io','SIGINT','toIPv4MappedAddress','crypto','map','temporary\x20access\x20timeout','removeAllListeners','version.json','connected','HTML','/:bot/configuration','UA-192771731-1','push','login\x20not\x20required','padStart','Unauthorized\x20login\x20attempt\x20(public\x20key)','Unauthorized\x20attempt\x20to\x20get\x20portfolio','username','secure','new-disabled','2zTQalv','log','getDate','logged\x20out','set','NTBA_FIX_319','inherit','host','</b>\x20?','success','Allow\x20login\x20from\x20IP\x20address\x20<b>','Login\x20rejected','2FA\x20login\x20required','filter','Temporary\x20access\x20rejected','value','-events.json','update-bb','User\x20has\x20been\x20validated','timeshift','1499680NXmSwP','settings','All','Unauthorized\x20attempt\x20to\x20store\x20configuration','/:bot/history','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','toIPv4Address','\x20minutes','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','242399ALBwAV','<b>Telegram\x20bot\x20status:</b>\x0a','6jsbZsu','Invalid\x20authentication\x20token\x20(1)','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','telegramIpApproval','accept','apiKey','page','hashSync','use','-config.json','config/','Invalid\x20authentication\x20token\x20(2)','bot.js','lowdb','bbUsername','match','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','5\x20min','/:bot/support','2FA\x20login\x20rejected','botID','kind','telegramChatId','keys','cloneDeep','telegramToken','idling\x20bot\x20\x20\x20|\x20Bot\x20','Login\x20accepted','env','\x20only\x0a','referer','Unauthorized\x20attempt\x20to\x20log\x20out','clientip','login\x20token\x20valid','/:bot/performance','add','15\x20min','copyFileSync','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','split','expiry','1000','\x20/\x20','-----------------------------------------------------------------------------------','length','172624FdRWwC','child_process','ipaddr.js','emit','randomBytes','/enable\x20-\x20enable\x20notifications\x0a','backup/','2FA\x20login\x20token\x20generated','1185488fMIGTr','includes','cancelLoading','/:bot/coins','\x20|\x20','stopPolling','login','bb-settings.json','compareSync','987790pjpLPB','Notifications\x20enabled','starting\x20new\x20bot\x20|\x20Bot\x20','7zcpVlh','SIGTERM','pidExpireLogin','slice','settings.','randomFillSync','event','botname','(((.+)+)+)+$','token','join','analytics','status','botmanager','hex','temporary\x20access\x20not\x20allowed','forEach','error','disabled','Notifications\x20types:\x20','reject','function','enabled','Unauthorized\x20attempt\x20to\x20add\x20bot','message','yes','isValid','Bot\x20','search','constructor','remove','-performance.json','yargs/yargs','Error:\x20Invalid\x20argument\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','reload','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','cancel-loading','getTime','telegram2FaApproval','bcryptjs','exit','removeListener','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','temporaryAccessAllowed','loginRequired','unlinkSync','secret','starting\x20bot\x20|\x20Bot\x20','http','sign','Invalid\x20username\x20or\x20IP\x20address','mkdirSync','allow','blacklist','default','bot','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','then','sendMessage','orders','deleted\x20Bot\x20','fork','access','polling_error','alerts','f2aRequired','chat','2FA','connection','placeOrder','disabled\x20Bot\x20','storeConfiguration','logout','store-headless','parse','hasOwnProperty','apply','getStartingBalances','Unauthorized\x20attempt\x20to\x20update\x20settings','timestamp','defaults','auth','/off\x20-\x20stop\x20bot(s)\x0a','error\x20while\x20deleting\x20config\x20files:\x20','get-logs','RSA','2FA\x20required','login\x20token\x20generated','telegram','express','exp','getMinutes','assign','Notifications\x20disabled\x0a','headers','No\x20authentication\x20token','::1','max','bb/','disconnect'];_0x27ac=function(){return _0xc7eed2;};return _0x27ac();}const HOST=argv[_0x3df1ba(0x13e)]||null,userID=argv['user']||'';let bbpath=_0x3df1ba(0x1fa),bbpath2='';const botfile=_0x3df1ba(0x162),configfile=_0x3df1ba(0x207),settingsfile=_0x3df1ba(0x192),securefile='bb-secure.json';!fs[_0x3df1ba(0x208)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x3df1ba(0x160)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x3df1ba(0x189);!fs[_0x3df1ba(0x208)](configpath)&&fs[_0x3df1ba(0x1cb)](configpath);!fs[_0x3df1ba(0x208)](configbackuppath)&&fs[_0x3df1ba(0x1cb)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x3df1ba(0x1e8)]({'bots':[]})[_0x3df1ba(0x246)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0}})[_0x3df1ba(0x246)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x3df1ba(0x1e8)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':'sha256','rsaStandard':'RSA-OAEP'});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x3df1ba(0x12a))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require(_0x3df1ba(0x1f1)),app=express(),http=require(_0x3df1ba(0x1c8))[_0x3df1ba(0x228)](app);app[_0x3df1ba(0x15e)](express[_0x3df1ba(0x256)](path[_0x3df1ba(0x1a1)](__dirname,bbpath2,_0x3df1ba(0x22d)))),app[_0x3df1ba(0x15e)](express['static'](path[_0x3df1ba(0x1a1)](__dirname,bbpath2,'build'))),app[_0x3df1ba(0x224)]('/',function(_0x241fbd,_0x107173){const _0x5bc2f5=_0x3df1ba;_0x107173['sendFile'](path[_0x5bc2f5(0x1a1)](__dirname,bbpath2,'build2',_0x5bc2f5(0x237)));}),app[_0x3df1ba(0x224)]('/:bot',function(_0x36b0d4,_0x1f3d5f){const _0x455b4b=_0x3df1ba;_0x1f3d5f[_0x455b4b(0x230)](path[_0x455b4b(0x1a1)](__dirname,bbpath2,_0x455b4b(0x23a),'index.html'));}),app[_0x3df1ba(0x224)](_0x3df1ba(0x120),(_0xf52c6d,_0x326205)=>{const _0x233e7b=_0x3df1ba;_0x326205['sendFile'](path['join'](__dirname,bbpath2,_0x233e7b(0x23a),_0x233e7b(0x237)));}),app[_0x3df1ba(0x224)](_0x3df1ba(0x178),(_0xdbe4a7,_0x57df43)=>{const _0x32ba29=_0x3df1ba;_0x57df43[_0x32ba29(0x230)](path[_0x32ba29(0x1a1)](__dirname,bbpath2,_0x32ba29(0x23a),_0x32ba29(0x237)));}),app[_0x3df1ba(0x224)](_0x3df1ba(0x18e),(_0x17e38d,_0x2214e6)=>{const _0x570331=_0x3df1ba;_0x2214e6[_0x570331(0x230)](path[_0x570331(0x1a1)](__dirname,bbpath2,_0x570331(0x23a),_0x570331(0x237)));}),app['get'](_0x3df1ba(0x14f),(_0x1417de,_0xe6cf2)=>{const _0x362724=_0x3df1ba;_0xe6cf2[_0x362724(0x230)](path['join'](__dirname,bbpath2,_0x362724(0x23a),_0x362724(0x237)));}),app[_0x3df1ba(0x224)](_0x3df1ba(0x12d),(_0x185810,_0x4134db)=>{const _0x1bd034=_0x3df1ba;_0x4134db[_0x1bd034(0x230)](path[_0x1bd034(0x1a1)](__dirname,bbpath2,_0x1bd034(0x23a),_0x1bd034(0x237)));}),app[_0x3df1ba(0x224)](_0x3df1ba(0x168),(_0x363ef6,_0x59692b)=>{const _0x38fdf9=_0x3df1ba;_0x59692b[_0x38fdf9(0x230)](path[_0x38fdf9(0x1a1)](__dirname,bbpath2,'build',_0x38fdf9(0x237)));});if(HOST)http[_0x3df1ba(0x220)](PORT,HOST);else http['listen'](PORT);const io=require(_0x3df1ba(0x123))(http,{}),analytics=analyticsLib({'app':_0x3df1ba(0x215),'plugins':[googleAnalytics({'trackingId':_0x3df1ba(0x12e)})]}),TelegramBot=require('node-telegram-bot-api');let tgBot;if(settings[_0x3df1ba(0x16f)]&&settings['telegramToken']!=''&&settings[_0x3df1ba(0x25e)]&&settings[_0x3df1ba(0x25e)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x519165=_0x3df1ba;console[_0x519165(0x138)](''),console[_0x519165(0x138)](_0x519165(0x181)),logging('Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:'+PORT),console[_0x519165(0x138)](_0x519165(0x181));if(config[_0x519165(0x182)]!=0x0)config[_0x519165(0x1a7)](_0x49d710=>{const _0x13f55c=_0x519165;if(_0x49d710['status']==_0x13f55c(0x1ad)||_0x49d710[_0x13f55c(0x1a3)]==_0x13f55c(0x253))logging(_0x13f55c(0x1c7)+_0x49d710['botID']+_0x13f55c(0x18f)+_0x49d710['botname']),startBot([_0x49d710['botID'],userID],{'cwd':bbpath},function(_0xcb1c7c){if(_0xcb1c7c)logging(_0xcb1c7c);});else(_0x49d710[_0x13f55c(0x1a3)]=='disabled'||_0x49d710[_0x13f55c(0x1a3)]==_0x13f55c(0x136))&&logging(_0x13f55c(0x170)+_0x49d710['botID']+_0x13f55c(0x18f)+_0x49d710[_0x13f55c(0x19e)]);});else!newBot&&console[_0x519165(0x138)](_0x519165(0x1c2));if(newBot)addBot();console[_0x519165(0x138)](_0x519165(0x181)),console[_0x519165(0x138)]('');}function startSocket(){const _0x45d49b=_0x3df1ba;io['on'](_0x45d49b(0x1dc),_0x1b7a61=>{const _0x543d6a=_0x45d49b;let _0x6fb4fa,_0x513aac,_0x158032,_0x2bc582,_0x4744c8;const _0x4510e3=_0x1b7a61[_0x543d6a(0x21c)][_0x543d6a(0x1f6)][_0x543d6a(0x174)];_0x513aac=_0x4510e3[_0x543d6a(0x165)](/bot[0-9]{3}/);if(_0x513aac)_0x158032=_0x513aac[0x0][_0x543d6a(0x165)](/[0-9]{3}/);if(_0x158032)_0x6fb4fa=_0x158032[0x0];else _0x6fb4fa=_0x543d6a(0x1a4);const _0x1a21da=_0x1b7a61['handshake'][_0x543d6a(0x1e9)][_0x543d6a(0x219)];if(!_0x1a21da)_0x1b7a61[_0x543d6a(0x186)](_0x543d6a(0x1a3),{'publicKey':secure[_0x543d6a(0x20e)]});else{_0x2bc582=timelyDecrypt(_0x1a21da,![]);if(!_0x2bc582)logging(_0x543d6a(0x132));else{_0x4744c8=normalizeIP(_0x1b7a61['conn'][_0x543d6a(0x25f)])[_0x543d6a(0x25d)];if(!devices[_0x2bc582])devices[_0x2bc582]={'uuid':_0x2bc582,'access':{'token':null}};devices[_0x2bc582]['ip']=_0x4744c8;const _0x45e678=addClient(_0x1b7a61['id'],_0x2bc582,_0x6fb4fa);setAccess(_0x45e678),_0x1b7a61['on'](_0x543d6a(0x191),_0x138708=>{const _0x461f72=_0x543d6a,_0x3db580=timelyDecrypt(_0x138708[_0x461f72(0x226)]);if(_0x3db580){_0x138708={'username':_0x138708[_0x461f72(0x134)],'password':_0x3db580},devices[_0x2bc582]['access']=validateCredentials(_0x138708,_0x2bc582);if(devices[_0x2bc582][_0x461f72(0x1d6)]['allow']==![]&&devices[_0x2bc582][_0x461f72(0x1d6)]['reason']==_0x461f72(0x143))_0x1b7a61[_0x461f72(0x186)](_0x461f72(0x1a3),{'access':devices[_0x2bc582][_0x461f72(0x1d6)]}),loginAccess2FA(_0x2bc582,_0x4744c8);else{if(devices[_0x2bc582][_0x461f72(0x1d6)]['allow']==![]&&devices[_0x2bc582][_0x461f72(0x1d6)][_0x461f72(0x223)]==_0x461f72(0x259))_0x1b7a61[_0x461f72(0x186)](_0x461f72(0x1a3),{'access':devices[_0x2bc582]['access']});else devices[_0x2bc582][_0x461f72(0x1d6)][_0x461f72(0x1cc)]&&devices[_0x2bc582][_0x461f72(0x1d6)][_0x461f72(0x223)]==_0x461f72(0x1ef)&&(getClientsWithUuid(_0x2bc582)[_0x461f72(0x1a7)](_0x48e741=>{setAccess(_0x48e741);}),setTokenRefresh(_0x2bc582),setSessionTimeout('login',_0x2bc582));}}else logging('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x1b7a61['on']('reset-password',()=>{resetPassword();}),_0x1b7a61['on'](_0x543d6a(0x1fb),_0x2e747b=>{removeClient(_0x1b7a61['id']);});}}});}function initClient(_0x49c0af){const _0x245833=_0x3df1ba;if(_0x49c0af!=_0x245833(0x1a4)&&config[_0x245833(0x15b)]!=''){if(pid[_0x49c0af])pid[_0x49c0af][_0x245833(0x245)]({'function':_0x245833(0x204),'args':null});}}function getSocket(_0x17fc7e){return io['sockets']['sockets']['get'](_0x17fc7e);}function setAccess(_0x9d16c8){const _0x3f1507=_0x3df1ba,_0x37daa8=getSocket(_0x9d16c8['id']),_0x41c35a=_0x9d16c8[_0x3f1507(0x122)],_0x554e49=_0x9d16c8['bot'];devices[_0x41c35a]['access']=validateAccess(devices[_0x41c35a][_0x3f1507(0x1d6)]['token'],_0x41c35a),_0x37daa8[_0x3f1507(0x1a1)](_0x41c35a);if(devices[_0x41c35a][_0x3f1507(0x1d6)][_0x3f1507(0x1cc)]){_0x37daa8[_0x3f1507(0x1a1)](_0x554e49);if(_0x554e49==_0x3f1507(0x1a4))initializeSocketBotManager(_0x37daa8);else initializeSocketBot(_0x37daa8);initClient(_0x554e49);}devices[_0x41c35a][_0x3f1507(0x1d6)][_0x3f1507(0x1a0)]&&devices[_0x41c35a][_0x3f1507(0x1d6)][_0x3f1507(0x223)]==_0x3f1507(0x243)&&setSessionTimeout(_0x3f1507(0x1db),_0x41c35a),devices[_0x41c35a][_0x3f1507(0x1d6)][_0x3f1507(0x1a0)]&&devices[_0x41c35a]['access'][_0x3f1507(0x223)]==_0x3f1507(0x18a)&&setSessionTimeout('login',_0x41c35a),_0x37daa8['emit'](_0x3f1507(0x1a3),{'status':_0x9d16c8['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x41c35a][_0x3f1507(0x1d6)],'externalip':devices[_0x41c35a]['ip'],'publicKey':secure[_0x3f1507(0x20e)]}),devices[_0x41c35a]['access'][_0x3f1507(0x1cc)]==![]&&devices[_0x41c35a]['access']['reason']=='2FA\x20required'&&temporaryAccess2FA(_0x41c35a,devices[_0x41c35a]['ip']);}function setSessionTimeout(_0x37fdca,_0x443135){const _0x2e8447=_0x3df1ba;let _0x75907a;if(_0x37fdca=='login')_0x75907a=loginExpiry*0x3c*0x3e8;else _0x75907a=devices[_0x443135][_0x2e8447(0x159)][_0x2e8447(0x17e)]*0x3c*0x3e8-(new Date()[_0x2e8447(0x1bd)]()-devices[_0x443135][_0x2e8447(0x159)][_0x2e8447(0x1e7)]);if(devices[_0x443135]['pidExpireLogin'])clearTimeout(devices[_0x443135][_0x2e8447(0x199)]);devices[_0x443135][_0x2e8447(0x199)]=setTimeout(()=>{const _0x372b54=_0x2e8447;if(devices[_0x443135][_0x372b54(0x202)])clearTimeout(devices[_0x443135][_0x372b54(0x202)]);removeSocketListeners(_0x443135),addBlacklist(_0x443135),devices[_0x443135][_0x372b54(0x159)]=null,devices[_0x443135]['telegram2FaApproval']=null,devices[_0x443135][_0x372b54(0x1d6)][_0x372b54(0x1a0)]=null,devices[_0x443135][_0x372b54(0x1d6)]=validateAccess(devices[_0x443135][_0x372b54(0x1d6)][_0x372b54(0x1a0)],_0x443135),!(devices[_0x443135][_0x372b54(0x1d6)][_0x372b54(0x1cc)]&&devices[_0x443135][_0x372b54(0x1d6)][_0x372b54(0x223)]==_0x372b54(0x130))&&(_0x37fdca==_0x372b54(0x191)?io['to'](_0x443135)['emit'](_0x372b54(0x1a3),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x443135)[_0x372b54(0x186)](_0x372b54(0x1a3),{'access':{'allow':![],'reason':_0x372b54(0x128),'token':null}})),devices[_0x443135][_0x372b54(0x1d6)][_0x372b54(0x1a0)]=null;},_0x75907a);}function setTokenRefresh(_0x42292e){const _0x5a9ed0=_0x3df1ba;if(devices[_0x42292e][_0x5a9ed0(0x202)])clearTimeout(devices[_0x42292e][_0x5a9ed0(0x202)]);devices[_0x42292e][_0x5a9ed0(0x202)]=setTimeout(()=>{const _0x253deb=_0x5a9ed0;getClientsWithUuid(_0x42292e)['length']!=0x0?(devices[_0x42292e][_0x253deb(0x1d6)]=refreshToken(_0x42292e),io['to'](_0x42292e)['emit'](_0x253deb(0x1a3),{'status':_0x253deb(0x12b),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x42292e]['access'],'externalip':devices[_0x42292e]['ip'],'publicKey':secure[_0x253deb(0x20e)]}),setTokenRefresh(_0x42292e)):clearTimeout(devices[_0x42292e][_0x253deb(0x202)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function _0xf9ea(_0x310ec9,_0x1d6109){const _0x362d21=_0x27ac();return _0xf9ea=function(_0x25b937,_0x3ffc2b){_0x25b937=_0x25b937-0x11a;let _0x27ac39=_0x362d21[_0x25b937];return _0x27ac39;},_0xf9ea(_0x310ec9,_0x1d6109);}function initializeSocketBotManager(_0x19b81b){const _0x468fd8=_0x3df1ba,_0x26aa21=getClient(_0x19b81b['id'])[_0x468fd8(0x122)];_0x19b81b[_0x468fd8(0x186)](_0x468fd8(0x209),config),_0x19b81b[_0x468fd8(0x186)](_0x468fd8(0x14c),cleanSettings()),_0x19b81b['on']('add-bot',_0x413bd1=>{const _0x2f4db4=_0x468fd8;if(validateAccess(_0x413bd1,_0x26aa21)[_0x2f4db4(0x1cc)])addBot();else logging(_0x2f4db4(0x1ae));}),_0x19b81b['on']('update-bot',(_0x40d462,_0x49a86b)=>{const _0x350a85=_0x468fd8;if(validateAccess(_0x49a86b,_0x26aa21)[_0x350a85(0x1cc)])toggleBot(_0x40d462[_0x350a85(0x16a)],_0x40d462['status'],_0x40d462['live']);else logging('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x19b81b['on'](_0x468fd8(0x247),(_0x52a42e,_0x7144a0)=>{const _0x5c9a0b=_0x468fd8;if(validateAccess(_0x7144a0,_0x26aa21)[_0x5c9a0b(0x1cc)])deleteBot(_0x52a42e);else logging(_0x5c9a0b(0x251));}),_0x19b81b['on'](_0x468fd8(0x217),(_0x2f3e68,_0x11a005)=>{const _0x4117c3=_0x468fd8;if(validateAccess(_0x11a005,_0x26aa21)[_0x4117c3(0x1cc)])storeSettings(_0x2f3e68,!![]);else logging(_0x4117c3(0x1e6));}),_0x19b81b['on'](_0x468fd8(0x148),(_0x1205f9,_0x4d5c75)=>{const _0x227bf5=_0x468fd8;if(validateAccess(_0x4d5c75,_0x26aa21)[_0x227bf5(0x1cc)])updateBB();else logging(_0x227bf5(0x1e6));}),_0x19b81b['on'](_0x468fd8(0x1e0),_0x19999c=>{const _0x498b3a=_0x468fd8;if(validateAccess(_0x19999c,_0x26aa21)['allow']){if(devices[_0x26aa21][_0x498b3a(0x202)])clearTimeout(devices[_0x26aa21]['pidRefreshToken']);if(devices[_0x26aa21][_0x498b3a(0x199)])clearTimeout(devices[_0x26aa21]['pidExpireLogin']);removeSocketListeners(getClient(_0x19b81b['id'])[_0x498b3a(0x122)]),addBlacklist(_0x26aa21),devices[_0x26aa21][_0x498b3a(0x159)]=null,devices[_0x26aa21]['telegram2FaApproval']=null,devices[_0x26aa21]['access'][_0x498b3a(0x1a0)]=null,io['to'](getClient(_0x19b81b['id'])[_0x498b3a(0x122)])[_0x498b3a(0x186)](_0x498b3a(0x1a3),{'access':{'allow':![],'reason':_0x498b3a(0x13a),'token':null}});}else logging(_0x498b3a(0x175));});}function initializeSocketBot(_0x29050d){const _0x1ce99f=_0x3df1ba,_0x3c5ff8=getClient(_0x29050d['id'])[_0x1ce99f(0x1cf)],_0x511f7e=getClient(_0x29050d['id'])[_0x1ce99f(0x122)];_0x29050d['on'](_0x1ce99f(0x1ec),(_0x3d522b,_0x38f757)=>{const _0x199135=_0x1ce99f;if(validateAccess(_0x38f757,_0x511f7e)['allow']){if(pid[_0x3c5ff8])pid[_0x3c5ff8][_0x199135(0x245)]({'function':_0x199135(0x200),'args':_0x3d522b});}else logging('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0x29050d['on']('get-portfolio',(_0x495b3e,_0x4af4cb)=>{const _0x22ba67=_0x1ce99f;if(validateAccess(_0x4af4cb,_0x511f7e)['allow']){if(pid[_0x3c5ff8])pid[_0x3c5ff8][_0x22ba67(0x245)]({'function':'getPortfolio','args':_0x495b3e});}else logging(_0x22ba67(0x133));}),_0x29050d['on']('store-configuration',(_0x6b1500,_0x5440e1)=>{const _0x423a71=_0x1ce99f;if(validateAccess(_0x5440e1,_0x511f7e)[_0x423a71(0x1cc)]){if(pid[_0x3c5ff8])pid[_0x3c5ff8]['send']({'function':_0x423a71(0x1df),'args':_0x6b1500});}else logging(_0x423a71(0x14e));}),_0x29050d['on'](_0x1ce99f(0x1e1),(_0x5bd302,_0x4a8814)=>{const _0x898187=_0x1ce99f;if(validateAccess(_0x4a8814,_0x511f7e)[_0x898187(0x1cc)]){if(pid[_0x3c5ff8])pid[_0x3c5ff8][_0x898187(0x245)]({'function':_0x898187(0x250),'args':_0x5bd302});}else logging('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x29050d['on']('get-starting-balances',_0x59af25=>{const _0x1940ac=_0x1ce99f;if(validateAccess(_0x59af25,_0x511f7e)[_0x1940ac(0x1cc)]){if(pid[_0x3c5ff8])pid[_0x3c5ff8][_0x1940ac(0x245)]({'function':_0x1940ac(0x1e5),'args':null});}else logging(_0x1940ac(0x260));}),_0x29050d['on'](_0x1ce99f(0x25b),(_0x3ef38c,_0x4db803)=>{const _0x5685e2=_0x1ce99f;if(validateAccess(_0x4db803,_0x511f7e)['allow']){if(pid[_0x3c5ff8])pid[_0x3c5ff8]['send']({'function':_0x5685e2(0x1dd),'args':_0x3ef38c});}else logging(_0x5685e2(0x1fc));}),_0x29050d['on'](_0x1ce99f(0x1bc),_0x199206=>{const _0x36265e=_0x1ce99f;if(validateAccess(_0x199206,_0x511f7e)[_0x36265e(0x1cc)]){if(pid[_0x3c5ff8])pid[_0x3c5ff8]['send']({'function':_0x36265e(0x18d),'args':null});}else logging(_0x36265e(0x17c));}),_0x29050d['on'](_0x1ce99f(0x1e0),_0x57c562=>{const _0x203bd3=_0x1ce99f;if(validateAccess(_0x57c562,_0x511f7e)[_0x203bd3(0x1cc)]){if(devices[_0x511f7e][_0x203bd3(0x202)])clearTimeout(devices[_0x511f7e][_0x203bd3(0x202)]);if(devices[_0x511f7e][_0x203bd3(0x199)])clearTimeout(devices[_0x511f7e][_0x203bd3(0x199)]);removeSocketListeners(getClient(_0x29050d['id'])[_0x203bd3(0x122)]),addBlacklist(_0x511f7e),devices[_0x511f7e][_0x203bd3(0x159)]=null,devices[_0x511f7e][_0x203bd3(0x1be)]=null,devices[_0x511f7e][_0x203bd3(0x1d6)][_0x203bd3(0x1a0)]=null,io['to'](getClient(_0x29050d['id'])[_0x203bd3(0x122)])[_0x203bd3(0x186)]('status',{'access':{'allow':![],'reason':_0x203bd3(0x13a),'token':null}});}else logging(_0x203bd3(0x175));});}function removeSocketListeners(_0x341965){getClientsWithUuid(_0x341965)['forEach'](_0x23a15c=>{const _0x568be0=_0xf9ea;getSocket(_0x23a15c['id'])[_0x568be0(0x129)]();});}function cleanSettings(){const _0x31cdcb=_0x3df1ba;let _0x448dd2=settings;return settings[_0x31cdcb(0x16f)]&&settings[_0x31cdcb(0x16f)]!=''&&(_0x448dd2={..._0x448dd2,'telegramToken':'************'}),settings[_0x31cdcb(0x232)]&&settings[_0x31cdcb(0x232)]!=''&&(_0x448dd2={..._0x448dd2,'bbPassword':'************'}),_0x448dd2;}function updateBB(){const _0x4d8d66=_0x3df1ba;config[_0x4d8d66(0x1a7)](_0x27779b=>{const _0x3b8b62=_0x4d8d66;stopBot(_0x27779b[_0x3b8b62(0x16a)]);}),process[_0x4d8d66(0x245)]({'update':!![]});}function startBot(_0x8b1d89,_0x1e5322,_0x44744d){const _0x2aef7a=_0x3df1ba;let _0x10e4da=![];const _0x4c1458=_0x8b1d89[0x0];_0x1e5322={..._0x1e5322,'stdio':[_0x2aef7a(0x13d),'inherit','inherit',_0x2aef7a(0x205)]},pid[_0x4c1458]=childProcess[_0x2aef7a(0x1d5)](botfile,_0x8b1d89,_0x1e5322),pid[_0x4c1458]['on'](_0x2aef7a(0x1af),_0x893442=>{const _0x275355=_0x2aef7a;switch(Object[_0x275355(0x16d)](_0x893442)[0x0]){case _0x275355(0x19e):updateBotName(_0x4c1458,_0x893442[_0x275355(0x19e)]);break;case'status':updateStatus(_0x4c1458,_0x893442[_0x275355(0x1a3)]);break;case'live':updateLive(_0x4c1458,_0x893442[_0x275355(0x21d)]);break;case _0x275355(0x227):updateLive(_0x4c1458,_0x893442[_0x275355(0x227)]),io['to'](_0x4c1458)[_0x275355(0x186)](_0x275355(0x1a3),{'access':{'allow':![],'reason':_0x275355(0x1ba),'token':null}});break;case'stop':_0x893442['stop']==_0x275355(0x249)&&stopBot(_0x4c1458);_0x893442['stop']==_0x275355(0x238)&&toggleBot(_0x4c1458,_0x275355(0x1a9),_0x275355(0x1fe));break;case _0x275355(0x1f0):sendTelegram(_0x4c1458,_0x893442[_0x275355(0x1f0)]);break;case _0x275355(0x1ac):io['to'](_0x4c1458)[_0x275355(0x186)](_0x893442['function'],_0x893442['args']);break;}}),pid[_0x4c1458]['on'](_0x2aef7a(0x1a8),function(_0x33d792){if(_0x10e4da)return;_0x10e4da=!![],_0x44744d(_0x33d792);}),pid[_0x4c1458]['on'](_0x2aef7a(0x1c0),function(_0x203f9c){const _0x47c11f=_0x2aef7a;if(_0x10e4da)return;_0x10e4da=!![],_0x44744d(null);const _0x3fdc1a=dbConfig['get'](_0x47c11f(0x209))[_0x47c11f(0x121)]({'botID':_0x4c1458})[_0x47c11f(0x146)]();_0x3fdc1a&&(_0x3fdc1a[_0x47c11f(0x1a3)]==_0x47c11f(0x1ad)||_0x3fdc1a[_0x47c11f(0x1a3)]==_0x47c11f(0x253))&&(updateLive(_0x4c1458,'stopped'),logging(_0x47c11f(0x22b)+_0x4c1458),startBot([_0x4c1458,userID],{'cwd':bbpath},function(_0x5a3556){if(_0x5a3556)logging(_0x5a3556);}));});}function stopBot(_0x5276a1){const _0x441cc3=_0x3df1ba;getClientsWithBotID(_0x5276a1)[_0x441cc3(0x1a7)](_0x247249=>{const _0x123376=_0x441cc3;getSocket(_0x247249['id'])[_0x123376(0x1fb)](!![]),removeClient(_0x247249['id']);});if(pid[_0x5276a1])pid[_0x5276a1][_0x441cc3(0x238)]();}function addBot(){const _0x55cb96=_0x3df1ba;let _0x62e54e;for(let _0x28d981=0x1;_0x28d981<0x3e9;_0x28d981++){_0x62e54e=_0x28d981[_0x55cb96(0x20d)]()[_0x55cb96(0x131)](0x3,'0');let _0x22f40b=config[_0x55cb96(0x121)](_0x4b3e88=>_0x4b3e88[_0x55cb96(0x16a)]==_0x62e54e);if(!_0x22f40b)break;}if(_0x62e54e===_0x55cb96(0x17f)){logging(_0x55cb96(0x22e));return;}logging(_0x55cb96(0x196)+_0x62e54e),dbConfig[_0x55cb96(0x224)](_0x55cb96(0x209))[_0x55cb96(0x12f)]({'botID':_0x62e54e,'botname':_0x55cb96(0x1b2)+_0x62e54e,'status':'new','live':''})[_0x55cb96(0x246)](),startBot([_0x62e54e,userID],{'cwd':bbpath},function(_0x3993ea){if(_0x3993ea)logging(_0x3993ea);}),config=getConfiguration(),io['to'](_0x55cb96(0x1a4))[_0x55cb96(0x186)](_0x55cb96(0x209),config);}function deleteBot(_0x105a35){const _0x488021=_0x3df1ba;getClientsWithBotID(_0x105a35)['forEach'](_0x5e1238=>{const _0x23b7ea=_0xf9ea;getSocket(_0x5e1238['id'])[_0x23b7ea(0x1fb)](!![]),removeClient(_0x5e1238['id']);}),dbConfig[_0x488021(0x224)](_0x488021(0x209))['remove']({'botID':_0x105a35})[_0x488021(0x246)](),logging(_0x488021(0x1d4)+_0x105a35),stopBot(_0x105a35);try{fs[_0x488021(0x1c5)](path[_0x488021(0x1a1)](configpath,_0x488021(0x22c)+_0x105a35+_0x488021(0x15f))),fs[_0x488021(0x1c5)](path['join'](configpath,_0x488021(0x22c)+_0x105a35+_0x488021(0x147))),fs[_0x488021(0x1c5)](path[_0x488021(0x1a1)](configpath,_0x488021(0x22c)+_0x105a35+_0x488021(0x1b6))),fs[_0x488021(0x1c5)](path['join'](configpath,_0x488021(0x22c)+_0x105a35+_0x488021(0x22a)));}catch(_0x5d3ac3){if(_0x5d3ac3)logging(_0x488021(0x1eb),_0x5d3ac3);}config=getConfiguration(),io['to'](_0x488021(0x1a4))['emit'](_0x488021(0x209),config);}function toggleBot(_0x21d9ee,_0x9844a1,_0x51c648){const _0x29746f=_0x3df1ba;dbConfig['get'](_0x29746f(0x209))[_0x29746f(0x121)]({'botID':_0x21d9ee})[_0x29746f(0x1f4)]({'status':_0x9844a1})['assign']({'live':_0x51c648})[_0x29746f(0x246)]();if(_0x9844a1==_0x29746f(0x1ad)||_0x9844a1==_0x29746f(0x253))logging('enabled\x20Bot\x20'+_0x21d9ee),startBot([_0x21d9ee,userID],{'cwd':bbpath},function(_0x5697ad){if(_0x5697ad)logging(_0x5697ad);});else(_0x9844a1==_0x29746f(0x1a9)||_0x9844a1==_0x29746f(0x136))&&(logging(_0x29746f(0x1de)+_0x21d9ee),stopBot(_0x21d9ee));config=getConfiguration(),io['to'](_0x29746f(0x1a4))[_0x29746f(0x186)]('bots',config);}function toggleStatus(_0x5bb998){const _0x57a8d3=_0x3df1ba;let _0x2b1c42=dbConfig[_0x57a8d3(0x224)](_0x57a8d3(0x209))[_0x57a8d3(0x121)]({'botID':_0x5bb998})[_0x57a8d3(0x146)](),_0x31ab26;if(_0x2b1c42['status']===_0x57a8d3(0x1ad))_0x31ab26=_0x57a8d3(0x1a9);else{if(_0x2b1c42[_0x57a8d3(0x1a3)]===_0x57a8d3(0x253))_0x31ab26=_0x57a8d3(0x136);else{if(_0x2b1c42[_0x57a8d3(0x1a3)]===_0x57a8d3(0x136))_0x31ab26=_0x57a8d3(0x253);else{if(_0x2b1c42['status']===_0x57a8d3(0x1a9))_0x31ab26='enabled';}}}return _0x31ab26;}function updateStatus(_0x27b92b,_0x5bc303){const _0x1e16c3=_0x3df1ba;dbConfig[_0x1e16c3(0x224)](_0x1e16c3(0x209))[_0x1e16c3(0x121)]({'botID':_0x27b92b})[_0x1e16c3(0x1f4)]({'status':_0x5bc303})[_0x1e16c3(0x246)](),config=getConfiguration(),io['to'](_0x1e16c3(0x1a4))[_0x1e16c3(0x186)](_0x1e16c3(0x209),config);}function updateLive(_0x16dd23,_0x99259a){const _0x5b80d0=_0x3df1ba;dbConfig[_0x5b80d0(0x224)](_0x5b80d0(0x209))[_0x5b80d0(0x121)]({'botID':_0x16dd23})['assign']({'live':_0x99259a})[_0x5b80d0(0x246)](),config=getConfiguration(),io['to']('botmanager')[_0x5b80d0(0x186)]('bots',config);}function updateBotName(_0x4e236d,_0x11b73c){const _0x3673ab=_0x3df1ba;dbConfig[_0x3673ab(0x224)](_0x3673ab(0x209))[_0x3673ab(0x121)]({'botID':_0x4e236d})[_0x3673ab(0x1f4)]({'botname':_0x11b73c})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x3673ab(0x186)](_0x3673ab(0x209),config);}function telegramError(_0x394a0f){const _0x2c81cf=_0x3df1ba;console[_0x2c81cf(0x138)](getTimeStamp()+_0x2c81cf(0x203));}function validateTelegram(_0x4985db){const _0x1626be=_0x3df1ba;if(_0x4985db['from'][_0x1626be(0x134)]!=settings[_0x1626be(0x25e)]&&'@'+_0x4985db[_0x1626be(0x229)]['username']!=settings[_0x1626be(0x25e)])return tgBot[_0x1626be(0x1d2)](_0x4985db['chat']['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x1626be(0x12c)})[_0x1626be(0x21e)](_0x33f590=>{telegramError(_0x33f590);}),![];return!![];}async function initTelegram(){const _0x295b5b=_0x3df1ba;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x295b5b(0x16f)],{'polling':!![]});let _0x42ace3=_0x295b5b(0x258);_0x42ace3+='\x0a',_0x42ace3+=_0x295b5b(0x188),_0x42ace3+='/disable\x20-\x20disable\x20notifications\x0a',_0x42ace3+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x42ace3+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x42ace3+=_0x295b5b(0x222),_0x42ace3+=_0x295b5b(0x1ea),_0x42ace3+=_0x295b5b(0x21f),_0x42ace3+=_0x295b5b(0x234);let _0x4803cb=_0x295b5b(0x233);_0x4803cb+='\x0a',_0x4803cb+=_0x42ace3,tgBot[_0x295b5b(0x225)](/\/start/,_0x259e6b=>{const _0x1b083d=_0x295b5b;if(!validateTelegram(_0x259e6b))return;if(settings[_0x1b083d(0x16c)]!=_0x259e6b[_0x1b083d(0x1da)]['id'])updateSetting(_0x1b083d(0x16c),_0x259e6b[_0x1b083d(0x1da)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x1b083d(0x1d2)](_0x259e6b[_0x1b083d(0x1da)]['id'],_0x4803cb)['catch'](_0x183a15=>{telegramError(_0x183a15);});}),tgBot[_0x295b5b(0x225)](/\/enable/,_0x144dea=>{const _0x3324ce=_0x295b5b;if(!validateTelegram(_0x144dea))return;if(settings[_0x3324ce(0x16c)]!=_0x144dea[_0x3324ce(0x1da)]['id'])updateSetting(_0x3324ce(0x16c),_0x144dea[_0x3324ce(0x1da)]['id']);updateSetting(_0x3324ce(0x236),!![]),tgBot['sendMessage'](_0x144dea['chat']['id'],_0x3324ce(0x195))['catch'](_0x407dc1=>{telegramError(_0x407dc1);});}),tgBot[_0x295b5b(0x225)](/\/config/,async _0x140cbb=>{const _0x10ce92=_0x295b5b;if(!validateTelegram(_0x140cbb))return;tgBot[_0x10ce92(0x1c1)]('callback_query'),tgBot[_0x10ce92(0x1d2)](_0x140cbb['chat']['id'],_0x10ce92(0x158),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x10ce92(0x1d3)},{'text':'Alerts','callback_data':_0x10ce92(0x1d8)},{'text':_0x10ce92(0x14d),'callback_data':_0x10ce92(0x211)}]]}})[_0x10ce92(0x21e)](_0x2b9571=>{telegramError(_0x2b9571);}),tgBot['on'](_0x10ce92(0x11c),async _0x497e74=>{const _0x8aa468=_0x10ce92,_0xc6956a=_0x497e74['data'],_0x1a48a3=_0x497e74[_0x8aa468(0x1af)];tgBot[_0x8aa468(0x23b)](_0x497e74['id'])[_0x8aa468(0x1d1)](async()=>{const _0x22c61b=_0x8aa468;_0xc6956a==_0x22c61b(0x1d3)&&(updateSetting(_0x22c61b(0x20a),_0x22c61b(0x1d3)),updateSetting(_0x22c61b(0x236),!![]),await tgBot['sendMessage'](_0x1a48a3['chat']['id'],_0x22c61b(0x11f))['catch'](_0x5aba56=>{telegramError(_0x5aba56);}));_0xc6956a==_0x22c61b(0x1d8)&&(updateSetting(_0x22c61b(0x20a),_0x22c61b(0x1d8)),updateSetting(_0x22c61b(0x236),!![]),await tgBot[_0x22c61b(0x1d2)](_0x1a48a3[_0x22c61b(0x1da)]['id'],_0x22c61b(0x11a))[_0x22c61b(0x21e)](_0x23c1b2=>{telegramError(_0x23c1b2);}));_0xc6956a==_0x22c61b(0x211)&&(updateSetting(_0x22c61b(0x20a),_0x22c61b(0x211)),updateSetting(_0x22c61b(0x236),!![]),await tgBot['sendMessage'](_0x1a48a3['chat']['id'],_0x22c61b(0x231))[_0x22c61b(0x21e)](_0x360e24=>{telegramError(_0x360e24);}));if(!settings[_0x22c61b(0x16c)])tgBot['sendMessage'](_0x1a48a3[_0x22c61b(0x1da)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x22c61b(0x21e)](_0x5cb5f0=>{telegramError(_0x5cb5f0);});}),tgBot[_0x8aa468(0x1c1)](_0x8aa468(0x11c));});}),tgBot[_0x295b5b(0x225)](/\/status/,_0x59da9d=>{const _0x2a10a6=_0x295b5b;if(!validateTelegram(_0x59da9d))return;let _0x3f7039=_0x2a10a6(0x20c);config[_0x2a10a6(0x1a7)](_0x304ecf=>{const _0x258a26=_0x2a10a6;_0x3f7039+='Bot\x20'+_0x304ecf['botID']+'\x20|\x20'+_0x304ecf[_0x258a26(0x19e)]+':\x20'+_0x304ecf[_0x258a26(0x1a3)]+_0x258a26(0x180)+_0x304ecf['live']+'\x0a';}),_0x3f7039+='\x0a',_0x3f7039+=_0x2a10a6(0x155),_0x3f7039+=!settings[_0x2a10a6(0x236)]?_0x2a10a6(0x1f5):'Notifications\x20enabled\x0a',_0x3f7039+=settings[_0x2a10a6(0x236)]?settings[_0x2a10a6(0x20a)]=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x2a10a6(0x1aa)+settings[_0x2a10a6(0x20a)]+_0x2a10a6(0x173):'',tgBot[_0x2a10a6(0x1d2)](_0x59da9d['chat']['id'],_0x3f7039,{'parse_mode':_0x2a10a6(0x12c)})['catch'](_0x5d5b62=>{telegramError(_0x5d5b62);});}),tgBot[_0x295b5b(0x225)](/\/restart/,_0x3222bc=>{const _0x1b9e7f=_0x295b5b;if(!validateTelegram(_0x3222bc))return;tgBot[_0x1b9e7f(0x1c1)](_0x1b9e7f(0x11c));const _0x4fc699=getEnabledBots();if(_0x4fc699[_0x1b9e7f(0x182)]==0x0)tgBot[_0x1b9e7f(0x1d2)](_0x3222bc['chat']['id'],_0x1b9e7f(0x255))[_0x1b9e7f(0x21e)](_0x31074d=>{telegramError(_0x31074d);});else{if(_0x4fc699['length']>0x1)_0x4fc699[_0x1b9e7f(0x12f)]({'botID':'all'});let _0x5aa1fc=[],_0x499023=[];const _0x2c8a39=_0x4fc699[_0x1b9e7f(0x182)]%0x4==0x0||_0x4fc699[_0x1b9e7f(0x182)]%0x4==0x3||_0x4fc699[_0x1b9e7f(0x182)]%0x3==0x1?0x4:0x3;let _0x126331=0x0;_0x4fc699[_0x1b9e7f(0x1a7)]((_0x145d76,_0x419caa)=>{const _0x3bd63a=_0x1b9e7f;if(_0x419caa%_0x2c8a39==0x0)_0x499023=[];_0x499023[_0x3bd63a(0x12f)]({'text':_0x145d76[_0x3bd63a(0x16a)]==_0x3bd63a(0x211)?_0x3bd63a(0x254):_0x3bd63a(0x1b2)+_0x145d76[_0x3bd63a(0x16a)],'callback_data':_0x145d76[_0x3bd63a(0x16a)]}),_0x419caa%_0x2c8a39==0x0&&(_0x5aa1fc[_0x126331]=_0x499023,_0x126331++);}),tgBot[_0x1b9e7f(0x1d2)](_0x3222bc[_0x1b9e7f(0x1da)]['id'],_0x1b9e7f(0x1b9),{'reply_markup':{'inline_keyboard':_0x5aa1fc}})['catch'](_0x9e0884=>{telegramError(_0x9e0884);}),tgBot['on'](_0x1b9e7f(0x11c),async _0x486736=>{const _0x2d4a66=_0x1b9e7f,_0x51b1a2=_0x486736['data'],_0xb5d240=_0x486736[_0x2d4a66(0x1af)];tgBot['answerCallbackQuery'](_0x486736['id'])[_0x2d4a66(0x1d1)](async()=>{const _0xd9cb78=_0x2d4a66;if(_0x51b1a2==_0xd9cb78(0x211)){if(settings[_0xd9cb78(0x20a)]=='orders')tgBot[_0xd9cb78(0x1d2)](_0xb5d240[_0xd9cb78(0x1da)]['id'],_0xd9cb78(0x24b))[_0xd9cb78(0x21e)](_0x471b59=>{telegramError(_0x471b59);});config['forEach'](_0x4eb479=>{const _0x187170=_0xd9cb78;stopBot(_0x4eb479[_0x187170(0x16a)]);});}else{if(settings[_0xd9cb78(0x20a)]==_0xd9cb78(0x1d3))tgBot[_0xd9cb78(0x1d2)](_0xb5d240[_0xd9cb78(0x1da)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20Bot\x20'+_0x51b1a2)[_0xd9cb78(0x21e)](_0xb4a66c=>{telegramError(_0xb4a66c);});stopBot(_0x51b1a2);}}),tgBot[_0x2d4a66(0x1c1)](_0x2d4a66(0x11c));});}}),tgBot[_0x295b5b(0x225)](/\/on/,_0x52f3a6=>{const _0x1bf20b=_0x295b5b;if(!validateTelegram(_0x52f3a6))return;tgBot['removeListener'](_0x1bf20b(0x11c));const _0x3dbfb9=getDisabledBots();if(_0x3dbfb9[_0x1bf20b(0x182)]==0x0)tgBot['sendMessage'](_0x52f3a6[_0x1bf20b(0x1da)]['id'],'All\x20bots\x20running\x20right\x20now')['catch'](_0x2f7fe6=>{telegramError(_0x2f7fe6);});else{if(_0x3dbfb9[_0x1bf20b(0x182)]>0x1)_0x3dbfb9[_0x1bf20b(0x12f)]({'botID':_0x1bf20b(0x211)});let _0x35d5d4=[],_0x3d5e01=[];const _0x59608f=_0x3dbfb9[_0x1bf20b(0x182)]%0x4==0x0||_0x3dbfb9['length']%0x4==0x3||_0x3dbfb9[_0x1bf20b(0x182)]%0x3==0x1?0x4:0x3;let _0x4e067f=0x0;_0x3dbfb9[_0x1bf20b(0x1a7)]((_0x43fe74,_0x4ed1f9)=>{const _0xc605b=_0x1bf20b;if(_0x4ed1f9%_0x59608f==0x0)_0x3d5e01=[];_0x3d5e01[_0xc605b(0x12f)]({'text':_0x43fe74['botID']==_0xc605b(0x211)?_0xc605b(0x254):_0xc605b(0x1b2)+_0x43fe74[_0xc605b(0x16a)],'callback_data':_0x43fe74[_0xc605b(0x16a)]}),_0x4ed1f9%_0x59608f==0x0&&(_0x35d5d4[_0x4e067f]=_0x3d5e01,_0x4e067f++);}),tgBot['sendMessage'](_0x52f3a6[_0x1bf20b(0x1da)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x35d5d4}})[_0x1bf20b(0x21e)](_0x4bb481=>{telegramError(_0x4bb481);}),tgBot['on'](_0x1bf20b(0x11c),async _0x4fa5d7=>{const _0x5d0084=_0x1bf20b,_0x217e0a=_0x4fa5d7[_0x5d0084(0x244)],_0x2ab908=_0x4fa5d7['message'];tgBot[_0x5d0084(0x23b)](_0x4fa5d7['id'])[_0x5d0084(0x1d1)](async()=>{const _0x45889e=_0x5d0084;if(_0x217e0a==_0x45889e(0x211)){if(settings[_0x45889e(0x20a)]==_0x45889e(0x1d3))tgBot['sendMessage'](_0x2ab908[_0x45889e(0x1da)]['id'],_0x45889e(0x153))['catch'](_0x1f9410=>{telegramError(_0x1f9410);});_0x3dbfb9[_0x45889e(0x1a7)](_0x233830=>{const _0x38c94b=_0x45889e;if(_0x233830['botID']!='all')toggleBot(_0x233830['botID'],toggleStatus(_0x233830[_0x38c94b(0x16a)]),_0x38c94b(0x1fe));});}else{if(settings[_0x45889e(0x20a)]==_0x45889e(0x1d3))tgBot[_0x45889e(0x1d2)](_0x2ab908[_0x45889e(0x1da)]['id'],_0x45889e(0x1d0)+_0x217e0a)[_0x45889e(0x21e)](_0x56a0f7=>{telegramError(_0x56a0f7);});toggleBot(_0x217e0a,toggleStatus(_0x217e0a),_0x45889e(0x1fe));}}),tgBot['removeListener']('callback_query');});}}),tgBot[_0x295b5b(0x225)](/\/off/,_0x10bd59=>{const _0x17c200=_0x295b5b;if(!validateTelegram(_0x10bd59))return;tgBot[_0x17c200(0x1c1)](_0x17c200(0x11c));const _0x3a2f33=getEnabledBots();if(_0x3a2f33[_0x17c200(0x182)]==0x0)tgBot[_0x17c200(0x1d2)](_0x10bd59['chat']['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x3232b7=>{telegramError(_0x3232b7);});else{if(_0x3a2f33[_0x17c200(0x182)]>0x1)_0x3a2f33['push']({'botID':_0x17c200(0x211)});let _0x2bd29e=[],_0xa7bc27=[];const _0x5c7806=_0x3a2f33['length']%0x4==0x0||_0x3a2f33[_0x17c200(0x182)]%0x4==0x3||_0x3a2f33[_0x17c200(0x182)]%0x3==0x1?0x4:0x3;let _0x209324=0x0;_0x3a2f33[_0x17c200(0x1a7)]((_0x2775b7,_0x46b045)=>{const _0x5924fa=_0x17c200;if(_0x46b045%_0x5c7806==0x0)_0xa7bc27=[];_0xa7bc27[_0x5924fa(0x12f)]({'text':_0x2775b7['botID']==_0x5924fa(0x211)?_0x5924fa(0x254):'Bot\x20'+_0x2775b7['botID'],'callback_data':_0x2775b7[_0x5924fa(0x16a)]}),_0x46b045%_0x5c7806==0x0&&(_0x2bd29e[_0x209324]=_0xa7bc27,_0x209324++);}),tgBot['sendMessage'](_0x10bd59['chat']['id'],_0x17c200(0x213),{'reply_markup':{'inline_keyboard':_0x2bd29e}})[_0x17c200(0x21e)](_0x20d2b0=>{telegramError(_0x20d2b0);}),tgBot['on'](_0x17c200(0x11c),async _0x30659b=>{const _0x2b190f=_0x17c200,_0x53fa37=_0x30659b[_0x2b190f(0x244)],_0x3fd29a=_0x30659b[_0x2b190f(0x1af)];tgBot[_0x2b190f(0x23b)](_0x30659b['id'])['then'](async()=>{const _0x5d5b49=_0x2b190f;if(_0x53fa37==_0x5d5b49(0x211)){if(settings[_0x5d5b49(0x20a)]=='orders')tgBot[_0x5d5b49(0x1d2)](_0x3fd29a[_0x5d5b49(0x1da)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')['catch'](_0xb9cbbe=>{telegramError(_0xb9cbbe);});_0x3a2f33[_0x5d5b49(0x1a7)](_0x2799a1=>{const _0x12e17d=_0x5d5b49;if(_0x2799a1['botID']!=_0x12e17d(0x211))toggleBot(_0x2799a1[_0x12e17d(0x16a)],toggleStatus(_0x2799a1[_0x12e17d(0x16a)]),_0x12e17d(0x1fe));});}else{if(settings[_0x5d5b49(0x20a)]==_0x5d5b49(0x1d3))tgBot[_0x5d5b49(0x1d2)](_0x3fd29a['chat']['id'],_0x5d5b49(0x150)+_0x53fa37)[_0x5d5b49(0x21e)](_0x53d999=>{telegramError(_0x53d999);});toggleBot(_0x53fa37,toggleStatus(_0x53fa37),_0x5d5b49(0x1fe));}}),tgBot[_0x2b190f(0x1c1)]('callback_query');});}}),tgBot[_0x295b5b(0x225)](/\/disable/,_0x56e302=>{const _0x379561=_0x295b5b;if(!validateTelegram(_0x56e302))return;tgBot['sendMessage'](_0x56e302[_0x379561(0x1da)]['id'],_0x379561(0x1fd))[_0x379561(0x21e)](_0x1c683b=>{telegramError(_0x1c683b);}),updateSetting(_0x379561(0x236),![]);}),tgBot['onText'](/\/help/,_0x15f6a5=>{const _0x3dabaf=_0x295b5b;if(!validateTelegram(_0x15f6a5))return;tgBot[_0x3dabaf(0x1d2)](_0x15f6a5['chat']['id'],_0x42ace3)[_0x3dabaf(0x21e)](_0x4208b0=>{telegramError(_0x4208b0);});}),tgBot['on'](_0x295b5b(0x1d7),_0x38cbaf=>{const _0x23e0d1=_0x295b5b;_0x38cbaf['toString']()[_0x23e0d1(0x18c)]('404\x20Not\x20Found')&&(logging(_0x23e0d1(0x23f)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x23e0d1(0x1a4))['emit'](_0x23e0d1(0x257),'Invalid\x20Telegram\x20token'));}),process['once'](_0x295b5b(0x124),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);}),process[_0x295b5b(0x242)](_0x295b5b(0x198),()=>{const _0xc23a87=_0x295b5b;if(tgBot)tgBot[_0xc23a87(0x190)]();process[_0xc23a87(0x1c0)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x2eaf8d,_0x162b93){const _0x41e658=_0x3df1ba;if(settings['telegramEnabled']){if(settings[_0x41e658(0x20a)]==_0x41e658(0x211)||(_0x162b93[_0x41e658(0x24d)]=='error'||_0x162b93['type']==_0x41e658(0x140))&&settings['telegramEvents']==_0x41e658(0x1d8)||_0x162b93[_0x41e658(0x24d)]==_0x41e658(0x214)&&settings[_0x41e658(0x20a)]==_0x41e658(0x1d3)){if(tgBot&&settings[_0x41e658(0x16c)]){if(_0x162b93['showname'])tgBot[_0x41e658(0x1d2)](settings['telegramChatId'],_0x162b93[_0x41e658(0x19e)]+_0x41e658(0x20f)+_0x162b93[_0x41e658(0x19d)])[_0x41e658(0x21e)](_0x5d4b1e=>{telegramError(_0x5d4b1e);});else tgBot[_0x41e658(0x1d2)](settings[_0x41e658(0x16c)],_0x41e658(0x1b2)+_0x2eaf8d+_0x41e658(0x20f)+_0x162b93[_0x41e658(0x19d)])['catch'](_0x14a03e=>{telegramError(_0x14a03e);});}}}}function getDeviceWithIp(_0x552eca){const _0x2a0c99=_0x3df1ba;return devices[_0x2a0c99(0x121)](_0x428d6f=>_0x428d6f['ip']===_0x552eca);}function temporaryAccess2FA(_0x4225ab,_0x45ddc4){const _0x1d4e58=_0x3df1ba;let _0x32e19b=new Date(),_0x320492=![];if(lastIpApproval){if(_0x32e19b-lastIpApproval<0x1388)_0x320492=!![];}lastIpApproval=new Date();if(_0x320492)return;tgBot&&settings[_0x1d4e58(0x16c)]&&(tgBot[_0x1d4e58(0x1c1)](_0x1d4e58(0x11c)),tgBot['sendMessage'](settings[_0x1d4e58(0x16c)],_0x1d4e58(0x1bb)+normalizeIP(_0x45ddc4)['show']+_0x1d4e58(0x13f),{'parse_mode':_0x1d4e58(0x12c),'reply_markup':{'inline_keyboard':[[{'text':_0x1d4e58(0x167),'callback_data':'5'},{'text':_0x1d4e58(0x17a),'callback_data':'15'},{'text':_0x1d4e58(0x22f),'callback_data':'30'},{'text':'reject','callback_data':_0x1d4e58(0x1ab)}]]}})[_0x1d4e58(0x21e)](_0x3bf6a6=>{telegramError(_0x3bf6a6);}),tgBot['on'](_0x1d4e58(0x11c),async _0x13562e=>{const _0x28fbb0=_0x1d4e58,_0x525365=_0x13562e[_0x28fbb0(0x244)],_0x5eba6e=_0x13562e[_0x28fbb0(0x1af)];tgBot[_0x28fbb0(0x23b)](_0x13562e['id'])[_0x28fbb0(0x1d1)](async()=>{const _0x15052d=_0x28fbb0;devices[_0x4225ab][_0x15052d(0x159)]={'clientip':_0x45ddc4,'timestamp':new Date()[_0x15052d(0x1bd)](),'expiry':_0x525365},_0x525365!=_0x15052d(0x1ab)?(await tgBot[_0x15052d(0x1d2)](_0x5eba6e[_0x15052d(0x1da)]['id'],'Access\x20enabled\x20for\x20'+_0x525365+_0x15052d(0x152),{'parse_mode':_0x15052d(0x12c)})[_0x15052d(0x21e)](_0x456141=>{telegramError(_0x456141);}),io['to'](_0x4225ab)['emit'](_0x15052d(0x1a3),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x15052d(0x1d2)](_0x5eba6e[_0x15052d(0x1da)]['id'],_0x15052d(0x145))[_0x15052d(0x21e)](_0x49e153=>{telegramError(_0x49e153);}),io['to'](_0x4225ab)[_0x15052d(0x186)](_0x15052d(0x1a3),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot['removeListener'](_0x28fbb0(0x11c));}));}function loginAccess2FA(_0x5c92d2,_0x186fe0){const _0x3cff28=_0x3df1ba;tgBot&&settings['telegramChatId']&&(tgBot['removeListener']('callback_query'),tgBot['sendMessage'](settings[_0x3cff28(0x16c)],_0x3cff28(0x141)+normalizeIP(_0x186fe0)[_0x3cff28(0x21a)]+_0x3cff28(0x13f),{'parse_mode':_0x3cff28(0x12c),'reply_markup':{'inline_keyboard':[[{'text':_0x3cff28(0x15a),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x3cff28(0x1ab)}]]}})[_0x3cff28(0x21e)](_0x15c021=>{telegramError(_0x15c021);}),tgBot['on'](_0x3cff28(0x11c),async _0xbb1133=>{const _0x194e9e=_0x3cff28,_0x152804=_0xbb1133[_0x194e9e(0x244)],_0x24ecd8=_0xbb1133['message'];tgBot[_0x194e9e(0x23b)](_0xbb1133['id'])[_0x194e9e(0x1d1)](async()=>{const _0x1e0359=_0x194e9e;devices[_0x5c92d2][_0x1e0359(0x1be)]={'clientip':_0x186fe0,'timestamp':new Date()[_0x1e0359(0x1bd)](),'expiry':_0x152804},_0x152804!=_0x1e0359(0x1ab)?(await tgBot[_0x1e0359(0x1d2)](_0x24ecd8[_0x1e0359(0x1da)]['id'],_0x1e0359(0x171),{'parse_mode':'HTML'})[_0x1e0359(0x21e)](_0x59c73e=>{telegramError(_0x59c73e);}),io['to'](_0x5c92d2)[_0x1e0359(0x186)](_0x1e0359(0x1a3),{'access':{'allow':![],'reason':_0x1e0359(0x1ba),'token':null}})):(await tgBot[_0x1e0359(0x1d2)](_0x24ecd8[_0x1e0359(0x1da)]['id'],_0x1e0359(0x142))[_0x1e0359(0x21e)](_0x23c247=>{telegramError(_0x23c247);}),io['to'](_0x5c92d2)['emit'](_0x1e0359(0x1a3),{'access':{'allow':![],'reason':_0x1e0359(0x169),'token':null}}));}),tgBot[_0x194e9e(0x1c1)](_0x194e9e(0x11c));}));}function getConfiguration(){const _0x4b3aa1=_0x3df1ba;return dbConfig[_0x4b3aa1(0x224)](_0x4b3aa1(0x209))['sortBy'](_0x4b3aa1(0x16a))[_0x4b3aa1(0x146)]()||[];}function getEnabledBots(){const _0x117cf=_0x3df1ba;return dbConfig[_0x117cf(0x224)](_0x117cf(0x209))[_0x117cf(0x240)](_0x117cf(0x16a))[_0x117cf(0x144)]({'status':_0x117cf(0x1ad)})['value']()||[];}function getDisabledBots(){const _0x144dd0=_0x3df1ba;return dbConfig[_0x144dd0(0x224)](_0x144dd0(0x209))[_0x144dd0(0x240)](_0x144dd0(0x16a))[_0x144dd0(0x144)]({'status':_0x144dd0(0x1a9)})[_0x144dd0(0x146)]()||[];}function getSettings(){const _0x3b3905=_0x3df1ba;return dbSettings[_0x3b3905(0x224)](_0x3b3905(0x14c))[_0x3b3905(0x146)]()||{'timeshift':0x0};}function getSecure(){const _0x57f457=_0x3df1ba;return dbSecure[_0x57f457(0x224)](_0x57f457(0x135))[_0x57f457(0x146)]()||{};}function getBlacklist(){const _0x5664a8=_0x3df1ba;return dbSecure[_0x5664a8(0x224)](_0x5664a8(0x1cd))[_0x5664a8(0x146)]()||[];}function broadcastToBots(_0x49fbbd,_0x552cb9){config['forEach'](_0x3c6575=>{const _0x4599e8=_0xf9ea;if(_0x3c6575['status']==_0x4599e8(0x1ad)&&_0x3c6575[_0x4599e8(0x21d)]=='running'){if(pid[_0x3c6575[_0x4599e8(0x16a)]])pid[_0x3c6575['botID']][_0x4599e8(0x245)]({[_0x49fbbd]:_0x552cb9});}});}function storeSettings(_0x489c13,_0xcbf882=![]){const _0x3b2e8a=_0x3df1ba;_0x489c13={...settings,..._0x489c13};if(_0xcbf882&&_0x489c13[_0x3b2e8a(0x232)]!='************'&&_0x489c13[_0x3b2e8a(0x232)]!=''){const _0x57506d=crypt['decrypt'](secure['privateKey'],_0x489c13[_0x3b2e8a(0x232)])[_0x3b2e8a(0x1af)]['split']('@')[0x0],_0x28a094=bcrypt[_0x3b2e8a(0x15d)](_0x57506d,saltRounds);_0x489c13={..._0x489c13,'bbPassword':_0x28a094};}if(_0xcbf882&&_0x489c13['telegramToken']!='************'&&_0x489c13[_0x3b2e8a(0x16f)]!=''){const _0x5410c8=crypt[_0x3b2e8a(0x221)](secure[_0x3b2e8a(0x11b)],_0x489c13[_0x3b2e8a(0x16f)])[_0x3b2e8a(0x1af)][_0x3b2e8a(0x17d)]('@')[0x0];_0x489c13={..._0x489c13,'telegramToken':_0x5410c8};}const _0x3973ec=_0x489c13[_0x3b2e8a(0x16f)]!=_0x3b2e8a(0x11e)&&_0x489c13[_0x3b2e8a(0x16f)]!=settings[_0x3b2e8a(0x16f)]||_0x489c13['telegramUsername']!=settings[_0x3b2e8a(0x25e)],_0x3d9e95=_0x489c13[_0x3b2e8a(0x16f)]==''||_0x489c13[_0x3b2e8a(0x25e)]=='';if(_0x3973ec)_0x489c13[_0x3b2e8a(0x20a)]=_0x3b2e8a(0x211);for(const [_0x27298e,_0x31f560]of Object[_0x3b2e8a(0x24f)](_0x489c13)){if(_0x27298e==_0x3b2e8a(0x16f)&&_0x31f560=='************'){_0x489c13[_0x3b2e8a(0x16f)]=settings['telegramToken'];continue;};if(_0x27298e==_0x3b2e8a(0x232)&&_0x31f560==_0x3b2e8a(0x11e)){_0x489c13[_0x3b2e8a(0x232)]=settings['bbPassword'];continue;};dbSettings[_0x3b2e8a(0x13b)]('settings.'+_0x27298e,_0x31f560)[_0x3b2e8a(0x246)]();}settings=_0x489c13,io['to'](_0x3b2e8a(0x1a4))['emit'](_0x3b2e8a(0x14c),cleanSettings()),broadcastToBots(_0x3b2e8a(0x14a),settings['timeshift']);if(_0x3973ec&&!_0x3d9e95)initTelegram();if(_0x3973ec&&_0x3d9e95)disableTelegram();getAllClients()['forEach'](_0x24dd5f=>{const _0xfe8445=_0x3b2e8a;getSocket(_0x24dd5f['id'])[_0xfe8445(0x186)](_0xfe8445(0x1a3),{'access':{'allow':![],'reason':_0xfe8445(0x1ba),'token':null}});});}function updateSetting(_0x3f757d,_0x2c86dc){const _0x2cfc13=_0x3df1ba;dbSettings[_0x2cfc13(0x13b)](_0x2cfc13(0x19b)+_0x3f757d,_0x2c86dc)[_0x2cfc13(0x246)](),settings=getSettings(),io['to'](_0x2cfc13(0x1a4))['emit']('settings',cleanSettings());}function storeSecure(_0x310180){const _0x494e28=_0x3df1ba;dbSecure[_0x494e28(0x224)]('secure')[_0x494e28(0x12f)](_0x310180)['write'](),secure=_0x310180;}function addBlacklist(_0x7595a2){const _0x129021=_0x3df1ba;cleanBlacklist();let _0x7bad6;devices[_0x7595a2][_0x129021(0x159)]?_0x7bad6=Math[_0x129021(0x1f9)](devices[_0x7595a2][_0x129021(0x159)]['expiry'],loginExpiry):_0x7bad6=loginExpiry,dbSecure[_0x129021(0x224)](_0x129021(0x1cd))[_0x129021(0x12f)]({'expiry':new Date()[_0x129021(0x1bd)]()+_0x7bad6*0x3c*0x3e8,'token':devices[_0x7595a2][_0x129021(0x1d6)][_0x129021(0x1a0)]})['write'](),blacklist=dbSecure[_0x129021(0x224)](_0x129021(0x1cd))[_0x129021(0x146)]();}function cleanBlacklist(){const _0x439337=_0x3df1ba;let _0x1730ee=dbSecure[_0x439337(0x224)](_0x439337(0x1cd))[_0x439337(0x16e)]()[_0x439337(0x146)](),_0x13db1c=new Date()[_0x439337(0x1bd)]();_0x1730ee[_0x439337(0x1a7)](_0x4428f4=>{const _0x4efd6e=_0x439337;_0x4428f4[_0x4efd6e(0x17e)]<_0x13db1c&&dbSecure[_0x4efd6e(0x224)](_0x4efd6e(0x1cd))[_0x4efd6e(0x1b5)]({'expiry':_0x4428f4['expiry']})['write']();});}function initStates(){const _0x317409=_0x3df1ba;let _0xe01e15=getConfiguration();_0xe01e15[_0x317409(0x1a7)](_0x71e9cd=>{const _0x40eeac=_0x317409;_0x71e9cd[_0x40eeac(0x21d)]=_0x40eeac(0x1fe);}),storeConfiguration(_0xe01e15);}function onKeys(){const _0x5a26fc=new RSA();return new Promise(_0x57c59f=>{const _0x132702=_0xf9ea;_0x5a26fc['generateKeyPairAsync']()[_0x132702(0x1d1)](_0x3e17fb=>{_0x57c59f(_0x3e17fb);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2a4707=_0x3df1ba;let _0x3d809a=getConfiguration(),_0x3936f0=![];_0x3d809a[_0x2a4707(0x1a7)](_0x2ef5d2=>{const _0x31bcb0=_0x2a4707;if(_0x2ef5d2[_0x31bcb0(0x1a3)]=='running')_0x2ef5d2[_0x31bcb0(0x1a3)]='enabled',_0x3936f0=!![];else _0x2ef5d2['status']==_0x31bcb0(0x1fe)&&(_0x2ef5d2['status']=_0x31bcb0(0x1a9),_0x3936f0=!![]);});if(_0x3936f0)storeConfiguration(_0x3d809a);let _0x131c28=getSecure();if(!_0x131c28[_0x2a4707(0x1e3)](_0x2a4707(0x1c6))){let _0x52835d=await generateKeys();_0x131c28[_0x2a4707(0x20e)]=_0x52835d[_0x2a4707(0x20e)],_0x131c28['privateKey']=_0x52835d['privateKey'],_0x131c28[_0x2a4707(0x1c6)]=crypto[_0x2a4707(0x187)](0x20)[_0x2a4707(0x20d)](_0x2a4707(0x1a5));;storeSecure(_0x131c28);}let _0x5483ad=getSettings();_0x3936f0=![];!_0x5483ad['hasOwnProperty'](_0x2a4707(0x1c4))&&(_0x5483ad[_0x2a4707(0x1c4)]=![],_0x5483ad[_0x2a4707(0x164)]='',_0x5483ad[_0x2a4707(0x232)]='',_0x5483ad[_0x2a4707(0x1d9)]=![],_0x3936f0=!![]);!_0x5483ad[_0x2a4707(0x1e3)](_0x2a4707(0x23d))&&(_0x5483ad[_0x2a4707(0x23d)]=![],_0x5483ad[_0x2a4707(0x241)]=[],_0x5483ad[_0x2a4707(0x1c3)]=![],_0x3936f0=!![]);if(!_0x5483ad[_0x2a4707(0x1e3)](_0x2a4707(0x236))){if(_0x5483ad['telegramChatId'])_0x5483ad[_0x2a4707(0x236)]=!![];else _0x5483ad[_0x2a4707(0x236)]=![];_0x3936f0=!![];}if(_0x3936f0)storeSettings(_0x5483ad);}function storeConfiguration(_0x16a588){const _0x5c19ab=_0x3df1ba;dbConfig[_0x5c19ab(0x224)](_0x5c19ab(0x209))[_0x5c19ab(0x1b5)]()[_0x5c19ab(0x246)](),dbConfig[_0x5c19ab(0x224)](_0x5c19ab(0x209))[_0x5c19ab(0x12f)](..._0x16a588)['write'](),config=_0x16a588;}function resetPassword(){const _0x269184=_0x3df1ba;tgBot&&settings[_0x269184(0x16c)]&&(tgBot[_0x269184(0x1c1)]('callback_query'),tgBot['sendMessage'](settings[_0x269184(0x16c)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x269184(0x1b0),'callback_data':_0x269184(0x1b0)},{'text':'no','callback_data':'no'}]]}})[_0x269184(0x21e)](_0x309929=>{telegramError(_0x309929);}),tgBot['on'](_0x269184(0x11c),async _0x5bab66=>{const _0x2c2cd0=_0x269184,_0x50f605=_0x5bab66[_0x2c2cd0(0x244)],_0x57f2af=_0x5bab66['message'];tgBot['answerCallbackQuery'](_0x5bab66['id'])[_0x2c2cd0(0x1d1)](async()=>{const _0x235cce=_0x2c2cd0;if(_0x50f605!='no'){const _0x18b6bf=0xf,_0x158d5d=_0x235cce(0x166),_0x5885e4=Array[_0x235cce(0x229)](crypto[_0x235cce(0x19c)](new Uint32Array(_0x18b6bf)))[_0x235cce(0x127)](_0x36575b=>_0x158d5d[_0x36575b%_0x158d5d['length']])['join'](''),_0x3d5dd7=bcrypt[_0x235cce(0x15d)](_0x5885e4,saltRounds);storeSettings({'bbPassword':_0x3d5dd7}),await tgBot['sendMessage'](_0x57f2af['chat']['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x5885e4,{'parse_mode':_0x235cce(0x12c)})[_0x235cce(0x21e)](_0x4c9107=>{telegramError(_0x4c9107);});}else await tgBot[_0x235cce(0x1d2)](_0x57f2af['chat']['id'],_0x235cce(0x216))[_0x235cce(0x21e)](_0x50ff4d=>{telegramError(_0x50ff4d);});}),tgBot[_0x2c2cd0(0x1c1)](_0x2c2cd0(0x11c));}));}function logging(_0x1465b5){const _0xa6f930=_0x3df1ba;console['log'](getTimeStamp()+_0xa6f930(0x235)+_0x1465b5);if(tgBot&&settings[_0xa6f930(0x16c)]&&settings[_0xa6f930(0x20a)]!=_0xa6f930(0x1d3))tgBot[_0xa6f930(0x1d2)](settings[_0xa6f930(0x16c)],'Bot\x20Mgr\x20>\x20'+_0x1465b5)[_0xa6f930(0x21e)](_0x1e0eda=>{telegramError(_0x1e0eda);});}function getServerTime(){const _0x3b5b44=_0x3df1ba,_0x32adeb=new Date();return _0x32adeb[_0x3b5b44(0x21b)]()+'/'+(_0x32adeb[_0x3b5b44(0x24a)]()+0x1)[_0x3b5b44(0x20d)]()[_0x3b5b44(0x131)](0x2,'0')+'/'+_0x32adeb[_0x3b5b44(0x139)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x32adeb[_0x3b5b44(0x1ff)]()[_0x3b5b44(0x20d)]()[_0x3b5b44(0x131)](0x2,'0')+':'+_0x32adeb[_0x3b5b44(0x1f3)]()[_0x3b5b44(0x20d)]()[_0x3b5b44(0x131)](0x2,'0')+':'+_0x32adeb[_0x3b5b44(0x212)]()[_0x3b5b44(0x20d)]()[_0x3b5b44(0x131)](0x2,'0');}function getTimeStamp(){const _0x8743d8=_0x3df1ba,_0x1d99c3=shiftedTime();return _0x1d99c3['getFullYear']()+'/'+(_0x1d99c3['getMonth']()+0x1)[_0x8743d8(0x20d)]()[_0x8743d8(0x131)](0x2,'0')+'/'+_0x1d99c3[_0x8743d8(0x139)]()[_0x8743d8(0x20d)]()[_0x8743d8(0x131)](0x2,'0')+'\x20'+_0x1d99c3['getHours']()[_0x8743d8(0x20d)]()[_0x8743d8(0x131)](0x2,'0')+':'+_0x1d99c3['getMinutes']()['toString']()[_0x8743d8(0x131)](0x2,'0')+':'+_0x1d99c3[_0x8743d8(0x212)]()[_0x8743d8(0x20d)]()[_0x8743d8(0x131)](0x2,'0');}function shiftedTime(){const _0x470cfb=_0x3df1ba,_0x1942e9=new Date();let _0x55d8e7=_0x1942e9;if(settings[_0x470cfb(0x14a)]&&settings['timeshift']!==0x0)_0x55d8e7=fns[_0x470cfb(0x179)](_0x1942e9,{'hours':settings['timeshift']});return _0x55d8e7;}function startScheduler(){let _0xf362ad=new Date()['getUTCHours']();_0xf362ad==0x1&&backupConfigFiles();_0xf362ad==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0xb86def=_0x3df1ba;fs[_0xb86def(0x248)](configpath,{'withFileTypes':!![]})['forEach'](_0x5126bb=>{const _0x57e801=_0xb86def;if(!_0x5126bb[_0x57e801(0x218)]())fs[_0x57e801(0x17b)](configpath+_0x5126bb[_0x57e801(0x206)],configbackuppath+_0x5126bb[_0x57e801(0x206)]);});}function triggerAnalytics(){const _0x27a93b=_0x3df1ba;analytics[_0x27a93b(0x15c)]({'title':'Balance\x20Bot\x20Server','href':'https://hodlerhacks.com','path':'/v'+serverversion});}function validateCredentials(_0xe68478,_0x1ebb4d){const _0x303183=_0x3df1ba;if(_0xe68478[_0x303183(0x134)]==settings[_0x303183(0x164)]&&bcrypt[_0x303183(0x193)](_0xe68478[_0x303183(0x226)],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x303183(0x143),'token':null};else{const _0x168a2a=generateLoginToken(_0x1ebb4d);return{'allow':!![],'reason':_0x303183(0x1ef),'token':_0x168a2a};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x32a7d5){const _0x269844=_0x3df1ba,_0x2ecaf5=generateLoginToken(_0x32a7d5);return{'allow':!![],'reason':_0x269844(0x1ef),'token':_0x2ecaf5};}function validateAccess(_0x52d569,_0x112b5d){const _0x34d9a7=_0x3df1ba;let _0x2fa702=devices[_0x112b5d]['ip'],_0x4da8ae;const _0xb2959a=_0x9433c3=>{const _0x3d30a3=_0xf9ea;if(settings[_0x3d30a3(0x1c4)]){if(settings[_0x3d30a3(0x1d9)]){if(telegram2FaApproved(_0x112b5d)){const _0x4694fe=generateLoginToken(_0x112b5d);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x4694fe};}else return{'allow':![],'reason':_0x3d30a3(0x25a),'token':null};}else return _0x4da8ae=validToken(_0x9433c3,_0x112b5d),_0x4da8ae[_0x3d30a3(0x1e3)](_0x3d30a3(0x140))?{'allow':!![],'reason':_0x3d30a3(0x177),'token':_0x9433c3}:{'allow':![],'reason':_0x3d30a3(0x25a),'token':null};}else return{'allow':!![],'reason':_0x3d30a3(0x130),'token':null};};if(settings[_0x34d9a7(0x23d)]){let _0x22d7b2=[...settings[_0x34d9a7(0x241)],_0x34d9a7(0x1f8),'::ffff:127.0.0.1','127.0.0.1'];if(_0x22d7b2[_0x34d9a7(0x18c)](_0x2fa702))return _0xb2959a(_0x52d569);else{_0x4da8ae=validToken(_0x52d569,_0x112b5d);if(_0x4da8ae['hasOwnProperty']('success'))return _0xb2959a(_0x52d569);else{if(telegramIpApproved(_0x112b5d)){const _0x22eba6=generateToken(_0x112b5d);return _0x4da8ae=_0xb2959a(_0x52d569),_0x4da8ae[_0x34d9a7(0x1cc)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x22eba6}:_0x4da8ae;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x34d9a7(0x1ee),'token':null}:{'allow':![],'reason':_0x34d9a7(0x1a6),'token':null};}}}else return _0xb2959a(_0x52d569);}function timelyDecrypt(_0x4fcca8,_0x495450=!![]){const _0x2d5789=_0x3df1ba;if(_0x4fcca8)try{const _0x579487=crypt[_0x2d5789(0x221)](secure[_0x2d5789(0x11b)],_0x4fcca8)[_0x2d5789(0x1af)],_0x41999e=_0x579487[_0x2d5789(0x17d)]('@')[0x0],_0x411360=_0x579487[_0x2d5789(0x17d)]('@')[0x1],_0x5d2782=new Date()[_0x2d5789(0x1bd)]();if(_0x495450){if(_0x5d2782-_0x411360<maxSecretAge*0x3e8)return _0x41999e;else return![];}else return _0x41999e;}catch(_0x5428c4){return![];}else return![];}const validToken=(_0x442271,_0x213379)=>{const _0x4835cf=_0x3df1ba,_0x420eb9=devices[_0x213379]['ip'];if(!_0x442271)return{'error':_0x4835cf(0x1f7)};for(let _0x5134ee of blacklist){if(_0x5134ee[_0x4835cf(0x1a0)]==_0x442271)return{'error':_0x4835cf(0x201)};}let _0x131ab7;try{_0x131ab7=jwt['verify'](_0x442271,secure[_0x4835cf(0x1c6)]+_0x213379);}catch{return{'error':_0x4835cf(0x157)};}if(!_0x131ab7['hasOwnProperty']('clientip')&&!_0x131ab7['hasOwnProperty']('username')||!_0x131ab7[_0x4835cf(0x1e3)](_0x4835cf(0x1f2)))return{'error':_0x4835cf(0x161)};if(!_0x131ab7['hasOwnProperty'](_0x4835cf(0x134))&&_0x131ab7['hasOwnProperty'](_0x4835cf(0x176))){const {clientip:_0x16f895}=_0x131ab7;return _0x420eb9==_0x16f895?{'success':_0x4835cf(0x149)}:{'error':_0x4835cf(0x24e)};}else{if(_0x131ab7[_0x4835cf(0x1e3)]('username')&&_0x131ab7[_0x4835cf(0x1e3)](_0x4835cf(0x176))){const {username:_0x5745c7,clientip:_0x23676d}=_0x131ab7;return settings[_0x4835cf(0x164)]==_0x5745c7&&_0x420eb9==_0x23676d?{'success':_0x4835cf(0x149)}:{'error':_0x4835cf(0x1ca)};}}},generateLoginToken=_0x20aa5e=>{const _0x38d652=_0x3df1ba;if(_0x20aa5e){const _0x2fda05=devices[_0x20aa5e]['ip'];return jwt[_0x38d652(0x1c9)]({'username':settings['bbUsername'],'clientip':_0x2fda05},secure[_0x38d652(0x1c6)]+_0x20aa5e,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x3c9988=>{const _0x4a0145=_0x3df1ba;if(_0x3c9988){const _0x118a47=devices[_0x3c9988]['ip'];return jwt[_0x4a0145(0x1c9)]({'clientip':_0x118a47},secure[_0x4a0145(0x1c6)]+_0x3c9988,{'expiresIn':devices[_0x3c9988][_0x4a0145(0x159)][_0x4a0145(0x17e)]*0x3c});}else return![];},telegramIpApproved=_0x236a5f=>{const _0x4bd60b=_0x3df1ba;let _0x5ee95d=![];return devices[_0x236a5f][_0x4bd60b(0x159)]&&devices[_0x236a5f][_0x4bd60b(0x159)][_0x4bd60b(0x17e)]!=_0x4bd60b(0x1ab)&&(_0x5ee95d=devices[_0x236a5f][_0x4bd60b(0x159)]['clientip']==devices[_0x236a5f]['ip']&&new Date()['getTime']()-devices[_0x236a5f]['telegramIpApproval'][_0x4bd60b(0x1e7)]<devices[_0x236a5f][_0x4bd60b(0x159)][_0x4bd60b(0x17e)]*0x3c*0x3e8),_0x5ee95d;},telegram2FaApproved=_0x506106=>{const _0x2ec588=_0x3df1ba;let _0x3a505d=![];return devices[_0x506106][_0x2ec588(0x1be)]&&devices[_0x506106][_0x2ec588(0x1be)][_0x2ec588(0x17e)]!=_0x2ec588(0x1ab)&&(_0x3a505d=devices[_0x506106][_0x2ec588(0x1be)]['clientip']==devices[_0x506106]['ip']&&new Date()[_0x2ec588(0x1bd)]()-devices[_0x506106][_0x2ec588(0x1be)]['timestamp']<devices[_0x506106][_0x2ec588(0x1be)]['expiry']*0x3c*0x3e8),_0x3a505d;},normalizeIP=_0x674fa5=>{const _0x3baac7=_0x3df1ba;let _0x34a6f6=null,_0x39ca07=null;if(ipaddr[_0x3baac7(0x1b1)](_0x674fa5)){const _0xacbd3d=ipaddr[_0x3baac7(0x1e2)](_0x674fa5);_0xacbd3d[_0x3baac7(0x16b)]()==='ipv6'?(_0xacbd3d['isIPv4MappedAddress']()&&(_0x34a6f6=_0xacbd3d[_0x3baac7(0x151)]()[_0x3baac7(0x20d)]()),_0x39ca07=_0xacbd3d[_0x3baac7(0x20d)]()):(_0x34a6f6=_0xacbd3d[_0x3baac7(0x20d)](),_0x39ca07=_0xacbd3d[_0x3baac7(0x125)]()[_0x3baac7(0x20d)]());}return{'show':_0x34a6f6?_0x34a6f6:_0x39ca07,'store':_0x39ca07};};