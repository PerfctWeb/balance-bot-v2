const _0x1bc878=_0x5607;(function(_0x2ea1a0,_0x31a187){const _0x54cbea=_0x5607,_0x5197aa=_0x2ea1a0();while(!![]){try{const _0x305441=parseInt(_0x54cbea(0x3bb))/0x1+-parseInt(_0x54cbea(0x335))/0x2+-parseInt(_0x54cbea(0x377))/0x3*(parseInt(_0x54cbea(0x286))/0x4)+parseInt(_0x54cbea(0x1fd))/0x5*(-parseInt(_0x54cbea(0x3ec))/0x6)+parseInt(_0x54cbea(0x375))/0x7*(-parseInt(_0x54cbea(0x319))/0x8)+-parseInt(_0x54cbea(0x353))/0x9+parseInt(_0x54cbea(0x3b4))/0xa*(parseInt(_0x54cbea(0x22f))/0xb);if(_0x305441===_0x31a187)break;else _0x5197aa['push'](_0x5197aa['shift']());}catch(_0x2c6e7f){_0x5197aa['push'](_0x5197aa['shift']());}}}(_0x13a2,0x3f6eb));const _0x4f11a1=function(){let _0x126481=!![];return function(_0x452d2f,_0x576438){const _0x268407=_0x126481?function(){const _0x45ede3=_0x5607;if(_0x576438){const _0x147eb8=_0x576438[_0x45ede3(0x3d3)](_0x452d2f,arguments);return _0x576438=null,_0x147eb8;}}:function(){};return _0x126481=![],_0x268407;};}(),_0x3eed13=_0x4f11a1(this,function(){const _0x5a5ea8=_0x5607;return _0x3eed13[_0x5a5ea8(0x37c)]()['search']('(((.+)+)+)+$')[_0x5a5ea8(0x37c)]()['constructor'](_0x3eed13)['search'](_0x5a5ea8(0x24b));});_0x3eed13();'use strict';process[_0x1bc878(0x38b)][_0x1bc878(0x308)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require('date-fns'),low=require(_0x1bc878(0x372)),FileSync=require(_0x1bc878(0x3b2)),path=require(_0x1bc878(0x3e8)),crypto=require(_0x1bc878(0x322)),forge=require('node-forge'),bcrypt=require('bcryptjs'),jwt=require(_0x1bc878(0x2ec)),ipaddr=require(_0x1bc878(0x28d)),argv=require('yargs/yargs')(process['argv'][_0x1bc878(0x325)](0x2))[_0x1bc878(0x3b3)],uuidRandom=require('uuid-random'),{Telegraf,Markup}=require(_0x1bc878(0x255)),Mixpanel=require(_0x1bc878(0x3f9)),axios=require(_0x1bc878(0x323)),{GraphQLClient,gql}=require(_0x1bc878(0x2c2)),util=require(_0x1bc878(0x23b)),fileUpload=require(_0x1bc878(0x349)),{networkInterfaces}=require('os'),JSZip=require(_0x1bc878(0x2ed)),PORT=argv['port']||_0x1bc878(0x34e),pattern=/^[0-9]{2,4}$/;!pattern[_0x1bc878(0x1ed)](PORT)&&(console[_0x1bc878(0x39b)](_0x1bc878(0x299)+PORT+_0x1bc878(0x235)),process['exit'](0x1));const HOST=argv[_0x1bc878(0x3f1)]||null,userID=argv[_0x1bc878(0x384)]||'',debugging=argv['d']||![],nodeversion=process[_0x1bc878(0x342)]['node'];let bbpath=_0x1bc878(0x2c6),bbpath2='';const botfile=_0x1bc878(0x383),configfile=_0x1bc878(0x397),settingsfile=_0x1bc878(0x3e9),securefile=_0x1bc878(0x1e0),environment=require('./'+bbpath2+_0x1bc878(0x1f3))[_0x1bc878(0x326)]||_0x1bc878(0x29d),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x1bc878(0x1de)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x1bc878(0x2be)),configpath=userID?bbpath+_0x1bc878(0x2e2)+userID+'/':bbpath+_0x1bc878(0x2e2),configbackuppath=configpath+_0x1bc878(0x3f5),logspath=userID?bbpath+_0x1bc878(0x3a1)+userID+'/':bbpath+_0x1bc878(0x3a1),zippath=userID?bbpath+_0x1bc878(0x260)+userID+'/':bbpath+_0x1bc878(0x260),loggerfile=fs[_0x1bc878(0x3f7)](logspath+_0x1bc878(0x287),{'flags':'a'}),temppath=userID?bbpath+_0x1bc878(0x265)+userID+'/':bbpath+_0x1bc878(0x265);!fs[_0x1bc878(0x1de)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x1bc878(0x1de)](configbackuppath)&&fs[_0x1bc878(0x314)](configbackuppath);!fs[_0x1bc878(0x1de)](logspath)&&fs[_0x1bc878(0x314)](logspath);!fs[_0x1bc878(0x1de)](zippath)&&fs[_0x1bc878(0x314)](zippath);!fs['existsSync'](temppath)&&fs[_0x1bc878(0x314)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x1bc878(0x231)]({'bots':[]})[_0x1bc878(0x374)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x1bc878(0x231)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x1bc878(0x292),'onepagemode':![],'marketcapApi':''}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x1bc878(0x231)]({'secure':{},'blacklist':[]})[_0x1bc878(0x374)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x1bc878(0x354)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x1bc878(0x368)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x1bc878(0x290)]&&(settings[_0x1bc878(0x290)]!=''&&settings[_0x1bc878(0x290)]!=_0x1bc878(0x31b))&&settings[_0x1bc878(0x2d4)]&&settings[_0x1bc878(0x2d4)]!='')initTelegram();const parseColor=(_0x3f3241,_0x20f972)=>{const _0x54ce50=_0x1bc878,_0x2efa10=/#[A-Z]{3}#/g;if(typeof _0x3f3241==_0x54ce50(0x259)){!_0x20f972?_0x3f3241=_0x3f3241[_0x54ce50(0x3c1)](_0x2efa10,''):(_0x3f3241=_0x3f3241[_0x54ce50(0x3c1)](/#BLU#/g,_0x54ce50(0x1eb)),_0x3f3241=_0x3f3241['replace'](/#RED#/g,_0x54ce50(0x376)),_0x3f3241=_0x3f3241[_0x54ce50(0x3c1)](/#YEL#/g,_0x54ce50(0x28e)),_0x3f3241=_0x3f3241[_0x54ce50(0x3c1)](/#MAG#/g,'\x1b[35m'),_0x3f3241=_0x3f3241['replace'](/#CYA#/g,_0x54ce50(0x2cc)),_0x3f3241=_0x3f3241[_0x54ce50(0x3c1)](/#RES#/g,_0x54ce50(0x2db)));;}return _0x3f3241;},logger={'screen':_0x100886=>{const _0x3baf7e=_0x1bc878;console[_0x3baf7e(0x39b)](parseColor(_0x100886,!![]));},'simple':_0x2e6342=>{const _0x40b42d=_0x1bc878;console['log'](parseColor(_0x2e6342,!![])),loggerfile[_0x40b42d(0x374)](util[_0x40b42d(0x324)](parseColor(_0x2e6342,![]))+'\x0a');},'full':async _0xcb91c0=>{const _0x240336=_0x1bc878,_0x4de002=getTimeStamp()+_0x240336(0x2f3)+_0xcb91c0;console[_0x240336(0x39b)](parseColor(_0x4de002,!![])),loggerfile[_0x240336(0x374)](util[_0x240336(0x324)](parseColor(_0x4de002,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x240336(0x3ca)]!='orders')await sendTelegram(settings[_0x240336(0x253)],_0x240336(0x238)+parseColor(_0xcb91c0,![]));},'debug':async(_0x3e04da,_0xe303af='')=>{const _0x2b68bf=_0x1bc878,_0x554968=getTimeStamp()+_0x2b68bf(0x366)+_0x3e04da;if(debugging)console['log'](parseColor(_0x554968,!![]));loggerfile[_0x2b68bf(0x374)](util[_0x2b68bf(0x324)](parseColor(_0x554968,![]))+'\x0a');if(_0xe303af){if(debugging)console[_0x2b68bf(0x39b)](_0xe303af);loggerfile['write'](util['format'](_0xe303af)+'\x0a');}}};let terminating=![];process['on'](_0x1bc878(0x2b4),function(_0x5559a4){const _0x44592b=_0x1bc878;_0x5559a4[_0x44592b(0x37c)]()[_0x44592b(0x334)](_0x44592b(0x281))?(logger[_0x44592b(0x2b6)](_0x44592b(0x3ce)+_0x5559a4[_0x44592b(0x382)]+_0x44592b(0x388)),process['send']({'terminate':!![]},_0x5bb089=>{})):logger[_0x44592b(0x2b6)](_0x5559a4);}),process['on']('exit',()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x1bc878(0x249),()=>{const _0x2bf5b7=_0x1bc878;stopAllBots(),process[_0x2bf5b7(0x212)](0x0);}),process['on'](_0x1bc878(0x3ab),()=>{const _0xf65827=_0x1bc878;stopAllBots(),process[_0xf65827(0x212)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x1bc878(0x27d)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x1bc878(0x2a7)),app=express(),http=require('http')[_0x1bc878(0x363)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x1bc878(0x329)](_0x1bc878(0x218),async(_0x114f7b,_0x3784db)=>{const _0x5c05e5=_0x1bc878,_0x1b1a75=_0x114f7b[_0x5c05e5(0x2f7)][_0x5c05e5(0x282)],_0x41fc0a=getClientsWithBotID(_0x5c05e5(0x3d7)),_0x1e1e74=_0x114f7b[_0x5c05e5(0x38d)][_0x5c05e5(0x269)],_0x2acdf6=timelyDecrypt(_0x1e1e74,![]),_0x4ae8b0=_0x41fc0a['find'](_0x4891d9=>_0x4891d9[_0x5c05e5(0x269)]==_0x2acdf6);if(_0x4ae8b0){const _0x2454de=normalizeIP(_0x114f7b[_0x5c05e5(0x2e7)][_0x5c05e5(0x327)])[_0x5c05e5(0x39c)],_0x33c37e=_0x114f7b[_0x5c05e5(0x38d)][_0x5c05e5(0x34d)];if(validateAccess(_0x33c37e,_0x2acdf6,_0x2454de)[_0x5c05e5(0x31a)])_0x1b1a75==_0x5c05e5(0x1ee)&&await backupConfigFiles(),await zipFiles(_0x1b1a75),_0x3784db[_0x5c05e5(0x271)](zippath+(_0x1b1a75+'.zip'),_0x2fd1b6=>{const _0x5229b6=_0x5c05e5;_0x2fd1b6&&(logger['full'](_0x5229b6(0x28a)+_0x1b1a75),logger[_0x5229b6(0x2b6)](_0x2fd1b6));});else logger[_0x5c05e5(0x2d5)](_0x5c05e5(0x380)+_0x1b1a75+_0x5c05e5(0x385));}else logger['full'](_0x5c05e5(0x380)+_0x1b1a75+_0x5c05e5(0x27c));}),app[_0x1bc878(0x373)](_0x1bc878(0x32e),async(_0x206833,_0x10c2a4)=>{const _0x4a99a3=_0x1bc878,_0x10ed01=getClientsWithBotID(_0x4a99a3(0x3d7)),_0x186b30=_0x206833['headers'][_0x4a99a3(0x269)],_0x55dd5c=timelyDecrypt(_0x186b30,![]),_0x374c12=_0x10ed01['find'](_0xd0d4f5=>_0xd0d4f5['uuid']==_0x55dd5c);logger[_0x4a99a3(0x2f6)](_0x4a99a3(0x393));if(_0x374c12){const _0x25c6fb=normalizeIP(_0x206833[_0x4a99a3(0x2e7)][_0x4a99a3(0x327)])[_0x4a99a3(0x39c)],_0x3bfe4d=_0x206833['headers'][_0x4a99a3(0x34d)];if(validateAccess(_0x3bfe4d,_0x55dd5c,_0x25c6fb)[_0x4a99a3(0x31a)]){if(_0x206833[_0x4a99a3(0x2da)]){const _0x464ad4=_0x206833[_0x4a99a3(0x2da)]['backupfile'];await _0x464ad4['mv'](temppath+_0x464ad4[_0x4a99a3(0x2e8)]),_0x10c2a4[_0x4a99a3(0x279)]({'status':!![],'message':_0x4a99a3(0x399)});const _0x3726e3=getBotsWithMode();_0x3726e3['length']>0x0?confirmRestore(temppath,_0x464ad4['name']):unzipFile(temppath,_0x464ad4[_0x4a99a3(0x2e8)]);}}else logger[_0x4a99a3(0x2d5)](_0x4a99a3(0x30c));}else logger[_0x4a99a3(0x2d5)](_0x4a99a3(0x300));}),app[_0x1bc878(0x30e)](express[_0x1bc878(0x3b8)](path[_0x1bc878(0x2e3)](__dirname,bbpath2,_0x1bc878(0x294)))),app[_0x1bc878(0x30e)](express[_0x1bc878(0x3b8)](path[_0x1bc878(0x2e3)](__dirname,bbpath2,_0x1bc878(0x2fe)))),app['get']('/',function(_0x141297,_0x162820){const _0x7f8cbc=_0x1bc878;_0x162820[_0x7f8cbc(0x343)](path['join'](__dirname,bbpath2,'build2','index.html'));}),app['get'](_0x1bc878(0x2c9),function(_0xcb969e,_0x390a83){const _0x47a986=_0x1bc878;_0x390a83[_0x47a986(0x343)](path['join'](__dirname,bbpath2,'build',_0x47a986(0x2fd)));}),app[_0x1bc878(0x329)](_0x1bc878(0x365),(_0xbeaf8,_0x56174a)=>{const _0x3b01d7=_0x1bc878;_0x56174a[_0x3b01d7(0x343)](path[_0x3b01d7(0x2e3)](__dirname,bbpath2,'build',_0x3b01d7(0x2fd)));}),app[_0x1bc878(0x329)](_0x1bc878(0x306),(_0x5d58a7,_0x4deaad)=>{const _0x5c982b=_0x1bc878;_0x4deaad['sendFile'](path[_0x5c982b(0x2e3)](__dirname,bbpath2,'build',_0x5c982b(0x2fd)));}),app[_0x1bc878(0x329)](_0x1bc878(0x301),(_0x5224aa,_0x8c3b3d)=>{const _0x429883=_0x1bc878;_0x8c3b3d[_0x429883(0x343)](path[_0x429883(0x2e3)](__dirname,bbpath2,_0x429883(0x2fe),'index.html'));}),app[_0x1bc878(0x329)]('/:bot/history',(_0x2ca941,_0x261ba8)=>{const _0x4d1113=_0x1bc878;_0x261ba8[_0x4d1113(0x343)](path[_0x4d1113(0x2e3)](__dirname,bbpath2,_0x4d1113(0x2fe),_0x4d1113(0x2fd)));}),app[_0x1bc878(0x329)](_0x1bc878(0x1ea),(_0x5e92e0,_0x347678)=>{const _0x3de972=_0x1bc878;_0x347678[_0x3de972(0x343)](path[_0x3de972(0x2e3)](__dirname,bbpath2,_0x3de972(0x2fe),'index.html'));}),app[_0x1bc878(0x329)](_0x1bc878(0x3ea),(_0x1801a6,_0x7cd88)=>{const _0x43ac43=_0x1bc878;_0x7cd88[_0x43ac43(0x343)](path['join'](__dirname,bbpath2,_0x43ac43(0x2fe),_0x43ac43(0x2fd)));});if(HOST)http[_0x1bc878(0x3bc)](PORT,HOST);else http['listen'](PORT);const io=require(_0x1bc878(0x3ae))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x20fb3a=_0x1bc878;let _0x257fa5=_0x20fb3a(0x3af);const _0x29886e=networkInterfaces(),_0x327a1b={};for(const _0x48cbdf of Object[_0x20fb3a(0x386)](_0x29886e)){for(const _0x3e6f7e of _0x29886e[_0x48cbdf]){if((_0x3e6f7e['family']==_0x20fb3a(0x2ff)||_0x3e6f7e[_0x20fb3a(0x229)]==0x4)&&!_0x3e6f7e['internal']){const _0xb2fd13=ipaddr[_0x20fb3a(0x247)](_0x3e6f7e['address'])[_0x20fb3a(0x37a)]();_0xb2fd13!='private'&&(!_0x327a1b[_0x48cbdf]&&(_0x327a1b[_0x48cbdf]=[]),_0x327a1b[_0x48cbdf][_0x20fb3a(0x389)](_0x3e6f7e[_0x20fb3a(0x3a0)]),_0x257fa5=_0x3e6f7e[_0x20fb3a(0x3a0)]);}}}return{'serverip':_0x257fa5,'netinterfaces':_0x327a1b};}function _0x13a2(){const _0x337aaf=['slice','environment','remoteAddress','tempaccess_30_','get','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','privateKeyToPem','User\x20has\x20been\x20validated','callback','/upload-backup','Error\x20removing\x20old\x20backup\x20files:','telegram','************','emit','place-order','includes','477238ZzWDnh','sort','tempaccess_reject_','orders','staging','/logs\x20-\x20receive\x20log\x20files\x0a','login2fa_reject_','new-disabled','confirm-message','add-bot','exchange','updatebotmanager','login\x20required','versions','sendFile','length','Invalid\x20authentication\x20token\x20(2)','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','::ffff:127.0.0.1','toggleBotMode','express-fileupload','alias','server','Unauthorized\x20attempt\x20to\x20add\x20bot','tkn','3000','Unauthorized\x20attempt\x20to\x20update\x20bot','all','editMessageReplyMarkup','inherit','2483082sRVzkd','init','metrics','temporary\x20access\x20not\x20allowed','bbPassword','restart','Telegram\x20error:','Disabled\x20Bot\x20','Allow\x20login\x20from\x20IP\x20address\x20','Notifications\x20disabled\x0a','backup-full','/backup\x20-\x20receive\x20backup\x20files\x0a','Ok,\x20will\x20send\x20alert\x20notifications\x20only','access','live','sendMetricsTelegram','createServer','update-bb','/:bot/portfolio',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','showname','api-eu.mixpanel.com','max','match','Network\x20Interfaces:','stopped','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','storeHeadless','Starting\x20#RED#Balance\x20Bot\x20v','running','split','lowdb','post','write','268149IFtkph','\x1b[31m','3nyBgTA','2FA\x20required','bbvNew','range','Starting\x20Balance\x20Bot\x20update','toString','deleteHistoryAlerts','toggle_','sockets','Unauthorized\x20attempt\x20to\x20download\x20','sendMessage','port','bot.js','user','\x20(1)','keys','telegrammsg','#RES#','push','startsWith','env','map','headers','tempaccess_5_','Yes','Deleted\x20Bot\x20','\x20>\x20','stringify','Backup\x20file\x20uploaded','update-bot','marketcapApi','Unauthorized\x20attempt\x20to\x20confirm\x20message','bb-config.json','isDirectory','File\x20uploaded','timeshift','log','store',')\x20\x20\x20|\x20Bot\x20','lastmsgtelegram','new','address','logs/','Running\x20#RED#Balance\x20Bot\x20v','mode','store-headless','Invalid\x20username\x20or\x20IP\x20address','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','/enable\x20-\x20enable\x20notifications\x0a','show-config','chat','config_all','SIGINT','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','sortBy','socket.io','[ip-address]','getStartingBalances','isValid','lowdb/adapters/FileSync','argv','4939210TQAAzv','delete-bot','order','temporary\x20access\x20timeout','static','apiKey','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','183145Jxtkua','listen','Logged\x20out\x20user\x20...','No\x20authentication\x20token','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','Error\x20sending\x20','replace','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','off','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Token\x20blacklisted','pidExpireLogin','Unauthorized\x20attempt\x20to\x20store\x20configuration','Notifications\x20types:\x20','logs','telegramEvents','Unauthorized\x20attempt\x20to\x20show\x20configuration','(staging)','Telegraf\x20error:','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','create','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','2FA\x20login\x20rejected','publicKey','apply','on_','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','\x20files\x20over\x20Telegram:','botmanager','bbUsername','publicKeyToPem','Login\x20rejected','Restore\x20backup\x20file\x20','15\x20min','binary','manual','ipv6','toIPv4Address','30\x20min','output-002.log','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','login\x20token\x20generated','success','settings.','path','bb-settings.json','/:bot/support','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','6mGNIxB','Unauthorized\x20attempt\x20to\x20get\x20portfolio','kill','bot','function','host','token','#RES#\x20if\x20running\x20locally\x0a','start','backup/','Error\x20while\x20deleting\x20config\x20files:\x20','createWriteStream','Markdown','mixpanel','\x20only\x0a','DEFLATE','message','secret','getFullYear','2FA\x20login\x20token\x20generated','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','existsSync','enable','bb-secure.json','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','exp','getSeconds','Password\x20reset\x20rejected','status\x20code\x20401','Unauthorized\x20attempt\x20to\x20log\x20out','cloneDeep','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','statSync','/:bot/configuration','\x1b[34m','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','test','backup','/off\x20-\x20stop\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20delete\x20bot','request','Bot\x20','version.json','\x20|\x20user:\x20...','#RES#\x20','output-000.log','No\x20bots\x20running\x20right\x20now','pidRefreshToken','size','Login\x20accepted','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','removeAllListeners','1010245InEwWG','auto','Node.js\x20v','Restoring\x20bot(s)\x20from\x20backup','-performance.json','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','clientip','bots','disabled','file','config_alerts','BCT','HTML','reinstall_no','headless','\x20|\x20','loadAsync','<b>Balance\x20Bot\x20Status:</b>\x0a','get-portfolio','toggle','latestversion','exit','cancelLoading','Unauthorized\x20attempt\x20to\x20get\x20events','Logged\x20in\x20user\x20...','disconnect','onepagemode','/download/:type','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','forEach','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','get-logs','backup-full.zip','reload','secure','storeFiat','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','blacklist','warning','userid','alerts','config','ipc','reply','family','timestamp','output-003.log','\x20|\x20client:\x20...','Idling\x20(','showConfig','33SzRHZB','getMinutes','defaults','Notifications\x20enabled\x0a','replyWithDocument','sendPortfolioTelegram',',\x20must\x20be\x20a\x204\x20digit\x20number','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','reinstall','Bot\x20Mgr\x20>\x20','metrics_','Starting\x20new\x20bot\x20|\x20Bot\x20','util','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','username','delete-alerts','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','notification','password','-events.json','|@|','<b>Telegram\x20Bot\x20Status:</b>\x0a','botID','from','parse','mtime','SIGTERM','update_yes','(((.+)+)+)+$','\x20-\x20','toIPv4MappedAddress','update_no','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Access\x20enabled\x20for\x20','getTime','inlineKeyboard','telegramChatId','temporary\x20access\x20rejected','telegraf','help','yes','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','string','Unauthorized\x20attempt\x20to\x20update\x20settings','track','privateKey','2FA\x20login\x20required','bot-','/disable\x20-\x20disable\x20notifications\x0a','zip/','enabled','apiPassword','loginRequired','event','temp/','restore_no_','login','once','uuid','::1','getHours','min','Notifications\x20disabled','All\x20bots','backup-files','storeConfiguration','download','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','rsa','/on\x20-\x20start\x20bot(s)\x0a','encryptedUuid','/metrics\x20-\x20show\x20bot\x20performance\x0a','temporary\x20token\x20generated','generateKeyPair','send','isIPv4MappedAddress','2FA','\x20(2)','version','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Session\x20expired\x20for\x20user\x20...','/start','address\x20already\x20in\x20use','type','store-configuration','Temporary\x20access\x20rejected','close','1834724VArqAH','/output-000.log','-config.json','copyFileSync','Failed\x20to\x20download\x20','Unauthorized\x20attempt\x20to\x20delete\x20alerts','any','ipaddr.js','\x1b[33m','RSA-OAEP','telegramToken','output-001.log','0.0.0','All\x20bots\x20running\x20right\x20now','build2','Setting\x20access:\x20','referer','bbvReceive','action','Error:\x20Invalid\x20argument\x20','update','login\x20token\x20valid','backup-full@','production','telegramIpApproval','-results.json','initclient','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','telegram2FaApproval','emitHistory','login2fa_','reset-password','number','express','stop','invalid\x20credentials','settings','find','getDate','login\x20not\x20required','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Server','getUTCHours','remove','uncaughtException','get-messages','simple','pki','async','getMonth','_nsps','/status\x20-\x20show\x20bot(s)\x20status\x0a','title','randomBytes','clients','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','reason','catch','graphql-request','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','privateKeyFromPem','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','bb/','messages','logout','/:bot','.zip','resetpw_no','\x1b[36m','value','exec','error','restore-backup-file','add','handshake','command','telegramUsername','full','CoinMarketCap\x20API\x20key\x20validated','padStart','5\x20min','config_orders','files','\x1b[0m','button','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','auth','decode64','portfolio','resetpw_yes','config/','join','Ok,\x20will\x20send\x20order\x20notifications\x20only','expiry','assign','socket','name','reset-history','Invalid\x20IP\x20address','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','jsonwebtoken','jszip','disable','data','logged\x20out','Alerts','tempaccess_15_',':\x20Bot\x20Mgr\x20>\x20','temporaryAccessAllowed','telegramEnabled','debug','params','store-settings','-----------------------------------------------------------------------------------','started','$1_$2_$3','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','index.html','build','IPv4','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','/:bot/coins','Restore\x20process\x20confirmed','lastmsgemitted','fork','botname','/:bot/performance','Starting\x20(','NTBA_FIX_319','entries','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','toggle-bot-mode','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','use','1000','unlinkSync','reject','show','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','mkdirSync','ETH','Unauthorized\x20login\x20attempt\x20(timeout)','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','readdirSync','48gOEOjL','allow','***','rmSync','status','set','readFileSync','Unauthorized\x20attempt\x20to\x20get\x20messages','hasOwnProperty','crypto','axios','format'];_0x13a2=function(){return _0x337aaf;};return _0x13a2();}async function startServer(){const _0x3a241d=_0x1bc878,{serverip:_0x22f280,netinterfaces:_0x3270fc}=getServerIP();logger[_0x3a241d(0x2b6)](''),logger['simple']('-----------------------------------------------------------------------------------'),await logger[_0x3a241d(0x2d5)](_0x3a241d(0x36f)+serverversion+_0x3a241d(0x1f5)+(environment==_0x3a241d(0x339)?_0x3a241d(0x3cc):'')+'\x0a'+(_0x3a241d(0x30d)+PORT+_0x3a241d(0x3f3))+('=>\x20Go\x20to\x20#CYA#http://'+_0x22f280+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger['simple']('-----------------------------------------------------------------------------------');if(config[_0x3a241d(0x344)]!=0x0)for(const _0x56bdbd of config){const _0x2638da=_0x56bdbd['mode']=='auto'?'a':'m';if(_0x56bdbd[_0x3a241d(0x31d)]==_0x3a241d(0x261)||_0x56bdbd[_0x3a241d(0x31d)]==_0x3a241d(0x39f))await logger[_0x3a241d(0x2d5)](_0x3a241d(0x307)+_0x2638da+')\x20|\x20Bot\x20'+_0x56bdbd[_0x3a241d(0x245)]+_0x3a241d(0x20c)+_0x56bdbd['botname']),startBot([_0x56bdbd['botID'],userID],{'cwd':bbpath},function(_0x4bb3d2){const _0x18c207=_0x3a241d;if(_0x4bb3d2)logger[_0x18c207(0x2d5)](_0x4bb3d2);});else(_0x56bdbd[_0x3a241d(0x31d)]==_0x3a241d(0x205)||_0x56bdbd[_0x3a241d(0x31d)]==_0x3a241d(0x33c))&&await logger[_0x3a241d(0x2d5)](_0x3a241d(0x22d)+_0x2638da+_0x3a241d(0x39d)+_0x56bdbd['botID']+_0x3a241d(0x20c)+_0x56bdbd[_0x3a241d(0x305)]);}else!newBot&&logger[_0x3a241d(0x2b6)](_0x3a241d(0x23c));if(newBot)addBot();logger['simple'](_0x3a241d(0x2f9)),logger['simple'](''),await logger['debug'](_0x3a241d(0x1ff)+nodeversion),await logger[_0x3a241d(0x2f6)](_0x3a241d(0x36b),_0x3270fc);}function startSocket(){io['on']('connection',_0x5955d5=>{const _0x214cde=_0x5607;let _0xdd81bc,_0x4dafa1,_0x6bede5,_0x594e93,_0x5e3a18;const _0x4f359d=_0x5955d5[_0x214cde(0x2d2)][_0x214cde(0x38d)][_0x214cde(0x296)];_0x4dafa1=_0x4f359d[_0x214cde(0x36a)](/bot[0-9]{3}/);if(_0x4dafa1)_0x6bede5=_0x4dafa1[0x0][_0x214cde(0x36a)](/[0-9]{3}/);if(_0x6bede5)_0xdd81bc=_0x6bede5[0x0];else _0xdd81bc=_0x214cde(0x3d7);const _0x27623b=_0x5955d5['handshake'][_0x214cde(0x2de)][_0x214cde(0x275)];if(!_0x27623b)_0x5955d5['emit'](_0x214cde(0x31d),{'publicKey':secure[_0x214cde(0x3d2)]});else{_0x594e93=timelyDecrypt(_0x27623b,![]);if(!_0x594e93)_0x5955d5['emit'](_0x214cde(0x31d),{'publicKey':secure[_0x214cde(0x3d2)]});else{_0x5e3a18=normalizeIP(_0x5955d5['conn'][_0x214cde(0x327)])[_0x214cde(0x39c)];if(!devices[_0x594e93])devices[_0x594e93]={'uuid':_0x594e93,'access':{'token':null}};devices[_0x594e93]['ip']=_0x5e3a18;const _0x156606=addClient(_0x5955d5['id'],_0x594e93,_0xdd81bc);setAccess(_0x156606),emitMessages(),_0x5955d5['on']('login',_0x671261=>{const _0x149951=_0x214cde,_0x104896=timelyDecrypt(_0x671261[_0x149951(0x241)],!![],_0x149951(0x243));if(_0x104896){_0x671261={'username':_0x671261[_0x149951(0x23d)],'password':_0x104896},devices[_0x594e93][_0x149951(0x360)]=validateCredentials(_0x671261,_0x594e93);if(devices[_0x594e93][_0x149951(0x360)][_0x149951(0x31a)]==![]&&devices[_0x594e93][_0x149951(0x360)][_0x149951(0x2c0)]==_0x149951(0x25d))_0x5955d5[_0x149951(0x332)](_0x149951(0x31d),{'access':devices[_0x594e93]['access']}),loginAccess2FA(_0x594e93,_0x5e3a18);else{if(devices[_0x594e93][_0x149951(0x360)][_0x149951(0x31a)]==![]&&devices[_0x594e93]['access'][_0x149951(0x2c0)]==_0x149951(0x2a9))_0x5955d5[_0x149951(0x332)](_0x149951(0x31d),{'access':devices[_0x594e93][_0x149951(0x360)]});else devices[_0x594e93][_0x149951(0x360)][_0x149951(0x31a)]&&devices[_0x594e93]['access']['reason']==_0x149951(0x3e5)&&(getClientsWithUuid(_0x594e93)[_0x149951(0x21a)](_0x56e6e7=>{setAccess(_0x56e6e7);}),logger['debug'](_0x149951(0x215)+_0x594e93['slice'](-0x8)),setTokenRefresh(_0x594e93),setSessionTimeout('login',_0x594e93));}}else logger[_0x149951(0x2d5)](_0x149951(0x316));}),_0x5955d5['on'](_0x214cde(0x2a5),()=>{resetPassword();}),_0x5955d5['on']('disconnect',_0x1e319c=>{removeClient(_0x5955d5['id']);}),_0xdd81bc==_0x214cde(0x3d7)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x30c6bc){const _0x10599e=_0x1bc878;if(_0x30c6bc!=_0x10599e(0x3d7)&&config[_0x10599e(0x3b9)]!=''){if(pid[_0x30c6bc])pid[_0x30c6bc]['send']({'function':_0x10599e(0x2a0),'args':null});}_0x30c6bc!=_0x10599e(0x3d7)&&broadcastToBots(_0x10599e(0x204),JSON[_0x10599e(0x392)](config));}function reloadBotManager(){const _0x80ea=_0x1bc878;getClientsWithBotID(_0x80ea(0x3d7))['forEach'](_0x2745cf=>{const _0x4a2c7d=_0x80ea;getSocket(_0x2745cf['id'])[_0x4a2c7d(0x332)](_0x4a2c7d(0x31d),{'access':{'allow':![],'reason':_0x4a2c7d(0x21e),'token':null}});});}function getSocket(_0x2b929a){const _0x6f4a54=_0x1bc878,_0x291ab4=io[_0x6f4a54(0x2ba)][_0x6f4a54(0x329)]('/');return _0x291ab4[_0x6f4a54(0x37f)][_0x6f4a54(0x329)](_0x2b929a);}function setAccess(_0x47bb42){const _0x4f1e7f=_0x1bc878,_0x4a5a02=getSocket(_0x47bb42['id']),_0x33cb7a=_0x47bb42[_0x4f1e7f(0x269)],_0x2aae9a=_0x47bb42[_0x4f1e7f(0x3ef)];devices[_0x33cb7a]['access']=validateAccess(devices[_0x33cb7a]['access'][_0x4f1e7f(0x3f2)],_0x33cb7a),logger[_0x4f1e7f(0x2f6)](_0x4f1e7f(0x295)+devices[_0x33cb7a][_0x4f1e7f(0x360)][_0x4f1e7f(0x2c0)]+_0x4f1e7f(0x22c)+_0x47bb42['id'][_0x4f1e7f(0x325)](-0x8)+_0x4f1e7f(0x1f4)+_0x33cb7a[_0x4f1e7f(0x325)](-0x8)),_0x4a5a02[_0x4f1e7f(0x2e3)](_0x33cb7a);if(devices[_0x33cb7a]['access'][_0x4f1e7f(0x31a)]){_0x4a5a02['join'](_0x2aae9a);if(_0x2aae9a==_0x4f1e7f(0x3d7))initializeSocketBotManager(_0x4a5a02);else initializeSocketBot(_0x4a5a02);initClient(_0x2aae9a);}devices[_0x33cb7a][_0x4f1e7f(0x360)]['token']&&devices[_0x33cb7a][_0x4f1e7f(0x360)][_0x4f1e7f(0x2c0)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x4f1e7f(0x27b),_0x33cb7a),devices[_0x33cb7a][_0x4f1e7f(0x360)][_0x4f1e7f(0x3f2)]&&devices[_0x33cb7a][_0x4f1e7f(0x360)][_0x4f1e7f(0x2c0)]==_0x4f1e7f(0x3ff)&&setSessionTimeout(_0x4f1e7f(0x267),_0x33cb7a),_0x4a5a02[_0x4f1e7f(0x332)](_0x4f1e7f(0x31d),{'status':_0x47bb42[_0x4f1e7f(0x34b)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x33cb7a][_0x4f1e7f(0x360)],'externalip':devices[_0x33cb7a]['ip'],'publicKey':secure[_0x4f1e7f(0x3d2)],'userid':settings[_0x4f1e7f(0x224)],'validInstallation':validInstallation}),devices[_0x33cb7a]['access'][_0x4f1e7f(0x31a)]==![]&&devices[_0x33cb7a][_0x4f1e7f(0x360)][_0x4f1e7f(0x2c0)]=='2FA\x20required'&&temporaryAccess2FA(_0x33cb7a,devices[_0x33cb7a]['ip']);}function setSessionTimeout(_0x38f9da,_0x3d7b20){const _0x1b92d6=_0x1bc878;let _0x206541;if(_0x38f9da==_0x1b92d6(0x267))_0x206541=loginExpiry*0x3c*0x3e8;else _0x206541=devices[_0x3d7b20][_0x1b92d6(0x29e)]['expiry']*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x3d7b20][_0x1b92d6(0x29e)]['timestamp']);if(devices[_0x3d7b20]['pidExpireLogin'])clearTimeout(devices[_0x3d7b20][_0x1b92d6(0x3c6)]);devices[_0x3d7b20][_0x1b92d6(0x3c6)]=setTimeout(()=>{const _0x24fc4a=_0x1b92d6;if(devices[_0x3d7b20][_0x24fc4a(0x1f8)])clearTimeout(devices[_0x3d7b20][_0x24fc4a(0x1f8)]);removeSocketListeners(_0x3d7b20),addBlacklist(_0x3d7b20),devices[_0x3d7b20][_0x24fc4a(0x29e)]=null,devices[_0x3d7b20][_0x24fc4a(0x2a2)]=null,devices[_0x3d7b20][_0x24fc4a(0x360)][_0x24fc4a(0x3f2)]=null,logger[_0x24fc4a(0x2f6)](_0x24fc4a(0x27f)+_0x3d7b20[_0x24fc4a(0x325)](-0x8)),devices[_0x3d7b20]['access']=validateAccess(devices[_0x3d7b20][_0x24fc4a(0x360)]['token'],_0x3d7b20),!(devices[_0x3d7b20][_0x24fc4a(0x360)][_0x24fc4a(0x31a)]&&devices[_0x3d7b20]['access'][_0x24fc4a(0x2c0)]==_0x24fc4a(0x2ad))&&(_0x38f9da==_0x24fc4a(0x267)?io['to'](_0x3d7b20)[_0x24fc4a(0x332)](_0x24fc4a(0x31d),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x3d7b20)[_0x24fc4a(0x332)](_0x24fc4a(0x31d),{'access':{'allow':![],'reason':_0x24fc4a(0x3b7),'token':null}})),devices[_0x3d7b20][_0x24fc4a(0x360)][_0x24fc4a(0x3f2)]=null;},_0x206541);}function setTokenRefresh(_0x835cb6){const _0x1bce1f=_0x1bc878;if(devices[_0x835cb6][_0x1bce1f(0x1f8)])clearTimeout(devices[_0x835cb6][_0x1bce1f(0x1f8)]);devices[_0x835cb6][_0x1bce1f(0x1f8)]=setTimeout(()=>{const _0x8877ee=_0x1bce1f;getClientsWithUuid(_0x835cb6)[_0x8877ee(0x344)]!=0x0?(devices[_0x835cb6]['access']=refreshToken(_0x835cb6),io['to'](_0x835cb6)[_0x8877ee(0x332)](_0x8877ee(0x31d),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x835cb6]['access'],'externalip':devices[_0x835cb6]['ip'],'publicKey':secure[_0x8877ee(0x3d2)],'validInstallation':validInstallation}),setTokenRefresh(_0x835cb6)):clearTimeout(devices[_0x835cb6]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5bbb77){const _0x18597=_0x1bc878,_0x221d2a=getClient(_0x5bbb77['id'])[_0x18597(0x269)];_0x5bbb77['emit']('bots',config),_0x5bbb77[_0x18597(0x332)]('settings',cleanSettings()),_0x5bbb77['on'](_0x18597(0x33e),_0x438123=>{const _0x2d7ecf=_0x18597;if(validateAccess(_0x438123,_0x221d2a)['allow'])addBot();else logger[_0x2d7ecf(0x2d5)](_0x2d7ecf(0x34c));}),_0x5bbb77['on'](_0x18597(0x394),(_0x55ffb0,_0x52cf8b)=>{const _0x4e797f=_0x18597;if(validateAccess(_0x52cf8b,_0x221d2a)[_0x4e797f(0x31a)])toggleBot(_0x55ffb0[_0x4e797f(0x245)],_0x55ffb0[_0x4e797f(0x31d)],_0x55ffb0[_0x4e797f(0x361)]);else logger[_0x4e797f(0x2d5)](_0x4e797f(0x34f));}),_0x5bbb77['on'](_0x18597(0x30b),(_0x4281a9,_0x5b6aa3)=>{const _0x14134f=_0x18597;if(validateAccess(_0x5b6aa3,_0x221d2a)['allow'])toggleBotMode(_0x4281a9);else logger[_0x14134f(0x2d5)](_0x14134f(0x34f));}),_0x5bbb77['on'](_0x18597(0x3b5),(_0x3d0ed4,_0x303057)=>{const _0x5b4ec9=_0x18597;if(validateAccess(_0x303057,_0x221d2a)['allow'])deleteBot(_0x3d0ed4);else logger[_0x5b4ec9(0x2d5)](_0x5b4ec9(0x1f0));}),_0x5bbb77['on'](_0x18597(0x2f8),(_0x49b790,_0x55173e)=>{const _0x5553ac=_0x18597;if(validateAccess(_0x55173e,_0x221d2a)[_0x5553ac(0x31a)])storeSettings(_0x49b790,!![]);else logger['full'](_0x5553ac(0x25a));}),_0x5bbb77['on'](_0x18597(0x364),_0x193f18=>{const _0x36442a=_0x18597;if(validateAccess(_0x193f18,_0x221d2a)[_0x36442a(0x31a)])updateBB(_0x36442a(0x29a));else logger[_0x36442a(0x2d5)](_0x36442a(0x30a));}),_0x5bbb77['on']('reinstall-bb',_0x2f3bd2=>{const _0x461fde=_0x18597;if(validateAccess(_0x2f3bd2,_0x221d2a)[_0x461fde(0x31a)])updateBB(_0x461fde(0x237));else logger[_0x461fde(0x2d5)](_0x461fde(0x258));}),_0x5bbb77['on']('get-backup-files',_0x400c3f=>{const _0x2b67b1=_0x18597;if(validateAccess(_0x400c3f,_0x221d2a)['allow']){const _0x4f6c1c=getClient(_0x5bbb77['id']);if(_0x4f6c1c)getBackupFiles(_0x4f6c1c[_0x2b67b1(0x269)]);else logger[_0x2b67b1(0x2d5)](_0x2b67b1(0x2c3));}else logger[_0x2b67b1(0x2d5)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x5bbb77['on'](_0x18597(0x2d0),(_0x3df900,_0xc2dbf4)=>{const _0x13c863=_0x18597;if(validateAccess(_0xc2dbf4,_0x221d2a)[_0x13c863(0x31a)])restoreBackupFile(_0x3df900);else logger[_0x13c863(0x2d5)](_0x13c863(0x2dd));}),_0x5bbb77['on'](_0x18597(0x2b5),_0x5e1b0d=>{const _0x5cb4cf=_0x18597;if(validateAccess(_0x5e1b0d,_0x221d2a)[_0x5cb4cf(0x31a)])getMessages();else logger['full'](_0x5cb4cf(0x320));}),_0x5bbb77['on'](_0x18597(0x33d),(_0x498a98,_0x18b1fc)=>{const _0x4d1864=_0x18597;if(validateAccess(_0x18b1fc,_0x221d2a)[_0x4d1864(0x31a)])confirmMessage(_0x498a98);else logger[_0x4d1864(0x2d5)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x5bbb77['on'](_0x18597(0x2c8),_0x31abfc=>{const _0x1f8932=_0x18597;if(validateAccess(_0x31abfc,_0x221d2a)[_0x1f8932(0x31a)]){if(devices[_0x221d2a][_0x1f8932(0x1f8)])clearTimeout(devices[_0x221d2a]['pidRefreshToken']);if(devices[_0x221d2a]['pidExpireLogin'])clearTimeout(devices[_0x221d2a][_0x1f8932(0x3c6)]);removeSocketListeners(getClient(_0x5bbb77['id'])[_0x1f8932(0x269)]),addBlacklist(_0x221d2a),devices[_0x221d2a][_0x1f8932(0x29e)]=null,devices[_0x221d2a][_0x1f8932(0x2a2)]=null,devices[_0x221d2a][_0x1f8932(0x360)][_0x1f8932(0x3f2)]=null,logger['debug'](_0x1f8932(0x3bd)+_0x221d2a[_0x1f8932(0x325)](-0x8)),io['to'](getClient(_0x5bbb77['id'])['uuid'])['emit'](_0x1f8932(0x31d),{'access':{'allow':![],'reason':_0x1f8932(0x2f0),'token':null}});}else logger[_0x1f8932(0x2d5)](_0x1f8932(0x1e6));});}function initializeSocketBot(_0x12f47e){const _0x4c5a72=_0x1bc878,_0x1d3beb=getClient(_0x12f47e['id'])['bot'],_0x1a2974=getClient(_0x12f47e['id'])[_0x4c5a72(0x269)];_0x12f47e['on'](_0x4c5a72(0x21c),(_0x59640d,_0x2f83ca)=>{const _0x3047a2=_0x4c5a72;if(validateAccess(_0x2f83ca,_0x1a2974)['allow']){if(pid[_0x1d3beb])pid[_0x1d3beb]['send']({'function':_0x3047a2(0x2a3),'args':_0x59640d});}else logger[_0x3047a2(0x2d5)](_0x3047a2(0x214));}),_0x12f47e['on'](_0x4c5a72(0x23e),(_0x1a157d,_0x36fe04)=>{const _0x27f393=_0x4c5a72;if(validateAccess(_0x36fe04,_0x1a2974)[_0x27f393(0x31a)]){if(pid[_0x1d3beb])pid[_0x1d3beb]['send']({'function':_0x27f393(0x37d),'args':_0x1a157d});}else logger['full'](_0x27f393(0x28b));}),_0x12f47e['on'](_0x4c5a72(0x20f),(_0x5438a2,_0x3c5526)=>{const _0x4a7fb0=_0x4c5a72;if(validateAccess(_0x3c5526,_0x1a2974)[_0x4a7fb0(0x31a)]){if(pid[_0x1d3beb])pid[_0x1d3beb][_0x4a7fb0(0x279)]({'function':'getPortfolio','args':_0x5438a2});}else logger['full'](_0x4a7fb0(0x3ed));}),_0x12f47e['on'](_0x4c5a72(0x283),(_0x2b477e,_0x2b0743)=>{const _0x426e62=_0x4c5a72;if(validateAccess(_0x2b0743,_0x1a2974)[_0x426e62(0x31a)]){if(pid[_0x1d3beb])pid[_0x1d3beb][_0x426e62(0x279)]({'function':_0x426e62(0x270),'args':_0x2b477e});}else logger[_0x426e62(0x2d5)](_0x426e62(0x3c7));}),_0x12f47e['on'](_0x4c5a72(0x3a4),(_0x30d36a,_0x4ec3b0)=>{const _0x333185=_0x4c5a72;if(validateAccess(_0x4ec3b0,_0x1a2974)[_0x333185(0x31a)]){if(pid[_0x1d3beb])pid[_0x1d3beb][_0x333185(0x279)]({'function':_0x333185(0x36e),'args':_0x30d36a});}else logger[_0x333185(0x2d5)](_0x333185(0x3eb));}),_0x12f47e['on']('store-fiat',(_0xa476d,_0x452d7d)=>{const _0x3bb315=_0x4c5a72;if(validateAccess(_0x452d7d,_0x1a2974)['allow']){if(pid[_0x1d3beb])pid[_0x1d3beb][_0x3bb315(0x279)]({'function':_0x3bb315(0x220),'args':_0xa476d});}else logger[_0x3bb315(0x2d5)](_0x3bb315(0x1e1));}),_0x12f47e['on'](_0x4c5a72(0x2e9),_0x5856a8=>{const _0x4fdc73=_0x4c5a72;if(validateAccess(_0x5856a8,_0x1a2974)['allow']){if(pid[_0x1d3beb])pid[_0x1d3beb][_0x4fdc73(0x279)]({'function':'resetHistory','args':null});}else logger[_0x4fdc73(0x2d5)](_0x4fdc73(0x313));}),_0x12f47e['on']('get-starting-balances',_0x57e782=>{const _0x2aa683=_0x4c5a72;if(validateAccess(_0x57e782,_0x1a2974)[_0x2aa683(0x31a)]){if(pid[_0x1d3beb])pid[_0x1d3beb][_0x2aa683(0x279)]({'function':_0x2aa683(0x3b0),'args':null});}else logger[_0x2aa683(0x2d5)](_0x2aa683(0x3a6));}),_0x12f47e['on'](_0x4c5a72(0x333),(_0x1852fe,_0x301340)=>{const _0x30ed20=_0x4c5a72;if(validateAccess(_0x301340,_0x1a2974)[_0x30ed20(0x31a)]){if(pid[_0x1d3beb])pid[_0x1d3beb]['send']({'function':'placeOrder','args':_0x1852fe});}else logger[_0x30ed20(0x2d5)](_0x30ed20(0x27e));}),_0x12f47e['on']('cancel-loading',_0x33135e=>{const _0x15fc2e=_0x4c5a72;if(validateAccess(_0x33135e,_0x1a2974)[_0x15fc2e(0x31a)]){if(pid[_0x1d3beb])pid[_0x1d3beb][_0x15fc2e(0x279)]({'function':_0x15fc2e(0x213),'args':null});}else logger[_0x15fc2e(0x2d5)](_0x15fc2e(0x2ae));}),_0x12f47e['on'](_0x4c5a72(0x3a8),_0x5316fb=>{const _0x55bba3=_0x4c5a72;if(validateAccess(_0x5316fb,_0x1a2974)[_0x55bba3(0x31a)]){if(pid[_0x1d3beb])pid[_0x1d3beb][_0x55bba3(0x279)]({'function':_0x55bba3(0x22e),'args':null});}else logger['full'](_0x55bba3(0x3cb));}),_0x12f47e['on'](_0x4c5a72(0x364),_0x44a64b=>{const _0x71c2be=_0x4c5a72;if(validateAccess(_0x44a64b,_0x1a2974)[_0x71c2be(0x31a)])updateBB(_0x71c2be(0x29a));else logger[_0x71c2be(0x2d5)](_0x71c2be(0x30a));}),_0x12f47e['on'](_0x4c5a72(0x2b5),_0x2306e6=>{const _0x3b1c66=_0x4c5a72;if(validateAccess(_0x2306e6,_0x1a2974)[_0x3b1c66(0x31a)])getMessages();else logger[_0x3b1c66(0x2d5)](_0x3b1c66(0x320));}),_0x12f47e['on'](_0x4c5a72(0x33d),(_0x24be85,_0xf09f23)=>{const _0x4112fe=_0x4c5a72;if(validateAccess(_0xf09f23,_0x1a2974)[_0x4112fe(0x31a)])confirmMessage(_0x24be85);else logger[_0x4112fe(0x2d5)](_0x4112fe(0x396));}),_0x12f47e['on'](_0x4c5a72(0x2c8),_0x1383f7=>{const _0x35988a=_0x4c5a72;if(validateAccess(_0x1383f7,_0x1a2974)[_0x35988a(0x31a)]){if(devices[_0x1a2974][_0x35988a(0x1f8)])clearTimeout(devices[_0x1a2974][_0x35988a(0x1f8)]);if(devices[_0x1a2974][_0x35988a(0x3c6)])clearTimeout(devices[_0x1a2974][_0x35988a(0x3c6)]);removeSocketListeners(getClient(_0x12f47e['id'])[_0x35988a(0x269)]),addBlacklist(_0x1a2974),devices[_0x1a2974][_0x35988a(0x29e)]=null,devices[_0x1a2974]['telegram2FaApproval']=null,devices[_0x1a2974][_0x35988a(0x360)][_0x35988a(0x3f2)]=null,logger[_0x35988a(0x2f6)](_0x35988a(0x3bd)+_0x1a2974[_0x35988a(0x325)](-0x8)),io['to'](getClient(_0x12f47e['id'])[_0x35988a(0x269)])[_0x35988a(0x332)](_0x35988a(0x31d),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x35988a(0x2d5)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x8ed39f){const _0x570181=_0x1bc878;getClientsWithUuid(_0x8ed39f)[_0x570181(0x21a)](_0x59d89e=>{const _0x684104=_0x570181;getSocket(_0x59d89e['id'])[_0x684104(0x1fc)]();});}function cleanSettings(){const _0x28014f=_0x1bc878;let _0x166336=settings;return settings[_0x28014f(0x290)]&&settings[_0x28014f(0x290)]!=''&&(_0x166336={..._0x166336,'telegramToken':_0x28014f(0x331)}),settings[_0x28014f(0x357)]&&settings[_0x28014f(0x357)]!=''&&(_0x166336={..._0x166336,'bbPassword':'************'}),settings[_0x28014f(0x395)]&&settings[_0x28014f(0x395)]!=''&&(_0x166336={..._0x166336,'marketcapApi':'************'}),(settings[_0x28014f(0x357)]&&settings['bbPassword']==_0x28014f(0x31b)||settings[_0x28014f(0x290)]&&settings[_0x28014f(0x290)]==_0x28014f(0x31b)||settings[_0x28014f(0x395)]&&settings[_0x28014f(0x395)]==_0x28014f(0x31b))&&(_0x166336={..._0x166336,'restored':{'password':settings[_0x28014f(0x357)]=='***','telegram':settings['telegramToken']==_0x28014f(0x31b),'marketcap':settings[_0x28014f(0x395)]==_0x28014f(0x31b)}}),_0x166336;}async function updateBB(_0x319246){const _0x285d8a=_0x1bc878;await backupConfigFiles(),installingUpdate=!![],config[_0x285d8a(0x21a)](_0x2dfb51=>{restartBot(_0x2dfb51['botID']);});if(_0x319246==_0x285d8a(0x29a))process[_0x285d8a(0x279)]({'update':!![],'environment':environment},_0x23311a=>{});else _0x319246==_0x285d8a(0x237)&&process[_0x285d8a(0x279)]({'reinstall':!![],'environment':environment},_0xd6b715=>{});}function startBot(_0xc8f5d3,_0x2e9372,_0x34fdb9){const _0x2e08a6=_0x1bc878;if(debugging)_0xc8f5d3[_0x2e08a6(0x389)]('-d');let _0x26a7d1=![];const _0x3fb61b=_0xc8f5d3[0x0];_0x2e9372={..._0x2e9372,'stdio':[_0x2e08a6(0x352),_0x2e08a6(0x352),_0x2e08a6(0x352),_0x2e08a6(0x227)]},pid[_0x3fb61b]=childProcess[_0x2e08a6(0x304)](botfile,_0xc8f5d3,_0x2e9372),pid[_0x3fb61b]['on'](_0x2e08a6(0x3fc),_0x5f3de9=>{const _0x3be5e8=_0x2e08a6;switch(Object[_0x3be5e8(0x386)](_0x5f3de9)[0x0]){case _0x3be5e8(0x305):updateBotName(_0x3fb61b,_0x5f3de9[_0x3be5e8(0x305)]);break;case _0x3be5e8(0x340):updateBotManager();break;case _0x3be5e8(0x31d):updateStatus(_0x3fb61b,_0x5f3de9['status']);break;case _0x3be5e8(0x361):updateLive(_0x3fb61b,_0x5f3de9[_0x3be5e8(0x361)]);break;case _0x3be5e8(0x2fa):updateLive(_0x3fb61b,_0x5f3de9['started']),io['to'](_0x3fb61b)[_0x3be5e8(0x332)](_0x3be5e8(0x31d),{'access':{'allow':![],'reason':_0x3be5e8(0x21e),'token':null}});break;case'stop':_0x5f3de9['stop']==_0x3be5e8(0x358)&&restartBot(_0x3fb61b);_0x5f3de9['stop']==_0x3be5e8(0x3ee)&&toggleBot(_0x3fb61b,_0x3be5e8(0x205),_0x3be5e8(0x36c));break;case _0x3be5e8(0x330):sendTelegramBot(_0x3fb61b,_0x5f3de9[_0x3be5e8(0x330)]);break;case _0x3be5e8(0x387):sendTelegramMsg(_0x5f3de9[_0x3be5e8(0x387)]);break;case _0x3be5e8(0x3f0):io['to'](_0x3fb61b)[_0x3be5e8(0x332)](_0x5f3de9['function'],_0x5f3de9['args']);break;}}),pid[_0x3fb61b]['on'](_0x2e08a6(0x2cf),function(_0xadf0a6){if(_0x26a7d1)return;_0x26a7d1=!![],_0x34fdb9(_0xadf0a6);}),pid[_0x3fb61b]['on'](_0x2e08a6(0x212),async function(_0x4d1782){const _0x3afa55=_0x2e08a6;if(terminating)return;if(installingUpdate){io[_0x3afa55(0x285)]();return;}if(_0x26a7d1)return;_0x26a7d1=!![],_0x34fdb9(null);const _0x3dfa8b=dbConfig['get']('bots')[_0x3afa55(0x2ab)]({'botID':_0x3fb61b})[_0x3afa55(0x2cd)]();_0x3dfa8b&&(_0x3dfa8b[_0x3afa55(0x31d)]==_0x3afa55(0x261)||_0x3dfa8b[_0x3afa55(0x31d)]=='new')&&(await sleep(0x3e8),updateLive(_0x3fb61b,_0x3afa55(0x36c)),logger['full']('Restarting\x20Bot\x20'+_0x3fb61b),startBot([_0x3fb61b,userID],{'cwd':bbpath},function(_0x17d752){if(_0x17d752)logger['full'](_0x17d752);}));});}function stopBot(_0x158628){const _0x349ca0=_0x1bc878;getClientsWithBotID(_0x158628)['forEach'](_0x9f80ed=>{const _0x1ab092=_0x5607;getSocket(_0x9f80ed['id'])[_0x1ab092(0x216)](!![]),removeClient(_0x9f80ed['id']);}),pid[_0x158628]&&(pid[_0x158628][_0x349ca0(0x3ee)](),pid[_0x158628]=null);}function stopAllBots(){const _0x41fb7b=_0x1bc878;terminating=!![];const _0x42227b=getEnabledBots();_0x42227b[_0x41fb7b(0x21a)](_0x5df6f3=>{const _0x6f612c=_0x41fb7b;stopBot(_0x5df6f3[_0x6f612c(0x245)]);});}function restartBot(_0x5400c2){if(pid[_0x5400c2])pid[_0x5400c2]['kill']();}function addBot(){const _0x149368=_0x1bc878;let _0x57cd5e;for(let _0x10e348=0x1;_0x10e348<0x3e9;_0x10e348++){_0x57cd5e=_0x10e348['toString']()['padStart'](0x3,'0');let _0x201d1f=config[_0x149368(0x2ab)](_0xdbea19=>_0xdbea19[_0x149368(0x245)]==_0x57cd5e);if(!_0x201d1f)break;}if(_0x57cd5e===_0x149368(0x30f)){logger['full'](_0x149368(0x3d5));return;}logger[_0x149368(0x2d5)](_0x149368(0x23a)+_0x57cd5e),dbConfig[_0x149368(0x329)](_0x149368(0x204))['push']({'botID':_0x57cd5e,'botname':_0x149368(0x1f2)+_0x57cd5e,'status':_0x149368(0x39f),'live':''})[_0x149368(0x374)](),startBot([_0x57cd5e,userID],{'cwd':bbpath},function(_0x1f455e){const _0x28a30b=_0x149368;if(_0x1f455e)logger[_0x28a30b(0x2d5)](_0x1f455e);}),config=getConfiguration(),io['to'](_0x149368(0x3d7))[_0x149368(0x332)](_0x149368(0x204),config),broadcastToBots(_0x149368(0x204),JSON['stringify'](config));}function deleteBot(_0x20b6b1){const _0x44dbb5=_0x1bc878;getClientsWithBotID(_0x20b6b1)[_0x44dbb5(0x21a)](_0x24303a=>{const _0x1aba55=_0x44dbb5;getSocket(_0x24303a['id'])[_0x1aba55(0x216)](!![]),removeClient(_0x24303a['id']);}),dbConfig[_0x44dbb5(0x329)](_0x44dbb5(0x204))[_0x44dbb5(0x2b3)]({'botID':_0x20b6b1})[_0x44dbb5(0x374)](),logger[_0x44dbb5(0x2d5)](_0x44dbb5(0x390)+_0x20b6b1),stopBot(_0x20b6b1);try{if(fs[_0x44dbb5(0x1de)](path[_0x44dbb5(0x2e3)](configpath,_0x44dbb5(0x25e)+_0x20b6b1+_0x44dbb5(0x288))))fs['unlinkSync'](path[_0x44dbb5(0x2e3)](configpath,_0x44dbb5(0x25e)+_0x20b6b1+_0x44dbb5(0x288)));if(fs[_0x44dbb5(0x1de)](path[_0x44dbb5(0x2e3)](configpath,_0x44dbb5(0x25e)+_0x20b6b1+_0x44dbb5(0x242))))fs[_0x44dbb5(0x310)](path[_0x44dbb5(0x2e3)](configpath,_0x44dbb5(0x25e)+_0x20b6b1+_0x44dbb5(0x242)));if(fs[_0x44dbb5(0x1de)](path['join'](configpath,_0x44dbb5(0x25e)+_0x20b6b1+_0x44dbb5(0x201))))fs['unlinkSync'](path[_0x44dbb5(0x2e3)](configpath,_0x44dbb5(0x25e)+_0x20b6b1+'-performance.json'));if(fs['existsSync'](path[_0x44dbb5(0x2e3)](configpath,_0x44dbb5(0x25e)+_0x20b6b1+'-results.json')))fs[_0x44dbb5(0x310)](path[_0x44dbb5(0x2e3)](configpath,_0x44dbb5(0x25e)+_0x20b6b1+_0x44dbb5(0x29f)));}catch(_0x927c18){if(_0x927c18)logger[_0x44dbb5(0x2d5)](_0x44dbb5(0x3f6),_0x927c18);}config=getConfiguration(),io['to'](_0x44dbb5(0x3d7))[_0x44dbb5(0x332)]('bots',config),broadcastToBots(_0x44dbb5(0x204),JSON[_0x44dbb5(0x392)](config));}function toggleBot(_0x1d9ebc,_0x66b9d4,_0x21abd6){const _0x20f18f=_0x1bc878;dbConfig[_0x20f18f(0x329)]('bots')[_0x20f18f(0x2ab)]({'botID':_0x1d9ebc})[_0x20f18f(0x2e6)]({'status':_0x66b9d4})[_0x20f18f(0x2e6)]({'live':_0x21abd6})[_0x20f18f(0x374)]();if(_0x66b9d4==_0x20f18f(0x261)||_0x66b9d4==_0x20f18f(0x39f))logger[_0x20f18f(0x2d5)]('Enabled\x20Bot\x20'+_0x1d9ebc),startBot([_0x1d9ebc,userID],{'cwd':bbpath},function(_0x4c145d){const _0x22653d=_0x20f18f;if(_0x4c145d)logger[_0x22653d(0x2d5)](_0x4c145d);});else(_0x66b9d4==_0x20f18f(0x205)||_0x66b9d4==_0x20f18f(0x33c))&&(logger[_0x20f18f(0x2d5)](_0x20f18f(0x35a)+_0x1d9ebc),stopBot(_0x1d9ebc));config=getConfiguration(),io['to']('botmanager')[_0x20f18f(0x332)](_0x20f18f(0x204),config),broadcastToBots(_0x20f18f(0x204),JSON[_0x20f18f(0x392)](config));}function toggleStatus(_0x36289b){const _0x3539b1=_0x1bc878;let _0x32efa0=dbConfig[_0x3539b1(0x329)](_0x3539b1(0x204))[_0x3539b1(0x2ab)]({'botID':_0x36289b})[_0x3539b1(0x2cd)](),_0x5060fb;if(_0x32efa0[_0x3539b1(0x31d)]===_0x3539b1(0x261))_0x5060fb='disabled';else{if(_0x32efa0[_0x3539b1(0x31d)]===_0x3539b1(0x39f))_0x5060fb=_0x3539b1(0x33c);else{if(_0x32efa0['status']===_0x3539b1(0x33c))_0x5060fb='new';else{if(_0x32efa0['status']===_0x3539b1(0x205))_0x5060fb='enabled';}}}return _0x5060fb;}function updateStatus(_0x299714,_0x52ff7c){const _0x19de1c=_0x1bc878;dbConfig[_0x19de1c(0x329)](_0x19de1c(0x204))[_0x19de1c(0x2ab)]({'botID':_0x299714})[_0x19de1c(0x2e6)]({'status':_0x52ff7c})['write'](),config=getConfiguration(),io['to'](_0x19de1c(0x3d7))['emit'](_0x19de1c(0x204),config),broadcastToBots('bots',JSON[_0x19de1c(0x392)](config));}function updateLive(_0x2fcb8c,_0x2c216d){const _0x27eedd=_0x1bc878;dbConfig[_0x27eedd(0x329)](_0x27eedd(0x204))[_0x27eedd(0x2ab)]({'botID':_0x2fcb8c})[_0x27eedd(0x2e6)]({'live':_0x2c216d})[_0x27eedd(0x374)](),config=getConfiguration(),io['to'](_0x27eedd(0x3d7))[_0x27eedd(0x332)](_0x27eedd(0x204),config),broadcastToBots('bots',JSON[_0x27eedd(0x392)](config));}function updateBotName(_0x3d7ae0,_0x4dc246){const _0x3ddbda=_0x1bc878;dbConfig['get'](_0x3ddbda(0x204))[_0x3ddbda(0x2ab)]({'botID':_0x3d7ae0})[_0x3ddbda(0x2e6)]({'botname':_0x4dc246})[_0x3ddbda(0x374)](),config=getConfiguration(),io['to'](_0x3ddbda(0x3d7))['emit'](_0x3ddbda(0x204),config),broadcastToBots(_0x3ddbda(0x204),JSON['stringify'](config));}function updateBotManager(){const _0x1afaae=_0x1bc878;config=getConfiguration(),io['to'](_0x1afaae(0x3d7))[_0x1afaae(0x332)](_0x1afaae(0x204),config),broadcastToBots(_0x1afaae(0x204),JSON[_0x1afaae(0x392)](config));}function toggleBotMode(_0x4b7500){const _0x592f9e=_0x1bc878;if(pid[_0x4b7500])pid[_0x4b7500][_0x592f9e(0x279)]({'function':_0x592f9e(0x348),'args':null});else{const _0xbd9e2d=configpath+'bot-'+_0x4b7500+_0x592f9e(0x288),_0x2a7df8=fs[_0x592f9e(0x31f)](_0xbd9e2d),_0xdf8502=JSON['parse'](_0x2a7df8),_0x2e2da4=_0xdf8502[_0x592f9e(0x3ef)][0x0][_0x592f9e(0x20b)];_0xdf8502[_0x592f9e(0x3ef)][0x0][_0x592f9e(0x20b)]=!_0x2e2da4;const _0x390a80=JSON['stringify'](_0xdf8502,null,0x2);fs['writeFileSync'](_0xbd9e2d,_0x390a80),config=getConfiguration(),io['to'](_0x592f9e(0x3d7))[_0x592f9e(0x332)](_0x592f9e(0x204),config),broadcastToBots(_0x592f9e(0x204),JSON[_0x592f9e(0x392)](config));}}function validateTelegram(_0x14df7f){const _0x3ac922=_0x1bc878;if(_0x14df7f['from'][_0x3ac922(0x23d)]!=settings['telegramUsername']&&'@'+_0x14df7f[_0x3ac922(0x246)][_0x3ac922(0x23d)]!=settings['telegramUsername']||_0x14df7f[_0x3ac922(0x3a9)]['id']!=settings[_0x3ac922(0x253)])return sendTelegram(_0x14df7f[_0x3ac922(0x3a9)]['id'],_0x3ac922(0x36d),{'parse_mode':_0x3ac922(0x209)}),![];return!![];}async function initTelegram(){const _0x5ea94b=_0x1bc878;tgBot&&(await tgBot[_0x5ea94b(0x2a8)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x5ea94b(0x290)]);let _0x206bcc='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x206bcc+='\x0a',_0x206bcc+=_0x5ea94b(0x3a7),_0x206bcc+=_0x5ea94b(0x25f),_0x206bcc+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x206bcc+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x206bcc+=_0x5ea94b(0x274),_0x206bcc+=_0x5ea94b(0x1ef),_0x206bcc+=_0x5ea94b(0x1fb),_0x206bcc+='/names\x20-\x20show\x20bot\x20names\x0a',_0x206bcc+=_0x5ea94b(0x2bb),_0x206bcc+=_0x5ea94b(0x276),_0x206bcc+=_0x5ea94b(0x221),_0x206bcc+=_0x5ea94b(0x33a),_0x206bcc+=_0x5ea94b(0x35e),_0x206bcc+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x206bcc+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x206bcc+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x15910f=_0x5ea94b(0x3d0);_0x15910f+='\x0a',_0x15910f+=_0x206bcc,tgBot[_0x5ea94b(0x2c1)]((_0x5082b2,_0x1ae74a)=>{const _0x50a035=_0x5ea94b;logger['simple'](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger[_0x50a035(0x2f6)](_0x50a035(0x3cd),_0x5082b2);}),tgBot[_0x5ea94b(0x30e)](async(_0x15aaf0,_0x46b9b7)=>{const _0x57bbd5=_0x5ea94b;if(!(!settings[_0x57bbd5(0x253)]&&_0x15aaf0[_0x57bbd5(0x29a)][_0x57bbd5(0x3fc)]['text']==_0x57bbd5(0x280))){if(!validateTelegram(_0x15aaf0))return;}_0x46b9b7();}),tgBot['command'](_0x5ea94b(0x3f4),async _0xe600bb=>{const _0x5ca67a=_0x5ea94b;if(_0xe600bb[_0x5ca67a(0x246)][_0x5ca67a(0x23d)]==settings[_0x5ca67a(0x2d4)]||'@'+_0xe600bb['from'][_0x5ca67a(0x23d)]==settings['telegramUsername']){if(!settings[_0x5ca67a(0x253)])updateSetting('telegramChatId',_0xe600bb[_0x5ca67a(0x3a9)]['id']);}if(!validateTelegram(_0xe600bb))return;updateSetting(_0x5ca67a(0x2f5),!![]),await sendTelegram(_0xe600bb[_0x5ca67a(0x3a9)]['id'],_0x15910f);}),tgBot[_0x5ea94b(0x2d3)](_0x5ea94b(0x1df),async _0x8adcea=>{const _0xf3e15e=_0x5ea94b;updateSetting(_0xf3e15e(0x2f5),!![]),await sendTelegram(_0x8adcea['chat']['id'],'Notifications\x20enabled');}),tgBot[_0x5ea94b(0x2d3)](_0x5ea94b(0x2ee),async _0x52693a=>{const _0x181fc4=_0x5ea94b;await sendTelegram(_0x52693a[_0x181fc4(0x3a9)]['id'],_0x181fc4(0x26d)),updateSetting('telegramEnabled',![]);}),tgBot[_0x5ea94b(0x2d3)](_0x5ea94b(0x226),async _0x31bbcf=>{const _0x39d1ab=_0x5ea94b,_0x1ce700=Markup[_0x39d1ab(0x252)]([Markup[_0x39d1ab(0x2dc)][_0x39d1ab(0x32d)]('Orders','config_orders'),Markup[_0x39d1ab(0x2dc)]['callback'](_0x39d1ab(0x2f1),'config_alerts'),Markup[_0x39d1ab(0x2dc)][_0x39d1ab(0x32d)]('All',_0x39d1ab(0x3aa))]);_0x31bbcf[_0x39d1ab(0x228)](_0x39d1ab(0x317),_0x1ce700);}),tgBot['action'](_0x5ea94b(0x2d9),async _0x1f0dc9=>{const _0x2bacd7=_0x5ea94b;_0x1f0dc9['editMessageReplyMarkup'](),updateSetting('telegramEvents',_0x2bacd7(0x338)),updateSetting(_0x2bacd7(0x2f5),!![]),await sendTelegram(_0x1f0dc9[_0x2bacd7(0x3a9)]['id'],_0x2bacd7(0x2e4));}),tgBot['action'](_0x5ea94b(0x207),async _0x450d8d=>{const _0x4ddc97=_0x5ea94b;_0x450d8d['editMessageReplyMarkup'](),updateSetting(_0x4ddc97(0x3ca),_0x4ddc97(0x225)),updateSetting(_0x4ddc97(0x2f5),!![]),await sendTelegram(_0x450d8d['chat']['id'],_0x4ddc97(0x35f));}),tgBot[_0x5ea94b(0x298)]('config_all',async _0x2bd8fd=>{const _0x50fb73=_0x5ea94b;_0x2bd8fd[_0x50fb73(0x351)](),updateSetting(_0x50fb73(0x3ca),_0x50fb73(0x350)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x2bd8fd['chat']['id'],_0x50fb73(0x3ac));}),tgBot[_0x5ea94b(0x2d3)](_0x5ea94b(0x31d),async _0x5af919=>{const _0x543aac=_0x5ea94b,_0x47739c=getBotsWithMode();let _0x2a150f=_0x543aac(0x20e);config['forEach'](_0x2accb1=>{const _0x14268a=_0x543aac,_0x55bfcd=_0x47739c['find'](_0x1ee478=>_0x1ee478[_0x14268a(0x245)]==_0x2accb1[_0x14268a(0x245)])[_0x14268a(0x3a3)];_0x2a150f+=_0x14268a(0x1f2)+_0x2accb1[_0x14268a(0x245)]+':\x20'+_0x2accb1['status']+_0x14268a(0x20c)+_0x55bfcd+_0x14268a(0x20c)+_0x2accb1[_0x14268a(0x361)]+'\x0a';}),_0x2a150f+='\x0a',_0x2a150f+=_0x543aac(0x244),_0x2a150f+=!settings[_0x543aac(0x2f5)]?_0x543aac(0x35c):_0x543aac(0x232),_0x2a150f+=settings[_0x543aac(0x2f5)]?settings['telegramEvents']==_0x543aac(0x350)?_0x543aac(0x202):_0x543aac(0x3c8)+settings[_0x543aac(0x3ca)]+_0x543aac(0x3fa):'',await sendTelegram(_0x5af919['chat']['id'],_0x2a150f,{'parse_mode':'HTML'});}),tgBot[_0x5ea94b(0x2d3)](_0x5ea94b(0x358),async _0x287b81=>{const _0x34d50a=_0x5ea94b,_0x334213=getEnabledBots();if(_0x334213[_0x34d50a(0x344)]==0x0)await sendTelegram(_0x287b81[_0x34d50a(0x3a9)]['id'],_0x34d50a(0x1f7));else{if(_0x334213[_0x34d50a(0x344)]>0x1)_0x334213[_0x34d50a(0x389)]({'botID':_0x34d50a(0x350)});let _0x5bb4d0=[],_0x2c043d=[];const _0x4fa838=_0x334213[_0x34d50a(0x344)]%0x4==0x0||_0x334213['length']%0x4==0x3||_0x334213['length']%0x3==0x1?0x4:0x3;let _0x122ee4=0x0;_0x334213['forEach']((_0x1da9b6,_0x457bff)=>{const _0x1738cf=_0x34d50a;if(_0x457bff%_0x4fa838==0x0)_0x2c043d=[];_0x2c043d['push'](Markup[_0x1738cf(0x2dc)][_0x1738cf(0x32d)](_0x1da9b6['botID']==_0x1738cf(0x350)?_0x1738cf(0x26e):_0x1738cf(0x1f2)+_0x1da9b6[_0x1738cf(0x245)],'restart_'+_0x1da9b6[_0x1738cf(0x245)])),_0x457bff%_0x4fa838==0x0&&(_0x5bb4d0[_0x122ee4]=_0x2c043d,_0x122ee4++);});const _0x4245ba=Markup[_0x34d50a(0x252)](_0x5bb4d0);_0x287b81[_0x34d50a(0x228)](_0x34d50a(0x32a),_0x4245ba);}}),tgBot[_0x5ea94b(0x298)](/restart_(.+)/,async _0x2d1427=>{const _0x5c80ef=_0x5ea94b,_0xa1cf57=_0x2d1427[_0x5c80ef(0x36a)][0x1];_0x2d1427['editMessageReplyMarkup'](),_0xa1cf57==_0x5c80ef(0x350)?config[_0x5c80ef(0x21a)](_0xa7fb8e=>{const _0x1d840a=_0x5c80ef;restartBot(_0xa7fb8e[_0x1d840a(0x245)]);}):restartBot(_0xa1cf57);}),tgBot[_0x5ea94b(0x2d3)]('on',async _0x52faa2=>{const _0x5b883a=_0x5ea94b,_0x2f2f58=getDisabledBots();if(_0x2f2f58[_0x5b883a(0x344)]==0x0)await sendTelegram(_0x52faa2[_0x5b883a(0x3a9)]['id'],_0x5b883a(0x293));else{if(_0x2f2f58[_0x5b883a(0x344)]>0x1)_0x2f2f58[_0x5b883a(0x389)]({'botID':'all'});let _0x331acf=[],_0x313d8d=[];const _0x1408d0=_0x2f2f58[_0x5b883a(0x344)]%0x4==0x0||_0x2f2f58[_0x5b883a(0x344)]%0x4==0x3||_0x2f2f58[_0x5b883a(0x344)]%0x3==0x1?0x4:0x3;let _0x3ceec1=0x0;_0x2f2f58[_0x5b883a(0x21a)]((_0x16d41b,_0x401dc9)=>{const _0x2c09fc=_0x5b883a;if(_0x401dc9%_0x1408d0==0x0)_0x313d8d=[];_0x313d8d[_0x2c09fc(0x389)](Markup[_0x2c09fc(0x2dc)][_0x2c09fc(0x32d)](_0x16d41b[_0x2c09fc(0x245)]=='all'?_0x2c09fc(0x26e):_0x2c09fc(0x1f2)+_0x16d41b[_0x2c09fc(0x245)],_0x2c09fc(0x3d4)+_0x16d41b['botID'])),_0x401dc9%_0x1408d0==0x0&&(_0x331acf[_0x3ceec1]=_0x313d8d,_0x3ceec1++);});const _0x2ef2f7=Markup[_0x5b883a(0x252)](_0x331acf);_0x52faa2[_0x5b883a(0x228)](_0x5b883a(0x219),_0x2ef2f7);}}),tgBot[_0x5ea94b(0x298)](/on_(.+)/,async _0x455e9f=>{const _0x2645c4=_0x5ea94b,_0x4b73d2=_0x455e9f[_0x2645c4(0x36a)][0x1];_0x455e9f['editMessageReplyMarkup']();if(_0x4b73d2==_0x2645c4(0x350)){const _0x3cc825=getDisabledBots();await sendTelegram(_0x455e9f[_0x2645c4(0x3a9)]['id'],_0x2645c4(0x2af)),_0x3cc825['forEach'](_0xab6de5=>{const _0x52d868=_0x2645c4;if(_0xab6de5['botID']!='all')toggleBot(_0xab6de5['botID'],toggleStatus(_0xab6de5[_0x52d868(0x245)]),_0x52d868(0x36c));});}else await sendTelegram(_0x455e9f['chat']['id'],_0x2645c4(0x272)+_0x4b73d2),toggleBot(_0x4b73d2,toggleStatus(_0x4b73d2),_0x2645c4(0x36c));}),tgBot['command'](_0x5ea94b(0x3c3),async _0x8fa9f=>{const _0x426dcc=_0x5ea94b,_0x4c84da=getEnabledBots();if(_0x4c84da[_0x426dcc(0x344)]==0x0)await sendTelegram(_0x8fa9f[_0x426dcc(0x3a9)]['id'],_0x426dcc(0x1f7));else{if(_0x4c84da[_0x426dcc(0x344)]>0x1)_0x4c84da[_0x426dcc(0x389)]({'botID':'all'});let _0x1521c9=[],_0x52e945=[];const _0x28bcff=_0x4c84da[_0x426dcc(0x344)]%0x4==0x0||_0x4c84da[_0x426dcc(0x344)]%0x4==0x3||_0x4c84da[_0x426dcc(0x344)]%0x3==0x1?0x4:0x3;let _0x5ba97f=0x0;_0x4c84da[_0x426dcc(0x21a)]((_0x9c5b73,_0x551407)=>{const _0x29105b=_0x426dcc;if(_0x551407%_0x28bcff==0x0)_0x52e945=[];_0x52e945[_0x29105b(0x389)](Markup[_0x29105b(0x2dc)][_0x29105b(0x32d)](_0x9c5b73[_0x29105b(0x245)]==_0x29105b(0x350)?'All\x20bots':_0x29105b(0x1f2)+_0x9c5b73[_0x29105b(0x245)],'off_'+_0x9c5b73['botID'])),_0x551407%_0x28bcff==0x0&&(_0x1521c9[_0x5ba97f]=_0x52e945,_0x5ba97f++);});const _0x1cdc40=Markup[_0x426dcc(0x252)](_0x1521c9);_0x8fa9f[_0x426dcc(0x228)](_0x426dcc(0x24f),_0x1cdc40);}}),tgBot[_0x5ea94b(0x298)](/off_(.+)/,async _0x46a9ca=>{const _0x22fff1=_0x5ea94b,_0xe9979d=_0x46a9ca[_0x22fff1(0x36a)][0x1];_0x46a9ca[_0x22fff1(0x351)]();if(_0xe9979d==_0x22fff1(0x350)){const _0x390a8a=getEnabledBots();await sendTelegram(_0x46a9ca[_0x22fff1(0x3a9)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots'),_0x390a8a['forEach'](_0x3ed7d7=>{const _0x52dfb2=_0x22fff1;if(_0x3ed7d7['botID']!=_0x52dfb2(0x350))toggleBot(_0x3ed7d7[_0x52dfb2(0x245)],toggleStatus(_0x3ed7d7[_0x52dfb2(0x245)]),'stopped');});}else await sendTelegram(_0x46a9ca[_0x22fff1(0x3a9)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0xe9979d),toggleBot(_0xe9979d,toggleStatus(_0xe9979d),'stopped');}),tgBot[_0x5ea94b(0x2d3)](_0x5ea94b(0x355),async _0x46138f=>{const _0x37b895=_0x5ea94b,_0x22ed32=getEnabledBots();if(_0x22ed32['length']==0x0)await sendTelegram(_0x46138f[_0x37b895(0x3a9)]['id'],_0x37b895(0x1f7));else{if(_0x22ed32['length']>0x1){let _0x1af46a=[],_0x2a236e=[];const _0x24291b=_0x22ed32[_0x37b895(0x344)]%0x4==0x0||_0x22ed32[_0x37b895(0x344)]%0x4==0x3||_0x22ed32[_0x37b895(0x344)]%0x3==0x1?0x4:0x3;let _0x335534=0x0;_0x22ed32[_0x37b895(0x21a)]((_0x3c1d74,_0x12c23d)=>{const _0x4e3149=_0x37b895;if(_0x12c23d%_0x24291b==0x0)_0x2a236e=[];_0x2a236e[_0x4e3149(0x389)](Markup['button'][_0x4e3149(0x32d)]('Bot\x20'+_0x3c1d74[_0x4e3149(0x245)],_0x4e3149(0x239)+_0x3c1d74[_0x4e3149(0x245)])),_0x12c23d%_0x24291b==0x0&&(_0x1af46a[_0x335534]=_0x2a236e,_0x335534++);});const _0x3632df=Markup[_0x37b895(0x252)](_0x1af46a);_0x46138f['reply'](_0x37b895(0x2b0),_0x3632df);}else{const _0x125958=_0x22ed32[0x0]['botID'];if(pid[_0x125958])pid[_0x125958][_0x37b895(0x279)]({'function':_0x37b895(0x362),'args':null});}}}),tgBot[_0x5ea94b(0x298)](/metrics_(.+)/,async _0x466020=>{const _0x711079=_0x5ea94b,_0xc1bde1=_0x466020[_0x711079(0x36a)][0x1];_0x466020[_0x711079(0x351)]();if(pid[_0xc1bde1])pid[_0xc1bde1][_0x711079(0x279)]({'function':_0x711079(0x362),'args':null});}),tgBot[_0x5ea94b(0x2d3)](_0x5ea94b(0x2e0),async _0x5eb0a7=>{const _0x320858=_0x5ea94b,_0x817184=getEnabledBots();if(_0x817184['length']==0x0)await sendTelegram(_0x5eb0a7['chat']['id'],_0x320858(0x1f7));else{if(_0x817184[_0x320858(0x344)]>0x1){let _0xc5afc0=[],_0x3c0066=[];const _0xb34416=_0x817184['length']%0x4==0x0||_0x817184[_0x320858(0x344)]%0x4==0x3||_0x817184[_0x320858(0x344)]%0x3==0x1?0x4:0x3;let _0x98878f=0x0;_0x817184[_0x320858(0x21a)]((_0x2889a9,_0x244cf9)=>{const _0x1a8f88=_0x320858;if(_0x244cf9%_0xb34416==0x0)_0x3c0066=[];_0x3c0066[_0x1a8f88(0x389)](Markup[_0x1a8f88(0x2dc)][_0x1a8f88(0x32d)](_0x1a8f88(0x1f2)+_0x2889a9[_0x1a8f88(0x245)],'portfolio_'+_0x2889a9[_0x1a8f88(0x245)])),_0x244cf9%_0xb34416==0x0&&(_0xc5afc0[_0x98878f]=_0x3c0066,_0x98878f++);});const _0x39e882=Markup[_0x320858(0x252)](_0xc5afc0);_0x5eb0a7[_0x320858(0x228)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x39e882);}else{const _0x27b2ba=_0x817184[0x0]['botID'];if(pid[_0x27b2ba])pid[_0x27b2ba][_0x320858(0x279)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x1c451d=>{const _0x1bb794=_0x5ea94b,_0x32a2bf=_0x1c451d[_0x1bb794(0x36a)][0x1];_0x1c451d['editMessageReplyMarkup']();if(pid[_0x32a2bf])pid[_0x32a2bf][_0x1bb794(0x279)]({'function':_0x1bb794(0x234),'args':null});}),tgBot[_0x5ea94b(0x2d3)](_0x5ea94b(0x3c9),async _0x48b9b3=>{const _0x5dd6f4=_0x5ea94b,_0x2ff3f5=_0x5dd6f4(0x3c9);await zipFiles(_0x2ff3f5);const _0x490ef1=zippath+(_0x2ff3f5+_0x5dd6f4(0x2ca));_0x48b9b3['replyWithDocument']({'source':_0x490ef1})['then'](()=>{})['catch'](_0x38e3dc=>logger[_0x5dd6f4(0x2f6)](_0x5dd6f4(0x3c0)+_0x2ff3f5+_0x5dd6f4(0x3d6),_0x38e3dc));}),tgBot[_0x5ea94b(0x2d3)](_0x5ea94b(0x1ee),async _0x3816d4=>{const _0x1f5f68=_0x5ea94b,_0x5ad4a0='backup';await backupConfigFiles(),await zipFiles(_0x5ad4a0);const _0x50fe71=zippath+(_0x5ad4a0+_0x1f5f68(0x2ca));_0x3816d4[_0x1f5f68(0x233)]({'source':_0x50fe71})['then'](()=>{})[_0x1f5f68(0x2c1)](_0x2f050e=>logger[_0x1f5f68(0x2f6)](_0x1f5f68(0x3c0)+_0x5ad4a0+'\x20files\x20over\x20Telegram:',_0x2f050e));}),tgBot[_0x5ea94b(0x2d3)](_0x5ea94b(0x29a),async _0x2e1f2a=>{const _0x3335d8=_0x5ea94b;await getMessages();if(!updateAvailable)await sendTelegram(_0x2e1f2a['chat']['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x2e1f2a[_0x3335d8(0x3a9)]['id'],_0x3335d8(0x236));else{const _0x321947=Markup[_0x3335d8(0x252)]([Markup['button'][_0x3335d8(0x32d)](_0x3335d8(0x38f),_0x3335d8(0x24a)),Markup[_0x3335d8(0x2dc)][_0x3335d8(0x32d)]('No',_0x3335d8(0x24e))]);_0x2e1f2a[_0x3335d8(0x228)](_0x3335d8(0x2bf),_0x321947);}}}),tgBot['action'](/update_(.+)/,async _0x1b4cbc=>{const _0x45d963=_0x5ea94b,_0x5bc7ea=_0x1b4cbc[_0x45d963(0x36a)][0x1];_0x1b4cbc['editMessageReplyMarkup'](),_0x5bc7ea=='yes'&&(await sendTelegram(_0x1b4cbc['chat']['id'],_0x45d963(0x37b)),updateBB(_0x45d963(0x29a))),_0x5bc7ea=='no'&&await sendTelegram(_0x1b4cbc[_0x45d963(0x3a9)]['id'],_0x45d963(0x1e8));}),tgBot['command'](_0x5ea94b(0x237),async _0x48366a=>{const _0x3da152=_0x5ea94b;if(!validInstallation)await sendTelegram(_0x48366a[_0x3da152(0x3a9)]['id'],_0x3da152(0x2a1));else{const _0x2d0787=Markup['inlineKeyboard']([Markup[_0x3da152(0x2dc)]['callback'](_0x3da152(0x38f),'reinstall_yes'),Markup[_0x3da152(0x2dc)][_0x3da152(0x32d)]('No',_0x3da152(0x20a))]);_0x48366a[_0x3da152(0x228)](_0x3da152(0x3e3),_0x2d0787);}}),tgBot['action'](/reinstall_(.+)/,async _0x325eff=>{const _0x4397c2=_0x5ea94b,_0x35022f=_0x325eff['match'][0x1];_0x325eff[_0x4397c2(0x351)](),_0x35022f==_0x4397c2(0x257)&&(await sendTelegram(_0x325eff[_0x4397c2(0x3a9)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB('reinstall')),_0x35022f=='no'&&await sendTelegram(_0x325eff[_0x4397c2(0x3a9)]['id'],_0x4397c2(0x3ba));}),tgBot[_0x5ea94b(0x2d3)](_0x5ea94b(0x210),async _0x36583c=>{const _0x288d53=_0x5ea94b,_0x10022b=getBotsWithMode();if(_0x10022b[_0x288d53(0x344)]==0x0)await sendTelegram(_0x36583c[_0x288d53(0x3a9)]['id'],_0x288d53(0x1f7));else{let _0x4a3be6=[],_0x797b23=[];const _0x40fa95=0x2;let _0x123547=0x0;_0x10022b['forEach']((_0x4492b3,_0x381d4c)=>{const _0x2d1e9a=_0x288d53;if(_0x381d4c%_0x40fa95==0x0)_0x797b23=[];_0x797b23[_0x2d1e9a(0x389)](Markup[_0x2d1e9a(0x2dc)]['callback']('Bot\x20'+_0x4492b3['botID']+'\x20('+_0x4492b3['mode']+')',_0x2d1e9a(0x37e)+_0x4492b3[_0x2d1e9a(0x245)])),_0x381d4c%_0x40fa95==0x0&&(_0x4a3be6[_0x123547]=_0x797b23,_0x123547++);});const _0x1e52e8=Markup[_0x288d53(0x252)](_0x4a3be6);_0x36583c[_0x288d53(0x228)](_0x288d53(0x2fc),_0x1e52e8);}}),tgBot[_0x5ea94b(0x298)](/toggle_(.+)/,async _0x30d0c3=>{const _0x4bce08=_0x5ea94b,_0x192e6f=_0x30d0c3[_0x4bce08(0x36a)][0x1];_0x30d0c3['editMessageReplyMarkup']();const _0x8d9a1e=getBotsWithMode(),_0x16de2f=_0x8d9a1e[_0x4bce08(0x2ab)](_0x367171=>_0x367171[_0x4bce08(0x245)]==_0x192e6f),_0x4bbbd9=_0x16de2f[_0x4bce08(0x3a3)]=='auto'?'manual':_0x4bce08(0x1fe);await sendTelegram(_0x30d0c3[_0x4bce08(0x3a9)]['id'],_0x4bce08(0x1ec)+_0x192e6f+'\x20to\x20'+_0x4bbbd9+'\x20mode'),toggleBotMode(_0x192e6f);}),tgBot[_0x5ea94b(0x2d3)]('names',async _0xf4d140=>{const _0x1a49e1=_0x5ea94b;let _0x30a8e9='';config[_0x1a49e1(0x21a)](_0x3cc7dd=>{const _0x142fcd=_0x1a49e1;_0x30a8e9+=_0x142fcd(0x1f2)+_0x3cc7dd[_0x142fcd(0x245)]+':\x20'+_0x3cc7dd[_0x142fcd(0x305)]+'\x0a';}),await sendTelegram(_0xf4d140['chat']['id'],_0x30a8e9,{'parse_mode':_0x1a49e1(0x209)});}),tgBot['command'](_0x5ea94b(0x256),async _0x21546e=>{const _0x4d2bb9=_0x5ea94b;await sendTelegram(_0x21546e[_0x4d2bb9(0x3a9)]['id'],_0x206bcc);}),process[_0x5ea94b(0x268)](_0x5ea94b(0x3ab),()=>tgBot[_0x5ea94b(0x2a8)]('SIGINT')),process['once'](_0x5ea94b(0x249),()=>tgBot[_0x5ea94b(0x2a8)](_0x5ea94b(0x249))),tgBot['launch']();}function disableTelegram(){const _0x1f4516=_0x1bc878;tgBot&&tgBot[_0x1f4516(0x2a8)]();}async function sendTelegram(_0xfca001,_0x50c130,_0x57eac2){const _0x1ef9aa=_0x1bc878;_0x57eac2={..._0x57eac2,'disable_web_page_preview':!![]};try{await tgBot[_0x1ef9aa(0x330)][_0x1ef9aa(0x381)](_0xfca001,_0x50c130,_0x57eac2);}catch(_0x43484c){console[_0x1ef9aa(0x39b)](_0x1ef9aa(0x359),_0x43484c);}}async function sendTelegramBot(_0x3468ed,_0x39d755){const _0x157189=_0x1bc878;if(settings[_0x157189(0x2f5)]){if(settings[_0x157189(0x3ca)]=='all'||(_0x39d755[_0x157189(0x282)]==_0x157189(0x2cf)||_0x39d755[_0x157189(0x282)]==_0x157189(0x223)||_0x39d755[_0x157189(0x282)]==_0x157189(0x3e6))&&settings[_0x157189(0x3ca)]=='alerts'||_0x39d755[_0x157189(0x282)]==_0x157189(0x3b6)&&settings[_0x157189(0x3ca)]==_0x157189(0x338)){if(tgBot&&settings[_0x157189(0x253)]){if(_0x39d755[_0x157189(0x367)])await sendTelegram(settings[_0x157189(0x253)],_0x39d755['botname']+'\x20>\x20'+_0x39d755['event']);else await sendTelegram(settings['telegramChatId'],_0x157189(0x1f2)+_0x3468ed+_0x157189(0x391)+_0x39d755[_0x157189(0x264)]);}}}}async function sendTelegramMsg(_0x17646e,_0x4810bc='HTML'){const _0x399d45=_0x1bc878;return settings[_0x399d45(0x2f5)]&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings['telegramChatId'],_0x17646e,{'parse_mode':_0x4810bc}),!![]):![];}function _0x5607(_0xc15679,_0x1dd516){const _0x34eafa=_0x13a2();return _0x5607=function(_0x3eed13,_0x4f11a1){_0x3eed13=_0x3eed13-0x1de;let _0x13a212=_0x34eafa[_0x3eed13];return _0x13a212;},_0x5607(_0xc15679,_0x1dd516);}function getDeviceWithIp(_0x37c3c5){const _0x31b36a=_0x1bc878;return devices[_0x31b36a(0x2ab)](_0x98b1fc=>_0x98b1fc['ip']===_0x37c3c5);}async function temporaryAccess2FA(_0x249440,_0x29656d){const _0x43e6b2=_0x1bc878;let _0x372f22=new Date(),_0x15707e=![];if(lastIpApproval){if(_0x372f22-lastIpApproval<0x1388)_0x15707e=!![];}lastIpApproval=new Date();if(_0x15707e)return;if(tgBot&&settings[_0x43e6b2(0x253)]){const _0x49356d=uuidRandom();tmpStorage[_0x49356d]={'uuid':_0x249440,'externalip':_0x29656d};const _0x5d7c60=Markup[_0x43e6b2(0x252)]([Markup[_0x43e6b2(0x2dc)][_0x43e6b2(0x32d)](_0x43e6b2(0x2d8),_0x43e6b2(0x38e)+_0x49356d),Markup[_0x43e6b2(0x2dc)]['callback'](_0x43e6b2(0x3dc),_0x43e6b2(0x2f2)+_0x49356d),Markup[_0x43e6b2(0x2dc)][_0x43e6b2(0x32d)](_0x43e6b2(0x3e1),_0x43e6b2(0x328)+_0x49356d),Markup[_0x43e6b2(0x2dc)][_0x43e6b2(0x32d)](_0x43e6b2(0x311),_0x43e6b2(0x337)+_0x49356d)]);await sendTelegram(settings[_0x43e6b2(0x253)],_0x43e6b2(0x346)+normalizeIP(_0x29656d)[_0x43e6b2(0x312)]+'\x20?',_0x5d7c60),tgBot[_0x43e6b2(0x298)](/tempaccess_(.+)_(.+)/,async _0x244793=>{const _0x5e0929=_0x43e6b2,_0x5c2891=_0x244793[_0x5e0929(0x36a)][0x1],_0x9b743f=_0x244793[_0x5e0929(0x36a)][0x2],{uuid:_0xa60b86,externalip:_0x595797}=tmpStorage[_0x9b743f];delete tmpStorage[_0x9b743f],_0x244793['editMessageReplyMarkup'](),devices[_0xa60b86][_0x5e0929(0x29e)]={'clientip':_0x595797,'timestamp':new Date()[_0x5e0929(0x251)](),'expiry':_0x5c2891},_0x5c2891!='reject'?(await sendTelegram(_0x244793[_0x5e0929(0x3a9)]['id'],_0x5e0929(0x250)+_0x5c2891+'\x20minutes',{'parse_mode':_0x5e0929(0x209)}),io['to'](_0xa60b86)['emit'](_0x5e0929(0x31d),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x244793[_0x5e0929(0x3a9)]['id'],_0x5e0929(0x284)),io['to'](_0xa60b86)['emit'](_0x5e0929(0x31d),{'access':{'allow':![],'reason':_0x5e0929(0x254),'token':null}}));});}}async function loginAccess2FA(_0x5e1ede,_0x1396c5){const _0x3c2999=_0x1bc878;if(tgBot&&settings['telegramChatId']){const _0x4f0450=uuidRandom();tmpStorage[_0x4f0450]={'uuid':_0x5e1ede,'externalip':_0x1396c5};const _0x194b98=Markup[_0x3c2999(0x252)]([Markup['button']['callback']('accept',_0x3c2999(0x2a4)+loginExpiry+'_'+_0x4f0450),Markup[_0x3c2999(0x2dc)]['callback'](_0x3c2999(0x311),_0x3c2999(0x33b)+_0x4f0450)]);await sendTelegram(settings[_0x3c2999(0x253)],_0x3c2999(0x35b)+normalizeIP(_0x1396c5)[_0x3c2999(0x312)]+'\x20?',_0x194b98),tgBot[_0x3c2999(0x298)](/login2fa_(.+)_(.+)/,async _0x5d8b5f=>{const _0x56d205=_0x3c2999,_0x22c32c=_0x5d8b5f[_0x56d205(0x36a)][0x1],_0x5d7a9a=_0x5d8b5f[_0x56d205(0x36a)][0x2],{uuid:_0x5adbb3,externalip:_0x3fdb84}=tmpStorage[_0x5d7a9a];delete tmpStorage[_0x5d7a9a],_0x5d8b5f[_0x56d205(0x351)](),devices[_0x5adbb3]['telegram2FaApproval']={'clientip':_0x3fdb84,'timestamp':new Date()['getTime'](),'expiry':_0x22c32c},_0x22c32c!='reject'?(await sendTelegram(_0x5d8b5f[_0x56d205(0x3a9)]['id'],_0x56d205(0x1fa),{'parse_mode':_0x56d205(0x209)}),io['to'](_0x5adbb3)['emit'](_0x56d205(0x31d),{'access':{'allow':![],'reason':_0x56d205(0x21e),'token':null}})):(await sendTelegram(_0x5d8b5f[_0x56d205(0x3a9)]['id'],_0x56d205(0x3da)),io['to'](_0x5adbb3)['emit'](_0x56d205(0x31d),{'access':{'allow':![],'reason':_0x56d205(0x3d1),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x35ffd8=_0x1bc878;return dbConfig[_0x35ffd8(0x329)](_0x35ffd8(0x204))['sortBy']('botID')['filter']({'status':_0x35ffd8(0x261)})[_0x35ffd8(0x2cd)]()||[];}function getDisabledBots(){const _0x3b2918=_0x1bc878;return dbConfig[_0x3b2918(0x329)](_0x3b2918(0x204))['sortBy'](_0x3b2918(0x245))['filter']({'status':_0x3b2918(0x205)})[_0x3b2918(0x2cd)]()||[];}function getBotAttributes(_0xbfced1){const _0x683a1c=_0x1bc878;let _0x2433c6={};const _0x1b7f86=configpath+'bot-'+_0xbfced1+_0x683a1c(0x288),_0x4fbb3e=fs['existsSync'](_0x1b7f86);if(_0x4fbb3e){const _0x41a5c7=fs[_0x683a1c(0x31f)](_0x1b7f86);try{const _0x41d10b=JSON[_0x683a1c(0x247)](_0x41a5c7),_0x3bb3b9=_0x41d10b?_0x41d10b['bot'][0x0][_0x683a1c(0x20b)]:![];_0x2433c6[_0x683a1c(0x3a3)]=_0x3bb3b9?_0x683a1c(0x1fe):_0x683a1c(0x3de),_0x2433c6[_0x683a1c(0x305)]=_0x41d10b?_0x41d10b[_0x683a1c(0x3ef)][0x0][_0x683a1c(0x305)]:'Bot\x20'+_0xbfced1;}catch(_0x3606f0){_0x2433c6[_0x683a1c(0x3a3)]=_0x683a1c(0x3de),_0x2433c6[_0x683a1c(0x305)]=_0x683a1c(0x1f2)+_0xbfced1;}}else _0x2433c6['mode']=_0x683a1c(0x3de),_0x2433c6['botname']=_0x683a1c(0x1f2)+_0xbfced1;return _0x2433c6;}function getBotsWithMode(){const _0x540cc1=_0x1bc878,_0x206b49=dbConfig[_0x540cc1(0x329)](_0x540cc1(0x204))[_0x540cc1(0x3ad)](_0x540cc1(0x245))[_0x540cc1(0x2cd)]()||[];return _0x206b49['forEach'](_0xdf2745=>{const _0x343941=_0x540cc1;let _0x328551=getBotAttributes(_0xdf2745[_0x343941(0x245)]);_0xdf2745[_0x343941(0x3a3)]=_0x328551[_0x343941(0x3a3)];}),_0x206b49;}function getBotExchanges(){const _0x2bd805=_0x1bc878;let _0x1b7b37=[];const _0x4c932a=dbConfig['get'](_0x2bd805(0x204))[_0x2bd805(0x3ad)](_0x2bd805(0x245))['value']()||[];_0x4c932a[_0x2bd805(0x21a)](_0x4584c8=>{const _0x379d7c=_0x2bd805;if(_0x4584c8[_0x379d7c(0x31d)]=='enabled'){const _0x350082=configpath+_0x379d7c(0x25e)+_0x4584c8['botID']+_0x379d7c(0x288),_0x1fcf9e=fs['existsSync'](_0x350082);let _0x15ac99;if(_0x1fcf9e){const _0x375f16=fs[_0x379d7c(0x31f)](_0x350082);try{const _0xa17a83=JSON[_0x379d7c(0x247)](_0x375f16);_0x15ac99=_0xa17a83?_0xa17a83['bot'][0x0][_0x379d7c(0x33f)]:null;}catch(_0x18290f){}}if(_0x15ac99)_0x1b7b37[_0x379d7c(0x389)](_0x15ac99);}});const _0x38363b=[...new Set(_0x1b7b37)][_0x2bd805(0x336)]();return _0x38363b;}async function initUser(){const _0x408bb5=_0x1bc878;if(!settings[_0x408bb5(0x224)]){const _0x4b25b8=uuidRandom();mixpanel[_0x408bb5(0x34a)](_0x4b25b8),updateSetting('userid',_0x4b25b8);}}async function initSecure(){const _0x3a150a=_0x1bc878;let _0x52442c=getSecure();if(!_0x52442c[_0x3a150a(0x321)](_0x3a150a(0x3fd))){let _0x46b783=await generateKeys();_0x52442c[_0x3a150a(0x3d2)]=_0x46b783[_0x3a150a(0x3d2)],_0x52442c[_0x3a150a(0x25c)]=_0x46b783[_0x3a150a(0x25c)],_0x52442c['secret']=crypto[_0x3a150a(0x2bd)](0x20)[_0x3a150a(0x37c)]('hex');;storeSecure(_0x52442c);}}function getSettings(){const _0x539759=_0x1bc878;return dbSettings[_0x539759(0x329)](_0x539759(0x2aa))[_0x539759(0x2cd)]()||{};}function getSecure(){const _0xc84c50=_0x1bc878;return dbSecure[_0xc84c50(0x329)](_0xc84c50(0x21f))[_0xc84c50(0x2cd)]()||{};}function getBlacklist(){const _0x4a3f0e=_0x1bc878;return dbSecure['get']('blacklist')[_0x4a3f0e(0x2cd)]()||[];}function broadcastToBots(_0x230578,_0x2d10d){const _0x5a8da8=_0x1bc878;config[_0x5a8da8(0x21a)](_0x5693ab=>{const _0x123da3=_0x5a8da8;if(_0x5693ab[_0x123da3(0x31d)]==_0x123da3(0x261)&&_0x5693ab['live']==_0x123da3(0x370)||_0x5693ab[_0x123da3(0x31d)]==_0x123da3(0x39f)&&_0x5693ab[_0x123da3(0x361)]==_0x123da3(0x370)){if(pid[_0x5693ab[_0x123da3(0x245)]])pid[_0x5693ab[_0x123da3(0x245)]][_0x123da3(0x279)]({[_0x230578]:_0x2d10d});}});}async function storeSettings(_0x1806aa,_0x429e25=![]){const _0x59f437=_0x1bc878;_0x1806aa={...settings,..._0x1806aa};if(_0x429e25&&_0x1806aa[_0x59f437(0x357)]!=_0x59f437(0x331)&&_0x1806aa[_0x59f437(0x357)]!=_0x59f437(0x31b)&&_0x1806aa[_0x59f437(0x357)]!=''){const _0x121418=decryptRSA(secure[_0x59f437(0x25c)],_0x1806aa['bbPassword'])['split'](_0x59f437(0x243))[0x0],_0x3daa2c=bcrypt['hashSync'](_0x121418,saltRounds);_0x1806aa={..._0x1806aa,'bbPassword':_0x3daa2c};}if(_0x429e25&&_0x1806aa[_0x59f437(0x290)]!='************'&&_0x1806aa[_0x59f437(0x290)]!='***'&&_0x1806aa[_0x59f437(0x290)]!=''){const _0x171f13=decryptRSA(secure[_0x59f437(0x25c)],_0x1806aa[_0x59f437(0x290)])[_0x59f437(0x371)](_0x59f437(0x243))[0x0];_0x1806aa={..._0x1806aa,'telegramToken':_0x171f13};}if(_0x429e25&&_0x1806aa[_0x59f437(0x395)]!=_0x59f437(0x331)&&_0x1806aa[_0x59f437(0x395)]!=_0x59f437(0x31b)&&_0x1806aa[_0x59f437(0x395)]!=''){const _0x14d28c=decryptRSA(secure['privateKey'],_0x1806aa['marketcapApi'])[_0x59f437(0x371)](_0x59f437(0x243))[0x0];_0x1806aa={..._0x1806aa,'marketcapApi':_0x14d28c};}const _0x1c0d0c=_0x1806aa[_0x59f437(0x290)]!=_0x59f437(0x331)&&_0x1806aa['telegramToken']!=settings[_0x59f437(0x290)]||_0x1806aa[_0x59f437(0x2d4)]!=settings[_0x59f437(0x2d4)],_0x1a4506=_0x1806aa[_0x59f437(0x290)]==''||_0x1806aa['telegramUsername']=='',_0x1dd99e=_0x1806aa[_0x59f437(0x395)]&&_0x1806aa[_0x59f437(0x395)]!='************'&&_0x1806aa[_0x59f437(0x395)]!=settings[_0x59f437(0x290)];_0x1c0d0c&&(_0x1806aa[_0x59f437(0x253)]=null,_0x1806aa[_0x59f437(0x3ca)]=_0x59f437(0x350));for(const [_0x4bfb25,_0x5c60d8]of Object[_0x59f437(0x309)](_0x1806aa)){if(_0x4bfb25==_0x59f437(0x290)&&_0x5c60d8==_0x59f437(0x331)){_0x1806aa[_0x59f437(0x290)]=settings[_0x59f437(0x290)];continue;};if(_0x4bfb25=='bbPassword'&&_0x5c60d8=='************'){_0x1806aa[_0x59f437(0x357)]=settings[_0x59f437(0x357)];continue;};if(_0x4bfb25=='marketcapApi'&&_0x5c60d8==_0x59f437(0x331)){_0x1806aa[_0x59f437(0x395)]=settings[_0x59f437(0x395)];continue;};dbSettings[_0x59f437(0x31e)]('settings.'+_0x4bfb25,_0x5c60d8)[_0x59f437(0x374)]();}settings=_0x1806aa,io['to'](_0x59f437(0x3d7))[_0x59f437(0x332)](_0x59f437(0x2aa),cleanSettings()),broadcastToBots('timeshift',settings[_0x59f437(0x39a)]),broadcastToBots('onepagemode',settings[_0x59f437(0x217)]),broadcastToBots(_0x59f437(0x395),settings['marketcapApi']);if(_0x1c0d0c&&!_0x1a4506)initTelegram();if(_0x1c0d0c&&_0x1a4506)disableTelegram();getAllClients()[_0x59f437(0x21a)](_0x5d35c9=>{const _0x317176=_0x59f437;getSocket(_0x5d35c9['id'])[_0x317176(0x332)](_0x317176(0x31d),{'access':{'allow':![],'reason':_0x317176(0x21e),'token':null}});}),_0x1dd99e&&(await sleep(0xbb8),testMarketcapApi(_0x1806aa[_0x59f437(0x395)]));}async function testMarketcapApi(_0x5ae989){const _0x1d6de9=_0x1bc878,_0x55dda4=[_0x1d6de9(0x208),_0x1d6de9(0x315)];try{await axios[_0x1d6de9(0x329)]('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0x5ae989},'params':{'symbol':_0x55dda4[_0x1d6de9(0x37c)]()}});}catch(_0x21dc95){_0x21dc95[_0x1d6de9(0x37c)]()[_0x1d6de9(0x334)](_0x1d6de9(0x1e5))?(io['to'](_0x1d6de9(0x3d7))[_0x1d6de9(0x332)]('notification',_0x1d6de9(0x23f)),logger[_0x1d6de9(0x2d5)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to'](_0x1d6de9(0x3d7))[_0x1d6de9(0x332)](_0x1d6de9(0x240),_0x1d6de9(0x3bf)),logger['full']('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x1d6de9(0x2f6)]('Error\x20details:',_0x21dc95['toString']()+_0x1d6de9(0x24c)+_0x21dc95['code']));return;}logger[_0x1d6de9(0x2f6)](_0x1d6de9(0x2d6));}function updateSetting(_0x57b5f7,_0x1d8e36){const _0x49d765=_0x1bc878;dbSettings[_0x49d765(0x31e)](_0x49d765(0x3e7)+_0x57b5f7,_0x1d8e36)[_0x49d765(0x374)](),settings=getSettings(),io['to'](_0x49d765(0x3d7))[_0x49d765(0x332)](_0x49d765(0x2aa),cleanSettings());}function storeSecure(_0x41c2f6){const _0x10c70e=_0x1bc878;dbSecure[_0x10c70e(0x329)]('secure')[_0x10c70e(0x389)](_0x41c2f6)[_0x10c70e(0x374)](),secure=_0x41c2f6;}function addBlacklist(_0x47fb79){const _0x12a439=_0x1bc878;cleanBlacklist();let _0x1bf5e3;devices[_0x47fb79][_0x12a439(0x29e)]?_0x1bf5e3=Math[_0x12a439(0x369)](devices[_0x47fb79][_0x12a439(0x29e)][_0x12a439(0x2e5)],loginExpiry):_0x1bf5e3=loginExpiry,dbSecure[_0x12a439(0x329)](_0x12a439(0x222))['push']({'expiry':new Date()[_0x12a439(0x251)]()+_0x1bf5e3*0x3c*0x3e8,'token':devices[_0x47fb79][_0x12a439(0x360)][_0x12a439(0x3f2)]})['write'](),blacklist=dbSecure['get'](_0x12a439(0x222))[_0x12a439(0x2cd)]();}function cleanBlacklist(){const _0x1def1b=_0x1bc878;let _0x4a1b0c=dbSecure[_0x1def1b(0x329)]('blacklist')[_0x1def1b(0x1e7)]()[_0x1def1b(0x2cd)](),_0x4eaa79=new Date()[_0x1def1b(0x251)]();_0x4a1b0c[_0x1def1b(0x21a)](_0x90b50f=>{const _0x255356=_0x1def1b;_0x90b50f[_0x255356(0x2e5)]<_0x4eaa79&&dbSecure[_0x255356(0x329)]('blacklist')[_0x255356(0x2b3)]({'expiry':_0x90b50f[_0x255356(0x2e5)]})[_0x255356(0x374)]();});}function initStates(){const _0x113ab5=_0x1bc878;let _0x210815=getConfiguration();_0x210815[_0x113ab5(0x21a)](_0x8bbaed=>{const _0x259721=_0x113ab5;_0x8bbaed[_0x259721(0x361)]=_0x259721(0x36c);}),storeConfiguration(_0x210815);}async function generateKeys(){const _0x596b4a=_0x1bc878,_0x45bfa9=forge[_0x596b4a(0x2b7)][_0x596b4a(0x273)][_0x596b4a(0x278)]({'bits':0x1000,'e':0x10001}),_0x2dcaef=forge['pki'][_0x596b4a(0x32b)](_0x45bfa9['privateKey']),_0x1d54c6=forge[_0x596b4a(0x2b7)][_0x596b4a(0x3d9)](_0x45bfa9[_0x596b4a(0x3d2)]);return{'privateKey':_0x2dcaef,'publicKey':_0x1d54c6};}async function oneTimeMigration(){const _0x21b358=_0x1bc878;let _0x4ae905=getSettings(),_0xcc2077=![];!_0x4ae905[_0x21b358(0x321)](_0x21b358(0x39e))&&(_0x4ae905[_0x21b358(0x39e)]=0x0,_0xcc2077=!![]);!_0x4ae905[_0x21b358(0x321)](_0x21b358(0x303))&&(_0x4ae905['lastmsgemitted']=0x0,_0xcc2077=!![]);!_0x4ae905['hasOwnProperty'](_0x21b358(0x211))&&(_0x4ae905['latestversion']=_0x21b358(0x292),_0xcc2077=!![]);!_0x4ae905['hasOwnProperty'](_0x21b358(0x217))&&(_0x4ae905[_0x21b358(0x217)]=![],_0xcc2077=!![]);!_0x4ae905[_0x21b358(0x321)](_0x21b358(0x395))&&(_0x4ae905[_0x21b358(0x395)]='',_0xcc2077=!![]);if(_0xcc2077)storeSettings(_0x4ae905);try{fs[_0x21b358(0x318)](configbackuppath,{'withFileTypes':!![]})[_0x21b358(0x21a)](_0x11fb6a=>{const _0x344bbd=_0x21b358;if(!_0x11fb6a[_0x344bbd(0x398)]()){if(!_0x11fb6a['name'][_0x344bbd(0x38a)](_0x344bbd(0x29c)))fs[_0x344bbd(0x310)](configbackuppath+_0x11fb6a[_0x344bbd(0x2e8)]);}else fs[_0x344bbd(0x31c)](configbackuppath+_0x11fb6a[_0x344bbd(0x2e8)],{'recursive':!![]});});}catch(_0x4fa51c){logger['debug'](_0x21b358(0x32f),_0x4fa51c);}}function storeConfiguration(_0x493787){const _0x4f9bdb=_0x1bc878;dbConfig[_0x4f9bdb(0x329)](_0x4f9bdb(0x204))['remove']()['write'](),dbConfig[_0x4f9bdb(0x329)](_0x4f9bdb(0x204))[_0x4f9bdb(0x389)](..._0x493787)[_0x4f9bdb(0x374)](),config=_0x493787;}async function resetPassword(){const _0x365760=_0x1bc878;if(tgBot&&settings['telegramChatId']){const _0x28a321=Markup[_0x365760(0x252)]([Markup[_0x365760(0x2dc)][_0x365760(0x32d)](_0x365760(0x257),_0x365760(0x2e1)),Markup[_0x365760(0x2dc)][_0x365760(0x32d)]('no',_0x365760(0x2cb))]);await sendTelegram(settings[_0x365760(0x253)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x28a321),tgBot['action'](/resetpw_(.+)/,async _0x5d53cf=>{const _0xd67514=_0x365760,_0x10bbd3=_0x5d53cf[_0xd67514(0x36a)][0x1];_0x5d53cf[_0xd67514(0x351)]();if(_0x10bbd3!='no'){const _0x2abcd0=0xf,_0x379805=_0xd67514(0x3c4),_0x513148=Array[_0xd67514(0x246)](crypto['randomFillSync'](new Uint32Array(_0x2abcd0)))[_0xd67514(0x38c)](_0x467e24=>_0x379805[_0x467e24%_0x379805[_0xd67514(0x344)]])['join'](''),_0x715c72=bcrypt['hashSync'](_0x513148,saltRounds);storeSettings({'bbPassword':_0x715c72}),await sendTelegram(_0x5d53cf['chat']['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x513148,{'parse_mode':'HTML'});}else await sendTelegram(_0x5d53cf['chat']['id'],_0xd67514(0x1e4));});}}async function confirmRestore(_0x3867c0,_0x241645){const _0xbfed16=_0x1bc878;io['to'](_0xbfed16(0x3d7))[_0xbfed16(0x332)](_0xbfed16(0x240),_0xbfed16(0x21b),_0xbfed16(0x3e6));if(tgBot&&settings[_0xbfed16(0x253)]){const _0x1ac5a3=uuidRandom();tmpStorage[_0x1ac5a3]={'path':_0x3867c0,'filename':_0x241645};const _0x4ae286=Markup['inlineKeyboard']([Markup[_0xbfed16(0x2dc)][_0xbfed16(0x32d)]('yes','restore_yes_'+_0x1ac5a3),Markup[_0xbfed16(0x2dc)]['callback']('no',_0xbfed16(0x266)+_0x1ac5a3)]);await sendTelegram(settings[_0xbfed16(0x253)],_0xbfed16(0x3c2),_0x4ae286),tgBot[_0xbfed16(0x298)](/restore_(.+)_(.+)/,async _0x3d71d4=>{const _0x3cbd1e=_0xbfed16,_0x51ab75=_0x3d71d4[_0x3cbd1e(0x36a)][0x1],_0x227e66=_0x3d71d4[_0x3cbd1e(0x36a)][0x2],{path:_0x3ef03b,filename:_0x442fd1}=tmpStorage[_0x227e66];delete tmpStorage[_0x227e66],_0x3d71d4[_0x3cbd1e(0x351)](),_0x51ab75==_0x3cbd1e(0x257)?(logger[_0x3cbd1e(0x2f6)](_0x3cbd1e(0x302)),await sendTelegram(_0x3d71d4['chat']['id'],_0x3cbd1e(0x200),{'parse_mode':_0x3cbd1e(0x209)}),unzipFile(_0x3ef03b,_0x442fd1)):(logger[_0x3cbd1e(0x2f6)]('Restore\x20process\x20aborted'),await sendTelegram(_0x3d71d4[_0x3cbd1e(0x3a9)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x465b0a=_0x1bc878,_0x2fb031=new Date();return _0x2fb031['getFullYear']()+'/'+(_0x2fb031[_0x465b0a(0x2b9)]()+0x1)[_0x465b0a(0x37c)]()[_0x465b0a(0x2d7)](0x2,'0')+'/'+_0x2fb031[_0x465b0a(0x2ac)]()['toString']()[_0x465b0a(0x2d7)](0x2,'0')+'\x20'+_0x2fb031[_0x465b0a(0x26b)]()[_0x465b0a(0x37c)]()[_0x465b0a(0x2d7)](0x2,'0')+':'+_0x2fb031[_0x465b0a(0x230)]()[_0x465b0a(0x37c)]()[_0x465b0a(0x2d7)](0x2,'0')+':'+_0x2fb031[_0x465b0a(0x1e3)]()['toString']()[_0x465b0a(0x2d7)](0x2,'0');}function getTimeStamp(){const _0x3c218b=_0x1bc878,_0x2f4e76=shiftedTime();return _0x2f4e76[_0x3c218b(0x3fe)]()+'/'+(_0x2f4e76[_0x3c218b(0x2b9)]()+0x1)[_0x3c218b(0x37c)]()[_0x3c218b(0x2d7)](0x2,'0')+'/'+_0x2f4e76['getDate']()['toString']()['padStart'](0x2,'0')+'\x20'+_0x2f4e76['getHours']()[_0x3c218b(0x37c)]()[_0x3c218b(0x2d7)](0x2,'0')+':'+_0x2f4e76[_0x3c218b(0x230)]()[_0x3c218b(0x37c)]()[_0x3c218b(0x2d7)](0x2,'0')+':'+_0x2f4e76[_0x3c218b(0x1e3)]()[_0x3c218b(0x37c)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x4351bf=_0x1bc878,_0x4106ba=shiftedTime();return _0x4106ba[_0x4351bf(0x3fe)]()+(_0x4106ba[_0x4351bf(0x2b9)]()+0x1)['toString']()[_0x4351bf(0x2d7)](0x2,'0')+_0x4106ba[_0x4351bf(0x2ac)]()[_0x4351bf(0x37c)]()['padStart'](0x2,'0')+'-'+_0x4106ba['getHours']()[_0x4351bf(0x37c)]()[_0x4351bf(0x2d7)](0x2,'0')+_0x4106ba[_0x4351bf(0x230)]()[_0x4351bf(0x37c)]()[_0x4351bf(0x2d7)](0x2,'0')+_0x4106ba[_0x4351bf(0x1e3)]()[_0x4351bf(0x37c)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x43c418=_0x1bc878,_0x1edafd=new Date();let _0x35bee3=_0x1edafd;if(settings[_0x43c418(0x39a)]&&settings[_0x43c418(0x39a)]!==0x0)_0x35bee3=fns[_0x43c418(0x2d1)](_0x1edafd,{'hours':settings[_0x43c418(0x39a)]});return _0x35bee3;}async function startScheduler(){const _0x17f0f4=_0x1bc878,_0xac6b95=new Date()[_0x17f0f4(0x2b2)](),_0x59817c=shiftedTime()['getHours']();_0x59817c==0x4&&backupConfigFiles(),_0x59817c==0x0&&(rotateLogFiles(),logger[_0x17f0f4(0x2f6)](_0x17f0f4(0x2f9)),logger[_0x17f0f4(0x2f6)](_0x17f0f4(0x3a2)+serverversion+_0x17f0f4(0x1f5)+(environment==_0x17f0f4(0x339)?_0x17f0f4(0x3cc):'')+'\x0a'),logger['debug']('-----------------------------------------------------------------------------------')),_0xac6b95%0x6==0x0&&triggerAnalytics(),_0xac6b95%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x2028cd){const _0x147bd4=_0x1bc878;logger[_0x147bd4(0x2f6)](_0x147bd4(0x3db)+_0x2028cd);const _0x4236d4=getBotsWithMode();_0x4236d4[_0x147bd4(0x344)]>0x0?confirmRestore(configbackuppath,_0x2028cd):unzipFile(configbackuppath,_0x2028cd);}async function getBackupFiles(_0x54bdaf=null){const _0x29d7eb=_0x1bc878;let _0x17adbc=[],_0x2ff181=fs[_0x29d7eb(0x318)](configbackuppath,{'withFileTypes':!![]});_0x2ff181[_0x29d7eb(0x336)]((_0x115113,_0x43ff9f)=>_0x115113[_0x29d7eb(0x2e8)]<_0x43ff9f['name']?0x1:_0x43ff9f[_0x29d7eb(0x2e8)]<_0x115113['name']?-0x1:0x0),_0x2ff181[_0x29d7eb(0x21a)](_0x22bb05=>{const _0x1811ff=_0x29d7eb;if(!_0x22bb05[_0x1811ff(0x398)]()&&_0x22bb05[_0x1811ff(0x2e8)][_0x1811ff(0x38a)](_0x1811ff(0x29c))&&_0x22bb05[_0x1811ff(0x2e8)]['endsWith'](_0x1811ff(0x2ca))){const _0x3ad7bb=formatDate(fs[_0x1811ff(0x1e9)](configbackuppath+_0x22bb05[_0x1811ff(0x2e8)])[_0x1811ff(0x248)]);_0x17adbc['push']({'name':_0x22bb05[_0x1811ff(0x2e8)],'mtime':_0x3ad7bb});}});if(_0x54bdaf)io['to'](_0x54bdaf)[_0x29d7eb(0x332)](_0x29d7eb(0x26f),_0x17adbc);else return _0x17adbc;}async function backupConfigFiles(){const _0x1855fa=_0x1bc878;await zipFiles('backup-full');const _0xafbf08=getCleanTimeStamp();fs[_0x1855fa(0x289)](zippath+_0x1855fa(0x21d),configbackuppath+(_0x1855fa(0x29c)+_0xafbf08+_0x1855fa(0x2ca)));let _0x20d633=fs[_0x1855fa(0x318)](configbackuppath,{'withFileTypes':!![]});_0x20d633[_0x1855fa(0x336)]((_0x411da8,_0x119481)=>_0x411da8[_0x1855fa(0x2e8)]<_0x119481[_0x1855fa(0x2e8)]?0x1:_0x119481[_0x1855fa(0x2e8)]<_0x411da8[_0x1855fa(0x2e8)]?-0x1:0x0),_0x20d633[_0x1855fa(0x344)]>maxBackups&&fs[_0x1855fa(0x310)](configbackuppath+_0x20d633[_0x20d633[_0x1855fa(0x344)]-0x1]['name']);}function rotateLogFiles(){const _0x37a5e6=_0x1bc878,_0x4e2dc7=fs[_0x37a5e6(0x1e9)](logspath+_0x37a5e6(0x1f6)),_0x5a4a05=_0x4e2dc7[_0x37a5e6(0x1f9)]/0x400;if(_0x5a4a05>0x64){let _0x4b19dd=fs[_0x37a5e6(0x318)](logspath,{'withFileTypes':!![]});_0x4b19dd[_0x37a5e6(0x336)]((_0x113d88,_0x34aedf)=>_0x113d88['name']<_0x34aedf['name']?0x1:_0x34aedf[_0x37a5e6(0x2e8)]<_0x113d88[_0x37a5e6(0x2e8)]?-0x1:0x0),_0x4b19dd['forEach'](_0x5a9fef=>{const _0x1fa4b7=_0x37a5e6;if(_0x5a9fef[_0x1fa4b7(0x2e8)]==_0x1fa4b7(0x3e2))fs[_0x1fa4b7(0x289)](logspath+_0x5a9fef[_0x1fa4b7(0x2e8)],logspath+_0x1fa4b7(0x22b));if(_0x5a9fef['name']=='output-001.log')fs[_0x1fa4b7(0x289)](logspath+_0x5a9fef[_0x1fa4b7(0x2e8)],logspath+_0x1fa4b7(0x3e2));_0x5a9fef[_0x1fa4b7(0x2e8)]==_0x1fa4b7(0x1f6)&&(fs[_0x1fa4b7(0x289)](logspath+_0x5a9fef['name'],logspath+_0x1fa4b7(0x291)),fs['writeFileSync'](logspath+_0x5a9fef[_0x1fa4b7(0x2e8)],''));});}}async function zipFiles(_0x88318){const _0x5c43ce=_0x1bc878;let _0x3645a0;if(_0x88318=='logs')_0x3645a0=logspath;if(_0x88318==_0x5c43ce(0x1ee))_0x3645a0=configpath;if(_0x88318==_0x5c43ce(0x35d))_0x3645a0=configpath;let _0x18c5c6=fs['readdirSync'](_0x3645a0,{'withFileTypes':!![]});const _0x5b11f5=new JSZip();_0x18c5c6[_0x5c43ce(0x21a)](_0x16388f=>{const _0x10e302=_0x5c43ce;if(!_0x16388f['isDirectory']()){let _0x5285fc=fs[_0x10e302(0x31f)](_0x3645a0+_0x16388f[_0x10e302(0x2e8)]);if(_0x88318=='backup'){const _0x56218f=/^bot-[0-9]{3}-config.json$/,_0x14c875=_0x56218f[_0x10e302(0x1ed)](_0x16388f[_0x10e302(0x2e8)]);if(_0x14c875){const _0x14ab61=JSON['parse'](_0x5285fc);if(_0x14ab61[_0x10e302(0x3ef)][0x0]){_0x14ab61[_0x10e302(0x3ef)][0x0][_0x10e302(0x3b9)]='***',_0x14ab61[_0x10e302(0x3ef)][0x0]['apiSecret']=_0x10e302(0x31b);if(_0x14ab61[_0x10e302(0x3ef)][0x0][_0x10e302(0x262)])_0x14ab61[_0x10e302(0x3ef)][0x0]['apiPassword']=_0x10e302(0x31b);}_0x5285fc=JSON[_0x10e302(0x392)](_0x14ab61,null,0x2);}if(_0x16388f[_0x10e302(0x2e8)]==_0x10e302(0x3e9)){const _0x151301=JSON[_0x10e302(0x247)](_0x5285fc);if(_0x151301[_0x10e302(0x2aa)]['loginRequired'])_0x151301[_0x10e302(0x2aa)][_0x10e302(0x263)]=![];if(_0x151301[_0x10e302(0x2aa)]['bbPassword'])_0x151301[_0x10e302(0x2aa)][_0x10e302(0x357)]='***';if(_0x151301[_0x10e302(0x2aa)]['telegramToken'])_0x151301['settings']['telegramToken']='***';if(_0x151301[_0x10e302(0x2aa)][_0x10e302(0x253)])_0x151301[_0x10e302(0x2aa)][_0x10e302(0x253)]=null;if(_0x151301[_0x10e302(0x2aa)][_0x10e302(0x395)])_0x151301[_0x10e302(0x2aa)][_0x10e302(0x395)]=_0x10e302(0x31b);_0x5285fc=JSON[_0x10e302(0x392)](_0x151301,null,0x2);}if(_0x16388f[_0x10e302(0x2e8)]!=_0x10e302(0x1e0))_0x5b11f5[_0x10e302(0x206)](_0x16388f[_0x10e302(0x2e8)],_0x5285fc);}else _0x5b11f5[_0x10e302(0x206)](_0x16388f[_0x10e302(0x2e8)],_0x5285fc);}});const _0x4dd40a=await _0x5b11f5['generateAsync']({'type':_0x5c43ce(0x259),'base64':![],'compression':_0x5c43ce(0x3fb)});fs['writeFileSync'](zippath+(_0x88318+_0x5c43ce(0x2ca)),_0x4dd40a,'binary');}async function unzipFile(_0x33ae4e,_0x4df97f){const _0x4b980e=_0x1bc878;fs[_0x4b980e(0x318)](configpath,{'withFileTypes':!![]})['forEach'](_0x106faf=>{const _0xb75f95=_0x4b980e;if(!_0x106faf[_0xb75f95(0x398)]())fs[_0xb75f95(0x31c)](configpath+_0x106faf[_0xb75f95(0x2e8)]);});const _0x23784b=fs[_0x4b980e(0x31f)](_0x33ae4e+_0x4df97f,_0x4b980e(0x3dd)),_0x56c8e0=await JSZip[_0x4b980e(0x20d)](_0x23784b,{'base64':![],'checkCRC32':!![]});for(const _0x1d7cdf of Object['keys'](_0x56c8e0[_0x4b980e(0x2da)])){const _0x20684c=_0x56c8e0[_0x4b980e(0x2da)][_0x1d7cdf],_0x418816=await _0x20684c[_0x4b980e(0x2b8)](_0x4b980e(0x259));fs['writeFileSync'](configpath+_0x20684c[_0x4b980e(0x2e8)],_0x418816);}fs[_0x4b980e(0x318)](temppath,{'withFileTypes':!![]})[_0x4b980e(0x21a)](_0xfa1107=>{const _0x2b7853=_0x4b980e;if(!_0xfa1107[_0x2b7853(0x398)]())fs[_0x2b7853(0x31c)](temppath+_0xfa1107[_0x2b7853(0x2e8)]);}),logger[_0x4b980e(0x2f6)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x4b980e(0x279)]({'restore':!![]},_0x4ce7d3=>{});}async function getPublicIp(){const _0x1ea536=_0x1bc878;try{const _0x261c4e=await axios[_0x1ea536(0x329)]('https://api.ipify.org?format=json');publicip=_0x261c4e[_0x1ea536(0x2ef)]['ip'];}catch(_0x1e0063){}}async function triggerAnalytics(){const _0x22c63d=_0x1bc878;if(!publicip)await getPublicIp();const _0x4c13f6=getBotsWithMode();let _0x5ef6f1=0x0;_0x4c13f6[_0x22c63d(0x21a)](_0x440f61=>{const _0x3028cb=_0x22c63d;if(_0x440f61[_0x3028cb(0x31d)]==='enabled')_0x5ef6f1++;});const _0x43c458=getBotExchanges();mixpanel[_0x22c63d(0x25b)](_0x22c63d(0x2b1),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x4c13f6[_0x22c63d(0x344)],'numbotsenabled':_0x5ef6f1,'exchanges':_0x43c458,'environment':environment});}async function getMessages(){const _0x5d779b=_0x1bc878,_0xda206e=_0x5d779b(0x3e4),_0x49982e=new GraphQLClient(_0xda206e),_0x21a631={'authorization':_0x5d779b(0x400)},_0x5a592c=serverversion['split']('.'),_0x1bec8c=_0x5a592c[0x0]+'.'+_0x5a592c[0x1],_0x3a29d9=Math[_0x5d779b(0x26c)](settings[_0x5d779b(0x39e)],settings[_0x5d779b(0x303)]),_0x3eda28={'last':parseInt(_0x3a29d9),'bbm':_0x1bec8c},_0x4a21a0=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x30323e;try{_0x30323e=await _0x49982e[_0x5d779b(0x1f1)](_0x4a21a0,_0x3eda28,_0x21a631);}catch(_0x18693d){}if(_0x30323e&&_0x30323e[_0x5d779b(0x2c7)]){let _0x131237=settings[_0x5d779b(0x39e)];newMessages=[];for(const _0x4c4782 of _0x30323e[_0x5d779b(0x2c7)]){newMessages[_0x5d779b(0x389)](_0x4c4782);let _0x5dab90=![];_0x4c4782[_0x5d779b(0x379)]&&(updateSetting(_0x5d779b(0x211),_0x4c4782[_0x5d779b(0x379)]),_0x5dab90=isNewerVersion(serverversion,_0x4c4782['bbvNew'])||serverversion==_0x4c4782[_0x5d779b(0x379)]);if(!_0x5dab90&&_0x4c4782[_0x5d779b(0x2a6)]>_0x131237){if(_0x4c4782[_0x5d779b(0x297)]===_0x5d779b(0x28c)||serverversion[_0x5d779b(0x38a)](_0x4c4782['bbvReceive'])){let _0x317416=''+_0x4c4782[_0x5d779b(0x2bc)]+'\x0a\x0a'+_0x4c4782[_0x5d779b(0x3fc)];const _0xe5bf46=await sendTelegramMsg(toTelegramMarkdown(_0x317416),_0x5d779b(0x3f8));if(_0xe5bf46)_0x131237=_0x4c4782['number'];}}}updateAvailable=isNewerVersion(settings[_0x5d779b(0x211)],serverversion),updateSetting(_0x5d779b(0x39e),_0x131237),emitMessages();}}function emitMessages(){const _0xffdcfc=_0x1bc878,_0x1b8ec2=settings[_0xffdcfc(0x303)];let _0x5e647b=[];newMessages[_0xffdcfc(0x21a)](_0x1b207a=>{const _0x4db371=_0xffdcfc;_0x1b207a[_0x4db371(0x2a6)]>_0x1b8ec2&&_0x5e647b[_0x4db371(0x389)](_0x1b207a);}),_0x5e647b[_0xffdcfc(0x344)]>0x0&&getAllClients()[_0xffdcfc(0x21a)](_0x2a638c=>{const _0x3ff913=_0xffdcfc;getSocket(_0x2a638c['id'])[_0x3ff913(0x332)](_0x3ff913(0x3fc),_0x5e647b);});}function confirmMessage(_0x5ee483){const _0x667e6c=_0x1bc878;updateSetting(_0x667e6c(0x303),Number(_0x5ee483));}function isNewerVersion(_0x4a67a6,_0x2ad63f){const _0x1221de=_0x1bc878,_0x3b4291=_0x2ad63f[_0x1221de(0x371)]('.'),_0x3ecea1=_0x4a67a6[_0x1221de(0x371)]('.');for(var _0x1a0532=0x0;_0x1a0532<_0x3ecea1[_0x1221de(0x344)];_0x1a0532++){const _0xc5a8c8=~~_0x3ecea1[_0x1a0532],_0x1f0cf9=~~_0x3b4291[_0x1a0532];if(_0xc5a8c8>_0x1f0cf9)return!![];if(_0xc5a8c8<_0x1f0cf9)return![];}return![];}function toTelegramMarkdown(_0x7c3269){const _0x5f2d8e=_0x1bc878,_0x27bdfd=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x2fe657=/\*{2}(.+?)\*{2}/gim;return _0x7c3269=_0x7c3269[_0x5f2d8e(0x3c1)](_0x27bdfd,_0x5f2d8e(0x2fb))['replace'](_0x2fe657,'*$1*'),_0x7c3269;}async function validateConfigFile(){const _0x536b49=_0x1bc878,_0x4c601c=dbConfig['get'](_0x536b49(0x204))['sortBy'](_0x536b49(0x245))[_0x536b49(0x2cd)]()||[];if(_0x4c601c[_0x536b49(0x344)]==0x0){let _0x2e0a20=0x0,_0x821ea9=[];const _0x4c3209=/^bot-([0-9]{3})-config.json$/,_0x2d2093=fs[_0x536b49(0x318)](configpath);_0x2d2093[_0x536b49(0x21a)](_0x342687=>{const _0x4645b1=_0x536b49,_0x4981b2=_0x4c3209[_0x4645b1(0x2ce)](_0x342687);if(_0x4981b2){const _0xc951d1=_0x4981b2[0x1];let _0x1190b1=getBotAttributes(_0xc951d1);_0x821ea9[_0x4645b1(0x389)]({'botID':_0xc951d1,'botname':_0x1190b1[_0x4645b1(0x305)],'status':'disabled','live':'stopped'}),_0x2e0a20++;}}),_0x2e0a20!=0x0&&(dbConfig['get'](_0x536b49(0x204))[_0x536b49(0x2e6)](_0x821ea9)[_0x536b49(0x374)](),config=_0x821ea9,restoredConfigFile=_0x2e0a20);}}async function restoreConfigNotify(_0x55e12a){const _0x21fd51=_0x1bc878;let _0x4c11ca;if(restoredConfigFile==0x1)_0x4c11ca=_0x21fd51(0x2c5);else _0x4c11ca=_0x21fd51(0x2eb);if(_0x55e12a)io['to'](_0x21fd51(0x3d7))['emit']('notification',_0x4c11ca);else{logger['simple'](_0x21fd51(0x2f9)),logger[_0x21fd51(0x2b6)](_0x4c11ca),logger[_0x21fd51(0x2b6)](_0x21fd51(0x2f9)),logger[_0x21fd51(0x2b6)]('');if(tgBot&&settings[_0x21fd51(0x253)]&&settings['telegramEvents']!=_0x21fd51(0x338))await sendTelegram(settings[_0x21fd51(0x253)],'Bot\x20Mgr\x20>\x20'+_0x4c11ca);}}function decryptRSA(_0x2d021d,_0x281d57){const _0x5d3fae=_0x1bc878,_0x1c13c0=forge['pki'][_0x5d3fae(0x2c4)](_0x2d021d),_0x93d252=_0x1c13c0['decrypt'](forge[_0x5d3fae(0x23b)][_0x5d3fae(0x2df)](_0x281d57),_0x5d3fae(0x28f),{'md':forge['md']['sha256'][_0x5d3fae(0x3cf)](),'mgf1':{'md':forge['md']['sha256']['create']()}});return _0x93d252;}function validateCredentials(_0x470f86,_0x2436fe){const _0x7a7022=_0x1bc878;if(_0x470f86[_0x7a7022(0x23d)]==settings[_0x7a7022(0x3d8)]&&bcrypt['compareSync'](_0x470f86['password'],settings[_0x7a7022(0x357)])){if(settings['f2aRequired'])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0xeb00c5=generateLoginToken(_0x2436fe);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0xeb00c5};}}else return{'allow':![],'reason':_0x7a7022(0x2a9),'token':null};}function refreshToken(_0x58ef27){const _0x421352=generateLoginToken(_0x58ef27);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x421352};}function validateAccess(_0x6eb7d9,_0x3a9cff,_0x574126){const _0x55a0bc=_0x1bc878,_0x28f434=_0x574126?_0x574126:devices[_0x3a9cff]['ip'];let _0x5e1c91;const _0x5a9cb2=_0x29d46c=>{const _0x57657b=_0x5607;if(settings[_0x57657b(0x263)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x3a9cff)){const _0x3916e0=generateLoginToken(_0x3a9cff);return{'allow':!![],'reason':_0x57657b(0x3ff),'token':_0x3916e0};}else return{'allow':![],'reason':_0x57657b(0x341),'token':null};}else return _0x5e1c91=validToken(_0x29d46c,_0x3a9cff),_0x5e1c91['hasOwnProperty'](_0x57657b(0x3e6))?{'allow':!![],'reason':_0x57657b(0x29b),'token':_0x29d46c}:{'allow':![],'reason':_0x57657b(0x341),'token':null};}else return{'allow':!![],'reason':_0x57657b(0x2ad),'token':null};};if(settings['whitelistEnabled']){let _0x1fd614=[...settings['whitelist'],_0x55a0bc(0x26a),_0x55a0bc(0x347),'127.0.0.1'];if(_0x1fd614['includes'](_0x28f434))return _0x5a9cb2(_0x6eb7d9);else{_0x5e1c91=validToken(_0x6eb7d9,_0x3a9cff);if(_0x5e1c91[_0x55a0bc(0x321)](_0x55a0bc(0x3e6)))return _0x5a9cb2(_0x6eb7d9);else{if(telegramIpApproved(_0x3a9cff)){const _0x3d8546=generateToken(_0x3a9cff);return _0x5e1c91=_0x5a9cb2(_0x6eb7d9),_0x5e1c91['allow']?{'allow':!![],'reason':_0x55a0bc(0x277),'token':_0x3d8546}:_0x5e1c91;}else return settings[_0x55a0bc(0x2f4)]?{'allow':![],'reason':_0x55a0bc(0x378),'token':null}:{'allow':![],'reason':_0x55a0bc(0x356),'token':null};}}}else return _0x5a9cb2(_0x6eb7d9);}function timelyDecrypt(_0x132842,_0x148e09,_0x25d79d='@'){const _0x3a9dcc=_0x1bc878;if(_0x132842)try{const _0x18d140=decryptRSA(secure[_0x3a9dcc(0x25c)],_0x132842),_0x14032f=_0x18d140[_0x3a9dcc(0x371)](_0x25d79d)[0x0],_0x2c7947=_0x18d140[_0x3a9dcc(0x371)](_0x25d79d)[0x1],_0x20f6e3=new Date()['getTime']();if(_0x148e09){if(_0x20f6e3-_0x2c7947<maxSecretAge*0x3e8)return _0x14032f;else return![];}else return _0x14032f;}catch(_0x358da7){return![];}else return![];}const validToken=(_0x3a73ce,_0x42e7af)=>{const _0x256e48=_0x1bc878,_0x4e01c3=devices[_0x42e7af]['ip'];if(!_0x3a73ce)return{'error':_0x256e48(0x3be)};for(let _0x21f107 of blacklist){if(_0x21f107[_0x256e48(0x3f2)]==_0x3a73ce)return{'error':_0x256e48(0x3c5)};}let _0x3adf2e;try{_0x3adf2e=jwt['verify'](_0x3a73ce,secure[_0x256e48(0x3fd)]+_0x42e7af);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x3adf2e['hasOwnProperty'](_0x256e48(0x203))&&!_0x3adf2e[_0x256e48(0x321)](_0x256e48(0x23d))||!_0x3adf2e[_0x256e48(0x321)](_0x256e48(0x1e2)))return{'error':_0x256e48(0x345)};if(!_0x3adf2e['hasOwnProperty'](_0x256e48(0x23d))&&_0x3adf2e[_0x256e48(0x321)](_0x256e48(0x203))){const {clientip:_0x5458fc}=_0x3adf2e;return _0x4e01c3==_0x5458fc?{'success':_0x256e48(0x32c)}:{'error':_0x256e48(0x2ea)};}else{if(_0x3adf2e[_0x256e48(0x321)](_0x256e48(0x23d))&&_0x3adf2e['hasOwnProperty'](_0x256e48(0x203))){const {username:_0x34ef4d,clientip:_0x240875}=_0x3adf2e;return settings['bbUsername']==_0x34ef4d&&_0x4e01c3==_0x240875?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x256e48(0x3a5)};}}},generateLoginToken=_0x7af23a=>{const _0x29b18b=_0x1bc878;if(_0x7af23a){const _0x1772a2=devices[_0x7af23a]['ip'];return jwt['sign']({'username':settings[_0x29b18b(0x3d8)],'clientip':_0x1772a2},secure[_0x29b18b(0x3fd)]+_0x7af23a,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x3792a6=>{const _0x7b78b3=_0x1bc878;if(_0x3792a6){const _0x34d9db=devices[_0x3792a6]['ip'];return jwt['sign']({'clientip':_0x34d9db},secure['secret']+_0x3792a6,{'expiresIn':devices[_0x3792a6][_0x7b78b3(0x29e)]['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x421c24=>{const _0x5995b1=_0x1bc878;let _0x230dc4=![];return devices[_0x421c24][_0x5995b1(0x29e)]&&devices[_0x421c24][_0x5995b1(0x29e)]['expiry']!=_0x5995b1(0x311)&&(_0x230dc4=devices[_0x421c24][_0x5995b1(0x29e)][_0x5995b1(0x203)]==devices[_0x421c24]['ip']&&new Date()['getTime']()-devices[_0x421c24][_0x5995b1(0x29e)][_0x5995b1(0x22a)]<devices[_0x421c24][_0x5995b1(0x29e)]['expiry']*0x3c*0x3e8),_0x230dc4;},telegram2FaApproved=_0x1881dd=>{const _0x59312b=_0x1bc878;let _0x109888=![];return devices[_0x1881dd][_0x59312b(0x2a2)]&&devices[_0x1881dd]['telegram2FaApproval']['expiry']!=_0x59312b(0x311)&&(_0x109888=devices[_0x1881dd][_0x59312b(0x2a2)]['clientip']==devices[_0x1881dd]['ip']&&new Date()[_0x59312b(0x251)]()-devices[_0x1881dd]['telegram2FaApproval'][_0x59312b(0x22a)]<devices[_0x1881dd]['telegram2FaApproval'][_0x59312b(0x2e5)]*0x3c*0x3e8),_0x109888;},normalizeIP=_0x10eb20=>{const _0x3bde98=_0x1bc878;let _0x293c40=null,_0x3056f3=null;if(ipaddr[_0x3bde98(0x3b1)](_0x10eb20)){const _0xa8f3cf=ipaddr[_0x3bde98(0x247)](_0x10eb20);_0xa8f3cf['kind']()===_0x3bde98(0x3df)?(_0xa8f3cf[_0x3bde98(0x27a)]()&&(_0x293c40=_0xa8f3cf[_0x3bde98(0x3e0)]()[_0x3bde98(0x37c)]()),_0x3056f3=_0xa8f3cf['toString']()):(_0x293c40=_0xa8f3cf['toString'](),_0x3056f3=_0xa8f3cf[_0x3bde98(0x24d)]()['toString']());}return{'show':_0x293c40?_0x293c40:_0x3056f3,'store':_0x3056f3};};function formatDate(_0x68f37b){const _0x2db272=_0x1bc878;return _0x68f37b[_0x2db272(0x3fe)]()+'/'+(_0x68f37b['getMonth']()+0x1)[_0x2db272(0x37c)]()['padStart'](0x2,'0')+'/'+_0x68f37b['getDate']()[_0x2db272(0x37c)]()['padStart'](0x2,'0')+'\x20'+_0x68f37b[_0x2db272(0x26b)]()[_0x2db272(0x37c)]()[_0x2db272(0x2d7)](0x2,'0')+':'+_0x68f37b[_0x2db272(0x230)]()[_0x2db272(0x37c)]()['padStart'](0x2,'0')+':'+_0x68f37b[_0x2db272(0x1e3)]()[_0x2db272(0x37c)]()[_0x2db272(0x2d7)](0x2,'0');}function sleep(_0x245a73){return new Promise(_0x46b8c8=>setTimeout(_0x46b8c8,_0x245a73));}