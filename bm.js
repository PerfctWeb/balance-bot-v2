const _0x58a6d1=_0x44bd;(function(_0x55083f,_0x4e9f8c){const _0x475db8=_0x44bd,_0x304793=_0x55083f();while(!![]){try{const _0xdb1e73=parseInt(_0x475db8(0x29c))/0x1+parseInt(_0x475db8(0x2eb))/0x2*(parseInt(_0x475db8(0x280))/0x3)+parseInt(_0x475db8(0x1cd))/0x4*(parseInt(_0x475db8(0x2b5))/0x5)+parseInt(_0x475db8(0x216))/0x6*(parseInt(_0x475db8(0x37c))/0x7)+-parseInt(_0x475db8(0x2fa))/0x8+-parseInt(_0x475db8(0x2e3))/0x9*(-parseInt(_0x475db8(0x227))/0xa)+-parseInt(_0x475db8(0x36d))/0xb*(parseInt(_0x475db8(0x23d))/0xc);if(_0xdb1e73===_0x4e9f8c)break;else _0x304793['push'](_0x304793['shift']());}catch(_0x5b8614){_0x304793['push'](_0x304793['shift']());}}}(_0x4f52,0xb3016));const _0x389768=function(){let _0x3138ad=!![];return function(_0x112442,_0x29ed8d){const _0x7710b0=_0x3138ad?function(){if(_0x29ed8d){const _0x5a5a24=_0x29ed8d['apply'](_0x112442,arguments);return _0x29ed8d=null,_0x5a5a24;}}:function(){};return _0x3138ad=![],_0x7710b0;};}(),_0xfe5853=_0x389768(this,function(){const _0x59f2c1=_0x44bd;return _0xfe5853[_0x59f2c1(0x1bc)]()[_0x59f2c1(0x1dd)]('(((.+)+)+)+$')['toString']()[_0x59f2c1(0x278)](_0xfe5853)[_0x59f2c1(0x1dd)](_0x59f2c1(0x205));});_0xfe5853();'use strict';process[_0x58a6d1(0x258)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x58a6d1(0x2a5)),fs=require('fs'),fns=require(_0x58a6d1(0x1b3)),low=require(_0x58a6d1(0x36f)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x58a6d1(0x309)),crypto=require(_0x58a6d1(0x37e)),Crypt=require('hybrid-crypto-js')[_0x58a6d1(0x297)],RSA=require('hybrid-crypto-js')['RSA'],bcrypt=require(_0x58a6d1(0x291)),jwt=require('jsonwebtoken'),ipaddr=require('ipaddr.js'),argv=require(_0x58a6d1(0x29d))(process[_0x58a6d1(0x2b2)][_0x58a6d1(0x21f)](0x2))['argv'],uuidRandom=require('uuid-random'),TelegramBot=require(_0x58a6d1(0x1c3)),Mixpanel=require(_0x58a6d1(0x25b)),axios=require('axios'),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x58a6d1(0x21c)),fileUpload=require(_0x58a6d1(0x31d)),{networkInterfaces}=require('os'),PORT=argv[_0x58a6d1(0x1b5)]||_0x58a6d1(0x30c),pattern=/^[0-9]{2,4}$/;!pattern[_0x58a6d1(0x26d)](PORT)&&(console[_0x58a6d1(0x1bd)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x58a6d1(0x27a)),process['exit'](0x1));const HOST=argv[_0x58a6d1(0x32f)]||null,userID=argv[_0x58a6d1(0x319)]||'',debugging=argv['d']||![],nodeversion=process[_0x58a6d1(0x350)][_0x58a6d1(0x1b4)];let bbpath='bb/',bbpath2='';const botfile=_0x58a6d1(0x214),configfile=_0x58a6d1(0x338),settingsfile=_0x58a6d1(0x329),securefile=_0x58a6d1(0x2ea),maxBackups=0xa;let validInstallation=!![];function _0x4f52(){const _0x3f4def=['bot-','notification','publicKey','39700cFXYKH','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','restore-backup-file','sort','stopPolling','Unauthorized\x20attempt\x20to\x20confirm\x20message','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','output-000.log',':\x20Bot\x20Mgr\x20>\x20','Unauthorized\x20attempt\x20to\x20log\x20out','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','getSeconds','SIGTERM','initclient','Backup\x20file\x20uploaded','live','apiSecret','writeFileSync','/update\x20-\x20update\x20Balance\x20Bot\x0a','HTML','reset-password','telegramToken','186804zFStjA','login\x20token\x20generated','all','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Invalid\x20Telegram\x20token','bbvNew','onepagemode','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Login\x20accepted','=>\x20Go\x20to\x20#BLU#http://','Error\x20while\x20deleting\x20config\x20files:\x20','referer','sendPortfolioTelegram','getDate','settings.','getHours','once','privateKey','reload','any','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Password\x20reset\x20rejected','update-bb','/:bot/portfolio','https://api.ipify.org?format=json','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','max','env','pidRefreshToken','Ok,\x20will\x20send\x20order\x20notifications\x20only','mixpanel','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','f2aRequired','event','Unauthorized\x20attempt\x20to\x20download\x20','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','botID','_data','server','All','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','number','catch','readdirSync','show','replace','timeshift','$1_$2_$3','test','removeAllListeners','compareSync','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','find','download','#RES#\x20if\x20running\x20on\x20server','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','All\x20bots\x20running\x20right\x20now','/enable\x20-\x20enable\x20notifications\x0a','file','constructor','telegram',',\x20must\x20be\x20a\x204\x20digit\x20number','backup/','alias','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','\x20>\x20','output-003.log','12mARnsP','botname','kill','isValid','5\x20min','Unauthorized\x20attempt\x20to\x20delete\x20alerts','***','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','createWriteStream','post','Disabled\x20Bot\x20','blacklist','Unauthorized\x20attempt\x20to\x20update\x20settings','DEFLATE','use','debug','Bot\x20','bcryptjs','\x20|\x20client:\x20...','Unauthorized\x20attempt\x20to\x20show\x20configuration','orders','backupfile','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Crypt','emitHistory','accept','Unauthorized\x20attempt\x20to\x20update\x20bot','Setting\x20access:\x20','1276591UunevG','yargs/yargs','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','isIPv4MappedAddress','inherit','-performance.json','reset-history','getMinutes','Starting\x20bot\x20|\x20Bot\x20','child_process','Alerts','startsWith','You\x20can\x20use\x20the\x20following\x20commands:\x0a','remoteAddress','type','deleteHistoryAlerts','storeConfiguration','zip/','update-bot','/:bot',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','/off\x20-\x20stop\x20bot(s)\x0a','argv','ipc','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','10OQfVNM','botmanager','\x20mode','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','2FA\x20required',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','RSA-OAEP','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','userid','sha256','clients','#RES#\x0a','removeListener','Bot\x20Mgr\x20>\x20','Session\x20expired\x20for\x20user\x20...','unlinkSync','/:bot/history','=>\x20Go\x20to\x20#BLU#http://127.0.0.1:','1000','new','Unauthorized\x20attempt\x20to\x20get\x20messages','add-bot','timestamp','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','login','All\x20bots','reinstall','decrypt','No\x20authentication\x20token','whitelistEnabled','#RES#\x20if\x20running\x20locally\x0a','uuid','storeFiat','Unauthorized\x20attempt\x20to\x20store\x20configuration','node-zip','internal','defaults','hasOwnProperty','password','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','login\x20not\x20required','backup-full.zip','temporary\x20token\x20generated','format','temp/','Starting\x20new\x20bot\x20|\x20Bot\x20','1035Ktsrer','getStartingBalances','size','exec','User\x20has\x20been\x20validated','latestversion','getFullYear','bb-secure.json','315424EuVOFY','/on\x20-\x20start\x20bot(s)\x0a','messages','*$1*','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Notifications\x20enabled\x0a','store','resetHistory','full','title','send','-events.json','-----------------------------------------------------------------------------------','Backup\x20file\x20unzipped\x20and\x20stored','Access\x20enabled\x20for\x20','236400duVYOP','createServer','index.html','getMonth','forEach','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','get-messages','files','message','sendFile','manual','access','Unauthorized\x20attempt\x20to\x20add\x20bot','config/','whitelist','path','new-disabled','readFileSync','3000','2FA\x20login\x20required','http','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','bbUsername','socket.io','copyFileSync','handshake','telegrammsg','telegramEvents','chat','data','function','user','parse','telegramUsername','getTime','express-fileupload','place-order','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','value','Invalid\x20authentication\x20token\x20(1)','args','private','get-starting-balances','login\x20required','Starting\x20Balance\x20Bot\x20','Yes','pidExpireLogin','bb-settings.json','headless','map','family','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','host','telegram2FaApproval','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Invalid\x20username\x20or\x20IP\x20address','access\x20timeout','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','set','Logged\x20out\x20user\x20...','-config.json','bb-config.json','connection','Node.js\x20v','verify','logged\x20out','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','keys','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','lastmsgemitted','error','backup-full','onText','mkdirSync','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','allow','write','length','assign','2FA','hashSync','cloneDeep','store-configuration','bbPassword','Notifications\x20types:\x20','versions','push','backup','includes','/:bot/performance','get','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','settings','exit','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','generateKeyPairAsync','Restore\x20process\x20aborted','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','binary','restart','Logged\x20in\x20user\x20...','api-eu.mixpanel.com','temporary\x20access\x20not\x20allowed','listen','delete-bot','disabled','bots','loginRequired','\x1b[34m','Notifications\x20disabled\x0a','backup-full@','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','simple','socket','2563JzSbUr','IPv4','lowdb','127.0.0.1','polling_error','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','track','updatebotmanager','token','split','apiPassword','then','logout','statSync','add','2237844CHgAeo','.zip','crypto','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Token\x20blacklisted','reason','date-fns','node','port','SIGINT','running','************','tkn','auto','sendMetricsTelegram','toString','log','Starting\x20#RED#Balance\x20Bot\x20v','bbvReceive','answerCallbackQuery','stop','toIPv4MappedAddress','node-telegram-bot-api','</b>\x20?','params','Login\x20rejected','exp','match','kind','ipv6','address','join','2772988hkaons','name','build2','\x1b[31m','success','init','disconnect','temporaryAccessAllowed','started','headers','/status\x20-\x20show\x20bot(s)\x20status\x0a','temporary\x20access\x20timeout','telegramIpApproval','from','emit','/help\x20-\x20show\x20available\x20commands\x0a','search','expiry','[ip-address]','telegramChatId','mode','telegramEnabled','storeHeadless','enabled','build','rmSync','sortBy','getUTCHours','cancel-loading','Notifications\x20enabled','output-002.log','logs/','warning','/restart\x20-\x20restart\x20bot(s)\x0a','Enabled\x20Bot\x20','callback_query','\x20|\x20','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','showname','static','confirm-message','bot','15\x20min','invalid\x20credentials','update','randomFillSync','Markdown','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','/upload-backup','username','alerts','No\x20bots\x20running\x20right\x20now','filter','existsSync','-results.json','stopped','(((.+)+)+)+$','yes','isDirectory','reject','sockets','lastmsgtelegram','cancelLoading','/download/:type','Failed\x20to\x20download\x20','apiKey','secure','stringify','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','sign','sendMessage','bot.js','padStart','12qityhj','\x20minutes','output-001.log','range','clientip','<b>Balance\x20Bot\x20Status:</b>\x0a','util','status','remove','slice','secret','Idling\x20bot\x20\x20\x20|\x20Bot\x20','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','/metrics\x20-\x20show\x20bot\x20performance\x0a'];_0x4f52=function(){return _0x3f4def;};return _0x4f52();}!fs[_0x58a6d1(0x202)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x58a6d1(0x2bf)),configpath=userID?bbpath+_0x58a6d1(0x307)+userID+'/':bbpath+_0x58a6d1(0x307),configbackuppath=configpath+_0x58a6d1(0x27b),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x58a6d1(0x1ec),zippath=userID?bbpath+_0x58a6d1(0x2ad)+userID+'/':bbpath+_0x58a6d1(0x2ad),loggerfile=fs[_0x58a6d1(0x288)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x58a6d1(0x2e1)+userID+'/':bbpath+_0x58a6d1(0x2e1);!fs[_0x58a6d1(0x202)](configpath)&&fs[_0x58a6d1(0x344)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x58a6d1(0x344)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x58a6d1(0x344)](logspath);!fs[_0x58a6d1(0x202)](zippath)&&fs[_0x58a6d1(0x344)](zippath);!fs[_0x58a6d1(0x202)](temppath)&&fs[_0x58a6d1(0x344)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x58a6d1(0x2d9)]({'bots':[]})[_0x58a6d1(0x347)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![]}})[_0x58a6d1(0x347)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x58a6d1(0x2d9)]({'secure':{},'blacklist':[]})[_0x58a6d1(0x347)]();let crypt=new Crypt({'md':_0x58a6d1(0x2be),'rsaStandard':_0x58a6d1(0x2bb)});const saltRounds=0xa,mixpanel=Mixpanel[_0x58a6d1(0x1d2)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x58a6d1(0x360)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x58a6d1(0x23c)]&&settings['telegramToken']!=''&&settings[_0x58a6d1(0x31b)]&&settings[_0x58a6d1(0x31b)]!='')initTelegram();const parseColor=(_0x638651,_0x2e0bec)=>{const _0x4567f8=_0x58a6d1,_0x387cbc=/#[A-Z]{3}#/g;!_0x2e0bec?_0x638651=_0x638651['replace'](_0x387cbc,''):(_0x638651=_0x638651['replace'](/#BLU#/g,_0x4567f8(0x367)),_0x638651=_0x638651[_0x4567f8(0x26a)](/#RED#/g,_0x4567f8(0x1d0)),_0x638651=_0x638651[_0x4567f8(0x26a)](/#YEL#/g,'\x1b[33m'),_0x638651=_0x638651[_0x4567f8(0x26a)](/#RES#/g,'\x1b[0m'));;return _0x638651;},logger={'screen':_0x1f96ed=>{const _0x42cc03=_0x58a6d1;console[_0x42cc03(0x1bd)](parseColor(_0x1f96ed,!![]));},'simple':_0x5e7b8c=>{const _0x13031b=_0x58a6d1;console['log'](parseColor(_0x5e7b8c,!![])),loggerfile[_0x13031b(0x347)](util[_0x13031b(0x2e0)](parseColor(_0x5e7b8c,![]))+'\x0a');},'full':async _0x34938b=>{const _0x4951b5=_0x58a6d1,_0x2dfcd9=getTimeStamp()+_0x4951b5(0x22f)+_0x34938b;console[_0x4951b5(0x1bd)](parseColor(_0x2dfcd9,!![])),loggerfile['write'](util[_0x4951b5(0x2e0)](parseColor(_0x2dfcd9,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x4951b5(0x315)]!=_0x4951b5(0x294))await tgBot[_0x4951b5(0x213)](settings[_0x4951b5(0x1e0)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x34938b,![]))[_0x4951b5(0x267)](_0x505c4f=>{telegramError(_0x505c4f);});},'debug':async(_0x149102,_0x459414='')=>{const _0x4175ab=_0x58a6d1,_0x5af544=getTimeStamp()+_0x4175ab(0x2b0)+_0x149102;if(debugging)console['log'](parseColor(_0x5af544,!![]));loggerfile[_0x4175ab(0x347)](util[_0x4175ab(0x2e0)](parseColor(_0x5af544,![]))+'\x0a');if(_0x459414){if(debugging)console['log'](_0x459414);loggerfile[_0x4175ab(0x347)](util[_0x4175ab(0x2e0)](_0x459414)+'\x0a');}}};process['on']('uncaughtException',function(_0x231673){const _0x565607=_0x58a6d1;logger[_0x565607(0x36b)](_0x231673);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x58a6d1(0x30e))[_0x58a6d1(0x2fb)](app);app[_0x58a6d1(0x28e)](fileUpload({'useTempFiles':!![]})),app[_0x58a6d1(0x355)](_0x58a6d1(0x20c),async(_0xcb3535,_0x51ec3b)=>{const _0x2a11c6=_0x58a6d1,_0x10138d=_0xcb3535[_0x2a11c6(0x1c5)]['type'],_0x4f6872=getClientsWithBotID('botmanager'),_0x3fe8f0=_0xcb3535[_0x2a11c6(0x1d6)]['uuid'],_0x1a274e=timelyDecrypt(_0x3fe8f0,![]),_0x11c7f0=_0x4f6872['find'](_0x262705=>_0x262705['uuid']==_0x1a274e);if(_0x11c7f0){const _0x399747=normalizeIP(_0xcb3535[_0x2a11c6(0x36c)][_0x2a11c6(0x2a9)])[_0x2a11c6(0x2f1)],_0x918a2e=_0xcb3535[_0x2a11c6(0x1d6)][_0x2a11c6(0x1b9)];if(validateAccess(_0x918a2e,_0x1a274e,_0x399747)[_0x2a11c6(0x346)])_0x10138d==_0x2a11c6(0x352)&&await backupConfigFiles(),await zipFiles(_0x10138d),_0x51ec3b[_0x2a11c6(0x272)](zippath+(_0x10138d+'.zip'),_0x4d3dc3=>{const _0x4b510e=_0x2a11c6;_0x4d3dc3&&(logger[_0x4b510e(0x2f3)](_0x4b510e(0x20d)+_0x10138d),logger['simple'](_0x4d3dc3));});else logger[_0x2a11c6(0x2f3)](_0x2a11c6(0x25f)+_0x10138d+'\x20(1)');}else logger[_0x2a11c6(0x2f3)](_0x2a11c6(0x25f)+_0x10138d+'\x20(2)');}),app[_0x58a6d1(0x289)](_0x58a6d1(0x1fd),async(_0xe7b40e,_0x4e1d9c)=>{const _0x3d6580=_0x58a6d1,_0x585fe2=getClientsWithBotID(_0x3d6580(0x2b6)),_0x2117f5=_0xe7b40e['headers'][_0x3d6580(0x2d4)],_0x1cc9a3=timelyDecrypt(_0x2117f5,![]),_0x401b9d=_0x585fe2[_0x3d6580(0x271)](_0x4fa9b0=>_0x4fa9b0[_0x3d6580(0x2d4)]==_0x1cc9a3);logger[_0x3d6580(0x28f)](_0x3d6580(0x235));if(_0x401b9d){const _0x2af801=normalizeIP(_0xe7b40e[_0x3d6580(0x36c)][_0x3d6580(0x2a9)])[_0x3d6580(0x2f1)],_0x27384b=_0xe7b40e[_0x3d6580(0x1d6)][_0x3d6580(0x1b9)];if(validateAccess(_0x27384b,_0x1cc9a3,_0x2af801)[_0x3d6580(0x346)]){if(_0xe7b40e[_0x3d6580(0x301)]){const _0x10aa4d=_0xe7b40e['files'][_0x3d6580(0x295)];await _0x10aa4d['mv'](temppath+_0x10aa4d['name']),_0x4e1d9c['send']({'status':!![],'message':'File\x20uploaded'});const _0x4eab07=getBotsWithMode();_0x4eab07[_0x3d6580(0x348)]>0x0?confirmRestore(temppath,_0x10aa4d['name']):unzipFile(temppath,_0x10aa4d[_0x3d6580(0x1ce)]);}}else logger[_0x3d6580(0x2f3)](_0x3d6580(0x29e));}else logger[_0x3d6580(0x2f3)](_0x3d6580(0x36a));}),app[_0x58a6d1(0x28e)](express[_0x58a6d1(0x1f4)](path['join'](__dirname,bbpath2,_0x58a6d1(0x1cf)))),app['use'](express['static'](path['join'](__dirname,bbpath2,_0x58a6d1(0x1e5)))),app[_0x58a6d1(0x355)]('/',function(_0x4e9139,_0x1ed711){const _0x525c12=_0x58a6d1;_0x1ed711[_0x525c12(0x303)](path[_0x525c12(0x1cc)](__dirname,bbpath2,_0x525c12(0x1cf),_0x525c12(0x2fc)));}),app['get'](_0x58a6d1(0x2af),function(_0x5c3943,_0x3d81c5){const _0x5758cc=_0x58a6d1;_0x3d81c5['sendFile'](path[_0x5758cc(0x1cc)](__dirname,bbpath2,_0x5758cc(0x1e5),_0x5758cc(0x2fc)));}),app[_0x58a6d1(0x355)](_0x58a6d1(0x254),(_0x3b0c6d,_0x276a85)=>{const _0x546fb5=_0x58a6d1;_0x276a85[_0x546fb5(0x303)](path['join'](__dirname,bbpath2,_0x546fb5(0x1e5),_0x546fb5(0x2fc)));}),app[_0x58a6d1(0x355)](_0x58a6d1(0x354),(_0x14a2e8,_0x2c2210)=>{const _0x4a7ce5=_0x58a6d1;_0x2c2210[_0x4a7ce5(0x303)](path[_0x4a7ce5(0x1cc)](__dirname,bbpath2,_0x4a7ce5(0x1e5),_0x4a7ce5(0x2fc)));}),app[_0x58a6d1(0x355)]('/:bot/coins',(_0x5cd8db,_0x29c5cd)=>{const _0x2d1515=_0x58a6d1;_0x29c5cd[_0x2d1515(0x303)](path[_0x2d1515(0x1cc)](__dirname,bbpath2,_0x2d1515(0x1e5),_0x2d1515(0x2fc)));}),app[_0x58a6d1(0x355)](_0x58a6d1(0x2c5),(_0x352d4d,_0x248ad3)=>{_0x248ad3['sendFile'](path['join'](__dirname,bbpath2,'build','index.html'));}),app[_0x58a6d1(0x355)]('/:bot/configuration',(_0x1ac419,_0x5f311c)=>{const _0x585517=_0x58a6d1;_0x5f311c[_0x585517(0x303)](path['join'](__dirname,bbpath2,_0x585517(0x1e5),_0x585517(0x2fc)));}),app[_0x58a6d1(0x355)]('/:bot/support',(_0xa03164,_0x36793c)=>{const _0x2a3eb0=_0x58a6d1;_0x36793c[_0x2a3eb0(0x303)](path['join'](__dirname,bbpath2,_0x2a3eb0(0x1e5),_0x2a3eb0(0x2fc)));});if(HOST)http['listen'](PORT,HOST);else http[_0x58a6d1(0x362)](PORT);const io=require(_0x58a6d1(0x311))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x2a1069=_0x58a6d1;let _0xd61977=_0x2a1069(0x1df);const _0x3af505=networkInterfaces(),_0x1b7a3e={};for(const _0xe0ccad of Object['keys'](_0x3af505)){for(const _0x1955ab of _0x3af505[_0xe0ccad]){if((_0x1955ab[_0x2a1069(0x32c)]==_0x2a1069(0x36e)||_0x1955ab[_0x2a1069(0x32c)]==0x4)&&!_0x1955ab[_0x2a1069(0x2d8)]){const _0x2fcc2b=ipaddr[_0x2a1069(0x31a)](_0x1955ab['address'])[_0x2a1069(0x219)]();_0x2fcc2b!=_0x2a1069(0x323)&&(!_0x1b7a3e[_0xe0ccad]&&(_0x1b7a3e[_0xe0ccad]=[]),_0x1b7a3e[_0xe0ccad][_0x2a1069(0x351)](_0x1955ab[_0x2a1069(0x1cb)]),_0xd61977=_0x1955ab[_0x2a1069(0x1cb)]);}}}return{'serverip':_0xd61977,'netinterfaces':_0x1b7a3e};}async function startServer(){const _0x26284c=_0x58a6d1,{serverip:_0x1937ce,netinterfaces:_0x529ee4}=getServerIP();logger[_0x26284c(0x36b)](''),logger[_0x26284c(0x36b)](_0x26284c(0x2f7)),await logger[_0x26284c(0x2f3)](_0x26284c(0x1be)+serverversion+_0x26284c(0x2c0)+(_0x26284c(0x2c6)+PORT+_0x26284c(0x2d3))+(_0x26284c(0x246)+_0x1937ce+':'+PORT+_0x26284c(0x273))),logger[_0x26284c(0x36b)]('-----------------------------------------------------------------------------------');if(config[_0x26284c(0x348)]!=0x0)for(const _0xf0a91a of config){if(_0xf0a91a[_0x26284c(0x21d)]==_0x26284c(0x1e4)||_0xf0a91a[_0x26284c(0x21d)]==_0x26284c(0x2c8))await logger[_0x26284c(0x2f3)](_0x26284c(0x2a4)+_0xf0a91a['botID']+_0x26284c(0x1f1)+_0xf0a91a[_0x26284c(0x281)]),startBot([_0xf0a91a[_0x26284c(0x261)],userID],{'cwd':bbpath},function(_0x4cc93c){const _0x4719c3=_0x26284c;if(_0x4cc93c)logger[_0x4719c3(0x2f3)](_0x4cc93c);});else(_0xf0a91a[_0x26284c(0x21d)]==_0x26284c(0x364)||_0xf0a91a['status']==_0x26284c(0x30a))&&await logger['full'](_0x26284c(0x221)+_0xf0a91a[_0x26284c(0x261)]+_0x26284c(0x1f1)+_0xf0a91a[_0x26284c(0x281)]);}else!newBot&&logger[_0x26284c(0x36b)](_0x26284c(0x240));if(newBot)addBot();logger[_0x26284c(0x36b)](_0x26284c(0x2f7)),logger[_0x26284c(0x36b)](''),await logger[_0x26284c(0x28f)](_0x26284c(0x33a)+nodeversion),await logger[_0x26284c(0x28f)]('Network\x20Interfaces:',_0x529ee4);}function startSocket(){const _0x3eb733=_0x58a6d1;io['on'](_0x3eb733(0x339),_0x332431=>{const _0x3dfe30=_0x3eb733;let _0x31f7bf,_0x257dfb,_0x164e6a,_0x182218,_0x5c47f0;const _0x26d613=_0x332431[_0x3dfe30(0x313)][_0x3dfe30(0x1d6)][_0x3dfe30(0x248)];_0x257dfb=_0x26d613[_0x3dfe30(0x1c8)](/bot[0-9]{3}/);if(_0x257dfb)_0x164e6a=_0x257dfb[0x0][_0x3dfe30(0x1c8)](/[0-9]{3}/);if(_0x164e6a)_0x31f7bf=_0x164e6a[0x0];else _0x31f7bf=_0x3dfe30(0x2b6);const _0x5016ba=_0x332431['handshake']['auth']['encryptedUuid'];if(!_0x5016ba)_0x332431[_0x3dfe30(0x1db)](_0x3dfe30(0x21d),{'publicKey':secure[_0x3dfe30(0x226)]});else{_0x182218=timelyDecrypt(_0x5016ba,![]);if(!_0x182218)_0x332431[_0x3dfe30(0x1db)]('status',{'publicKey':secure[_0x3dfe30(0x226)]});else{_0x5c47f0=normalizeIP(_0x332431['conn']['remoteAddress'])['store'];if(!devices[_0x182218])devices[_0x182218]={'uuid':_0x182218,'access':{'token':null}};devices[_0x182218]['ip']=_0x5c47f0;const _0x25aeff=addClient(_0x332431['id'],_0x182218,_0x31f7bf);setAccess(_0x25aeff),emitMessages(),_0x332431['on'](_0x3dfe30(0x2cd),_0x1dfed1=>{const _0x31e5da=_0x3dfe30,_0x42207c=timelyDecrypt(_0x1dfed1[_0x31e5da(0x2db)]);if(_0x42207c){_0x1dfed1={'username':_0x1dfed1[_0x31e5da(0x1fe)],'password':_0x42207c},devices[_0x182218]['access']=validateCredentials(_0x1dfed1,_0x182218);if(devices[_0x182218]['access'][_0x31e5da(0x346)]==![]&&devices[_0x182218][_0x31e5da(0x305)][_0x31e5da(0x1b2)]==_0x31e5da(0x30d))_0x332431['emit'](_0x31e5da(0x21d),{'access':devices[_0x182218][_0x31e5da(0x305)]}),loginAccess2FA(_0x182218,_0x5c47f0);else{if(devices[_0x182218][_0x31e5da(0x305)][_0x31e5da(0x346)]==![]&&devices[_0x182218]['access'][_0x31e5da(0x1b2)]==_0x31e5da(0x1f8))_0x332431['emit'](_0x31e5da(0x21d),{'access':devices[_0x182218][_0x31e5da(0x305)]});else devices[_0x182218][_0x31e5da(0x305)][_0x31e5da(0x346)]&&devices[_0x182218][_0x31e5da(0x305)]['reason']==_0x31e5da(0x23e)&&(getClientsWithUuid(_0x182218)[_0x31e5da(0x2fe)](_0x48ea96=>{setAccess(_0x48ea96);}),logger[_0x31e5da(0x28f)](_0x31e5da(0x35f)+_0x182218[_0x31e5da(0x21f)](-0x8)),setTokenRefresh(_0x182218),setSessionTimeout(_0x31e5da(0x2cd),_0x182218));}}else logger[_0x31e5da(0x2f3)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x332431['on'](_0x3dfe30(0x23b),()=>{resetPassword();}),_0x332431['on'](_0x3dfe30(0x1d3),_0x60b576=>{removeClient(_0x332431['id']);}),_0x31f7bf=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0xc726bc){const _0x10bbfc=_0x58a6d1;if(_0xc726bc!=_0x10bbfc(0x2b6)&&config[_0x10bbfc(0x20e)]!=''){if(pid[_0xc726bc])pid[_0xc726bc][_0x10bbfc(0x2f5)]({'function':_0x10bbfc(0x234),'args':null});}_0xc726bc!=_0x10bbfc(0x2b6)&&broadcastToBots(_0x10bbfc(0x365),JSON[_0x10bbfc(0x210)](config));}function reloadBotManager(){const _0x135c97=_0x58a6d1;getClientsWithBotID(_0x135c97(0x2b6))['forEach'](_0x3484dd=>{getSocket(_0x3484dd['id'])['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x182c18){const _0x1ffd25=_0x58a6d1;return io[_0x1ffd25(0x209)][_0x1ffd25(0x209)][_0x1ffd25(0x355)](_0x182c18);}function setAccess(_0x36dd9d){const _0x1658fe=_0x58a6d1,_0x3e0730=getSocket(_0x36dd9d['id']),_0x199106=_0x36dd9d[_0x1658fe(0x2d4)],_0xb2b1ce=_0x36dd9d[_0x1658fe(0x1f6)];devices[_0x199106][_0x1658fe(0x305)]=validateAccess(devices[_0x199106]['access'][_0x1658fe(0x375)],_0x199106),logger['debug'](_0x1658fe(0x29b)+devices[_0x199106][_0x1658fe(0x305)][_0x1658fe(0x1b2)]+_0x1658fe(0x292)+_0x36dd9d['id'][_0x1658fe(0x21f)](-0x8)+'\x20|\x20user:\x20...'+_0x199106['slice'](-0x8)),_0x3e0730[_0x1658fe(0x1cc)](_0x199106);if(devices[_0x199106][_0x1658fe(0x305)][_0x1658fe(0x346)]){_0x3e0730[_0x1658fe(0x1cc)](_0xb2b1ce);if(_0xb2b1ce==_0x1658fe(0x2b6))initializeSocketBotManager(_0x3e0730);else initializeSocketBot(_0x3e0730);initClient(_0xb2b1ce);}devices[_0x199106][_0x1658fe(0x305)][_0x1658fe(0x375)]&&devices[_0x199106]['access']['reason']==_0x1658fe(0x2df)&&setSessionTimeout(_0x1658fe(0x34a),_0x199106),devices[_0x199106][_0x1658fe(0x305)][_0x1658fe(0x375)]&&devices[_0x199106][_0x1658fe(0x305)]['reason']=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x1658fe(0x2cd),_0x199106),_0x3e0730[_0x1658fe(0x1db)](_0x1658fe(0x21d),{'status':_0x36dd9d[_0x1658fe(0x263)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x199106][_0x1658fe(0x305)],'externalip':devices[_0x199106]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x199106][_0x1658fe(0x305)][_0x1658fe(0x346)]==![]&&devices[_0x199106][_0x1658fe(0x305)][_0x1658fe(0x1b2)]==_0x1658fe(0x2b9)&&temporaryAccess2FA(_0x199106,devices[_0x199106]['ip']);}function setSessionTimeout(_0x473dc1,_0x290234){const _0x4979e6=_0x58a6d1;let _0x3403a7;if(_0x473dc1==_0x4979e6(0x2cd))_0x3403a7=loginExpiry*0x3c*0x3e8;else _0x3403a7=devices[_0x290234][_0x4979e6(0x1d9)]['expiry']*0x3c*0x3e8-(new Date()[_0x4979e6(0x31c)]()-devices[_0x290234][_0x4979e6(0x1d9)][_0x4979e6(0x2cb)]);if(devices[_0x290234][_0x4979e6(0x328)])clearTimeout(devices[_0x290234][_0x4979e6(0x328)]);devices[_0x290234][_0x4979e6(0x328)]=setTimeout(()=>{const _0x362831=_0x4979e6;if(devices[_0x290234][_0x362831(0x259)])clearTimeout(devices[_0x290234]['pidRefreshToken']);removeSocketListeners(_0x290234),addBlacklist(_0x290234),devices[_0x290234][_0x362831(0x1d9)]=null,devices[_0x290234][_0x362831(0x330)]=null,devices[_0x290234][_0x362831(0x305)][_0x362831(0x375)]=null,logger[_0x362831(0x28f)](_0x362831(0x2c3)+_0x290234[_0x362831(0x21f)](-0x8)),devices[_0x290234][_0x362831(0x305)]=validateAccess(devices[_0x290234][_0x362831(0x305)][_0x362831(0x375)],_0x290234),!(devices[_0x290234][_0x362831(0x305)]['allow']&&devices[_0x290234][_0x362831(0x305)]['reason']==_0x362831(0x2dd))&&(_0x473dc1==_0x362831(0x2cd)?io['to'](_0x290234)[_0x362831(0x1db)](_0x362831(0x21d),{'access':{'allow':![],'reason':_0x362831(0x333),'token':null}}):io['to'](_0x290234)['emit'](_0x362831(0x21d),{'access':{'allow':![],'reason':_0x362831(0x1d8),'token':null}})),devices[_0x290234][_0x362831(0x305)]['token']=null;},_0x3403a7);}function setTokenRefresh(_0x2af96e){const _0x417e6e=_0x58a6d1;if(devices[_0x2af96e][_0x417e6e(0x259)])clearTimeout(devices[_0x2af96e][_0x417e6e(0x259)]);devices[_0x2af96e][_0x417e6e(0x259)]=setTimeout(()=>{const _0x301309=_0x417e6e;getClientsWithUuid(_0x2af96e)[_0x301309(0x348)]!=0x0?(devices[_0x2af96e][_0x301309(0x305)]=refreshToken(_0x2af96e),io['to'](_0x2af96e)[_0x301309(0x1db)]('status',{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x2af96e][_0x301309(0x305)],'externalip':devices[_0x2af96e]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x2af96e)):clearTimeout(devices[_0x2af96e]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x36bca5){const _0x12b8e2=_0x58a6d1,_0x5e94b6=getClient(_0x36bca5['id'])['uuid'];_0x36bca5[_0x12b8e2(0x1db)](_0x12b8e2(0x365),config),_0x36bca5[_0x12b8e2(0x1db)](_0x12b8e2(0x357),cleanSettings()),_0x36bca5['on'](_0x12b8e2(0x2ca),_0x406c88=>{const _0xe8caa3=_0x12b8e2;if(validateAccess(_0x406c88,_0x5e94b6)[_0xe8caa3(0x346)])addBot();else logger[_0xe8caa3(0x2f3)](_0xe8caa3(0x306));}),_0x36bca5['on'](_0x12b8e2(0x2ae),(_0x26bdba,_0x4926c8)=>{const _0x200c28=_0x12b8e2;if(validateAccess(_0x4926c8,_0x5e94b6)['allow'])toggleBot(_0x26bdba[_0x200c28(0x261)],_0x26bdba[_0x200c28(0x21d)],_0x26bdba[_0x200c28(0x236)]);else logger[_0x200c28(0x2f3)](_0x200c28(0x29a));}),_0x36bca5['on']('toggle-bot-mode',(_0x3b8412,_0xd83664)=>{const _0x26d993=_0x12b8e2;if(validateAccess(_0xd83664,_0x5e94b6)[_0x26d993(0x346)])toggleBotMode(_0x3b8412);else logger['full'](_0x26d993(0x29a));}),_0x36bca5['on'](_0x12b8e2(0x363),(_0x4ba0ed,_0x544b4a)=>{if(validateAccess(_0x544b4a,_0x5e94b6)['allow'])deleteBot(_0x4ba0ed);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x36bca5['on']('store-settings',(_0x7608c,_0xd7ba1b)=>{const _0x16bb33=_0x12b8e2;if(validateAccess(_0xd7ba1b,_0x5e94b6)['allow'])storeSettings(_0x7608c,!![]);else logger[_0x16bb33(0x2f3)](_0x16bb33(0x28c));}),_0x36bca5['on']('update-bb',_0xb67c71=>{const _0x54404f=_0x12b8e2;if(validateAccess(_0xb67c71,_0x5e94b6)[_0x54404f(0x346)])updateBB('update');else logger[_0x54404f(0x2f3)](_0x54404f(0x270));}),_0x36bca5['on']('reinstall-bb',_0x5f1c68=>{const _0x368046=_0x12b8e2;if(validateAccess(_0x5f1c68,_0x5e94b6)['allow'])updateBB(_0x368046(0x2cf));else logger[_0x368046(0x2f3)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x36bca5['on']('get-backup-files',_0x2298a7=>{const _0x380532=_0x12b8e2;if(validateAccess(_0x2298a7,_0x5e94b6)[_0x380532(0x346)]){const _0x288891=getClient(_0x36bca5['id']);if(_0x288891)getBackupFiles(_0x288891[_0x380532(0x2d4)]);else logger['full'](_0x380532(0x2ff));}else logger[_0x380532(0x2f3)](_0x380532(0x260));}),_0x36bca5['on'](_0x12b8e2(0x229),(_0x506dff,_0x9a37b3)=>{const _0x194668=_0x12b8e2;if(validateAccess(_0x9a37b3,_0x5e94b6)[_0x194668(0x346)])restoreBackupFile(_0x506dff);else logger[_0x194668(0x2f3)](_0x194668(0x356));}),_0x36bca5['on'](_0x12b8e2(0x300),_0x1828e6=>{const _0x18e76a=_0x12b8e2;if(validateAccess(_0x1828e6,_0x5e94b6)[_0x18e76a(0x346)])getMessages();else logger['full'](_0x18e76a(0x2c9));}),_0x36bca5['on'](_0x12b8e2(0x1f5),(_0x2a7901,_0x58a638)=>{const _0x110ec9=_0x12b8e2;if(validateAccess(_0x58a638,_0x5e94b6)[_0x110ec9(0x346)])confirmMessage(_0x2a7901);else logger['full'](_0x110ec9(0x22c));}),_0x36bca5['on'](_0x12b8e2(0x379),_0xeb6b72=>{const _0x22fb82=_0x12b8e2;if(validateAccess(_0xeb6b72,_0x5e94b6)[_0x22fb82(0x346)]){if(devices[_0x5e94b6][_0x22fb82(0x259)])clearTimeout(devices[_0x5e94b6][_0x22fb82(0x259)]);if(devices[_0x5e94b6][_0x22fb82(0x328)])clearTimeout(devices[_0x5e94b6]['pidExpireLogin']);removeSocketListeners(getClient(_0x36bca5['id'])[_0x22fb82(0x2d4)]),addBlacklist(_0x5e94b6),devices[_0x5e94b6][_0x22fb82(0x1d9)]=null,devices[_0x5e94b6][_0x22fb82(0x330)]=null,devices[_0x5e94b6][_0x22fb82(0x305)][_0x22fb82(0x375)]=null,logger[_0x22fb82(0x28f)]('Logged\x20out\x20user\x20...'+_0x5e94b6[_0x22fb82(0x21f)](-0x8)),io['to'](getClient(_0x36bca5['id'])[_0x22fb82(0x2d4)])[_0x22fb82(0x1db)](_0x22fb82(0x21d),{'access':{'allow':![],'reason':_0x22fb82(0x33c),'token':null}});}else logger[_0x22fb82(0x2f3)](_0x22fb82(0x230));});}function initializeSocketBot(_0x565d8e){const _0x22e53d=_0x58a6d1,_0x1d73c9=getClient(_0x565d8e['id'])[_0x22e53d(0x1f6)],_0x1893fb=getClient(_0x565d8e['id'])[_0x22e53d(0x2d4)];_0x565d8e['on']('get-logs',(_0x341c6f,_0x34daae)=>{const _0x399cfd=_0x22e53d;if(validateAccess(_0x34daae,_0x1893fb)['allow']){if(pid[_0x1d73c9])pid[_0x1d73c9][_0x399cfd(0x2f5)]({'function':_0x399cfd(0x298),'args':_0x341c6f});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x565d8e['on']('delete-alerts',(_0x4e9c1c,_0x13b123)=>{const _0xe2a6df=_0x22e53d;if(validateAccess(_0x13b123,_0x1893fb)['allow']){if(pid[_0x1d73c9])pid[_0x1d73c9]['send']({'function':_0xe2a6df(0x2ab),'args':_0x4e9c1c});}else logger[_0xe2a6df(0x2f3)](_0xe2a6df(0x285));}),_0x565d8e['on']('get-portfolio',(_0x5a0809,_0x325e6e)=>{const _0x25aec8=_0x22e53d;if(validateAccess(_0x325e6e,_0x1893fb)[_0x25aec8(0x346)]){if(pid[_0x1d73c9])pid[_0x1d73c9]['send']({'function':'getPortfolio','args':_0x5a0809});}else logger['full'](_0x25aec8(0x37f));}),_0x565d8e['on'](_0x22e53d(0x34d),(_0x318290,_0x105f6d)=>{const _0xdf89b9=_0x22e53d;if(validateAccess(_0x105f6d,_0x1893fb)[_0xdf89b9(0x346)]){if(pid[_0x1d73c9])pid[_0x1d73c9]['send']({'function':_0xdf89b9(0x2ac),'args':_0x318290});}else logger[_0xdf89b9(0x2f3)](_0xdf89b9(0x2d6));}),_0x565d8e['on']('store-headless',(_0x42b93f,_0xfb2db6)=>{const _0x41b4fc=_0x22e53d;if(validateAccess(_0xfb2db6,_0x1893fb)[_0x41b4fc(0x346)]){if(pid[_0x1d73c9])pid[_0x1d73c9][_0x41b4fc(0x2f5)]({'function':_0x41b4fc(0x1e3),'args':_0x42b93f});}else logger[_0x41b4fc(0x2f3)](_0x41b4fc(0x359));}),_0x565d8e['on']('store-fiat',(_0x3540fa,_0x2a1f90)=>{const _0x2abbc8=_0x22e53d;if(validateAccess(_0x2a1f90,_0x1893fb)['allow']){if(pid[_0x1d73c9])pid[_0x1d73c9][_0x2abbc8(0x2f5)]({'function':_0x2abbc8(0x2d5),'args':_0x3540fa});}else logger['full'](_0x2abbc8(0x33d));}),_0x565d8e['on'](_0x22e53d(0x2a2),_0x536ccf=>{const _0x3f8409=_0x22e53d;if(validateAccess(_0x536ccf,_0x1893fb)['allow']){if(pid[_0x1d73c9])pid[_0x1d73c9]['send']({'function':_0x3f8409(0x2f2),'args':null});}else logger[_0x3f8409(0x2f3)](_0x3f8409(0x25c));}),_0x565d8e['on'](_0x22e53d(0x324),_0x489188=>{const _0x89d28d=_0x22e53d;if(validateAccess(_0x489188,_0x1893fb)[_0x89d28d(0x346)]){if(pid[_0x1d73c9])pid[_0x1d73c9]['send']({'function':_0x89d28d(0x2e4),'args':null});}else logger[_0x89d28d(0x2f3)](_0x89d28d(0x32d));}),_0x565d8e['on'](_0x22e53d(0x31e),(_0x429e56,_0x22f401)=>{const _0x2d5e45=_0x22e53d;if(validateAccess(_0x22f401,_0x1893fb)[_0x2d5e45(0x346)]){if(pid[_0x1d73c9])pid[_0x1d73c9][_0x2d5e45(0x2f5)]({'function':'placeOrder','args':_0x429e56});}else logger[_0x2d5e45(0x2f3)](_0x2d5e45(0x31f));}),_0x565d8e['on'](_0x22e53d(0x1e9),_0x14f8c3=>{const _0x39221f=_0x22e53d;if(validateAccess(_0x14f8c3,_0x1893fb)[_0x39221f(0x346)]){if(pid[_0x1d73c9])pid[_0x1d73c9][_0x39221f(0x2f5)]({'function':_0x39221f(0x20b),'args':null});}else logger[_0x39221f(0x2f3)](_0x39221f(0x228));}),_0x565d8e['on']('show-config',_0x3116ae=>{const _0x3f6aa6=_0x22e53d;if(validateAccess(_0x3116ae,_0x1893fb)[_0x3f6aa6(0x346)]){if(pid[_0x1d73c9])pid[_0x1d73c9][_0x3f6aa6(0x2f5)]({'function':'showConfig','args':null});}else logger[_0x3f6aa6(0x2f3)](_0x3f6aa6(0x293));}),_0x565d8e['on'](_0x22e53d(0x253),_0x54533f=>{const _0x3e29f4=_0x22e53d;if(validateAccess(_0x54533f,_0x1893fb)[_0x3e29f4(0x346)])updateBB(_0x3e29f4(0x1f9));else logger[_0x3e29f4(0x2f3)](_0x3e29f4(0x270));}),_0x565d8e['on'](_0x22e53d(0x300),_0x3aa1d3=>{const _0x4655b6=_0x22e53d;if(validateAccess(_0x3aa1d3,_0x1893fb)[_0x4655b6(0x346)])getMessages();else logger[_0x4655b6(0x2f3)](_0x4655b6(0x2c9));}),_0x565d8e['on'](_0x22e53d(0x1f5),(_0x55bca9,_0x14f1e4)=>{const _0x1c912b=_0x22e53d;if(validateAccess(_0x14f1e4,_0x1893fb)['allow'])confirmMessage(_0x55bca9);else logger[_0x1c912b(0x2f3)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x565d8e['on'](_0x22e53d(0x379),_0x5532d9=>{const _0x18b9c0=_0x22e53d;if(validateAccess(_0x5532d9,_0x1893fb)[_0x18b9c0(0x346)]){if(devices[_0x1893fb][_0x18b9c0(0x259)])clearTimeout(devices[_0x1893fb][_0x18b9c0(0x259)]);if(devices[_0x1893fb][_0x18b9c0(0x328)])clearTimeout(devices[_0x1893fb][_0x18b9c0(0x328)]);removeSocketListeners(getClient(_0x565d8e['id'])[_0x18b9c0(0x2d4)]),addBlacklist(_0x1893fb),devices[_0x1893fb][_0x18b9c0(0x1d9)]=null,devices[_0x1893fb][_0x18b9c0(0x330)]=null,devices[_0x1893fb]['access'][_0x18b9c0(0x375)]=null,logger[_0x18b9c0(0x28f)](_0x18b9c0(0x336)+_0x1893fb['slice'](-0x8)),io['to'](getClient(_0x565d8e['id'])[_0x18b9c0(0x2d4)])[_0x18b9c0(0x1db)](_0x18b9c0(0x21d),{'access':{'allow':![],'reason':_0x18b9c0(0x33c),'token':null}});}else logger['full'](_0x18b9c0(0x230));});}function removeSocketListeners(_0x47d6ad){const _0x5067f6=_0x58a6d1;getClientsWithUuid(_0x47d6ad)[_0x5067f6(0x2fe)](_0x3dd045=>{const _0x794b04=_0x5067f6;getSocket(_0x3dd045['id'])[_0x794b04(0x26e)]();});}function cleanSettings(){const _0x4633c0=_0x58a6d1;let _0x4692f1=settings;return settings[_0x4633c0(0x23c)]&&settings[_0x4633c0(0x23c)]!=''&&(_0x4692f1={..._0x4692f1,'telegramToken':_0x4633c0(0x1b8)}),settings[_0x4633c0(0x34e)]&&settings[_0x4633c0(0x34e)]!=''&&(_0x4692f1={..._0x4692f1,'bbPassword':_0x4633c0(0x1b8)}),(settings[_0x4633c0(0x34e)]&&settings['bbPassword']==_0x4633c0(0x286)||settings['telegramToken']&&settings[_0x4633c0(0x23c)]==_0x4633c0(0x286))&&(_0x4692f1={..._0x4692f1,'restored':{'password':settings[_0x4633c0(0x34e)]==_0x4633c0(0x286),'telegram':settings[_0x4633c0(0x23c)]==_0x4633c0(0x286)}}),_0x4692f1;}async function updateBB(_0x996239){const _0x375421=_0x58a6d1;await backupConfigFiles(),installingUpdate=!![],config[_0x375421(0x2fe)](_0x48a118=>{const _0x1a4ced=_0x375421;restartBot(_0x48a118[_0x1a4ced(0x261)]);}),logger['debug'](_0x375421(0x326)+_0x996239);if(_0x996239=='update')process[_0x375421(0x2f5)]({'update':!![]},_0x14da5c=>{});else _0x996239==_0x375421(0x2cf)&&process[_0x375421(0x2f5)]({'reinstall':!![]},_0x38c170=>{});}function startBot(_0x24d3d5,_0x216485,_0x259d91){const _0x597482=_0x58a6d1;if(debugging)_0x24d3d5[_0x597482(0x351)]('-d');let _0xe7ee55=![];const _0x5c1fc2=_0x24d3d5[0x0];_0x216485={..._0x216485,'stdio':[_0x597482(0x2a0),_0x597482(0x2a0),_0x597482(0x2a0),_0x597482(0x2b3)]},pid[_0x5c1fc2]=childProcess['fork'](botfile,_0x24d3d5,_0x216485),pid[_0x5c1fc2]['on'](_0x597482(0x302),_0x42f207=>{const _0x2bbb74=_0x597482;switch(Object[_0x2bbb74(0x33e)](_0x42f207)[0x0]){case _0x2bbb74(0x281):updateBotName(_0x5c1fc2,_0x42f207[_0x2bbb74(0x281)]);break;case _0x2bbb74(0x374):updateBotManager();break;case _0x2bbb74(0x21d):updateStatus(_0x5c1fc2,_0x42f207[_0x2bbb74(0x21d)]);break;case _0x2bbb74(0x236):updateLive(_0x5c1fc2,_0x42f207[_0x2bbb74(0x236)]);break;case _0x2bbb74(0x1d5):updateLive(_0x5c1fc2,_0x42f207['started']),io['to'](_0x5c1fc2)[_0x2bbb74(0x1db)](_0x2bbb74(0x21d),{'access':{'allow':![],'reason':_0x2bbb74(0x24f),'token':null}});break;case _0x2bbb74(0x1c1):_0x42f207[_0x2bbb74(0x1c1)]==_0x2bbb74(0x35e)&&restartBot(_0x5c1fc2);_0x42f207[_0x2bbb74(0x1c1)]==_0x2bbb74(0x282)&&toggleBot(_0x5c1fc2,_0x2bbb74(0x364),'stopped');break;case _0x2bbb74(0x279):sendTelegram(_0x5c1fc2,_0x42f207[_0x2bbb74(0x279)]);break;case'telegrammsg':sendTelegramMsg(_0x42f207[_0x2bbb74(0x314)]);break;case _0x2bbb74(0x318):io['to'](_0x5c1fc2)[_0x2bbb74(0x1db)](_0x42f207[_0x2bbb74(0x318)],_0x42f207[_0x2bbb74(0x322)]);break;}}),pid[_0x5c1fc2]['on'](_0x597482(0x341),function(_0x37a207){if(_0xe7ee55)return;_0xe7ee55=!![],_0x259d91(_0x37a207);}),pid[_0x5c1fc2]['on'](_0x597482(0x358),async function(_0x53cc1e){const _0x3f3029=_0x597482;if(installingUpdate)return;if(_0xe7ee55)return;_0xe7ee55=!![],_0x259d91(null);const _0x161734=dbConfig[_0x3f3029(0x355)](_0x3f3029(0x365))[_0x3f3029(0x271)]({'botID':_0x5c1fc2})[_0x3f3029(0x320)]();_0x161734&&(_0x161734[_0x3f3029(0x21d)]==_0x3f3029(0x1e4)||_0x161734['status']==_0x3f3029(0x2c8))&&(await sleep(0x3e8),updateLive(_0x5c1fc2,_0x3f3029(0x204)),logger[_0x3f3029(0x2f3)]('Restarting\x20Bot\x20'+_0x5c1fc2),startBot([_0x5c1fc2,userID],{'cwd':bbpath},function(_0x4cca27){if(_0x4cca27)logger['full'](_0x4cca27);}));});}function stopBot(_0x5cba9f){const _0x7259e4=_0x58a6d1;getClientsWithBotID(_0x5cba9f)[_0x7259e4(0x2fe)](_0x526a6d=>{const _0x46edd8=_0x7259e4;getSocket(_0x526a6d['id'])[_0x46edd8(0x1d3)](!![]),removeClient(_0x526a6d['id']);}),pid[_0x5cba9f]&&(pid[_0x5cba9f]['kill'](),pid[_0x5cba9f]=null);}function restartBot(_0x405af1){const _0x5069bf=_0x58a6d1;if(pid[_0x405af1])pid[_0x405af1][_0x5069bf(0x282)]();}function addBot(){const _0xef5732=_0x58a6d1;let _0x1960b5;for(let _0x555e72=0x1;_0x555e72<0x3e9;_0x555e72++){_0x1960b5=_0x555e72[_0xef5732(0x1bc)]()[_0xef5732(0x215)](0x3,'0');let _0x7da4c7=config['find'](_0x185172=>_0x185172[_0xef5732(0x261)]==_0x1960b5);if(!_0x7da4c7)break;}if(_0x1960b5===_0xef5732(0x2c7)){logger[_0xef5732(0x2f3)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0xef5732(0x2f3)](_0xef5732(0x2e2)+_0x1960b5),dbConfig[_0xef5732(0x355)](_0xef5732(0x365))[_0xef5732(0x351)]({'botID':_0x1960b5,'botname':'Bot\x20'+_0x1960b5,'status':_0xef5732(0x2c8),'live':''})[_0xef5732(0x347)](),startBot([_0x1960b5,userID],{'cwd':bbpath},function(_0x39faa2){const _0x564d64=_0xef5732;if(_0x39faa2)logger[_0x564d64(0x2f3)](_0x39faa2);}),config=getConfiguration(),io['to']('botmanager')[_0xef5732(0x1db)]('bots',config),broadcastToBots(_0xef5732(0x365),JSON[_0xef5732(0x210)](config));}function deleteBot(_0x4f424e){const _0xed9c89=_0x58a6d1;getClientsWithBotID(_0x4f424e)[_0xed9c89(0x2fe)](_0x174d3b=>{const _0x31ac36=_0xed9c89;getSocket(_0x174d3b['id'])[_0x31ac36(0x1d3)](!![]),removeClient(_0x174d3b['id']);}),dbConfig[_0xed9c89(0x355)]('bots')[_0xed9c89(0x21e)]({'botID':_0x4f424e})[_0xed9c89(0x347)](),logger[_0xed9c89(0x2f3)]('Deleted\x20Bot\x20'+_0x4f424e),stopBot(_0x4f424e);try{if(fs[_0xed9c89(0x202)](path['join'](configpath,_0xed9c89(0x224)+_0x4f424e+'-config.json')))fs[_0xed9c89(0x2c4)](path['join'](configpath,'bot-'+_0x4f424e+'-config.json'));if(fs[_0xed9c89(0x202)](path[_0xed9c89(0x1cc)](configpath,_0xed9c89(0x224)+_0x4f424e+_0xed9c89(0x2f6))))fs[_0xed9c89(0x2c4)](path['join'](configpath,'bot-'+_0x4f424e+'-events.json'));if(fs['existsSync'](path[_0xed9c89(0x1cc)](configpath,_0xed9c89(0x224)+_0x4f424e+_0xed9c89(0x2a1))))fs['unlinkSync'](path[_0xed9c89(0x1cc)](configpath,'bot-'+_0x4f424e+_0xed9c89(0x2a1)));if(fs['existsSync'](path['join'](configpath,_0xed9c89(0x224)+_0x4f424e+_0xed9c89(0x203))))fs['unlinkSync'](path[_0xed9c89(0x1cc)](configpath,_0xed9c89(0x224)+_0x4f424e+_0xed9c89(0x203)));}catch(_0x4a2a6e){if(_0x4a2a6e)logger[_0xed9c89(0x2f3)](_0xed9c89(0x247),_0x4a2a6e);}config=getConfiguration(),io['to'](_0xed9c89(0x2b6))[_0xed9c89(0x1db)](_0xed9c89(0x365),config),broadcastToBots('bots',JSON[_0xed9c89(0x210)](config));}function toggleBot(_0x5311a6,_0x59006b,_0x583c4f){const _0x164380=_0x58a6d1;dbConfig[_0x164380(0x355)](_0x164380(0x365))[_0x164380(0x271)]({'botID':_0x5311a6})[_0x164380(0x349)]({'status':_0x59006b})[_0x164380(0x349)]({'live':_0x583c4f})[_0x164380(0x347)]();if(_0x59006b==_0x164380(0x1e4)||_0x59006b==_0x164380(0x2c8))logger[_0x164380(0x2f3)](_0x164380(0x1ef)+_0x5311a6),startBot([_0x5311a6,userID],{'cwd':bbpath},function(_0x4583c7){const _0x4422e6=_0x164380;if(_0x4583c7)logger[_0x4422e6(0x2f3)](_0x4583c7);});else(_0x59006b==_0x164380(0x364)||_0x59006b==_0x164380(0x30a))&&(logger[_0x164380(0x2f3)](_0x164380(0x28a)+_0x5311a6),stopBot(_0x5311a6));config=getConfiguration(),io['to'](_0x164380(0x2b6))[_0x164380(0x1db)](_0x164380(0x365),config),broadcastToBots(_0x164380(0x365),JSON[_0x164380(0x210)](config));}function toggleStatus(_0x56cb98){const _0x4ab455=_0x58a6d1;let _0x3a7d9c=dbConfig[_0x4ab455(0x355)](_0x4ab455(0x365))[_0x4ab455(0x271)]({'botID':_0x56cb98})['value'](),_0x58077b;if(_0x3a7d9c[_0x4ab455(0x21d)]==='enabled')_0x58077b=_0x4ab455(0x364);else{if(_0x3a7d9c[_0x4ab455(0x21d)]===_0x4ab455(0x2c8))_0x58077b=_0x4ab455(0x30a);else{if(_0x3a7d9c['status']==='new-disabled')_0x58077b=_0x4ab455(0x2c8);else{if(_0x3a7d9c['status']==='disabled')_0x58077b=_0x4ab455(0x1e4);}}}return _0x58077b;}function updateStatus(_0x4d3716,_0x22841c){const _0x6964f6=_0x58a6d1;dbConfig[_0x6964f6(0x355)](_0x6964f6(0x365))['find']({'botID':_0x4d3716})[_0x6964f6(0x349)]({'status':_0x22841c})[_0x6964f6(0x347)](),config=getConfiguration(),io['to']('botmanager')[_0x6964f6(0x1db)](_0x6964f6(0x365),config),broadcastToBots(_0x6964f6(0x365),JSON[_0x6964f6(0x210)](config));}function updateLive(_0x2ea2ff,_0x841242){const _0x1f28a9=_0x58a6d1;dbConfig[_0x1f28a9(0x355)]('bots')[_0x1f28a9(0x271)]({'botID':_0x2ea2ff})['assign']({'live':_0x841242})[_0x1f28a9(0x347)](),config=getConfiguration(),io['to'](_0x1f28a9(0x2b6))[_0x1f28a9(0x1db)](_0x1f28a9(0x365),config),broadcastToBots('bots',JSON[_0x1f28a9(0x210)](config));}function updateBotName(_0x598c94,_0x1ebb88){const _0x1257b1=_0x58a6d1;dbConfig['get'](_0x1257b1(0x365))[_0x1257b1(0x271)]({'botID':_0x598c94})[_0x1257b1(0x349)]({'botname':_0x1ebb88})['write'](),config=getConfiguration(),io['to'](_0x1257b1(0x2b6))[_0x1257b1(0x1db)](_0x1257b1(0x365),config),broadcastToBots(_0x1257b1(0x365),JSON['stringify'](config));}function updateBotManager(){const _0xd81d46=_0x58a6d1;config=getConfiguration(),io['to'](_0xd81d46(0x2b6))['emit'](_0xd81d46(0x365),config),broadcastToBots(_0xd81d46(0x365),JSON['stringify'](config));}function toggleBotMode(_0x446444){const _0x476f36=_0x58a6d1;if(pid[_0x446444])pid[_0x446444][_0x476f36(0x2f5)]({'function':'toggleBotMode','args':null});else{const _0x2ac6c0=configpath+'bot-'+_0x446444+_0x476f36(0x337),_0x409b51=fs[_0x476f36(0x30b)](_0x2ac6c0),_0x5807de=JSON[_0x476f36(0x31a)](_0x409b51),_0x1580b9=_0x5807de[_0x476f36(0x1f6)][0x0]['headless'];_0x5807de[_0x476f36(0x1f6)][0x0][_0x476f36(0x32a)]=!_0x1580b9;const _0x1426ef=JSON[_0x476f36(0x210)](_0x5807de,null,0x2);fs[_0x476f36(0x238)](_0x2ac6c0,_0x1426ef),config=getConfiguration(),io['to'](_0x476f36(0x2b6))[_0x476f36(0x1db)](_0x476f36(0x365),config),broadcastToBots(_0x476f36(0x365),JSON[_0x476f36(0x210)](config));}}function telegramError(_0x3d28d1){const _0x3ca463=_0x58a6d1;logger[_0x3ca463(0x36b)](getTimeStamp()+_0x3ca463(0x2ba));}function validateTelegram(_0xda42b7){const _0x9e3ca=_0x58a6d1;if(_0xda42b7[_0x9e3ca(0x1da)][_0x9e3ca(0x1fe)]!=settings['telegramUsername']&&'@'+_0xda42b7['from'][_0x9e3ca(0x1fe)]!=settings[_0x9e3ca(0x31b)])return tgBot[_0x9e3ca(0x213)](_0xda42b7[_0x9e3ca(0x316)]['id'],_0x9e3ca(0x231),{'parse_mode':'HTML'})[_0x9e3ca(0x267)](_0x1836c1=>{telegramError(_0x1836c1);}),![];return!![];}async function initTelegram(){const _0x2b55a4=_0x58a6d1;if(tgBot)tgBot[_0x2b55a4(0x22b)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x2b55a4(0x23c)],{'polling':!![]});let _0x44f15c=_0x2b55a4(0x2a8);_0x44f15c+='\x0a',_0x44f15c+=_0x2b55a4(0x276),_0x44f15c+='/disable\x20-\x20disable\x20notifications\x0a',_0x44f15c+=_0x2b55a4(0x2b8),_0x44f15c+=_0x2b55a4(0x1ee),_0x44f15c+=_0x2b55a4(0x2ec),_0x44f15c+=_0x2b55a4(0x2b1),_0x44f15c+=_0x2b55a4(0x1fc),_0x44f15c+='/names\x20-\x20show\x20bot\x20names\x0a',_0x44f15c+=_0x2b55a4(0x1d7),_0x44f15c+=_0x2b55a4(0x223),_0x44f15c+=_0x2b55a4(0x2b4),_0x44f15c+=_0x2b55a4(0x239),_0x44f15c+=_0x2b55a4(0x1f2),_0x44f15c+=_0x2b55a4(0x1dc);let _0x5ce5f3=_0x2b55a4(0x251);_0x5ce5f3+='\x0a',_0x5ce5f3+=_0x44f15c,tgBot[_0x2b55a4(0x343)](/\/start/,_0x3747ef=>{const _0x4f7b8e=_0x2b55a4;if(!validateTelegram(_0x3747ef))return;if(settings['telegramChatId']!=_0x3747ef[_0x4f7b8e(0x316)]['id'])updateSetting(_0x4f7b8e(0x1e0),_0x3747ef[_0x4f7b8e(0x316)]['id']);updateSetting(_0x4f7b8e(0x1e2),!![]),tgBot[_0x4f7b8e(0x213)](_0x3747ef[_0x4f7b8e(0x316)]['id'],_0x5ce5f3)[_0x4f7b8e(0x267)](_0xfafbd2=>{telegramError(_0xfafbd2);});}),tgBot['onText'](/\/enable/,_0x4dacc3=>{const _0x1f7be6=_0x2b55a4;if(!validateTelegram(_0x4dacc3))return;if(settings[_0x1f7be6(0x1e0)]!=_0x4dacc3[_0x1f7be6(0x316)]['id'])updateSetting('telegramChatId',_0x4dacc3[_0x1f7be6(0x316)]['id']);updateSetting(_0x1f7be6(0x1e2),!![]),tgBot[_0x1f7be6(0x213)](_0x4dacc3[_0x1f7be6(0x316)]['id'],_0x1f7be6(0x1ea))[_0x1f7be6(0x267)](_0x868695=>{telegramError(_0x868695);});}),tgBot['onText'](/\/config/,async _0x2e1a61=>{const _0x56071d=_0x2b55a4;if(!validateTelegram(_0x2e1a61))return;tgBot[_0x56071d(0x2c1)](_0x56071d(0x1f0)),tgBot[_0x56071d(0x213)](_0x2e1a61[_0x56071d(0x316)]['id'],_0x56071d(0x35c),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':'orders'},{'text':_0x56071d(0x2a6),'callback_data':_0x56071d(0x1ff)},{'text':_0x56071d(0x264),'callback_data':'all'}]]}})[_0x56071d(0x267)](_0x332d76=>{telegramError(_0x332d76);}),tgBot['on'](_0x56071d(0x1f0),async _0x1fa0d3=>{const _0x2ab78b=_0x56071d,_0x490d8d=_0x1fa0d3[_0x2ab78b(0x317)],_0x394d91=_0x1fa0d3[_0x2ab78b(0x302)];tgBot[_0x2ab78b(0x1c0)](_0x1fa0d3['id'])[_0x2ab78b(0x378)](async()=>{const _0x394a98=_0x2ab78b;_0x490d8d==_0x394a98(0x294)&&(updateSetting(_0x394a98(0x315),_0x394a98(0x294)),updateSetting(_0x394a98(0x1e2),!![]),await tgBot['sendMessage'](_0x394d91['chat']['id'],_0x394a98(0x25a))[_0x394a98(0x267)](_0x57cec4=>{telegramError(_0x57cec4);}));_0x490d8d==_0x394a98(0x1ff)&&(updateSetting(_0x394a98(0x315),_0x394a98(0x1ff)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x394d91[_0x394a98(0x316)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x394a98(0x267)](_0x39a96d=>{telegramError(_0x39a96d);}));_0x490d8d==_0x394a98(0x23f)&&(updateSetting('telegramEvents',_0x394a98(0x23f)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x394d91[_0x394a98(0x316)]['id'],_0x394a98(0x287))[_0x394a98(0x267)](_0x4b7494=>{telegramError(_0x4b7494);}));if(!settings['telegramChatId'])tgBot['sendMessage'](_0x394d91['chat']['id'],_0x394a98(0x32e))['catch'](_0x4dac03=>{telegramError(_0x4dac03);});}),tgBot[_0x2ab78b(0x2c1)](_0x2ab78b(0x1f0));});}),tgBot['onText'](/\/status/,_0x2ff80e=>{const _0x31d20=_0x2b55a4;if(!validateTelegram(_0x2ff80e))return;const _0x218bbf=getBotsWithMode();let _0x55d441=_0x31d20(0x21b);config[_0x31d20(0x2fe)](_0x353673=>{const _0x10c2e5=_0x31d20,_0x46e6ff=_0x218bbf[_0x10c2e5(0x271)](_0x1bc023=>_0x1bc023[_0x10c2e5(0x261)]==_0x353673[_0x10c2e5(0x261)])[_0x10c2e5(0x1e1)];_0x55d441+=_0x10c2e5(0x290)+_0x353673['botID']+':\x20'+_0x353673['status']+'\x20|\x20'+_0x46e6ff+'\x20|\x20'+_0x353673['live']+'\x0a';}),_0x55d441+='\x0a',_0x55d441+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x55d441+=!settings['telegramEnabled']?_0x31d20(0x368):_0x31d20(0x2f0),_0x55d441+=settings[_0x31d20(0x1e2)]?settings[_0x31d20(0x315)]==_0x31d20(0x23f)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x31d20(0x34f)+settings['telegramEvents']+'\x20only\x0a':'',tgBot[_0x31d20(0x213)](_0x2ff80e[_0x31d20(0x316)]['id'],_0x55d441,{'parse_mode':_0x31d20(0x23a)})['catch'](_0xa0c33b=>{telegramError(_0xa0c33b);});}),tgBot[_0x2b55a4(0x343)](/\/restart/,_0x4b50f0=>{const _0x4ad32d=_0x2b55a4;if(!validateTelegram(_0x4b50f0))return;tgBot[_0x4ad32d(0x2c1)](_0x4ad32d(0x1f0));const _0x3dddf2=getEnabledBots();if(_0x3dddf2['length']==0x0)tgBot['sendMessage'](_0x4b50f0['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x4ad32d(0x267)](_0x26d4eb=>{telegramError(_0x26d4eb);});else{if(_0x3dddf2['length']>0x1)_0x3dddf2[_0x4ad32d(0x351)]({'botID':_0x4ad32d(0x23f)});let _0x32b671=[],_0x58aeb2=[];const _0x4218d2=_0x3dddf2[_0x4ad32d(0x348)]%0x4==0x0||_0x3dddf2[_0x4ad32d(0x348)]%0x4==0x3||_0x3dddf2[_0x4ad32d(0x348)]%0x3==0x1?0x4:0x3;let _0x572f0b=0x0;_0x3dddf2[_0x4ad32d(0x2fe)]((_0x25f9d7,_0xe4088f)=>{const _0x32d19f=_0x4ad32d;if(_0xe4088f%_0x4218d2==0x0)_0x58aeb2=[];_0x58aeb2['push']({'text':_0x25f9d7[_0x32d19f(0x261)]==_0x32d19f(0x23f)?_0x32d19f(0x2ce):_0x32d19f(0x290)+_0x25f9d7[_0x32d19f(0x261)],'callback_data':_0x25f9d7[_0x32d19f(0x261)]}),_0xe4088f%_0x4218d2==0x0&&(_0x32b671[_0x572f0b]=_0x58aeb2,_0x572f0b++);}),tgBot[_0x4ad32d(0x213)](_0x4b50f0['chat']['id'],_0x4ad32d(0x265),{'reply_markup':{'inline_keyboard':_0x32b671}})[_0x4ad32d(0x267)](_0x10911e=>{telegramError(_0x10911e);}),tgBot['on'](_0x4ad32d(0x1f0),async _0x35b541=>{const _0x1d90e6=_0x4ad32d,_0x12273e=_0x35b541[_0x1d90e6(0x317)],_0x15168d=_0x35b541['message'];tgBot['answerCallbackQuery'](_0x35b541['id'])[_0x1d90e6(0x378)](async()=>{const _0x29ee7d=_0x1d90e6;_0x12273e==_0x29ee7d(0x23f)?config['forEach'](_0x56763d=>{const _0x197ffd=_0x29ee7d;restartBot(_0x56763d[_0x197ffd(0x261)]);}):restartBot(_0x12273e);}),tgBot['removeListener'](_0x1d90e6(0x1f0));});}}),tgBot[_0x2b55a4(0x343)](/\/on/,_0x579b35=>{const _0x15c69e=_0x2b55a4;if(!validateTelegram(_0x579b35))return;tgBot[_0x15c69e(0x2c1)](_0x15c69e(0x1f0));const _0x1481d5=getDisabledBots();if(_0x1481d5[_0x15c69e(0x348)]==0x0)tgBot['sendMessage'](_0x579b35['chat']['id'],_0x15c69e(0x275))[_0x15c69e(0x267)](_0x3e0c28=>{telegramError(_0x3e0c28);});else{if(_0x1481d5[_0x15c69e(0x348)]>0x1)_0x1481d5[_0x15c69e(0x351)]({'botID':_0x15c69e(0x23f)});let _0x85805b=[],_0x5b8891=[];const _0x591647=_0x1481d5['length']%0x4==0x0||_0x1481d5['length']%0x4==0x3||_0x1481d5[_0x15c69e(0x348)]%0x3==0x1?0x4:0x3;let _0x45c304=0x0;_0x1481d5[_0x15c69e(0x2fe)]((_0x4df948,_0x2ee6bd)=>{const _0xd4beeb=_0x15c69e;if(_0x2ee6bd%_0x591647==0x0)_0x5b8891=[];_0x5b8891[_0xd4beeb(0x351)]({'text':_0x4df948[_0xd4beeb(0x261)]=='all'?'All\x20bots':'Bot\x20'+_0x4df948['botID'],'callback_data':_0x4df948[_0xd4beeb(0x261)]}),_0x2ee6bd%_0x591647==0x0&&(_0x85805b[_0x45c304]=_0x5b8891,_0x45c304++);}),tgBot[_0x15c69e(0x213)](_0x579b35[_0x15c69e(0x316)]['id'],_0x15c69e(0x256),{'reply_markup':{'inline_keyboard':_0x85805b}})['catch'](_0x19ab4d=>{telegramError(_0x19ab4d);}),tgBot['on']('callback_query',async _0x399249=>{const _0x46868d=_0x15c69e,_0x2b8025=_0x399249[_0x46868d(0x317)],_0xaef731=_0x399249[_0x46868d(0x302)];tgBot[_0x46868d(0x1c0)](_0x399249['id'])[_0x46868d(0x378)](async()=>{const _0x43268a=_0x46868d;_0x2b8025==_0x43268a(0x23f)?(tgBot['sendMessage'](_0xaef731[_0x43268a(0x316)]['id'],_0x43268a(0x372))[_0x43268a(0x267)](_0x5f4fdf=>{telegramError(_0x5f4fdf);}),_0x1481d5[_0x43268a(0x2fe)](_0x1b863b=>{const _0x15e496=_0x43268a;if(_0x1b863b[_0x15e496(0x261)]!=_0x15e496(0x23f))toggleBot(_0x1b863b[_0x15e496(0x261)],toggleStatus(_0x1b863b['botID']),_0x15e496(0x204));})):(tgBot[_0x43268a(0x213)](_0xaef731[_0x43268a(0x316)]['id'],_0x43268a(0x345)+_0x2b8025)[_0x43268a(0x267)](_0x3b16d9=>{telegramError(_0x3b16d9);}),toggleBot(_0x2b8025,toggleStatus(_0x2b8025),_0x43268a(0x204)));}),tgBot[_0x46868d(0x2c1)](_0x46868d(0x1f0));});}}),tgBot[_0x2b55a4(0x343)](/\/off/,_0x43e23e=>{const _0x3e4d16=_0x2b55a4;if(!validateTelegram(_0x43e23e))return;tgBot[_0x3e4d16(0x2c1)]('callback_query');const _0x5a43fa=getEnabledBots();if(_0x5a43fa[_0x3e4d16(0x348)]==0x0)tgBot[_0x3e4d16(0x213)](_0x43e23e[_0x3e4d16(0x316)]['id'],_0x3e4d16(0x200))[_0x3e4d16(0x267)](_0x4acdcf=>{telegramError(_0x4acdcf);});else{if(_0x5a43fa[_0x3e4d16(0x348)]>0x1)_0x5a43fa['push']({'botID':'all'});let _0x39a260=[],_0x349960=[];const _0x51ab0b=_0x5a43fa[_0x3e4d16(0x348)]%0x4==0x0||_0x5a43fa[_0x3e4d16(0x348)]%0x4==0x3||_0x5a43fa['length']%0x3==0x1?0x4:0x3;let _0x5b729d=0x0;_0x5a43fa[_0x3e4d16(0x2fe)]((_0x54974c,_0x411da6)=>{const _0xa52ae7=_0x3e4d16;if(_0x411da6%_0x51ab0b==0x0)_0x349960=[];_0x349960[_0xa52ae7(0x351)]({'text':_0x54974c[_0xa52ae7(0x261)]==_0xa52ae7(0x23f)?_0xa52ae7(0x2ce):'Bot\x20'+_0x54974c[_0xa52ae7(0x261)],'callback_data':_0x54974c[_0xa52ae7(0x261)]}),_0x411da6%_0x51ab0b==0x0&&(_0x39a260[_0x5b729d]=_0x349960,_0x5b729d++);}),tgBot[_0x3e4d16(0x213)](_0x43e23e[_0x3e4d16(0x316)]['id'],_0x3e4d16(0x380),{'reply_markup':{'inline_keyboard':_0x39a260}})[_0x3e4d16(0x267)](_0x52d286=>{telegramError(_0x52d286);}),tgBot['on'](_0x3e4d16(0x1f0),async _0x3fd9c2=>{const _0x3fa827=_0x3e4d16,_0x2219da=_0x3fd9c2[_0x3fa827(0x317)],_0x4e51bb=_0x3fd9c2['message'];tgBot[_0x3fa827(0x1c0)](_0x3fd9c2['id'])[_0x3fa827(0x378)](async()=>{const _0x49f065=_0x3fa827;_0x2219da==_0x49f065(0x23f)?(tgBot[_0x49f065(0x213)](_0x4e51bb[_0x49f065(0x316)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x49f065(0x267)](_0x2e6494=>{telegramError(_0x2e6494);}),_0x5a43fa['forEach'](_0x12e0ab=>{const _0x1e786a=_0x49f065;if(_0x12e0ab[_0x1e786a(0x261)]!=_0x1e786a(0x23f))toggleBot(_0x12e0ab[_0x1e786a(0x261)],toggleStatus(_0x12e0ab[_0x1e786a(0x261)]),'stopped');})):(tgBot[_0x49f065(0x213)](_0x4e51bb[_0x49f065(0x316)]['id'],_0x49f065(0x222)+_0x2219da)['catch'](_0x44feda=>{telegramError(_0x44feda);}),toggleBot(_0x2219da,toggleStatus(_0x2219da),_0x49f065(0x204)));}),tgBot[_0x3fa827(0x2c1)]('callback_query');});}}),tgBot[_0x2b55a4(0x343)](/\/metrics/,_0x1faf14=>{const _0x24339d=_0x2b55a4;if(!validateTelegram(_0x1faf14))return;tgBot[_0x24339d(0x2c1)](_0x24339d(0x1f0));const _0x27f7f0=getEnabledBots();if(_0x27f7f0[_0x24339d(0x348)]==0x0)tgBot[_0x24339d(0x213)](_0x1faf14[_0x24339d(0x316)]['id'],_0x24339d(0x200))[_0x24339d(0x267)](_0x459e02=>{telegramError(_0x459e02);});else{if(_0x27f7f0[_0x24339d(0x348)]>0x1){let _0x1ee3d2=[],_0x4c529f=[];const _0x285983=_0x27f7f0[_0x24339d(0x348)]%0x4==0x0||_0x27f7f0[_0x24339d(0x348)]%0x4==0x3||_0x27f7f0['length']%0x3==0x1?0x4:0x3;let _0x3ac82a=0x0;_0x27f7f0[_0x24339d(0x2fe)]((_0x155376,_0x1748e8)=>{const _0x4f336d=_0x24339d;if(_0x1748e8%_0x285983==0x0)_0x4c529f=[];_0x4c529f['push']({'text':_0x4f336d(0x290)+_0x155376[_0x4f336d(0x261)],'callback_data':_0x155376[_0x4f336d(0x261)]}),_0x1748e8%_0x285983==0x0&&(_0x1ee3d2[_0x3ac82a]=_0x4c529f,_0x3ac82a++);}),tgBot[_0x24339d(0x213)](_0x1faf14['chat']['id'],_0x24339d(0x33f),{'reply_markup':{'inline_keyboard':_0x1ee3d2}})[_0x24339d(0x267)](_0x3a94fa=>{telegramError(_0x3a94fa);}),tgBot['on'](_0x24339d(0x1f0),async _0x40ff75=>{const _0x72df9a=_0x24339d,_0x39a5d=_0x40ff75[_0x72df9a(0x317)],_0x5e3ffc=_0x40ff75['message'];tgBot[_0x72df9a(0x1c0)](_0x40ff75['id'])[_0x72df9a(0x378)](async()=>{const _0x3ca130=_0x72df9a;if(pid[_0x39a5d])pid[_0x39a5d][_0x3ca130(0x2f5)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x72df9a(0x2c1)](_0x72df9a(0x1f0));});}else{const _0xf37f4f=_0x27f7f0[0x0][_0x24339d(0x261)];if(pid[_0xf37f4f])pid[_0xf37f4f][_0x24339d(0x2f5)]({'function':_0x24339d(0x1bb),'args':null});}}}),tgBot[_0x2b55a4(0x343)](/\/portfolio/,_0x14f156=>{const _0x3a5fa1=_0x2b55a4;if(!validateTelegram(_0x14f156))return;tgBot[_0x3a5fa1(0x2c1)]('callback_query');const _0x2cbbd2=getEnabledBots();if(_0x2cbbd2[_0x3a5fa1(0x348)]==0x0)tgBot['sendMessage'](_0x14f156[_0x3a5fa1(0x316)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x48ad5d=>{telegramError(_0x48ad5d);});else{if(_0x2cbbd2[_0x3a5fa1(0x348)]>0x1){let _0x42c0fc=[],_0x512101=[];const _0x4044aa=_0x2cbbd2[_0x3a5fa1(0x348)]%0x4==0x0||_0x2cbbd2['length']%0x4==0x3||_0x2cbbd2['length']%0x3==0x1?0x4:0x3;let _0x442d68=0x0;_0x2cbbd2[_0x3a5fa1(0x2fe)]((_0x417503,_0x43cbbd)=>{const _0x417e03=_0x3a5fa1;if(_0x43cbbd%_0x4044aa==0x0)_0x512101=[];_0x512101[_0x417e03(0x351)]({'text':_0x417e03(0x290)+_0x417503[_0x417e03(0x261)],'callback_data':_0x417503[_0x417e03(0x261)]}),_0x43cbbd%_0x4044aa==0x0&&(_0x42c0fc[_0x442d68]=_0x512101,_0x442d68++);}),tgBot['sendMessage'](_0x14f156[_0x3a5fa1(0x316)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x42c0fc}})['catch'](_0x2478c2=>{telegramError(_0x2478c2);}),tgBot['on'](_0x3a5fa1(0x1f0),async _0x3f7842=>{const _0xe0641d=_0x3a5fa1,_0x444d26=_0x3f7842['data'],_0x2469a9=_0x3f7842[_0xe0641d(0x302)];tgBot['answerCallbackQuery'](_0x3f7842['id'])[_0xe0641d(0x378)](async()=>{const _0x198061=_0xe0641d;if(pid[_0x444d26])pid[_0x444d26][_0x198061(0x2f5)]({'function':_0x198061(0x249),'args':null});}),tgBot[_0xe0641d(0x2c1)](_0xe0641d(0x1f0));});}else{const _0x3d6b0c=_0x2cbbd2[0x0][_0x3a5fa1(0x261)];if(pid[_0x3d6b0c])pid[_0x3d6b0c]['send']({'function':_0x3a5fa1(0x249),'args':null});}}}),tgBot[_0x2b55a4(0x343)](/\/update/,async _0x316378=>{const _0x39bd88=_0x2b55a4;if(!validateTelegram(_0x316378))return;tgBot['removeListener'](_0x39bd88(0x1f0)),await getMessages();if(!updateAvailable)tgBot[_0x39bd88(0x213)](_0x316378[_0x39bd88(0x316)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x39bd88(0x267)](_0x206a42=>{telegramError(_0x206a42);});else!validInstallation?tgBot[_0x39bd88(0x213)](_0x316378[_0x39bd88(0x316)]['id'],_0x39bd88(0x274))[_0x39bd88(0x267)](_0x20fbac=>{telegramError(_0x20fbac);}):(tgBot[_0x39bd88(0x213)](_0x316378['chat']['id'],_0x39bd88(0x30f),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x39bd88(0x206)},{'text':'No','callback_data':'no'}]]}})[_0x39bd88(0x267)](_0x27eb66=>{telegramError(_0x27eb66);}),tgBot['on'](_0x39bd88(0x1f0),async _0x20927e=>{const _0x1686f3=_0x39bd88,_0x5544d0=_0x20927e[_0x1686f3(0x317)],_0x257f3d=_0x20927e[_0x1686f3(0x302)];tgBot[_0x1686f3(0x1c0)](_0x20927e['id'])[_0x1686f3(0x378)](async()=>{const _0x38da11=_0x1686f3;_0x5544d0==_0x38da11(0x206)&&(await tgBot['sendMessage'](_0x257f3d[_0x38da11(0x316)]['id'],'Starting\x20Balance\x20Bot\x20update')[_0x38da11(0x267)](_0x1c0e0a=>{telegramError(_0x1c0e0a);}),updateBB(_0x38da11(0x1f9))),_0x5544d0=='no'&&await tgBot[_0x38da11(0x213)](_0x257f3d[_0x38da11(0x316)]['id'],_0x38da11(0x296))[_0x38da11(0x267)](_0x5d135b=>{telegramError(_0x5d135b);});}),tgBot[_0x1686f3(0x2c1)](_0x1686f3(0x1f0));}));}),tgBot['onText'](/\/reinstall/,async _0x5f2e24=>{const _0x49e320=_0x2b55a4;if(!validateTelegram(_0x5f2e24))return;tgBot['removeListener'](_0x49e320(0x1f0)),!validInstallation?tgBot[_0x49e320(0x213)](_0x5f2e24[_0x49e320(0x316)]['id'],_0x49e320(0x2cc))[_0x49e320(0x267)](_0x7e6bc9=>{telegramError(_0x7e6bc9);}):(tgBot['sendMessage'](_0x5f2e24['chat']['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x49e320(0x327),'callback_data':_0x49e320(0x206)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x1d72ae=>{telegramError(_0x1d72ae);}),tgBot['on'](_0x49e320(0x1f0),async _0x80d83e=>{const _0x3878fd=_0x49e320,_0x43a15a=_0x80d83e[_0x3878fd(0x317)],_0x381584=_0x80d83e[_0x3878fd(0x302)];tgBot[_0x3878fd(0x1c0)](_0x80d83e['id'])[_0x3878fd(0x378)](async()=>{const _0x4c64a1=_0x3878fd;_0x43a15a==_0x4c64a1(0x206)&&(await tgBot['sendMessage'](_0x381584[_0x4c64a1(0x316)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation')[_0x4c64a1(0x267)](_0x1e594f=>{telegramError(_0x1e594f);}),updateBB(_0x4c64a1(0x2cf))),_0x43a15a=='no'&&await tgBot['sendMessage'](_0x381584[_0x4c64a1(0x316)]['id'],_0x4c64a1(0x211))['catch'](_0x1e2cb3=>{telegramError(_0x1e2cb3);});}),tgBot[_0x3878fd(0x2c1)](_0x3878fd(0x1f0));}));}),tgBot[_0x2b55a4(0x343)](/\/toggle/,_0x47b5a7=>{const _0x54db8d=_0x2b55a4;if(!validateTelegram(_0x47b5a7))return;tgBot[_0x54db8d(0x2c1)]('callback_query');const _0xba4edd=getBotsWithMode();if(_0xba4edd['length']==0x0)tgBot[_0x54db8d(0x213)](_0x47b5a7[_0x54db8d(0x316)]['id'],_0x54db8d(0x200))['catch'](_0x4b2c56=>{telegramError(_0x4b2c56);});else{let _0x468722=[],_0x38af86=[];const _0x399db9=0x2;let _0x2975e8=0x0;_0xba4edd[_0x54db8d(0x2fe)]((_0x576362,_0x256ac7)=>{const _0x1e1c24=_0x54db8d;if(_0x256ac7%_0x399db9==0x0)_0x38af86=[];_0x38af86[_0x1e1c24(0x351)]({'text':_0x1e1c24(0x290)+_0x576362[_0x1e1c24(0x261)]+'\x20('+_0x576362[_0x1e1c24(0x1e1)]+')','callback_data':_0x576362[_0x1e1c24(0x261)]}),_0x256ac7%_0x399db9==0x0&&(_0x468722[_0x2975e8]=_0x38af86,_0x2975e8++);}),tgBot['sendMessage'](_0x47b5a7[_0x54db8d(0x316)]['id'],_0x54db8d(0x2bc),{'reply_markup':{'inline_keyboard':_0x468722}})[_0x54db8d(0x267)](_0x2d2634=>{telegramError(_0x2d2634);}),tgBot['on']('callback_query',async _0x4d9ffc=>{const _0x4c8689=_0x54db8d,_0x123a9b=_0x4d9ffc[_0x4c8689(0x317)],_0x1764d0=_0x4d9ffc[_0x4c8689(0x302)];tgBot[_0x4c8689(0x1c0)](_0x4d9ffc['id'])['then'](async()=>{const _0x590c9c=_0x4c8689,_0x3282e3=_0xba4edd[_0x590c9c(0x271)](_0x23c7f2=>_0x23c7f2[_0x590c9c(0x261)]==_0x123a9b),_0x194348=_0x3282e3[_0x590c9c(0x1e1)]==_0x590c9c(0x1ba)?_0x590c9c(0x304):_0x590c9c(0x1ba);tgBot[_0x590c9c(0x213)](_0x1764d0[_0x590c9c(0x316)]['id'],_0x590c9c(0x331)+_0x123a9b+'\x20to\x20'+_0x194348+_0x590c9c(0x2b7))[_0x590c9c(0x267)](_0x12a7c0=>{telegramError(_0x12a7c0);}),toggleBotMode(_0x123a9b);}),tgBot['removeListener']('callback_query');});}}),tgBot['onText'](/\/names/,_0x5055f9=>{const _0x22d321=_0x2b55a4;if(!validateTelegram(_0x5055f9))return;let _0x17353f='';config[_0x22d321(0x2fe)](_0x183b85=>{const _0x10d8f2=_0x22d321;_0x17353f+=_0x10d8f2(0x290)+_0x183b85[_0x10d8f2(0x261)]+':\x20'+_0x183b85[_0x10d8f2(0x281)]+'\x0a';}),tgBot[_0x22d321(0x213)](_0x5055f9[_0x22d321(0x316)]['id'],_0x17353f,{'parse_mode':'HTML'})[_0x22d321(0x267)](_0x258e97=>{telegramError(_0x258e97);});}),tgBot[_0x2b55a4(0x343)](/\/disable/,_0x175403=>{const _0x490795=_0x2b55a4;if(!validateTelegram(_0x175403))return;tgBot[_0x490795(0x213)](_0x175403[_0x490795(0x316)]['id'],'Notifications\x20disabled')['catch'](_0x5e4f62=>{telegramError(_0x5e4f62);}),updateSetting('telegramEnabled',![]);}),tgBot['onText'](/\/help/,_0x42ac57=>{const _0x2e5825=_0x2b55a4;if(!validateTelegram(_0x42ac57))return;tgBot[_0x2e5825(0x213)](_0x42ac57[_0x2e5825(0x316)]['id'],_0x44f15c)[_0x2e5825(0x267)](_0x33bc84=>{telegramError(_0x33bc84);});}),tgBot['on'](_0x2b55a4(0x371),_0xea7815=>{const _0x47b5db=_0x2b55a4;_0xea7815[_0x47b5db(0x1bc)]()[_0x47b5db(0x353)]('404\x20Not\x20Found')&&(logger['full'](_0x47b5db(0x241)),tgBot[_0x47b5db(0x22b)](),tgBot=null,io['to']('botmanager')['emit'](_0x47b5db(0x225),_0x47b5db(0x241)));}),process[_0x2b55a4(0x24d)](_0x2b55a4(0x1b6),()=>{const _0x40cf3d=_0x2b55a4;if(tgBot)tgBot[_0x40cf3d(0x22b)]();process[_0x40cf3d(0x358)](0x1);}),process['once'](_0x2b55a4(0x233),()=>{const _0x579486=_0x2b55a4;if(tgBot)tgBot[_0x579486(0x22b)]();process[_0x579486(0x358)](0x1);});}}function disableTelegram(){const _0x52e347=_0x58a6d1;tgBot&&(tgBot[_0x52e347(0x22b)](),tgBot=null);}function sendTelegram(_0x133ffa,_0x5e36ba){const _0x10aa14=_0x58a6d1;if(settings[_0x10aa14(0x1e2)]){if(settings[_0x10aa14(0x315)]==_0x10aa14(0x23f)||(_0x5e36ba[_0x10aa14(0x2aa)]==_0x10aa14(0x341)||_0x5e36ba[_0x10aa14(0x2aa)]==_0x10aa14(0x1ed)||_0x5e36ba[_0x10aa14(0x2aa)]==_0x10aa14(0x1d1))&&settings['telegramEvents']==_0x10aa14(0x1ff)||_0x5e36ba[_0x10aa14(0x2aa)]=='order'&&settings[_0x10aa14(0x315)]=='orders'){if(tgBot&&settings['telegramChatId']){if(_0x5e36ba[_0x10aa14(0x1f3)])tgBot[_0x10aa14(0x213)](settings[_0x10aa14(0x1e0)],_0x5e36ba[_0x10aa14(0x281)]+'\x20>\x20'+_0x5e36ba[_0x10aa14(0x25e)])[_0x10aa14(0x267)](_0xe86eff=>{telegramError(_0xe86eff);});else tgBot[_0x10aa14(0x213)](settings[_0x10aa14(0x1e0)],_0x10aa14(0x290)+_0x133ffa+_0x10aa14(0x27e)+_0x5e36ba[_0x10aa14(0x25e)])[_0x10aa14(0x267)](_0x14bd26=>{telegramError(_0x14bd26);});}}}}async function sendTelegramMsg(_0x5ed28c,_0x5c460e=_0x58a6d1(0x23a)){const _0x437bd8=_0x58a6d1;return settings[_0x437bd8(0x1e2)]&&tgBot&&settings['telegramChatId']?(await tgBot[_0x437bd8(0x213)](settings['telegramChatId'],_0x5ed28c,{'parse_mode':_0x5c460e})[_0x437bd8(0x267)](_0x5cd1ad=>{telegramError(_0x5cd1ad);}),!![]):![];}function getDeviceWithIp(_0x24c208){const _0x1e748c=_0x58a6d1;return devices[_0x1e748c(0x271)](_0x540a44=>_0x540a44['ip']===_0x24c208);}function temporaryAccess2FA(_0x165d16,_0x1171cb){const _0x983760=_0x58a6d1;let _0x328efe=new Date(),_0x431036=![];if(lastIpApproval){if(_0x328efe-lastIpApproval<0x1388)_0x431036=!![];}lastIpApproval=new Date();if(_0x431036)return;tgBot&&settings[_0x983760(0x1e0)]&&(tgBot['removeListener']('callback_query'),tgBot['sendMessage'](settings[_0x983760(0x1e0)],_0x983760(0x27d)+normalizeIP(_0x1171cb)[_0x983760(0x269)]+_0x983760(0x1c4),{'parse_mode':_0x983760(0x23a),'reply_markup':{'inline_keyboard':[[{'text':_0x983760(0x284),'callback_data':'5'},{'text':_0x983760(0x1f7),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':'reject','callback_data':_0x983760(0x208)}]]}})[_0x983760(0x267)](_0x1023ef=>{telegramError(_0x1023ef);}),tgBot['on'](_0x983760(0x1f0),async _0x52b512=>{const _0x49c323=_0x983760,_0x15941a=_0x52b512['data'],_0x2ed6e8=_0x52b512[_0x49c323(0x302)];tgBot['answerCallbackQuery'](_0x52b512['id'])['then'](async()=>{const _0x5f1dbe=_0x49c323;devices[_0x165d16][_0x5f1dbe(0x1d9)]={'clientip':_0x1171cb,'timestamp':new Date()[_0x5f1dbe(0x31c)](),'expiry':_0x15941a},_0x15941a!=_0x5f1dbe(0x208)?(await tgBot['sendMessage'](_0x2ed6e8[_0x5f1dbe(0x316)]['id'],_0x5f1dbe(0x2f9)+_0x15941a+_0x5f1dbe(0x217),{'parse_mode':_0x5f1dbe(0x23a)})[_0x5f1dbe(0x267)](_0x2ac81c=>{telegramError(_0x2ac81c);}),io['to'](_0x165d16)['emit'](_0x5f1dbe(0x21d),{'access':{'allow':![],'reason':_0x5f1dbe(0x24f),'token':null}})):(await tgBot[_0x5f1dbe(0x213)](_0x2ed6e8['chat']['id'],'Temporary\x20access\x20rejected')[_0x5f1dbe(0x267)](_0x1bba4b=>{telegramError(_0x1bba4b);}),io['to'](_0x165d16)[_0x5f1dbe(0x1db)](_0x5f1dbe(0x21d),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x49c323(0x2c1)](_0x49c323(0x1f0));}));}function loginAccess2FA(_0x2cfb12,_0x1ff91d){const _0x3692ea=_0x58a6d1;tgBot&&settings[_0x3692ea(0x1e0)]&&(tgBot[_0x3692ea(0x2c1)](_0x3692ea(0x1f0)),tgBot[_0x3692ea(0x213)](settings[_0x3692ea(0x1e0)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x1ff91d)[_0x3692ea(0x269)]+_0x3692ea(0x1c4),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x3692ea(0x299),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x3692ea(0x208)}]]}})[_0x3692ea(0x267)](_0x26db2f=>{telegramError(_0x26db2f);}),tgBot['on'](_0x3692ea(0x1f0),async _0x1a7c7a=>{const _0x40b8c2=_0x3692ea,_0x55abc3=_0x1a7c7a[_0x40b8c2(0x317)],_0x594259=_0x1a7c7a[_0x40b8c2(0x302)];tgBot[_0x40b8c2(0x1c0)](_0x1a7c7a['id'])[_0x40b8c2(0x378)](async()=>{const _0x2b6a87=_0x40b8c2;devices[_0x2cfb12][_0x2b6a87(0x330)]={'clientip':_0x1ff91d,'timestamp':new Date()['getTime'](),'expiry':_0x55abc3},_0x55abc3!=_0x2b6a87(0x208)?(await tgBot[_0x2b6a87(0x213)](_0x594259['chat']['id'],_0x2b6a87(0x245),{'parse_mode':_0x2b6a87(0x23a)})[_0x2b6a87(0x267)](_0x3de9a6=>{telegramError(_0x3de9a6);}),io['to'](_0x2cfb12)['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x2b6a87(0x213)](_0x594259['chat']['id'],_0x2b6a87(0x1c6))[_0x2b6a87(0x267)](_0x4a1b4b=>{telegramError(_0x4a1b4b);}),io['to'](_0x2cfb12)[_0x2b6a87(0x1db)](_0x2b6a87(0x21d),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x40b8c2(0x2c1)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x34be2c=_0x58a6d1;return dbConfig[_0x34be2c(0x355)]('bots')[_0x34be2c(0x1e7)](_0x34be2c(0x261))[_0x34be2c(0x201)]({'status':'enabled'})[_0x34be2c(0x320)]()||[];}function getDisabledBots(){const _0x4cc390=_0x58a6d1;return dbConfig['get'](_0x4cc390(0x365))['sortBy']('botID')['filter']({'status':_0x4cc390(0x364)})[_0x4cc390(0x320)]()||[];}function getBotAttributes(_0x4e60d6){const _0x1a59d5=_0x58a6d1;let _0x262a5a={};const _0x48461e=configpath+'bot-'+_0x4e60d6+_0x1a59d5(0x337),_0x367319=fs['existsSync'](_0x48461e);if(_0x367319){const _0x4b1e39=fs[_0x1a59d5(0x30b)](_0x48461e);try{const _0x361572=JSON['parse'](_0x4b1e39),_0x314d0d=_0x361572?_0x361572[_0x1a59d5(0x1f6)][0x0][_0x1a59d5(0x32a)]:![];_0x262a5a[_0x1a59d5(0x1e1)]=_0x314d0d?'auto':'manual',_0x262a5a['botname']=_0x361572?_0x361572[_0x1a59d5(0x1f6)][0x0][_0x1a59d5(0x281)]:_0x1a59d5(0x290)+_0x4e60d6;}catch(_0x1a5b0c){_0x262a5a[_0x1a59d5(0x1e1)]='manual',_0x262a5a[_0x1a59d5(0x281)]=_0x1a59d5(0x290)+_0x4e60d6;}}else _0x262a5a['mode']=_0x1a59d5(0x304),_0x262a5a[_0x1a59d5(0x281)]='Bot\x20'+_0x4e60d6;return _0x262a5a;}function getBotsWithMode(){const _0x59d786=_0x58a6d1,_0x42e960=dbConfig[_0x59d786(0x355)](_0x59d786(0x365))[_0x59d786(0x1e7)](_0x59d786(0x261))['value']()||[];return _0x42e960[_0x59d786(0x2fe)](_0x406fe6=>{const _0x34c518=_0x59d786;let _0x55dd9a=getBotAttributes(_0x406fe6['botID']);_0x406fe6[_0x34c518(0x1e1)]=_0x55dd9a[_0x34c518(0x1e1)];}),_0x42e960;}function getBotExchanges(){const _0x39799f=_0x58a6d1;let _0xaec521=[];const _0x17a87d=dbConfig[_0x39799f(0x355)](_0x39799f(0x365))[_0x39799f(0x1e7)]('botID')[_0x39799f(0x320)]()||[];_0x17a87d[_0x39799f(0x2fe)](_0x543acf=>{const _0x49134e=_0x39799f;if(_0x543acf[_0x49134e(0x21d)]==_0x49134e(0x1e4)){const _0x5f1b1f=configpath+_0x49134e(0x224)+_0x543acf[_0x49134e(0x261)]+_0x49134e(0x337),_0x49d9da=fs['existsSync'](_0x5f1b1f);let _0x22ab89;if(_0x49d9da){const _0x42ef85=fs['readFileSync'](_0x5f1b1f);try{const _0x324968=JSON[_0x49134e(0x31a)](_0x42ef85);_0x22ab89=_0x324968?_0x324968[_0x49134e(0x1f6)][0x0]['exchange']:null;}catch(_0x4189cb){}}if(_0x22ab89)_0xaec521[_0x49134e(0x351)](_0x22ab89);}});const _0x161e41=[...new Set(_0xaec521)][_0x39799f(0x22a)]();return _0x161e41;}async function initUser(){const _0x431785=_0x58a6d1;if(!settings['userid']){const _0x4398d2=uuidRandom();mixpanel[_0x431785(0x27c)](_0x4398d2),updateSetting(_0x431785(0x2bd),_0x4398d2);}}async function initSecure(){const _0x17d29a=_0x58a6d1;let _0xdee821=getSecure();if(!_0xdee821[_0x17d29a(0x2da)](_0x17d29a(0x220))){let _0x5b53e5=await generateKeys();_0xdee821[_0x17d29a(0x226)]=_0x5b53e5[_0x17d29a(0x226)],_0xdee821[_0x17d29a(0x24e)]=_0x5b53e5[_0x17d29a(0x24e)],_0xdee821[_0x17d29a(0x220)]=crypto['randomBytes'](0x20)[_0x17d29a(0x1bc)]('hex');;storeSecure(_0xdee821);}}function getSettings(){const _0x512c80=_0x58a6d1;return dbSettings[_0x512c80(0x355)](_0x512c80(0x357))['value']()||{};}function getSecure(){const _0xdfc28d=_0x58a6d1;return dbSecure[_0xdfc28d(0x355)](_0xdfc28d(0x20f))['value']()||{};}function getBlacklist(){const _0x55b46a=_0x58a6d1;return dbSecure[_0x55b46a(0x355)](_0x55b46a(0x28b))[_0x55b46a(0x320)]()||[];}function broadcastToBots(_0x10bddd,_0x1dea71){const _0x3bb7f5=_0x58a6d1;config[_0x3bb7f5(0x2fe)](_0x1af2c8=>{const _0x407e36=_0x3bb7f5;if(_0x1af2c8['status']==_0x407e36(0x1e4)&&_0x1af2c8[_0x407e36(0x236)]=='running'||_0x1af2c8[_0x407e36(0x21d)]==_0x407e36(0x2c8)&&_0x1af2c8['live']==_0x407e36(0x1b7)){if(pid[_0x1af2c8[_0x407e36(0x261)]])pid[_0x1af2c8[_0x407e36(0x261)]][_0x407e36(0x2f5)]({[_0x10bddd]:_0x1dea71});}});}function storeSettings(_0x441919,_0x31fcc3=![]){const _0x175872=_0x58a6d1;_0x441919={...settings,..._0x441919};if(_0x31fcc3&&_0x441919[_0x175872(0x34e)]!=_0x175872(0x1b8)&&_0x441919[_0x175872(0x34e)]!='***'&&_0x441919[_0x175872(0x34e)]!=''){const _0x210e61=crypt['decrypt'](secure[_0x175872(0x24e)],_0x441919[_0x175872(0x34e)])['message'][_0x175872(0x376)]('@')[0x0],_0x5f3dc3=bcrypt[_0x175872(0x34b)](_0x210e61,saltRounds);_0x441919={..._0x441919,'bbPassword':_0x5f3dc3};}if(_0x31fcc3&&_0x441919[_0x175872(0x23c)]!=_0x175872(0x1b8)&&_0x441919['telegramToken']!='***'&&_0x441919[_0x175872(0x23c)]!=''){const _0x335a35=crypt[_0x175872(0x2d0)](secure['privateKey'],_0x441919[_0x175872(0x23c)])[_0x175872(0x302)][_0x175872(0x376)]('@')[0x0];_0x441919={..._0x441919,'telegramToken':_0x335a35};}const _0x182539=_0x441919[_0x175872(0x23c)]!=_0x175872(0x1b8)&&_0x441919[_0x175872(0x23c)]!=settings[_0x175872(0x23c)]||_0x441919[_0x175872(0x31b)]!=settings['telegramUsername'],_0x1ee87e=_0x441919['telegramToken']==''||_0x441919[_0x175872(0x31b)]=='';if(_0x182539)_0x441919['telegramEvents']=_0x175872(0x23f);for(const [_0x11816d,_0x57cc62]of Object['entries'](_0x441919)){if(_0x11816d==_0x175872(0x23c)&&_0x57cc62==_0x175872(0x1b8)){_0x441919[_0x175872(0x23c)]=settings['telegramToken'];continue;};if(_0x11816d=='bbPassword'&&_0x57cc62==_0x175872(0x1b8)){_0x441919[_0x175872(0x34e)]=settings[_0x175872(0x34e)];continue;};dbSettings[_0x175872(0x335)](_0x175872(0x24b)+_0x11816d,_0x57cc62)[_0x175872(0x347)]();}settings=_0x441919,io['to'](_0x175872(0x2b6))[_0x175872(0x1db)]('settings',cleanSettings()),broadcastToBots(_0x175872(0x26b),settings[_0x175872(0x26b)]),broadcastToBots('onepagemode',settings[_0x175872(0x243)]);if(_0x182539&&!_0x1ee87e)initTelegram();if(_0x182539&&_0x1ee87e)disableTelegram();getAllClients()[_0x175872(0x2fe)](_0x415946=>{const _0x4c6637=_0x175872;getSocket(_0x415946['id'])[_0x4c6637(0x1db)]('status',{'access':{'allow':![],'reason':_0x4c6637(0x24f),'token':null}});});}function updateSetting(_0x58378d,_0x3f3553){const _0x51019a=_0x58a6d1;dbSettings['set']('settings.'+_0x58378d,_0x3f3553)['write'](),settings=getSettings(),io['to']('botmanager')['emit'](_0x51019a(0x357),cleanSettings());}function storeSecure(_0x26d92d){const _0x13a2e9=_0x58a6d1;dbSecure[_0x13a2e9(0x355)]('secure')['push'](_0x26d92d)[_0x13a2e9(0x347)](),secure=_0x26d92d;}function addBlacklist(_0x8508fe){const _0x301d36=_0x58a6d1;cleanBlacklist();let _0x31725b;devices[_0x8508fe]['telegramIpApproval']?_0x31725b=Math[_0x301d36(0x257)](devices[_0x8508fe][_0x301d36(0x1d9)][_0x301d36(0x1de)],loginExpiry):_0x31725b=loginExpiry,dbSecure[_0x301d36(0x355)]('blacklist')[_0x301d36(0x351)]({'expiry':new Date()[_0x301d36(0x31c)]()+_0x31725b*0x3c*0x3e8,'token':devices[_0x8508fe][_0x301d36(0x305)][_0x301d36(0x375)]})[_0x301d36(0x347)](),blacklist=dbSecure[_0x301d36(0x355)](_0x301d36(0x28b))[_0x301d36(0x320)]();}function cleanBlacklist(){const _0xd26da7=_0x58a6d1;let _0x1328e5=dbSecure[_0xd26da7(0x355)]('blacklist')[_0xd26da7(0x34c)]()[_0xd26da7(0x320)](),_0x2e1b96=new Date()[_0xd26da7(0x31c)]();_0x1328e5[_0xd26da7(0x2fe)](_0x278996=>{const _0x2ffb42=_0xd26da7;_0x278996['expiry']<_0x2e1b96&&dbSecure[_0x2ffb42(0x355)](_0x2ffb42(0x28b))['remove']({'expiry':_0x278996[_0x2ffb42(0x1de)]})[_0x2ffb42(0x347)]();});}function initStates(){const _0x4b3df7=_0x58a6d1;let _0x4eac3b=getConfiguration();_0x4eac3b[_0x4b3df7(0x2fe)](_0x53b734=>{const _0x525811=_0x4b3df7;_0x53b734[_0x525811(0x236)]=_0x525811(0x204);}),storeConfiguration(_0x4eac3b);}function onKeys(){const _0xc868b4=new RSA();return new Promise(_0x29802d=>{const _0x4f7be5=_0x44bd;_0xc868b4[_0x4f7be5(0x35a)]()[_0x4f7be5(0x378)](_0x2bf58a=>{_0x29802d(_0x2bf58a);});});}async function generateKeys(){return await onKeys();}function _0x44bd(_0x333ec1,_0x4e17a9){const _0x3c02f0=_0x4f52();return _0x44bd=function(_0xfe5853,_0x389768){_0xfe5853=_0xfe5853-0x1b1;let _0x4f524d=_0x3c02f0[_0xfe5853];return _0x4f524d;},_0x44bd(_0x333ec1,_0x4e17a9);}async function oneTimeMigration(){const _0x35a768=_0x58a6d1;let _0x57dcd3=getSettings(),_0x111fd3=![];!_0x57dcd3[_0x35a768(0x2da)](_0x35a768(0x20a))&&(_0x57dcd3[_0x35a768(0x20a)]=0x0,_0x111fd3=!![]);!_0x57dcd3[_0x35a768(0x2da)](_0x35a768(0x340))&&(_0x57dcd3['lastmsgemitted']=0x0,_0x111fd3=!![]);!_0x57dcd3[_0x35a768(0x2da)](_0x35a768(0x2e8))&&(_0x57dcd3['latestversion']='0.0.0',_0x111fd3=!![]);!_0x57dcd3[_0x35a768(0x2da)](_0x35a768(0x243))&&(_0x57dcd3[_0x35a768(0x243)]=![],_0x111fd3=!![]);if(_0x111fd3)storeSettings(_0x57dcd3);}function storeConfiguration(_0x1b5361){const _0x111337=_0x58a6d1;dbConfig[_0x111337(0x355)](_0x111337(0x365))[_0x111337(0x21e)]()[_0x111337(0x347)](),_0x1b5361[_0x111337(0x2fe)](_0x421a4b=>{const _0x117f58=_0x111337;delete _0x421a4b[_0x117f58(0x1e1)];}),dbConfig[_0x111337(0x355)](_0x111337(0x365))['push'](..._0x1b5361)[_0x111337(0x347)](),config=_0x1b5361;}function resetPassword(){const _0x4e7c23=_0x58a6d1;tgBot&&settings[_0x4e7c23(0x1e0)]&&(tgBot[_0x4e7c23(0x2c1)](_0x4e7c23(0x1f0)),tgBot['sendMessage'](settings[_0x4e7c23(0x1e0)],_0x4e7c23(0x2ef),{'parse_mode':_0x4e7c23(0x23a),'reply_markup':{'inline_keyboard':[[{'text':_0x4e7c23(0x206),'callback_data':_0x4e7c23(0x206)},{'text':'no','callback_data':'no'}]]}})[_0x4e7c23(0x267)](_0x2a8667=>{telegramError(_0x2a8667);}),tgBot['on']('callback_query',async _0x6a1114=>{const _0x4f3457=_0x4e7c23,_0x52671b=_0x6a1114[_0x4f3457(0x317)],_0x532a4d=_0x6a1114[_0x4f3457(0x302)];tgBot[_0x4f3457(0x1c0)](_0x6a1114['id'])[_0x4f3457(0x378)](async()=>{const _0xf38bf4=_0x4f3457;if(_0x52671b!='no'){const _0x3f24b5=0xf,_0x54ae1c=_0xf38bf4(0x334),_0x51b466=Array[_0xf38bf4(0x1da)](crypto[_0xf38bf4(0x1fa)](new Uint32Array(_0x3f24b5)))[_0xf38bf4(0x32b)](_0x27c5ec=>_0x54ae1c[_0x27c5ec%_0x54ae1c['length']])[_0xf38bf4(0x1cc)](''),_0x3f35a9=bcrypt[_0xf38bf4(0x34b)](_0x51b466,saltRounds);storeSettings({'bbPassword':_0x3f35a9}),await tgBot[_0xf38bf4(0x213)](_0x532a4d[_0xf38bf4(0x316)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x51b466,{'parse_mode':_0xf38bf4(0x23a)})['catch'](_0x3eb928=>{telegramError(_0x3eb928);});}else await tgBot[_0xf38bf4(0x213)](_0x532a4d[_0xf38bf4(0x316)]['id'],_0xf38bf4(0x252))[_0xf38bf4(0x267)](_0x58b0b6=>{telegramError(_0x58b0b6);});}),tgBot[_0x4f3457(0x2c1)](_0x4f3457(0x1f0));}));}async function confirmRestore(_0x3cf087,_0x16fedd){const _0x5a212c=_0x58a6d1;io['to'](_0x5a212c(0x2b6))['emit']('notification',_0x5a212c(0x244),_0x5a212c(0x1d1)),tgBot&&settings['telegramChatId']&&(tgBot['removeListener'](_0x5a212c(0x1f0)),await tgBot[_0x5a212c(0x213)](settings[_0x5a212c(0x1e0)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':_0x5a212c(0x23a),'reply_markup':{'inline_keyboard':[[{'text':_0x5a212c(0x206),'callback_data':_0x5a212c(0x206)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x28cfaf=>{telegramError(_0x28cfaf);}),tgBot['on'](_0x5a212c(0x1f0),async _0x268acf=>{const _0x17c84b=_0x5a212c,_0xdb0f72=_0x268acf[_0x17c84b(0x317)],_0xc107d3=_0x268acf[_0x17c84b(0x302)];tgBot[_0x17c84b(0x1c0)](_0x268acf['id'])[_0x17c84b(0x378)](async()=>{const _0x1f7e9d=_0x17c84b;_0xdb0f72==_0x1f7e9d(0x206)?(await tgBot['sendMessage'](_0xc107d3[_0x1f7e9d(0x316)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x1f7e9d(0x23a)})[_0x1f7e9d(0x267)](_0x2a957c=>{telegramError(_0x2a957c);}),unzipFile(_0x3cf087,_0x16fedd)):(logger[_0x1f7e9d(0x28f)](_0x1f7e9d(0x35b)),await tgBot[_0x1f7e9d(0x213)](_0xc107d3[_0x1f7e9d(0x316)]['id'],_0x1f7e9d(0x35b))[_0x1f7e9d(0x267)](_0x2018ee=>{telegramError(_0x2018ee);}));}),tgBot['removeListener']('callback_query');}));}function getServerTime(){const _0x1f96ff=_0x58a6d1,_0x1795db=new Date();return _0x1795db['getFullYear']()+'/'+(_0x1795db['getMonth']()+0x1)['toString']()[_0x1f96ff(0x215)](0x2,'0')+'/'+_0x1795db[_0x1f96ff(0x24a)]()[_0x1f96ff(0x1bc)]()[_0x1f96ff(0x215)](0x2,'0')+'\x20'+_0x1795db[_0x1f96ff(0x24c)]()[_0x1f96ff(0x1bc)]()[_0x1f96ff(0x215)](0x2,'0')+':'+_0x1795db[_0x1f96ff(0x2a3)]()['toString']()[_0x1f96ff(0x215)](0x2,'0')+':'+_0x1795db[_0x1f96ff(0x232)]()['toString']()[_0x1f96ff(0x215)](0x2,'0');}function getTimeStamp(){const _0x2a8600=_0x58a6d1,_0x2b167b=shiftedTime();return _0x2b167b[_0x2a8600(0x2e9)]()+'/'+(_0x2b167b[_0x2a8600(0x2fd)]()+0x1)[_0x2a8600(0x1bc)]()['padStart'](0x2,'0')+'/'+_0x2b167b[_0x2a8600(0x24a)]()[_0x2a8600(0x1bc)]()[_0x2a8600(0x215)](0x2,'0')+'\x20'+_0x2b167b['getHours']()[_0x2a8600(0x1bc)]()[_0x2a8600(0x215)](0x2,'0')+':'+_0x2b167b['getMinutes']()['toString']()[_0x2a8600(0x215)](0x2,'0')+':'+_0x2b167b[_0x2a8600(0x232)]()[_0x2a8600(0x1bc)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x51f181=_0x58a6d1,_0x3ed0f0=shiftedTime();return _0x3ed0f0[_0x51f181(0x2e9)]()+(_0x3ed0f0[_0x51f181(0x2fd)]()+0x1)[_0x51f181(0x1bc)]()['padStart'](0x2,'0')+_0x3ed0f0[_0x51f181(0x24a)]()['toString']()[_0x51f181(0x215)](0x2,'0')+'-'+_0x3ed0f0[_0x51f181(0x24c)]()['toString']()['padStart'](0x2,'0')+_0x3ed0f0[_0x51f181(0x2a3)]()[_0x51f181(0x1bc)]()[_0x51f181(0x215)](0x2,'0')+_0x3ed0f0['getSeconds']()[_0x51f181(0x1bc)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x338f41=_0x58a6d1,_0x162b02=new Date();let _0x4d0b3f=_0x162b02;if(settings['timeshift']&&settings[_0x338f41(0x26b)]!==0x0)_0x4d0b3f=fns[_0x338f41(0x37b)](_0x162b02,{'hours':settings[_0x338f41(0x26b)]});return _0x4d0b3f;}function startScheduler(){const _0x389bcc=_0x58a6d1,_0x711c92=new Date()[_0x389bcc(0x1e8)](),_0x541d6d=shiftedTime()['getHours']();_0x541d6d==0x4&&backupConfigFiles();_0x541d6d==0x0&&rotateLogFiles();_0x711c92%0x6==0x0&&triggerAnalytics();_0x711c92%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x360113){const _0x4cbc74=_0x58a6d1;logger[_0x4cbc74(0x28f)]('Restore\x20backup\x20file\x20'+_0x360113);const _0x183376=getBotsWithMode();_0x183376[_0x4cbc74(0x348)]>0x0?confirmRestore(configbackuppath,_0x360113):unzipFile(configbackuppath,_0x360113);}async function getBackupFiles(_0xa24a58=null){const _0x393cef=_0x58a6d1;let _0x391b4e=[],_0x1aa4e1=fs[_0x393cef(0x268)](configbackuppath,{'withFileTypes':!![]});_0x1aa4e1['sort']((_0x45af7a,_0x40f065)=>_0x45af7a[_0x393cef(0x1ce)]<_0x40f065[_0x393cef(0x1ce)]?0x1:_0x40f065[_0x393cef(0x1ce)]<_0x45af7a[_0x393cef(0x1ce)]?-0x1:0x0),_0x1aa4e1[_0x393cef(0x2fe)](_0x544d8e=>{const _0x292987=_0x393cef;if(!_0x544d8e[_0x292987(0x207)]()&&_0x544d8e[_0x292987(0x1ce)][_0x292987(0x2a7)]('backup-full@')&&_0x544d8e['name']['endsWith'](_0x292987(0x37d))){const _0x267cde=formatDate(fs[_0x292987(0x37a)](configbackuppath+_0x544d8e[_0x292987(0x1ce)])['mtime']);_0x391b4e[_0x292987(0x351)]({'name':_0x544d8e[_0x292987(0x1ce)],'mtime':_0x267cde});}});if(_0xa24a58)io['to'](_0xa24a58)[_0x393cef(0x1db)]('backup-files',_0x391b4e);else return _0x391b4e;}async function backupConfigFiles(){const _0x5503f0=_0x58a6d1;await zipFiles(_0x5503f0(0x342));const _0xaa7020=getCleanTimeStamp();fs[_0x5503f0(0x312)](zippath+_0x5503f0(0x2de),configbackuppath+(_0x5503f0(0x369)+_0xaa7020+_0x5503f0(0x37d)));let _0x540112=fs[_0x5503f0(0x268)](configbackuppath,{'withFileTypes':!![]});_0x540112[_0x5503f0(0x22a)]((_0x4b05c5,_0x50e16d)=>_0x4b05c5[_0x5503f0(0x1ce)]<_0x50e16d[_0x5503f0(0x1ce)]?0x1:_0x50e16d[_0x5503f0(0x1ce)]<_0x4b05c5[_0x5503f0(0x1ce)]?-0x1:0x0),_0x540112[_0x5503f0(0x348)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x540112[maxBackups][_0x5503f0(0x1ce)]);}function rotateLogFiles(){const _0x33b45f=_0x58a6d1,_0x2a2342=fs[_0x33b45f(0x37a)](logspath+_0x33b45f(0x22e)),_0x50f8d3=_0x2a2342[_0x33b45f(0x2e5)]/0x400;if(_0x50f8d3>0x64){let _0x5414f7=fs[_0x33b45f(0x268)](logspath,{'withFileTypes':!![]});_0x5414f7[_0x33b45f(0x22a)]((_0x200e54,_0xdc22f)=>_0x200e54['name']<_0xdc22f[_0x33b45f(0x1ce)]?0x1:_0xdc22f[_0x33b45f(0x1ce)]<_0x200e54[_0x33b45f(0x1ce)]?-0x1:0x0),_0x5414f7[_0x33b45f(0x2fe)](_0x205aea=>{const _0x6dc655=_0x33b45f;if(_0x205aea['name']==_0x6dc655(0x1eb))fs[_0x6dc655(0x312)](logspath+_0x205aea[_0x6dc655(0x1ce)],logspath+_0x6dc655(0x27f));if(_0x205aea[_0x6dc655(0x1ce)]==_0x6dc655(0x218))fs['copyFileSync'](logspath+_0x205aea[_0x6dc655(0x1ce)],logspath+_0x6dc655(0x1eb));_0x205aea['name']==_0x6dc655(0x22e)&&(fs['copyFileSync'](logspath+_0x205aea['name'],logspath+_0x6dc655(0x218)),fs[_0x6dc655(0x238)](logspath+_0x205aea['name'],''));});}}async function zipFiles(_0x428920){const _0x2b5300=_0x58a6d1;let _0x47d637;if(_0x428920=='logs')_0x47d637=logspath;if(_0x428920==_0x2b5300(0x352))_0x47d637=configpath;if(_0x428920==_0x2b5300(0x342))_0x47d637=configpath;let _0x1aa2ee=fs[_0x2b5300(0x268)](_0x47d637,{'withFileTypes':!![]});const _0x22a5fb=new require(_0x2b5300(0x2d7))();_0x1aa2ee[_0x2b5300(0x2fe)](_0x5b92fb=>{const _0x4e630e=_0x2b5300;if(!_0x5b92fb[_0x4e630e(0x207)]()){let _0x1598d7=fs[_0x4e630e(0x30b)](_0x47d637+_0x5b92fb[_0x4e630e(0x1ce)]);if(_0x428920==_0x4e630e(0x352)){const _0x1229a1=/^bot-[0-9]{3}-config.json$/,_0x216ac3=_0x1229a1[_0x4e630e(0x26d)](_0x5b92fb[_0x4e630e(0x1ce)]);if(_0x216ac3){const _0x517005=JSON[_0x4e630e(0x31a)](_0x1598d7);if(_0x517005['bot'][0x0]){_0x517005['bot'][0x0][_0x4e630e(0x20e)]=_0x4e630e(0x286),_0x517005[_0x4e630e(0x1f6)][0x0][_0x4e630e(0x237)]='***';if(_0x517005['bot'][0x0][_0x4e630e(0x377)])_0x517005['bot'][0x0][_0x4e630e(0x377)]=_0x4e630e(0x286);}_0x1598d7=JSON['stringify'](_0x517005,null,0x2);}if(_0x5b92fb[_0x4e630e(0x1ce)]==_0x4e630e(0x329)){const _0x3598be=JSON['parse'](_0x1598d7);if(_0x3598be[_0x4e630e(0x357)]['loginRequired'])_0x3598be['settings'][_0x4e630e(0x366)]=![];if(_0x3598be[_0x4e630e(0x357)][_0x4e630e(0x34e)])_0x3598be[_0x4e630e(0x357)][_0x4e630e(0x34e)]='***';if(_0x3598be[_0x4e630e(0x357)][_0x4e630e(0x23c)])_0x3598be[_0x4e630e(0x357)]['telegramToken']=_0x4e630e(0x286);if(_0x3598be[_0x4e630e(0x357)][_0x4e630e(0x1e0)])_0x3598be[_0x4e630e(0x357)]['telegramChatId']=null;_0x1598d7=JSON[_0x4e630e(0x210)](_0x3598be,null,0x2);}if(_0x5b92fb[_0x4e630e(0x1ce)]!=_0x4e630e(0x2ea))_0x22a5fb[_0x4e630e(0x277)](_0x5b92fb[_0x4e630e(0x1ce)],_0x1598d7);}else _0x22a5fb['file'](_0x5b92fb[_0x4e630e(0x1ce)],_0x1598d7);}});const _0x53d742=_0x22a5fb['generate']({'base64':![],'compression':_0x2b5300(0x28d)});fs[_0x2b5300(0x238)](zippath+(_0x428920+'.zip'),_0x53d742,_0x2b5300(0x35d));}async function unzipFile(_0x305d17,_0x495337){const _0x4e670d=_0x58a6d1;fs['readdirSync'](configpath,{'withFileTypes':!![]})['forEach'](_0x2814c9=>{const _0x118b73=_0x44bd;if(!_0x2814c9[_0x118b73(0x207)]())fs[_0x118b73(0x1e6)](configpath+_0x2814c9[_0x118b73(0x1ce)]);});const _0x320a15=fs[_0x4e670d(0x30b)](_0x305d17+_0x495337,_0x4e670d(0x35d)),_0x55c479=new require('node-zip')(_0x320a15,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x55c479['files'])['forEach'](_0x9d627f=>{const _0x4dc3dc=_0x4e670d,_0x5ab22c=_0x55c479[_0x4dc3dc(0x301)][_0x9d627f];fs[_0x4dc3dc(0x238)](configpath+_0x5ab22c[_0x4dc3dc(0x1ce)],_0x5ab22c[_0x4dc3dc(0x262)]);}),fs[_0x4e670d(0x268)](temppath,{'withFileTypes':!![]})[_0x4e670d(0x2fe)](_0x18891a=>{const _0x50aabb=_0x4e670d;if(!_0x18891a[_0x50aabb(0x207)]())fs[_0x50aabb(0x1e6)](temppath+_0x18891a[_0x50aabb(0x1ce)]);}),logger[_0x4e670d(0x28f)](_0x4e670d(0x2f8)),process[_0x4e670d(0x2f5)]({'restore':!![]},_0x3abfbc=>{});}async function getPublicIp(){const _0x57b761=_0x58a6d1;try{const _0x87c797=await axios[_0x57b761(0x355)](_0x57b761(0x255));publicip=_0x87c797[_0x57b761(0x317)]['ip'];}catch(_0x3f65b0){}}async function triggerAnalytics(){const _0x960fd6=_0x58a6d1;if(!publicip)await getPublicIp();const _0x36e406=getBotsWithMode();let _0x5b4c17=0x0;_0x36e406[_0x960fd6(0x2fe)](_0x5419a9=>{const _0x27e259=_0x960fd6;if(_0x5419a9[_0x27e259(0x21d)]===_0x27e259(0x1e4))_0x5b4c17++;});const _0x217211=getBotExchanges();mixpanel[_0x960fd6(0x373)]('Server',{'distinct_id':settings[_0x960fd6(0x2bd)],'ip':publicip,'version':serverversion,'numbots':_0x36e406[_0x960fd6(0x348)],'numbotsenabled':_0x5b4c17,'exchanges':_0x217211});}async function getMessages(){const _0x39291b=_0x58a6d1,_0x5c5bcc='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x301bd=new GraphQLClient(_0x5c5bcc),_0x36b968={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x3c6ae0=serverversion[_0x39291b(0x376)]('.'),_0x550268=_0x3c6ae0[0x0]+'.'+_0x3c6ae0[0x1],_0x1537c7=Math['min'](settings[_0x39291b(0x20a)],settings[_0x39291b(0x340)]),_0x5e3699={'last':parseInt(_0x1537c7),'bbm':_0x550268},_0xcfcbf1=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x3c7714;try{_0x3c7714=await _0x301bd['request'](_0xcfcbf1,_0x5e3699,_0x36b968);}catch(_0x39ab02){}if(_0x3c7714&&_0x3c7714[_0x39291b(0x2ed)]){let _0x12d751=settings['lastmsgtelegram'];newMessages=[];for(const _0x1c6975 of _0x3c7714[_0x39291b(0x2ed)]){newMessages[_0x39291b(0x351)](_0x1c6975);if(_0x1c6975[_0x39291b(0x242)])updateSetting('latestversion',_0x1c6975[_0x39291b(0x242)]);let _0x16c301=_0x1c6975[_0x39291b(0x242)]?serverversion>=_0x1c6975[_0x39291b(0x242)]:![];if(!_0x16c301&&_0x1c6975['number']>_0x12d751){if(_0x1c6975['bbvReceive']===_0x39291b(0x250)||serverversion[_0x39291b(0x2a7)](_0x1c6975[_0x39291b(0x1bf)])){let _0x5549f2=''+_0x1c6975[_0x39291b(0x2f4)]+'\x0a\x0a'+_0x1c6975[_0x39291b(0x302)];const _0xf6cee=await sendTelegramMsg(toTelegramMarkdown(_0x5549f2),_0x39291b(0x1fb));if(_0xf6cee)_0x12d751=_0x1c6975[_0x39291b(0x266)];}}}updateAvailable=isNewerVersion(settings[_0x39291b(0x2e8)],serverversion),updateSetting('lastmsgtelegram',_0x12d751),emitMessages();}}function emitMessages(){const _0xf1ad78=_0x58a6d1,_0x5d10fd=settings[_0xf1ad78(0x340)];let _0x5a675a=[];newMessages['forEach'](_0x1a31a7=>{const _0x2e87df=_0xf1ad78;_0x1a31a7[_0x2e87df(0x266)]>_0x5d10fd&&_0x5a675a[_0x2e87df(0x351)](_0x1a31a7);}),_0x5a675a[_0xf1ad78(0x348)]>0x0&&getAllClients()[_0xf1ad78(0x2fe)](_0x3d1fa7=>{const _0x20f021=_0xf1ad78;getSocket(_0x3d1fa7['id'])[_0x20f021(0x1db)]('message',_0x5a675a);});}function confirmMessage(_0x4d2427){const _0x5073d2=_0x58a6d1;updateSetting(_0x5073d2(0x340),Number(_0x4d2427));}function isNewerVersion(_0x589d0c,_0x1b511b){const _0x38ac6e=_0x58a6d1,_0x267461=_0x1b511b['split']('.'),_0x21fcb5=_0x589d0c[_0x38ac6e(0x376)]('.');for(var _0x57fea1=0x0;_0x57fea1<_0x21fcb5['length'];_0x57fea1++){const _0x20a2e4=~~_0x21fcb5[_0x57fea1],_0x2065f0=~~_0x267461[_0x57fea1];if(_0x20a2e4>_0x2065f0)return!![];if(_0x20a2e4<_0x2065f0)return![];}return![];}function toTelegramMarkdown(_0x31e3bc){const _0x255bae=_0x58a6d1,_0x890ab9=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x30a41d=/\*{2}(.+?)\*{2}/gim;return _0x31e3bc=_0x31e3bc[_0x255bae(0x26a)](_0x890ab9,_0x255bae(0x26c))['replace'](_0x30a41d,_0x255bae(0x2ee)),_0x31e3bc;}async function validateConfigFile(){const _0xaf5950=_0x58a6d1,_0x233839=dbConfig[_0xaf5950(0x355)]('bots')['sortBy'](_0xaf5950(0x261))['value']()||[];if(_0x233839[_0xaf5950(0x348)]==0x0){let _0x1e2a7c=0x0,_0x480299=[];const _0x155fcc=/^bot-([0-9]{3})-config.json$/,_0xf979b6=fs[_0xaf5950(0x268)](configpath);_0xf979b6[_0xaf5950(0x2fe)](_0x18403d=>{const _0x341a0e=_0xaf5950,_0xca55af=_0x155fcc[_0x341a0e(0x2e6)](_0x18403d);if(_0xca55af){const _0x4ae29b=_0xca55af[0x1];let _0x3a1353=getBotAttributes(_0x4ae29b);_0x480299['push']({'botID':_0x4ae29b,'botname':_0x3a1353[_0x341a0e(0x281)],'status':_0x341a0e(0x364),'live':_0x341a0e(0x204)}),_0x1e2a7c++;}}),_0x1e2a7c!=0x0&&(dbConfig[_0xaf5950(0x355)](_0xaf5950(0x365))[_0xaf5950(0x349)](_0x480299)[_0xaf5950(0x347)](),config=_0x480299,restoredConfigFile=_0x1e2a7c);}}async function restoreConfigNotify(_0x30672e){const _0x479da7=_0x58a6d1;let _0x42db8d;if(restoredConfigFile==0x1)_0x42db8d=_0x479da7(0x22d);else _0x42db8d=_0x479da7(0x2dc);if(_0x30672e)io['to'](_0x479da7(0x2b6))[_0x479da7(0x1db)](_0x479da7(0x225),_0x42db8d);else{logger[_0x479da7(0x36b)]('-----------------------------------------------------------------------------------'),logger[_0x479da7(0x36b)](_0x42db8d),logger[_0x479da7(0x36b)](_0x479da7(0x2f7)),logger['simple']('');if(tgBot&&settings[_0x479da7(0x1e0)]&&settings[_0x479da7(0x315)]!=_0x479da7(0x294))tgBot[_0x479da7(0x213)](settings[_0x479da7(0x1e0)],_0x479da7(0x2c2)+_0x42db8d)['catch'](_0x9b5961=>{telegramError(_0x9b5961);});}}function validateCredentials(_0x185ff8,_0x442614){const _0x161e4a=_0x58a6d1;if(_0x185ff8[_0x161e4a(0x1fe)]==settings[_0x161e4a(0x310)]&&bcrypt[_0x161e4a(0x26f)](_0x185ff8[_0x161e4a(0x2db)],settings[_0x161e4a(0x34e)])){if(settings[_0x161e4a(0x25d)])return{'allow':![],'reason':_0x161e4a(0x30d),'token':null};else{const _0xb0613a=generateLoginToken(_0x442614);return{'allow':!![],'reason':_0x161e4a(0x23e),'token':_0xb0613a};}}else return{'allow':![],'reason':_0x161e4a(0x1f8),'token':null};}function refreshToken(_0x1e4dc5){const _0x4d8600=generateLoginToken(_0x1e4dc5);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x4d8600};}function validateAccess(_0x1a3f47,_0x48cc62,_0x3b4ce8){const _0x3f53a8=_0x58a6d1,_0x2a236d=_0x3b4ce8?_0x3b4ce8:devices[_0x48cc62]['ip'];let _0x42a1c8;const _0x5ac167=_0x141d96=>{const _0x3b45ce=_0x44bd;if(settings['loginRequired']){if(settings[_0x3b45ce(0x25d)]){if(telegram2FaApproved(_0x48cc62)){const _0x3d7106=generateLoginToken(_0x48cc62);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x3d7106};}else return{'allow':![],'reason':_0x3b45ce(0x325),'token':null};}else return _0x42a1c8=validToken(_0x141d96,_0x48cc62),_0x42a1c8[_0x3b45ce(0x2da)](_0x3b45ce(0x1d1))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x141d96}:{'allow':![],'reason':_0x3b45ce(0x325),'token':null};}else return{'allow':!![],'reason':_0x3b45ce(0x2dd),'token':null};};if(settings[_0x3f53a8(0x2d2)]){let _0x8067=[...settings[_0x3f53a8(0x308)],'::1','::ffff:127.0.0.1',_0x3f53a8(0x370)];if(_0x8067['includes'](_0x2a236d))return _0x5ac167(_0x1a3f47);else{_0x42a1c8=validToken(_0x1a3f47,_0x48cc62);if(_0x42a1c8[_0x3f53a8(0x2da)]('success'))return _0x5ac167(_0x1a3f47);else{if(telegramIpApproved(_0x48cc62)){const _0x4cd55f=generateToken(_0x48cc62);return _0x42a1c8=_0x5ac167(_0x1a3f47),_0x42a1c8['allow']?{'allow':!![],'reason':_0x3f53a8(0x2df),'token':_0x4cd55f}:_0x42a1c8;}else return settings[_0x3f53a8(0x1d4)]?{'allow':![],'reason':_0x3f53a8(0x2b9),'token':null}:{'allow':![],'reason':_0x3f53a8(0x361),'token':null};}}}else return _0x5ac167(_0x1a3f47);}function timelyDecrypt(_0x433897,_0x422d43=!![]){const _0x4e38bc=_0x58a6d1;if(_0x433897)try{const _0x46a062=crypt[_0x4e38bc(0x2d0)](secure[_0x4e38bc(0x24e)],_0x433897)[_0x4e38bc(0x302)],_0x421583=_0x46a062[_0x4e38bc(0x376)]('@')[0x0],_0x413e2d=_0x46a062['split']('@')[0x1],_0x5e246f=new Date()['getTime']();if(_0x422d43){if(_0x5e246f-_0x413e2d<maxSecretAge*0x3e8)return _0x421583;else return![];}else return _0x421583;}catch(_0x35dc46){return![];}else return![];}const validToken=(_0x28968a,_0x212686)=>{const _0x1c4a19=_0x58a6d1,_0x16ff97=devices[_0x212686]['ip'];if(!_0x28968a)return{'error':_0x1c4a19(0x2d1)};for(let _0x1bb5b1 of blacklist){if(_0x1bb5b1[_0x1c4a19(0x375)]==_0x28968a)return{'error':_0x1c4a19(0x1b1)};}let _0x6a4f20;try{_0x6a4f20=jwt[_0x1c4a19(0x33b)](_0x28968a,secure['secret']+_0x212686);}catch{return{'error':_0x1c4a19(0x321)};}if(!_0x6a4f20[_0x1c4a19(0x2da)](_0x1c4a19(0x21a))&&!_0x6a4f20[_0x1c4a19(0x2da)](_0x1c4a19(0x1fe))||!_0x6a4f20[_0x1c4a19(0x2da)](_0x1c4a19(0x1c7)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x6a4f20['hasOwnProperty']('username')&&_0x6a4f20['hasOwnProperty'](_0x1c4a19(0x21a))){const {clientip:_0x16cbb4}=_0x6a4f20;return _0x16ff97==_0x16cbb4?{'success':_0x1c4a19(0x2e7)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x6a4f20[_0x1c4a19(0x2da)]('username')&&_0x6a4f20[_0x1c4a19(0x2da)]('clientip')){const {username:_0x47383,clientip:_0x3acddb}=_0x6a4f20;return settings['bbUsername']==_0x47383&&_0x16ff97==_0x3acddb?{'success':_0x1c4a19(0x2e7)}:{'error':_0x1c4a19(0x332)};}}},generateLoginToken=_0x41b29b=>{const _0xcacfba=_0x58a6d1;if(_0x41b29b){const _0x19c31c=devices[_0x41b29b]['ip'];return jwt[_0xcacfba(0x212)]({'username':settings['bbUsername'],'clientip':_0x19c31c},secure[_0xcacfba(0x220)]+_0x41b29b,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x51af3a=>{const _0xf9a958=_0x58a6d1;if(_0x51af3a){const _0x526c23=devices[_0x51af3a]['ip'];return jwt[_0xf9a958(0x212)]({'clientip':_0x526c23},secure[_0xf9a958(0x220)]+_0x51af3a,{'expiresIn':devices[_0x51af3a][_0xf9a958(0x1d9)][_0xf9a958(0x1de)]*0x3c});}else return![];},telegramIpApproved=_0x1c83ef=>{const _0x5639ed=_0x58a6d1;let _0x15009a=![];return devices[_0x1c83ef][_0x5639ed(0x1d9)]&&devices[_0x1c83ef]['telegramIpApproval'][_0x5639ed(0x1de)]!=_0x5639ed(0x208)&&(_0x15009a=devices[_0x1c83ef][_0x5639ed(0x1d9)]['clientip']==devices[_0x1c83ef]['ip']&&new Date()['getTime']()-devices[_0x1c83ef][_0x5639ed(0x1d9)][_0x5639ed(0x2cb)]<devices[_0x1c83ef][_0x5639ed(0x1d9)][_0x5639ed(0x1de)]*0x3c*0x3e8),_0x15009a;},telegram2FaApproved=_0x52b2d2=>{const _0x31039a=_0x58a6d1;let _0x500ba7=![];return devices[_0x52b2d2][_0x31039a(0x330)]&&devices[_0x52b2d2][_0x31039a(0x330)]['expiry']!=_0x31039a(0x208)&&(_0x500ba7=devices[_0x52b2d2]['telegram2FaApproval']['clientip']==devices[_0x52b2d2]['ip']&&new Date()[_0x31039a(0x31c)]()-devices[_0x52b2d2][_0x31039a(0x330)][_0x31039a(0x2cb)]<devices[_0x52b2d2]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x500ba7;},normalizeIP=_0x542da3=>{const _0x47df8a=_0x58a6d1;let _0x54351e=null,_0xdac51a=null;if(ipaddr[_0x47df8a(0x283)](_0x542da3)){const _0xdd4dbf=ipaddr[_0x47df8a(0x31a)](_0x542da3);_0xdd4dbf[_0x47df8a(0x1c9)]()===_0x47df8a(0x1ca)?(_0xdd4dbf[_0x47df8a(0x29f)]()&&(_0x54351e=_0xdd4dbf['toIPv4Address']()[_0x47df8a(0x1bc)]()),_0xdac51a=_0xdd4dbf[_0x47df8a(0x1bc)]()):(_0x54351e=_0xdd4dbf[_0x47df8a(0x1bc)](),_0xdac51a=_0xdd4dbf[_0x47df8a(0x1c2)]()[_0x47df8a(0x1bc)]());}return{'show':_0x54351e?_0x54351e:_0xdac51a,'store':_0xdac51a};};function formatDate(_0x49298a){const _0x5672e9=_0x58a6d1;return _0x49298a[_0x5672e9(0x2e9)]()+'/'+(_0x49298a[_0x5672e9(0x2fd)]()+0x1)[_0x5672e9(0x1bc)]()[_0x5672e9(0x215)](0x2,'0')+'/'+_0x49298a[_0x5672e9(0x24a)]()[_0x5672e9(0x1bc)]()[_0x5672e9(0x215)](0x2,'0')+'\x20'+_0x49298a[_0x5672e9(0x24c)]()[_0x5672e9(0x1bc)]()[_0x5672e9(0x215)](0x2,'0')+':'+_0x49298a[_0x5672e9(0x2a3)]()[_0x5672e9(0x1bc)]()['padStart'](0x2,'0')+':'+_0x49298a['getSeconds']()[_0x5672e9(0x1bc)]()[_0x5672e9(0x215)](0x2,'0');}function sleep(_0x38d0c8){return new Promise(_0x48491a=>setTimeout(_0x48491a,_0x38d0c8));}