const _0x1f5a02=_0x4978;(function(_0x22dd4f,_0xd37a2e){const _0x2bde13=_0x4978,_0xb36107=_0x22dd4f();while(!![]){try{const _0x3f9ab9=-parseInt(_0x2bde13(0x1d9))/0x1+parseInt(_0x2bde13(0x397))/0x2*(parseInt(_0x2bde13(0x2ce))/0x3)+parseInt(_0x2bde13(0x234))/0x4+parseInt(_0x2bde13(0x348))/0x5*(parseInt(_0x2bde13(0x33b))/0x6)+-parseInt(_0x2bde13(0x2fa))/0x7+parseInt(_0x2bde13(0x255))/0x8*(-parseInt(_0x2bde13(0x1c9))/0x9)+-parseInt(_0x2bde13(0x2c8))/0xa*(-parseInt(_0x2bde13(0x256))/0xb);if(_0x3f9ab9===_0xd37a2e)break;else _0xb36107['push'](_0xb36107['shift']());}catch(_0x42e683){_0xb36107['push'](_0xb36107['shift']());}}}(_0x4c6c,0x7987f));const _0x15e2a7=function(){let _0x48292e=!![];return function(_0x57fbef,_0x52e804){const _0x4d1add=_0x48292e?function(){if(_0x52e804){const _0x11cd10=_0x52e804['apply'](_0x57fbef,arguments);return _0x52e804=null,_0x11cd10;}}:function(){};return _0x48292e=![],_0x4d1add;};}(),_0x516dd2=_0x15e2a7(this,function(){const _0x25e68c=_0x4978;return _0x516dd2['toString']()[_0x25e68c(0x1fe)](_0x25e68c(0x1d6))[_0x25e68c(0x20c)]()[_0x25e68c(0x2bb)](_0x516dd2)['search'](_0x25e68c(0x1d6));});_0x516dd2();function _0x4c6c(){const _0x155e93=['debug','slice','</b>\x20?','publicKey','You\x20can\x20use\x20the\x20following\x20commands:\x0a','find','\x20|\x20','Notifications\x20disabled','Unauthorized\x20attempt\x20to\x20confirm\x20message','./version.json','catch','address','telegramIpApproval','alias','user','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','telegramEnabled','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','stopPolling','assign','bot-','botname','privateKey','mode','number','type','store','uuid-random','showname','\x1b[35m','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','bb/','bb-settings.json','Session\x20expired\x20for\x20user\x20...','blacklist','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Invalid\x20username\x20or\x20IP\x20address','clientip','jsonwebtoken','confirm-message','/off\x20-\x20stop\x20bot(s)\x0a','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Ok,\x20will\x20send\x20alert\x20notifications\x20only','(staging)','defaults','\x20(1)','from','Allow\x20login\x20from\x20IP\x20address\x20<b>','answerCallbackQuery','files','split','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','initclient','event','apiPassword','isValid','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','args','forEach','Invalid\x20Telegram\x20token','show-config','readFileSync','disconnect','Unauthorized\x20attempt\x20to\x20log\x20out','removeListener','Unauthorized\x20attempt\x20to\x20delete\x20alerts','2FA','connected','DEFLATE','update-bot','accept','Crypt','backup','/on\x20-\x20start\x20bot(s)\x0a','backup-full','callback_query','order','error','botID','botmanager','\x20|\x20user:\x20...','getHours','production','getMinutes','sendPortfolioTelegram','bots','stop','getStartingBalances','cancel-loading','\x20only\x0a','parse','No\x20bots\x20running\x20right\x20now','simple','node','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Notifications\x20disabled\x0a','max','Token\x20blacklisted','kill','#RES#\x20if\x20running\x20on\x20server','constructor','success','/metrics\x20-\x20show\x20bot\x20performance\x0a','Notifications\x20enabled\x0a','exp','init','use','telegram2FaApproval','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','<b>Balance\x20Bot\x20Status:</b>\x0a',',\x20must\x20be\x20a\x204\x20digit\x20number','bb-secure.json','-events.json','124330xLLtnJ','Notifications\x20types:\x20','logged\x20out','mkdirSync','/:bot/support','generate','6033jzCSRY','output-000.log','\x20mode','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','reset-history','Invalid\x20IP\x20address','started','Unauthorized\x20attempt\x20to\x20store\x20configuration','settings.','getDate','<b>Telegram\x20Bot\x20Status:</b>\x0a','get-starting-balances','secure','\x1b[0m','host','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','/:bot/coins','size','internal','.zip','2FA\x20required','update-bb','logs','ipc','auth','download','crypto','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','api-eu.mixpanel.com','includes','full','build2','Alerts','\x1b[31m','generateKeyPairAsync','running','#RES#\x20','name','Starting\x20#RED#Balance\x20Bot\x20v','toIPv4MappedAddress','temporary\x20access\x20rejected','::ffff:127.0.0.1','restore-backup-file','isDirectory','2732800lzNcrD','format','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','logs/','Idling\x20bot\x20\x20\x20|\x20Bot\x20','NTBA_FIX_319','temporary\x20token\x20generated','2FA\x20login\x20token\x20generated','disabled','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','yes','backup-full@','Starting\x20new\x20bot\x20|\x20Bot\x20','secret','writeFileSync','3000','store-fiat','[ip-address]','Unauthorized\x20attempt\x20to\x20add\x20bot','remoteAddress','isIPv4MappedAddress','exchange','::1','allow','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Invalid\x20authentication\x20token\x20(2)','/names\x20-\x20show\x20bot\x20names\x0a','orders','\x1b[33m','Unauthorized\x20attempt\x20to\x20download\x20','Starting\x20bot\x20|\x20Bot\x20','reload','send','yargs/yargs','bbvNew','login\x20required','data','then','bot.js','binary','handshake','index.html','reinstall','delete-alerts','ipv6','#RES#\x20if\x20running\x20locally\x0a','30\x20min','sendMessage','post','Unauthorized\x20attempt\x20to\x20get\x20messages','output-002.log','title','output-001.log','onText','temporary\x20access\x20not\x20allowed','emit','padStart','get-logs','new-disabled','/:bot/configuration','-config.json','login\x20token\x20generated','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','message','RSA','28086VqjMXu','show','listen','File\x20uploaded','existsSync','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','/output-000.log','Unauthorized\x20attempt\x20to\x20delete\x20bot','exec','polling_error','pidExpireLogin','staging','enabled','25JOzkUY','get','hasOwnProperty','endsWith','referer','zip/','Restoring\x20bot(s)\x20from\x20backup','socket','hashSync','bbPassword','function','track','uncaughtException','Invalid\x20authentication\x20token\x20(1)','login\x20not\x20required','messages','get-backup-files',':\x20Bot\x20Mgr\x20>\x20','family','join','Unauthorized\x20attempt\x20to\x20show\x20configuration','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Backup\x20file\x20uploaded','Network\x20Interfaces:','/enable\x20-\x20enable\x20notifications\x0a','port','static','Markdown','***','reject','loginRequired','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Error\x20while\x20deleting\x20config\x20files:\x20','Ok,\x20will\x20send\x20order\x20notifications\x20only','latestversion','remove','expiry','output-003.log','update','2FA\x20login\x20rejected','connection','headless','manual','getPortfolio','storeHeadless','test','Failed\x20to\x20download\x20','/disable\x20-\x20disable\x20notifications\x0a','access','Orders','Starting\x20Balance\x20Bot\x20update','No\x20authentication\x20token','startsWith','emitHistory','/upload-backup','createServer','bbUsername','store-settings','backup-files','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','status','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','\x20minutes','backup/','reason','inherit','map','sendFile','push','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','************','Node.js\x20v','Logged\x20out\x20user\x20...','headers','Error\x20removing\x20old\x20backup\x20files:','0.0.0','invalid\x20credentials','removeAllListeners','All\x20bots','744dwlgFp','bot','compareSync','IPv4','telegramChatId','write','RSA-OAEP','length','log','All','get-portfolio','graphql-request','delete-bot','User\x20has\x20been\x20validated','timeshift','sockets','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','axios','72477KCKpcd','Yes','range','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','/:bot/portfolio','all','onepagemode','apiSecret','exit','cloneDeep','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','unlinkSync','whitelistEnabled','(((.+)+)+)+$','match','date-fns','435012qYTQMc','userid','getTime','encryptedUuid','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','username','alerts','lastmsgtelegram','Your\x20installation\x20is\x20already\x20up\x20to\x20date','replace','auto','store-headless','login\x20token\x20valid','/status\x20-\x20show\x20bot(s)\x20status\x0a','All\x20bots\x20running\x20right\x20now','readdirSync','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','randomBytes','2FA\x20login\x20required','temp/','Login\x20rejected','Unauthorized\x20attempt\x20to\x20update\x20bot','env','sortBy','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Logged\x20in\x20user\x20...','temporaryAccessAllowed','new','\x20|\x20client:\x20...','file','uuid','_data','storeConfiguration','min','getUTCHours','\x20to\x20','Unauthorized\x20login\x20attempt\x20(timeout)','search','sign','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','environment','-----------------------------------------------------------------------------------','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','=>\x20Go\x20to\x20#CYA#http://','/:bot','http','Bot\x20','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','HTML','deleteHistoryAlerts','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','toString','-performance.json','bcryptjs','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','decrypt','config/','1000','Disabled\x20Bot\x20','/download/:type','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','telegramEvents','stringify','randomFillSync','404\x20Not\x20Found','\x20>\x20','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','/:bot/history','filter','Password\x20has\x20been\x20reset\x20to:\x20','placeOrder','get-messages','sort','resetHistory','value','kind','chat','path','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','add-bot','util','/restart\x20-\x20restart\x20bot(s)\x0a','Setting\x20access:\x20','reinstall-bb','settings','entries','getMonth','node-zip','showConfig','notification','fork','2558880VyXNbP','Error:\x20Invalid\x20argument\x20','Notifications\x20enabled','login','pidRefreshToken','apiKey','getFullYear','mixpanel','Restarting\x20Bot\x20','toggleBotMode','telegramUsername','telegrammsg','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','stopped','Restore\x20process\x20aborted','express-fileupload','live','build','telegramToken','lowdb','getSeconds','Bot\x20Mgr\x20>\x20','hybrid-crypto-js','token',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Access\x20enabled\x20for\x20','telegram','timestamp','rmSync','lastmsgemitted','copyFileSync','password','Restore\x20backup\x20file\x20','248sFRJho','143PZREcQ'];_0x4c6c=function(){return _0x155e93;};return _0x4c6c();}'use strict';process[_0x1f5a02(0x1ef)][_0x1f5a02(0x2ff)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x1f5a02(0x1d8)),low=require(_0x1f5a02(0x247)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x1f5a02(0x226)),crypto=require(_0x1f5a02(0x2e8)),Crypt=require(_0x1f5a02(0x24a))[_0x1f5a02(0x29e)],RSA=require(_0x1f5a02(0x24a))[_0x1f5a02(0x33a)],bcrypt=require(_0x1f5a02(0x20e)),jwt=require(_0x1f5a02(0x27d)),ipaddr=require('ipaddr.js'),argv=require(_0x1f5a02(0x31b))(process['argv'][_0x1f5a02(0x258)](0x2))['argv'],uuidRandom=require(_0x1f5a02(0x272)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require(_0x1f5a02(0x23b)),axios=require(_0x1f5a02(0x1c8)),{GraphQLClient,gql}=require(_0x1f5a02(0x1c2)),util=require(_0x1f5a02(0x229)),fileUpload=require(_0x1f5a02(0x243)),{networkInterfaces}=require('os'),PORT=argv[_0x1f5a02(0x361)]||_0x1f5a02(0x309),pattern=/^[0-9]{2,4}$/;!pattern[_0x1f5a02(0x375)](PORT)&&(console[_0x1f5a02(0x1bf)](_0x1f5a02(0x235)+PORT+_0x1f5a02(0x2c5)),process['exit'](0x1));const HOST=argv[_0x1f5a02(0x2dc)]||null,userID=argv[_0x1f5a02(0x265)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x1f5a02(0x2b4)],environment=require(_0x1f5a02(0x260))[_0x1f5a02(0x201)]||_0x1f5a02(0x2a9);let bbpath=_0x1f5a02(0x276),bbpath2='';const botfile=_0x1f5a02(0x320),configfile='bb-config.json',settingsfile='bb-settings.json',securefile=_0x1f5a02(0x2c6),maxBackups=0xa;let validInstallation=!![];!fs[_0x1f5a02(0x33f)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x1f5a02(0x211)+userID+'/':bbpath+_0x1f5a02(0x211),configbackuppath=configpath+_0x1f5a02(0x387),logspath=userID?bbpath+_0x1f5a02(0x2fd)+userID+'/':bbpath+_0x1f5a02(0x2fd),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x1f5a02(0x34d),loggerfile=fs['createWriteStream'](logspath+_0x1f5a02(0x341),{'flags':'a'}),temppath=userID?bbpath+_0x1f5a02(0x1ec)+userID+'/':bbpath+'temp/';!fs[_0x1f5a02(0x33f)](configpath)&&fs[_0x1f5a02(0x2cb)](configpath);!fs[_0x1f5a02(0x33f)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x1f5a02(0x2cb)](logspath);!fs[_0x1f5a02(0x33f)](zippath)&&fs[_0x1f5a02(0x2cb)](zippath);!fs[_0x1f5a02(0x33f)](temppath)&&fs[_0x1f5a02(0x2cb)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x1f5a02(0x283)]({'bots':[]})[_0x1f5a02(0x1bc)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x1f5a02(0x283)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x1f5a02(0x393),'onepagemode':![]}})[_0x1f5a02(0x1bc)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x1f5a02(0x283)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x1f5a02(0x1bd)});const saltRounds=0xa,mixpanel=Mixpanel[_0x1f5a02(0x2c0)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x1f5a02(0x2ea)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x1f5a02(0x246)]&&settings['telegramToken']!=''&&settings['telegramUsername']&&settings[_0x1f5a02(0x23e)]!='')initTelegram();const parseColor=(_0x5217b4,_0x6a83fa)=>{const _0x77393b=_0x1f5a02,_0x402168=/#[A-Z]{3}#/g;if(typeof _0x5217b4=='string'){!_0x6a83fa?_0x5217b4=_0x5217b4['replace'](_0x402168,''):(_0x5217b4=_0x5217b4[_0x77393b(0x1e2)](/#BLU#/g,'\x1b[34m'),_0x5217b4=_0x5217b4['replace'](/#RED#/g,_0x77393b(0x2ef)),_0x5217b4=_0x5217b4[_0x77393b(0x1e2)](/#YEL#/g,_0x77393b(0x316)),_0x5217b4=_0x5217b4[_0x77393b(0x1e2)](/#MAG#/g,_0x77393b(0x274)),_0x5217b4=_0x5217b4[_0x77393b(0x1e2)](/#CYA#/g,'\x1b[36m'),_0x5217b4=_0x5217b4[_0x77393b(0x1e2)](/#RES#/g,_0x77393b(0x2db)));;}return _0x5217b4;},logger={'screen':_0x37e53f=>{const _0x4ef783=_0x1f5a02;console[_0x4ef783(0x1bf)](parseColor(_0x37e53f,!![]));},'simple':_0x1dd2e8=>{const _0x2ff9b3=_0x1f5a02;console['log'](parseColor(_0x1dd2e8,!![])),loggerfile[_0x2ff9b3(0x1bc)](util['format'](parseColor(_0x1dd2e8,![]))+'\x0a');},'full':async _0x4f4acc=>{const _0x3e6a95=_0x1f5a02,_0x5ed6a1=getTimeStamp()+_0x3e6a95(0x359)+_0x4f4acc;console[_0x3e6a95(0x1bf)](parseColor(_0x5ed6a1,!![])),loggerfile[_0x3e6a95(0x1bc)](util[_0x3e6a95(0x2fb)](parseColor(_0x5ed6a1,![]))+'\x0a');if(tgBot&&settings[_0x3e6a95(0x1bb)]&&settings[_0x3e6a95(0x216)]!=_0x3e6a95(0x315))await tgBot[_0x3e6a95(0x329)](settings[_0x3e6a95(0x1bb)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x4f4acc,![]))['catch'](_0x206813=>{telegramError(_0x206813);});},'debug':async(_0x4cd509,_0x494aa3='')=>{const _0xc738be=_0x1f5a02,_0x144a31=getTimeStamp()+_0xc738be(0x24c)+_0x4cd509;if(debugging)console[_0xc738be(0x1bf)](parseColor(_0x144a31,!![]));loggerfile[_0xc738be(0x1bc)](util[_0xc738be(0x2fb)](parseColor(_0x144a31,![]))+'\x0a');if(_0x494aa3){if(debugging)console['log'](_0x494aa3);loggerfile[_0xc738be(0x1bc)](util[_0xc738be(0x2fb)](_0x494aa3)+'\x0a');}}};function _0x4978(_0x44cd20,_0x3ad9ee){const _0x5c745c=_0x4c6c();return _0x4978=function(_0x516dd2,_0x15e2a7){_0x516dd2=_0x516dd2-0x1b9;let _0x4c6c84=_0x5c745c[_0x516dd2];return _0x4c6c84;},_0x4978(_0x44cd20,_0x3ad9ee);}process['on'](_0x1f5a02(0x354),function(_0x55a44d){const _0x5dc909=_0x1f5a02;logger[_0x5dc909(0x2b3)](_0x55a44d);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x1f5a02(0x206))[_0x1f5a02(0x37f)](app);app[_0x1f5a02(0x2c1)](fileUpload({'useTempFiles':!![]})),app[_0x1f5a02(0x349)](_0x1f5a02(0x214),async(_0x167e24,_0x3a2f37)=>{const _0x4e3ea8=_0x1f5a02,_0x475c9e=_0x167e24['params'][_0x4e3ea8(0x270)],_0x20ac02=getClientsWithBotID(_0x4e3ea8(0x2a6)),_0x36787a=_0x167e24[_0x4e3ea8(0x391)]['uuid'],_0x4a5215=timelyDecrypt(_0x36787a,![]),_0x379267=_0x20ac02[_0x4e3ea8(0x25c)](_0x420cf9=>_0x420cf9[_0x4e3ea8(0x1f7)]==_0x4a5215);if(_0x379267){const _0x9f74c3=normalizeIP(_0x167e24[_0x4e3ea8(0x34f)]['remoteAddress'])[_0x4e3ea8(0x271)],_0x2042fc=_0x167e24[_0x4e3ea8(0x391)]['tkn'];if(validateAccess(_0x2042fc,_0x4a5215,_0x9f74c3)[_0x4e3ea8(0x311)])_0x475c9e==_0x4e3ea8(0x29f)&&await backupConfigFiles(),await zipFiles(_0x475c9e),_0x3a2f37[_0x4e3ea8(0x2e7)](zippath+(_0x475c9e+'.zip'),_0x3d0bd4=>{const _0x46e3c6=_0x4e3ea8;_0x3d0bd4&&(logger[_0x46e3c6(0x2ec)](_0x46e3c6(0x376)+_0x475c9e),logger[_0x46e3c6(0x2b3)](_0x3d0bd4));});else logger['full'](_0x4e3ea8(0x317)+_0x475c9e+_0x4e3ea8(0x284));}else logger['full'](_0x4e3ea8(0x317)+_0x475c9e+'\x20(2)');}),app[_0x1f5a02(0x32a)](_0x1f5a02(0x37e),async(_0x241e20,_0x1216a9)=>{const _0x152976=_0x1f5a02,_0x541d5f=getClientsWithBotID('botmanager'),_0x11cc17=_0x241e20[_0x152976(0x391)]['uuid'],_0x46ee03=timelyDecrypt(_0x11cc17,![]),_0xcc09a=_0x541d5f[_0x152976(0x25c)](_0x13758b=>_0x13758b[_0x152976(0x1f7)]==_0x46ee03);logger[_0x152976(0x257)](_0x152976(0x35e));if(_0xcc09a){const _0x1b38d8=normalizeIP(_0x241e20['socket'][_0x152976(0x30d)])[_0x152976(0x271)],_0x54a8ef=_0x241e20['headers']['tkn'];if(validateAccess(_0x54a8ef,_0x46ee03,_0x1b38d8)['allow']){if(_0x241e20['files']){const _0x94ae0=_0x241e20['files']['backupfile'];await _0x94ae0['mv'](temppath+_0x94ae0['name']),_0x1216a9[_0x152976(0x31a)]({'status':!![],'message':_0x152976(0x33e)});const _0x12a46b=getBotsWithMode();_0x12a46b[_0x152976(0x1be)]>0x0?confirmRestore(temppath,_0x94ae0[_0x152976(0x2f3)]):unzipFile(temppath,_0x94ae0[_0x152976(0x2f3)]);}}else logger[_0x152976(0x2ec)](_0x152976(0x38d));}else logger[_0x152976(0x2ec)](_0x152976(0x268));}),app[_0x1f5a02(0x2c1)](express[_0x1f5a02(0x362)](path[_0x1f5a02(0x35b)](__dirname,bbpath2,_0x1f5a02(0x2ed)))),app[_0x1f5a02(0x2c1)](express['static'](path[_0x1f5a02(0x35b)](__dirname,bbpath2,_0x1f5a02(0x245)))),app[_0x1f5a02(0x349)]('/',function(_0x5eb8e4,_0x296322){const _0x22632b=_0x1f5a02;_0x296322[_0x22632b(0x38b)](path[_0x22632b(0x35b)](__dirname,bbpath2,_0x22632b(0x2ed),_0x22632b(0x323)));}),app[_0x1f5a02(0x349)](_0x1f5a02(0x205),function(_0x104f6e,_0x3f2613){const _0x50cb13=_0x1f5a02;_0x3f2613[_0x50cb13(0x38b)](path['join'](__dirname,bbpath2,_0x50cb13(0x245),_0x50cb13(0x323)));}),app[_0x1f5a02(0x349)](_0x1f5a02(0x1cd),(_0x130a08,_0x79dc55)=>{const _0x5c7df5=_0x1f5a02;_0x79dc55[_0x5c7df5(0x38b)](path[_0x5c7df5(0x35b)](__dirname,bbpath2,'build',_0x5c7df5(0x323)));}),app['get']('/:bot/performance',(_0x2fb3f7,_0xf4d41f)=>{const _0x13ad12=_0x1f5a02;_0xf4d41f['sendFile'](path[_0x13ad12(0x35b)](__dirname,bbpath2,_0x13ad12(0x245),_0x13ad12(0x323)));}),app['get'](_0x1f5a02(0x2de),(_0xadb86d,_0x40d999)=>{const _0x8eb719=_0x1f5a02;_0x40d999[_0x8eb719(0x38b)](path[_0x8eb719(0x35b)](__dirname,bbpath2,'build','index.html'));}),app['get'](_0x1f5a02(0x21c),(_0x486512,_0x4bd8ab)=>{const _0x4b7e75=_0x1f5a02;_0x4bd8ab[_0x4b7e75(0x38b)](path['join'](__dirname,bbpath2,_0x4b7e75(0x245),_0x4b7e75(0x323)));}),app[_0x1f5a02(0x349)](_0x1f5a02(0x335),(_0x595192,_0x3d4a46)=>{const _0x54a08c=_0x1f5a02;_0x3d4a46[_0x54a08c(0x38b)](path[_0x54a08c(0x35b)](__dirname,bbpath2,_0x54a08c(0x245),'index.html'));}),app['get'](_0x1f5a02(0x2cc),(_0x11d46d,_0x537277)=>{const _0x1280cb=_0x1f5a02;_0x537277[_0x1280cb(0x38b)](path[_0x1280cb(0x35b)](__dirname,bbpath2,'build',_0x1280cb(0x323)));});if(HOST)http[_0x1f5a02(0x33d)](PORT,HOST);else http['listen'](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x43c62c=_0x1f5a02;let _0x7408e5=_0x43c62c(0x30b);const _0x3a38f0=networkInterfaces(),_0xb5e1b1={};for(const _0x1726b0 of Object['keys'](_0x3a38f0)){for(const _0x200f11 of _0x3a38f0[_0x1726b0]){if((_0x200f11['family']==_0x43c62c(0x1ba)||_0x200f11[_0x43c62c(0x35a)]==0x4)&&!_0x200f11[_0x43c62c(0x2e0)]){const _0x3bed39=ipaddr[_0x43c62c(0x2b1)](_0x200f11['address'])[_0x43c62c(0x1cb)]();_0x3bed39!='private'&&(!_0xb5e1b1[_0x1726b0]&&(_0xb5e1b1[_0x1726b0]=[]),_0xb5e1b1[_0x1726b0][_0x43c62c(0x38c)](_0x200f11[_0x43c62c(0x262)]),_0x7408e5=_0x200f11[_0x43c62c(0x262)]);}}}return{'serverip':_0x7408e5,'netinterfaces':_0xb5e1b1};}async function startServer(){const _0x26e148=_0x1f5a02,{serverip:_0xaa6c8e,netinterfaces:_0x42591b}=getServerIP();logger[_0x26e148(0x2b3)](''),logger[_0x26e148(0x2b3)](_0x26e148(0x202)),await logger['full'](_0x26e148(0x2f4)+serverversion+_0x26e148(0x2f2)+(environment==_0x26e148(0x346)?_0x26e148(0x282):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x26e148(0x327))+(_0x26e148(0x204)+_0xaa6c8e+':'+PORT+_0x26e148(0x2ba))),logger[_0x26e148(0x2b3)](_0x26e148(0x202));if(config[_0x26e148(0x1be)]!=0x0)for(const _0x3bd097 of config){if(_0x3bd097[_0x26e148(0x384)]==_0x26e148(0x347)||_0x3bd097[_0x26e148(0x384)]==_0x26e148(0x1f4))await logger[_0x26e148(0x2ec)](_0x26e148(0x318)+_0x3bd097[_0x26e148(0x2a5)]+_0x26e148(0x25d)+_0x3bd097[_0x26e148(0x26c)]),startBot([_0x3bd097[_0x26e148(0x2a5)],userID],{'cwd':bbpath},function(_0x546775){const _0x1a1d7e=_0x26e148;if(_0x546775)logger[_0x1a1d7e(0x2ec)](_0x546775);});else(_0x3bd097[_0x26e148(0x384)]==_0x26e148(0x302)||_0x3bd097[_0x26e148(0x384)]==_0x26e148(0x334))&&await logger['full'](_0x26e148(0x2fe)+_0x3bd097['botID']+_0x26e148(0x25d)+_0x3bd097[_0x26e148(0x26c)]);}else!newBot&&logger['simple']('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x26e148(0x2b3)](_0x26e148(0x202)),logger[_0x26e148(0x2b3)](''),await logger[_0x26e148(0x257)](_0x26e148(0x38f)+nodeversion),await logger[_0x26e148(0x257)](_0x26e148(0x35f),_0x42591b);}function startSocket(){const _0x5d207a=_0x1f5a02;io['on'](_0x5d207a(0x370),_0x10828c=>{const _0x277c12=_0x5d207a;let _0x1eaa2f,_0x1c86d5,_0x1f7f88,_0x50426d,_0x556f53;const _0x18499b=_0x10828c[_0x277c12(0x322)][_0x277c12(0x391)][_0x277c12(0x34c)];_0x1c86d5=_0x18499b[_0x277c12(0x1d7)](/bot[0-9]{3}/);if(_0x1c86d5)_0x1f7f88=_0x1c86d5[0x0][_0x277c12(0x1d7)](/[0-9]{3}/);if(_0x1f7f88)_0x1eaa2f=_0x1f7f88[0x0];else _0x1eaa2f=_0x277c12(0x2a6);const _0x5cba10=_0x10828c[_0x277c12(0x322)][_0x277c12(0x2e6)][_0x277c12(0x1dc)];if(!_0x5cba10)_0x10828c[_0x277c12(0x331)]('status',{'publicKey':secure['publicKey']});else{_0x50426d=timelyDecrypt(_0x5cba10,![]);if(!_0x50426d)_0x10828c['emit'](_0x277c12(0x384),{'publicKey':secure['publicKey']});else{_0x556f53=normalizeIP(_0x10828c['conn'][_0x277c12(0x30d)])['store'];if(!devices[_0x50426d])devices[_0x50426d]={'uuid':_0x50426d,'access':{'token':null}};devices[_0x50426d]['ip']=_0x556f53;const _0xd5456c=addClient(_0x10828c['id'],_0x50426d,_0x1eaa2f);setAccess(_0xd5456c),emitMessages(),_0x10828c['on'](_0x277c12(0x237),_0x2d3f2c=>{const _0x4d1ed3=_0x277c12,_0x419054=timelyDecrypt(_0x2d3f2c['password']);if(_0x419054){_0x2d3f2c={'username':_0x2d3f2c[_0x4d1ed3(0x1de)],'password':_0x419054},devices[_0x50426d][_0x4d1ed3(0x378)]=validateCredentials(_0x2d3f2c,_0x50426d);if(devices[_0x50426d][_0x4d1ed3(0x378)][_0x4d1ed3(0x311)]==![]&&devices[_0x50426d][_0x4d1ed3(0x378)][_0x4d1ed3(0x388)]==_0x4d1ed3(0x1eb))_0x10828c[_0x4d1ed3(0x331)](_0x4d1ed3(0x384),{'access':devices[_0x50426d][_0x4d1ed3(0x378)]}),loginAccess2FA(_0x50426d,_0x556f53);else{if(devices[_0x50426d]['access'][_0x4d1ed3(0x311)]==![]&&devices[_0x50426d][_0x4d1ed3(0x378)][_0x4d1ed3(0x388)]==_0x4d1ed3(0x394))_0x10828c[_0x4d1ed3(0x331)](_0x4d1ed3(0x384),{'access':devices[_0x50426d]['access']});else devices[_0x50426d][_0x4d1ed3(0x378)]['allow']&&devices[_0x50426d]['access']['reason']==_0x4d1ed3(0x337)&&(getClientsWithUuid(_0x50426d)[_0x4d1ed3(0x291)](_0x1d0515=>{setAccess(_0x1d0515);}),logger[_0x4d1ed3(0x257)](_0x4d1ed3(0x1f2)+_0x50426d[_0x4d1ed3(0x258)](-0x8)),setTokenRefresh(_0x50426d),setSessionTimeout(_0x4d1ed3(0x237),_0x50426d));}}else logger[_0x4d1ed3(0x2ec)](_0x4d1ed3(0x1fd));}),_0x10828c['on']('reset-password',()=>{resetPassword();}),_0x10828c['on'](_0x277c12(0x295),_0xd87af9=>{removeClient(_0x10828c['id']);}),_0x1eaa2f==_0x277c12(0x2a6)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5e8ae5){const _0x4e0f14=_0x1f5a02;if(_0x5e8ae5!='botmanager'&&config[_0x4e0f14(0x239)]!=''){if(pid[_0x5e8ae5])pid[_0x5e8ae5][_0x4e0f14(0x31a)]({'function':_0x4e0f14(0x28b),'args':null});}_0x5e8ae5!=_0x4e0f14(0x2a6)&&broadcastToBots(_0x4e0f14(0x2ac),JSON[_0x4e0f14(0x217)](config));}function reloadBotManager(){getClientsWithBotID('botmanager')['forEach'](_0x4b89eb=>{const _0x5af4c=_0x4978;getSocket(_0x4b89eb['id'])[_0x5af4c(0x331)](_0x5af4c(0x384),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x2ad75a){const _0x1a37b2=_0x1f5a02;return io[_0x1a37b2(0x1c6)]['sockets']['get'](_0x2ad75a);}function setAccess(_0x269d79){const _0x8fa711=_0x1f5a02,_0x297316=getSocket(_0x269d79['id']),_0x11caba=_0x269d79[_0x8fa711(0x1f7)],_0x2c3849=_0x269d79[_0x8fa711(0x398)];devices[_0x11caba][_0x8fa711(0x378)]=validateAccess(devices[_0x11caba][_0x8fa711(0x378)][_0x8fa711(0x24b)],_0x11caba),logger['debug'](_0x8fa711(0x22b)+devices[_0x11caba][_0x8fa711(0x378)]['reason']+_0x8fa711(0x1f5)+_0x269d79['id'][_0x8fa711(0x258)](-0x8)+_0x8fa711(0x2a7)+_0x11caba[_0x8fa711(0x258)](-0x8)),_0x297316[_0x8fa711(0x35b)](_0x11caba);if(devices[_0x11caba][_0x8fa711(0x378)][_0x8fa711(0x311)]){_0x297316[_0x8fa711(0x35b)](_0x2c3849);if(_0x2c3849=='botmanager')initializeSocketBotManager(_0x297316);else initializeSocketBot(_0x297316);initClient(_0x2c3849);}devices[_0x11caba]['access'][_0x8fa711(0x24b)]&&devices[_0x11caba]['access']['reason']=='temporary\x20token\x20generated'&&setSessionTimeout(_0x8fa711(0x299),_0x11caba),devices[_0x11caba]['access'][_0x8fa711(0x24b)]&&devices[_0x11caba][_0x8fa711(0x378)][_0x8fa711(0x388)]==_0x8fa711(0x301)&&setSessionTimeout(_0x8fa711(0x237),_0x11caba),_0x297316[_0x8fa711(0x331)](_0x8fa711(0x384),{'status':_0x269d79['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x11caba]['access'],'externalip':devices[_0x11caba]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x8fa711(0x1da)],'validInstallation':validInstallation}),devices[_0x11caba][_0x8fa711(0x378)][_0x8fa711(0x311)]==![]&&devices[_0x11caba][_0x8fa711(0x378)][_0x8fa711(0x388)]=='2FA\x20required'&&temporaryAccess2FA(_0x11caba,devices[_0x11caba]['ip']);}function setSessionTimeout(_0x550df1,_0x31bb6d){const _0x4cc409=_0x1f5a02;let _0x488701;if(_0x550df1=='login')_0x488701=loginExpiry*0x3c*0x3e8;else _0x488701=devices[_0x31bb6d][_0x4cc409(0x263)][_0x4cc409(0x36c)]*0x3c*0x3e8-(new Date()[_0x4cc409(0x1db)]()-devices[_0x31bb6d][_0x4cc409(0x263)]['timestamp']);if(devices[_0x31bb6d][_0x4cc409(0x345)])clearTimeout(devices[_0x31bb6d]['pidExpireLogin']);devices[_0x31bb6d][_0x4cc409(0x345)]=setTimeout(()=>{const _0x468ca4=_0x4cc409;if(devices[_0x31bb6d][_0x468ca4(0x238)])clearTimeout(devices[_0x31bb6d][_0x468ca4(0x238)]);removeSocketListeners(_0x31bb6d),addBlacklist(_0x31bb6d),devices[_0x31bb6d][_0x468ca4(0x263)]=null,devices[_0x31bb6d]['telegram2FaApproval']=null,devices[_0x31bb6d][_0x468ca4(0x378)]['token']=null,logger[_0x468ca4(0x257)](_0x468ca4(0x278)+_0x31bb6d['slice'](-0x8)),devices[_0x31bb6d][_0x468ca4(0x378)]=validateAccess(devices[_0x31bb6d][_0x468ca4(0x378)][_0x468ca4(0x24b)],_0x31bb6d),!(devices[_0x31bb6d][_0x468ca4(0x378)][_0x468ca4(0x311)]&&devices[_0x31bb6d][_0x468ca4(0x378)][_0x468ca4(0x388)]==_0x468ca4(0x356))&&(_0x550df1==_0x468ca4(0x237)?io['to'](_0x31bb6d)[_0x468ca4(0x331)](_0x468ca4(0x384),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x31bb6d)[_0x468ca4(0x331)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x31bb6d][_0x468ca4(0x378)][_0x468ca4(0x24b)]=null;},_0x488701);}function setTokenRefresh(_0x3d38a5){const _0x1fc143=_0x1f5a02;if(devices[_0x3d38a5]['pidRefreshToken'])clearTimeout(devices[_0x3d38a5][_0x1fc143(0x238)]);devices[_0x3d38a5][_0x1fc143(0x238)]=setTimeout(()=>{const _0x429ca5=_0x1fc143;getClientsWithUuid(_0x3d38a5)[_0x429ca5(0x1be)]!=0x0?(devices[_0x3d38a5]['access']=refreshToken(_0x3d38a5),io['to'](_0x3d38a5)[_0x429ca5(0x331)](_0x429ca5(0x384),{'status':_0x429ca5(0x29a),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3d38a5][_0x429ca5(0x378)],'externalip':devices[_0x3d38a5]['ip'],'publicKey':secure[_0x429ca5(0x25a)],'validInstallation':validInstallation}),setTokenRefresh(_0x3d38a5)):clearTimeout(devices[_0x3d38a5][_0x429ca5(0x238)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x272185){const _0x42088e=_0x1f5a02,_0x5c7246=getClient(_0x272185['id'])[_0x42088e(0x1f7)];_0x272185[_0x42088e(0x331)]('bots',config),_0x272185['emit'](_0x42088e(0x22d),cleanSettings()),_0x272185['on'](_0x42088e(0x228),_0xa9bab9=>{const _0x1cfd06=_0x42088e;if(validateAccess(_0xa9bab9,_0x5c7246)[_0x1cfd06(0x311)])addBot();else logger[_0x1cfd06(0x2ec)](_0x1cfd06(0x30c));}),_0x272185['on'](_0x42088e(0x29c),(_0x3bbbe9,_0x46afff)=>{const _0x37b2f0=_0x42088e;if(validateAccess(_0x46afff,_0x5c7246)[_0x37b2f0(0x311)])toggleBot(_0x3bbbe9[_0x37b2f0(0x2a5)],_0x3bbbe9[_0x37b2f0(0x384)],_0x3bbbe9[_0x37b2f0(0x244)]);else logger['full'](_0x37b2f0(0x1ee));}),_0x272185['on']('toggle-bot-mode',(_0x1ef33a,_0x211a01)=>{if(validateAccess(_0x211a01,_0x5c7246)['allow'])toggleBotMode(_0x1ef33a);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x272185['on'](_0x42088e(0x1c3),(_0x5831e9,_0x55b708)=>{const _0x32d972=_0x42088e;if(validateAccess(_0x55b708,_0x5c7246)[_0x32d972(0x311)])deleteBot(_0x5831e9);else logger[_0x32d972(0x2ec)](_0x32d972(0x342));}),_0x272185['on'](_0x42088e(0x381),(_0x308c4f,_0x5e551e)=>{const _0x205f94=_0x42088e;if(validateAccess(_0x5e551e,_0x5c7246)[_0x205f94(0x311)])storeSettings(_0x308c4f,!![]);else logger[_0x205f94(0x2ec)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x272185['on'](_0x42088e(0x2e3),_0x3c3204=>{const _0x3cee41=_0x42088e;if(validateAccess(_0x3c3204,_0x5c7246)[_0x3cee41(0x311)])updateBB('update');else logger[_0x3cee41(0x2ec)](_0x3cee41(0x383));}),_0x272185['on'](_0x42088e(0x22c),_0xed4fd9=>{const _0x609c4=_0x42088e;if(validateAccess(_0xed4fd9,_0x5c7246)[_0x609c4(0x311)])updateBB(_0x609c4(0x324));else logger[_0x609c4(0x2ec)](_0x609c4(0x20b));}),_0x272185['on'](_0x42088e(0x358),_0x3d2dc8=>{const _0x50c8fd=_0x42088e;if(validateAccess(_0x3d2dc8,_0x5c7246)[_0x50c8fd(0x311)]){const _0x2d4947=getClient(_0x272185['id']);if(_0x2d4947)getBackupFiles(_0x2d4947[_0x50c8fd(0x1f7)]);else logger[_0x50c8fd(0x2ec)](_0x50c8fd(0x21b));}else logger[_0x50c8fd(0x2ec)](_0x50c8fd(0x2dd));}),_0x272185['on'](_0x42088e(0x2f8),(_0x609aac,_0x3e9d47)=>{const _0x3e2135=_0x42088e;if(validateAccess(_0x3e9d47,_0x5c7246)[_0x3e2135(0x311)])restoreBackupFile(_0x609aac);else logger[_0x3e2135(0x2ec)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x272185['on'](_0x42088e(0x220),_0x38b646=>{const _0x52f63f=_0x42088e;if(validateAccess(_0x38b646,_0x5c7246)['allow'])getMessages();else logger[_0x52f63f(0x2ec)](_0x52f63f(0x32b));}),_0x272185['on'](_0x42088e(0x27e),(_0x5321fb,_0x4525c0)=>{const _0x109317=_0x42088e;if(validateAccess(_0x4525c0,_0x5c7246)[_0x109317(0x311)])confirmMessage(_0x5321fb);else logger['full'](_0x109317(0x25f));}),_0x272185['on']('logout',_0x2f49d6=>{const _0x52c43a=_0x42088e;if(validateAccess(_0x2f49d6,_0x5c7246)[_0x52c43a(0x311)]){if(devices[_0x5c7246][_0x52c43a(0x238)])clearTimeout(devices[_0x5c7246]['pidRefreshToken']);if(devices[_0x5c7246][_0x52c43a(0x345)])clearTimeout(devices[_0x5c7246][_0x52c43a(0x345)]);removeSocketListeners(getClient(_0x272185['id'])['uuid']),addBlacklist(_0x5c7246),devices[_0x5c7246][_0x52c43a(0x263)]=null,devices[_0x5c7246][_0x52c43a(0x2c2)]=null,devices[_0x5c7246][_0x52c43a(0x378)][_0x52c43a(0x24b)]=null,logger['debug'](_0x52c43a(0x390)+_0x5c7246[_0x52c43a(0x258)](-0x8)),io['to'](getClient(_0x272185['id'])['uuid'])[_0x52c43a(0x331)](_0x52c43a(0x384),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x52c43a(0x2ec)](_0x52c43a(0x296));});}function initializeSocketBot(_0x4cc593){const _0x2cc6ce=_0x1f5a02,_0x1c2c2d=getClient(_0x4cc593['id'])[_0x2cc6ce(0x398)],_0x1eb6c8=getClient(_0x4cc593['id'])[_0x2cc6ce(0x1f7)];_0x4cc593['on'](_0x2cc6ce(0x333),(_0x1f4c3d,_0x47a464)=>{const _0x1daaf6=_0x2cc6ce;if(validateAccess(_0x47a464,_0x1eb6c8)[_0x1daaf6(0x311)]){if(pid[_0x1c2c2d])pid[_0x1c2c2d][_0x1daaf6(0x31a)]({'function':_0x1daaf6(0x37d),'args':_0x1f4c3d});}else logger[_0x1daaf6(0x2ec)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x4cc593['on'](_0x2cc6ce(0x325),(_0x1a7937,_0x1acef3)=>{const _0x3628ff=_0x2cc6ce;if(validateAccess(_0x1acef3,_0x1eb6c8)['allow']){if(pid[_0x1c2c2d])pid[_0x1c2c2d][_0x3628ff(0x31a)]({'function':_0x3628ff(0x20a),'args':_0x1a7937});}else logger[_0x3628ff(0x2ec)](_0x3628ff(0x298));}),_0x4cc593['on'](_0x2cc6ce(0x1c1),(_0x5b25fe,_0x2c5658)=>{const _0x35aac9=_0x2cc6ce;if(validateAccess(_0x2c5658,_0x1eb6c8)[_0x35aac9(0x311)]){if(pid[_0x1c2c2d])pid[_0x1c2c2d]['send']({'function':_0x35aac9(0x373),'args':_0x5b25fe});}else logger[_0x35aac9(0x2ec)](_0x35aac9(0x312));}),_0x4cc593['on']('store-configuration',(_0x10126e,_0x3da626)=>{const _0x181069=_0x2cc6ce;if(validateAccess(_0x3da626,_0x1eb6c8)[_0x181069(0x311)]){if(pid[_0x1c2c2d])pid[_0x1c2c2d][_0x181069(0x31a)]({'function':_0x181069(0x1f9),'args':_0x10126e});}else logger[_0x181069(0x2ec)](_0x181069(0x2d5));}),_0x4cc593['on'](_0x2cc6ce(0x1e4),(_0x3a3549,_0x5c4c4c)=>{const _0x37b0a7=_0x2cc6ce;if(validateAccess(_0x5c4c4c,_0x1eb6c8)[_0x37b0a7(0x311)]){if(pid[_0x1c2c2d])pid[_0x1c2c2d][_0x37b0a7(0x31a)]({'function':_0x37b0a7(0x374),'args':_0x3a3549});}else logger[_0x37b0a7(0x2ec)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x4cc593['on'](_0x2cc6ce(0x30a),(_0x3e9e94,_0x31632b)=>{const _0xbd085d=_0x2cc6ce;if(validateAccess(_0x31632b,_0x1eb6c8)[_0xbd085d(0x311)]){if(pid[_0x1c2c2d])pid[_0x1c2c2d][_0xbd085d(0x31a)]({'function':'storeFiat','args':_0x3e9e94});}else logger['full'](_0xbd085d(0x240));}),_0x4cc593['on'](_0x2cc6ce(0x2d2),_0x66540c=>{const _0x5cde98=_0x2cc6ce;if(validateAccess(_0x66540c,_0x1eb6c8)['allow']){if(pid[_0x1c2c2d])pid[_0x1c2c2d][_0x5cde98(0x31a)]({'function':_0x5cde98(0x222),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x4cc593['on'](_0x2cc6ce(0x2d9),_0x1a37be=>{const _0x131aab=_0x2cc6ce;if(validateAccess(_0x1a37be,_0x1eb6c8)[_0x131aab(0x311)]){if(pid[_0x1c2c2d])pid[_0x1c2c2d][_0x131aab(0x31a)]({'function':_0x131aab(0x2ae),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x4cc593['on']('place-order',(_0x4c5d51,_0x2d9b6b)=>{const _0x1b2483=_0x2cc6ce;if(validateAccess(_0x2d9b6b,_0x1eb6c8)[_0x1b2483(0x311)]){if(pid[_0x1c2c2d])pid[_0x1c2c2d][_0x1b2483(0x31a)]({'function':_0x1b2483(0x21f),'args':_0x4c5d51});}else logger['full']('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x4cc593['on'](_0x2cc6ce(0x2af),_0x18e730=>{const _0x1914af=_0x2cc6ce;if(validateAccess(_0x18e730,_0x1eb6c8)[_0x1914af(0x311)]){if(pid[_0x1c2c2d])pid[_0x1c2c2d][_0x1914af(0x31a)]({'function':'cancelLoading','args':null});}else logger[_0x1914af(0x2ec)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x4cc593['on'](_0x2cc6ce(0x293),_0x5c106c=>{const _0x362a4c=_0x2cc6ce;if(validateAccess(_0x5c106c,_0x1eb6c8)[_0x362a4c(0x311)]){if(pid[_0x1c2c2d])pid[_0x1c2c2d][_0x362a4c(0x31a)]({'function':_0x362a4c(0x231),'args':null});}else logger[_0x362a4c(0x2ec)](_0x362a4c(0x35c));}),_0x4cc593['on'](_0x2cc6ce(0x2e3),_0x33bb87=>{const _0x3f94ef=_0x2cc6ce;if(validateAccess(_0x33bb87,_0x1eb6c8)['allow'])updateBB(_0x3f94ef(0x36e));else logger[_0x3f94ef(0x2ec)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x4cc593['on'](_0x2cc6ce(0x220),_0x4b8a4f=>{const _0xc8ac28=_0x2cc6ce;if(validateAccess(_0x4b8a4f,_0x1eb6c8)['allow'])getMessages();else logger[_0xc8ac28(0x2ec)](_0xc8ac28(0x32b));}),_0x4cc593['on'](_0x2cc6ce(0x27e),(_0x435815,_0x27f04c)=>{const _0x287009=_0x2cc6ce;if(validateAccess(_0x27f04c,_0x1eb6c8)[_0x287009(0x311)])confirmMessage(_0x435815);else logger[_0x287009(0x2ec)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x4cc593['on']('logout',_0x2aa07f=>{const _0x4a97e9=_0x2cc6ce;if(validateAccess(_0x2aa07f,_0x1eb6c8)[_0x4a97e9(0x311)]){if(devices[_0x1eb6c8][_0x4a97e9(0x238)])clearTimeout(devices[_0x1eb6c8][_0x4a97e9(0x238)]);if(devices[_0x1eb6c8][_0x4a97e9(0x345)])clearTimeout(devices[_0x1eb6c8][_0x4a97e9(0x345)]);removeSocketListeners(getClient(_0x4cc593['id'])['uuid']),addBlacklist(_0x1eb6c8),devices[_0x1eb6c8][_0x4a97e9(0x263)]=null,devices[_0x1eb6c8][_0x4a97e9(0x2c2)]=null,devices[_0x1eb6c8]['access'][_0x4a97e9(0x24b)]=null,logger[_0x4a97e9(0x257)](_0x4a97e9(0x390)+_0x1eb6c8['slice'](-0x8)),io['to'](getClient(_0x4cc593['id'])['uuid'])[_0x4a97e9(0x331)]('status',{'access':{'allow':![],'reason':_0x4a97e9(0x2ca),'token':null}});}else logger[_0x4a97e9(0x2ec)](_0x4a97e9(0x296));});}function removeSocketListeners(_0x2e6bc0){const _0xb6859b=_0x1f5a02;getClientsWithUuid(_0x2e6bc0)[_0xb6859b(0x291)](_0x5a24fe=>{const _0x3b43b1=_0xb6859b;getSocket(_0x5a24fe['id'])[_0x3b43b1(0x395)]();});}function cleanSettings(){const _0x5f299c=_0x1f5a02;let _0x386855=settings;return settings[_0x5f299c(0x246)]&&settings['telegramToken']!=''&&(_0x386855={..._0x386855,'telegramToken':'************'}),settings['bbPassword']&&settings[_0x5f299c(0x351)]!=''&&(_0x386855={..._0x386855,'bbPassword':_0x5f299c(0x38e)}),(settings[_0x5f299c(0x351)]&&settings['bbPassword']==_0x5f299c(0x364)||settings['telegramToken']&&settings[_0x5f299c(0x246)]==_0x5f299c(0x364))&&(_0x386855={..._0x386855,'restored':{'password':settings[_0x5f299c(0x351)]==_0x5f299c(0x364),'telegram':settings[_0x5f299c(0x246)]==_0x5f299c(0x364)}}),_0x386855;}async function updateBB(_0x126484){const _0x778cd6=_0x1f5a02;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x4b302e=>{const _0x211f65=_0x4978;restartBot(_0x4b302e[_0x211f65(0x2a5)]);});if(_0x126484=='update')process[_0x778cd6(0x31a)]({'update':!![],'environment':environment},_0x5b4c5b=>{});else _0x126484=='reinstall'&&process[_0x778cd6(0x31a)]({'reinstall':!![],'environment':environment},_0x1a58d3=>{});}function startBot(_0x3771b4,_0x22ce95,_0x48bd9a){const _0x1ab6dd=_0x1f5a02;if(debugging)_0x3771b4[_0x1ab6dd(0x38c)]('-d');let _0x455381=![];const _0x4038d0=_0x3771b4[0x0];_0x22ce95={..._0x22ce95,'stdio':['inherit','inherit',_0x1ab6dd(0x389),_0x1ab6dd(0x2e5)]},pid[_0x4038d0]=childProcess[_0x1ab6dd(0x233)](botfile,_0x3771b4,_0x22ce95),pid[_0x4038d0]['on']('message',_0x23a77b=>{const _0x1d0322=_0x1ab6dd;switch(Object['keys'](_0x23a77b)[0x0]){case'botname':updateBotName(_0x4038d0,_0x23a77b['botname']);break;case'updatebotmanager':updateBotManager();break;case _0x1d0322(0x384):updateStatus(_0x4038d0,_0x23a77b[_0x1d0322(0x384)]);break;case _0x1d0322(0x244):updateLive(_0x4038d0,_0x23a77b[_0x1d0322(0x244)]);break;case _0x1d0322(0x2d4):updateLive(_0x4038d0,_0x23a77b['started']),io['to'](_0x4038d0)[_0x1d0322(0x331)](_0x1d0322(0x384),{'access':{'allow':![],'reason':_0x1d0322(0x319),'token':null}});break;case _0x1d0322(0x2ad):_0x23a77b['stop']=='restart'&&restartBot(_0x4038d0);_0x23a77b[_0x1d0322(0x2ad)]==_0x1d0322(0x2b9)&&toggleBot(_0x4038d0,_0x1d0322(0x302),_0x1d0322(0x241));break;case'telegram':sendTelegram(_0x4038d0,_0x23a77b[_0x1d0322(0x24e)]);break;case _0x1d0322(0x23f):sendTelegramMsg(_0x23a77b['telegrammsg']);break;case _0x1d0322(0x352):io['to'](_0x4038d0)['emit'](_0x23a77b[_0x1d0322(0x352)],_0x23a77b[_0x1d0322(0x290)]);break;}}),pid[_0x4038d0]['on']('error',function(_0x39d406){if(_0x455381)return;_0x455381=!![],_0x48bd9a(_0x39d406);}),pid[_0x4038d0]['on'](_0x1ab6dd(0x1d1),async function(_0x2e5fc3){const _0x3b95e3=_0x1ab6dd;if(installingUpdate)return;if(_0x455381)return;_0x455381=!![],_0x48bd9a(null);const _0x501adc=dbConfig[_0x3b95e3(0x349)](_0x3b95e3(0x2ac))[_0x3b95e3(0x25c)]({'botID':_0x4038d0})[_0x3b95e3(0x223)]();_0x501adc&&(_0x501adc[_0x3b95e3(0x384)]==_0x3b95e3(0x347)||_0x501adc[_0x3b95e3(0x384)]==_0x3b95e3(0x1f4))&&(await sleep(0x3e8),updateLive(_0x4038d0,_0x3b95e3(0x241)),logger['full'](_0x3b95e3(0x23c)+_0x4038d0),startBot([_0x4038d0,userID],{'cwd':bbpath},function(_0x5ea493){const _0x318e42=_0x3b95e3;if(_0x5ea493)logger[_0x318e42(0x2ec)](_0x5ea493);}));});}function stopBot(_0x3f5fdd){const _0x3f632b=_0x1f5a02;getClientsWithBotID(_0x3f5fdd)[_0x3f632b(0x291)](_0x5786fc=>{getSocket(_0x5786fc['id'])['disconnect'](!![]),removeClient(_0x5786fc['id']);}),pid[_0x3f5fdd]&&(pid[_0x3f5fdd]['kill'](),pid[_0x3f5fdd]=null);}function restartBot(_0x241dd6){const _0x487232=_0x1f5a02;if(pid[_0x241dd6])pid[_0x241dd6][_0x487232(0x2b9)]();}function addBot(){const _0x117efa=_0x1f5a02;let _0x8e4cef;for(let _0x35f6e2=0x1;_0x35f6e2<0x3e9;_0x35f6e2++){_0x8e4cef=_0x35f6e2[_0x117efa(0x20c)]()[_0x117efa(0x332)](0x3,'0');let _0x3b9d32=config[_0x117efa(0x25c)](_0x2bf021=>_0x2bf021[_0x117efa(0x2a5)]==_0x8e4cef);if(!_0x3b9d32)break;}if(_0x8e4cef===_0x117efa(0x212)){logger[_0x117efa(0x2ec)](_0x117efa(0x215));return;}logger[_0x117efa(0x2ec)](_0x117efa(0x306)+_0x8e4cef),dbConfig[_0x117efa(0x349)]('bots')[_0x117efa(0x38c)]({'botID':_0x8e4cef,'botname':_0x117efa(0x207)+_0x8e4cef,'status':'new','live':''})[_0x117efa(0x1bc)](),startBot([_0x8e4cef,userID],{'cwd':bbpath},function(_0x364018){const _0xd39c70=_0x117efa;if(_0x364018)logger[_0xd39c70(0x2ec)](_0x364018);}),config=getConfiguration(),io['to'](_0x117efa(0x2a6))[_0x117efa(0x331)](_0x117efa(0x2ac),config),broadcastToBots('bots',JSON['stringify'](config));}function deleteBot(_0xb3ce64){const _0x378bf2=_0x1f5a02;getClientsWithBotID(_0xb3ce64)[_0x378bf2(0x291)](_0x30572b=>{const _0x3d8d22=_0x378bf2;getSocket(_0x30572b['id'])[_0x3d8d22(0x295)](!![]),removeClient(_0x30572b['id']);}),dbConfig[_0x378bf2(0x349)](_0x378bf2(0x2ac))[_0x378bf2(0x36b)]({'botID':_0xb3ce64})[_0x378bf2(0x1bc)](),logger['full']('Deleted\x20Bot\x20'+_0xb3ce64),stopBot(_0xb3ce64);try{if(fs[_0x378bf2(0x33f)](path[_0x378bf2(0x35b)](configpath,_0x378bf2(0x26b)+_0xb3ce64+_0x378bf2(0x336))))fs[_0x378bf2(0x1d4)](path[_0x378bf2(0x35b)](configpath,_0x378bf2(0x26b)+_0xb3ce64+'-config.json'));if(fs[_0x378bf2(0x33f)](path[_0x378bf2(0x35b)](configpath,_0x378bf2(0x26b)+_0xb3ce64+_0x378bf2(0x2c7))))fs[_0x378bf2(0x1d4)](path[_0x378bf2(0x35b)](configpath,_0x378bf2(0x26b)+_0xb3ce64+_0x378bf2(0x2c7)));if(fs[_0x378bf2(0x33f)](path[_0x378bf2(0x35b)](configpath,'bot-'+_0xb3ce64+_0x378bf2(0x20d))))fs[_0x378bf2(0x1d4)](path[_0x378bf2(0x35b)](configpath,'bot-'+_0xb3ce64+_0x378bf2(0x20d)));if(fs['existsSync'](path[_0x378bf2(0x35b)](configpath,'bot-'+_0xb3ce64+'-results.json')))fs[_0x378bf2(0x1d4)](path['join'](configpath,_0x378bf2(0x26b)+_0xb3ce64+'-results.json'));}catch(_0x51e841){if(_0x51e841)logger[_0x378bf2(0x2ec)](_0x378bf2(0x368),_0x51e841);}config=getConfiguration(),io['to']('botmanager')[_0x378bf2(0x331)](_0x378bf2(0x2ac),config),broadcastToBots(_0x378bf2(0x2ac),JSON[_0x378bf2(0x217)](config));}function toggleBot(_0x86aeb0,_0x4c1cbb,_0x4b5b18){const _0x4fac0c=_0x1f5a02;dbConfig[_0x4fac0c(0x349)](_0x4fac0c(0x2ac))[_0x4fac0c(0x25c)]({'botID':_0x86aeb0})[_0x4fac0c(0x26a)]({'status':_0x4c1cbb})[_0x4fac0c(0x26a)]({'live':_0x4b5b18})[_0x4fac0c(0x1bc)]();if(_0x4c1cbb=='enabled'||_0x4c1cbb==_0x4fac0c(0x1f4))logger['full']('Enabled\x20Bot\x20'+_0x86aeb0),startBot([_0x86aeb0,userID],{'cwd':bbpath},function(_0x94bf4a){const _0x42132b=_0x4fac0c;if(_0x94bf4a)logger[_0x42132b(0x2ec)](_0x94bf4a);});else(_0x4c1cbb=='disabled'||_0x4c1cbb==_0x4fac0c(0x334))&&(logger[_0x4fac0c(0x2ec)](_0x4fac0c(0x213)+_0x86aeb0),stopBot(_0x86aeb0));config=getConfiguration(),io['to'](_0x4fac0c(0x2a6))[_0x4fac0c(0x331)]('bots',config),broadcastToBots(_0x4fac0c(0x2ac),JSON[_0x4fac0c(0x217)](config));}function toggleStatus(_0x55e0c1){const _0x58f23c=_0x1f5a02;let _0x228fee=dbConfig[_0x58f23c(0x349)]('bots')[_0x58f23c(0x25c)]({'botID':_0x55e0c1})[_0x58f23c(0x223)](),_0x53cde1;if(_0x228fee['status']===_0x58f23c(0x347))_0x53cde1=_0x58f23c(0x302);else{if(_0x228fee[_0x58f23c(0x384)]===_0x58f23c(0x1f4))_0x53cde1='new-disabled';else{if(_0x228fee[_0x58f23c(0x384)]==='new-disabled')_0x53cde1='new';else{if(_0x228fee[_0x58f23c(0x384)]===_0x58f23c(0x302))_0x53cde1='enabled';}}}return _0x53cde1;}function updateStatus(_0x39496d,_0x2ec9d4){const _0x19034c=_0x1f5a02;dbConfig[_0x19034c(0x349)](_0x19034c(0x2ac))[_0x19034c(0x25c)]({'botID':_0x39496d})[_0x19034c(0x26a)]({'status':_0x2ec9d4})[_0x19034c(0x1bc)](),config=getConfiguration(),io['to'](_0x19034c(0x2a6))[_0x19034c(0x331)](_0x19034c(0x2ac),config),broadcastToBots(_0x19034c(0x2ac),JSON['stringify'](config));}function updateLive(_0x1ab7ad,_0x3f670d){const _0x2079a4=_0x1f5a02;dbConfig['get'](_0x2079a4(0x2ac))['find']({'botID':_0x1ab7ad})[_0x2079a4(0x26a)]({'live':_0x3f670d})[_0x2079a4(0x1bc)](),config=getConfiguration(),io['to']('botmanager')[_0x2079a4(0x331)]('bots',config),broadcastToBots(_0x2079a4(0x2ac),JSON[_0x2079a4(0x217)](config));}function updateBotName(_0x1d507e,_0x2b8c0e){const _0x51edd4=_0x1f5a02;dbConfig[_0x51edd4(0x349)]('bots')['find']({'botID':_0x1d507e})[_0x51edd4(0x26a)]({'botname':_0x2b8c0e})[_0x51edd4(0x1bc)](),config=getConfiguration(),io['to']('botmanager')[_0x51edd4(0x331)](_0x51edd4(0x2ac),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0x25210d=_0x1f5a02;config=getConfiguration(),io['to'](_0x25210d(0x2a6))[_0x25210d(0x331)](_0x25210d(0x2ac),config),broadcastToBots(_0x25210d(0x2ac),JSON[_0x25210d(0x217)](config));}function toggleBotMode(_0x293e96){const _0x5b5302=_0x1f5a02;if(pid[_0x293e96])pid[_0x293e96][_0x5b5302(0x31a)]({'function':_0x5b5302(0x23d),'args':null});else{const _0x19701c=configpath+_0x5b5302(0x26b)+_0x293e96+_0x5b5302(0x336),_0x49c16d=fs[_0x5b5302(0x294)](_0x19701c),_0x4e6643=JSON['parse'](_0x49c16d),_0x24ccc5=_0x4e6643[_0x5b5302(0x398)][0x0][_0x5b5302(0x371)];_0x4e6643[_0x5b5302(0x398)][0x0][_0x5b5302(0x371)]=!_0x24ccc5;const _0x3009d7=JSON[_0x5b5302(0x217)](_0x4e6643,null,0x2);fs[_0x5b5302(0x308)](_0x19701c,_0x3009d7),config=getConfiguration(),io['to'](_0x5b5302(0x2a6))[_0x5b5302(0x331)](_0x5b5302(0x2ac),config),broadcastToBots('bots',JSON[_0x5b5302(0x217)](config));}}function telegramError(_0x688637){logger['simple'](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x530675){const _0x18a268=_0x1f5a02;if(_0x530675[_0x18a268(0x285)][_0x18a268(0x1de)]!=settings[_0x18a268(0x23e)]&&'@'+_0x530675[_0x18a268(0x285)]['username']!=settings[_0x18a268(0x23e)])return tgBot[_0x18a268(0x329)](_0x530675[_0x18a268(0x225)]['id'],_0x18a268(0x2b5),{'parse_mode':_0x18a268(0x209)})[_0x18a268(0x261)](_0x184290=>{telegramError(_0x184290);}),![];return!![];}async function initTelegram(){const _0xfcd270=_0x1f5a02;if(tgBot)tgBot[_0xfcd270(0x269)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x52f0bb=_0xfcd270(0x25b);_0x52f0bb+='\x0a',_0x52f0bb+=_0xfcd270(0x360),_0x52f0bb+=_0xfcd270(0x377),_0x52f0bb+=_0xfcd270(0x1d3),_0x52f0bb+=_0xfcd270(0x22a),_0x52f0bb+=_0xfcd270(0x2a0),_0x52f0bb+=_0xfcd270(0x27f),_0x52f0bb+=_0xfcd270(0x227),_0x52f0bb+=_0xfcd270(0x314),_0x52f0bb+=_0xfcd270(0x1e6),_0x52f0bb+=_0xfcd270(0x2bd),_0x52f0bb+=_0xfcd270(0x280),_0x52f0bb+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x52f0bb+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x52f0bb+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x1f2b60=_0xfcd270(0x266);_0x1f2b60+='\x0a',_0x1f2b60+=_0x52f0bb,tgBot[_0xfcd270(0x32f)](/\/start/,_0x28fc7a=>{const _0x133664=_0xfcd270;if(!validateTelegram(_0x28fc7a))return;if(settings[_0x133664(0x1bb)]!=_0x28fc7a[_0x133664(0x225)]['id'])updateSetting(_0x133664(0x1bb),_0x28fc7a[_0x133664(0x225)]['id']);updateSetting(_0x133664(0x267),!![]),tgBot['sendMessage'](_0x28fc7a[_0x133664(0x225)]['id'],_0x1f2b60)[_0x133664(0x261)](_0x22f5de=>{telegramError(_0x22f5de);});}),tgBot[_0xfcd270(0x32f)](/\/enable/,_0x234fd0=>{const _0x4b1927=_0xfcd270;if(!validateTelegram(_0x234fd0))return;if(settings[_0x4b1927(0x1bb)]!=_0x234fd0[_0x4b1927(0x225)]['id'])updateSetting('telegramChatId',_0x234fd0['chat']['id']);updateSetting(_0x4b1927(0x267),!![]),tgBot[_0x4b1927(0x329)](_0x234fd0['chat']['id'],_0x4b1927(0x236))[_0x4b1927(0x261)](_0x3467c1=>{telegramError(_0x3467c1);});}),tgBot[_0xfcd270(0x32f)](/\/config/,async _0x55b694=>{const _0x12ed60=_0xfcd270;if(!validateTelegram(_0x55b694))return;tgBot['removeListener'](_0x12ed60(0x2a2)),tgBot[_0x12ed60(0x329)](_0x55b694[_0x12ed60(0x225)]['id'],_0x12ed60(0x27a),{'reply_markup':{'inline_keyboard':[[{'text':_0x12ed60(0x379),'callback_data':_0x12ed60(0x315)},{'text':_0x12ed60(0x2ee),'callback_data':_0x12ed60(0x1df)},{'text':_0x12ed60(0x1c0),'callback_data':_0x12ed60(0x1ce)}]]}})[_0x12ed60(0x261)](_0x2628d4=>{telegramError(_0x2628d4);}),tgBot['on']('callback_query',async _0x17ea98=>{const _0x50da07=_0x12ed60,_0x4ac018=_0x17ea98[_0x50da07(0x31e)],_0x4f1cf4=_0x17ea98['message'];tgBot[_0x50da07(0x287)](_0x17ea98['id'])[_0x50da07(0x31f)](async()=>{const _0x593b29=_0x50da07;_0x4ac018=='orders'&&(updateSetting(_0x593b29(0x216),'orders'),updateSetting('telegramEnabled',!![]),await tgBot[_0x593b29(0x329)](_0x4f1cf4['chat']['id'],_0x593b29(0x369))[_0x593b29(0x261)](_0x5f158b=>{telegramError(_0x5f158b);}));_0x4ac018==_0x593b29(0x1df)&&(updateSetting(_0x593b29(0x216),_0x593b29(0x1df)),updateSetting('telegramEnabled',!![]),await tgBot[_0x593b29(0x329)](_0x4f1cf4['chat']['id'],_0x593b29(0x281))[_0x593b29(0x261)](_0x554f54=>{telegramError(_0x554f54);}));_0x4ac018=='all'&&(updateSetting(_0x593b29(0x216),_0x593b29(0x1ce)),updateSetting(_0x593b29(0x267),!![]),await tgBot['sendMessage'](_0x4f1cf4['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')['catch'](_0x3f0832=>{telegramError(_0x3f0832);}));if(!settings['telegramChatId'])tgBot['sendMessage'](_0x4f1cf4[_0x593b29(0x225)]['id'],_0x593b29(0x200))[_0x593b29(0x261)](_0x7a184b=>{telegramError(_0x7a184b);});}),tgBot[_0x50da07(0x297)](_0x50da07(0x2a2));});}),tgBot['onText'](/\/status/,_0x59cf0f=>{const _0x37c1e4=_0xfcd270;if(!validateTelegram(_0x59cf0f))return;const _0x318684=getBotsWithMode();let _0x177912=_0x37c1e4(0x2c4);config[_0x37c1e4(0x291)](_0x4106b0=>{const _0x1eb11e=_0x37c1e4,_0x36eaf3=_0x318684['find'](_0x2318fa=>_0x2318fa[_0x1eb11e(0x2a5)]==_0x4106b0['botID'])['mode'];_0x177912+=_0x1eb11e(0x207)+_0x4106b0['botID']+':\x20'+_0x4106b0[_0x1eb11e(0x384)]+_0x1eb11e(0x25d)+_0x36eaf3+'\x20|\x20'+_0x4106b0[_0x1eb11e(0x244)]+'\x0a';}),_0x177912+='\x0a',_0x177912+=_0x37c1e4(0x2d8),_0x177912+=!settings[_0x37c1e4(0x267)]?_0x37c1e4(0x2b6):_0x37c1e4(0x2be),_0x177912+=settings[_0x37c1e4(0x267)]?settings[_0x37c1e4(0x216)]==_0x37c1e4(0x1ce)?_0x37c1e4(0x2fc):_0x37c1e4(0x2c9)+settings['telegramEvents']+_0x37c1e4(0x2b0):'',tgBot[_0x37c1e4(0x329)](_0x59cf0f['chat']['id'],_0x177912,{'parse_mode':_0x37c1e4(0x209)})[_0x37c1e4(0x261)](_0x1bb505=>{telegramError(_0x1bb505);});}),tgBot[_0xfcd270(0x32f)](/\/restart/,_0x22d6a5=>{const _0x451800=_0xfcd270;if(!validateTelegram(_0x22d6a5))return;tgBot[_0x451800(0x297)](_0x451800(0x2a2));const _0x4b7ffd=getEnabledBots();if(_0x4b7ffd['length']==0x0)tgBot[_0x451800(0x329)](_0x22d6a5[_0x451800(0x225)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x451800(0x261)](_0x47881a=>{telegramError(_0x47881a);});else{if(_0x4b7ffd[_0x451800(0x1be)]>0x1)_0x4b7ffd['push']({'botID':'all'});let _0x38b989=[],_0x1c0d20=[];const _0x1a8df6=_0x4b7ffd['length']%0x4==0x0||_0x4b7ffd[_0x451800(0x1be)]%0x4==0x3||_0x4b7ffd['length']%0x3==0x1?0x4:0x3;let _0x4a4fb8=0x0;_0x4b7ffd[_0x451800(0x291)]((_0x3d85c3,_0x4407d1)=>{const _0x37ea48=_0x451800;if(_0x4407d1%_0x1a8df6==0x0)_0x1c0d20=[];_0x1c0d20[_0x37ea48(0x38c)]({'text':_0x3d85c3[_0x37ea48(0x2a5)]==_0x37ea48(0x1ce)?'All\x20bots':_0x37ea48(0x207)+_0x3d85c3['botID'],'callback_data':_0x3d85c3['botID']}),_0x4407d1%_0x1a8df6==0x0&&(_0x38b989[_0x4a4fb8]=_0x1c0d20,_0x4a4fb8++);}),tgBot[_0x451800(0x329)](_0x22d6a5[_0x451800(0x225)]['id'],_0x451800(0x1cc),{'reply_markup':{'inline_keyboard':_0x38b989}})['catch'](_0x2cbc92=>{telegramError(_0x2cbc92);}),tgBot['on']('callback_query',async _0x300f2e=>{const _0x23b89f=_0x451800,_0x4d1d5e=_0x300f2e[_0x23b89f(0x31e)],_0x5f028a=_0x300f2e[_0x23b89f(0x339)];tgBot[_0x23b89f(0x287)](_0x300f2e['id'])[_0x23b89f(0x31f)](async()=>{const _0x4c8616=_0x23b89f;_0x4d1d5e==_0x4c8616(0x1ce)?config[_0x4c8616(0x291)](_0xe8a65c=>{const _0x2a98a3=_0x4c8616;restartBot(_0xe8a65c[_0x2a98a3(0x2a5)]);}):restartBot(_0x4d1d5e);}),tgBot['removeListener'](_0x23b89f(0x2a2));});}}),tgBot[_0xfcd270(0x32f)](/\/on/,_0xd969d=>{const _0x2da5d9=_0xfcd270;if(!validateTelegram(_0xd969d))return;tgBot[_0x2da5d9(0x297)](_0x2da5d9(0x2a2));const _0x1c55fe=getDisabledBots();if(_0x1c55fe['length']==0x0)tgBot[_0x2da5d9(0x329)](_0xd969d['chat']['id'],_0x2da5d9(0x1e7))[_0x2da5d9(0x261)](_0x14c2d4=>{telegramError(_0x14c2d4);});else{if(_0x1c55fe['length']>0x1)_0x1c55fe['push']({'botID':_0x2da5d9(0x1ce)});let _0x2abbfc=[],_0x17061d=[];const _0x1318ac=_0x1c55fe[_0x2da5d9(0x1be)]%0x4==0x0||_0x1c55fe[_0x2da5d9(0x1be)]%0x4==0x3||_0x1c55fe[_0x2da5d9(0x1be)]%0x3==0x1?0x4:0x3;let _0x100d06=0x0;_0x1c55fe[_0x2da5d9(0x291)]((_0x573412,_0x248908)=>{const _0x1f1d8e=_0x2da5d9;if(_0x248908%_0x1318ac==0x0)_0x17061d=[];_0x17061d[_0x1f1d8e(0x38c)]({'text':_0x573412['botID']==_0x1f1d8e(0x1ce)?'All\x20bots':_0x1f1d8e(0x207)+_0x573412[_0x1f1d8e(0x2a5)],'callback_data':_0x573412[_0x1f1d8e(0x2a5)]}),_0x248908%_0x1318ac==0x0&&(_0x2abbfc[_0x100d06]=_0x17061d,_0x100d06++);}),tgBot[_0x2da5d9(0x329)](_0xd969d['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x2abbfc}})['catch'](_0x2ec795=>{telegramError(_0x2ec795);}),tgBot['on'](_0x2da5d9(0x2a2),async _0x1dec34=>{const _0x57cc63=_0x2da5d9,_0x17db3f=_0x1dec34[_0x57cc63(0x31e)],_0x59d7e5=_0x1dec34[_0x57cc63(0x339)];tgBot['answerCallbackQuery'](_0x1dec34['id'])[_0x57cc63(0x31f)](async()=>{const _0x228f0c=_0x57cc63;_0x17db3f==_0x228f0c(0x1ce)?(tgBot[_0x228f0c(0x329)](_0x59d7e5[_0x228f0c(0x225)]['id'],_0x228f0c(0x2d1))[_0x228f0c(0x261)](_0x536ff9=>{telegramError(_0x536ff9);}),_0x1c55fe[_0x228f0c(0x291)](_0x1a350d=>{const _0x2b9adc=_0x228f0c;if(_0x1a350d[_0x2b9adc(0x2a5)]!=_0x2b9adc(0x1ce))toggleBot(_0x1a350d[_0x2b9adc(0x2a5)],toggleStatus(_0x1a350d[_0x2b9adc(0x2a5)]),'stopped');})):(tgBot['sendMessage'](_0x59d7e5['chat']['id'],_0x228f0c(0x1c7)+_0x17db3f)['catch'](_0x460ab3=>{telegramError(_0x460ab3);}),toggleBot(_0x17db3f,toggleStatus(_0x17db3f),_0x228f0c(0x241)));}),tgBot['removeListener'](_0x57cc63(0x2a2));});}}),tgBot[_0xfcd270(0x32f)](/\/off/,_0x2ea5da=>{const _0x1ed873=_0xfcd270;if(!validateTelegram(_0x2ea5da))return;tgBot[_0x1ed873(0x297)](_0x1ed873(0x2a2));const _0x1dfb6f=getEnabledBots();if(_0x1dfb6f[_0x1ed873(0x1be)]==0x0)tgBot[_0x1ed873(0x329)](_0x2ea5da[_0x1ed873(0x225)]['id'],_0x1ed873(0x2b2))[_0x1ed873(0x261)](_0xf680c2=>{telegramError(_0xf680c2);});else{if(_0x1dfb6f[_0x1ed873(0x1be)]>0x1)_0x1dfb6f[_0x1ed873(0x38c)]({'botID':'all'});let _0x1c462f=[],_0x14e00d=[];const _0x4d309f=_0x1dfb6f[_0x1ed873(0x1be)]%0x4==0x0||_0x1dfb6f['length']%0x4==0x3||_0x1dfb6f['length']%0x3==0x1?0x4:0x3;let _0x47db30=0x0;_0x1dfb6f[_0x1ed873(0x291)]((_0x3d5a22,_0x497f75)=>{const _0xeecb68=_0x1ed873;if(_0x497f75%_0x4d309f==0x0)_0x14e00d=[];_0x14e00d[_0xeecb68(0x38c)]({'text':_0x3d5a22['botID']==_0xeecb68(0x1ce)?_0xeecb68(0x396):_0xeecb68(0x207)+_0x3d5a22[_0xeecb68(0x2a5)],'callback_data':_0x3d5a22[_0xeecb68(0x2a5)]}),_0x497f75%_0x4d309f==0x0&&(_0x1c462f[_0x47db30]=_0x14e00d,_0x47db30++);}),tgBot[_0x1ed873(0x329)](_0x2ea5da[_0x1ed873(0x225)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x1c462f}})[_0x1ed873(0x261)](_0xcadac=>{telegramError(_0xcadac);}),tgBot['on'](_0x1ed873(0x2a2),async _0x1d6bf3=>{const _0x22d9be=_0x1ed873,_0x221e05=_0x1d6bf3['data'],_0x507c44=_0x1d6bf3['message'];tgBot[_0x22d9be(0x287)](_0x1d6bf3['id'])[_0x22d9be(0x31f)](async()=>{const _0x5abbce=_0x22d9be;_0x221e05==_0x5abbce(0x1ce)?(tgBot[_0x5abbce(0x329)](_0x507c44['chat']['id'],_0x5abbce(0x303))[_0x5abbce(0x261)](_0x29eeb7=>{telegramError(_0x29eeb7);}),_0x1dfb6f['forEach'](_0x2a4ee3=>{const _0x4302db=_0x5abbce;if(_0x2a4ee3[_0x4302db(0x2a5)]!='all')toggleBot(_0x2a4ee3[_0x4302db(0x2a5)],toggleStatus(_0x2a4ee3['botID']),'stopped');})):(tgBot['sendMessage'](_0x507c44[_0x5abbce(0x225)]['id'],_0x5abbce(0x275)+_0x221e05)[_0x5abbce(0x261)](_0x18cf6c=>{telegramError(_0x18cf6c);}),toggleBot(_0x221e05,toggleStatus(_0x221e05),_0x5abbce(0x241)));}),tgBot[_0x22d9be(0x297)](_0x22d9be(0x2a2));});}}),tgBot['onText'](/\/metrics/,_0x309b47=>{const _0x34be6b=_0xfcd270;if(!validateTelegram(_0x309b47))return;tgBot[_0x34be6b(0x297)]('callback_query');const _0x308ddf=getEnabledBots();if(_0x308ddf['length']==0x0)tgBot[_0x34be6b(0x329)](_0x309b47[_0x34be6b(0x225)]['id'],_0x34be6b(0x2b2))[_0x34be6b(0x261)](_0x3a2853=>{telegramError(_0x3a2853);});else{if(_0x308ddf['length']>0x1){let _0x1acbab=[],_0x415652=[];const _0x45b46f=_0x308ddf['length']%0x4==0x0||_0x308ddf['length']%0x4==0x3||_0x308ddf[_0x34be6b(0x1be)]%0x3==0x1?0x4:0x3;let _0x39c60c=0x0;_0x308ddf[_0x34be6b(0x291)]((_0x119e21,_0x830e18)=>{const _0x453096=_0x34be6b;if(_0x830e18%_0x45b46f==0x0)_0x415652=[];_0x415652[_0x453096(0x38c)]({'text':_0x453096(0x207)+_0x119e21[_0x453096(0x2a5)],'callback_data':_0x119e21['botID']}),_0x830e18%_0x45b46f==0x0&&(_0x1acbab[_0x39c60c]=_0x415652,_0x39c60c++);}),tgBot[_0x34be6b(0x329)](_0x309b47[_0x34be6b(0x225)]['id'],_0x34be6b(0x2e9),{'reply_markup':{'inline_keyboard':_0x1acbab}})['catch'](_0x28991f=>{telegramError(_0x28991f);}),tgBot['on']('callback_query',async _0x522f2c=>{const _0x5a4185=_0x34be6b,_0x9062d=_0x522f2c[_0x5a4185(0x31e)],_0x37e704=_0x522f2c[_0x5a4185(0x339)];tgBot[_0x5a4185(0x287)](_0x522f2c['id'])[_0x5a4185(0x31f)](async()=>{if(pid[_0x9062d])pid[_0x9062d]['send']({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x5a4185(0x297)](_0x5a4185(0x2a2));});}else{const _0x94b986=_0x308ddf[0x0]['botID'];if(pid[_0x94b986])pid[_0x94b986][_0x34be6b(0x31a)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0xfcd270(0x32f)](/\/portfolio/,_0x4582bd=>{const _0x1d0edd=_0xfcd270;if(!validateTelegram(_0x4582bd))return;tgBot[_0x1d0edd(0x297)]('callback_query');const _0x2e146c=getEnabledBots();if(_0x2e146c[_0x1d0edd(0x1be)]==0x0)tgBot[_0x1d0edd(0x329)](_0x4582bd['chat']['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x30ab20=>{telegramError(_0x30ab20);});else{if(_0x2e146c[_0x1d0edd(0x1be)]>0x1){let _0x53cef7=[],_0x45513f=[];const _0x549f5a=_0x2e146c[_0x1d0edd(0x1be)]%0x4==0x0||_0x2e146c[_0x1d0edd(0x1be)]%0x4==0x3||_0x2e146c[_0x1d0edd(0x1be)]%0x3==0x1?0x4:0x3;let _0x31e007=0x0;_0x2e146c[_0x1d0edd(0x291)]((_0x5a11fd,_0x5cec69)=>{const _0x909312=_0x1d0edd;if(_0x5cec69%_0x549f5a==0x0)_0x45513f=[];_0x45513f[_0x909312(0x38c)]({'text':_0x909312(0x207)+_0x5a11fd[_0x909312(0x2a5)],'callback_data':_0x5a11fd['botID']}),_0x5cec69%_0x549f5a==0x0&&(_0x53cef7[_0x31e007]=_0x45513f,_0x31e007++);}),tgBot['sendMessage'](_0x4582bd['chat']['id'],_0x1d0edd(0x28a),{'reply_markup':{'inline_keyboard':_0x53cef7}})[_0x1d0edd(0x261)](_0x2604d1=>{telegramError(_0x2604d1);}),tgBot['on'](_0x1d0edd(0x2a2),async _0x343465=>{const _0x42ece8=_0x1d0edd,_0x5191b4=_0x343465['data'],_0x48df30=_0x343465[_0x42ece8(0x339)];tgBot['answerCallbackQuery'](_0x343465['id'])[_0x42ece8(0x31f)](async()=>{const _0x170043=_0x42ece8;if(pid[_0x5191b4])pid[_0x5191b4][_0x170043(0x31a)]({'function':'sendPortfolioTelegram','args':null});}),tgBot['removeListener']('callback_query');});}else{const _0x32448a=_0x2e146c[0x0][_0x1d0edd(0x2a5)];if(pid[_0x32448a])pid[_0x32448a][_0x1d0edd(0x31a)]({'function':_0x1d0edd(0x2ab),'args':null});}}}),tgBot['onText'](/\/update/,async _0x4e8ae4=>{const _0x3fffa4=_0xfcd270;if(!validateTelegram(_0x4e8ae4))return;tgBot['removeListener'](_0x3fffa4(0x2a2)),await getMessages();if(!updateAvailable)tgBot[_0x3fffa4(0x329)](_0x4e8ae4[_0x3fffa4(0x225)]['id'],_0x3fffa4(0x1e1))['catch'](_0x2b1418=>{telegramError(_0x2b1418);});else!validInstallation?tgBot[_0x3fffa4(0x329)](_0x4e8ae4[_0x3fffa4(0x225)]['id'],_0x3fffa4(0x1dd))[_0x3fffa4(0x261)](_0x266309=>{telegramError(_0x266309);}):(tgBot[_0x3fffa4(0x329)](_0x4e8ae4[_0x3fffa4(0x225)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x3fffa4(0x1ca),'callback_data':_0x3fffa4(0x304)},{'text':'No','callback_data':'no'}]]}})[_0x3fffa4(0x261)](_0x178335=>{telegramError(_0x178335);}),tgBot['on'](_0x3fffa4(0x2a2),async _0xbabed8=>{const _0x57b17f=_0x3fffa4,_0x512b9f=_0xbabed8[_0x57b17f(0x31e)],_0x5f565c=_0xbabed8[_0x57b17f(0x339)];tgBot[_0x57b17f(0x287)](_0xbabed8['id'])[_0x57b17f(0x31f)](async()=>{const _0x424674=_0x57b17f;_0x512b9f=='yes'&&(await tgBot['sendMessage'](_0x5f565c[_0x424674(0x225)]['id'],_0x424674(0x37a))['catch'](_0x3369ca=>{telegramError(_0x3369ca);}),updateBB(_0x424674(0x36e))),_0x512b9f=='no'&&await tgBot[_0x424674(0x329)](_0x5f565c[_0x424674(0x225)]['id'],_0x424674(0x1e9))[_0x424674(0x261)](_0x212ea0=>{telegramError(_0x212ea0);});}),tgBot[_0x57b17f(0x297)](_0x57b17f(0x2a2));}));}),tgBot[_0xfcd270(0x32f)](/\/reinstall/,async _0x25dc63=>{const _0x5695af=_0xfcd270;if(!validateTelegram(_0x25dc63))return;tgBot[_0x5695af(0x297)]('callback_query'),!validInstallation?tgBot['sendMessage'](_0x25dc63['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')['catch'](_0x3d9263=>{telegramError(_0x3d9263);}):(tgBot[_0x5695af(0x329)](_0x25dc63[_0x5695af(0x225)]['id'],_0x5695af(0x338),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x5695af(0x304)},{'text':'No','callback_data':'no'}]]}})[_0x5695af(0x261)](_0x2e9c27=>{telegramError(_0x2e9c27);}),tgBot['on']('callback_query',async _0x5bf03e=>{const _0x205d7e=_0x5695af,_0x3b1984=_0x5bf03e[_0x205d7e(0x31e)],_0x169676=_0x5bf03e[_0x205d7e(0x339)];tgBot[_0x205d7e(0x287)](_0x5bf03e['id'])['then'](async()=>{const _0x4736c8=_0x205d7e;_0x3b1984==_0x4736c8(0x304)&&(await tgBot['sendMessage'](_0x169676['chat']['id'],'Starting\x20Balance\x20Bot\x20reinstallation')[_0x4736c8(0x261)](_0x5880cf=>{telegramError(_0x5880cf);}),updateBB(_0x4736c8(0x324))),_0x3b1984=='no'&&await tgBot['sendMessage'](_0x169676['chat']['id'],_0x4736c8(0x208))[_0x4736c8(0x261)](_0x39124c=>{telegramError(_0x39124c);});}),tgBot['removeListener']('callback_query');}));}),tgBot[_0xfcd270(0x32f)](/\/toggle/,_0x552214=>{const _0x29ba64=_0xfcd270;if(!validateTelegram(_0x552214))return;tgBot[_0x29ba64(0x297)](_0x29ba64(0x2a2));const _0x188298=getBotsWithMode();if(_0x188298[_0x29ba64(0x1be)]==0x0)tgBot[_0x29ba64(0x329)](_0x552214[_0x29ba64(0x225)]['id'],_0x29ba64(0x2b2))['catch'](_0x464fc5=>{telegramError(_0x464fc5);});else{let _0x2f9699=[],_0xc65416=[];const _0x219338=0x2;let _0x2ce19e=0x0;_0x188298['forEach']((_0xed160b,_0x241641)=>{const _0x453fa4=_0x29ba64;if(_0x241641%_0x219338==0x0)_0xc65416=[];_0xc65416[_0x453fa4(0x38c)]({'text':_0x453fa4(0x207)+_0xed160b[_0x453fa4(0x2a5)]+'\x20('+_0xed160b[_0x453fa4(0x26e)]+')','callback_data':_0xed160b[_0x453fa4(0x2a5)]}),_0x241641%_0x219338==0x0&&(_0x2f9699[_0x2ce19e]=_0xc65416,_0x2ce19e++);}),tgBot[_0x29ba64(0x329)](_0x552214[_0x29ba64(0x225)]['id'],_0x29ba64(0x2c3),{'reply_markup':{'inline_keyboard':_0x2f9699}})[_0x29ba64(0x261)](_0xb2000f=>{telegramError(_0xb2000f);}),tgBot['on'](_0x29ba64(0x2a2),async _0x2df2d0=>{const _0x41a1ea=_0x29ba64,_0x4bf4d4=_0x2df2d0['data'],_0x3d652a=_0x2df2d0['message'];tgBot[_0x41a1ea(0x287)](_0x2df2d0['id'])['then'](async()=>{const _0x5f5c72=_0x41a1ea,_0x37a9c2=_0x188298[_0x5f5c72(0x25c)](_0x1235b1=>_0x1235b1[_0x5f5c72(0x2a5)]==_0x4bf4d4),_0x3f5511=_0x37a9c2[_0x5f5c72(0x26e)]==_0x5f5c72(0x1e3)?_0x5f5c72(0x372):_0x5f5c72(0x1e3);tgBot['sendMessage'](_0x3d652a['chat']['id'],_0x5f5c72(0x20f)+_0x4bf4d4+_0x5f5c72(0x1fc)+_0x3f5511+_0x5f5c72(0x2d0))[_0x5f5c72(0x261)](_0x2863ee=>{telegramError(_0x2863ee);}),toggleBotMode(_0x4bf4d4);}),tgBot['removeListener']('callback_query');});}}),tgBot[_0xfcd270(0x32f)](/\/names/,_0xf27503=>{const _0x16f860=_0xfcd270;if(!validateTelegram(_0xf27503))return;let _0x12de81='';config[_0x16f860(0x291)](_0xc0125c=>{const _0x32d3e3=_0x16f860;_0x12de81+=_0x32d3e3(0x207)+_0xc0125c[_0x32d3e3(0x2a5)]+':\x20'+_0xc0125c[_0x32d3e3(0x26c)]+'\x0a';}),tgBot['sendMessage'](_0xf27503[_0x16f860(0x225)]['id'],_0x12de81,{'parse_mode':'HTML'})[_0x16f860(0x261)](_0x137d65=>{telegramError(_0x137d65);});}),tgBot['onText'](/\/disable/,_0x14b76d=>{const _0x2f9c37=_0xfcd270;if(!validateTelegram(_0x14b76d))return;tgBot[_0x2f9c37(0x329)](_0x14b76d[_0x2f9c37(0x225)]['id'],_0x2f9c37(0x25e))['catch'](_0x30a6b0=>{telegramError(_0x30a6b0);}),updateSetting('telegramEnabled',![]);}),tgBot[_0xfcd270(0x32f)](/\/help/,_0x297dd3=>{const _0x3d8ca0=_0xfcd270;if(!validateTelegram(_0x297dd3))return;tgBot[_0x3d8ca0(0x329)](_0x297dd3[_0x3d8ca0(0x225)]['id'],_0x52f0bb)['catch'](_0x1a6bc0=>{telegramError(_0x1a6bc0);});}),tgBot['on'](_0xfcd270(0x344),_0x30d9d4=>{const _0x248b4e=_0xfcd270;_0x30d9d4['toString']()[_0x248b4e(0x2eb)](_0x248b4e(0x219))&&(logger['full'](_0x248b4e(0x292)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x248b4e(0x2a6))[_0x248b4e(0x331)](_0x248b4e(0x232),_0x248b4e(0x292)));}),process['once']('SIGINT',()=>{const _0x204308=_0xfcd270;if(tgBot)tgBot[_0x204308(0x269)]();process[_0x204308(0x1d1)](0x1);}),process['once']('SIGTERM',()=>{const _0xb78894=_0xfcd270;if(tgBot)tgBot[_0xb78894(0x269)]();process[_0xb78894(0x1d1)](0x1);});}}function disableTelegram(){const _0x4362bd=_0x1f5a02;tgBot&&(tgBot[_0x4362bd(0x269)](),tgBot=null);}function sendTelegram(_0x2822ed,_0x546de3){const _0x44f95a=_0x1f5a02;if(settings[_0x44f95a(0x267)]){if(settings[_0x44f95a(0x216)]==_0x44f95a(0x1ce)||(_0x546de3['type']==_0x44f95a(0x2a4)||_0x546de3[_0x44f95a(0x270)]=='warning'||_0x546de3[_0x44f95a(0x270)]=='success')&&settings[_0x44f95a(0x216)]==_0x44f95a(0x1df)||_0x546de3[_0x44f95a(0x270)]==_0x44f95a(0x2a3)&&settings[_0x44f95a(0x216)]==_0x44f95a(0x315)){if(tgBot&&settings[_0x44f95a(0x1bb)]){if(_0x546de3[_0x44f95a(0x273)])tgBot[_0x44f95a(0x329)](settings[_0x44f95a(0x1bb)],_0x546de3[_0x44f95a(0x26c)]+_0x44f95a(0x21a)+_0x546de3[_0x44f95a(0x28c)])[_0x44f95a(0x261)](_0x4abae5=>{telegramError(_0x4abae5);});else tgBot[_0x44f95a(0x329)](settings[_0x44f95a(0x1bb)],_0x44f95a(0x207)+_0x2822ed+_0x44f95a(0x21a)+_0x546de3[_0x44f95a(0x28c)])[_0x44f95a(0x261)](_0x23594f=>{telegramError(_0x23594f);});}}}}async function sendTelegramMsg(_0x240b35,_0x2fa9a7=_0x1f5a02(0x209)){const _0x296c2c=_0x1f5a02;return settings[_0x296c2c(0x267)]&&tgBot&&settings[_0x296c2c(0x1bb)]?(await tgBot['sendMessage'](settings['telegramChatId'],_0x240b35,{'parse_mode':_0x2fa9a7})[_0x296c2c(0x261)](_0x194486=>{telegramError(_0x194486);}),!![]):![];}function getDeviceWithIp(_0x1374de){const _0x195abc=_0x1f5a02;return devices[_0x195abc(0x25c)](_0x102923=>_0x102923['ip']===_0x1374de);}function temporaryAccess2FA(_0xf3a7e2,_0xb1bdf9){const _0x3a3ca0=_0x1f5a02;let _0x29b97e=new Date(),_0x4cfcea=![];if(lastIpApproval){if(_0x29b97e-lastIpApproval<0x1388)_0x4cfcea=!![];}lastIpApproval=new Date();if(_0x4cfcea)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x3a3ca0(0x297)](_0x3a3ca0(0x2a2)),tgBot[_0x3a3ca0(0x329)](settings['telegramChatId'],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0xb1bdf9)['show']+_0x3a3ca0(0x259),{'parse_mode':_0x3a3ca0(0x209),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x3a3ca0(0x328),'callback_data':'30'},{'text':_0x3a3ca0(0x365),'callback_data':_0x3a3ca0(0x365)}]]}})[_0x3a3ca0(0x261)](_0x4afe31=>{telegramError(_0x4afe31);}),tgBot['on'](_0x3a3ca0(0x2a2),async _0xb7a3db=>{const _0x7c54f8=_0x3a3ca0,_0x1b8e33=_0xb7a3db[_0x7c54f8(0x31e)],_0x15400c=_0xb7a3db[_0x7c54f8(0x339)];tgBot[_0x7c54f8(0x287)](_0xb7a3db['id'])[_0x7c54f8(0x31f)](async()=>{const _0x52f15d=_0x7c54f8;devices[_0xf3a7e2][_0x52f15d(0x263)]={'clientip':_0xb1bdf9,'timestamp':new Date()[_0x52f15d(0x1db)](),'expiry':_0x1b8e33},_0x1b8e33!=_0x52f15d(0x365)?(await tgBot[_0x52f15d(0x329)](_0x15400c['chat']['id'],_0x52f15d(0x24d)+_0x1b8e33+_0x52f15d(0x386),{'parse_mode':_0x52f15d(0x209)})[_0x52f15d(0x261)](_0x2bcf6d=>{telegramError(_0x2bcf6d);}),io['to'](_0xf3a7e2)[_0x52f15d(0x331)](_0x52f15d(0x384),{'access':{'allow':![],'reason':_0x52f15d(0x319),'token':null}})):(await tgBot['sendMessage'](_0x15400c[_0x52f15d(0x225)]['id'],'Temporary\x20access\x20rejected')['catch'](_0x25d4cc=>{telegramError(_0x25d4cc);}),io['to'](_0xf3a7e2)[_0x52f15d(0x331)](_0x52f15d(0x384),{'access':{'allow':![],'reason':_0x52f15d(0x2f6),'token':null}}));}),tgBot[_0x7c54f8(0x297)](_0x7c54f8(0x2a2));}));}function loginAccess2FA(_0x3b3dc1,_0x2e9a98){const _0x4b6b6d=_0x1f5a02;tgBot&&settings[_0x4b6b6d(0x1bb)]&&(tgBot[_0x4b6b6d(0x297)]('callback_query'),tgBot[_0x4b6b6d(0x329)](settings['telegramChatId'],_0x4b6b6d(0x286)+normalizeIP(_0x2e9a98)[_0x4b6b6d(0x33c)]+_0x4b6b6d(0x259),{'parse_mode':_0x4b6b6d(0x209),'reply_markup':{'inline_keyboard':[[{'text':_0x4b6b6d(0x29d),'callback_data':loginExpiry},{'text':_0x4b6b6d(0x365),'callback_data':_0x4b6b6d(0x365)}]]}})[_0x4b6b6d(0x261)](_0x46a6e4=>{telegramError(_0x46a6e4);}),tgBot['on'](_0x4b6b6d(0x2a2),async _0x58a138=>{const _0x199b49=_0x4b6b6d,_0x1f3f62=_0x58a138['data'],_0x3f60b4=_0x58a138[_0x199b49(0x339)];tgBot[_0x199b49(0x287)](_0x58a138['id'])[_0x199b49(0x31f)](async()=>{const _0x27da2d=_0x199b49;devices[_0x3b3dc1][_0x27da2d(0x2c2)]={'clientip':_0x2e9a98,'timestamp':new Date()[_0x27da2d(0x1db)](),'expiry':_0x1f3f62},_0x1f3f62!='reject'?(await tgBot[_0x27da2d(0x329)](_0x3f60b4[_0x27da2d(0x225)]['id'],'Login\x20accepted',{'parse_mode':'HTML'})[_0x27da2d(0x261)](_0x21b237=>{telegramError(_0x21b237);}),io['to'](_0x3b3dc1)['emit'](_0x27da2d(0x384),{'access':{'allow':![],'reason':_0x27da2d(0x319),'token':null}})):(await tgBot['sendMessage'](_0x3f60b4[_0x27da2d(0x225)]['id'],_0x27da2d(0x1ed))[_0x27da2d(0x261)](_0x407019=>{telegramError(_0x407019);}),io['to'](_0x3b3dc1)[_0x27da2d(0x331)](_0x27da2d(0x384),{'access':{'allow':![],'reason':_0x27da2d(0x36f),'token':null}}));}),tgBot[_0x199b49(0x297)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x29c8b6=_0x1f5a02;return dbConfig['get'](_0x29c8b6(0x2ac))[_0x29c8b6(0x1f0)](_0x29c8b6(0x2a5))['filter']({'status':_0x29c8b6(0x347)})[_0x29c8b6(0x223)]()||[];}function getDisabledBots(){const _0x4161ff=_0x1f5a02;return dbConfig[_0x4161ff(0x349)](_0x4161ff(0x2ac))['sortBy'](_0x4161ff(0x2a5))[_0x4161ff(0x21d)]({'status':_0x4161ff(0x302)})['value']()||[];}function getBotAttributes(_0x13e4d1){const _0x383859=_0x1f5a02;let _0x5491c4={};const _0x53d374=configpath+'bot-'+_0x13e4d1+_0x383859(0x336),_0x52c2ad=fs['existsSync'](_0x53d374);if(_0x52c2ad){const _0x1e2457=fs[_0x383859(0x294)](_0x53d374);try{const _0x1afb10=JSON['parse'](_0x1e2457),_0x4eb66a=_0x1afb10?_0x1afb10[_0x383859(0x398)][0x0][_0x383859(0x371)]:![];_0x5491c4[_0x383859(0x26e)]=_0x4eb66a?_0x383859(0x1e3):_0x383859(0x372),_0x5491c4[_0x383859(0x26c)]=_0x1afb10?_0x1afb10[_0x383859(0x398)][0x0]['botname']:_0x383859(0x207)+_0x13e4d1;}catch(_0x37774e){_0x5491c4[_0x383859(0x26e)]=_0x383859(0x372),_0x5491c4[_0x383859(0x26c)]='Bot\x20'+_0x13e4d1;}}else _0x5491c4[_0x383859(0x26e)]=_0x383859(0x372),_0x5491c4[_0x383859(0x26c)]=_0x383859(0x207)+_0x13e4d1;return _0x5491c4;}function getBotsWithMode(){const _0x3a9c52=_0x1f5a02,_0x421f21=dbConfig[_0x3a9c52(0x349)](_0x3a9c52(0x2ac))[_0x3a9c52(0x1f0)]('botID')['value']()||[];return _0x421f21[_0x3a9c52(0x291)](_0x581019=>{const _0x5c20ca=_0x3a9c52;let _0x35cbf3=getBotAttributes(_0x581019['botID']);_0x581019[_0x5c20ca(0x26e)]=_0x35cbf3['mode'];}),_0x421f21;}function getBotExchanges(){const _0x5f1e5b=_0x1f5a02;let _0xa6e42=[];const _0x5a247d=dbConfig[_0x5f1e5b(0x349)](_0x5f1e5b(0x2ac))['sortBy'](_0x5f1e5b(0x2a5))[_0x5f1e5b(0x223)]()||[];_0x5a247d[_0x5f1e5b(0x291)](_0x43984c=>{const _0x588e2a=_0x5f1e5b;if(_0x43984c[_0x588e2a(0x384)]==_0x588e2a(0x347)){const _0x365caf=configpath+'bot-'+_0x43984c[_0x588e2a(0x2a5)]+_0x588e2a(0x336),_0x2a6c8c=fs[_0x588e2a(0x33f)](_0x365caf);let _0x5e42c5;if(_0x2a6c8c){const _0x29c35b=fs['readFileSync'](_0x365caf);try{const _0x2c0843=JSON[_0x588e2a(0x2b1)](_0x29c35b);_0x5e42c5=_0x2c0843?_0x2c0843[_0x588e2a(0x398)][0x0][_0x588e2a(0x30f)]:null;}catch(_0x3d2c73){}}if(_0x5e42c5)_0xa6e42[_0x588e2a(0x38c)](_0x5e42c5);}});const _0xa67f12=[...new Set(_0xa6e42)]['sort']();return _0xa67f12;}async function initUser(){const _0x1edab9=_0x1f5a02;if(!settings['userid']){const _0x296aad=uuidRandom();mixpanel[_0x1edab9(0x264)](_0x296aad),updateSetting(_0x1edab9(0x1da),_0x296aad);}}async function initSecure(){const _0x366cf1=_0x1f5a02;let _0x355192=getSecure();if(!_0x355192['hasOwnProperty']('secret')){let _0x35f7cf=await generateKeys();_0x355192[_0x366cf1(0x25a)]=_0x35f7cf[_0x366cf1(0x25a)],_0x355192[_0x366cf1(0x26d)]=_0x35f7cf[_0x366cf1(0x26d)],_0x355192[_0x366cf1(0x307)]=crypto[_0x366cf1(0x1ea)](0x20)[_0x366cf1(0x20c)]('hex');;storeSecure(_0x355192);}}function getSettings(){const _0x5429c2=_0x1f5a02;return dbSettings[_0x5429c2(0x349)](_0x5429c2(0x22d))[_0x5429c2(0x223)]()||{};}function getSecure(){const _0x3b1db0=_0x1f5a02;return dbSecure[_0x3b1db0(0x349)]('secure')[_0x3b1db0(0x223)]()||{};}function getBlacklist(){return dbSecure['get']('blacklist')['value']()||[];}function broadcastToBots(_0x62ffb8,_0x3ebb03){const _0x10545a=_0x1f5a02;config[_0x10545a(0x291)](_0x4a9592=>{const _0x3198e7=_0x10545a;if(_0x4a9592['status']=='enabled'&&_0x4a9592[_0x3198e7(0x244)]==_0x3198e7(0x2f1)||_0x4a9592[_0x3198e7(0x384)]==_0x3198e7(0x1f4)&&_0x4a9592[_0x3198e7(0x244)]==_0x3198e7(0x2f1)){if(pid[_0x4a9592[_0x3198e7(0x2a5)]])pid[_0x4a9592['botID']][_0x3198e7(0x31a)]({[_0x62ffb8]:_0x3ebb03});}});}function storeSettings(_0x1980f6,_0xcdd9a8=![]){const _0x367935=_0x1f5a02;_0x1980f6={...settings,..._0x1980f6};if(_0xcdd9a8&&_0x1980f6[_0x367935(0x351)]!=_0x367935(0x38e)&&_0x1980f6['bbPassword']!=_0x367935(0x364)&&_0x1980f6[_0x367935(0x351)]!=''){const _0xff1e97=crypt[_0x367935(0x210)](secure[_0x367935(0x26d)],_0x1980f6['bbPassword'])['message'][_0x367935(0x289)]('@')[0x0],_0x2668c1=bcrypt[_0x367935(0x350)](_0xff1e97,saltRounds);_0x1980f6={..._0x1980f6,'bbPassword':_0x2668c1};}if(_0xcdd9a8&&_0x1980f6[_0x367935(0x246)]!=_0x367935(0x38e)&&_0x1980f6['telegramToken']!=_0x367935(0x364)&&_0x1980f6[_0x367935(0x246)]!=''){const _0x32d811=crypt[_0x367935(0x210)](secure[_0x367935(0x26d)],_0x1980f6[_0x367935(0x246)])[_0x367935(0x339)][_0x367935(0x289)]('@')[0x0];_0x1980f6={..._0x1980f6,'telegramToken':_0x32d811};}const _0x3cabf1=_0x1980f6[_0x367935(0x246)]!='************'&&_0x1980f6['telegramToken']!=settings[_0x367935(0x246)]||_0x1980f6['telegramUsername']!=settings[_0x367935(0x23e)],_0x21d39c=_0x1980f6[_0x367935(0x246)]==''||_0x1980f6['telegramUsername']=='';if(_0x3cabf1)_0x1980f6[_0x367935(0x216)]=_0x367935(0x1ce);for(const [_0x2b498a,_0x1d47a9]of Object[_0x367935(0x22e)](_0x1980f6)){if(_0x2b498a=='telegramToken'&&_0x1d47a9==_0x367935(0x38e)){_0x1980f6[_0x367935(0x246)]=settings[_0x367935(0x246)];continue;};if(_0x2b498a=='bbPassword'&&_0x1d47a9==_0x367935(0x38e)){_0x1980f6[_0x367935(0x351)]=settings[_0x367935(0x351)];continue;};dbSettings['set'](_0x367935(0x2d6)+_0x2b498a,_0x1d47a9)[_0x367935(0x1bc)]();}settings=_0x1980f6,io['to']('botmanager')[_0x367935(0x331)]('settings',cleanSettings()),broadcastToBots(_0x367935(0x1c5),settings[_0x367935(0x1c5)]),broadcastToBots('onepagemode',settings['onepagemode']);if(_0x3cabf1&&!_0x21d39c)initTelegram();if(_0x3cabf1&&_0x21d39c)disableTelegram();getAllClients()['forEach'](_0x766efc=>{const _0xc905ff=_0x367935;getSocket(_0x766efc['id'])[_0xc905ff(0x331)](_0xc905ff(0x384),{'access':{'allow':![],'reason':_0xc905ff(0x319),'token':null}});});}function updateSetting(_0x4c0ed8,_0x5c0466){const _0x46c648=_0x1f5a02;dbSettings['set'](_0x46c648(0x2d6)+_0x4c0ed8,_0x5c0466)[_0x46c648(0x1bc)](),settings=getSettings(),io['to']('botmanager')['emit'](_0x46c648(0x22d),cleanSettings());}function storeSecure(_0x31deb7){const _0x26fa9e=_0x1f5a02;dbSecure[_0x26fa9e(0x349)](_0x26fa9e(0x2da))[_0x26fa9e(0x38c)](_0x31deb7)[_0x26fa9e(0x1bc)](),secure=_0x31deb7;}function addBlacklist(_0x536917){const _0x832305=_0x1f5a02;cleanBlacklist();let _0x73bf3;devices[_0x536917][_0x832305(0x263)]?_0x73bf3=Math[_0x832305(0x2b7)](devices[_0x536917]['telegramIpApproval'][_0x832305(0x36c)],loginExpiry):_0x73bf3=loginExpiry,dbSecure[_0x832305(0x349)]('blacklist')['push']({'expiry':new Date()[_0x832305(0x1db)]()+_0x73bf3*0x3c*0x3e8,'token':devices[_0x536917][_0x832305(0x378)]['token']})[_0x832305(0x1bc)](),blacklist=dbSecure[_0x832305(0x349)](_0x832305(0x279))[_0x832305(0x223)]();}function cleanBlacklist(){const _0x483f7e=_0x1f5a02;let _0x2f167f=dbSecure[_0x483f7e(0x349)](_0x483f7e(0x279))[_0x483f7e(0x1d2)]()[_0x483f7e(0x223)](),_0x4804f0=new Date()[_0x483f7e(0x1db)]();_0x2f167f[_0x483f7e(0x291)](_0x53775c=>{const _0x1eb4bd=_0x483f7e;_0x53775c[_0x1eb4bd(0x36c)]<_0x4804f0&&dbSecure[_0x1eb4bd(0x349)](_0x1eb4bd(0x279))[_0x1eb4bd(0x36b)]({'expiry':_0x53775c[_0x1eb4bd(0x36c)]})[_0x1eb4bd(0x1bc)]();});}function initStates(){const _0x255a24=_0x1f5a02;let _0x381ba4=getConfiguration();_0x381ba4[_0x255a24(0x291)](_0x2e950e=>{const _0x41f19e=_0x255a24;_0x2e950e['live']=_0x41f19e(0x241);}),storeConfiguration(_0x381ba4);}function onKeys(){const _0x5675e7=new RSA();return new Promise(_0x2d8b4f=>{const _0x4cd3d9=_0x4978;_0x5675e7[_0x4cd3d9(0x2f0)]()[_0x4cd3d9(0x31f)](_0x244d73=>{_0x2d8b4f(_0x244d73);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x3a0f8f=_0x1f5a02;let _0x276a04=getSettings(),_0x1f1c35=![];!_0x276a04[_0x3a0f8f(0x34a)](_0x3a0f8f(0x1e0))&&(_0x276a04[_0x3a0f8f(0x1e0)]=0x0,_0x1f1c35=!![]);!_0x276a04[_0x3a0f8f(0x34a)](_0x3a0f8f(0x251))&&(_0x276a04['lastmsgemitted']=0x0,_0x1f1c35=!![]);!_0x276a04[_0x3a0f8f(0x34a)](_0x3a0f8f(0x36a))&&(_0x276a04['latestversion']=_0x3a0f8f(0x393),_0x1f1c35=!![]);!_0x276a04[_0x3a0f8f(0x34a)](_0x3a0f8f(0x1cf))&&(_0x276a04[_0x3a0f8f(0x1cf)]=![],_0x1f1c35=!![]);if(_0x1f1c35)storeSettings(_0x276a04);try{fs[_0x3a0f8f(0x1e8)](configbackuppath,{'withFileTypes':!![]})[_0x3a0f8f(0x291)](_0x4aa853=>{const _0x4b2409=_0x3a0f8f;if(!_0x4aa853['isDirectory']()){if(!_0x4aa853[_0x4b2409(0x2f3)][_0x4b2409(0x37c)]('backup-full@'))fs['unlinkSync'](configbackuppath+_0x4aa853['name']);}else fs[_0x4b2409(0x250)](configbackuppath+_0x4aa853[_0x4b2409(0x2f3)],{'recursive':!![]});});}catch(_0x3ed48b){logger[_0x3a0f8f(0x257)](_0x3a0f8f(0x392),_0x3ed48b);}}function storeConfiguration(_0x1d2dcd){const _0x34dd57=_0x1f5a02;dbConfig[_0x34dd57(0x349)](_0x34dd57(0x2ac))['remove']()['write'](),_0x1d2dcd[_0x34dd57(0x291)](_0x4b3b8d=>{const _0xd5b5e3=_0x34dd57;delete _0x4b3b8d[_0xd5b5e3(0x26e)];}),dbConfig[_0x34dd57(0x349)](_0x34dd57(0x2ac))[_0x34dd57(0x38c)](..._0x1d2dcd)[_0x34dd57(0x1bc)](),config=_0x1d2dcd;}function resetPassword(){const _0x6a1d33=_0x1f5a02;tgBot&&settings[_0x6a1d33(0x1bb)]&&(tgBot[_0x6a1d33(0x297)]('callback_query'),tgBot[_0x6a1d33(0x329)](settings[_0x6a1d33(0x1bb)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x6a1d33(0x209),'reply_markup':{'inline_keyboard':[[{'text':_0x6a1d33(0x304),'callback_data':_0x6a1d33(0x304)},{'text':'no','callback_data':'no'}]]}})[_0x6a1d33(0x261)](_0x413bcf=>{telegramError(_0x413bcf);}),tgBot['on'](_0x6a1d33(0x2a2),async _0x16e947=>{const _0x2194a6=_0x6a1d33,_0x30e355=_0x16e947[_0x2194a6(0x31e)],_0x496e38=_0x16e947[_0x2194a6(0x339)];tgBot[_0x2194a6(0x287)](_0x16e947['id'])['then'](async()=>{const _0x2c8fa8=_0x2194a6;if(_0x30e355!='no'){const _0x15cdd6=0xf,_0x178a76=_0x2c8fa8(0x340),_0x53dda3=Array[_0x2c8fa8(0x285)](crypto[_0x2c8fa8(0x218)](new Uint32Array(_0x15cdd6)))[_0x2c8fa8(0x38a)](_0x595012=>_0x178a76[_0x595012%_0x178a76[_0x2c8fa8(0x1be)]])['join'](''),_0x136f4b=bcrypt[_0x2c8fa8(0x350)](_0x53dda3,saltRounds);storeSettings({'bbPassword':_0x136f4b}),await tgBot['sendMessage'](_0x496e38['chat']['id'],_0x2c8fa8(0x21e)+_0x53dda3,{'parse_mode':'HTML'})[_0x2c8fa8(0x261)](_0x336807=>{telegramError(_0x336807);});}else await tgBot[_0x2c8fa8(0x329)](_0x496e38[_0x2c8fa8(0x225)]['id'],'Password\x20reset\x20rejected')[_0x2c8fa8(0x261)](_0xf7ec47=>{telegramError(_0xf7ec47);});}),tgBot[_0x2194a6(0x297)]('callback_query');}));}async function confirmRestore(_0x23af47,_0x528f88){const _0x872c88=_0x1f5a02;io['to']('botmanager')['emit'](_0x872c88(0x232),_0x872c88(0x367),_0x872c88(0x2bc)),tgBot&&settings[_0x872c88(0x1bb)]&&(tgBot['removeListener'](_0x872c88(0x2a2)),await tgBot[_0x872c88(0x329)](settings[_0x872c88(0x1bb)],_0x872c88(0x35d),{'parse_mode':_0x872c88(0x209),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x872c88(0x261)](_0xb30503=>{telegramError(_0xb30503);}),tgBot['on'](_0x872c88(0x2a2),async _0x324204=>{const _0x15aced=_0x872c88,_0xaee398=_0x324204[_0x15aced(0x31e)],_0x378024=_0x324204['message'];tgBot[_0x15aced(0x287)](_0x324204['id'])[_0x15aced(0x31f)](async()=>{const _0x2a1178=_0x15aced;_0xaee398==_0x2a1178(0x304)?(await tgBot[_0x2a1178(0x329)](_0x378024[_0x2a1178(0x225)]['id'],_0x2a1178(0x34e),{'parse_mode':_0x2a1178(0x209)})['catch'](_0x2e5848=>{telegramError(_0x2e5848);}),unzipFile(_0x23af47,_0x528f88)):(logger['debug'](_0x2a1178(0x242)),await tgBot[_0x2a1178(0x329)](_0x378024[_0x2a1178(0x225)]['id'],_0x2a1178(0x242))[_0x2a1178(0x261)](_0x2aedb6=>{telegramError(_0x2aedb6);}));}),tgBot[_0x15aced(0x297)](_0x15aced(0x2a2));}));}function getServerTime(){const _0x412061=_0x1f5a02,_0x30d1e1=new Date();return _0x30d1e1[_0x412061(0x23a)]()+'/'+(_0x30d1e1[_0x412061(0x22f)]()+0x1)['toString']()[_0x412061(0x332)](0x2,'0')+'/'+_0x30d1e1[_0x412061(0x2d7)]()[_0x412061(0x20c)]()[_0x412061(0x332)](0x2,'0')+'\x20'+_0x30d1e1[_0x412061(0x2a8)]()[_0x412061(0x20c)]()[_0x412061(0x332)](0x2,'0')+':'+_0x30d1e1[_0x412061(0x2aa)]()[_0x412061(0x20c)]()[_0x412061(0x332)](0x2,'0')+':'+_0x30d1e1[_0x412061(0x248)]()['toString']()[_0x412061(0x332)](0x2,'0');}function getTimeStamp(){const _0x2abfe6=_0x1f5a02,_0x278696=shiftedTime();return _0x278696['getFullYear']()+'/'+(_0x278696['getMonth']()+0x1)[_0x2abfe6(0x20c)]()[_0x2abfe6(0x332)](0x2,'0')+'/'+_0x278696[_0x2abfe6(0x2d7)]()[_0x2abfe6(0x20c)]()[_0x2abfe6(0x332)](0x2,'0')+'\x20'+_0x278696[_0x2abfe6(0x2a8)]()[_0x2abfe6(0x20c)]()[_0x2abfe6(0x332)](0x2,'0')+':'+_0x278696[_0x2abfe6(0x2aa)]()[_0x2abfe6(0x20c)]()[_0x2abfe6(0x332)](0x2,'0')+':'+_0x278696[_0x2abfe6(0x248)]()['toString']()[_0x2abfe6(0x332)](0x2,'0');}function getCleanTimeStamp(){const _0x130759=_0x1f5a02,_0x479e89=shiftedTime();return _0x479e89['getFullYear']()+(_0x479e89[_0x130759(0x22f)]()+0x1)[_0x130759(0x20c)]()[_0x130759(0x332)](0x2,'0')+_0x479e89[_0x130759(0x2d7)]()[_0x130759(0x20c)]()[_0x130759(0x332)](0x2,'0')+'-'+_0x479e89['getHours']()['toString']()[_0x130759(0x332)](0x2,'0')+_0x479e89[_0x130759(0x2aa)]()['toString']()['padStart'](0x2,'0')+_0x479e89[_0x130759(0x248)]()[_0x130759(0x20c)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x30208b=_0x1f5a02,_0x30cd25=new Date();let _0x4e2fc1=_0x30cd25;if(settings[_0x30208b(0x1c5)]&&settings[_0x30208b(0x1c5)]!==0x0)_0x4e2fc1=fns['add'](_0x30cd25,{'hours':settings[_0x30208b(0x1c5)]});return _0x4e2fc1;}function startScheduler(){const _0x1c64dd=_0x1f5a02,_0x11c2bb=new Date()[_0x1c64dd(0x1fb)](),_0x1f7927=shiftedTime()[_0x1c64dd(0x2a8)]();_0x1f7927==0x4&&backupConfigFiles();_0x1f7927==0x0&&rotateLogFiles();_0x11c2bb%0x6==0x0&&triggerAnalytics();_0x11c2bb%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x59cee1){const _0x2e864b=_0x1f5a02;logger[_0x2e864b(0x257)](_0x2e864b(0x254)+_0x59cee1);const _0x39d533=getBotsWithMode();_0x39d533[_0x2e864b(0x1be)]>0x0?confirmRestore(configbackuppath,_0x59cee1):unzipFile(configbackuppath,_0x59cee1);}async function getBackupFiles(_0x17986e=null){const _0x26da38=_0x1f5a02;let _0x20b8ce=[],_0x398e37=fs[_0x26da38(0x1e8)](configbackuppath,{'withFileTypes':!![]});_0x398e37[_0x26da38(0x221)]((_0x41e339,_0x1e6472)=>_0x41e339[_0x26da38(0x2f3)]<_0x1e6472[_0x26da38(0x2f3)]?0x1:_0x1e6472[_0x26da38(0x2f3)]<_0x41e339['name']?-0x1:0x0),_0x398e37[_0x26da38(0x291)](_0xdf5bdc=>{const _0x16b2e6=_0x26da38;if(!_0xdf5bdc['isDirectory']()&&_0xdf5bdc[_0x16b2e6(0x2f3)][_0x16b2e6(0x37c)](_0x16b2e6(0x305))&&_0xdf5bdc[_0x16b2e6(0x2f3)][_0x16b2e6(0x34b)](_0x16b2e6(0x2e1))){const _0x5a8004=formatDate(fs['statSync'](configbackuppath+_0xdf5bdc[_0x16b2e6(0x2f3)])['mtime']);_0x20b8ce['push']({'name':_0xdf5bdc[_0x16b2e6(0x2f3)],'mtime':_0x5a8004});}});if(_0x17986e)io['to'](_0x17986e)[_0x26da38(0x331)](_0x26da38(0x382),_0x20b8ce);else return _0x20b8ce;}async function backupConfigFiles(){const _0x5a819d=_0x1f5a02;await zipFiles(_0x5a819d(0x2a1));const _0x1cb344=getCleanTimeStamp();fs['copyFileSync'](zippath+'backup-full.zip',configbackuppath+('backup-full@'+_0x1cb344+'.zip'));let _0x615957=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x615957[_0x5a819d(0x221)]((_0x1b49b2,_0x5f1de9)=>_0x1b49b2[_0x5a819d(0x2f3)]<_0x5f1de9[_0x5a819d(0x2f3)]?0x1:_0x5f1de9[_0x5a819d(0x2f3)]<_0x1b49b2[_0x5a819d(0x2f3)]?-0x1:0x0),_0x615957[_0x5a819d(0x1be)]>maxBackups&&fs[_0x5a819d(0x1d4)](configbackuppath+_0x615957[_0x615957[_0x5a819d(0x1be)]-0x1][_0x5a819d(0x2f3)]);}function rotateLogFiles(){const _0xa33008=_0x1f5a02,_0x24b25c=fs['statSync'](logspath+_0xa33008(0x2cf)),_0x395a3c=_0x24b25c[_0xa33008(0x2df)]/0x400;if(_0x395a3c>0x64){let _0x1a08cb=fs[_0xa33008(0x1e8)](logspath,{'withFileTypes':!![]});_0x1a08cb['sort']((_0x4f28fc,_0x31e04d)=>_0x4f28fc[_0xa33008(0x2f3)]<_0x31e04d['name']?0x1:_0x31e04d['name']<_0x4f28fc[_0xa33008(0x2f3)]?-0x1:0x0),_0x1a08cb[_0xa33008(0x291)](_0x235b21=>{const _0xb227a7=_0xa33008;if(_0x235b21['name']==_0xb227a7(0x32c))fs['copyFileSync'](logspath+_0x235b21[_0xb227a7(0x2f3)],logspath+_0xb227a7(0x36d));if(_0x235b21[_0xb227a7(0x2f3)]==_0xb227a7(0x32e))fs[_0xb227a7(0x252)](logspath+_0x235b21[_0xb227a7(0x2f3)],logspath+_0xb227a7(0x32c));_0x235b21[_0xb227a7(0x2f3)]==_0xb227a7(0x2cf)&&(fs['copyFileSync'](logspath+_0x235b21[_0xb227a7(0x2f3)],logspath+_0xb227a7(0x32e)),fs[_0xb227a7(0x308)](logspath+_0x235b21['name'],''));});}}async function zipFiles(_0x35dc8a){const _0x2137ab=_0x1f5a02;let _0x2ad574;if(_0x35dc8a==_0x2137ab(0x2e4))_0x2ad574=logspath;if(_0x35dc8a==_0x2137ab(0x29f))_0x2ad574=configpath;if(_0x35dc8a=='backup-full')_0x2ad574=configpath;let _0x58c4df=fs['readdirSync'](_0x2ad574,{'withFileTypes':!![]});const _0x243aed=new require('node-zip')();_0x58c4df['forEach'](_0x236f9d=>{const _0x392a57=_0x2137ab;if(!_0x236f9d[_0x392a57(0x2f9)]()){let _0x181d08=fs[_0x392a57(0x294)](_0x2ad574+_0x236f9d[_0x392a57(0x2f3)]);if(_0x35dc8a==_0x392a57(0x29f)){const _0x577317=/^bot-[0-9]{3}-config.json$/,_0xe003a8=_0x577317[_0x392a57(0x375)](_0x236f9d['name']);if(_0xe003a8){const _0x97fed4=JSON[_0x392a57(0x2b1)](_0x181d08);if(_0x97fed4[_0x392a57(0x398)][0x0]){_0x97fed4[_0x392a57(0x398)][0x0][_0x392a57(0x239)]=_0x392a57(0x364),_0x97fed4['bot'][0x0][_0x392a57(0x1d0)]=_0x392a57(0x364);if(_0x97fed4[_0x392a57(0x398)][0x0][_0x392a57(0x28d)])_0x97fed4[_0x392a57(0x398)][0x0][_0x392a57(0x28d)]=_0x392a57(0x364);}_0x181d08=JSON[_0x392a57(0x217)](_0x97fed4,null,0x2);}if(_0x236f9d[_0x392a57(0x2f3)]==_0x392a57(0x277)){const _0x1f86bf=JSON[_0x392a57(0x2b1)](_0x181d08);if(_0x1f86bf[_0x392a57(0x22d)][_0x392a57(0x366)])_0x1f86bf[_0x392a57(0x22d)][_0x392a57(0x366)]=![];if(_0x1f86bf[_0x392a57(0x22d)]['bbPassword'])_0x1f86bf[_0x392a57(0x22d)][_0x392a57(0x351)]='***';if(_0x1f86bf[_0x392a57(0x22d)]['telegramToken'])_0x1f86bf['settings'][_0x392a57(0x246)]=_0x392a57(0x364);if(_0x1f86bf[_0x392a57(0x22d)][_0x392a57(0x1bb)])_0x1f86bf[_0x392a57(0x22d)][_0x392a57(0x1bb)]=null;_0x181d08=JSON[_0x392a57(0x217)](_0x1f86bf,null,0x2);}if(_0x236f9d[_0x392a57(0x2f3)]!='bb-secure.json')_0x243aed[_0x392a57(0x1f6)](_0x236f9d[_0x392a57(0x2f3)],_0x181d08);}else _0x243aed['file'](_0x236f9d[_0x392a57(0x2f3)],_0x181d08);}});const _0x50d55f=_0x243aed[_0x2137ab(0x2cd)]({'base64':![],'compression':_0x2137ab(0x29b)});fs['writeFileSync'](zippath+(_0x35dc8a+_0x2137ab(0x2e1)),_0x50d55f,_0x2137ab(0x321));}async function unzipFile(_0x4381d7,_0x4eab8d){const _0x3fd916=_0x1f5a02;fs[_0x3fd916(0x1e8)](configpath,{'withFileTypes':!![]})[_0x3fd916(0x291)](_0xdeff71=>{const _0x1d8974=_0x3fd916;if(!_0xdeff71[_0x1d8974(0x2f9)]())fs[_0x1d8974(0x250)](configpath+_0xdeff71['name']);});const _0x18f5a0=fs[_0x3fd916(0x294)](_0x4381d7+_0x4eab8d,_0x3fd916(0x321)),_0x58a43d=new require(_0x3fd916(0x230))(_0x18f5a0,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x58a43d[_0x3fd916(0x288)])[_0x3fd916(0x291)](_0x31d8c6=>{const _0x3bee84=_0x3fd916,_0x30e368=_0x58a43d[_0x3bee84(0x288)][_0x31d8c6];fs[_0x3bee84(0x308)](configpath+_0x30e368['name'],_0x30e368[_0x3bee84(0x1f8)]);}),fs[_0x3fd916(0x1e8)](temppath,{'withFileTypes':!![]})['forEach'](_0x14a972=>{const _0x329dc3=_0x3fd916;if(!_0x14a972['isDirectory']())fs[_0x329dc3(0x250)](temppath+_0x14a972['name']);}),logger[_0x3fd916(0x257)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x3fd916(0x31a)]({'restore':!![]},_0x61c62f=>{});}async function getPublicIp(){const _0x49b11a=_0x1f5a02;try{const _0x283e11=await axios['get']('https://api.ipify.org?format=json');publicip=_0x283e11[_0x49b11a(0x31e)]['ip'];}catch(_0x1ea5a2){}}async function triggerAnalytics(){const _0x5e7bb9=_0x1f5a02;if(!publicip)await getPublicIp();const _0x1b407d=getBotsWithMode();let _0x4b100e=0x0;_0x1b407d[_0x5e7bb9(0x291)](_0x1d6947=>{const _0x1d3e91=_0x5e7bb9;if(_0x1d6947[_0x1d3e91(0x384)]===_0x1d3e91(0x347))_0x4b100e++;});const _0x4badc0=getBotExchanges();mixpanel[_0x5e7bb9(0x353)]('Server',{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x1b407d[_0x5e7bb9(0x1be)],'numbotsenabled':_0x4b100e,'exchanges':_0x4badc0});}async function getMessages(){const _0x541437=_0x1f5a02,_0x2eacd4=_0x541437(0x1f1),_0x6514eb=new GraphQLClient(_0x2eacd4),_0x382e5d={'authorization':_0x541437(0x28f)},_0x570a30=serverversion[_0x541437(0x289)]('.'),_0x519e42=_0x570a30[0x0]+'.'+_0x570a30[0x1],_0xe46c07=Math[_0x541437(0x1fa)](settings[_0x541437(0x1e0)],settings[_0x541437(0x251)]),_0x5d0cf9={'last':parseInt(_0xe46c07),'bbm':_0x519e42},_0x56e89f=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x25eb8f;try{_0x25eb8f=await _0x6514eb['request'](_0x56e89f,_0x5d0cf9,_0x382e5d);}catch(_0x345168){}if(_0x25eb8f&&_0x25eb8f['messages']){let _0x358c91=settings[_0x541437(0x1e0)];newMessages=[];for(const _0x40b6c9 of _0x25eb8f[_0x541437(0x357)]){newMessages[_0x541437(0x38c)](_0x40b6c9);let _0x51e7d6=![];_0x40b6c9['bbvNew']&&(updateSetting(_0x541437(0x36a),_0x40b6c9['bbvNew']),_0x51e7d6=isNewerVersion(serverversion,_0x40b6c9[_0x541437(0x31c)])||serverversion==_0x40b6c9[_0x541437(0x31c)]);if(!_0x51e7d6&&_0x40b6c9['number']>_0x358c91){if(_0x40b6c9['bbvReceive']==='any'||serverversion[_0x541437(0x37c)](_0x40b6c9['bbvReceive'])){let _0x117831=''+_0x40b6c9[_0x541437(0x32d)]+'\x0a\x0a'+_0x40b6c9[_0x541437(0x339)];const _0x4e20cf=await sendTelegramMsg(toTelegramMarkdown(_0x117831),_0x541437(0x363));if(_0x4e20cf)_0x358c91=_0x40b6c9[_0x541437(0x26f)];}}}updateAvailable=isNewerVersion(settings[_0x541437(0x36a)],serverversion),updateSetting('lastmsgtelegram',_0x358c91),emitMessages();}}function emitMessages(){const _0x17fe84=_0x1f5a02,_0x230a6d=settings[_0x17fe84(0x251)];let _0x5de86d=[];newMessages[_0x17fe84(0x291)](_0x4ec692=>{const _0x30e8be=_0x17fe84;_0x4ec692[_0x30e8be(0x26f)]>_0x230a6d&&_0x5de86d[_0x30e8be(0x38c)](_0x4ec692);}),_0x5de86d[_0x17fe84(0x1be)]>0x0&&getAllClients()[_0x17fe84(0x291)](_0x4fc29e=>{const _0x49827d=_0x17fe84;getSocket(_0x4fc29e['id'])[_0x49827d(0x331)]('message',_0x5de86d);});}function confirmMessage(_0x26b363){const _0x24e785=_0x1f5a02;updateSetting(_0x24e785(0x251),Number(_0x26b363));}function isNewerVersion(_0x5a8d38,_0x5573ef){const _0x58f67a=_0x1f5a02,_0x14f316=_0x5573ef['split']('.'),_0xa7f5c0=_0x5a8d38[_0x58f67a(0x289)]('.');for(var _0x1a942c=0x0;_0x1a942c<_0xa7f5c0[_0x58f67a(0x1be)];_0x1a942c++){const _0x242d31=~~_0xa7f5c0[_0x1a942c],_0x4ad538=~~_0x14f316[_0x1a942c];if(_0x242d31>_0x4ad538)return!![];if(_0x242d31<_0x4ad538)return![];}return![];}function toTelegramMarkdown(_0x469e2e){const _0x364397=_0x1f5a02,_0x260d29=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3d397c=/\*{2}(.+?)\*{2}/gim;return _0x469e2e=_0x469e2e[_0x364397(0x1e2)](_0x260d29,'$1_$2_$3')[_0x364397(0x1e2)](_0x3d397c,'*$1*'),_0x469e2e;}async function validateConfigFile(){const _0x27988c=_0x1f5a02,_0x55c407=dbConfig[_0x27988c(0x349)](_0x27988c(0x2ac))['sortBy'](_0x27988c(0x2a5))[_0x27988c(0x223)]()||[];if(_0x55c407[_0x27988c(0x1be)]==0x0){let _0x44bc54=0x0,_0x1d47ed=[];const _0x3351c0=/^bot-([0-9]{3})-config.json$/,_0x3f3b1c=fs[_0x27988c(0x1e8)](configpath);_0x3f3b1c[_0x27988c(0x291)](_0x7c52ee=>{const _0x95d727=_0x27988c,_0x30f301=_0x3351c0[_0x95d727(0x343)](_0x7c52ee);if(_0x30f301){const _0x39f845=_0x30f301[0x1];let _0x257de4=getBotAttributes(_0x39f845);_0x1d47ed['push']({'botID':_0x39f845,'botname':_0x257de4['botname'],'status':_0x95d727(0x302),'live':'stopped'}),_0x44bc54++;}}),_0x44bc54!=0x0&&(dbConfig[_0x27988c(0x349)](_0x27988c(0x2ac))[_0x27988c(0x26a)](_0x1d47ed)[_0x27988c(0x1bc)](),config=_0x1d47ed,restoredConfigFile=_0x44bc54);}}async function restoreConfigNotify(_0x546b85){const _0x269f32=_0x1f5a02;let _0x13ca5c;if(restoredConfigFile==0x1)_0x13ca5c=_0x269f32(0x203);else _0x13ca5c=_0x269f32(0x385);if(_0x546b85)io['to'](_0x269f32(0x2a6))[_0x269f32(0x331)](_0x269f32(0x232),_0x13ca5c);else{logger[_0x269f32(0x2b3)](_0x269f32(0x202)),logger[_0x269f32(0x2b3)](_0x13ca5c),logger[_0x269f32(0x2b3)](_0x269f32(0x202)),logger['simple']('');if(tgBot&&settings[_0x269f32(0x1bb)]&&settings[_0x269f32(0x216)]!=_0x269f32(0x315))tgBot['sendMessage'](settings[_0x269f32(0x1bb)],_0x269f32(0x249)+_0x13ca5c)['catch'](_0x536399=>{telegramError(_0x536399);});}}function validateCredentials(_0x1102e7,_0x32ed3c){const _0xacaf68=_0x1f5a02;if(_0x1102e7[_0xacaf68(0x1de)]==settings[_0xacaf68(0x380)]&&bcrypt[_0xacaf68(0x1b9)](_0x1102e7[_0xacaf68(0x253)],settings[_0xacaf68(0x351)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0xacaf68(0x1eb),'token':null};else{const _0x54d876=generateLoginToken(_0x32ed3c);return{'allow':!![],'reason':_0xacaf68(0x337),'token':_0x54d876};}}else return{'allow':![],'reason':_0xacaf68(0x394),'token':null};}function refreshToken(_0x2df7e0){const _0x1766c0=_0x1f5a02,_0x4e1593=generateLoginToken(_0x2df7e0);return{'allow':!![],'reason':_0x1766c0(0x337),'token':_0x4e1593};}function validateAccess(_0x2c7b82,_0x279f5d,_0x11d51c){const _0xda2345=_0x1f5a02,_0x3b28cc=_0x11d51c?_0x11d51c:devices[_0x279f5d]['ip'];let _0x301be7;const _0xa91e5c=_0x3522ac=>{const _0x41df1c=_0x4978;if(settings[_0x41df1c(0x366)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x279f5d)){const _0x4f9aa9=generateLoginToken(_0x279f5d);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x4f9aa9};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x301be7=validToken(_0x3522ac,_0x279f5d),_0x301be7[_0x41df1c(0x34a)](_0x41df1c(0x2bc))?{'allow':!![],'reason':_0x41df1c(0x1e5),'token':_0x3522ac}:{'allow':![],'reason':_0x41df1c(0x31d),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0xda2345(0x1d5)]){let _0x207cdf=[...settings['whitelist'],_0xda2345(0x310),_0xda2345(0x2f7),'127.0.0.1'];if(_0x207cdf[_0xda2345(0x2eb)](_0x3b28cc))return _0xa91e5c(_0x2c7b82);else{_0x301be7=validToken(_0x2c7b82,_0x279f5d);if(_0x301be7['hasOwnProperty']('success'))return _0xa91e5c(_0x2c7b82);else{if(telegramIpApproved(_0x279f5d)){const _0x35cc0e=generateToken(_0x279f5d);return _0x301be7=_0xa91e5c(_0x2c7b82),_0x301be7[_0xda2345(0x311)]?{'allow':!![],'reason':_0xda2345(0x300),'token':_0x35cc0e}:_0x301be7;}else return settings[_0xda2345(0x1f3)]?{'allow':![],'reason':_0xda2345(0x2e2),'token':null}:{'allow':![],'reason':_0xda2345(0x330),'token':null};}}}else return _0xa91e5c(_0x2c7b82);}function timelyDecrypt(_0x10708e,_0x569add=!![]){const _0xaf64fd=_0x1f5a02;if(_0x10708e)try{const _0x3bd48f=crypt[_0xaf64fd(0x210)](secure[_0xaf64fd(0x26d)],_0x10708e)['message'],_0x4dc9a8=_0x3bd48f['split']('@')[0x0],_0x18a6df=_0x3bd48f[_0xaf64fd(0x289)]('@')[0x1],_0xecd6a2=new Date()[_0xaf64fd(0x1db)]();if(_0x569add){if(_0xecd6a2-_0x18a6df<maxSecretAge*0x3e8)return _0x4dc9a8;else return![];}else return _0x4dc9a8;}catch(_0x6f08cb){return![];}else return![];}const validToken=(_0x4c7fd3,_0x2f2e9c)=>{const _0x437cb1=_0x1f5a02,_0x191af6=devices[_0x2f2e9c]['ip'];if(!_0x4c7fd3)return{'error':_0x437cb1(0x37b)};for(let _0x215569 of blacklist){if(_0x215569[_0x437cb1(0x24b)]==_0x4c7fd3)return{'error':_0x437cb1(0x2b8)};}let _0x8943f5;try{_0x8943f5=jwt['verify'](_0x4c7fd3,secure['secret']+_0x2f2e9c);}catch{return{'error':_0x437cb1(0x355)};}if(!_0x8943f5[_0x437cb1(0x34a)](_0x437cb1(0x27c))&&!_0x8943f5[_0x437cb1(0x34a)](_0x437cb1(0x1de))||!_0x8943f5[_0x437cb1(0x34a)](_0x437cb1(0x2bf)))return{'error':_0x437cb1(0x313)};if(!_0x8943f5[_0x437cb1(0x34a)](_0x437cb1(0x1de))&&_0x8943f5[_0x437cb1(0x34a)](_0x437cb1(0x27c))){const {clientip:_0x3692ea}=_0x8943f5;return _0x191af6==_0x3692ea?{'success':_0x437cb1(0x1c4)}:{'error':_0x437cb1(0x2d3)};}else{if(_0x8943f5[_0x437cb1(0x34a)](_0x437cb1(0x1de))&&_0x8943f5['hasOwnProperty']('clientip')){const {username:_0x26cc1d,clientip:_0xd0832d}=_0x8943f5;return settings[_0x437cb1(0x380)]==_0x26cc1d&&_0x191af6==_0xd0832d?{'success':_0x437cb1(0x1c4)}:{'error':_0x437cb1(0x27b)};}}},generateLoginToken=_0x48f43e=>{const _0x10bb2a=_0x1f5a02;if(_0x48f43e){const _0x5a4337=devices[_0x48f43e]['ip'];return jwt[_0x10bb2a(0x1ff)]({'username':settings[_0x10bb2a(0x380)],'clientip':_0x5a4337},secure['secret']+_0x48f43e,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x40075e=>{const _0x2e18cc=_0x1f5a02;if(_0x40075e){const _0x21c4cb=devices[_0x40075e]['ip'];return jwt[_0x2e18cc(0x1ff)]({'clientip':_0x21c4cb},secure[_0x2e18cc(0x307)]+_0x40075e,{'expiresIn':devices[_0x40075e][_0x2e18cc(0x263)][_0x2e18cc(0x36c)]*0x3c});}else return![];},telegramIpApproved=_0xc6b338=>{const _0x488cce=_0x1f5a02;let _0x531207=![];return devices[_0xc6b338][_0x488cce(0x263)]&&devices[_0xc6b338][_0x488cce(0x263)]['expiry']!=_0x488cce(0x365)&&(_0x531207=devices[_0xc6b338][_0x488cce(0x263)][_0x488cce(0x27c)]==devices[_0xc6b338]['ip']&&new Date()[_0x488cce(0x1db)]()-devices[_0xc6b338][_0x488cce(0x263)]['timestamp']<devices[_0xc6b338][_0x488cce(0x263)]['expiry']*0x3c*0x3e8),_0x531207;},telegram2FaApproved=_0x5ce0d0=>{const _0x1c35c1=_0x1f5a02;let _0x3de341=![];return devices[_0x5ce0d0][_0x1c35c1(0x2c2)]&&devices[_0x5ce0d0][_0x1c35c1(0x2c2)][_0x1c35c1(0x36c)]!=_0x1c35c1(0x365)&&(_0x3de341=devices[_0x5ce0d0][_0x1c35c1(0x2c2)][_0x1c35c1(0x27c)]==devices[_0x5ce0d0]['ip']&&new Date()[_0x1c35c1(0x1db)]()-devices[_0x5ce0d0][_0x1c35c1(0x2c2)][_0x1c35c1(0x24f)]<devices[_0x5ce0d0]['telegram2FaApproval'][_0x1c35c1(0x36c)]*0x3c*0x3e8),_0x3de341;},normalizeIP=_0x36dddf=>{const _0x5eebd2=_0x1f5a02;let _0x5094ae=null,_0x451a59=null;if(ipaddr[_0x5eebd2(0x28e)](_0x36dddf)){const _0x11953b=ipaddr[_0x5eebd2(0x2b1)](_0x36dddf);_0x11953b[_0x5eebd2(0x224)]()===_0x5eebd2(0x326)?(_0x11953b[_0x5eebd2(0x30e)]()&&(_0x5094ae=_0x11953b['toIPv4Address']()[_0x5eebd2(0x20c)]()),_0x451a59=_0x11953b[_0x5eebd2(0x20c)]()):(_0x5094ae=_0x11953b[_0x5eebd2(0x20c)](),_0x451a59=_0x11953b[_0x5eebd2(0x2f5)]()['toString']());}return{'show':_0x5094ae?_0x5094ae:_0x451a59,'store':_0x451a59};};function formatDate(_0x40c779){const _0x16885d=_0x1f5a02;return _0x40c779['getFullYear']()+'/'+(_0x40c779[_0x16885d(0x22f)]()+0x1)[_0x16885d(0x20c)]()[_0x16885d(0x332)](0x2,'0')+'/'+_0x40c779[_0x16885d(0x2d7)]()[_0x16885d(0x20c)]()[_0x16885d(0x332)](0x2,'0')+'\x20'+_0x40c779['getHours']()[_0x16885d(0x20c)]()[_0x16885d(0x332)](0x2,'0')+':'+_0x40c779[_0x16885d(0x2aa)]()['toString']()[_0x16885d(0x332)](0x2,'0')+':'+_0x40c779[_0x16885d(0x248)]()[_0x16885d(0x20c)]()['padStart'](0x2,'0');}function sleep(_0x204af5){return new Promise(_0xc9b0d0=>setTimeout(_0xc9b0d0,_0x204af5));}