const _0x30e429=_0x487c;(function(_0x6ee63,_0x42341f){const _0x162411=_0x487c,_0x1b922e=_0x6ee63();while(!![]){try{const _0xd3147a=-parseInt(_0x162411(0x1c8))/0x1+-parseInt(_0x162411(0x187))/0x2*(-parseInt(_0x162411(0x11d))/0x3)+-parseInt(_0x162411(0x1c0))/0x4*(parseInt(_0x162411(0x208))/0x5)+parseInt(_0x162411(0x1b6))/0x6+-parseInt(_0x162411(0x14c))/0x7*(parseInt(_0x162411(0xf5))/0x8)+-parseInt(_0x162411(0x104))/0x9+-parseInt(_0x162411(0x12e))/0xa*(-parseInt(_0x162411(0x13d))/0xb);if(_0xd3147a===_0x42341f)break;else _0x1b922e['push'](_0x1b922e['shift']());}catch(_0x4ce46f){_0x1b922e['push'](_0x1b922e['shift']());}}}(_0xfd40,0x4aff0));const _0x1b2466=function(){let _0x5e63c8=!![];return function(_0x58aa2c,_0x4ecefd){const _0x55417c=_0x5e63c8?function(){const _0x5e100e=_0x487c;if(_0x4ecefd){const _0x2e3856=_0x4ecefd[_0x5e100e(0x194)](_0x58aa2c,arguments);return _0x4ecefd=null,_0x2e3856;}}:function(){};return _0x5e63c8=![],_0x55417c;};}(),_0x4489d2=_0x1b2466(this,function(){const _0xa2c9ba=_0x487c;return _0x4489d2[_0xa2c9ba(0xfd)]()[_0xa2c9ba(0x207)](_0xa2c9ba(0x102))[_0xa2c9ba(0xfd)]()[_0xa2c9ba(0x18a)](_0x4489d2)[_0xa2c9ba(0x207)](_0xa2c9ba(0x102));});_0x4489d2();'use strict';process[_0x30e429(0x17d)][_0x30e429(0x197)]=0x1;function _0xfd40(){const _0x2041d8=['temporaryAccessAllowed','sendMessage','randomFillSync','once','log','createServer','/:bot','Unauthorized\x20attempt\x20to\x20get\x20logs','44wBqcJc','getUTCHours','reload','2FA\x20login\x20token\x20generated','blacklist','isValid','crypto','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','518045fJlAcI','/enable\x20-\x20enable\x20notifications\x0a','add-bot','stopPolling','exit','argv','event','login\x20not\x20required','2FA\x20required','get-starting-balances','bb-settings.json','bbPassword','name','bcryptjs','orders','decrypt','send','headers','/status\x20-\x20show\x20bot(s)\x20status\x0a','get','ipaddr.js','SIGINT','store-settings','Notifications\x20types:\x20','inherit','store-headless','update-bot','push','restart','config/','Unauthorized\x20attempt\x20to\x20store\x20configuration','-results.json','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','socket.io','verify','botID','enabled','-config.json','live','Invalid\x20IP\x20address','</b>\x20?','removeListener','bots','404\x20Not\x20Found','Unauthorized\x20attempt\x20to\x20delete\x20bot','reject','idling\x20bot\x20\x20\x20|\x20Bot\x20','2FA\x20login\x20rejected','static','from','login\x20required','storeConfiguration','telegram','No\x20authentication\x20token','encryptedUuid','includes','hybrid-crypto-js','Balance\x20Bot\x20Server','All\x20bots','settings','getTime','match','order','search','187445IgjrzI',',\x20must\x20be\x20a\x204\x20digit\x20number','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','store-configuration','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','f2aRequired','onText','map','delete-bot','express','telegramIpApproval','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','/:bot/coins','build','Crypt','message','secure','started','analytics','/on\x20-\x20start\x20bot(s)\x0a','yes','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','No\x20bots\x20running\x20right\x20now','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','alerts','telegramEvents','restarting\x20Bot\x20','build2','port','store','lowdb/adapters/FileSync','/disable\x20-\x20disable\x20notifications\x0a','cloneDeep','toIPv4Address','access\x20timeout','Notifications\x20disabled','temporary\x20token\x20generated','kill','/restart\x20-\x20restart\x20bot(s)\x0a','allow','2FA','clientip','timeshift','defaults','127.0.0.1','bb/','uuid','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','5\x20min','Access\x20enabled\x20for\x20','invalid\x20credentials','catch','hasOwnProperty','HTML','publicKey','************','assign','::ffff:127.0.0.1','yargs/yargs','Invalid\x20authentication\x20token\x20(1)','bb-secure.json','-events.json','232uJalWw','Allow\x20login\x20from\x20IP\x20address\x20<b>','chat','<b>Balance\x20Bot\x20status:</b>\x0a','page','reason','mkdirSync','starting\x20bot\x20|\x20Bot\x20','toString','\x20>\x20','find','split','status','(((.+)+)+)+$','whitelist','631638MbCYWd','pidRefreshToken','telegramChatId','getMinutes','15\x20min','placeOrder','sockets','filter','node-telegram-bot-api','new-disabled','initclient','Balance\x20Bot','::1','accept','stop','slice','botmanager','Bot\x20','compareSync','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','disabled','2FA\x20login\x20required','get-portfolio','show','30\x20min','3QEHxjh','/:bot/history','Notifications\x20enabled\x0a','\x20/\x20','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','get-logs','Unauthorized\x20login\x20attempt\x20(timeout)','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Login\x20rejected','temporary\x20access\x20timeout','Unauthorized\x20attempt\x20to\x20update\x20bot','settings.','privateKey','secret','Notifications\x20enabled','logged\x20out','removeAllListeners','610HfnVJd','password','forEach','update-bb','deleted\x20Bot\x20','stopped','RSA','ipv6','host','Ok,\x20will\x20send\x20order\x20notifications\x20only','timestamp','Temporary\x20access\x20rejected','logout','handshake','Unauthorized\x20attempt\x20to\x20log\x20out','208252QIusut','referer','readdirSync','disabled\x20Bot\x20','/help\x20-\x20show\x20available\x20commands\x0a','padStart','You\x20can\x20use\x20the\x20following\x20commands:\x0a','emit','getStartingBalances','Ok,\x20will\x20send\x20alert\x20notifications\x20only','conn','getPortfolio','sortBy','sendFile','Unauthorized\x20login\x20attempt\x20(public\x20key)','100758EMstJC','sign','expiry','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','write','emitHistory','unlinkSync','getDate','test','running','Invalid\x20Telegram\x20token','getFullYear','answerCallbackQuery','\x20only\x0a','set','value','1000','isDirectory','path','args','User\x20has\x20been\x20validated','telegram2FaApproval','/:bot/support','/off\x20-\x20stop\x20bot(s)\x0a','user','token','then','place-order','getSeconds','callback_query','version.json','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','login\x20token\x20valid','getMonth','Unauthorized\x20attempt\x20to\x20update\x20settings','new','bbUsername','\x20minutes','whitelistEnabled','temporary\x20access\x20not\x20allowed','telegramToken','http','remove','-----------------------------------------------------------------------------------','Invalid\x20username\x20or\x20IP\x20address','keys','botname','/:bot/configuration','Error:\x20Invalid\x20argument\x20','env','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','login','reset-password','exp','default','listen','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Bot\x20Mgr\x20>\x20','loginRequired','91708NMvsIx','bb-config.json','-performance.json','constructor','pidExpireLogin','<b>Telegram\x20bot\x20status:</b>\x0a','telegramUsername','3000','type','\x20|\x20','all','existsSync','index.html','apply','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','temporary\x20access\x20rejected','NTBA_FIX_319','version','Token\x20blacklisted','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','apiKey','max','bot-','username','data','telegramEnabled','disconnect','bot','error\x20while\x20deleting\x20config\x20files:\x20','success','join','auth','getHours','generateKeyPairAsync','starting\x20new\x20bot\x20|\x20Bot\x20','ipc','length','RSA-OAEP','hashSync','polling_error','Unauthorized\x20attempt\x20to\x20add\x20bot','hex','date-fns','Password\x20reset\x20rejected','Password\x20has\x20been\x20reset\x20to:\x20','access','lowdb','3147060IOTYlc','Notifications\x20disabled\x0a'];_0xfd40=function(){return _0x2041d8;};return _0xfd40();}const childProcess=require('child_process'),FileSync=require(_0x30e429(0xd5)),fs=require('fs'),fns=require(_0x30e429(0x1b1)),low=require(_0x30e429(0x1b5)),path=require(_0x30e429(0x15e)),crypto=require(_0x30e429(0x1c6)),Crypt=require(_0x30e429(0x200))[_0x30e429(0x217)],RSA=require('hybrid-crypto-js')[_0x30e429(0x134)],bcrypt=require(_0x30e429(0x1d5)),jwt=require('jsonwebtoken'),analyticsLib=require(_0x30e429(0x21b))[_0x30e429(0x182)],googleAnalytics=require('@analytics/google-analytics')['default'],ipaddr=require(_0x30e429(0x1dc)),argv=require(_0x30e429(0xf1))(process['argv'][_0x30e429(0x113)](0x2))[_0x30e429(0x1cd)],PORT=argv[_0x30e429(0xd3)]||_0x30e429(0x18e),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x30e429(0x154)](PORT))return console[_0x30e429(0x1bc)](_0x30e429(0x17c)+PORT+_0x30e429(0x209)),process[_0x30e429(0x1cc)](0x1);const HOST=argv[_0x30e429(0x136)]||null,userID=argv[_0x30e429(0x164)]||'';let bbpath=_0x30e429(0xe4);const botfile='bot.js',configfile=_0x30e429(0x188),settingsfile=_0x30e429(0x1d2),securefile=_0x30e429(0xf3);!fs[_0x30e429(0x192)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath+'clients'),configpath=userID?bbpath+_0x30e429(0x1e5)+userID+'/':bbpath+_0x30e429(0x1e5),configbackuppath=configpath+'backup/';!fs[_0x30e429(0x192)](configpath)&&fs[_0x30e429(0xfb)](configpath);!fs[_0x30e429(0x192)](configbackuppath)&&fs[_0x30e429(0xfb)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x30e429(0xe2)]({'bots':[]})[_0x30e429(0x150)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x30e429(0xe2)]({'settings':{'timeshift':0x0}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x30e429(0xe2)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x30e429(0x1ac)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath+_0x30e429(0x16a))[_0x30e429(0x198)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require(_0x30e429(0x212)),app=express(),http=require(_0x30e429(0x175))[_0x30e429(0x1bd)](app);app['use'](express['static'](path['join'](__dirname,bbpath,_0x30e429(0xd2)))),app['use'](express[_0x30e429(0x1f8)](path[_0x30e429(0x1a5)](__dirname,bbpath,_0x30e429(0x216)))),app[_0x30e429(0x1db)]('/',function(_0x4ca6b8,_0x46604e){const _0x6abed3=_0x30e429;_0x46604e[_0x6abed3(0x14a)](path[_0x6abed3(0x1a5)](__dirname,bbpath,_0x6abed3(0xd2),_0x6abed3(0x193)));}),app[_0x30e429(0x1db)](_0x30e429(0x1be),function(_0x23f240,_0x9bcb35){const _0x1f15fd=_0x30e429;_0x9bcb35[_0x1f15fd(0x14a)](path[_0x1f15fd(0x1a5)](__dirname,bbpath,_0x1f15fd(0x216),_0x1f15fd(0x193)));}),app[_0x30e429(0x1db)]('/:bot/portfolio',(_0x1b9713,_0x158a8a)=>{const _0x73bf51=_0x30e429;_0x158a8a[_0x73bf51(0x14a)](path[_0x73bf51(0x1a5)](__dirname,bbpath,_0x73bf51(0x216),_0x73bf51(0x193)));}),app[_0x30e429(0x1db)]('/:bot/performance',(_0x21b591,_0x337d47)=>{const _0x77f8f4=_0x30e429;_0x337d47[_0x77f8f4(0x14a)](path['join'](__dirname,bbpath,'build',_0x77f8f4(0x193)));}),app[_0x30e429(0x1db)](_0x30e429(0x215),(_0x2deb14,_0x2d1923)=>{const _0x4d6d89=_0x30e429;_0x2d1923[_0x4d6d89(0x14a)](path[_0x4d6d89(0x1a5)](__dirname,bbpath,_0x4d6d89(0x216),'index.html'));}),app['get'](_0x30e429(0x11e),(_0x59729e,_0x5305e9)=>{const _0x4c99de=_0x30e429;_0x5305e9[_0x4c99de(0x14a)](path[_0x4c99de(0x1a5)](__dirname,bbpath,_0x4c99de(0x216),_0x4c99de(0x193)));}),app['get'](_0x30e429(0x17b),(_0x1e9094,_0x30c343)=>{const _0x48a883=_0x30e429;_0x30c343['sendFile'](path['join'](__dirname,bbpath,_0x48a883(0x216),_0x48a883(0x193)));}),app[_0x30e429(0x1db)](_0x30e429(0x162),(_0x11db20,_0x3ca823)=>{const _0x4bcd19=_0x30e429;_0x3ca823[_0x4bcd19(0x14a)](path[_0x4bcd19(0x1a5)](__dirname,bbpath,_0x4bcd19(0x216),_0x4bcd19(0x193)));});if(HOST)http[_0x30e429(0x183)](PORT,HOST);else http[_0x30e429(0x183)](PORT);const io=require(_0x30e429(0x1e9))(http,{}),analytics=analyticsLib({'app':_0x30e429(0x10f),'plugins':[googleAnalytics({'trackingId':'UA-192771731-1'})]}),TelegramBot=require(_0x30e429(0x10c));let tgBot;if(settings[_0x30e429(0x174)]&&settings[_0x30e429(0x174)]!=''&&settings[_0x30e429(0x18d)]&&settings[_0x30e429(0x18d)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x1508ba=_0x30e429;console[_0x1508ba(0x1bc)](''),console['log']('-----------------------------------------------------------------------------------'),logging(_0x1508ba(0x17e)+PORT),console[_0x1508ba(0x1bc)](_0x1508ba(0x177));if(config[_0x1508ba(0x1ab)]!=0x0)config[_0x1508ba(0x130)](_0x3618d9=>{const _0x2b15e1=_0x1508ba;if(_0x3618d9['status']=='enabled'||_0x3618d9['status']==_0x2b15e1(0x16f))logging(_0x2b15e1(0xfc)+_0x3618d9[_0x2b15e1(0x1eb)]+'\x20|\x20'+_0x3618d9['botname']),startBot([_0x3618d9[_0x2b15e1(0x1eb)],userID],{'cwd':bbpath},function(_0x54efbf){if(_0x54efbf)logging(_0x54efbf);});else(_0x3618d9[_0x2b15e1(0x101)]=='disabled'||_0x3618d9['status']==_0x2b15e1(0x10d))&&logging(_0x2b15e1(0x1f6)+_0x3618d9[_0x2b15e1(0x1eb)]+_0x2b15e1(0x190)+_0x3618d9['botname']);});else!newBot&&console[_0x1508ba(0x1bc)](_0x1508ba(0xe6));if(newBot)addBot();console[_0x1508ba(0x1bc)]('-----------------------------------------------------------------------------------'),console[_0x1508ba(0x1bc)]('');}function startSocket(){io['on']('connection',_0x1928a4=>{const _0x4b51f6=_0x487c;let _0x36567b,_0xe50413,_0x444b33,_0x575996,_0x326bf8;const _0xdf5ebc=_0x1928a4['handshake'][_0x4b51f6(0x1d9)][_0x4b51f6(0x13e)];_0xe50413=_0xdf5ebc[_0x4b51f6(0x205)](/bot[0-9]{3}/);if(_0xe50413)_0x444b33=_0xe50413[0x0][_0x4b51f6(0x205)](/[0-9]{3}/);if(_0x444b33)_0x36567b=_0x444b33[0x0];else _0x36567b=_0x4b51f6(0x114);const _0x678186=_0x1928a4[_0x4b51f6(0x13b)][_0x4b51f6(0x1a6)][_0x4b51f6(0x1fe)];if(!_0x678186)_0x1928a4[_0x4b51f6(0x144)](_0x4b51f6(0x101),{'publicKey':secure[_0x4b51f6(0xed)]});else{_0x575996=timelyDecrypt(_0x678186,![]);if(!_0x575996)logging(_0x4b51f6(0x14b));else{_0x326bf8=normalizeIP(_0x1928a4[_0x4b51f6(0x147)]['remoteAddress'])[_0x4b51f6(0xd4)];if(!devices[_0x575996])devices[_0x575996]={'uuid':_0x575996,'access':{'token':null}};devices[_0x575996]['ip']=_0x326bf8;const _0x2d8cbf=addClient(_0x1928a4['id'],_0x575996,_0x36567b);setAccess(_0x2d8cbf),_0x1928a4['on'](_0x4b51f6(0x17f),_0x332685=>{const _0x5d2355=_0x4b51f6,_0x5be4c1=timelyDecrypt(_0x332685[_0x5d2355(0x12f)]);if(_0x5be4c1){_0x332685={'username':_0x332685[_0x5d2355(0x19e)],'password':_0x5be4c1},devices[_0x575996][_0x5d2355(0x1b4)]=validateCredentials(_0x332685,_0x575996);if(devices[_0x575996]['access'][_0x5d2355(0xde)]==![]&&devices[_0x575996][_0x5d2355(0x1b4)]['reason']==_0x5d2355(0x119))_0x1928a4[_0x5d2355(0x144)](_0x5d2355(0x101),{'access':devices[_0x575996][_0x5d2355(0x1b4)]}),loginAccess2FA(_0x575996,_0x326bf8);else{if(devices[_0x575996][_0x5d2355(0x1b4)][_0x5d2355(0xde)]==![]&&devices[_0x575996]['access'][_0x5d2355(0xfa)]==_0x5d2355(0xe9))_0x1928a4['emit'](_0x5d2355(0x101),{'access':devices[_0x575996][_0x5d2355(0x1b4)]});else devices[_0x575996][_0x5d2355(0x1b4)][_0x5d2355(0xde)]&&devices[_0x575996][_0x5d2355(0x1b4)]['reason']=='login\x20token\x20generated'&&(getClientsWithUuid(_0x575996)[_0x5d2355(0x130)](_0x1d5fc3=>{setAccess(_0x1d5fc3);}),setTokenRefresh(_0x575996),setSessionTimeout('login',_0x575996));}}else logging(_0x5d2355(0x123));}),_0x1928a4['on'](_0x4b51f6(0x180),()=>{resetPassword();}),_0x1928a4['on'](_0x4b51f6(0x1a1),_0x1c9030=>{removeClient(_0x1928a4['id']);});}}});}function initClient(_0x34365b){const _0x5dfb42=_0x30e429;if(_0x34365b!=_0x5dfb42(0x114)&&config[_0x5dfb42(0x19b)]!=''){if(pid[_0x34365b])pid[_0x34365b][_0x5dfb42(0x1d8)]({'function':_0x5dfb42(0x10e),'args':null});}}function getSocket(_0x145231){const _0x3c7af7=_0x30e429;return io[_0x3c7af7(0x10a)][_0x3c7af7(0x10a)]['get'](_0x145231);}function setAccess(_0x31393b){const _0x278332=_0x30e429,_0x589429=getSocket(_0x31393b['id']),_0x59edef=_0x31393b[_0x278332(0xe5)],_0x26adb6=_0x31393b[_0x278332(0x1a2)];devices[_0x59edef]['access']=validateAccess(devices[_0x59edef][_0x278332(0x1b4)]['token'],_0x59edef),_0x589429[_0x278332(0x1a5)](_0x59edef);if(devices[_0x59edef][_0x278332(0x1b4)]['allow']){_0x589429[_0x278332(0x1a5)](_0x26adb6);if(_0x26adb6==_0x278332(0x114))initializeSocketBotManager(_0x589429);else initializeSocketBot(_0x589429);initClient(_0x26adb6);}devices[_0x59edef][_0x278332(0x1b4)][_0x278332(0x165)]&&devices[_0x59edef][_0x278332(0x1b4)][_0x278332(0xfa)]==_0x278332(0xdb)&&setSessionTimeout(_0x278332(0xdf),_0x59edef),devices[_0x59edef][_0x278332(0x1b4)][_0x278332(0x165)]&&devices[_0x59edef][_0x278332(0x1b4)][_0x278332(0xfa)]==_0x278332(0x1c3)&&setSessionTimeout(_0x278332(0x17f),_0x59edef),_0x589429[_0x278332(0x144)](_0x278332(0x101),{'status':_0x31393b['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x59edef][_0x278332(0x1b4)],'externalip':devices[_0x59edef]['ip'],'publicKey':secure[_0x278332(0xed)]}),devices[_0x59edef]['access'][_0x278332(0xde)]==![]&&devices[_0x59edef]['access']['reason']==_0x278332(0x1d0)&&temporaryAccess2FA(_0x59edef,devices[_0x59edef]['ip']);}function setSessionTimeout(_0x484710,_0x4206dd){const _0x435c24=_0x30e429;let _0x56ca0c;if(_0x484710=='login')_0x56ca0c=loginExpiry*0x3c*0x3e8;else _0x56ca0c=devices[_0x4206dd][_0x435c24(0x213)]['expiry']*0x3c*0x3e8-(new Date()[_0x435c24(0x204)]()-devices[_0x4206dd][_0x435c24(0x213)][_0x435c24(0x138)]);if(devices[_0x4206dd][_0x435c24(0x18b)])clearTimeout(devices[_0x4206dd][_0x435c24(0x18b)]);devices[_0x4206dd][_0x435c24(0x18b)]=setTimeout(()=>{const _0x4aba1b=_0x435c24;if(devices[_0x4206dd][_0x4aba1b(0x105)])clearTimeout(devices[_0x4206dd][_0x4aba1b(0x105)]);removeSocketListeners(_0x4206dd),addBlacklist(_0x4206dd),devices[_0x4206dd]['telegramIpApproval']=null,devices[_0x4206dd][_0x4aba1b(0x161)]=null,devices[_0x4206dd][_0x4aba1b(0x1b4)]['token']=null,devices[_0x4206dd]['access']=validateAccess(devices[_0x4206dd][_0x4aba1b(0x1b4)][_0x4aba1b(0x165)],_0x4206dd),!(devices[_0x4206dd][_0x4aba1b(0x1b4)][_0x4aba1b(0xde)]&&devices[_0x4206dd][_0x4aba1b(0x1b4)][_0x4aba1b(0xfa)]==_0x4aba1b(0x1cf))&&(_0x484710==_0x4aba1b(0x17f)?io['to'](_0x4206dd)[_0x4aba1b(0x144)](_0x4aba1b(0x101),{'access':{'allow':![],'reason':_0x4aba1b(0xd9),'token':null}}):io['to'](_0x4206dd)[_0x4aba1b(0x144)]('status',{'access':{'allow':![],'reason':_0x4aba1b(0x126),'token':null}})),devices[_0x4206dd][_0x4aba1b(0x1b4)]['token']=null;},_0x56ca0c);}function setTokenRefresh(_0x2a87e9){const _0x425043=_0x30e429;if(devices[_0x2a87e9][_0x425043(0x105)])clearTimeout(devices[_0x2a87e9]['pidRefreshToken']);devices[_0x2a87e9][_0x425043(0x105)]=setTimeout(()=>{const _0xe04e1a=_0x425043;getClientsWithUuid(_0x2a87e9)['length']!=0x0?(devices[_0x2a87e9][_0xe04e1a(0x1b4)]=refreshToken(_0x2a87e9),io['to'](_0x2a87e9)[_0xe04e1a(0x144)]('status',{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x2a87e9][_0xe04e1a(0x1b4)],'externalip':devices[_0x2a87e9]['ip'],'publicKey':secure['publicKey']}),setTokenRefresh(_0x2a87e9)):clearTimeout(devices[_0x2a87e9]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x39afc5){const _0x56cbbe=_0x30e429,_0x1f864c=getClient(_0x39afc5['id'])[_0x56cbbe(0xe5)];_0x39afc5['emit']('bots',config),_0x39afc5[_0x56cbbe(0x144)](_0x56cbbe(0x203),cleanSettings()),_0x39afc5['on'](_0x56cbbe(0x1ca),_0x1e2db5=>{const _0x1f6937=_0x56cbbe;if(validateAccess(_0x1e2db5,_0x1f864c)[_0x1f6937(0xde)])addBot();else logging(_0x1f6937(0x1af));}),_0x39afc5['on'](_0x56cbbe(0x1e2),(_0x49f536,_0x5b58ac)=>{const _0x10ee43=_0x56cbbe;if(validateAccess(_0x5b58ac,_0x1f864c)[_0x10ee43(0xde)])toggleBot(_0x49f536[_0x10ee43(0x1eb)],_0x49f536[_0x10ee43(0x101)],_0x49f536[_0x10ee43(0x1ee)]);else logging(_0x10ee43(0x127));}),_0x39afc5['on'](_0x56cbbe(0x211),(_0x3cf061,_0x190026)=>{const _0x408c92=_0x56cbbe;if(validateAccess(_0x190026,_0x1f864c)[_0x408c92(0xde)])deleteBot(_0x3cf061);else logging(_0x408c92(0x1f4));}),_0x39afc5['on'](_0x56cbbe(0x1de),(_0xe68a2c,_0x25c510)=>{if(validateAccess(_0x25c510,_0x1f864c)['allow'])storeSettings(_0xe68a2c,!![]);else logging('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x39afc5['on'](_0x56cbbe(0x131),(_0x3262a1,_0x4bf174)=>{const _0xc84edc=_0x56cbbe;if(validateAccess(_0x4bf174,_0x1f864c)[_0xc84edc(0xde)])updateBB();else logging(_0xc84edc(0x16e));}),_0x39afc5['on'](_0x56cbbe(0x13a),_0x5f0f40=>{const _0x3d2349=_0x56cbbe;if(validateAccess(_0x5f0f40,_0x1f864c)[_0x3d2349(0xde)]){if(devices[_0x1f864c][_0x3d2349(0x105)])clearTimeout(devices[_0x1f864c][_0x3d2349(0x105)]);if(devices[_0x1f864c][_0x3d2349(0x18b)])clearTimeout(devices[_0x1f864c]['pidExpireLogin']);removeSocketListeners(getClient(_0x39afc5['id'])[_0x3d2349(0xe5)]),addBlacklist(_0x1f864c),devices[_0x1f864c]['telegramIpApproval']=null,devices[_0x1f864c][_0x3d2349(0x161)]=null,devices[_0x1f864c][_0x3d2349(0x1b4)][_0x3d2349(0x165)]=null,io['to'](getClient(_0x39afc5['id'])[_0x3d2349(0xe5)])[_0x3d2349(0x144)]('status',{'access':{'allow':![],'reason':_0x3d2349(0x12c),'token':null}});}else logging(_0x3d2349(0x13c));});}function initializeSocketBot(_0x18df31){const _0x5eb292=_0x30e429,_0x5250bf=getClient(_0x18df31['id'])[_0x5eb292(0x1a2)],_0x5172aa=getClient(_0x18df31['id'])['uuid'];_0x18df31['on'](_0x5eb292(0x122),(_0x56f13b,_0x35f746)=>{const _0xae23e3=_0x5eb292;if(validateAccess(_0x35f746,_0x5172aa)[_0xae23e3(0xde)]){if(pid[_0x5250bf])pid[_0x5250bf][_0xae23e3(0x1d8)]({'function':_0xae23e3(0x151),'args':_0x56f13b});}else logging(_0xae23e3(0x1bf));}),_0x18df31['on'](_0x5eb292(0x11a),(_0x192840,_0xe299e0)=>{const _0x33b9f5=_0x5eb292;if(validateAccess(_0xe299e0,_0x5172aa)[_0x33b9f5(0xde)]){if(pid[_0x5250bf])pid[_0x5250bf][_0x33b9f5(0x1d8)]({'function':_0x33b9f5(0x148),'args':_0x192840});}else logging('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x18df31['on'](_0x5eb292(0x20c),(_0x325569,_0x5e575f)=>{const _0x1f3a9a=_0x5eb292;if(validateAccess(_0x5e575f,_0x5172aa)[_0x1f3a9a(0xde)]){if(pid[_0x5250bf])pid[_0x5250bf][_0x1f3a9a(0x1d8)]({'function':_0x1f3a9a(0x1fb),'args':_0x325569});}else logging(_0x1f3a9a(0x1e6));}),_0x18df31['on'](_0x5eb292(0x1e1),(_0x271650,_0x2806dc)=>{const _0x3cdc9d=_0x5eb292;if(validateAccess(_0x2806dc,_0x5172aa)['allow']){if(pid[_0x5250bf])pid[_0x5250bf][_0x3cdc9d(0x1d8)]({'function':'storeHeadless','args':_0x271650});}else logging('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x18df31['on'](_0x5eb292(0x1d1),_0x31ef17=>{const _0xb28551=_0x5eb292;if(validateAccess(_0x31ef17,_0x5172aa)[_0xb28551(0xde)]){if(pid[_0x5250bf])pid[_0x5250bf][_0xb28551(0x1d8)]({'function':_0xb28551(0x145),'args':null});}else logging(_0xb28551(0x184));}),_0x18df31['on'](_0x5eb292(0x167),(_0x2bf40f,_0x454d0c)=>{const _0x1ed42b=_0x5eb292;if(validateAccess(_0x454d0c,_0x5172aa)[_0x1ed42b(0xde)]){if(pid[_0x5250bf])pid[_0x5250bf]['send']({'function':_0x1ed42b(0x109),'args':_0x2bf40f});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x18df31['on']('cancel-loading',_0x390a05=>{const _0x13aea9=_0x5eb292;if(validateAccess(_0x390a05,_0x5172aa)[_0x13aea9(0xde)]){if(pid[_0x5250bf])pid[_0x5250bf][_0x13aea9(0x1d8)]({'function':'cancelLoading','args':null});}else logging(_0x13aea9(0x124));}),_0x18df31['on'](_0x5eb292(0x13a),_0x576716=>{const _0x464ef2=_0x5eb292;if(validateAccess(_0x576716,_0x5172aa)[_0x464ef2(0xde)]){if(devices[_0x5172aa][_0x464ef2(0x105)])clearTimeout(devices[_0x5172aa][_0x464ef2(0x105)]);if(devices[_0x5172aa]['pidExpireLogin'])clearTimeout(devices[_0x5172aa][_0x464ef2(0x18b)]);removeSocketListeners(getClient(_0x18df31['id'])['uuid']),addBlacklist(_0x5172aa),devices[_0x5172aa][_0x464ef2(0x213)]=null,devices[_0x5172aa]['telegram2FaApproval']=null,devices[_0x5172aa][_0x464ef2(0x1b4)][_0x464ef2(0x165)]=null,io['to'](getClient(_0x18df31['id'])[_0x464ef2(0xe5)])['emit']('status',{'access':{'allow':![],'reason':_0x464ef2(0x12c),'token':null}});}else logging(_0x464ef2(0x13c));});}function removeSocketListeners(_0x3f87fc){const _0x298697=_0x30e429;getClientsWithUuid(_0x3f87fc)[_0x298697(0x130)](_0x321bf0=>{const _0x17f00d=_0x298697;getSocket(_0x321bf0['id'])[_0x17f00d(0x12d)]();});}function cleanSettings(){const _0x1101aa=_0x30e429;let _0x42e9e5=settings;return settings[_0x1101aa(0x174)]&&settings['telegramToken']!=''&&(_0x42e9e5={..._0x42e9e5,'telegramToken':_0x1101aa(0xee)}),settings[_0x1101aa(0x1d3)]&&settings[_0x1101aa(0x1d3)]!=''&&(_0x42e9e5={..._0x42e9e5,'bbPassword':'************'}),_0x42e9e5;}function updateBB(){const _0x52462e=_0x30e429;process[_0x52462e(0x1d8)]({'update':!![]});}function startBot(_0x192dc0,_0xb00418,_0x5bf4b6){const _0xcb5cbb=_0x30e429;let _0x24ed35=![];const _0x3e702d=_0x192dc0[0x0];_0xb00418={..._0xb00418,'stdio':['inherit',_0xcb5cbb(0x1e0),_0xcb5cbb(0x1e0),_0xcb5cbb(0x1aa)]},pid[_0x3e702d]=childProcess['fork'](botfile,_0x192dc0,_0xb00418),pid[_0x3e702d]['on'](_0xcb5cbb(0x218),_0x12d5f4=>{const _0x5c6052=_0xcb5cbb;switch(Object[_0x5c6052(0x179)](_0x12d5f4)[0x0]){case _0x5c6052(0x17a):updateBotName(_0x3e702d,_0x12d5f4['botname']);break;case'status':updateStatus(_0x3e702d,_0x12d5f4[_0x5c6052(0x101)]);break;case _0x5c6052(0x1ee):updateLive(_0x3e702d,_0x12d5f4[_0x5c6052(0x1ee)]);break;case _0x5c6052(0x21a):updateLive(_0x3e702d,_0x12d5f4[_0x5c6052(0x21a)]),io['to'](_0x3e702d)[_0x5c6052(0x144)](_0x5c6052(0x101),{'access':{'allow':![],'reason':_0x5c6052(0x1c2),'token':null}});break;case _0x5c6052(0x112):_0x12d5f4[_0x5c6052(0x112)]==_0x5c6052(0x1e4)&&stopBot(_0x3e702d);_0x12d5f4[_0x5c6052(0x112)]==_0x5c6052(0xdc)&&toggleBot(_0x3e702d,_0x5c6052(0x118),_0x5c6052(0x133));break;case _0x5c6052(0x1fc):sendTelegram(_0x3e702d,_0x12d5f4['telegram']);break;case'function':io['to'](_0x3e702d)['emit'](_0x12d5f4['function'],_0x12d5f4[_0x5c6052(0x15f)]);break;}}),pid[_0x3e702d]['on']('error',function(_0x51ee76){if(_0x24ed35)return;_0x24ed35=!![],_0x5bf4b6(_0x51ee76);}),pid[_0x3e702d]['on'](_0xcb5cbb(0x1cc),function(_0x4c6db7){const _0x4b6ac5=_0xcb5cbb;if(_0x24ed35)return;_0x24ed35=!![],_0x5bf4b6(null);const _0x5bf660=dbConfig[_0x4b6ac5(0x1db)](_0x4b6ac5(0x1f2))[_0x4b6ac5(0xff)]({'botID':_0x3e702d})[_0x4b6ac5(0x15b)]();_0x5bf660&&(_0x5bf660[_0x4b6ac5(0x101)]==_0x4b6ac5(0x1ec)||_0x5bf660[_0x4b6ac5(0x101)]=='new')&&(updateLive(_0x3e702d,_0x4b6ac5(0x133)),logging(_0x4b6ac5(0xd1)+_0x3e702d),startBot([_0x3e702d,userID],{'cwd':bbpath},function(_0x5a3e20){if(_0x5a3e20)logging(_0x5a3e20);}));});}function stopBot(_0x388888){const _0x45e5f4=_0x30e429;getClientsWithBotID(_0x388888)['forEach'](_0x26beed=>{const _0x333f23=_0x487c;getSocket(_0x26beed['id'])[_0x333f23(0x1a1)](!![]),removeClient(_0x26beed['id']);});if(pid[_0x388888])pid[_0x388888][_0x45e5f4(0xdc)]();}function addBot(){const _0x301a89=_0x30e429;let _0x4d5638;for(let _0x5dbb84=0x1;_0x5dbb84<0x3e9;_0x5dbb84++){_0x4d5638=_0x5dbb84[_0x301a89(0xfd)]()[_0x301a89(0x142)](0x3,'0');let _0x39370f=config[_0x301a89(0xff)](_0x3f7484=>_0x3f7484[_0x301a89(0x1eb)]==_0x4d5638);if(!_0x39370f)break;}if(_0x4d5638===_0x301a89(0x15c)){logging(_0x301a89(0x21e));return;}logging(_0x301a89(0x1a9)+_0x4d5638),dbConfig[_0x301a89(0x1db)](_0x301a89(0x1f2))['push']({'botID':_0x4d5638,'botname':'Bot\x20'+_0x4d5638,'status':_0x301a89(0x16f),'live':''})[_0x301a89(0x150)](),startBot([_0x4d5638,userID],{'cwd':bbpath},function(_0x55e070){if(_0x55e070)logging(_0x55e070);}),config=getConfiguration(),io['to']('botmanager')['emit'](_0x301a89(0x1f2),config);}function deleteBot(_0x5de87a){const _0x15db5c=_0x30e429;getClientsWithBotID(_0x5de87a)[_0x15db5c(0x130)](_0x201cbb=>{getSocket(_0x201cbb['id'])['disconnect'](!![]),removeClient(_0x201cbb['id']);}),dbConfig[_0x15db5c(0x1db)](_0x15db5c(0x1f2))[_0x15db5c(0x176)]({'botID':_0x5de87a})['write'](),logging(_0x15db5c(0x132)+_0x5de87a),stopBot(_0x5de87a);try{fs[_0x15db5c(0x152)](path['join'](configpath,'bot-'+_0x5de87a+_0x15db5c(0x1ed))),fs[_0x15db5c(0x152)](path[_0x15db5c(0x1a5)](configpath,'bot-'+_0x5de87a+_0x15db5c(0xf4))),fs[_0x15db5c(0x152)](path['join'](configpath,_0x15db5c(0x19d)+_0x5de87a+_0x15db5c(0x189))),fs['unlinkSync'](path[_0x15db5c(0x1a5)](configpath,_0x15db5c(0x19d)+_0x5de87a+_0x15db5c(0x1e7)));}catch(_0x575e2f){if(_0x575e2f)logging(_0x15db5c(0x1a3),_0x575e2f);}config=getConfiguration(),io['to'](_0x15db5c(0x114))['emit']('bots',config);}function toggleBot(_0xc05d2c,_0x35376f,_0x56d06e){const _0x1d9a46=_0x30e429;dbConfig['get'](_0x1d9a46(0x1f2))[_0x1d9a46(0xff)]({'botID':_0xc05d2c})[_0x1d9a46(0xef)]({'status':_0x35376f})[_0x1d9a46(0xef)]({'live':_0x56d06e})[_0x1d9a46(0x150)]();if(_0x35376f==_0x1d9a46(0x1ec)||_0x35376f=='new')logging('enabled\x20Bot\x20'+_0xc05d2c),startBot([_0xc05d2c,userID],{'cwd':bbpath},function(_0x4ed12d){if(_0x4ed12d)logging(_0x4ed12d);});else(_0x35376f==_0x1d9a46(0x118)||_0x35376f=='new-disabled')&&(logging(_0x1d9a46(0x140)+_0xc05d2c),stopBot(_0xc05d2c));config=getConfiguration(),io['to'](_0x1d9a46(0x114))[_0x1d9a46(0x144)](_0x1d9a46(0x1f2),config);}function toggleStatus(_0x389aee){const _0x44f7ec=_0x30e429;let _0x26fd77=dbConfig[_0x44f7ec(0x1db)](_0x44f7ec(0x1f2))[_0x44f7ec(0xff)]({'botID':_0x389aee})[_0x44f7ec(0x15b)](),_0x2e8717;if(_0x26fd77['status']===_0x44f7ec(0x1ec))_0x2e8717=_0x44f7ec(0x118);else{if(_0x26fd77[_0x44f7ec(0x101)]==='new')_0x2e8717='new-disabled';else{if(_0x26fd77[_0x44f7ec(0x101)]===_0x44f7ec(0x10d))_0x2e8717=_0x44f7ec(0x16f);else{if(_0x26fd77[_0x44f7ec(0x101)]===_0x44f7ec(0x118))_0x2e8717='enabled';}}}return _0x2e8717;}function updateStatus(_0x348931,_0x299e92){const _0x584d1a=_0x30e429;dbConfig['get'](_0x584d1a(0x1f2))['find']({'botID':_0x348931})[_0x584d1a(0xef)]({'status':_0x299e92})[_0x584d1a(0x150)](),config=getConfiguration(),io['to'](_0x584d1a(0x114))['emit'](_0x584d1a(0x1f2),config);}function updateLive(_0x4fab67,_0x5b5307){const _0x17fc0f=_0x30e429;dbConfig[_0x17fc0f(0x1db)](_0x17fc0f(0x1f2))[_0x17fc0f(0xff)]({'botID':_0x4fab67})[_0x17fc0f(0xef)]({'live':_0x5b5307})[_0x17fc0f(0x150)](),config=getConfiguration(),io['to'](_0x17fc0f(0x114))[_0x17fc0f(0x144)](_0x17fc0f(0x1f2),config);}function updateBotName(_0x3aaca6,_0x468d94){const _0x44dc59=_0x30e429;dbConfig[_0x44dc59(0x1db)](_0x44dc59(0x1f2))[_0x44dc59(0xff)]({'botID':_0x3aaca6})[_0x44dc59(0xef)]({'botname':_0x468d94})['write'](),config=getConfiguration(),io['to'](_0x44dc59(0x114))[_0x44dc59(0x144)](_0x44dc59(0x1f2),config);}function telegramError(_0x5f2326){const _0x157d55=_0x30e429;console[_0x157d55(0x1bc)](getTimeStamp()+_0x157d55(0x20b));}function validateTelegram(_0x737bba){const _0x13900b=_0x30e429;if(_0x737bba[_0x13900b(0x1f9)][_0x13900b(0x19e)]!=settings[_0x13900b(0x18d)]&&'@'+_0x737bba[_0x13900b(0x1f9)][_0x13900b(0x19e)]!=settings[_0x13900b(0x18d)])return tgBot[_0x13900b(0x1b9)](_0x737bba[_0x13900b(0xf7)]['id'],_0x13900b(0x220),{'parse_mode':_0x13900b(0xec)})[_0x13900b(0xea)](_0xe23c81=>{telegramError(_0xe23c81);}),![];return!![];}async function initTelegram(){const _0x671f8d=_0x30e429;if(tgBot)tgBot[_0x671f8d(0x1cb)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x671f8d(0x174)],{'polling':!![]});let _0x80173c=_0x671f8d(0x143);_0x80173c+='\x0a',_0x80173c+=_0x671f8d(0x1c9),_0x80173c+=_0x671f8d(0xd6),_0x80173c+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x80173c+=_0x671f8d(0xdd),_0x80173c+=_0x671f8d(0x21c),_0x80173c+=_0x671f8d(0x163),_0x80173c+=_0x671f8d(0x1da),_0x80173c+=_0x671f8d(0x141);let _0xf55e0a=_0x671f8d(0x14f);_0xf55e0a+='\x0a',_0xf55e0a+=_0x80173c,tgBot[_0x671f8d(0x20f)](/\/start/,_0x5e27df=>{const _0x277725=_0x671f8d;if(!validateTelegram(_0x5e27df))return;if(settings[_0x277725(0x106)]!=_0x5e27df[_0x277725(0xf7)]['id'])updateSetting(_0x277725(0x106),_0x5e27df['chat']['id']);updateSetting(_0x277725(0x1a0),!![]),tgBot[_0x277725(0x1b9)](_0x5e27df[_0x277725(0xf7)]['id'],_0xf55e0a)[_0x277725(0xea)](_0x4df9b9=>{telegramError(_0x4df9b9);});}),tgBot['onText'](/\/enable/,_0xe85441=>{const _0x1330c2=_0x671f8d;if(!validateTelegram(_0xe85441))return;if(settings['telegramChatId']!=_0xe85441['chat']['id'])updateSetting(_0x1330c2(0x106),_0xe85441[_0x1330c2(0xf7)]['id']);updateSetting(_0x1330c2(0x1a0),!![]),tgBot['sendMessage'](_0xe85441['chat']['id'],_0x1330c2(0x12b))[_0x1330c2(0xea)](_0x49b9e4=>{telegramError(_0x49b9e4);});}),tgBot['onText'](/\/config/,async _0x160bf5=>{const _0x3f0cea=_0x671f8d;if(!validateTelegram(_0x160bf5))return;tgBot[_0x3f0cea(0x1f1)](_0x3f0cea(0x169)),tgBot[_0x3f0cea(0x1b9)](_0x160bf5['chat']['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x3f0cea(0x1d6)},{'text':'Alerts','callback_data':_0x3f0cea(0x221)},{'text':'All','callback_data':'all'}]]}})[_0x3f0cea(0xea)](_0x4ecc2d=>{telegramError(_0x4ecc2d);}),tgBot['on'](_0x3f0cea(0x169),async _0x328513=>{const _0xee7f59=_0x3f0cea,_0x56bdff=_0x328513[_0xee7f59(0x19f)],_0x30314e=_0x328513[_0xee7f59(0x218)];tgBot[_0xee7f59(0x158)](_0x328513['id'])[_0xee7f59(0x166)](async()=>{const _0x41bf95=_0xee7f59;_0x56bdff==_0x41bf95(0x1d6)&&(updateSetting(_0x41bf95(0x222),_0x41bf95(0x1d6)),updateSetting(_0x41bf95(0x1a0),!![]),await tgBot[_0x41bf95(0x1b9)](_0x30314e['chat']['id'],_0x41bf95(0x137))[_0x41bf95(0xea)](_0x398b41=>{telegramError(_0x398b41);}));_0x56bdff==_0x41bf95(0x221)&&(updateSetting(_0x41bf95(0x222),_0x41bf95(0x221)),updateSetting(_0x41bf95(0x1a0),!![]),await tgBot[_0x41bf95(0x1b9)](_0x30314e[_0x41bf95(0xf7)]['id'],_0x41bf95(0x146))['catch'](_0x11f949=>{telegramError(_0x11f949);}));_0x56bdff==_0x41bf95(0x191)&&(updateSetting('telegramEvents','all'),updateSetting('telegramEnabled',!![]),await tgBot[_0x41bf95(0x1b9)](_0x30314e[_0x41bf95(0xf7)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x41bf95(0xea)](_0x25c437=>{telegramError(_0x25c437);}));if(!settings[_0x41bf95(0x106)])tgBot['sendMessage'](_0x30314e[_0x41bf95(0xf7)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x41bf95(0xea)](_0x5c677b=>{telegramError(_0x5c677b);});}),tgBot['removeListener']('callback_query');});}),tgBot[_0x671f8d(0x20f)](/\/status/,_0x26885d=>{const _0x281b97=_0x671f8d;if(!validateTelegram(_0x26885d))return;let _0x389b72=_0x281b97(0xf8);config[_0x281b97(0x130)](_0x22c760=>{const _0x2fb232=_0x281b97;_0x389b72+='Bot\x20'+_0x22c760['botID']+_0x2fb232(0x190)+_0x22c760[_0x2fb232(0x17a)]+':\x20'+_0x22c760[_0x2fb232(0x101)]+_0x2fb232(0x120)+_0x22c760[_0x2fb232(0x1ee)]+'\x0a';}),_0x389b72+='\x0a',_0x389b72+=_0x281b97(0x18c),_0x389b72+=!settings['telegramEnabled']?_0x281b97(0x1b7):_0x281b97(0x11f),_0x389b72+=settings['telegramEnabled']?settings[_0x281b97(0x222)]=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x281b97(0x1df)+settings[_0x281b97(0x222)]+_0x281b97(0x159):'',tgBot[_0x281b97(0x1b9)](_0x26885d[_0x281b97(0xf7)]['id'],_0x389b72,{'parse_mode':'HTML'})[_0x281b97(0xea)](_0x24267e=>{telegramError(_0x24267e);});}),tgBot[_0x671f8d(0x20f)](/\/restart/,_0x261c7c=>{const _0x54916f=_0x671f8d;if(!validateTelegram(_0x261c7c))return;tgBot[_0x54916f(0x1f1)](_0x54916f(0x169));const _0x5a41e2=getEnabledBots();if(_0x5a41e2['length']==0x0)tgBot['sendMessage'](_0x261c7c[_0x54916f(0xf7)]['id'],_0x54916f(0x21f))[_0x54916f(0xea)](_0x2a9aba=>{telegramError(_0x2a9aba);});else{if(_0x5a41e2[_0x54916f(0x1ab)]>0x1)_0x5a41e2[_0x54916f(0x1e3)]({'botID':_0x54916f(0x191)});let _0x3a5759=[],_0x4fa9c1=[];const _0x21a340=_0x5a41e2['length']%0x4==0x0||_0x5a41e2[_0x54916f(0x1ab)]%0x4==0x3||_0x5a41e2[_0x54916f(0x1ab)]%0x3==0x1?0x4:0x3;let _0x6d8aab=0x0;_0x5a41e2['forEach']((_0x16921c,_0x4be6e7)=>{const _0x4a4850=_0x54916f;if(_0x4be6e7%_0x21a340==0x0)_0x4fa9c1=[];_0x4fa9c1['push']({'text':_0x16921c['botID']==_0x4a4850(0x191)?'All\x20bots':'Bot\x20'+_0x16921c[_0x4a4850(0x1eb)],'callback_data':_0x16921c[_0x4a4850(0x1eb)]}),_0x4be6e7%_0x21a340==0x0&&(_0x3a5759[_0x6d8aab]=_0x4fa9c1,_0x6d8aab++);}),tgBot[_0x54916f(0x1b9)](_0x261c7c[_0x54916f(0xf7)]['id'],_0x54916f(0x16b),{'reply_markup':{'inline_keyboard':_0x3a5759}})[_0x54916f(0xea)](_0x5ad201=>{telegramError(_0x5ad201);}),tgBot['on']('callback_query',async _0x2e92f6=>{const _0x265f78=_0x54916f,_0x582869=_0x2e92f6[_0x265f78(0x19f)],_0x1fc96e=_0x2e92f6['message'];tgBot['answerCallbackQuery'](_0x2e92f6['id'])[_0x265f78(0x166)](async()=>{const _0x5d284f=_0x265f78;if(_0x582869=='all'){if(settings['telegramEvents']==_0x5d284f(0x1d6))tgBot[_0x5d284f(0x1b9)](_0x1fc96e[_0x5d284f(0xf7)]['id'],_0x5d284f(0x19a))['catch'](_0x479a51=>{telegramError(_0x479a51);});config[_0x5d284f(0x130)](_0x2c5f00=>{const _0x2106d5=_0x5d284f;stopBot(_0x2c5f00[_0x2106d5(0x1eb)]);});}else{if(settings[_0x5d284f(0x222)]==_0x5d284f(0x1d6))tgBot[_0x5d284f(0x1b9)](_0x1fc96e[_0x5d284f(0xf7)]['id'],_0x5d284f(0x20d)+_0x582869)['catch'](_0x3bd23d=>{telegramError(_0x3bd23d);});stopBot(_0x582869);}}),tgBot[_0x265f78(0x1f1)]('callback_query');});}}),tgBot[_0x671f8d(0x20f)](/\/on/,_0x23f890=>{const _0x4c0c92=_0x671f8d;if(!validateTelegram(_0x23f890))return;tgBot[_0x4c0c92(0x1f1)]('callback_query');const _0x553e5b=getDisabledBots();if(_0x553e5b[_0x4c0c92(0x1ab)]==0x0)tgBot[_0x4c0c92(0x1b9)](_0x23f890['chat']['id'],'All\x20bots\x20running\x20right\x20now')[_0x4c0c92(0xea)](_0x47c4b1=>{telegramError(_0x47c4b1);});else{if(_0x553e5b[_0x4c0c92(0x1ab)]>0x1)_0x553e5b[_0x4c0c92(0x1e3)]({'botID':_0x4c0c92(0x191)});let _0x5b2fa9=[],_0x481bb0=[];const _0x2aee9a=_0x553e5b[_0x4c0c92(0x1ab)]%0x4==0x0||_0x553e5b[_0x4c0c92(0x1ab)]%0x4==0x3||_0x553e5b[_0x4c0c92(0x1ab)]%0x3==0x1?0x4:0x3;let _0x5730c0=0x0;_0x553e5b[_0x4c0c92(0x130)]((_0x3713e0,_0x38a03a)=>{const _0x31d2c4=_0x4c0c92;if(_0x38a03a%_0x2aee9a==0x0)_0x481bb0=[];_0x481bb0[_0x31d2c4(0x1e3)]({'text':_0x3713e0['botID']==_0x31d2c4(0x191)?_0x31d2c4(0x202):_0x31d2c4(0x115)+_0x3713e0[_0x31d2c4(0x1eb)],'callback_data':_0x3713e0[_0x31d2c4(0x1eb)]}),_0x38a03a%_0x2aee9a==0x0&&(_0x5b2fa9[_0x5730c0]=_0x481bb0,_0x5730c0++);}),tgBot[_0x4c0c92(0x1b9)](_0x23f890['chat']['id'],_0x4c0c92(0x195),{'reply_markup':{'inline_keyboard':_0x5b2fa9}})[_0x4c0c92(0xea)](_0x36bded=>{telegramError(_0x36bded);}),tgBot['on'](_0x4c0c92(0x169),async _0x1ef945=>{const _0x15aa6c=_0x4c0c92,_0x9dafc5=_0x1ef945[_0x15aa6c(0x19f)],_0x288c2c=_0x1ef945[_0x15aa6c(0x218)];tgBot['answerCallbackQuery'](_0x1ef945['id'])[_0x15aa6c(0x166)](async()=>{const _0x5105de=_0x15aa6c;if(_0x9dafc5==_0x5105de(0x191)){if(settings[_0x5105de(0x222)]==_0x5105de(0x1d6))tgBot[_0x5105de(0x1b9)](_0x288c2c[_0x5105de(0xf7)]['id'],_0x5105de(0x121))[_0x5105de(0xea)](_0x2e7fac=>{telegramError(_0x2e7fac);});_0x553e5b[_0x5105de(0x130)](_0x2f2e3f=>{const _0x39cd89=_0x5105de;if(_0x2f2e3f[_0x39cd89(0x1eb)]!='all')toggleBot(_0x2f2e3f[_0x39cd89(0x1eb)],toggleStatus(_0x2f2e3f['botID']),_0x39cd89(0x133));});}else{if(settings[_0x5105de(0x222)]==_0x5105de(0x1d6))tgBot[_0x5105de(0x1b9)](_0x288c2c[_0x5105de(0xf7)]['id'],_0x5105de(0x214)+_0x9dafc5)[_0x5105de(0xea)](_0x344e32=>{telegramError(_0x344e32);});toggleBot(_0x9dafc5,toggleStatus(_0x9dafc5),_0x5105de(0x133));}}),tgBot[_0x15aa6c(0x1f1)](_0x15aa6c(0x169));});}}),tgBot[_0x671f8d(0x20f)](/\/off/,_0x3b4c34=>{const _0x525f34=_0x671f8d;if(!validateTelegram(_0x3b4c34))return;tgBot['removeListener'](_0x525f34(0x169));const _0x2b437e=getEnabledBots();if(_0x2b437e['length']==0x0)tgBot[_0x525f34(0x1b9)](_0x3b4c34[_0x525f34(0xf7)]['id'],_0x525f34(0x21f))[_0x525f34(0xea)](_0x3180b2=>{telegramError(_0x3180b2);});else{if(_0x2b437e['length']>0x1)_0x2b437e[_0x525f34(0x1e3)]({'botID':_0x525f34(0x191)});let _0x3f73d7=[],_0xd35114=[];const _0x4a7ecf=_0x2b437e['length']%0x4==0x0||_0x2b437e['length']%0x4==0x3||_0x2b437e[_0x525f34(0x1ab)]%0x3==0x1?0x4:0x3;let _0x413615=0x0;_0x2b437e[_0x525f34(0x130)]((_0x34bb80,_0x45e929)=>{const _0xc71618=_0x525f34;if(_0x45e929%_0x4a7ecf==0x0)_0xd35114=[];_0xd35114[_0xc71618(0x1e3)]({'text':_0x34bb80[_0xc71618(0x1eb)]==_0xc71618(0x191)?_0xc71618(0x202):_0xc71618(0x115)+_0x34bb80['botID'],'callback_data':_0x34bb80[_0xc71618(0x1eb)]}),_0x45e929%_0x4a7ecf==0x0&&(_0x3f73d7[_0x413615]=_0xd35114,_0x413615++);}),tgBot['sendMessage'](_0x3b4c34[_0x525f34(0xf7)]['id'],_0x525f34(0x1e8),{'reply_markup':{'inline_keyboard':_0x3f73d7}})['catch'](_0x4dec50=>{telegramError(_0x4dec50);}),tgBot['on'](_0x525f34(0x169),async _0x1d42ef=>{const _0x2b543e=_0x525f34,_0x2ba396=_0x1d42ef[_0x2b543e(0x19f)],_0x444c73=_0x1d42ef[_0x2b543e(0x218)];tgBot[_0x2b543e(0x158)](_0x1d42ef['id'])['then'](async()=>{const _0x43002c=_0x2b543e;if(_0x2ba396==_0x43002c(0x191)){if(settings[_0x43002c(0x222)]==_0x43002c(0x1d6))tgBot['sendMessage'](_0x444c73[_0x43002c(0xf7)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')['catch'](_0x2c1eab=>{telegramError(_0x2c1eab);});_0x2b437e[_0x43002c(0x130)](_0x3f8710=>{const _0x17babc=_0x43002c;if(_0x3f8710[_0x17babc(0x1eb)]!=_0x17babc(0x191))toggleBot(_0x3f8710[_0x17babc(0x1eb)],toggleStatus(_0x3f8710[_0x17babc(0x1eb)]),_0x17babc(0x133));});}else{if(settings[_0x43002c(0x222)]==_0x43002c(0x1d6))tgBot['sendMessage'](_0x444c73[_0x43002c(0xf7)]['id'],_0x43002c(0x1c7)+_0x2ba396)[_0x43002c(0xea)](_0x3cd271=>{telegramError(_0x3cd271);});toggleBot(_0x2ba396,toggleStatus(_0x2ba396),_0x43002c(0x133));}}),tgBot[_0x2b543e(0x1f1)](_0x2b543e(0x169));});}}),tgBot[_0x671f8d(0x20f)](/\/disable/,_0xed0583=>{const _0x5286b1=_0x671f8d;if(!validateTelegram(_0xed0583))return;tgBot['sendMessage'](_0xed0583[_0x5286b1(0xf7)]['id'],_0x5286b1(0xda))[_0x5286b1(0xea)](_0x3f5b4b=>{telegramError(_0x3f5b4b);}),updateSetting(_0x5286b1(0x1a0),![]);}),tgBot[_0x671f8d(0x20f)](/\/help/,_0x2d6834=>{const _0x2aa05f=_0x671f8d;if(!validateTelegram(_0x2d6834))return;tgBot[_0x2aa05f(0x1b9)](_0x2d6834['chat']['id'],_0x80173c)['catch'](_0x4c2035=>{telegramError(_0x4c2035);});}),tgBot['on'](_0x671f8d(0x1ae),_0x3aaae1=>{const _0x1cf167=_0x671f8d;_0x3aaae1[_0x1cf167(0xfd)]()[_0x1cf167(0x1ff)](_0x1cf167(0x1f3))&&(logging(_0x1cf167(0x156)),tgBot[_0x1cf167(0x1cb)](),tgBot=null,io['to']('botmanager')[_0x1cf167(0x144)]('notification',_0x1cf167(0x156)));}),process[_0x671f8d(0x1bb)](_0x671f8d(0x1dd),()=>{const _0x45077d=_0x671f8d;if(tgBot)tgBot[_0x45077d(0x1cb)]();process[_0x45077d(0x1cc)](0x1);}),process[_0x671f8d(0x1bb)]('SIGTERM',()=>{const _0x5994eb=_0x671f8d;if(tgBot)tgBot[_0x5994eb(0x1cb)]();process[_0x5994eb(0x1cc)](0x1);});}}function disableTelegram(){const _0x26bd01=_0x30e429;tgBot&&(tgBot[_0x26bd01(0x1cb)](),tgBot=null);}function sendTelegram(_0x19d338,_0x3f10f6){const _0x37ce08=_0x30e429;if(settings[_0x37ce08(0x1a0)]){if(settings[_0x37ce08(0x222)]=='all'||(_0x3f10f6[_0x37ce08(0x18f)]=='error'||_0x3f10f6['type']==_0x37ce08(0x1a4))&&settings[_0x37ce08(0x222)]==_0x37ce08(0x221)||_0x3f10f6['type']==_0x37ce08(0x206)&&settings[_0x37ce08(0x222)]==_0x37ce08(0x1d6)){if(tgBot&&settings['telegramChatId']){if(_0x3f10f6['showname'])tgBot[_0x37ce08(0x1b9)](settings[_0x37ce08(0x106)],_0x3f10f6[_0x37ce08(0x17a)]+_0x37ce08(0xfe)+_0x3f10f6['event'])[_0x37ce08(0xea)](_0xd5a997=>{telegramError(_0xd5a997);});else tgBot['sendMessage'](settings[_0x37ce08(0x106)],_0x37ce08(0x115)+_0x19d338+'\x20>\x20'+_0x3f10f6[_0x37ce08(0x1ce)])['catch'](_0x3c8950=>{telegramError(_0x3c8950);});}}}}function getDeviceWithIp(_0x33b880){return devices['find'](_0x5f523d=>_0x5f523d['ip']===_0x33b880);}function temporaryAccess2FA(_0x1495ba,_0x379f33){const _0xebc238=_0x30e429;let _0x785113=new Date(),_0x244323=![];if(lastIpApproval){if(_0x785113-lastIpApproval<0x1388)_0x244323=!![];}lastIpApproval=new Date();if(_0x244323)return;tgBot&&settings[_0xebc238(0x106)]&&(tgBot[_0xebc238(0x1f1)](_0xebc238(0x169)),tgBot['sendMessage'](settings[_0xebc238(0x106)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x379f33)[_0xebc238(0x11b)]+_0xebc238(0x1f0),{'parse_mode':_0xebc238(0xec),'reply_markup':{'inline_keyboard':[[{'text':_0xebc238(0xe7),'callback_data':'5'},{'text':_0xebc238(0x108),'callback_data':'15'},{'text':_0xebc238(0x11c),'callback_data':'30'},{'text':_0xebc238(0x1f5),'callback_data':_0xebc238(0x1f5)}]]}})['catch'](_0x3501b0=>{telegramError(_0x3501b0);}),tgBot['on'](_0xebc238(0x169),async _0xadaebf=>{const _0x3f99f4=_0xebc238,_0x2d376b=_0xadaebf['data'],_0xc32e5f=_0xadaebf[_0x3f99f4(0x218)];tgBot[_0x3f99f4(0x158)](_0xadaebf['id'])[_0x3f99f4(0x166)](async()=>{const _0x17b46c=_0x3f99f4;devices[_0x1495ba][_0x17b46c(0x213)]={'clientip':_0x379f33,'timestamp':new Date()[_0x17b46c(0x204)](),'expiry':_0x2d376b},_0x2d376b!='reject'?(await tgBot[_0x17b46c(0x1b9)](_0xc32e5f[_0x17b46c(0xf7)]['id'],_0x17b46c(0xe8)+_0x2d376b+_0x17b46c(0x171),{'parse_mode':'HTML'})[_0x17b46c(0xea)](_0x369cfc=>{telegramError(_0x369cfc);}),io['to'](_0x1495ba)[_0x17b46c(0x144)](_0x17b46c(0x101),{'access':{'allow':![],'reason':_0x17b46c(0x1c2),'token':null}})):(await tgBot[_0x17b46c(0x1b9)](_0xc32e5f[_0x17b46c(0xf7)]['id'],_0x17b46c(0x139))['catch'](_0x459238=>{telegramError(_0x459238);}),io['to'](_0x1495ba)[_0x17b46c(0x144)](_0x17b46c(0x101),{'access':{'allow':![],'reason':_0x17b46c(0x196),'token':null}}));}),tgBot[_0x3f99f4(0x1f1)](_0x3f99f4(0x169));}));}function loginAccess2FA(_0xe5bb58,_0x3cd580){const _0x183307=_0x30e429;tgBot&&settings[_0x183307(0x106)]&&(tgBot[_0x183307(0x1f1)](_0x183307(0x169)),tgBot['sendMessage'](settings[_0x183307(0x106)],_0x183307(0xf6)+normalizeIP(_0x3cd580)[_0x183307(0x11b)]+_0x183307(0x1f0),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x183307(0x111),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x183307(0x1f5)}]]}})[_0x183307(0xea)](_0xef918c=>{telegramError(_0xef918c);}),tgBot['on'](_0x183307(0x169),async _0x225ca5=>{const _0x5ef6ef=_0x183307,_0x52daac=_0x225ca5[_0x5ef6ef(0x19f)],_0x213540=_0x225ca5['message'];tgBot[_0x5ef6ef(0x158)](_0x225ca5['id'])['then'](async()=>{const _0x179e84=_0x5ef6ef;devices[_0xe5bb58][_0x179e84(0x161)]={'clientip':_0x3cd580,'timestamp':new Date()[_0x179e84(0x204)](),'expiry':_0x52daac},_0x52daac!=_0x179e84(0x1f5)?(await tgBot[_0x179e84(0x1b9)](_0x213540[_0x179e84(0xf7)]['id'],'Login\x20accepted',{'parse_mode':_0x179e84(0xec)})[_0x179e84(0xea)](_0x132229=>{telegramError(_0x132229);}),io['to'](_0xe5bb58)[_0x179e84(0x144)](_0x179e84(0x101),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x179e84(0x1b9)](_0x213540['chat']['id'],_0x179e84(0x125))['catch'](_0x2db3f2=>{telegramError(_0x2db3f2);}),io['to'](_0xe5bb58)[_0x179e84(0x144)]('status',{'access':{'allow':![],'reason':_0x179e84(0x1f7),'token':null}}));}),tgBot[_0x5ef6ef(0x1f1)](_0x5ef6ef(0x169));}));}function getConfiguration(){const _0x536f67=_0x30e429;return dbConfig[_0x536f67(0x1db)](_0x536f67(0x1f2))[_0x536f67(0x149)](_0x536f67(0x1eb))['value']()||[];}function getEnabledBots(){const _0x24af31=_0x30e429;return dbConfig[_0x24af31(0x1db)]('bots')[_0x24af31(0x149)](_0x24af31(0x1eb))[_0x24af31(0x10b)]({'status':_0x24af31(0x1ec)})[_0x24af31(0x15b)]()||[];}function getDisabledBots(){const _0x34e52d=_0x30e429;return dbConfig[_0x34e52d(0x1db)]('bots')['sortBy'](_0x34e52d(0x1eb))[_0x34e52d(0x10b)]({'status':_0x34e52d(0x118)})[_0x34e52d(0x15b)]()||[];}function getSettings(){const _0xef7551=_0x30e429;return dbSettings[_0xef7551(0x1db)](_0xef7551(0x203))[_0xef7551(0x15b)]()||{'timeshift':0x0};}function getSecure(){const _0x216d71=_0x30e429;return dbSecure[_0x216d71(0x1db)](_0x216d71(0x219))['value']()||{};}function getBlacklist(){const _0x3724fa=_0x30e429;return dbSecure[_0x3724fa(0x1db)](_0x3724fa(0x1c4))['value']()||[];}function broadcastToBots(_0xb7cf4a,_0x1029d0){const _0x29daf0=_0x30e429;config[_0x29daf0(0x130)](_0x9700c8=>{const _0x1ab975=_0x29daf0;if(_0x9700c8[_0x1ab975(0x101)]==_0x1ab975(0x1ec)&&_0x9700c8[_0x1ab975(0x1ee)]==_0x1ab975(0x155)){if(pid[_0x9700c8[_0x1ab975(0x1eb)]])pid[_0x9700c8[_0x1ab975(0x1eb)]][_0x1ab975(0x1d8)]({[_0xb7cf4a]:_0x1029d0});}});}function _0x487c(_0x5063fd,_0x67ed6c){const _0xab8282=_0xfd40();return _0x487c=function(_0x4489d2,_0x1b2466){_0x4489d2=_0x4489d2-0xd1;let _0xfd4019=_0xab8282[_0x4489d2];return _0xfd4019;},_0x487c(_0x5063fd,_0x67ed6c);}function storeSettings(_0xa8638e,_0x2ce967=![]){const _0x59e7e5=_0x30e429;_0xa8638e={...settings,..._0xa8638e};if(_0x2ce967&&_0xa8638e[_0x59e7e5(0x1d3)]!=_0x59e7e5(0xee)&&_0xa8638e[_0x59e7e5(0x1d3)]!=''){const _0x48e0b9=crypt[_0x59e7e5(0x1d7)](secure[_0x59e7e5(0x129)],_0xa8638e[_0x59e7e5(0x1d3)])['message'][_0x59e7e5(0x100)]('@')[0x0],_0x3775ba=bcrypt[_0x59e7e5(0x1ad)](_0x48e0b9,saltRounds);_0xa8638e={..._0xa8638e,'bbPassword':_0x3775ba};}if(_0x2ce967&&_0xa8638e[_0x59e7e5(0x174)]!=_0x59e7e5(0xee)&&_0xa8638e[_0x59e7e5(0x174)]!=''){const _0x597457=crypt[_0x59e7e5(0x1d7)](secure[_0x59e7e5(0x129)],_0xa8638e['telegramToken'])[_0x59e7e5(0x218)][_0x59e7e5(0x100)]('@')[0x0];_0xa8638e={..._0xa8638e,'telegramToken':_0x597457};}const _0x412754=_0xa8638e[_0x59e7e5(0x174)]!='************'&&_0xa8638e['telegramToken']!=settings[_0x59e7e5(0x174)]||_0xa8638e['telegramUsername']!=settings['telegramUsername'],_0x217033=_0xa8638e[_0x59e7e5(0x174)]==''||_0xa8638e[_0x59e7e5(0x18d)]=='';if(_0x412754)_0xa8638e[_0x59e7e5(0x222)]=_0x59e7e5(0x191);for(const [_0x220a25,_0x2dc199]of Object['entries'](_0xa8638e)){if(_0x220a25==_0x59e7e5(0x174)&&_0x2dc199==_0x59e7e5(0xee)){_0xa8638e[_0x59e7e5(0x174)]=settings[_0x59e7e5(0x174)];continue;};if(_0x220a25==_0x59e7e5(0x1d3)&&_0x2dc199==_0x59e7e5(0xee)){_0xa8638e['bbPassword']=settings['bbPassword'];continue;};dbSettings[_0x59e7e5(0x15a)]('settings.'+_0x220a25,_0x2dc199)['write']();}settings=_0xa8638e,io['to'](_0x59e7e5(0x114))[_0x59e7e5(0x144)]('settings',cleanSettings()),broadcastToBots('timeshift',settings[_0x59e7e5(0xe1)]);if(_0x412754&&!_0x217033)initTelegram();if(_0x412754&&_0x217033)disableTelegram();getAllClients()['forEach'](_0x5f5844=>{const _0x3ff606=_0x59e7e5;getSocket(_0x5f5844['id'])[_0x3ff606(0x144)](_0x3ff606(0x101),{'access':{'allow':![],'reason':_0x3ff606(0x1c2),'token':null}});});}function updateSetting(_0xb2bb2b,_0x98e47f){const _0x4cdcac=_0x30e429;dbSettings[_0x4cdcac(0x15a)](_0x4cdcac(0x128)+_0xb2bb2b,_0x98e47f)[_0x4cdcac(0x150)](),settings=getSettings(),io['to'](_0x4cdcac(0x114))['emit'](_0x4cdcac(0x203),cleanSettings());}function storeSecure(_0x5b3dcd){const _0x2426e1=_0x30e429;dbSecure[_0x2426e1(0x1db)]('secure')[_0x2426e1(0x1e3)](_0x5b3dcd)['write'](),secure=_0x5b3dcd;}function addBlacklist(_0x9c7e5b){const _0xea29b5=_0x30e429;cleanBlacklist();let _0x341e88;devices[_0x9c7e5b]['telegramIpApproval']?_0x341e88=Math[_0xea29b5(0x19c)](devices[_0x9c7e5b]['telegramIpApproval'][_0xea29b5(0x14e)],loginExpiry):_0x341e88=loginExpiry,dbSecure[_0xea29b5(0x1db)](_0xea29b5(0x1c4))[_0xea29b5(0x1e3)]({'expiry':new Date()[_0xea29b5(0x204)]()+_0x341e88*0x3c*0x3e8,'token':devices[_0x9c7e5b]['access']['token']})['write'](),blacklist=dbSecure[_0xea29b5(0x1db)]('blacklist')[_0xea29b5(0x15b)]();}function cleanBlacklist(){const _0x4c2f25=_0x30e429;let _0x2869f0=dbSecure[_0x4c2f25(0x1db)](_0x4c2f25(0x1c4))[_0x4c2f25(0xd7)]()[_0x4c2f25(0x15b)](),_0x3e173f=new Date()[_0x4c2f25(0x204)]();_0x2869f0['forEach'](_0x190733=>{const _0x1d4c9d=_0x4c2f25;_0x190733['expiry']<_0x3e173f&&dbSecure['get']('blacklist')['remove']({'expiry':_0x190733[_0x1d4c9d(0x14e)]})[_0x1d4c9d(0x150)]();});}function initStates(){const _0x1f4c89=_0x30e429;let _0x4631af=getConfiguration();_0x4631af[_0x1f4c89(0x130)](_0x5f0d63=>{const _0x2cc096=_0x1f4c89;_0x5f0d63[_0x2cc096(0x1ee)]=_0x2cc096(0x133);}),storeConfiguration(_0x4631af);}function onKeys(){const _0x1004c4=new RSA();return new Promise(_0x439024=>{const _0x131607=_0x487c;_0x1004c4[_0x131607(0x1a8)]()[_0x131607(0x166)](_0x47179e=>{_0x439024(_0x47179e);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2a0618=_0x30e429;let _0x442380=getConfiguration(),_0x3ef907=![];_0x442380[_0x2a0618(0x130)](_0x36902c=>{const _0x456a0b=_0x2a0618;if(_0x36902c[_0x456a0b(0x101)]=='running')_0x36902c[_0x456a0b(0x101)]='enabled',_0x3ef907=!![];else _0x36902c[_0x456a0b(0x101)]==_0x456a0b(0x133)&&(_0x36902c[_0x456a0b(0x101)]=_0x456a0b(0x118),_0x3ef907=!![]);});if(_0x3ef907)storeConfiguration(_0x442380);let _0x3e7251=getSecure();if(!_0x3e7251['hasOwnProperty'](_0x2a0618(0x12a))){let _0xb2acc3=await generateKeys();_0x3e7251[_0x2a0618(0xed)]=_0xb2acc3[_0x2a0618(0xed)],_0x3e7251['privateKey']=_0xb2acc3['privateKey'],_0x3e7251[_0x2a0618(0x12a)]=crypto['randomBytes'](0x20)['toString'](_0x2a0618(0x1b0));;storeSecure(_0x3e7251);}let _0x79a893=getSettings();_0x3ef907=![];!_0x79a893[_0x2a0618(0xeb)](_0x2a0618(0x186))&&(_0x79a893['loginRequired']=![],_0x79a893[_0x2a0618(0x170)]='',_0x79a893['bbPassword']='',_0x79a893[_0x2a0618(0x20e)]=![],_0x3ef907=!![]);!_0x79a893[_0x2a0618(0xeb)]('whitelistEnabled')&&(_0x79a893[_0x2a0618(0x172)]=![],_0x79a893[_0x2a0618(0x103)]=[],_0x79a893['temporaryAccessAllowed']=![],_0x3ef907=!![]);if(!_0x79a893[_0x2a0618(0xeb)](_0x2a0618(0x1a0))){if(_0x79a893[_0x2a0618(0x106)])_0x79a893[_0x2a0618(0x1a0)]=!![];else _0x79a893[_0x2a0618(0x1a0)]=![];_0x3ef907=!![];}if(_0x3ef907)storeSettings(_0x79a893);}function storeConfiguration(_0x2f0d6d){const _0x143d3c=_0x30e429;dbConfig['get'](_0x143d3c(0x1f2))[_0x143d3c(0x176)]()[_0x143d3c(0x150)](),dbConfig[_0x143d3c(0x1db)](_0x143d3c(0x1f2))[_0x143d3c(0x1e3)](..._0x2f0d6d)[_0x143d3c(0x150)](),config=_0x2f0d6d;}function resetPassword(){const _0x5565a1=_0x30e429;tgBot&&settings['telegramChatId']&&(tgBot[_0x5565a1(0x1f1)](_0x5565a1(0x169)),tgBot[_0x5565a1(0x1b9)](settings['telegramChatId'],_0x5565a1(0x117),{'parse_mode':_0x5565a1(0xec),'reply_markup':{'inline_keyboard':[[{'text':_0x5565a1(0x21d),'callback_data':_0x5565a1(0x21d)},{'text':'no','callback_data':'no'}]]}})['catch'](_0xa77859=>{telegramError(_0xa77859);}),tgBot['on'](_0x5565a1(0x169),async _0x42efad=>{const _0x2cff1d=_0x5565a1,_0x40b361=_0x42efad[_0x2cff1d(0x19f)],_0x38ed80=_0x42efad['message'];tgBot[_0x2cff1d(0x158)](_0x42efad['id'])[_0x2cff1d(0x166)](async()=>{const _0x47f49c=_0x2cff1d;if(_0x40b361!='no'){const _0x1d9c74=0xf,_0x3e6f40=_0x47f49c(0x20a),_0x281935=Array[_0x47f49c(0x1f9)](crypto[_0x47f49c(0x1ba)](new Uint32Array(_0x1d9c74)))[_0x47f49c(0x210)](_0x3d63c8=>_0x3e6f40[_0x3d63c8%_0x3e6f40[_0x47f49c(0x1ab)]])['join'](''),_0x1121a3=bcrypt[_0x47f49c(0x1ad)](_0x281935,saltRounds);storeSettings({'bbPassword':_0x1121a3}),await tgBot['sendMessage'](_0x38ed80[_0x47f49c(0xf7)]['id'],_0x47f49c(0x1b3)+_0x281935,{'parse_mode':_0x47f49c(0xec)})['catch'](_0x165640=>{telegramError(_0x165640);});}else await tgBot[_0x47f49c(0x1b9)](_0x38ed80[_0x47f49c(0xf7)]['id'],_0x47f49c(0x1b2))[_0x47f49c(0xea)](_0x27fd00=>{telegramError(_0x27fd00);});}),tgBot[_0x2cff1d(0x1f1)](_0x2cff1d(0x169));}));}function logging(_0x2c0b1e){const _0x5f1d42=_0x30e429;console['log'](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x2c0b1e);if(tgBot&&settings['telegramChatId']&&settings[_0x5f1d42(0x222)]!=_0x5f1d42(0x1d6))tgBot['sendMessage'](settings[_0x5f1d42(0x106)],_0x5f1d42(0x185)+_0x2c0b1e)[_0x5f1d42(0xea)](_0x410ed1=>{telegramError(_0x410ed1);});}function getServerTime(){const _0x208d29=_0x30e429,_0x162127=new Date();return _0x162127[_0x208d29(0x157)]()+'/'+(_0x162127[_0x208d29(0x16d)]()+0x1)[_0x208d29(0xfd)]()['padStart'](0x2,'0')+'/'+_0x162127[_0x208d29(0x153)]()['toString']()[_0x208d29(0x142)](0x2,'0')+'\x20'+_0x162127['getHours']()['toString']()[_0x208d29(0x142)](0x2,'0')+':'+_0x162127[_0x208d29(0x107)]()[_0x208d29(0xfd)]()[_0x208d29(0x142)](0x2,'0')+':'+_0x162127[_0x208d29(0x168)]()[_0x208d29(0xfd)]()[_0x208d29(0x142)](0x2,'0');}function getTimeStamp(){const _0x360123=_0x30e429,_0x39e8b3=shiftedTime();return _0x39e8b3['getFullYear']()+'/'+(_0x39e8b3[_0x360123(0x16d)]()+0x1)[_0x360123(0xfd)]()['padStart'](0x2,'0')+'/'+_0x39e8b3[_0x360123(0x153)]()[_0x360123(0xfd)]()[_0x360123(0x142)](0x2,'0')+'\x20'+_0x39e8b3[_0x360123(0x1a7)]()[_0x360123(0xfd)]()[_0x360123(0x142)](0x2,'0')+':'+_0x39e8b3[_0x360123(0x107)]()['toString']()['padStart'](0x2,'0')+':'+_0x39e8b3[_0x360123(0x168)]()['toString']()[_0x360123(0x142)](0x2,'0');}function shiftedTime(){const _0x455639=_0x30e429,_0xe8de56=new Date();let _0xc3592a=_0xe8de56;if(settings[_0x455639(0xe1)]&&settings[_0x455639(0xe1)]!==0x0)_0xc3592a=fns['add'](_0xe8de56,{'hours':settings[_0x455639(0xe1)]});return _0xc3592a;}function startScheduler(){const _0x3a72f8=_0x30e429;let _0x36792a=new Date()[_0x3a72f8(0x1c1)]();_0x36792a==0x1&&backupConfigFiles();_0x36792a==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x4c6c6b=_0x30e429;fs[_0x4c6c6b(0x13f)](configpath,{'withFileTypes':!![]})[_0x4c6c6b(0x130)](_0x4603cd=>{const _0x5e80a8=_0x4c6c6b;if(!_0x4603cd[_0x5e80a8(0x15d)]())fs['copyFileSync'](configpath+_0x4603cd[_0x5e80a8(0x1d4)],configbackuppath+_0x4603cd[_0x5e80a8(0x1d4)]);});}function triggerAnalytics(){const _0x11d31f=_0x30e429;analytics[_0x11d31f(0xf9)]({'title':_0x11d31f(0x201),'href':'https://hodlerhacks.com','path':'/v'+serverversion});}function validateCredentials(_0x48db41,_0x537b8a){const _0x30aa65=_0x30e429;if(_0x48db41['username']==settings[_0x30aa65(0x170)]&&bcrypt[_0x30aa65(0x116)](_0x48db41[_0x30aa65(0x12f)],settings[_0x30aa65(0x1d3)])){if(settings[_0x30aa65(0x20e)])return{'allow':![],'reason':_0x30aa65(0x119),'token':null};else{const _0x1d1d58=generateLoginToken(_0x537b8a);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x1d1d58};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x30a0c5){const _0x297cc7=generateLoginToken(_0x30a0c5);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x297cc7};}function validateAccess(_0x197dbc,_0x1c17ba){const _0xf5c251=_0x30e429;let _0x3bc819=devices[_0x1c17ba]['ip'],_0x4bdd07;const _0x33962b=_0x3bc118=>{const _0x3dfcdb=_0x487c;if(settings['loginRequired']){if(settings[_0x3dfcdb(0x20e)]){if(telegram2FaApproved(_0x1c17ba)){const _0x2b21fe=generateLoginToken(_0x1c17ba);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x2b21fe};}else return{'allow':![],'reason':_0x3dfcdb(0x1fa),'token':null};}else return _0x4bdd07=validToken(_0x3bc118,_0x1c17ba),_0x4bdd07[_0x3dfcdb(0xeb)](_0x3dfcdb(0x1a4))?{'allow':!![],'reason':_0x3dfcdb(0x16c),'token':_0x3bc118}:{'allow':![],'reason':_0x3dfcdb(0x1fa),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings['whitelistEnabled']){let _0x568e85=[...settings[_0xf5c251(0x103)],_0xf5c251(0x110),_0xf5c251(0xf0),_0xf5c251(0xe3)];if(_0x568e85[_0xf5c251(0x1ff)](_0x3bc819))return _0x33962b(_0x197dbc);else{_0x4bdd07=validToken(_0x197dbc,_0x1c17ba);if(_0x4bdd07[_0xf5c251(0xeb)](_0xf5c251(0x1a4)))return _0x33962b(_0x197dbc);else{if(telegramIpApproved(_0x1c17ba)){const _0x44b4c0=generateToken(_0x1c17ba);return _0x4bdd07=_0x33962b(_0x197dbc),_0x4bdd07[_0xf5c251(0xde)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x44b4c0}:_0x4bdd07;}else return settings[_0xf5c251(0x1b8)]?{'allow':![],'reason':_0xf5c251(0x1d0),'token':null}:{'allow':![],'reason':_0xf5c251(0x173),'token':null};}}}else return _0x33962b(_0x197dbc);}function timelyDecrypt(_0x479a95,_0x4ae4e0=!![]){const _0x1086a3=_0x30e429;if(_0x479a95)try{const _0x3b75a4=crypt[_0x1086a3(0x1d7)](secure['privateKey'],_0x479a95)[_0x1086a3(0x218)],_0x272f19=_0x3b75a4[_0x1086a3(0x100)]('@')[0x0],_0x2f298e=_0x3b75a4[_0x1086a3(0x100)]('@')[0x1],_0x483405=new Date()[_0x1086a3(0x204)]();if(_0x4ae4e0){if(_0x483405-_0x2f298e<maxSecretAge*0x3e8)return _0x272f19;else return![];}else return _0x272f19;}catch(_0x503e9e){return![];}else return![];}const validToken=(_0x6a9c2d,_0x111758)=>{const _0x4209f0=_0x30e429,_0x55e7b8=devices[_0x111758]['ip'];if(!_0x6a9c2d)return{'error':_0x4209f0(0x1fd)};for(let _0x401c66 of blacklist){if(_0x401c66[_0x4209f0(0x165)]==_0x6a9c2d)return{'error':_0x4209f0(0x199)};}let _0x4b7ae3;try{_0x4b7ae3=jwt[_0x4209f0(0x1ea)](_0x6a9c2d,secure[_0x4209f0(0x12a)]+_0x111758);}catch{return{'error':_0x4209f0(0xf2)};}if(!_0x4b7ae3[_0x4209f0(0xeb)](_0x4209f0(0xe0))&&!_0x4b7ae3[_0x4209f0(0xeb)](_0x4209f0(0x19e))||!_0x4b7ae3[_0x4209f0(0xeb)](_0x4209f0(0x181)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x4b7ae3[_0x4209f0(0xeb)](_0x4209f0(0x19e))&&_0x4b7ae3['hasOwnProperty']('clientip')){const {clientip:_0x14ccfd}=_0x4b7ae3;return _0x55e7b8==_0x14ccfd?{'success':_0x4209f0(0x160)}:{'error':_0x4209f0(0x1ef)};}else{if(_0x4b7ae3[_0x4209f0(0xeb)](_0x4209f0(0x19e))&&_0x4b7ae3[_0x4209f0(0xeb)](_0x4209f0(0xe0))){const {username:_0x1dcb3e,clientip:_0x5cf1c6}=_0x4b7ae3;return settings[_0x4209f0(0x170)]==_0x1dcb3e&&_0x55e7b8==_0x5cf1c6?{'success':_0x4209f0(0x160)}:{'error':_0x4209f0(0x178)};}}},generateLoginToken=_0x222a5b=>{const _0x4d7e5a=_0x30e429;if(_0x222a5b){const _0x28726d=devices[_0x222a5b]['ip'];return jwt['sign']({'username':settings[_0x4d7e5a(0x170)],'clientip':_0x28726d},secure[_0x4d7e5a(0x12a)]+_0x222a5b,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x2e5978=>{const _0x145e79=_0x30e429;if(_0x2e5978){const _0xd41da0=devices[_0x2e5978]['ip'];return jwt[_0x145e79(0x14d)]({'clientip':_0xd41da0},secure[_0x145e79(0x12a)]+_0x2e5978,{'expiresIn':devices[_0x2e5978][_0x145e79(0x213)][_0x145e79(0x14e)]*0x3c});}else return![];},telegramIpApproved=_0x2ef006=>{const _0x4ed36c=_0x30e429;let _0x7af13c=![];return devices[_0x2ef006][_0x4ed36c(0x213)]&&devices[_0x2ef006][_0x4ed36c(0x213)][_0x4ed36c(0x14e)]!=_0x4ed36c(0x1f5)&&(_0x7af13c=devices[_0x2ef006][_0x4ed36c(0x213)][_0x4ed36c(0xe0)]==devices[_0x2ef006]['ip']&&new Date()[_0x4ed36c(0x204)]()-devices[_0x2ef006][_0x4ed36c(0x213)][_0x4ed36c(0x138)]<devices[_0x2ef006][_0x4ed36c(0x213)][_0x4ed36c(0x14e)]*0x3c*0x3e8),_0x7af13c;},telegram2FaApproved=_0x202ed7=>{const _0x56b015=_0x30e429;let _0x2a878c=![];return devices[_0x202ed7][_0x56b015(0x161)]&&devices[_0x202ed7][_0x56b015(0x161)][_0x56b015(0x14e)]!=_0x56b015(0x1f5)&&(_0x2a878c=devices[_0x202ed7][_0x56b015(0x161)][_0x56b015(0xe0)]==devices[_0x202ed7]['ip']&&new Date()[_0x56b015(0x204)]()-devices[_0x202ed7][_0x56b015(0x161)][_0x56b015(0x138)]<devices[_0x202ed7][_0x56b015(0x161)][_0x56b015(0x14e)]*0x3c*0x3e8),_0x2a878c;},normalizeIP=_0x48fe73=>{const _0x3e410a=_0x30e429;let _0x2f2fdb=null,_0x51a8ef=null;if(ipaddr[_0x3e410a(0x1c5)](_0x48fe73)){const _0x471536=ipaddr['parse'](_0x48fe73);_0x471536['kind']()===_0x3e410a(0x135)?(_0x471536['isIPv4MappedAddress']()&&(_0x2f2fdb=_0x471536[_0x3e410a(0xd8)]()['toString']()),_0x51a8ef=_0x471536[_0x3e410a(0xfd)]()):(_0x2f2fdb=_0x471536[_0x3e410a(0xfd)](),_0x51a8ef=_0x471536['toIPv4MappedAddress']()[_0x3e410a(0xfd)]());}return{'show':_0x2f2fdb?_0x2f2fdb:_0x51a8ef,'store':_0x51a8ef};};