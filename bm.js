const _0x418aae=_0x3d72;(function(_0x5a02a0,_0x50e553){const _0x39e03c=_0x3d72,_0x15c2ab=_0x5a02a0();while(!![]){try{const _0xddfb83=parseInt(_0x39e03c(0x326))/0x1*(-parseInt(_0x39e03c(0x2f8))/0x2)+parseInt(_0x39e03c(0x2b0))/0x3*(parseInt(_0x39e03c(0x22d))/0x4)+-parseInt(_0x39e03c(0x1fd))/0x5*(-parseInt(_0x39e03c(0x1fe))/0x6)+parseInt(_0x39e03c(0x212))/0x7+-parseInt(_0x39e03c(0x310))/0x8+-parseInt(_0x39e03c(0x28a))/0x9*(parseInt(_0x39e03c(0x2b9))/0xa)+parseInt(_0x39e03c(0x27a))/0xb*(-parseInt(_0x39e03c(0x27c))/0xc);if(_0xddfb83===_0x50e553)break;else _0x15c2ab['push'](_0x15c2ab['shift']());}catch(_0x337d13){_0x15c2ab['push'](_0x15c2ab['shift']());}}}(_0x4cc0,0xe9591));const _0x23c7a3=function(){let _0x2a4a6b=!![];return function(_0x21c7bc,_0x3f9bd5){const _0x19826c=_0x2a4a6b?function(){const _0x115cdc=_0x3d72;if(_0x3f9bd5){const _0x348ae3=_0x3f9bd5[_0x115cdc(0x300)](_0x21c7bc,arguments);return _0x3f9bd5=null,_0x348ae3;}}:function(){};return _0x2a4a6b=![],_0x19826c;};}(),_0x322205=_0x23c7a3(this,function(){const _0x362f6b=_0x3d72;return _0x322205['toString']()['search'](_0x362f6b(0x1fc))[_0x362f6b(0x26e)]()[_0x362f6b(0x231)](_0x322205)[_0x362f6b(0x302)](_0x362f6b(0x1fc));});_0x322205();'use strict';process[_0x418aae(0x305)][_0x418aae(0x30f)]=0x1;const childProcess=require(_0x418aae(0x1ea)),FileSync=require(_0x418aae(0x2f2)),fs=require('fs'),fns=require(_0x418aae(0x2f4)),low=require(_0x418aae(0x25c)),path=require('path'),crypto=require(_0x418aae(0x237)),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require('hybrid-crypto-js')[_0x418aae(0x26c)],bcrypt=require('bcryptjs'),jwt=require(_0x418aae(0x2a3)),analyticsLib=require('analytics')[_0x418aae(0x206)],googleAnalytics=require(_0x418aae(0x261))['default'],ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process[_0x418aae(0x2fd)][_0x418aae(0x316)](0x2))[_0x418aae(0x2fd)],PORT=argv[_0x418aae(0x2a8)]||'3000',pattern=/^[0-9]{2,4}$/;if(!pattern[_0x418aae(0x2a6)](PORT))return console[_0x418aae(0x31e)](_0x418aae(0x2bd)+PORT+_0x418aae(0x311)),process[_0x418aae(0x25f)](0x1);const HOST=argv[_0x418aae(0x242)]||null,userID=argv[_0x418aae(0x2ed)]||'';let bbpath='bb/',bbpath2='';const botfile='bot.js',configfile=_0x418aae(0x1f3),settingsfile=_0x418aae(0x249),securefile='bb-secure.json';let validInstallation=!![];!fs[_0x418aae(0x25a)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x418aae(0x2e1)),configpath=userID?bbpath+_0x418aae(0x276)+userID+'/':bbpath+_0x418aae(0x276),configbackuppath=configpath+_0x418aae(0x285);!fs['existsSync'](configpath)&&fs[_0x418aae(0x331)](configpath);!fs[_0x418aae(0x25a)](configbackuppath)&&fs[_0x418aae(0x331)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x418aae(0x254)]({'bots':[]})[_0x418aae(0x224)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x418aae(0x254)]({'settings':{'timeshift':0x0}})[_0x418aae(0x224)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x418aae(0x254)]({'secure':{},'blacklist':[]})[_0x418aae(0x224)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x418aae(0x32a)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x418aae(0x30e))[_0x418aae(0x332)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];oneTimeMigration(),cleanBlacklist();const express=require(_0x418aae(0x28f)),app=express(),http=require(_0x418aae(0x309))[_0x418aae(0x263)](app);app[_0x418aae(0x260)](express['static'](path['join'](__dirname,bbpath2,'build2'))),app[_0x418aae(0x260)](express[_0x418aae(0x209)](path[_0x418aae(0x313)](__dirname,bbpath2,_0x418aae(0x22f)))),app['get']('/',function(_0x462248,_0x2c1821){const _0x2b930d=_0x418aae;_0x2c1821[_0x2b930d(0x2ef)](path[_0x2b930d(0x313)](__dirname,bbpath2,_0x2b930d(0x205),_0x2b930d(0x1ef)));}),app[_0x418aae(0x2f6)](_0x418aae(0x287),function(_0x504a70,_0x20cbda){const _0x54f1a9=_0x418aae;_0x20cbda[_0x54f1a9(0x2ef)](path[_0x54f1a9(0x313)](__dirname,bbpath2,_0x54f1a9(0x22f),'index.html'));}),app[_0x418aae(0x2f6)](_0x418aae(0x2cd),(_0x20297c,_0x21f9ce)=>{const _0x5972cc=_0x418aae;_0x21f9ce[_0x5972cc(0x2ef)](path[_0x5972cc(0x313)](__dirname,bbpath2,'build',_0x5972cc(0x1ef)));}),app[_0x418aae(0x2f6)](_0x418aae(0x2ae),(_0x6aff41,_0x55b391)=>{const _0x1a6e20=_0x418aae;_0x55b391[_0x1a6e20(0x2ef)](path[_0x1a6e20(0x313)](__dirname,bbpath2,_0x1a6e20(0x22f),_0x1a6e20(0x1ef)));}),app[_0x418aae(0x2f6)](_0x418aae(0x2e9),(_0x57c751,_0x24a980)=>{const _0x389da6=_0x418aae;_0x24a980[_0x389da6(0x2ef)](path['join'](__dirname,bbpath2,'build','index.html'));}),app[_0x418aae(0x2f6)](_0x418aae(0x2e0),(_0xe1e6e6,_0x2d4f56)=>{const _0x2445d3=_0x418aae;_0x2d4f56[_0x2445d3(0x2ef)](path[_0x2445d3(0x313)](__dirname,bbpath2,_0x2445d3(0x22f),'index.html'));}),app[_0x418aae(0x2f6)](_0x418aae(0x281),(_0x7347d2,_0x6a794b)=>{const _0x5e5999=_0x418aae;_0x6a794b[_0x5e5999(0x2ef)](path[_0x5e5999(0x313)](__dirname,bbpath2,'build',_0x5e5999(0x1ef)));}),app[_0x418aae(0x2f6)](_0x418aae(0x32e),(_0x5bea9a,_0x2aea94)=>{const _0x6e5f0b=_0x418aae;_0x2aea94[_0x6e5f0b(0x2ef)](path['join'](__dirname,bbpath2,_0x6e5f0b(0x22f),_0x6e5f0b(0x1ef)));});if(HOST)http[_0x418aae(0x324)](PORT,HOST);else http[_0x418aae(0x324)](PORT);const io=require(_0x418aae(0x2d8))(http,{}),analytics=analyticsLib({'app':_0x418aae(0x292),'plugins':[googleAnalytics({'trackingId':_0x418aae(0x20d)})]}),TelegramBot=require(_0x418aae(0x22e));let tgBot;if(settings['telegramToken']&&settings['telegramToken']!=''&&settings[_0x418aae(0x230)]&&settings['telegramUsername']!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function _0x4cc0(){const _0x496f4b=['message','deleteHistoryAlerts','temporary\x20token\x20generated','user','publicKey','sendFile','User\x20has\x20been\x20validated','/help\x20-\x20show\x20available\x20commands\x0a','lowdb/adapters/FileSync','Token\x20blacklisted','date-fns','store','get','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','118ZNkxMe','remove','orders','access','order','argv','idling\x20bot\x20\x20\x20|\x20Bot\x20','data','apply','keys','search','hashSync','push','env','event','\x20>\x20','All\x20bots','http','copyFileSync','stopped','login\x20required','expiry','version.json','NTBA_FIX_319','2465936Hstnda',',\x20must\x20be\x20a\x204\x20digit\x20number','stop','join','placeOrder','telegram2FaApproval','slice','isDirectory','reload','Unauthorized\x20attempt\x20to\x20delete\x20alerts','starting\x20bot\x20|\x20Bot\x20','toIPv4MappedAddress','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','<b>Balance\x20Bot\x20status:</b>\x0a','log','all','SIGTERM','timeshift','accept','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','listen','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','1353XlRLJz','isValid','reason','removeAllListeners','RSA-OAEP','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','show','sockets','/:bot/support','storeConfiguration','5\x20min','mkdirSync','version','Access\x20enabled\x20for\x20','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','child_process','15\x20min','get-logs','Ok,\x20will\x20send\x20alert\x20notifications\x20only','alerts','index.html','pidRefreshToken','bot','parse','bb-config.json','botID','Notifications\x20enabled','blacklist','password','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','/enable\x20-\x20enable\x20notifications\x0a','randomBytes','cancelLoading','(((.+)+)+)+$','25LMKici','2240106fKkXir','toIPv4Address','telegramIpApproval','live','2FA\x20login\x20rejected','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','allow','build2','default','botmanager','storeHeadless','static','-results.json','reject','from','UA-192771731-1','uuid','delete-alerts','Bot\x20Mgr\x20>\x20','reset-password','1653848CExmtk','Invalid\x20IP\x20address','sign','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','loginRequired','assign','bbPassword','sortBy','new','answerCallbackQuery','All\x20bots\x20running\x20right\x20now','started','timestamp','login\x20token\x20generated','getMinutes','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Password\x20reset\x20rejected','2FA\x20login\x20token\x20generated','write','then','getFullYear','filter','new-disabled','SIGINT','login','chat','invalid\x20credentials','3112MjtEAN','node-telegram-bot-api','build','telegramUsername','constructor','set','hasOwnProperty','Password\x20has\x20been\x20reset\x20to:\x20','-----------------------------------------------------------------------------------','referer','crypto','handshake','includes','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','HTML',':\x20Bot\x20Mgr\x20>\x20','ipc','fork','whitelist','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','update-bot','host','Unauthorized\x20attempt\x20to\x20get\x20portfolio','login\x20token\x20valid','exp','Notifications\x20disabled\x0a','getUTCHours','You\x20can\x20use\x20the\x20following\x20commands:\x0a','bb-settings.json','initclient','telegram','getTime','https://hodlerhacks.com','bots','pidExpireLogin','temporary\x20access\x20timeout','************','login\x20not\x20required','once','defaults','No\x20bots\x20running\x20right\x20now','logged\x20out','cloneDeep','settings','telegramEnabled','existsSync','showname','lowdb','remoteAddress','getSeconds','exit','use','@analytics/google-analytics','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','createServer','match','/restart\x20-\x20restart\x20bot(s)\x0a','-config.json','connected','starting\x20new\x20bot\x20|\x20Bot\x20','ipv6','stopPolling','place-order','RSA','onText','toString','get-portfolio','whitelistEnabled','logout','removeListener','notification','bot-','Bot\x20','config/','Unauthorized\x20attempt\x20to\x20log\x20out','1000','callback_query','5479925qNOtlu',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','12wsrpXf','No\x20authentication\x20token','max','30\x20min','name','/:bot/configuration','success','Ok,\x20will\x20send\x20order\x20notifications\x20only','\x20minutes','backup/','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','/:bot','get-starting-balances','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','6648066UKCmOL','settings.','f2aRequired','temporaryAccessAllowed','telegramChatId','express','enabled','Unauthorized\x20login\x20attempt\x20(timeout)','Balance\x20Bot','find','botname','encryptedUuid','username','function','Invalid\x20username\x20or\x20IP\x20address','disabled\x20Bot\x20','args','kind','\x20|\x20','getHours','store-settings','catch','</b>\x20?','127.0.0.1','kill','jsonwebtoken','store-headless','disconnect','test','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','port','\x20only\x0a','add-bot','inherit','2FA\x20required','send','/:bot/performance','running','1842mnqQmA','clientip','privateKey','forEach','Invalid\x20authentication\x20token\x20(2)','delete-bot','disabled','telegramEvents','apiKey','10zyYIug','isIPv4MappedAddress','Invalid\x20authentication\x20token\x20(1)','2FA\x20login\x20required','Error:\x20Invalid\x20argument\x20','value','restart','padStart','sendMessage','\x20/\x20','Invalid\x20Telegram\x20token','secret','Balance\x20Bot\x20Server','decrypt','Unauthorized\x20attempt\x20to\x20get\x20logs','cancel-loading','enabled\x20Bot\x20','restarting\x20Bot\x20','type','headers','/:bot/portfolio','emit','getPortfolio','Allow\x20login\x20from\x20IP\x20address\x20<b>','status','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','update-bb','secure','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','split','socket.io','polling_error','server','temporary\x20access\x20rejected','temporary\x20access\x20not\x20allowed','/on\x20-\x20start\x20bot(s)\x0a','token','Unauthorized\x20attempt\x20to\x20update\x20settings','/:bot/history','clients','unlinkSync','getDate','verify','length','yes','Unauthorized\x20attempt\x20to\x20add\x20bot','telegramToken','/:bot/coins'];_0x4cc0=function(){return _0x496f4b;};return _0x4cc0();}function startServer(){const _0x7454d9=_0x418aae;console[_0x7454d9(0x31e)](''),console[_0x7454d9(0x31e)](_0x7454d9(0x235)),logging(_0x7454d9(0x23a)+PORT),console[_0x7454d9(0x31e)](_0x7454d9(0x235));if(config['length']!=0x0)config['forEach'](_0x3a0cf5=>{const _0x12b97d=_0x7454d9;if(_0x3a0cf5[_0x12b97d(0x2d1)]==_0x12b97d(0x290)||_0x3a0cf5['status']==_0x12b97d(0x21a))logging(_0x12b97d(0x31a)+_0x3a0cf5[_0x12b97d(0x1f4)]+_0x12b97d(0x29c)+_0x3a0cf5[_0x12b97d(0x294)]),startBot([_0x3a0cf5[_0x12b97d(0x1f4)],userID],{'cwd':bbpath},function(_0x3fe378){if(_0x3fe378)logging(_0x3fe378);});else(_0x3a0cf5['status']==_0x12b97d(0x2b6)||_0x3a0cf5[_0x12b97d(0x2d1)]=='new-disabled')&&logging(_0x12b97d(0x2fe)+_0x3a0cf5[_0x12b97d(0x1f4)]+_0x12b97d(0x29c)+_0x3a0cf5['botname']);});else!newBot&&console[_0x7454d9(0x31e)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();console[_0x7454d9(0x31e)](_0x7454d9(0x235)),console[_0x7454d9(0x31e)]('');}function startSocket(){io['on']('connection',_0x7703d9=>{const _0x4a05c8=_0x3d72;let _0x72e9e7,_0xcba93c,_0x430255,_0x17baf6,_0x1b1903;const _0x46a7aa=_0x7703d9[_0x4a05c8(0x238)][_0x4a05c8(0x2cc)][_0x4a05c8(0x236)];_0xcba93c=_0x46a7aa['match'](/bot[0-9]{3}/);if(_0xcba93c)_0x430255=_0xcba93c[0x0][_0x4a05c8(0x264)](/[0-9]{3}/);if(_0x430255)_0x72e9e7=_0x430255[0x0];else _0x72e9e7='botmanager';const _0x14fdd9=_0x7703d9[_0x4a05c8(0x238)]['auth'][_0x4a05c8(0x295)];if(!_0x14fdd9)_0x7703d9[_0x4a05c8(0x2ce)](_0x4a05c8(0x2d1),{'publicKey':secure['publicKey']});else{_0x17baf6=timelyDecrypt(_0x14fdd9,![]);if(!_0x17baf6)_0x7703d9['emit'](_0x4a05c8(0x2d1),{'publicKey':secure[_0x4a05c8(0x2ee)]});else{_0x1b1903=normalizeIP(_0x7703d9['conn'][_0x4a05c8(0x25d)])[_0x4a05c8(0x2f5)];if(!devices[_0x17baf6])devices[_0x17baf6]={'uuid':_0x17baf6,'access':{'token':null}};devices[_0x17baf6]['ip']=_0x1b1903;const _0x40597a=addClient(_0x7703d9['id'],_0x17baf6,_0x72e9e7);setAccess(_0x40597a),_0x7703d9['on'](_0x4a05c8(0x22a),_0x26f08c=>{const _0x1b7f1a=_0x4a05c8,_0x545d54=timelyDecrypt(_0x26f08c[_0x1b7f1a(0x1f7)]);if(_0x545d54){_0x26f08c={'username':_0x26f08c['username'],'password':_0x545d54},devices[_0x17baf6][_0x1b7f1a(0x2fb)]=validateCredentials(_0x26f08c,_0x17baf6);if(devices[_0x17baf6][_0x1b7f1a(0x2fb)][_0x1b7f1a(0x204)]==![]&&devices[_0x17baf6][_0x1b7f1a(0x2fb)][_0x1b7f1a(0x328)]==_0x1b7f1a(0x2bc))_0x7703d9['emit'](_0x1b7f1a(0x2d1),{'access':devices[_0x17baf6][_0x1b7f1a(0x2fb)]}),loginAccess2FA(_0x17baf6,_0x1b1903);else{if(devices[_0x17baf6][_0x1b7f1a(0x2fb)][_0x1b7f1a(0x204)]==![]&&devices[_0x17baf6][_0x1b7f1a(0x2fb)]['reason']==_0x1b7f1a(0x22c))_0x7703d9[_0x1b7f1a(0x2ce)](_0x1b7f1a(0x2d1),{'access':devices[_0x17baf6][_0x1b7f1a(0x2fb)]});else devices[_0x17baf6][_0x1b7f1a(0x2fb)][_0x1b7f1a(0x204)]&&devices[_0x17baf6][_0x1b7f1a(0x2fb)][_0x1b7f1a(0x328)]==_0x1b7f1a(0x21f)&&(getClientsWithUuid(_0x17baf6)[_0x1b7f1a(0x2b3)](_0x4706ad=>{setAccess(_0x4706ad);}),setTokenRefresh(_0x17baf6),setSessionTimeout(_0x1b7f1a(0x22a),_0x17baf6));}}else logging(_0x1b7f1a(0x291));}),_0x7703d9['on'](_0x4a05c8(0x211),()=>{resetPassword();}),_0x7703d9['on'](_0x4a05c8(0x2a5),_0x2726f0=>{removeClient(_0x7703d9['id']);});}}});}function initClient(_0x2961d7){const _0x5d9861=_0x418aae;if(_0x2961d7!='botmanager'&&config[_0x5d9861(0x2b8)]!=''){if(pid[_0x2961d7])pid[_0x2961d7][_0x5d9861(0x2ad)]({'function':_0x5d9861(0x24a),'args':null});}}function getSocket(_0x1d3f45){const _0x10c04c=_0x418aae;return io['sockets'][_0x10c04c(0x32d)]['get'](_0x1d3f45);}function setAccess(_0x5575b1){const _0x4dee9e=_0x418aae,_0x1e28e8=getSocket(_0x5575b1['id']),_0x19cf87=_0x5575b1[_0x4dee9e(0x20e)],_0x43c88a=_0x5575b1[_0x4dee9e(0x1f1)];devices[_0x19cf87]['access']=validateAccess(devices[_0x19cf87][_0x4dee9e(0x2fb)][_0x4dee9e(0x2de)],_0x19cf87),_0x1e28e8[_0x4dee9e(0x313)](_0x19cf87);if(devices[_0x19cf87][_0x4dee9e(0x2fb)]['allow']){_0x1e28e8['join'](_0x43c88a);if(_0x43c88a==_0x4dee9e(0x207))initializeSocketBotManager(_0x1e28e8);else initializeSocketBot(_0x1e28e8);initClient(_0x43c88a);}devices[_0x19cf87][_0x4dee9e(0x2fb)][_0x4dee9e(0x2de)]&&devices[_0x19cf87][_0x4dee9e(0x2fb)]['reason']==_0x4dee9e(0x2ec)&&setSessionTimeout('2FA',_0x19cf87),devices[_0x19cf87][_0x4dee9e(0x2fb)][_0x4dee9e(0x2de)]&&devices[_0x19cf87][_0x4dee9e(0x2fb)][_0x4dee9e(0x328)]==_0x4dee9e(0x223)&&setSessionTimeout(_0x4dee9e(0x22a),_0x19cf87),_0x1e28e8[_0x4dee9e(0x2ce)](_0x4dee9e(0x2d1),{'status':_0x5575b1[_0x4dee9e(0x2da)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x19cf87]['access'],'externalip':devices[_0x19cf87]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),devices[_0x19cf87][_0x4dee9e(0x2fb)][_0x4dee9e(0x204)]==![]&&devices[_0x19cf87][_0x4dee9e(0x2fb)][_0x4dee9e(0x328)]==_0x4dee9e(0x2ac)&&temporaryAccess2FA(_0x19cf87,devices[_0x19cf87]['ip']);}function setSessionTimeout(_0x1a2384,_0x2d6568){const _0x3e0256=_0x418aae;let _0x2825e3;if(_0x1a2384=='login')_0x2825e3=loginExpiry*0x3c*0x3e8;else _0x2825e3=devices[_0x2d6568]['telegramIpApproval'][_0x3e0256(0x30d)]*0x3c*0x3e8-(new Date()[_0x3e0256(0x24c)]()-devices[_0x2d6568][_0x3e0256(0x200)][_0x3e0256(0x21e)]);if(devices[_0x2d6568][_0x3e0256(0x24f)])clearTimeout(devices[_0x2d6568][_0x3e0256(0x24f)]);devices[_0x2d6568][_0x3e0256(0x24f)]=setTimeout(()=>{const _0x7e736b=_0x3e0256;if(devices[_0x2d6568][_0x7e736b(0x1f0)])clearTimeout(devices[_0x2d6568][_0x7e736b(0x1f0)]);removeSocketListeners(_0x2d6568),addBlacklist(_0x2d6568),devices[_0x2d6568][_0x7e736b(0x200)]=null,devices[_0x2d6568][_0x7e736b(0x315)]=null,devices[_0x2d6568]['access'][_0x7e736b(0x2de)]=null,devices[_0x2d6568][_0x7e736b(0x2fb)]=validateAccess(devices[_0x2d6568][_0x7e736b(0x2fb)][_0x7e736b(0x2de)],_0x2d6568),!(devices[_0x2d6568][_0x7e736b(0x2fb)][_0x7e736b(0x204)]&&devices[_0x2d6568]['access']['reason']==_0x7e736b(0x252))&&(_0x1a2384==_0x7e736b(0x22a)?io['to'](_0x2d6568)[_0x7e736b(0x2ce)](_0x7e736b(0x2d1),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x2d6568)[_0x7e736b(0x2ce)](_0x7e736b(0x2d1),{'access':{'allow':![],'reason':_0x7e736b(0x250),'token':null}})),devices[_0x2d6568][_0x7e736b(0x2fb)]['token']=null;},_0x2825e3);}function setTokenRefresh(_0x34411c){const _0x37ae41=_0x418aae;if(devices[_0x34411c]['pidRefreshToken'])clearTimeout(devices[_0x34411c][_0x37ae41(0x1f0)]);devices[_0x34411c]['pidRefreshToken']=setTimeout(()=>{const _0x3f142b=_0x37ae41;getClientsWithUuid(_0x34411c)['length']!=0x0?(devices[_0x34411c][_0x3f142b(0x2fb)]=refreshToken(_0x34411c),io['to'](_0x34411c)[_0x3f142b(0x2ce)]('status',{'status':_0x3f142b(0x267),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x34411c][_0x3f142b(0x2fb)],'externalip':devices[_0x34411c]['ip'],'publicKey':secure[_0x3f142b(0x2ee)],'validInstallation':validInstallation}),setTokenRefresh(_0x34411c)):clearTimeout(devices[_0x34411c][_0x3f142b(0x1f0)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x426325){const _0x2a83b8=_0x418aae,_0x105484=getClient(_0x426325['id'])['uuid'];_0x426325[_0x2a83b8(0x2ce)](_0x2a83b8(0x24e),config),_0x426325[_0x2a83b8(0x2ce)]('settings',cleanSettings()),_0x426325['on'](_0x2a83b8(0x2aa),_0x352bbc=>{const _0x468c0e=_0x2a83b8;if(validateAccess(_0x352bbc,_0x105484)[_0x468c0e(0x204)])addBot();else logging(_0x468c0e(0x2e7));}),_0x426325['on'](_0x2a83b8(0x241),(_0xc207cb,_0x4cd956)=>{const _0x16c70a=_0x2a83b8;if(validateAccess(_0x4cd956,_0x105484)['allow'])toggleBot(_0xc207cb['botID'],_0xc207cb[_0x16c70a(0x2d1)],_0xc207cb[_0x16c70a(0x201)]);else logging('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x426325['on'](_0x2a83b8(0x2b5),(_0x2812c3,_0x4f6bd2)=>{const _0x30f490=_0x2a83b8;if(validateAccess(_0x4f6bd2,_0x105484)[_0x30f490(0x204)])deleteBot(_0x2812c3);else logging('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x426325['on'](_0x2a83b8(0x29e),(_0x1e7223,_0x206f9b)=>{const _0x18fa9b=_0x2a83b8;if(validateAccess(_0x206f9b,_0x105484)[_0x18fa9b(0x204)])storeSettings(_0x1e7223,!![]);else logging(_0x18fa9b(0x2df));}),_0x426325['on'](_0x2a83b8(0x2d3),(_0x9d0197,_0x332a2b)=>{const _0x38f7ea=_0x2a83b8;if(validateAccess(_0x332a2b,_0x105484)[_0x38f7ea(0x204)])updateBB();else logging(_0x38f7ea(0x2df));}),_0x426325['on'](_0x2a83b8(0x271),_0x2bed42=>{const _0x5129bc=_0x2a83b8;if(validateAccess(_0x2bed42,_0x105484)['allow']){if(devices[_0x105484]['pidRefreshToken'])clearTimeout(devices[_0x105484][_0x5129bc(0x1f0)]);if(devices[_0x105484]['pidExpireLogin'])clearTimeout(devices[_0x105484]['pidExpireLogin']);removeSocketListeners(getClient(_0x426325['id'])['uuid']),addBlacklist(_0x105484),devices[_0x105484]['telegramIpApproval']=null,devices[_0x105484][_0x5129bc(0x315)]=null,devices[_0x105484][_0x5129bc(0x2fb)][_0x5129bc(0x2de)]=null,io['to'](getClient(_0x426325['id'])[_0x5129bc(0x20e)])[_0x5129bc(0x2ce)]('status',{'access':{'allow':![],'reason':_0x5129bc(0x256),'token':null}});}else logging(_0x5129bc(0x277));});}function initializeSocketBot(_0x2ed02a){const _0x54dd72=_0x418aae,_0x41fa7a=getClient(_0x2ed02a['id'])[_0x54dd72(0x1f1)],_0x731d4e=getClient(_0x2ed02a['id'])['uuid'];_0x2ed02a['on'](_0x54dd72(0x1ec),(_0x14d708,_0x4d7073)=>{const _0x5c4473=_0x54dd72;if(validateAccess(_0x4d7073,_0x731d4e)[_0x5c4473(0x204)]){if(pid[_0x41fa7a])pid[_0x41fa7a]['send']({'function':'emitHistory','args':_0x14d708});}else logging(_0x5c4473(0x2c7));}),_0x2ed02a['on'](_0x54dd72(0x20f),(_0xdb055a,_0x5b6a60)=>{const _0x2f1df7=_0x54dd72;if(validateAccess(_0x5b6a60,_0x731d4e)[_0x2f1df7(0x204)]){if(pid[_0x41fa7a])pid[_0x41fa7a][_0x2f1df7(0x2ad)]({'function':_0x2f1df7(0x2eb),'args':_0xdb055a});}else logging(_0x2f1df7(0x319));}),_0x2ed02a['on'](_0x54dd72(0x26f),(_0x4a6b68,_0x372463)=>{const _0x4b80d8=_0x54dd72;if(validateAccess(_0x372463,_0x731d4e)[_0x4b80d8(0x204)]){if(pid[_0x41fa7a])pid[_0x41fa7a][_0x4b80d8(0x2ad)]({'function':_0x4b80d8(0x2cf),'args':_0x4a6b68});}else logging(_0x4b80d8(0x243));}),_0x2ed02a['on']('store-configuration',(_0x3f2b4e,_0x553721)=>{const _0xd80169=_0x54dd72;if(validateAccess(_0x553721,_0x731d4e)[_0xd80169(0x204)]){if(pid[_0x41fa7a])pid[_0x41fa7a][_0xd80169(0x2ad)]({'function':_0xd80169(0x32f),'args':_0x3f2b4e});}else logging('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x2ed02a['on'](_0x54dd72(0x2a4),(_0x17f72a,_0x6b8845)=>{const _0x47e8c4=_0x54dd72;if(validateAccess(_0x6b8845,_0x731d4e)[_0x47e8c4(0x204)]){if(pid[_0x41fa7a])pid[_0x41fa7a][_0x47e8c4(0x2ad)]({'function':_0x47e8c4(0x208),'args':_0x17f72a});}else logging(_0x47e8c4(0x32b));}),_0x2ed02a['on'](_0x54dd72(0x288),_0x318529=>{const _0x64b111=_0x54dd72;if(validateAccess(_0x318529,_0x731d4e)[_0x64b111(0x204)]){if(pid[_0x41fa7a])pid[_0x41fa7a]['send']({'function':'getStartingBalances','args':null});}else logging('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x2ed02a['on'](_0x54dd72(0x26b),(_0x4ffd6c,_0x43a99c)=>{const _0x2d31e9=_0x54dd72;if(validateAccess(_0x43a99c,_0x731d4e)[_0x2d31e9(0x204)]){if(pid[_0x41fa7a])pid[_0x41fa7a]['send']({'function':_0x2d31e9(0x314),'args':_0x4ffd6c});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x2ed02a['on'](_0x54dd72(0x2c8),_0xaea93e=>{const _0x467878=_0x54dd72;if(validateAccess(_0xaea93e,_0x731d4e)[_0x467878(0x204)]){if(pid[_0x41fa7a])pid[_0x41fa7a][_0x467878(0x2ad)]({'function':_0x467878(0x1fb),'args':null});}else logging(_0x467878(0x2d5));}),_0x2ed02a['on'](_0x54dd72(0x271),_0x40bc77=>{const _0x71a9a9=_0x54dd72;if(validateAccess(_0x40bc77,_0x731d4e)[_0x71a9a9(0x204)]){if(devices[_0x731d4e][_0x71a9a9(0x1f0)])clearTimeout(devices[_0x731d4e][_0x71a9a9(0x1f0)]);if(devices[_0x731d4e][_0x71a9a9(0x24f)])clearTimeout(devices[_0x731d4e][_0x71a9a9(0x24f)]);removeSocketListeners(getClient(_0x2ed02a['id'])[_0x71a9a9(0x20e)]),addBlacklist(_0x731d4e),devices[_0x731d4e]['telegramIpApproval']=null,devices[_0x731d4e][_0x71a9a9(0x315)]=null,devices[_0x731d4e][_0x71a9a9(0x2fb)][_0x71a9a9(0x2de)]=null,io['to'](getClient(_0x2ed02a['id'])[_0x71a9a9(0x20e)])['emit'](_0x71a9a9(0x2d1),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0x71a9a9(0x277));});}function removeSocketListeners(_0x3d7b3a){const _0x58904c=_0x418aae;getClientsWithUuid(_0x3d7b3a)[_0x58904c(0x2b3)](_0x5d9e2e=>{const _0x1a00c6=_0x58904c;getSocket(_0x5d9e2e['id'])[_0x1a00c6(0x329)]();});}function cleanSettings(){const _0x333572=_0x418aae;let _0x1ba928=settings;return settings[_0x333572(0x2e8)]&&settings[_0x333572(0x2e8)]!=''&&(_0x1ba928={..._0x1ba928,'telegramToken':_0x333572(0x251)}),settings[_0x333572(0x218)]&&settings['bbPassword']!=''&&(_0x1ba928={..._0x1ba928,'bbPassword':'************'}),_0x1ba928;}function updateBB(){const _0x303a6e=_0x418aae;installingUpdate=!![],config[_0x303a6e(0x2b3)](_0x4be872=>{restartBot(_0x4be872['botID']);}),process[_0x303a6e(0x2ad)]({'update':!![]},_0x1b57f7=>{});}function startBot(_0x2b5d9d,_0x13f5b9,_0x47de12){const _0x576e0a=_0x418aae;let _0x17bb97=![];const _0x5715af=_0x2b5d9d[0x0];_0x13f5b9={..._0x13f5b9,'stdio':['inherit',_0x576e0a(0x2ab),_0x576e0a(0x2ab),_0x576e0a(0x23d)]},pid[_0x5715af]=childProcess[_0x576e0a(0x23e)](botfile,_0x2b5d9d,_0x13f5b9),pid[_0x5715af]['on'](_0x576e0a(0x2ea),_0x2d75aa=>{const _0xd8314b=_0x576e0a;switch(Object[_0xd8314b(0x301)](_0x2d75aa)[0x0]){case _0xd8314b(0x294):updateBotName(_0x5715af,_0x2d75aa[_0xd8314b(0x294)]);break;case _0xd8314b(0x2d1):updateStatus(_0x5715af,_0x2d75aa[_0xd8314b(0x2d1)]);break;case _0xd8314b(0x201):updateLive(_0x5715af,_0x2d75aa[_0xd8314b(0x201)]);break;case _0xd8314b(0x21d):updateLive(_0x5715af,_0x2d75aa['started']),io['to'](_0x5715af)[_0xd8314b(0x2ce)](_0xd8314b(0x2d1),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0xd8314b(0x312):_0x2d75aa['stop']==_0xd8314b(0x2bf)&&restartBot(_0x5715af);_0x2d75aa[_0xd8314b(0x312)]=='kill'&&toggleBot(_0x5715af,_0xd8314b(0x2b6),_0xd8314b(0x30b));break;case _0xd8314b(0x24b):sendTelegram(_0x5715af,_0x2d75aa['telegram']);break;case _0xd8314b(0x297):io['to'](_0x5715af)[_0xd8314b(0x2ce)](_0x2d75aa['function'],_0x2d75aa[_0xd8314b(0x29a)]);break;}}),pid[_0x5715af]['on']('error',function(_0x2f475f){if(_0x17bb97)return;_0x17bb97=!![],_0x47de12(_0x2f475f);}),pid[_0x5715af]['on'](_0x576e0a(0x25f),function(_0x1f777b){const _0x13573e=_0x576e0a;if(installingUpdate)return;if(_0x17bb97)return;_0x17bb97=!![],_0x47de12(null);const _0x5792e1=dbConfig[_0x13573e(0x2f6)](_0x13573e(0x24e))[_0x13573e(0x293)]({'botID':_0x5715af})[_0x13573e(0x2be)]();_0x5792e1&&(_0x5792e1[_0x13573e(0x2d1)]==_0x13573e(0x290)||_0x5792e1[_0x13573e(0x2d1)]==_0x13573e(0x21a))&&(updateLive(_0x5715af,_0x13573e(0x30b)),logging(_0x13573e(0x2ca)+_0x5715af),startBot([_0x5715af,userID],{'cwd':bbpath},function(_0x40e852){if(_0x40e852)logging(_0x40e852);}));});}function stopBot(_0x9a58b3){const _0x27959d=_0x418aae;getClientsWithBotID(_0x9a58b3)[_0x27959d(0x2b3)](_0x174a3a=>{const _0x48cf95=_0x27959d;getSocket(_0x174a3a['id'])[_0x48cf95(0x2a5)](!![]),removeClient(_0x174a3a['id']);});if(pid[_0x9a58b3])pid[_0x9a58b3][_0x27959d(0x2a2)]();}function restartBot(_0x2077f1){if(pid[_0x2077f1])pid[_0x2077f1]['kill']();}function addBot(){const _0x396307=_0x418aae;let _0x48ccd0;for(let _0x5e7f33=0x1;_0x5e7f33<0x3e9;_0x5e7f33++){_0x48ccd0=_0x5e7f33[_0x396307(0x26e)]()[_0x396307(0x2c0)](0x3,'0');let _0xd73b93=config[_0x396307(0x293)](_0x45afcd=>_0x45afcd[_0x396307(0x1f4)]==_0x48ccd0);if(!_0xd73b93)break;}if(_0x48ccd0===_0x396307(0x278)){logging('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logging(_0x396307(0x268)+_0x48ccd0),dbConfig['get'](_0x396307(0x24e))['push']({'botID':_0x48ccd0,'botname':_0x396307(0x275)+_0x48ccd0,'status':_0x396307(0x21a),'live':''})['write'](),startBot([_0x48ccd0,userID],{'cwd':bbpath},function(_0xe9c2aa){if(_0xe9c2aa)logging(_0xe9c2aa);}),config=getConfiguration(),io['to'](_0x396307(0x207))[_0x396307(0x2ce)](_0x396307(0x24e),config);}function deleteBot(_0x3bbd1c){const _0x25d56b=_0x418aae;getClientsWithBotID(_0x3bbd1c)[_0x25d56b(0x2b3)](_0xbc3837=>{const _0x4c29f9=_0x25d56b;getSocket(_0xbc3837['id'])[_0x4c29f9(0x2a5)](!![]),removeClient(_0xbc3837['id']);}),dbConfig[_0x25d56b(0x2f6)](_0x25d56b(0x24e))['remove']({'botID':_0x3bbd1c})['write'](),logging('deleted\x20Bot\x20'+_0x3bbd1c),stopBot(_0x3bbd1c);try{fs[_0x25d56b(0x2e2)](path[_0x25d56b(0x313)](configpath,_0x25d56b(0x274)+_0x3bbd1c+_0x25d56b(0x266))),fs['unlinkSync'](path[_0x25d56b(0x313)](configpath,'bot-'+_0x3bbd1c+'-events.json')),fs['unlinkSync'](path[_0x25d56b(0x313)](configpath,_0x25d56b(0x274)+_0x3bbd1c+'-performance.json')),fs[_0x25d56b(0x2e2)](path[_0x25d56b(0x313)](configpath,_0x25d56b(0x274)+_0x3bbd1c+_0x25d56b(0x20a)));}catch(_0x57c0bb){if(_0x57c0bb)logging('error\x20while\x20deleting\x20config\x20files:\x20',_0x57c0bb);}config=getConfiguration(),io['to'](_0x25d56b(0x207))['emit'](_0x25d56b(0x24e),config);}function toggleBot(_0x4868de,_0x1a4898,_0x2914df){const _0x1ba710=_0x418aae;dbConfig[_0x1ba710(0x2f6)](_0x1ba710(0x24e))[_0x1ba710(0x293)]({'botID':_0x4868de})[_0x1ba710(0x217)]({'status':_0x1a4898})[_0x1ba710(0x217)]({'live':_0x2914df})[_0x1ba710(0x224)]();if(_0x1a4898==_0x1ba710(0x290)||_0x1a4898==_0x1ba710(0x21a))logging(_0x1ba710(0x2c9)+_0x4868de),startBot([_0x4868de,userID],{'cwd':bbpath},function(_0x58ec12){if(_0x58ec12)logging(_0x58ec12);});else(_0x1a4898=='disabled'||_0x1a4898==_0x1ba710(0x228))&&(logging(_0x1ba710(0x299)+_0x4868de),stopBot(_0x4868de));config=getConfiguration(),io['to'](_0x1ba710(0x207))[_0x1ba710(0x2ce)]('bots',config);}function toggleStatus(_0x290d26){const _0x1295fb=_0x418aae;let _0x540b95=dbConfig[_0x1295fb(0x2f6)](_0x1295fb(0x24e))[_0x1295fb(0x293)]({'botID':_0x290d26})[_0x1295fb(0x2be)](),_0x52784d;if(_0x540b95[_0x1295fb(0x2d1)]===_0x1295fb(0x290))_0x52784d='disabled';else{if(_0x540b95[_0x1295fb(0x2d1)]===_0x1295fb(0x21a))_0x52784d=_0x1295fb(0x228);else{if(_0x540b95['status']==='new-disabled')_0x52784d=_0x1295fb(0x21a);else{if(_0x540b95[_0x1295fb(0x2d1)]==='disabled')_0x52784d=_0x1295fb(0x290);}}}return _0x52784d;}function updateStatus(_0x48100a,_0x419a8b){const _0x35a1fe=_0x418aae;dbConfig[_0x35a1fe(0x2f6)]('bots')[_0x35a1fe(0x293)]({'botID':_0x48100a})[_0x35a1fe(0x217)]({'status':_0x419a8b})['write'](),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config);}function updateLive(_0x4d7c2a,_0x456aa3){const _0x134c57=_0x418aae;dbConfig[_0x134c57(0x2f6)](_0x134c57(0x24e))[_0x134c57(0x293)]({'botID':_0x4d7c2a})['assign']({'live':_0x456aa3})[_0x134c57(0x224)](),config=getConfiguration(),io['to'](_0x134c57(0x207))[_0x134c57(0x2ce)](_0x134c57(0x24e),config);}function updateBotName(_0xdfdfe6,_0x15a117){const _0x4cfeba=_0x418aae;dbConfig[_0x4cfeba(0x2f6)](_0x4cfeba(0x24e))[_0x4cfeba(0x293)]({'botID':_0xdfdfe6})[_0x4cfeba(0x217)]({'botname':_0x15a117})['write'](),config=getConfiguration(),io['to'](_0x4cfeba(0x207))[_0x4cfeba(0x2ce)](_0x4cfeba(0x24e),config);}function telegramError(_0x4ff1a3){const _0xe00bc2=_0x418aae;console[_0xe00bc2(0x31e)](getTimeStamp()+_0xe00bc2(0x27b));}function validateTelegram(_0x4f686d){const _0x337497=_0x418aae;if(_0x4f686d[_0x337497(0x20c)][_0x337497(0x296)]!=settings[_0x337497(0x230)]&&'@'+_0x4f686d[_0x337497(0x20c)][_0x337497(0x296)]!=settings[_0x337497(0x230)])return tgBot[_0x337497(0x2c1)](_0x4f686d[_0x337497(0x22b)]['id'],_0x337497(0x2d2),{'parse_mode':_0x337497(0x23b)})[_0x337497(0x29f)](_0x397eb4=>{telegramError(_0x397eb4);}),![];return!![];}async function initTelegram(){const _0x1c0820=_0x418aae;if(tgBot)tgBot[_0x1c0820(0x26a)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x1c0820(0x2e8)],{'polling':!![]});let _0x4a33f3=_0x1c0820(0x248);_0x4a33f3+='\x0a',_0x4a33f3+=_0x1c0820(0x1f9),_0x4a33f3+='/disable\x20-\x20disable\x20notifications\x0a',_0x4a33f3+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x4a33f3+=_0x1c0820(0x265),_0x4a33f3+=_0x1c0820(0x2dd),_0x4a33f3+='/off\x20-\x20stop\x20bot(s)\x0a',_0x4a33f3+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x4a33f3+=_0x1c0820(0x2f1);let _0x3441a9=_0x1c0820(0x289);_0x3441a9+='\x0a',_0x3441a9+=_0x4a33f3,tgBot['onText'](/\/start/,_0x381cfc=>{const _0x317aff=_0x1c0820;if(!validateTelegram(_0x381cfc))return;if(settings[_0x317aff(0x28e)]!=_0x381cfc[_0x317aff(0x22b)]['id'])updateSetting('telegramChatId',_0x381cfc[_0x317aff(0x22b)]['id']);updateSetting('telegramEnabled',!![]),tgBot['sendMessage'](_0x381cfc[_0x317aff(0x22b)]['id'],_0x3441a9)['catch'](_0x25ae07=>{telegramError(_0x25ae07);});}),tgBot[_0x1c0820(0x26d)](/\/enable/,_0x4e7072=>{const _0xda92d=_0x1c0820;if(!validateTelegram(_0x4e7072))return;if(settings[_0xda92d(0x28e)]!=_0x4e7072[_0xda92d(0x22b)]['id'])updateSetting('telegramChatId',_0x4e7072[_0xda92d(0x22b)]['id']);updateSetting(_0xda92d(0x259),!![]),tgBot[_0xda92d(0x2c1)](_0x4e7072[_0xda92d(0x22b)]['id'],_0xda92d(0x1f5))[_0xda92d(0x29f)](_0xe453a=>{telegramError(_0xe453a);});}),tgBot[_0x1c0820(0x26d)](/\/config/,async _0x1ce9a8=>{const _0x28c3dc=_0x1c0820;if(!validateTelegram(_0x1ce9a8))return;tgBot[_0x28c3dc(0x272)](_0x28c3dc(0x279)),tgBot[_0x28c3dc(0x2c1)](_0x1ce9a8['chat']['id'],_0x28c3dc(0x2f7),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x28c3dc(0x2fa)},{'text':'Alerts','callback_data':'alerts'},{'text':'All','callback_data':_0x28c3dc(0x31f)}]]}})[_0x28c3dc(0x29f)](_0x2bcf7d=>{telegramError(_0x2bcf7d);}),tgBot['on']('callback_query',async _0x294816=>{const _0x161994=_0x28c3dc,_0x1280a3=_0x294816[_0x161994(0x2ff)],_0x1cd11a=_0x294816[_0x161994(0x2ea)];tgBot[_0x161994(0x21b)](_0x294816['id'])[_0x161994(0x225)](async()=>{const _0x3d5cc6=_0x161994;_0x1280a3==_0x3d5cc6(0x2fa)&&(updateSetting('telegramEvents',_0x3d5cc6(0x2fa)),updateSetting(_0x3d5cc6(0x259),!![]),await tgBot[_0x3d5cc6(0x2c1)](_0x1cd11a[_0x3d5cc6(0x22b)]['id'],_0x3d5cc6(0x283))[_0x3d5cc6(0x29f)](_0x1d8eae=>{telegramError(_0x1d8eae);}));_0x1280a3==_0x3d5cc6(0x1ee)&&(updateSetting(_0x3d5cc6(0x2b7),'alerts'),updateSetting('telegramEnabled',!![]),await tgBot[_0x3d5cc6(0x2c1)](_0x1cd11a[_0x3d5cc6(0x22b)]['id'],_0x3d5cc6(0x1ed))[_0x3d5cc6(0x29f)](_0x340eb7=>{telegramError(_0x340eb7);}));_0x1280a3==_0x3d5cc6(0x31f)&&(updateSetting(_0x3d5cc6(0x2b7),_0x3d5cc6(0x31f)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x1cd11a[_0x3d5cc6(0x22b)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x3d5cc6(0x29f)](_0x2122c4=>{telegramError(_0x2122c4);}));if(!settings[_0x3d5cc6(0x28e)])tgBot[_0x3d5cc6(0x2c1)](_0x1cd11a['chat']['id'],_0x3d5cc6(0x323))['catch'](_0x483a29=>{telegramError(_0x483a29);});}),tgBot['removeListener'](_0x161994(0x279));});}),tgBot['onText'](/\/status/,_0x5d3936=>{const _0x147d59=_0x1c0820;if(!validateTelegram(_0x5d3936))return;let _0x217f8e=_0x147d59(0x31d);config['forEach'](_0x48a292=>{const _0x10f63c=_0x147d59;_0x217f8e+=_0x10f63c(0x275)+_0x48a292[_0x10f63c(0x1f4)]+_0x10f63c(0x29c)+_0x48a292[_0x10f63c(0x294)]+':\x20'+_0x48a292[_0x10f63c(0x2d1)]+_0x10f63c(0x2c2)+_0x48a292[_0x10f63c(0x201)]+'\x0a';}),_0x217f8e+='\x0a',_0x217f8e+='<b>Telegram\x20bot\x20status:</b>\x0a',_0x217f8e+=!settings['telegramEnabled']?_0x147d59(0x246):'Notifications\x20enabled\x0a',_0x217f8e+=settings[_0x147d59(0x259)]?settings[_0x147d59(0x2b7)]==_0x147d59(0x31f)?_0x147d59(0x221):'Notifications\x20types:\x20'+settings[_0x147d59(0x2b7)]+_0x147d59(0x2a9):'',tgBot[_0x147d59(0x2c1)](_0x5d3936[_0x147d59(0x22b)]['id'],_0x217f8e,{'parse_mode':'HTML'})['catch'](_0x1e802d=>{telegramError(_0x1e802d);});}),tgBot[_0x1c0820(0x26d)](/\/restart/,_0x4a2bb2=>{const _0x5e5144=_0x1c0820;if(!validateTelegram(_0x4a2bb2))return;tgBot[_0x5e5144(0x272)]('callback_query');const _0x3ea15e=getEnabledBots();if(_0x3ea15e[_0x5e5144(0x2e5)]==0x0)tgBot[_0x5e5144(0x2c1)](_0x4a2bb2[_0x5e5144(0x22b)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x5b4a81=>{telegramError(_0x5b4a81);});else{if(_0x3ea15e[_0x5e5144(0x2e5)]>0x1)_0x3ea15e[_0x5e5144(0x304)]({'botID':_0x5e5144(0x31f)});let _0x52bdd4=[],_0x581658=[];const _0x1862ba=_0x3ea15e[_0x5e5144(0x2e5)]%0x4==0x0||_0x3ea15e[_0x5e5144(0x2e5)]%0x4==0x3||_0x3ea15e[_0x5e5144(0x2e5)]%0x3==0x1?0x4:0x3;let _0x3139bb=0x0;_0x3ea15e[_0x5e5144(0x2b3)]((_0x564b14,_0x2b9740)=>{const _0x139454=_0x5e5144;if(_0x2b9740%_0x1862ba==0x0)_0x581658=[];_0x581658['push']({'text':_0x564b14['botID']=='all'?_0x139454(0x308):_0x139454(0x275)+_0x564b14[_0x139454(0x1f4)],'callback_data':_0x564b14[_0x139454(0x1f4)]}),_0x2b9740%_0x1862ba==0x0&&(_0x52bdd4[_0x3139bb]=_0x581658,_0x3139bb++);}),tgBot[_0x5e5144(0x2c1)](_0x4a2bb2[_0x5e5144(0x22b)]['id'],_0x5e5144(0x240),{'reply_markup':{'inline_keyboard':_0x52bdd4}})[_0x5e5144(0x29f)](_0x5194f6=>{telegramError(_0x5194f6);}),tgBot['on'](_0x5e5144(0x279),async _0x2248de=>{const _0x4f3f47=_0x5e5144,_0x14b767=_0x2248de['data'],_0x55f99c=_0x2248de[_0x4f3f47(0x2ea)];tgBot[_0x4f3f47(0x21b)](_0x2248de['id'])[_0x4f3f47(0x225)](async()=>{const _0x2351e4=_0x4f3f47;if(_0x14b767==_0x2351e4(0x31f)){if(settings[_0x2351e4(0x2b7)]=='orders')tgBot[_0x2351e4(0x2c1)](_0x55f99c[_0x2351e4(0x22b)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20all\x20bots')[_0x2351e4(0x29f)](_0x22ada0=>{telegramError(_0x22ada0);});config['forEach'](_0x3ba0c1=>{const _0x1981ae=_0x2351e4;restartBot(_0x3ba0c1[_0x1981ae(0x1f4)]);});}else{if(settings['telegramEvents']==_0x2351e4(0x2fa))tgBot[_0x2351e4(0x2c1)](_0x55f99c[_0x2351e4(0x22b)]['id'],_0x2351e4(0x2d6)+_0x14b767)['catch'](_0x24d124=>{telegramError(_0x24d124);});restartBot(_0x14b767);}}),tgBot['removeListener'](_0x4f3f47(0x279));});}}),tgBot['onText'](/\/on/,_0x56ff9a=>{const _0x5237ea=_0x1c0820;if(!validateTelegram(_0x56ff9a))return;tgBot[_0x5237ea(0x272)](_0x5237ea(0x279));const _0x358b84=getDisabledBots();if(_0x358b84[_0x5237ea(0x2e5)]==0x0)tgBot[_0x5237ea(0x2c1)](_0x56ff9a['chat']['id'],_0x5237ea(0x21c))[_0x5237ea(0x29f)](_0x35a399=>{telegramError(_0x35a399);});else{if(_0x358b84['length']>0x1)_0x358b84[_0x5237ea(0x304)]({'botID':'all'});let _0x9955ba=[],_0x4db09a=[];const _0x12b069=_0x358b84[_0x5237ea(0x2e5)]%0x4==0x0||_0x358b84['length']%0x4==0x3||_0x358b84[_0x5237ea(0x2e5)]%0x3==0x1?0x4:0x3;let _0x3d45ac=0x0;_0x358b84['forEach']((_0x1d4baf,_0x3cce2c)=>{const _0x1c1fbb=_0x5237ea;if(_0x3cce2c%_0x12b069==0x0)_0x4db09a=[];_0x4db09a[_0x1c1fbb(0x304)]({'text':_0x1d4baf[_0x1c1fbb(0x1f4)]=='all'?_0x1c1fbb(0x308):_0x1c1fbb(0x275)+_0x1d4baf[_0x1c1fbb(0x1f4)],'callback_data':_0x1d4baf[_0x1c1fbb(0x1f4)]}),_0x3cce2c%_0x12b069==0x0&&(_0x9955ba[_0x3d45ac]=_0x4db09a,_0x3d45ac++);}),tgBot['sendMessage'](_0x56ff9a[_0x5237ea(0x22b)]['id'],_0x5237ea(0x1f8),{'reply_markup':{'inline_keyboard':_0x9955ba}})[_0x5237ea(0x29f)](_0x43be66=>{telegramError(_0x43be66);}),tgBot['on']('callback_query',async _0x11752c=>{const _0x52bd11=_0x5237ea,_0x3c3f8a=_0x11752c[_0x52bd11(0x2ff)],_0x4c135c=_0x11752c['message'];tgBot[_0x52bd11(0x21b)](_0x11752c['id'])[_0x52bd11(0x225)](async()=>{const _0x22dd53=_0x52bd11;if(_0x3c3f8a==_0x22dd53(0x31f)){if(settings[_0x22dd53(0x2b7)]==_0x22dd53(0x2fa))tgBot[_0x22dd53(0x2c1)](_0x4c135c['chat']['id'],_0x22dd53(0x31c))[_0x22dd53(0x29f)](_0x443336=>{telegramError(_0x443336);});_0x358b84[_0x22dd53(0x2b3)](_0x1d958f=>{const _0x21c5db=_0x22dd53;if(_0x1d958f[_0x21c5db(0x1f4)]!=_0x21c5db(0x31f))toggleBot(_0x1d958f['botID'],toggleStatus(_0x1d958f[_0x21c5db(0x1f4)]),_0x21c5db(0x30b));});}else{if(settings[_0x22dd53(0x2b7)]==_0x22dd53(0x2fa))tgBot[_0x22dd53(0x2c1)](_0x4c135c[_0x22dd53(0x22b)]['id'],_0x22dd53(0x2a7)+_0x3c3f8a)[_0x22dd53(0x29f)](_0x35857f=>{telegramError(_0x35857f);});toggleBot(_0x3c3f8a,toggleStatus(_0x3c3f8a),'stopped');}}),tgBot[_0x52bd11(0x272)]('callback_query');});}}),tgBot['onText'](/\/off/,_0x362f51=>{const _0x2b88b7=_0x1c0820;if(!validateTelegram(_0x362f51))return;tgBot[_0x2b88b7(0x272)](_0x2b88b7(0x279));const _0x44d20a=getEnabledBots();if(_0x44d20a['length']==0x0)tgBot[_0x2b88b7(0x2c1)](_0x362f51[_0x2b88b7(0x22b)]['id'],_0x2b88b7(0x255))[_0x2b88b7(0x29f)](_0x7bf5f7=>{telegramError(_0x7bf5f7);});else{if(_0x44d20a[_0x2b88b7(0x2e5)]>0x1)_0x44d20a[_0x2b88b7(0x304)]({'botID':_0x2b88b7(0x31f)});let _0xc3bb31=[],_0x53895c=[];const _0x21ebd2=_0x44d20a[_0x2b88b7(0x2e5)]%0x4==0x0||_0x44d20a[_0x2b88b7(0x2e5)]%0x4==0x3||_0x44d20a[_0x2b88b7(0x2e5)]%0x3==0x1?0x4:0x3;let _0x2b47c6=0x0;_0x44d20a['forEach']((_0x413b35,_0xd0133c)=>{const _0xf31294=_0x2b88b7;if(_0xd0133c%_0x21ebd2==0x0)_0x53895c=[];_0x53895c['push']({'text':_0x413b35['botID']=='all'?_0xf31294(0x308):_0xf31294(0x275)+_0x413b35[_0xf31294(0x1f4)],'callback_data':_0x413b35[_0xf31294(0x1f4)]}),_0xd0133c%_0x21ebd2==0x0&&(_0xc3bb31[_0x2b47c6]=_0x53895c,_0x2b47c6++);}),tgBot[_0x2b88b7(0x2c1)](_0x362f51['chat']['id'],_0x2b88b7(0x262),{'reply_markup':{'inline_keyboard':_0xc3bb31}})['catch'](_0x2e3481=>{telegramError(_0x2e3481);}),tgBot['on'](_0x2b88b7(0x279),async _0x49fca8=>{const _0x4861e7=_0x2b88b7,_0x35865e=_0x49fca8['data'],_0x3a2ee0=_0x49fca8['message'];tgBot[_0x4861e7(0x21b)](_0x49fca8['id'])[_0x4861e7(0x225)](async()=>{const _0x234722=_0x4861e7;if(_0x35865e==_0x234722(0x31f)){if(settings[_0x234722(0x2b7)]==_0x234722(0x2fa))tgBot['sendMessage'](_0x3a2ee0[_0x234722(0x22b)]['id'],_0x234722(0x215))[_0x234722(0x29f)](_0x1df6c2=>{telegramError(_0x1df6c2);});_0x44d20a[_0x234722(0x2b3)](_0x1f9947=>{const _0x296809=_0x234722;if(_0x1f9947['botID']!=_0x296809(0x31f))toggleBot(_0x1f9947[_0x296809(0x1f4)],toggleStatus(_0x1f9947[_0x296809(0x1f4)]),'stopped');});}else{if(settings[_0x234722(0x2b7)]==_0x234722(0x2fa))tgBot['sendMessage'](_0x3a2ee0['chat']['id'],_0x234722(0x203)+_0x35865e)[_0x234722(0x29f)](_0xe6771f=>{telegramError(_0xe6771f);});toggleBot(_0x35865e,toggleStatus(_0x35865e),_0x234722(0x30b));}}),tgBot[_0x4861e7(0x272)](_0x4861e7(0x279));});}}),tgBot[_0x1c0820(0x26d)](/\/disable/,_0x27b4a2=>{const _0x3cd689=_0x1c0820;if(!validateTelegram(_0x27b4a2))return;tgBot['sendMessage'](_0x27b4a2[_0x3cd689(0x22b)]['id'],'Notifications\x20disabled')[_0x3cd689(0x29f)](_0x2a6791=>{telegramError(_0x2a6791);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x1c0820(0x26d)](/\/help/,_0x316b7a=>{const _0x9ea4a9=_0x1c0820;if(!validateTelegram(_0x316b7a))return;tgBot[_0x9ea4a9(0x2c1)](_0x316b7a[_0x9ea4a9(0x22b)]['id'],_0x4a33f3)['catch'](_0x12bb97=>{telegramError(_0x12bb97);});}),tgBot['on'](_0x1c0820(0x2d9),_0x3da706=>{const _0xe709d3=_0x1c0820;_0x3da706['toString']()['includes']('404\x20Not\x20Found')&&(logging(_0xe709d3(0x2c3)),tgBot[_0xe709d3(0x26a)](),tgBot=null,io['to'](_0xe709d3(0x207))[_0xe709d3(0x2ce)](_0xe709d3(0x273),_0xe709d3(0x2c3)));}),process[_0x1c0820(0x253)](_0x1c0820(0x229),()=>{const _0x5df9be=_0x1c0820;if(tgBot)tgBot[_0x5df9be(0x26a)]();process[_0x5df9be(0x25f)](0x1);}),process['once'](_0x1c0820(0x320),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x4892a0,_0x3fee7f){const _0x2498fa=_0x418aae;if(settings['telegramEnabled']){if(settings[_0x2498fa(0x2b7)]==_0x2498fa(0x31f)||(_0x3fee7f[_0x2498fa(0x2cb)]=='error'||_0x3fee7f[_0x2498fa(0x2cb)]=='success')&&settings[_0x2498fa(0x2b7)]=='alerts'||_0x3fee7f['type']==_0x2498fa(0x2fc)&&settings[_0x2498fa(0x2b7)]=='orders'){if(tgBot&&settings['telegramChatId']){if(_0x3fee7f[_0x2498fa(0x25b)])tgBot[_0x2498fa(0x2c1)](settings['telegramChatId'],_0x3fee7f[_0x2498fa(0x294)]+_0x2498fa(0x307)+_0x3fee7f[_0x2498fa(0x306)])[_0x2498fa(0x29f)](_0x323411=>{telegramError(_0x323411);});else tgBot['sendMessage'](settings[_0x2498fa(0x28e)],_0x2498fa(0x275)+_0x4892a0+_0x2498fa(0x307)+_0x3fee7f[_0x2498fa(0x306)])['catch'](_0x668fa5=>{telegramError(_0x668fa5);});}}}}function getDeviceWithIp(_0x32deb4){const _0x45d131=_0x418aae;return devices[_0x45d131(0x293)](_0x1acdbc=>_0x1acdbc['ip']===_0x32deb4);}function temporaryAccess2FA(_0x4dea7b,_0x4147b3){const _0x16e3ae=_0x418aae;let _0xfb227=new Date(),_0x445600=![];if(lastIpApproval){if(_0xfb227-lastIpApproval<0x1388)_0x445600=!![];}lastIpApproval=new Date();if(_0x445600)return;tgBot&&settings[_0x16e3ae(0x28e)]&&(tgBot[_0x16e3ae(0x272)](_0x16e3ae(0x279)),tgBot['sendMessage'](settings[_0x16e3ae(0x28e)],_0x16e3ae(0x286)+normalizeIP(_0x4147b3)[_0x16e3ae(0x32c)]+'</b>\x20?',{'parse_mode':_0x16e3ae(0x23b),'reply_markup':{'inline_keyboard':[[{'text':_0x16e3ae(0x330),'callback_data':'5'},{'text':_0x16e3ae(0x1eb),'callback_data':'15'},{'text':_0x16e3ae(0x27f),'callback_data':'30'},{'text':_0x16e3ae(0x20b),'callback_data':_0x16e3ae(0x20b)}]]}})[_0x16e3ae(0x29f)](_0x358428=>{telegramError(_0x358428);}),tgBot['on']('callback_query',async _0x7cf107=>{const _0x278286=_0x16e3ae,_0x2b694f=_0x7cf107[_0x278286(0x2ff)],_0x1ee027=_0x7cf107[_0x278286(0x2ea)];tgBot[_0x278286(0x21b)](_0x7cf107['id'])[_0x278286(0x225)](async()=>{const _0x454c52=_0x278286;devices[_0x4dea7b]['telegramIpApproval']={'clientip':_0x4147b3,'timestamp':new Date()[_0x454c52(0x24c)](),'expiry':_0x2b694f},_0x2b694f!=_0x454c52(0x20b)?(await tgBot['sendMessage'](_0x1ee027[_0x454c52(0x22b)]['id'],_0x454c52(0x1e8)+_0x2b694f+_0x454c52(0x284),{'parse_mode':'HTML'})['catch'](_0x344168=>{telegramError(_0x344168);}),io['to'](_0x4dea7b)[_0x454c52(0x2ce)](_0x454c52(0x2d1),{'access':{'allow':![],'reason':_0x454c52(0x318),'token':null}})):(await tgBot['sendMessage'](_0x1ee027['chat']['id'],'Temporary\x20access\x20rejected')[_0x454c52(0x29f)](_0x4c577f=>{telegramError(_0x4c577f);}),io['to'](_0x4dea7b)['emit'](_0x454c52(0x2d1),{'access':{'allow':![],'reason':_0x454c52(0x2db),'token':null}}));}),tgBot[_0x278286(0x272)](_0x278286(0x279));}));}function loginAccess2FA(_0x5a1955,_0x155697){const _0x3be17a=_0x418aae;tgBot&&settings[_0x3be17a(0x28e)]&&(tgBot[_0x3be17a(0x272)]('callback_query'),tgBot[_0x3be17a(0x2c1)](settings[_0x3be17a(0x28e)],_0x3be17a(0x2d0)+normalizeIP(_0x155697)[_0x3be17a(0x32c)]+_0x3be17a(0x2a0),{'parse_mode':_0x3be17a(0x23b),'reply_markup':{'inline_keyboard':[[{'text':_0x3be17a(0x322),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x3be17a(0x20b)}]]}})[_0x3be17a(0x29f)](_0x1b1dc4=>{telegramError(_0x1b1dc4);}),tgBot['on'](_0x3be17a(0x279),async _0x2c74be=>{const _0x504249=_0x3be17a,_0x51a515=_0x2c74be['data'],_0x1b64d2=_0x2c74be[_0x504249(0x2ea)];tgBot[_0x504249(0x21b)](_0x2c74be['id'])[_0x504249(0x225)](async()=>{const _0x109813=_0x504249;devices[_0x5a1955]['telegram2FaApproval']={'clientip':_0x155697,'timestamp':new Date()[_0x109813(0x24c)](),'expiry':_0x51a515},_0x51a515!=_0x109813(0x20b)?(await tgBot[_0x109813(0x2c1)](_0x1b64d2[_0x109813(0x22b)]['id'],'Login\x20accepted',{'parse_mode':_0x109813(0x23b)})['catch'](_0x593a2f=>{telegramError(_0x593a2f);}),io['to'](_0x5a1955)[_0x109813(0x2ce)]('status',{'access':{'allow':![],'reason':_0x109813(0x318),'token':null}})):(await tgBot[_0x109813(0x2c1)](_0x1b64d2['chat']['id'],'Login\x20rejected')[_0x109813(0x29f)](_0x2ea53a=>{telegramError(_0x2ea53a);}),io['to'](_0x5a1955)[_0x109813(0x2ce)](_0x109813(0x2d1),{'access':{'allow':![],'reason':_0x109813(0x202),'token':null}}));}),tgBot[_0x504249(0x272)](_0x504249(0x279));}));}function getConfiguration(){const _0x3a6e5f=_0x418aae;return dbConfig[_0x3a6e5f(0x2f6)](_0x3a6e5f(0x24e))[_0x3a6e5f(0x219)](_0x3a6e5f(0x1f4))[_0x3a6e5f(0x2be)]()||[];}function getEnabledBots(){const _0x41073d=_0x418aae;return dbConfig[_0x41073d(0x2f6)]('bots')[_0x41073d(0x219)](_0x41073d(0x1f4))[_0x41073d(0x227)]({'status':'enabled'})['value']()||[];}function getDisabledBots(){const _0x31d892=_0x418aae;return dbConfig[_0x31d892(0x2f6)]('bots')['sortBy'](_0x31d892(0x1f4))[_0x31d892(0x227)]({'status':'disabled'})[_0x31d892(0x2be)]()||[];}function getSettings(){const _0x19f174=_0x418aae;return dbSettings[_0x19f174(0x2f6)](_0x19f174(0x258))[_0x19f174(0x2be)]()||{'timeshift':0x0};}function getSecure(){const _0x4ca1fa=_0x418aae;return dbSecure[_0x4ca1fa(0x2f6)]('secure')[_0x4ca1fa(0x2be)]()||{};}function getBlacklist(){const _0x18f561=_0x418aae;return dbSecure[_0x18f561(0x2f6)]('blacklist')[_0x18f561(0x2be)]()||[];}function broadcastToBots(_0x13c846,_0x35b1b7){const _0x57f481=_0x418aae;config[_0x57f481(0x2b3)](_0x287fa4=>{const _0x2a4c09=_0x57f481;if(_0x287fa4[_0x2a4c09(0x2d1)]=='enabled'&&_0x287fa4[_0x2a4c09(0x201)]==_0x2a4c09(0x2af)){if(pid[_0x287fa4[_0x2a4c09(0x1f4)]])pid[_0x287fa4[_0x2a4c09(0x1f4)]][_0x2a4c09(0x2ad)]({[_0x13c846]:_0x35b1b7});}});}function storeSettings(_0x4d1bd6,_0x2629e5=![]){const _0x1447f9=_0x418aae;_0x4d1bd6={...settings,..._0x4d1bd6};if(_0x2629e5&&_0x4d1bd6[_0x1447f9(0x218)]!=_0x1447f9(0x251)&&_0x4d1bd6['bbPassword']!=''){const _0x2bcae4=crypt['decrypt'](secure[_0x1447f9(0x2b2)],_0x4d1bd6[_0x1447f9(0x218)])['message'][_0x1447f9(0x2d7)]('@')[0x0],_0x134a81=bcrypt[_0x1447f9(0x303)](_0x2bcae4,saltRounds);_0x4d1bd6={..._0x4d1bd6,'bbPassword':_0x134a81};}if(_0x2629e5&&_0x4d1bd6[_0x1447f9(0x2e8)]!=_0x1447f9(0x251)&&_0x4d1bd6[_0x1447f9(0x2e8)]!=''){const _0x264963=crypt[_0x1447f9(0x2c6)](secure[_0x1447f9(0x2b2)],_0x4d1bd6[_0x1447f9(0x2e8)])['message'][_0x1447f9(0x2d7)]('@')[0x0];_0x4d1bd6={..._0x4d1bd6,'telegramToken':_0x264963};}const _0x1497c6=_0x4d1bd6[_0x1447f9(0x2e8)]!=_0x1447f9(0x251)&&_0x4d1bd6[_0x1447f9(0x2e8)]!=settings[_0x1447f9(0x2e8)]||_0x4d1bd6[_0x1447f9(0x230)]!=settings[_0x1447f9(0x230)],_0x265ff7=_0x4d1bd6['telegramToken']==''||_0x4d1bd6[_0x1447f9(0x230)]=='';if(_0x1497c6)_0x4d1bd6['telegramEvents']='all';for(const [_0x3531a2,_0x2d7df5]of Object['entries'](_0x4d1bd6)){if(_0x3531a2==_0x1447f9(0x2e8)&&_0x2d7df5==_0x1447f9(0x251)){_0x4d1bd6[_0x1447f9(0x2e8)]=settings[_0x1447f9(0x2e8)];continue;};if(_0x3531a2==_0x1447f9(0x218)&&_0x2d7df5==_0x1447f9(0x251)){_0x4d1bd6['bbPassword']=settings[_0x1447f9(0x218)];continue;};dbSettings[_0x1447f9(0x232)]('settings.'+_0x3531a2,_0x2d7df5)[_0x1447f9(0x224)]();}settings=_0x4d1bd6,io['to']('botmanager')[_0x1447f9(0x2ce)]('settings',cleanSettings()),broadcastToBots(_0x1447f9(0x321),settings[_0x1447f9(0x321)]);if(_0x1497c6&&!_0x265ff7)initTelegram();if(_0x1497c6&&_0x265ff7)disableTelegram();getAllClients()[_0x1447f9(0x2b3)](_0xfc9ccf=>{const _0x3c67e5=_0x1447f9;getSocket(_0xfc9ccf['id'])['emit'](_0x3c67e5(0x2d1),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x3b52f6,_0x3ab523){const _0x504fbb=_0x418aae;dbSettings['set'](_0x504fbb(0x28b)+_0x3b52f6,_0x3ab523)[_0x504fbb(0x224)](),settings=getSettings(),io['to']('botmanager')['emit'](_0x504fbb(0x258),cleanSettings());}function storeSecure(_0x4d885f){const _0x1f37e6=_0x418aae;dbSecure[_0x1f37e6(0x2f6)](_0x1f37e6(0x2d4))[_0x1f37e6(0x304)](_0x4d885f)[_0x1f37e6(0x224)](),secure=_0x4d885f;}function addBlacklist(_0x432580){const _0x5682a6=_0x418aae;cleanBlacklist();let _0x105e38;devices[_0x432580][_0x5682a6(0x200)]?_0x105e38=Math[_0x5682a6(0x27e)](devices[_0x432580][_0x5682a6(0x200)][_0x5682a6(0x30d)],loginExpiry):_0x105e38=loginExpiry,dbSecure[_0x5682a6(0x2f6)](_0x5682a6(0x1f6))[_0x5682a6(0x304)]({'expiry':new Date()[_0x5682a6(0x24c)]()+_0x105e38*0x3c*0x3e8,'token':devices[_0x432580][_0x5682a6(0x2fb)]['token']})[_0x5682a6(0x224)](),blacklist=dbSecure[_0x5682a6(0x2f6)]('blacklist')[_0x5682a6(0x2be)]();}function cleanBlacklist(){const _0xfdd15f=_0x418aae;let _0x3ac7aa=dbSecure['get'](_0xfdd15f(0x1f6))[_0xfdd15f(0x257)]()[_0xfdd15f(0x2be)](),_0x429bf6=new Date()[_0xfdd15f(0x24c)]();_0x3ac7aa[_0xfdd15f(0x2b3)](_0xa96361=>{const _0x500ffd=_0xfdd15f;_0xa96361[_0x500ffd(0x30d)]<_0x429bf6&&dbSecure[_0x500ffd(0x2f6)](_0x500ffd(0x1f6))[_0x500ffd(0x2f9)]({'expiry':_0xa96361[_0x500ffd(0x30d)]})[_0x500ffd(0x224)]();});}function initStates(){const _0x5eff9a=_0x418aae;let _0x24a559=getConfiguration();_0x24a559[_0x5eff9a(0x2b3)](_0x44eaf0=>{const _0xb35588=_0x5eff9a;_0x44eaf0[_0xb35588(0x201)]='stopped';}),storeConfiguration(_0x24a559);}function onKeys(){const _0x4d0eaf=new RSA();return new Promise(_0x346021=>{const _0x508b05=_0x3d72;_0x4d0eaf['generateKeyPairAsync']()[_0x508b05(0x225)](_0x5382ce=>{_0x346021(_0x5382ce);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5d70c6=_0x418aae;let _0x5dfa7c=getConfiguration(),_0x33a75c=![];_0x5dfa7c[_0x5d70c6(0x2b3)](_0x1d2cb8=>{const _0x41353e=_0x5d70c6;if(_0x1d2cb8[_0x41353e(0x2d1)]==_0x41353e(0x2af))_0x1d2cb8['status']=_0x41353e(0x290),_0x33a75c=!![];else _0x1d2cb8[_0x41353e(0x2d1)]=='stopped'&&(_0x1d2cb8[_0x41353e(0x2d1)]=_0x41353e(0x2b6),_0x33a75c=!![]);});if(_0x33a75c)storeConfiguration(_0x5dfa7c);let _0x1c9cff=getSecure();if(!_0x1c9cff[_0x5d70c6(0x233)](_0x5d70c6(0x2c4))){let _0x284d75=await generateKeys();_0x1c9cff['publicKey']=_0x284d75[_0x5d70c6(0x2ee)],_0x1c9cff[_0x5d70c6(0x2b2)]=_0x284d75[_0x5d70c6(0x2b2)],_0x1c9cff['secret']=crypto[_0x5d70c6(0x1fa)](0x20)['toString']('hex');;storeSecure(_0x1c9cff);}let _0x8db601=getSettings();_0x33a75c=![];!_0x8db601[_0x5d70c6(0x233)](_0x5d70c6(0x216))&&(_0x8db601['loginRequired']=![],_0x8db601['bbUsername']='',_0x8db601['bbPassword']='',_0x8db601[_0x5d70c6(0x28c)]=![],_0x33a75c=!![]);!_0x8db601[_0x5d70c6(0x233)](_0x5d70c6(0x270))&&(_0x8db601['whitelistEnabled']=![],_0x8db601[_0x5d70c6(0x23f)]=[],_0x8db601[_0x5d70c6(0x28d)]=![],_0x33a75c=!![]);if(!_0x8db601[_0x5d70c6(0x233)](_0x5d70c6(0x259))){if(_0x8db601[_0x5d70c6(0x28e)])_0x8db601[_0x5d70c6(0x259)]=!![];else _0x8db601['telegramEnabled']=![];_0x33a75c=!![];}if(_0x33a75c)storeSettings(_0x8db601);}function storeConfiguration(_0xbbe706){const _0x3de889=_0x418aae;dbConfig['get'](_0x3de889(0x24e))[_0x3de889(0x2f9)]()[_0x3de889(0x224)](),dbConfig[_0x3de889(0x2f6)](_0x3de889(0x24e))[_0x3de889(0x304)](..._0xbbe706)[_0x3de889(0x224)](),config=_0xbbe706;}function resetPassword(){const _0x2ea586=_0x418aae;tgBot&&settings[_0x2ea586(0x28e)]&&(tgBot['removeListener']('callback_query'),tgBot[_0x2ea586(0x2c1)](settings[_0x2ea586(0x28e)],_0x2ea586(0x325),{'parse_mode':_0x2ea586(0x23b),'reply_markup':{'inline_keyboard':[[{'text':_0x2ea586(0x2e6),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})['catch'](_0x3974d5=>{telegramError(_0x3974d5);}),tgBot['on'](_0x2ea586(0x279),async _0x42eca7=>{const _0x36ccee=_0x2ea586,_0x39ceae=_0x42eca7[_0x36ccee(0x2ff)],_0x1350e0=_0x42eca7[_0x36ccee(0x2ea)];tgBot['answerCallbackQuery'](_0x42eca7['id'])[_0x36ccee(0x225)](async()=>{const _0x1680c5=_0x36ccee;if(_0x39ceae!='no'){const _0x4c0c9c=0xf,_0xf61b70=_0x1680c5(0x1e9),_0x2b190b=Array[_0x1680c5(0x20c)](crypto['randomFillSync'](new Uint32Array(_0x4c0c9c)))['map'](_0x31e653=>_0xf61b70[_0x31e653%_0xf61b70[_0x1680c5(0x2e5)]])[_0x1680c5(0x313)](''),_0x3d8433=bcrypt[_0x1680c5(0x303)](_0x2b190b,saltRounds);storeSettings({'bbPassword':_0x3d8433}),await tgBot[_0x1680c5(0x2c1)](_0x1350e0[_0x1680c5(0x22b)]['id'],_0x1680c5(0x234)+_0x2b190b,{'parse_mode':_0x1680c5(0x23b)})[_0x1680c5(0x29f)](_0x253a68=>{telegramError(_0x253a68);});}else await tgBot[_0x1680c5(0x2c1)](_0x1350e0['chat']['id'],_0x1680c5(0x222))[_0x1680c5(0x29f)](_0x4e40a2=>{telegramError(_0x4e40a2);});}),tgBot[_0x36ccee(0x272)](_0x36ccee(0x279));}));}function logging(_0xeb5186){const _0x5d4d47=_0x418aae;console[_0x5d4d47(0x31e)](getTimeStamp()+_0x5d4d47(0x23c)+_0xeb5186);if(tgBot&&settings[_0x5d4d47(0x28e)]&&settings[_0x5d4d47(0x2b7)]!=_0x5d4d47(0x2fa))tgBot[_0x5d4d47(0x2c1)](settings[_0x5d4d47(0x28e)],_0x5d4d47(0x210)+_0xeb5186)[_0x5d4d47(0x29f)](_0x4a45ab=>{telegramError(_0x4a45ab);});}function getServerTime(){const _0x2cb532=_0x418aae,_0x2a9914=new Date();return _0x2a9914[_0x2cb532(0x226)]()+'/'+(_0x2a9914['getMonth']()+0x1)['toString']()[_0x2cb532(0x2c0)](0x2,'0')+'/'+_0x2a9914[_0x2cb532(0x2e3)]()['toString']()[_0x2cb532(0x2c0)](0x2,'0')+'\x20'+_0x2a9914[_0x2cb532(0x29d)]()[_0x2cb532(0x26e)]()[_0x2cb532(0x2c0)](0x2,'0')+':'+_0x2a9914[_0x2cb532(0x220)]()[_0x2cb532(0x26e)]()[_0x2cb532(0x2c0)](0x2,'0')+':'+_0x2a9914[_0x2cb532(0x25e)]()[_0x2cb532(0x26e)]()[_0x2cb532(0x2c0)](0x2,'0');}function getTimeStamp(){const _0x1b573d=_0x418aae,_0x351a12=shiftedTime();return _0x351a12[_0x1b573d(0x226)]()+'/'+(_0x351a12['getMonth']()+0x1)[_0x1b573d(0x26e)]()[_0x1b573d(0x2c0)](0x2,'0')+'/'+_0x351a12[_0x1b573d(0x2e3)]()['toString']()[_0x1b573d(0x2c0)](0x2,'0')+'\x20'+_0x351a12[_0x1b573d(0x29d)]()[_0x1b573d(0x26e)]()[_0x1b573d(0x2c0)](0x2,'0')+':'+_0x351a12['getMinutes']()['toString']()['padStart'](0x2,'0')+':'+_0x351a12[_0x1b573d(0x25e)]()[_0x1b573d(0x26e)]()['padStart'](0x2,'0');}function shiftedTime(){const _0xc827b=_0x418aae,_0x40931a=new Date();let _0x28521d=_0x40931a;if(settings[_0xc827b(0x321)]&&settings[_0xc827b(0x321)]!==0x0)_0x28521d=fns['add'](_0x40931a,{'hours':settings['timeshift']});return _0x28521d;}function startScheduler(){const _0x197a7a=_0x418aae;let _0x2ef42b=new Date()[_0x197a7a(0x247)]();_0x2ef42b==0x1&&backupConfigFiles();_0x2ef42b==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){fs['readdirSync'](configpath,{'withFileTypes':!![]})['forEach'](_0x129eaa=>{const _0x1666b4=_0x3d72;if(!_0x129eaa[_0x1666b4(0x317)]())fs[_0x1666b4(0x30a)](configpath+_0x129eaa[_0x1666b4(0x280)],configbackuppath+_0x129eaa[_0x1666b4(0x280)]);});}function triggerAnalytics(){const _0x3da69c=_0x418aae;analytics['page']({'title':_0x3da69c(0x2c5),'href':_0x3da69c(0x24d),'path':'/v'+serverversion});}function validateCredentials(_0x2e83c7,_0x3af52f){const _0x5e5cbf=_0x418aae;if(_0x2e83c7['username']==settings['bbUsername']&&bcrypt['compareSync'](_0x2e83c7[_0x5e5cbf(0x1f7)],settings[_0x5e5cbf(0x218)])){if(settings[_0x5e5cbf(0x28c)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x2878d6=generateLoginToken(_0x3af52f);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x2878d6};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x1ff2ac){const _0x23085d=generateLoginToken(_0x1ff2ac);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x23085d};}function validateAccess(_0x34d130,_0x31dab5){const _0x24ca5c=_0x418aae;let _0x2a9605=devices[_0x31dab5]['ip'],_0x484503;const _0x42be42=_0x11449a=>{const _0x1ab0b9=_0x3d72;if(settings['loginRequired']){if(settings[_0x1ab0b9(0x28c)]){if(telegram2FaApproved(_0x31dab5)){const _0x525a13=generateLoginToken(_0x31dab5);return{'allow':!![],'reason':_0x1ab0b9(0x223),'token':_0x525a13};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x484503=validToken(_0x11449a,_0x31dab5),_0x484503['hasOwnProperty']('success')?{'allow':!![],'reason':_0x1ab0b9(0x244),'token':_0x11449a}:{'allow':![],'reason':_0x1ab0b9(0x30c),'token':null};}else return{'allow':!![],'reason':_0x1ab0b9(0x252),'token':null};};if(settings[_0x24ca5c(0x270)]){let _0x5e075a=[...settings[_0x24ca5c(0x23f)],'::1','::ffff:127.0.0.1',_0x24ca5c(0x2a1)];if(_0x5e075a[_0x24ca5c(0x239)](_0x2a9605))return _0x42be42(_0x34d130);else{_0x484503=validToken(_0x34d130,_0x31dab5);if(_0x484503['hasOwnProperty'](_0x24ca5c(0x282)))return _0x42be42(_0x34d130);else{if(telegramIpApproved(_0x31dab5)){const _0xd2a8b2=generateToken(_0x31dab5);return _0x484503=_0x42be42(_0x34d130),_0x484503[_0x24ca5c(0x204)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0xd2a8b2}:_0x484503;}else return settings[_0x24ca5c(0x28d)]?{'allow':![],'reason':_0x24ca5c(0x2ac),'token':null}:{'allow':![],'reason':_0x24ca5c(0x2dc),'token':null};}}}else return _0x42be42(_0x34d130);}function _0x3d72(_0x4daf59,_0x2fb5a5){const _0x5bb03f=_0x4cc0();return _0x3d72=function(_0x322205,_0x23c7a3){_0x322205=_0x322205-0x1e8;let _0x4cc0b3=_0x5bb03f[_0x322205];return _0x4cc0b3;},_0x3d72(_0x4daf59,_0x2fb5a5);}function timelyDecrypt(_0x2a50be,_0x56af47=!![]){const _0x262c7f=_0x418aae;if(_0x2a50be)try{const _0x6ab868=crypt['decrypt'](secure[_0x262c7f(0x2b2)],_0x2a50be)[_0x262c7f(0x2ea)],_0x4979e8=_0x6ab868[_0x262c7f(0x2d7)]('@')[0x0],_0x14a5b7=_0x6ab868[_0x262c7f(0x2d7)]('@')[0x1],_0x2cfde9=new Date()[_0x262c7f(0x24c)]();if(_0x56af47){if(_0x2cfde9-_0x14a5b7<maxSecretAge*0x3e8)return _0x4979e8;else return![];}else return _0x4979e8;}catch(_0x5ece75){return![];}else return![];}const validToken=(_0x18c020,_0x2cf3d5)=>{const _0x2ba0ed=_0x418aae,_0x3b667f=devices[_0x2cf3d5]['ip'];if(!_0x18c020)return{'error':_0x2ba0ed(0x27d)};for(let _0x32e56b of blacklist){if(_0x32e56b[_0x2ba0ed(0x2de)]==_0x18c020)return{'error':_0x2ba0ed(0x2f3)};}let _0x31e05e;try{_0x31e05e=jwt[_0x2ba0ed(0x2e4)](_0x18c020,secure[_0x2ba0ed(0x2c4)]+_0x2cf3d5);}catch{return{'error':_0x2ba0ed(0x2bb)};}if(!_0x31e05e[_0x2ba0ed(0x233)]('clientip')&&!_0x31e05e['hasOwnProperty'](_0x2ba0ed(0x296))||!_0x31e05e[_0x2ba0ed(0x233)](_0x2ba0ed(0x245)))return{'error':_0x2ba0ed(0x2b4)};if(!_0x31e05e[_0x2ba0ed(0x233)](_0x2ba0ed(0x296))&&_0x31e05e[_0x2ba0ed(0x233)](_0x2ba0ed(0x2b1))){const {clientip:_0x150b9b}=_0x31e05e;return _0x3b667f==_0x150b9b?{'success':_0x2ba0ed(0x2f0)}:{'error':_0x2ba0ed(0x213)};}else{if(_0x31e05e['hasOwnProperty']('username')&&_0x31e05e['hasOwnProperty'](_0x2ba0ed(0x2b1))){const {username:_0x36d827,clientip:_0x5116cb}=_0x31e05e;return settings['bbUsername']==_0x36d827&&_0x3b667f==_0x5116cb?{'success':_0x2ba0ed(0x2f0)}:{'error':_0x2ba0ed(0x298)};}}},generateLoginToken=_0x5a7d5a=>{const _0x48f22e=_0x418aae;if(_0x5a7d5a){const _0x500a17=devices[_0x5a7d5a]['ip'];return jwt['sign']({'username':settings['bbUsername'],'clientip':_0x500a17},secure[_0x48f22e(0x2c4)]+_0x5a7d5a,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x31800b=>{const _0x2bd946=_0x418aae;if(_0x31800b){const _0x61194a=devices[_0x31800b]['ip'];return jwt[_0x2bd946(0x214)]({'clientip':_0x61194a},secure[_0x2bd946(0x2c4)]+_0x31800b,{'expiresIn':devices[_0x31800b][_0x2bd946(0x200)][_0x2bd946(0x30d)]*0x3c});}else return![];},telegramIpApproved=_0x8ca202=>{const _0x3b400c=_0x418aae;let _0x5e97b4=![];return devices[_0x8ca202][_0x3b400c(0x200)]&&devices[_0x8ca202][_0x3b400c(0x200)][_0x3b400c(0x30d)]!=_0x3b400c(0x20b)&&(_0x5e97b4=devices[_0x8ca202]['telegramIpApproval'][_0x3b400c(0x2b1)]==devices[_0x8ca202]['ip']&&new Date()[_0x3b400c(0x24c)]()-devices[_0x8ca202][_0x3b400c(0x200)][_0x3b400c(0x21e)]<devices[_0x8ca202][_0x3b400c(0x200)]['expiry']*0x3c*0x3e8),_0x5e97b4;},telegram2FaApproved=_0x14d5a5=>{const _0x59e1fa=_0x418aae;let _0x27d249=![];return devices[_0x14d5a5][_0x59e1fa(0x315)]&&devices[_0x14d5a5][_0x59e1fa(0x315)][_0x59e1fa(0x30d)]!=_0x59e1fa(0x20b)&&(_0x27d249=devices[_0x14d5a5]['telegram2FaApproval'][_0x59e1fa(0x2b1)]==devices[_0x14d5a5]['ip']&&new Date()['getTime']()-devices[_0x14d5a5][_0x59e1fa(0x315)]['timestamp']<devices[_0x14d5a5][_0x59e1fa(0x315)]['expiry']*0x3c*0x3e8),_0x27d249;},normalizeIP=_0x367dd6=>{const _0x1087da=_0x418aae;let _0x3a34ca=null,_0x132f63=null;if(ipaddr[_0x1087da(0x327)](_0x367dd6)){const _0x4dbb89=ipaddr[_0x1087da(0x1f2)](_0x367dd6);_0x4dbb89[_0x1087da(0x29b)]()===_0x1087da(0x269)?(_0x4dbb89[_0x1087da(0x2ba)]()&&(_0x3a34ca=_0x4dbb89[_0x1087da(0x1ff)]()['toString']()),_0x132f63=_0x4dbb89[_0x1087da(0x26e)]()):(_0x3a34ca=_0x4dbb89[_0x1087da(0x26e)](),_0x132f63=_0x4dbb89[_0x1087da(0x31b)]()['toString']());}return{'show':_0x3a34ca?_0x3a34ca:_0x132f63,'store':_0x132f63};};