const _0x56e2a6=_0x259d;(function(_0x3e3e0b,_0x2adbd6){const _0x125776=_0x259d,_0x490ba6=_0x3e3e0b();while(!![]){try{const _0x4445bf=parseInt(_0x125776(0x35d))/0x1*(parseInt(_0x125776(0x298))/0x2)+parseInt(_0x125776(0x23b))/0x3*(parseInt(_0x125776(0x23a))/0x4)+parseInt(_0x125776(0x276))/0x5*(parseInt(_0x125776(0x1e4))/0x6)+parseInt(_0x125776(0x36a))/0x7*(-parseInt(_0x125776(0x2a9))/0x8)+parseInt(_0x125776(0x268))/0x9+-parseInt(_0x125776(0x351))/0xa*(-parseInt(_0x125776(0x242))/0xb)+-parseInt(_0x125776(0x307))/0xc;if(_0x4445bf===_0x2adbd6)break;else _0x490ba6['push'](_0x490ba6['shift']());}catch(_0x5fd46b){_0x490ba6['push'](_0x490ba6['shift']());}}}(_0x626a,0x22acc));const _0x365570=function(){let _0x2aaa90=!![];return function(_0x351b57,_0x4d021d){const _0x1f2533=_0x2aaa90?function(){const _0x41a2ed=_0x259d;if(_0x4d021d){const _0x12e1d7=_0x4d021d[_0x41a2ed(0x1bd)](_0x351b57,arguments);return _0x4d021d=null,_0x12e1d7;}}:function(){};return _0x2aaa90=![],_0x1f2533;};}(),_0x1bbcbe=_0x365570(this,function(){const _0x4913ce=_0x259d;return _0x1bbcbe[_0x4913ce(0x382)]()[_0x4913ce(0x2b1)](_0x4913ce(0x31a))['toString']()[_0x4913ce(0x26f)](_0x1bbcbe)[_0x4913ce(0x2b1)](_0x4913ce(0x31a));});_0x1bbcbe();'use strict';process[_0x56e2a6(0x302)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x56e2a6(0x347)),fs=require('fs'),fns=require(_0x56e2a6(0x31b)),low=require(_0x56e2a6(0x373)),FileSync=require(_0x56e2a6(0x22c)),path=require(_0x56e2a6(0x217)),crypto=require(_0x56e2a6(0x210)),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require(_0x56e2a6(0x2bb))['RSA'],bcrypt=require(_0x56e2a6(0x25f)),jwt=require(_0x56e2a6(0x2fa)),ipaddr=require('ipaddr.js'),argv=require(_0x56e2a6(0x1c9))(process[_0x56e2a6(0x24e)]['slice'](0x2))[_0x56e2a6(0x24e)],uuidRandom=require('uuid-random'),TelegramBot=require(_0x56e2a6(0x31d)),Mixpanel=require(_0x56e2a6(0x356)),axios=require(_0x56e2a6(0x1db)),{GraphQLClient,gql}=require('graphql-request'),util=require('util'),fileUpload=require(_0x56e2a6(0x33a)),{networkInterfaces}=require('os'),PORT=argv[_0x56e2a6(0x226)]||_0x56e2a6(0x336),pattern=/^[0-9]{2,4}$/;!pattern[_0x56e2a6(0x201)](PORT)&&(console[_0x56e2a6(0x310)](_0x56e2a6(0x207)+PORT+_0x56e2a6(0x2ca)),process[_0x56e2a6(0x289)](0x1));const HOST=argv[_0x56e2a6(0x233)]||null,userID=argv[_0x56e2a6(0x28c)]||'',debugging=argv['d']||![],nodeversion=process[_0x56e2a6(0x2d8)]['node'];let bbpath='bb/',bbpath2='';const botfile=_0x56e2a6(0x1ea),configfile=_0x56e2a6(0x1f3),settingsfile='bb-settings.json',securefile=_0x56e2a6(0x2f2),maxBackups=0xa;let validInstallation=!![];!fs[_0x56e2a6(0x27c)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x56e2a6(0x297)),configpath=userID?bbpath+_0x56e2a6(0x2b4)+userID+'/':bbpath+'config/',configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x56e2a6(0x313)+userID+'/':bbpath+_0x56e2a6(0x313),zippath=userID?bbpath+_0x56e2a6(0x1d3)+userID+'/':bbpath+_0x56e2a6(0x1d3),loggerfile=fs[_0x56e2a6(0x257)](logspath+_0x56e2a6(0x36c),{'flags':'a'}),temppath=userID?bbpath+_0x56e2a6(0x2ff)+userID+'/':bbpath+_0x56e2a6(0x2ff);!fs['existsSync'](configpath)&&fs[_0x56e2a6(0x340)](configpath);!fs[_0x56e2a6(0x27c)](configbackuppath)&&fs[_0x56e2a6(0x340)](configbackuppath);function _0x259d(_0x2b5a00,_0x1eaa65){const _0x2f117a=_0x626a();return _0x259d=function(_0x1bbcbe,_0x365570){_0x1bbcbe=_0x1bbcbe-0x1b6;let _0x626a0f=_0x2f117a[_0x1bbcbe];return _0x626a0f;},_0x259d(_0x2b5a00,_0x1eaa65);}!fs[_0x56e2a6(0x27c)](logspath)&&fs[_0x56e2a6(0x340)](logspath);!fs['existsSync'](zippath)&&fs[_0x56e2a6(0x340)](zippath);!fs[_0x56e2a6(0x27c)](temppath)&&fs[_0x56e2a6(0x340)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x56e2a6(0x2e7)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x56e2a6(0x30a)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x56e2a6(0x2d3),'onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x56e2a6(0x2e7)]();let crypt=new Crypt({'md':_0x56e2a6(0x2ce),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x56e2a6(0x28a),{'host':_0x56e2a6(0x329)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x56e2a6(0x2ac)]&&settings[_0x56e2a6(0x2ac)]!=''&&settings[_0x56e2a6(0x266)]&&settings[_0x56e2a6(0x266)]!='')initTelegram();const parseColor=(_0x5c1963,_0x1010fc)=>{const _0xd863d2=_0x56e2a6,_0x59c95a=/#[A-Z]{3}#/g;if(typeof _0x5c1963==_0xd863d2(0x331)){!_0x1010fc?_0x5c1963=_0x5c1963['replace'](_0x59c95a,''):(_0x5c1963=_0x5c1963[_0xd863d2(0x2ea)](/#BLU#/g,_0xd863d2(0x2dc)),_0x5c1963=_0x5c1963[_0xd863d2(0x2ea)](/#RED#/g,_0xd863d2(0x1c1)),_0x5c1963=_0x5c1963[_0xd863d2(0x2ea)](/#YEL#/g,_0xd863d2(0x2e0)),_0x5c1963=_0x5c1963[_0xd863d2(0x2ea)](/#MAG#/g,_0xd863d2(0x334)),_0x5c1963=_0x5c1963[_0xd863d2(0x2ea)](/#CYA#/g,_0xd863d2(0x222)),_0x5c1963=_0x5c1963[_0xd863d2(0x2ea)](/#RES#/g,_0xd863d2(0x218)));;}return _0x5c1963;},logger={'screen':_0x464726=>{console['log'](parseColor(_0x464726,!![]));},'simple':_0x10583f=>{const _0x3cfc09=_0x56e2a6;console[_0x3cfc09(0x310)](parseColor(_0x10583f,!![])),loggerfile[_0x3cfc09(0x2e7)](util[_0x3cfc09(0x34f)](parseColor(_0x10583f,![]))+'\x0a');},'full':async _0x43eb90=>{const _0x448200=_0x56e2a6,_0x1cac3a=getTimeStamp()+_0x448200(0x26c)+_0x43eb90;console[_0x448200(0x310)](parseColor(_0x1cac3a,!![])),loggerfile[_0x448200(0x2e7)](util[_0x448200(0x34f)](parseColor(_0x1cac3a,![]))+'\x0a');if(tgBot&&settings[_0x448200(0x361)]&&settings[_0x448200(0x1ce)]!=_0x448200(0x281))await tgBot[_0x448200(0x1f2)](settings['telegramChatId'],_0x448200(0x1fe)+parseColor(_0x43eb90,![]))['catch'](_0x4d6556=>{telegramError(_0x4d6556);});},'debug':async(_0x22abaf,_0x3da191='')=>{const _0x3847bd=_0x56e2a6,_0x7de8ac=getTimeStamp()+_0x3847bd(0x245)+_0x22abaf;if(debugging)console[_0x3847bd(0x310)](parseColor(_0x7de8ac,!![]));loggerfile['write'](util[_0x3847bd(0x34f)](parseColor(_0x7de8ac,![]))+'\x0a');if(_0x3da191){if(debugging)console[_0x3847bd(0x310)](_0x3da191);loggerfile[_0x3847bd(0x2e7)](util['format'](_0x3da191)+'\x0a');}}};process['on'](_0x56e2a6(0x221),function(_0x1c67ac){logger['simple'](_0x1c67ac);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x56e2a6(0x1ee))[_0x56e2a6(0x37b)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x56e2a6(0x253)),app=express(),http=require(_0x56e2a6(0x247))['createServer'](app);app[_0x56e2a6(0x23e)](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x1effc4,_0xd30607)=>{const _0x363700=_0x56e2a6,_0x12425e=_0x1effc4[_0x363700(0x239)][_0x363700(0x38c)],_0x516a38=getClientsWithBotID('botmanager'),_0x1609c2=_0x1effc4[_0x363700(0x2da)]['uuid'],_0x2af40b=timelyDecrypt(_0x1609c2,![]),_0x34ab86=_0x516a38['find'](_0x462802=>_0x462802[_0x363700(0x235)]==_0x2af40b);if(_0x34ab86){const _0x313340=normalizeIP(_0x1effc4[_0x363700(0x299)][_0x363700(0x372)])[_0x363700(0x1bb)],_0x515446=_0x1effc4['headers']['tkn'];if(validateAccess(_0x515446,_0x2af40b,_0x313340)['allow'])_0x12425e==_0x363700(0x1ef)&&await backupConfigFiles(),await zipFiles(_0x12425e),_0xd30607[_0x363700(0x33f)](zippath+(_0x12425e+_0x363700(0x315)),_0x928876=>{const _0x1d4198=_0x363700;_0x928876&&(logger['full']('Failed\x20to\x20download\x20'+_0x12425e),logger[_0x1d4198(0x37f)](_0x928876));});else logger[_0x363700(0x32e)](_0x363700(0x375)+_0x12425e+'\x20(1)');}else logger[_0x363700(0x32e)](_0x363700(0x375)+_0x12425e+_0x363700(0x1c0));}),app[_0x56e2a6(0x271)](_0x56e2a6(0x216),async(_0x3507fc,_0xdac988)=>{const _0x1ab18d=_0x56e2a6,_0xb485a5=getClientsWithBotID(_0x1ab18d(0x38d)),_0x1f8915=_0x3507fc[_0x1ab18d(0x2da)][_0x1ab18d(0x235)],_0x4153fc=timelyDecrypt(_0x1f8915,![]),_0x45dcf7=_0xb485a5[_0x1ab18d(0x384)](_0x39de0c=>_0x39de0c[_0x1ab18d(0x235)]==_0x4153fc);logger[_0x1ab18d(0x320)](_0x1ab18d(0x2de));if(_0x45dcf7){const _0x1d5c71=normalizeIP(_0x3507fc[_0x1ab18d(0x299)][_0x1ab18d(0x372)])[_0x1ab18d(0x1bb)],_0x87075d=_0x3507fc[_0x1ab18d(0x2da)][_0x1ab18d(0x36d)];if(validateAccess(_0x87075d,_0x4153fc,_0x1d5c71)[_0x1ab18d(0x21a)]){if(_0x3507fc[_0x1ab18d(0x2e3)]){const _0x2470cb=_0x3507fc[_0x1ab18d(0x2e3)][_0x1ab18d(0x2a3)];await _0x2470cb['mv'](temppath+_0x2470cb[_0x1ab18d(0x22a)]),_0xdac988[_0x1ab18d(0x37c)]({'status':!![],'message':_0x1ab18d(0x1e9)});const _0x4fa754=getBotsWithMode();_0x4fa754['length']>0x0?confirmRestore(temppath,_0x2470cb[_0x1ab18d(0x22a)]):unzipFile(temppath,_0x2470cb[_0x1ab18d(0x22a)]);}}else logger[_0x1ab18d(0x32e)](_0x1ab18d(0x22e));}else logger[_0x1ab18d(0x32e)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x56e2a6(0x23e)](express['static'](path[_0x56e2a6(0x208)](__dirname,bbpath2,_0x56e2a6(0x35f)))),app[_0x56e2a6(0x23e)](express[_0x56e2a6(0x1d9)](path[_0x56e2a6(0x208)](__dirname,bbpath2,_0x56e2a6(0x2d0)))),app[_0x56e2a6(0x2f5)]('/',function(_0x30c566,_0x1e91cc){const _0x169625=_0x56e2a6;_0x1e91cc['sendFile'](path[_0x169625(0x208)](__dirname,bbpath2,_0x169625(0x35f),_0x169625(0x389)));}),app[_0x56e2a6(0x2f5)](_0x56e2a6(0x29e),function(_0x370ad7,_0x26031b){const _0x144be2=_0x56e2a6;_0x26031b[_0x144be2(0x32c)](path[_0x144be2(0x208)](__dirname,bbpath2,_0x144be2(0x2d0),_0x144be2(0x389)));}),app[_0x56e2a6(0x2f5)](_0x56e2a6(0x25d),(_0x246bfb,_0x3c81f1)=>{const _0x581cd6=_0x56e2a6;_0x3c81f1[_0x581cd6(0x32c)](path[_0x581cd6(0x208)](__dirname,bbpath2,_0x581cd6(0x2d0),_0x581cd6(0x389)));}),app[_0x56e2a6(0x2f5)](_0x56e2a6(0x1e8),(_0x1c9849,_0x3b9a91)=>{const _0x1d1619=_0x56e2a6;_0x3b9a91['sendFile'](path[_0x1d1619(0x208)](__dirname,bbpath2,_0x1d1619(0x2d0),_0x1d1619(0x389)));}),app[_0x56e2a6(0x2f5)]('/:bot/coins',(_0x404606,_0x5e1db5)=>{const _0x36520a=_0x56e2a6;_0x5e1db5['sendFile'](path[_0x36520a(0x208)](__dirname,bbpath2,'build',_0x36520a(0x389)));}),app[_0x56e2a6(0x2f5)](_0x56e2a6(0x2e5),(_0x244216,_0x255aed)=>{const _0x137e91=_0x56e2a6;_0x255aed[_0x137e91(0x32c)](path['join'](__dirname,bbpath2,_0x137e91(0x2d0),_0x137e91(0x389)));}),app['get']('/:bot/configuration',(_0x47e401,_0x4bf366)=>{const _0x5e9254=_0x56e2a6;_0x4bf366[_0x5e9254(0x32c)](path['join'](__dirname,bbpath2,'build',_0x5e9254(0x389)));}),app[_0x56e2a6(0x2f5)](_0x56e2a6(0x29f),(_0x2b0e3f,_0xd362d2)=>{const _0x19a03e=_0x56e2a6;_0xd362d2[_0x19a03e(0x32c)](path['join'](__dirname,bbpath2,_0x19a03e(0x2d0),_0x19a03e(0x389)));});if(HOST)http[_0x56e2a6(0x1f4)](PORT,HOST);else http[_0x56e2a6(0x1f4)](PORT);const io=require(_0x56e2a6(0x364))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x5f59de=_0x56e2a6;let _0x47ca85=_0x5f59de(0x2e8);const _0x146bc0=networkInterfaces(),_0x261b82={};for(const _0x3f3abe of Object[_0x5f59de(0x275)](_0x146bc0)){for(const _0x5ede36 of _0x146bc0[_0x3f3abe]){if((_0x5ede36[_0x5f59de(0x309)]=='IPv4'||_0x5ede36[_0x5f59de(0x309)]==0x4)&&!_0x5ede36[_0x5f59de(0x24b)]){const _0x35bf7a=ipaddr[_0x5f59de(0x34d)](_0x5ede36[_0x5f59de(0x204)])[_0x5f59de(0x385)]();_0x35bf7a!='private'&&(!_0x261b82[_0x3f3abe]&&(_0x261b82[_0x3f3abe]=[]),_0x261b82[_0x3f3abe][_0x5f59de(0x1c7)](_0x5ede36[_0x5f59de(0x204)]),_0x47ca85=_0x5ede36['address']);}}}return{'serverip':_0x47ca85,'netinterfaces':_0x261b82};}async function startServer(){const _0x21aa1b=_0x56e2a6,{serverip:_0x103c0b,netinterfaces:_0x541d5c}=getServerIP();logger[_0x21aa1b(0x37f)](''),logger['simple'](_0x21aa1b(0x240)),await logger['full'](_0x21aa1b(0x2f8)+serverversion+_0x21aa1b(0x223)+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x21aa1b(0x283)+_0x103c0b+':'+PORT+_0x21aa1b(0x379))),logger['simple'](_0x21aa1b(0x240));if(config[_0x21aa1b(0x32a)]!=0x0)for(const _0x3f4aab of config){if(_0x3f4aab['status']==_0x21aa1b(0x28f)||_0x3f4aab[_0x21aa1b(0x263)]==_0x21aa1b(0x1f1))await logger['full'](_0x21aa1b(0x25e)+_0x3f4aab[_0x21aa1b(0x301)]+_0x21aa1b(0x2cb)+_0x3f4aab['botname']),startBot([_0x3f4aab[_0x21aa1b(0x301)],userID],{'cwd':bbpath},function(_0x26d5e4){const _0x40163c=_0x21aa1b;if(_0x26d5e4)logger[_0x40163c(0x32e)](_0x26d5e4);});else(_0x3f4aab['status']=='disabled'||_0x3f4aab[_0x21aa1b(0x263)]==_0x21aa1b(0x280))&&await logger[_0x21aa1b(0x32e)](_0x21aa1b(0x211)+_0x3f4aab[_0x21aa1b(0x301)]+_0x21aa1b(0x2cb)+_0x3f4aab[_0x21aa1b(0x35a)]);}else!newBot&&logger['simple'](_0x21aa1b(0x2c3));if(newBot)addBot();logger[_0x21aa1b(0x37f)](_0x21aa1b(0x240)),logger['simple'](''),await logger[_0x21aa1b(0x320)](_0x21aa1b(0x2bc)+nodeversion),await logger[_0x21aa1b(0x320)](_0x21aa1b(0x21f),_0x541d5c);}function startSocket(){const _0x4c0097=_0x56e2a6;io['on'](_0x4c0097(0x2d7),_0x38a680=>{const _0x1f6c84=_0x4c0097;let _0x409181,_0x5dec1a,_0x333ec5,_0x5b0fbc,_0x3a3878;const _0x6c9046=_0x38a680[_0x1f6c84(0x1c3)][_0x1f6c84(0x2da)][_0x1f6c84(0x1d5)];_0x5dec1a=_0x6c9046['match'](/bot[0-9]{3}/);if(_0x5dec1a)_0x333ec5=_0x5dec1a[0x0][_0x1f6c84(0x294)](/[0-9]{3}/);if(_0x333ec5)_0x409181=_0x333ec5[0x0];else _0x409181='botmanager';const _0x15f75c=_0x38a680[_0x1f6c84(0x1c3)][_0x1f6c84(0x256)][_0x1f6c84(0x367)];if(!_0x15f75c)_0x38a680[_0x1f6c84(0x2c9)]('status',{'publicKey':secure['publicKey']});else{_0x5b0fbc=timelyDecrypt(_0x15f75c,![]);if(!_0x5b0fbc)_0x38a680[_0x1f6c84(0x2c9)]('status',{'publicKey':secure[_0x1f6c84(0x29d)]});else{_0x3a3878=normalizeIP(_0x38a680['conn'][_0x1f6c84(0x372)])[_0x1f6c84(0x1bb)];if(!devices[_0x5b0fbc])devices[_0x5b0fbc]={'uuid':_0x5b0fbc,'access':{'token':null}};devices[_0x5b0fbc]['ip']=_0x3a3878;const _0x1c6207=addClient(_0x38a680['id'],_0x5b0fbc,_0x409181);setAccess(_0x1c6207),emitMessages(),_0x38a680['on'](_0x1f6c84(0x269),_0x658eb8=>{const _0x4396b6=_0x1f6c84,_0xc167cc=timelyDecrypt(_0x658eb8['password']);if(_0xc167cc){_0x658eb8={'username':_0x658eb8[_0x4396b6(0x2c4)],'password':_0xc167cc},devices[_0x5b0fbc]['access']=validateCredentials(_0x658eb8,_0x5b0fbc);if(devices[_0x5b0fbc][_0x4396b6(0x23c)][_0x4396b6(0x21a)]==![]&&devices[_0x5b0fbc][_0x4396b6(0x23c)][_0x4396b6(0x1cf)]==_0x4396b6(0x1c8))_0x38a680[_0x4396b6(0x2c9)](_0x4396b6(0x263),{'access':devices[_0x5b0fbc][_0x4396b6(0x23c)]}),loginAccess2FA(_0x5b0fbc,_0x3a3878);else{if(devices[_0x5b0fbc]['access'][_0x4396b6(0x21a)]==![]&&devices[_0x5b0fbc][_0x4396b6(0x23c)][_0x4396b6(0x1cf)]==_0x4396b6(0x1e7))_0x38a680[_0x4396b6(0x2c9)](_0x4396b6(0x263),{'access':devices[_0x5b0fbc]['access']});else devices[_0x5b0fbc][_0x4396b6(0x23c)][_0x4396b6(0x21a)]&&devices[_0x5b0fbc][_0x4396b6(0x23c)][_0x4396b6(0x1cf)]==_0x4396b6(0x37a)&&(getClientsWithUuid(_0x5b0fbc)['forEach'](_0x29fc1d=>{setAccess(_0x29fc1d);}),logger[_0x4396b6(0x320)](_0x4396b6(0x22d)+_0x5b0fbc['slice'](-0x8)),setTokenRefresh(_0x5b0fbc),setSessionTimeout(_0x4396b6(0x269),_0x5b0fbc));}}else logger[_0x4396b6(0x32e)](_0x4396b6(0x1cd));}),_0x38a680['on'](_0x1f6c84(0x25a),()=>{resetPassword();}),_0x38a680['on'](_0x1f6c84(0x1f7),_0x43974a=>{removeClient(_0x38a680['id']);}),_0x409181==_0x1f6c84(0x38d)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x297626){const _0x1f28a3=_0x56e2a6;if(_0x297626!=_0x1f28a3(0x38d)&&config[_0x1f28a3(0x2a6)]!=''){if(pid[_0x297626])pid[_0x297626][_0x1f28a3(0x37c)]({'function':_0x1f28a3(0x2df),'args':null});}_0x297626!='botmanager'&&broadcastToBots('bots',JSON[_0x1f28a3(0x350)](config));}function reloadBotManager(){const _0x57d23b=_0x56e2a6;getClientsWithBotID('botmanager')[_0x57d23b(0x2e6)](_0xaf6561=>{const _0x190cb6=_0x57d23b;getSocket(_0xaf6561['id'])['emit']('status',{'access':{'allow':![],'reason':_0x190cb6(0x230),'token':null}});});}function getSocket(_0x27d05d){const _0x1ead71=_0x56e2a6;return io[_0x1ead71(0x30f)][_0x1ead71(0x30f)]['get'](_0x27d05d);}function setAccess(_0x45ef66){const _0x1c5671=_0x56e2a6,_0x315b03=getSocket(_0x45ef66['id']),_0x28ba0b=_0x45ef66['uuid'],_0xa439d8=_0x45ef66[_0x1c5671(0x2a0)];devices[_0x28ba0b][_0x1c5671(0x23c)]=validateAccess(devices[_0x28ba0b][_0x1c5671(0x23c)][_0x1c5671(0x24d)],_0x28ba0b),logger['debug'](_0x1c5671(0x206)+devices[_0x28ba0b][_0x1c5671(0x23c)][_0x1c5671(0x1cf)]+'\x20|\x20client:\x20...'+_0x45ef66['id']['slice'](-0x8)+_0x1c5671(0x1f0)+_0x28ba0b[_0x1c5671(0x2d4)](-0x8)),_0x315b03[_0x1c5671(0x208)](_0x28ba0b);if(devices[_0x28ba0b][_0x1c5671(0x23c)][_0x1c5671(0x21a)]){_0x315b03[_0x1c5671(0x208)](_0xa439d8);if(_0xa439d8==_0x1c5671(0x38d))initializeSocketBotManager(_0x315b03);else initializeSocketBot(_0x315b03);initClient(_0xa439d8);}devices[_0x28ba0b][_0x1c5671(0x23c)][_0x1c5671(0x24d)]&&devices[_0x28ba0b][_0x1c5671(0x23c)][_0x1c5671(0x1cf)]==_0x1c5671(0x1b9)&&setSessionTimeout(_0x1c5671(0x2c1),_0x28ba0b),devices[_0x28ba0b][_0x1c5671(0x23c)][_0x1c5671(0x24d)]&&devices[_0x28ba0b][_0x1c5671(0x23c)][_0x1c5671(0x1cf)]==_0x1c5671(0x232)&&setSessionTimeout(_0x1c5671(0x269),_0x28ba0b),_0x315b03[_0x1c5671(0x2c9)](_0x1c5671(0x263),{'status':_0x45ef66[_0x1c5671(0x236)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x28ba0b]['access'],'externalip':devices[_0x28ba0b]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x1c5671(0x24a)],'validInstallation':validInstallation}),devices[_0x28ba0b]['access'][_0x1c5671(0x21a)]==![]&&devices[_0x28ba0b][_0x1c5671(0x23c)][_0x1c5671(0x1cf)]==_0x1c5671(0x202)&&temporaryAccess2FA(_0x28ba0b,devices[_0x28ba0b]['ip']);}function setSessionTimeout(_0x27cb00,_0x32f844){const _0x55db1c=_0x56e2a6;let _0x5033df;if(_0x27cb00==_0x55db1c(0x269))_0x5033df=loginExpiry*0x3c*0x3e8;else _0x5033df=devices[_0x32f844][_0x55db1c(0x215)][_0x55db1c(0x262)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x32f844]['telegramIpApproval'][_0x55db1c(0x319)]);if(devices[_0x32f844][_0x55db1c(0x2e1)])clearTimeout(devices[_0x32f844]['pidExpireLogin']);devices[_0x32f844][_0x55db1c(0x2e1)]=setTimeout(()=>{const _0x3bd135=_0x55db1c;if(devices[_0x32f844][_0x3bd135(0x28b)])clearTimeout(devices[_0x32f844][_0x3bd135(0x28b)]);removeSocketListeners(_0x32f844),addBlacklist(_0x32f844),devices[_0x32f844][_0x3bd135(0x215)]=null,devices[_0x32f844][_0x3bd135(0x2b6)]=null,devices[_0x32f844][_0x3bd135(0x23c)][_0x3bd135(0x24d)]=null,logger[_0x3bd135(0x320)]('Session\x20expired\x20for\x20user\x20...'+_0x32f844['slice'](-0x8)),devices[_0x32f844][_0x3bd135(0x23c)]=validateAccess(devices[_0x32f844][_0x3bd135(0x23c)][_0x3bd135(0x24d)],_0x32f844),!(devices[_0x32f844]['access']['allow']&&devices[_0x32f844][_0x3bd135(0x23c)][_0x3bd135(0x1cf)]==_0x3bd135(0x278))&&(_0x27cb00==_0x3bd135(0x269)?io['to'](_0x32f844)[_0x3bd135(0x2c9)](_0x3bd135(0x263),{'access':{'allow':![],'reason':_0x3bd135(0x371),'token':null}}):io['to'](_0x32f844)[_0x3bd135(0x2c9)](_0x3bd135(0x263),{'access':{'allow':![],'reason':_0x3bd135(0x2c0),'token':null}})),devices[_0x32f844]['access']['token']=null;},_0x5033df);}function setTokenRefresh(_0x48a5ce){const _0xd0918f=_0x56e2a6;if(devices[_0x48a5ce][_0xd0918f(0x28b)])clearTimeout(devices[_0x48a5ce][_0xd0918f(0x28b)]);devices[_0x48a5ce][_0xd0918f(0x28b)]=setTimeout(()=>{const _0x35ec88=_0xd0918f;getClientsWithUuid(_0x48a5ce)[_0x35ec88(0x32a)]!=0x0?(devices[_0x48a5ce][_0x35ec88(0x23c)]=refreshToken(_0x48a5ce),io['to'](_0x48a5ce)[_0x35ec88(0x2c9)]('status',{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x48a5ce][_0x35ec88(0x23c)],'externalip':devices[_0x48a5ce]['ip'],'publicKey':secure[_0x35ec88(0x29d)],'validInstallation':validInstallation}),setTokenRefresh(_0x48a5ce)):clearTimeout(devices[_0x48a5ce][_0x35ec88(0x28b)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x524669){const _0x3c7f9c=_0x56e2a6,_0x33de91=getClient(_0x524669['id'])[_0x3c7f9c(0x235)];_0x524669[_0x3c7f9c(0x2c9)]('bots',config),_0x524669[_0x3c7f9c(0x2c9)](_0x3c7f9c(0x2cd),cleanSettings()),_0x524669['on'](_0x3c7f9c(0x2f9),_0x3267da=>{const _0x5ec9a0=_0x3c7f9c;if(validateAccess(_0x3267da,_0x33de91)[_0x5ec9a0(0x21a)])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x524669['on'](_0x3c7f9c(0x225),(_0x2a6f09,_0x1a5e82)=>{const _0xc32916=_0x3c7f9c;if(validateAccess(_0x1a5e82,_0x33de91)[_0xc32916(0x21a)])toggleBot(_0x2a6f09[_0xc32916(0x301)],_0x2a6f09['status'],_0x2a6f09[_0xc32916(0x26e)]);else logger[_0xc32916(0x32e)](_0xc32916(0x363));}),_0x524669['on'](_0x3c7f9c(0x1e6),(_0x15e65a,_0x119434)=>{const _0x12b10e=_0x3c7f9c;if(validateAccess(_0x119434,_0x33de91)[_0x12b10e(0x21a)])toggleBotMode(_0x15e65a);else logger[_0x12b10e(0x32e)](_0x12b10e(0x363));}),_0x524669['on'](_0x3c7f9c(0x308),(_0x3b7ced,_0x18a76a)=>{const _0x184c74=_0x3c7f9c;if(validateAccess(_0x18a76a,_0x33de91)[_0x184c74(0x21a)])deleteBot(_0x3b7ced);else logger[_0x184c74(0x32e)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x524669['on'](_0x3c7f9c(0x267),(_0x51245d,_0x484db0)=>{const _0x2de159=_0x3c7f9c;if(validateAccess(_0x484db0,_0x33de91)[_0x2de159(0x21a)])storeSettings(_0x51245d,!![]);else logger[_0x2de159(0x32e)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x524669['on'](_0x3c7f9c(0x332),_0x2fcaa2=>{const _0x2ff6eb=_0x3c7f9c;if(validateAccess(_0x2fcaa2,_0x33de91)['allow'])updateBB(_0x2ff6eb(0x322));else logger['full'](_0x2ff6eb(0x2a7));}),_0x524669['on'](_0x3c7f9c(0x29b),_0x11eb09=>{const _0x4ba236=_0x3c7f9c;if(validateAccess(_0x11eb09,_0x33de91)['allow'])updateBB('reinstall');else logger[_0x4ba236(0x32e)](_0x4ba236(0x244));}),_0x524669['on'](_0x3c7f9c(0x2b5),_0x3d6afb=>{const _0x4a01=_0x3c7f9c;if(validateAccess(_0x3d6afb,_0x33de91)['allow']){const _0x3ca52f=getClient(_0x524669['id']);if(_0x3ca52f)getBackupFiles(_0x3ca52f[_0x4a01(0x235)]);else logger[_0x4a01(0x32e)](_0x4a01(0x28e));}else logger[_0x4a01(0x32e)](_0x4a01(0x36f));}),_0x524669['on']('restore-backup-file',(_0x51b011,_0x1ca1dc)=>{const _0x100f4e=_0x3c7f9c;if(validateAccess(_0x1ca1dc,_0x33de91)[_0x100f4e(0x21a)])restoreBackupFile(_0x51b011);else logger['full']('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x524669['on'](_0x3c7f9c(0x305),_0x4535ed=>{const _0x145ba6=_0x3c7f9c;if(validateAccess(_0x4535ed,_0x33de91)[_0x145ba6(0x21a)])getMessages();else logger[_0x145ba6(0x32e)](_0x145ba6(0x34b));}),_0x524669['on']('confirm-message',(_0x1b31f1,_0x54d378)=>{const _0x5045ac=_0x3c7f9c;if(validateAccess(_0x54d378,_0x33de91)[_0x5045ac(0x21a)])confirmMessage(_0x1b31f1);else logger[_0x5045ac(0x32e)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x524669['on'](_0x3c7f9c(0x35e),_0x4ed8b0=>{const _0x3d6387=_0x3c7f9c;if(validateAccess(_0x4ed8b0,_0x33de91)[_0x3d6387(0x21a)]){if(devices[_0x33de91][_0x3d6387(0x28b)])clearTimeout(devices[_0x33de91]['pidRefreshToken']);if(devices[_0x33de91][_0x3d6387(0x2e1)])clearTimeout(devices[_0x33de91][_0x3d6387(0x2e1)]);removeSocketListeners(getClient(_0x524669['id'])[_0x3d6387(0x235)]),addBlacklist(_0x33de91),devices[_0x33de91]['telegramIpApproval']=null,devices[_0x33de91][_0x3d6387(0x2b6)]=null,devices[_0x33de91][_0x3d6387(0x23c)][_0x3d6387(0x24d)]=null,logger[_0x3d6387(0x320)](_0x3d6387(0x1ed)+_0x33de91[_0x3d6387(0x2d4)](-0x8)),io['to'](getClient(_0x524669['id'])[_0x3d6387(0x235)])[_0x3d6387(0x2c9)](_0x3d6387(0x263),{'access':{'allow':![],'reason':_0x3d6387(0x381),'token':null}});}else logger[_0x3d6387(0x32e)](_0x3d6387(0x380));});}function initializeSocketBot(_0x1db69e){const _0x2988dd=_0x56e2a6,_0x2afbe6=getClient(_0x1db69e['id'])[_0x2988dd(0x2a0)],_0x17db12=getClient(_0x1db69e['id'])[_0x2988dd(0x235)];_0x1db69e['on'](_0x2988dd(0x386),(_0x2765e9,_0x1c5972)=>{const _0x4e9f5e=_0x2988dd;if(validateAccess(_0x1c5972,_0x17db12)[_0x4e9f5e(0x21a)]){if(pid[_0x2afbe6])pid[_0x2afbe6]['send']({'function':'emitHistory','args':_0x2765e9});}else logger['full'](_0x4e9f5e(0x1d8));}),_0x1db69e['on'](_0x2988dd(0x272),(_0x26cd91,_0x188537)=>{const _0x12b3f6=_0x2988dd;if(validateAccess(_0x188537,_0x17db12)['allow']){if(pid[_0x2afbe6])pid[_0x2afbe6][_0x12b3f6(0x37c)]({'function':_0x12b3f6(0x1fa),'args':_0x26cd91});}else logger['full'](_0x12b3f6(0x1cc));}),_0x1db69e['on'](_0x2988dd(0x368),(_0x5f4840,_0x9d628e)=>{const _0x241a00=_0x2988dd;if(validateAccess(_0x9d628e,_0x17db12)['allow']){if(pid[_0x2afbe6])pid[_0x2afbe6][_0x241a00(0x37c)]({'function':_0x241a00(0x326),'args':_0x5f4840});}else logger['full'](_0x241a00(0x27a));}),_0x1db69e['on'](_0x2988dd(0x34e),(_0x3c5824,_0x13fe81)=>{const _0x45aca8=_0x2988dd;if(validateAccess(_0x13fe81,_0x17db12)[_0x45aca8(0x21a)]){if(pid[_0x2afbe6])pid[_0x2afbe6]['send']({'function':_0x45aca8(0x273),'args':_0x3c5824});}else logger['full'](_0x45aca8(0x290));}),_0x1db69e['on'](_0x2988dd(0x250),(_0x52c710,_0x33abb3)=>{const _0x5beb44=_0x2988dd;if(validateAccess(_0x33abb3,_0x17db12)['allow']){if(pid[_0x2afbe6])pid[_0x2afbe6][_0x5beb44(0x37c)]({'function':'storeHeadless','args':_0x52c710});}else logger['full'](_0x5beb44(0x2e4));}),_0x1db69e['on'](_0x2988dd(0x205),(_0x31fcde,_0x13d27f)=>{const _0x318ee1=_0x2988dd;if(validateAccess(_0x13d27f,_0x17db12)[_0x318ee1(0x21a)]){if(pid[_0x2afbe6])pid[_0x2afbe6][_0x318ee1(0x37c)]({'function':_0x318ee1(0x1c4),'args':_0x31fcde});}else logger[_0x318ee1(0x32e)](_0x318ee1(0x30d));}),_0x1db69e['on'](_0x2988dd(0x37d),_0x390ee5=>{const _0x26528e=_0x2988dd;if(validateAccess(_0x390ee5,_0x17db12)[_0x26528e(0x21a)]){if(pid[_0x2afbe6])pid[_0x2afbe6][_0x26528e(0x37c)]({'function':'resetHistory','args':null});}else logger[_0x26528e(0x32e)](_0x26528e(0x212));}),_0x1db69e['on'](_0x2988dd(0x1fd),_0x2378b2=>{const _0x2476db=_0x2988dd;if(validateAccess(_0x2378b2,_0x17db12)[_0x2476db(0x21a)]){if(pid[_0x2afbe6])pid[_0x2afbe6][_0x2476db(0x37c)]({'function':_0x2476db(0x2c8),'args':null});}else logger['full'](_0x2476db(0x20b));}),_0x1db69e['on'](_0x2988dd(0x32f),(_0x49a15c,_0x5ca9eb)=>{const _0x3696a8=_0x2988dd;if(validateAccess(_0x5ca9eb,_0x17db12)['allow']){if(pid[_0x2afbe6])pid[_0x2afbe6][_0x3696a8(0x37c)]({'function':_0x3696a8(0x1d7),'args':_0x49a15c});}else logger[_0x3696a8(0x32e)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x1db69e['on']('cancel-loading',_0x2d84df=>{const _0x1b72aa=_0x2988dd;if(validateAccess(_0x2d84df,_0x17db12)[_0x1b72aa(0x21a)]){if(pid[_0x2afbe6])pid[_0x2afbe6][_0x1b72aa(0x37c)]({'function':_0x1b72aa(0x258),'args':null});}else logger[_0x1b72aa(0x32e)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x1db69e['on']('show-config',_0x13452a=>{const _0x1581d0=_0x2988dd;if(validateAccess(_0x13452a,_0x17db12)[_0x1581d0(0x21a)]){if(pid[_0x2afbe6])pid[_0x2afbe6][_0x1581d0(0x37c)]({'function':'showConfig','args':null});}else logger[_0x1581d0(0x32e)](_0x1581d0(0x2ed));}),_0x1db69e['on']('update-bb',_0x5b26c4=>{const _0x4591b2=_0x2988dd;if(validateAccess(_0x5b26c4,_0x17db12)[_0x4591b2(0x21a)])updateBB(_0x4591b2(0x322));else logger[_0x4591b2(0x32e)](_0x4591b2(0x2a7));}),_0x1db69e['on'](_0x2988dd(0x305),_0x5e4267=>{const _0x551da4=_0x2988dd;if(validateAccess(_0x5e4267,_0x17db12)[_0x551da4(0x21a)])getMessages();else logger['full'](_0x551da4(0x34b));}),_0x1db69e['on'](_0x2988dd(0x1df),(_0x8beb58,_0x36b144)=>{const _0x5d7891=_0x2988dd;if(validateAccess(_0x36b144,_0x17db12)[_0x5d7891(0x21a)])confirmMessage(_0x8beb58);else logger['full'](_0x5d7891(0x317));}),_0x1db69e['on'](_0x2988dd(0x35e),_0x2c80d4=>{const _0x54107d=_0x2988dd;if(validateAccess(_0x2c80d4,_0x17db12)['allow']){if(devices[_0x17db12][_0x54107d(0x28b)])clearTimeout(devices[_0x17db12][_0x54107d(0x28b)]);if(devices[_0x17db12]['pidExpireLogin'])clearTimeout(devices[_0x17db12][_0x54107d(0x2e1)]);removeSocketListeners(getClient(_0x1db69e['id'])[_0x54107d(0x235)]),addBlacklist(_0x17db12),devices[_0x17db12][_0x54107d(0x215)]=null,devices[_0x17db12][_0x54107d(0x2b6)]=null,devices[_0x17db12][_0x54107d(0x23c)][_0x54107d(0x24d)]=null,logger[_0x54107d(0x320)](_0x54107d(0x1ed)+_0x17db12[_0x54107d(0x2d4)](-0x8)),io['to'](getClient(_0x1db69e['id'])[_0x54107d(0x235)])[_0x54107d(0x2c9)](_0x54107d(0x263),{'access':{'allow':![],'reason':_0x54107d(0x381),'token':null}});}else logger[_0x54107d(0x32e)](_0x54107d(0x380));});}function removeSocketListeners(_0x305bb0){const _0x3747b5=_0x56e2a6;getClientsWithUuid(_0x305bb0)[_0x3747b5(0x2e6)](_0x3881bf=>{const _0xa0c1c4=_0x3747b5;getSocket(_0x3881bf['id'])[_0xa0c1c4(0x2f4)]();});}function cleanSettings(){const _0x246cca=_0x56e2a6;let _0x2760c8=settings;return settings[_0x246cca(0x2ac)]&&settings[_0x246cca(0x2ac)]!=''&&(_0x2760c8={..._0x2760c8,'telegramToken':_0x246cca(0x203)}),settings[_0x246cca(0x270)]&&settings[_0x246cca(0x270)]!=''&&(_0x2760c8={..._0x2760c8,'bbPassword':_0x246cca(0x203)}),(settings['bbPassword']&&settings[_0x246cca(0x270)]==_0x246cca(0x288)||settings[_0x246cca(0x2ac)]&&settings[_0x246cca(0x2ac)]==_0x246cca(0x288))&&(_0x2760c8={..._0x2760c8,'restored':{'password':settings[_0x246cca(0x270)]=='***','telegram':settings[_0x246cca(0x2ac)]==_0x246cca(0x288)}}),_0x2760c8;}async function updateBB(_0x7d2b42){const _0x222bf1=_0x56e2a6;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x4a2258=>{restartBot(_0x4a2258['botID']);}),logger[_0x222bf1(0x320)]('Starting\x20Balance\x20Bot\x20'+_0x7d2b42);if(_0x7d2b42=='update')process[_0x222bf1(0x37c)]({'update':!![]},_0x36992a=>{});else _0x7d2b42==_0x222bf1(0x21b)&&process['send']({'reinstall':!![]},_0x210371=>{});}function startBot(_0x2c57ac,_0x5a027a,_0x2e09f8){const _0x4c9afa=_0x56e2a6;if(debugging)_0x2c57ac[_0x4c9afa(0x1c7)]('-d');let _0x3bb11a=![];const _0x52eb07=_0x2c57ac[0x0];_0x5a027a={..._0x5a027a,'stdio':[_0x4c9afa(0x304),'inherit','inherit',_0x4c9afa(0x214)]},pid[_0x52eb07]=childProcess[_0x4c9afa(0x2b9)](botfile,_0x2c57ac,_0x5a027a),pid[_0x52eb07]['on'](_0x4c9afa(0x2c2),_0x1987b0=>{const _0x6f195c=_0x4c9afa;switch(Object[_0x6f195c(0x275)](_0x1987b0)[0x0]){case _0x6f195c(0x35a):updateBotName(_0x52eb07,_0x1987b0['botname']);break;case'updatebotmanager':updateBotManager();break;case'status':updateStatus(_0x52eb07,_0x1987b0['status']);break;case _0x6f195c(0x26e):updateLive(_0x52eb07,_0x1987b0[_0x6f195c(0x26e)]);break;case _0x6f195c(0x2b3):updateLive(_0x52eb07,_0x1987b0[_0x6f195c(0x2b3)]),io['to'](_0x52eb07)[_0x6f195c(0x2c9)](_0x6f195c(0x263),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x6f195c(0x355):_0x1987b0[_0x6f195c(0x355)]=='restart'&&restartBot(_0x52eb07);_0x1987b0['stop']==_0x6f195c(0x1dd)&&toggleBot(_0x52eb07,_0x6f195c(0x21c),_0x6f195c(0x1bf));break;case'telegram':sendTelegram(_0x52eb07,_0x1987b0[_0x6f195c(0x2fd)]);break;case'telegrammsg':sendTelegramMsg(_0x1987b0[_0x6f195c(0x311)]);break;case _0x6f195c(0x1e5):io['to'](_0x52eb07)[_0x6f195c(0x2c9)](_0x1987b0['function'],_0x1987b0['args']);break;}}),pid[_0x52eb07]['on'](_0x4c9afa(0x1d6),function(_0x129d65){if(_0x3bb11a)return;_0x3bb11a=!![],_0x2e09f8(_0x129d65);}),pid[_0x52eb07]['on']('exit',async function(_0x55fb4f){const _0x1fb5f1=_0x4c9afa;if(installingUpdate)return;if(_0x3bb11a)return;_0x3bb11a=!![],_0x2e09f8(null);const _0x58b454=dbConfig['get'](_0x1fb5f1(0x2b7))[_0x1fb5f1(0x384)]({'botID':_0x52eb07})[_0x1fb5f1(0x27f)]();_0x58b454&&(_0x58b454[_0x1fb5f1(0x263)]==_0x1fb5f1(0x28f)||_0x58b454[_0x1fb5f1(0x263)]==_0x1fb5f1(0x1f1))&&(await sleep(0x3e8),updateLive(_0x52eb07,_0x1fb5f1(0x1bf)),logger[_0x1fb5f1(0x32e)](_0x1fb5f1(0x26a)+_0x52eb07),startBot([_0x52eb07,userID],{'cwd':bbpath},function(_0x37267f){const _0x4a4dd3=_0x1fb5f1;if(_0x37267f)logger[_0x4a4dd3(0x32e)](_0x37267f);}));});}function stopBot(_0x2fa4fd){const _0x164fce=_0x56e2a6;getClientsWithBotID(_0x2fa4fd)['forEach'](_0x4e18cb=>{const _0x471bb8=_0x259d;getSocket(_0x4e18cb['id'])[_0x471bb8(0x1f7)](!![]),removeClient(_0x4e18cb['id']);}),pid[_0x2fa4fd]&&(pid[_0x2fa4fd][_0x164fce(0x1dd)](),pid[_0x2fa4fd]=null);}function restartBot(_0x357ee6){const _0x12a687=_0x56e2a6;if(pid[_0x357ee6])pid[_0x357ee6][_0x12a687(0x1dd)]();}function addBot(){const _0x5c8fed=_0x56e2a6;let _0x2b19e;for(let _0xea45d6=0x1;_0xea45d6<0x3e9;_0xea45d6++){_0x2b19e=_0xea45d6['toString']()[_0x5c8fed(0x259)](0x3,'0');let _0x18e80c=config['find'](_0x6c2e50=>_0x6c2e50[_0x5c8fed(0x301)]==_0x2b19e);if(!_0x18e80c)break;}if(_0x2b19e===_0x5c8fed(0x1b7)){logger['full'](_0x5c8fed(0x2f3));return;}logger[_0x5c8fed(0x32e)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x2b19e),dbConfig[_0x5c8fed(0x2f5)](_0x5c8fed(0x2b7))['push']({'botID':_0x2b19e,'botname':'Bot\x20'+_0x2b19e,'status':_0x5c8fed(0x1f1),'live':''})[_0x5c8fed(0x2e7)](),startBot([_0x2b19e,userID],{'cwd':bbpath},function(_0x3878ab){const _0x4afd00=_0x5c8fed;if(_0x3878ab)logger[_0x4afd00(0x32e)](_0x3878ab);}),config=getConfiguration(),io['to'](_0x5c8fed(0x38d))[_0x5c8fed(0x2c9)](_0x5c8fed(0x2b7),config),broadcastToBots(_0x5c8fed(0x2b7),JSON[_0x5c8fed(0x350)](config));}function deleteBot(_0x43f549){const _0x2f4128=_0x56e2a6;getClientsWithBotID(_0x43f549)[_0x2f4128(0x2e6)](_0x5a8f88=>{const _0x3b15cb=_0x2f4128;getSocket(_0x5a8f88['id'])[_0x3b15cb(0x1f7)](!![]),removeClient(_0x5a8f88['id']);}),dbConfig['get'](_0x2f4128(0x2b7))[_0x2f4128(0x209)]({'botID':_0x43f549})['write'](),logger['full'](_0x2f4128(0x1d2)+_0x43f549),stopBot(_0x43f549);try{if(fs[_0x2f4128(0x27c)](path[_0x2f4128(0x208)](configpath,_0x2f4128(0x1e3)+_0x43f549+_0x2f4128(0x1ec))))fs[_0x2f4128(0x2c7)](path[_0x2f4128(0x208)](configpath,_0x2f4128(0x1e3)+_0x43f549+'-config.json'));if(fs[_0x2f4128(0x27c)](path[_0x2f4128(0x208)](configpath,_0x2f4128(0x1e3)+_0x43f549+_0x2f4128(0x32d))))fs[_0x2f4128(0x2c7)](path[_0x2f4128(0x208)](configpath,_0x2f4128(0x1e3)+_0x43f549+_0x2f4128(0x32d)));if(fs[_0x2f4128(0x27c)](path[_0x2f4128(0x208)](configpath,_0x2f4128(0x1e3)+_0x43f549+'-performance.json')))fs[_0x2f4128(0x2c7)](path[_0x2f4128(0x208)](configpath,_0x2f4128(0x1e3)+_0x43f549+_0x2f4128(0x260)));if(fs['existsSync'](path['join'](configpath,'bot-'+_0x43f549+_0x2f4128(0x366))))fs[_0x2f4128(0x2c7)](path[_0x2f4128(0x208)](configpath,_0x2f4128(0x1e3)+_0x43f549+_0x2f4128(0x366)));}catch(_0x46c850){if(_0x46c850)logger['full'](_0x2f4128(0x2ae),_0x46c850);}config=getConfiguration(),io['to'](_0x2f4128(0x38d))[_0x2f4128(0x2c9)]('bots',config),broadcastToBots('bots',JSON[_0x2f4128(0x350)](config));}function toggleBot(_0x1cb8f2,_0x525aad,_0xf83024){const _0x1b2c47=_0x56e2a6;dbConfig['get'](_0x1b2c47(0x2b7))[_0x1b2c47(0x384)]({'botID':_0x1cb8f2})['assign']({'status':_0x525aad})[_0x1b2c47(0x2ad)]({'live':_0xf83024})[_0x1b2c47(0x2e7)]();if(_0x525aad==_0x1b2c47(0x28f)||_0x525aad=='new')logger[_0x1b2c47(0x32e)](_0x1b2c47(0x318)+_0x1cb8f2),startBot([_0x1cb8f2,userID],{'cwd':bbpath},function(_0x1ab91c){const _0x402105=_0x1b2c47;if(_0x1ab91c)logger[_0x402105(0x32e)](_0x1ab91c);});else(_0x525aad==_0x1b2c47(0x21c)||_0x525aad==_0x1b2c47(0x280))&&(logger[_0x1b2c47(0x32e)](_0x1b2c47(0x387)+_0x1cb8f2),stopBot(_0x1cb8f2));config=getConfiguration(),io['to'](_0x1b2c47(0x38d))[_0x1b2c47(0x2c9)](_0x1b2c47(0x2b7),config),broadcastToBots(_0x1b2c47(0x2b7),JSON[_0x1b2c47(0x350)](config));}function toggleStatus(_0x5e93ca){const _0x381ba3=_0x56e2a6;let _0x1bf7e1=dbConfig['get'](_0x381ba3(0x2b7))['find']({'botID':_0x5e93ca})[_0x381ba3(0x27f)](),_0x15751c;if(_0x1bf7e1[_0x381ba3(0x263)]==='enabled')_0x15751c=_0x381ba3(0x21c);else{if(_0x1bf7e1[_0x381ba3(0x263)]===_0x381ba3(0x1f1))_0x15751c=_0x381ba3(0x280);else{if(_0x1bf7e1[_0x381ba3(0x263)]===_0x381ba3(0x280))_0x15751c=_0x381ba3(0x1f1);else{if(_0x1bf7e1[_0x381ba3(0x263)]===_0x381ba3(0x21c))_0x15751c=_0x381ba3(0x28f);}}}return _0x15751c;}function updateStatus(_0x20610e,_0x2c3f70){const _0x19c4be=_0x56e2a6;dbConfig['get'](_0x19c4be(0x2b7))[_0x19c4be(0x384)]({'botID':_0x20610e})[_0x19c4be(0x2ad)]({'status':_0x2c3f70})['write'](),config=getConfiguration(),io['to'](_0x19c4be(0x38d))[_0x19c4be(0x2c9)](_0x19c4be(0x2b7),config),broadcastToBots(_0x19c4be(0x2b7),JSON[_0x19c4be(0x350)](config));}function updateLive(_0x2a6b34,_0x213aa7){const _0x26427e=_0x56e2a6;dbConfig[_0x26427e(0x2f5)](_0x26427e(0x2b7))[_0x26427e(0x384)]({'botID':_0x2a6b34})[_0x26427e(0x2ad)]({'live':_0x213aa7})['write'](),config=getConfiguration(),io['to'](_0x26427e(0x38d))[_0x26427e(0x2c9)]('bots',config),broadcastToBots(_0x26427e(0x2b7),JSON['stringify'](config));}function updateBotName(_0xe267ae,_0x56cb59){const _0x1e3853=_0x56e2a6;dbConfig[_0x1e3853(0x2f5)](_0x1e3853(0x2b7))['find']({'botID':_0xe267ae})[_0x1e3853(0x2ad)]({'botname':_0x56cb59})['write'](),config=getConfiguration(),io['to'](_0x1e3853(0x38d))[_0x1e3853(0x2c9)](_0x1e3853(0x2b7),config),broadcastToBots(_0x1e3853(0x2b7),JSON['stringify'](config));}function updateBotManager(){const _0x17a350=_0x56e2a6;config=getConfiguration(),io['to'](_0x17a350(0x38d))['emit'](_0x17a350(0x2b7),config),broadcastToBots(_0x17a350(0x2b7),JSON[_0x17a350(0x350)](config));}function toggleBotMode(_0xf86253){const _0x11fc4f=_0x56e2a6;if(pid[_0xf86253])pid[_0xf86253][_0x11fc4f(0x37c)]({'function':'toggleBotMode','args':null});else{const _0x483a5d=configpath+_0x11fc4f(0x1e3)+_0xf86253+_0x11fc4f(0x1ec),_0x591b9a=fs[_0x11fc4f(0x27e)](_0x483a5d),_0x71b03b=JSON[_0x11fc4f(0x34d)](_0x591b9a),_0x40d3bc=_0x71b03b[_0x11fc4f(0x2a0)][0x0][_0x11fc4f(0x219)];_0x71b03b[_0x11fc4f(0x2a0)][0x0][_0x11fc4f(0x219)]=!_0x40d3bc;const _0x41c42e=JSON[_0x11fc4f(0x350)](_0x71b03b,null,0x2);fs[_0x11fc4f(0x2ef)](_0x483a5d,_0x41c42e),config=getConfiguration(),io['to']('botmanager')[_0x11fc4f(0x2c9)](_0x11fc4f(0x2b7),config),broadcastToBots('bots',JSON[_0x11fc4f(0x350)](config));}}function telegramError(_0x444fae){const _0x3b88b9=_0x56e2a6;logger[_0x3b88b9(0x37f)](getTimeStamp()+_0x3b88b9(0x2f7));}function validateTelegram(_0xf7814b){const _0x29bcc6=_0x56e2a6;if(_0xf7814b[_0x29bcc6(0x279)]['username']!=settings[_0x29bcc6(0x266)]&&'@'+_0xf7814b[_0x29bcc6(0x279)][_0x29bcc6(0x2c4)]!=settings[_0x29bcc6(0x266)])return tgBot['sendMessage'](_0xf7814b[_0x29bcc6(0x1b8)]['id'],_0x29bcc6(0x2e9),{'parse_mode':'HTML'})[_0x29bcc6(0x1d1)](_0x4c1449=>{telegramError(_0x4c1449);}),![];return!![];}async function initTelegram(){const _0x21ca0a=_0x56e2a6;if(tgBot)tgBot[_0x21ca0a(0x2a2)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x21ca0a(0x2ac)],{'polling':!![]});let _0xf8368='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0xf8368+='\x0a',_0xf8368+=_0x21ca0a(0x344),_0xf8368+=_0x21ca0a(0x20d),_0xf8368+=_0x21ca0a(0x293),_0xf8368+=_0x21ca0a(0x391),_0xf8368+=_0x21ca0a(0x345),_0xf8368+=_0x21ca0a(0x1d4),_0xf8368+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0xf8368+=_0x21ca0a(0x27b),_0xf8368+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0xf8368+=_0x21ca0a(0x28d),_0xf8368+=_0x21ca0a(0x306),_0xf8368+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0xf8368+=_0x21ca0a(0x291),_0xf8368+=_0x21ca0a(0x29c);let _0x455ff6=_0x21ca0a(0x1f9);_0x455ff6+='\x0a',_0x455ff6+=_0xf8368,tgBot['onText'](/\/start/,_0x1c46d1=>{const _0x3add75=_0x21ca0a;if(!validateTelegram(_0x1c46d1))return;if(settings[_0x3add75(0x361)]!=_0x1c46d1[_0x3add75(0x1b8)]['id'])updateSetting(_0x3add75(0x361),_0x1c46d1[_0x3add75(0x1b8)]['id']);updateSetting(_0x3add75(0x1ba),!![]),tgBot['sendMessage'](_0x1c46d1['chat']['id'],_0x455ff6)['catch'](_0x5cded7=>{telegramError(_0x5cded7);});}),tgBot[_0x21ca0a(0x34c)](/\/enable/,_0x48decd=>{const _0x595bcd=_0x21ca0a;if(!validateTelegram(_0x48decd))return;if(settings[_0x595bcd(0x361)]!=_0x48decd[_0x595bcd(0x1b8)]['id'])updateSetting(_0x595bcd(0x361),_0x48decd[_0x595bcd(0x1b8)]['id']);updateSetting('telegramEnabled',!![]),tgBot['sendMessage'](_0x48decd[_0x595bcd(0x1b8)]['id'],_0x595bcd(0x2aa))['catch'](_0x3205ec=>{telegramError(_0x3205ec);});}),tgBot[_0x21ca0a(0x34c)](/\/config/,async _0x53a34a=>{const _0x3046d6=_0x21ca0a;if(!validateTelegram(_0x53a34a))return;tgBot['removeListener'](_0x3046d6(0x2af)),tgBot[_0x3046d6(0x1f2)](_0x53a34a[_0x3046d6(0x1b8)]['id'],_0x3046d6(0x2bd),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x3046d6(0x281)},{'text':_0x3046d6(0x358),'callback_data':_0x3046d6(0x1c5)},{'text':'All','callback_data':_0x3046d6(0x27d)}]]}})[_0x3046d6(0x1d1)](_0x5ceb0b=>{telegramError(_0x5ceb0b);}),tgBot['on'](_0x3046d6(0x2af),async _0x5c01ff=>{const _0xbbc692=_0x3046d6,_0x4151c5=_0x5c01ff['data'],_0x949698=_0x5c01ff[_0xbbc692(0x2c2)];tgBot[_0xbbc692(0x234)](_0x5c01ff['id'])[_0xbbc692(0x316)](async()=>{const _0x19814f=_0xbbc692;_0x4151c5==_0x19814f(0x281)&&(updateSetting(_0x19814f(0x1ce),_0x19814f(0x281)),updateSetting('telegramEnabled',!![]),await tgBot[_0x19814f(0x1f2)](_0x949698[_0x19814f(0x1b8)]['id'],_0x19814f(0x2f1))[_0x19814f(0x1d1)](_0x7cb271=>{telegramError(_0x7cb271);}));_0x4151c5=='alerts'&&(updateSetting(_0x19814f(0x1ce),_0x19814f(0x1c5)),updateSetting('telegramEnabled',!![]),await tgBot[_0x19814f(0x1f2)](_0x949698['chat']['id'],_0x19814f(0x2b8))['catch'](_0x23a807=>{telegramError(_0x23a807);}));_0x4151c5=='all'&&(updateSetting(_0x19814f(0x1ce),_0x19814f(0x27d)),updateSetting(_0x19814f(0x1ba),!![]),await tgBot[_0x19814f(0x1f2)](_0x949698[_0x19814f(0x1b8)]['id'],_0x19814f(0x20c))[_0x19814f(0x1d1)](_0x53510e=>{telegramError(_0x53510e);}));if(!settings[_0x19814f(0x361)])tgBot[_0x19814f(0x1f2)](_0x949698[_0x19814f(0x1b8)]['id'],_0x19814f(0x31c))['catch'](_0x1fec98=>{telegramError(_0x1fec98);});}),tgBot['removeListener'](_0xbbc692(0x2af));});}),tgBot[_0x21ca0a(0x34c)](/\/status/,_0x5a12d2=>{const _0x27936a=_0x21ca0a;if(!validateTelegram(_0x5a12d2))return;const _0x3b1d3f=getBotsWithMode();let _0x2c7804=_0x27936a(0x314);config[_0x27936a(0x2e6)](_0x2cee7c=>{const _0x40b230=_0x27936a,_0x42bb02=_0x3b1d3f[_0x40b230(0x384)](_0x1d1f29=>_0x1d1f29[_0x40b230(0x301)]==_0x2cee7c['botID'])[_0x40b230(0x34a)];_0x2c7804+='Bot\x20'+_0x2cee7c[_0x40b230(0x301)]+':\x20'+_0x2cee7c[_0x40b230(0x263)]+'\x20|\x20'+_0x42bb02+_0x40b230(0x2cb)+_0x2cee7c[_0x40b230(0x26e)]+'\x0a';}),_0x2c7804+='\x0a',_0x2c7804+=_0x27936a(0x1dc),_0x2c7804+=!settings[_0x27936a(0x1ba)]?_0x27936a(0x31e):_0x27936a(0x2fe),_0x2c7804+=settings[_0x27936a(0x1ba)]?settings[_0x27936a(0x1ce)]==_0x27936a(0x27d)?_0x27936a(0x249):'Notifications\x20types:\x20'+settings[_0x27936a(0x1ce)]+_0x27936a(0x2c6):'',tgBot[_0x27936a(0x1f2)](_0x5a12d2['chat']['id'],_0x2c7804,{'parse_mode':_0x27936a(0x220)})[_0x27936a(0x1d1)](_0x164fd6=>{telegramError(_0x164fd6);});}),tgBot['onText'](/\/restart/,_0x266648=>{const _0x485d32=_0x21ca0a;if(!validateTelegram(_0x266648))return;tgBot['removeListener'](_0x485d32(0x2af));const _0x40acf7=getEnabledBots();if(_0x40acf7[_0x485d32(0x32a)]==0x0)tgBot['sendMessage'](_0x266648['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x485d32(0x1d1)](_0x154874=>{telegramError(_0x154874);});else{if(_0x40acf7[_0x485d32(0x32a)]>0x1)_0x40acf7['push']({'botID':_0x485d32(0x27d)});let _0x606bfd=[],_0x764ed=[];const _0x11ddb7=_0x40acf7[_0x485d32(0x32a)]%0x4==0x0||_0x40acf7['length']%0x4==0x3||_0x40acf7['length']%0x3==0x1?0x4:0x3;let _0x462e51=0x0;_0x40acf7[_0x485d32(0x2e6)]((_0x1e5d66,_0x162a92)=>{const _0x3277d4=_0x485d32;if(_0x162a92%_0x11ddb7==0x0)_0x764ed=[];_0x764ed[_0x3277d4(0x1c7)]({'text':_0x1e5d66['botID']==_0x3277d4(0x27d)?_0x3277d4(0x37e):'Bot\x20'+_0x1e5d66['botID'],'callback_data':_0x1e5d66[_0x3277d4(0x301)]}),_0x162a92%_0x11ddb7==0x0&&(_0x606bfd[_0x462e51]=_0x764ed,_0x462e51++);}),tgBot[_0x485d32(0x1f2)](_0x266648[_0x485d32(0x1b8)]['id'],_0x485d32(0x1f6),{'reply_markup':{'inline_keyboard':_0x606bfd}})[_0x485d32(0x1d1)](_0x1d81f4=>{telegramError(_0x1d81f4);}),tgBot['on'](_0x485d32(0x2af),async _0x349b44=>{const _0x1eef4e=_0x485d32,_0x21d13b=_0x349b44['data'],_0x33a33f=_0x349b44[_0x1eef4e(0x2c2)];tgBot[_0x1eef4e(0x234)](_0x349b44['id'])[_0x1eef4e(0x316)](async()=>{const _0x1457c6=_0x1eef4e;_0x21d13b==_0x1457c6(0x27d)?config['forEach'](_0x396fbb=>{const _0xc94a60=_0x1457c6;restartBot(_0x396fbb[_0xc94a60(0x301)]);}):restartBot(_0x21d13b);}),tgBot['removeListener'](_0x1eef4e(0x2af));});}}),tgBot['onText'](/\/on/,_0x12da2d=>{const _0x498a2a=_0x21ca0a;if(!validateTelegram(_0x12da2d))return;tgBot[_0x498a2a(0x33e)]('callback_query');const _0x3775d8=getDisabledBots();if(_0x3775d8[_0x498a2a(0x32a)]==0x0)tgBot[_0x498a2a(0x1f2)](_0x12da2d[_0x498a2a(0x1b8)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x498a2a(0x1d1)](_0x47455c=>{telegramError(_0x47455c);});else{if(_0x3775d8['length']>0x1)_0x3775d8['push']({'botID':'all'});let _0x189391=[],_0x18ee63=[];const _0x4edbdc=_0x3775d8[_0x498a2a(0x32a)]%0x4==0x0||_0x3775d8[_0x498a2a(0x32a)]%0x4==0x3||_0x3775d8['length']%0x3==0x1?0x4:0x3;let _0x41a7cf=0x0;_0x3775d8['forEach']((_0x504eef,_0x237ab8)=>{const _0x5ed954=_0x498a2a;if(_0x237ab8%_0x4edbdc==0x0)_0x18ee63=[];_0x18ee63[_0x5ed954(0x1c7)]({'text':_0x504eef[_0x5ed954(0x301)]==_0x5ed954(0x27d)?_0x5ed954(0x37e):_0x5ed954(0x1ca)+_0x504eef['botID'],'callback_data':_0x504eef[_0x5ed954(0x301)]}),_0x237ab8%_0x4edbdc==0x0&&(_0x189391[_0x41a7cf]=_0x18ee63,_0x41a7cf++);}),tgBot[_0x498a2a(0x1f2)](_0x12da2d['chat']['id'],_0x498a2a(0x26d),{'reply_markup':{'inline_keyboard':_0x189391}})[_0x498a2a(0x1d1)](_0x278097=>{telegramError(_0x278097);}),tgBot['on'](_0x498a2a(0x2af),async _0x15786c=>{const _0x1508fb=_0x498a2a,_0x331264=_0x15786c[_0x1508fb(0x324)],_0x428cbb=_0x15786c[_0x1508fb(0x2c2)];tgBot[_0x1508fb(0x234)](_0x15786c['id'])[_0x1508fb(0x316)](async()=>{const _0x4ecb8e=_0x1508fb;_0x331264==_0x4ecb8e(0x27d)?(tgBot[_0x4ecb8e(0x1f2)](_0x428cbb[_0x4ecb8e(0x1b8)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x4ecb8e(0x1d1)](_0x5b58=>{telegramError(_0x5b58);}),_0x3775d8[_0x4ecb8e(0x2e6)](_0x3e00ed=>{const _0x3635f4=_0x4ecb8e;if(_0x3e00ed[_0x3635f4(0x301)]!=_0x3635f4(0x27d))toggleBot(_0x3e00ed[_0x3635f4(0x301)],toggleStatus(_0x3e00ed[_0x3635f4(0x301)]),_0x3635f4(0x1bf));})):(tgBot['sendMessage'](_0x428cbb[_0x4ecb8e(0x1b8)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x331264)[_0x4ecb8e(0x1d1)](_0x270f36=>{telegramError(_0x270f36);}),toggleBot(_0x331264,toggleStatus(_0x331264),_0x4ecb8e(0x1bf)));}),tgBot[_0x1508fb(0x33e)](_0x1508fb(0x2af));});}}),tgBot[_0x21ca0a(0x34c)](/\/off/,_0x17e8fc=>{const _0x1a20a7=_0x21ca0a;if(!validateTelegram(_0x17e8fc))return;tgBot['removeListener'](_0x1a20a7(0x2af));const _0x4b2157=getEnabledBots();if(_0x4b2157['length']==0x0)tgBot[_0x1a20a7(0x1f2)](_0x17e8fc[_0x1a20a7(0x1b8)]['id'],_0x1a20a7(0x354))[_0x1a20a7(0x1d1)](_0x467705=>{telegramError(_0x467705);});else{if(_0x4b2157[_0x1a20a7(0x32a)]>0x1)_0x4b2157[_0x1a20a7(0x1c7)]({'botID':_0x1a20a7(0x27d)});let _0x31599c=[],_0x3495e1=[];const _0x2cf2eb=_0x4b2157['length']%0x4==0x0||_0x4b2157[_0x1a20a7(0x32a)]%0x4==0x3||_0x4b2157[_0x1a20a7(0x32a)]%0x3==0x1?0x4:0x3;let _0x5b2a7e=0x0;_0x4b2157[_0x1a20a7(0x2e6)]((_0x32b9c6,_0x487362)=>{const _0x410769=_0x1a20a7;if(_0x487362%_0x2cf2eb==0x0)_0x3495e1=[];_0x3495e1['push']({'text':_0x32b9c6[_0x410769(0x301)]==_0x410769(0x27d)?_0x410769(0x37e):_0x410769(0x1ca)+_0x32b9c6['botID'],'callback_data':_0x32b9c6[_0x410769(0x301)]}),_0x487362%_0x2cf2eb==0x0&&(_0x31599c[_0x5b2a7e]=_0x3495e1,_0x5b2a7e++);}),tgBot[_0x1a20a7(0x1f2)](_0x17e8fc[_0x1a20a7(0x1b8)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x31599c}})[_0x1a20a7(0x1d1)](_0xc34a64=>{telegramError(_0xc34a64);}),tgBot['on'](_0x1a20a7(0x2af),async _0x1d304a=>{const _0x2c47c4=_0x1a20a7,_0x538ef8=_0x1d304a[_0x2c47c4(0x324)],_0x3c53e3=_0x1d304a[_0x2c47c4(0x2c2)];tgBot[_0x2c47c4(0x234)](_0x1d304a['id'])[_0x2c47c4(0x316)](async()=>{const _0xb43e0f=_0x2c47c4;_0x538ef8==_0xb43e0f(0x27d)?(tgBot[_0xb43e0f(0x1f2)](_0x3c53e3[_0xb43e0f(0x1b8)]['id'],_0xb43e0f(0x335))[_0xb43e0f(0x1d1)](_0x3efb6d=>{telegramError(_0x3efb6d);}),_0x4b2157[_0xb43e0f(0x2e6)](_0x439f86=>{const _0x13e54b=_0xb43e0f;if(_0x439f86[_0x13e54b(0x301)]!='all')toggleBot(_0x439f86['botID'],toggleStatus(_0x439f86[_0x13e54b(0x301)]),_0x13e54b(0x1bf));})):(tgBot['sendMessage'](_0x3c53e3[_0xb43e0f(0x1b8)]['id'],_0xb43e0f(0x2b0)+_0x538ef8)[_0xb43e0f(0x1d1)](_0xc21730=>{telegramError(_0xc21730);}),toggleBot(_0x538ef8,toggleStatus(_0x538ef8),_0xb43e0f(0x1bf)));}),tgBot[_0x2c47c4(0x33e)]('callback_query');});}}),tgBot[_0x21ca0a(0x34c)](/\/metrics/,_0x1c51fe=>{const _0x2cc472=_0x21ca0a;if(!validateTelegram(_0x1c51fe))return;tgBot[_0x2cc472(0x33e)](_0x2cc472(0x2af));const _0xaa8d30=getEnabledBots();if(_0xaa8d30['length']==0x0)tgBot[_0x2cc472(0x1f2)](_0x1c51fe[_0x2cc472(0x1b8)]['id'],_0x2cc472(0x354))['catch'](_0x2667d4=>{telegramError(_0x2667d4);});else{if(_0xaa8d30[_0x2cc472(0x32a)]>0x1){let _0x574206=[],_0x3ec3f7=[];const _0x25d5c7=_0xaa8d30[_0x2cc472(0x32a)]%0x4==0x0||_0xaa8d30[_0x2cc472(0x32a)]%0x4==0x3||_0xaa8d30['length']%0x3==0x1?0x4:0x3;let _0x86cbca=0x0;_0xaa8d30[_0x2cc472(0x2e6)]((_0x426054,_0x8c5ba7)=>{const _0x18963c=_0x2cc472;if(_0x8c5ba7%_0x25d5c7==0x0)_0x3ec3f7=[];_0x3ec3f7[_0x18963c(0x1c7)]({'text':_0x18963c(0x1ca)+_0x426054['botID'],'callback_data':_0x426054[_0x18963c(0x301)]}),_0x8c5ba7%_0x25d5c7==0x0&&(_0x574206[_0x86cbca]=_0x3ec3f7,_0x86cbca++);}),tgBot[_0x2cc472(0x1f2)](_0x1c51fe[_0x2cc472(0x1b8)]['id'],_0x2cc472(0x359),{'reply_markup':{'inline_keyboard':_0x574206}})[_0x2cc472(0x1d1)](_0x3a617d=>{telegramError(_0x3a617d);}),tgBot['on'](_0x2cc472(0x2af),async _0x504aaf=>{const _0x4a6dfe=_0x2cc472,_0x2e7922=_0x504aaf[_0x4a6dfe(0x324)],_0x4b8f00=_0x504aaf[_0x4a6dfe(0x2c2)];tgBot[_0x4a6dfe(0x234)](_0x504aaf['id'])[_0x4a6dfe(0x316)](async()=>{const _0x4c0f77=_0x4a6dfe;if(pid[_0x2e7922])pid[_0x2e7922][_0x4c0f77(0x37c)]({'function':'sendMetricsTelegram','args':null});}),tgBot['removeListener'](_0x4a6dfe(0x2af));});}else{const _0x2fd236=_0xaa8d30[0x0]['botID'];if(pid[_0x2fd236])pid[_0x2fd236][_0x2cc472(0x37c)]({'function':_0x2cc472(0x342),'args':null});}}}),tgBot['onText'](/\/portfolio/,_0x40252d=>{const _0x2b6e52=_0x21ca0a;if(!validateTelegram(_0x40252d))return;tgBot[_0x2b6e52(0x33e)]('callback_query');const _0xc0d865=getEnabledBots();if(_0xc0d865['length']==0x0)tgBot[_0x2b6e52(0x1f2)](_0x40252d['chat']['id'],_0x2b6e52(0x354))[_0x2b6e52(0x1d1)](_0x550953=>{telegramError(_0x550953);});else{if(_0xc0d865[_0x2b6e52(0x32a)]>0x1){let _0x376bf2=[],_0xe494d3=[];const _0x157b40=_0xc0d865['length']%0x4==0x0||_0xc0d865[_0x2b6e52(0x32a)]%0x4==0x3||_0xc0d865[_0x2b6e52(0x32a)]%0x3==0x1?0x4:0x3;let _0x48a169=0x0;_0xc0d865['forEach']((_0x28f791,_0x33b430)=>{const _0x272cf0=_0x2b6e52;if(_0x33b430%_0x157b40==0x0)_0xe494d3=[];_0xe494d3['push']({'text':_0x272cf0(0x1ca)+_0x28f791['botID'],'callback_data':_0x28f791[_0x272cf0(0x301)]}),_0x33b430%_0x157b40==0x0&&(_0x376bf2[_0x48a169]=_0xe494d3,_0x48a169++);}),tgBot['sendMessage'](_0x40252d[_0x2b6e52(0x1b8)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x376bf2}})[_0x2b6e52(0x1d1)](_0x2d797b=>{telegramError(_0x2d797b);}),tgBot['on'](_0x2b6e52(0x2af),async _0xcbdb47=>{const _0x5dc1df=_0x2b6e52,_0x1fdc5d=_0xcbdb47[_0x5dc1df(0x324)],_0x46eceb=_0xcbdb47[_0x5dc1df(0x2c2)];tgBot[_0x5dc1df(0x234)](_0xcbdb47['id'])[_0x5dc1df(0x316)](async()=>{const _0x30eff3=_0x5dc1df;if(pid[_0x1fdc5d])pid[_0x1fdc5d][_0x30eff3(0x37c)]({'function':_0x30eff3(0x1c6),'args':null});}),tgBot[_0x5dc1df(0x33e)]('callback_query');});}else{const _0x28f391=_0xc0d865[0x0]['botID'];if(pid[_0x28f391])pid[_0x28f391]['send']({'function':_0x2b6e52(0x1c6),'args':null});}}}),tgBot[_0x21ca0a(0x34c)](/\/update/,async _0x3e877e=>{const _0xb7d5df=_0x21ca0a;if(!validateTelegram(_0x3e877e))return;tgBot['removeListener'](_0xb7d5df(0x2af)),await getMessages();if(!updateAvailable)tgBot[_0xb7d5df(0x1f2)](_0x3e877e['chat']['id'],_0xb7d5df(0x2fb))[_0xb7d5df(0x1d1)](_0x51a937=>{telegramError(_0x51a937);});else!validInstallation?tgBot[_0xb7d5df(0x1f2)](_0x3e877e[_0xb7d5df(0x1b8)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0xb7d5df(0x1d1)](_0x5968e1=>{telegramError(_0x5968e1);}):(tgBot[_0xb7d5df(0x1f2)](_0x3e877e[_0xb7d5df(0x1b8)]['id'],_0xb7d5df(0x353),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0xb7d5df(0x2d1)},{'text':'No','callback_data':'no'}]]}})[_0xb7d5df(0x1d1)](_0x27e22d=>{telegramError(_0x27e22d);}),tgBot['on']('callback_query',async _0x2df163=>{const _0x3dd3a7=_0xb7d5df,_0x1076ec=_0x2df163['data'],_0x5e9c7f=_0x2df163['message'];tgBot[_0x3dd3a7(0x234)](_0x2df163['id'])[_0x3dd3a7(0x316)](async()=>{const _0xafc480=_0x3dd3a7;_0x1076ec=='yes'&&(await tgBot[_0xafc480(0x1f2)](_0x5e9c7f[_0xafc480(0x1b8)]['id'],_0xafc480(0x338))['catch'](_0x51fc50=>{telegramError(_0x51fc50);}),updateBB('update')),_0x1076ec=='no'&&await tgBot['sendMessage'](_0x5e9c7f[_0xafc480(0x1b8)]['id'],_0xafc480(0x2ee))[_0xafc480(0x1d1)](_0x46b047=>{telegramError(_0x46b047);});}),tgBot[_0x3dd3a7(0x33e)](_0x3dd3a7(0x2af));}));}),tgBot[_0x21ca0a(0x34c)](/\/reinstall/,async _0x2ed8db=>{const _0x3f614b=_0x21ca0a;if(!validateTelegram(_0x2ed8db))return;tgBot[_0x3f614b(0x33e)](_0x3f614b(0x2af)),!validInstallation?tgBot['sendMessage'](_0x2ed8db['chat']['id'],_0x3f614b(0x1b6))[_0x3f614b(0x1d1)](_0x44aab2=>{telegramError(_0x44aab2);}):(tgBot[_0x3f614b(0x1f2)](_0x2ed8db[_0x3f614b(0x1b8)]['id'],_0x3f614b(0x2f0),{'reply_markup':{'inline_keyboard':[[{'text':_0x3f614b(0x352),'callback_data':_0x3f614b(0x2d1)},{'text':'No','callback_data':'no'}]]}})[_0x3f614b(0x1d1)](_0x313b33=>{telegramError(_0x313b33);}),tgBot['on']('callback_query',async _0x113c14=>{const _0x50b34d=_0x3f614b,_0x123c36=_0x113c14[_0x50b34d(0x324)],_0x312f78=_0x113c14[_0x50b34d(0x2c2)];tgBot['answerCallbackQuery'](_0x113c14['id'])[_0x50b34d(0x316)](async()=>{const _0x242fcb=_0x50b34d;_0x123c36==_0x242fcb(0x2d1)&&(await tgBot[_0x242fcb(0x1f2)](_0x312f78['chat']['id'],_0x242fcb(0x23d))[_0x242fcb(0x1d1)](_0x2fdbe5=>{telegramError(_0x2fdbe5);}),updateBB(_0x242fcb(0x21b))),_0x123c36=='no'&&await tgBot[_0x242fcb(0x1f2)](_0x312f78['chat']['id'],_0x242fcb(0x33d))[_0x242fcb(0x1d1)](_0x29af31=>{telegramError(_0x29af31);});}),tgBot[_0x50b34d(0x33e)](_0x50b34d(0x2af));}));}),tgBot[_0x21ca0a(0x34c)](/\/toggle/,_0x15d588=>{const _0x402c47=_0x21ca0a;if(!validateTelegram(_0x15d588))return;tgBot['removeListener'](_0x402c47(0x2af));const _0x53a004=getBotsWithMode();if(_0x53a004[_0x402c47(0x32a)]==0x0)tgBot[_0x402c47(0x1f2)](_0x15d588[_0x402c47(0x1b8)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x3c2c97=>{telegramError(_0x3c2c97);});else{let _0xbf7250=[],_0x53512a=[];const _0x5c9950=0x2;let _0x2e89a8=0x0;_0x53a004['forEach']((_0x5e6abf,_0x4419c9)=>{const _0x53130d=_0x402c47;if(_0x4419c9%_0x5c9950==0x0)_0x53512a=[];_0x53512a['push']({'text':_0x53130d(0x1ca)+_0x5e6abf[_0x53130d(0x301)]+'\x20('+_0x5e6abf[_0x53130d(0x34a)]+')','callback_data':_0x5e6abf[_0x53130d(0x301)]}),_0x4419c9%_0x5c9950==0x0&&(_0xbf7250[_0x2e89a8]=_0x53512a,_0x2e89a8++);}),tgBot[_0x402c47(0x1f2)](_0x15d588[_0x402c47(0x1b8)]['id'],_0x402c47(0x252),{'reply_markup':{'inline_keyboard':_0xbf7250}})[_0x402c47(0x1d1)](_0xb3c071=>{telegramError(_0xb3c071);}),tgBot['on']('callback_query',async _0x545b03=>{const _0x338d8f=_0x402c47,_0x408402=_0x545b03['data'],_0x4408ba=_0x545b03[_0x338d8f(0x2c2)];tgBot[_0x338d8f(0x234)](_0x545b03['id'])[_0x338d8f(0x316)](async()=>{const _0x42d193=_0x338d8f,_0x23e0cd=_0x53a004['find'](_0x3ee1b3=>_0x3ee1b3[_0x42d193(0x301)]==_0x408402),_0x296b67=_0x23e0cd[_0x42d193(0x34a)]==_0x42d193(0x1be)?_0x42d193(0x26b):_0x42d193(0x1be);tgBot[_0x42d193(0x1f2)](_0x4408ba[_0x42d193(0x1b8)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x408402+_0x42d193(0x376)+_0x296b67+_0x42d193(0x238))[_0x42d193(0x1d1)](_0x5edd52=>{telegramError(_0x5edd52);}),toggleBotMode(_0x408402);}),tgBot[_0x338d8f(0x33e)]('callback_query');});}}),tgBot[_0x21ca0a(0x34c)](/\/names/,_0x5b3878=>{const _0x48fc3d=_0x21ca0a;if(!validateTelegram(_0x5b3878))return;let _0x38f8eb='';config[_0x48fc3d(0x2e6)](_0x4e1f57=>{const _0x1c9c40=_0x48fc3d;_0x38f8eb+=_0x1c9c40(0x1ca)+_0x4e1f57[_0x1c9c40(0x301)]+':\x20'+_0x4e1f57[_0x1c9c40(0x35a)]+'\x0a';}),tgBot[_0x48fc3d(0x1f2)](_0x5b3878[_0x48fc3d(0x1b8)]['id'],_0x38f8eb,{'parse_mode':_0x48fc3d(0x220)})[_0x48fc3d(0x1d1)](_0x15dbc1=>{telegramError(_0x15dbc1);});}),tgBot[_0x21ca0a(0x34c)](/\/disable/,_0x5b80bc=>{const _0x170724=_0x21ca0a;if(!validateTelegram(_0x5b80bc))return;tgBot[_0x170724(0x1f2)](_0x5b80bc['chat']['id'],_0x170724(0x38b))[_0x170724(0x1d1)](_0x27623b=>{telegramError(_0x27623b);}),updateSetting(_0x170724(0x1ba),![]);}),tgBot['onText'](/\/help/,_0x38ebee=>{const _0x2ab6ea=_0x21ca0a;if(!validateTelegram(_0x38ebee))return;tgBot[_0x2ab6ea(0x1f2)](_0x38ebee[_0x2ab6ea(0x1b8)]['id'],_0xf8368)[_0x2ab6ea(0x1d1)](_0x23557f=>{telegramError(_0x23557f);});}),tgBot['on'](_0x21ca0a(0x282),_0x68adea=>{const _0x2527fd=_0x21ca0a;_0x68adea[_0x2527fd(0x382)]()[_0x2527fd(0x1fc)](_0x2527fd(0x20f))&&(logger['full']('Invalid\x20Telegram\x20token'),tgBot[_0x2527fd(0x2a2)](),tgBot=null,io['to'](_0x2527fd(0x38d))[_0x2527fd(0x2c9)](_0x2527fd(0x2b2),_0x2527fd(0x1c2)));}),process['once']('SIGINT',()=>{const _0x1c1369=_0x21ca0a;if(tgBot)tgBot[_0x1c1369(0x2a2)]();process['exit'](0x1);}),process['once']('SIGTERM',()=>{const _0x2b75d8=_0x21ca0a;if(tgBot)tgBot[_0x2b75d8(0x2a2)]();process[_0x2b75d8(0x289)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x1ac8cb,_0x2b57ea){const _0x2ef405=_0x56e2a6;if(settings[_0x2ef405(0x1ba)]){if(settings[_0x2ef405(0x1ce)]==_0x2ef405(0x27d)||(_0x2b57ea[_0x2ef405(0x38c)]==_0x2ef405(0x1d6)||_0x2b57ea['type']==_0x2ef405(0x1e2)||_0x2b57ea[_0x2ef405(0x38c)]=='success')&&settings[_0x2ef405(0x1ce)]==_0x2ef405(0x1c5)||_0x2b57ea[_0x2ef405(0x38c)]==_0x2ef405(0x35c)&&settings[_0x2ef405(0x1ce)]=='orders'){if(tgBot&&settings[_0x2ef405(0x361)]){if(_0x2b57ea['showname'])tgBot[_0x2ef405(0x1f2)](settings[_0x2ef405(0x361)],_0x2b57ea[_0x2ef405(0x35a)]+_0x2ef405(0x383)+_0x2b57ea['event'])[_0x2ef405(0x1d1)](_0x5ce490=>{telegramError(_0x5ce490);});else tgBot[_0x2ef405(0x1f2)](settings[_0x2ef405(0x361)],_0x2ef405(0x1ca)+_0x1ac8cb+_0x2ef405(0x383)+_0x2b57ea[_0x2ef405(0x264)])[_0x2ef405(0x1d1)](_0x4d3bce=>{telegramError(_0x4d3bce);});}}}}async function sendTelegramMsg(_0x1ddbeb,_0x5d4b0c='HTML'){const _0x22ad4c=_0x56e2a6;return settings[_0x22ad4c(0x1ba)]&&tgBot&&settings[_0x22ad4c(0x361)]?(await tgBot[_0x22ad4c(0x1f2)](settings[_0x22ad4c(0x361)],_0x1ddbeb,{'parse_mode':_0x5d4b0c})[_0x22ad4c(0x1d1)](_0x550020=>{telegramError(_0x550020);}),!![]):![];}function getDeviceWithIp(_0x288c36){const _0x34d0a5=_0x56e2a6;return devices[_0x34d0a5(0x384)](_0x41d3dc=>_0x41d3dc['ip']===_0x288c36);}function temporaryAccess2FA(_0x5228b0,_0x20bc6c){const _0x2c8504=_0x56e2a6;let _0x5e5fbd=new Date(),_0x3de9d3=![];if(lastIpApproval){if(_0x5e5fbd-lastIpApproval<0x1388)_0x3de9d3=!![];}lastIpApproval=new Date();if(_0x3de9d3)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x2c8504(0x33e)](_0x2c8504(0x2af)),tgBot[_0x2c8504(0x1f2)](settings[_0x2c8504(0x361)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x20bc6c)['show']+'</b>\x20?',{'parse_mode':_0x2c8504(0x220),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x2c8504(0x21d),'callback_data':'30'},{'text':_0x2c8504(0x2be),'callback_data':_0x2c8504(0x2be)}]]}})[_0x2c8504(0x1d1)](_0x45a612=>{telegramError(_0x45a612);}),tgBot['on']('callback_query',async _0x112785=>{const _0x4507a1=_0x2c8504,_0x5027e0=_0x112785[_0x4507a1(0x324)],_0x50c4c9=_0x112785[_0x4507a1(0x2c2)];tgBot['answerCallbackQuery'](_0x112785['id'])[_0x4507a1(0x316)](async()=>{const _0x5cc3aa=_0x4507a1;devices[_0x5228b0]['telegramIpApproval']={'clientip':_0x20bc6c,'timestamp':new Date()[_0x5cc3aa(0x30e)](),'expiry':_0x5027e0},_0x5027e0!=_0x5cc3aa(0x2be)?(await tgBot['sendMessage'](_0x50c4c9[_0x5cc3aa(0x1b8)]['id'],_0x5cc3aa(0x2db)+_0x5027e0+'\x20minutes',{'parse_mode':_0x5cc3aa(0x220)})[_0x5cc3aa(0x1d1)](_0x2b2bf3=>{telegramError(_0x2b2bf3);}),io['to'](_0x5228b0)['emit'](_0x5cc3aa(0x263),{'access':{'allow':![],'reason':_0x5cc3aa(0x230),'token':null}})):(await tgBot[_0x5cc3aa(0x1f2)](_0x50c4c9[_0x5cc3aa(0x1b8)]['id'],_0x5cc3aa(0x349))[_0x5cc3aa(0x1d1)](_0x2d3425=>{telegramError(_0x2d3425);}),io['to'](_0x5228b0)[_0x5cc3aa(0x2c9)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x4507a1(0x33e)](_0x4507a1(0x2af));}));}function loginAccess2FA(_0x2152d5,_0xbda544){const _0x23740d=_0x56e2a6;tgBot&&settings[_0x23740d(0x361)]&&(tgBot[_0x23740d(0x33e)](_0x23740d(0x2af)),tgBot[_0x23740d(0x1f2)](settings['telegramChatId'],_0x23740d(0x277)+normalizeIP(_0xbda544)['show']+'</b>\x20?',{'parse_mode':_0x23740d(0x220),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x23740d(0x2be),'callback_data':'reject'}]]}})[_0x23740d(0x1d1)](_0x3d7fd8=>{telegramError(_0x3d7fd8);}),tgBot['on'](_0x23740d(0x2af),async _0x5f5760=>{const _0x440872=_0x23740d,_0x439ed8=_0x5f5760[_0x440872(0x324)],_0x20e95b=_0x5f5760[_0x440872(0x2c2)];tgBot[_0x440872(0x234)](_0x5f5760['id'])[_0x440872(0x316)](async()=>{const _0x3fd2e2=_0x440872;devices[_0x2152d5][_0x3fd2e2(0x2b6)]={'clientip':_0xbda544,'timestamp':new Date()['getTime'](),'expiry':_0x439ed8},_0x439ed8!='reject'?(await tgBot[_0x3fd2e2(0x1f2)](_0x20e95b['chat']['id'],_0x3fd2e2(0x23f),{'parse_mode':_0x3fd2e2(0x220)})['catch'](_0x3a2349=>{telegramError(_0x3a2349);}),io['to'](_0x2152d5)[_0x3fd2e2(0x2c9)](_0x3fd2e2(0x263),{'access':{'allow':![],'reason':_0x3fd2e2(0x230),'token':null}})):(await tgBot[_0x3fd2e2(0x1f2)](_0x20e95b[_0x3fd2e2(0x1b8)]['id'],_0x3fd2e2(0x285))[_0x3fd2e2(0x1d1)](_0x5d8577=>{telegramError(_0x5d8577);}),io['to'](_0x2152d5)[_0x3fd2e2(0x2c9)](_0x3fd2e2(0x263),{'access':{'allow':![],'reason':_0x3fd2e2(0x325),'token':null}}));}),tgBot[_0x440872(0x33e)](_0x440872(0x2af));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x5bdeff=_0x56e2a6;return dbConfig[_0x5bdeff(0x2f5)](_0x5bdeff(0x2b7))[_0x5bdeff(0x231)]('botID')[_0x5bdeff(0x1f8)]({'status':_0x5bdeff(0x28f)})[_0x5bdeff(0x27f)]()||[];}function getDisabledBots(){const _0x313832=_0x56e2a6;return dbConfig['get'](_0x313832(0x2b7))[_0x313832(0x231)](_0x313832(0x301))[_0x313832(0x1f8)]({'status':_0x313832(0x21c)})[_0x313832(0x27f)]()||[];}function getBotAttributes(_0x6ed825){const _0x47282d=_0x56e2a6;let _0x185396={};const _0x3192bd=configpath+_0x47282d(0x1e3)+_0x6ed825+'-config.json',_0x17d47c=fs[_0x47282d(0x27c)](_0x3192bd);if(_0x17d47c){const _0x391781=fs[_0x47282d(0x27e)](_0x3192bd);try{const _0x24e3c3=JSON[_0x47282d(0x34d)](_0x391781),_0xdcf221=_0x24e3c3?_0x24e3c3[_0x47282d(0x2a0)][0x0][_0x47282d(0x219)]:![];_0x185396[_0x47282d(0x34a)]=_0xdcf221?_0x47282d(0x1be):_0x47282d(0x26b),_0x185396[_0x47282d(0x35a)]=_0x24e3c3?_0x24e3c3['bot'][0x0][_0x47282d(0x35a)]:'Bot\x20'+_0x6ed825;}catch(_0x54f7dd){_0x185396[_0x47282d(0x34a)]=_0x47282d(0x26b),_0x185396['botname']=_0x47282d(0x1ca)+_0x6ed825;}}else _0x185396[_0x47282d(0x34a)]=_0x47282d(0x26b),_0x185396['botname']=_0x47282d(0x1ca)+_0x6ed825;return _0x185396;}function getBotsWithMode(){const _0x399c83=_0x56e2a6,_0x4b406c=dbConfig[_0x399c83(0x2f5)](_0x399c83(0x2b7))[_0x399c83(0x231)](_0x399c83(0x301))['value']()||[];return _0x4b406c[_0x399c83(0x2e6)](_0x417512=>{const _0x5efd70=_0x399c83;let _0x3385ba=getBotAttributes(_0x417512['botID']);_0x417512['mode']=_0x3385ba[_0x5efd70(0x34a)];}),_0x4b406c;}function _0x626a(){const _0x2e2ace=['get-backup-files','telegram2FaApproval','bots','Ok,\x20will\x20send\x20alert\x20notifications\x20only','fork','min','hybrid-crypto-js','Node.js\x20v','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','reject','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','temporary\x20access\x20timeout','2FA','message','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','username','exchange','\x20only\x0a','unlinkSync','getStartingBalances','emit',',\x20must\x20be\x20a\x204\x20digit\x20number','\x20|\x20','User\x20has\x20been\x20validated','settings','sha256','exp','build','yes','loginRequired','0.0.0','slice','endsWith','Password\x20reset\x20rejected','connection','versions','startsWith','headers','Access\x20enabled\x20for\x20','\x1b[34m','getMinutes','Backup\x20file\x20uploaded','initclient','\x1b[33m','pidExpireLogin','randomFillSync','files','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','/:bot/history','forEach','write','[ip-address]','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','replace','getMonth','Restoring\x20bot(s)\x20from\x20backup','Unauthorized\x20attempt\x20to\x20show\x20configuration','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','writeFileSync','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Ok,\x20will\x20send\x20order\x20notifications\x20only','bb-secure.json','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','removeAllListeners','get','bb-settings.json',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','Starting\x20#RED#Balance\x20Bot\x20v','add-bot','jsonwebtoken','Your\x20installation\x20is\x20already\x20up\x20to\x20date','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','telegram','Notifications\x20enabled\x0a','temp/','login\x20required','botID','env','sort','inherit','get-messages','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','5517804MAyLGq','delete-bot','family','defaults','secret','sign','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','getTime','sockets','log','telegrammsg','isValid','logs/','<b>Balance\x20Bot\x20Status:</b>\x0a','.zip','then','Unauthorized\x20attempt\x20to\x20confirm\x20message','Enabled\x20Bot\x20','timestamp','(((.+)+)+)+$','date-fns','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','node-telegram-bot-api','Notifications\x20disabled\x0a','ipv6','debug','max','update','Invalid\x20authentication\x20token\x20(2)','data','2FA\x20login\x20rejected','getPortfolio','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','output-001.log','api-eu.mixpanel.com','length','toIPv4MappedAddress','sendFile','-events.json','full','place-order','Restore\x20process\x20aborted','string','update-bb','timeshift','\x1b[35m','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','3000','whitelist','Starting\x20Balance\x20Bot\x20update','Invalid\x20authentication\x20token\x20(1)','express-fileupload','cloneDeep','clientip','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','removeListener','download','mkdirSync','alias','sendMetricsTelegram','number','/enable\x20-\x20enable\x20notifications\x0a','/on\x20-\x20start\x20bot(s)\x0a','_data','child_process','password','Temporary\x20access\x20rejected','mode','Unauthorized\x20attempt\x20to\x20get\x20messages','onText','parse','store-configuration','format','stringify','260fnJOOg','Yes','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','No\x20bots\x20running\x20right\x20now','stop','mixpanel','any','Alerts','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','botname','split','order','14293VeeuhM','logout','build2','file','telegramChatId','https://api.ipify.org?format=json','Unauthorized\x20attempt\x20to\x20update\x20bot','socket.io','generate','-results.json','encryptedUuid','get-portfolio','node-zip','7tNpyjs','bbvNew','/output-000.log','tkn','output-000.log','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','copyFileSync','access\x20timeout','remoteAddress','lowdb','lastmsgtelegram','Unauthorized\x20attempt\x20to\x20download\x20','\x20to\x20','lastmsgemitted','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','#RES#\x20if\x20running\x20on\x20server','login\x20token\x20generated','version','send','reset-history','All\x20bots','simple','Unauthorized\x20attempt\x20to\x20log\x20out','logged\x20out','toString','\x20>\x20','find','range','get-logs','Disabled\x20Bot\x20','bbvReceive','index.html','decrypt','Notifications\x20disabled','type','botmanager','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','rmSync','set','/restart\x20-\x20restart\x20bot(s)\x0a','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','1000','chat','temporary\x20token\x20generated','telegramEnabled','store','127.0.0.1','apply','auto','stopped','\x20(2)','\x1b[31m','Invalid\x20Telegram\x20token','handshake','storeFiat','alerts','sendPortfolioTelegram','push','2FA\x20login\x20required','yargs/yargs','Bot\x20','generateKeyPairAsync','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Unauthorized\x20login\x20attempt\x20(timeout)','telegramEvents','reason','binary','catch','Deleted\x20Bot\x20','zip/','/off\x20-\x20stop\x20bot(s)\x0a','referer','error','placeOrder','Unauthorized\x20attempt\x20to\x20get\x20events','static','No\x20authentication\x20token','axios','<b>Telegram\x20Bot\x20Status:</b>\x0a','kill','Markdown','confirm-message','backup-full','getUTCHours','warning','bot-','32214dGHnMo','function','toggle-bot-mode','invalid\x20credentials','/:bot/performance','File\x20uploaded','bot.js','hasOwnProperty','-config.json','Logged\x20out\x20user\x20...','version.json','backup','\x20|\x20user:\x20...','new','sendMessage','bb-config.json','listen','compareSync','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','disconnect','filter','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','deleteHistoryAlerts','onepagemode','includes','get-starting-balances','Bot\x20Mgr\x20>\x20','blacklist','getSeconds','test','2FA\x20required','************','address','store-fiat','Setting\x20access:\x20','Error:\x20Invalid\x20argument\x20','join','remove','Backup\x20file\x20unzipped\x20and\x20stored','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','/disable\x20-\x20disable\x20notifications\x0a','request','404\x20Not\x20Found','crypto','Idling\x20bot\x20\x20\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','success','ipc','telegramIpApproval','/upload-backup','path','\x1b[0m','headless','allow','reinstall','disabled','30\x20min','whitelistEnabled','Network\x20Interfaces:','HTML','uncaughtException','\x1b[36m','#RES#\x0a','output-003.log','update-bot','port','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','hex','size','name','toIPv4Address','lowdb/adapters/FileSync','Logged\x20in\x20user\x20...','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Invalid\x20username\x20or\x20IP\x20address','reload','sortBy','2FA\x20login\x20token\x20generated','host','answerCallbackQuery','uuid','server','isDirectory','\x20mode','params','464804eotGzz','6cnYIaI','access','Starting\x20Balance\x20Bot\x20reinstallation','use','Login\x20accepted','-----------------------------------------------------------------------------------','latestversion','44627tDSkgA','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','messages','http','Server','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','userid','internal','title','token','argv','add','store-headless','map','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','express','DEFLATE','settings.','auth','createWriteStream','cancelLoading','padStart','reset-password','backup-files','bbUsername','/:bot/portfolio','Starting\x20bot\x20|\x20Bot\x20','bcryptjs','-performance.json','logs','expiry','status','event','backup-full@','telegramUsername','store-settings','1324620nuHEVz','login','Restarting\x20Bot\x20','manual',':\x20Bot\x20Mgr\x20>\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','live','constructor','bbPassword','post','delete-alerts','storeConfiguration','Invalid\x20IP\x20address','keys','65kbJaVl','Allow\x20login\x20from\x20IP\x20address\x20<b>','login\x20not\x20required','from','Unauthorized\x20attempt\x20to\x20get\x20portfolio','/names\x20-\x20show\x20bot\x20names\x0a','existsSync','all','readFileSync','value','new-disabled','orders','polling_error','=>\x20Go\x20to\x20#CYA#http://','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Login\x20rejected','output-002.log','apiPassword','***','exit','6b67f3d61ee94b8f5c80b4affef4c4d9','pidRefreshToken','user','/metrics\x20-\x20show\x20bot\x20performance\x0a','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','enabled','Unauthorized\x20attempt\x20to\x20store\x20configuration','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','getDate','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','match','privateKey','getHours','clients','22cwjvSO','socket','readdirSync','reinstall-bb','/help\x20-\x20show\x20available\x20commands\x0a','publicKey','/:bot','/:bot/support','bot','Restore\x20backup\x20file\x20','stopPolling','backupfile','exec','getFullYear','apiKey','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','hashSync','881912DsjRix','Notifications\x20enabled','::ffff:127.0.0.1','telegramToken','assign','Error\x20while\x20deleting\x20config\x20files:\x20','callback_query','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','search','notification','started','config/'];_0x626a=function(){return _0x2e2ace;};return _0x626a();}function getBotExchanges(){const _0x32a3fb=_0x56e2a6;let _0x1b0bb2=[];const _0x49a18f=dbConfig['get'](_0x32a3fb(0x2b7))['sortBy']('botID')[_0x32a3fb(0x27f)]()||[];_0x49a18f[_0x32a3fb(0x2e6)](_0x8c3ee3=>{const _0xfae779=_0x32a3fb;if(_0x8c3ee3[_0xfae779(0x263)]=='enabled'){const _0x3a6138=configpath+'bot-'+_0x8c3ee3['botID']+_0xfae779(0x1ec),_0x29c295=fs[_0xfae779(0x27c)](_0x3a6138);let _0x2a5a26;if(_0x29c295){const _0x5424ab=fs[_0xfae779(0x27e)](_0x3a6138);try{const _0x49b74e=JSON['parse'](_0x5424ab);_0x2a5a26=_0x49b74e?_0x49b74e[_0xfae779(0x2a0)][0x0][_0xfae779(0x2c5)]:null;}catch(_0x540377){}}if(_0x2a5a26)_0x1b0bb2['push'](_0x2a5a26);}});const _0x321853=[...new Set(_0x1b0bb2)][_0x32a3fb(0x303)]();return _0x321853;}async function initUser(){const _0x3fe8a2=_0x56e2a6;if(!settings[_0x3fe8a2(0x24a)]){const _0x13a867=uuidRandom();mixpanel[_0x3fe8a2(0x341)](_0x13a867),updateSetting(_0x3fe8a2(0x24a),_0x13a867);}}async function initSecure(){const _0x15cb31=_0x56e2a6;let _0x39f7bf=getSecure();if(!_0x39f7bf[_0x15cb31(0x1eb)]('secret')){let _0x1bf5f5=await generateKeys();_0x39f7bf['publicKey']=_0x1bf5f5['publicKey'],_0x39f7bf['privateKey']=_0x1bf5f5['privateKey'],_0x39f7bf[_0x15cb31(0x30b)]=crypto['randomBytes'](0x20)[_0x15cb31(0x382)](_0x15cb31(0x228));;storeSecure(_0x39f7bf);}}function getSettings(){const _0x20eac3=_0x56e2a6;return dbSettings[_0x20eac3(0x2f5)](_0x20eac3(0x2cd))[_0x20eac3(0x27f)]()||{};}function getSecure(){const _0x12e81d=_0x56e2a6;return dbSecure[_0x12e81d(0x2f5)]('secure')[_0x12e81d(0x27f)]()||{};}function getBlacklist(){const _0x22f91a=_0x56e2a6;return dbSecure[_0x22f91a(0x2f5)](_0x22f91a(0x1ff))['value']()||[];}function broadcastToBots(_0x4787e9,_0x47a8b0){config['forEach'](_0x29dc17=>{const _0x4153b1=_0x259d;if(_0x29dc17[_0x4153b1(0x263)]==_0x4153b1(0x28f)&&_0x29dc17[_0x4153b1(0x26e)]=='running'||_0x29dc17[_0x4153b1(0x263)]=='new'&&_0x29dc17[_0x4153b1(0x26e)]=='running'){if(pid[_0x29dc17[_0x4153b1(0x301)]])pid[_0x29dc17['botID']][_0x4153b1(0x37c)]({[_0x4787e9]:_0x47a8b0});}});}function storeSettings(_0x2f5b7c,_0x38bd91=![]){const _0x3c6a8e=_0x56e2a6;_0x2f5b7c={...settings,..._0x2f5b7c};if(_0x38bd91&&_0x2f5b7c[_0x3c6a8e(0x270)]!=_0x3c6a8e(0x203)&&_0x2f5b7c[_0x3c6a8e(0x270)]!=_0x3c6a8e(0x288)&&_0x2f5b7c[_0x3c6a8e(0x270)]!=''){const _0x9521a2=crypt[_0x3c6a8e(0x38a)](secure[_0x3c6a8e(0x295)],_0x2f5b7c['bbPassword'])[_0x3c6a8e(0x2c2)]['split']('@')[0x0],_0x258caf=bcrypt[_0x3c6a8e(0x2a8)](_0x9521a2,saltRounds);_0x2f5b7c={..._0x2f5b7c,'bbPassword':_0x258caf};}if(_0x38bd91&&_0x2f5b7c[_0x3c6a8e(0x2ac)]!='************'&&_0x2f5b7c[_0x3c6a8e(0x2ac)]!=_0x3c6a8e(0x288)&&_0x2f5b7c['telegramToken']!=''){const _0xe47ea1=crypt['decrypt'](secure[_0x3c6a8e(0x295)],_0x2f5b7c['telegramToken'])[_0x3c6a8e(0x2c2)][_0x3c6a8e(0x35b)]('@')[0x0];_0x2f5b7c={..._0x2f5b7c,'telegramToken':_0xe47ea1};}const _0x53552d=_0x2f5b7c[_0x3c6a8e(0x2ac)]!=_0x3c6a8e(0x203)&&_0x2f5b7c['telegramToken']!=settings['telegramToken']||_0x2f5b7c[_0x3c6a8e(0x266)]!=settings[_0x3c6a8e(0x266)],_0x2455c3=_0x2f5b7c[_0x3c6a8e(0x2ac)]==''||_0x2f5b7c['telegramUsername']=='';if(_0x53552d)_0x2f5b7c[_0x3c6a8e(0x1ce)]=_0x3c6a8e(0x27d);for(const [_0x2df1a0,_0x49160c]of Object['entries'](_0x2f5b7c)){if(_0x2df1a0==_0x3c6a8e(0x2ac)&&_0x49160c==_0x3c6a8e(0x203)){_0x2f5b7c[_0x3c6a8e(0x2ac)]=settings[_0x3c6a8e(0x2ac)];continue;};if(_0x2df1a0==_0x3c6a8e(0x270)&&_0x49160c==_0x3c6a8e(0x203)){_0x2f5b7c[_0x3c6a8e(0x270)]=settings['bbPassword'];continue;};dbSettings[_0x3c6a8e(0x390)](_0x3c6a8e(0x255)+_0x2df1a0,_0x49160c)['write']();}settings=_0x2f5b7c,io['to'](_0x3c6a8e(0x38d))['emit']('settings',cleanSettings()),broadcastToBots(_0x3c6a8e(0x333),settings[_0x3c6a8e(0x333)]),broadcastToBots(_0x3c6a8e(0x1fb),settings[_0x3c6a8e(0x1fb)]);if(_0x53552d&&!_0x2455c3)initTelegram();if(_0x53552d&&_0x2455c3)disableTelegram();getAllClients()[_0x3c6a8e(0x2e6)](_0xaf806=>{const _0x305fd8=_0x3c6a8e;getSocket(_0xaf806['id'])[_0x305fd8(0x2c9)](_0x305fd8(0x263),{'access':{'allow':![],'reason':_0x305fd8(0x230),'token':null}});});}function updateSetting(_0x132775,_0x53bd07){const _0xf2a256=_0x56e2a6;dbSettings['set'](_0xf2a256(0x255)+_0x132775,_0x53bd07)[_0xf2a256(0x2e7)](),settings=getSettings(),io['to'](_0xf2a256(0x38d))[_0xf2a256(0x2c9)]('settings',cleanSettings());}function storeSecure(_0x2fa1cc){const _0x8b9348=_0x56e2a6;dbSecure[_0x8b9348(0x2f5)]('secure')[_0x8b9348(0x1c7)](_0x2fa1cc)[_0x8b9348(0x2e7)](),secure=_0x2fa1cc;}function addBlacklist(_0x3b7d97){const _0x41765f=_0x56e2a6;cleanBlacklist();let _0x1bbdc5;devices[_0x3b7d97][_0x41765f(0x215)]?_0x1bbdc5=Math[_0x41765f(0x321)](devices[_0x3b7d97][_0x41765f(0x215)][_0x41765f(0x262)],loginExpiry):_0x1bbdc5=loginExpiry,dbSecure['get'](_0x41765f(0x1ff))[_0x41765f(0x1c7)]({'expiry':new Date()[_0x41765f(0x30e)]()+_0x1bbdc5*0x3c*0x3e8,'token':devices[_0x3b7d97][_0x41765f(0x23c)][_0x41765f(0x24d)]})[_0x41765f(0x2e7)](),blacklist=dbSecure[_0x41765f(0x2f5)](_0x41765f(0x1ff))[_0x41765f(0x27f)]();}function cleanBlacklist(){const _0xb9b94c=_0x56e2a6;let _0x16e314=dbSecure['get'](_0xb9b94c(0x1ff))[_0xb9b94c(0x33b)]()[_0xb9b94c(0x27f)](),_0x35d2b0=new Date()[_0xb9b94c(0x30e)]();_0x16e314[_0xb9b94c(0x2e6)](_0x589bad=>{const _0x2e62e6=_0xb9b94c;_0x589bad['expiry']<_0x35d2b0&&dbSecure[_0x2e62e6(0x2f5)]('blacklist')['remove']({'expiry':_0x589bad['expiry']})[_0x2e62e6(0x2e7)]();});}function initStates(){const _0x458a2d=_0x56e2a6;let _0x5dc371=getConfiguration();_0x5dc371[_0x458a2d(0x2e6)](_0x3e1021=>{_0x3e1021['live']='stopped';}),storeConfiguration(_0x5dc371);}function onKeys(){const _0x4fb150=new RSA();return new Promise(_0x298632=>{const _0xb538d0=_0x259d;_0x4fb150[_0xb538d0(0x1cb)]()[_0xb538d0(0x316)](_0x3c3721=>{_0x298632(_0x3c3721);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x3bb938=_0x56e2a6;let _0x5ddae8=getSettings(),_0x3ee1ac=![];!_0x5ddae8[_0x3bb938(0x1eb)](_0x3bb938(0x374))&&(_0x5ddae8['lastmsgtelegram']=0x0,_0x3ee1ac=!![]);!_0x5ddae8[_0x3bb938(0x1eb)](_0x3bb938(0x377))&&(_0x5ddae8[_0x3bb938(0x377)]=0x0,_0x3ee1ac=!![]);!_0x5ddae8[_0x3bb938(0x1eb)]('latestversion')&&(_0x5ddae8[_0x3bb938(0x241)]=_0x3bb938(0x2d3),_0x3ee1ac=!![]);!_0x5ddae8['hasOwnProperty'](_0x3bb938(0x1fb))&&(_0x5ddae8[_0x3bb938(0x1fb)]=![],_0x3ee1ac=!![]);if(_0x3ee1ac)storeSettings(_0x5ddae8);try{fs[_0x3bb938(0x29a)](configbackuppath,{'withFileTypes':!![]})[_0x3bb938(0x2e6)](_0x1a4624=>{const _0x14ac38=_0x3bb938;if(!_0x1a4624[_0x14ac38(0x237)]()){if(!_0x1a4624[_0x14ac38(0x22a)][_0x14ac38(0x2d9)](_0x14ac38(0x265)))fs[_0x14ac38(0x2c7)](configbackuppath+_0x1a4624[_0x14ac38(0x22a)]);}else fs[_0x14ac38(0x38f)](configbackuppath+_0x1a4624[_0x14ac38(0x22a)],{'recursive':!![]});});}catch(_0xb7d38){logger[_0x3bb938(0x320)]('Error\x20removing\x20old\x20backup\x20files:',_0xb7d38);}}function storeConfiguration(_0x4978bb){const _0x105f4d=_0x56e2a6;dbConfig[_0x105f4d(0x2f5)](_0x105f4d(0x2b7))['remove']()[_0x105f4d(0x2e7)](),_0x4978bb['forEach'](_0x3e2f0f=>{const _0x2eea3a=_0x105f4d;delete _0x3e2f0f[_0x2eea3a(0x34a)];}),dbConfig['get'](_0x105f4d(0x2b7))[_0x105f4d(0x1c7)](..._0x4978bb)['write'](),config=_0x4978bb;}function resetPassword(){const _0x5860f7=_0x56e2a6;tgBot&&settings[_0x5860f7(0x361)]&&(tgBot[_0x5860f7(0x33e)](_0x5860f7(0x2af)),tgBot[_0x5860f7(0x1f2)](settings[_0x5860f7(0x361)],_0x5860f7(0x243),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x5860f7(0x2d1)},{'text':'no','callback_data':'no'}]]}})[_0x5860f7(0x1d1)](_0x5b68f7=>{telegramError(_0x5b68f7);}),tgBot['on']('callback_query',async _0x277d68=>{const _0x3f30f7=_0x5860f7,_0x146ac5=_0x277d68[_0x3f30f7(0x324)],_0x2ef646=_0x277d68['message'];tgBot[_0x3f30f7(0x234)](_0x277d68['id'])[_0x3f30f7(0x316)](async()=>{const _0x3dac43=_0x3f30f7;if(_0x146ac5!='no'){const _0x12e56a=0xf,_0x1a3caf=_0x3dac43(0x38e),_0x1b31e5=Array[_0x3dac43(0x279)](crypto[_0x3dac43(0x2e2)](new Uint32Array(_0x12e56a)))[_0x3dac43(0x251)](_0xc9ff92=>_0x1a3caf[_0xc9ff92%_0x1a3caf[_0x3dac43(0x32a)]])[_0x3dac43(0x208)](''),_0x4ddef1=bcrypt['hashSync'](_0x1b31e5,saltRounds);storeSettings({'bbPassword':_0x4ddef1}),await tgBot['sendMessage'](_0x2ef646[_0x3dac43(0x1b8)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x1b31e5,{'parse_mode':_0x3dac43(0x220)})[_0x3dac43(0x1d1)](_0xd8eb59=>{telegramError(_0xd8eb59);});}else await tgBot[_0x3dac43(0x1f2)](_0x2ef646[_0x3dac43(0x1b8)]['id'],_0x3dac43(0x2d6))[_0x3dac43(0x1d1)](_0x242815=>{telegramError(_0x242815);});}),tgBot[_0x3f30f7(0x33e)](_0x3f30f7(0x2af));}));}async function confirmRestore(_0x236bce,_0x36f5a2){const _0x246546=_0x56e2a6;io['to'](_0x246546(0x38d))['emit'](_0x246546(0x2b2),_0x246546(0x378),'success'),tgBot&&settings[_0x246546(0x361)]&&(tgBot[_0x246546(0x33e)](_0x246546(0x2af)),await tgBot['sendMessage'](settings[_0x246546(0x361)],_0x246546(0x327),{'parse_mode':_0x246546(0x220),'reply_markup':{'inline_keyboard':[[{'text':_0x246546(0x2d1),'callback_data':_0x246546(0x2d1)},{'text':'no','callback_data':'no'}]]}})[_0x246546(0x1d1)](_0x7f21bd=>{telegramError(_0x7f21bd);}),tgBot['on'](_0x246546(0x2af),async _0x2d8b29=>{const _0x5b5063=_0x246546,_0x573e30=_0x2d8b29[_0x5b5063(0x324)],_0x14051c=_0x2d8b29[_0x5b5063(0x2c2)];tgBot[_0x5b5063(0x234)](_0x2d8b29['id'])['then'](async()=>{const _0x2d8cf4=_0x5b5063;_0x573e30=='yes'?(await tgBot[_0x2d8cf4(0x1f2)](_0x14051c['chat']['id'],_0x2d8cf4(0x2ec),{'parse_mode':'HTML'})[_0x2d8cf4(0x1d1)](_0x4846b1=>{telegramError(_0x4846b1);}),unzipFile(_0x236bce,_0x36f5a2)):(logger[_0x2d8cf4(0x320)](_0x2d8cf4(0x330)),await tgBot['sendMessage'](_0x14051c['chat']['id'],_0x2d8cf4(0x330))['catch'](_0x592126=>{telegramError(_0x592126);}));}),tgBot[_0x5b5063(0x33e)](_0x5b5063(0x2af));}));}function getServerTime(){const _0x5cfd77=_0x56e2a6,_0x509cb9=new Date();return _0x509cb9['getFullYear']()+'/'+(_0x509cb9[_0x5cfd77(0x2eb)]()+0x1)[_0x5cfd77(0x382)]()[_0x5cfd77(0x259)](0x2,'0')+'/'+_0x509cb9['getDate']()[_0x5cfd77(0x382)]()[_0x5cfd77(0x259)](0x2,'0')+'\x20'+_0x509cb9[_0x5cfd77(0x296)]()[_0x5cfd77(0x382)]()[_0x5cfd77(0x259)](0x2,'0')+':'+_0x509cb9['getMinutes']()['toString']()[_0x5cfd77(0x259)](0x2,'0')+':'+_0x509cb9['getSeconds']()[_0x5cfd77(0x382)]()[_0x5cfd77(0x259)](0x2,'0');}function getTimeStamp(){const _0x44630d=_0x56e2a6,_0x3c227d=shiftedTime();return _0x3c227d[_0x44630d(0x2a5)]()+'/'+(_0x3c227d[_0x44630d(0x2eb)]()+0x1)[_0x44630d(0x382)]()['padStart'](0x2,'0')+'/'+_0x3c227d[_0x44630d(0x292)]()['toString']()[_0x44630d(0x259)](0x2,'0')+'\x20'+_0x3c227d['getHours']()['toString']()[_0x44630d(0x259)](0x2,'0')+':'+_0x3c227d[_0x44630d(0x2dd)]()[_0x44630d(0x382)]()['padStart'](0x2,'0')+':'+_0x3c227d[_0x44630d(0x200)]()['toString']()[_0x44630d(0x259)](0x2,'0');}function getCleanTimeStamp(){const _0x69fb50=_0x56e2a6,_0x1546e0=shiftedTime();return _0x1546e0[_0x69fb50(0x2a5)]()+(_0x1546e0[_0x69fb50(0x2eb)]()+0x1)[_0x69fb50(0x382)]()['padStart'](0x2,'0')+_0x1546e0[_0x69fb50(0x292)]()[_0x69fb50(0x382)]()['padStart'](0x2,'0')+'-'+_0x1546e0['getHours']()[_0x69fb50(0x382)]()[_0x69fb50(0x259)](0x2,'0')+_0x1546e0[_0x69fb50(0x2dd)]()['toString']()['padStart'](0x2,'0')+_0x1546e0['getSeconds']()[_0x69fb50(0x382)]()[_0x69fb50(0x259)](0x2,'0');}function shiftedTime(){const _0x56aa1b=_0x56e2a6,_0x405beb=new Date();let _0x556cc6=_0x405beb;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x556cc6=fns[_0x56aa1b(0x24f)](_0x405beb,{'hours':settings[_0x56aa1b(0x333)]});return _0x556cc6;}function startScheduler(){const _0x109ce3=_0x56e2a6,_0x52e069=new Date()[_0x109ce3(0x1e1)](),_0xba5f8a=shiftedTime()['getHours']();_0xba5f8a==0x4&&backupConfigFiles();_0xba5f8a==0x0&&rotateLogFiles();_0x52e069%0x6==0x0&&triggerAnalytics();_0x52e069%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0xce6299){const _0x3b121b=_0x56e2a6;logger['debug'](_0x3b121b(0x2a1)+_0xce6299);const _0x2a1d28=getBotsWithMode();_0x2a1d28[_0x3b121b(0x32a)]>0x0?confirmRestore(configbackuppath,_0xce6299):unzipFile(configbackuppath,_0xce6299);}async function getBackupFiles(_0x3f4415=null){const _0x3d5e2a=_0x56e2a6;let _0x295207=[],_0x1e4b68=fs[_0x3d5e2a(0x29a)](configbackuppath,{'withFileTypes':!![]});_0x1e4b68[_0x3d5e2a(0x303)]((_0x358b98,_0x1932a5)=>_0x358b98[_0x3d5e2a(0x22a)]<_0x1932a5[_0x3d5e2a(0x22a)]?0x1:_0x1932a5['name']<_0x358b98['name']?-0x1:0x0),_0x1e4b68[_0x3d5e2a(0x2e6)](_0x14f854=>{const _0x58c21d=_0x3d5e2a;if(!_0x14f854[_0x58c21d(0x237)]()&&_0x14f854[_0x58c21d(0x22a)][_0x58c21d(0x2d9)](_0x58c21d(0x265))&&_0x14f854[_0x58c21d(0x22a)][_0x58c21d(0x2d5)](_0x58c21d(0x315))){const _0x4bbcff=formatDate(fs['statSync'](configbackuppath+_0x14f854['name'])['mtime']);_0x295207['push']({'name':_0x14f854['name'],'mtime':_0x4bbcff});}});if(_0x3f4415)io['to'](_0x3f4415)['emit'](_0x3d5e2a(0x25b),_0x295207);else return _0x295207;}async function backupConfigFiles(){const _0x5cf3f2=_0x56e2a6;await zipFiles(_0x5cf3f2(0x1e0));const _0x56fdc4=getCleanTimeStamp();fs[_0x5cf3f2(0x370)](zippath+'backup-full.zip',configbackuppath+(_0x5cf3f2(0x265)+_0x56fdc4+'.zip'));let _0x5b2283=fs[_0x5cf3f2(0x29a)](configbackuppath,{'withFileTypes':!![]});_0x5b2283[_0x5cf3f2(0x303)]((_0x9ef180,_0x6f2c2e)=>_0x9ef180[_0x5cf3f2(0x22a)]<_0x6f2c2e[_0x5cf3f2(0x22a)]?0x1:_0x6f2c2e['name']<_0x9ef180[_0x5cf3f2(0x22a)]?-0x1:0x0),_0x5b2283[_0x5cf3f2(0x32a)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x5b2283[_0x5b2283[_0x5cf3f2(0x32a)]-0x1][_0x5cf3f2(0x22a)]);}function rotateLogFiles(){const _0x2dafd8=_0x56e2a6,_0x230886=fs['statSync'](logspath+_0x2dafd8(0x36e)),_0x3a6e38=_0x230886[_0x2dafd8(0x229)]/0x400;if(_0x3a6e38>0x64){let _0xd837b8=fs[_0x2dafd8(0x29a)](logspath,{'withFileTypes':!![]});_0xd837b8[_0x2dafd8(0x303)]((_0x581823,_0x401b07)=>_0x581823['name']<_0x401b07[_0x2dafd8(0x22a)]?0x1:_0x401b07['name']<_0x581823['name']?-0x1:0x0),_0xd837b8[_0x2dafd8(0x2e6)](_0xdc68be=>{const _0x18ccbe=_0x2dafd8;if(_0xdc68be[_0x18ccbe(0x22a)]==_0x18ccbe(0x286))fs[_0x18ccbe(0x370)](logspath+_0xdc68be[_0x18ccbe(0x22a)],logspath+_0x18ccbe(0x224));if(_0xdc68be['name']==_0x18ccbe(0x328))fs[_0x18ccbe(0x370)](logspath+_0xdc68be[_0x18ccbe(0x22a)],logspath+'output-002.log');_0xdc68be['name']==_0x18ccbe(0x36e)&&(fs[_0x18ccbe(0x370)](logspath+_0xdc68be[_0x18ccbe(0x22a)],logspath+'output-001.log'),fs[_0x18ccbe(0x2ef)](logspath+_0xdc68be[_0x18ccbe(0x22a)],''));});}}async function zipFiles(_0x2d396a){const _0x253c63=_0x56e2a6;let _0x1b9935;if(_0x2d396a==_0x253c63(0x261))_0x1b9935=logspath;if(_0x2d396a==_0x253c63(0x1ef))_0x1b9935=configpath;if(_0x2d396a==_0x253c63(0x1e0))_0x1b9935=configpath;let _0x6cab66=fs[_0x253c63(0x29a)](_0x1b9935,{'withFileTypes':!![]});const _0x4e00e6=new require(_0x253c63(0x369))();_0x6cab66['forEach'](_0x5d9bc3=>{const _0x24aa2d=_0x253c63;if(!_0x5d9bc3['isDirectory']()){let _0x2be7b6=fs[_0x24aa2d(0x27e)](_0x1b9935+_0x5d9bc3[_0x24aa2d(0x22a)]);if(_0x2d396a==_0x24aa2d(0x1ef)){const _0x1cd49b=/^bot-[0-9]{3}-config.json$/,_0x1226fa=_0x1cd49b[_0x24aa2d(0x201)](_0x5d9bc3[_0x24aa2d(0x22a)]);if(_0x1226fa){const _0x47f42a=JSON[_0x24aa2d(0x34d)](_0x2be7b6);if(_0x47f42a[_0x24aa2d(0x2a0)][0x0]){_0x47f42a[_0x24aa2d(0x2a0)][0x0][_0x24aa2d(0x2a6)]=_0x24aa2d(0x288),_0x47f42a['bot'][0x0]['apiSecret']='***';if(_0x47f42a[_0x24aa2d(0x2a0)][0x0][_0x24aa2d(0x287)])_0x47f42a[_0x24aa2d(0x2a0)][0x0][_0x24aa2d(0x287)]='***';}_0x2be7b6=JSON[_0x24aa2d(0x350)](_0x47f42a,null,0x2);}if(_0x5d9bc3['name']==_0x24aa2d(0x2f6)){const _0x5ad71b=JSON['parse'](_0x2be7b6);if(_0x5ad71b[_0x24aa2d(0x2cd)]['loginRequired'])_0x5ad71b['settings'][_0x24aa2d(0x2d2)]=![];if(_0x5ad71b['settings'][_0x24aa2d(0x270)])_0x5ad71b[_0x24aa2d(0x2cd)]['bbPassword']=_0x24aa2d(0x288);if(_0x5ad71b[_0x24aa2d(0x2cd)][_0x24aa2d(0x2ac)])_0x5ad71b['settings']['telegramToken']=_0x24aa2d(0x288);if(_0x5ad71b[_0x24aa2d(0x2cd)][_0x24aa2d(0x361)])_0x5ad71b[_0x24aa2d(0x2cd)]['telegramChatId']=null;_0x2be7b6=JSON[_0x24aa2d(0x350)](_0x5ad71b,null,0x2);}if(_0x5d9bc3['name']!='bb-secure.json')_0x4e00e6[_0x24aa2d(0x360)](_0x5d9bc3[_0x24aa2d(0x22a)],_0x2be7b6);}else _0x4e00e6[_0x24aa2d(0x360)](_0x5d9bc3['name'],_0x2be7b6);}});const _0x574d03=_0x4e00e6[_0x253c63(0x365)]({'base64':![],'compression':_0x253c63(0x254)});fs[_0x253c63(0x2ef)](zippath+(_0x2d396a+_0x253c63(0x315)),_0x574d03,_0x253c63(0x1d0));}async function unzipFile(_0x592c72,_0x18d8cf){const _0xc267cb=_0x56e2a6;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0xc267cb(0x2e6)](_0x295485=>{const _0x4fe7c6=_0xc267cb;if(!_0x295485[_0x4fe7c6(0x237)]())fs[_0x4fe7c6(0x38f)](configpath+_0x295485[_0x4fe7c6(0x22a)]);});const _0x4f1a93=fs[_0xc267cb(0x27e)](_0x592c72+_0x18d8cf,_0xc267cb(0x1d0)),_0x19b9c7=new require(_0xc267cb(0x369))(_0x4f1a93,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x19b9c7[_0xc267cb(0x2e3)])[_0xc267cb(0x2e6)](_0x33755c=>{const _0x342905=_0xc267cb,_0x24f584=_0x19b9c7[_0x342905(0x2e3)][_0x33755c];fs[_0x342905(0x2ef)](configpath+_0x24f584['name'],_0x24f584[_0x342905(0x346)]);}),fs[_0xc267cb(0x29a)](temppath,{'withFileTypes':!![]})['forEach'](_0x2cb2a3=>{const _0x3b20d9=_0xc267cb;if(!_0x2cb2a3[_0x3b20d9(0x237)]())fs[_0x3b20d9(0x38f)](temppath+_0x2cb2a3[_0x3b20d9(0x22a)]);}),logger[_0xc267cb(0x320)](_0xc267cb(0x20a)),process[_0xc267cb(0x37c)]({'restore':!![]},_0x210143=>{});}async function getPublicIp(){const _0x60269b=_0x56e2a6;try{const _0x49afd6=await axios[_0x60269b(0x2f5)](_0x60269b(0x362));publicip=_0x49afd6[_0x60269b(0x324)]['ip'];}catch(_0x5b93cc){}}async function triggerAnalytics(){const _0xb95c3c=_0x56e2a6;if(!publicip)await getPublicIp();const _0x41ec19=getBotsWithMode();let _0x3d82a0=0x0;_0x41ec19['forEach'](_0x5cacc8=>{const _0x1fc5fc=_0x259d;if(_0x5cacc8[_0x1fc5fc(0x263)]==='enabled')_0x3d82a0++;});const _0x5b3788=getBotExchanges();mixpanel['track'](_0xb95c3c(0x248),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x41ec19['length'],'numbotsenabled':_0x3d82a0,'exchanges':_0x5b3788});}async function getMessages(){const _0x52d322=_0x56e2a6,_0x5a667c=_0x52d322(0x2bf),_0xede61=new GraphQLClient(_0x5a667c),_0x4031bf={'authorization':_0x52d322(0x284)},_0x1ed492=serverversion[_0x52d322(0x35b)]('.'),_0x434fc8=_0x1ed492[0x0]+'.'+_0x1ed492[0x1],_0x36372f=Math[_0x52d322(0x2ba)](settings[_0x52d322(0x374)],settings['lastmsgemitted']),_0x41d7b7={'last':parseInt(_0x36372f),'bbm':_0x434fc8},_0x312f88=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x11a833;try{_0x11a833=await _0xede61[_0x52d322(0x20e)](_0x312f88,_0x41d7b7,_0x4031bf);}catch(_0x552afd){}if(_0x11a833&&_0x11a833['messages']){let _0x3c464b=settings[_0x52d322(0x374)];newMessages=[];for(const _0x538695 of _0x11a833[_0x52d322(0x246)]){newMessages['push'](_0x538695);if(_0x538695[_0x52d322(0x36b)])updateSetting('latestversion',_0x538695[_0x52d322(0x36b)]);let _0x26fc65=_0x538695[_0x52d322(0x36b)]?serverversion>=_0x538695['bbvNew']:![];if(!_0x26fc65&&_0x538695[_0x52d322(0x343)]>_0x3c464b){if(_0x538695[_0x52d322(0x388)]===_0x52d322(0x357)||serverversion[_0x52d322(0x2d9)](_0x538695[_0x52d322(0x388)])){let _0x4cabd0=''+_0x538695[_0x52d322(0x24c)]+'\x0a\x0a'+_0x538695['message'];const _0x5624b8=await sendTelegramMsg(toTelegramMarkdown(_0x4cabd0),_0x52d322(0x1de));if(_0x5624b8)_0x3c464b=_0x538695[_0x52d322(0x343)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting('lastmsgtelegram',_0x3c464b),emitMessages();}}function emitMessages(){const _0x4e7448=_0x56e2a6,_0x36924f=settings['lastmsgemitted'];let _0x2e2eef=[];newMessages[_0x4e7448(0x2e6)](_0x472401=>{_0x472401['number']>_0x36924f&&_0x2e2eef['push'](_0x472401);}),_0x2e2eef[_0x4e7448(0x32a)]>0x0&&getAllClients()['forEach'](_0x458010=>{const _0x2b4634=_0x4e7448;getSocket(_0x458010['id'])[_0x2b4634(0x2c9)](_0x2b4634(0x2c2),_0x2e2eef);});}function confirmMessage(_0x310a4c){updateSetting('lastmsgemitted',Number(_0x310a4c));}function isNewerVersion(_0x15992e,_0x321222){const _0x16b4b9=_0x56e2a6,_0x508f44=_0x321222[_0x16b4b9(0x35b)]('.'),_0x1949da=_0x15992e[_0x16b4b9(0x35b)]('.');for(var _0x363323=0x0;_0x363323<_0x1949da[_0x16b4b9(0x32a)];_0x363323++){const _0x109f5a=~~_0x1949da[_0x363323],_0x2c6bb7=~~_0x508f44[_0x363323];if(_0x109f5a>_0x2c6bb7)return!![];if(_0x109f5a<_0x2c6bb7)return![];}return![];}function toTelegramMarkdown(_0x444c63){const _0xdf32b5=_0x56e2a6,_0x5838a6=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x55ca8b=/\*{2}(.+?)\*{2}/gim;return _0x444c63=_0x444c63[_0xdf32b5(0x2ea)](_0x5838a6,'$1_$2_$3')[_0xdf32b5(0x2ea)](_0x55ca8b,'*$1*'),_0x444c63;}async function validateConfigFile(){const _0x54e932=_0x56e2a6,_0x3db24b=dbConfig[_0x54e932(0x2f5)](_0x54e932(0x2b7))['sortBy']('botID')[_0x54e932(0x27f)]()||[];if(_0x3db24b[_0x54e932(0x32a)]==0x0){let _0x21725e=0x0,_0xf8a85f=[];const _0x2ee748=/^bot-([0-9]{3})-config.json$/,_0x1b47f9=fs[_0x54e932(0x29a)](configpath);_0x1b47f9[_0x54e932(0x2e6)](_0x2ba21a=>{const _0x1f1c28=_0x54e932,_0xb0d565=_0x2ee748[_0x1f1c28(0x2a4)](_0x2ba21a);if(_0xb0d565){const _0x32752b=_0xb0d565[0x1];let _0x465642=getBotAttributes(_0x32752b);_0xf8a85f[_0x1f1c28(0x1c7)]({'botID':_0x32752b,'botname':_0x465642[_0x1f1c28(0x35a)],'status':_0x1f1c28(0x21c),'live':_0x1f1c28(0x1bf)}),_0x21725e++;}}),_0x21725e!=0x0&&(dbConfig[_0x54e932(0x2f5)](_0x54e932(0x2b7))[_0x54e932(0x2ad)](_0xf8a85f)[_0x54e932(0x2e7)](),config=_0xf8a85f,restoredConfigFile=_0x21725e);}}async function restoreConfigNotify(_0x5bba44){const _0x5e280c=_0x56e2a6;let _0x2d6d3;if(restoredConfigFile==0x1)_0x2d6d3=_0x5e280c(0x227);else _0x2d6d3=_0x5e280c(0x2fc);if(_0x5bba44)io['to'](_0x5e280c(0x38d))['emit'](_0x5e280c(0x2b2),_0x2d6d3);else{logger[_0x5e280c(0x37f)](_0x5e280c(0x240)),logger[_0x5e280c(0x37f)](_0x2d6d3),logger[_0x5e280c(0x37f)]('-----------------------------------------------------------------------------------'),logger[_0x5e280c(0x37f)]('');if(tgBot&&settings[_0x5e280c(0x361)]&&settings[_0x5e280c(0x1ce)]!=_0x5e280c(0x281))tgBot['sendMessage'](settings[_0x5e280c(0x361)],_0x5e280c(0x1fe)+_0x2d6d3)['catch'](_0x26dee3=>{telegramError(_0x26dee3);});}}function validateCredentials(_0x444de7,_0x413b70){const _0x416a91=_0x56e2a6;if(_0x444de7[_0x416a91(0x2c4)]==settings[_0x416a91(0x25c)]&&bcrypt[_0x416a91(0x1f5)](_0x444de7[_0x416a91(0x348)],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x416a91(0x1c8),'token':null};else{const _0x5c6c3d=generateLoginToken(_0x413b70);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x5c6c3d};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x377fec){const _0x29264f=_0x56e2a6,_0x316caf=generateLoginToken(_0x377fec);return{'allow':!![],'reason':_0x29264f(0x37a),'token':_0x316caf};}function validateAccess(_0x1ebb8c,_0x398f8f,_0x514b1e){const _0x5062f3=_0x56e2a6,_0x308cc1=_0x514b1e?_0x514b1e:devices[_0x398f8f]['ip'];let _0x47b8af;const _0x1c3e74=_0x56644d=>{const _0x2c03bf=_0x259d;if(settings[_0x2c03bf(0x2d2)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x398f8f)){const _0x5c6cba=generateLoginToken(_0x398f8f);return{'allow':!![],'reason':_0x2c03bf(0x232),'token':_0x5c6cba};}else return{'allow':![],'reason':_0x2c03bf(0x300),'token':null};}else return _0x47b8af=validToken(_0x56644d,_0x398f8f),_0x47b8af[_0x2c03bf(0x1eb)](_0x2c03bf(0x213))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x56644d}:{'allow':![],'reason':_0x2c03bf(0x300),'token':null};}else return{'allow':!![],'reason':_0x2c03bf(0x278),'token':null};};if(settings[_0x5062f3(0x21e)]){let _0x4b9e50=[...settings[_0x5062f3(0x337)],'::1',_0x5062f3(0x2ab),_0x5062f3(0x1bc)];if(_0x4b9e50[_0x5062f3(0x1fc)](_0x308cc1))return _0x1c3e74(_0x1ebb8c);else{_0x47b8af=validToken(_0x1ebb8c,_0x398f8f);if(_0x47b8af[_0x5062f3(0x1eb)](_0x5062f3(0x213)))return _0x1c3e74(_0x1ebb8c);else{if(telegramIpApproved(_0x398f8f)){const _0x51f1b0=generateToken(_0x398f8f);return _0x47b8af=_0x1c3e74(_0x1ebb8c),_0x47b8af[_0x5062f3(0x21a)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x51f1b0}:_0x47b8af;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x5062f3(0x202),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x1c3e74(_0x1ebb8c);}function timelyDecrypt(_0x5dee2f,_0x34b1a2=!![]){const _0x573f29=_0x56e2a6;if(_0x5dee2f)try{const _0x191e49=crypt[_0x573f29(0x38a)](secure[_0x573f29(0x295)],_0x5dee2f)[_0x573f29(0x2c2)],_0x311310=_0x191e49[_0x573f29(0x35b)]('@')[0x0],_0x324a77=_0x191e49[_0x573f29(0x35b)]('@')[0x1],_0x400bab=new Date()[_0x573f29(0x30e)]();if(_0x34b1a2){if(_0x400bab-_0x324a77<maxSecretAge*0x3e8)return _0x311310;else return![];}else return _0x311310;}catch(_0x10bae9){return![];}else return![];}const validToken=(_0x52e649,_0x4785ca)=>{const _0x142253=_0x56e2a6,_0x4c0de7=devices[_0x4785ca]['ip'];if(!_0x52e649)return{'error':_0x142253(0x1da)};for(let _0x86ccfd of blacklist){if(_0x86ccfd[_0x142253(0x24d)]==_0x52e649)return{'error':'Token\x20blacklisted'};}let _0xbb981f;try{_0xbb981f=jwt['verify'](_0x52e649,secure['secret']+_0x4785ca);}catch{return{'error':_0x142253(0x339)};}if(!_0xbb981f['hasOwnProperty'](_0x142253(0x33c))&&!_0xbb981f[_0x142253(0x1eb)]('username')||!_0xbb981f[_0x142253(0x1eb)](_0x142253(0x2cf)))return{'error':_0x142253(0x323)};if(!_0xbb981f[_0x142253(0x1eb)]('username')&&_0xbb981f[_0x142253(0x1eb)](_0x142253(0x33c))){const {clientip:_0x1ad20f}=_0xbb981f;return _0x4c0de7==_0x1ad20f?{'success':_0x142253(0x2cc)}:{'error':_0x142253(0x274)};}else{if(_0xbb981f[_0x142253(0x1eb)](_0x142253(0x2c4))&&_0xbb981f[_0x142253(0x1eb)](_0x142253(0x33c))){const {username:_0x48bf32,clientip:_0x1c9914}=_0xbb981f;return settings[_0x142253(0x25c)]==_0x48bf32&&_0x4c0de7==_0x1c9914?{'success':_0x142253(0x2cc)}:{'error':_0x142253(0x22f)};}}},generateLoginToken=_0x26f582=>{const _0x2eddb2=_0x56e2a6;if(_0x26f582){const _0x28bd9d=devices[_0x26f582]['ip'];return jwt[_0x2eddb2(0x30c)]({'username':settings[_0x2eddb2(0x25c)],'clientip':_0x28bd9d},secure[_0x2eddb2(0x30b)]+_0x26f582,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x423a27=>{const _0x571ca1=_0x56e2a6;if(_0x423a27){const _0x43bebb=devices[_0x423a27]['ip'];return jwt[_0x571ca1(0x30c)]({'clientip':_0x43bebb},secure[_0x571ca1(0x30b)]+_0x423a27,{'expiresIn':devices[_0x423a27]['telegramIpApproval'][_0x571ca1(0x262)]*0x3c});}else return![];},telegramIpApproved=_0x2a5e04=>{const _0x3672b2=_0x56e2a6;let _0x441cd9=![];return devices[_0x2a5e04][_0x3672b2(0x215)]&&devices[_0x2a5e04][_0x3672b2(0x215)][_0x3672b2(0x262)]!=_0x3672b2(0x2be)&&(_0x441cd9=devices[_0x2a5e04][_0x3672b2(0x215)][_0x3672b2(0x33c)]==devices[_0x2a5e04]['ip']&&new Date()[_0x3672b2(0x30e)]()-devices[_0x2a5e04][_0x3672b2(0x215)][_0x3672b2(0x319)]<devices[_0x2a5e04][_0x3672b2(0x215)][_0x3672b2(0x262)]*0x3c*0x3e8),_0x441cd9;},telegram2FaApproved=_0x25e616=>{const _0x57e64a=_0x56e2a6;let _0x6a112f=![];return devices[_0x25e616][_0x57e64a(0x2b6)]&&devices[_0x25e616][_0x57e64a(0x2b6)][_0x57e64a(0x262)]!='reject'&&(_0x6a112f=devices[_0x25e616][_0x57e64a(0x2b6)][_0x57e64a(0x33c)]==devices[_0x25e616]['ip']&&new Date()[_0x57e64a(0x30e)]()-devices[_0x25e616][_0x57e64a(0x2b6)]['timestamp']<devices[_0x25e616][_0x57e64a(0x2b6)]['expiry']*0x3c*0x3e8),_0x6a112f;},normalizeIP=_0x54a072=>{const _0x35e07b=_0x56e2a6;let _0x89cd3f=null,_0x5abb5b=null;if(ipaddr[_0x35e07b(0x312)](_0x54a072)){const _0x2eb7c4=ipaddr['parse'](_0x54a072);_0x2eb7c4['kind']()===_0x35e07b(0x31f)?(_0x2eb7c4['isIPv4MappedAddress']()&&(_0x89cd3f=_0x2eb7c4[_0x35e07b(0x22b)]()[_0x35e07b(0x382)]()),_0x5abb5b=_0x2eb7c4[_0x35e07b(0x382)]()):(_0x89cd3f=_0x2eb7c4['toString'](),_0x5abb5b=_0x2eb7c4[_0x35e07b(0x32b)]()[_0x35e07b(0x382)]());}return{'show':_0x89cd3f?_0x89cd3f:_0x5abb5b,'store':_0x5abb5b};};function formatDate(_0x4103e9){const _0xe95ac3=_0x56e2a6;return _0x4103e9[_0xe95ac3(0x2a5)]()+'/'+(_0x4103e9[_0xe95ac3(0x2eb)]()+0x1)[_0xe95ac3(0x382)]()[_0xe95ac3(0x259)](0x2,'0')+'/'+_0x4103e9[_0xe95ac3(0x292)]()[_0xe95ac3(0x382)]()[_0xe95ac3(0x259)](0x2,'0')+'\x20'+_0x4103e9['getHours']()[_0xe95ac3(0x382)]()['padStart'](0x2,'0')+':'+_0x4103e9[_0xe95ac3(0x2dd)]()[_0xe95ac3(0x382)]()['padStart'](0x2,'0')+':'+_0x4103e9[_0xe95ac3(0x200)]()['toString']()[_0xe95ac3(0x259)](0x2,'0');}function sleep(_0x1a95de){return new Promise(_0x4dd1c3=>setTimeout(_0x4dd1c3,_0x1a95de));}