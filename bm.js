const _0x1d6a55=_0x4d18;(function(_0x213e0d,_0x389eff){const _0x571752=_0x4d18,_0x411047=_0x213e0d();while(!![]){try{const _0x551b69=-parseInt(_0x571752(0x21b))/0x1+-parseInt(_0x571752(0x288))/0x2*(-parseInt(_0x571752(0x357))/0x3)+-parseInt(_0x571752(0x25e))/0x4+-parseInt(_0x571752(0x39f))/0x5+parseInt(_0x571752(0x2b2))/0x6*(parseInt(_0x571752(0x1e9))/0x7)+-parseInt(_0x571752(0x387))/0x8+parseInt(_0x571752(0x2ed))/0x9;if(_0x551b69===_0x389eff)break;else _0x411047['push'](_0x411047['shift']());}catch(_0x3eee5e){_0x411047['push'](_0x411047['shift']());}}}(_0x5b6e,0x87a07));const _0x52265b=function(){let _0x4cd69c=!![];return function(_0x1ca012,_0x2c989a){const _0x3ef221=_0x4cd69c?function(){const _0x55e02e=_0x4d18;if(_0x2c989a){const _0x1fbd8b=_0x2c989a[_0x55e02e(0x1e5)](_0x1ca012,arguments);return _0x2c989a=null,_0x1fbd8b;}}:function(){};return _0x4cd69c=![],_0x3ef221;};}(),_0x46bd18=_0x52265b(this,function(){const _0x476e88=_0x4d18;return _0x46bd18[_0x476e88(0x251)]()[_0x476e88(0x388)]('(((.+)+)+)+$')[_0x476e88(0x251)]()[_0x476e88(0x241)](_0x46bd18)[_0x476e88(0x388)](_0x476e88(0x29f));});_0x46bd18();'use strict';process[_0x1d6a55(0x1fb)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x1d6a55(0x1d0)),fs=require('fs'),fns=require(_0x1d6a55(0x356)),low=require(_0x1d6a55(0x1f3)),FileSync=require(_0x1d6a55(0x206)),path=require(_0x1d6a55(0x303)),crypto=require(_0x1d6a55(0x26e)),Crypt=require(_0x1d6a55(0x2b1))[_0x1d6a55(0x262)],RSA=require('hybrid-crypto-js')[_0x1d6a55(0x2c5)],bcrypt=require(_0x1d6a55(0x278)),jwt=require(_0x1d6a55(0x2a7)),ipaddr=require(_0x1d6a55(0x269)),argv=require(_0x1d6a55(0x352))(process[_0x1d6a55(0x277)][_0x1d6a55(0x35a)](0x2))[_0x1d6a55(0x277)],uuidRandom=require(_0x1d6a55(0x374)),TelegramBot=require(_0x1d6a55(0x1ed)),Mixpanel=require('mixpanel'),axios=require('axios'),{GraphQLClient,gql}=require(_0x1d6a55(0x1e4)),util=require('util'),fileUpload=require(_0x1d6a55(0x1d2)),{networkInterfaces}=require('os'),PORT=argv[_0x1d6a55(0x33a)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x1d6a55(0x349)](PORT)&&(console['log'](_0x1d6a55(0x2c4)+PORT+_0x1d6a55(0x24e)),process[_0x1d6a55(0x2c2)](0x1));const HOST=argv[_0x1d6a55(0x2c1)]||null,userID=argv[_0x1d6a55(0x281)]||'',debugging=argv['d']||![],nodeversion=process[_0x1d6a55(0x22f)][_0x1d6a55(0x310)];let bbpath=_0x1d6a55(0x341),bbpath2='';const botfile='bot.js',configfile=_0x1d6a55(0x201),settingsfile=_0x1d6a55(0x276),securefile=_0x1d6a55(0x38e),environment=require('./'+bbpath2+_0x1d6a55(0x342))[_0x1d6a55(0x2b0)]||'production',maxBackups=0xa;let validInstallation=!![];!fs[_0x1d6a55(0x225)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x1d6a55(0x2ab)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x1d6a55(0x295),configbackuppath=configpath+_0x1d6a55(0x31e),logspath=userID?bbpath+_0x1d6a55(0x2cf)+userID+'/':bbpath+_0x1d6a55(0x2cf),zippath=userID?bbpath+_0x1d6a55(0x29b)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x1d6a55(0x214)](logspath+_0x1d6a55(0x222),{'flags':'a'}),temppath=userID?bbpath+_0x1d6a55(0x1d4)+userID+'/':bbpath+_0x1d6a55(0x1d4);!fs[_0x1d6a55(0x225)](configpath)&&fs[_0x1d6a55(0x38d)](configpath);!fs[_0x1d6a55(0x225)](configbackuppath)&&fs[_0x1d6a55(0x38d)](configbackuppath);!fs[_0x1d6a55(0x225)](logspath)&&fs[_0x1d6a55(0x38d)](logspath);!fs[_0x1d6a55(0x225)](zippath)&&fs[_0x1d6a55(0x38d)](zippath);!fs['existsSync'](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x1d6a55(0x2a6)]({'bots':[]})[_0x1d6a55(0x238)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x1d6a55(0x2a6)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x1d6a55(0x2c0),'onepagemode':![]}})[_0x1d6a55(0x238)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x1d6a55(0x2a6)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x1d6a55(0x35c),'rsaStandard':_0x1d6a55(0x235)});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x1d6a55(0x2bc),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x1d6a55(0x332)]&&settings[_0x1d6a55(0x332)]!=''&&settings[_0x1d6a55(0x27f)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x20b039,_0x15c4ea)=>{const _0x41b0ac=_0x1d6a55,_0x226475=/#[A-Z]{3}#/g;if(typeof _0x20b039==_0x41b0ac(0x226)){!_0x15c4ea?_0x20b039=_0x20b039[_0x41b0ac(0x270)](_0x226475,''):(_0x20b039=_0x20b039[_0x41b0ac(0x270)](/#BLU#/g,_0x41b0ac(0x239)),_0x20b039=_0x20b039[_0x41b0ac(0x270)](/#RED#/g,_0x41b0ac(0x242)),_0x20b039=_0x20b039[_0x41b0ac(0x270)](/#YEL#/g,_0x41b0ac(0x26b)),_0x20b039=_0x20b039[_0x41b0ac(0x270)](/#MAG#/g,_0x41b0ac(0x312)),_0x20b039=_0x20b039[_0x41b0ac(0x270)](/#CYA#/g,_0x41b0ac(0x28c)),_0x20b039=_0x20b039['replace'](/#RES#/g,_0x41b0ac(0x1db)));;}return _0x20b039;},logger={'screen':_0x3f43c=>{console['log'](parseColor(_0x3f43c,!![]));},'simple':_0x49cc0e=>{const _0x3cb8ad=_0x1d6a55;console['log'](parseColor(_0x49cc0e,!![])),loggerfile[_0x3cb8ad(0x238)](util['format'](parseColor(_0x49cc0e,![]))+'\x0a');},'full':async _0x55993f=>{const _0x30ef98=_0x1d6a55,_0x327541=getTimeStamp()+_0x30ef98(0x39a)+_0x55993f;console[_0x30ef98(0x28a)](parseColor(_0x327541,!![])),loggerfile[_0x30ef98(0x238)](util[_0x30ef98(0x393)](parseColor(_0x327541,![]))+'\x0a');if(tgBot&&settings[_0x30ef98(0x378)]&&settings[_0x30ef98(0x2fd)]!='orders')await tgBot['sendMessage'](settings[_0x30ef98(0x378)],_0x30ef98(0x2c6)+parseColor(_0x55993f,![]))[_0x30ef98(0x30c)](_0x30752e=>{telegramError(_0x30752e);});},'debug':async(_0x2a1177,_0x1919fa='')=>{const _0x56b6e1=_0x1d6a55,_0x22d8b0=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x2a1177;if(debugging)console[_0x56b6e1(0x28a)](parseColor(_0x22d8b0,!![]));loggerfile['write'](util[_0x56b6e1(0x393)](parseColor(_0x22d8b0,![]))+'\x0a');if(_0x1919fa){if(debugging)console[_0x56b6e1(0x28a)](_0x1919fa);loggerfile[_0x56b6e1(0x238)](util[_0x56b6e1(0x393)](_0x1919fa)+'\x0a');}}};process['on'](_0x1d6a55(0x1f8),function(_0x2e3f54){const _0x5520e6=_0x1d6a55;logger[_0x5520e6(0x28e)](_0x2e3f54);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x1d6a55(0x264)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require('http')[_0x1d6a55(0x325)](app);app[_0x1d6a55(0x213)](fileUpload({'useTempFiles':!![]})),app['get'](_0x1d6a55(0x255),async(_0x9b4cd6,_0x2d8dd8)=>{const _0x4e8462=_0x1d6a55,_0x547d67=_0x9b4cd6[_0x4e8462(0x1ec)][_0x4e8462(0x1fc)],_0x5b9655=getClientsWithBotID('botmanager'),_0x2a5b44=_0x9b4cd6[_0x4e8462(0x1dd)][_0x4e8462(0x392)],_0xebe0=timelyDecrypt(_0x2a5b44,![]),_0x1d7d7e=_0x5b9655[_0x4e8462(0x37e)](_0x1b750f=>_0x1b750f['uuid']==_0xebe0);if(_0x1d7d7e){const _0x7275b5=normalizeIP(_0x9b4cd6[_0x4e8462(0x286)][_0x4e8462(0x2a4)])[_0x4e8462(0x2cd)],_0x20c826=_0x9b4cd6[_0x4e8462(0x1dd)][_0x4e8462(0x1cf)];if(validateAccess(_0x20c826,_0xebe0,_0x7275b5)[_0x4e8462(0x216)])_0x547d67=='backup'&&await backupConfigFiles(),await zipFiles(_0x547d67),_0x2d8dd8[_0x4e8462(0x355)](zippath+(_0x547d67+'.zip'),_0x5059a8=>{const _0x4ac45d=_0x4e8462;_0x5059a8&&(logger['full'](_0x4ac45d(0x368)+_0x547d67),logger[_0x4ac45d(0x28e)](_0x5059a8));});else logger[_0x4e8462(0x2eb)](_0x4e8462(0x363)+_0x547d67+_0x4e8462(0x232));}else logger[_0x4e8462(0x2eb)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x547d67+_0x4e8462(0x1e7));}),app[_0x1d6a55(0x32a)]('/upload-backup',async(_0x2335c4,_0x4cb982)=>{const _0x2bb161=_0x1d6a55,_0x5cd3ec=getClientsWithBotID(_0x2bb161(0x323)),_0x59413e=_0x2335c4[_0x2bb161(0x1dd)][_0x2bb161(0x392)],_0x5d4cf0=timelyDecrypt(_0x59413e,![]),_0xbfa15e=_0x5cd3ec['find'](_0x4dfb77=>_0x4dfb77['uuid']==_0x5d4cf0);logger[_0x2bb161(0x2ad)](_0x2bb161(0x22a));if(_0xbfa15e){const _0x1af753=normalizeIP(_0x2335c4['socket'][_0x2bb161(0x2a4)])['store'],_0x278171=_0x2335c4['headers'][_0x2bb161(0x1cf)];if(validateAccess(_0x278171,_0x5d4cf0,_0x1af753)[_0x2bb161(0x216)]){if(_0x2335c4[_0x2bb161(0x339)]){const _0x4cdcbf=_0x2335c4[_0x2bb161(0x339)]['backupfile'];await _0x4cdcbf['mv'](temppath+_0x4cdcbf[_0x2bb161(0x1ba)]),_0x4cb982[_0x2bb161(0x215)]({'status':!![],'message':_0x2bb161(0x266)});const _0xbb3ad4=getBotsWithMode();_0xbb3ad4[_0x2bb161(0x1ea)]>0x0?confirmRestore(temppath,_0x4cdcbf['name']):unzipFile(temppath,_0x4cdcbf[_0x2bb161(0x1ba)]);}}else logger[_0x2bb161(0x2eb)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x2bb161(0x2eb)](_0x2bb161(0x2e0));}),app[_0x1d6a55(0x213)](express[_0x1d6a55(0x1f1)](path[_0x1d6a55(0x2f7)](__dirname,bbpath2,'build2'))),app['use'](express['static'](path[_0x1d6a55(0x2f7)](__dirname,bbpath2,_0x1d6a55(0x25b)))),app[_0x1d6a55(0x2da)]('/',function(_0x1b548d,_0x281ba5){const _0x1fbe9b=_0x1d6a55;_0x281ba5[_0x1fbe9b(0x376)](path[_0x1fbe9b(0x2f7)](__dirname,bbpath2,_0x1fbe9b(0x367),_0x1fbe9b(0x20b)));}),app['get'](_0x1d6a55(0x398),function(_0x46efdc,_0x3cc744){const _0x4d75aa=_0x1d6a55;_0x3cc744['sendFile'](path[_0x4d75aa(0x2f7)](__dirname,bbpath2,_0x4d75aa(0x25b),_0x4d75aa(0x20b)));}),app[_0x1d6a55(0x2da)]('/:bot/portfolio',(_0x21df67,_0x3999c1)=>{const _0x103f48=_0x1d6a55;_0x3999c1[_0x103f48(0x376)](path[_0x103f48(0x2f7)](__dirname,bbpath2,_0x103f48(0x25b),_0x103f48(0x20b)));}),app[_0x1d6a55(0x2da)]('/:bot/performance',(_0x4b4583,_0x3372d2)=>{const _0x1bcffe=_0x1d6a55;_0x3372d2[_0x1bcffe(0x376)](path[_0x1bcffe(0x2f7)](__dirname,bbpath2,_0x1bcffe(0x25b),_0x1bcffe(0x20b)));}),app[_0x1d6a55(0x2da)](_0x1d6a55(0x221),(_0x1b2b09,_0x3acf06)=>{const _0x441b2e=_0x1d6a55;_0x3acf06['sendFile'](path[_0x441b2e(0x2f7)](__dirname,bbpath2,_0x441b2e(0x25b),_0x441b2e(0x20b)));}),app[_0x1d6a55(0x2da)](_0x1d6a55(0x395),(_0x347972,_0x589938)=>{const _0x473c51=_0x1d6a55;_0x589938[_0x473c51(0x376)](path[_0x473c51(0x2f7)](__dirname,bbpath2,_0x473c51(0x25b),_0x473c51(0x20b)));}),app[_0x1d6a55(0x2da)](_0x1d6a55(0x348),(_0x4a3cc9,_0x384c91)=>{const _0x3f06e2=_0x1d6a55;_0x384c91['sendFile'](path[_0x3f06e2(0x2f7)](__dirname,bbpath2,_0x3f06e2(0x25b),_0x3f06e2(0x20b)));}),app['get'](_0x1d6a55(0x25a),(_0x4bcda8,_0x42c9ba)=>{const _0x123a13=_0x1d6a55;_0x42c9ba['sendFile'](path[_0x123a13(0x2f7)](__dirname,bbpath2,_0x123a13(0x25b),'index.html'));});if(HOST)http[_0x1d6a55(0x1fa)](PORT,HOST);else http[_0x1d6a55(0x1fa)](PORT);const io=require(_0x1d6a55(0x399))(http,{});init();function _0x5b6e(){const _0x3ec6b0=['Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','reject','bot','auth','path','then','Orders','************','/status\x20-\x20show\x20bot(s)\x20status\x0a','Unauthorized\x20attempt\x20to\x20show\x20configuration','stringify','bbvReceive','secret','catch','latestversion','accept','/off\x20-\x20stop\x20bot(s)\x0a','node','pidExpireLogin','\x1b[35m','readFileSync','Network\x20Interfaces:','family','<b>Telegram\x20Bot\x20Status:</b>\x0a','sign','all','ipc','DEFLATE','restart','IPv4','telegrammsg','backup/','Invalid\x20authentication\x20token\x20(1)','sort','forEach','messages','botmanager','No\x20authentication\x20token','createServer','unlinkSync','output-002.log','store-settings','alias','post','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Unauthorized\x20attempt\x20to\x20log\x20out','apiKey','expiry','verify','#RES#\x20if\x20running\x20locally\x0a','headless','telegramToken','manual','Notifications\x20types:\x20','file','backup-full.zip','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','show','files','port','telegram','onepagemode','whitelistEnabled','notification','range','confirm-message','bb/','version.json','\x20|\x20client:\x20...','Your\x20installation\x20is\x20already\x20up\x20to\x20date','getPortfolio','Unauthorized\x20login\x20attempt\x20(timeout)','User\x20has\x20been\x20validated','/:bot/configuration','test','::ffff:127.0.0.1','connected','alerts','Ok,\x20will\x20send\x20alert\x20notifications\x20only','storeConfiguration','</b>\x20?','connection','getMonth','yargs/yargs','telegramIpApproval','generate','download','date-fns','174TdhIka','backup-full','***','slice','new-disabled','sha256','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Idling\x20bot\x20\x20\x20|\x20Bot\x20','privateKey','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','temporary\x20access\x20rejected','timestamp','Unauthorized\x20attempt\x20to\x20download\x20','reinstall','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','404\x20Not\x20Found','build2','Failed\x20to\x20download\x20','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','getStartingBalances','backup-files','hashSync','Login\x20accepted','Unauthorized\x20attempt\x20to\x20get\x20messages','token','conn','Yes','settings.','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','uuid-random','SIGINT','sendFile','SIGTERM','telegramChatId','split','::1','\x20minutes','request','push','find','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Logged\x20in\x20user\x20...','set','Notifications\x20enabled\x0a','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','order','access','copyFileSync','1460504xSFVFY','search','data','referer','-events.json','enabled','mkdirSync','bb-secure.json','storeFiat','loginRequired','live','uuid','format','Unauthorized\x20attempt\x20to\x20get\x20portfolio','/:bot/history','entries','Restore\x20process\x20aborted','/:bot','socket.io',':\x20Bot\x20Mgr\x20>\x20','/metrics\x20-\x20show\x20bot\x20performance\x0a','ipv6','staging','Disabled\x20Bot\x20','997485cEqujm','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','callback_query','name','get-messages','bbvNew','sockets','auto','keys','generateKeyPairAsync','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','\x20>\x20','-----------------------------------------------------------------------------------','reason','fork','Node.js\x20v','exp','Markdown','bot-','isIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20update\x20settings','from','/enable\x20-\x20enable\x20notifications\x0a','map','tkn','child_process','showConfig','express-fileupload','lastmsgtelegram','temp/','internal','isValid','30\x20min','Invalid\x20username\x20or\x20IP\x20address','Ok,\x20will\x20send\x20order\x20notifications\x20only','inherit','\x1b[0m','\x20|\x20','headers','stop','stopped','2FA\x20login\x20token\x20generated','Notifications\x20disabled','lastmsgemitted','function','graphql-request','apply','hex','\x20(2)','exec','7aijGGd','length','Starting\x20bot\x20|\x20Bot\x20','params','node-telegram-bot-api','kill','Starting\x20#RED#Balance\x20Bot\x20v','temporary\x20token\x20generated','static','encryptedUuid','lowdb','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','botID','storeHeadless','parse','uncaughtException','toIPv4Address','listen','env','type','Error\x20removing\x20old\x20backup\x20files:','userid','invalid\x20credentials','reset-history','bb-config.json','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','getTime','telegram2FaApproval','padStart','lowdb/adapters/FileSync','logged\x20out','match','Restoring\x20bot(s)\x20from\x20backup','Restore\x20backup\x20file\x20','index.html','sortBy','add-bot','Unauthorized\x20attempt\x20to\x20get\x20events','onText','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Starting\x20new\x20bot\x20|\x20Bot\x20','mtime','use','createWriteStream','send','allow','updatebotmanager','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','value','chat','455312dpjrjW','username','.zip','pidRefreshToken','compareSync','Error\x20while\x20deleting\x20config\x20files:\x20','/:bot/coins','/output-000.log','handshake','update-bb','existsSync','string','127.0.0.1','hasOwnProperty','toggleBotMode','Backup\x20file\x20uploaded','access\x20timeout','binary','temporary\x20access\x20not\x20allowed','reinstall-bb','versions','whitelist','secure','\x20(1)','*$1*','login\x20required','RSA-OAEP','toggle-bot-mode','includes','write','\x1b[34m','-performance.json','assign','Logged\x20out\x20user\x20...','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','disabled','constructor','\x1b[31m','No\x20bots\x20running\x20right\x20now','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','You\x20can\x20use\x20the\x20following\x20commands:\x0a','-config.json','getHours','\x20|\x20user:\x20...','reload','status','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','clientip','writeFileSync',',\x20must\x20be\x20a\x204\x20digit\x20number','getSeconds','bbUsername','toString','number','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','/on\x20-\x20start\x20bot(s)\x0a','/download/:type','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','timeshift','readdirSync','settings','/:bot/support','build','cloneDeep','delete-bot','1075476zlFVUt','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Notifications\x20enabled','=>\x20Go\x20to\x20#CYA#http://','Crypt','Temporary\x20access\x20rejected','version','randomBytes','File\x20uploaded','login\x20token\x20generated','output-001.log','ipaddr.js','output-003.log','\x1b[33m','error','emitHistory','crypto','address','replace','Allow\x20login\x20from\x20IP\x20address\x20<b>','sendMetricsTelegram','/help\x20-\x20show\x20available\x20commands\x0a','success','Invalid\x20authentication\x20token\x20(2)','bb-settings.json','argv','bcryptjs','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','logout','output-000.log','exchange','blacklist','/disable\x20-\x20disable\x20notifications\x0a','telegramUsername','Bot\x20','user','kind','All\x20bots','getUTCHours','Starting\x20Balance\x20Bot\x20update','socket','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','33098DieOTJ','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','log','Starting\x20Balance\x20Bot\x20reinstallation','\x1b[36m','answerCallbackQuery','simple','cancelLoading','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','update','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','backup-full@','config/','store-fiat','running','HTML','getDate','disconnect','zip/','Login\x20rejected','temporary\x20access\x20timeout','statSync','(((.+)+)+)+$','f2aRequired','2FA','Unauthorized\x20attempt\x20to\x20delete\x20bot','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','remoteAddress','botname','defaults','jsonwebtoken','message','/restart\x20-\x20restart\x20bot(s)\x0a','Enabled\x20Bot\x20','clients','randomFillSync','debug','getFullYear','Restarting\x20Bot\x20','environment','hybrid-crypto-js','3328518wFKyqn','stopPolling','show-config','rmSync','new','All','login','getMinutes','\x20to\x20','store-headless','6b67f3d61ee94b8f5c80b4affef4c4d9','mode','Unauthorized\x20attempt\x20to\x20confirm\x20message','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','0.0.0','host','exit','Backup\x20file\x20unzipped\x20and\x20stored','Error:\x20Invalid\x20argument\x20','RSA','Bot\x20Mgr\x20>\x20','password','apiPassword','delete-alerts','bots','emit','startsWith','store','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','logs/','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','15\x20min','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','5\x20min','event','<b>Balance\x20Bot\x20Status:</b>\x0a','login\x20not\x20required','server','remove','/update\x20-\x20update\x20Balance\x20Bot\x0a','get','All\x20bots\x20running\x20right\x20now','place-order','Unauthorized\x20attempt\x20to\x20store\x20configuration','node-zip','publicKey','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','(staging)','decrypt','store-configuration','get-portfolio','https://api.ipify.org?format=json','backup','filter','started','size','2FA\x20required','full','max','1324557jAJVGh','/names\x20-\x20show\x20bot\x20names\x0a','bbPassword','-results.json','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','temporaryAccessAllowed','orders','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','2FA\x20login\x20required','yes','join','isDirectory','once','removeListener','telegramEnabled','sendMessage','telegramEvents','\x20only\x0a'];_0x5b6e=function(){return _0x3ec6b0;};return _0x5b6e();}async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0xea0b1c=_0x1d6a55;let _0x214ea4='[ip-address]';const _0x4ecc52=networkInterfaces(),_0x4ad2d1={};for(const _0x23bff8 of Object[_0xea0b1c(0x1bf)](_0x4ecc52)){for(const _0x2a8dac of _0x4ecc52[_0x23bff8]){if((_0x2a8dac[_0xea0b1c(0x315)]==_0xea0b1c(0x31c)||_0x2a8dac['family']==0x4)&&!_0x2a8dac[_0xea0b1c(0x1d5)]){const _0x504201=ipaddr['parse'](_0x2a8dac[_0xea0b1c(0x26f)])[_0xea0b1c(0x33f)]();_0x504201!='private'&&(!_0x4ad2d1[_0x23bff8]&&(_0x4ad2d1[_0x23bff8]=[]),_0x4ad2d1[_0x23bff8][_0xea0b1c(0x37d)](_0x2a8dac['address']),_0x214ea4=_0x2a8dac[_0xea0b1c(0x26f)]);}}}return{'serverip':_0x214ea4,'netinterfaces':_0x4ad2d1};}async function startServer(){const _0x2223f2=_0x1d6a55,{serverip:_0x2c8ce8,netinterfaces:_0x51087e}=getServerIP();logger[_0x2223f2(0x28e)](''),logger[_0x2223f2(0x28e)](_0x2223f2(0x1c3)),await logger[_0x2223f2(0x2eb)](_0x2223f2(0x1ef)+serverversion+'#RES#\x20'+(environment==_0x2223f2(0x39d)?_0x2223f2(0x2e1):'')+'\x0a'+(_0x2223f2(0x2d0)+PORT+_0x2223f2(0x330))+(_0x2223f2(0x261)+_0x2c8ce8+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x2223f2(0x28e)](_0x2223f2(0x1c3));if(config[_0x2223f2(0x1ea)]!=0x0)for(const _0x509d1a of config){if(_0x509d1a['status']==_0x2223f2(0x38c)||_0x509d1a[_0x2223f2(0x24a)]=='new')await logger[_0x2223f2(0x2eb)](_0x2223f2(0x1eb)+_0x509d1a[_0x2223f2(0x1f5)]+_0x2223f2(0x1dc)+_0x509d1a['botname']),startBot([_0x509d1a[_0x2223f2(0x1f5)],userID],{'cwd':bbpath},function(_0x598e9f){const _0x4707c8=_0x2223f2;if(_0x598e9f)logger[_0x4707c8(0x2eb)](_0x598e9f);});else(_0x509d1a[_0x2223f2(0x24a)]==_0x2223f2(0x240)||_0x509d1a['status']=='new-disabled')&&await logger[_0x2223f2(0x2eb)](_0x2223f2(0x35e)+_0x509d1a[_0x2223f2(0x1f5)]+_0x2223f2(0x1dc)+_0x509d1a['botname']);}else!newBot&&logger[_0x2223f2(0x28e)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x2223f2(0x28e)](_0x2223f2(0x1c3)),logger[_0x2223f2(0x28e)](''),await logger[_0x2223f2(0x2ad)](_0x2223f2(0x1c6)+nodeversion),await logger['debug'](_0x2223f2(0x314),_0x51087e);}function startSocket(){const _0x483016=_0x1d6a55;io['on'](_0x483016(0x350),_0x5e79bc=>{const _0x217bff=_0x483016;let _0x302368,_0x400ea9,_0x9b2f47,_0x1c8e30,_0x433e63;const _0x3e5e02=_0x5e79bc[_0x217bff(0x223)]['headers'][_0x217bff(0x38a)];_0x400ea9=_0x3e5e02[_0x217bff(0x208)](/bot[0-9]{3}/);if(_0x400ea9)_0x9b2f47=_0x400ea9[0x0][_0x217bff(0x208)](/[0-9]{3}/);if(_0x9b2f47)_0x302368=_0x9b2f47[0x0];else _0x302368=_0x217bff(0x323);const _0xe90d4a=_0x5e79bc[_0x217bff(0x223)][_0x217bff(0x302)][_0x217bff(0x1f2)];if(!_0xe90d4a)_0x5e79bc['emit'](_0x217bff(0x24a),{'publicKey':secure['publicKey']});else{_0x1c8e30=timelyDecrypt(_0xe90d4a,![]);if(!_0x1c8e30)_0x5e79bc[_0x217bff(0x2cb)]('status',{'publicKey':secure[_0x217bff(0x2df)]});else{_0x433e63=normalizeIP(_0x5e79bc[_0x217bff(0x370)][_0x217bff(0x2a4)])[_0x217bff(0x2cd)];if(!devices[_0x1c8e30])devices[_0x1c8e30]={'uuid':_0x1c8e30,'access':{'token':null}};devices[_0x1c8e30]['ip']=_0x433e63;const _0xb2bc49=addClient(_0x5e79bc['id'],_0x1c8e30,_0x302368);setAccess(_0xb2bc49),emitMessages(),_0x5e79bc['on'](_0x217bff(0x2b8),_0x25308b=>{const _0x1e8e6f=_0x217bff,_0x5a3712=timelyDecrypt(_0x25308b[_0x1e8e6f(0x2c7)]);if(_0x5a3712){_0x25308b={'username':_0x25308b[_0x1e8e6f(0x21c)],'password':_0x5a3712},devices[_0x1c8e30][_0x1e8e6f(0x385)]=validateCredentials(_0x25308b,_0x1c8e30);if(devices[_0x1c8e30][_0x1e8e6f(0x385)]['allow']==![]&&devices[_0x1c8e30][_0x1e8e6f(0x385)][_0x1e8e6f(0x1c4)]==_0x1e8e6f(0x2f5))_0x5e79bc[_0x1e8e6f(0x2cb)](_0x1e8e6f(0x24a),{'access':devices[_0x1c8e30][_0x1e8e6f(0x385)]}),loginAccess2FA(_0x1c8e30,_0x433e63);else{if(devices[_0x1c8e30]['access'][_0x1e8e6f(0x216)]==![]&&devices[_0x1c8e30][_0x1e8e6f(0x385)]['reason']=='invalid\x20credentials')_0x5e79bc['emit'](_0x1e8e6f(0x24a),{'access':devices[_0x1c8e30][_0x1e8e6f(0x385)]});else devices[_0x1c8e30]['access'][_0x1e8e6f(0x216)]&&devices[_0x1c8e30]['access'][_0x1e8e6f(0x1c4)]==_0x1e8e6f(0x267)&&(getClientsWithUuid(_0x1c8e30)[_0x1e8e6f(0x321)](_0x13141e=>{setAccess(_0x13141e);}),logger[_0x1e8e6f(0x2ad)](_0x1e8e6f(0x380)+_0x1c8e30[_0x1e8e6f(0x35a)](-0x8)),setTokenRefresh(_0x1c8e30),setSessionTimeout(_0x1e8e6f(0x2b8),_0x1c8e30));}}else logger[_0x1e8e6f(0x2eb)](_0x1e8e6f(0x346));}),_0x5e79bc['on']('reset-password',()=>{resetPassword();}),_0x5e79bc['on'](_0x217bff(0x29a),_0x8dc74e=>{removeClient(_0x5e79bc['id']);}),_0x302368==_0x217bff(0x323)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5771f8){const _0x550b41=_0x1d6a55;if(_0x5771f8!=_0x550b41(0x323)&&config[_0x550b41(0x32d)]!=''){if(pid[_0x5771f8])pid[_0x5771f8][_0x550b41(0x215)]({'function':'initclient','args':null});}_0x5771f8!=_0x550b41(0x323)&&broadcastToBots(_0x550b41(0x2ca),JSON['stringify'](config));}function reloadBotManager(){const _0x33b3ea=_0x1d6a55;getClientsWithBotID(_0x33b3ea(0x323))['forEach'](_0x34c946=>{const _0x423bc1=_0x33b3ea;getSocket(_0x34c946['id'])[_0x423bc1(0x2cb)]('status',{'access':{'allow':![],'reason':_0x423bc1(0x249),'token':null}});});}function getSocket(_0x4b789b){const _0x1d7d02=_0x1d6a55;return io[_0x1d7d02(0x1bd)][_0x1d7d02(0x1bd)][_0x1d7d02(0x2da)](_0x4b789b);}function setAccess(_0x3b2803){const _0x4337f1=_0x1d6a55,_0x535cb4=getSocket(_0x3b2803['id']),_0x2f7989=_0x3b2803[_0x4337f1(0x392)],_0x1c3e8a=_0x3b2803['bot'];devices[_0x2f7989][_0x4337f1(0x385)]=validateAccess(devices[_0x2f7989][_0x4337f1(0x385)][_0x4337f1(0x36f)],_0x2f7989),logger[_0x4337f1(0x2ad)]('Setting\x20access:\x20'+devices[_0x2f7989][_0x4337f1(0x385)][_0x4337f1(0x1c4)]+_0x4337f1(0x343)+_0x3b2803['id'][_0x4337f1(0x35a)](-0x8)+_0x4337f1(0x248)+_0x2f7989['slice'](-0x8)),_0x535cb4['join'](_0x2f7989);if(devices[_0x2f7989]['access'][_0x4337f1(0x216)]){_0x535cb4[_0x4337f1(0x2f7)](_0x1c3e8a);if(_0x1c3e8a==_0x4337f1(0x323))initializeSocketBotManager(_0x535cb4);else initializeSocketBot(_0x535cb4);initClient(_0x1c3e8a);}devices[_0x2f7989]['access'][_0x4337f1(0x36f)]&&devices[_0x2f7989][_0x4337f1(0x385)][_0x4337f1(0x1c4)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x4337f1(0x2a1),_0x2f7989),devices[_0x2f7989][_0x4337f1(0x385)][_0x4337f1(0x36f)]&&devices[_0x2f7989]['access'][_0x4337f1(0x1c4)]==_0x4337f1(0x1e0)&&setSessionTimeout(_0x4337f1(0x2b8),_0x2f7989),_0x535cb4[_0x4337f1(0x2cb)]('status',{'status':_0x3b2803[_0x4337f1(0x2d7)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2f7989][_0x4337f1(0x385)],'externalip':devices[_0x2f7989]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x4337f1(0x1fe)],'validInstallation':validInstallation}),devices[_0x2f7989][_0x4337f1(0x385)][_0x4337f1(0x216)]==![]&&devices[_0x2f7989][_0x4337f1(0x385)][_0x4337f1(0x1c4)]==_0x4337f1(0x2ea)&&temporaryAccess2FA(_0x2f7989,devices[_0x2f7989]['ip']);}function setSessionTimeout(_0x52fc5e,_0x43fb00){const _0x4cb7aa=_0x1d6a55;let _0xdf3b13;if(_0x52fc5e=='login')_0xdf3b13=loginExpiry*0x3c*0x3e8;else _0xdf3b13=devices[_0x43fb00][_0x4cb7aa(0x353)][_0x4cb7aa(0x32e)]*0x3c*0x3e8-(new Date()[_0x4cb7aa(0x203)]()-devices[_0x43fb00][_0x4cb7aa(0x353)][_0x4cb7aa(0x362)]);if(devices[_0x43fb00][_0x4cb7aa(0x311)])clearTimeout(devices[_0x43fb00][_0x4cb7aa(0x311)]);devices[_0x43fb00][_0x4cb7aa(0x311)]=setTimeout(()=>{const _0x364e37=_0x4cb7aa;if(devices[_0x43fb00]['pidRefreshToken'])clearTimeout(devices[_0x43fb00][_0x364e37(0x21e)]);removeSocketListeners(_0x43fb00),addBlacklist(_0x43fb00),devices[_0x43fb00]['telegramIpApproval']=null,devices[_0x43fb00]['telegram2FaApproval']=null,devices[_0x43fb00][_0x364e37(0x385)][_0x364e37(0x36f)]=null,logger[_0x364e37(0x2ad)]('Session\x20expired\x20for\x20user\x20...'+_0x43fb00[_0x364e37(0x35a)](-0x8)),devices[_0x43fb00][_0x364e37(0x385)]=validateAccess(devices[_0x43fb00][_0x364e37(0x385)][_0x364e37(0x36f)],_0x43fb00),!(devices[_0x43fb00][_0x364e37(0x385)][_0x364e37(0x216)]&&devices[_0x43fb00][_0x364e37(0x385)][_0x364e37(0x1c4)]==_0x364e37(0x2d6))&&(_0x52fc5e=='login'?io['to'](_0x43fb00)[_0x364e37(0x2cb)](_0x364e37(0x24a),{'access':{'allow':![],'reason':_0x364e37(0x22b),'token':null}}):io['to'](_0x43fb00)[_0x364e37(0x2cb)]('status',{'access':{'allow':![],'reason':_0x364e37(0x29d),'token':null}})),devices[_0x43fb00]['access'][_0x364e37(0x36f)]=null;},_0xdf3b13);}function setTokenRefresh(_0x4f56f3){const _0x5c75d1=_0x1d6a55;if(devices[_0x4f56f3]['pidRefreshToken'])clearTimeout(devices[_0x4f56f3]['pidRefreshToken']);devices[_0x4f56f3][_0x5c75d1(0x21e)]=setTimeout(()=>{const _0x5dd661=_0x5c75d1;getClientsWithUuid(_0x4f56f3)[_0x5dd661(0x1ea)]!=0x0?(devices[_0x4f56f3][_0x5dd661(0x385)]=refreshToken(_0x4f56f3),io['to'](_0x4f56f3)[_0x5dd661(0x2cb)](_0x5dd661(0x24a),{'status':_0x5dd661(0x34b),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4f56f3][_0x5dd661(0x385)],'externalip':devices[_0x4f56f3]['ip'],'publicKey':secure[_0x5dd661(0x2df)],'validInstallation':validInstallation}),setTokenRefresh(_0x4f56f3)):clearTimeout(devices[_0x4f56f3][_0x5dd661(0x21e)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3a5acd){const _0x1537cb=_0x1d6a55,_0x1d4edc=getClient(_0x3a5acd['id'])[_0x1537cb(0x392)];_0x3a5acd[_0x1537cb(0x2cb)](_0x1537cb(0x2ca),config),_0x3a5acd[_0x1537cb(0x2cb)](_0x1537cb(0x259),cleanSettings()),_0x3a5acd['on'](_0x1537cb(0x20d),_0x2ad3fd=>{const _0x4352c1=_0x1537cb;if(validateAccess(_0x2ad3fd,_0x1d4edc)['allow'])addBot();else logger[_0x4352c1(0x2eb)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x3a5acd['on']('update-bot',(_0x53ef45,_0x34f39e)=>{const _0x56d33d=_0x1537cb;if(validateAccess(_0x34f39e,_0x1d4edc)['allow'])toggleBot(_0x53ef45[_0x56d33d(0x1f5)],_0x53ef45[_0x56d33d(0x24a)],_0x53ef45[_0x56d33d(0x391)]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x3a5acd['on'](_0x1537cb(0x236),(_0x31f791,_0x338fcf)=>{const _0x5e242e=_0x1537cb;if(validateAccess(_0x338fcf,_0x1d4edc)[_0x5e242e(0x216)])toggleBotMode(_0x31f791);else logger[_0x5e242e(0x2eb)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x3a5acd['on'](_0x1537cb(0x25d),(_0x20885b,_0x543991)=>{const _0x59b2ee=_0x1537cb;if(validateAccess(_0x543991,_0x1d4edc)[_0x59b2ee(0x216)])deleteBot(_0x20885b);else logger['full'](_0x59b2ee(0x2a2));}),_0x3a5acd['on'](_0x1537cb(0x328),(_0x34a437,_0x5a2a97)=>{const _0x2956c6=_0x1537cb;if(validateAccess(_0x5a2a97,_0x1d4edc)['allow'])storeSettings(_0x34a437,!![]);else logger[_0x2956c6(0x2eb)](_0x2956c6(0x1cb));}),_0x3a5acd['on'](_0x1537cb(0x224),_0x430b75=>{const _0x455e7d=_0x1537cb;if(validateAccess(_0x430b75,_0x1d4edc)[_0x455e7d(0x216)])updateBB(_0x455e7d(0x292));else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x3a5acd['on'](_0x1537cb(0x22e),_0x170dbd=>{const _0x8ad320=_0x1537cb;if(validateAccess(_0x170dbd,_0x1d4edc)[_0x8ad320(0x216)])updateBB(_0x8ad320(0x364));else logger[_0x8ad320(0x2eb)](_0x8ad320(0x365));}),_0x3a5acd['on']('get-backup-files',_0x51ce72=>{const _0x395103=_0x1537cb;if(validateAccess(_0x51ce72,_0x1d4edc)[_0x395103(0x216)]){const _0x2d496e=getClient(_0x3a5acd['id']);if(_0x2d496e)getBackupFiles(_0x2d496e[_0x395103(0x392)]);else logger[_0x395103(0x2eb)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x395103(0x2eb)](_0x395103(0x2f1));}),_0x3a5acd['on']('restore-backup-file',(_0x41fee5,_0x171d96)=>{const _0x56a13a=_0x1537cb;if(validateAccess(_0x171d96,_0x1d4edc)[_0x56a13a(0x216)])restoreBackupFile(_0x41fee5);else logger['full']('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x3a5acd['on'](_0x1537cb(0x1bb),_0x1d6889=>{const _0x5ddd4a=_0x1537cb;if(validateAccess(_0x1d6889,_0x1d4edc)[_0x5ddd4a(0x216)])getMessages();else logger[_0x5ddd4a(0x2eb)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x3a5acd['on'](_0x1537cb(0x340),(_0x4372e8,_0x5e3d69)=>{const _0x409f0d=_0x1537cb;if(validateAccess(_0x5e3d69,_0x1d4edc)[_0x409f0d(0x216)])confirmMessage(_0x4372e8);else logger['full'](_0x409f0d(0x2be));}),_0x3a5acd['on']('logout',_0x1cf9ad=>{const _0x3ec47e=_0x1537cb;if(validateAccess(_0x1cf9ad,_0x1d4edc)['allow']){if(devices[_0x1d4edc][_0x3ec47e(0x21e)])clearTimeout(devices[_0x1d4edc][_0x3ec47e(0x21e)]);if(devices[_0x1d4edc]['pidExpireLogin'])clearTimeout(devices[_0x1d4edc][_0x3ec47e(0x311)]);removeSocketListeners(getClient(_0x3a5acd['id'])['uuid']),addBlacklist(_0x1d4edc),devices[_0x1d4edc]['telegramIpApproval']=null,devices[_0x1d4edc][_0x3ec47e(0x204)]=null,devices[_0x1d4edc]['access']['token']=null,logger[_0x3ec47e(0x2ad)](_0x3ec47e(0x23c)+_0x1d4edc[_0x3ec47e(0x35a)](-0x8)),io['to'](getClient(_0x3a5acd['id'])[_0x3ec47e(0x392)])[_0x3ec47e(0x2cb)](_0x3ec47e(0x24a),{'access':{'allow':![],'reason':_0x3ec47e(0x207),'token':null}});}else logger['full'](_0x3ec47e(0x32c));});}function initializeSocketBot(_0x2e33bb){const _0x20c898=_0x1d6a55,_0x2292d7=getClient(_0x2e33bb['id'])[_0x20c898(0x301)],_0x45668a=getClient(_0x2e33bb['id'])[_0x20c898(0x392)];_0x2e33bb['on']('get-logs',(_0x574453,_0x559faf)=>{const _0x250048=_0x20c898;if(validateAccess(_0x559faf,_0x45668a)[_0x250048(0x216)]){if(pid[_0x2292d7])pid[_0x2292d7][_0x250048(0x215)]({'function':_0x250048(0x26d),'args':_0x574453});}else logger[_0x250048(0x2eb)](_0x250048(0x20e));}),_0x2e33bb['on'](_0x20c898(0x2c9),(_0x519ebd,_0xfe2e6e)=>{const _0x5374c0=_0x20c898;if(validateAccess(_0xfe2e6e,_0x45668a)[_0x5374c0(0x216)]){if(pid[_0x2292d7])pid[_0x2292d7][_0x5374c0(0x215)]({'function':'deleteHistoryAlerts','args':_0x519ebd});}else logger[_0x5374c0(0x2eb)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x2e33bb['on'](_0x20c898(0x2e4),(_0xd1ef97,_0x3e5380)=>{const _0x4ef3f7=_0x20c898;if(validateAccess(_0x3e5380,_0x45668a)['allow']){if(pid[_0x2292d7])pid[_0x2292d7][_0x4ef3f7(0x215)]({'function':_0x4ef3f7(0x345),'args':_0xd1ef97});}else logger[_0x4ef3f7(0x2eb)](_0x4ef3f7(0x394));}),_0x2e33bb['on'](_0x20c898(0x2e3),(_0x527a4d,_0x3d7f5b)=>{const _0x2e8d5a=_0x20c898;if(validateAccess(_0x3d7f5b,_0x45668a)['allow']){if(pid[_0x2292d7])pid[_0x2292d7][_0x2e8d5a(0x215)]({'function':_0x2e8d5a(0x34e),'args':_0x527a4d});}else logger[_0x2e8d5a(0x2eb)](_0x2e8d5a(0x2dd));}),_0x2e33bb['on'](_0x20c898(0x2bb),(_0x2b8dfd,_0x353137)=>{const _0x1f15fa=_0x20c898;if(validateAccess(_0x353137,_0x45668a)[_0x1f15fa(0x216)]){if(pid[_0x2292d7])pid[_0x2292d7][_0x1f15fa(0x215)]({'function':_0x1f15fa(0x1f6),'args':_0x2b8dfd});}else logger[_0x1f15fa(0x2eb)](_0x1f15fa(0x23f));}),_0x2e33bb['on'](_0x20c898(0x296),(_0x1e1bbb,_0x5545ee)=>{const _0x376831=_0x20c898;if(validateAccess(_0x5545ee,_0x45668a)['allow']){if(pid[_0x2292d7])pid[_0x2292d7][_0x376831(0x215)]({'function':_0x376831(0x38f),'args':_0x1e1bbb});}else logger['full'](_0x376831(0x293));}),_0x2e33bb['on'](_0x20c898(0x200),_0x123620=>{const _0x5038bb=_0x20c898;if(validateAccess(_0x123620,_0x45668a)[_0x5038bb(0x216)]){if(pid[_0x2292d7])pid[_0x2292d7][_0x5038bb(0x215)]({'function':'resetHistory','args':null});}else logger[_0x5038bb(0x2eb)](_0x5038bb(0x2f4));}),_0x2e33bb['on']('get-starting-balances',_0x28168c=>{const _0x52cdf9=_0x20c898;if(validateAccess(_0x28168c,_0x45668a)['allow']){if(pid[_0x2292d7])pid[_0x2292d7]['send']({'function':_0x52cdf9(0x36a),'args':null});}else logger[_0x52cdf9(0x2eb)](_0x52cdf9(0x37f));}),_0x2e33bb['on'](_0x20c898(0x2dc),(_0x289eed,_0x574675)=>{const _0x452279=_0x20c898;if(validateAccess(_0x574675,_0x45668a)['allow']){if(pid[_0x2292d7])pid[_0x2292d7][_0x452279(0x215)]({'function':'placeOrder','args':_0x289eed});}else logger[_0x452279(0x2eb)](_0x452279(0x202));}),_0x2e33bb['on']('cancel-loading',_0x46510d=>{const _0x5b8cea=_0x20c898;if(validateAccess(_0x46510d,_0x45668a)[_0x5b8cea(0x216)]){if(pid[_0x2292d7])pid[_0x2292d7][_0x5b8cea(0x215)]({'function':_0x5b8cea(0x28f),'args':null});}else logger[_0x5b8cea(0x2eb)](_0x5b8cea(0x218));}),_0x2e33bb['on'](_0x20c898(0x2b4),_0x304901=>{const _0x40b50c=_0x20c898;if(validateAccess(_0x304901,_0x45668a)[_0x40b50c(0x216)]){if(pid[_0x2292d7])pid[_0x2292d7]['send']({'function':_0x40b50c(0x1d1),'args':null});}else logger[_0x40b50c(0x2eb)](_0x40b50c(0x308));}),_0x2e33bb['on'](_0x20c898(0x224),_0x224a86=>{const _0x4f005e=_0x20c898;if(validateAccess(_0x224a86,_0x45668a)[_0x4f005e(0x216)])updateBB('update');else logger['full'](_0x4f005e(0x256));}),_0x2e33bb['on'](_0x20c898(0x1bb),_0x23e638=>{const _0x4522c9=_0x20c898;if(validateAccess(_0x23e638,_0x45668a)[_0x4522c9(0x216)])getMessages();else logger[_0x4522c9(0x2eb)](_0x4522c9(0x36e));}),_0x2e33bb['on'](_0x20c898(0x340),(_0x424774,_0x546f20)=>{const _0x494a6e=_0x20c898;if(validateAccess(_0x546f20,_0x45668a)['allow'])confirmMessage(_0x424774);else logger[_0x494a6e(0x2eb)](_0x494a6e(0x2be));}),_0x2e33bb['on'](_0x20c898(0x27a),_0x566b69=>{const _0xf402c8=_0x20c898;if(validateAccess(_0x566b69,_0x45668a)[_0xf402c8(0x216)]){if(devices[_0x45668a][_0xf402c8(0x21e)])clearTimeout(devices[_0x45668a][_0xf402c8(0x21e)]);if(devices[_0x45668a]['pidExpireLogin'])clearTimeout(devices[_0x45668a]['pidExpireLogin']);removeSocketListeners(getClient(_0x2e33bb['id'])['uuid']),addBlacklist(_0x45668a),devices[_0x45668a][_0xf402c8(0x353)]=null,devices[_0x45668a][_0xf402c8(0x204)]=null,devices[_0x45668a][_0xf402c8(0x385)]['token']=null,logger[_0xf402c8(0x2ad)](_0xf402c8(0x23c)+_0x45668a[_0xf402c8(0x35a)](-0x8)),io['to'](getClient(_0x2e33bb['id'])[_0xf402c8(0x392)])['emit'](_0xf402c8(0x24a),{'access':{'allow':![],'reason':_0xf402c8(0x207),'token':null}});}else logger[_0xf402c8(0x2eb)](_0xf402c8(0x32c));});}function removeSocketListeners(_0x5f2bb6){const _0x21e8b6=_0x1d6a55;getClientsWithUuid(_0x5f2bb6)[_0x21e8b6(0x321)](_0x5edad4=>{getSocket(_0x5edad4['id'])['removeAllListeners']();});}function cleanSettings(){const _0x5bf870=_0x1d6a55;let _0x8b1c70=settings;return settings[_0x5bf870(0x332)]&&settings[_0x5bf870(0x332)]!=''&&(_0x8b1c70={..._0x8b1c70,'telegramToken':_0x5bf870(0x306)}),settings[_0x5bf870(0x2ef)]&&settings[_0x5bf870(0x2ef)]!=''&&(_0x8b1c70={..._0x8b1c70,'bbPassword':_0x5bf870(0x306)}),(settings[_0x5bf870(0x2ef)]&&settings[_0x5bf870(0x2ef)]==_0x5bf870(0x359)||settings[_0x5bf870(0x332)]&&settings[_0x5bf870(0x332)]=='***')&&(_0x8b1c70={..._0x8b1c70,'restored':{'password':settings[_0x5bf870(0x2ef)]==_0x5bf870(0x359),'telegram':settings[_0x5bf870(0x332)]=='***'}}),_0x8b1c70;}async function updateBB(_0xb7a8d8){const _0x48ee9e=_0x1d6a55;await backupConfigFiles(),installingUpdate=!![],config[_0x48ee9e(0x321)](_0x274e67=>{const _0x4a35b3=_0x48ee9e;restartBot(_0x274e67[_0x4a35b3(0x1f5)]);});if(_0xb7a8d8==_0x48ee9e(0x292))process[_0x48ee9e(0x215)]({'update':!![],'environment':environment},_0x9a8b3c=>{});else _0xb7a8d8==_0x48ee9e(0x364)&&process[_0x48ee9e(0x215)]({'reinstall':!![],'environment':environment},_0x3c3e62=>{});}function startBot(_0x159c5f,_0x536bd0,_0x37845a){const _0x100e3d=_0x1d6a55;if(debugging)_0x159c5f[_0x100e3d(0x37d)]('-d');let _0x231f0e=![];const _0x388411=_0x159c5f[0x0];_0x536bd0={..._0x536bd0,'stdio':[_0x100e3d(0x1da),_0x100e3d(0x1da),_0x100e3d(0x1da),_0x100e3d(0x319)]},pid[_0x388411]=childProcess[_0x100e3d(0x1c5)](botfile,_0x159c5f,_0x536bd0),pid[_0x388411]['on'](_0x100e3d(0x2a8),_0x44fbdd=>{const _0x22fdf9=_0x100e3d;switch(Object[_0x22fdf9(0x1bf)](_0x44fbdd)[0x0]){case _0x22fdf9(0x2a5):updateBotName(_0x388411,_0x44fbdd[_0x22fdf9(0x2a5)]);break;case _0x22fdf9(0x217):updateBotManager();break;case'status':updateStatus(_0x388411,_0x44fbdd['status']);break;case _0x22fdf9(0x391):updateLive(_0x388411,_0x44fbdd[_0x22fdf9(0x391)]);break;case _0x22fdf9(0x2e8):updateLive(_0x388411,_0x44fbdd[_0x22fdf9(0x2e8)]),io['to'](_0x388411)[_0x22fdf9(0x2cb)]('status',{'access':{'allow':![],'reason':_0x22fdf9(0x249),'token':null}});break;case _0x22fdf9(0x1de):_0x44fbdd['stop']==_0x22fdf9(0x31b)&&restartBot(_0x388411);_0x44fbdd['stop']==_0x22fdf9(0x1ee)&&toggleBot(_0x388411,_0x22fdf9(0x240),_0x22fdf9(0x1df));break;case _0x22fdf9(0x33b):sendTelegram(_0x388411,_0x44fbdd[_0x22fdf9(0x33b)]);break;case'telegrammsg':sendTelegramMsg(_0x44fbdd[_0x22fdf9(0x31d)]);break;case _0x22fdf9(0x1e3):io['to'](_0x388411)['emit'](_0x44fbdd[_0x22fdf9(0x1e3)],_0x44fbdd['args']);break;}}),pid[_0x388411]['on']('error',function(_0x41603c){if(_0x231f0e)return;_0x231f0e=!![],_0x37845a(_0x41603c);}),pid[_0x388411]['on'](_0x100e3d(0x2c2),async function(_0x5cdd98){const _0x430e4a=_0x100e3d;if(installingUpdate)return;if(_0x231f0e)return;_0x231f0e=!![],_0x37845a(null);const _0x13de3f=dbConfig['get']('bots')['find']({'botID':_0x388411})['value']();_0x13de3f&&(_0x13de3f['status']==_0x430e4a(0x38c)||_0x13de3f[_0x430e4a(0x24a)]==_0x430e4a(0x2b6))&&(await sleep(0x3e8),updateLive(_0x388411,'stopped'),logger[_0x430e4a(0x2eb)](_0x430e4a(0x2af)+_0x388411),startBot([_0x388411,userID],{'cwd':bbpath},function(_0x2fcb3e){const _0x2a07b6=_0x430e4a;if(_0x2fcb3e)logger[_0x2a07b6(0x2eb)](_0x2fcb3e);}));});}function stopBot(_0x4d60b7){const _0x158c99=_0x1d6a55;getClientsWithBotID(_0x4d60b7)['forEach'](_0x2e5d92=>{const _0x3e7436=_0x4d18;getSocket(_0x2e5d92['id'])[_0x3e7436(0x29a)](!![]),removeClient(_0x2e5d92['id']);}),pid[_0x4d60b7]&&(pid[_0x4d60b7][_0x158c99(0x1ee)](),pid[_0x4d60b7]=null);}function restartBot(_0x1875a5){const _0x397b67=_0x1d6a55;if(pid[_0x1875a5])pid[_0x1875a5][_0x397b67(0x1ee)]();}function addBot(){const _0x318f1d=_0x1d6a55;let _0xde7ab0;for(let _0x2884be=0x1;_0x2884be<0x3e9;_0x2884be++){_0xde7ab0=_0x2884be[_0x318f1d(0x251)]()['padStart'](0x3,'0');let _0x282d04=config[_0x318f1d(0x37e)](_0x44ac22=>_0x44ac22[_0x318f1d(0x1f5)]==_0xde7ab0);if(!_0x282d04)break;}if(_0xde7ab0==='1000'){logger[_0x318f1d(0x2eb)](_0x318f1d(0x360));return;}logger[_0x318f1d(0x2eb)](_0x318f1d(0x211)+_0xde7ab0),dbConfig[_0x318f1d(0x2da)](_0x318f1d(0x2ca))[_0x318f1d(0x37d)]({'botID':_0xde7ab0,'botname':_0x318f1d(0x280)+_0xde7ab0,'status':_0x318f1d(0x2b6),'live':''})['write'](),startBot([_0xde7ab0,userID],{'cwd':bbpath},function(_0x23ecce){if(_0x23ecce)logger['full'](_0x23ecce);}),config=getConfiguration(),io['to'](_0x318f1d(0x323))['emit'](_0x318f1d(0x2ca),config),broadcastToBots(_0x318f1d(0x2ca),JSON[_0x318f1d(0x309)](config));}function deleteBot(_0x24638c){const _0x4961a4=_0x1d6a55;getClientsWithBotID(_0x24638c)[_0x4961a4(0x321)](_0x5555f0=>{const _0x57c869=_0x4961a4;getSocket(_0x5555f0['id'])[_0x57c869(0x29a)](!![]),removeClient(_0x5555f0['id']);}),dbConfig[_0x4961a4(0x2da)]('bots')[_0x4961a4(0x2d8)]({'botID':_0x24638c})[_0x4961a4(0x238)](),logger[_0x4961a4(0x2eb)]('Deleted\x20Bot\x20'+_0x24638c),stopBot(_0x24638c);try{if(fs[_0x4961a4(0x225)](path[_0x4961a4(0x2f7)](configpath,_0x4961a4(0x1c9)+_0x24638c+'-config.json')))fs[_0x4961a4(0x326)](path[_0x4961a4(0x2f7)](configpath,_0x4961a4(0x1c9)+_0x24638c+_0x4961a4(0x246)));if(fs[_0x4961a4(0x225)](path['join'](configpath,_0x4961a4(0x1c9)+_0x24638c+_0x4961a4(0x38b))))fs[_0x4961a4(0x326)](path['join'](configpath,_0x4961a4(0x1c9)+_0x24638c+_0x4961a4(0x38b)));if(fs[_0x4961a4(0x225)](path[_0x4961a4(0x2f7)](configpath,_0x4961a4(0x1c9)+_0x24638c+_0x4961a4(0x23a))))fs[_0x4961a4(0x326)](path[_0x4961a4(0x2f7)](configpath,_0x4961a4(0x1c9)+_0x24638c+_0x4961a4(0x23a)));if(fs[_0x4961a4(0x225)](path['join'](configpath,_0x4961a4(0x1c9)+_0x24638c+_0x4961a4(0x2f0))))fs['unlinkSync'](path[_0x4961a4(0x2f7)](configpath,'bot-'+_0x24638c+_0x4961a4(0x2f0)));}catch(_0x4afd47){if(_0x4afd47)logger['full'](_0x4961a4(0x220),_0x4afd47);}config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots(_0x4961a4(0x2ca),JSON[_0x4961a4(0x309)](config));}function toggleBot(_0x223ef5,_0x32797f,_0x5d38fc){const _0x403ebd=_0x1d6a55;dbConfig[_0x403ebd(0x2da)](_0x403ebd(0x2ca))[_0x403ebd(0x37e)]({'botID':_0x223ef5})[_0x403ebd(0x23b)]({'status':_0x32797f})[_0x403ebd(0x23b)]({'live':_0x5d38fc})['write']();if(_0x32797f==_0x403ebd(0x38c)||_0x32797f==_0x403ebd(0x2b6))logger[_0x403ebd(0x2eb)](_0x403ebd(0x2aa)+_0x223ef5),startBot([_0x223ef5,userID],{'cwd':bbpath},function(_0x211623){if(_0x211623)logger['full'](_0x211623);});else(_0x32797f==_0x403ebd(0x240)||_0x32797f=='new-disabled')&&(logger['full'](_0x403ebd(0x39e)+_0x223ef5),stopBot(_0x223ef5));config=getConfiguration(),io['to'](_0x403ebd(0x323))[_0x403ebd(0x2cb)](_0x403ebd(0x2ca),config),broadcastToBots(_0x403ebd(0x2ca),JSON[_0x403ebd(0x309)](config));}function toggleStatus(_0x284512){const _0x100ec9=_0x1d6a55;let _0x261f17=dbConfig['get'](_0x100ec9(0x2ca))[_0x100ec9(0x37e)]({'botID':_0x284512})[_0x100ec9(0x219)](),_0x4a60da;if(_0x261f17['status']===_0x100ec9(0x38c))_0x4a60da=_0x100ec9(0x240);else{if(_0x261f17[_0x100ec9(0x24a)]==='new')_0x4a60da=_0x100ec9(0x35b);else{if(_0x261f17[_0x100ec9(0x24a)]===_0x100ec9(0x35b))_0x4a60da=_0x100ec9(0x2b6);else{if(_0x261f17[_0x100ec9(0x24a)]===_0x100ec9(0x240))_0x4a60da='enabled';}}}return _0x4a60da;}function updateStatus(_0x11be12,_0x230886){const _0x4fde54=_0x1d6a55;dbConfig[_0x4fde54(0x2da)](_0x4fde54(0x2ca))['find']({'botID':_0x11be12})[_0x4fde54(0x23b)]({'status':_0x230886})[_0x4fde54(0x238)](),config=getConfiguration(),io['to'](_0x4fde54(0x323))['emit'](_0x4fde54(0x2ca),config),broadcastToBots('bots',JSON['stringify'](config));}function updateLive(_0x4262ad,_0x17a69f){const _0x428484=_0x1d6a55;dbConfig[_0x428484(0x2da)]('bots')[_0x428484(0x37e)]({'botID':_0x4262ad})[_0x428484(0x23b)]({'live':_0x17a69f})[_0x428484(0x238)](),config=getConfiguration(),io['to'](_0x428484(0x323))[_0x428484(0x2cb)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotName(_0x29671f,_0x5e4880){const _0x389be6=_0x1d6a55;dbConfig[_0x389be6(0x2da)](_0x389be6(0x2ca))[_0x389be6(0x37e)]({'botID':_0x29671f})[_0x389be6(0x23b)]({'botname':_0x5e4880})[_0x389be6(0x238)](),config=getConfiguration(),io['to']('botmanager')[_0x389be6(0x2cb)]('bots',config),broadcastToBots(_0x389be6(0x2ca),JSON[_0x389be6(0x309)](config));}function updateBotManager(){const _0x1835b2=_0x1d6a55;config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots('bots',JSON[_0x1835b2(0x309)](config));}function toggleBotMode(_0x1e3dc2){const _0x517eb7=_0x1d6a55;if(pid[_0x1e3dc2])pid[_0x1e3dc2][_0x517eb7(0x215)]({'function':_0x517eb7(0x229),'args':null});else{const _0x4f61d4=configpath+'bot-'+_0x1e3dc2+_0x517eb7(0x246),_0xf5b275=fs[_0x517eb7(0x313)](_0x4f61d4),_0x438146=JSON[_0x517eb7(0x1f7)](_0xf5b275),_0x34052b=_0x438146[_0x517eb7(0x301)][0x0][_0x517eb7(0x331)];_0x438146[_0x517eb7(0x301)][0x0][_0x517eb7(0x331)]=!_0x34052b;const _0x5945dc=JSON[_0x517eb7(0x309)](_0x438146,null,0x2);fs[_0x517eb7(0x24d)](_0x4f61d4,_0x5945dc),config=getConfiguration(),io['to'](_0x517eb7(0x323))[_0x517eb7(0x2cb)](_0x517eb7(0x2ca),config),broadcastToBots('bots',JSON['stringify'](config));}}function telegramError(_0x1acb08){const _0x25057f=_0x1d6a55;logger[_0x25057f(0x28e)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x4c468a){const _0x4c833c=_0x1d6a55;if(_0x4c468a['from'][_0x4c833c(0x21c)]!=settings['telegramUsername']&&'@'+_0x4c468a[_0x4c833c(0x1cc)]['username']!=settings[_0x4c833c(0x27f)])return tgBot['sendMessage'](_0x4c468a[_0x4c833c(0x21a)]['id'],_0x4c833c(0x290),{'parse_mode':_0x4c833c(0x298)})[_0x4c833c(0x30c)](_0x1bd168=>{telegramError(_0x1bd168);}),![];return!![];}async function initTelegram(){const _0x4816d3=_0x1d6a55;if(tgBot)tgBot[_0x4816d3(0x2b3)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x4816d3(0x332)],{'polling':!![]});let _0x161d50=_0x4816d3(0x245);_0x161d50+='\x0a',_0x161d50+=_0x4816d3(0x1cd),_0x161d50+=_0x4816d3(0x27e),_0x161d50+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x161d50+=_0x4816d3(0x2a9),_0x161d50+=_0x4816d3(0x254),_0x161d50+=_0x4816d3(0x30f),_0x161d50+=_0x4816d3(0x383),_0x161d50+=_0x4816d3(0x2ee),_0x161d50+=_0x4816d3(0x307),_0x161d50+=_0x4816d3(0x39b),_0x161d50+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x161d50+=_0x4816d3(0x2d9),_0x161d50+=_0x4816d3(0x279),_0x161d50+=_0x4816d3(0x273);let _0x482b06=_0x4816d3(0x373);_0x482b06+='\x0a',_0x482b06+=_0x161d50,tgBot[_0x4816d3(0x20f)](/\/start/,_0x14079b=>{const _0x48afdd=_0x4816d3;if(!validateTelegram(_0x14079b))return;if(settings['telegramChatId']!=_0x14079b[_0x48afdd(0x21a)]['id'])updateSetting('telegramChatId',_0x14079b['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot['sendMessage'](_0x14079b[_0x48afdd(0x21a)]['id'],_0x482b06)[_0x48afdd(0x30c)](_0x13bee3=>{telegramError(_0x13bee3);});}),tgBot[_0x4816d3(0x20f)](/\/enable/,_0xda2c40=>{const _0x56e452=_0x4816d3;if(!validateTelegram(_0xda2c40))return;if(settings[_0x56e452(0x378)]!=_0xda2c40[_0x56e452(0x21a)]['id'])updateSetting(_0x56e452(0x378),_0xda2c40[_0x56e452(0x21a)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x56e452(0x2fc)](_0xda2c40['chat']['id'],_0x56e452(0x260))[_0x56e452(0x30c)](_0x43d381=>{telegramError(_0x43d381);});}),tgBot[_0x4816d3(0x20f)](/\/config/,async _0x4ddc3a=>{const _0x3b1efc=_0x4816d3;if(!validateTelegram(_0x4ddc3a))return;tgBot[_0x3b1efc(0x2fa)]('callback_query'),tgBot[_0x3b1efc(0x2fc)](_0x4ddc3a['chat']['id'],_0x3b1efc(0x25f),{'reply_markup':{'inline_keyboard':[[{'text':_0x3b1efc(0x305),'callback_data':'orders'},{'text':'Alerts','callback_data':_0x3b1efc(0x34c)},{'text':_0x3b1efc(0x2b7),'callback_data':_0x3b1efc(0x318)}]]}})[_0x3b1efc(0x30c)](_0x5cf8d6=>{telegramError(_0x5cf8d6);}),tgBot['on'](_0x3b1efc(0x1b9),async _0x2d73da=>{const _0x4fc0b4=_0x3b1efc,_0x57511a=_0x2d73da[_0x4fc0b4(0x389)],_0x47ae41=_0x2d73da[_0x4fc0b4(0x2a8)];tgBot['answerCallbackQuery'](_0x2d73da['id'])[_0x4fc0b4(0x304)](async()=>{const _0x4302c5=_0x4fc0b4;_0x57511a==_0x4302c5(0x2f3)&&(updateSetting(_0x4302c5(0x2fd),_0x4302c5(0x2f3)),updateSetting(_0x4302c5(0x2fb),!![]),await tgBot[_0x4302c5(0x2fc)](_0x47ae41[_0x4302c5(0x21a)]['id'],_0x4302c5(0x1d9))[_0x4302c5(0x30c)](_0x23d2f1=>{telegramError(_0x23d2f1);}));_0x57511a=='alerts'&&(updateSetting(_0x4302c5(0x2fd),_0x4302c5(0x34c)),updateSetting('telegramEnabled',!![]),await tgBot[_0x4302c5(0x2fc)](_0x47ae41['chat']['id'],_0x4302c5(0x34d))['catch'](_0x1c6be2=>{telegramError(_0x1c6be2);}));_0x57511a=='all'&&(updateSetting('telegramEvents',_0x4302c5(0x318)),updateSetting(_0x4302c5(0x2fb),!![]),await tgBot[_0x4302c5(0x2fc)](_0x47ae41['chat']['id'],_0x4302c5(0x35d))[_0x4302c5(0x30c)](_0x504d38=>{telegramError(_0x504d38);}));if(!settings[_0x4302c5(0x378)])tgBot[_0x4302c5(0x2fc)](_0x47ae41[_0x4302c5(0x21a)]['id'],_0x4302c5(0x287))[_0x4302c5(0x30c)](_0x466767=>{telegramError(_0x466767);});}),tgBot[_0x4fc0b4(0x2fa)](_0x4fc0b4(0x1b9));});}),tgBot[_0x4816d3(0x20f)](/\/status/,_0x47e941=>{const _0x3e0463=_0x4816d3;if(!validateTelegram(_0x47e941))return;const _0x3c4f67=getBotsWithMode();let _0x1b58cd=_0x3e0463(0x2d5);config[_0x3e0463(0x321)](_0x1b94b6=>{const _0x4b76cd=_0x3e0463,_0x547746=_0x3c4f67[_0x4b76cd(0x37e)](_0x1895a5=>_0x1895a5[_0x4b76cd(0x1f5)]==_0x1b94b6[_0x4b76cd(0x1f5)])[_0x4b76cd(0x2bd)];_0x1b58cd+='Bot\x20'+_0x1b94b6['botID']+':\x20'+_0x1b94b6[_0x4b76cd(0x24a)]+_0x4b76cd(0x1dc)+_0x547746+'\x20|\x20'+_0x1b94b6[_0x4b76cd(0x391)]+'\x0a';}),_0x1b58cd+='\x0a',_0x1b58cd+=_0x3e0463(0x316),_0x1b58cd+=!settings[_0x3e0463(0x2fb)]?'Notifications\x20disabled\x0a':_0x3e0463(0x382),_0x1b58cd+=settings[_0x3e0463(0x2fb)]?settings['telegramEvents']==_0x3e0463(0x318)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x3e0463(0x334)+settings[_0x3e0463(0x2fd)]+_0x3e0463(0x2fe):'',tgBot[_0x3e0463(0x2fc)](_0x47e941['chat']['id'],_0x1b58cd,{'parse_mode':_0x3e0463(0x298)})[_0x3e0463(0x30c)](_0x933c8a=>{telegramError(_0x933c8a);});}),tgBot[_0x4816d3(0x20f)](/\/restart/,_0x511243=>{const _0x422f56=_0x4816d3;if(!validateTelegram(_0x511243))return;tgBot[_0x422f56(0x2fa)](_0x422f56(0x1b9));const _0x3f9d10=getEnabledBots();if(_0x3f9d10[_0x422f56(0x1ea)]==0x0)tgBot['sendMessage'](_0x511243[_0x422f56(0x21a)]['id'],_0x422f56(0x243))['catch'](_0x5941b6=>{telegramError(_0x5941b6);});else{if(_0x3f9d10[_0x422f56(0x1ea)]>0x1)_0x3f9d10['push']({'botID':_0x422f56(0x318)});let _0x350ba0=[],_0xb6eae4=[];const _0x220e02=_0x3f9d10[_0x422f56(0x1ea)]%0x4==0x0||_0x3f9d10[_0x422f56(0x1ea)]%0x4==0x3||_0x3f9d10[_0x422f56(0x1ea)]%0x3==0x1?0x4:0x3;let _0x4d4af4=0x0;_0x3f9d10[_0x422f56(0x321)]((_0x367a8c,_0x55d570)=>{const _0x2f51f1=_0x422f56;if(_0x55d570%_0x220e02==0x0)_0xb6eae4=[];_0xb6eae4['push']({'text':_0x367a8c[_0x2f51f1(0x1f5)]==_0x2f51f1(0x318)?_0x2f51f1(0x283):_0x2f51f1(0x280)+_0x367a8c[_0x2f51f1(0x1f5)],'callback_data':_0x367a8c[_0x2f51f1(0x1f5)]}),_0x55d570%_0x220e02==0x0&&(_0x350ba0[_0x4d4af4]=_0xb6eae4,_0x4d4af4++);}),tgBot['sendMessage'](_0x511243['chat']['id'],_0x422f56(0x23d),{'reply_markup':{'inline_keyboard':_0x350ba0}})[_0x422f56(0x30c)](_0x226fc1=>{telegramError(_0x226fc1);}),tgBot['on'](_0x422f56(0x1b9),async _0x355374=>{const _0x2fbb91=_0x422f56,_0x157ab2=_0x355374['data'],_0x573797=_0x355374[_0x2fbb91(0x2a8)];tgBot[_0x2fbb91(0x28d)](_0x355374['id'])[_0x2fbb91(0x304)](async()=>{const _0x3071f5=_0x2fbb91;_0x157ab2==_0x3071f5(0x318)?config['forEach'](_0x12c4f5=>{restartBot(_0x12c4f5['botID']);}):restartBot(_0x157ab2);}),tgBot['removeListener']('callback_query');});}}),tgBot[_0x4816d3(0x20f)](/\/on/,_0x37f09b=>{const _0x3fd84d=_0x4816d3;if(!validateTelegram(_0x37f09b))return;tgBot[_0x3fd84d(0x2fa)](_0x3fd84d(0x1b9));const _0x39cf53=getDisabledBots();if(_0x39cf53['length']==0x0)tgBot[_0x3fd84d(0x2fc)](_0x37f09b[_0x3fd84d(0x21a)]['id'],_0x3fd84d(0x2db))[_0x3fd84d(0x30c)](_0x1e2d0a=>{telegramError(_0x1e2d0a);});else{if(_0x39cf53[_0x3fd84d(0x1ea)]>0x1)_0x39cf53['push']({'botID':_0x3fd84d(0x318)});let _0x2cc4ac=[],_0x1d084d=[];const _0x536a93=_0x39cf53[_0x3fd84d(0x1ea)]%0x4==0x0||_0x39cf53['length']%0x4==0x3||_0x39cf53['length']%0x3==0x1?0x4:0x3;let _0x219f99=0x0;_0x39cf53['forEach']((_0x1a08b8,_0x575b83)=>{const _0x247a44=_0x3fd84d;if(_0x575b83%_0x536a93==0x0)_0x1d084d=[];_0x1d084d[_0x247a44(0x37d)]({'text':_0x1a08b8['botID']==_0x247a44(0x318)?_0x247a44(0x283):_0x247a44(0x280)+_0x1a08b8[_0x247a44(0x1f5)],'callback_data':_0x1a08b8['botID']}),_0x575b83%_0x536a93==0x0&&(_0x2cc4ac[_0x219f99]=_0x1d084d,_0x219f99++);}),tgBot[_0x3fd84d(0x2fc)](_0x37f09b['chat']['id'],_0x3fd84d(0x24b),{'reply_markup':{'inline_keyboard':_0x2cc4ac}})[_0x3fd84d(0x30c)](_0x25c9f0=>{telegramError(_0x25c9f0);}),tgBot['on']('callback_query',async _0x5e57a4=>{const _0x36064d=_0x3fd84d,_0x93bb7f=_0x5e57a4[_0x36064d(0x389)],_0x22290d=_0x5e57a4[_0x36064d(0x2a8)];tgBot[_0x36064d(0x28d)](_0x5e57a4['id'])['then'](async()=>{const _0x3ab8d7=_0x36064d;_0x93bb7f=='all'?(tgBot[_0x3ab8d7(0x2fc)](_0x22290d[_0x3ab8d7(0x21a)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')['catch'](_0x209611=>{telegramError(_0x209611);}),_0x39cf53[_0x3ab8d7(0x321)](_0x53b078=>{const _0x3eb146=_0x3ab8d7;if(_0x53b078['botID']!=_0x3eb146(0x318))toggleBot(_0x53b078['botID'],toggleStatus(_0x53b078[_0x3eb146(0x1f5)]),_0x3eb146(0x1df));})):(tgBot[_0x3ab8d7(0x2fc)](_0x22290d['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x93bb7f)[_0x3ab8d7(0x30c)](_0x29d774=>{telegramError(_0x29d774);}),toggleBot(_0x93bb7f,toggleStatus(_0x93bb7f),'stopped'));}),tgBot[_0x36064d(0x2fa)](_0x36064d(0x1b9));});}}),tgBot['onText'](/\/off/,_0x586a3b=>{const _0x456e9a=_0x4816d3;if(!validateTelegram(_0x586a3b))return;tgBot[_0x456e9a(0x2fa)](_0x456e9a(0x1b9));const _0x58e8c5=getEnabledBots();if(_0x58e8c5[_0x456e9a(0x1ea)]==0x0)tgBot[_0x456e9a(0x2fc)](_0x586a3b['chat']['id'],_0x456e9a(0x243))[_0x456e9a(0x30c)](_0x1125b=>{telegramError(_0x1125b);});else{if(_0x58e8c5[_0x456e9a(0x1ea)]>0x1)_0x58e8c5[_0x456e9a(0x37d)]({'botID':_0x456e9a(0x318)});let _0x1948d1=[],_0x381158=[];const _0x2ef89b=_0x58e8c5['length']%0x4==0x0||_0x58e8c5[_0x456e9a(0x1ea)]%0x4==0x3||_0x58e8c5[_0x456e9a(0x1ea)]%0x3==0x1?0x4:0x3;let _0x2e523d=0x0;_0x58e8c5[_0x456e9a(0x321)]((_0x6402b4,_0x793b14)=>{const _0x147652=_0x456e9a;if(_0x793b14%_0x2ef89b==0x0)_0x381158=[];_0x381158[_0x147652(0x37d)]({'text':_0x6402b4['botID']=='all'?_0x147652(0x283):_0x147652(0x280)+_0x6402b4[_0x147652(0x1f5)],'callback_data':_0x6402b4['botID']}),_0x793b14%_0x2ef89b==0x0&&(_0x1948d1[_0x2e523d]=_0x381158,_0x2e523d++);}),tgBot[_0x456e9a(0x2fc)](_0x586a3b[_0x456e9a(0x21a)]['id'],_0x456e9a(0x2a3),{'reply_markup':{'inline_keyboard':_0x1948d1}})['catch'](_0x10cdea=>{telegramError(_0x10cdea);}),tgBot['on'](_0x456e9a(0x1b9),async _0x26fa89=>{const _0x16fbee=_0x456e9a,_0x2b8d08=_0x26fa89['data'],_0x54f911=_0x26fa89[_0x16fbee(0x2a8)];tgBot[_0x16fbee(0x28d)](_0x26fa89['id'])[_0x16fbee(0x304)](async()=>{const _0x4ae422=_0x16fbee;_0x2b8d08==_0x4ae422(0x318)?(tgBot['sendMessage'](_0x54f911[_0x4ae422(0x21a)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x4ae422(0x30c)](_0x4ae99b=>{telegramError(_0x4ae99b);}),_0x58e8c5[_0x4ae422(0x321)](_0x2a7e4d=>{const _0x27d367=_0x4ae422;if(_0x2a7e4d[_0x27d367(0x1f5)]!=_0x27d367(0x318))toggleBot(_0x2a7e4d[_0x27d367(0x1f5)],toggleStatus(_0x2a7e4d[_0x27d367(0x1f5)]),_0x27d367(0x1df));})):(tgBot['sendMessage'](_0x54f911[_0x4ae422(0x21a)]['id'],_0x4ae422(0x1c1)+_0x2b8d08)['catch'](_0x582947=>{telegramError(_0x582947);}),toggleBot(_0x2b8d08,toggleStatus(_0x2b8d08),_0x4ae422(0x1df)));}),tgBot[_0x16fbee(0x2fa)](_0x16fbee(0x1b9));});}}),tgBot['onText'](/\/metrics/,_0xfbeec9=>{const _0x373a24=_0x4816d3;if(!validateTelegram(_0xfbeec9))return;tgBot[_0x373a24(0x2fa)](_0x373a24(0x1b9));const _0xcb6058=getEnabledBots();if(_0xcb6058[_0x373a24(0x1ea)]==0x0)tgBot['sendMessage'](_0xfbeec9['chat']['id'],_0x373a24(0x243))[_0x373a24(0x30c)](_0x256e13=>{telegramError(_0x256e13);});else{if(_0xcb6058['length']>0x1){let _0x486dd8=[],_0x429e5f=[];const _0x35238e=_0xcb6058[_0x373a24(0x1ea)]%0x4==0x0||_0xcb6058[_0x373a24(0x1ea)]%0x4==0x3||_0xcb6058[_0x373a24(0x1ea)]%0x3==0x1?0x4:0x3;let _0x32f069=0x0;_0xcb6058[_0x373a24(0x321)]((_0x149f95,_0x44ba11)=>{const _0x4a247f=_0x373a24;if(_0x44ba11%_0x35238e==0x0)_0x429e5f=[];_0x429e5f['push']({'text':_0x4a247f(0x280)+_0x149f95['botID'],'callback_data':_0x149f95[_0x4a247f(0x1f5)]}),_0x44ba11%_0x35238e==0x0&&(_0x486dd8[_0x32f069]=_0x429e5f,_0x32f069++);}),tgBot[_0x373a24(0x2fc)](_0xfbeec9[_0x373a24(0x21a)]['id'],_0x373a24(0x2bf),{'reply_markup':{'inline_keyboard':_0x486dd8}})[_0x373a24(0x30c)](_0x5b2072=>{telegramError(_0x5b2072);}),tgBot['on']('callback_query',async _0x35fe80=>{const _0x961056=_0x373a24,_0x2b0459=_0x35fe80[_0x961056(0x389)],_0x3e732f=_0x35fe80[_0x961056(0x2a8)];tgBot[_0x961056(0x28d)](_0x35fe80['id'])['then'](async()=>{const _0x2932e4=_0x961056;if(pid[_0x2b0459])pid[_0x2b0459][_0x2932e4(0x215)]({'function':_0x2932e4(0x272),'args':null});}),tgBot['removeListener']('callback_query');});}else{const _0x21ffcf=_0xcb6058[0x0][_0x373a24(0x1f5)];if(pid[_0x21ffcf])pid[_0x21ffcf]['send']({'function':_0x373a24(0x272),'args':null});}}}),tgBot[_0x4816d3(0x20f)](/\/portfolio/,_0x314b40=>{const _0x360793=_0x4816d3;if(!validateTelegram(_0x314b40))return;tgBot[_0x360793(0x2fa)](_0x360793(0x1b9));const _0x274f19=getEnabledBots();if(_0x274f19[_0x360793(0x1ea)]==0x0)tgBot['sendMessage'](_0x314b40[_0x360793(0x21a)]['id'],_0x360793(0x243))['catch'](_0x111d66=>{telegramError(_0x111d66);});else{if(_0x274f19[_0x360793(0x1ea)]>0x1){let _0x1e7323=[],_0x5534f3=[];const _0x567db8=_0x274f19[_0x360793(0x1ea)]%0x4==0x0||_0x274f19[_0x360793(0x1ea)]%0x4==0x3||_0x274f19['length']%0x3==0x1?0x4:0x3;let _0x47ce43=0x0;_0x274f19[_0x360793(0x321)]((_0x138fe4,_0x565acd)=>{const _0x4495af=_0x360793;if(_0x565acd%_0x567db8==0x0)_0x5534f3=[];_0x5534f3['push']({'text':_0x4495af(0x280)+_0x138fe4[_0x4495af(0x1f5)],'callback_data':_0x138fe4[_0x4495af(0x1f5)]}),_0x565acd%_0x567db8==0x0&&(_0x1e7323[_0x47ce43]=_0x5534f3,_0x47ce43++);}),tgBot[_0x360793(0x2fc)](_0x314b40[_0x360793(0x21a)]['id'],_0x360793(0x244),{'reply_markup':{'inline_keyboard':_0x1e7323}})[_0x360793(0x30c)](_0xd832c7=>{telegramError(_0xd832c7);}),tgBot['on'](_0x360793(0x1b9),async _0x21afb3=>{const _0x494ce1=_0x360793,_0x592578=_0x21afb3[_0x494ce1(0x389)],_0x383b9a=_0x21afb3[_0x494ce1(0x2a8)];tgBot['answerCallbackQuery'](_0x21afb3['id'])[_0x494ce1(0x304)](async()=>{const _0x289078=_0x494ce1;if(pid[_0x592578])pid[_0x592578][_0x289078(0x215)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x494ce1(0x2fa)](_0x494ce1(0x1b9));});}else{const _0x5894ab=_0x274f19[0x0][_0x360793(0x1f5)];if(pid[_0x5894ab])pid[_0x5894ab][_0x360793(0x215)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x4816d3(0x20f)](/\/update/,async _0x38807c=>{const _0x561808=_0x4816d3;if(!validateTelegram(_0x38807c))return;tgBot['removeListener'](_0x561808(0x1b9)),await getMessages();if(!updateAvailable)tgBot[_0x561808(0x2fc)](_0x38807c[_0x561808(0x21a)]['id'],_0x561808(0x344))[_0x561808(0x30c)](_0x511d3a=>{telegramError(_0x511d3a);});else!validInstallation?tgBot['sendMessage'](_0x38807c['chat']['id'],_0x561808(0x1f4))['catch'](_0x384ed8=>{telegramError(_0x384ed8);}):(tgBot[_0x561808(0x2fc)](_0x38807c['chat']['id'],_0x561808(0x369),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x561808(0x2f6)},{'text':'No','callback_data':'no'}]]}})[_0x561808(0x30c)](_0x51d976=>{telegramError(_0x51d976);}),tgBot['on'](_0x561808(0x1b9),async _0x4586df=>{const _0x5e812b=_0x561808,_0x5965e8=_0x4586df[_0x5e812b(0x389)],_0x324717=_0x4586df['message'];tgBot[_0x5e812b(0x28d)](_0x4586df['id'])['then'](async()=>{const _0x1d7654=_0x5e812b;_0x5965e8==_0x1d7654(0x2f6)&&(await tgBot['sendMessage'](_0x324717['chat']['id'],_0x1d7654(0x285))[_0x1d7654(0x30c)](_0x35779c=>{telegramError(_0x35779c);}),updateBB(_0x1d7654(0x292))),_0x5965e8=='no'&&await tgBot[_0x1d7654(0x2fc)](_0x324717[_0x1d7654(0x21a)]['id'],_0x1d7654(0x2ce))['catch'](_0x2db20e=>{telegramError(_0x2db20e);});}),tgBot[_0x5e812b(0x2fa)](_0x5e812b(0x1b9));}));}),tgBot[_0x4816d3(0x20f)](/\/reinstall/,async _0x371669=>{const _0x54035d=_0x4816d3;if(!validateTelegram(_0x371669))return;tgBot[_0x54035d(0x2fa)]('callback_query'),!validInstallation?tgBot[_0x54035d(0x2fc)](_0x371669[_0x54035d(0x21a)]['id'],_0x54035d(0x2ff))[_0x54035d(0x30c)](_0x3e5bd3=>{telegramError(_0x3e5bd3);}):(tgBot[_0x54035d(0x2fc)](_0x371669[_0x54035d(0x21a)]['id'],_0x54035d(0x32b),{'reply_markup':{'inline_keyboard':[[{'text':_0x54035d(0x371),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})['catch'](_0x43d0eb=>{telegramError(_0x43d0eb);}),tgBot['on'](_0x54035d(0x1b9),async _0x9d0c83=>{const _0x57765c=_0x54035d,_0x24cc72=_0x9d0c83[_0x57765c(0x389)],_0x5c6a76=_0x9d0c83[_0x57765c(0x2a8)];tgBot[_0x57765c(0x28d)](_0x9d0c83['id'])[_0x57765c(0x304)](async()=>{const _0x3af0cb=_0x57765c;_0x24cc72=='yes'&&(await tgBot[_0x3af0cb(0x2fc)](_0x5c6a76[_0x3af0cb(0x21a)]['id'],_0x3af0cb(0x28b))[_0x3af0cb(0x30c)](_0x158c10=>{telegramError(_0x158c10);}),updateBB(_0x3af0cb(0x364))),_0x24cc72=='no'&&await tgBot[_0x3af0cb(0x2fc)](_0x5c6a76[_0x3af0cb(0x21a)]['id'],_0x3af0cb(0x210))[_0x3af0cb(0x30c)](_0x1b229d=>{telegramError(_0x1b229d);});}),tgBot[_0x57765c(0x2fa)]('callback_query');}));}),tgBot['onText'](/\/toggle/,_0x2c8590=>{const _0x286290=_0x4816d3;if(!validateTelegram(_0x2c8590))return;tgBot[_0x286290(0x2fa)](_0x286290(0x1b9));const _0x5ad550=getBotsWithMode();if(_0x5ad550['length']==0x0)tgBot[_0x286290(0x2fc)](_0x2c8590['chat']['id'],_0x286290(0x243))['catch'](_0x522cf7=>{telegramError(_0x522cf7);});else{let _0x2d5d58=[],_0x56b524=[];const _0x5c81c0=0x2;let _0xc213a0=0x0;_0x5ad550[_0x286290(0x321)]((_0x9721ca,_0x21b63a)=>{const _0x5c325d=_0x286290;if(_0x21b63a%_0x5c81c0==0x0)_0x56b524=[];_0x56b524[_0x5c325d(0x37d)]({'text':_0x5c325d(0x280)+_0x9721ca['botID']+'\x20('+_0x9721ca[_0x5c325d(0x2bd)]+')','callback_data':_0x9721ca['botID']}),_0x21b63a%_0x5c81c0==0x0&&(_0x2d5d58[_0xc213a0]=_0x56b524,_0xc213a0++);}),tgBot[_0x286290(0x2fc)](_0x2c8590[_0x286290(0x21a)]['id'],_0x286290(0x253),{'reply_markup':{'inline_keyboard':_0x2d5d58}})[_0x286290(0x30c)](_0x4d38a1=>{telegramError(_0x4d38a1);}),tgBot['on']('callback_query',async _0x3869f0=>{const _0x333f5e=_0x286290,_0x327cd0=_0x3869f0[_0x333f5e(0x389)],_0xb43467=_0x3869f0[_0x333f5e(0x2a8)];tgBot['answerCallbackQuery'](_0x3869f0['id'])[_0x333f5e(0x304)](async()=>{const _0x262fbd=_0x333f5e,_0x10c81e=_0x5ad550['find'](_0x50d35f=>_0x50d35f['botID']==_0x327cd0),_0x54ba5a=_0x10c81e[_0x262fbd(0x2bd)]==_0x262fbd(0x1be)?_0x262fbd(0x333):_0x262fbd(0x1be);tgBot[_0x262fbd(0x2fc)](_0xb43467['chat']['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x327cd0+_0x262fbd(0x2ba)+_0x54ba5a+'\x20mode')['catch'](_0x3d1539=>{telegramError(_0x3d1539);}),toggleBotMode(_0x327cd0);}),tgBot['removeListener'](_0x333f5e(0x1b9));});}}),tgBot['onText'](/\/names/,_0x39be25=>{const _0x538737=_0x4816d3;if(!validateTelegram(_0x39be25))return;let _0x14f1c9='';config[_0x538737(0x321)](_0x47b121=>{const _0x4a0fc9=_0x538737;_0x14f1c9+=_0x4a0fc9(0x280)+_0x47b121['botID']+':\x20'+_0x47b121[_0x4a0fc9(0x2a5)]+'\x0a';}),tgBot[_0x538737(0x2fc)](_0x39be25[_0x538737(0x21a)]['id'],_0x14f1c9,{'parse_mode':_0x538737(0x298)})[_0x538737(0x30c)](_0x25378d=>{telegramError(_0x25378d);});}),tgBot[_0x4816d3(0x20f)](/\/disable/,_0x1bed37=>{const _0x59befc=_0x4816d3;if(!validateTelegram(_0x1bed37))return;tgBot[_0x59befc(0x2fc)](_0x1bed37[_0x59befc(0x21a)]['id'],_0x59befc(0x1e1))[_0x59befc(0x30c)](_0x2a8e7a=>{telegramError(_0x2a8e7a);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x4816d3(0x20f)](/\/help/,_0x47bb18=>{const _0x51bd64=_0x4816d3;if(!validateTelegram(_0x47bb18))return;tgBot[_0x51bd64(0x2fc)](_0x47bb18[_0x51bd64(0x21a)]['id'],_0x161d50)[_0x51bd64(0x30c)](_0x23011b=>{telegramError(_0x23011b);});}),tgBot['on']('polling_error',_0x248051=>{const _0x212300=_0x4816d3;_0x248051[_0x212300(0x251)]()['includes'](_0x212300(0x366))&&(logger[_0x212300(0x2eb)]('Invalid\x20Telegram\x20token'),tgBot[_0x212300(0x2b3)](),tgBot=null,io['to'](_0x212300(0x323))['emit'](_0x212300(0x33e),'Invalid\x20Telegram\x20token'));}),process[_0x4816d3(0x2f9)](_0x4816d3(0x375),()=>{const _0x1c0344=_0x4816d3;if(tgBot)tgBot[_0x1c0344(0x2b3)]();process[_0x1c0344(0x2c2)](0x1);}),process['once'](_0x4816d3(0x377),()=>{const _0x9e7c3e=_0x4816d3;if(tgBot)tgBot['stopPolling']();process[_0x9e7c3e(0x2c2)](0x1);});}}function disableTelegram(){const _0xbc496f=_0x1d6a55;tgBot&&(tgBot[_0xbc496f(0x2b3)](),tgBot=null);}function sendTelegram(_0x2d32a6,_0x1079be){const _0x51c30b=_0x1d6a55;if(settings[_0x51c30b(0x2fb)]){if(settings[_0x51c30b(0x2fd)]=='all'||(_0x1079be[_0x51c30b(0x1fc)]==_0x51c30b(0x26c)||_0x1079be[_0x51c30b(0x1fc)]=='warning'||_0x1079be[_0x51c30b(0x1fc)]==_0x51c30b(0x274))&&settings[_0x51c30b(0x2fd)]=='alerts'||_0x1079be['type']==_0x51c30b(0x384)&&settings[_0x51c30b(0x2fd)]==_0x51c30b(0x2f3)){if(tgBot&&settings[_0x51c30b(0x378)]){if(_0x1079be['showname'])tgBot[_0x51c30b(0x2fc)](settings[_0x51c30b(0x378)],_0x1079be[_0x51c30b(0x2a5)]+_0x51c30b(0x1c2)+_0x1079be[_0x51c30b(0x2d4)])['catch'](_0x41a152=>{telegramError(_0x41a152);});else tgBot[_0x51c30b(0x2fc)](settings[_0x51c30b(0x378)],_0x51c30b(0x280)+_0x2d32a6+_0x51c30b(0x1c2)+_0x1079be['event'])[_0x51c30b(0x30c)](_0x101805=>{telegramError(_0x101805);});}}}}async function sendTelegramMsg(_0x6784aa,_0xc0d1aa='HTML'){const _0xe584ef=_0x1d6a55;return settings[_0xe584ef(0x2fb)]&&tgBot&&settings[_0xe584ef(0x378)]?(await tgBot[_0xe584ef(0x2fc)](settings['telegramChatId'],_0x6784aa,{'parse_mode':_0xc0d1aa})[_0xe584ef(0x30c)](_0x5d8c90=>{telegramError(_0x5d8c90);}),!![]):![];}function getDeviceWithIp(_0xa1adce){const _0x3731aa=_0x1d6a55;return devices[_0x3731aa(0x37e)](_0x2151a5=>_0x2151a5['ip']===_0xa1adce);}function temporaryAccess2FA(_0x10f898,_0x15da87){const _0x29c6a1=_0x1d6a55;let _0xb73d43=new Date(),_0x8c2551=![];if(lastIpApproval){if(_0xb73d43-lastIpApproval<0x1388)_0x8c2551=!![];}lastIpApproval=new Date();if(_0x8c2551)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x29c6a1(0x2fa)](_0x29c6a1(0x1b9)),tgBot[_0x29c6a1(0x2fc)](settings[_0x29c6a1(0x378)],_0x29c6a1(0x2d2)+normalizeIP(_0x15da87)[_0x29c6a1(0x338)]+_0x29c6a1(0x34f),{'parse_mode':_0x29c6a1(0x298),'reply_markup':{'inline_keyboard':[[{'text':_0x29c6a1(0x2d3),'callback_data':'5'},{'text':_0x29c6a1(0x2d1),'callback_data':'15'},{'text':_0x29c6a1(0x1d7),'callback_data':'30'},{'text':_0x29c6a1(0x300),'callback_data':_0x29c6a1(0x300)}]]}})[_0x29c6a1(0x30c)](_0x5680e9=>{telegramError(_0x5680e9);}),tgBot['on'](_0x29c6a1(0x1b9),async _0x269386=>{const _0x302f72=_0x29c6a1,_0x59ab3d=_0x269386[_0x302f72(0x389)],_0x97d206=_0x269386['message'];tgBot[_0x302f72(0x28d)](_0x269386['id'])['then'](async()=>{const _0x4991ce=_0x302f72;devices[_0x10f898]['telegramIpApproval']={'clientip':_0x15da87,'timestamp':new Date()['getTime'](),'expiry':_0x59ab3d},_0x59ab3d!=_0x4991ce(0x300)?(await tgBot[_0x4991ce(0x2fc)](_0x97d206[_0x4991ce(0x21a)]['id'],'Access\x20enabled\x20for\x20'+_0x59ab3d+_0x4991ce(0x37b),{'parse_mode':_0x4991ce(0x298)})['catch'](_0x495edf=>{telegramError(_0x495edf);}),io['to'](_0x10f898)[_0x4991ce(0x2cb)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x4991ce(0x2fc)](_0x97d206[_0x4991ce(0x21a)]['id'],_0x4991ce(0x263))['catch'](_0x50ae9f=>{telegramError(_0x50ae9f);}),io['to'](_0x10f898)['emit'](_0x4991ce(0x24a),{'access':{'allow':![],'reason':_0x4991ce(0x361),'token':null}}));}),tgBot[_0x302f72(0x2fa)](_0x302f72(0x1b9));}));}function loginAccess2FA(_0x319369,_0xf1d62a){const _0x2ccc8=_0x1d6a55;tgBot&&settings[_0x2ccc8(0x378)]&&(tgBot[_0x2ccc8(0x2fa)](_0x2ccc8(0x1b9)),tgBot[_0x2ccc8(0x2fc)](settings[_0x2ccc8(0x378)],_0x2ccc8(0x271)+normalizeIP(_0xf1d62a)[_0x2ccc8(0x338)]+_0x2ccc8(0x34f),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x2ccc8(0x30e),'callback_data':loginExpiry},{'text':_0x2ccc8(0x300),'callback_data':_0x2ccc8(0x300)}]]}})[_0x2ccc8(0x30c)](_0xece4b3=>{telegramError(_0xece4b3);}),tgBot['on']('callback_query',async _0xbe6048=>{const _0x3ac2a5=_0x2ccc8,_0x44c9bc=_0xbe6048['data'],_0x4e2b26=_0xbe6048[_0x3ac2a5(0x2a8)];tgBot['answerCallbackQuery'](_0xbe6048['id'])[_0x3ac2a5(0x304)](async()=>{const _0x163029=_0x3ac2a5;devices[_0x319369][_0x163029(0x204)]={'clientip':_0xf1d62a,'timestamp':new Date()[_0x163029(0x203)](),'expiry':_0x44c9bc},_0x44c9bc!='reject'?(await tgBot['sendMessage'](_0x4e2b26['chat']['id'],_0x163029(0x36d),{'parse_mode':'HTML'})[_0x163029(0x30c)](_0x4b0da9=>{telegramError(_0x4b0da9);}),io['to'](_0x319369)[_0x163029(0x2cb)](_0x163029(0x24a),{'access':{'allow':![],'reason':_0x163029(0x249),'token':null}})):(await tgBot[_0x163029(0x2fc)](_0x4e2b26[_0x163029(0x21a)]['id'],_0x163029(0x29c))[_0x163029(0x30c)](_0x2c35ae=>{telegramError(_0x2c35ae);}),io['to'](_0x319369)['emit'](_0x163029(0x24a),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot['removeListener'](_0x3ac2a5(0x1b9));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x13ea76=_0x1d6a55;return dbConfig[_0x13ea76(0x2da)](_0x13ea76(0x2ca))[_0x13ea76(0x20c)]('botID')[_0x13ea76(0x2e7)]({'status':_0x13ea76(0x38c)})[_0x13ea76(0x219)]()||[];}function getDisabledBots(){const _0x51ea7b=_0x1d6a55;return dbConfig['get'](_0x51ea7b(0x2ca))[_0x51ea7b(0x20c)](_0x51ea7b(0x1f5))[_0x51ea7b(0x2e7)]({'status':_0x51ea7b(0x240)})['value']()||[];}function getBotAttributes(_0x2c704f){const _0x52af56=_0x1d6a55;let _0x44a68b={};const _0x505730=configpath+_0x52af56(0x1c9)+_0x2c704f+_0x52af56(0x246),_0x33436f=fs['existsSync'](_0x505730);if(_0x33436f){const _0x368929=fs['readFileSync'](_0x505730);try{const _0x42243f=JSON[_0x52af56(0x1f7)](_0x368929),_0x1003d5=_0x42243f?_0x42243f['bot'][0x0][_0x52af56(0x331)]:![];_0x44a68b['mode']=_0x1003d5?'auto':_0x52af56(0x333),_0x44a68b[_0x52af56(0x2a5)]=_0x42243f?_0x42243f[_0x52af56(0x301)][0x0][_0x52af56(0x2a5)]:_0x52af56(0x280)+_0x2c704f;}catch(_0x2e91bd){_0x44a68b[_0x52af56(0x2bd)]='manual',_0x44a68b['botname']=_0x52af56(0x280)+_0x2c704f;}}else _0x44a68b[_0x52af56(0x2bd)]=_0x52af56(0x333),_0x44a68b[_0x52af56(0x2a5)]=_0x52af56(0x280)+_0x2c704f;return _0x44a68b;}function getBotsWithMode(){const _0x16adbc=_0x1d6a55,_0x5bc20d=dbConfig['get'](_0x16adbc(0x2ca))[_0x16adbc(0x20c)](_0x16adbc(0x1f5))[_0x16adbc(0x219)]()||[];return _0x5bc20d[_0x16adbc(0x321)](_0x43f647=>{const _0x52388e=_0x16adbc;let _0x4be72c=getBotAttributes(_0x43f647[_0x52388e(0x1f5)]);_0x43f647[_0x52388e(0x2bd)]=_0x4be72c[_0x52388e(0x2bd)];}),_0x5bc20d;}function getBotExchanges(){const _0x372a43=_0x1d6a55;let _0x466a80=[];const _0x24e2ed=dbConfig[_0x372a43(0x2da)](_0x372a43(0x2ca))[_0x372a43(0x20c)](_0x372a43(0x1f5))[_0x372a43(0x219)]()||[];_0x24e2ed[_0x372a43(0x321)](_0xa7c712=>{const _0x15a571=_0x372a43;if(_0xa7c712[_0x15a571(0x24a)]=='enabled'){const _0x177e6a=configpath+_0x15a571(0x1c9)+_0xa7c712['botID']+_0x15a571(0x246),_0x31281f=fs[_0x15a571(0x225)](_0x177e6a);let _0x556ca4;if(_0x31281f){const _0x5e1b5e=fs['readFileSync'](_0x177e6a);try{const _0x5552e0=JSON[_0x15a571(0x1f7)](_0x5e1b5e);_0x556ca4=_0x5552e0?_0x5552e0[_0x15a571(0x301)][0x0][_0x15a571(0x27c)]:null;}catch(_0x367b1e){}}if(_0x556ca4)_0x466a80[_0x15a571(0x37d)](_0x556ca4);}});const _0x554876=[...new Set(_0x466a80)][_0x372a43(0x320)]();return _0x554876;}async function initUser(){const _0x7cf13e=_0x1d6a55;if(!settings['userid']){const _0x28b4c5=uuidRandom();mixpanel[_0x7cf13e(0x329)](_0x28b4c5),updateSetting(_0x7cf13e(0x1fe),_0x28b4c5);}}async function initSecure(){const _0x2a77cf=_0x1d6a55;let _0x3d88aa=getSecure();if(!_0x3d88aa[_0x2a77cf(0x228)](_0x2a77cf(0x30b))){let _0xd9348d=await generateKeys();_0x3d88aa[_0x2a77cf(0x2df)]=_0xd9348d['publicKey'],_0x3d88aa[_0x2a77cf(0x35f)]=_0xd9348d[_0x2a77cf(0x35f)],_0x3d88aa[_0x2a77cf(0x30b)]=crypto[_0x2a77cf(0x265)](0x20)[_0x2a77cf(0x251)](_0x2a77cf(0x1e6));;storeSecure(_0x3d88aa);}}function getSettings(){const _0x57a9c7=_0x1d6a55;return dbSettings[_0x57a9c7(0x2da)]('settings')[_0x57a9c7(0x219)]()||{};}function getSecure(){const _0x156c0f=_0x1d6a55;return dbSecure[_0x156c0f(0x2da)](_0x156c0f(0x231))['value']()||{};}function getBlacklist(){const _0x3713db=_0x1d6a55;return dbSecure['get'](_0x3713db(0x27d))[_0x3713db(0x219)]()||[];}function broadcastToBots(_0x4fafe1,_0x12ea14){const _0x8398cc=_0x1d6a55;config[_0x8398cc(0x321)](_0x2b1aa4=>{const _0x5887ab=_0x8398cc;if(_0x2b1aa4[_0x5887ab(0x24a)]==_0x5887ab(0x38c)&&_0x2b1aa4[_0x5887ab(0x391)]==_0x5887ab(0x297)||_0x2b1aa4['status']=='new'&&_0x2b1aa4[_0x5887ab(0x391)]=='running'){if(pid[_0x2b1aa4[_0x5887ab(0x1f5)]])pid[_0x2b1aa4[_0x5887ab(0x1f5)]]['send']({[_0x4fafe1]:_0x12ea14});}});}function storeSettings(_0x1d26d7,_0x3c548b=![]){const _0x58f41e=_0x1d6a55;_0x1d26d7={...settings,..._0x1d26d7};if(_0x3c548b&&_0x1d26d7['bbPassword']!='************'&&_0x1d26d7[_0x58f41e(0x2ef)]!=_0x58f41e(0x359)&&_0x1d26d7[_0x58f41e(0x2ef)]!=''){const _0x33fe39=crypt[_0x58f41e(0x2e2)](secure[_0x58f41e(0x35f)],_0x1d26d7[_0x58f41e(0x2ef)])['message'][_0x58f41e(0x379)]('@')[0x0],_0xb774e4=bcrypt[_0x58f41e(0x36c)](_0x33fe39,saltRounds);_0x1d26d7={..._0x1d26d7,'bbPassword':_0xb774e4};}if(_0x3c548b&&_0x1d26d7['telegramToken']!=_0x58f41e(0x306)&&_0x1d26d7[_0x58f41e(0x332)]!=_0x58f41e(0x359)&&_0x1d26d7[_0x58f41e(0x332)]!=''){const _0x34f18a=crypt['decrypt'](secure[_0x58f41e(0x35f)],_0x1d26d7['telegramToken'])[_0x58f41e(0x2a8)][_0x58f41e(0x379)]('@')[0x0];_0x1d26d7={..._0x1d26d7,'telegramToken':_0x34f18a};}const _0x123f80=_0x1d26d7[_0x58f41e(0x332)]!=_0x58f41e(0x306)&&_0x1d26d7[_0x58f41e(0x332)]!=settings[_0x58f41e(0x332)]||_0x1d26d7[_0x58f41e(0x27f)]!=settings[_0x58f41e(0x27f)],_0xb25145=_0x1d26d7[_0x58f41e(0x332)]==''||_0x1d26d7[_0x58f41e(0x27f)]=='';if(_0x123f80)_0x1d26d7['telegramEvents']='all';for(const [_0x41804a,_0x411bbf]of Object[_0x58f41e(0x396)](_0x1d26d7)){if(_0x41804a==_0x58f41e(0x332)&&_0x411bbf==_0x58f41e(0x306)){_0x1d26d7[_0x58f41e(0x332)]=settings[_0x58f41e(0x332)];continue;};if(_0x41804a=='bbPassword'&&_0x411bbf==_0x58f41e(0x306)){_0x1d26d7[_0x58f41e(0x2ef)]=settings[_0x58f41e(0x2ef)];continue;};dbSettings[_0x58f41e(0x381)](_0x58f41e(0x372)+_0x41804a,_0x411bbf)[_0x58f41e(0x238)]();}settings=_0x1d26d7,io['to'](_0x58f41e(0x323))['emit'](_0x58f41e(0x259),cleanSettings()),broadcastToBots(_0x58f41e(0x257),settings[_0x58f41e(0x257)]),broadcastToBots(_0x58f41e(0x33c),settings[_0x58f41e(0x33c)]);if(_0x123f80&&!_0xb25145)initTelegram();if(_0x123f80&&_0xb25145)disableTelegram();getAllClients()['forEach'](_0x238c64=>{const _0x1883a8=_0x58f41e;getSocket(_0x238c64['id'])[_0x1883a8(0x2cb)](_0x1883a8(0x24a),{'access':{'allow':![],'reason':_0x1883a8(0x249),'token':null}});});}function updateSetting(_0x547da5,_0x561a6a){const _0x9839d1=_0x1d6a55;dbSettings[_0x9839d1(0x381)](_0x9839d1(0x372)+_0x547da5,_0x561a6a)[_0x9839d1(0x238)](),settings=getSettings(),io['to'](_0x9839d1(0x323))[_0x9839d1(0x2cb)](_0x9839d1(0x259),cleanSettings());}function storeSecure(_0x36f97d){const _0x5eca53=_0x1d6a55;dbSecure[_0x5eca53(0x2da)](_0x5eca53(0x231))['push'](_0x36f97d)[_0x5eca53(0x238)](),secure=_0x36f97d;}function addBlacklist(_0x169d55){const _0x2a0c0a=_0x1d6a55;cleanBlacklist();let _0x4255d8;devices[_0x169d55][_0x2a0c0a(0x353)]?_0x4255d8=Math[_0x2a0c0a(0x2ec)](devices[_0x169d55][_0x2a0c0a(0x353)][_0x2a0c0a(0x32e)],loginExpiry):_0x4255d8=loginExpiry,dbSecure[_0x2a0c0a(0x2da)](_0x2a0c0a(0x27d))[_0x2a0c0a(0x37d)]({'expiry':new Date()['getTime']()+_0x4255d8*0x3c*0x3e8,'token':devices[_0x169d55][_0x2a0c0a(0x385)]['token']})[_0x2a0c0a(0x238)](),blacklist=dbSecure['get'](_0x2a0c0a(0x27d))[_0x2a0c0a(0x219)]();}function cleanBlacklist(){const _0x373148=_0x1d6a55;let _0x370bef=dbSecure[_0x373148(0x2da)](_0x373148(0x27d))[_0x373148(0x25c)]()['value'](),_0x51d7ba=new Date()[_0x373148(0x203)]();_0x370bef[_0x373148(0x321)](_0x2792cd=>{const _0x11e2c1=_0x373148;_0x2792cd['expiry']<_0x51d7ba&&dbSecure[_0x11e2c1(0x2da)](_0x11e2c1(0x27d))[_0x11e2c1(0x2d8)]({'expiry':_0x2792cd[_0x11e2c1(0x32e)]})[_0x11e2c1(0x238)]();});}function initStates(){const _0x46e3f8=_0x1d6a55;let _0x469055=getConfiguration();_0x469055[_0x46e3f8(0x321)](_0x20c364=>{const _0x22d4fb=_0x46e3f8;_0x20c364[_0x22d4fb(0x391)]=_0x22d4fb(0x1df);}),storeConfiguration(_0x469055);}function _0x4d18(_0x1b77ff,_0x53a967){const _0x1f56b8=_0x5b6e();return _0x4d18=function(_0x46bd18,_0x52265b){_0x46bd18=_0x46bd18-0x1b9;let _0x5b6ec7=_0x1f56b8[_0x46bd18];return _0x5b6ec7;},_0x4d18(_0x1b77ff,_0x53a967);}function onKeys(){const _0x488543=new RSA();return new Promise(_0x457843=>{const _0x515e8d=_0x4d18;_0x488543[_0x515e8d(0x1c0)]()[_0x515e8d(0x304)](_0x22844d=>{_0x457843(_0x22844d);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x150ca2=_0x1d6a55;let _0xb35fe6=getSettings(),_0x1b8183=![];!_0xb35fe6[_0x150ca2(0x228)](_0x150ca2(0x1d3))&&(_0xb35fe6[_0x150ca2(0x1d3)]=0x0,_0x1b8183=!![]);!_0xb35fe6[_0x150ca2(0x228)]('lastmsgemitted')&&(_0xb35fe6['lastmsgemitted']=0x0,_0x1b8183=!![]);!_0xb35fe6[_0x150ca2(0x228)]('latestversion')&&(_0xb35fe6[_0x150ca2(0x30d)]=_0x150ca2(0x2c0),_0x1b8183=!![]);!_0xb35fe6[_0x150ca2(0x228)](_0x150ca2(0x33c))&&(_0xb35fe6[_0x150ca2(0x33c)]=![],_0x1b8183=!![]);if(_0x1b8183)storeSettings(_0xb35fe6);try{fs[_0x150ca2(0x258)](configbackuppath,{'withFileTypes':!![]})[_0x150ca2(0x321)](_0x44fa61=>{const _0x18cfdb=_0x150ca2;if(!_0x44fa61[_0x18cfdb(0x2f8)]()){if(!_0x44fa61['name'][_0x18cfdb(0x2cc)]('backup-full@'))fs['unlinkSync'](configbackuppath+_0x44fa61[_0x18cfdb(0x1ba)]);}else fs['rmSync'](configbackuppath+_0x44fa61['name'],{'recursive':!![]});});}catch(_0x532a46){logger[_0x150ca2(0x2ad)](_0x150ca2(0x1fd),_0x532a46);}}function storeConfiguration(_0x2dc97d){const _0x558703=_0x1d6a55;dbConfig[_0x558703(0x2da)](_0x558703(0x2ca))[_0x558703(0x2d8)]()[_0x558703(0x238)](),_0x2dc97d[_0x558703(0x321)](_0x422c81=>{delete _0x422c81['mode'];}),dbConfig[_0x558703(0x2da)](_0x558703(0x2ca))[_0x558703(0x37d)](..._0x2dc97d)['write'](),config=_0x2dc97d;}function resetPassword(){const _0x497ba9=_0x1d6a55;tgBot&&settings['telegramChatId']&&(tgBot[_0x497ba9(0x2fa)](_0x497ba9(0x1b9)),tgBot['sendMessage'](settings[_0x497ba9(0x378)],_0x497ba9(0x3a0),{'parse_mode':_0x497ba9(0x298),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x497ba9(0x2f6)},{'text':'no','callback_data':'no'}]]}})[_0x497ba9(0x30c)](_0x3c950b=>{telegramError(_0x3c950b);}),tgBot['on'](_0x497ba9(0x1b9),async _0x4bedcd=>{const _0x307d50=_0x497ba9,_0x15a776=_0x4bedcd[_0x307d50(0x389)],_0x34a321=_0x4bedcd[_0x307d50(0x2a8)];tgBot['answerCallbackQuery'](_0x4bedcd['id'])[_0x307d50(0x304)](async()=>{const _0x529b0d=_0x307d50;if(_0x15a776!='no'){const _0x4cb097=0xf,_0x3a03d4=_0x529b0d(0x289),_0x560490=Array[_0x529b0d(0x1cc)](crypto[_0x529b0d(0x2ac)](new Uint32Array(_0x4cb097)))[_0x529b0d(0x1ce)](_0x7a2a4c=>_0x3a03d4[_0x7a2a4c%_0x3a03d4['length']])[_0x529b0d(0x2f7)](''),_0x30e41b=bcrypt[_0x529b0d(0x36c)](_0x560490,saltRounds);storeSettings({'bbPassword':_0x30e41b}),await tgBot[_0x529b0d(0x2fc)](_0x34a321[_0x529b0d(0x21a)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x560490,{'parse_mode':_0x529b0d(0x298)})[_0x529b0d(0x30c)](_0x55dde4=>{telegramError(_0x55dde4);});}else await tgBot['sendMessage'](_0x34a321[_0x529b0d(0x21a)]['id'],'Password\x20reset\x20rejected')['catch'](_0x47dc21=>{telegramError(_0x47dc21);});}),tgBot[_0x307d50(0x2fa)]('callback_query');}));}async function confirmRestore(_0x476472,_0x3f0014){const _0xfb4b30=_0x1d6a55;io['to']('botmanager')[_0xfb4b30(0x2cb)]('notification',_0xfb4b30(0x337),'success'),tgBot&&settings[_0xfb4b30(0x378)]&&(tgBot[_0xfb4b30(0x2fa)](_0xfb4b30(0x1b9)),await tgBot[_0xfb4b30(0x2fc)](settings[_0xfb4b30(0x378)],_0xfb4b30(0x291),{'parse_mode':_0xfb4b30(0x298),'reply_markup':{'inline_keyboard':[[{'text':_0xfb4b30(0x2f6),'callback_data':_0xfb4b30(0x2f6)},{'text':'no','callback_data':'no'}]]}})[_0xfb4b30(0x30c)](_0x55756d=>{telegramError(_0x55756d);}),tgBot['on'](_0xfb4b30(0x1b9),async _0x3cdc2c=>{const _0x597368=_0xfb4b30,_0x282aaf=_0x3cdc2c[_0x597368(0x389)],_0x2687c8=_0x3cdc2c[_0x597368(0x2a8)];tgBot[_0x597368(0x28d)](_0x3cdc2c['id'])['then'](async()=>{const _0x233890=_0x597368;_0x282aaf==_0x233890(0x2f6)?(await tgBot[_0x233890(0x2fc)](_0x2687c8[_0x233890(0x21a)]['id'],_0x233890(0x209),{'parse_mode':_0x233890(0x298)})[_0x233890(0x30c)](_0x10ac64=>{telegramError(_0x10ac64);}),unzipFile(_0x476472,_0x3f0014)):(logger[_0x233890(0x2ad)]('Restore\x20process\x20aborted'),await tgBot['sendMessage'](_0x2687c8['chat']['id'],_0x233890(0x397))[_0x233890(0x30c)](_0x540a74=>{telegramError(_0x540a74);}));}),tgBot['removeListener'](_0x597368(0x1b9));}));}function getServerTime(){const _0x29655e=_0x1d6a55,_0x22f370=new Date();return _0x22f370[_0x29655e(0x2ae)]()+'/'+(_0x22f370[_0x29655e(0x351)]()+0x1)[_0x29655e(0x251)]()[_0x29655e(0x205)](0x2,'0')+'/'+_0x22f370[_0x29655e(0x299)]()['toString']()[_0x29655e(0x205)](0x2,'0')+'\x20'+_0x22f370[_0x29655e(0x247)]()[_0x29655e(0x251)]()[_0x29655e(0x205)](0x2,'0')+':'+_0x22f370[_0x29655e(0x2b9)]()[_0x29655e(0x251)]()[_0x29655e(0x205)](0x2,'0')+':'+_0x22f370[_0x29655e(0x24f)]()[_0x29655e(0x251)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x5d37c4=_0x1d6a55,_0x59635c=shiftedTime();return _0x59635c[_0x5d37c4(0x2ae)]()+'/'+(_0x59635c[_0x5d37c4(0x351)]()+0x1)[_0x5d37c4(0x251)]()[_0x5d37c4(0x205)](0x2,'0')+'/'+_0x59635c[_0x5d37c4(0x299)]()[_0x5d37c4(0x251)]()['padStart'](0x2,'0')+'\x20'+_0x59635c['getHours']()[_0x5d37c4(0x251)]()[_0x5d37c4(0x205)](0x2,'0')+':'+_0x59635c[_0x5d37c4(0x2b9)]()[_0x5d37c4(0x251)]()[_0x5d37c4(0x205)](0x2,'0')+':'+_0x59635c[_0x5d37c4(0x24f)]()['toString']()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x2d8f2a=_0x1d6a55,_0x544bff=shiftedTime();return _0x544bff[_0x2d8f2a(0x2ae)]()+(_0x544bff[_0x2d8f2a(0x351)]()+0x1)[_0x2d8f2a(0x251)]()['padStart'](0x2,'0')+_0x544bff[_0x2d8f2a(0x299)]()[_0x2d8f2a(0x251)]()['padStart'](0x2,'0')+'-'+_0x544bff[_0x2d8f2a(0x247)]()[_0x2d8f2a(0x251)]()[_0x2d8f2a(0x205)](0x2,'0')+_0x544bff[_0x2d8f2a(0x2b9)]()[_0x2d8f2a(0x251)]()[_0x2d8f2a(0x205)](0x2,'0')+_0x544bff['getSeconds']()[_0x2d8f2a(0x251)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x58a0d3=_0x1d6a55,_0x2e4e23=new Date();let _0x58f8af=_0x2e4e23;if(settings[_0x58a0d3(0x257)]&&settings[_0x58a0d3(0x257)]!==0x0)_0x58f8af=fns['add'](_0x2e4e23,{'hours':settings[_0x58a0d3(0x257)]});return _0x58f8af;}function startScheduler(){const _0x4c5511=_0x1d6a55,_0x20b5f1=new Date()[_0x4c5511(0x284)](),_0x442577=shiftedTime()['getHours']();_0x442577==0x4&&backupConfigFiles();_0x442577==0x0&&rotateLogFiles();_0x20b5f1%0x6==0x0&&triggerAnalytics();_0x20b5f1%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x4d3a59){const _0xd511f8=_0x1d6a55;logger['debug'](_0xd511f8(0x20a)+_0x4d3a59);const _0x5f57c4=getBotsWithMode();_0x5f57c4[_0xd511f8(0x1ea)]>0x0?confirmRestore(configbackuppath,_0x4d3a59):unzipFile(configbackuppath,_0x4d3a59);}async function getBackupFiles(_0x3bddab=null){const _0x3ff993=_0x1d6a55;let _0x404236=[],_0x546da2=fs[_0x3ff993(0x258)](configbackuppath,{'withFileTypes':!![]});_0x546da2['sort']((_0xe773da,_0x3e85bf)=>_0xe773da[_0x3ff993(0x1ba)]<_0x3e85bf[_0x3ff993(0x1ba)]?0x1:_0x3e85bf[_0x3ff993(0x1ba)]<_0xe773da[_0x3ff993(0x1ba)]?-0x1:0x0),_0x546da2[_0x3ff993(0x321)](_0x1fc91d=>{const _0x35d9a8=_0x3ff993;if(!_0x1fc91d[_0x35d9a8(0x2f8)]()&&_0x1fc91d[_0x35d9a8(0x1ba)]['startsWith'](_0x35d9a8(0x294))&&_0x1fc91d['name']['endsWith']('.zip')){const _0x3d0451=formatDate(fs[_0x35d9a8(0x29e)](configbackuppath+_0x1fc91d[_0x35d9a8(0x1ba)])[_0x35d9a8(0x212)]);_0x404236[_0x35d9a8(0x37d)]({'name':_0x1fc91d[_0x35d9a8(0x1ba)],'mtime':_0x3d0451});}});if(_0x3bddab)io['to'](_0x3bddab)['emit'](_0x3ff993(0x36b),_0x404236);else return _0x404236;}async function backupConfigFiles(){const _0x41ca84=_0x1d6a55;await zipFiles(_0x41ca84(0x358));const _0x474d4e=getCleanTimeStamp();fs[_0x41ca84(0x386)](zippath+_0x41ca84(0x336),configbackuppath+(_0x41ca84(0x294)+_0x474d4e+_0x41ca84(0x21d)));let _0x2ba961=fs[_0x41ca84(0x258)](configbackuppath,{'withFileTypes':!![]});_0x2ba961['sort']((_0xfb9cd7,_0x3929af)=>_0xfb9cd7[_0x41ca84(0x1ba)]<_0x3929af[_0x41ca84(0x1ba)]?0x1:_0x3929af['name']<_0xfb9cd7[_0x41ca84(0x1ba)]?-0x1:0x0),_0x2ba961[_0x41ca84(0x1ea)]>maxBackups&&fs[_0x41ca84(0x326)](configbackuppath+_0x2ba961[_0x2ba961[_0x41ca84(0x1ea)]-0x1][_0x41ca84(0x1ba)]);}function rotateLogFiles(){const _0x209acc=_0x1d6a55,_0x3a8ad3=fs[_0x209acc(0x29e)](logspath+'output-000.log'),_0x5194a2=_0x3a8ad3[_0x209acc(0x2e9)]/0x400;if(_0x5194a2>0x64){let _0x15c4d1=fs[_0x209acc(0x258)](logspath,{'withFileTypes':!![]});_0x15c4d1[_0x209acc(0x320)]((_0x1db491,_0x175820)=>_0x1db491[_0x209acc(0x1ba)]<_0x175820[_0x209acc(0x1ba)]?0x1:_0x175820['name']<_0x1db491[_0x209acc(0x1ba)]?-0x1:0x0),_0x15c4d1['forEach'](_0x229acf=>{const _0x497793=_0x209acc;if(_0x229acf[_0x497793(0x1ba)]==_0x497793(0x327))fs['copyFileSync'](logspath+_0x229acf['name'],logspath+_0x497793(0x26a));if(_0x229acf[_0x497793(0x1ba)]==_0x497793(0x268))fs[_0x497793(0x386)](logspath+_0x229acf[_0x497793(0x1ba)],logspath+'output-002.log');_0x229acf['name']==_0x497793(0x27b)&&(fs[_0x497793(0x386)](logspath+_0x229acf[_0x497793(0x1ba)],logspath+'output-001.log'),fs[_0x497793(0x24d)](logspath+_0x229acf[_0x497793(0x1ba)],''));});}}async function zipFiles(_0xdaaeb7){const _0xfa9e96=_0x1d6a55;let _0x3b40ec;if(_0xdaaeb7=='logs')_0x3b40ec=logspath;if(_0xdaaeb7==_0xfa9e96(0x2e6))_0x3b40ec=configpath;if(_0xdaaeb7==_0xfa9e96(0x358))_0x3b40ec=configpath;let _0x2e3ae1=fs[_0xfa9e96(0x258)](_0x3b40ec,{'withFileTypes':!![]});const _0x24ab2b=new require(_0xfa9e96(0x2de))();_0x2e3ae1[_0xfa9e96(0x321)](_0x50f1b0=>{const _0x38b3bd=_0xfa9e96;if(!_0x50f1b0[_0x38b3bd(0x2f8)]()){let _0x30594b=fs['readFileSync'](_0x3b40ec+_0x50f1b0[_0x38b3bd(0x1ba)]);if(_0xdaaeb7==_0x38b3bd(0x2e6)){const _0x2e24b4=/^bot-[0-9]{3}-config.json$/,_0x693c91=_0x2e24b4['test'](_0x50f1b0[_0x38b3bd(0x1ba)]);if(_0x693c91){const _0x501e91=JSON[_0x38b3bd(0x1f7)](_0x30594b);if(_0x501e91[_0x38b3bd(0x301)][0x0]){_0x501e91[_0x38b3bd(0x301)][0x0][_0x38b3bd(0x32d)]=_0x38b3bd(0x359),_0x501e91[_0x38b3bd(0x301)][0x0]['apiSecret']='***';if(_0x501e91[_0x38b3bd(0x301)][0x0]['apiPassword'])_0x501e91[_0x38b3bd(0x301)][0x0][_0x38b3bd(0x2c8)]=_0x38b3bd(0x359);}_0x30594b=JSON[_0x38b3bd(0x309)](_0x501e91,null,0x2);}if(_0x50f1b0[_0x38b3bd(0x1ba)]==_0x38b3bd(0x276)){const _0x235518=JSON[_0x38b3bd(0x1f7)](_0x30594b);if(_0x235518[_0x38b3bd(0x259)][_0x38b3bd(0x390)])_0x235518[_0x38b3bd(0x259)][_0x38b3bd(0x390)]=![];if(_0x235518[_0x38b3bd(0x259)][_0x38b3bd(0x2ef)])_0x235518[_0x38b3bd(0x259)][_0x38b3bd(0x2ef)]=_0x38b3bd(0x359);if(_0x235518[_0x38b3bd(0x259)][_0x38b3bd(0x332)])_0x235518['settings'][_0x38b3bd(0x332)]=_0x38b3bd(0x359);if(_0x235518['settings']['telegramChatId'])_0x235518[_0x38b3bd(0x259)][_0x38b3bd(0x378)]=null;_0x30594b=JSON[_0x38b3bd(0x309)](_0x235518,null,0x2);}if(_0x50f1b0['name']!='bb-secure.json')_0x24ab2b['file'](_0x50f1b0['name'],_0x30594b);}else _0x24ab2b[_0x38b3bd(0x335)](_0x50f1b0[_0x38b3bd(0x1ba)],_0x30594b);}});const _0x4b9c6b=_0x24ab2b[_0xfa9e96(0x354)]({'base64':![],'compression':_0xfa9e96(0x31a)});fs[_0xfa9e96(0x24d)](zippath+(_0xdaaeb7+'.zip'),_0x4b9c6b,_0xfa9e96(0x22c));}async function unzipFile(_0x555f58,_0x5950bd){const _0x4630b2=_0x1d6a55;fs[_0x4630b2(0x258)](configpath,{'withFileTypes':!![]})['forEach'](_0x33f7fe=>{const _0x49dbd1=_0x4630b2;if(!_0x33f7fe[_0x49dbd1(0x2f8)]())fs[_0x49dbd1(0x2b5)](configpath+_0x33f7fe[_0x49dbd1(0x1ba)]);});const _0xedb501=fs['readFileSync'](_0x555f58+_0x5950bd,'binary'),_0x5c16be=new require(_0x4630b2(0x2de))(_0xedb501,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x5c16be[_0x4630b2(0x339)])[_0x4630b2(0x321)](_0x364d94=>{const _0x421f03=_0x4630b2,_0x39fc6c=_0x5c16be[_0x421f03(0x339)][_0x364d94];fs[_0x421f03(0x24d)](configpath+_0x39fc6c['name'],_0x39fc6c['_data']);}),fs[_0x4630b2(0x258)](temppath,{'withFileTypes':!![]})[_0x4630b2(0x321)](_0x56b041=>{const _0x5bc0b5=_0x4630b2;if(!_0x56b041[_0x5bc0b5(0x2f8)]())fs['rmSync'](temppath+_0x56b041[_0x5bc0b5(0x1ba)]);}),logger['debug'](_0x4630b2(0x2c3)),process['send']({'restore':!![]},_0x40f07d=>{});}async function getPublicIp(){const _0x19980c=_0x1d6a55;try{const _0x2d34c7=await axios['get'](_0x19980c(0x2e5));publicip=_0x2d34c7[_0x19980c(0x389)]['ip'];}catch(_0x39dd08){}}async function triggerAnalytics(){const _0x210430=_0x1d6a55;if(!publicip)await getPublicIp();const _0x2f8bb2=getBotsWithMode();let _0x42d654=0x0;_0x2f8bb2['forEach'](_0x3aadab=>{const _0xc91264=_0x4d18;if(_0x3aadab['status']===_0xc91264(0x38c))_0x42d654++;});const _0x4f3c7f=getBotExchanges();mixpanel['track']('Server',{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x2f8bb2[_0x210430(0x1ea)],'numbotsenabled':_0x42d654,'exchanges':_0x4f3c7f,'environment':environment});}async function getMessages(){const _0xffbc54=_0x1d6a55,_0x5d9a0d='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x1502be=new GraphQLClient(_0x5d9a0d),_0x1d4996={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x1b54cd=serverversion[_0xffbc54(0x379)]('.'),_0x3725e1=_0x1b54cd[0x0]+'.'+_0x1b54cd[0x1],_0x2d2977=Math['min'](settings[_0xffbc54(0x1d3)],settings[_0xffbc54(0x1e2)]),_0x38a73b={'last':parseInt(_0x2d2977),'bbm':_0x3725e1},_0x4fbd79=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x430e9d;try{_0x430e9d=await _0x1502be[_0xffbc54(0x37c)](_0x4fbd79,_0x38a73b,_0x1d4996);}catch(_0x10d7c7){}if(_0x430e9d&&_0x430e9d[_0xffbc54(0x322)]){let _0x2172a3=settings['lastmsgtelegram'];newMessages=[];for(const _0xa7df1d of _0x430e9d[_0xffbc54(0x322)]){newMessages[_0xffbc54(0x37d)](_0xa7df1d);let _0x580f16=![];_0xa7df1d[_0xffbc54(0x1bc)]&&(updateSetting(_0xffbc54(0x30d),_0xa7df1d['bbvNew']),_0x580f16=isNewerVersion(serverversion,_0xa7df1d[_0xffbc54(0x1bc)])||serverversion==_0xa7df1d['bbvNew']);if(!_0x580f16&&_0xa7df1d[_0xffbc54(0x252)]>_0x2172a3){if(_0xa7df1d['bbvReceive']==='any'||serverversion[_0xffbc54(0x2cc)](_0xa7df1d[_0xffbc54(0x30a)])){let _0x53c037=''+_0xa7df1d['title']+'\x0a\x0a'+_0xa7df1d[_0xffbc54(0x2a8)];const _0x4b0d9f=await sendTelegramMsg(toTelegramMarkdown(_0x53c037),_0xffbc54(0x1c8));if(_0x4b0d9f)_0x2172a3=_0xa7df1d['number'];}}}updateAvailable=isNewerVersion(settings[_0xffbc54(0x30d)],serverversion),updateSetting(_0xffbc54(0x1d3),_0x2172a3),emitMessages();}}function emitMessages(){const _0x4964b1=_0x1d6a55,_0x303783=settings[_0x4964b1(0x1e2)];let _0x1fe738=[];newMessages['forEach'](_0x237fd4=>{const _0x41885f=_0x4964b1;_0x237fd4[_0x41885f(0x252)]>_0x303783&&_0x1fe738['push'](_0x237fd4);}),_0x1fe738[_0x4964b1(0x1ea)]>0x0&&getAllClients()[_0x4964b1(0x321)](_0x52bdd8=>{const _0x11c41a=_0x4964b1;getSocket(_0x52bdd8['id'])[_0x11c41a(0x2cb)](_0x11c41a(0x2a8),_0x1fe738);});}function confirmMessage(_0xfe3bbf){const _0x25d4bc=_0x1d6a55;updateSetting(_0x25d4bc(0x1e2),Number(_0xfe3bbf));}function isNewerVersion(_0x579bbb,_0x27e8ca){const _0x4b3011=_0x1d6a55,_0x4d1bad=_0x27e8ca[_0x4b3011(0x379)]('.'),_0x4bbe10=_0x579bbb[_0x4b3011(0x379)]('.');for(var _0x551567=0x0;_0x551567<_0x4bbe10[_0x4b3011(0x1ea)];_0x551567++){const _0x119336=~~_0x4bbe10[_0x551567],_0x3ff798=~~_0x4d1bad[_0x551567];if(_0x119336>_0x3ff798)return!![];if(_0x119336<_0x3ff798)return![];}return![];}function toTelegramMarkdown(_0x353139){const _0x4ced4b=_0x1d6a55,_0xe4c93c=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x5dbacc=/\*{2}(.+?)\*{2}/gim;return _0x353139=_0x353139[_0x4ced4b(0x270)](_0xe4c93c,'$1_$2_$3')['replace'](_0x5dbacc,_0x4ced4b(0x233)),_0x353139;}async function validateConfigFile(){const _0x576e13=_0x1d6a55,_0x514836=dbConfig[_0x576e13(0x2da)](_0x576e13(0x2ca))['sortBy'](_0x576e13(0x1f5))['value']()||[];if(_0x514836[_0x576e13(0x1ea)]==0x0){let _0x1c532c=0x0,_0x489f2e=[];const _0x3e2ade=/^bot-([0-9]{3})-config.json$/,_0x954ada=fs[_0x576e13(0x258)](configpath);_0x954ada['forEach'](_0x3196f0=>{const _0x2b8f1e=_0x576e13,_0x48bd8a=_0x3e2ade[_0x2b8f1e(0x1e8)](_0x3196f0);if(_0x48bd8a){const _0x3a31f8=_0x48bd8a[0x1];let _0x573a48=getBotAttributes(_0x3a31f8);_0x489f2e[_0x2b8f1e(0x37d)]({'botID':_0x3a31f8,'botname':_0x573a48['botname'],'status':'disabled','live':_0x2b8f1e(0x1df)}),_0x1c532c++;}}),_0x1c532c!=0x0&&(dbConfig[_0x576e13(0x2da)](_0x576e13(0x2ca))['assign'](_0x489f2e)[_0x576e13(0x238)](),config=_0x489f2e,restoredConfigFile=_0x1c532c);}}async function restoreConfigNotify(_0x2e2d15){const _0x556e6e=_0x1d6a55;let _0x5a52e1;if(restoredConfigFile==0x1)_0x5a52e1='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x5a52e1=_0x556e6e(0x23e);if(_0x2e2d15)io['to'](_0x556e6e(0x323))[_0x556e6e(0x2cb)]('notification',_0x5a52e1);else{logger[_0x556e6e(0x28e)](_0x556e6e(0x1c3)),logger[_0x556e6e(0x28e)](_0x5a52e1),logger['simple'](_0x556e6e(0x1c3)),logger[_0x556e6e(0x28e)]('');if(tgBot&&settings[_0x556e6e(0x378)]&&settings[_0x556e6e(0x2fd)]!='orders')tgBot[_0x556e6e(0x2fc)](settings[_0x556e6e(0x378)],'Bot\x20Mgr\x20>\x20'+_0x5a52e1)[_0x556e6e(0x30c)](_0x36adef=>{telegramError(_0x36adef);});}}function validateCredentials(_0x54420e,_0x2edb87){const _0x5666eb=_0x1d6a55;if(_0x54420e['username']==settings[_0x5666eb(0x250)]&&bcrypt[_0x5666eb(0x21f)](_0x54420e['password'],settings['bbPassword'])){if(settings[_0x5666eb(0x2a0)])return{'allow':![],'reason':_0x5666eb(0x2f5),'token':null};else{const _0x895b5c=generateLoginToken(_0x2edb87);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x895b5c};}}else return{'allow':![],'reason':_0x5666eb(0x1ff),'token':null};}function refreshToken(_0x4d326c){const _0x5582b3=generateLoginToken(_0x4d326c);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x5582b3};}function validateAccess(_0x32e472,_0x3dd032,_0x360fc4){const _0x288b06=_0x1d6a55,_0x57706c=_0x360fc4?_0x360fc4:devices[_0x3dd032]['ip'];let _0x403806;const _0x4097ed=_0x2332cc=>{const _0x3ba345=_0x4d18;if(settings[_0x3ba345(0x390)]){if(settings[_0x3ba345(0x2a0)]){if(telegram2FaApproved(_0x3dd032)){const _0x537938=generateLoginToken(_0x3dd032);return{'allow':!![],'reason':_0x3ba345(0x1e0),'token':_0x537938};}else return{'allow':![],'reason':_0x3ba345(0x234),'token':null};}else return _0x403806=validToken(_0x2332cc,_0x3dd032),_0x403806['hasOwnProperty']('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x2332cc}:{'allow':![],'reason':_0x3ba345(0x234),'token':null};}else return{'allow':!![],'reason':_0x3ba345(0x2d6),'token':null};};if(settings[_0x288b06(0x33d)]){let _0x4fae54=[...settings[_0x288b06(0x230)],_0x288b06(0x37a),_0x288b06(0x34a),_0x288b06(0x227)];if(_0x4fae54[_0x288b06(0x237)](_0x57706c))return _0x4097ed(_0x32e472);else{_0x403806=validToken(_0x32e472,_0x3dd032);if(_0x403806[_0x288b06(0x228)](_0x288b06(0x274)))return _0x4097ed(_0x32e472);else{if(telegramIpApproved(_0x3dd032)){const _0x965484=generateToken(_0x3dd032);return _0x403806=_0x4097ed(_0x32e472),_0x403806[_0x288b06(0x216)]?{'allow':!![],'reason':_0x288b06(0x1f0),'token':_0x965484}:_0x403806;}else return settings[_0x288b06(0x2f2)]?{'allow':![],'reason':_0x288b06(0x2ea),'token':null}:{'allow':![],'reason':_0x288b06(0x22d),'token':null};}}}else return _0x4097ed(_0x32e472);}function timelyDecrypt(_0x54b149,_0x127335=!![]){const _0x5b0538=_0x1d6a55;if(_0x54b149)try{const _0x123867=crypt[_0x5b0538(0x2e2)](secure[_0x5b0538(0x35f)],_0x54b149)[_0x5b0538(0x2a8)],_0x313d0f=_0x123867[_0x5b0538(0x379)]('@')[0x0],_0x1b0386=_0x123867[_0x5b0538(0x379)]('@')[0x1],_0x408904=new Date()[_0x5b0538(0x203)]();if(_0x127335){if(_0x408904-_0x1b0386<maxSecretAge*0x3e8)return _0x313d0f;else return![];}else return _0x313d0f;}catch(_0x5959ae){return![];}else return![];}const validToken=(_0x18b13a,_0x51de18)=>{const _0x46085f=_0x1d6a55,_0x4abba1=devices[_0x51de18]['ip'];if(!_0x18b13a)return{'error':_0x46085f(0x324)};for(let _0xb5c55f of blacklist){if(_0xb5c55f[_0x46085f(0x36f)]==_0x18b13a)return{'error':'Token\x20blacklisted'};}let _0x3d8272;try{_0x3d8272=jwt[_0x46085f(0x32f)](_0x18b13a,secure[_0x46085f(0x30b)]+_0x51de18);}catch{return{'error':_0x46085f(0x31f)};}if(!_0x3d8272[_0x46085f(0x228)](_0x46085f(0x24c))&&!_0x3d8272['hasOwnProperty'](_0x46085f(0x21c))||!_0x3d8272[_0x46085f(0x228)](_0x46085f(0x1c7)))return{'error':_0x46085f(0x275)};if(!_0x3d8272[_0x46085f(0x228)]('username')&&_0x3d8272['hasOwnProperty'](_0x46085f(0x24c))){const {clientip:_0x193b81}=_0x3d8272;return _0x4abba1==_0x193b81?{'success':_0x46085f(0x347)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x3d8272[_0x46085f(0x228)](_0x46085f(0x21c))&&_0x3d8272['hasOwnProperty'](_0x46085f(0x24c))){const {username:_0x54c3a8,clientip:_0x2a269b}=_0x3d8272;return settings[_0x46085f(0x250)]==_0x54c3a8&&_0x4abba1==_0x2a269b?{'success':_0x46085f(0x347)}:{'error':_0x46085f(0x1d8)};}}},generateLoginToken=_0x1d531a=>{const _0x56b100=_0x1d6a55;if(_0x1d531a){const _0x1972d1=devices[_0x1d531a]['ip'];return jwt[_0x56b100(0x317)]({'username':settings['bbUsername'],'clientip':_0x1972d1},secure['secret']+_0x1d531a,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x46b228=>{const _0x47ef17=_0x1d6a55;if(_0x46b228){const _0x3c8501=devices[_0x46b228]['ip'];return jwt[_0x47ef17(0x317)]({'clientip':_0x3c8501},secure[_0x47ef17(0x30b)]+_0x46b228,{'expiresIn':devices[_0x46b228][_0x47ef17(0x353)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x15bef7=>{const _0x35d225=_0x1d6a55;let _0x745874=![];return devices[_0x15bef7][_0x35d225(0x353)]&&devices[_0x15bef7][_0x35d225(0x353)][_0x35d225(0x32e)]!=_0x35d225(0x300)&&(_0x745874=devices[_0x15bef7]['telegramIpApproval']['clientip']==devices[_0x15bef7]['ip']&&new Date()['getTime']()-devices[_0x15bef7][_0x35d225(0x353)]['timestamp']<devices[_0x15bef7][_0x35d225(0x353)]['expiry']*0x3c*0x3e8),_0x745874;},telegram2FaApproved=_0x109fa8=>{const _0x5f236e=_0x1d6a55;let _0x8a0d94=![];return devices[_0x109fa8][_0x5f236e(0x204)]&&devices[_0x109fa8][_0x5f236e(0x204)][_0x5f236e(0x32e)]!='reject'&&(_0x8a0d94=devices[_0x109fa8][_0x5f236e(0x204)][_0x5f236e(0x24c)]==devices[_0x109fa8]['ip']&&new Date()['getTime']()-devices[_0x109fa8][_0x5f236e(0x204)][_0x5f236e(0x362)]<devices[_0x109fa8]['telegram2FaApproval'][_0x5f236e(0x32e)]*0x3c*0x3e8),_0x8a0d94;},normalizeIP=_0x457ff7=>{const _0x240e40=_0x1d6a55;let _0x4dc072=null,_0x568c8f=null;if(ipaddr[_0x240e40(0x1d6)](_0x457ff7)){const _0x1030cf=ipaddr[_0x240e40(0x1f7)](_0x457ff7);_0x1030cf[_0x240e40(0x282)]()===_0x240e40(0x39c)?(_0x1030cf[_0x240e40(0x1ca)]()&&(_0x4dc072=_0x1030cf[_0x240e40(0x1f9)]()[_0x240e40(0x251)]()),_0x568c8f=_0x1030cf[_0x240e40(0x251)]()):(_0x4dc072=_0x1030cf[_0x240e40(0x251)](),_0x568c8f=_0x1030cf['toIPv4MappedAddress']()['toString']());}return{'show':_0x4dc072?_0x4dc072:_0x568c8f,'store':_0x568c8f};};function formatDate(_0x2eadb4){const _0x2bafa7=_0x1d6a55;return _0x2eadb4['getFullYear']()+'/'+(_0x2eadb4[_0x2bafa7(0x351)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x2eadb4[_0x2bafa7(0x299)]()[_0x2bafa7(0x251)]()['padStart'](0x2,'0')+'\x20'+_0x2eadb4[_0x2bafa7(0x247)]()[_0x2bafa7(0x251)]()[_0x2bafa7(0x205)](0x2,'0')+':'+_0x2eadb4['getMinutes']()['toString']()[_0x2bafa7(0x205)](0x2,'0')+':'+_0x2eadb4[_0x2bafa7(0x24f)]()[_0x2bafa7(0x251)]()[_0x2bafa7(0x205)](0x2,'0');}function sleep(_0x2d092b){return new Promise(_0x3f1c2b=>setTimeout(_0x3f1c2b,_0x2d092b));}