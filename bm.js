const _0x31f3f2=_0x54a8;(function(_0x1201e1,_0x226761){const _0x15416a=_0x54a8,_0x2b0665=_0x1201e1();while(!![]){try{const _0x10f2d5=-parseInt(_0x15416a(0x1cb))/0x1+-parseInt(_0x15416a(0x27b))/0x2+parseInt(_0x15416a(0x2af))/0x3*(parseInt(_0x15416a(0x1b0))/0x4)+parseInt(_0x15416a(0x2d2))/0x5+parseInt(_0x15416a(0x2e6))/0x6+-parseInt(_0x15416a(0x20b))/0x7*(parseInt(_0x15416a(0x1f2))/0x8)+-parseInt(_0x15416a(0x261))/0x9*(-parseInt(_0x15416a(0x237))/0xa);if(_0x10f2d5===_0x226761)break;else _0x2b0665['push'](_0x2b0665['shift']());}catch(_0x1ab376){_0x2b0665['push'](_0x2b0665['shift']());}}}(_0x1dcf,0x970bf));const _0x33e380=function(){let _0x41c9d1=!![];return function(_0x47891b,_0x53b8e3){const _0x2e64ba=_0x41c9d1?function(){const _0x164639=_0x54a8;if(_0x53b8e3){const _0x406b89=_0x53b8e3[_0x164639(0x1b9)](_0x47891b,arguments);return _0x53b8e3=null,_0x406b89;}}:function(){};return _0x41c9d1=![],_0x2e64ba;};}(),_0x3d17c9=_0x33e380(this,function(){const _0x343b20=_0x54a8;return _0x3d17c9['toString']()[_0x343b20(0x1f1)]('(((.+)+)+)+$')['toString']()[_0x343b20(0x2d5)](_0x3d17c9)['search'](_0x343b20(0x2b2));});_0x3d17c9();'use strict';process['env'][_0x31f3f2(0x1ee)]=0x1;const childProcess=require(_0x31f3f2(0x28d)),FileSync=require(_0x31f3f2(0x19d)),fs=require('fs'),fns=require(_0x31f3f2(0x1dc)),low=require(_0x31f3f2(0x2b3)),path=require(_0x31f3f2(0x194)),crypto=require(_0x31f3f2(0x260)),Crypt=require(_0x31f3f2(0x244))[_0x31f3f2(0x249)],RSA=require(_0x31f3f2(0x244))[_0x31f3f2(0x292)],bcrypt=require('bcryptjs'),jwt=require(_0x31f3f2(0x21a)),{Analytics}=require(_0x31f3f2(0x22f)),googleAnalyticsV3Plugin=require(_0x31f3f2(0x287))['default'],googleAnalyticsPlugin=require(_0x31f3f2(0x2d1))[_0x31f3f2(0x258)],ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process[_0x31f3f2(0x239)][_0x31f3f2(0x2e7)](0x2))[_0x31f3f2(0x239)],PORT=argv[_0x31f3f2(0x224)]||_0x31f3f2(0x1f9),pattern=/^[0-9]{2,4}$/;!pattern[_0x31f3f2(0x23b)](PORT)&&(console[_0x31f3f2(0x1a3)](_0x31f3f2(0x202)+PORT+_0x31f3f2(0x2a7)),process[_0x31f3f2(0x29c)](0x1));const HOST=argv[_0x31f3f2(0x1bc)]||null,userID=argv[_0x31f3f2(0x2b6)]||'';let bbpath=_0x31f3f2(0x22a),bbpath2='';const botfile=_0x31f3f2(0x1bd),configfile='bb-config.json',settingsfile='bb-settings.json',securefile=_0x31f3f2(0x200);let validInstallation=!![];!fs[_0x31f3f2(0x1fa)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x31f3f2(0x2e9)),configpath=userID?bbpath+_0x31f3f2(0x27d)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x31f3f2(0x225);!fs[_0x31f3f2(0x1fa)](configpath)&&fs[_0x31f3f2(0x210)](configpath);!fs[_0x31f3f2(0x1fa)](configbackuppath)&&fs[_0x31f3f2(0x210)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x31f3f2(0x1d5)]({'bots':[]})[_0x31f3f2(0x267)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x31f3f2(0x1d5)]({'settings':{'timeshift':0x0}})[_0x31f3f2(0x267)]();function _0x1dcf(){const _0x503d44=['Orders','type','createServer','sortBy','pidRefreshToken','jsonwebtoken','publicKey','Notifications\x20disabled','temporary\x20token\x20generated','password','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','logout','getStartingBalances','message','remove','port','backup/','botmanager','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','getUTCHours','30\x20min','bb/','whitelist','-config.json','access','/on\x20-\x20start\x20bot(s)\x0a','analytics','get-starting-balances','reject','Invalid\x20Telegram\x20token','onText','delete-bot','assign','/:bot','70aonmXW','telegramEvents','argv','encryptedUuid','test','filter','headless','</b>\x20?','bot-','copyFileSync','whitelistEnabled','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','/help\x20-\x20show\x20available\x20commands\x0a','hybrid-crypto-js','/:bot/history','value','function','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Crypt','Unauthorized\x20attempt\x20to\x20log\x20out','Unauthorized\x20attempt\x20to\x20update\x20bot','temporary\x20access\x20not\x20allowed','fork','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','version.json','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','<b>Telegram\x20Bot\x20Status:</b>\x0a','Unauthorized\x20attempt\x20to\x20add\x20bot','UA-192771731-1','cancelLoading','2FA\x20required','idling\x20bot\x20\x20\x20|\x20Bot\x20','HTML','default','Invalid\x20authentication\x20token\x20(1)','started','store','loginRequired','Bot\x20','Temporary\x20access\x20rejected','ipc','crypto','1062540iEnUPz','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','isDirectory','allow','restart','accept','write','new-disabled','timeshift','store-settings','2FA\x20login\x20required','entries','-performance.json','getMonth','login\x20token\x20generated','stopped','forEach','stop','token','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','settings','timestamp','getHours','live','bbUsername','split','1109060aYgRkI','deleted\x20Bot\x20','config/','expiry','push','http','keys','kill','No\x20bots\x20running\x20right\x20now','username','SIGINT','blacklist','@analytics/google-analytics-v3','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','disabled\x20Bot\x20','************','compareSync','You\x20can\x20use\x20the\x20following\x20commands:\x0a','child_process','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','data','sendMessage','/disable\x20-\x20disable\x20notifications\x0a','RSA','sendPortfolioTelegram','temporary\x20access\x20rejected','storeConfiguration','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','telegrammsg','hashSync','add','callback_query','Bot\x20Mgr\x20>\x20','exit','bots','toString','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','bot','handshake','getTime','hex','event','chat','Unauthorized\x20attempt\x20to\x20get\x20portfolio',',\x20must\x20be\x20a\x204\x20digit\x20number','getFullYear','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','telegramIpApproval','delete-alerts','exp','\x20to\x20','place-order','1772481jYPkPi','all','login','(((.+)+)+)+$','lowdb','getDate','manual','user','disconnect','::ffff:127.0.0.1','notification','get-logs','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','args','User\x20has\x20been\x20validated','static','pidExpireLogin','send','Login\x20accepted','alerts','No\x20authentication\x20token','randomFillSync','telegramToken','new','telegramUsername','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','reload','error\x20while\x20deleting\x20config\x20files:\x20','telegramChatId','connection','initclient','reason','<b>Balance\x20Bot\x20Status:</b>\x0a','starting\x20bot\x20|\x20Bot\x20','@analytics/google-analytics','5620725cBncTO','sendFile','placeOrder','constructor','unlinkSync','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','length','Login\x20rejected','telegramEnabled','cloneDeep','127.0.0.1','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','enabled','sha256','sockets','get','getPortfolio','catch','\x20|\x20',':\x20Bot\x20Mgr\x20>\x20','741324mfqSbA','slice','f2aRequired','clients','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','path','Ok,\x20will\x20send\x20alert\x20notifications\x20only','reset-password','socket.io','\x20minutes','referer','server','-results.json','name','lowdb/adapters/FileSync','Unauthorized\x20attempt\x20to\x20update\x20settings','then','-----------------------------------------------------------------------------------','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','RSA-OAEP','log','\x20mode','/:bot/performance','version','Notifications\x20enabled\x0a','disabled','invalid\x20credentials','404\x20Not\x20Found','set','Unauthorized\x20attempt\x20to\x20delete\x20alerts','match','bbPassword','Balance\x20Bot\x20Server','8XvWGyJ','/restart\x20-\x20restart\x20bot(s)\x0a','15\x20min','update-bot','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','polling_error',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','stopPolling','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','apply','/:bot/portfolio','apiKey','host','bot.js','orders','error','1000','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','login\x20required','All','listen','once','telegram2FaApproval','logged\x20out','telegram','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','privateKey','1044126kyKpcW','storeHeadless','index.html','secure','secret','Invalid\x20username\x20or\x20IP\x20address','Unauthorized\x20attempt\x20to\x20delete\x20bot','verify','/enable\x20-\x20enable\x20notifications\x0a','All\x20bots','defaults','express','kind','Unauthorized\x20attempt\x20to\x20store\x20configuration','uuid','/:bot/support','G-1KEE5V4K7S','date-fns','answerCallbackQuery','clientip','emit','running','build','removeListener','success','page','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','includes','show','sign','status','parse','padStart','mode','settings.','NTBA_FIX_319','removeAllListeners','decrypt','search','4153720rkBBJu','botID','headers','readFileSync','2FA\x20login\x20rejected','2FA\x20login\x20token\x20generated','stringify','3000','existsSync','from','toggle-bot-mode','find','botname','restarting\x20Bot\x20','bb-secure.json','node-telegram-bot-api','Error:\x20Invalid\x20argument\x20','Invalid\x20authentication\x20token\x20(2)','Unauthorized\x20attempt\x20to\x20get\x20logs','join','connected','inherit','deleteHistoryAlerts','\x20>\x20','hasOwnProperty','14WeUxHf','login\x20not\x20required','writeFileSync','auto','temporaryAccessAllowed','mkdirSync','emitHistory','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','generateKeyPairAsync','randomBytes'];_0x1dcf=function(){return _0x503d44;};return _0x1dcf();}const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x31f3f2(0x1d5)]({'secure':{},'blacklist':[]})[_0x31f3f2(0x267)]();let crypt=new Crypt({'md':_0x31f3f2(0x2df),'rsaStandard':_0x31f3f2(0x1a2)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x31f3f2(0x24f))[_0x31f3f2(0x1a6)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];oneTimeMigration(),cleanBlacklist();const express=require(_0x31f3f2(0x1d6)),app=express(),http=require(_0x31f3f2(0x280))[_0x31f3f2(0x217)](app);app['use'](express[_0x31f3f2(0x2be)](path[_0x31f3f2(0x205)](__dirname,bbpath2,'build2'))),app['use'](express[_0x31f3f2(0x2be)](path['join'](__dirname,bbpath2,_0x31f3f2(0x1e1)))),app[_0x31f3f2(0x2e1)]('/',function(_0x3135fb,_0x5e1e26){const _0xd1a39e=_0x31f3f2;_0x5e1e26[_0xd1a39e(0x2d3)](path[_0xd1a39e(0x205)](__dirname,bbpath2,'build2','index.html'));}),app['get'](_0x31f3f2(0x236),function(_0x2476f9,_0x4a7200){const _0x42a5d5=_0x31f3f2;_0x4a7200[_0x42a5d5(0x2d3)](path['join'](__dirname,bbpath2,_0x42a5d5(0x1e1),_0x42a5d5(0x1cd)));}),app[_0x31f3f2(0x2e1)](_0x31f3f2(0x1ba),(_0x5e15f2,_0x26aeeb)=>{const _0x2399d9=_0x31f3f2;_0x26aeeb[_0x2399d9(0x2d3)](path[_0x2399d9(0x205)](__dirname,bbpath2,'build',_0x2399d9(0x1cd)));}),app[_0x31f3f2(0x2e1)](_0x31f3f2(0x1a5),(_0x43bd1e,_0x25a0b5)=>{const _0x39c009=_0x31f3f2;_0x25a0b5[_0x39c009(0x2d3)](path[_0x39c009(0x205)](__dirname,bbpath2,_0x39c009(0x1e1),_0x39c009(0x1cd)));}),app[_0x31f3f2(0x2e1)]('/:bot/coins',(_0x254ae5,_0x2c02df)=>{const _0x18bfee=_0x31f3f2;_0x2c02df['sendFile'](path[_0x18bfee(0x205)](__dirname,bbpath2,'build',_0x18bfee(0x1cd)));}),app[_0x31f3f2(0x2e1)](_0x31f3f2(0x245),(_0x9acf5a,_0x50f025)=>{const _0x4d6386=_0x31f3f2;_0x50f025[_0x4d6386(0x2d3)](path[_0x4d6386(0x205)](__dirname,bbpath2,_0x4d6386(0x1e1),'index.html'));}),app['get']('/:bot/configuration',(_0x3d24ac,_0x391150)=>{const _0x1fd9e8=_0x31f3f2;_0x391150[_0x1fd9e8(0x2d3)](path[_0x1fd9e8(0x205)](__dirname,bbpath2,_0x1fd9e8(0x1e1),_0x1fd9e8(0x1cd)));}),app[_0x31f3f2(0x2e1)](_0x31f3f2(0x1da),(_0x3fc575,_0x394475)=>{const _0x42a29e=_0x31f3f2;_0x394475[_0x42a29e(0x2d3)](path['join'](__dirname,bbpath2,'build','index.html'));});if(HOST)http[_0x31f3f2(0x1c4)](PORT,HOST);else http[_0x31f3f2(0x1c4)](PORT);const io=require(_0x31f3f2(0x197))(http,{}),analytics=Analytics({'app':'Balance\x20Bot','plugins':[googleAnalyticsV3Plugin({'trackingId':_0x31f3f2(0x253)}),googleAnalyticsPlugin({'measurementIds':[_0x31f3f2(0x1db)]})]}),TelegramBot=require(_0x31f3f2(0x201));let tgBot;if(settings[_0x31f3f2(0x2c5)]&&settings[_0x31f3f2(0x2c5)]!=''&&settings[_0x31f3f2(0x2c7)]&&settings[_0x31f3f2(0x2c7)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x5c7778=_0x31f3f2;console['log'](''),console[_0x5c7778(0x1a3)](_0x5c7778(0x1a0)),logging('Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:'+PORT),console[_0x5c7778(0x1a3)](_0x5c7778(0x1a0));if(config[_0x5c7778(0x2d8)]!=0x0)config['forEach'](_0x45a019=>{const _0x578d51=_0x5c7778;if(_0x45a019[_0x578d51(0x1e9)]==_0x578d51(0x2de)||_0x45a019[_0x578d51(0x1e9)]==_0x578d51(0x2c6))logging(_0x578d51(0x2d0)+_0x45a019[_0x578d51(0x1f3)]+_0x578d51(0x2e4)+_0x45a019[_0x578d51(0x1fe)]),startBot([_0x45a019['botID'],userID],{'cwd':bbpath},function(_0x2dd14f){if(_0x2dd14f)logging(_0x2dd14f);});else(_0x45a019[_0x578d51(0x1e9)]==_0x578d51(0x1a8)||_0x45a019[_0x578d51(0x1e9)]==_0x578d51(0x268))&&logging(_0x578d51(0x256)+_0x45a019['botID']+_0x578d51(0x2e4)+_0x45a019[_0x578d51(0x1fe)]);});else!newBot&&console[_0x5c7778(0x1a3)](_0x5c7778(0x29f));if(newBot)addBot();console[_0x5c7778(0x1a3)](_0x5c7778(0x1a0)),console[_0x5c7778(0x1a3)]('');}function startSocket(){const _0x10f5d0=_0x31f3f2;io['on'](_0x10f5d0(0x2cc),_0x51da54=>{const _0x2ac714=_0x10f5d0;let _0x1f9649,_0x213a6d,_0x348f25,_0x1eb3ef,_0x431b8e;const _0xc5d35e=_0x51da54[_0x2ac714(0x2a1)][_0x2ac714(0x1f4)][_0x2ac714(0x199)];_0x213a6d=_0xc5d35e[_0x2ac714(0x1ad)](/bot[0-9]{3}/);if(_0x213a6d)_0x348f25=_0x213a6d[0x0][_0x2ac714(0x1ad)](/[0-9]{3}/);if(_0x348f25)_0x1f9649=_0x348f25[0x0];else _0x1f9649=_0x2ac714(0x226);const _0x588f84=_0x51da54[_0x2ac714(0x2a1)]['auth'][_0x2ac714(0x23a)];if(!_0x588f84)_0x51da54[_0x2ac714(0x1df)]('status',{'publicKey':secure[_0x2ac714(0x21b)]});else{_0x1eb3ef=timelyDecrypt(_0x588f84,![]);if(!_0x1eb3ef)_0x51da54[_0x2ac714(0x1df)](_0x2ac714(0x1e9),{'publicKey':secure[_0x2ac714(0x21b)]});else{_0x431b8e=normalizeIP(_0x51da54['conn']['remoteAddress'])[_0x2ac714(0x25b)];if(!devices[_0x1eb3ef])devices[_0x1eb3ef]={'uuid':_0x1eb3ef,'access':{'token':null}};devices[_0x1eb3ef]['ip']=_0x431b8e;const _0x81e796=addClient(_0x51da54['id'],_0x1eb3ef,_0x1f9649);setAccess(_0x81e796),_0x51da54['on'](_0x2ac714(0x2b1),_0x3b6dda=>{const _0x4f60ad=_0x2ac714,_0x583aec=timelyDecrypt(_0x3b6dda[_0x4f60ad(0x21e)]);if(_0x583aec){_0x3b6dda={'username':_0x3b6dda[_0x4f60ad(0x284)],'password':_0x583aec},devices[_0x1eb3ef][_0x4f60ad(0x22d)]=validateCredentials(_0x3b6dda,_0x1eb3ef);if(devices[_0x1eb3ef][_0x4f60ad(0x22d)]['allow']==![]&&devices[_0x1eb3ef][_0x4f60ad(0x22d)][_0x4f60ad(0x2ce)]==_0x4f60ad(0x26b))_0x51da54[_0x4f60ad(0x1df)](_0x4f60ad(0x1e9),{'access':devices[_0x1eb3ef][_0x4f60ad(0x22d)]}),loginAccess2FA(_0x1eb3ef,_0x431b8e);else{if(devices[_0x1eb3ef][_0x4f60ad(0x22d)]['allow']==![]&&devices[_0x1eb3ef][_0x4f60ad(0x22d)][_0x4f60ad(0x2ce)]==_0x4f60ad(0x1a9))_0x51da54[_0x4f60ad(0x1df)](_0x4f60ad(0x1e9),{'access':devices[_0x1eb3ef][_0x4f60ad(0x22d)]});else devices[_0x1eb3ef]['access']['allow']&&devices[_0x1eb3ef][_0x4f60ad(0x22d)][_0x4f60ad(0x2ce)]==_0x4f60ad(0x26f)&&(getClientsWithUuid(_0x1eb3ef)[_0x4f60ad(0x271)](_0x468541=>{setAccess(_0x468541);}),setTokenRefresh(_0x1eb3ef),setSessionTimeout(_0x4f60ad(0x2b1),_0x1eb3ef));}}else logging('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x51da54['on'](_0x2ac714(0x196),()=>{resetPassword();}),_0x51da54['on']('disconnect',_0x4e5f13=>{removeClient(_0x51da54['id']);});}}});}function initClient(_0x3b993b){const _0x263943=_0x31f3f2;if(_0x3b993b!='botmanager'&&config[_0x263943(0x1bb)]!=''){if(pid[_0x3b993b])pid[_0x3b993b][_0x263943(0x2c0)]({'function':_0x263943(0x2cd),'args':null});}}function getSocket(_0x461abe){const _0x504c78=_0x31f3f2;return io[_0x504c78(0x2e0)][_0x504c78(0x2e0)]['get'](_0x461abe);}function setAccess(_0x22fd8e){const _0x157589=_0x31f3f2,_0x5975c3=getSocket(_0x22fd8e['id']),_0x3a92cd=_0x22fd8e['uuid'],_0x4ca6f4=_0x22fd8e['bot'];devices[_0x3a92cd][_0x157589(0x22d)]=validateAccess(devices[_0x3a92cd]['access'][_0x157589(0x273)],_0x3a92cd),_0x5975c3[_0x157589(0x205)](_0x3a92cd);if(devices[_0x3a92cd][_0x157589(0x22d)][_0x157589(0x264)]){_0x5975c3[_0x157589(0x205)](_0x4ca6f4);if(_0x4ca6f4==_0x157589(0x226))initializeSocketBotManager(_0x5975c3);else initializeSocketBot(_0x5975c3);initClient(_0x4ca6f4);}devices[_0x3a92cd]['access']['token']&&devices[_0x3a92cd]['access'][_0x157589(0x2ce)]==_0x157589(0x21d)&&setSessionTimeout('2FA',_0x3a92cd),devices[_0x3a92cd]['access'][_0x157589(0x273)]&&devices[_0x3a92cd]['access'][_0x157589(0x2ce)]==_0x157589(0x1f7)&&setSessionTimeout(_0x157589(0x2b1),_0x3a92cd),_0x5975c3[_0x157589(0x1df)](_0x157589(0x1e9),{'status':_0x22fd8e[_0x157589(0x19a)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x3a92cd][_0x157589(0x22d)],'externalip':devices[_0x3a92cd]['ip'],'publicKey':secure[_0x157589(0x21b)],'validInstallation':validInstallation}),devices[_0x3a92cd]['access'][_0x157589(0x264)]==![]&&devices[_0x3a92cd][_0x157589(0x22d)][_0x157589(0x2ce)]==_0x157589(0x255)&&temporaryAccess2FA(_0x3a92cd,devices[_0x3a92cd]['ip']);}function setSessionTimeout(_0x4b4b6f,_0x4c1477){const _0x3c1f42=_0x31f3f2;let _0x1ab31e;if(_0x4b4b6f==_0x3c1f42(0x2b1))_0x1ab31e=loginExpiry*0x3c*0x3e8;else _0x1ab31e=devices[_0x4c1477]['telegramIpApproval'][_0x3c1f42(0x27e)]*0x3c*0x3e8-(new Date()[_0x3c1f42(0x2a2)]()-devices[_0x4c1477][_0x3c1f42(0x2aa)]['timestamp']);if(devices[_0x4c1477]['pidExpireLogin'])clearTimeout(devices[_0x4c1477][_0x3c1f42(0x2bf)]);devices[_0x4c1477]['pidExpireLogin']=setTimeout(()=>{const _0x2b666f=_0x3c1f42;if(devices[_0x4c1477][_0x2b666f(0x219)])clearTimeout(devices[_0x4c1477][_0x2b666f(0x219)]);removeSocketListeners(_0x4c1477),addBlacklist(_0x4c1477),devices[_0x4c1477]['telegramIpApproval']=null,devices[_0x4c1477][_0x2b666f(0x1c6)]=null,devices[_0x4c1477][_0x2b666f(0x22d)]['token']=null,devices[_0x4c1477][_0x2b666f(0x22d)]=validateAccess(devices[_0x4c1477][_0x2b666f(0x22d)]['token'],_0x4c1477),!(devices[_0x4c1477][_0x2b666f(0x22d)][_0x2b666f(0x264)]&&devices[_0x4c1477][_0x2b666f(0x22d)][_0x2b666f(0x2ce)]==_0x2b666f(0x20c))&&(_0x4b4b6f=='login'?io['to'](_0x4c1477)['emit'](_0x2b666f(0x1e9),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x4c1477)[_0x2b666f(0x1df)](_0x2b666f(0x1e9),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x4c1477][_0x2b666f(0x22d)][_0x2b666f(0x273)]=null;},_0x1ab31e);}function setTokenRefresh(_0xab6f01){const _0x5a2eb8=_0x31f3f2;if(devices[_0xab6f01]['pidRefreshToken'])clearTimeout(devices[_0xab6f01]['pidRefreshToken']);devices[_0xab6f01][_0x5a2eb8(0x219)]=setTimeout(()=>{const _0x24da37=_0x5a2eb8;getClientsWithUuid(_0xab6f01)[_0x24da37(0x2d8)]!=0x0?(devices[_0xab6f01]['access']=refreshToken(_0xab6f01),io['to'](_0xab6f01)[_0x24da37(0x1df)](_0x24da37(0x1e9),{'status':_0x24da37(0x206),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0xab6f01][_0x24da37(0x22d)],'externalip':devices[_0xab6f01]['ip'],'publicKey':secure[_0x24da37(0x21b)],'validInstallation':validInstallation}),setTokenRefresh(_0xab6f01)):clearTimeout(devices[_0xab6f01]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x67d2bd){const _0xbb7338=_0x31f3f2,_0x1678f9=getClient(_0x67d2bd['id'])[_0xbb7338(0x1d9)];_0x67d2bd[_0xbb7338(0x1df)](_0xbb7338(0x29d),config),_0x67d2bd['emit']('settings',cleanSettings()),_0x67d2bd['on']('add-bot',_0x4c0493=>{const _0x1bda30=_0xbb7338;if(validateAccess(_0x4c0493,_0x1678f9)['allow'])addBot();else logging(_0x1bda30(0x252));}),_0x67d2bd['on'](_0xbb7338(0x1b3),(_0x587d28,_0x1ba4f7)=>{const _0x2cfd3e=_0xbb7338;if(validateAccess(_0x1ba4f7,_0x1678f9)[_0x2cfd3e(0x264)])toggleBot(_0x587d28[_0x2cfd3e(0x1f3)],_0x587d28[_0x2cfd3e(0x1e9)],_0x587d28[_0x2cfd3e(0x278)]);else logging(_0x2cfd3e(0x24b));}),_0x67d2bd['on'](_0xbb7338(0x1fc),(_0xf18b01,_0x270499)=>{const _0xf34495=_0xbb7338;if(validateAccess(_0x270499,_0x1678f9)[_0xf34495(0x264)])toggleBotMode(_0xf18b01);else logging(_0xf34495(0x24b));}),_0x67d2bd['on'](_0xbb7338(0x234),(_0x36c170,_0x1ec1df)=>{const _0x608b6a=_0xbb7338;if(validateAccess(_0x1ec1df,_0x1678f9)[_0x608b6a(0x264)])deleteBot(_0x36c170);else logging(_0x608b6a(0x1d1));}),_0x67d2bd['on'](_0xbb7338(0x26a),(_0x1b7e1e,_0x326d7d)=>{const _0x5d62ad=_0xbb7338;if(validateAccess(_0x326d7d,_0x1678f9)[_0x5d62ad(0x264)])storeSettings(_0x1b7e1e,!![]);else logging(_0x5d62ad(0x19e));}),_0x67d2bd['on']('update-bb',_0x35fb1e=>{const _0x1ceaf3=_0xbb7338;if(validateAccess(_0x35fb1e,_0x1678f9)[_0x1ceaf3(0x264)])updateBB();else logging('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x67d2bd['on']('logout',_0x556ccd=>{const _0x1a3832=_0xbb7338;if(validateAccess(_0x556ccd,_0x1678f9)[_0x1a3832(0x264)]){if(devices[_0x1678f9][_0x1a3832(0x219)])clearTimeout(devices[_0x1678f9]['pidRefreshToken']);if(devices[_0x1678f9][_0x1a3832(0x2bf)])clearTimeout(devices[_0x1678f9][_0x1a3832(0x2bf)]);removeSocketListeners(getClient(_0x67d2bd['id'])[_0x1a3832(0x1d9)]),addBlacklist(_0x1678f9),devices[_0x1678f9][_0x1a3832(0x2aa)]=null,devices[_0x1678f9]['telegram2FaApproval']=null,devices[_0x1678f9]['access'][_0x1a3832(0x273)]=null,io['to'](getClient(_0x67d2bd['id'])[_0x1a3832(0x1d9)])[_0x1a3832(0x1df)](_0x1a3832(0x1e9),{'access':{'allow':![],'reason':_0x1a3832(0x1c7),'token':null}});}else logging(_0x1a3832(0x24a));});}function initializeSocketBot(_0x1836f7){const _0x434dd8=_0x31f3f2,_0x735822=getClient(_0x1836f7['id'])[_0x434dd8(0x2a0)],_0xcfd1f8=getClient(_0x1836f7['id'])['uuid'];_0x1836f7['on'](_0x434dd8(0x2ba),(_0x137fac,_0x2ceeaa)=>{const _0x519445=_0x434dd8;if(validateAccess(_0x2ceeaa,_0xcfd1f8)[_0x519445(0x264)]){if(pid[_0x735822])pid[_0x735822][_0x519445(0x2c0)]({'function':_0x519445(0x211),'args':_0x137fac});}else logging(_0x519445(0x204));}),_0x1836f7['on'](_0x434dd8(0x2ab),(_0x1b1f21,_0x1cc544)=>{const _0x4aa4b2=_0x434dd8;if(validateAccess(_0x1cc544,_0xcfd1f8)['allow']){if(pid[_0x735822])pid[_0x735822]['send']({'function':_0x4aa4b2(0x208),'args':_0x1b1f21});}else logging(_0x4aa4b2(0x1ac));}),_0x1836f7['on']('get-portfolio',(_0x55bb48,_0x26d1c3)=>{const _0x36c754=_0x434dd8;if(validateAccess(_0x26d1c3,_0xcfd1f8)[_0x36c754(0x264)]){if(pid[_0x735822])pid[_0x735822][_0x36c754(0x2c0)]({'function':_0x36c754(0x2e2),'args':_0x55bb48});}else logging(_0x36c754(0x2a6));}),_0x1836f7['on']('store-configuration',(_0x146aa5,_0x1177a8)=>{const _0x21fca3=_0x434dd8;if(validateAccess(_0x1177a8,_0xcfd1f8)['allow']){if(pid[_0x735822])pid[_0x735822][_0x21fca3(0x2c0)]({'function':_0x21fca3(0x295),'args':_0x146aa5});}else logging(_0x21fca3(0x1d8));}),_0x1836f7['on']('store-headless',(_0x113cc1,_0x55df50)=>{const _0x110447=_0x434dd8;if(validateAccess(_0x55df50,_0xcfd1f8)[_0x110447(0x264)]){if(pid[_0x735822])pid[_0x735822]['send']({'function':_0x110447(0x1cc),'args':_0x113cc1});}else logging(_0x110447(0x2dd));}),_0x1836f7['on'](_0x434dd8(0x230),_0x53868d=>{const _0x58038d=_0x434dd8;if(validateAccess(_0x53868d,_0xcfd1f8)[_0x58038d(0x264)]){if(pid[_0x735822])pid[_0x735822][_0x58038d(0x2c0)]({'function':_0x58038d(0x221),'args':null});}else logging(_0x58038d(0x193));}),_0x1836f7['on'](_0x434dd8(0x2ae),(_0x79640d,_0x1e84e3)=>{const _0x49b6fd=_0x434dd8;if(validateAccess(_0x1e84e3,_0xcfd1f8)['allow']){if(pid[_0x735822])pid[_0x735822][_0x49b6fd(0x2c0)]({'function':_0x49b6fd(0x2d4),'args':_0x79640d});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x1836f7['on']('cancel-loading',_0x21449e=>{const _0x4083e5=_0x434dd8;if(validateAccess(_0x21449e,_0xcfd1f8)['allow']){if(pid[_0x735822])pid[_0x735822][_0x4083e5(0x2c0)]({'function':_0x4083e5(0x254),'args':null});}else logging(_0x4083e5(0x1a1));}),_0x1836f7['on'](_0x434dd8(0x220),_0x5dac23=>{const _0x5b86e0=_0x434dd8;if(validateAccess(_0x5dac23,_0xcfd1f8)[_0x5b86e0(0x264)]){if(devices[_0xcfd1f8][_0x5b86e0(0x219)])clearTimeout(devices[_0xcfd1f8][_0x5b86e0(0x219)]);if(devices[_0xcfd1f8][_0x5b86e0(0x2bf)])clearTimeout(devices[_0xcfd1f8][_0x5b86e0(0x2bf)]);removeSocketListeners(getClient(_0x1836f7['id'])['uuid']),addBlacklist(_0xcfd1f8),devices[_0xcfd1f8][_0x5b86e0(0x2aa)]=null,devices[_0xcfd1f8]['telegram2FaApproval']=null,devices[_0xcfd1f8]['access'][_0x5b86e0(0x273)]=null,io['to'](getClient(_0x1836f7['id'])['uuid'])[_0x5b86e0(0x1df)]('status',{'access':{'allow':![],'reason':_0x5b86e0(0x1c7),'token':null}});}else logging(_0x5b86e0(0x24a));});}function removeSocketListeners(_0xc71b63){getClientsWithUuid(_0xc71b63)['forEach'](_0x2147e7=>{const _0x4c8342=_0x54a8;getSocket(_0x2147e7['id'])[_0x4c8342(0x1ef)]();});}function cleanSettings(){const _0x50c95c=_0x31f3f2;let _0x1b1df0=settings;return settings[_0x50c95c(0x2c5)]&&settings['telegramToken']!=''&&(_0x1b1df0={..._0x1b1df0,'telegramToken':_0x50c95c(0x28a)}),settings[_0x50c95c(0x1ae)]&&settings['bbPassword']!=''&&(_0x1b1df0={..._0x1b1df0,'bbPassword':_0x50c95c(0x28a)}),_0x1b1df0;}function updateBB(){const _0x205cb4=_0x31f3f2;installingUpdate=!![],config[_0x205cb4(0x271)](_0x2fb87c=>{const _0xfed442=_0x205cb4;restartBot(_0x2fb87c[_0xfed442(0x1f3)]);}),process[_0x205cb4(0x2c0)]({'update':!![]},_0x53d121=>{});}function startBot(_0x50a50a,_0x2617ce,_0x4270db){const _0x40b79f=_0x31f3f2;let _0x2bbc49=![];const _0x1dad1a=_0x50a50a[0x0];_0x2617ce={..._0x2617ce,'stdio':[_0x40b79f(0x207),_0x40b79f(0x207),_0x40b79f(0x207),_0x40b79f(0x25f)]},pid[_0x1dad1a]=childProcess[_0x40b79f(0x24d)](botfile,_0x50a50a,_0x2617ce),pid[_0x1dad1a]['on'](_0x40b79f(0x222),_0x1a096f=>{const _0x1437bf=_0x40b79f;switch(Object[_0x1437bf(0x281)](_0x1a096f)[0x0]){case'botname':updateBotName(_0x1dad1a,_0x1a096f[_0x1437bf(0x1fe)]);break;case'updatebotmanager':updateBotManager();break;case _0x1437bf(0x1e9):updateStatus(_0x1dad1a,_0x1a096f[_0x1437bf(0x1e9)]);break;case _0x1437bf(0x278):updateLive(_0x1dad1a,_0x1a096f[_0x1437bf(0x278)]);break;case _0x1437bf(0x25a):updateLive(_0x1dad1a,_0x1a096f[_0x1437bf(0x25a)]),io['to'](_0x1dad1a)['emit'](_0x1437bf(0x1e9),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x1437bf(0x272):_0x1a096f[_0x1437bf(0x272)]==_0x1437bf(0x265)&&restartBot(_0x1dad1a);_0x1a096f[_0x1437bf(0x272)]==_0x1437bf(0x282)&&toggleBot(_0x1dad1a,'disabled',_0x1437bf(0x270));break;case _0x1437bf(0x1c8):sendTelegram(_0x1dad1a,_0x1a096f[_0x1437bf(0x1c8)]);break;case _0x1437bf(0x297):sendTelegramMsg(_0x1a096f[_0x1437bf(0x297)]);break;case _0x1437bf(0x247):io['to'](_0x1dad1a)['emit'](_0x1a096f[_0x1437bf(0x247)],_0x1a096f[_0x1437bf(0x2bc)]);break;}}),pid[_0x1dad1a]['on'](_0x40b79f(0x1bf),function(_0x324d73){if(_0x2bbc49)return;_0x2bbc49=!![],_0x4270db(_0x324d73);}),pid[_0x1dad1a]['on'](_0x40b79f(0x29c),function(_0x183171){const _0x5bc186=_0x40b79f;if(installingUpdate)return;if(_0x2bbc49)return;_0x2bbc49=!![],_0x4270db(null);const _0x43c434=dbConfig[_0x5bc186(0x2e1)](_0x5bc186(0x29d))['find']({'botID':_0x1dad1a})[_0x5bc186(0x246)]();_0x43c434&&(_0x43c434[_0x5bc186(0x1e9)]==_0x5bc186(0x2de)||_0x43c434[_0x5bc186(0x1e9)]==_0x5bc186(0x2c6))&&(updateLive(_0x1dad1a,_0x5bc186(0x270)),logging(_0x5bc186(0x1ff)+_0x1dad1a),startBot([_0x1dad1a,userID],{'cwd':bbpath},function(_0xd4733b){if(_0xd4733b)logging(_0xd4733b);}));});}function stopBot(_0x647f44){const _0x4f3670=_0x31f3f2;getClientsWithBotID(_0x647f44)[_0x4f3670(0x271)](_0x2e83c1=>{const _0x403239=_0x4f3670;getSocket(_0x2e83c1['id'])[_0x403239(0x2b7)](!![]),removeClient(_0x2e83c1['id']);}),pid[_0x647f44]&&(pid[_0x647f44]['kill'](),pid[_0x647f44]=null);}function restartBot(_0x37d7f1){const _0x5a8292=_0x31f3f2;if(pid[_0x37d7f1])pid[_0x37d7f1][_0x5a8292(0x282)]();}function addBot(){const _0x3f1ddf=_0x31f3f2;let _0x1f830e;for(let _0x193c5c=0x1;_0x193c5c<0x3e9;_0x193c5c++){_0x1f830e=_0x193c5c[_0x3f1ddf(0x29e)]()['padStart'](0x3,'0');let _0x56ad20=config[_0x3f1ddf(0x1fd)](_0x2b6a0f=>_0x2b6a0f[_0x3f1ddf(0x1f3)]==_0x1f830e);if(!_0x56ad20)break;}if(_0x1f830e===_0x3f1ddf(0x1c0)){logging(_0x3f1ddf(0x212));return;}logging('starting\x20new\x20bot\x20|\x20Bot\x20'+_0x1f830e),dbConfig[_0x3f1ddf(0x2e1)](_0x3f1ddf(0x29d))[_0x3f1ddf(0x27f)]({'botID':_0x1f830e,'botname':_0x3f1ddf(0x25d)+_0x1f830e,'status':_0x3f1ddf(0x2c6),'live':''})[_0x3f1ddf(0x267)](),startBot([_0x1f830e,userID],{'cwd':bbpath},function(_0x80b54c){if(_0x80b54c)logging(_0x80b54c);}),config=getConfiguration(),io['to'](_0x3f1ddf(0x226))[_0x3f1ddf(0x1df)](_0x3f1ddf(0x29d),config);}function deleteBot(_0x40ce2e){const _0x37f422=_0x31f3f2;getClientsWithBotID(_0x40ce2e)[_0x37f422(0x271)](_0x307c68=>{const _0x54bd17=_0x37f422;getSocket(_0x307c68['id'])[_0x54bd17(0x2b7)](!![]),removeClient(_0x307c68['id']);}),dbConfig[_0x37f422(0x2e1)]('bots')[_0x37f422(0x223)]({'botID':_0x40ce2e})[_0x37f422(0x267)](),logging(_0x37f422(0x27c)+_0x40ce2e),stopBot(_0x40ce2e);try{fs[_0x37f422(0x2d6)](path[_0x37f422(0x205)](configpath,_0x37f422(0x23f)+_0x40ce2e+_0x37f422(0x22c))),fs[_0x37f422(0x2d6)](path[_0x37f422(0x205)](configpath,_0x37f422(0x23f)+_0x40ce2e+'-events.json')),fs[_0x37f422(0x2d6)](path[_0x37f422(0x205)](configpath,_0x37f422(0x23f)+_0x40ce2e+_0x37f422(0x26d))),fs[_0x37f422(0x2d6)](path[_0x37f422(0x205)](configpath,_0x37f422(0x23f)+_0x40ce2e+_0x37f422(0x19b)));}catch(_0x14ccfd){if(_0x14ccfd)logging(_0x37f422(0x2ca),_0x14ccfd);}config=getConfiguration(),io['to'](_0x37f422(0x226))[_0x37f422(0x1df)](_0x37f422(0x29d),config);}function toggleBot(_0x19da87,_0x19f0ce,_0xc2c147){const _0x4b92ff=_0x31f3f2;dbConfig[_0x4b92ff(0x2e1)]('bots')['find']({'botID':_0x19da87})[_0x4b92ff(0x235)]({'status':_0x19f0ce})[_0x4b92ff(0x235)]({'live':_0xc2c147})['write']();if(_0x19f0ce==_0x4b92ff(0x2de)||_0x19f0ce==_0x4b92ff(0x2c6))logging('enabled\x20Bot\x20'+_0x19da87),startBot([_0x19da87,userID],{'cwd':bbpath},function(_0x5ae9f8){if(_0x5ae9f8)logging(_0x5ae9f8);});else(_0x19f0ce=='disabled'||_0x19f0ce==_0x4b92ff(0x268))&&(logging(_0x4b92ff(0x289)+_0x19da87),stopBot(_0x19da87));config=getConfiguration(),io['to'](_0x4b92ff(0x226))['emit'](_0x4b92ff(0x29d),config);}function toggleStatus(_0x2c0c7a){const _0x9fe5ef=_0x31f3f2;let _0x3c3ab5=dbConfig['get'](_0x9fe5ef(0x29d))[_0x9fe5ef(0x1fd)]({'botID':_0x2c0c7a})[_0x9fe5ef(0x246)](),_0x335b1f;if(_0x3c3ab5[_0x9fe5ef(0x1e9)]===_0x9fe5ef(0x2de))_0x335b1f=_0x9fe5ef(0x1a8);else{if(_0x3c3ab5[_0x9fe5ef(0x1e9)]==='new')_0x335b1f='new-disabled';else{if(_0x3c3ab5[_0x9fe5ef(0x1e9)]==='new-disabled')_0x335b1f=_0x9fe5ef(0x2c6);else{if(_0x3c3ab5[_0x9fe5ef(0x1e9)]===_0x9fe5ef(0x1a8))_0x335b1f='enabled';}}}return _0x335b1f;}function updateStatus(_0x274fa4,_0x57c946){const _0x3f941e=_0x31f3f2;dbConfig['get']('bots')[_0x3f941e(0x1fd)]({'botID':_0x274fa4})[_0x3f941e(0x235)]({'status':_0x57c946})[_0x3f941e(0x267)](),config=getConfiguration(),io['to'](_0x3f941e(0x226))[_0x3f941e(0x1df)](_0x3f941e(0x29d),config);}function updateLive(_0x5e7d1d,_0x5877ee){const _0x4f1fb4=_0x31f3f2;dbConfig[_0x4f1fb4(0x2e1)](_0x4f1fb4(0x29d))[_0x4f1fb4(0x1fd)]({'botID':_0x5e7d1d})[_0x4f1fb4(0x235)]({'live':_0x5877ee})['write'](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x4f1fb4(0x29d),config);}function updateBotName(_0x2e4324,_0x4ff83b){const _0x3b80e0=_0x31f3f2;dbConfig['get'](_0x3b80e0(0x29d))[_0x3b80e0(0x1fd)]({'botID':_0x2e4324})[_0x3b80e0(0x235)]({'botname':_0x4ff83b})[_0x3b80e0(0x267)](),config=getConfiguration(),io['to'](_0x3b80e0(0x226))[_0x3b80e0(0x1df)](_0x3b80e0(0x29d),config);}function updateBotManager(){const _0xec1573=_0x31f3f2;config=getConfiguration(),io['to'](_0xec1573(0x226))['emit'](_0xec1573(0x29d),config);}function toggleBotMode(_0x49145f){const _0x4fe9e0=_0x31f3f2;if(pid[_0x49145f])pid[_0x49145f][_0x4fe9e0(0x2c0)]({'function':'toggleBotMode','args':null});else{const _0xde0e50=configpath+_0x4fe9e0(0x23f)+_0x49145f+'-config.json',_0x406af1=fs[_0x4fe9e0(0x1f5)](_0xde0e50),_0x414e52=JSON[_0x4fe9e0(0x1ea)](_0x406af1),_0x475c5a=_0x414e52[_0x4fe9e0(0x2a0)][0x0][_0x4fe9e0(0x23d)];_0x414e52[_0x4fe9e0(0x2a0)][0x0][_0x4fe9e0(0x23d)]=!_0x475c5a;const _0x15220f=JSON[_0x4fe9e0(0x1f8)](_0x414e52,null,0x2);fs[_0x4fe9e0(0x20d)](_0xde0e50,_0x15220f),config=getConfiguration(),io['to'](_0x4fe9e0(0x226))[_0x4fe9e0(0x1df)](_0x4fe9e0(0x29d),config);}}function telegramError(_0x1dff0a){const _0x54cefe=_0x31f3f2;console[_0x54cefe(0x1a3)](getTimeStamp()+_0x54cefe(0x1b6));}function validateTelegram(_0x3e99da){const _0x19b84e=_0x31f3f2;if(_0x3e99da['from'][_0x19b84e(0x284)]!=settings['telegramUsername']&&'@'+_0x3e99da[_0x19b84e(0x1fb)][_0x19b84e(0x284)]!=settings[_0x19b84e(0x2c7)])return tgBot[_0x19b84e(0x290)](_0x3e99da['chat']['id'],_0x19b84e(0x274),{'parse_mode':_0x19b84e(0x257)})[_0x19b84e(0x2e3)](_0x3633aa=>{telegramError(_0x3633aa);}),![];return!![];}async function initTelegram(){const _0x2b703a=_0x31f3f2;if(tgBot)tgBot[_0x2b703a(0x1b7)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x2b703a(0x2c5)],{'polling':!![]});let _0x1bfc6c=_0x2b703a(0x28c);_0x1bfc6c+='\x0a',_0x1bfc6c+=_0x2b703a(0x1d3),_0x1bfc6c+=_0x2b703a(0x291),_0x1bfc6c+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x1bfc6c+=_0x2b703a(0x1b1),_0x1bfc6c+=_0x2b703a(0x22e),_0x1bfc6c+='/off\x20-\x20stop\x20bot(s)\x0a',_0x1bfc6c+=_0x2b703a(0x1c1),_0x1bfc6c+='/names\x20-\x20show\x20bot\x20names\x0a',_0x1bfc6c+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x1bfc6c+=_0x2b703a(0x21f),_0x1bfc6c+=_0x2b703a(0x243);let _0x360ca0=_0x2b703a(0x248);_0x360ca0+='\x0a',_0x360ca0+=_0x1bfc6c,tgBot[_0x2b703a(0x233)](/\/start/,_0x5ea1f7=>{const _0x3c2ece=_0x2b703a;if(!validateTelegram(_0x5ea1f7))return;if(settings[_0x3c2ece(0x2cb)]!=_0x5ea1f7['chat']['id'])updateSetting(_0x3c2ece(0x2cb),_0x5ea1f7['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x3c2ece(0x290)](_0x5ea1f7[_0x3c2ece(0x2a5)]['id'],_0x360ca0)[_0x3c2ece(0x2e3)](_0x593a27=>{telegramError(_0x593a27);});}),tgBot[_0x2b703a(0x233)](/\/enable/,_0x30c03d=>{const _0x3a12a1=_0x2b703a;if(!validateTelegram(_0x30c03d))return;if(settings['telegramChatId']!=_0x30c03d[_0x3a12a1(0x2a5)]['id'])updateSetting('telegramChatId',_0x30c03d['chat']['id']);updateSetting(_0x3a12a1(0x2da),!![]),tgBot[_0x3a12a1(0x290)](_0x30c03d['chat']['id'],'Notifications\x20enabled')[_0x3a12a1(0x2e3)](_0x427b06=>{telegramError(_0x427b06);});}),tgBot['onText'](/\/config/,async _0x5cf0b0=>{const _0x22cecf=_0x2b703a;if(!validateTelegram(_0x5cf0b0))return;tgBot[_0x22cecf(0x1e2)](_0x22cecf(0x29a)),tgBot['sendMessage'](_0x5cf0b0[_0x22cecf(0x2a5)]['id'],_0x22cecf(0x2c8),{'reply_markup':{'inline_keyboard':[[{'text':_0x22cecf(0x215),'callback_data':_0x22cecf(0x1be)},{'text':'Alerts','callback_data':'alerts'},{'text':_0x22cecf(0x1c3),'callback_data':_0x22cecf(0x2b0)}]]}})[_0x22cecf(0x2e3)](_0x2f97d3=>{telegramError(_0x2f97d3);}),tgBot['on'](_0x22cecf(0x29a),async _0x4f5484=>{const _0x5f54ca=_0x22cecf,_0x229c81=_0x4f5484['data'],_0x19e04f=_0x4f5484[_0x5f54ca(0x222)];tgBot['answerCallbackQuery'](_0x4f5484['id'])[_0x5f54ca(0x19f)](async()=>{const _0x2ce525=_0x5f54ca;_0x229c81=='orders'&&(updateSetting(_0x2ce525(0x238),'orders'),updateSetting('telegramEnabled',!![]),await tgBot[_0x2ce525(0x290)](_0x19e04f['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')['catch'](_0x10353a=>{telegramError(_0x10353a);}));_0x229c81==_0x2ce525(0x2c2)&&(updateSetting(_0x2ce525(0x238),_0x2ce525(0x2c2)),updateSetting(_0x2ce525(0x2da),!![]),await tgBot['sendMessage'](_0x19e04f[_0x2ce525(0x2a5)]['id'],_0x2ce525(0x195))[_0x2ce525(0x2e3)](_0x178fec=>{telegramError(_0x178fec);}));_0x229c81==_0x2ce525(0x2b0)&&(updateSetting(_0x2ce525(0x238),_0x2ce525(0x2b0)),updateSetting(_0x2ce525(0x2da),!![]),await tgBot['sendMessage'](_0x19e04f[_0x2ce525(0x2a5)]['id'],_0x2ce525(0x24e))[_0x2ce525(0x2e3)](_0x353aaa=>{telegramError(_0x353aaa);}));if(!settings[_0x2ce525(0x2cb)])tgBot[_0x2ce525(0x290)](_0x19e04f['chat']['id'],_0x2ce525(0x262))[_0x2ce525(0x2e3)](_0x102366=>{telegramError(_0x102366);});}),tgBot['removeListener']('callback_query');});}),tgBot['onText'](/\/status/,_0x477dd4=>{const _0x52b59d=_0x2b703a;if(!validateTelegram(_0x477dd4))return;const _0x159520=getBotsWithMode();let _0x377851=_0x52b59d(0x2cf);config['forEach'](_0x48f966=>{const _0x1f19a4=_0x52b59d,_0x27ce59=_0x159520['find'](_0x3e41a4=>_0x3e41a4[_0x1f19a4(0x1f3)]==_0x48f966['botID'])[_0x1f19a4(0x1ec)];_0x377851+=_0x1f19a4(0x25d)+_0x48f966['botID']+':\x20'+_0x48f966[_0x1f19a4(0x1e9)]+_0x1f19a4(0x2e4)+_0x27ce59+_0x1f19a4(0x2e4)+_0x48f966[_0x1f19a4(0x278)]+'\x0a';}),_0x377851+='\x0a',_0x377851+=_0x52b59d(0x251),_0x377851+=!settings[_0x52b59d(0x2da)]?'Notifications\x20disabled\x0a':_0x52b59d(0x1a7),_0x377851+=settings['telegramEnabled']?settings['telegramEvents']==_0x52b59d(0x2b0)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings[_0x52b59d(0x238)]+'\x20only\x0a':'',tgBot[_0x52b59d(0x290)](_0x477dd4[_0x52b59d(0x2a5)]['id'],_0x377851,{'parse_mode':'HTML'})[_0x52b59d(0x2e3)](_0x211ded=>{telegramError(_0x211ded);});}),tgBot['onText'](/\/restart/,_0x2269ec=>{const _0x123764=_0x2b703a;if(!validateTelegram(_0x2269ec))return;tgBot[_0x123764(0x1e2)](_0x123764(0x29a));const _0x5e662b=getEnabledBots();if(_0x5e662b[_0x123764(0x2d8)]==0x0)tgBot[_0x123764(0x290)](_0x2269ec['chat']['id'],_0x123764(0x283))[_0x123764(0x2e3)](_0x5208d6=>{telegramError(_0x5208d6);});else{if(_0x5e662b[_0x123764(0x2d8)]>0x1)_0x5e662b[_0x123764(0x27f)]({'botID':_0x123764(0x2b0)});let _0x24a0db=[],_0x28c6f0=[];const _0x18be8a=_0x5e662b[_0x123764(0x2d8)]%0x4==0x0||_0x5e662b[_0x123764(0x2d8)]%0x4==0x3||_0x5e662b[_0x123764(0x2d8)]%0x3==0x1?0x4:0x3;let _0x33a948=0x0;_0x5e662b[_0x123764(0x271)]((_0x389693,_0x32a261)=>{const _0x1afa09=_0x123764;if(_0x32a261%_0x18be8a==0x0)_0x28c6f0=[];_0x28c6f0[_0x1afa09(0x27f)]({'text':_0x389693['botID']=='all'?_0x1afa09(0x1d4):'Bot\x20'+_0x389693[_0x1afa09(0x1f3)],'callback_data':_0x389693[_0x1afa09(0x1f3)]}),_0x32a261%_0x18be8a==0x0&&(_0x24a0db[_0x33a948]=_0x28c6f0,_0x33a948++);}),tgBot[_0x123764(0x290)](_0x2269ec[_0x123764(0x2a5)]['id'],_0x123764(0x288),{'reply_markup':{'inline_keyboard':_0x24a0db}})[_0x123764(0x2e3)](_0x403cc7=>{telegramError(_0x403cc7);}),tgBot['on'](_0x123764(0x29a),async _0x1befc8=>{const _0x376d4f=_0x123764,_0x189e20=_0x1befc8[_0x376d4f(0x28f)],_0x28e9a6=_0x1befc8[_0x376d4f(0x222)];tgBot[_0x376d4f(0x1dd)](_0x1befc8['id'])['then'](async()=>{const _0x3890b0=_0x376d4f;_0x189e20=='all'?(tgBot[_0x3890b0(0x290)](_0x28e9a6['chat']['id'],_0x3890b0(0x296))[_0x3890b0(0x2e3)](_0x4caa00=>{telegramError(_0x4caa00);}),config[_0x3890b0(0x271)](_0x26c18c=>{const _0x21acee=_0x3890b0;restartBot(_0x26c18c[_0x21acee(0x1f3)]);})):(tgBot['sendMessage'](_0x28e9a6[_0x3890b0(0x2a5)]['id'],_0x3890b0(0x28e)+_0x189e20)[_0x3890b0(0x2e3)](_0x2f9bef=>{telegramError(_0x2f9bef);}),restartBot(_0x189e20));}),tgBot[_0x376d4f(0x1e2)]('callback_query');});}}),tgBot[_0x2b703a(0x233)](/\/on/,_0x5d25f7=>{const _0xa3fcb9=_0x2b703a;if(!validateTelegram(_0x5d25f7))return;tgBot['removeListener']('callback_query');const _0x3055e6=getDisabledBots();if(_0x3055e6['length']==0x0)tgBot[_0xa3fcb9(0x290)](_0x5d25f7['chat']['id'],'All\x20bots\x20running\x20right\x20now')['catch'](_0x33a651=>{telegramError(_0x33a651);});else{if(_0x3055e6['length']>0x1)_0x3055e6[_0xa3fcb9(0x27f)]({'botID':_0xa3fcb9(0x2b0)});let _0x131215=[],_0x5ceb7d=[];const _0x5469dc=_0x3055e6[_0xa3fcb9(0x2d8)]%0x4==0x0||_0x3055e6['length']%0x4==0x3||_0x3055e6[_0xa3fcb9(0x2d8)]%0x3==0x1?0x4:0x3;let _0x30cfaf=0x0;_0x3055e6[_0xa3fcb9(0x271)]((_0x325a7f,_0x59bf26)=>{const _0x58d05d=_0xa3fcb9;if(_0x59bf26%_0x5469dc==0x0)_0x5ceb7d=[];_0x5ceb7d[_0x58d05d(0x27f)]({'text':_0x325a7f[_0x58d05d(0x1f3)]==_0x58d05d(0x2b0)?_0x58d05d(0x1d4):_0x58d05d(0x25d)+_0x325a7f[_0x58d05d(0x1f3)],'callback_data':_0x325a7f[_0x58d05d(0x1f3)]}),_0x59bf26%_0x5469dc==0x0&&(_0x131215[_0x30cfaf]=_0x5ceb7d,_0x30cfaf++);}),tgBot[_0xa3fcb9(0x290)](_0x5d25f7['chat']['id'],_0xa3fcb9(0x1c9),{'reply_markup':{'inline_keyboard':_0x131215}})[_0xa3fcb9(0x2e3)](_0x4447dd=>{telegramError(_0x4447dd);}),tgBot['on'](_0xa3fcb9(0x29a),async _0x20009f=>{const _0x1dbe53=_0xa3fcb9,_0x30072f=_0x20009f[_0x1dbe53(0x28f)],_0x1b26e4=_0x20009f[_0x1dbe53(0x222)];tgBot[_0x1dbe53(0x1dd)](_0x20009f['id'])[_0x1dbe53(0x19f)](async()=>{const _0xac062a=_0x1dbe53;_0x30072f=='all'?(tgBot[_0xac062a(0x290)](_0x1b26e4[_0xac062a(0x2a5)]['id'],_0xac062a(0x227))[_0xac062a(0x2e3)](_0x340119=>{telegramError(_0x340119);}),_0x3055e6[_0xac062a(0x271)](_0x1c3401=>{const _0x14a538=_0xac062a;if(_0x1c3401['botID']!=_0x14a538(0x2b0))toggleBot(_0x1c3401[_0x14a538(0x1f3)],toggleStatus(_0x1c3401[_0x14a538(0x1f3)]),_0x14a538(0x270));})):(tgBot['sendMessage'](_0x1b26e4[_0xac062a(0x2a5)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x30072f)['catch'](_0x1bf422=>{telegramError(_0x1bf422);}),toggleBot(_0x30072f,toggleStatus(_0x30072f),_0xac062a(0x270)));}),tgBot[_0x1dbe53(0x1e2)](_0x1dbe53(0x29a));});}}),tgBot[_0x2b703a(0x233)](/\/off/,_0x1c136f=>{const _0x4f6f2e=_0x2b703a;if(!validateTelegram(_0x1c136f))return;tgBot[_0x4f6f2e(0x1e2)](_0x4f6f2e(0x29a));const _0x33824a=getEnabledBots();if(_0x33824a[_0x4f6f2e(0x2d8)]==0x0)tgBot[_0x4f6f2e(0x290)](_0x1c136f[_0x4f6f2e(0x2a5)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x1e902b=>{telegramError(_0x1e902b);});else{if(_0x33824a[_0x4f6f2e(0x2d8)]>0x1)_0x33824a[_0x4f6f2e(0x27f)]({'botID':'all'});let _0x3c93fb=[],_0xc336e0=[];const _0x2ebcf6=_0x33824a['length']%0x4==0x0||_0x33824a[_0x4f6f2e(0x2d8)]%0x4==0x3||_0x33824a['length']%0x3==0x1?0x4:0x3;let _0x35488e=0x0;_0x33824a[_0x4f6f2e(0x271)]((_0x506f84,_0x1a8cd5)=>{const _0x44e0c5=_0x4f6f2e;if(_0x1a8cd5%_0x2ebcf6==0x0)_0xc336e0=[];_0xc336e0[_0x44e0c5(0x27f)]({'text':_0x506f84[_0x44e0c5(0x1f3)]==_0x44e0c5(0x2b0)?_0x44e0c5(0x1d4):'Bot\x20'+_0x506f84[_0x44e0c5(0x1f3)],'callback_data':_0x506f84[_0x44e0c5(0x1f3)]}),_0x1a8cd5%_0x2ebcf6==0x0&&(_0x3c93fb[_0x35488e]=_0xc336e0,_0x35488e++);}),tgBot['sendMessage'](_0x1c136f[_0x4f6f2e(0x2a5)]['id'],_0x4f6f2e(0x1b8),{'reply_markup':{'inline_keyboard':_0x3c93fb}})[_0x4f6f2e(0x2e3)](_0x12b235=>{telegramError(_0x12b235);}),tgBot['on']('callback_query',async _0x240e71=>{const _0x2f03e5=_0x4f6f2e,_0x13b404=_0x240e71[_0x2f03e5(0x28f)],_0x1fcc9a=_0x240e71[_0x2f03e5(0x222)];tgBot[_0x2f03e5(0x1dd)](_0x240e71['id'])[_0x2f03e5(0x19f)](async()=>{const _0xe125b3=_0x2f03e5;_0x13b404==_0xe125b3(0x2b0)?(tgBot[_0xe125b3(0x290)](_0x1fcc9a['chat']['id'],_0xe125b3(0x1b4))[_0xe125b3(0x2e3)](_0x26270d=>{telegramError(_0x26270d);}),_0x33824a[_0xe125b3(0x271)](_0x2b125a=>{const _0x3fcd82=_0xe125b3;if(_0x2b125a[_0x3fcd82(0x1f3)]!='all')toggleBot(_0x2b125a[_0x3fcd82(0x1f3)],toggleStatus(_0x2b125a[_0x3fcd82(0x1f3)]),_0x3fcd82(0x270));})):(tgBot[_0xe125b3(0x290)](_0x1fcc9a[_0xe125b3(0x2a5)]['id'],_0xe125b3(0x2d7)+_0x13b404)[_0xe125b3(0x2e3)](_0x42b9e5=>{telegramError(_0x42b9e5);}),toggleBot(_0x13b404,toggleStatus(_0x13b404),_0xe125b3(0x270)));}),tgBot[_0x2f03e5(0x1e2)](_0x2f03e5(0x29a));});}}),tgBot['onText'](/\/portfolio/,_0x58cf15=>{const _0x58c941=_0x2b703a;if(!validateTelegram(_0x58cf15))return;tgBot[_0x58c941(0x1e2)](_0x58c941(0x29a));const _0x1e1697=getEnabledBots();if(_0x1e1697[_0x58c941(0x2d8)]==0x0)tgBot['sendMessage'](_0x58cf15['chat']['id'],_0x58c941(0x283))[_0x58c941(0x2e3)](_0x469ebb=>{telegramError(_0x469ebb);});else{if(_0x1e1697[_0x58c941(0x2d8)]>0x1){let _0x527dd7=[],_0x15cd9=[];const _0x1a1dbf=_0x1e1697[_0x58c941(0x2d8)]%0x4==0x0||_0x1e1697[_0x58c941(0x2d8)]%0x4==0x3||_0x1e1697[_0x58c941(0x2d8)]%0x3==0x1?0x4:0x3;let _0x409c83=0x0;_0x1e1697[_0x58c941(0x271)]((_0x38dd9b,_0x39f0cb)=>{const _0x4d3014=_0x58c941;if(_0x39f0cb%_0x1a1dbf==0x0)_0x15cd9=[];_0x15cd9[_0x4d3014(0x27f)]({'text':_0x4d3014(0x25d)+_0x38dd9b[_0x4d3014(0x1f3)],'callback_data':_0x38dd9b[_0x4d3014(0x1f3)]}),_0x39f0cb%_0x1a1dbf==0x0&&(_0x527dd7[_0x409c83]=_0x15cd9,_0x409c83++);}),tgBot[_0x58c941(0x290)](_0x58cf15[_0x58c941(0x2a5)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x527dd7}})['catch'](_0x36275e=>{telegramError(_0x36275e);}),tgBot['on'](_0x58c941(0x29a),async _0x392673=>{const _0x5ddf91=_0x58c941,_0x5f5a01=_0x392673[_0x5ddf91(0x28f)],_0x1c3a3c=_0x392673['message'];tgBot[_0x5ddf91(0x1dd)](_0x392673['id'])[_0x5ddf91(0x19f)](async()=>{const _0x133815=_0x5ddf91;if(pid[_0x5f5a01])pid[_0x5f5a01]['send']({'function':_0x133815(0x293),'args':null});}),tgBot[_0x5ddf91(0x1e2)](_0x5ddf91(0x29a));});}else{const _0x89e832=_0x1e1697[0x0][_0x58c941(0x1f3)];if(pid[_0x89e832])pid[_0x89e832][_0x58c941(0x2c0)]({'function':_0x58c941(0x293),'args':null});}}}),tgBot['onText'](/\/toggle/,_0x1f1ddc=>{const _0xe888f0=_0x2b703a;if(!validateTelegram(_0x1f1ddc))return;tgBot[_0xe888f0(0x1e2)](_0xe888f0(0x29a));const _0x4db4ec=getBotsWithMode();if(_0x4db4ec[_0xe888f0(0x2d8)]==0x0)tgBot[_0xe888f0(0x290)](_0x1f1ddc[_0xe888f0(0x2a5)]['id'],'No\x20bots\x20running\x20right\x20now')[_0xe888f0(0x2e3)](_0x4e845a=>{telegramError(_0x4e845a);});else{let _0x1adee9=[],_0x87f227=[];const _0x62c141=0x2;let _0xc96ed5=0x0;_0x4db4ec[_0xe888f0(0x271)]((_0x16d963,_0x2de9d3)=>{const _0x4bf50c=_0xe888f0;if(_0x2de9d3%_0x62c141==0x0)_0x87f227=[];_0x87f227[_0x4bf50c(0x27f)]({'text':_0x4bf50c(0x25d)+_0x16d963['botID']+'\x20('+_0x16d963['mode']+')','callback_data':_0x16d963[_0x4bf50c(0x1f3)]}),_0x2de9d3%_0x62c141==0x0&&(_0x1adee9[_0xc96ed5]=_0x87f227,_0xc96ed5++);}),tgBot['sendMessage'](_0x1f1ddc['chat']['id'],_0xe888f0(0x2a9),{'reply_markup':{'inline_keyboard':_0x1adee9}})['catch'](_0x5105fc=>{telegramError(_0x5105fc);}),tgBot['on']('callback_query',async _0x36e8e3=>{const _0x5d0576=_0xe888f0,_0x511bf0=_0x36e8e3[_0x5d0576(0x28f)],_0x5ee4d2=_0x36e8e3[_0x5d0576(0x222)];tgBot[_0x5d0576(0x1dd)](_0x36e8e3['id'])[_0x5d0576(0x19f)](async()=>{const _0x39ab36=_0x5d0576,_0x2c59b8=_0x4db4ec[_0x39ab36(0x1fd)](_0x28a8cd=>_0x28a8cd[_0x39ab36(0x1f3)]==_0x511bf0),_0x189390=_0x2c59b8['mode']==_0x39ab36(0x20e)?_0x39ab36(0x2b5):_0x39ab36(0x20e);tgBot[_0x39ab36(0x290)](_0x5ee4d2['chat']['id'],_0x39ab36(0x242)+_0x511bf0+_0x39ab36(0x2ad)+_0x189390+_0x39ab36(0x1a4))[_0x39ab36(0x2e3)](_0x1eb3ce=>{telegramError(_0x1eb3ce);}),toggleBotMode(_0x511bf0);}),tgBot['removeListener'](_0x5d0576(0x29a));});}}),tgBot[_0x2b703a(0x233)](/\/names/,_0x27365d=>{const _0xf37d33=_0x2b703a;if(!validateTelegram(_0x27365d))return;let _0x562568='';config['forEach'](_0xcb297d=>{const _0x1e49ec=_0x54a8;_0x562568+=_0x1e49ec(0x25d)+_0xcb297d[_0x1e49ec(0x1f3)]+':\x20'+_0xcb297d[_0x1e49ec(0x1fe)]+'\x0a';}),tgBot['sendMessage'](_0x27365d[_0xf37d33(0x2a5)]['id'],_0x562568,{'parse_mode':'HTML'})[_0xf37d33(0x2e3)](_0x396cfd=>{telegramError(_0x396cfd);});}),tgBot[_0x2b703a(0x233)](/\/disable/,_0x19261f=>{const _0x3f9817=_0x2b703a;if(!validateTelegram(_0x19261f))return;tgBot[_0x3f9817(0x290)](_0x19261f['chat']['id'],_0x3f9817(0x21c))['catch'](_0x294130=>{telegramError(_0x294130);}),updateSetting(_0x3f9817(0x2da),![]);}),tgBot[_0x2b703a(0x233)](/\/help/,_0x2aadc6=>{const _0x290cfe=_0x2b703a;if(!validateTelegram(_0x2aadc6))return;tgBot[_0x290cfe(0x290)](_0x2aadc6[_0x290cfe(0x2a5)]['id'],_0x1bfc6c)['catch'](_0x55d457=>{telegramError(_0x55d457);});}),tgBot['on'](_0x2b703a(0x1b5),_0x56feac=>{const _0x5cd7b5=_0x2b703a;_0x56feac['toString']()[_0x5cd7b5(0x1e6)](_0x5cd7b5(0x1aa))&&(logging('Invalid\x20Telegram\x20token'),tgBot[_0x5cd7b5(0x1b7)](),tgBot=null,io['to'](_0x5cd7b5(0x226))[_0x5cd7b5(0x1df)](_0x5cd7b5(0x2b9),_0x5cd7b5(0x232)));}),process[_0x2b703a(0x1c5)](_0x2b703a(0x285),()=>{const _0x4af7dc=_0x2b703a;if(tgBot)tgBot[_0x4af7dc(0x1b7)]();process[_0x4af7dc(0x29c)](0x1);}),process[_0x2b703a(0x1c5)]('SIGTERM',()=>{const _0xb941ca=_0x2b703a;if(tgBot)tgBot[_0xb941ca(0x1b7)]();process[_0xb941ca(0x29c)](0x1);});}}function disableTelegram(){const _0x2d511f=_0x31f3f2;tgBot&&(tgBot[_0x2d511f(0x1b7)](),tgBot=null);}function sendTelegram(_0x270c9b,_0x30ad3d){const _0x46497e=_0x31f3f2;if(settings[_0x46497e(0x2da)]){if(settings[_0x46497e(0x238)]=='all'||(_0x30ad3d[_0x46497e(0x216)]==_0x46497e(0x1bf)||_0x30ad3d[_0x46497e(0x216)]==_0x46497e(0x1e3))&&settings[_0x46497e(0x238)]==_0x46497e(0x2c2)||_0x30ad3d[_0x46497e(0x216)]=='order'&&settings[_0x46497e(0x238)]==_0x46497e(0x1be)){if(tgBot&&settings[_0x46497e(0x2cb)]){if(_0x30ad3d['showname'])tgBot[_0x46497e(0x290)](settings['telegramChatId'],_0x30ad3d['botname']+_0x46497e(0x209)+_0x30ad3d['event'])['catch'](_0x33c638=>{telegramError(_0x33c638);});else tgBot[_0x46497e(0x290)](settings[_0x46497e(0x2cb)],_0x46497e(0x25d)+_0x270c9b+_0x46497e(0x209)+_0x30ad3d[_0x46497e(0x2a4)])['catch'](_0x5be7c3=>{telegramError(_0x5be7c3);});}}}}function sendTelegramMsg(_0x11db23){const _0x585117=_0x31f3f2;settings[_0x585117(0x2da)]&&(tgBot&&settings[_0x585117(0x2cb)]&&tgBot[_0x585117(0x290)](settings[_0x585117(0x2cb)],_0x11db23,{'parse_mode':_0x585117(0x257)})[_0x585117(0x2e3)](_0x13af0d=>{telegramError(_0x13af0d);}));}function getDeviceWithIp(_0x5e81d5){const _0x1257ee=_0x31f3f2;return devices[_0x1257ee(0x1fd)](_0x3e89ac=>_0x3e89ac['ip']===_0x5e81d5);}function temporaryAccess2FA(_0x1632ee,_0x8c4278){const _0x2106c1=_0x31f3f2;let _0x52661c=new Date(),_0x4d22e7=![];if(lastIpApproval){if(_0x52661c-lastIpApproval<0x1388)_0x4d22e7=!![];}lastIpApproval=new Date();if(_0x4d22e7)return;tgBot&&settings[_0x2106c1(0x2cb)]&&(tgBot[_0x2106c1(0x1e2)](_0x2106c1(0x29a)),tgBot['sendMessage'](settings[_0x2106c1(0x2cb)],_0x2106c1(0x250)+normalizeIP(_0x8c4278)[_0x2106c1(0x1e7)]+_0x2106c1(0x23e),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x2106c1(0x1b2),'callback_data':'15'},{'text':_0x2106c1(0x229),'callback_data':'30'},{'text':_0x2106c1(0x231),'callback_data':_0x2106c1(0x231)}]]}})[_0x2106c1(0x2e3)](_0x2c8e49=>{telegramError(_0x2c8e49);}),tgBot['on'](_0x2106c1(0x29a),async _0x2c3be1=>{const _0x474ee2=_0x2106c1,_0x293def=_0x2c3be1[_0x474ee2(0x28f)],_0x154d63=_0x2c3be1[_0x474ee2(0x222)];tgBot[_0x474ee2(0x1dd)](_0x2c3be1['id'])[_0x474ee2(0x19f)](async()=>{const _0xcee7df=_0x474ee2;devices[_0x1632ee][_0xcee7df(0x2aa)]={'clientip':_0x8c4278,'timestamp':new Date()['getTime'](),'expiry':_0x293def},_0x293def!=_0xcee7df(0x231)?(await tgBot['sendMessage'](_0x154d63[_0xcee7df(0x2a5)]['id'],'Access\x20enabled\x20for\x20'+_0x293def+_0xcee7df(0x198),{'parse_mode':_0xcee7df(0x257)})[_0xcee7df(0x2e3)](_0x249683=>{telegramError(_0x249683);}),io['to'](_0x1632ee)['emit'](_0xcee7df(0x1e9),{'access':{'allow':![],'reason':_0xcee7df(0x2c9),'token':null}})):(await tgBot['sendMessage'](_0x154d63[_0xcee7df(0x2a5)]['id'],_0xcee7df(0x25e))[_0xcee7df(0x2e3)](_0x3b1877=>{telegramError(_0x3b1877);}),io['to'](_0x1632ee)[_0xcee7df(0x1df)]('status',{'access':{'allow':![],'reason':_0xcee7df(0x294),'token':null}}));}),tgBot['removeListener'](_0x474ee2(0x29a));}));}function loginAccess2FA(_0x360104,_0x3ab10d){const _0x344bb5=_0x31f3f2;tgBot&&settings[_0x344bb5(0x2cb)]&&(tgBot[_0x344bb5(0x1e2)]('callback_query'),tgBot[_0x344bb5(0x290)](settings[_0x344bb5(0x2cb)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x3ab10d)[_0x344bb5(0x1e7)]+_0x344bb5(0x23e),{'parse_mode':_0x344bb5(0x257),'reply_markup':{'inline_keyboard':[[{'text':_0x344bb5(0x266),'callback_data':loginExpiry},{'text':_0x344bb5(0x231),'callback_data':_0x344bb5(0x231)}]]}})['catch'](_0xc182a2=>{telegramError(_0xc182a2);}),tgBot['on'](_0x344bb5(0x29a),async _0x5f23fa=>{const _0xc0cb72=_0x344bb5,_0x4e26f3=_0x5f23fa[_0xc0cb72(0x28f)],_0x4a1a0c=_0x5f23fa[_0xc0cb72(0x222)];tgBot[_0xc0cb72(0x1dd)](_0x5f23fa['id'])[_0xc0cb72(0x19f)](async()=>{const _0x298dae=_0xc0cb72;devices[_0x360104][_0x298dae(0x1c6)]={'clientip':_0x3ab10d,'timestamp':new Date()['getTime'](),'expiry':_0x4e26f3},_0x4e26f3!=_0x298dae(0x231)?(await tgBot[_0x298dae(0x290)](_0x4a1a0c[_0x298dae(0x2a5)]['id'],_0x298dae(0x2c1),{'parse_mode':_0x298dae(0x257)})[_0x298dae(0x2e3)](_0x1007f3=>{telegramError(_0x1007f3);}),io['to'](_0x360104)[_0x298dae(0x1df)](_0x298dae(0x1e9),{'access':{'allow':![],'reason':_0x298dae(0x2c9),'token':null}})):(await tgBot[_0x298dae(0x290)](_0x4a1a0c[_0x298dae(0x2a5)]['id'],_0x298dae(0x2d9))[_0x298dae(0x2e3)](_0x32cb20=>{telegramError(_0x32cb20);}),io['to'](_0x360104)['emit'](_0x298dae(0x1e9),{'access':{'allow':![],'reason':_0x298dae(0x1f6),'token':null}}));}),tgBot[_0xc0cb72(0x1e2)](_0xc0cb72(0x29a));}));}function getConfiguration(){return getBotsWithMode();}function _0x54a8(_0x359739,_0xf004f){const _0x347356=_0x1dcf();return _0x54a8=function(_0x3d17c9,_0x33e380){_0x3d17c9=_0x3d17c9-0x193;let _0x1dcf9d=_0x347356[_0x3d17c9];return _0x1dcf9d;},_0x54a8(_0x359739,_0xf004f);}function getEnabledBots(){const _0x40b3fe=_0x31f3f2;return dbConfig[_0x40b3fe(0x2e1)]('bots')[_0x40b3fe(0x218)](_0x40b3fe(0x1f3))['filter']({'status':'enabled'})['value']()||[];}function getDisabledBots(){const _0x53011a=_0x31f3f2;return dbConfig[_0x53011a(0x2e1)]('bots')['sortBy'](_0x53011a(0x1f3))[_0x53011a(0x23c)]({'status':_0x53011a(0x1a8)})[_0x53011a(0x246)]()||[];}function getBotsWithMode(){const _0x46f9dd=_0x31f3f2,_0x147aee=dbConfig[_0x46f9dd(0x2e1)](_0x46f9dd(0x29d))[_0x46f9dd(0x218)](_0x46f9dd(0x1f3))[_0x46f9dd(0x246)]()||[];return _0x147aee['forEach'](_0x296f79=>{const _0x31c304=_0x46f9dd,_0x540f24=configpath+'bot-'+_0x296f79[_0x31c304(0x1f3)]+_0x31c304(0x22c),_0x928fbc=fs[_0x31c304(0x1fa)](_0x540f24);if(_0x928fbc){const _0x19e74e=fs['readFileSync'](_0x540f24);try{const _0x38dcbd=JSON[_0x31c304(0x1ea)](_0x19e74e),_0x24ae10=_0x38dcbd?_0x38dcbd[_0x31c304(0x2a0)][0x0][_0x31c304(0x23d)]:![];_0x296f79[_0x31c304(0x1ec)]=_0x24ae10?_0x31c304(0x20e):_0x31c304(0x2b5);}catch(_0x5b22e7){_0x296f79['mode']=_0x31c304(0x2b5);}}else _0x296f79[_0x31c304(0x1ec)]='manual';}),_0x147aee;}function getSettings(){const _0x2540b9=_0x31f3f2;return dbSettings['get']('settings')[_0x2540b9(0x246)]()||{'timeshift':0x0};}function getSecure(){const _0xb1fff6=_0x31f3f2;return dbSecure[_0xb1fff6(0x2e1)](_0xb1fff6(0x1ce))[_0xb1fff6(0x246)]()||{};}function getBlacklist(){const _0x46ec6c=_0x31f3f2;return dbSecure[_0x46ec6c(0x2e1)](_0x46ec6c(0x286))[_0x46ec6c(0x246)]()||[];}function broadcastToBots(_0x5465f0,_0x498d23){const _0x4ece78=_0x31f3f2;config[_0x4ece78(0x271)](_0x1eb4f7=>{const _0x28b8b8=_0x4ece78;if(_0x1eb4f7[_0x28b8b8(0x1e9)]==_0x28b8b8(0x2de)&&_0x1eb4f7[_0x28b8b8(0x278)]=='running'){if(pid[_0x1eb4f7[_0x28b8b8(0x1f3)]])pid[_0x1eb4f7[_0x28b8b8(0x1f3)]][_0x28b8b8(0x2c0)]({[_0x5465f0]:_0x498d23});}});}function storeSettings(_0x109e7d,_0x4d6b25=![]){const _0x4f6ef6=_0x31f3f2;_0x109e7d={...settings,..._0x109e7d};if(_0x4d6b25&&_0x109e7d['bbPassword']!=_0x4f6ef6(0x28a)&&_0x109e7d[_0x4f6ef6(0x1ae)]!=''){const _0x1eaaac=crypt['decrypt'](secure[_0x4f6ef6(0x1ca)],_0x109e7d[_0x4f6ef6(0x1ae)])[_0x4f6ef6(0x222)][_0x4f6ef6(0x27a)]('@')[0x0],_0xe73423=bcrypt[_0x4f6ef6(0x298)](_0x1eaaac,saltRounds);_0x109e7d={..._0x109e7d,'bbPassword':_0xe73423};}if(_0x4d6b25&&_0x109e7d[_0x4f6ef6(0x2c5)]!='************'&&_0x109e7d['telegramToken']!=''){const _0x3d7b51=crypt[_0x4f6ef6(0x1f0)](secure[_0x4f6ef6(0x1ca)],_0x109e7d[_0x4f6ef6(0x2c5)])[_0x4f6ef6(0x222)][_0x4f6ef6(0x27a)]('@')[0x0];_0x109e7d={..._0x109e7d,'telegramToken':_0x3d7b51};}const _0x5d08ee=_0x109e7d[_0x4f6ef6(0x2c5)]!=_0x4f6ef6(0x28a)&&_0x109e7d['telegramToken']!=settings[_0x4f6ef6(0x2c5)]||_0x109e7d[_0x4f6ef6(0x2c7)]!=settings[_0x4f6ef6(0x2c7)],_0x1f3786=_0x109e7d[_0x4f6ef6(0x2c5)]==''||_0x109e7d[_0x4f6ef6(0x2c7)]=='';if(_0x5d08ee)_0x109e7d['telegramEvents']=_0x4f6ef6(0x2b0);for(const [_0x20589d,_0x261ce7]of Object[_0x4f6ef6(0x26c)](_0x109e7d)){if(_0x20589d==_0x4f6ef6(0x2c5)&&_0x261ce7==_0x4f6ef6(0x28a)){_0x109e7d[_0x4f6ef6(0x2c5)]=settings[_0x4f6ef6(0x2c5)];continue;};if(_0x20589d==_0x4f6ef6(0x1ae)&&_0x261ce7==_0x4f6ef6(0x28a)){_0x109e7d[_0x4f6ef6(0x1ae)]=settings['bbPassword'];continue;};dbSettings[_0x4f6ef6(0x1ab)](_0x4f6ef6(0x1ed)+_0x20589d,_0x261ce7)[_0x4f6ef6(0x267)]();}settings=_0x109e7d,io['to']('botmanager')[_0x4f6ef6(0x1df)]('settings',cleanSettings()),broadcastToBots(_0x4f6ef6(0x269),settings[_0x4f6ef6(0x269)]);if(_0x5d08ee&&!_0x1f3786)initTelegram();if(_0x5d08ee&&_0x1f3786)disableTelegram();getAllClients()[_0x4f6ef6(0x271)](_0x458e8e=>{const _0x16a6e2=_0x4f6ef6;getSocket(_0x458e8e['id'])[_0x16a6e2(0x1df)](_0x16a6e2(0x1e9),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x40782a,_0x40feae){const _0x3c70d9=_0x31f3f2;dbSettings[_0x3c70d9(0x1ab)](_0x3c70d9(0x1ed)+_0x40782a,_0x40feae)[_0x3c70d9(0x267)](),settings=getSettings(),io['to'](_0x3c70d9(0x226))[_0x3c70d9(0x1df)](_0x3c70d9(0x275),cleanSettings());}function storeSecure(_0xcecc34){const _0x3775d3=_0x31f3f2;dbSecure['get']('secure')[_0x3775d3(0x27f)](_0xcecc34)[_0x3775d3(0x267)](),secure=_0xcecc34;}function addBlacklist(_0x439563){const _0x5134c4=_0x31f3f2;cleanBlacklist();let _0x24bdd6;devices[_0x439563][_0x5134c4(0x2aa)]?_0x24bdd6=Math['max'](devices[_0x439563]['telegramIpApproval'][_0x5134c4(0x27e)],loginExpiry):_0x24bdd6=loginExpiry,dbSecure[_0x5134c4(0x2e1)](_0x5134c4(0x286))['push']({'expiry':new Date()[_0x5134c4(0x2a2)]()+_0x24bdd6*0x3c*0x3e8,'token':devices[_0x439563][_0x5134c4(0x22d)][_0x5134c4(0x273)]})['write'](),blacklist=dbSecure[_0x5134c4(0x2e1)](_0x5134c4(0x286))[_0x5134c4(0x246)]();}function cleanBlacklist(){const _0x2edab5=_0x31f3f2;let _0x19ed2e=dbSecure[_0x2edab5(0x2e1)](_0x2edab5(0x286))[_0x2edab5(0x2db)]()['value'](),_0x2e778a=new Date()[_0x2edab5(0x2a2)]();_0x19ed2e[_0x2edab5(0x271)](_0x1a0c2d=>{const _0x44221c=_0x2edab5;_0x1a0c2d[_0x44221c(0x27e)]<_0x2e778a&&dbSecure['get'](_0x44221c(0x286))['remove']({'expiry':_0x1a0c2d[_0x44221c(0x27e)]})[_0x44221c(0x267)]();});}function initStates(){const _0x399cd1=_0x31f3f2;let _0x2c39b7=getConfiguration();_0x2c39b7[_0x399cd1(0x271)](_0x5eb34a=>{const _0x48e0c0=_0x399cd1;_0x5eb34a[_0x48e0c0(0x278)]=_0x48e0c0(0x270);}),storeConfiguration(_0x2c39b7);}function onKeys(){const _0x47eab2=new RSA();return new Promise(_0x3d872d=>{const _0x333bfe=_0x54a8;_0x47eab2[_0x333bfe(0x213)]()[_0x333bfe(0x19f)](_0xe8e406=>{_0x3d872d(_0xe8e406);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x46a0dc=_0x31f3f2;let _0x300bae=getConfiguration(),_0x6a10c=![];_0x300bae[_0x46a0dc(0x271)](_0x20cf4a=>{const _0x3d9d3c=_0x46a0dc;if(_0x20cf4a[_0x3d9d3c(0x1e9)]==_0x3d9d3c(0x1e0))_0x20cf4a[_0x3d9d3c(0x1e9)]=_0x3d9d3c(0x2de),_0x6a10c=!![];else _0x20cf4a[_0x3d9d3c(0x1e9)]==_0x3d9d3c(0x270)&&(_0x20cf4a[_0x3d9d3c(0x1e9)]=_0x3d9d3c(0x1a8),_0x6a10c=!![]);});if(_0x6a10c)storeConfiguration(_0x300bae);let _0x5673da=getSecure();if(!_0x5673da[_0x46a0dc(0x20a)](_0x46a0dc(0x1cf))){let _0x37679f=await generateKeys();_0x5673da[_0x46a0dc(0x21b)]=_0x37679f[_0x46a0dc(0x21b)],_0x5673da[_0x46a0dc(0x1ca)]=_0x37679f[_0x46a0dc(0x1ca)],_0x5673da['secret']=crypto[_0x46a0dc(0x214)](0x20)[_0x46a0dc(0x29e)](_0x46a0dc(0x2a3));;storeSecure(_0x5673da);}let _0x1307cb=getSettings();_0x6a10c=![];!_0x1307cb[_0x46a0dc(0x20a)](_0x46a0dc(0x25c))&&(_0x1307cb[_0x46a0dc(0x25c)]=![],_0x1307cb[_0x46a0dc(0x279)]='',_0x1307cb[_0x46a0dc(0x1ae)]='',_0x1307cb[_0x46a0dc(0x2e8)]=![],_0x6a10c=!![]);!_0x1307cb[_0x46a0dc(0x20a)](_0x46a0dc(0x241))&&(_0x1307cb[_0x46a0dc(0x241)]=![],_0x1307cb['whitelist']=[],_0x1307cb[_0x46a0dc(0x20f)]=![],_0x6a10c=!![]);if(!_0x1307cb[_0x46a0dc(0x20a)](_0x46a0dc(0x2da))){if(_0x1307cb['telegramChatId'])_0x1307cb[_0x46a0dc(0x2da)]=!![];else _0x1307cb[_0x46a0dc(0x2da)]=![];_0x6a10c=!![];}if(_0x6a10c)storeSettings(_0x1307cb);}function storeConfiguration(_0xe80d79){const _0x52f677=_0x31f3f2;dbConfig[_0x52f677(0x2e1)](_0x52f677(0x29d))['remove']()['write'](),_0xe80d79[_0x52f677(0x271)](_0x36f099=>{delete _0x36f099['mode'];}),dbConfig[_0x52f677(0x2e1)](_0x52f677(0x29d))[_0x52f677(0x27f)](..._0xe80d79)[_0x52f677(0x267)](),config=_0xe80d79;}function resetPassword(){const _0x68353b=_0x31f3f2;tgBot&&settings[_0x68353b(0x2cb)]&&(tgBot[_0x68353b(0x1e2)](_0x68353b(0x29a)),tgBot[_0x68353b(0x290)](settings['telegramChatId'],_0x68353b(0x2bb),{'parse_mode':_0x68353b(0x257),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x68353b(0x2e3)](_0x56e5ad=>{telegramError(_0x56e5ad);}),tgBot['on']('callback_query',async _0xb8bad5=>{const _0x2e4b55=_0x68353b,_0x1d1ad5=_0xb8bad5[_0x2e4b55(0x28f)],_0x1bfcc7=_0xb8bad5['message'];tgBot[_0x2e4b55(0x1dd)](_0xb8bad5['id'])[_0x2e4b55(0x19f)](async()=>{const _0xb70f3d=_0x2e4b55;if(_0x1d1ad5!='no'){const _0x43d3e1=0xf,_0x561233=_0xb70f3d(0x1e5),_0x38e68b=Array[_0xb70f3d(0x1fb)](crypto[_0xb70f3d(0x2c4)](new Uint32Array(_0x43d3e1)))['map'](_0x18b511=>_0x561233[_0x18b511%_0x561233['length']])[_0xb70f3d(0x205)](''),_0x3e8538=bcrypt['hashSync'](_0x38e68b,saltRounds);storeSettings({'bbPassword':_0x3e8538}),await tgBot[_0xb70f3d(0x290)](_0x1bfcc7['chat']['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x38e68b,{'parse_mode':_0xb70f3d(0x257)})['catch'](_0x5e4055=>{telegramError(_0x5e4055);});}else await tgBot[_0xb70f3d(0x290)](_0x1bfcc7[_0xb70f3d(0x2a5)]['id'],'Password\x20reset\x20rejected')[_0xb70f3d(0x2e3)](_0x32225e=>{telegramError(_0x32225e);});}),tgBot[_0x2e4b55(0x1e2)](_0x2e4b55(0x29a));}));}function logging(_0x38f2fd){const _0x594753=_0x31f3f2;console['log'](getTimeStamp()+_0x594753(0x2e5)+_0x38f2fd);if(tgBot&&settings['telegramChatId']&&settings[_0x594753(0x238)]!=_0x594753(0x1be))tgBot[_0x594753(0x290)](settings[_0x594753(0x2cb)],_0x594753(0x29b)+_0x38f2fd)[_0x594753(0x2e3)](_0x284e93=>{telegramError(_0x284e93);});}function getServerTime(){const _0x3a9009=_0x31f3f2,_0x2f7d80=new Date();return _0x2f7d80[_0x3a9009(0x2a8)]()+'/'+(_0x2f7d80['getMonth']()+0x1)[_0x3a9009(0x29e)]()[_0x3a9009(0x1eb)](0x2,'0')+'/'+_0x2f7d80[_0x3a9009(0x2b4)]()['toString']()[_0x3a9009(0x1eb)](0x2,'0')+'\x20'+_0x2f7d80[_0x3a9009(0x277)]()[_0x3a9009(0x29e)]()['padStart'](0x2,'0')+':'+_0x2f7d80['getMinutes']()['toString']()['padStart'](0x2,'0')+':'+_0x2f7d80['getSeconds']()['toString']()['padStart'](0x2,'0');}function getTimeStamp(){const _0x3d9351=_0x31f3f2,_0x5c3b7a=shiftedTime();return _0x5c3b7a[_0x3d9351(0x2a8)]()+'/'+(_0x5c3b7a[_0x3d9351(0x26e)]()+0x1)[_0x3d9351(0x29e)]()[_0x3d9351(0x1eb)](0x2,'0')+'/'+_0x5c3b7a['getDate']()[_0x3d9351(0x29e)]()[_0x3d9351(0x1eb)](0x2,'0')+'\x20'+_0x5c3b7a['getHours']()[_0x3d9351(0x29e)]()[_0x3d9351(0x1eb)](0x2,'0')+':'+_0x5c3b7a['getMinutes']()['toString']()[_0x3d9351(0x1eb)](0x2,'0')+':'+_0x5c3b7a['getSeconds']()[_0x3d9351(0x29e)]()[_0x3d9351(0x1eb)](0x2,'0');}function shiftedTime(){const _0x31ab7c=_0x31f3f2,_0x5baac6=new Date();let _0x36746c=_0x5baac6;if(settings[_0x31ab7c(0x269)]&&settings[_0x31ab7c(0x269)]!==0x0)_0x36746c=fns[_0x31ab7c(0x299)](_0x5baac6,{'hours':settings[_0x31ab7c(0x269)]});return _0x36746c;}function startScheduler(){const _0x19fd7a=_0x31f3f2;let _0x402e0c=new Date()[_0x19fd7a(0x228)]();_0x402e0c==0x1&&backupConfigFiles();_0x402e0c==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x5ab2d3=_0x31f3f2;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x5ab2d3(0x271)](_0x2f26cd=>{const _0x352e78=_0x5ab2d3;if(!_0x2f26cd[_0x352e78(0x263)]())fs[_0x352e78(0x240)](configpath+_0x2f26cd[_0x352e78(0x19c)],configbackuppath+_0x2f26cd[_0x352e78(0x19c)]);});}function triggerAnalytics(){const _0x2f4b86=_0x31f3f2;analytics[_0x2f4b86(0x1e4)]({'title':_0x2f4b86(0x1af),'href':'https://hodlerhacks.com','path':'/v'+serverversion});}function validateCredentials(_0xc0fda4,_0x2d320d){const _0xea5f4=_0x31f3f2;if(_0xc0fda4[_0xea5f4(0x284)]==settings['bbUsername']&&bcrypt[_0xea5f4(0x28b)](_0xc0fda4[_0xea5f4(0x21e)],settings[_0xea5f4(0x1ae)])){if(settings[_0xea5f4(0x2e8)])return{'allow':![],'reason':_0xea5f4(0x26b),'token':null};else{const _0x177b0d=generateLoginToken(_0x2d320d);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x177b0d};}}else return{'allow':![],'reason':_0xea5f4(0x1a9),'token':null};}function refreshToken(_0x2962c3){const _0x276f27=generateLoginToken(_0x2962c3);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x276f27};}function validateAccess(_0xc63173,_0x198dc2){const _0xdb8f5e=_0x31f3f2;let _0x346c88=devices[_0x198dc2]['ip'],_0x174640;const _0x588022=_0x25eafc=>{const _0x2b36c6=_0x54a8;if(settings[_0x2b36c6(0x25c)]){if(settings[_0x2b36c6(0x2e8)]){if(telegram2FaApproved(_0x198dc2)){const _0x124d05=generateLoginToken(_0x198dc2);return{'allow':!![],'reason':_0x2b36c6(0x1f7),'token':_0x124d05};}else return{'allow':![],'reason':_0x2b36c6(0x1c2),'token':null};}else return _0x174640=validToken(_0x25eafc,_0x198dc2),_0x174640['hasOwnProperty'](_0x2b36c6(0x1e3))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x25eafc}:{'allow':![],'reason':_0x2b36c6(0x1c2),'token':null};}else return{'allow':!![],'reason':_0x2b36c6(0x20c),'token':null};};if(settings[_0xdb8f5e(0x241)]){let _0x3f84b8=[...settings[_0xdb8f5e(0x22b)],'::1',_0xdb8f5e(0x2b8),_0xdb8f5e(0x2dc)];if(_0x3f84b8['includes'](_0x346c88))return _0x588022(_0xc63173);else{_0x174640=validToken(_0xc63173,_0x198dc2);if(_0x174640[_0xdb8f5e(0x20a)](_0xdb8f5e(0x1e3)))return _0x588022(_0xc63173);else{if(telegramIpApproved(_0x198dc2)){const _0x3cbf59=generateToken(_0x198dc2);return _0x174640=_0x588022(_0xc63173),_0x174640[_0xdb8f5e(0x264)]?{'allow':!![],'reason':_0xdb8f5e(0x21d),'token':_0x3cbf59}:_0x174640;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0xdb8f5e(0x255),'token':null}:{'allow':![],'reason':_0xdb8f5e(0x24c),'token':null};}}}else return _0x588022(_0xc63173);}function timelyDecrypt(_0x173cde,_0x365770=!![]){const _0x36c6e8=_0x31f3f2;if(_0x173cde)try{const _0x5817bf=crypt[_0x36c6e8(0x1f0)](secure[_0x36c6e8(0x1ca)],_0x173cde)['message'],_0x152af7=_0x5817bf[_0x36c6e8(0x27a)]('@')[0x0],_0xb5ab08=_0x5817bf[_0x36c6e8(0x27a)]('@')[0x1],_0x2577f3=new Date()[_0x36c6e8(0x2a2)]();if(_0x365770){if(_0x2577f3-_0xb5ab08<maxSecretAge*0x3e8)return _0x152af7;else return![];}else return _0x152af7;}catch(_0x70f096){return![];}else return![];}const validToken=(_0x52a350,_0x182735)=>{const _0x3079ed=_0x31f3f2,_0x3d3319=devices[_0x182735]['ip'];if(!_0x52a350)return{'error':_0x3079ed(0x2c3)};for(let _0x9794d0 of blacklist){if(_0x9794d0[_0x3079ed(0x273)]==_0x52a350)return{'error':'Token\x20blacklisted'};}let _0x42bc92;try{_0x42bc92=jwt[_0x3079ed(0x1d2)](_0x52a350,secure[_0x3079ed(0x1cf)]+_0x182735);}catch{return{'error':_0x3079ed(0x259)};}if(!_0x42bc92[_0x3079ed(0x20a)](_0x3079ed(0x1de))&&!_0x42bc92[_0x3079ed(0x20a)](_0x3079ed(0x284))||!_0x42bc92['hasOwnProperty'](_0x3079ed(0x2ac)))return{'error':_0x3079ed(0x203)};if(!_0x42bc92['hasOwnProperty']('username')&&_0x42bc92[_0x3079ed(0x20a)](_0x3079ed(0x1de))){const {clientip:_0xbc911e}=_0x42bc92;return _0x3d3319==_0xbc911e?{'success':_0x3079ed(0x2bd)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x42bc92[_0x3079ed(0x20a)](_0x3079ed(0x284))&&_0x42bc92[_0x3079ed(0x20a)](_0x3079ed(0x1de))){const {username:_0x448403,clientip:_0x21a1c4}=_0x42bc92;return settings[_0x3079ed(0x279)]==_0x448403&&_0x3d3319==_0x21a1c4?{'success':_0x3079ed(0x2bd)}:{'error':_0x3079ed(0x1d0)};}}},generateLoginToken=_0x4fd16f=>{const _0x3a9321=_0x31f3f2;if(_0x4fd16f){const _0xe01e74=devices[_0x4fd16f]['ip'];return jwt[_0x3a9321(0x1e8)]({'username':settings[_0x3a9321(0x279)],'clientip':_0xe01e74},secure[_0x3a9321(0x1cf)]+_0x4fd16f,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x52d155=>{const _0x18f4b6=_0x31f3f2;if(_0x52d155){const _0x4e16ac=devices[_0x52d155]['ip'];return jwt[_0x18f4b6(0x1e8)]({'clientip':_0x4e16ac},secure['secret']+_0x52d155,{'expiresIn':devices[_0x52d155]['telegramIpApproval'][_0x18f4b6(0x27e)]*0x3c});}else return![];},telegramIpApproved=_0x2f00cf=>{const _0x2232b6=_0x31f3f2;let _0x26761a=![];return devices[_0x2f00cf][_0x2232b6(0x2aa)]&&devices[_0x2f00cf][_0x2232b6(0x2aa)][_0x2232b6(0x27e)]!=_0x2232b6(0x231)&&(_0x26761a=devices[_0x2f00cf]['telegramIpApproval'][_0x2232b6(0x1de)]==devices[_0x2f00cf]['ip']&&new Date()[_0x2232b6(0x2a2)]()-devices[_0x2f00cf]['telegramIpApproval'][_0x2232b6(0x276)]<devices[_0x2f00cf][_0x2232b6(0x2aa)]['expiry']*0x3c*0x3e8),_0x26761a;},telegram2FaApproved=_0x121f06=>{const _0x1e955f=_0x31f3f2;let _0x3af8f2=![];return devices[_0x121f06][_0x1e955f(0x1c6)]&&devices[_0x121f06][_0x1e955f(0x1c6)]['expiry']!=_0x1e955f(0x231)&&(_0x3af8f2=devices[_0x121f06][_0x1e955f(0x1c6)][_0x1e955f(0x1de)]==devices[_0x121f06]['ip']&&new Date()[_0x1e955f(0x2a2)]()-devices[_0x121f06]['telegram2FaApproval'][_0x1e955f(0x276)]<devices[_0x121f06]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x3af8f2;},normalizeIP=_0x1748bd=>{const _0x4f5f79=_0x31f3f2;let _0x5c3b54=null,_0x3f6200=null;if(ipaddr['isValid'](_0x1748bd)){const _0x3a3548=ipaddr['parse'](_0x1748bd);_0x3a3548[_0x4f5f79(0x1d7)]()==='ipv6'?(_0x3a3548['isIPv4MappedAddress']()&&(_0x5c3b54=_0x3a3548['toIPv4Address']()['toString']()),_0x3f6200=_0x3a3548[_0x4f5f79(0x29e)]()):(_0x5c3b54=_0x3a3548['toString'](),_0x3f6200=_0x3a3548['toIPv4MappedAddress']()['toString']());}return{'show':_0x5c3b54?_0x5c3b54:_0x3f6200,'store':_0x3f6200};};