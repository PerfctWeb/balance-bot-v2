const _0x3ee32c=_0x6419;(function(_0x277d65,_0x3cd26d){const _0x8487a0=_0x6419,_0x1e2f97=_0x277d65();while(!![]){try{const _0x4b1893=parseInt(_0x8487a0(0x2a4))/0x1+-parseInt(_0x8487a0(0x19d))/0x2+parseInt(_0x8487a0(0x26d))/0x3+parseInt(_0x8487a0(0x1bc))/0x4+-parseInt(_0x8487a0(0x161))/0x5+-parseInt(_0x8487a0(0x296))/0x6*(parseInt(_0x8487a0(0x288))/0x7)+parseInt(_0x8487a0(0x198))/0x8*(-parseInt(_0x8487a0(0x17f))/0x9);if(_0x4b1893===_0x3cd26d)break;else _0x1e2f97['push'](_0x1e2f97['shift']());}catch(_0x70d74e){_0x1e2f97['push'](_0x1e2f97['shift']());}}}(_0xce43,0xb243d));const _0xb54dc7=function(){let _0x46c86a=!![];return function(_0x542398,_0x2452f2){const _0x23e5ba=_0x46c86a?function(){const _0x5ec15c=_0x6419;if(_0x2452f2){const _0x789172=_0x2452f2[_0x5ec15c(0x199)](_0x542398,arguments);return _0x2452f2=null,_0x789172;}}:function(){};return _0x46c86a=![],_0x23e5ba;};}(),_0x286622=_0xb54dc7(this,function(){const _0x301b44=_0x6419;return _0x286622[_0x301b44(0x1f5)]()[_0x301b44(0x24c)]('(((.+)+)+)+$')[_0x301b44(0x1f5)]()[_0x301b44(0x237)](_0x286622)[_0x301b44(0x24c)](_0x301b44(0x1b2));});_0x286622();'use strict';process[_0x3ee32c(0x1cb)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x3ee32c(0x1f4)),FileSync=require(_0x3ee32c(0x1c8)),fs=require('fs'),fns=require('date-fns'),low=require(_0x3ee32c(0x1a1)),path=require(_0x3ee32c(0x20e)),crypto=require(_0x3ee32c(0x247)),Crypt=require(_0x3ee32c(0x175))[_0x3ee32c(0x1cc)],RSA=require(_0x3ee32c(0x175))[_0x3ee32c(0x192)],bcrypt=require(_0x3ee32c(0x232)),jwt=require(_0x3ee32c(0x1e2)),analyticsLib=require(_0x3ee32c(0x214))[_0x3ee32c(0x208)],googleAnalytics=require('@analytics/google-analytics')['default'],ipaddr=require(_0x3ee32c(0x1d2)),argv=require(_0x3ee32c(0x1b5))(process[_0x3ee32c(0x291)][_0x3ee32c(0x1c3)](0x2))['argv'],PORT=argv[_0x3ee32c(0x177)]||_0x3ee32c(0x1cd),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x3ee32c(0x252)](PORT))return console['log'](_0x3ee32c(0x23e)+PORT+_0x3ee32c(0x1ec)),process[_0x3ee32c(0x276)](0x1);const HOST=argv[_0x3ee32c(0x268)]||null,userID=argv[_0x3ee32c(0x285)]||'';let bbpath='bb/',bbpath2='';const botfile=_0x3ee32c(0x1ce),configfile='bb-config.json',settingsfile='bb-settings.json',securefile='bb-secure.json';!fs[_0x3ee32c(0x265)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3ee32c(0x196)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x3ee32c(0x263),configbackuppath=configpath+_0x3ee32c(0x1eb);!fs[_0x3ee32c(0x265)](configpath)&&fs[_0x3ee32c(0x1ee)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x3ee32c(0x1ee)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x3ee32c(0x1a2)]({'bots':[]})[_0x3ee32c(0x166)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3ee32c(0x1a2)]({'settings':{'timeshift':0x0}})['write']();function _0xce43(){const _0x347afe=['showname','telegramEnabled','get-portfolio','constructor','Unauthorized\x20attempt\x20to\x20update\x20bot','stopPolling','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','readdirSync','push','stopped','Error:\x20Invalid\x20argument\x20','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','/disable\x20-\x20disable\x20notifications\x0a','padStart','referer','storeConfiguration','disconnect','telegramUsername','Temporary\x20access\x20rejected','crypto','then','temporary\x20token\x20generated','filter','getMinutes','search','conn','set','restarting\x20Bot\x20','telegramEvents','version.json','test','bot-','logout','version','page','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Login\x20rejected','uuid','login\x20token\x20valid','30\x20min','HTML','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','pidRefreshToken','socket.io','map','toIPv4MappedAddress','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','config/','stop','existsSync','find','getFullYear','host','order','secure','login\x20required','Password\x20has\x20been\x20reset\x20to:\x20','3891429suPnOl','password','function','use','connection','-results.json','join','telegram2FaApproval','getDate','exit','status','hasOwnProperty','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','connected','bbUsername','************','access','pidExpireLogin','-config.json','127.0.0.1','login','botname','\x20only\x0a','Bot\x20','user','No\x20authentication\x20token','event','245eUDbyu','timestamp','headers','initclient','getMonth','ipc','build','settings.','send','argv','login\x20token\x20generated','show','compareSync','sortBy','87762mVtFgk','remove','reason','All\x20bots','timeshift','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','error\x20while\x20deleting\x20config\x20files:\x20','apiKey','max','store-configuration','Notifications\x20disabled\x0a','<b>Telegram\x20bot\x20status:</b>\x0a','success','express','1071670dCghES','bots','124155hQjPLi','auth','sockets','generateKeyPairAsync','2FA\x20login\x20rejected','write','sign','store-headless','getPortfolio','from','telegramChatId','1000','get-starting-balances','logged\x20out','invalid\x20credentials','temporary\x20access\x20not\x20allowed','404\x20Not\x20Found','emit','Alerts','handshake','hybrid-crypto-js','store','port','notification','new','kill','token','Balance\x20Bot','Notifications\x20types:\x20','username','980253FMkFdO','Password\x20reset\x20rejected','randomFillSync','log','/status\x20-\x20show\x20bot(s)\x20status\x0a','-performance.json','/:bot/portfolio','cancelLoading','SIGINT','Token\x20blacklisted','UA-192771731-1','get-logs','hashSync','add-bot','/:bot','Orders','reject','Invalid\x20authentication\x20token\x20(1)','/:bot/coins','RSA','removeListener','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','assign','clients','Unauthorized\x20login\x20attempt\x20(timeout)','8koCbde','apply','allow','Notifications\x20disabled','Invalid\x20authentication\x20token\x20(2)','2686512JfcTad','Invalid\x20username\x20or\x20IP\x20address','privateKey','value','lowdb','defaults','includes','secret','chat','get','temporary\x20access\x20rejected','answerCallbackQuery','orders','removeAllListeners','remoteAddress','inherit','started','Unauthorized\x20attempt\x20to\x20store\x20configuration','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','whitelistEnabled','publicKey','(((.+)+)+)+$','catch','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','yargs/yargs','2FA\x20login\x20required',':\x20Bot\x20Mgr\x20>\x20','yes','<b>Balance\x20Bot\x20status:</b>\x0a','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','1401236rSiGwg','reset-password','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','botmanager','botID','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','static','slice','sendFile','ipv6','telegramToken','telegram','lowdb/adapters/FileSync','sendMessage','message','env','Crypt','3000','bot.js','storeHeadless','/:bot/configuration','server','ipaddr.js','/enable\x20-\x20enable\x20notifications\x0a','enabled','forEach','All\x20bots\x20running\x20right\x20now','Invalid\x20IP\x20address','enabled\x20Bot\x20','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','kind','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','getStartingBalances','add','index.html','Ok,\x20will\x20send\x20alert\x20notifications\x20only','\x20minutes','starting\x20bot\x20|\x20Bot\x20','jsonwebtoken','reload','encryptedUuid','accept','length','whitelist','alerts','clientip','emitHistory','backup/',',\x20must\x20be\x20a\x204\x20digit\x20number','match','mkdirSync','store-settings','Unauthorized\x20attempt\x20to\x20log\x20out','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','callback_query','split','child_process','toString','update-bot','node-telegram-bot-api','Invalid\x20Telegram\x20token','running','live','place-order','exp','createServer','getTime','Access\x20enabled\x20for\x20','hex','login\x20not\x20required','bbPassword','</b>\x20?','loginRequired','expiry','isValid','f2aRequired','default','keys','type','temporary\x20access\x20timeout','disabled','Balance\x20Bot\x20Server','path','\x20|\x20','idling\x20bot\x20\x20\x20|\x20Bot\x20','verify','-----------------------------------------------------------------------------------','decrypt','analytics','all','2FA\x20login\x20token\x20generated','settings','2FA\x20required','blacklist','getHours','Allow\x20login\x20from\x20IP\x20address\x20<b>','You\x20can\x20use\x20the\x20following\x20commands:\x0a','entries','access\x20timeout','new-disabled','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','No\x20bots\x20running\x20right\x20now','Unauthorized\x20attempt\x20to\x20update\x20settings','onText','fork','/:bot/history','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','telegramIpApproval','restart','\x20>\x20','error','data','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','User\x20has\x20been\x20validated','getSeconds','unlinkSync','copyFileSync','bcryptjs','cancel-loading'];_0xce43=function(){return _0x347afe;};return _0xce43();}const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x3ee32c(0x166)]();let crypt=new Crypt({'md':'sha256','rsaStandard':'RSA-OAEP'});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x3ee32c(0x251))[_0x3ee32c(0x255)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];oneTimeMigration(),cleanBlacklist();const express=require(_0x3ee32c(0x2a3)),app=express(),http=require('http')[_0x3ee32c(0x1fd)](app);app['use'](express['static'](path[_0x3ee32c(0x273)](__dirname,bbpath2,'build2'))),app[_0x3ee32c(0x270)](express[_0x3ee32c(0x1c2)](path[_0x3ee32c(0x273)](__dirname,bbpath2,_0x3ee32c(0x28e)))),app['get']('/',function(_0x508700,_0x1295ef){const _0xd3c9a6=_0x3ee32c;_0x1295ef[_0xd3c9a6(0x1c4)](path[_0xd3c9a6(0x273)](__dirname,bbpath2,'build2',_0xd3c9a6(0x1de)));}),app[_0x3ee32c(0x1a6)](_0x3ee32c(0x18d),function(_0x1b781a,_0x7f6bc4){const _0x516ebc=_0x3ee32c;_0x7f6bc4[_0x516ebc(0x1c4)](path['join'](__dirname,bbpath2,_0x516ebc(0x28e),_0x516ebc(0x1de)));}),app['get'](_0x3ee32c(0x185),(_0x4a3435,_0x28a9ab)=>{const _0x760d9c=_0x3ee32c;_0x28a9ab[_0x760d9c(0x1c4)](path[_0x760d9c(0x273)](__dirname,bbpath2,_0x760d9c(0x28e),_0x760d9c(0x1de)));}),app[_0x3ee32c(0x1a6)]('/:bot/performance',(_0x304dc6,_0x55c2f)=>{const _0x4fc0b7=_0x3ee32c;_0x55c2f['sendFile'](path[_0x4fc0b7(0x273)](__dirname,bbpath2,'build',_0x4fc0b7(0x1de)));}),app[_0x3ee32c(0x1a6)](_0x3ee32c(0x191),(_0x398e42,_0xe6f1ae)=>{const _0x2e5086=_0x3ee32c;_0xe6f1ae[_0x2e5086(0x1c4)](path[_0x2e5086(0x273)](__dirname,bbpath2,'build','index.html'));}),app[_0x3ee32c(0x1a6)](_0x3ee32c(0x225),(_0x1f79f4,_0x349cac)=>{const _0x502f7b=_0x3ee32c;_0x349cac[_0x502f7b(0x1c4)](path['join'](__dirname,bbpath2,_0x502f7b(0x28e),'index.html'));}),app['get'](_0x3ee32c(0x1d0),(_0x13e4a6,_0x4f1ae7)=>{const _0x40954d=_0x3ee32c;_0x4f1ae7[_0x40954d(0x1c4)](path[_0x40954d(0x273)](__dirname,bbpath2,'build',_0x40954d(0x1de)));}),app[_0x3ee32c(0x1a6)]('/:bot/support',(_0x201099,_0x3f2463)=>{const _0x30bed9=_0x3ee32c;_0x3f2463[_0x30bed9(0x1c4)](path['join'](__dirname,bbpath2,_0x30bed9(0x28e),_0x30bed9(0x1de)));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require(_0x3ee32c(0x25f))(http,{}),analytics=analyticsLib({'app':_0x3ee32c(0x17c),'plugins':[googleAnalytics({'trackingId':_0x3ee32c(0x189)})]}),TelegramBot=require(_0x3ee32c(0x1f7));let tgBot;if(settings[_0x3ee32c(0x1c6)]&&settings['telegramToken']!=''&&settings[_0x3ee32c(0x245)]&&settings['telegramUsername']!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x9161c6=_0x3ee32c;console[_0x9161c6(0x182)](''),console[_0x9161c6(0x182)](_0x9161c6(0x212)),logging('Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:'+PORT),console['log']('-----------------------------------------------------------------------------------');if(config[_0x9161c6(0x1e6)]!=0x0)config[_0x9161c6(0x1d5)](_0x25cb67=>{const _0x122b25=_0x9161c6;if(_0x25cb67[_0x122b25(0x277)]==_0x122b25(0x1d4)||_0x25cb67['status']=='new')logging(_0x122b25(0x1e1)+_0x25cb67[_0x122b25(0x1c0)]+_0x122b25(0x20f)+_0x25cb67[_0x122b25(0x282)]),startBot([_0x25cb67[_0x122b25(0x1c0)],userID],{'cwd':bbpath},function(_0x12ef9b){if(_0x12ef9b)logging(_0x12ef9b);});else(_0x25cb67[_0x122b25(0x277)]==_0x122b25(0x20c)||_0x25cb67['status']==_0x122b25(0x21f))&&logging(_0x122b25(0x210)+_0x25cb67[_0x122b25(0x1c0)]+_0x122b25(0x20f)+_0x25cb67[_0x122b25(0x282)]);});else!newBot&&console['log'](_0x9161c6(0x23f));if(newBot)addBot();console[_0x9161c6(0x182)](_0x9161c6(0x212)),console['log']('');}function startSocket(){const _0x28c356=_0x3ee32c;io['on'](_0x28c356(0x271),_0x51f036=>{const _0x544f1c=_0x28c356;let _0x599801,_0xda20ae,_0x5a6454,_0x32996a,_0x579319;const _0xbbc69b=_0x51f036[_0x544f1c(0x174)][_0x544f1c(0x28a)][_0x544f1c(0x242)];_0xda20ae=_0xbbc69b[_0x544f1c(0x1ed)](/bot[0-9]{3}/);if(_0xda20ae)_0x5a6454=_0xda20ae[0x0]['match'](/[0-9]{3}/);if(_0x5a6454)_0x599801=_0x5a6454[0x0];else _0x599801=_0x544f1c(0x1bf);const _0x2703fa=_0x51f036[_0x544f1c(0x174)][_0x544f1c(0x162)][_0x544f1c(0x1e4)];if(!_0x2703fa)_0x51f036[_0x544f1c(0x172)](_0x544f1c(0x277),{'publicKey':secure[_0x544f1c(0x1b1)]});else{_0x32996a=timelyDecrypt(_0x2703fa,![]);if(!_0x32996a)_0x51f036['emit'](_0x544f1c(0x277),{'publicKey':secure['publicKey']});else{_0x579319=normalizeIP(_0x51f036[_0x544f1c(0x24d)][_0x544f1c(0x1ab)])[_0x544f1c(0x176)];if(!devices[_0x32996a])devices[_0x32996a]={'uuid':_0x32996a,'access':{'token':null}};devices[_0x32996a]['ip']=_0x579319;const _0x379421=addClient(_0x51f036['id'],_0x32996a,_0x599801);setAccess(_0x379421),_0x51f036['on'](_0x544f1c(0x281),_0x564bec=>{const _0x11f3a9=_0x544f1c,_0xde5ae2=timelyDecrypt(_0x564bec[_0x11f3a9(0x26e)]);if(_0xde5ae2){_0x564bec={'username':_0x564bec[_0x11f3a9(0x17e)],'password':_0xde5ae2},devices[_0x32996a]['access']=validateCredentials(_0x564bec,_0x32996a);if(devices[_0x32996a][_0x11f3a9(0x27d)][_0x11f3a9(0x19a)]==![]&&devices[_0x32996a][_0x11f3a9(0x27d)][_0x11f3a9(0x298)]==_0x11f3a9(0x1b6))_0x51f036[_0x11f3a9(0x172)]('status',{'access':devices[_0x32996a][_0x11f3a9(0x27d)]}),loginAccess2FA(_0x32996a,_0x579319);else{if(devices[_0x32996a]['access'][_0x11f3a9(0x19a)]==![]&&devices[_0x32996a]['access'][_0x11f3a9(0x298)]==_0x11f3a9(0x16f))_0x51f036['emit'](_0x11f3a9(0x277),{'access':devices[_0x32996a][_0x11f3a9(0x27d)]});else devices[_0x32996a][_0x11f3a9(0x27d)][_0x11f3a9(0x19a)]&&devices[_0x32996a]['access']['reason']==_0x11f3a9(0x292)&&(getClientsWithUuid(_0x32996a)[_0x11f3a9(0x1d5)](_0x2c40dc=>{setAccess(_0x2c40dc);}),setTokenRefresh(_0x32996a),setSessionTimeout(_0x11f3a9(0x281),_0x32996a));}}else logging(_0x11f3a9(0x197));}),_0x51f036['on'](_0x544f1c(0x1bd),()=>{resetPassword();}),_0x51f036['on'](_0x544f1c(0x244),_0x26fb96=>{removeClient(_0x51f036['id']);});}}});}function initClient(_0x29a524){const _0x16b951=_0x3ee32c;if(_0x29a524!=_0x16b951(0x1bf)&&config[_0x16b951(0x29d)]!=''){if(pid[_0x29a524])pid[_0x29a524][_0x16b951(0x290)]({'function':_0x16b951(0x28b),'args':null});}}function getSocket(_0x336638){const _0x4aaf0e=_0x3ee32c;return io[_0x4aaf0e(0x163)][_0x4aaf0e(0x163)][_0x4aaf0e(0x1a6)](_0x336638);}function setAccess(_0x11f42e){const _0x181a97=_0x3ee32c,_0x107193=getSocket(_0x11f42e['id']),_0x3853d8=_0x11f42e[_0x181a97(0x259)],_0x276ced=_0x11f42e['bot'];devices[_0x3853d8][_0x181a97(0x27d)]=validateAccess(devices[_0x3853d8][_0x181a97(0x27d)][_0x181a97(0x17b)],_0x3853d8),_0x107193['join'](_0x3853d8);if(devices[_0x3853d8]['access'][_0x181a97(0x19a)]){_0x107193['join'](_0x276ced);if(_0x276ced==_0x181a97(0x1bf))initializeSocketBotManager(_0x107193);else initializeSocketBot(_0x107193);initClient(_0x276ced);}devices[_0x3853d8][_0x181a97(0x27d)][_0x181a97(0x17b)]&&devices[_0x3853d8][_0x181a97(0x27d)]['reason']=='temporary\x20token\x20generated'&&setSessionTimeout('2FA',_0x3853d8),devices[_0x3853d8][_0x181a97(0x27d)]['token']&&devices[_0x3853d8][_0x181a97(0x27d)][_0x181a97(0x298)]==_0x181a97(0x216)&&setSessionTimeout(_0x181a97(0x281),_0x3853d8),_0x107193[_0x181a97(0x172)]('status',{'status':_0x11f42e[_0x181a97(0x1d1)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x3853d8][_0x181a97(0x27d)],'externalip':devices[_0x3853d8]['ip'],'publicKey':secure[_0x181a97(0x1b1)]}),devices[_0x3853d8][_0x181a97(0x27d)][_0x181a97(0x19a)]==![]&&devices[_0x3853d8]['access'][_0x181a97(0x298)]==_0x181a97(0x218)&&temporaryAccess2FA(_0x3853d8,devices[_0x3853d8]['ip']);}function setSessionTimeout(_0x32b622,_0x345c2b){const _0x2821df=_0x3ee32c;let _0x787fc1;if(_0x32b622=='login')_0x787fc1=loginExpiry*0x3c*0x3e8;else _0x787fc1=devices[_0x345c2b]['telegramIpApproval'][_0x2821df(0x205)]*0x3c*0x3e8-(new Date()[_0x2821df(0x1fe)]()-devices[_0x345c2b]['telegramIpApproval']['timestamp']);if(devices[_0x345c2b][_0x2821df(0x27e)])clearTimeout(devices[_0x345c2b]['pidExpireLogin']);devices[_0x345c2b]['pidExpireLogin']=setTimeout(()=>{const _0x546ba6=_0x2821df;if(devices[_0x345c2b][_0x546ba6(0x25e)])clearTimeout(devices[_0x345c2b][_0x546ba6(0x25e)]);removeSocketListeners(_0x345c2b),addBlacklist(_0x345c2b),devices[_0x345c2b][_0x546ba6(0x228)]=null,devices[_0x345c2b][_0x546ba6(0x274)]=null,devices[_0x345c2b][_0x546ba6(0x27d)][_0x546ba6(0x17b)]=null,devices[_0x345c2b][_0x546ba6(0x27d)]=validateAccess(devices[_0x345c2b]['access']['token'],_0x345c2b),!(devices[_0x345c2b][_0x546ba6(0x27d)]['allow']&&devices[_0x345c2b][_0x546ba6(0x27d)][_0x546ba6(0x298)]==_0x546ba6(0x201))&&(_0x32b622==_0x546ba6(0x281)?io['to'](_0x345c2b)[_0x546ba6(0x172)](_0x546ba6(0x277),{'access':{'allow':![],'reason':_0x546ba6(0x21e),'token':null}}):io['to'](_0x345c2b)[_0x546ba6(0x172)](_0x546ba6(0x277),{'access':{'allow':![],'reason':_0x546ba6(0x20b),'token':null}})),devices[_0x345c2b]['access'][_0x546ba6(0x17b)]=null;},_0x787fc1);}function setTokenRefresh(_0x4f0958){const _0x20737e=_0x3ee32c;if(devices[_0x4f0958][_0x20737e(0x25e)])clearTimeout(devices[_0x4f0958]['pidRefreshToken']);devices[_0x4f0958][_0x20737e(0x25e)]=setTimeout(()=>{const _0x426355=_0x20737e;getClientsWithUuid(_0x4f0958)[_0x426355(0x1e6)]!=0x0?(devices[_0x4f0958]['access']=refreshToken(_0x4f0958),io['to'](_0x4f0958)['emit'](_0x426355(0x277),{'status':_0x426355(0x27a),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x4f0958][_0x426355(0x27d)],'externalip':devices[_0x4f0958]['ip'],'publicKey':secure['publicKey']}),setTokenRefresh(_0x4f0958)):clearTimeout(devices[_0x4f0958][_0x426355(0x25e)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x522cb6){const _0x2b2c3b=_0x3ee32c,_0x2cf3bb=getClient(_0x522cb6['id'])['uuid'];_0x522cb6[_0x2b2c3b(0x172)](_0x2b2c3b(0x160),config),_0x522cb6['emit'](_0x2b2c3b(0x217),cleanSettings()),_0x522cb6['on'](_0x2b2c3b(0x18c),_0x26150b=>{const _0x440299=_0x2b2c3b;if(validateAccess(_0x26150b,_0x2cf3bb)[_0x440299(0x19a)])addBot();else logging('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x522cb6['on'](_0x2b2c3b(0x1f6),(_0x1e40ac,_0x56ed72)=>{const _0x2693f6=_0x2b2c3b;if(validateAccess(_0x56ed72,_0x2cf3bb)[_0x2693f6(0x19a)])toggleBot(_0x1e40ac[_0x2693f6(0x1c0)],_0x1e40ac[_0x2693f6(0x277)],_0x1e40ac[_0x2693f6(0x1fa)]);else logging(_0x2693f6(0x238));}),_0x522cb6['on']('delete-bot',(_0x3d012d,_0x3be183)=>{const _0x4f349a=_0x2b2c3b;if(validateAccess(_0x3be183,_0x2cf3bb)[_0x4f349a(0x19a)])deleteBot(_0x3d012d);else logging('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x522cb6['on'](_0x2b2c3b(0x1ef),(_0x27a97f,_0x3e2ea3)=>{const _0x154c1d=_0x2b2c3b;if(validateAccess(_0x3e2ea3,_0x2cf3bb)[_0x154c1d(0x19a)])storeSettings(_0x27a97f,!![]);else logging(_0x154c1d(0x222));}),_0x522cb6['on']('update-bb',(_0x3b02b9,_0x246273)=>{const _0xe6d58c=_0x2b2c3b;if(validateAccess(_0x246273,_0x2cf3bb)[_0xe6d58c(0x19a)])updateBB();else logging(_0xe6d58c(0x222));}),_0x522cb6['on']('logout',_0x6f5ba4=>{const _0x44b7be=_0x2b2c3b;if(validateAccess(_0x6f5ba4,_0x2cf3bb)['allow']){if(devices[_0x2cf3bb][_0x44b7be(0x25e)])clearTimeout(devices[_0x2cf3bb]['pidRefreshToken']);if(devices[_0x2cf3bb][_0x44b7be(0x27e)])clearTimeout(devices[_0x2cf3bb][_0x44b7be(0x27e)]);removeSocketListeners(getClient(_0x522cb6['id'])[_0x44b7be(0x259)]),addBlacklist(_0x2cf3bb),devices[_0x2cf3bb][_0x44b7be(0x228)]=null,devices[_0x2cf3bb][_0x44b7be(0x274)]=null,devices[_0x2cf3bb][_0x44b7be(0x27d)][_0x44b7be(0x17b)]=null,io['to'](getClient(_0x522cb6['id'])[_0x44b7be(0x259)])[_0x44b7be(0x172)](_0x44b7be(0x277),{'access':{'allow':![],'reason':_0x44b7be(0x16e),'token':null}});}else logging(_0x44b7be(0x1f0));});}function initializeSocketBot(_0x1041ed){const _0x491063=_0x3ee32c,_0x4e8e20=getClient(_0x1041ed['id'])['bot'],_0x1d968f=getClient(_0x1041ed['id'])['uuid'];_0x1041ed['on'](_0x491063(0x18a),(_0x59e04d,_0x4c7c2e)=>{const _0x11a13d=_0x491063;if(validateAccess(_0x4c7c2e,_0x1d968f)[_0x11a13d(0x19a)]){if(pid[_0x4e8e20])pid[_0x4e8e20][_0x11a13d(0x290)]({'function':_0x11a13d(0x1ea),'args':_0x59e04d});}else logging('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0x1041ed['on'](_0x491063(0x236),(_0x38f7bd,_0x5882f9)=>{const _0x41afee=_0x491063;if(validateAccess(_0x5882f9,_0x1d968f)['allow']){if(pid[_0x4e8e20])pid[_0x4e8e20][_0x41afee(0x290)]({'function':_0x41afee(0x169),'args':_0x38f7bd});}else logging('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x1041ed['on'](_0x491063(0x29f),(_0x337fe1,_0x534a6f)=>{const _0x921df8=_0x491063;if(validateAccess(_0x534a6f,_0x1d968f)[_0x921df8(0x19a)]){if(pid[_0x4e8e20])pid[_0x4e8e20][_0x921df8(0x290)]({'function':_0x921df8(0x243),'args':_0x337fe1});}else logging(_0x921df8(0x1ae));}),_0x1041ed['on'](_0x491063(0x168),(_0x4c8b5e,_0x4736bb)=>{const _0x25090a=_0x491063;if(validateAccess(_0x4736bb,_0x1d968f)[_0x25090a(0x19a)]){if(pid[_0x4e8e20])pid[_0x4e8e20]['send']({'function':_0x25090a(0x1cf),'args':_0x4c8b5e});}else logging('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x1041ed['on'](_0x491063(0x16d),_0x476090=>{const _0x434a12=_0x491063;if(validateAccess(_0x476090,_0x1d968f)[_0x434a12(0x19a)]){if(pid[_0x4e8e20])pid[_0x4e8e20][_0x434a12(0x290)]({'function':_0x434a12(0x1dc),'args':null});}else logging('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x1041ed['on'](_0x491063(0x1fb),(_0x4b7d0d,_0x834f9)=>{const _0x26af66=_0x491063;if(validateAccess(_0x834f9,_0x1d968f)[_0x26af66(0x19a)]){if(pid[_0x4e8e20])pid[_0x4e8e20][_0x26af66(0x290)]({'function':'placeOrder','args':_0x4b7d0d});}else logging(_0x26af66(0x1b4));}),_0x1041ed['on'](_0x491063(0x233),_0x3827ad=>{const _0x269752=_0x491063;if(validateAccess(_0x3827ad,_0x1d968f)[_0x269752(0x19a)]){if(pid[_0x4e8e20])pid[_0x4e8e20][_0x269752(0x290)]({'function':_0x269752(0x186),'args':null});}else logging(_0x269752(0x1d9));}),_0x1041ed['on'](_0x491063(0x254),_0x408ea2=>{const _0x59caa5=_0x491063;if(validateAccess(_0x408ea2,_0x1d968f)[_0x59caa5(0x19a)]){if(devices[_0x1d968f][_0x59caa5(0x25e)])clearTimeout(devices[_0x1d968f][_0x59caa5(0x25e)]);if(devices[_0x1d968f][_0x59caa5(0x27e)])clearTimeout(devices[_0x1d968f]['pidExpireLogin']);removeSocketListeners(getClient(_0x1041ed['id'])[_0x59caa5(0x259)]),addBlacklist(_0x1d968f),devices[_0x1d968f][_0x59caa5(0x228)]=null,devices[_0x1d968f][_0x59caa5(0x274)]=null,devices[_0x1d968f]['access']['token']=null,io['to'](getClient(_0x1041ed['id'])[_0x59caa5(0x259)])[_0x59caa5(0x172)]('status',{'access':{'allow':![],'reason':_0x59caa5(0x16e),'token':null}});}else logging(_0x59caa5(0x1f0));});}function removeSocketListeners(_0x575511){getClientsWithUuid(_0x575511)['forEach'](_0x1f8e65=>{const _0x5727f1=_0x6419;getSocket(_0x1f8e65['id'])[_0x5727f1(0x1aa)]();});}function cleanSettings(){const _0x51b707=_0x3ee32c;let _0x4f0865=settings;return settings['telegramToken']&&settings[_0x51b707(0x1c6)]!=''&&(_0x4f0865={..._0x4f0865,'telegramToken':'************'}),settings['bbPassword']&&settings[_0x51b707(0x202)]!=''&&(_0x4f0865={..._0x4f0865,'bbPassword':_0x51b707(0x27c)}),_0x4f0865;}function updateBB(){const _0x2ef20e=_0x3ee32c;installingUpdate=!![],config[_0x2ef20e(0x1d5)](_0x4040ae=>{const _0x363e5b=_0x2ef20e;restartBot(_0x4040ae[_0x363e5b(0x1c0)]);}),process['send']({'update':!![]},_0x49ed78=>{});}function startBot(_0x4132e0,_0x199c15,_0x402746){const _0x1a127d=_0x3ee32c;let _0x42039d=![];const _0x2e4517=_0x4132e0[0x0];_0x199c15={..._0x199c15,'stdio':[_0x1a127d(0x1ac),_0x1a127d(0x1ac),_0x1a127d(0x1ac),_0x1a127d(0x28d)]},pid[_0x2e4517]=childProcess[_0x1a127d(0x224)](botfile,_0x4132e0,_0x199c15),pid[_0x2e4517]['on'](_0x1a127d(0x1ca),_0xfad1da=>{const _0x243b9e=_0x1a127d;switch(Object[_0x243b9e(0x209)](_0xfad1da)[0x0]){case _0x243b9e(0x282):updateBotName(_0x2e4517,_0xfad1da[_0x243b9e(0x282)]);break;case _0x243b9e(0x277):updateStatus(_0x2e4517,_0xfad1da[_0x243b9e(0x277)]);break;case'live':updateLive(_0x2e4517,_0xfad1da[_0x243b9e(0x1fa)]);break;case'started':updateLive(_0x2e4517,_0xfad1da[_0x243b9e(0x1ad)]),io['to'](_0x2e4517)['emit'](_0x243b9e(0x277),{'access':{'allow':![],'reason':_0x243b9e(0x1e3),'token':null}});break;case _0x243b9e(0x264):_0xfad1da[_0x243b9e(0x264)]==_0x243b9e(0x229)&&restartBot(_0x2e4517);_0xfad1da[_0x243b9e(0x264)]==_0x243b9e(0x17a)&&toggleBot(_0x2e4517,_0x243b9e(0x20c),_0x243b9e(0x23d));break;case'telegram':sendTelegram(_0x2e4517,_0xfad1da[_0x243b9e(0x1c7)]);break;case'function':io['to'](_0x2e4517)[_0x243b9e(0x172)](_0xfad1da[_0x243b9e(0x26f)],_0xfad1da['args']);break;}}),pid[_0x2e4517]['on'](_0x1a127d(0x22b),function(_0x3e0afc){if(_0x42039d)return;_0x42039d=!![],_0x402746(_0x3e0afc);}),pid[_0x2e4517]['on'](_0x1a127d(0x276),function(_0x430422){const _0x5816a7=_0x1a127d;if(installingUpdate)return;if(_0x42039d)return;_0x42039d=!![],_0x402746(null);const _0x593775=dbConfig[_0x5816a7(0x1a6)](_0x5816a7(0x160))[_0x5816a7(0x266)]({'botID':_0x2e4517})[_0x5816a7(0x1a0)]();_0x593775&&(_0x593775['status']==_0x5816a7(0x1d4)||_0x593775[_0x5816a7(0x277)]==_0x5816a7(0x179))&&(updateLive(_0x2e4517,'stopped'),logging(_0x5816a7(0x24f)+_0x2e4517),startBot([_0x2e4517,userID],{'cwd':bbpath},function(_0x4496c5){if(_0x4496c5)logging(_0x4496c5);}));});}function stopBot(_0x4d912d){const _0x54ef7c=_0x3ee32c;getClientsWithBotID(_0x4d912d)[_0x54ef7c(0x1d5)](_0x877d4b=>{const _0x3e61fb=_0x54ef7c;getSocket(_0x877d4b['id'])[_0x3e61fb(0x244)](!![]),removeClient(_0x877d4b['id']);});if(pid[_0x4d912d])pid[_0x4d912d][_0x54ef7c(0x17a)]();}function restartBot(_0x288c8a){const _0x73288e=_0x3ee32c;if(pid[_0x288c8a])pid[_0x288c8a][_0x73288e(0x17a)]();}function addBot(){const _0x53dc3b=_0x3ee32c;let _0xe12962;for(let _0xc2c36=0x1;_0xc2c36<0x3e9;_0xc2c36++){_0xe12962=_0xc2c36['toString']()['padStart'](0x3,'0');let _0x1e80a6=config[_0x53dc3b(0x266)](_0x15daac=>_0x15daac[_0x53dc3b(0x1c0)]==_0xe12962);if(!_0x1e80a6)break;}if(_0xe12962===_0x53dc3b(0x16c)){logging(_0x53dc3b(0x29b));return;}logging('starting\x20new\x20bot\x20|\x20Bot\x20'+_0xe12962),dbConfig[_0x53dc3b(0x1a6)](_0x53dc3b(0x160))[_0x53dc3b(0x23c)]({'botID':_0xe12962,'botname':'Bot\x20'+_0xe12962,'status':_0x53dc3b(0x179),'live':''})[_0x53dc3b(0x166)](),startBot([_0xe12962,userID],{'cwd':bbpath},function(_0x49dc11){if(_0x49dc11)logging(_0x49dc11);}),config=getConfiguration(),io['to']('botmanager')[_0x53dc3b(0x172)](_0x53dc3b(0x160),config);}function deleteBot(_0x1bf65d){const _0x5a9f12=_0x3ee32c;getClientsWithBotID(_0x1bf65d)[_0x5a9f12(0x1d5)](_0x4b55cf=>{const _0x476a27=_0x5a9f12;getSocket(_0x4b55cf['id'])[_0x476a27(0x244)](!![]),removeClient(_0x4b55cf['id']);}),dbConfig[_0x5a9f12(0x1a6)](_0x5a9f12(0x160))[_0x5a9f12(0x297)]({'botID':_0x1bf65d})[_0x5a9f12(0x166)](),logging('deleted\x20Bot\x20'+_0x1bf65d),stopBot(_0x1bf65d);try{fs[_0x5a9f12(0x230)](path[_0x5a9f12(0x273)](configpath,_0x5a9f12(0x253)+_0x1bf65d+_0x5a9f12(0x27f))),fs[_0x5a9f12(0x230)](path['join'](configpath,_0x5a9f12(0x253)+_0x1bf65d+'-events.json')),fs[_0x5a9f12(0x230)](path[_0x5a9f12(0x273)](configpath,_0x5a9f12(0x253)+_0x1bf65d+_0x5a9f12(0x184))),fs[_0x5a9f12(0x230)](path['join'](configpath,_0x5a9f12(0x253)+_0x1bf65d+_0x5a9f12(0x272)));}catch(_0x3f6bcb){if(_0x3f6bcb)logging(_0x5a9f12(0x29c),_0x3f6bcb);}config=getConfiguration(),io['to'](_0x5a9f12(0x1bf))['emit'](_0x5a9f12(0x160),config);}function toggleBot(_0xd82fd0,_0x139236,_0x587f39){const _0x832765=_0x3ee32c;dbConfig[_0x832765(0x1a6)]('bots')[_0x832765(0x266)]({'botID':_0xd82fd0})[_0x832765(0x195)]({'status':_0x139236})['assign']({'live':_0x587f39})['write']();if(_0x139236=='enabled'||_0x139236==_0x832765(0x179))logging(_0x832765(0x1d8)+_0xd82fd0),startBot([_0xd82fd0,userID],{'cwd':bbpath},function(_0xf293d9){if(_0xf293d9)logging(_0xf293d9);});else(_0x139236==_0x832765(0x20c)||_0x139236==_0x832765(0x21f))&&(logging('disabled\x20Bot\x20'+_0xd82fd0),stopBot(_0xd82fd0));config=getConfiguration(),io['to'](_0x832765(0x1bf))[_0x832765(0x172)](_0x832765(0x160),config);}function toggleStatus(_0x4e7f2c){const _0x44f5e7=_0x3ee32c;let _0x408c69=dbConfig[_0x44f5e7(0x1a6)](_0x44f5e7(0x160))['find']({'botID':_0x4e7f2c})[_0x44f5e7(0x1a0)](),_0x2cc206;if(_0x408c69[_0x44f5e7(0x277)]===_0x44f5e7(0x1d4))_0x2cc206=_0x44f5e7(0x20c);else{if(_0x408c69[_0x44f5e7(0x277)]==='new')_0x2cc206=_0x44f5e7(0x21f);else{if(_0x408c69[_0x44f5e7(0x277)]==='new-disabled')_0x2cc206='new';else{if(_0x408c69['status']===_0x44f5e7(0x20c))_0x2cc206=_0x44f5e7(0x1d4);}}}return _0x2cc206;}function updateStatus(_0xd7fefa,_0x399812){const _0x416997=_0x3ee32c;dbConfig['get'](_0x416997(0x160))['find']({'botID':_0xd7fefa})[_0x416997(0x195)]({'status':_0x399812})[_0x416997(0x166)](),config=getConfiguration(),io['to']('botmanager')[_0x416997(0x172)]('bots',config);}function updateLive(_0xbf9082,_0x3de8ed){const _0x55b877=_0x3ee32c;dbConfig[_0x55b877(0x1a6)](_0x55b877(0x160))[_0x55b877(0x266)]({'botID':_0xbf9082})['assign']({'live':_0x3de8ed})[_0x55b877(0x166)](),config=getConfiguration(),io['to'](_0x55b877(0x1bf))[_0x55b877(0x172)]('bots',config);}function updateBotName(_0x3ea587,_0x2eca0e){const _0x5506f5=_0x3ee32c;dbConfig[_0x5506f5(0x1a6)](_0x5506f5(0x160))[_0x5506f5(0x266)]({'botID':_0x3ea587})[_0x5506f5(0x195)]({'botname':_0x2eca0e})[_0x5506f5(0x166)](),config=getConfiguration(),io['to'](_0x5506f5(0x1bf))[_0x5506f5(0x172)](_0x5506f5(0x160),config);}function telegramError(_0x1e830c){const _0x4b0b5e=_0x3ee32c;console[_0x4b0b5e(0x182)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x36c9bc){const _0x4c3255=_0x3ee32c;if(_0x36c9bc['from'][_0x4c3255(0x17e)]!=settings['telegramUsername']&&'@'+_0x36c9bc[_0x4c3255(0x16a)][_0x4c3255(0x17e)]!=settings[_0x4c3255(0x245)])return tgBot['sendMessage'](_0x36c9bc[_0x4c3255(0x1a5)]['id'],_0x4c3255(0x226),{'parse_mode':_0x4c3255(0x25c)})[_0x4c3255(0x1b3)](_0x39a75e=>{telegramError(_0x39a75e);}),![];return!![];}async function initTelegram(){const _0x22b455=_0x3ee32c;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x334c68=_0x22b455(0x21c);_0x334c68+='\x0a',_0x334c68+=_0x22b455(0x1d3),_0x334c68+=_0x22b455(0x240),_0x334c68+=_0x22b455(0x1be),_0x334c68+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x334c68+='/on\x20-\x20start\x20bot(s)\x0a',_0x334c68+='/off\x20-\x20stop\x20bot(s)\x0a',_0x334c68+=_0x22b455(0x183),_0x334c68+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x2c38f3=_0x22b455(0x25d);_0x2c38f3+='\x0a',_0x2c38f3+=_0x334c68,tgBot[_0x22b455(0x223)](/\/start/,_0x1bef4b=>{const _0x1483ea=_0x22b455;if(!validateTelegram(_0x1bef4b))return;if(settings[_0x1483ea(0x16b)]!=_0x1bef4b[_0x1483ea(0x1a5)]['id'])updateSetting('telegramChatId',_0x1bef4b['chat']['id']);updateSetting(_0x1483ea(0x235),!![]),tgBot[_0x1483ea(0x1c9)](_0x1bef4b[_0x1483ea(0x1a5)]['id'],_0x2c38f3)[_0x1483ea(0x1b3)](_0x3b6989=>{telegramError(_0x3b6989);});}),tgBot[_0x22b455(0x223)](/\/enable/,_0x5ea310=>{const _0x3793ac=_0x22b455;if(!validateTelegram(_0x5ea310))return;if(settings[_0x3793ac(0x16b)]!=_0x5ea310[_0x3793ac(0x1a5)]['id'])updateSetting(_0x3793ac(0x16b),_0x5ea310[_0x3793ac(0x1a5)]['id']);updateSetting(_0x3793ac(0x235),!![]),tgBot[_0x3793ac(0x1c9)](_0x5ea310[_0x3793ac(0x1a5)]['id'],'Notifications\x20enabled')[_0x3793ac(0x1b3)](_0x67fafb=>{telegramError(_0x67fafb);});}),tgBot[_0x22b455(0x223)](/\/config/,async _0x375691=>{const _0x58bf8e=_0x22b455;if(!validateTelegram(_0x375691))return;tgBot[_0x58bf8e(0x193)](_0x58bf8e(0x1f2)),tgBot[_0x58bf8e(0x1c9)](_0x375691['chat']['id'],_0x58bf8e(0x194),{'reply_markup':{'inline_keyboard':[[{'text':_0x58bf8e(0x18e),'callback_data':_0x58bf8e(0x1a9)},{'text':_0x58bf8e(0x173),'callback_data':_0x58bf8e(0x1e8)},{'text':'All','callback_data':_0x58bf8e(0x215)}]]}})[_0x58bf8e(0x1b3)](_0x47a54a=>{telegramError(_0x47a54a);}),tgBot['on'](_0x58bf8e(0x1f2),async _0x437cee=>{const _0x39b540=_0x58bf8e,_0x13ba59=_0x437cee['data'],_0x4a7e32=_0x437cee[_0x39b540(0x1ca)];tgBot[_0x39b540(0x1a8)](_0x437cee['id'])[_0x39b540(0x248)](async()=>{const _0x5117d7=_0x39b540;_0x13ba59==_0x5117d7(0x1a9)&&(updateSetting(_0x5117d7(0x250),'orders'),updateSetting(_0x5117d7(0x235),!![]),await tgBot[_0x5117d7(0x1c9)](_0x4a7e32[_0x5117d7(0x1a5)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0x5117d7(0x1b3)](_0x1ae372=>{telegramError(_0x1ae372);}));_0x13ba59==_0x5117d7(0x1e8)&&(updateSetting(_0x5117d7(0x250),'alerts'),updateSetting(_0x5117d7(0x235),!![]),await tgBot[_0x5117d7(0x1c9)](_0x4a7e32[_0x5117d7(0x1a5)]['id'],_0x5117d7(0x1df))[_0x5117d7(0x1b3)](_0x1f8e9b=>{telegramError(_0x1f8e9b);}));_0x13ba59==_0x5117d7(0x215)&&(updateSetting(_0x5117d7(0x250),'all'),updateSetting('telegramEnabled',!![]),await tgBot[_0x5117d7(0x1c9)](_0x4a7e32[_0x5117d7(0x1a5)]['id'],_0x5117d7(0x257))['catch'](_0x38ef88=>{telegramError(_0x38ef88);}));if(!settings[_0x5117d7(0x16b)])tgBot[_0x5117d7(0x1c9)](_0x4a7e32[_0x5117d7(0x1a5)]['id'],_0x5117d7(0x220))['catch'](_0x4e32ee=>{telegramError(_0x4e32ee);});}),tgBot[_0x39b540(0x193)](_0x39b540(0x1f2));});}),tgBot[_0x22b455(0x223)](/\/status/,_0x86c058=>{const _0xcb000f=_0x22b455;if(!validateTelegram(_0x86c058))return;let _0x11c3de=_0xcb000f(0x1b9);config['forEach'](_0x3527c6=>{const _0x27c629=_0xcb000f;_0x11c3de+='Bot\x20'+_0x3527c6[_0x27c629(0x1c0)]+_0x27c629(0x20f)+_0x3527c6[_0x27c629(0x282)]+':\x20'+_0x3527c6[_0x27c629(0x277)]+'\x20/\x20'+_0x3527c6[_0x27c629(0x1fa)]+'\x0a';}),_0x11c3de+='\x0a',_0x11c3de+=_0xcb000f(0x2a1),_0x11c3de+=!settings['telegramEnabled']?_0xcb000f(0x2a0):'Notifications\x20enabled\x0a',_0x11c3de+=settings[_0xcb000f(0x235)]?settings[_0xcb000f(0x250)]==_0xcb000f(0x215)?_0xcb000f(0x227):_0xcb000f(0x17d)+settings['telegramEvents']+_0xcb000f(0x283):'',tgBot[_0xcb000f(0x1c9)](_0x86c058[_0xcb000f(0x1a5)]['id'],_0x11c3de,{'parse_mode':_0xcb000f(0x25c)})[_0xcb000f(0x1b3)](_0x39fdf1=>{telegramError(_0x39fdf1);});}),tgBot[_0x22b455(0x223)](/\/restart/,_0x1d4ba9=>{const _0x49cc59=_0x22b455;if(!validateTelegram(_0x1d4ba9))return;tgBot['removeListener'](_0x49cc59(0x1f2));const _0x2c7bbd=getEnabledBots();if(_0x2c7bbd[_0x49cc59(0x1e6)]==0x0)tgBot[_0x49cc59(0x1c9)](_0x1d4ba9[_0x49cc59(0x1a5)]['id'],_0x49cc59(0x221))[_0x49cc59(0x1b3)](_0x72cfd2=>{telegramError(_0x72cfd2);});else{if(_0x2c7bbd[_0x49cc59(0x1e6)]>0x1)_0x2c7bbd[_0x49cc59(0x23c)]({'botID':_0x49cc59(0x215)});let _0x247408=[],_0x2c44ee=[];const _0x27fb7c=_0x2c7bbd['length']%0x4==0x0||_0x2c7bbd[_0x49cc59(0x1e6)]%0x4==0x3||_0x2c7bbd['length']%0x3==0x1?0x4:0x3;let _0x2319a4=0x0;_0x2c7bbd[_0x49cc59(0x1d5)]((_0xd0e8,_0x1cdb18)=>{const _0x134ae8=_0x49cc59;if(_0x1cdb18%_0x27fb7c==0x0)_0x2c44ee=[];_0x2c44ee[_0x134ae8(0x23c)]({'text':_0xd0e8[_0x134ae8(0x1c0)]==_0x134ae8(0x215)?_0x134ae8(0x299):_0x134ae8(0x284)+_0xd0e8[_0x134ae8(0x1c0)],'callback_data':_0xd0e8[_0x134ae8(0x1c0)]}),_0x1cdb18%_0x27fb7c==0x0&&(_0x247408[_0x2319a4]=_0x2c44ee,_0x2319a4++);}),tgBot[_0x49cc59(0x1c9)](_0x1d4ba9[_0x49cc59(0x1a5)]['id'],_0x49cc59(0x22d),{'reply_markup':{'inline_keyboard':_0x247408}})[_0x49cc59(0x1b3)](_0x43249a=>{telegramError(_0x43249a);}),tgBot['on'](_0x49cc59(0x1f2),async _0x4f2f09=>{const _0x2bec4b=_0x49cc59,_0x3b8900=_0x4f2f09[_0x2bec4b(0x22c)],_0x444817=_0x4f2f09[_0x2bec4b(0x1ca)];tgBot['answerCallbackQuery'](_0x4f2f09['id'])[_0x2bec4b(0x248)](async()=>{const _0x373a9a=_0x2bec4b;if(_0x3b8900==_0x373a9a(0x215)){if(settings[_0x373a9a(0x250)]==_0x373a9a(0x1a9))tgBot['sendMessage'](_0x444817[_0x373a9a(0x1a5)]['id'],_0x373a9a(0x1ba))['catch'](_0x4a5943=>{telegramError(_0x4a5943);});config[_0x373a9a(0x1d5)](_0x535780=>{const _0x557d21=_0x373a9a;restartBot(_0x535780[_0x557d21(0x1c0)]);});}else{if(settings['telegramEvents']=='orders')tgBot[_0x373a9a(0x1c9)](_0x444817[_0x373a9a(0x1a5)]['id'],_0x373a9a(0x1bb)+_0x3b8900)[_0x373a9a(0x1b3)](_0x10c487=>{telegramError(_0x10c487);});restartBot(_0x3b8900);}}),tgBot[_0x2bec4b(0x193)](_0x2bec4b(0x1f2));});}}),tgBot['onText'](/\/on/,_0x156379=>{const _0x1dbc71=_0x22b455;if(!validateTelegram(_0x156379))return;tgBot[_0x1dbc71(0x193)](_0x1dbc71(0x1f2));const _0x459e4e=getDisabledBots();if(_0x459e4e['length']==0x0)tgBot[_0x1dbc71(0x1c9)](_0x156379['chat']['id'],_0x1dbc71(0x1d6))[_0x1dbc71(0x1b3)](_0x16035c=>{telegramError(_0x16035c);});else{if(_0x459e4e[_0x1dbc71(0x1e6)]>0x1)_0x459e4e['push']({'botID':_0x1dbc71(0x215)});let _0x426b24=[],_0x513eaa=[];const _0x4c5a26=_0x459e4e[_0x1dbc71(0x1e6)]%0x4==0x0||_0x459e4e['length']%0x4==0x3||_0x459e4e['length']%0x3==0x1?0x4:0x3;let _0x4b29c5=0x0;_0x459e4e['forEach']((_0x5ebfda,_0x2190d)=>{const _0x36acf7=_0x1dbc71;if(_0x2190d%_0x4c5a26==0x0)_0x513eaa=[];_0x513eaa[_0x36acf7(0x23c)]({'text':_0x5ebfda[_0x36acf7(0x1c0)]==_0x36acf7(0x215)?_0x36acf7(0x299):_0x36acf7(0x284)+_0x5ebfda[_0x36acf7(0x1c0)],'callback_data':_0x5ebfda[_0x36acf7(0x1c0)]}),_0x2190d%_0x4c5a26==0x0&&(_0x426b24[_0x4b29c5]=_0x513eaa,_0x4b29c5++);}),tgBot[_0x1dbc71(0x1c9)](_0x156379['chat']['id'],_0x1dbc71(0x262),{'reply_markup':{'inline_keyboard':_0x426b24}})[_0x1dbc71(0x1b3)](_0x403e63=>{telegramError(_0x403e63);}),tgBot['on'](_0x1dbc71(0x1f2),async _0x5b2d1a=>{const _0xfbff3=_0x1dbc71,_0x1c9130=_0x5b2d1a[_0xfbff3(0x22c)],_0xd3cb72=_0x5b2d1a[_0xfbff3(0x1ca)];tgBot['answerCallbackQuery'](_0x5b2d1a['id'])[_0xfbff3(0x248)](async()=>{const _0x26445c=_0xfbff3;if(_0x1c9130==_0x26445c(0x215)){if(settings['telegramEvents']==_0x26445c(0x1a9))tgBot[_0x26445c(0x1c9)](_0xd3cb72[_0x26445c(0x1a5)]['id'],_0x26445c(0x1c1))[_0x26445c(0x1b3)](_0x5c10e4=>{telegramError(_0x5c10e4);});_0x459e4e['forEach'](_0x143b72=>{const _0x4c0197=_0x26445c;if(_0x143b72['botID']!='all')toggleBot(_0x143b72[_0x4c0197(0x1c0)],toggleStatus(_0x143b72['botID']),_0x4c0197(0x23d));});}else{if(settings[_0x26445c(0x250)]==_0x26445c(0x1a9))tgBot[_0x26445c(0x1c9)](_0xd3cb72[_0x26445c(0x1a5)]['id'],_0x26445c(0x23a)+_0x1c9130)[_0x26445c(0x1b3)](_0x2db7fc=>{telegramError(_0x2db7fc);});toggleBot(_0x1c9130,toggleStatus(_0x1c9130),_0x26445c(0x23d));}}),tgBot['removeListener'](_0xfbff3(0x1f2));});}}),tgBot[_0x22b455(0x223)](/\/off/,_0x876fa0=>{const _0x3ac618=_0x22b455;if(!validateTelegram(_0x876fa0))return;tgBot[_0x3ac618(0x193)](_0x3ac618(0x1f2));const _0x4dbb58=getEnabledBots();if(_0x4dbb58['length']==0x0)tgBot['sendMessage'](_0x876fa0['chat']['id'],_0x3ac618(0x221))[_0x3ac618(0x1b3)](_0x105f88=>{telegramError(_0x105f88);});else{if(_0x4dbb58['length']>0x1)_0x4dbb58[_0x3ac618(0x23c)]({'botID':_0x3ac618(0x215)});let _0x1170f4=[],_0x2a287d=[];const _0x5875d5=_0x4dbb58[_0x3ac618(0x1e6)]%0x4==0x0||_0x4dbb58[_0x3ac618(0x1e6)]%0x4==0x3||_0x4dbb58[_0x3ac618(0x1e6)]%0x3==0x1?0x4:0x3;let _0x4cec71=0x0;_0x4dbb58[_0x3ac618(0x1d5)]((_0x4fe2dd,_0x1f7445)=>{const _0x2fa8cc=_0x3ac618;if(_0x1f7445%_0x5875d5==0x0)_0x2a287d=[];_0x2a287d[_0x2fa8cc(0x23c)]({'text':_0x4fe2dd[_0x2fa8cc(0x1c0)]==_0x2fa8cc(0x215)?_0x2fa8cc(0x299):_0x2fa8cc(0x284)+_0x4fe2dd[_0x2fa8cc(0x1c0)],'callback_data':_0x4fe2dd[_0x2fa8cc(0x1c0)]}),_0x1f7445%_0x5875d5==0x0&&(_0x1170f4[_0x4cec71]=_0x2a287d,_0x4cec71++);}),tgBot[_0x3ac618(0x1c9)](_0x876fa0[_0x3ac618(0x1a5)]['id'],_0x3ac618(0x1f1),{'reply_markup':{'inline_keyboard':_0x1170f4}})[_0x3ac618(0x1b3)](_0x4c5dd1=>{telegramError(_0x4c5dd1);}),tgBot['on'](_0x3ac618(0x1f2),async _0x1f1ced=>{const _0x254620=_0x3ac618,_0x158aef=_0x1f1ced[_0x254620(0x22c)],_0x484ece=_0x1f1ced[_0x254620(0x1ca)];tgBot[_0x254620(0x1a8)](_0x1f1ced['id'])[_0x254620(0x248)](async()=>{const _0x5d5697=_0x254620;if(_0x158aef==_0x5d5697(0x215)){if(settings['telegramEvents']==_0x5d5697(0x1a9))tgBot[_0x5d5697(0x1c9)](_0x484ece[_0x5d5697(0x1a5)]['id'],_0x5d5697(0x1af))['catch'](_0x12b60a=>{telegramError(_0x12b60a);});_0x4dbb58['forEach'](_0x4ee081=>{const _0x3665df=_0x5d5697;if(_0x4ee081[_0x3665df(0x1c0)]!=_0x3665df(0x215))toggleBot(_0x4ee081[_0x3665df(0x1c0)],toggleStatus(_0x4ee081[_0x3665df(0x1c0)]),_0x3665df(0x23d));});}else{if(settings['telegramEvents']==_0x5d5697(0x1a9))tgBot[_0x5d5697(0x1c9)](_0x484ece[_0x5d5697(0x1a5)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x158aef)[_0x5d5697(0x1b3)](_0x5baee7=>{telegramError(_0x5baee7);});toggleBot(_0x158aef,toggleStatus(_0x158aef),'stopped');}}),tgBot[_0x254620(0x193)](_0x254620(0x1f2));});}}),tgBot[_0x22b455(0x223)](/\/disable/,_0x4bd0d2=>{const _0x4b8e37=_0x22b455;if(!validateTelegram(_0x4bd0d2))return;tgBot[_0x4b8e37(0x1c9)](_0x4bd0d2['chat']['id'],_0x4b8e37(0x19b))[_0x4b8e37(0x1b3)](_0x11a2dd=>{telegramError(_0x11a2dd);}),updateSetting(_0x4b8e37(0x235),![]);}),tgBot['onText'](/\/help/,_0x18daa3=>{const _0x2ee9b2=_0x22b455;if(!validateTelegram(_0x18daa3))return;tgBot[_0x2ee9b2(0x1c9)](_0x18daa3[_0x2ee9b2(0x1a5)]['id'],_0x334c68)[_0x2ee9b2(0x1b3)](_0x3e93ea=>{telegramError(_0x3e93ea);});}),tgBot['on']('polling_error',_0x23c303=>{const _0x437e8f=_0x22b455;_0x23c303[_0x437e8f(0x1f5)]()['includes'](_0x437e8f(0x171))&&(logging(_0x437e8f(0x1f8)),tgBot['stopPolling'](),tgBot=null,io['to']('botmanager')[_0x437e8f(0x172)](_0x437e8f(0x178),_0x437e8f(0x1f8)));}),process['once'](_0x22b455(0x187),()=>{const _0x189000=_0x22b455;if(tgBot)tgBot[_0x189000(0x239)]();process[_0x189000(0x276)](0x1);}),process['once']('SIGTERM',()=>{const _0x5ddc9e=_0x22b455;if(tgBot)tgBot[_0x5ddc9e(0x239)]();process[_0x5ddc9e(0x276)](0x1);});}}function disableTelegram(){const _0x4230a8=_0x3ee32c;tgBot&&(tgBot[_0x4230a8(0x239)](),tgBot=null);}function sendTelegram(_0x4a1943,_0x1a2451){const _0x19a919=_0x3ee32c;if(settings[_0x19a919(0x235)]){if(settings['telegramEvents']==_0x19a919(0x215)||(_0x1a2451[_0x19a919(0x20a)]==_0x19a919(0x22b)||_0x1a2451[_0x19a919(0x20a)]==_0x19a919(0x2a2))&&settings[_0x19a919(0x250)]=='alerts'||_0x1a2451[_0x19a919(0x20a)]==_0x19a919(0x269)&&settings[_0x19a919(0x250)]==_0x19a919(0x1a9)){if(tgBot&&settings['telegramChatId']){if(_0x1a2451[_0x19a919(0x234)])tgBot['sendMessage'](settings[_0x19a919(0x16b)],_0x1a2451[_0x19a919(0x282)]+'\x20>\x20'+_0x1a2451[_0x19a919(0x287)])[_0x19a919(0x1b3)](_0x5ad0a4=>{telegramError(_0x5ad0a4);});else tgBot[_0x19a919(0x1c9)](settings[_0x19a919(0x16b)],_0x19a919(0x284)+_0x4a1943+_0x19a919(0x22a)+_0x1a2451[_0x19a919(0x287)])[_0x19a919(0x1b3)](_0x3e99c2=>{telegramError(_0x3e99c2);});}}}}function getDeviceWithIp(_0x3bb45f){const _0x25dc9c=_0x3ee32c;return devices[_0x25dc9c(0x266)](_0x4ed483=>_0x4ed483['ip']===_0x3bb45f);}function temporaryAccess2FA(_0x203c3a,_0x4597c2){const _0x1e07d0=_0x3ee32c;let _0x11a437=new Date(),_0x343e56=![];if(lastIpApproval){if(_0x11a437-lastIpApproval<0x1388)_0x343e56=!![];}lastIpApproval=new Date();if(_0x343e56)return;tgBot&&settings[_0x1e07d0(0x16b)]&&(tgBot[_0x1e07d0(0x193)](_0x1e07d0(0x1f2)),tgBot['sendMessage'](settings[_0x1e07d0(0x16b)],_0x1e07d0(0x1db)+normalizeIP(_0x4597c2)[_0x1e07d0(0x293)]+_0x1e07d0(0x203),{'parse_mode':_0x1e07d0(0x25c),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x1e07d0(0x25b),'callback_data':'30'},{'text':'reject','callback_data':_0x1e07d0(0x18f)}]]}})[_0x1e07d0(0x1b3)](_0x22f1ca=>{telegramError(_0x22f1ca);}),tgBot['on'](_0x1e07d0(0x1f2),async _0x4c57ab=>{const _0x20fbaa=_0x1e07d0,_0x3640af=_0x4c57ab[_0x20fbaa(0x22c)],_0x673b34=_0x4c57ab[_0x20fbaa(0x1ca)];tgBot[_0x20fbaa(0x1a8)](_0x4c57ab['id'])[_0x20fbaa(0x248)](async()=>{const _0x5a92e0=_0x20fbaa;devices[_0x203c3a][_0x5a92e0(0x228)]={'clientip':_0x4597c2,'timestamp':new Date()['getTime'](),'expiry':_0x3640af},_0x3640af!=_0x5a92e0(0x18f)?(await tgBot[_0x5a92e0(0x1c9)](_0x673b34[_0x5a92e0(0x1a5)]['id'],_0x5a92e0(0x1ff)+_0x3640af+_0x5a92e0(0x1e0),{'parse_mode':_0x5a92e0(0x25c)})['catch'](_0x2af126=>{telegramError(_0x2af126);}),io['to'](_0x203c3a)[_0x5a92e0(0x172)]('status',{'access':{'allow':![],'reason':_0x5a92e0(0x1e3),'token':null}})):(await tgBot[_0x5a92e0(0x1c9)](_0x673b34[_0x5a92e0(0x1a5)]['id'],_0x5a92e0(0x246))[_0x5a92e0(0x1b3)](_0x3b6c50=>{telegramError(_0x3b6c50);}),io['to'](_0x203c3a)[_0x5a92e0(0x172)]('status',{'access':{'allow':![],'reason':_0x5a92e0(0x1a7),'token':null}}));}),tgBot['removeListener'](_0x20fbaa(0x1f2));}));}function loginAccess2FA(_0x147c65,_0x13ff35){const _0x169337=_0x3ee32c;tgBot&&settings[_0x169337(0x16b)]&&(tgBot[_0x169337(0x193)](_0x169337(0x1f2)),tgBot[_0x169337(0x1c9)](settings[_0x169337(0x16b)],_0x169337(0x21b)+normalizeIP(_0x13ff35)[_0x169337(0x293)]+_0x169337(0x203),{'parse_mode':_0x169337(0x25c),'reply_markup':{'inline_keyboard':[[{'text':_0x169337(0x1e5),'callback_data':loginExpiry},{'text':_0x169337(0x18f),'callback_data':_0x169337(0x18f)}]]}})['catch'](_0x273306=>{telegramError(_0x273306);}),tgBot['on'](_0x169337(0x1f2),async _0x2205ef=>{const _0x229c71=_0x169337,_0x13dd88=_0x2205ef['data'],_0x37b7f1=_0x2205ef[_0x229c71(0x1ca)];tgBot[_0x229c71(0x1a8)](_0x2205ef['id'])['then'](async()=>{const _0x49305f=_0x229c71;devices[_0x147c65][_0x49305f(0x274)]={'clientip':_0x13ff35,'timestamp':new Date()[_0x49305f(0x1fe)](),'expiry':_0x13dd88},_0x13dd88!=_0x49305f(0x18f)?(await tgBot[_0x49305f(0x1c9)](_0x37b7f1[_0x49305f(0x1a5)]['id'],'Login\x20accepted',{'parse_mode':_0x49305f(0x25c)})[_0x49305f(0x1b3)](_0x57131b=>{telegramError(_0x57131b);}),io['to'](_0x147c65)['emit'](_0x49305f(0x277),{'access':{'allow':![],'reason':_0x49305f(0x1e3),'token':null}})):(await tgBot['sendMessage'](_0x37b7f1[_0x49305f(0x1a5)]['id'],_0x49305f(0x258))[_0x49305f(0x1b3)](_0x25e9cc=>{telegramError(_0x25e9cc);}),io['to'](_0x147c65)['emit']('status',{'access':{'allow':![],'reason':_0x49305f(0x165),'token':null}}));}),tgBot[_0x229c71(0x193)]('callback_query');}));}function getConfiguration(){const _0x8d78af=_0x3ee32c;return dbConfig[_0x8d78af(0x1a6)](_0x8d78af(0x160))[_0x8d78af(0x295)](_0x8d78af(0x1c0))['value']()||[];}function getEnabledBots(){const _0x4e54b0=_0x3ee32c;return dbConfig['get'](_0x4e54b0(0x160))[_0x4e54b0(0x295)](_0x4e54b0(0x1c0))[_0x4e54b0(0x24a)]({'status':_0x4e54b0(0x1d4)})[_0x4e54b0(0x1a0)]()||[];}function getDisabledBots(){const _0x3acd74=_0x3ee32c;return dbConfig[_0x3acd74(0x1a6)]('bots')[_0x3acd74(0x295)]('botID')[_0x3acd74(0x24a)]({'status':_0x3acd74(0x20c)})[_0x3acd74(0x1a0)]()||[];}function getSettings(){const _0x1a77e8=_0x3ee32c;return dbSettings['get'](_0x1a77e8(0x217))[_0x1a77e8(0x1a0)]()||{'timeshift':0x0};}function getSecure(){const _0x2cfcf7=_0x3ee32c;return dbSecure['get'](_0x2cfcf7(0x26a))[_0x2cfcf7(0x1a0)]()||{};}function getBlacklist(){const _0x13a30b=_0x3ee32c;return dbSecure[_0x13a30b(0x1a6)](_0x13a30b(0x219))['value']()||[];}function broadcastToBots(_0x174493,_0xfc0e56){const _0x341eb2=_0x3ee32c;config[_0x341eb2(0x1d5)](_0x319336=>{const _0x551d6c=_0x341eb2;if(_0x319336['status']==_0x551d6c(0x1d4)&&_0x319336[_0x551d6c(0x1fa)]==_0x551d6c(0x1f9)){if(pid[_0x319336[_0x551d6c(0x1c0)]])pid[_0x319336['botID']][_0x551d6c(0x290)]({[_0x174493]:_0xfc0e56});}});}function storeSettings(_0x24866e,_0x595930=![]){const _0x195218=_0x3ee32c;_0x24866e={...settings,..._0x24866e};if(_0x595930&&_0x24866e[_0x195218(0x202)]!=_0x195218(0x27c)&&_0x24866e[_0x195218(0x202)]!=''){const _0x3c456c=crypt[_0x195218(0x213)](secure[_0x195218(0x19f)],_0x24866e[_0x195218(0x202)])[_0x195218(0x1ca)][_0x195218(0x1f3)]('@')[0x0],_0x322545=bcrypt[_0x195218(0x18b)](_0x3c456c,saltRounds);_0x24866e={..._0x24866e,'bbPassword':_0x322545};}if(_0x595930&&_0x24866e[_0x195218(0x1c6)]!='************'&&_0x24866e[_0x195218(0x1c6)]!=''){const _0x822487=crypt[_0x195218(0x213)](secure['privateKey'],_0x24866e[_0x195218(0x1c6)])['message'][_0x195218(0x1f3)]('@')[0x0];_0x24866e={..._0x24866e,'telegramToken':_0x822487};}const _0x46bc68=_0x24866e[_0x195218(0x1c6)]!='************'&&_0x24866e['telegramToken']!=settings[_0x195218(0x1c6)]||_0x24866e[_0x195218(0x245)]!=settings[_0x195218(0x245)],_0x81ff2e=_0x24866e[_0x195218(0x1c6)]==''||_0x24866e['telegramUsername']=='';if(_0x46bc68)_0x24866e['telegramEvents']=_0x195218(0x215);for(const [_0x2b0745,_0x4f45a7]of Object[_0x195218(0x21d)](_0x24866e)){if(_0x2b0745==_0x195218(0x1c6)&&_0x4f45a7=='************'){_0x24866e['telegramToken']=settings['telegramToken'];continue;};if(_0x2b0745==_0x195218(0x202)&&_0x4f45a7==_0x195218(0x27c)){_0x24866e[_0x195218(0x202)]=settings[_0x195218(0x202)];continue;};dbSettings[_0x195218(0x24e)](_0x195218(0x28f)+_0x2b0745,_0x4f45a7)[_0x195218(0x166)]();}settings=_0x24866e,io['to'](_0x195218(0x1bf))['emit'](_0x195218(0x217),cleanSettings()),broadcastToBots(_0x195218(0x29a),settings['timeshift']);if(_0x46bc68&&!_0x81ff2e)initTelegram();if(_0x46bc68&&_0x81ff2e)disableTelegram();getAllClients()[_0x195218(0x1d5)](_0x48efe9=>{const _0x3e3b8f=_0x195218;getSocket(_0x48efe9['id'])[_0x3e3b8f(0x172)]('status',{'access':{'allow':![],'reason':_0x3e3b8f(0x1e3),'token':null}});});}function updateSetting(_0x33e849,_0x4f7394){const _0xb38f96=_0x3ee32c;dbSettings[_0xb38f96(0x24e)](_0xb38f96(0x28f)+_0x33e849,_0x4f7394)['write'](),settings=getSettings(),io['to'](_0xb38f96(0x1bf))[_0xb38f96(0x172)](_0xb38f96(0x217),cleanSettings());}function storeSecure(_0x4f3a7e){const _0x419698=_0x3ee32c;dbSecure[_0x419698(0x1a6)](_0x419698(0x26a))[_0x419698(0x23c)](_0x4f3a7e)['write'](),secure=_0x4f3a7e;}function addBlacklist(_0x53ca5d){const _0x5360bf=_0x3ee32c;cleanBlacklist();let _0x2f7e92;devices[_0x53ca5d][_0x5360bf(0x228)]?_0x2f7e92=Math[_0x5360bf(0x29e)](devices[_0x53ca5d][_0x5360bf(0x228)]['expiry'],loginExpiry):_0x2f7e92=loginExpiry,dbSecure['get'](_0x5360bf(0x219))[_0x5360bf(0x23c)]({'expiry':new Date()[_0x5360bf(0x1fe)]()+_0x2f7e92*0x3c*0x3e8,'token':devices[_0x53ca5d][_0x5360bf(0x27d)]['token']})[_0x5360bf(0x166)](),blacklist=dbSecure['get'](_0x5360bf(0x219))[_0x5360bf(0x1a0)]();}function cleanBlacklist(){const _0x47e7c3=_0x3ee32c;let _0x3ea284=dbSecure['get']('blacklist')['cloneDeep']()['value'](),_0x4b1ce8=new Date()[_0x47e7c3(0x1fe)]();_0x3ea284[_0x47e7c3(0x1d5)](_0x3180c2=>{const _0x541be4=_0x47e7c3;_0x3180c2[_0x541be4(0x205)]<_0x4b1ce8&&dbSecure[_0x541be4(0x1a6)](_0x541be4(0x219))['remove']({'expiry':_0x3180c2['expiry']})['write']();});}function initStates(){const _0x46224a=_0x3ee32c;let _0x269305=getConfiguration();_0x269305[_0x46224a(0x1d5)](_0x26baf2=>{const _0x11d386=_0x46224a;_0x26baf2[_0x11d386(0x1fa)]=_0x11d386(0x23d);}),storeConfiguration(_0x269305);}function onKeys(){const _0x29edc9=new RSA();return new Promise(_0x507d78=>{const _0x2963be=_0x6419;_0x29edc9[_0x2963be(0x164)]()[_0x2963be(0x248)](_0x5190c3=>{_0x507d78(_0x5190c3);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x52c554=_0x3ee32c;let _0x406281=getConfiguration(),_0x3188b0=![];_0x406281[_0x52c554(0x1d5)](_0x5c6b28=>{const _0x327c9a=_0x52c554;if(_0x5c6b28['status']==_0x327c9a(0x1f9))_0x5c6b28[_0x327c9a(0x277)]=_0x327c9a(0x1d4),_0x3188b0=!![];else _0x5c6b28['status']==_0x327c9a(0x23d)&&(_0x5c6b28['status']=_0x327c9a(0x20c),_0x3188b0=!![]);});if(_0x3188b0)storeConfiguration(_0x406281);let _0x5813c5=getSecure();if(!_0x5813c5['hasOwnProperty'](_0x52c554(0x1a4))){let _0x57840c=await generateKeys();_0x5813c5['publicKey']=_0x57840c[_0x52c554(0x1b1)],_0x5813c5[_0x52c554(0x19f)]=_0x57840c[_0x52c554(0x19f)],_0x5813c5[_0x52c554(0x1a4)]=crypto['randomBytes'](0x20)[_0x52c554(0x1f5)](_0x52c554(0x200));;storeSecure(_0x5813c5);}let _0x2a6faa=getSettings();_0x3188b0=![];!_0x2a6faa[_0x52c554(0x278)](_0x52c554(0x204))&&(_0x2a6faa['loginRequired']=![],_0x2a6faa[_0x52c554(0x27b)]='',_0x2a6faa[_0x52c554(0x202)]='',_0x2a6faa[_0x52c554(0x207)]=![],_0x3188b0=!![]);!_0x2a6faa[_0x52c554(0x278)](_0x52c554(0x1b0))&&(_0x2a6faa[_0x52c554(0x1b0)]=![],_0x2a6faa[_0x52c554(0x1e7)]=[],_0x2a6faa['temporaryAccessAllowed']=![],_0x3188b0=!![]);if(!_0x2a6faa[_0x52c554(0x278)](_0x52c554(0x235))){if(_0x2a6faa['telegramChatId'])_0x2a6faa[_0x52c554(0x235)]=!![];else _0x2a6faa['telegramEnabled']=![];_0x3188b0=!![];}if(_0x3188b0)storeSettings(_0x2a6faa);}function storeConfiguration(_0x29b69d){const _0x24b0ab=_0x3ee32c;dbConfig[_0x24b0ab(0x1a6)](_0x24b0ab(0x160))['remove']()[_0x24b0ab(0x166)](),dbConfig[_0x24b0ab(0x1a6)](_0x24b0ab(0x160))[_0x24b0ab(0x23c)](..._0x29b69d)[_0x24b0ab(0x166)](),config=_0x29b69d;}function resetPassword(){const _0x186368=_0x3ee32c;tgBot&&settings['telegramChatId']&&(tgBot[_0x186368(0x193)](_0x186368(0x1f2)),tgBot[_0x186368(0x1c9)](settings[_0x186368(0x16b)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x186368(0x25c),'reply_markup':{'inline_keyboard':[[{'text':_0x186368(0x1b8),'callback_data':_0x186368(0x1b8)},{'text':'no','callback_data':'no'}]]}})[_0x186368(0x1b3)](_0x4e8e53=>{telegramError(_0x4e8e53);}),tgBot['on'](_0x186368(0x1f2),async _0x4faec0=>{const _0x35bae3=_0x186368,_0x23d5c0=_0x4faec0[_0x35bae3(0x22c)],_0x3df374=_0x4faec0[_0x35bae3(0x1ca)];tgBot[_0x35bae3(0x1a8)](_0x4faec0['id'])[_0x35bae3(0x248)](async()=>{const _0x3ad31a=_0x35bae3;if(_0x23d5c0!='no'){const _0xd8d724=0xf,_0x1b739f=_0x3ad31a(0x279),_0xe7bad8=Array['from'](crypto[_0x3ad31a(0x181)](new Uint32Array(_0xd8d724)))[_0x3ad31a(0x260)](_0x2c6b63=>_0x1b739f[_0x2c6b63%_0x1b739f[_0x3ad31a(0x1e6)]])[_0x3ad31a(0x273)](''),_0x214182=bcrypt[_0x3ad31a(0x18b)](_0xe7bad8,saltRounds);storeSettings({'bbPassword':_0x214182}),await tgBot[_0x3ad31a(0x1c9)](_0x3df374[_0x3ad31a(0x1a5)]['id'],_0x3ad31a(0x26c)+_0xe7bad8,{'parse_mode':_0x3ad31a(0x25c)})['catch'](_0xf6f562=>{telegramError(_0xf6f562);});}else await tgBot[_0x3ad31a(0x1c9)](_0x3df374[_0x3ad31a(0x1a5)]['id'],_0x3ad31a(0x180))[_0x3ad31a(0x1b3)](_0x36fe24=>{telegramError(_0x36fe24);});}),tgBot['removeListener']('callback_query');}));}function logging(_0xe766df){const _0x543558=_0x3ee32c;console[_0x543558(0x182)](getTimeStamp()+_0x543558(0x1b7)+_0xe766df);if(tgBot&&settings['telegramChatId']&&settings[_0x543558(0x250)]!=_0x543558(0x1a9))tgBot['sendMessage'](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0xe766df)['catch'](_0x139669=>{telegramError(_0x139669);});}function getServerTime(){const _0x53c70f=_0x3ee32c,_0x3b43cb=new Date();return _0x3b43cb[_0x53c70f(0x267)]()+'/'+(_0x3b43cb['getMonth']()+0x1)[_0x53c70f(0x1f5)]()['padStart'](0x2,'0')+'/'+_0x3b43cb[_0x53c70f(0x275)]()[_0x53c70f(0x1f5)]()[_0x53c70f(0x241)](0x2,'0')+'\x20'+_0x3b43cb[_0x53c70f(0x21a)]()[_0x53c70f(0x1f5)]()['padStart'](0x2,'0')+':'+_0x3b43cb[_0x53c70f(0x24b)]()['toString']()[_0x53c70f(0x241)](0x2,'0')+':'+_0x3b43cb[_0x53c70f(0x22f)]()[_0x53c70f(0x1f5)]()[_0x53c70f(0x241)](0x2,'0');}function getTimeStamp(){const _0x39cd6d=_0x3ee32c,_0x1ed121=shiftedTime();return _0x1ed121[_0x39cd6d(0x267)]()+'/'+(_0x1ed121[_0x39cd6d(0x28c)]()+0x1)[_0x39cd6d(0x1f5)]()[_0x39cd6d(0x241)](0x2,'0')+'/'+_0x1ed121['getDate']()[_0x39cd6d(0x1f5)]()['padStart'](0x2,'0')+'\x20'+_0x1ed121[_0x39cd6d(0x21a)]()[_0x39cd6d(0x1f5)]()['padStart'](0x2,'0')+':'+_0x1ed121['getMinutes']()[_0x39cd6d(0x1f5)]()[_0x39cd6d(0x241)](0x2,'0')+':'+_0x1ed121['getSeconds']()[_0x39cd6d(0x1f5)]()[_0x39cd6d(0x241)](0x2,'0');}function shiftedTime(){const _0x53b5fe=_0x3ee32c,_0xa16799=new Date();let _0x1a3a5d=_0xa16799;if(settings[_0x53b5fe(0x29a)]&&settings[_0x53b5fe(0x29a)]!==0x0)_0x1a3a5d=fns[_0x53b5fe(0x1dd)](_0xa16799,{'hours':settings[_0x53b5fe(0x29a)]});return _0x1a3a5d;}function startScheduler(){let _0x110d6a=new Date()['getUTCHours']();_0x110d6a==0x1&&backupConfigFiles();_0x110d6a==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x28b138=_0x3ee32c;fs[_0x28b138(0x23b)](configpath,{'withFileTypes':!![]})[_0x28b138(0x1d5)](_0x50bb58=>{const _0x3be1c6=_0x28b138;if(!_0x50bb58['isDirectory']())fs[_0x3be1c6(0x231)](configpath+_0x50bb58['name'],configbackuppath+_0x50bb58['name']);});}function triggerAnalytics(){const _0x4df5e0=_0x3ee32c;analytics[_0x4df5e0(0x256)]({'title':_0x4df5e0(0x20d),'href':'https://hodlerhacks.com','path':'/v'+serverversion});}function validateCredentials(_0xbe9e1d,_0xf14746){const _0xc4750=_0x3ee32c;if(_0xbe9e1d['username']==settings[_0xc4750(0x27b)]&&bcrypt[_0xc4750(0x294)](_0xbe9e1d['password'],settings[_0xc4750(0x202)])){if(settings[_0xc4750(0x207)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x5efcb7=generateLoginToken(_0xf14746);return{'allow':!![],'reason':_0xc4750(0x292),'token':_0x5efcb7};}}else return{'allow':![],'reason':_0xc4750(0x16f),'token':null};}function refreshToken(_0x520412){const _0x43d6ca=generateLoginToken(_0x520412);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x43d6ca};}function validateAccess(_0x217be7,_0x4f7d16){const _0x169ccc=_0x3ee32c;let _0x4060ba=devices[_0x4f7d16]['ip'],_0x501399;const _0x405aa9=_0x534c32=>{const _0x40f373=_0x6419;if(settings[_0x40f373(0x204)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x4f7d16)){const _0x2d3dd5=generateLoginToken(_0x4f7d16);return{'allow':!![],'reason':_0x40f373(0x216),'token':_0x2d3dd5};}else return{'allow':![],'reason':_0x40f373(0x26b),'token':null};}else return _0x501399=validToken(_0x534c32,_0x4f7d16),_0x501399[_0x40f373(0x278)](_0x40f373(0x2a2))?{'allow':!![],'reason':_0x40f373(0x25a),'token':_0x534c32}:{'allow':![],'reason':_0x40f373(0x26b),'token':null};}else return{'allow':!![],'reason':_0x40f373(0x201),'token':null};};if(settings[_0x169ccc(0x1b0)]){let _0x3b562f=[...settings[_0x169ccc(0x1e7)],'::1','::ffff:127.0.0.1',_0x169ccc(0x280)];if(_0x3b562f[_0x169ccc(0x1a3)](_0x4060ba))return _0x405aa9(_0x217be7);else{_0x501399=validToken(_0x217be7,_0x4f7d16);if(_0x501399[_0x169ccc(0x278)]('success'))return _0x405aa9(_0x217be7);else{if(telegramIpApproved(_0x4f7d16)){const _0x56827f=generateToken(_0x4f7d16);return _0x501399=_0x405aa9(_0x217be7),_0x501399[_0x169ccc(0x19a)]?{'allow':!![],'reason':_0x169ccc(0x249),'token':_0x56827f}:_0x501399;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x169ccc(0x170),'token':null};}}}else return _0x405aa9(_0x217be7);}function timelyDecrypt(_0x2edfdb,_0x41fc87=!![]){const _0x2226a7=_0x3ee32c;if(_0x2edfdb)try{const _0x226199=crypt[_0x2226a7(0x213)](secure[_0x2226a7(0x19f)],_0x2edfdb)[_0x2226a7(0x1ca)],_0x17466b=_0x226199[_0x2226a7(0x1f3)]('@')[0x0],_0x29c5d2=_0x226199[_0x2226a7(0x1f3)]('@')[0x1],_0x377c3d=new Date()[_0x2226a7(0x1fe)]();if(_0x41fc87){if(_0x377c3d-_0x29c5d2<maxSecretAge*0x3e8)return _0x17466b;else return![];}else return _0x17466b;}catch(_0x5c4b0f){return![];}else return![];}function _0x6419(_0x181468,_0x55aae2){const _0x3e0d0b=_0xce43();return _0x6419=function(_0x286622,_0xb54dc7){_0x286622=_0x286622-0x160;let _0xce43d4=_0x3e0d0b[_0x286622];return _0xce43d4;},_0x6419(_0x181468,_0x55aae2);}const validToken=(_0x1bff0f,_0xda8ac)=>{const _0x293589=_0x3ee32c,_0x2c5f9b=devices[_0xda8ac]['ip'];if(!_0x1bff0f)return{'error':_0x293589(0x286)};for(let _0x139d8f of blacklist){if(_0x139d8f[_0x293589(0x17b)]==_0x1bff0f)return{'error':_0x293589(0x188)};}let _0x13491a;try{_0x13491a=jwt[_0x293589(0x211)](_0x1bff0f,secure[_0x293589(0x1a4)]+_0xda8ac);}catch{return{'error':_0x293589(0x190)};}if(!_0x13491a[_0x293589(0x278)](_0x293589(0x1e9))&&!_0x13491a['hasOwnProperty'](_0x293589(0x17e))||!_0x13491a['hasOwnProperty'](_0x293589(0x1fc)))return{'error':_0x293589(0x19c)};if(!_0x13491a[_0x293589(0x278)]('username')&&_0x13491a[_0x293589(0x278)]('clientip')){const {clientip:_0x31da2c}=_0x13491a;return _0x2c5f9b==_0x31da2c?{'success':_0x293589(0x22e)}:{'error':_0x293589(0x1d7)};}else{if(_0x13491a[_0x293589(0x278)](_0x293589(0x17e))&&_0x13491a[_0x293589(0x278)](_0x293589(0x1e9))){const {username:_0x1dad6c,clientip:_0x53b133}=_0x13491a;return settings[_0x293589(0x27b)]==_0x1dad6c&&_0x2c5f9b==_0x53b133?{'success':_0x293589(0x22e)}:{'error':_0x293589(0x19e)};}}},generateLoginToken=_0x4fb2ff=>{const _0x3e1585=_0x3ee32c;if(_0x4fb2ff){const _0x58cd03=devices[_0x4fb2ff]['ip'];return jwt[_0x3e1585(0x167)]({'username':settings['bbUsername'],'clientip':_0x58cd03},secure[_0x3e1585(0x1a4)]+_0x4fb2ff,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x38e4cd=>{const _0x21f9c6=_0x3ee32c;if(_0x38e4cd){const _0x4d486c=devices[_0x38e4cd]['ip'];return jwt[_0x21f9c6(0x167)]({'clientip':_0x4d486c},secure[_0x21f9c6(0x1a4)]+_0x38e4cd,{'expiresIn':devices[_0x38e4cd][_0x21f9c6(0x228)][_0x21f9c6(0x205)]*0x3c});}else return![];},telegramIpApproved=_0x306475=>{const _0x30f132=_0x3ee32c;let _0x5e84a0=![];return devices[_0x306475][_0x30f132(0x228)]&&devices[_0x306475]['telegramIpApproval'][_0x30f132(0x205)]!=_0x30f132(0x18f)&&(_0x5e84a0=devices[_0x306475][_0x30f132(0x228)]['clientip']==devices[_0x306475]['ip']&&new Date()[_0x30f132(0x1fe)]()-devices[_0x306475][_0x30f132(0x228)]['timestamp']<devices[_0x306475][_0x30f132(0x228)]['expiry']*0x3c*0x3e8),_0x5e84a0;},telegram2FaApproved=_0x3dc6ba=>{const _0x4e52a3=_0x3ee32c;let _0x5a9414=![];return devices[_0x3dc6ba][_0x4e52a3(0x274)]&&devices[_0x3dc6ba]['telegram2FaApproval'][_0x4e52a3(0x205)]!=_0x4e52a3(0x18f)&&(_0x5a9414=devices[_0x3dc6ba][_0x4e52a3(0x274)][_0x4e52a3(0x1e9)]==devices[_0x3dc6ba]['ip']&&new Date()[_0x4e52a3(0x1fe)]()-devices[_0x3dc6ba]['telegram2FaApproval'][_0x4e52a3(0x289)]<devices[_0x3dc6ba]['telegram2FaApproval'][_0x4e52a3(0x205)]*0x3c*0x3e8),_0x5a9414;},normalizeIP=_0x39ba58=>{const _0x52908b=_0x3ee32c;let _0x510ed6=null,_0x3b9d94=null;if(ipaddr[_0x52908b(0x206)](_0x39ba58)){const _0x37725b=ipaddr['parse'](_0x39ba58);_0x37725b[_0x52908b(0x1da)]()===_0x52908b(0x1c5)?(_0x37725b['isIPv4MappedAddress']()&&(_0x510ed6=_0x37725b['toIPv4Address']()[_0x52908b(0x1f5)]()),_0x3b9d94=_0x37725b['toString']()):(_0x510ed6=_0x37725b[_0x52908b(0x1f5)](),_0x3b9d94=_0x37725b[_0x52908b(0x261)]()[_0x52908b(0x1f5)]());}return{'show':_0x510ed6?_0x510ed6:_0x3b9d94,'store':_0x3b9d94};};