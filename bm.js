const _0x4ddc53=_0x4047;(function(_0x4a715a,_0x46d7d0){const _0x25c910=_0x4047,_0x190fb1=_0x4a715a();while(!![]){try{const _0x47a036=-parseInt(_0x25c910(0x128))/0x1+-parseInt(_0x25c910(0x210))/0x2+parseInt(_0x25c910(0xf7))/0x3+-parseInt(_0x25c910(0x195))/0x4+-parseInt(_0x25c910(0x142))/0x5+parseInt(_0x25c910(0x11b))/0x6+parseInt(_0x25c910(0x144))/0x7;if(_0x47a036===_0x46d7d0)break;else _0x190fb1['push'](_0x190fb1['shift']());}catch(_0x38921c){_0x190fb1['push'](_0x190fb1['shift']());}}}(_0x45e6,0xbe361));const _0x2612dd=function(){let _0x38ca38=!![];return function(_0x402a06,_0x565493){const _0x29dfb0=_0x38ca38?function(){const _0x167447=_0x4047;if(_0x565493){const _0x1dbfb1=_0x565493[_0x167447(0x184)](_0x402a06,arguments);return _0x565493=null,_0x1dbfb1;}}:function(){};return _0x38ca38=![],_0x29dfb0;};}(),_0x28fda7=_0x2612dd(this,function(){const _0x46ec47=_0x4047;return _0x28fda7[_0x46ec47(0xeb)]()[_0x46ec47(0x28f)](_0x46ec47(0xff))[_0x46ec47(0xeb)]()[_0x46ec47(0x104)](_0x28fda7)[_0x46ec47(0x28f)](_0x46ec47(0xff));});_0x28fda7();'use strict';process[_0x4ddc53(0x10a)][_0x4ddc53(0x232)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x4ddc53(0x101)),low=require(_0x4ddc53(0x1bb)),FileSync=require(_0x4ddc53(0x212)),path=require(_0x4ddc53(0x10b)),crypto=require('crypto'),Crypt=require(_0x4ddc53(0x154))[_0x4ddc53(0x106)],RSA=require('hybrid-crypto-js')[_0x4ddc53(0x1a0)],bcrypt=require(_0x4ddc53(0x27c)),jwt=require(_0x4ddc53(0x245)),ipaddr=require(_0x4ddc53(0x16e)),argv=require(_0x4ddc53(0x251))(process[_0x4ddc53(0x236)][_0x4ddc53(0x203)](0x2))[_0x4ddc53(0x236)],uuidRandom=require('uuid-random'),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require('mixpanel'),axios=require(_0x4ddc53(0x1fc)),{GraphQLClient,gql}=require(_0x4ddc53(0x15f)),util=require('util'),fileUpload=require(_0x4ddc53(0x1e8)),{networkInterfaces}=require('os'),PORT=argv[_0x4ddc53(0x19d)]||_0x4ddc53(0x237),pattern=/^[0-9]{2,4}$/;!pattern[_0x4ddc53(0x18c)](PORT)&&(console[_0x4ddc53(0x10c)](_0x4ddc53(0x230)+PORT+_0x4ddc53(0x157)),process[_0x4ddc53(0x129)](0x1));function _0x4047(_0x25b60e,_0x475c6c){const _0x4b7e3d=_0x45e6();return _0x4047=function(_0x28fda7,_0x2612dd){_0x28fda7=_0x28fda7-0xeb;let _0x45e6ab=_0x4b7e3d[_0x28fda7];return _0x45e6ab;},_0x4047(_0x25b60e,_0x475c6c);}const HOST=argv['host']||null,userID=argv[_0x4ddc53(0x2ad)]||'',debugging=argv['d']||![],nodeversion=process[_0x4ddc53(0x283)]['node'],environment=require('./version.json')['environment']||'production';let bbpath=_0x4ddc53(0x2c1),bbpath2='';const botfile=_0x4ddc53(0x1ce),configfile=_0x4ddc53(0x269),settingsfile='bb-settings.json',securefile=_0x4ddc53(0x18d),maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x4ddc53(0x122)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x4ddc53(0x27b),configbackuppath=configpath+_0x4ddc53(0x1e1),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x4ddc53(0x1e5),zippath=userID?bbpath+_0x4ddc53(0x13a)+userID+'/':bbpath+_0x4ddc53(0x13a),loggerfile=fs[_0x4ddc53(0x277)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x4ddc53(0x1d1)+userID+'/':bbpath+'temp/';!fs[_0x4ddc53(0x1d4)](configpath)&&fs[_0x4ddc53(0x1ac)](configpath);!fs[_0x4ddc53(0x1d4)](configbackuppath)&&fs[_0x4ddc53(0x1ac)](configbackuppath);!fs[_0x4ddc53(0x1d4)](logspath)&&fs[_0x4ddc53(0x1ac)](logspath);!fs[_0x4ddc53(0x1d4)](zippath)&&fs[_0x4ddc53(0x1ac)](zippath);!fs['existsSync'](temppath)&&fs[_0x4ddc53(0x1ac)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x4ddc53(0x117)]({'bots':[]})[_0x4ddc53(0x249)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x4ddc53(0x24d),'onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4ddc53(0x117)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x4ddc53(0x225),'rsaStandard':_0x4ddc53(0x1da)});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x4ddc53(0x281),{'host':_0x4ddc53(0x260)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x4ddc53(0x213)]&&settings[_0x4ddc53(0x213)]!=''&&settings[_0x4ddc53(0x2ac)]&&settings[_0x4ddc53(0x2ac)]!='')initTelegram();const parseColor=(_0x37c336,_0x55adde)=>{const _0x293040=_0x4ddc53,_0x512fa2=/#[A-Z]{3}#/g;if(typeof _0x37c336==_0x293040(0x1d3)){!_0x55adde?_0x37c336=_0x37c336[_0x293040(0x231)](_0x512fa2,''):(_0x37c336=_0x37c336[_0x293040(0x231)](/#BLU#/g,_0x293040(0x223)),_0x37c336=_0x37c336[_0x293040(0x231)](/#RED#/g,_0x293040(0x15e)),_0x37c336=_0x37c336['replace'](/#YEL#/g,_0x293040(0x107)),_0x37c336=_0x37c336[_0x293040(0x231)](/#MAG#/g,_0x293040(0x28b)),_0x37c336=_0x37c336[_0x293040(0x231)](/#CYA#/g,_0x293040(0x214)),_0x37c336=_0x37c336[_0x293040(0x231)](/#RES#/g,'\x1b[0m'));;}return _0x37c336;},logger={'screen':_0x5bd195=>{const _0x1e77e4=_0x4ddc53;console[_0x1e77e4(0x10c)](parseColor(_0x5bd195,!![]));},'simple':_0x11376f=>{const _0x542e53=_0x4ddc53;console[_0x542e53(0x10c)](parseColor(_0x11376f,!![])),loggerfile[_0x542e53(0x249)](util['format'](parseColor(_0x11376f,![]))+'\x0a');},'full':async _0x3a4e3a=>{const _0x447b30=_0x4ddc53,_0x35bada=getTimeStamp()+_0x447b30(0x14d)+_0x3a4e3a;console['log'](parseColor(_0x35bada,!![])),loggerfile[_0x447b30(0x249)](util[_0x447b30(0x1a5)](parseColor(_0x35bada,![]))+'\x0a');if(tgBot&&settings[_0x447b30(0x290)]&&settings['telegramEvents']!='orders')await tgBot[_0x447b30(0x1e7)](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+parseColor(_0x3a4e3a,![]))[_0x447b30(0x205)](_0x1cab15=>{telegramError(_0x1cab15);});},'debug':async(_0x302d4b,_0x508e36='')=>{const _0x4f8ceb=_0x4ddc53,_0x5757a4=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x302d4b;if(debugging)console[_0x4f8ceb(0x10c)](parseColor(_0x5757a4,!![]));loggerfile['write'](util[_0x4f8ceb(0x1a5)](parseColor(_0x5757a4,![]))+'\x0a');if(_0x508e36){if(debugging)console[_0x4f8ceb(0x10c)](_0x508e36);loggerfile[_0x4f8ceb(0x249)](util[_0x4f8ceb(0x1a5)](_0x508e36)+'\x0a');}}};process['on']('uncaughtException',function(_0x5b5ac8){const _0x351402=_0x4ddc53;logger[_0x351402(0x266)](_0x5b5ac8);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x4ddc53(0x29c))[_0x4ddc53(0x151)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];function _0x45e6(){const _0x5ae52f=['value','127.0.0.1','Error:\x20Invalid\x20argument\x20','replace','NTBA_FIX_319','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','15\x20min','argv','3000','accept','Unauthorized\x20attempt\x20to\x20confirm\x20message','file','ipc','File\x20uploaded','<b>Telegram\x20Bot\x20Status:</b>\x0a','initclient','sendFile','\x20(1)','output-002.log','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','family','send','jsonwebtoken','telegramEvents','params','whitelist','write','2FA\x20login\x20required','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','allow','0.0.0','-config.json','bots','status','yargs/yargs','HTML','2FA','login\x20token\x20valid','access','\x20to\x20','statSync','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','update','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','reset-history','token','Disabled\x20Bot\x20','storeFiat','data','api-eu.mixpanel.com','timestamp','Unauthorized\x20attempt\x20to\x20download\x20','writeFileSync','all','temporaryAccessAllowed','simple','bot-','build','bb-config.json','1000','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Invalid\x20authentication\x20token\x20(2)','socket.io','listen','Your\x20installation\x20is\x20already\x20up\x20to\x20date','getTime','max','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','updatebotmanager','Notifications\x20disabled\x0a','decrypt','createWriteStream','</b>\x20?','generate','secret','config/','bcryptjs','Allow\x20login\x20from\x20IP\x20address\x20<b>','get-starting-balances','hasOwnProperty','static','6b67f3d61ee94b8f5c80b4affef4c4d9','clientip','versions','express','timeshift','polling_error','privateKey','logout','reinstall-bb','ipv6','\x1b[35m','push','getDate','login\x20not\x20required','search','telegramChatId','index.html','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','sendPortfolioTelegram',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','apiPassword','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Unauthorized\x20attempt\x20to\x20delete\x20alerts','parse','2FA\x20required','once','toIPv4Address','version.json','backup','Deleted\x20Bot\x20','sort','Restarting\x20Bot\x20','messages','Backup\x20file\x20uploaded','lastmsgemitted','length','error','/download/:type','output-003.log','get-logs','includes','getMinutes','Node.js\x20v','telegramUsername','user','isDirectory','storeConfiguration','range','apiSecret','backupfile','stopPolling','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','getSeconds','Session\x20expired\x20for\x20user\x20...','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','request','Password\x20reset\x20rejected','/status\x20-\x20show\x20bot(s)\x20status\x0a','build2','backup-full','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','forEach','http','getFullYear','bb/','sortBy','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','args','store','telegram2FaApproval','bbUsername','pidRefreshToken','toString','::ffff:127.0.0.1','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','output-001.log','All','Error\x20while\x20deleting\x20config\x20files:\x20','number','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Invalid\x20IP\x20address','tkn','Logged\x20in\x20user\x20...','/enable\x20-\x20enable\x20notifications\x0a','791835NaYrgV','telegramIpApproval','invalid\x20credentials','(staging)','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','message','/:bot/coins','success','(((.+)+)+)+$','/:bot/history','date-fns','/help\x20-\x20show\x20available\x20commands\x0a','/off\x20-\x20stop\x20bot(s)\x0a','constructor','Access\x20enabled\x20for\x20','Crypt','\x1b[33m','rmSync','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','env','path','log','telegramEnabled','headers','backup-files','\x20|\x20','randomFillSync','binary','function','Unauthorized\x20attempt\x20to\x20get\x20events','running','-----------------------------------------------------------------------------------','defaults','login','answerCallbackQuery','telegrammsg','6653886wnqctH','getPortfolio','get-messages','Starting\x20new\x20bot\x20|\x20Bot\x20','Failed\x20to\x20download\x20','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','username','clients','toggle-bot-mode','title','-events.json','emitHistory','Temporary\x20access\x20rejected','751184kCVHDK','exit','f2aRequired','private','from','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Token\x20blacklisted','Restoring\x20bot(s)\x20from\x20backup','logs','/:bot/performance','*$1*','isIPv4MappedAddress','confirm-message','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','pidExpireLogin','/:bot/portfolio','reason','temporary\x20access\x20rejected','zip/','get','Notifications\x20types:\x20','toIPv4MappedAddress','Markdown','startsWith','expiry','publicKey','1392850OUJtBC','Starting\x20Balance\x20Bot\x20reinstallation','11268040gCAuQF','min','SIGTERM','generateKeyPairAsync','temporary\x20token\x20generated','Unauthorized\x20attempt\x20to\x20show\x20configuration','storeHeadless','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','randomBytes',':\x20Bot\x20Mgr\x20>\x20','Invalid\x20authentication\x20token\x20(1)','Starting\x20#RED#Balance\x20Bot\x20v','/update\x20-\x20update\x20Balance\x20Bot\x0a','version','/on\x20-\x20start\x20bot(s)\x0a','reset-password','hybrid-crypto-js','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','sockets',',\x20must\x20be\x20a\x204\x20digit\x20number','Setting\x20access:\x20','toggleBotMode','readFileSync','assign','new','All\x20bots\x20running\x20right\x20now','\x1b[31m','graphql-request','Restore\x20backup\x20file\x20','socket','download','match','/metrics\x20-\x20show\x20bot\x20performance\x0a','started','login\x20token\x20generated','getStartingBalances','orders','temporary\x20access\x20timeout','bbPassword','backup-full.zip','readdirSync','Bot\x20','ipaddr.js','Password\x20has\x20been\x20reset\x20to:\x20','settings.','\x20(2)','padStart','map','full','enabled','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Notifications\x20disabled','then','reload','add','botname','track','files','isValid','apiKey','No\x20authentication\x20token','connection','secure','Unauthorized\x20attempt\x20to\x20delete\x20bot','apply','handshake','emit','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Login\x20rejected','chat','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','test','bb-secure.json','#RES#\x20if\x20running\x20on\x20server','Unauthorized\x20attempt\x20to\x20log\x20out','Restore\x20process\x20aborted','Logged\x20out\x20user\x20...','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','No\x20bots\x20running\x20right\x20now','password','4423552WUABFV','type','unlinkSync','reinstall','staging','sign','split','disabled','port','************','Unauthorized\x20attempt\x20to\x20store\x20configuration','RSA','place-order','backup-full@','bbvNew','store-fiat','format','Login\x20accepted','mtime','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','kill','userid','keys','mkdirSync','getMonth','404\x20Not\x20Found','All\x20bots','alerts','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','manual','lastmsgtelegram','exp','store-settings','stringify','address','getHours','node-zip','Ok,\x20will\x20send\x20order\x20notifications\x20only','lowdb','set','auto','compareSync','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','add-bot','Yes','.zip','new-disabled','hex','output-000.log','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Unauthorized\x20attempt\x20to\x20update\x20settings','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','-results.json','notification','/:bot/configuration','conn','bot.js','getUTCHours','Backup\x20file\x20unzipped\x20and\x20stored','temp/','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','string','existsSync','remoteAddress','bb-settings.json','stopped','whitelistEnabled','update-bot','RSA-OAEP','***','get-backup-files','join','Unauthorized\x20attempt\x20to\x20add\x20bot','name','Enabled\x20Bot\x20','backup/','=>\x20Go\x20to\x20#CYA#http://','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','delete-bot','logs/','uuid','sendMessage','express-fileupload','disconnect','Starting\x20bot\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Unauthorized\x20attempt\x20to\x20update\x20bot','event','live','User\x20has\x20been\x20validated','restore-backup-file','filter','-performance.json','stop','cancelLoading','login\x20required','logged\x20out','latestversion','update-bb','copyFileSync','sendMetricsTelegram','botmanager','axios','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','hashSync','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','access\x20timeout','cancel-loading','\x20only\x0a','slice','yes','catch','mode','headless','createServer','\x20|\x20client:\x20...','#RES#\x20if\x20running\x20locally\x0a','debug','https://api.ipify.org?format=json','Invalid\x20Telegram\x20token','remove','botID','135798ztgZnC','use','lowdb/adapters/FileSync','telegramToken','\x1b[36m','settings','removeListener','/:bot/support','find','bot','callback_query','onepagemode','show','30\x20min','Error\x20removing\x20old\x20backup\x20files:','removeAllListeners','\x20mode','blacklist','inherit','\x1b[34m','showConfig','sha256','restart','2FA\x20login\x20token\x20generated','cloneDeep','loginRequired','warning','Unauthorized\x20login\x20attempt\x20(timeout)','onText','reject'];_0x45e6=function(){return _0x5ae52f;};return _0x45e6();}const express=require(_0x4ddc53(0x284)),app=express(),http=require(_0x4ddc53(0x2bf))[_0x4ddc53(0x208)](app);app[_0x4ddc53(0x211)](fileUpload({'useTempFiles':!![]})),app[_0x4ddc53(0x13b)](_0x4ddc53(0x2a6),async(_0x3bc77b,_0x2b81af)=>{const _0x332ce8=_0x4ddc53,_0x114edc=_0x3bc77b[_0x332ce8(0x247)][_0x332ce8(0x196)],_0x18cc97=getClientsWithBotID('botmanager'),_0x16ed91=_0x3bc77b['headers'][_0x332ce8(0x1e6)],_0x176bec=timelyDecrypt(_0x16ed91,![]),_0x14e43e=_0x18cc97[_0x332ce8(0x218)](_0x2a6291=>_0x2a6291[_0x332ce8(0x1e6)]==_0x176bec);if(_0x14e43e){const _0x1cafe3=normalizeIP(_0x3bc77b[_0x332ce8(0x161)][_0x332ce8(0x1d5)])[_0x332ce8(0x2c5)],_0x426707=_0x3bc77b[_0x332ce8(0x10e)][_0x332ce8(0xf4)];if(validateAccess(_0x426707,_0x176bec,_0x1cafe3)['allow'])_0x114edc==_0x332ce8(0x29d)&&await backupConfigFiles(),await zipFiles(_0x114edc),_0x2b81af[_0x332ce8(0x162)](zippath+(_0x114edc+'.zip'),_0x1c73f4=>{const _0x2d34ba=_0x332ce8;_0x1c73f4&&(logger[_0x2d34ba(0x174)](_0x2d34ba(0x11f)+_0x114edc),logger[_0x2d34ba(0x266)](_0x1c73f4));});else logger[_0x332ce8(0x174)](_0x332ce8(0x262)+_0x114edc+_0x332ce8(0x240));}else logger[_0x332ce8(0x174)](_0x332ce8(0x262)+_0x114edc+_0x332ce8(0x171));}),app['post']('/upload-backup',async(_0x18103a,_0x452138)=>{const _0x59ca8d=_0x4ddc53,_0x29a846=getClientsWithBotID(_0x59ca8d(0x1fb)),_0x17f265=_0x18103a[_0x59ca8d(0x10e)][_0x59ca8d(0x1e6)],_0x55e857=timelyDecrypt(_0x17f265,![]),_0x495831=_0x29a846[_0x59ca8d(0x218)](_0x267b2b=>_0x267b2b[_0x59ca8d(0x1e6)]==_0x55e857);logger['debug'](_0x59ca8d(0x2a2));if(_0x495831){const _0x2e9dec=normalizeIP(_0x18103a['socket'][_0x59ca8d(0x1d5)])[_0x59ca8d(0x2c5)],_0x352981=_0x18103a[_0x59ca8d(0x10e)][_0x59ca8d(0xf4)];if(validateAccess(_0x352981,_0x55e857,_0x2e9dec)['allow']){if(_0x18103a[_0x59ca8d(0x17d)]){const _0x25dcc7=_0x18103a['files'][_0x59ca8d(0x2b2)];await _0x25dcc7['mv'](temppath+_0x25dcc7[_0x59ca8d(0x1df)]),_0x452138[_0x59ca8d(0x244)]({'status':!![],'message':_0x59ca8d(0x23c)});const _0x2847f6=getBotsWithMode();_0x2847f6[_0x59ca8d(0x2a4)]>0x0?confirmRestore(temppath,_0x25dcc7[_0x59ca8d(0x1df)]):unzipFile(temppath,_0x25dcc7[_0x59ca8d(0x1df)]);}}else logger[_0x59ca8d(0x174)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger['full'](_0x59ca8d(0x25a));}),app[_0x4ddc53(0x211)](express[_0x4ddc53(0x280)](path[_0x4ddc53(0x1dd)](__dirname,bbpath2,_0x4ddc53(0x2bb)))),app['use'](express[_0x4ddc53(0x280)](path['join'](__dirname,bbpath2,_0x4ddc53(0x268)))),app[_0x4ddc53(0x13b)]('/',function(_0x44db1e,_0x5d0d18){const _0x4e50f7=_0x4ddc53;_0x5d0d18['sendFile'](path[_0x4e50f7(0x1dd)](__dirname,bbpath2,_0x4e50f7(0x2bb),_0x4e50f7(0x291)));}),app[_0x4ddc53(0x13b)]('/:bot',function(_0x20bbc3,_0xef8b7c){const _0x19e32b=_0x4ddc53;_0xef8b7c[_0x19e32b(0x23f)](path['join'](__dirname,bbpath2,_0x19e32b(0x268),'index.html'));}),app[_0x4ddc53(0x13b)](_0x4ddc53(0x137),(_0x9729cb,_0x4a0bac)=>{const _0xf93dbe=_0x4ddc53;_0x4a0bac[_0xf93dbe(0x23f)](path[_0xf93dbe(0x1dd)](__dirname,bbpath2,_0xf93dbe(0x268),_0xf93dbe(0x291)));}),app['get'](_0x4ddc53(0x131),(_0xfac2d5,_0x3537a1)=>{const _0x5992d1=_0x4ddc53;_0x3537a1[_0x5992d1(0x23f)](path['join'](__dirname,bbpath2,'build',_0x5992d1(0x291)));}),app[_0x4ddc53(0x13b)](_0x4ddc53(0xfd),(_0x64d99c,_0x1d5546)=>{const _0x51b7ab=_0x4ddc53;_0x1d5546[_0x51b7ab(0x23f)](path['join'](__dirname,bbpath2,_0x51b7ab(0x268),'index.html'));}),app['get'](_0x4ddc53(0x100),(_0x20a65a,_0x1d8877)=>{const _0x5ce0e7=_0x4ddc53;_0x1d8877['sendFile'](path[_0x5ce0e7(0x1dd)](__dirname,bbpath2,_0x5ce0e7(0x268),'index.html'));}),app[_0x4ddc53(0x13b)](_0x4ddc53(0x1cc),(_0xb222b9,_0x1a8afb)=>{const _0x517f38=_0x4ddc53;_0x1a8afb['sendFile'](path['join'](__dirname,bbpath2,_0x517f38(0x268),'index.html'));}),app[_0x4ddc53(0x13b)](_0x4ddc53(0x217),(_0x27ba0f,_0x2d6f5c)=>{const _0x8a5f4e=_0x4ddc53;_0x2d6f5c['sendFile'](path[_0x8a5f4e(0x1dd)](__dirname,bbpath2,_0x8a5f4e(0x268),_0x8a5f4e(0x291)));});if(HOST)http[_0x4ddc53(0x26f)](PORT,HOST);else http[_0x4ddc53(0x26f)](PORT);const io=require(_0x4ddc53(0x26e))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x4ef8df=_0x4ddc53;let _0x1508f7='[ip-address]';const _0x2501a3=networkInterfaces(),_0xaa9c15={};for(const _0xcb9d99 of Object[_0x4ef8df(0x1ab)](_0x2501a3)){for(const _0xa85425 of _0x2501a3[_0xcb9d99]){if((_0xa85425[_0x4ef8df(0x243)]=='IPv4'||_0xa85425[_0x4ef8df(0x243)]==0x4)&&!_0xa85425['internal']){const _0x161ca2=ipaddr[_0x4ef8df(0x298)](_0xa85425['address'])[_0x4ef8df(0x2b0)]();_0x161ca2!=_0x4ef8df(0x12b)&&(!_0xaa9c15[_0xcb9d99]&&(_0xaa9c15[_0xcb9d99]=[]),_0xaa9c15[_0xcb9d99][_0x4ef8df(0x28c)](_0xa85425[_0x4ef8df(0x1b7)]),_0x1508f7=_0xa85425[_0x4ef8df(0x1b7)]);}}}return{'serverip':_0x1508f7,'netinterfaces':_0xaa9c15};}async function startServer(){const _0x844932=_0x4ddc53,{serverip:_0x2f5314,netinterfaces:_0x2699fd}=getServerIP();logger[_0x844932(0x266)](''),logger[_0x844932(0x266)](_0x844932(0x116)),await logger[_0x844932(0x174)](_0x844932(0x14f)+serverversion+'#RES#\x20'+(environment==_0x844932(0x199)?_0x844932(0xfa):'')+'\x0a'+(_0x844932(0xf2)+PORT+_0x844932(0x20a))+(_0x844932(0x1e2)+_0x2f5314+':'+PORT+_0x844932(0x18e))),logger[_0x844932(0x266)](_0x844932(0x116));if(config['length']!=0x0)for(const _0x16d7b3 of config){if(_0x16d7b3[_0x844932(0x250)]==_0x844932(0x175)||_0x16d7b3['status']==_0x844932(0x15c))await logger[_0x844932(0x174)](_0x844932(0x1ea)+_0x16d7b3[_0x844932(0x20f)]+_0x844932(0x110)+_0x16d7b3[_0x844932(0x17b)]),startBot([_0x16d7b3[_0x844932(0x20f)],userID],{'cwd':bbpath},function(_0x3dae11){const _0x26f082=_0x844932;if(_0x3dae11)logger[_0x26f082(0x174)](_0x3dae11);});else(_0x16d7b3[_0x844932(0x250)]==_0x844932(0x19c)||_0x16d7b3['status']==_0x844932(0x1c4))&&await logger['full']('Idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x16d7b3[_0x844932(0x20f)]+_0x844932(0x110)+_0x16d7b3[_0x844932(0x17b)]);}else!newBot&&logger['simple']('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x844932(0x266)](_0x844932(0x116)),logger['simple'](''),await logger[_0x844932(0x20b)](_0x844932(0x2ab)+nodeversion),await logger[_0x844932(0x20b)]('Network\x20Interfaces:',_0x2699fd);}function startSocket(){const _0x129f18=_0x4ddc53;io['on'](_0x129f18(0x181),_0xbb81ba=>{const _0x1708bb=_0x129f18;let _0x5417b1,_0x2655c1,_0x40469c,_0x5b0917,_0x53089a;const _0x177b46=_0xbb81ba['handshake'][_0x1708bb(0x10e)]['referer'];_0x2655c1=_0x177b46['match'](/bot[0-9]{3}/);if(_0x2655c1)_0x40469c=_0x2655c1[0x0][_0x1708bb(0x163)](/[0-9]{3}/);if(_0x40469c)_0x5417b1=_0x40469c[0x0];else _0x5417b1=_0x1708bb(0x1fb);const _0x5a1c7c=_0xbb81ba[_0x1708bb(0x185)]['auth']['encryptedUuid'];if(!_0x5a1c7c)_0xbb81ba[_0x1708bb(0x186)](_0x1708bb(0x250),{'publicKey':secure[_0x1708bb(0x141)]});else{_0x5b0917=timelyDecrypt(_0x5a1c7c,![]);if(!_0x5b0917)_0xbb81ba[_0x1708bb(0x186)]('status',{'publicKey':secure[_0x1708bb(0x141)]});else{_0x53089a=normalizeIP(_0xbb81ba[_0x1708bb(0x1cd)][_0x1708bb(0x1d5)])[_0x1708bb(0x2c5)];if(!devices[_0x5b0917])devices[_0x5b0917]={'uuid':_0x5b0917,'access':{'token':null}};devices[_0x5b0917]['ip']=_0x53089a;const _0x328dad=addClient(_0xbb81ba['id'],_0x5b0917,_0x5417b1);setAccess(_0x328dad),emitMessages(),_0xbb81ba['on'](_0x1708bb(0x118),_0x32095d=>{const _0x5e31bf=_0x1708bb,_0x1bf99a=timelyDecrypt(_0x32095d['password']);if(_0x1bf99a){_0x32095d={'username':_0x32095d['username'],'password':_0x1bf99a},devices[_0x5b0917][_0x5e31bf(0x255)]=validateCredentials(_0x32095d,_0x5b0917);if(devices[_0x5b0917]['access'][_0x5e31bf(0x24c)]==![]&&devices[_0x5b0917]['access'][_0x5e31bf(0x138)]==_0x5e31bf(0x24a))_0xbb81ba[_0x5e31bf(0x186)]('status',{'access':devices[_0x5b0917][_0x5e31bf(0x255)]}),loginAccess2FA(_0x5b0917,_0x53089a);else{if(devices[_0x5b0917][_0x5e31bf(0x255)][_0x5e31bf(0x24c)]==![]&&devices[_0x5b0917][_0x5e31bf(0x255)]['reason']==_0x5e31bf(0xf9))_0xbb81ba['emit'](_0x5e31bf(0x250),{'access':devices[_0x5b0917][_0x5e31bf(0x255)]});else devices[_0x5b0917][_0x5e31bf(0x255)][_0x5e31bf(0x24c)]&&devices[_0x5b0917][_0x5e31bf(0x255)]['reason']=='login\x20token\x20generated'&&(getClientsWithUuid(_0x5b0917)[_0x5e31bf(0x2be)](_0x2c4b14=>{setAccess(_0x2c4b14);}),logger['debug'](_0x5e31bf(0xf5)+_0x5b0917[_0x5e31bf(0x203)](-0x8)),setTokenRefresh(_0x5b0917),setSessionTimeout(_0x5e31bf(0x118),_0x5b0917));}}else logger[_0x5e31bf(0x174)](_0x5e31bf(0x22b));}),_0xbb81ba['on'](_0x1708bb(0x153),()=>{resetPassword();}),_0xbb81ba['on'](_0x1708bb(0x1e9),_0x2d5129=>{removeClient(_0xbb81ba['id']);}),_0x5417b1==_0x1708bb(0x1fb)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4bd3af){const _0x2b62a1=_0x4ddc53;if(_0x4bd3af!=_0x2b62a1(0x1fb)&&config[_0x2b62a1(0x17f)]!=''){if(pid[_0x4bd3af])pid[_0x4bd3af]['send']({'function':_0x2b62a1(0x23e),'args':null});}_0x4bd3af!='botmanager'&&broadcastToBots('bots',JSON['stringify'](config));}function reloadBotManager(){const _0x4efe23=_0x4ddc53;getClientsWithBotID(_0x4efe23(0x1fb))[_0x4efe23(0x2be)](_0xd2784=>{const _0x9e50d1=_0x4efe23;getSocket(_0xd2784['id'])['emit'](_0x9e50d1(0x250),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x35d444){const _0x52f316=_0x4ddc53;return io[_0x52f316(0x156)][_0x52f316(0x156)][_0x52f316(0x13b)](_0x35d444);}function setAccess(_0x53ea66){const _0x4f8421=_0x4ddc53,_0x465cbe=getSocket(_0x53ea66['id']),_0x55a776=_0x53ea66['uuid'],_0x4f1d60=_0x53ea66[_0x4f8421(0x219)];devices[_0x55a776][_0x4f8421(0x255)]=validateAccess(devices[_0x55a776][_0x4f8421(0x255)][_0x4f8421(0x25c)],_0x55a776),logger['debug'](_0x4f8421(0x158)+devices[_0x55a776][_0x4f8421(0x255)]['reason']+_0x4f8421(0x209)+_0x53ea66['id'][_0x4f8421(0x203)](-0x8)+'\x20|\x20user:\x20...'+_0x55a776[_0x4f8421(0x203)](-0x8)),_0x465cbe['join'](_0x55a776);if(devices[_0x55a776][_0x4f8421(0x255)][_0x4f8421(0x24c)]){_0x465cbe[_0x4f8421(0x1dd)](_0x4f1d60);if(_0x4f1d60==_0x4f8421(0x1fb))initializeSocketBotManager(_0x465cbe);else initializeSocketBot(_0x465cbe);initClient(_0x4f1d60);}devices[_0x55a776][_0x4f8421(0x255)][_0x4f8421(0x25c)]&&devices[_0x55a776]['access'][_0x4f8421(0x138)]==_0x4f8421(0x148)&&setSessionTimeout(_0x4f8421(0x253),_0x55a776),devices[_0x55a776]['access'][_0x4f8421(0x25c)]&&devices[_0x55a776][_0x4f8421(0x255)]['reason']==_0x4f8421(0x227)&&setSessionTimeout(_0x4f8421(0x118),_0x55a776),_0x465cbe[_0x4f8421(0x186)]('status',{'status':_0x53ea66['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x55a776][_0x4f8421(0x255)],'externalip':devices[_0x55a776]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x55a776][_0x4f8421(0x255)][_0x4f8421(0x24c)]==![]&&devices[_0x55a776][_0x4f8421(0x255)][_0x4f8421(0x138)]==_0x4f8421(0x299)&&temporaryAccess2FA(_0x55a776,devices[_0x55a776]['ip']);}function setSessionTimeout(_0x5df49e,_0x1b738f){const _0x47e831=_0x4ddc53;let _0x37e636;if(_0x5df49e==_0x47e831(0x118))_0x37e636=loginExpiry*0x3c*0x3e8;else _0x37e636=devices[_0x1b738f][_0x47e831(0xf8)][_0x47e831(0x140)]*0x3c*0x3e8-(new Date()[_0x47e831(0x271)]()-devices[_0x1b738f]['telegramIpApproval'][_0x47e831(0x261)]);if(devices[_0x1b738f]['pidExpireLogin'])clearTimeout(devices[_0x1b738f][_0x47e831(0x136)]);devices[_0x1b738f][_0x47e831(0x136)]=setTimeout(()=>{const _0x4b7261=_0x47e831;if(devices[_0x1b738f][_0x4b7261(0x2c8)])clearTimeout(devices[_0x1b738f][_0x4b7261(0x2c8)]);removeSocketListeners(_0x1b738f),addBlacklist(_0x1b738f),devices[_0x1b738f][_0x4b7261(0xf8)]=null,devices[_0x1b738f]['telegram2FaApproval']=null,devices[_0x1b738f][_0x4b7261(0x255)][_0x4b7261(0x25c)]=null,logger[_0x4b7261(0x20b)](_0x4b7261(0x2b6)+_0x1b738f['slice'](-0x8)),devices[_0x1b738f][_0x4b7261(0x255)]=validateAccess(devices[_0x1b738f][_0x4b7261(0x255)][_0x4b7261(0x25c)],_0x1b738f),!(devices[_0x1b738f][_0x4b7261(0x255)][_0x4b7261(0x24c)]&&devices[_0x1b738f][_0x4b7261(0x255)][_0x4b7261(0x138)]==_0x4b7261(0x28e))&&(_0x5df49e=='login'?io['to'](_0x1b738f)['emit']('status',{'access':{'allow':![],'reason':_0x4b7261(0x200),'token':null}}):io['to'](_0x1b738f)[_0x4b7261(0x186)](_0x4b7261(0x250),{'access':{'allow':![],'reason':_0x4b7261(0x169),'token':null}})),devices[_0x1b738f][_0x4b7261(0x255)][_0x4b7261(0x25c)]=null;},_0x37e636);}function setTokenRefresh(_0x2577b9){const _0x5907ff=_0x4ddc53;if(devices[_0x2577b9][_0x5907ff(0x2c8)])clearTimeout(devices[_0x2577b9]['pidRefreshToken']);devices[_0x2577b9][_0x5907ff(0x2c8)]=setTimeout(()=>{const _0x5398aa=_0x5907ff;getClientsWithUuid(_0x2577b9)[_0x5398aa(0x2a4)]!=0x0?(devices[_0x2577b9][_0x5398aa(0x255)]=refreshToken(_0x2577b9),io['to'](_0x2577b9)[_0x5398aa(0x186)]('status',{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2577b9]['access'],'externalip':devices[_0x2577b9]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x2577b9)):clearTimeout(devices[_0x2577b9][_0x5398aa(0x2c8)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4430a7){const _0x396527=_0x4ddc53,_0x4b01a6=getClient(_0x4430a7['id'])[_0x396527(0x1e6)];_0x4430a7[_0x396527(0x186)](_0x396527(0x24f),config),_0x4430a7[_0x396527(0x186)](_0x396527(0x215),cleanSettings()),_0x4430a7['on'](_0x396527(0x1c1),_0x484e5c=>{const _0x17f69b=_0x396527;if(validateAccess(_0x484e5c,_0x4b01a6)['allow'])addBot();else logger[_0x17f69b(0x174)](_0x17f69b(0x1de));}),_0x4430a7['on'](_0x396527(0x1d9),(_0x1d9315,_0x4a9c8a)=>{const _0x4ee385=_0x396527;if(validateAccess(_0x4a9c8a,_0x4b01a6)[_0x4ee385(0x24c)])toggleBot(_0x1d9315[_0x4ee385(0x20f)],_0x1d9315[_0x4ee385(0x250)],_0x1d9315[_0x4ee385(0x1ee)]);else logger[_0x4ee385(0x174)](_0x4ee385(0x1ec));}),_0x4430a7['on'](_0x396527(0x123),(_0x5afe85,_0x4f3495)=>{const _0x1bb91d=_0x396527;if(validateAccess(_0x4f3495,_0x4b01a6)[_0x1bb91d(0x24c)])toggleBotMode(_0x5afe85);else logger[_0x1bb91d(0x174)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x4430a7['on'](_0x396527(0x1e4),(_0x3ccbe1,_0x22bc81)=>{const _0xf026a6=_0x396527;if(validateAccess(_0x22bc81,_0x4b01a6)[_0xf026a6(0x24c)])deleteBot(_0x3ccbe1);else logger['full'](_0xf026a6(0x183));}),_0x4430a7['on'](_0x396527(0x1b5),(_0x556198,_0x39cac8)=>{const _0x51a6af=_0x396527;if(validateAccess(_0x39cac8,_0x4b01a6)['allow'])storeSettings(_0x556198,!![]);else logger[_0x51a6af(0x174)](_0x51a6af(0x1c8));}),_0x4430a7['on']('update-bb',_0x1ce140=>{const _0x540463=_0x396527;if(validateAccess(_0x1ce140,_0x4b01a6)[_0x540463(0x24c)])updateBB('update');else logger[_0x540463(0x174)](_0x540463(0x292));}),_0x4430a7['on'](_0x396527(0x289),_0x29ae09=>{const _0x2e9adf=_0x396527;if(validateAccess(_0x29ae09,_0x4b01a6)['allow'])updateBB(_0x2e9adf(0x198));else logger[_0x2e9adf(0x174)](_0x2e9adf(0x187));}),_0x4430a7['on'](_0x396527(0x1dc),_0x5bd349=>{const _0x3300f8=_0x396527;if(validateAccess(_0x5bd349,_0x4b01a6)['allow']){const _0x1871cd=getClient(_0x4430a7['id']);if(_0x1871cd)getBackupFiles(_0x1871cd[_0x3300f8(0x1e6)]);else logger[_0x3300f8(0x174)](_0x3300f8(0x18a));}else logger['full'](_0x3300f8(0x1ff));}),_0x4430a7['on'](_0x396527(0x1f0),(_0x321913,_0x2dfc2b)=>{const _0x604b00=_0x396527;if(validateAccess(_0x2dfc2b,_0x4b01a6)[_0x604b00(0x24c)])restoreBackupFile(_0x321913);else logger[_0x604b00(0x174)](_0x604b00(0x1b1));}),_0x4430a7['on'](_0x396527(0x11d),_0x103529=>{const _0x2afa52=_0x396527;if(validateAccess(_0x103529,_0x4b01a6)[_0x2afa52(0x24c)])getMessages();else logger[_0x2afa52(0x174)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x4430a7['on'](_0x396527(0x134),(_0x52acc9,_0x1921cf)=>{const _0x272fd0=_0x396527;if(validateAccess(_0x1921cf,_0x4b01a6)['allow'])confirmMessage(_0x52acc9);else logger[_0x272fd0(0x174)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x4430a7['on'](_0x396527(0x288),_0x4a57d=>{const _0x1cbb94=_0x396527;if(validateAccess(_0x4a57d,_0x4b01a6)[_0x1cbb94(0x24c)]){if(devices[_0x4b01a6][_0x1cbb94(0x2c8)])clearTimeout(devices[_0x4b01a6][_0x1cbb94(0x2c8)]);if(devices[_0x4b01a6]['pidExpireLogin'])clearTimeout(devices[_0x4b01a6]['pidExpireLogin']);removeSocketListeners(getClient(_0x4430a7['id'])[_0x1cbb94(0x1e6)]),addBlacklist(_0x4b01a6),devices[_0x4b01a6]['telegramIpApproval']=null,devices[_0x4b01a6][_0x1cbb94(0x2c6)]=null,devices[_0x4b01a6]['access'][_0x1cbb94(0x25c)]=null,logger[_0x1cbb94(0x20b)](_0x1cbb94(0x191)+_0x4b01a6[_0x1cbb94(0x203)](-0x8)),io['to'](getClient(_0x4430a7['id'])['uuid'])['emit'](_0x1cbb94(0x250),{'access':{'allow':![],'reason':_0x1cbb94(0x1f6),'token':null}});}else logger[_0x1cbb94(0x174)](_0x1cbb94(0x18f));});}function initializeSocketBot(_0x1d6500){const _0x2c234c=_0x4ddc53,_0x5a25af=getClient(_0x1d6500['id'])['bot'],_0x98d12a=getClient(_0x1d6500['id'])[_0x2c234c(0x1e6)];_0x1d6500['on'](_0x2c234c(0x2a8),(_0x434877,_0x3996da)=>{const _0x124368=_0x2c234c;if(validateAccess(_0x3996da,_0x98d12a)['allow']){if(pid[_0x5a25af])pid[_0x5a25af]['send']({'function':_0x124368(0x126),'args':_0x434877});}else logger['full'](_0x124368(0x114));}),_0x1d6500['on']('delete-alerts',(_0x5b11f5,_0xa98ab)=>{const _0x8cd13f=_0x2c234c;if(validateAccess(_0xa98ab,_0x98d12a)[_0x8cd13f(0x24c)]){if(pid[_0x5a25af])pid[_0x5a25af]['send']({'function':'deleteHistoryAlerts','args':_0x5b11f5});}else logger['full'](_0x8cd13f(0x297));}),_0x1d6500['on']('get-portfolio',(_0x2bff97,_0xd157b3)=>{const _0x155f8d=_0x2c234c;if(validateAccess(_0xd157b3,_0x98d12a)[_0x155f8d(0x24c)]){if(pid[_0x5a25af])pid[_0x5a25af][_0x155f8d(0x244)]({'function':_0x155f8d(0x11c),'args':_0x2bff97});}else logger[_0x155f8d(0x174)](_0x155f8d(0x1eb));}),_0x1d6500['on']('store-configuration',(_0x5f2118,_0x2d4f50)=>{const _0x4db156=_0x2c234c;if(validateAccess(_0x2d4f50,_0x98d12a)[_0x4db156(0x24c)]){if(pid[_0x5a25af])pid[_0x5a25af][_0x4db156(0x244)]({'function':_0x4db156(0x2af),'args':_0x5f2118});}else logger['full'](_0x4db156(0x19f));}),_0x1d6500['on']('store-headless',(_0x53aa23,_0x2cd7b4)=>{const _0xd55017=_0x2c234c;if(validateAccess(_0x2cd7b4,_0x98d12a)[_0xd55017(0x24c)]){if(pid[_0x5a25af])pid[_0x5a25af][_0xd55017(0x244)]({'function':_0xd55017(0x14a),'args':_0x53aa23});}else logger['full'](_0xd55017(0x234));}),_0x1d6500['on'](_0x2c234c(0x1a4),(_0x2d2d90,_0x29f6d3)=>{const _0x119432=_0x2c234c;if(validateAccess(_0x29f6d3,_0x98d12a)[_0x119432(0x24c)]){if(pid[_0x5a25af])pid[_0x5a25af][_0x119432(0x244)]({'function':_0x119432(0x25e),'args':_0x2d2d90});}else logger[_0x119432(0x174)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x1d6500['on'](_0x2c234c(0x25b),_0x44c41b=>{const _0x365764=_0x2c234c;if(validateAccess(_0x44c41b,_0x98d12a)[_0x365764(0x24c)]){if(pid[_0x5a25af])pid[_0x5a25af][_0x365764(0x244)]({'function':'resetHistory','args':null});}else logger[_0x365764(0x174)](_0x365764(0x1c9));}),_0x1d6500['on'](_0x2c234c(0x27e),_0xca6a68=>{const _0x36afc2=_0x2c234c;if(validateAccess(_0xca6a68,_0x98d12a)[_0x36afc2(0x24c)]){if(pid[_0x5a25af])pid[_0x5a25af][_0x36afc2(0x244)]({'function':_0x36afc2(0x167),'args':null});}else logger['full'](_0x36afc2(0x120));}),_0x1d6500['on'](_0x2c234c(0x1a1),(_0x24e97e,_0x783c41)=>{const _0x277a63=_0x2c234c;if(validateAccess(_0x783c41,_0x98d12a)[_0x277a63(0x24c)]){if(pid[_0x5a25af])pid[_0x5a25af][_0x277a63(0x244)]({'function':'placeOrder','args':_0x24e97e});}else logger['full'](_0x277a63(0x1e3));}),_0x1d6500['on'](_0x2c234c(0x201),_0x2cf911=>{const _0x3a0d5f=_0x2c234c;if(validateAccess(_0x2cf911,_0x98d12a)['allow']){if(pid[_0x5a25af])pid[_0x5a25af]['send']({'function':_0x3a0d5f(0x1f4),'args':null});}else logger[_0x3a0d5f(0x174)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x1d6500['on']('show-config',_0x550c97=>{const _0x35fb75=_0x2c234c;if(validateAccess(_0x550c97,_0x98d12a)[_0x35fb75(0x24c)]){if(pid[_0x5a25af])pid[_0x5a25af][_0x35fb75(0x244)]({'function':_0x35fb75(0x224),'args':null});}else logger[_0x35fb75(0x174)](_0x35fb75(0x149));}),_0x1d6500['on'](_0x2c234c(0x1f8),_0x44af50=>{const _0x4d8ac9=_0x2c234c;if(validateAccess(_0x44af50,_0x98d12a)[_0x4d8ac9(0x24c)])updateBB(_0x4d8ac9(0x259));else logger['full'](_0x4d8ac9(0x292));}),_0x1d6500['on']('get-messages',_0x3154e5=>{const _0x50b1d5=_0x2c234c;if(validateAccess(_0x3154e5,_0x98d12a)[_0x50b1d5(0x24c)])getMessages();else logger[_0x50b1d5(0x174)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x1d6500['on'](_0x2c234c(0x134),(_0xbac766,_0x4cffb4)=>{const _0x45a756=_0x2c234c;if(validateAccess(_0x4cffb4,_0x98d12a)[_0x45a756(0x24c)])confirmMessage(_0xbac766);else logger[_0x45a756(0x174)](_0x45a756(0x239));}),_0x1d6500['on'](_0x2c234c(0x288),_0x71165c=>{const _0x37dc75=_0x2c234c;if(validateAccess(_0x71165c,_0x98d12a)[_0x37dc75(0x24c)]){if(devices[_0x98d12a]['pidRefreshToken'])clearTimeout(devices[_0x98d12a][_0x37dc75(0x2c8)]);if(devices[_0x98d12a]['pidExpireLogin'])clearTimeout(devices[_0x98d12a][_0x37dc75(0x136)]);removeSocketListeners(getClient(_0x1d6500['id'])[_0x37dc75(0x1e6)]),addBlacklist(_0x98d12a),devices[_0x98d12a][_0x37dc75(0xf8)]=null,devices[_0x98d12a][_0x37dc75(0x2c6)]=null,devices[_0x98d12a][_0x37dc75(0x255)][_0x37dc75(0x25c)]=null,logger[_0x37dc75(0x20b)](_0x37dc75(0x191)+_0x98d12a[_0x37dc75(0x203)](-0x8)),io['to'](getClient(_0x1d6500['id'])[_0x37dc75(0x1e6)])[_0x37dc75(0x186)](_0x37dc75(0x250),{'access':{'allow':![],'reason':_0x37dc75(0x1f6),'token':null}});}else logger['full'](_0x37dc75(0x18f));});}function removeSocketListeners(_0xefa9d3){const _0x37686a=_0x4ddc53;getClientsWithUuid(_0xefa9d3)[_0x37686a(0x2be)](_0x5e72db=>{const _0x58b7aa=_0x37686a;getSocket(_0x5e72db['id'])[_0x58b7aa(0x21f)]();});}function cleanSettings(){const _0x2d9ef7=_0x4ddc53;let _0x5ea7c9=settings;return settings[_0x2d9ef7(0x213)]&&settings['telegramToken']!=''&&(_0x5ea7c9={..._0x5ea7c9,'telegramToken':'************'}),settings[_0x2d9ef7(0x16a)]&&settings[_0x2d9ef7(0x16a)]!=''&&(_0x5ea7c9={..._0x5ea7c9,'bbPassword':_0x2d9ef7(0x19e)}),(settings['bbPassword']&&settings[_0x2d9ef7(0x16a)]=='***'||settings[_0x2d9ef7(0x213)]&&settings[_0x2d9ef7(0x213)]==_0x2d9ef7(0x1db))&&(_0x5ea7c9={..._0x5ea7c9,'restored':{'password':settings['bbPassword']==_0x2d9ef7(0x1db),'telegram':settings[_0x2d9ef7(0x213)]==_0x2d9ef7(0x1db)}}),_0x5ea7c9;}async function updateBB(_0x381ea6){const _0x1d3e18=_0x4ddc53;await backupConfigFiles(),installingUpdate=!![],config[_0x1d3e18(0x2be)](_0xf904a9=>{const _0x314d46=_0x1d3e18;restartBot(_0xf904a9[_0x314d46(0x20f)]);});if(_0x381ea6==_0x1d3e18(0x259))process[_0x1d3e18(0x244)]({'update':!![],'environment':environment},_0x4fc641=>{});else _0x381ea6==_0x1d3e18(0x198)&&process[_0x1d3e18(0x244)]({'reinstall':!![],'environment':environment},_0x3718e9=>{});}function startBot(_0x1274c9,_0x115904,_0x40f28c){const _0x294308=_0x4ddc53;if(debugging)_0x1274c9[_0x294308(0x28c)]('-d');let _0x300a91=![];const _0xebb204=_0x1274c9[0x0];_0x115904={..._0x115904,'stdio':[_0x294308(0x222),'inherit','inherit',_0x294308(0x23b)]},pid[_0xebb204]=childProcess['fork'](botfile,_0x1274c9,_0x115904),pid[_0xebb204]['on']('message',_0x5aacd8=>{const _0x9a132c=_0x294308;switch(Object[_0x9a132c(0x1ab)](_0x5aacd8)[0x0]){case'botname':updateBotName(_0xebb204,_0x5aacd8[_0x9a132c(0x17b)]);break;case _0x9a132c(0x274):updateBotManager();break;case _0x9a132c(0x250):updateStatus(_0xebb204,_0x5aacd8[_0x9a132c(0x250)]);break;case _0x9a132c(0x1ee):updateLive(_0xebb204,_0x5aacd8[_0x9a132c(0x1ee)]);break;case'started':updateLive(_0xebb204,_0x5aacd8[_0x9a132c(0x165)]),io['to'](_0xebb204)[_0x9a132c(0x186)]('status',{'access':{'allow':![],'reason':_0x9a132c(0x179),'token':null}});break;case _0x9a132c(0x1f3):_0x5aacd8[_0x9a132c(0x1f3)]==_0x9a132c(0x226)&&restartBot(_0xebb204);_0x5aacd8[_0x9a132c(0x1f3)]==_0x9a132c(0x1a9)&&toggleBot(_0xebb204,_0x9a132c(0x19c),_0x9a132c(0x1d7));break;case'telegram':sendTelegram(_0xebb204,_0x5aacd8['telegram']);break;case _0x9a132c(0x11a):sendTelegramMsg(_0x5aacd8['telegrammsg']);break;case _0x9a132c(0x113):io['to'](_0xebb204)[_0x9a132c(0x186)](_0x5aacd8[_0x9a132c(0x113)],_0x5aacd8[_0x9a132c(0x2c4)]);break;}}),pid[_0xebb204]['on'](_0x294308(0x2a5),function(_0x3c5e65){if(_0x300a91)return;_0x300a91=!![],_0x40f28c(_0x3c5e65);}),pid[_0xebb204]['on'](_0x294308(0x129),async function(_0x1f4b1e){const _0x2115f8=_0x294308;if(installingUpdate)return;if(_0x300a91)return;_0x300a91=!![],_0x40f28c(null);const _0x30a096=dbConfig[_0x2115f8(0x13b)]('bots')[_0x2115f8(0x218)]({'botID':_0xebb204})[_0x2115f8(0x22e)]();_0x30a096&&(_0x30a096[_0x2115f8(0x250)]==_0x2115f8(0x175)||_0x30a096[_0x2115f8(0x250)]=='new')&&(await sleep(0x3e8),updateLive(_0xebb204,_0x2115f8(0x1d7)),logger[_0x2115f8(0x174)](_0x2115f8(0x2a0)+_0xebb204),startBot([_0xebb204,userID],{'cwd':bbpath},function(_0x3ac481){const _0x2cca98=_0x2115f8;if(_0x3ac481)logger[_0x2cca98(0x174)](_0x3ac481);}));});}function stopBot(_0x611057){const _0x12c14a=_0x4ddc53;getClientsWithBotID(_0x611057)['forEach'](_0x9ff6ce=>{const _0x3486fa=_0x4047;getSocket(_0x9ff6ce['id'])[_0x3486fa(0x1e9)](!![]),removeClient(_0x9ff6ce['id']);}),pid[_0x611057]&&(pid[_0x611057][_0x12c14a(0x1a9)](),pid[_0x611057]=null);}function restartBot(_0x44a362){if(pid[_0x44a362])pid[_0x44a362]['kill']();}function addBot(){const _0x3f837f=_0x4ddc53;let _0x51f3b3;for(let _0x3db365=0x1;_0x3db365<0x3e9;_0x3db365++){_0x51f3b3=_0x3db365[_0x3f837f(0xeb)]()[_0x3f837f(0x172)](0x3,'0');let _0x5e62d0=config[_0x3f837f(0x218)](_0x3693b3=>_0x3693b3[_0x3f837f(0x20f)]==_0x51f3b3);if(!_0x5e62d0)break;}if(_0x51f3b3===_0x3f837f(0x26a)){logger[_0x3f837f(0x174)](_0x3f837f(0x192));return;}logger[_0x3f837f(0x174)](_0x3f837f(0x11e)+_0x51f3b3),dbConfig[_0x3f837f(0x13b)]('bots')[_0x3f837f(0x28c)]({'botID':_0x51f3b3,'botname':_0x3f837f(0x16d)+_0x51f3b3,'status':_0x3f837f(0x15c),'live':''})['write'](),startBot([_0x51f3b3,userID],{'cwd':bbpath},function(_0x3ee74b){if(_0x3ee74b)logger['full'](_0x3ee74b);}),config=getConfiguration(),io['to'](_0x3f837f(0x1fb))[_0x3f837f(0x186)](_0x3f837f(0x24f),config),broadcastToBots('bots',JSON[_0x3f837f(0x1b6)](config));}function deleteBot(_0x3929cc){const _0x22a2cf=_0x4ddc53;getClientsWithBotID(_0x3929cc)[_0x22a2cf(0x2be)](_0x10fa91=>{const _0x4aa019=_0x22a2cf;getSocket(_0x10fa91['id'])[_0x4aa019(0x1e9)](!![]),removeClient(_0x10fa91['id']);}),dbConfig[_0x22a2cf(0x13b)](_0x22a2cf(0x24f))[_0x22a2cf(0x20e)]({'botID':_0x3929cc})[_0x22a2cf(0x249)](),logger[_0x22a2cf(0x174)](_0x22a2cf(0x29e)+_0x3929cc),stopBot(_0x3929cc);try{if(fs['existsSync'](path[_0x22a2cf(0x1dd)](configpath,_0x22a2cf(0x267)+_0x3929cc+_0x22a2cf(0x24e))))fs['unlinkSync'](path[_0x22a2cf(0x1dd)](configpath,_0x22a2cf(0x267)+_0x3929cc+_0x22a2cf(0x24e)));if(fs['existsSync'](path[_0x22a2cf(0x1dd)](configpath,'bot-'+_0x3929cc+_0x22a2cf(0x125))))fs[_0x22a2cf(0x197)](path[_0x22a2cf(0x1dd)](configpath,_0x22a2cf(0x267)+_0x3929cc+_0x22a2cf(0x125)));if(fs[_0x22a2cf(0x1d4)](path[_0x22a2cf(0x1dd)](configpath,_0x22a2cf(0x267)+_0x3929cc+_0x22a2cf(0x1f2))))fs[_0x22a2cf(0x197)](path[_0x22a2cf(0x1dd)](configpath,_0x22a2cf(0x267)+_0x3929cc+_0x22a2cf(0x1f2)));if(fs[_0x22a2cf(0x1d4)](path['join'](configpath,_0x22a2cf(0x267)+_0x3929cc+_0x22a2cf(0x1ca))))fs[_0x22a2cf(0x197)](path['join'](configpath,_0x22a2cf(0x267)+_0x3929cc+_0x22a2cf(0x1ca)));}catch(_0xcd1df2){if(_0xcd1df2)logger[_0x22a2cf(0x174)](_0x22a2cf(0xf0),_0xcd1df2);}config=getConfiguration(),io['to']('botmanager')['emit'](_0x22a2cf(0x24f),config),broadcastToBots(_0x22a2cf(0x24f),JSON[_0x22a2cf(0x1b6)](config));}function toggleBot(_0x4938eb,_0x4005f3,_0x3167d3){const _0x234b2e=_0x4ddc53;dbConfig['get'](_0x234b2e(0x24f))[_0x234b2e(0x218)]({'botID':_0x4938eb})['assign']({'status':_0x4005f3})['assign']({'live':_0x3167d3})[_0x234b2e(0x249)]();if(_0x4005f3==_0x234b2e(0x175)||_0x4005f3==_0x234b2e(0x15c))logger[_0x234b2e(0x174)](_0x234b2e(0x1e0)+_0x4938eb),startBot([_0x4938eb,userID],{'cwd':bbpath},function(_0x3c1c8e){const _0x5a7d8e=_0x234b2e;if(_0x3c1c8e)logger[_0x5a7d8e(0x174)](_0x3c1c8e);});else(_0x4005f3==_0x234b2e(0x19c)||_0x4005f3==_0x234b2e(0x1c4))&&(logger[_0x234b2e(0x174)](_0x234b2e(0x25d)+_0x4938eb),stopBot(_0x4938eb));config=getConfiguration(),io['to'](_0x234b2e(0x1fb))['emit'](_0x234b2e(0x24f),config),broadcastToBots(_0x234b2e(0x24f),JSON[_0x234b2e(0x1b6)](config));}function toggleStatus(_0x5ddaec){const _0x133693=_0x4ddc53;let _0x7f5a68=dbConfig[_0x133693(0x13b)](_0x133693(0x24f))[_0x133693(0x218)]({'botID':_0x5ddaec})[_0x133693(0x22e)](),_0x2d21de;if(_0x7f5a68[_0x133693(0x250)]===_0x133693(0x175))_0x2d21de=_0x133693(0x19c);else{if(_0x7f5a68[_0x133693(0x250)]===_0x133693(0x15c))_0x2d21de=_0x133693(0x1c4);else{if(_0x7f5a68['status']===_0x133693(0x1c4))_0x2d21de=_0x133693(0x15c);else{if(_0x7f5a68[_0x133693(0x250)]===_0x133693(0x19c))_0x2d21de=_0x133693(0x175);}}}return _0x2d21de;}function updateStatus(_0x90b38c,_0x454e53){const _0x44f8b8=_0x4ddc53;dbConfig[_0x44f8b8(0x13b)](_0x44f8b8(0x24f))[_0x44f8b8(0x218)]({'botID':_0x90b38c})['assign']({'status':_0x454e53})[_0x44f8b8(0x249)](),config=getConfiguration(),io['to'](_0x44f8b8(0x1fb))[_0x44f8b8(0x186)](_0x44f8b8(0x24f),config),broadcastToBots('bots',JSON[_0x44f8b8(0x1b6)](config));}function updateLive(_0x4d7bee,_0x117aa2){const _0x30f78c=_0x4ddc53;dbConfig[_0x30f78c(0x13b)](_0x30f78c(0x24f))[_0x30f78c(0x218)]({'botID':_0x4d7bee})[_0x30f78c(0x15b)]({'live':_0x117aa2})[_0x30f78c(0x249)](),config=getConfiguration(),io['to'](_0x30f78c(0x1fb))[_0x30f78c(0x186)](_0x30f78c(0x24f),config),broadcastToBots(_0x30f78c(0x24f),JSON['stringify'](config));}function updateBotName(_0x289af2,_0x947338){const _0x5d4d90=_0x4ddc53;dbConfig[_0x5d4d90(0x13b)](_0x5d4d90(0x24f))[_0x5d4d90(0x218)]({'botID':_0x289af2})[_0x5d4d90(0x15b)]({'botname':_0x947338})[_0x5d4d90(0x249)](),config=getConfiguration(),io['to'](_0x5d4d90(0x1fb))['emit']('bots',config),broadcastToBots(_0x5d4d90(0x24f),JSON[_0x5d4d90(0x1b6)](config));}function updateBotManager(){const _0x4964bf=_0x4ddc53;config=getConfiguration(),io['to'](_0x4964bf(0x1fb))['emit']('bots',config),broadcastToBots(_0x4964bf(0x24f),JSON[_0x4964bf(0x1b6)](config));}function toggleBotMode(_0x358e6c){const _0x155a3d=_0x4ddc53;if(pid[_0x358e6c])pid[_0x358e6c][_0x155a3d(0x244)]({'function':_0x155a3d(0x159),'args':null});else{const _0x1d4052=configpath+_0x155a3d(0x267)+_0x358e6c+_0x155a3d(0x24e),_0x444212=fs[_0x155a3d(0x15a)](_0x1d4052),_0x55f137=JSON[_0x155a3d(0x298)](_0x444212),_0x5c7818=_0x55f137[_0x155a3d(0x219)][0x0]['headless'];_0x55f137[_0x155a3d(0x219)][0x0][_0x155a3d(0x207)]=!_0x5c7818;const _0x1d4fa8=JSON[_0x155a3d(0x1b6)](_0x55f137,null,0x2);fs[_0x155a3d(0x263)](_0x1d4052,_0x1d4fa8),config=getConfiguration(),io['to'](_0x155a3d(0x1fb))[_0x155a3d(0x186)](_0x155a3d(0x24f),config),broadcastToBots(_0x155a3d(0x24f),JSON[_0x155a3d(0x1b6)](config));}}function telegramError(_0x13cd41){const _0x505120=_0x4ddc53;logger[_0x505120(0x266)](getTimeStamp()+_0x505120(0x294));}function validateTelegram(_0x12fe2f){const _0xac507d=_0x4ddc53;if(_0x12fe2f[_0xac507d(0x12c)][_0xac507d(0x121)]!=settings[_0xac507d(0x2ac)]&&'@'+_0x12fe2f['from'][_0xac507d(0x121)]!=settings[_0xac507d(0x2ac)])return tgBot[_0xac507d(0x1e7)](_0x12fe2f[_0xac507d(0x189)]['id'],_0xac507d(0x1fd),{'parse_mode':_0xac507d(0x252)})[_0xac507d(0x205)](_0x5207a2=>{telegramError(_0x5207a2);}),![];return!![];}async function initTelegram(){const _0x1b0886=_0x4ddc53;if(tgBot)tgBot[_0x1b0886(0x2b3)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x1b0886(0x213)],{'polling':!![]});let _0x7597a3='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x7597a3+='\x0a',_0x7597a3+=_0x1b0886(0xf6),_0x7597a3+='/disable\x20-\x20disable\x20notifications\x0a',_0x7597a3+=_0x1b0886(0x258),_0x7597a3+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x7597a3+=_0x1b0886(0x152),_0x7597a3+=_0x1b0886(0x103),_0x7597a3+=_0x1b0886(0x155),_0x7597a3+='/names\x20-\x20show\x20bot\x20names\x0a',_0x7597a3+=_0x1b0886(0x2ba),_0x7597a3+=_0x1b0886(0x164),_0x7597a3+=_0x1b0886(0x24b),_0x7597a3+=_0x1b0886(0x150),_0x7597a3+=_0x1b0886(0x296),_0x7597a3+=_0x1b0886(0x102);let _0x1da1f7='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x1da1f7+='\x0a',_0x1da1f7+=_0x7597a3,tgBot['onText'](/\/start/,_0x3ca195=>{const _0x40e504=_0x1b0886;if(!validateTelegram(_0x3ca195))return;if(settings['telegramChatId']!=_0x3ca195[_0x40e504(0x189)]['id'])updateSetting(_0x40e504(0x290),_0x3ca195[_0x40e504(0x189)]['id']);updateSetting(_0x40e504(0x10d),!![]),tgBot['sendMessage'](_0x3ca195[_0x40e504(0x189)]['id'],_0x1da1f7)[_0x40e504(0x205)](_0x45cb31=>{telegramError(_0x45cb31);});}),tgBot[_0x1b0886(0x22c)](/\/enable/,_0xf44b38=>{const _0x2a6e34=_0x1b0886;if(!validateTelegram(_0xf44b38))return;if(settings[_0x2a6e34(0x290)]!=_0xf44b38[_0x2a6e34(0x189)]['id'])updateSetting(_0x2a6e34(0x290),_0xf44b38[_0x2a6e34(0x189)]['id']);updateSetting(_0x2a6e34(0x10d),!![]),tgBot[_0x2a6e34(0x1e7)](_0xf44b38['chat']['id'],'Notifications\x20enabled')[_0x2a6e34(0x205)](_0x4e8dfe=>{telegramError(_0x4e8dfe);});}),tgBot['onText'](/\/config/,async _0x2ef016=>{const _0x33c54b=_0x1b0886;if(!validateTelegram(_0x2ef016))return;tgBot['removeListener'](_0x33c54b(0x21a)),tgBot['sendMessage'](_0x2ef016[_0x33c54b(0x189)]['id'],_0x33c54b(0x14b),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x33c54b(0x168)},{'text':'Alerts','callback_data':_0x33c54b(0x1b0)},{'text':_0x33c54b(0xef),'callback_data':_0x33c54b(0x264)}]]}})[_0x33c54b(0x205)](_0xaab643=>{telegramError(_0xaab643);}),tgBot['on'](_0x33c54b(0x21a),async _0x40b274=>{const _0x2c5bee=_0x33c54b,_0x36909b=_0x40b274[_0x2c5bee(0x25f)],_0x43df48=_0x40b274[_0x2c5bee(0xfc)];tgBot[_0x2c5bee(0x119)](_0x40b274['id'])[_0x2c5bee(0x178)](async()=>{const _0x16ebef=_0x2c5bee;_0x36909b==_0x16ebef(0x168)&&(updateSetting('telegramEvents',_0x16ebef(0x168)),updateSetting('telegramEnabled',!![]),await tgBot[_0x16ebef(0x1e7)](_0x43df48['chat']['id'],_0x16ebef(0x1ba))[_0x16ebef(0x205)](_0x216ed9=>{telegramError(_0x216ed9);}));_0x36909b=='alerts'&&(updateSetting('telegramEvents',_0x16ebef(0x1b0)),updateSetting(_0x16ebef(0x10d),!![]),await tgBot[_0x16ebef(0x1e7)](_0x43df48[_0x16ebef(0x189)]['id'],_0x16ebef(0x26b))[_0x16ebef(0x205)](_0x36650f=>{telegramError(_0x36650f);}));_0x36909b==_0x16ebef(0x264)&&(updateSetting(_0x16ebef(0x246),_0x16ebef(0x264)),updateSetting(_0x16ebef(0x10d),!![]),await tgBot[_0x16ebef(0x1e7)](_0x43df48['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')['catch'](_0x2ccb89=>{telegramError(_0x2ccb89);}));if(!settings[_0x16ebef(0x290)])tgBot['sendMessage'](_0x43df48[_0x16ebef(0x189)]['id'],_0x16ebef(0x1c0))[_0x16ebef(0x205)](_0x161e00=>{telegramError(_0x161e00);});}),tgBot['removeListener'](_0x2c5bee(0x21a));});}),tgBot[_0x1b0886(0x22c)](/\/status/,_0x2e52c2=>{const _0x57429f=_0x1b0886;if(!validateTelegram(_0x2e52c2))return;const _0x4aafef=getBotsWithMode();let _0x5c2c8f='<b>Balance\x20Bot\x20Status:</b>\x0a';config['forEach'](_0xec3f64=>{const _0x2c9189=_0x4047,_0x9c58af=_0x4aafef[_0x2c9189(0x218)](_0x58df5f=>_0x58df5f[_0x2c9189(0x20f)]==_0xec3f64[_0x2c9189(0x20f)])[_0x2c9189(0x206)];_0x5c2c8f+=_0x2c9189(0x16d)+_0xec3f64['botID']+':\x20'+_0xec3f64[_0x2c9189(0x250)]+'\x20|\x20'+_0x9c58af+_0x2c9189(0x110)+_0xec3f64[_0x2c9189(0x1ee)]+'\x0a';}),_0x5c2c8f+='\x0a',_0x5c2c8f+=_0x57429f(0x23d),_0x5c2c8f+=!settings[_0x57429f(0x10d)]?_0x57429f(0x275):'Notifications\x20enabled\x0a',_0x5c2c8f+=settings[_0x57429f(0x10d)]?settings[_0x57429f(0x246)]==_0x57429f(0x264)?_0x57429f(0x26c):_0x57429f(0x13c)+settings['telegramEvents']+_0x57429f(0x202):'',tgBot[_0x57429f(0x1e7)](_0x2e52c2[_0x57429f(0x189)]['id'],_0x5c2c8f,{'parse_mode':'HTML'})['catch'](_0x22b3d6=>{telegramError(_0x22b3d6);});}),tgBot['onText'](/\/restart/,_0x1f5cc1=>{const _0x3be984=_0x1b0886;if(!validateTelegram(_0x1f5cc1))return;tgBot[_0x3be984(0x216)](_0x3be984(0x21a));const _0x244382=getEnabledBots();if(_0x244382[_0x3be984(0x2a4)]==0x0)tgBot[_0x3be984(0x1e7)](_0x1f5cc1['chat']['id'],_0x3be984(0x193))[_0x3be984(0x205)](_0x3fca3a=>{telegramError(_0x3fca3a);});else{if(_0x244382[_0x3be984(0x2a4)]>0x1)_0x244382['push']({'botID':'all'});let _0x262680=[],_0x2a0960=[];const _0x12c39c=_0x244382[_0x3be984(0x2a4)]%0x4==0x0||_0x244382[_0x3be984(0x2a4)]%0x4==0x3||_0x244382[_0x3be984(0x2a4)]%0x3==0x1?0x4:0x3;let _0x27f613=0x0;_0x244382['forEach']((_0x3b3de9,_0x23badb)=>{const _0x4dad86=_0x3be984;if(_0x23badb%_0x12c39c==0x0)_0x2a0960=[];_0x2a0960[_0x4dad86(0x28c)]({'text':_0x3b3de9[_0x4dad86(0x20f)]==_0x4dad86(0x264)?_0x4dad86(0x1af):_0x4dad86(0x16d)+_0x3b3de9['botID'],'callback_data':_0x3b3de9[_0x4dad86(0x20f)]}),_0x23badb%_0x12c39c==0x0&&(_0x262680[_0x27f613]=_0x2a0960,_0x27f613++);}),tgBot[_0x3be984(0x1e7)](_0x1f5cc1['chat']['id'],_0x3be984(0x109),{'reply_markup':{'inline_keyboard':_0x262680}})['catch'](_0x455771=>{telegramError(_0x455771);}),tgBot['on'](_0x3be984(0x21a),async _0x2fcb1d=>{const _0x1def6a=_0x3be984,_0x3d0b43=_0x2fcb1d[_0x1def6a(0x25f)],_0x13c961=_0x2fcb1d[_0x1def6a(0xfc)];tgBot['answerCallbackQuery'](_0x2fcb1d['id'])[_0x1def6a(0x178)](async()=>{_0x3d0b43=='all'?config['forEach'](_0x25b833=>{const _0x74410b=_0x4047;restartBot(_0x25b833[_0x74410b(0x20f)]);}):restartBot(_0x3d0b43);}),tgBot[_0x1def6a(0x216)]('callback_query');});}}),tgBot[_0x1b0886(0x22c)](/\/on/,_0x39bc48=>{const _0x24c9be=_0x1b0886;if(!validateTelegram(_0x39bc48))return;tgBot[_0x24c9be(0x216)](_0x24c9be(0x21a));const _0x39ad89=getDisabledBots();if(_0x39ad89[_0x24c9be(0x2a4)]==0x0)tgBot['sendMessage'](_0x39bc48['chat']['id'],_0x24c9be(0x15d))['catch'](_0xafc881=>{telegramError(_0xafc881);});else{if(_0x39ad89[_0x24c9be(0x2a4)]>0x1)_0x39ad89[_0x24c9be(0x28c)]({'botID':_0x24c9be(0x264)});let _0x6b4b60=[],_0x1acb58=[];const _0x2b01c1=_0x39ad89['length']%0x4==0x0||_0x39ad89[_0x24c9be(0x2a4)]%0x4==0x3||_0x39ad89['length']%0x3==0x1?0x4:0x3;let _0x107b9d=0x0;_0x39ad89[_0x24c9be(0x2be)]((_0x1699d2,_0x54ed5a)=>{const _0x3371d2=_0x24c9be;if(_0x54ed5a%_0x2b01c1==0x0)_0x1acb58=[];_0x1acb58[_0x3371d2(0x28c)]({'text':_0x1699d2[_0x3371d2(0x20f)]==_0x3371d2(0x264)?_0x3371d2(0x1af):'Bot\x20'+_0x1699d2[_0x3371d2(0x20f)],'callback_data':_0x1699d2['botID']}),_0x54ed5a%_0x2b01c1==0x0&&(_0x6b4b60[_0x107b9d]=_0x1acb58,_0x107b9d++);}),tgBot[_0x24c9be(0x1e7)](_0x39bc48['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x6b4b60}})[_0x24c9be(0x205)](_0x111bac=>{telegramError(_0x111bac);}),tgBot['on']('callback_query',async _0x2929f7=>{const _0x5b9446=_0x24c9be,_0x6e7b0d=_0x2929f7[_0x5b9446(0x25f)],_0x4f34c7=_0x2929f7[_0x5b9446(0xfc)];tgBot[_0x5b9446(0x119)](_0x2929f7['id'])[_0x5b9446(0x178)](async()=>{const _0xe153c5=_0x5b9446;_0x6e7b0d==_0xe153c5(0x264)?(tgBot['sendMessage'](_0x4f34c7[_0xe153c5(0x189)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')['catch'](_0x5319d6=>{telegramError(_0x5319d6);}),_0x39ad89[_0xe153c5(0x2be)](_0x4d3bdb=>{const _0x39da17=_0xe153c5;if(_0x4d3bdb[_0x39da17(0x20f)]!=_0x39da17(0x264))toggleBot(_0x4d3bdb[_0x39da17(0x20f)],toggleStatus(_0x4d3bdb[_0x39da17(0x20f)]),_0x39da17(0x1d7));})):(tgBot[_0xe153c5(0x1e7)](_0x4f34c7[_0xe153c5(0x189)]['id'],_0xe153c5(0x2b4)+_0x6e7b0d)[_0xe153c5(0x205)](_0x165160=>{telegramError(_0x165160);}),toggleBot(_0x6e7b0d,toggleStatus(_0x6e7b0d),'stopped'));}),tgBot[_0x5b9446(0x216)](_0x5b9446(0x21a));});}}),tgBot[_0x1b0886(0x22c)](/\/off/,_0x4a32fb=>{const _0x2cd6d5=_0x1b0886;if(!validateTelegram(_0x4a32fb))return;tgBot[_0x2cd6d5(0x216)](_0x2cd6d5(0x21a));const _0x2651d0=getEnabledBots();if(_0x2651d0[_0x2cd6d5(0x2a4)]==0x0)tgBot[_0x2cd6d5(0x1e7)](_0x4a32fb['chat']['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0xcb6670=>{telegramError(_0xcb6670);});else{if(_0x2651d0[_0x2cd6d5(0x2a4)]>0x1)_0x2651d0[_0x2cd6d5(0x28c)]({'botID':'all'});let _0xd039f5=[],_0x14c869=[];const _0x568726=_0x2651d0[_0x2cd6d5(0x2a4)]%0x4==0x0||_0x2651d0[_0x2cd6d5(0x2a4)]%0x4==0x3||_0x2651d0[_0x2cd6d5(0x2a4)]%0x3==0x1?0x4:0x3;let _0x5c9b7b=0x0;_0x2651d0[_0x2cd6d5(0x2be)]((_0x2879d2,_0x39885b)=>{const _0x38a7e1=_0x2cd6d5;if(_0x39885b%_0x568726==0x0)_0x14c869=[];_0x14c869['push']({'text':_0x2879d2[_0x38a7e1(0x20f)]==_0x38a7e1(0x264)?_0x38a7e1(0x1af):_0x38a7e1(0x16d)+_0x2879d2[_0x38a7e1(0x20f)],'callback_data':_0x2879d2[_0x38a7e1(0x20f)]}),_0x39885b%_0x568726==0x0&&(_0xd039f5[_0x5c9b7b]=_0x14c869,_0x5c9b7b++);}),tgBot[_0x2cd6d5(0x1e7)](_0x4a32fb['chat']['id'],_0x2cd6d5(0x242),{'reply_markup':{'inline_keyboard':_0xd039f5}})['catch'](_0x4221d1=>{telegramError(_0x4221d1);}),tgBot['on']('callback_query',async _0x4463f5=>{const _0x28f144=_0x2cd6d5,_0x252eff=_0x4463f5['data'],_0x34ea64=_0x4463f5[_0x28f144(0xfc)];tgBot[_0x28f144(0x119)](_0x4463f5['id'])['then'](async()=>{const _0x917391=_0x28f144;_0x252eff=='all'?(tgBot[_0x917391(0x1e7)](_0x34ea64['chat']['id'],_0x917391(0x1c7))['catch'](_0x535f5e=>{telegramError(_0x535f5e);}),_0x2651d0['forEach'](_0x5de730=>{const _0x405d0d=_0x917391;if(_0x5de730[_0x405d0d(0x20f)]!=_0x405d0d(0x264))toggleBot(_0x5de730[_0x405d0d(0x20f)],toggleStatus(_0x5de730[_0x405d0d(0x20f)]),_0x405d0d(0x1d7));})):(tgBot['sendMessage'](_0x34ea64[_0x917391(0x189)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x252eff)[_0x917391(0x205)](_0xcf68bc=>{telegramError(_0xcf68bc);}),toggleBot(_0x252eff,toggleStatus(_0x252eff),_0x917391(0x1d7)));}),tgBot[_0x28f144(0x216)](_0x28f144(0x21a));});}}),tgBot[_0x1b0886(0x22c)](/\/metrics/,_0x5df2b3=>{const _0x16cdec=_0x1b0886;if(!validateTelegram(_0x5df2b3))return;tgBot['removeListener'](_0x16cdec(0x21a));const _0x49e9b1=getEnabledBots();if(_0x49e9b1['length']==0x0)tgBot[_0x16cdec(0x1e7)](_0x5df2b3[_0x16cdec(0x189)]['id'],_0x16cdec(0x193))['catch'](_0x146e2d=>{telegramError(_0x146e2d);});else{if(_0x49e9b1[_0x16cdec(0x2a4)]>0x1){let _0x3c27a4=[],_0x6535a5=[];const _0x6b8a2e=_0x49e9b1['length']%0x4==0x0||_0x49e9b1[_0x16cdec(0x2a4)]%0x4==0x3||_0x49e9b1[_0x16cdec(0x2a4)]%0x3==0x1?0x4:0x3;let _0x1284e4=0x0;_0x49e9b1[_0x16cdec(0x2be)]((_0x247ec3,_0x4d60d1)=>{const _0x2f1746=_0x16cdec;if(_0x4d60d1%_0x6b8a2e==0x0)_0x6535a5=[];_0x6535a5['push']({'text':_0x2f1746(0x16d)+_0x247ec3[_0x2f1746(0x20f)],'callback_data':_0x247ec3[_0x2f1746(0x20f)]}),_0x4d60d1%_0x6b8a2e==0x0&&(_0x3c27a4[_0x1284e4]=_0x6535a5,_0x1284e4++);}),tgBot[_0x16cdec(0x1e7)](_0x5df2b3[_0x16cdec(0x189)]['id'],_0x16cdec(0x18b),{'reply_markup':{'inline_keyboard':_0x3c27a4}})[_0x16cdec(0x205)](_0x168757=>{telegramError(_0x168757);}),tgBot['on'](_0x16cdec(0x21a),async _0x4c68e1=>{const _0xeb1ab=_0x16cdec,_0x2515af=_0x4c68e1[_0xeb1ab(0x25f)],_0x30d2b8=_0x4c68e1[_0xeb1ab(0xfc)];tgBot[_0xeb1ab(0x119)](_0x4c68e1['id'])[_0xeb1ab(0x178)](async()=>{const _0x39d64a=_0xeb1ab;if(pid[_0x2515af])pid[_0x2515af]['send']({'function':_0x39d64a(0x1fa),'args':null});}),tgBot['removeListener'](_0xeb1ab(0x21a));});}else{const _0x3bae4e=_0x49e9b1[0x0]['botID'];if(pid[_0x3bae4e])pid[_0x3bae4e]['send']({'function':_0x16cdec(0x1fa),'args':null});}}}),tgBot[_0x1b0886(0x22c)](/\/portfolio/,_0x60bd25=>{const _0x4b9f9a=_0x1b0886;if(!validateTelegram(_0x60bd25))return;tgBot[_0x4b9f9a(0x216)]('callback_query');const _0x2191a7=getEnabledBots();if(_0x2191a7[_0x4b9f9a(0x2a4)]==0x0)tgBot[_0x4b9f9a(0x1e7)](_0x60bd25[_0x4b9f9a(0x189)]['id'],_0x4b9f9a(0x193))['catch'](_0x2a9991=>{telegramError(_0x2a9991);});else{if(_0x2191a7[_0x4b9f9a(0x2a4)]>0x1){let _0x49f6d5=[],_0x458f3f=[];const _0x2640e1=_0x2191a7[_0x4b9f9a(0x2a4)]%0x4==0x0||_0x2191a7[_0x4b9f9a(0x2a4)]%0x4==0x3||_0x2191a7[_0x4b9f9a(0x2a4)]%0x3==0x1?0x4:0x3;let _0xad994c=0x0;_0x2191a7[_0x4b9f9a(0x2be)]((_0x1e0d63,_0x3dac27)=>{const _0x11d734=_0x4b9f9a;if(_0x3dac27%_0x2640e1==0x0)_0x458f3f=[];_0x458f3f[_0x11d734(0x28c)]({'text':'Bot\x20'+_0x1e0d63[_0x11d734(0x20f)],'callback_data':_0x1e0d63[_0x11d734(0x20f)]}),_0x3dac27%_0x2640e1==0x0&&(_0x49f6d5[_0xad994c]=_0x458f3f,_0xad994c++);}),tgBot[_0x4b9f9a(0x1e7)](_0x60bd25['chat']['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x49f6d5}})[_0x4b9f9a(0x205)](_0x5c268e=>{telegramError(_0x5c268e);}),tgBot['on'](_0x4b9f9a(0x21a),async _0x3bb854=>{const _0x3ff21e=_0x4b9f9a,_0x3bbbd6=_0x3bb854[_0x3ff21e(0x25f)],_0x35ed95=_0x3bb854[_0x3ff21e(0xfc)];tgBot[_0x3ff21e(0x119)](_0x3bb854['id'])[_0x3ff21e(0x178)](async()=>{const _0x4a6063=_0x3ff21e;if(pid[_0x3bbbd6])pid[_0x3bbbd6][_0x4a6063(0x244)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x3ff21e(0x216)](_0x3ff21e(0x21a));});}else{const _0x471a89=_0x2191a7[0x0][_0x4b9f9a(0x20f)];if(pid[_0x471a89])pid[_0x471a89][_0x4b9f9a(0x244)]({'function':_0x4b9f9a(0x293),'args':null});}}}),tgBot['onText'](/\/update/,async _0x15bed5=>{const _0x3ad036=_0x1b0886;if(!validateTelegram(_0x15bed5))return;tgBot[_0x3ad036(0x216)](_0x3ad036(0x21a)),await getMessages();if(!updateAvailable)tgBot[_0x3ad036(0x1e7)](_0x15bed5[_0x3ad036(0x189)]['id'],_0x3ad036(0x270))[_0x3ad036(0x205)](_0x454e81=>{telegramError(_0x454e81);});else!validInstallation?tgBot[_0x3ad036(0x1e7)](_0x15bed5[_0x3ad036(0x189)]['id'],_0x3ad036(0x135))['catch'](_0x2f5ad7=>{telegramError(_0x2f5ad7);}):(tgBot[_0x3ad036(0x1e7)](_0x15bed5[_0x3ad036(0x189)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x3ad036(0x204)},{'text':'No','callback_data':'no'}]]}})[_0x3ad036(0x205)](_0x48e545=>{telegramError(_0x48e545);}),tgBot['on']('callback_query',async _0x59eeca=>{const _0x2a90e8=_0x3ad036,_0x39b6e9=_0x59eeca[_0x2a90e8(0x25f)],_0x4afe1a=_0x59eeca['message'];tgBot[_0x2a90e8(0x119)](_0x59eeca['id'])[_0x2a90e8(0x178)](async()=>{const _0x25c624=_0x2a90e8;_0x39b6e9==_0x25c624(0x204)&&(await tgBot[_0x25c624(0x1e7)](_0x4afe1a[_0x25c624(0x189)]['id'],'Starting\x20Balance\x20Bot\x20update')[_0x25c624(0x205)](_0x4f1365=>{telegramError(_0x4f1365);}),updateBB('update')),_0x39b6e9=='no'&&await tgBot[_0x25c624(0x1e7)](_0x4afe1a['chat']['id'],_0x25c624(0x233))['catch'](_0x40ddaa=>{telegramError(_0x40ddaa);});}),tgBot[_0x2a90e8(0x216)](_0x2a90e8(0x21a));}));}),tgBot['onText'](/\/reinstall/,async _0x4480a3=>{const _0x981964=_0x1b0886;if(!validateTelegram(_0x4480a3))return;tgBot[_0x981964(0x216)]('callback_query'),!validInstallation?tgBot[_0x981964(0x1e7)](_0x4480a3[_0x981964(0x189)]['id'],_0x981964(0x2c3))['catch'](_0x568caf=>{telegramError(_0x568caf);}):(tgBot['sendMessage'](_0x4480a3[_0x981964(0x189)]['id'],_0x981964(0x1bf),{'reply_markup':{'inline_keyboard':[[{'text':_0x981964(0x1c2),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x981964(0x205)](_0x52c8cf=>{telegramError(_0x52c8cf);}),tgBot['on'](_0x981964(0x21a),async _0x39f94a=>{const _0x5e5642=_0x981964,_0xf861b1=_0x39f94a['data'],_0x116f66=_0x39f94a[_0x5e5642(0xfc)];tgBot[_0x5e5642(0x119)](_0x39f94a['id'])[_0x5e5642(0x178)](async()=>{const _0x91b7ee=_0x5e5642;_0xf861b1=='yes'&&(await tgBot[_0x91b7ee(0x1e7)](_0x116f66[_0x91b7ee(0x189)]['id'],_0x91b7ee(0x143))[_0x91b7ee(0x205)](_0x300e49=>{telegramError(_0x300e49);}),updateBB(_0x91b7ee(0x198))),_0xf861b1=='no'&&await tgBot['sendMessage'](_0x116f66[_0x91b7ee(0x189)]['id'],_0x91b7ee(0x273))[_0x91b7ee(0x205)](_0x41a981=>{telegramError(_0x41a981);});}),tgBot[_0x5e5642(0x216)](_0x5e5642(0x21a));}));}),tgBot[_0x1b0886(0x22c)](/\/toggle/,_0x4c091a=>{const _0xac41d1=_0x1b0886;if(!validateTelegram(_0x4c091a))return;tgBot[_0xac41d1(0x216)](_0xac41d1(0x21a));const _0x31c476=getBotsWithMode();if(_0x31c476[_0xac41d1(0x2a4)]==0x0)tgBot[_0xac41d1(0x1e7)](_0x4c091a[_0xac41d1(0x189)]['id'],_0xac41d1(0x193))[_0xac41d1(0x205)](_0x3d3a95=>{telegramError(_0x3d3a95);});else{let _0xd2a310=[],_0x2c12fa=[];const _0x2e4a05=0x2;let _0xab425f=0x0;_0x31c476[_0xac41d1(0x2be)]((_0x4a1e15,_0x42862d)=>{const _0x66f637=_0xac41d1;if(_0x42862d%_0x2e4a05==0x0)_0x2c12fa=[];_0x2c12fa[_0x66f637(0x28c)]({'text':_0x66f637(0x16d)+_0x4a1e15[_0x66f637(0x20f)]+'\x20('+_0x4a1e15[_0x66f637(0x206)]+')','callback_data':_0x4a1e15[_0x66f637(0x20f)]}),_0x42862d%_0x2e4a05==0x0&&(_0xd2a310[_0xab425f]=_0x2c12fa,_0xab425f++);}),tgBot[_0xac41d1(0x1e7)](_0x4c091a[_0xac41d1(0x189)]['id'],_0xac41d1(0x12d),{'reply_markup':{'inline_keyboard':_0xd2a310}})['catch'](_0x47b388=>{telegramError(_0x47b388);}),tgBot['on'](_0xac41d1(0x21a),async _0x15a362=>{const _0x2ec51e=_0xac41d1,_0x3085c9=_0x15a362[_0x2ec51e(0x25f)],_0x114450=_0x15a362[_0x2ec51e(0xfc)];tgBot[_0x2ec51e(0x119)](_0x15a362['id'])['then'](async()=>{const _0x29b77e=_0x2ec51e,_0xe57de0=_0x31c476[_0x29b77e(0x218)](_0x3091d5=>_0x3091d5[_0x29b77e(0x20f)]==_0x3085c9),_0x621d6d=_0xe57de0['mode']==_0x29b77e(0x1bd)?_0x29b77e(0x1b2):_0x29b77e(0x1bd);tgBot['sendMessage'](_0x114450[_0x29b77e(0x189)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x3085c9+_0x29b77e(0x256)+_0x621d6d+_0x29b77e(0x220))[_0x29b77e(0x205)](_0x4f3443=>{telegramError(_0x4f3443);}),toggleBotMode(_0x3085c9);}),tgBot[_0x2ec51e(0x216)]('callback_query');});}}),tgBot[_0x1b0886(0x22c)](/\/names/,_0x3efc3e=>{const _0x3a9b43=_0x1b0886;if(!validateTelegram(_0x3efc3e))return;let _0x35bb33='';config[_0x3a9b43(0x2be)](_0x3e32e4=>{const _0x26d88d=_0x3a9b43;_0x35bb33+=_0x26d88d(0x16d)+_0x3e32e4[_0x26d88d(0x20f)]+':\x20'+_0x3e32e4[_0x26d88d(0x17b)]+'\x0a';}),tgBot[_0x3a9b43(0x1e7)](_0x3efc3e[_0x3a9b43(0x189)]['id'],_0x35bb33,{'parse_mode':_0x3a9b43(0x252)})[_0x3a9b43(0x205)](_0x5f34e2=>{telegramError(_0x5f34e2);});}),tgBot[_0x1b0886(0x22c)](/\/disable/,_0xcfaf5b=>{const _0x3b6068=_0x1b0886;if(!validateTelegram(_0xcfaf5b))return;tgBot[_0x3b6068(0x1e7)](_0xcfaf5b[_0x3b6068(0x189)]['id'],_0x3b6068(0x177))[_0x3b6068(0x205)](_0x4ed86c=>{telegramError(_0x4ed86c);}),updateSetting(_0x3b6068(0x10d),![]);}),tgBot[_0x1b0886(0x22c)](/\/help/,_0x139d7e=>{const _0xa902e=_0x1b0886;if(!validateTelegram(_0x139d7e))return;tgBot[_0xa902e(0x1e7)](_0x139d7e['chat']['id'],_0x7597a3)[_0xa902e(0x205)](_0x39dddd=>{telegramError(_0x39dddd);});}),tgBot['on'](_0x1b0886(0x286),_0x5bb4ff=>{const _0x134cfe=_0x1b0886;_0x5bb4ff[_0x134cfe(0xeb)]()[_0x134cfe(0x2a9)](_0x134cfe(0x1ae))&&(logger['full'](_0x134cfe(0x20d)),tgBot[_0x134cfe(0x2b3)](),tgBot=null,io['to'](_0x134cfe(0x1fb))[_0x134cfe(0x186)](_0x134cfe(0x1cb),_0x134cfe(0x20d)));}),process['once']('SIGINT',()=>{const _0xb20671=_0x1b0886;if(tgBot)tgBot['stopPolling']();process[_0xb20671(0x129)](0x1);}),process[_0x1b0886(0x29a)](_0x1b0886(0x146),()=>{const _0x41b1f0=_0x1b0886;if(tgBot)tgBot['stopPolling']();process[_0x41b1f0(0x129)](0x1);});}}function disableTelegram(){const _0x3db5db=_0x4ddc53;tgBot&&(tgBot[_0x3db5db(0x2b3)](),tgBot=null);}function sendTelegram(_0x36a2f5,_0x5cc707){const _0x1a4f94=_0x4ddc53;if(settings[_0x1a4f94(0x10d)]){if(settings['telegramEvents']==_0x1a4f94(0x264)||(_0x5cc707[_0x1a4f94(0x196)]=='error'||_0x5cc707[_0x1a4f94(0x196)]==_0x1a4f94(0x22a)||_0x5cc707[_0x1a4f94(0x196)]==_0x1a4f94(0xfe))&&settings['telegramEvents']==_0x1a4f94(0x1b0)||_0x5cc707[_0x1a4f94(0x196)]=='order'&&settings[_0x1a4f94(0x246)]==_0x1a4f94(0x168)){if(tgBot&&settings[_0x1a4f94(0x290)]){if(_0x5cc707['showname'])tgBot[_0x1a4f94(0x1e7)](settings[_0x1a4f94(0x290)],_0x5cc707[_0x1a4f94(0x17b)]+'\x20>\x20'+_0x5cc707['event'])[_0x1a4f94(0x205)](_0x1be018=>{telegramError(_0x1be018);});else tgBot[_0x1a4f94(0x1e7)](settings['telegramChatId'],'Bot\x20'+_0x36a2f5+'\x20>\x20'+_0x5cc707[_0x1a4f94(0x1ed)])[_0x1a4f94(0x205)](_0x228e5c=>{telegramError(_0x228e5c);});}}}}async function sendTelegramMsg(_0x3413c7,_0x52b0f3=_0x4ddc53(0x252)){const _0x283410=_0x4ddc53;return settings[_0x283410(0x10d)]&&tgBot&&settings[_0x283410(0x290)]?(await tgBot[_0x283410(0x1e7)](settings[_0x283410(0x290)],_0x3413c7,{'parse_mode':_0x52b0f3})[_0x283410(0x205)](_0x73f741=>{telegramError(_0x73f741);}),!![]):![];}function getDeviceWithIp(_0x54a69a){return devices['find'](_0x309268=>_0x309268['ip']===_0x54a69a);}function temporaryAccess2FA(_0xecae40,_0x307d0c){const _0x3a7bf9=_0x4ddc53;let _0x5644e2=new Date(),_0x5abec6=![];if(lastIpApproval){if(_0x5644e2-lastIpApproval<0x1388)_0x5abec6=!![];}lastIpApproval=new Date();if(_0x5abec6)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x3a7bf9(0x216)](_0x3a7bf9(0x21a)),tgBot[_0x3a7bf9(0x1e7)](settings['telegramChatId'],_0x3a7bf9(0x2bd)+normalizeIP(_0x307d0c)[_0x3a7bf9(0x21c)]+'</b>\x20?',{'parse_mode':_0x3a7bf9(0x252),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x3a7bf9(0x235),'callback_data':'15'},{'text':_0x3a7bf9(0x21d),'callback_data':'30'},{'text':_0x3a7bf9(0x22d),'callback_data':_0x3a7bf9(0x22d)}]]}})[_0x3a7bf9(0x205)](_0x37edbc=>{telegramError(_0x37edbc);}),tgBot['on'](_0x3a7bf9(0x21a),async _0x16ba00=>{const _0x5386ae=_0x3a7bf9,_0x54e47f=_0x16ba00[_0x5386ae(0x25f)],_0x500d0c=_0x16ba00[_0x5386ae(0xfc)];tgBot[_0x5386ae(0x119)](_0x16ba00['id'])[_0x5386ae(0x178)](async()=>{const _0xf7afb8=_0x5386ae;devices[_0xecae40][_0xf7afb8(0xf8)]={'clientip':_0x307d0c,'timestamp':new Date()[_0xf7afb8(0x271)](),'expiry':_0x54e47f},_0x54e47f!=_0xf7afb8(0x22d)?(await tgBot[_0xf7afb8(0x1e7)](_0x500d0c['chat']['id'],_0xf7afb8(0x105)+_0x54e47f+'\x20minutes',{'parse_mode':_0xf7afb8(0x252)})['catch'](_0x4eb1d0=>{telegramError(_0x4eb1d0);}),io['to'](_0xecae40)[_0xf7afb8(0x186)](_0xf7afb8(0x250),{'access':{'allow':![],'reason':_0xf7afb8(0x179),'token':null}})):(await tgBot['sendMessage'](_0x500d0c[_0xf7afb8(0x189)]['id'],_0xf7afb8(0x127))[_0xf7afb8(0x205)](_0x232bac=>{telegramError(_0x232bac);}),io['to'](_0xecae40)['emit']('status',{'access':{'allow':![],'reason':_0xf7afb8(0x139),'token':null}}));}),tgBot[_0x5386ae(0x216)]('callback_query');}));}function loginAccess2FA(_0x1fa791,_0x375c90){const _0x319be9=_0x4ddc53;tgBot&&settings[_0x319be9(0x290)]&&(tgBot[_0x319be9(0x216)](_0x319be9(0x21a)),tgBot[_0x319be9(0x1e7)](settings[_0x319be9(0x290)],_0x319be9(0x27d)+normalizeIP(_0x375c90)[_0x319be9(0x21c)]+_0x319be9(0x278),{'parse_mode':_0x319be9(0x252),'reply_markup':{'inline_keyboard':[[{'text':_0x319be9(0x238),'callback_data':loginExpiry},{'text':_0x319be9(0x22d),'callback_data':_0x319be9(0x22d)}]]}})[_0x319be9(0x205)](_0x53af17=>{telegramError(_0x53af17);}),tgBot['on'](_0x319be9(0x21a),async _0x3ff42d=>{const _0x16aeff=_0x319be9,_0x4021b5=_0x3ff42d[_0x16aeff(0x25f)],_0x3d05a6=_0x3ff42d[_0x16aeff(0xfc)];tgBot['answerCallbackQuery'](_0x3ff42d['id'])[_0x16aeff(0x178)](async()=>{const _0x3714ac=_0x16aeff;devices[_0x1fa791][_0x3714ac(0x2c6)]={'clientip':_0x375c90,'timestamp':new Date()[_0x3714ac(0x271)](),'expiry':_0x4021b5},_0x4021b5!=_0x3714ac(0x22d)?(await tgBot[_0x3714ac(0x1e7)](_0x3d05a6[_0x3714ac(0x189)]['id'],_0x3714ac(0x1a6),{'parse_mode':_0x3714ac(0x252)})[_0x3714ac(0x205)](_0x21d1d6=>{telegramError(_0x21d1d6);}),io['to'](_0x1fa791)['emit']('status',{'access':{'allow':![],'reason':_0x3714ac(0x179),'token':null}})):(await tgBot[_0x3714ac(0x1e7)](_0x3d05a6[_0x3714ac(0x189)]['id'],_0x3714ac(0x188))['catch'](_0x5d6292=>{telegramError(_0x5d6292);}),io['to'](_0x1fa791)[_0x3714ac(0x186)](_0x3714ac(0x250),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x16aeff(0x216)](_0x16aeff(0x21a));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x5b61f3=_0x4ddc53;return dbConfig['get'](_0x5b61f3(0x24f))[_0x5b61f3(0x2c2)](_0x5b61f3(0x20f))['filter']({'status':_0x5b61f3(0x175)})[_0x5b61f3(0x22e)]()||[];}function getDisabledBots(){const _0x5e3a92=_0x4ddc53;return dbConfig[_0x5e3a92(0x13b)](_0x5e3a92(0x24f))[_0x5e3a92(0x2c2)](_0x5e3a92(0x20f))[_0x5e3a92(0x1f1)]({'status':_0x5e3a92(0x19c)})[_0x5e3a92(0x22e)]()||[];}function getBotAttributes(_0x42c0c0){const _0x498443=_0x4ddc53;let _0x395c24={};const _0x2b57c3=configpath+_0x498443(0x267)+_0x42c0c0+_0x498443(0x24e),_0x355659=fs[_0x498443(0x1d4)](_0x2b57c3);if(_0x355659){const _0x110169=fs[_0x498443(0x15a)](_0x2b57c3);try{const _0x3c0733=JSON['parse'](_0x110169),_0x444bc5=_0x3c0733?_0x3c0733[_0x498443(0x219)][0x0]['headless']:![];_0x395c24['mode']=_0x444bc5?_0x498443(0x1bd):_0x498443(0x1b2),_0x395c24['botname']=_0x3c0733?_0x3c0733['bot'][0x0][_0x498443(0x17b)]:'Bot\x20'+_0x42c0c0;}catch(_0x2675e6){_0x395c24[_0x498443(0x206)]=_0x498443(0x1b2),_0x395c24[_0x498443(0x17b)]=_0x498443(0x16d)+_0x42c0c0;}}else _0x395c24[_0x498443(0x206)]='manual',_0x395c24['botname']=_0x498443(0x16d)+_0x42c0c0;return _0x395c24;}function getBotsWithMode(){const _0x242bcc=_0x4ddc53,_0x3538a6=dbConfig[_0x242bcc(0x13b)](_0x242bcc(0x24f))['sortBy'](_0x242bcc(0x20f))[_0x242bcc(0x22e)]()||[];return _0x3538a6[_0x242bcc(0x2be)](_0x3cfa6a=>{const _0x2ca096=_0x242bcc;let _0xd9020a=getBotAttributes(_0x3cfa6a[_0x2ca096(0x20f)]);_0x3cfa6a[_0x2ca096(0x206)]=_0xd9020a[_0x2ca096(0x206)];}),_0x3538a6;}function getBotExchanges(){const _0x25e970=_0x4ddc53;let _0x43c637=[];const _0x244e01=dbConfig[_0x25e970(0x13b)](_0x25e970(0x24f))[_0x25e970(0x2c2)](_0x25e970(0x20f))['value']()||[];_0x244e01[_0x25e970(0x2be)](_0x1ad73d=>{const _0x239a4c=_0x25e970;if(_0x1ad73d[_0x239a4c(0x250)]==_0x239a4c(0x175)){const _0x5b3775=configpath+_0x239a4c(0x267)+_0x1ad73d[_0x239a4c(0x20f)]+_0x239a4c(0x24e),_0x4b5936=fs['existsSync'](_0x5b3775);let _0x369e72;if(_0x4b5936){const _0x82ed71=fs['readFileSync'](_0x5b3775);try{const _0x123cc1=JSON[_0x239a4c(0x298)](_0x82ed71);_0x369e72=_0x123cc1?_0x123cc1[_0x239a4c(0x219)][0x0]['exchange']:null;}catch(_0x1968ea){}}if(_0x369e72)_0x43c637[_0x239a4c(0x28c)](_0x369e72);}});const _0x4a7fb3=[...new Set(_0x43c637)][_0x25e970(0x29f)]();return _0x4a7fb3;}async function initUser(){const _0x5c54c1=_0x4ddc53;if(!settings[_0x5c54c1(0x1aa)]){const _0x2dd80d=uuidRandom();mixpanel['alias'](_0x2dd80d),updateSetting(_0x5c54c1(0x1aa),_0x2dd80d);}}async function initSecure(){const _0x5b192a=_0x4ddc53;let _0x48674b=getSecure();if(!_0x48674b[_0x5b192a(0x27f)](_0x5b192a(0x27a))){let _0x324db4=await generateKeys();_0x48674b['publicKey']=_0x324db4[_0x5b192a(0x141)],_0x48674b[_0x5b192a(0x287)]=_0x324db4['privateKey'],_0x48674b['secret']=crypto[_0x5b192a(0x14c)](0x20)[_0x5b192a(0xeb)](_0x5b192a(0x1c5));;storeSecure(_0x48674b);}}function getSettings(){const _0x48186d=_0x4ddc53;return dbSettings['get'](_0x48186d(0x215))[_0x48186d(0x22e)]()||{};}function getSecure(){const _0x38e245=_0x4ddc53;return dbSecure[_0x38e245(0x13b)]('secure')[_0x38e245(0x22e)]()||{};}function getBlacklist(){const _0x3f1956=_0x4ddc53;return dbSecure[_0x3f1956(0x13b)]('blacklist')[_0x3f1956(0x22e)]()||[];}function broadcastToBots(_0x4dce26,_0x5ba0a7){config['forEach'](_0x2b6096=>{const _0xd990f8=_0x4047;if(_0x2b6096[_0xd990f8(0x250)]==_0xd990f8(0x175)&&_0x2b6096['live']=='running'||_0x2b6096[_0xd990f8(0x250)]=='new'&&_0x2b6096['live']==_0xd990f8(0x115)){if(pid[_0x2b6096[_0xd990f8(0x20f)]])pid[_0x2b6096[_0xd990f8(0x20f)]][_0xd990f8(0x244)]({[_0x4dce26]:_0x5ba0a7});}});}function storeSettings(_0x2973f1,_0x5006fb=![]){const _0x33a581=_0x4ddc53;_0x2973f1={...settings,..._0x2973f1};if(_0x5006fb&&_0x2973f1[_0x33a581(0x16a)]!=_0x33a581(0x19e)&&_0x2973f1[_0x33a581(0x16a)]!=_0x33a581(0x1db)&&_0x2973f1['bbPassword']!=''){const _0x41f929=crypt['decrypt'](secure[_0x33a581(0x287)],_0x2973f1[_0x33a581(0x16a)])[_0x33a581(0xfc)]['split']('@')[0x0],_0x48fe60=bcrypt[_0x33a581(0x1fe)](_0x41f929,saltRounds);_0x2973f1={..._0x2973f1,'bbPassword':_0x48fe60};}if(_0x5006fb&&_0x2973f1['telegramToken']!='************'&&_0x2973f1[_0x33a581(0x213)]!='***'&&_0x2973f1[_0x33a581(0x213)]!=''){const _0x194642=crypt[_0x33a581(0x276)](secure[_0x33a581(0x287)],_0x2973f1[_0x33a581(0x213)])['message']['split']('@')[0x0];_0x2973f1={..._0x2973f1,'telegramToken':_0x194642};}const _0x3b2302=_0x2973f1[_0x33a581(0x213)]!='************'&&_0x2973f1[_0x33a581(0x213)]!=settings[_0x33a581(0x213)]||_0x2973f1[_0x33a581(0x2ac)]!=settings[_0x33a581(0x2ac)],_0x284ae8=_0x2973f1[_0x33a581(0x213)]==''||_0x2973f1['telegramUsername']=='';if(_0x3b2302)_0x2973f1[_0x33a581(0x246)]='all';for(const [_0x1ec1f,_0x4145b8]of Object['entries'](_0x2973f1)){if(_0x1ec1f==_0x33a581(0x213)&&_0x4145b8==_0x33a581(0x19e)){_0x2973f1[_0x33a581(0x213)]=settings[_0x33a581(0x213)];continue;};if(_0x1ec1f==_0x33a581(0x16a)&&_0x4145b8==_0x33a581(0x19e)){_0x2973f1[_0x33a581(0x16a)]=settings['bbPassword'];continue;};dbSettings['set'](_0x33a581(0x170)+_0x1ec1f,_0x4145b8)[_0x33a581(0x249)]();}settings=_0x2973f1,io['to'](_0x33a581(0x1fb))[_0x33a581(0x186)](_0x33a581(0x215),cleanSettings()),broadcastToBots('timeshift',settings[_0x33a581(0x285)]),broadcastToBots(_0x33a581(0x21b),settings['onepagemode']);if(_0x3b2302&&!_0x284ae8)initTelegram();if(_0x3b2302&&_0x284ae8)disableTelegram();getAllClients()[_0x33a581(0x2be)](_0x88b82c=>{const _0x21be3a=_0x33a581;getSocket(_0x88b82c['id'])[_0x21be3a(0x186)](_0x21be3a(0x250),{'access':{'allow':![],'reason':_0x21be3a(0x179),'token':null}});});}function updateSetting(_0x28cbdb,_0x44258f){const _0x1e0770=_0x4ddc53;dbSettings[_0x1e0770(0x1bc)](_0x1e0770(0x170)+_0x28cbdb,_0x44258f)[_0x1e0770(0x249)](),settings=getSettings(),io['to'](_0x1e0770(0x1fb))[_0x1e0770(0x186)]('settings',cleanSettings());}function storeSecure(_0xf93a99){const _0xc18028=_0x4ddc53;dbSecure[_0xc18028(0x13b)](_0xc18028(0x182))['push'](_0xf93a99)[_0xc18028(0x249)](),secure=_0xf93a99;}function addBlacklist(_0x2c1adf){const _0x229fa9=_0x4ddc53;cleanBlacklist();let _0x1ada82;devices[_0x2c1adf][_0x229fa9(0xf8)]?_0x1ada82=Math[_0x229fa9(0x272)](devices[_0x2c1adf][_0x229fa9(0xf8)][_0x229fa9(0x140)],loginExpiry):_0x1ada82=loginExpiry,dbSecure[_0x229fa9(0x13b)]('blacklist')[_0x229fa9(0x28c)]({'expiry':new Date()[_0x229fa9(0x271)]()+_0x1ada82*0x3c*0x3e8,'token':devices[_0x2c1adf]['access'][_0x229fa9(0x25c)]})[_0x229fa9(0x249)](),blacklist=dbSecure[_0x229fa9(0x13b)](_0x229fa9(0x221))[_0x229fa9(0x22e)]();}function cleanBlacklist(){const _0x168ab3=_0x4ddc53;let _0x4bf9ed=dbSecure[_0x168ab3(0x13b)]('blacklist')[_0x168ab3(0x228)]()[_0x168ab3(0x22e)](),_0x29c277=new Date()[_0x168ab3(0x271)]();_0x4bf9ed['forEach'](_0x206da4=>{const _0x11e4e9=_0x168ab3;_0x206da4[_0x11e4e9(0x140)]<_0x29c277&&dbSecure[_0x11e4e9(0x13b)](_0x11e4e9(0x221))[_0x11e4e9(0x20e)]({'expiry':_0x206da4['expiry']})[_0x11e4e9(0x249)]();});}function initStates(){const _0x4a6461=_0x4ddc53;let _0x2948ed=getConfiguration();_0x2948ed[_0x4a6461(0x2be)](_0x4dcc0c=>{_0x4dcc0c['live']='stopped';}),storeConfiguration(_0x2948ed);}function onKeys(){const _0x2d444c=new RSA();return new Promise(_0x146847=>{const _0x622a41=_0x4047;_0x2d444c[_0x622a41(0x147)]()[_0x622a41(0x178)](_0x13f30e=>{_0x146847(_0x13f30e);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x4be4af=_0x4ddc53;let _0x7cadb9=getSettings(),_0x243d3f=![];!_0x7cadb9[_0x4be4af(0x27f)](_0x4be4af(0x1b3))&&(_0x7cadb9['lastmsgtelegram']=0x0,_0x243d3f=!![]);!_0x7cadb9[_0x4be4af(0x27f)](_0x4be4af(0x2a3))&&(_0x7cadb9['lastmsgemitted']=0x0,_0x243d3f=!![]);!_0x7cadb9[_0x4be4af(0x27f)](_0x4be4af(0x1f7))&&(_0x7cadb9[_0x4be4af(0x1f7)]=_0x4be4af(0x24d),_0x243d3f=!![]);!_0x7cadb9['hasOwnProperty'](_0x4be4af(0x21b))&&(_0x7cadb9[_0x4be4af(0x21b)]=![],_0x243d3f=!![]);if(_0x243d3f)storeSettings(_0x7cadb9);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x46922e=>{const _0x449a97=_0x4be4af;if(!_0x46922e[_0x449a97(0x2ae)]()){if(!_0x46922e[_0x449a97(0x1df)]['startsWith'](_0x449a97(0x1a2)))fs[_0x449a97(0x197)](configbackuppath+_0x46922e[_0x449a97(0x1df)]);}else fs['rmSync'](configbackuppath+_0x46922e[_0x449a97(0x1df)],{'recursive':!![]});});}catch(_0x1db6ca){logger[_0x4be4af(0x20b)](_0x4be4af(0x21e),_0x1db6ca);}}function storeConfiguration(_0x5ec2d3){const _0x3011e1=_0x4ddc53;dbConfig[_0x3011e1(0x13b)](_0x3011e1(0x24f))[_0x3011e1(0x20e)]()[_0x3011e1(0x249)](),_0x5ec2d3[_0x3011e1(0x2be)](_0x25bef3=>{const _0x32c5b7=_0x3011e1;delete _0x25bef3[_0x32c5b7(0x206)];}),dbConfig[_0x3011e1(0x13b)](_0x3011e1(0x24f))[_0x3011e1(0x28c)](..._0x5ec2d3)['write'](),config=_0x5ec2d3;}function resetPassword(){const _0xbe3774=_0x4ddc53;tgBot&&settings['telegramChatId']&&(tgBot[_0xbe3774(0x216)](_0xbe3774(0x21a)),tgBot[_0xbe3774(0x1e7)](settings[_0xbe3774(0x290)],_0xbe3774(0xfb),{'parse_mode':_0xbe3774(0x252),'reply_markup':{'inline_keyboard':[[{'text':_0xbe3774(0x204),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0xbe3774(0x205)](_0x3c1579=>{telegramError(_0x3c1579);}),tgBot['on'](_0xbe3774(0x21a),async _0x4d77ec=>{const _0x422e29=_0xbe3774,_0x596e14=_0x4d77ec[_0x422e29(0x25f)],_0x18b6db=_0x4d77ec[_0x422e29(0xfc)];tgBot[_0x422e29(0x119)](_0x4d77ec['id'])[_0x422e29(0x178)](async()=>{const _0x5c0685=_0x422e29;if(_0x596e14!='no'){const _0x316ff4=0xf,_0x3cb6f4='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x1365db=Array[_0x5c0685(0x12c)](crypto[_0x5c0685(0x111)](new Uint32Array(_0x316ff4)))[_0x5c0685(0x173)](_0xea75e2=>_0x3cb6f4[_0xea75e2%_0x3cb6f4[_0x5c0685(0x2a4)]])[_0x5c0685(0x1dd)](''),_0x4b22fe=bcrypt[_0x5c0685(0x1fe)](_0x1365db,saltRounds);storeSettings({'bbPassword':_0x4b22fe}),await tgBot['sendMessage'](_0x18b6db[_0x5c0685(0x189)]['id'],_0x5c0685(0x16f)+_0x1365db,{'parse_mode':_0x5c0685(0x252)})[_0x5c0685(0x205)](_0x4fb5ad=>{telegramError(_0x4fb5ad);});}else await tgBot['sendMessage'](_0x18b6db[_0x5c0685(0x189)]['id'],_0x5c0685(0x2b9))[_0x5c0685(0x205)](_0x11b29b=>{telegramError(_0x11b29b);});}),tgBot[_0x422e29(0x216)](_0x422e29(0x21a));}));}async function confirmRestore(_0x9ce1f6,_0x58c0de){const _0x21b4f0=_0x4ddc53;io['to'](_0x21b4f0(0x1fb))[_0x21b4f0(0x186)](_0x21b4f0(0x1cb),_0x21b4f0(0x176),'success'),tgBot&&settings['telegramChatId']&&(tgBot[_0x21b4f0(0x216)](_0x21b4f0(0x21a)),await tgBot[_0x21b4f0(0x1e7)](settings[_0x21b4f0(0x290)],_0x21b4f0(0x1d2),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x21b4f0(0x204),'callback_data':_0x21b4f0(0x204)},{'text':'no','callback_data':'no'}]]}})[_0x21b4f0(0x205)](_0x239878=>{telegramError(_0x239878);}),tgBot['on']('callback_query',async _0x182ca5=>{const _0x444054=_0x21b4f0,_0x876794=_0x182ca5[_0x444054(0x25f)],_0x26c6db=_0x182ca5['message'];tgBot[_0x444054(0x119)](_0x182ca5['id'])[_0x444054(0x178)](async()=>{const _0x414acf=_0x444054;_0x876794==_0x414acf(0x204)?(await tgBot['sendMessage'](_0x26c6db[_0x414acf(0x189)]['id'],_0x414acf(0x12f),{'parse_mode':_0x414acf(0x252)})[_0x414acf(0x205)](_0xc63838=>{telegramError(_0xc63838);}),unzipFile(_0x9ce1f6,_0x58c0de)):(logger[_0x414acf(0x20b)]('Restore\x20process\x20aborted'),await tgBot['sendMessage'](_0x26c6db[_0x414acf(0x189)]['id'],_0x414acf(0x190))['catch'](_0x287ec1=>{telegramError(_0x287ec1);}));}),tgBot['removeListener']('callback_query');}));}function getServerTime(){const _0x1972fe=_0x4ddc53,_0x1fc860=new Date();return _0x1fc860['getFullYear']()+'/'+(_0x1fc860['getMonth']()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x1fc860[_0x1972fe(0x28d)]()[_0x1972fe(0xeb)]()[_0x1972fe(0x172)](0x2,'0')+'\x20'+_0x1fc860[_0x1972fe(0x1b8)]()[_0x1972fe(0xeb)]()[_0x1972fe(0x172)](0x2,'0')+':'+_0x1fc860[_0x1972fe(0x2aa)]()[_0x1972fe(0xeb)]()['padStart'](0x2,'0')+':'+_0x1fc860[_0x1972fe(0x2b5)]()[_0x1972fe(0xeb)]()[_0x1972fe(0x172)](0x2,'0');}function getTimeStamp(){const _0x24aa57=_0x4ddc53,_0x52cb8e=shiftedTime();return _0x52cb8e[_0x24aa57(0x2c0)]()+'/'+(_0x52cb8e[_0x24aa57(0x1ad)]()+0x1)[_0x24aa57(0xeb)]()[_0x24aa57(0x172)](0x2,'0')+'/'+_0x52cb8e[_0x24aa57(0x28d)]()['toString']()[_0x24aa57(0x172)](0x2,'0')+'\x20'+_0x52cb8e[_0x24aa57(0x1b8)]()[_0x24aa57(0xeb)]()[_0x24aa57(0x172)](0x2,'0')+':'+_0x52cb8e[_0x24aa57(0x2aa)]()['toString']()[_0x24aa57(0x172)](0x2,'0')+':'+_0x52cb8e[_0x24aa57(0x2b5)]()[_0x24aa57(0xeb)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x14f85e=_0x4ddc53,_0x4a3e54=shiftedTime();return _0x4a3e54[_0x14f85e(0x2c0)]()+(_0x4a3e54[_0x14f85e(0x1ad)]()+0x1)[_0x14f85e(0xeb)]()[_0x14f85e(0x172)](0x2,'0')+_0x4a3e54[_0x14f85e(0x28d)]()[_0x14f85e(0xeb)]()[_0x14f85e(0x172)](0x2,'0')+'-'+_0x4a3e54[_0x14f85e(0x1b8)]()[_0x14f85e(0xeb)]()[_0x14f85e(0x172)](0x2,'0')+_0x4a3e54['getMinutes']()[_0x14f85e(0xeb)]()[_0x14f85e(0x172)](0x2,'0')+_0x4a3e54[_0x14f85e(0x2b5)]()[_0x14f85e(0xeb)]()[_0x14f85e(0x172)](0x2,'0');}function shiftedTime(){const _0x36c3c3=_0x4ddc53,_0x1bc39e=new Date();let _0x5d171a=_0x1bc39e;if(settings['timeshift']&&settings[_0x36c3c3(0x285)]!==0x0)_0x5d171a=fns[_0x36c3c3(0x17a)](_0x1bc39e,{'hours':settings[_0x36c3c3(0x285)]});return _0x5d171a;}function startScheduler(){const _0x3b30d9=_0x4ddc53,_0x41ea5e=new Date()[_0x3b30d9(0x1cf)](),_0x173540=shiftedTime()[_0x3b30d9(0x1b8)]();_0x173540==0x4&&backupConfigFiles();_0x173540==0x0&&rotateLogFiles();_0x41ea5e%0x6==0x0&&triggerAnalytics();_0x41ea5e%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x3caacd){const _0x46fcf7=_0x4ddc53;logger['debug'](_0x46fcf7(0x160)+_0x3caacd);const _0x4e46db=getBotsWithMode();_0x4e46db[_0x46fcf7(0x2a4)]>0x0?confirmRestore(configbackuppath,_0x3caacd):unzipFile(configbackuppath,_0x3caacd);}async function getBackupFiles(_0x142712=null){const _0x305222=_0x4ddc53;let _0x1ccd7b=[],_0x5111a0=fs[_0x305222(0x16c)](configbackuppath,{'withFileTypes':!![]});_0x5111a0['sort']((_0x29766b,_0x578272)=>_0x29766b[_0x305222(0x1df)]<_0x578272['name']?0x1:_0x578272['name']<_0x29766b[_0x305222(0x1df)]?-0x1:0x0),_0x5111a0[_0x305222(0x2be)](_0x21d5f2=>{const _0x107c79=_0x305222;if(!_0x21d5f2[_0x107c79(0x2ae)]()&&_0x21d5f2[_0x107c79(0x1df)][_0x107c79(0x13f)](_0x107c79(0x1a2))&&_0x21d5f2[_0x107c79(0x1df)]['endsWith'](_0x107c79(0x1c3))){const _0xe9b145=formatDate(fs[_0x107c79(0x257)](configbackuppath+_0x21d5f2[_0x107c79(0x1df)])[_0x107c79(0x1a7)]);_0x1ccd7b['push']({'name':_0x21d5f2['name'],'mtime':_0xe9b145});}});if(_0x142712)io['to'](_0x142712)[_0x305222(0x186)](_0x305222(0x10f),_0x1ccd7b);else return _0x1ccd7b;}async function backupConfigFiles(){const _0x22cce3=_0x4ddc53;await zipFiles(_0x22cce3(0x2bc));const _0x2426a1=getCleanTimeStamp();fs[_0x22cce3(0x1f9)](zippath+_0x22cce3(0x16b),configbackuppath+('backup-full@'+_0x2426a1+_0x22cce3(0x1c3)));let _0x1a2b97=fs[_0x22cce3(0x16c)](configbackuppath,{'withFileTypes':!![]});_0x1a2b97['sort']((_0x413765,_0x81967a)=>_0x413765[_0x22cce3(0x1df)]<_0x81967a['name']?0x1:_0x81967a['name']<_0x413765[_0x22cce3(0x1df)]?-0x1:0x0),_0x1a2b97[_0x22cce3(0x2a4)]>maxBackups&&fs[_0x22cce3(0x197)](configbackuppath+_0x1a2b97[_0x1a2b97['length']-0x1][_0x22cce3(0x1df)]);}function rotateLogFiles(){const _0x425643=_0x4ddc53,_0x3db474=fs[_0x425643(0x257)](logspath+_0x425643(0x1c6)),_0x5f21bb=_0x3db474['size']/0x400;if(_0x5f21bb>0x64){let _0x4bb22d=fs[_0x425643(0x16c)](logspath,{'withFileTypes':!![]});_0x4bb22d['sort']((_0x1351c6,_0x4e4865)=>_0x1351c6[_0x425643(0x1df)]<_0x4e4865[_0x425643(0x1df)]?0x1:_0x4e4865[_0x425643(0x1df)]<_0x1351c6[_0x425643(0x1df)]?-0x1:0x0),_0x4bb22d[_0x425643(0x2be)](_0x15107d=>{const _0x3ba0a0=_0x425643;if(_0x15107d[_0x3ba0a0(0x1df)]==_0x3ba0a0(0x241))fs[_0x3ba0a0(0x1f9)](logspath+_0x15107d['name'],logspath+_0x3ba0a0(0x2a7));if(_0x15107d['name']==_0x3ba0a0(0xee))fs[_0x3ba0a0(0x1f9)](logspath+_0x15107d[_0x3ba0a0(0x1df)],logspath+_0x3ba0a0(0x241));_0x15107d[_0x3ba0a0(0x1df)]==_0x3ba0a0(0x1c6)&&(fs['copyFileSync'](logspath+_0x15107d['name'],logspath+_0x3ba0a0(0xee)),fs[_0x3ba0a0(0x263)](logspath+_0x15107d[_0x3ba0a0(0x1df)],''));});}}async function zipFiles(_0x34c959){const _0x1c8d16=_0x4ddc53;let _0xa77bd9;if(_0x34c959==_0x1c8d16(0x130))_0xa77bd9=logspath;if(_0x34c959=='backup')_0xa77bd9=configpath;if(_0x34c959==_0x1c8d16(0x2bc))_0xa77bd9=configpath;let _0xbf68eb=fs[_0x1c8d16(0x16c)](_0xa77bd9,{'withFileTypes':!![]});const _0x2990c6=new require(_0x1c8d16(0x1b9))();_0xbf68eb[_0x1c8d16(0x2be)](_0x8ebd21=>{const _0x3bebe2=_0x1c8d16;if(!_0x8ebd21[_0x3bebe2(0x2ae)]()){let _0x2cf9cd=fs[_0x3bebe2(0x15a)](_0xa77bd9+_0x8ebd21['name']);if(_0x34c959==_0x3bebe2(0x29d)){const _0x3fb161=/^bot-[0-9]{3}-config.json$/,_0x1aa02a=_0x3fb161[_0x3bebe2(0x18c)](_0x8ebd21[_0x3bebe2(0x1df)]);if(_0x1aa02a){const _0x4ca3f5=JSON['parse'](_0x2cf9cd);if(_0x4ca3f5[_0x3bebe2(0x219)][0x0]){_0x4ca3f5[_0x3bebe2(0x219)][0x0]['apiKey']='***',_0x4ca3f5['bot'][0x0][_0x3bebe2(0x2b1)]=_0x3bebe2(0x1db);if(_0x4ca3f5[_0x3bebe2(0x219)][0x0][_0x3bebe2(0x295)])_0x4ca3f5[_0x3bebe2(0x219)][0x0]['apiPassword']=_0x3bebe2(0x1db);}_0x2cf9cd=JSON[_0x3bebe2(0x1b6)](_0x4ca3f5,null,0x2);}if(_0x8ebd21['name']==_0x3bebe2(0x1d6)){const _0x18aca1=JSON[_0x3bebe2(0x298)](_0x2cf9cd);if(_0x18aca1['settings'][_0x3bebe2(0x229)])_0x18aca1['settings'][_0x3bebe2(0x229)]=![];if(_0x18aca1[_0x3bebe2(0x215)][_0x3bebe2(0x16a)])_0x18aca1['settings'][_0x3bebe2(0x16a)]=_0x3bebe2(0x1db);if(_0x18aca1[_0x3bebe2(0x215)][_0x3bebe2(0x213)])_0x18aca1[_0x3bebe2(0x215)]['telegramToken']=_0x3bebe2(0x1db);if(_0x18aca1[_0x3bebe2(0x215)][_0x3bebe2(0x290)])_0x18aca1[_0x3bebe2(0x215)][_0x3bebe2(0x290)]=null;_0x2cf9cd=JSON[_0x3bebe2(0x1b6)](_0x18aca1,null,0x2);}if(_0x8ebd21[_0x3bebe2(0x1df)]!='bb-secure.json')_0x2990c6[_0x3bebe2(0x23a)](_0x8ebd21['name'],_0x2cf9cd);}else _0x2990c6[_0x3bebe2(0x23a)](_0x8ebd21[_0x3bebe2(0x1df)],_0x2cf9cd);}});const _0x3039ba=_0x2990c6[_0x1c8d16(0x279)]({'base64':![],'compression':'DEFLATE'});fs[_0x1c8d16(0x263)](zippath+(_0x34c959+_0x1c8d16(0x1c3)),_0x3039ba,'binary');}async function unzipFile(_0x3da5cd,_0x13faf8){const _0x498651=_0x4ddc53;fs[_0x498651(0x16c)](configpath,{'withFileTypes':!![]})[_0x498651(0x2be)](_0x482e93=>{const _0x4aa309=_0x498651;if(!_0x482e93[_0x4aa309(0x2ae)]())fs['rmSync'](configpath+_0x482e93[_0x4aa309(0x1df)]);});const _0x4ef002=fs[_0x498651(0x15a)](_0x3da5cd+_0x13faf8,_0x498651(0x112)),_0x544a22=new require('node-zip')(_0x4ef002,{'base64':![],'checkCRC32':!![]});Object[_0x498651(0x1ab)](_0x544a22[_0x498651(0x17d)])[_0x498651(0x2be)](_0x5ce476=>{const _0x11b053=_0x498651,_0x4c7150=_0x544a22[_0x11b053(0x17d)][_0x5ce476];fs[_0x11b053(0x263)](configpath+_0x4c7150[_0x11b053(0x1df)],_0x4c7150['_data']);}),fs[_0x498651(0x16c)](temppath,{'withFileTypes':!![]})[_0x498651(0x2be)](_0x1086d4=>{const _0x105814=_0x498651;if(!_0x1086d4[_0x105814(0x2ae)]())fs[_0x105814(0x108)](temppath+_0x1086d4[_0x105814(0x1df)]);}),logger[_0x498651(0x20b)](_0x498651(0x1d0)),process['send']({'restore':!![]},_0x4b4e4b=>{});}async function getPublicIp(){const _0x3f9525=_0x4ddc53;try{const _0x6002cd=await axios[_0x3f9525(0x13b)](_0x3f9525(0x20c));publicip=_0x6002cd['data']['ip'];}catch(_0x28c598){}}async function triggerAnalytics(){const _0x2d0854=_0x4ddc53;if(!publicip)await getPublicIp();const _0x1c1027=getBotsWithMode();let _0x31671b=0x0;_0x1c1027[_0x2d0854(0x2be)](_0x448da5=>{const _0x5bbdbc=_0x2d0854;if(_0x448da5[_0x5bbdbc(0x250)]===_0x5bbdbc(0x175))_0x31671b++;});const _0x3dc10e=getBotExchanges();mixpanel[_0x2d0854(0x17c)]('Server',{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x1c1027[_0x2d0854(0x2a4)],'numbotsenabled':_0x31671b,'exchanges':_0x3dc10e});}async function getMessages(){const _0x35fd86=_0x4ddc53,_0x5577f4=_0x35fd86(0x2b7),_0x45823b=new GraphQLClient(_0x5577f4),_0x5a03b1={'authorization':_0x35fd86(0xed)},_0x345e45=serverversion[_0x35fd86(0x19b)]('.'),_0x329974=_0x345e45[0x0]+'.'+_0x345e45[0x1],_0x448223=Math[_0x35fd86(0x145)](settings[_0x35fd86(0x1b3)],settings[_0x35fd86(0x2a3)]),_0xf7e855={'last':parseInt(_0x448223),'bbm':_0x329974},_0x51c10f=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x31613f;try{_0x31613f=await _0x45823b[_0x35fd86(0x2b8)](_0x51c10f,_0xf7e855,_0x5a03b1);}catch(_0x5a04f){}if(_0x31613f&&_0x31613f[_0x35fd86(0x2a1)]){let _0x1994e3=settings['lastmsgtelegram'];newMessages=[];for(const _0x32426b of _0x31613f[_0x35fd86(0x2a1)]){newMessages[_0x35fd86(0x28c)](_0x32426b);let _0x3e532d=![];_0x32426b['bbvNew']&&(updateSetting(_0x35fd86(0x1f7),_0x32426b[_0x35fd86(0x1a3)]),_0x3e532d=isNewerVersion(serverversion,_0x32426b[_0x35fd86(0x1a3)])||serverversion==_0x32426b[_0x35fd86(0x1a3)]);if(!_0x3e532d&&_0x32426b['number']>_0x1994e3){if(_0x32426b['bbvReceive']==='any'||serverversion[_0x35fd86(0x13f)](_0x32426b['bbvReceive'])){let _0x378099=''+_0x32426b[_0x35fd86(0x124)]+'\x0a\x0a'+_0x32426b[_0x35fd86(0xfc)];const _0x4dcf5c=await sendTelegramMsg(toTelegramMarkdown(_0x378099),_0x35fd86(0x13e));if(_0x4dcf5c)_0x1994e3=_0x32426b[_0x35fd86(0xf1)];}}}updateAvailable=isNewerVersion(settings[_0x35fd86(0x1f7)],serverversion),updateSetting('lastmsgtelegram',_0x1994e3),emitMessages();}}function emitMessages(){const _0x3bc0b8=_0x4ddc53,_0x603af1=settings[_0x3bc0b8(0x2a3)];let _0x1143e0=[];newMessages[_0x3bc0b8(0x2be)](_0x34f11b=>{const _0x182078=_0x3bc0b8;_0x34f11b[_0x182078(0xf1)]>_0x603af1&&_0x1143e0[_0x182078(0x28c)](_0x34f11b);}),_0x1143e0[_0x3bc0b8(0x2a4)]>0x0&&getAllClients()['forEach'](_0x3411db=>{const _0x5e21bb=_0x3bc0b8;getSocket(_0x3411db['id'])[_0x5e21bb(0x186)]('message',_0x1143e0);});}function confirmMessage(_0x5b1603){const _0x1dd092=_0x4ddc53;updateSetting(_0x1dd092(0x2a3),Number(_0x5b1603));}function isNewerVersion(_0x16da17,_0x105abd){const _0x42e328=_0x4ddc53,_0x2fde73=_0x105abd[_0x42e328(0x19b)]('.'),_0x335b4c=_0x16da17[_0x42e328(0x19b)]('.');for(var _0x189ec0=0x0;_0x189ec0<_0x335b4c[_0x42e328(0x2a4)];_0x189ec0++){const _0x2791cf=~~_0x335b4c[_0x189ec0],_0x1aae1a=~~_0x2fde73[_0x189ec0];if(_0x2791cf>_0x1aae1a)return!![];if(_0x2791cf<_0x1aae1a)return![];}return![];}function toTelegramMarkdown(_0x265f0d){const _0x54613b=_0x4ddc53,_0x300bc3=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x107ac7=/\*{2}(.+?)\*{2}/gim;return _0x265f0d=_0x265f0d[_0x54613b(0x231)](_0x300bc3,'$1_$2_$3')[_0x54613b(0x231)](_0x107ac7,_0x54613b(0x132)),_0x265f0d;}async function validateConfigFile(){const _0x1181c5=_0x4ddc53,_0x460d28=dbConfig['get'](_0x1181c5(0x24f))[_0x1181c5(0x2c2)]('botID')[_0x1181c5(0x22e)]()||[];if(_0x460d28[_0x1181c5(0x2a4)]==0x0){let _0x3d5569=0x0,_0x4a7d58=[];const _0xb886ac=/^bot-([0-9]{3})-config.json$/,_0x10e345=fs[_0x1181c5(0x16c)](configpath);_0x10e345[_0x1181c5(0x2be)](_0x503d1d=>{const _0x342de6=_0x1181c5,_0x5b079b=_0xb886ac['exec'](_0x503d1d);if(_0x5b079b){const _0x4fb853=_0x5b079b[0x1];let _0x20959e=getBotAttributes(_0x4fb853);_0x4a7d58[_0x342de6(0x28c)]({'botID':_0x4fb853,'botname':_0x20959e[_0x342de6(0x17b)],'status':_0x342de6(0x19c),'live':_0x342de6(0x1d7)}),_0x3d5569++;}}),_0x3d5569!=0x0&&(dbConfig[_0x1181c5(0x13b)](_0x1181c5(0x24f))[_0x1181c5(0x15b)](_0x4a7d58)[_0x1181c5(0x249)](),config=_0x4a7d58,restoredConfigFile=_0x3d5569);}}async function restoreConfigNotify(_0x388e51){const _0x1b0d03=_0x4ddc53;let _0x3931af;if(restoredConfigFile==0x1)_0x3931af=_0x1b0d03(0x1a8);else _0x3931af='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x388e51)io['to']('botmanager')[_0x1b0d03(0x186)](_0x1b0d03(0x1cb),_0x3931af);else{logger['simple'](_0x1b0d03(0x116)),logger['simple'](_0x3931af),logger[_0x1b0d03(0x266)](_0x1b0d03(0x116)),logger[_0x1b0d03(0x266)]('');if(tgBot&&settings[_0x1b0d03(0x290)]&&settings[_0x1b0d03(0x246)]!=_0x1b0d03(0x168))tgBot[_0x1b0d03(0x1e7)](settings[_0x1b0d03(0x290)],'Bot\x20Mgr\x20>\x20'+_0x3931af)['catch'](_0x4ecaf6=>{telegramError(_0x4ecaf6);});}}function validateCredentials(_0x2c095f,_0x1d0799){const _0x5da3ac=_0x4ddc53;if(_0x2c095f['username']==settings[_0x5da3ac(0x2c7)]&&bcrypt[_0x5da3ac(0x1be)](_0x2c095f[_0x5da3ac(0x194)],settings[_0x5da3ac(0x16a)])){if(settings['f2aRequired'])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x5cb697=generateLoginToken(_0x1d0799);return{'allow':!![],'reason':_0x5da3ac(0x166),'token':_0x5cb697};}}else return{'allow':![],'reason':_0x5da3ac(0xf9),'token':null};}function refreshToken(_0x44ad3f){const _0xac4a1b=generateLoginToken(_0x44ad3f);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0xac4a1b};}function validateAccess(_0xb07c65,_0x11da6a,_0x579e7e){const _0x284caa=_0x4ddc53,_0x28fa90=_0x579e7e?_0x579e7e:devices[_0x11da6a]['ip'];let _0x273a3a;const _0x8396ae=_0x4b3bf3=>{const _0x20e7fc=_0x4047;if(settings['loginRequired']){if(settings[_0x20e7fc(0x12a)]){if(telegram2FaApproved(_0x11da6a)){const _0x2ab6a3=generateLoginToken(_0x11da6a);return{'allow':!![],'reason':_0x20e7fc(0x227),'token':_0x2ab6a3};}else return{'allow':![],'reason':_0x20e7fc(0x1f5),'token':null};}else return _0x273a3a=validToken(_0x4b3bf3,_0x11da6a),_0x273a3a[_0x20e7fc(0x27f)](_0x20e7fc(0xfe))?{'allow':!![],'reason':_0x20e7fc(0x254),'token':_0x4b3bf3}:{'allow':![],'reason':_0x20e7fc(0x1f5),'token':null};}else return{'allow':!![],'reason':_0x20e7fc(0x28e),'token':null};};if(settings[_0x284caa(0x1d8)]){let _0x12945e=[...settings[_0x284caa(0x248)],'::1',_0x284caa(0xec),_0x284caa(0x22f)];if(_0x12945e[_0x284caa(0x2a9)](_0x28fa90))return _0x8396ae(_0xb07c65);else{_0x273a3a=validToken(_0xb07c65,_0x11da6a);if(_0x273a3a[_0x284caa(0x27f)](_0x284caa(0xfe)))return _0x8396ae(_0xb07c65);else{if(telegramIpApproved(_0x11da6a)){const _0x25089b=generateToken(_0x11da6a);return _0x273a3a=_0x8396ae(_0xb07c65),_0x273a3a['allow']?{'allow':!![],'reason':_0x284caa(0x148),'token':_0x25089b}:_0x273a3a;}else return settings[_0x284caa(0x265)]?{'allow':![],'reason':_0x284caa(0x299),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x8396ae(_0xb07c65);}function timelyDecrypt(_0x500b64,_0x5b71a=!![]){const _0x367535=_0x4ddc53;if(_0x500b64)try{const _0x550204=crypt['decrypt'](secure[_0x367535(0x287)],_0x500b64)[_0x367535(0xfc)],_0x2305e2=_0x550204[_0x367535(0x19b)]('@')[0x0],_0x1d4425=_0x550204['split']('@')[0x1],_0x45033c=new Date()[_0x367535(0x271)]();if(_0x5b71a){if(_0x45033c-_0x1d4425<maxSecretAge*0x3e8)return _0x2305e2;else return![];}else return _0x2305e2;}catch(_0x5038a0){return![];}else return![];}const validToken=(_0x466fb2,_0x361006)=>{const _0x2d8256=_0x4ddc53,_0x225fff=devices[_0x361006]['ip'];if(!_0x466fb2)return{'error':_0x2d8256(0x180)};for(let _0x1c17a6 of blacklist){if(_0x1c17a6[_0x2d8256(0x25c)]==_0x466fb2)return{'error':_0x2d8256(0x12e)};}let _0x665a4d;try{_0x665a4d=jwt['verify'](_0x466fb2,secure[_0x2d8256(0x27a)]+_0x361006);}catch{return{'error':_0x2d8256(0x14e)};}if(!_0x665a4d[_0x2d8256(0x27f)](_0x2d8256(0x282))&&!_0x665a4d[_0x2d8256(0x27f)](_0x2d8256(0x121))||!_0x665a4d[_0x2d8256(0x27f)](_0x2d8256(0x1b4)))return{'error':_0x2d8256(0x26d)};if(!_0x665a4d[_0x2d8256(0x27f)](_0x2d8256(0x121))&&_0x665a4d[_0x2d8256(0x27f)](_0x2d8256(0x282))){const {clientip:_0x140384}=_0x665a4d;return _0x225fff==_0x140384?{'success':_0x2d8256(0x1ef)}:{'error':_0x2d8256(0xf3)};}else{if(_0x665a4d[_0x2d8256(0x27f)](_0x2d8256(0x121))&&_0x665a4d['hasOwnProperty']('clientip')){const {username:_0x4f9c5b,clientip:_0x33e30f}=_0x665a4d;return settings[_0x2d8256(0x2c7)]==_0x4f9c5b&&_0x225fff==_0x33e30f?{'success':_0x2d8256(0x1ef)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x3cfd65=>{const _0x1408d8=_0x4ddc53;if(_0x3cfd65){const _0x2a4dec=devices[_0x3cfd65]['ip'];return jwt[_0x1408d8(0x19a)]({'username':settings[_0x1408d8(0x2c7)],'clientip':_0x2a4dec},secure[_0x1408d8(0x27a)]+_0x3cfd65,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x2e25b5=>{const _0x13b57b=_0x4ddc53;if(_0x2e25b5){const _0x2e7ef7=devices[_0x2e25b5]['ip'];return jwt['sign']({'clientip':_0x2e7ef7},secure[_0x13b57b(0x27a)]+_0x2e25b5,{'expiresIn':devices[_0x2e25b5][_0x13b57b(0xf8)][_0x13b57b(0x140)]*0x3c});}else return![];},telegramIpApproved=_0x53fb78=>{const _0x16650a=_0x4ddc53;let _0x51c287=![];return devices[_0x53fb78][_0x16650a(0xf8)]&&devices[_0x53fb78][_0x16650a(0xf8)][_0x16650a(0x140)]!=_0x16650a(0x22d)&&(_0x51c287=devices[_0x53fb78][_0x16650a(0xf8)][_0x16650a(0x282)]==devices[_0x53fb78]['ip']&&new Date()['getTime']()-devices[_0x53fb78][_0x16650a(0xf8)][_0x16650a(0x261)]<devices[_0x53fb78]['telegramIpApproval'][_0x16650a(0x140)]*0x3c*0x3e8),_0x51c287;},telegram2FaApproved=_0x446a67=>{const _0xcbc270=_0x4ddc53;let _0x49571a=![];return devices[_0x446a67][_0xcbc270(0x2c6)]&&devices[_0x446a67]['telegram2FaApproval'][_0xcbc270(0x140)]!=_0xcbc270(0x22d)&&(_0x49571a=devices[_0x446a67][_0xcbc270(0x2c6)][_0xcbc270(0x282)]==devices[_0x446a67]['ip']&&new Date()[_0xcbc270(0x271)]()-devices[_0x446a67][_0xcbc270(0x2c6)]['timestamp']<devices[_0x446a67]['telegram2FaApproval'][_0xcbc270(0x140)]*0x3c*0x3e8),_0x49571a;},normalizeIP=_0x470c5e=>{const _0x4ce32f=_0x4ddc53;let _0x12c429=null,_0x34003a=null;if(ipaddr[_0x4ce32f(0x17e)](_0x470c5e)){const _0x5a0136=ipaddr[_0x4ce32f(0x298)](_0x470c5e);_0x5a0136['kind']()===_0x4ce32f(0x28a)?(_0x5a0136[_0x4ce32f(0x133)]()&&(_0x12c429=_0x5a0136[_0x4ce32f(0x29b)]()['toString']()),_0x34003a=_0x5a0136[_0x4ce32f(0xeb)]()):(_0x12c429=_0x5a0136[_0x4ce32f(0xeb)](),_0x34003a=_0x5a0136[_0x4ce32f(0x13d)]()[_0x4ce32f(0xeb)]());}return{'show':_0x12c429?_0x12c429:_0x34003a,'store':_0x34003a};};function formatDate(_0x3e4f47){const _0x13e7e9=_0x4ddc53;return _0x3e4f47[_0x13e7e9(0x2c0)]()+'/'+(_0x3e4f47[_0x13e7e9(0x1ad)]()+0x1)[_0x13e7e9(0xeb)]()['padStart'](0x2,'0')+'/'+_0x3e4f47['getDate']()[_0x13e7e9(0xeb)]()[_0x13e7e9(0x172)](0x2,'0')+'\x20'+_0x3e4f47[_0x13e7e9(0x1b8)]()[_0x13e7e9(0xeb)]()[_0x13e7e9(0x172)](0x2,'0')+':'+_0x3e4f47[_0x13e7e9(0x2aa)]()[_0x13e7e9(0xeb)]()[_0x13e7e9(0x172)](0x2,'0')+':'+_0x3e4f47[_0x13e7e9(0x2b5)]()[_0x13e7e9(0xeb)]()[_0x13e7e9(0x172)](0x2,'0');}function sleep(_0xab4271){return new Promise(_0xbb9a75=>setTimeout(_0xbb9a75,_0xab4271));}