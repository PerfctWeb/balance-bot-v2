const _0xd8b866=_0x3062;(function(_0x112670,_0x4aa2d0){const _0x395b50=_0x3062,_0x4059b8=_0x112670();while(!![]){try{const _0x194914=-parseInt(_0x395b50(0x247))/0x1+parseInt(_0x395b50(0x141))/0x2*(parseInt(_0x395b50(0x159))/0x3)+-parseInt(_0x395b50(0x215))/0x4*(parseInt(_0x395b50(0xe1))/0x5)+parseInt(_0x395b50(0xf1))/0x6*(-parseInt(_0x395b50(0x139))/0x7)+parseInt(_0x395b50(0x1ed))/0x8*(-parseInt(_0x395b50(0x23a))/0x9)+-parseInt(_0x395b50(0x250))/0xa+-parseInt(_0x395b50(0x97))/0xb*(-parseInt(_0x395b50(0x1a9))/0xc);if(_0x194914===_0x4aa2d0)break;else _0x4059b8['push'](_0x4059b8['shift']());}catch(_0x23c5d6){_0x4059b8['push'](_0x4059b8['shift']());}}}(_0x5d88,0xc59a8));const _0x108d93=function(){let _0x1db04f=!![];return function(_0x551ab2,_0x2655e8){const _0xb29889=_0x1db04f?function(){const _0xeb2be1=_0x3062;if(_0x2655e8){const _0xd17bc9=_0x2655e8[_0xeb2be1(0x120)](_0x551ab2,arguments);return _0x2655e8=null,_0xd17bc9;}}:function(){};return _0x1db04f=![],_0xb29889;};}(),_0xaf03bf=_0x108d93(this,function(){const _0x14439c=_0x3062;return _0xaf03bf['toString']()[_0x14439c(0x252)]('(((.+)+)+)+$')['toString']()[_0x14439c(0x163)](_0xaf03bf)['search'](_0x14439c(0x1ea));});_0xaf03bf();'use strict';process[_0xd8b866(0xba)][_0xd8b866(0x188)]=0x1;const childProcess=require(_0xd8b866(0x22a)),fs=require('fs'),fns=require(_0xd8b866(0xff)),low=require(_0xd8b866(0x184)),FileSync=require(_0xd8b866(0x1ff)),path=require(_0xd8b866(0x256)),crypto=require(_0xd8b866(0xcf)),Crypt=require(_0xd8b866(0x93))['Crypt'],RSA=require(_0xd8b866(0x93))[_0xd8b866(0xd1)],bcrypt=require(_0xd8b866(0x86)),jwt=require(_0xd8b866(0x106)),ipaddr=require(_0xd8b866(0x80)),argv=require(_0xd8b866(0x1bf))(process[_0xd8b866(0x88)][_0xd8b866(0x1c0)](0x2))[_0xd8b866(0x88)],uuidRandom=require(_0xd8b866(0x173)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require('mixpanel'),axios=require(_0xd8b866(0xb5)),{GraphQLClient,gql}=require('graphql-request'),util=require('util'),fileUpload=require(_0xd8b866(0x229)),{networkInterfaces}=require('os'),PORT=argv['port']||_0xd8b866(0x1fe),pattern=/^[0-9]{2,4}$/;!pattern[_0xd8b866(0x115)](PORT)&&(console['log'](_0xd8b866(0xc4)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1));const HOST=argv[_0xd8b866(0x192)]||null,userID=argv[_0xd8b866(0x15d)]||'',debugging=argv['d']||![],nodeversion=process[_0xd8b866(0x16a)]['node'];let bbpath='bb/',bbpath2='';const botfile=_0xd8b866(0x1de),configfile=_0xd8b866(0x198),settingsfile=_0xd8b866(0x152),securefile=_0xd8b866(0x1ab),environment=require('./'+bbpath2+_0xd8b866(0x18b))['environment']||_0xd8b866(0xb0),maxBackups=0xa;let validInstallation=!![];!fs[_0xd8b866(0x161)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0xd8b866(0xf9)),configpath=userID?bbpath+_0xd8b866(0xe6)+userID+'/':bbpath+'config/',configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0xd8b866(0x251)+userID+'/':bbpath+_0xd8b866(0x251),zippath=userID?bbpath+_0xd8b866(0x135)+userID+'/':bbpath+_0xd8b866(0x135),loggerfile=fs[_0xd8b866(0x154)](logspath+_0xd8b866(0xdf),{'flags':'a'}),temppath=userID?bbpath+_0xd8b866(0x1ad)+userID+'/':bbpath+_0xd8b866(0x1ad);!fs[_0xd8b866(0x161)](configpath)&&fs[_0xd8b866(0xb6)](configpath);!fs[_0xd8b866(0x161)](configbackuppath)&&fs[_0xd8b866(0xb6)](configbackuppath);!fs[_0xd8b866(0x161)](logspath)&&fs['mkdirSync'](logspath);!fs[_0xd8b866(0x161)](zippath)&&fs[_0xd8b866(0xb6)](zippath);!fs[_0xd8b866(0x161)](temppath)&&fs[_0xd8b866(0xb6)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0xd8b866(0x246)]({'bots':[]})[_0xd8b866(0x223)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0xd8b866(0x246)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![]}})[_0xd8b866(0x223)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0xd8b866(0xfb),'rsaStandard':_0xd8b866(0x221)});const saltRounds=0xa,mixpanel=Mixpanel[_0xd8b866(0xc8)](_0xd8b866(0xbe),{'host':_0xd8b866(0x1d4)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0xd8b866(0x169)]&&settings[_0xd8b866(0x169)]!=''&&settings[_0xd8b866(0x13d)]&&settings[_0xd8b866(0x13d)]!='')initTelegram();const parseColor=(_0x4744af,_0x45083f)=>{const _0x5af025=_0xd8b866,_0x43150e=/#[A-Z]{3}#/g;if(typeof _0x4744af=='string'){!_0x45083f?_0x4744af=_0x4744af[_0x5af025(0xed)](_0x43150e,''):(_0x4744af=_0x4744af[_0x5af025(0xed)](/#BLU#/g,_0x5af025(0xe0)),_0x4744af=_0x4744af[_0x5af025(0xed)](/#RED#/g,_0x5af025(0xbf)),_0x4744af=_0x4744af[_0x5af025(0xed)](/#YEL#/g,'\x1b[33m'),_0x4744af=_0x4744af['replace'](/#MAG#/g,_0x5af025(0x24e)),_0x4744af=_0x4744af[_0x5af025(0xed)](/#CYA#/g,_0x5af025(0x134)),_0x4744af=_0x4744af[_0x5af025(0xed)](/#RES#/g,_0x5af025(0x185)));;}return _0x4744af;},logger={'screen':_0x1c6948=>{const _0x27b650=_0xd8b866;console[_0x27b650(0x17e)](parseColor(_0x1c6948,!![]));},'simple':_0x484c5c=>{const _0x4bbece=_0xd8b866;console[_0x4bbece(0x17e)](parseColor(_0x484c5c,!![])),loggerfile['write'](util[_0x4bbece(0x9b)](parseColor(_0x484c5c,![]))+'\x0a');},'full':async _0x41a053=>{const _0x50d198=_0xd8b866,_0x2774d7=getTimeStamp()+_0x50d198(0x15c)+_0x41a053;console[_0x50d198(0x17e)](parseColor(_0x2774d7,!![])),loggerfile['write'](util['format'](parseColor(_0x2774d7,![]))+'\x0a');if(tgBot&&settings[_0x50d198(0x20f)]&&settings['telegramEvents']!='orders')await tgBot['sendMessage'](settings[_0x50d198(0x20f)],_0x50d198(0x259)+parseColor(_0x41a053,![]))[_0x50d198(0x248)](_0x41a753=>{telegramError(_0x41a753);});},'debug':async(_0x46744d,_0x49663e='')=>{const _0xd723b2=_0xd8b866,_0xbe207=getTimeStamp()+_0xd723b2(0xda)+_0x46744d;if(debugging)console[_0xd723b2(0x17e)](parseColor(_0xbe207,!![]));loggerfile['write'](util[_0xd723b2(0x9b)](parseColor(_0xbe207,![]))+'\x0a');if(_0x49663e){if(debugging)console[_0xd723b2(0x17e)](_0x49663e);loggerfile[_0xd723b2(0x223)](util[_0xd723b2(0x9b)](_0x49663e)+'\x0a');}}};process['on'](_0xd8b866(0x20e),function(_0x101b2b){logger['simple'](_0x101b2b);});function _0x3062(_0x31c456,_0x468c45){const _0x2a46cc=_0x5d88();return _0x3062=function(_0xaf03bf,_0x108d93){_0xaf03bf=_0xaf03bf-0x80;let _0x5d8835=_0x2a46cc[_0xaf03bf];return _0x5d8835;},_0x3062(_0x31c456,_0x468c45);}let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0xd8b866(0x18b))[_0xd8b866(0x234)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0xd8b866(0x23f)),app=express(),http=require(_0xd8b866(0x1d0))[_0xd8b866(0x1bc)](app);app[_0xd8b866(0x9f)](fileUpload({'useTempFiles':!![]})),app[_0xd8b866(0x225)](_0xd8b866(0x138),async(_0x30299c,_0x578091)=>{const _0x3c024c=_0xd8b866,_0x44e77b=_0x30299c[_0x3c024c(0x12f)][_0x3c024c(0x245)],_0x51886f=getClientsWithBotID(_0x3c024c(0x1df)),_0x8670ee=_0x30299c[_0x3c024c(0x18f)][_0x3c024c(0x20a)],_0xc30187=timelyDecrypt(_0x8670ee,![]),_0x53fed2=_0x51886f[_0x3c024c(0x8f)](_0x33a35c=>_0x33a35c['uuid']==_0xc30187);if(_0x53fed2){const _0x125a2a=normalizeIP(_0x30299c[_0x3c024c(0x1f6)]['remoteAddress'])['store'],_0x4e0d44=_0x30299c['headers']['tkn'];if(validateAccess(_0x4e0d44,_0xc30187,_0x125a2a)[_0x3c024c(0x143)])_0x44e77b==_0x3c024c(0x18a)&&await backupConfigFiles(),await zipFiles(_0x44e77b),_0x578091[_0x3c024c(0xf2)](zippath+(_0x44e77b+_0x3c024c(0x216)),_0x59385e=>{const _0x323445=_0x3c024c;_0x59385e&&(logger['full'](_0x323445(0x1d5)+_0x44e77b),logger[_0x323445(0x21a)](_0x59385e));});else logger[_0x3c024c(0x1b6)](_0x3c024c(0x1e7)+_0x44e77b+_0x3c024c(0x1c4));}else logger[_0x3c024c(0x1b6)](_0x3c024c(0x1e7)+_0x44e77b+_0x3c024c(0x1a0));}),app[_0xd8b866(0x11f)](_0xd8b866(0x16f),async(_0x5ac34b,_0x271bab)=>{const _0x5b5475=_0xd8b866,_0x546af1=getClientsWithBotID('botmanager'),_0x3a0ed5=_0x5ac34b['headers'][_0x5b5475(0x20a)],_0x32f2f8=timelyDecrypt(_0x3a0ed5,![]),_0x4c999d=_0x546af1[_0x5b5475(0x8f)](_0x58b961=>_0x58b961['uuid']==_0x32f2f8);logger[_0x5b5475(0x13e)](_0x5b5475(0x111));if(_0x4c999d){const _0x1f3637=normalizeIP(_0x5ac34b[_0x5b5475(0x1f6)][_0x5b5475(0x23d)])[_0x5b5475(0x92)],_0x114d2e=_0x5ac34b[_0x5b5475(0x18f)][_0x5b5475(0x202)];if(validateAccess(_0x114d2e,_0x32f2f8,_0x1f3637)[_0x5b5475(0x143)]){if(_0x5ac34b['files']){const _0x63f6a2=_0x5ac34b['files'][_0x5b5475(0x1fc)];await _0x63f6a2['mv'](temppath+_0x63f6a2[_0x5b5475(0xd4)]),_0x271bab[_0x5b5475(0x200)]({'status':!![],'message':_0x5b5475(0x1b2)});const _0x2578fe=getBotsWithMode();_0x2578fe[_0x5b5475(0x1d8)]>0x0?confirmRestore(temppath,_0x63f6a2[_0x5b5475(0xd4)]):unzipFile(temppath,_0x63f6a2['name']);}}else logger[_0x5b5475(0x1b6)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x5b5475(0x1b6)](_0x5b5475(0x108));}),app['use'](express[_0xd8b866(0x13a)](path['join'](__dirname,bbpath2,_0xd8b866(0x114)))),app[_0xd8b866(0x9f)](express[_0xd8b866(0x13a)](path[_0xd8b866(0x148)](__dirname,bbpath2,_0xd8b866(0xb4)))),app[_0xd8b866(0x225)]('/',function(_0xf4dd8d,_0x341dc6){const _0x47f090=_0xd8b866;_0x341dc6[_0x47f090(0xa0)](path[_0x47f090(0x148)](__dirname,bbpath2,_0x47f090(0x114),_0x47f090(0x1dc)));}),app[_0xd8b866(0x225)]('/:bot',function(_0x537915,_0x36faa3){const _0x25eb2a=_0xd8b866;_0x36faa3[_0x25eb2a(0xa0)](path['join'](__dirname,bbpath2,'build',_0x25eb2a(0x1dc)));}),app[_0xd8b866(0x225)]('/:bot/portfolio',(_0x4ce62b,_0x1db2ca)=>{const _0x3b300f=_0xd8b866;_0x1db2ca['sendFile'](path[_0x3b300f(0x148)](__dirname,bbpath2,_0x3b300f(0xb4),_0x3b300f(0x1dc)));}),app[_0xd8b866(0x225)](_0xd8b866(0x24c),(_0x5eb0d2,_0x5cc553)=>{const _0x58d2d2=_0xd8b866;_0x5cc553[_0x58d2d2(0xa0)](path[_0x58d2d2(0x148)](__dirname,bbpath2,_0x58d2d2(0xb4),_0x58d2d2(0x1dc)));}),app[_0xd8b866(0x225)](_0xd8b866(0x1c8),(_0x5e243a,_0x66ba06)=>{const _0x7bce89=_0xd8b866;_0x66ba06['sendFile'](path[_0x7bce89(0x148)](__dirname,bbpath2,_0x7bce89(0xb4),_0x7bce89(0x1dc)));}),app[_0xd8b866(0x225)](_0xd8b866(0x1f2),(_0x4ab8c6,_0x1f434b)=>{const _0x4c01ea=_0xd8b866;_0x1f434b['sendFile'](path[_0x4c01ea(0x148)](__dirname,bbpath2,_0x4c01ea(0xb4),'index.html'));}),app[_0xd8b866(0x225)]('/:bot/configuration',(_0x5016e3,_0x47d0ea)=>{const _0x496b48=_0xd8b866;_0x47d0ea[_0x496b48(0xa0)](path['join'](__dirname,bbpath2,_0x496b48(0xb4),_0x496b48(0x1dc)));}),app[_0xd8b866(0x225)](_0xd8b866(0xa5),(_0x434662,_0xc33192)=>{const _0x1270a3=_0xd8b866;_0xc33192['sendFile'](path[_0x1270a3(0x148)](__dirname,bbpath2,_0x1270a3(0xb4),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http[_0xd8b866(0x24b)](PORT);const io=require(_0xd8b866(0x1b9))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x219a0c=_0xd8b866;let _0x136656=_0x219a0c(0x178);const _0x1ee24f=networkInterfaces(),_0x3ec1ef={};for(const _0x3cda9b of Object[_0x219a0c(0xb7)](_0x1ee24f)){for(const _0x185a26 of _0x1ee24f[_0x3cda9b]){if((_0x185a26['family']==_0x219a0c(0x1a4)||_0x185a26[_0x219a0c(0x12b)]==0x4)&&!_0x185a26[_0x219a0c(0xd2)]){const _0x365727=ipaddr[_0x219a0c(0x193)](_0x185a26[_0x219a0c(0x8e)])[_0x219a0c(0x1e1)]();_0x365727!=_0x219a0c(0x10d)&&(!_0x3ec1ef[_0x3cda9b]&&(_0x3ec1ef[_0x3cda9b]=[]),_0x3ec1ef[_0x3cda9b][_0x219a0c(0x162)](_0x185a26[_0x219a0c(0x8e)]),_0x136656=_0x185a26[_0x219a0c(0x8e)]);}}}return{'serverip':_0x136656,'netinterfaces':_0x3ec1ef};}async function startServer(){const _0x4a3cdb=_0xd8b866,{serverip:_0x4640ba,netinterfaces:_0x325f3b}=getServerIP();logger[_0x4a3cdb(0x21a)](''),logger['simple'](_0x4a3cdb(0x24a)),await logger[_0x4a3cdb(0x1b6)](_0x4a3cdb(0x194)+serverversion+'#RES#\x20'+(environment==_0x4a3cdb(0x107)?_0x4a3cdb(0x1fb):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x4a3cdb(0x18c))+('=>\x20Go\x20to\x20#CYA#http://'+_0x4640ba+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x4a3cdb(0x21a)](_0x4a3cdb(0x24a));if(config[_0x4a3cdb(0x1d8)]!=0x0)for(const _0x4a0a4d of config){const _0x25aef3=_0x4a0a4d[_0x4a3cdb(0x1d3)]==_0x4a3cdb(0x19d)?'a':'m';if(_0x4a0a4d[_0x4a3cdb(0x137)]==_0x4a3cdb(0x16e)||_0x4a0a4d[_0x4a3cdb(0x137)]==_0x4a3cdb(0x10b))await logger[_0x4a3cdb(0x1b6)]('Starting\x20('+_0x25aef3+_0x4a3cdb(0x238)+_0x4a0a4d['botID']+_0x4a3cdb(0x164)+_0x4a0a4d[_0x4a3cdb(0x1f3)]),startBot([_0x4a0a4d['botID'],userID],{'cwd':bbpath},function(_0x42b37f){const _0x1ed2f3=_0x4a3cdb;if(_0x42b37f)logger[_0x1ed2f3(0x1b6)](_0x42b37f);});else(_0x4a0a4d[_0x4a3cdb(0x137)]=='disabled'||_0x4a0a4d[_0x4a3cdb(0x137)]=='new-disabled')&&await logger[_0x4a3cdb(0x1b6)](_0x4a3cdb(0x9c)+_0x25aef3+_0x4a3cdb(0x102)+_0x4a0a4d[_0x4a3cdb(0x176)]+_0x4a3cdb(0x164)+_0x4a0a4d['botname']);}else!newBot&&logger[_0x4a3cdb(0x21a)](_0x4a3cdb(0x168));if(newBot)addBot();logger['simple'](_0x4a3cdb(0x24a)),logger[_0x4a3cdb(0x21a)](''),await logger['debug']('Node.js\x20v'+nodeversion),await logger['debug'](_0x4a3cdb(0x182),_0x325f3b);}function startSocket(){io['on']('connection',_0xc8a244=>{const _0x2c2bdf=_0x3062;let _0x45a988,_0x37574b,_0xf13265,_0x37b371,_0x212661;const _0x2e52d2=_0xc8a244[_0x2c2bdf(0x156)][_0x2c2bdf(0x18f)][_0x2c2bdf(0x18d)];_0x37574b=_0x2e52d2[_0x2c2bdf(0x195)](/bot[0-9]{3}/);if(_0x37574b)_0xf13265=_0x37574b[0x0][_0x2c2bdf(0x195)](/[0-9]{3}/);if(_0xf13265)_0x45a988=_0xf13265[0x0];else _0x45a988='botmanager';const _0x4afe4d=_0xc8a244[_0x2c2bdf(0x156)]['auth'][_0x2c2bdf(0xfa)];if(!_0x4afe4d)_0xc8a244[_0x2c2bdf(0xd8)](_0x2c2bdf(0x137),{'publicKey':secure[_0x2c2bdf(0x218)]});else{_0x37b371=timelyDecrypt(_0x4afe4d,![]);if(!_0x37b371)_0xc8a244[_0x2c2bdf(0xd8)]('status',{'publicKey':secure['publicKey']});else{_0x212661=normalizeIP(_0xc8a244[_0x2c2bdf(0xfc)][_0x2c2bdf(0x23d)])[_0x2c2bdf(0x92)];if(!devices[_0x37b371])devices[_0x37b371]={'uuid':_0x37b371,'access':{'token':null}};devices[_0x37b371]['ip']=_0x212661;const _0x567aeb=addClient(_0xc8a244['id'],_0x37b371,_0x45a988);setAccess(_0x567aeb),emitMessages(),_0xc8a244['on'](_0x2c2bdf(0x1f5),_0xfffde7=>{const _0xae1835=_0x2c2bdf,_0x48b216=timelyDecrypt(_0xfffde7['password']);if(_0x48b216){_0xfffde7={'username':_0xfffde7[_0xae1835(0xcd)],'password':_0x48b216},devices[_0x37b371][_0xae1835(0xa3)]=validateCredentials(_0xfffde7,_0x37b371);if(devices[_0x37b371][_0xae1835(0xa3)][_0xae1835(0x143)]==![]&&devices[_0x37b371]['access']['reason']==_0xae1835(0x186))_0xc8a244['emit']('status',{'access':devices[_0x37b371][_0xae1835(0xa3)]}),loginAccess2FA(_0x37b371,_0x212661);else{if(devices[_0x37b371][_0xae1835(0xa3)][_0xae1835(0x143)]==![]&&devices[_0x37b371]['access']['reason']==_0xae1835(0x119))_0xc8a244['emit'](_0xae1835(0x137),{'access':devices[_0x37b371][_0xae1835(0xa3)]});else devices[_0x37b371][_0xae1835(0xa3)]['allow']&&devices[_0x37b371][_0xae1835(0xa3)][_0xae1835(0x9d)]==_0xae1835(0x222)&&(getClientsWithUuid(_0x37b371)[_0xae1835(0x174)](_0x2a7d4e=>{setAccess(_0x2a7d4e);}),logger[_0xae1835(0x13e)]('Logged\x20in\x20user\x20...'+_0x37b371[_0xae1835(0x1c0)](-0x8)),setTokenRefresh(_0x37b371),setSessionTimeout(_0xae1835(0x1f5),_0x37b371));}}else logger[_0xae1835(0x1b6)](_0xae1835(0x83));}),_0xc8a244['on']('reset-password',()=>{resetPassword();}),_0xc8a244['on'](_0x2c2bdf(0x145),_0x3e5757=>{removeClient(_0xc8a244['id']);}),_0x45a988==_0x2c2bdf(0x1df)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x3d7e12){const _0x3aae55=_0xd8b866;if(_0x3d7e12!=_0x3aae55(0x1df)&&config['apiKey']!=''){if(pid[_0x3d7e12])pid[_0x3d7e12][_0x3aae55(0x200)]({'function':'initclient','args':null});}_0x3d7e12!=_0x3aae55(0x1df)&&broadcastToBots(_0x3aae55(0x133),JSON[_0x3aae55(0x1a6)](config));}function reloadBotManager(){const _0x1286ad=_0xd8b866;getClientsWithBotID(_0x1286ad(0x1df))[_0x1286ad(0x174)](_0x25e0e5=>{const _0xe28faf=_0x1286ad;getSocket(_0x25e0e5['id'])[_0xe28faf(0xd8)](_0xe28faf(0x137),{'access':{'allow':![],'reason':_0xe28faf(0x1ac),'token':null}});});}function getSocket(_0xbd4d10){const _0x47cf79=_0xd8b866;return io['sockets']['sockets'][_0x47cf79(0x225)](_0xbd4d10);}function setAccess(_0xabf8ba){const _0x589de5=_0xd8b866,_0x16ce47=getSocket(_0xabf8ba['id']),_0x5249be=_0xabf8ba[_0x589de5(0x20a)],_0xc9fbd1=_0xabf8ba[_0x589de5(0x17b)];devices[_0x5249be]['access']=validateAccess(devices[_0x5249be]['access']['token'],_0x5249be),logger[_0x589de5(0x13e)](_0x589de5(0x165)+devices[_0x5249be][_0x589de5(0xa3)][_0x589de5(0x9d)]+_0x589de5(0x21e)+_0xabf8ba['id']['slice'](-0x8)+'\x20|\x20user:\x20...'+_0x5249be[_0x589de5(0x1c0)](-0x8)),_0x16ce47[_0x589de5(0x148)](_0x5249be);if(devices[_0x5249be][_0x589de5(0xa3)][_0x589de5(0x143)]){_0x16ce47[_0x589de5(0x148)](_0xc9fbd1);if(_0xc9fbd1==_0x589de5(0x1df))initializeSocketBotManager(_0x16ce47);else initializeSocketBot(_0x16ce47);initClient(_0xc9fbd1);}devices[_0x5249be][_0x589de5(0xa3)][_0x589de5(0x1a1)]&&devices[_0x5249be][_0x589de5(0xa3)][_0x589de5(0x9d)]==_0x589de5(0xa4)&&setSessionTimeout(_0x589de5(0x1d6),_0x5249be),devices[_0x5249be]['access'][_0x589de5(0x1a1)]&&devices[_0x5249be]['access'][_0x589de5(0x9d)]==_0x589de5(0x144)&&setSessionTimeout(_0x589de5(0x1f5),_0x5249be),_0x16ce47['emit']('status',{'status':_0xabf8ba['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5249be][_0x589de5(0xa3)],'externalip':devices[_0x5249be]['ip'],'publicKey':secure[_0x589de5(0x218)],'userid':settings[_0x589de5(0xfe)],'validInstallation':validInstallation}),devices[_0x5249be][_0x589de5(0xa3)][_0x589de5(0x143)]==![]&&devices[_0x5249be][_0x589de5(0xa3)][_0x589de5(0x9d)]==_0x589de5(0x1b0)&&temporaryAccess2FA(_0x5249be,devices[_0x5249be]['ip']);}function setSessionTimeout(_0x423d14,_0x539b8f){const _0x483f9e=_0xd8b866;let _0x4f257e;if(_0x423d14==_0x483f9e(0x1f5))_0x4f257e=loginExpiry*0x3c*0x3e8;else _0x4f257e=devices[_0x539b8f]['telegramIpApproval'][_0x483f9e(0xe9)]*0x3c*0x3e8-(new Date()[_0x483f9e(0x226)]()-devices[_0x539b8f][_0x483f9e(0x232)][_0x483f9e(0x213)]);if(devices[_0x539b8f]['pidExpireLogin'])clearTimeout(devices[_0x539b8f][_0x483f9e(0x1b1)]);devices[_0x539b8f]['pidExpireLogin']=setTimeout(()=>{const _0x2c2019=_0x483f9e;if(devices[_0x539b8f][_0x2c2019(0x1e4)])clearTimeout(devices[_0x539b8f]['pidRefreshToken']);removeSocketListeners(_0x539b8f),addBlacklist(_0x539b8f),devices[_0x539b8f][_0x2c2019(0x232)]=null,devices[_0x539b8f]['telegram2FaApproval']=null,devices[_0x539b8f][_0x2c2019(0xa3)][_0x2c2019(0x1a1)]=null,logger[_0x2c2019(0x13e)](_0x2c2019(0x1e3)+_0x539b8f['slice'](-0x8)),devices[_0x539b8f][_0x2c2019(0xa3)]=validateAccess(devices[_0x539b8f][_0x2c2019(0xa3)][_0x2c2019(0x1a1)],_0x539b8f),!(devices[_0x539b8f][_0x2c2019(0xa3)][_0x2c2019(0x143)]&&devices[_0x539b8f]['access'][_0x2c2019(0x9d)]==_0x2c2019(0x132))&&(_0x423d14==_0x2c2019(0x1f5)?io['to'](_0x539b8f)[_0x2c2019(0xd8)](_0x2c2019(0x137),{'access':{'allow':![],'reason':_0x2c2019(0xf5),'token':null}}):io['to'](_0x539b8f)[_0x2c2019(0xd8)](_0x2c2019(0x137),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x539b8f][_0x2c2019(0xa3)][_0x2c2019(0x1a1)]=null;},_0x4f257e);}function setTokenRefresh(_0x30f625){const _0x15925b=_0xd8b866;if(devices[_0x30f625][_0x15925b(0x1e4)])clearTimeout(devices[_0x30f625]['pidRefreshToken']);devices[_0x30f625][_0x15925b(0x1e4)]=setTimeout(()=>{const _0xe8ad02=_0x15925b;getClientsWithUuid(_0x30f625)['length']!=0x0?(devices[_0x30f625][_0xe8ad02(0xa3)]=refreshToken(_0x30f625),io['to'](_0x30f625)[_0xe8ad02(0xd8)](_0xe8ad02(0x137),{'status':_0xe8ad02(0x1b7),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x30f625][_0xe8ad02(0xa3)],'externalip':devices[_0x30f625]['ip'],'publicKey':secure[_0xe8ad02(0x218)],'validInstallation':validInstallation}),setTokenRefresh(_0x30f625)):clearTimeout(devices[_0x30f625][_0xe8ad02(0x1e4)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x45f1f3){const _0x2fa12c=_0xd8b866,_0x4680af=getClient(_0x45f1f3['id'])[_0x2fa12c(0x20a)];_0x45f1f3[_0x2fa12c(0xd8)](_0x2fa12c(0x133),config),_0x45f1f3[_0x2fa12c(0xd8)](_0x2fa12c(0x89),cleanSettings()),_0x45f1f3['on'](_0x2fa12c(0x25b),_0x40f758=>{const _0x49f39e=_0x2fa12c;if(validateAccess(_0x40f758,_0x4680af)[_0x49f39e(0x143)])addBot();else logger['full'](_0x49f39e(0x1c5));}),_0x45f1f3['on']('update-bot',(_0x2d4cc7,_0x33b1f7)=>{const _0x330926=_0x2fa12c;if(validateAccess(_0x33b1f7,_0x4680af)[_0x330926(0x143)])toggleBot(_0x2d4cc7['botID'],_0x2d4cc7[_0x330926(0x137)],_0x2d4cc7['live']);else logger[_0x330926(0x1b6)](_0x330926(0x231));}),_0x45f1f3['on'](_0x2fa12c(0xa7),(_0x1d35b7,_0x3c1b1f)=>{const _0x20dadf=_0x2fa12c;if(validateAccess(_0x3c1b1f,_0x4680af)[_0x20dadf(0x143)])toggleBotMode(_0x1d35b7);else logger['full'](_0x20dadf(0x231));}),_0x45f1f3['on'](_0x2fa12c(0x1e9),(_0x11f31c,_0x96737b)=>{const _0x46c197=_0x2fa12c;if(validateAccess(_0x96737b,_0x4680af)['allow'])deleteBot(_0x11f31c);else logger[_0x46c197(0x1b6)](_0x46c197(0xdc));}),_0x45f1f3['on'](_0x2fa12c(0x10c),(_0x1a38c9,_0x107e83)=>{const _0x2c9c9e=_0x2fa12c;if(validateAccess(_0x107e83,_0x4680af)[_0x2c9c9e(0x143)])storeSettings(_0x1a38c9,!![]);else logger['full'](_0x2c9c9e(0x140));}),_0x45f1f3['on'](_0x2fa12c(0x167),_0x52a37f=>{const _0x47599a=_0x2fa12c;if(validateAccess(_0x52a37f,_0x4680af)['allow'])updateBB(_0x47599a(0xd0));else logger[_0x47599a(0x1b6)](_0x47599a(0xf8));}),_0x45f1f3['on']('reinstall-bb',_0x3d4f60=>{const _0x40e1c5=_0x2fa12c;if(validateAccess(_0x3d4f60,_0x4680af)[_0x40e1c5(0x143)])updateBB(_0x40e1c5(0x1cf));else logger[_0x40e1c5(0x1b6)](_0x40e1c5(0xfd));}),_0x45f1f3['on'](_0x2fa12c(0xc3),_0xb1581e=>{const _0x5adc88=_0x2fa12c;if(validateAccess(_0xb1581e,_0x4680af)['allow']){const _0x444e7a=getClient(_0x45f1f3['id']);if(_0x444e7a)getBackupFiles(_0x444e7a[_0x5adc88(0x20a)]);else logger[_0x5adc88(0x1b6)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x5adc88(0x1b6)](_0x5adc88(0x95));}),_0x45f1f3['on'](_0x2fa12c(0x1ce),(_0xb1cc19,_0x3be01b)=>{const _0x52cc18=_0x2fa12c;if(validateAccess(_0x3be01b,_0x4680af)['allow'])restoreBackupFile(_0xb1cc19);else logger['full'](_0x52cc18(0x19a));}),_0x45f1f3['on'](_0x2fa12c(0x16d),_0x1cc71c=>{const _0x19a6f0=_0x2fa12c;if(validateAccess(_0x1cc71c,_0x4680af)[_0x19a6f0(0x143)])getMessages();else logger['full'](_0x19a6f0(0x94));}),_0x45f1f3['on'](_0x2fa12c(0x130),(_0x5312ac,_0x1f558a)=>{if(validateAccess(_0x1f558a,_0x4680af)['allow'])confirmMessage(_0x5312ac);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x45f1f3['on'](_0x2fa12c(0x1f7),_0x5d47a7=>{const _0x424989=_0x2fa12c;if(validateAccess(_0x5d47a7,_0x4680af)[_0x424989(0x143)]){if(devices[_0x4680af]['pidRefreshToken'])clearTimeout(devices[_0x4680af][_0x424989(0x1e4)]);if(devices[_0x4680af][_0x424989(0x1b1)])clearTimeout(devices[_0x4680af][_0x424989(0x1b1)]);removeSocketListeners(getClient(_0x45f1f3['id'])['uuid']),addBlacklist(_0x4680af),devices[_0x4680af][_0x424989(0x232)]=null,devices[_0x4680af][_0x424989(0xea)]=null,devices[_0x4680af][_0x424989(0xa3)][_0x424989(0x1a1)]=null,logger[_0x424989(0x13e)]('Logged\x20out\x20user\x20...'+_0x4680af['slice'](-0x8)),io['to'](getClient(_0x45f1f3['id'])[_0x424989(0x20a)])['emit'](_0x424989(0x137),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x424989(0x1b6)](_0x424989(0x17a));});}function initializeSocketBot(_0x513f1c){const _0xbd32a7=_0xd8b866,_0x26b235=getClient(_0x513f1c['id'])['bot'],_0x2f8a88=getClient(_0x513f1c['id'])[_0xbd32a7(0x20a)];_0x513f1c['on'](_0xbd32a7(0x155),(_0x5e3939,_0x2f9ff4)=>{const _0x3860ea=_0xbd32a7;if(validateAccess(_0x2f9ff4,_0x2f8a88)[_0x3860ea(0x143)]){if(pid[_0x26b235])pid[_0x26b235][_0x3860ea(0x200)]({'function':_0x3860ea(0x1b3),'args':_0x5e3939});}else logger[_0x3860ea(0x1b6)](_0x3860ea(0x253));}),_0x513f1c['on']('delete-alerts',(_0x2735c6,_0x39797e)=>{const _0x2ec805=_0xbd32a7;if(validateAccess(_0x39797e,_0x2f8a88)[_0x2ec805(0x143)]){if(pid[_0x26b235])pid[_0x26b235]['send']({'function':'deleteHistoryAlerts','args':_0x2735c6});}else logger[_0x2ec805(0x1b6)](_0x2ec805(0x22e));}),_0x513f1c['on'](_0xbd32a7(0xdb),(_0x19d68d,_0x3bf790)=>{const _0x222d56=_0xbd32a7;if(validateAccess(_0x3bf790,_0x2f8a88)[_0x222d56(0x143)]){if(pid[_0x26b235])pid[_0x26b235][_0x222d56(0x200)]({'function':_0x222d56(0x99),'args':_0x19d68d});}else logger[_0x222d56(0x1b6)](_0x222d56(0x127));}),_0x513f1c['on'](_0xbd32a7(0x255),(_0x5773b0,_0x59be22)=>{const _0x3cb46c=_0xbd32a7;if(validateAccess(_0x59be22,_0x2f8a88)['allow']){if(pid[_0x26b235])pid[_0x26b235]['send']({'function':_0x3cb46c(0x1dd),'args':_0x5773b0});}else logger[_0x3cb46c(0x1b6)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x513f1c['on'](_0xbd32a7(0x21f),(_0x39cd35,_0x34cde0)=>{const _0x9be34=_0xbd32a7;if(validateAccess(_0x34cde0,_0x2f8a88)[_0x9be34(0x143)]){if(pid[_0x26b235])pid[_0x26b235]['send']({'function':'storeHeadless','args':_0x39cd35});}else logger[_0x9be34(0x1b6)](_0x9be34(0xcb));}),_0x513f1c['on'](_0xbd32a7(0x17d),(_0x1cf854,_0x572047)=>{const _0x37f0a2=_0xbd32a7;if(validateAccess(_0x572047,_0x2f8a88)[_0x37f0a2(0x143)]){if(pid[_0x26b235])pid[_0x26b235][_0x37f0a2(0x200)]({'function':'storeFiat','args':_0x1cf854});}else logger[_0x37f0a2(0x1b6)](_0x37f0a2(0x81));}),_0x513f1c['on'](_0xbd32a7(0x187),_0x454311=>{const _0x9a2206=_0xbd32a7;if(validateAccess(_0x454311,_0x2f8a88)[_0x9a2206(0x143)]){if(pid[_0x26b235])pid[_0x26b235][_0x9a2206(0x200)]({'function':'resetHistory','args':null});}else logger['full'](_0x9a2206(0x22d));}),_0x513f1c['on'](_0xbd32a7(0x9a),_0x13bce2=>{const _0x219140=_0xbd32a7;if(validateAccess(_0x13bce2,_0x2f8a88)[_0x219140(0x143)]){if(pid[_0x26b235])pid[_0x26b235][_0x219140(0x200)]({'function':'getStartingBalances','args':null});}else logger['full'](_0x219140(0xee));}),_0x513f1c['on'](_0xbd32a7(0x98),(_0x4635c2,_0x960d5e)=>{const _0x1789b6=_0xbd32a7;if(validateAccess(_0x960d5e,_0x2f8a88)[_0x1789b6(0x143)]){if(pid[_0x26b235])pid[_0x26b235][_0x1789b6(0x200)]({'function':_0x1789b6(0x203),'args':_0x4635c2});}else logger[_0x1789b6(0x1b6)](_0x1789b6(0xd5));}),_0x513f1c['on'](_0xbd32a7(0xf4),_0x4555a5=>{const _0x2b5c06=_0xbd32a7;if(validateAccess(_0x4555a5,_0x2f8a88)[_0x2b5c06(0x143)]){if(pid[_0x26b235])pid[_0x26b235][_0x2b5c06(0x200)]({'function':'cancelLoading','args':null});}else logger[_0x2b5c06(0x1b6)](_0x2b5c06(0x19b));}),_0x513f1c['on']('show-config',_0x33a78a=>{const _0x4bc2a8=_0xbd32a7;if(validateAccess(_0x33a78a,_0x2f8a88)['allow']){if(pid[_0x26b235])pid[_0x26b235][_0x4bc2a8(0x200)]({'function':'showConfig','args':null});}else logger[_0x4bc2a8(0x1b6)](_0x4bc2a8(0x1be));}),_0x513f1c['on'](_0xbd32a7(0x167),_0x4918af=>{const _0x39c0b9=_0xbd32a7;if(validateAccess(_0x4918af,_0x2f8a88)['allow'])updateBB(_0x39c0b9(0xd0));else logger[_0x39c0b9(0x1b6)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x513f1c['on'](_0xbd32a7(0x16d),_0x4af499=>{const _0x5efb82=_0xbd32a7;if(validateAccess(_0x4af499,_0x2f8a88)[_0x5efb82(0x143)])getMessages();else logger[_0x5efb82(0x1b6)](_0x5efb82(0x94));}),_0x513f1c['on'](_0xbd32a7(0x130),(_0xa16248,_0x402db7)=>{const _0x1fb237=_0xbd32a7;if(validateAccess(_0x402db7,_0x2f8a88)[_0x1fb237(0x143)])confirmMessage(_0xa16248);else logger[_0x1fb237(0x1b6)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x513f1c['on']('logout',_0x25d26f=>{const _0x1e4bd6=_0xbd32a7;if(validateAccess(_0x25d26f,_0x2f8a88)['allow']){if(devices[_0x2f8a88]['pidRefreshToken'])clearTimeout(devices[_0x2f8a88]['pidRefreshToken']);if(devices[_0x2f8a88][_0x1e4bd6(0x1b1)])clearTimeout(devices[_0x2f8a88][_0x1e4bd6(0x1b1)]);removeSocketListeners(getClient(_0x513f1c['id'])['uuid']),addBlacklist(_0x2f8a88),devices[_0x2f8a88]['telegramIpApproval']=null,devices[_0x2f8a88]['telegram2FaApproval']=null,devices[_0x2f8a88][_0x1e4bd6(0xa3)][_0x1e4bd6(0x1a1)]=null,logger[_0x1e4bd6(0x13e)](_0x1e4bd6(0x116)+_0x2f8a88[_0x1e4bd6(0x1c0)](-0x8)),io['to'](getClient(_0x513f1c['id'])[_0x1e4bd6(0x20a)])[_0x1e4bd6(0xd8)]('status',{'access':{'allow':![],'reason':_0x1e4bd6(0x170),'token':null}});}else logger[_0x1e4bd6(0x1b6)](_0x1e4bd6(0x17a));});}function removeSocketListeners(_0x53a90f){const _0x2b7ec0=_0xd8b866;getClientsWithUuid(_0x53a90f)[_0x2b7ec0(0x174)](_0x3a1a4b=>{getSocket(_0x3a1a4b['id'])['removeAllListeners']();});}function cleanSettings(){const _0x17dafa=_0xd8b866;let _0x1758a7=settings;return settings['telegramToken']&&settings['telegramToken']!=''&&(_0x1758a7={..._0x1758a7,'telegramToken':_0x17dafa(0x1a7)}),settings[_0x17dafa(0x11a)]&&settings['bbPassword']!=''&&(_0x1758a7={..._0x1758a7,'bbPassword':_0x17dafa(0x1a7)}),(settings[_0x17dafa(0x11a)]&&settings[_0x17dafa(0x11a)]=='***'||settings[_0x17dafa(0x169)]&&settings[_0x17dafa(0x169)]=='***')&&(_0x1758a7={..._0x1758a7,'restored':{'password':settings[_0x17dafa(0x11a)]==_0x17dafa(0x239),'telegram':settings[_0x17dafa(0x169)]==_0x17dafa(0x239)}}),_0x1758a7;}async function updateBB(_0x267422){const _0x2a8e0f=_0xd8b866;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x50070f=>{restartBot(_0x50070f['botID']);});if(_0x267422==_0x2a8e0f(0xd0))process['send']({'update':!![],'environment':environment},_0x328876=>{});else _0x267422==_0x2a8e0f(0x1cf)&&process[_0x2a8e0f(0x200)]({'reinstall':!![],'environment':environment},_0x471c24=>{});}function startBot(_0x5952a0,_0x27e266,_0x4d1388){const _0x139803=_0xd8b866;if(debugging)_0x5952a0[_0x139803(0x162)]('-d');let _0x1bbb5e=![];const _0x4736a2=_0x5952a0[0x0];_0x27e266={..._0x27e266,'stdio':['inherit',_0x139803(0x9e),_0x139803(0x9e),'ipc']},pid[_0x4736a2]=childProcess[_0x139803(0x1c3)](botfile,_0x5952a0,_0x27e266),pid[_0x4736a2]['on'](_0x139803(0x103),_0xcbb5bd=>{const _0x49e798=_0x139803;switch(Object[_0x49e798(0xb7)](_0xcbb5bd)[0x0]){case _0x49e798(0x1f3):updateBotName(_0x4736a2,_0xcbb5bd['botname']);break;case'updatebotmanager':updateBotManager();break;case _0x49e798(0x137):updateStatus(_0x4736a2,_0xcbb5bd['status']);break;case _0x49e798(0x180):updateLive(_0x4736a2,_0xcbb5bd[_0x49e798(0x180)]);break;case _0x49e798(0xbc):updateLive(_0x4736a2,_0xcbb5bd[_0x49e798(0xbc)]),io['to'](_0x4736a2)[_0x49e798(0xd8)]('status',{'access':{'allow':![],'reason':_0x49e798(0x1ac),'token':null}});break;case _0x49e798(0x1e5):_0xcbb5bd[_0x49e798(0x1e5)]=='restart'&&restartBot(_0x4736a2);_0xcbb5bd[_0x49e798(0x1e5)]==_0x49e798(0x1ef)&&toggleBot(_0x4736a2,_0x49e798(0xb3),_0x49e798(0x153));break;case'telegram':sendTelegram(_0x4736a2,_0xcbb5bd['telegram']);break;case _0x49e798(0xbb):sendTelegramMsg(_0xcbb5bd[_0x49e798(0xbb)]);break;case _0x49e798(0x11d):io['to'](_0x4736a2)[_0x49e798(0xd8)](_0xcbb5bd[_0x49e798(0x11d)],_0xcbb5bd['args']);break;}}),pid[_0x4736a2]['on'](_0x139803(0x258),function(_0x31ecbf){if(_0x1bbb5e)return;_0x1bbb5e=!![],_0x4d1388(_0x31ecbf);}),pid[_0x4736a2]['on'](_0x139803(0x8d),async function(_0x517653){const _0x497f04=_0x139803;if(installingUpdate)return;if(_0x1bbb5e)return;_0x1bbb5e=!![],_0x4d1388(null);const _0x2f9186=dbConfig[_0x497f04(0x225)](_0x497f04(0x133))[_0x497f04(0x8f)]({'botID':_0x4736a2})[_0x497f04(0x228)]();_0x2f9186&&(_0x2f9186[_0x497f04(0x137)]==_0x497f04(0x16e)||_0x2f9186[_0x497f04(0x137)]=='new')&&(await sleep(0x3e8),updateLive(_0x4736a2,_0x497f04(0x153)),logger[_0x497f04(0x1b6)]('Restarting\x20Bot\x20'+_0x4736a2),startBot([_0x4736a2,userID],{'cwd':bbpath},function(_0x4aecd2){const _0x3fa440=_0x497f04;if(_0x4aecd2)logger[_0x3fa440(0x1b6)](_0x4aecd2);}));});}function stopBot(_0x1b0c09){const _0x584770=_0xd8b866;getClientsWithBotID(_0x1b0c09)[_0x584770(0x174)](_0x407321=>{const _0x5b0767=_0x584770;getSocket(_0x407321['id'])[_0x5b0767(0x145)](!![]),removeClient(_0x407321['id']);}),pid[_0x1b0c09]&&(pid[_0x1b0c09][_0x584770(0x1ef)](),pid[_0x1b0c09]=null);}function restartBot(_0x5d527d){if(pid[_0x5d527d])pid[_0x5d527d]['kill']();}function addBot(){const _0x583d12=_0xd8b866;let _0x5c49d3;for(let _0x2bbd61=0x1;_0x2bbd61<0x3e9;_0x2bbd61++){_0x5c49d3=_0x2bbd61['toString']()['padStart'](0x3,'0');let _0x4aa9e8=config[_0x583d12(0x8f)](_0x16f17a=>_0x16f17a[_0x583d12(0x176)]==_0x5c49d3);if(!_0x4aa9e8)break;}if(_0x5c49d3===_0x583d12(0x149)){logger['full'](_0x583d12(0x236));return;}logger['full'](_0x583d12(0x8b)+_0x5c49d3),dbConfig[_0x583d12(0x225)]('bots')[_0x583d12(0x162)]({'botID':_0x5c49d3,'botname':_0x583d12(0x126)+_0x5c49d3,'status':_0x583d12(0x10b),'live':''})['write'](),startBot([_0x5c49d3,userID],{'cwd':bbpath},function(_0x233044){const _0x49d34a=_0x583d12;if(_0x233044)logger[_0x49d34a(0x1b6)](_0x233044);}),config=getConfiguration(),io['to'](_0x583d12(0x1df))[_0x583d12(0xd8)](_0x583d12(0x133),config),broadcastToBots('bots',JSON['stringify'](config));}function deleteBot(_0x5b788d){const _0x397933=_0xd8b866;getClientsWithBotID(_0x5b788d)[_0x397933(0x174)](_0x10f525=>{const _0x1222b3=_0x397933;getSocket(_0x10f525['id'])[_0x1222b3(0x145)](!![]),removeClient(_0x10f525['id']);}),dbConfig[_0x397933(0x225)](_0x397933(0x133))['remove']({'botID':_0x5b788d})[_0x397933(0x223)](),logger[_0x397933(0x1b6)](_0x397933(0xca)+_0x5b788d),stopBot(_0x5b788d);try{if(fs[_0x397933(0x161)](path[_0x397933(0x148)](configpath,_0x397933(0x22f)+_0x5b788d+'-config.json')))fs[_0x397933(0x220)](path['join'](configpath,_0x397933(0x22f)+_0x5b788d+_0x397933(0xc9)));if(fs['existsSync'](path[_0x397933(0x148)](configpath,'bot-'+_0x5b788d+_0x397933(0x129))))fs[_0x397933(0x220)](path['join'](configpath,_0x397933(0x22f)+_0x5b788d+_0x397933(0x129)));if(fs[_0x397933(0x161)](path[_0x397933(0x148)](configpath,_0x397933(0x22f)+_0x5b788d+_0x397933(0x1e2))))fs[_0x397933(0x220)](path[_0x397933(0x148)](configpath,'bot-'+_0x5b788d+_0x397933(0x1e2)));if(fs['existsSync'](path[_0x397933(0x148)](configpath,'bot-'+_0x5b788d+_0x397933(0x16b))))fs[_0x397933(0x220)](path[_0x397933(0x148)](configpath,_0x397933(0x22f)+_0x5b788d+_0x397933(0x16b)));}catch(_0x492d87){if(_0x492d87)logger[_0x397933(0x1b6)](_0x397933(0x14a),_0x492d87);}config=getConfiguration(),io['to']('botmanager')[_0x397933(0xd8)](_0x397933(0x133),config),broadcastToBots(_0x397933(0x133),JSON['stringify'](config));}function toggleBot(_0x34cfc3,_0x1a12f9,_0x554211){const _0x5e3c93=_0xd8b866;dbConfig['get'](_0x5e3c93(0x133))['find']({'botID':_0x34cfc3})[_0x5e3c93(0x10a)]({'status':_0x1a12f9})['assign']({'live':_0x554211})[_0x5e3c93(0x223)]();if(_0x1a12f9=='enabled'||_0x1a12f9==_0x5e3c93(0x10b))logger[_0x5e3c93(0x1b6)](_0x5e3c93(0x19c)+_0x34cfc3),startBot([_0x34cfc3,userID],{'cwd':bbpath},function(_0x3f8e39){const _0x480532=_0x5e3c93;if(_0x3f8e39)logger[_0x480532(0x1b6)](_0x3f8e39);});else(_0x1a12f9==_0x5e3c93(0xb3)||_0x1a12f9==_0x5e3c93(0x243))&&(logger[_0x5e3c93(0x1b6)](_0x5e3c93(0xe5)+_0x34cfc3),stopBot(_0x34cfc3));config=getConfiguration(),io['to'](_0x5e3c93(0x1df))[_0x5e3c93(0xd8)](_0x5e3c93(0x133),config),broadcastToBots(_0x5e3c93(0x133),JSON['stringify'](config));}function toggleStatus(_0xddc180){const _0x366906=_0xd8b866;let _0x541b3a=dbConfig[_0x366906(0x225)](_0x366906(0x133))[_0x366906(0x8f)]({'botID':_0xddc180})[_0x366906(0x228)](),_0x2bbc4c;if(_0x541b3a[_0x366906(0x137)]==='enabled')_0x2bbc4c=_0x366906(0xb3);else{if(_0x541b3a[_0x366906(0x137)]===_0x366906(0x10b))_0x2bbc4c='new-disabled';else{if(_0x541b3a['status']===_0x366906(0x243))_0x2bbc4c=_0x366906(0x10b);else{if(_0x541b3a[_0x366906(0x137)]===_0x366906(0xb3))_0x2bbc4c=_0x366906(0x16e);}}}return _0x2bbc4c;}function updateStatus(_0x5b5b2a,_0x5deec6){const _0xc12a73=_0xd8b866;dbConfig[_0xc12a73(0x225)](_0xc12a73(0x133))['find']({'botID':_0x5b5b2a})[_0xc12a73(0x10a)]({'status':_0x5deec6})['write'](),config=getConfiguration(),io['to'](_0xc12a73(0x1df))['emit'](_0xc12a73(0x133),config),broadcastToBots(_0xc12a73(0x133),JSON['stringify'](config));}function updateLive(_0x138bda,_0xe9aad){const _0x5d3612=_0xd8b866;dbConfig['get'](_0x5d3612(0x133))[_0x5d3612(0x8f)]({'botID':_0x138bda})['assign']({'live':_0xe9aad})[_0x5d3612(0x223)](),config=getConfiguration(),io['to'](_0x5d3612(0x1df))[_0x5d3612(0xd8)]('bots',config),broadcastToBots(_0x5d3612(0x133),JSON['stringify'](config));}function updateBotName(_0x1b8f5f,_0x2348dc){const _0x5bb4ab=_0xd8b866;dbConfig[_0x5bb4ab(0x225)](_0x5bb4ab(0x133))[_0x5bb4ab(0x8f)]({'botID':_0x1b8f5f})[_0x5bb4ab(0x10a)]({'botname':_0x2348dc})[_0x5bb4ab(0x223)](),config=getConfiguration(),io['to'](_0x5bb4ab(0x1df))[_0x5bb4ab(0xd8)](_0x5bb4ab(0x133),config),broadcastToBots(_0x5bb4ab(0x133),JSON['stringify'](config));}function updateBotManager(){const _0x2a854d=_0xd8b866;config=getConfiguration(),io['to']('botmanager')[_0x2a854d(0xd8)](_0x2a854d(0x133),config),broadcastToBots(_0x2a854d(0x133),JSON[_0x2a854d(0x1a6)](config));}function toggleBotMode(_0x168e93){const _0x237b59=_0xd8b866;if(pid[_0x168e93])pid[_0x168e93][_0x237b59(0x200)]({'function':_0x237b59(0xaf),'args':null});else{const _0x284d48=configpath+_0x237b59(0x22f)+_0x168e93+'-config.json',_0x5a7fec=fs[_0x237b59(0xce)](_0x284d48),_0x5262b0=JSON['parse'](_0x5a7fec),_0x31e7ca=_0x5262b0[_0x237b59(0x17b)][0x0][_0x237b59(0x171)];_0x5262b0[_0x237b59(0x17b)][0x0][_0x237b59(0x171)]=!_0x31e7ca;const _0x2de0c3=JSON['stringify'](_0x5262b0,null,0x2);fs[_0x237b59(0x1f8)](_0x284d48,_0x2de0c3),config=getConfiguration(),io['to']('botmanager')[_0x237b59(0xd8)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}}function telegramError(_0x39d124){const _0x1dc0c3=_0xd8b866;logger['simple'](getTimeStamp()+_0x1dc0c3(0x122));}function validateTelegram(_0x560462){const _0x2643bc=_0xd8b866;if(_0x560462[_0x2643bc(0xe8)][_0x2643bc(0xcd)]!=settings[_0x2643bc(0x13d)]&&'@'+_0x560462[_0x2643bc(0xe8)][_0x2643bc(0xcd)]!=settings[_0x2643bc(0x13d)])return tgBot['sendMessage'](_0x560462[_0x2643bc(0x147)]['id'],_0x2643bc(0x12a),{'parse_mode':'HTML'})[_0x2643bc(0x248)](_0x125791=>{telegramError(_0x125791);}),![];return!![];}async function initTelegram(){const _0x2f04cd=_0xd8b866;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x2f04cd(0x169)],{'polling':!![]});let _0x1d90f5=_0x2f04cd(0x96);_0x1d90f5+='\x0a',_0x1d90f5+=_0x2f04cd(0x151),_0x1d90f5+=_0x2f04cd(0x158),_0x1d90f5+=_0x2f04cd(0xf0),_0x1d90f5+=_0x2f04cd(0xad),_0x1d90f5+=_0x2f04cd(0x1bb),_0x1d90f5+=_0x2f04cd(0xab),_0x1d90f5+=_0x2f04cd(0x240),_0x1d90f5+=_0x2f04cd(0x20b),_0x1d90f5+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x1d90f5+=_0x2f04cd(0x227),_0x1d90f5+=_0x2f04cd(0x85),_0x1d90f5+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x1d90f5+=_0x2f04cd(0x112),_0x1d90f5+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x232460=_0x2f04cd(0x18e);_0x232460+='\x0a',_0x232460+=_0x1d90f5,tgBot[_0x2f04cd(0xc0)](/\/start/,_0x146ee4=>{const _0x237fe1=_0x2f04cd;if(!validateTelegram(_0x146ee4))return;if(settings[_0x237fe1(0x20f)]!=_0x146ee4[_0x237fe1(0x147)]['id'])updateSetting('telegramChatId',_0x146ee4[_0x237fe1(0x147)]['id']);updateSetting(_0x237fe1(0xc1),!![]),tgBot[_0x237fe1(0x212)](_0x146ee4[_0x237fe1(0x147)]['id'],_0x232460)[_0x237fe1(0x248)](_0x1ab34b=>{telegramError(_0x1ab34b);});}),tgBot[_0x2f04cd(0xc0)](/\/enable/,_0x4673fe=>{const _0x59c9bf=_0x2f04cd;if(!validateTelegram(_0x4673fe))return;if(settings['telegramChatId']!=_0x4673fe['chat']['id'])updateSetting('telegramChatId',_0x4673fe[_0x59c9bf(0x147)]['id']);updateSetting(_0x59c9bf(0xc1),!![]),tgBot[_0x59c9bf(0x212)](_0x4673fe[_0x59c9bf(0x147)]['id'],_0x59c9bf(0x1e8))[_0x59c9bf(0x248)](_0x4775dd=>{telegramError(_0x4775dd);});}),tgBot[_0x2f04cd(0xc0)](/\/config/,async _0x3fd9cd=>{const _0x108400=_0x2f04cd;if(!validateTelegram(_0x3fd9cd))return;tgBot[_0x108400(0x13c)](_0x108400(0x117)),tgBot[_0x108400(0x212)](_0x3fd9cd['chat']['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x108400(0x233)},{'text':_0x108400(0x1ae),'callback_data':'alerts'},{'text':_0x108400(0x22b),'callback_data':_0x108400(0x1c1)}]]}})['catch'](_0x518931=>{telegramError(_0x518931);}),tgBot['on'](_0x108400(0x117),async _0x2d4e3a=>{const _0x325360=_0x108400,_0x445ea7=_0x2d4e3a[_0x325360(0x1a8)],_0x860112=_0x2d4e3a[_0x325360(0x103)];tgBot[_0x325360(0x10f)](_0x2d4e3a['id'])['then'](async()=>{const _0xa3245=_0x325360;_0x445ea7==_0xa3245(0x233)&&(updateSetting(_0xa3245(0x219),'orders'),updateSetting(_0xa3245(0xc1),!![]),await tgBot[_0xa3245(0x212)](_0x860112[_0xa3245(0x147)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')[_0xa3245(0x248)](_0x142501=>{telegramError(_0x142501);}));_0x445ea7==_0xa3245(0x166)&&(updateSetting(_0xa3245(0x219),'alerts'),updateSetting(_0xa3245(0xc1),!![]),await tgBot[_0xa3245(0x212)](_0x860112['chat']['id'],_0xa3245(0x1ee))[_0xa3245(0x248)](_0x219206=>{telegramError(_0x219206);}));_0x445ea7==_0xa3245(0x1c1)&&(updateSetting(_0xa3245(0x219),'all'),updateSetting(_0xa3245(0xc1),!![]),await tgBot[_0xa3245(0x212)](_0x860112[_0xa3245(0x147)]['id'],_0xa3245(0x110))['catch'](_0x50b254=>{telegramError(_0x50b254);}));if(!settings[_0xa3245(0x20f)])tgBot[_0xa3245(0x212)](_0x860112[_0xa3245(0x147)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0xa3245(0x248)](_0x1a80e8=>{telegramError(_0x1a80e8);});}),tgBot[_0x325360(0x13c)]('callback_query');});}),tgBot[_0x2f04cd(0xc0)](/\/status/,_0x5f5838=>{const _0x43ff59=_0x2f04cd;if(!validateTelegram(_0x5f5838))return;const _0x4a8bb1=getBotsWithMode();let _0x1098cf=_0x43ff59(0x201);config[_0x43ff59(0x174)](_0x54c028=>{const _0x2f6928=_0x43ff59,_0x53a334=_0x4a8bb1[_0x2f6928(0x8f)](_0x278519=>_0x278519[_0x2f6928(0x176)]==_0x54c028[_0x2f6928(0x176)])[_0x2f6928(0x1d3)];_0x1098cf+=_0x2f6928(0x126)+_0x54c028[_0x2f6928(0x176)]+':\x20'+_0x54c028[_0x2f6928(0x137)]+'\x20|\x20'+_0x53a334+_0x2f6928(0x164)+_0x54c028['live']+'\x0a';}),_0x1098cf+='\x0a',_0x1098cf+=_0x43ff59(0x1d2),_0x1098cf+=!settings[_0x43ff59(0xc1)]?_0x43ff59(0x257):_0x43ff59(0x197),_0x1098cf+=settings[_0x43ff59(0xc1)]?settings['telegramEvents']=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x43ff59(0x23c)+settings['telegramEvents']+'\x20only\x0a':'',tgBot[_0x43ff59(0x212)](_0x5f5838[_0x43ff59(0x147)]['id'],_0x1098cf,{'parse_mode':_0x43ff59(0x12c)})[_0x43ff59(0x248)](_0x32ff93=>{telegramError(_0x32ff93);});}),tgBot[_0x2f04cd(0xc0)](/\/restart/,_0x3f56bf=>{const _0x5ea901=_0x2f04cd;if(!validateTelegram(_0x3f56bf))return;tgBot['removeListener'](_0x5ea901(0x117));const _0x317a4d=getEnabledBots();if(_0x317a4d[_0x5ea901(0x1d8)]==0x0)tgBot[_0x5ea901(0x212)](_0x3f56bf[_0x5ea901(0x147)]['id'],_0x5ea901(0x206))[_0x5ea901(0x248)](_0x329949=>{telegramError(_0x329949);});else{if(_0x317a4d[_0x5ea901(0x1d8)]>0x1)_0x317a4d[_0x5ea901(0x162)]({'botID':'all'});let _0x2e2501=[],_0x51d030=[];const _0x8ea76c=_0x317a4d[_0x5ea901(0x1d8)]%0x4==0x0||_0x317a4d[_0x5ea901(0x1d8)]%0x4==0x3||_0x317a4d[_0x5ea901(0x1d8)]%0x3==0x1?0x4:0x3;let _0x1a0242=0x0;_0x317a4d[_0x5ea901(0x174)]((_0x4c015c,_0x57cce1)=>{const _0x47de62=_0x5ea901;if(_0x57cce1%_0x8ea76c==0x0)_0x51d030=[];_0x51d030[_0x47de62(0x162)]({'text':_0x4c015c['botID']==_0x47de62(0x1c1)?_0x47de62(0x8c):'Bot\x20'+_0x4c015c[_0x47de62(0x176)],'callback_data':_0x4c015c['botID']}),_0x57cce1%_0x8ea76c==0x0&&(_0x2e2501[_0x1a0242]=_0x51d030,_0x1a0242++);}),tgBot[_0x5ea901(0x212)](_0x3f56bf[_0x5ea901(0x147)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x2e2501}})[_0x5ea901(0x248)](_0x2dfd9a=>{telegramError(_0x2dfd9a);}),tgBot['on'](_0x5ea901(0x117),async _0x47be25=>{const _0x508392=_0x5ea901,_0x326182=_0x47be25[_0x508392(0x1a8)],_0xf7de53=_0x47be25[_0x508392(0x103)];tgBot[_0x508392(0x10f)](_0x47be25['id'])[_0x508392(0x20d)](async()=>{const _0x5ac668=_0x508392;_0x326182==_0x5ac668(0x1c1)?config['forEach'](_0xf2123=>{const _0xe068cc=_0x5ac668;restartBot(_0xf2123[_0xe068cc(0x176)]);}):restartBot(_0x326182);}),tgBot[_0x508392(0x13c)](_0x508392(0x117));});}}),tgBot['onText'](/\/on/,_0x25d1a0=>{const _0x17cadc=_0x2f04cd;if(!validateTelegram(_0x25d1a0))return;tgBot[_0x17cadc(0x13c)](_0x17cadc(0x117));const _0x44c7af=getDisabledBots();if(_0x44c7af[_0x17cadc(0x1d8)]==0x0)tgBot['sendMessage'](_0x25d1a0[_0x17cadc(0x147)]['id'],_0x17cadc(0x14e))[_0x17cadc(0x248)](_0x4c3b4e=>{telegramError(_0x4c3b4e);});else{if(_0x44c7af['length']>0x1)_0x44c7af[_0x17cadc(0x162)]({'botID':_0x17cadc(0x1c1)});let _0x2f594f=[],_0x146a4b=[];const _0x55f2d7=_0x44c7af['length']%0x4==0x0||_0x44c7af[_0x17cadc(0x1d8)]%0x4==0x3||_0x44c7af['length']%0x3==0x1?0x4:0x3;let _0x1605da=0x0;_0x44c7af[_0x17cadc(0x174)]((_0x3fb56d,_0x3ecfe1)=>{const _0x4a3bca=_0x17cadc;if(_0x3ecfe1%_0x55f2d7==0x0)_0x146a4b=[];_0x146a4b[_0x4a3bca(0x162)]({'text':_0x3fb56d['botID']==_0x4a3bca(0x1c1)?_0x4a3bca(0x8c):_0x4a3bca(0x126)+_0x3fb56d['botID'],'callback_data':_0x3fb56d[_0x4a3bca(0x176)]}),_0x3ecfe1%_0x55f2d7==0x0&&(_0x2f594f[_0x1605da]=_0x146a4b,_0x1605da++);}),tgBot['sendMessage'](_0x25d1a0[_0x17cadc(0x147)]['id'],_0x17cadc(0x146),{'reply_markup':{'inline_keyboard':_0x2f594f}})[_0x17cadc(0x248)](_0x2ade31=>{telegramError(_0x2ade31);}),tgBot['on'](_0x17cadc(0x117),async _0x4446bf=>{const _0x1cb845=_0x17cadc,_0x297637=_0x4446bf[_0x1cb845(0x1a8)],_0xda8507=_0x4446bf[_0x1cb845(0x103)];tgBot[_0x1cb845(0x10f)](_0x4446bf['id'])[_0x1cb845(0x20d)](async()=>{const _0x9a13e5=_0x1cb845;_0x297637==_0x9a13e5(0x1c1)?(tgBot[_0x9a13e5(0x212)](_0xda8507[_0x9a13e5(0x147)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x9a13e5(0x248)](_0x2f6ecf=>{telegramError(_0x2f6ecf);}),_0x44c7af[_0x9a13e5(0x174)](_0x42fd4c=>{const _0x31925c=_0x9a13e5;if(_0x42fd4c[_0x31925c(0x176)]!=_0x31925c(0x1c1))toggleBot(_0x42fd4c[_0x31925c(0x176)],toggleStatus(_0x42fd4c[_0x31925c(0x176)]),_0x31925c(0x153));})):(tgBot[_0x9a13e5(0x212)](_0xda8507[_0x9a13e5(0x147)]['id'],_0x9a13e5(0x14c)+_0x297637)[_0x9a13e5(0x248)](_0x1c9108=>{telegramError(_0x1c9108);}),toggleBot(_0x297637,toggleStatus(_0x297637),'stopped'));}),tgBot[_0x1cb845(0x13c)](_0x1cb845(0x117));});}}),tgBot[_0x2f04cd(0xc0)](/\/off/,_0x2448fa=>{const _0xe4f2bf=_0x2f04cd;if(!validateTelegram(_0x2448fa))return;tgBot[_0xe4f2bf(0x13c)](_0xe4f2bf(0x117));const _0xff213e=getEnabledBots();if(_0xff213e[_0xe4f2bf(0x1d8)]==0x0)tgBot['sendMessage'](_0x2448fa[_0xe4f2bf(0x147)]['id'],_0xe4f2bf(0x206))['catch'](_0x32f525=>{telegramError(_0x32f525);});else{if(_0xff213e[_0xe4f2bf(0x1d8)]>0x1)_0xff213e[_0xe4f2bf(0x162)]({'botID':_0xe4f2bf(0x1c1)});let _0x1da507=[],_0x4191e6=[];const _0x32a80c=_0xff213e[_0xe4f2bf(0x1d8)]%0x4==0x0||_0xff213e[_0xe4f2bf(0x1d8)]%0x4==0x3||_0xff213e[_0xe4f2bf(0x1d8)]%0x3==0x1?0x4:0x3;let _0x2b8e5b=0x0;_0xff213e[_0xe4f2bf(0x174)]((_0x5e1ec2,_0x30db56)=>{const _0x1285d1=_0xe4f2bf;if(_0x30db56%_0x32a80c==0x0)_0x4191e6=[];_0x4191e6['push']({'text':_0x5e1ec2['botID']==_0x1285d1(0x1c1)?_0x1285d1(0x8c):'Bot\x20'+_0x5e1ec2['botID'],'callback_data':_0x5e1ec2['botID']}),_0x30db56%_0x32a80c==0x0&&(_0x1da507[_0x2b8e5b]=_0x4191e6,_0x2b8e5b++);}),tgBot[_0xe4f2bf(0x212)](_0x2448fa['chat']['id'],_0xe4f2bf(0x235),{'reply_markup':{'inline_keyboard':_0x1da507}})['catch'](_0x4c67f0=>{telegramError(_0x4c67f0);}),tgBot['on'](_0xe4f2bf(0x117),async _0x35ca7e=>{const _0x30ba79=_0xe4f2bf,_0x2baad8=_0x35ca7e[_0x30ba79(0x1a8)],_0xbfd201=_0x35ca7e['message'];tgBot[_0x30ba79(0x10f)](_0x35ca7e['id'])['then'](async()=>{const _0x2aa910=_0x30ba79;_0x2baad8==_0x2aa910(0x1c1)?(tgBot[_0x2aa910(0x212)](_0xbfd201[_0x2aa910(0x147)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x2aa910(0x248)](_0x5bf797=>{telegramError(_0x5bf797);}),_0xff213e[_0x2aa910(0x174)](_0x5ab4c9=>{const _0x2cd586=_0x2aa910;if(_0x5ab4c9[_0x2cd586(0x176)]!='all')toggleBot(_0x5ab4c9[_0x2cd586(0x176)],toggleStatus(_0x5ab4c9[_0x2cd586(0x176)]),_0x2cd586(0x153));})):(tgBot[_0x2aa910(0x212)](_0xbfd201[_0x2aa910(0x147)]['id'],_0x2aa910(0x241)+_0x2baad8)[_0x2aa910(0x248)](_0x55ab0e=>{telegramError(_0x55ab0e);}),toggleBot(_0x2baad8,toggleStatus(_0x2baad8),_0x2aa910(0x153)));}),tgBot[_0x30ba79(0x13c)]('callback_query');});}}),tgBot[_0x2f04cd(0xc0)](/\/metrics/,_0x17780f=>{const _0x39feff=_0x2f04cd;if(!validateTelegram(_0x17780f))return;tgBot['removeListener'](_0x39feff(0x117));const _0x3dfc60=getEnabledBots();if(_0x3dfc60[_0x39feff(0x1d8)]==0x0)tgBot[_0x39feff(0x212)](_0x17780f['chat']['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x4e3363=>{telegramError(_0x4e3363);});else{if(_0x3dfc60['length']>0x1){let _0x5e80a9=[],_0x5a999d=[];const _0xca0533=_0x3dfc60[_0x39feff(0x1d8)]%0x4==0x0||_0x3dfc60['length']%0x4==0x3||_0x3dfc60[_0x39feff(0x1d8)]%0x3==0x1?0x4:0x3;let _0x10e4d8=0x0;_0x3dfc60[_0x39feff(0x174)]((_0x22e74c,_0x51be13)=>{const _0x3d012=_0x39feff;if(_0x51be13%_0xca0533==0x0)_0x5a999d=[];_0x5a999d[_0x3d012(0x162)]({'text':'Bot\x20'+_0x22e74c[_0x3d012(0x176)],'callback_data':_0x22e74c[_0x3d012(0x176)]}),_0x51be13%_0xca0533==0x0&&(_0x5e80a9[_0x10e4d8]=_0x5a999d,_0x10e4d8++);}),tgBot[_0x39feff(0x212)](_0x17780f[_0x39feff(0x147)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x5e80a9}})[_0x39feff(0x248)](_0x57605e=>{telegramError(_0x57605e);}),tgBot['on'](_0x39feff(0x117),async _0x22b6d5=>{const _0x3abfa0=_0x39feff,_0x2c2b3e=_0x22b6d5[_0x3abfa0(0x1a8)],_0x4b529a=_0x22b6d5[_0x3abfa0(0x103)];tgBot[_0x3abfa0(0x10f)](_0x22b6d5['id'])['then'](async()=>{const _0x292176=_0x3abfa0;if(pid[_0x2c2b3e])pid[_0x2c2b3e][_0x292176(0x200)]({'function':_0x292176(0x1c9),'args':null});}),tgBot['removeListener']('callback_query');});}else{const _0x2eb88e=_0x3dfc60[0x0][_0x39feff(0x176)];if(pid[_0x2eb88e])pid[_0x2eb88e][_0x39feff(0x200)]({'function':_0x39feff(0x1c9),'args':null});}}}),tgBot[_0x2f04cd(0xc0)](/\/portfolio/,_0x1d8c1d=>{const _0x4f1fae=_0x2f04cd;if(!validateTelegram(_0x1d8c1d))return;tgBot[_0x4f1fae(0x13c)]('callback_query');const _0x282681=getEnabledBots();if(_0x282681[_0x4f1fae(0x1d8)]==0x0)tgBot[_0x4f1fae(0x212)](_0x1d8c1d['chat']['id'],_0x4f1fae(0x206))[_0x4f1fae(0x248)](_0x4f5bc6=>{telegramError(_0x4f5bc6);});else{if(_0x282681[_0x4f1fae(0x1d8)]>0x1){let _0x341cc9=[],_0x4c21af=[];const _0x3a0657=_0x282681['length']%0x4==0x0||_0x282681[_0x4f1fae(0x1d8)]%0x4==0x3||_0x282681[_0x4f1fae(0x1d8)]%0x3==0x1?0x4:0x3;let _0x37679d=0x0;_0x282681[_0x4f1fae(0x174)]((_0x303b22,_0x8cb136)=>{const _0x4369cd=_0x4f1fae;if(_0x8cb136%_0x3a0657==0x0)_0x4c21af=[];_0x4c21af[_0x4369cd(0x162)]({'text':_0x4369cd(0x126)+_0x303b22[_0x4369cd(0x176)],'callback_data':_0x303b22['botID']}),_0x8cb136%_0x3a0657==0x0&&(_0x341cc9[_0x37679d]=_0x4c21af,_0x37679d++);}),tgBot[_0x4f1fae(0x212)](_0x1d8c1d[_0x4f1fae(0x147)]['id'],_0x4f1fae(0x19e),{'reply_markup':{'inline_keyboard':_0x341cc9}})['catch'](_0xeeb3e0=>{telegramError(_0xeeb3e0);}),tgBot['on'](_0x4f1fae(0x117),async _0x3f8cbb=>{const _0x4d602f=_0x4f1fae,_0x123f78=_0x3f8cbb[_0x4d602f(0x1a8)],_0x4b65c1=_0x3f8cbb['message'];tgBot[_0x4d602f(0x10f)](_0x3f8cbb['id'])[_0x4d602f(0x20d)](async()=>{const _0x1b6081=_0x4d602f;if(pid[_0x123f78])pid[_0x123f78]['send']({'function':_0x1b6081(0xe3),'args':null});}),tgBot[_0x4d602f(0x13c)](_0x4d602f(0x117));});}else{const _0x59e38a=_0x282681[0x0][_0x4f1fae(0x176)];if(pid[_0x59e38a])pid[_0x59e38a][_0x4f1fae(0x200)]({'function':_0x4f1fae(0xe3),'args':null});}}}),tgBot[_0x2f04cd(0xc0)](/\/update/,async _0x47fd3b=>{const _0x55f505=_0x2f04cd;if(!validateTelegram(_0x47fd3b))return;tgBot[_0x55f505(0x13c)](_0x55f505(0x117)),await getMessages();if(!updateAvailable)tgBot['sendMessage'](_0x47fd3b['chat']['id'],_0x55f505(0x1f1))[_0x55f505(0x248)](_0xa9f91f=>{telegramError(_0xa9f91f);});else!validInstallation?tgBot[_0x55f505(0x212)](_0x47fd3b['chat']['id'],_0x55f505(0x15f))[_0x55f505(0x248)](_0x2fc099=>{telegramError(_0x2fc099);}):(tgBot[_0x55f505(0x212)](_0x47fd3b[_0x55f505(0x147)]['id'],_0x55f505(0x1e0),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x55f505(0x125)},{'text':'No','callback_data':'no'}]]}})[_0x55f505(0x248)](_0x27e5e0=>{telegramError(_0x27e5e0);}),tgBot['on'](_0x55f505(0x117),async _0x5756b9=>{const _0x2574c1=_0x55f505,_0x3b25c8=_0x5756b9[_0x2574c1(0x1a8)],_0xbe1817=_0x5756b9[_0x2574c1(0x103)];tgBot[_0x2574c1(0x10f)](_0x5756b9['id'])[_0x2574c1(0x20d)](async()=>{const _0x48122d=_0x2574c1;_0x3b25c8=='yes'&&(await tgBot[_0x48122d(0x212)](_0xbe1817[_0x48122d(0x147)]['id'],_0x48122d(0x1b8))[_0x48122d(0x248)](_0x59e9c3=>{telegramError(_0x59e9c3);}),updateBB(_0x48122d(0xd0))),_0x3b25c8=='no'&&await tgBot['sendMessage'](_0xbe1817['chat']['id'],_0x48122d(0x109))[_0x48122d(0x248)](_0x5b05dd=>{telegramError(_0x5b05dd);});}),tgBot[_0x2574c1(0x13c)]('callback_query');}));}),tgBot['onText'](/\/reinstall/,async _0x277357=>{const _0xc4257c=_0x2f04cd;if(!validateTelegram(_0x277357))return;tgBot['removeListener'](_0xc4257c(0x117)),!validInstallation?tgBot[_0xc4257c(0x212)](_0x277357[_0xc4257c(0x147)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')['catch'](_0x1fa4b8=>{telegramError(_0x1fa4b8);}):(tgBot[_0xc4257c(0x212)](_0x277357[_0xc4257c(0x147)]['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0xc4257c(0xd7),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0xc4257c(0x248)](_0x4a76b2=>{telegramError(_0x4a76b2);}),tgBot['on'](_0xc4257c(0x117),async _0x5a85fb=>{const _0x5787da=_0xc4257c,_0x8618bd=_0x5a85fb['data'],_0x15ce5d=_0x5a85fb[_0x5787da(0x103)];tgBot['answerCallbackQuery'](_0x5a85fb['id'])[_0x5787da(0x20d)](async()=>{const _0x19b144=_0x5787da;_0x8618bd==_0x19b144(0x125)&&(await tgBot['sendMessage'](_0x15ce5d[_0x19b144(0x147)]['id'],_0x19b144(0xcc))[_0x19b144(0x248)](_0x20c4d3=>{telegramError(_0x20c4d3);}),updateBB(_0x19b144(0x1cf))),_0x8618bd=='no'&&await tgBot[_0x19b144(0x212)](_0x15ce5d[_0x19b144(0x147)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')[_0x19b144(0x248)](_0x1f457e=>{telegramError(_0x1f457e);});}),tgBot[_0x5787da(0x13c)](_0x5787da(0x117));}));}),tgBot[_0x2f04cd(0xc0)](/\/toggle/,_0x5c0274=>{const _0x566a0c=_0x2f04cd;if(!validateTelegram(_0x5c0274))return;tgBot[_0x566a0c(0x13c)]('callback_query');const _0x433774=getBotsWithMode();if(_0x433774[_0x566a0c(0x1d8)]==0x0)tgBot[_0x566a0c(0x212)](_0x5c0274[_0x566a0c(0x147)]['id'],_0x566a0c(0x206))['catch'](_0x39e40d=>{telegramError(_0x39e40d);});else{let _0x582502=[],_0xa066e5=[];const _0x4dba38=0x2;let _0x2b8fe9=0x0;_0x433774['forEach']((_0x5377cf,_0x2f0f41)=>{const _0x6aab81=_0x566a0c;if(_0x2f0f41%_0x4dba38==0x0)_0xa066e5=[];_0xa066e5[_0x6aab81(0x162)]({'text':'Bot\x20'+_0x5377cf[_0x6aab81(0x176)]+'\x20('+_0x5377cf[_0x6aab81(0x1d3)]+')','callback_data':_0x5377cf['botID']}),_0x2f0f41%_0x4dba38==0x0&&(_0x582502[_0x2b8fe9]=_0xa066e5,_0x2b8fe9++);}),tgBot[_0x566a0c(0x212)](_0x5c0274[_0x566a0c(0x147)]['id'],_0x566a0c(0x123),{'reply_markup':{'inline_keyboard':_0x582502}})['catch'](_0x11991e=>{telegramError(_0x11991e);}),tgBot['on'](_0x566a0c(0x117),async _0x11944f=>{const _0x9a5cff=_0x566a0c,_0x5c5aec=_0x11944f[_0x9a5cff(0x1a8)],_0xdce44d=_0x11944f[_0x9a5cff(0x103)];tgBot[_0x9a5cff(0x10f)](_0x11944f['id'])[_0x9a5cff(0x20d)](async()=>{const _0x165efb=_0x9a5cff,_0x1090f1=_0x433774[_0x165efb(0x8f)](_0x40fc55=>_0x40fc55[_0x165efb(0x176)]==_0x5c5aec),_0x468ff9=_0x1090f1['mode']==_0x165efb(0x19d)?_0x165efb(0x128):_0x165efb(0x19d);tgBot[_0x165efb(0x212)](_0xdce44d[_0x165efb(0x147)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x5c5aec+'\x20to\x20'+_0x468ff9+'\x20mode')[_0x165efb(0x248)](_0x18dd74=>{telegramError(_0x18dd74);}),toggleBotMode(_0x5c5aec);}),tgBot[_0x9a5cff(0x13c)](_0x9a5cff(0x117));});}}),tgBot['onText'](/\/names/,_0x2af58c=>{const _0x4ec8cf=_0x2f04cd;if(!validateTelegram(_0x2af58c))return;let _0x56f646='';config[_0x4ec8cf(0x174)](_0x32d727=>{const _0x4ad1fb=_0x4ec8cf;_0x56f646+=_0x4ad1fb(0x126)+_0x32d727[_0x4ad1fb(0x176)]+':\x20'+_0x32d727[_0x4ad1fb(0x1f3)]+'\x0a';}),tgBot[_0x4ec8cf(0x212)](_0x2af58c[_0x4ec8cf(0x147)]['id'],_0x56f646,{'parse_mode':'HTML'})[_0x4ec8cf(0x248)](_0x350d21=>{telegramError(_0x350d21);});}),tgBot[_0x2f04cd(0xc0)](/\/disable/,_0x409b6b=>{const _0x45b6de=_0x2f04cd;if(!validateTelegram(_0x409b6b))return;tgBot['sendMessage'](_0x409b6b[_0x45b6de(0x147)]['id'],_0x45b6de(0x209))[_0x45b6de(0x248)](_0x42bc14=>{telegramError(_0x42bc14);}),updateSetting(_0x45b6de(0xc1),![]);}),tgBot[_0x2f04cd(0xc0)](/\/help/,_0x1b14b7=>{const _0x2ea023=_0x2f04cd;if(!validateTelegram(_0x1b14b7))return;tgBot[_0x2ea023(0x212)](_0x1b14b7[_0x2ea023(0x147)]['id'],_0x1d90f5)[_0x2ea023(0x248)](_0x4b79bf=>{telegramError(_0x4b79bf);});}),tgBot['on'](_0x2f04cd(0xae),_0x299291=>{const _0x4e6441=_0x2f04cd;_0x299291['toString']()[_0x4e6441(0x1d9)]('404\x20Not\x20Found')&&(logger[_0x4e6441(0x1b6)](_0x4e6441(0x1e6)),tgBot[_0x4e6441(0x242)](),tgBot=null,io['to'](_0x4e6441(0x1df))[_0x4e6441(0xd8)](_0x4e6441(0xe4),_0x4e6441(0x1e6)));}),process[_0x2f04cd(0x189)](_0x2f04cd(0x179),()=>{const _0x223f93=_0x2f04cd;if(tgBot)tgBot[_0x223f93(0x242)]();process['exit'](0x1);}),process['once'](_0x2f04cd(0x1da),()=>{const _0x522201=_0x2f04cd;if(tgBot)tgBot[_0x522201(0x242)]();process[_0x522201(0x8d)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x227855,_0x5e1d56){const _0xc276b9=_0xd8b866;if(settings[_0xc276b9(0xc1)]){if(settings[_0xc276b9(0x219)]=='all'||(_0x5e1d56[_0xc276b9(0x245)]=='error'||_0x5e1d56[_0xc276b9(0x245)]==_0xc276b9(0xf6)||_0x5e1d56['type']=='success')&&settings[_0xc276b9(0x219)]=='alerts'||_0x5e1d56[_0xc276b9(0x245)]==_0xc276b9(0x21c)&&settings[_0xc276b9(0x219)]==_0xc276b9(0x233)){if(tgBot&&settings[_0xc276b9(0x20f)]){if(_0x5e1d56[_0xc276b9(0x11c)])tgBot[_0xc276b9(0x212)](settings[_0xc276b9(0x20f)],_0x5e1d56[_0xc276b9(0x1f3)]+_0xc276b9(0x15a)+_0x5e1d56[_0xc276b9(0x172)])['catch'](_0x59604c=>{telegramError(_0x59604c);});else tgBot['sendMessage'](settings[_0xc276b9(0x20f)],_0xc276b9(0x126)+_0x227855+_0xc276b9(0x15a)+_0x5e1d56[_0xc276b9(0x172)])['catch'](_0x1aa286=>{telegramError(_0x1aa286);});}}}}async function sendTelegramMsg(_0x27b040,_0x918219=_0xd8b866(0x12c)){const _0x51cd9c=_0xd8b866;return settings[_0x51cd9c(0xc1)]&&tgBot&&settings[_0x51cd9c(0x20f)]?(await tgBot['sendMessage'](settings[_0x51cd9c(0x20f)],_0x27b040,{'parse_mode':_0x918219})[_0x51cd9c(0x248)](_0x5a3625=>{telegramError(_0x5a3625);}),!![]):![];}function getDeviceWithIp(_0x2ad152){return devices['find'](_0x1d25c8=>_0x1d25c8['ip']===_0x2ad152);}function temporaryAccess2FA(_0x45c868,_0x3c5f7d){const _0x51b488=_0xd8b866;let _0x3c7073=new Date(),_0x5370cb=![];if(lastIpApproval){if(_0x3c7073-lastIpApproval<0x1388)_0x5370cb=!![];}lastIpApproval=new Date();if(_0x5370cb)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x51b488(0x13c)](_0x51b488(0x117)),tgBot['sendMessage'](settings[_0x51b488(0x20f)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x3c5f7d)[_0x51b488(0x196)]+_0x51b488(0x24d),{'parse_mode':_0x51b488(0x12c),'reply_markup':{'inline_keyboard':[[{'text':_0x51b488(0x224),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x51b488(0x1ec),'callback_data':'30'},{'text':_0x51b488(0xf3),'callback_data':_0x51b488(0xf3)}]]}})[_0x51b488(0x248)](_0x119f66=>{telegramError(_0x119f66);}),tgBot['on']('callback_query',async _0x2d89c1=>{const _0x143f6f=_0x51b488,_0x3c101c=_0x2d89c1[_0x143f6f(0x1a8)],_0x5b2749=_0x2d89c1[_0x143f6f(0x103)];tgBot[_0x143f6f(0x10f)](_0x2d89c1['id'])[_0x143f6f(0x20d)](async()=>{const _0x3d522b=_0x143f6f;devices[_0x45c868]['telegramIpApproval']={'clientip':_0x3c5f7d,'timestamp':new Date()[_0x3d522b(0x226)](),'expiry':_0x3c101c},_0x3c101c!=_0x3d522b(0xf3)?(await tgBot[_0x3d522b(0x212)](_0x5b2749[_0x3d522b(0x147)]['id'],_0x3d522b(0xd6)+_0x3c101c+_0x3d522b(0x113),{'parse_mode':_0x3d522b(0x12c)})['catch'](_0x5cdbd1=>{telegramError(_0x5cdbd1);}),io['to'](_0x45c868)[_0x3d522b(0xd8)](_0x3d522b(0x137),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x3d522b(0x212)](_0x5b2749['chat']['id'],_0x3d522b(0x105))[_0x3d522b(0x248)](_0x5b3af7=>{telegramError(_0x5b3af7);}),io['to'](_0x45c868)[_0x3d522b(0xd8)](_0x3d522b(0x137),{'access':{'allow':![],'reason':_0x3d522b(0x1b5),'token':null}}));}),tgBot['removeListener'](_0x143f6f(0x117));}));}function loginAccess2FA(_0x29693e,_0x142903){const _0x3fa90d=_0xd8b866;tgBot&&settings['telegramChatId']&&(tgBot[_0x3fa90d(0x13c)](_0x3fa90d(0x117)),tgBot[_0x3fa90d(0x212)](settings[_0x3fa90d(0x20f)],_0x3fa90d(0x191)+normalizeIP(_0x142903)['show']+_0x3fa90d(0x24d),{'parse_mode':_0x3fa90d(0x12c),'reply_markup':{'inline_keyboard':[[{'text':_0x3fa90d(0xc2),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x3fa90d(0xf3)}]]}})[_0x3fa90d(0x248)](_0x556cc9=>{telegramError(_0x556cc9);}),tgBot['on']('callback_query',async _0x18d8b8=>{const _0x2668c8=_0x3fa90d,_0x11b199=_0x18d8b8[_0x2668c8(0x1a8)],_0x3a9f38=_0x18d8b8[_0x2668c8(0x103)];tgBot['answerCallbackQuery'](_0x18d8b8['id'])[_0x2668c8(0x20d)](async()=>{const _0x83c77c=_0x2668c8;devices[_0x29693e]['telegram2FaApproval']={'clientip':_0x142903,'timestamp':new Date()[_0x83c77c(0x226)](),'expiry':_0x11b199},_0x11b199!='reject'?(await tgBot[_0x83c77c(0x212)](_0x3a9f38[_0x83c77c(0x147)]['id'],_0x83c77c(0x21b),{'parse_mode':_0x83c77c(0x12c)})[_0x83c77c(0x248)](_0x194458=>{telegramError(_0x194458);}),io['to'](_0x29693e)[_0x83c77c(0xd8)]('status',{'access':{'allow':![],'reason':_0x83c77c(0x1ac),'token':null}})):(await tgBot['sendMessage'](_0x3a9f38[_0x83c77c(0x147)]['id'],_0x83c77c(0x1c7))[_0x83c77c(0x248)](_0x342435=>{telegramError(_0x342435);}),io['to'](_0x29693e)[_0x83c77c(0xd8)](_0x83c77c(0x137),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x2668c8(0x13c)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x470085=_0xd8b866;return dbConfig[_0x470085(0x225)](_0x470085(0x133))[_0x470085(0xbd)](_0x470085(0x176))[_0x470085(0x150)]({'status':_0x470085(0x16e)})[_0x470085(0x228)]()||[];}function getDisabledBots(){const _0x188b0f=_0xd8b866;return dbConfig[_0x188b0f(0x225)](_0x188b0f(0x133))[_0x188b0f(0xbd)](_0x188b0f(0x176))['filter']({'status':_0x188b0f(0xb3)})[_0x188b0f(0x228)]()||[];}function getBotAttributes(_0x149180){const _0x1c87d7=_0xd8b866;let _0x625449={};const _0x51f9fd=configpath+_0x1c87d7(0x22f)+_0x149180+_0x1c87d7(0xc9),_0x4b78be=fs[_0x1c87d7(0x161)](_0x51f9fd);if(_0x4b78be){const _0x29a22b=fs[_0x1c87d7(0xce)](_0x51f9fd);try{const _0x371e51=JSON[_0x1c87d7(0x193)](_0x29a22b),_0xd20451=_0x371e51?_0x371e51['bot'][0x0][_0x1c87d7(0x171)]:![];_0x625449[_0x1c87d7(0x1d3)]=_0xd20451?_0x1c87d7(0x19d):_0x1c87d7(0x128),_0x625449['botname']=_0x371e51?_0x371e51[_0x1c87d7(0x17b)][0x0]['botname']:'Bot\x20'+_0x149180;}catch(_0x14a8e1){_0x625449[_0x1c87d7(0x1d3)]=_0x1c87d7(0x128),_0x625449[_0x1c87d7(0x1f3)]=_0x1c87d7(0x126)+_0x149180;}}else _0x625449[_0x1c87d7(0x1d3)]=_0x1c87d7(0x128),_0x625449['botname']='Bot\x20'+_0x149180;return _0x625449;}function getBotsWithMode(){const _0x15e0ac=_0xd8b866,_0x466edc=dbConfig[_0x15e0ac(0x225)](_0x15e0ac(0x133))[_0x15e0ac(0xbd)](_0x15e0ac(0x176))['value']()||[];return _0x466edc['forEach'](_0x80ba4a=>{const _0x3f886b=_0x15e0ac;let _0x2b916f=getBotAttributes(_0x80ba4a['botID']);_0x80ba4a[_0x3f886b(0x1d3)]=_0x2b916f['mode'];}),_0x466edc;}function getBotExchanges(){const _0x51e08d=_0xd8b866;let _0x12e79e=[];const _0x21d278=dbConfig[_0x51e08d(0x225)](_0x51e08d(0x133))[_0x51e08d(0xbd)](_0x51e08d(0x176))[_0x51e08d(0x228)]()||[];_0x21d278[_0x51e08d(0x174)](_0x103a49=>{const _0x1031b3=_0x51e08d;if(_0x103a49[_0x1031b3(0x137)]=='enabled'){const _0x553948=configpath+_0x1031b3(0x22f)+_0x103a49[_0x1031b3(0x176)]+_0x1031b3(0xc9),_0x1d4b7c=fs['existsSync'](_0x553948);let _0x287908;if(_0x1d4b7c){const _0x22e240=fs[_0x1031b3(0xce)](_0x553948);try{const _0x5f0966=JSON[_0x1031b3(0x193)](_0x22e240);_0x287908=_0x5f0966?_0x5f0966[_0x1031b3(0x17b)][0x0][_0x1031b3(0x1c2)]:null;}catch(_0xfe5509){}}if(_0x287908)_0x12e79e[_0x1031b3(0x162)](_0x287908);}});const _0x29881e=[...new Set(_0x12e79e)][_0x51e08d(0x90)]();return _0x29881e;}async function initUser(){const _0x4c493a=_0xd8b866;if(!settings['userid']){const _0x4a1b23=uuidRandom();mixpanel[_0x4c493a(0x14d)](_0x4a1b23),updateSetting(_0x4c493a(0xfe),_0x4a1b23);}}async function initSecure(){const _0x388bdd=_0xd8b866;let _0x5939cf=getSecure();if(!_0x5939cf['hasOwnProperty'](_0x388bdd(0x21d))){let _0x95f4ae=await generateKeys();_0x5939cf[_0x388bdd(0x218)]=_0x95f4ae[_0x388bdd(0x218)],_0x5939cf['privateKey']=_0x95f4ae[_0x388bdd(0xeb)],_0x5939cf['secret']=crypto['randomBytes'](0x20)[_0x388bdd(0x19f)](_0x388bdd(0x11b));;storeSecure(_0x5939cf);}}function getSettings(){const _0x124884=_0xd8b866;return dbSettings[_0x124884(0x225)](_0x124884(0x89))['value']()||{};}function getSecure(){const _0x19c92e=_0xd8b866;return dbSecure[_0x19c92e(0x225)](_0x19c92e(0x142))[_0x19c92e(0x228)]()||{};}function getBlacklist(){const _0x1d2d86=_0xd8b866;return dbSecure['get'](_0x1d2d86(0x230))[_0x1d2d86(0x228)]()||[];}function broadcastToBots(_0x191dda,_0x22340b){const _0x388506=_0xd8b866;config[_0x388506(0x174)](_0x5df3f7=>{const _0x2e9473=_0x388506;if(_0x5df3f7[_0x2e9473(0x137)]==_0x2e9473(0x16e)&&_0x5df3f7['live']==_0x2e9473(0x1c6)||_0x5df3f7[_0x2e9473(0x137)]==_0x2e9473(0x10b)&&_0x5df3f7['live']==_0x2e9473(0x1c6)){if(pid[_0x5df3f7[_0x2e9473(0x176)]])pid[_0x5df3f7[_0x2e9473(0x176)]][_0x2e9473(0x200)]({[_0x191dda]:_0x22340b});}});}function storeSettings(_0x3d7576,_0x1f4b3a=![]){const _0x2559c8=_0xd8b866;_0x3d7576={...settings,..._0x3d7576};if(_0x1f4b3a&&_0x3d7576[_0x2559c8(0x11a)]!='************'&&_0x3d7576[_0x2559c8(0x11a)]!=_0x2559c8(0x239)&&_0x3d7576['bbPassword']!=''){const _0x49b6bc=crypt[_0x2559c8(0x217)](secure[_0x2559c8(0xeb)],_0x3d7576[_0x2559c8(0x11a)])[_0x2559c8(0x103)][_0x2559c8(0x23b)]('@')[0x0],_0x2ba274=bcrypt[_0x2559c8(0xc5)](_0x49b6bc,saltRounds);_0x3d7576={..._0x3d7576,'bbPassword':_0x2ba274};}if(_0x1f4b3a&&_0x3d7576[_0x2559c8(0x169)]!=_0x2559c8(0x1a7)&&_0x3d7576[_0x2559c8(0x169)]!='***'&&_0x3d7576['telegramToken']!=''){const _0x7ab9f8=crypt['decrypt'](secure[_0x2559c8(0xeb)],_0x3d7576['telegramToken'])[_0x2559c8(0x103)][_0x2559c8(0x23b)]('@')[0x0];_0x3d7576={..._0x3d7576,'telegramToken':_0x7ab9f8};}const _0xa5094=_0x3d7576['telegramToken']!='************'&&_0x3d7576[_0x2559c8(0x169)]!=settings['telegramToken']||_0x3d7576['telegramUsername']!=settings[_0x2559c8(0x13d)],_0x203244=_0x3d7576[_0x2559c8(0x169)]==''||_0x3d7576[_0x2559c8(0x13d)]=='';if(_0xa5094)_0x3d7576[_0x2559c8(0x219)]=_0x2559c8(0x1c1);for(const [_0x526c5c,_0xb6ce5d]of Object[_0x2559c8(0x136)](_0x3d7576)){if(_0x526c5c=='telegramToken'&&_0xb6ce5d==_0x2559c8(0x1a7)){_0x3d7576[_0x2559c8(0x169)]=settings[_0x2559c8(0x169)];continue;};if(_0x526c5c==_0x2559c8(0x11a)&&_0xb6ce5d==_0x2559c8(0x1a7)){_0x3d7576['bbPassword']=settings[_0x2559c8(0x11a)];continue;};dbSettings['set'](_0x2559c8(0x17f)+_0x526c5c,_0xb6ce5d)[_0x2559c8(0x223)]();}settings=_0x3d7576,io['to'](_0x2559c8(0x1df))[_0x2559c8(0xd8)]('settings',cleanSettings()),broadcastToBots(_0x2559c8(0xa6),settings[_0x2559c8(0xa6)]),broadcastToBots(_0x2559c8(0x20c),settings[_0x2559c8(0x20c)]);if(_0xa5094&&!_0x203244)initTelegram();if(_0xa5094&&_0x203244)disableTelegram();getAllClients()[_0x2559c8(0x174)](_0x3924b5=>{const _0x1c77f0=_0x2559c8;getSocket(_0x3924b5['id'])[_0x1c77f0(0xd8)]('status',{'access':{'allow':![],'reason':_0x1c77f0(0x1ac),'token':null}});});}function updateSetting(_0x673986,_0x621f18){const _0x2d5cc9=_0xd8b866;dbSettings[_0x2d5cc9(0x11e)](_0x2d5cc9(0x17f)+_0x673986,_0x621f18)['write'](),settings=getSettings(),io['to'](_0x2d5cc9(0x1df))[_0x2d5cc9(0xd8)](_0x2d5cc9(0x89),cleanSettings());}function storeSecure(_0x2eb721){const _0x21b529=_0xd8b866;dbSecure[_0x21b529(0x225)](_0x21b529(0x142))[_0x21b529(0x162)](_0x2eb721)[_0x21b529(0x223)](),secure=_0x2eb721;}function addBlacklist(_0x2ef51e){const _0x3bb2aa=_0xd8b866;cleanBlacklist();let _0x17c6c3;devices[_0x2ef51e][_0x3bb2aa(0x232)]?_0x17c6c3=Math[_0x3bb2aa(0x1cb)](devices[_0x2ef51e][_0x3bb2aa(0x232)][_0x3bb2aa(0xe9)],loginExpiry):_0x17c6c3=loginExpiry,dbSecure[_0x3bb2aa(0x225)](_0x3bb2aa(0x230))['push']({'expiry':new Date()['getTime']()+_0x17c6c3*0x3c*0x3e8,'token':devices[_0x2ef51e][_0x3bb2aa(0xa3)]['token']})[_0x3bb2aa(0x223)](),blacklist=dbSecure[_0x3bb2aa(0x225)](_0x3bb2aa(0x230))[_0x3bb2aa(0x228)]();}function cleanBlacklist(){const _0xd0a103=_0xd8b866;let _0x54cb8f=dbSecure[_0xd0a103(0x225)]('blacklist')[_0xd0a103(0x10e)]()[_0xd0a103(0x228)](),_0x808f9a=new Date()['getTime']();_0x54cb8f[_0xd0a103(0x174)](_0x5b23cf=>{const _0x12455c=_0xd0a103;_0x5b23cf[_0x12455c(0xe9)]<_0x808f9a&&dbSecure['get'](_0x12455c(0x230))[_0x12455c(0x183)]({'expiry':_0x5b23cf[_0x12455c(0xe9)]})[_0x12455c(0x223)]();});}function initStates(){let _0x5ba04c=getConfiguration();_0x5ba04c['forEach'](_0x342b57=>{const _0x408de0=_0x3062;_0x342b57[_0x408de0(0x180)]=_0x408de0(0x153);}),storeConfiguration(_0x5ba04c);}function onKeys(){const _0x1d2902=new RSA();return new Promise(_0x58c85a=>{const _0x4e6a18=_0x3062;_0x1d2902['generateKeyPairAsync']()[_0x4e6a18(0x20d)](_0xdf72d9=>{_0x58c85a(_0xdf72d9);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x119676=_0xd8b866;let _0x1cf7bc=getSettings(),_0x19b180=![];!_0x1cf7bc[_0x119676(0x87)](_0x119676(0x15b))&&(_0x1cf7bc['lastmsgtelegram']=0x0,_0x19b180=!![]);!_0x1cf7bc['hasOwnProperty'](_0x119676(0x181))&&(_0x1cf7bc[_0x119676(0x181)]=0x0,_0x19b180=!![]);!_0x1cf7bc[_0x119676(0x87)](_0x119676(0xa9))&&(_0x1cf7bc[_0x119676(0xa9)]='0.0.0',_0x19b180=!![]);!_0x1cf7bc[_0x119676(0x87)](_0x119676(0x20c))&&(_0x1cf7bc[_0x119676(0x20c)]=![],_0x19b180=!![]);if(_0x19b180)storeSettings(_0x1cf7bc);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})['forEach'](_0xe0b0ad=>{const _0x2ba9c2=_0x119676;if(!_0xe0b0ad['isDirectory']()){if(!_0xe0b0ad[_0x2ba9c2(0xd4)][_0x2ba9c2(0x237)]('backup-full@'))fs[_0x2ba9c2(0x220)](configbackuppath+_0xe0b0ad[_0x2ba9c2(0xd4)]);}else fs[_0x2ba9c2(0x12e)](configbackuppath+_0xe0b0ad[_0x2ba9c2(0xd4)],{'recursive':!![]});});}catch(_0x2dafd6){logger[_0x119676(0x13e)](_0x119676(0x8a),_0x2dafd6);}}function storeConfiguration(_0x4ce4a2){const _0x3c8fbf=_0xd8b866;dbConfig[_0x3c8fbf(0x225)](_0x3c8fbf(0x133))[_0x3c8fbf(0x183)]()[_0x3c8fbf(0x223)](),dbConfig[_0x3c8fbf(0x225)](_0x3c8fbf(0x133))['push'](..._0x4ce4a2)[_0x3c8fbf(0x223)](),config=_0x4ce4a2;}function resetPassword(){const _0x2da12c=_0xd8b866;tgBot&&settings['telegramChatId']&&(tgBot[_0x2da12c(0x13c)](_0x2da12c(0x117)),tgBot[_0x2da12c(0x212)](settings[_0x2da12c(0x20f)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x2da12c(0x12c),'reply_markup':{'inline_keyboard':[[{'text':_0x2da12c(0x125),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x2da12c(0x248)](_0x1599dc=>{telegramError(_0x1599dc);}),tgBot['on'](_0x2da12c(0x117),async _0x3f9aab=>{const _0x41b380=_0x2da12c,_0x3cdb09=_0x3f9aab[_0x41b380(0x1a8)],_0x1ceb7c=_0x3f9aab[_0x41b380(0x103)];tgBot[_0x41b380(0x10f)](_0x3f9aab['id'])[_0x41b380(0x20d)](async()=>{const _0x1bab19=_0x41b380;if(_0x3cdb09!='no'){const _0x3ce001=0xf,_0x4a23a5=_0x1bab19(0x12d),_0x3b49fd=Array[_0x1bab19(0xe8)](crypto[_0x1bab19(0x1fa)](new Uint32Array(_0x3ce001)))['map'](_0x33a852=>_0x4a23a5[_0x33a852%_0x4a23a5[_0x1bab19(0x1d8)]])[_0x1bab19(0x148)](''),_0x1373bc=bcrypt['hashSync'](_0x3b49fd,saltRounds);storeSettings({'bbPassword':_0x1373bc}),await tgBot['sendMessage'](_0x1ceb7c[_0x1bab19(0x147)]['id'],_0x1bab19(0xa8)+_0x3b49fd,{'parse_mode':_0x1bab19(0x12c)})[_0x1bab19(0x248)](_0x5cc6fd=>{telegramError(_0x5cc6fd);});}else await tgBot[_0x1bab19(0x212)](_0x1ceb7c['chat']['id'],_0x1bab19(0x84))[_0x1bab19(0x248)](_0x455ed7=>{telegramError(_0x455ed7);});}),tgBot[_0x41b380(0x13c)](_0x41b380(0x117));}));}async function confirmRestore(_0x56cdcf,_0x29eff6){const _0x2208e2=_0xd8b866;io['to'](_0x2208e2(0x1df))[_0x2208e2(0xd8)]('notification',_0x2208e2(0x177),_0x2208e2(0xaa)),tgBot&&settings[_0x2208e2(0x20f)]&&(tgBot[_0x2208e2(0x13c)](_0x2208e2(0x117)),await tgBot['sendMessage'](settings['telegramChatId'],_0x2208e2(0x157),{'parse_mode':_0x2208e2(0x12c),'reply_markup':{'inline_keyboard':[[{'text':_0x2208e2(0x125),'callback_data':_0x2208e2(0x125)},{'text':'no','callback_data':'no'}]]}})[_0x2208e2(0x248)](_0x1f594d=>{telegramError(_0x1f594d);}),tgBot['on'](_0x2208e2(0x117),async _0x454a42=>{const _0x23af1f=_0x2208e2,_0x2afbf8=_0x454a42[_0x23af1f(0x1a8)],_0x451b1b=_0x454a42['message'];tgBot['answerCallbackQuery'](_0x454a42['id'])[_0x23af1f(0x20d)](async()=>{const _0x2d13d9=_0x23af1f;_0x2afbf8==_0x2d13d9(0x125)?(await tgBot[_0x2d13d9(0x212)](_0x451b1b['chat']['id'],_0x2d13d9(0x14b),{'parse_mode':'HTML'})[_0x2d13d9(0x248)](_0x36eea4=>{telegramError(_0x36eea4);}),unzipFile(_0x56cdcf,_0x29eff6)):(logger[_0x2d13d9(0x13e)]('Restore\x20process\x20aborted'),await tgBot[_0x2d13d9(0x212)](_0x451b1b['chat']['id'],_0x2d13d9(0xb2))[_0x2d13d9(0x248)](_0x1c108c=>{telegramError(_0x1c108c);}));}),tgBot[_0x23af1f(0x13c)](_0x23af1f(0x117));}));}function getServerTime(){const _0x3f1dd4=_0xd8b866,_0x46db35=new Date();return _0x46db35[_0x3f1dd4(0x1a3)]()+'/'+(_0x46db35[_0x3f1dd4(0x1f0)]()+0x1)[_0x3f1dd4(0x19f)]()[_0x3f1dd4(0x15e)](0x2,'0')+'/'+_0x46db35[_0x3f1dd4(0x211)]()[_0x3f1dd4(0x19f)]()[_0x3f1dd4(0x15e)](0x2,'0')+'\x20'+_0x46db35[_0x3f1dd4(0x1ba)]()[_0x3f1dd4(0x19f)]()['padStart'](0x2,'0')+':'+_0x46db35[_0x3f1dd4(0x131)]()[_0x3f1dd4(0x19f)]()[_0x3f1dd4(0x15e)](0x2,'0')+':'+_0x46db35[_0x3f1dd4(0x1bd)]()[_0x3f1dd4(0x19f)]()[_0x3f1dd4(0x15e)](0x2,'0');}function getTimeStamp(){const _0x51fb30=_0xd8b866,_0x51b1f7=shiftedTime();return _0x51b1f7[_0x51fb30(0x1a3)]()+'/'+(_0x51b1f7[_0x51fb30(0x1f0)]()+0x1)[_0x51fb30(0x19f)]()[_0x51fb30(0x15e)](0x2,'0')+'/'+_0x51b1f7['getDate']()['toString']()[_0x51fb30(0x15e)](0x2,'0')+'\x20'+_0x51b1f7[_0x51fb30(0x1ba)]()[_0x51fb30(0x19f)]()[_0x51fb30(0x15e)](0x2,'0')+':'+_0x51b1f7['getMinutes']()['toString']()[_0x51fb30(0x15e)](0x2,'0')+':'+_0x51b1f7[_0x51fb30(0x1bd)]()[_0x51fb30(0x19f)]()[_0x51fb30(0x15e)](0x2,'0');}function getCleanTimeStamp(){const _0x5ed9a6=_0xd8b866,_0x47fc4c=shiftedTime();return _0x47fc4c['getFullYear']()+(_0x47fc4c[_0x5ed9a6(0x1f0)]()+0x1)[_0x5ed9a6(0x19f)]()[_0x5ed9a6(0x15e)](0x2,'0')+_0x47fc4c['getDate']()[_0x5ed9a6(0x19f)]()[_0x5ed9a6(0x15e)](0x2,'0')+'-'+_0x47fc4c[_0x5ed9a6(0x1ba)]()[_0x5ed9a6(0x19f)]()['padStart'](0x2,'0')+_0x47fc4c[_0x5ed9a6(0x131)]()[_0x5ed9a6(0x19f)]()[_0x5ed9a6(0x15e)](0x2,'0')+_0x47fc4c[_0x5ed9a6(0x1bd)]()[_0x5ed9a6(0x19f)]()[_0x5ed9a6(0x15e)](0x2,'0');}function shiftedTime(){const _0x438294=_0xd8b866,_0x529085=new Date();let _0x507364=_0x529085;if(settings['timeshift']&&settings[_0x438294(0xa6)]!==0x0)_0x507364=fns[_0x438294(0x1b4)](_0x529085,{'hours':settings['timeshift']});return _0x507364;}function startScheduler(){const _0x49e2dc=_0xd8b866,_0x2eac26=new Date()[_0x49e2dc(0x1fd)](),_0x432d07=shiftedTime()['getHours']();_0x432d07==0x4&&backupConfigFiles();_0x432d07==0x0&&rotateLogFiles();_0x2eac26%0x6==0x0&&triggerAnalytics();_0x2eac26%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x4580a9){const _0x46546f=_0xd8b866;logger[_0x46546f(0x13e)](_0x46546f(0xde)+_0x4580a9);const _0x3da148=getBotsWithMode();_0x3da148['length']>0x0?confirmRestore(configbackuppath,_0x4580a9):unzipFile(configbackuppath,_0x4580a9);}async function getBackupFiles(_0x2ec29b=null){const _0x48d4e8=_0xd8b866;let _0x305172=[],_0x2821b1=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x2821b1['sort']((_0x208996,_0x5ffc46)=>_0x208996[_0x48d4e8(0xd4)]<_0x5ffc46[_0x48d4e8(0xd4)]?0x1:_0x5ffc46['name']<_0x208996[_0x48d4e8(0xd4)]?-0x1:0x0),_0x2821b1['forEach'](_0x2ba44d=>{const _0x30a037=_0x48d4e8;if(!_0x2ba44d[_0x30a037(0x205)]()&&_0x2ba44d[_0x30a037(0xd4)][_0x30a037(0x237)](_0x30a037(0x1a2))&&_0x2ba44d[_0x30a037(0xd4)][_0x30a037(0x17c)](_0x30a037(0x216))){const _0x1a2f18=formatDate(fs[_0x30a037(0xf7)](configbackuppath+_0x2ba44d[_0x30a037(0xd4)])[_0x30a037(0x104)]);_0x305172['push']({'name':_0x2ba44d[_0x30a037(0xd4)],'mtime':_0x1a2f18});}});if(_0x2ec29b)io['to'](_0x2ec29b)['emit'](_0x48d4e8(0x1a5),_0x305172);else return _0x305172;}async function backupConfigFiles(){const _0x3aa06b=_0xd8b866;await zipFiles('backup-full');const _0xa0b68a=getCleanTimeStamp();fs[_0x3aa06b(0xe7)](zippath+_0x3aa06b(0x1cd),configbackuppath+('backup-full@'+_0xa0b68a+'.zip'));let _0x41d4da=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x41d4da[_0x3aa06b(0x90)]((_0xf4b883,_0x3a2e20)=>_0xf4b883[_0x3aa06b(0xd4)]<_0x3a2e20['name']?0x1:_0x3a2e20[_0x3aa06b(0xd4)]<_0xf4b883['name']?-0x1:0x0),_0x41d4da[_0x3aa06b(0x1d8)]>maxBackups&&fs[_0x3aa06b(0x220)](configbackuppath+_0x41d4da[_0x41d4da['length']-0x1][_0x3aa06b(0xd4)]);}function rotateLogFiles(){const _0x509626=_0xd8b866,_0x5ae4c1=fs[_0x509626(0xf7)](logspath+_0x509626(0x124)),_0x1dbb76=_0x5ae4c1['size']/0x400;if(_0x1dbb76>0x64){let _0x2fa65b=fs[_0x509626(0x16c)](logspath,{'withFileTypes':!![]});_0x2fa65b['sort']((_0x567a7f,_0x2ecc99)=>_0x567a7f[_0x509626(0xd4)]<_0x2ecc99[_0x509626(0xd4)]?0x1:_0x2ecc99['name']<_0x567a7f['name']?-0x1:0x0),_0x2fa65b['forEach'](_0xe2d07c=>{const _0x396964=_0x509626;if(_0xe2d07c[_0x396964(0xd4)]=='output-002.log')fs[_0x396964(0xe7)](logspath+_0xe2d07c[_0x396964(0xd4)],logspath+'output-003.log');if(_0xe2d07c['name']==_0x396964(0x160))fs[_0x396964(0xe7)](logspath+_0xe2d07c[_0x396964(0xd4)],logspath+_0x396964(0x190));_0xe2d07c['name']=='output-000.log'&&(fs[_0x396964(0xe7)](logspath+_0xe2d07c[_0x396964(0xd4)],logspath+_0x396964(0x160)),fs['writeFileSync'](logspath+_0xe2d07c[_0x396964(0xd4)],''));});}}async function zipFiles(_0x510fb5){const _0x494d02=_0xd8b866;let _0x3e174f;if(_0x510fb5==_0x494d02(0xac))_0x3e174f=logspath;if(_0x510fb5=='backup')_0x3e174f=configpath;if(_0x510fb5==_0x494d02(0x100))_0x3e174f=configpath;let _0x71b975=fs['readdirSync'](_0x3e174f,{'withFileTypes':!![]});const _0xd78a45=new require('node-zip')();_0x71b975[_0x494d02(0x174)](_0x351647=>{const _0x47ec7f=_0x494d02;if(!_0x351647['isDirectory']()){let _0x3bcc9e=fs[_0x47ec7f(0xce)](_0x3e174f+_0x351647[_0x47ec7f(0xd4)]);if(_0x510fb5==_0x47ec7f(0x18a)){const _0x96d230=/^bot-[0-9]{3}-config.json$/,_0x26ee01=_0x96d230[_0x47ec7f(0x115)](_0x351647[_0x47ec7f(0xd4)]);if(_0x26ee01){const _0xe07eab=JSON[_0x47ec7f(0x193)](_0x3bcc9e);if(_0xe07eab[_0x47ec7f(0x17b)][0x0]){_0xe07eab[_0x47ec7f(0x17b)][0x0][_0x47ec7f(0x214)]=_0x47ec7f(0x239),_0xe07eab['bot'][0x0]['apiSecret']=_0x47ec7f(0x239);if(_0xe07eab[_0x47ec7f(0x17b)][0x0][_0x47ec7f(0xe2)])_0xe07eab[_0x47ec7f(0x17b)][0x0]['apiPassword']=_0x47ec7f(0x239);}_0x3bcc9e=JSON['stringify'](_0xe07eab,null,0x2);}if(_0x351647[_0x47ec7f(0xd4)]==_0x47ec7f(0x152)){const _0x26c123=JSON[_0x47ec7f(0x193)](_0x3bcc9e);if(_0x26c123['settings'][_0x47ec7f(0x1ca)])_0x26c123[_0x47ec7f(0x89)][_0x47ec7f(0x1ca)]=![];if(_0x26c123[_0x47ec7f(0x89)][_0x47ec7f(0x11a)])_0x26c123[_0x47ec7f(0x89)][_0x47ec7f(0x11a)]=_0x47ec7f(0x239);if(_0x26c123[_0x47ec7f(0x89)][_0x47ec7f(0x169)])_0x26c123['settings'][_0x47ec7f(0x169)]='***';if(_0x26c123['settings'][_0x47ec7f(0x20f)])_0x26c123[_0x47ec7f(0x89)][_0x47ec7f(0x20f)]=null;_0x3bcc9e=JSON[_0x47ec7f(0x1a6)](_0x26c123,null,0x2);}if(_0x351647[_0x47ec7f(0xd4)]!=_0x47ec7f(0x1ab))_0xd78a45['file'](_0x351647['name'],_0x3bcc9e);}else _0xd78a45[_0x47ec7f(0x14f)](_0x351647[_0x47ec7f(0xd4)],_0x3bcc9e);}});const _0x28f429=_0xd78a45['generate']({'base64':![],'compression':'DEFLATE'});fs['writeFileSync'](zippath+(_0x510fb5+'.zip'),_0x28f429,'binary');}async function unzipFile(_0x16d04d,_0x175c2c){const _0x1609b2=_0xd8b866;fs[_0x1609b2(0x16c)](configpath,{'withFileTypes':!![]})['forEach'](_0x27b6e7=>{const _0x2346a9=_0x1609b2;if(!_0x27b6e7[_0x2346a9(0x205)]())fs[_0x2346a9(0x12e)](configpath+_0x27b6e7[_0x2346a9(0xd4)]);});const _0x349f18=fs[_0x1609b2(0xce)](_0x16d04d+_0x175c2c,_0x1609b2(0x210)),_0x542218=new require('node-zip')(_0x349f18,{'base64':![],'checkCRC32':!![]});Object[_0x1609b2(0xb7)](_0x542218[_0x1609b2(0xb8)])[_0x1609b2(0x174)](_0x35013e=>{const _0x3b8719=_0x1609b2,_0x576a44=_0x542218[_0x3b8719(0xb8)][_0x35013e];fs[_0x3b8719(0x1f8)](configpath+_0x576a44[_0x3b8719(0xd4)],_0x576a44[_0x3b8719(0x249)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x1609b2(0x174)](_0x43be23=>{const _0xb40e30=_0x1609b2;if(!_0x43be23['isDirectory']())fs['rmSync'](temppath+_0x43be23[_0xb40e30(0xd4)]);}),logger[_0x1609b2(0x13e)](_0x1609b2(0x208)),process[_0x1609b2(0x200)]({'restore':!![]},_0x16d2dd=>{});}async function getPublicIp(){const _0x7f9cce=_0xd8b866;try{const _0x312748=await axios[_0x7f9cce(0x225)](_0x7f9cce(0x91));publicip=_0x312748[_0x7f9cce(0x1a8)]['ip'];}catch(_0x2810a8){}}async function triggerAnalytics(){const _0x33443f=_0xd8b866;if(!publicip)await getPublicIp();const _0x242462=getBotsWithMode();let _0x508636=0x0;_0x242462['forEach'](_0x34a84b=>{const _0x51634f=_0x3062;if(_0x34a84b['status']===_0x51634f(0x16e))_0x508636++;});const _0x3c6177=getBotExchanges();mixpanel[_0x33443f(0x82)]('Server',{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x242462['length'],'numbotsenabled':_0x508636,'exchanges':_0x3c6177,'environment':environment});}async function getMessages(){const _0x16447c=_0xd8b866,_0x4028fa='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x589872=new GraphQLClient(_0x4028fa),_0x29bba1={'authorization':_0x16447c(0x1af)},_0x51b888=serverversion['split']('.'),_0x52a14c=_0x51b888[0x0]+'.'+_0x51b888[0x1],_0x34eccb=Math[_0x16447c(0x1d1)](settings[_0x16447c(0x15b)],settings['lastmsgemitted']),_0x2dc17e={'last':parseInt(_0x34eccb),'bbm':_0x52a14c},_0x388060=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x5eb26d;try{_0x5eb26d=await _0x589872['request'](_0x388060,_0x2dc17e,_0x29bba1);}catch(_0x44132b){}if(_0x5eb26d&&_0x5eb26d['messages']){let _0x403e5e=settings['lastmsgtelegram'];newMessages=[];for(const _0x5cf407 of _0x5eb26d['messages']){newMessages['push'](_0x5cf407);let _0x338473=![];_0x5cf407[_0x16447c(0xdd)]&&(updateSetting(_0x16447c(0xa9),_0x5cf407[_0x16447c(0xdd)]),_0x338473=isNewerVersion(serverversion,_0x5cf407[_0x16447c(0xdd)])||serverversion==_0x5cf407['bbvNew']);if(!_0x338473&&_0x5cf407['number']>_0x403e5e){if(_0x5cf407[_0x16447c(0x1db)]===_0x16447c(0xb1)||serverversion[_0x16447c(0x237)](_0x5cf407['bbvReceive'])){let _0xadf891=''+_0x5cf407['title']+'\x0a\x0a'+_0x5cf407[_0x16447c(0x103)];const _0x186448=await sendTelegramMsg(toTelegramMarkdown(_0xadf891),_0x16447c(0x24f));if(_0x186448)_0x403e5e=_0x5cf407[_0x16447c(0xa2)];}}}updateAvailable=isNewerVersion(settings[_0x16447c(0xa9)],serverversion),updateSetting(_0x16447c(0x15b),_0x403e5e),emitMessages();}}function _0x5d88(){const _0x2b19a3=['delete-bot','(((.+)+)+)+$','toIPv4Address','30\x20min','16PfWKzp','Ok,\x20will\x20send\x20alert\x20notifications\x20only','kill','getMonth','Your\x20installation\x20is\x20already\x20up\x20to\x20date','/:bot/history','botname','User\x20has\x20been\x20validated','login','socket','logout','writeFileSync','clientip','randomFillSync','(staging)','backupfile','getUTCHours','3000','lowdb/adapters/FileSync','send','<b>Balance\x20Bot\x20Status:</b>\x0a','tkn','placeOrder','isValid','isDirectory','No\x20bots\x20running\x20right\x20now','bbUsername','Backup\x20file\x20unzipped\x20and\x20stored','Notifications\x20disabled','uuid','/names\x20-\x20show\x20bot\x20names\x0a','onepagemode','then','uncaughtException','telegramChatId','binary','getDate','sendMessage','timestamp','apiKey','165364UAwEnO','.zip','decrypt','publicKey','telegramEvents','simple','Login\x20accepted','order','secret','\x20|\x20client:\x20...','store-headless','unlinkSync','RSA-OAEP','login\x20token\x20generated','write','5\x20min','get','getTime','/metrics\x20-\x20show\x20bot\x20performance\x0a','value','express-fileupload','child_process','All','No\x20authentication\x20token','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Unauthorized\x20attempt\x20to\x20delete\x20alerts','bot-','blacklist','Unauthorized\x20attempt\x20to\x20update\x20bot','telegramIpApproval','orders','version','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','startsWith',')\x20|\x20Bot\x20','***','805041UxbCvq','split','Notifications\x20types:\x20','remoteAddress','login\x20token\x20valid','express','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','stopPolling','new-disabled','Invalid\x20username\x20or\x20IP\x20address','type','defaults','522765NoRfAe','catch','_data','-----------------------------------------------------------------------------------','listen','/:bot/performance','</b>\x20?','\x1b[35m','Markdown','15958910CHDIZO','logs/','search','Unauthorized\x20attempt\x20to\x20get\x20events','temporary\x20access\x20not\x20allowed','store-configuration','path','Notifications\x20disabled\x0a','error','Bot\x20Mgr\x20>\x20','exp','add-bot','ipaddr.js','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','track','Unauthorized\x20login\x20attempt\x20(timeout)','Password\x20reset\x20rejected','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','bcryptjs','hasOwnProperty','argv','settings','Error\x20removing\x20old\x20backup\x20files:','Starting\x20new\x20bot\x20|\x20Bot\x20','All\x20bots','exit','address','find','sort','https://api.ipify.org?format=json','store','hybrid-crypto-js','Unauthorized\x20attempt\x20to\x20get\x20messages','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','You\x20can\x20use\x20the\x20following\x20commands:\x0a','253UBCQOk','place-order','getPortfolio','get-starting-balances','format','Idling\x20(','reason','inherit','use','sendFile','127.0.0.1','number','access','temporary\x20token\x20generated','/:bot/support','timeshift','toggle-bot-mode','Password\x20has\x20been\x20reset\x20to:\x20','latestversion','success','/off\x20-\x20stop\x20bot(s)\x0a','logs','/restart\x20-\x20restart\x20bot(s)\x0a','polling_error','toggleBotMode','production','any','Restore\x20process\x20aborted','disabled','build','axios','mkdirSync','keys','files','Invalid\x20authentication\x20token\x20(1)','env','telegrammsg','started','sortBy','6b67f3d61ee94b8f5c80b4affef4c4d9','\x1b[31m','onText','telegramEnabled','accept','get-backup-files','Error:\x20Invalid\x20argument\x20','hashSync','temporaryAccessAllowed','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','init','-config.json','Deleted\x20Bot\x20','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Starting\x20Balance\x20Bot\x20reinstallation','username','readFileSync','crypto','update','RSA','internal','::1','name','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Access\x20enabled\x20for\x20','Yes','emit','Token\x20blacklisted',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','get-portfolio','Unauthorized\x20attempt\x20to\x20delete\x20bot','bbvNew','Restore\x20backup\x20file\x20','/output-000.log','\x1b[34m','5KqsVZs','apiPassword','sendPortfolioTelegram','notification','Disabled\x20Bot\x20','config/','copyFileSync','from','expiry','telegram2FaApproval','privateKey','ipv6','replace','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','whitelist','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','296358tZnQHL','download','reject','cancel-loading','access\x20timeout','warning','statSync','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','clients','encryptedUuid','sha256','conn','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','userid','date-fns','backup-full','toIPv4MappedAddress',')\x20\x20\x20|\x20Bot\x20','message','mtime','Temporary\x20access\x20rejected','jsonwebtoken','staging','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','assign','new','store-settings','private','cloneDeep','answerCallbackQuery','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Backup\x20file\x20uploaded','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','\x20minutes','build2','test','Logged\x20out\x20user\x20...','callback_query','Invalid\x20authentication\x20token\x20(2)','invalid\x20credentials','bbPassword','hex','showname','function','set','post','apply','whitelistEnabled',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','output-000.log','yes','Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20portfolio','manual','-events.json','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','family','HTML','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','rmSync','params','confirm-message','getMinutes','login\x20not\x20required','bots','\x1b[36m','zip/','entries','status','/download/:type','161ziMcvb','static','Invalid\x20IP\x20address','removeListener','telegramUsername','debug','*$1*','Unauthorized\x20attempt\x20to\x20update\x20settings','2337982GiVETT','secure','allow','2FA\x20login\x20token\x20generated','disconnect','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','chat','join','1000','Error\x20while\x20deleting\x20config\x20files:\x20','Restoring\x20bot(s)\x20from\x20backup','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','alias','All\x20bots\x20running\x20right\x20now','file','filter','/enable\x20-\x20enable\x20notifications\x0a','bb-settings.json','stopped','createWriteStream','get-logs','handshake','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','/disable\x20-\x20disable\x20notifications\x0a','3SqrumW','\x20>\x20','lastmsgtelegram',':\x20Bot\x20Mgr\x20>\x20','user','padStart','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','output-001.log','existsSync','push','constructor','\x20|\x20','Setting\x20access:\x20','alerts','update-bb','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','telegramToken','versions','-results.json','readdirSync','get-messages','enabled','/upload-backup','logged\x20out','headless','event','uuid-random','forEach','login\x20required','botID','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','[ip-address]','SIGINT','Unauthorized\x20attempt\x20to\x20log\x20out','bot','endsWith','store-fiat','log','settings.','live','lastmsgemitted','Network\x20Interfaces:','remove','lowdb','\x1b[0m','2FA\x20login\x20required','reset-history','NTBA_FIX_319','once','backup','version.json','#RES#\x20if\x20running\x20locally\x0a','referer','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','headers','output-002.log','Allow\x20login\x20from\x20IP\x20address\x20<b>','host','parse','Starting\x20#RED#Balance\x20Bot\x20v','match','show','Notifications\x20enabled\x0a','bb-config.json','f2aRequired','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Enabled\x20Bot\x20','auto','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','toString','\x20(2)','token','backup-full@','getFullYear','IPv4','backup-files','stringify','************','data','1625388QpYhdH','$1_$2_$3','bb-secure.json','reload','temp/','Alerts','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','2FA\x20required','pidExpireLogin','File\x20uploaded','emitHistory','add','temporary\x20access\x20rejected','full','connected','Starting\x20Balance\x20Bot\x20update','socket.io','getHours','/on\x20-\x20start\x20bot(s)\x0a','createServer','getSeconds','Unauthorized\x20attempt\x20to\x20show\x20configuration','yargs/yargs','slice','all','exchange','fork','\x20(1)','Unauthorized\x20attempt\x20to\x20add\x20bot','running','Login\x20rejected','/:bot/coins','sendMetricsTelegram','loginRequired','max','verify','backup-full.zip','restore-backup-file','reinstall','http','min','<b>Telegram\x20Bot\x20Status:</b>\x0a','mode','api-eu.mixpanel.com','Failed\x20to\x20download\x20','2FA','sign','length','includes','SIGTERM','bbvReceive','index.html','storeConfiguration','bot.js','botmanager','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','range','-performance.json','Session\x20expired\x20for\x20user\x20...','pidRefreshToken','stop','Invalid\x20Telegram\x20token','Unauthorized\x20attempt\x20to\x20download\x20','Notifications\x20enabled'];_0x5d88=function(){return _0x2b19a3;};return _0x5d88();}function emitMessages(){const _0x12c47b=_0xd8b866,_0x2d9338=settings[_0x12c47b(0x181)];let _0x308ba0=[];newMessages[_0x12c47b(0x174)](_0x104a1d=>{const _0x2f3c28=_0x12c47b;_0x104a1d[_0x2f3c28(0xa2)]>_0x2d9338&&_0x308ba0[_0x2f3c28(0x162)](_0x104a1d);}),_0x308ba0[_0x12c47b(0x1d8)]>0x0&&getAllClients()[_0x12c47b(0x174)](_0xb81516=>{const _0x247fec=_0x12c47b;getSocket(_0xb81516['id'])[_0x247fec(0xd8)](_0x247fec(0x103),_0x308ba0);});}function confirmMessage(_0x9ebd28){updateSetting('lastmsgemitted',Number(_0x9ebd28));}function isNewerVersion(_0x3c1911,_0x4ecc22){const _0x16b956=_0xd8b866,_0x52a4b5=_0x4ecc22[_0x16b956(0x23b)]('.'),_0x159f3a=_0x3c1911[_0x16b956(0x23b)]('.');for(var _0x36fa6d=0x0;_0x36fa6d<_0x159f3a['length'];_0x36fa6d++){const _0x5eeb37=~~_0x159f3a[_0x36fa6d],_0x27995f=~~_0x52a4b5[_0x36fa6d];if(_0x5eeb37>_0x27995f)return!![];if(_0x5eeb37<_0x27995f)return![];}return![];}function toTelegramMarkdown(_0x20e5e4){const _0x903260=_0xd8b866,_0x207d79=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x22aaec=/\*{2}(.+?)\*{2}/gim;return _0x20e5e4=_0x20e5e4['replace'](_0x207d79,_0x903260(0x1aa))[_0x903260(0xed)](_0x22aaec,_0x903260(0x13f)),_0x20e5e4;}async function validateConfigFile(){const _0x20664d=_0xd8b866,_0x1cfb17=dbConfig[_0x20664d(0x225)]('bots')[_0x20664d(0xbd)]('botID')['value']()||[];if(_0x1cfb17[_0x20664d(0x1d8)]==0x0){let _0x1d17bc=0x0,_0x2ec05d=[];const _0x5c55eb=/^bot-([0-9]{3})-config.json$/,_0x5836c1=fs[_0x20664d(0x16c)](configpath);_0x5836c1[_0x20664d(0x174)](_0x2872ee=>{const _0x4abcb1=_0x20664d,_0x43a3f2=_0x5c55eb['exec'](_0x2872ee);if(_0x43a3f2){const _0x293961=_0x43a3f2[0x1];let _0x2c0d9c=getBotAttributes(_0x293961);_0x2ec05d[_0x4abcb1(0x162)]({'botID':_0x293961,'botname':_0x2c0d9c[_0x4abcb1(0x1f3)],'status':_0x4abcb1(0xb3),'live':'stopped'}),_0x1d17bc++;}}),_0x1d17bc!=0x0&&(dbConfig[_0x20664d(0x225)](_0x20664d(0x133))[_0x20664d(0x10a)](_0x2ec05d)[_0x20664d(0x223)](),config=_0x2ec05d,restoredConfigFile=_0x1d17bc);}}async function restoreConfigNotify(_0x1822c9){const _0x13e109=_0xd8b866;let _0x4366e5;if(restoredConfigFile==0x1)_0x4366e5=_0x13e109(0xc7);else _0x4366e5='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x1822c9)io['to']('botmanager')[_0x13e109(0xd8)]('notification',_0x4366e5);else{logger['simple'](_0x13e109(0x24a)),logger[_0x13e109(0x21a)](_0x4366e5),logger[_0x13e109(0x21a)]('-----------------------------------------------------------------------------------'),logger[_0x13e109(0x21a)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x13e109(0x219)]!=_0x13e109(0x233))tgBot['sendMessage'](settings[_0x13e109(0x20f)],_0x13e109(0x259)+_0x4366e5)[_0x13e109(0x248)](_0x133534=>{telegramError(_0x133534);});}}function validateCredentials(_0x146f73,_0x272bf0){const _0x57986a=_0xd8b866;if(_0x146f73[_0x57986a(0xcd)]==settings['bbUsername']&&bcrypt['compareSync'](_0x146f73['password'],settings[_0x57986a(0x11a)])){if(settings[_0x57986a(0x199)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x28ca06=generateLoginToken(_0x272bf0);return{'allow':!![],'reason':_0x57986a(0x222),'token':_0x28ca06};}}else return{'allow':![],'reason':_0x57986a(0x119),'token':null};}function refreshToken(_0x4c437b){const _0x38a79b=_0xd8b866,_0x3e84b9=generateLoginToken(_0x4c437b);return{'allow':!![],'reason':_0x38a79b(0x222),'token':_0x3e84b9};}function validateAccess(_0x202eb6,_0x383301,_0x2667eb){const _0x455a8d=_0xd8b866,_0x2a62e0=_0x2667eb?_0x2667eb:devices[_0x383301]['ip'];let _0xa330ad;const _0x404fc7=_0xc6523d=>{const _0x1e656f=_0x3062;if(settings[_0x1e656f(0x1ca)]){if(settings[_0x1e656f(0x199)]){if(telegram2FaApproved(_0x383301)){const _0x38285f=generateLoginToken(_0x383301);return{'allow':!![],'reason':_0x1e656f(0x144),'token':_0x38285f};}else return{'allow':![],'reason':_0x1e656f(0x175),'token':null};}else return _0xa330ad=validToken(_0xc6523d,_0x383301),_0xa330ad[_0x1e656f(0x87)](_0x1e656f(0xaa))?{'allow':!![],'reason':_0x1e656f(0x23e),'token':_0xc6523d}:{'allow':![],'reason':_0x1e656f(0x175),'token':null};}else return{'allow':!![],'reason':_0x1e656f(0x132),'token':null};};if(settings[_0x455a8d(0x121)]){let _0x476d4f=[...settings[_0x455a8d(0xef)],_0x455a8d(0xd3),'::ffff:127.0.0.1',_0x455a8d(0xa1)];if(_0x476d4f[_0x455a8d(0x1d9)](_0x2a62e0))return _0x404fc7(_0x202eb6);else{_0xa330ad=validToken(_0x202eb6,_0x383301);if(_0xa330ad[_0x455a8d(0x87)](_0x455a8d(0xaa)))return _0x404fc7(_0x202eb6);else{if(telegramIpApproved(_0x383301)){const _0x2cbabb=generateToken(_0x383301);return _0xa330ad=_0x404fc7(_0x202eb6),_0xa330ad[_0x455a8d(0x143)]?{'allow':!![],'reason':_0x455a8d(0xa4),'token':_0x2cbabb}:_0xa330ad;}else return settings[_0x455a8d(0xc6)]?{'allow':![],'reason':_0x455a8d(0x1b0),'token':null}:{'allow':![],'reason':_0x455a8d(0x254),'token':null};}}}else return _0x404fc7(_0x202eb6);}function timelyDecrypt(_0x4aeafc,_0x51c7c3=!![]){const _0xac8854=_0xd8b866;if(_0x4aeafc)try{const _0x172188=crypt['decrypt'](secure[_0xac8854(0xeb)],_0x4aeafc)['message'],_0x22a4ef=_0x172188[_0xac8854(0x23b)]('@')[0x0],_0x3f83b2=_0x172188[_0xac8854(0x23b)]('@')[0x1],_0x1a2543=new Date()['getTime']();if(_0x51c7c3){if(_0x1a2543-_0x3f83b2<maxSecretAge*0x3e8)return _0x22a4ef;else return![];}else return _0x22a4ef;}catch(_0x3dbcce){return![];}else return![];}const validToken=(_0x529611,_0x4f3058)=>{const _0x1118a2=_0xd8b866,_0x852e71=devices[_0x4f3058]['ip'];if(!_0x529611)return{'error':_0x1118a2(0x22c)};for(let _0x431c16 of blacklist){if(_0x431c16[_0x1118a2(0x1a1)]==_0x529611)return{'error':_0x1118a2(0xd9)};}let _0x3b943f;try{_0x3b943f=jwt[_0x1118a2(0x1cc)](_0x529611,secure[_0x1118a2(0x21d)]+_0x4f3058);}catch{return{'error':_0x1118a2(0xb9)};}if(!_0x3b943f[_0x1118a2(0x87)](_0x1118a2(0x1f9))&&!_0x3b943f[_0x1118a2(0x87)](_0x1118a2(0xcd))||!_0x3b943f[_0x1118a2(0x87)](_0x1118a2(0x25a)))return{'error':_0x1118a2(0x118)};if(!_0x3b943f[_0x1118a2(0x87)](_0x1118a2(0xcd))&&_0x3b943f['hasOwnProperty'](_0x1118a2(0x1f9))){const {clientip:_0x401a4f}=_0x3b943f;return _0x852e71==_0x401a4f?{'success':_0x1118a2(0x1f4)}:{'error':_0x1118a2(0x13b)};}else{if(_0x3b943f[_0x1118a2(0x87)](_0x1118a2(0xcd))&&_0x3b943f[_0x1118a2(0x87)](_0x1118a2(0x1f9))){const {username:_0x49eaee,clientip:_0x139dc5}=_0x3b943f;return settings[_0x1118a2(0x207)]==_0x49eaee&&_0x852e71==_0x139dc5?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x1118a2(0x244)};}}},generateLoginToken=_0x25d32a=>{const _0xd108d7=_0xd8b866;if(_0x25d32a){const _0x590ebd=devices[_0x25d32a]['ip'];return jwt[_0xd108d7(0x1d7)]({'username':settings[_0xd108d7(0x207)],'clientip':_0x590ebd},secure[_0xd108d7(0x21d)]+_0x25d32a,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x422d15=>{const _0x30921b=_0xd8b866;if(_0x422d15){const _0x226ba9=devices[_0x422d15]['ip'];return jwt[_0x30921b(0x1d7)]({'clientip':_0x226ba9},secure[_0x30921b(0x21d)]+_0x422d15,{'expiresIn':devices[_0x422d15][_0x30921b(0x232)][_0x30921b(0xe9)]*0x3c});}else return![];},telegramIpApproved=_0x1cfb4c=>{const _0x141030=_0xd8b866;let _0x293497=![];return devices[_0x1cfb4c][_0x141030(0x232)]&&devices[_0x1cfb4c][_0x141030(0x232)][_0x141030(0xe9)]!=_0x141030(0xf3)&&(_0x293497=devices[_0x1cfb4c][_0x141030(0x232)][_0x141030(0x1f9)]==devices[_0x1cfb4c]['ip']&&new Date()[_0x141030(0x226)]()-devices[_0x1cfb4c][_0x141030(0x232)][_0x141030(0x213)]<devices[_0x1cfb4c][_0x141030(0x232)]['expiry']*0x3c*0x3e8),_0x293497;},telegram2FaApproved=_0x147f89=>{const _0x5f2f16=_0xd8b866;let _0x45d548=![];return devices[_0x147f89][_0x5f2f16(0xea)]&&devices[_0x147f89][_0x5f2f16(0xea)]['expiry']!=_0x5f2f16(0xf3)&&(_0x45d548=devices[_0x147f89][_0x5f2f16(0xea)][_0x5f2f16(0x1f9)]==devices[_0x147f89]['ip']&&new Date()['getTime']()-devices[_0x147f89][_0x5f2f16(0xea)][_0x5f2f16(0x213)]<devices[_0x147f89]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x45d548;},normalizeIP=_0x1d6fd0=>{const _0x1c7d1b=_0xd8b866;let _0x413715=null,_0xa30b9=null;if(ipaddr[_0x1c7d1b(0x204)](_0x1d6fd0)){const _0x6c2a42=ipaddr[_0x1c7d1b(0x193)](_0x1d6fd0);_0x6c2a42['kind']()===_0x1c7d1b(0xec)?(_0x6c2a42['isIPv4MappedAddress']()&&(_0x413715=_0x6c2a42[_0x1c7d1b(0x1eb)]()[_0x1c7d1b(0x19f)]()),_0xa30b9=_0x6c2a42[_0x1c7d1b(0x19f)]()):(_0x413715=_0x6c2a42['toString'](),_0xa30b9=_0x6c2a42[_0x1c7d1b(0x101)]()[_0x1c7d1b(0x19f)]());}return{'show':_0x413715?_0x413715:_0xa30b9,'store':_0xa30b9};};function formatDate(_0x1d90c6){const _0x37d80a=_0xd8b866;return _0x1d90c6[_0x37d80a(0x1a3)]()+'/'+(_0x1d90c6['getMonth']()+0x1)[_0x37d80a(0x19f)]()[_0x37d80a(0x15e)](0x2,'0')+'/'+_0x1d90c6['getDate']()['toString']()[_0x37d80a(0x15e)](0x2,'0')+'\x20'+_0x1d90c6[_0x37d80a(0x1ba)]()[_0x37d80a(0x19f)]()[_0x37d80a(0x15e)](0x2,'0')+':'+_0x1d90c6[_0x37d80a(0x131)]()[_0x37d80a(0x19f)]()[_0x37d80a(0x15e)](0x2,'0')+':'+_0x1d90c6[_0x37d80a(0x1bd)]()[_0x37d80a(0x19f)]()[_0x37d80a(0x15e)](0x2,'0');}function sleep(_0x557d27){return new Promise(_0x7aebe0=>setTimeout(_0x7aebe0,_0x557d27));}