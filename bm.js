const _0x3b18e3=_0x4830;(function(_0x43a71b,_0x3699f7){const _0x15a1b0=_0x4830,_0x3c53e5=_0x43a71b();while(!![]){try{const _0xfef95e=-parseInt(_0x15a1b0(0xe0))/0x1*(parseInt(_0x15a1b0(0xee))/0x2)+-parseInt(_0x15a1b0(0x11d))/0x3+-parseInt(_0x15a1b0(0x24e))/0x4+-parseInt(_0x15a1b0(0x28f))/0x5+-parseInt(_0x15a1b0(0x1e4))/0x6*(-parseInt(_0x15a1b0(0x23b))/0x7)+parseInt(_0x15a1b0(0x248))/0x8+-parseInt(_0x15a1b0(0x1f8))/0x9*(-parseInt(_0x15a1b0(0x148))/0xa);if(_0xfef95e===_0x3699f7)break;else _0x3c53e5['push'](_0x3c53e5['shift']());}catch(_0x2194b4){_0x3c53e5['push'](_0x3c53e5['shift']());}}}(_0x5898,0x7455b));const _0x226f6a=function(){let _0x1d65ee=!![];return function(_0x524982,_0xb9d390){const _0x53f4ed=_0x1d65ee?function(){if(_0xb9d390){const _0xeeb809=_0xb9d390['apply'](_0x524982,arguments);return _0xb9d390=null,_0xeeb809;}}:function(){};return _0x1d65ee=![],_0x53f4ed;};}(),_0x104cb5=_0x226f6a(this,function(){const _0x5a5143=_0x4830;return _0x104cb5[_0x5a5143(0xbe)]()['search'](_0x5a5143(0x20a))[_0x5a5143(0xbe)]()['constructor'](_0x104cb5)[_0x5a5143(0x19c)](_0x5a5143(0x20a));});_0x104cb5();'use strict';process[_0x3b18e3(0x10a)][_0x3b18e3(0x27f)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x3b18e3(0x1c8)),low=require(_0x3b18e3(0x260)),FileSync=require(_0x3b18e3(0x1fd)),path=require(_0x3b18e3(0x1c7)),crypto=require(_0x3b18e3(0x271)),forge=require(_0x3b18e3(0xdd)),bcrypt=require(_0x3b18e3(0x193)),jwt=require(_0x3b18e3(0x28e)),ipaddr=require(_0x3b18e3(0xc6)),argv=require(_0x3b18e3(0x27d))(process['argv'][_0x3b18e3(0x175)](0x2))['argv'],uuidRandom=require(_0x3b18e3(0x263)),{Telegraf,Markup}=require(_0x3b18e3(0x105)),Mixpanel=require(_0x3b18e3(0x197)),axios=require(_0x3b18e3(0x208)),{GraphQLClient,gql}=require(_0x3b18e3(0xe8)),util=require('util'),fileUpload=require(_0x3b18e3(0x284)),{networkInterfaces}=require('os'),JSZip=require('jszip'),PORT=argv[_0x3b18e3(0x239)]||_0x3b18e3(0x11e),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console['log'](_0x3b18e3(0x209)+PORT+_0x3b18e3(0x1f5)),process['exit'](0x1));const HOST=argv[_0x3b18e3(0x1d9)]||null,userID=argv[_0x3b18e3(0x1da)]||'',debugging=argv['d']||![],nodeversion=process[_0x3b18e3(0xe3)][_0x3b18e3(0x1d3)];let bbpath=_0x3b18e3(0xbb),bbpath2='';const botfile=_0x3b18e3(0x1cc),configfile='bb-config.json',settingsfile='bb-settings.json',securefile=_0x3b18e3(0x170),environment=require('./'+bbpath2+'version.json')[_0x3b18e3(0x101)]||_0x3b18e3(0x155),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x3b18e3(0x16a)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3b18e3(0x1a2)),configpath=userID?bbpath+_0x3b18e3(0x153)+userID+'/':bbpath+_0x3b18e3(0x153),configbackuppath=configpath+_0x3b18e3(0x26c),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x3b18e3(0x19f),zippath=userID?bbpath+_0x3b18e3(0x18c)+userID+'/':bbpath+_0x3b18e3(0x18c),loggerfile=fs[_0x3b18e3(0xd2)](logspath+_0x3b18e3(0x1ec),{'flags':'a'}),temppath=userID?bbpath+_0x3b18e3(0x173)+userID+'/':bbpath+_0x3b18e3(0x173);!fs[_0x3b18e3(0x16a)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x3b18e3(0x16a)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs['existsSync'](logspath)&&fs['mkdirSync'](logspath);!fs[_0x3b18e3(0x16a)](zippath)&&fs[_0x3b18e3(0x1db)](zippath);!fs[_0x3b18e3(0x16a)](temppath)&&fs[_0x3b18e3(0x1db)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x3b18e3(0x291)]({'bots':[]})[_0x3b18e3(0xd8)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x3b18e3(0xd8)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x3b18e3(0x291)]({'secure':{},'blacklist':[]})[_0x3b18e3(0xd8)]();const saltRounds=0xa,mixpanel=Mixpanel['init']('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x3b18e3(0x226)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x3b18e3(0x99)]&&(settings['telegramToken']!=''&&settings[_0x3b18e3(0x99)]!=_0x3b18e3(0x133))&&settings['telegramUsername']&&settings[_0x3b18e3(0x26a)]!='')initTelegram();const parseColor=(_0x219360,_0x56388b)=>{const _0x245402=_0x3b18e3,_0x3eaf2a=/#[A-Z]{3}#/g;if(typeof _0x219360==_0x245402(0xa3)){!_0x56388b?_0x219360=_0x219360[_0x245402(0x1e9)](_0x3eaf2a,''):(_0x219360=_0x219360[_0x245402(0x1e9)](/#BLU#/g,_0x245402(0xc2)),_0x219360=_0x219360[_0x245402(0x1e9)](/#RED#/g,_0x245402(0x212)),_0x219360=_0x219360['replace'](/#YEL#/g,_0x245402(0x1d6)),_0x219360=_0x219360['replace'](/#MAG#/g,_0x245402(0xb7)),_0x219360=_0x219360[_0x245402(0x1e9)](/#CYA#/g,_0x245402(0x1dd)),_0x219360=_0x219360[_0x245402(0x1e9)](/#RES#/g,_0x245402(0xbc)));;}return _0x219360;},logger={'screen':_0x5638b1=>{const _0x2e118e=_0x3b18e3;console[_0x2e118e(0x139)](parseColor(_0x5638b1,!![]));},'simple':_0x587472=>{const _0x7a8f28=_0x3b18e3;console[_0x7a8f28(0x139)](parseColor(_0x587472,!![])),loggerfile[_0x7a8f28(0xd8)](util[_0x7a8f28(0x143)](parseColor(_0x587472,![]))+'\x0a');},'full':async _0x2995d0=>{const _0x162a33=_0x3b18e3,_0xe9a206=getTimeStamp()+_0x162a33(0x14a)+_0x2995d0;console[_0x162a33(0x139)](parseColor(_0xe9a206,!![])),loggerfile['write'](util[_0x162a33(0x143)](parseColor(_0xe9a206,![]))+'\x0a');if(tgBot&&settings[_0x162a33(0xf7)]&&settings[_0x162a33(0x177)]!=_0x162a33(0x27b))await sendTelegram(settings[_0x162a33(0xf7)],_0x162a33(0x18a)+parseColor(_0x2995d0,![]));},'debug':async(_0x1706d1,_0x4d7baf='')=>{const _0x221c9d=_0x3b18e3,_0x42d7e6=getTimeStamp()+_0x221c9d(0x126)+_0x1706d1;if(debugging)console['log'](parseColor(_0x42d7e6,!![]));loggerfile[_0x221c9d(0xd8)](util[_0x221c9d(0x143)](parseColor(_0x42d7e6,![]))+'\x0a');if(_0x4d7baf){if(debugging)console[_0x221c9d(0x139)](_0x4d7baf);loggerfile[_0x221c9d(0xd8)](util[_0x221c9d(0x143)](_0x4d7baf)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x3d5ae1){const _0x239cab=_0x3b18e3;_0x3d5ae1[_0x239cab(0xbe)]()[_0x239cab(0x275)]('address\x20already\x20in\x20use')?(logger['simple'](_0x239cab(0x14e)+_0x3d5ae1[_0x239cab(0x239)]+_0x239cab(0x204)),process['send']({'terminate':!![]},_0x45ee21=>{})):logger['simple'](_0x3d5ae1);}),process['on'](_0x3b18e3(0xdf),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x3b18e3(0xd0),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x3b18e3(0xe6),()=>{const _0x508310=_0x3b18e3;stopAllBots(),process[_0x508310(0xdf)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x3b18e3(0x12f))[_0x3b18e3(0x176)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x3b18e3(0x159))['createServer'](app);app[_0x3b18e3(0xa2)](fileUpload({'useTempFiles':!![]})),app[_0x3b18e3(0x1be)](_0x3b18e3(0x1c5),async(_0xe38e9d,_0x4c64b3)=>{const _0x12ea93=_0x3b18e3,_0x5565bf=_0xe38e9d['params']['type'],_0x2e1994=getClientsWithBotID(_0x12ea93(0x13d)),_0x474e46=_0xe38e9d[_0x12ea93(0x1ed)][_0x12ea93(0x14b)],_0x2c2ad7=timelyDecrypt(_0x474e46,![]),_0x5655f2=_0x2e1994[_0x12ea93(0x26e)](_0xad2561=>_0xad2561[_0x12ea93(0x14b)]==_0x2c2ad7);if(_0x5655f2){const _0x381235=normalizeIP(_0xe38e9d['socket'][_0x12ea93(0x261)])[_0x12ea93(0x21a)],_0x483b18=_0xe38e9d[_0x12ea93(0x1ed)][_0x12ea93(0x1b5)];if(validateAccess(_0x483b18,_0x2c2ad7,_0x381235)[_0x12ea93(0x199)])_0x5565bf==_0x12ea93(0xef)&&await backupConfigFiles(),await zipFiles(_0x5565bf),_0x4c64b3[_0x12ea93(0x1bf)](zippath+(_0x5565bf+_0x12ea93(0x17c)),_0x19568d=>{const _0x36e656=_0x12ea93;_0x19568d&&(logger[_0x36e656(0x12b)](_0x36e656(0xea)+_0x5565bf),logger[_0x36e656(0x25d)](_0x19568d));});else logger[_0x12ea93(0x12b)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x5565bf+_0x12ea93(0x190));}else logger[_0x12ea93(0x12b)](_0x12ea93(0xb2)+_0x5565bf+_0x12ea93(0x108));}),app['post'](_0x3b18e3(0x1e3),async(_0x51bc0e,_0x3d7dd9)=>{const _0x5e40b2=_0x3b18e3,_0x1cf38c=getClientsWithBotID(_0x5e40b2(0x13d)),_0x4dd471=_0x51bc0e[_0x5e40b2(0x1ed)]['uuid'],_0x4ed051=timelyDecrypt(_0x4dd471,![]),_0x52f432=_0x1cf38c[_0x5e40b2(0x26e)](_0x2448bd=>_0x2448bd['uuid']==_0x4ed051);logger[_0x5e40b2(0xbf)](_0x5e40b2(0x1aa));if(_0x52f432){const _0x587d54=normalizeIP(_0x51bc0e['socket'][_0x5e40b2(0x261)])['store'],_0x438651=_0x51bc0e[_0x5e40b2(0x1ed)]['tkn'];if(validateAccess(_0x438651,_0x4ed051,_0x587d54)['allow']){if(_0x51bc0e[_0x5e40b2(0x211)]){const _0x1a87c3=_0x51bc0e['files'][_0x5e40b2(0x97)];await _0x1a87c3['mv'](temppath+_0x1a87c3[_0x5e40b2(0x231)]),_0x3d7dd9[_0x5e40b2(0x1ab)]({'status':!![],'message':_0x5e40b2(0x276)});const _0x4f91a4=getBotsWithMode();_0x4f91a4[_0x5e40b2(0x144)]>0x0?confirmRestore(temppath,_0x1a87c3[_0x5e40b2(0x231)]):unzipFile(temppath,_0x1a87c3[_0x5e40b2(0x231)]);}}else logger['full'](_0x5e40b2(0x16d));}else logger[_0x5e40b2(0x12b)](_0x5e40b2(0x195));}),app[_0x3b18e3(0xa2)](express[_0x3b18e3(0x1ae)](path[_0x3b18e3(0x13b)](__dirname,bbpath2,_0x3b18e3(0x1fa)))),app[_0x3b18e3(0xa2)](express['static'](path[_0x3b18e3(0x13b)](__dirname,bbpath2,'build'))),app['get']('/',function(_0x31d63b,_0x36d2a6){const _0x500734=_0x3b18e3;_0x36d2a6[_0x500734(0x12d)](path[_0x500734(0x13b)](__dirname,bbpath2,_0x500734(0x1fa),'index.html'));}),app[_0x3b18e3(0x1be)]('/:bot',function(_0x51c074,_0x1bd3d6){const _0x5c9056=_0x3b18e3;_0x1bd3d6[_0x5c9056(0x12d)](path[_0x5c9056(0x13b)](__dirname,bbpath2,_0x5c9056(0x113),_0x5c9056(0x2a2)));}),app[_0x3b18e3(0x1be)](_0x3b18e3(0x1d8),(_0x4c5d14,_0x4309df)=>{const _0x5dbb48=_0x3b18e3;_0x4309df[_0x5dbb48(0x12d)](path[_0x5dbb48(0x13b)](__dirname,bbpath2,_0x5dbb48(0x113),'index.html'));}),app[_0x3b18e3(0x1be)](_0x3b18e3(0xda),(_0x16a2d6,_0x559db4)=>{const _0x1cc3df=_0x3b18e3;_0x559db4['sendFile'](path[_0x1cc3df(0x13b)](__dirname,bbpath2,_0x1cc3df(0x113),'index.html'));}),app[_0x3b18e3(0x1be)]('/:bot/coins',(_0x323d46,_0x9e984c)=>{const _0x36f7b6=_0x3b18e3;_0x9e984c[_0x36f7b6(0x12d)](path[_0x36f7b6(0x13b)](__dirname,bbpath2,_0x36f7b6(0x113),_0x36f7b6(0x2a2)));}),app['get'](_0x3b18e3(0x218),(_0x4907dc,_0xb79906)=>{const _0x353e65=_0x3b18e3;_0xb79906[_0x353e65(0x12d)](path[_0x353e65(0x13b)](__dirname,bbpath2,'build',_0x353e65(0x2a2)));}),app[_0x3b18e3(0x1be)](_0x3b18e3(0x233),(_0x3c3c70,_0x1887c8)=>{const _0x5ec377=_0x3b18e3;_0x1887c8[_0x5ec377(0x12d)](path[_0x5ec377(0x13b)](__dirname,bbpath2,_0x5ec377(0x113),_0x5ec377(0x2a2)));}),app[_0x3b18e3(0x1be)](_0x3b18e3(0x146),(_0x39857e,_0x1e76bf)=>{const _0x891f2e=_0x3b18e3;_0x1e76bf['sendFile'](path[_0x891f2e(0x13b)](__dirname,bbpath2,_0x891f2e(0x113),_0x891f2e(0x2a2)));});if(HOST)http[_0x3b18e3(0x264)](PORT,HOST);else http['listen'](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x45b014=_0x3b18e3;let _0x4cada0=_0x45b014(0xc1);const _0x42e42d=networkInterfaces(),_0x954900={};for(const _0x2f9988 of Object['keys'](_0x42e42d)){for(const _0x182792 of _0x42e42d[_0x2f9988]){if((_0x182792[_0x45b014(0x26d)]=='IPv4'||_0x182792[_0x45b014(0x26d)]==0x4)&&!_0x182792[_0x45b014(0x205)]){const _0x36c3fa=ipaddr[_0x45b014(0xc9)](_0x182792[_0x45b014(0x1ce)])[_0x45b014(0x9b)]();_0x36c3fa!='private'&&(!_0x954900[_0x2f9988]&&(_0x954900[_0x2f9988]=[]),_0x954900[_0x2f9988]['push'](_0x182792[_0x45b014(0x1ce)]),_0x4cada0=_0x182792[_0x45b014(0x1ce)]);}}}return{'serverip':_0x4cada0,'netinterfaces':_0x954900};}async function startServer(){const _0x57650f=_0x3b18e3,{serverip:_0x11e04f,netinterfaces:_0x2e3dfa}=getServerIP();logger[_0x57650f(0x25d)](''),logger['simple'](_0x57650f(0xf2)),await logger[_0x57650f(0x12b)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x57650f(0xad)+(environment=='staging'?'(staging)':'')+'\x0a'+(_0x57650f(0x22a)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+('=>\x20Go\x20to\x20#CYA#http://'+_0x11e04f+':'+PORT+_0x57650f(0x24d))),logger[_0x57650f(0x25d)](_0x57650f(0xf2));if(config['length']!=0x0)for(const _0x3ab19f of config){const _0x3879c7=_0x3ab19f[_0x57650f(0x1c4)]==_0x57650f(0xe5)?'a':'m';if(_0x3ab19f['status']=='enabled'||_0x3ab19f[_0x57650f(0x22c)]==_0x57650f(0x17e))await logger[_0x57650f(0x12b)]('Starting\x20('+_0x3879c7+_0x57650f(0x258)+_0x3ab19f[_0x57650f(0x9a)]+_0x57650f(0x255)+_0x3ab19f[_0x57650f(0x1fb)]),startBot([_0x3ab19f[_0x57650f(0x9a)],userID],{'cwd':bbpath},function(_0x3efa48){const _0x1eec9f=_0x57650f;if(_0x3efa48)logger[_0x1eec9f(0x12b)](_0x3efa48);});else(_0x3ab19f[_0x57650f(0x22c)]=='disabled'||_0x3ab19f['status']==_0x57650f(0x134))&&await logger[_0x57650f(0x12b)](_0x57650f(0x17d)+_0x3879c7+_0x57650f(0x290)+_0x3ab19f[_0x57650f(0x9a)]+_0x57650f(0x255)+_0x3ab19f[_0x57650f(0x1fb)]);}else!newBot&&logger['simple'](_0x57650f(0x174));if(newBot)addBot();logger[_0x57650f(0x25d)](_0x57650f(0xf2)),logger[_0x57650f(0x25d)](''),await logger[_0x57650f(0xbf)](_0x57650f(0x23d)+nodeversion),await logger['debug']('Network\x20Interfaces:',_0x2e3dfa);}function startSocket(){io['on']('connection',_0x27cb2f=>{const _0x3d2902=_0x4830;let _0x59b9c1,_0x52ea94,_0x568f90,_0x28f101,_0x4406d5;const _0x583957=_0x27cb2f['handshake']['headers'][_0x3d2902(0x202)];_0x52ea94=_0x583957['match'](/bot[0-9]{3}/);if(_0x52ea94)_0x568f90=_0x52ea94[0x0][_0x3d2902(0x171)](/[0-9]{3}/);if(_0x568f90)_0x59b9c1=_0x568f90[0x0];else _0x59b9c1=_0x3d2902(0x13d);const _0x5267fc=_0x27cb2f['handshake'][_0x3d2902(0x156)][_0x3d2902(0x10f)];if(!_0x5267fc)_0x27cb2f[_0x3d2902(0x215)](_0x3d2902(0x22c),{'publicKey':secure[_0x3d2902(0xde)]});else{_0x28f101=timelyDecrypt(_0x5267fc,![]);if(!_0x28f101)_0x27cb2f['emit'](_0x3d2902(0x22c),{'publicKey':secure[_0x3d2902(0xde)]});else{_0x4406d5=normalizeIP(_0x27cb2f['conn'][_0x3d2902(0x261)])['store'];if(!devices[_0x28f101])devices[_0x28f101]={'uuid':_0x28f101,'access':{'token':null}};devices[_0x28f101]['ip']=_0x4406d5;const _0x4dff66=addClient(_0x27cb2f['id'],_0x28f101,_0x59b9c1);setAccess(_0x4dff66),emitMessages(),_0x27cb2f['on']('login',_0x1e5f9f=>{const _0x572b8f=_0x3d2902,_0x2f391b=timelyDecrypt(_0x1e5f9f[_0x572b8f(0x11a)],!![],_0x572b8f(0x147));if(_0x2f391b){_0x1e5f9f={'username':_0x1e5f9f[_0x572b8f(0x16f)],'password':_0x2f391b},devices[_0x28f101][_0x572b8f(0x117)]=validateCredentials(_0x1e5f9f,_0x28f101);if(devices[_0x28f101][_0x572b8f(0x117)][_0x572b8f(0x199)]==![]&&devices[_0x28f101]['access'][_0x572b8f(0xcd)]==_0x572b8f(0x277))_0x27cb2f['emit']('status',{'access':devices[_0x28f101][_0x572b8f(0x117)]}),loginAccess2FA(_0x28f101,_0x4406d5);else{if(devices[_0x28f101][_0x572b8f(0x117)][_0x572b8f(0x199)]==![]&&devices[_0x28f101]['access']['reason']==_0x572b8f(0x20e))_0x27cb2f[_0x572b8f(0x215)]('status',{'access':devices[_0x28f101][_0x572b8f(0x117)]});else devices[_0x28f101]['access']['allow']&&devices[_0x28f101]['access'][_0x572b8f(0xcd)]==_0x572b8f(0xfe)&&(getClientsWithUuid(_0x28f101)[_0x572b8f(0x1b9)](_0x67e8b0=>{setAccess(_0x67e8b0);}),logger[_0x572b8f(0xbf)](_0x572b8f(0x172)+_0x28f101[_0x572b8f(0x175)](-0x8)),setTokenRefresh(_0x28f101),setSessionTimeout(_0x572b8f(0x163),_0x28f101));}}else logger[_0x572b8f(0x12b)](_0x572b8f(0x183));}),_0x27cb2f['on'](_0x3d2902(0x2a3),()=>{resetPassword();}),_0x27cb2f['on'](_0x3d2902(0x1ef),_0xd325dc=>{removeClient(_0x27cb2f['id']);}),_0x59b9c1==_0x3d2902(0x13d)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x18d77c){const _0x138579=_0x3b18e3;if(_0x18d77c!='botmanager'&&config[_0x138579(0x21f)]!=''){if(pid[_0x18d77c])pid[_0x18d77c]['send']({'function':'initclient','args':null});}_0x18d77c!=_0x138579(0x13d)&&broadcastToBots(_0x138579(0x118),JSON['stringify'](config));}function reloadBotManager(){const _0x129983=_0x3b18e3;getClientsWithBotID(_0x129983(0x13d))[_0x129983(0x1b9)](_0x357643=>{const _0x473c2f=_0x129983;getSocket(_0x357643['id'])[_0x473c2f(0x215)]('status',{'access':{'allow':![],'reason':_0x473c2f(0x1a8),'token':null}});});}function getSocket(_0x1be2e4){const _0x293565=_0x3b18e3,_0x18fb1d=io[_0x293565(0x169)][_0x293565(0x1be)]('/');return _0x18fb1d[_0x293565(0xf4)][_0x293565(0x1be)](_0x1be2e4);}function setAccess(_0x4f6188){const _0x47d8c3=_0x3b18e3,_0x217221=getSocket(_0x4f6188['id']),_0xd7d88f=_0x4f6188['uuid'],_0x3dde54=_0x4f6188[_0x47d8c3(0x15c)];devices[_0xd7d88f][_0x47d8c3(0x117)]=validateAccess(devices[_0xd7d88f]['access'][_0x47d8c3(0x13c)],_0xd7d88f),logger[_0x47d8c3(0xbf)](_0x47d8c3(0x18b)+devices[_0xd7d88f][_0x47d8c3(0x117)][_0x47d8c3(0xcd)]+_0x47d8c3(0x288)+_0x4f6188['id'][_0x47d8c3(0x175)](-0x8)+'\x20|\x20user:\x20...'+_0xd7d88f[_0x47d8c3(0x175)](-0x8)),_0x217221['join'](_0xd7d88f);if(devices[_0xd7d88f][_0x47d8c3(0x117)][_0x47d8c3(0x199)]){_0x217221[_0x47d8c3(0x13b)](_0x3dde54);if(_0x3dde54==_0x47d8c3(0x13d))initializeSocketBotManager(_0x217221);else initializeSocketBot(_0x217221);initClient(_0x3dde54);}devices[_0xd7d88f]['access'][_0x47d8c3(0x13c)]&&devices[_0xd7d88f][_0x47d8c3(0x117)][_0x47d8c3(0xcd)]==_0x47d8c3(0x179)&&setSessionTimeout(_0x47d8c3(0x216),_0xd7d88f),devices[_0xd7d88f]['access']['token']&&devices[_0xd7d88f][_0x47d8c3(0x117)][_0x47d8c3(0xcd)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout('login',_0xd7d88f),_0x217221[_0x47d8c3(0x215)](_0x47d8c3(0x22c),{'status':_0x4f6188[_0x47d8c3(0x203)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xd7d88f][_0x47d8c3(0x117)],'externalip':devices[_0xd7d88f]['ip'],'publicKey':secure[_0x47d8c3(0xde)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0xd7d88f][_0x47d8c3(0x117)][_0x47d8c3(0x199)]==![]&&devices[_0xd7d88f]['access'][_0x47d8c3(0xcd)]=='2FA\x20required'&&temporaryAccess2FA(_0xd7d88f,devices[_0xd7d88f]['ip']);}function setSessionTimeout(_0x40dc62,_0x311847){const _0x1bcf3f=_0x3b18e3;let _0x234d38;if(_0x40dc62=='login')_0x234d38=loginExpiry*0x3c*0x3e8;else _0x234d38=devices[_0x311847][_0x1bcf3f(0x161)][_0x1bcf3f(0x9f)]*0x3c*0x3e8-(new Date()[_0x1bcf3f(0x124)]()-devices[_0x311847][_0x1bcf3f(0x161)][_0x1bcf3f(0x244)]);if(devices[_0x311847]['pidExpireLogin'])clearTimeout(devices[_0x311847][_0x1bcf3f(0x29f)]);devices[_0x311847][_0x1bcf3f(0x29f)]=setTimeout(()=>{const _0x81f934=_0x1bcf3f;if(devices[_0x311847]['pidRefreshToken'])clearTimeout(devices[_0x311847][_0x81f934(0x137)]);removeSocketListeners(_0x311847),addBlacklist(_0x311847),devices[_0x311847]['telegramIpApproval']=null,devices[_0x311847][_0x81f934(0x167)]=null,devices[_0x311847][_0x81f934(0x117)][_0x81f934(0x13c)]=null,logger[_0x81f934(0xbf)]('Session\x20expired\x20for\x20user\x20...'+_0x311847[_0x81f934(0x175)](-0x8)),devices[_0x311847]['access']=validateAccess(devices[_0x311847]['access'][_0x81f934(0x13c)],_0x311847),!(devices[_0x311847][_0x81f934(0x117)][_0x81f934(0x199)]&&devices[_0x311847][_0x81f934(0x117)][_0x81f934(0xcd)]==_0x81f934(0x136))&&(_0x40dc62==_0x81f934(0x163)?io['to'](_0x311847)['emit'](_0x81f934(0x22c),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x311847)[_0x81f934(0x215)](_0x81f934(0x22c),{'access':{'allow':![],'reason':_0x81f934(0x120),'token':null}})),devices[_0x311847]['access'][_0x81f934(0x13c)]=null;},_0x234d38);}function setTokenRefresh(_0x2c3104){const _0x2e6a28=_0x3b18e3;if(devices[_0x2c3104][_0x2e6a28(0x137)])clearTimeout(devices[_0x2c3104]['pidRefreshToken']);devices[_0x2c3104][_0x2e6a28(0x137)]=setTimeout(()=>{const _0x4b6841=_0x2e6a28;getClientsWithUuid(_0x2c3104)[_0x4b6841(0x144)]!=0x0?(devices[_0x2c3104]['access']=refreshToken(_0x2c3104),io['to'](_0x2c3104)[_0x4b6841(0x215)](_0x4b6841(0x22c),{'status':_0x4b6841(0x15a),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2c3104][_0x4b6841(0x117)],'externalip':devices[_0x2c3104]['ip'],'publicKey':secure[_0x4b6841(0xde)],'validInstallation':validInstallation}),setTokenRefresh(_0x2c3104)):clearTimeout(devices[_0x2c3104][_0x4b6841(0x137)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x424a98){const _0x406fa4=_0x3b18e3,_0xab6cc2=getClient(_0x424a98['id'])[_0x406fa4(0x14b)];_0x424a98[_0x406fa4(0x215)](_0x406fa4(0x118),config),_0x424a98[_0x406fa4(0x215)]('settings',cleanSettings()),_0x424a98['on'](_0x406fa4(0xca),_0x3543cf=>{const _0x494025=_0x406fa4;if(validateAccess(_0x3543cf,_0xab6cc2)[_0x494025(0x199)])addBot();else logger['full'](_0x494025(0x116));}),_0x424a98['on'](_0x406fa4(0xbd),(_0x1e8993,_0x5f52db)=>{const _0x488816=_0x406fa4;if(validateAccess(_0x5f52db,_0xab6cc2)[_0x488816(0x199)])toggleBot(_0x1e8993[_0x488816(0x9a)],_0x1e8993[_0x488816(0x22c)],_0x1e8993[_0x488816(0x182)]);else logger[_0x488816(0x12b)](_0x488816(0x19a));}),_0x424a98['on'](_0x406fa4(0x259),(_0x4a0752,_0x8bf3d5)=>{const _0x3b93fe=_0x406fa4;if(validateAccess(_0x8bf3d5,_0xab6cc2)[_0x3b93fe(0x199)])toggleBotMode(_0x4a0752);else logger[_0x3b93fe(0x12b)](_0x3b93fe(0x19a));}),_0x424a98['on'](_0x406fa4(0x201),(_0x1fd063,_0x1a40a7)=>{const _0x11a911=_0x406fa4;if(validateAccess(_0x1a40a7,_0xab6cc2)[_0x11a911(0x199)])deleteBot(_0x1fd063);else logger[_0x11a911(0x12b)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x424a98['on'](_0x406fa4(0x152),(_0x28b978,_0x507441)=>{const _0x511a2f=_0x406fa4;if(validateAccess(_0x507441,_0xab6cc2)['allow'])storeSettings(_0x28b978,!![]);else logger[_0x511a2f(0x12b)](_0x511a2f(0x149));}),_0x424a98['on'](_0x406fa4(0xdc),_0x5dd5ac=>{const _0x5d0c8b=_0x406fa4;if(validateAccess(_0x5dd5ac,_0xab6cc2)[_0x5d0c8b(0x199)])updateBB(_0x5d0c8b(0xc0));else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x424a98['on'](_0x406fa4(0x28d),_0x14deaa=>{const _0x136fa3=_0x406fa4;if(validateAccess(_0x14deaa,_0xab6cc2)[_0x136fa3(0x199)])updateBB(_0x136fa3(0x102));else logger[_0x136fa3(0x12b)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x424a98['on'](_0x406fa4(0x131),_0x3937d3=>{const _0x1e911d=_0x406fa4;if(validateAccess(_0x3937d3,_0xab6cc2)[_0x1e911d(0x199)]){const _0x13c171=getClient(_0x424a98['id']);if(_0x13c171)getBackupFiles(_0x13c171[_0x1e911d(0x14b)]);else logger[_0x1e911d(0x12b)](_0x1e911d(0x237));}else logger[_0x1e911d(0x12b)](_0x1e911d(0x157));}),_0x424a98['on'](_0x406fa4(0x1c9),(_0x18859f,_0x4bf8e3)=>{const _0x4205ec=_0x406fa4;if(validateAccess(_0x4bf8e3,_0xab6cc2)[_0x4205ec(0x199)])restoreBackupFile(_0x18859f);else logger['full'](_0x4205ec(0xfd));}),_0x424a98['on'](_0x406fa4(0x125),_0xbb363f=>{const _0x200f00=_0x406fa4;if(validateAccess(_0xbb363f,_0xab6cc2)[_0x200f00(0x199)])getMessages();else logger['full'](_0x200f00(0x228));}),_0x424a98['on']('confirm-message',(_0xd097d8,_0x2f1420)=>{const _0x11792f=_0x406fa4;if(validateAccess(_0x2f1420,_0xab6cc2)[_0x11792f(0x199)])confirmMessage(_0xd097d8);else logger[_0x11792f(0x12b)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x424a98['on']('logout',_0x3e5e83=>{const _0x18a91f=_0x406fa4;if(validateAccess(_0x3e5e83,_0xab6cc2)[_0x18a91f(0x199)]){if(devices[_0xab6cc2][_0x18a91f(0x137)])clearTimeout(devices[_0xab6cc2][_0x18a91f(0x137)]);if(devices[_0xab6cc2][_0x18a91f(0x29f)])clearTimeout(devices[_0xab6cc2][_0x18a91f(0x29f)]);removeSocketListeners(getClient(_0x424a98['id'])[_0x18a91f(0x14b)]),addBlacklist(_0xab6cc2),devices[_0xab6cc2][_0x18a91f(0x161)]=null,devices[_0xab6cc2]['telegram2FaApproval']=null,devices[_0xab6cc2][_0x18a91f(0x117)][_0x18a91f(0x13c)]=null,logger[_0x18a91f(0xbf)]('Logged\x20out\x20user\x20...'+_0xab6cc2[_0x18a91f(0x175)](-0x8)),io['to'](getClient(_0x424a98['id'])[_0x18a91f(0x14b)])[_0x18a91f(0x215)](_0x18a91f(0x22c),{'access':{'allow':![],'reason':_0x18a91f(0x162),'token':null}});}else logger[_0x18a91f(0x12b)](_0x18a91f(0xb5));});}function initializeSocketBot(_0x5cf89f){const _0x60d4ac=_0x3b18e3,_0x4c2c8b=getClient(_0x5cf89f['id'])[_0x60d4ac(0x15c)],_0x5cf2b1=getClient(_0x5cf89f['id'])[_0x60d4ac(0x14b)];_0x5cf89f['on'](_0x60d4ac(0xa1),(_0x5e5cb3,_0x3b76de)=>{const _0x26c906=_0x60d4ac;if(validateAccess(_0x3b76de,_0x5cf2b1)[_0x26c906(0x199)]){if(pid[_0x4c2c8b])pid[_0x4c2c8b][_0x26c906(0x1ab)]({'function':'emitHistory','args':_0x5e5cb3});}else logger[_0x26c906(0x12b)](_0x26c906(0x1e1));}),_0x5cf89f['on']('delete-alerts',(_0x506016,_0xf45625)=>{const _0x26e95f=_0x60d4ac;if(validateAccess(_0xf45625,_0x5cf2b1)['allow']){if(pid[_0x4c2c8b])pid[_0x4c2c8b]['send']({'function':_0x26e95f(0xec),'args':_0x506016});}else logger[_0x26e95f(0x12b)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x5cf89f['on'](_0x60d4ac(0x279),(_0x223000,_0x2fc460)=>{const _0x273dec=_0x60d4ac;if(validateAccess(_0x2fc460,_0x5cf2b1)['allow']){if(pid[_0x4c2c8b])pid[_0x4c2c8b][_0x273dec(0x1ab)]({'function':'getPortfolio','args':_0x223000});}else logger[_0x273dec(0x12b)](_0x273dec(0xb4));}),_0x5cf89f['on'](_0x60d4ac(0x245),(_0x460593,_0x4002b6)=>{const _0x3b3cbc=_0x60d4ac;if(validateAccess(_0x4002b6,_0x5cf2b1)[_0x3b3cbc(0x199)]){if(pid[_0x4c2c8b])pid[_0x4c2c8b][_0x3b3cbc(0x1ab)]({'function':'storeConfiguration','args':_0x460593});}else logger[_0x3b3cbc(0x12b)](_0x3b3cbc(0x1ac));}),_0x5cf89f['on'](_0x60d4ac(0x1bc),(_0x13dee6,_0x2651ea)=>{const _0x163b6b=_0x60d4ac;if(validateAccess(_0x2651ea,_0x5cf2b1)[_0x163b6b(0x199)]){if(pid[_0x4c2c8b])pid[_0x4c2c8b][_0x163b6b(0x1ab)]({'function':_0x163b6b(0x297),'args':_0x13dee6});}else logger[_0x163b6b(0x12b)](_0x163b6b(0x23f));}),_0x5cf89f['on'](_0x60d4ac(0x1b0),(_0x25657a,_0x5f33c3)=>{const _0x4aca7c=_0x60d4ac;if(validateAccess(_0x5f33c3,_0x5cf2b1)[_0x4aca7c(0x199)]){if(pid[_0x4c2c8b])pid[_0x4c2c8b][_0x4aca7c(0x1ab)]({'function':'storeFiat','args':_0x25657a});}else logger['full'](_0x4aca7c(0xb8));}),_0x5cf89f['on'](_0x60d4ac(0x11b),_0x34e26f=>{const _0x258b34=_0x60d4ac;if(validateAccess(_0x34e26f,_0x5cf2b1)[_0x258b34(0x199)]){if(pid[_0x4c2c8b])pid[_0x4c2c8b][_0x258b34(0x1ab)]({'function':'resetHistory','args':null});}else logger[_0x258b34(0x12b)](_0x258b34(0x235));}),_0x5cf89f['on'](_0x60d4ac(0x24b),_0x494b81=>{const _0x793354=_0x60d4ac;if(validateAccess(_0x494b81,_0x5cf2b1)[_0x793354(0x199)]){if(pid[_0x4c2c8b])pid[_0x4c2c8b][_0x793354(0x1ab)]({'function':_0x793354(0x270),'args':null});}else logger[_0x793354(0x12b)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x5cf89f['on'](_0x60d4ac(0x20d),(_0x35c07e,_0x3a9adc)=>{const _0xc2013e=_0x60d4ac;if(validateAccess(_0x3a9adc,_0x5cf2b1)[_0xc2013e(0x199)]){if(pid[_0x4c2c8b])pid[_0x4c2c8b][_0xc2013e(0x1ab)]({'function':'placeOrder','args':_0x35c07e});}else logger['full'](_0xc2013e(0xe2));}),_0x5cf89f['on'](_0x60d4ac(0x28a),_0x20eeea=>{const _0x44123c=_0x60d4ac;if(validateAccess(_0x20eeea,_0x5cf2b1)[_0x44123c(0x199)]){if(pid[_0x4c2c8b])pid[_0x4c2c8b][_0x44123c(0x1ab)]({'function':_0x44123c(0x10d),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x5cf89f['on']('show-config',_0x4b7ae6=>{const _0x1f381e=_0x60d4ac;if(validateAccess(_0x4b7ae6,_0x5cf2b1)['allow']){if(pid[_0x4c2c8b])pid[_0x4c2c8b][_0x1f381e(0x1ab)]({'function':_0x1f381e(0x15e),'args':null});}else logger[_0x1f381e(0x12b)](_0x1f381e(0x232));}),_0x5cf89f['on'](_0x60d4ac(0xdc),_0x3a21f6=>{const _0xa5c31e=_0x60d4ac;if(validateAccess(_0x3a21f6,_0x5cf2b1)[_0xa5c31e(0x199)])updateBB(_0xa5c31e(0xc0));else logger[_0xa5c31e(0x12b)](_0xa5c31e(0x186));}),_0x5cf89f['on']('get-messages',_0x3ee635=>{const _0x5e71c0=_0x60d4ac;if(validateAccess(_0x3ee635,_0x5cf2b1)[_0x5e71c0(0x199)])getMessages();else logger['full'](_0x5e71c0(0x228));}),_0x5cf89f['on'](_0x60d4ac(0x26b),(_0x57d545,_0x1be139)=>{const _0x271bff=_0x60d4ac;if(validateAccess(_0x1be139,_0x5cf2b1)[_0x271bff(0x199)])confirmMessage(_0x57d545);else logger['full'](_0x271bff(0x9c));}),_0x5cf89f['on']('logout',_0x3cd1cd=>{const _0xa59a13=_0x60d4ac;if(validateAccess(_0x3cd1cd,_0x5cf2b1)['allow']){if(devices[_0x5cf2b1]['pidRefreshToken'])clearTimeout(devices[_0x5cf2b1][_0xa59a13(0x137)]);if(devices[_0x5cf2b1][_0xa59a13(0x29f)])clearTimeout(devices[_0x5cf2b1][_0xa59a13(0x29f)]);removeSocketListeners(getClient(_0x5cf89f['id'])['uuid']),addBlacklist(_0x5cf2b1),devices[_0x5cf2b1][_0xa59a13(0x161)]=null,devices[_0x5cf2b1][_0xa59a13(0x167)]=null,devices[_0x5cf2b1][_0xa59a13(0x117)]['token']=null,logger[_0xa59a13(0xbf)](_0xa59a13(0x286)+_0x5cf2b1['slice'](-0x8)),io['to'](getClient(_0x5cf89f['id'])[_0xa59a13(0x14b)])[_0xa59a13(0x215)](_0xa59a13(0x22c),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0xa59a13(0x12b)](_0xa59a13(0xb5));});}function removeSocketListeners(_0x4ad4b9){const _0x1828a6=_0x3b18e3;getClientsWithUuid(_0x4ad4b9)[_0x1828a6(0x1b9)](_0x328947=>{const _0x4764f2=_0x1828a6;getSocket(_0x328947['id'])[_0x4764f2(0x1ba)]();});}function cleanSettings(){const _0x28f9c8=_0x3b18e3;let _0x432f84=settings;return settings[_0x28f9c8(0x99)]&&settings[_0x28f9c8(0x99)]!=''&&(_0x432f84={..._0x432f84,'telegramToken':_0x28f9c8(0x25f)}),settings['bbPassword']&&settings['bbPassword']!=''&&(_0x432f84={..._0x432f84,'bbPassword':_0x28f9c8(0x25f)}),settings[_0x28f9c8(0x1dc)]&&settings[_0x28f9c8(0x1dc)]!=''&&(_0x432f84={..._0x432f84,'marketcapApi':_0x28f9c8(0x25f)}),(settings[_0x28f9c8(0x15f)]&&settings['bbPassword']==_0x28f9c8(0x133)||settings[_0x28f9c8(0x99)]&&settings['telegramToken']==_0x28f9c8(0x133)||settings['marketcapApi']&&settings[_0x28f9c8(0x1dc)]==_0x28f9c8(0x133))&&(_0x432f84={..._0x432f84,'restored':{'password':settings[_0x28f9c8(0x15f)]==_0x28f9c8(0x133),'telegram':settings['telegramToken']==_0x28f9c8(0x133),'marketcap':settings[_0x28f9c8(0x1dc)]==_0x28f9c8(0x133)}}),_0x432f84;}async function updateBB(_0x2fd477){const _0x9183c9=_0x3b18e3;await backupConfigFiles(),installingUpdate=!![],config[_0x9183c9(0x1b9)](_0x150e92=>{const _0x4598ce=_0x9183c9;restartBot(_0x150e92[_0x4598ce(0x9a)]);});if(_0x2fd477==_0x9183c9(0xc0))process[_0x9183c9(0x1ab)]({'update':!![],'environment':environment},_0x5b597a=>{});else _0x2fd477==_0x9183c9(0x102)&&process[_0x9183c9(0x1ab)]({'reinstall':!![],'environment':environment},_0x56dd49=>{});}function startBot(_0x1a6de1,_0x86b76,_0x2d8a7c){const _0x107823=_0x3b18e3;if(debugging)_0x1a6de1[_0x107823(0x1a7)]('-d');let _0x4ed828=![];const _0xbee21e=_0x1a6de1[0x0];_0x86b76={..._0x86b76,'stdio':[_0x107823(0xa6),'inherit',_0x107823(0xa6),_0x107823(0x15d)]},pid[_0xbee21e]=childProcess['fork'](botfile,_0x1a6de1,_0x86b76),pid[_0xbee21e]['on'](_0x107823(0x24c),_0x4c396b=>{const _0x2efbad=_0x107823;switch(Object[_0x2efbad(0x1d5)](_0x4c396b)[0x0]){case _0x2efbad(0x1fb):updateBotName(_0xbee21e,_0x4c396b[_0x2efbad(0x1fb)]);break;case _0x2efbad(0xa7):updateBotManager();break;case _0x2efbad(0x22c):updateStatus(_0xbee21e,_0x4c396b[_0x2efbad(0x22c)]);break;case _0x2efbad(0x182):updateLive(_0xbee21e,_0x4c396b['live']);break;case'started':updateLive(_0xbee21e,_0x4c396b[_0x2efbad(0xe1)]),io['to'](_0xbee21e)['emit']('status',{'access':{'allow':![],'reason':_0x2efbad(0x1a8),'token':null}});break;case _0x2efbad(0xcf):_0x4c396b[_0x2efbad(0xcf)]==_0x2efbad(0x24f)&&restartBot(_0xbee21e);_0x4c396b[_0x2efbad(0xcf)]=='kill'&&toggleBot(_0xbee21e,'disabled',_0x2efbad(0x225));break;case _0x2efbad(0x1b8):sendTelegramBot(_0xbee21e,_0x4c396b[_0x2efbad(0x1b8)]);break;case _0x2efbad(0x1e5):sendTelegramMsg(_0x4c396b['telegrammsg']);break;case _0x2efbad(0x15b):io['to'](_0xbee21e)['emit'](_0x4c396b[_0x2efbad(0x15b)],_0x4c396b[_0x2efbad(0x13f)]);break;}}),pid[_0xbee21e]['on'](_0x107823(0x180),function(_0x429329){if(_0x4ed828)return;_0x4ed828=!![],_0x2d8a7c(_0x429329);}),pid[_0xbee21e]['on']('exit',async function(_0x506190){const _0x4a70e2=_0x107823;if(terminating)return;if(installingUpdate){io['close']();return;}if(_0x4ed828)return;_0x4ed828=!![],_0x2d8a7c(null);const _0x3ecc2f=dbConfig[_0x4a70e2(0x1be)](_0x4a70e2(0x118))['find']({'botID':_0xbee21e})[_0x4a70e2(0x246)]();_0x3ecc2f&&(_0x3ecc2f[_0x4a70e2(0x22c)]==_0x4a70e2(0x1d2)||_0x3ecc2f['status']==_0x4a70e2(0x17e))&&(await sleep(0x3e8),updateLive(_0xbee21e,_0x4a70e2(0x225)),logger['full'](_0x4a70e2(0x142)+_0xbee21e),startBot([_0xbee21e,userID],{'cwd':bbpath},function(_0x2e7cde){const _0x292b0c=_0x4a70e2;if(_0x2e7cde)logger[_0x292b0c(0x12b)](_0x2e7cde);}));});}function stopBot(_0x51b62){const _0x190a03=_0x3b18e3;getClientsWithBotID(_0x51b62)[_0x190a03(0x1b9)](_0x5d9722=>{getSocket(_0x5d9722['id'])['disconnect'](!![]),removeClient(_0x5d9722['id']);}),pid[_0x51b62]&&(pid[_0x51b62][_0x190a03(0x1ad)](),pid[_0x51b62]=null);}function stopAllBots(){const _0x4a8cdc=_0x3b18e3;terminating=!![];const _0x2cef07=getEnabledBots();_0x2cef07[_0x4a8cdc(0x1b9)](_0x5410f3=>{const _0x5bb41f=_0x4a8cdc;stopBot(_0x5410f3[_0x5bb41f(0x9a)]);});}function restartBot(_0x4af2c9){const _0x4e4fe2=_0x3b18e3;if(pid[_0x4af2c9])pid[_0x4af2c9][_0x4e4fe2(0x1ad)]();}function addBot(){const _0x3b5136=_0x3b18e3;let _0x29ced5;for(let _0x4db80d=0x1;_0x4db80d<0x3e9;_0x4db80d++){_0x29ced5=_0x4db80d[_0x3b5136(0xbe)]()[_0x3b5136(0x17b)](0x3,'0');let _0x1be7d5=config[_0x3b5136(0x26e)](_0x1ae1be=>_0x1ae1be[_0x3b5136(0x9a)]==_0x29ced5);if(!_0x1be7d5)break;}if(_0x29ced5===_0x3b5136(0x21b)){logger[_0x3b5136(0x12b)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x3b5136(0x12b)](_0x3b5136(0xa5)+_0x29ced5),dbConfig[_0x3b5136(0x1be)](_0x3b5136(0x118))['push']({'botID':_0x29ced5,'botname':_0x3b5136(0xff)+_0x29ced5,'status':_0x3b5136(0x17e),'live':''})[_0x3b5136(0xd8)](),startBot([_0x29ced5,userID],{'cwd':bbpath},function(_0x26063b){const _0x4e7f41=_0x3b5136;if(_0x26063b)logger[_0x4e7f41(0x12b)](_0x26063b);}),config=getConfiguration(),io['to'](_0x3b5136(0x13d))[_0x3b5136(0x215)]('bots',config),broadcastToBots(_0x3b5136(0x118),JSON['stringify'](config));}function _0x5898(){const _0x58cb12=['publicKey','exit','66169tAMqMz','started','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','versions','verify','auto','SIGINT','Server','graphql-request','async','Failed\x20to\x20download\x20','bb-settings.json','deleteHistoryAlerts','rmSync','22mRfPoN','backup','config_alerts','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','-----------------------------------------------------------------------------------','Login\x20accepted','sockets','Notifications\x20enabled\x0a','Notifications\x20disabled','telegramChatId','*$1*','loadAsync','set','/names\x20-\x20show\x20bot\x20names\x0a','order','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','login\x20token\x20generated','Bot\x20','tempaccess_30_','environment','reinstall','All','output-002.log','telegraf','Orders','bbvReceive','\x20(2)','messages','env','assign','\x20-\x20','cancelLoading','login\x20required','encryptedUuid','readdirSync','binary','launch','build','All\x20bots','settings','Unauthorized\x20attempt\x20to\x20add\x20bot','access','bots','ipv6','password','reset-history','manual','1034286HWyprK','3000','output-000.log','temporary\x20access\x20timeout','Yes','whitelist','disabled','getTime','get-messages',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','exec','names','CoinMarketCap\x20API\x20key\x20validated','bbUsername','full','add','sendFile','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','version.json','portfolio_','get-backup-files','reject','***','new-disabled','help','login\x20not\x20required','pidRefreshToken','Notifications\x20disabled\x0a','log','notification','join','token','botmanager','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','args','toggleBotMode','bbvNew','Restarting\x20Bot\x20','format','length','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','/:bot/support','|@|','10KWVyIM','Unauthorized\x20attempt\x20to\x20update\x20settings',':\x20Bot\x20Mgr\x20>\x20','uuid','stringify','privateKeyFromPem','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','HTML','privateKey','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','store-settings','config/','\x20only\x0a','production','auth','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','create','http','connected','function','bot','ipc','showConfig','bbPassword','/start','telegramIpApproval','logged\x20out','login','sortBy','off_','Your\x20installation\x20is\x20already\x20up\x20to\x20date','telegram2FaApproval','split','_nsps','existsSync','Ok,\x20will\x20send\x20order\x20notifications\x20only','update_yes','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','username','bb-secure.json','match','Logged\x20in\x20user\x20...','temp/','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','slice','version','telegramEvents','tempaccess_reject_','temporary\x20token\x20generated','clientip','padStart','.zip','Idling\x20(','new','/status\x20-\x20show\x20bot(s)\x20status\x0a','error','backup-full.zip','live','Unauthorized\x20login\x20attempt\x20(timeout)','callback','DEFLATE','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Bot\x20Mgr\x20>\x20','Setting\x20access:\x20','zip/','Error\x20details:','tempaccess_15_','All\x20bots\x20running\x20right\x20now','\x20(1)','<b>Telegram\x20Bot\x20Status:</b>\x0a','No\x20bots\x20running\x20right\x20now','bcryptjs','latestversion','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','-performance.json','mixpanel','timeshift','allow','Unauthorized\x20attempt\x20to\x20update\x20bot','secure','search','RSA-OAEP','::1','logs/','randomFillSync','alias','clients','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','mtime','sha256','sort','push','reload','type','Backup\x20file\x20uploaded','send','Unauthorized\x20attempt\x20to\x20store\x20configuration','kill','static','getDate','store-fiat','catch','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','backup-full@','off','tkn','BCT','decode64','telegram','forEach','removeAllListeners','generateAsync','store-headless','User\x20has\x20been\x20validated','get','download','track','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Enabled\x20Bot\x20','warning','mode','/download/:type','lastmsgemitted','path','date-fns','restore-backup-file','2FA\x20login\x20token\x20generated','inlineKeyboard','bot.js','unlinkSync','address','min','/metrics\x20-\x20show\x20bot\x20performance\x0a','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','enabled','node','sendPortfolioTelegram','keys','\x1b[33m','127.0.0.1','/:bot/portfolio','host','user','mkdirSync','marketcapApi','\x1b[36m','Password\x20reset\x20rejected','login2fa_reject_','telegramEnabled','Unauthorized\x20attempt\x20to\x20get\x20events','::ffff:127.0.0.1','/upload-backup','228432bCaVCJ','telegrammsg','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Backup\x20file\x20unzipped\x20and\x20stored','\x20>\x20','replace','temporaryAccessAllowed','reply','/output-000.log','headers','/on\x20-\x20start\x20bot(s)\x0a','disconnect','<b>Balance\x20Bot\x20Status:</b>\x0a','text','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','output-001.log','secret',',\x20must\x20be\x20a\x204\x20digit\x20number','2FA\x20login\x20rejected','randomBytes','3315447LitCck','-config.json','build2','botname','pki','lowdb/adapters/FileSync','endsWith','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','backup-files','delete-bot','referer','server','#RES#','internal','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Restore\x20process\x20confirmed','axios','Error:\x20Invalid\x20argument\x20','(((.+)+)+)+$','rsa','kind','place-order','invalid\x20credentials','apiPassword','onepagemode','files','\x1b[31m','showname','temporary\x20access\x20not\x20allowed','emit','2FA','accept','/:bot/history','sign','store','1000','config_orders','Login\x20rejected','loginRequired','apiKey','login2fa_','Telegraf\x20error:','running','/help\x20-\x20show\x20available\x20commands\x0a','-results.json','stopped','api-eu.mixpanel.com','temporary\x20access\x20rejected','Unauthorized\x20attempt\x20to\x20get\x20messages','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','getSeconds','status','bot-','getMinutes','number','https://api.ipify.org?format=json','name','Unauthorized\x20attempt\x20to\x20show\x20configuration','/:bot/configuration','remove','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','getFullYear','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','writeFileSync','port','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','147cAzjPA','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Node.js\x20v','on_','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','15\x20min','\x20minutes','Restoring\x20bot(s)\x20from\x20backup','Token\x20blacklisted','timestamp','store-configuration','value','f2aRequired','6607712TXlkuy','resetpw_yes','data','get-starting-balances','message','#RES#\x20if\x20running\x20on\x20server','288272AFJPgo','restart','cloneDeep','portfolio','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','hasOwnProperty','0.0.0','\x20|\x20','statSync','toggle',')\x20|\x20Bot\x20','toggle-bot-mode','restart_','/off\x20-\x20stop\x20bot(s)\x0a','sendMetricsTelegram','simple','Alerts','************','lowdb','remoteAddress','$1_$2_$3','uuid-random','listen','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','startsWith','toIPv4Address','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','telegramUsername','confirm-message','backup/','family','find','title','getStartingBalances','crypto','config_all','tempaccess_5_','lastmsgtelegram','includes','File\x20uploaded','2FA\x20login\x20required','decrypt','get-portfolio','Markdown','orders','/update\x20-\x20update\x20Balance\x20Bot\x0a','yargs/yargs','reinstall_no','NTBA_FIX_319','success','entries','button','headless','express-fileupload','Restore\x20process\x20aborted','Logged\x20out\x20user\x20...','show','\x20|\x20client:\x20...','size','cancel-loading','chat','blacklist','reinstall-bb','jsonwebtoken','1863315YKRVCd',')\x20\x20\x20|\x20Bot\x20','defaults','apiSecret','enable','2FA\x20required','restore_no_','filter','storeHeadless','hashSync','getMonth','Ok,\x20will\x20send\x20alert\x20notifications\x20only','status\x20code\x20401','Notifications\x20types:\x20','command','update_no','pidExpireLogin','metrics_','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','index.html','reset-password','backupfile','settings.','telegramToken','botID','range','Unauthorized\x20attempt\x20to\x20confirm\x20message','-events.json','once','expiry','sendMessage','get-logs','use','string','\x20to\x20','Starting\x20new\x20bot\x20|\x20Bot\x20','inherit','updatebotmanager','getUTCHours',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','alerts','request','#RES#\x20','editMessageReplyMarkup','isDirectory','hex','Temporary\x20access\x20rejected','Unauthorized\x20attempt\x20to\x20download\x20','Access\x20enabled\x20for\x20','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Unauthorized\x20attempt\x20to\x20log\x20out','getHours','\x1b[35m','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','yes','from','bb/','\x1b[0m','update-bot','toString','debug','update','[ip-address]','\x1b[34m','all','action','No\x20authentication\x20token','ipaddr.js','Allow\x20login\x20from\x20IP\x20address\x20','Invalid\x20authentication\x20token\x20(2)','parse','add-bot','readFileSync','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','reason','copyFileSync','stop','SIGTERM','output-003.log','createWriteStream','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','backup-full','/enable\x20-\x20enable\x20notifications\x0a','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','any','write','Disabled\x20Bot\x20','/:bot/performance','event','update-bb','node-forge'];_0x5898=function(){return _0x58cb12;};return _0x5898();}function deleteBot(_0x1bc3b9){const _0x5ea3da=_0x3b18e3;getClientsWithBotID(_0x1bc3b9)[_0x5ea3da(0x1b9)](_0x87461b=>{getSocket(_0x87461b['id'])['disconnect'](!![]),removeClient(_0x87461b['id']);}),dbConfig['get'](_0x5ea3da(0x118))[_0x5ea3da(0x234)]({'botID':_0x1bc3b9})[_0x5ea3da(0xd8)](),logger['full']('Deleted\x20Bot\x20'+_0x1bc3b9),stopBot(_0x1bc3b9);try{if(fs[_0x5ea3da(0x16a)](path[_0x5ea3da(0x13b)](configpath,'bot-'+_0x1bc3b9+'-config.json')))fs['unlinkSync'](path[_0x5ea3da(0x13b)](configpath,_0x5ea3da(0x22d)+_0x1bc3b9+_0x5ea3da(0x1f9)));if(fs[_0x5ea3da(0x16a)](path[_0x5ea3da(0x13b)](configpath,'bot-'+_0x1bc3b9+'-events.json')))fs[_0x5ea3da(0x1cd)](path[_0x5ea3da(0x13b)](configpath,_0x5ea3da(0x22d)+_0x1bc3b9+_0x5ea3da(0x9d)));if(fs[_0x5ea3da(0x16a)](path[_0x5ea3da(0x13b)](configpath,_0x5ea3da(0x22d)+_0x1bc3b9+_0x5ea3da(0x196))))fs[_0x5ea3da(0x1cd)](path['join'](configpath,'bot-'+_0x1bc3b9+_0x5ea3da(0x196)));if(fs[_0x5ea3da(0x16a)](path[_0x5ea3da(0x13b)](configpath,_0x5ea3da(0x22d)+_0x1bc3b9+_0x5ea3da(0x224))))fs[_0x5ea3da(0x1cd)](path[_0x5ea3da(0x13b)](configpath,_0x5ea3da(0x22d)+_0x1bc3b9+_0x5ea3da(0x224)));}catch(_0x2a7c80){if(_0x2a7c80)logger[_0x5ea3da(0x12b)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x2a7c80);}config=getConfiguration(),io['to'](_0x5ea3da(0x13d))[_0x5ea3da(0x215)]('bots',config),broadcastToBots('bots',JSON[_0x5ea3da(0x14c)](config));}function toggleBot(_0x1aca2a,_0x5121cc,_0xcb5ea0){const _0x102f80=_0x3b18e3;dbConfig['get'](_0x102f80(0x118))[_0x102f80(0x26e)]({'botID':_0x1aca2a})['assign']({'status':_0x5121cc})['assign']({'live':_0xcb5ea0})['write']();if(_0x5121cc==_0x102f80(0x1d2)||_0x5121cc==_0x102f80(0x17e))logger[_0x102f80(0x12b)](_0x102f80(0x1c2)+_0x1aca2a),startBot([_0x1aca2a,userID],{'cwd':bbpath},function(_0x45799d){if(_0x45799d)logger['full'](_0x45799d);});else(_0x5121cc=='disabled'||_0x5121cc==_0x102f80(0x134))&&(logger[_0x102f80(0x12b)](_0x102f80(0xd9)+_0x1aca2a),stopBot(_0x1aca2a));config=getConfiguration(),io['to'](_0x102f80(0x13d))[_0x102f80(0x215)](_0x102f80(0x118),config),broadcastToBots(_0x102f80(0x118),JSON[_0x102f80(0x14c)](config));}function toggleStatus(_0x4cfba0){const _0x5161fa=_0x3b18e3;let _0x34d1d4=dbConfig['get'](_0x5161fa(0x118))[_0x5161fa(0x26e)]({'botID':_0x4cfba0})['value'](),_0x1f8a28;if(_0x34d1d4[_0x5161fa(0x22c)]===_0x5161fa(0x1d2))_0x1f8a28='disabled';else{if(_0x34d1d4['status']===_0x5161fa(0x17e))_0x1f8a28=_0x5161fa(0x134);else{if(_0x34d1d4[_0x5161fa(0x22c)]===_0x5161fa(0x134))_0x1f8a28=_0x5161fa(0x17e);else{if(_0x34d1d4[_0x5161fa(0x22c)]==='disabled')_0x1f8a28=_0x5161fa(0x1d2);}}}return _0x1f8a28;}function updateStatus(_0x5d0fe8,_0x456cc5){const _0x54ddab=_0x3b18e3;dbConfig[_0x54ddab(0x1be)](_0x54ddab(0x118))[_0x54ddab(0x26e)]({'botID':_0x5d0fe8})[_0x54ddab(0x10b)]({'status':_0x456cc5})[_0x54ddab(0xd8)](),config=getConfiguration(),io['to'](_0x54ddab(0x13d))[_0x54ddab(0x215)](_0x54ddab(0x118),config),broadcastToBots(_0x54ddab(0x118),JSON[_0x54ddab(0x14c)](config));}function updateLive(_0x1b44bd,_0x2915f5){const _0x44524e=_0x3b18e3;dbConfig[_0x44524e(0x1be)](_0x44524e(0x118))['find']({'botID':_0x1b44bd})['assign']({'live':_0x2915f5})[_0x44524e(0xd8)](),config=getConfiguration(),io['to']('botmanager')[_0x44524e(0x215)](_0x44524e(0x118),config),broadcastToBots(_0x44524e(0x118),JSON[_0x44524e(0x14c)](config));}function updateBotName(_0xabbdd6,_0x45bae2){const _0x117ce5=_0x3b18e3;dbConfig['get'](_0x117ce5(0x118))[_0x117ce5(0x26e)]({'botID':_0xabbdd6})[_0x117ce5(0x10b)]({'botname':_0x45bae2})['write'](),config=getConfiguration(),io['to'](_0x117ce5(0x13d))['emit'](_0x117ce5(0x118),config),broadcastToBots('bots',JSON[_0x117ce5(0x14c)](config));}function updateBotManager(){const _0x1b4e80=_0x3b18e3;config=getConfiguration(),io['to'](_0x1b4e80(0x13d))[_0x1b4e80(0x215)](_0x1b4e80(0x118),config),broadcastToBots(_0x1b4e80(0x118),JSON[_0x1b4e80(0x14c)](config));}function toggleBotMode(_0x1dbb9a){const _0x26a7b5=_0x3b18e3;if(pid[_0x1dbb9a])pid[_0x1dbb9a][_0x26a7b5(0x1ab)]({'function':_0x26a7b5(0x140),'args':null});else{const _0x567b67=configpath+_0x26a7b5(0x22d)+_0x1dbb9a+_0x26a7b5(0x1f9),_0x22e9ab=fs[_0x26a7b5(0xcb)](_0x567b67),_0x473630=JSON[_0x26a7b5(0xc9)](_0x22e9ab),_0x2b8bb3=_0x473630[_0x26a7b5(0x15c)][0x0][_0x26a7b5(0x283)];_0x473630[_0x26a7b5(0x15c)][0x0][_0x26a7b5(0x283)]=!_0x2b8bb3;const _0x330d27=JSON['stringify'](_0x473630,null,0x2);fs[_0x26a7b5(0x238)](_0x567b67,_0x330d27),config=getConfiguration(),io['to'](_0x26a7b5(0x13d))[_0x26a7b5(0x215)]('bots',config),broadcastToBots(_0x26a7b5(0x118),JSON['stringify'](config));}}function validateTelegram(_0x1699d8){const _0x4c272e=_0x3b18e3;if(_0x1699d8['from'][_0x4c272e(0x16f)]!=settings['telegramUsername']&&'@'+_0x1699d8[_0x4c272e(0xba)][_0x4c272e(0x16f)]!=settings[_0x4c272e(0x26a)]||_0x1699d8[_0x4c272e(0x28b)]['id']!=settings[_0x4c272e(0xf7)])return sendTelegram(_0x1699d8[_0x4c272e(0x28b)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x4c272e(0x14f)}),![];return!![];}async function initTelegram(){const _0x53113e=_0x3b18e3;if(tgBot)tgBot[_0x53113e(0xcf)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x53113e(0x99)]);let _0x3aea5d='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x3aea5d+='\x0a',_0x3aea5d+=_0x53113e(0xd5),_0x3aea5d+='/disable\x20-\x20disable\x20notifications\x0a',_0x3aea5d+=_0x53113e(0x187),_0x3aea5d+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x3aea5d+=_0x53113e(0x1ee),_0x3aea5d+=_0x53113e(0x25b),_0x3aea5d+=_0x53113e(0x266),_0x3aea5d+=_0x53113e(0xfb),_0x3aea5d+=_0x53113e(0x17f),_0x3aea5d+=_0x53113e(0x1d0),_0x3aea5d+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x3aea5d+=_0x53113e(0x27c),_0x3aea5d+=_0x53113e(0x13e),_0x3aea5d+=_0x53113e(0x223);let _0x45ea1b=_0x53113e(0x206);_0x45ea1b+='\x0a',_0x45ea1b+=_0x3aea5d,tgBot[_0x53113e(0x1b1)]((_0x4447eb,_0x50d9f4)=>{const _0xe88d00=_0x53113e;logger[_0xe88d00(0x25d)](getTimeStamp()+_0xe88d00(0xa9)),logger[_0xe88d00(0xbf)](_0xe88d00(0x221),_0x4447eb);}),tgBot[_0x53113e(0xa2)](async(_0x451ce1,_0x1a57d8)=>{const _0x3a6626=_0x53113e;if(!(!settings[_0x3a6626(0xf7)]&&_0x451ce1[_0x3a6626(0xc0)][_0x3a6626(0x24c)][_0x3a6626(0x1f1)]==_0x3a6626(0x160))){if(!validateTelegram(_0x451ce1))return;}_0x1a57d8();}),tgBot['command']('start',async _0x649537=>{const _0x77f518=_0x53113e;if(!settings[_0x77f518(0xf7)])updateSetting('telegramChatId',_0x649537[_0x77f518(0x28b)]['id']);updateSetting(_0x77f518(0x1e0),!![]);if(!validateTelegram(_0x649537))return;await sendTelegram(_0x649537[_0x77f518(0x28b)]['id'],_0x45ea1b);}),tgBot[_0x53113e(0x29d)](_0x53113e(0x293),async _0x328432=>{updateSetting('telegramEnabled',!![]),await sendTelegram(_0x328432['chat']['id'],'Notifications\x20enabled');}),tgBot[_0x53113e(0x29d)]('disable',async _0xfd70b0=>{const _0x47aaef=_0x53113e;await sendTelegram(_0xfd70b0[_0x47aaef(0x28b)]['id'],_0x47aaef(0xf6)),updateSetting(_0x47aaef(0x1e0),![]);}),tgBot[_0x53113e(0x29d)]('config',async _0x3c057f=>{const _0x56d52b=_0x53113e,_0x39d9fb=Markup[_0x56d52b(0x1cb)]([Markup[_0x56d52b(0x282)][_0x56d52b(0x184)](_0x56d52b(0x106),'config_orders'),Markup[_0x56d52b(0x282)][_0x56d52b(0x184)](_0x56d52b(0x25e),'config_alerts'),Markup[_0x56d52b(0x282)][_0x56d52b(0x184)](_0x56d52b(0x103),_0x56d52b(0x272))]);_0x3c057f[_0x56d52b(0x1eb)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x39d9fb);}),tgBot[_0x53113e(0xc4)](_0x53113e(0x21c),async _0x55565d=>{const _0x197665=_0x53113e;_0x55565d[_0x197665(0xae)](),updateSetting(_0x197665(0x177),'orders'),updateSetting(_0x197665(0x1e0),!![]),await sendTelegram(_0x55565d[_0x197665(0x28b)]['id'],_0x197665(0x16b));}),tgBot[_0x53113e(0xc4)](_0x53113e(0xf0),async _0x1e746d=>{const _0x110c07=_0x53113e;_0x1e746d[_0x110c07(0xae)](),updateSetting('telegramEvents',_0x110c07(0xab)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x1e746d[_0x110c07(0x28b)]['id'],_0x110c07(0x29a));}),tgBot[_0x53113e(0xc4)](_0x53113e(0x272),async _0x44e2ec=>{const _0x14694e=_0x53113e;_0x44e2ec['editMessageReplyMarkup'](),updateSetting(_0x14694e(0x177),_0x14694e(0xc3)),updateSetting(_0x14694e(0x1e0),!![]),await sendTelegram(_0x44e2ec[_0x14694e(0x28b)]['id'],_0x14694e(0x1ff));}),tgBot[_0x53113e(0x29d)](_0x53113e(0x22c),async _0x5c6192=>{const _0x2798d5=_0x53113e,_0x9e8a10=getBotsWithMode();let _0x2d2852=_0x2798d5(0x1f0);config['forEach'](_0x1ddd62=>{const _0x3db5ca=_0x2798d5,_0x3075af=_0x9e8a10['find'](_0x976eb3=>_0x976eb3[_0x3db5ca(0x9a)]==_0x1ddd62[_0x3db5ca(0x9a)])[_0x3db5ca(0x1c4)];_0x2d2852+=_0x3db5ca(0xff)+_0x1ddd62['botID']+':\x20'+_0x1ddd62[_0x3db5ca(0x22c)]+_0x3db5ca(0x255)+_0x3075af+_0x3db5ca(0x255)+_0x1ddd62[_0x3db5ca(0x182)]+'\x0a';}),_0x2d2852+='\x0a',_0x2d2852+=_0x2798d5(0x191),_0x2d2852+=!settings['telegramEnabled']?_0x2798d5(0x138):_0x2798d5(0xf5),_0x2d2852+=settings[_0x2798d5(0x1e0)]?settings[_0x2798d5(0x177)]=='all'?_0x2798d5(0x12e):_0x2798d5(0x29c)+settings[_0x2798d5(0x177)]+_0x2798d5(0x154):'',await sendTelegram(_0x5c6192['chat']['id'],_0x2d2852,{'parse_mode':_0x2798d5(0x14f)});}),tgBot['command'](_0x53113e(0x24f),async _0x4bb555=>{const _0x229552=_0x53113e,_0x2ed4e3=getEnabledBots();if(_0x2ed4e3[_0x229552(0x144)]==0x0)await sendTelegram(_0x4bb555['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x2ed4e3[_0x229552(0x144)]>0x1)_0x2ed4e3[_0x229552(0x1a7)]({'botID':_0x229552(0xc3)});let _0x42e53e=[],_0x5e1588=[];const _0x5b1287=_0x2ed4e3[_0x229552(0x144)]%0x4==0x0||_0x2ed4e3[_0x229552(0x144)]%0x4==0x3||_0x2ed4e3[_0x229552(0x144)]%0x3==0x1?0x4:0x3;let _0x5bfd2e=0x0;_0x2ed4e3['forEach']((_0xc72624,_0x4d8679)=>{const _0x213464=_0x229552;if(_0x4d8679%_0x5b1287==0x0)_0x5e1588=[];_0x5e1588[_0x213464(0x1a7)](Markup['button'][_0x213464(0x184)](_0xc72624[_0x213464(0x9a)]==_0x213464(0xc3)?_0x213464(0x114):_0x213464(0xff)+_0xc72624['botID'],_0x213464(0x25a)+_0xc72624[_0x213464(0x9a)])),_0x4d8679%_0x5b1287==0x0&&(_0x42e53e[_0x5bfd2e]=_0x5e1588,_0x5bfd2e++);});const _0x128b6a=Markup[_0x229552(0x1cb)](_0x42e53e);_0x4bb555[_0x229552(0x1eb)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x128b6a);}}),tgBot[_0x53113e(0xc4)](/restart_(.+)/,async _0x2feecc=>{const _0x30da1d=_0x53113e,_0x4bc8b6=_0x2feecc[_0x30da1d(0x171)][0x1];_0x2feecc[_0x30da1d(0xae)](),_0x4bc8b6=='all'?config[_0x30da1d(0x1b9)](_0xc3a85c=>{const _0x44515a=_0x30da1d;restartBot(_0xc3a85c[_0x44515a(0x9a)]);}):restartBot(_0x4bc8b6);}),tgBot['command']('on',async _0x800c9e=>{const _0x3b8071=_0x53113e,_0x55b8ac=getDisabledBots();if(_0x55b8ac[_0x3b8071(0x144)]==0x0)await sendTelegram(_0x800c9e[_0x3b8071(0x28b)]['id'],_0x3b8071(0x18f));else{if(_0x55b8ac[_0x3b8071(0x144)]>0x1)_0x55b8ac[_0x3b8071(0x1a7)]({'botID':_0x3b8071(0xc3)});let _0x5a1660=[],_0x52b102=[];const _0x41c27f=_0x55b8ac['length']%0x4==0x0||_0x55b8ac[_0x3b8071(0x144)]%0x4==0x3||_0x55b8ac[_0x3b8071(0x144)]%0x3==0x1?0x4:0x3;let _0xfea7df=0x0;_0x55b8ac['forEach']((_0x2c1f50,_0x4f1d9d)=>{const _0x2a030a=_0x3b8071;if(_0x4f1d9d%_0x41c27f==0x0)_0x52b102=[];_0x52b102[_0x2a030a(0x1a7)](Markup[_0x2a030a(0x282)][_0x2a030a(0x184)](_0x2c1f50['botID']==_0x2a030a(0xc3)?_0x2a030a(0x114):_0x2a030a(0xff)+_0x2c1f50[_0x2a030a(0x9a)],_0x2a030a(0x23e)+_0x2c1f50['botID'])),_0x4f1d9d%_0x41c27f==0x0&&(_0x5a1660[_0xfea7df]=_0x52b102,_0xfea7df++);});const _0x19f883=Markup['inlineKeyboard'](_0x5a1660);_0x800c9e['reply'](_0x3b8071(0x229),_0x19f883);}}),tgBot[_0x53113e(0xc4)](/on_(.+)/,async _0x4b05d5=>{const _0x4bac67=_0x53113e,_0x3bc90e=_0x4b05d5['match'][0x1];_0x4b05d5[_0x4bac67(0xae)]();if(_0x3bc90e=='all'){const _0xa9ce21=getDisabledBots();await sendTelegram(_0x4b05d5['chat']['id'],_0x4bac67(0x1b2)),_0xa9ce21[_0x4bac67(0x1b9)](_0x42cd54=>{const _0x447954=_0x4bac67;if(_0x42cd54[_0x447954(0x9a)]!='all')toggleBot(_0x42cd54[_0x447954(0x9a)],toggleStatus(_0x42cd54['botID']),_0x447954(0x225));});}else await sendTelegram(_0x4b05d5[_0x4bac67(0x28b)]['id'],_0x4bac67(0x265)+_0x3bc90e),toggleBot(_0x3bc90e,toggleStatus(_0x3bc90e),'stopped');}),tgBot[_0x53113e(0x29d)](_0x53113e(0x1b4),async _0x343a2c=>{const _0x171ef7=_0x53113e,_0x4a653d=getEnabledBots();if(_0x4a653d[_0x171ef7(0x144)]==0x0)await sendTelegram(_0x343a2c[_0x171ef7(0x28b)]['id'],_0x171ef7(0x192));else{if(_0x4a653d[_0x171ef7(0x144)]>0x1)_0x4a653d[_0x171ef7(0x1a7)]({'botID':_0x171ef7(0xc3)});let _0x1c372f=[],_0x10b818=[];const _0x40dbe3=_0x4a653d[_0x171ef7(0x144)]%0x4==0x0||_0x4a653d[_0x171ef7(0x144)]%0x4==0x3||_0x4a653d[_0x171ef7(0x144)]%0x3==0x1?0x4:0x3;let _0x2b0365=0x0;_0x4a653d[_0x171ef7(0x1b9)]((_0x212dfe,_0x4237c9)=>{const _0x510f95=_0x171ef7;if(_0x4237c9%_0x40dbe3==0x0)_0x10b818=[];_0x10b818[_0x510f95(0x1a7)](Markup['button'][_0x510f95(0x184)](_0x212dfe[_0x510f95(0x9a)]==_0x510f95(0xc3)?_0x510f95(0x114):_0x510f95(0xff)+_0x212dfe[_0x510f95(0x9a)],_0x510f95(0x165)+_0x212dfe[_0x510f95(0x9a)])),_0x4237c9%_0x40dbe3==0x0&&(_0x1c372f[_0x2b0365]=_0x10b818,_0x2b0365++);});const _0x4b13c5=Markup[_0x171ef7(0x1cb)](_0x1c372f);_0x343a2c[_0x171ef7(0x1eb)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x4b13c5);}}),tgBot[_0x53113e(0xc4)](/off_(.+)/,async _0x486c78=>{const _0x1e9712=_0x53113e,_0x329b82=_0x486c78[_0x1e9712(0x171)][0x1];_0x486c78[_0x1e9712(0xae)]();if(_0x329b82==_0x1e9712(0xc3)){const _0x578a74=getEnabledBots();await sendTelegram(_0x486c78[_0x1e9712(0x28b)]['id'],_0x1e9712(0x269)),_0x578a74[_0x1e9712(0x1b9)](_0x3d0f0d=>{const _0xf3b80d=_0x1e9712;if(_0x3d0f0d['botID']!=_0xf3b80d(0xc3))toggleBot(_0x3d0f0d[_0xf3b80d(0x9a)],toggleStatus(_0x3d0f0d[_0xf3b80d(0x9a)]),_0xf3b80d(0x225));});}else await sendTelegram(_0x486c78['chat']['id'],_0x1e9712(0x23a)+_0x329b82),toggleBot(_0x329b82,toggleStatus(_0x329b82),'stopped');}),tgBot[_0x53113e(0x29d)]('metrics',async _0x16f8a8=>{const _0x1696db=_0x53113e,_0x4f7653=getEnabledBots();if(_0x4f7653[_0x1696db(0x144)]==0x0)await sendTelegram(_0x16f8a8['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x4f7653[_0x1696db(0x144)]>0x1){let _0xe71999=[],_0x2e8202=[];const _0x37e859=_0x4f7653[_0x1696db(0x144)]%0x4==0x0||_0x4f7653[_0x1696db(0x144)]%0x4==0x3||_0x4f7653[_0x1696db(0x144)]%0x3==0x1?0x4:0x3;let _0x49def0=0x0;_0x4f7653[_0x1696db(0x1b9)]((_0x4e9615,_0x576129)=>{const _0x884a9c=_0x1696db;if(_0x576129%_0x37e859==0x0)_0x2e8202=[];_0x2e8202['push'](Markup[_0x884a9c(0x282)][_0x884a9c(0x184)](_0x884a9c(0xff)+_0x4e9615[_0x884a9c(0x9a)],_0x884a9c(0x2a0)+_0x4e9615[_0x884a9c(0x9a)])),_0x576129%_0x37e859==0x0&&(_0xe71999[_0x49def0]=_0x2e8202,_0x49def0++);});const _0x148bdf=Markup[_0x1696db(0x1cb)](_0xe71999);_0x16f8a8[_0x1696db(0x1eb)](_0x1696db(0x151),_0x148bdf);}else{const _0x576d7a=_0x4f7653[0x0][_0x1696db(0x9a)];if(pid[_0x576d7a])pid[_0x576d7a]['send']({'function':_0x1696db(0x25c),'args':null});}}}),tgBot[_0x53113e(0xc4)](/metrics_(.+)/,async _0x10d24b=>{const _0xb75bb9=_0x53113e,_0x2fab82=_0x10d24b[_0xb75bb9(0x171)][0x1];_0x10d24b[_0xb75bb9(0xae)]();if(pid[_0x2fab82])pid[_0x2fab82][_0xb75bb9(0x1ab)]({'function':_0xb75bb9(0x25c),'args':null});}),tgBot[_0x53113e(0x29d)](_0x53113e(0x251),async _0x3cd8a2=>{const _0x4597a9=_0x53113e,_0x3459de=getEnabledBots();if(_0x3459de[_0x4597a9(0x144)]==0x0)await sendTelegram(_0x3cd8a2[_0x4597a9(0x28b)]['id'],_0x4597a9(0x192));else{if(_0x3459de[_0x4597a9(0x144)]>0x1){let _0x5c758e=[],_0xc23cd8=[];const _0x31690e=_0x3459de['length']%0x4==0x0||_0x3459de[_0x4597a9(0x144)]%0x4==0x3||_0x3459de[_0x4597a9(0x144)]%0x3==0x1?0x4:0x3;let _0x2189c9=0x0;_0x3459de[_0x4597a9(0x1b9)]((_0x2c31ae,_0x23f945)=>{const _0x32357e=_0x4597a9;if(_0x23f945%_0x31690e==0x0)_0xc23cd8=[];_0xc23cd8[_0x32357e(0x1a7)](Markup[_0x32357e(0x282)][_0x32357e(0x184)](_0x32357e(0xff)+_0x2c31ae[_0x32357e(0x9a)],_0x32357e(0x130)+_0x2c31ae[_0x32357e(0x9a)])),_0x23f945%_0x31690e==0x0&&(_0x5c758e[_0x2189c9]=_0xc23cd8,_0x2189c9++);});const _0x488b2c=Markup['inlineKeyboard'](_0x5c758e);_0x3cd8a2[_0x4597a9(0x1eb)](_0x4597a9(0x145),_0x488b2c);}else{const _0x54640f=_0x3459de[0x0][_0x4597a9(0x9a)];if(pid[_0x54640f])pid[_0x54640f]['send']({'function':_0x4597a9(0x1d4),'args':null});}}}),tgBot[_0x53113e(0xc4)](/portfolio_(.+)/,async _0x1abe56=>{const _0x92c74e=_0x53113e,_0xb81257=_0x1abe56[_0x92c74e(0x171)][0x1];_0x1abe56[_0x92c74e(0xae)]();if(pid[_0xb81257])pid[_0xb81257]['send']({'function':_0x92c74e(0x1d4),'args':null});}),tgBot[_0x53113e(0x29d)](_0x53113e(0xc0),async _0x4604a8=>{const _0xce18d8=_0x53113e;await getMessages();if(!updateAvailable)await sendTelegram(_0x4604a8[_0xce18d8(0x28b)]['id'],_0xce18d8(0x166));else{if(!validInstallation)await sendTelegram(_0x4604a8[_0xce18d8(0x28b)]['id'],_0xce18d8(0x2a1));else{const _0x67a795=Markup[_0xce18d8(0x1cb)]([Markup[_0xce18d8(0x282)][_0xce18d8(0x184)](_0xce18d8(0x121),_0xce18d8(0x16c)),Markup[_0xce18d8(0x282)][_0xce18d8(0x184)]('No',_0xce18d8(0x29e))]);_0x4604a8['reply']('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x67a795);}}}),tgBot[_0x53113e(0xc4)](/update_(.+)/,async _0x57253a=>{const _0x1b0522=_0x53113e,_0x2a13cf=_0x57253a[_0x1b0522(0x171)][0x1];_0x57253a[_0x1b0522(0xae)](),_0x2a13cf==_0x1b0522(0xb9)&&(await sendTelegram(_0x57253a[_0x1b0522(0x28b)]['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB(_0x1b0522(0xc0))),_0x2a13cf=='no'&&await sendTelegram(_0x57253a[_0x1b0522(0x28b)]['id'],_0x1b0522(0x1d1));}),tgBot[_0x53113e(0x29d)]('reinstall',async _0x6a1996=>{const _0x29201e=_0x53113e;if(!validInstallation)await sendTelegram(_0x6a1996[_0x29201e(0x28b)]['id'],_0x29201e(0x252));else{const _0x3c962d=Markup[_0x29201e(0x1cb)]([Markup[_0x29201e(0x282)][_0x29201e(0x184)]('Yes','reinstall_yes'),Markup['button']['callback']('No',_0x29201e(0x27e))]);_0x6a1996[_0x29201e(0x1eb)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x3c962d);}}),tgBot[_0x53113e(0xc4)](/reinstall_(.+)/,async _0x4ebc24=>{const _0x4a9ee9=_0x53113e,_0x1aee09=_0x4ebc24[_0x4a9ee9(0x171)][0x1];_0x4ebc24[_0x4a9ee9(0xae)](),_0x1aee09=='yes'&&(await sendTelegram(_0x4ebc24[_0x4a9ee9(0x28b)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x4a9ee9(0x102))),_0x1aee09=='no'&&await sendTelegram(_0x4ebc24[_0x4a9ee9(0x28b)]['id'],_0x4a9ee9(0x188));}),tgBot[_0x53113e(0x29d)](_0x53113e(0x257),async _0x512a55=>{const _0x2f5012=_0x53113e,_0x2b8089=getBotsWithMode();if(_0x2b8089[_0x2f5012(0x144)]==0x0)await sendTelegram(_0x512a55[_0x2f5012(0x28b)]['id'],_0x2f5012(0x192));else{let _0x5e8dbe=[],_0x16dd5c=[];const _0x43582d=0x2;let _0x282936=0x0;_0x2b8089[_0x2f5012(0x1b9)]((_0xc4224d,_0x3d7ecd)=>{const _0x561b7f=_0x2f5012;if(_0x3d7ecd%_0x43582d==0x0)_0x16dd5c=[];_0x16dd5c[_0x561b7f(0x1a7)](Markup['button']['callback'](_0x561b7f(0xff)+_0xc4224d[_0x561b7f(0x9a)]+'\x20('+_0xc4224d[_0x561b7f(0x1c4)]+')','toggle_'+_0xc4224d[_0x561b7f(0x9a)])),_0x3d7ecd%_0x43582d==0x0&&(_0x5e8dbe[_0x282936]=_0x16dd5c,_0x282936++);});const _0x212d58=Markup[_0x2f5012(0x1cb)](_0x5e8dbe);_0x512a55[_0x2f5012(0x1eb)](_0x2f5012(0x1e6),_0x212d58);}}),tgBot['action'](/toggle_(.+)/,async _0x1af50a=>{const _0x4d0641=_0x53113e,_0x5b1060=_0x1af50a[_0x4d0641(0x171)][0x1];_0x1af50a[_0x4d0641(0xae)]();const _0x8156c7=getBotsWithMode(),_0xbd5ba7=_0x8156c7['find'](_0x5382f6=>_0x5382f6[_0x4d0641(0x9a)]==_0x5b1060),_0x102af1=_0xbd5ba7['mode']==_0x4d0641(0xe5)?_0x4d0641(0x11c):'auto';await sendTelegram(_0x1af50a[_0x4d0641(0x28b)]['id'],_0x4d0641(0x23c)+_0x5b1060+_0x4d0641(0xa4)+_0x102af1+'\x20mode'),toggleBotMode(_0x5b1060);}),tgBot['command'](_0x53113e(0x128),async _0x6db967=>{const _0x48ed4b=_0x53113e;let _0x178804='';config[_0x48ed4b(0x1b9)](_0x3c8c0f=>{const _0x56c676=_0x48ed4b;_0x178804+=_0x56c676(0xff)+_0x3c8c0f[_0x56c676(0x9a)]+':\x20'+_0x3c8c0f[_0x56c676(0x1fb)]+'\x0a';}),await sendTelegram(_0x6db967['chat']['id'],_0x178804,{'parse_mode':_0x48ed4b(0x14f)});}),tgBot['command'](_0x53113e(0x135),async _0x3cd5e5=>{const _0x5df48f=_0x53113e;await sendTelegram(_0x3cd5e5[_0x5df48f(0x28b)]['id'],_0x3aea5d);}),process[_0x53113e(0x9e)](_0x53113e(0xe6),()=>tgBot['stop'](_0x53113e(0xe6))),process['once']('SIGTERM',()=>tgBot[_0x53113e(0xcf)](_0x53113e(0xd0))),tgBot[_0x53113e(0x112)]();}}function _0x4830(_0x1c5028,_0x52e2fd){const _0x21ac85=_0x5898();return _0x4830=function(_0x104cb5,_0x226f6a){_0x104cb5=_0x104cb5-0x97;let _0x5898be=_0x21ac85[_0x104cb5];return _0x5898be;},_0x4830(_0x1c5028,_0x52e2fd);}function disableTelegram(){const _0x39bc2b=_0x3b18e3;tgBot&&tgBot[_0x39bc2b(0xcf)]();}async function sendTelegram(_0x4611df,_0x440dee,_0x27a091){const _0x277205=_0x3b18e3;_0x27a091={..._0x27a091,'disable_web_page_preview':!![]};try{await tgBot['telegram'][_0x277205(0xa0)](_0x4611df,_0x440dee,_0x27a091);}catch(_0x549a80){console[_0x277205(0x139)]('Telegram\x20error:',_0x549a80);}}async function sendTelegramBot(_0x190a8c,_0x3e8d53){const _0x50410a=_0x3b18e3;if(settings[_0x50410a(0x1e0)]){if(settings[_0x50410a(0x177)]=='all'||(_0x3e8d53[_0x50410a(0x1a9)]=='error'||_0x3e8d53[_0x50410a(0x1a9)]==_0x50410a(0x1c3)||_0x3e8d53[_0x50410a(0x1a9)]==_0x50410a(0x280))&&settings['telegramEvents']==_0x50410a(0xab)||_0x3e8d53['type']==_0x50410a(0xfc)&&settings[_0x50410a(0x177)]==_0x50410a(0x27b)){if(tgBot&&settings['telegramChatId']){if(_0x3e8d53[_0x50410a(0x213)])await sendTelegram(settings['telegramChatId'],_0x3e8d53[_0x50410a(0x1fb)]+_0x50410a(0x1e8)+_0x3e8d53['event']);else await sendTelegram(settings[_0x50410a(0xf7)],_0x50410a(0xff)+_0x190a8c+_0x50410a(0x1e8)+_0x3e8d53[_0x50410a(0xdb)]);}}}}async function sendTelegramMsg(_0x14d8ec,_0x12bba9=_0x3b18e3(0x14f)){const _0xeeebd0=_0x3b18e3;return settings[_0xeeebd0(0x1e0)]&&tgBot&&settings[_0xeeebd0(0xf7)]?(await sendTelegram(settings[_0xeeebd0(0xf7)],_0x14d8ec,{'parse_mode':_0x12bba9}),!![]):![];}function getDeviceWithIp(_0x525466){const _0x355b45=_0x3b18e3;return devices[_0x355b45(0x26e)](_0x479ef2=>_0x479ef2['ip']===_0x525466);}async function temporaryAccess2FA(_0x116a4e,_0x46879b){const _0x1ac952=_0x3b18e3;let _0x3167b4=new Date(),_0x3a32f2=![];if(lastIpApproval){if(_0x3167b4-lastIpApproval<0x1388)_0x3a32f2=!![];}lastIpApproval=new Date();if(_0x3a32f2)return;if(tgBot&&settings[_0x1ac952(0xf7)]){const _0x42be9a=uuidRandom();tmpStorage[_0x42be9a]={'uuid':_0x116a4e,'externalip':_0x46879b};const _0x475917=Markup['inlineKeyboard']([Markup[_0x1ac952(0x282)][_0x1ac952(0x184)]('5\x20min',_0x1ac952(0x273)+_0x42be9a),Markup[_0x1ac952(0x282)][_0x1ac952(0x184)](_0x1ac952(0x240),_0x1ac952(0x18e)+_0x42be9a),Markup[_0x1ac952(0x282)][_0x1ac952(0x184)]('30\x20min',_0x1ac952(0x100)+_0x42be9a),Markup[_0x1ac952(0x282)]['callback']('reject',_0x1ac952(0x178)+_0x42be9a)]);await sendTelegram(settings[_0x1ac952(0xf7)],_0x1ac952(0x1a3)+normalizeIP(_0x46879b)[_0x1ac952(0x287)]+'\x20?',_0x475917),tgBot[_0x1ac952(0xc4)](/tempaccess_(.+)_(.+)/,async _0x3922ec=>{const _0x575730=_0x1ac952,_0x42de15=_0x3922ec[_0x575730(0x171)][0x1],_0x5dbd4c=_0x3922ec['match'][0x2],{uuid:_0x40b4ec,externalip:_0x2f41d8}=tmpStorage[_0x5dbd4c];delete tmpStorage[_0x5dbd4c],_0x3922ec['editMessageReplyMarkup'](),devices[_0x40b4ec][_0x575730(0x161)]={'clientip':_0x2f41d8,'timestamp':new Date()[_0x575730(0x124)](),'expiry':_0x42de15},_0x42de15!='reject'?(await sendTelegram(_0x3922ec[_0x575730(0x28b)]['id'],_0x575730(0xb3)+_0x42de15+_0x575730(0x241),{'parse_mode':_0x575730(0x14f)}),io['to'](_0x40b4ec)[_0x575730(0x215)]('status',{'access':{'allow':![],'reason':_0x575730(0x1a8),'token':null}})):(await sendTelegram(_0x3922ec[_0x575730(0x28b)]['id'],_0x575730(0xb1)),io['to'](_0x40b4ec)[_0x575730(0x215)](_0x575730(0x22c),{'access':{'allow':![],'reason':_0x575730(0x227),'token':null}}));});}}async function loginAccess2FA(_0x1d06f1,_0x22ecb7){const _0x27f22f=_0x3b18e3;if(tgBot&&settings[_0x27f22f(0xf7)]){const _0x7e0f9a=uuidRandom();tmpStorage[_0x7e0f9a]={'uuid':_0x1d06f1,'externalip':_0x22ecb7};const _0x923f6e=Markup[_0x27f22f(0x1cb)]([Markup[_0x27f22f(0x282)][_0x27f22f(0x184)](_0x27f22f(0x217),_0x27f22f(0x220)+loginExpiry+'_'+_0x7e0f9a),Markup[_0x27f22f(0x282)]['callback']('reject',_0x27f22f(0x1df)+_0x7e0f9a)]);await sendTelegram(settings['telegramChatId'],_0x27f22f(0xc7)+normalizeIP(_0x22ecb7)[_0x27f22f(0x287)]+'\x20?',_0x923f6e),tgBot['action'](/login2fa_(.+)_(.+)/,async _0xc3564d=>{const _0x5536d4=_0x27f22f,_0x248e8e=_0xc3564d[_0x5536d4(0x171)][0x1],_0x121eb0=_0xc3564d[_0x5536d4(0x171)][0x2],{uuid:_0x4197fd,externalip:_0x122c66}=tmpStorage[_0x121eb0];delete tmpStorage[_0x121eb0],_0xc3564d[_0x5536d4(0xae)](),devices[_0x4197fd][_0x5536d4(0x167)]={'clientip':_0x122c66,'timestamp':new Date()[_0x5536d4(0x124)](),'expiry':_0x248e8e},_0x248e8e!=_0x5536d4(0x132)?(await sendTelegram(_0xc3564d['chat']['id'],_0x5536d4(0xf3),{'parse_mode':'HTML'}),io['to'](_0x4197fd)[_0x5536d4(0x215)]('status',{'access':{'allow':![],'reason':_0x5536d4(0x1a8),'token':null}})):(await sendTelegram(_0xc3564d[_0x5536d4(0x28b)]['id'],_0x5536d4(0x21d)),io['to'](_0x4197fd)[_0x5536d4(0x215)](_0x5536d4(0x22c),{'access':{'allow':![],'reason':_0x5536d4(0x1f6),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3bacdb=_0x3b18e3;return dbConfig['get']('bots')[_0x3bacdb(0x164)](_0x3bacdb(0x9a))[_0x3bacdb(0x296)]({'status':_0x3bacdb(0x1d2)})['value']()||[];}function getDisabledBots(){const _0xd4cbb8=_0x3b18e3;return dbConfig[_0xd4cbb8(0x1be)](_0xd4cbb8(0x118))['sortBy']('botID')['filter']({'status':'disabled'})[_0xd4cbb8(0x246)]()||[];}function getBotAttributes(_0x2e1801){const _0x244ec1=_0x3b18e3;let _0x834f3d={};const _0x14303c=configpath+'bot-'+_0x2e1801+_0x244ec1(0x1f9),_0x3f59b2=fs[_0x244ec1(0x16a)](_0x14303c);if(_0x3f59b2){const _0x1de667=fs[_0x244ec1(0xcb)](_0x14303c);try{const _0x486849=JSON[_0x244ec1(0xc9)](_0x1de667),_0x298afc=_0x486849?_0x486849[_0x244ec1(0x15c)][0x0]['headless']:![];_0x834f3d[_0x244ec1(0x1c4)]=_0x298afc?_0x244ec1(0xe5):'manual',_0x834f3d['botname']=_0x486849?_0x486849[_0x244ec1(0x15c)][0x0][_0x244ec1(0x1fb)]:_0x244ec1(0xff)+_0x2e1801;}catch(_0x2064ab){_0x834f3d[_0x244ec1(0x1c4)]=_0x244ec1(0x11c),_0x834f3d[_0x244ec1(0x1fb)]=_0x244ec1(0xff)+_0x2e1801;}}else _0x834f3d[_0x244ec1(0x1c4)]='manual',_0x834f3d[_0x244ec1(0x1fb)]=_0x244ec1(0xff)+_0x2e1801;return _0x834f3d;}function getBotsWithMode(){const _0x2e4072=_0x3b18e3,_0x4e24a7=dbConfig['get'](_0x2e4072(0x118))[_0x2e4072(0x164)](_0x2e4072(0x9a))[_0x2e4072(0x246)]()||[];return _0x4e24a7['forEach'](_0x3c07e7=>{const _0x2a2de9=_0x2e4072;let _0x383cfa=getBotAttributes(_0x3c07e7[_0x2a2de9(0x9a)]);_0x3c07e7[_0x2a2de9(0x1c4)]=_0x383cfa[_0x2a2de9(0x1c4)];}),_0x4e24a7;}function getBotExchanges(){const _0x557fc6=_0x3b18e3;let _0x583915=[];const _0x58d970=dbConfig['get']('bots')[_0x557fc6(0x164)](_0x557fc6(0x9a))['value']()||[];_0x58d970[_0x557fc6(0x1b9)](_0x27444b=>{const _0x90e540=_0x557fc6;if(_0x27444b[_0x90e540(0x22c)]=='enabled'){const _0x52bd2f=configpath+_0x90e540(0x22d)+_0x27444b[_0x90e540(0x9a)]+'-config.json',_0x1e3513=fs[_0x90e540(0x16a)](_0x52bd2f);let _0x4f8152;if(_0x1e3513){const _0x17f711=fs['readFileSync'](_0x52bd2f);try{const _0x37447b=JSON[_0x90e540(0xc9)](_0x17f711);_0x4f8152=_0x37447b?_0x37447b['bot'][0x0]['exchange']:null;}catch(_0x28a46b){}}if(_0x4f8152)_0x583915[_0x90e540(0x1a7)](_0x4f8152);}});const _0x13a15c=[...new Set(_0x583915)][_0x557fc6(0x1a6)]();return _0x13a15c;}async function initUser(){const _0x4638de=_0x3b18e3;if(!settings['userid']){const _0x5c27e9=uuidRandom();mixpanel[_0x4638de(0x1a1)](_0x5c27e9),updateSetting('userid',_0x5c27e9);}}async function initSecure(){const _0x2f3102=_0x3b18e3;let _0x25b212=getSecure();if(!_0x25b212['hasOwnProperty'](_0x2f3102(0x1f4))){let _0x1f6ff8=await generateKeys();_0x25b212[_0x2f3102(0xde)]=_0x1f6ff8[_0x2f3102(0xde)],_0x25b212['privateKey']=_0x1f6ff8[_0x2f3102(0x150)],_0x25b212[_0x2f3102(0x1f4)]=crypto[_0x2f3102(0x1f7)](0x20)['toString'](_0x2f3102(0xb0));;storeSecure(_0x25b212);}}function getSettings(){const _0x325772=_0x3b18e3;return dbSettings[_0x325772(0x1be)]('settings')['value']()||{};}function getSecure(){const _0x426810=_0x3b18e3;return dbSecure[_0x426810(0x1be)](_0x426810(0x19b))['value']()||{};}function getBlacklist(){const _0x4f4488=_0x3b18e3;return dbSecure['get'](_0x4f4488(0x28c))[_0x4f4488(0x246)]()||[];}function broadcastToBots(_0x2f1bda,_0x300ac1){const _0x5068a9=_0x3b18e3;config[_0x5068a9(0x1b9)](_0x2d0856=>{const _0x331f70=_0x5068a9;if(_0x2d0856[_0x331f70(0x22c)]==_0x331f70(0x1d2)&&_0x2d0856['live']==_0x331f70(0x222)||_0x2d0856[_0x331f70(0x22c)]==_0x331f70(0x17e)&&_0x2d0856[_0x331f70(0x182)]==_0x331f70(0x222)){if(pid[_0x2d0856[_0x331f70(0x9a)]])pid[_0x2d0856[_0x331f70(0x9a)]][_0x331f70(0x1ab)]({[_0x2f1bda]:_0x300ac1});}});}async function storeSettings(_0x2c55f0,_0x34d2bd=![]){const _0x553f4b=_0x3b18e3;_0x2c55f0={...settings,..._0x2c55f0};if(_0x34d2bd&&_0x2c55f0[_0x553f4b(0x15f)]!=_0x553f4b(0x25f)&&_0x2c55f0[_0x553f4b(0x15f)]!=_0x553f4b(0x133)&&_0x2c55f0[_0x553f4b(0x15f)]!=''){const _0x57837f=decryptRSA(secure['privateKey'],_0x2c55f0[_0x553f4b(0x15f)])[_0x553f4b(0x168)]('|@|')[0x0],_0x4c5ee5=bcrypt[_0x553f4b(0x298)](_0x57837f,saltRounds);_0x2c55f0={..._0x2c55f0,'bbPassword':_0x4c5ee5};}if(_0x34d2bd&&_0x2c55f0[_0x553f4b(0x99)]!=_0x553f4b(0x25f)&&_0x2c55f0['telegramToken']!='***'&&_0x2c55f0[_0x553f4b(0x99)]!=''){const _0x37a8dc=decryptRSA(secure[_0x553f4b(0x150)],_0x2c55f0[_0x553f4b(0x99)])[_0x553f4b(0x168)](_0x553f4b(0x147))[0x0];_0x2c55f0={..._0x2c55f0,'telegramToken':_0x37a8dc};}if(_0x34d2bd&&_0x2c55f0[_0x553f4b(0x1dc)]!=_0x553f4b(0x25f)&&_0x2c55f0['marketcapApi']!=_0x553f4b(0x133)&&_0x2c55f0[_0x553f4b(0x1dc)]!=''){const _0x4f46be=decryptRSA(secure['privateKey'],_0x2c55f0[_0x553f4b(0x1dc)])[_0x553f4b(0x168)](_0x553f4b(0x147))[0x0];_0x2c55f0={..._0x2c55f0,'marketcapApi':_0x4f46be};}const _0x3723b4=_0x2c55f0[_0x553f4b(0x99)]!=_0x553f4b(0x25f)&&_0x2c55f0[_0x553f4b(0x99)]!=settings[_0x553f4b(0x99)]||_0x2c55f0[_0x553f4b(0x26a)]!=settings[_0x553f4b(0x26a)],_0x31b5b9=_0x2c55f0[_0x553f4b(0x99)]==''||_0x2c55f0[_0x553f4b(0x26a)]=='',_0x50d770=_0x2c55f0[_0x553f4b(0x1dc)]&&_0x2c55f0[_0x553f4b(0x1dc)]!=_0x553f4b(0x25f)&&_0x2c55f0[_0x553f4b(0x1dc)]!=settings['telegramToken'];_0x3723b4&&(_0x2c55f0[_0x553f4b(0xf7)]=null,_0x2c55f0[_0x553f4b(0x177)]=_0x553f4b(0xc3));for(const [_0x4b1f58,_0x54e91d]of Object[_0x553f4b(0x281)](_0x2c55f0)){if(_0x4b1f58==_0x553f4b(0x99)&&_0x54e91d==_0x553f4b(0x25f)){_0x2c55f0[_0x553f4b(0x99)]=settings['telegramToken'];continue;};if(_0x4b1f58=='bbPassword'&&_0x54e91d==_0x553f4b(0x25f)){_0x2c55f0[_0x553f4b(0x15f)]=settings['bbPassword'];continue;};if(_0x4b1f58=='marketcapApi'&&_0x54e91d==_0x553f4b(0x25f)){_0x2c55f0[_0x553f4b(0x1dc)]=settings[_0x553f4b(0x1dc)];continue;};dbSettings[_0x553f4b(0xfa)](_0x553f4b(0x98)+_0x4b1f58,_0x54e91d)['write']();}settings=_0x2c55f0,io['to'](_0x553f4b(0x13d))[_0x553f4b(0x215)]('settings',cleanSettings()),broadcastToBots(_0x553f4b(0x198),settings['timeshift']),broadcastToBots(_0x553f4b(0x210),settings[_0x553f4b(0x210)]),broadcastToBots('marketcapApi',settings[_0x553f4b(0x1dc)]);if(_0x3723b4&&!_0x31b5b9)initTelegram();if(_0x3723b4&&_0x31b5b9)disableTelegram();getAllClients()['forEach'](_0xb186a1=>{const _0x57f63d=_0x553f4b;getSocket(_0xb186a1['id'])[_0x57f63d(0x215)](_0x57f63d(0x22c),{'access':{'allow':![],'reason':_0x57f63d(0x1a8),'token':null}});}),_0x50d770&&(await sleep(0xbb8),testMarketcapApi(_0x2c55f0[_0x553f4b(0x1dc)]));}async function testMarketcapApi(_0x3c3b9e){const _0x5bb691=_0x3b18e3,_0x3cf65c=[_0x5bb691(0x1b6),'ETH'];try{await axios[_0x5bb691(0x1be)]('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0x3c3b9e},'params':{'symbol':_0x3cf65c[_0x5bb691(0xbe)]()}});}catch(_0x217937){_0x217937[_0x5bb691(0xbe)]()[_0x5bb691(0x275)](_0x5bb691(0x29b))?(io['to'](_0x5bb691(0x13d))[_0x5bb691(0x215)](_0x5bb691(0x13a),_0x5bb691(0xd3)),logger[_0x5bb691(0x12b)](_0x5bb691(0xd3))):(io['to'](_0x5bb691(0x13d))[_0x5bb691(0x215)](_0x5bb691(0x13a),_0x5bb691(0x16e)),logger[_0x5bb691(0x12b)](_0x5bb691(0x16e)),logger['debug'](_0x5bb691(0x18d),_0x217937['toString']()+_0x5bb691(0x10c)+_0x217937['code']));return;}logger[_0x5bb691(0xbf)](_0x5bb691(0x129));}function updateSetting(_0x25a4c5,_0x871e40){const _0x52ecdd=_0x3b18e3;dbSettings[_0x52ecdd(0xfa)]('settings.'+_0x25a4c5,_0x871e40)[_0x52ecdd(0xd8)](),settings=getSettings(),io['to'](_0x52ecdd(0x13d))['emit'](_0x52ecdd(0x115),cleanSettings());}function storeSecure(_0x32b994){const _0x576bdf=_0x3b18e3;dbSecure[_0x576bdf(0x1be)](_0x576bdf(0x19b))[_0x576bdf(0x1a7)](_0x32b994)['write'](),secure=_0x32b994;}function addBlacklist(_0x523373){const _0x40b621=_0x3b18e3;cleanBlacklist();let _0x3fcfa9;devices[_0x523373]['telegramIpApproval']?_0x3fcfa9=Math['max'](devices[_0x523373][_0x40b621(0x161)][_0x40b621(0x9f)],loginExpiry):_0x3fcfa9=loginExpiry,dbSecure['get'](_0x40b621(0x28c))[_0x40b621(0x1a7)]({'expiry':new Date()[_0x40b621(0x124)]()+_0x3fcfa9*0x3c*0x3e8,'token':devices[_0x523373][_0x40b621(0x117)]['token']})['write'](),blacklist=dbSecure['get'](_0x40b621(0x28c))[_0x40b621(0x246)]();}function cleanBlacklist(){const _0x3fd2df=_0x3b18e3;let _0x2c6374=dbSecure[_0x3fd2df(0x1be)](_0x3fd2df(0x28c))[_0x3fd2df(0x250)]()['value'](),_0x4a3212=new Date()[_0x3fd2df(0x124)]();_0x2c6374['forEach'](_0x2ce03d=>{const _0x20cb5b=_0x3fd2df;_0x2ce03d[_0x20cb5b(0x9f)]<_0x4a3212&&dbSecure[_0x20cb5b(0x1be)]('blacklist')[_0x20cb5b(0x234)]({'expiry':_0x2ce03d[_0x20cb5b(0x9f)]})[_0x20cb5b(0xd8)]();});}function initStates(){let _0x35217c=getConfiguration();_0x35217c['forEach'](_0x2fb2c7=>{_0x2fb2c7['live']='stopped';}),storeConfiguration(_0x35217c);}async function generateKeys(){const _0x34e9cb=_0x3b18e3,_0x1513f5=forge[_0x34e9cb(0x1fc)][_0x34e9cb(0x20b)]['generateKeyPair']({'bits':0x1000,'e':0x10001}),_0x17347d=forge[_0x34e9cb(0x1fc)]['privateKeyToPem'](_0x1513f5[_0x34e9cb(0x150)]),_0x475fea=forge[_0x34e9cb(0x1fc)]['publicKeyToPem'](_0x1513f5[_0x34e9cb(0xde)]);return{'privateKey':_0x17347d,'publicKey':_0x475fea};}async function oneTimeMigration(){const _0x508b66=_0x3b18e3;let _0x5ac610=getSettings(),_0x437053=![];!_0x5ac610[_0x508b66(0x253)]('lastmsgtelegram')&&(_0x5ac610[_0x508b66(0x274)]=0x0,_0x437053=!![]);!_0x5ac610['hasOwnProperty'](_0x508b66(0x1c6))&&(_0x5ac610['lastmsgemitted']=0x0,_0x437053=!![]);!_0x5ac610[_0x508b66(0x253)](_0x508b66(0x194))&&(_0x5ac610[_0x508b66(0x194)]=_0x508b66(0x254),_0x437053=!![]);!_0x5ac610[_0x508b66(0x253)](_0x508b66(0x210))&&(_0x5ac610[_0x508b66(0x210)]=![],_0x437053=!![]);!_0x5ac610[_0x508b66(0x253)]('marketcapApi')&&(_0x5ac610['marketcapApi']='',_0x437053=!![]);if(_0x437053)storeSettings(_0x5ac610);try{fs[_0x508b66(0x110)](configbackuppath,{'withFileTypes':!![]})[_0x508b66(0x1b9)](_0x383e96=>{const _0x3f3f21=_0x508b66;if(!_0x383e96[_0x3f3f21(0xaf)]()){if(!_0x383e96[_0x3f3f21(0x231)][_0x3f3f21(0x267)]('backup-full@'))fs[_0x3f3f21(0x1cd)](configbackuppath+_0x383e96[_0x3f3f21(0x231)]);}else fs[_0x3f3f21(0xed)](configbackuppath+_0x383e96[_0x3f3f21(0x231)],{'recursive':!![]});});}catch(_0x428990){logger['debug']('Error\x20removing\x20old\x20backup\x20files:',_0x428990);}}function storeConfiguration(_0x145865){const _0xeb3236=_0x3b18e3;dbConfig[_0xeb3236(0x1be)](_0xeb3236(0x118))[_0xeb3236(0x234)]()[_0xeb3236(0xd8)](),dbConfig['get'](_0xeb3236(0x118))[_0xeb3236(0x1a7)](..._0x145865)[_0xeb3236(0xd8)](),config=_0x145865;}async function resetPassword(){const _0x35619d=_0x3b18e3;if(tgBot&&settings[_0x35619d(0xf7)]){const _0x47a2a1=Markup[_0x35619d(0x1cb)]([Markup[_0x35619d(0x282)][_0x35619d(0x184)](_0x35619d(0xb9),_0x35619d(0x249)),Markup[_0x35619d(0x282)][_0x35619d(0x184)]('no','resetpw_no')]);await sendTelegram(settings[_0x35619d(0xf7)],_0x35619d(0x1f2),_0x47a2a1),tgBot[_0x35619d(0xc4)](/resetpw_(.+)/,async _0x5d4283=>{const _0x2a3b38=_0x35619d,_0x1f8101=_0x5d4283[_0x2a3b38(0x171)][0x1];_0x5d4283[_0x2a3b38(0xae)]();if(_0x1f8101!='no'){const _0x3bc35f=0xf,_0x56e78e=_0x2a3b38(0x1c1),_0x4f18b1=Array['from'](crypto[_0x2a3b38(0x1a0)](new Uint32Array(_0x3bc35f)))['map'](_0x1ce757=>_0x56e78e[_0x1ce757%_0x56e78e[_0x2a3b38(0x144)]])[_0x2a3b38(0x13b)](''),_0x41dee0=bcrypt[_0x2a3b38(0x298)](_0x4f18b1,saltRounds);storeSettings({'bbPassword':_0x41dee0}),await sendTelegram(_0x5d4283[_0x2a3b38(0x28b)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x4f18b1,{'parse_mode':_0x2a3b38(0x14f)});}else await sendTelegram(_0x5d4283['chat']['id'],_0x2a3b38(0x1de));});}}async function confirmRestore(_0x28038b,_0x5a1bcc){const _0x4d7b49=_0x3b18e3;io['to']('botmanager')[_0x4d7b49(0x215)](_0x4d7b49(0x13a),_0x4d7b49(0x189),_0x4d7b49(0x280));if(tgBot&&settings[_0x4d7b49(0xf7)]){const _0x74b437=uuidRandom();tmpStorage[_0x74b437]={'path':_0x28038b,'filename':_0x5a1bcc};const _0x104e63=Markup[_0x4d7b49(0x1cb)]([Markup['button'][_0x4d7b49(0x184)](_0x4d7b49(0xb9),'restore_yes_'+_0x74b437),Markup['button']['callback']('no',_0x4d7b49(0x295)+_0x74b437)]);await sendTelegram(settings[_0x4d7b49(0xf7)],_0x4d7b49(0xaa),_0x104e63),tgBot[_0x4d7b49(0xc4)](/restore_(.+)_(.+)/,async _0x57218b=>{const _0x2b7bc1=_0x4d7b49,_0x2a3804=_0x57218b['match'][0x1],_0x2db1c7=_0x57218b[_0x2b7bc1(0x171)][0x2],{path:_0x53f380,filename:_0x685e4f}=tmpStorage[_0x2db1c7];delete tmpStorage[_0x2db1c7],_0x57218b[_0x2b7bc1(0xae)](),_0x2a3804=='yes'?(logger[_0x2b7bc1(0xbf)](_0x2b7bc1(0x207)),await sendTelegram(_0x57218b[_0x2b7bc1(0x28b)]['id'],_0x2b7bc1(0x242),{'parse_mode':_0x2b7bc1(0x14f)}),unzipFile(_0x53f380,_0x685e4f)):(logger[_0x2b7bc1(0xbf)](_0x2b7bc1(0x285)),await sendTelegram(_0x57218b[_0x2b7bc1(0x28b)]['id'],_0x2b7bc1(0x285)));});}}function getServerTime(){const _0x1f7aa6=_0x3b18e3,_0x461582=new Date();return _0x461582[_0x1f7aa6(0x236)]()+'/'+(_0x461582[_0x1f7aa6(0x299)]()+0x1)[_0x1f7aa6(0xbe)]()[_0x1f7aa6(0x17b)](0x2,'0')+'/'+_0x461582[_0x1f7aa6(0x1af)]()[_0x1f7aa6(0xbe)]()[_0x1f7aa6(0x17b)](0x2,'0')+'\x20'+_0x461582['getHours']()[_0x1f7aa6(0xbe)]()['padStart'](0x2,'0')+':'+_0x461582[_0x1f7aa6(0x22e)]()[_0x1f7aa6(0xbe)]()[_0x1f7aa6(0x17b)](0x2,'0')+':'+_0x461582[_0x1f7aa6(0x22b)]()[_0x1f7aa6(0xbe)]()[_0x1f7aa6(0x17b)](0x2,'0');}function getTimeStamp(){const _0x595d7b=_0x3b18e3,_0x2b8b50=shiftedTime();return _0x2b8b50[_0x595d7b(0x236)]()+'/'+(_0x2b8b50['getMonth']()+0x1)[_0x595d7b(0xbe)]()[_0x595d7b(0x17b)](0x2,'0')+'/'+_0x2b8b50[_0x595d7b(0x1af)]()['toString']()[_0x595d7b(0x17b)](0x2,'0')+'\x20'+_0x2b8b50[_0x595d7b(0xb6)]()[_0x595d7b(0xbe)]()[_0x595d7b(0x17b)](0x2,'0')+':'+_0x2b8b50[_0x595d7b(0x22e)]()['toString']()[_0x595d7b(0x17b)](0x2,'0')+':'+_0x2b8b50[_0x595d7b(0x22b)]()['toString']()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x3464b4=_0x3b18e3,_0x24089d=shiftedTime();return _0x24089d[_0x3464b4(0x236)]()+(_0x24089d[_0x3464b4(0x299)]()+0x1)[_0x3464b4(0xbe)]()[_0x3464b4(0x17b)](0x2,'0')+_0x24089d[_0x3464b4(0x1af)]()['toString']()[_0x3464b4(0x17b)](0x2,'0')+'-'+_0x24089d['getHours']()[_0x3464b4(0xbe)]()['padStart'](0x2,'0')+_0x24089d[_0x3464b4(0x22e)]()[_0x3464b4(0xbe)]()[_0x3464b4(0x17b)](0x2,'0')+_0x24089d[_0x3464b4(0x22b)]()[_0x3464b4(0xbe)]()[_0x3464b4(0x17b)](0x2,'0');}function shiftedTime(){const _0x10b126=_0x3b18e3,_0x1c065b=new Date();let _0x434080=_0x1c065b;if(settings['timeshift']&&settings[_0x10b126(0x198)]!==0x0)_0x434080=fns[_0x10b126(0x12c)](_0x1c065b,{'hours':settings[_0x10b126(0x198)]});return _0x434080;}async function startScheduler(){const _0x529a61=_0x3b18e3,_0x986e59=new Date()[_0x529a61(0xa8)](),_0x15a068=shiftedTime()[_0x529a61(0xb6)]();_0x15a068==0x4&&backupConfigFiles(),_0x15a068==0x0&&rotateLogFiles(),_0x986e59%0x6==0x0&&triggerAnalytics(),_0x986e59%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x467311){const _0x2ff582=_0x3b18e3;logger[_0x2ff582(0xbf)]('Restore\x20backup\x20file\x20'+_0x467311);const _0x93ce23=getBotsWithMode();_0x93ce23[_0x2ff582(0x144)]>0x0?confirmRestore(configbackuppath,_0x467311):unzipFile(configbackuppath,_0x467311);}async function getBackupFiles(_0x7493b2=null){const _0x10d8ac=_0x3b18e3;let _0x2f2a90=[],_0x28ed14=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x28ed14[_0x10d8ac(0x1a6)]((_0x375d7e,_0x40149f)=>_0x375d7e[_0x10d8ac(0x231)]<_0x40149f[_0x10d8ac(0x231)]?0x1:_0x40149f['name']<_0x375d7e[_0x10d8ac(0x231)]?-0x1:0x0),_0x28ed14['forEach'](_0x21f043=>{const _0x430cde=_0x10d8ac;if(!_0x21f043[_0x430cde(0xaf)]()&&_0x21f043[_0x430cde(0x231)]['startsWith'](_0x430cde(0x1b3))&&_0x21f043[_0x430cde(0x231)][_0x430cde(0x1fe)](_0x430cde(0x17c))){const _0x25dc76=formatDate(fs[_0x430cde(0x256)](configbackuppath+_0x21f043[_0x430cde(0x231)])[_0x430cde(0x1a4)]);_0x2f2a90[_0x430cde(0x1a7)]({'name':_0x21f043['name'],'mtime':_0x25dc76});}});if(_0x7493b2)io['to'](_0x7493b2)[_0x10d8ac(0x215)](_0x10d8ac(0x200),_0x2f2a90);else return _0x2f2a90;}async function backupConfigFiles(){const _0x1634c7=_0x3b18e3;await zipFiles(_0x1634c7(0xd4));const _0x3e9d45=getCleanTimeStamp();fs[_0x1634c7(0xce)](zippath+_0x1634c7(0x181),configbackuppath+(_0x1634c7(0x1b3)+_0x3e9d45+_0x1634c7(0x17c)));let _0x1a69c0=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x1a69c0[_0x1634c7(0x1a6)]((_0x7af1ed,_0x2b9b4d)=>_0x7af1ed[_0x1634c7(0x231)]<_0x2b9b4d[_0x1634c7(0x231)]?0x1:_0x2b9b4d[_0x1634c7(0x231)]<_0x7af1ed[_0x1634c7(0x231)]?-0x1:0x0),_0x1a69c0[_0x1634c7(0x144)]>maxBackups&&fs[_0x1634c7(0x1cd)](configbackuppath+_0x1a69c0[_0x1a69c0[_0x1634c7(0x144)]-0x1]['name']);}function rotateLogFiles(){const _0x8d4f93=_0x3b18e3,_0xe0aa69=fs[_0x8d4f93(0x256)](logspath+_0x8d4f93(0x11f)),_0x399c7d=_0xe0aa69[_0x8d4f93(0x289)]/0x400;if(_0x399c7d>0x64){let _0x1332a2=fs[_0x8d4f93(0x110)](logspath,{'withFileTypes':!![]});_0x1332a2[_0x8d4f93(0x1a6)]((_0x48cc4a,_0x336c94)=>_0x48cc4a[_0x8d4f93(0x231)]<_0x336c94[_0x8d4f93(0x231)]?0x1:_0x336c94[_0x8d4f93(0x231)]<_0x48cc4a['name']?-0x1:0x0),_0x1332a2[_0x8d4f93(0x1b9)](_0x1ff549=>{const _0x19ce08=_0x8d4f93;if(_0x1ff549[_0x19ce08(0x231)]==_0x19ce08(0x104))fs[_0x19ce08(0xce)](logspath+_0x1ff549[_0x19ce08(0x231)],logspath+_0x19ce08(0xd1));if(_0x1ff549[_0x19ce08(0x231)]==_0x19ce08(0x1f3))fs['copyFileSync'](logspath+_0x1ff549[_0x19ce08(0x231)],logspath+_0x19ce08(0x104));_0x1ff549[_0x19ce08(0x231)]==_0x19ce08(0x11f)&&(fs[_0x19ce08(0xce)](logspath+_0x1ff549['name'],logspath+_0x19ce08(0x1f3)),fs[_0x19ce08(0x238)](logspath+_0x1ff549[_0x19ce08(0x231)],''));});}}async function zipFiles(_0x468a34){const _0x4d5727=_0x3b18e3;let _0x43c284;if(_0x468a34=='logs')_0x43c284=logspath;if(_0x468a34==_0x4d5727(0xef))_0x43c284=configpath;if(_0x468a34==_0x4d5727(0xd4))_0x43c284=configpath;let _0x554d43=fs[_0x4d5727(0x110)](_0x43c284,{'withFileTypes':!![]});const _0x149b18=new JSZip();_0x554d43['forEach'](_0x4e2e64=>{const _0x1b4dd8=_0x4d5727;if(!_0x4e2e64[_0x1b4dd8(0xaf)]()){let _0x2a0361=fs[_0x1b4dd8(0xcb)](_0x43c284+_0x4e2e64['name']);if(_0x468a34==_0x1b4dd8(0xef)){const _0x2667c6=/^bot-[0-9]{3}-config.json$/,_0xeee7c8=_0x2667c6['test'](_0x4e2e64[_0x1b4dd8(0x231)]);if(_0xeee7c8){const _0x499bbe=JSON[_0x1b4dd8(0xc9)](_0x2a0361);if(_0x499bbe['bot'][0x0]){_0x499bbe[_0x1b4dd8(0x15c)][0x0][_0x1b4dd8(0x21f)]=_0x1b4dd8(0x133),_0x499bbe[_0x1b4dd8(0x15c)][0x0][_0x1b4dd8(0x292)]='***';if(_0x499bbe[_0x1b4dd8(0x15c)][0x0][_0x1b4dd8(0x20f)])_0x499bbe[_0x1b4dd8(0x15c)][0x0][_0x1b4dd8(0x20f)]=_0x1b4dd8(0x133);}_0x2a0361=JSON['stringify'](_0x499bbe,null,0x2);}if(_0x4e2e64[_0x1b4dd8(0x231)]==_0x1b4dd8(0xeb)){const _0x43b119=JSON[_0x1b4dd8(0xc9)](_0x2a0361);if(_0x43b119[_0x1b4dd8(0x115)][_0x1b4dd8(0x21e)])_0x43b119['settings'][_0x1b4dd8(0x21e)]=![];if(_0x43b119[_0x1b4dd8(0x115)][_0x1b4dd8(0x15f)])_0x43b119['settings'][_0x1b4dd8(0x15f)]='***';if(_0x43b119['settings']['telegramToken'])_0x43b119[_0x1b4dd8(0x115)][_0x1b4dd8(0x99)]=_0x1b4dd8(0x133);if(_0x43b119[_0x1b4dd8(0x115)][_0x1b4dd8(0xf7)])_0x43b119[_0x1b4dd8(0x115)]['telegramChatId']=null;if(_0x43b119[_0x1b4dd8(0x115)][_0x1b4dd8(0x1dc)])_0x43b119['settings'][_0x1b4dd8(0x1dc)]='***';_0x2a0361=JSON['stringify'](_0x43b119,null,0x2);}if(_0x4e2e64[_0x1b4dd8(0x231)]!='bb-secure.json')_0x149b18['file'](_0x4e2e64['name'],_0x2a0361);}else _0x149b18['file'](_0x4e2e64[_0x1b4dd8(0x231)],_0x2a0361);}});const _0xbac364=await _0x149b18[_0x4d5727(0x1bb)]({'type':_0x4d5727(0xa3),'base64':![],'compression':_0x4d5727(0x185)});fs[_0x4d5727(0x238)](zippath+(_0x468a34+_0x4d5727(0x17c)),_0xbac364,_0x4d5727(0x111));}async function unzipFile(_0x4ee276,_0x1cc2cc){const _0x5af976=_0x3b18e3;fs[_0x5af976(0x110)](configpath,{'withFileTypes':!![]})[_0x5af976(0x1b9)](_0x366152=>{const _0x98d480=_0x5af976;if(!_0x366152['isDirectory']())fs[_0x98d480(0xed)](configpath+_0x366152[_0x98d480(0x231)]);});const _0x1a903d=fs[_0x5af976(0xcb)](_0x4ee276+_0x1cc2cc,_0x5af976(0x111)),_0x2a60da=await JSZip[_0x5af976(0xf9)](_0x1a903d,{'base64':![],'checkCRC32':!![]});for(const _0x5921bf of Object[_0x5af976(0x1d5)](_0x2a60da[_0x5af976(0x211)])){const _0x18f447=_0x2a60da[_0x5af976(0x211)][_0x5921bf],_0x35c280=await _0x18f447[_0x5af976(0xe9)](_0x5af976(0xa3));fs['writeFileSync'](configpath+_0x18f447[_0x5af976(0x231)],_0x35c280);}fs[_0x5af976(0x110)](temppath,{'withFileTypes':!![]})[_0x5af976(0x1b9)](_0x59ffb8=>{const _0x50721f=_0x5af976;if(!_0x59ffb8[_0x50721f(0xaf)]())fs['rmSync'](temppath+_0x59ffb8[_0x50721f(0x231)]);}),logger['debug'](_0x5af976(0x1e7)),process['send']({'restore':!![]},_0x135f51=>{});}async function getPublicIp(){const _0x142c3c=_0x3b18e3;try{const _0x13291a=await axios['get'](_0x142c3c(0x230));publicip=_0x13291a[_0x142c3c(0x24a)]['ip'];}catch(_0x1bacdc){}}async function triggerAnalytics(){const _0x4ead13=_0x3b18e3;if(!publicip)await getPublicIp();const _0x3fd63f=getBotsWithMode();let _0x2cde85=0x0;_0x3fd63f[_0x4ead13(0x1b9)](_0x434284=>{if(_0x434284['status']==='enabled')_0x2cde85++;});const _0x56ee04=getBotExchanges();mixpanel[_0x4ead13(0x1c0)](_0x4ead13(0xe7),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x3fd63f[_0x4ead13(0x144)],'numbotsenabled':_0x2cde85,'exchanges':_0x56ee04,'environment':environment});}async function getMessages(){const _0x240f07=_0x3b18e3,_0x2c4083='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x3bcf33=new GraphQLClient(_0x2c4083),_0x4ec2ec={'authorization':_0x240f07(0xd6)},_0x37e6e4=serverversion[_0x240f07(0x168)]('.'),_0x45fe4b=_0x37e6e4[0x0]+'.'+_0x37e6e4[0x1],_0x3c2a2c=Math[_0x240f07(0x1cf)](settings['lastmsgtelegram'],settings[_0x240f07(0x1c6)]),_0x2232e5={'last':parseInt(_0x3c2a2c),'bbm':_0x45fe4b},_0x17ba9a=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x156c43;try{_0x156c43=await _0x3bcf33[_0x240f07(0xac)](_0x17ba9a,_0x2232e5,_0x4ec2ec);}catch(_0x5c5802){}if(_0x156c43&&_0x156c43[_0x240f07(0x109)]){let _0x37ff72=settings[_0x240f07(0x274)];newMessages=[];for(const _0x5df5ef of _0x156c43[_0x240f07(0x109)]){newMessages[_0x240f07(0x1a7)](_0x5df5ef);let _0x31982b=![];_0x5df5ef[_0x240f07(0x141)]&&(updateSetting(_0x240f07(0x194),_0x5df5ef[_0x240f07(0x141)]),_0x31982b=isNewerVersion(serverversion,_0x5df5ef[_0x240f07(0x141)])||serverversion==_0x5df5ef['bbvNew']);if(!_0x31982b&&_0x5df5ef[_0x240f07(0x22f)]>_0x37ff72){if(_0x5df5ef[_0x240f07(0x107)]===_0x240f07(0xd7)||serverversion[_0x240f07(0x267)](_0x5df5ef[_0x240f07(0x107)])){let _0x1b1951=''+_0x5df5ef[_0x240f07(0x26f)]+'\x0a\x0a'+_0x5df5ef['message'];const _0x12fd22=await sendTelegramMsg(toTelegramMarkdown(_0x1b1951),_0x240f07(0x27a));if(_0x12fd22)_0x37ff72=_0x5df5ef[_0x240f07(0x22f)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x240f07(0x274),_0x37ff72),emitMessages();}}function emitMessages(){const _0x5d0851=_0x3b18e3,_0x320192=settings[_0x5d0851(0x1c6)];let _0x2e3f4f=[];newMessages['forEach'](_0x1328eb=>{const _0x3cdf44=_0x5d0851;_0x1328eb[_0x3cdf44(0x22f)]>_0x320192&&_0x2e3f4f[_0x3cdf44(0x1a7)](_0x1328eb);}),_0x2e3f4f[_0x5d0851(0x144)]>0x0&&getAllClients()[_0x5d0851(0x1b9)](_0x508acc=>{const _0x39b81e=_0x5d0851;getSocket(_0x508acc['id'])['emit'](_0x39b81e(0x24c),_0x2e3f4f);});}function confirmMessage(_0x1dd62b){const _0x47c796=_0x3b18e3;updateSetting(_0x47c796(0x1c6),Number(_0x1dd62b));}function isNewerVersion(_0x3a47c5,_0x326564){const _0xe67656=_0x3b18e3,_0x243632=_0x326564[_0xe67656(0x168)]('.'),_0x3a2cca=_0x3a47c5[_0xe67656(0x168)]('.');for(var _0x4fcd93=0x0;_0x4fcd93<_0x3a2cca[_0xe67656(0x144)];_0x4fcd93++){const _0x5ccf37=~~_0x3a2cca[_0x4fcd93],_0x13931a=~~_0x243632[_0x4fcd93];if(_0x5ccf37>_0x13931a)return!![];if(_0x5ccf37<_0x13931a)return![];}return![];}function toTelegramMarkdown(_0x4aa10e){const _0x1066c1=_0x3b18e3,_0x45bed0=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x57e32b=/\*{2}(.+?)\*{2}/gim;return _0x4aa10e=_0x4aa10e[_0x1066c1(0x1e9)](_0x45bed0,_0x1066c1(0x262))[_0x1066c1(0x1e9)](_0x57e32b,_0x1066c1(0xf8)),_0x4aa10e;}async function validateConfigFile(){const _0x1b3b4b=_0x3b18e3,_0x424250=dbConfig['get'](_0x1b3b4b(0x118))[_0x1b3b4b(0x164)](_0x1b3b4b(0x9a))[_0x1b3b4b(0x246)]()||[];if(_0x424250[_0x1b3b4b(0x144)]==0x0){let _0x3de5c7=0x0,_0x4a1f0c=[];const _0x7cfa39=/^bot-([0-9]{3})-config.json$/,_0x56e995=fs[_0x1b3b4b(0x110)](configpath);_0x56e995[_0x1b3b4b(0x1b9)](_0x18a1b5=>{const _0x5b8bd2=_0x1b3b4b,_0x141b29=_0x7cfa39[_0x5b8bd2(0x127)](_0x18a1b5);if(_0x141b29){const _0x31dbe7=_0x141b29[0x1];let _0x2a6b1c=getBotAttributes(_0x31dbe7);_0x4a1f0c[_0x5b8bd2(0x1a7)]({'botID':_0x31dbe7,'botname':_0x2a6b1c[_0x5b8bd2(0x1fb)],'status':_0x5b8bd2(0x123),'live':_0x5b8bd2(0x225)}),_0x3de5c7++;}}),_0x3de5c7!=0x0&&(dbConfig[_0x1b3b4b(0x1be)]('bots')[_0x1b3b4b(0x10b)](_0x4a1f0c)[_0x1b3b4b(0xd8)](),config=_0x4a1f0c,restoredConfigFile=_0x3de5c7);}}async function restoreConfigNotify(_0x3fba45){const _0xca9cdb=_0x3b18e3;let _0x153872;if(restoredConfigFile==0x1)_0x153872=_0xca9cdb(0xcc);else _0x153872=_0xca9cdb(0xf1);if(_0x3fba45)io['to'](_0xca9cdb(0x13d))['emit']('notification',_0x153872);else{logger[_0xca9cdb(0x25d)](_0xca9cdb(0xf2)),logger[_0xca9cdb(0x25d)](_0x153872),logger[_0xca9cdb(0x25d)](_0xca9cdb(0xf2)),logger[_0xca9cdb(0x25d)]('');if(tgBot&&settings[_0xca9cdb(0xf7)]&&settings[_0xca9cdb(0x177)]!=_0xca9cdb(0x27b))await sendTelegram(settings[_0xca9cdb(0xf7)],_0xca9cdb(0x18a)+_0x153872);}}function decryptRSA(_0x28e7b1,_0x533f31){const _0x3ffa8f=_0x3b18e3,_0x1a33d0=forge['pki'][_0x3ffa8f(0x14d)](_0x28e7b1),_0xc76f15=_0x1a33d0[_0x3ffa8f(0x278)](forge['util'][_0x3ffa8f(0x1b7)](_0x533f31),_0x3ffa8f(0x19d),{'md':forge['md']['sha256'][_0x3ffa8f(0x158)](),'mgf1':{'md':forge['md'][_0x3ffa8f(0x1a5)][_0x3ffa8f(0x158)]()}});return _0xc76f15;}function validateCredentials(_0x334fea,_0x586cd0){const _0x44b465=_0x3b18e3;if(_0x334fea['username']==settings[_0x44b465(0x12a)]&&bcrypt['compareSync'](_0x334fea[_0x44b465(0x11a)],settings[_0x44b465(0x15f)])){if(settings[_0x44b465(0x247)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x289786=generateLoginToken(_0x586cd0);return{'allow':!![],'reason':_0x44b465(0xfe),'token':_0x289786};}}else return{'allow':![],'reason':_0x44b465(0x20e),'token':null};}function refreshToken(_0x170e13){const _0x43b88b=_0x3b18e3,_0x3c3182=generateLoginToken(_0x170e13);return{'allow':!![],'reason':_0x43b88b(0xfe),'token':_0x3c3182};}function validateAccess(_0x230f9a,_0x2caae1,_0x1710cd){const _0x27abd3=_0x3b18e3,_0x876d70=_0x1710cd?_0x1710cd:devices[_0x2caae1]['ip'];let _0x4c6bba;const _0x4680e9=_0x18a546=>{const _0x3a77cf=_0x4830;if(settings[_0x3a77cf(0x21e)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x2caae1)){const _0x2a6ee7=generateLoginToken(_0x2caae1);return{'allow':!![],'reason':_0x3a77cf(0x1ca),'token':_0x2a6ee7};}else return{'allow':![],'reason':_0x3a77cf(0x10e),'token':null};}else return _0x4c6bba=validToken(_0x18a546,_0x2caae1),_0x4c6bba['hasOwnProperty'](_0x3a77cf(0x280))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x18a546}:{'allow':![],'reason':_0x3a77cf(0x10e),'token':null};}else return{'allow':!![],'reason':_0x3a77cf(0x136),'token':null};};if(settings['whitelistEnabled']){let _0x30e764=[...settings[_0x27abd3(0x122)],_0x27abd3(0x19e),_0x27abd3(0x1e2),_0x27abd3(0x1d7)];if(_0x30e764[_0x27abd3(0x275)](_0x876d70))return _0x4680e9(_0x230f9a);else{_0x4c6bba=validToken(_0x230f9a,_0x2caae1);if(_0x4c6bba['hasOwnProperty'](_0x27abd3(0x280)))return _0x4680e9(_0x230f9a);else{if(telegramIpApproved(_0x2caae1)){const _0x1fbf9e=generateToken(_0x2caae1);return _0x4c6bba=_0x4680e9(_0x230f9a),_0x4c6bba['allow']?{'allow':!![],'reason':_0x27abd3(0x179),'token':_0x1fbf9e}:_0x4c6bba;}else return settings[_0x27abd3(0x1ea)]?{'allow':![],'reason':_0x27abd3(0x294),'token':null}:{'allow':![],'reason':_0x27abd3(0x214),'token':null};}}}else return _0x4680e9(_0x230f9a);}function timelyDecrypt(_0x2ece1d,_0x164963,_0x481726='@'){const _0x4e7b33=_0x3b18e3;if(_0x2ece1d)try{const _0xb1b0e7=decryptRSA(secure[_0x4e7b33(0x150)],_0x2ece1d),_0x1e60c1=_0xb1b0e7[_0x4e7b33(0x168)](_0x481726)[0x0],_0x4827b6=_0xb1b0e7[_0x4e7b33(0x168)](_0x481726)[0x1],_0xa5079=new Date()['getTime']();if(_0x164963){if(_0xa5079-_0x4827b6<maxSecretAge*0x3e8)return _0x1e60c1;else return![];}else return _0x1e60c1;}catch(_0x296117){return![];}else return![];}const validToken=(_0x3a23dc,_0x39ea15)=>{const _0x14d651=_0x3b18e3,_0x595776=devices[_0x39ea15]['ip'];if(!_0x3a23dc)return{'error':_0x14d651(0xc5)};for(let _0x500fc9 of blacklist){if(_0x500fc9[_0x14d651(0x13c)]==_0x3a23dc)return{'error':_0x14d651(0x243)};}let _0x23c4f6;try{_0x23c4f6=jwt[_0x14d651(0xe4)](_0x3a23dc,secure[_0x14d651(0x1f4)]+_0x39ea15);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x23c4f6[_0x14d651(0x253)](_0x14d651(0x17a))&&!_0x23c4f6[_0x14d651(0x253)](_0x14d651(0x16f))||!_0x23c4f6[_0x14d651(0x253)]('exp'))return{'error':_0x14d651(0xc8)};if(!_0x23c4f6[_0x14d651(0x253)](_0x14d651(0x16f))&&_0x23c4f6[_0x14d651(0x253)](_0x14d651(0x17a))){const {clientip:_0xefa37c}=_0x23c4f6;return _0x595776==_0xefa37c?{'success':_0x14d651(0x1bd)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x23c4f6[_0x14d651(0x253)](_0x14d651(0x16f))&&_0x23c4f6[_0x14d651(0x253)](_0x14d651(0x17a))){const {username:_0x254246,clientip:_0x110500}=_0x23c4f6;return settings[_0x14d651(0x12a)]==_0x254246&&_0x595776==_0x110500?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x143d80=>{const _0xeb41cc=_0x3b18e3;if(_0x143d80){const _0x27ad6d=devices[_0x143d80]['ip'];return jwt[_0xeb41cc(0x219)]({'username':settings[_0xeb41cc(0x12a)],'clientip':_0x27ad6d},secure[_0xeb41cc(0x1f4)]+_0x143d80,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x5dff32=>{const _0x11293f=_0x3b18e3;if(_0x5dff32){const _0x1ea116=devices[_0x5dff32]['ip'];return jwt[_0x11293f(0x219)]({'clientip':_0x1ea116},secure[_0x11293f(0x1f4)]+_0x5dff32,{'expiresIn':devices[_0x5dff32][_0x11293f(0x161)][_0x11293f(0x9f)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x50f335=>{const _0x421b87=_0x3b18e3;let _0x423ea9=![];return devices[_0x50f335][_0x421b87(0x161)]&&devices[_0x50f335]['telegramIpApproval']['expiry']!=_0x421b87(0x132)&&(_0x423ea9=devices[_0x50f335]['telegramIpApproval']['clientip']==devices[_0x50f335]['ip']&&new Date()[_0x421b87(0x124)]()-devices[_0x50f335][_0x421b87(0x161)][_0x421b87(0x244)]<devices[_0x50f335][_0x421b87(0x161)][_0x421b87(0x9f)]*0x3c*0x3e8),_0x423ea9;},telegram2FaApproved=_0x26618b=>{const _0x4eaacb=_0x3b18e3;let _0x2ba511=![];return devices[_0x26618b][_0x4eaacb(0x167)]&&devices[_0x26618b][_0x4eaacb(0x167)][_0x4eaacb(0x9f)]!=_0x4eaacb(0x132)&&(_0x2ba511=devices[_0x26618b][_0x4eaacb(0x167)][_0x4eaacb(0x17a)]==devices[_0x26618b]['ip']&&new Date()[_0x4eaacb(0x124)]()-devices[_0x26618b][_0x4eaacb(0x167)][_0x4eaacb(0x244)]<devices[_0x26618b]['telegram2FaApproval'][_0x4eaacb(0x9f)]*0x3c*0x3e8),_0x2ba511;},normalizeIP=_0x4c8267=>{const _0x55e635=_0x3b18e3;let _0x2c2c99=null,_0x517567=null;if(ipaddr['isValid'](_0x4c8267)){const _0x2b1fe5=ipaddr[_0x55e635(0xc9)](_0x4c8267);_0x2b1fe5[_0x55e635(0x20c)]()===_0x55e635(0x119)?(_0x2b1fe5['isIPv4MappedAddress']()&&(_0x2c2c99=_0x2b1fe5[_0x55e635(0x268)]()[_0x55e635(0xbe)]()),_0x517567=_0x2b1fe5[_0x55e635(0xbe)]()):(_0x2c2c99=_0x2b1fe5[_0x55e635(0xbe)](),_0x517567=_0x2b1fe5['toIPv4MappedAddress']()[_0x55e635(0xbe)]());}return{'show':_0x2c2c99?_0x2c2c99:_0x517567,'store':_0x517567};};function formatDate(_0x555cb6){const _0x38f612=_0x3b18e3;return _0x555cb6[_0x38f612(0x236)]()+'/'+(_0x555cb6[_0x38f612(0x299)]()+0x1)[_0x38f612(0xbe)]()['padStart'](0x2,'0')+'/'+_0x555cb6[_0x38f612(0x1af)]()[_0x38f612(0xbe)]()['padStart'](0x2,'0')+'\x20'+_0x555cb6['getHours']()[_0x38f612(0xbe)]()['padStart'](0x2,'0')+':'+_0x555cb6[_0x38f612(0x22e)]()[_0x38f612(0xbe)]()[_0x38f612(0x17b)](0x2,'0')+':'+_0x555cb6[_0x38f612(0x22b)]()['toString']()[_0x38f612(0x17b)](0x2,'0');}function sleep(_0x59ec63){return new Promise(_0x5cf222=>setTimeout(_0x5cf222,_0x59ec63));}