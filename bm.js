const _0x3e55d8=_0xddb9;(function(_0x31b4a7,_0x50cf3e){const _0x427925=_0xddb9,_0x4b11f3=_0x31b4a7();while(!![]){try{const _0x319059=-parseInt(_0x427925(0x35b))/0x1*(-parseInt(_0x427925(0x3a6))/0x2)+-parseInt(_0x427925(0x224))/0x3*(-parseInt(_0x427925(0x206))/0x4)+-parseInt(_0x427925(0x205))/0x5+-parseInt(_0x427925(0x2ff))/0x6+-parseInt(_0x427925(0x2d2))/0x7+-parseInt(_0x427925(0x2bc))/0x8+parseInt(_0x427925(0x386))/0x9;if(_0x319059===_0x50cf3e)break;else _0x4b11f3['push'](_0x4b11f3['shift']());}catch(_0x45279e){_0x4b11f3['push'](_0x4b11f3['shift']());}}}(_0x5f5c,0x8fcb8));const _0x66efaa=function(){let _0x527e52=!![];return function(_0x5a824b,_0x12097a){const _0xc2a91=_0x527e52?function(){const _0x31b9cd=_0xddb9;if(_0x12097a){const _0x192760=_0x12097a[_0x31b9cd(0x223)](_0x5a824b,arguments);return _0x12097a=null,_0x192760;}}:function(){};return _0x527e52=![],_0xc2a91;};}(),_0x1b68d6=_0x66efaa(this,function(){const _0x2eea3a=_0xddb9;return _0x1b68d6[_0x2eea3a(0x374)]()[_0x2eea3a(0x265)](_0x2eea3a(0x200))[_0x2eea3a(0x374)]()[_0x2eea3a(0x3c7)](_0x1b68d6)[_0x2eea3a(0x265)](_0x2eea3a(0x200));});_0x1b68d6();'use strict';process[_0x3e55d8(0x34b)][_0x3e55d8(0x1cf)]=0x1;const childProcess=require(_0x3e55d8(0x36e)),fs=require('fs'),fns=require(_0x3e55d8(0x380)),low=require(_0x3e55d8(0x3a8)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x3e55d8(0x3b8)),crypto=require(_0x3e55d8(0x28f)),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require(_0x3e55d8(0x337))[_0x3e55d8(0x3b7)],bcrypt=require(_0x3e55d8(0x2f2)),jwt=require('jsonwebtoken'),ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process[_0x3e55d8(0x371)]['slice'](0x2))[_0x3e55d8(0x371)],uuidRandom=require(_0x3e55d8(0x3c2)),{Telegraf,Markup}=require(_0x3e55d8(0x263)),Mixpanel=require('mixpanel'),axios=require(_0x3e55d8(0x1c9)),{GraphQLClient,gql}=require(_0x3e55d8(0x32e)),util=require(_0x3e55d8(0x23f)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x3e55d8(0x24f)]||_0x3e55d8(0x2ca),pattern=/^[0-9]{2,4}$/;!pattern[_0x3e55d8(0x357)](PORT)&&(console[_0x3e55d8(0x353)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x3e55d8(0x231)),process[_0x3e55d8(0x2dc)](0x1));const HOST=argv[_0x3e55d8(0x1e3)]||null,userID=argv[_0x3e55d8(0x1f2)]||'',debugging=argv['d']||![],nodeversion=process[_0x3e55d8(0x2b0)][_0x3e55d8(0x319)];let bbpath=_0x3e55d8(0x27c),bbpath2='';const botfile=_0x3e55d8(0x2ae),configfile='bb-config.json',settingsfile=_0x3e55d8(0x269),securefile='bb-secure.json',environment=require('./'+bbpath2+_0x3e55d8(0x3cd))[_0x3e55d8(0x1fd)]||'production',maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3e55d8(0x377)),configpath=userID?bbpath+_0x3e55d8(0x356)+userID+'/':bbpath+_0x3e55d8(0x356),configbackuppath=configpath+'backup/',logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x3e55d8(0x3ad),zippath=userID?bbpath+_0x3e55d8(0x1d0)+userID+'/':bbpath+_0x3e55d8(0x1d0),loggerfile=fs[_0x3e55d8(0x2bf)](logspath+_0x3e55d8(0x202),{'flags':'a'}),temppath=userID?bbpath+_0x3e55d8(0x25a)+userID+'/':bbpath+_0x3e55d8(0x25a);!fs[_0x3e55d8(0x1d1)](configpath)&&fs[_0x3e55d8(0x363)](configpath);!fs[_0x3e55d8(0x1d1)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x3e55d8(0x363)](logspath);!fs['existsSync'](zippath)&&fs[_0x3e55d8(0x363)](zippath);!fs[_0x3e55d8(0x1d1)](temppath)&&fs[_0x3e55d8(0x363)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x3e55d8(0x3d7)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3e55d8(0x3d7)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x3e55d8(0x1d5),'onepagemode':![],'marketcapApi':''}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x3e55d8(0x3d7)]({'secure':{},'blacklist':[]})[_0x3e55d8(0x34c)]();let crypt=new Crypt({'md':_0x3e55d8(0x2b4),'rsaStandard':_0x3e55d8(0x2ef)});const saltRounds=0xa,mixpanel=Mixpanel[_0x3e55d8(0x26f)](_0x3e55d8(0x309),{'host':_0x3e55d8(0x36a)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x3e55d8(0x239)]&&(settings[_0x3e55d8(0x239)]!=''&&settings[_0x3e55d8(0x239)]!=_0x3e55d8(0x3b0))&&settings[_0x3e55d8(0x25c)]&&settings[_0x3e55d8(0x25c)]!='')initTelegram();const parseColor=(_0x313a72,_0x5219b9)=>{const _0xc42543=_0x3e55d8,_0xd91342=/#[A-Z]{3}#/g;if(typeof _0x313a72=='string'){!_0x5219b9?_0x313a72=_0x313a72['replace'](_0xd91342,''):(_0x313a72=_0x313a72[_0xc42543(0x37e)](/#BLU#/g,'\x1b[34m'),_0x313a72=_0x313a72['replace'](/#RED#/g,'\x1b[31m'),_0x313a72=_0x313a72[_0xc42543(0x37e)](/#YEL#/g,'\x1b[33m'),_0x313a72=_0x313a72['replace'](/#MAG#/g,'\x1b[35m'),_0x313a72=_0x313a72[_0xc42543(0x37e)](/#CYA#/g,'\x1b[36m'),_0x313a72=_0x313a72[_0xc42543(0x37e)](/#RES#/g,_0xc42543(0x347)));;}return _0x313a72;},logger={'screen':_0x3cfb5d=>{console['log'](parseColor(_0x3cfb5d,!![]));},'simple':_0x3559a9=>{const _0x7ff1cf=_0x3e55d8;console[_0x7ff1cf(0x353)](parseColor(_0x3559a9,!![])),loggerfile[_0x7ff1cf(0x34c)](util[_0x7ff1cf(0x274)](parseColor(_0x3559a9,![]))+'\x0a');},'full':async _0x15d7d6=>{const _0x17b3ce=_0x3e55d8,_0x29f812=getTimeStamp()+_0x17b3ce(0x34d)+_0x15d7d6;console[_0x17b3ce(0x353)](parseColor(_0x29f812,!![])),loggerfile[_0x17b3ce(0x34c)](util[_0x17b3ce(0x274)](parseColor(_0x29f812,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x17b3ce(0x2e9))await sendTelegram(settings[_0x17b3ce(0x2a4)],_0x17b3ce(0x1e7)+parseColor(_0x15d7d6,![]));},'debug':async(_0x676fb3,_0xaa4f25='')=>{const _0x5c72bd=_0x3e55d8,_0x44ea6d=getTimeStamp()+_0x5c72bd(0x20b)+_0x676fb3;if(debugging)console['log'](parseColor(_0x44ea6d,!![]));loggerfile[_0x5c72bd(0x34c)](util['format'](parseColor(_0x44ea6d,![]))+'\x0a');if(_0xaa4f25){if(debugging)console[_0x5c72bd(0x353)](_0xaa4f25);loggerfile[_0x5c72bd(0x34c)](util[_0x5c72bd(0x274)](_0xaa4f25)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x676821){const _0x3ae935=_0x3e55d8;_0x676821[_0x3ae935(0x374)]()[_0x3ae935(0x2df)](_0x3ae935(0x287))?(logger[_0x3ae935(0x3a9)](_0x3ae935(0x1fa)+_0x676821[_0x3ae935(0x24f)]+'#RES#'),process[_0x3ae935(0x294)]({'terminate':!![]},_0x4279ca=>{})):logger['simple'](_0x676821);}),process['on'](_0x3e55d8(0x2dc),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x3e55d8(0x318),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x3e55d8(0x2e2),()=>{const _0x409bba=_0x3e55d8;stopAllBots(),process[_0x409bba(0x2dc)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x3e55d8(0x3cd))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x3e55d8(0x2ad)),app=express(),http=require(_0x3e55d8(0x3c5))['createServer'](app);app[_0x3e55d8(0x310)](fileUpload({'useTempFiles':!![]})),app[_0x3e55d8(0x333)]('/download/:type',async(_0x52d170,_0x10fba2)=>{const _0xea3073=_0x3e55d8,_0xea4555=_0x52d170['params'][_0xea3073(0x2de)],_0x5d005d=getClientsWithBotID('botmanager'),_0x57203a=_0x52d170[_0xea3073(0x2c6)][_0xea3073(0x21e)],_0x4285bb=timelyDecrypt(_0x57203a,![]),_0x55a10c=_0x5d005d[_0xea3073(0x1db)](_0x1101b8=>_0x1101b8['uuid']==_0x4285bb);if(_0x55a10c){const _0x31de99=normalizeIP(_0x52d170['socket'][_0xea3073(0x22d)])['store'],_0x2ae7ad=_0x52d170[_0xea3073(0x2c6)]['tkn'];if(validateAccess(_0x2ae7ad,_0x4285bb,_0x31de99)[_0xea3073(0x368)])_0xea4555==_0xea3073(0x2cd)&&await backupConfigFiles(),await zipFiles(_0xea4555),_0x10fba2[_0xea3073(0x348)](zippath+(_0xea4555+_0xea3073(0x284)),_0x440e52=>{const _0x641dc0=_0xea3073;_0x440e52&&(logger[_0x641dc0(0x279)](_0x641dc0(0x393)+_0xea4555),logger[_0x641dc0(0x3a9)](_0x440e52));});else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0xea4555+_0xea3073(0x23b));}else logger[_0xea3073(0x279)](_0xea3073(0x346)+_0xea4555+_0xea3073(0x235));}),app[_0x3e55d8(0x3ba)](_0x3e55d8(0x26a),async(_0x399b66,_0x51f92e)=>{const _0x1d5aa5=_0x3e55d8,_0x4af3fb=getClientsWithBotID('botmanager'),_0x34f740=_0x399b66['headers'][_0x1d5aa5(0x21e)],_0x12a842=timelyDecrypt(_0x34f740,![]),_0x11ee1b=_0x4af3fb[_0x1d5aa5(0x1db)](_0x2b1b8f=>_0x2b1b8f['uuid']==_0x12a842);logger[_0x1d5aa5(0x256)](_0x1d5aa5(0x399));if(_0x11ee1b){const _0x19a648=normalizeIP(_0x399b66[_0x1d5aa5(0x382)]['remoteAddress'])[_0x1d5aa5(0x3d6)],_0x30e2a5=_0x399b66[_0x1d5aa5(0x2c6)]['tkn'];if(validateAccess(_0x30e2a5,_0x12a842,_0x19a648)['allow']){if(_0x399b66[_0x1d5aa5(0x260)]){const _0x18fc2d=_0x399b66[_0x1d5aa5(0x260)][_0x1d5aa5(0x352)];await _0x18fc2d['mv'](temppath+_0x18fc2d[_0x1d5aa5(0x32b)]),_0x51f92e[_0x1d5aa5(0x294)]({'status':!![],'message':'File\x20uploaded'});const _0x266497=getBotsWithMode();_0x266497[_0x1d5aa5(0x320)]>0x0?confirmRestore(temppath,_0x18fc2d[_0x1d5aa5(0x32b)]):unzipFile(temppath,_0x18fc2d['name']);}}else logger['full'](_0x1d5aa5(0x360));}else logger[_0x1d5aa5(0x279)](_0x1d5aa5(0x306));}),app[_0x3e55d8(0x310)](express['static'](path['join'](__dirname,bbpath2,_0x3e55d8(0x307)))),app[_0x3e55d8(0x310)](express[_0x3e55d8(0x38f)](path[_0x3e55d8(0x2d4)](__dirname,bbpath2,_0x3e55d8(0x1cd)))),app[_0x3e55d8(0x333)]('/',function(_0x23f38d,_0x1244c2){const _0x189ecf=_0x3e55d8;_0x1244c2[_0x189ecf(0x388)](path['join'](__dirname,bbpath2,'build2',_0x189ecf(0x29a)));}),app['get'](_0x3e55d8(0x241),function(_0x5f45a7,_0x5c466f){const _0x49db2c=_0x3e55d8;_0x5c466f['sendFile'](path[_0x49db2c(0x2d4)](__dirname,bbpath2,_0x49db2c(0x1cd),_0x49db2c(0x29a)));}),app[_0x3e55d8(0x333)]('/:bot/portfolio',(_0x4f1810,_0x539066)=>{const _0x526cb1=_0x3e55d8;_0x539066[_0x526cb1(0x388)](path[_0x526cb1(0x2d4)](__dirname,bbpath2,_0x526cb1(0x1cd),_0x526cb1(0x29a)));}),app[_0x3e55d8(0x333)](_0x3e55d8(0x1f0),(_0xb3376b,_0x2eb30d)=>{const _0x178057=_0x3e55d8;_0x2eb30d[_0x178057(0x388)](path[_0x178057(0x2d4)](__dirname,bbpath2,'build',_0x178057(0x29a)));}),app['get']('/:bot/coins',(_0x5a5c30,_0x48eb1c)=>{const _0x55e9ad=_0x3e55d8;_0x48eb1c[_0x55e9ad(0x388)](path[_0x55e9ad(0x2d4)](__dirname,bbpath2,_0x55e9ad(0x1cd),_0x55e9ad(0x29a)));}),app[_0x3e55d8(0x333)](_0x3e55d8(0x1c8),(_0x21830a,_0x4d8e28)=>{const _0x14050d=_0x3e55d8;_0x4d8e28[_0x14050d(0x388)](path[_0x14050d(0x2d4)](__dirname,bbpath2,_0x14050d(0x1cd),'index.html'));}),app[_0x3e55d8(0x333)]('/:bot/configuration',(_0xef25f7,_0x1b2d8f)=>{const _0x280f27=_0x3e55d8;_0x1b2d8f['sendFile'](path[_0x280f27(0x2d4)](__dirname,bbpath2,'build','index.html'));}),app['get'](_0x3e55d8(0x1f7),(_0x3687fc,_0x17aa89)=>{const _0x49aa83=_0x3e55d8;_0x17aa89['sendFile'](path['join'](__dirname,bbpath2,_0x49aa83(0x1cd),'index.html'));});if(HOST)http[_0x3e55d8(0x2da)](PORT,HOST);else http[_0x3e55d8(0x2da)](PORT);const io=require(_0x3e55d8(0x2a3))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1d4cad=_0x3e55d8;let _0x5a7ed7=_0x1d4cad(0x349);const _0x37ea6c=networkInterfaces(),_0x5cc731={};for(const _0x1cd458 of Object[_0x1d4cad(0x28a)](_0x37ea6c)){for(const _0x22ab4b of _0x37ea6c[_0x1cd458]){if((_0x22ab4b[_0x1d4cad(0x2e4)]=='IPv4'||_0x22ab4b[_0x1d4cad(0x2e4)]==0x4)&&!_0x22ab4b[_0x1d4cad(0x2ba)]){const _0x5196fb=ipaddr['parse'](_0x22ab4b[_0x1d4cad(0x27f)])[_0x1d4cad(0x39e)]();_0x5196fb!=_0x1d4cad(0x381)&&(!_0x5cc731[_0x1cd458]&&(_0x5cc731[_0x1cd458]=[]),_0x5cc731[_0x1cd458][_0x1d4cad(0x27d)](_0x22ab4b['address']),_0x5a7ed7=_0x22ab4b[_0x1d4cad(0x27f)]);}}}return{'serverip':_0x5a7ed7,'netinterfaces':_0x5cc731};}async function startServer(){const _0x1ce207=_0x3e55d8,{serverip:_0x4484aa,netinterfaces:_0x43347f}=getServerIP();logger[_0x1ce207(0x3a9)](''),logger['simple'](_0x1ce207(0x298)),await logger[_0x1ce207(0x279)](_0x1ce207(0x2f1)+serverversion+_0x1ce207(0x324)+(environment=='staging'?_0x1ce207(0x303):'')+'\x0a'+(_0x1ce207(0x36b)+PORT+_0x1ce207(0x316))+('=>\x20Go\x20to\x20#CYA#http://'+_0x4484aa+':'+PORT+_0x1ce207(0x338))),logger[_0x1ce207(0x3a9)]('-----------------------------------------------------------------------------------');if(config[_0x1ce207(0x320)]!=0x0)for(const _0x508cbf of config){const _0x1c5de4=_0x508cbf[_0x1ce207(0x2cb)]==_0x1ce207(0x355)?'a':'m';if(_0x508cbf[_0x1ce207(0x3bc)]=='enabled'||_0x508cbf[_0x1ce207(0x3bc)]==_0x1ce207(0x1ef))await logger[_0x1ce207(0x279)](_0x1ce207(0x358)+_0x1c5de4+_0x1ce207(0x365)+_0x508cbf[_0x1ce207(0x219)]+_0x1ce207(0x2bb)+_0x508cbf[_0x1ce207(0x2d8)]),startBot([_0x508cbf[_0x1ce207(0x219)],userID],{'cwd':bbpath},function(_0x1da7bf){const _0x29649b=_0x1ce207;if(_0x1da7bf)logger[_0x29649b(0x279)](_0x1da7bf);});else(_0x508cbf[_0x1ce207(0x3bc)]==_0x1ce207(0x3c1)||_0x508cbf[_0x1ce207(0x3bc)]==_0x1ce207(0x272))&&await logger[_0x1ce207(0x279)](_0x1ce207(0x304)+_0x1c5de4+')\x20\x20\x20|\x20Bot\x20'+_0x508cbf['botID']+_0x1ce207(0x2bb)+_0x508cbf[_0x1ce207(0x2d8)]);}else!newBot&&logger[_0x1ce207(0x3a9)](_0x1ce207(0x34e));if(newBot)addBot();logger[_0x1ce207(0x3a9)](_0x1ce207(0x298)),logger[_0x1ce207(0x3a9)](''),await logger['debug'](_0x1ce207(0x21f)+nodeversion),await logger[_0x1ce207(0x256)](_0x1ce207(0x1f3),_0x43347f);}function startSocket(){const _0x5d883c=_0x3e55d8;io['on'](_0x5d883c(0x23a),_0x4b307d=>{const _0x491bf6=_0x5d883c;let _0x8665bc,_0x294892,_0xdaa31e,_0xcf318e,_0x3e55cb;const _0x2bcc84=_0x4b307d[_0x491bf6(0x37d)][_0x491bf6(0x2c6)][_0x491bf6(0x39d)];_0x294892=_0x2bcc84[_0x491bf6(0x1e6)](/bot[0-9]{3}/);if(_0x294892)_0xdaa31e=_0x294892[0x0][_0x491bf6(0x1e6)](/[0-9]{3}/);if(_0xdaa31e)_0x8665bc=_0xdaa31e[0x0];else _0x8665bc=_0x491bf6(0x1ce);const _0x20d806=_0x4b307d[_0x491bf6(0x37d)]['auth'][_0x491bf6(0x38e)];if(!_0x20d806)_0x4b307d['emit'](_0x491bf6(0x3bc),{'publicKey':secure[_0x491bf6(0x27a)]});else{_0xcf318e=timelyDecrypt(_0x20d806,![]);if(!_0xcf318e)_0x4b307d[_0x491bf6(0x24b)](_0x491bf6(0x3bc),{'publicKey':secure[_0x491bf6(0x27a)]});else{_0x3e55cb=normalizeIP(_0x4b307d[_0x491bf6(0x3db)]['remoteAddress'])['store'];if(!devices[_0xcf318e])devices[_0xcf318e]={'uuid':_0xcf318e,'access':{'token':null}};devices[_0xcf318e]['ip']=_0x3e55cb;const _0x572dca=addClient(_0x4b307d['id'],_0xcf318e,_0x8665bc);setAccess(_0x572dca),emitMessages(),_0x4b307d['on'](_0x491bf6(0x314),_0x5297b0=>{const _0x2fbd72=_0x491bf6,_0x1c732c=timelyDecrypt(_0x5297b0[_0x2fbd72(0x30a)],!![],_0x2fbd72(0x212));if(_0x1c732c){_0x5297b0={'username':_0x5297b0[_0x2fbd72(0x299)],'password':_0x1c732c},devices[_0xcf318e][_0x2fbd72(0x364)]=validateCredentials(_0x5297b0,_0xcf318e);if(devices[_0xcf318e][_0x2fbd72(0x364)][_0x2fbd72(0x368)]==![]&&devices[_0xcf318e][_0x2fbd72(0x364)][_0x2fbd72(0x300)]==_0x2fbd72(0x1de))_0x4b307d['emit'](_0x2fbd72(0x3bc),{'access':devices[_0xcf318e][_0x2fbd72(0x364)]}),loginAccess2FA(_0xcf318e,_0x3e55cb);else{if(devices[_0xcf318e][_0x2fbd72(0x364)][_0x2fbd72(0x368)]==![]&&devices[_0xcf318e]['access'][_0x2fbd72(0x300)]=='invalid\x20credentials')_0x4b307d['emit'](_0x2fbd72(0x3bc),{'access':devices[_0xcf318e]['access']});else devices[_0xcf318e][_0x2fbd72(0x364)][_0x2fbd72(0x368)]&&devices[_0xcf318e]['access']['reason']=='login\x20token\x20generated'&&(getClientsWithUuid(_0xcf318e)['forEach'](_0x45ce5c=>{setAccess(_0x45ce5c);}),logger[_0x2fbd72(0x256)](_0x2fbd72(0x1e1)+_0xcf318e[_0x2fbd72(0x2b6)](-0x8)),setTokenRefresh(_0xcf318e),setSessionTimeout(_0x2fbd72(0x314),_0xcf318e));}}else logger['full'](_0x2fbd72(0x254));}),_0x4b307d['on'](_0x491bf6(0x3c6),()=>{resetPassword();}),_0x4b307d['on']('disconnect',_0x43b781=>{removeClient(_0x4b307d['id']);}),_0x8665bc=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x120cf5){const _0x1c3e10=_0x3e55d8;if(_0x120cf5!=_0x1c3e10(0x1ce)&&config[_0x1c3e10(0x283)]!=''){if(pid[_0x120cf5])pid[_0x120cf5]['send']({'function':'initclient','args':null});}_0x120cf5!=_0x1c3e10(0x1ce)&&broadcastToBots(_0x1c3e10(0x232),JSON[_0x1c3e10(0x3cb)](config));}function reloadBotManager(){const _0x1ccd71=_0x3e55d8;getClientsWithBotID('botmanager')[_0x1ccd71(0x2c2)](_0x460918=>{getSocket(_0x460918['id'])['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x260e3f){const _0x4d1072=_0x3e55d8;return io[_0x4d1072(0x1c4)][_0x4d1072(0x1c4)][_0x4d1072(0x333)](_0x260e3f);}function setAccess(_0x582ef1){const _0x195072=_0x3e55d8,_0x4b61bd=getSocket(_0x582ef1['id']),_0x4a38be=_0x582ef1[_0x195072(0x21e)],_0x255b89=_0x582ef1[_0x195072(0x21d)];devices[_0x4a38be][_0x195072(0x364)]=validateAccess(devices[_0x4a38be]['access']['token'],_0x4a38be),logger['debug'](_0x195072(0x21c)+devices[_0x4a38be][_0x195072(0x364)]['reason']+_0x195072(0x35c)+_0x582ef1['id']['slice'](-0x8)+'\x20|\x20user:\x20...'+_0x4a38be[_0x195072(0x2b6)](-0x8)),_0x4b61bd[_0x195072(0x2d4)](_0x4a38be);if(devices[_0x4a38be][_0x195072(0x364)][_0x195072(0x368)]){_0x4b61bd[_0x195072(0x2d4)](_0x255b89);if(_0x255b89==_0x195072(0x1ce))initializeSocketBotManager(_0x4b61bd);else initializeSocketBot(_0x4b61bd);initClient(_0x255b89);}devices[_0x4a38be][_0x195072(0x364)][_0x195072(0x2db)]&&devices[_0x4a38be]['access']['reason']==_0x195072(0x3d1)&&setSessionTimeout(_0x195072(0x1ca),_0x4a38be),devices[_0x4a38be][_0x195072(0x364)]['token']&&devices[_0x4a38be][_0x195072(0x364)]['reason']==_0x195072(0x33e)&&setSessionTimeout('login',_0x4a38be),_0x4b61bd[_0x195072(0x24b)](_0x195072(0x3bc),{'status':_0x582ef1['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4a38be]['access'],'externalip':devices[_0x4a38be]['ip'],'publicKey':secure[_0x195072(0x27a)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x4a38be][_0x195072(0x364)][_0x195072(0x368)]==![]&&devices[_0x4a38be][_0x195072(0x364)][_0x195072(0x300)]==_0x195072(0x2ed)&&temporaryAccess2FA(_0x4a38be,devices[_0x4a38be]['ip']);}function setSessionTimeout(_0x2de93d,_0x5de9ca){const _0x83ed9a=_0x3e55d8;let _0x3cbb64;if(_0x2de93d==_0x83ed9a(0x314))_0x3cbb64=loginExpiry*0x3c*0x3e8;else _0x3cbb64=devices[_0x5de9ca][_0x83ed9a(0x1f9)]['expiry']*0x3c*0x3e8-(new Date()[_0x83ed9a(0x292)]()-devices[_0x5de9ca]['telegramIpApproval']['timestamp']);if(devices[_0x5de9ca][_0x83ed9a(0x366)])clearTimeout(devices[_0x5de9ca]['pidExpireLogin']);devices[_0x5de9ca][_0x83ed9a(0x366)]=setTimeout(()=>{const _0x54ce36=_0x83ed9a;if(devices[_0x5de9ca][_0x54ce36(0x1c6)])clearTimeout(devices[_0x5de9ca][_0x54ce36(0x1c6)]);removeSocketListeners(_0x5de9ca),addBlacklist(_0x5de9ca),devices[_0x5de9ca][_0x54ce36(0x1f9)]=null,devices[_0x5de9ca][_0x54ce36(0x342)]=null,devices[_0x5de9ca]['access']['token']=null,logger[_0x54ce36(0x256)](_0x54ce36(0x370)+_0x5de9ca[_0x54ce36(0x2b6)](-0x8)),devices[_0x5de9ca][_0x54ce36(0x364)]=validateAccess(devices[_0x5de9ca][_0x54ce36(0x364)]['token'],_0x5de9ca),!(devices[_0x5de9ca][_0x54ce36(0x364)][_0x54ce36(0x368)]&&devices[_0x5de9ca][_0x54ce36(0x364)][_0x54ce36(0x300)]=='login\x20not\x20required')&&(_0x2de93d=='login'?io['to'](_0x5de9ca)[_0x54ce36(0x24b)](_0x54ce36(0x3bc),{'access':{'allow':![],'reason':_0x54ce36(0x30b),'token':null}}):io['to'](_0x5de9ca)[_0x54ce36(0x24b)](_0x54ce36(0x3bc),{'access':{'allow':![],'reason':_0x54ce36(0x345),'token':null}})),devices[_0x5de9ca]['access'][_0x54ce36(0x2db)]=null;},_0x3cbb64);}function setTokenRefresh(_0x16b176){const _0x425441=_0x3e55d8;if(devices[_0x16b176][_0x425441(0x1c6)])clearTimeout(devices[_0x16b176][_0x425441(0x1c6)]);devices[_0x16b176]['pidRefreshToken']=setTimeout(()=>{const _0x3c58af=_0x425441;getClientsWithUuid(_0x16b176)[_0x3c58af(0x320)]!=0x0?(devices[_0x16b176][_0x3c58af(0x364)]=refreshToken(_0x16b176),io['to'](_0x16b176)['emit'](_0x3c58af(0x3bc),{'status':_0x3c58af(0x326),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x16b176][_0x3c58af(0x364)],'externalip':devices[_0x16b176]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x16b176)):clearTimeout(devices[_0x16b176][_0x3c58af(0x1c6)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x420e0d){const _0x442dfb=_0x3e55d8,_0x4b21ea=getClient(_0x420e0d['id'])[_0x442dfb(0x21e)];_0x420e0d[_0x442dfb(0x24b)](_0x442dfb(0x232),config),_0x420e0d['emit']('settings',cleanSettings()),_0x420e0d['on'](_0x442dfb(0x394),_0x13fff2=>{const _0x38b81c=_0x442dfb;if(validateAccess(_0x13fff2,_0x4b21ea)[_0x38b81c(0x368)])addBot();else logger['full'](_0x38b81c(0x2b5));}),_0x420e0d['on'](_0x442dfb(0x31c),(_0x5a6f02,_0x364daf)=>{const _0x5ccf42=_0x442dfb;if(validateAccess(_0x364daf,_0x4b21ea)[_0x5ccf42(0x368)])toggleBot(_0x5a6f02[_0x5ccf42(0x219)],_0x5a6f02[_0x5ccf42(0x3bc)],_0x5a6f02[_0x5ccf42(0x2cf)]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x420e0d['on'](_0x442dfb(0x1eb),(_0x186977,_0x2f775a)=>{const _0x4a963e=_0x442dfb;if(validateAccess(_0x2f775a,_0x4b21ea)['allow'])toggleBotMode(_0x186977);else logger[_0x4a963e(0x279)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x420e0d['on']('delete-bot',(_0x1e63c8,_0x3a75a4)=>{const _0x2d4fb1=_0x442dfb;if(validateAccess(_0x3a75a4,_0x4b21ea)[_0x2d4fb1(0x368)])deleteBot(_0x1e63c8);else logger[_0x2d4fb1(0x279)](_0x2d4fb1(0x248));}),_0x420e0d['on'](_0x442dfb(0x329),(_0x11eecb,_0x566988)=>{const _0x2fa618=_0x442dfb;if(validateAccess(_0x566988,_0x4b21ea)[_0x2fa618(0x368)])storeSettings(_0x11eecb,!![]);else logger[_0x2fa618(0x279)](_0x2fa618(0x313));}),_0x420e0d['on']('update-bb',_0x120bfc=>{const _0x2aac6a=_0x442dfb;if(validateAccess(_0x120bfc,_0x4b21ea)[_0x2aac6a(0x368)])updateBB('update');else logger['full'](_0x2aac6a(0x255));}),_0x420e0d['on'](_0x442dfb(0x3ca),_0x59d04e=>{const _0x3d48cd=_0x442dfb;if(validateAccess(_0x59d04e,_0x4b21ea)['allow'])updateBB(_0x3d48cd(0x37f));else logger[_0x3d48cd(0x279)](_0x3d48cd(0x341));}),_0x420e0d['on'](_0x442dfb(0x38b),_0x19ebcc=>{const _0x56685f=_0x442dfb;if(validateAccess(_0x19ebcc,_0x4b21ea)[_0x56685f(0x368)]){const _0x5295fb=getClient(_0x420e0d['id']);if(_0x5295fb)getBackupFiles(_0x5295fb['uuid']);else logger[_0x56685f(0x279)](_0x56685f(0x238));}else logger[_0x56685f(0x279)](_0x56685f(0x1ed));}),_0x420e0d['on'](_0x442dfb(0x3dd),(_0x5c0074,_0x4b8651)=>{const _0x547f94=_0x442dfb;if(validateAccess(_0x4b8651,_0x4b21ea)[_0x547f94(0x368)])restoreBackupFile(_0x5c0074);else logger[_0x547f94(0x279)](_0x547f94(0x2b2));}),_0x420e0d['on'](_0x442dfb(0x3a1),_0x5535b1=>{const _0x5bb8ab=_0x442dfb;if(validateAccess(_0x5535b1,_0x4b21ea)['allow'])getMessages();else logger[_0x5bb8ab(0x279)](_0x5bb8ab(0x257));}),_0x420e0d['on'](_0x442dfb(0x3c9),(_0x543958,_0x27ddfc)=>{const _0x96e5e1=_0x442dfb;if(validateAccess(_0x27ddfc,_0x4b21ea)[_0x96e5e1(0x368)])confirmMessage(_0x543958);else logger[_0x96e5e1(0x279)](_0x96e5e1(0x2f6));}),_0x420e0d['on']('logout',_0x820043=>{const _0x75435d=_0x442dfb;if(validateAccess(_0x820043,_0x4b21ea)[_0x75435d(0x368)]){if(devices[_0x4b21ea][_0x75435d(0x1c6)])clearTimeout(devices[_0x4b21ea]['pidRefreshToken']);if(devices[_0x4b21ea][_0x75435d(0x366)])clearTimeout(devices[_0x4b21ea][_0x75435d(0x366)]);removeSocketListeners(getClient(_0x420e0d['id'])[_0x75435d(0x21e)]),addBlacklist(_0x4b21ea),devices[_0x4b21ea][_0x75435d(0x1f9)]=null,devices[_0x4b21ea][_0x75435d(0x342)]=null,devices[_0x4b21ea][_0x75435d(0x364)][_0x75435d(0x2db)]=null,logger[_0x75435d(0x256)](_0x75435d(0x2be)+_0x4b21ea[_0x75435d(0x2b6)](-0x8)),io['to'](getClient(_0x420e0d['id'])['uuid'])['emit'](_0x75435d(0x3bc),{'access':{'allow':![],'reason':_0x75435d(0x2d6),'token':null}});}else logger[_0x75435d(0x279)](_0x75435d(0x1c1));});}function initializeSocketBot(_0x3ec2d1){const _0x42a5ad=_0x3e55d8,_0x3f2818=getClient(_0x3ec2d1['id'])['bot'],_0xea1223=getClient(_0x3ec2d1['id'])[_0x42a5ad(0x21e)];_0x3ec2d1['on'](_0x42a5ad(0x3ae),(_0x311ac7,_0x16f025)=>{const _0x276488=_0x42a5ad;if(validateAccess(_0x16f025,_0xea1223)[_0x276488(0x368)]){if(pid[_0x3f2818])pid[_0x3f2818]['send']({'function':_0x276488(0x2ab),'args':_0x311ac7});}else logger[_0x276488(0x279)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x3ec2d1['on'](_0x42a5ad(0x32a),(_0x56d08e,_0x10cc4c)=>{const _0x10d435=_0x42a5ad;if(validateAccess(_0x10cc4c,_0xea1223)[_0x10d435(0x368)]){if(pid[_0x3f2818])pid[_0x3f2818][_0x10d435(0x294)]({'function':'deleteHistoryAlerts','args':_0x56d08e});}else logger[_0x10d435(0x279)](_0x10d435(0x33c));}),_0x3ec2d1['on'](_0x42a5ad(0x376),(_0x6bd9bf,_0x420c10)=>{const _0xa1fec1=_0x42a5ad;if(validateAccess(_0x420c10,_0xea1223)[_0xa1fec1(0x368)]){if(pid[_0x3f2818])pid[_0x3f2818]['send']({'function':_0xa1fec1(0x230),'args':_0x6bd9bf});}else logger[_0xa1fec1(0x279)](_0xa1fec1(0x3aa));}),_0x3ec2d1['on']('store-configuration',(_0x4e66db,_0x33ea15)=>{const _0x49c78f=_0x42a5ad;if(validateAccess(_0x33ea15,_0xea1223)[_0x49c78f(0x368)]){if(pid[_0x3f2818])pid[_0x3f2818][_0x49c78f(0x294)]({'function':_0x49c78f(0x29d),'args':_0x4e66db});}else logger[_0x49c78f(0x279)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x3ec2d1['on'](_0x42a5ad(0x2e7),(_0x54a7df,_0x4f1ab6)=>{const _0x34663b=_0x42a5ad;if(validateAccess(_0x4f1ab6,_0xea1223)[_0x34663b(0x368)]){if(pid[_0x3f2818])pid[_0x3f2818]['send']({'function':_0x34663b(0x2c0),'args':_0x54a7df});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x3ec2d1['on']('store-fiat',(_0x4bd35f,_0x3943e0)=>{const _0xbbb551=_0x42a5ad;if(validateAccess(_0x3943e0,_0xea1223)[_0xbbb551(0x368)]){if(pid[_0x3f2818])pid[_0x3f2818][_0xbbb551(0x294)]({'function':_0xbbb551(0x2e3),'args':_0x4bd35f});}else logger['full'](_0xbbb551(0x350));}),_0x3ec2d1['on'](_0x42a5ad(0x2a5),_0x55a1ee=>{const _0x57cb04=_0x42a5ad;if(validateAccess(_0x55a1ee,_0xea1223)[_0x57cb04(0x368)]){if(pid[_0x3f2818])pid[_0x3f2818][_0x57cb04(0x294)]({'function':_0x57cb04(0x233),'args':null});}else logger['full'](_0x57cb04(0x278));}),_0x3ec2d1['on'](_0x42a5ad(0x29e),_0x5b9ee9=>{const _0x186e48=_0x42a5ad;if(validateAccess(_0x5b9ee9,_0xea1223)['allow']){if(pid[_0x3f2818])pid[_0x3f2818]['send']({'function':_0x186e48(0x2b1),'args':null});}else logger[_0x186e48(0x279)](_0x186e48(0x340));}),_0x3ec2d1['on'](_0x42a5ad(0x392),(_0x56f297,_0x5eed34)=>{const _0x1524ae=_0x42a5ad;if(validateAccess(_0x5eed34,_0xea1223)[_0x1524ae(0x368)]){if(pid[_0x3f2818])pid[_0x3f2818][_0x1524ae(0x294)]({'function':'placeOrder','args':_0x56f297});}else logger[_0x1524ae(0x279)](_0x1524ae(0x33d));}),_0x3ec2d1['on'](_0x42a5ad(0x389),_0x545ac0=>{const _0x2b869a=_0x42a5ad;if(validateAccess(_0x545ac0,_0xea1223)[_0x2b869a(0x368)]){if(pid[_0x3f2818])pid[_0x3f2818]['send']({'function':_0x2b869a(0x35a),'args':null});}else logger[_0x2b869a(0x279)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x3ec2d1['on'](_0x42a5ad(0x31f),_0x3ebfea=>{const _0x35f0ea=_0x42a5ad;if(validateAccess(_0x3ebfea,_0xea1223)['allow']){if(pid[_0x3f2818])pid[_0x3f2818]['send']({'function':_0x35f0ea(0x3b2),'args':null});}else logger['full'](_0x35f0ea(0x2e0));}),_0x3ec2d1['on']('update-bb',_0x1ed999=>{const _0x15622e=_0x42a5ad;if(validateAccess(_0x1ed999,_0xea1223)[_0x15622e(0x368)])updateBB(_0x15622e(0x308));else logger['full'](_0x15622e(0x255));}),_0x3ec2d1['on'](_0x42a5ad(0x3a1),_0x256a13=>{const _0x23c9e5=_0x42a5ad;if(validateAccess(_0x256a13,_0xea1223)[_0x23c9e5(0x368)])getMessages();else logger[_0x23c9e5(0x279)](_0x23c9e5(0x257));}),_0x3ec2d1['on'](_0x42a5ad(0x3c9),(_0x38e5f5,_0x25ff44)=>{const _0x4fc1b9=_0x42a5ad;if(validateAccess(_0x25ff44,_0xea1223)[_0x4fc1b9(0x368)])confirmMessage(_0x38e5f5);else logger[_0x4fc1b9(0x279)](_0x4fc1b9(0x2f6));}),_0x3ec2d1['on'](_0x42a5ad(0x25f),_0x959662=>{const _0x299ca4=_0x42a5ad;if(validateAccess(_0x959662,_0xea1223)[_0x299ca4(0x368)]){if(devices[_0xea1223]['pidRefreshToken'])clearTimeout(devices[_0xea1223]['pidRefreshToken']);if(devices[_0xea1223][_0x299ca4(0x366)])clearTimeout(devices[_0xea1223][_0x299ca4(0x366)]);removeSocketListeners(getClient(_0x3ec2d1['id'])[_0x299ca4(0x21e)]),addBlacklist(_0xea1223),devices[_0xea1223]['telegramIpApproval']=null,devices[_0xea1223][_0x299ca4(0x342)]=null,devices[_0xea1223][_0x299ca4(0x364)][_0x299ca4(0x2db)]=null,logger[_0x299ca4(0x256)](_0x299ca4(0x2be)+_0xea1223[_0x299ca4(0x2b6)](-0x8)),io['to'](getClient(_0x3ec2d1['id'])[_0x299ca4(0x21e)])[_0x299ca4(0x24b)]('status',{'access':{'allow':![],'reason':_0x299ca4(0x2d6),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x42fb19){const _0x2934b7=_0x3e55d8;getClientsWithUuid(_0x42fb19)[_0x2934b7(0x2c2)](_0x1fd3a3=>{const _0x2f4fa1=_0x2934b7;getSocket(_0x1fd3a3['id'])[_0x2f4fa1(0x211)]();});}function cleanSettings(){const _0xb22a1b=_0x3e55d8;let _0x55854f=settings;return settings[_0xb22a1b(0x239)]&&settings[_0xb22a1b(0x239)]!=''&&(_0x55854f={..._0x55854f,'telegramToken':_0xb22a1b(0x1d3)}),settings[_0xb22a1b(0x293)]&&settings[_0xb22a1b(0x293)]!=''&&(_0x55854f={..._0x55854f,'bbPassword':_0xb22a1b(0x1d3)}),settings[_0xb22a1b(0x2ec)]&&settings[_0xb22a1b(0x2ec)]!=''&&(_0x55854f={..._0x55854f,'marketcapApi':'************'}),(settings[_0xb22a1b(0x293)]&&settings[_0xb22a1b(0x293)]==_0xb22a1b(0x3b0)||settings[_0xb22a1b(0x239)]&&settings[_0xb22a1b(0x239)]==_0xb22a1b(0x3b0)||settings[_0xb22a1b(0x2ec)]&&settings['marketcapApi']==_0xb22a1b(0x3b0))&&(_0x55854f={..._0x55854f,'restored':{'password':settings[_0xb22a1b(0x293)]==_0xb22a1b(0x3b0),'telegram':settings[_0xb22a1b(0x239)]==_0xb22a1b(0x3b0),'marketcap':settings[_0xb22a1b(0x2ec)]==_0xb22a1b(0x3b0)}}),_0x55854f;}async function updateBB(_0x3a07d5){const _0x3b0277=_0x3e55d8;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x4520ec=>{const _0x4547a2=_0xddb9;restartBot(_0x4520ec[_0x4547a2(0x219)]);});if(_0x3a07d5==_0x3b0277(0x308))process[_0x3b0277(0x294)]({'update':!![],'environment':environment},_0x4f04d3=>{});else _0x3a07d5==_0x3b0277(0x37f)&&process[_0x3b0277(0x294)]({'reinstall':!![],'environment':environment},_0x3d79e3=>{});}function startBot(_0x48862c,_0x3bf1ce,_0x443593){const _0x38104f=_0x3e55d8;if(debugging)_0x48862c['push']('-d');let _0x258eae=![];const _0x1f219a=_0x48862c[0x0];_0x3bf1ce={..._0x3bf1ce,'stdio':[_0x38104f(0x26c),_0x38104f(0x26c),'inherit',_0x38104f(0x2d0)]},pid[_0x1f219a]=childProcess[_0x38104f(0x3d2)](botfile,_0x48862c,_0x3bf1ce),pid[_0x1f219a]['on'](_0x38104f(0x1f6),_0x3487ef=>{const _0x3ca1fe=_0x38104f;switch(Object['keys'](_0x3487ef)[0x0]){case'botname':updateBotName(_0x1f219a,_0x3487ef[_0x3ca1fe(0x2d8)]);break;case _0x3ca1fe(0x2e8):updateBotManager();break;case'status':updateStatus(_0x1f219a,_0x3487ef[_0x3ca1fe(0x3bc)]);break;case _0x3ca1fe(0x2cf):updateLive(_0x1f219a,_0x3487ef[_0x3ca1fe(0x2cf)]);break;case _0x3ca1fe(0x2af):updateLive(_0x1f219a,_0x3487ef[_0x3ca1fe(0x2af)]),io['to'](_0x1f219a)[_0x3ca1fe(0x24b)](_0x3ca1fe(0x3bc),{'access':{'allow':![],'reason':'reload','token':null}});break;case'stop':_0x3487ef[_0x3ca1fe(0x3bd)]==_0x3ca1fe(0x2f4)&&restartBot(_0x1f219a);_0x3487ef[_0x3ca1fe(0x3bd)]==_0x3ca1fe(0x21b)&&toggleBot(_0x1f219a,_0x3ca1fe(0x3c1),'stopped');break;case'telegram':sendTelegramBot(_0x1f219a,_0x3487ef[_0x3ca1fe(0x286)]);break;case _0x3ca1fe(0x315):sendTelegramMsg(_0x3487ef['telegrammsg']);break;case _0x3ca1fe(0x249):io['to'](_0x1f219a)[_0x3ca1fe(0x24b)](_0x3487ef['function'],_0x3487ef[_0x3ca1fe(0x1dc)]);break;}}),pid[_0x1f219a]['on'](_0x38104f(0x234),function(_0x362203){if(_0x258eae)return;_0x258eae=!![],_0x443593(_0x362203);}),pid[_0x1f219a]['on']('exit',async function(_0x2442d5){const _0x2f1f9a=_0x38104f;if(terminating)return;if(installingUpdate){logger[_0x2f1f9a(0x256)](_0x2f1f9a(0x369)),io[_0x2f1f9a(0x22c)]();return;}if(_0x258eae)return;_0x258eae=!![],_0x443593(null);const _0x5e001b=dbConfig[_0x2f1f9a(0x333)]('bots')[_0x2f1f9a(0x1db)]({'botID':_0x1f219a})['value']();_0x5e001b&&(_0x5e001b['status']==_0x2f1f9a(0x2fa)||_0x5e001b[_0x2f1f9a(0x3bc)]==_0x2f1f9a(0x1ef))&&(await sleep(0x3e8),updateLive(_0x1f219a,_0x2f1f9a(0x3a4)),logger[_0x2f1f9a(0x279)](_0x2f1f9a(0x330)+_0x1f219a),startBot([_0x1f219a,userID],{'cwd':bbpath},function(_0x4d1cc6){const _0x3f97a6=_0x2f1f9a;if(_0x4d1cc6)logger[_0x3f97a6(0x279)](_0x4d1cc6);}));});}function stopBot(_0x68d78e){const _0x182106=_0x3e55d8;getClientsWithBotID(_0x68d78e)[_0x182106(0x2c2)](_0x23760d=>{const _0x3ecc11=_0x182106;getSocket(_0x23760d['id'])[_0x3ecc11(0x3be)](!![]),removeClient(_0x23760d['id']);}),pid[_0x68d78e]&&(pid[_0x68d78e][_0x182106(0x21b)](),pid[_0x68d78e]=null);}function stopAllBots(){terminating=!![];const _0x250a64=getEnabledBots();_0x250a64['forEach'](_0x9196d2=>{stopBot(_0x9196d2['botID']);});}function restartBot(_0x352a80){if(pid[_0x352a80])pid[_0x352a80]['kill']();}function addBot(){const _0x412680=_0x3e55d8;let _0x3ff2c4;for(let _0x588ca5=0x1;_0x588ca5<0x3e9;_0x588ca5++){_0x3ff2c4=_0x588ca5[_0x412680(0x374)]()['padStart'](0x3,'0');let _0x1e5be9=config[_0x412680(0x1db)](_0x1f5d40=>_0x1f5d40[_0x412680(0x219)]==_0x3ff2c4);if(!_0x1e5be9)break;}if(_0x3ff2c4===_0x412680(0x264)){logger[_0x412680(0x279)](_0x412680(0x22b));return;}logger['full'](_0x412680(0x207)+_0x3ff2c4),dbConfig[_0x412680(0x333)](_0x412680(0x232))[_0x412680(0x27d)]({'botID':_0x3ff2c4,'botname':_0x412680(0x2bd)+_0x3ff2c4,'status':'new','live':''})[_0x412680(0x34c)](),startBot([_0x3ff2c4,userID],{'cwd':bbpath},function(_0x5bb699){const _0x19b3c3=_0x412680;if(_0x5bb699)logger[_0x19b3c3(0x279)](_0x5bb699);}),config=getConfiguration(),io['to']('botmanager')[_0x412680(0x24b)](_0x412680(0x232),config),broadcastToBots(_0x412680(0x232),JSON[_0x412680(0x3cb)](config));}function deleteBot(_0x280cd2){const _0x13b335=_0x3e55d8;getClientsWithBotID(_0x280cd2)[_0x13b335(0x2c2)](_0x204f4f=>{const _0x2ff9a8=_0x13b335;getSocket(_0x204f4f['id'])[_0x2ff9a8(0x3be)](!![]),removeClient(_0x204f4f['id']);}),dbConfig[_0x13b335(0x333)]('bots')['remove']({'botID':_0x280cd2})[_0x13b335(0x34c)](),logger[_0x13b335(0x279)](_0x13b335(0x3c4)+_0x280cd2),stopBot(_0x280cd2);try{if(fs[_0x13b335(0x1d1)](path[_0x13b335(0x2d4)](configpath,_0x13b335(0x24d)+_0x280cd2+_0x13b335(0x2c9))))fs[_0x13b335(0x295)](path[_0x13b335(0x2d4)](configpath,_0x13b335(0x24d)+_0x280cd2+_0x13b335(0x2c9)));if(fs[_0x13b335(0x1d1)](path[_0x13b335(0x2d4)](configpath,_0x13b335(0x24d)+_0x280cd2+'-events.json')))fs['unlinkSync'](path[_0x13b335(0x2d4)](configpath,_0x13b335(0x24d)+_0x280cd2+'-events.json'));if(fs[_0x13b335(0x1d1)](path[_0x13b335(0x2d4)](configpath,_0x13b335(0x24d)+_0x280cd2+_0x13b335(0x2d5))))fs['unlinkSync'](path[_0x13b335(0x2d4)](configpath,_0x13b335(0x24d)+_0x280cd2+_0x13b335(0x2d5)));if(fs['existsSync'](path[_0x13b335(0x2d4)](configpath,_0x13b335(0x24d)+_0x280cd2+_0x13b335(0x21a))))fs[_0x13b335(0x295)](path['join'](configpath,'bot-'+_0x280cd2+_0x13b335(0x21a)));}catch(_0x2b474){if(_0x2b474)logger[_0x13b335(0x279)](_0x13b335(0x1e5),_0x2b474);}config=getConfiguration(),io['to'](_0x13b335(0x1ce))['emit'](_0x13b335(0x232),config),broadcastToBots(_0x13b335(0x232),JSON['stringify'](config));}function toggleBot(_0x37dc36,_0x4a2ccb,_0x57a566){const _0x26088a=_0x3e55d8;dbConfig['get'](_0x26088a(0x232))[_0x26088a(0x1db)]({'botID':_0x37dc36})[_0x26088a(0x1e9)]({'status':_0x4a2ccb})[_0x26088a(0x1e9)]({'live':_0x57a566})['write']();if(_0x4a2ccb==_0x26088a(0x2fa)||_0x4a2ccb==_0x26088a(0x1ef))logger[_0x26088a(0x279)](_0x26088a(0x39f)+_0x37dc36),startBot([_0x37dc36,userID],{'cwd':bbpath},function(_0x7fe92f){if(_0x7fe92f)logger['full'](_0x7fe92f);});else(_0x4a2ccb=='disabled'||_0x4a2ccb==_0x26088a(0x272))&&(logger[_0x26088a(0x279)](_0x26088a(0x23d)+_0x37dc36),stopBot(_0x37dc36));config=getConfiguration(),io['to'](_0x26088a(0x1ce))[_0x26088a(0x24b)](_0x26088a(0x232),config),broadcastToBots('bots',JSON[_0x26088a(0x3cb)](config));}function _0x5f5c(){const _0x25b586=['reject','store-settings','delete-alerts','name','timeshift','login2fa_','graphql-request','Telegraf\x20error:','Restarting\x20Bot\x20','getUTCHours','split','get','apiSecret','bb-secure.json','*$1*','hybrid-crypto-js','#RES#\x20if\x20running\x20on\x20server','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','readFileSync','tempaccess_30_','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','2FA\x20login\x20token\x20generated','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','telegram2FaApproval','privateKey','/disable\x20-\x20disable\x20notifications\x0a','temporary\x20access\x20timeout','Unauthorized\x20attempt\x20to\x20download\x20','\x1b[0m','download','[ip-address]','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','env','write',':\x20Bot\x20Mgr\x20>\x20','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','settings','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','running','backupfile','log','bbvReceive','auto','config/','test','Starting\x20(','Invalid\x20username\x20or\x20IP\x20address','cancelLoading','575551onTfNF','\x20|\x20client:\x20...','warning','exchange','restore_no_','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','help','editMessageReplyMarkup','mkdirSync','access',')\x20|\x20Bot\x20','pidExpireLogin','exec','allow','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','api-eu.mixpanel.com','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','https://api.ipify.org?format=json','padStart','child_process','file','Session\x20expired\x20for\x20user\x20...','argv','blacklist','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','toString','data','get-portfolio','clients','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Notifications\x20disabled','127.0.0.1','Your\x20installation\x20is\x20already\x20up\x20to\x20date','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','handshake','replace','reinstall','date-fns','private','socket','config_orders','temporary\x20access\x20rejected','Markdown','23990229fDjuSW','2FA\x20login\x20rejected','sendFile','cancel-loading','Alerts','get-backup-files','telegramEnabled','bbvNew','encryptedUuid','static','login2fa_reject_','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','place-order','Failed\x20to\x20download\x20','add-bot','hasOwnProperty','<b>Balance\x20Bot\x20Status:</b>\x0a','sign','success','Backup\x20file\x20uploaded','notification','config','\x20to\x20','referer','range','Enabled\x20Bot\x20','clientip','get-messages','headless','restore_yes_','stopped','getMinutes','4avkBQE','Token\x20blacklisted','lowdb','simple','Unauthorized\x20attempt\x20to\x20get\x20portfolio','_data','accept','logs/','get-logs','request','***','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','showConfig','number','Notifications\x20disabled\x0a','5\x20min','lastmsgemitted','RSA','path','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','post','decrypt','status','stop','disconnect','<b>Telegram\x20Bot\x20Status:</b>\x0a','sendPortfolioTelegram','disabled','uuid-random','value','Deleted\x20Bot\x20','http','reset-password','constructor','Error\x20removing\x20old\x20backup\x20files:','confirm-message','reinstall-bb','stringify','copyFileSync','version.json','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','getDate','generate','temporary\x20token\x20generated','fork','size','showname','remove','store','defaults','sortBy','ETH','Ok,\x20will\x20send\x20order\x20notifications\x20only','conn','update_yes','restore-backup-file','\x20minutes','\x20-\x20','Unauthorized\x20attempt\x20to\x20log\x20out','telegramEvents','rmSync','sockets','expiry','pidRefreshToken','cloneDeep','/:bot/history','axios','2FA','portfolio_','status\x20code\x20401','build','botmanager','NTBA_FIX_319','zip/','existsSync','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','************','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','0.0.0','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','inlineKeyboard','yes','secure','resetpw_yes','find','args','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','2FA\x20login\x20required','/update\x20-\x20update\x20Balance\x20Bot\x0a','off_','Logged\x20in\x20user\x20...','apiPassword','host','Password\x20reset\x20rejected','Error\x20while\x20deleting\x20config\x20files:\x20','match','Bot\x20Mgr\x20>\x20','catch','assign','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','toggle-bot-mode','messages','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','entries','new','/:bot/performance','writeFileSync','user','Network\x20Interfaces:','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','login\x20token\x20valid','message','/:bot/support','text','telegramIpApproval','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','Invalid\x20authentication\x20token\x20(1)','temporaryAccessAllowed','environment','isDirectory','Temporary\x20access\x20rejected','(((.+)+)+)+$','toIPv4Address','/output-000.log','All\x20bots','statSync','2517705iomMys','26324wzcrgM','Starting\x20new\x20bot\x20|\x20Bot\x20','sendMetricsTelegram','command','enable',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Login\x20rejected','/metrics\x20-\x20show\x20bot\x20performance\x0a','CoinMarketCap\x20API\x20key\x20validated','disable','backup-full','removeAllListeners','|@|','sendMessage','reinstall_no','userid','::ffff:127.0.0.1','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','botID','-results.json','kill','Setting\x20access:\x20','bot','uuid','Node.js\x20v','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','::1','getFullYear','apply','111FMSlfB','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','hashSync','/on\x20-\x20start\x20bot(s)\x0a','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','reinstall_yes','portfolio','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','close','remoteAddress','manual','User\x20has\x20been\x20validated','getPortfolio',',\x20must\x20be\x20a\x204\x20digit\x20number','bots','resetHistory','error','\x20(2)','startsWith','toggle','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','telegramToken','connection','\x20(1)','settings.','Disabled\x20Bot\x20','mtime','util','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','/:bot','event','generateKeyPairAsync','tempaccess_5_','login\x20not\x20required','getMonth','logs','Unauthorized\x20attempt\x20to\x20delete\x20bot','function','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','emit','toggleBotMode','bot-','randomFillSync','port','Ok,\x20will\x20send\x20alert\x20notifications\x20only','/start','/enable\x20-\x20enable\x20notifications\x0a','Yes','Unauthorized\x20login\x20attempt\x20(timeout)','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','debug','Unauthorized\x20attempt\x20to\x20get\x20messages','from','metrics','temp/','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','telegramUsername','onepagemode','login\x20token\x20generated','logout','files','/names\x20-\x20show\x20bot\x20names\x0a','output-000.log','telegraf','1000','search','lastmsgtelegram','Allow\x20login\x20from\x20IP\x20address\x20','Restore\x20process\x20aborted','bb-settings.json','/upload-backup','action','inherit','Telegram\x20error:','once','init','/off\x20-\x20stop\x20bot(s)\x0a','DEFLATE','new-disabled','restart_','format','whitelist','Notifications\x20enabled\x0a','parse','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','full','publicKey','whitelistEnabled','bb/','push','code','address','title','loginRequired','start','apiKey','.zip','map','telegram','address\x20already\x20in\x20use','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','exp','keys','add','toIPv4MappedAddress','off','Server','crypto','min','Access\x20enabled\x20for\x20','getTime','bbPassword','send','unlinkSync','invalid\x20credentials','login\x20required','-----------------------------------------------------------------------------------','username','index.html','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','No\x20bots\x20running\x20right\x20now','storeConfiguration','get-starting-balances','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','alerts','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','resetpw_no','socket.io','telegramChatId','reset-history','callback','isIPv4MappedAddress','metrics_','secret','\x20>\x20','emitHistory','Error\x20details:','express','bot.js','started','versions','getStartingBalances','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','all','sha256','Unauthorized\x20attempt\x20to\x20add\x20bot','slice','sort','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Notifications\x20enabled','internal','\x20|\x20','6911824DZYeND','Bot\x20','Logged\x20out\x20user\x20...','createWriteStream','storeHeadless','chat','forEach','Restore\x20backup\x20file\x20','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','backup-full@','headers','/help\x20-\x20show\x20available\x20commands\x0a','ipv6','-config.json','3000','mode','f2aRequired','backup','You\x20can\x20use\x20the\x20following\x20commands:\x0a','live','ipc','reload','6860315MpNWwg','/status\x20-\x20show\x20bot(s)\x20status\x0a','join','-performance.json','logged\x20out','latestversion','botname','tempaccess_reject_','listen','token','exit','Backup\x20file\x20unzipped\x20and\x20stored','type','includes','Unauthorized\x20attempt\x20to\x20show\x20configuration','launch','SIGINT','storeFiat','family','update_no','/restart\x20-\x20restart\x20bot(s)\x0a','store-headless','updatebotmanager','orders','reply','readdirSync','marketcapApi','2FA\x20required','config_alerts','RSA-OAEP','getHours','Starting\x20#RED#Balance\x20Bot\x20v','bcryptjs','Password\x20has\x20been\x20reset\x20to:\x20','restart','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Unauthorized\x20attempt\x20to\x20confirm\x20message','show','filter','Invalid\x20IP\x20address','enabled','\x20only\x0a','hex','BCT','No\x20authentication\x20token','6741792RyBYuU','reason','order','randomBytes','(staging)','Idling\x20(','\x20mode','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','build2','update','6b67f3d61ee94b8f5c80b4affef4c4d9','password','access\x20timeout','max','Orders','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','config_all','use','node-zip','timestamp','Unauthorized\x20attempt\x20to\x20update\x20settings','login','telegrammsg','#RES#\x20if\x20running\x20locally\x0a','kind','SIGTERM','node','Restoring\x20bot(s)\x20from\x20backup','output-001.log','update-bot','toggle_','binary','show-config','length','set','button','on_','#RES#\x20','output-002.log','connected','HTML'];_0x5f5c=function(){return _0x25b586;};return _0x5f5c();}function toggleStatus(_0x249096){const _0x4b098e=_0x3e55d8;let _0x570976=dbConfig[_0x4b098e(0x333)](_0x4b098e(0x232))[_0x4b098e(0x1db)]({'botID':_0x249096})[_0x4b098e(0x3c3)](),_0x1967e9;if(_0x570976[_0x4b098e(0x3bc)]===_0x4b098e(0x2fa))_0x1967e9=_0x4b098e(0x3c1);else{if(_0x570976[_0x4b098e(0x3bc)]===_0x4b098e(0x1ef))_0x1967e9=_0x4b098e(0x272);else{if(_0x570976[_0x4b098e(0x3bc)]===_0x4b098e(0x272))_0x1967e9=_0x4b098e(0x1ef);else{if(_0x570976[_0x4b098e(0x3bc)]==='disabled')_0x1967e9='enabled';}}}return _0x1967e9;}function updateStatus(_0x331993,_0x4b64f0){const _0x515b86=_0x3e55d8;dbConfig['get']('bots')[_0x515b86(0x1db)]({'botID':_0x331993})[_0x515b86(0x1e9)]({'status':_0x4b64f0})[_0x515b86(0x34c)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x515b86(0x232),config),broadcastToBots(_0x515b86(0x232),JSON['stringify'](config));}function updateLive(_0x567be0,_0x282f42){const _0x5408da=_0x3e55d8;dbConfig[_0x5408da(0x333)](_0x5408da(0x232))[_0x5408da(0x1db)]({'botID':_0x567be0})[_0x5408da(0x1e9)]({'live':_0x282f42})[_0x5408da(0x34c)](),config=getConfiguration(),io['to'](_0x5408da(0x1ce))['emit'](_0x5408da(0x232),config),broadcastToBots(_0x5408da(0x232),JSON[_0x5408da(0x3cb)](config));}function updateBotName(_0x309c2e,_0x14bbb1){const _0x178a87=_0x3e55d8;dbConfig['get']('bots')[_0x178a87(0x1db)]({'botID':_0x309c2e})['assign']({'botname':_0x14bbb1})[_0x178a87(0x34c)](),config=getConfiguration(),io['to']('botmanager')[_0x178a87(0x24b)]('bots',config),broadcastToBots(_0x178a87(0x232),JSON[_0x178a87(0x3cb)](config));}function updateBotManager(){const _0x9bcc6c=_0x3e55d8;config=getConfiguration(),io['to'](_0x9bcc6c(0x1ce))['emit']('bots',config),broadcastToBots(_0x9bcc6c(0x232),JSON[_0x9bcc6c(0x3cb)](config));}function toggleBotMode(_0x267402){const _0x476dfc=_0x3e55d8;if(pid[_0x267402])pid[_0x267402][_0x476dfc(0x294)]({'function':_0x476dfc(0x24c),'args':null});else{const _0x2af0a8=configpath+_0x476dfc(0x24d)+_0x267402+_0x476dfc(0x2c9),_0x33b6e9=fs['readFileSync'](_0x2af0a8),_0x4674dc=JSON[_0x476dfc(0x277)](_0x33b6e9),_0x3756da=_0x4674dc['bot'][0x0][_0x476dfc(0x3a2)];_0x4674dc[_0x476dfc(0x21d)][0x0][_0x476dfc(0x3a2)]=!_0x3756da;const _0x44f478=JSON['stringify'](_0x4674dc,null,0x2);fs[_0x476dfc(0x1f1)](_0x2af0a8,_0x44f478),config=getConfiguration(),io['to'](_0x476dfc(0x1ce))[_0x476dfc(0x24b)](_0x476dfc(0x232),config),broadcastToBots(_0x476dfc(0x232),JSON['stringify'](config));}}function validateTelegram(_0x411cac){const _0x306afa=_0x3e55d8;if(_0x411cac[_0x306afa(0x258)][_0x306afa(0x299)]!=settings[_0x306afa(0x25c)]&&'@'+_0x411cac['from'][_0x306afa(0x299)]!=settings[_0x306afa(0x25c)]||_0x411cac[_0x306afa(0x2c1)]['id']!=settings[_0x306afa(0x2a4)])return sendTelegram(_0x411cac[_0x306afa(0x2c1)]['id'],_0x306afa(0x228),{'parse_mode':_0x306afa(0x327)}),![];return!![];}async function initTelegram(){const _0x5adb6a=_0x3e55d8;if(tgBot)tgBot[_0x5adb6a(0x3bd)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x5adb6a(0x239)]);let _0x5eed08=_0x5adb6a(0x2ce);_0x5eed08+='\x0a',_0x5eed08+=_0x5adb6a(0x252),_0x5eed08+=_0x5adb6a(0x344),_0x5eed08+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x5eed08+=_0x5adb6a(0x2e6),_0x5eed08+=_0x5adb6a(0x227),_0x5eed08+=_0x5adb6a(0x270),_0x5eed08+=_0x5adb6a(0x2c4),_0x5eed08+=_0x5adb6a(0x261),_0x5eed08+=_0x5adb6a(0x2d3),_0x5eed08+=_0x5adb6a(0x20d),_0x5eed08+=_0x5adb6a(0x34a),_0x5eed08+=_0x5adb6a(0x1df),_0x5eed08+=_0x5adb6a(0x3ce),_0x5eed08+=_0x5adb6a(0x2c7);let _0x581ea2=_0x5adb6a(0x2a1);_0x581ea2+='\x0a',_0x581ea2+=_0x5eed08,tgBot[_0x5adb6a(0x1e8)]((_0x47d3d7,_0x3a5fbf)=>{const _0x200119=_0x5adb6a;logger['simple'](getTimeStamp()+_0x200119(0x218)),logger[_0x200119(0x256)](_0x200119(0x32f),_0x47d3d7);}),tgBot[_0x5adb6a(0x310)](async(_0x352dfa,_0x54d5ff)=>{const _0x24288e=_0x5adb6a;if(!(!settings[_0x24288e(0x2a4)]&&_0x352dfa['update'][_0x24288e(0x1f6)][_0x24288e(0x1f8)]==_0x24288e(0x251))){if(!validateTelegram(_0x352dfa))return;}_0x54d5ff();}),tgBot[_0x5adb6a(0x209)](_0x5adb6a(0x282),async _0x24e520=>{const _0x1467b9=_0x5adb6a;if(!settings[_0x1467b9(0x2a4)])updateSetting(_0x1467b9(0x2a4),_0x24e520[_0x1467b9(0x2c1)]['id']);updateSetting(_0x1467b9(0x38c),!![]);if(!validateTelegram(_0x24e520))return;await sendTelegram(_0x24e520[_0x1467b9(0x2c1)]['id'],_0x581ea2);}),tgBot['command'](_0x5adb6a(0x20a),async _0x5de209=>{const _0x581e5b=_0x5adb6a;updateSetting(_0x581e5b(0x38c),!![]),await sendTelegram(_0x5de209[_0x581e5b(0x2c1)]['id'],_0x581e5b(0x2b9));}),tgBot[_0x5adb6a(0x209)](_0x5adb6a(0x20f),async _0x3ca65c=>{const _0x11a878=_0x5adb6a;await sendTelegram(_0x3ca65c[_0x11a878(0x2c1)]['id'],_0x11a878(0x379)),updateSetting(_0x11a878(0x38c),![]);}),tgBot[_0x5adb6a(0x209)](_0x5adb6a(0x39b),async _0x1503b5=>{const _0x26145f=_0x5adb6a,_0x14c263=Markup[_0x26145f(0x1d7)]([Markup[_0x26145f(0x322)][_0x26145f(0x2a6)](_0x26145f(0x30d),_0x26145f(0x383)),Markup['button'][_0x26145f(0x2a6)](_0x26145f(0x38a),_0x26145f(0x2ee)),Markup[_0x26145f(0x322)][_0x26145f(0x2a6)]('All',_0x26145f(0x30f))]);_0x1503b5[_0x26145f(0x2ea)](_0x26145f(0x2b8),_0x14c263);}),tgBot[_0x5adb6a(0x26b)](_0x5adb6a(0x383),async _0x293dd3=>{const _0x35ae5a=_0x5adb6a;_0x293dd3[_0x35ae5a(0x362)](),updateSetting(_0x35ae5a(0x1c2),'orders'),updateSetting(_0x35ae5a(0x38c),!![]),await sendTelegram(_0x293dd3[_0x35ae5a(0x2c1)]['id'],_0x35ae5a(0x3da));}),tgBot[_0x5adb6a(0x26b)](_0x5adb6a(0x2ee),async _0x23e982=>{const _0x3e62f0=_0x5adb6a;_0x23e982[_0x3e62f0(0x362)](),updateSetting('telegramEvents',_0x3e62f0(0x2a0)),updateSetting(_0x3e62f0(0x38c),!![]),await sendTelegram(_0x23e982['chat']['id'],_0x3e62f0(0x250));}),tgBot[_0x5adb6a(0x26b)](_0x5adb6a(0x30f),async _0x1c490e=>{const _0x3d7ad4=_0x5adb6a;_0x1c490e[_0x3d7ad4(0x362)](),updateSetting(_0x3d7ad4(0x1c2),'all'),updateSetting(_0x3d7ad4(0x38c),!![]),await sendTelegram(_0x1c490e[_0x3d7ad4(0x2c1)]['id'],_0x3d7ad4(0x373));}),tgBot['command']('status',async _0x3fc786=>{const _0x3f1c99=_0x5adb6a,_0x353fbd=getBotsWithMode();let _0x156662=_0x3f1c99(0x396);config[_0x3f1c99(0x2c2)](_0x283b90=>{const _0x194db2=_0x3f1c99,_0x4d19d4=_0x353fbd[_0x194db2(0x1db)](_0x434b7d=>_0x434b7d[_0x194db2(0x219)]==_0x283b90['botID'])[_0x194db2(0x2cb)];_0x156662+='Bot\x20'+_0x283b90[_0x194db2(0x219)]+':\x20'+_0x283b90[_0x194db2(0x3bc)]+_0x194db2(0x2bb)+_0x4d19d4+_0x194db2(0x2bb)+_0x283b90[_0x194db2(0x2cf)]+'\x0a';}),_0x156662+='\x0a',_0x156662+=_0x3f1c99(0x3bf),_0x156662+=!settings['telegramEnabled']?_0x3f1c99(0x3b4):_0x3f1c99(0x276),_0x156662+=settings[_0x3f1c99(0x38c)]?settings[_0x3f1c99(0x1c2)]=='all'?_0x3f1c99(0x2f5):'Notifications\x20types:\x20'+settings[_0x3f1c99(0x1c2)]+_0x3f1c99(0x2fb):'',await sendTelegram(_0x3fc786['chat']['id'],_0x156662,{'parse_mode':'HTML'});}),tgBot[_0x5adb6a(0x209)](_0x5adb6a(0x2f4),async _0x220cff=>{const _0x59a733=_0x5adb6a,_0xf82917=getEnabledBots();if(_0xf82917['length']==0x0)await sendTelegram(_0x220cff[_0x59a733(0x2c1)]['id'],_0x59a733(0x29c));else{if(_0xf82917[_0x59a733(0x320)]>0x1)_0xf82917[_0x59a733(0x27d)]({'botID':'all'});let _0x4d2d27=[],_0x336d51=[];const _0x57dc15=_0xf82917['length']%0x4==0x0||_0xf82917['length']%0x4==0x3||_0xf82917['length']%0x3==0x1?0x4:0x3;let _0x2a4baa=0x0;_0xf82917['forEach']((_0x33ee58,_0x24326d)=>{const _0x1db78b=_0x59a733;if(_0x24326d%_0x57dc15==0x0)_0x336d51=[];_0x336d51['push'](Markup[_0x1db78b(0x322)][_0x1db78b(0x2a6)](_0x33ee58['botID']=='all'?_0x1db78b(0x203):_0x1db78b(0x2bd)+_0x33ee58[_0x1db78b(0x219)],_0x1db78b(0x273)+_0x33ee58[_0x1db78b(0x219)])),_0x24326d%_0x57dc15==0x0&&(_0x4d2d27[_0x2a4baa]=_0x336d51,_0x2a4baa++);});const _0x1b5f22=Markup[_0x59a733(0x1d7)](_0x4d2d27);_0x220cff['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x1b5f22);}}),tgBot[_0x5adb6a(0x26b)](/restart_(.+)/,async _0x4f3e4a=>{const _0x1f618f=_0x5adb6a,_0x190e42=_0x4f3e4a[_0x1f618f(0x1e6)][0x1];_0x4f3e4a[_0x1f618f(0x362)](),_0x190e42=='all'?config[_0x1f618f(0x2c2)](_0x53195e=>{restartBot(_0x53195e['botID']);}):restartBot(_0x190e42);}),tgBot['command']('on',async _0x48f3a0=>{const _0x29fbd8=_0x5adb6a,_0x15eaed=getDisabledBots();if(_0x15eaed['length']==0x0)await sendTelegram(_0x48f3a0[_0x29fbd8(0x2c1)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x15eaed[_0x29fbd8(0x320)]>0x1)_0x15eaed[_0x29fbd8(0x27d)]({'botID':_0x29fbd8(0x2b3)});let _0x24fce1=[],_0x5a4c06=[];const _0x4a08c7=_0x15eaed[_0x29fbd8(0x320)]%0x4==0x0||_0x15eaed[_0x29fbd8(0x320)]%0x4==0x3||_0x15eaed[_0x29fbd8(0x320)]%0x3==0x1?0x4:0x3;let _0x49965f=0x0;_0x15eaed[_0x29fbd8(0x2c2)]((_0xe5c43,_0x1dee18)=>{const _0x32ff5e=_0x29fbd8;if(_0x1dee18%_0x4a08c7==0x0)_0x5a4c06=[];_0x5a4c06[_0x32ff5e(0x27d)](Markup[_0x32ff5e(0x322)][_0x32ff5e(0x2a6)](_0xe5c43[_0x32ff5e(0x219)]==_0x32ff5e(0x2b3)?'All\x20bots':'Bot\x20'+_0xe5c43[_0x32ff5e(0x219)],_0x32ff5e(0x323)+_0xe5c43[_0x32ff5e(0x219)])),_0x1dee18%_0x4a08c7==0x0&&(_0x24fce1[_0x49965f]=_0x5a4c06,_0x49965f++);});const _0x4cde4f=Markup[_0x29fbd8(0x1d7)](_0x24fce1);_0x48f3a0[_0x29fbd8(0x2ea)](_0x29fbd8(0x1f4),_0x4cde4f);}}),tgBot[_0x5adb6a(0x26b)](/on_(.+)/,async _0x317c4e=>{const _0x40c049=_0x5adb6a,_0xb40b08=_0x317c4e[_0x40c049(0x1e6)][0x1];_0x317c4e['editMessageReplyMarkup']();if(_0xb40b08==_0x40c049(0x2b3)){const _0x15b74a=getDisabledBots();await sendTelegram(_0x317c4e['chat']['id'],_0x40c049(0x1d4)),_0x15b74a[_0x40c049(0x2c2)](_0x1f9e42=>{const _0x14cb54=_0x40c049;if(_0x1f9e42[_0x14cb54(0x219)]!=_0x14cb54(0x2b3))toggleBot(_0x1f9e42['botID'],toggleStatus(_0x1f9e42['botID']),_0x14cb54(0x3a4));});}else await sendTelegram(_0x317c4e['chat']['id'],_0x40c049(0x378)+_0xb40b08),toggleBot(_0xb40b08,toggleStatus(_0xb40b08),_0x40c049(0x3a4));}),tgBot[_0x5adb6a(0x209)](_0x5adb6a(0x28d),async _0x2ab3cc=>{const _0x3a4649=_0x5adb6a,_0x27ef4e=getEnabledBots();if(_0x27ef4e[_0x3a4649(0x320)]==0x0)await sendTelegram(_0x2ab3cc[_0x3a4649(0x2c1)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x27ef4e[_0x3a4649(0x320)]>0x1)_0x27ef4e[_0x3a4649(0x27d)]({'botID':_0x3a4649(0x2b3)});let _0xeacdf1=[],_0x49620b=[];const _0x236357=_0x27ef4e[_0x3a4649(0x320)]%0x4==0x0||_0x27ef4e[_0x3a4649(0x320)]%0x4==0x3||_0x27ef4e[_0x3a4649(0x320)]%0x3==0x1?0x4:0x3;let _0x13cd56=0x0;_0x27ef4e[_0x3a4649(0x2c2)]((_0x554241,_0x547eab)=>{const _0x369201=_0x3a4649;if(_0x547eab%_0x236357==0x0)_0x49620b=[];_0x49620b[_0x369201(0x27d)](Markup[_0x369201(0x322)][_0x369201(0x2a6)](_0x554241[_0x369201(0x219)]==_0x369201(0x2b3)?_0x369201(0x203):'Bot\x20'+_0x554241['botID'],_0x369201(0x1e0)+_0x554241[_0x369201(0x219)])),_0x547eab%_0x236357==0x0&&(_0xeacdf1[_0x13cd56]=_0x49620b,_0x13cd56++);});const _0x5a88f4=Markup[_0x3a4649(0x1d7)](_0xeacdf1);_0x2ab3cc[_0x3a4649(0x2ea)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x5a88f4);}}),tgBot[_0x5adb6a(0x26b)](/off_(.+)/,async _0x46a48e=>{const _0x40839c=_0x5adb6a,_0x292617=_0x46a48e[_0x40839c(0x1e6)][0x1];_0x46a48e[_0x40839c(0x362)]();if(_0x292617==_0x40839c(0x2b3)){const _0x113d4d=getEnabledBots();await sendTelegram(_0x46a48e[_0x40839c(0x2c1)]['id'],_0x40839c(0x1ea)),_0x113d4d[_0x40839c(0x2c2)](_0x3ea199=>{const _0x19c7ab=_0x40839c;if(_0x3ea199['botID']!=_0x19c7ab(0x2b3))toggleBot(_0x3ea199[_0x19c7ab(0x219)],toggleStatus(_0x3ea199[_0x19c7ab(0x219)]),'stopped');});}else await sendTelegram(_0x46a48e[_0x40839c(0x2c1)]['id'],_0x40839c(0x217)+_0x292617),toggleBot(_0x292617,toggleStatus(_0x292617),_0x40839c(0x3a4));}),tgBot['command'](_0x5adb6a(0x259),async _0x1931c4=>{const _0x92c183=_0x5adb6a,_0x2c6561=getEnabledBots();if(_0x2c6561['length']==0x0)await sendTelegram(_0x1931c4[_0x92c183(0x2c1)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x2c6561['length']>0x1){let _0x355b0f=[],_0x26c1c9=[];const _0x3d57d5=_0x2c6561[_0x92c183(0x320)]%0x4==0x0||_0x2c6561[_0x92c183(0x320)]%0x4==0x3||_0x2c6561[_0x92c183(0x320)]%0x3==0x1?0x4:0x3;let _0x2a5042=0x0;_0x2c6561[_0x92c183(0x2c2)]((_0x3829c8,_0x1b9cb0)=>{const _0x2a3d00=_0x92c183;if(_0x1b9cb0%_0x3d57d5==0x0)_0x26c1c9=[];_0x26c1c9[_0x2a3d00(0x27d)](Markup[_0x2a3d00(0x322)][_0x2a3d00(0x2a6)](_0x2a3d00(0x2bd)+_0x3829c8[_0x2a3d00(0x219)],_0x2a3d00(0x2a8)+_0x3829c8[_0x2a3d00(0x219)])),_0x1b9cb0%_0x3d57d5==0x0&&(_0x355b0f[_0x2a5042]=_0x26c1c9,_0x2a5042++);});const _0x3d240b=Markup[_0x92c183(0x1d7)](_0x355b0f);_0x1931c4[_0x92c183(0x2ea)](_0x92c183(0x3b9),_0x3d240b);}else{const _0x4be8a6=_0x2c6561[0x0][_0x92c183(0x219)];if(pid[_0x4be8a6])pid[_0x4be8a6]['send']({'function':_0x92c183(0x208),'args':null});}}}),tgBot[_0x5adb6a(0x26b)](/metrics_(.+)/,async _0x2b6a84=>{const _0x3de78f=_0x5adb6a,_0x376cc7=_0x2b6a84[_0x3de78f(0x1e6)][0x1];_0x2b6a84[_0x3de78f(0x362)]();if(pid[_0x376cc7])pid[_0x376cc7][_0x3de78f(0x294)]({'function':'sendMetricsTelegram','args':null});}),tgBot['command'](_0x5adb6a(0x22a),async _0x3d784e=>{const _0x176d39=_0x5adb6a,_0x5a3aba=getEnabledBots();if(_0x5a3aba[_0x176d39(0x320)]==0x0)await sendTelegram(_0x3d784e[_0x176d39(0x2c1)]['id'],_0x176d39(0x29c));else{if(_0x5a3aba[_0x176d39(0x320)]>0x1){let _0x4b269b=[],_0x1394ec=[];const _0x40dca6=_0x5a3aba[_0x176d39(0x320)]%0x4==0x0||_0x5a3aba['length']%0x4==0x3||_0x5a3aba['length']%0x3==0x1?0x4:0x3;let _0x496b8a=0x0;_0x5a3aba[_0x176d39(0x2c2)]((_0x322207,_0x596401)=>{const _0x322d65=_0x176d39;if(_0x596401%_0x40dca6==0x0)_0x1394ec=[];_0x1394ec[_0x322d65(0x27d)](Markup[_0x322d65(0x322)][_0x322d65(0x2a6)](_0x322d65(0x2bd)+_0x322207[_0x322d65(0x219)],_0x322d65(0x1cb)+_0x322207[_0x322d65(0x219)])),_0x596401%_0x40dca6==0x0&&(_0x4b269b[_0x496b8a]=_0x1394ec,_0x496b8a++);});const _0x3506ac=Markup[_0x176d39(0x1d7)](_0x4b269b);_0x3d784e[_0x176d39(0x2ea)](_0x176d39(0x29b),_0x3506ac);}else{const _0x2a5fe8=_0x5a3aba[0x0][_0x176d39(0x219)];if(pid[_0x2a5fe8])pid[_0x2a5fe8][_0x176d39(0x294)]({'function':_0x176d39(0x3c0),'args':null});}}}),tgBot[_0x5adb6a(0x26b)](/portfolio_(.+)/,async _0x53197e=>{const _0x9e88ea=_0x5adb6a,_0x483b63=_0x53197e[_0x9e88ea(0x1e6)][0x1];_0x53197e[_0x9e88ea(0x362)]();if(pid[_0x483b63])pid[_0x483b63][_0x9e88ea(0x294)]({'function':_0x9e88ea(0x3c0),'args':null});}),tgBot[_0x5adb6a(0x209)](_0x5adb6a(0x308),async _0x7cd3c2=>{const _0x5d4578=_0x5adb6a;await getMessages();if(!updateAvailable)await sendTelegram(_0x7cd3c2[_0x5d4578(0x2c1)]['id'],_0x5d4578(0x37b));else{if(!validInstallation)await sendTelegram(_0x7cd3c2[_0x5d4578(0x2c1)]['id'],_0x5d4578(0x29f));else{const _0x11127d=Markup[_0x5d4578(0x1d7)]([Markup['button'][_0x5d4578(0x2a6)](_0x5d4578(0x253),_0x5d4578(0x3dc)),Markup[_0x5d4578(0x322)][_0x5d4578(0x2a6)]('No',_0x5d4578(0x2e5))]);_0x7cd3c2[_0x5d4578(0x2ea)](_0x5d4578(0x24a),_0x11127d);}}}),tgBot['action'](/update_(.+)/,async _0x490661=>{const _0x16f602=_0x5adb6a,_0x1887f5=_0x490661['match'][0x1];_0x490661[_0x16f602(0x362)](),_0x1887f5==_0x16f602(0x1d8)&&(await sendTelegram(_0x490661['chat']['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB('update')),_0x1887f5=='no'&&await sendTelegram(_0x490661['chat']['id'],_0x16f602(0x288));}),tgBot['command'](_0x5adb6a(0x37f),async _0x3fdb93=>{const _0x3b6536=_0x5adb6a;if(!validInstallation)await sendTelegram(_0x3fdb93['chat']['id'],_0x3b6536(0x25b));else{const _0x16203d=Markup[_0x3b6536(0x1d7)]([Markup[_0x3b6536(0x322)][_0x3b6536(0x2a6)](_0x3b6536(0x253),_0x3b6536(0x229)),Markup[_0x3b6536(0x322)]['callback']('No',_0x3b6536(0x214))]);_0x3fdb93[_0x3b6536(0x2ea)](_0x3b6536(0x391),_0x16203d);}}),tgBot[_0x5adb6a(0x26b)](/reinstall_(.+)/,async _0x2775ce=>{const _0x49450b=_0x5adb6a,_0x1d2568=_0x2775ce['match'][0x1];_0x2775ce[_0x49450b(0x362)](),_0x1d2568==_0x49450b(0x1d8)&&(await sendTelegram(_0x2775ce[_0x49450b(0x2c1)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x49450b(0x37f))),_0x1d2568=='no'&&await sendTelegram(_0x2775ce[_0x49450b(0x2c1)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x5adb6a(0x209)](_0x5adb6a(0x237),async _0x2a0f49=>{const _0xb85462=_0x5adb6a,_0x3f1e71=getBotsWithMode();if(_0x3f1e71[_0xb85462(0x320)]==0x0)await sendTelegram(_0x2a0f49[_0xb85462(0x2c1)]['id'],_0xb85462(0x29c));else{let _0x32bde4=[],_0x5c2dab=[];const _0x3a9d4a=0x2;let _0x299298=0x0;_0x3f1e71[_0xb85462(0x2c2)]((_0x27c226,_0x63f4e1)=>{const _0x1a95fd=_0xb85462;if(_0x63f4e1%_0x3a9d4a==0x0)_0x5c2dab=[];_0x5c2dab[_0x1a95fd(0x27d)](Markup[_0x1a95fd(0x322)][_0x1a95fd(0x2a6)](_0x1a95fd(0x2bd)+_0x27c226['botID']+'\x20('+_0x27c226[_0x1a95fd(0x2cb)]+')',_0x1a95fd(0x31d)+_0x27c226[_0x1a95fd(0x219)])),_0x63f4e1%_0x3a9d4a==0x0&&(_0x32bde4[_0x299298]=_0x5c2dab,_0x299298++);});const _0x4f0ee2=Markup[_0xb85462(0x1d7)](_0x32bde4);_0x2a0f49[_0xb85462(0x2ea)](_0xb85462(0x240),_0x4f0ee2);}}),tgBot[_0x5adb6a(0x26b)](/toggle_(.+)/,async _0x4adab6=>{const _0x198628=_0x5adb6a,_0x4b292c=_0x4adab6['match'][0x1];_0x4adab6[_0x198628(0x362)]();const _0x985c15=getBotsWithMode(),_0x488f16=_0x985c15[_0x198628(0x1db)](_0x34fa74=>_0x34fa74['botID']==_0x4b292c),_0x56dae7=_0x488f16[_0x198628(0x2cb)]==_0x198628(0x355)?_0x198628(0x22e):_0x198628(0x355);await sendTelegram(_0x4adab6[_0x198628(0x2c1)]['id'],_0x198628(0x1d2)+_0x4b292c+_0x198628(0x39c)+_0x56dae7+_0x198628(0x305)),toggleBotMode(_0x4b292c);}),tgBot[_0x5adb6a(0x209)]('names',async _0x1dce9f=>{const _0x5d0928=_0x5adb6a;let _0x543b7f='';config['forEach'](_0x30473d=>{const _0x51a1da=_0xddb9;_0x543b7f+=_0x51a1da(0x2bd)+_0x30473d[_0x51a1da(0x219)]+':\x20'+_0x30473d[_0x51a1da(0x2d8)]+'\x0a';}),await sendTelegram(_0x1dce9f[_0x5d0928(0x2c1)]['id'],_0x543b7f,{'parse_mode':_0x5d0928(0x327)});}),tgBot[_0x5adb6a(0x209)](_0x5adb6a(0x361),async _0x3be702=>{const _0x56ec8d=_0x5adb6a;await sendTelegram(_0x3be702[_0x56ec8d(0x2c1)]['id'],_0x5eed08);}),process[_0x5adb6a(0x26e)]('SIGINT',()=>tgBot[_0x5adb6a(0x3bd)](_0x5adb6a(0x2e2))),process[_0x5adb6a(0x26e)](_0x5adb6a(0x318),()=>tgBot[_0x5adb6a(0x3bd)]('SIGTERM')),tgBot[_0x5adb6a(0x2e1)]();}}function disableTelegram(){const _0x3aa6c4=_0x3e55d8;tgBot&&tgBot[_0x3aa6c4(0x3bd)]();}async function sendTelegram(_0x3671b6,_0x37bb74,_0xdfac32){const _0xa0bbf3=_0x3e55d8;_0xdfac32={..._0xdfac32,'disable_web_page_preview':!![]};try{await tgBot[_0xa0bbf3(0x286)][_0xa0bbf3(0x213)](_0x3671b6,_0x37bb74,_0xdfac32);}catch(_0x59829b){console[_0xa0bbf3(0x353)](_0xa0bbf3(0x26d),_0x59829b);}}async function sendTelegramBot(_0x3db09b,_0x3194b8){const _0x471b5e=_0x3e55d8;if(settings['telegramEnabled']){if(settings['telegramEvents']==_0x471b5e(0x2b3)||(_0x3194b8['type']==_0x471b5e(0x234)||_0x3194b8['type']==_0x471b5e(0x35d)||_0x3194b8[_0x471b5e(0x2de)]==_0x471b5e(0x398))&&settings[_0x471b5e(0x1c2)]==_0x471b5e(0x2a0)||_0x3194b8['type']==_0x471b5e(0x301)&&settings[_0x471b5e(0x1c2)]==_0x471b5e(0x2e9)){if(tgBot&&settings[_0x471b5e(0x2a4)]){if(_0x3194b8[_0x471b5e(0x3d4)])await sendTelegram(settings['telegramChatId'],_0x3194b8['botname']+_0x471b5e(0x2aa)+_0x3194b8[_0x471b5e(0x242)]);else await sendTelegram(settings['telegramChatId'],'Bot\x20'+_0x3db09b+_0x471b5e(0x2aa)+_0x3194b8[_0x471b5e(0x242)]);}}}}async function sendTelegramMsg(_0x4b80e1,_0x22d49a=_0x3e55d8(0x327)){const _0x1b1be9=_0x3e55d8;return settings[_0x1b1be9(0x38c)]&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x1b1be9(0x2a4)],_0x4b80e1,{'parse_mode':_0x22d49a}),!![]):![];}function getDeviceWithIp(_0x13dcd8){const _0x17ac6b=_0x3e55d8;return devices[_0x17ac6b(0x1db)](_0x280613=>_0x280613['ip']===_0x13dcd8);}async function temporaryAccess2FA(_0x2314aa,_0x4f0283){const _0x2ad178=_0x3e55d8;let _0x53bdec=new Date(),_0x2db3f5=![];if(lastIpApproval){if(_0x53bdec-lastIpApproval<0x1388)_0x2db3f5=!![];}lastIpApproval=new Date();if(_0x2db3f5)return;if(tgBot&&settings[_0x2ad178(0x2a4)]){const _0x35f1e9=uuidRandom();tmpStorage[_0x35f1e9]={'uuid':_0x2314aa,'externalip':_0x4f0283};const _0x5787a0=Markup[_0x2ad178(0x1d7)]([Markup[_0x2ad178(0x322)][_0x2ad178(0x2a6)](_0x2ad178(0x3b5),_0x2ad178(0x244)+_0x35f1e9),Markup[_0x2ad178(0x322)]['callback']('15\x20min','tempaccess_15_'+_0x35f1e9),Markup[_0x2ad178(0x322)]['callback']('30\x20min',_0x2ad178(0x33b)+_0x35f1e9),Markup['button'][_0x2ad178(0x2a6)](_0x2ad178(0x328),_0x2ad178(0x2d9)+_0x35f1e9)]);await sendTelegram(settings[_0x2ad178(0x2a4)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x4f0283)['show']+'\x20?',_0x5787a0),tgBot[_0x2ad178(0x26b)](/tempaccess_(.+)_(.+)/,async _0x5285a8=>{const _0x3fad95=_0x2ad178,_0x2b2348=_0x5285a8[_0x3fad95(0x1e6)][0x1],_0x13e651=_0x5285a8['match'][0x2],{uuid:_0xaa9001,externalip:_0x3dcc41}=tmpStorage[_0x13e651];delete tmpStorage[_0x13e651],_0x5285a8[_0x3fad95(0x362)](),devices[_0xaa9001][_0x3fad95(0x1f9)]={'clientip':_0x3dcc41,'timestamp':new Date()[_0x3fad95(0x292)](),'expiry':_0x2b2348},_0x2b2348!=_0x3fad95(0x328)?(await sendTelegram(_0x5285a8['chat']['id'],_0x3fad95(0x291)+_0x2b2348+_0x3fad95(0x1bf),{'parse_mode':_0x3fad95(0x327)}),io['to'](_0xaa9001)[_0x3fad95(0x24b)](_0x3fad95(0x3bc),{'access':{'allow':![],'reason':_0x3fad95(0x2d1),'token':null}})):(await sendTelegram(_0x5285a8[_0x3fad95(0x2c1)]['id'],_0x3fad95(0x1ff)),io['to'](_0xaa9001)[_0x3fad95(0x24b)](_0x3fad95(0x3bc),{'access':{'allow':![],'reason':_0x3fad95(0x384),'token':null}}));});}}async function loginAccess2FA(_0x32d888,_0x15f8e2){const _0xd90c0a=_0x3e55d8;if(tgBot&&settings[_0xd90c0a(0x2a4)]){const _0x87e26c=uuidRandom();tmpStorage[_0x87e26c]={'uuid':_0x32d888,'externalip':_0x15f8e2};const _0x48d4f6=Markup[_0xd90c0a(0x1d7)]([Markup[_0xd90c0a(0x322)][_0xd90c0a(0x2a6)](_0xd90c0a(0x3ac),_0xd90c0a(0x32d)+loginExpiry+'_'+_0x87e26c),Markup['button'][_0xd90c0a(0x2a6)](_0xd90c0a(0x328),_0xd90c0a(0x390)+_0x87e26c)]);await sendTelegram(settings[_0xd90c0a(0x2a4)],_0xd90c0a(0x267)+normalizeIP(_0x15f8e2)[_0xd90c0a(0x2f7)]+'\x20?',_0x48d4f6),tgBot[_0xd90c0a(0x26b)](/login2fa_(.+)_(.+)/,async _0x527eb7=>{const _0x322dc8=_0xd90c0a,_0x16d837=_0x527eb7[_0x322dc8(0x1e6)][0x1],_0x3849b5=_0x527eb7[_0x322dc8(0x1e6)][0x2],{uuid:_0x58d97e,externalip:_0x4e3fc7}=tmpStorage[_0x3849b5];delete tmpStorage[_0x3849b5],_0x527eb7[_0x322dc8(0x362)](),devices[_0x58d97e][_0x322dc8(0x342)]={'clientip':_0x4e3fc7,'timestamp':new Date()[_0x322dc8(0x292)](),'expiry':_0x16d837},_0x16d837!='reject'?(await sendTelegram(_0x527eb7[_0x322dc8(0x2c1)]['id'],'Login\x20accepted',{'parse_mode':'HTML'}),io['to'](_0x58d97e)[_0x322dc8(0x24b)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x527eb7[_0x322dc8(0x2c1)]['id'],_0x322dc8(0x20c)),io['to'](_0x58d97e)[_0x322dc8(0x24b)]('status',{'access':{'allow':![],'reason':_0x322dc8(0x387),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function _0xddb9(_0x42af0d,_0x192e94){const _0x197323=_0x5f5c();return _0xddb9=function(_0x1b68d6,_0x66efaa){_0x1b68d6=_0x1b68d6-0x1bf;let _0x5f5cc2=_0x197323[_0x1b68d6];return _0x5f5cc2;},_0xddb9(_0x42af0d,_0x192e94);}function getEnabledBots(){const _0x2b4fa3=_0x3e55d8;return dbConfig[_0x2b4fa3(0x333)]('bots')[_0x2b4fa3(0x3d8)](_0x2b4fa3(0x219))[_0x2b4fa3(0x2f8)]({'status':'enabled'})[_0x2b4fa3(0x3c3)]()||[];}function getDisabledBots(){const _0x3dc2b0=_0x3e55d8;return dbConfig[_0x3dc2b0(0x333)](_0x3dc2b0(0x232))[_0x3dc2b0(0x3d8)](_0x3dc2b0(0x219))[_0x3dc2b0(0x2f8)]({'status':'disabled'})[_0x3dc2b0(0x3c3)]()||[];}function getBotAttributes(_0x40b1a6){const _0x3f271c=_0x3e55d8;let _0x3071a3={};const _0x114e40=configpath+_0x3f271c(0x24d)+_0x40b1a6+'-config.json',_0x2a73b9=fs[_0x3f271c(0x1d1)](_0x114e40);if(_0x2a73b9){const _0x1d2773=fs[_0x3f271c(0x33a)](_0x114e40);try{const _0x26ddce=JSON['parse'](_0x1d2773),_0x128aa5=_0x26ddce?_0x26ddce[_0x3f271c(0x21d)][0x0][_0x3f271c(0x3a2)]:![];_0x3071a3[_0x3f271c(0x2cb)]=_0x128aa5?'auto':'manual',_0x3071a3[_0x3f271c(0x2d8)]=_0x26ddce?_0x26ddce[_0x3f271c(0x21d)][0x0]['botname']:_0x3f271c(0x2bd)+_0x40b1a6;}catch(_0x1da136){_0x3071a3['mode']=_0x3f271c(0x22e),_0x3071a3[_0x3f271c(0x2d8)]=_0x3f271c(0x2bd)+_0x40b1a6;}}else _0x3071a3[_0x3f271c(0x2cb)]=_0x3f271c(0x22e),_0x3071a3[_0x3f271c(0x2d8)]=_0x3f271c(0x2bd)+_0x40b1a6;return _0x3071a3;}function getBotsWithMode(){const _0x9c3e98=_0x3e55d8,_0x265a32=dbConfig['get']('bots')[_0x9c3e98(0x3d8)](_0x9c3e98(0x219))[_0x9c3e98(0x3c3)]()||[];return _0x265a32['forEach'](_0x45812f=>{const _0x399f1d=_0x9c3e98;let _0x1f5c90=getBotAttributes(_0x45812f[_0x399f1d(0x219)]);_0x45812f[_0x399f1d(0x2cb)]=_0x1f5c90[_0x399f1d(0x2cb)];}),_0x265a32;}function getBotExchanges(){const _0x19360f=_0x3e55d8;let _0x3b8431=[];const _0x5d6595=dbConfig[_0x19360f(0x333)](_0x19360f(0x232))[_0x19360f(0x3d8)](_0x19360f(0x219))[_0x19360f(0x3c3)]()||[];_0x5d6595[_0x19360f(0x2c2)](_0x268998=>{const _0xc7e4bf=_0x19360f;if(_0x268998[_0xc7e4bf(0x3bc)]==_0xc7e4bf(0x2fa)){const _0x207d66=configpath+_0xc7e4bf(0x24d)+_0x268998[_0xc7e4bf(0x219)]+_0xc7e4bf(0x2c9),_0x1d4849=fs[_0xc7e4bf(0x1d1)](_0x207d66);let _0x4ee046;if(_0x1d4849){const _0x4f9ea8=fs[_0xc7e4bf(0x33a)](_0x207d66);try{const _0x7b1ce4=JSON[_0xc7e4bf(0x277)](_0x4f9ea8);_0x4ee046=_0x7b1ce4?_0x7b1ce4[_0xc7e4bf(0x21d)][0x0][_0xc7e4bf(0x35e)]:null;}catch(_0x16c856){}}if(_0x4ee046)_0x3b8431[_0xc7e4bf(0x27d)](_0x4ee046);}});const _0x5c6243=[...new Set(_0x3b8431)]['sort']();return _0x5c6243;}async function initUser(){if(!settings['userid']){const _0xc83d5c=uuidRandom();mixpanel['alias'](_0xc83d5c),updateSetting('userid',_0xc83d5c);}}async function initSecure(){const _0xc6c600=_0x3e55d8;let _0x5c0db9=getSecure();if(!_0x5c0db9[_0xc6c600(0x395)](_0xc6c600(0x2a9))){let _0x527e70=await generateKeys();_0x5c0db9[_0xc6c600(0x27a)]=_0x527e70[_0xc6c600(0x27a)],_0x5c0db9[_0xc6c600(0x343)]=_0x527e70[_0xc6c600(0x343)],_0x5c0db9['secret']=crypto[_0xc6c600(0x302)](0x20)[_0xc6c600(0x374)](_0xc6c600(0x2fc));;storeSecure(_0x5c0db9);}}function getSettings(){const _0x4a5caf=_0x3e55d8;return dbSettings[_0x4a5caf(0x333)]('settings')['value']()||{};}function getSecure(){const _0x7f40fc=_0x3e55d8;return dbSecure[_0x7f40fc(0x333)](_0x7f40fc(0x1d9))[_0x7f40fc(0x3c3)]()||{};}function getBlacklist(){const _0x4868d5=_0x3e55d8;return dbSecure[_0x4868d5(0x333)](_0x4868d5(0x372))[_0x4868d5(0x3c3)]()||[];}function broadcastToBots(_0x40ad22,_0x4e4fbc){const _0x4a05d4=_0x3e55d8;config[_0x4a05d4(0x2c2)](_0x30db19=>{const _0x25c258=_0x4a05d4;if(_0x30db19[_0x25c258(0x3bc)]==_0x25c258(0x2fa)&&_0x30db19['live']=='running'||_0x30db19[_0x25c258(0x3bc)]==_0x25c258(0x1ef)&&_0x30db19['live']==_0x25c258(0x351)){if(pid[_0x30db19[_0x25c258(0x219)]])pid[_0x30db19[_0x25c258(0x219)]]['send']({[_0x40ad22]:_0x4e4fbc});}});}async function storeSettings(_0x3c46b1,_0x41a551=![]){const _0x42bc42=_0x3e55d8;_0x3c46b1={...settings,..._0x3c46b1};if(_0x41a551&&_0x3c46b1[_0x42bc42(0x293)]!=_0x42bc42(0x1d3)&&_0x3c46b1[_0x42bc42(0x293)]!='***'&&_0x3c46b1[_0x42bc42(0x293)]!=''){const _0x2854c0=crypt[_0x42bc42(0x3bb)](secure[_0x42bc42(0x343)],_0x3c46b1[_0x42bc42(0x293)])[_0x42bc42(0x1f6)][_0x42bc42(0x332)](_0x42bc42(0x212))[0x0],_0x5580d8=bcrypt[_0x42bc42(0x226)](_0x2854c0,saltRounds);_0x3c46b1={..._0x3c46b1,'bbPassword':_0x5580d8};}if(_0x41a551&&_0x3c46b1['telegramToken']!=_0x42bc42(0x1d3)&&_0x3c46b1[_0x42bc42(0x239)]!='***'&&_0x3c46b1[_0x42bc42(0x239)]!=''){const _0x5bdd8b=crypt['decrypt'](secure[_0x42bc42(0x343)],_0x3c46b1[_0x42bc42(0x239)])[_0x42bc42(0x1f6)][_0x42bc42(0x332)](_0x42bc42(0x212))[0x0];_0x3c46b1={..._0x3c46b1,'telegramToken':_0x5bdd8b};}if(_0x41a551&&_0x3c46b1['marketcapApi']!='************'&&_0x3c46b1[_0x42bc42(0x2ec)]!='***'&&_0x3c46b1[_0x42bc42(0x2ec)]!=''){const _0x1d20d2=crypt[_0x42bc42(0x3bb)](secure['privateKey'],_0x3c46b1[_0x42bc42(0x2ec)])[_0x42bc42(0x1f6)][_0x42bc42(0x332)]('|@|')[0x0];_0x3c46b1={..._0x3c46b1,'marketcapApi':_0x1d20d2};}const _0x44cca3=_0x3c46b1[_0x42bc42(0x239)]!=_0x42bc42(0x1d3)&&_0x3c46b1[_0x42bc42(0x239)]!=settings['telegramToken']||_0x3c46b1[_0x42bc42(0x25c)]!=settings['telegramUsername'],_0x1c8f7a=_0x3c46b1[_0x42bc42(0x239)]==''||_0x3c46b1[_0x42bc42(0x25c)]=='',_0xa4f28a=_0x3c46b1['marketcapApi']&&_0x3c46b1[_0x42bc42(0x2ec)]!=_0x42bc42(0x1d3)&&_0x3c46b1[_0x42bc42(0x2ec)]!=settings['telegramToken'];_0x44cca3&&(_0x3c46b1[_0x42bc42(0x2a4)]=null,_0x3c46b1[_0x42bc42(0x1c2)]='all');for(const [_0x12d648,_0x346400]of Object[_0x42bc42(0x1ee)](_0x3c46b1)){if(_0x12d648=='telegramToken'&&_0x346400==_0x42bc42(0x1d3)){_0x3c46b1['telegramToken']=settings[_0x42bc42(0x239)];continue;};if(_0x12d648==_0x42bc42(0x293)&&_0x346400=='************'){_0x3c46b1[_0x42bc42(0x293)]=settings['bbPassword'];continue;};if(_0x12d648==_0x42bc42(0x2ec)&&_0x346400==_0x42bc42(0x1d3)){_0x3c46b1[_0x42bc42(0x2ec)]=settings[_0x42bc42(0x2ec)];continue;};dbSettings[_0x42bc42(0x321)](_0x42bc42(0x23c)+_0x12d648,_0x346400)['write']();}settings=_0x3c46b1,io['to'](_0x42bc42(0x1ce))[_0x42bc42(0x24b)](_0x42bc42(0x34f),cleanSettings()),broadcastToBots('timeshift',settings[_0x42bc42(0x32c)]),broadcastToBots(_0x42bc42(0x25d),settings[_0x42bc42(0x25d)]),broadcastToBots(_0x42bc42(0x2ec),settings[_0x42bc42(0x2ec)]);if(_0x44cca3&&!_0x1c8f7a)initTelegram();if(_0x44cca3&&_0x1c8f7a)disableTelegram();getAllClients()[_0x42bc42(0x2c2)](_0x5a5737=>{const _0xb135db=_0x42bc42;getSocket(_0x5a5737['id'])[_0xb135db(0x24b)](_0xb135db(0x3bc),{'access':{'allow':![],'reason':'reload','token':null}});}),_0xa4f28a&&(await sleep(0xbb8),testMarketcapApi(_0x3c46b1[_0x42bc42(0x2ec)]));}async function testMarketcapApi(_0x38730f){const _0x4de6f4=_0x3e55d8,_0x4a7e8f=[_0x4de6f4(0x2fd),_0x4de6f4(0x3d9)];try{await axios['get'](_0x4de6f4(0x3b1),{'headers':{'X-CMC_PRO_API_KEY':_0x38730f},'params':{'symbol':_0x4a7e8f[_0x4de6f4(0x374)]()}});}catch(_0x1fef96){_0x1fef96[_0x4de6f4(0x374)]()[_0x4de6f4(0x2df)](_0x4de6f4(0x1cc))?(io['to']('botmanager')[_0x4de6f4(0x24b)](_0x4de6f4(0x39a),_0x4de6f4(0x339)),logger[_0x4de6f4(0x279)](_0x4de6f4(0x339))):(io['to']('botmanager')[_0x4de6f4(0x24b)]('notification',_0x4de6f4(0x220)),logger['full']('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x4de6f4(0x256)](_0x4de6f4(0x2ac),_0x1fef96['toString']()+_0x4de6f4(0x1c0)+_0x1fef96[_0x4de6f4(0x27e)]));return;}logger['debug'](_0x4de6f4(0x20e));}function updateSetting(_0x30e2f6,_0x1266e2){const _0x56109f=_0x3e55d8;dbSettings['set'](_0x56109f(0x23c)+_0x30e2f6,_0x1266e2)[_0x56109f(0x34c)](),settings=getSettings(),io['to'](_0x56109f(0x1ce))['emit'](_0x56109f(0x34f),cleanSettings());}function storeSecure(_0x524ca7){const _0x37cf74=_0x3e55d8;dbSecure[_0x37cf74(0x333)](_0x37cf74(0x1d9))[_0x37cf74(0x27d)](_0x524ca7)[_0x37cf74(0x34c)](),secure=_0x524ca7;}function addBlacklist(_0x506793){const _0x3e0d67=_0x3e55d8;cleanBlacklist();let _0x14edc3;devices[_0x506793]['telegramIpApproval']?_0x14edc3=Math[_0x3e0d67(0x30c)](devices[_0x506793][_0x3e0d67(0x1f9)][_0x3e0d67(0x1c5)],loginExpiry):_0x14edc3=loginExpiry,dbSecure[_0x3e0d67(0x333)](_0x3e0d67(0x372))['push']({'expiry':new Date()[_0x3e0d67(0x292)]()+_0x14edc3*0x3c*0x3e8,'token':devices[_0x506793]['access']['token']})['write'](),blacklist=dbSecure['get'](_0x3e0d67(0x372))['value']();}function cleanBlacklist(){const _0x4a9f13=_0x3e55d8;let _0x47b19f=dbSecure['get'](_0x4a9f13(0x372))[_0x4a9f13(0x1c7)]()[_0x4a9f13(0x3c3)](),_0x3e3f6b=new Date()[_0x4a9f13(0x292)]();_0x47b19f[_0x4a9f13(0x2c2)](_0x4e4e50=>{const _0x1b0ed3=_0x4a9f13;_0x4e4e50[_0x1b0ed3(0x1c5)]<_0x3e3f6b&&dbSecure[_0x1b0ed3(0x333)]('blacklist')['remove']({'expiry':_0x4e4e50[_0x1b0ed3(0x1c5)]})[_0x1b0ed3(0x34c)]();});}function initStates(){const _0x464b50=_0x3e55d8;let _0x2c464f=getConfiguration();_0x2c464f[_0x464b50(0x2c2)](_0x14d3f5=>{const _0x5a1231=_0x464b50;_0x14d3f5[_0x5a1231(0x2cf)]=_0x5a1231(0x3a4);}),storeConfiguration(_0x2c464f);}function onKeys(){const _0xa9fb53=new RSA();return new Promise(_0x109713=>{const _0x5d846e=_0xddb9;_0xa9fb53[_0x5d846e(0x243)]()['then'](_0x98ce52=>{_0x109713(_0x98ce52);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x26554b=_0x3e55d8;let _0x2aba00=getSettings(),_0x4ca53=![];!_0x2aba00[_0x26554b(0x395)](_0x26554b(0x266))&&(_0x2aba00[_0x26554b(0x266)]=0x0,_0x4ca53=!![]);!_0x2aba00[_0x26554b(0x395)](_0x26554b(0x3b6))&&(_0x2aba00[_0x26554b(0x3b6)]=0x0,_0x4ca53=!![]);!_0x2aba00['hasOwnProperty'](_0x26554b(0x2d7))&&(_0x2aba00[_0x26554b(0x2d7)]=_0x26554b(0x1d5),_0x4ca53=!![]);!_0x2aba00[_0x26554b(0x395)]('onepagemode')&&(_0x2aba00[_0x26554b(0x25d)]=![],_0x4ca53=!![]);!_0x2aba00[_0x26554b(0x395)]('marketcapApi')&&(_0x2aba00[_0x26554b(0x2ec)]='',_0x4ca53=!![]);if(_0x4ca53)storeSettings(_0x2aba00);try{fs[_0x26554b(0x2eb)](configbackuppath,{'withFileTypes':!![]})[_0x26554b(0x2c2)](_0x758f9a=>{const _0x4ffe34=_0x26554b;if(!_0x758f9a['isDirectory']()){if(!_0x758f9a['name'][_0x4ffe34(0x236)](_0x4ffe34(0x2c5)))fs['unlinkSync'](configbackuppath+_0x758f9a[_0x4ffe34(0x32b)]);}else fs['rmSync'](configbackuppath+_0x758f9a[_0x4ffe34(0x32b)],{'recursive':!![]});});}catch(_0x3e40c9){logger[_0x26554b(0x256)](_0x26554b(0x3c8),_0x3e40c9);}}function storeConfiguration(_0x2124b6){const _0x4febb2=_0x3e55d8;dbConfig[_0x4febb2(0x333)](_0x4febb2(0x232))[_0x4febb2(0x3d5)]()['write'](),dbConfig['get'](_0x4febb2(0x232))[_0x4febb2(0x27d)](..._0x2124b6)[_0x4febb2(0x34c)](),config=_0x2124b6;}async function resetPassword(){const _0x1c358e=_0x3e55d8;if(tgBot&&settings[_0x1c358e(0x2a4)]){const _0x5bc1dc=Markup['inlineKeyboard']([Markup[_0x1c358e(0x322)][_0x1c358e(0x2a6)]('yes',_0x1c358e(0x1da)),Markup[_0x1c358e(0x322)][_0x1c358e(0x2a6)]('no',_0x1c358e(0x2a2))]);await sendTelegram(settings[_0x1c358e(0x2a4)],_0x1c358e(0x33f),_0x5bc1dc),tgBot[_0x1c358e(0x26b)](/resetpw_(.+)/,async _0x18e479=>{const _0x231049=_0x1c358e,_0x44aad9=_0x18e479[_0x231049(0x1e6)][0x1];_0x18e479[_0x231049(0x362)]();if(_0x44aad9!='no'){const _0x27f6da=0xf,_0x3bd9ac=_0x231049(0x1dd),_0x45d64b=Array[_0x231049(0x258)](crypto[_0x231049(0x24e)](new Uint32Array(_0x27f6da)))[_0x231049(0x285)](_0x50f51c=>_0x3bd9ac[_0x50f51c%_0x3bd9ac['length']])[_0x231049(0x2d4)](''),_0x3f1c24=bcrypt[_0x231049(0x226)](_0x45d64b,saltRounds);storeSettings({'bbPassword':_0x3f1c24}),await sendTelegram(_0x18e479[_0x231049(0x2c1)]['id'],_0x231049(0x2f3)+_0x45d64b,{'parse_mode':_0x231049(0x327)});}else await sendTelegram(_0x18e479[_0x231049(0x2c1)]['id'],_0x231049(0x1e4));});}}async function confirmRestore(_0x486b57,_0x3a101a){const _0x38dcef=_0x3e55d8;io['to'](_0x38dcef(0x1ce))[_0x38dcef(0x24b)]('notification','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x38dcef(0x398));if(tgBot&&settings['telegramChatId']){const _0x3ce44e=uuidRandom();tmpStorage[_0x3ce44e]={'path':_0x486b57,'filename':_0x3a101a};const _0x45ffcb=Markup['inlineKeyboard']([Markup[_0x38dcef(0x322)][_0x38dcef(0x2a6)](_0x38dcef(0x1d8),_0x38dcef(0x3a3)+_0x3ce44e),Markup[_0x38dcef(0x322)][_0x38dcef(0x2a6)]('no',_0x38dcef(0x35f)+_0x3ce44e)]);await sendTelegram(settings[_0x38dcef(0x2a4)],_0x38dcef(0x30e),_0x45ffcb),tgBot[_0x38dcef(0x26b)](/restore_(.+)_(.+)/,async _0x35e2c1=>{const _0x568f4b=_0x38dcef,_0x414165=_0x35e2c1[_0x568f4b(0x1e6)][0x1],_0x43c758=_0x35e2c1['match'][0x2],{path:_0x49ae54,filename:_0x459915}=tmpStorage[_0x43c758];delete tmpStorage[_0x43c758],_0x35e2c1[_0x568f4b(0x362)](),_0x414165==_0x568f4b(0x1d8)?(logger[_0x568f4b(0x256)]('Restore\x20process\x20confirmed'),await sendTelegram(_0x35e2c1[_0x568f4b(0x2c1)]['id'],_0x568f4b(0x31a),{'parse_mode':'HTML'}),unzipFile(_0x49ae54,_0x459915)):(logger[_0x568f4b(0x256)](_0x568f4b(0x268)),await sendTelegram(_0x35e2c1['chat']['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0xf97a39=_0x3e55d8,_0x2e6e01=new Date();return _0x2e6e01[_0xf97a39(0x222)]()+'/'+(_0x2e6e01[_0xf97a39(0x246)]()+0x1)[_0xf97a39(0x374)]()[_0xf97a39(0x36d)](0x2,'0')+'/'+_0x2e6e01['getDate']()['toString']()[_0xf97a39(0x36d)](0x2,'0')+'\x20'+_0x2e6e01[_0xf97a39(0x2f0)]()[_0xf97a39(0x374)]()[_0xf97a39(0x36d)](0x2,'0')+':'+_0x2e6e01[_0xf97a39(0x3a5)]()[_0xf97a39(0x374)]()[_0xf97a39(0x36d)](0x2,'0')+':'+_0x2e6e01['getSeconds']()[_0xf97a39(0x374)]()[_0xf97a39(0x36d)](0x2,'0');}function getTimeStamp(){const _0x41f219=_0x3e55d8,_0x11d72a=shiftedTime();return _0x11d72a[_0x41f219(0x222)]()+'/'+(_0x11d72a[_0x41f219(0x246)]()+0x1)[_0x41f219(0x374)]()[_0x41f219(0x36d)](0x2,'0')+'/'+_0x11d72a[_0x41f219(0x3cf)]()[_0x41f219(0x374)]()[_0x41f219(0x36d)](0x2,'0')+'\x20'+_0x11d72a[_0x41f219(0x2f0)]()[_0x41f219(0x374)]()[_0x41f219(0x36d)](0x2,'0')+':'+_0x11d72a[_0x41f219(0x3a5)]()[_0x41f219(0x374)]()[_0x41f219(0x36d)](0x2,'0')+':'+_0x11d72a['getSeconds']()[_0x41f219(0x374)]()[_0x41f219(0x36d)](0x2,'0');}function getCleanTimeStamp(){const _0x25beeb=_0x3e55d8,_0x1073e1=shiftedTime();return _0x1073e1['getFullYear']()+(_0x1073e1[_0x25beeb(0x246)]()+0x1)[_0x25beeb(0x374)]()[_0x25beeb(0x36d)](0x2,'0')+_0x1073e1[_0x25beeb(0x3cf)]()[_0x25beeb(0x374)]()['padStart'](0x2,'0')+'-'+_0x1073e1[_0x25beeb(0x2f0)]()[_0x25beeb(0x374)]()['padStart'](0x2,'0')+_0x1073e1[_0x25beeb(0x3a5)]()[_0x25beeb(0x374)]()[_0x25beeb(0x36d)](0x2,'0')+_0x1073e1['getSeconds']()['toString']()[_0x25beeb(0x36d)](0x2,'0');}function shiftedTime(){const _0x41df5b=_0x3e55d8,_0x5e5b96=new Date();let _0x3e6b57=_0x5e5b96;if(settings[_0x41df5b(0x32c)]&&settings[_0x41df5b(0x32c)]!==0x0)_0x3e6b57=fns[_0x41df5b(0x28b)](_0x5e5b96,{'hours':settings[_0x41df5b(0x32c)]});return _0x3e6b57;}function startScheduler(){const _0x314045=_0x3e55d8,_0x3915bf=new Date()[_0x314045(0x331)](),_0x234a18=shiftedTime()['getHours']();_0x234a18==0x4&&backupConfigFiles();_0x234a18==0x0&&rotateLogFiles();_0x3915bf%0x6==0x0&&triggerAnalytics();_0x3915bf%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x2dbabf){const _0x2e2444=_0x3e55d8;logger['debug'](_0x2e2444(0x2c3)+_0x2dbabf);const _0x173054=getBotsWithMode();_0x173054['length']>0x0?confirmRestore(configbackuppath,_0x2dbabf):unzipFile(configbackuppath,_0x2dbabf);}async function getBackupFiles(_0x1db973=null){const _0x36523b=_0x3e55d8;let _0x25e594=[],_0x4c926b=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x4c926b[_0x36523b(0x2b7)]((_0x1a29b,_0x3a103e)=>_0x1a29b[_0x36523b(0x32b)]<_0x3a103e[_0x36523b(0x32b)]?0x1:_0x3a103e['name']<_0x1a29b[_0x36523b(0x32b)]?-0x1:0x0),_0x4c926b[_0x36523b(0x2c2)](_0x2a0312=>{const _0x21b1bb=_0x36523b;if(!_0x2a0312[_0x21b1bb(0x1fe)]()&&_0x2a0312[_0x21b1bb(0x32b)][_0x21b1bb(0x236)](_0x21b1bb(0x2c5))&&_0x2a0312[_0x21b1bb(0x32b)]['endsWith']('.zip')){const _0x3c02cb=formatDate(fs[_0x21b1bb(0x204)](configbackuppath+_0x2a0312[_0x21b1bb(0x32b)])[_0x21b1bb(0x23e)]);_0x25e594['push']({'name':_0x2a0312[_0x21b1bb(0x32b)],'mtime':_0x3c02cb});}});if(_0x1db973)io['to'](_0x1db973)[_0x36523b(0x24b)]('backup-files',_0x25e594);else return _0x25e594;}async function backupConfigFiles(){const _0x2b606c=_0x3e55d8;await zipFiles('backup-full');const _0x4029c8=getCleanTimeStamp();fs[_0x2b606c(0x3cc)](zippath+'backup-full.zip',configbackuppath+('backup-full@'+_0x4029c8+_0x2b606c(0x284)));let _0x456f3e=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x456f3e[_0x2b606c(0x2b7)]((_0x58d1cf,_0x59e0ce)=>_0x58d1cf['name']<_0x59e0ce[_0x2b606c(0x32b)]?0x1:_0x59e0ce[_0x2b606c(0x32b)]<_0x58d1cf['name']?-0x1:0x0),_0x456f3e['length']>maxBackups&&fs[_0x2b606c(0x295)](configbackuppath+_0x456f3e[_0x456f3e[_0x2b606c(0x320)]-0x1][_0x2b606c(0x32b)]);}function rotateLogFiles(){const _0x520b47=_0x3e55d8,_0x5cf4ba=fs['statSync'](logspath+_0x520b47(0x262)),_0xd05469=_0x5cf4ba[_0x520b47(0x3d3)]/0x400;if(_0xd05469>0x64){let _0x4b2bb3=fs[_0x520b47(0x2eb)](logspath,{'withFileTypes':!![]});_0x4b2bb3[_0x520b47(0x2b7)]((_0x58460d,_0x24255c)=>_0x58460d[_0x520b47(0x32b)]<_0x24255c[_0x520b47(0x32b)]?0x1:_0x24255c[_0x520b47(0x32b)]<_0x58460d['name']?-0x1:0x0),_0x4b2bb3[_0x520b47(0x2c2)](_0xdefb80=>{const _0x59e121=_0x520b47;if(_0xdefb80[_0x59e121(0x32b)]=='output-002.log')fs[_0x59e121(0x3cc)](logspath+_0xdefb80[_0x59e121(0x32b)],logspath+'output-003.log');if(_0xdefb80['name']==_0x59e121(0x31b))fs['copyFileSync'](logspath+_0xdefb80['name'],logspath+_0x59e121(0x325));_0xdefb80[_0x59e121(0x32b)]==_0x59e121(0x262)&&(fs['copyFileSync'](logspath+_0xdefb80[_0x59e121(0x32b)],logspath+'output-001.log'),fs[_0x59e121(0x1f1)](logspath+_0xdefb80['name'],''));});}}async function zipFiles(_0x4fbd6b){const _0x4ccd9c=_0x3e55d8;let _0x1de7f0;if(_0x4fbd6b==_0x4ccd9c(0x247))_0x1de7f0=logspath;if(_0x4fbd6b==_0x4ccd9c(0x2cd))_0x1de7f0=configpath;if(_0x4fbd6b==_0x4ccd9c(0x210))_0x1de7f0=configpath;let _0x7a0370=fs[_0x4ccd9c(0x2eb)](_0x1de7f0,{'withFileTypes':!![]});const _0x135ae2=new require(_0x4ccd9c(0x311))();_0x7a0370[_0x4ccd9c(0x2c2)](_0x2e2961=>{const _0x53db12=_0x4ccd9c;if(!_0x2e2961[_0x53db12(0x1fe)]()){let _0x30203a=fs[_0x53db12(0x33a)](_0x1de7f0+_0x2e2961[_0x53db12(0x32b)]);if(_0x4fbd6b==_0x53db12(0x2cd)){const _0x5b5173=/^bot-[0-9]{3}-config.json$/,_0x290d36=_0x5b5173['test'](_0x2e2961['name']);if(_0x290d36){const _0x2150e1=JSON[_0x53db12(0x277)](_0x30203a);if(_0x2150e1[_0x53db12(0x21d)][0x0]){_0x2150e1[_0x53db12(0x21d)][0x0]['apiKey']=_0x53db12(0x3b0),_0x2150e1[_0x53db12(0x21d)][0x0][_0x53db12(0x334)]=_0x53db12(0x3b0);if(_0x2150e1[_0x53db12(0x21d)][0x0][_0x53db12(0x1e2)])_0x2150e1[_0x53db12(0x21d)][0x0]['apiPassword']=_0x53db12(0x3b0);}_0x30203a=JSON[_0x53db12(0x3cb)](_0x2150e1,null,0x2);}if(_0x2e2961[_0x53db12(0x32b)]=='bb-settings.json'){const _0x43b64b=JSON[_0x53db12(0x277)](_0x30203a);if(_0x43b64b[_0x53db12(0x34f)][_0x53db12(0x281)])_0x43b64b[_0x53db12(0x34f)][_0x53db12(0x281)]=![];if(_0x43b64b[_0x53db12(0x34f)][_0x53db12(0x293)])_0x43b64b[_0x53db12(0x34f)][_0x53db12(0x293)]='***';if(_0x43b64b['settings'][_0x53db12(0x239)])_0x43b64b['settings'][_0x53db12(0x239)]=_0x53db12(0x3b0);if(_0x43b64b[_0x53db12(0x34f)][_0x53db12(0x2a4)])_0x43b64b[_0x53db12(0x34f)][_0x53db12(0x2a4)]=null;if(_0x43b64b[_0x53db12(0x34f)][_0x53db12(0x2ec)])_0x43b64b['settings'][_0x53db12(0x2ec)]=_0x53db12(0x3b0);_0x30203a=JSON[_0x53db12(0x3cb)](_0x43b64b,null,0x2);}if(_0x2e2961[_0x53db12(0x32b)]!=_0x53db12(0x335))_0x135ae2[_0x53db12(0x36f)](_0x2e2961[_0x53db12(0x32b)],_0x30203a);}else _0x135ae2[_0x53db12(0x36f)](_0x2e2961[_0x53db12(0x32b)],_0x30203a);}});const _0x3ed601=_0x135ae2[_0x4ccd9c(0x3d0)]({'base64':![],'compression':_0x4ccd9c(0x271)});fs[_0x4ccd9c(0x1f1)](zippath+(_0x4fbd6b+'.zip'),_0x3ed601,_0x4ccd9c(0x31e));}async function unzipFile(_0x2bd37d,_0x546030){const _0x2c942e=_0x3e55d8;fs[_0x2c942e(0x2eb)](configpath,{'withFileTypes':!![]})[_0x2c942e(0x2c2)](_0x3db7ef=>{const _0x3629fd=_0x2c942e;if(!_0x3db7ef[_0x3629fd(0x1fe)]())fs[_0x3629fd(0x1c3)](configpath+_0x3db7ef[_0x3629fd(0x32b)]);});const _0x71f096=fs['readFileSync'](_0x2bd37d+_0x546030,_0x2c942e(0x31e)),_0x382eb5=new require('node-zip')(_0x71f096,{'base64':![],'checkCRC32':!![]});Object[_0x2c942e(0x28a)](_0x382eb5[_0x2c942e(0x260)])[_0x2c942e(0x2c2)](_0x219c49=>{const _0x33497c=_0x2c942e,_0x5a056e=_0x382eb5[_0x33497c(0x260)][_0x219c49];fs[_0x33497c(0x1f1)](configpath+_0x5a056e[_0x33497c(0x32b)],_0x5a056e[_0x33497c(0x3ab)]);}),fs[_0x2c942e(0x2eb)](temppath,{'withFileTypes':!![]})['forEach'](_0x102852=>{const _0xdc4cb4=_0x2c942e;if(!_0x102852[_0xdc4cb4(0x1fe)]())fs[_0xdc4cb4(0x1c3)](temppath+_0x102852[_0xdc4cb4(0x32b)]);}),logger['debug'](_0x2c942e(0x2dd)),process[_0x2c942e(0x294)]({'restore':!![]},_0x592497=>{});}async function getPublicIp(){const _0x289411=_0x3e55d8;try{const _0x554c90=await axios['get'](_0x289411(0x36c));publicip=_0x554c90[_0x289411(0x375)]['ip'];}catch(_0x4d9e53){}}async function triggerAnalytics(){const _0x1db4f7=_0x3e55d8;if(!publicip)await getPublicIp();const _0x40732b=getBotsWithMode();let _0x379a64=0x0;_0x40732b[_0x1db4f7(0x2c2)](_0x50597d=>{const _0x291f76=_0x1db4f7;if(_0x50597d[_0x291f76(0x3bc)]===_0x291f76(0x2fa))_0x379a64++;});const _0x2983ca=getBotExchanges();mixpanel['track'](_0x1db4f7(0x28e),{'distinct_id':settings[_0x1db4f7(0x215)],'ip':publicip,'version':serverversion,'numbots':_0x40732b['length'],'numbotsenabled':_0x379a64,'exchanges':_0x2983ca,'environment':environment});}async function getMessages(){const _0x3e50e8=_0x3e55d8,_0x102a2a=_0x3e50e8(0x37c),_0x14186d=new GraphQLClient(_0x102a2a),_0xbc3bbe={'authorization':_0x3e50e8(0x1d6)},_0x26075e=serverversion[_0x3e50e8(0x332)]('.'),_0x3e69f3=_0x26075e[0x0]+'.'+_0x26075e[0x1],_0x5aecb5=Math[_0x3e50e8(0x290)](settings[_0x3e50e8(0x266)],settings[_0x3e50e8(0x3b6)]),_0x153888={'last':parseInt(_0x5aecb5),'bbm':_0x3e69f3},_0x3cad79=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x5de1bf;try{_0x5de1bf=await _0x14186d[_0x3e50e8(0x3af)](_0x3cad79,_0x153888,_0xbc3bbe);}catch(_0x4df2c3){}if(_0x5de1bf&&_0x5de1bf['messages']){let _0x5625c2=settings[_0x3e50e8(0x266)];newMessages=[];for(const _0x1a2552 of _0x5de1bf[_0x3e50e8(0x1ec)]){newMessages[_0x3e50e8(0x27d)](_0x1a2552);let _0x664091=![];_0x1a2552[_0x3e50e8(0x38d)]&&(updateSetting(_0x3e50e8(0x2d7),_0x1a2552['bbvNew']),_0x664091=isNewerVersion(serverversion,_0x1a2552[_0x3e50e8(0x38d)])||serverversion==_0x1a2552[_0x3e50e8(0x38d)]);if(!_0x664091&&_0x1a2552['number']>_0x5625c2){if(_0x1a2552[_0x3e50e8(0x354)]==='any'||serverversion[_0x3e50e8(0x236)](_0x1a2552[_0x3e50e8(0x354)])){let _0x4725a7=''+_0x1a2552[_0x3e50e8(0x280)]+'\x0a\x0a'+_0x1a2552['message'];const _0x41c662=await sendTelegramMsg(toTelegramMarkdown(_0x4725a7),_0x3e50e8(0x385));if(_0x41c662)_0x5625c2=_0x1a2552[_0x3e50e8(0x3b3)];}}}updateAvailable=isNewerVersion(settings[_0x3e50e8(0x2d7)],serverversion),updateSetting(_0x3e50e8(0x266),_0x5625c2),emitMessages();}}function emitMessages(){const _0x4faa9c=_0x3e55d8,_0x1b264b=settings[_0x4faa9c(0x3b6)];let _0x19a3c0=[];newMessages['forEach'](_0x4a0521=>{const _0x555df3=_0x4faa9c;_0x4a0521[_0x555df3(0x3b3)]>_0x1b264b&&_0x19a3c0['push'](_0x4a0521);}),_0x19a3c0[_0x4faa9c(0x320)]>0x0&&getAllClients()['forEach'](_0x342484=>{getSocket(_0x342484['id'])['emit']('message',_0x19a3c0);});}function confirmMessage(_0x35a568){updateSetting('lastmsgemitted',Number(_0x35a568));}function isNewerVersion(_0x45d734,_0x1675fd){const _0x2f5520=_0x3e55d8,_0x1490d5=_0x1675fd[_0x2f5520(0x332)]('.'),_0x2ac7ce=_0x45d734[_0x2f5520(0x332)]('.');for(var _0x6cabfb=0x0;_0x6cabfb<_0x2ac7ce[_0x2f5520(0x320)];_0x6cabfb++){const _0x265e8d=~~_0x2ac7ce[_0x6cabfb],_0x2b838a=~~_0x1490d5[_0x6cabfb];if(_0x265e8d>_0x2b838a)return!![];if(_0x265e8d<_0x2b838a)return![];}return![];}function toTelegramMarkdown(_0x196704){const _0x32e9b8=_0x3e55d8,_0x58ad54=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x2b2801=/\*{2}(.+?)\*{2}/gim;return _0x196704=_0x196704[_0x32e9b8(0x37e)](_0x58ad54,'$1_$2_$3')['replace'](_0x2b2801,_0x32e9b8(0x336)),_0x196704;}async function validateConfigFile(){const _0x57a051=_0x3e55d8,_0x4e26c5=dbConfig[_0x57a051(0x333)](_0x57a051(0x232))['sortBy'](_0x57a051(0x219))[_0x57a051(0x3c3)]()||[];if(_0x4e26c5[_0x57a051(0x320)]==0x0){let _0x468b32=0x0,_0x45b1b6=[];const _0x5549cd=/^bot-([0-9]{3})-config.json$/,_0x33ebcf=fs[_0x57a051(0x2eb)](configpath);_0x33ebcf['forEach'](_0x121219=>{const _0x417593=_0x57a051,_0x2643bf=_0x5549cd[_0x417593(0x367)](_0x121219);if(_0x2643bf){const _0x1575ac=_0x2643bf[0x1];let _0x3a7cf5=getBotAttributes(_0x1575ac);_0x45b1b6[_0x417593(0x27d)]({'botID':_0x1575ac,'botname':_0x3a7cf5['botname'],'status':_0x417593(0x3c1),'live':_0x417593(0x3a4)}),_0x468b32++;}}),_0x468b32!=0x0&&(dbConfig[_0x57a051(0x333)]('bots')[_0x57a051(0x1e9)](_0x45b1b6)['write'](),config=_0x45b1b6,restoredConfigFile=_0x468b32);}}async function restoreConfigNotify(_0x2b15b6){const _0x117ea6=_0x3e55d8;let _0x37cfdc;if(restoredConfigFile==0x1)_0x37cfdc='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x37cfdc=_0x117ea6(0x225);if(_0x2b15b6)io['to'](_0x117ea6(0x1ce))[_0x117ea6(0x24b)](_0x117ea6(0x39a),_0x37cfdc);else{logger['simple'](_0x117ea6(0x298)),logger[_0x117ea6(0x3a9)](_0x37cfdc),logger['simple'](_0x117ea6(0x298)),logger[_0x117ea6(0x3a9)]('');if(tgBot&&settings[_0x117ea6(0x2a4)]&&settings[_0x117ea6(0x1c2)]!='orders')await sendTelegram(settings[_0x117ea6(0x2a4)],_0x117ea6(0x1e7)+_0x37cfdc);}}function validateCredentials(_0x4f2afa,_0x8de4c){const _0x65a6f2=_0x3e55d8;if(_0x4f2afa[_0x65a6f2(0x299)]==settings['bbUsername']&&bcrypt['compareSync'](_0x4f2afa[_0x65a6f2(0x30a)],settings[_0x65a6f2(0x293)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x65a6f2(0x1de),'token':null};else{const _0x4b8147=generateLoginToken(_0x8de4c);return{'allow':!![],'reason':_0x65a6f2(0x25e),'token':_0x4b8147};}}else return{'allow':![],'reason':_0x65a6f2(0x296),'token':null};}function refreshToken(_0xc4b1f0){const _0xe771a=_0x3e55d8,_0x18bd2b=generateLoginToken(_0xc4b1f0);return{'allow':!![],'reason':_0xe771a(0x25e),'token':_0x18bd2b};}function validateAccess(_0x31baca,_0x4ab113,_0x220f6c){const _0x5bd804=_0x3e55d8,_0x461c90=_0x220f6c?_0x220f6c:devices[_0x4ab113]['ip'];let _0x53843b;const _0x3d9c34=_0x5aa681=>{const _0x14d49d=_0xddb9;if(settings[_0x14d49d(0x281)]){if(settings[_0x14d49d(0x2cc)]){if(telegram2FaApproved(_0x4ab113)){const _0x13735f=generateLoginToken(_0x4ab113);return{'allow':!![],'reason':_0x14d49d(0x33e),'token':_0x13735f};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x53843b=validToken(_0x5aa681,_0x4ab113),_0x53843b[_0x14d49d(0x395)](_0x14d49d(0x398))?{'allow':!![],'reason':_0x14d49d(0x1f5),'token':_0x5aa681}:{'allow':![],'reason':_0x14d49d(0x297),'token':null};}else return{'allow':!![],'reason':_0x14d49d(0x245),'token':null};};if(settings[_0x5bd804(0x27b)]){let _0x554f30=[...settings[_0x5bd804(0x275)],_0x5bd804(0x221),_0x5bd804(0x216),_0x5bd804(0x37a)];if(_0x554f30[_0x5bd804(0x2df)](_0x461c90))return _0x3d9c34(_0x31baca);else{_0x53843b=validToken(_0x31baca,_0x4ab113);if(_0x53843b[_0x5bd804(0x395)](_0x5bd804(0x398)))return _0x3d9c34(_0x31baca);else{if(telegramIpApproved(_0x4ab113)){const _0x38b9d7=generateToken(_0x4ab113);return _0x53843b=_0x3d9c34(_0x31baca),_0x53843b['allow']?{'allow':!![],'reason':_0x5bd804(0x3d1),'token':_0x38b9d7}:_0x53843b;}else return settings[_0x5bd804(0x1fc)]?{'allow':![],'reason':_0x5bd804(0x2ed),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x3d9c34(_0x31baca);}function timelyDecrypt(_0x47c6d1,_0x5e3808,_0x4061d5='@'){const _0x22808f=_0x3e55d8;if(_0x47c6d1)try{const _0x323d3f=crypt[_0x22808f(0x3bb)](secure[_0x22808f(0x343)],_0x47c6d1)[_0x22808f(0x1f6)],_0x9639ad=_0x323d3f[_0x22808f(0x332)](_0x4061d5)[0x0],_0x3e2e91=_0x323d3f['split'](_0x4061d5)[0x1],_0x4855a2=new Date()[_0x22808f(0x292)]();if(_0x5e3808){if(_0x4855a2-_0x3e2e91<maxSecretAge*0x3e8)return _0x9639ad;else return![];}else return _0x9639ad;}catch(_0x4394a2){return![];}else return![];}const validToken=(_0x2dbf17,_0x40f851)=>{const _0x36141f=_0x3e55d8,_0x58fa53=devices[_0x40f851]['ip'];if(!_0x2dbf17)return{'error':_0x36141f(0x2fe)};for(let _0x49ebc0 of blacklist){if(_0x49ebc0[_0x36141f(0x2db)]==_0x2dbf17)return{'error':_0x36141f(0x3a7)};}let _0x216136;try{_0x216136=jwt['verify'](_0x2dbf17,secure[_0x36141f(0x2a9)]+_0x40f851);}catch{return{'error':_0x36141f(0x1fb)};}if(!_0x216136['hasOwnProperty']('clientip')&&!_0x216136[_0x36141f(0x395)]('username')||!_0x216136[_0x36141f(0x395)](_0x36141f(0x289)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x216136[_0x36141f(0x395)](_0x36141f(0x299))&&_0x216136[_0x36141f(0x395)]('clientip')){const {clientip:_0x343a27}=_0x216136;return _0x58fa53==_0x343a27?{'success':_0x36141f(0x22f)}:{'error':_0x36141f(0x2f9)};}else{if(_0x216136['hasOwnProperty'](_0x36141f(0x299))&&_0x216136[_0x36141f(0x395)](_0x36141f(0x3a0))){const {username:_0x321f5e,clientip:_0x1c3567}=_0x216136;return settings['bbUsername']==_0x321f5e&&_0x58fa53==_0x1c3567?{'success':_0x36141f(0x22f)}:{'error':_0x36141f(0x359)};}}},generateLoginToken=_0x45e7f9=>{const _0x3cfc7f=_0x3e55d8;if(_0x45e7f9){const _0x731097=devices[_0x45e7f9]['ip'];return jwt[_0x3cfc7f(0x397)]({'username':settings['bbUsername'],'clientip':_0x731097},secure[_0x3cfc7f(0x2a9)]+_0x45e7f9,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0xe70a89=>{const _0x32a8a9=_0x3e55d8;if(_0xe70a89){const _0x5c1b0e=devices[_0xe70a89]['ip'];return jwt[_0x32a8a9(0x397)]({'clientip':_0x5c1b0e},secure[_0x32a8a9(0x2a9)]+_0xe70a89,{'expiresIn':devices[_0xe70a89][_0x32a8a9(0x1f9)][_0x32a8a9(0x1c5)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x372bf1=>{const _0x26281d=_0x3e55d8;let _0x594844=![];return devices[_0x372bf1][_0x26281d(0x1f9)]&&devices[_0x372bf1][_0x26281d(0x1f9)][_0x26281d(0x1c5)]!=_0x26281d(0x328)&&(_0x594844=devices[_0x372bf1][_0x26281d(0x1f9)]['clientip']==devices[_0x372bf1]['ip']&&new Date()[_0x26281d(0x292)]()-devices[_0x372bf1][_0x26281d(0x1f9)]['timestamp']<devices[_0x372bf1][_0x26281d(0x1f9)]['expiry']*0x3c*0x3e8),_0x594844;},telegram2FaApproved=_0x1e1b70=>{const _0x46c107=_0x3e55d8;let _0x32450d=![];return devices[_0x1e1b70][_0x46c107(0x342)]&&devices[_0x1e1b70][_0x46c107(0x342)][_0x46c107(0x1c5)]!=_0x46c107(0x328)&&(_0x32450d=devices[_0x1e1b70][_0x46c107(0x342)]['clientip']==devices[_0x1e1b70]['ip']&&new Date()[_0x46c107(0x292)]()-devices[_0x1e1b70]['telegram2FaApproval'][_0x46c107(0x312)]<devices[_0x1e1b70][_0x46c107(0x342)][_0x46c107(0x1c5)]*0x3c*0x3e8),_0x32450d;},normalizeIP=_0x4067ae=>{const _0x27f902=_0x3e55d8;let _0x1aa7de=null,_0x2a5f46=null;if(ipaddr['isValid'](_0x4067ae)){const _0x23ec76=ipaddr[_0x27f902(0x277)](_0x4067ae);_0x23ec76[_0x27f902(0x317)]()===_0x27f902(0x2c8)?(_0x23ec76[_0x27f902(0x2a7)]()&&(_0x1aa7de=_0x23ec76[_0x27f902(0x201)]()[_0x27f902(0x374)]()),_0x2a5f46=_0x23ec76[_0x27f902(0x374)]()):(_0x1aa7de=_0x23ec76[_0x27f902(0x374)](),_0x2a5f46=_0x23ec76[_0x27f902(0x28c)]()['toString']());}return{'show':_0x1aa7de?_0x1aa7de:_0x2a5f46,'store':_0x2a5f46};};function formatDate(_0x2fcef1){const _0x155ceb=_0x3e55d8;return _0x2fcef1['getFullYear']()+'/'+(_0x2fcef1[_0x155ceb(0x246)]()+0x1)[_0x155ceb(0x374)]()['padStart'](0x2,'0')+'/'+_0x2fcef1['getDate']()['toString']()[_0x155ceb(0x36d)](0x2,'0')+'\x20'+_0x2fcef1['getHours']()[_0x155ceb(0x374)]()[_0x155ceb(0x36d)](0x2,'0')+':'+_0x2fcef1[_0x155ceb(0x3a5)]()['toString']()[_0x155ceb(0x36d)](0x2,'0')+':'+_0x2fcef1['getSeconds']()[_0x155ceb(0x374)]()[_0x155ceb(0x36d)](0x2,'0');}function sleep(_0x341e78){return new Promise(_0x21d4cb=>setTimeout(_0x21d4cb,_0x341e78));}