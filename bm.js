const _0x1fd4cd=_0x45f6;(function(_0x494ba9,_0xc366e0){const _0x1c6bd8=_0x45f6,_0x390953=_0x494ba9();while(!![]){try{const _0x42f81e=parseInt(_0x1c6bd8(0x1cf))/0x1*(-parseInt(_0x1c6bd8(0x2b3))/0x2)+-parseInt(_0x1c6bd8(0x262))/0x3*(-parseInt(_0x1c6bd8(0x1c3))/0x4)+-parseInt(_0x1c6bd8(0x29b))/0x5+parseInt(_0x1c6bd8(0x231))/0x6+parseInt(_0x1c6bd8(0x285))/0x7*(-parseInt(_0x1c6bd8(0x1f4))/0x8)+-parseInt(_0x1c6bd8(0x29d))/0x9+parseInt(_0x1c6bd8(0x22a))/0xa;if(_0x42f81e===_0xc366e0)break;else _0x390953['push'](_0x390953['shift']());}catch(_0x3f5e89){_0x390953['push'](_0x390953['shift']());}}}(_0x8abe,0x2d6d9));const _0x505012=function(){let _0x569128=!![];return function(_0x444082,_0x4e74a9){const _0xcc50d8=_0x569128?function(){const _0x680339=_0x45f6;if(_0x4e74a9){const _0x1e63a0=_0x4e74a9[_0x680339(0x2f7)](_0x444082,arguments);return _0x4e74a9=null,_0x1e63a0;}}:function(){};return _0x569128=![],_0xcc50d8;};}(),_0x16af78=_0x505012(this,function(){const _0x2270fa=_0x45f6;return _0x16af78[_0x2270fa(0x1d6)]()['search']('(((.+)+)+)+$')[_0x2270fa(0x1d6)]()['constructor'](_0x16af78)['search'](_0x2270fa(0x2b0));});_0x16af78();'use strict';process['env']['NTBA_FIX_319']=0x1;const childProcess=require(_0x1fd4cd(0x1f2)),fs=require('fs'),fns=require(_0x1fd4cd(0x315)),low=require(_0x1fd4cd(0x281)),FileSync=require(_0x1fd4cd(0x26c)),path=require('path'),crypto=require(_0x1fd4cd(0x35b)),Crypt=require(_0x1fd4cd(0x1e7))[_0x1fd4cd(0x2e4)],RSA=require(_0x1fd4cd(0x1e7))[_0x1fd4cd(0x30e)],bcrypt=require(_0x1fd4cd(0x1d2)),jwt=require(_0x1fd4cd(0x32e)),ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process['argv'][_0x1fd4cd(0x263)](0x2))[_0x1fd4cd(0x1ee)],uuidRandom=require('uuid-random'),TelegramBot=require(_0x1fd4cd(0x2ba)),Mixpanel=require(_0x1fd4cd(0x26d)),axios=require(_0x1fd4cd(0x24a)),{GraphQLClient,gql}=require(_0x1fd4cd(0x273)),util=require(_0x1fd4cd(0x287)),fileUpload=require('express-fileupload'),PORT=argv[_0x1fd4cd(0x268)]||_0x1fd4cd(0x232),pattern=/^[0-9]{2,4}$/;!pattern[_0x1fd4cd(0x270)](PORT)&&(console[_0x1fd4cd(0x32d)](_0x1fd4cd(0x293)+PORT+_0x1fd4cd(0x202)),process['exit'](0x1));const HOST=argv[_0x1fd4cd(0x2b4)]||null,userID=argv['user']||'';let bbpath='bb/',bbpath2='';const botfile=_0x1fd4cd(0x296),configfile=_0x1fd4cd(0x21b),settingsfile='bb-settings.json',securefile=_0x1fd4cd(0x24d);let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x1fd4cd(0x28b)),configpath=userID?bbpath+_0x1fd4cd(0x32b)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x1fd4cd(0x23e),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x1fd4cd(0x289),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+'zip/',loggerfile=fs['createWriteStream'](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x1fd4cd(0x24f);!fs[_0x1fd4cd(0x337)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x1fd4cd(0x337)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x1fd4cd(0x337)](logspath)&&fs[_0x1fd4cd(0x34a)](logspath);!fs['existsSync'](zippath)&&fs[_0x1fd4cd(0x34a)](zippath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x1fd4cd(0x28a)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x1fd4cd(0x2b1)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x1fd4cd(0x2b9)}})[_0x1fd4cd(0x28a)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x1fd4cd(0x28a)]();let crypt=new Crypt({'md':_0x1fd4cd(0x2fa),'rsaStandard':_0x1fd4cd(0x22c)});const saltRounds=0xa,mixpanel=Mixpanel['init']('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x1fd4cd(0x294)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x1fd4cd(0x2cc)]&&settings[_0x1fd4cd(0x2cc)]!=''&&settings[_0x1fd4cd(0x32f)]&&settings[_0x1fd4cd(0x32f)]!='')initTelegram();const logger={'screen':_0x493595=>{const _0x31cbea=_0x1fd4cd;console[_0x31cbea(0x32d)](_0x493595);},'simple':_0x144ef4=>{const _0xd0fbe7=_0x1fd4cd;console['log'](_0x144ef4),loggerfile['write'](util[_0xd0fbe7(0x31d)](_0x144ef4)+'\x0a');},'full':async _0x5744a2=>{const _0x2c9ed5=_0x1fd4cd,_0x27d36b=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x5744a2;console[_0x2c9ed5(0x32d)](_0x27d36b),loggerfile[_0x2c9ed5(0x28a)](util[_0x2c9ed5(0x31d)](_0x27d36b)+'\x0a');if(tgBot&&settings[_0x2c9ed5(0x254)]&&settings[_0x2c9ed5(0x26e)]!='orders')await tgBot[_0x2c9ed5(0x26a)](settings[_0x2c9ed5(0x254)],_0x2c9ed5(0x24b)+_0x5744a2)['catch'](_0x2b68b5=>{telegramError(_0x2b68b5);});}};process['on']('uncaughtException',function(_0x54a027){const _0x136200=_0x1fd4cd;logger[_0x136200(0x1f0)](_0x54a027);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x1fd4cd(0x22d)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x1fd4cd(0x1f8)),app=express(),http=require(_0x1fd4cd(0x240))[_0x1fd4cd(0x2a8)](app);app[_0x1fd4cd(0x25f)](fileUpload({'useTempFiles':!![]})),app['get'](_0x1fd4cd(0x24c),async(_0x450879,_0x2dbb57)=>{const _0x4eaedc=_0x1fd4cd,_0x8346b4=_0x450879[_0x4eaedc(0x2a4)]['type'],_0x15fb19=getClientsWithBotID('botmanager'),_0x85eabe=_0x450879['headers'][_0x4eaedc(0x325)],_0x713dbe=timelyDecrypt(_0x85eabe,![]),_0x2d14a4=_0x15fb19[_0x4eaedc(0x322)](_0x1c3fc5=>_0x1c3fc5[_0x4eaedc(0x325)]==_0x713dbe);if(_0x2d14a4){const _0x1d8e80=normalizeIP(_0x450879['socket']['remoteAddress'])[_0x4eaedc(0x224)],_0x33528f=_0x450879['headers'][_0x4eaedc(0x2d9)];if(validateAccess(_0x33528f,_0x713dbe,_0x1d8e80)['allow'])await zipFiles(_0x8346b4),_0x2dbb57[_0x4eaedc(0x1d7)](zippath+(_0x8346b4+_0x4eaedc(0x2a6)),_0x121e6a=>{const _0x3fbb53=_0x4eaedc;_0x121e6a&&(logger[_0x3fbb53(0x309)]('Failed\x20to\x20download\x20'+_0x8346b4),logger[_0x3fbb53(0x1f0)](_0x121e6a));});else logger[_0x4eaedc(0x309)](_0x4eaedc(0x339)+_0x8346b4+'\x20(1)');}else logger[_0x4eaedc(0x309)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x8346b4+_0x4eaedc(0x2cd));}),app['post'](_0x1fd4cd(0x1f9),async(_0x370562,_0x51ff0d)=>{const _0x106661=_0x1fd4cd,_0x427f08=getClientsWithBotID(_0x106661(0x241)),_0x27b514=_0x370562[_0x106661(0x33d)][_0x106661(0x325)],_0x4a4d1f=timelyDecrypt(_0x27b514,![]),_0x2ad423=_0x427f08[_0x106661(0x322)](_0x152de6=>_0x152de6['uuid']==_0x4a4d1f);if(_0x2ad423){const _0x4b583f=normalizeIP(_0x370562[_0x106661(0x1ef)][_0x106661(0x286)])[_0x106661(0x224)],_0x37648a=_0x370562[_0x106661(0x33d)][_0x106661(0x2d9)];if(validateAccess(_0x37648a,_0x4a4d1f,_0x4b583f)[_0x106661(0x30d)])try{if(_0x370562[_0x106661(0x2bf)]){const _0x58b563=_0x370562['files'][_0x106661(0x275)];await _0x58b563['mv'](temppath+_0x58b563['name']),console[_0x106661(0x32d)](temppath+_0x58b563[_0x106661(0x260)]),confirmRestore(temppath,_0x58b563[_0x106661(0x260)]);}}catch(_0x2becd1){console[_0x106661(0x32d)](_0x2becd1);}else logger[_0x106661(0x309)](_0x106661(0x2ff));}else logger[_0x106661(0x309)](_0x106661(0x2d5));}),app['use'](express[_0x1fd4cd(0x33c)](path[_0x1fd4cd(0x302)](__dirname,bbpath2,'build2'))),app[_0x1fd4cd(0x25f)](express['static'](path[_0x1fd4cd(0x302)](__dirname,bbpath2,_0x1fd4cd(0x220)))),app['get']('/',function(_0x57b4c3,_0x16424d){const _0x3b73df=_0x1fd4cd;_0x16424d[_0x3b73df(0x1f7)](path['join'](__dirname,bbpath2,'build2','index.html'));}),app[_0x1fd4cd(0x258)](_0x1fd4cd(0x323),function(_0x2f74e1,_0x58d3bb){const _0x448855=_0x1fd4cd;_0x58d3bb[_0x448855(0x1f7)](path[_0x448855(0x302)](__dirname,bbpath2,_0x448855(0x220),_0x448855(0x21a)));}),app[_0x1fd4cd(0x258)](_0x1fd4cd(0x242),(_0x50f4ef,_0x3c5b2d)=>{const _0x1274e9=_0x1fd4cd;_0x3c5b2d[_0x1274e9(0x1f7)](path[_0x1274e9(0x302)](__dirname,bbpath2,_0x1274e9(0x220),_0x1274e9(0x21a)));}),app['get'](_0x1fd4cd(0x342),(_0x4cf12f,_0x385e61)=>{const _0x3f5328=_0x1fd4cd;_0x385e61[_0x3f5328(0x1f7)](path[_0x3f5328(0x302)](__dirname,bbpath2,_0x3f5328(0x220),_0x3f5328(0x21a)));}),app[_0x1fd4cd(0x258)](_0x1fd4cd(0x2ee),(_0x191ab0,_0x2495e1)=>{const _0x511cfe=_0x1fd4cd;_0x2495e1[_0x511cfe(0x1f7)](path['join'](__dirname,bbpath2,_0x511cfe(0x220),'index.html'));}),app['get']('/:bot/history',(_0x3d5743,_0x1f9cc0)=>{const _0x5b7bd8=_0x1fd4cd;_0x1f9cc0[_0x5b7bd8(0x1f7)](path[_0x5b7bd8(0x302)](__dirname,bbpath2,'build','index.html'));}),app[_0x1fd4cd(0x258)](_0x1fd4cd(0x306),(_0x4fa1ea,_0x3b9b12)=>{const _0x14ca7f=_0x1fd4cd;_0x3b9b12[_0x14ca7f(0x1f7)](path['join'](__dirname,bbpath2,_0x14ca7f(0x220),'index.html'));}),app[_0x1fd4cd(0x258)](_0x1fd4cd(0x1d1),(_0x270cc9,_0x1fd418)=>{const _0x2f3677=_0x1fd4cd;_0x1fd418[_0x2f3677(0x1f7)](path[_0x2f3677(0x302)](__dirname,bbpath2,'build',_0x2f3677(0x21a)));});if(HOST)http[_0x1fd4cd(0x2c0)](PORT,HOST);else http[_0x1fd4cd(0x2c0)](PORT);const io=require(_0x1fd4cd(0x1d5))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x8988d5=_0x1fd4cd;logger['simple'](''),logger['simple'](_0x8988d5(0x30f)),await logger[_0x8988d5(0x309)](_0x8988d5(0x328)+PORT),logger[_0x8988d5(0x1f0)](_0x8988d5(0x30f));if(config[_0x8988d5(0x2e9)]!=0x0)for(const _0x1c830d of config){if(_0x1c830d[_0x8988d5(0x1f6)]==_0x8988d5(0x34e)||_0x1c830d[_0x8988d5(0x1f6)]==_0x8988d5(0x2f8))await logger[_0x8988d5(0x309)](_0x8988d5(0x1ea)+_0x1c830d['botID']+_0x8988d5(0x2db)+_0x1c830d[_0x8988d5(0x25b)]),startBot([_0x1c830d['botID'],userID],{'cwd':bbpath},function(_0x2cc4e2){const _0x51cfbe=_0x8988d5;if(_0x2cc4e2)logger[_0x51cfbe(0x309)](_0x2cc4e2);});else(_0x1c830d['status']==_0x8988d5(0x2f6)||_0x1c830d['status']==_0x8988d5(0x34d))&&await logger[_0x8988d5(0x309)](_0x8988d5(0x1e8)+_0x1c830d[_0x8988d5(0x1cb)]+_0x8988d5(0x2db)+_0x1c830d[_0x8988d5(0x25b)]);}else!newBot&&logger[_0x8988d5(0x1f0)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x8988d5(0x1f0)](_0x8988d5(0x30f)),logger[_0x8988d5(0x1f0)]('');}function startSocket(){const _0x26440d=_0x1fd4cd;io['on'](_0x26440d(0x276),_0x5acb3f=>{const _0x2fee32=_0x26440d;let _0x7a7b29,_0x1d14e5,_0x2b86fd,_0x148c26,_0x4ea66e;const _0x3e4aac=_0x5acb3f[_0x2fee32(0x2f2)][_0x2fee32(0x33d)][_0x2fee32(0x227)];_0x1d14e5=_0x3e4aac['match'](/bot[0-9]{3}/);if(_0x1d14e5)_0x2b86fd=_0x1d14e5[0x0][_0x2fee32(0x249)](/[0-9]{3}/);if(_0x2b86fd)_0x7a7b29=_0x2b86fd[0x0];else _0x7a7b29=_0x2fee32(0x241);const _0x14a1d1=_0x5acb3f[_0x2fee32(0x2f2)][_0x2fee32(0x2e0)]['encryptedUuid'];if(!_0x14a1d1)_0x5acb3f['emit'](_0x2fee32(0x1f6),{'publicKey':secure['publicKey']});else{_0x148c26=timelyDecrypt(_0x14a1d1,![]);if(!_0x148c26)_0x5acb3f[_0x2fee32(0x265)](_0x2fee32(0x1f6),{'publicKey':secure['publicKey']});else{_0x4ea66e=normalizeIP(_0x5acb3f[_0x2fee32(0x1e4)][_0x2fee32(0x286)])['store'];if(!devices[_0x148c26])devices[_0x148c26]={'uuid':_0x148c26,'access':{'token':null}};devices[_0x148c26]['ip']=_0x4ea66e;const _0x1421ef=addClient(_0x5acb3f['id'],_0x148c26,_0x7a7b29);setAccess(_0x1421ef),emitMessages(),_0x5acb3f['on']('login',_0x83aed1=>{const _0x24c91a=_0x2fee32,_0x3cecb0=timelyDecrypt(_0x83aed1['password']);if(_0x3cecb0){_0x83aed1={'username':_0x83aed1['username'],'password':_0x3cecb0},devices[_0x148c26][_0x24c91a(0x2fc)]=validateCredentials(_0x83aed1,_0x148c26);if(devices[_0x148c26][_0x24c91a(0x2fc)][_0x24c91a(0x30d)]==![]&&devices[_0x148c26][_0x24c91a(0x2fc)][_0x24c91a(0x33f)]==_0x24c91a(0x351))_0x5acb3f['emit']('status',{'access':devices[_0x148c26][_0x24c91a(0x2fc)]}),loginAccess2FA(_0x148c26,_0x4ea66e);else{if(devices[_0x148c26][_0x24c91a(0x2fc)][_0x24c91a(0x30d)]==![]&&devices[_0x148c26]['access'][_0x24c91a(0x33f)]==_0x24c91a(0x2e5))_0x5acb3f['emit'](_0x24c91a(0x1f6),{'access':devices[_0x148c26][_0x24c91a(0x2fc)]});else devices[_0x148c26][_0x24c91a(0x2fc)][_0x24c91a(0x30d)]&&devices[_0x148c26][_0x24c91a(0x2fc)][_0x24c91a(0x33f)]==_0x24c91a(0x243)&&(getClientsWithUuid(_0x148c26)[_0x24c91a(0x2ed)](_0x2e92e7=>{setAccess(_0x2e92e7);}),setTokenRefresh(_0x148c26),setSessionTimeout(_0x24c91a(0x1f1),_0x148c26));}}else logger['full'](_0x24c91a(0x21c));}),_0x5acb3f['on'](_0x2fee32(0x22f),()=>{resetPassword();}),_0x5acb3f['on'](_0x2fee32(0x219),_0xed00f4=>{removeClient(_0x5acb3f['id']);}),_0x7a7b29==_0x2fee32(0x241)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x180d98){const _0x2b77b2=_0x1fd4cd;if(_0x180d98!='botmanager'&&config['apiKey']!=''){if(pid[_0x180d98])pid[_0x180d98]['send']({'function':_0x2b77b2(0x303),'args':null});}}function reloadBotManager(){const _0x35f5ea=_0x1fd4cd;getClientsWithBotID(_0x35f5ea(0x241))[_0x35f5ea(0x2ed)](_0x2ad46a=>{const _0x44d924=_0x35f5ea;getSocket(_0x2ad46a['id'])[_0x44d924(0x265)]('status',{'access':{'allow':![],'reason':_0x44d924(0x272),'token':null}});});}function getSocket(_0x5016f9){const _0x32399c=_0x1fd4cd;return io[_0x32399c(0x2aa)][_0x32399c(0x2aa)][_0x32399c(0x258)](_0x5016f9);}function setAccess(_0x96c90e){const _0xd23a45=_0x1fd4cd,_0x5df3d1=getSocket(_0x96c90e['id']),_0x4ebb86=_0x96c90e[_0xd23a45(0x325)],_0x36a138=_0x96c90e['bot'];devices[_0x4ebb86][_0xd23a45(0x2fc)]=validateAccess(devices[_0x4ebb86][_0xd23a45(0x2fc)]['token'],_0x4ebb86),_0x5df3d1[_0xd23a45(0x302)](_0x4ebb86);if(devices[_0x4ebb86][_0xd23a45(0x2fc)][_0xd23a45(0x30d)]){_0x5df3d1['join'](_0x36a138);if(_0x36a138=='botmanager')initializeSocketBotManager(_0x5df3d1);else initializeSocketBot(_0x5df3d1);initClient(_0x36a138);}devices[_0x4ebb86][_0xd23a45(0x2fc)]['token']&&devices[_0x4ebb86][_0xd23a45(0x2fc)]['reason']==_0xd23a45(0x310)&&setSessionTimeout(_0xd23a45(0x1c9),_0x4ebb86),devices[_0x4ebb86][_0xd23a45(0x2fc)][_0xd23a45(0x23c)]&&devices[_0x4ebb86][_0xd23a45(0x2fc)][_0xd23a45(0x33f)]==_0xd23a45(0x28e)&&setSessionTimeout(_0xd23a45(0x1f1),_0x4ebb86),_0x5df3d1[_0xd23a45(0x265)]('status',{'status':_0x96c90e[_0xd23a45(0x253)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x4ebb86][_0xd23a45(0x2fc)],'externalip':devices[_0x4ebb86]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x4ebb86][_0xd23a45(0x2fc)][_0xd23a45(0x30d)]==![]&&devices[_0x4ebb86][_0xd23a45(0x2fc)][_0xd23a45(0x33f)]==_0xd23a45(0x1fa)&&temporaryAccess2FA(_0x4ebb86,devices[_0x4ebb86]['ip']);}function setSessionTimeout(_0x21fafa,_0xd08494){const _0x521b09=_0x1fd4cd;let _0x43070f;if(_0x21fafa==_0x521b09(0x1f1))_0x43070f=loginExpiry*0x3c*0x3e8;else _0x43070f=devices[_0xd08494][_0x521b09(0x2a5)][_0x521b09(0x2a0)]*0x3c*0x3e8-(new Date()[_0x521b09(0x1d8)]()-devices[_0xd08494][_0x521b09(0x2a5)][_0x521b09(0x27b)]);if(devices[_0xd08494][_0x521b09(0x324)])clearTimeout(devices[_0xd08494][_0x521b09(0x324)]);devices[_0xd08494][_0x521b09(0x324)]=setTimeout(()=>{const _0x2043ba=_0x521b09;if(devices[_0xd08494][_0x2043ba(0x21f)])clearTimeout(devices[_0xd08494]['pidRefreshToken']);removeSocketListeners(_0xd08494),addBlacklist(_0xd08494),devices[_0xd08494][_0x2043ba(0x2a5)]=null,devices[_0xd08494][_0x2043ba(0x290)]=null,devices[_0xd08494][_0x2043ba(0x2fc)][_0x2043ba(0x23c)]=null,devices[_0xd08494][_0x2043ba(0x2fc)]=validateAccess(devices[_0xd08494][_0x2043ba(0x2fc)][_0x2043ba(0x23c)],_0xd08494),!(devices[_0xd08494]['access'][_0x2043ba(0x30d)]&&devices[_0xd08494][_0x2043ba(0x2fc)][_0x2043ba(0x33f)]=='login\x20not\x20required')&&(_0x21fafa==_0x2043ba(0x1f1)?io['to'](_0xd08494)['emit'](_0x2043ba(0x1f6),{'access':{'allow':![],'reason':_0x2043ba(0x338),'token':null}}):io['to'](_0xd08494)[_0x2043ba(0x265)]('status',{'access':{'allow':![],'reason':_0x2043ba(0x2fe),'token':null}})),devices[_0xd08494]['access'][_0x2043ba(0x23c)]=null;},_0x43070f);}function setTokenRefresh(_0x63024a){const _0x3f884d=_0x1fd4cd;if(devices[_0x63024a]['pidRefreshToken'])clearTimeout(devices[_0x63024a]['pidRefreshToken']);devices[_0x63024a][_0x3f884d(0x21f)]=setTimeout(()=>{const _0x6cff=_0x3f884d;getClientsWithUuid(_0x63024a)['length']!=0x0?(devices[_0x63024a]['access']=refreshToken(_0x63024a),io['to'](_0x63024a)[_0x6cff(0x265)](_0x6cff(0x1f6),{'status':_0x6cff(0x334),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x63024a][_0x6cff(0x2fc)],'externalip':devices[_0x63024a]['ip'],'publicKey':secure[_0x6cff(0x1e3)],'validInstallation':validInstallation}),setTokenRefresh(_0x63024a)):clearTimeout(devices[_0x63024a][_0x6cff(0x21f)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3a3ddc){const _0x594505=_0x1fd4cd,_0x5ac9d3=getClient(_0x3a3ddc['id'])[_0x594505(0x325)];_0x3a3ddc[_0x594505(0x265)](_0x594505(0x267),config),_0x3a3ddc[_0x594505(0x265)]('settings',cleanSettings()),_0x3a3ddc['on'](_0x594505(0x28d),_0x26b8ec=>{const _0x5ab01d=_0x594505;if(validateAccess(_0x26b8ec,_0x5ac9d3)[_0x5ab01d(0x30d)])addBot();else logger[_0x5ab01d(0x309)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x3a3ddc['on'](_0x594505(0x28c),(_0x32245d,_0x410322)=>{const _0x2e19aa=_0x594505;if(validateAccess(_0x410322,_0x5ac9d3)[_0x2e19aa(0x30d)])toggleBot(_0x32245d[_0x2e19aa(0x1cb)],_0x32245d[_0x2e19aa(0x1f6)],_0x32245d[_0x2e19aa(0x207)]);else logger[_0x2e19aa(0x309)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x3a3ddc['on'](_0x594505(0x2fd),(_0x286663,_0x36e903)=>{const _0x3d6a40=_0x594505;if(validateAccess(_0x36e903,_0x5ac9d3)[_0x3d6a40(0x30d)])toggleBotMode(_0x286663);else logger[_0x3d6a40(0x309)](_0x3d6a40(0x1e1));}),_0x3a3ddc['on'](_0x594505(0x29a),(_0x305fe4,_0x828519)=>{const _0x4919b5=_0x594505;if(validateAccess(_0x828519,_0x5ac9d3)[_0x4919b5(0x30d)])deleteBot(_0x305fe4);else logger['full'](_0x4919b5(0x20b));}),_0x3a3ddc['on']('store-settings',(_0x6768c5,_0x548597)=>{if(validateAccess(_0x548597,_0x5ac9d3)['allow'])storeSettings(_0x6768c5,!![]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x3a3ddc['on'](_0x594505(0x1c6),_0x2a9df9=>{const _0x76bab8=_0x594505;if(validateAccess(_0x2a9df9,_0x5ac9d3)[_0x76bab8(0x30d)])updateBB();else logger[_0x76bab8(0x309)](_0x76bab8(0x20a));}),_0x3a3ddc['on']('get-messages',_0xfeed89=>{const _0x2abd82=_0x594505;if(validateAccess(_0xfeed89,_0x5ac9d3)['allow'])getMessages();else logger['full'](_0x2abd82(0x2c6));}),_0x3a3ddc['on']('confirm-message',(_0x565d7a,_0x101d3e)=>{const _0x5b9341=_0x594505;if(validateAccess(_0x101d3e,_0x5ac9d3)[_0x5b9341(0x30d)])confirmMessage(_0x565d7a);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x3a3ddc['on']('logout',_0x386d69=>{const _0xe0a7ff=_0x594505;if(validateAccess(_0x386d69,_0x5ac9d3)[_0xe0a7ff(0x30d)]){if(devices[_0x5ac9d3][_0xe0a7ff(0x21f)])clearTimeout(devices[_0x5ac9d3][_0xe0a7ff(0x21f)]);if(devices[_0x5ac9d3][_0xe0a7ff(0x324)])clearTimeout(devices[_0x5ac9d3][_0xe0a7ff(0x324)]);removeSocketListeners(getClient(_0x3a3ddc['id'])[_0xe0a7ff(0x325)]),addBlacklist(_0x5ac9d3),devices[_0x5ac9d3][_0xe0a7ff(0x2a5)]=null,devices[_0x5ac9d3][_0xe0a7ff(0x290)]=null,devices[_0x5ac9d3]['access'][_0xe0a7ff(0x23c)]=null,io['to'](getClient(_0x3a3ddc['id'])[_0xe0a7ff(0x325)])[_0xe0a7ff(0x265)](_0xe0a7ff(0x1f6),{'access':{'allow':![],'reason':_0xe0a7ff(0x2b7),'token':null}});}else logger[_0xe0a7ff(0x309)](_0xe0a7ff(0x20d));});}function initializeSocketBot(_0x282955){const _0x12a580=_0x1fd4cd,_0x16405c=getClient(_0x282955['id'])[_0x12a580(0x345)],_0x4d9057=getClient(_0x282955['id'])['uuid'];_0x282955['on']('get-logs',(_0x4a2c7f,_0x1c2481)=>{const _0x1ab6ed=_0x12a580;if(validateAccess(_0x1c2481,_0x4d9057)['allow']){if(pid[_0x16405c])pid[_0x16405c]['send']({'function':_0x1ab6ed(0x1c8),'args':_0x4a2c7f});}else logger['full'](_0x1ab6ed(0x21d));}),_0x282955['on']('delete-alerts',(_0x342f2d,_0x5e72b2)=>{const _0x53a90b=_0x12a580;if(validateAccess(_0x5e72b2,_0x4d9057)['allow']){if(pid[_0x16405c])pid[_0x16405c]['send']({'function':'deleteHistoryAlerts','args':_0x342f2d});}else logger[_0x53a90b(0x309)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x282955['on'](_0x12a580(0x250),(_0x34cc05,_0x1003c8)=>{const _0xbdc49f=_0x12a580;if(validateAccess(_0x1003c8,_0x4d9057)[_0xbdc49f(0x30d)]){if(pid[_0x16405c])pid[_0x16405c][_0xbdc49f(0x326)]({'function':_0xbdc49f(0x320),'args':_0x34cc05});}else logger['full'](_0xbdc49f(0x34f));}),_0x282955['on'](_0x12a580(0x212),(_0x4588d6,_0x2e2c14)=>{const _0x54b5b6=_0x12a580;if(validateAccess(_0x2e2c14,_0x4d9057)[_0x54b5b6(0x30d)]){if(pid[_0x16405c])pid[_0x16405c][_0x54b5b6(0x326)]({'function':_0x54b5b6(0x29c),'args':_0x4588d6});}else logger[_0x54b5b6(0x309)](_0x54b5b6(0x251));}),_0x282955['on'](_0x12a580(0x27e),(_0x5bd1b7,_0x3143da)=>{const _0x49b93e=_0x12a580;if(validateAccess(_0x3143da,_0x4d9057)[_0x49b93e(0x30d)]){if(pid[_0x16405c])pid[_0x16405c][_0x49b93e(0x326)]({'function':_0x49b93e(0x248),'args':_0x5bd1b7});}else logger[_0x49b93e(0x309)](_0x49b93e(0x2dd));}),_0x282955['on'](_0x12a580(0x211),_0xbc858d=>{const _0x5c3bcb=_0x12a580;if(validateAccess(_0xbc858d,_0x4d9057)[_0x5c3bcb(0x30d)]){if(pid[_0x16405c])pid[_0x16405c][_0x5c3bcb(0x326)]({'function':_0x5c3bcb(0x1fe),'args':null});}else logger[_0x5c3bcb(0x309)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x282955['on']('place-order',(_0xdfceca,_0x59118d)=>{const _0x39470f=_0x12a580;if(validateAccess(_0x59118d,_0x4d9057)['allow']){if(pid[_0x16405c])pid[_0x16405c][_0x39470f(0x326)]({'function':_0x39470f(0x1cc),'args':_0xdfceca});}else logger[_0x39470f(0x309)](_0x39470f(0x2df));}),_0x282955['on'](_0x12a580(0x256),_0x1d58a9=>{const _0x48a571=_0x12a580;if(validateAccess(_0x1d58a9,_0x4d9057)[_0x48a571(0x30d)]){if(pid[_0x16405c])pid[_0x16405c][_0x48a571(0x326)]({'function':_0x48a571(0x1ff),'args':null});}else logger[_0x48a571(0x309)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x282955['on'](_0x12a580(0x1c6),_0x3b3b72=>{const _0x449246=_0x12a580;if(validateAccess(_0x3b3b72,_0x4d9057)[_0x449246(0x30d)])updateBB();else logger[_0x449246(0x309)](_0x449246(0x20a));}),_0x282955['on']('get-messages',_0x27270a=>{const _0x4742c2=_0x12a580;if(validateAccess(_0x27270a,_0x4d9057)[_0x4742c2(0x30d)])getMessages();else logger[_0x4742c2(0x309)](_0x4742c2(0x2c6));}),_0x282955['on'](_0x12a580(0x1c1),(_0x523b43,_0x2f318e)=>{const _0x5812c3=_0x12a580;if(validateAccess(_0x2f318e,_0x4d9057)[_0x5812c3(0x30d)])confirmMessage(_0x523b43);else logger[_0x5812c3(0x309)](_0x5812c3(0x1c4));}),_0x282955['on']('logout',_0x14b1e7=>{const _0x2cdea7=_0x12a580;if(validateAccess(_0x14b1e7,_0x4d9057)[_0x2cdea7(0x30d)]){if(devices[_0x4d9057]['pidRefreshToken'])clearTimeout(devices[_0x4d9057]['pidRefreshToken']);if(devices[_0x4d9057][_0x2cdea7(0x324)])clearTimeout(devices[_0x4d9057][_0x2cdea7(0x324)]);removeSocketListeners(getClient(_0x282955['id'])['uuid']),addBlacklist(_0x4d9057),devices[_0x4d9057][_0x2cdea7(0x2a5)]=null,devices[_0x4d9057][_0x2cdea7(0x290)]=null,devices[_0x4d9057]['access']['token']=null,io['to'](getClient(_0x282955['id'])[_0x2cdea7(0x325)])[_0x2cdea7(0x265)](_0x2cdea7(0x1f6),{'access':{'allow':![],'reason':_0x2cdea7(0x2b7),'token':null}});}else logger[_0x2cdea7(0x309)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x4f6167){getClientsWithUuid(_0x4f6167)['forEach'](_0x2f9c93=>{getSocket(_0x2f9c93['id'])['removeAllListeners']();});}function cleanSettings(){const _0x41bd7f=_0x1fd4cd;let _0x41a8be=settings;return settings[_0x41bd7f(0x2cc)]&&settings[_0x41bd7f(0x2cc)]!=''&&(_0x41a8be={..._0x41a8be,'telegramToken':_0x41bd7f(0x23f)}),settings[_0x41bd7f(0x25e)]&&settings['bbPassword']!=''&&(_0x41a8be={..._0x41a8be,'bbPassword':_0x41bd7f(0x23f)}),(settings['bbPassword']&&settings[_0x41bd7f(0x25e)]==_0x41bd7f(0x2e6)||settings[_0x41bd7f(0x2cc)]&&settings['telegramToken']==_0x41bd7f(0x2e6))&&(_0x41a8be={..._0x41a8be,'restored':{'password':settings[_0x41bd7f(0x25e)]=='***','telegram':settings[_0x41bd7f(0x2cc)]==_0x41bd7f(0x2e6)}}),_0x41a8be;}function updateBB(){const _0x2ca5ba=_0x1fd4cd;installingUpdate=!![],config[_0x2ca5ba(0x2ed)](_0x434624=>{restartBot(_0x434624['botID']);}),process['send']({'update':!![]},_0x3b2da0=>{});}function startBot(_0x3929f5,_0x2d609b,_0x4db6f9){const _0x355434=_0x1fd4cd;let _0x393744=![];const _0x193533=_0x3929f5[0x0];_0x2d609b={..._0x2d609b,'stdio':['inherit',_0x355434(0x2ac),_0x355434(0x2ac),_0x355434(0x1c5)]},pid[_0x193533]=childProcess[_0x355434(0x1d0)](botfile,_0x3929f5,_0x2d609b),pid[_0x193533]['on'](_0x355434(0x27f),_0x469f7e=>{const _0x571754=_0x355434;switch(Object['keys'](_0x469f7e)[0x0]){case _0x571754(0x25b):updateBotName(_0x193533,_0x469f7e[_0x571754(0x25b)]);break;case _0x571754(0x216):updateBotManager();break;case _0x571754(0x1f6):updateStatus(_0x193533,_0x469f7e[_0x571754(0x1f6)]);break;case'live':updateLive(_0x193533,_0x469f7e[_0x571754(0x207)]);break;case _0x571754(0x201):updateLive(_0x193533,_0x469f7e[_0x571754(0x201)]),io['to'](_0x193533)[_0x571754(0x265)](_0x571754(0x1f6),{'access':{'allow':![],'reason':_0x571754(0x272),'token':null}});break;case _0x571754(0x26f):_0x469f7e[_0x571754(0x26f)]=='restart'&&restartBot(_0x193533);_0x469f7e[_0x571754(0x26f)]==_0x571754(0x28f)&&toggleBot(_0x193533,'disabled',_0x571754(0x2a9));break;case'telegram':sendTelegram(_0x193533,_0x469f7e['telegram']);break;case _0x571754(0x2d2):sendTelegramMsg(_0x469f7e[_0x571754(0x2d2)]);break;case _0x571754(0x237):io['to'](_0x193533)[_0x571754(0x265)](_0x469f7e['function'],_0x469f7e[_0x571754(0x1dd)]);break;}}),pid[_0x193533]['on'](_0x355434(0x266),function(_0x1c50b8){if(_0x393744)return;_0x393744=!![],_0x4db6f9(_0x1c50b8);}),pid[_0x193533]['on'](_0x355434(0x31b),async function(_0x458cb3){const _0x3eae06=_0x355434;if(installingUpdate)return;if(_0x393744)return;_0x393744=!![],_0x4db6f9(null);const _0x2314ed=dbConfig[_0x3eae06(0x258)]('bots')[_0x3eae06(0x322)]({'botID':_0x193533})[_0x3eae06(0x299)]();_0x2314ed&&(_0x2314ed[_0x3eae06(0x1f6)]==_0x3eae06(0x34e)||_0x2314ed['status']==_0x3eae06(0x2f8))&&(await sleep(0x3e8),updateLive(_0x193533,_0x3eae06(0x2a9)),logger[_0x3eae06(0x309)]('restarting\x20Bot\x20'+_0x193533),startBot([_0x193533,userID],{'cwd':bbpath},function(_0x54b635){const _0x4f60a9=_0x3eae06;if(_0x54b635)logger[_0x4f60a9(0x309)](_0x54b635);}));});}function stopBot(_0x24c46a){getClientsWithBotID(_0x24c46a)['forEach'](_0x58819c=>{getSocket(_0x58819c['id'])['disconnect'](!![]),removeClient(_0x58819c['id']);}),pid[_0x24c46a]&&(pid[_0x24c46a]['kill'](),pid[_0x24c46a]=null);}function _0x45f6(_0x5714b9,_0xab0fbf){const _0x954ade=_0x8abe();return _0x45f6=function(_0x16af78,_0x505012){_0x16af78=_0x16af78-0x1c1;let _0x8abe09=_0x954ade[_0x16af78];return _0x8abe09;},_0x45f6(_0x5714b9,_0xab0fbf);}function restartBot(_0x33f0df){const _0x103291=_0x1fd4cd;if(pid[_0x33f0df])pid[_0x33f0df][_0x103291(0x28f)]();}function addBot(){const _0x2b6440=_0x1fd4cd;let _0x1eaf62;for(let _0x3d04b8=0x1;_0x3d04b8<0x3e9;_0x3d04b8++){_0x1eaf62=_0x3d04b8[_0x2b6440(0x1d6)]()['padStart'](0x3,'0');let _0x5c4302=config[_0x2b6440(0x322)](_0x410ce5=>_0x410ce5[_0x2b6440(0x1cb)]==_0x1eaf62);if(!_0x5c4302)break;}if(_0x1eaf62===_0x2b6440(0x264)){logger[_0x2b6440(0x309)]('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger['full'](_0x2b6440(0x203)+_0x1eaf62),dbConfig[_0x2b6440(0x258)](_0x2b6440(0x267))['push']({'botID':_0x1eaf62,'botname':_0x2b6440(0x282)+_0x1eaf62,'status':_0x2b6440(0x2f8),'live':''})[_0x2b6440(0x28a)](),startBot([_0x1eaf62,userID],{'cwd':bbpath},function(_0x5aa85a){const _0x9e3af6=_0x2b6440;if(_0x5aa85a)logger[_0x9e3af6(0x309)](_0x5aa85a);}),config=getConfiguration(),io['to'](_0x2b6440(0x241))[_0x2b6440(0x265)](_0x2b6440(0x267),config);}function deleteBot(_0x12bc35){const _0x4dddc4=_0x1fd4cd;getClientsWithBotID(_0x12bc35)[_0x4dddc4(0x2ed)](_0x131f7f=>{const _0x272025=_0x4dddc4;getSocket(_0x131f7f['id'])[_0x272025(0x219)](!![]),removeClient(_0x131f7f['id']);}),dbConfig[_0x4dddc4(0x258)](_0x4dddc4(0x267))[_0x4dddc4(0x344)]({'botID':_0x12bc35})[_0x4dddc4(0x28a)](),logger[_0x4dddc4(0x309)](_0x4dddc4(0x26b)+_0x12bc35),stopBot(_0x12bc35);try{fs[_0x4dddc4(0x300)](path[_0x4dddc4(0x302)](configpath,'bot-'+_0x12bc35+_0x4dddc4(0x2d3))),fs['unlinkSync'](path[_0x4dddc4(0x302)](configpath,_0x4dddc4(0x2bb)+_0x12bc35+_0x4dddc4(0x333))),fs['unlinkSync'](path[_0x4dddc4(0x302)](configpath,_0x4dddc4(0x2bb)+_0x12bc35+_0x4dddc4(0x2b8))),fs[_0x4dddc4(0x300)](path[_0x4dddc4(0x302)](configpath,_0x4dddc4(0x2bb)+_0x12bc35+_0x4dddc4(0x348)));}catch(_0x3f6e13){if(_0x3f6e13)logger[_0x4dddc4(0x309)](_0x4dddc4(0x230),_0x3f6e13);}config=getConfiguration(),io['to'](_0x4dddc4(0x241))['emit']('bots',config);}function toggleBot(_0x22ec04,_0x3f9fb,_0x560721){const _0x497e79=_0x1fd4cd;dbConfig[_0x497e79(0x258)](_0x497e79(0x267))[_0x497e79(0x322)]({'botID':_0x22ec04})[_0x497e79(0x2ca)]({'status':_0x3f9fb})[_0x497e79(0x2ca)]({'live':_0x560721})[_0x497e79(0x28a)]();if(_0x3f9fb=='enabled'||_0x3f9fb==_0x497e79(0x2f8))logger['full'](_0x497e79(0x316)+_0x22ec04),startBot([_0x22ec04,userID],{'cwd':bbpath},function(_0x5470d2){const _0x21f5dd=_0x497e79;if(_0x5470d2)logger[_0x21f5dd(0x309)](_0x5470d2);});else(_0x3f9fb=='disabled'||_0x3f9fb==_0x497e79(0x34d))&&(logger[_0x497e79(0x309)](_0x497e79(0x278)+_0x22ec04),stopBot(_0x22ec04));config=getConfiguration(),io['to'](_0x497e79(0x241))[_0x497e79(0x265)]('bots',config);}function toggleStatus(_0x35475e){const _0x2c36f9=_0x1fd4cd;let _0x25e101=dbConfig['get'](_0x2c36f9(0x267))[_0x2c36f9(0x322)]({'botID':_0x35475e})[_0x2c36f9(0x299)](),_0x33e8e1;if(_0x25e101['status']===_0x2c36f9(0x34e))_0x33e8e1='disabled';else{if(_0x25e101[_0x2c36f9(0x1f6)]===_0x2c36f9(0x2f8))_0x33e8e1='new-disabled';else{if(_0x25e101[_0x2c36f9(0x1f6)]==='new-disabled')_0x33e8e1=_0x2c36f9(0x2f8);else{if(_0x25e101[_0x2c36f9(0x1f6)]===_0x2c36f9(0x2f6))_0x33e8e1=_0x2c36f9(0x34e);}}}return _0x33e8e1;}function updateStatus(_0x50b1c2,_0x53e089){const _0x23e8f2=_0x1fd4cd;dbConfig['get'](_0x23e8f2(0x267))[_0x23e8f2(0x322)]({'botID':_0x50b1c2})['assign']({'status':_0x53e089})[_0x23e8f2(0x28a)](),config=getConfiguration(),io['to']('botmanager')[_0x23e8f2(0x265)](_0x23e8f2(0x267),config);}function updateLive(_0x3cb62e,_0x1d1de8){const _0x39e4ea=_0x1fd4cd;dbConfig[_0x39e4ea(0x258)](_0x39e4ea(0x267))[_0x39e4ea(0x322)]({'botID':_0x3cb62e})[_0x39e4ea(0x2ca)]({'live':_0x1d1de8})[_0x39e4ea(0x28a)](),config=getConfiguration(),io['to']('botmanager')[_0x39e4ea(0x265)](_0x39e4ea(0x267),config);}function updateBotName(_0x2ed3fe,_0x446ca9){const _0x1efc6e=_0x1fd4cd;dbConfig[_0x1efc6e(0x258)](_0x1efc6e(0x267))[_0x1efc6e(0x322)]({'botID':_0x2ed3fe})[_0x1efc6e(0x2ca)]({'botname':_0x446ca9})[_0x1efc6e(0x28a)](),config=getConfiguration(),io['to'](_0x1efc6e(0x241))[_0x1efc6e(0x265)](_0x1efc6e(0x267),config);}function updateBotManager(){const _0x48752b=_0x1fd4cd;config=getConfiguration(),io['to']('botmanager')[_0x48752b(0x265)](_0x48752b(0x267),config);}function toggleBotMode(_0x315418){const _0x366c18=_0x1fd4cd;if(pid[_0x315418])pid[_0x315418][_0x366c18(0x326)]({'function':_0x366c18(0x2ab),'args':null});else{const _0x47b875=configpath+'bot-'+_0x315418+_0x366c18(0x2d3),_0x2f7541=fs[_0x366c18(0x2b2)](_0x47b875),_0x177453=JSON[_0x366c18(0x318)](_0x2f7541),_0x1ebb0d=_0x177453[_0x366c18(0x345)][0x0][_0x366c18(0x2bc)];_0x177453[_0x366c18(0x345)][0x0][_0x366c18(0x2bc)]=!_0x1ebb0d;const _0x20ded2=JSON[_0x366c18(0x236)](_0x177453,null,0x2);fs['writeFileSync'](_0x47b875,_0x20ded2),config=getConfiguration(),io['to']('botmanager')['emit'](_0x366c18(0x267),config);}}function telegramError(_0xc75bc8){const _0x347ecf=_0x1fd4cd;logger[_0x347ecf(0x1f0)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x16af03){const _0x376a3a=_0x1fd4cd;if(_0x16af03[_0x376a3a(0x304)][_0x376a3a(0x291)]!=settings[_0x376a3a(0x32f)]&&'@'+_0x16af03[_0x376a3a(0x304)][_0x376a3a(0x291)]!=settings[_0x376a3a(0x32f)])return tgBot[_0x376a3a(0x26a)](_0x16af03['chat']['id'],_0x376a3a(0x2f3),{'parse_mode':_0x376a3a(0x2a2)})[_0x376a3a(0x21e)](_0x22ba59=>{telegramError(_0x22ba59);}),![];return!![];}async function initTelegram(){const _0x580e6b=_0x1fd4cd;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x580e6b(0x2cc)],{'polling':!![]});let _0x3e3c66=_0x580e6b(0x23b);_0x3e3c66+='\x0a',_0x3e3c66+=_0x580e6b(0x2f5),_0x3e3c66+=_0x580e6b(0x32a),_0x3e3c66+=_0x580e6b(0x217),_0x3e3c66+=_0x580e6b(0x2c8),_0x3e3c66+='/on\x20-\x20start\x20bot(s)\x0a',_0x3e3c66+='/off\x20-\x20stop\x20bot(s)\x0a',_0x3e3c66+=_0x580e6b(0x2f1),_0x3e3c66+='/names\x20-\x20show\x20bot\x20names\x0a',_0x3e3c66+=_0x580e6b(0x2d1),_0x3e3c66+=_0x580e6b(0x1cd),_0x3e3c66+=_0x580e6b(0x1f3),_0x3e3c66+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x17d304=_0x580e6b(0x25a);_0x17d304+='\x0a',_0x17d304+=_0x3e3c66,tgBot[_0x580e6b(0x246)](/\/start/,_0x4e2664=>{const _0xb05c41=_0x580e6b;if(!validateTelegram(_0x4e2664))return;if(settings[_0xb05c41(0x254)]!=_0x4e2664['chat']['id'])updateSetting('telegramChatId',_0x4e2664[_0xb05c41(0x214)]['id']);updateSetting(_0xb05c41(0x2de),!![]),tgBot[_0xb05c41(0x26a)](_0x4e2664[_0xb05c41(0x214)]['id'],_0x17d304)[_0xb05c41(0x21e)](_0x640287=>{telegramError(_0x640287);});}),tgBot[_0x580e6b(0x246)](/\/enable/,_0x21b7c5=>{const _0x1c4135=_0x580e6b;if(!validateTelegram(_0x21b7c5))return;if(settings[_0x1c4135(0x254)]!=_0x21b7c5[_0x1c4135(0x214)]['id'])updateSetting(_0x1c4135(0x254),_0x21b7c5[_0x1c4135(0x214)]['id']);updateSetting(_0x1c4135(0x2de),!![]),tgBot[_0x1c4135(0x26a)](_0x21b7c5[_0x1c4135(0x214)]['id'],_0x1c4135(0x2f0))['catch'](_0x75937d=>{telegramError(_0x75937d);});}),tgBot[_0x580e6b(0x246)](/\/config/,async _0x369d78=>{const _0x1f53db=_0x580e6b;if(!validateTelegram(_0x369d78))return;tgBot[_0x1f53db(0x29e)](_0x1f53db(0x228)),tgBot[_0x1f53db(0x26a)](_0x369d78[_0x1f53db(0x214)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x1f53db(0x2ce)},{'text':_0x1f53db(0x301),'callback_data':'alerts'},{'text':_0x1f53db(0x20c),'callback_data':_0x1f53db(0x358)}]]}})[_0x1f53db(0x21e)](_0x3fecb5=>{telegramError(_0x3fecb5);}),tgBot['on']('callback_query',async _0x3c6428=>{const _0x46fbc7=_0x1f53db,_0x3ae7bb=_0x3c6428['data'],_0x3bfddc=_0x3c6428['message'];tgBot[_0x46fbc7(0x1c7)](_0x3c6428['id'])[_0x46fbc7(0x213)](async()=>{const _0x2f6522=_0x46fbc7;_0x3ae7bb==_0x2f6522(0x2ce)&&(updateSetting('telegramEvents',_0x2f6522(0x2ce)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x3bfddc[_0x2f6522(0x214)]['id'],_0x2f6522(0x288))[_0x2f6522(0x21e)](_0x5942bb=>{telegramError(_0x5942bb);}));_0x3ae7bb==_0x2f6522(0x257)&&(updateSetting(_0x2f6522(0x26e),_0x2f6522(0x257)),updateSetting(_0x2f6522(0x2de),!![]),await tgBot['sendMessage'](_0x3bfddc['chat']['id'],_0x2f6522(0x1ec))[_0x2f6522(0x21e)](_0x5da459=>{telegramError(_0x5da459);}));_0x3ae7bb=='all'&&(updateSetting(_0x2f6522(0x26e),_0x2f6522(0x358)),updateSetting(_0x2f6522(0x2de),!![]),await tgBot['sendMessage'](_0x3bfddc[_0x2f6522(0x214)]['id'],_0x2f6522(0x239))[_0x2f6522(0x21e)](_0x5a8bee=>{telegramError(_0x5a8bee);}));if(!settings[_0x2f6522(0x254)])tgBot[_0x2f6522(0x26a)](_0x3bfddc[_0x2f6522(0x214)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x2f6522(0x21e)](_0x4a7512=>{telegramError(_0x4a7512);});}),tgBot[_0x46fbc7(0x29e)]('callback_query');});}),tgBot[_0x580e6b(0x246)](/\/status/,_0x56748b=>{const _0x3e3da6=_0x580e6b;if(!validateTelegram(_0x56748b))return;const _0x29c643=getBotsWithMode();let _0x3bb7e4=_0x3e3da6(0x347);config[_0x3e3da6(0x2ed)](_0x30f309=>{const _0x4d7df8=_0x3e3da6,_0x4ac2b1=_0x29c643[_0x4d7df8(0x322)](_0x165a63=>_0x165a63['botID']==_0x30f309[_0x4d7df8(0x1cb)])['mode'];_0x3bb7e4+=_0x4d7df8(0x282)+_0x30f309['botID']+':\x20'+_0x30f309[_0x4d7df8(0x1f6)]+_0x4d7df8(0x2db)+_0x4ac2b1+_0x4d7df8(0x2db)+_0x30f309[_0x4d7df8(0x207)]+'\x0a';}),_0x3bb7e4+='\x0a',_0x3bb7e4+=_0x3e3da6(0x279),_0x3bb7e4+=!settings[_0x3e3da6(0x2de)]?_0x3e3da6(0x352):_0x3e3da6(0x226),_0x3bb7e4+=settings[_0x3e3da6(0x2de)]?settings[_0x3e3da6(0x26e)]==_0x3e3da6(0x358)?_0x3e3da6(0x2c3):_0x3e3da6(0x2c7)+settings[_0x3e3da6(0x26e)]+_0x3e3da6(0x30b):'',tgBot[_0x3e3da6(0x26a)](_0x56748b['chat']['id'],_0x3bb7e4,{'parse_mode':_0x3e3da6(0x2a2)})['catch'](_0x583383=>{telegramError(_0x583383);});}),tgBot[_0x580e6b(0x246)](/\/restart/,_0x19484e=>{const _0x1b8935=_0x580e6b;if(!validateTelegram(_0x19484e))return;tgBot['removeListener'](_0x1b8935(0x228));const _0x4a0e8b=getEnabledBots();if(_0x4a0e8b[_0x1b8935(0x2e9)]==0x0)tgBot[_0x1b8935(0x26a)](_0x19484e['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x1b8935(0x21e)](_0x4f0c07=>{telegramError(_0x4f0c07);});else{if(_0x4a0e8b[_0x1b8935(0x2e9)]>0x1)_0x4a0e8b[_0x1b8935(0x229)]({'botID':'all'});let _0x36a1ff=[],_0x58a6a3=[];const _0x548ccb=_0x4a0e8b[_0x1b8935(0x2e9)]%0x4==0x0||_0x4a0e8b[_0x1b8935(0x2e9)]%0x4==0x3||_0x4a0e8b[_0x1b8935(0x2e9)]%0x3==0x1?0x4:0x3;let _0x328244=0x0;_0x4a0e8b[_0x1b8935(0x2ed)]((_0x589acd,_0x5c98ca)=>{const _0x5d7f3c=_0x1b8935;if(_0x5c98ca%_0x548ccb==0x0)_0x58a6a3=[];_0x58a6a3[_0x5d7f3c(0x229)]({'text':_0x589acd['botID']==_0x5d7f3c(0x358)?_0x5d7f3c(0x2bd):_0x5d7f3c(0x282)+_0x589acd[_0x5d7f3c(0x1cb)],'callback_data':_0x589acd[_0x5d7f3c(0x1cb)]}),_0x5c98ca%_0x548ccb==0x0&&(_0x36a1ff[_0x328244]=_0x58a6a3,_0x328244++);}),tgBot[_0x1b8935(0x26a)](_0x19484e[_0x1b8935(0x214)]['id'],_0x1b8935(0x222),{'reply_markup':{'inline_keyboard':_0x36a1ff}})['catch'](_0x4fe232=>{telegramError(_0x4fe232);}),tgBot['on']('callback_query',async _0x1b95fe=>{const _0x9aae63=_0x1b8935,_0x2600f8=_0x1b95fe[_0x9aae63(0x33b)],_0x3fa909=_0x1b95fe['message'];tgBot['answerCallbackQuery'](_0x1b95fe['id'])[_0x9aae63(0x213)](async()=>{const _0x507a26=_0x9aae63;_0x2600f8==_0x507a26(0x358)?config[_0x507a26(0x2ed)](_0x15c17b=>{const _0x586a1b=_0x507a26;restartBot(_0x15c17b[_0x586a1b(0x1cb)]);}):restartBot(_0x2600f8);}),tgBot['removeListener'](_0x9aae63(0x228));});}}),tgBot[_0x580e6b(0x246)](/\/on/,_0x5f3f3a=>{const _0x1255c9=_0x580e6b;if(!validateTelegram(_0x5f3f3a))return;tgBot[_0x1255c9(0x29e)](_0x1255c9(0x228));const _0x416f7b=getDisabledBots();if(_0x416f7b[_0x1255c9(0x2e9)]==0x0)tgBot[_0x1255c9(0x26a)](_0x5f3f3a[_0x1255c9(0x214)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x1255c9(0x21e)](_0x2ee3f2=>{telegramError(_0x2ee3f2);});else{if(_0x416f7b['length']>0x1)_0x416f7b[_0x1255c9(0x229)]({'botID':_0x1255c9(0x358)});let _0x200708=[],_0x210dff=[];const _0x1f0681=_0x416f7b['length']%0x4==0x0||_0x416f7b['length']%0x4==0x3||_0x416f7b['length']%0x3==0x1?0x4:0x3;let _0x5085a5=0x0;_0x416f7b[_0x1255c9(0x2ed)]((_0x5f4e62,_0x4a7fc1)=>{const _0x4ea039=_0x1255c9;if(_0x4a7fc1%_0x1f0681==0x0)_0x210dff=[];_0x210dff[_0x4ea039(0x229)]({'text':_0x5f4e62[_0x4ea039(0x1cb)]==_0x4ea039(0x358)?'All\x20bots':_0x4ea039(0x282)+_0x5f4e62[_0x4ea039(0x1cb)],'callback_data':_0x5f4e62[_0x4ea039(0x1cb)]}),_0x4a7fc1%_0x1f0681==0x0&&(_0x200708[_0x5085a5]=_0x210dff,_0x5085a5++);}),tgBot['sendMessage'](_0x5f3f3a[_0x1255c9(0x214)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x200708}})[_0x1255c9(0x21e)](_0x49f7a4=>{telegramError(_0x49f7a4);}),tgBot['on'](_0x1255c9(0x228),async _0x5ea169=>{const _0x3c91a7=_0x1255c9,_0x122cf7=_0x5ea169[_0x3c91a7(0x33b)],_0x2d2c50=_0x5ea169['message'];tgBot['answerCallbackQuery'](_0x5ea169['id'])[_0x3c91a7(0x213)](async()=>{const _0x283d1e=_0x3c91a7;_0x122cf7=='all'?(tgBot['sendMessage'](_0x2d2c50[_0x283d1e(0x214)]['id'],_0x283d1e(0x349))[_0x283d1e(0x21e)](_0x5d0bff=>{telegramError(_0x5d0bff);}),_0x416f7b[_0x283d1e(0x2ed)](_0x467cee=>{const _0x32eaf7=_0x283d1e;if(_0x467cee[_0x32eaf7(0x1cb)]!=_0x32eaf7(0x358))toggleBot(_0x467cee['botID'],toggleStatus(_0x467cee[_0x32eaf7(0x1cb)]),_0x32eaf7(0x2a9));})):(tgBot[_0x283d1e(0x26a)](_0x2d2c50['chat']['id'],_0x283d1e(0x30c)+_0x122cf7)[_0x283d1e(0x21e)](_0x436ef5=>{telegramError(_0x436ef5);}),toggleBot(_0x122cf7,toggleStatus(_0x122cf7),_0x283d1e(0x2a9)));}),tgBot[_0x3c91a7(0x29e)](_0x3c91a7(0x228));});}}),tgBot[_0x580e6b(0x246)](/\/off/,_0x53dbe5=>{const _0x3099c0=_0x580e6b;if(!validateTelegram(_0x53dbe5))return;tgBot['removeListener'](_0x3099c0(0x228));const _0x4913a2=getEnabledBots();if(_0x4913a2[_0x3099c0(0x2e9)]==0x0)tgBot[_0x3099c0(0x26a)](_0x53dbe5[_0x3099c0(0x214)]['id'],_0x3099c0(0x27d))[_0x3099c0(0x21e)](_0x2881b7=>{telegramError(_0x2881b7);});else{if(_0x4913a2[_0x3099c0(0x2e9)]>0x1)_0x4913a2[_0x3099c0(0x229)]({'botID':_0x3099c0(0x358)});let _0x4668d3=[],_0x561438=[];const _0x413482=_0x4913a2['length']%0x4==0x0||_0x4913a2[_0x3099c0(0x2e9)]%0x4==0x3||_0x4913a2['length']%0x3==0x1?0x4:0x3;let _0xe551e5=0x0;_0x4913a2[_0x3099c0(0x2ed)]((_0x4411ad,_0x4545fd)=>{const _0x51bd3d=_0x3099c0;if(_0x4545fd%_0x413482==0x0)_0x561438=[];_0x561438['push']({'text':_0x4411ad[_0x51bd3d(0x1cb)]==_0x51bd3d(0x358)?_0x51bd3d(0x2bd):_0x51bd3d(0x282)+_0x4411ad[_0x51bd3d(0x1cb)],'callback_data':_0x4411ad['botID']}),_0x4545fd%_0x413482==0x0&&(_0x4668d3[_0xe551e5]=_0x561438,_0xe551e5++);}),tgBot[_0x3099c0(0x26a)](_0x53dbe5[_0x3099c0(0x214)]['id'],_0x3099c0(0x244),{'reply_markup':{'inline_keyboard':_0x4668d3}})[_0x3099c0(0x21e)](_0x3c9135=>{telegramError(_0x3c9135);}),tgBot['on'](_0x3099c0(0x228),async _0x2f3cf9=>{const _0x1f2dfd=_0x3099c0,_0x3f3388=_0x2f3cf9[_0x1f2dfd(0x33b)],_0x4a980f=_0x2f3cf9[_0x1f2dfd(0x27f)];tgBot[_0x1f2dfd(0x1c7)](_0x2f3cf9['id'])[_0x1f2dfd(0x213)](async()=>{const _0x5573b1=_0x1f2dfd;_0x3f3388==_0x5573b1(0x358)?(tgBot[_0x5573b1(0x26a)](_0x4a980f[_0x5573b1(0x214)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x5573b1(0x21e)](_0x4d0c71=>{telegramError(_0x4d0c71);}),_0x4913a2[_0x5573b1(0x2ed)](_0x3a3598=>{const _0x5bdaa9=_0x5573b1;if(_0x3a3598[_0x5bdaa9(0x1cb)]!=_0x5bdaa9(0x358))toggleBot(_0x3a3598[_0x5bdaa9(0x1cb)],toggleStatus(_0x3a3598[_0x5bdaa9(0x1cb)]),'stopped');})):(tgBot[_0x5573b1(0x26a)](_0x4a980f[_0x5573b1(0x214)]['id'],_0x5573b1(0x341)+_0x3f3388)[_0x5573b1(0x21e)](_0x4c3c53=>{telegramError(_0x4c3c53);}),toggleBot(_0x3f3388,toggleStatus(_0x3f3388),'stopped'));}),tgBot[_0x1f2dfd(0x29e)]('callback_query');});}}),tgBot[_0x580e6b(0x246)](/\/portfolio/,_0xdfa3c=>{const _0x5d64c=_0x580e6b;if(!validateTelegram(_0xdfa3c))return;tgBot[_0x5d64c(0x29e)](_0x5d64c(0x228));const _0xef1564=getEnabledBots();if(_0xef1564['length']==0x0)tgBot[_0x5d64c(0x26a)](_0xdfa3c[_0x5d64c(0x214)]['id'],_0x5d64c(0x27d))[_0x5d64c(0x21e)](_0x57bfc=>{telegramError(_0x57bfc);});else{if(_0xef1564[_0x5d64c(0x2e9)]>0x1){let _0xe48eec=[],_0x4bd1a5=[];const _0x303adb=_0xef1564[_0x5d64c(0x2e9)]%0x4==0x0||_0xef1564[_0x5d64c(0x2e9)]%0x4==0x3||_0xef1564[_0x5d64c(0x2e9)]%0x3==0x1?0x4:0x3;let _0x56d336=0x0;_0xef1564['forEach']((_0x16d93b,_0x345757)=>{const _0x547bb5=_0x5d64c;if(_0x345757%_0x303adb==0x0)_0x4bd1a5=[];_0x4bd1a5[_0x547bb5(0x229)]({'text':_0x547bb5(0x282)+_0x16d93b[_0x547bb5(0x1cb)],'callback_data':_0x16d93b[_0x547bb5(0x1cb)]}),_0x345757%_0x303adb==0x0&&(_0xe48eec[_0x56d336]=_0x4bd1a5,_0x56d336++);}),tgBot[_0x5d64c(0x26a)](_0xdfa3c[_0x5d64c(0x214)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0xe48eec}})[_0x5d64c(0x21e)](_0x97de5f=>{telegramError(_0x97de5f);}),tgBot['on'](_0x5d64c(0x228),async _0x1f8c17=>{const _0x216ffd=_0x5d64c,_0x4cf634=_0x1f8c17[_0x216ffd(0x33b)],_0x394e26=_0x1f8c17[_0x216ffd(0x27f)];tgBot[_0x216ffd(0x1c7)](_0x1f8c17['id'])[_0x216ffd(0x213)](async()=>{const _0x3fd0ce=_0x216ffd;if(pid[_0x4cf634])pid[_0x4cf634][_0x3fd0ce(0x326)]({'function':_0x3fd0ce(0x209),'args':null});}),tgBot[_0x216ffd(0x29e)](_0x216ffd(0x228));});}else{const _0x2aadcd=_0xef1564[0x0][_0x5d64c(0x1cb)];if(pid[_0x2aadcd])pid[_0x2aadcd][_0x5d64c(0x326)]({'function':_0x5d64c(0x209),'args':null});}}}),tgBot[_0x580e6b(0x246)](/\/update/,async _0x1f4c8a=>{const _0x5391a1=_0x580e6b;if(!validateTelegram(_0x1f4c8a))return;tgBot[_0x5391a1(0x29e)](_0x5391a1(0x228)),await getMessages();if(!updateAvailable)tgBot[_0x5391a1(0x26a)](_0x1f4c8a[_0x5391a1(0x214)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')['catch'](_0x5c3be5=>{telegramError(_0x5c3be5);});else!validInstallation?tgBot[_0x5391a1(0x26a)](_0x1f4c8a['chat']['id'],_0x5391a1(0x245))['catch'](_0x29d9df=>{telegramError(_0x29d9df);}):(tgBot[_0x5391a1(0x26a)](_0x1f4c8a[_0x5391a1(0x214)]['id'],_0x5391a1(0x205),{'reply_markup':{'inline_keyboard':[[{'text':_0x5391a1(0x2ef),'callback_data':_0x5391a1(0x33a)},{'text':'No','callback_data':'no'}]]}})[_0x5391a1(0x21e)](_0x4074ff=>{telegramError(_0x4074ff);}),tgBot['on'](_0x5391a1(0x228),async _0x49dfd9=>{const _0x135f61=_0x5391a1,_0x5ddc35=_0x49dfd9[_0x135f61(0x33b)],_0xcf5c7=_0x49dfd9[_0x135f61(0x27f)];tgBot['answerCallbackQuery'](_0x49dfd9['id'])[_0x135f61(0x213)](async()=>{const _0x3ea642=_0x135f61;_0x5ddc35==_0x3ea642(0x33a)&&(await tgBot[_0x3ea642(0x26a)](_0xcf5c7[_0x3ea642(0x214)]['id'],_0x3ea642(0x1e9))[_0x3ea642(0x21e)](_0x42b911=>{telegramError(_0x42b911);}),updateBB());_0x5ddc35=='no'&&await tgBot['sendMessage'](_0xcf5c7[_0x3ea642(0x214)]['id'],_0x3ea642(0x297))[_0x3ea642(0x21e)](_0x55fbf7=>{telegramError(_0x55fbf7);});if(!settings[_0x3ea642(0x254)])tgBot['sendMessage'](_0xcf5c7[_0x3ea642(0x214)]['id'],_0x3ea642(0x1de))[_0x3ea642(0x21e)](_0xd8f4a5=>{telegramError(_0xd8f4a5);});}),tgBot[_0x135f61(0x29e)]('callback_query');}));}),tgBot[_0x580e6b(0x246)](/\/toggle/,_0x170acb=>{const _0x3fe193=_0x580e6b;if(!validateTelegram(_0x170acb))return;tgBot[_0x3fe193(0x29e)](_0x3fe193(0x228));const _0x2f293a=getBotsWithMode();if(_0x2f293a[_0x3fe193(0x2e9)]==0x0)tgBot[_0x3fe193(0x26a)](_0x170acb['chat']['id'],_0x3fe193(0x27d))[_0x3fe193(0x21e)](_0x59e5e2=>{telegramError(_0x59e5e2);});else{let _0x2ffc7a=[],_0x102edd=[];const _0x9e8b93=0x2;let _0x256a72=0x0;_0x2f293a['forEach']((_0x25d9ad,_0x2dfd72)=>{const _0xb386ee=_0x3fe193;if(_0x2dfd72%_0x9e8b93==0x0)_0x102edd=[];_0x102edd[_0xb386ee(0x229)]({'text':'Bot\x20'+_0x25d9ad[_0xb386ee(0x1cb)]+'\x20('+_0x25d9ad[_0xb386ee(0x2a3)]+')','callback_data':_0x25d9ad[_0xb386ee(0x1cb)]}),_0x2dfd72%_0x9e8b93==0x0&&(_0x2ffc7a[_0x256a72]=_0x102edd,_0x256a72++);}),tgBot[_0x3fe193(0x26a)](_0x170acb[_0x3fe193(0x214)]['id'],_0x3fe193(0x247),{'reply_markup':{'inline_keyboard':_0x2ffc7a}})[_0x3fe193(0x21e)](_0x5eb99a=>{telegramError(_0x5eb99a);}),tgBot['on'](_0x3fe193(0x228),async _0x6926b5=>{const _0x2cb2bf=_0x3fe193,_0xfde522=_0x6926b5['data'],_0x57dd56=_0x6926b5[_0x2cb2bf(0x27f)];tgBot['answerCallbackQuery'](_0x6926b5['id'])[_0x2cb2bf(0x213)](async()=>{const _0x2aa6fc=_0x2cb2bf,_0x18e51c=_0x2f293a['find'](_0x327666=>_0x327666[_0x2aa6fc(0x1cb)]==_0xfde522),_0x1af538=_0x18e51c['mode']=='auto'?_0x2aa6fc(0x271):_0x2aa6fc(0x1fb);tgBot[_0x2aa6fc(0x26a)](_0x57dd56[_0x2aa6fc(0x214)]['id'],_0x2aa6fc(0x319)+_0xfde522+_0x2aa6fc(0x20f)+_0x1af538+'\x20mode')['catch'](_0x52386f=>{telegramError(_0x52386f);}),toggleBotMode(_0xfde522);}),tgBot[_0x2cb2bf(0x29e)](_0x2cb2bf(0x228));});}}),tgBot['onText'](/\/names/,_0x19cedd=>{const _0x3b9114=_0x580e6b;if(!validateTelegram(_0x19cedd))return;let _0x4726ee='';config['forEach'](_0x4d97f4=>{const _0x4e1395=_0x45f6;_0x4726ee+=_0x4e1395(0x282)+_0x4d97f4[_0x4e1395(0x1cb)]+':\x20'+_0x4d97f4[_0x4e1395(0x25b)]+'\x0a';}),tgBot['sendMessage'](_0x19cedd[_0x3b9114(0x214)]['id'],_0x4726ee,{'parse_mode':_0x3b9114(0x2a2)})[_0x3b9114(0x21e)](_0x17426c=>{telegramError(_0x17426c);});}),tgBot[_0x580e6b(0x246)](/\/disable/,_0x24426c=>{const _0x3d6fe3=_0x580e6b;if(!validateTelegram(_0x24426c))return;tgBot[_0x3d6fe3(0x26a)](_0x24426c[_0x3d6fe3(0x214)]['id'],_0x3d6fe3(0x2e1))[_0x3d6fe3(0x21e)](_0x53ea1a=>{telegramError(_0x53ea1a);}),updateSetting(_0x3d6fe3(0x2de),![]);}),tgBot[_0x580e6b(0x246)](/\/help/,_0x5bf2b6=>{const _0x1ef488=_0x580e6b;if(!validateTelegram(_0x5bf2b6))return;tgBot[_0x1ef488(0x26a)](_0x5bf2b6[_0x1ef488(0x214)]['id'],_0x3e3c66)[_0x1ef488(0x21e)](_0x1d0906=>{telegramError(_0x1d0906);});}),tgBot['on'](_0x580e6b(0x2e3),_0x2076bb=>{const _0x347726=_0x580e6b;_0x2076bb[_0x347726(0x1d6)]()['includes'](_0x347726(0x292))&&(logger[_0x347726(0x309)](_0x347726(0x331)),tgBot[_0x347726(0x22b)](),tgBot=null,io['to'](_0x347726(0x241))[_0x347726(0x265)](_0x347726(0x2b5),_0x347726(0x331)));}),process[_0x580e6b(0x24e)](_0x580e6b(0x340),()=>{const _0x552afa=_0x580e6b;if(tgBot)tgBot[_0x552afa(0x22b)]();process[_0x552afa(0x31b)](0x1);}),process[_0x580e6b(0x24e)](_0x580e6b(0x1e2),()=>{const _0x22bcb3=_0x580e6b;if(tgBot)tgBot[_0x22bcb3(0x22b)]();process[_0x22bcb3(0x31b)](0x1);});}}function disableTelegram(){const _0x1f3e46=_0x1fd4cd;tgBot&&(tgBot[_0x1f3e46(0x22b)](),tgBot=null);}function sendTelegram(_0x2e9400,_0x3f0966){const _0x4a4bb5=_0x1fd4cd;if(settings[_0x4a4bb5(0x2de)]){if(settings['telegramEvents']==_0x4a4bb5(0x358)||(_0x3f0966[_0x4a4bb5(0x29f)]==_0x4a4bb5(0x266)||_0x3f0966[_0x4a4bb5(0x29f)]==_0x4a4bb5(0x2d8)||_0x3f0966[_0x4a4bb5(0x29f)]==_0x4a4bb5(0x284))&&settings[_0x4a4bb5(0x26e)]==_0x4a4bb5(0x257)||_0x3f0966['type']=='order'&&settings[_0x4a4bb5(0x26e)]==_0x4a4bb5(0x2ce)){if(tgBot&&settings[_0x4a4bb5(0x254)]){if(_0x3f0966[_0x4a4bb5(0x218)])tgBot['sendMessage'](settings[_0x4a4bb5(0x254)],_0x3f0966['botname']+'\x20>\x20'+_0x3f0966[_0x4a4bb5(0x34b)])[_0x4a4bb5(0x21e)](_0x45c618=>{telegramError(_0x45c618);});else tgBot[_0x4a4bb5(0x26a)](settings[_0x4a4bb5(0x254)],_0x4a4bb5(0x282)+_0x2e9400+_0x4a4bb5(0x206)+_0x3f0966[_0x4a4bb5(0x34b)])['catch'](_0x5ba07c=>{telegramError(_0x5ba07c);});}}}}async function sendTelegramMsg(_0x223f93,_0x1de69c='HTML'){const _0x4784e9=_0x1fd4cd;return settings[_0x4784e9(0x2de)]&&tgBot&&settings[_0x4784e9(0x254)]?(await tgBot[_0x4784e9(0x26a)](settings['telegramChatId'],_0x223f93,{'parse_mode':_0x1de69c})[_0x4784e9(0x21e)](_0x2d4609=>{telegramError(_0x2d4609);}),!![]):![];}function getDeviceWithIp(_0x34f065){return devices['find'](_0xcb426e=>_0xcb426e['ip']===_0x34f065);}function temporaryAccess2FA(_0x474fec,_0xe8705b){const _0x203fab=_0x1fd4cd;let _0x1c1a4a=new Date(),_0x5e3662=![];if(lastIpApproval){if(_0x1c1a4a-lastIpApproval<0x1388)_0x5e3662=!![];}lastIpApproval=new Date();if(_0x5e3662)return;tgBot&&settings[_0x203fab(0x254)]&&(tgBot[_0x203fab(0x29e)](_0x203fab(0x228)),tgBot[_0x203fab(0x26a)](settings[_0x203fab(0x254)],_0x203fab(0x2eb)+normalizeIP(_0xe8705b)[_0x203fab(0x234)]+_0x203fab(0x277),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x203fab(0x208),'callback_data':'30'},{'text':_0x203fab(0x274),'callback_data':'reject'}]]}})[_0x203fab(0x21e)](_0x243418=>{telegramError(_0x243418);}),tgBot['on'](_0x203fab(0x228),async _0x53535d=>{const _0x1e4460=_0x203fab,_0x2c1a03=_0x53535d[_0x1e4460(0x33b)],_0x10d04d=_0x53535d[_0x1e4460(0x27f)];tgBot[_0x1e4460(0x1c7)](_0x53535d['id'])[_0x1e4460(0x213)](async()=>{const _0x4562c3=_0x1e4460;devices[_0x474fec][_0x4562c3(0x2a5)]={'clientip':_0xe8705b,'timestamp':new Date()[_0x4562c3(0x1d8)](),'expiry':_0x2c1a03},_0x2c1a03!='reject'?(await tgBot[_0x4562c3(0x26a)](_0x10d04d[_0x4562c3(0x214)]['id'],_0x4562c3(0x295)+_0x2c1a03+_0x4562c3(0x2ae),{'parse_mode':_0x4562c3(0x2a2)})[_0x4562c3(0x21e)](_0x57a65f=>{telegramError(_0x57a65f);}),io['to'](_0x474fec)[_0x4562c3(0x265)]('status',{'access':{'allow':![],'reason':_0x4562c3(0x272),'token':null}})):(await tgBot[_0x4562c3(0x26a)](_0x10d04d['chat']['id'],_0x4562c3(0x1e5))[_0x4562c3(0x21e)](_0x4a5975=>{telegramError(_0x4a5975);}),io['to'](_0x474fec)[_0x4562c3(0x265)](_0x4562c3(0x1f6),{'access':{'allow':![],'reason':_0x4562c3(0x330),'token':null}}));}),tgBot['removeListener'](_0x1e4460(0x228));}));}function loginAccess2FA(_0x38329c,_0x31b3c0){const _0x2e65f0=_0x1fd4cd;tgBot&&settings[_0x2e65f0(0x254)]&&(tgBot[_0x2e65f0(0x29e)](_0x2e65f0(0x228)),tgBot[_0x2e65f0(0x26a)](settings[_0x2e65f0(0x254)],_0x2e65f0(0x34c)+normalizeIP(_0x31b3c0)[_0x2e65f0(0x234)]+_0x2e65f0(0x277),{'parse_mode':_0x2e65f0(0x2a2),'reply_markup':{'inline_keyboard':[[{'text':_0x2e65f0(0x269),'callback_data':loginExpiry},{'text':_0x2e65f0(0x274),'callback_data':_0x2e65f0(0x274)}]]}})[_0x2e65f0(0x21e)](_0x1ce0f0=>{telegramError(_0x1ce0f0);}),tgBot['on'](_0x2e65f0(0x228),async _0x11260b=>{const _0x5ad337=_0x2e65f0,_0x1cbe5f=_0x11260b[_0x5ad337(0x33b)],_0x199529=_0x11260b[_0x5ad337(0x27f)];tgBot['answerCallbackQuery'](_0x11260b['id'])[_0x5ad337(0x213)](async()=>{const _0x28b17b=_0x5ad337;devices[_0x38329c][_0x28b17b(0x290)]={'clientip':_0x31b3c0,'timestamp':new Date()[_0x28b17b(0x1d8)](),'expiry':_0x1cbe5f},_0x1cbe5f!='reject'?(await tgBot['sendMessage'](_0x199529[_0x28b17b(0x214)]['id'],_0x28b17b(0x1eb),{'parse_mode':_0x28b17b(0x2a2)})['catch'](_0x52e749=>{telegramError(_0x52e749);}),io['to'](_0x38329c)[_0x28b17b(0x265)](_0x28b17b(0x1f6),{'access':{'allow':![],'reason':_0x28b17b(0x272),'token':null}})):(await tgBot[_0x28b17b(0x26a)](_0x199529[_0x28b17b(0x214)]['id'],_0x28b17b(0x2cf))['catch'](_0x31dba7=>{telegramError(_0x31dba7);}),io['to'](_0x38329c)[_0x28b17b(0x265)](_0x28b17b(0x1f6),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x5ad337(0x29e)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3769b8=_0x1fd4cd;return dbConfig[_0x3769b8(0x258)](_0x3769b8(0x267))[_0x3769b8(0x31e)](_0x3769b8(0x1cb))[_0x3769b8(0x1da)]({'status':_0x3769b8(0x34e)})[_0x3769b8(0x299)]()||[];}function getDisabledBots(){const _0xa56a72=_0x1fd4cd;return dbConfig[_0xa56a72(0x258)](_0xa56a72(0x267))[_0xa56a72(0x31e)]('botID')['filter']({'status':_0xa56a72(0x2f6)})[_0xa56a72(0x299)]()||[];}function getBotAttributes(_0x2c00ca){const _0x5c866e=_0x1fd4cd;let _0x399c44={};const _0x37ef5b=configpath+_0x5c866e(0x2bb)+_0x2c00ca+_0x5c866e(0x2d3),_0x4bf79f=fs['existsSync'](_0x37ef5b);if(_0x4bf79f){const _0x4e565f=fs[_0x5c866e(0x2b2)](_0x37ef5b);try{const _0x2dbe5f=JSON[_0x5c866e(0x318)](_0x4e565f),_0x3121ac=_0x2dbe5f?_0x2dbe5f[_0x5c866e(0x345)][0x0][_0x5c866e(0x2bc)]:![];_0x399c44['mode']=_0x3121ac?_0x5c866e(0x1fb):_0x5c866e(0x271),_0x399c44[_0x5c866e(0x25b)]=_0x2dbe5f?_0x2dbe5f[_0x5c866e(0x345)][0x0]['botname']:'Bot\x20'+_0x2c00ca;}catch(_0x57a21c){_0x399c44['mode']=_0x5c866e(0x271),_0x399c44[_0x5c866e(0x25b)]='Bot\x20'+_0x2c00ca;}}else _0x399c44['mode']=_0x5c866e(0x271),_0x399c44[_0x5c866e(0x25b)]=_0x5c866e(0x282)+_0x2c00ca;return _0x399c44;}function getBotsWithMode(){const _0x53626e=_0x1fd4cd,_0x7733e1=dbConfig[_0x53626e(0x258)](_0x53626e(0x267))[_0x53626e(0x31e)]('botID')[_0x53626e(0x299)]()||[];return _0x7733e1[_0x53626e(0x2ed)](_0x203938=>{const _0x33dca9=_0x53626e;let _0xa08be=getBotAttributes(_0x203938[_0x33dca9(0x1cb)]);_0x203938[_0x33dca9(0x2a3)]=_0xa08be[_0x33dca9(0x2a3)];}),_0x7733e1;}async function initUser(){const _0x533768=_0x1fd4cd;if(!settings[_0x533768(0x354)]){const _0x26e6c4=uuidRandom();mixpanel[_0x533768(0x215)](_0x26e6c4),updateSetting(_0x533768(0x354),_0x26e6c4);}}function _0x8abe(){const _0x41779a=['::1','getStartingBalances','cancelLoading','any','started',',\x20must\x20be\x20a\x204\x20digit\x20number','starting\x20new\x20bot\x20|\x20Bot\x20','f2aRequired','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','\x20>\x20','live','30\x20min','sendPortfolioTelegram','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Unauthorized\x20attempt\x20to\x20delete\x20bot','All','Unauthorized\x20attempt\x20to\x20log\x20out','cloneDeep','\x20to\x20','secret','get-starting-balances','store-configuration','then','chat','alias','updatebotmanager','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','showname','disconnect','index.html','bb-config.json','Unauthorized\x20login\x20attempt\x20(timeout)','Unauthorized\x20attempt\x20to\x20get\x20logs','catch','pidRefreshToken','build','copyFileSync','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','max','store','hashSync','Notifications\x20enabled\x0a','referer','callback_query','push','7831550DCbcjG','stopPolling','RSA-OAEP','version','getDate','reset-password','error\x20while\x20deleting\x20config\x20files:\x20','606306ZuPOIV','3000','toIPv4Address','show','min','stringify','function','Server','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Invalid\x20IP\x20address','You\x20can\x20use\x20the\x20following\x20commands:\x0a','token','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','backup/','************','http','botmanager','/:bot/portfolio','login\x20token\x20generated','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','onText','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','storeHeadless','match','axios','Bot\x20Mgr\x20>\x20','/download/:type','bb-secure.json','once','temp/','get-portfolio','Unauthorized\x20attempt\x20to\x20store\x20configuration','bbvReceive','server','telegramChatId','node-zip','cancel-loading','alerts','get','decrypt','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','botname','getHours','whitelistEnabled','bbPassword','use','name','settings','21vESWDr','slice','1000','emit','error','bots','port','accept','sendMessage','deleted\x20Bot\x20','lowdb/adapters/FileSync','mixpanel','telegramEvents','stop','test','manual','reload','graphql-request','reject','backupfile','connection','</b>\x20?','disabled\x20Bot\x20','<b>Telegram\x20Bot\x20Status:</b>\x0a','DEFLATE','timestamp','output-003.log','No\x20bots\x20running\x20right\x20now','store-headless','message','apiKey','lowdb','Bot\x20','getUTCHours','success','7MpIVmf','remoteAddress','util','Ok,\x20will\x20send\x20order\x20notifications\x20only','logs/','write','clients','update-bot','add-bot','2FA\x20login\x20token\x20generated','kill','telegram2FaApproval','username','404\x20Not\x20Found','Error:\x20Invalid\x20argument\x20','api-eu.mixpanel.com','Access\x20enabled\x20for\x20','bot.js','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','temporary\x20access\x20not\x20allowed','value','delete-bot','1291970HrzOVt','storeConfiguration','3265074NQAXYr','removeListener','type','expiry','Password\x20reset\x20rejected','HTML','mode','params','telegramIpApproval','.zip','temporaryAccessAllowed','createServer','stopped','sockets','toggleBotMode','inherit','settings.','\x20minutes','Markdown','(((.+)+)+)+$','defaults','readFileSync','6RucWNB','host','notification','getFullYear','logged\x20out','-performance.json','0.0.0','node-telegram-bot-api','bot-','headless','All\x20bots','padStart','files','listen','getSeconds','clientip','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','bbUsername','exec','Unauthorized\x20attempt\x20to\x20get\x20messages','Notifications\x20types:\x20','/restart\x20-\x20restart\x20bot(s)\x0a','track','assign','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','telegramToken','\x20(2)','orders','Login\x20rejected','getMinutes','/status\x20-\x20show\x20bot(s)\x20status\x0a','telegrammsg','-config.json','set','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Invalid\x20authentication\x20token\x20(1)','bbvNew','warning','tkn','timeshift','\x20|\x20','login\x20not\x20required','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','telegramEnabled','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','auth','Notifications\x20disabled','Restoring\x20bot(s)\x20from\x20backup\x20-\x20Bot\x20Manager\x20will\x20restart\x20once\x20finished','polling_error','Crypt','invalid\x20credentials','***','User\x20has\x20been\x20validated','isValid','length','login\x20required','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','rmSync','forEach','/:bot/coins','Yes','Notifications\x20enabled','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','handshake','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','toIPv4MappedAddress','/enable\x20-\x20enable\x20notifications\x0a','disabled','apply','new','randomFillSync','sha256','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)!','access','toggle-bot-mode','temporary\x20access\x20timeout','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','unlinkSync','Alerts','join','initclient','from','isDirectory','/:bot/configuration','lastmsgtelegram','output-000.log','full','number','\x20only\x0a','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','allow','RSA','-----------------------------------------------------------------------------------','temporary\x20token\x20generated','sign','entries','hasOwnProperty','password','date-fns','enabled\x20Bot\x20','ipv6','parse','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','bb-settings.json','exit','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','format','sortBy','messages','getPortfolio','https://api.ipify.org?format=json','find','/:bot','pidExpireLogin','uuid','send','compareSync','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','hex','/disable\x20-\x20disable\x20notifications\x0a','config/','login\x20token\x20valid','log','jsonwebtoken','telegramUsername','temporary\x20access\x20rejected','Invalid\x20Telegram\x20token','add','-events.json','connected','Invalid\x20authentication\x20token\x20(2)','Password\x20has\x20been\x20reset\x20to:\x20','existsSync','access\x20timeout','Unauthorized\x20attempt\x20to\x20download\x20','yes','data','static','headers','binary','reason','SIGINT','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','/:bot/performance','size','remove','bot','writeFileSync','<b>Balance\x20Bot\x20Status:</b>\x0a','-results.json','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','mkdirSync','event','Allow\x20login\x20from\x20IP\x20address\x20<b>','new-disabled','enabled','Unauthorized\x20attempt\x20to\x20get\x20portfolio','latestversion','2FA\x20login\x20required','Notifications\x20disabled\x0a','Invalid\x20username\x20or\x20IP\x20address','userid','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','output-002.log','all','loginRequired','generate','crypto','confirm-message','secure','126524bZzDHD','Unauthorized\x20attempt\x20to\x20confirm\x20message','ipc','update-bb','answerCallbackQuery','emitHistory','2FA','getMonth','botID','placeOrder','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','split','61611uYoULU','fork','/:bot/support','bcryptjs','file','readdirSync','socket.io','toString','download','getTime','$1_$2_$3','filter','output-001.log','blacklist','args','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','lastmsgemitted','startsWith','Unauthorized\x20attempt\x20to\x20update\x20bot','SIGTERM','publicKey','conn','Temporary\x20access\x20rejected','privateKey','hybrid-crypto-js','idling\x20bot\x20\x20\x20|\x20Bot\x20','Starting\x20Balance\x20Bot\x20update','starting\x20bot\x20|\x20Bot\x20','Login\x20accepted','Ok,\x20will\x20send\x20alert\x20notifications\x20only','sort','argv','socket','simple','login','child_process','/update\x20-\x20update\x20Balance\x20Bot\x0a','908296gIJwHS','request','status','sendFile','express','/upload-backup','2FA\x20required','auto','keys'];_0x8abe=function(){return _0x41779a;};return _0x8abe();}async function initSecure(){const _0x3212d9=_0x1fd4cd;let _0xdafac5=getSecure();if(!_0xdafac5[_0x3212d9(0x313)](_0x3212d9(0x210))){let _0x19e04d=await generateKeys();_0xdafac5['publicKey']=_0x19e04d[_0x3212d9(0x1e3)],_0xdafac5[_0x3212d9(0x1e6)]=_0x19e04d[_0x3212d9(0x1e6)],_0xdafac5[_0x3212d9(0x210)]=crypto['randomBytes'](0x20)['toString'](_0x3212d9(0x329));;storeSecure(_0xdafac5);}}function getSettings(){const _0x2394a6=_0x1fd4cd;return dbSettings[_0x2394a6(0x258)](_0x2394a6(0x261))[_0x2394a6(0x299)]()||{};}function getSecure(){const _0x156599=_0x1fd4cd;return dbSecure[_0x156599(0x258)](_0x156599(0x1c2))[_0x156599(0x299)]()||{};}function getBlacklist(){const _0x406ffc=_0x1fd4cd;return dbSecure['get'](_0x406ffc(0x1dc))[_0x406ffc(0x299)]()||[];}function broadcastToBots(_0x52262c,_0x3574f1){config['forEach'](_0x44b3d1=>{const _0x5aed95=_0x45f6;if(_0x44b3d1[_0x5aed95(0x1f6)]=='enabled'&&_0x44b3d1['live']=='running'){if(pid[_0x44b3d1[_0x5aed95(0x1cb)]])pid[_0x44b3d1[_0x5aed95(0x1cb)]][_0x5aed95(0x326)]({[_0x52262c]:_0x3574f1});}});}function storeSettings(_0x3df169,_0x1c01b7=![]){const _0x39aec0=_0x1fd4cd;_0x3df169={...settings,..._0x3df169};if(_0x1c01b7&&_0x3df169[_0x39aec0(0x25e)]!='************'&&_0x3df169[_0x39aec0(0x25e)]!='***'&&_0x3df169[_0x39aec0(0x25e)]!=''){const _0x5a4e56=crypt[_0x39aec0(0x259)](secure['privateKey'],_0x3df169[_0x39aec0(0x25e)])[_0x39aec0(0x27f)]['split']('@')[0x0],_0x4f6a23=bcrypt[_0x39aec0(0x225)](_0x5a4e56,saltRounds);_0x3df169={..._0x3df169,'bbPassword':_0x4f6a23};}if(_0x1c01b7&&_0x3df169[_0x39aec0(0x2cc)]!=_0x39aec0(0x23f)&&_0x3df169['telegramToken']!=_0x39aec0(0x2e6)&&_0x3df169[_0x39aec0(0x2cc)]!=''){const _0x1b71f7=crypt[_0x39aec0(0x259)](secure[_0x39aec0(0x1e6)],_0x3df169['telegramToken'])[_0x39aec0(0x27f)][_0x39aec0(0x1ce)]('@')[0x0];_0x3df169={..._0x3df169,'telegramToken':_0x1b71f7};}const _0x53a61b=_0x3df169[_0x39aec0(0x2cc)]!=_0x39aec0(0x23f)&&_0x3df169[_0x39aec0(0x2cc)]!=settings[_0x39aec0(0x2cc)]||_0x3df169[_0x39aec0(0x32f)]!=settings[_0x39aec0(0x32f)],_0x430d09=_0x3df169[_0x39aec0(0x2cc)]==''||_0x3df169[_0x39aec0(0x32f)]=='';if(_0x53a61b)_0x3df169[_0x39aec0(0x26e)]=_0x39aec0(0x358);for(const [_0x1cf8d0,_0x8181d9]of Object[_0x39aec0(0x312)](_0x3df169)){if(_0x1cf8d0=='telegramToken'&&_0x8181d9==_0x39aec0(0x23f)){_0x3df169[_0x39aec0(0x2cc)]=settings[_0x39aec0(0x2cc)];continue;};if(_0x1cf8d0==_0x39aec0(0x25e)&&_0x8181d9==_0x39aec0(0x23f)){_0x3df169[_0x39aec0(0x25e)]=settings['bbPassword'];continue;};dbSettings['set'](_0x39aec0(0x2ad)+_0x1cf8d0,_0x8181d9)[_0x39aec0(0x28a)]();}settings=_0x3df169,io['to'](_0x39aec0(0x241))[_0x39aec0(0x265)](_0x39aec0(0x261),cleanSettings()),broadcastToBots(_0x39aec0(0x2da),settings['timeshift']);if(_0x53a61b&&!_0x430d09)initTelegram();if(_0x53a61b&&_0x430d09)disableTelegram();getAllClients()[_0x39aec0(0x2ed)](_0x1b3b2f=>{const _0x372f5e=_0x39aec0;getSocket(_0x1b3b2f['id'])[_0x372f5e(0x265)](_0x372f5e(0x1f6),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x1b31ff,_0x1a2e61){const _0x4960c2=_0x1fd4cd;dbSettings[_0x4960c2(0x2d4)](_0x4960c2(0x2ad)+_0x1b31ff,_0x1a2e61)['write'](),settings=getSettings(),io['to'](_0x4960c2(0x241))[_0x4960c2(0x265)](_0x4960c2(0x261),cleanSettings());}function storeSecure(_0x47d0c6){const _0xea14bc=_0x1fd4cd;dbSecure[_0xea14bc(0x258)]('secure')[_0xea14bc(0x229)](_0x47d0c6)[_0xea14bc(0x28a)](),secure=_0x47d0c6;}function addBlacklist(_0x5acc97){const _0x3a7893=_0x1fd4cd;cleanBlacklist();let _0x48b1de;devices[_0x5acc97][_0x3a7893(0x2a5)]?_0x48b1de=Math[_0x3a7893(0x223)](devices[_0x5acc97][_0x3a7893(0x2a5)][_0x3a7893(0x2a0)],loginExpiry):_0x48b1de=loginExpiry,dbSecure[_0x3a7893(0x258)](_0x3a7893(0x1dc))[_0x3a7893(0x229)]({'expiry':new Date()[_0x3a7893(0x1d8)]()+_0x48b1de*0x3c*0x3e8,'token':devices[_0x5acc97]['access'][_0x3a7893(0x23c)]})[_0x3a7893(0x28a)](),blacklist=dbSecure['get'](_0x3a7893(0x1dc))[_0x3a7893(0x299)]();}function cleanBlacklist(){const _0x1b2063=_0x1fd4cd;let _0x188c4b=dbSecure[_0x1b2063(0x258)](_0x1b2063(0x1dc))[_0x1b2063(0x20e)]()[_0x1b2063(0x299)](),_0x2fd786=new Date()[_0x1b2063(0x1d8)]();_0x188c4b['forEach'](_0x9f9fce=>{const _0x4e4873=_0x1b2063;_0x9f9fce['expiry']<_0x2fd786&&dbSecure['get'](_0x4e4873(0x1dc))['remove']({'expiry':_0x9f9fce[_0x4e4873(0x2a0)]})[_0x4e4873(0x28a)]();});}function initStates(){const _0x508e39=_0x1fd4cd;let _0x21ae65=getConfiguration();_0x21ae65[_0x508e39(0x2ed)](_0x177f5d=>{const _0x23c652=_0x508e39;_0x177f5d['live']=_0x23c652(0x2a9);}),storeConfiguration(_0x21ae65);}function onKeys(){const _0x53f003=new RSA();return new Promise(_0x5bd060=>{const _0x51d393=_0x45f6;_0x53f003['generateKeyPairAsync']()[_0x51d393(0x213)](_0x4b85dc=>{_0x5bd060(_0x4b85dc);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x368420=_0x1fd4cd;let _0xf23aaf=getSettings(),_0x1c10e1=![];!_0xf23aaf[_0x368420(0x313)](_0x368420(0x307))&&(_0xf23aaf[_0x368420(0x307)]=0x0,_0x1c10e1=!![]);!_0xf23aaf[_0x368420(0x313)](_0x368420(0x1df))&&(_0xf23aaf[_0x368420(0x1df)]=0x0,_0x1c10e1=!![]);!_0xf23aaf[_0x368420(0x313)](_0x368420(0x350))&&(_0xf23aaf[_0x368420(0x350)]='0.0.0',_0x1c10e1=!![]);if(_0x1c10e1)storeSettings(_0xf23aaf);}function storeConfiguration(_0x320a4d){const _0x481351=_0x1fd4cd;dbConfig[_0x481351(0x258)](_0x481351(0x267))[_0x481351(0x344)]()['write'](),_0x320a4d[_0x481351(0x2ed)](_0x5b809a=>{const _0x54b949=_0x481351;delete _0x5b809a[_0x54b949(0x2a3)];}),dbConfig[_0x481351(0x258)](_0x481351(0x267))['push'](..._0x320a4d)[_0x481351(0x28a)](),config=_0x320a4d;}function resetPassword(){const _0x3ef81c=_0x1fd4cd;tgBot&&settings[_0x3ef81c(0x254)]&&(tgBot[_0x3ef81c(0x29e)](_0x3ef81c(0x228)),tgBot[_0x3ef81c(0x26a)](settings[_0x3ef81c(0x254)],_0x3ef81c(0x31c),{'parse_mode':_0x3ef81c(0x2a2),'reply_markup':{'inline_keyboard':[[{'text':_0x3ef81c(0x33a),'callback_data':_0x3ef81c(0x33a)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x1efa2a=>{telegramError(_0x1efa2a);}),tgBot['on'](_0x3ef81c(0x228),async _0x487c3b=>{const _0x403fa1=_0x3ef81c,_0x30e9ba=_0x487c3b['data'],_0x4b7c72=_0x487c3b['message'];tgBot['answerCallbackQuery'](_0x487c3b['id'])[_0x403fa1(0x213)](async()=>{const _0xf69d14=_0x403fa1;if(_0x30e9ba!='no'){const _0x1cf509=0xf,_0x430d18=_0xf69d14(0x2cb),_0x1cf920=Array[_0xf69d14(0x304)](crypto[_0xf69d14(0x2f9)](new Uint32Array(_0x1cf509)))['map'](_0xec8632=>_0x430d18[_0xec8632%_0x430d18[_0xf69d14(0x2e9)]])[_0xf69d14(0x302)](''),_0x57da4a=bcrypt[_0xf69d14(0x225)](_0x1cf920,saltRounds);storeSettings({'bbPassword':_0x57da4a}),await tgBot[_0xf69d14(0x26a)](_0x4b7c72['chat']['id'],_0xf69d14(0x336)+_0x1cf920,{'parse_mode':_0xf69d14(0x2a2)})[_0xf69d14(0x21e)](_0x41aebc=>{telegramError(_0x41aebc);});}else await tgBot[_0xf69d14(0x26a)](_0x4b7c72['chat']['id'],_0xf69d14(0x2a1))[_0xf69d14(0x21e)](_0x40d044=>{telegramError(_0x40d044);});}),tgBot[_0x403fa1(0x29e)](_0x403fa1(0x228));}));}async function confirmRestore(_0x48a732,_0x79bb3a){const _0x177922=_0x1fd4cd;tgBot&&settings[_0x177922(0x254)]&&(tgBot['removeListener'](_0x177922(0x228)),await tgBot[_0x177922(0x26a)](settings[_0x177922(0x254)],_0x177922(0x2fb),{'parse_mode':_0x177922(0x2a2),'reply_markup':{'inline_keyboard':[[{'text':_0x177922(0x33a),'callback_data':_0x177922(0x33a)},{'text':'no','callback_data':'no'}]]}})[_0x177922(0x21e)](_0x4c84ba=>{telegramError(_0x4c84ba);}),tgBot['on'](_0x177922(0x228),async _0x5b5346=>{const _0x4d71cd=_0x177922,_0x3f6ac5=_0x5b5346[_0x4d71cd(0x33b)],_0x5dbef6=_0x5b5346[_0x4d71cd(0x27f)];tgBot[_0x4d71cd(0x1c7)](_0x5b5346['id'])['then'](async()=>{const _0x3a0648=_0x4d71cd;_0x3f6ac5!='no'?(await tgBot[_0x3a0648(0x26a)](_0x5dbef6[_0x3a0648(0x214)]['id'],_0x3a0648(0x2e2),{'parse_mode':_0x3a0648(0x2a2)})[_0x3a0648(0x21e)](_0x27da80=>{telegramError(_0x27da80);}),unzipFile(_0x48a732,_0x79bb3a)):await tgBot[_0x3a0648(0x26a)](_0x5dbef6['chat']['id'],'Restore\x20process\x20aborted')['catch'](_0x3f433d=>{telegramError(_0x3f433d);});}),tgBot[_0x4d71cd(0x29e)](_0x4d71cd(0x228));}));}function getServerTime(){const _0x451e7b=_0x1fd4cd,_0xa96d4f=new Date();return _0xa96d4f[_0x451e7b(0x2b6)]()+'/'+(_0xa96d4f[_0x451e7b(0x1ca)]()+0x1)[_0x451e7b(0x1d6)]()[_0x451e7b(0x2be)](0x2,'0')+'/'+_0xa96d4f[_0x451e7b(0x22e)]()['toString']()[_0x451e7b(0x2be)](0x2,'0')+'\x20'+_0xa96d4f[_0x451e7b(0x25c)]()[_0x451e7b(0x1d6)]()[_0x451e7b(0x2be)](0x2,'0')+':'+_0xa96d4f['getMinutes']()['toString']()[_0x451e7b(0x2be)](0x2,'0')+':'+_0xa96d4f['getSeconds']()[_0x451e7b(0x1d6)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x19311=_0x1fd4cd,_0x3a37bc=shiftedTime();return _0x3a37bc['getFullYear']()+'/'+(_0x3a37bc[_0x19311(0x1ca)]()+0x1)[_0x19311(0x1d6)]()[_0x19311(0x2be)](0x2,'0')+'/'+_0x3a37bc[_0x19311(0x22e)]()[_0x19311(0x1d6)]()['padStart'](0x2,'0')+'\x20'+_0x3a37bc[_0x19311(0x25c)]()[_0x19311(0x1d6)]()[_0x19311(0x2be)](0x2,'0')+':'+_0x3a37bc[_0x19311(0x2d0)]()[_0x19311(0x1d6)]()[_0x19311(0x2be)](0x2,'0')+':'+_0x3a37bc[_0x19311(0x2c1)]()[_0x19311(0x1d6)]()[_0x19311(0x2be)](0x2,'0');}function shiftedTime(){const _0x15304b=_0x1fd4cd,_0x185783=new Date();let _0x30d786=_0x185783;if(settings[_0x15304b(0x2da)]&&settings[_0x15304b(0x2da)]!==0x0)_0x30d786=fns[_0x15304b(0x332)](_0x185783,{'hours':settings[_0x15304b(0x2da)]});return _0x30d786;}function startScheduler(){const _0x4f00d9=_0x1fd4cd,_0x517acd=new Date()[_0x4f00d9(0x283)](),_0x4aea63=shiftedTime()[_0x4f00d9(0x25c)]();_0x4aea63==0x4&&backupConfigFiles();_0x4aea63==0x0&&rotateLogFiles();_0x517acd%0x6==0x0&&triggerAnalytics();_0x517acd%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function backupConfigFiles(){const _0x5c32d4=_0x1fd4cd;fs[_0x5c32d4(0x1d4)](configpath,{'withFileTypes':!![]})[_0x5c32d4(0x2ed)](_0x203ae9=>{const _0x46aeb3=_0x5c32d4;if(!_0x203ae9[_0x46aeb3(0x305)]())fs[_0x46aeb3(0x221)](configpath+_0x203ae9[_0x46aeb3(0x260)],configbackuppath+_0x203ae9[_0x46aeb3(0x260)]);});}function rotateLogFiles(){const _0x54c80f=_0x1fd4cd,_0x498ade=fs['statSync'](logspath+'output-000.log'),_0x24e0a9=_0x498ade[_0x54c80f(0x343)]/0x400;if(_0x24e0a9>0x32){let _0x57d6b9=fs[_0x54c80f(0x1d4)](logspath,{'withFileTypes':!![]});_0x57d6b9[_0x54c80f(0x1ed)]((_0x394975,_0x46c0d7)=>_0x394975[_0x54c80f(0x260)]<_0x46c0d7[_0x54c80f(0x260)]?0x1:_0x46c0d7[_0x54c80f(0x260)]<_0x394975[_0x54c80f(0x260)]?-0x1:0x0),_0x57d6b9[_0x54c80f(0x2ed)](_0x1ccd75=>{const _0x8f85bd=_0x54c80f;if(_0x1ccd75[_0x8f85bd(0x260)]==_0x8f85bd(0x357))fs[_0x8f85bd(0x221)](logspath+_0x1ccd75[_0x8f85bd(0x260)],logspath+_0x8f85bd(0x27c));if(_0x1ccd75[_0x8f85bd(0x260)]=='output-001.log')fs[_0x8f85bd(0x221)](logspath+_0x1ccd75[_0x8f85bd(0x260)],logspath+_0x8f85bd(0x357));_0x1ccd75[_0x8f85bd(0x260)]==_0x8f85bd(0x308)&&(fs[_0x8f85bd(0x221)](logspath+_0x1ccd75[_0x8f85bd(0x260)],logspath+_0x8f85bd(0x1db)),fs[_0x8f85bd(0x346)](logspath+_0x1ccd75['name'],''));});}}async function zipFiles(_0x119c81){const _0x1cd812=_0x1fd4cd;let _0x3cc7b4;if(_0x119c81=='logs')_0x3cc7b4=logspath;if(_0x119c81=='backup')_0x3cc7b4=configpath;let _0x2d896d=fs[_0x1cd812(0x1d4)](_0x3cc7b4,{'withFileTypes':!![]});const _0x56d50f=new require(_0x1cd812(0x255))();_0x2d896d['forEach'](_0x46b2e4=>{const _0x541cfc=_0x1cd812;if(!_0x46b2e4[_0x541cfc(0x305)]()){let _0x4dd2ee=fs[_0x541cfc(0x2b2)](_0x3cc7b4+_0x46b2e4[_0x541cfc(0x260)]);const _0x57299f=/^bot-[0-9]{3}-config.json$/,_0x1ff976=_0x57299f[_0x541cfc(0x270)](_0x46b2e4[_0x541cfc(0x260)]);if(_0x1ff976){const _0x5d6d49=JSON[_0x541cfc(0x318)](_0x4dd2ee);_0x5d6d49[_0x541cfc(0x345)][0x0][_0x541cfc(0x280)]=_0x541cfc(0x2e6),_0x5d6d49[_0x541cfc(0x345)][0x0]['apiSecret']=_0x541cfc(0x2e6),_0x4dd2ee=JSON[_0x541cfc(0x236)](_0x5d6d49,null,0x2);}if(_0x46b2e4[_0x541cfc(0x260)]==_0x541cfc(0x31a)){const _0x54e827=JSON[_0x541cfc(0x318)](_0x4dd2ee);if(_0x54e827[_0x541cfc(0x261)][_0x541cfc(0x359)])_0x54e827[_0x541cfc(0x261)][_0x541cfc(0x359)]=![];if(_0x54e827[_0x541cfc(0x261)][_0x541cfc(0x25e)])_0x54e827[_0x541cfc(0x261)]['bbPassword']=_0x541cfc(0x2e6);if(_0x54e827['settings'][_0x541cfc(0x2cc)])_0x54e827['settings'][_0x541cfc(0x2cc)]=_0x541cfc(0x2e6);if(_0x54e827[_0x541cfc(0x261)]['telegramChatId'])_0x54e827[_0x541cfc(0x261)][_0x541cfc(0x254)]=null;_0x4dd2ee=JSON[_0x541cfc(0x236)](_0x54e827,null,0x2);}if(_0x46b2e4[_0x541cfc(0x260)]!='bb-secure.json')_0x56d50f[_0x541cfc(0x1d3)](_0x46b2e4[_0x541cfc(0x260)],_0x4dd2ee);}});const _0x20fd3f=_0x56d50f[_0x1cd812(0x35a)]({'base64':![],'compression':_0x1cd812(0x27a)});fs[_0x1cd812(0x346)](zippath+(_0x119c81+_0x1cd812(0x2a6)),_0x20fd3f,_0x1cd812(0x33e));}async function unzipFile(_0x41e4bc,_0xbc13e1){const _0x21512f=_0x1fd4cd;await backupConfigFiles(),fs[_0x21512f(0x1d4)](configpath,{'withFileTypes':!![]})[_0x21512f(0x2ed)](_0x236806=>{const _0x38245d=_0x21512f;if(!_0x236806[_0x38245d(0x305)]())fs[_0x38245d(0x2ec)](configpath+_0x236806[_0x38245d(0x260)]);});const _0x3e7ccf=fs['readFileSync'](_0x41e4bc+_0xbc13e1,_0x21512f(0x33e)),_0x450a97=new require(_0x21512f(0x255))(_0x3e7ccf,{'base64':![],'checkCRC32':!![]});Object[_0x21512f(0x1fc)](_0x450a97['files'])[_0x21512f(0x2ed)](_0x355c76=>{const _0x147d8e=_0x21512f,_0x5406b7=_0x450a97[_0x147d8e(0x2bf)][_0x355c76];fs[_0x147d8e(0x346)](configpath+_0x5406b7[_0x147d8e(0x260)],_0x5406b7['_data']);}),fs[_0x21512f(0x1d4)](temppath,{'withFileTypes':!![]})[_0x21512f(0x2ed)](_0x109807=>{const _0x32b198=_0x21512f;if(!_0x109807[_0x32b198(0x305)]())fs[_0x32b198(0x2ec)](temppath+_0x109807[_0x32b198(0x260)]);}),process[_0x21512f(0x326)]({'restore':!![]},_0x599b74=>{});}async function getPublicIp(){const _0x26a6b2=_0x1fd4cd;try{const _0x3eec01=await axios[_0x26a6b2(0x258)](_0x26a6b2(0x321));publicip=_0x3eec01[_0x26a6b2(0x33b)]['ip'];}catch(_0x3b2acf){}}async function triggerAnalytics(){const _0x462d5c=_0x1fd4cd;if(!publicip)await getPublicIp();const _0x225520=getBotsWithMode();let _0x4f7774=0x0;_0x225520[_0x462d5c(0x2ed)](_0x80064d=>{const _0xd42f6c=_0x462d5c;if(_0x80064d['status']===_0xd42f6c(0x34e))_0x4f7774++;}),mixpanel[_0x462d5c(0x2c9)](_0x462d5c(0x238),{'distinct_id':settings[_0x462d5c(0x354)],'ip':publicip,'version':serverversion,'numbots':_0x225520['length'],'numbotsenabled':_0x4f7774});}async function getMessages(){const _0x448ed3=_0x1fd4cd,_0xa566cf=_0x448ed3(0x355),_0x5645f9=new GraphQLClient(_0xa566cf),_0x33fea9={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x152f98=serverversion['split']('.'),_0x1beaaa=_0x152f98[0x0]+'.'+_0x152f98[0x1],_0xdcc1e4=Math[_0x448ed3(0x235)](settings[_0x448ed3(0x307)],settings[_0x448ed3(0x1df)]),_0x6ed0c1={'last':parseInt(_0xdcc1e4),'bbm':_0x1beaaa},_0x561d1a=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x2f2eb7;try{_0x2f2eb7=await _0x5645f9[_0x448ed3(0x1f5)](_0x561d1a,_0x6ed0c1,_0x33fea9);}catch(_0x151c67){}if(_0x2f2eb7&&_0x2f2eb7[_0x448ed3(0x31f)]){let _0x2e7a7e=settings['lastmsgtelegram'];newMessages=[];for(const _0x1dc6a8 of _0x2f2eb7[_0x448ed3(0x31f)]){newMessages[_0x448ed3(0x229)](_0x1dc6a8);if(_0x1dc6a8['bbvNew'])updateSetting('latestversion',_0x1dc6a8['bbvNew']);let _0x2d94be=_0x1dc6a8[_0x448ed3(0x2d7)]?serverversion>=_0x1dc6a8[_0x448ed3(0x2d7)]:![];if(!_0x2d94be&&_0x1dc6a8[_0x448ed3(0x30a)]>_0x2e7a7e){if(_0x1dc6a8[_0x448ed3(0x252)]===_0x448ed3(0x200)||serverversion[_0x448ed3(0x1e0)](_0x1dc6a8[_0x448ed3(0x252)])){let _0x375fb1=''+_0x1dc6a8['title']+'\x0a\x0a'+_0x1dc6a8[_0x448ed3(0x27f)];const _0x32a6bc=await sendTelegramMsg(toTelegramMarkdown(_0x375fb1),_0x448ed3(0x2af));if(_0x32a6bc)_0x2e7a7e=_0x1dc6a8[_0x448ed3(0x30a)];}}}updateAvailable=isNewerVersion(settings[_0x448ed3(0x350)],serverversion),updateSetting(_0x448ed3(0x307),_0x2e7a7e),emitMessages();}}function emitMessages(){const _0x2e98f1=_0x1fd4cd,_0x18789e=settings[_0x2e98f1(0x1df)];let _0x5d671b=[];newMessages[_0x2e98f1(0x2ed)](_0x48f240=>{const _0x3a57e3=_0x2e98f1;_0x48f240[_0x3a57e3(0x30a)]>_0x18789e&&_0x5d671b[_0x3a57e3(0x229)](_0x48f240);}),_0x5d671b['length']>0x0&&getAllClients()[_0x2e98f1(0x2ed)](_0x3b390c=>{const _0x2b1d56=_0x2e98f1;getSocket(_0x3b390c['id'])[_0x2b1d56(0x265)]('message',_0x5d671b);});}function confirmMessage(_0x2a61fb){const _0x33c447=_0x1fd4cd;updateSetting(_0x33c447(0x1df),Number(_0x2a61fb));}function isNewerVersion(_0xf6993f,_0x35f09f){const _0x4fe87a=_0x1fd4cd,_0x3d79cf=_0x35f09f[_0x4fe87a(0x1ce)]('.'),_0x28fd43=_0xf6993f[_0x4fe87a(0x1ce)]('.');for(var _0x116544=0x0;_0x116544<_0x28fd43[_0x4fe87a(0x2e9)];_0x116544++){const _0x275be2=~~_0x28fd43[_0x116544],_0x5c5137=~~_0x3d79cf[_0x116544];if(_0x275be2>_0x5c5137)return!![];if(_0x275be2<_0x5c5137)return![];}return![];}function toTelegramMarkdown(_0x37065d){const _0x6d4e6b=_0x1fd4cd,_0x15761c=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x56371f=/\*{2}(.+?)\*{2}/gim;return _0x37065d=_0x37065d['replace'](_0x15761c,_0x6d4e6b(0x1d9))['replace'](_0x56371f,'*$1*'),_0x37065d;}async function validateConfigFile(){const _0x2aaca5=_0x1fd4cd,_0x1f04fe=dbConfig['get'](_0x2aaca5(0x267))[_0x2aaca5(0x31e)](_0x2aaca5(0x1cb))[_0x2aaca5(0x299)]()||[];if(_0x1f04fe[_0x2aaca5(0x2e9)]==0x0){let _0x542a7a=0x0,_0x34fd5b=[];const _0x5a29bd=/^bot-([0-9]{3})-config.json$/,_0x541024=fs[_0x2aaca5(0x1d4)](configpath);_0x541024[_0x2aaca5(0x2ed)](_0x3c0e08=>{const _0x3da984=_0x2aaca5,_0x4221ae=_0x5a29bd[_0x3da984(0x2c5)](_0x3c0e08);if(_0x4221ae){const _0x2d8674=_0x4221ae[0x1];let _0x245c14=getBotAttributes(_0x2d8674);_0x34fd5b[_0x3da984(0x229)]({'botID':_0x2d8674,'botname':_0x245c14['botname'],'status':_0x3da984(0x2f6),'live':_0x3da984(0x2a9)}),_0x542a7a++;}}),_0x542a7a!=0x0&&(dbConfig[_0x2aaca5(0x258)](_0x2aaca5(0x267))[_0x2aaca5(0x2ca)](_0x34fd5b)['write'](),config=_0x34fd5b,restoredConfigFile=_0x542a7a);}}async function restoreConfigNotify(_0x5637d0){const _0x584adb=_0x1fd4cd;let _0x418d1f;if(restoredConfigFile==0x1)_0x418d1f=_0x584adb(0x356);else _0x418d1f=_0x584adb(0x23d);if(_0x5637d0)io['to'](_0x584adb(0x241))[_0x584adb(0x265)](_0x584adb(0x2b5),_0x418d1f);else{logger['simple']('-----------------------------------------------------------------------------------'),logger['simple'](_0x418d1f),logger['simple'](_0x584adb(0x30f)),logger[_0x584adb(0x1f0)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x584adb(0x26e)]!=_0x584adb(0x2ce))tgBot[_0x584adb(0x26a)](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x418d1f)[_0x584adb(0x21e)](_0x4436d=>{telegramError(_0x4436d);});}}function validateCredentials(_0x4f7bd7,_0x19b1ec){const _0x1bb212=_0x1fd4cd;if(_0x4f7bd7[_0x1bb212(0x291)]==settings['bbUsername']&&bcrypt[_0x1bb212(0x327)](_0x4f7bd7[_0x1bb212(0x314)],settings[_0x1bb212(0x25e)])){if(settings[_0x1bb212(0x204)])return{'allow':![],'reason':_0x1bb212(0x351),'token':null};else{const _0xf93093=generateLoginToken(_0x19b1ec);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0xf93093};}}else return{'allow':![],'reason':_0x1bb212(0x2e5),'token':null};}function refreshToken(_0x105a3d){const _0x439f3f=_0x1fd4cd,_0x1db49a=generateLoginToken(_0x105a3d);return{'allow':!![],'reason':_0x439f3f(0x243),'token':_0x1db49a};}function validateAccess(_0x3e510d,_0x8b2f02,_0x160a45){const _0x4ddc2c=_0x1fd4cd,_0x12f9c0=_0x160a45?_0x160a45:devices[_0x8b2f02]['ip'];let _0x6d969f;const _0x8903f9=_0x470962=>{const _0x16dba3=_0x45f6;if(settings['loginRequired']){if(settings[_0x16dba3(0x204)]){if(telegram2FaApproved(_0x8b2f02)){const _0x1f4d2a=generateLoginToken(_0x8b2f02);return{'allow':!![],'reason':_0x16dba3(0x28e),'token':_0x1f4d2a};}else return{'allow':![],'reason':_0x16dba3(0x2ea),'token':null};}else return _0x6d969f=validToken(_0x470962,_0x8b2f02),_0x6d969f[_0x16dba3(0x313)](_0x16dba3(0x284))?{'allow':!![],'reason':_0x16dba3(0x32c),'token':_0x470962}:{'allow':![],'reason':_0x16dba3(0x2ea),'token':null};}else return{'allow':!![],'reason':_0x16dba3(0x2dc),'token':null};};if(settings[_0x4ddc2c(0x25d)]){let _0x37f059=[...settings['whitelist'],_0x4ddc2c(0x1fd),'::ffff:127.0.0.1','127.0.0.1'];if(_0x37f059['includes'](_0x12f9c0))return _0x8903f9(_0x3e510d);else{_0x6d969f=validToken(_0x3e510d,_0x8b2f02);if(_0x6d969f['hasOwnProperty'](_0x4ddc2c(0x284)))return _0x8903f9(_0x3e510d);else{if(telegramIpApproved(_0x8b2f02)){const _0x4cd84f=generateToken(_0x8b2f02);return _0x6d969f=_0x8903f9(_0x3e510d),_0x6d969f[_0x4ddc2c(0x30d)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x4cd84f}:_0x6d969f;}else return settings[_0x4ddc2c(0x2a7)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x4ddc2c(0x298),'token':null};}}}else return _0x8903f9(_0x3e510d);}function timelyDecrypt(_0xd0b21e,_0x117fcf=!![]){const _0x4001e8=_0x1fd4cd;if(_0xd0b21e)try{const _0x5bf8ac=crypt[_0x4001e8(0x259)](secure[_0x4001e8(0x1e6)],_0xd0b21e)[_0x4001e8(0x27f)],_0x19b5af=_0x5bf8ac[_0x4001e8(0x1ce)]('@')[0x0],_0x5c7e2b=_0x5bf8ac['split']('@')[0x1],_0x4fdab9=new Date()[_0x4001e8(0x1d8)]();if(_0x117fcf){if(_0x4fdab9-_0x5c7e2b<maxSecretAge*0x3e8)return _0x19b5af;else return![];}else return _0x19b5af;}catch(_0x51da24){return![];}else return![];}const validToken=(_0x4feda3,_0x23dbc6)=>{const _0x18e151=_0x1fd4cd,_0x250509=devices[_0x23dbc6]['ip'];if(!_0x4feda3)return{'error':'No\x20authentication\x20token'};for(let _0x452fe6 of blacklist){if(_0x452fe6[_0x18e151(0x23c)]==_0x4feda3)return{'error':'Token\x20blacklisted'};}let _0x3dc35f;try{_0x3dc35f=jwt['verify'](_0x4feda3,secure['secret']+_0x23dbc6);}catch{return{'error':_0x18e151(0x2d6)};}if(!_0x3dc35f[_0x18e151(0x313)](_0x18e151(0x2c2))&&!_0x3dc35f['hasOwnProperty']('username')||!_0x3dc35f[_0x18e151(0x313)]('exp'))return{'error':_0x18e151(0x335)};if(!_0x3dc35f['hasOwnProperty']('username')&&_0x3dc35f['hasOwnProperty'](_0x18e151(0x2c2))){const {clientip:_0x844f35}=_0x3dc35f;return _0x250509==_0x844f35?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x18e151(0x23a)};}else{if(_0x3dc35f[_0x18e151(0x313)](_0x18e151(0x291))&&_0x3dc35f[_0x18e151(0x313)](_0x18e151(0x2c2))){const {username:_0x5e705a,clientip:_0x20a385}=_0x3dc35f;return settings[_0x18e151(0x2c4)]==_0x5e705a&&_0x250509==_0x20a385?{'success':_0x18e151(0x2e7)}:{'error':_0x18e151(0x353)};}}},generateLoginToken=_0x4daa55=>{const _0x2fc5c0=_0x1fd4cd;if(_0x4daa55){const _0x6e959c=devices[_0x4daa55]['ip'];return jwt[_0x2fc5c0(0x311)]({'username':settings[_0x2fc5c0(0x2c4)],'clientip':_0x6e959c},secure[_0x2fc5c0(0x210)]+_0x4daa55,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x4753c4=>{const _0x4e8382=_0x1fd4cd;if(_0x4753c4){const _0x49f4ee=devices[_0x4753c4]['ip'];return jwt[_0x4e8382(0x311)]({'clientip':_0x49f4ee},secure[_0x4e8382(0x210)]+_0x4753c4,{'expiresIn':devices[_0x4753c4][_0x4e8382(0x2a5)][_0x4e8382(0x2a0)]*0x3c});}else return![];},telegramIpApproved=_0x54a659=>{const _0x2ab5e8=_0x1fd4cd;let _0x3d92d3=![];return devices[_0x54a659][_0x2ab5e8(0x2a5)]&&devices[_0x54a659]['telegramIpApproval'][_0x2ab5e8(0x2a0)]!='reject'&&(_0x3d92d3=devices[_0x54a659]['telegramIpApproval'][_0x2ab5e8(0x2c2)]==devices[_0x54a659]['ip']&&new Date()[_0x2ab5e8(0x1d8)]()-devices[_0x54a659][_0x2ab5e8(0x2a5)][_0x2ab5e8(0x27b)]<devices[_0x54a659][_0x2ab5e8(0x2a5)][_0x2ab5e8(0x2a0)]*0x3c*0x3e8),_0x3d92d3;},telegram2FaApproved=_0x5c4c2e=>{const _0x1dbff5=_0x1fd4cd;let _0x50d632=![];return devices[_0x5c4c2e]['telegram2FaApproval']&&devices[_0x5c4c2e]['telegram2FaApproval'][_0x1dbff5(0x2a0)]!=_0x1dbff5(0x274)&&(_0x50d632=devices[_0x5c4c2e]['telegram2FaApproval'][_0x1dbff5(0x2c2)]==devices[_0x5c4c2e]['ip']&&new Date()[_0x1dbff5(0x1d8)]()-devices[_0x5c4c2e][_0x1dbff5(0x290)][_0x1dbff5(0x27b)]<devices[_0x5c4c2e]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x50d632;},normalizeIP=_0x1cec8f=>{const _0x1d8ae7=_0x1fd4cd;let _0x52be9e=null,_0x4b0e3c=null;if(ipaddr[_0x1d8ae7(0x2e8)](_0x1cec8f)){const _0x4b0691=ipaddr[_0x1d8ae7(0x318)](_0x1cec8f);_0x4b0691['kind']()===_0x1d8ae7(0x317)?(_0x4b0691['isIPv4MappedAddress']()&&(_0x52be9e=_0x4b0691[_0x1d8ae7(0x233)]()['toString']()),_0x4b0e3c=_0x4b0691['toString']()):(_0x52be9e=_0x4b0691[_0x1d8ae7(0x1d6)](),_0x4b0e3c=_0x4b0691[_0x1d8ae7(0x2f4)]()['toString']());}return{'show':_0x52be9e?_0x52be9e:_0x4b0e3c,'store':_0x4b0e3c};};function sleep(_0x3d39ff){return new Promise(_0x4dc1a9=>setTimeout(_0x4dc1a9,_0x3d39ff));}