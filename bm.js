const _0x1c7409=_0x356b;(function(_0x2eb68b,_0x4f4b0d){const _0x146659=_0x356b,_0x54b933=_0x2eb68b();while(!![]){try{const _0x4543a0=parseInt(_0x146659(0x153))/0x1+-parseInt(_0x146659(0x1aa))/0x2+-parseInt(_0x146659(0x20e))/0x3*(-parseInt(_0x146659(0x183))/0x4)+-parseInt(_0x146659(0x2b8))/0x5+-parseInt(_0x146659(0xfd))/0x6*(parseInt(_0x146659(0x1cf))/0x7)+-parseInt(_0x146659(0x13a))/0x8*(parseInt(_0x146659(0x22e))/0x9)+-parseInt(_0x146659(0x28f))/0xa*(-parseInt(_0x146659(0x264))/0xb);if(_0x4543a0===_0x4f4b0d)break;else _0x54b933['push'](_0x54b933['shift']());}catch(_0x20fcd5){_0x54b933['push'](_0x54b933['shift']());}}}(_0x126c,0x6d123));const _0x1fb3a0=function(){let _0x43c616=!![];return function(_0x3c449e,_0x1a6f12){const _0x517c3c=_0x43c616?function(){const _0x15ec67=_0x356b;if(_0x1a6f12){const _0x1d37b3=_0x1a6f12[_0x15ec67(0x155)](_0x3c449e,arguments);return _0x1a6f12=null,_0x1d37b3;}}:function(){};return _0x43c616=![],_0x517c3c;};}(),_0x15a4af=_0x1fb3a0(this,function(){const _0x5efac5=_0x356b;return _0x15a4af[_0x5efac5(0x209)]()[_0x5efac5(0x245)](_0x5efac5(0x1b5))[_0x5efac5(0x209)]()[_0x5efac5(0x26e)](_0x15a4af)[_0x5efac5(0x245)](_0x5efac5(0x1b5));});_0x15a4af();'use strict';process[_0x1c7409(0x207)][_0x1c7409(0x121)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require('date-fns'),low=require(_0x1c7409(0x20c)),FileSync=require(_0x1c7409(0x146)),path=require(_0x1c7409(0x2df)),crypto=require('crypto'),Crypt=require('hybrid-crypto-js')[_0x1c7409(0x15e)],RSA=require(_0x1c7409(0x2d2))[_0x1c7409(0x113)],bcrypt=require(_0x1c7409(0x255)),jwt=require(_0x1c7409(0x11a)),ipaddr=require(_0x1c7409(0x231)),argv=require(_0x1c7409(0x2d1))(process[_0x1c7409(0x1f2)]['slice'](0x2))[_0x1c7409(0x1f2)],uuidRandom=require(_0x1c7409(0x1ac)),TelegramBot=require(_0x1c7409(0x289)),Mixpanel=require(_0x1c7409(0x169)),axios=require('axios'),{GraphQLClient,gql}=require(_0x1c7409(0x2bd)),util=require('util'),fileUpload=require(_0x1c7409(0x28a)),{networkInterfaces}=require('os'),PORT=argv[_0x1c7409(0x1a6)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x1c7409(0x1d5)](PORT)&&(console['log'](_0x1c7409(0x120)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x1c7409(0x265)](0x1));const HOST=argv[_0x1c7409(0x21e)]||null,userID=argv[_0x1c7409(0x1d1)]||'',debugging=argv['d']||![],nodeversion=process[_0x1c7409(0x117)][_0x1c7409(0x191)];let bbpath=_0x1c7409(0x132),bbpath2='';const botfile=_0x1c7409(0x236),configfile='bb-config.json',settingsfile=_0x1c7409(0x164),securefile='bb-secure.json',maxBackups=0xa;let validInstallation=!![];!fs[_0x1c7409(0x241)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x1c7409(0x18f)+userID+'/':bbpath+_0x1c7409(0x18f),configbackuppath=configpath+_0x1c7409(0x1be),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x1c7409(0x204),zippath=userID?bbpath+_0x1c7409(0x29b)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x1c7409(0x281)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x1c7409(0x10b);!fs[_0x1c7409(0x241)](configpath)&&fs[_0x1c7409(0x28d)](configpath);!fs[_0x1c7409(0x241)](configbackuppath)&&fs[_0x1c7409(0x28d)](configbackuppath);!fs['existsSync'](logspath)&&fs['mkdirSync'](logspath);!fs[_0x1c7409(0x241)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x1c7409(0x241)](temppath)&&fs[_0x1c7409(0x28d)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x1c7409(0x1dc)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x1c7409(0x1dc)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x1c7409(0x292),'onepagemode':![]}})[_0x1c7409(0x2bf)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x1c7409(0x1dc)]({'secure':{},'blacklist':[]})[_0x1c7409(0x2bf)]();let crypt=new Crypt({'md':_0x1c7409(0x1f8),'rsaStandard':_0x1c7409(0x1f0)});const saltRounds=0xa,mixpanel=Mixpanel[_0x1c7409(0x2dd)](_0x1c7409(0x1ca),{'host':_0x1c7409(0x257)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x1c7409(0x126)]&&settings['telegramToken']!=''&&settings[_0x1c7409(0x20f)]&&settings[_0x1c7409(0x20f)]!='')initTelegram();const parseColor=(_0x57faac,_0x26c51a)=>{const _0x976c8d=_0x1c7409,_0x10b26e=/#[A-Z]{3}#/g;if(typeof _0x57faac==_0x976c8d(0x170)){!_0x26c51a?_0x57faac=_0x57faac[_0x976c8d(0x21b)](_0x10b26e,''):(_0x57faac=_0x57faac[_0x976c8d(0x21b)](/#BLU#/g,_0x976c8d(0x2b3)),_0x57faac=_0x57faac['replace'](/#RED#/g,_0x976c8d(0x25d)),_0x57faac=_0x57faac[_0x976c8d(0x21b)](/#YEL#/g,'\x1b[33m'),_0x57faac=_0x57faac[_0x976c8d(0x21b)](/#MAG#/g,_0x976c8d(0x1c3)),_0x57faac=_0x57faac['replace'](/#CYA#/g,_0x976c8d(0x2c3)),_0x57faac=_0x57faac[_0x976c8d(0x21b)](/#RES#/g,_0x976c8d(0x286)));;}return _0x57faac;},logger={'screen':_0x576610=>{const _0x589766=_0x1c7409;console[_0x589766(0x178)](parseColor(_0x576610,!![]));},'simple':_0x4661cf=>{const _0x43ff11=_0x1c7409;console[_0x43ff11(0x178)](parseColor(_0x4661cf,!![])),loggerfile[_0x43ff11(0x2bf)](util[_0x43ff11(0x133)](parseColor(_0x4661cf,![]))+'\x0a');},'full':async _0x1f9d84=>{const _0x202366=_0x1c7409,_0x56e025=getTimeStamp()+_0x202366(0x294)+_0x1f9d84;console[_0x202366(0x178)](parseColor(_0x56e025,!![])),loggerfile[_0x202366(0x2bf)](util[_0x202366(0x133)](parseColor(_0x56e025,![]))+'\x0a');if(tgBot&&settings[_0x202366(0x210)]&&settings[_0x202366(0x173)]!='orders')await tgBot['sendMessage'](settings[_0x202366(0x210)],_0x202366(0x227)+parseColor(_0x1f9d84,![]))[_0x202366(0x12f)](_0x4308f6=>{telegramError(_0x4308f6);});},'debug':async(_0x4df109,_0x1cf9a1='')=>{const _0x2d200c=_0x1c7409,_0x3c8b3b=getTimeStamp()+_0x2d200c(0x19b)+_0x4df109;if(debugging)console[_0x2d200c(0x178)](parseColor(_0x3c8b3b,!![]));loggerfile['write'](util[_0x2d200c(0x133)](parseColor(_0x3c8b3b,![]))+'\x0a');if(_0x1cf9a1){if(debugging)console['log'](_0x1cf9a1);loggerfile[_0x2d200c(0x2bf)](util['format'](_0x1cf9a1)+'\x0a');}}};process['on'](_0x1c7409(0x2a6),function(_0x185e27){logger['simple'](_0x185e27);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x1c7409(0x15d))[_0x1c7409(0x21c)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x1c7409(0x193)),app=express(),http=require(_0x1c7409(0x16c))['createServer'](app);app[_0x1c7409(0x248)](fileUpload({'useTempFiles':!![]})),app[_0x1c7409(0x190)]('/download/:type',async(_0x45223d,_0x333af5)=>{const _0x5b7db2=_0x1c7409,_0x2c3433=_0x45223d[_0x5b7db2(0x218)]['type'],_0x51f769=getClientsWithBotID(_0x5b7db2(0x205)),_0x15c17e=_0x45223d['headers'][_0x5b7db2(0x229)],_0x2c3102=timelyDecrypt(_0x15c17e,![]),_0x3937d5=_0x51f769['find'](_0x4dc5a2=>_0x4dc5a2[_0x5b7db2(0x229)]==_0x2c3102);if(_0x3937d5){const _0x484711=normalizeIP(_0x45223d['socket']['remoteAddress'])[_0x5b7db2(0x150)],_0x6837b3=_0x45223d[_0x5b7db2(0x1d9)]['tkn'];if(validateAccess(_0x6837b3,_0x2c3102,_0x484711)[_0x5b7db2(0x277)])_0x2c3433==_0x5b7db2(0x115)&&await backupConfigFiles(),await zipFiles(_0x2c3433),_0x333af5[_0x5b7db2(0x1d2)](zippath+(_0x2c3433+_0x5b7db2(0x214)),_0x5cc380=>{const _0xff4708=_0x5b7db2;_0x5cc380&&(logger[_0xff4708(0x1c1)](_0xff4708(0x142)+_0x2c3433),logger[_0xff4708(0x2a3)](_0x5cc380));});else logger[_0x5b7db2(0x1c1)](_0x5b7db2(0x1fb)+_0x2c3433+_0x5b7db2(0x233));}else logger['full'](_0x5b7db2(0x1fb)+_0x2c3433+_0x5b7db2(0x119));}),app['post'](_0x1c7409(0x1a7),async(_0x313e39,_0x2ab56d)=>{const _0x58a6b4=_0x1c7409,_0xe9af13=getClientsWithBotID(_0x58a6b4(0x205)),_0x29268a=_0x313e39[_0x58a6b4(0x1d9)][_0x58a6b4(0x229)],_0xcb4b69=timelyDecrypt(_0x29268a,![]),_0x4dad1f=_0xe9af13[_0x58a6b4(0x13f)](_0x102ac0=>_0x102ac0[_0x58a6b4(0x229)]==_0xcb4b69);logger[_0x58a6b4(0x143)]('Backup\x20file\x20uploaded');if(_0x4dad1f){const _0x2c23d7=normalizeIP(_0x313e39[_0x58a6b4(0x1d8)]['remoteAddress'])[_0x58a6b4(0x150)],_0x2368db=_0x313e39[_0x58a6b4(0x1d9)]['tkn'];if(validateAccess(_0x2368db,_0xcb4b69,_0x2c23d7)['allow']){if(_0x313e39[_0x58a6b4(0x1b9)]){const _0x4790b6=_0x313e39['files'][_0x58a6b4(0x284)];await _0x4790b6['mv'](temppath+_0x4790b6[_0x58a6b4(0x172)]),_0x2ab56d['send']({'status':!![],'message':_0x58a6b4(0x2a5)});const _0x3151be=getBotsWithMode();_0x3151be['length']>0x0?confirmRestore(temppath,_0x4790b6[_0x58a6b4(0x172)]):unzipFile(temppath,_0x4790b6[_0x58a6b4(0x172)]);}}else logger[_0x58a6b4(0x1c1)](_0x58a6b4(0x16d));}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app['use'](express['static'](path[_0x1c7409(0x122)](__dirname,bbpath2,_0x1c7409(0x26a)))),app['use'](express[_0x1c7409(0x1a1)](path[_0x1c7409(0x122)](__dirname,bbpath2,_0x1c7409(0x192)))),app[_0x1c7409(0x190)]('/',function(_0x364091,_0x28c86b){const _0x4759ad=_0x1c7409;_0x28c86b['sendFile'](path[_0x4759ad(0x122)](__dirname,bbpath2,'build2',_0x4759ad(0x201)));}),app[_0x1c7409(0x190)](_0x1c7409(0x1ec),function(_0x5907b8,_0x4ef4d5){const _0x48619f=_0x1c7409;_0x4ef4d5[_0x48619f(0x2c1)](path[_0x48619f(0x122)](__dirname,bbpath2,_0x48619f(0x192),_0x48619f(0x201)));}),app[_0x1c7409(0x190)]('/:bot/portfolio',(_0x56e43d,_0x27398b)=>{const _0x1215b7=_0x1c7409;_0x27398b['sendFile'](path[_0x1215b7(0x122)](__dirname,bbpath2,_0x1215b7(0x192),_0x1215b7(0x201)));}),app['get'](_0x1c7409(0x263),(_0x5c86e0,_0x1ae3b3)=>{const _0x19c82e=_0x1c7409;_0x1ae3b3[_0x19c82e(0x2c1)](path['join'](__dirname,bbpath2,_0x19c82e(0x192),_0x19c82e(0x201)));}),app[_0x1c7409(0x190)](_0x1c7409(0x17c),(_0x3fefb6,_0x5c1cc2)=>{const _0x11156e=_0x1c7409;_0x5c1cc2[_0x11156e(0x2c1)](path[_0x11156e(0x122)](__dirname,bbpath2,'build',_0x11156e(0x201)));}),app[_0x1c7409(0x190)](_0x1c7409(0x175),(_0x54bfba,_0x592763)=>{const _0x26beae=_0x1c7409;_0x592763['sendFile'](path[_0x26beae(0x122)](__dirname,bbpath2,'build',_0x26beae(0x201)));}),app[_0x1c7409(0x190)](_0x1c7409(0x106),(_0x4454c5,_0xc72842)=>{const _0x5944b2=_0x1c7409;_0xc72842[_0x5944b2(0x2c1)](path[_0x5944b2(0x122)](__dirname,bbpath2,_0x5944b2(0x192),_0x5944b2(0x201)));}),app['get']('/:bot/support',(_0x1d78a1,_0x43a869)=>{const _0x48cf47=_0x1c7409;_0x43a869[_0x48cf47(0x2c1)](path[_0x48cf47(0x122)](__dirname,bbpath2,'build','index.html'));});if(HOST)http[_0x1c7409(0x244)](PORT,HOST);else http[_0x1c7409(0x244)](PORT);const io=require(_0x1c7409(0x1cd))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x288731=_0x1c7409;let _0x213e82=_0x288731(0x11c);const _0x17d69c=networkInterfaces(),_0x838999={};for(const _0x40b4df of Object[_0x288731(0x240)](_0x17d69c)){for(const _0x1a56f5 of _0x17d69c[_0x40b4df]){if((_0x1a56f5['family']==_0x288731(0x14b)||_0x1a56f5['family']==0x4)&&!_0x1a56f5[_0x288731(0x1c4)]){const _0x1fff12=ipaddr[_0x288731(0x15c)](_0x1a56f5[_0x288731(0x1fa)])[_0x288731(0x1e3)]();_0x1fff12!=_0x288731(0x2ce)&&(!_0x838999[_0x40b4df]&&(_0x838999[_0x40b4df]=[]),_0x838999[_0x40b4df]['push'](_0x1a56f5['address']),_0x213e82=_0x1a56f5['address']);}}}return{'serverip':_0x213e82,'netinterfaces':_0x838999};}async function startServer(){const _0x267961=_0x1c7409,{serverip:_0x3f8895,netinterfaces:_0x4eb73c}=getServerIP();logger['simple'](''),logger[_0x267961(0x2a3)](_0x267961(0x2b0)),await logger[_0x267961(0x1c1)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x0a'+(_0x267961(0x2d9)+PORT+_0x267961(0x17a))+(_0x267961(0x297)+_0x3f8895+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x267961(0x2a3)]('-----------------------------------------------------------------------------------');if(config[_0x267961(0x1ed)]!=0x0)for(const _0x139804 of config){if(_0x139804['status']==_0x267961(0x247)||_0x139804['status']==_0x267961(0x138))await logger['full']('Starting\x20bot\x20|\x20Bot\x20'+_0x139804[_0x267961(0x1e1)]+_0x267961(0x1bb)+_0x139804[_0x267961(0x295)]),startBot([_0x139804['botID'],userID],{'cwd':bbpath},function(_0x36c127){const _0xa19ab9=_0x267961;if(_0x36c127)logger[_0xa19ab9(0x1c1)](_0x36c127);});else(_0x139804['status']==_0x267961(0x22c)||_0x139804['status']=='new-disabled')&&await logger[_0x267961(0x1c1)](_0x267961(0x1ee)+_0x139804[_0x267961(0x1e1)]+_0x267961(0x1bb)+_0x139804[_0x267961(0x295)]);}else!newBot&&logger['simple']('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x267961(0x2a3)](_0x267961(0x2b0)),logger['simple'](''),await logger['debug']('Node.js\x20v'+nodeversion),await logger[_0x267961(0x143)](_0x267961(0x145),_0x4eb73c);}function startSocket(){const _0xf5d114=_0x1c7409;io['on'](_0xf5d114(0x223),_0x1f20e2=>{const _0x311c35=_0xf5d114;let _0x44b70e,_0x1f4b85,_0x18c9d1,_0xda3f83,_0x3e367a;const _0x29190a=_0x1f20e2[_0x311c35(0x22d)][_0x311c35(0x1d9)]['referer'];_0x1f4b85=_0x29190a['match'](/bot[0-9]{3}/);if(_0x1f4b85)_0x18c9d1=_0x1f4b85[0x0][_0x311c35(0x1f1)](/[0-9]{3}/);if(_0x18c9d1)_0x44b70e=_0x18c9d1[0x0];else _0x44b70e=_0x311c35(0x205);const _0x282e0e=_0x1f20e2['handshake']['auth'][_0x311c35(0x213)];if(!_0x282e0e)_0x1f20e2[_0x311c35(0x24f)](_0x311c35(0x1a4),{'publicKey':secure['publicKey']});else{_0xda3f83=timelyDecrypt(_0x282e0e,![]);if(!_0xda3f83)_0x1f20e2[_0x311c35(0x24f)]('status',{'publicKey':secure['publicKey']});else{_0x3e367a=normalizeIP(_0x1f20e2['conn'][_0x311c35(0x167)])[_0x311c35(0x150)];if(!devices[_0xda3f83])devices[_0xda3f83]={'uuid':_0xda3f83,'access':{'token':null}};devices[_0xda3f83]['ip']=_0x3e367a;const _0x1a645c=addClient(_0x1f20e2['id'],_0xda3f83,_0x44b70e);setAccess(_0x1a645c),emitMessages(),_0x1f20e2['on'](_0x311c35(0x1b1),_0xc5ea6=>{const _0x5be98d=_0x311c35,_0x3ed816=timelyDecrypt(_0xc5ea6[_0x5be98d(0x1d4)]);if(_0x3ed816){_0xc5ea6={'username':_0xc5ea6[_0x5be98d(0x283)],'password':_0x3ed816},devices[_0xda3f83][_0x5be98d(0x2bc)]=validateCredentials(_0xc5ea6,_0xda3f83);if(devices[_0xda3f83][_0x5be98d(0x2bc)][_0x5be98d(0x277)]==![]&&devices[_0xda3f83][_0x5be98d(0x2bc)]['reason']==_0x5be98d(0x28c))_0x1f20e2[_0x5be98d(0x24f)](_0x5be98d(0x1a4),{'access':devices[_0xda3f83][_0x5be98d(0x2bc)]}),loginAccess2FA(_0xda3f83,_0x3e367a);else{if(devices[_0xda3f83][_0x5be98d(0x2bc)][_0x5be98d(0x277)]==![]&&devices[_0xda3f83][_0x5be98d(0x2bc)][_0x5be98d(0x15f)]==_0x5be98d(0x299))_0x1f20e2['emit'](_0x5be98d(0x1a4),{'access':devices[_0xda3f83][_0x5be98d(0x2bc)]});else devices[_0xda3f83][_0x5be98d(0x2bc)][_0x5be98d(0x277)]&&devices[_0xda3f83][_0x5be98d(0x2bc)]['reason']=='login\x20token\x20generated'&&(getClientsWithUuid(_0xda3f83)[_0x5be98d(0x276)](_0x2c8219=>{setAccess(_0x2c8219);}),logger[_0x5be98d(0x143)](_0x5be98d(0x1bd)+_0xda3f83[_0x5be98d(0x141)](-0x8)),setTokenRefresh(_0xda3f83),setSessionTimeout(_0x5be98d(0x1b1),_0xda3f83));}}else logger['full'](_0x5be98d(0x19c));}),_0x1f20e2['on'](_0x311c35(0x2b5),()=>{resetPassword();}),_0x1f20e2['on'](_0x311c35(0x118),_0x19e5c2=>{removeClient(_0x1f20e2['id']);}),_0x44b70e==_0x311c35(0x205)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x1c47e6){const _0x30a5f5=_0x1c7409;if(_0x1c47e6!='botmanager'&&config[_0x30a5f5(0x19a)]!=''){if(pid[_0x1c47e6])pid[_0x1c47e6]['send']({'function':'initclient','args':null});}_0x1c47e6!=_0x30a5f5(0x205)&&broadcastToBots(_0x30a5f5(0x177),JSON[_0x30a5f5(0x168)](config));}function reloadBotManager(){const _0x8c0eb=_0x1c7409;getClientsWithBotID(_0x8c0eb(0x205))[_0x8c0eb(0x276)](_0x6477ca=>{const _0x209cae=_0x8c0eb;getSocket(_0x6477ca['id'])[_0x209cae(0x24f)](_0x209cae(0x1a4),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x260755){const _0x567623=_0x1c7409;return io[_0x567623(0x23d)][_0x567623(0x23d)]['get'](_0x260755);}function setAccess(_0x2a22ef){const _0x4fb149=_0x1c7409,_0x32fd1b=getSocket(_0x2a22ef['id']),_0xff1074=_0x2a22ef['uuid'],_0x5dc31b=_0x2a22ef[_0x4fb149(0x148)];devices[_0xff1074][_0x4fb149(0x2bc)]=validateAccess(devices[_0xff1074][_0x4fb149(0x2bc)]['token'],_0xff1074),logger[_0x4fb149(0x143)](_0x4fb149(0x105)+devices[_0xff1074][_0x4fb149(0x2bc)]['reason']+'\x20|\x20client:\x20...'+_0x2a22ef['id'][_0x4fb149(0x141)](-0x8)+_0x4fb149(0x2c4)+_0xff1074[_0x4fb149(0x141)](-0x8)),_0x32fd1b['join'](_0xff1074);if(devices[_0xff1074][_0x4fb149(0x2bc)][_0x4fb149(0x277)]){_0x32fd1b['join'](_0x5dc31b);if(_0x5dc31b=='botmanager')initializeSocketBotManager(_0x32fd1b);else initializeSocketBot(_0x32fd1b);initClient(_0x5dc31b);}devices[_0xff1074][_0x4fb149(0x2bc)][_0x4fb149(0x288)]&&devices[_0xff1074][_0x4fb149(0x2bc)]['reason']==_0x4fb149(0x123)&&setSessionTimeout(_0x4fb149(0x226),_0xff1074),devices[_0xff1074][_0x4fb149(0x2bc)]['token']&&devices[_0xff1074][_0x4fb149(0x2bc)][_0x4fb149(0x15f)]==_0x4fb149(0x211)&&setSessionTimeout(_0x4fb149(0x1b1),_0xff1074),_0x32fd1b[_0x4fb149(0x24f)](_0x4fb149(0x1a4),{'status':_0x2a22ef[_0x4fb149(0x1b3)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0xff1074]['access'],'externalip':devices[_0xff1074]['ip'],'publicKey':secure[_0x4fb149(0x1ef)],'userid':settings[_0x4fb149(0x14a)],'validInstallation':validInstallation}),devices[_0xff1074][_0x4fb149(0x2bc)][_0x4fb149(0x277)]==![]&&devices[_0xff1074][_0x4fb149(0x2bc)][_0x4fb149(0x15f)]==_0x4fb149(0x19e)&&temporaryAccess2FA(_0xff1074,devices[_0xff1074]['ip']);}function setSessionTimeout(_0x3d6de6,_0x49fabc){const _0x228832=_0x1c7409;let _0x5a10d3;if(_0x3d6de6=='login')_0x5a10d3=loginExpiry*0x3c*0x3e8;else _0x5a10d3=devices[_0x49fabc][_0x228832(0x1f7)][_0x228832(0x160)]*0x3c*0x3e8-(new Date()[_0x228832(0x1e9)]()-devices[_0x49fabc][_0x228832(0x1f7)][_0x228832(0x17b)]);if(devices[_0x49fabc]['pidExpireLogin'])clearTimeout(devices[_0x49fabc][_0x228832(0x161)]);devices[_0x49fabc]['pidExpireLogin']=setTimeout(()=>{const _0x28658d=_0x228832;if(devices[_0x49fabc]['pidRefreshToken'])clearTimeout(devices[_0x49fabc][_0x28658d(0x27c)]);removeSocketListeners(_0x49fabc),addBlacklist(_0x49fabc),devices[_0x49fabc][_0x28658d(0x1f7)]=null,devices[_0x49fabc][_0x28658d(0x197)]=null,devices[_0x49fabc][_0x28658d(0x2bc)][_0x28658d(0x288)]=null,logger[_0x28658d(0x143)](_0x28658d(0x27f)+_0x49fabc[_0x28658d(0x141)](-0x8)),devices[_0x49fabc][_0x28658d(0x2bc)]=validateAccess(devices[_0x49fabc]['access'][_0x28658d(0x288)],_0x49fabc),!(devices[_0x49fabc][_0x28658d(0x2bc)][_0x28658d(0x277)]&&devices[_0x49fabc][_0x28658d(0x2bc)][_0x28658d(0x15f)]==_0x28658d(0x2c9))&&(_0x3d6de6=='login'?io['to'](_0x49fabc)[_0x28658d(0x24f)](_0x28658d(0x1a4),{'access':{'allow':![],'reason':_0x28658d(0x11e),'token':null}}):io['to'](_0x49fabc)[_0x28658d(0x24f)]('status',{'access':{'allow':![],'reason':_0x28658d(0x1c9),'token':null}})),devices[_0x49fabc][_0x28658d(0x2bc)]['token']=null;},_0x5a10d3);}function setTokenRefresh(_0x57dc3e){const _0x2c3a80=_0x1c7409;if(devices[_0x57dc3e][_0x2c3a80(0x27c)])clearTimeout(devices[_0x57dc3e]['pidRefreshToken']);devices[_0x57dc3e][_0x2c3a80(0x27c)]=setTimeout(()=>{const _0x575aff=_0x2c3a80;getClientsWithUuid(_0x57dc3e)['length']!=0x0?(devices[_0x57dc3e][_0x575aff(0x2bc)]=refreshToken(_0x57dc3e),io['to'](_0x57dc3e)[_0x575aff(0x24f)]('status',{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x57dc3e][_0x575aff(0x2bc)],'externalip':devices[_0x57dc3e]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x57dc3e)):clearTimeout(devices[_0x57dc3e][_0x575aff(0x27c)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2a6a8c){const _0xb447e2=_0x1c7409,_0x310773=getClient(_0x2a6a8c['id'])[_0xb447e2(0x229)];_0x2a6a8c[_0xb447e2(0x24f)](_0xb447e2(0x177),config),_0x2a6a8c[_0xb447e2(0x24f)](_0xb447e2(0x2d6),cleanSettings()),_0x2a6a8c['on'](_0xb447e2(0x234),_0x3faa50=>{const _0x464927=_0xb447e2;if(validateAccess(_0x3faa50,_0x310773)[_0x464927(0x277)])addBot();else logger[_0x464927(0x1c1)](_0x464927(0x139));}),_0x2a6a8c['on'](_0xb447e2(0x1b2),(_0x57df3d,_0x7ea16f)=>{const _0x14c969=_0xb447e2;if(validateAccess(_0x7ea16f,_0x310773)['allow'])toggleBot(_0x57df3d[_0x14c969(0x1e1)],_0x57df3d[_0x14c969(0x1a4)],_0x57df3d['live']);else logger[_0x14c969(0x1c1)](_0x14c969(0x253));}),_0x2a6a8c['on']('toggle-bot-mode',(_0x598c45,_0x798c17)=>{const _0x586e98=_0xb447e2;if(validateAccess(_0x798c17,_0x310773)[_0x586e98(0x277)])toggleBotMode(_0x598c45);else logger[_0x586e98(0x1c1)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x2a6a8c['on'](_0xb447e2(0x196),(_0x4d15be,_0x5bf0cf)=>{const _0x2c4898=_0xb447e2;if(validateAccess(_0x5bf0cf,_0x310773)[_0x2c4898(0x277)])deleteBot(_0x4d15be);else logger[_0x2c4898(0x1c1)](_0x2c4898(0x1eb));}),_0x2a6a8c['on'](_0xb447e2(0x17f),(_0xc4410f,_0x1f33f3)=>{const _0x57395f=_0xb447e2;if(validateAccess(_0x1f33f3,_0x310773)[_0x57395f(0x277)])storeSettings(_0xc4410f,!![]);else logger['full'](_0x57395f(0x1f6));}),_0x2a6a8c['on'](_0xb447e2(0x26b),_0x28083f=>{const _0x5dad05=_0xb447e2;if(validateAccess(_0x28083f,_0x310773)[_0x5dad05(0x277)])updateBB(_0x5dad05(0x208));else logger[_0x5dad05(0x1c1)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x2a6a8c['on'](_0xb447e2(0x109),_0x3969f4=>{const _0x3d7205=_0xb447e2;if(validateAccess(_0x3969f4,_0x310773)[_0x3d7205(0x277)])updateBB(_0x3d7205(0x104));else logger['full']('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x2a6a8c['on']('get-backup-files',_0x17d6a8=>{const _0x98acf7=_0xb447e2;if(validateAccess(_0x17d6a8,_0x310773)[_0x98acf7(0x277)]){const _0x306d3a=getClient(_0x2a6a8c['id']);if(_0x306d3a)getBackupFiles(_0x306d3a[_0x98acf7(0x229)]);else logger[_0x98acf7(0x1c1)](_0x98acf7(0x2b9));}else logger[_0x98acf7(0x1c1)](_0x98acf7(0x1e0));}),_0x2a6a8c['on'](_0xb447e2(0x1a5),(_0x176d5c,_0xb8e0e4)=>{const _0x4dd1ab=_0xb447e2;if(validateAccess(_0xb8e0e4,_0x310773)['allow'])restoreBackupFile(_0x176d5c);else logger[_0x4dd1ab(0x1c1)](_0x4dd1ab(0x25a));}),_0x2a6a8c['on']('get-messages',_0x3a1298=>{const _0x881fdf=_0xb447e2;if(validateAccess(_0x3a1298,_0x310773)[_0x881fdf(0x277)])getMessages();else logger[_0x881fdf(0x1c1)](_0x881fdf(0x24c));}),_0x2a6a8c['on'](_0xb447e2(0x134),(_0x241a38,_0x522d7f)=>{const _0x5db6c2=_0xb447e2;if(validateAccess(_0x522d7f,_0x310773)[_0x5db6c2(0x277)])confirmMessage(_0x241a38);else logger[_0x5db6c2(0x1c1)](_0x5db6c2(0x128));}),_0x2a6a8c['on'](_0xb447e2(0x16b),_0x4b54c=>{const _0xd974e1=_0xb447e2;if(validateAccess(_0x4b54c,_0x310773)[_0xd974e1(0x277)]){if(devices[_0x310773][_0xd974e1(0x27c)])clearTimeout(devices[_0x310773][_0xd974e1(0x27c)]);if(devices[_0x310773][_0xd974e1(0x161)])clearTimeout(devices[_0x310773][_0xd974e1(0x161)]);removeSocketListeners(getClient(_0x2a6a8c['id'])[_0xd974e1(0x229)]),addBlacklist(_0x310773),devices[_0x310773][_0xd974e1(0x1f7)]=null,devices[_0x310773]['telegram2FaApproval']=null,devices[_0x310773][_0xd974e1(0x2bc)]['token']=null,logger[_0xd974e1(0x143)](_0xd974e1(0x1b0)+_0x310773['slice'](-0x8)),io['to'](getClient(_0x2a6a8c['id'])[_0xd974e1(0x229)])[_0xd974e1(0x24f)](_0xd974e1(0x1a4),{'access':{'allow':![],'reason':_0xd974e1(0x186),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x4dc873){const _0x3d63f3=_0x1c7409,_0x3e9dd5=getClient(_0x4dc873['id'])[_0x3d63f3(0x148)],_0x31584c=getClient(_0x4dc873['id'])['uuid'];_0x4dc873['on'](_0x3d63f3(0x222),(_0x3563e6,_0x1397c3)=>{const _0x1ee417=_0x3d63f3;if(validateAccess(_0x1397c3,_0x31584c)[_0x1ee417(0x277)]){if(pid[_0x3e9dd5])pid[_0x3e9dd5][_0x1ee417(0x2cd)]({'function':_0x1ee417(0x15a),'args':_0x3563e6});}else logger[_0x1ee417(0x1c1)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x4dc873['on'](_0x3d63f3(0x278),(_0x40fabc,_0x1ac2bc)=>{const _0x16336c=_0x3d63f3;if(validateAccess(_0x1ac2bc,_0x31584c)['allow']){if(pid[_0x3e9dd5])pid[_0x3e9dd5][_0x16336c(0x2cd)]({'function':_0x16336c(0x2af),'args':_0x40fabc});}else logger[_0x16336c(0x1c1)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x4dc873['on'](_0x3d63f3(0x1b4),(_0x17a740,_0x3b931a)=>{const _0x1b3268=_0x3d63f3;if(validateAccess(_0x3b931a,_0x31584c)[_0x1b3268(0x277)]){if(pid[_0x3e9dd5])pid[_0x3e9dd5]['send']({'function':_0x1b3268(0x1a9),'args':_0x17a740});}else logger[_0x1b3268(0x1c1)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x4dc873['on'](_0x3d63f3(0x179),(_0x44ea60,_0x5c7302)=>{const _0x370b6a=_0x3d63f3;if(validateAccess(_0x5c7302,_0x31584c)['allow']){if(pid[_0x3e9dd5])pid[_0x3e9dd5][_0x370b6a(0x2cd)]({'function':_0x370b6a(0x18b),'args':_0x44ea60});}else logger[_0x370b6a(0x1c1)](_0x370b6a(0x198));}),_0x4dc873['on'](_0x3d63f3(0x24e),(_0x1564d7,_0xc8ff08)=>{const _0x1228aa=_0x3d63f3;if(validateAccess(_0xc8ff08,_0x31584c)[_0x1228aa(0x277)]){if(pid[_0x3e9dd5])pid[_0x3e9dd5][_0x1228aa(0x2cd)]({'function':'storeHeadless','args':_0x1564d7});}else logger[_0x1228aa(0x1c1)](_0x1228aa(0x112));}),_0x4dc873['on'](_0x3d63f3(0x21a),(_0x6354c4,_0x18e563)=>{const _0x175759=_0x3d63f3;if(validateAccess(_0x18e563,_0x31584c)[_0x175759(0x277)]){if(pid[_0x3e9dd5])pid[_0x3e9dd5][_0x175759(0x2cd)]({'function':_0x175759(0x2b2),'args':_0x6354c4});}else logger[_0x175759(0x1c1)](_0x175759(0x2c8));}),_0x4dc873['on']('reset-history',_0x5c939d=>{const _0x45da0b=_0x3d63f3;if(validateAccess(_0x5c939d,_0x31584c)[_0x45da0b(0x277)]){if(pid[_0x3e9dd5])pid[_0x3e9dd5][_0x45da0b(0x2cd)]({'function':_0x45da0b(0x2d5),'args':null});}else logger['full'](_0x45da0b(0x1a3));}),_0x4dc873['on'](_0x3d63f3(0x195),_0x3044fe=>{const _0x34b8cc=_0x3d63f3;if(validateAccess(_0x3044fe,_0x31584c)[_0x34b8cc(0x277)]){if(pid[_0x3e9dd5])pid[_0x3e9dd5][_0x34b8cc(0x2cd)]({'function':_0x34b8cc(0x125),'args':null});}else logger[_0x34b8cc(0x1c1)](_0x34b8cc(0x2e0));}),_0x4dc873['on']('place-order',(_0x3bbab4,_0xe40dd6)=>{const _0x2d9da5=_0x3d63f3;if(validateAccess(_0xe40dd6,_0x31584c)[_0x2d9da5(0x277)]){if(pid[_0x3e9dd5])pid[_0x3e9dd5][_0x2d9da5(0x2cd)]({'function':_0x2d9da5(0x23a),'args':_0x3bbab4});}else logger[_0x2d9da5(0x1c1)](_0x2d9da5(0x2ca));}),_0x4dc873['on']('cancel-loading',_0x42f243=>{const _0x278b24=_0x3d63f3;if(validateAccess(_0x42f243,_0x31584c)['allow']){if(pid[_0x3e9dd5])pid[_0x3e9dd5][_0x278b24(0x2cd)]({'function':_0x278b24(0x2a1),'args':null});}else logger['full'](_0x278b24(0x275));}),_0x4dc873['on'](_0x3d63f3(0x24a),_0x3281aa=>{const _0x389737=_0x3d63f3;if(validateAccess(_0x3281aa,_0x31584c)['allow']){if(pid[_0x3e9dd5])pid[_0x3e9dd5][_0x389737(0x2cd)]({'function':_0x389737(0x220),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x4dc873['on'](_0x3d63f3(0x26b),_0x391891=>{const _0x2c6247=_0x3d63f3;if(validateAccess(_0x391891,_0x31584c)[_0x2c6247(0x277)])updateBB(_0x2c6247(0x208));else logger[_0x2c6247(0x1c1)](_0x2c6247(0x272));}),_0x4dc873['on'](_0x3d63f3(0x256),_0x20f60f=>{const _0x303ac7=_0x3d63f3;if(validateAccess(_0x20f60f,_0x31584c)[_0x303ac7(0x277)])getMessages();else logger['full'](_0x303ac7(0x24c));}),_0x4dc873['on'](_0x3d63f3(0x134),(_0x2a4309,_0xfb6d72)=>{const _0x57ce0d=_0x3d63f3;if(validateAccess(_0xfb6d72,_0x31584c)[_0x57ce0d(0x277)])confirmMessage(_0x2a4309);else logger[_0x57ce0d(0x1c1)](_0x57ce0d(0x128));}),_0x4dc873['on'](_0x3d63f3(0x16b),_0x5dbff5=>{const _0x44098d=_0x3d63f3;if(validateAccess(_0x5dbff5,_0x31584c)[_0x44098d(0x277)]){if(devices[_0x31584c][_0x44098d(0x27c)])clearTimeout(devices[_0x31584c][_0x44098d(0x27c)]);if(devices[_0x31584c]['pidExpireLogin'])clearTimeout(devices[_0x31584c][_0x44098d(0x161)]);removeSocketListeners(getClient(_0x4dc873['id'])[_0x44098d(0x229)]),addBlacklist(_0x31584c),devices[_0x31584c][_0x44098d(0x1f7)]=null,devices[_0x31584c][_0x44098d(0x197)]=null,devices[_0x31584c][_0x44098d(0x2bc)][_0x44098d(0x288)]=null,logger[_0x44098d(0x143)](_0x44098d(0x1b0)+_0x31584c[_0x44098d(0x141)](-0x8)),io['to'](getClient(_0x4dc873['id'])['uuid'])['emit']('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x44098d(0x1c1)](_0x44098d(0x147));});}function removeSocketListeners(_0x2fb997){getClientsWithUuid(_0x2fb997)['forEach'](_0x36b7cc=>{const _0x24ba8d=_0x356b;getSocket(_0x36b7cc['id'])[_0x24ba8d(0x279)]();});}function cleanSettings(){const _0x5a7163=_0x1c7409;let _0x25f341=settings;return settings[_0x5a7163(0x126)]&&settings[_0x5a7163(0x126)]!=''&&(_0x25f341={..._0x25f341,'telegramToken':'************'}),settings[_0x5a7163(0x174)]&&settings[_0x5a7163(0x174)]!=''&&(_0x25f341={..._0x25f341,'bbPassword':_0x5a7163(0x2cf)}),(settings[_0x5a7163(0x174)]&&settings[_0x5a7163(0x174)]=='***'||settings['telegramToken']&&settings[_0x5a7163(0x126)]==_0x5a7163(0x185))&&(_0x25f341={..._0x25f341,'restored':{'password':settings[_0x5a7163(0x174)]==_0x5a7163(0x185),'telegram':settings[_0x5a7163(0x126)]==_0x5a7163(0x185)}}),_0x25f341;}async function updateBB(_0x411d44){const _0x3c2a78=_0x1c7409;await backupConfigFiles(),installingUpdate=!![],config[_0x3c2a78(0x276)](_0x438196=>{const _0x136eda=_0x3c2a78;restartBot(_0x438196[_0x136eda(0x1e1)]);}),logger[_0x3c2a78(0x143)](_0x3c2a78(0x258)+_0x411d44);if(_0x411d44=='update')process[_0x3c2a78(0x2cd)]({'update':!![]},_0xc063d6=>{});else _0x411d44==_0x3c2a78(0x104)&&process[_0x3c2a78(0x2cd)]({'reinstall':!![]},_0x15b10a=>{});}function startBot(_0x3c0e0d,_0x3cf8c8,_0x193ce1){const _0x3b3285=_0x1c7409;if(debugging)_0x3c0e0d['push']('-d');let _0x2d6762=![];const _0x45de9a=_0x3c0e0d[0x0];_0x3cf8c8={..._0x3cf8c8,'stdio':['inherit','inherit',_0x3b3285(0x2d3),_0x3b3285(0x10d)]},pid[_0x45de9a]=childProcess['fork'](botfile,_0x3c0e0d,_0x3cf8c8),pid[_0x45de9a]['on'](_0x3b3285(0x1ae),_0x9159c1=>{const _0x33672e=_0x3b3285;switch(Object['keys'](_0x9159c1)[0x0]){case _0x33672e(0x295):updateBotName(_0x45de9a,_0x9159c1['botname']);break;case _0x33672e(0x1b7):updateBotManager();break;case'status':updateStatus(_0x45de9a,_0x9159c1[_0x33672e(0x1a4)]);break;case _0x33672e(0x159):updateLive(_0x45de9a,_0x9159c1[_0x33672e(0x159)]);break;case _0x33672e(0x1d3):updateLive(_0x45de9a,_0x9159c1[_0x33672e(0x1d3)]),io['to'](_0x45de9a)[_0x33672e(0x24f)]('status',{'access':{'allow':![],'reason':_0x33672e(0x2d8),'token':null}});break;case _0x33672e(0x1fd):_0x9159c1[_0x33672e(0x1fd)]=='restart'&&restartBot(_0x45de9a);_0x9159c1['stop']==_0x33672e(0x1e4)&&toggleBot(_0x45de9a,_0x33672e(0x22c),_0x33672e(0x1c0));break;case _0x33672e(0x2dc):sendTelegram(_0x45de9a,_0x9159c1[_0x33672e(0x2dc)]);break;case'telegrammsg':sendTelegramMsg(_0x9159c1['telegrammsg']);break;case _0x33672e(0x25b):io['to'](_0x45de9a)[_0x33672e(0x24f)](_0x9159c1[_0x33672e(0x25b)],_0x9159c1[_0x33672e(0x238)]);break;}}),pid[_0x45de9a]['on'](_0x3b3285(0x1c8),function(_0x4bea09){if(_0x2d6762)return;_0x2d6762=!![],_0x193ce1(_0x4bea09);}),pid[_0x45de9a]['on']('exit',async function(_0x3ce698){const _0x2c361b=_0x3b3285;if(installingUpdate)return;if(_0x2d6762)return;_0x2d6762=!![],_0x193ce1(null);const _0x39fd3b=dbConfig[_0x2c361b(0x190)](_0x2c361b(0x177))[_0x2c361b(0x13f)]({'botID':_0x45de9a})['value']();_0x39fd3b&&(_0x39fd3b[_0x2c361b(0x1a4)]==_0x2c361b(0x247)||_0x39fd3b['status']=='new')&&(await sleep(0x3e8),updateLive(_0x45de9a,_0x2c361b(0x1c0)),logger[_0x2c361b(0x1c1)](_0x2c361b(0x1bf)+_0x45de9a),startBot([_0x45de9a,userID],{'cwd':bbpath},function(_0x594071){const _0x2d54ef=_0x2c361b;if(_0x594071)logger[_0x2d54ef(0x1c1)](_0x594071);}));});}function stopBot(_0x10ca25){getClientsWithBotID(_0x10ca25)['forEach'](_0x3835fb=>{const _0x5d95cd=_0x356b;getSocket(_0x3835fb['id'])[_0x5d95cd(0x118)](!![]),removeClient(_0x3835fb['id']);}),pid[_0x10ca25]&&(pid[_0x10ca25]['kill'](),pid[_0x10ca25]=null);}function restartBot(_0x2aace0){const _0x59e7b9=_0x1c7409;if(pid[_0x2aace0])pid[_0x2aace0][_0x59e7b9(0x1e4)]();}function addBot(){const _0x5604dc=_0x1c7409;let _0x4b190;for(let _0x1198c4=0x1;_0x1198c4<0x3e9;_0x1198c4++){_0x4b190=_0x1198c4['toString']()[_0x5604dc(0x110)](0x3,'0');let _0x2893d4=config[_0x5604dc(0x13f)](_0x5208e2=>_0x5208e2['botID']==_0x4b190);if(!_0x2893d4)break;}if(_0x4b190===_0x5604dc(0x252)){logger[_0x5604dc(0x1c1)](_0x5604dc(0x1f3));return;}logger[_0x5604dc(0x1c1)](_0x5604dc(0xfe)+_0x4b190),dbConfig[_0x5604dc(0x190)](_0x5604dc(0x177))['push']({'botID':_0x4b190,'botname':_0x5604dc(0x290)+_0x4b190,'status':_0x5604dc(0x138),'live':''})['write'](),startBot([_0x4b190,userID],{'cwd':bbpath},function(_0x2c00d3){const _0x47927a=_0x5604dc;if(_0x2c00d3)logger[_0x47927a(0x1c1)](_0x2c00d3);}),config=getConfiguration(),io['to'](_0x5604dc(0x205))['emit'](_0x5604dc(0x177),config),broadcastToBots(_0x5604dc(0x177),JSON[_0x5604dc(0x168)](config));}function deleteBot(_0x1fb326){const _0x5543b4=_0x1c7409;getClientsWithBotID(_0x1fb326)[_0x5543b4(0x276)](_0x5966c8=>{getSocket(_0x5966c8['id'])['disconnect'](!![]),removeClient(_0x5966c8['id']);}),dbConfig[_0x5543b4(0x190)]('bots')[_0x5543b4(0x243)]({'botID':_0x1fb326})[_0x5543b4(0x2bf)](),logger[_0x5543b4(0x1c1)](_0x5543b4(0x1d6)+_0x1fb326),stopBot(_0x1fb326);try{if(fs[_0x5543b4(0x241)](path[_0x5543b4(0x122)](configpath,_0x5543b4(0x129)+_0x1fb326+_0x5543b4(0x1bc))))fs['unlinkSync'](path[_0x5543b4(0x122)](configpath,_0x5543b4(0x129)+_0x1fb326+_0x5543b4(0x1bc)));if(fs[_0x5543b4(0x241)](path[_0x5543b4(0x122)](configpath,_0x5543b4(0x129)+_0x1fb326+_0x5543b4(0x270))))fs[_0x5543b4(0x1cb)](path[_0x5543b4(0x122)](configpath,'bot-'+_0x1fb326+_0x5543b4(0x270)));if(fs[_0x5543b4(0x241)](path[_0x5543b4(0x122)](configpath,_0x5543b4(0x129)+_0x1fb326+_0x5543b4(0x26f))))fs['unlinkSync'](path[_0x5543b4(0x122)](configpath,_0x5543b4(0x129)+_0x1fb326+_0x5543b4(0x26f)));if(fs[_0x5543b4(0x241)](path[_0x5543b4(0x122)](configpath,_0x5543b4(0x129)+_0x1fb326+_0x5543b4(0x1b8))))fs[_0x5543b4(0x1cb)](path[_0x5543b4(0x122)](configpath,'bot-'+_0x1fb326+_0x5543b4(0x1b8)));}catch(_0x11c106){if(_0x11c106)logger[_0x5543b4(0x1c1)](_0x5543b4(0x108),_0x11c106);}config=getConfiguration(),io['to'](_0x5543b4(0x205))['emit'](_0x5543b4(0x177),config),broadcastToBots('bots',JSON[_0x5543b4(0x168)](config));}function toggleBot(_0x7eb761,_0x508ac9,_0x4e42e3){const _0x216cf1=_0x1c7409;dbConfig[_0x216cf1(0x190)]('bots')[_0x216cf1(0x13f)]({'botID':_0x7eb761})[_0x216cf1(0x1a0)]({'status':_0x508ac9})['assign']({'live':_0x4e42e3})[_0x216cf1(0x2bf)]();if(_0x508ac9==_0x216cf1(0x247)||_0x508ac9=='new')logger[_0x216cf1(0x1c1)]('Enabled\x20Bot\x20'+_0x7eb761),startBot([_0x7eb761,userID],{'cwd':bbpath},function(_0x203e2f){const _0x4ca00e=_0x216cf1;if(_0x203e2f)logger[_0x4ca00e(0x1c1)](_0x203e2f);});else(_0x508ac9==_0x216cf1(0x22c)||_0x508ac9=='new-disabled')&&(logger[_0x216cf1(0x1c1)](_0x216cf1(0x16a)+_0x7eb761),stopBot(_0x7eb761));config=getConfiguration(),io['to']('botmanager')[_0x216cf1(0x24f)]('bots',config),broadcastToBots(_0x216cf1(0x177),JSON[_0x216cf1(0x168)](config));}function toggleStatus(_0x57c16f){const _0x3808cf=_0x1c7409;let _0x353f4f=dbConfig[_0x3808cf(0x190)](_0x3808cf(0x177))[_0x3808cf(0x13f)]({'botID':_0x57c16f})[_0x3808cf(0x163)](),_0x97253d;if(_0x353f4f[_0x3808cf(0x1a4)]===_0x3808cf(0x247))_0x97253d=_0x3808cf(0x22c);else{if(_0x353f4f[_0x3808cf(0x1a4)]===_0x3808cf(0x138))_0x97253d=_0x3808cf(0x189);else{if(_0x353f4f[_0x3808cf(0x1a4)]==='new-disabled')_0x97253d='new';else{if(_0x353f4f[_0x3808cf(0x1a4)]==='disabled')_0x97253d='enabled';}}}return _0x97253d;}function updateStatus(_0x9f5d79,_0x370dbb){const _0x363919=_0x1c7409;dbConfig[_0x363919(0x190)](_0x363919(0x177))[_0x363919(0x13f)]({'botID':_0x9f5d79})[_0x363919(0x1a0)]({'status':_0x370dbb})['write'](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x363919(0x177),config),broadcastToBots(_0x363919(0x177),JSON[_0x363919(0x168)](config));}function updateLive(_0x1e8349,_0x2d08dd){const _0x25863f=_0x1c7409;dbConfig['get'](_0x25863f(0x177))[_0x25863f(0x13f)]({'botID':_0x1e8349})[_0x25863f(0x1a0)]({'live':_0x2d08dd})[_0x25863f(0x2bf)](),config=getConfiguration(),io['to']('botmanager')[_0x25863f(0x24f)]('bots',config),broadcastToBots(_0x25863f(0x177),JSON[_0x25863f(0x168)](config));}function updateBotName(_0x1a6316,_0x19df4e){const _0x20eb56=_0x1c7409;dbConfig[_0x20eb56(0x190)](_0x20eb56(0x177))['find']({'botID':_0x1a6316})['assign']({'botname':_0x19df4e})[_0x20eb56(0x2bf)](),config=getConfiguration(),io['to'](_0x20eb56(0x205))[_0x20eb56(0x24f)](_0x20eb56(0x177),config),broadcastToBots('bots',JSON[_0x20eb56(0x168)](config));}function updateBotManager(){const _0xf319bc=_0x1c7409;config=getConfiguration(),io['to']('botmanager')[_0xf319bc(0x24f)]('bots',config),broadcastToBots(_0xf319bc(0x177),JSON['stringify'](config));}function toggleBotMode(_0xc4deb7){const _0x3c1e52=_0x1c7409;if(pid[_0xc4deb7])pid[_0xc4deb7][_0x3c1e52(0x2cd)]({'function':_0x3c1e52(0x1da),'args':null});else{const _0x223485=configpath+_0x3c1e52(0x129)+_0xc4deb7+'-config.json',_0x321709=fs[_0x3c1e52(0x206)](_0x223485),_0x4c9551=JSON['parse'](_0x321709),_0x4d1864=_0x4c9551[_0x3c1e52(0x148)][0x0][_0x3c1e52(0x182)];_0x4c9551[_0x3c1e52(0x148)][0x0]['headless']=!_0x4d1864;const _0x147b04=JSON[_0x3c1e52(0x168)](_0x4c9551,null,0x2);fs[_0x3c1e52(0x29e)](_0x223485,_0x147b04),config=getConfiguration(),io['to'](_0x3c1e52(0x205))['emit'](_0x3c1e52(0x177),config),broadcastToBots(_0x3c1e52(0x177),JSON[_0x3c1e52(0x168)](config));}}function telegramError(_0x3b9258){const _0x47b7a5=_0x1c7409;logger[_0x47b7a5(0x2a3)](getTimeStamp()+_0x47b7a5(0x242));}function validateTelegram(_0x267ac4){const _0x2c56e4=_0x1c7409;if(_0x267ac4[_0x2c56e4(0x2c5)][_0x2c56e4(0x283)]!=settings['telegramUsername']&&'@'+_0x267ac4['from'][_0x2c56e4(0x283)]!=settings[_0x2c56e4(0x20f)])return tgBot[_0x2c56e4(0x2cc)](_0x267ac4[_0x2c56e4(0x296)]['id'],_0x2c56e4(0x1ff),{'parse_mode':_0x2c56e4(0x2ab)})[_0x2c56e4(0x12f)](_0x2bf394=>{telegramError(_0x2bf394);}),![];return!![];}async function initTelegram(){const _0x2e8401=_0x1c7409;if(tgBot)tgBot[_0x2e8401(0x2c6)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x2e8401(0x126)],{'polling':!![]});let _0x1de5ba=_0x2e8401(0x2ad);_0x1de5ba+='\x0a',_0x1de5ba+=_0x2e8401(0x2a2),_0x1de5ba+=_0x2e8401(0x27d),_0x1de5ba+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x1de5ba+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x1de5ba+=_0x2e8401(0x2a7),_0x1de5ba+='/off\x20-\x20stop\x20bot(s)\x0a',_0x1de5ba+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x1de5ba+='/names\x20-\x20show\x20bot\x20names\x0a',_0x1de5ba+=_0x2e8401(0x1dd),_0x1de5ba+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x1de5ba+=_0x2e8401(0x2d7),_0x1de5ba+=_0x2e8401(0x262),_0x1de5ba+=_0x2e8401(0x2a9),_0x1de5ba+=_0x2e8401(0x12b);let _0x2c48a2=_0x2e8401(0x18a);_0x2c48a2+='\x0a',_0x2c48a2+=_0x1de5ba,tgBot['onText'](/\/start/,_0x5e7e68=>{const _0x1a4a0d=_0x2e8401;if(!validateTelegram(_0x5e7e68))return;if(settings[_0x1a4a0d(0x210)]!=_0x5e7e68['chat']['id'])updateSetting(_0x1a4a0d(0x210),_0x5e7e68['chat']['id']);updateSetting(_0x1a4a0d(0x254),!![]),tgBot[_0x1a4a0d(0x2cc)](_0x5e7e68[_0x1a4a0d(0x296)]['id'],_0x2c48a2)[_0x1a4a0d(0x12f)](_0x325e5a=>{telegramError(_0x325e5a);});}),tgBot[_0x2e8401(0x273)](/\/enable/,_0x199c95=>{const _0x11946c=_0x2e8401;if(!validateTelegram(_0x199c95))return;if(settings[_0x11946c(0x210)]!=_0x199c95[_0x11946c(0x296)]['id'])updateSetting(_0x11946c(0x210),_0x199c95[_0x11946c(0x296)]['id']);updateSetting(_0x11946c(0x254),!![]),tgBot['sendMessage'](_0x199c95[_0x11946c(0x296)]['id'],_0x11946c(0x10e))[_0x11946c(0x12f)](_0x58f2ba=>{telegramError(_0x58f2ba);});}),tgBot['onText'](/\/config/,async _0x41bce0=>{const _0xe791c8=_0x2e8401;if(!validateTelegram(_0x41bce0))return;tgBot[_0xe791c8(0x131)](_0xe791c8(0x219)),tgBot[_0xe791c8(0x2cc)](_0x41bce0[_0xe791c8(0x296)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0xe791c8(0x152),'callback_data':_0xe791c8(0x22f)},{'text':_0xe791c8(0x1e7),'callback_data':'alerts'},{'text':'All','callback_data':_0xe791c8(0x225)}]]}})['catch'](_0x1f76a7=>{telegramError(_0x1f76a7);}),tgBot['on'](_0xe791c8(0x219),async _0x5ca1ad=>{const _0x3ce104=_0xe791c8,_0x11dcba=_0x5ca1ad[_0x3ce104(0x16e)],_0x552e0a=_0x5ca1ad[_0x3ce104(0x1ae)];tgBot['answerCallbackQuery'](_0x5ca1ad['id'])['then'](async()=>{const _0x1c393c=_0x3ce104;_0x11dcba=='orders'&&(updateSetting(_0x1c393c(0x173),_0x1c393c(0x22f)),updateSetting(_0x1c393c(0x254),!![]),await tgBot[_0x1c393c(0x2cc)](_0x552e0a[_0x1c393c(0x296)]['id'],_0x1c393c(0x14c))['catch'](_0x304d00=>{telegramError(_0x304d00);}));_0x11dcba==_0x1c393c(0x1a8)&&(updateSetting(_0x1c393c(0x173),_0x1c393c(0x1a8)),updateSetting(_0x1c393c(0x254),!![]),await tgBot[_0x1c393c(0x2cc)](_0x552e0a[_0x1c393c(0x296)]['id'],_0x1c393c(0x27b))['catch'](_0x25f9ec=>{telegramError(_0x25f9ec);}));_0x11dcba==_0x1c393c(0x225)&&(updateSetting('telegramEvents','all'),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x552e0a['chat']['id'],_0x1c393c(0x102))['catch'](_0x49846f=>{telegramError(_0x49846f);}));if(!settings['telegramChatId'])tgBot['sendMessage'](_0x552e0a['chat']['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x1c393c(0x12f)](_0x2af6d5=>{telegramError(_0x2af6d5);});}),tgBot[_0x3ce104(0x131)](_0x3ce104(0x219));});}),tgBot['onText'](/\/status/,_0x5d3f59=>{const _0x5860cb=_0x2e8401;if(!validateTelegram(_0x5d3f59))return;const _0x7b5ea7=getBotsWithMode();let _0x371102=_0x5860cb(0x114);config[_0x5860cb(0x276)](_0x5350d9=>{const _0xf787fc=_0x5860cb,_0x391461=_0x7b5ea7['find'](_0x1c5000=>_0x1c5000[_0xf787fc(0x1e1)]==_0x5350d9[_0xf787fc(0x1e1)])[_0xf787fc(0x21d)];_0x371102+=_0xf787fc(0x290)+_0x5350d9[_0xf787fc(0x1e1)]+':\x20'+_0x5350d9[_0xf787fc(0x1a4)]+_0xf787fc(0x1bb)+_0x391461+_0xf787fc(0x1bb)+_0x5350d9[_0xf787fc(0x159)]+'\x0a';}),_0x371102+='\x0a',_0x371102+=_0x5860cb(0x154),_0x371102+=!settings[_0x5860cb(0x254)]?'Notifications\x20disabled\x0a':_0x5860cb(0x18e),_0x371102+=settings[_0x5860cb(0x254)]?settings[_0x5860cb(0x173)]==_0x5860cb(0x225)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x5860cb(0x20b)+settings[_0x5860cb(0x173)]+_0x5860cb(0x1c7):'',tgBot[_0x5860cb(0x2cc)](_0x5d3f59[_0x5860cb(0x296)]['id'],_0x371102,{'parse_mode':_0x5860cb(0x2ab)})['catch'](_0xcb64f8=>{telegramError(_0xcb64f8);});}),tgBot[_0x2e8401(0x273)](/\/restart/,_0x4ca502=>{const _0x1290b0=_0x2e8401;if(!validateTelegram(_0x4ca502))return;tgBot[_0x1290b0(0x131)](_0x1290b0(0x219));const _0x2f3012=getEnabledBots();if(_0x2f3012[_0x1290b0(0x1ed)]==0x0)tgBot[_0x1290b0(0x2cc)](_0x4ca502[_0x1290b0(0x296)]['id'],_0x1290b0(0x23f))[_0x1290b0(0x12f)](_0x1426b3=>{telegramError(_0x1426b3);});else{if(_0x2f3012['length']>0x1)_0x2f3012[_0x1290b0(0x29d)]({'botID':_0x1290b0(0x225)});let _0x1d4a35=[],_0x548f59=[];const _0x38e626=_0x2f3012[_0x1290b0(0x1ed)]%0x4==0x0||_0x2f3012[_0x1290b0(0x1ed)]%0x4==0x3||_0x2f3012[_0x1290b0(0x1ed)]%0x3==0x1?0x4:0x3;let _0x1b716d=0x0;_0x2f3012[_0x1290b0(0x276)]((_0xb2f2e3,_0x523953)=>{const _0x7253c0=_0x1290b0;if(_0x523953%_0x38e626==0x0)_0x548f59=[];_0x548f59['push']({'text':_0xb2f2e3['botID']=='all'?_0x7253c0(0x187):_0x7253c0(0x290)+_0xb2f2e3['botID'],'callback_data':_0xb2f2e3[_0x7253c0(0x1e1)]}),_0x523953%_0x38e626==0x0&&(_0x1d4a35[_0x1b716d]=_0x548f59,_0x1b716d++);}),tgBot[_0x1290b0(0x2cc)](_0x4ca502[_0x1290b0(0x296)]['id'],_0x1290b0(0x29f),{'reply_markup':{'inline_keyboard':_0x1d4a35}})[_0x1290b0(0x12f)](_0x1a8474=>{telegramError(_0x1a8474);}),tgBot['on'](_0x1290b0(0x219),async _0xfd2006=>{const _0x272076=_0x1290b0,_0xadc5fb=_0xfd2006['data'],_0x4123a1=_0xfd2006[_0x272076(0x1ae)];tgBot[_0x272076(0x29a)](_0xfd2006['id'])[_0x272076(0x268)](async()=>{const _0x21b1a4=_0x272076;_0xadc5fb==_0x21b1a4(0x225)?config[_0x21b1a4(0x276)](_0x396619=>{restartBot(_0x396619['botID']);}):restartBot(_0xadc5fb);}),tgBot['removeListener'](_0x272076(0x219));});}}),tgBot[_0x2e8401(0x273)](/\/on/,_0x2258ae=>{const _0x2bef02=_0x2e8401;if(!validateTelegram(_0x2258ae))return;tgBot[_0x2bef02(0x131)](_0x2bef02(0x219));const _0x910dae=getDisabledBots();if(_0x910dae[_0x2bef02(0x1ed)]==0x0)tgBot['sendMessage'](_0x2258ae['chat']['id'],_0x2bef02(0x1e5))[_0x2bef02(0x12f)](_0x1e99b2=>{telegramError(_0x1e99b2);});else{if(_0x910dae['length']>0x1)_0x910dae[_0x2bef02(0x29d)]({'botID':_0x2bef02(0x225)});let _0x363d8e=[],_0x1d467a=[];const _0x1f619e=_0x910dae[_0x2bef02(0x1ed)]%0x4==0x0||_0x910dae[_0x2bef02(0x1ed)]%0x4==0x3||_0x910dae[_0x2bef02(0x1ed)]%0x3==0x1?0x4:0x3;let _0x34b865=0x0;_0x910dae[_0x2bef02(0x276)]((_0x1e66c7,_0x22d30c)=>{const _0x113d4a=_0x2bef02;if(_0x22d30c%_0x1f619e==0x0)_0x1d467a=[];_0x1d467a[_0x113d4a(0x29d)]({'text':_0x1e66c7[_0x113d4a(0x1e1)]=='all'?'All\x20bots':_0x113d4a(0x290)+_0x1e66c7[_0x113d4a(0x1e1)],'callback_data':_0x1e66c7[_0x113d4a(0x1e1)]}),_0x22d30c%_0x1f619e==0x0&&(_0x363d8e[_0x34b865]=_0x1d467a,_0x34b865++);}),tgBot[_0x2bef02(0x2cc)](_0x2258ae[_0x2bef02(0x296)]['id'],_0x2bef02(0x1ce),{'reply_markup':{'inline_keyboard':_0x363d8e}})['catch'](_0x532346=>{telegramError(_0x532346);}),tgBot['on']('callback_query',async _0x3f4113=>{const _0x14ebd3=_0x2bef02,_0x1fe2f3=_0x3f4113[_0x14ebd3(0x16e)],_0x13eeaa=_0x3f4113['message'];tgBot[_0x14ebd3(0x29a)](_0x3f4113['id'])['then'](async()=>{const _0x3440e5=_0x14ebd3;_0x1fe2f3=='all'?(tgBot[_0x3440e5(0x2cc)](_0x13eeaa[_0x3440e5(0x296)]['id'],_0x3440e5(0x2ac))[_0x3440e5(0x12f)](_0x892626=>{telegramError(_0x892626);}),_0x910dae['forEach'](_0x4fe1f5=>{const _0x56819c=_0x3440e5;if(_0x4fe1f5[_0x56819c(0x1e1)]!=_0x56819c(0x225))toggleBot(_0x4fe1f5['botID'],toggleStatus(_0x4fe1f5['botID']),_0x56819c(0x1c0));})):(tgBot[_0x3440e5(0x2cc)](_0x13eeaa['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x1fe2f3)[_0x3440e5(0x12f)](_0x3ba124=>{telegramError(_0x3ba124);}),toggleBot(_0x1fe2f3,toggleStatus(_0x1fe2f3),'stopped'));}),tgBot[_0x14ebd3(0x131)]('callback_query');});}}),tgBot[_0x2e8401(0x273)](/\/off/,_0x11caeb=>{const _0x292d75=_0x2e8401;if(!validateTelegram(_0x11caeb))return;tgBot[_0x292d75(0x131)](_0x292d75(0x219));const _0x5b3a1d=getEnabledBots();if(_0x5b3a1d['length']==0x0)tgBot[_0x292d75(0x2cc)](_0x11caeb['chat']['id'],_0x292d75(0x23f))['catch'](_0x400739=>{telegramError(_0x400739);});else{if(_0x5b3a1d[_0x292d75(0x1ed)]>0x1)_0x5b3a1d[_0x292d75(0x29d)]({'botID':_0x292d75(0x225)});let _0x3310ac=[],_0x453842=[];const _0x19fcd0=_0x5b3a1d[_0x292d75(0x1ed)]%0x4==0x0||_0x5b3a1d['length']%0x4==0x3||_0x5b3a1d[_0x292d75(0x1ed)]%0x3==0x1?0x4:0x3;let _0x40c1fd=0x0;_0x5b3a1d[_0x292d75(0x276)]((_0x59dcda,_0x28da12)=>{const _0xf85d10=_0x292d75;if(_0x28da12%_0x19fcd0==0x0)_0x453842=[];_0x453842[_0xf85d10(0x29d)]({'text':_0x59dcda['botID']=='all'?_0xf85d10(0x187):'Bot\x20'+_0x59dcda[_0xf85d10(0x1e1)],'callback_data':_0x59dcda[_0xf85d10(0x1e1)]}),_0x28da12%_0x19fcd0==0x0&&(_0x3310ac[_0x40c1fd]=_0x453842,_0x40c1fd++);}),tgBot['sendMessage'](_0x11caeb['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x3310ac}})[_0x292d75(0x12f)](_0x5ebc89=>{telegramError(_0x5ebc89);}),tgBot['on'](_0x292d75(0x219),async _0x2d8155=>{const _0xb2f6a2=_0x292d75,_0x4ba121=_0x2d8155['data'],_0x3519ec=_0x2d8155['message'];tgBot[_0xb2f6a2(0x29a)](_0x2d8155['id'])[_0xb2f6a2(0x268)](async()=>{const _0x2a9d09=_0xb2f6a2;_0x4ba121=='all'?(tgBot['sendMessage'](_0x3519ec[_0x2a9d09(0x296)]['id'],_0x2a9d09(0x1de))[_0x2a9d09(0x12f)](_0x29b9b9=>{telegramError(_0x29b9b9);}),_0x5b3a1d[_0x2a9d09(0x276)](_0x496aba=>{const _0x3ea3a6=_0x2a9d09;if(_0x496aba[_0x3ea3a6(0x1e1)]!=_0x3ea3a6(0x225))toggleBot(_0x496aba[_0x3ea3a6(0x1e1)],toggleStatus(_0x496aba[_0x3ea3a6(0x1e1)]),_0x3ea3a6(0x1c0));})):(tgBot['sendMessage'](_0x3519ec[_0x2a9d09(0x296)]['id'],_0x2a9d09(0x26d)+_0x4ba121)[_0x2a9d09(0x12f)](_0x3c0817=>{telegramError(_0x3c0817);}),toggleBot(_0x4ba121,toggleStatus(_0x4ba121),_0x2a9d09(0x1c0)));}),tgBot[_0xb2f6a2(0x131)](_0xb2f6a2(0x219));});}}),tgBot[_0x2e8401(0x273)](/\/metrics/,_0x3f6cb2=>{const _0x3f428c=_0x2e8401;if(!validateTelegram(_0x3f6cb2))return;tgBot[_0x3f428c(0x131)](_0x3f428c(0x219));const _0xfd16b=getEnabledBots();if(_0xfd16b['length']==0x0)tgBot[_0x3f428c(0x2cc)](_0x3f6cb2[_0x3f428c(0x296)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x3f428c(0x12f)](_0x528683=>{telegramError(_0x528683);});else{if(_0xfd16b[_0x3f428c(0x1ed)]>0x1){let _0x488e7f=[],_0x366b5a=[];const _0x5dc0c6=_0xfd16b[_0x3f428c(0x1ed)]%0x4==0x0||_0xfd16b[_0x3f428c(0x1ed)]%0x4==0x3||_0xfd16b[_0x3f428c(0x1ed)]%0x3==0x1?0x4:0x3;let _0x539a7d=0x0;_0xfd16b[_0x3f428c(0x276)]((_0x34914c,_0x2cba26)=>{const _0x385a71=_0x3f428c;if(_0x2cba26%_0x5dc0c6==0x0)_0x366b5a=[];_0x366b5a[_0x385a71(0x29d)]({'text':_0x385a71(0x290)+_0x34914c[_0x385a71(0x1e1)],'callback_data':_0x34914c[_0x385a71(0x1e1)]}),_0x2cba26%_0x5dc0c6==0x0&&(_0x488e7f[_0x539a7d]=_0x366b5a,_0x539a7d++);}),tgBot[_0x3f428c(0x2cc)](_0x3f6cb2['chat']['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x488e7f}})[_0x3f428c(0x12f)](_0x1523d5=>{telegramError(_0x1523d5);}),tgBot['on']('callback_query',async _0x4ab66b=>{const _0x18b8ba=_0x3f428c,_0x3885d1=_0x4ab66b[_0x18b8ba(0x16e)],_0x11d8a6=_0x4ab66b['message'];tgBot[_0x18b8ba(0x29a)](_0x4ab66b['id'])[_0x18b8ba(0x268)](async()=>{const _0x2ca808=_0x18b8ba;if(pid[_0x3885d1])pid[_0x3885d1][_0x2ca808(0x2cd)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x18b8ba(0x131)](_0x18b8ba(0x219));});}else{const _0x44f205=_0xfd16b[0x0][_0x3f428c(0x1e1)];if(pid[_0x44f205])pid[_0x44f205][_0x3f428c(0x2cd)]({'function':_0x3f428c(0x1f4),'args':null});}}}),tgBot['onText'](/\/portfolio/,_0x47d918=>{const _0x26e324=_0x2e8401;if(!validateTelegram(_0x47d918))return;tgBot['removeListener']('callback_query');const _0x59ed1d=getEnabledBots();if(_0x59ed1d[_0x26e324(0x1ed)]==0x0)tgBot[_0x26e324(0x2cc)](_0x47d918[_0x26e324(0x296)]['id'],_0x26e324(0x23f))['catch'](_0x397f02=>{telegramError(_0x397f02);});else{if(_0x59ed1d[_0x26e324(0x1ed)]>0x1){let _0x2e71be=[],_0x4617c2=[];const _0x3314cd=_0x59ed1d[_0x26e324(0x1ed)]%0x4==0x0||_0x59ed1d[_0x26e324(0x1ed)]%0x4==0x3||_0x59ed1d['length']%0x3==0x1?0x4:0x3;let _0x3f52f3=0x0;_0x59ed1d[_0x26e324(0x276)]((_0x403b7a,_0x216061)=>{const _0x444c3d=_0x26e324;if(_0x216061%_0x3314cd==0x0)_0x4617c2=[];_0x4617c2['push']({'text':_0x444c3d(0x290)+_0x403b7a['botID'],'callback_data':_0x403b7a[_0x444c3d(0x1e1)]}),_0x216061%_0x3314cd==0x0&&(_0x2e71be[_0x3f52f3]=_0x4617c2,_0x3f52f3++);}),tgBot[_0x26e324(0x2cc)](_0x47d918[_0x26e324(0x296)]['id'],_0x26e324(0x280),{'reply_markup':{'inline_keyboard':_0x2e71be}})[_0x26e324(0x12f)](_0x411506=>{telegramError(_0x411506);}),tgBot['on']('callback_query',async _0x4d7841=>{const _0x29bf9d=_0x26e324,_0x2d754a=_0x4d7841['data'],_0x336099=_0x4d7841[_0x29bf9d(0x1ae)];tgBot[_0x29bf9d(0x29a)](_0x4d7841['id'])[_0x29bf9d(0x268)](async()=>{const _0x433b72=_0x29bf9d;if(pid[_0x2d754a])pid[_0x2d754a]['send']({'function':_0x433b72(0x2cb),'args':null});}),tgBot[_0x29bf9d(0x131)]('callback_query');});}else{const _0x5311c2=_0x59ed1d[0x0][_0x26e324(0x1e1)];if(pid[_0x5311c2])pid[_0x5311c2][_0x26e324(0x2cd)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x2e8401(0x273)](/\/update/,async _0x1524ab=>{const _0x446a72=_0x2e8401;if(!validateTelegram(_0x1524ab))return;tgBot[_0x446a72(0x131)](_0x446a72(0x219)),await getMessages();if(!updateAvailable)tgBot[_0x446a72(0x2cc)](_0x1524ab[_0x446a72(0x296)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x446a72(0x12f)](_0x25a713=>{telegramError(_0x25a713);});else!validInstallation?tgBot[_0x446a72(0x2cc)](_0x1524ab[_0x446a72(0x296)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0x446a72(0x12f)](_0x5687c4=>{telegramError(_0x5687c4);}):(tgBot[_0x446a72(0x2cc)](_0x1524ab[_0x446a72(0x296)]['id'],_0x446a72(0x287),{'reply_markup':{'inline_keyboard':[[{'text':_0x446a72(0x239),'callback_data':_0x446a72(0x215)},{'text':'No','callback_data':'no'}]]}})[_0x446a72(0x12f)](_0x3ddd07=>{telegramError(_0x3ddd07);}),tgBot['on']('callback_query',async _0x375ad7=>{const _0x35f481=_0x446a72,_0x66d0b=_0x375ad7['data'],_0x5a8c54=_0x375ad7[_0x35f481(0x1ae)];tgBot[_0x35f481(0x29a)](_0x375ad7['id'])['then'](async()=>{const _0x37c233=_0x35f481;_0x66d0b=='yes'&&(await tgBot[_0x37c233(0x2cc)](_0x5a8c54[_0x37c233(0x296)]['id'],_0x37c233(0x158))[_0x37c233(0x12f)](_0x5e324f=>{telegramError(_0x5e324f);}),updateBB('update')),_0x66d0b=='no'&&await tgBot[_0x37c233(0x2cc)](_0x5a8c54[_0x37c233(0x296)]['id'],_0x37c233(0x237))[_0x37c233(0x12f)](_0x333db7=>{telegramError(_0x333db7);});}),tgBot[_0x35f481(0x131)](_0x35f481(0x219));}));}),tgBot[_0x2e8401(0x273)](/\/reinstall/,async _0x180ca4=>{const _0x120f99=_0x2e8401;if(!validateTelegram(_0x180ca4))return;tgBot['removeListener'](_0x120f99(0x219)),!validInstallation?tgBot[_0x120f99(0x2cc)](_0x180ca4[_0x120f99(0x296)]['id'],_0x120f99(0x274))[_0x120f99(0x12f)](_0x249e64=>{telegramError(_0x249e64);}):(tgBot[_0x120f99(0x2cc)](_0x180ca4[_0x120f99(0x296)]['id'],_0x120f99(0x144),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x120f99(0x215)},{'text':'No','callback_data':'no'}]]}})[_0x120f99(0x12f)](_0x3568c4=>{telegramError(_0x3568c4);}),tgBot['on'](_0x120f99(0x219),async _0x4cbe07=>{const _0x1982a2=_0x120f99,_0x3eefca=_0x4cbe07[_0x1982a2(0x16e)],_0x526646=_0x4cbe07['message'];tgBot['answerCallbackQuery'](_0x4cbe07['id'])[_0x1982a2(0x268)](async()=>{const _0x14eca3=_0x1982a2;_0x3eefca=='yes'&&(await tgBot[_0x14eca3(0x2cc)](_0x526646[_0x14eca3(0x296)]['id'],_0x14eca3(0x12d))[_0x14eca3(0x12f)](_0x550c07=>{telegramError(_0x550c07);}),updateBB(_0x14eca3(0x104))),_0x3eefca=='no'&&await tgBot['sendMessage'](_0x526646[_0x14eca3(0x296)]['id'],_0x14eca3(0x1c5))[_0x14eca3(0x12f)](_0x3548cf=>{telegramError(_0x3548cf);});}),tgBot[_0x1982a2(0x131)](_0x1982a2(0x219));}));}),tgBot[_0x2e8401(0x273)](/\/toggle/,_0x21560e=>{const _0x13a784=_0x2e8401;if(!validateTelegram(_0x21560e))return;tgBot[_0x13a784(0x131)](_0x13a784(0x219));const _0x273ab9=getBotsWithMode();if(_0x273ab9[_0x13a784(0x1ed)]==0x0)tgBot[_0x13a784(0x2cc)](_0x21560e[_0x13a784(0x296)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x13a784(0x12f)](_0x18886e=>{telegramError(_0x18886e);});else{let _0x3d8fe5=[],_0x5eb8b4=[];const _0x357af3=0x2;let _0x4d7a7e=0x0;_0x273ab9[_0x13a784(0x276)]((_0x60e6dc,_0x3b0863)=>{const _0x243b4d=_0x13a784;if(_0x3b0863%_0x357af3==0x0)_0x5eb8b4=[];_0x5eb8b4[_0x243b4d(0x29d)]({'text':_0x243b4d(0x290)+_0x60e6dc['botID']+'\x20('+_0x60e6dc[_0x243b4d(0x21d)]+')','callback_data':_0x60e6dc[_0x243b4d(0x1e1)]}),_0x3b0863%_0x357af3==0x0&&(_0x3d8fe5[_0x4d7a7e]=_0x5eb8b4,_0x4d7a7e++);}),tgBot[_0x13a784(0x2cc)](_0x21560e['chat']['id'],_0x13a784(0x14f),{'reply_markup':{'inline_keyboard':_0x3d8fe5}})['catch'](_0x35fe8e=>{telegramError(_0x35fe8e);}),tgBot['on'](_0x13a784(0x219),async _0x48d86b=>{const _0x1b3456=_0x13a784,_0x298353=_0x48d86b[_0x1b3456(0x16e)],_0x37bde9=_0x48d86b[_0x1b3456(0x1ae)];tgBot['answerCallbackQuery'](_0x48d86b['id'])['then'](async()=>{const _0x32b158=_0x1b3456,_0x33ed40=_0x273ab9[_0x32b158(0x13f)](_0xbb82eb=>_0xbb82eb[_0x32b158(0x1e1)]==_0x298353),_0x64991d=_0x33ed40[_0x32b158(0x21d)]==_0x32b158(0x12c)?'manual':_0x32b158(0x12c);tgBot[_0x32b158(0x2cc)](_0x37bde9[_0x32b158(0x296)]['id'],_0x32b158(0x2ae)+_0x298353+_0x32b158(0x2be)+_0x64991d+_0x32b158(0x1a2))['catch'](_0x52c027=>{telegramError(_0x52c027);}),toggleBotMode(_0x298353);}),tgBot[_0x1b3456(0x131)](_0x1b3456(0x219));});}}),tgBot[_0x2e8401(0x273)](/\/names/,_0x33f57a=>{const _0x27b50e=_0x2e8401;if(!validateTelegram(_0x33f57a))return;let _0x2c89ae='';config[_0x27b50e(0x276)](_0x38c035=>{const _0x4cc551=_0x27b50e;_0x2c89ae+=_0x4cc551(0x290)+_0x38c035[_0x4cc551(0x1e1)]+':\x20'+_0x38c035[_0x4cc551(0x295)]+'\x0a';}),tgBot['sendMessage'](_0x33f57a[_0x27b50e(0x296)]['id'],_0x2c89ae,{'parse_mode':_0x27b50e(0x2ab)})['catch'](_0x5b4564=>{telegramError(_0x5b4564);});}),tgBot['onText'](/\/disable/,_0x2deaf1=>{const _0x4b1c27=_0x2e8401;if(!validateTelegram(_0x2deaf1))return;tgBot[_0x4b1c27(0x2cc)](_0x2deaf1[_0x4b1c27(0x296)]['id'],_0x4b1c27(0x25c))[_0x4b1c27(0x12f)](_0x4e6b1c=>{telegramError(_0x4e6b1c);}),updateSetting(_0x4b1c27(0x254),![]);}),tgBot[_0x2e8401(0x273)](/\/help/,_0x5c130d=>{const _0x4abbc5=_0x2e8401;if(!validateTelegram(_0x5c130d))return;tgBot[_0x4abbc5(0x2cc)](_0x5c130d[_0x4abbc5(0x296)]['id'],_0x1de5ba)['catch'](_0x59aa91=>{telegramError(_0x59aa91);});}),tgBot['on'](_0x2e8401(0x100),_0x4f8e98=>{const _0x1125b9=_0x2e8401;_0x4f8e98['toString']()[_0x1125b9(0x2c2)]('404\x20Not\x20Found')&&(logger[_0x1125b9(0x1c1)](_0x1125b9(0x11b)),tgBot[_0x1125b9(0x2c6)](),tgBot=null,io['to'](_0x1125b9(0x205))[_0x1125b9(0x24f)]('notification',_0x1125b9(0x11b)));}),process[_0x2e8401(0x151)](_0x2e8401(0x23e),()=>{const _0x39ca90=_0x2e8401;if(tgBot)tgBot[_0x39ca90(0x2c6)]();process[_0x39ca90(0x265)](0x1);}),process[_0x2e8401(0x151)](_0x2e8401(0x135),()=>{const _0x3fd0e7=_0x2e8401;if(tgBot)tgBot[_0x3fd0e7(0x2c6)]();process['exit'](0x1);});}}function disableTelegram(){const _0x484ad6=_0x1c7409;tgBot&&(tgBot[_0x484ad6(0x2c6)](),tgBot=null);}function sendTelegram(_0xb0a44b,_0xa14f27){const _0x53ec19=_0x1c7409;if(settings[_0x53ec19(0x254)]){if(settings[_0x53ec19(0x173)]=='all'||(_0xa14f27['type']==_0x53ec19(0x1c8)||_0xa14f27['type']=='warning'||_0xa14f27['type']=='success')&&settings[_0x53ec19(0x173)]==_0x53ec19(0x1a8)||_0xa14f27[_0x53ec19(0x230)]=='order'&&settings[_0x53ec19(0x173)]=='orders'){if(tgBot&&settings[_0x53ec19(0x210)]){if(_0xa14f27[_0x53ec19(0x1d0)])tgBot['sendMessage'](settings[_0x53ec19(0x210)],_0xa14f27[_0x53ec19(0x295)]+_0x53ec19(0x28b)+_0xa14f27['event'])[_0x53ec19(0x12f)](_0x206703=>{telegramError(_0x206703);});else tgBot[_0x53ec19(0x2cc)](settings[_0x53ec19(0x210)],_0x53ec19(0x290)+_0xb0a44b+_0x53ec19(0x28b)+_0xa14f27['event'])[_0x53ec19(0x12f)](_0x3f9ba2=>{telegramError(_0x3f9ba2);});}}}}async function sendTelegramMsg(_0x512713,_0x2fa739=_0x1c7409(0x2ab)){const _0x426e5e=_0x1c7409;return settings[_0x426e5e(0x254)]&&tgBot&&settings[_0x426e5e(0x210)]?(await tgBot[_0x426e5e(0x2cc)](settings[_0x426e5e(0x210)],_0x512713,{'parse_mode':_0x2fa739})[_0x426e5e(0x12f)](_0x2767=>{telegramError(_0x2767);}),!![]):![];}function getDeviceWithIp(_0x253b7b){return devices['find'](_0x4b972c=>_0x4b972c['ip']===_0x253b7b);}function temporaryAccess2FA(_0x822d82,_0x2a3838){const _0x3061a6=_0x1c7409;let _0x31c38d=new Date(),_0x1e27be=![];if(lastIpApproval){if(_0x31c38d-lastIpApproval<0x1388)_0x1e27be=!![];}lastIpApproval=new Date();if(_0x1e27be)return;tgBot&&settings[_0x3061a6(0x210)]&&(tgBot[_0x3061a6(0x131)](_0x3061a6(0x219)),tgBot[_0x3061a6(0x2cc)](settings[_0x3061a6(0x210)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x2a3838)[_0x3061a6(0x1ea)]+_0x3061a6(0x267),{'parse_mode':_0x3061a6(0x2ab),'reply_markup':{'inline_keyboard':[[{'text':_0x3061a6(0x232),'callback_data':'5'},{'text':_0x3061a6(0x194),'callback_data':'15'},{'text':_0x3061a6(0x17d),'callback_data':'30'},{'text':_0x3061a6(0x1e8),'callback_data':_0x3061a6(0x1e8)}]]}})[_0x3061a6(0x12f)](_0x5ef11b=>{telegramError(_0x5ef11b);}),tgBot['on'](_0x3061a6(0x219),async _0x32f0c6=>{const _0x4f17ef=_0x3061a6,_0x28f157=_0x32f0c6[_0x4f17ef(0x16e)],_0x480056=_0x32f0c6[_0x4f17ef(0x1ae)];tgBot[_0x4f17ef(0x29a)](_0x32f0c6['id'])[_0x4f17ef(0x268)](async()=>{const _0x1a2c47=_0x4f17ef;devices[_0x822d82][_0x1a2c47(0x1f7)]={'clientip':_0x2a3838,'timestamp':new Date()[_0x1a2c47(0x1e9)](),'expiry':_0x28f157},_0x28f157!=_0x1a2c47(0x1e8)?(await tgBot[_0x1a2c47(0x2cc)](_0x480056[_0x1a2c47(0x296)]['id'],'Access\x20enabled\x20for\x20'+_0x28f157+'\x20minutes',{'parse_mode':_0x1a2c47(0x2ab)})[_0x1a2c47(0x12f)](_0x24860c=>{telegramError(_0x24860c);}),io['to'](_0x822d82)[_0x1a2c47(0x24f)]('status',{'access':{'allow':![],'reason':_0x1a2c47(0x2d8),'token':null}})):(await tgBot[_0x1a2c47(0x2cc)](_0x480056[_0x1a2c47(0x296)]['id'],'Temporary\x20access\x20rejected')[_0x1a2c47(0x12f)](_0xc913d1=>{telegramError(_0xc913d1);}),io['to'](_0x822d82)['emit'](_0x1a2c47(0x1a4),{'access':{'allow':![],'reason':_0x1a2c47(0x1db),'token':null}}));}),tgBot[_0x4f17ef(0x131)](_0x4f17ef(0x219));}));}function _0x356b(_0x112150,_0x421946){const _0x24c179=_0x126c();return _0x356b=function(_0x15a4af,_0x1fb3a0){_0x15a4af=_0x15a4af-0xfd;let _0x126c8d=_0x24c179[_0x15a4af];return _0x126c8d;},_0x356b(_0x112150,_0x421946);}function loginAccess2FA(_0x3210d3,_0x5da840){const _0xe00cae=_0x1c7409;tgBot&&settings[_0xe00cae(0x210)]&&(tgBot['removeListener'](_0xe00cae(0x219)),tgBot[_0xe00cae(0x2cc)](settings[_0xe00cae(0x210)],_0xe00cae(0x269)+normalizeIP(_0x5da840)[_0xe00cae(0x1ea)]+_0xe00cae(0x267),{'parse_mode':_0xe00cae(0x2ab),'reply_markup':{'inline_keyboard':[[{'text':_0xe00cae(0x20d),'callback_data':loginExpiry},{'text':_0xe00cae(0x1e8),'callback_data':_0xe00cae(0x1e8)}]]}})[_0xe00cae(0x12f)](_0x2266b6=>{telegramError(_0x2266b6);}),tgBot['on']('callback_query',async _0x1c709a=>{const _0x3d549d=_0xe00cae,_0x2cffbd=_0x1c709a[_0x3d549d(0x16e)],_0x8f814=_0x1c709a[_0x3d549d(0x1ae)];tgBot[_0x3d549d(0x29a)](_0x1c709a['id'])[_0x3d549d(0x268)](async()=>{const _0x485aaf=_0x3d549d;devices[_0x3210d3][_0x485aaf(0x197)]={'clientip':_0x5da840,'timestamp':new Date()[_0x485aaf(0x1e9)](),'expiry':_0x2cffbd},_0x2cffbd!=_0x485aaf(0x1e8)?(await tgBot[_0x485aaf(0x2cc)](_0x8f814[_0x485aaf(0x296)]['id'],_0x485aaf(0x2da),{'parse_mode':_0x485aaf(0x2ab)})['catch'](_0x5d0947=>{telegramError(_0x5d0947);}),io['to'](_0x3210d3)[_0x485aaf(0x24f)](_0x485aaf(0x1a4),{'access':{'allow':![],'reason':_0x485aaf(0x2d8),'token':null}})):(await tgBot[_0x485aaf(0x2cc)](_0x8f814[_0x485aaf(0x296)]['id'],_0x485aaf(0x246))[_0x485aaf(0x12f)](_0xb86460=>{telegramError(_0xb86460);}),io['to'](_0x3210d3)[_0x485aaf(0x24f)](_0x485aaf(0x1a4),{'access':{'allow':![],'reason':_0x485aaf(0x23c),'token':null}}));}),tgBot[_0x3d549d(0x131)](_0x3d549d(0x219));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x30e7cd=_0x1c7409;return dbConfig[_0x30e7cd(0x190)](_0x30e7cd(0x177))['sortBy'](_0x30e7cd(0x1e1))[_0x30e7cd(0x140)]({'status':_0x30e7cd(0x247)})[_0x30e7cd(0x163)]()||[];}function getDisabledBots(){const _0x12cc72=_0x1c7409;return dbConfig[_0x12cc72(0x190)](_0x12cc72(0x177))[_0x12cc72(0x228)](_0x12cc72(0x1e1))['filter']({'status':_0x12cc72(0x22c)})[_0x12cc72(0x163)]()||[];}function getBotAttributes(_0x966781){const _0x3c2db1=_0x1c7409;let _0x5249ff={};const _0x1bb78c=configpath+_0x3c2db1(0x129)+_0x966781+_0x3c2db1(0x1bc),_0x2f2310=fs[_0x3c2db1(0x241)](_0x1bb78c);if(_0x2f2310){const _0x5cda8d=fs[_0x3c2db1(0x206)](_0x1bb78c);try{const _0x24723b=JSON['parse'](_0x5cda8d),_0x27902d=_0x24723b?_0x24723b['bot'][0x0][_0x3c2db1(0x182)]:![];_0x5249ff['mode']=_0x27902d?_0x3c2db1(0x12c):_0x3c2db1(0x250),_0x5249ff[_0x3c2db1(0x295)]=_0x24723b?_0x24723b[_0x3c2db1(0x148)][0x0][_0x3c2db1(0x295)]:_0x3c2db1(0x290)+_0x966781;}catch(_0x1b7190){_0x5249ff[_0x3c2db1(0x21d)]=_0x3c2db1(0x250),_0x5249ff[_0x3c2db1(0x295)]='Bot\x20'+_0x966781;}}else _0x5249ff[_0x3c2db1(0x21d)]=_0x3c2db1(0x250),_0x5249ff[_0x3c2db1(0x295)]='Bot\x20'+_0x966781;return _0x5249ff;}function getBotsWithMode(){const _0x3507dd=_0x1c7409,_0x2b2868=dbConfig[_0x3507dd(0x190)](_0x3507dd(0x177))[_0x3507dd(0x228)](_0x3507dd(0x1e1))['value']()||[];return _0x2b2868[_0x3507dd(0x276)](_0x319944=>{const _0x4ec53c=_0x3507dd;let _0x9dcb1c=getBotAttributes(_0x319944['botID']);_0x319944[_0x4ec53c(0x21d)]=_0x9dcb1c[_0x4ec53c(0x21d)];}),_0x2b2868;}function getBotExchanges(){const _0x10bce8=_0x1c7409;let _0x2d4352=[];const _0x41753d=dbConfig[_0x10bce8(0x190)](_0x10bce8(0x177))[_0x10bce8(0x228)](_0x10bce8(0x1e1))[_0x10bce8(0x163)]()||[];_0x41753d[_0x10bce8(0x276)](_0x342018=>{const _0x3d7140=_0x10bce8;if(_0x342018[_0x3d7140(0x1a4)]==_0x3d7140(0x247)){const _0x4a2b78=configpath+_0x3d7140(0x129)+_0x342018[_0x3d7140(0x1e1)]+_0x3d7140(0x1bc),_0x272c07=fs[_0x3d7140(0x241)](_0x4a2b78);let _0x15a7ac;if(_0x272c07){const _0xa3ddd4=fs['readFileSync'](_0x4a2b78);try{const _0x12333c=JSON['parse'](_0xa3ddd4);_0x15a7ac=_0x12333c?_0x12333c[_0x3d7140(0x148)][0x0][_0x3d7140(0x26c)]:null;}catch(_0x1a9ab4){}}if(_0x15a7ac)_0x2d4352[_0x3d7140(0x29d)](_0x15a7ac);}});const _0x4837df=[...new Set(_0x2d4352)][_0x10bce8(0x217)]();return _0x4837df;}async function initUser(){const _0x199d4c=_0x1c7409;if(!settings[_0x199d4c(0x14a)]){const _0x5e824f=uuidRandom();mixpanel[_0x199d4c(0x1f9)](_0x5e824f),updateSetting(_0x199d4c(0x14a),_0x5e824f);}}async function initSecure(){const _0x210a9a=_0x1c7409;let _0x33951d=getSecure();if(!_0x33951d[_0x210a9a(0x14e)](_0x210a9a(0x202))){let _0x205a3e=await generateKeys();_0x33951d[_0x210a9a(0x1ef)]=_0x205a3e[_0x210a9a(0x1ef)],_0x33951d[_0x210a9a(0x16f)]=_0x205a3e[_0x210a9a(0x16f)],_0x33951d[_0x210a9a(0x202)]=crypto[_0x210a9a(0x259)](0x20)[_0x210a9a(0x209)](_0x210a9a(0x22b));;storeSecure(_0x33951d);}}function getSettings(){const _0x4f0be7=_0x1c7409;return dbSettings[_0x4f0be7(0x190)](_0x4f0be7(0x2d6))[_0x4f0be7(0x163)]()||{};}function getSecure(){const _0x2876cd=_0x1c7409;return dbSecure[_0x2876cd(0x190)](_0x2876cd(0x20a))[_0x2876cd(0x163)]()||{};}function getBlacklist(){const _0x40cd50=_0x1c7409;return dbSecure[_0x40cd50(0x190)](_0x40cd50(0x1af))[_0x40cd50(0x163)]()||[];}function broadcastToBots(_0x279e46,_0x403c56){const _0x3abd3e=_0x1c7409;config[_0x3abd3e(0x276)](_0x3f5b33=>{const _0x2955b6=_0x3abd3e;if(_0x3f5b33[_0x2955b6(0x1a4)]==_0x2955b6(0x247)&&_0x3f5b33[_0x2955b6(0x159)]==_0x2955b6(0x184)||_0x3f5b33['status']=='new'&&_0x3f5b33['live']=='running'){if(pid[_0x3f5b33[_0x2955b6(0x1e1)]])pid[_0x3f5b33[_0x2955b6(0x1e1)]][_0x2955b6(0x2cd)]({[_0x279e46]:_0x403c56});}});}function storeSettings(_0x55a0c0,_0x165cd1=![]){const _0x33019a=_0x1c7409;_0x55a0c0={...settings,..._0x55a0c0};if(_0x165cd1&&_0x55a0c0[_0x33019a(0x174)]!=_0x33019a(0x2cf)&&_0x55a0c0[_0x33019a(0x174)]!=_0x33019a(0x185)&&_0x55a0c0[_0x33019a(0x174)]!=''){const _0x130cdd=crypt[_0x33019a(0x2d0)](secure[_0x33019a(0x16f)],_0x55a0c0['bbPassword'])['message']['split']('@')[0x0],_0x2ad215=bcrypt[_0x33019a(0x291)](_0x130cdd,saltRounds);_0x55a0c0={..._0x55a0c0,'bbPassword':_0x2ad215};}if(_0x165cd1&&_0x55a0c0[_0x33019a(0x126)]!='************'&&_0x55a0c0[_0x33019a(0x126)]!=_0x33019a(0x185)&&_0x55a0c0[_0x33019a(0x126)]!=''){const _0x5e8721=crypt[_0x33019a(0x2d0)](secure[_0x33019a(0x16f)],_0x55a0c0[_0x33019a(0x126)])[_0x33019a(0x1ae)][_0x33019a(0x199)]('@')[0x0];_0x55a0c0={..._0x55a0c0,'telegramToken':_0x5e8721};}const _0x243f16=_0x55a0c0[_0x33019a(0x126)]!='************'&&_0x55a0c0[_0x33019a(0x126)]!=settings[_0x33019a(0x126)]||_0x55a0c0[_0x33019a(0x20f)]!=settings[_0x33019a(0x20f)],_0x3ae45b=_0x55a0c0['telegramToken']==''||_0x55a0c0[_0x33019a(0x20f)]=='';if(_0x243f16)_0x55a0c0[_0x33019a(0x173)]='all';for(const [_0x3c9881,_0x575a0f]of Object[_0x33019a(0x1d7)](_0x55a0c0)){if(_0x3c9881==_0x33019a(0x126)&&_0x575a0f==_0x33019a(0x2cf)){_0x55a0c0['telegramToken']=settings[_0x33019a(0x126)];continue;};if(_0x3c9881=='bbPassword'&&_0x575a0f==_0x33019a(0x2cf)){_0x55a0c0[_0x33019a(0x174)]=settings[_0x33019a(0x174)];continue;};dbSettings[_0x33019a(0x10a)](_0x33019a(0x2ba)+_0x3c9881,_0x575a0f)[_0x33019a(0x2bf)]();}settings=_0x55a0c0,io['to'](_0x33019a(0x205))[_0x33019a(0x24f)]('settings',cleanSettings()),broadcastToBots('timeshift',settings['timeshift']),broadcastToBots('onepagemode',settings['onepagemode']);if(_0x243f16&&!_0x3ae45b)initTelegram();if(_0x243f16&&_0x3ae45b)disableTelegram();getAllClients()[_0x33019a(0x276)](_0xff5cc0=>{const _0x27d58b=_0x33019a;getSocket(_0xff5cc0['id'])[_0x27d58b(0x24f)]('status',{'access':{'allow':![],'reason':_0x27d58b(0x2d8),'token':null}});});}function updateSetting(_0x1fb7e4,_0x4cf5bc){const _0x26f357=_0x1c7409;dbSettings[_0x26f357(0x10a)](_0x26f357(0x2ba)+_0x1fb7e4,_0x4cf5bc)[_0x26f357(0x2bf)](),settings=getSettings(),io['to']('botmanager')[_0x26f357(0x24f)](_0x26f357(0x2d6),cleanSettings());}function storeSecure(_0x144ecf){const _0x1fe9c9=_0x1c7409;dbSecure[_0x1fe9c9(0x190)](_0x1fe9c9(0x20a))[_0x1fe9c9(0x29d)](_0x144ecf)[_0x1fe9c9(0x2bf)](),secure=_0x144ecf;}function addBlacklist(_0x1c56cb){const _0xa77edd=_0x1c7409;cleanBlacklist();let _0x178dcf;devices[_0x1c56cb]['telegramIpApproval']?_0x178dcf=Math[_0xa77edd(0x130)](devices[_0x1c56cb][_0xa77edd(0x1f7)][_0xa77edd(0x160)],loginExpiry):_0x178dcf=loginExpiry,dbSecure[_0xa77edd(0x190)](_0xa77edd(0x1af))['push']({'expiry':new Date()[_0xa77edd(0x1e9)]()+_0x178dcf*0x3c*0x3e8,'token':devices[_0x1c56cb]['access'][_0xa77edd(0x288)]})[_0xa77edd(0x2bf)](),blacklist=dbSecure[_0xa77edd(0x190)](_0xa77edd(0x1af))[_0xa77edd(0x163)]();}function cleanBlacklist(){const _0xf30fb5=_0x1c7409;let _0x37e510=dbSecure[_0xf30fb5(0x190)](_0xf30fb5(0x1af))[_0xf30fb5(0x116)]()[_0xf30fb5(0x163)](),_0xa3f5fa=new Date()[_0xf30fb5(0x1e9)]();_0x37e510['forEach'](_0x17c83f=>{const _0x58e21c=_0xf30fb5;_0x17c83f['expiry']<_0xa3f5fa&&dbSecure[_0x58e21c(0x190)](_0x58e21c(0x1af))['remove']({'expiry':_0x17c83f[_0x58e21c(0x160)]})[_0x58e21c(0x2bf)]();});}function initStates(){const _0x992d5f=_0x1c7409;let _0x54929f=getConfiguration();_0x54929f[_0x992d5f(0x276)](_0xd92fe4=>{const _0x38f15e=_0x992d5f;_0xd92fe4[_0x38f15e(0x159)]='stopped';}),storeConfiguration(_0x54929f);}function onKeys(){const _0x503cd7=new RSA();return new Promise(_0x1ef0b3=>{const _0x3020cf=_0x356b;_0x503cd7[_0x3020cf(0x137)]()[_0x3020cf(0x268)](_0xc2f258=>{_0x1ef0b3(_0xc2f258);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x43fb07=_0x1c7409;let _0x533d63=getSettings(),_0x708594=![];!_0x533d63[_0x43fb07(0x14e)](_0x43fb07(0x2e1))&&(_0x533d63[_0x43fb07(0x2e1)]=0x0,_0x708594=!![]);!_0x533d63[_0x43fb07(0x14e)](_0x43fb07(0x19f))&&(_0x533d63[_0x43fb07(0x19f)]=0x0,_0x708594=!![]);!_0x533d63[_0x43fb07(0x14e)](_0x43fb07(0x24b))&&(_0x533d63[_0x43fb07(0x24b)]=_0x43fb07(0x292),_0x708594=!![]);!_0x533d63[_0x43fb07(0x14e)]('onepagemode')&&(_0x533d63[_0x43fb07(0x15b)]=![],_0x708594=!![]);if(_0x708594)storeSettings(_0x533d63);try{fs[_0x43fb07(0x188)](configbackuppath,{'withFileTypes':!![]})[_0x43fb07(0x276)](_0x4d418e=>{const _0x583fc2=_0x43fb07;if(!_0x4d418e['isDirectory']()){if(!_0x4d418e[_0x583fc2(0x172)]['startsWith'](_0x583fc2(0x25f)))fs[_0x583fc2(0x1cb)](configbackuppath+_0x4d418e[_0x583fc2(0x172)]);}else fs[_0x583fc2(0x18c)](configbackuppath+_0x4d418e[_0x583fc2(0x172)],{'recursive':!![]});});}catch(_0x399d27){logger[_0x43fb07(0x143)](_0x43fb07(0x2a8),_0x399d27);}}function storeConfiguration(_0x3cd31c){const _0x554455=_0x1c7409;dbConfig[_0x554455(0x190)]('bots')[_0x554455(0x243)]()[_0x554455(0x2bf)](),_0x3cd31c[_0x554455(0x276)](_0xb8ab6d=>{delete _0xb8ab6d['mode'];}),dbConfig[_0x554455(0x190)]('bots')[_0x554455(0x29d)](..._0x3cd31c)[_0x554455(0x2bf)](),config=_0x3cd31c;}function resetPassword(){const _0x58e28e=_0x1c7409;tgBot&&settings[_0x58e28e(0x210)]&&(tgBot[_0x58e28e(0x131)]('callback_query'),tgBot['sendMessage'](settings[_0x58e28e(0x210)],_0x58e28e(0x181),{'parse_mode':_0x58e28e(0x2ab),'reply_markup':{'inline_keyboard':[[{'text':_0x58e28e(0x215),'callback_data':_0x58e28e(0x215)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x46b696=>{telegramError(_0x46b696);}),tgBot['on'](_0x58e28e(0x219),async _0x1c940e=>{const _0xbb8bd4=_0x58e28e,_0x247582=_0x1c940e[_0xbb8bd4(0x16e)],_0x43b85a=_0x1c940e['message'];tgBot[_0xbb8bd4(0x29a)](_0x1c940e['id'])[_0xbb8bd4(0x268)](async()=>{const _0x503047=_0xbb8bd4;if(_0x247582!='no'){const _0xcef5ed=0xf,_0x546467='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x550533=Array[_0x503047(0x2c5)](crypto[_0x503047(0x14d)](new Uint32Array(_0xcef5ed)))['map'](_0x43521c=>_0x546467[_0x43521c%_0x546467['length']])[_0x503047(0x122)](''),_0x42d61a=bcrypt[_0x503047(0x291)](_0x550533,saltRounds);storeSettings({'bbPassword':_0x42d61a}),await tgBot[_0x503047(0x2cc)](_0x43b85a['chat']['id'],_0x503047(0x12e)+_0x550533,{'parse_mode':_0x503047(0x2ab)})[_0x503047(0x12f)](_0xef59ce=>{telegramError(_0xef59ce);});}else await tgBot[_0x503047(0x2cc)](_0x43b85a[_0x503047(0x296)]['id'],_0x503047(0x251))['catch'](_0x2549c5=>{telegramError(_0x2549c5);});}),tgBot[_0xbb8bd4(0x131)]('callback_query');}));}async function confirmRestore(_0x162a3f,_0x1d2456){const _0xb80962=_0x1c7409;io['to'](_0xb80962(0x205))['emit'](_0xb80962(0x156),_0xb80962(0x2db),_0xb80962(0x136)),tgBot&&settings[_0xb80962(0x210)]&&(tgBot['removeListener']('callback_query'),await tgBot[_0xb80962(0x2cc)](settings['telegramChatId'],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':_0xb80962(0x2ab),'reply_markup':{'inline_keyboard':[[{'text':_0xb80962(0x215),'callback_data':_0xb80962(0x215)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x24643b=>{telegramError(_0x24643b);}),tgBot['on'](_0xb80962(0x219),async _0x1ca011=>{const _0x398d18=_0xb80962,_0x27155f=_0x1ca011[_0x398d18(0x16e)],_0x146f03=_0x1ca011[_0x398d18(0x1ae)];tgBot[_0x398d18(0x29a)](_0x1ca011['id'])[_0x398d18(0x268)](async()=>{const _0x2559ed=_0x398d18;_0x27155f=='yes'?(await tgBot['sendMessage'](_0x146f03[_0x2559ed(0x296)]['id'],_0x2559ed(0x224),{'parse_mode':_0x2559ed(0x2ab)})[_0x2559ed(0x12f)](_0xd9d34b=>{telegramError(_0xd9d34b);}),unzipFile(_0x162a3f,_0x1d2456)):(logger[_0x2559ed(0x143)](_0x2559ed(0x22a)),await tgBot['sendMessage'](_0x146f03[_0x2559ed(0x296)]['id'],_0x2559ed(0x22a))[_0x2559ed(0x12f)](_0x1685b3=>{telegramError(_0x1685b3);}));}),tgBot[_0x398d18(0x131)]('callback_query');}));}function getServerTime(){const _0x359f2a=_0x1c7409,_0x5702fd=new Date();return _0x5702fd[_0x359f2a(0x17e)]()+'/'+(_0x5702fd[_0x359f2a(0x221)]()+0x1)['toString']()[_0x359f2a(0x110)](0x2,'0')+'/'+_0x5702fd[_0x359f2a(0x203)]()['toString']()[_0x359f2a(0x110)](0x2,'0')+'\x20'+_0x5702fd['getHours']()['toString']()['padStart'](0x2,'0')+':'+_0x5702fd[_0x359f2a(0x171)]()[_0x359f2a(0x209)]()[_0x359f2a(0x110)](0x2,'0')+':'+_0x5702fd[_0x359f2a(0x1e2)]()['toString']()[_0x359f2a(0x110)](0x2,'0');}function getTimeStamp(){const _0x105814=_0x1c7409,_0x2f9515=shiftedTime();return _0x2f9515[_0x105814(0x17e)]()+'/'+(_0x2f9515[_0x105814(0x221)]()+0x1)[_0x105814(0x209)]()[_0x105814(0x110)](0x2,'0')+'/'+_0x2f9515[_0x105814(0x203)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x2f9515['getHours']()[_0x105814(0x209)]()[_0x105814(0x110)](0x2,'0')+':'+_0x2f9515['getMinutes']()[_0x105814(0x209)]()[_0x105814(0x110)](0x2,'0')+':'+_0x2f9515[_0x105814(0x1e2)]()['toString']()[_0x105814(0x110)](0x2,'0');}function getCleanTimeStamp(){const _0x33b177=_0x1c7409,_0x49e625=shiftedTime();return _0x49e625[_0x33b177(0x17e)]()+(_0x49e625[_0x33b177(0x221)]()+0x1)['toString']()[_0x33b177(0x110)](0x2,'0')+_0x49e625[_0x33b177(0x203)]()['toString']()['padStart'](0x2,'0')+'-'+_0x49e625[_0x33b177(0x111)]()[_0x33b177(0x209)]()[_0x33b177(0x110)](0x2,'0')+_0x49e625[_0x33b177(0x171)]()[_0x33b177(0x209)]()['padStart'](0x2,'0')+_0x49e625[_0x33b177(0x1e2)]()[_0x33b177(0x209)]()[_0x33b177(0x110)](0x2,'0');}function shiftedTime(){const _0x461df8=_0x1c7409,_0x8172dd=new Date();let _0x1efaba=_0x8172dd;if(settings[_0x461df8(0x200)]&&settings[_0x461df8(0x200)]!==0x0)_0x1efaba=fns[_0x461df8(0x11d)](_0x8172dd,{'hours':settings[_0x461df8(0x200)]});return _0x1efaba;}function startScheduler(){const _0x296664=_0x1c7409,_0x35f8fd=new Date()['getUTCHours'](),_0x5b6baa=shiftedTime()[_0x296664(0x111)]();_0x5b6baa==0x4&&backupConfigFiles();_0x5b6baa==0x0&&rotateLogFiles();_0x35f8fd%0x6==0x0&&triggerAnalytics();_0x35f8fd%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x13e885){const _0x9e8c27=_0x1c7409;logger[_0x9e8c27(0x143)]('Restore\x20backup\x20file\x20'+_0x13e885);const _0x1be14e=getBotsWithMode();_0x1be14e[_0x9e8c27(0x1ed)]>0x0?confirmRestore(configbackuppath,_0x13e885):unzipFile(configbackuppath,_0x13e885);}async function getBackupFiles(_0x514221=null){const _0x5a8c01=_0x1c7409;let _0x1f2d82=[],_0x557530=fs[_0x5a8c01(0x188)](configbackuppath,{'withFileTypes':!![]});_0x557530[_0x5a8c01(0x217)]((_0x3a9cd2,_0x30a85e)=>_0x3a9cd2[_0x5a8c01(0x172)]<_0x30a85e[_0x5a8c01(0x172)]?0x1:_0x30a85e[_0x5a8c01(0x172)]<_0x3a9cd2[_0x5a8c01(0x172)]?-0x1:0x0),_0x557530[_0x5a8c01(0x276)](_0x5b8108=>{const _0x2cfa96=_0x5a8c01;if(!_0x5b8108['isDirectory']()&&_0x5b8108['name'][_0x2cfa96(0x149)](_0x2cfa96(0x25f))&&_0x5b8108[_0x2cfa96(0x172)][_0x2cfa96(0x285)](_0x2cfa96(0x214))){const _0x13ce88=formatDate(fs['statSync'](configbackuppath+_0x5b8108[_0x2cfa96(0x172)])[_0x2cfa96(0x2c0)]);_0x1f2d82[_0x2cfa96(0x29d)]({'name':_0x5b8108[_0x2cfa96(0x172)],'mtime':_0x13ce88});}});if(_0x514221)io['to'](_0x514221)[_0x5a8c01(0x24f)](_0x5a8c01(0x13c),_0x1f2d82);else return _0x1f2d82;}async function backupConfigFiles(){const _0x3e4ee5=_0x1c7409;await zipFiles('backup-full');const _0x14fa6d=getCleanTimeStamp();fs[_0x3e4ee5(0x103)](zippath+'backup-full.zip',configbackuppath+(_0x3e4ee5(0x25f)+_0x14fa6d+_0x3e4ee5(0x214)));let _0x5ddce1=fs[_0x3e4ee5(0x188)](configbackuppath,{'withFileTypes':!![]});_0x5ddce1[_0x3e4ee5(0x217)]((_0x4bf3fc,_0xeeaeab)=>_0x4bf3fc[_0x3e4ee5(0x172)]<_0xeeaeab[_0x3e4ee5(0x172)]?0x1:_0xeeaeab['name']<_0x4bf3fc['name']?-0x1:0x0),_0x5ddce1[_0x3e4ee5(0x1ed)]>maxBackups&&fs[_0x3e4ee5(0x1cb)](configbackuppath+_0x5ddce1[_0x5ddce1['length']-0x1][_0x3e4ee5(0x172)]);}function rotateLogFiles(){const _0x2dd36b=_0x1c7409,_0x263d81=fs[_0x2dd36b(0x1f5)](logspath+_0x2dd36b(0x1ab)),_0x4a8316=_0x263d81[_0x2dd36b(0x10c)]/0x400;if(_0x4a8316>0x64){let _0x39cc69=fs[_0x2dd36b(0x188)](logspath,{'withFileTypes':!![]});_0x39cc69[_0x2dd36b(0x217)]((_0x4140cd,_0x4d6d63)=>_0x4140cd[_0x2dd36b(0x172)]<_0x4d6d63[_0x2dd36b(0x172)]?0x1:_0x4d6d63['name']<_0x4140cd[_0x2dd36b(0x172)]?-0x1:0x0),_0x39cc69[_0x2dd36b(0x276)](_0x2d9fe4=>{const _0x398875=_0x2dd36b;if(_0x2d9fe4['name']=='output-002.log')fs['copyFileSync'](logspath+_0x2d9fe4[_0x398875(0x172)],logspath+_0x398875(0x11f));if(_0x2d9fe4[_0x398875(0x172)]=='output-001.log')fs[_0x398875(0x103)](logspath+_0x2d9fe4[_0x398875(0x172)],logspath+_0x398875(0x1ba));_0x2d9fe4[_0x398875(0x172)]==_0x398875(0x1ab)&&(fs[_0x398875(0x103)](logspath+_0x2d9fe4['name'],logspath+_0x398875(0x271)),fs[_0x398875(0x29e)](logspath+_0x2d9fe4[_0x398875(0x172)],''));});}}async function zipFiles(_0x14a872){const _0x5a4535=_0x1c7409;let _0x569be6;if(_0x14a872==_0x5a4535(0x29c))_0x569be6=logspath;if(_0x14a872==_0x5a4535(0x115))_0x569be6=configpath;if(_0x14a872=='backup-full')_0x569be6=configpath;let _0x56452e=fs[_0x5a4535(0x188)](_0x569be6,{'withFileTypes':!![]});const _0x5ef739=new require('node-zip')();_0x56452e[_0x5a4535(0x276)](_0x4bfe92=>{const _0x49c32d=_0x5a4535;if(!_0x4bfe92[_0x49c32d(0x176)]()){let _0x452d3f=fs[_0x49c32d(0x206)](_0x569be6+_0x4bfe92['name']);if(_0x14a872=='backup'){const _0x46cfec=/^bot-[0-9]{3}-config.json$/,_0x3fd96f=_0x46cfec['test'](_0x4bfe92[_0x49c32d(0x172)]);if(_0x3fd96f){const _0xacddd4=JSON[_0x49c32d(0x15c)](_0x452d3f);if(_0xacddd4[_0x49c32d(0x148)][0x0]){_0xacddd4[_0x49c32d(0x148)][0x0][_0x49c32d(0x19a)]='***',_0xacddd4[_0x49c32d(0x148)][0x0]['apiSecret']=_0x49c32d(0x185);if(_0xacddd4[_0x49c32d(0x148)][0x0]['apiPassword'])_0xacddd4['bot'][0x0][_0x49c32d(0x212)]=_0x49c32d(0x185);}_0x452d3f=JSON['stringify'](_0xacddd4,null,0x2);}if(_0x4bfe92[_0x49c32d(0x172)]=='bb-settings.json'){const _0x1a1a74=JSON[_0x49c32d(0x15c)](_0x452d3f);if(_0x1a1a74[_0x49c32d(0x2d6)]['loginRequired'])_0x1a1a74['settings']['loginRequired']=![];if(_0x1a1a74[_0x49c32d(0x2d6)][_0x49c32d(0x174)])_0x1a1a74['settings']['bbPassword']='***';if(_0x1a1a74['settings'][_0x49c32d(0x126)])_0x1a1a74[_0x49c32d(0x2d6)][_0x49c32d(0x126)]=_0x49c32d(0x185);if(_0x1a1a74[_0x49c32d(0x2d6)][_0x49c32d(0x210)])_0x1a1a74['settings'][_0x49c32d(0x210)]=null;_0x452d3f=JSON['stringify'](_0x1a1a74,null,0x2);}if(_0x4bfe92['name']!=_0x49c32d(0x1df))_0x5ef739[_0x49c32d(0x1e6)](_0x4bfe92[_0x49c32d(0x172)],_0x452d3f);}else _0x5ef739['file'](_0x4bfe92[_0x49c32d(0x172)],_0x452d3f);}});const _0x22d3df=_0x5ef739[_0x5a4535(0x293)]({'base64':![],'compression':_0x5a4535(0x2c7)});fs[_0x5a4535(0x29e)](zippath+(_0x14a872+_0x5a4535(0x214)),_0x22d3df,'binary');}async function unzipFile(_0x3bf473,_0x89122d){const _0x41188f=_0x1c7409;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x41188f(0x276)](_0x5ca740=>{const _0x36345a=_0x41188f;if(!_0x5ca740[_0x36345a(0x176)]())fs[_0x36345a(0x18c)](configpath+_0x5ca740[_0x36345a(0x172)]);});const _0x201420=fs[_0x41188f(0x206)](_0x3bf473+_0x89122d,_0x41188f(0x2b7)),_0x80dafc=new require(_0x41188f(0x28e))(_0x201420,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x80dafc['files'])[_0x41188f(0x276)](_0x15edb9=>{const _0x15bbdd=_0x41188f,_0x5e12ca=_0x80dafc[_0x15bbdd(0x1b9)][_0x15edb9];fs[_0x15bbdd(0x29e)](configpath+_0x5e12ca[_0x15bbdd(0x172)],_0x5e12ca[_0x15bbdd(0x2e2)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})['forEach'](_0x28bf9b=>{const _0x5b3a75=_0x41188f;if(!_0x28bf9b[_0x5b3a75(0x176)]())fs[_0x5b3a75(0x18c)](temppath+_0x28bf9b['name']);}),logger['debug'](_0x41188f(0x12a)),process[_0x41188f(0x2cd)]({'restore':!![]},_0x1e226d=>{});}async function getPublicIp(){const _0x430baf=_0x1c7409;try{const _0x36db46=await axios[_0x430baf(0x190)](_0x430baf(0x282));publicip=_0x36db46[_0x430baf(0x16e)]['ip'];}catch(_0x1ad864){}}async function triggerAnalytics(){const _0x118fb0=_0x1c7409;if(!publicip)await getPublicIp();const _0x5266da=getBotsWithMode();let _0x2157fd=0x0;_0x5266da[_0x118fb0(0x276)](_0x4734e2=>{const _0x4a8a39=_0x118fb0;if(_0x4734e2[_0x4a8a39(0x1a4)]===_0x4a8a39(0x247))_0x2157fd++;});const _0x2b6327=getBotExchanges();mixpanel[_0x118fb0(0x298)](_0x118fb0(0x266),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x5266da[_0x118fb0(0x1ed)],'numbotsenabled':_0x2157fd,'exchanges':_0x2b6327});}async function getMessages(){const _0x4cdfc5=_0x1c7409,_0x13585e=_0x4cdfc5(0x1b6),_0x3f1bc6=new GraphQLClient(_0x13585e),_0x3c3755={'authorization':_0x4cdfc5(0x10f)},_0x51f512=serverversion[_0x4cdfc5(0x199)]('.'),_0x518fed=_0x51f512[0x0]+'.'+_0x51f512[0x1],_0x558a53=Math[_0x4cdfc5(0xff)](settings['lastmsgtelegram'],settings[_0x4cdfc5(0x19f)]),_0x530f71={'last':parseInt(_0x558a53),'bbm':_0x518fed},_0x59d17c=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x271653;try{_0x271653=await _0x3f1bc6[_0x4cdfc5(0x2a4)](_0x59d17c,_0x530f71,_0x3c3755);}catch(_0x10500b){}if(_0x271653&&_0x271653['messages']){let _0x44b9b1=settings[_0x4cdfc5(0x2e1)];newMessages=[];for(const _0x5631d0 of _0x271653[_0x4cdfc5(0x27e)]){newMessages[_0x4cdfc5(0x29d)](_0x5631d0);if(_0x5631d0['bbvNew'])updateSetting(_0x4cdfc5(0x24b),_0x5631d0['bbvNew']);let _0x3b2609=_0x5631d0[_0x4cdfc5(0x2aa)]?serverversion>=_0x5631d0[_0x4cdfc5(0x2aa)]:![];if(!_0x3b2609&&_0x5631d0['number']>_0x44b9b1){if(_0x5631d0[_0x4cdfc5(0x2de)]==='any'||serverversion[_0x4cdfc5(0x149)](_0x5631d0[_0x4cdfc5(0x2de)])){let _0x365370=''+_0x5631d0[_0x4cdfc5(0x27a)]+'\x0a\x0a'+_0x5631d0['message'];const _0x4b7af1=await sendTelegramMsg(toTelegramMarkdown(_0x365370),_0x4cdfc5(0x180));if(_0x4b7af1)_0x44b9b1=_0x5631d0[_0x4cdfc5(0x1c6)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x4cdfc5(0x2e1),_0x44b9b1),emitMessages();}}function _0x126c(){const _0x53bc22=['Alerts','reject','getTime','show','Unauthorized\x20attempt\x20to\x20delete\x20bot','/:bot','length','Idling\x20bot\x20\x20\x20|\x20Bot\x20','publicKey','RSA-OAEP','match','argv','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','sendMetricsTelegram','statSync','Unauthorized\x20attempt\x20to\x20update\x20settings','telegramIpApproval','sha256','alias','address','Unauthorized\x20attempt\x20to\x20download\x20','loginRequired','stop','kind','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','timeshift','index.html','secret','getDate','logs/','botmanager','readFileSync','env','update','toString','secure','Notifications\x20types:\x20','lowdb','accept','6fHKbrp','telegramUsername','telegramChatId','2FA\x20login\x20token\x20generated','apiPassword','encryptedUuid','.zip','yes','f2aRequired','sort','params','callback_query','store-fiat','replace','version','mode','host','*$1*','showConfig','getMonth','get-logs','connection','Restoring\x20bot(s)\x20from\x20backup','all','2FA','Bot\x20Mgr\x20>\x20','sortBy','uuid','Restore\x20process\x20aborted','hex','disabled','handshake','316251WCrChE','orders','type','ipaddr.js','5\x20min','\x20(1)','add-bot','No\x20authentication\x20token','bot.js','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','args','Yes','placeOrder','ipv6','2FA\x20login\x20rejected','sockets','SIGINT','No\x20bots\x20running\x20right\x20now','keys','existsSync',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','remove','listen','search','Login\x20rejected','enabled','use','Token\x20blacklisted','show-config','latestversion','Unauthorized\x20attempt\x20to\x20get\x20messages','isValid','store-headless','emit','manual','Password\x20reset\x20rejected','1000','Unauthorized\x20attempt\x20to\x20update\x20bot','telegramEnabled','bcryptjs','get-messages','api-eu.mixpanel.com','Starting\x20Balance\x20Bot\x20','randomBytes','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','function','Notifications\x20disabled','\x1b[31m','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','backup-full@','bbUsername','whitelist','/update\x20-\x20update\x20Balance\x20Bot\x0a','/:bot/performance','2453qeFrDL','exit','Server','</b>\x20?','then','Allow\x20login\x20from\x20IP\x20address\x20<b>','build2','update-bb','exchange','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','constructor','-performance.json','-events.json','output-001.log','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','onText','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','forEach','allow','delete-alerts','removeAllListeners','title','Ok,\x20will\x20send\x20alert\x20notifications\x20only','pidRefreshToken','/disable\x20-\x20disable\x20notifications\x0a','messages','Session\x20expired\x20for\x20user\x20...','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','createWriteStream','https://api.ipify.org?format=json','username','backupfile','endsWith','\x1b[0m','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','token','node-telegram-bot-api','express-fileupload','\x20>\x20','2FA\x20login\x20required','mkdirSync','node-zip','65570fkopQM','Bot\x20','hashSync','0.0.0','generate',':\x20Bot\x20Mgr\x20>\x20','botname','chat','=>\x20Go\x20to\x20#CYA#http://','track','invalid\x20credentials','answerCallbackQuery','zip/','logs','push','writeFileSync','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','isIPv4MappedAddress','cancelLoading','/enable\x20-\x20enable\x20notifications\x0a','simple','request','File\x20uploaded','uncaughtException','/on\x20-\x20start\x20bot(s)\x0a','Error\x20removing\x20old\x20backup\x20files:','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','bbvNew','HTML','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','deleteHistoryAlerts','-----------------------------------------------------------------------------------','exec','storeFiat','\x1b[34m','::ffff:127.0.0.1','reset-password','clientip','binary','1426940qNVsxM','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','settings.','login\x20token\x20generated','access','graphql-request','\x20to\x20','write','mtime','sendFile','includes','\x1b[36m','\x20|\x20user:\x20...','from','stopPolling','DEFLATE','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','login\x20not\x20required','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','sendPortfolioTelegram','sendMessage','send','private','************','decrypt','yargs/yargs','hybrid-crypto-js','inherit','login\x20required','resetHistory','settings','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','reload','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Login\x20accepted','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','telegram','init','bbvReceive','path','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','lastmsgtelegram','_data','6oAiLvd','Starting\x20new\x20bot\x20|\x20Bot\x20','min','polling_error','toIPv4Address','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','copyFileSync','reinstall','Setting\x20access:\x20','/:bot/configuration','Invalid\x20IP\x20address','Error\x20while\x20deleting\x20config\x20files:\x20','reinstall-bb','set','temp/','size','ipc','Notifications\x20enabled','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','padStart','getHours','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','RSA','<b>Balance\x20Bot\x20Status:</b>\x0a','backup','cloneDeep','versions','disconnect','\x20(2)','jsonwebtoken','Invalid\x20Telegram\x20token','[ip-address]','add','access\x20timeout','output-003.log','Error:\x20Invalid\x20argument\x20','NTBA_FIX_319','join','temporary\x20token\x20generated','temporaryAccessAllowed','getStartingBalances','telegramToken','verify','Unauthorized\x20attempt\x20to\x20confirm\x20message','bot-','Backup\x20file\x20unzipped\x20and\x20stored','/help\x20-\x20show\x20available\x20commands\x0a','auto','Starting\x20Balance\x20Bot\x20reinstallation','Password\x20has\x20been\x20reset\x20to:\x20','catch','max','removeListener','bb/','format','confirm-message','SIGTERM','success','generateKeyPairAsync','new','Unauthorized\x20attempt\x20to\x20add\x20bot','24ZrKToP','login\x20token\x20valid','backup-files','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','compareSync','find','filter','slice','Failed\x20to\x20download\x20','debug','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Network\x20Interfaces:','lowdb/adapters/FileSync','Unauthorized\x20attempt\x20to\x20log\x20out','bot','startsWith','userid','IPv4','Ok,\x20will\x20send\x20order\x20notifications\x20only','randomFillSync','hasOwnProperty','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','store','once','Orders','217227rKbxXy','<b>Telegram\x20Bot\x20Status:</b>\x0a','apply','notification','Invalid\x20authentication\x20token\x20(2)','Starting\x20Balance\x20Bot\x20update','live','emitHistory','onepagemode','parse','version.json','Crypt','reason','expiry','pidExpireLogin','Invalid\x20authentication\x20token\x20(1)','value','bb-settings.json','sign','::1','remoteAddress','stringify','mixpanel','Disabled\x20Bot\x20','logout','http','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','data','privateKey','string','getMinutes','name','telegramEvents','bbPassword','/:bot/history','isDirectory','bots','log','store-configuration','#RES#\x20if\x20running\x20locally\x0a','timestamp','/:bot/coins','30\x20min','getFullYear','store-settings','Markdown','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','headless','378128DkSdTS','running','***','logged\x20out','All\x20bots','readdirSync','new-disabled','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','storeConfiguration','rmSync','127.0.0.1','Notifications\x20enabled\x0a','config/','get','node','build','express','15\x20min','get-starting-balances','delete-bot','telegram2FaApproval','Unauthorized\x20attempt\x20to\x20store\x20configuration','split','apiKey',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Unauthorized\x20login\x20attempt\x20(timeout)','$1_$2_$3','2FA\x20required','lastmsgemitted','assign','static','\x20mode','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','status','restore-backup-file','port','/upload-backup','alerts','getPortfolio','538810qwPCJj','output-000.log','uuid-random','toIPv4MappedAddress','message','blacklist','Logged\x20out\x20user\x20...','login','update-bot','server','get-portfolio','(((.+)+)+)+$','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','updatebotmanager','-results.json','files','output-002.log','\x20|\x20','-config.json','Logged\x20in\x20user\x20...','backup/','Restarting\x20Bot\x20','stopped','full','User\x20has\x20been\x20validated','\x1b[35m','internal','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','number','\x20only\x0a','error','temporary\x20access\x20timeout','6b67f3d61ee94b8f5c80b4affef4c4d9','unlinkSync','Invalid\x20username\x20or\x20IP\x20address','socket.io','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','5330759ntJdCy','showname','user','download','started','password','test','Deleted\x20Bot\x20','entries','socket','headers','toggleBotMode','temporary\x20access\x20rejected','defaults','/status\x20-\x20show\x20bot(s)\x20status\x0a','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','bb-secure.json','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','botID','getSeconds','range','kill','All\x20bots\x20running\x20right\x20now','file'];_0x126c=function(){return _0x53bc22;};return _0x126c();}function emitMessages(){const _0x2e648d=_0x1c7409,_0xf9a54=settings['lastmsgemitted'];let _0x5f4423=[];newMessages['forEach'](_0x4780fd=>{const _0x220018=_0x356b;_0x4780fd[_0x220018(0x1c6)]>_0xf9a54&&_0x5f4423[_0x220018(0x29d)](_0x4780fd);}),_0x5f4423[_0x2e648d(0x1ed)]>0x0&&getAllClients()[_0x2e648d(0x276)](_0x111861=>{const _0x4758dc=_0x2e648d;getSocket(_0x111861['id'])[_0x4758dc(0x24f)](_0x4758dc(0x1ae),_0x5f4423);});}function confirmMessage(_0x2fe462){updateSetting('lastmsgemitted',Number(_0x2fe462));}function isNewerVersion(_0x5aeefa,_0x132a88){const _0x21458d=_0x1c7409,_0x3bc02c=_0x132a88[_0x21458d(0x199)]('.'),_0x493c89=_0x5aeefa[_0x21458d(0x199)]('.');for(var _0x13532c=0x0;_0x13532c<_0x493c89[_0x21458d(0x1ed)];_0x13532c++){const _0x5a2b8c=~~_0x493c89[_0x13532c],_0x993653=~~_0x3bc02c[_0x13532c];if(_0x5a2b8c>_0x993653)return!![];if(_0x5a2b8c<_0x993653)return![];}return![];}function toTelegramMarkdown(_0x3142c5){const _0x46c2b7=_0x1c7409,_0x5a04ec=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0xaeb22f=/\*{2}(.+?)\*{2}/gim;return _0x3142c5=_0x3142c5[_0x46c2b7(0x21b)](_0x5a04ec,_0x46c2b7(0x19d))[_0x46c2b7(0x21b)](_0xaeb22f,_0x46c2b7(0x21f)),_0x3142c5;}async function validateConfigFile(){const _0x32343c=_0x1c7409,_0x47d6b9=dbConfig['get'](_0x32343c(0x177))[_0x32343c(0x228)]('botID')['value']()||[];if(_0x47d6b9['length']==0x0){let _0x2b498d=0x0,_0x18b601=[];const _0x397df7=/^bot-([0-9]{3})-config.json$/,_0x3d667a=fs[_0x32343c(0x188)](configpath);_0x3d667a[_0x32343c(0x276)](_0x28c11e=>{const _0xf8ef34=_0x32343c,_0x2aca10=_0x397df7[_0xf8ef34(0x2b1)](_0x28c11e);if(_0x2aca10){const _0x55519e=_0x2aca10[0x1];let _0x1fb48f=getBotAttributes(_0x55519e);_0x18b601[_0xf8ef34(0x29d)]({'botID':_0x55519e,'botname':_0x1fb48f['botname'],'status':_0xf8ef34(0x22c),'live':_0xf8ef34(0x1c0)}),_0x2b498d++;}}),_0x2b498d!=0x0&&(dbConfig[_0x32343c(0x190)](_0x32343c(0x177))['assign'](_0x18b601)[_0x32343c(0x2bf)](),config=_0x18b601,restoredConfigFile=_0x2b498d);}}async function restoreConfigNotify(_0x111f52){const _0xf29b3a=_0x1c7409;let _0x4fee1b;if(restoredConfigFile==0x1)_0x4fee1b=_0xf29b3a(0x13d);else _0x4fee1b=_0xf29b3a(0x25e);if(_0x111f52)io['to'](_0xf29b3a(0x205))[_0xf29b3a(0x24f)](_0xf29b3a(0x156),_0x4fee1b);else{logger[_0xf29b3a(0x2a3)](_0xf29b3a(0x2b0)),logger[_0xf29b3a(0x2a3)](_0x4fee1b),logger['simple'](_0xf29b3a(0x2b0)),logger[_0xf29b3a(0x2a3)]('');if(tgBot&&settings['telegramChatId']&&settings[_0xf29b3a(0x173)]!=_0xf29b3a(0x22f))tgBot['sendMessage'](settings[_0xf29b3a(0x210)],_0xf29b3a(0x227)+_0x4fee1b)['catch'](_0x23ef00=>{telegramError(_0x23ef00);});}}function validateCredentials(_0x1d79c7,_0x4cdab9){const _0x4f62ad=_0x1c7409;if(_0x1d79c7[_0x4f62ad(0x283)]==settings[_0x4f62ad(0x260)]&&bcrypt[_0x4f62ad(0x13e)](_0x1d79c7[_0x4f62ad(0x1d4)],settings[_0x4f62ad(0x174)])){if(settings[_0x4f62ad(0x216)])return{'allow':![],'reason':_0x4f62ad(0x28c),'token':null};else{const _0x1ec4f1=generateLoginToken(_0x4cdab9);return{'allow':!![],'reason':_0x4f62ad(0x2bb),'token':_0x1ec4f1};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x25ad7c){const _0x572bb8=_0x1c7409,_0x285857=generateLoginToken(_0x25ad7c);return{'allow':!![],'reason':_0x572bb8(0x2bb),'token':_0x285857};}function validateAccess(_0x42b00a,_0x4f10b8,_0xcbcde0){const _0x253548=_0x1c7409,_0x448056=_0xcbcde0?_0xcbcde0:devices[_0x4f10b8]['ip'];let _0x32c624;const _0x30eafe=_0x535d2b=>{const _0x533b15=_0x356b;if(settings[_0x533b15(0x1fc)]){if(settings[_0x533b15(0x216)]){if(telegram2FaApproved(_0x4f10b8)){const _0x4a918a=generateLoginToken(_0x4f10b8);return{'allow':!![],'reason':_0x533b15(0x211),'token':_0x4a918a};}else return{'allow':![],'reason':_0x533b15(0x2d4),'token':null};}else return _0x32c624=validToken(_0x535d2b,_0x4f10b8),_0x32c624[_0x533b15(0x14e)](_0x533b15(0x136))?{'allow':!![],'reason':_0x533b15(0x13b),'token':_0x535d2b}:{'allow':![],'reason':_0x533b15(0x2d4),'token':null};}else return{'allow':!![],'reason':_0x533b15(0x2c9),'token':null};};if(settings['whitelistEnabled']){let _0x3b7872=[...settings[_0x253548(0x261)],_0x253548(0x166),_0x253548(0x2b4),_0x253548(0x18d)];if(_0x3b7872[_0x253548(0x2c2)](_0x448056))return _0x30eafe(_0x42b00a);else{_0x32c624=validToken(_0x42b00a,_0x4f10b8);if(_0x32c624['hasOwnProperty'](_0x253548(0x136)))return _0x30eafe(_0x42b00a);else{if(telegramIpApproved(_0x4f10b8)){const _0x3c54be=generateToken(_0x4f10b8);return _0x32c624=_0x30eafe(_0x42b00a),_0x32c624[_0x253548(0x277)]?{'allow':!![],'reason':_0x253548(0x123),'token':_0x3c54be}:_0x32c624;}else return settings[_0x253548(0x124)]?{'allow':![],'reason':_0x253548(0x19e),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x30eafe(_0x42b00a);}function timelyDecrypt(_0x5062eb,_0x200e54=!![]){const _0x1073fa=_0x1c7409;if(_0x5062eb)try{const _0xc8c38a=crypt['decrypt'](secure[_0x1073fa(0x16f)],_0x5062eb)[_0x1073fa(0x1ae)],_0x4dd32a=_0xc8c38a[_0x1073fa(0x199)]('@')[0x0],_0x2d6afe=_0xc8c38a[_0x1073fa(0x199)]('@')[0x1],_0x377f03=new Date()['getTime']();if(_0x200e54){if(_0x377f03-_0x2d6afe<maxSecretAge*0x3e8)return _0x4dd32a;else return![];}else return _0x4dd32a;}catch(_0x37f0ad){return![];}else return![];}const validToken=(_0x5ee7ad,_0x9eff49)=>{const _0x298b4f=_0x1c7409,_0x223f15=devices[_0x9eff49]['ip'];if(!_0x5ee7ad)return{'error':_0x298b4f(0x235)};for(let _0x53e0c2 of blacklist){if(_0x53e0c2['token']==_0x5ee7ad)return{'error':_0x298b4f(0x249)};}let _0x198ccd;try{_0x198ccd=jwt[_0x298b4f(0x127)](_0x5ee7ad,secure['secret']+_0x9eff49);}catch{return{'error':_0x298b4f(0x162)};}if(!_0x198ccd[_0x298b4f(0x14e)](_0x298b4f(0x2b6))&&!_0x198ccd[_0x298b4f(0x14e)](_0x298b4f(0x283))||!_0x198ccd[_0x298b4f(0x14e)]('exp'))return{'error':_0x298b4f(0x157)};if(!_0x198ccd[_0x298b4f(0x14e)](_0x298b4f(0x283))&&_0x198ccd['hasOwnProperty'](_0x298b4f(0x2b6))){const {clientip:_0xaa89d3}=_0x198ccd;return _0x223f15==_0xaa89d3?{'success':_0x298b4f(0x1c2)}:{'error':_0x298b4f(0x107)};}else{if(_0x198ccd['hasOwnProperty']('username')&&_0x198ccd['hasOwnProperty'](_0x298b4f(0x2b6))){const {username:_0x3cb31b,clientip:_0x2c7861}=_0x198ccd;return settings[_0x298b4f(0x260)]==_0x3cb31b&&_0x223f15==_0x2c7861?{'success':_0x298b4f(0x1c2)}:{'error':_0x298b4f(0x1cc)};}}},generateLoginToken=_0x4309c6=>{const _0x1bd974=_0x1c7409;if(_0x4309c6){const _0xcc1bb9=devices[_0x4309c6]['ip'];return jwt['sign']({'username':settings[_0x1bd974(0x260)],'clientip':_0xcc1bb9},secure[_0x1bd974(0x202)]+_0x4309c6,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x212abd=>{const _0x41e701=_0x1c7409;if(_0x212abd){const _0x15e26c=devices[_0x212abd]['ip'];return jwt[_0x41e701(0x165)]({'clientip':_0x15e26c},secure[_0x41e701(0x202)]+_0x212abd,{'expiresIn':devices[_0x212abd][_0x41e701(0x1f7)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x38bd99=>{const _0x26b819=_0x1c7409;let _0x2de368=![];return devices[_0x38bd99][_0x26b819(0x1f7)]&&devices[_0x38bd99][_0x26b819(0x1f7)][_0x26b819(0x160)]!=_0x26b819(0x1e8)&&(_0x2de368=devices[_0x38bd99]['telegramIpApproval'][_0x26b819(0x2b6)]==devices[_0x38bd99]['ip']&&new Date()['getTime']()-devices[_0x38bd99][_0x26b819(0x1f7)]['timestamp']<devices[_0x38bd99]['telegramIpApproval']['expiry']*0x3c*0x3e8),_0x2de368;},telegram2FaApproved=_0x464e5a=>{const _0x50abdd=_0x1c7409;let _0x5b83d8=![];return devices[_0x464e5a][_0x50abdd(0x197)]&&devices[_0x464e5a]['telegram2FaApproval'][_0x50abdd(0x160)]!=_0x50abdd(0x1e8)&&(_0x5b83d8=devices[_0x464e5a][_0x50abdd(0x197)][_0x50abdd(0x2b6)]==devices[_0x464e5a]['ip']&&new Date()['getTime']()-devices[_0x464e5a][_0x50abdd(0x197)][_0x50abdd(0x17b)]<devices[_0x464e5a]['telegram2FaApproval'][_0x50abdd(0x160)]*0x3c*0x3e8),_0x5b83d8;},normalizeIP=_0x3385e6=>{const _0x37b156=_0x1c7409;let _0x35f894=null,_0x420db9=null;if(ipaddr[_0x37b156(0x24d)](_0x3385e6)){const _0x215aea=ipaddr[_0x37b156(0x15c)](_0x3385e6);_0x215aea[_0x37b156(0x1fe)]()===_0x37b156(0x23b)?(_0x215aea[_0x37b156(0x2a0)]()&&(_0x35f894=_0x215aea[_0x37b156(0x101)]()['toString']()),_0x420db9=_0x215aea[_0x37b156(0x209)]()):(_0x35f894=_0x215aea['toString'](),_0x420db9=_0x215aea[_0x37b156(0x1ad)]()['toString']());}return{'show':_0x35f894?_0x35f894:_0x420db9,'store':_0x420db9};};function formatDate(_0x2f2e9e){const _0x10d1db=_0x1c7409;return _0x2f2e9e[_0x10d1db(0x17e)]()+'/'+(_0x2f2e9e[_0x10d1db(0x221)]()+0x1)[_0x10d1db(0x209)]()['padStart'](0x2,'0')+'/'+_0x2f2e9e[_0x10d1db(0x203)]()[_0x10d1db(0x209)]()[_0x10d1db(0x110)](0x2,'0')+'\x20'+_0x2f2e9e[_0x10d1db(0x111)]()['toString']()[_0x10d1db(0x110)](0x2,'0')+':'+_0x2f2e9e['getMinutes']()[_0x10d1db(0x209)]()[_0x10d1db(0x110)](0x2,'0')+':'+_0x2f2e9e['getSeconds']()[_0x10d1db(0x209)]()['padStart'](0x2,'0');}function sleep(_0x255812){return new Promise(_0x3450bc=>setTimeout(_0x3450bc,_0x255812));}