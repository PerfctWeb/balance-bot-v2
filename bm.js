const _0x5be511=_0x1e72;(function(_0x3e4e73,_0x1099a2){const _0x1f9eb1=_0x1e72,_0x3e28c9=_0x3e4e73();while(!![]){try{const _0x1d59ed=-parseInt(_0x1f9eb1(0x2b5))/0x1*(parseInt(_0x1f9eb1(0x202))/0x2)+parseInt(_0x1f9eb1(0x25d))/0x3*(parseInt(_0x1f9eb1(0x21a))/0x4)+parseInt(_0x1f9eb1(0x25e))/0x5+parseInt(_0x1f9eb1(0x250))/0x6*(parseInt(_0x1f9eb1(0x1a6))/0x7)+-parseInt(_0x1f9eb1(0x19e))/0x8+parseInt(_0x1f9eb1(0x1c1))/0x9+parseInt(_0x1f9eb1(0x2d3))/0xa*(-parseInt(_0x1f9eb1(0x28d))/0xb);if(_0x1d59ed===_0x1099a2)break;else _0x3e28c9['push'](_0x3e28c9['shift']());}catch(_0x3bf553){_0x3e28c9['push'](_0x3e28c9['shift']());}}}(_0x5c94,0x6d661));const _0x523e45=function(){let _0x406ec0=!![];return function(_0x4a5755,_0xcc51b){const _0x494f72=_0x406ec0?function(){const _0x14ec08=_0x1e72;if(_0xcc51b){const _0x41bda7=_0xcc51b[_0x14ec08(0x2d0)](_0x4a5755,arguments);return _0xcc51b=null,_0x41bda7;}}:function(){};return _0x406ec0=![],_0x494f72;};}(),_0x44e707=_0x523e45(this,function(){const _0x147584=_0x1e72;return _0x44e707[_0x147584(0x20c)]()[_0x147584(0x249)](_0x147584(0x22b))[_0x147584(0x20c)]()['constructor'](_0x44e707)['search'](_0x147584(0x22b));});_0x44e707();'use strict';function _0x5c94(){const _0x2cd019=['confirm-message','sendMessage','lastmsgemitted','reason','1177gJMAuR','allow','/:bot/coins','enabled\x20Bot\x20','/update\x20-\x20update\x20Balance\x20Bot\x0a','Bot\x20','alias',',\x20must\x20be\x20a\x204\x20digit\x20number','Server','timestamp','fork','lowdb','/:bot/performance','Login\x20accepted','access\x20timeout','bb-secure.json','bot-','2FA','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','placeOrder','************','/:bot/portfolio','send','build2','alerts','</b>\x20?','headers','apply','bcryptjs','stopPolling','150HUQirA','store-headless','bbPassword','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','socket.io','from','cloneDeep','init','pidRefreshToken','disconnect','\x20minutes','Invalid\x20IP\x20address','publicKey','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','stopped','telegramChatId','isIPv4MappedAddress','port','sortBy','answerCallbackQuery','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','enabled','sendFile','telegramEnabled','Invalid\x20username\x20or\x20IP\x20address','encryptedUuid','::1','unlinkSync','decrypt','loginRequired','length','botID','\x20|\x20','bbUsername','mixpanel','telegram','data','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','bb-config.json','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','mkdirSync','connected','success','login\x20not\x20required','\x20mode','value','getMonth','toIPv4Address','clients','track','use','Unauthorized\x20attempt\x20to\x20log\x20out','temporaryAccessAllowed','::ffff:127.0.0.1','static','apiKey','generateKeyPairAsync','Starting\x20Balance\x20Bot\x20update','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Unauthorized\x20attempt\x20to\x20confirm\x20message','isValid','initclient','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','verify','push','Yes','uuid','3884104RUhNtH','stop','HTML','Allow\x20login\x20from\x20IP\x20address\x20<b>','mode','starting\x20new\x20bot\x20|\x20Bot\x20','copyFileSync','remove','623nfvZhx','telegramIpApproval','deleteHistoryAlerts','User\x20has\x20been\x20validated','$1_$2_$3','request','<b>Balance\x20Bot\x20Status:</b>\x0a','getHours','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','temporary\x20token\x20generated','onText','sign','get-messages','live','Token\x20blacklisted','reset-password','get','bb/','Error:\x20Invalid\x20argument\x20','getFullYear','bot','username','api-eu.mixpanel.com','store-settings','getPortfolio','expiry','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','1220157PXXRaJ','name','emit','kill','sendPortfolioTelegram','auth','telegramToken','toIPv4MappedAddress','stringify','message','15\x20min','status','removeListener','started','date-fns','server','running','Password\x20reset\x20rejected','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','telegramUsername','inherit','http','show','all','invalid\x20credentials','index.html','/names\x20-\x20show\x20bot\x20names\x0a','showname','accept','entries','login','map','any','build','blacklist','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','telegram2FaApproval','temporary\x20access\x20not\x20allowed','bbvReceive','createServer','function','referer','userid','set','404\x20Not\x20Found','telegrammsg','Invalid\x20authentication\x20token\x20(1)','Balance\x20Bot\x20Server','sha256','backup/','type','forEach','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','You\x20can\x20use\x20the\x20following\x20commands:\x0a','/enable\x20-\x20enable\x20notifications\x0a','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','All','-performance.json','Ok,\x20will\x20send\x20order\x20notifications\x20only','2FA\x20login\x20required','settings.','deleted\x20Bot\x20','split','catch','Temporary\x20access\x20rejected','842LuLqsV','SIGINT','telegramEvents','match','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','UA-192771731-1','storeHeadless','token','assign','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','toString','once','then','update-bb','bots','getUTCHours','orders','chat','manual','login\x20required','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','password','-config.json','Unauthorized\x20attempt\x20to\x20update\x20settings','268332PNwCDH','add-bot','exp','log','cancel-loading','store-configuration','temporary\x20access\x20timeout',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','timeshift','argv','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','handshake','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','ipc','2FA\x20required','callback_query','\x20only\x0a','(((.+)+)+)+$','parse','latestversion','starting\x20bot\x20|\x20Bot\x20','graphql-request','clientip','error','user','default','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','keys','No\x20bots\x20running\x20right\x20now','defaults','getDate','privateKey','lastmsgtelegram','logged\x20out','host','access','Invalid\x20authentication\x20token\x20(2)','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','yargs/yargs','30\x20min','number','Notifications\x20disabled\x0a','logout','update-bot','Unauthorized\x20attempt\x20to\x20get\x20messages','reject','error\x20while\x20deleting\x20config\x20files:\x20','search','whitelist','temporary\x20access\x20rejected','Unauthorized\x20attempt\x20to\x20update\x20bot','includes','hybrid-crypto-js','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','58998hSMmPD','disabled','-----------------------------------------------------------------------------------','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','kind','axios','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','args','reload','settings','botmanager','delete-alerts','6gXmCVN','2081180JYfyYg','readdirSync','pidExpireLogin','restarting\x20Bot\x20','path','write','/disable\x20-\x20disable\x20notifications\x0a','NTBA_FIX_319','<b>Telegram\x20Bot\x20Status:</b>\x0a','find','All\x20bots','yes','https://api.ipify.org?format=json','title','Notifications\x20disabled','exit','readFileSync','hashSync','Unauthorized\x20login\x20attempt\x20(timeout)','*$1*','child_process','replace','existsSync','secret','secure','Unauthorized\x20attempt\x20to\x20store\x20configuration','padStart','Unauthorized\x20attempt\x20to\x20delete\x20bot','compareSync','new-disabled','event','2FA\x20login\x20token\x20generated','5\x20min','config/','messages','uuid-random','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','1000','login\x20token\x20generated','env','Invalid\x20Telegram\x20token','0.0.0','Unauthorized\x20attempt\x20to\x20get\x20logs','hasOwnProperty','getSeconds','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','96789qpUVGt','\x20>\x20','getMinutes','randomFillSync','bbvNew','getStartingBalances','filter','ipv6','getTime','sockets','new','join','All\x20bots\x20running\x20right\x20now','test','store','order','delete-bot','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','randomBytes','RSA','botname','writeFileSync','/:bot','lowdb/adapters/FileSync','version','headless','whitelistEnabled','127.0.0.1','Login\x20rejected','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','auto','Markdown','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','startsWith','@analytics/google-analytics-v3'];_0x5c94=function(){return _0x2cd019;};return _0x5c94();}process[_0x5be511(0x285)][_0x5be511(0x265)]=0x1;const childProcess=require(_0x5be511(0x272)),fs=require('fs'),fns=require(_0x5be511(0x1cf)),low=require(_0x5be511(0x2c0)),FileSync=require(_0x5be511(0x2a5)),path=require(_0x5be511(0x262)),crypto=require('crypto'),Crypt=require(_0x5be511(0x24e))['Crypt'],RSA=require(_0x5be511(0x24e))[_0x5be511(0x2a1)],bcrypt=require(_0x5be511(0x2d1)),jwt=require('jsonwebtoken'),{Analytics}=require('analytics'),googleAnalyticsV3Plugin=require(_0x5be511(0x2b0))[_0x5be511(0x233)],ipaddr=require('ipaddr.js'),argv=require(_0x5be511(0x240))(process[_0x5be511(0x223)]['slice'](0x2))[_0x5be511(0x223)],uuidRandom=require(_0x5be511(0x281)),Mixpanel=require(_0x5be511(0x17d)),axios=require(_0x5be511(0x256)),{GraphQLClient,gql}=require(_0x5be511(0x22f)),PORT=argv[_0x5be511(0x2e4)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x5be511(0x29a)](PORT)&&(console[_0x5be511(0x21d)](_0x5be511(0x1b8)+PORT+_0x5be511(0x2bc)),process[_0x5be511(0x26d)](0x1));const HOST=argv[_0x5be511(0x23c)]||null,userID=argv[_0x5be511(0x232)]||'';let bbpath=_0x5be511(0x1b7),bbpath2='';const botfile='bot.js',configfile=_0x5be511(0x181),settingsfile='bb-settings.json',securefile=_0x5be511(0x2c4);let validInstallation=!![];!fs[_0x5be511(0x274)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x5be511(0x18b)),configpath=userID?bbpath+_0x5be511(0x27f)+userID+'/':bbpath+_0x5be511(0x27f),configbackuppath=configpath+_0x5be511(0x1f2);!fs[_0x5be511(0x274)](configpath)&&fs[_0x5be511(0x183)](configpath);!fs[_0x5be511(0x274)](configbackuppath)&&fs[_0x5be511(0x183)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x5be511(0x237)]({'bots':[]})[_0x5be511(0x263)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x5be511(0x287)}})[_0x5be511(0x263)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x5be511(0x237)]({'secure':{},'blacklist':[]})[_0x5be511(0x263)]();let crypt=new Crypt({'md':_0x5be511(0x1f1),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x5be511(0x2da)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x5be511(0x1bc)}),analytics=Analytics({'app':'Balance\x20Bot','plugins':[googleAnalyticsV3Plugin({'trackingId':_0x5be511(0x207)})]});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x5be511(0x2a6)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x5be511(0x1d6))[_0x5be511(0x1e8)](app);app[_0x5be511(0x18d)](express[_0x5be511(0x191)](path['join'](__dirname,bbpath2,_0x5be511(0x2cc)))),app[_0x5be511(0x18d)](express[_0x5be511(0x191)](path[_0x5be511(0x298)](__dirname,bbpath2,'build'))),app[_0x5be511(0x1b6)]('/',function(_0x4a2c1b,_0x2926d1){const _0x57964a=_0x5be511;_0x2926d1[_0x57964a(0x171)](path[_0x57964a(0x298)](__dirname,bbpath2,_0x57964a(0x2cc),_0x57964a(0x1da)));}),app[_0x5be511(0x1b6)](_0x5be511(0x2a4),function(_0x31dea2,_0x259cc1){const _0x330532=_0x5be511;_0x259cc1[_0x330532(0x171)](path['join'](__dirname,bbpath2,_0x330532(0x1e2),'index.html'));}),app[_0x5be511(0x1b6)](_0x5be511(0x2ca),(_0x4601d6,_0x1b3744)=>{const _0x269c79=_0x5be511;_0x1b3744[_0x269c79(0x171)](path[_0x269c79(0x298)](__dirname,bbpath2,_0x269c79(0x1e2),_0x269c79(0x1da)));}),app[_0x5be511(0x1b6)](_0x5be511(0x2c1),(_0x4e5b01,_0x87ff18)=>{const _0x9063ff=_0x5be511;_0x87ff18[_0x9063ff(0x171)](path[_0x9063ff(0x298)](__dirname,bbpath2,_0x9063ff(0x1e2),_0x9063ff(0x1da)));}),app['get'](_0x5be511(0x2b7),(_0x418409,_0x17ee53)=>{const _0x1d1ecb=_0x5be511;_0x17ee53[_0x1d1ecb(0x171)](path['join'](__dirname,bbpath2,_0x1d1ecb(0x1e2),_0x1d1ecb(0x1da)));}),app[_0x5be511(0x1b6)]('/:bot/history',(_0x390abc,_0xdc6ba1)=>{const _0x2ed832=_0x5be511;_0xdc6ba1[_0x2ed832(0x171)](path[_0x2ed832(0x298)](__dirname,bbpath2,_0x2ed832(0x1e2),'index.html'));}),app[_0x5be511(0x1b6)]('/:bot/configuration',(_0x12714c,_0x14202b)=>{const _0x2f9d34=_0x5be511;_0x14202b[_0x2f9d34(0x171)](path['join'](__dirname,bbpath2,_0x2f9d34(0x1e2),_0x2f9d34(0x1da)));}),app[_0x5be511(0x1b6)]('/:bot/support',(_0x2d714b,_0x5ad5b3)=>{const _0x75926d=_0x5be511;_0x5ad5b3[_0x75926d(0x171)](path[_0x75926d(0x298)](__dirname,bbpath2,'build',_0x75926d(0x1da)));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require(_0x5be511(0x2d7))(http,{}),TelegramBot=require('node-telegram-bot-api');let tgBot;if(settings[_0x5be511(0x1c7)]&&settings[_0x5be511(0x1c7)]!=''&&settings['telegramUsername']&&settings[_0x5be511(0x1d4)]!='')initTelegram();init();async function init(){await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),startServer(),startSocket(),startScheduler(),triggerAnalytics(!![]),getMessages();}function startServer(){const _0x51025b=_0x5be511;console[_0x51025b(0x21d)](''),console[_0x51025b(0x21d)](_0x51025b(0x252)),logging('Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:'+PORT),console['log'](_0x51025b(0x252));if(config[_0x51025b(0x179)]!=0x0)config['forEach'](_0x594cc6=>{const _0x3babfa=_0x51025b;if(_0x594cc6['status']==_0x3babfa(0x170)||_0x594cc6[_0x3babfa(0x1cc)]==_0x3babfa(0x297))logging(_0x3babfa(0x22e)+_0x594cc6[_0x3babfa(0x17a)]+_0x3babfa(0x17b)+_0x594cc6[_0x3babfa(0x2a2)]),startBot([_0x594cc6[_0x3babfa(0x17a)],userID],{'cwd':bbpath},function(_0x4d6e5c){if(_0x4d6e5c)logging(_0x4d6e5c);});else(_0x594cc6[_0x3babfa(0x1cc)]==_0x3babfa(0x251)||_0x594cc6['status']=='new-disabled')&&logging('idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x594cc6[_0x3babfa(0x17a)]+'\x20|\x20'+_0x594cc6[_0x3babfa(0x2a2)]);});else!newBot&&console[_0x51025b(0x21d)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();console['log'](_0x51025b(0x252)),console[_0x51025b(0x21d)]('');}function startSocket(){io['on']('connection',_0xb19704=>{const _0x5b5e16=_0x1e72;let _0x161a80,_0xd68293,_0x385ff9,_0x52980a,_0x575c79;const _0x333fff=_0xb19704[_0x5b5e16(0x225)][_0x5b5e16(0x2cf)][_0x5b5e16(0x1ea)];_0xd68293=_0x333fff[_0x5b5e16(0x205)](/bot[0-9]{3}/);if(_0xd68293)_0x385ff9=_0xd68293[0x0][_0x5b5e16(0x205)](/[0-9]{3}/);if(_0x385ff9)_0x161a80=_0x385ff9[0x0];else _0x161a80=_0x5b5e16(0x25b);const _0x141171=_0xb19704[_0x5b5e16(0x225)][_0x5b5e16(0x1c6)][_0x5b5e16(0x174)];if(!_0x141171)_0xb19704['emit'](_0x5b5e16(0x1cc),{'publicKey':secure['publicKey']});else{_0x52980a=timelyDecrypt(_0x141171,![]);if(!_0x52980a)_0xb19704[_0x5b5e16(0x1c3)](_0x5b5e16(0x1cc),{'publicKey':secure['publicKey']});else{_0x575c79=normalizeIP(_0xb19704['conn']['remoteAddress'])[_0x5b5e16(0x29b)];if(!devices[_0x52980a])devices[_0x52980a]={'uuid':_0x52980a,'access':{'token':null}};devices[_0x52980a]['ip']=_0x575c79;const _0x49b2a3=addClient(_0xb19704['id'],_0x52980a,_0x161a80);setAccess(_0x49b2a3),emitMessages(),_0xb19704['on'](_0x5b5e16(0x1df),_0x21eb71=>{const _0x4cc3a4=_0x5b5e16,_0x44c465=timelyDecrypt(_0x21eb71['password']);if(_0x44c465){_0x21eb71={'username':_0x21eb71[_0x4cc3a4(0x1bb)],'password':_0x44c465},devices[_0x52980a][_0x4cc3a4(0x23d)]=validateCredentials(_0x21eb71,_0x52980a);if(devices[_0x52980a][_0x4cc3a4(0x23d)][_0x4cc3a4(0x2b6)]==![]&&devices[_0x52980a][_0x4cc3a4(0x23d)][_0x4cc3a4(0x2b4)]==_0x4cc3a4(0x1fc))_0xb19704[_0x4cc3a4(0x1c3)](_0x4cc3a4(0x1cc),{'access':devices[_0x52980a][_0x4cc3a4(0x23d)]}),loginAccess2FA(_0x52980a,_0x575c79);else{if(devices[_0x52980a]['access'][_0x4cc3a4(0x2b6)]==![]&&devices[_0x52980a][_0x4cc3a4(0x23d)][_0x4cc3a4(0x2b4)]==_0x4cc3a4(0x1d9))_0xb19704[_0x4cc3a4(0x1c3)](_0x4cc3a4(0x1cc),{'access':devices[_0x52980a]['access']});else devices[_0x52980a][_0x4cc3a4(0x23d)]['allow']&&devices[_0x52980a]['access']['reason']==_0x4cc3a4(0x284)&&(getClientsWithUuid(_0x52980a)[_0x4cc3a4(0x1f4)](_0x23abe6=>{setAccess(_0x23abe6);}),setTokenRefresh(_0x52980a),setSessionTimeout('login',_0x52980a));}}else logging(_0x4cc3a4(0x270));}),_0xb19704['on'](_0x5b5e16(0x1b5),()=>{resetPassword();}),_0xb19704['on'](_0x5b5e16(0x2dc),_0x3749c5=>{removeClient(_0xb19704['id']);});}}});}function initClient(_0x50797d){const _0x2a9d67=_0x5be511;if(_0x50797d!='botmanager'&&config[_0x2a9d67(0x192)]!=''){if(pid[_0x50797d])pid[_0x50797d][_0x2a9d67(0x2cb)]({'function':_0x2a9d67(0x198),'args':null});}}function getSocket(_0x4cce99){const _0x326f33=_0x5be511;return io[_0x326f33(0x296)][_0x326f33(0x296)][_0x326f33(0x1b6)](_0x4cce99);}function setAccess(_0x39fbf9){const _0x3c7c94=_0x5be511,_0x3cb886=getSocket(_0x39fbf9['id']),_0x57ae2f=_0x39fbf9['uuid'],_0xe9074f=_0x39fbf9[_0x3c7c94(0x1ba)];devices[_0x57ae2f]['access']=validateAccess(devices[_0x57ae2f][_0x3c7c94(0x23d)][_0x3c7c94(0x209)],_0x57ae2f),_0x3cb886['join'](_0x57ae2f);if(devices[_0x57ae2f][_0x3c7c94(0x23d)][_0x3c7c94(0x2b6)]){_0x3cb886[_0x3c7c94(0x298)](_0xe9074f);if(_0xe9074f==_0x3c7c94(0x25b))initializeSocketBotManager(_0x3cb886);else initializeSocketBot(_0x3cb886);initClient(_0xe9074f);}devices[_0x57ae2f][_0x3c7c94(0x23d)][_0x3c7c94(0x209)]&&devices[_0x57ae2f][_0x3c7c94(0x23d)]['reason']==_0x3c7c94(0x1af)&&setSessionTimeout(_0x3c7c94(0x2c6),_0x57ae2f),devices[_0x57ae2f]['access'][_0x3c7c94(0x209)]&&devices[_0x57ae2f]['access'][_0x3c7c94(0x2b4)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x3c7c94(0x1df),_0x57ae2f),_0x3cb886[_0x3c7c94(0x1c3)](_0x3c7c94(0x1cc),{'status':_0x39fbf9[_0x3c7c94(0x1d0)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x57ae2f]['access'],'externalip':devices[_0x57ae2f]['ip'],'publicKey':secure[_0x3c7c94(0x2df)],'userid':settings[_0x3c7c94(0x1eb)],'validInstallation':validInstallation}),devices[_0x57ae2f][_0x3c7c94(0x23d)][_0x3c7c94(0x2b6)]==![]&&devices[_0x57ae2f][_0x3c7c94(0x23d)][_0x3c7c94(0x2b4)]==_0x3c7c94(0x228)&&temporaryAccess2FA(_0x57ae2f,devices[_0x57ae2f]['ip']);}function setSessionTimeout(_0x3d9e52,_0x201e46){const _0x26aa28=_0x5be511;let _0x15f774;if(_0x3d9e52=='login')_0x15f774=loginExpiry*0x3c*0x3e8;else _0x15f774=devices[_0x201e46][_0x26aa28(0x1a7)][_0x26aa28(0x1bf)]*0x3c*0x3e8-(new Date()[_0x26aa28(0x295)]()-devices[_0x201e46][_0x26aa28(0x1a7)][_0x26aa28(0x2be)]);if(devices[_0x201e46][_0x26aa28(0x260)])clearTimeout(devices[_0x201e46][_0x26aa28(0x260)]);devices[_0x201e46][_0x26aa28(0x260)]=setTimeout(()=>{const _0x3fb150=_0x26aa28;if(devices[_0x201e46][_0x3fb150(0x2db)])clearTimeout(devices[_0x201e46]['pidRefreshToken']);removeSocketListeners(_0x201e46),addBlacklist(_0x201e46),devices[_0x201e46][_0x3fb150(0x1a7)]=null,devices[_0x201e46]['telegram2FaApproval']=null,devices[_0x201e46][_0x3fb150(0x23d)][_0x3fb150(0x209)]=null,devices[_0x201e46][_0x3fb150(0x23d)]=validateAccess(devices[_0x201e46][_0x3fb150(0x23d)][_0x3fb150(0x209)],_0x201e46),!(devices[_0x201e46]['access'][_0x3fb150(0x2b6)]&&devices[_0x201e46]['access'][_0x3fb150(0x2b4)]==_0x3fb150(0x186))&&(_0x3d9e52==_0x3fb150(0x1df)?io['to'](_0x201e46)[_0x3fb150(0x1c3)]('status',{'access':{'allow':![],'reason':_0x3fb150(0x2c3),'token':null}}):io['to'](_0x201e46)[_0x3fb150(0x1c3)]('status',{'access':{'allow':![],'reason':_0x3fb150(0x220),'token':null}})),devices[_0x201e46][_0x3fb150(0x23d)][_0x3fb150(0x209)]=null;},_0x15f774);}function setTokenRefresh(_0x3a99f5){const _0x151731=_0x5be511;if(devices[_0x3a99f5][_0x151731(0x2db)])clearTimeout(devices[_0x3a99f5][_0x151731(0x2db)]);devices[_0x3a99f5][_0x151731(0x2db)]=setTimeout(()=>{const _0x1a9c40=_0x151731;getClientsWithUuid(_0x3a99f5)[_0x1a9c40(0x179)]!=0x0?(devices[_0x3a99f5][_0x1a9c40(0x23d)]=refreshToken(_0x3a99f5),io['to'](_0x3a99f5)['emit'](_0x1a9c40(0x1cc),{'status':_0x1a9c40(0x184),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x3a99f5]['access'],'externalip':devices[_0x3a99f5]['ip'],'publicKey':secure[_0x1a9c40(0x2df)],'validInstallation':validInstallation}),setTokenRefresh(_0x3a99f5)):clearTimeout(devices[_0x3a99f5][_0x1a9c40(0x2db)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2d9cd2){const _0x13dc48=_0x5be511,_0x330215=getClient(_0x2d9cd2['id'])[_0x13dc48(0x19d)];_0x2d9cd2['emit'](_0x13dc48(0x210),config),_0x2d9cd2[_0x13dc48(0x1c3)](_0x13dc48(0x25a),cleanSettings()),_0x2d9cd2['on'](_0x13dc48(0x21b),_0x590b19=>{const _0xd937b7=_0x13dc48;if(validateAccess(_0x590b19,_0x330215)[_0xd937b7(0x2b6)])addBot();else logging('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x2d9cd2['on'](_0x13dc48(0x245),(_0x479eb6,_0x376cef)=>{const _0x5704ef=_0x13dc48;if(validateAccess(_0x376cef,_0x330215)[_0x5704ef(0x2b6)])toggleBot(_0x479eb6[_0x5704ef(0x17a)],_0x479eb6[_0x5704ef(0x1cc)],_0x479eb6[_0x5704ef(0x1b3)]);else logging(_0x5704ef(0x24c));}),_0x2d9cd2['on']('toggle-bot-mode',(_0x2070f3,_0x43fc83)=>{const _0xcfbf71=_0x13dc48;if(validateAccess(_0x43fc83,_0x330215)[_0xcfbf71(0x2b6)])toggleBotMode(_0x2070f3);else logging(_0xcfbf71(0x24c));}),_0x2d9cd2['on'](_0x13dc48(0x29d),(_0x4fc066,_0x4d64dc)=>{const _0x336931=_0x13dc48;if(validateAccess(_0x4d64dc,_0x330215)[_0x336931(0x2b6)])deleteBot(_0x4fc066);else logging(_0x336931(0x279));}),_0x2d9cd2['on'](_0x13dc48(0x1bd),(_0x33896e,_0x184eb2)=>{const _0x276a55=_0x13dc48;if(validateAccess(_0x184eb2,_0x330215)[_0x276a55(0x2b6)])storeSettings(_0x33896e,!![]);else logging(_0x276a55(0x219));}),_0x2d9cd2['on'](_0x13dc48(0x20f),_0x42ec88=>{const _0x4ba371=_0x13dc48;if(validateAccess(_0x42ec88,_0x330215)[_0x4ba371(0x2b6)])updateBB();else logging(_0x4ba371(0x254));}),_0x2d9cd2['on'](_0x13dc48(0x1b2),_0x53b204=>{const _0x158e44=_0x13dc48;if(validateAccess(_0x53b204,_0x330215)[_0x158e44(0x2b6)])getMessages();else logging('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x2d9cd2['on'](_0x13dc48(0x2b1),(_0x4cd7b8,_0x440654)=>{const _0x1a86d9=_0x13dc48;if(validateAccess(_0x440654,_0x330215)[_0x1a86d9(0x2b6)])confirmMessage(_0x4cd7b8);else logging(_0x1a86d9(0x196));}),_0x2d9cd2['on'](_0x13dc48(0x244),_0x11148d=>{const _0x299726=_0x13dc48;if(validateAccess(_0x11148d,_0x330215)[_0x299726(0x2b6)]){if(devices[_0x330215]['pidRefreshToken'])clearTimeout(devices[_0x330215]['pidRefreshToken']);if(devices[_0x330215][_0x299726(0x260)])clearTimeout(devices[_0x330215][_0x299726(0x260)]);removeSocketListeners(getClient(_0x2d9cd2['id'])[_0x299726(0x19d)]),addBlacklist(_0x330215),devices[_0x330215][_0x299726(0x1a7)]=null,devices[_0x330215][_0x299726(0x1e5)]=null,devices[_0x330215][_0x299726(0x23d)][_0x299726(0x209)]=null,io['to'](getClient(_0x2d9cd2['id'])['uuid'])[_0x299726(0x1c3)](_0x299726(0x1cc),{'access':{'allow':![],'reason':_0x299726(0x23b),'token':null}});}else logging(_0x299726(0x18e));});}function initializeSocketBot(_0x14fc02){const _0x455a93=_0x5be511,_0x2d9add=getClient(_0x14fc02['id'])[_0x455a93(0x1ba)],_0x3bb039=getClient(_0x14fc02['id'])[_0x455a93(0x19d)];_0x14fc02['on']('get-logs',(_0x55a9ba,_0x43df16)=>{const _0x1388cf=_0x455a93;if(validateAccess(_0x43df16,_0x3bb039)[_0x1388cf(0x2b6)]){if(pid[_0x2d9add])pid[_0x2d9add]['send']({'function':'emitHistory','args':_0x55a9ba});}else logging(_0x1388cf(0x288));}),_0x14fc02['on'](_0x455a93(0x25c),(_0x3c2f1d,_0x378e27)=>{const _0x23fbbf=_0x455a93;if(validateAccess(_0x378e27,_0x3bb039)[_0x23fbbf(0x2b6)]){if(pid[_0x2d9add])pid[_0x2d9add]['send']({'function':_0x23fbbf(0x1a8),'args':_0x3c2f1d});}else logging('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x14fc02['on']('get-portfolio',(_0x5349e1,_0x48c99f)=>{const _0xed9a50=_0x455a93;if(validateAccess(_0x48c99f,_0x3bb039)[_0xed9a50(0x2b6)]){if(pid[_0x2d9add])pid[_0x2d9add][_0xed9a50(0x2cb)]({'function':_0xed9a50(0x1be),'args':_0x5349e1});}else logging('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x14fc02['on'](_0x455a93(0x21f),(_0x177f40,_0x3139ba)=>{const _0x4b377a=_0x455a93;if(validateAccess(_0x3139ba,_0x3bb039)[_0x4b377a(0x2b6)]){if(pid[_0x2d9add])pid[_0x2d9add][_0x4b377a(0x2cb)]({'function':'storeConfiguration','args':_0x177f40});}else logging(_0x4b377a(0x277));}),_0x14fc02['on'](_0x455a93(0x2d4),(_0x4ffc30,_0x2c34d9)=>{const _0x17b065=_0x455a93;if(validateAccess(_0x2c34d9,_0x3bb039)[_0x17b065(0x2b6)]){if(pid[_0x2d9add])pid[_0x2d9add][_0x17b065(0x2cb)]({'function':_0x17b065(0x208),'args':_0x4ffc30});}else logging('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x14fc02['on']('get-starting-balances',_0x4fa486=>{const _0x32d53a=_0x455a93;if(validateAccess(_0x4fa486,_0x3bb039)[_0x32d53a(0x2b6)]){if(pid[_0x2d9add])pid[_0x2d9add][_0x32d53a(0x2cb)]({'function':_0x32d53a(0x292),'args':null});}else logging(_0x32d53a(0x1f8));}),_0x14fc02['on']('place-order',(_0x2bf55d,_0x17bb96)=>{const _0x15a46d=_0x455a93;if(validateAccess(_0x17bb96,_0x3bb039)['allow']){if(pid[_0x2d9add])pid[_0x2d9add][_0x15a46d(0x2cb)]({'function':_0x15a46d(0x2c8),'args':_0x2bf55d});}else logging(_0x15a46d(0x29e));}),_0x14fc02['on'](_0x455a93(0x21e),_0x3dcef6=>{const _0x31fe8e=_0x455a93;if(validateAccess(_0x3dcef6,_0x3bb039)[_0x31fe8e(0x2b6)]){if(pid[_0x2d9add])pid[_0x2d9add][_0x31fe8e(0x2cb)]({'function':'cancelLoading','args':null});}else logging(_0x31fe8e(0x2ab));}),_0x14fc02['on'](_0x455a93(0x20f),_0x26aeb1=>{const _0x3eaa1f=_0x455a93;if(validateAccess(_0x26aeb1,_0x3bb039)[_0x3eaa1f(0x2b6)])updateBB();else logging(_0x3eaa1f(0x254));}),_0x14fc02['on'](_0x455a93(0x1b2),_0x313c90=>{const _0x4699bb=_0x455a93;if(validateAccess(_0x313c90,_0x3bb039)['allow'])getMessages();else logging(_0x4699bb(0x246));}),_0x14fc02['on'](_0x455a93(0x2b1),(_0x5b779f,_0x527428)=>{const _0x18c2f1=_0x455a93;if(validateAccess(_0x527428,_0x3bb039)[_0x18c2f1(0x2b6)])confirmMessage(_0x5b779f);else logging(_0x18c2f1(0x196));}),_0x14fc02['on']('logout',_0x587da1=>{const _0xbb80c2=_0x455a93;if(validateAccess(_0x587da1,_0x3bb039)['allow']){if(devices[_0x3bb039]['pidRefreshToken'])clearTimeout(devices[_0x3bb039][_0xbb80c2(0x2db)]);if(devices[_0x3bb039][_0xbb80c2(0x260)])clearTimeout(devices[_0x3bb039][_0xbb80c2(0x260)]);removeSocketListeners(getClient(_0x14fc02['id'])['uuid']),addBlacklist(_0x3bb039),devices[_0x3bb039]['telegramIpApproval']=null,devices[_0x3bb039][_0xbb80c2(0x1e5)]=null,devices[_0x3bb039][_0xbb80c2(0x23d)][_0xbb80c2(0x209)]=null,io['to'](getClient(_0x14fc02['id'])[_0xbb80c2(0x19d)])[_0xbb80c2(0x1c3)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0xbb80c2(0x18e));});}function removeSocketListeners(_0x1ecfe6){getClientsWithUuid(_0x1ecfe6)['forEach'](_0x1b0b8e=>{getSocket(_0x1b0b8e['id'])['removeAllListeners']();});}function cleanSettings(){const _0x843d5=_0x5be511;let _0x169766=settings;return settings[_0x843d5(0x1c7)]&&settings[_0x843d5(0x1c7)]!=''&&(_0x169766={..._0x169766,'telegramToken':_0x843d5(0x2c9)}),settings[_0x843d5(0x2d5)]&&settings[_0x843d5(0x2d5)]!=''&&(_0x169766={..._0x169766,'bbPassword':_0x843d5(0x2c9)}),_0x169766;}function updateBB(){const _0x4509ff=_0x5be511;installingUpdate=!![],config[_0x4509ff(0x1f4)](_0x529104=>{const _0x584b15=_0x4509ff;restartBot(_0x529104[_0x584b15(0x17a)]);}),process[_0x4509ff(0x2cb)]({'update':!![]},_0x4c7fda=>{});}function startBot(_0x152c62,_0x15c679,_0x423bf1){const _0x21f8fb=_0x5be511;let _0x5b4a48=![];const _0x7a5b29=_0x152c62[0x0];_0x15c679={..._0x15c679,'stdio':['inherit',_0x21f8fb(0x1d5),_0x21f8fb(0x1d5),_0x21f8fb(0x227)]},pid[_0x7a5b29]=childProcess[_0x21f8fb(0x2bf)](botfile,_0x152c62,_0x15c679),pid[_0x7a5b29]['on']('message',_0x2daf95=>{const _0x4a0954=_0x21f8fb;switch(Object[_0x4a0954(0x235)](_0x2daf95)[0x0]){case _0x4a0954(0x2a2):updateBotName(_0x7a5b29,_0x2daf95['botname']);break;case'updatebotmanager':updateBotManager();break;case _0x4a0954(0x1cc):updateStatus(_0x7a5b29,_0x2daf95[_0x4a0954(0x1cc)]);break;case'live':updateLive(_0x7a5b29,_0x2daf95[_0x4a0954(0x1b3)]);break;case _0x4a0954(0x1ce):updateLive(_0x7a5b29,_0x2daf95[_0x4a0954(0x1ce)]),io['to'](_0x7a5b29)[_0x4a0954(0x1c3)]('status',{'access':{'allow':![],'reason':_0x4a0954(0x259),'token':null}});break;case _0x4a0954(0x19f):_0x2daf95[_0x4a0954(0x19f)]=='restart'&&restartBot(_0x7a5b29);_0x2daf95[_0x4a0954(0x19f)]==_0x4a0954(0x1c4)&&toggleBot(_0x7a5b29,_0x4a0954(0x251),'stopped');break;case _0x4a0954(0x17e):sendTelegram(_0x7a5b29,_0x2daf95['telegram']);break;case _0x4a0954(0x1ee):sendTelegramMsg(_0x2daf95[_0x4a0954(0x1ee)]);break;case _0x4a0954(0x1e9):io['to'](_0x7a5b29)['emit'](_0x2daf95[_0x4a0954(0x1e9)],_0x2daf95[_0x4a0954(0x258)]);break;}}),pid[_0x7a5b29]['on'](_0x21f8fb(0x231),function(_0x47a44f){if(_0x5b4a48)return;_0x5b4a48=!![],_0x423bf1(_0x47a44f);}),pid[_0x7a5b29]['on']('exit',function(_0x346771){const _0x115543=_0x21f8fb;if(installingUpdate)return;if(_0x5b4a48)return;_0x5b4a48=!![],_0x423bf1(null);const _0x421a61=dbConfig[_0x115543(0x1b6)](_0x115543(0x210))[_0x115543(0x267)]({'botID':_0x7a5b29})['value']();_0x421a61&&(_0x421a61[_0x115543(0x1cc)]==_0x115543(0x170)||_0x421a61['status']=='new')&&(updateLive(_0x7a5b29,_0x115543(0x2e1)),logging(_0x115543(0x261)+_0x7a5b29),startBot([_0x7a5b29,userID],{'cwd':bbpath},function(_0x426515){if(_0x426515)logging(_0x426515);}));});}function stopBot(_0x5db8fb){const _0x4b2b31=_0x5be511;getClientsWithBotID(_0x5db8fb)['forEach'](_0x42522a=>{getSocket(_0x42522a['id'])['disconnect'](!![]),removeClient(_0x42522a['id']);}),pid[_0x5db8fb]&&(pid[_0x5db8fb][_0x4b2b31(0x1c4)](),pid[_0x5db8fb]=null);}function restartBot(_0x1c804a){if(pid[_0x1c804a])pid[_0x1c804a]['kill']();}function addBot(){const _0x3c1f5b=_0x5be511;let _0x520c7f;for(let _0x57f54b=0x1;_0x57f54b<0x3e9;_0x57f54b++){_0x520c7f=_0x57f54b['toString']()[_0x3c1f5b(0x278)](0x3,'0');let _0x3b1ae4=config['find'](_0x11a117=>_0x11a117[_0x3c1f5b(0x17a)]==_0x520c7f);if(!_0x3b1ae4)break;}if(_0x520c7f===_0x3c1f5b(0x283)){logging(_0x3c1f5b(0x1ae));return;}logging(_0x3c1f5b(0x1a3)+_0x520c7f),dbConfig[_0x3c1f5b(0x1b6)]('bots')[_0x3c1f5b(0x19b)]({'botID':_0x520c7f,'botname':_0x3c1f5b(0x2ba)+_0x520c7f,'status':'new','live':''})[_0x3c1f5b(0x263)](),startBot([_0x520c7f,userID],{'cwd':bbpath},function(_0x576d9b){if(_0x576d9b)logging(_0x576d9b);}),config=getConfiguration(),io['to'](_0x3c1f5b(0x25b))[_0x3c1f5b(0x1c3)](_0x3c1f5b(0x210),config);}function deleteBot(_0x3c067d){const _0x508afd=_0x5be511;getClientsWithBotID(_0x3c067d)[_0x508afd(0x1f4)](_0x32e59f=>{const _0x4aa373=_0x508afd;getSocket(_0x32e59f['id'])[_0x4aa373(0x2dc)](!![]),removeClient(_0x32e59f['id']);}),dbConfig[_0x508afd(0x1b6)](_0x508afd(0x210))[_0x508afd(0x1a5)]({'botID':_0x3c067d})[_0x508afd(0x263)](),logging(_0x508afd(0x1fe)+_0x3c067d),stopBot(_0x3c067d);try{fs['unlinkSync'](path[_0x508afd(0x298)](configpath,'bot-'+_0x3c067d+_0x508afd(0x218))),fs[_0x508afd(0x176)](path[_0x508afd(0x298)](configpath,'bot-'+_0x3c067d+'-events.json')),fs['unlinkSync'](path[_0x508afd(0x298)](configpath,_0x508afd(0x2c5)+_0x3c067d+_0x508afd(0x1fa))),fs['unlinkSync'](path[_0x508afd(0x298)](configpath,_0x508afd(0x2c5)+_0x3c067d+'-results.json'));}catch(_0x214b25){if(_0x214b25)logging(_0x508afd(0x248),_0x214b25);}config=getConfiguration(),io['to'](_0x508afd(0x25b))[_0x508afd(0x1c3)](_0x508afd(0x210),config);}function toggleBot(_0x11a906,_0x51faaf,_0x1ab888){const _0x1759b8=_0x5be511;dbConfig[_0x1759b8(0x1b6)](_0x1759b8(0x210))[_0x1759b8(0x267)]({'botID':_0x11a906})[_0x1759b8(0x20a)]({'status':_0x51faaf})[_0x1759b8(0x20a)]({'live':_0x1ab888})[_0x1759b8(0x263)]();if(_0x51faaf==_0x1759b8(0x170)||_0x51faaf==_0x1759b8(0x297))logging(_0x1759b8(0x2b8)+_0x11a906),startBot([_0x11a906,userID],{'cwd':bbpath},function(_0x2a466e){if(_0x2a466e)logging(_0x2a466e);});else(_0x51faaf==_0x1759b8(0x251)||_0x51faaf==_0x1759b8(0x27b))&&(logging('disabled\x20Bot\x20'+_0x11a906),stopBot(_0x11a906));config=getConfiguration(),io['to'](_0x1759b8(0x25b))[_0x1759b8(0x1c3)](_0x1759b8(0x210),config);}function toggleStatus(_0x4a612f){const _0x389414=_0x5be511;let _0x123ccf=dbConfig[_0x389414(0x1b6)](_0x389414(0x210))['find']({'botID':_0x4a612f})[_0x389414(0x188)](),_0x198376;if(_0x123ccf[_0x389414(0x1cc)]===_0x389414(0x170))_0x198376='disabled';else{if(_0x123ccf['status']===_0x389414(0x297))_0x198376=_0x389414(0x27b);else{if(_0x123ccf[_0x389414(0x1cc)]===_0x389414(0x27b))_0x198376=_0x389414(0x297);else{if(_0x123ccf[_0x389414(0x1cc)]===_0x389414(0x251))_0x198376=_0x389414(0x170);}}}return _0x198376;}function updateStatus(_0x4d20c7,_0xc1823c){const _0x356b74=_0x5be511;dbConfig[_0x356b74(0x1b6)]('bots')['find']({'botID':_0x4d20c7})[_0x356b74(0x20a)]({'status':_0xc1823c})[_0x356b74(0x263)](),config=getConfiguration(),io['to'](_0x356b74(0x25b))[_0x356b74(0x1c3)](_0x356b74(0x210),config);}function updateLive(_0x10b56a,_0x1b7260){const _0x38de59=_0x5be511;dbConfig[_0x38de59(0x1b6)](_0x38de59(0x210))[_0x38de59(0x267)]({'botID':_0x10b56a})[_0x38de59(0x20a)]({'live':_0x1b7260})[_0x38de59(0x263)](),config=getConfiguration(),io['to']('botmanager')[_0x38de59(0x1c3)](_0x38de59(0x210),config);}function updateBotName(_0x26df1c,_0x35f460){const _0x280936=_0x5be511;dbConfig[_0x280936(0x1b6)]('bots')['find']({'botID':_0x26df1c})[_0x280936(0x20a)]({'botname':_0x35f460})['write'](),config=getConfiguration(),io['to'](_0x280936(0x25b))[_0x280936(0x1c3)](_0x280936(0x210),config);}function updateBotManager(){const _0x79dc5d=_0x5be511;config=getConfiguration(),io['to'](_0x79dc5d(0x25b))[_0x79dc5d(0x1c3)](_0x79dc5d(0x210),config);}function toggleBotMode(_0x2be821){const _0x38051d=_0x5be511;if(pid[_0x2be821])pid[_0x2be821][_0x38051d(0x2cb)]({'function':'toggleBotMode','args':null});else{const _0x37f29a=configpath+_0x38051d(0x2c5)+_0x2be821+'-config.json',_0x5d1e26=fs[_0x38051d(0x26e)](_0x37f29a),_0x372936=JSON[_0x38051d(0x22c)](_0x5d1e26),_0x25cd51=_0x372936[_0x38051d(0x1ba)][0x0][_0x38051d(0x2a7)];_0x372936[_0x38051d(0x1ba)][0x0][_0x38051d(0x2a7)]=!_0x25cd51;const _0x1c0cff=JSON[_0x38051d(0x1c9)](_0x372936,null,0x2);fs[_0x38051d(0x2a3)](_0x37f29a,_0x1c0cff),config=getConfiguration(),io['to']('botmanager')[_0x38051d(0x1c3)](_0x38051d(0x210),config);}}function telegramError(_0x4cbacf){const _0x4eadaa=_0x5be511;console[_0x4eadaa(0x21d)](getTimeStamp()+_0x4eadaa(0x221));}function validateTelegram(_0x25fb9e){const _0xfc0b3b=_0x5be511;if(_0x25fb9e[_0xfc0b3b(0x2d8)][_0xfc0b3b(0x1bb)]!=settings[_0xfc0b3b(0x1d4)]&&'@'+_0x25fb9e[_0xfc0b3b(0x2d8)]['username']!=settings['telegramUsername'])return tgBot[_0xfc0b3b(0x2b2)](_0x25fb9e[_0xfc0b3b(0x213)]['id'],_0xfc0b3b(0x2c7),{'parse_mode':_0xfc0b3b(0x1a0)})[_0xfc0b3b(0x200)](_0x357e27=>{telegramError(_0x357e27);}),![];return!![];}async function initTelegram(){const _0x5d9dad=_0x5be511;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x242d6c=_0x5d9dad(0x1f6);_0x242d6c+='\x0a',_0x242d6c+=_0x5d9dad(0x1f7),_0x242d6c+=_0x5d9dad(0x264),_0x242d6c+=_0x5d9dad(0x180),_0x242d6c+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x242d6c+='/on\x20-\x20start\x20bot(s)\x0a',_0x242d6c+='/off\x20-\x20stop\x20bot(s)\x0a',_0x242d6c+=_0x5d9dad(0x16f),_0x242d6c+=_0x5d9dad(0x1db),_0x242d6c+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x242d6c+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x242d6c+=_0x5d9dad(0x2b9),_0x242d6c+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x50295e=_0x5d9dad(0x206);_0x50295e+='\x0a',_0x50295e+=_0x242d6c,tgBot[_0x5d9dad(0x1b0)](/\/start/,_0x437f14=>{const _0x1c658d=_0x5d9dad;if(!validateTelegram(_0x437f14))return;if(settings[_0x1c658d(0x2e2)]!=_0x437f14[_0x1c658d(0x213)]['id'])updateSetting('telegramChatId',_0x437f14[_0x1c658d(0x213)]['id']);updateSetting(_0x1c658d(0x172),!![]),tgBot[_0x1c658d(0x2b2)](_0x437f14[_0x1c658d(0x213)]['id'],_0x50295e)[_0x1c658d(0x200)](_0x44694f=>{telegramError(_0x44694f);});}),tgBot[_0x5d9dad(0x1b0)](/\/enable/,_0x4f7f4b=>{const _0x29d769=_0x5d9dad;if(!validateTelegram(_0x4f7f4b))return;if(settings[_0x29d769(0x2e2)]!=_0x4f7f4b[_0x29d769(0x213)]['id'])updateSetting('telegramChatId',_0x4f7f4b['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x29d769(0x2b2)](_0x4f7f4b['chat']['id'],'Notifications\x20enabled')['catch'](_0x49bae6=>{telegramError(_0x49bae6);});}),tgBot[_0x5d9dad(0x1b0)](/\/config/,async _0x418558=>{const _0x55f99d=_0x5d9dad;if(!validateTelegram(_0x418558))return;tgBot['removeListener'](_0x55f99d(0x229)),tgBot[_0x55f99d(0x2b2)](_0x418558['chat']['id'],_0x55f99d(0x1f5),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':'orders'},{'text':'Alerts','callback_data':_0x55f99d(0x2cd)},{'text':_0x55f99d(0x1f9),'callback_data':'all'}]]}})['catch'](_0x44dfd9=>{telegramError(_0x44dfd9);}),tgBot['on']('callback_query',async _0x1369ba=>{const _0x1d2c8f=_0x55f99d,_0x5831a3=_0x1369ba[_0x1d2c8f(0x17f)],_0x1704d3=_0x1369ba[_0x1d2c8f(0x1ca)];tgBot[_0x1d2c8f(0x16e)](_0x1369ba['id'])['then'](async()=>{const _0x1b4916=_0x1d2c8f;_0x5831a3==_0x1b4916(0x212)&&(updateSetting(_0x1b4916(0x204),_0x1b4916(0x212)),updateSetting('telegramEnabled',!![]),await tgBot[_0x1b4916(0x2b2)](_0x1704d3[_0x1b4916(0x213)]['id'],_0x1b4916(0x1fb))[_0x1b4916(0x200)](_0x212f86=>{telegramError(_0x212f86);}));_0x5831a3==_0x1b4916(0x2cd)&&(updateSetting('telegramEvents','alerts'),updateSetting(_0x1b4916(0x172),!![]),await tgBot[_0x1b4916(0x2b2)](_0x1704d3[_0x1b4916(0x213)]['id'],_0x1b4916(0x195))[_0x1b4916(0x200)](_0x50586b=>{telegramError(_0x50586b);}));_0x5831a3==_0x1b4916(0x1d8)&&(updateSetting('telegramEvents',_0x1b4916(0x1d8)),updateSetting('telegramEnabled',!![]),await tgBot[_0x1b4916(0x2b2)](_0x1704d3[_0x1b4916(0x213)]['id'],_0x1b4916(0x1d3))[_0x1b4916(0x200)](_0xda1d19=>{telegramError(_0xda1d19);}));if(!settings['telegramChatId'])tgBot[_0x1b4916(0x2b2)](_0x1704d3[_0x1b4916(0x213)]['id'],_0x1b4916(0x253))['catch'](_0x2af5de=>{telegramError(_0x2af5de);});}),tgBot['removeListener'](_0x1d2c8f(0x229));});}),tgBot['onText'](/\/status/,_0x3624f1=>{const _0x4d5948=_0x5d9dad;if(!validateTelegram(_0x3624f1))return;const _0x54302c=getBotsWithMode();let _0x6ced63=_0x4d5948(0x1ac);config[_0x4d5948(0x1f4)](_0x2b5194=>{const _0x28b6e4=_0x4d5948,_0x37e300=_0x54302c['find'](_0x4b5042=>_0x4b5042['botID']==_0x2b5194[_0x28b6e4(0x17a)])[_0x28b6e4(0x1a2)];_0x6ced63+=_0x28b6e4(0x2ba)+_0x2b5194[_0x28b6e4(0x17a)]+':\x20'+_0x2b5194[_0x28b6e4(0x1cc)]+_0x28b6e4(0x17b)+_0x37e300+_0x28b6e4(0x17b)+_0x2b5194[_0x28b6e4(0x1b3)]+'\x0a';}),_0x6ced63+='\x0a',_0x6ced63+=_0x4d5948(0x266),_0x6ced63+=!settings['telegramEnabled']?_0x4d5948(0x243):'Notifications\x20enabled\x0a',_0x6ced63+=settings[_0x4d5948(0x172)]?settings[_0x4d5948(0x204)]==_0x4d5948(0x1d8)?_0x4d5948(0x2e0):'Notifications\x20types:\x20'+settings['telegramEvents']+_0x4d5948(0x22a):'',tgBot['sendMessage'](_0x3624f1[_0x4d5948(0x213)]['id'],_0x6ced63,{'parse_mode':'HTML'})[_0x4d5948(0x200)](_0x5ec4b1=>{telegramError(_0x5ec4b1);});}),tgBot[_0x5d9dad(0x1b0)](/\/restart/,_0x2b2d90=>{const _0x52fa1f=_0x5d9dad;if(!validateTelegram(_0x2b2d90))return;tgBot['removeListener'](_0x52fa1f(0x229));const _0x4002d4=getEnabledBots();if(_0x4002d4[_0x52fa1f(0x179)]==0x0)tgBot['sendMessage'](_0x2b2d90[_0x52fa1f(0x213)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x52fa1f(0x200)](_0x2a8fec=>{telegramError(_0x2a8fec);});else{if(_0x4002d4['length']>0x1)_0x4002d4[_0x52fa1f(0x19b)]({'botID':_0x52fa1f(0x1d8)});let _0x54c3b4=[],_0x25c2b4=[];const _0x36b4aa=_0x4002d4['length']%0x4==0x0||_0x4002d4[_0x52fa1f(0x179)]%0x4==0x3||_0x4002d4[_0x52fa1f(0x179)]%0x3==0x1?0x4:0x3;let _0x5cf454=0x0;_0x4002d4[_0x52fa1f(0x1f4)]((_0x72438,_0x329d5e)=>{const _0x112b50=_0x52fa1f;if(_0x329d5e%_0x36b4aa==0x0)_0x25c2b4=[];_0x25c2b4[_0x112b50(0x19b)]({'text':_0x72438[_0x112b50(0x17a)]==_0x112b50(0x1d8)?_0x112b50(0x268):_0x112b50(0x2ba)+_0x72438['botID'],'callback_data':_0x72438['botID']}),_0x329d5e%_0x36b4aa==0x0&&(_0x54c3b4[_0x5cf454]=_0x25c2b4,_0x5cf454++);}),tgBot[_0x52fa1f(0x2b2)](_0x2b2d90[_0x52fa1f(0x213)]['id'],_0x52fa1f(0x28b),{'reply_markup':{'inline_keyboard':_0x54c3b4}})[_0x52fa1f(0x200)](_0x101278=>{telegramError(_0x101278);}),tgBot['on'](_0x52fa1f(0x229),async _0x3a6d79=>{const _0x40aa13=_0x52fa1f,_0x5c0ff6=_0x3a6d79[_0x40aa13(0x17f)],_0x5c5833=_0x3a6d79[_0x40aa13(0x1ca)];tgBot[_0x40aa13(0x16e)](_0x3a6d79['id'])['then'](async()=>{const _0x3cbaf5=_0x40aa13;_0x5c0ff6==_0x3cbaf5(0x1d8)?(tgBot[_0x3cbaf5(0x2b2)](_0x5c5833['chat']['id'],_0x3cbaf5(0x282))[_0x3cbaf5(0x200)](_0x20ecd8=>{telegramError(_0x20ecd8);}),config[_0x3cbaf5(0x1f4)](_0x59d6e6=>{const _0x4fded9=_0x3cbaf5;restartBot(_0x59d6e6[_0x4fded9(0x17a)]);})):(tgBot[_0x3cbaf5(0x2b2)](_0x5c5833[_0x3cbaf5(0x213)]['id'],_0x3cbaf5(0x28c)+_0x5c0ff6)[_0x3cbaf5(0x200)](_0xcd5b7e=>{telegramError(_0xcd5b7e);}),restartBot(_0x5c0ff6));}),tgBot[_0x40aa13(0x1cd)]('callback_query');});}}),tgBot['onText'](/\/on/,_0x2ff61b=>{const _0xa0044a=_0x5d9dad;if(!validateTelegram(_0x2ff61b))return;tgBot['removeListener'](_0xa0044a(0x229));const _0x1cd8d1=getDisabledBots();if(_0x1cd8d1[_0xa0044a(0x179)]==0x0)tgBot['sendMessage'](_0x2ff61b['chat']['id'],_0xa0044a(0x299))[_0xa0044a(0x200)](_0x1a01bc=>{telegramError(_0x1a01bc);});else{if(_0x1cd8d1['length']>0x1)_0x1cd8d1[_0xa0044a(0x19b)]({'botID':_0xa0044a(0x1d8)});let _0x5279de=[],_0x28a744=[];const _0x5ddf1f=_0x1cd8d1[_0xa0044a(0x179)]%0x4==0x0||_0x1cd8d1[_0xa0044a(0x179)]%0x4==0x3||_0x1cd8d1[_0xa0044a(0x179)]%0x3==0x1?0x4:0x3;let _0x18d59b=0x0;_0x1cd8d1['forEach']((_0x53fd49,_0x859402)=>{const _0x1b6f9c=_0xa0044a;if(_0x859402%_0x5ddf1f==0x0)_0x28a744=[];_0x28a744[_0x1b6f9c(0x19b)]({'text':_0x53fd49[_0x1b6f9c(0x17a)]==_0x1b6f9c(0x1d8)?_0x1b6f9c(0x268):'Bot\x20'+_0x53fd49[_0x1b6f9c(0x17a)],'callback_data':_0x53fd49['botID']}),_0x859402%_0x5ddf1f==0x0&&(_0x5279de[_0x18d59b]=_0x28a744,_0x18d59b++);}),tgBot[_0xa0044a(0x2b2)](_0x2ff61b[_0xa0044a(0x213)]['id'],_0xa0044a(0x224),{'reply_markup':{'inline_keyboard':_0x5279de}})[_0xa0044a(0x200)](_0x472623=>{telegramError(_0x472623);}),tgBot['on'](_0xa0044a(0x229),async _0x2dec9d=>{const _0x57d1b0=_0xa0044a,_0x3173ca=_0x2dec9d[_0x57d1b0(0x17f)],_0x2be94d=_0x2dec9d['message'];tgBot['answerCallbackQuery'](_0x2dec9d['id'])[_0x57d1b0(0x20e)](async()=>{const _0x425a5d=_0x57d1b0;_0x3173ca==_0x425a5d(0x1d8)?(tgBot[_0x425a5d(0x2b2)](_0x2be94d[_0x425a5d(0x213)]['id'],_0x425a5d(0x199))[_0x425a5d(0x200)](_0x3cf1cf=>{telegramError(_0x3cf1cf);}),_0x1cd8d1[_0x425a5d(0x1f4)](_0x1ee6d4=>{const _0x18762e=_0x425a5d;if(_0x1ee6d4['botID']!=_0x18762e(0x1d8))toggleBot(_0x1ee6d4[_0x18762e(0x17a)],toggleStatus(_0x1ee6d4['botID']),_0x18762e(0x2e1));})):(tgBot[_0x425a5d(0x2b2)](_0x2be94d[_0x425a5d(0x213)]['id'],_0x425a5d(0x29f)+_0x3173ca)['catch'](_0x35a397=>{telegramError(_0x35a397);}),toggleBot(_0x3173ca,toggleStatus(_0x3173ca),_0x425a5d(0x2e1)));}),tgBot[_0x57d1b0(0x1cd)](_0x57d1b0(0x229));});}}),tgBot[_0x5d9dad(0x1b0)](/\/off/,_0x3f472d=>{const _0x323e38=_0x5d9dad;if(!validateTelegram(_0x3f472d))return;tgBot[_0x323e38(0x1cd)]('callback_query');const _0x61c8f2=getEnabledBots();if(_0x61c8f2['length']==0x0)tgBot['sendMessage'](_0x3f472d[_0x323e38(0x213)]['id'],_0x323e38(0x236))[_0x323e38(0x200)](_0x5ba4f8=>{telegramError(_0x5ba4f8);});else{if(_0x61c8f2[_0x323e38(0x179)]>0x1)_0x61c8f2[_0x323e38(0x19b)]({'botID':_0x323e38(0x1d8)});let _0x4b4d46=[],_0x4bb362=[];const _0x5a7b5e=_0x61c8f2[_0x323e38(0x179)]%0x4==0x0||_0x61c8f2[_0x323e38(0x179)]%0x4==0x3||_0x61c8f2[_0x323e38(0x179)]%0x3==0x1?0x4:0x3;let _0x338151=0x0;_0x61c8f2[_0x323e38(0x1f4)]((_0x2d39a6,_0x2b3c23)=>{const _0x4fb846=_0x323e38;if(_0x2b3c23%_0x5a7b5e==0x0)_0x4bb362=[];_0x4bb362[_0x4fb846(0x19b)]({'text':_0x2d39a6[_0x4fb846(0x17a)]==_0x4fb846(0x1d8)?_0x4fb846(0x268):_0x4fb846(0x2ba)+_0x2d39a6[_0x4fb846(0x17a)],'callback_data':_0x2d39a6['botID']}),_0x2b3c23%_0x5a7b5e==0x0&&(_0x4b4d46[_0x338151]=_0x4bb362,_0x338151++);}),tgBot[_0x323e38(0x2b2)](_0x3f472d['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x4b4d46}})[_0x323e38(0x200)](_0x33a7ec=>{telegramError(_0x33a7ec);}),tgBot['on'](_0x323e38(0x229),async _0xa05102=>{const _0x1c4a6e=_0x323e38,_0x3ad65f=_0xa05102[_0x1c4a6e(0x17f)],_0x274f4c=_0xa05102[_0x1c4a6e(0x1ca)];tgBot[_0x1c4a6e(0x16e)](_0xa05102['id'])[_0x1c4a6e(0x20e)](async()=>{const _0x4bd5c0=_0x1c4a6e;_0x3ad65f==_0x4bd5c0(0x1d8)?(tgBot[_0x4bd5c0(0x2b2)](_0x274f4c[_0x4bd5c0(0x213)]['id'],_0x4bd5c0(0x234))[_0x4bd5c0(0x200)](_0x343f56=>{telegramError(_0x343f56);}),_0x61c8f2[_0x4bd5c0(0x1f4)](_0x29bfe9=>{const _0xdc5bf5=_0x4bd5c0;if(_0x29bfe9[_0xdc5bf5(0x17a)]!=_0xdc5bf5(0x1d8))toggleBot(_0x29bfe9[_0xdc5bf5(0x17a)],toggleStatus(_0x29bfe9[_0xdc5bf5(0x17a)]),_0xdc5bf5(0x2e1));})):(tgBot[_0x4bd5c0(0x2b2)](_0x274f4c[_0x4bd5c0(0x213)]['id'],_0x4bd5c0(0x2d6)+_0x3ad65f)[_0x4bd5c0(0x200)](_0x34b451=>{telegramError(_0x34b451);}),toggleBot(_0x3ad65f,toggleStatus(_0x3ad65f),_0x4bd5c0(0x2e1)));}),tgBot[_0x1c4a6e(0x1cd)]('callback_query');});}}),tgBot[_0x5d9dad(0x1b0)](/\/portfolio/,_0x22cbcc=>{const _0x3708bd=_0x5d9dad;if(!validateTelegram(_0x22cbcc))return;tgBot[_0x3708bd(0x1cd)](_0x3708bd(0x229));const _0x17c02c=getEnabledBots();if(_0x17c02c[_0x3708bd(0x179)]==0x0)tgBot[_0x3708bd(0x2b2)](_0x22cbcc[_0x3708bd(0x213)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x4c3718=>{telegramError(_0x4c3718);});else{if(_0x17c02c[_0x3708bd(0x179)]>0x1){let _0xec5264=[],_0x2502f6=[];const _0x38066f=_0x17c02c[_0x3708bd(0x179)]%0x4==0x0||_0x17c02c['length']%0x4==0x3||_0x17c02c[_0x3708bd(0x179)]%0x3==0x1?0x4:0x3;let _0x3c7d70=0x0;_0x17c02c[_0x3708bd(0x1f4)]((_0x342487,_0x399530)=>{const _0x588615=_0x3708bd;if(_0x399530%_0x38066f==0x0)_0x2502f6=[];_0x2502f6[_0x588615(0x19b)]({'text':'Bot\x20'+_0x342487['botID'],'callback_data':_0x342487[_0x588615(0x17a)]}),_0x399530%_0x38066f==0x0&&(_0xec5264[_0x3c7d70]=_0x2502f6,_0x3c7d70++);}),tgBot[_0x3708bd(0x2b2)](_0x22cbcc['chat']['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0xec5264}})[_0x3708bd(0x200)](_0x3490c3=>{telegramError(_0x3490c3);}),tgBot['on'](_0x3708bd(0x229),async _0x3e5655=>{const _0x557126=_0x3708bd,_0x846580=_0x3e5655[_0x557126(0x17f)],_0x178861=_0x3e5655[_0x557126(0x1ca)];tgBot['answerCallbackQuery'](_0x3e5655['id'])[_0x557126(0x20e)](async()=>{const _0x46cb97=_0x557126;if(pid[_0x846580])pid[_0x846580][_0x46cb97(0x2cb)]({'function':_0x46cb97(0x1c5),'args':null});}),tgBot[_0x557126(0x1cd)]('callback_query');});}else{const _0x430dab=_0x17c02c[0x0][_0x3708bd(0x17a)];if(pid[_0x430dab])pid[_0x430dab]['send']({'function':_0x3708bd(0x1c5),'args':null});}}}),tgBot['onText'](/\/update/,async _0x5baa70=>{const _0x5f6c6b=_0x5d9dad;if(!validateTelegram(_0x5baa70))return;tgBot[_0x5f6c6b(0x1cd)](_0x5f6c6b(0x229)),await getMessages();if(!updateAvailable)tgBot[_0x5f6c6b(0x2b2)](_0x5baa70[_0x5f6c6b(0x213)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date')[_0x5f6c6b(0x200)](_0x17c9d9=>{telegramError(_0x17c9d9);});else!validInstallation?tgBot[_0x5f6c6b(0x2b2)](_0x5baa70[_0x5f6c6b(0x213)]['id'],_0x5f6c6b(0x2ae))[_0x5f6c6b(0x200)](_0xc51a8c=>{telegramError(_0xc51a8c);}):(tgBot[_0x5f6c6b(0x2b2)](_0x5baa70[_0x5f6c6b(0x213)]['id'],_0x5f6c6b(0x24f),{'reply_markup':{'inline_keyboard':[[{'text':_0x5f6c6b(0x19c),'callback_data':_0x5f6c6b(0x269)},{'text':'No','callback_data':'no'}]]}})[_0x5f6c6b(0x200)](_0x5698a5=>{telegramError(_0x5698a5);}),tgBot['on']('callback_query',async _0xf099c=>{const _0xd1cfac=_0x5f6c6b,_0x2cdfb9=_0xf099c[_0xd1cfac(0x17f)],_0x5761fb=_0xf099c[_0xd1cfac(0x1ca)];tgBot[_0xd1cfac(0x16e)](_0xf099c['id'])['then'](async()=>{const _0x3090d8=_0xd1cfac;_0x2cdfb9==_0x3090d8(0x269)&&(await tgBot[_0x3090d8(0x2b2)](_0x5761fb[_0x3090d8(0x213)]['id'],_0x3090d8(0x194))[_0x3090d8(0x200)](_0x1a5782=>{telegramError(_0x1a5782);}),updateBB());_0x2cdfb9=='no'&&await tgBot[_0x3090d8(0x2b2)](_0x5761fb['chat']['id'],_0x3090d8(0x226))[_0x3090d8(0x200)](_0x20a1de=>{telegramError(_0x20a1de);});if(!settings['telegramChatId'])tgBot['sendMessage'](_0x5761fb[_0x3090d8(0x213)]['id'],_0x3090d8(0x253))['catch'](_0x13418f=>{telegramError(_0x13418f);});}),tgBot[_0xd1cfac(0x1cd)](_0xd1cfac(0x229));}));}),tgBot['onText'](/\/toggle/,_0x18cbf2=>{const _0x37b7ca=_0x5d9dad;if(!validateTelegram(_0x18cbf2))return;tgBot[_0x37b7ca(0x1cd)](_0x37b7ca(0x229));const _0x28cced=getBotsWithMode();if(_0x28cced[_0x37b7ca(0x179)]==0x0)tgBot[_0x37b7ca(0x2b2)](_0x18cbf2[_0x37b7ca(0x213)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x37b7ca(0x200)](_0x3c87e4=>{telegramError(_0x3c87e4);});else{let _0x1ab10f=[],_0x48e10f=[];const _0x4a8198=0x2;let _0x309099=0x0;_0x28cced[_0x37b7ca(0x1f4)]((_0x2d296a,_0x356aca)=>{const _0x3aa178=_0x37b7ca;if(_0x356aca%_0x4a8198==0x0)_0x48e10f=[];_0x48e10f[_0x3aa178(0x19b)]({'text':_0x3aa178(0x2ba)+_0x2d296a[_0x3aa178(0x17a)]+'\x20('+_0x2d296a['mode']+')','callback_data':_0x2d296a[_0x3aa178(0x17a)]}),_0x356aca%_0x4a8198==0x0&&(_0x1ab10f[_0x309099]=_0x48e10f,_0x309099++);}),tgBot[_0x37b7ca(0x2b2)](_0x18cbf2['chat']['id'],_0x37b7ca(0x1c0),{'reply_markup':{'inline_keyboard':_0x1ab10f}})[_0x37b7ca(0x200)](_0x352d07=>{telegramError(_0x352d07);}),tgBot['on']('callback_query',async _0x4d3a20=>{const _0x1b2b3c=_0x37b7ca,_0x1738af=_0x4d3a20[_0x1b2b3c(0x17f)],_0x4f9f2e=_0x4d3a20['message'];tgBot[_0x1b2b3c(0x16e)](_0x4d3a20['id'])['then'](async()=>{const _0xf5e181=_0x1b2b3c,_0x1de838=_0x28cced['find'](_0x4b9bc3=>_0x4b9bc3['botID']==_0x1738af),_0x1be286=_0x1de838['mode']=='auto'?_0xf5e181(0x214):_0xf5e181(0x2ac);tgBot['sendMessage'](_0x4f9f2e[_0xf5e181(0x213)]['id'],_0xf5e181(0x182)+_0x1738af+'\x20to\x20'+_0x1be286+_0xf5e181(0x187))[_0xf5e181(0x200)](_0x3fb777=>{telegramError(_0x3fb777);}),toggleBotMode(_0x1738af);}),tgBot[_0x1b2b3c(0x1cd)](_0x1b2b3c(0x229));});}}),tgBot['onText'](/\/names/,_0x335c6a=>{const _0x438f68=_0x5d9dad;if(!validateTelegram(_0x335c6a))return;let _0x5ccccf='';config[_0x438f68(0x1f4)](_0xb8bab2=>{const _0x3ba0bb=_0x438f68;_0x5ccccf+=_0x3ba0bb(0x2ba)+_0xb8bab2[_0x3ba0bb(0x17a)]+':\x20'+_0xb8bab2[_0x3ba0bb(0x2a2)]+'\x0a';}),tgBot[_0x438f68(0x2b2)](_0x335c6a[_0x438f68(0x213)]['id'],_0x5ccccf,{'parse_mode':_0x438f68(0x1a0)})[_0x438f68(0x200)](_0x57f6b7=>{telegramError(_0x57f6b7);});}),tgBot[_0x5d9dad(0x1b0)](/\/disable/,_0x4b9d4c=>{const _0x104867=_0x5d9dad;if(!validateTelegram(_0x4b9d4c))return;tgBot[_0x104867(0x2b2)](_0x4b9d4c[_0x104867(0x213)]['id'],_0x104867(0x26c))[_0x104867(0x200)](_0x499eff=>{telegramError(_0x499eff);}),updateSetting('telegramEnabled',![]);}),tgBot['onText'](/\/help/,_0xb51d30=>{const _0x49bf2b=_0x5d9dad;if(!validateTelegram(_0xb51d30))return;tgBot[_0x49bf2b(0x2b2)](_0xb51d30[_0x49bf2b(0x213)]['id'],_0x242d6c)[_0x49bf2b(0x200)](_0x5d7127=>{telegramError(_0x5d7127);});}),tgBot['on']('polling_error',_0x524b89=>{const _0x5b8a55=_0x5d9dad;_0x524b89['toString']()[_0x5b8a55(0x24d)](_0x5b8a55(0x1ed))&&(logging('Invalid\x20Telegram\x20token'),tgBot[_0x5b8a55(0x2d2)](),tgBot=null,io['to']('botmanager')[_0x5b8a55(0x1c3)]('notification',_0x5b8a55(0x286)));}),process[_0x5d9dad(0x20d)](_0x5d9dad(0x203),()=>{const _0x14fd7a=_0x5d9dad;if(tgBot)tgBot[_0x14fd7a(0x2d2)]();process['exit'](0x1);}),process[_0x5d9dad(0x20d)]('SIGTERM',()=>{const _0x4af051=_0x5d9dad;if(tgBot)tgBot[_0x4af051(0x2d2)]();process[_0x4af051(0x26d)](0x1);});}}function disableTelegram(){const _0x2a1096=_0x5be511;tgBot&&(tgBot[_0x2a1096(0x2d2)](),tgBot=null);}function sendTelegram(_0x3b4633,_0x53d196){const _0x28c5ba=_0x5be511;if(settings[_0x28c5ba(0x172)]){if(settings[_0x28c5ba(0x204)]==_0x28c5ba(0x1d8)||(_0x53d196[_0x28c5ba(0x1f3)]==_0x28c5ba(0x231)||_0x53d196['type']==_0x28c5ba(0x185))&&settings[_0x28c5ba(0x204)]=='alerts'||_0x53d196[_0x28c5ba(0x1f3)]==_0x28c5ba(0x29c)&&settings[_0x28c5ba(0x204)]==_0x28c5ba(0x212)){if(tgBot&&settings['telegramChatId']){if(_0x53d196[_0x28c5ba(0x1dc)])tgBot[_0x28c5ba(0x2b2)](settings[_0x28c5ba(0x2e2)],_0x53d196[_0x28c5ba(0x2a2)]+_0x28c5ba(0x28e)+_0x53d196[_0x28c5ba(0x27c)])[_0x28c5ba(0x200)](_0x33e38a=>{telegramError(_0x33e38a);});else tgBot[_0x28c5ba(0x2b2)](settings[_0x28c5ba(0x2e2)],'Bot\x20'+_0x3b4633+_0x28c5ba(0x28e)+_0x53d196[_0x28c5ba(0x27c)])[_0x28c5ba(0x200)](_0xafadc0=>{telegramError(_0xafadc0);});}}}}async function sendTelegramMsg(_0x5a4e4c,_0x4b9c52='HTML'){const _0x52c24f=_0x5be511;return settings[_0x52c24f(0x172)]&&tgBot&&settings['telegramChatId']?(await tgBot[_0x52c24f(0x2b2)](settings[_0x52c24f(0x2e2)],_0x5a4e4c,{'parse_mode':_0x4b9c52})['catch'](_0x3f2066=>{telegramError(_0x3f2066);}),!![]):![];}function getDeviceWithIp(_0x292b90){const _0x329dfb=_0x5be511;return devices[_0x329dfb(0x267)](_0x12718d=>_0x12718d['ip']===_0x292b90);}function temporaryAccess2FA(_0x329c11,_0x9fb83c){const _0x58e17e=_0x5be511;let _0x151e37=new Date(),_0x46dc9e=![];if(lastIpApproval){if(_0x151e37-lastIpApproval<0x1388)_0x46dc9e=!![];}lastIpApproval=new Date();if(_0x46dc9e)return;tgBot&&settings[_0x58e17e(0x2e2)]&&(tgBot[_0x58e17e(0x1cd)](_0x58e17e(0x229)),tgBot[_0x58e17e(0x2b2)](settings[_0x58e17e(0x2e2)],_0x58e17e(0x20b)+normalizeIP(_0x9fb83c)['show']+_0x58e17e(0x2ce),{'parse_mode':_0x58e17e(0x1a0),'reply_markup':{'inline_keyboard':[[{'text':_0x58e17e(0x27e),'callback_data':'5'},{'text':_0x58e17e(0x1cb),'callback_data':'15'},{'text':_0x58e17e(0x241),'callback_data':'30'},{'text':_0x58e17e(0x247),'callback_data':'reject'}]]}})['catch'](_0x9ea9f9=>{telegramError(_0x9ea9f9);}),tgBot['on'](_0x58e17e(0x229),async _0x396b7a=>{const _0x2ad6f4=_0x58e17e,_0x4832cf=_0x396b7a[_0x2ad6f4(0x17f)],_0x1be9f8=_0x396b7a['message'];tgBot[_0x2ad6f4(0x16e)](_0x396b7a['id'])[_0x2ad6f4(0x20e)](async()=>{const _0x1b0b16=_0x2ad6f4;devices[_0x329c11][_0x1b0b16(0x1a7)]={'clientip':_0x9fb83c,'timestamp':new Date()[_0x1b0b16(0x295)](),'expiry':_0x4832cf},_0x4832cf!=_0x1b0b16(0x247)?(await tgBot[_0x1b0b16(0x2b2)](_0x1be9f8[_0x1b0b16(0x213)]['id'],'Access\x20enabled\x20for\x20'+_0x4832cf+_0x1b0b16(0x2dd),{'parse_mode':'HTML'})['catch'](_0x1f023d=>{telegramError(_0x1f023d);}),io['to'](_0x329c11)[_0x1b0b16(0x1c3)](_0x1b0b16(0x1cc),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x1b0b16(0x2b2)](_0x1be9f8[_0x1b0b16(0x213)]['id'],_0x1b0b16(0x201))['catch'](_0x3163c6=>{telegramError(_0x3163c6);}),io['to'](_0x329c11)[_0x1b0b16(0x1c3)](_0x1b0b16(0x1cc),{'access':{'allow':![],'reason':_0x1b0b16(0x24b),'token':null}}));}),tgBot[_0x2ad6f4(0x1cd)](_0x2ad6f4(0x229));}));}function loginAccess2FA(_0x1f1bd8,_0x48f5c8){const _0x2ec8b0=_0x5be511;tgBot&&settings[_0x2ec8b0(0x2e2)]&&(tgBot[_0x2ec8b0(0x1cd)]('callback_query'),tgBot[_0x2ec8b0(0x2b2)](settings['telegramChatId'],_0x2ec8b0(0x1a1)+normalizeIP(_0x48f5c8)[_0x2ec8b0(0x1d7)]+_0x2ec8b0(0x2ce),{'parse_mode':_0x2ec8b0(0x1a0),'reply_markup':{'inline_keyboard':[[{'text':_0x2ec8b0(0x1dd),'callback_data':loginExpiry},{'text':'reject','callback_data':'reject'}]]}})[_0x2ec8b0(0x200)](_0x26a1ef=>{telegramError(_0x26a1ef);}),tgBot['on']('callback_query',async _0x549ad0=>{const _0x3abf93=_0x2ec8b0,_0x411597=_0x549ad0[_0x3abf93(0x17f)],_0x2d2cb1=_0x549ad0[_0x3abf93(0x1ca)];tgBot['answerCallbackQuery'](_0x549ad0['id'])['then'](async()=>{const _0x3ca787=_0x3abf93;devices[_0x1f1bd8][_0x3ca787(0x1e5)]={'clientip':_0x48f5c8,'timestamp':new Date()[_0x3ca787(0x295)](),'expiry':_0x411597},_0x411597!=_0x3ca787(0x247)?(await tgBot[_0x3ca787(0x2b2)](_0x2d2cb1[_0x3ca787(0x213)]['id'],_0x3ca787(0x2c2),{'parse_mode':_0x3ca787(0x1a0)})[_0x3ca787(0x200)](_0x2adf43=>{telegramError(_0x2adf43);}),io['to'](_0x1f1bd8)['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot['sendMessage'](_0x2d2cb1[_0x3ca787(0x213)]['id'],_0x3ca787(0x2aa))['catch'](_0x2d864e=>{telegramError(_0x2d864e);}),io['to'](_0x1f1bd8)[_0x3ca787(0x1c3)]('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x3abf93(0x1cd)](_0x3abf93(0x229));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x527afd=_0x5be511;return dbConfig['get'](_0x527afd(0x210))['sortBy'](_0x527afd(0x17a))[_0x527afd(0x293)]({'status':'enabled'})['value']()||[];}function getDisabledBots(){const _0x52a186=_0x5be511;return dbConfig[_0x52a186(0x1b6)](_0x52a186(0x210))[_0x52a186(0x2e5)](_0x52a186(0x17a))[_0x52a186(0x293)]({'status':'disabled'})[_0x52a186(0x188)]()||[];}function getBotsWithMode(){const _0xb0a72a=_0x5be511,_0x44c105=dbConfig[_0xb0a72a(0x1b6)]('bots')[_0xb0a72a(0x2e5)]('botID')[_0xb0a72a(0x188)]()||[];return _0x44c105[_0xb0a72a(0x1f4)](_0x4fdeb0=>{const _0x5ecaba=_0xb0a72a,_0x358368=configpath+_0x5ecaba(0x2c5)+_0x4fdeb0[_0x5ecaba(0x17a)]+_0x5ecaba(0x218),_0x3fca79=fs['existsSync'](_0x358368);if(_0x3fca79){const _0x212fb3=fs[_0x5ecaba(0x26e)](_0x358368);try{const _0x2d1bba=JSON[_0x5ecaba(0x22c)](_0x212fb3),_0x4175cb=_0x2d1bba?_0x2d1bba[_0x5ecaba(0x1ba)][0x0][_0x5ecaba(0x2a7)]:![];_0x4fdeb0[_0x5ecaba(0x1a2)]=_0x4175cb?_0x5ecaba(0x2ac):_0x5ecaba(0x214);}catch(_0x2b6be3){_0x4fdeb0[_0x5ecaba(0x1a2)]=_0x5ecaba(0x214);}}else _0x4fdeb0['mode']=_0x5ecaba(0x214);}),_0x44c105;}async function initUser(){const _0x59e6cf=_0x5be511;if(!settings[_0x59e6cf(0x1eb)]){const _0xf2f69c=uuidRandom();mixpanel[_0x59e6cf(0x2bb)](_0xf2f69c),updateSetting('userid',_0xf2f69c);}}async function initSecure(){const _0x4f9851=_0x5be511;let _0x2afe4e=getSecure();if(!_0x2afe4e[_0x4f9851(0x289)](_0x4f9851(0x275))){let _0x3232e8=await generateKeys();_0x2afe4e[_0x4f9851(0x2df)]=_0x3232e8[_0x4f9851(0x2df)],_0x2afe4e[_0x4f9851(0x239)]=_0x3232e8[_0x4f9851(0x239)],_0x2afe4e[_0x4f9851(0x275)]=crypto[_0x4f9851(0x2a0)](0x20)[_0x4f9851(0x20c)]('hex');;storeSecure(_0x2afe4e);}}function getSettings(){const _0x2a52f2=_0x5be511;return dbSettings[_0x2a52f2(0x1b6)]('settings')[_0x2a52f2(0x188)]()||{};}function getSecure(){const _0x459230=_0x5be511;return dbSecure[_0x459230(0x1b6)](_0x459230(0x276))[_0x459230(0x188)]()||{};}function getBlacklist(){const _0x54d874=_0x5be511;return dbSecure[_0x54d874(0x1b6)](_0x54d874(0x1e3))['value']()||[];}function broadcastToBots(_0x4f3a37,_0x340880){config['forEach'](_0x1b42bb=>{const _0x56dd14=_0x1e72;if(_0x1b42bb[_0x56dd14(0x1cc)]==_0x56dd14(0x170)&&_0x1b42bb[_0x56dd14(0x1b3)]==_0x56dd14(0x1d1)){if(pid[_0x1b42bb[_0x56dd14(0x17a)]])pid[_0x1b42bb[_0x56dd14(0x17a)]][_0x56dd14(0x2cb)]({[_0x4f3a37]:_0x340880});}});}function storeSettings(_0x53e7fe,_0x310c4c=![]){const _0x4c6226=_0x5be511;_0x53e7fe={...settings,..._0x53e7fe};if(_0x310c4c&&_0x53e7fe[_0x4c6226(0x2d5)]!=_0x4c6226(0x2c9)&&_0x53e7fe['bbPassword']!=''){const _0x369e8b=crypt[_0x4c6226(0x177)](secure[_0x4c6226(0x239)],_0x53e7fe[_0x4c6226(0x2d5)])[_0x4c6226(0x1ca)][_0x4c6226(0x1ff)]('@')[0x0],_0xc95b11=bcrypt[_0x4c6226(0x26f)](_0x369e8b,saltRounds);_0x53e7fe={..._0x53e7fe,'bbPassword':_0xc95b11};}if(_0x310c4c&&_0x53e7fe['telegramToken']!=_0x4c6226(0x2c9)&&_0x53e7fe['telegramToken']!=''){const _0x384331=crypt[_0x4c6226(0x177)](secure[_0x4c6226(0x239)],_0x53e7fe[_0x4c6226(0x1c7)])[_0x4c6226(0x1ca)][_0x4c6226(0x1ff)]('@')[0x0];_0x53e7fe={..._0x53e7fe,'telegramToken':_0x384331};}const _0x1db4ac=_0x53e7fe[_0x4c6226(0x1c7)]!='************'&&_0x53e7fe[_0x4c6226(0x1c7)]!=settings[_0x4c6226(0x1c7)]||_0x53e7fe['telegramUsername']!=settings['telegramUsername'],_0x5b97ab=_0x53e7fe[_0x4c6226(0x1c7)]==''||_0x53e7fe[_0x4c6226(0x1d4)]=='';if(_0x1db4ac)_0x53e7fe[_0x4c6226(0x204)]=_0x4c6226(0x1d8);for(const [_0x3d8ccd,_0x3eb55a]of Object[_0x4c6226(0x1de)](_0x53e7fe)){if(_0x3d8ccd==_0x4c6226(0x1c7)&&_0x3eb55a==_0x4c6226(0x2c9)){_0x53e7fe[_0x4c6226(0x1c7)]=settings[_0x4c6226(0x1c7)];continue;};if(_0x3d8ccd==_0x4c6226(0x2d5)&&_0x3eb55a==_0x4c6226(0x2c9)){_0x53e7fe[_0x4c6226(0x2d5)]=settings[_0x4c6226(0x2d5)];continue;};dbSettings['set']('settings.'+_0x3d8ccd,_0x3eb55a)[_0x4c6226(0x263)]();}settings=_0x53e7fe,io['to'](_0x4c6226(0x25b))['emit'](_0x4c6226(0x25a),cleanSettings()),broadcastToBots(_0x4c6226(0x222),settings[_0x4c6226(0x222)]);if(_0x1db4ac&&!_0x5b97ab)initTelegram();if(_0x1db4ac&&_0x5b97ab)disableTelegram();getAllClients()[_0x4c6226(0x1f4)](_0x5ca5b3=>{const _0x55a369=_0x4c6226;getSocket(_0x5ca5b3['id'])[_0x55a369(0x1c3)]('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x3761ee,_0x316936){const _0x208c02=_0x5be511;dbSettings[_0x208c02(0x1ec)](_0x208c02(0x1fd)+_0x3761ee,_0x316936)[_0x208c02(0x263)](),settings=getSettings(),io['to'](_0x208c02(0x25b))[_0x208c02(0x1c3)](_0x208c02(0x25a),cleanSettings());}function storeSecure(_0x5937a8){const _0x3b5934=_0x5be511;dbSecure[_0x3b5934(0x1b6)](_0x3b5934(0x276))[_0x3b5934(0x19b)](_0x5937a8)[_0x3b5934(0x263)](),secure=_0x5937a8;}function _0x1e72(_0x26adb2,_0x298987){const _0x4ac296=_0x5c94();return _0x1e72=function(_0x44e707,_0x523e45){_0x44e707=_0x44e707-0x16e;let _0x5c946a=_0x4ac296[_0x44e707];return _0x5c946a;},_0x1e72(_0x26adb2,_0x298987);}function addBlacklist(_0x48a1e8){const _0x399ba3=_0x5be511;cleanBlacklist();let _0x1ee187;devices[_0x48a1e8]['telegramIpApproval']?_0x1ee187=Math['max'](devices[_0x48a1e8][_0x399ba3(0x1a7)][_0x399ba3(0x1bf)],loginExpiry):_0x1ee187=loginExpiry,dbSecure[_0x399ba3(0x1b6)](_0x399ba3(0x1e3))[_0x399ba3(0x19b)]({'expiry':new Date()['getTime']()+_0x1ee187*0x3c*0x3e8,'token':devices[_0x48a1e8][_0x399ba3(0x23d)][_0x399ba3(0x209)]})['write'](),blacklist=dbSecure[_0x399ba3(0x1b6)]('blacklist')['value']();}function cleanBlacklist(){const _0x21060f=_0x5be511;let _0x2eab97=dbSecure[_0x21060f(0x1b6)]('blacklist')[_0x21060f(0x2d9)]()[_0x21060f(0x188)](),_0x4266c8=new Date()[_0x21060f(0x295)]();_0x2eab97[_0x21060f(0x1f4)](_0x35ee50=>{const _0xde6cd7=_0x21060f;_0x35ee50[_0xde6cd7(0x1bf)]<_0x4266c8&&dbSecure[_0xde6cd7(0x1b6)](_0xde6cd7(0x1e3))['remove']({'expiry':_0x35ee50['expiry']})[_0xde6cd7(0x263)]();});}function initStates(){const _0xe8f88a=_0x5be511;let _0x1b8f6e=getConfiguration();_0x1b8f6e[_0xe8f88a(0x1f4)](_0x8438bb=>{_0x8438bb['live']='stopped';}),storeConfiguration(_0x1b8f6e);}function onKeys(){const _0x44188b=new RSA();return new Promise(_0x2d8ccc=>{const _0x3160a5=_0x1e72;_0x44188b[_0x3160a5(0x193)]()[_0x3160a5(0x20e)](_0x7a8d21=>{_0x2d8ccc(_0x7a8d21);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x10f829=_0x5be511;let _0x502a1f=getSettings(),_0x3ad3b4=![];!_0x502a1f['hasOwnProperty'](_0x10f829(0x23a))&&(_0x502a1f['lastmsgtelegram']=0x0,_0x3ad3b4=!![]);!_0x502a1f[_0x10f829(0x289)](_0x10f829(0x2b3))&&(_0x502a1f['lastmsgemitted']=0x0,_0x3ad3b4=!![]);!_0x502a1f[_0x10f829(0x289)](_0x10f829(0x22d))&&(_0x502a1f[_0x10f829(0x22d)]=_0x10f829(0x287),_0x3ad3b4=!![]);if(_0x3ad3b4)storeSettings(_0x502a1f);}function storeConfiguration(_0x4fe044){const _0x52f2e2=_0x5be511;dbConfig['get'](_0x52f2e2(0x210))[_0x52f2e2(0x1a5)]()[_0x52f2e2(0x263)](),_0x4fe044[_0x52f2e2(0x1f4)](_0x14ed13=>{const _0x2a41df=_0x52f2e2;delete _0x14ed13[_0x2a41df(0x1a2)];}),dbConfig[_0x52f2e2(0x1b6)](_0x52f2e2(0x210))[_0x52f2e2(0x19b)](..._0x4fe044)[_0x52f2e2(0x263)](),config=_0x4fe044;}function resetPassword(){const _0x48bd32=_0x5be511;tgBot&&settings['telegramChatId']&&(tgBot[_0x48bd32(0x1cd)](_0x48bd32(0x229)),tgBot['sendMessage'](settings[_0x48bd32(0x2e2)],_0x48bd32(0x216),{'parse_mode':_0x48bd32(0x1a0),'reply_markup':{'inline_keyboard':[[{'text':_0x48bd32(0x269),'callback_data':_0x48bd32(0x269)},{'text':'no','callback_data':'no'}]]}})[_0x48bd32(0x200)](_0x347342=>{telegramError(_0x347342);}),tgBot['on'](_0x48bd32(0x229),async _0x4472c5=>{const _0x38b9c4=_0x48bd32,_0x42323f=_0x4472c5[_0x38b9c4(0x17f)],_0x449b35=_0x4472c5[_0x38b9c4(0x1ca)];tgBot[_0x38b9c4(0x16e)](_0x4472c5['id'])['then'](async()=>{const _0x24cd46=_0x38b9c4;if(_0x42323f!='no'){const _0x60e8e0=0xf,_0xb44cb8=_0x24cd46(0x257),_0x5713d8=Array[_0x24cd46(0x2d8)](crypto[_0x24cd46(0x290)](new Uint32Array(_0x60e8e0)))[_0x24cd46(0x1e0)](_0xe2efd7=>_0xb44cb8[_0xe2efd7%_0xb44cb8['length']])[_0x24cd46(0x298)](''),_0x12656b=bcrypt['hashSync'](_0x5713d8,saltRounds);storeSettings({'bbPassword':_0x12656b}),await tgBot[_0x24cd46(0x2b2)](_0x449b35['chat']['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x5713d8,{'parse_mode':_0x24cd46(0x1a0)})[_0x24cd46(0x200)](_0x1a2261=>{telegramError(_0x1a2261);});}else await tgBot['sendMessage'](_0x449b35[_0x24cd46(0x213)]['id'],_0x24cd46(0x1d2))[_0x24cd46(0x200)](_0x3499a7=>{telegramError(_0x3499a7);});}),tgBot[_0x38b9c4(0x1cd)](_0x38b9c4(0x229));}));}function logging(_0x487b20){const _0x136b0f=_0x5be511;console[_0x136b0f(0x21d)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x487b20);if(tgBot&&settings[_0x136b0f(0x2e2)]&&settings[_0x136b0f(0x204)]!=_0x136b0f(0x212))tgBot[_0x136b0f(0x2b2)](settings[_0x136b0f(0x2e2)],'Bot\x20Mgr\x20>\x20'+_0x487b20)[_0x136b0f(0x200)](_0xd89eb9=>{telegramError(_0xd89eb9);});}function getServerTime(){const _0x1ad7ff=_0x5be511,_0x140df7=new Date();return _0x140df7[_0x1ad7ff(0x1b9)]()+'/'+(_0x140df7[_0x1ad7ff(0x189)]()+0x1)[_0x1ad7ff(0x20c)]()[_0x1ad7ff(0x278)](0x2,'0')+'/'+_0x140df7[_0x1ad7ff(0x238)]()['toString']()[_0x1ad7ff(0x278)](0x2,'0')+'\x20'+_0x140df7[_0x1ad7ff(0x1ad)]()[_0x1ad7ff(0x20c)]()[_0x1ad7ff(0x278)](0x2,'0')+':'+_0x140df7['getMinutes']()[_0x1ad7ff(0x20c)]()[_0x1ad7ff(0x278)](0x2,'0')+':'+_0x140df7['getSeconds']()[_0x1ad7ff(0x20c)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x442a0d=_0x5be511,_0x1b1f37=shiftedTime();return _0x1b1f37['getFullYear']()+'/'+(_0x1b1f37[_0x442a0d(0x189)]()+0x1)[_0x442a0d(0x20c)]()['padStart'](0x2,'0')+'/'+_0x1b1f37[_0x442a0d(0x238)]()[_0x442a0d(0x20c)]()[_0x442a0d(0x278)](0x2,'0')+'\x20'+_0x1b1f37[_0x442a0d(0x1ad)]()['toString']()[_0x442a0d(0x278)](0x2,'0')+':'+_0x1b1f37[_0x442a0d(0x28f)]()[_0x442a0d(0x20c)]()[_0x442a0d(0x278)](0x2,'0')+':'+_0x1b1f37[_0x442a0d(0x28a)]()[_0x442a0d(0x20c)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x50d3cd=_0x5be511,_0x2ecb15=new Date();let _0x31c79b=_0x2ecb15;if(settings['timeshift']&&settings[_0x50d3cd(0x222)]!==0x0)_0x31c79b=fns['add'](_0x2ecb15,{'hours':settings[_0x50d3cd(0x222)]});return _0x31c79b;}function startScheduler(){const _0x41cc69=_0x5be511;let _0x32f194=new Date()[_0x41cc69(0x211)]();_0x32f194==0x1&&backupConfigFiles();_0x32f194==0x9&&triggerAnalytics();_0x32f194%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x5eff16=_0x5be511;fs[_0x5eff16(0x25f)](configpath,{'withFileTypes':!![]})[_0x5eff16(0x1f4)](_0xd45179=>{const _0x835155=_0x5eff16;if(!_0xd45179['isDirectory']())fs[_0x835155(0x1a4)](configpath+_0xd45179[_0x835155(0x1c2)],configbackuppath+_0xd45179[_0x835155(0x1c2)]);});}async function getPublicIp(){const _0x57571d=_0x5be511;try{const _0x3de2ad=await axios['get'](_0x57571d(0x26a));publicip=_0x3de2ad[_0x57571d(0x17f)]['ip'];}catch(_0x33ca3a){}}async function triggerAnalytics(_0x453764=![]){const _0x23c2c1=_0x5be511;if(!publicip)await getPublicIp();const _0xea2362=getBotsWithMode();let _0x30a2cc=0x0;_0xea2362[_0x23c2c1(0x1f4)](_0x4124d4=>{if(_0x4124d4['status']==='enabled')_0x30a2cc++;}),mixpanel[_0x23c2c1(0x18c)](_0x23c2c1(0x2bd),{'distinct_id':settings[_0x23c2c1(0x1eb)],'ip':publicip,'version':serverversion,'numbots':_0xea2362[_0x23c2c1(0x179)],'numbotsenabled':_0x30a2cc}),!_0x453764&&analytics['page']({'title':_0x23c2c1(0x1f0),'href':'https://hodlerhacks.com','path':'/v'+serverversion});}async function getMessages(){const _0x43bbbc=_0x5be511,_0x41f692=_0x43bbbc(0x23f),_0x5a5689=new GraphQLClient(_0x41f692),_0x5d1890={'authorization':_0x43bbbc(0x1e4)},_0x54e26c=serverversion['split']('.'),_0x3baf89=_0x54e26c[0x0]+'.'+_0x54e26c[0x1],_0xbf6f5d=Math['min'](settings['lastmsgtelegram'],settings[_0x43bbbc(0x2b3)]),_0x33975f={'last':parseInt(_0xbf6f5d),'bbm':_0x3baf89},_0x480414=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x3ce8ca;try{_0x3ce8ca=await _0x5a5689[_0x43bbbc(0x1ab)](_0x480414,_0x33975f,_0x5d1890);}catch(_0x553803){}if(_0x3ce8ca&&_0x3ce8ca['messages']){let _0x1bd761=settings[_0x43bbbc(0x23a)];newMessages=[];for(const _0x2ca379 of _0x3ce8ca[_0x43bbbc(0x280)]){newMessages[_0x43bbbc(0x19b)](_0x2ca379);if(_0x2ca379[_0x43bbbc(0x291)])updateSetting('latestversion',_0x2ca379['bbvNew']);let _0x5077eb=_0x2ca379[_0x43bbbc(0x291)]?serverversion>=_0x2ca379[_0x43bbbc(0x291)]:![];if(!_0x5077eb&&_0x2ca379[_0x43bbbc(0x242)]>_0x1bd761){if(_0x2ca379[_0x43bbbc(0x1e7)]===_0x43bbbc(0x1e1)||serverversion[_0x43bbbc(0x2af)](_0x2ca379[_0x43bbbc(0x1e7)])){let _0xb4b33d=''+_0x2ca379[_0x43bbbc(0x26b)]+'\x0a\x0a'+_0x2ca379[_0x43bbbc(0x1ca)];const _0x40c2ce=await sendTelegramMsg(toTelegramMarkdown(_0xb4b33d),_0x43bbbc(0x2ad));if(_0x40c2ce)_0x1bd761=_0x2ca379[_0x43bbbc(0x242)];}}}updateAvailable=isNewerVersion(settings[_0x43bbbc(0x22d)],serverversion),updateSetting(_0x43bbbc(0x23a),_0x1bd761),emitMessages();}}function emitMessages(){const _0x82e79d=_0x5be511,_0x130b4b=settings[_0x82e79d(0x2b3)];let _0x7e73e1=[];newMessages[_0x82e79d(0x1f4)](_0x5a49bd=>{const _0x1e8351=_0x82e79d;_0x5a49bd[_0x1e8351(0x242)]>_0x130b4b&&_0x7e73e1[_0x1e8351(0x19b)](_0x5a49bd);}),_0x7e73e1[_0x82e79d(0x179)]>0x0&&getAllClients()['forEach'](_0x224882=>{const _0x5dcc7a=_0x82e79d;getSocket(_0x224882['id'])['emit'](_0x5dcc7a(0x1ca),_0x7e73e1);});}function confirmMessage(_0x3fa620){updateSetting('lastmsgemitted',Number(_0x3fa620));}function isNewerVersion(_0x438bf2,_0x1e5e2b){const _0x32193c=_0x5be511,_0x17d1a7=_0x1e5e2b['split']('.'),_0x1109ce=_0x438bf2[_0x32193c(0x1ff)]('.');for(var _0x203061=0x0;_0x203061<_0x1109ce[_0x32193c(0x179)];_0x203061++){const _0x45d7cd=~~_0x1109ce[_0x203061],_0x236e3d=~~_0x17d1a7[_0x203061];if(_0x45d7cd>_0x236e3d)return!![];if(_0x45d7cd<_0x236e3d)return![];}return![];}function toTelegramMarkdown(_0x3daed6){const _0x59139a=_0x5be511,_0x356960=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x597cb1=/\*{2}(.+?)\*{2}/gim;return _0x3daed6=_0x3daed6[_0x59139a(0x273)](_0x356960,_0x59139a(0x1aa))[_0x59139a(0x273)](_0x597cb1,_0x59139a(0x271)),_0x3daed6;}function validateCredentials(_0x50785e,_0x2deda4){const _0x5d6541=_0x5be511;if(_0x50785e[_0x5d6541(0x1bb)]==settings[_0x5d6541(0x17c)]&&bcrypt[_0x5d6541(0x27a)](_0x50785e[_0x5d6541(0x217)],settings[_0x5d6541(0x2d5)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x5d6541(0x1fc),'token':null};else{const _0x272a57=generateLoginToken(_0x2deda4);return{'allow':!![],'reason':_0x5d6541(0x284),'token':_0x272a57};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x323b0c){const _0x380312=generateLoginToken(_0x323b0c);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x380312};}function validateAccess(_0x500600,_0x205448){const _0x596129=_0x5be511;let _0x3b2806=devices[_0x205448]['ip'],_0x2be106;const _0x1d9c4e=_0x2ee2d6=>{const _0x333377=_0x1e72;if(settings[_0x333377(0x178)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x205448)){const _0x2ed2d1=generateLoginToken(_0x205448);return{'allow':!![],'reason':_0x333377(0x27d),'token':_0x2ed2d1};}else return{'allow':![],'reason':_0x333377(0x215),'token':null};}else return _0x2be106=validToken(_0x2ee2d6,_0x205448),_0x2be106[_0x333377(0x289)]('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x2ee2d6}:{'allow':![],'reason':_0x333377(0x215),'token':null};}else return{'allow':!![],'reason':_0x333377(0x186),'token':null};};if(settings[_0x596129(0x2a8)]){let _0x2aeb85=[...settings[_0x596129(0x24a)],_0x596129(0x175),_0x596129(0x190),_0x596129(0x2a9)];if(_0x2aeb85['includes'](_0x3b2806))return _0x1d9c4e(_0x500600);else{_0x2be106=validToken(_0x500600,_0x205448);if(_0x2be106['hasOwnProperty']('success'))return _0x1d9c4e(_0x500600);else{if(telegramIpApproved(_0x205448)){const _0x2462ac=generateToken(_0x205448);return _0x2be106=_0x1d9c4e(_0x500600),_0x2be106[_0x596129(0x2b6)]?{'allow':!![],'reason':_0x596129(0x1af),'token':_0x2462ac}:_0x2be106;}else return settings[_0x596129(0x18f)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x596129(0x1e6),'token':null};}}}else return _0x1d9c4e(_0x500600);}function timelyDecrypt(_0x3cbfd4,_0x493888=!![]){const _0x8dd802=_0x5be511;if(_0x3cbfd4)try{const _0x5b04f1=crypt['decrypt'](secure[_0x8dd802(0x239)],_0x3cbfd4)['message'],_0x389c8b=_0x5b04f1['split']('@')[0x0],_0x82dad=_0x5b04f1[_0x8dd802(0x1ff)]('@')[0x1],_0x1129ca=new Date()[_0x8dd802(0x295)]();if(_0x493888){if(_0x1129ca-_0x82dad<maxSecretAge*0x3e8)return _0x389c8b;else return![];}else return _0x389c8b;}catch(_0x55e132){return![];}else return![];}const validToken=(_0x19b83c,_0x35790b)=>{const _0x38f366=_0x5be511,_0x12be28=devices[_0x35790b]['ip'];if(!_0x19b83c)return{'error':'No\x20authentication\x20token'};for(let _0x2f279b of blacklist){if(_0x2f279b[_0x38f366(0x209)]==_0x19b83c)return{'error':_0x38f366(0x1b4)};}let _0x3afc74;try{_0x3afc74=jwt[_0x38f366(0x19a)](_0x19b83c,secure[_0x38f366(0x275)]+_0x35790b);}catch{return{'error':_0x38f366(0x1ef)};}if(!_0x3afc74[_0x38f366(0x289)](_0x38f366(0x230))&&!_0x3afc74[_0x38f366(0x289)](_0x38f366(0x1bb))||!_0x3afc74[_0x38f366(0x289)](_0x38f366(0x21c)))return{'error':_0x38f366(0x23e)};if(!_0x3afc74['hasOwnProperty'](_0x38f366(0x1bb))&&_0x3afc74[_0x38f366(0x289)](_0x38f366(0x230))){const {clientip:_0x304b85}=_0x3afc74;return _0x12be28==_0x304b85?{'success':_0x38f366(0x1a9)}:{'error':_0x38f366(0x2de)};}else{if(_0x3afc74['hasOwnProperty'](_0x38f366(0x1bb))&&_0x3afc74[_0x38f366(0x289)]('clientip')){const {username:_0x2311af,clientip:_0x5c1a54}=_0x3afc74;return settings[_0x38f366(0x17c)]==_0x2311af&&_0x12be28==_0x5c1a54?{'success':_0x38f366(0x1a9)}:{'error':_0x38f366(0x173)};}}},generateLoginToken=_0x26b61f=>{const _0x1bc6a8=_0x5be511;if(_0x26b61f){const _0x5b19cc=devices[_0x26b61f]['ip'];return jwt[_0x1bc6a8(0x1b1)]({'username':settings[_0x1bc6a8(0x17c)],'clientip':_0x5b19cc},secure[_0x1bc6a8(0x275)]+_0x26b61f,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x17bec0=>{const _0x56ddfa=_0x5be511;if(_0x17bec0){const _0x43691a=devices[_0x17bec0]['ip'];return jwt[_0x56ddfa(0x1b1)]({'clientip':_0x43691a},secure[_0x56ddfa(0x275)]+_0x17bec0,{'expiresIn':devices[_0x17bec0]['telegramIpApproval'][_0x56ddfa(0x1bf)]*0x3c});}else return![];},telegramIpApproved=_0x27fcc5=>{const _0x3db99e=_0x5be511;let _0x1b2660=![];return devices[_0x27fcc5][_0x3db99e(0x1a7)]&&devices[_0x27fcc5]['telegramIpApproval'][_0x3db99e(0x1bf)]!=_0x3db99e(0x247)&&(_0x1b2660=devices[_0x27fcc5]['telegramIpApproval'][_0x3db99e(0x230)]==devices[_0x27fcc5]['ip']&&new Date()[_0x3db99e(0x295)]()-devices[_0x27fcc5][_0x3db99e(0x1a7)][_0x3db99e(0x2be)]<devices[_0x27fcc5][_0x3db99e(0x1a7)][_0x3db99e(0x1bf)]*0x3c*0x3e8),_0x1b2660;},telegram2FaApproved=_0x237fbe=>{const _0x2aec08=_0x5be511;let _0x1b4a49=![];return devices[_0x237fbe][_0x2aec08(0x1e5)]&&devices[_0x237fbe][_0x2aec08(0x1e5)][_0x2aec08(0x1bf)]!=_0x2aec08(0x247)&&(_0x1b4a49=devices[_0x237fbe]['telegram2FaApproval'][_0x2aec08(0x230)]==devices[_0x237fbe]['ip']&&new Date()[_0x2aec08(0x295)]()-devices[_0x237fbe][_0x2aec08(0x1e5)][_0x2aec08(0x2be)]<devices[_0x237fbe][_0x2aec08(0x1e5)]['expiry']*0x3c*0x3e8),_0x1b4a49;},normalizeIP=_0x1053b2=>{const _0x52e3df=_0x5be511;let _0x285d59=null,_0x221b40=null;if(ipaddr[_0x52e3df(0x197)](_0x1053b2)){const _0x44fe86=ipaddr[_0x52e3df(0x22c)](_0x1053b2);_0x44fe86[_0x52e3df(0x255)]()===_0x52e3df(0x294)?(_0x44fe86[_0x52e3df(0x2e3)]()&&(_0x285d59=_0x44fe86[_0x52e3df(0x18a)]()['toString']()),_0x221b40=_0x44fe86['toString']()):(_0x285d59=_0x44fe86['toString'](),_0x221b40=_0x44fe86[_0x52e3df(0x1c8)]()[_0x52e3df(0x20c)]());}return{'show':_0x285d59?_0x285d59:_0x221b40,'store':_0x221b40};};function sleep(_0x2ec6cd){return new Promise(_0x5bf1d5=>setTimeout(_0x5bf1d5,_0x2ec6cd));}