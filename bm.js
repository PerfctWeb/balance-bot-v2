const _0x16b6c7=_0x23c8;(function(_0x2f7395,_0x4efc80){const _0xa3c5cc=_0x23c8,_0x1970cb=_0x2f7395();while(!![]){try{const _0x3cfcaf=-parseInt(_0xa3c5cc(0x23e))/0x1*(-parseInt(_0xa3c5cc(0x24f))/0x2)+parseInt(_0xa3c5cc(0x23f))/0x3+-parseInt(_0xa3c5cc(0x222))/0x4+-parseInt(_0xa3c5cc(0x38a))/0x5*(-parseInt(_0xa3c5cc(0x32d))/0x6)+parseInt(_0xa3c5cc(0x1f6))/0x7+-parseInt(_0xa3c5cc(0x1d0))/0x8*(-parseInt(_0xa3c5cc(0x229))/0x9)+parseInt(_0xa3c5cc(0x238))/0xa*(-parseInt(_0xa3c5cc(0x2c7))/0xb);if(_0x3cfcaf===_0x4efc80)break;else _0x1970cb['push'](_0x1970cb['shift']());}catch(_0x29395e){_0x1970cb['push'](_0x1970cb['shift']());}}}(_0x5b42,0x3fb65));const _0x46b741=function(){let _0x4eeb44=!![];return function(_0x242d70,_0x1e2926){const _0x4672e3=_0x4eeb44?function(){const _0x10eab8=_0x23c8;if(_0x1e2926){const _0x1bc5b6=_0x1e2926[_0x10eab8(0x37d)](_0x242d70,arguments);return _0x1e2926=null,_0x1bc5b6;}}:function(){};return _0x4eeb44=![],_0x4672e3;};}(),_0x7dccc4=_0x46b741(this,function(){const _0x35b9cd=_0x23c8;return _0x7dccc4['toString']()[_0x35b9cd(0x1b2)]('(((.+)+)+)+$')['toString']()['constructor'](_0x7dccc4)[_0x35b9cd(0x1b2)](_0x35b9cd(0x1ba));});_0x7dccc4();'use strict';process[_0x16b6c7(0x325)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x16b6c7(0x247)),fs=require('fs'),fns=require('date-fns'),low=require(_0x16b6c7(0x300)),FileSync=require(_0x16b6c7(0x252)),path=require(_0x16b6c7(0x32e)),crypto=require(_0x16b6c7(0x29b)),forge=require('node-forge'),bcrypt=require('bcryptjs'),jwt=require(_0x16b6c7(0x1e5)),ipaddr=require('ipaddr.js'),argv=require(_0x16b6c7(0x1e0))(process[_0x16b6c7(0x1a7)][_0x16b6c7(0x253)](0x2))[_0x16b6c7(0x1a7)],uuidRandom=require(_0x16b6c7(0x22b)),{Telegraf,Markup}=require(_0x16b6c7(0x362)),Mixpanel=require(_0x16b6c7(0x2a4)),axios=require(_0x16b6c7(0x183)),{GraphQLClient,gql}=require(_0x16b6c7(0x2ce)),util=require('util'),fileUpload=require(_0x16b6c7(0x381)),{networkInterfaces}=require('os'),JSZip=require(_0x16b6c7(0x2ec)),PORT=argv['port']||_0x16b6c7(0x17d),pattern=/^[0-9]{2,4}$/;!pattern[_0x16b6c7(0x379)](PORT)&&(console[_0x16b6c7(0x264)](_0x16b6c7(0x2fd)+PORT+_0x16b6c7(0x1f3)),process[_0x16b6c7(0x1cb)](0x1));const HOST=argv[_0x16b6c7(0x1e2)]||null,userID=argv[_0x16b6c7(0x27b)]||'',debugging=argv['d']||![],nodeversion=process[_0x16b6c7(0x355)][_0x16b6c7(0x18a)];let bbpath='bb/',bbpath2='';const botfile=_0x16b6c7(0x2d3),configfile=_0x16b6c7(0x21d),settingsfile='bb-settings.json',securefile='bb-secure.json',environment=require('./'+bbpath2+_0x16b6c7(0x1a3))[_0x16b6c7(0x302)]||'production',maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x16b6c7(0x2e9)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x16b6c7(0x373)),configpath=userID?bbpath+_0x16b6c7(0x364)+userID+'/':bbpath+_0x16b6c7(0x364),configbackuppath=configpath+_0x16b6c7(0x283),logspath=userID?bbpath+_0x16b6c7(0x1d8)+userID+'/':bbpath+_0x16b6c7(0x1d8),zippath=userID?bbpath+_0x16b6c7(0x36a)+userID+'/':bbpath+_0x16b6c7(0x36a),loggerfile=fs['createWriteStream'](logspath+_0x16b6c7(0x287),{'flags':'a'}),temppath=userID?bbpath+_0x16b6c7(0x241)+userID+'/':bbpath+_0x16b6c7(0x241);!fs[_0x16b6c7(0x2e9)](configpath)&&fs['mkdirSync'](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x16b6c7(0x2e9)](logspath)&&fs[_0x16b6c7(0x25e)](logspath);!fs[_0x16b6c7(0x2e9)](zippath)&&fs[_0x16b6c7(0x25e)](zippath);function _0x23c8(_0x258a74,_0x335a03){const _0x4cbef7=_0x5b42();return _0x23c8=function(_0x7dccc4,_0x46b741){_0x7dccc4=_0x7dccc4-0x17a;let _0x5b420a=_0x4cbef7[_0x7dccc4];return _0x5b420a;},_0x23c8(_0x258a74,_0x335a03);}!fs['existsSync'](temppath)&&fs[_0x16b6c7(0x25e)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x16b6c7(0x371)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x16b6c7(0x297)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x16b6c7(0x2c3),'onepagemode':![],'marketcapApi':''}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);function _0x5b42(){const _0x5b440c=['\x20only\x0a','port','lastmsgemitted','bb-config.json','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','bbUsername','reinstall-bb','#RES#\x20','1874132WlgpdP','Starting\x20Balance\x20Bot\x20update','ipv6','secret','backup-full.zip','message','warning','9SMuULj','No\x20bots\x20running\x20right\x20now','uuid-random','event','Notifications\x20disabled\x0a','sendMetricsTelegram','padStart','type','startsWith','keys','value','\x20(1)','action','internal','close','50XxThks','update_yes','name','/:bot/history','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','login\x20token\x20valid','1neaEKU','1168962hyIbmI','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','temp/','reason','number','resetpw_no','off','\x20|\x20client:\x20...','child_process','static','manual','Network\x20Interfaces:','\x20|\x20','sort','mode','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','629806XAiaEL','Login\x20rejected','inlineKeyboard','lowdb/adapters/FileSync','slice','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Logged\x20out\x20user\x20...','remove','Login\x20accepted','6b67f3d61ee94b8f5c80b4affef4c4d9','You\x20can\x20use\x20the\x20following\x20commands:\x0a','handshake','pki','Ok,\x20will\x20send\x20alert\x20notifications\x20only','socket','mkdirSync','build2','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','*$1*','deleteHistoryAlerts','\x20(2)','log','file','IPv4','HTML','find','privateKey','telegramEvents','post','storeFiat','headers','login\x20not\x20required','backup-full','Password\x20reset\x20rejected','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','reset-history','userid','alerts','sendPortfolioTelegram','tkn','pidRefreshToken','ipc','connection','portfolio','user','botID','Invalid\x20IP\x20address','cancelLoading','reinstall','cloneDeep','format','Error\x20while\x20deleting\x20config\x20files:\x20','backup/','apiSecret','delete-bot','restart_','/output-000.log','connected','callback','store-headless','Notifications\x20enabled\x0a','Bot\x20Mgr\x20>\x20','apiPassword','update-bb','Unauthorized\x20attempt\x20to\x20delete\x20bot','full','button','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','expiry','rsa','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','bbvReceive','defaults','blacklist','writeFileSync','login2fa_','crypto','login\x20token\x20generated','getSeconds','5\x20min','uuid','disabled','stopped','settings.','timestamp','mixpanel','Alerts','restart','reload','util','create','Unauthorized\x20attempt\x20to\x20download\x20','Temporary\x20access\x20rejected','set','showname','ETH','reinstall_no','onepagemode','\x1b[31m','/update\x20-\x20update\x20Balance\x20Bot\x0a','enabled','telegram','data','SIGINT','Unauthorized\x20login\x20attempt\x20(timeout)','No\x20authentication\x20token','accept','filter','getFullYear','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','/upload-backup','updatebotmanager','#RES#\x20if\x20running\x20locally\x0a','mtime','getUTCHours','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','0.0.0','::1','Starting\x20new\x20bot\x20|\x20Bot\x20','store','844481FVFBsc','status','entries','|@|','Restore\x20backup\x20file\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','success','graphql-request','\x1b[0m','Unauthorized\x20attempt\x20to\x20update\x20settings','Session\x20expired\x20for\x20user\x20...','botmanager','bot.js','backup-full@','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','config_all','2FA\x20login\x20token\x20generated','\x20minutes','Yes','socket.io','sha256','command','update_no','yes','config_orders','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','backup','=>\x20Go\x20to\x20#CYA#http://','args','Deleted\x20Bot\x20','temporary\x20token\x20generated','new-disabled','config','placeOrder','existsSync','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','\x1b[34m','jszip','***','get-messages','push','debug','length','toString','isDirectory','params','bot-','Backup\x20file\x20unzipped\x20and\x20stored','Enabled\x20Bot\x20','DEFLATE','temporary\x20access\x20timeout','storeConfiguration','listen','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Error:\x20Invalid\x20argument\x20','backup-files','\x20-\x20','lowdb','/download/:type','environment','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','on_','getStartingBalances','/enable\x20-\x20enable\x20notifications\x0a','Telegram\x20error:','/help\x20-\x20show\x20available\x20commands\x0a','reset-password','string','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','all','-results.json','build','Invalid\x20authentication\x20token\x20(2)','[ip-address]','bot','-----------------------------------------------------------------------------------','error','User\x20has\x20been\x20validated','2FA\x20required','Disabled\x20Bot\x20','update','f2aRequired','Bot\x20','sign','getMonth','verify','launch','encryptedUuid','Notifications\x20disabled','.zip','private','storeHeadless','privateKeyFromPem','-performance.json','env','telegramUsername','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','download','restore-backup-file','Access\x20enabled\x20for\x20','/restart\x20-\x20restart\x20bot(s)\x0a','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','9078TnwuUR','path','Markdown','resetpw_yes','login\x20required','telegram2FaApproval','bots','settings',')\x20|\x20Bot\x20','split','Unauthorized\x20attempt\x20to\x20log\x20out','forEach','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','exchange','once','isValid','running','reject','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','tempaccess_reject_','headless','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','get','names','showConfig','login','index.html','#RES#\x20if\x20running\x20on\x20server','use','SIGTERM','(staging)','order','copyFileSync','/on\x20-\x20start\x20bot(s)\x0a','endsWith','2FA','min','telegramIpApproval','versions','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Restarting\x20Bot\x20','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Starting\x20#RED#Balance\x20Bot\x20v','output-002.log','logged\x20out','init','/:bot/portfolio','sortBy','map',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','lastmsgtelegram','telegraf','Unauthorized\x20attempt\x20to\x20confirm\x20message','config/','/:bot/support','disconnect','match','send','marketcapApi','zip/','latestversion','replace','$1_$2_$3','initclient','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','hex','write','stringify','clients','live','chat','telegramEnabled','secure','start','test','server','binary','parse','apply','getPortfolio','http','messages','express-fileupload','tempaccess_5_','logout','access\x20timeout','sockets','unlinkSync','includes','loadAsync','tempaccess_15_','975GuMCwY','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','kind','/:bot/coins','/names\x20-\x20show\x20bot\x20names\x0a','All\x20bots','Restore\x20process\x20confirmed','max','restore_yes_','title','family','files','allow','3000','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','fork','rmSync','Notifications\x20types:\x20','inherit','axios','statSync','store-settings','::ffff:127.0.0.1','BCT','backupfile','telegramChatId','node','/:bot/performance','version','publicKey','staging','hasOwnProperty','Unauthorized\x20attempt\x20to\x20store\x20configuration','output-001.log','any','add','-events.json','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','disable','decode64','join','\x20|\x20user:\x20...','reply','15\x20min','Node.js\x20v','assign','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','Notifications\x20enabled','#RES#','sendFile','timeshift','version.json','started','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Starting\x20Balance\x20Bot\x20reinstallation','argv','reinstall_yes','hashSync','\x20mode','toggle','access','Unauthorized\x20attempt\x20to\x20add\x20bot','metrics_','127.0.0.1','2FA\x20login\x20required','isIPv4MappedAddress','search','auto','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','\x20>\x20','Your\x20installation\x20is\x20already\x20up\x20to\x20date','clientip','Unauthorized\x20attempt\x20to\x20get\x20messages','kill','(((.+)+)+)+$','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','getTime','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','emitHistory','stop','token','from','Starting\x20(','emit','uncaughtException','https://api.ipify.org?format=json','************','confirm-message','editMessageReplyMarkup','getMinutes','All','exit','restore_no_','removeAllListeners','getDate','tempaccess_30_','286072ORumGY',')\x20\x20\x20|\x20Bot\x20','\x1b[33m','Invalid\x20username\x20or\x20IP\x20address','add-bot','toggleBotMode','bbvNew','pidExpireLogin','logs/','getHours','invalid\x20credentials','show-config','store-fiat','Unauthorized\x20attempt\x20to\x20show\x20configuration','output-000.log','/metrics\x20-\x20show\x20bot\x20performance\x0a','yargs/yargs','express','host','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','jsonwebtoken','size','decrypt','publicKeyToPem','simple','apiKey','username','readdirSync','/off\x20-\x20stop\x20bot(s)\x0a','30\x20min','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','compareSync','temporaryAccessAllowed','notification',',\x20must\x20be\x20a\x204\x20digit\x20number','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','status\x20code\x20401','546014gNieVZ','get-logs','password','range','botname','config_alerts','function','logs',':\x20Bot\x20Mgr\x20>\x20','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','\x1b[35m','bbPassword','orders','Unauthorized\x20attempt\x20to\x20update\x20bot','bb-secure.json','code','loginRequired','get-starting-balances','/status\x20-\x20show\x20bot(s)\x20status\x0a','temporary\x20access\x20rejected','new','off_','telegramToken','temporary\x20access\x20not\x20allowed','CoinMarketCap\x20API\x20key\x20validated','Backup\x20file\x20uploaded','Invalid\x20authentication\x20token\x20(1)','readFileSync','Error\x20removing\x20old\x20backup\x20files:','-config.json','remoteAddress','<b>Balance\x20Bot\x20Status:</b>\x0a','randomFillSync','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','whitelist','telegrammsg'];_0x5b42=function(){return _0x5b440c;};return _0x5b42();}dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x16b6c7(0x371)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x16b6c7(0x35c)](_0x16b6c7(0x258),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x16b6c7(0x20c)]&&(settings[_0x16b6c7(0x20c)]!=''&&settings[_0x16b6c7(0x20c)]!=_0x16b6c7(0x2ed))&&settings[_0x16b6c7(0x326)]&&settings[_0x16b6c7(0x326)]!='')initTelegram();const parseColor=(_0x1d1b4e,_0x51461f)=>{const _0x308963=_0x16b6c7,_0x103bce=/#[A-Z]{3}#/g;if(typeof _0x1d1b4e=='string'){!_0x51461f?_0x1d1b4e=_0x1d1b4e['replace'](_0x103bce,''):(_0x1d1b4e=_0x1d1b4e['replace'](/#BLU#/g,_0x308963(0x2eb)),_0x1d1b4e=_0x1d1b4e['replace'](/#RED#/g,_0x308963(0x2b1)),_0x1d1b4e=_0x1d1b4e[_0x308963(0x36c)](/#YEL#/g,_0x308963(0x1d2)),_0x1d1b4e=_0x1d1b4e[_0x308963(0x36c)](/#MAG#/g,_0x308963(0x200)),_0x1d1b4e=_0x1d1b4e['replace'](/#CYA#/g,'\x1b[36m'),_0x1d1b4e=_0x1d1b4e[_0x308963(0x36c)](/#RES#/g,_0x308963(0x2cf)));;}return _0x1d1b4e;},logger={'screen':_0x42f685=>{const _0x9302ca=_0x16b6c7;console[_0x9302ca(0x264)](parseColor(_0x42f685,!![]));},'simple':_0x5d61f7=>{const _0x4c9460=_0x16b6c7;console['log'](parseColor(_0x5d61f7,!![])),loggerfile[_0x4c9460(0x371)](util[_0x4c9460(0x281)](parseColor(_0x5d61f7,![]))+'\x0a');},'full':async _0x42b84a=>{const _0x3feeff=_0x16b6c7,_0x4a4d05=getTimeStamp()+_0x3feeff(0x1fe)+_0x42b84a;console[_0x3feeff(0x264)](parseColor(_0x4a4d05,!![])),loggerfile[_0x3feeff(0x371)](util[_0x3feeff(0x281)](parseColor(_0x4a4d05,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x3feeff(0x26a)]!=_0x3feeff(0x202))await sendTelegram(settings[_0x3feeff(0x189)],_0x3feeff(0x28c)+parseColor(_0x42b84a,![]));},'debug':async(_0x3bb59f,_0x3f0a68='')=>{const _0x304066=_0x16b6c7,_0x14d7e8=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x3bb59f;if(debugging)console[_0x304066(0x264)](parseColor(_0x14d7e8,!![]));loggerfile[_0x304066(0x371)](util[_0x304066(0x281)](parseColor(_0x14d7e8,![]))+'\x0a');if(_0x3f0a68){if(debugging)console[_0x304066(0x264)](_0x3f0a68);loggerfile[_0x304066(0x371)](util['format'](_0x3f0a68)+'\x0a');}}};let terminating=![];process['on'](_0x16b6c7(0x1c4),function(_0x4c7fc9){const _0x4e8a87=_0x16b6c7;_0x4c7fc9['toString']()[_0x4e8a87(0x387)]('address\x20already\x20in\x20use')?(logger['simple'](_0x4e8a87(0x19e)+_0x4c7fc9[_0x4e8a87(0x21b)]+_0x4e8a87(0x1a0)),process['send']({'terminate':!![]},_0x29ee7b=>{})):logger[_0x4e8a87(0x1e9)](_0x4c7fc9);}),process['on']('exit',()=>{const _0x19b883=_0x16b6c7;stopAllBots(),process[_0x19b883(0x1cb)](0x0);}),process['on']('SIGTERM',()=>{const _0x42be8e=_0x16b6c7;stopAllBots(),process[_0x42be8e(0x1cb)](0x0);}),process['on'](_0x16b6c7(0x2b6),()=>{const _0x168314=_0x16b6c7;stopAllBots(),process[_0x168314(0x1cb)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x16b6c7(0x1a3))[_0x16b6c7(0x18c)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x16b6c7(0x1e1)),app=express(),http=require(_0x16b6c7(0x37f))['createServer'](app);app[_0x16b6c7(0x34b)](fileUpload({'useTempFiles':!![]})),app[_0x16b6c7(0x345)](_0x16b6c7(0x301),async(_0x9b4a46,_0x44cace)=>{const _0x888f5d=_0x16b6c7,_0x1d5963=_0x9b4a46[_0x888f5d(0x2f4)][_0x888f5d(0x230)],_0x2fa8b1=getClientsWithBotID(_0x888f5d(0x2d2)),_0x1fc4ea=_0x9b4a46[_0x888f5d(0x26d)]['uuid'],_0x2c5dec=timelyDecrypt(_0x1fc4ea,![]),_0x31d873=_0x2fa8b1[_0x888f5d(0x268)](_0x4f8c7e=>_0x4f8c7e[_0x888f5d(0x29f)]==_0x2c5dec);if(_0x31d873){const _0x5cc7e0=normalizeIP(_0x9b4a46[_0x888f5d(0x25d)][_0x888f5d(0x214)])['store'],_0x598a34=_0x9b4a46['headers'][_0x888f5d(0x276)];if(validateAccess(_0x598a34,_0x2c5dec,_0x5cc7e0)[_0x888f5d(0x17c)])_0x1d5963==_0x888f5d(0x2e1)&&await backupConfigFiles(),await zipFiles(_0x1d5963),_0x44cace[_0x888f5d(0x328)](zippath+(_0x1d5963+_0x888f5d(0x320)),_0x4545b9=>{const _0x5095cd=_0x888f5d;_0x4545b9&&(logger[_0x5095cd(0x290)]('Failed\x20to\x20download\x20'+_0x1d5963),logger['simple'](_0x4545b9));});else logger[_0x888f5d(0x290)](_0x888f5d(0x2aa)+_0x1d5963+_0x888f5d(0x234));}else logger[_0x888f5d(0x290)](_0x888f5d(0x2aa)+_0x1d5963+_0x888f5d(0x263));}),app[_0x16b6c7(0x26b)](_0x16b6c7(0x2bd),async(_0x9866f,_0x446de7)=>{const _0x2b9f6d=_0x16b6c7,_0x2d24b0=getClientsWithBotID(_0x2b9f6d(0x2d2)),_0x2d0e1f=_0x9866f['headers']['uuid'],_0x788c1c=timelyDecrypt(_0x2d0e1f,![]),_0x260445=_0x2d24b0['find'](_0x52b869=>_0x52b869['uuid']==_0x788c1c);logger[_0x2b9f6d(0x2f0)](_0x2b9f6d(0x20f));if(_0x260445){const _0x23c1dc=normalizeIP(_0x9866f['socket']['remoteAddress'])['store'],_0x2c7a7f=_0x9866f['headers']['tkn'];if(validateAccess(_0x2c7a7f,_0x788c1c,_0x23c1dc)[_0x2b9f6d(0x17c)]){if(_0x9866f[_0x2b9f6d(0x17b)]){const _0x14acb1=_0x9866f[_0x2b9f6d(0x17b)][_0x2b9f6d(0x188)];await _0x14acb1['mv'](temppath+_0x14acb1['name']),_0x446de7[_0x2b9f6d(0x368)]({'status':!![],'message':'File\x20uploaded'});const _0x42fd2b=getBotsWithMode();_0x42fd2b[_0x2b9f6d(0x2f1)]>0x0?confirmRestore(temppath,_0x14acb1[_0x2b9f6d(0x23a)]):unzipFile(temppath,_0x14acb1['name']);}}else logger[_0x2b9f6d(0x290)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x2b9f6d(0x290)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app['use'](express['static'](path[_0x16b6c7(0x198)](__dirname,bbpath2,'build2'))),app['use'](express[_0x16b6c7(0x248)](path[_0x16b6c7(0x198)](__dirname,bbpath2,_0x16b6c7(0x30e)))),app['get']('/',function(_0xe23f19,_0x52371a){const _0x4f01d5=_0x16b6c7;_0x52371a[_0x4f01d5(0x1a1)](path[_0x4f01d5(0x198)](__dirname,bbpath2,_0x4f01d5(0x25f),'index.html'));}),app[_0x16b6c7(0x345)]('/:bot',function(_0x2c81cb,_0x23e463){const _0x4d2c84=_0x16b6c7;_0x23e463[_0x4d2c84(0x1a1)](path[_0x4d2c84(0x198)](__dirname,bbpath2,_0x4d2c84(0x30e),_0x4d2c84(0x349)));}),app[_0x16b6c7(0x345)](_0x16b6c7(0x35d),(_0x4db1df,_0x236181)=>{const _0x157a8a=_0x16b6c7;_0x236181[_0x157a8a(0x1a1)](path[_0x157a8a(0x198)](__dirname,bbpath2,'build',_0x157a8a(0x349)));}),app[_0x16b6c7(0x345)](_0x16b6c7(0x18b),(_0x2601ed,_0x4b0978)=>{const _0x59556a=_0x16b6c7;_0x4b0978[_0x59556a(0x1a1)](path['join'](__dirname,bbpath2,_0x59556a(0x30e),_0x59556a(0x349)));}),app[_0x16b6c7(0x345)](_0x16b6c7(0x38e),(_0x241ef9,_0x452046)=>{const _0x109f1b=_0x16b6c7;_0x452046[_0x109f1b(0x1a1)](path[_0x109f1b(0x198)](__dirname,bbpath2,'build',_0x109f1b(0x349)));}),app['get'](_0x16b6c7(0x23b),(_0x4730b5,_0x2e2665)=>{const _0x500174=_0x16b6c7;_0x2e2665[_0x500174(0x1a1)](path[_0x500174(0x198)](__dirname,bbpath2,_0x500174(0x30e),_0x500174(0x349)));}),app['get']('/:bot/configuration',(_0x2738b1,_0x4fb2da)=>{const _0x127e5f=_0x16b6c7;_0x4fb2da[_0x127e5f(0x1a1)](path[_0x127e5f(0x198)](__dirname,bbpath2,_0x127e5f(0x30e),_0x127e5f(0x349)));}),app[_0x16b6c7(0x345)](_0x16b6c7(0x365),(_0x5a8e0f,_0x197d9b)=>{const _0x3978d2=_0x16b6c7;_0x197d9b['sendFile'](path['join'](__dirname,bbpath2,_0x3978d2(0x30e),_0x3978d2(0x349)));});if(HOST)http['listen'](PORT,HOST);else http[_0x16b6c7(0x2fb)](PORT);const io=require(_0x16b6c7(0x2da))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x20e884=_0x16b6c7;let _0x301961=_0x20e884(0x310);const _0x240ff5=networkInterfaces(),_0x2a1ea8={};for(const _0x334aa9 of Object['keys'](_0x240ff5)){for(const _0x4bc442 of _0x240ff5[_0x334aa9]){if((_0x4bc442[_0x20e884(0x17a)]==_0x20e884(0x266)||_0x4bc442[_0x20e884(0x17a)]==0x4)&&!_0x4bc442[_0x20e884(0x236)]){const _0x33c14e=ipaddr[_0x20e884(0x37c)](_0x4bc442['address'])[_0x20e884(0x1f9)]();_0x33c14e!=_0x20e884(0x321)&&(!_0x2a1ea8[_0x334aa9]&&(_0x2a1ea8[_0x334aa9]=[]),_0x2a1ea8[_0x334aa9][_0x20e884(0x2ef)](_0x4bc442['address']),_0x301961=_0x4bc442['address']);}}}return{'serverip':_0x301961,'netinterfaces':_0x2a1ea8};}async function startServer(){const _0x339b71=_0x16b6c7,{serverip:_0xc0f14b,netinterfaces:_0x4a91f1}=getServerIP();logger['simple'](''),logger[_0x339b71(0x1e9)]('-----------------------------------------------------------------------------------'),await logger[_0x339b71(0x290)](_0x339b71(0x359)+serverversion+_0x339b71(0x221)+(environment==_0x339b71(0x18e)?_0x339b71(0x34d):'')+'\x0a'+(_0x339b71(0x30b)+PORT+_0x339b71(0x2bf))+(_0x339b71(0x2e2)+_0xc0f14b+':'+PORT+_0x339b71(0x34a))),logger[_0x339b71(0x1e9)]('-----------------------------------------------------------------------------------');if(config[_0x339b71(0x2f1)]!=0x0)for(const _0x18aaa5 of config){const _0x2d49a6=_0x18aaa5['mode']==_0x339b71(0x1b3)?'a':'m';if(_0x18aaa5['status']==_0x339b71(0x2b3)||_0x18aaa5[_0x339b71(0x2c8)]==_0x339b71(0x20a))await logger[_0x339b71(0x290)](_0x339b71(0x1c2)+_0x2d49a6+_0x339b71(0x335)+_0x18aaa5['botID']+'\x20|\x20'+_0x18aaa5[_0x339b71(0x1fa)]),startBot([_0x18aaa5[_0x339b71(0x27c)],userID],{'cwd':bbpath},function(_0x3ed403){const _0x53d5a2=_0x339b71;if(_0x3ed403)logger[_0x53d5a2(0x290)](_0x3ed403);});else(_0x18aaa5['status']==_0x339b71(0x2a0)||_0x18aaa5[_0x339b71(0x2c8)]==_0x339b71(0x2e6))&&await logger[_0x339b71(0x290)]('Idling\x20('+_0x2d49a6+_0x339b71(0x1d1)+_0x18aaa5['botID']+'\x20|\x20'+_0x18aaa5[_0x339b71(0x1fa)]);}else!newBot&&logger[_0x339b71(0x1e9)](_0x339b71(0x24e));if(newBot)addBot();logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x339b71(0x1e9)](''),await logger[_0x339b71(0x2f0)](_0x339b71(0x19c)+nodeversion),await logger[_0x339b71(0x2f0)](_0x339b71(0x24a),_0x4a91f1);}function startSocket(){const _0x31dfb5=_0x16b6c7;io['on'](_0x31dfb5(0x279),_0x501998=>{const _0x4bff3b=_0x31dfb5;let _0x523fe4,_0x4013e4,_0x5ec130,_0x3cd008,_0x3cea30;const _0x5f2116=_0x501998['handshake'][_0x4bff3b(0x26d)]['referer'];_0x4013e4=_0x5f2116['match'](/bot[0-9]{3}/);if(_0x4013e4)_0x5ec130=_0x4013e4[0x0]['match'](/[0-9]{3}/);if(_0x5ec130)_0x523fe4=_0x5ec130[0x0];else _0x523fe4=_0x4bff3b(0x2d2);const _0x3232a0=_0x501998[_0x4bff3b(0x25a)]['auth'][_0x4bff3b(0x31e)];if(!_0x3232a0)_0x501998[_0x4bff3b(0x1c3)](_0x4bff3b(0x2c8),{'publicKey':secure[_0x4bff3b(0x18d)]});else{_0x3cd008=timelyDecrypt(_0x3232a0,![]);if(!_0x3cd008)_0x501998['emit'](_0x4bff3b(0x2c8),{'publicKey':secure[_0x4bff3b(0x18d)]});else{_0x3cea30=normalizeIP(_0x501998['conn'][_0x4bff3b(0x214)])[_0x4bff3b(0x2c6)];if(!devices[_0x3cd008])devices[_0x3cd008]={'uuid':_0x3cd008,'access':{'token':null}};devices[_0x3cd008]['ip']=_0x3cea30;const _0x18ddf0=addClient(_0x501998['id'],_0x3cd008,_0x523fe4);setAccess(_0x18ddf0),emitMessages(),_0x501998['on'](_0x4bff3b(0x348),_0x542e5c=>{const _0xfb4b53=_0x4bff3b,_0x4d1445=timelyDecrypt(_0x542e5c[_0xfb4b53(0x1f8)],!![],_0xfb4b53(0x2ca));if(_0x4d1445){_0x542e5c={'username':_0x542e5c['username'],'password':_0x4d1445},devices[_0x3cd008][_0xfb4b53(0x1ac)]=validateCredentials(_0x542e5c,_0x3cd008);if(devices[_0x3cd008][_0xfb4b53(0x1ac)][_0xfb4b53(0x17c)]==![]&&devices[_0x3cd008][_0xfb4b53(0x1ac)]['reason']==_0xfb4b53(0x1b0))_0x501998[_0xfb4b53(0x1c3)](_0xfb4b53(0x2c8),{'access':devices[_0x3cd008]['access']}),loginAccess2FA(_0x3cd008,_0x3cea30);else{if(devices[_0x3cd008]['access'][_0xfb4b53(0x17c)]==![]&&devices[_0x3cd008][_0xfb4b53(0x1ac)][_0xfb4b53(0x242)]=='invalid\x20credentials')_0x501998[_0xfb4b53(0x1c3)](_0xfb4b53(0x2c8),{'access':devices[_0x3cd008][_0xfb4b53(0x1ac)]});else devices[_0x3cd008]['access'][_0xfb4b53(0x17c)]&&devices[_0x3cd008][_0xfb4b53(0x1ac)][_0xfb4b53(0x242)]==_0xfb4b53(0x29c)&&(getClientsWithUuid(_0x3cd008)[_0xfb4b53(0x338)](_0x39f932=>{setAccess(_0x39f932);}),logger[_0xfb4b53(0x2f0)]('Logged\x20in\x20user\x20...'+_0x3cd008[_0xfb4b53(0x253)](-0x8)),setTokenRefresh(_0x3cd008),setSessionTimeout('login',_0x3cd008));}}else logger[_0xfb4b53(0x290)](_0xfb4b53(0x2b7));}),_0x501998['on'](_0x4bff3b(0x309),()=>{resetPassword();}),_0x501998['on']('disconnect',_0x5790b2=>{removeClient(_0x501998['id']);}),_0x523fe4==_0x4bff3b(0x2d2)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x14277a){const _0x50479b=_0x16b6c7;if(_0x14277a!=_0x50479b(0x2d2)&&config[_0x50479b(0x1ea)]!=''){if(pid[_0x14277a])pid[_0x14277a]['send']({'function':_0x50479b(0x36e),'args':null});}_0x14277a!='botmanager'&&broadcastToBots(_0x50479b(0x333),JSON[_0x50479b(0x372)](config));}function reloadBotManager(){const _0x51aa9f=_0x16b6c7;getClientsWithBotID(_0x51aa9f(0x2d2))['forEach'](_0x4ffa85=>{const _0x1d1f2f=_0x51aa9f;getSocket(_0x4ffa85['id'])[_0x1d1f2f(0x1c3)](_0x1d1f2f(0x2c8),{'access':{'allow':![],'reason':_0x1d1f2f(0x2a7),'token':null}});});}function getSocket(_0x364927){const _0x17b298=_0x16b6c7,_0x37f95e=io['_nsps'][_0x17b298(0x345)]('/');return _0x37f95e[_0x17b298(0x385)][_0x17b298(0x345)](_0x364927);}function setAccess(_0x649843){const _0x5aea9a=_0x16b6c7,_0x20cd57=getSocket(_0x649843['id']),_0x326777=_0x649843[_0x5aea9a(0x29f)],_0x2f60d6=_0x649843[_0x5aea9a(0x311)];devices[_0x326777][_0x5aea9a(0x1ac)]=validateAccess(devices[_0x326777][_0x5aea9a(0x1ac)]['token'],_0x326777),logger[_0x5aea9a(0x2f0)]('Setting\x20access:\x20'+devices[_0x326777][_0x5aea9a(0x1ac)][_0x5aea9a(0x242)]+_0x5aea9a(0x246)+_0x649843['id'][_0x5aea9a(0x253)](-0x8)+_0x5aea9a(0x199)+_0x326777[_0x5aea9a(0x253)](-0x8)),_0x20cd57[_0x5aea9a(0x198)](_0x326777);if(devices[_0x326777][_0x5aea9a(0x1ac)]['allow']){_0x20cd57[_0x5aea9a(0x198)](_0x2f60d6);if(_0x2f60d6=='botmanager')initializeSocketBotManager(_0x20cd57);else initializeSocketBot(_0x20cd57);initClient(_0x2f60d6);}devices[_0x326777][_0x5aea9a(0x1ac)][_0x5aea9a(0x1c0)]&&devices[_0x326777][_0x5aea9a(0x1ac)][_0x5aea9a(0x242)]==_0x5aea9a(0x2e5)&&setSessionTimeout(_0x5aea9a(0x352),_0x326777),devices[_0x326777][_0x5aea9a(0x1ac)][_0x5aea9a(0x1c0)]&&devices[_0x326777][_0x5aea9a(0x1ac)][_0x5aea9a(0x242)]==_0x5aea9a(0x2d7)&&setSessionTimeout(_0x5aea9a(0x348),_0x326777),_0x20cd57[_0x5aea9a(0x1c3)]('status',{'status':_0x649843[_0x5aea9a(0x37a)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x326777]['access'],'externalip':devices[_0x326777]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x326777][_0x5aea9a(0x1ac)]['allow']==![]&&devices[_0x326777][_0x5aea9a(0x1ac)]['reason']=='2FA\x20required'&&temporaryAccess2FA(_0x326777,devices[_0x326777]['ip']);}function setSessionTimeout(_0x365bd3,_0x62b527){const _0x150367=_0x16b6c7;let _0x2d1b85;if(_0x365bd3==_0x150367(0x348))_0x2d1b85=loginExpiry*0x3c*0x3e8;else _0x2d1b85=devices[_0x62b527][_0x150367(0x354)][_0x150367(0x293)]*0x3c*0x3e8-(new Date()[_0x150367(0x1bc)]()-devices[_0x62b527][_0x150367(0x354)]['timestamp']);if(devices[_0x62b527][_0x150367(0x1d7)])clearTimeout(devices[_0x62b527]['pidExpireLogin']);devices[_0x62b527]['pidExpireLogin']=setTimeout(()=>{const _0xb004f9=_0x150367;if(devices[_0x62b527][_0xb004f9(0x277)])clearTimeout(devices[_0x62b527][_0xb004f9(0x277)]);removeSocketListeners(_0x62b527),addBlacklist(_0x62b527),devices[_0x62b527]['telegramIpApproval']=null,devices[_0x62b527]['telegram2FaApproval']=null,devices[_0x62b527][_0xb004f9(0x1ac)][_0xb004f9(0x1c0)]=null,logger[_0xb004f9(0x2f0)](_0xb004f9(0x2d1)+_0x62b527[_0xb004f9(0x253)](-0x8)),devices[_0x62b527]['access']=validateAccess(devices[_0x62b527][_0xb004f9(0x1ac)][_0xb004f9(0x1c0)],_0x62b527),!(devices[_0x62b527]['access'][_0xb004f9(0x17c)]&&devices[_0x62b527][_0xb004f9(0x1ac)][_0xb004f9(0x242)]==_0xb004f9(0x26e))&&(_0x365bd3==_0xb004f9(0x348)?io['to'](_0x62b527)[_0xb004f9(0x1c3)](_0xb004f9(0x2c8),{'access':{'allow':![],'reason':_0xb004f9(0x384),'token':null}}):io['to'](_0x62b527)[_0xb004f9(0x1c3)](_0xb004f9(0x2c8),{'access':{'allow':![],'reason':_0xb004f9(0x2f9),'token':null}})),devices[_0x62b527][_0xb004f9(0x1ac)][_0xb004f9(0x1c0)]=null;},_0x2d1b85);}function setTokenRefresh(_0x119379){const _0x122ac7=_0x16b6c7;if(devices[_0x119379][_0x122ac7(0x277)])clearTimeout(devices[_0x119379]['pidRefreshToken']);devices[_0x119379][_0x122ac7(0x277)]=setTimeout(()=>{const _0x1a0d31=_0x122ac7;getClientsWithUuid(_0x119379)[_0x1a0d31(0x2f1)]!=0x0?(devices[_0x119379][_0x1a0d31(0x1ac)]=refreshToken(_0x119379),io['to'](_0x119379)[_0x1a0d31(0x1c3)](_0x1a0d31(0x2c8),{'status':_0x1a0d31(0x288),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x119379][_0x1a0d31(0x1ac)],'externalip':devices[_0x119379]['ip'],'publicKey':secure[_0x1a0d31(0x18d)],'validInstallation':validInstallation}),setTokenRefresh(_0x119379)):clearTimeout(devices[_0x119379]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x6db72c){const _0x446c68=_0x16b6c7,_0x2fe350=getClient(_0x6db72c['id'])[_0x446c68(0x29f)];_0x6db72c['emit'](_0x446c68(0x333),config),_0x6db72c['emit']('settings',cleanSettings()),_0x6db72c['on'](_0x446c68(0x1d4),_0x4cc30c=>{const _0x46c361=_0x446c68;if(validateAccess(_0x4cc30c,_0x2fe350)[_0x46c361(0x17c)])addBot();else logger['full'](_0x46c361(0x1ad));}),_0x6db72c['on']('update-bot',(_0x2da03a,_0x1b1019)=>{const _0x42fc71=_0x446c68;if(validateAccess(_0x1b1019,_0x2fe350)[_0x42fc71(0x17c)])toggleBot(_0x2da03a[_0x42fc71(0x27c)],_0x2da03a[_0x42fc71(0x2c8)],_0x2da03a[_0x42fc71(0x374)]);else logger[_0x42fc71(0x290)](_0x42fc71(0x203));}),_0x6db72c['on']('toggle-bot-mode',(_0x578bbd,_0x1a825c)=>{const _0x270632=_0x446c68;if(validateAccess(_0x1a825c,_0x2fe350)[_0x270632(0x17c)])toggleBotMode(_0x578bbd);else logger[_0x270632(0x290)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x6db72c['on'](_0x446c68(0x285),(_0xc1d75b,_0x2cd19c)=>{const _0xfd91bf=_0x446c68;if(validateAccess(_0x2cd19c,_0x2fe350)[_0xfd91bf(0x17c)])deleteBot(_0xc1d75b);else logger['full'](_0xfd91bf(0x28f));}),_0x6db72c['on'](_0x446c68(0x185),(_0x50a497,_0x9f6f5)=>{const _0x54dae2=_0x446c68;if(validateAccess(_0x9f6f5,_0x2fe350)[_0x54dae2(0x17c)])storeSettings(_0x50a497,!![]);else logger[_0x54dae2(0x290)](_0x54dae2(0x2d0));}),_0x6db72c['on'](_0x446c68(0x28e),_0x300deb=>{const _0x3b316d=_0x446c68;if(validateAccess(_0x300deb,_0x2fe350)[_0x3b316d(0x17c)])updateBB(_0x3b316d(0x317));else logger[_0x3b316d(0x290)](_0x3b316d(0x356));}),_0x6db72c['on'](_0x446c68(0x220),_0x1dcd0c=>{const _0x247371=_0x446c68;if(validateAccess(_0x1dcd0c,_0x2fe350)['allow'])updateBB(_0x247371(0x27f));else logger[_0x247371(0x290)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x6db72c['on']('get-backup-files',_0x4cf632=>{const _0x5b2716=_0x446c68;if(validateAccess(_0x4cf632,_0x2fe350)[_0x5b2716(0x17c)]){const _0x2859bc=getClient(_0x6db72c['id']);if(_0x2859bc)getBackupFiles(_0x2859bc[_0x5b2716(0x29f)]);else logger[_0x5b2716(0x290)](_0x5b2716(0x1a5));}else logger[_0x5b2716(0x290)](_0x5b2716(0x295));}),_0x6db72c['on'](_0x446c68(0x329),(_0x53ba51,_0x5c0694)=>{const _0x236bda=_0x446c68;if(validateAccess(_0x5c0694,_0x2fe350)[_0x236bda(0x17c)])restoreBackupFile(_0x53ba51);else logger['full'](_0x236bda(0x343));}),_0x6db72c['on']('get-messages',_0x46e708=>{const _0x54ed6c=_0x446c68;if(validateAccess(_0x46e708,_0x2fe350)[_0x54ed6c(0x17c)])getMessages();else logger[_0x54ed6c(0x290)](_0x54ed6c(0x1b8));}),_0x6db72c['on'](_0x446c68(0x1c7),(_0x4e084e,_0x5935cb)=>{const _0x3e39dd=_0x446c68;if(validateAccess(_0x5935cb,_0x2fe350)[_0x3e39dd(0x17c)])confirmMessage(_0x4e084e);else logger[_0x3e39dd(0x290)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x6db72c['on'](_0x446c68(0x383),_0x3cc363=>{const _0x476b61=_0x446c68;if(validateAccess(_0x3cc363,_0x2fe350)[_0x476b61(0x17c)]){if(devices[_0x2fe350][_0x476b61(0x277)])clearTimeout(devices[_0x2fe350][_0x476b61(0x277)]);if(devices[_0x2fe350][_0x476b61(0x1d7)])clearTimeout(devices[_0x2fe350][_0x476b61(0x1d7)]);removeSocketListeners(getClient(_0x6db72c['id'])['uuid']),addBlacklist(_0x2fe350),devices[_0x2fe350][_0x476b61(0x354)]=null,devices[_0x2fe350][_0x476b61(0x332)]=null,devices[_0x2fe350]['access']['token']=null,logger[_0x476b61(0x2f0)](_0x476b61(0x255)+_0x2fe350['slice'](-0x8)),io['to'](getClient(_0x6db72c['id'])[_0x476b61(0x29f)])[_0x476b61(0x1c3)]('status',{'access':{'allow':![],'reason':_0x476b61(0x35b),'token':null}});}else logger[_0x476b61(0x290)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x5b5d18){const _0x12e8d7=_0x16b6c7,_0x46000f=getClient(_0x5b5d18['id'])[_0x12e8d7(0x311)],_0x8e02ca=getClient(_0x5b5d18['id'])['uuid'];_0x5b5d18['on'](_0x12e8d7(0x1f7),(_0x54f3f3,_0x186fa1)=>{const _0x3641c7=_0x12e8d7;if(validateAccess(_0x186fa1,_0x8e02ca)[_0x3641c7(0x17c)]){if(pid[_0x46000f])pid[_0x46000f]['send']({'function':_0x3641c7(0x1be),'args':_0x54f3f3});}else logger[_0x3641c7(0x290)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x5b5d18['on']('delete-alerts',(_0x534548,_0x5b6a5b)=>{const _0x1f6ea2=_0x12e8d7;if(validateAccess(_0x5b6a5b,_0x8e02ca)['allow']){if(pid[_0x46000f])pid[_0x46000f][_0x1f6ea2(0x368)]({'function':_0x1f6ea2(0x262),'args':_0x534548});}else logger[_0x1f6ea2(0x290)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x5b5d18['on']('get-portfolio',(_0x436a31,_0x48de7e)=>{const _0x52625a=_0x12e8d7;if(validateAccess(_0x48de7e,_0x8e02ca)[_0x52625a(0x17c)]){if(pid[_0x46000f])pid[_0x46000f][_0x52625a(0x368)]({'function':_0x52625a(0x37e),'args':_0x436a31});}else logger[_0x52625a(0x290)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x5b5d18['on']('store-configuration',(_0x2a3aaa,_0x3e2fd4)=>{const _0x5c3aac=_0x12e8d7;if(validateAccess(_0x3e2fd4,_0x8e02ca)[_0x5c3aac(0x17c)]){if(pid[_0x46000f])pid[_0x46000f][_0x5c3aac(0x368)]({'function':_0x5c3aac(0x2fa),'args':_0x2a3aaa});}else logger[_0x5c3aac(0x290)](_0x5c3aac(0x190));}),_0x5b5d18['on'](_0x12e8d7(0x28a),(_0x174518,_0xcdf832)=>{const _0x31b830=_0x12e8d7;if(validateAccess(_0xcdf832,_0x8e02ca)[_0x31b830(0x17c)]){if(pid[_0x46000f])pid[_0x46000f][_0x31b830(0x368)]({'function':_0x31b830(0x322),'args':_0x174518});}else logger[_0x31b830(0x290)](_0x31b830(0x342));}),_0x5b5d18['on'](_0x12e8d7(0x1dc),(_0x3f4053,_0x4bec6d)=>{const _0x3ee7c9=_0x12e8d7;if(validateAccess(_0x4bec6d,_0x8e02ca)['allow']){if(pid[_0x46000f])pid[_0x46000f][_0x3ee7c9(0x368)]({'function':_0x3ee7c9(0x26c),'args':_0x3f4053});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x5b5d18['on'](_0x12e8d7(0x272),_0xab9fed=>{const _0xcf9bde=_0x12e8d7;if(validateAccess(_0xab9fed,_0x8e02ca)[_0xcf9bde(0x17c)]){if(pid[_0x46000f])pid[_0x46000f][_0xcf9bde(0x368)]({'function':'resetHistory','args':null});}else logger[_0xcf9bde(0x290)](_0xcf9bde(0x36f));}),_0x5b5d18['on'](_0x12e8d7(0x207),_0x5c26f2=>{const _0x2042db=_0x12e8d7;if(validateAccess(_0x5c26f2,_0x8e02ca)[_0x2042db(0x17c)]){if(pid[_0x46000f])pid[_0x46000f][_0x2042db(0x368)]({'function':_0x2042db(0x305),'args':null});}else logger[_0x2042db(0x290)](_0x2042db(0x1e3));}),_0x5b5d18['on']('place-order',(_0x39c0c6,_0x17ad22)=>{const _0x3bbef9=_0x12e8d7;if(validateAccess(_0x17ad22,_0x8e02ca)[_0x3bbef9(0x17c)]){if(pid[_0x46000f])pid[_0x46000f][_0x3bbef9(0x368)]({'function':_0x3bbef9(0x2e8),'args':_0x39c0c6});}else logger[_0x3bbef9(0x290)](_0x3bbef9(0x358));}),_0x5b5d18['on']('cancel-loading',_0xe30421=>{const _0x5d9bed=_0x12e8d7;if(validateAccess(_0xe30421,_0x8e02ca)[_0x5d9bed(0x17c)]){if(pid[_0x46000f])pid[_0x46000f][_0x5d9bed(0x368)]({'function':_0x5d9bed(0x27e),'args':null});}else logger[_0x5d9bed(0x290)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x5b5d18['on'](_0x12e8d7(0x1db),_0x54b5ad=>{const _0x21d7b0=_0x12e8d7;if(validateAccess(_0x54b5ad,_0x8e02ca)['allow']){if(pid[_0x46000f])pid[_0x46000f]['send']({'function':_0x21d7b0(0x347),'args':null});}else logger[_0x21d7b0(0x290)](_0x21d7b0(0x1dd));}),_0x5b5d18['on'](_0x12e8d7(0x28e),_0x293196=>{const _0x57e847=_0x12e8d7;if(validateAccess(_0x293196,_0x8e02ca)[_0x57e847(0x17c)])updateBB(_0x57e847(0x317));else logger[_0x57e847(0x290)](_0x57e847(0x356));}),_0x5b5d18['on'](_0x12e8d7(0x2ee),_0x5a7f83=>{const _0x417670=_0x12e8d7;if(validateAccess(_0x5a7f83,_0x8e02ca)['allow'])getMessages();else logger[_0x417670(0x290)](_0x417670(0x1b8));}),_0x5b5d18['on'](_0x12e8d7(0x1c7),(_0x4c5dd3,_0x3cabf2)=>{const _0x3cb23e=_0x12e8d7;if(validateAccess(_0x3cabf2,_0x8e02ca)['allow'])confirmMessage(_0x4c5dd3);else logger[_0x3cb23e(0x290)](_0x3cb23e(0x363));}),_0x5b5d18['on']('logout',_0x3eb64e=>{const _0x1693ee=_0x12e8d7;if(validateAccess(_0x3eb64e,_0x8e02ca)[_0x1693ee(0x17c)]){if(devices[_0x8e02ca][_0x1693ee(0x277)])clearTimeout(devices[_0x8e02ca][_0x1693ee(0x277)]);if(devices[_0x8e02ca][_0x1693ee(0x1d7)])clearTimeout(devices[_0x8e02ca][_0x1693ee(0x1d7)]);removeSocketListeners(getClient(_0x5b5d18['id'])[_0x1693ee(0x29f)]),addBlacklist(_0x8e02ca),devices[_0x8e02ca]['telegramIpApproval']=null,devices[_0x8e02ca][_0x1693ee(0x332)]=null,devices[_0x8e02ca]['access'][_0x1693ee(0x1c0)]=null,logger['debug'](_0x1693ee(0x255)+_0x8e02ca[_0x1693ee(0x253)](-0x8)),io['to'](getClient(_0x5b5d18['id'])['uuid'])[_0x1693ee(0x1c3)](_0x1693ee(0x2c8),{'access':{'allow':![],'reason':_0x1693ee(0x35b),'token':null}});}else logger[_0x1693ee(0x290)](_0x1693ee(0x337));});}function removeSocketListeners(_0x372528){getClientsWithUuid(_0x372528)['forEach'](_0x2b1b91=>{const _0x39508d=_0x23c8;getSocket(_0x2b1b91['id'])[_0x39508d(0x1cd)]();});}function cleanSettings(){const _0x433e03=_0x16b6c7;let _0x5946bc=settings;return settings[_0x433e03(0x20c)]&&settings[_0x433e03(0x20c)]!=''&&(_0x5946bc={..._0x5946bc,'telegramToken':'************'}),settings['bbPassword']&&settings[_0x433e03(0x201)]!=''&&(_0x5946bc={..._0x5946bc,'bbPassword':_0x433e03(0x1c6)}),settings[_0x433e03(0x369)]&&settings['marketcapApi']!=''&&(_0x5946bc={..._0x5946bc,'marketcapApi':_0x433e03(0x1c6)}),(settings[_0x433e03(0x201)]&&settings['bbPassword']==_0x433e03(0x2ed)||settings[_0x433e03(0x20c)]&&settings['telegramToken']==_0x433e03(0x2ed)||settings[_0x433e03(0x369)]&&settings[_0x433e03(0x369)]==_0x433e03(0x2ed))&&(_0x5946bc={..._0x5946bc,'restored':{'password':settings[_0x433e03(0x201)]==_0x433e03(0x2ed),'telegram':settings['telegramToken']==_0x433e03(0x2ed),'marketcap':settings[_0x433e03(0x369)]==_0x433e03(0x2ed)}}),_0x5946bc;}async function updateBB(_0x50bb4d){const _0x159d27=_0x16b6c7;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x48e12f=>{const _0x5abd11=_0x23c8;restartBot(_0x48e12f[_0x5abd11(0x27c)]);});if(_0x50bb4d==_0x159d27(0x317))process[_0x159d27(0x368)]({'update':!![],'environment':environment},_0x34cb45=>{});else _0x50bb4d==_0x159d27(0x27f)&&process[_0x159d27(0x368)]({'reinstall':!![],'environment':environment},_0x291415=>{});}function startBot(_0x4a6065,_0xbb25da,_0x41c086){const _0x365bba=_0x16b6c7;if(debugging)_0x4a6065[_0x365bba(0x2ef)]('-d');let _0x5c50a5=![];const _0x40087f=_0x4a6065[0x0];_0xbb25da={..._0xbb25da,'stdio':['inherit',_0x365bba(0x182),_0x365bba(0x182),_0x365bba(0x278)]},pid[_0x40087f]=childProcess[_0x365bba(0x17f)](botfile,_0x4a6065,_0xbb25da),pid[_0x40087f]['on']('message',_0x1351aa=>{const _0x365b7f=_0x365bba;switch(Object[_0x365b7f(0x232)](_0x1351aa)[0x0]){case'botname':updateBotName(_0x40087f,_0x1351aa[_0x365b7f(0x1fa)]);break;case _0x365b7f(0x2be):updateBotManager();break;case _0x365b7f(0x2c8):updateStatus(_0x40087f,_0x1351aa[_0x365b7f(0x2c8)]);break;case _0x365b7f(0x374):updateLive(_0x40087f,_0x1351aa[_0x365b7f(0x374)]);break;case _0x365b7f(0x1a4):updateLive(_0x40087f,_0x1351aa['started']),io['to'](_0x40087f)['emit'](_0x365b7f(0x2c8),{'access':{'allow':![],'reason':_0x365b7f(0x2a7),'token':null}});break;case'stop':_0x1351aa['stop']=='restart'&&restartBot(_0x40087f);_0x1351aa[_0x365b7f(0x1bf)]==_0x365b7f(0x1b9)&&toggleBot(_0x40087f,'disabled',_0x365b7f(0x2a1));break;case _0x365b7f(0x2b4):sendTelegramBot(_0x40087f,_0x1351aa['telegram']);break;case _0x365b7f(0x219):sendTelegramMsg(_0x1351aa[_0x365b7f(0x219)]);break;case'function':io['to'](_0x40087f)['emit'](_0x1351aa[_0x365b7f(0x1fc)],_0x1351aa[_0x365b7f(0x2e3)]);break;}}),pid[_0x40087f]['on'](_0x365bba(0x313),function(_0x5ef225){if(_0x5c50a5)return;_0x5c50a5=!![],_0x41c086(_0x5ef225);}),pid[_0x40087f]['on']('exit',async function(_0x105154){const _0x4681a0=_0x365bba;if(terminating)return;if(installingUpdate){io[_0x4681a0(0x237)]();return;}if(_0x5c50a5)return;_0x5c50a5=!![],_0x41c086(null);const _0x1d0cde=dbConfig[_0x4681a0(0x345)](_0x4681a0(0x333))['find']({'botID':_0x40087f})[_0x4681a0(0x233)]();_0x1d0cde&&(_0x1d0cde[_0x4681a0(0x2c8)]=='enabled'||_0x1d0cde['status']==_0x4681a0(0x20a))&&(await sleep(0x3e8),updateLive(_0x40087f,_0x4681a0(0x2a1)),logger[_0x4681a0(0x290)](_0x4681a0(0x357)+_0x40087f),startBot([_0x40087f,userID],{'cwd':bbpath},function(_0x4c2304){const _0x37c3df=_0x4681a0;if(_0x4c2304)logger[_0x37c3df(0x290)](_0x4c2304);}));});}function stopBot(_0x96485a){const _0x529467=_0x16b6c7;getClientsWithBotID(_0x96485a)['forEach'](_0x48126b=>{getSocket(_0x48126b['id'])['disconnect'](!![]),removeClient(_0x48126b['id']);}),pid[_0x96485a]&&(pid[_0x96485a][_0x529467(0x1b9)](),pid[_0x96485a]=null);}function stopAllBots(){terminating=!![];const _0x22aab8=getEnabledBots();_0x22aab8['forEach'](_0x2e219d=>{stopBot(_0x2e219d['botID']);});}function restartBot(_0x40fc06){const _0x1b3370=_0x16b6c7;if(pid[_0x40fc06])pid[_0x40fc06][_0x1b3370(0x1b9)]();}function addBot(){const _0x45cb67=_0x16b6c7;let _0x54cb30;for(let _0x23ff34=0x1;_0x23ff34<0x3e9;_0x23ff34++){_0x54cb30=_0x23ff34['toString']()['padStart'](0x3,'0');let _0xb92a11=config[_0x45cb67(0x268)](_0x2be628=>_0x2be628[_0x45cb67(0x27c)]==_0x54cb30);if(!_0xb92a11)break;}if(_0x54cb30==='1000'){logger[_0x45cb67(0x290)](_0x45cb67(0x1bb));return;}logger[_0x45cb67(0x290)](_0x45cb67(0x2c5)+_0x54cb30),dbConfig['get'](_0x45cb67(0x333))['push']({'botID':_0x54cb30,'botname':_0x45cb67(0x319)+_0x54cb30,'status':'new','live':''})[_0x45cb67(0x371)](),startBot([_0x54cb30,userID],{'cwd':bbpath},function(_0xf2e98b){if(_0xf2e98b)logger['full'](_0xf2e98b);}),config=getConfiguration(),io['to'](_0x45cb67(0x2d2))[_0x45cb67(0x1c3)](_0x45cb67(0x333),config),broadcastToBots(_0x45cb67(0x333),JSON[_0x45cb67(0x372)](config));}function deleteBot(_0x30bec0){const _0x2c6b92=_0x16b6c7;getClientsWithBotID(_0x30bec0)['forEach'](_0x143d11=>{const _0x5f1034=_0x23c8;getSocket(_0x143d11['id'])[_0x5f1034(0x366)](!![]),removeClient(_0x143d11['id']);}),dbConfig[_0x2c6b92(0x345)](_0x2c6b92(0x333))[_0x2c6b92(0x256)]({'botID':_0x30bec0})[_0x2c6b92(0x371)](),logger[_0x2c6b92(0x290)](_0x2c6b92(0x2e4)+_0x30bec0),stopBot(_0x30bec0);try{if(fs[_0x2c6b92(0x2e9)](path['join'](configpath,'bot-'+_0x30bec0+_0x2c6b92(0x213))))fs[_0x2c6b92(0x386)](path['join'](configpath,'bot-'+_0x30bec0+'-config.json'));if(fs[_0x2c6b92(0x2e9)](path[_0x2c6b92(0x198)](configpath,_0x2c6b92(0x2f5)+_0x30bec0+_0x2c6b92(0x194))))fs[_0x2c6b92(0x386)](path[_0x2c6b92(0x198)](configpath,_0x2c6b92(0x2f5)+_0x30bec0+'-events.json'));if(fs[_0x2c6b92(0x2e9)](path['join'](configpath,'bot-'+_0x30bec0+_0x2c6b92(0x324))))fs[_0x2c6b92(0x386)](path[_0x2c6b92(0x198)](configpath,_0x2c6b92(0x2f5)+_0x30bec0+_0x2c6b92(0x324)));if(fs[_0x2c6b92(0x2e9)](path[_0x2c6b92(0x198)](configpath,_0x2c6b92(0x2f5)+_0x30bec0+_0x2c6b92(0x30d))))fs[_0x2c6b92(0x386)](path[_0x2c6b92(0x198)](configpath,_0x2c6b92(0x2f5)+_0x30bec0+_0x2c6b92(0x30d)));}catch(_0x472786){if(_0x472786)logger[_0x2c6b92(0x290)](_0x2c6b92(0x282),_0x472786);}config=getConfiguration(),io['to'](_0x2c6b92(0x2d2))[_0x2c6b92(0x1c3)](_0x2c6b92(0x333),config),broadcastToBots(_0x2c6b92(0x333),JSON[_0x2c6b92(0x372)](config));}function toggleBot(_0x409d3f,_0x545b7e,_0x375cd7){const _0x3e4e8f=_0x16b6c7;dbConfig[_0x3e4e8f(0x345)]('bots')['find']({'botID':_0x409d3f})[_0x3e4e8f(0x19d)]({'status':_0x545b7e})[_0x3e4e8f(0x19d)]({'live':_0x375cd7})[_0x3e4e8f(0x371)]();if(_0x545b7e==_0x3e4e8f(0x2b3)||_0x545b7e==_0x3e4e8f(0x20a))logger['full'](_0x3e4e8f(0x2f7)+_0x409d3f),startBot([_0x409d3f,userID],{'cwd':bbpath},function(_0x3deadc){const _0x3c206c=_0x3e4e8f;if(_0x3deadc)logger[_0x3c206c(0x290)](_0x3deadc);});else(_0x545b7e=='disabled'||_0x545b7e==_0x3e4e8f(0x2e6))&&(logger['full'](_0x3e4e8f(0x316)+_0x409d3f),stopBot(_0x409d3f));config=getConfiguration(),io['to']('botmanager')[_0x3e4e8f(0x1c3)](_0x3e4e8f(0x333),config),broadcastToBots(_0x3e4e8f(0x333),JSON[_0x3e4e8f(0x372)](config));}function toggleStatus(_0x37793e){const _0x469303=_0x16b6c7;let _0x906b12=dbConfig[_0x469303(0x345)]('bots')[_0x469303(0x268)]({'botID':_0x37793e})['value'](),_0xbdfb8c;if(_0x906b12[_0x469303(0x2c8)]===_0x469303(0x2b3))_0xbdfb8c=_0x469303(0x2a0);else{if(_0x906b12[_0x469303(0x2c8)]==='new')_0xbdfb8c=_0x469303(0x2e6);else{if(_0x906b12[_0x469303(0x2c8)]===_0x469303(0x2e6))_0xbdfb8c=_0x469303(0x20a);else{if(_0x906b12[_0x469303(0x2c8)]==='disabled')_0xbdfb8c='enabled';}}}return _0xbdfb8c;}function updateStatus(_0x3b0e8b,_0x5697e8){const _0x1e752a=_0x16b6c7;dbConfig[_0x1e752a(0x345)](_0x1e752a(0x333))[_0x1e752a(0x268)]({'botID':_0x3b0e8b})[_0x1e752a(0x19d)]({'status':_0x5697e8})[_0x1e752a(0x371)](),config=getConfiguration(),io['to'](_0x1e752a(0x2d2))[_0x1e752a(0x1c3)]('bots',config),broadcastToBots(_0x1e752a(0x333),JSON[_0x1e752a(0x372)](config));}function updateLive(_0x54e40d,_0x2dcede){const _0x15c378=_0x16b6c7;dbConfig['get'](_0x15c378(0x333))[_0x15c378(0x268)]({'botID':_0x54e40d})['assign']({'live':_0x2dcede})['write'](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x15c378(0x333),config),broadcastToBots('bots',JSON[_0x15c378(0x372)](config));}function updateBotName(_0x25cd88,_0x5ba39e){const _0x4188a4=_0x16b6c7;dbConfig['get']('bots')[_0x4188a4(0x268)]({'botID':_0x25cd88})[_0x4188a4(0x19d)]({'botname':_0x5ba39e})[_0x4188a4(0x371)](),config=getConfiguration(),io['to'](_0x4188a4(0x2d2))[_0x4188a4(0x1c3)](_0x4188a4(0x333),config),broadcastToBots(_0x4188a4(0x333),JSON[_0x4188a4(0x372)](config));}function updateBotManager(){const _0x4ef4c3=_0x16b6c7;config=getConfiguration(),io['to'](_0x4ef4c3(0x2d2))[_0x4ef4c3(0x1c3)](_0x4ef4c3(0x333),config),broadcastToBots('bots',JSON[_0x4ef4c3(0x372)](config));}function toggleBotMode(_0x532560){const _0x2abf96=_0x16b6c7;if(pid[_0x532560])pid[_0x532560][_0x2abf96(0x368)]({'function':_0x2abf96(0x1d5),'args':null});else{const _0x1be890=configpath+_0x2abf96(0x2f5)+_0x532560+_0x2abf96(0x213),_0x59c108=fs[_0x2abf96(0x211)](_0x1be890),_0x592d83=JSON['parse'](_0x59c108),_0x144842=_0x592d83[_0x2abf96(0x311)][0x0][_0x2abf96(0x341)];_0x592d83[_0x2abf96(0x311)][0x0][_0x2abf96(0x341)]=!_0x144842;const _0x4ae8d3=JSON[_0x2abf96(0x372)](_0x592d83,null,0x2);fs['writeFileSync'](_0x1be890,_0x4ae8d3),config=getConfiguration(),io['to'](_0x2abf96(0x2d2))['emit'](_0x2abf96(0x333),config),broadcastToBots(_0x2abf96(0x333),JSON[_0x2abf96(0x372)](config));}}function validateTelegram(_0x4e5543){const _0x4af9d3=_0x16b6c7;if(_0x4e5543['from'][_0x4af9d3(0x1eb)]!=settings['telegramUsername']&&'@'+_0x4e5543[_0x4af9d3(0x1c1)]['username']!=settings[_0x4af9d3(0x326)]||_0x4e5543[_0x4af9d3(0x375)]['id']!=settings[_0x4af9d3(0x189)])return sendTelegram(_0x4e5543[_0x4af9d3(0x375)]['id'],_0x4af9d3(0x1e4),{'parse_mode':_0x4af9d3(0x267)}),![];return!![];}async function initTelegram(){const _0x289675=_0x16b6c7;if(tgBot)tgBot[_0x289675(0x1bf)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x289675(0x20c)]);let _0x3a6ade=_0x289675(0x259);_0x3a6ade+='\x0a',_0x3a6ade+=_0x289675(0x306),_0x3a6ade+='/disable\x20-\x20disable\x20notifications\x0a',_0x3a6ade+=_0x289675(0x254),_0x3a6ade+=_0x289675(0x32b),_0x3a6ade+=_0x289675(0x350),_0x3a6ade+=_0x289675(0x1ed),_0x3a6ade+=_0x289675(0x327),_0x3a6ade+=_0x289675(0x38f),_0x3a6ade+=_0x289675(0x208),_0x3a6ade+=_0x289675(0x1df),_0x3a6ade+=_0x289675(0x2fc),_0x3a6ade+=_0x289675(0x2b2),_0x3a6ade+=_0x289675(0x2e0),_0x3a6ade+=_0x289675(0x308);let _0x3bd58c=_0x289675(0x23c);_0x3bd58c+='\x0a',_0x3bd58c+=_0x3a6ade,tgBot['catch']((_0x473777,_0x4d523f)=>{const _0x46293e=_0x289675;logger['simple'](getTimeStamp()+_0x46293e(0x360)),logger[_0x46293e(0x2f0)]('Telegraf\x20error:',_0x473777);}),tgBot[_0x289675(0x34b)](async(_0xf2e4d5,_0x3f65f6)=>{const _0x23c7e3=_0x289675;if(!(!settings[_0x23c7e3(0x189)]&&_0xf2e4d5[_0x23c7e3(0x317)][_0x23c7e3(0x227)]['text']=='/start')){if(!validateTelegram(_0xf2e4d5))return;}_0x3f65f6();}),tgBot[_0x289675(0x2dc)](_0x289675(0x378),async _0x5c65c3=>{const _0x281698=_0x289675;if(!settings[_0x281698(0x189)])updateSetting('telegramChatId',_0x5c65c3[_0x281698(0x375)]['id']);updateSetting(_0x281698(0x376),!![]);if(!validateTelegram(_0x5c65c3))return;await sendTelegram(_0x5c65c3[_0x281698(0x375)]['id'],_0x3bd58c);}),tgBot[_0x289675(0x2dc)]('enable',async _0x260fc9=>{const _0x29d42c=_0x289675;updateSetting(_0x29d42c(0x376),!![]),await sendTelegram(_0x260fc9['chat']['id'],_0x29d42c(0x19f));}),tgBot[_0x289675(0x2dc)](_0x289675(0x196),async _0x266c35=>{const _0x4b39c9=_0x289675;await sendTelegram(_0x266c35[_0x4b39c9(0x375)]['id'],_0x4b39c9(0x31f)),updateSetting(_0x4b39c9(0x376),![]);}),tgBot[_0x289675(0x2dc)](_0x289675(0x2e7),async _0x26e1b1=>{const _0x50f870=_0x289675,_0x11f45b=Markup[_0x50f870(0x251)]([Markup[_0x50f870(0x291)][_0x50f870(0x289)]('Orders',_0x50f870(0x2df)),Markup[_0x50f870(0x291)][_0x50f870(0x289)](_0x50f870(0x2a5),'config_alerts'),Markup[_0x50f870(0x291)][_0x50f870(0x289)](_0x50f870(0x1ca),'config_all')]);_0x26e1b1['reply'](_0x50f870(0x1bd),_0x11f45b);}),tgBot[_0x289675(0x235)]('config_orders',async _0x48e1be=>{const _0x384a8b=_0x289675;_0x48e1be[_0x384a8b(0x1c8)](),updateSetting(_0x384a8b(0x26a),_0x384a8b(0x202)),updateSetting(_0x384a8b(0x376),!![]),await sendTelegram(_0x48e1be[_0x384a8b(0x375)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot['action'](_0x289675(0x1fb),async _0x678a85=>{const _0x7cd8fa=_0x289675;_0x678a85[_0x7cd8fa(0x1c8)](),updateSetting(_0x7cd8fa(0x26a),_0x7cd8fa(0x274)),updateSetting(_0x7cd8fa(0x376),!![]),await sendTelegram(_0x678a85['chat']['id'],_0x7cd8fa(0x25c));}),tgBot[_0x289675(0x235)](_0x289675(0x2d6),async _0x19441f=>{const _0x487657=_0x289675;_0x19441f[_0x487657(0x1c8)](),updateSetting('telegramEvents',_0x487657(0x30c)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x19441f[_0x487657(0x375)]['id'],_0x487657(0x303));}),tgBot['command'](_0x289675(0x2c8),async _0x51c012=>{const _0x174674=_0x289675,_0x2381e9=getBotsWithMode();let _0x40c2c6=_0x174674(0x215);config[_0x174674(0x338)](_0x55dc94=>{const _0x16cdc0=_0x174674,_0x4c866f=_0x2381e9[_0x16cdc0(0x268)](_0x40c1c2=>_0x40c1c2[_0x16cdc0(0x27c)]==_0x55dc94['botID'])[_0x16cdc0(0x24d)];_0x40c2c6+=_0x16cdc0(0x319)+_0x55dc94[_0x16cdc0(0x27c)]+':\x20'+_0x55dc94['status']+_0x16cdc0(0x24b)+_0x4c866f+_0x16cdc0(0x24b)+_0x55dc94[_0x16cdc0(0x374)]+'\x0a';}),_0x40c2c6+='\x0a',_0x40c2c6+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x40c2c6+=!settings[_0x174674(0x376)]?_0x174674(0x22d):_0x174674(0x28b),_0x40c2c6+=settings[_0x174674(0x376)]?settings[_0x174674(0x26a)]==_0x174674(0x30c)?_0x174674(0x1ff):_0x174674(0x181)+settings[_0x174674(0x26a)]+_0x174674(0x21a):'',await sendTelegram(_0x51c012[_0x174674(0x375)]['id'],_0x40c2c6,{'parse_mode':_0x174674(0x267)});}),tgBot[_0x289675(0x2dc)](_0x289675(0x2a6),async _0x143be0=>{const _0x325ef4=_0x289675,_0x6d76c7=getEnabledBots();if(_0x6d76c7[_0x325ef4(0x2f1)]==0x0)await sendTelegram(_0x143be0[_0x325ef4(0x375)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x6d76c7['length']>0x1)_0x6d76c7[_0x325ef4(0x2ef)]({'botID':_0x325ef4(0x30c)});let _0xba19f0=[],_0x2c4940=[];const _0x10e477=_0x6d76c7[_0x325ef4(0x2f1)]%0x4==0x0||_0x6d76c7[_0x325ef4(0x2f1)]%0x4==0x3||_0x6d76c7[_0x325ef4(0x2f1)]%0x3==0x1?0x4:0x3;let _0x8cfdbb=0x0;_0x6d76c7[_0x325ef4(0x338)]((_0x56ca8b,_0x1b300d)=>{const _0x11b0c3=_0x325ef4;if(_0x1b300d%_0x10e477==0x0)_0x2c4940=[];_0x2c4940[_0x11b0c3(0x2ef)](Markup[_0x11b0c3(0x291)]['callback'](_0x56ca8b[_0x11b0c3(0x27c)]=='all'?_0x11b0c3(0x390):_0x11b0c3(0x319)+_0x56ca8b[_0x11b0c3(0x27c)],_0x11b0c3(0x286)+_0x56ca8b[_0x11b0c3(0x27c)])),_0x1b300d%_0x10e477==0x0&&(_0xba19f0[_0x8cfdbb]=_0x2c4940,_0x8cfdbb++);});const _0x3a2fd9=Markup[_0x325ef4(0x251)](_0xba19f0);_0x143be0['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x3a2fd9);}}),tgBot['action'](/restart_(.+)/,async _0x5c2be0=>{const _0x15f0ed=_0x289675,_0x110bcc=_0x5c2be0[_0x15f0ed(0x367)][0x1];_0x5c2be0['editMessageReplyMarkup'](),_0x110bcc==_0x15f0ed(0x30c)?config[_0x15f0ed(0x338)](_0x4e8372=>{const _0x21055c=_0x15f0ed;restartBot(_0x4e8372[_0x21055c(0x27c)]);}):restartBot(_0x110bcc);}),tgBot['command']('on',async _0xf43c60=>{const _0x385c20=_0x289675,_0xc09b8e=getDisabledBots();if(_0xc09b8e['length']==0x0)await sendTelegram(_0xf43c60[_0x385c20(0x375)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0xc09b8e[_0x385c20(0x2f1)]>0x1)_0xc09b8e[_0x385c20(0x2ef)]({'botID':_0x385c20(0x30c)});let _0x53d360=[],_0x35165f=[];const _0x3d83a4=_0xc09b8e[_0x385c20(0x2f1)]%0x4==0x0||_0xc09b8e[_0x385c20(0x2f1)]%0x4==0x3||_0xc09b8e[_0x385c20(0x2f1)]%0x3==0x1?0x4:0x3;let _0x4307b3=0x0;_0xc09b8e[_0x385c20(0x338)]((_0x21cbfe,_0x2e1e0f)=>{const _0x4c3b81=_0x385c20;if(_0x2e1e0f%_0x3d83a4==0x0)_0x35165f=[];_0x35165f['push'](Markup['button'][_0x4c3b81(0x289)](_0x21cbfe[_0x4c3b81(0x27c)]==_0x4c3b81(0x30c)?_0x4c3b81(0x390):_0x4c3b81(0x319)+_0x21cbfe['botID'],_0x4c3b81(0x304)+_0x21cbfe[_0x4c3b81(0x27c)])),_0x2e1e0f%_0x3d83a4==0x0&&(_0x53d360[_0x4307b3]=_0x35165f,_0x4307b3++);});const _0x4f8e44=Markup['inlineKeyboard'](_0x53d360);_0xf43c60['reply'](_0x385c20(0x2cc),_0x4f8e44);}}),tgBot['action'](/on_(.+)/,async _0xa75baa=>{const _0x3b0523=_0x289675,_0x478bcc=_0xa75baa[_0x3b0523(0x367)][0x1];_0xa75baa[_0x3b0523(0x1c8)]();if(_0x478bcc=='all'){const _0xf1d444=getDisabledBots();await sendTelegram(_0xa75baa[_0x3b0523(0x375)]['id'],_0x3b0523(0x217)),_0xf1d444[_0x3b0523(0x338)](_0x304880=>{const _0x1ae533=_0x3b0523;if(_0x304880['botID']!='all')toggleBot(_0x304880[_0x1ae533(0x27c)],toggleStatus(_0x304880[_0x1ae533(0x27c)]),_0x1ae533(0x2a1));});}else await sendTelegram(_0xa75baa[_0x3b0523(0x375)]['id'],_0x3b0523(0x1f4)+_0x478bcc),toggleBot(_0x478bcc,toggleStatus(_0x478bcc),'stopped');}),tgBot['command'](_0x289675(0x245),async _0x5987a4=>{const _0x3af95e=_0x289675,_0x95eaea=getEnabledBots();if(_0x95eaea[_0x3af95e(0x2f1)]==0x0)await sendTelegram(_0x5987a4[_0x3af95e(0x375)]['id'],_0x3af95e(0x22a));else{if(_0x95eaea[_0x3af95e(0x2f1)]>0x1)_0x95eaea['push']({'botID':_0x3af95e(0x30c)});let _0x142f55=[],_0x2512d8=[];const _0xb5574b=_0x95eaea[_0x3af95e(0x2f1)]%0x4==0x0||_0x95eaea['length']%0x4==0x3||_0x95eaea['length']%0x3==0x1?0x4:0x3;let _0x5554cd=0x0;_0x95eaea[_0x3af95e(0x338)]((_0x3d95fe,_0x3953d6)=>{const _0x25d4f5=_0x3af95e;if(_0x3953d6%_0xb5574b==0x0)_0x2512d8=[];_0x2512d8[_0x25d4f5(0x2ef)](Markup[_0x25d4f5(0x291)][_0x25d4f5(0x289)](_0x3d95fe[_0x25d4f5(0x27c)]==_0x25d4f5(0x30c)?_0x25d4f5(0x390):'Bot\x20'+_0x3d95fe[_0x25d4f5(0x27c)],_0x25d4f5(0x20b)+_0x3d95fe[_0x25d4f5(0x27c)])),_0x3953d6%_0xb5574b==0x0&&(_0x142f55[_0x5554cd]=_0x2512d8,_0x5554cd++);});const _0x261ab9=Markup[_0x3af95e(0x251)](_0x142f55);_0x5987a4[_0x3af95e(0x19a)](_0x3af95e(0x38b),_0x261ab9);}}),tgBot[_0x289675(0x235)](/off_(.+)/,async _0x19478e=>{const _0x593108=_0x289675,_0x16fb22=_0x19478e[_0x593108(0x367)][0x1];_0x19478e[_0x593108(0x1c8)]();if(_0x16fb22==_0x593108(0x30c)){const _0x5a5741=getEnabledBots();await sendTelegram(_0x19478e[_0x593108(0x375)]['id'],_0x593108(0x38c)),_0x5a5741['forEach'](_0x2f78d7=>{const _0x354d97=_0x593108;if(_0x2f78d7[_0x354d97(0x27c)]!=_0x354d97(0x30c))toggleBot(_0x2f78d7[_0x354d97(0x27c)],toggleStatus(_0x2f78d7['botID']),'stopped');});}else await sendTelegram(_0x19478e[_0x593108(0x375)]['id'],_0x593108(0x33f)+_0x16fb22),toggleBot(_0x16fb22,toggleStatus(_0x16fb22),_0x593108(0x2a1));}),tgBot[_0x289675(0x2dc)]('metrics',async _0x48dd5c=>{const _0x58bff3=_0x289675,_0x4bb4d0=getEnabledBots();if(_0x4bb4d0[_0x58bff3(0x2f1)]==0x0)await sendTelegram(_0x48dd5c['chat']['id'],_0x58bff3(0x22a));else{if(_0x4bb4d0['length']>0x1){let _0x29bb73=[],_0x55716a=[];const _0x2764e4=_0x4bb4d0['length']%0x4==0x0||_0x4bb4d0[_0x58bff3(0x2f1)]%0x4==0x3||_0x4bb4d0['length']%0x3==0x1?0x4:0x3;let _0x1895cf=0x0;_0x4bb4d0[_0x58bff3(0x338)]((_0x5e52f0,_0x227756)=>{const _0x30a4a9=_0x58bff3;if(_0x227756%_0x2764e4==0x0)_0x55716a=[];_0x55716a[_0x30a4a9(0x2ef)](Markup[_0x30a4a9(0x291)]['callback'](_0x30a4a9(0x319)+_0x5e52f0[_0x30a4a9(0x27c)],_0x30a4a9(0x1ae)+_0x5e52f0[_0x30a4a9(0x27c)])),_0x227756%_0x2764e4==0x0&&(_0x29bb73[_0x1895cf]=_0x55716a,_0x1895cf++);});const _0x458d2d=Markup[_0x58bff3(0x251)](_0x29bb73);_0x48dd5c[_0x58bff3(0x19a)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x458d2d);}else{const _0x4fb25e=_0x4bb4d0[0x0][_0x58bff3(0x27c)];if(pid[_0x4fb25e])pid[_0x4fb25e][_0x58bff3(0x368)]({'function':_0x58bff3(0x22e),'args':null});}}}),tgBot[_0x289675(0x235)](/metrics_(.+)/,async _0x3f5be8=>{const _0x1fcc59=_0x289675,_0x550923=_0x3f5be8[_0x1fcc59(0x367)][0x1];_0x3f5be8[_0x1fcc59(0x1c8)]();if(pid[_0x550923])pid[_0x550923]['send']({'function':_0x1fcc59(0x22e),'args':null});}),tgBot[_0x289675(0x2dc)](_0x289675(0x27a),async _0x29f0c3=>{const _0x16d56c=_0x289675,_0x4c1ade=getEnabledBots();if(_0x4c1ade['length']==0x0)await sendTelegram(_0x29f0c3[_0x16d56c(0x375)]['id'],_0x16d56c(0x22a));else{if(_0x4c1ade[_0x16d56c(0x2f1)]>0x1){let _0x184bbf=[],_0x5a4cdb=[];const _0x3a99f1=_0x4c1ade['length']%0x4==0x0||_0x4c1ade[_0x16d56c(0x2f1)]%0x4==0x3||_0x4c1ade[_0x16d56c(0x2f1)]%0x3==0x1?0x4:0x3;let _0x87c22d=0x0;_0x4c1ade[_0x16d56c(0x338)]((_0x41af01,_0x448ba1)=>{const _0x221349=_0x16d56c;if(_0x448ba1%_0x3a99f1==0x0)_0x5a4cdb=[];_0x5a4cdb[_0x221349(0x2ef)](Markup['button'][_0x221349(0x289)](_0x221349(0x319)+_0x41af01['botID'],'portfolio_'+_0x41af01[_0x221349(0x27c)])),_0x448ba1%_0x3a99f1==0x0&&(_0x184bbf[_0x87c22d]=_0x5a4cdb,_0x87c22d++);});const _0x406498=Markup[_0x16d56c(0x251)](_0x184bbf);_0x29f0c3[_0x16d56c(0x19a)](_0x16d56c(0x17e),_0x406498);}else{const _0x559644=_0x4c1ade[0x0][_0x16d56c(0x27c)];if(pid[_0x559644])pid[_0x559644][_0x16d56c(0x368)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x289675(0x235)](/portfolio_(.+)/,async _0x48526b=>{const _0x4ec2ac=_0x289675,_0x5a4eeb=_0x48526b[_0x4ec2ac(0x367)][0x1];_0x48526b[_0x4ec2ac(0x1c8)]();if(pid[_0x5a4eeb])pid[_0x5a4eeb]['send']({'function':_0x4ec2ac(0x275),'args':null});}),tgBot[_0x289675(0x2dc)](_0x289675(0x317),async _0x13cbe3=>{const _0x2c07bb=_0x289675;await getMessages();if(!updateAvailable)await sendTelegram(_0x13cbe3[_0x2c07bb(0x375)]['id'],_0x2c07bb(0x1b6));else{if(!validInstallation)await sendTelegram(_0x13cbe3[_0x2c07bb(0x375)]['id'],_0x2c07bb(0x1b4));else{const _0x55e651=Markup['inlineKeyboard']([Markup['button'][_0x2c07bb(0x289)](_0x2c07bb(0x2d9),_0x2c07bb(0x239)),Markup[_0x2c07bb(0x291)]['callback']('No',_0x2c07bb(0x2dd))]);_0x13cbe3[_0x2c07bb(0x19a)](_0x2c07bb(0x2c2),_0x55e651);}}}),tgBot[_0x289675(0x235)](/update_(.+)/,async _0x3a0a9d=>{const _0x4cf797=_0x289675,_0x222548=_0x3a0a9d[_0x4cf797(0x367)][0x1];_0x3a0a9d[_0x4cf797(0x1c8)](),_0x222548==_0x4cf797(0x2de)&&(await sendTelegram(_0x3a0a9d[_0x4cf797(0x375)]['id'],_0x4cf797(0x223)),updateBB(_0x4cf797(0x317))),_0x222548=='no'&&await sendTelegram(_0x3a0a9d[_0x4cf797(0x375)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot['command'](_0x289675(0x27f),async _0x247ee4=>{const _0x1dfbef=_0x289675;if(!validInstallation)await sendTelegram(_0x247ee4['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x1d1f22=Markup[_0x1dfbef(0x251)]([Markup[_0x1dfbef(0x291)][_0x1dfbef(0x289)](_0x1dfbef(0x2d9),_0x1dfbef(0x1a8)),Markup[_0x1dfbef(0x291)]['callback']('No',_0x1dfbef(0x2af))]);_0x247ee4['reply']('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x1d1f22);}}),tgBot['action'](/reinstall_(.+)/,async _0x1b1569=>{const _0x49fc56=_0x289675,_0x1b4174=_0x1b1569[_0x49fc56(0x367)][0x1];_0x1b1569[_0x49fc56(0x1c8)](),_0x1b4174==_0x49fc56(0x2de)&&(await sendTelegram(_0x1b1569[_0x49fc56(0x375)]['id'],_0x49fc56(0x1a6)),updateBB(_0x49fc56(0x27f))),_0x1b4174=='no'&&await sendTelegram(_0x1b1569['chat']['id'],_0x49fc56(0x260));}),tgBot['command'](_0x289675(0x1ab),async _0x550f38=>{const _0x590733=_0x289675,_0x29b4ae=getBotsWithMode();if(_0x29b4ae[_0x590733(0x2f1)]==0x0)await sendTelegram(_0x550f38[_0x590733(0x375)]['id'],_0x590733(0x22a));else{let _0x585c21=[],_0x53d7a1=[];const _0x4cdd45=0x2;let _0x122d41=0x0;_0x29b4ae[_0x590733(0x338)]((_0x1b630f,_0x48f9ab)=>{const _0x553f1e=_0x590733;if(_0x48f9ab%_0x4cdd45==0x0)_0x53d7a1=[];_0x53d7a1['push'](Markup[_0x553f1e(0x291)][_0x553f1e(0x289)](_0x553f1e(0x319)+_0x1b630f['botID']+'\x20('+_0x1b630f['mode']+')','toggle_'+_0x1b630f['botID'])),_0x48f9ab%_0x4cdd45==0x0&&(_0x585c21[_0x122d41]=_0x53d7a1,_0x122d41++);});const _0x394cb8=Markup[_0x590733(0x251)](_0x585c21);_0x550f38['reply'](_0x590733(0x21e),_0x394cb8);}}),tgBot[_0x289675(0x235)](/toggle_(.+)/,async _0x440e36=>{const _0x40c3b4=_0x289675,_0x4c6852=_0x440e36[_0x40c3b4(0x367)][0x1];_0x440e36[_0x40c3b4(0x1c8)]();const _0x382623=getBotsWithMode(),_0x22e66f=_0x382623[_0x40c3b4(0x268)](_0xbcfd11=>_0xbcfd11[_0x40c3b4(0x27c)]==_0x4c6852),_0x4efac0=_0x22e66f['mode']==_0x40c3b4(0x1b3)?_0x40c3b4(0x249):_0x40c3b4(0x1b3);await sendTelegram(_0x440e36[_0x40c3b4(0x375)]['id'],_0x40c3b4(0x2d5)+_0x4c6852+'\x20to\x20'+_0x4efac0+_0x40c3b4(0x1aa)),toggleBotMode(_0x4c6852);}),tgBot['command'](_0x289675(0x346),async _0x539031=>{const _0x34ac66=_0x289675;let _0x1bc235='';config[_0x34ac66(0x338)](_0x49a1a1=>{const _0x298ae6=_0x34ac66;_0x1bc235+=_0x298ae6(0x319)+_0x49a1a1[_0x298ae6(0x27c)]+':\x20'+_0x49a1a1['botname']+'\x0a';}),await sendTelegram(_0x539031['chat']['id'],_0x1bc235,{'parse_mode':_0x34ac66(0x267)});}),tgBot[_0x289675(0x2dc)]('help',async _0x5b1f81=>{const _0x43b8b2=_0x289675;await sendTelegram(_0x5b1f81[_0x43b8b2(0x375)]['id'],_0x3a6ade);}),process[_0x289675(0x33b)](_0x289675(0x2b6),()=>tgBot[_0x289675(0x1bf)](_0x289675(0x2b6))),process[_0x289675(0x33b)](_0x289675(0x34c),()=>tgBot[_0x289675(0x1bf)](_0x289675(0x34c))),tgBot[_0x289675(0x31d)]();}}function disableTelegram(){const _0x3bf3f9=_0x16b6c7;tgBot&&tgBot[_0x3bf3f9(0x1bf)]();}async function sendTelegram(_0x4bdabe,_0x38312a,_0x5ae984){const _0x87316f=_0x16b6c7;_0x5ae984={..._0x5ae984,'disable_web_page_preview':!![]};try{await tgBot[_0x87316f(0x2b4)]['sendMessage'](_0x4bdabe,_0x38312a,_0x5ae984);}catch(_0x266cbb){console[_0x87316f(0x264)](_0x87316f(0x307),_0x266cbb);}}async function sendTelegramBot(_0x5135f5,_0x57ef05){const _0x33bbda=_0x16b6c7;if(settings[_0x33bbda(0x376)]){if(settings[_0x33bbda(0x26a)]==_0x33bbda(0x30c)||(_0x57ef05[_0x33bbda(0x230)]==_0x33bbda(0x313)||_0x57ef05['type']==_0x33bbda(0x228)||_0x57ef05['type']=='success')&&settings['telegramEvents']==_0x33bbda(0x274)||_0x57ef05['type']==_0x33bbda(0x34e)&&settings['telegramEvents']==_0x33bbda(0x202)){if(tgBot&&settings['telegramChatId']){if(_0x57ef05[_0x33bbda(0x2ad)])await sendTelegram(settings['telegramChatId'],_0x57ef05[_0x33bbda(0x1fa)]+_0x33bbda(0x1b5)+_0x57ef05['event']);else await sendTelegram(settings[_0x33bbda(0x189)],'Bot\x20'+_0x5135f5+_0x33bbda(0x1b5)+_0x57ef05[_0x33bbda(0x22c)]);}}}}async function sendTelegramMsg(_0x302a77,_0x13a4b1=_0x16b6c7(0x267)){const _0x43f62c=_0x16b6c7;return settings[_0x43f62c(0x376)]&&tgBot&&settings[_0x43f62c(0x189)]?(await sendTelegram(settings[_0x43f62c(0x189)],_0x302a77,{'parse_mode':_0x13a4b1}),!![]):![];}function getDeviceWithIp(_0x1ca6a0){const _0x319c5f=_0x16b6c7;return devices[_0x319c5f(0x268)](_0x4fb58b=>_0x4fb58b['ip']===_0x1ca6a0);}async function temporaryAccess2FA(_0x80d0cf,_0x15cf78){const _0x10a919=_0x16b6c7;let _0xd8e37a=new Date(),_0x3d110e=![];if(lastIpApproval){if(_0xd8e37a-lastIpApproval<0x1388)_0x3d110e=!![];}lastIpApproval=new Date();if(_0x3d110e)return;if(tgBot&&settings[_0x10a919(0x189)]){const _0x1ef8df=uuidRandom();tmpStorage[_0x1ef8df]={'uuid':_0x80d0cf,'externalip':_0x15cf78};const _0x48b913=Markup[_0x10a919(0x251)]([Markup[_0x10a919(0x291)][_0x10a919(0x289)](_0x10a919(0x29e),_0x10a919(0x382)+_0x1ef8df),Markup[_0x10a919(0x291)][_0x10a919(0x289)](_0x10a919(0x19b),_0x10a919(0x389)+_0x1ef8df),Markup[_0x10a919(0x291)][_0x10a919(0x289)](_0x10a919(0x1ee),_0x10a919(0x1cf)+_0x1ef8df),Markup[_0x10a919(0x291)][_0x10a919(0x289)]('reject',_0x10a919(0x340)+_0x1ef8df)]);await sendTelegram(settings[_0x10a919(0x189)],_0x10a919(0x195)+normalizeIP(_0x15cf78)['show']+'\x20?',_0x48b913),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x19b75f=>{const _0x25ac3d=_0x10a919,_0x530c1d=_0x19b75f[_0x25ac3d(0x367)][0x1],_0x279bd7=_0x19b75f[_0x25ac3d(0x367)][0x2],{uuid:_0x32867a,externalip:_0x192a45}=tmpStorage[_0x279bd7];delete tmpStorage[_0x279bd7],_0x19b75f[_0x25ac3d(0x1c8)](),devices[_0x32867a][_0x25ac3d(0x354)]={'clientip':_0x192a45,'timestamp':new Date()['getTime'](),'expiry':_0x530c1d},_0x530c1d!=_0x25ac3d(0x33e)?(await sendTelegram(_0x19b75f[_0x25ac3d(0x375)]['id'],_0x25ac3d(0x32a)+_0x530c1d+_0x25ac3d(0x2d8),{'parse_mode':'HTML'}),io['to'](_0x32867a)[_0x25ac3d(0x1c3)](_0x25ac3d(0x2c8),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x19b75f[_0x25ac3d(0x375)]['id'],_0x25ac3d(0x2ab)),io['to'](_0x32867a)['emit'](_0x25ac3d(0x2c8),{'access':{'allow':![],'reason':_0x25ac3d(0x209),'token':null}}));});}}async function loginAccess2FA(_0x817e51,_0x42ee1a){const _0x21a99b=_0x16b6c7;if(tgBot&&settings[_0x21a99b(0x189)]){const _0x401157=uuidRandom();tmpStorage[_0x401157]={'uuid':_0x817e51,'externalip':_0x42ee1a};const _0x51e2b8=Markup['inlineKeyboard']([Markup[_0x21a99b(0x291)][_0x21a99b(0x289)](_0x21a99b(0x2b9),_0x21a99b(0x29a)+loginExpiry+'_'+_0x401157),Markup[_0x21a99b(0x291)]['callback'](_0x21a99b(0x33e),'login2fa_reject_'+_0x401157)]);await sendTelegram(settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x42ee1a)['show']+'\x20?',_0x51e2b8),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x4a4e4f=>{const _0x54cf79=_0x21a99b,_0x8747f4=_0x4a4e4f[_0x54cf79(0x367)][0x1],_0x6a485c=_0x4a4e4f['match'][0x2],{uuid:_0x41205d,externalip:_0x3312ba}=tmpStorage[_0x6a485c];delete tmpStorage[_0x6a485c],_0x4a4e4f[_0x54cf79(0x1c8)](),devices[_0x41205d][_0x54cf79(0x332)]={'clientip':_0x3312ba,'timestamp':new Date()['getTime'](),'expiry':_0x8747f4},_0x8747f4!=_0x54cf79(0x33e)?(await sendTelegram(_0x4a4e4f[_0x54cf79(0x375)]['id'],_0x54cf79(0x257),{'parse_mode':_0x54cf79(0x267)}),io['to'](_0x41205d)[_0x54cf79(0x1c3)](_0x54cf79(0x2c8),{'access':{'allow':![],'reason':_0x54cf79(0x2a7),'token':null}})):(await sendTelegram(_0x4a4e4f['chat']['id'],_0x54cf79(0x250)),io['to'](_0x41205d)[_0x54cf79(0x1c3)](_0x54cf79(0x2c8),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x5c4010=_0x16b6c7;return dbConfig[_0x5c4010(0x345)](_0x5c4010(0x333))[_0x5c4010(0x35e)](_0x5c4010(0x27c))[_0x5c4010(0x2ba)]({'status':'enabled'})[_0x5c4010(0x233)]()||[];}function getDisabledBots(){const _0x3b0386=_0x16b6c7;return dbConfig[_0x3b0386(0x345)](_0x3b0386(0x333))[_0x3b0386(0x35e)](_0x3b0386(0x27c))[_0x3b0386(0x2ba)]({'status':_0x3b0386(0x2a0)})[_0x3b0386(0x233)]()||[];}function getBotAttributes(_0x7a9c0c){const _0x38a7dd=_0x16b6c7;let _0x2ef9cd={};const _0x3c6e13=configpath+_0x38a7dd(0x2f5)+_0x7a9c0c+_0x38a7dd(0x213),_0x747b54=fs['existsSync'](_0x3c6e13);if(_0x747b54){const _0x55c63a=fs[_0x38a7dd(0x211)](_0x3c6e13);try{const _0x23b374=JSON[_0x38a7dd(0x37c)](_0x55c63a),_0x2925ea=_0x23b374?_0x23b374[_0x38a7dd(0x311)][0x0][_0x38a7dd(0x341)]:![];_0x2ef9cd[_0x38a7dd(0x24d)]=_0x2925ea?_0x38a7dd(0x1b3):_0x38a7dd(0x249),_0x2ef9cd[_0x38a7dd(0x1fa)]=_0x23b374?_0x23b374[_0x38a7dd(0x311)][0x0][_0x38a7dd(0x1fa)]:_0x38a7dd(0x319)+_0x7a9c0c;}catch(_0x161e5f){_0x2ef9cd['mode']=_0x38a7dd(0x249),_0x2ef9cd[_0x38a7dd(0x1fa)]=_0x38a7dd(0x319)+_0x7a9c0c;}}else _0x2ef9cd[_0x38a7dd(0x24d)]='manual',_0x2ef9cd[_0x38a7dd(0x1fa)]='Bot\x20'+_0x7a9c0c;return _0x2ef9cd;}function getBotsWithMode(){const _0x30c37a=_0x16b6c7,_0xf43c54=dbConfig[_0x30c37a(0x345)](_0x30c37a(0x333))[_0x30c37a(0x35e)](_0x30c37a(0x27c))[_0x30c37a(0x233)]()||[];return _0xf43c54[_0x30c37a(0x338)](_0x1068c3=>{const _0xb65d3=_0x30c37a;let _0x1c6163=getBotAttributes(_0x1068c3[_0xb65d3(0x27c)]);_0x1068c3[_0xb65d3(0x24d)]=_0x1c6163[_0xb65d3(0x24d)];}),_0xf43c54;}function getBotExchanges(){const _0x4443d2=_0x16b6c7;let _0x231b04=[];const _0x1bae68=dbConfig[_0x4443d2(0x345)](_0x4443d2(0x333))[_0x4443d2(0x35e)](_0x4443d2(0x27c))[_0x4443d2(0x233)]()||[];_0x1bae68[_0x4443d2(0x338)](_0x16b02e=>{const _0x22e191=_0x4443d2;if(_0x16b02e[_0x22e191(0x2c8)]==_0x22e191(0x2b3)){const _0x5b5c13=configpath+_0x22e191(0x2f5)+_0x16b02e[_0x22e191(0x27c)]+_0x22e191(0x213),_0xd06da6=fs[_0x22e191(0x2e9)](_0x5b5c13);let _0x50210f;if(_0xd06da6){const _0x2e9eb8=fs['readFileSync'](_0x5b5c13);try{const _0x598c41=JSON[_0x22e191(0x37c)](_0x2e9eb8);_0x50210f=_0x598c41?_0x598c41[_0x22e191(0x311)][0x0][_0x22e191(0x33a)]:null;}catch(_0x5aed17){}}if(_0x50210f)_0x231b04[_0x22e191(0x2ef)](_0x50210f);}});const _0x50fccf=[...new Set(_0x231b04)][_0x4443d2(0x24c)]();return _0x50fccf;}async function initUser(){const _0x3ab754=_0x16b6c7;if(!settings[_0x3ab754(0x273)]){const _0x10bb53=uuidRandom();mixpanel['alias'](_0x10bb53),updateSetting(_0x3ab754(0x273),_0x10bb53);}}async function initSecure(){const _0x31e0cb=_0x16b6c7;let _0x469e13=getSecure();if(!_0x469e13['hasOwnProperty'](_0x31e0cb(0x225))){let _0x2f7765=await generateKeys();_0x469e13['publicKey']=_0x2f7765[_0x31e0cb(0x18d)],_0x469e13[_0x31e0cb(0x269)]=_0x2f7765['privateKey'],_0x469e13[_0x31e0cb(0x225)]=crypto['randomBytes'](0x20)[_0x31e0cb(0x2f2)](_0x31e0cb(0x370));;storeSecure(_0x469e13);}}function getSettings(){const _0x3895aa=_0x16b6c7;return dbSettings[_0x3895aa(0x345)]('settings')[_0x3895aa(0x233)]()||{};}function getSecure(){const _0x48f084=_0x16b6c7;return dbSecure['get']('secure')[_0x48f084(0x233)]()||{};}function getBlacklist(){const _0x58062c=_0x16b6c7;return dbSecure['get'](_0x58062c(0x298))[_0x58062c(0x233)]()||[];}function broadcastToBots(_0x244e05,_0x144819){const _0x5b6c34=_0x16b6c7;config[_0x5b6c34(0x338)](_0x32be15=>{const _0x4a6f7d=_0x5b6c34;if(_0x32be15['status']=='enabled'&&_0x32be15[_0x4a6f7d(0x374)]=='running'||_0x32be15['status']==_0x4a6f7d(0x20a)&&_0x32be15['live']==_0x4a6f7d(0x33d)){if(pid[_0x32be15[_0x4a6f7d(0x27c)]])pid[_0x32be15[_0x4a6f7d(0x27c)]][_0x4a6f7d(0x368)]({[_0x244e05]:_0x144819});}});}async function storeSettings(_0x4baeed,_0x2fa3ac=![]){const _0x41506b=_0x16b6c7;_0x4baeed={...settings,..._0x4baeed};if(_0x2fa3ac&&_0x4baeed[_0x41506b(0x201)]!=_0x41506b(0x1c6)&&_0x4baeed[_0x41506b(0x201)]!=_0x41506b(0x2ed)&&_0x4baeed[_0x41506b(0x201)]!=''){const _0x28f1c2=decryptRSA(secure[_0x41506b(0x269)],_0x4baeed[_0x41506b(0x201)])[_0x41506b(0x336)](_0x41506b(0x2ca))[0x0],_0xcabfd1=bcrypt['hashSync'](_0x28f1c2,saltRounds);_0x4baeed={..._0x4baeed,'bbPassword':_0xcabfd1};}if(_0x2fa3ac&&_0x4baeed[_0x41506b(0x20c)]!=_0x41506b(0x1c6)&&_0x4baeed[_0x41506b(0x20c)]!='***'&&_0x4baeed[_0x41506b(0x20c)]!=''){const _0x30b05d=decryptRSA(secure[_0x41506b(0x269)],_0x4baeed[_0x41506b(0x20c)])[_0x41506b(0x336)](_0x41506b(0x2ca))[0x0];_0x4baeed={..._0x4baeed,'telegramToken':_0x30b05d};}if(_0x2fa3ac&&_0x4baeed[_0x41506b(0x369)]!=_0x41506b(0x1c6)&&_0x4baeed[_0x41506b(0x369)]!=_0x41506b(0x2ed)&&_0x4baeed[_0x41506b(0x369)]!=''){const _0x267d35=decryptRSA(secure[_0x41506b(0x269)],_0x4baeed[_0x41506b(0x369)])[_0x41506b(0x336)](_0x41506b(0x2ca))[0x0];_0x4baeed={..._0x4baeed,'marketcapApi':_0x267d35};}const _0x58945b=_0x4baeed[_0x41506b(0x20c)]!=_0x41506b(0x1c6)&&_0x4baeed[_0x41506b(0x20c)]!=settings[_0x41506b(0x20c)]||_0x4baeed[_0x41506b(0x326)]!=settings['telegramUsername'],_0x34d31d=_0x4baeed['telegramToken']==''||_0x4baeed[_0x41506b(0x326)]=='',_0x4a8218=_0x4baeed[_0x41506b(0x369)]&&_0x4baeed['marketcapApi']!=_0x41506b(0x1c6)&&_0x4baeed[_0x41506b(0x369)]!=settings[_0x41506b(0x20c)];_0x58945b&&(_0x4baeed[_0x41506b(0x189)]=null,_0x4baeed[_0x41506b(0x26a)]='all');for(const [_0x55e144,_0x40a1ea]of Object[_0x41506b(0x2c9)](_0x4baeed)){if(_0x55e144==_0x41506b(0x20c)&&_0x40a1ea==_0x41506b(0x1c6)){_0x4baeed[_0x41506b(0x20c)]=settings[_0x41506b(0x20c)];continue;};if(_0x55e144==_0x41506b(0x201)&&_0x40a1ea==_0x41506b(0x1c6)){_0x4baeed[_0x41506b(0x201)]=settings[_0x41506b(0x201)];continue;};if(_0x55e144=='marketcapApi'&&_0x40a1ea==_0x41506b(0x1c6)){_0x4baeed[_0x41506b(0x369)]=settings['marketcapApi'];continue;};dbSettings[_0x41506b(0x2ac)](_0x41506b(0x2a2)+_0x55e144,_0x40a1ea)[_0x41506b(0x371)]();}settings=_0x4baeed,io['to']('botmanager')[_0x41506b(0x1c3)]('settings',cleanSettings()),broadcastToBots(_0x41506b(0x1a2),settings[_0x41506b(0x1a2)]),broadcastToBots(_0x41506b(0x2b0),settings[_0x41506b(0x2b0)]),broadcastToBots(_0x41506b(0x369),settings['marketcapApi']);if(_0x58945b&&!_0x34d31d)initTelegram();if(_0x58945b&&_0x34d31d)disableTelegram();getAllClients()[_0x41506b(0x338)](_0x1b45db=>{const _0x1ae18c=_0x41506b;getSocket(_0x1b45db['id'])[_0x1ae18c(0x1c3)](_0x1ae18c(0x2c8),{'access':{'allow':![],'reason':_0x1ae18c(0x2a7),'token':null}});}),_0x4a8218&&(await sleep(0xbb8),testMarketcapApi(_0x4baeed[_0x41506b(0x369)]));}async function testMarketcapApi(_0x55a8dc){const _0x512701=_0x16b6c7,_0x234006=[_0x512701(0x187),_0x512701(0x2ae)];try{await axios[_0x512701(0x345)](_0x512701(0x339),{'headers':{'X-CMC_PRO_API_KEY':_0x55a8dc},'params':{'symbol':_0x234006[_0x512701(0x2f2)]()}});}catch(_0x4f2c4c){_0x4f2c4c['toString']()['includes'](_0x512701(0x1f5))?(io['to'](_0x512701(0x2d2))['emit'](_0x512701(0x1f2),_0x512701(0x240)),logger[_0x512701(0x290)](_0x512701(0x240))):(io['to'](_0x512701(0x2d2))[_0x512701(0x1c3)](_0x512701(0x1f2),_0x512701(0x271)),logger[_0x512701(0x290)](_0x512701(0x271)),logger[_0x512701(0x2f0)]('Error\x20details:',_0x4f2c4c['toString']()+_0x512701(0x2ff)+_0x4f2c4c[_0x512701(0x205)]));return;}logger['debug'](_0x512701(0x20e));}function updateSetting(_0x9d3fc0,_0x599eef){const _0x40e077=_0x16b6c7;dbSettings[_0x40e077(0x2ac)]('settings.'+_0x9d3fc0,_0x599eef)[_0x40e077(0x371)](),settings=getSettings(),io['to'](_0x40e077(0x2d2))[_0x40e077(0x1c3)](_0x40e077(0x334),cleanSettings());}function storeSecure(_0x2dc724){const _0x9c037e=_0x16b6c7;dbSecure[_0x9c037e(0x345)](_0x9c037e(0x377))[_0x9c037e(0x2ef)](_0x2dc724)[_0x9c037e(0x371)](),secure=_0x2dc724;}function addBlacklist(_0x44d5e7){const _0x2552b6=_0x16b6c7;cleanBlacklist();let _0x139a0d;devices[_0x44d5e7][_0x2552b6(0x354)]?_0x139a0d=Math[_0x2552b6(0x392)](devices[_0x44d5e7]['telegramIpApproval'][_0x2552b6(0x293)],loginExpiry):_0x139a0d=loginExpiry,dbSecure[_0x2552b6(0x345)](_0x2552b6(0x298))['push']({'expiry':new Date()[_0x2552b6(0x1bc)]()+_0x139a0d*0x3c*0x3e8,'token':devices[_0x44d5e7]['access'][_0x2552b6(0x1c0)]})[_0x2552b6(0x371)](),blacklist=dbSecure[_0x2552b6(0x345)](_0x2552b6(0x298))[_0x2552b6(0x233)]();}function cleanBlacklist(){const _0x1ae650=_0x16b6c7;let _0x221269=dbSecure[_0x1ae650(0x345)]('blacklist')[_0x1ae650(0x280)]()[_0x1ae650(0x233)](),_0x334950=new Date()[_0x1ae650(0x1bc)]();_0x221269[_0x1ae650(0x338)](_0x43f120=>{const _0x58f63a=_0x1ae650;_0x43f120['expiry']<_0x334950&&dbSecure[_0x58f63a(0x345)](_0x58f63a(0x298))[_0x58f63a(0x256)]({'expiry':_0x43f120[_0x58f63a(0x293)]})[_0x58f63a(0x371)]();});}function initStates(){const _0x1f90c7=_0x16b6c7;let _0xd7f0f4=getConfiguration();_0xd7f0f4[_0x1f90c7(0x338)](_0x1bc67e=>{const _0x53c89b=_0x1f90c7;_0x1bc67e[_0x53c89b(0x374)]='stopped';}),storeConfiguration(_0xd7f0f4);}async function generateKeys(){const _0x12afd1=_0x16b6c7,_0x5c2ff8=forge[_0x12afd1(0x25b)][_0x12afd1(0x294)]['generateKeyPair']({'bits':0x1000,'e':0x10001}),_0x302a7f=forge['pki']['privateKeyToPem'](_0x5c2ff8[_0x12afd1(0x269)]),_0x51a192=forge[_0x12afd1(0x25b)][_0x12afd1(0x1e8)](_0x5c2ff8[_0x12afd1(0x18d)]);return{'privateKey':_0x302a7f,'publicKey':_0x51a192};}async function oneTimeMigration(){const _0x4c215f=_0x16b6c7;let _0xc09b64=getSettings(),_0x55820f=![];!_0xc09b64[_0x4c215f(0x18f)](_0x4c215f(0x361))&&(_0xc09b64['lastmsgtelegram']=0x0,_0x55820f=!![]);!_0xc09b64[_0x4c215f(0x18f)](_0x4c215f(0x21c))&&(_0xc09b64[_0x4c215f(0x21c)]=0x0,_0x55820f=!![]);!_0xc09b64[_0x4c215f(0x18f)](_0x4c215f(0x36b))&&(_0xc09b64[_0x4c215f(0x36b)]=_0x4c215f(0x2c3),_0x55820f=!![]);!_0xc09b64['hasOwnProperty']('onepagemode')&&(_0xc09b64['onepagemode']=![],_0x55820f=!![]);!_0xc09b64[_0x4c215f(0x18f)](_0x4c215f(0x369))&&(_0xc09b64['marketcapApi']='',_0x55820f=!![]);if(_0x55820f)storeSettings(_0xc09b64);try{fs[_0x4c215f(0x1ec)](configbackuppath,{'withFileTypes':!![]})[_0x4c215f(0x338)](_0x56be2a=>{const _0x5b0314=_0x4c215f;if(!_0x56be2a[_0x5b0314(0x2f3)]()){if(!_0x56be2a[_0x5b0314(0x23a)]['startsWith'](_0x5b0314(0x2d4)))fs[_0x5b0314(0x386)](configbackuppath+_0x56be2a[_0x5b0314(0x23a)]);}else fs[_0x5b0314(0x180)](configbackuppath+_0x56be2a[_0x5b0314(0x23a)],{'recursive':!![]});});}catch(_0x3ff784){logger['debug'](_0x4c215f(0x212),_0x3ff784);}}function storeConfiguration(_0x2ab34f){const _0x29804a=_0x16b6c7;dbConfig[_0x29804a(0x345)]('bots')[_0x29804a(0x256)]()['write'](),dbConfig[_0x29804a(0x345)]('bots')['push'](..._0x2ab34f)[_0x29804a(0x371)](),config=_0x2ab34f;}async function resetPassword(){const _0x41eb4a=_0x16b6c7;if(tgBot&&settings[_0x41eb4a(0x189)]){const _0x331f82=Markup[_0x41eb4a(0x251)]([Markup[_0x41eb4a(0x291)][_0x41eb4a(0x289)]('yes',_0x41eb4a(0x330)),Markup[_0x41eb4a(0x291)][_0x41eb4a(0x289)]('no',_0x41eb4a(0x244))]);await sendTelegram(settings[_0x41eb4a(0x189)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x331f82),tgBot[_0x41eb4a(0x235)](/resetpw_(.+)/,async _0x5277a4=>{const _0x336ce5=_0x41eb4a,_0x52bbb7=_0x5277a4['match'][0x1];_0x5277a4[_0x336ce5(0x1c8)]();if(_0x52bbb7!='no'){const _0xf48b=0xf,_0x1e7cbd=_0x336ce5(0x1ef),_0x595bff=Array[_0x336ce5(0x1c1)](crypto[_0x336ce5(0x216)](new Uint32Array(_0xf48b)))[_0x336ce5(0x35f)](_0x125bed=>_0x1e7cbd[_0x125bed%_0x1e7cbd[_0x336ce5(0x2f1)]])[_0x336ce5(0x198)](''),_0x46543a=bcrypt[_0x336ce5(0x1a9)](_0x595bff,saltRounds);storeSettings({'bbPassword':_0x46543a}),await sendTelegram(_0x5277a4[_0x336ce5(0x375)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x595bff,{'parse_mode':_0x336ce5(0x267)});}else await sendTelegram(_0x5277a4[_0x336ce5(0x375)]['id'],_0x336ce5(0x270));});}}async function confirmRestore(_0xe5d56f,_0x1c8446){const _0x3b65bd=_0x16b6c7;io['to'](_0x3b65bd(0x2d2))[_0x3b65bd(0x1c3)](_0x3b65bd(0x1f2),_0x3b65bd(0x2ea),_0x3b65bd(0x2cd));if(tgBot&&settings[_0x3b65bd(0x189)]){const _0x48a85f=uuidRandom();tmpStorage[_0x48a85f]={'path':_0xe5d56f,'filename':_0x1c8446};const _0x7d3e18=Markup['inlineKeyboard']([Markup[_0x3b65bd(0x291)]['callback'](_0x3b65bd(0x2de),_0x3b65bd(0x393)+_0x48a85f),Markup[_0x3b65bd(0x291)][_0x3b65bd(0x289)]('no',_0x3b65bd(0x1cc)+_0x48a85f)]);await sendTelegram(settings['telegramChatId'],_0x3b65bd(0x344),_0x7d3e18),tgBot[_0x3b65bd(0x235)](/restore_(.+)_(.+)/,async _0x45dec4=>{const _0x2febcc=_0x3b65bd,_0x5466d2=_0x45dec4[_0x2febcc(0x367)][0x1],_0x5449b8=_0x45dec4[_0x2febcc(0x367)][0x2],{path:_0x566df4,filename:_0x17daab}=tmpStorage[_0x5449b8];delete tmpStorage[_0x5449b8],_0x45dec4[_0x2febcc(0x1c8)](),_0x5466d2==_0x2febcc(0x2de)?(logger[_0x2febcc(0x2f0)](_0x2febcc(0x391)),await sendTelegram(_0x45dec4[_0x2febcc(0x375)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':'HTML'}),unzipFile(_0x566df4,_0x17daab)):(logger['debug']('Restore\x20process\x20aborted'),await sendTelegram(_0x45dec4[_0x2febcc(0x375)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x3e8463=_0x16b6c7,_0x2285b3=new Date();return _0x2285b3[_0x3e8463(0x2bb)]()+'/'+(_0x2285b3[_0x3e8463(0x31b)]()+0x1)['toString']()[_0x3e8463(0x22f)](0x2,'0')+'/'+_0x2285b3[_0x3e8463(0x1ce)]()[_0x3e8463(0x2f2)]()[_0x3e8463(0x22f)](0x2,'0')+'\x20'+_0x2285b3[_0x3e8463(0x1d9)]()[_0x3e8463(0x2f2)]()[_0x3e8463(0x22f)](0x2,'0')+':'+_0x2285b3[_0x3e8463(0x1c9)]()['toString']()['padStart'](0x2,'0')+':'+_0x2285b3[_0x3e8463(0x29d)]()[_0x3e8463(0x2f2)]()[_0x3e8463(0x22f)](0x2,'0');}function getTimeStamp(){const _0x42205a=_0x16b6c7,_0x559c56=shiftedTime();return _0x559c56[_0x42205a(0x2bb)]()+'/'+(_0x559c56[_0x42205a(0x31b)]()+0x1)[_0x42205a(0x2f2)]()[_0x42205a(0x22f)](0x2,'0')+'/'+_0x559c56['getDate']()[_0x42205a(0x2f2)]()[_0x42205a(0x22f)](0x2,'0')+'\x20'+_0x559c56[_0x42205a(0x1d9)]()[_0x42205a(0x2f2)]()['padStart'](0x2,'0')+':'+_0x559c56['getMinutes']()[_0x42205a(0x2f2)]()[_0x42205a(0x22f)](0x2,'0')+':'+_0x559c56[_0x42205a(0x29d)]()[_0x42205a(0x2f2)]()[_0x42205a(0x22f)](0x2,'0');}function getCleanTimeStamp(){const _0x18b142=_0x16b6c7,_0xbd176c=shiftedTime();return _0xbd176c['getFullYear']()+(_0xbd176c[_0x18b142(0x31b)]()+0x1)[_0x18b142(0x2f2)]()[_0x18b142(0x22f)](0x2,'0')+_0xbd176c[_0x18b142(0x1ce)]()['toString']()['padStart'](0x2,'0')+'-'+_0xbd176c[_0x18b142(0x1d9)]()['toString']()[_0x18b142(0x22f)](0x2,'0')+_0xbd176c[_0x18b142(0x1c9)]()[_0x18b142(0x2f2)]()[_0x18b142(0x22f)](0x2,'0')+_0xbd176c[_0x18b142(0x29d)]()[_0x18b142(0x2f2)]()[_0x18b142(0x22f)](0x2,'0');}function shiftedTime(){const _0x4a5d2e=_0x16b6c7,_0x51e78c=new Date();let _0x5d35a3=_0x51e78c;if(settings[_0x4a5d2e(0x1a2)]&&settings[_0x4a5d2e(0x1a2)]!==0x0)_0x5d35a3=fns[_0x4a5d2e(0x193)](_0x51e78c,{'hours':settings[_0x4a5d2e(0x1a2)]});return _0x5d35a3;}async function startScheduler(){const _0x2733ac=_0x16b6c7,_0x13613d=new Date()[_0x2733ac(0x2c1)](),_0x38ad21=shiftedTime()[_0x2733ac(0x1d9)]();_0x38ad21==0x4&&backupConfigFiles(),_0x38ad21==0x0&&rotateLogFiles(),_0x13613d%0x6==0x0&&triggerAnalytics(),_0x13613d%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x7a7be4){const _0x2a9072=_0x16b6c7;logger[_0x2a9072(0x2f0)](_0x2a9072(0x2cb)+_0x7a7be4);const _0x39a016=getBotsWithMode();_0x39a016[_0x2a9072(0x2f1)]>0x0?confirmRestore(configbackuppath,_0x7a7be4):unzipFile(configbackuppath,_0x7a7be4);}async function getBackupFiles(_0x5aad4d=null){const _0x1c96b3=_0x16b6c7;let _0x360ac1=[],_0x107f93=fs[_0x1c96b3(0x1ec)](configbackuppath,{'withFileTypes':!![]});_0x107f93[_0x1c96b3(0x24c)]((_0x55e61d,_0x4ee337)=>_0x55e61d['name']<_0x4ee337[_0x1c96b3(0x23a)]?0x1:_0x4ee337[_0x1c96b3(0x23a)]<_0x55e61d[_0x1c96b3(0x23a)]?-0x1:0x0),_0x107f93[_0x1c96b3(0x338)](_0x45c6c3=>{const _0x19adf5=_0x1c96b3;if(!_0x45c6c3['isDirectory']()&&_0x45c6c3[_0x19adf5(0x23a)][_0x19adf5(0x231)](_0x19adf5(0x2d4))&&_0x45c6c3['name'][_0x19adf5(0x351)]('.zip')){const _0x11fe6e=formatDate(fs[_0x19adf5(0x184)](configbackuppath+_0x45c6c3[_0x19adf5(0x23a)])[_0x19adf5(0x2c0)]);_0x360ac1[_0x19adf5(0x2ef)]({'name':_0x45c6c3[_0x19adf5(0x23a)],'mtime':_0x11fe6e});}});if(_0x5aad4d)io['to'](_0x5aad4d)['emit'](_0x1c96b3(0x2fe),_0x360ac1);else return _0x360ac1;}async function backupConfigFiles(){const _0x56e1ba=_0x16b6c7;await zipFiles(_0x56e1ba(0x26f));const _0x1d051b=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x56e1ba(0x226),configbackuppath+(_0x56e1ba(0x2d4)+_0x1d051b+_0x56e1ba(0x320)));let _0x1594b2=fs[_0x56e1ba(0x1ec)](configbackuppath,{'withFileTypes':!![]});_0x1594b2['sort']((_0xf8f03e,_0x561668)=>_0xf8f03e[_0x56e1ba(0x23a)]<_0x561668['name']?0x1:_0x561668['name']<_0xf8f03e[_0x56e1ba(0x23a)]?-0x1:0x0),_0x1594b2[_0x56e1ba(0x2f1)]>maxBackups&&fs[_0x56e1ba(0x386)](configbackuppath+_0x1594b2[_0x1594b2['length']-0x1]['name']);}function rotateLogFiles(){const _0x34b921=_0x16b6c7,_0x5cb7bc=fs['statSync'](logspath+'output-000.log'),_0xc7bf6f=_0x5cb7bc[_0x34b921(0x1e6)]/0x400;if(_0xc7bf6f>0x64){let _0x1c5dc2=fs[_0x34b921(0x1ec)](logspath,{'withFileTypes':!![]});_0x1c5dc2['sort']((_0x581026,_0x406b7e)=>_0x581026['name']<_0x406b7e[_0x34b921(0x23a)]?0x1:_0x406b7e[_0x34b921(0x23a)]<_0x581026[_0x34b921(0x23a)]?-0x1:0x0),_0x1c5dc2[_0x34b921(0x338)](_0x1c46cf=>{const _0x6979a0=_0x34b921;if(_0x1c46cf[_0x6979a0(0x23a)]==_0x6979a0(0x35a))fs[_0x6979a0(0x34f)](logspath+_0x1c46cf[_0x6979a0(0x23a)],logspath+'output-003.log');if(_0x1c46cf[_0x6979a0(0x23a)]==_0x6979a0(0x191))fs[_0x6979a0(0x34f)](logspath+_0x1c46cf[_0x6979a0(0x23a)],logspath+_0x6979a0(0x35a));_0x1c46cf[_0x6979a0(0x23a)]==_0x6979a0(0x1de)&&(fs[_0x6979a0(0x34f)](logspath+_0x1c46cf[_0x6979a0(0x23a)],logspath+_0x6979a0(0x191)),fs[_0x6979a0(0x299)](logspath+_0x1c46cf[_0x6979a0(0x23a)],''));});}}async function zipFiles(_0x304673){const _0xa043e=_0x16b6c7;let _0x490299;if(_0x304673==_0xa043e(0x1fd))_0x490299=logspath;if(_0x304673==_0xa043e(0x2e1))_0x490299=configpath;if(_0x304673==_0xa043e(0x26f))_0x490299=configpath;let _0x5da5ce=fs[_0xa043e(0x1ec)](_0x490299,{'withFileTypes':!![]});const _0x1e40c9=new JSZip();_0x5da5ce[_0xa043e(0x338)](_0x162d16=>{const _0x6b4730=_0xa043e;if(!_0x162d16[_0x6b4730(0x2f3)]()){let _0x299b45=fs['readFileSync'](_0x490299+_0x162d16[_0x6b4730(0x23a)]);if(_0x304673==_0x6b4730(0x2e1)){const _0x48b1b7=/^bot-[0-9]{3}-config.json$/,_0x568dd4=_0x48b1b7[_0x6b4730(0x379)](_0x162d16['name']);if(_0x568dd4){const _0x4f868f=JSON[_0x6b4730(0x37c)](_0x299b45);if(_0x4f868f[_0x6b4730(0x311)][0x0]){_0x4f868f[_0x6b4730(0x311)][0x0]['apiKey']=_0x6b4730(0x2ed),_0x4f868f[_0x6b4730(0x311)][0x0][_0x6b4730(0x284)]=_0x6b4730(0x2ed);if(_0x4f868f['bot'][0x0]['apiPassword'])_0x4f868f[_0x6b4730(0x311)][0x0][_0x6b4730(0x28d)]=_0x6b4730(0x2ed);}_0x299b45=JSON['stringify'](_0x4f868f,null,0x2);}if(_0x162d16[_0x6b4730(0x23a)]=='bb-settings.json'){const _0x5bc83c=JSON[_0x6b4730(0x37c)](_0x299b45);if(_0x5bc83c[_0x6b4730(0x334)][_0x6b4730(0x206)])_0x5bc83c[_0x6b4730(0x334)][_0x6b4730(0x206)]=![];if(_0x5bc83c[_0x6b4730(0x334)][_0x6b4730(0x201)])_0x5bc83c[_0x6b4730(0x334)][_0x6b4730(0x201)]=_0x6b4730(0x2ed);if(_0x5bc83c['settings'][_0x6b4730(0x20c)])_0x5bc83c[_0x6b4730(0x334)][_0x6b4730(0x20c)]=_0x6b4730(0x2ed);if(_0x5bc83c[_0x6b4730(0x334)][_0x6b4730(0x189)])_0x5bc83c[_0x6b4730(0x334)][_0x6b4730(0x189)]=null;if(_0x5bc83c[_0x6b4730(0x334)][_0x6b4730(0x369)])_0x5bc83c['settings']['marketcapApi']='***';_0x299b45=JSON[_0x6b4730(0x372)](_0x5bc83c,null,0x2);}if(_0x162d16[_0x6b4730(0x23a)]!=_0x6b4730(0x204))_0x1e40c9[_0x6b4730(0x265)](_0x162d16[_0x6b4730(0x23a)],_0x299b45);}else _0x1e40c9[_0x6b4730(0x265)](_0x162d16[_0x6b4730(0x23a)],_0x299b45);}});const _0x45c9e3=await _0x1e40c9['generateAsync']({'type':_0xa043e(0x30a),'base64':![],'compression':_0xa043e(0x2f8)});fs[_0xa043e(0x299)](zippath+(_0x304673+'.zip'),_0x45c9e3,'binary');}async function unzipFile(_0x188b12,_0x44f4c0){const _0x4a06dd=_0x16b6c7;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x4a06dd(0x338)](_0x2f482d=>{const _0x5eb4a5=_0x4a06dd;if(!_0x2f482d[_0x5eb4a5(0x2f3)]())fs[_0x5eb4a5(0x180)](configpath+_0x2f482d['name']);});const _0x57d1e8=fs[_0x4a06dd(0x211)](_0x188b12+_0x44f4c0,_0x4a06dd(0x37b)),_0x19a1aa=await JSZip[_0x4a06dd(0x388)](_0x57d1e8,{'base64':![],'checkCRC32':!![]});for(const _0x1f1dde of Object[_0x4a06dd(0x232)](_0x19a1aa[_0x4a06dd(0x17b)])){const _0x2479bd=_0x19a1aa[_0x4a06dd(0x17b)][_0x1f1dde],_0x2e0d4d=await _0x2479bd['async'](_0x4a06dd(0x30a));fs[_0x4a06dd(0x299)](configpath+_0x2479bd['name'],_0x2e0d4d);}fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x4a06dd(0x338)](_0x41676d=>{const _0x1c9229=_0x4a06dd;if(!_0x41676d['isDirectory']())fs[_0x1c9229(0x180)](temppath+_0x41676d[_0x1c9229(0x23a)]);}),logger[_0x4a06dd(0x2f0)](_0x4a06dd(0x2f6)),process[_0x4a06dd(0x368)]({'restore':!![]},_0x196507=>{});}async function getPublicIp(){const _0x752f9a=_0x16b6c7;try{const _0x1725bb=await axios['get'](_0x752f9a(0x1c5));publicip=_0x1725bb[_0x752f9a(0x2b5)]['ip'];}catch(_0x1a27db){}}async function triggerAnalytics(){const _0x273083=_0x16b6c7;if(!publicip)await getPublicIp();const _0x345d97=getBotsWithMode();let _0x2212a5=0x0;_0x345d97[_0x273083(0x338)](_0x18d493=>{if(_0x18d493['status']==='enabled')_0x2212a5++;});const _0x59e30d=getBotExchanges();mixpanel['track']('Server',{'distinct_id':settings[_0x273083(0x273)],'ip':publicip,'version':serverversion,'numbots':_0x345d97[_0x273083(0x2f1)],'numbotsenabled':_0x2212a5,'exchanges':_0x59e30d,'environment':environment});}async function getMessages(){const _0x4e41c5=_0x16b6c7,_0x11fa00=_0x4e41c5(0x32c),_0x1df324=new GraphQLClient(_0x11fa00),_0x53b16f={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x5803c5=serverversion[_0x4e41c5(0x336)]('.'),_0x2159b0=_0x5803c5[0x0]+'.'+_0x5803c5[0x1],_0x22473a=Math[_0x4e41c5(0x353)](settings['lastmsgtelegram'],settings[_0x4e41c5(0x21c)]),_0xb1ccce={'last':parseInt(_0x22473a),'bbm':_0x2159b0},_0x325f7b=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x3011f4;try{_0x3011f4=await _0x1df324['request'](_0x325f7b,_0xb1ccce,_0x53b16f);}catch(_0x2923e2){}if(_0x3011f4&&_0x3011f4[_0x4e41c5(0x380)]){let _0x2be94e=settings['lastmsgtelegram'];newMessages=[];for(const _0x4176d6 of _0x3011f4['messages']){newMessages['push'](_0x4176d6);let _0x100baa=![];_0x4176d6[_0x4e41c5(0x1d6)]&&(updateSetting(_0x4e41c5(0x36b),_0x4176d6[_0x4e41c5(0x1d6)]),_0x100baa=isNewerVersion(serverversion,_0x4176d6[_0x4e41c5(0x1d6)])||serverversion==_0x4176d6[_0x4e41c5(0x1d6)]);if(!_0x100baa&&_0x4176d6[_0x4e41c5(0x243)]>_0x2be94e){if(_0x4176d6[_0x4e41c5(0x296)]===_0x4e41c5(0x192)||serverversion[_0x4e41c5(0x231)](_0x4176d6[_0x4e41c5(0x296)])){let _0x26c009=''+_0x4176d6[_0x4e41c5(0x394)]+'\x0a\x0a'+_0x4176d6[_0x4e41c5(0x227)];const _0x58958e=await sendTelegramMsg(toTelegramMarkdown(_0x26c009),_0x4e41c5(0x32f));if(_0x58958e)_0x2be94e=_0x4176d6[_0x4e41c5(0x243)];}}}updateAvailable=isNewerVersion(settings[_0x4e41c5(0x36b)],serverversion),updateSetting(_0x4e41c5(0x361),_0x2be94e),emitMessages();}}function emitMessages(){const _0x2cdf99=_0x16b6c7,_0x3b1bf8=settings[_0x2cdf99(0x21c)];let _0x5a029c=[];newMessages[_0x2cdf99(0x338)](_0x4d08cb=>{const _0x3bdeaa=_0x2cdf99;_0x4d08cb[_0x3bdeaa(0x243)]>_0x3b1bf8&&_0x5a029c[_0x3bdeaa(0x2ef)](_0x4d08cb);}),_0x5a029c[_0x2cdf99(0x2f1)]>0x0&&getAllClients()['forEach'](_0x410275=>{const _0x4e5059=_0x2cdf99;getSocket(_0x410275['id'])['emit'](_0x4e5059(0x227),_0x5a029c);});}function confirmMessage(_0x5bc397){const _0x288bd2=_0x16b6c7;updateSetting(_0x288bd2(0x21c),Number(_0x5bc397));}function isNewerVersion(_0x17a984,_0x2dadd1){const _0x564e51=_0x16b6c7,_0x21ef83=_0x2dadd1[_0x564e51(0x336)]('.'),_0x5d729d=_0x17a984['split']('.');for(var _0x28170e=0x0;_0x28170e<_0x5d729d[_0x564e51(0x2f1)];_0x28170e++){const _0x5babf2=~~_0x5d729d[_0x28170e],_0x421598=~~_0x21ef83[_0x28170e];if(_0x5babf2>_0x421598)return!![];if(_0x5babf2<_0x421598)return![];}return![];}function toTelegramMarkdown(_0x5d2e3f){const _0x304d2f=_0x16b6c7,_0x29858c=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x200e2f=/\*{2}(.+?)\*{2}/gim;return _0x5d2e3f=_0x5d2e3f[_0x304d2f(0x36c)](_0x29858c,_0x304d2f(0x36d))[_0x304d2f(0x36c)](_0x200e2f,_0x304d2f(0x261)),_0x5d2e3f;}async function validateConfigFile(){const _0x35b532=_0x16b6c7,_0x372041=dbConfig[_0x35b532(0x345)]('bots')['sortBy'](_0x35b532(0x27c))[_0x35b532(0x233)]()||[];if(_0x372041[_0x35b532(0x2f1)]==0x0){let _0x32c4c4=0x0,_0x2be0ac=[];const _0x9ed5ba=/^bot-([0-9]{3})-config.json$/,_0x4d3bab=fs[_0x35b532(0x1ec)](configpath);_0x4d3bab[_0x35b532(0x338)](_0x5c0571=>{const _0x486752=_0x35b532,_0x8c4540=_0x9ed5ba['exec'](_0x5c0571);if(_0x8c4540){const _0x518c4b=_0x8c4540[0x1];let _0x2003a9=getBotAttributes(_0x518c4b);_0x2be0ac['push']({'botID':_0x518c4b,'botname':_0x2003a9[_0x486752(0x1fa)],'status':'disabled','live':_0x486752(0x2a1)}),_0x32c4c4++;}}),_0x32c4c4!=0x0&&(dbConfig[_0x35b532(0x345)](_0x35b532(0x333))[_0x35b532(0x19d)](_0x2be0ac)[_0x35b532(0x371)](),config=_0x2be0ac,restoredConfigFile=_0x32c4c4);}}async function restoreConfigNotify(_0x48b784){const _0x21d5dc=_0x16b6c7;let _0x55d199;if(restoredConfigFile==0x1)_0x55d199=_0x21d5dc(0x292);else _0x55d199=_0x21d5dc(0x2bc);if(_0x48b784)io['to'](_0x21d5dc(0x2d2))[_0x21d5dc(0x1c3)]('notification',_0x55d199);else{logger[_0x21d5dc(0x1e9)](_0x21d5dc(0x312)),logger[_0x21d5dc(0x1e9)](_0x55d199),logger['simple'](_0x21d5dc(0x312)),logger[_0x21d5dc(0x1e9)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x21d5dc(0x26a)]!='orders')await sendTelegram(settings[_0x21d5dc(0x189)],_0x21d5dc(0x28c)+_0x55d199);}}function decryptRSA(_0x5df7b6,_0x46618f){const _0x3bee83=_0x16b6c7,_0x2f073a=forge['pki'][_0x3bee83(0x323)](_0x5df7b6),_0x530b74=_0x2f073a[_0x3bee83(0x1e7)](forge[_0x3bee83(0x2a8)][_0x3bee83(0x197)](_0x46618f),'RSA-OAEP',{'md':forge['md'][_0x3bee83(0x2db)]['create'](),'mgf1':{'md':forge['md'][_0x3bee83(0x2db)][_0x3bee83(0x2a9)]()}});return _0x530b74;}function validateCredentials(_0x229820,_0x102262){const _0x614dcc=_0x16b6c7;if(_0x229820[_0x614dcc(0x1eb)]==settings[_0x614dcc(0x21f)]&&bcrypt[_0x614dcc(0x1f0)](_0x229820[_0x614dcc(0x1f8)],settings['bbPassword'])){if(settings[_0x614dcc(0x318)])return{'allow':![],'reason':_0x614dcc(0x1b0),'token':null};else{const _0x41d033=generateLoginToken(_0x102262);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x41d033};}}else return{'allow':![],'reason':_0x614dcc(0x1da),'token':null};}function refreshToken(_0x2bc7c8){const _0x33f553=generateLoginToken(_0x2bc7c8);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x33f553};}function validateAccess(_0x57f09c,_0x3d8cd7,_0x3f0bf3){const _0x3cbf54=_0x16b6c7,_0x4c61e2=_0x3f0bf3?_0x3f0bf3:devices[_0x3d8cd7]['ip'];let _0x3257db;const _0x3cbffc=_0x35dddd=>{const _0x498cb6=_0x23c8;if(settings[_0x498cb6(0x206)]){if(settings[_0x498cb6(0x318)]){if(telegram2FaApproved(_0x3d8cd7)){const _0x527d86=generateLoginToken(_0x3d8cd7);return{'allow':!![],'reason':_0x498cb6(0x2d7),'token':_0x527d86};}else return{'allow':![],'reason':_0x498cb6(0x331),'token':null};}else return _0x3257db=validToken(_0x35dddd,_0x3d8cd7),_0x3257db['hasOwnProperty'](_0x498cb6(0x2cd))?{'allow':!![],'reason':_0x498cb6(0x23d),'token':_0x35dddd}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x498cb6(0x26e),'token':null};};if(settings['whitelistEnabled']){let _0x1eebcb=[...settings[_0x3cbf54(0x218)],_0x3cbf54(0x2c4),_0x3cbf54(0x186),_0x3cbf54(0x1af)];if(_0x1eebcb[_0x3cbf54(0x387)](_0x4c61e2))return _0x3cbffc(_0x57f09c);else{_0x3257db=validToken(_0x57f09c,_0x3d8cd7);if(_0x3257db[_0x3cbf54(0x18f)](_0x3cbf54(0x2cd)))return _0x3cbffc(_0x57f09c);else{if(telegramIpApproved(_0x3d8cd7)){const _0x5aad48=generateToken(_0x3d8cd7);return _0x3257db=_0x3cbffc(_0x57f09c),_0x3257db[_0x3cbf54(0x17c)]?{'allow':!![],'reason':_0x3cbf54(0x2e5),'token':_0x5aad48}:_0x3257db;}else return settings[_0x3cbf54(0x1f1)]?{'allow':![],'reason':_0x3cbf54(0x315),'token':null}:{'allow':![],'reason':_0x3cbf54(0x20d),'token':null};}}}else return _0x3cbffc(_0x57f09c);}function timelyDecrypt(_0x291904,_0x571e05,_0x2311e9='@'){const _0x47942f=_0x16b6c7;if(_0x291904)try{const _0x246153=decryptRSA(secure['privateKey'],_0x291904),_0x373143=_0x246153[_0x47942f(0x336)](_0x2311e9)[0x0],_0x4eb59a=_0x246153[_0x47942f(0x336)](_0x2311e9)[0x1],_0x370960=new Date()[_0x47942f(0x1bc)]();if(_0x571e05){if(_0x370960-_0x4eb59a<maxSecretAge*0x3e8)return _0x373143;else return![];}else return _0x373143;}catch(_0x59b6ab){return![];}else return![];}const validToken=(_0x1b0c5c,_0x5536c1)=>{const _0x387fd9=_0x16b6c7,_0x3c0f15=devices[_0x5536c1]['ip'];if(!_0x1b0c5c)return{'error':_0x387fd9(0x2b8)};for(let _0x17f73e of blacklist){if(_0x17f73e[_0x387fd9(0x1c0)]==_0x1b0c5c)return{'error':'Token\x20blacklisted'};}let _0x4298a9;try{_0x4298a9=jwt[_0x387fd9(0x31c)](_0x1b0c5c,secure['secret']+_0x5536c1);}catch{return{'error':_0x387fd9(0x210)};}if(!_0x4298a9[_0x387fd9(0x18f)](_0x387fd9(0x1b7))&&!_0x4298a9['hasOwnProperty'](_0x387fd9(0x1eb))||!_0x4298a9[_0x387fd9(0x18f)]('exp'))return{'error':_0x387fd9(0x30f)};if(!_0x4298a9['hasOwnProperty'](_0x387fd9(0x1eb))&&_0x4298a9[_0x387fd9(0x18f)](_0x387fd9(0x1b7))){const {clientip:_0x4ae65e}=_0x4298a9;return _0x3c0f15==_0x4ae65e?{'success':_0x387fd9(0x314)}:{'error':_0x387fd9(0x27d)};}else{if(_0x4298a9[_0x387fd9(0x18f)](_0x387fd9(0x1eb))&&_0x4298a9[_0x387fd9(0x18f)](_0x387fd9(0x1b7))){const {username:_0x46d815,clientip:_0x24fd97}=_0x4298a9;return settings[_0x387fd9(0x21f)]==_0x46d815&&_0x3c0f15==_0x24fd97?{'success':_0x387fd9(0x314)}:{'error':_0x387fd9(0x1d3)};}}},generateLoginToken=_0x40f607=>{const _0x3a45e5=_0x16b6c7;if(_0x40f607){const _0x2d589d=devices[_0x40f607]['ip'];return jwt[_0x3a45e5(0x31a)]({'username':settings[_0x3a45e5(0x21f)],'clientip':_0x2d589d},secure[_0x3a45e5(0x225)]+_0x40f607,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x3dd255=>{const _0x1e1583=_0x16b6c7;if(_0x3dd255){const _0x33c5ec=devices[_0x3dd255]['ip'];return jwt['sign']({'clientip':_0x33c5ec},secure[_0x1e1583(0x225)]+_0x3dd255,{'expiresIn':devices[_0x3dd255][_0x1e1583(0x354)]['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0xefc299=>{const _0x205409=_0x16b6c7;let _0x532c12=![];return devices[_0xefc299][_0x205409(0x354)]&&devices[_0xefc299][_0x205409(0x354)][_0x205409(0x293)]!=_0x205409(0x33e)&&(_0x532c12=devices[_0xefc299][_0x205409(0x354)][_0x205409(0x1b7)]==devices[_0xefc299]['ip']&&new Date()['getTime']()-devices[_0xefc299][_0x205409(0x354)][_0x205409(0x2a3)]<devices[_0xefc299]['telegramIpApproval']['expiry']*0x3c*0x3e8),_0x532c12;},telegram2FaApproved=_0x1fa93d=>{const _0x45cb73=_0x16b6c7;let _0xa55726=![];return devices[_0x1fa93d]['telegram2FaApproval']&&devices[_0x1fa93d][_0x45cb73(0x332)][_0x45cb73(0x293)]!=_0x45cb73(0x33e)&&(_0xa55726=devices[_0x1fa93d][_0x45cb73(0x332)][_0x45cb73(0x1b7)]==devices[_0x1fa93d]['ip']&&new Date()['getTime']()-devices[_0x1fa93d][_0x45cb73(0x332)]['timestamp']<devices[_0x1fa93d][_0x45cb73(0x332)]['expiry']*0x3c*0x3e8),_0xa55726;},normalizeIP=_0x39302b=>{const _0x2201fb=_0x16b6c7;let _0x3257b4=null,_0x432bff=null;if(ipaddr[_0x2201fb(0x33c)](_0x39302b)){const _0x59b9f9=ipaddr['parse'](_0x39302b);_0x59b9f9[_0x2201fb(0x38d)]()===_0x2201fb(0x224)?(_0x59b9f9[_0x2201fb(0x1b1)]()&&(_0x3257b4=_0x59b9f9['toIPv4Address']()[_0x2201fb(0x2f2)]()),_0x432bff=_0x59b9f9['toString']()):(_0x3257b4=_0x59b9f9[_0x2201fb(0x2f2)](),_0x432bff=_0x59b9f9['toIPv4MappedAddress']()['toString']());}return{'show':_0x3257b4?_0x3257b4:_0x432bff,'store':_0x432bff};};function formatDate(_0x2c3acc){const _0x29122b=_0x16b6c7;return _0x2c3acc[_0x29122b(0x2bb)]()+'/'+(_0x2c3acc[_0x29122b(0x31b)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x2c3acc[_0x29122b(0x1ce)]()[_0x29122b(0x2f2)]()['padStart'](0x2,'0')+'\x20'+_0x2c3acc[_0x29122b(0x1d9)]()[_0x29122b(0x2f2)]()[_0x29122b(0x22f)](0x2,'0')+':'+_0x2c3acc[_0x29122b(0x1c9)]()[_0x29122b(0x2f2)]()[_0x29122b(0x22f)](0x2,'0')+':'+_0x2c3acc[_0x29122b(0x29d)]()[_0x29122b(0x2f2)]()['padStart'](0x2,'0');}function sleep(_0x445b0){return new Promise(_0x8c78d6=>setTimeout(_0x8c78d6,_0x445b0));}