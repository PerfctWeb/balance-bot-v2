const _0x367b12=_0x1253;(function(_0x3de98a,_0x21bd1f){const _0x484239=_0x1253,_0x227110=_0x3de98a();while(!![]){try{const _0x5eb435=-parseInt(_0x484239(0x18a))/0x1*(parseInt(_0x484239(0x14c))/0x2)+-parseInt(_0x484239(0x1b8))/0x3*(parseInt(_0x484239(0x219))/0x4)+parseInt(_0x484239(0x93))/0x5*(-parseInt(_0x484239(0x184))/0x6)+-parseInt(_0x484239(0x1b4))/0x7*(parseInt(_0x484239(0xfb))/0x8)+parseInt(_0x484239(0xfd))/0x9*(-parseInt(_0x484239(0x216))/0xa)+-parseInt(_0x484239(0xdc))/0xb*(parseInt(_0x484239(0xc4))/0xc)+parseInt(_0x484239(0x210))/0xd*(parseInt(_0x484239(0x20d))/0xe);if(_0x5eb435===_0x21bd1f)break;else _0x227110['push'](_0x227110['shift']());}catch(_0x2e0eb0){_0x227110['push'](_0x227110['shift']());}}}(_0x1727,0x52e91));const _0x50488e=function(){let _0x9944a2=!![];return function(_0x1a7b99,_0x1b6f50){const _0x4cf93c=_0x9944a2?function(){if(_0x1b6f50){const _0x5b4bf8=_0x1b6f50['apply'](_0x1a7b99,arguments);return _0x1b6f50=null,_0x5b4bf8;}}:function(){};return _0x9944a2=![],_0x4cf93c;};}(),_0x56dcb8=_0x50488e(this,function(){const _0x38fc8b=_0x1253;return _0x56dcb8[_0x38fc8b(0x248)]()['search'](_0x38fc8b(0x1fe))['toString']()[_0x38fc8b(0xf9)](_0x56dcb8)['search'](_0x38fc8b(0x1fe));});_0x56dcb8();'use strict';process[_0x367b12(0x132)]['NTBA_FIX_319']=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x367b12(0x175)),low=require(_0x367b12(0xd8)),FileSync=require(_0x367b12(0x118)),path=require(_0x367b12(0xb8)),crypto=require(_0x367b12(0x7a)),Crypt=require(_0x367b12(0xe9))[_0x367b12(0x104)],RSA=require(_0x367b12(0xe9))[_0x367b12(0xc9)],bcrypt=require(_0x367b12(0x89)),jwt=require('jsonwebtoken'),ipaddr=require('ipaddr.js'),argv=require(_0x367b12(0x241))(process[_0x367b12(0x231)][_0x367b12(0xd2)](0x2))[_0x367b12(0x231)],uuidRandom=require(_0x367b12(0x223)),TelegramBot=require(_0x367b12(0x1f0)),Mixpanel=require('mixpanel'),axios=require(_0x367b12(0x1f5)),{GraphQLClient,gql}=require(_0x367b12(0x13d)),util=require(_0x367b12(0x1e4)),fileUpload=require(_0x367b12(0x88)),{networkInterfaces}=require('os'),PORT=argv['port']||_0x367b12(0xdf),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console['log'](_0x367b12(0x169)+PORT+_0x367b12(0x115)),process['exit'](0x1));const HOST=argv[_0x367b12(0x1c0)]||null,userID=argv[_0x367b12(0x101)]||'',debugging=argv['d']||![],nodeversion=process[_0x367b12(0x112)][_0x367b12(0x17a)];let bbpath=_0x367b12(0x1bb),bbpath2='';const botfile=_0x367b12(0x222),configfile=_0x367b12(0x1e7),settingsfile=_0x367b12(0x1c2),securefile='bb-secure.json',maxBackups=0xa;let validInstallation=!![];!fs[_0x367b12(0x220)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x367b12(0x127)),configpath=userID?bbpath+_0x367b12(0x9c)+userID+'/':bbpath+_0x367b12(0x9c),configbackuppath=configpath+_0x367b12(0x1b6),logspath=userID?bbpath+_0x367b12(0x18d)+userID+'/':bbpath+_0x367b12(0x18d),zippath=userID?bbpath+_0x367b12(0x1ed)+userID+'/':bbpath+_0x367b12(0x1ed),loggerfile=fs[_0x367b12(0x165)](logspath+_0x367b12(0xea),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x367b12(0x20e);!fs[_0x367b12(0x220)](configpath)&&fs[_0x367b12(0x1d5)](configpath);!fs[_0x367b12(0x220)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x367b12(0x220)](logspath)&&fs[_0x367b12(0x1d5)](logspath);!fs[_0x367b12(0x220)](zippath)&&fs[_0x367b12(0x1d5)](zippath);!fs[_0x367b12(0x220)](temppath)&&fs[_0x367b12(0x1d5)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x367b12(0x11e)]({'bots':[]})[_0x367b12(0x227)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x367b12(0x11e)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x367b12(0x86),'onepagemode':![]}})[_0x367b12(0x227)]();function _0x1727(){const _0x30d5c4=['The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','send','keys','download','config/','bbvNew','onText','/help\x20-\x20show\x20available\x20commands\x0a','getMonth','Node.js\x20v','data','bots','sendPortfolioTelegram','binary','placeOrder','telegramEvents','bot',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','timeshift','</b>\x20?','\x20to\x20','assign','restart','backup','output-002.log','File\x20uploaded','/status\x20-\x20show\x20bot(s)\x20status\x0a','disabled','#RES#\x20if\x20running\x20on\x20server','*$1*','clientip','Login\x20rejected','path','telegramUsername','telegramIpApproval','isDirectory','uuid','toggle-bot-mode','family','answerCallbackQuery','Unauthorized\x20attempt\x20to\x20get\x20events','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','replace','bbUsername','2126496aMNzdG','compareSync','Disabled\x20Bot\x20','SIGTERM','lastmsgemitted','RSA','botID','-----------------------------------------------------------------------------------','api-eu.mixpanel.com','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications',':\x20Bot\x20Mgr\x20>\x20','warning','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','emitHistory','slice','Unauthorized\x20attempt\x20to\x20add\x20bot','Your\x20installation\x20is\x20already\x20up\x20to\x20date','alias','inherit','secret','lowdb','stopPolling','listen','format','11YQCGuX','apiSecret','randomFillSync','3000','statSync','decrypt','timestamp','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','find','number','length','name','/:bot/history','hybrid-crypto-js','/output-000.log','Notifications\x20enabled','1000','private','HTML','toIPv4Address','settings.','::1','address','error','#RES#\x0a','Unauthorized\x20attempt\x20to\x20update\x20bot','padStart','2FA','store-configuration','constructor','/enable\x20-\x20enable\x20notifications\x0a','472YkDnFW','sockets','40536BJenYs','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','\x1b[0m','static','user','Invalid\x20username\x20or\x20IP\x20address','version.json','Crypt','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','stopped','orders','update-bot','endsWith','backup-full','sign','yes','\x20|\x20client:\x20...','Notifications\x20disabled','No\x20bots\x20running\x20right\x20now','title','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','versions','conn','Allow\x20login\x20from\x20IP\x20address\x20<b>',',\x20must\x20be\x20a\x204\x20digit\x20number','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','bbvReceive','lowdb/adapters/FileSync','pidExpireLogin','backupfile','params','/off\x20-\x20stop\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20log\x20out','defaults','build','login\x20token\x20generated','Access\x20enabled\x20for\x20','telegramChatId','any','event','/metrics\x20-\x20show\x20bot\x20performance\x0a','5\x20min','clients','<b>Telegram\x20Bot\x20Status:</b>\x0a','/:bot/portfolio','/on\x20-\x20start\x20bot(s)\x0a','getUTCHours','getHours','restore-backup-file','cloneDeep','args','accept','login\x20required','env','Unauthorized\x20login\x20attempt\x20(timeout)','status','randomBytes','***','initclient','set','/:bot/performance','telegrammsg','add','Invalid\x20Telegram\x20token','graphql-request','callback_query','Invalid\x20IP\x20address','show-config','auto','order','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','sendFile','allow','sortBy','kind','confirm-message','Yes','privateKey','Unauthorized\x20attempt\x20to\x20get\x20portfolio','4DKHLmz','Bot\x20Mgr\x20>\x20','/update\x20-\x20update\x20Balance\x20Bot\x0a','index.html','remoteAddress','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','logged\x20out','socket.io','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','blacklist','loginRequired','[ip-address]','telegramToken','reinstall','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','exchange','/names\x20-\x20show\x20bot\x20names\x0a','-config.json','apiKey','DEFLATE','latestversion','telegram','temporary\x20token\x20generated','http','map','createWriteStream','connection','exit','getDate','Error:\x20Invalid\x20argument\x20','manual','Logged\x20in\x20user\x20...','push','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','\x1b[33m','forEach','auth','lastmsgtelegram','127.0.0.1','polling_error','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','date-fns','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','log','match','tkn','node','use','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','init','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','sha256','/:bot','resetHistory','unlinkSync','disconnect','699630BVXwKD','test','backup-full@','$1_$2_$3','No\x20authentication\x20token','backup-files','103527IZSHAs','stringify','stop','logs/','Network\x20Interfaces:','getTime','show','All\x20bots\x20running\x20right\x20now','showConfig','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','User\x20has\x20been\x20validated','connected','Starting\x20new\x20bot\x20|\x20Bot\x20','getMinutes','parse','rmSync','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','new-disabled','output-003.log','/:bot/coins','2FA\x20login\x20rejected','15\x20min','hasOwnProperty','headless','output-001.log','getFullYear','remove','reload','simple','update','verify','function','https://api.ipify.org?format=json','full','files','\x1b[34m','-performance.json','Logged\x20out\x20user\x20...','exec','Notifications\x20disabled\x0a','copyFileSync','express','64743wRAPDv','readFileSync','backup/','\x20only\x0a','38829Esnduz','updatebotmanager','then','bb/','success','\x20mode','404\x20Not\x20Found','RSA-OAEP','host','All','bb-settings.json','Login\x20accepted','logs','split','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Ok,\x20will\x20send\x20alert\x20notifications\x20only','showname','fork','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','-events.json','cancelLoading','node-zip','file','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','botmanager','telegramEnabled','Server','Restore\x20process\x20aborted','All\x20bots','mkdirSync','store-fiat','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','onepagemode','2FA\x20login\x20required','storeConfiguration','telegram2FaApproval','bb-secure.json','mtime','reason','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','store-settings','output-000.log','emit','notification','util','reject','add-bot','bb-config.json','debug','kill','place-order','store-headless','alerts','zip/','SIGINT','secure','node-telegram-bot-api','Starting\x20Balance\x20Bot\x20reinstallation','\x20>\x20','sendMessage','headers','axios','get-portfolio','Ok,\x20will\x20send\x20order\x20notifications\x20only','value','from','store','-results.json','type','storeFiat','(((.+)+)+)+$','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','readdirSync','size','backup-full.zip','botname','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','started','Markdown','login\x20not\x20required','getSeconds','uncaughtException','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','startsWith','Temporary\x20access\x20rejected','112ikmVNy','temp/','invalid\x20credentials','4573699qwsVbO','messages','server','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','pidRefreshToken','expiry','1360ExyJUr','Token\x20blacklisted','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','108lTPhZa','username','join','isValid','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','storeHeadless','temporary\x20access\x20rejected','existsSync','get','bot.js','uuid-random','Invalid\x20authentication\x20token\x20(2)','\x20minutes','=>\x20Go\x20to\x20#BLU#http://localhost:','write','\x20(1)','max','build2','bot-','Unauthorized\x20attempt\x20to\x20download\x20','************','get-starting-balances','access','request','argv','message','token','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Password\x20reset\x20rejected','sort','all','Bot\x20','new','\x20|\x20user:\x20...','removeListener','writeFileSync','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','entries','temporary\x20access\x20not\x20allowed','catch','yargs/yargs','once','live','Starting\x20bot\x20|\x20Bot\x20','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','f2aRequired','reset-history','toString','removeAllListeners','userid','Starting\x20Balance\x20Bot\x20update','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','login','exp','bbPassword','update-bb','2FA\x20login\x20token\x20generated','::ffff:127.0.0.1','chat','\x20(2)','Unauthorized\x20attempt\x20to\x20confirm\x20message','\x20|\x20','filter','crypto','Notifications\x20enabled\x0a','apiPassword','.zip','running','Alerts','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','generate','2FA\x20required','post','settings','enabled','0.0.0','/upload-backup','express-fileupload','bcryptjs','hashSync','publicKey','whitelistEnabled','logout','Restarting\x20Bot\x20','Enabled\x20Bot\x20','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','30\x20min','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','25pEAaAK','mode','track','getPortfolio','ipc'];_0x1727=function(){return _0x30d5c4;};return _0x1727();}const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x367b12(0x227)]();let crypt=new Crypt({'md':_0x367b12(0x17f),'rsaStandard':_0x367b12(0x1bf)});const saltRounds=0xa,mixpanel=Mixpanel[_0x367b12(0x17d)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x367b12(0xcc)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x367b12(0x158)]&&settings[_0x367b12(0x158)]!=''&&settings['telegramUsername']&&settings[_0x367b12(0xb9)]!='')initTelegram();const parseColor=(_0x9749d8,_0x36c67e)=>{const _0x48b7bc=_0x367b12,_0x277e13=/#[A-Z]{3}#/g;!_0x36c67e?_0x9749d8=_0x9749d8[_0x48b7bc(0xc2)](_0x277e13,''):(_0x9749d8=_0x9749d8[_0x48b7bc(0xc2)](/#BLU#/g,_0x48b7bc(0x1ad)),_0x9749d8=_0x9749d8[_0x48b7bc(0xc2)](/#RED#/g,'\x1b[31m'),_0x9749d8=_0x9749d8[_0x48b7bc(0xc2)](/#YEL#/g,_0x48b7bc(0x16e)),_0x9749d8=_0x9749d8['replace'](/#RES#/g,_0x48b7bc(0xff)));;return _0x9749d8;},logger={'screen':_0x52dd88=>{console['log'](parseColor(_0x52dd88,!![]));},'simple':_0x109fd0=>{const _0x5de980=_0x367b12;console[_0x5de980(0x177)](parseColor(_0x109fd0,!![])),loggerfile[_0x5de980(0x227)](util['format'](parseColor(_0x109fd0,![]))+'\x0a');},'full':async _0x3f9364=>{const _0x23793c=_0x367b12,_0x13ca67=getTimeStamp()+_0x23793c(0xce)+_0x3f9364;console['log'](parseColor(_0x13ca67,!![])),loggerfile[_0x23793c(0x227)](util[_0x23793c(0xdb)](parseColor(_0x13ca67,![]))+'\x0a');if(tgBot&&settings[_0x23793c(0x122)]&&settings['telegramEvents']!=_0x23793c(0x107))await tgBot['sendMessage'](settings[_0x23793c(0x122)],_0x23793c(0x14d)+parseColor(_0x3f9364,![]))[_0x23793c(0x240)](_0x1aec71=>{telegramError(_0x1aec71);});},'debug':async(_0x343fe5,_0x100166='')=>{const _0x38b95f=_0x367b12,_0x196c16=getTimeStamp()+_0x38b95f(0xa9)+_0x343fe5;if(debugging)console[_0x38b95f(0x177)](parseColor(_0x196c16,!![]));loggerfile['write'](util[_0x38b95f(0xdb)](parseColor(_0x196c16,![]))+'\x0a');if(_0x100166){if(debugging)console[_0x38b95f(0x177)](_0x100166);loggerfile[_0x38b95f(0x227)](util[_0x38b95f(0xdb)](_0x100166)+'\x0a');}}};process['on'](_0x367b12(0x209),function(_0x22da7c){const _0x64d9a1=_0x367b12;logger[_0x64d9a1(0x1a6)](_0x22da7c);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x367b12(0x103))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x367b12(0x1b3)),app=express(),http=require(_0x367b12(0x163))['createServer'](app);app[_0x367b12(0x17b)](fileUpload({'useTempFiles':!![]})),app[_0x367b12(0x221)]('/download/:type',async(_0x114a70,_0xa504d3)=>{const _0x2f02da=_0x367b12,_0x355033=_0x114a70[_0x2f02da(0x11b)][_0x2f02da(0x1fc)],_0x23d0fe=getClientsWithBotID(_0x2f02da(0x1d0)),_0x33a6a5=_0x114a70[_0x2f02da(0x1f4)]['uuid'],_0x3390bc=timelyDecrypt(_0x33a6a5,![]),_0x580c38=_0x23d0fe[_0x2f02da(0xe4)](_0xb6ec51=>_0xb6ec51[_0x2f02da(0xbc)]==_0x3390bc);if(_0x580c38){const _0x126573=normalizeIP(_0x114a70['socket']['remoteAddress'])[_0x2f02da(0x1fa)],_0x1a4296=_0x114a70['headers'][_0x2f02da(0x179)];if(validateAccess(_0x1a4296,_0x3390bc,_0x126573)[_0x2f02da(0x145)])_0x355033==_0x2f02da(0xaf)&&await backupConfigFiles(),await zipFiles(_0x355033),_0xa504d3[_0x2f02da(0x9b)](zippath+(_0x355033+_0x2f02da(0x7d)),_0x51f367=>{const _0x2902db=_0x2f02da;_0x51f367&&(logger['full']('Failed\x20to\x20download\x20'+_0x355033),logger[_0x2902db(0x1a6)](_0x51f367));});else logger[_0x2f02da(0x1ab)](_0x2f02da(0x22c)+_0x355033+_0x2f02da(0x228));}else logger[_0x2f02da(0x1ab)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x355033+_0x2f02da(0x76));}),app[_0x367b12(0x83)](_0x367b12(0x87),async(_0x3f2729,_0xdf7edb)=>{const _0x2318b6=_0x367b12,_0x21c136=getClientsWithBotID(_0x2318b6(0x1d0)),_0x4345f5=_0x3f2729[_0x2318b6(0x1f4)][_0x2318b6(0xbc)],_0x4967fd=timelyDecrypt(_0x4345f5,![]),_0x5ba5ff=_0x21c136['find'](_0x3897c8=>_0x3897c8['uuid']==_0x4967fd);logger['debug']('Backup\x20file\x20uploaded');if(_0x5ba5ff){const _0x1710a4=normalizeIP(_0x3f2729['socket'][_0x2318b6(0x150)])[_0x2318b6(0x1fa)],_0x58776f=_0x3f2729[_0x2318b6(0x1f4)][_0x2318b6(0x179)];if(validateAccess(_0x58776f,_0x4967fd,_0x1710a4)['allow']){if(_0x3f2729['files']){const _0x4e2ba7=_0x3f2729[_0x2318b6(0x1ac)][_0x2318b6(0x11a)];await _0x4e2ba7['mv'](temppath+_0x4e2ba7[_0x2318b6(0xe7)]),_0xdf7edb[_0x2318b6(0x99)]({'status':!![],'message':_0x2318b6(0xb1)});const _0x7a8c9b=getBotsWithMode();_0x7a8c9b['length']>0x0?confirmRestore(temppath,_0x4e2ba7[_0x2318b6(0xe7)]):unzipFile(temppath,_0x4e2ba7['name']);}}else logger[_0x2318b6(0x1ab)](_0x2318b6(0x176));}else logger[_0x2318b6(0x1ab)](_0x2318b6(0x1ff));}),app[_0x367b12(0x17b)](express[_0x367b12(0x100)](path['join'](__dirname,bbpath2,_0x367b12(0x22a)))),app[_0x367b12(0x17b)](express[_0x367b12(0x100)](path[_0x367b12(0x21b)](__dirname,bbpath2,_0x367b12(0x11f)))),app[_0x367b12(0x221)]('/',function(_0x245692,_0x588763){const _0x2fce64=_0x367b12;_0x588763['sendFile'](path[_0x2fce64(0x21b)](__dirname,bbpath2,_0x2fce64(0x22a),'index.html'));}),app[_0x367b12(0x221)](_0x367b12(0x180),function(_0x22fab2,_0x2f71af){const _0x1b64fc=_0x367b12;_0x2f71af[_0x1b64fc(0x144)](path[_0x1b64fc(0x21b)](__dirname,bbpath2,_0x1b64fc(0x11f),_0x1b64fc(0x14f)));}),app['get'](_0x367b12(0x129),(_0x29bd82,_0x20c015)=>{const _0x57b125=_0x367b12;_0x20c015[_0x57b125(0x144)](path['join'](__dirname,bbpath2,_0x57b125(0x11f),_0x57b125(0x14f)));}),app[_0x367b12(0x221)](_0x367b12(0x139),(_0x19bc3e,_0x2fc7a6)=>{const _0x2dbf74=_0x367b12;_0x2fc7a6['sendFile'](path[_0x2dbf74(0x21b)](__dirname,bbpath2,_0x2dbf74(0x11f),_0x2dbf74(0x14f)));}),app[_0x367b12(0x221)](_0x367b12(0x19d),(_0x596b22,_0x2e330e)=>{const _0x1f075c=_0x367b12;_0x2e330e['sendFile'](path[_0x1f075c(0x21b)](__dirname,bbpath2,_0x1f075c(0x11f),'index.html'));}),app[_0x367b12(0x221)](_0x367b12(0xe8),(_0x1f3bed,_0x6aa5b)=>{const _0xe9a4e8=_0x367b12;_0x6aa5b[_0xe9a4e8(0x144)](path[_0xe9a4e8(0x21b)](__dirname,bbpath2,'build','index.html'));}),app['get']('/:bot/configuration',(_0x542f65,_0x1f9869)=>{const _0x27157d=_0x367b12;_0x1f9869[_0x27157d(0x144)](path['join'](__dirname,bbpath2,_0x27157d(0x11f),'index.html'));}),app['get']('/:bot/support',(_0x4e013d,_0x5a16bf)=>{const _0x3d84b4=_0x367b12;_0x5a16bf['sendFile'](path['join'](__dirname,bbpath2,_0x3d84b4(0x11f),_0x3d84b4(0x14f)));});if(HOST)http[_0x367b12(0xda)](PORT,HOST);else http[_0x367b12(0xda)](PORT);const io=require(_0x367b12(0x153))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1850f9=_0x367b12;let _0x291f48=_0x1850f9(0x157);const _0x34bbd1=networkInterfaces(),_0x2cdd17={};for(const _0xd6d318 of Object[_0x1850f9(0x9a)](_0x34bbd1)){for(const _0xec118b of _0x34bbd1[_0xd6d318]){if((_0xec118b['family']=='IPv4'||_0xec118b[_0x1850f9(0xbe)]==0x4)&&!_0xec118b['internal']){const _0x55800a=ipaddr[_0x1850f9(0x198)](_0xec118b[_0x1850f9(0xf2)])['range']();_0x55800a!=_0x1850f9(0xed)&&(!_0x2cdd17[_0xd6d318]&&(_0x2cdd17[_0xd6d318]=[]),_0x2cdd17[_0xd6d318]['push'](_0xec118b[_0x1850f9(0xf2)]),_0x291f48=_0xec118b['address']);}}}return logger[_0x1850f9(0x1e8)](_0x1850f9(0x18e),_0x2cdd17),_0x291f48;}async function startServer(){const _0xe3fd=_0x367b12;logger['simple'](''),logger[_0xe3fd(0x1a6)](_0xe3fd(0xcb)),await logger['full']('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0xe3fd(0xf4)+(_0xe3fd(0x226)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+('=>\x20Go\x20to\x20#BLU#http://'+getServerIP()+':'+PORT+_0xe3fd(0xb4))),await logger['debug'](_0xe3fd(0xa1)+nodeversion),logger[_0xe3fd(0x1a6)](_0xe3fd(0xcb));if(config[_0xe3fd(0xe6)]!=0x0)for(const _0x34a0f4 of config){if(_0x34a0f4[_0xe3fd(0x134)]==_0xe3fd(0x85)||_0x34a0f4[_0xe3fd(0x134)]=='new')await logger['full'](_0xe3fd(0x244)+_0x34a0f4[_0xe3fd(0xca)]+_0xe3fd(0x78)+_0x34a0f4[_0xe3fd(0x203)]),startBot([_0x34a0f4[_0xe3fd(0xca)],userID],{'cwd':bbpath},function(_0x3a35ee){if(_0x3a35ee)logger['full'](_0x3a35ee);});else(_0x34a0f4['status']==_0xe3fd(0xb3)||_0x34a0f4[_0xe3fd(0x134)]==_0xe3fd(0x19b))&&await logger[_0xe3fd(0x1ab)]('Idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x34a0f4['botID']+_0xe3fd(0x78)+_0x34a0f4['botname']);}else!newBot&&logger[_0xe3fd(0x1a6)](_0xe3fd(0x19a));if(newBot)addBot();logger['simple'](_0xe3fd(0xcb)),logger[_0xe3fd(0x1a6)]('');}function startSocket(){const _0x17c3ab=_0x367b12;io['on'](_0x17c3ab(0x166),_0x32f910=>{const _0x19b827=_0x17c3ab;let _0x34fb2f,_0x39a2d3,_0x548b80,_0x55cb48,_0x186f48;const _0x18a4e2=_0x32f910['handshake'][_0x19b827(0x1f4)]['referer'];_0x39a2d3=_0x18a4e2[_0x19b827(0x178)](/bot[0-9]{3}/);if(_0x39a2d3)_0x548b80=_0x39a2d3[0x0][_0x19b827(0x178)](/[0-9]{3}/);if(_0x548b80)_0x34fb2f=_0x548b80[0x0];else _0x34fb2f=_0x19b827(0x1d0);const _0x1fd807=_0x32f910['handshake'][_0x19b827(0x170)]['encryptedUuid'];if(!_0x1fd807)_0x32f910['emit'](_0x19b827(0x134),{'publicKey':secure[_0x19b827(0x8b)]});else{_0x55cb48=timelyDecrypt(_0x1fd807,![]);if(!_0x55cb48)_0x32f910[_0x19b827(0x1e2)]('status',{'publicKey':secure[_0x19b827(0x8b)]});else{_0x186f48=normalizeIP(_0x32f910[_0x19b827(0x113)][_0x19b827(0x150)])['store'];if(!devices[_0x55cb48])devices[_0x55cb48]={'uuid':_0x55cb48,'access':{'token':null}};devices[_0x55cb48]['ip']=_0x186f48;const _0x3188ea=addClient(_0x32f910['id'],_0x55cb48,_0x34fb2f);setAccess(_0x3188ea),emitMessages(),_0x32f910['on'](_0x19b827(0x6f),_0x229c9f=>{const _0x5257a5=_0x19b827,_0x2feaf5=timelyDecrypt(_0x229c9f['password']);if(_0x2feaf5){_0x229c9f={'username':_0x229c9f[_0x5257a5(0x21a)],'password':_0x2feaf5},devices[_0x55cb48][_0x5257a5(0x22f)]=validateCredentials(_0x229c9f,_0x55cb48);if(devices[_0x55cb48][_0x5257a5(0x22f)][_0x5257a5(0x145)]==![]&&devices[_0x55cb48][_0x5257a5(0x22f)][_0x5257a5(0x1de)]=='2FA\x20login\x20required')_0x32f910[_0x5257a5(0x1e2)](_0x5257a5(0x134),{'access':devices[_0x55cb48][_0x5257a5(0x22f)]}),loginAccess2FA(_0x55cb48,_0x186f48);else{if(devices[_0x55cb48][_0x5257a5(0x22f)]['allow']==![]&&devices[_0x55cb48]['access'][_0x5257a5(0x1de)]==_0x5257a5(0x20f))_0x32f910['emit'](_0x5257a5(0x134),{'access':devices[_0x55cb48]['access']});else devices[_0x55cb48][_0x5257a5(0x22f)]['allow']&&devices[_0x55cb48]['access'][_0x5257a5(0x1de)]==_0x5257a5(0x120)&&(getClientsWithUuid(_0x55cb48)['forEach'](_0x114a39=>{setAccess(_0x114a39);}),logger[_0x5257a5(0x1e8)](_0x5257a5(0x16b)+_0x55cb48[_0x5257a5(0xd2)](-0x8)),setTokenRefresh(_0x55cb48),setSessionTimeout(_0x5257a5(0x6f),_0x55cb48));}}else logger[_0x5257a5(0x1ab)](_0x5257a5(0x133));}),_0x32f910['on']('reset-password',()=>{resetPassword();}),_0x32f910['on'](_0x19b827(0x183),_0x260c28=>{removeClient(_0x32f910['id']);}),_0x34fb2f==_0x19b827(0x1d0)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x141d5b){const _0x285fcf=_0x367b12;if(_0x141d5b!=_0x285fcf(0x1d0)&&config[_0x285fcf(0x15e)]!=''){if(pid[_0x141d5b])pid[_0x141d5b][_0x285fcf(0x99)]({'function':_0x285fcf(0x137),'args':null});}_0x141d5b!=_0x285fcf(0x1d0)&&broadcastToBots(_0x285fcf(0xa3),JSON[_0x285fcf(0x18b)](config));}function reloadBotManager(){const _0x334249=_0x367b12;getClientsWithBotID(_0x334249(0x1d0))['forEach'](_0x21ab59=>{const _0x4bf195=_0x334249;getSocket(_0x21ab59['id'])[_0x4bf195(0x1e2)]('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x2f61f8){const _0x9c251c=_0x367b12;return io[_0x9c251c(0xfc)]['sockets'][_0x9c251c(0x221)](_0x2f61f8);}function setAccess(_0x37b917){const _0x3cef9a=_0x367b12,_0x3c1161=getSocket(_0x37b917['id']),_0x17ac3c=_0x37b917[_0x3cef9a(0xbc)],_0x2d84b0=_0x37b917[_0x3cef9a(0xa8)];devices[_0x17ac3c][_0x3cef9a(0x22f)]=validateAccess(devices[_0x17ac3c][_0x3cef9a(0x22f)][_0x3cef9a(0x233)],_0x17ac3c),logger[_0x3cef9a(0x1e8)]('Setting\x20access:\x20'+devices[_0x17ac3c][_0x3cef9a(0x22f)][_0x3cef9a(0x1de)]+_0x3cef9a(0x10d)+_0x37b917['id'][_0x3cef9a(0xd2)](-0x8)+_0x3cef9a(0x23a)+_0x17ac3c[_0x3cef9a(0xd2)](-0x8)),_0x3c1161[_0x3cef9a(0x21b)](_0x17ac3c);if(devices[_0x17ac3c]['access'][_0x3cef9a(0x145)]){_0x3c1161['join'](_0x2d84b0);if(_0x2d84b0==_0x3cef9a(0x1d0))initializeSocketBotManager(_0x3c1161);else initializeSocketBot(_0x3c1161);initClient(_0x2d84b0);}devices[_0x17ac3c][_0x3cef9a(0x22f)][_0x3cef9a(0x233)]&&devices[_0x17ac3c][_0x3cef9a(0x22f)][_0x3cef9a(0x1de)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x3cef9a(0xf7),_0x17ac3c),devices[_0x17ac3c][_0x3cef9a(0x22f)][_0x3cef9a(0x233)]&&devices[_0x17ac3c]['access'][_0x3cef9a(0x1de)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout('login',_0x17ac3c),_0x3c1161[_0x3cef9a(0x1e2)](_0x3cef9a(0x134),{'status':_0x37b917[_0x3cef9a(0x212)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x17ac3c][_0x3cef9a(0x22f)],'externalip':devices[_0x17ac3c]['ip'],'publicKey':secure[_0x3cef9a(0x8b)],'userid':settings[_0x3cef9a(0x6c)],'validInstallation':validInstallation}),devices[_0x17ac3c][_0x3cef9a(0x22f)][_0x3cef9a(0x145)]==![]&&devices[_0x17ac3c][_0x3cef9a(0x22f)][_0x3cef9a(0x1de)]==_0x3cef9a(0x82)&&temporaryAccess2FA(_0x17ac3c,devices[_0x17ac3c]['ip']);}function setSessionTimeout(_0x1f24c0,_0x5a4e85){const _0x50d2dc=_0x367b12;let _0x47a217;if(_0x1f24c0=='login')_0x47a217=loginExpiry*0x3c*0x3e8;else _0x47a217=devices[_0x5a4e85]['telegramIpApproval'][_0x50d2dc(0x215)]*0x3c*0x3e8-(new Date()[_0x50d2dc(0x18f)]()-devices[_0x5a4e85][_0x50d2dc(0xba)][_0x50d2dc(0xe2)]);if(devices[_0x5a4e85]['pidExpireLogin'])clearTimeout(devices[_0x5a4e85][_0x50d2dc(0x119)]);devices[_0x5a4e85][_0x50d2dc(0x119)]=setTimeout(()=>{const _0x1699ec=_0x50d2dc;if(devices[_0x5a4e85][_0x1699ec(0x214)])clearTimeout(devices[_0x5a4e85][_0x1699ec(0x214)]);removeSocketListeners(_0x5a4e85),addBlacklist(_0x5a4e85),devices[_0x5a4e85][_0x1699ec(0xba)]=null,devices[_0x5a4e85][_0x1699ec(0x1db)]=null,devices[_0x5a4e85][_0x1699ec(0x22f)][_0x1699ec(0x233)]=null,logger['debug']('Session\x20expired\x20for\x20user\x20...'+_0x5a4e85['slice'](-0x8)),devices[_0x5a4e85]['access']=validateAccess(devices[_0x5a4e85]['access'][_0x1699ec(0x233)],_0x5a4e85),!(devices[_0x5a4e85][_0x1699ec(0x22f)][_0x1699ec(0x145)]&&devices[_0x5a4e85][_0x1699ec(0x22f)]['reason']==_0x1699ec(0x207))&&(_0x1f24c0==_0x1699ec(0x6f)?io['to'](_0x5a4e85)['emit']('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x5a4e85)['emit'](_0x1699ec(0x134),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x5a4e85][_0x1699ec(0x22f)][_0x1699ec(0x233)]=null;},_0x47a217);}function setTokenRefresh(_0x483bd3){const _0x7811ab=_0x367b12;if(devices[_0x483bd3][_0x7811ab(0x214)])clearTimeout(devices[_0x483bd3][_0x7811ab(0x214)]);devices[_0x483bd3][_0x7811ab(0x214)]=setTimeout(()=>{const _0x2ebacc=_0x7811ab;getClientsWithUuid(_0x483bd3)[_0x2ebacc(0xe6)]!=0x0?(devices[_0x483bd3][_0x2ebacc(0x22f)]=refreshToken(_0x483bd3),io['to'](_0x483bd3)['emit'](_0x2ebacc(0x134),{'status':_0x2ebacc(0x195),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x483bd3][_0x2ebacc(0x22f)],'externalip':devices[_0x483bd3]['ip'],'publicKey':secure[_0x2ebacc(0x8b)],'validInstallation':validInstallation}),setTokenRefresh(_0x483bd3)):clearTimeout(devices[_0x483bd3]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x49ae21){const _0x32184e=_0x367b12,_0x302922=getClient(_0x49ae21['id'])[_0x32184e(0xbc)];_0x49ae21[_0x32184e(0x1e2)](_0x32184e(0xa3),config),_0x49ae21[_0x32184e(0x1e2)](_0x32184e(0x84),cleanSettings()),_0x49ae21['on'](_0x32184e(0x1e6),_0x123da6=>{const _0x39fefa=_0x32184e;if(validateAccess(_0x123da6,_0x302922)[_0x39fefa(0x145)])addBot();else logger[_0x39fefa(0x1ab)](_0x39fefa(0xd3));}),_0x49ae21['on'](_0x32184e(0x108),(_0x3375e7,_0x1418e1)=>{const _0x4835a7=_0x32184e;if(validateAccess(_0x1418e1,_0x302922)[_0x4835a7(0x145)])toggleBot(_0x3375e7[_0x4835a7(0xca)],_0x3375e7[_0x4835a7(0x134)],_0x3375e7[_0x4835a7(0x243)]);else logger[_0x4835a7(0x1ab)](_0x4835a7(0xf5));}),_0x49ae21['on'](_0x32184e(0xbd),(_0x4c6eda,_0x3e10fc)=>{const _0x3a1c9d=_0x32184e;if(validateAccess(_0x3e10fc,_0x302922)['allow'])toggleBotMode(_0x4c6eda);else logger['full'](_0x3a1c9d(0xf5));}),_0x49ae21['on']('delete-bot',(_0x2c75f9,_0x11133c)=>{const _0x1aea73=_0x32184e;if(validateAccess(_0x11133c,_0x302922)[_0x1aea73(0x145)])deleteBot(_0x2c75f9);else logger[_0x1aea73(0x1ab)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x49ae21['on'](_0x32184e(0x1e0),(_0x28d7f4,_0x2c5ce9)=>{const _0x228a0e=_0x32184e;if(validateAccess(_0x2c5ce9,_0x302922)[_0x228a0e(0x145)])storeSettings(_0x28d7f4,!![]);else logger[_0x228a0e(0x1ab)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x49ae21['on'](_0x32184e(0x72),_0x4619d9=>{const _0x45bc77=_0x32184e;if(validateAccess(_0x4619d9,_0x302922)[_0x45bc77(0x145)])updateBB('update');else logger[_0x45bc77(0x1ab)](_0x45bc77(0xe3));}),_0x49ae21['on']('reinstall-bb',_0x15c75a=>{const _0x97051d=_0x32184e;if(validateAccess(_0x15c75a,_0x302922)[_0x97051d(0x145)])updateBB(_0x97051d(0x159));else logger[_0x97051d(0x1ab)](_0x97051d(0x213));}),_0x49ae21['on']('get-backup-files',_0xbb6c34=>{const _0x46d648=_0x32184e;if(validateAccess(_0xbb6c34,_0x302922)[_0x46d648(0x145)]){const _0x4340df=getClient(_0x49ae21['id']);if(_0x4340df)getBackupFiles(_0x4340df[_0x46d648(0xbc)]);else logger[_0x46d648(0x1ab)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x46d648(0x1ab)](_0x46d648(0xfe));}),_0x49ae21['on'](_0x32184e(0x12d),(_0x300b17,_0x3f2ce7)=>{const _0x5b6701=_0x32184e;if(validateAccess(_0x3f2ce7,_0x302922)[_0x5b6701(0x145)])restoreBackupFile(_0x300b17);else logger[_0x5b6701(0x1ab)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x49ae21['on']('get-messages',_0x48a825=>{const _0x487a8f=_0x32184e;if(validateAccess(_0x48a825,_0x302922)[_0x487a8f(0x145)])getMessages();else logger[_0x487a8f(0x1ab)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x49ae21['on'](_0x32184e(0x148),(_0x5736e6,_0x37ffe9)=>{const _0x32962e=_0x32184e;if(validateAccess(_0x37ffe9,_0x302922)[_0x32962e(0x145)])confirmMessage(_0x5736e6);else logger['full'](_0x32962e(0x77));}),_0x49ae21['on'](_0x32184e(0x8d),_0x9499dd=>{const _0x3baff3=_0x32184e;if(validateAccess(_0x9499dd,_0x302922)[_0x3baff3(0x145)]){if(devices[_0x302922][_0x3baff3(0x214)])clearTimeout(devices[_0x302922][_0x3baff3(0x214)]);if(devices[_0x302922]['pidExpireLogin'])clearTimeout(devices[_0x302922][_0x3baff3(0x119)]);removeSocketListeners(getClient(_0x49ae21['id'])[_0x3baff3(0xbc)]),addBlacklist(_0x302922),devices[_0x302922][_0x3baff3(0xba)]=null,devices[_0x302922][_0x3baff3(0x1db)]=null,devices[_0x302922][_0x3baff3(0x22f)][_0x3baff3(0x233)]=null,logger[_0x3baff3(0x1e8)](_0x3baff3(0x1af)+_0x302922[_0x3baff3(0xd2)](-0x8)),io['to'](getClient(_0x49ae21['id'])[_0x3baff3(0xbc)])[_0x3baff3(0x1e2)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x3baff3(0x1ab)](_0x3baff3(0x11d));});}function initializeSocketBot(_0x3902ed){const _0x40e07c=_0x367b12,_0x3a4740=getClient(_0x3902ed['id'])[_0x40e07c(0xa8)],_0x183f17=getClient(_0x3902ed['id'])['uuid'];_0x3902ed['on']('get-logs',(_0x39f0fe,_0x47e25b)=>{const _0x5a68b9=_0x40e07c;if(validateAccess(_0x47e25b,_0x183f17)[_0x5a68b9(0x145)]){if(pid[_0x3a4740])pid[_0x3a4740]['send']({'function':_0x5a68b9(0xd1),'args':_0x39f0fe});}else logger['full'](_0x5a68b9(0xc0));}),_0x3902ed['on']('delete-alerts',(_0x4e0b8d,_0x217206)=>{const _0x1886d9=_0x40e07c;if(validateAccess(_0x217206,_0x183f17)[_0x1886d9(0x145)]){if(pid[_0x3a4740])pid[_0x3a4740][_0x1886d9(0x99)]({'function':'deleteHistoryAlerts','args':_0x4e0b8d});}else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x3902ed['on'](_0x40e07c(0x1f6),(_0x11aa0f,_0x50fda2)=>{const _0x35e662=_0x40e07c;if(validateAccess(_0x50fda2,_0x183f17)['allow']){if(pid[_0x3a4740])pid[_0x3a4740][_0x35e662(0x99)]({'function':_0x35e662(0x96),'args':_0x11aa0f});}else logger['full'](_0x35e662(0x14b));}),_0x3902ed['on'](_0x40e07c(0xf8),(_0x2aebad,_0x329ec5)=>{const _0x43dc0f=_0x40e07c;if(validateAccess(_0x329ec5,_0x183f17)[_0x43dc0f(0x145)]){if(pid[_0x3a4740])pid[_0x3a4740]['send']({'function':_0x43dc0f(0x1da),'args':_0x2aebad});}else logger[_0x43dc0f(0x1ab)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x3902ed['on'](_0x40e07c(0x1eb),(_0x2da923,_0x52f5be)=>{const _0x4a9e5f=_0x40e07c;if(validateAccess(_0x52f5be,_0x183f17)[_0x4a9e5f(0x145)]){if(pid[_0x3a4740])pid[_0x3a4740][_0x4a9e5f(0x99)]({'function':_0x4a9e5f(0x21e),'args':_0x2da923});}else logger[_0x4a9e5f(0x1ab)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x3902ed['on'](_0x40e07c(0x1d6),(_0x37db6a,_0x481445)=>{const _0x52a886=_0x40e07c;if(validateAccess(_0x481445,_0x183f17)['allow']){if(pid[_0x3a4740])pid[_0x3a4740][_0x52a886(0x99)]({'function':_0x52a886(0x1fd),'args':_0x37db6a});}else logger[_0x52a886(0x1ab)](_0x52a886(0x116));}),_0x3902ed['on'](_0x40e07c(0x247),_0xcca5c0=>{const _0x10ddb6=_0x40e07c;if(validateAccess(_0xcca5c0,_0x183f17)[_0x10ddb6(0x145)]){if(pid[_0x3a4740])pid[_0x3a4740][_0x10ddb6(0x99)]({'function':_0x10ddb6(0x181),'args':null});}else logger[_0x10ddb6(0x1ab)](_0x10ddb6(0xd0));}),_0x3902ed['on'](_0x40e07c(0x22e),_0x1ed437=>{const _0x414730=_0x40e07c;if(validateAccess(_0x1ed437,_0x183f17)[_0x414730(0x145)]){if(pid[_0x3a4740])pid[_0x3a4740]['send']({'function':'getStartingBalances','args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x3902ed['on'](_0x40e07c(0x1ea),(_0x1f853d,_0xa7b78d)=>{const _0x578ba7=_0x40e07c;if(validateAccess(_0xa7b78d,_0x183f17)[_0x578ba7(0x145)]){if(pid[_0x3a4740])pid[_0x3a4740][_0x578ba7(0x99)]({'function':_0x578ba7(0xa6),'args':_0x1f853d});}else logger[_0x578ba7(0x1ab)](_0x578ba7(0x6e));}),_0x3902ed['on']('cancel-loading',_0x2542a4=>{const _0x2b301d=_0x40e07c;if(validateAccess(_0x2542a4,_0x183f17)[_0x2b301d(0x145)]){if(pid[_0x3a4740])pid[_0x3a4740]['send']({'function':_0x2b301d(0x1cc),'args':null});}else logger[_0x2b301d(0x1ab)](_0x2b301d(0x111));}),_0x3902ed['on'](_0x40e07c(0x140),_0x49b4f1=>{const _0x26c84d=_0x40e07c;if(validateAccess(_0x49b4f1,_0x183f17)['allow']){if(pid[_0x3a4740])pid[_0x3a4740]['send']({'function':_0x26c84d(0x192),'args':null});}else logger[_0x26c84d(0x1ab)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x3902ed['on'](_0x40e07c(0x72),_0x2cb134=>{const _0x7c008f=_0x40e07c;if(validateAccess(_0x2cb134,_0x183f17)['allow'])updateBB(_0x7c008f(0x1a7));else logger[_0x7c008f(0x1ab)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x3902ed['on']('get-messages',_0x2b79eb=>{const _0xcda5ed=_0x40e07c;if(validateAccess(_0x2b79eb,_0x183f17)[_0xcda5ed(0x145)])getMessages();else logger[_0xcda5ed(0x1ab)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x3902ed['on'](_0x40e07c(0x148),(_0x2b69a8,_0x39bbb9)=>{const _0x6d4084=_0x40e07c;if(validateAccess(_0x39bbb9,_0x183f17)[_0x6d4084(0x145)])confirmMessage(_0x2b69a8);else logger[_0x6d4084(0x1ab)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x3902ed['on'](_0x40e07c(0x8d),_0x50b8cf=>{const _0x339cb4=_0x40e07c;if(validateAccess(_0x50b8cf,_0x183f17)[_0x339cb4(0x145)]){if(devices[_0x183f17]['pidRefreshToken'])clearTimeout(devices[_0x183f17][_0x339cb4(0x214)]);if(devices[_0x183f17][_0x339cb4(0x119)])clearTimeout(devices[_0x183f17][_0x339cb4(0x119)]);removeSocketListeners(getClient(_0x3902ed['id'])[_0x339cb4(0xbc)]),addBlacklist(_0x183f17),devices[_0x183f17][_0x339cb4(0xba)]=null,devices[_0x183f17][_0x339cb4(0x1db)]=null,devices[_0x183f17][_0x339cb4(0x22f)][_0x339cb4(0x233)]=null,logger[_0x339cb4(0x1e8)](_0x339cb4(0x1af)+_0x183f17['slice'](-0x8)),io['to'](getClient(_0x3902ed['id'])[_0x339cb4(0xbc)])['emit'](_0x339cb4(0x134),{'access':{'allow':![],'reason':_0x339cb4(0x152),'token':null}});}else logger[_0x339cb4(0x1ab)](_0x339cb4(0x11d));});}function removeSocketListeners(_0x442869){const _0xff34f5=_0x367b12;getClientsWithUuid(_0x442869)[_0xff34f5(0x16f)](_0x18c004=>{const _0x5088a7=_0xff34f5;getSocket(_0x18c004['id'])[_0x5088a7(0x249)]();});}function cleanSettings(){const _0x406cdb=_0x367b12;let _0x246d47=settings;return settings['telegramToken']&&settings['telegramToken']!=''&&(_0x246d47={..._0x246d47,'telegramToken':_0x406cdb(0x22d)}),settings['bbPassword']&&settings[_0x406cdb(0x71)]!=''&&(_0x246d47={..._0x246d47,'bbPassword':'************'}),(settings[_0x406cdb(0x71)]&&settings[_0x406cdb(0x71)]==_0x406cdb(0x136)||settings[_0x406cdb(0x158)]&&settings[_0x406cdb(0x158)]==_0x406cdb(0x136))&&(_0x246d47={..._0x246d47,'restored':{'password':settings[_0x406cdb(0x71)]==_0x406cdb(0x136),'telegram':settings[_0x406cdb(0x158)]==_0x406cdb(0x136)}}),_0x246d47;}async function updateBB(_0x864c11){const _0x16756d=_0x367b12;await backupConfigFiles(),installingUpdate=!![],config[_0x16756d(0x16f)](_0x2991df=>{const _0x1d2059=_0x16756d;restartBot(_0x2991df[_0x1d2059(0xca)]);}),logger[_0x16756d(0x1e8)]('Starting\x20Balance\x20Bot\x20'+_0x864c11);if(_0x864c11==_0x16756d(0x1a7))process[_0x16756d(0x99)]({'update':!![]},_0x181103=>{});else _0x864c11==_0x16756d(0x159)&&process[_0x16756d(0x99)]({'reinstall':!![]},_0x180b83=>{});}function startBot(_0x3eff05,_0x16e583,_0x5d50ea){const _0x16cc6f=_0x367b12;if(debugging)_0x3eff05['push']('-d');let _0x7524e1=![];const _0x1845b5=_0x3eff05[0x0];_0x16e583={..._0x16e583,'stdio':[_0x16cc6f(0xd6),_0x16cc6f(0xd6),_0x16cc6f(0xd6),_0x16cc6f(0x97)]},pid[_0x1845b5]=childProcess[_0x16cc6f(0x1c9)](botfile,_0x3eff05,_0x16e583),pid[_0x1845b5]['on'](_0x16cc6f(0x232),_0x35f4a5=>{const _0x48ea11=_0x16cc6f;switch(Object['keys'](_0x35f4a5)[0x0]){case _0x48ea11(0x203):updateBotName(_0x1845b5,_0x35f4a5[_0x48ea11(0x203)]);break;case _0x48ea11(0x1b9):updateBotManager();break;case _0x48ea11(0x134):updateStatus(_0x1845b5,_0x35f4a5[_0x48ea11(0x134)]);break;case _0x48ea11(0x243):updateLive(_0x1845b5,_0x35f4a5[_0x48ea11(0x243)]);break;case'started':updateLive(_0x1845b5,_0x35f4a5[_0x48ea11(0x205)]),io['to'](_0x1845b5)['emit'](_0x48ea11(0x134),{'access':{'allow':![],'reason':_0x48ea11(0x1a5),'token':null}});break;case _0x48ea11(0x18c):_0x35f4a5[_0x48ea11(0x18c)]==_0x48ea11(0xae)&&restartBot(_0x1845b5);_0x35f4a5[_0x48ea11(0x18c)]==_0x48ea11(0x1e9)&&toggleBot(_0x1845b5,'disabled',_0x48ea11(0x106));break;case _0x48ea11(0x161):sendTelegram(_0x1845b5,_0x35f4a5[_0x48ea11(0x161)]);break;case _0x48ea11(0x13a):sendTelegramMsg(_0x35f4a5[_0x48ea11(0x13a)]);break;case _0x48ea11(0x1a9):io['to'](_0x1845b5)[_0x48ea11(0x1e2)](_0x35f4a5['function'],_0x35f4a5[_0x48ea11(0x12f)]);break;}}),pid[_0x1845b5]['on']('error',function(_0x7727ef){if(_0x7524e1)return;_0x7524e1=!![],_0x5d50ea(_0x7727ef);}),pid[_0x1845b5]['on']('exit',async function(_0x2e657a){const _0x3b5a99=_0x16cc6f;if(installingUpdate)return;if(_0x7524e1)return;_0x7524e1=!![],_0x5d50ea(null);const _0x48aa40=dbConfig[_0x3b5a99(0x221)]('bots')[_0x3b5a99(0xe4)]({'botID':_0x1845b5})[_0x3b5a99(0x1f8)]();_0x48aa40&&(_0x48aa40[_0x3b5a99(0x134)]==_0x3b5a99(0x85)||_0x48aa40[_0x3b5a99(0x134)]==_0x3b5a99(0x239))&&(await sleep(0x3e8),updateLive(_0x1845b5,_0x3b5a99(0x106)),logger[_0x3b5a99(0x1ab)](_0x3b5a99(0x8e)+_0x1845b5),startBot([_0x1845b5,userID],{'cwd':bbpath},function(_0x2a4aa1){if(_0x2a4aa1)logger['full'](_0x2a4aa1);}));});}function stopBot(_0x22609f){const _0x40a20b=_0x367b12;getClientsWithBotID(_0x22609f)[_0x40a20b(0x16f)](_0x402e68=>{const _0x1513ed=_0x40a20b;getSocket(_0x402e68['id'])[_0x1513ed(0x183)](!![]),removeClient(_0x402e68['id']);}),pid[_0x22609f]&&(pid[_0x22609f][_0x40a20b(0x1e9)](),pid[_0x22609f]=null);}function restartBot(_0x370430){if(pid[_0x370430])pid[_0x370430]['kill']();}function addBot(){const _0x4dfd54=_0x367b12;let _0x2496f8;for(let _0x3dd37b=0x1;_0x3dd37b<0x3e9;_0x3dd37b++){_0x2496f8=_0x3dd37b[_0x4dfd54(0x248)]()[_0x4dfd54(0xf6)](0x3,'0');let _0x3eaa5a=config[_0x4dfd54(0xe4)](_0x401352=>_0x401352[_0x4dfd54(0xca)]==_0x2496f8);if(!_0x3eaa5a)break;}if(_0x2496f8===_0x4dfd54(0xec)){logger[_0x4dfd54(0x1ab)](_0x4dfd54(0x98));return;}logger['full'](_0x4dfd54(0x196)+_0x2496f8),dbConfig[_0x4dfd54(0x221)](_0x4dfd54(0xa3))['push']({'botID':_0x2496f8,'botname':_0x4dfd54(0x238)+_0x2496f8,'status':_0x4dfd54(0x239),'live':''})[_0x4dfd54(0x227)](),startBot([_0x2496f8,userID],{'cwd':bbpath},function(_0xb4ffd6){const _0xb05f3d=_0x4dfd54;if(_0xb4ffd6)logger[_0xb05f3d(0x1ab)](_0xb4ffd6);}),config=getConfiguration(),io['to'](_0x4dfd54(0x1d0))[_0x4dfd54(0x1e2)](_0x4dfd54(0xa3),config),broadcastToBots(_0x4dfd54(0xa3),JSON[_0x4dfd54(0x18b)](config));}function deleteBot(_0x376825){const _0x3274af=_0x367b12;getClientsWithBotID(_0x376825)[_0x3274af(0x16f)](_0x337dcf=>{const _0x2e7e9a=_0x3274af;getSocket(_0x337dcf['id'])[_0x2e7e9a(0x183)](!![]),removeClient(_0x337dcf['id']);}),dbConfig[_0x3274af(0x221)]('bots')[_0x3274af(0x1a4)]({'botID':_0x376825})[_0x3274af(0x227)](),logger['full']('Deleted\x20Bot\x20'+_0x376825),stopBot(_0x376825);try{if(fs[_0x3274af(0x220)](path[_0x3274af(0x21b)](configpath,_0x3274af(0x22b)+_0x376825+'-config.json')))fs[_0x3274af(0x182)](path[_0x3274af(0x21b)](configpath,'bot-'+_0x376825+_0x3274af(0x15d)));if(fs[_0x3274af(0x220)](path[_0x3274af(0x21b)](configpath,_0x3274af(0x22b)+_0x376825+_0x3274af(0x1cb))))fs['unlinkSync'](path[_0x3274af(0x21b)](configpath,_0x3274af(0x22b)+_0x376825+_0x3274af(0x1cb)));if(fs[_0x3274af(0x220)](path['join'](configpath,'bot-'+_0x376825+_0x3274af(0x1ae))))fs[_0x3274af(0x182)](path[_0x3274af(0x21b)](configpath,'bot-'+_0x376825+_0x3274af(0x1ae)));if(fs[_0x3274af(0x220)](path['join'](configpath,'bot-'+_0x376825+'-results.json')))fs[_0x3274af(0x182)](path[_0x3274af(0x21b)](configpath,_0x3274af(0x22b)+_0x376825+_0x3274af(0x1fb)));}catch(_0x59f107){if(_0x59f107)logger['full']('Error\x20while\x20deleting\x20config\x20files:\x20',_0x59f107);}config=getConfiguration(),io['to'](_0x3274af(0x1d0))[_0x3274af(0x1e2)]('bots',config),broadcastToBots('bots',JSON[_0x3274af(0x18b)](config));}function toggleBot(_0x532ca9,_0x5bc77b,_0x46212e){const _0x3c6fd2=_0x367b12;dbConfig[_0x3c6fd2(0x221)](_0x3c6fd2(0xa3))[_0x3c6fd2(0xe4)]({'botID':_0x532ca9})['assign']({'status':_0x5bc77b})['assign']({'live':_0x46212e})['write']();if(_0x5bc77b=='enabled'||_0x5bc77b==_0x3c6fd2(0x239))logger[_0x3c6fd2(0x1ab)](_0x3c6fd2(0x8f)+_0x532ca9),startBot([_0x532ca9,userID],{'cwd':bbpath},function(_0x48ac01){const _0x55cb9f=_0x3c6fd2;if(_0x48ac01)logger[_0x55cb9f(0x1ab)](_0x48ac01);});else(_0x5bc77b==_0x3c6fd2(0xb3)||_0x5bc77b==_0x3c6fd2(0x19b))&&(logger[_0x3c6fd2(0x1ab)](_0x3c6fd2(0xc6)+_0x532ca9),stopBot(_0x532ca9));config=getConfiguration(),io['to'](_0x3c6fd2(0x1d0))[_0x3c6fd2(0x1e2)](_0x3c6fd2(0xa3),config),broadcastToBots('bots',JSON[_0x3c6fd2(0x18b)](config));}function toggleStatus(_0x245293){const _0x53796a=_0x367b12;let _0x355303=dbConfig[_0x53796a(0x221)]('bots')[_0x53796a(0xe4)]({'botID':_0x245293})['value'](),_0x4218f7;if(_0x355303['status']===_0x53796a(0x85))_0x4218f7=_0x53796a(0xb3);else{if(_0x355303[_0x53796a(0x134)]==='new')_0x4218f7=_0x53796a(0x19b);else{if(_0x355303[_0x53796a(0x134)]===_0x53796a(0x19b))_0x4218f7='new';else{if(_0x355303[_0x53796a(0x134)]===_0x53796a(0xb3))_0x4218f7='enabled';}}}return _0x4218f7;}function updateStatus(_0x1927dc,_0x3b43ca){const _0xb9eb39=_0x367b12;dbConfig[_0xb9eb39(0x221)](_0xb9eb39(0xa3))[_0xb9eb39(0xe4)]({'botID':_0x1927dc})[_0xb9eb39(0xad)]({'status':_0x3b43ca})[_0xb9eb39(0x227)](),config=getConfiguration(),io['to'](_0xb9eb39(0x1d0))[_0xb9eb39(0x1e2)]('bots',config),broadcastToBots(_0xb9eb39(0xa3),JSON['stringify'](config));}function updateLive(_0xc12f23,_0x1551b4){const _0xcff9a3=_0x367b12;dbConfig[_0xcff9a3(0x221)](_0xcff9a3(0xa3))[_0xcff9a3(0xe4)]({'botID':_0xc12f23})['assign']({'live':_0x1551b4})[_0xcff9a3(0x227)](),config=getConfiguration(),io['to'](_0xcff9a3(0x1d0))[_0xcff9a3(0x1e2)]('bots',config),broadcastToBots('bots',JSON[_0xcff9a3(0x18b)](config));}function updateBotName(_0x4f4825,_0x23b616){const _0x28b551=_0x367b12;dbConfig[_0x28b551(0x221)]('bots')['find']({'botID':_0x4f4825})['assign']({'botname':_0x23b616})[_0x28b551(0x227)](),config=getConfiguration(),io['to'](_0x28b551(0x1d0))[_0x28b551(0x1e2)]('bots',config),broadcastToBots(_0x28b551(0xa3),JSON[_0x28b551(0x18b)](config));}function updateBotManager(){const _0x41e48=_0x367b12;config=getConfiguration(),io['to'](_0x41e48(0x1d0))['emit'](_0x41e48(0xa3),config),broadcastToBots(_0x41e48(0xa3),JSON[_0x41e48(0x18b)](config));}function toggleBotMode(_0x5ef5cf){const _0x382035=_0x367b12;if(pid[_0x5ef5cf])pid[_0x5ef5cf]['send']({'function':'toggleBotMode','args':null});else{const _0x58b3bc=configpath+_0x382035(0x22b)+_0x5ef5cf+_0x382035(0x15d),_0x30e07f=fs[_0x382035(0x1b5)](_0x58b3bc),_0x4fc026=JSON[_0x382035(0x198)](_0x30e07f),_0x71f8f7=_0x4fc026[_0x382035(0xa8)][0x0][_0x382035(0x1a1)];_0x4fc026[_0x382035(0xa8)][0x0][_0x382035(0x1a1)]=!_0x71f8f7;const _0x186ed0=JSON[_0x382035(0x18b)](_0x4fc026,null,0x2);fs['writeFileSync'](_0x58b3bc,_0x186ed0),config=getConfiguration(),io['to'](_0x382035(0x1d0))['emit'](_0x382035(0xa3),config),broadcastToBots(_0x382035(0xa3),JSON['stringify'](config));}}function telegramError(_0x3608f3){const _0x590e22=_0x367b12;logger[_0x590e22(0x1a6)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x2dee41){const _0x10656b=_0x367b12;if(_0x2dee41[_0x10656b(0x1f9)][_0x10656b(0x21a)]!=settings['telegramUsername']&&'@'+_0x2dee41[_0x10656b(0x1f9)]['username']!=settings[_0x10656b(0xb9)])return tgBot[_0x10656b(0x1f3)](_0x2dee41[_0x10656b(0x75)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':'HTML'})[_0x10656b(0x240)](_0x4055f0=>{telegramError(_0x4055f0);}),![];return!![];}async function initTelegram(){const _0x26f526=_0x367b12;if(tgBot)tgBot[_0x26f526(0xd9)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x26f526(0x158)],{'polling':!![]});let _0x2618c3='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x2618c3+='\x0a',_0x2618c3+=_0x26f526(0xfa),_0x2618c3+='/disable\x20-\x20disable\x20notifications\x0a',_0x2618c3+=_0x26f526(0x151),_0x2618c3+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x2618c3+=_0x26f526(0x12a),_0x2618c3+=_0x26f526(0x11c),_0x2618c3+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x2618c3+=_0x26f526(0x15c),_0x2618c3+=_0x26f526(0xb2),_0x2618c3+=_0x26f526(0x125),_0x2618c3+=_0x26f526(0x80),_0x2618c3+=_0x26f526(0x14e),_0x2618c3+=_0x26f526(0x174),_0x2618c3+=_0x26f526(0x9f);let _0x1518c9=_0x26f526(0x1ca);_0x1518c9+='\x0a',_0x1518c9+=_0x2618c3,tgBot['onText'](/\/start/,_0xc2fc3b=>{const _0xb52aad=_0x26f526;if(!validateTelegram(_0xc2fc3b))return;if(settings[_0xb52aad(0x122)]!=_0xc2fc3b[_0xb52aad(0x75)]['id'])updateSetting('telegramChatId',_0xc2fc3b['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot[_0xb52aad(0x1f3)](_0xc2fc3b['chat']['id'],_0x1518c9)[_0xb52aad(0x240)](_0x514747=>{telegramError(_0x514747);});}),tgBot[_0x26f526(0x9e)](/\/enable/,_0x469cf5=>{const _0x5b8107=_0x26f526;if(!validateTelegram(_0x469cf5))return;if(settings['telegramChatId']!=_0x469cf5[_0x5b8107(0x75)]['id'])updateSetting('telegramChatId',_0x469cf5[_0x5b8107(0x75)]['id']);updateSetting(_0x5b8107(0x1d1),!![]),tgBot[_0x5b8107(0x1f3)](_0x469cf5[_0x5b8107(0x75)]['id'],_0x5b8107(0xeb))[_0x5b8107(0x240)](_0x17a5a1=>{telegramError(_0x17a5a1);});}),tgBot[_0x26f526(0x9e)](/\/config/,async _0x2e07c6=>{const _0x25900f=_0x26f526;if(!validateTelegram(_0x2e07c6))return;tgBot[_0x25900f(0x23b)](_0x25900f(0x13e)),tgBot[_0x25900f(0x1f3)](_0x2e07c6[_0x25900f(0x75)]['id'],_0x25900f(0x234),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':'orders'},{'text':_0x25900f(0x7f),'callback_data':_0x25900f(0x1ec)},{'text':_0x25900f(0x1c1),'callback_data':_0x25900f(0x237)}]]}})[_0x25900f(0x240)](_0x3962f3=>{telegramError(_0x3962f3);}),tgBot['on'](_0x25900f(0x13e),async _0x4fd13f=>{const _0x5839a4=_0x25900f,_0x59b052=_0x4fd13f['data'],_0x236896=_0x4fd13f[_0x5839a4(0x232)];tgBot['answerCallbackQuery'](_0x4fd13f['id'])[_0x5839a4(0x1ba)](async()=>{const _0x44df06=_0x5839a4;_0x59b052=='orders'&&(updateSetting(_0x44df06(0xa7),_0x44df06(0x107)),updateSetting(_0x44df06(0x1d1),!![]),await tgBot[_0x44df06(0x1f3)](_0x236896[_0x44df06(0x75)]['id'],_0x44df06(0x1f7))[_0x44df06(0x240)](_0x4bb73a=>{telegramError(_0x4bb73a);}));_0x59b052==_0x44df06(0x1ec)&&(updateSetting(_0x44df06(0xa7),_0x44df06(0x1ec)),updateSetting(_0x44df06(0x1d1),!![]),await tgBot[_0x44df06(0x1f3)](_0x236896[_0x44df06(0x75)]['id'],_0x44df06(0x1c7))[_0x44df06(0x240)](_0x3e97b1=>{telegramError(_0x3e97b1);}));_0x59b052==_0x44df06(0x237)&&(updateSetting('telegramEvents',_0x44df06(0x237)),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x236896[_0x44df06(0x75)]['id'],_0x44df06(0xcd))['catch'](_0x402eed=>{telegramError(_0x402eed);}));if(!settings['telegramChatId'])tgBot[_0x44df06(0x1f3)](_0x236896[_0x44df06(0x75)]['id'],_0x44df06(0x204))[_0x44df06(0x240)](_0x5bd610=>{telegramError(_0x5bd610);});}),tgBot[_0x5839a4(0x23b)](_0x5839a4(0x13e));});}),tgBot['onText'](/\/status/,_0x5a2200=>{const _0x3fbac0=_0x26f526;if(!validateTelegram(_0x5a2200))return;const _0x289e9d=getBotsWithMode();let _0x35635c='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x3fbac0(0x16f)](_0x5bb54f=>{const _0x3e390c=_0x3fbac0,_0x28eb6e=_0x289e9d[_0x3e390c(0xe4)](_0x447c84=>_0x447c84[_0x3e390c(0xca)]==_0x5bb54f[_0x3e390c(0xca)])['mode'];_0x35635c+=_0x3e390c(0x238)+_0x5bb54f['botID']+':\x20'+_0x5bb54f[_0x3e390c(0x134)]+'\x20|\x20'+_0x28eb6e+'\x20|\x20'+_0x5bb54f[_0x3e390c(0x243)]+'\x0a';}),_0x35635c+='\x0a',_0x35635c+=_0x3fbac0(0x128),_0x35635c+=!settings['telegramEnabled']?_0x3fbac0(0x1b1):_0x3fbac0(0x7b),_0x35635c+=settings[_0x3fbac0(0x1d1)]?settings[_0x3fbac0(0xa7)]==_0x3fbac0(0x237)?_0x3fbac0(0x15a):'Notifications\x20types:\x20'+settings[_0x3fbac0(0xa7)]+_0x3fbac0(0x1b7):'',tgBot[_0x3fbac0(0x1f3)](_0x5a2200[_0x3fbac0(0x75)]['id'],_0x35635c,{'parse_mode':_0x3fbac0(0xee)})[_0x3fbac0(0x240)](_0x2296f0=>{telegramError(_0x2296f0);});}),tgBot[_0x26f526(0x9e)](/\/restart/,_0x51adb3=>{const _0x38fc57=_0x26f526;if(!validateTelegram(_0x51adb3))return;tgBot[_0x38fc57(0x23b)](_0x38fc57(0x13e));const _0x658f44=getEnabledBots();if(_0x658f44[_0x38fc57(0xe6)]==0x0)tgBot[_0x38fc57(0x1f3)](_0x51adb3[_0x38fc57(0x75)]['id'],_0x38fc57(0x10f))[_0x38fc57(0x240)](_0xc16097=>{telegramError(_0xc16097);});else{if(_0x658f44['length']>0x1)_0x658f44['push']({'botID':'all'});let _0x59e7b8=[],_0x2794b1=[];const _0x11d11c=_0x658f44[_0x38fc57(0xe6)]%0x4==0x0||_0x658f44['length']%0x4==0x3||_0x658f44[_0x38fc57(0xe6)]%0x3==0x1?0x4:0x3;let _0xddd642=0x0;_0x658f44[_0x38fc57(0x16f)]((_0x318b7a,_0x5b438b)=>{const _0x2a275f=_0x38fc57;if(_0x5b438b%_0x11d11c==0x0)_0x2794b1=[];_0x2794b1['push']({'text':_0x318b7a[_0x2a275f(0xca)]==_0x2a275f(0x237)?_0x2a275f(0x1d4):_0x2a275f(0x238)+_0x318b7a[_0x2a275f(0xca)],'callback_data':_0x318b7a[_0x2a275f(0xca)]}),_0x5b438b%_0x11d11c==0x0&&(_0x59e7b8[_0xddd642]=_0x2794b1,_0xddd642++);}),tgBot[_0x38fc57(0x1f3)](_0x51adb3[_0x38fc57(0x75)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x59e7b8}})[_0x38fc57(0x240)](_0x27bbbc=>{telegramError(_0x27bbbc);}),tgBot['on'](_0x38fc57(0x13e),async _0x15106c=>{const _0x23b9b1=_0x38fc57,_0x5ccacd=_0x15106c[_0x23b9b1(0xa2)],_0x326d5d=_0x15106c[_0x23b9b1(0x232)];tgBot[_0x23b9b1(0xbf)](_0x15106c['id'])[_0x23b9b1(0x1ba)](async()=>{const _0x2382d2=_0x23b9b1;_0x5ccacd=='all'?config[_0x2382d2(0x16f)](_0xbe496e=>{const _0x26dbef=_0x2382d2;restartBot(_0xbe496e[_0x26dbef(0xca)]);}):restartBot(_0x5ccacd);}),tgBot['removeListener'](_0x23b9b1(0x13e));});}}),tgBot[_0x26f526(0x9e)](/\/on/,_0x2b8d9e=>{const _0x1ea70b=_0x26f526;if(!validateTelegram(_0x2b8d9e))return;tgBot['removeListener'](_0x1ea70b(0x13e));const _0x7b3739=getDisabledBots();if(_0x7b3739['length']==0x0)tgBot['sendMessage'](_0x2b8d9e[_0x1ea70b(0x75)]['id'],_0x1ea70b(0x191))['catch'](_0x3d2d98=>{telegramError(_0x3d2d98);});else{if(_0x7b3739[_0x1ea70b(0xe6)]>0x1)_0x7b3739['push']({'botID':'all'});let _0x3178ef=[],_0x152af5=[];const _0x47b9c1=_0x7b3739[_0x1ea70b(0xe6)]%0x4==0x0||_0x7b3739[_0x1ea70b(0xe6)]%0x4==0x3||_0x7b3739['length']%0x3==0x1?0x4:0x3;let _0x4dfa70=0x0;_0x7b3739['forEach']((_0xf87853,_0x64327e)=>{const _0x20b57c=_0x1ea70b;if(_0x64327e%_0x47b9c1==0x0)_0x152af5=[];_0x152af5[_0x20b57c(0x16c)]({'text':_0xf87853['botID']==_0x20b57c(0x237)?_0x20b57c(0x1d4):_0x20b57c(0x238)+_0xf87853[_0x20b57c(0xca)],'callback_data':_0xf87853[_0x20b57c(0xca)]}),_0x64327e%_0x47b9c1==0x0&&(_0x3178ef[_0x4dfa70]=_0x152af5,_0x4dfa70++);}),tgBot['sendMessage'](_0x2b8d9e[_0x1ea70b(0x75)]['id'],_0x1ea70b(0x193),{'reply_markup':{'inline_keyboard':_0x3178ef}})[_0x1ea70b(0x240)](_0x8d30d7=>{telegramError(_0x8d30d7);}),tgBot['on']('callback_query',async _0x28e342=>{const _0x4ffa0a=_0x1ea70b,_0x271c9a=_0x28e342['data'],_0x5d21f9=_0x28e342[_0x4ffa0a(0x232)];tgBot[_0x4ffa0a(0xbf)](_0x28e342['id'])['then'](async()=>{const _0x32b5e3=_0x4ffa0a;_0x271c9a==_0x32b5e3(0x237)?(tgBot['sendMessage'](_0x5d21f9['chat']['id'],_0x32b5e3(0x245))[_0x32b5e3(0x240)](_0x412f26=>{telegramError(_0x412f26);}),_0x7b3739[_0x32b5e3(0x16f)](_0x1ba0e7=>{const _0x1fb2f8=_0x32b5e3;if(_0x1ba0e7[_0x1fb2f8(0xca)]!=_0x1fb2f8(0x237))toggleBot(_0x1ba0e7[_0x1fb2f8(0xca)],toggleStatus(_0x1ba0e7[_0x1fb2f8(0xca)]),_0x1fb2f8(0x106));})):(tgBot[_0x32b5e3(0x1f3)](_0x5d21f9[_0x32b5e3(0x75)]['id'],_0x32b5e3(0x21d)+_0x271c9a)[_0x32b5e3(0x240)](_0x54a202=>{telegramError(_0x54a202);}),toggleBot(_0x271c9a,toggleStatus(_0x271c9a),_0x32b5e3(0x106)));}),tgBot['removeListener'](_0x4ffa0a(0x13e));});}}),tgBot[_0x26f526(0x9e)](/\/off/,_0x5a184c=>{const _0x554d27=_0x26f526;if(!validateTelegram(_0x5a184c))return;tgBot[_0x554d27(0x23b)](_0x554d27(0x13e));const _0x14a768=getEnabledBots();if(_0x14a768[_0x554d27(0xe6)]==0x0)tgBot[_0x554d27(0x1f3)](_0x5a184c[_0x554d27(0x75)]['id'],_0x554d27(0x10f))[_0x554d27(0x240)](_0x33eb68=>{telegramError(_0x33eb68);});else{if(_0x14a768[_0x554d27(0xe6)]>0x1)_0x14a768[_0x554d27(0x16c)]({'botID':_0x554d27(0x237)});let _0x7b9c74=[],_0x1e07ae=[];const _0x156d3d=_0x14a768[_0x554d27(0xe6)]%0x4==0x0||_0x14a768[_0x554d27(0xe6)]%0x4==0x3||_0x14a768['length']%0x3==0x1?0x4:0x3;let _0xdcadba=0x0;_0x14a768[_0x554d27(0x16f)]((_0x16ac8a,_0x4c90d3)=>{const _0x383e3e=_0x554d27;if(_0x4c90d3%_0x156d3d==0x0)_0x1e07ae=[];_0x1e07ae[_0x383e3e(0x16c)]({'text':_0x16ac8a[_0x383e3e(0xca)]==_0x383e3e(0x237)?_0x383e3e(0x1d4):_0x383e3e(0x238)+_0x16ac8a[_0x383e3e(0xca)],'callback_data':_0x16ac8a[_0x383e3e(0xca)]}),_0x4c90d3%_0x156d3d==0x0&&(_0x7b9c74[_0xdcadba]=_0x1e07ae,_0xdcadba++);}),tgBot[_0x554d27(0x1f3)](_0x5a184c[_0x554d27(0x75)]['id'],_0x554d27(0x17c),{'reply_markup':{'inline_keyboard':_0x7b9c74}})['catch'](_0x4bbbd4=>{telegramError(_0x4bbbd4);}),tgBot['on'](_0x554d27(0x13e),async _0x2d3272=>{const _0x53ddcd=_0x554d27,_0x3b263d=_0x2d3272[_0x53ddcd(0xa2)],_0x2e0516=_0x2d3272[_0x53ddcd(0x232)];tgBot[_0x53ddcd(0xbf)](_0x2d3272['id'])['then'](async()=>{const _0x10fa2f=_0x53ddcd;_0x3b263d==_0x10fa2f(0x237)?(tgBot[_0x10fa2f(0x1f3)](_0x2e0516[_0x10fa2f(0x75)]['id'],_0x10fa2f(0x143))[_0x10fa2f(0x240)](_0x5c78fd=>{telegramError(_0x5c78fd);}),_0x14a768[_0x10fa2f(0x16f)](_0x143f0f=>{const _0x20b660=_0x10fa2f;if(_0x143f0f[_0x20b660(0xca)]!=_0x20b660(0x237))toggleBot(_0x143f0f[_0x20b660(0xca)],toggleStatus(_0x143f0f['botID']),_0x20b660(0x106));})):(tgBot[_0x10fa2f(0x1f3)](_0x2e0516[_0x10fa2f(0x75)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x3b263d)['catch'](_0x4e15ac=>{telegramError(_0x4e15ac);}),toggleBot(_0x3b263d,toggleStatus(_0x3b263d),_0x10fa2f(0x106)));}),tgBot['removeListener'](_0x53ddcd(0x13e));});}}),tgBot[_0x26f526(0x9e)](/\/metrics/,_0x390339=>{const _0xd258d2=_0x26f526;if(!validateTelegram(_0x390339))return;tgBot[_0xd258d2(0x23b)](_0xd258d2(0x13e));const _0x15fd6f=getEnabledBots();if(_0x15fd6f[_0xd258d2(0xe6)]==0x0)tgBot[_0xd258d2(0x1f3)](_0x390339[_0xd258d2(0x75)]['id'],_0xd258d2(0x10f))[_0xd258d2(0x240)](_0x53ec65=>{telegramError(_0x53ec65);});else{if(_0x15fd6f[_0xd258d2(0xe6)]>0x1){let _0x503519=[],_0xb06a73=[];const _0x4d4c3b=_0x15fd6f[_0xd258d2(0xe6)]%0x4==0x0||_0x15fd6f[_0xd258d2(0xe6)]%0x4==0x3||_0x15fd6f[_0xd258d2(0xe6)]%0x3==0x1?0x4:0x3;let _0x509cb6=0x0;_0x15fd6f[_0xd258d2(0x16f)]((_0x3f8011,_0x515a1e)=>{const _0x1a489d=_0xd258d2;if(_0x515a1e%_0x4d4c3b==0x0)_0xb06a73=[];_0xb06a73[_0x1a489d(0x16c)]({'text':'Bot\x20'+_0x3f8011[_0x1a489d(0xca)],'callback_data':_0x3f8011['botID']}),_0x515a1e%_0x4d4c3b==0x0&&(_0x503519[_0x509cb6]=_0xb06a73,_0x509cb6++);}),tgBot[_0xd258d2(0x1f3)](_0x390339[_0xd258d2(0x75)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x503519}})[_0xd258d2(0x240)](_0x5b6714=>{telegramError(_0x5b6714);}),tgBot['on'](_0xd258d2(0x13e),async _0x39323a=>{const _0x8bf66f=_0xd258d2,_0x25b6a4=_0x39323a[_0x8bf66f(0xa2)],_0x729ebb=_0x39323a[_0x8bf66f(0x232)];tgBot[_0x8bf66f(0xbf)](_0x39323a['id'])[_0x8bf66f(0x1ba)](async()=>{if(pid[_0x25b6a4])pid[_0x25b6a4]['send']({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x8bf66f(0x23b)](_0x8bf66f(0x13e));});}else{const _0x289df3=_0x15fd6f[0x0][_0xd258d2(0xca)];if(pid[_0x289df3])pid[_0x289df3][_0xd258d2(0x99)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x26f526(0x9e)](/\/portfolio/,_0x298cd2=>{const _0x3fe22d=_0x26f526;if(!validateTelegram(_0x298cd2))return;tgBot[_0x3fe22d(0x23b)]('callback_query');const _0x3be814=getEnabledBots();if(_0x3be814['length']==0x0)tgBot[_0x3fe22d(0x1f3)](_0x298cd2['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0x3fe22d(0x240)](_0x20d82d=>{telegramError(_0x20d82d);});else{if(_0x3be814[_0x3fe22d(0xe6)]>0x1){let _0x4b8c8d=[],_0x491044=[];const _0x199074=_0x3be814['length']%0x4==0x0||_0x3be814['length']%0x4==0x3||_0x3be814['length']%0x3==0x1?0x4:0x3;let _0x1fc1b9=0x0;_0x3be814[_0x3fe22d(0x16f)]((_0x1e110e,_0x5dad90)=>{const _0x5c65c5=_0x3fe22d;if(_0x5dad90%_0x199074==0x0)_0x491044=[];_0x491044['push']({'text':'Bot\x20'+_0x1e110e['botID'],'callback_data':_0x1e110e[_0x5c65c5(0xca)]}),_0x5dad90%_0x199074==0x0&&(_0x4b8c8d[_0x1fc1b9]=_0x491044,_0x1fc1b9++);}),tgBot[_0x3fe22d(0x1f3)](_0x298cd2[_0x3fe22d(0x75)]['id'],_0x3fe22d(0x1df),{'reply_markup':{'inline_keyboard':_0x4b8c8d}})[_0x3fe22d(0x240)](_0x4fc466=>{telegramError(_0x4fc466);}),tgBot['on'](_0x3fe22d(0x13e),async _0x806608=>{const _0x167373=_0x3fe22d,_0x126d95=_0x806608[_0x167373(0xa2)],_0x2925a7=_0x806608[_0x167373(0x232)];tgBot[_0x167373(0xbf)](_0x806608['id'])['then'](async()=>{const _0x19b642=_0x167373;if(pid[_0x126d95])pid[_0x126d95][_0x19b642(0x99)]({'function':_0x19b642(0xa4),'args':null});}),tgBot[_0x167373(0x23b)](_0x167373(0x13e));});}else{const _0x47d50b=_0x3be814[0x0][_0x3fe22d(0xca)];if(pid[_0x47d50b])pid[_0x47d50b][_0x3fe22d(0x99)]({'function':_0x3fe22d(0xa4),'args':null});}}}),tgBot[_0x26f526(0x9e)](/\/update/,async _0x4f0b15=>{const _0x20aa88=_0x26f526;if(!validateTelegram(_0x4f0b15))return;tgBot[_0x20aa88(0x23b)](_0x20aa88(0x13e)),await getMessages();if(!updateAvailable)tgBot[_0x20aa88(0x1f3)](_0x4f0b15['chat']['id'],_0x20aa88(0xd4))[_0x20aa88(0x240)](_0x5f5bb5=>{telegramError(_0x5f5bb5);});else!validInstallation?tgBot['sendMessage'](_0x4f0b15['chat']['id'],_0x20aa88(0x16d))[_0x20aa88(0x240)](_0x43d6c2=>{telegramError(_0x43d6c2);}):(tgBot[_0x20aa88(0x1f3)](_0x4f0b15[_0x20aa88(0x75)]['id'],_0x20aa88(0x105),{'reply_markup':{'inline_keyboard':[[{'text':_0x20aa88(0x149),'callback_data':_0x20aa88(0x10c)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x5b3794=>{telegramError(_0x5b3794);}),tgBot['on'](_0x20aa88(0x13e),async _0x10106d=>{const _0x31cb9a=_0x20aa88,_0x47df66=_0x10106d[_0x31cb9a(0xa2)],_0x3ec3c3=_0x10106d[_0x31cb9a(0x232)];tgBot[_0x31cb9a(0xbf)](_0x10106d['id'])[_0x31cb9a(0x1ba)](async()=>{const _0x28256a=_0x31cb9a;_0x47df66==_0x28256a(0x10c)&&(await tgBot[_0x28256a(0x1f3)](_0x3ec3c3[_0x28256a(0x75)]['id'],_0x28256a(0x6d))[_0x28256a(0x240)](_0x209900=>{telegramError(_0x209900);}),updateBB('update')),_0x47df66=='no'&&await tgBot[_0x28256a(0x1f3)](_0x3ec3c3[_0x28256a(0x75)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')['catch'](_0x1c1d15=>{telegramError(_0x1c1d15);});}),tgBot[_0x31cb9a(0x23b)](_0x31cb9a(0x13e));}));}),tgBot[_0x26f526(0x9e)](/\/reinstall/,async _0x36666d=>{const _0x3cb685=_0x26f526;if(!validateTelegram(_0x36666d))return;tgBot[_0x3cb685(0x23b)](_0x3cb685(0x13e)),!validInstallation?tgBot[_0x3cb685(0x1f3)](_0x36666d[_0x3cb685(0x75)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')[_0x3cb685(0x240)](_0x54395d=>{telegramError(_0x54395d);}):(tgBot[_0x3cb685(0x1f3)](_0x36666d[_0x3cb685(0x75)]['id'],_0x3cb685(0x154),{'reply_markup':{'inline_keyboard':[[{'text':_0x3cb685(0x149),'callback_data':_0x3cb685(0x10c)},{'text':'No','callback_data':'no'}]]}})[_0x3cb685(0x240)](_0xcf7e17=>{telegramError(_0xcf7e17);}),tgBot['on']('callback_query',async _0x1cc34f=>{const _0x4cdf11=_0x3cb685,_0xb1c156=_0x1cc34f[_0x4cdf11(0xa2)],_0xd10edc=_0x1cc34f[_0x4cdf11(0x232)];tgBot[_0x4cdf11(0xbf)](_0x1cc34f['id'])[_0x4cdf11(0x1ba)](async()=>{const _0x12e7d4=_0x4cdf11;_0xb1c156==_0x12e7d4(0x10c)&&(await tgBot[_0x12e7d4(0x1f3)](_0xd10edc['chat']['id'],_0x12e7d4(0x1f1))[_0x12e7d4(0x240)](_0x323a03=>{telegramError(_0x323a03);}),updateBB(_0x12e7d4(0x159))),_0xb1c156=='no'&&await tgBot[_0x12e7d4(0x1f3)](_0xd10edc[_0x12e7d4(0x75)]['id'],_0x12e7d4(0x1c6))['catch'](_0x454763=>{telegramError(_0x454763);});}),tgBot[_0x4cdf11(0x23b)](_0x4cdf11(0x13e));}));}),tgBot[_0x26f526(0x9e)](/\/toggle/,_0xa11b12=>{const _0x276f37=_0x26f526;if(!validateTelegram(_0xa11b12))return;tgBot[_0x276f37(0x23b)](_0x276f37(0x13e));const _0x11061f=getBotsWithMode();if(_0x11061f['length']==0x0)tgBot['sendMessage'](_0xa11b12['chat']['id'],_0x276f37(0x10f))[_0x276f37(0x240)](_0x56c6bb=>{telegramError(_0x56c6bb);});else{let _0x52a905=[],_0xf53849=[];const _0x2edd54=0x2;let _0x1ba420=0x0;_0x11061f[_0x276f37(0x16f)]((_0x49980a,_0x19fe3d)=>{const _0x3f8116=_0x276f37;if(_0x19fe3d%_0x2edd54==0x0)_0xf53849=[];_0xf53849['push']({'text':_0x3f8116(0x238)+_0x49980a[_0x3f8116(0xca)]+'\x20('+_0x49980a['mode']+')','callback_data':_0x49980a[_0x3f8116(0xca)]}),_0x19fe3d%_0x2edd54==0x0&&(_0x52a905[_0x1ba420]=_0xf53849,_0x1ba420++);}),tgBot['sendMessage'](_0xa11b12['chat']['id'],_0x276f37(0xc1),{'reply_markup':{'inline_keyboard':_0x52a905}})[_0x276f37(0x240)](_0x50754b=>{telegramError(_0x50754b);}),tgBot['on'](_0x276f37(0x13e),async _0x43071a=>{const _0x200cdf=_0x276f37,_0x258649=_0x43071a[_0x200cdf(0xa2)],_0x411e10=_0x43071a[_0x200cdf(0x232)];tgBot['answerCallbackQuery'](_0x43071a['id'])[_0x200cdf(0x1ba)](async()=>{const _0x34945c=_0x200cdf,_0x363081=_0x11061f[_0x34945c(0xe4)](_0x754462=>_0x754462[_0x34945c(0xca)]==_0x258649),_0x33fc65=_0x363081[_0x34945c(0x94)]==_0x34945c(0x141)?'manual':_0x34945c(0x141);tgBot[_0x34945c(0x1f3)](_0x411e10[_0x34945c(0x75)]['id'],_0x34945c(0x92)+_0x258649+_0x34945c(0xac)+_0x33fc65+_0x34945c(0x1bd))[_0x34945c(0x240)](_0x5bad67=>{telegramError(_0x5bad67);}),toggleBotMode(_0x258649);}),tgBot[_0x200cdf(0x23b)](_0x200cdf(0x13e));});}}),tgBot[_0x26f526(0x9e)](/\/names/,_0x4b0807=>{const _0x31edac=_0x26f526;if(!validateTelegram(_0x4b0807))return;let _0x40461a='';config[_0x31edac(0x16f)](_0x15e195=>{const _0x132b90=_0x31edac;_0x40461a+=_0x132b90(0x238)+_0x15e195[_0x132b90(0xca)]+':\x20'+_0x15e195['botname']+'\x0a';}),tgBot[_0x31edac(0x1f3)](_0x4b0807['chat']['id'],_0x40461a,{'parse_mode':_0x31edac(0xee)})['catch'](_0x436fee=>{telegramError(_0x436fee);});}),tgBot[_0x26f526(0x9e)](/\/disable/,_0x56ffa7=>{const _0x460ddf=_0x26f526;if(!validateTelegram(_0x56ffa7))return;tgBot['sendMessage'](_0x56ffa7[_0x460ddf(0x75)]['id'],_0x460ddf(0x10e))[_0x460ddf(0x240)](_0x1887fd=>{telegramError(_0x1887fd);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x26f526(0x9e)](/\/help/,_0x2593e0=>{const _0x257c57=_0x26f526;if(!validateTelegram(_0x2593e0))return;tgBot[_0x257c57(0x1f3)](_0x2593e0[_0x257c57(0x75)]['id'],_0x2618c3)[_0x257c57(0x240)](_0x49c258=>{telegramError(_0x49c258);});}),tgBot['on'](_0x26f526(0x173),_0x361f7d=>{const _0x241e0b=_0x26f526;_0x361f7d['toString']()['includes'](_0x241e0b(0x1be))&&(logger[_0x241e0b(0x1ab)](_0x241e0b(0x13c)),tgBot[_0x241e0b(0xd9)](),tgBot=null,io['to'](_0x241e0b(0x1d0))['emit']('notification',_0x241e0b(0x13c)));}),process[_0x26f526(0x242)](_0x26f526(0x1ee),()=>{const _0x2f2e87=_0x26f526;if(tgBot)tgBot[_0x2f2e87(0xd9)]();process[_0x2f2e87(0x167)](0x1);}),process['once'](_0x26f526(0xc7),()=>{const _0x6350e8=_0x26f526;if(tgBot)tgBot[_0x6350e8(0xd9)]();process['exit'](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x35616b,_0x510f2f){const _0x2c12a1=_0x367b12;if(settings[_0x2c12a1(0x1d1)]){if(settings[_0x2c12a1(0xa7)]==_0x2c12a1(0x237)||(_0x510f2f[_0x2c12a1(0x1fc)]==_0x2c12a1(0xf3)||_0x510f2f[_0x2c12a1(0x1fc)]==_0x2c12a1(0xcf)||_0x510f2f['type']==_0x2c12a1(0x1bc))&&settings[_0x2c12a1(0xa7)]==_0x2c12a1(0x1ec)||_0x510f2f[_0x2c12a1(0x1fc)]==_0x2c12a1(0x142)&&settings['telegramEvents']==_0x2c12a1(0x107)){if(tgBot&&settings[_0x2c12a1(0x122)]){if(_0x510f2f[_0x2c12a1(0x1c8)])tgBot[_0x2c12a1(0x1f3)](settings[_0x2c12a1(0x122)],_0x510f2f['botname']+_0x2c12a1(0x1f2)+_0x510f2f[_0x2c12a1(0x124)])[_0x2c12a1(0x240)](_0x34751b=>{telegramError(_0x34751b);});else tgBot[_0x2c12a1(0x1f3)](settings[_0x2c12a1(0x122)],_0x2c12a1(0x238)+_0x35616b+_0x2c12a1(0x1f2)+_0x510f2f[_0x2c12a1(0x124)])['catch'](_0x4b2297=>{telegramError(_0x4b2297);});}}}}async function sendTelegramMsg(_0x4c528b,_0x529ddd=_0x367b12(0xee)){const _0x133214=_0x367b12;return settings['telegramEnabled']&&tgBot&&settings[_0x133214(0x122)]?(await tgBot[_0x133214(0x1f3)](settings['telegramChatId'],_0x4c528b,{'parse_mode':_0x529ddd})[_0x133214(0x240)](_0x3089fd=>{telegramError(_0x3089fd);}),!![]):![];}function getDeviceWithIp(_0x416fe4){return devices['find'](_0x4b2c8d=>_0x4b2c8d['ip']===_0x416fe4);}function temporaryAccess2FA(_0x55dd50,_0x24cb9b){const _0x168d2f=_0x367b12;let _0x58b7df=new Date(),_0x408432=![];if(lastIpApproval){if(_0x58b7df-lastIpApproval<0x1388)_0x408432=!![];}lastIpApproval=new Date();if(_0x408432)return;tgBot&&settings[_0x168d2f(0x122)]&&(tgBot[_0x168d2f(0x23b)](_0x168d2f(0x13e)),tgBot[_0x168d2f(0x1f3)](settings[_0x168d2f(0x122)],_0x168d2f(0x20a)+normalizeIP(_0x24cb9b)[_0x168d2f(0x190)]+_0x168d2f(0xab),{'parse_mode':_0x168d2f(0xee),'reply_markup':{'inline_keyboard':[[{'text':_0x168d2f(0x126),'callback_data':'5'},{'text':_0x168d2f(0x19f),'callback_data':'15'},{'text':_0x168d2f(0x91),'callback_data':'30'},{'text':_0x168d2f(0x1e5),'callback_data':_0x168d2f(0x1e5)}]]}})[_0x168d2f(0x240)](_0x113da0=>{telegramError(_0x113da0);}),tgBot['on'](_0x168d2f(0x13e),async _0x3db2e1=>{const _0x20c3eb=_0x168d2f,_0x32efa5=_0x3db2e1[_0x20c3eb(0xa2)],_0x526fb9=_0x3db2e1[_0x20c3eb(0x232)];tgBot[_0x20c3eb(0xbf)](_0x3db2e1['id'])[_0x20c3eb(0x1ba)](async()=>{const _0x533e8e=_0x20c3eb;devices[_0x55dd50][_0x533e8e(0xba)]={'clientip':_0x24cb9b,'timestamp':new Date()['getTime'](),'expiry':_0x32efa5},_0x32efa5!='reject'?(await tgBot['sendMessage'](_0x526fb9[_0x533e8e(0x75)]['id'],_0x533e8e(0x121)+_0x32efa5+_0x533e8e(0x225),{'parse_mode':'HTML'})[_0x533e8e(0x240)](_0xd0707e=>{telegramError(_0xd0707e);}),io['to'](_0x55dd50)[_0x533e8e(0x1e2)](_0x533e8e(0x134),{'access':{'allow':![],'reason':_0x533e8e(0x1a5),'token':null}})):(await tgBot[_0x533e8e(0x1f3)](_0x526fb9[_0x533e8e(0x75)]['id'],_0x533e8e(0x20c))[_0x533e8e(0x240)](_0x498e0d=>{telegramError(_0x498e0d);}),io['to'](_0x55dd50)[_0x533e8e(0x1e2)](_0x533e8e(0x134),{'access':{'allow':![],'reason':_0x533e8e(0x21f),'token':null}}));}),tgBot[_0x20c3eb(0x23b)](_0x20c3eb(0x13e));}));}function loginAccess2FA(_0x18ad1a,_0x498f5d){const _0x439aef=_0x367b12;tgBot&&settings['telegramChatId']&&(tgBot[_0x439aef(0x23b)](_0x439aef(0x13e)),tgBot[_0x439aef(0x1f3)](settings['telegramChatId'],_0x439aef(0x114)+normalizeIP(_0x498f5d)[_0x439aef(0x190)]+'</b>\x20?',{'parse_mode':_0x439aef(0xee),'reply_markup':{'inline_keyboard':[[{'text':_0x439aef(0x130),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x439aef(0x1e5)}]]}})['catch'](_0x296874=>{telegramError(_0x296874);}),tgBot['on'](_0x439aef(0x13e),async _0x1d2ff6=>{const _0x7478ac=_0x439aef,_0x304c54=_0x1d2ff6[_0x7478ac(0xa2)],_0x21b9a5=_0x1d2ff6[_0x7478ac(0x232)];tgBot[_0x7478ac(0xbf)](_0x1d2ff6['id'])[_0x7478ac(0x1ba)](async()=>{const _0x5d23f2=_0x7478ac;devices[_0x18ad1a][_0x5d23f2(0x1db)]={'clientip':_0x498f5d,'timestamp':new Date()['getTime'](),'expiry':_0x304c54},_0x304c54!=_0x5d23f2(0x1e5)?(await tgBot[_0x5d23f2(0x1f3)](_0x21b9a5[_0x5d23f2(0x75)]['id'],_0x5d23f2(0x1c3),{'parse_mode':'HTML'})[_0x5d23f2(0x240)](_0x58bdd6=>{telegramError(_0x58bdd6);}),io['to'](_0x18ad1a)[_0x5d23f2(0x1e2)]('status',{'access':{'allow':![],'reason':_0x5d23f2(0x1a5),'token':null}})):(await tgBot[_0x5d23f2(0x1f3)](_0x21b9a5[_0x5d23f2(0x75)]['id'],_0x5d23f2(0xb7))['catch'](_0x387d00=>{telegramError(_0x387d00);}),io['to'](_0x18ad1a)[_0x5d23f2(0x1e2)](_0x5d23f2(0x134),{'access':{'allow':![],'reason':_0x5d23f2(0x19e),'token':null}}));}),tgBot[_0x7478ac(0x23b)](_0x7478ac(0x13e));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3227ee=_0x367b12;return dbConfig['get'](_0x3227ee(0xa3))[_0x3227ee(0x146)]('botID')[_0x3227ee(0x79)]({'status':_0x3227ee(0x85)})[_0x3227ee(0x1f8)]()||[];}function getDisabledBots(){const _0xaa02b4=_0x367b12;return dbConfig['get'](_0xaa02b4(0xa3))[_0xaa02b4(0x146)](_0xaa02b4(0xca))[_0xaa02b4(0x79)]({'status':_0xaa02b4(0xb3)})['value']()||[];}function getBotAttributes(_0xc0f9ea){const _0xcd294d=_0x367b12;let _0x1f635e={};const _0x5fb5ea=configpath+_0xcd294d(0x22b)+_0xc0f9ea+_0xcd294d(0x15d),_0x560a78=fs['existsSync'](_0x5fb5ea);if(_0x560a78){const _0x20ad96=fs[_0xcd294d(0x1b5)](_0x5fb5ea);try{const _0x328290=JSON[_0xcd294d(0x198)](_0x20ad96),_0x2aae5a=_0x328290?_0x328290[_0xcd294d(0xa8)][0x0][_0xcd294d(0x1a1)]:![];_0x1f635e['mode']=_0x2aae5a?_0xcd294d(0x141):_0xcd294d(0x16a),_0x1f635e[_0xcd294d(0x203)]=_0x328290?_0x328290[_0xcd294d(0xa8)][0x0]['botname']:'Bot\x20'+_0xc0f9ea;}catch(_0x178bdd){_0x1f635e['mode']='manual',_0x1f635e[_0xcd294d(0x203)]='Bot\x20'+_0xc0f9ea;}}else _0x1f635e[_0xcd294d(0x94)]=_0xcd294d(0x16a),_0x1f635e[_0xcd294d(0x203)]='Bot\x20'+_0xc0f9ea;return _0x1f635e;}function getBotsWithMode(){const _0x36e2c9=_0x367b12,_0x1f49e1=dbConfig[_0x36e2c9(0x221)]('bots')[_0x36e2c9(0x146)]('botID')[_0x36e2c9(0x1f8)]()||[];return _0x1f49e1['forEach'](_0x265038=>{const _0x4d27df=_0x36e2c9;let _0x2758e9=getBotAttributes(_0x265038[_0x4d27df(0xca)]);_0x265038['mode']=_0x2758e9[_0x4d27df(0x94)];}),_0x1f49e1;}function getBotExchanges(){const _0x4ed3ae=_0x367b12;let _0x3ac664=[];const _0x36aa67=dbConfig[_0x4ed3ae(0x221)](_0x4ed3ae(0xa3))[_0x4ed3ae(0x146)]('botID')[_0x4ed3ae(0x1f8)]()||[];_0x36aa67[_0x4ed3ae(0x16f)](_0x521dc6=>{const _0x3db2cd=_0x4ed3ae;if(_0x521dc6[_0x3db2cd(0x134)]==_0x3db2cd(0x85)){const _0x4d006e=configpath+_0x3db2cd(0x22b)+_0x521dc6[_0x3db2cd(0xca)]+_0x3db2cd(0x15d),_0x71b04a=fs['existsSync'](_0x4d006e);let _0xa123e8;if(_0x71b04a){const _0x380356=fs[_0x3db2cd(0x1b5)](_0x4d006e);try{const _0x519d57=JSON[_0x3db2cd(0x198)](_0x380356);_0xa123e8=_0x519d57?_0x519d57[_0x3db2cd(0xa8)][0x0][_0x3db2cd(0x15b)]:null;}catch(_0x90000){}}if(_0xa123e8)_0x3ac664[_0x3db2cd(0x16c)](_0xa123e8);}});const _0x396c1b=[...new Set(_0x3ac664)][_0x4ed3ae(0x236)]();return _0x396c1b;}async function initUser(){const _0x503c7b=_0x367b12;if(!settings[_0x503c7b(0x6c)]){const _0x8029fe=uuidRandom();mixpanel[_0x503c7b(0xd5)](_0x8029fe),updateSetting('userid',_0x8029fe);}}async function initSecure(){const _0x2e2694=_0x367b12;let _0x30f9c7=getSecure();if(!_0x30f9c7[_0x2e2694(0x1a0)]('secret')){let _0x508766=await generateKeys();_0x30f9c7[_0x2e2694(0x8b)]=_0x508766[_0x2e2694(0x8b)],_0x30f9c7[_0x2e2694(0x14a)]=_0x508766['privateKey'],_0x30f9c7[_0x2e2694(0xd7)]=crypto[_0x2e2694(0x135)](0x20)['toString']('hex');;storeSecure(_0x30f9c7);}}function _0x1253(_0x346ee9,_0x4d3d72){const _0x20088e=_0x1727();return _0x1253=function(_0x56dcb8,_0x50488e){_0x56dcb8=_0x56dcb8-0x6c;let _0x1727cc=_0x20088e[_0x56dcb8];return _0x1727cc;},_0x1253(_0x346ee9,_0x4d3d72);}function getSettings(){const _0x4f1b43=_0x367b12;return dbSettings['get']('settings')[_0x4f1b43(0x1f8)]()||{};}function getSecure(){const _0x575d2f=_0x367b12;return dbSecure[_0x575d2f(0x221)](_0x575d2f(0x1ef))['value']()||{};}function getBlacklist(){const _0x3260c2=_0x367b12;return dbSecure[_0x3260c2(0x221)](_0x3260c2(0x155))['value']()||[];}function broadcastToBots(_0x41872b,_0x72c54c){config['forEach'](_0x258fcb=>{const _0x31387b=_0x1253;if(_0x258fcb[_0x31387b(0x134)]==_0x31387b(0x85)&&_0x258fcb[_0x31387b(0x243)]==_0x31387b(0x7e)||_0x258fcb[_0x31387b(0x134)]==_0x31387b(0x239)&&_0x258fcb[_0x31387b(0x243)]==_0x31387b(0x7e)){if(pid[_0x258fcb[_0x31387b(0xca)]])pid[_0x258fcb[_0x31387b(0xca)]][_0x31387b(0x99)]({[_0x41872b]:_0x72c54c});}});}function storeSettings(_0x267339,_0x2c4764=![]){const _0xdef8ec=_0x367b12;_0x267339={...settings,..._0x267339};if(_0x2c4764&&_0x267339['bbPassword']!=_0xdef8ec(0x22d)&&_0x267339[_0xdef8ec(0x71)]!=_0xdef8ec(0x136)&&_0x267339[_0xdef8ec(0x71)]!=''){const _0x34aae3=crypt[_0xdef8ec(0xe1)](secure[_0xdef8ec(0x14a)],_0x267339[_0xdef8ec(0x71)])['message']['split']('@')[0x0],_0x4ab377=bcrypt['hashSync'](_0x34aae3,saltRounds);_0x267339={..._0x267339,'bbPassword':_0x4ab377};}if(_0x2c4764&&_0x267339['telegramToken']!='************'&&_0x267339['telegramToken']!=_0xdef8ec(0x136)&&_0x267339[_0xdef8ec(0x158)]!=''){const _0x79210c=crypt['decrypt'](secure[_0xdef8ec(0x14a)],_0x267339[_0xdef8ec(0x158)])[_0xdef8ec(0x232)][_0xdef8ec(0x1c5)]('@')[0x0];_0x267339={..._0x267339,'telegramToken':_0x79210c};}const _0x43dbdb=_0x267339[_0xdef8ec(0x158)]!='************'&&_0x267339[_0xdef8ec(0x158)]!=settings[_0xdef8ec(0x158)]||_0x267339[_0xdef8ec(0xb9)]!=settings['telegramUsername'],_0x18a376=_0x267339[_0xdef8ec(0x158)]==''||_0x267339['telegramUsername']=='';if(_0x43dbdb)_0x267339[_0xdef8ec(0xa7)]='all';for(const [_0x5eaf90,_0x1bb47b]of Object[_0xdef8ec(0x23e)](_0x267339)){if(_0x5eaf90==_0xdef8ec(0x158)&&_0x1bb47b=='************'){_0x267339[_0xdef8ec(0x158)]=settings[_0xdef8ec(0x158)];continue;};if(_0x5eaf90=='bbPassword'&&_0x1bb47b==_0xdef8ec(0x22d)){_0x267339[_0xdef8ec(0x71)]=settings[_0xdef8ec(0x71)];continue;};dbSettings[_0xdef8ec(0x138)](_0xdef8ec(0xf0)+_0x5eaf90,_0x1bb47b)['write']();}settings=_0x267339,io['to'](_0xdef8ec(0x1d0))[_0xdef8ec(0x1e2)](_0xdef8ec(0x84),cleanSettings()),broadcastToBots(_0xdef8ec(0xaa),settings[_0xdef8ec(0xaa)]),broadcastToBots(_0xdef8ec(0x1d8),settings[_0xdef8ec(0x1d8)]);if(_0x43dbdb&&!_0x18a376)initTelegram();if(_0x43dbdb&&_0x18a376)disableTelegram();getAllClients()['forEach'](_0x437a17=>{const _0x2991a2=_0xdef8ec;getSocket(_0x437a17['id'])[_0x2991a2(0x1e2)](_0x2991a2(0x134),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x1ea641,_0x82a8b0){const _0x47facb=_0x367b12;dbSettings[_0x47facb(0x138)]('settings.'+_0x1ea641,_0x82a8b0)[_0x47facb(0x227)](),settings=getSettings(),io['to'](_0x47facb(0x1d0))[_0x47facb(0x1e2)]('settings',cleanSettings());}function storeSecure(_0x124eac){const _0xcd6b80=_0x367b12;dbSecure['get'](_0xcd6b80(0x1ef))[_0xcd6b80(0x16c)](_0x124eac)[_0xcd6b80(0x227)](),secure=_0x124eac;}function addBlacklist(_0x4c77d1){const _0x5d167a=_0x367b12;cleanBlacklist();let _0x335c93;devices[_0x4c77d1][_0x5d167a(0xba)]?_0x335c93=Math[_0x5d167a(0x229)](devices[_0x4c77d1]['telegramIpApproval'][_0x5d167a(0x215)],loginExpiry):_0x335c93=loginExpiry,dbSecure['get'](_0x5d167a(0x155))['push']({'expiry':new Date()['getTime']()+_0x335c93*0x3c*0x3e8,'token':devices[_0x4c77d1][_0x5d167a(0x22f)][_0x5d167a(0x233)]})[_0x5d167a(0x227)](),blacklist=dbSecure[_0x5d167a(0x221)](_0x5d167a(0x155))[_0x5d167a(0x1f8)]();}function cleanBlacklist(){const _0x569058=_0x367b12;let _0x2147fa=dbSecure['get'](_0x569058(0x155))[_0x569058(0x12e)]()[_0x569058(0x1f8)](),_0x10affd=new Date()[_0x569058(0x18f)]();_0x2147fa[_0x569058(0x16f)](_0x1f8d74=>{const _0x247594=_0x569058;_0x1f8d74['expiry']<_0x10affd&&dbSecure[_0x247594(0x221)](_0x247594(0x155))['remove']({'expiry':_0x1f8d74[_0x247594(0x215)]})[_0x247594(0x227)]();});}function initStates(){const _0x464229=_0x367b12;let _0x46a812=getConfiguration();_0x46a812[_0x464229(0x16f)](_0xf856c3=>{const _0x371ae2=_0x464229;_0xf856c3['live']=_0x371ae2(0x106);}),storeConfiguration(_0x46a812);}function onKeys(){const _0x803241=new RSA();return new Promise(_0x5e2ef7=>{const _0x27f298=_0x1253;_0x803241['generateKeyPairAsync']()[_0x27f298(0x1ba)](_0x5272ae=>{_0x5e2ef7(_0x5272ae);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x457001=_0x367b12;let _0x278c68=getSettings(),_0xca8d1f=![];!_0x278c68[_0x457001(0x1a0)](_0x457001(0x171))&&(_0x278c68['lastmsgtelegram']=0x0,_0xca8d1f=!![]);!_0x278c68[_0x457001(0x1a0)](_0x457001(0xc8))&&(_0x278c68['lastmsgemitted']=0x0,_0xca8d1f=!![]);!_0x278c68[_0x457001(0x1a0)]('latestversion')&&(_0x278c68[_0x457001(0x160)]=_0x457001(0x86),_0xca8d1f=!![]);!_0x278c68[_0x457001(0x1a0)](_0x457001(0x1d8))&&(_0x278c68[_0x457001(0x1d8)]=![],_0xca8d1f=!![]);if(_0xca8d1f)storeSettings(_0x278c68);}function storeConfiguration(_0x4cbed9){const _0x46321f=_0x367b12;dbConfig[_0x46321f(0x221)]('bots')['remove']()[_0x46321f(0x227)](),_0x4cbed9[_0x46321f(0x16f)](_0x2c9557=>{delete _0x2c9557['mode'];}),dbConfig[_0x46321f(0x221)](_0x46321f(0xa3))[_0x46321f(0x16c)](..._0x4cbed9)[_0x46321f(0x227)](),config=_0x4cbed9;}function resetPassword(){const _0x554014=_0x367b12;tgBot&&settings[_0x554014(0x122)]&&(tgBot[_0x554014(0x23b)](_0x554014(0x13e)),tgBot[_0x554014(0x1f3)](settings['telegramChatId'],_0x554014(0x1cf),{'parse_mode':_0x554014(0xee),'reply_markup':{'inline_keyboard':[[{'text':_0x554014(0x10c),'callback_data':_0x554014(0x10c)},{'text':'no','callback_data':'no'}]]}})[_0x554014(0x240)](_0x1f42fc=>{telegramError(_0x1f42fc);}),tgBot['on']('callback_query',async _0x3be52e=>{const _0x369af1=_0x554014,_0x4e81a4=_0x3be52e[_0x369af1(0xa2)],_0x455429=_0x3be52e[_0x369af1(0x232)];tgBot[_0x369af1(0xbf)](_0x3be52e['id'])[_0x369af1(0x1ba)](async()=>{const _0x2cb5b7=_0x369af1;if(_0x4e81a4!='no'){const _0x168ced=0xf,_0x42befd=_0x2cb5b7(0x218),_0x1b1e1f=Array[_0x2cb5b7(0x1f9)](crypto[_0x2cb5b7(0xde)](new Uint32Array(_0x168ced)))[_0x2cb5b7(0x164)](_0x57ea00=>_0x42befd[_0x57ea00%_0x42befd[_0x2cb5b7(0xe6)]])[_0x2cb5b7(0x21b)](''),_0x5e1b80=bcrypt[_0x2cb5b7(0x8a)](_0x1b1e1f,saltRounds);storeSettings({'bbPassword':_0x5e1b80}),await tgBot[_0x2cb5b7(0x1f3)](_0x455429[_0x2cb5b7(0x75)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x1b1e1f,{'parse_mode':_0x2cb5b7(0xee)})['catch'](_0x2a6402=>{telegramError(_0x2a6402);});}else await tgBot[_0x2cb5b7(0x1f3)](_0x455429['chat']['id'],_0x2cb5b7(0x235))[_0x2cb5b7(0x240)](_0x526842=>{telegramError(_0x526842);});}),tgBot['removeListener'](_0x369af1(0x13e));}));}async function confirmRestore(_0x5aafae,_0x3f227d){const _0x2a887f=_0x367b12;io['to'](_0x2a887f(0x1d0))[_0x2a887f(0x1e2)](_0x2a887f(0x1e3),_0x2a887f(0x1d7),_0x2a887f(0x1bc)),tgBot&&settings[_0x2a887f(0x122)]&&(tgBot[_0x2a887f(0x23b)](_0x2a887f(0x13e)),await tgBot[_0x2a887f(0x1f3)](settings[_0x2a887f(0x122)],_0x2a887f(0x23d),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x2a887f(0x10c),'callback_data':_0x2a887f(0x10c)},{'text':'no','callback_data':'no'}]]}})[_0x2a887f(0x240)](_0x482c18=>{telegramError(_0x482c18);}),tgBot['on']('callback_query',async _0x6ebc06=>{const _0x4856b1=_0x2a887f,_0x5b1cb1=_0x6ebc06[_0x4856b1(0xa2)],_0x20922e=_0x6ebc06[_0x4856b1(0x232)];tgBot['answerCallbackQuery'](_0x6ebc06['id'])[_0x4856b1(0x1ba)](async()=>{const _0x5bed5=_0x4856b1;_0x5b1cb1==_0x5bed5(0x10c)?(await tgBot[_0x5bed5(0x1f3)](_0x20922e[_0x5bed5(0x75)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x5bed5(0xee)})[_0x5bed5(0x240)](_0x58805d=>{telegramError(_0x58805d);}),unzipFile(_0x5aafae,_0x3f227d)):(logger['debug']('Restore\x20process\x20aborted'),await tgBot[_0x5bed5(0x1f3)](_0x20922e[_0x5bed5(0x75)]['id'],_0x5bed5(0x1d3))[_0x5bed5(0x240)](_0x243a6d=>{telegramError(_0x243a6d);}));}),tgBot[_0x4856b1(0x23b)]('callback_query');}));}function getServerTime(){const _0x583fa3=_0x367b12,_0x41e99c=new Date();return _0x41e99c[_0x583fa3(0x1a3)]()+'/'+(_0x41e99c['getMonth']()+0x1)[_0x583fa3(0x248)]()['padStart'](0x2,'0')+'/'+_0x41e99c[_0x583fa3(0x168)]()[_0x583fa3(0x248)]()['padStart'](0x2,'0')+'\x20'+_0x41e99c[_0x583fa3(0x12c)]()[_0x583fa3(0x248)]()['padStart'](0x2,'0')+':'+_0x41e99c[_0x583fa3(0x197)]()[_0x583fa3(0x248)]()[_0x583fa3(0xf6)](0x2,'0')+':'+_0x41e99c[_0x583fa3(0x208)]()[_0x583fa3(0x248)]()[_0x583fa3(0xf6)](0x2,'0');}function getTimeStamp(){const _0x2576bd=_0x367b12,_0x6a3c6f=shiftedTime();return _0x6a3c6f['getFullYear']()+'/'+(_0x6a3c6f[_0x2576bd(0xa0)]()+0x1)[_0x2576bd(0x248)]()['padStart'](0x2,'0')+'/'+_0x6a3c6f[_0x2576bd(0x168)]()[_0x2576bd(0x248)]()['padStart'](0x2,'0')+'\x20'+_0x6a3c6f['getHours']()[_0x2576bd(0x248)]()[_0x2576bd(0xf6)](0x2,'0')+':'+_0x6a3c6f[_0x2576bd(0x197)]()[_0x2576bd(0x248)]()[_0x2576bd(0xf6)](0x2,'0')+':'+_0x6a3c6f[_0x2576bd(0x208)]()[_0x2576bd(0x248)]()[_0x2576bd(0xf6)](0x2,'0');}function getCleanTimeStamp(){const _0x4f48fc=_0x367b12,_0x1f40ca=shiftedTime();return _0x1f40ca[_0x4f48fc(0x1a3)]()+(_0x1f40ca['getMonth']()+0x1)['toString']()[_0x4f48fc(0xf6)](0x2,'0')+_0x1f40ca[_0x4f48fc(0x168)]()[_0x4f48fc(0x248)]()[_0x4f48fc(0xf6)](0x2,'0')+'-'+_0x1f40ca['getHours']()[_0x4f48fc(0x248)]()[_0x4f48fc(0xf6)](0x2,'0')+_0x1f40ca[_0x4f48fc(0x197)]()[_0x4f48fc(0x248)]()[_0x4f48fc(0xf6)](0x2,'0')+_0x1f40ca[_0x4f48fc(0x208)]()[_0x4f48fc(0x248)]()[_0x4f48fc(0xf6)](0x2,'0');}function shiftedTime(){const _0x5be0d4=_0x367b12,_0x52797d=new Date();let _0x479823=_0x52797d;if(settings['timeshift']&&settings[_0x5be0d4(0xaa)]!==0x0)_0x479823=fns[_0x5be0d4(0x13b)](_0x52797d,{'hours':settings[_0x5be0d4(0xaa)]});return _0x479823;}function startScheduler(){const _0xc703ab=_0x367b12,_0x38137d=new Date()[_0xc703ab(0x12b)](),_0x528eb0=shiftedTime()[_0xc703ab(0x12c)]();_0x528eb0==0x4&&backupConfigFiles();_0x528eb0==0x0&&rotateLogFiles();_0x38137d%0x6==0x0&&triggerAnalytics();_0x38137d%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x5cbfb3){const _0x12fb4f=_0x367b12;logger[_0x12fb4f(0x1e8)]('Restore\x20backup\x20file\x20'+_0x5cbfb3);const _0x3a1cfa=getBotsWithMode();_0x3a1cfa[_0x12fb4f(0xe6)]>0x0?confirmRestore(configbackuppath,_0x5cbfb3):unzipFile(configbackuppath,_0x5cbfb3);}async function getBackupFiles(_0x3df362=null){const _0x264645=_0x367b12;let _0x45ea3f=[],_0x257f8c=fs[_0x264645(0x200)](configbackuppath,{'withFileTypes':!![]});_0x257f8c[_0x264645(0x236)]((_0x23e0e3,_0x2653eb)=>_0x23e0e3[_0x264645(0xe7)]<_0x2653eb[_0x264645(0xe7)]?0x1:_0x2653eb[_0x264645(0xe7)]<_0x23e0e3[_0x264645(0xe7)]?-0x1:0x0),_0x257f8c[_0x264645(0x16f)](_0x24134e=>{const _0x551de0=_0x264645;if(!_0x24134e[_0x551de0(0xbb)]()&&_0x24134e[_0x551de0(0xe7)][_0x551de0(0x20b)](_0x551de0(0x186))&&_0x24134e[_0x551de0(0xe7)][_0x551de0(0x109)]('.zip')){const _0x55b3df=formatDate(fs['statSync'](configbackuppath+_0x24134e['name'])[_0x551de0(0x1dd)]);_0x45ea3f[_0x551de0(0x16c)]({'name':_0x24134e[_0x551de0(0xe7)],'mtime':_0x55b3df});}});if(_0x3df362)io['to'](_0x3df362)[_0x264645(0x1e2)](_0x264645(0x189),_0x45ea3f);else return _0x45ea3f;}async function backupConfigFiles(){const _0x12eab6=_0x367b12;await zipFiles('backup-full');const _0x2e8edd=getCleanTimeStamp();fs[_0x12eab6(0x1b2)](zippath+_0x12eab6(0x202),configbackuppath+('backup-full@'+_0x2e8edd+_0x12eab6(0x7d)));let _0x184e06=fs[_0x12eab6(0x200)](configbackuppath,{'withFileTypes':!![]});_0x184e06['sort']((_0x45c104,_0x5df955)=>_0x45c104[_0x12eab6(0xe7)]<_0x5df955[_0x12eab6(0xe7)]?0x1:_0x5df955[_0x12eab6(0xe7)]<_0x45c104[_0x12eab6(0xe7)]?-0x1:0x0),_0x184e06[_0x12eab6(0xe6)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x184e06[maxBackups][_0x12eab6(0xe7)]);}function rotateLogFiles(){const _0x1b0755=_0x367b12,_0x4fd68e=fs[_0x1b0755(0xe0)](logspath+'output-000.log'),_0x1a925f=_0x4fd68e[_0x1b0755(0x201)]/0x400;if(_0x1a925f>0x64){let _0x1814c6=fs[_0x1b0755(0x200)](logspath,{'withFileTypes':!![]});_0x1814c6[_0x1b0755(0x236)]((_0x337e9a,_0x1635cf)=>_0x337e9a[_0x1b0755(0xe7)]<_0x1635cf[_0x1b0755(0xe7)]?0x1:_0x1635cf[_0x1b0755(0xe7)]<_0x337e9a['name']?-0x1:0x0),_0x1814c6[_0x1b0755(0x16f)](_0x1350fe=>{const _0x782794=_0x1b0755;if(_0x1350fe[_0x782794(0xe7)]==_0x782794(0xb0))fs['copyFileSync'](logspath+_0x1350fe[_0x782794(0xe7)],logspath+_0x782794(0x19c));if(_0x1350fe[_0x782794(0xe7)]=='output-001.log')fs['copyFileSync'](logspath+_0x1350fe[_0x782794(0xe7)],logspath+_0x782794(0xb0));_0x1350fe['name']==_0x782794(0x1e1)&&(fs[_0x782794(0x1b2)](logspath+_0x1350fe[_0x782794(0xe7)],logspath+_0x782794(0x1a2)),fs['writeFileSync'](logspath+_0x1350fe['name'],''));});}}async function zipFiles(_0x56860b){const _0xca1c4d=_0x367b12;let _0x2160ea;if(_0x56860b==_0xca1c4d(0x1c4))_0x2160ea=logspath;if(_0x56860b==_0xca1c4d(0xaf))_0x2160ea=configpath;if(_0x56860b==_0xca1c4d(0x10a))_0x2160ea=configpath;let _0x3d609f=fs['readdirSync'](_0x2160ea,{'withFileTypes':!![]});const _0x544b28=new require(_0xca1c4d(0x1cd))();_0x3d609f['forEach'](_0x404349=>{const _0x21d4ae=_0xca1c4d;if(!_0x404349[_0x21d4ae(0xbb)]()){let _0x2a3b07=fs[_0x21d4ae(0x1b5)](_0x2160ea+_0x404349['name']);if(_0x56860b==_0x21d4ae(0xaf)){const _0x406268=/^bot-[0-9]{3}-config.json$/,_0x1d565a=_0x406268[_0x21d4ae(0x185)](_0x404349['name']);if(_0x1d565a){const _0x3568ac=JSON[_0x21d4ae(0x198)](_0x2a3b07);if(_0x3568ac[_0x21d4ae(0xa8)][0x0]){_0x3568ac[_0x21d4ae(0xa8)][0x0][_0x21d4ae(0x15e)]=_0x21d4ae(0x136),_0x3568ac[_0x21d4ae(0xa8)][0x0][_0x21d4ae(0xdd)]=_0x21d4ae(0x136);if(_0x3568ac[_0x21d4ae(0xa8)][0x0][_0x21d4ae(0x7c)])_0x3568ac[_0x21d4ae(0xa8)][0x0][_0x21d4ae(0x7c)]='***';}_0x2a3b07=JSON[_0x21d4ae(0x18b)](_0x3568ac,null,0x2);}if(_0x404349[_0x21d4ae(0xe7)]==_0x21d4ae(0x1c2)){const _0x13bfa9=JSON[_0x21d4ae(0x198)](_0x2a3b07);if(_0x13bfa9['settings']['loginRequired'])_0x13bfa9[_0x21d4ae(0x84)][_0x21d4ae(0x156)]=![];if(_0x13bfa9['settings'][_0x21d4ae(0x71)])_0x13bfa9[_0x21d4ae(0x84)][_0x21d4ae(0x71)]='***';if(_0x13bfa9[_0x21d4ae(0x84)][_0x21d4ae(0x158)])_0x13bfa9[_0x21d4ae(0x84)][_0x21d4ae(0x158)]=_0x21d4ae(0x136);if(_0x13bfa9[_0x21d4ae(0x84)][_0x21d4ae(0x122)])_0x13bfa9[_0x21d4ae(0x84)]['telegramChatId']=null;_0x2a3b07=JSON[_0x21d4ae(0x18b)](_0x13bfa9,null,0x2);}if(_0x404349[_0x21d4ae(0xe7)]!=_0x21d4ae(0x1dc))_0x544b28[_0x21d4ae(0x1ce)](_0x404349[_0x21d4ae(0xe7)],_0x2a3b07);}else _0x544b28[_0x21d4ae(0x1ce)](_0x404349[_0x21d4ae(0xe7)],_0x2a3b07);}});const _0x7ca691=_0x544b28[_0xca1c4d(0x81)]({'base64':![],'compression':_0xca1c4d(0x15f)});fs[_0xca1c4d(0x23c)](zippath+(_0x56860b+_0xca1c4d(0x7d)),_0x7ca691,_0xca1c4d(0xa5));}async function unzipFile(_0x5155ce,_0x58349f){const _0x2fbc9f=_0x367b12;fs[_0x2fbc9f(0x200)](configpath,{'withFileTypes':!![]})[_0x2fbc9f(0x16f)](_0x52f582=>{const _0x5f15af=_0x2fbc9f;if(!_0x52f582[_0x5f15af(0xbb)]())fs['rmSync'](configpath+_0x52f582['name']);});const _0xba1e83=fs[_0x2fbc9f(0x1b5)](_0x5155ce+_0x58349f,_0x2fbc9f(0xa5)),_0x2856cc=new require(_0x2fbc9f(0x1cd))(_0xba1e83,{'base64':![],'checkCRC32':!![]});Object[_0x2fbc9f(0x9a)](_0x2856cc[_0x2fbc9f(0x1ac)])['forEach'](_0x5b7c6f=>{const _0x64170=_0x2fbc9f,_0x5adfd3=_0x2856cc[_0x64170(0x1ac)][_0x5b7c6f];fs[_0x64170(0x23c)](configpath+_0x5adfd3['name'],_0x5adfd3['_data']);}),fs[_0x2fbc9f(0x200)](temppath,{'withFileTypes':!![]})[_0x2fbc9f(0x16f)](_0x150dbe=>{const _0x216925=_0x2fbc9f;if(!_0x150dbe[_0x216925(0xbb)]())fs[_0x216925(0x199)](temppath+_0x150dbe['name']);}),logger[_0x2fbc9f(0x1e8)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x2fbc9f(0x99)]({'restore':!![]},_0x395e03=>{});}async function getPublicIp(){const _0x10edf6=_0x367b12;try{const _0x2ac35b=await axios['get'](_0x10edf6(0x1aa));publicip=_0x2ac35b['data']['ip'];}catch(_0x4a561b){}}async function triggerAnalytics(){const _0x3bc7f2=_0x367b12;if(!publicip)await getPublicIp();const _0x3ca186=getBotsWithMode();let _0xb83284=0x0;_0x3ca186[_0x3bc7f2(0x16f)](_0x15fdb0=>{const _0x4ad690=_0x3bc7f2;if(_0x15fdb0[_0x4ad690(0x134)]===_0x4ad690(0x85))_0xb83284++;});const _0x473ea1=getBotExchanges();mixpanel[_0x3bc7f2(0x95)](_0x3bc7f2(0x1d2),{'distinct_id':settings[_0x3bc7f2(0x6c)],'ip':publicip,'version':serverversion,'numbots':_0x3ca186[_0x3bc7f2(0xe6)],'numbotsenabled':_0xb83284,'exchanges':_0x473ea1});}async function getMessages(){const _0x2513c6=_0x367b12,_0x2f93b3='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x54318b=new GraphQLClient(_0x2f93b3),_0x162902={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x238010=serverversion[_0x2513c6(0x1c5)]('.'),_0x371897=_0x238010[0x0]+'.'+_0x238010[0x1],_0x27789e=Math['min'](settings[_0x2513c6(0x171)],settings[_0x2513c6(0xc8)]),_0x4718c8={'last':parseInt(_0x27789e),'bbm':_0x371897},_0x1aaff4=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4feced;try{_0x4feced=await _0x54318b[_0x2513c6(0x230)](_0x1aaff4,_0x4718c8,_0x162902);}catch(_0x466b03){}if(_0x4feced&&_0x4feced['messages']){let _0x52f9e3=settings[_0x2513c6(0x171)];newMessages=[];for(const _0x480c71 of _0x4feced[_0x2513c6(0x211)]){newMessages[_0x2513c6(0x16c)](_0x480c71);if(_0x480c71['bbvNew'])updateSetting(_0x2513c6(0x160),_0x480c71[_0x2513c6(0x9d)]);let _0x207a8c=_0x480c71[_0x2513c6(0x9d)]?serverversion>=_0x480c71[_0x2513c6(0x9d)]:![];if(!_0x207a8c&&_0x480c71[_0x2513c6(0xe5)]>_0x52f9e3){if(_0x480c71[_0x2513c6(0x117)]===_0x2513c6(0x123)||serverversion['startsWith'](_0x480c71[_0x2513c6(0x117)])){let _0x361fe9=''+_0x480c71[_0x2513c6(0x110)]+'\x0a\x0a'+_0x480c71[_0x2513c6(0x232)];const _0x419d2f=await sendTelegramMsg(toTelegramMarkdown(_0x361fe9),_0x2513c6(0x206));if(_0x419d2f)_0x52f9e3=_0x480c71[_0x2513c6(0xe5)];}}}updateAvailable=isNewerVersion(settings[_0x2513c6(0x160)],serverversion),updateSetting('lastmsgtelegram',_0x52f9e3),emitMessages();}}function emitMessages(){const _0x58a22c=_0x367b12,_0x2b07c1=settings['lastmsgemitted'];let _0x2a5190=[];newMessages[_0x58a22c(0x16f)](_0x474a14=>{const _0x2799ba=_0x58a22c;_0x474a14['number']>_0x2b07c1&&_0x2a5190[_0x2799ba(0x16c)](_0x474a14);}),_0x2a5190[_0x58a22c(0xe6)]>0x0&&getAllClients()[_0x58a22c(0x16f)](_0x1063ab=>{const _0x3d809d=_0x58a22c;getSocket(_0x1063ab['id'])['emit'](_0x3d809d(0x232),_0x2a5190);});}function confirmMessage(_0x5e21c8){updateSetting('lastmsgemitted',Number(_0x5e21c8));}function isNewerVersion(_0x55e72c,_0x3b0ccb){const _0x57bcd8=_0x367b12,_0x215fa4=_0x3b0ccb[_0x57bcd8(0x1c5)]('.'),_0x5a412a=_0x55e72c[_0x57bcd8(0x1c5)]('.');for(var _0x4fc46a=0x0;_0x4fc46a<_0x5a412a['length'];_0x4fc46a++){const _0x36c227=~~_0x5a412a[_0x4fc46a],_0x9aa5b4=~~_0x215fa4[_0x4fc46a];if(_0x36c227>_0x9aa5b4)return!![];if(_0x36c227<_0x9aa5b4)return![];}return![];}function toTelegramMarkdown(_0x336df0){const _0x4159fb=_0x367b12,_0xd083c9=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4413cf=/\*{2}(.+?)\*{2}/gim;return _0x336df0=_0x336df0[_0x4159fb(0xc2)](_0xd083c9,_0x4159fb(0x187))[_0x4159fb(0xc2)](_0x4413cf,_0x4159fb(0xb5)),_0x336df0;}async function validateConfigFile(){const _0x59da8a=_0x367b12,_0x44d1b0=dbConfig['get'](_0x59da8a(0xa3))[_0x59da8a(0x146)](_0x59da8a(0xca))[_0x59da8a(0x1f8)]()||[];if(_0x44d1b0[_0x59da8a(0xe6)]==0x0){let _0xd5c3af=0x0,_0x530a82=[];const _0x17ab4a=/^bot-([0-9]{3})-config.json$/,_0x1c5284=fs['readdirSync'](configpath);_0x1c5284[_0x59da8a(0x16f)](_0x1acc52=>{const _0x4a8d5f=_0x59da8a,_0x2d21c4=_0x17ab4a[_0x4a8d5f(0x1b0)](_0x1acc52);if(_0x2d21c4){const _0x267ab5=_0x2d21c4[0x1];let _0x420ee8=getBotAttributes(_0x267ab5);_0x530a82['push']({'botID':_0x267ab5,'botname':_0x420ee8[_0x4a8d5f(0x203)],'status':_0x4a8d5f(0xb3),'live':_0x4a8d5f(0x106)}),_0xd5c3af++;}}),_0xd5c3af!=0x0&&(dbConfig['get']('bots')[_0x59da8a(0xad)](_0x530a82)[_0x59da8a(0x227)](),config=_0x530a82,restoredConfigFile=_0xd5c3af);}}async function restoreConfigNotify(_0x4c8508){const _0x9bb211=_0x367b12;let _0x4ac816;if(restoredConfigFile==0x1)_0x4ac816=_0x9bb211(0x17e);else _0x4ac816=_0x9bb211(0x90);if(_0x4c8508)io['to']('botmanager')[_0x9bb211(0x1e2)](_0x9bb211(0x1e3),_0x4ac816);else{logger[_0x9bb211(0x1a6)](_0x9bb211(0xcb)),logger[_0x9bb211(0x1a6)](_0x4ac816),logger['simple'](_0x9bb211(0xcb)),logger['simple']('');if(tgBot&&settings[_0x9bb211(0x122)]&&settings['telegramEvents']!=_0x9bb211(0x107))tgBot[_0x9bb211(0x1f3)](settings[_0x9bb211(0x122)],_0x9bb211(0x14d)+_0x4ac816)[_0x9bb211(0x240)](_0x2129ee=>{telegramError(_0x2129ee);});}}function validateCredentials(_0x12cc4e,_0x5ec3c3){const _0x30432a=_0x367b12;if(_0x12cc4e[_0x30432a(0x21a)]==settings['bbUsername']&&bcrypt[_0x30432a(0xc5)](_0x12cc4e['password'],settings[_0x30432a(0x71)])){if(settings[_0x30432a(0x246)])return{'allow':![],'reason':_0x30432a(0x1d9),'token':null};else{const _0x54dc9f=generateLoginToken(_0x5ec3c3);return{'allow':!![],'reason':_0x30432a(0x120),'token':_0x54dc9f};}}else return{'allow':![],'reason':_0x30432a(0x20f),'token':null};}function refreshToken(_0x38efd7){const _0x1beaa3=_0x367b12,_0x5a6c6e=generateLoginToken(_0x38efd7);return{'allow':!![],'reason':_0x1beaa3(0x120),'token':_0x5a6c6e};}function validateAccess(_0xa95057,_0x2d4f45,_0x51c61c){const _0x422b06=_0x367b12,_0x5b86d1=_0x51c61c?_0x51c61c:devices[_0x2d4f45]['ip'];let _0x9f68e3;const _0x378710=_0x103b4e=>{const _0xf225bc=_0x1253;if(settings['loginRequired']){if(settings[_0xf225bc(0x246)]){if(telegram2FaApproved(_0x2d4f45)){const _0x18d4c1=generateLoginToken(_0x2d4f45);return{'allow':!![],'reason':_0xf225bc(0x73),'token':_0x18d4c1};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x9f68e3=validToken(_0x103b4e,_0x2d4f45),_0x9f68e3[_0xf225bc(0x1a0)](_0xf225bc(0x1bc))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x103b4e}:{'allow':![],'reason':_0xf225bc(0x131),'token':null};}else return{'allow':!![],'reason':_0xf225bc(0x207),'token':null};};if(settings[_0x422b06(0x8c)]){let _0x492a7d=[...settings['whitelist'],_0x422b06(0xf1),_0x422b06(0x74),_0x422b06(0x172)];if(_0x492a7d['includes'](_0x5b86d1))return _0x378710(_0xa95057);else{_0x9f68e3=validToken(_0xa95057,_0x2d4f45);if(_0x9f68e3[_0x422b06(0x1a0)](_0x422b06(0x1bc)))return _0x378710(_0xa95057);else{if(telegramIpApproved(_0x2d4f45)){const _0x1a7931=generateToken(_0x2d4f45);return _0x9f68e3=_0x378710(_0xa95057),_0x9f68e3[_0x422b06(0x145)]?{'allow':!![],'reason':_0x422b06(0x162),'token':_0x1a7931}:_0x9f68e3;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x422b06(0x82),'token':null}:{'allow':![],'reason':_0x422b06(0x23f),'token':null};}}}else return _0x378710(_0xa95057);}function timelyDecrypt(_0x121693,_0x4a33c2=!![]){const _0x493c44=_0x367b12;if(_0x121693)try{const _0x348f07=crypt[_0x493c44(0xe1)](secure[_0x493c44(0x14a)],_0x121693)['message'],_0x51d10d=_0x348f07[_0x493c44(0x1c5)]('@')[0x0],_0x208674=_0x348f07['split']('@')[0x1],_0x54ca09=new Date()[_0x493c44(0x18f)]();if(_0x4a33c2){if(_0x54ca09-_0x208674<maxSecretAge*0x3e8)return _0x51d10d;else return![];}else return _0x51d10d;}catch(_0x4d4724){return![];}else return![];}const validToken=(_0x4a1fa4,_0x1735fb)=>{const _0x196b7f=_0x367b12,_0x1fe9b4=devices[_0x1735fb]['ip'];if(!_0x4a1fa4)return{'error':_0x196b7f(0x188)};for(let _0x58473c of blacklist){if(_0x58473c[_0x196b7f(0x233)]==_0x4a1fa4)return{'error':_0x196b7f(0x217)};}let _0x27a629;try{_0x27a629=jwt[_0x196b7f(0x1a8)](_0x4a1fa4,secure[_0x196b7f(0xd7)]+_0x1735fb);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x27a629[_0x196b7f(0x1a0)](_0x196b7f(0xb6))&&!_0x27a629['hasOwnProperty'](_0x196b7f(0x21a))||!_0x27a629[_0x196b7f(0x1a0)](_0x196b7f(0x70)))return{'error':_0x196b7f(0x224)};if(!_0x27a629[_0x196b7f(0x1a0)](_0x196b7f(0x21a))&&_0x27a629[_0x196b7f(0x1a0)](_0x196b7f(0xb6))){const {clientip:_0x5d953b}=_0x27a629;return _0x1fe9b4==_0x5d953b?{'success':_0x196b7f(0x194)}:{'error':_0x196b7f(0x13f)};}else{if(_0x27a629[_0x196b7f(0x1a0)](_0x196b7f(0x21a))&&_0x27a629[_0x196b7f(0x1a0)](_0x196b7f(0xb6))){const {username:_0x731089,clientip:_0x4f9e3f}=_0x27a629;return settings[_0x196b7f(0xc3)]==_0x731089&&_0x1fe9b4==_0x4f9e3f?{'success':_0x196b7f(0x194)}:{'error':_0x196b7f(0x102)};}}},generateLoginToken=_0x1e2d06=>{const _0x9a5fa6=_0x367b12;if(_0x1e2d06){const _0x757d59=devices[_0x1e2d06]['ip'];return jwt[_0x9a5fa6(0x10b)]({'username':settings[_0x9a5fa6(0xc3)],'clientip':_0x757d59},secure[_0x9a5fa6(0xd7)]+_0x1e2d06,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x2dab37=>{const _0x24a408=_0x367b12;if(_0x2dab37){const _0x1f6d61=devices[_0x2dab37]['ip'];return jwt['sign']({'clientip':_0x1f6d61},secure[_0x24a408(0xd7)]+_0x2dab37,{'expiresIn':devices[_0x2dab37][_0x24a408(0xba)][_0x24a408(0x215)]*0x3c});}else return![];},telegramIpApproved=_0x3fa832=>{const _0x1c7097=_0x367b12;let _0x1ca449=![];return devices[_0x3fa832][_0x1c7097(0xba)]&&devices[_0x3fa832][_0x1c7097(0xba)][_0x1c7097(0x215)]!=_0x1c7097(0x1e5)&&(_0x1ca449=devices[_0x3fa832][_0x1c7097(0xba)]['clientip']==devices[_0x3fa832]['ip']&&new Date()[_0x1c7097(0x18f)]()-devices[_0x3fa832][_0x1c7097(0xba)][_0x1c7097(0xe2)]<devices[_0x3fa832][_0x1c7097(0xba)]['expiry']*0x3c*0x3e8),_0x1ca449;},telegram2FaApproved=_0x312080=>{const _0x1d4275=_0x367b12;let _0x4f3802=![];return devices[_0x312080][_0x1d4275(0x1db)]&&devices[_0x312080][_0x1d4275(0x1db)][_0x1d4275(0x215)]!=_0x1d4275(0x1e5)&&(_0x4f3802=devices[_0x312080][_0x1d4275(0x1db)][_0x1d4275(0xb6)]==devices[_0x312080]['ip']&&new Date()[_0x1d4275(0x18f)]()-devices[_0x312080][_0x1d4275(0x1db)][_0x1d4275(0xe2)]<devices[_0x312080][_0x1d4275(0x1db)]['expiry']*0x3c*0x3e8),_0x4f3802;},normalizeIP=_0x2f7887=>{const _0x9997e5=_0x367b12;let _0x3ae351=null,_0x39a456=null;if(ipaddr[_0x9997e5(0x21c)](_0x2f7887)){const _0x7c233d=ipaddr[_0x9997e5(0x198)](_0x2f7887);_0x7c233d[_0x9997e5(0x147)]()==='ipv6'?(_0x7c233d['isIPv4MappedAddress']()&&(_0x3ae351=_0x7c233d[_0x9997e5(0xef)]()[_0x9997e5(0x248)]()),_0x39a456=_0x7c233d[_0x9997e5(0x248)]()):(_0x3ae351=_0x7c233d[_0x9997e5(0x248)](),_0x39a456=_0x7c233d['toIPv4MappedAddress']()[_0x9997e5(0x248)]());}return{'show':_0x3ae351?_0x3ae351:_0x39a456,'store':_0x39a456};};function formatDate(_0x935fab){const _0xbafcb3=_0x367b12;return _0x935fab[_0xbafcb3(0x1a3)]()+'/'+(_0x935fab[_0xbafcb3(0xa0)]()+0x1)['toString']()[_0xbafcb3(0xf6)](0x2,'0')+'/'+_0x935fab[_0xbafcb3(0x168)]()[_0xbafcb3(0x248)]()[_0xbafcb3(0xf6)](0x2,'0')+'\x20'+_0x935fab[_0xbafcb3(0x12c)]()[_0xbafcb3(0x248)]()[_0xbafcb3(0xf6)](0x2,'0')+':'+_0x935fab[_0xbafcb3(0x197)]()[_0xbafcb3(0x248)]()[_0xbafcb3(0xf6)](0x2,'0')+':'+_0x935fab[_0xbafcb3(0x208)]()['toString']()[_0xbafcb3(0xf6)](0x2,'0');}function sleep(_0x4d53bf){return new Promise(_0xf9b8cf=>setTimeout(_0xf9b8cf,_0x4d53bf));}