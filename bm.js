const _0x2b9903=_0x11f2;(function(_0x3c5f3e,_0x53dadc){const _0x230135=_0x11f2,_0x35e552=_0x3c5f3e();while(!![]){try{const _0x2f1472=parseInt(_0x230135(0x182))/0x1*(-parseInt(_0x230135(0x2c6))/0x2)+-parseInt(_0x230135(0x2c5))/0x3+parseInt(_0x230135(0x2aa))/0x4*(parseInt(_0x230135(0x225))/0x5)+-parseInt(_0x230135(0x2a3))/0x6*(-parseInt(_0x230135(0x1cf))/0x7)+parseInt(_0x230135(0x249))/0x8+parseInt(_0x230135(0x2c7))/0x9*(parseInt(_0x230135(0x17d))/0xa)+-parseInt(_0x230135(0x248))/0xb*(parseInt(_0x230135(0x22a))/0xc);if(_0x2f1472===_0x53dadc)break;else _0x35e552['push'](_0x35e552['shift']());}catch(_0x2dd15f){_0x35e552['push'](_0x35e552['shift']());}}}(_0x45de,0x3fcfa));const _0x1f13a3=function(){let _0x56aa26=!![];return function(_0x14cf6b,_0x51961b){const _0x25bdd2=_0x56aa26?function(){if(_0x51961b){const _0x3cd72c=_0x51961b['apply'](_0x14cf6b,arguments);return _0x51961b=null,_0x3cd72c;}}:function(){};return _0x56aa26=![],_0x25bdd2;};}(),_0x53d051=_0x1f13a3(this,function(){const _0x4ba414=_0x11f2;return _0x53d051['toString']()['search'](_0x4ba414(0x306))['toString']()[_0x4ba414(0x18a)](_0x53d051)[_0x4ba414(0x29f)](_0x4ba414(0x306));});_0x53d051();'use strict';function _0x11f2(_0x57bcbd,_0x569bd0){const _0x55ef98=_0x45de();return _0x11f2=function(_0x53d051,_0x1f13a3){_0x53d051=_0x53d051-0x162;let _0x45de1a=_0x55ef98[_0x53d051];return _0x45de1a;},_0x11f2(_0x57bcbd,_0x569bd0);}process[_0x2b9903(0x273)][_0x2b9903(0x268)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x2b9903(0x16a)),low=require(_0x2b9903(0x256)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x2b9903(0x1d0)),crypto=require(_0x2b9903(0x260)),Crypt=require(_0x2b9903(0x241))[_0x2b9903(0x1b7)],RSA=require(_0x2b9903(0x241))[_0x2b9903(0x179)],bcrypt=require(_0x2b9903(0x255)),jwt=require(_0x2b9903(0x322)),ipaddr=require(_0x2b9903(0x257)),argv=require('yargs/yargs')(process[_0x2b9903(0x1e5)][_0x2b9903(0x16b)](0x2))[_0x2b9903(0x1e5)],uuidRandom=require('uuid-random'),TelegramBot=require(_0x2b9903(0x2b9)),Mixpanel=require('mixpanel'),axios=require(_0x2b9903(0x166)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x2b9903(0x316)),fileUpload=require('express-fileupload'),PORT=argv[_0x2b9903(0x2f6)]||_0x2b9903(0x2f8),pattern=/^[0-9]{2,4}$/;!pattern[_0x2b9903(0x2cf)](PORT)&&(console['log']('Error:\x20Invalid\x20argument\x20'+PORT+_0x2b9903(0x1c3)),process[_0x2b9903(0x199)](0x1));const HOST=argv[_0x2b9903(0x25a)]||null,userID=argv[_0x2b9903(0x2bf)]||'',debugging=argv['d']||![];let bbpath=_0x2b9903(0x28f),bbpath2='';const botfile=_0x2b9903(0x317),configfile=_0x2b9903(0x2dd),settingsfile=_0x2b9903(0x2c4),securefile=_0x2b9903(0x1cd),maxBackups=0xa;let validInstallation=!![];!fs[_0x2b9903(0x27f)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x2b9903(0x1ed)),configpath=userID?bbpath+_0x2b9903(0x2ca)+userID+'/':bbpath+_0x2b9903(0x2ca),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x2b9903(0x207)+userID+'/':bbpath+_0x2b9903(0x207),zippath=userID?bbpath+_0x2b9903(0x240)+userID+'/':bbpath+_0x2b9903(0x240),loggerfile=fs[_0x2b9903(0x2e9)](logspath+_0x2b9903(0x250),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x2b9903(0x2ee);!fs[_0x2b9903(0x27f)](configpath)&&fs[_0x2b9903(0x2db)](configpath);!fs[_0x2b9903(0x27f)](configbackuppath)&&fs[_0x2b9903(0x2db)](configbackuppath);!fs[_0x2b9903(0x27f)](logspath)&&fs[_0x2b9903(0x2db)](logspath);!fs[_0x2b9903(0x27f)](zippath)&&fs[_0x2b9903(0x2db)](zippath);!fs[_0x2b9903(0x27f)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2b9903(0x27b)]({'bots':[]})[_0x2b9903(0x292)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![]}})[_0x2b9903(0x292)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x2b9903(0x292)]();let crypt=new Crypt({'md':_0x2b9903(0x280),'rsaStandard':_0x2b9903(0x1ab)});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x2b9903(0x2fa),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x2b9903(0x299)]&&settings['telegramToken']!=''&&settings[_0x2b9903(0x1d9)]&&settings[_0x2b9903(0x1d9)]!='')initTelegram();const logger={'screen':_0x544ddf=>{const _0x11e185=_0x2b9903;console[_0x11e185(0x1f2)](_0x544ddf);},'simple':_0x2e94d8=>{const _0x26fd11=_0x2b9903;console['log'](_0x2e94d8),loggerfile[_0x26fd11(0x292)](util['format'](_0x2e94d8)+'\x0a');},'full':async _0x54162c=>{const _0x48173c=_0x2b9903,_0xe4aecc=getTimeStamp()+_0x48173c(0x27d)+_0x54162c;console['log'](_0xe4aecc),loggerfile['write'](util[_0x48173c(0x1ec)](_0xe4aecc)+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x48173c(0x2d4)]!='orders')await tgBot[_0x48173c(0x2c9)](settings['telegramChatId'],_0x48173c(0x21c)+_0x54162c)[_0x48173c(0x1f7)](_0xce062c=>{telegramError(_0xce062c);});},'debug':async(_0x263eff,_0x513d40='')=>{const _0x4be677=_0x2b9903,_0x332a80=getTimeStamp()+_0x4be677(0x2de)+_0x263eff;if(debugging)console[_0x4be677(0x1f2)](_0x332a80);loggerfile['write'](util[_0x4be677(0x1ec)](_0x332a80)+'\x0a');if(_0x513d40){if(debugging)console[_0x4be677(0x1f2)](_0x513d40);loggerfile['write'](util[_0x4be677(0x1ec)](_0x513d40)+'\x0a');}}};process['on'](_0x2b9903(0x165),function(_0x1ea686){logger['simple'](_0x1ea686);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;function _0x45de(){const _0x4cdefc=['Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','exp','chat','tkn','isDirectory','http','::1','-events.json','Unauthorized\x20attempt\x20to\x20download\x20','ipc','split',',\x20must\x20be\x20a\x204\x20digit\x20number','No\x20authentication\x20token','All\x20bots\x20running\x20right\x20now','data','toggle-bot-mode','get-messages','socket','entries','keys','2FA\x20login\x20token\x20generated','bb-secure.json','apiKey','4634GEUjnG','path','toString','getUTCHours','temporary\x20token\x20generated','number','Unauthorized\x20attempt\x20to\x20log\x20out','compareSync','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','backup','telegramUsername','Starting\x20Balance\x20Bot\x20','mode','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','loginRequired','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','padStart','getStartingBalances','headers','logout','getHours','type','argv','referer','getMinutes','match','bot-','generate','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','format','clients','show','\x20minutes','statSync','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','log','accept','bots','static','Access\x20enabled\x20for\x20','catch','file','token','***','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','-results.json','Starting\x20Balance\x20Bot\x20reinstallation','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','index.html','Invalid\x20Telegram\x20token','logged\x20out','botID','telegrammsg','latestversion','map','************','logs/','<b>Telegram\x20Bot\x20Status:</b>\x0a','Restarting\x20Bot\x20','Starting\x20Balance\x20Bot\x20update','Backup\x20file\x20unzipped\x20and\x20stored','deleteHistoryAlerts','Login\x20accepted','sendPortfolioTelegram','enabled','error','join','temporary\x20access\x20not\x20allowed','settings.','Login\x20rejected','sortBy','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Notifications\x20enabled\x0a','updatebotmanager','Session\x20expired\x20for\x20user\x20...','/:bot/history','output-001.log','Bot\x20Mgr\x20>\x20','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','2FA','conn','lastmsgemitted','userid','disabled','telegramIpApproval','forEach','30VzebnZ','Ok,\x20will\x20send\x20alert\x20notifications\x20only','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Deleted\x20Bot\x20','event','1032LCermm','apiSecret','getPortfolio','get-portfolio','Starting\x20bot\x20|\x20Bot\x20','alerts','randomFillSync','order','secret','/:bot/configuration','filter','remove','removeListener','-----------------------------------------------------------------------------------','length','/:bot/portfolio','Allow\x20login\x20from\x20IP\x20address\x20<b>','getTime','Unauthorized\x20login\x20attempt\x20(timeout)','bot','get','exchange','zip/','hybrid-crypto-js','new-disabled','backup-full@','\x20(2)','then','reload','Unauthorized\x20attempt\x20to\x20get\x20portfolio','9427Islbvh','378584FGkTNR','telegram','Markdown','Restoring\x20bot(s)\x20from\x20backup','get-backup-files','function','isIPv4MappedAddress','/output-000.log','getSeconds','answerCallbackQuery','5\x20min','reason','bcryptjs','lowdb','ipaddr.js','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','onepagemode','host','update-bb','Invalid\x20authentication\x20token\x20(2)','access','/off\x20-\x20stop\x20bot(s)\x0a','exec','crypto','listen','</b>\x20?','sign','started','inherit','output-002.log','reinstall','NTBA_FIX_319','server','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Restore\x20process\x20aborted','show-config','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','includes','encryptedUuid','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','placeOrder','temporary\x20access\x20rejected','env','track','Error\x20while\x20deleting\x20config\x20files:\x20','yes','decrypt','connected','-config.json','cancel-loading','defaults','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run',':\x20Bot\x20Mgr\x20>\x20','node-zip','existsSync','sha256','.zip','botmanager','message','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','get-starting-balances','build','pidRefreshToken','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Bot\x20','getDate','rmSync','getMonth','update','sockets','bb/','Unauthorized\x20attempt\x20to\x20show\x20configuration','readdirSync','write','stopPolling','delete-bot','any','clientip','backup-full.zip','replace','telegramToken','User\x20has\x20been\x20validated','HTML','telegramChatId','unlinkSync','expiry','search','File\x20uploaded','30\x20min','bbvNew','3792aEGcZx','warning','download','new','secure','push','access\x20timeout','44128AuWgFl','Alerts','reinstall-bb','notification','/on\x20-\x20start\x20bot(s)\x0a','size','uuid','Yes','store-settings','settings','files','output-003.log','blacklist','_data','running','node-telegram-bot-api','cancelLoading','mtime','output-000.log','bbPassword','publicKey','user','Unauthorized\x20attempt\x20to\x20update\x20bot','stop','socket.io','allow','bb-settings.json','34914oldZzM','922cbpcli','4527ejjyxC','Unauthorized\x20attempt\x20to\x20confirm\x20message','sendMessage','config/','status','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','login\x20required','test','reset-password','randomBytes','orders','404\x20Not\x20Found','telegramEvents','kind','sort','createServer','Your\x20installation\x20is\x20already\x20up\x20to\x20date','set','bbUsername','mkdirSync','2FA\x20login\x20required','bb-config.json',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','manual','whitelistEnabled','request','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','removeAllListeners','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','\x20|\x20','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','hasOwnProperty','login\x20not\x20required','createWriteStream','Unauthorized\x20attempt\x20to\x20store\x20configuration','Failed\x20to\x20download\x20','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Disabled\x20Bot\x20','temp/','login','-performance.json','build2','storeConfiguration','Ok,\x20will\x20send\x20order\x20notifications\x20only','reset-history','All\x20bots','port','stringify','3000','bbvReceive','6b67f3d61ee94b8f5c80b4affef4c4d9','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Invalid\x20authentication\x20token\x20(1)','debug','storeHeadless','2FA\x20required','title','privateKey','username','No\x20bots\x20running\x20right\x20now','ipv6','$1_$2_$3','(((.+)+)+)+$','login\x20token\x20valid','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','toggleBotMode','Enabled\x20Bot\x20','min','/:bot/support','temporary\x20access\x20timeout','cloneDeep','Password\x20has\x20been\x20reset\x20to:\x20','callback_query','delete-alerts','SIGTERM','resetHistory','temporaryAccessAllowed','name','util','bot.js','all','https://api.ipify.org?format=json','Unauthorized\x20attempt\x20to\x20delete\x20bot','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','backup-full','confirm-message','reject','sendFile','password','auto','jsonwebtoken','getFullYear','success','onText','Logged\x20out\x20user\x20...','live','uncaughtException','axios','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','remoteAddress','date-fns','slice','telegram2FaApproval','use','127.0.0.1','emit','endsWith','value','timestamp','update-bot','kill','stopped','invalid\x20credentials','/disable\x20-\x20disable\x20notifications\x0a','parse','RSA','login\x20token\x20generated','Token\x20blacklisted','2FA\x20login\x20rejected','5410NzrVDB','Password\x20reset\x20rejected','store','/names\x20-\x20show\x20bot\x20names\x0a','storeFiat','992eJzMzx','Server','Invalid\x20username\x20or\x20IP\x20address','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','/upload-backup','full','add','connection','constructor','Notifications\x20enabled','writeFileSync','timeshift',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','hex','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','\x20to\x20','args','f2aRequired','1000','Unauthorized\x20attempt\x20to\x20update\x20settings','showname','\x20>\x20','auth','exit','pidExpireLogin','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','startsWith','toIPv4MappedAddress','readFileSync','headless','simple','botname','express','from','alias','15\x20min','disconnect','copyFileSync','binary','telegramEnabled','fork','RSA-OAEP','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','assign','send','find','/:bot/coins','Restore\x20backup\x20file\x20','SIGINT','lastmsgtelegram','Notifications\x20types:\x20','Idling\x20bot\x20\x20\x20|\x20Bot\x20','Crypt'];_0x45de=function(){return _0x4cdefc;};return _0x45de();}let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x2b9903(0x1a2)),app=express(),http=require(_0x2b9903(0x1bd))[_0x2b9903(0x2d7)](app);app[_0x2b9903(0x16d)](fileUpload({'useTempFiles':!![]})),app[_0x2b9903(0x23e)]('/download/:type',async(_0x435b85,_0x18b76f)=>{const _0x1d1519=_0x2b9903,_0x227ac8=_0x435b85['params']['type'],_0xecdb51=getClientsWithBotID(_0x1d1519(0x282)),_0x372a87=_0x435b85[_0x1d1519(0x1e1)][_0x1d1519(0x2b0)],_0x7dc52a=timelyDecrypt(_0x372a87,![]),_0x25ae46=_0xecdb51[_0x1d1519(0x1b0)](_0x11ca8f=>_0x11ca8f['uuid']==_0x7dc52a);if(_0x25ae46){const _0x58be49=normalizeIP(_0x435b85[_0x1d1519(0x1c9)][_0x1d1519(0x169)])[_0x1d1519(0x17f)],_0x28b827=_0x435b85['headers'][_0x1d1519(0x1bb)];if(validateAccess(_0x28b827,_0x7dc52a,_0x58be49)[_0x1d1519(0x2c3)])_0x227ac8==_0x1d1519(0x1d8)&&await backupConfigFiles(),await zipFiles(_0x227ac8),_0x18b76f[_0x1d1519(0x2a5)](zippath+(_0x227ac8+_0x1d1519(0x281)),_0x583f1d=>{const _0x35be8f=_0x1d1519;_0x583f1d&&(logger[_0x35be8f(0x187)](_0x35be8f(0x2eb)+_0x227ac8),logger[_0x35be8f(0x1a0)](_0x583f1d));});else logger[_0x1d1519(0x187)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x227ac8+'\x20(1)');}else logger[_0x1d1519(0x187)](_0x1d1519(0x1c0)+_0x227ac8+_0x1d1519(0x244));}),app['post'](_0x2b9903(0x186),async(_0x195a37,_0x5bf300)=>{const _0x38887d=_0x2b9903,_0x16d8c9=getClientsWithBotID(_0x38887d(0x282)),_0x38e2f1=_0x195a37['headers']['uuid'],_0x5de945=timelyDecrypt(_0x38e2f1,![]),_0x524566=_0x16d8c9[_0x38887d(0x1b0)](_0x4746c3=>_0x4746c3['uuid']==_0x5de945);logger[_0x38887d(0x2fd)]('Backup\x20file\x20uploaded');if(_0x524566){const _0x2bc53f=normalizeIP(_0x195a37[_0x38887d(0x1c9)]['remoteAddress'])[_0x38887d(0x17f)],_0x37af6e=_0x195a37[_0x38887d(0x1e1)][_0x38887d(0x1bb)];if(validateAccess(_0x37af6e,_0x5de945,_0x2bc53f)['allow']){if(_0x195a37[_0x38887d(0x2b4)]){const _0x2d866c=_0x195a37[_0x38887d(0x2b4)]['backupfile'];await _0x2d866c['mv'](temppath+_0x2d866c[_0x38887d(0x315)]),_0x5bf300[_0x38887d(0x1af)]({'status':!![],'message':_0x38887d(0x2a0)});const _0x292731=getBotsWithMode();_0x292731[_0x38887d(0x238)]>0x0?confirmRestore(temppath,_0x2d866c[_0x38887d(0x315)]):unzipFile(temppath,_0x2d866c[_0x38887d(0x315)]);}}else logger[_0x38887d(0x187)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x38887d(0x187)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x2b9903(0x16d)](express[_0x2b9903(0x1f5)](path[_0x2b9903(0x211)](__dirname,bbpath2,'build2'))),app[_0x2b9903(0x16d)](express[_0x2b9903(0x1f5)](path['join'](__dirname,bbpath2,_0x2b9903(0x286)))),app[_0x2b9903(0x23e)]('/',function(_0x56d52b,_0x560ade){const _0xa61539=_0x2b9903;_0x560ade['sendFile'](path['join'](__dirname,bbpath2,_0xa61539(0x2f1),_0xa61539(0x1ff)));}),app[_0x2b9903(0x23e)]('/:bot',function(_0x2a4853,_0x5bcba7){const _0x523f3d=_0x2b9903;_0x5bcba7[_0x523f3d(0x31f)](path['join'](__dirname,bbpath2,_0x523f3d(0x286),_0x523f3d(0x1ff)));}),app['get'](_0x2b9903(0x239),(_0x324436,_0x5811b0)=>{const _0x55922e=_0x2b9903;_0x5811b0[_0x55922e(0x31f)](path[_0x55922e(0x211)](__dirname,bbpath2,_0x55922e(0x286),_0x55922e(0x1ff)));}),app[_0x2b9903(0x23e)]('/:bot/performance',(_0x244660,_0x5bc288)=>{const _0x3cb261=_0x2b9903;_0x5bc288[_0x3cb261(0x31f)](path['join'](__dirname,bbpath2,_0x3cb261(0x286),_0x3cb261(0x1ff)));}),app[_0x2b9903(0x23e)](_0x2b9903(0x1b1),(_0x1533ec,_0x479ffc)=>{const _0x5c08a7=_0x2b9903;_0x479ffc[_0x5c08a7(0x31f)](path[_0x5c08a7(0x211)](__dirname,bbpath2,_0x5c08a7(0x286),_0x5c08a7(0x1ff)));}),app['get'](_0x2b9903(0x21a),(_0x53289b,_0x579b17)=>{const _0x1ad5ed=_0x2b9903;_0x579b17[_0x1ad5ed(0x31f)](path[_0x1ad5ed(0x211)](__dirname,bbpath2,'build',_0x1ad5ed(0x1ff)));}),app['get'](_0x2b9903(0x233),(_0x1300b7,_0x3efe0c)=>{const _0x48eaa5=_0x2b9903;_0x3efe0c[_0x48eaa5(0x31f)](path['join'](__dirname,bbpath2,'build',_0x48eaa5(0x1ff)));}),app['get'](_0x2b9903(0x30c),(_0x390da5,_0x18a17d)=>{const _0x1459b2=_0x2b9903;_0x18a17d[_0x1459b2(0x31f)](path[_0x1459b2(0x211)](__dirname,bbpath2,'build',_0x1459b2(0x1ff)));});if(HOST)http[_0x2b9903(0x261)](PORT,HOST);else http[_0x2b9903(0x261)](PORT);const io=require(_0x2b9903(0x2c2))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x4fbf1b=_0x2b9903;logger[_0x4fbf1b(0x1a0)](''),logger['simple'](_0x4fbf1b(0x237)),await logger['full'](_0x4fbf1b(0x258)+PORT),logger[_0x4fbf1b(0x1a0)](_0x4fbf1b(0x237));if(config[_0x4fbf1b(0x238)]!=0x0)for(const _0x295ee7 of config){if(_0x295ee7['status']==_0x4fbf1b(0x20f)||_0x295ee7['status']==_0x4fbf1b(0x2a6))await logger[_0x4fbf1b(0x187)](_0x4fbf1b(0x22e)+_0x295ee7[_0x4fbf1b(0x202)]+_0x4fbf1b(0x2e5)+_0x295ee7[_0x4fbf1b(0x1a1)]),startBot([_0x295ee7[_0x4fbf1b(0x202)],userID],{'cwd':bbpath},function(_0x1ed37d){const _0x676964=_0x4fbf1b;if(_0x1ed37d)logger[_0x676964(0x187)](_0x1ed37d);});else(_0x295ee7[_0x4fbf1b(0x2cb)]==_0x4fbf1b(0x222)||_0x295ee7[_0x4fbf1b(0x2cb)]==_0x4fbf1b(0x242))&&await logger[_0x4fbf1b(0x187)](_0x4fbf1b(0x1b6)+_0x295ee7['botID']+'\x20|\x20'+_0x295ee7[_0x4fbf1b(0x1a1)]);}else!newBot&&logger['simple'](_0x4fbf1b(0x1f1));if(newBot)addBot();logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x4fbf1b(0x1a0)]('');}function startSocket(){const _0x1d108c=_0x2b9903;io['on'](_0x1d108c(0x189),_0x1fb615=>{const _0x4c296d=_0x1d108c;let _0x1e632b,_0x162cd1,_0x5f0298,_0x5adb60,_0x378b9f;const _0x3102ed=_0x1fb615['handshake']['headers'][_0x4c296d(0x1e6)];_0x162cd1=_0x3102ed[_0x4c296d(0x1e8)](/bot[0-9]{3}/);if(_0x162cd1)_0x5f0298=_0x162cd1[0x0]['match'](/[0-9]{3}/);if(_0x5f0298)_0x1e632b=_0x5f0298[0x0];else _0x1e632b=_0x4c296d(0x282);const _0x23b65f=_0x1fb615['handshake'][_0x4c296d(0x198)][_0x4c296d(0x26f)];if(!_0x23b65f)_0x1fb615[_0x4c296d(0x16f)](_0x4c296d(0x2cb),{'publicKey':secure[_0x4c296d(0x2be)]});else{_0x5adb60=timelyDecrypt(_0x23b65f,![]);if(!_0x5adb60)_0x1fb615[_0x4c296d(0x16f)](_0x4c296d(0x2cb),{'publicKey':secure[_0x4c296d(0x2be)]});else{_0x378b9f=normalizeIP(_0x1fb615[_0x4c296d(0x21f)]['remoteAddress'])[_0x4c296d(0x17f)];if(!devices[_0x5adb60])devices[_0x5adb60]={'uuid':_0x5adb60,'access':{'token':null}};devices[_0x5adb60]['ip']=_0x378b9f;const _0x44e2cd=addClient(_0x1fb615['id'],_0x5adb60,_0x1e632b);setAccess(_0x44e2cd),emitMessages(),_0x1fb615['on'](_0x4c296d(0x2ef),_0x55a7c4=>{const _0x583818=_0x4c296d,_0x5ea6ba=timelyDecrypt(_0x55a7c4[_0x583818(0x320)]);if(_0x5ea6ba){_0x55a7c4={'username':_0x55a7c4[_0x583818(0x302)],'password':_0x5ea6ba},devices[_0x5adb60][_0x583818(0x25d)]=validateCredentials(_0x55a7c4,_0x5adb60);if(devices[_0x5adb60][_0x583818(0x25d)]['allow']==![]&&devices[_0x5adb60][_0x583818(0x25d)][_0x583818(0x254)]==_0x583818(0x2dc))_0x1fb615[_0x583818(0x16f)](_0x583818(0x2cb),{'access':devices[_0x5adb60][_0x583818(0x25d)]}),loginAccess2FA(_0x5adb60,_0x378b9f);else{if(devices[_0x5adb60][_0x583818(0x25d)][_0x583818(0x2c3)]==![]&&devices[_0x5adb60][_0x583818(0x25d)][_0x583818(0x254)]==_0x583818(0x176))_0x1fb615[_0x583818(0x16f)](_0x583818(0x2cb),{'access':devices[_0x5adb60][_0x583818(0x25d)]});else devices[_0x5adb60][_0x583818(0x25d)][_0x583818(0x2c3)]&&devices[_0x5adb60]['access'][_0x583818(0x254)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x5adb60)[_0x583818(0x224)](_0x171f85=>{setAccess(_0x171f85);}),logger[_0x583818(0x2fd)]('Logged\x20in\x20user\x20...'+_0x5adb60['slice'](-0x8)),setTokenRefresh(_0x5adb60),setSessionTimeout(_0x583818(0x2ef),_0x5adb60));}}else logger[_0x583818(0x187)](_0x583818(0x23c));}),_0x1fb615['on'](_0x4c296d(0x2d0),()=>{resetPassword();}),_0x1fb615['on']('disconnect',_0x4b723c=>{removeClient(_0x1fb615['id']);}),_0x1e632b==_0x4c296d(0x282)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4ff868){const _0x10ac5c=_0x2b9903;if(_0x4ff868!=_0x10ac5c(0x282)&&config[_0x10ac5c(0x1ce)]!=''){if(pid[_0x4ff868])pid[_0x4ff868][_0x10ac5c(0x1af)]({'function':'initclient','args':null});}_0x4ff868!=_0x10ac5c(0x282)&&broadcastToBots(_0x10ac5c(0x1f4),JSON[_0x10ac5c(0x2f7)](config));}function reloadBotManager(){const _0x3c5c7e=_0x2b9903;getClientsWithBotID(_0x3c5c7e(0x282))[_0x3c5c7e(0x224)](_0x5da280=>{const _0x3ced17=_0x3c5c7e;getSocket(_0x5da280['id'])[_0x3ced17(0x16f)]('status',{'access':{'allow':![],'reason':_0x3ced17(0x246),'token':null}});});}function getSocket(_0x4b8fea){const _0x5482af=_0x2b9903;return io[_0x5482af(0x28e)][_0x5482af(0x28e)][_0x5482af(0x23e)](_0x4b8fea);}function setAccess(_0x13a0b0){const _0x124d51=_0x2b9903,_0x8d3c72=getSocket(_0x13a0b0['id']),_0x481770=_0x13a0b0[_0x124d51(0x2b0)],_0x524f41=_0x13a0b0[_0x124d51(0x23d)];devices[_0x481770][_0x124d51(0x25d)]=validateAccess(devices[_0x481770]['access'][_0x124d51(0x1f9)],_0x481770),logger[_0x124d51(0x2fd)]('Setting\x20access:\x20'+devices[_0x481770][_0x124d51(0x25d)][_0x124d51(0x254)]+'\x20|\x20client:\x20...'+_0x13a0b0['id'][_0x124d51(0x16b)](-0x8)+'\x20|\x20user:\x20...'+_0x481770[_0x124d51(0x16b)](-0x8)),_0x8d3c72[_0x124d51(0x211)](_0x481770);if(devices[_0x481770]['access'][_0x124d51(0x2c3)]){_0x8d3c72[_0x124d51(0x211)](_0x524f41);if(_0x524f41=='botmanager')initializeSocketBotManager(_0x8d3c72);else initializeSocketBot(_0x8d3c72);initClient(_0x524f41);}devices[_0x481770][_0x124d51(0x25d)][_0x124d51(0x1f9)]&&devices[_0x481770][_0x124d51(0x25d)][_0x124d51(0x254)]==_0x124d51(0x1d3)&&setSessionTimeout(_0x124d51(0x21e),_0x481770),devices[_0x481770][_0x124d51(0x25d)][_0x124d51(0x1f9)]&&devices[_0x481770]['access'][_0x124d51(0x254)]==_0x124d51(0x1cc)&&setSessionTimeout(_0x124d51(0x2ef),_0x481770),_0x8d3c72[_0x124d51(0x16f)]('status',{'status':_0x13a0b0[_0x124d51(0x269)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x481770][_0x124d51(0x25d)],'externalip':devices[_0x481770]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x481770][_0x124d51(0x25d)][_0x124d51(0x2c3)]==![]&&devices[_0x481770][_0x124d51(0x25d)][_0x124d51(0x254)]=='2FA\x20required'&&temporaryAccess2FA(_0x481770,devices[_0x481770]['ip']);}function setSessionTimeout(_0x165da7,_0x10d549){const _0x5c2153=_0x2b9903;let _0x28e586;if(_0x165da7=='login')_0x28e586=loginExpiry*0x3c*0x3e8;else _0x28e586=devices[_0x10d549][_0x5c2153(0x223)][_0x5c2153(0x29e)]*0x3c*0x3e8-(new Date()[_0x5c2153(0x23b)]()-devices[_0x10d549][_0x5c2153(0x223)][_0x5c2153(0x172)]);if(devices[_0x10d549][_0x5c2153(0x19a)])clearTimeout(devices[_0x10d549][_0x5c2153(0x19a)]);devices[_0x10d549][_0x5c2153(0x19a)]=setTimeout(()=>{const _0x3d5cb3=_0x5c2153;if(devices[_0x10d549][_0x3d5cb3(0x287)])clearTimeout(devices[_0x10d549][_0x3d5cb3(0x287)]);removeSocketListeners(_0x10d549),addBlacklist(_0x10d549),devices[_0x10d549][_0x3d5cb3(0x223)]=null,devices[_0x10d549]['telegram2FaApproval']=null,devices[_0x10d549][_0x3d5cb3(0x25d)][_0x3d5cb3(0x1f9)]=null,logger['debug'](_0x3d5cb3(0x219)+_0x10d549[_0x3d5cb3(0x16b)](-0x8)),devices[_0x10d549]['access']=validateAccess(devices[_0x10d549][_0x3d5cb3(0x25d)][_0x3d5cb3(0x1f9)],_0x10d549),!(devices[_0x10d549][_0x3d5cb3(0x25d)][_0x3d5cb3(0x2c3)]&&devices[_0x10d549][_0x3d5cb3(0x25d)]['reason']==_0x3d5cb3(0x2e8))&&(_0x165da7==_0x3d5cb3(0x2ef)?io['to'](_0x10d549)[_0x3d5cb3(0x16f)](_0x3d5cb3(0x2cb),{'access':{'allow':![],'reason':_0x3d5cb3(0x2a9),'token':null}}):io['to'](_0x10d549)[_0x3d5cb3(0x16f)]('status',{'access':{'allow':![],'reason':_0x3d5cb3(0x30d),'token':null}})),devices[_0x10d549]['access'][_0x3d5cb3(0x1f9)]=null;},_0x28e586);}function setTokenRefresh(_0x197f38){const _0x576143=_0x2b9903;if(devices[_0x197f38][_0x576143(0x287)])clearTimeout(devices[_0x197f38]['pidRefreshToken']);devices[_0x197f38][_0x576143(0x287)]=setTimeout(()=>{const _0x263a7e=_0x576143;getClientsWithUuid(_0x197f38)[_0x263a7e(0x238)]!=0x0?(devices[_0x197f38][_0x263a7e(0x25d)]=refreshToken(_0x197f38),io['to'](_0x197f38)['emit'](_0x263a7e(0x2cb),{'status':_0x263a7e(0x278),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x197f38][_0x263a7e(0x25d)],'externalip':devices[_0x197f38]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x197f38)):clearTimeout(devices[_0x197f38][_0x263a7e(0x287)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5d55fa){const _0x495bd9=_0x2b9903,_0x40622e=getClient(_0x5d55fa['id'])['uuid'];_0x5d55fa[_0x495bd9(0x16f)](_0x495bd9(0x1f4),config),_0x5d55fa[_0x495bd9(0x16f)](_0x495bd9(0x2b3),cleanSettings()),_0x5d55fa['on']('add-bot',_0x3cd36a=>{if(validateAccess(_0x3cd36a,_0x40622e)['allow'])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x5d55fa['on'](_0x495bd9(0x173),(_0x21d35d,_0xe346f6)=>{const _0x24aab4=_0x495bd9;if(validateAccess(_0xe346f6,_0x40622e)['allow'])toggleBot(_0x21d35d[_0x24aab4(0x202)],_0x21d35d[_0x24aab4(0x2cb)],_0x21d35d['live']);else logger['full'](_0x24aab4(0x2c0));}),_0x5d55fa['on'](_0x495bd9(0x1c7),(_0x5e6f23,_0x526032)=>{const _0x4bbc43=_0x495bd9;if(validateAccess(_0x526032,_0x40622e)['allow'])toggleBotMode(_0x5e6f23);else logger[_0x4bbc43(0x187)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x5d55fa['on'](_0x495bd9(0x294),(_0x2ff509,_0x16fae2)=>{const _0x3bd86d=_0x495bd9;if(validateAccess(_0x16fae2,_0x40622e)[_0x3bd86d(0x2c3)])deleteBot(_0x2ff509);else logger['full'](_0x3bd86d(0x31a));}),_0x5d55fa['on'](_0x495bd9(0x2b2),(_0x33ca0c,_0x128c95)=>{const _0x325983=_0x495bd9;if(validateAccess(_0x128c95,_0x40622e)[_0x325983(0x2c3)])storeSettings(_0x33ca0c,!![]);else logger[_0x325983(0x187)](_0x325983(0x195));}),_0x5d55fa['on'](_0x495bd9(0x25b),_0x117f39=>{const _0x990327=_0x495bd9;if(validateAccess(_0x117f39,_0x40622e)[_0x990327(0x2c3)])updateBB(_0x990327(0x28d));else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x5d55fa['on'](_0x495bd9(0x2ac),_0x494736=>{const _0x24784c=_0x495bd9;if(validateAccess(_0x494736,_0x40622e)[_0x24784c(0x2c3)])updateBB(_0x24784c(0x267));else logger[_0x24784c(0x187)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x5d55fa['on'](_0x495bd9(0x24d),_0x4d1c45=>{const _0x45c23e=_0x495bd9;if(validateAccess(_0x4d1c45,_0x40622e)[_0x45c23e(0x2c3)]){const _0x96ce89=getClient(_0x5d55fa['id']);if(_0x96ce89)getBackupFiles(_0x96ce89['uuid']);else logger[_0x45c23e(0x187)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger['full']('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x5d55fa['on']('restore-backup-file',(_0x3bc6a3,_0x5bbc83)=>{const _0x3b6459=_0x495bd9;if(validateAccess(_0x5bbc83,_0x40622e)[_0x3b6459(0x2c3)])restoreBackupFile(_0x3bc6a3);else logger[_0x3b6459(0x187)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x5d55fa['on']('get-messages',_0x1db448=>{const _0x14b831=_0x495bd9;if(validateAccess(_0x1db448,_0x40622e)[_0x14b831(0x2c3)])getMessages();else logger[_0x14b831(0x187)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x5d55fa['on'](_0x495bd9(0x31d),(_0x5b97ea,_0x1173ae)=>{const _0x39f4f1=_0x495bd9;if(validateAccess(_0x1173ae,_0x40622e)['allow'])confirmMessage(_0x5b97ea);else logger[_0x39f4f1(0x187)](_0x39f4f1(0x2c8));}),_0x5d55fa['on'](_0x495bd9(0x1e2),_0x328099=>{const _0x35e454=_0x495bd9;if(validateAccess(_0x328099,_0x40622e)[_0x35e454(0x2c3)]){if(devices[_0x40622e][_0x35e454(0x287)])clearTimeout(devices[_0x40622e][_0x35e454(0x287)]);if(devices[_0x40622e][_0x35e454(0x19a)])clearTimeout(devices[_0x40622e][_0x35e454(0x19a)]);removeSocketListeners(getClient(_0x5d55fa['id'])[_0x35e454(0x2b0)]),addBlacklist(_0x40622e),devices[_0x40622e][_0x35e454(0x223)]=null,devices[_0x40622e]['telegram2FaApproval']=null,devices[_0x40622e][_0x35e454(0x25d)][_0x35e454(0x1f9)]=null,logger['debug'](_0x35e454(0x163)+_0x40622e['slice'](-0x8)),io['to'](getClient(_0x5d55fa['id'])['uuid'])[_0x35e454(0x16f)](_0x35e454(0x2cb),{'access':{'allow':![],'reason':_0x35e454(0x201),'token':null}});}else logger[_0x35e454(0x187)](_0x35e454(0x1d5));});}function initializeSocketBot(_0x23329b){const _0x5e4857=_0x2b9903,_0x5f2cf1=getClient(_0x23329b['id'])[_0x5e4857(0x23d)],_0x2e3ffc=getClient(_0x23329b['id'])['uuid'];_0x23329b['on']('get-logs',(_0x28accf,_0x3d418f)=>{const _0x2e437a=_0x5e4857;if(validateAccess(_0x3d418f,_0x2e3ffc)[_0x2e437a(0x2c3)]){if(pid[_0x5f2cf1])pid[_0x5f2cf1][_0x2e437a(0x1af)]({'function':'emitHistory','args':_0x28accf});}else logger[_0x2e437a(0x187)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x23329b['on'](_0x5e4857(0x311),(_0x6b2623,_0x17eefa)=>{const _0x2b0e27=_0x5e4857;if(validateAccess(_0x17eefa,_0x2e3ffc)[_0x2b0e27(0x2c3)]){if(pid[_0x5f2cf1])pid[_0x5f2cf1][_0x2b0e27(0x1af)]({'function':_0x2b0e27(0x20c),'args':_0x6b2623});}else logger[_0x2b0e27(0x187)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x23329b['on'](_0x5e4857(0x22d),(_0x8854ae,_0x289ee3)=>{const _0x20d4d9=_0x5e4857;if(validateAccess(_0x289ee3,_0x2e3ffc)[_0x20d4d9(0x2c3)]){if(pid[_0x5f2cf1])pid[_0x5f2cf1][_0x20d4d9(0x1af)]({'function':_0x20d4d9(0x22c),'args':_0x8854ae});}else logger[_0x20d4d9(0x187)](_0x20d4d9(0x247));}),_0x23329b['on']('store-configuration',(_0x3f98fc,_0x44fa76)=>{const _0x548f5e=_0x5e4857;if(validateAccess(_0x44fa76,_0x2e3ffc)['allow']){if(pid[_0x5f2cf1])pid[_0x5f2cf1][_0x548f5e(0x1af)]({'function':_0x548f5e(0x2f2),'args':_0x3f98fc});}else logger['full'](_0x548f5e(0x2ea));}),_0x23329b['on']('store-headless',(_0x2dcbb8,_0x49f236)=>{const _0x4d04b0=_0x5e4857;if(validateAccess(_0x49f236,_0x2e3ffc)[_0x4d04b0(0x2c3)]){if(pid[_0x5f2cf1])pid[_0x5f2cf1]['send']({'function':_0x4d04b0(0x2fe),'args':_0x2dcbb8});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x23329b['on']('store-fiat',(_0x2d048e,_0x30d558)=>{const _0x4f29d7=_0x5e4857;if(validateAccess(_0x30d558,_0x2e3ffc)[_0x4f29d7(0x2c3)]){if(pid[_0x5f2cf1])pid[_0x5f2cf1][_0x4f29d7(0x1af)]({'function':_0x4f29d7(0x181),'args':_0x2d048e});}else logger[_0x4f29d7(0x187)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x23329b['on'](_0x5e4857(0x2f4),_0x9d7d93=>{const _0x361646=_0x5e4857;if(validateAccess(_0x9d7d93,_0x2e3ffc)[_0x361646(0x2c3)]){if(pid[_0x5f2cf1])pid[_0x5f2cf1][_0x361646(0x1af)]({'function':_0x361646(0x313),'args':null});}else logger[_0x361646(0x187)](_0x361646(0x270));}),_0x23329b['on'](_0x5e4857(0x285),_0x559ab5=>{const _0x846154=_0x5e4857;if(validateAccess(_0x559ab5,_0x2e3ffc)[_0x846154(0x2c3)]){if(pid[_0x5f2cf1])pid[_0x5f2cf1][_0x846154(0x1af)]({'function':_0x846154(0x1e0),'args':null});}else logger[_0x846154(0x187)](_0x846154(0x2e6));}),_0x23329b['on']('place-order',(_0x1d685a,_0x1a1f57)=>{const _0x1a8125=_0x5e4857;if(validateAccess(_0x1a1f57,_0x2e3ffc)['allow']){if(pid[_0x5f2cf1])pid[_0x5f2cf1]['send']({'function':_0x1a8125(0x271),'args':_0x1d685a});}else logger[_0x1a8125(0x187)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x23329b['on'](_0x5e4857(0x27a),_0x551d86=>{const _0x5ea1da=_0x5e4857;if(validateAccess(_0x551d86,_0x2e3ffc)['allow']){if(pid[_0x5f2cf1])pid[_0x5f2cf1][_0x5ea1da(0x1af)]({'function':_0x5ea1da(0x2ba),'args':null});}else logger[_0x5ea1da(0x187)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x23329b['on'](_0x5e4857(0x26c),_0x5abcee=>{const _0x4abd4a=_0x5e4857;if(validateAccess(_0x5abcee,_0x2e3ffc)[_0x4abd4a(0x2c3)]){if(pid[_0x5f2cf1])pid[_0x5f2cf1][_0x4abd4a(0x1af)]({'function':'showConfig','args':null});}else logger[_0x4abd4a(0x187)](_0x4abd4a(0x290));}),_0x23329b['on'](_0x5e4857(0x25b),_0x42e48b=>{const _0xc96da9=_0x5e4857;if(validateAccess(_0x42e48b,_0x2e3ffc)[_0xc96da9(0x2c3)])updateBB('update');else logger[_0xc96da9(0x187)](_0xc96da9(0x288));}),_0x23329b['on'](_0x5e4857(0x1c8),_0x37e577=>{const _0xf179f1=_0x5e4857;if(validateAccess(_0x37e577,_0x2e3ffc)['allow'])getMessages();else logger[_0xf179f1(0x187)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x23329b['on'](_0x5e4857(0x31d),(_0x576024,_0x14ef82)=>{const _0x32559d=_0x5e4857;if(validateAccess(_0x14ef82,_0x2e3ffc)[_0x32559d(0x2c3)])confirmMessage(_0x576024);else logger[_0x32559d(0x187)](_0x32559d(0x2c8));}),_0x23329b['on'](_0x5e4857(0x1e2),_0x56aedc=>{const _0x3598e7=_0x5e4857;if(validateAccess(_0x56aedc,_0x2e3ffc)['allow']){if(devices[_0x2e3ffc][_0x3598e7(0x287)])clearTimeout(devices[_0x2e3ffc][_0x3598e7(0x287)]);if(devices[_0x2e3ffc][_0x3598e7(0x19a)])clearTimeout(devices[_0x2e3ffc][_0x3598e7(0x19a)]);removeSocketListeners(getClient(_0x23329b['id'])[_0x3598e7(0x2b0)]),addBlacklist(_0x2e3ffc),devices[_0x2e3ffc][_0x3598e7(0x223)]=null,devices[_0x2e3ffc][_0x3598e7(0x16c)]=null,devices[_0x2e3ffc][_0x3598e7(0x25d)][_0x3598e7(0x1f9)]=null,logger[_0x3598e7(0x2fd)](_0x3598e7(0x163)+_0x2e3ffc[_0x3598e7(0x16b)](-0x8)),io['to'](getClient(_0x23329b['id'])[_0x3598e7(0x2b0)])[_0x3598e7(0x16f)]('status',{'access':{'allow':![],'reason':_0x3598e7(0x201),'token':null}});}else logger[_0x3598e7(0x187)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x19dfb8){const _0x371930=_0x2b9903;getClientsWithUuid(_0x19dfb8)[_0x371930(0x224)](_0x3b890c=>{const _0x2d0394=_0x371930;getSocket(_0x3b890c['id'])[_0x2d0394(0x2e3)]();});}function cleanSettings(){const _0x4f9beb=_0x2b9903;let _0x578601=settings;return settings['telegramToken']&&settings['telegramToken']!=''&&(_0x578601={..._0x578601,'telegramToken':'************'}),settings[_0x4f9beb(0x2bd)]&&settings[_0x4f9beb(0x2bd)]!=''&&(_0x578601={..._0x578601,'bbPassword':'************'}),(settings['bbPassword']&&settings[_0x4f9beb(0x2bd)]=='***'||settings[_0x4f9beb(0x299)]&&settings[_0x4f9beb(0x299)]==_0x4f9beb(0x1fa))&&(_0x578601={..._0x578601,'restored':{'password':settings[_0x4f9beb(0x2bd)]==_0x4f9beb(0x1fa),'telegram':settings[_0x4f9beb(0x299)]==_0x4f9beb(0x1fa)}}),_0x578601;}async function updateBB(_0x1419ac){const _0x122a18=_0x2b9903;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0xde70cc=>{const _0xb41e5a=_0x11f2;restartBot(_0xde70cc[_0xb41e5a(0x202)]);}),logger['debug'](_0x122a18(0x1da)+_0x1419ac);if(_0x1419ac==_0x122a18(0x28d))process[_0x122a18(0x1af)]({'update':!![]},_0x2803ef=>{});else _0x1419ac==_0x122a18(0x267)&&process[_0x122a18(0x1af)]({'reinstall':!![]},_0x1304ba=>{});}function startBot(_0x508400,_0x520a96,_0x51355a){const _0x4fd141=_0x2b9903;if(debugging)_0x508400[_0x4fd141(0x2a8)]('-d');let _0x5dd4fb=![];const _0x4b3b32=_0x508400[0x0];_0x520a96={..._0x520a96,'stdio':[_0x4fd141(0x265),_0x4fd141(0x265),_0x4fd141(0x265),_0x4fd141(0x1c1)]},pid[_0x4b3b32]=childProcess[_0x4fd141(0x1aa)](botfile,_0x508400,_0x520a96),pid[_0x4b3b32]['on'](_0x4fd141(0x283),_0x34b7f6=>{const _0x4c20f4=_0x4fd141;switch(Object['keys'](_0x34b7f6)[0x0]){case _0x4c20f4(0x1a1):updateBotName(_0x4b3b32,_0x34b7f6[_0x4c20f4(0x1a1)]);break;case _0x4c20f4(0x218):updateBotManager();break;case _0x4c20f4(0x2cb):updateStatus(_0x4b3b32,_0x34b7f6[_0x4c20f4(0x2cb)]);break;case _0x4c20f4(0x164):updateLive(_0x4b3b32,_0x34b7f6[_0x4c20f4(0x164)]);break;case'started':updateLive(_0x4b3b32,_0x34b7f6[_0x4c20f4(0x264)]),io['to'](_0x4b3b32)[_0x4c20f4(0x16f)](_0x4c20f4(0x2cb),{'access':{'allow':![],'reason':_0x4c20f4(0x246),'token':null}});break;case _0x4c20f4(0x2c1):_0x34b7f6[_0x4c20f4(0x2c1)]=='restart'&&restartBot(_0x4b3b32);_0x34b7f6[_0x4c20f4(0x2c1)]==_0x4c20f4(0x174)&&toggleBot(_0x4b3b32,_0x4c20f4(0x222),_0x4c20f4(0x175));break;case _0x4c20f4(0x24a):sendTelegram(_0x4b3b32,_0x34b7f6['telegram']);break;case _0x4c20f4(0x203):sendTelegramMsg(_0x34b7f6['telegrammsg']);break;case _0x4c20f4(0x24e):io['to'](_0x4b3b32)['emit'](_0x34b7f6[_0x4c20f4(0x24e)],_0x34b7f6[_0x4c20f4(0x192)]);break;}}),pid[_0x4b3b32]['on']('error',function(_0x20dc25){if(_0x5dd4fb)return;_0x5dd4fb=!![],_0x51355a(_0x20dc25);}),pid[_0x4b3b32]['on']('exit',async function(_0x47c8cd){const _0x21516d=_0x4fd141;if(installingUpdate)return;if(_0x5dd4fb)return;_0x5dd4fb=!![],_0x51355a(null);const _0x39cc69=dbConfig[_0x21516d(0x23e)](_0x21516d(0x1f4))[_0x21516d(0x1b0)]({'botID':_0x4b3b32})['value']();_0x39cc69&&(_0x39cc69[_0x21516d(0x2cb)]==_0x21516d(0x20f)||_0x39cc69['status']=='new')&&(await sleep(0x3e8),updateLive(_0x4b3b32,_0x21516d(0x175)),logger['full'](_0x21516d(0x209)+_0x4b3b32),startBot([_0x4b3b32,userID],{'cwd':bbpath},function(_0xbb4715){const _0x5de88d=_0x21516d;if(_0xbb4715)logger[_0x5de88d(0x187)](_0xbb4715);}));});}function stopBot(_0x19fae6){const _0x106ff0=_0x2b9903;getClientsWithBotID(_0x19fae6)['forEach'](_0x1547c5=>{const _0x54315f=_0x11f2;getSocket(_0x1547c5['id'])[_0x54315f(0x1a6)](!![]),removeClient(_0x1547c5['id']);}),pid[_0x19fae6]&&(pid[_0x19fae6][_0x106ff0(0x174)](),pid[_0x19fae6]=null);}function restartBot(_0x273f4d){if(pid[_0x273f4d])pid[_0x273f4d]['kill']();}function addBot(){const _0x187f0e=_0x2b9903;let _0x4d9b43;for(let _0x3067dc=0x1;_0x3067dc<0x3e9;_0x3067dc++){_0x4d9b43=_0x3067dc[_0x187f0e(0x1d1)]()['padStart'](0x3,'0');let _0x433386=config[_0x187f0e(0x1b0)](_0x276653=>_0x276653['botID']==_0x4d9b43);if(!_0x433386)break;}if(_0x4d9b43===_0x187f0e(0x194)){logger[_0x187f0e(0x187)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x187f0e(0x187)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x4d9b43),dbConfig['get']('bots')[_0x187f0e(0x2a8)]({'botID':_0x4d9b43,'botname':_0x187f0e(0x289)+_0x4d9b43,'status':_0x187f0e(0x2a6),'live':''})[_0x187f0e(0x292)](),startBot([_0x4d9b43,userID],{'cwd':bbpath},function(_0x34cfbd){const _0x228335=_0x187f0e;if(_0x34cfbd)logger[_0x228335(0x187)](_0x34cfbd);}),config=getConfiguration(),io['to']('botmanager')[_0x187f0e(0x16f)]('bots',config),broadcastToBots('bots',JSON[_0x187f0e(0x2f7)](config));}function deleteBot(_0x1d08a9){const _0x382466=_0x2b9903;getClientsWithBotID(_0x1d08a9)[_0x382466(0x224)](_0x268a0a=>{const _0x489170=_0x382466;getSocket(_0x268a0a['id'])[_0x489170(0x1a6)](!![]),removeClient(_0x268a0a['id']);}),dbConfig['get']('bots')[_0x382466(0x235)]({'botID':_0x1d08a9})[_0x382466(0x292)](),logger['full'](_0x382466(0x228)+_0x1d08a9),stopBot(_0x1d08a9);try{if(fs[_0x382466(0x27f)](path[_0x382466(0x211)](configpath,_0x382466(0x1e9)+_0x1d08a9+'-config.json')))fs[_0x382466(0x29d)](path[_0x382466(0x211)](configpath,'bot-'+_0x1d08a9+_0x382466(0x279)));if(fs['existsSync'](path[_0x382466(0x211)](configpath,_0x382466(0x1e9)+_0x1d08a9+_0x382466(0x1bf))))fs['unlinkSync'](path['join'](configpath,_0x382466(0x1e9)+_0x1d08a9+_0x382466(0x1bf)));if(fs['existsSync'](path[_0x382466(0x211)](configpath,'bot-'+_0x1d08a9+_0x382466(0x2f0))))fs[_0x382466(0x29d)](path[_0x382466(0x211)](configpath,_0x382466(0x1e9)+_0x1d08a9+_0x382466(0x2f0)));if(fs[_0x382466(0x27f)](path[_0x382466(0x211)](configpath,'bot-'+_0x1d08a9+_0x382466(0x1fc))))fs[_0x382466(0x29d)](path[_0x382466(0x211)](configpath,_0x382466(0x1e9)+_0x1d08a9+'-results.json'));}catch(_0x56c25b){if(_0x56c25b)logger['full'](_0x382466(0x275),_0x56c25b);}config=getConfiguration(),io['to'](_0x382466(0x282))['emit'](_0x382466(0x1f4),config),broadcastToBots(_0x382466(0x1f4),JSON[_0x382466(0x2f7)](config));}function toggleBot(_0x4e7a01,_0x584429,_0x14daf6){const _0x5005b8=_0x2b9903;dbConfig[_0x5005b8(0x23e)]('bots')[_0x5005b8(0x1b0)]({'botID':_0x4e7a01})[_0x5005b8(0x1ae)]({'status':_0x584429})[_0x5005b8(0x1ae)]({'live':_0x14daf6})[_0x5005b8(0x292)]();if(_0x584429==_0x5005b8(0x20f)||_0x584429==_0x5005b8(0x2a6))logger[_0x5005b8(0x187)](_0x5005b8(0x30a)+_0x4e7a01),startBot([_0x4e7a01,userID],{'cwd':bbpath},function(_0x327c4c){const _0x176c1a=_0x5005b8;if(_0x327c4c)logger[_0x176c1a(0x187)](_0x327c4c);});else(_0x584429==_0x5005b8(0x222)||_0x584429==_0x5005b8(0x242))&&(logger['full'](_0x5005b8(0x2ed)+_0x4e7a01),stopBot(_0x4e7a01));config=getConfiguration(),io['to']('botmanager')[_0x5005b8(0x16f)]('bots',config),broadcastToBots(_0x5005b8(0x1f4),JSON[_0x5005b8(0x2f7)](config));}function toggleStatus(_0x11daa5){const _0x3ff835=_0x2b9903;let _0x3f78e9=dbConfig['get']('bots')[_0x3ff835(0x1b0)]({'botID':_0x11daa5})[_0x3ff835(0x171)](),_0x5484a6;if(_0x3f78e9['status']===_0x3ff835(0x20f))_0x5484a6=_0x3ff835(0x222);else{if(_0x3f78e9[_0x3ff835(0x2cb)]===_0x3ff835(0x2a6))_0x5484a6=_0x3ff835(0x242);else{if(_0x3f78e9[_0x3ff835(0x2cb)]===_0x3ff835(0x242))_0x5484a6=_0x3ff835(0x2a6);else{if(_0x3f78e9[_0x3ff835(0x2cb)]===_0x3ff835(0x222))_0x5484a6=_0x3ff835(0x20f);}}}return _0x5484a6;}function updateStatus(_0x51096f,_0x3e33ee){const _0x4eebce=_0x2b9903;dbConfig['get'](_0x4eebce(0x1f4))[_0x4eebce(0x1b0)]({'botID':_0x51096f})[_0x4eebce(0x1ae)]({'status':_0x3e33ee})[_0x4eebce(0x292)](),config=getConfiguration(),io['to'](_0x4eebce(0x282))[_0x4eebce(0x16f)](_0x4eebce(0x1f4),config),broadcastToBots(_0x4eebce(0x1f4),JSON[_0x4eebce(0x2f7)](config));}function updateLive(_0x2a7b24,_0xc31354){const _0x303978=_0x2b9903;dbConfig['get'](_0x303978(0x1f4))[_0x303978(0x1b0)]({'botID':_0x2a7b24})[_0x303978(0x1ae)]({'live':_0xc31354})[_0x303978(0x292)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x303978(0x1f4),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotName(_0x756c13,_0x1bf05d){const _0x61d146=_0x2b9903;dbConfig[_0x61d146(0x23e)]('bots')[_0x61d146(0x1b0)]({'botID':_0x756c13})[_0x61d146(0x1ae)]({'botname':_0x1bf05d})[_0x61d146(0x292)](),config=getConfiguration(),io['to']('botmanager')[_0x61d146(0x16f)]('bots',config),broadcastToBots(_0x61d146(0x1f4),JSON[_0x61d146(0x2f7)](config));}function updateBotManager(){const _0x36833d=_0x2b9903;config=getConfiguration(),io['to']('botmanager')[_0x36833d(0x16f)](_0x36833d(0x1f4),config),broadcastToBots(_0x36833d(0x1f4),JSON[_0x36833d(0x2f7)](config));}function toggleBotMode(_0x35eafb){const _0x26857a=_0x2b9903;if(pid[_0x35eafb])pid[_0x35eafb][_0x26857a(0x1af)]({'function':_0x26857a(0x309),'args':null});else{const _0x7c3f25=configpath+_0x26857a(0x1e9)+_0x35eafb+'-config.json',_0x112fdf=fs[_0x26857a(0x19e)](_0x7c3f25),_0x547e59=JSON['parse'](_0x112fdf),_0x5af7ac=_0x547e59[_0x26857a(0x23d)][0x0][_0x26857a(0x19f)];_0x547e59[_0x26857a(0x23d)][0x0][_0x26857a(0x19f)]=!_0x5af7ac;const _0x5a0541=JSON[_0x26857a(0x2f7)](_0x547e59,null,0x2);fs[_0x26857a(0x18c)](_0x7c3f25,_0x5a0541),config=getConfiguration(),io['to'](_0x26857a(0x282))[_0x26857a(0x16f)]('bots',config),broadcastToBots(_0x26857a(0x1f4),JSON['stringify'](config));}}function telegramError(_0x117401){const _0x1b0a44=_0x2b9903;logger[_0x1b0a44(0x1a0)](getTimeStamp()+_0x1b0a44(0x18e));}function validateTelegram(_0x28ac5e){const _0x511181=_0x2b9903;if(_0x28ac5e[_0x511181(0x1a3)][_0x511181(0x302)]!=settings[_0x511181(0x1d9)]&&'@'+_0x28ac5e[_0x511181(0x1a3)][_0x511181(0x302)]!=settings[_0x511181(0x1d9)])return tgBot[_0x511181(0x2c9)](_0x28ac5e[_0x511181(0x1ba)]['id'],_0x511181(0x21d),{'parse_mode':_0x511181(0x29b)})[_0x511181(0x1f7)](_0x3e7a87=>{telegramError(_0x3e7a87);}),![];return!![];}async function initTelegram(){const _0x2faec1=_0x2b9903;if(tgBot)tgBot[_0x2faec1(0x293)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x2faec1(0x299)],{'polling':!![]});let _0x38975a='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x38975a+='\x0a',_0x38975a+='/enable\x20-\x20enable\x20notifications\x0a',_0x38975a+=_0x2faec1(0x177),_0x38975a+=_0x2faec1(0x167),_0x38975a+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x38975a+=_0x2faec1(0x2ae),_0x38975a+=_0x2faec1(0x25e),_0x38975a+=_0x2faec1(0x284),_0x38975a+=_0x2faec1(0x180),_0x38975a+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x38975a+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x38975a+=_0x2faec1(0x1d7),_0x38975a+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x38975a+=_0x2faec1(0x1ad),_0x38975a+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x5688ff=_0x2faec1(0x308);_0x5688ff+='\x0a',_0x5688ff+=_0x38975a,tgBot[_0x2faec1(0x162)](/\/start/,_0x1cecc4=>{const _0x59b832=_0x2faec1;if(!validateTelegram(_0x1cecc4))return;if(settings[_0x59b832(0x29c)]!=_0x1cecc4[_0x59b832(0x1ba)]['id'])updateSetting(_0x59b832(0x29c),_0x1cecc4['chat']['id']);updateSetting(_0x59b832(0x1a9),!![]),tgBot[_0x59b832(0x2c9)](_0x1cecc4[_0x59b832(0x1ba)]['id'],_0x5688ff)['catch'](_0x34a023=>{telegramError(_0x34a023);});}),tgBot[_0x2faec1(0x162)](/\/enable/,_0x427853=>{const _0x54a5a6=_0x2faec1;if(!validateTelegram(_0x427853))return;if(settings[_0x54a5a6(0x29c)]!=_0x427853[_0x54a5a6(0x1ba)]['id'])updateSetting(_0x54a5a6(0x29c),_0x427853[_0x54a5a6(0x1ba)]['id']);updateSetting(_0x54a5a6(0x1a9),!![]),tgBot[_0x54a5a6(0x2c9)](_0x427853[_0x54a5a6(0x1ba)]['id'],_0x54a5a6(0x18b))[_0x54a5a6(0x1f7)](_0x421484=>{telegramError(_0x421484);});}),tgBot[_0x2faec1(0x162)](/\/config/,async _0x443b59=>{const _0x4ea4b3=_0x2faec1;if(!validateTelegram(_0x443b59))return;tgBot['removeListener']('callback_query'),tgBot[_0x4ea4b3(0x2c9)](_0x443b59[_0x4ea4b3(0x1ba)]['id'],_0x4ea4b3(0x1fe),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':'orders'},{'text':_0x4ea4b3(0x2ab),'callback_data':'alerts'},{'text':'All','callback_data':_0x4ea4b3(0x318)}]]}})[_0x4ea4b3(0x1f7)](_0x38ec2b=>{telegramError(_0x38ec2b);}),tgBot['on'](_0x4ea4b3(0x310),async _0x2b1018=>{const _0x515603=_0x4ea4b3,_0x41d959=_0x2b1018['data'],_0x428a22=_0x2b1018[_0x515603(0x283)];tgBot['answerCallbackQuery'](_0x2b1018['id'])[_0x515603(0x245)](async()=>{const _0x3617ed=_0x515603;_0x41d959==_0x3617ed(0x2d2)&&(updateSetting(_0x3617ed(0x2d4),_0x3617ed(0x2d2)),updateSetting('telegramEnabled',!![]),await tgBot[_0x3617ed(0x2c9)](_0x428a22[_0x3617ed(0x1ba)]['id'],_0x3617ed(0x2f3))[_0x3617ed(0x1f7)](_0x4afc41=>{telegramError(_0x4afc41);}));_0x41d959==_0x3617ed(0x22f)&&(updateSetting(_0x3617ed(0x2d4),'alerts'),updateSetting('telegramEnabled',!![]),await tgBot[_0x3617ed(0x2c9)](_0x428a22[_0x3617ed(0x1ba)]['id'],_0x3617ed(0x226))[_0x3617ed(0x1f7)](_0x12ab20=>{telegramError(_0x12ab20);}));_0x41d959==_0x3617ed(0x318)&&(updateSetting(_0x3617ed(0x2d4),_0x3617ed(0x318)),updateSetting(_0x3617ed(0x1a9),!![]),await tgBot[_0x3617ed(0x2c9)](_0x428a22['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')[_0x3617ed(0x1f7)](_0x39d751=>{telegramError(_0x39d751);}));if(!settings[_0x3617ed(0x29c)])tgBot[_0x3617ed(0x2c9)](_0x428a22['chat']['id'],_0x3617ed(0x1b8))[_0x3617ed(0x1f7)](_0x469d06=>{telegramError(_0x469d06);});}),tgBot['removeListener'](_0x515603(0x310));});}),tgBot[_0x2faec1(0x162)](/\/status/,_0x41e650=>{const _0x1d7282=_0x2faec1;if(!validateTelegram(_0x41e650))return;const _0x171437=getBotsWithMode();let _0x17f084='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x1d7282(0x224)](_0x49f3a7=>{const _0x5c80fb=_0x1d7282,_0x285719=_0x171437['find'](_0x4ddaf7=>_0x4ddaf7[_0x5c80fb(0x202)]==_0x49f3a7[_0x5c80fb(0x202)])[_0x5c80fb(0x1db)];_0x17f084+=_0x5c80fb(0x289)+_0x49f3a7[_0x5c80fb(0x202)]+':\x20'+_0x49f3a7[_0x5c80fb(0x2cb)]+'\x20|\x20'+_0x285719+'\x20|\x20'+_0x49f3a7[_0x5c80fb(0x164)]+'\x0a';}),_0x17f084+='\x0a',_0x17f084+=_0x1d7282(0x208),_0x17f084+=!settings[_0x1d7282(0x1a9)]?'Notifications\x20disabled\x0a':_0x1d7282(0x217),_0x17f084+=settings['telegramEnabled']?settings[_0x1d7282(0x2d4)]==_0x1d7282(0x318)?_0x1d7282(0x1de):_0x1d7282(0x1b5)+settings[_0x1d7282(0x2d4)]+'\x20only\x0a':'',tgBot['sendMessage'](_0x41e650[_0x1d7282(0x1ba)]['id'],_0x17f084,{'parse_mode':_0x1d7282(0x29b)})[_0x1d7282(0x1f7)](_0x449811=>{telegramError(_0x449811);});}),tgBot['onText'](/\/restart/,_0x55c3f6=>{const _0x120774=_0x2faec1;if(!validateTelegram(_0x55c3f6))return;tgBot['removeListener'](_0x120774(0x310));const _0x1e1efa=getEnabledBots();if(_0x1e1efa[_0x120774(0x238)]==0x0)tgBot[_0x120774(0x2c9)](_0x55c3f6[_0x120774(0x1ba)]['id'],_0x120774(0x303))[_0x120774(0x1f7)](_0x53fc5a=>{telegramError(_0x53fc5a);});else{if(_0x1e1efa['length']>0x1)_0x1e1efa[_0x120774(0x2a8)]({'botID':_0x120774(0x318)});let _0x563351=[],_0x1a3a17=[];const _0x544056=_0x1e1efa[_0x120774(0x238)]%0x4==0x0||_0x1e1efa[_0x120774(0x238)]%0x4==0x3||_0x1e1efa[_0x120774(0x238)]%0x3==0x1?0x4:0x3;let _0x57d217=0x0;_0x1e1efa[_0x120774(0x224)]((_0x2434b3,_0x5470b3)=>{const _0x2b6090=_0x120774;if(_0x5470b3%_0x544056==0x0)_0x1a3a17=[];_0x1a3a17['push']({'text':_0x2434b3['botID']==_0x2b6090(0x318)?'All\x20bots':_0x2b6090(0x289)+_0x2434b3['botID'],'callback_data':_0x2434b3['botID']}),_0x5470b3%_0x544056==0x0&&(_0x563351[_0x57d217]=_0x1a3a17,_0x57d217++);}),tgBot[_0x120774(0x2c9)](_0x55c3f6[_0x120774(0x1ba)]['id'],_0x120774(0x1dc),{'reply_markup':{'inline_keyboard':_0x563351}})[_0x120774(0x1f7)](_0x58e24b=>{telegramError(_0x58e24b);}),tgBot['on']('callback_query',async _0x31cd56=>{const _0x5f3865=_0x120774,_0x229f2f=_0x31cd56[_0x5f3865(0x1c6)],_0x4ae208=_0x31cd56[_0x5f3865(0x283)];tgBot[_0x5f3865(0x252)](_0x31cd56['id'])[_0x5f3865(0x245)](async()=>{const _0x4419eb=_0x5f3865;_0x229f2f==_0x4419eb(0x318)?config[_0x4419eb(0x224)](_0x2b117f=>{const _0x50c63a=_0x4419eb;restartBot(_0x2b117f[_0x50c63a(0x202)]);}):restartBot(_0x229f2f);}),tgBot[_0x5f3865(0x236)](_0x5f3865(0x310));});}}),tgBot[_0x2faec1(0x162)](/\/on/,_0x5d4065=>{const _0x2d2f55=_0x2faec1;if(!validateTelegram(_0x5d4065))return;tgBot[_0x2d2f55(0x236)](_0x2d2f55(0x310));const _0x1e9716=getDisabledBots();if(_0x1e9716[_0x2d2f55(0x238)]==0x0)tgBot[_0x2d2f55(0x2c9)](_0x5d4065[_0x2d2f55(0x1ba)]['id'],_0x2d2f55(0x1c5))['catch'](_0x4e62fc=>{telegramError(_0x4e62fc);});else{if(_0x1e9716[_0x2d2f55(0x238)]>0x1)_0x1e9716[_0x2d2f55(0x2a8)]({'botID':'all'});let _0x3ea80d=[],_0x46be85=[];const _0x5673ba=_0x1e9716[_0x2d2f55(0x238)]%0x4==0x0||_0x1e9716['length']%0x4==0x3||_0x1e9716[_0x2d2f55(0x238)]%0x3==0x1?0x4:0x3;let _0x261897=0x0;_0x1e9716[_0x2d2f55(0x224)]((_0x1faea4,_0x2d161b)=>{const _0x3ab7b4=_0x2d2f55;if(_0x2d161b%_0x5673ba==0x0)_0x46be85=[];_0x46be85['push']({'text':_0x1faea4[_0x3ab7b4(0x202)]==_0x3ab7b4(0x318)?_0x3ab7b4(0x2f5):'Bot\x20'+_0x1faea4['botID'],'callback_data':_0x1faea4[_0x3ab7b4(0x202)]}),_0x2d161b%_0x5673ba==0x0&&(_0x3ea80d[_0x261897]=_0x46be85,_0x261897++);}),tgBot[_0x2d2f55(0x2c9)](_0x5d4065[_0x2d2f55(0x1ba)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x3ea80d}})[_0x2d2f55(0x1f7)](_0x58f667=>{telegramError(_0x58f667);}),tgBot['on'](_0x2d2f55(0x310),async _0x1b51aa=>{const _0x423432=_0x2d2f55,_0x3b2f2b=_0x1b51aa[_0x423432(0x1c6)],_0x2c5251=_0x1b51aa[_0x423432(0x283)];tgBot[_0x423432(0x252)](_0x1b51aa['id'])[_0x423432(0x245)](async()=>{const _0x50ee40=_0x423432;_0x3b2f2b==_0x50ee40(0x318)?(tgBot['sendMessage'](_0x2c5251[_0x50ee40(0x1ba)]['id'],_0x50ee40(0x216))[_0x50ee40(0x1f7)](_0x3d696d=>{telegramError(_0x3d696d);}),_0x1e9716['forEach'](_0x10d2e4=>{const _0xea8ec3=_0x50ee40;if(_0x10d2e4[_0xea8ec3(0x202)]!=_0xea8ec3(0x318))toggleBot(_0x10d2e4['botID'],toggleStatus(_0x10d2e4['botID']),_0xea8ec3(0x175));})):(tgBot[_0x50ee40(0x2c9)](_0x2c5251[_0x50ee40(0x1ba)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x3b2f2b)[_0x50ee40(0x1f7)](_0x4c4743=>{telegramError(_0x4c4743);}),toggleBot(_0x3b2f2b,toggleStatus(_0x3b2f2b),_0x50ee40(0x175)));}),tgBot[_0x423432(0x236)](_0x423432(0x310));});}}),tgBot[_0x2faec1(0x162)](/\/off/,_0xa8974b=>{const _0xb31e14=_0x2faec1;if(!validateTelegram(_0xa8974b))return;tgBot['removeListener'](_0xb31e14(0x310));const _0x47eeb6=getEnabledBots();if(_0x47eeb6[_0xb31e14(0x238)]==0x0)tgBot['sendMessage'](_0xa8974b['chat']['id'],'No\x20bots\x20running\x20right\x20now')[_0xb31e14(0x1f7)](_0x3835ee=>{telegramError(_0x3835ee);});else{if(_0x47eeb6['length']>0x1)_0x47eeb6[_0xb31e14(0x2a8)]({'botID':_0xb31e14(0x318)});let _0x59d4d8=[],_0x42720b=[];const _0x525f73=_0x47eeb6[_0xb31e14(0x238)]%0x4==0x0||_0x47eeb6[_0xb31e14(0x238)]%0x4==0x3||_0x47eeb6[_0xb31e14(0x238)]%0x3==0x1?0x4:0x3;let _0x4ae0bb=0x0;_0x47eeb6[_0xb31e14(0x224)]((_0x3dabba,_0xaa49d9)=>{const _0x31a935=_0xb31e14;if(_0xaa49d9%_0x525f73==0x0)_0x42720b=[];_0x42720b[_0x31a935(0x2a8)]({'text':_0x3dabba[_0x31a935(0x202)]=='all'?_0x31a935(0x2f5):'Bot\x20'+_0x3dabba[_0x31a935(0x202)],'callback_data':_0x3dabba['botID']}),_0xaa49d9%_0x525f73==0x0&&(_0x59d4d8[_0x4ae0bb]=_0x42720b,_0x4ae0bb++);}),tgBot['sendMessage'](_0xa8974b['chat']['id'],_0xb31e14(0x2cc),{'reply_markup':{'inline_keyboard':_0x59d4d8}})[_0xb31e14(0x1f7)](_0x499f65=>{telegramError(_0x499f65);}),tgBot['on'](_0xb31e14(0x310),async _0x2735b8=>{const _0x4146f8=_0xb31e14,_0x12324f=_0x2735b8[_0x4146f8(0x1c6)],_0x4a089c=_0x2735b8['message'];tgBot[_0x4146f8(0x252)](_0x2735b8['id'])['then'](async()=>{const _0x6e5b7c=_0x4146f8;_0x12324f=='all'?(tgBot[_0x6e5b7c(0x2c9)](_0x4a089c['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x6e5b7c(0x1f7)](_0x394744=>{telegramError(_0x394744);}),_0x47eeb6['forEach'](_0x48b951=>{const _0x4d16c3=_0x6e5b7c;if(_0x48b951[_0x4d16c3(0x202)]!=_0x4d16c3(0x318))toggleBot(_0x48b951['botID'],toggleStatus(_0x48b951[_0x4d16c3(0x202)]),_0x4d16c3(0x175));})):(tgBot[_0x6e5b7c(0x2c9)](_0x4a089c[_0x6e5b7c(0x1ba)]['id'],_0x6e5b7c(0x1fb)+_0x12324f)['catch'](_0x52d1bd=>{telegramError(_0x52d1bd);}),toggleBot(_0x12324f,toggleStatus(_0x12324f),_0x6e5b7c(0x175)));}),tgBot[_0x4146f8(0x236)](_0x4146f8(0x310));});}}),tgBot[_0x2faec1(0x162)](/\/metrics/,_0x5a6386=>{const _0x55d4af=_0x2faec1;if(!validateTelegram(_0x5a6386))return;tgBot[_0x55d4af(0x236)]('callback_query');const _0x2604ae=getEnabledBots();if(_0x2604ae[_0x55d4af(0x238)]==0x0)tgBot['sendMessage'](_0x5a6386['chat']['id'],_0x55d4af(0x303))['catch'](_0x49b14d=>{telegramError(_0x49b14d);});else{if(_0x2604ae[_0x55d4af(0x238)]>0x1){let _0x2f7fb1=[],_0x368b96=[];const _0x4ee3c6=_0x2604ae[_0x55d4af(0x238)]%0x4==0x0||_0x2604ae[_0x55d4af(0x238)]%0x4==0x3||_0x2604ae[_0x55d4af(0x238)]%0x3==0x1?0x4:0x3;let _0x36fc41=0x0;_0x2604ae['forEach']((_0x50248c,_0x3ebefc)=>{const _0x24c9d1=_0x55d4af;if(_0x3ebefc%_0x4ee3c6==0x0)_0x368b96=[];_0x368b96[_0x24c9d1(0x2a8)]({'text':'Bot\x20'+_0x50248c[_0x24c9d1(0x202)],'callback_data':_0x50248c[_0x24c9d1(0x202)]}),_0x3ebefc%_0x4ee3c6==0x0&&(_0x2f7fb1[_0x36fc41]=_0x368b96,_0x36fc41++);}),tgBot['sendMessage'](_0x5a6386[_0x55d4af(0x1ba)]['id'],_0x55d4af(0x227),{'reply_markup':{'inline_keyboard':_0x2f7fb1}})[_0x55d4af(0x1f7)](_0x4255d9=>{telegramError(_0x4255d9);}),tgBot['on']('callback_query',async _0x50e5e3=>{const _0x364598=_0x55d4af,_0x2d9120=_0x50e5e3[_0x364598(0x1c6)],_0xefee79=_0x50e5e3['message'];tgBot[_0x364598(0x252)](_0x50e5e3['id'])[_0x364598(0x245)](async()=>{if(pid[_0x2d9120])pid[_0x2d9120]['send']({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x364598(0x236)]('callback_query');});}else{const _0x1ba8c5=_0x2604ae[0x0][_0x55d4af(0x202)];if(pid[_0x1ba8c5])pid[_0x1ba8c5][_0x55d4af(0x1af)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x2faec1(0x162)](/\/portfolio/,_0x1c71ca=>{const _0x3a25e0=_0x2faec1;if(!validateTelegram(_0x1c71ca))return;tgBot['removeListener'](_0x3a25e0(0x310));const _0x482d64=getEnabledBots();if(_0x482d64['length']==0x0)tgBot[_0x3a25e0(0x2c9)](_0x1c71ca[_0x3a25e0(0x1ba)]['id'],_0x3a25e0(0x303))[_0x3a25e0(0x1f7)](_0x55e851=>{telegramError(_0x55e851);});else{if(_0x482d64[_0x3a25e0(0x238)]>0x1){let _0x4b09f0=[],_0x4d6fb1=[];const _0x445f8d=_0x482d64[_0x3a25e0(0x238)]%0x4==0x0||_0x482d64[_0x3a25e0(0x238)]%0x4==0x3||_0x482d64[_0x3a25e0(0x238)]%0x3==0x1?0x4:0x3;let _0x32965b=0x0;_0x482d64[_0x3a25e0(0x224)]((_0xfea805,_0x2ff5c8)=>{const _0x567164=_0x3a25e0;if(_0x2ff5c8%_0x445f8d==0x0)_0x4d6fb1=[];_0x4d6fb1[_0x567164(0x2a8)]({'text':_0x567164(0x289)+_0xfea805[_0x567164(0x202)],'callback_data':_0xfea805['botID']}),_0x2ff5c8%_0x445f8d==0x0&&(_0x4b09f0[_0x32965b]=_0x4d6fb1,_0x32965b++);}),tgBot[_0x3a25e0(0x2c9)](_0x1c71ca[_0x3a25e0(0x1ba)]['id'],_0x3a25e0(0x31b),{'reply_markup':{'inline_keyboard':_0x4b09f0}})[_0x3a25e0(0x1f7)](_0x228444=>{telegramError(_0x228444);}),tgBot['on']('callback_query',async _0x4fd8cc=>{const _0x3ea0c1=_0x3a25e0,_0x88e182=_0x4fd8cc[_0x3ea0c1(0x1c6)],_0x3fa48f=_0x4fd8cc[_0x3ea0c1(0x283)];tgBot['answerCallbackQuery'](_0x4fd8cc['id'])['then'](async()=>{const _0x45265d=_0x3ea0c1;if(pid[_0x88e182])pid[_0x88e182][_0x45265d(0x1af)]({'function':_0x45265d(0x20e),'args':null});}),tgBot[_0x3ea0c1(0x236)](_0x3ea0c1(0x310));});}else{const _0x33faae=_0x482d64[0x0]['botID'];if(pid[_0x33faae])pid[_0x33faae]['send']({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x2faec1(0x162)](/\/update/,async _0x4fb45f=>{const _0x292e45=_0x2faec1;if(!validateTelegram(_0x4fb45f))return;tgBot[_0x292e45(0x236)](_0x292e45(0x310)),await getMessages();if(!updateAvailable)tgBot[_0x292e45(0x2c9)](_0x4fb45f['chat']['id'],_0x292e45(0x2d8))['catch'](_0x3c4737=>{telegramError(_0x3c4737);});else!validInstallation?tgBot['sendMessage'](_0x4fb45f[_0x292e45(0x1ba)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')['catch'](_0xfd627b=>{telegramError(_0xfd627b);}):(tgBot[_0x292e45(0x2c9)](_0x4fb45f['chat']['id'],_0x292e45(0x1ac),{'reply_markup':{'inline_keyboard':[[{'text':_0x292e45(0x2b1),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x292e45(0x1f7)](_0x1ed509=>{telegramError(_0x1ed509);}),tgBot['on']('callback_query',async _0xd1342f=>{const _0x3863f4=_0x292e45,_0x1d7305=_0xd1342f[_0x3863f4(0x1c6)],_0x387a37=_0xd1342f['message'];tgBot[_0x3863f4(0x252)](_0xd1342f['id'])['then'](async()=>{const _0x2606ba=_0x3863f4;_0x1d7305==_0x2606ba(0x276)&&(await tgBot[_0x2606ba(0x2c9)](_0x387a37['chat']['id'],_0x2606ba(0x20a))[_0x2606ba(0x1f7)](_0x2df1b0=>{telegramError(_0x2df1b0);}),updateBB('update')),_0x1d7305=='no'&&await tgBot[_0x2606ba(0x2c9)](_0x387a37[_0x2606ba(0x1ba)]['id'],_0x2606ba(0x2e2))[_0x2606ba(0x1f7)](_0x5434c4=>{telegramError(_0x5434c4);});}),tgBot[_0x3863f4(0x236)]('callback_query');}));}),tgBot[_0x2faec1(0x162)](/\/reinstall/,async _0x424135=>{const _0x1478b2=_0x2faec1;if(!validateTelegram(_0x424135))return;tgBot[_0x1478b2(0x236)]('callback_query'),!validInstallation?tgBot[_0x1478b2(0x2c9)](_0x424135[_0x1478b2(0x1ba)]['id'],_0x1478b2(0x26d))[_0x1478b2(0x1f7)](_0xd86499=>{telegramError(_0xd86499);}):(tgBot['sendMessage'](_0x424135['chat']['id'],_0x1478b2(0x19b),{'reply_markup':{'inline_keyboard':[[{'text':_0x1478b2(0x2b1),'callback_data':_0x1478b2(0x276)},{'text':'No','callback_data':'no'}]]}})[_0x1478b2(0x1f7)](_0x36242e=>{telegramError(_0x36242e);}),tgBot['on'](_0x1478b2(0x310),async _0x40119e=>{const _0x4c7731=_0x1478b2,_0x18e8f3=_0x40119e['data'],_0x42d3f8=_0x40119e['message'];tgBot[_0x4c7731(0x252)](_0x40119e['id'])[_0x4c7731(0x245)](async()=>{const _0x3424c1=_0x4c7731;_0x18e8f3=='yes'&&(await tgBot[_0x3424c1(0x2c9)](_0x42d3f8[_0x3424c1(0x1ba)]['id'],_0x3424c1(0x1fd))[_0x3424c1(0x1f7)](_0x58ec81=>{telegramError(_0x58ec81);}),updateBB(_0x3424c1(0x267))),_0x18e8f3=='no'&&await tgBot[_0x3424c1(0x2c9)](_0x42d3f8['chat']['id'],_0x3424c1(0x168))['catch'](_0x4c22eb=>{telegramError(_0x4c22eb);});}),tgBot['removeListener']('callback_query');}));}),tgBot['onText'](/\/toggle/,_0x4a5322=>{const _0x429bfe=_0x2faec1;if(!validateTelegram(_0x4a5322))return;tgBot[_0x429bfe(0x236)]('callback_query');const _0x454c28=getBotsWithMode();if(_0x454c28[_0x429bfe(0x238)]==0x0)tgBot[_0x429bfe(0x2c9)](_0x4a5322['chat']['id'],_0x429bfe(0x303))[_0x429bfe(0x1f7)](_0x42c1a1=>{telegramError(_0x42c1a1);});else{let _0x264117=[],_0x5f5e00=[];const _0x434d3e=0x2;let _0x5e8e15=0x0;_0x454c28[_0x429bfe(0x224)]((_0x3e96b4,_0x2a7bd2)=>{const _0x5b3029=_0x429bfe;if(_0x2a7bd2%_0x434d3e==0x0)_0x5f5e00=[];_0x5f5e00['push']({'text':_0x5b3029(0x289)+_0x3e96b4[_0x5b3029(0x202)]+'\x20('+_0x3e96b4['mode']+')','callback_data':_0x3e96b4[_0x5b3029(0x202)]}),_0x2a7bd2%_0x434d3e==0x0&&(_0x264117[_0x5e8e15]=_0x5f5e00,_0x5e8e15++);}),tgBot[_0x429bfe(0x2c9)](_0x4a5322[_0x429bfe(0x1ba)]['id'],_0x429bfe(0x185),{'reply_markup':{'inline_keyboard':_0x264117}})[_0x429bfe(0x1f7)](_0x50cde1=>{telegramError(_0x50cde1);}),tgBot['on']('callback_query',async _0x4336ec=>{const _0x10cbbf=_0x429bfe,_0x4543a0=_0x4336ec[_0x10cbbf(0x1c6)],_0x312446=_0x4336ec[_0x10cbbf(0x283)];tgBot[_0x10cbbf(0x252)](_0x4336ec['id'])[_0x10cbbf(0x245)](async()=>{const _0x3b37cf=_0x10cbbf,_0x2e9b39=_0x454c28[_0x3b37cf(0x1b0)](_0x485392=>_0x485392[_0x3b37cf(0x202)]==_0x4543a0),_0x40d268=_0x2e9b39[_0x3b37cf(0x1db)]==_0x3b37cf(0x321)?_0x3b37cf(0x2df):_0x3b37cf(0x321);tgBot[_0x3b37cf(0x2c9)](_0x312446['chat']['id'],_0x3b37cf(0x2cd)+_0x4543a0+_0x3b37cf(0x191)+_0x40d268+'\x20mode')[_0x3b37cf(0x1f7)](_0x8d33cc=>{telegramError(_0x8d33cc);}),toggleBotMode(_0x4543a0);}),tgBot[_0x10cbbf(0x236)](_0x10cbbf(0x310));});}}),tgBot[_0x2faec1(0x162)](/\/names/,_0x375e98=>{const _0x182fb4=_0x2faec1;if(!validateTelegram(_0x375e98))return;let _0x109bb4='';config[_0x182fb4(0x224)](_0x259839=>{const _0x2979e6=_0x182fb4;_0x109bb4+=_0x2979e6(0x289)+_0x259839[_0x2979e6(0x202)]+':\x20'+_0x259839[_0x2979e6(0x1a1)]+'\x0a';}),tgBot[_0x182fb4(0x2c9)](_0x375e98[_0x182fb4(0x1ba)]['id'],_0x109bb4,{'parse_mode':_0x182fb4(0x29b)})['catch'](_0x3cde64=>{telegramError(_0x3cde64);});}),tgBot[_0x2faec1(0x162)](/\/disable/,_0x38661f=>{const _0x515e52=_0x2faec1;if(!validateTelegram(_0x38661f))return;tgBot[_0x515e52(0x2c9)](_0x38661f[_0x515e52(0x1ba)]['id'],'Notifications\x20disabled')['catch'](_0x540afe=>{telegramError(_0x540afe);}),updateSetting(_0x515e52(0x1a9),![]);}),tgBot['onText'](/\/help/,_0x3fe0a3=>{const _0x4a1754=_0x2faec1;if(!validateTelegram(_0x3fe0a3))return;tgBot[_0x4a1754(0x2c9)](_0x3fe0a3[_0x4a1754(0x1ba)]['id'],_0x38975a)[_0x4a1754(0x1f7)](_0x2202ad=>{telegramError(_0x2202ad);});}),tgBot['on']('polling_error',_0x56cb26=>{const _0x455c6c=_0x2faec1;_0x56cb26[_0x455c6c(0x1d1)]()[_0x455c6c(0x26e)](_0x455c6c(0x2d3))&&(logger[_0x455c6c(0x187)](_0x455c6c(0x200)),tgBot['stopPolling'](),tgBot=null,io['to']('botmanager')[_0x455c6c(0x16f)](_0x455c6c(0x2ad),_0x455c6c(0x200)));}),process['once'](_0x2faec1(0x1b3),()=>{const _0x5361ec=_0x2faec1;if(tgBot)tgBot[_0x5361ec(0x293)]();process[_0x5361ec(0x199)](0x1);}),process['once'](_0x2faec1(0x312),()=>{const _0x1f91ab=_0x2faec1;if(tgBot)tgBot[_0x1f91ab(0x293)]();process[_0x1f91ab(0x199)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x3c20ec,_0x3c4831){const _0x56cfa7=_0x2b9903;if(settings[_0x56cfa7(0x1a9)]){if(settings[_0x56cfa7(0x2d4)]=='all'||(_0x3c4831[_0x56cfa7(0x1e4)]==_0x56cfa7(0x210)||_0x3c4831[_0x56cfa7(0x1e4)]==_0x56cfa7(0x2a4)||_0x3c4831[_0x56cfa7(0x1e4)]=='success')&&settings['telegramEvents']==_0x56cfa7(0x22f)||_0x3c4831[_0x56cfa7(0x1e4)]==_0x56cfa7(0x231)&&settings['telegramEvents']==_0x56cfa7(0x2d2)){if(tgBot&&settings[_0x56cfa7(0x29c)]){if(_0x3c4831[_0x56cfa7(0x196)])tgBot['sendMessage'](settings[_0x56cfa7(0x29c)],_0x3c4831[_0x56cfa7(0x1a1)]+_0x56cfa7(0x197)+_0x3c4831[_0x56cfa7(0x229)])[_0x56cfa7(0x1f7)](_0x5c9878=>{telegramError(_0x5c9878);});else tgBot[_0x56cfa7(0x2c9)](settings[_0x56cfa7(0x29c)],_0x56cfa7(0x289)+_0x3c20ec+'\x20>\x20'+_0x3c4831[_0x56cfa7(0x229)])['catch'](_0x410956=>{telegramError(_0x410956);});}}}}async function sendTelegramMsg(_0x51b4f7,_0x24f8b8=_0x2b9903(0x29b)){const _0x27bc52=_0x2b9903;return settings[_0x27bc52(0x1a9)]&&tgBot&&settings[_0x27bc52(0x29c)]?(await tgBot[_0x27bc52(0x2c9)](settings[_0x27bc52(0x29c)],_0x51b4f7,{'parse_mode':_0x24f8b8})['catch'](_0x57f481=>{telegramError(_0x57f481);}),!![]):![];}function getDeviceWithIp(_0x5612eb){const _0xfd4205=_0x2b9903;return devices[_0xfd4205(0x1b0)](_0x43c8f7=>_0x43c8f7['ip']===_0x5612eb);}function temporaryAccess2FA(_0x62fb25,_0x37f545){const _0x3d1d31=_0x2b9903;let _0x8c7ed2=new Date(),_0xc1e0cb=![];if(lastIpApproval){if(_0x8c7ed2-lastIpApproval<0x1388)_0xc1e0cb=!![];}lastIpApproval=new Date();if(_0xc1e0cb)return;tgBot&&settings[_0x3d1d31(0x29c)]&&(tgBot[_0x3d1d31(0x236)](_0x3d1d31(0x310)),tgBot[_0x3d1d31(0x2c9)](settings[_0x3d1d31(0x29c)],_0x3d1d31(0x1eb)+normalizeIP(_0x37f545)[_0x3d1d31(0x1ee)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x3d1d31(0x253),'callback_data':'5'},{'text':_0x3d1d31(0x1a5),'callback_data':'15'},{'text':_0x3d1d31(0x2a1),'callback_data':'30'},{'text':_0x3d1d31(0x31e),'callback_data':'reject'}]]}})[_0x3d1d31(0x1f7)](_0x230294=>{telegramError(_0x230294);}),tgBot['on'](_0x3d1d31(0x310),async _0x2e0c8c=>{const _0x2d202f=_0x3d1d31,_0x3ce1a=_0x2e0c8c[_0x2d202f(0x1c6)],_0x4938f3=_0x2e0c8c[_0x2d202f(0x283)];tgBot['answerCallbackQuery'](_0x2e0c8c['id'])[_0x2d202f(0x245)](async()=>{const _0x2711a8=_0x2d202f;devices[_0x62fb25]['telegramIpApproval']={'clientip':_0x37f545,'timestamp':new Date()[_0x2711a8(0x23b)](),'expiry':_0x3ce1a},_0x3ce1a!=_0x2711a8(0x31e)?(await tgBot[_0x2711a8(0x2c9)](_0x4938f3[_0x2711a8(0x1ba)]['id'],_0x2711a8(0x1f6)+_0x3ce1a+_0x2711a8(0x1ef),{'parse_mode':'HTML'})[_0x2711a8(0x1f7)](_0x2c31a8=>{telegramError(_0x2c31a8);}),io['to'](_0x62fb25)[_0x2711a8(0x16f)]('status',{'access':{'allow':![],'reason':_0x2711a8(0x246),'token':null}})):(await tgBot[_0x2711a8(0x2c9)](_0x4938f3[_0x2711a8(0x1ba)]['id'],'Temporary\x20access\x20rejected')[_0x2711a8(0x1f7)](_0x2dbcc0=>{telegramError(_0x2dbcc0);}),io['to'](_0x62fb25)[_0x2711a8(0x16f)](_0x2711a8(0x2cb),{'access':{'allow':![],'reason':_0x2711a8(0x272),'token':null}}));}),tgBot[_0x2d202f(0x236)](_0x2d202f(0x310));}));}function loginAccess2FA(_0x3f181d,_0x127102){const _0x3552ec=_0x2b9903;tgBot&&settings[_0x3552ec(0x29c)]&&(tgBot[_0x3552ec(0x236)](_0x3552ec(0x310)),tgBot['sendMessage'](settings[_0x3552ec(0x29c)],_0x3552ec(0x23a)+normalizeIP(_0x127102)[_0x3552ec(0x1ee)]+_0x3552ec(0x262),{'parse_mode':_0x3552ec(0x29b),'reply_markup':{'inline_keyboard':[[{'text':_0x3552ec(0x1f3),'callback_data':loginExpiry},{'text':_0x3552ec(0x31e),'callback_data':_0x3552ec(0x31e)}]]}})[_0x3552ec(0x1f7)](_0x4a3fab=>{telegramError(_0x4a3fab);}),tgBot['on']('callback_query',async _0x12fc4f=>{const _0x26245b=_0x3552ec,_0x1ce2ef=_0x12fc4f[_0x26245b(0x1c6)],_0x3696af=_0x12fc4f[_0x26245b(0x283)];tgBot[_0x26245b(0x252)](_0x12fc4f['id'])[_0x26245b(0x245)](async()=>{const _0x324d86=_0x26245b;devices[_0x3f181d][_0x324d86(0x16c)]={'clientip':_0x127102,'timestamp':new Date()[_0x324d86(0x23b)](),'expiry':_0x1ce2ef},_0x1ce2ef!=_0x324d86(0x31e)?(await tgBot['sendMessage'](_0x3696af[_0x324d86(0x1ba)]['id'],_0x324d86(0x20d),{'parse_mode':_0x324d86(0x29b)})['catch'](_0x2b71be=>{telegramError(_0x2b71be);}),io['to'](_0x3f181d)[_0x324d86(0x16f)](_0x324d86(0x2cb),{'access':{'allow':![],'reason':_0x324d86(0x246),'token':null}})):(await tgBot[_0x324d86(0x2c9)](_0x3696af[_0x324d86(0x1ba)]['id'],_0x324d86(0x214))[_0x324d86(0x1f7)](_0x12dc09=>{telegramError(_0x12dc09);}),io['to'](_0x3f181d)['emit'](_0x324d86(0x2cb),{'access':{'allow':![],'reason':_0x324d86(0x17c),'token':null}}));}),tgBot[_0x26245b(0x236)](_0x26245b(0x310));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x5061e5=_0x2b9903;return dbConfig[_0x5061e5(0x23e)](_0x5061e5(0x1f4))[_0x5061e5(0x215)](_0x5061e5(0x202))['filter']({'status':_0x5061e5(0x20f)})[_0x5061e5(0x171)]()||[];}function getDisabledBots(){const _0x49bfb0=_0x2b9903;return dbConfig[_0x49bfb0(0x23e)](_0x49bfb0(0x1f4))[_0x49bfb0(0x215)]('botID')[_0x49bfb0(0x234)]({'status':_0x49bfb0(0x222)})['value']()||[];}function getBotAttributes(_0x1bd066){const _0x567e3c=_0x2b9903;let _0x11e321={};const _0x35445b=configpath+'bot-'+_0x1bd066+_0x567e3c(0x279),_0x18d725=fs['existsSync'](_0x35445b);if(_0x18d725){const _0x123a09=fs['readFileSync'](_0x35445b);try{const _0x5543f6=JSON['parse'](_0x123a09),_0x364896=_0x5543f6?_0x5543f6[_0x567e3c(0x23d)][0x0][_0x567e3c(0x19f)]:![];_0x11e321[_0x567e3c(0x1db)]=_0x364896?'auto':_0x567e3c(0x2df),_0x11e321['botname']=_0x5543f6?_0x5543f6['bot'][0x0][_0x567e3c(0x1a1)]:_0x567e3c(0x289)+_0x1bd066;}catch(_0x130b55){_0x11e321['mode']='manual',_0x11e321[_0x567e3c(0x1a1)]=_0x567e3c(0x289)+_0x1bd066;}}else _0x11e321[_0x567e3c(0x1db)]=_0x567e3c(0x2df),_0x11e321['botname']='Bot\x20'+_0x1bd066;return _0x11e321;}function getBotsWithMode(){const _0x10a11a=_0x2b9903,_0x181cf0=dbConfig['get'](_0x10a11a(0x1f4))[_0x10a11a(0x215)](_0x10a11a(0x202))['value']()||[];return _0x181cf0[_0x10a11a(0x224)](_0x25bdfb=>{const _0x431f38=_0x10a11a;let _0x26d580=getBotAttributes(_0x25bdfb[_0x431f38(0x202)]);_0x25bdfb[_0x431f38(0x1db)]=_0x26d580['mode'];}),_0x181cf0;}function getBotExchanges(){const _0x5914e6=_0x2b9903;let _0x2d8992=[];const _0x292c44=dbConfig['get'](_0x5914e6(0x1f4))[_0x5914e6(0x215)](_0x5914e6(0x202))[_0x5914e6(0x171)]()||[];_0x292c44[_0x5914e6(0x224)](_0x338473=>{const _0x40d9cd=_0x5914e6;if(_0x338473[_0x40d9cd(0x2cb)]==_0x40d9cd(0x20f)){const _0x56ed73=configpath+'bot-'+_0x338473[_0x40d9cd(0x202)]+_0x40d9cd(0x279),_0xe16bf5=fs[_0x40d9cd(0x27f)](_0x56ed73);let _0x3f9018;if(_0xe16bf5){const _0xfc36be=fs[_0x40d9cd(0x19e)](_0x56ed73);try{const _0x5db552=JSON['parse'](_0xfc36be);_0x3f9018=_0x5db552?_0x5db552[_0x40d9cd(0x23d)][0x0][_0x40d9cd(0x23f)]:null;}catch(_0xf39c81){}}if(_0x3f9018)_0x2d8992['push'](_0x3f9018);}});const _0x5b3e69=[...new Set(_0x2d8992)][_0x5914e6(0x2d6)]();return _0x5b3e69;}async function initUser(){const _0x10926b=_0x2b9903;if(!settings[_0x10926b(0x221)]){const _0x4aac13=uuidRandom();mixpanel[_0x10926b(0x1a4)](_0x4aac13),updateSetting(_0x10926b(0x221),_0x4aac13);}}async function initSecure(){const _0x221a76=_0x2b9903;let _0x205ac2=getSecure();if(!_0x205ac2[_0x221a76(0x2e7)](_0x221a76(0x232))){let _0x536001=await generateKeys();_0x205ac2['publicKey']=_0x536001[_0x221a76(0x2be)],_0x205ac2[_0x221a76(0x301)]=_0x536001[_0x221a76(0x301)],_0x205ac2[_0x221a76(0x232)]=crypto[_0x221a76(0x2d1)](0x20)[_0x221a76(0x1d1)](_0x221a76(0x18f));;storeSecure(_0x205ac2);}}function getSettings(){const _0x390533=_0x2b9903;return dbSettings[_0x390533(0x23e)](_0x390533(0x2b3))[_0x390533(0x171)]()||{};}function getSecure(){const _0x236d57=_0x2b9903;return dbSecure[_0x236d57(0x23e)](_0x236d57(0x2a7))['value']()||{};}function getBlacklist(){const _0xd9ed03=_0x2b9903;return dbSecure[_0xd9ed03(0x23e)](_0xd9ed03(0x2b6))[_0xd9ed03(0x171)]()||[];}function broadcastToBots(_0x1e7bbf,_0x1f28a4){const _0x90aa27=_0x2b9903;config[_0x90aa27(0x224)](_0x1ddab4=>{const _0x45c209=_0x90aa27;if(_0x1ddab4[_0x45c209(0x2cb)]==_0x45c209(0x20f)&&_0x1ddab4['live']==_0x45c209(0x2b8)||_0x1ddab4[_0x45c209(0x2cb)]=='new'&&_0x1ddab4['live']==_0x45c209(0x2b8)){if(pid[_0x1ddab4['botID']])pid[_0x1ddab4['botID']]['send']({[_0x1e7bbf]:_0x1f28a4});}});}function storeSettings(_0x4ca70f,_0x1fde7d=![]){const _0x20c02d=_0x2b9903;_0x4ca70f={...settings,..._0x4ca70f};if(_0x1fde7d&&_0x4ca70f[_0x20c02d(0x2bd)]!=_0x20c02d(0x206)&&_0x4ca70f[_0x20c02d(0x2bd)]!=_0x20c02d(0x1fa)&&_0x4ca70f[_0x20c02d(0x2bd)]!=''){const _0x16b27b=crypt[_0x20c02d(0x277)](secure[_0x20c02d(0x301)],_0x4ca70f[_0x20c02d(0x2bd)])[_0x20c02d(0x283)][_0x20c02d(0x1c2)]('@')[0x0],_0x2aa617=bcrypt['hashSync'](_0x16b27b,saltRounds);_0x4ca70f={..._0x4ca70f,'bbPassword':_0x2aa617};}if(_0x1fde7d&&_0x4ca70f[_0x20c02d(0x299)]!=_0x20c02d(0x206)&&_0x4ca70f['telegramToken']!='***'&&_0x4ca70f[_0x20c02d(0x299)]!=''){const _0x57de71=crypt['decrypt'](secure['privateKey'],_0x4ca70f['telegramToken'])[_0x20c02d(0x283)][_0x20c02d(0x1c2)]('@')[0x0];_0x4ca70f={..._0x4ca70f,'telegramToken':_0x57de71};}const _0x448ae8=_0x4ca70f[_0x20c02d(0x299)]!='************'&&_0x4ca70f[_0x20c02d(0x299)]!=settings[_0x20c02d(0x299)]||_0x4ca70f[_0x20c02d(0x1d9)]!=settings[_0x20c02d(0x1d9)],_0x5cba83=_0x4ca70f[_0x20c02d(0x299)]==''||_0x4ca70f['telegramUsername']=='';if(_0x448ae8)_0x4ca70f[_0x20c02d(0x2d4)]=_0x20c02d(0x318);for(const [_0x45f111,_0x1f1724]of Object[_0x20c02d(0x1ca)](_0x4ca70f)){if(_0x45f111==_0x20c02d(0x299)&&_0x1f1724==_0x20c02d(0x206)){_0x4ca70f[_0x20c02d(0x299)]=settings[_0x20c02d(0x299)];continue;};if(_0x45f111==_0x20c02d(0x2bd)&&_0x1f1724==_0x20c02d(0x206)){_0x4ca70f[_0x20c02d(0x2bd)]=settings[_0x20c02d(0x2bd)];continue;};dbSettings[_0x20c02d(0x2d9)]('settings.'+_0x45f111,_0x1f1724)[_0x20c02d(0x292)]();}settings=_0x4ca70f,io['to'](_0x20c02d(0x282))[_0x20c02d(0x16f)](_0x20c02d(0x2b3),cleanSettings()),broadcastToBots(_0x20c02d(0x18d),settings[_0x20c02d(0x18d)]),broadcastToBots(_0x20c02d(0x259),settings[_0x20c02d(0x259)]);if(_0x448ae8&&!_0x5cba83)initTelegram();if(_0x448ae8&&_0x5cba83)disableTelegram();getAllClients()['forEach'](_0x1f26eb=>{const _0x50b2fb=_0x20c02d;getSocket(_0x1f26eb['id'])['emit'](_0x50b2fb(0x2cb),{'access':{'allow':![],'reason':_0x50b2fb(0x246),'token':null}});});}function updateSetting(_0x33fe9d,_0x3359d0){const _0x9dbed8=_0x2b9903;dbSettings[_0x9dbed8(0x2d9)](_0x9dbed8(0x213)+_0x33fe9d,_0x3359d0)[_0x9dbed8(0x292)](),settings=getSettings(),io['to'](_0x9dbed8(0x282))['emit']('settings',cleanSettings());}function storeSecure(_0x225298){const _0x1dd0a7=_0x2b9903;dbSecure[_0x1dd0a7(0x23e)]('secure')[_0x1dd0a7(0x2a8)](_0x225298)[_0x1dd0a7(0x292)](),secure=_0x225298;}function addBlacklist(_0x454b3d){const _0x3ac7af=_0x2b9903;cleanBlacklist();let _0x1530be;devices[_0x454b3d]['telegramIpApproval']?_0x1530be=Math['max'](devices[_0x454b3d]['telegramIpApproval']['expiry'],loginExpiry):_0x1530be=loginExpiry,dbSecure[_0x3ac7af(0x23e)](_0x3ac7af(0x2b6))[_0x3ac7af(0x2a8)]({'expiry':new Date()[_0x3ac7af(0x23b)]()+_0x1530be*0x3c*0x3e8,'token':devices[_0x454b3d][_0x3ac7af(0x25d)][_0x3ac7af(0x1f9)]})[_0x3ac7af(0x292)](),blacklist=dbSecure[_0x3ac7af(0x23e)](_0x3ac7af(0x2b6))[_0x3ac7af(0x171)]();}function cleanBlacklist(){const _0x2794df=_0x2b9903;let _0xea1d5f=dbSecure[_0x2794df(0x23e)](_0x2794df(0x2b6))[_0x2794df(0x30e)]()[_0x2794df(0x171)](),_0xcfb5eb=new Date()[_0x2794df(0x23b)]();_0xea1d5f['forEach'](_0x18567a=>{const _0x243526=_0x2794df;_0x18567a['expiry']<_0xcfb5eb&&dbSecure['get'](_0x243526(0x2b6))[_0x243526(0x235)]({'expiry':_0x18567a[_0x243526(0x29e)]})[_0x243526(0x292)]();});}function initStates(){const _0x2f15b0=_0x2b9903;let _0x927933=getConfiguration();_0x927933[_0x2f15b0(0x224)](_0x28ed68=>{const _0x3afe74=_0x2f15b0;_0x28ed68[_0x3afe74(0x164)]=_0x3afe74(0x175);}),storeConfiguration(_0x927933);}function onKeys(){const _0x28dba3=new RSA();return new Promise(_0x3d0aea=>{const _0x28e2c0=_0x11f2;_0x28dba3['generateKeyPairAsync']()[_0x28e2c0(0x245)](_0xdd8cad=>{_0x3d0aea(_0xdd8cad);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1ae487=_0x2b9903;let _0x41d261=getSettings(),_0x1a23ce=![];!_0x41d261['hasOwnProperty'](_0x1ae487(0x1b4))&&(_0x41d261[_0x1ae487(0x1b4)]=0x0,_0x1a23ce=!![]);!_0x41d261[_0x1ae487(0x2e7)](_0x1ae487(0x220))&&(_0x41d261[_0x1ae487(0x220)]=0x0,_0x1a23ce=!![]);!_0x41d261['hasOwnProperty'](_0x1ae487(0x204))&&(_0x41d261['latestversion']='0.0.0',_0x1a23ce=!![]);!_0x41d261[_0x1ae487(0x2e7)]('onepagemode')&&(_0x41d261[_0x1ae487(0x259)]=![],_0x1a23ce=!![]);if(_0x1a23ce)storeSettings(_0x41d261);}function storeConfiguration(_0x5ce029){const _0x132c46=_0x2b9903;dbConfig[_0x132c46(0x23e)](_0x132c46(0x1f4))[_0x132c46(0x235)]()[_0x132c46(0x292)](),_0x5ce029['forEach'](_0x5e6b6b=>{const _0x154309=_0x132c46;delete _0x5e6b6b[_0x154309(0x1db)];}),dbConfig['get']('bots')[_0x132c46(0x2a8)](..._0x5ce029)[_0x132c46(0x292)](),config=_0x5ce029;}function resetPassword(){const _0x2f4e5=_0x2b9903;tgBot&&settings[_0x2f4e5(0x29c)]&&(tgBot[_0x2f4e5(0x236)](_0x2f4e5(0x310)),tgBot['sendMessage'](settings[_0x2f4e5(0x29c)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x2f4e5(0x276),'callback_data':_0x2f4e5(0x276)},{'text':'no','callback_data':'no'}]]}})[_0x2f4e5(0x1f7)](_0x5a24ca=>{telegramError(_0x5a24ca);}),tgBot['on'](_0x2f4e5(0x310),async _0x22d216=>{const _0x3b257c=_0x2f4e5,_0x39f2b2=_0x22d216[_0x3b257c(0x1c6)],_0x20c7de=_0x22d216[_0x3b257c(0x283)];tgBot[_0x3b257c(0x252)](_0x22d216['id'])['then'](async()=>{const _0x26d81e=_0x3b257c;if(_0x39f2b2!='no'){const _0x31fdb6=0xf,_0x15b3ea=_0x26d81e(0x2ec),_0x8d628b=Array[_0x26d81e(0x1a3)](crypto[_0x26d81e(0x230)](new Uint32Array(_0x31fdb6)))[_0x26d81e(0x205)](_0x53ce67=>_0x15b3ea[_0x53ce67%_0x15b3ea[_0x26d81e(0x238)]])[_0x26d81e(0x211)](''),_0x3a7da8=bcrypt['hashSync'](_0x8d628b,saltRounds);storeSettings({'bbPassword':_0x3a7da8}),await tgBot[_0x26d81e(0x2c9)](_0x20c7de[_0x26d81e(0x1ba)]['id'],_0x26d81e(0x30f)+_0x8d628b,{'parse_mode':_0x26d81e(0x29b)})[_0x26d81e(0x1f7)](_0x590200=>{telegramError(_0x590200);});}else await tgBot[_0x26d81e(0x2c9)](_0x20c7de[_0x26d81e(0x1ba)]['id'],_0x26d81e(0x17e))['catch'](_0x33281c=>{telegramError(_0x33281c);});}),tgBot[_0x3b257c(0x236)](_0x3b257c(0x310));}));}async function confirmRestore(_0x4a617e,_0x56b74b){const _0x2c6ab8=_0x2b9903;io['to']('botmanager')['emit']('notification',_0x2c6ab8(0x190),_0x2c6ab8(0x324)),tgBot&&settings['telegramChatId']&&(tgBot[_0x2c6ab8(0x236)](_0x2c6ab8(0x310)),await tgBot[_0x2c6ab8(0x2c9)](settings[_0x2c6ab8(0x29c)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':_0x2c6ab8(0x29b),'reply_markup':{'inline_keyboard':[[{'text':_0x2c6ab8(0x276),'callback_data':_0x2c6ab8(0x276)},{'text':'no','callback_data':'no'}]]}})[_0x2c6ab8(0x1f7)](_0x1d9dd5=>{telegramError(_0x1d9dd5);}),tgBot['on'](_0x2c6ab8(0x310),async _0x25c4be=>{const _0x1ebe9e=_0x2c6ab8,_0x539932=_0x25c4be['data'],_0x2ca3d5=_0x25c4be['message'];tgBot['answerCallbackQuery'](_0x25c4be['id'])[_0x1ebe9e(0x245)](async()=>{const _0x3ff06c=_0x1ebe9e;_0x539932==_0x3ff06c(0x276)?(await tgBot[_0x3ff06c(0x2c9)](_0x2ca3d5[_0x3ff06c(0x1ba)]['id'],_0x3ff06c(0x24c),{'parse_mode':_0x3ff06c(0x29b)})['catch'](_0x3eb80e=>{telegramError(_0x3eb80e);}),unzipFile(_0x4a617e,_0x56b74b)):(logger[_0x3ff06c(0x2fd)](_0x3ff06c(0x26b)),await tgBot[_0x3ff06c(0x2c9)](_0x2ca3d5[_0x3ff06c(0x1ba)]['id'],_0x3ff06c(0x26b))['catch'](_0x89c37c=>{telegramError(_0x89c37c);}));}),tgBot[_0x1ebe9e(0x236)](_0x1ebe9e(0x310));}));}function getServerTime(){const _0x23bdf1=_0x2b9903,_0x2da047=new Date();return _0x2da047['getFullYear']()+'/'+(_0x2da047[_0x23bdf1(0x28c)]()+0x1)[_0x23bdf1(0x1d1)]()[_0x23bdf1(0x1df)](0x2,'0')+'/'+_0x2da047[_0x23bdf1(0x28a)]()['toString']()[_0x23bdf1(0x1df)](0x2,'0')+'\x20'+_0x2da047[_0x23bdf1(0x1e3)]()[_0x23bdf1(0x1d1)]()[_0x23bdf1(0x1df)](0x2,'0')+':'+_0x2da047['getMinutes']()['toString']()[_0x23bdf1(0x1df)](0x2,'0')+':'+_0x2da047[_0x23bdf1(0x251)]()[_0x23bdf1(0x1d1)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x5dd284=_0x2b9903,_0x1db4e8=shiftedTime();return _0x1db4e8[_0x5dd284(0x323)]()+'/'+(_0x1db4e8[_0x5dd284(0x28c)]()+0x1)[_0x5dd284(0x1d1)]()[_0x5dd284(0x1df)](0x2,'0')+'/'+_0x1db4e8[_0x5dd284(0x28a)]()[_0x5dd284(0x1d1)]()[_0x5dd284(0x1df)](0x2,'0')+'\x20'+_0x1db4e8[_0x5dd284(0x1e3)]()[_0x5dd284(0x1d1)]()[_0x5dd284(0x1df)](0x2,'0')+':'+_0x1db4e8[_0x5dd284(0x1e7)]()[_0x5dd284(0x1d1)]()[_0x5dd284(0x1df)](0x2,'0')+':'+_0x1db4e8[_0x5dd284(0x251)]()[_0x5dd284(0x1d1)]()[_0x5dd284(0x1df)](0x2,'0');}function getCleanTimeStamp(){const _0x55d308=_0x2b9903,_0x441c45=shiftedTime();return _0x441c45[_0x55d308(0x323)]()+(_0x441c45[_0x55d308(0x28c)]()+0x1)[_0x55d308(0x1d1)]()[_0x55d308(0x1df)](0x2,'0')+_0x441c45[_0x55d308(0x28a)]()[_0x55d308(0x1d1)]()[_0x55d308(0x1df)](0x2,'0')+'-'+_0x441c45[_0x55d308(0x1e3)]()['toString']()['padStart'](0x2,'0')+_0x441c45[_0x55d308(0x1e7)]()[_0x55d308(0x1d1)]()['padStart'](0x2,'0')+_0x441c45[_0x55d308(0x251)]()[_0x55d308(0x1d1)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x3877cc=_0x2b9903,_0x4b7ad5=new Date();let _0x129dca=_0x4b7ad5;if(settings['timeshift']&&settings[_0x3877cc(0x18d)]!==0x0)_0x129dca=fns[_0x3877cc(0x188)](_0x4b7ad5,{'hours':settings[_0x3877cc(0x18d)]});return _0x129dca;}function startScheduler(){const _0x5feeaf=_0x2b9903,_0x2eb2d2=new Date()[_0x5feeaf(0x1d2)](),_0x5d7669=shiftedTime()[_0x5feeaf(0x1e3)]();_0x5d7669==0x4&&backupConfigFiles();_0x5d7669==0x0&&rotateLogFiles();_0x2eb2d2%0x6==0x0&&triggerAnalytics();_0x2eb2d2%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x4425b8){const _0x1b1bf4=_0x2b9903;logger['debug'](_0x1b1bf4(0x1b2)+_0x4425b8);const _0x4da6e3=getBotsWithMode();_0x4da6e3[_0x1b1bf4(0x238)]>0x0?confirmRestore(configbackuppath,_0x4425b8):unzipFile(configbackuppath,_0x4425b8);}async function getBackupFiles(_0x4e4856=null){const _0x156743=_0x2b9903;let _0x1b6e4e=[],_0x4ce990=fs[_0x156743(0x291)](configbackuppath,{'withFileTypes':!![]});_0x4ce990[_0x156743(0x2d6)]((_0x9488f,_0x2c9775)=>_0x9488f[_0x156743(0x315)]<_0x2c9775['name']?0x1:_0x2c9775['name']<_0x9488f[_0x156743(0x315)]?-0x1:0x0),_0x4ce990['forEach'](_0x5ed037=>{const _0x208b80=_0x156743;if(!_0x5ed037[_0x208b80(0x1bc)]()&&_0x5ed037[_0x208b80(0x315)][_0x208b80(0x19c)]('backup-full@')&&_0x5ed037[_0x208b80(0x315)][_0x208b80(0x170)]('.zip')){const _0xee1f81=formatDate(fs[_0x208b80(0x1f0)](configbackuppath+_0x5ed037[_0x208b80(0x315)])[_0x208b80(0x2bb)]);_0x1b6e4e[_0x208b80(0x2a8)]({'name':_0x5ed037[_0x208b80(0x315)],'mtime':_0xee1f81});}});if(_0x4e4856)io['to'](_0x4e4856)['emit']('backup-files',_0x1b6e4e);else return _0x1b6e4e;}async function backupConfigFiles(){const _0x17da7c=_0x2b9903;await zipFiles(_0x17da7c(0x31c));const _0x4a8ce9=getCleanTimeStamp();fs[_0x17da7c(0x1a7)](zippath+_0x17da7c(0x297),configbackuppath+(_0x17da7c(0x243)+_0x4a8ce9+_0x17da7c(0x281)));let _0x5970da=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x5970da[_0x17da7c(0x2d6)]((_0x3fe248,_0xc22b23)=>_0x3fe248[_0x17da7c(0x315)]<_0xc22b23['name']?0x1:_0xc22b23[_0x17da7c(0x315)]<_0x3fe248[_0x17da7c(0x315)]?-0x1:0x0),_0x5970da[_0x17da7c(0x238)]>maxBackups&&fs[_0x17da7c(0x29d)](configbackuppath+_0x5970da[maxBackups][_0x17da7c(0x315)]);}function rotateLogFiles(){const _0x489ba3=_0x2b9903,_0x2fb454=fs[_0x489ba3(0x1f0)](logspath+_0x489ba3(0x2bc)),_0xa3e74b=_0x2fb454[_0x489ba3(0x2af)]/0x400;if(_0xa3e74b>0x64){let _0x2bebf3=fs[_0x489ba3(0x291)](logspath,{'withFileTypes':!![]});_0x2bebf3[_0x489ba3(0x2d6)]((_0x74744f,_0x3849af)=>_0x74744f[_0x489ba3(0x315)]<_0x3849af[_0x489ba3(0x315)]?0x1:_0x3849af[_0x489ba3(0x315)]<_0x74744f['name']?-0x1:0x0),_0x2bebf3[_0x489ba3(0x224)](_0x30ca65=>{const _0x40bc72=_0x489ba3;if(_0x30ca65[_0x40bc72(0x315)]==_0x40bc72(0x266))fs[_0x40bc72(0x1a7)](logspath+_0x30ca65[_0x40bc72(0x315)],logspath+_0x40bc72(0x2b5));if(_0x30ca65[_0x40bc72(0x315)]=='output-001.log')fs[_0x40bc72(0x1a7)](logspath+_0x30ca65[_0x40bc72(0x315)],logspath+_0x40bc72(0x266));_0x30ca65[_0x40bc72(0x315)]==_0x40bc72(0x2bc)&&(fs[_0x40bc72(0x1a7)](logspath+_0x30ca65[_0x40bc72(0x315)],logspath+_0x40bc72(0x21b)),fs[_0x40bc72(0x18c)](logspath+_0x30ca65[_0x40bc72(0x315)],''));});}}async function zipFiles(_0x323b82){const _0x40448c=_0x2b9903;let _0x16790a;if(_0x323b82=='logs')_0x16790a=logspath;if(_0x323b82==_0x40448c(0x1d8))_0x16790a=configpath;if(_0x323b82==_0x40448c(0x31c))_0x16790a=configpath;let _0xc722e0=fs[_0x40448c(0x291)](_0x16790a,{'withFileTypes':!![]});const _0x20b347=new require(_0x40448c(0x27e))();_0xc722e0['forEach'](_0x4d3c4d=>{const _0x1e4088=_0x40448c;if(!_0x4d3c4d['isDirectory']()){let _0x1edb4a=fs[_0x1e4088(0x19e)](_0x16790a+_0x4d3c4d['name']);if(_0x323b82==_0x1e4088(0x1d8)){const _0x105b26=/^bot-[0-9]{3}-config.json$/,_0x2b11cc=_0x105b26[_0x1e4088(0x2cf)](_0x4d3c4d['name']);if(_0x2b11cc){const _0x549039=JSON['parse'](_0x1edb4a);_0x549039[_0x1e4088(0x23d)][0x0]&&(_0x549039[_0x1e4088(0x23d)][0x0][_0x1e4088(0x1ce)]='***',_0x549039[_0x1e4088(0x23d)][0x0][_0x1e4088(0x22b)]=_0x1e4088(0x1fa)),_0x1edb4a=JSON[_0x1e4088(0x2f7)](_0x549039,null,0x2);}if(_0x4d3c4d[_0x1e4088(0x315)]==_0x1e4088(0x2c4)){const _0x10aff0=JSON[_0x1e4088(0x178)](_0x1edb4a);if(_0x10aff0[_0x1e4088(0x2b3)]['loginRequired'])_0x10aff0[_0x1e4088(0x2b3)][_0x1e4088(0x1dd)]=![];if(_0x10aff0['settings']['bbPassword'])_0x10aff0[_0x1e4088(0x2b3)][_0x1e4088(0x2bd)]=_0x1e4088(0x1fa);if(_0x10aff0['settings'][_0x1e4088(0x299)])_0x10aff0[_0x1e4088(0x2b3)]['telegramToken']=_0x1e4088(0x1fa);if(_0x10aff0[_0x1e4088(0x2b3)][_0x1e4088(0x29c)])_0x10aff0[_0x1e4088(0x2b3)][_0x1e4088(0x29c)]=null;_0x1edb4a=JSON['stringify'](_0x10aff0,null,0x2);}if(_0x4d3c4d[_0x1e4088(0x315)]!='bb-secure.json')_0x20b347[_0x1e4088(0x1f8)](_0x4d3c4d[_0x1e4088(0x315)],_0x1edb4a);}else _0x20b347[_0x1e4088(0x1f8)](_0x4d3c4d[_0x1e4088(0x315)],_0x1edb4a);}});const _0x27b1d0=_0x20b347[_0x40448c(0x1ea)]({'base64':![],'compression':'DEFLATE'});fs[_0x40448c(0x18c)](zippath+(_0x323b82+'.zip'),_0x27b1d0,_0x40448c(0x1a8));}async function unzipFile(_0x53480f,_0x367390){const _0x264d23=_0x2b9903;fs[_0x264d23(0x291)](configpath,{'withFileTypes':!![]})[_0x264d23(0x224)](_0x51fab7=>{const _0x5f2a49=_0x264d23;if(!_0x51fab7[_0x5f2a49(0x1bc)]())fs[_0x5f2a49(0x28b)](configpath+_0x51fab7[_0x5f2a49(0x315)]);});const _0x2ca234=fs['readFileSync'](_0x53480f+_0x367390,'binary'),_0x540fd7=new require(_0x264d23(0x27e))(_0x2ca234,{'base64':![],'checkCRC32':!![]});Object[_0x264d23(0x1cb)](_0x540fd7['files'])['forEach'](_0x202879=>{const _0x1941c2=_0x264d23,_0x47f1f7=_0x540fd7[_0x1941c2(0x2b4)][_0x202879];fs['writeFileSync'](configpath+_0x47f1f7[_0x1941c2(0x315)],_0x47f1f7[_0x1941c2(0x2b7)]);}),fs[_0x264d23(0x291)](temppath,{'withFileTypes':!![]})[_0x264d23(0x224)](_0x3261a1=>{const _0x1ba4a0=_0x264d23;if(!_0x3261a1[_0x1ba4a0(0x1bc)]())fs['rmSync'](temppath+_0x3261a1['name']);}),logger['debug'](_0x264d23(0x20b)),process[_0x264d23(0x1af)]({'restore':!![]},_0x3ffb99=>{});}async function getPublicIp(){const _0x59e1fc=_0x2b9903;try{const _0x3228be=await axios[_0x59e1fc(0x23e)](_0x59e1fc(0x319));publicip=_0x3228be[_0x59e1fc(0x1c6)]['ip'];}catch(_0x21d92d){}}async function triggerAnalytics(){const _0x214dd1=_0x2b9903;if(!publicip)await getPublicIp();const _0x28eda6=getBotsWithMode();let _0x5eea79=0x0;_0x28eda6[_0x214dd1(0x224)](_0x4ccc61=>{const _0x31427b=_0x214dd1;if(_0x4ccc61[_0x31427b(0x2cb)]===_0x31427b(0x20f))_0x5eea79++;});const _0x38d9db=getBotExchanges();mixpanel[_0x214dd1(0x274)](_0x214dd1(0x183),{'distinct_id':settings[_0x214dd1(0x221)],'ip':publicip,'version':serverversion,'numbots':_0x28eda6[_0x214dd1(0x238)],'numbotsenabled':_0x5eea79,'exchanges':_0x38d9db});}async function getMessages(){const _0x5ec0ba=_0x2b9903,_0x395286=_0x5ec0ba(0x2e4),_0x5a929=new GraphQLClient(_0x395286),_0x5cb848={'authorization':_0x5ec0ba(0x2fb)},_0x48b1a5=serverversion[_0x5ec0ba(0x1c2)]('.'),_0x1c6764=_0x48b1a5[0x0]+'.'+_0x48b1a5[0x1],_0x518b55=Math[_0x5ec0ba(0x30b)](settings[_0x5ec0ba(0x1b4)],settings['lastmsgemitted']),_0x20366c={'last':parseInt(_0x518b55),'bbm':_0x1c6764},_0x3428a9=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x27f6b4;try{_0x27f6b4=await _0x5a929[_0x5ec0ba(0x2e1)](_0x3428a9,_0x20366c,_0x5cb848);}catch(_0x2cb3cc){}if(_0x27f6b4&&_0x27f6b4['messages']){let _0x36149e=settings[_0x5ec0ba(0x1b4)];newMessages=[];for(const _0x19fc24 of _0x27f6b4['messages']){newMessages['push'](_0x19fc24);if(_0x19fc24['bbvNew'])updateSetting(_0x5ec0ba(0x204),_0x19fc24['bbvNew']);let _0x2413a2=_0x19fc24[_0x5ec0ba(0x2a2)]?serverversion>=_0x19fc24['bbvNew']:![];if(!_0x2413a2&&_0x19fc24[_0x5ec0ba(0x1d4)]>_0x36149e){if(_0x19fc24[_0x5ec0ba(0x2f9)]===_0x5ec0ba(0x295)||serverversion[_0x5ec0ba(0x19c)](_0x19fc24[_0x5ec0ba(0x2f9)])){let _0x545cc5=''+_0x19fc24[_0x5ec0ba(0x300)]+'\x0a\x0a'+_0x19fc24['message'];const _0x3eb237=await sendTelegramMsg(toTelegramMarkdown(_0x545cc5),_0x5ec0ba(0x24b));if(_0x3eb237)_0x36149e=_0x19fc24['number'];}}}updateAvailable=isNewerVersion(settings[_0x5ec0ba(0x204)],serverversion),updateSetting('lastmsgtelegram',_0x36149e),emitMessages();}}function emitMessages(){const _0x4924db=_0x2b9903,_0x1db0ca=settings[_0x4924db(0x220)];let _0x30a31e=[];newMessages['forEach'](_0x9517da=>{const _0x1ece98=_0x4924db;_0x9517da[_0x1ece98(0x1d4)]>_0x1db0ca&&_0x30a31e['push'](_0x9517da);}),_0x30a31e['length']>0x0&&getAllClients()[_0x4924db(0x224)](_0xf5e9de=>{const _0x2a4ab9=_0x4924db;getSocket(_0xf5e9de['id'])[_0x2a4ab9(0x16f)](_0x2a4ab9(0x283),_0x30a31e);});}function confirmMessage(_0x4ca09c){updateSetting('lastmsgemitted',Number(_0x4ca09c));}function isNewerVersion(_0x50ddd2,_0x3665e1){const _0x11c4a3=_0x2b9903,_0x32d6cc=_0x3665e1[_0x11c4a3(0x1c2)]('.'),_0x10acea=_0x50ddd2[_0x11c4a3(0x1c2)]('.');for(var _0x2666d4=0x0;_0x2666d4<_0x10acea[_0x11c4a3(0x238)];_0x2666d4++){const _0x299417=~~_0x10acea[_0x2666d4],_0x23c10b=~~_0x32d6cc[_0x2666d4];if(_0x299417>_0x23c10b)return!![];if(_0x299417<_0x23c10b)return![];}return![];}function toTelegramMarkdown(_0x3574a1){const _0x259709=_0x2b9903,_0x57e904=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x281b1f=/\*{2}(.+?)\*{2}/gim;return _0x3574a1=_0x3574a1[_0x259709(0x298)](_0x57e904,_0x259709(0x305))[_0x259709(0x298)](_0x281b1f,'*$1*'),_0x3574a1;}async function validateConfigFile(){const _0x5d4774=_0x2b9903,_0x35365b=dbConfig[_0x5d4774(0x23e)](_0x5d4774(0x1f4))[_0x5d4774(0x215)](_0x5d4774(0x202))[_0x5d4774(0x171)]()||[];if(_0x35365b['length']==0x0){let _0x4a0e0c=0x0,_0x3e1aa9=[];const _0x14e8b4=/^bot-([0-9]{3})-config.json$/,_0x5403bf=fs[_0x5d4774(0x291)](configpath);_0x5403bf[_0x5d4774(0x224)](_0x1032a9=>{const _0x310927=_0x5d4774,_0x5f1d9e=_0x14e8b4[_0x310927(0x25f)](_0x1032a9);if(_0x5f1d9e){const _0x5db69e=_0x5f1d9e[0x1];let _0x2d307d=getBotAttributes(_0x5db69e);_0x3e1aa9[_0x310927(0x2a8)]({'botID':_0x5db69e,'botname':_0x2d307d[_0x310927(0x1a1)],'status':_0x310927(0x222),'live':'stopped'}),_0x4a0e0c++;}}),_0x4a0e0c!=0x0&&(dbConfig[_0x5d4774(0x23e)]('bots')[_0x5d4774(0x1ae)](_0x3e1aa9)[_0x5d4774(0x292)](),config=_0x3e1aa9,restoredConfigFile=_0x4a0e0c);}}async function restoreConfigNotify(_0x3c5345){const _0x376ba6=_0x2b9903;let _0xba816c;if(restoredConfigFile==0x1)_0xba816c=_0x376ba6(0x27c);else _0xba816c=_0x376ba6(0x26a);if(_0x3c5345)io['to'](_0x376ba6(0x282))[_0x376ba6(0x16f)](_0x376ba6(0x2ad),_0xba816c);else{logger[_0x376ba6(0x1a0)](_0x376ba6(0x237)),logger[_0x376ba6(0x1a0)](_0xba816c),logger[_0x376ba6(0x1a0)](_0x376ba6(0x237)),logger[_0x376ba6(0x1a0)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x376ba6(0x2d4)]!=_0x376ba6(0x2d2))tgBot[_0x376ba6(0x2c9)](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0xba816c)[_0x376ba6(0x1f7)](_0x1c8841=>{telegramError(_0x1c8841);});}}function validateCredentials(_0x279cff,_0x59cd72){const _0x28054e=_0x2b9903;if(_0x279cff['username']==settings[_0x28054e(0x2da)]&&bcrypt[_0x28054e(0x1d6)](_0x279cff[_0x28054e(0x320)],settings[_0x28054e(0x2bd)])){if(settings[_0x28054e(0x193)])return{'allow':![],'reason':_0x28054e(0x2dc),'token':null};else{const _0x139375=generateLoginToken(_0x59cd72);return{'allow':!![],'reason':_0x28054e(0x17a),'token':_0x139375};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x16f89f){const _0x1e8e3c=generateLoginToken(_0x16f89f);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x1e8e3c};}function validateAccess(_0x130bee,_0x47e53a,_0x4f1e58){const _0x377ab7=_0x2b9903,_0x2626c1=_0x4f1e58?_0x4f1e58:devices[_0x47e53a]['ip'];let _0x2df929;const _0x26e674=_0x35fe92=>{const _0x567bb9=_0x11f2;if(settings[_0x567bb9(0x1dd)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x47e53a)){const _0x595e47=generateLoginToken(_0x47e53a);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x595e47};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x2df929=validToken(_0x35fe92,_0x47e53a),_0x2df929['hasOwnProperty'](_0x567bb9(0x324))?{'allow':!![],'reason':_0x567bb9(0x307),'token':_0x35fe92}:{'allow':![],'reason':_0x567bb9(0x2ce),'token':null};}else return{'allow':!![],'reason':_0x567bb9(0x2e8),'token':null};};if(settings[_0x377ab7(0x2e0)]){let _0x917819=[...settings['whitelist'],_0x377ab7(0x1be),'::ffff:127.0.0.1',_0x377ab7(0x16e)];if(_0x917819[_0x377ab7(0x26e)](_0x2626c1))return _0x26e674(_0x130bee);else{_0x2df929=validToken(_0x130bee,_0x47e53a);if(_0x2df929[_0x377ab7(0x2e7)](_0x377ab7(0x324)))return _0x26e674(_0x130bee);else{if(telegramIpApproved(_0x47e53a)){const _0x39f257=generateToken(_0x47e53a);return _0x2df929=_0x26e674(_0x130bee),_0x2df929['allow']?{'allow':!![],'reason':_0x377ab7(0x1d3),'token':_0x39f257}:_0x2df929;}else return settings[_0x377ab7(0x314)]?{'allow':![],'reason':_0x377ab7(0x2ff),'token':null}:{'allow':![],'reason':_0x377ab7(0x212),'token':null};}}}else return _0x26e674(_0x130bee);}function timelyDecrypt(_0x1eb3a9,_0xf9fe70=!![]){const _0x24de77=_0x2b9903;if(_0x1eb3a9)try{const _0x3cbd0e=crypt[_0x24de77(0x277)](secure[_0x24de77(0x301)],_0x1eb3a9)[_0x24de77(0x283)],_0x5ec69b=_0x3cbd0e[_0x24de77(0x1c2)]('@')[0x0],_0x335b3e=_0x3cbd0e[_0x24de77(0x1c2)]('@')[0x1],_0x32d6a3=new Date()[_0x24de77(0x23b)]();if(_0xf9fe70){if(_0x32d6a3-_0x335b3e<maxSecretAge*0x3e8)return _0x5ec69b;else return![];}else return _0x5ec69b;}catch(_0x44a0c0){return![];}else return![];}const validToken=(_0x3cc70b,_0x4646af)=>{const _0x1f2426=_0x2b9903,_0x49906f=devices[_0x4646af]['ip'];if(!_0x3cc70b)return{'error':_0x1f2426(0x1c4)};for(let _0xbedb9e of blacklist){if(_0xbedb9e[_0x1f2426(0x1f9)]==_0x3cc70b)return{'error':_0x1f2426(0x17b)};}let _0x2dc9f5;try{_0x2dc9f5=jwt['verify'](_0x3cc70b,secure[_0x1f2426(0x232)]+_0x4646af);}catch{return{'error':_0x1f2426(0x2fc)};}if(!_0x2dc9f5['hasOwnProperty']('clientip')&&!_0x2dc9f5[_0x1f2426(0x2e7)]('username')||!_0x2dc9f5['hasOwnProperty'](_0x1f2426(0x1b9)))return{'error':_0x1f2426(0x25c)};if(!_0x2dc9f5['hasOwnProperty'](_0x1f2426(0x302))&&_0x2dc9f5[_0x1f2426(0x2e7)](_0x1f2426(0x296))){const {clientip:_0x473e6f}=_0x2dc9f5;return _0x49906f==_0x473e6f?{'success':_0x1f2426(0x29a)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x2dc9f5[_0x1f2426(0x2e7)](_0x1f2426(0x302))&&_0x2dc9f5[_0x1f2426(0x2e7)]('clientip')){const {username:_0xa91afa,clientip:_0x457a6b}=_0x2dc9f5;return settings[_0x1f2426(0x2da)]==_0xa91afa&&_0x49906f==_0x457a6b?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x1f2426(0x184)};}}},generateLoginToken=_0x356243=>{const _0x3ec77d=_0x2b9903;if(_0x356243){const _0x36e3c0=devices[_0x356243]['ip'];return jwt[_0x3ec77d(0x263)]({'username':settings['bbUsername'],'clientip':_0x36e3c0},secure['secret']+_0x356243,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x2d9f5c=>{const _0x2745db=_0x2b9903;if(_0x2d9f5c){const _0x28b431=devices[_0x2d9f5c]['ip'];return jwt[_0x2745db(0x263)]({'clientip':_0x28b431},secure[_0x2745db(0x232)]+_0x2d9f5c,{'expiresIn':devices[_0x2d9f5c][_0x2745db(0x223)][_0x2745db(0x29e)]*0x3c});}else return![];},telegramIpApproved=_0x245808=>{const _0x4adc7f=_0x2b9903;let _0x422db2=![];return devices[_0x245808][_0x4adc7f(0x223)]&&devices[_0x245808]['telegramIpApproval'][_0x4adc7f(0x29e)]!='reject'&&(_0x422db2=devices[_0x245808][_0x4adc7f(0x223)][_0x4adc7f(0x296)]==devices[_0x245808]['ip']&&new Date()[_0x4adc7f(0x23b)]()-devices[_0x245808][_0x4adc7f(0x223)][_0x4adc7f(0x172)]<devices[_0x245808][_0x4adc7f(0x223)][_0x4adc7f(0x29e)]*0x3c*0x3e8),_0x422db2;},telegram2FaApproved=_0x870065=>{const _0x3bbfb1=_0x2b9903;let _0x4f181f=![];return devices[_0x870065][_0x3bbfb1(0x16c)]&&devices[_0x870065][_0x3bbfb1(0x16c)][_0x3bbfb1(0x29e)]!=_0x3bbfb1(0x31e)&&(_0x4f181f=devices[_0x870065][_0x3bbfb1(0x16c)][_0x3bbfb1(0x296)]==devices[_0x870065]['ip']&&new Date()['getTime']()-devices[_0x870065][_0x3bbfb1(0x16c)]['timestamp']<devices[_0x870065][_0x3bbfb1(0x16c)][_0x3bbfb1(0x29e)]*0x3c*0x3e8),_0x4f181f;},normalizeIP=_0x314f7a=>{const _0x56e950=_0x2b9903;let _0xff65b5=null,_0x395905=null;if(ipaddr['isValid'](_0x314f7a)){const _0x833176=ipaddr[_0x56e950(0x178)](_0x314f7a);_0x833176[_0x56e950(0x2d5)]()===_0x56e950(0x304)?(_0x833176[_0x56e950(0x24f)]()&&(_0xff65b5=_0x833176['toIPv4Address']()['toString']()),_0x395905=_0x833176[_0x56e950(0x1d1)]()):(_0xff65b5=_0x833176[_0x56e950(0x1d1)](),_0x395905=_0x833176[_0x56e950(0x19d)]()[_0x56e950(0x1d1)]());}return{'show':_0xff65b5?_0xff65b5:_0x395905,'store':_0x395905};};function formatDate(_0x403bff){const _0xdafd97=_0x2b9903;return _0x403bff['getFullYear']()+'/'+(_0x403bff[_0xdafd97(0x28c)]()+0x1)[_0xdafd97(0x1d1)]()['padStart'](0x2,'0')+'/'+_0x403bff[_0xdafd97(0x28a)]()[_0xdafd97(0x1d1)]()[_0xdafd97(0x1df)](0x2,'0')+'\x20'+_0x403bff['getHours']()[_0xdafd97(0x1d1)]()['padStart'](0x2,'0')+':'+_0x403bff[_0xdafd97(0x1e7)]()['toString']()[_0xdafd97(0x1df)](0x2,'0')+':'+_0x403bff[_0xdafd97(0x251)]()[_0xdafd97(0x1d1)]()['padStart'](0x2,'0');}function sleep(_0x6f69af){return new Promise(_0x5b9d49=>setTimeout(_0x5b9d49,_0x6f69af));}