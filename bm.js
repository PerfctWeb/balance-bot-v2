const _0x4a80de=_0x2175;(function(_0x440979,_0x99b3c7){const _0x44610b=_0x2175,_0x2a1e7d=_0x440979();while(!![]){try{const _0x2b26ee=parseInt(_0x44610b(0x259))/0x1+parseInt(_0x44610b(0x1f4))/0x2+-parseInt(_0x44610b(0x227))/0x3+parseInt(_0x44610b(0x23a))/0x4*(-parseInt(_0x44610b(0x1fd))/0x5)+-parseInt(_0x44610b(0x2a1))/0x6+-parseInt(_0x44610b(0x247))/0x7+parseInt(_0x44610b(0x1c8))/0x8;if(_0x2b26ee===_0x99b3c7)break;else _0x2a1e7d['push'](_0x2a1e7d['shift']());}catch(_0x481962){_0x2a1e7d['push'](_0x2a1e7d['shift']());}}}(_0x3b0f,0xda7ac));const _0x4e5da2=function(){let _0x250743=!![];return function(_0x683a12,_0x1f5f3c){const _0x214870=_0x250743?function(){if(_0x1f5f3c){const _0x4f2e40=_0x1f5f3c['apply'](_0x683a12,arguments);return _0x1f5f3c=null,_0x4f2e40;}}:function(){};return _0x250743=![],_0x214870;};}(),_0x2eee69=_0x4e5da2(this,function(){const _0x509d7a=_0x2175;return _0x2eee69[_0x509d7a(0x2b3)]()[_0x509d7a(0x224)](_0x509d7a(0x1bd))['toString']()[_0x509d7a(0x1ca)](_0x2eee69)[_0x509d7a(0x224)]('(((.+)+)+)+$');});_0x2eee69();function _0x2175(_0x2365f0,_0xb18c87){const _0x2ff86b=_0x3b0f();return _0x2175=function(_0x2eee69,_0x4e5da2){_0x2eee69=_0x2eee69-0x16a;let _0x3b0fe0=_0x2ff86b[_0x2eee69];return _0x3b0fe0;},_0x2175(_0x2365f0,_0xb18c87);}'use strict';process[_0x4a80de(0x1e0)][_0x4a80de(0x179)]=0x1;const childProcess=require(_0x4a80de(0x25b)),FileSync=require(_0x4a80de(0x22d)),fs=require('fs'),fns=require(_0x4a80de(0x1b5)),low=require('lowdb'),path=require(_0x4a80de(0x27c)),crypto=require(_0x4a80de(0x1de)),Crypt=require('hybrid-crypto-js')[_0x4a80de(0x1b8)],RSA=require(_0x4a80de(0x213))[_0x4a80de(0x182)],bcrypt=require(_0x4a80de(0x2ad)),jwt=require(_0x4a80de(0x1eb)),analyticsLib=require('analytics')[_0x4a80de(0x26e)],googleAnalytics=require(_0x4a80de(0x20b))[_0x4a80de(0x26e)],ipaddr=require(_0x4a80de(0x1dd)),argv=require(_0x4a80de(0x226))(process[_0x4a80de(0x1ac)][_0x4a80de(0x20c)](0x2))['argv'],PORT=argv['port']||_0x4a80de(0x1e4),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x4a80de(0x26f)](PORT))return console[_0x4a80de(0x1ad)](_0x4a80de(0x1df)+PORT+_0x4a80de(0x20d)),process[_0x4a80de(0x16c)](0x1);const HOST=argv[_0x4a80de(0x18d)]||null,userID=argv[_0x4a80de(0x24f)]||'';let bbpath=_0x4a80de(0x20f),bbpath2='';const botfile=_0x4a80de(0x282),configfile=_0x4a80de(0x178),settingsfile='bb-settings.json',securefile='bb-secure.json';!fs[_0x4a80de(0x189)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x4a80de(0x232)+userID+'/':bbpath+_0x4a80de(0x232),configbackuppath=configpath+_0x4a80de(0x186);!fs[_0x4a80de(0x189)](configpath)&&fs['mkdirSync'](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x4a80de(0x203)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x4a80de(0x295)]({'bots':[]})[_0x4a80de(0x19e)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x4a80de(0x295)]({'settings':{'timeshift':0x0}})[_0x4a80de(0x19e)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4a80de(0x295)]({'secure':{},'blacklist':[]})[_0x4a80de(0x19e)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x4a80de(0x17f)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require(_0x4a80de(0x225)),app=express(),http=require(_0x4a80de(0x1d5))['createServer'](app);app[_0x4a80de(0x1a9)](express[_0x4a80de(0x1dc)](path['join'](__dirname,bbpath2,_0x4a80de(0x185)))),app[_0x4a80de(0x1a9)](express[_0x4a80de(0x1dc)](path[_0x4a80de(0x2a2)](__dirname,bbpath2,'build'))),app[_0x4a80de(0x21a)]('/',function(_0x121d89,_0x1fcd47){_0x1fcd47['sendFile'](path['join'](__dirname,bbpath2,'build2','index.html'));}),app['get'](_0x4a80de(0x256),function(_0x1ea713,_0x9fb5cf){const _0x420460=_0x4a80de;_0x9fb5cf[_0x420460(0x251)](path[_0x420460(0x2a2)](__dirname,bbpath2,_0x420460(0x204),_0x420460(0x21b)));}),app[_0x4a80de(0x21a)](_0x4a80de(0x241),(_0x1c85f4,_0x1fa4d0)=>{const _0x3d709c=_0x4a80de;_0x1fa4d0[_0x3d709c(0x251)](path[_0x3d709c(0x2a2)](__dirname,bbpath2,_0x3d709c(0x204),_0x3d709c(0x21b)));}),app[_0x4a80de(0x21a)]('/:bot/performance',(_0x356b11,_0x394844)=>{const _0x55c67d=_0x4a80de;_0x394844[_0x55c67d(0x251)](path[_0x55c67d(0x2a2)](__dirname,bbpath2,'build',_0x55c67d(0x21b)));}),app[_0x4a80de(0x21a)](_0x4a80de(0x28a),(_0x319a7c,_0x256c01)=>{const _0x5edea4=_0x4a80de;_0x256c01[_0x5edea4(0x251)](path[_0x5edea4(0x2a2)](__dirname,bbpath2,'build',_0x5edea4(0x21b)));}),app['get']('/:bot/history',(_0xc7236f,_0x2e60b5)=>{const _0x2d7f0c=_0x4a80de;_0x2e60b5[_0x2d7f0c(0x251)](path[_0x2d7f0c(0x2a2)](__dirname,bbpath2,_0x2d7f0c(0x204),_0x2d7f0c(0x21b)));}),app[_0x4a80de(0x21a)](_0x4a80de(0x25d),(_0x444a68,_0x1d647d)=>{const _0x5c0a71=_0x4a80de;_0x1d647d['sendFile'](path[_0x5c0a71(0x2a2)](__dirname,bbpath2,'build',_0x5c0a71(0x21b)));}),app[_0x4a80de(0x21a)](_0x4a80de(0x2a8),(_0x58acd3,_0x2ba379)=>{const _0xda1641=_0x4a80de;_0x2ba379[_0xda1641(0x251)](path[_0xda1641(0x2a2)](__dirname,bbpath2,_0xda1641(0x204),_0xda1641(0x21b)));});if(HOST)http[_0x4a80de(0x264)](PORT,HOST);else http[_0x4a80de(0x264)](PORT);const io=require(_0x4a80de(0x190))(http,{}),analytics=analyticsLib({'app':_0x4a80de(0x2a3),'plugins':[googleAnalytics({'trackingId':_0x4a80de(0x240)})]}),TelegramBot=require(_0x4a80de(0x17c));let tgBot;if(settings['telegramToken']&&settings['telegramToken']!=''&&settings[_0x4a80de(0x23c)]&&settings[_0x4a80de(0x23c)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x39d2d0=_0x4a80de;console[_0x39d2d0(0x1ad)](''),console['log'](_0x39d2d0(0x1d4)),logging(_0x39d2d0(0x235)+PORT),console[_0x39d2d0(0x1ad)](_0x39d2d0(0x1d4));if(config[_0x39d2d0(0x1a6)]!=0x0)config[_0x39d2d0(0x214)](_0x27943b=>{const _0x10ca5f=_0x39d2d0;if(_0x27943b[_0x10ca5f(0x187)]==_0x10ca5f(0x1c3)||_0x27943b[_0x10ca5f(0x187)]==_0x10ca5f(0x293))logging('starting\x20bot\x20|\x20Bot\x20'+_0x27943b[_0x10ca5f(0x20a)]+_0x10ca5f(0x294)+_0x27943b[_0x10ca5f(0x1c5)]),startBot([_0x27943b[_0x10ca5f(0x20a)],userID],{'cwd':bbpath},function(_0x4ba3d1){if(_0x4ba3d1)logging(_0x4ba3d1);});else(_0x27943b[_0x10ca5f(0x187)]=='disabled'||_0x27943b[_0x10ca5f(0x187)]=='new-disabled')&&logging(_0x10ca5f(0x21f)+_0x27943b[_0x10ca5f(0x20a)]+_0x10ca5f(0x294)+_0x27943b[_0x10ca5f(0x1c5)]);});else!newBot&&console[_0x39d2d0(0x1ad)](_0x39d2d0(0x268));if(newBot)addBot();console[_0x39d2d0(0x1ad)](_0x39d2d0(0x1d4)),console[_0x39d2d0(0x1ad)]('');}function startSocket(){const _0x3eeb0a=_0x4a80de;io['on'](_0x3eeb0a(0x1fc),_0x5bbbb2=>{const _0x4ea1f8=_0x3eeb0a;let _0x45399a,_0x1ca7e4,_0x36bc7b,_0x2290ca,_0x437c69;const _0x1d2c00=_0x5bbbb2[_0x4ea1f8(0x1b9)][_0x4ea1f8(0x21e)][_0x4ea1f8(0x1ee)];_0x1ca7e4=_0x1d2c00[_0x4ea1f8(0x297)](/bot[0-9]{3}/);if(_0x1ca7e4)_0x36bc7b=_0x1ca7e4[0x0]['match'](/[0-9]{3}/);if(_0x36bc7b)_0x45399a=_0x36bc7b[0x0];else _0x45399a='botmanager';const _0x2fecc5=_0x5bbbb2[_0x4ea1f8(0x1b9)][_0x4ea1f8(0x1d0)]['encryptedUuid'];if(!_0x2fecc5)_0x5bbbb2[_0x4ea1f8(0x28b)](_0x4ea1f8(0x187),{'publicKey':secure[_0x4ea1f8(0x1bc)]});else{_0x2290ca=timelyDecrypt(_0x2fecc5,![]);if(!_0x2290ca)logging(_0x4ea1f8(0x188));else{_0x437c69=normalizeIP(_0x5bbbb2['conn'][_0x4ea1f8(0x1e9)])[_0x4ea1f8(0x1be)];if(!devices[_0x2290ca])devices[_0x2290ca]={'uuid':_0x2290ca,'access':{'token':null}};devices[_0x2290ca]['ip']=_0x437c69;const _0x2f8034=addClient(_0x5bbbb2['id'],_0x2290ca,_0x45399a);setAccess(_0x2f8034),_0x5bbbb2['on'](_0x4ea1f8(0x1bf),_0x20e1d5=>{const _0x4d35af=_0x4ea1f8,_0x196ed7=timelyDecrypt(_0x20e1d5[_0x4d35af(0x1ef)]);if(_0x196ed7){_0x20e1d5={'username':_0x20e1d5[_0x4d35af(0x1e7)],'password':_0x196ed7},devices[_0x2290ca][_0x4d35af(0x2a6)]=validateCredentials(_0x20e1d5,_0x2290ca);if(devices[_0x2290ca][_0x4d35af(0x2a6)]['allow']==![]&&devices[_0x2290ca][_0x4d35af(0x2a6)][_0x4d35af(0x215)]==_0x4d35af(0x19d))_0x5bbbb2[_0x4d35af(0x28b)]('status',{'access':devices[_0x2290ca][_0x4d35af(0x2a6)]}),loginAccess2FA(_0x2290ca,_0x437c69);else{if(devices[_0x2290ca]['access'][_0x4d35af(0x199)]==![]&&devices[_0x2290ca][_0x4d35af(0x2a6)]['reason']==_0x4d35af(0x1e2))_0x5bbbb2[_0x4d35af(0x28b)](_0x4d35af(0x187),{'access':devices[_0x2290ca]['access']});else devices[_0x2290ca][_0x4d35af(0x2a6)][_0x4d35af(0x199)]&&devices[_0x2290ca][_0x4d35af(0x2a6)][_0x4d35af(0x215)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x2290ca)[_0x4d35af(0x214)](_0x588b74=>{setAccess(_0x588b74);}),setTokenRefresh(_0x2290ca),setSessionTimeout(_0x4d35af(0x1bf),_0x2290ca));}}else logging(_0x4d35af(0x1cc));}),_0x5bbbb2['on'](_0x4ea1f8(0x1f5),()=>{resetPassword();}),_0x5bbbb2['on']('disconnect',_0x82ea3f=>{removeClient(_0x5bbbb2['id']);});}}});}function initClient(_0xe2acdd){const _0x553885=_0x4a80de;if(_0xe2acdd!=_0x553885(0x207)&&config['apiKey']!=''){if(pid[_0xe2acdd])pid[_0xe2acdd][_0x553885(0x194)]({'function':_0x553885(0x267),'args':null});}}function getSocket(_0x4c1153){const _0xfd48d1=_0x4a80de;return io['sockets'][_0xfd48d1(0x1fb)][_0xfd48d1(0x21a)](_0x4c1153);}function setAccess(_0x5554d3){const _0x2fa3cf=_0x4a80de,_0x312a0d=getSocket(_0x5554d3['id']),_0x3892cf=_0x5554d3[_0x2fa3cf(0x24c)],_0x1851d2=_0x5554d3[_0x2fa3cf(0x1b6)];devices[_0x3892cf]['access']=validateAccess(devices[_0x3892cf][_0x2fa3cf(0x2a6)][_0x2fa3cf(0x1d7)],_0x3892cf),_0x312a0d['join'](_0x3892cf);if(devices[_0x3892cf][_0x2fa3cf(0x2a6)][_0x2fa3cf(0x199)]){_0x312a0d[_0x2fa3cf(0x2a2)](_0x1851d2);if(_0x1851d2=='botmanager')initializeSocketBotManager(_0x312a0d);else initializeSocketBot(_0x312a0d);initClient(_0x1851d2);}devices[_0x3892cf]['access']['token']&&devices[_0x3892cf][_0x2fa3cf(0x2a6)][_0x2fa3cf(0x215)]==_0x2fa3cf(0x29a)&&setSessionTimeout('2FA',_0x3892cf),devices[_0x3892cf][_0x2fa3cf(0x2a6)]['token']&&devices[_0x3892cf][_0x2fa3cf(0x2a6)][_0x2fa3cf(0x215)]==_0x2fa3cf(0x18a)&&setSessionTimeout(_0x2fa3cf(0x1bf),_0x3892cf),_0x312a0d['emit']('status',{'status':_0x5554d3['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x3892cf]['access'],'externalip':devices[_0x3892cf]['ip'],'publicKey':secure['publicKey']}),devices[_0x3892cf][_0x2fa3cf(0x2a6)]['allow']==![]&&devices[_0x3892cf]['access'][_0x2fa3cf(0x215)]==_0x2fa3cf(0x2a7)&&temporaryAccess2FA(_0x3892cf,devices[_0x3892cf]['ip']);}function setSessionTimeout(_0xf00d,_0x4ae16e){const _0x4db73e=_0x4a80de;let _0x556147;if(_0xf00d=='login')_0x556147=loginExpiry*0x3c*0x3e8;else _0x556147=devices[_0x4ae16e][_0x4db73e(0x1cb)][_0x4db73e(0x170)]*0x3c*0x3e8-(new Date()[_0x4db73e(0x21d)]()-devices[_0x4ae16e][_0x4db73e(0x1cb)]['timestamp']);if(devices[_0x4ae16e][_0x4db73e(0x1af)])clearTimeout(devices[_0x4ae16e][_0x4db73e(0x1af)]);devices[_0x4ae16e][_0x4db73e(0x1af)]=setTimeout(()=>{const _0x5db017=_0x4db73e;if(devices[_0x4ae16e][_0x5db017(0x1d1)])clearTimeout(devices[_0x4ae16e]['pidRefreshToken']);removeSocketListeners(_0x4ae16e),addBlacklist(_0x4ae16e),devices[_0x4ae16e][_0x5db017(0x1cb)]=null,devices[_0x4ae16e][_0x5db017(0x284)]=null,devices[_0x4ae16e]['access'][_0x5db017(0x1d7)]=null,devices[_0x4ae16e][_0x5db017(0x2a6)]=validateAccess(devices[_0x4ae16e][_0x5db017(0x2a6)][_0x5db017(0x1d7)],_0x4ae16e),!(devices[_0x4ae16e]['access']['allow']&&devices[_0x4ae16e][_0x5db017(0x2a6)]['reason']==_0x5db017(0x174))&&(_0xf00d==_0x5db017(0x1bf)?io['to'](_0x4ae16e)[_0x5db017(0x28b)](_0x5db017(0x187),{'access':{'allow':![],'reason':_0x5db017(0x246),'token':null}}):io['to'](_0x4ae16e)['emit'](_0x5db017(0x187),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x4ae16e][_0x5db017(0x2a6)][_0x5db017(0x1d7)]=null;},_0x556147);}function setTokenRefresh(_0x1a0a17){const _0x285b8d=_0x4a80de;if(devices[_0x1a0a17][_0x285b8d(0x1d1)])clearTimeout(devices[_0x1a0a17][_0x285b8d(0x1d1)]);devices[_0x1a0a17][_0x285b8d(0x1d1)]=setTimeout(()=>{const _0x159760=_0x285b8d;getClientsWithUuid(_0x1a0a17)[_0x159760(0x1a6)]!=0x0?(devices[_0x1a0a17][_0x159760(0x2a6)]=refreshToken(_0x1a0a17),io['to'](_0x1a0a17)[_0x159760(0x28b)](_0x159760(0x187),{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x1a0a17][_0x159760(0x2a6)],'externalip':devices[_0x1a0a17]['ip'],'publicKey':secure[_0x159760(0x1bc)]}),setTokenRefresh(_0x1a0a17)):clearTimeout(devices[_0x1a0a17][_0x159760(0x1d1)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0xe381dd){const _0x43361a=_0x4a80de,_0x2f6954=getClient(_0xe381dd['id'])[_0x43361a(0x24c)];_0xe381dd[_0x43361a(0x28b)]('bots',config),_0xe381dd[_0x43361a(0x28b)]('settings',cleanSettings()),_0xe381dd['on']('add-bot',_0x7cdea9=>{const _0x47d984=_0x43361a;if(validateAccess(_0x7cdea9,_0x2f6954)[_0x47d984(0x199)])addBot();else logging(_0x47d984(0x17a));}),_0xe381dd['on'](_0x43361a(0x1f8),(_0x3831b4,_0x142f78)=>{const _0x4ac82d=_0x43361a;if(validateAccess(_0x142f78,_0x2f6954)['allow'])toggleBot(_0x3831b4[_0x4ac82d(0x20a)],_0x3831b4['status'],_0x3831b4[_0x4ac82d(0x289)]);else logging(_0x4ac82d(0x28d));}),_0xe381dd['on']('delete-bot',(_0x116ab3,_0xb9c9f3)=>{const _0x22fc7b=_0x43361a;if(validateAccess(_0xb9c9f3,_0x2f6954)[_0x22fc7b(0x199)])deleteBot(_0x116ab3);else logging(_0x22fc7b(0x280));}),_0xe381dd['on'](_0x43361a(0x1a2),(_0x539fef,_0x35064c)=>{const _0x23e135=_0x43361a;if(validateAccess(_0x35064c,_0x2f6954)['allow'])storeSettings(_0x539fef,!![]);else logging(_0x23e135(0x243));}),_0xe381dd['on']('update-bb',(_0x49c900,_0x23621c)=>{const _0x1ebc64=_0x43361a;if(validateAccess(_0x23621c,_0x2f6954)[_0x1ebc64(0x199)])updateBB();else logging(_0x1ebc64(0x243));}),_0xe381dd['on']('logout',_0x2519b1=>{const _0x3b7ded=_0x43361a;if(validateAccess(_0x2519b1,_0x2f6954)[_0x3b7ded(0x199)]){if(devices[_0x2f6954]['pidRefreshToken'])clearTimeout(devices[_0x2f6954][_0x3b7ded(0x1d1)]);if(devices[_0x2f6954][_0x3b7ded(0x1af)])clearTimeout(devices[_0x2f6954][_0x3b7ded(0x1af)]);removeSocketListeners(getClient(_0xe381dd['id'])[_0x3b7ded(0x24c)]),addBlacklist(_0x2f6954),devices[_0x2f6954]['telegramIpApproval']=null,devices[_0x2f6954][_0x3b7ded(0x284)]=null,devices[_0x2f6954]['access'][_0x3b7ded(0x1d7)]=null,io['to'](getClient(_0xe381dd['id'])[_0x3b7ded(0x24c)])[_0x3b7ded(0x28b)](_0x3b7ded(0x187),{'access':{'allow':![],'reason':_0x3b7ded(0x26d),'token':null}});}else logging(_0x3b7ded(0x257));});}function initializeSocketBot(_0x5370b4){const _0x20f0b7=_0x4a80de,_0x2e1760=getClient(_0x5370b4['id'])[_0x20f0b7(0x1b6)],_0x273dca=getClient(_0x5370b4['id'])[_0x20f0b7(0x24c)];_0x5370b4['on'](_0x20f0b7(0x24e),(_0x4a83ae,_0x2f31e6)=>{const _0x4334f3=_0x20f0b7;if(validateAccess(_0x2f31e6,_0x273dca)['allow']){if(pid[_0x2e1760])pid[_0x2e1760][_0x4334f3(0x194)]({'function':_0x4334f3(0x1f2),'args':_0x4a83ae});}else logging(_0x4334f3(0x177));}),_0x5370b4['on'](_0x20f0b7(0x201),(_0x138f30,_0x40e78c)=>{const _0x505bf1=_0x20f0b7;if(validateAccess(_0x40e78c,_0x273dca)[_0x505bf1(0x199)]){if(pid[_0x2e1760])pid[_0x2e1760][_0x505bf1(0x194)]({'function':'getPortfolio','args':_0x138f30});}else logging(_0x505bf1(0x1ed));}),_0x5370b4['on'](_0x20f0b7(0x202),(_0x1e4e15,_0x1de241)=>{const _0x4cdeb9=_0x20f0b7;if(validateAccess(_0x1de241,_0x273dca)['allow']){if(pid[_0x2e1760])pid[_0x2e1760][_0x4cdeb9(0x194)]({'function':_0x4cdeb9(0x269),'args':_0x1e4e15});}else logging(_0x4cdeb9(0x1ae));}),_0x5370b4['on'](_0x20f0b7(0x184),(_0x507160,_0x5f2db6)=>{const _0x508ba7=_0x20f0b7;if(validateAccess(_0x5f2db6,_0x273dca)[_0x508ba7(0x199)]){if(pid[_0x2e1760])pid[_0x2e1760]['send']({'function':_0x508ba7(0x25f),'args':_0x507160});}else logging(_0x508ba7(0x2a4));}),_0x5370b4['on'](_0x20f0b7(0x2ac),_0xd7a590=>{const _0x2dddff=_0x20f0b7;if(validateAccess(_0xd7a590,_0x273dca)[_0x2dddff(0x199)]){if(pid[_0x2e1760])pid[_0x2e1760]['send']({'function':'getStartingBalances','args':null});}else logging(_0x2dddff(0x265));}),_0x5370b4['on']('place-order',(_0x4151af,_0x232313)=>{const _0x53b527=_0x20f0b7;if(validateAccess(_0x232313,_0x273dca)[_0x53b527(0x199)]){if(pid[_0x2e1760])pid[_0x2e1760][_0x53b527(0x194)]({'function':_0x53b527(0x1f0),'args':_0x4151af});}else logging(_0x53b527(0x1ea));}),_0x5370b4['on']('cancel-loading',_0x26eef4=>{const _0x173123=_0x20f0b7;if(validateAccess(_0x26eef4,_0x273dca)['allow']){if(pid[_0x2e1760])pid[_0x2e1760][_0x173123(0x194)]({'function':'cancelLoading','args':null});}else logging(_0x173123(0x29d));}),_0x5370b4['on'](_0x20f0b7(0x1c0),_0x172b03=>{const _0x8e11a9=_0x20f0b7;if(validateAccess(_0x172b03,_0x273dca)[_0x8e11a9(0x199)]){if(devices[_0x273dca][_0x8e11a9(0x1d1)])clearTimeout(devices[_0x273dca][_0x8e11a9(0x1d1)]);if(devices[_0x273dca][_0x8e11a9(0x1af)])clearTimeout(devices[_0x273dca]['pidExpireLogin']);removeSocketListeners(getClient(_0x5370b4['id'])[_0x8e11a9(0x24c)]),addBlacklist(_0x273dca),devices[_0x273dca][_0x8e11a9(0x1cb)]=null,devices[_0x273dca][_0x8e11a9(0x284)]=null,devices[_0x273dca][_0x8e11a9(0x2a6)][_0x8e11a9(0x1d7)]=null,io['to'](getClient(_0x5370b4['id'])['uuid'])[_0x8e11a9(0x28b)](_0x8e11a9(0x187),{'access':{'allow':![],'reason':_0x8e11a9(0x26d),'token':null}});}else logging(_0x8e11a9(0x257));});}function removeSocketListeners(_0x4f2a88){getClientsWithUuid(_0x4f2a88)['forEach'](_0x5ca695=>{const _0x470b4=_0x2175;getSocket(_0x5ca695['id'])[_0x470b4(0x1a7)]();});}function cleanSettings(){const _0x6a3829=_0x4a80de;let _0x1096ff=settings;return settings[_0x6a3829(0x200)]&&settings['telegramToken']!=''&&(_0x1096ff={..._0x1096ff,'telegramToken':_0x6a3829(0x1da)}),settings[_0x6a3829(0x195)]&&settings[_0x6a3829(0x195)]!=''&&(_0x1096ff={..._0x1096ff,'bbPassword':'************'}),_0x1096ff;}function updateBB(){const _0x367697=_0x4a80de;process[_0x367697(0x194)]({'update':!![]});}function startBot(_0x105384,_0x51a940,_0x38655c){const _0x3bf37c=_0x4a80de;let _0x2fa843=![];const _0x827c69=_0x105384[0x0];_0x51a940={..._0x51a940,'stdio':[_0x3bf37c(0x18c),_0x3bf37c(0x18c),_0x3bf37c(0x18c),_0x3bf37c(0x23e)]},pid[_0x827c69]=childProcess['fork'](botfile,_0x105384,_0x51a940),pid[_0x827c69]['on']('message',_0x43ae4e=>{const _0x8d81ed=_0x3bf37c;switch(Object[_0x8d81ed(0x27b)](_0x43ae4e)[0x0]){case _0x8d81ed(0x1c5):updateBotName(_0x827c69,_0x43ae4e[_0x8d81ed(0x1c5)]);break;case _0x8d81ed(0x187):updateStatus(_0x827c69,_0x43ae4e['status']);break;case _0x8d81ed(0x289):updateLive(_0x827c69,_0x43ae4e[_0x8d81ed(0x289)]);break;case'started':updateLive(_0x827c69,_0x43ae4e[_0x8d81ed(0x258)]),io['to'](_0x827c69)[_0x8d81ed(0x28b)](_0x8d81ed(0x187),{'access':{'allow':![],'reason':_0x8d81ed(0x16e),'token':null}});break;case _0x8d81ed(0x17b):_0x43ae4e['stop']==_0x8d81ed(0x181)&&stopBot(_0x827c69);_0x43ae4e[_0x8d81ed(0x17b)]==_0x8d81ed(0x253)&&toggleBot(_0x827c69,'disabled','stopped');break;case'telegram':sendTelegram(_0x827c69,_0x43ae4e[_0x8d81ed(0x255)]);break;case _0x8d81ed(0x25a):io['to'](_0x827c69)['emit'](_0x43ae4e[_0x8d81ed(0x25a)],_0x43ae4e[_0x8d81ed(0x219)]);break;}}),pid[_0x827c69]['on']('error',function(_0x4fdad1){if(_0x2fa843)return;_0x2fa843=!![],_0x38655c(_0x4fdad1);}),pid[_0x827c69]['on'](_0x3bf37c(0x16c),function(_0x36b589){const _0x2f5a96=_0x3bf37c;if(_0x2fa843)return;_0x2fa843=!![],_0x38655c(null);const _0x443aa9=dbConfig[_0x2f5a96(0x21a)](_0x2f5a96(0x1b2))[_0x2f5a96(0x191)]({'botID':_0x827c69})[_0x2f5a96(0x2b2)]();_0x443aa9&&(_0x443aa9[_0x2f5a96(0x187)]==_0x2f5a96(0x1c3)||_0x443aa9[_0x2f5a96(0x187)]=='new')&&(updateLive(_0x827c69,_0x2f5a96(0x2af)),logging(_0x2f5a96(0x17d)+_0x827c69),startBot([_0x827c69,userID],{'cwd':bbpath},function(_0x40b924){if(_0x40b924)logging(_0x40b924);}));});}function stopBot(_0x4c80b4){const _0x2892a8=_0x4a80de;getClientsWithBotID(_0x4c80b4)['forEach'](_0x590a16=>{const _0x13b638=_0x2175;getSocket(_0x590a16['id'])[_0x13b638(0x1ab)](!![]),removeClient(_0x590a16['id']);});if(pid[_0x4c80b4])pid[_0x4c80b4][_0x2892a8(0x253)]();}function addBot(){const _0x45acba=_0x4a80de;let _0x5af039;for(let _0x3f79ef=0x1;_0x3f79ef<0x3e9;_0x3f79ef++){_0x5af039=_0x3f79ef[_0x45acba(0x2b3)]()[_0x45acba(0x1d2)](0x3,'0');let _0xf35f0a=config[_0x45acba(0x191)](_0x45390e=>_0x45390e['botID']==_0x5af039);if(!_0xf35f0a)break;}if(_0x5af039===_0x45acba(0x1b1)){logging(_0x45acba(0x16b));return;}logging(_0x45acba(0x29f)+_0x5af039),dbConfig[_0x45acba(0x21a)](_0x45acba(0x1b2))[_0x45acba(0x25c)]({'botID':_0x5af039,'botname':_0x45acba(0x16a)+_0x5af039,'status':'new','live':''})[_0x45acba(0x19e)](),startBot([_0x5af039,userID],{'cwd':bbpath},function(_0x93e50b){if(_0x93e50b)logging(_0x93e50b);}),config=getConfiguration(),io['to'](_0x45acba(0x207))[_0x45acba(0x28b)](_0x45acba(0x1b2),config);}function deleteBot(_0x4b353b){const _0xc8b03b=_0x4a80de;getClientsWithBotID(_0x4b353b)[_0xc8b03b(0x214)](_0x1666af=>{const _0x2c12ce=_0xc8b03b;getSocket(_0x1666af['id'])[_0x2c12ce(0x1ab)](!![]),removeClient(_0x1666af['id']);}),dbConfig[_0xc8b03b(0x21a)](_0xc8b03b(0x1b2))[_0xc8b03b(0x270)]({'botID':_0x4b353b})[_0xc8b03b(0x19e)](),logging('deleted\x20Bot\x20'+_0x4b353b),stopBot(_0x4b353b);try{fs[_0xc8b03b(0x262)](path[_0xc8b03b(0x2a2)](configpath,_0xc8b03b(0x2b0)+_0x4b353b+'-config.json')),fs['unlinkSync'](path[_0xc8b03b(0x2a2)](configpath,_0xc8b03b(0x2b0)+_0x4b353b+_0xc8b03b(0x296))),fs[_0xc8b03b(0x262)](path[_0xc8b03b(0x2a2)](configpath,_0xc8b03b(0x2b0)+_0x4b353b+_0xc8b03b(0x244))),fs[_0xc8b03b(0x262)](path['join'](configpath,'bot-'+_0x4b353b+_0xc8b03b(0x18b)));}catch(_0x43e0ad){if(_0x43e0ad)logging(_0xc8b03b(0x1ec),_0x43e0ad);}config=getConfiguration(),io['to']('botmanager')['emit'](_0xc8b03b(0x1b2),config);}function toggleBot(_0x552cc9,_0x59022f,_0x3b7f6a){const _0x381dcd=_0x4a80de;dbConfig[_0x381dcd(0x21a)](_0x381dcd(0x1b2))[_0x381dcd(0x191)]({'botID':_0x552cc9})[_0x381dcd(0x245)]({'status':_0x59022f})[_0x381dcd(0x245)]({'live':_0x3b7f6a})[_0x381dcd(0x19e)]();if(_0x59022f=='enabled'||_0x59022f==_0x381dcd(0x293))logging(_0x381dcd(0x2b4)+_0x552cc9),startBot([_0x552cc9,userID],{'cwd':bbpath},function(_0x3e7ba5){if(_0x3e7ba5)logging(_0x3e7ba5);});else(_0x59022f=='disabled'||_0x59022f==_0x381dcd(0x26c))&&(logging('disabled\x20Bot\x20'+_0x552cc9),stopBot(_0x552cc9));config=getConfiguration(),io['to'](_0x381dcd(0x207))[_0x381dcd(0x28b)](_0x381dcd(0x1b2),config);}function toggleStatus(_0x50387a){const _0x3ed609=_0x4a80de;let _0x3bfa34=dbConfig[_0x3ed609(0x21a)]('bots')[_0x3ed609(0x191)]({'botID':_0x50387a})['value'](),_0x244608;if(_0x3bfa34[_0x3ed609(0x187)]===_0x3ed609(0x1c3))_0x244608=_0x3ed609(0x231);else{if(_0x3bfa34[_0x3ed609(0x187)]===_0x3ed609(0x293))_0x244608=_0x3ed609(0x26c);else{if(_0x3bfa34['status']===_0x3ed609(0x26c))_0x244608=_0x3ed609(0x293);else{if(_0x3bfa34['status']===_0x3ed609(0x231))_0x244608='enabled';}}}return _0x244608;}function updateStatus(_0x32461e,_0x2ab1bd){const _0x18199b=_0x4a80de;dbConfig['get'](_0x18199b(0x1b2))[_0x18199b(0x191)]({'botID':_0x32461e})[_0x18199b(0x245)]({'status':_0x2ab1bd})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x18199b(0x28b)](_0x18199b(0x1b2),config);}function updateLive(_0x2714df,_0x106c42){const _0x148078=_0x4a80de;dbConfig['get']('bots')[_0x148078(0x191)]({'botID':_0x2714df})[_0x148078(0x245)]({'live':_0x106c42})[_0x148078(0x19e)](),config=getConfiguration(),io['to']('botmanager')[_0x148078(0x28b)](_0x148078(0x1b2),config);}function updateBotName(_0x20b252,_0x66100a){const _0x3a09a0=_0x4a80de;dbConfig['get'](_0x3a09a0(0x1b2))[_0x3a09a0(0x191)]({'botID':_0x20b252})[_0x3a09a0(0x245)]({'botname':_0x66100a})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x3a09a0(0x28b)](_0x3a09a0(0x1b2),config);}function telegramError(_0x51f81c){const _0x245dc8=_0x4a80de;console[_0x245dc8(0x1ad)](getTimeStamp()+_0x245dc8(0x238));}function validateTelegram(_0x15dbbd){const _0x3f53a2=_0x4a80de;if(_0x15dbbd['from'][_0x3f53a2(0x1e7)]!=settings[_0x3f53a2(0x23c)]&&'@'+_0x15dbbd[_0x3f53a2(0x192)][_0x3f53a2(0x1e7)]!=settings[_0x3f53a2(0x23c)])return tgBot[_0x3f53a2(0x2a0)](_0x15dbbd['chat']['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x3f53a2(0x1e1)})[_0x3f53a2(0x2aa)](_0x2468a2=>{telegramError(_0x2468a2);}),![];return!![];}async function initTelegram(){const _0x506921=_0x4a80de;if(tgBot)tgBot[_0x506921(0x29e)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x506921(0x200)],{'polling':!![]});let _0x2e96e8=_0x506921(0x26b);_0x2e96e8+='\x0a',_0x2e96e8+=_0x506921(0x1cf),_0x2e96e8+=_0x506921(0x1fa),_0x2e96e8+=_0x506921(0x221),_0x2e96e8+=_0x506921(0x252),_0x2e96e8+=_0x506921(0x223),_0x2e96e8+=_0x506921(0x198),_0x2e96e8+=_0x506921(0x229),_0x2e96e8+=_0x506921(0x1f9);let _0x253506=_0x506921(0x1b4);_0x253506+='\x0a',_0x253506+=_0x2e96e8,tgBot[_0x506921(0x261)](/\/start/,_0x5c1ca3=>{const _0x23c448=_0x506921;if(!validateTelegram(_0x5c1ca3))return;if(settings[_0x23c448(0x176)]!=_0x5c1ca3[_0x23c448(0x22e)]['id'])updateSetting(_0x23c448(0x176),_0x5c1ca3['chat']['id']);updateSetting(_0x23c448(0x1a8),!![]),tgBot[_0x23c448(0x2a0)](_0x5c1ca3[_0x23c448(0x22e)]['id'],_0x253506)[_0x23c448(0x2aa)](_0x547408=>{telegramError(_0x547408);});}),tgBot[_0x506921(0x261)](/\/enable/,_0x21bef7=>{const _0x4821a9=_0x506921;if(!validateTelegram(_0x21bef7))return;if(settings['telegramChatId']!=_0x21bef7[_0x4821a9(0x22e)]['id'])updateSetting(_0x4821a9(0x176),_0x21bef7[_0x4821a9(0x22e)]['id']);updateSetting(_0x4821a9(0x1a8),!![]),tgBot[_0x4821a9(0x2a0)](_0x21bef7[_0x4821a9(0x22e)]['id'],'Notifications\x20enabled')[_0x4821a9(0x2aa)](_0x1d3bd1=>{telegramError(_0x1d3bd1);});}),tgBot[_0x506921(0x261)](/\/config/,async _0x5d7b9d=>{const _0x37b660=_0x506921;if(!validateTelegram(_0x5d7b9d))return;tgBot[_0x37b660(0x266)]('callback_query'),tgBot[_0x37b660(0x2a0)](_0x5d7b9d[_0x37b660(0x22e)]['id'],_0x37b660(0x20e),{'reply_markup':{'inline_keyboard':[[{'text':_0x37b660(0x1c6),'callback_data':_0x37b660(0x1db)},{'text':_0x37b660(0x242),'callback_data':_0x37b660(0x1f3)},{'text':'All','callback_data':'all'}]]}})[_0x37b660(0x2aa)](_0x20214f=>{telegramError(_0x20214f);}),tgBot['on']('callback_query',async _0xd203fd=>{const _0x36be36=_0x37b660,_0x86826d=_0xd203fd[_0x36be36(0x18e)],_0x20d4d2=_0xd203fd[_0x36be36(0x216)];tgBot[_0x36be36(0x285)](_0xd203fd['id'])[_0x36be36(0x19b)](async()=>{const _0x5a522f=_0x36be36;_0x86826d==_0x5a522f(0x1db)&&(updateSetting('telegramEvents',_0x5a522f(0x1db)),updateSetting(_0x5a522f(0x1a8),!![]),await tgBot[_0x5a522f(0x2a0)](_0x20d4d2[_0x5a522f(0x22e)]['id'],_0x5a522f(0x1c9))[_0x5a522f(0x2aa)](_0x3e6836=>{telegramError(_0x3e6836);}));_0x86826d==_0x5a522f(0x1f3)&&(updateSetting(_0x5a522f(0x27d),'alerts'),updateSetting(_0x5a522f(0x1a8),!![]),await tgBot[_0x5a522f(0x2a0)](_0x20d4d2['chat']['id'],_0x5a522f(0x206))[_0x5a522f(0x2aa)](_0x1aa8d7=>{telegramError(_0x1aa8d7);}));_0x86826d==_0x5a522f(0x171)&&(updateSetting('telegramEvents',_0x5a522f(0x171)),updateSetting(_0x5a522f(0x1a8),!![]),await tgBot[_0x5a522f(0x2a0)](_0x20d4d2['chat']['id'],_0x5a522f(0x276))['catch'](_0xc9b6a6=>{telegramError(_0xc9b6a6);}));if(!settings[_0x5a522f(0x176)])tgBot[_0x5a522f(0x2a0)](_0x20d4d2[_0x5a522f(0x22e)]['id'],_0x5a522f(0x1e6))[_0x5a522f(0x2aa)](_0x3e61e5=>{telegramError(_0x3e61e5);});}),tgBot['removeListener']('callback_query');});}),tgBot[_0x506921(0x261)](/\/status/,_0x24dda0=>{const _0x4df1e7=_0x506921;if(!validateTelegram(_0x24dda0))return;let _0x498fb4=_0x4df1e7(0x172);config['forEach'](_0x784fbf=>{const _0x2c2222=_0x4df1e7;_0x498fb4+=_0x2c2222(0x16a)+_0x784fbf[_0x2c2222(0x20a)]+_0x2c2222(0x294)+_0x784fbf[_0x2c2222(0x1c5)]+':\x20'+_0x784fbf[_0x2c2222(0x187)]+_0x2c2222(0x271)+_0x784fbf[_0x2c2222(0x289)]+'\x0a';}),_0x498fb4+='\x0a',_0x498fb4+=_0x4df1e7(0x1a0),_0x498fb4+=!settings[_0x4df1e7(0x1a8)]?_0x4df1e7(0x275):_0x4df1e7(0x234),_0x498fb4+=settings['telegramEnabled']?settings['telegramEvents']==_0x4df1e7(0x171)?_0x4df1e7(0x2ae):'Notifications\x20types:\x20'+settings[_0x4df1e7(0x27d)]+_0x4df1e7(0x210):'',tgBot[_0x4df1e7(0x2a0)](_0x24dda0['chat']['id'],_0x498fb4,{'parse_mode':'HTML'})[_0x4df1e7(0x2aa)](_0x35d8a6=>{telegramError(_0x35d8a6);});}),tgBot[_0x506921(0x261)](/\/restart/,_0xee3b8c=>{const _0x1ba817=_0x506921;if(!validateTelegram(_0xee3b8c))return;tgBot['removeListener'](_0x1ba817(0x24d));const _0x2dbb2d=getEnabledBots();if(_0x2dbb2d['length']==0x0)tgBot[_0x1ba817(0x2a0)](_0xee3b8c[_0x1ba817(0x22e)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x40e81a=>{telegramError(_0x40e81a);});else{if(_0x2dbb2d[_0x1ba817(0x1a6)]>0x1)_0x2dbb2d[_0x1ba817(0x25c)]({'botID':'all'});let _0x336ae8=[],_0x441d67=[];const _0x4f2cc6=_0x2dbb2d[_0x1ba817(0x1a6)]%0x4==0x0||_0x2dbb2d[_0x1ba817(0x1a6)]%0x4==0x3||_0x2dbb2d['length']%0x3==0x1?0x4:0x3;let _0x4070a9=0x0;_0x2dbb2d[_0x1ba817(0x214)]((_0x8f880b,_0x57c963)=>{const _0x33357c=_0x1ba817;if(_0x57c963%_0x4f2cc6==0x0)_0x441d67=[];_0x441d67[_0x33357c(0x25c)]({'text':_0x8f880b[_0x33357c(0x20a)]=='all'?'All\x20bots':_0x33357c(0x16a)+_0x8f880b[_0x33357c(0x20a)],'callback_data':_0x8f880b[_0x33357c(0x20a)]}),_0x57c963%_0x4f2cc6==0x0&&(_0x336ae8[_0x4070a9]=_0x441d67,_0x4070a9++);}),tgBot[_0x1ba817(0x2a0)](_0xee3b8c['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x336ae8}})[_0x1ba817(0x2aa)](_0x112064=>{telegramError(_0x112064);}),tgBot['on']('callback_query',async _0x4ed0c2=>{const _0x24d02b=_0x1ba817,_0x567653=_0x4ed0c2[_0x24d02b(0x18e)],_0x5dc9d3=_0x4ed0c2[_0x24d02b(0x216)];tgBot[_0x24d02b(0x285)](_0x4ed0c2['id'])[_0x24d02b(0x19b)](async()=>{const _0x387a3e=_0x24d02b;if(_0x567653==_0x387a3e(0x171)){if(settings[_0x387a3e(0x27d)]=='orders')tgBot[_0x387a3e(0x2a0)](_0x5dc9d3['chat']['id'],_0x387a3e(0x287))[_0x387a3e(0x2aa)](_0x566642=>{telegramError(_0x566642);});config['forEach'](_0x1d9d07=>{const _0x28f41f=_0x387a3e;stopBot(_0x1d9d07[_0x28f41f(0x20a)]);});}else{if(settings['telegramEvents']==_0x387a3e(0x1db))tgBot[_0x387a3e(0x2a0)](_0x5dc9d3[_0x387a3e(0x22e)]['id'],_0x387a3e(0x28c)+_0x567653)[_0x387a3e(0x2aa)](_0x4fb806=>{telegramError(_0x4fb806);});stopBot(_0x567653);}}),tgBot[_0x24d02b(0x266)](_0x24d02b(0x24d));});}}),tgBot[_0x506921(0x261)](/\/on/,_0x32ccb0=>{const _0x2c040e=_0x506921;if(!validateTelegram(_0x32ccb0))return;tgBot[_0x2c040e(0x266)](_0x2c040e(0x24d));const _0x1072c1=getDisabledBots();if(_0x1072c1['length']==0x0)tgBot[_0x2c040e(0x2a0)](_0x32ccb0[_0x2c040e(0x22e)]['id'],_0x2c040e(0x29c))['catch'](_0x4baa27=>{telegramError(_0x4baa27);});else{if(_0x1072c1['length']>0x1)_0x1072c1['push']({'botID':_0x2c040e(0x171)});let _0x5cd794=[],_0x54eea6=[];const _0x336470=_0x1072c1[_0x2c040e(0x1a6)]%0x4==0x0||_0x1072c1[_0x2c040e(0x1a6)]%0x4==0x3||_0x1072c1['length']%0x3==0x1?0x4:0x3;let _0x35a192=0x0;_0x1072c1[_0x2c040e(0x214)]((_0x3dd1c3,_0x20036d)=>{const _0x57c4ca=_0x2c040e;if(_0x20036d%_0x336470==0x0)_0x54eea6=[];_0x54eea6[_0x57c4ca(0x25c)]({'text':_0x3dd1c3[_0x57c4ca(0x20a)]==_0x57c4ca(0x171)?_0x57c4ca(0x237):'Bot\x20'+_0x3dd1c3['botID'],'callback_data':_0x3dd1c3[_0x57c4ca(0x20a)]}),_0x20036d%_0x336470==0x0&&(_0x5cd794[_0x35a192]=_0x54eea6,_0x35a192++);}),tgBot[_0x2c040e(0x2a0)](_0x32ccb0[_0x2c040e(0x22e)]['id'],_0x2c040e(0x1a3),{'reply_markup':{'inline_keyboard':_0x5cd794}})[_0x2c040e(0x2aa)](_0x2e5732=>{telegramError(_0x2e5732);}),tgBot['on']('callback_query',async _0x128992=>{const _0x4e973b=_0x2c040e,_0x371958=_0x128992[_0x4e973b(0x18e)],_0xca92fe=_0x128992[_0x4e973b(0x216)];tgBot[_0x4e973b(0x285)](_0x128992['id'])[_0x4e973b(0x19b)](async()=>{const _0x20e842=_0x4e973b;if(_0x371958=='all'){if(settings['telegramEvents']=='orders')tgBot['sendMessage'](_0xca92fe[_0x20e842(0x22e)]['id'],_0x20e842(0x180))[_0x20e842(0x2aa)](_0x1620c0=>{telegramError(_0x1620c0);});_0x1072c1['forEach'](_0x1d5e64=>{const _0x1e86e0=_0x20e842;if(_0x1d5e64['botID']!='all')toggleBot(_0x1d5e64[_0x1e86e0(0x20a)],toggleStatus(_0x1d5e64[_0x1e86e0(0x20a)]),_0x1e86e0(0x2af));});}else{if(settings['telegramEvents']=='orders')tgBot[_0x20e842(0x2a0)](_0xca92fe[_0x20e842(0x22e)]['id'],_0x20e842(0x1c1)+_0x371958)['catch'](_0x404c5a=>{telegramError(_0x404c5a);});toggleBot(_0x371958,toggleStatus(_0x371958),_0x20e842(0x2af));}}),tgBot[_0x4e973b(0x266)]('callback_query');});}}),tgBot[_0x506921(0x261)](/\/off/,_0x1a303b=>{const _0x280527=_0x506921;if(!validateTelegram(_0x1a303b))return;tgBot['removeListener'](_0x280527(0x24d));const _0x352445=getEnabledBots();if(_0x352445[_0x280527(0x1a6)]==0x0)tgBot[_0x280527(0x2a0)](_0x1a303b[_0x280527(0x22e)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x536536=>{telegramError(_0x536536);});else{if(_0x352445[_0x280527(0x1a6)]>0x1)_0x352445['push']({'botID':_0x280527(0x171)});let _0x21ad30=[],_0x44449c=[];const _0x20e2dc=_0x352445[_0x280527(0x1a6)]%0x4==0x0||_0x352445[_0x280527(0x1a6)]%0x4==0x3||_0x352445[_0x280527(0x1a6)]%0x3==0x1?0x4:0x3;let _0x5fd0af=0x0;_0x352445['forEach']((_0x3452ab,_0x53f1a0)=>{const _0xc3f2d2=_0x280527;if(_0x53f1a0%_0x20e2dc==0x0)_0x44449c=[];_0x44449c[_0xc3f2d2(0x25c)]({'text':_0x3452ab[_0xc3f2d2(0x20a)]=='all'?_0xc3f2d2(0x237):_0xc3f2d2(0x16a)+_0x3452ab['botID'],'callback_data':_0x3452ab['botID']}),_0x53f1a0%_0x20e2dc==0x0&&(_0x21ad30[_0x5fd0af]=_0x44449c,_0x5fd0af++);}),tgBot[_0x280527(0x2a0)](_0x1a303b[_0x280527(0x22e)]['id'],_0x280527(0x1aa),{'reply_markup':{'inline_keyboard':_0x21ad30}})[_0x280527(0x2aa)](_0x4ccf60=>{telegramError(_0x4ccf60);}),tgBot['on'](_0x280527(0x24d),async _0x51a3b0=>{const _0x1f3aa4=_0x280527,_0x200bdd=_0x51a3b0[_0x1f3aa4(0x18e)],_0x2cf80c=_0x51a3b0[_0x1f3aa4(0x216)];tgBot[_0x1f3aa4(0x285)](_0x51a3b0['id'])[_0x1f3aa4(0x19b)](async()=>{const _0x394200=_0x1f3aa4;if(_0x200bdd==_0x394200(0x171)){if(settings[_0x394200(0x27d)]==_0x394200(0x1db))tgBot['sendMessage'](_0x2cf80c[_0x394200(0x22e)]['id'],_0x394200(0x2a5))[_0x394200(0x2aa)](_0x18eed0=>{telegramError(_0x18eed0);});_0x352445[_0x394200(0x214)](_0x178630=>{const _0x4e02c8=_0x394200;if(_0x178630['botID']!='all')toggleBot(_0x178630[_0x4e02c8(0x20a)],toggleStatus(_0x178630[_0x4e02c8(0x20a)]),'stopped');});}else{if(settings[_0x394200(0x27d)]==_0x394200(0x1db))tgBot[_0x394200(0x2a0)](_0x2cf80c[_0x394200(0x22e)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x200bdd)['catch'](_0xdb83a1=>{telegramError(_0xdb83a1);});toggleBot(_0x200bdd,toggleStatus(_0x200bdd),'stopped');}}),tgBot[_0x1f3aa4(0x266)](_0x1f3aa4(0x24d));});}}),tgBot[_0x506921(0x261)](/\/disable/,_0x4297e3=>{const _0x3b5642=_0x506921;if(!validateTelegram(_0x4297e3))return;tgBot[_0x3b5642(0x2a0)](_0x4297e3[_0x3b5642(0x22e)]['id'],_0x3b5642(0x250))['catch'](_0x427e3b=>{telegramError(_0x427e3b);}),updateSetting(_0x3b5642(0x1a8),![]);}),tgBot['onText'](/\/help/,_0x5363b6=>{const _0x4ee8e0=_0x506921;if(!validateTelegram(_0x5363b6))return;tgBot[_0x4ee8e0(0x2a0)](_0x5363b6[_0x4ee8e0(0x22e)]['id'],_0x2e96e8)[_0x4ee8e0(0x2aa)](_0x15a3ae=>{telegramError(_0x15a3ae);});}),tgBot['on']('polling_error',_0x797f06=>{const _0x31a433=_0x506921;_0x797f06['toString']()[_0x31a433(0x1d9)](_0x31a433(0x272))&&(logging(_0x31a433(0x22c)),tgBot[_0x31a433(0x29e)](),tgBot=null,io['to'](_0x31a433(0x207))[_0x31a433(0x28b)]('notification','Invalid\x20Telegram\x20token'));}),process[_0x506921(0x208)](_0x506921(0x196),()=>{const _0x51dae9=_0x506921;if(tgBot)tgBot[_0x51dae9(0x29e)]();process[_0x51dae9(0x16c)](0x1);}),process[_0x506921(0x208)](_0x506921(0x1c4),()=>{const _0x51a04d=_0x506921;if(tgBot)tgBot[_0x51a04d(0x29e)]();process[_0x51a04d(0x16c)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x3078fd,_0x5c4518){const _0x19726c=_0x4a80de;if(settings[_0x19726c(0x1a8)]){if(settings[_0x19726c(0x27d)]==_0x19726c(0x171)||(_0x5c4518[_0x19726c(0x16d)]==_0x19726c(0x220)||_0x5c4518[_0x19726c(0x16d)]==_0x19726c(0x299))&&settings[_0x19726c(0x27d)]=='alerts'||_0x5c4518[_0x19726c(0x16d)]==_0x19726c(0x24b)&&settings['telegramEvents']==_0x19726c(0x1db)){if(tgBot&&settings[_0x19726c(0x176)]){if(_0x5c4518[_0x19726c(0x26a)])tgBot[_0x19726c(0x2a0)](settings[_0x19726c(0x176)],_0x5c4518[_0x19726c(0x1c5)]+_0x19726c(0x286)+_0x5c4518[_0x19726c(0x1ce)])[_0x19726c(0x2aa)](_0x4d7e2b=>{telegramError(_0x4d7e2b);});else tgBot[_0x19726c(0x2a0)](settings['telegramChatId'],_0x19726c(0x16a)+_0x3078fd+_0x19726c(0x286)+_0x5c4518[_0x19726c(0x1ce)])[_0x19726c(0x2aa)](_0x1c69e8=>{telegramError(_0x1c69e8);});}}}}function getDeviceWithIp(_0x410e31){return devices['find'](_0x13a368=>_0x13a368['ip']===_0x410e31);}function temporaryAccess2FA(_0x1eb844,_0x10c3d0){const _0x4a998d=_0x4a80de;let _0x21d7b7=new Date(),_0x5890ec=![];if(lastIpApproval){if(_0x21d7b7-lastIpApproval<0x1388)_0x5890ec=!![];}lastIpApproval=new Date();if(_0x5890ec)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x4a998d(0x266)](_0x4a998d(0x24d)),tgBot['sendMessage'](settings[_0x4a998d(0x176)],_0x4a998d(0x1a4)+normalizeIP(_0x10c3d0)[_0x4a998d(0x212)]+_0x4a998d(0x230),{'parse_mode':_0x4a998d(0x1e1),'reply_markup':{'inline_keyboard':[[{'text':_0x4a998d(0x173),'callback_data':'5'},{'text':_0x4a998d(0x29b),'callback_data':'15'},{'text':_0x4a998d(0x2ab),'callback_data':'30'},{'text':_0x4a998d(0x19f),'callback_data':_0x4a998d(0x19f)}]]}})[_0x4a998d(0x2aa)](_0x2bc0e9=>{telegramError(_0x2bc0e9);}),tgBot['on'](_0x4a998d(0x24d),async _0x153854=>{const _0x432c8c=_0x4a998d,_0x40536a=_0x153854[_0x432c8c(0x18e)],_0xe4e518=_0x153854[_0x432c8c(0x216)];tgBot[_0x432c8c(0x285)](_0x153854['id'])[_0x432c8c(0x19b)](async()=>{const _0x18bc61=_0x432c8c;devices[_0x1eb844]['telegramIpApproval']={'clientip':_0x10c3d0,'timestamp':new Date()[_0x18bc61(0x21d)](),'expiry':_0x40536a},_0x40536a!=_0x18bc61(0x19f)?(await tgBot['sendMessage'](_0xe4e518[_0x18bc61(0x22e)]['id'],'Access\x20enabled\x20for\x20'+_0x40536a+_0x18bc61(0x233),{'parse_mode':_0x18bc61(0x1e1)})[_0x18bc61(0x2aa)](_0x5b9f1d=>{telegramError(_0x5b9f1d);}),io['to'](_0x1eb844)['emit'](_0x18bc61(0x187),{'access':{'allow':![],'reason':_0x18bc61(0x16e),'token':null}})):(await tgBot[_0x18bc61(0x2a0)](_0xe4e518['chat']['id'],_0x18bc61(0x25e))[_0x18bc61(0x2aa)](_0x8e3ff1=>{telegramError(_0x8e3ff1);}),io['to'](_0x1eb844)['emit'](_0x18bc61(0x187),{'access':{'allow':![],'reason':_0x18bc61(0x263),'token':null}}));}),tgBot['removeListener'](_0x432c8c(0x24d));}));}function loginAccess2FA(_0x4e945f,_0x49e309){const _0x37d988=_0x4a80de;tgBot&&settings['telegramChatId']&&(tgBot[_0x37d988(0x266)](_0x37d988(0x24d)),tgBot[_0x37d988(0x2a0)](settings[_0x37d988(0x176)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x49e309)[_0x37d988(0x212)]+_0x37d988(0x230),{'parse_mode':_0x37d988(0x1e1),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x37d988(0x19f),'callback_data':_0x37d988(0x19f)}]]}})[_0x37d988(0x2aa)](_0x5cec0b=>{telegramError(_0x5cec0b);}),tgBot['on'](_0x37d988(0x24d),async _0x52eabf=>{const _0x5ece0e=_0x37d988,_0x427a27=_0x52eabf[_0x5ece0e(0x18e)],_0x5b3087=_0x52eabf[_0x5ece0e(0x216)];tgBot[_0x5ece0e(0x285)](_0x52eabf['id'])['then'](async()=>{const _0xca6ba0=_0x5ece0e;devices[_0x4e945f][_0xca6ba0(0x284)]={'clientip':_0x49e309,'timestamp':new Date()['getTime'](),'expiry':_0x427a27},_0x427a27!=_0xca6ba0(0x19f)?(await tgBot[_0xca6ba0(0x2a0)](_0x5b3087['chat']['id'],_0xca6ba0(0x249),{'parse_mode':'HTML'})[_0xca6ba0(0x2aa)](_0x14d608=>{telegramError(_0x14d608);}),io['to'](_0x4e945f)['emit'](_0xca6ba0(0x187),{'access':{'allow':![],'reason':_0xca6ba0(0x16e),'token':null}})):(await tgBot[_0xca6ba0(0x2a0)](_0x5b3087[_0xca6ba0(0x22e)]['id'],_0xca6ba0(0x217))[_0xca6ba0(0x2aa)](_0x18901b=>{telegramError(_0x18901b);}),io['to'](_0x4e945f)['emit']('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x5ece0e(0x266)](_0x5ece0e(0x24d));}));}function getConfiguration(){const _0x294727=_0x4a80de;return dbConfig[_0x294727(0x21a)]('bots')[_0x294727(0x1e8)](_0x294727(0x20a))['value']()||[];}function getEnabledBots(){const _0x489c73=_0x4a80de;return dbConfig[_0x489c73(0x21a)](_0x489c73(0x1b2))[_0x489c73(0x1e8)](_0x489c73(0x20a))[_0x489c73(0x1d8)]({'status':_0x489c73(0x1c3)})[_0x489c73(0x2b2)]()||[];}function getDisabledBots(){const _0x39e332=_0x4a80de;return dbConfig['get']('bots')[_0x39e332(0x1e8)](_0x39e332(0x20a))[_0x39e332(0x1d8)]({'status':_0x39e332(0x231)})[_0x39e332(0x2b2)]()||[];}function getSettings(){const _0x4a6e5c=_0x4a80de;return dbSettings[_0x4a6e5c(0x21a)](_0x4a6e5c(0x16f))[_0x4a6e5c(0x2b2)]()||{'timeshift':0x0};}function getSecure(){const _0x5d3b0e=_0x4a80de;return dbSecure[_0x5d3b0e(0x21a)]('secure')[_0x5d3b0e(0x2b2)]()||{};}function getBlacklist(){const _0x5555b9=_0x4a80de;return dbSecure[_0x5555b9(0x21a)](_0x5555b9(0x2b5))[_0x5555b9(0x2b2)]()||[];}function broadcastToBots(_0x1da44a,_0x2a68ed){const _0x371704=_0x4a80de;config[_0x371704(0x214)](_0x1c96e1=>{const _0x4c8e01=_0x371704;if(_0x1c96e1['status']==_0x4c8e01(0x1c3)&&_0x1c96e1[_0x4c8e01(0x289)]=='running'){if(pid[_0x1c96e1['botID']])pid[_0x1c96e1[_0x4c8e01(0x20a)]][_0x4c8e01(0x194)]({[_0x1da44a]:_0x2a68ed});}});}function storeSettings(_0x53093e,_0x4f4d3c=![]){const _0xa9791d=_0x4a80de;_0x53093e={...settings,..._0x53093e};if(_0x4f4d3c&&_0x53093e[_0xa9791d(0x195)]!=_0xa9791d(0x1da)&&_0x53093e[_0xa9791d(0x195)]!=''){const _0x49f6c2=crypt[_0xa9791d(0x24a)](secure[_0xa9791d(0x22b)],_0x53093e['bbPassword'])[_0xa9791d(0x216)][_0xa9791d(0x1cd)]('@')[0x0],_0x710f34=bcrypt[_0xa9791d(0x254)](_0x49f6c2,saltRounds);_0x53093e={..._0x53093e,'bbPassword':_0x710f34};}if(_0x4f4d3c&&_0x53093e[_0xa9791d(0x200)]!=_0xa9791d(0x1da)&&_0x53093e['telegramToken']!=''){const _0x5e2481=crypt['decrypt'](secure[_0xa9791d(0x22b)],_0x53093e[_0xa9791d(0x200)])['message'][_0xa9791d(0x1cd)]('@')[0x0];_0x53093e={..._0x53093e,'telegramToken':_0x5e2481};}const _0x703bda=_0x53093e['telegramToken']!='************'&&_0x53093e[_0xa9791d(0x200)]!=settings[_0xa9791d(0x200)]||_0x53093e[_0xa9791d(0x23c)]!=settings['telegramUsername'],_0x5f0cb7=_0x53093e[_0xa9791d(0x200)]==''||_0x53093e['telegramUsername']=='';if(_0x703bda)_0x53093e[_0xa9791d(0x27d)]=_0xa9791d(0x171);for(const [_0x1d9078,_0x2a2b33]of Object[_0xa9791d(0x1c2)](_0x53093e)){if(_0x1d9078=='telegramToken'&&_0x2a2b33==_0xa9791d(0x1da)){_0x53093e[_0xa9791d(0x200)]=settings[_0xa9791d(0x200)];continue;};if(_0x1d9078==_0xa9791d(0x195)&&_0x2a2b33==_0xa9791d(0x1da)){_0x53093e['bbPassword']=settings[_0xa9791d(0x195)];continue;};dbSettings[_0xa9791d(0x21c)](_0xa9791d(0x292)+_0x1d9078,_0x2a2b33)[_0xa9791d(0x19e)]();}settings=_0x53093e,io['to'](_0xa9791d(0x207))[_0xa9791d(0x28b)](_0xa9791d(0x16f),cleanSettings()),broadcastToBots(_0xa9791d(0x278),settings['timeshift']);if(_0x703bda&&!_0x5f0cb7)initTelegram();if(_0x703bda&&_0x5f0cb7)disableTelegram();getAllClients()[_0xa9791d(0x214)](_0x11d140=>{const _0x5d45e5=_0xa9791d;getSocket(_0x11d140['id'])[_0x5d45e5(0x28b)]('status',{'access':{'allow':![],'reason':_0x5d45e5(0x16e),'token':null}});});}function updateSetting(_0x56b753,_0x16fc59){const _0x17f5b9=_0x4a80de;dbSettings['set'](_0x17f5b9(0x292)+_0x56b753,_0x16fc59)['write'](),settings=getSettings(),io['to'](_0x17f5b9(0x207))[_0x17f5b9(0x28b)](_0x17f5b9(0x16f),cleanSettings());}function storeSecure(_0x3c90a4){const _0x27c830=_0x4a80de;dbSecure[_0x27c830(0x21a)](_0x27c830(0x28f))[_0x27c830(0x25c)](_0x3c90a4)[_0x27c830(0x19e)](),secure=_0x3c90a4;}function addBlacklist(_0x19906c){const _0x47ceef=_0x4a80de;cleanBlacklist();let _0x36442e;devices[_0x19906c][_0x47ceef(0x1cb)]?_0x36442e=Math['max'](devices[_0x19906c][_0x47ceef(0x1cb)]['expiry'],loginExpiry):_0x36442e=loginExpiry,dbSecure['get']('blacklist')[_0x47ceef(0x25c)]({'expiry':new Date()[_0x47ceef(0x21d)]()+_0x36442e*0x3c*0x3e8,'token':devices[_0x19906c][_0x47ceef(0x2a6)]['token']})[_0x47ceef(0x19e)](),blacklist=dbSecure[_0x47ceef(0x21a)](_0x47ceef(0x2b5))[_0x47ceef(0x2b2)]();}function cleanBlacklist(){const _0x3061ab=_0x4a80de;let _0x1eea6a=dbSecure[_0x3061ab(0x21a)](_0x3061ab(0x2b5))['cloneDeep']()[_0x3061ab(0x2b2)](),_0x1f965f=new Date()[_0x3061ab(0x21d)]();_0x1eea6a[_0x3061ab(0x214)](_0x255194=>{const _0x5f0c00=_0x3061ab;_0x255194['expiry']<_0x1f965f&&dbSecure[_0x5f0c00(0x21a)]('blacklist')[_0x5f0c00(0x270)]({'expiry':_0x255194[_0x5f0c00(0x170)]})['write']();});}function initStates(){const _0x4c4c2c=_0x4a80de;let _0x3175a2=getConfiguration();_0x3175a2[_0x4c4c2c(0x214)](_0x251733=>{const _0x169184=_0x4c4c2c;_0x251733[_0x169184(0x289)]=_0x169184(0x2af);}),storeConfiguration(_0x3175a2);}function _0x3b0f(){const _0x52cf35=['decrypt','order','uuid','callback_query','get-logs','user','Notifications\x20disabled','sendFile','/restart\x20-\x20restart\x20bot(s)\x0a','kill','hashSync','telegram','/:bot','Unauthorized\x20attempt\x20to\x20log\x20out','started','1035774ZAKJxG','function','child_process','push','/:bot/configuration','Temporary\x20access\x20rejected','storeHeadless','https://hodlerhacks.com','onText','unlinkSync','temporary\x20access\x20rejected','listen','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','removeListener','initclient','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','storeConfiguration','showname','You\x20can\x20use\x20the\x20following\x20commands:\x0a','new-disabled','logged\x20out','default','test','remove','\x20/\x20','404\x20Not\x20Found','No\x20authentication\x20token','Bot\x20Mgr\x20>\x20','Notifications\x20disabled\x0a','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','getMinutes','timeshift','Balance\x20Bot\x20Server','hasOwnProperty','keys','path','telegramEvents','Invalid\x20username\x20or\x20IP\x20address','getMonth','Unauthorized\x20attempt\x20to\x20delete\x20bot','randomBytes','bot.js','login\x20required','telegram2FaApproval','answerCallbackQuery','\x20>\x20','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','generateKeyPairAsync','live','/:bot/coins','emit','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','Unauthorized\x20attempt\x20to\x20update\x20bot','f2aRequired','secure','kind','ipv6','settings.','new','\x20|\x20','defaults','-events.json','match','bbUsername','success','temporary\x20token\x20generated','15\x20min','All\x20bots\x20running\x20right\x20now','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','stopPolling','starting\x20new\x20bot\x20|\x20Bot\x20','sendMessage','9470850OJhgcN','join','Balance\x20Bot','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','access','2FA\x20required','/:bot/support','Password\x20has\x20been\x20reset\x20to:\x20','catch','30\x20min','get-starting-balances','bcryptjs','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','stopped','bot-','loginRequired','value','toString','enabled\x20Bot\x20','blacklist','Bot\x20','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','exit','type','reload','settings','expiry','all','<b>Balance\x20Bot\x20status:</b>\x0a','5\x20min','login\x20not\x20required','login\x20token\x20valid','telegramChatId','Unauthorized\x20attempt\x20to\x20get\x20logs','bb-config.json','NTBA_FIX_319','Unauthorized\x20attempt\x20to\x20add\x20bot','stop','node-telegram-bot-api','restarting\x20Bot\x20','name','RSA-OAEP','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','restart','RSA','map','store-headless','build2','backup/','status','Unauthorized\x20login\x20attempt\x20(public\x20key)','existsSync','2FA\x20login\x20token\x20generated','-results.json','inherit','host','data','temporary\x20access\x20not\x20allowed','socket.io','find','from','running','send','bbPassword','SIGINT','isDirectory','/off\x20-\x20stop\x20bot(s)\x0a','allow','isValid','then','yes','2FA\x20login\x20required','write','reject','<b>Telegram\x20bot\x20status:</b>\x0a','toIPv4Address','store-settings','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','isIPv4MappedAddress','length','removeAllListeners','telegramEnabled','use','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','disconnect','argv','log','Unauthorized\x20attempt\x20to\x20store\x20configuration','pidExpireLogin','login\x20token\x20generated','1000','bots','timestamp','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','date-fns','bot','temporaryAccessAllowed','Crypt','handshake','compareSync','getUTCHours','publicKey','(((.+)+)+)+$','store','login','logout','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','entries','enabled','SIGTERM','botname','Orders','::ffff:127.0.0.1','25921024HUUYMZ','Ok,\x20will\x20send\x20order\x20notifications\x20only','constructor','telegramIpApproval','Unauthorized\x20login\x20attempt\x20(timeout)','split','event','/enable\x20-\x20enable\x20notifications\x0a','auth','pidRefreshToken','padStart','User\x20has\x20been\x20validated','-----------------------------------------------------------------------------------','http',':\x20Bot\x20Mgr\x20>\x20','token','filter','includes','************','orders','static','ipaddr.js','crypto','Error:\x20Invalid\x20argument\x20','env','HTML','invalid\x20credentials','toIPv4MappedAddress','3000','secret','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','username','sortBy','remoteAddress','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','jsonwebtoken','error\x20while\x20deleting\x20config\x20files:\x20','Unauthorized\x20attempt\x20to\x20get\x20portfolio','referer','password','placeOrder','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','emitHistory','alerts','789358PnqdmV','reset-password','127.0.0.1','readdirSync','update-bot','/help\x20-\x20show\x20available\x20commands\x0a','/disable\x20-\x20disable\x20notifications\x0a','sockets','connection','410yBOMka','getFullYear','::1','telegramToken','get-portfolio','store-configuration','mkdirSync','build','Password\x20reset\x20rejected','Ok,\x20will\x20send\x20alert\x20notifications\x20only','botmanager','once','copyFileSync','botID','@analytics/google-analytics','slice',',\x20must\x20be\x20a\x204\x20digit\x20number','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','bb/','\x20only\x0a','parse','show','hybrid-crypto-js','forEach','reason','message','Login\x20rejected','whitelistEnabled','args','get','index.html','set','getTime','headers','idling\x20bot\x20\x20\x20|\x20Bot\x20','error','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','sign','/on\x20-\x20start\x20bot(s)\x0a','search','express','yargs/yargs','240135qZiZYg','Invalid\x20authentication\x20token\x20(1)','/status\x20-\x20show\x20bot(s)\x20status\x0a','verify','privateKey','Invalid\x20Telegram\x20token','lowdb/adapters/FileSync','chat','getDate','</b>\x20?','disabled','config/','\x20minutes','Notifications\x20enabled\x0a','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','getHours','All\x20bots',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','exp','67480VqqmNW','randomFillSync','telegramUsername','clientip','ipc','add','UA-192771731-1','/:bot/portfolio','Alerts','Unauthorized\x20attempt\x20to\x20update\x20settings','-performance.json','assign','access\x20timeout','5136803nuhRJA','Token\x20blacklisted','Login\x20accepted'];_0x3b0f=function(){return _0x52cf35;};return _0x3b0f();}function onKeys(){const _0xb37415=new RSA();return new Promise(_0x888ff=>{const _0x14904e=_0x2175;_0xb37415[_0x14904e(0x288)]()[_0x14904e(0x19b)](_0x1df34f=>{_0x888ff(_0x1df34f);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x558fc2=_0x4a80de;let _0x4fcea9=getConfiguration(),_0x5290d0=![];_0x4fcea9[_0x558fc2(0x214)](_0x5f21c7=>{const _0x57f808=_0x558fc2;if(_0x5f21c7[_0x57f808(0x187)]==_0x57f808(0x193))_0x5f21c7[_0x57f808(0x187)]=_0x57f808(0x1c3),_0x5290d0=!![];else _0x5f21c7[_0x57f808(0x187)]=='stopped'&&(_0x5f21c7[_0x57f808(0x187)]=_0x57f808(0x231),_0x5290d0=!![]);});if(_0x5290d0)storeConfiguration(_0x4fcea9);let _0x3cae90=getSecure();if(!_0x3cae90[_0x558fc2(0x27a)](_0x558fc2(0x1e5))){let _0x33ad7e=await generateKeys();_0x3cae90[_0x558fc2(0x1bc)]=_0x33ad7e['publicKey'],_0x3cae90[_0x558fc2(0x22b)]=_0x33ad7e[_0x558fc2(0x22b)],_0x3cae90[_0x558fc2(0x1e5)]=crypto[_0x558fc2(0x281)](0x20)['toString']('hex');;storeSecure(_0x3cae90);}let _0x40d9d5=getSettings();_0x5290d0=![];!_0x40d9d5['hasOwnProperty']('loginRequired')&&(_0x40d9d5[_0x558fc2(0x2b1)]=![],_0x40d9d5[_0x558fc2(0x298)]='',_0x40d9d5[_0x558fc2(0x195)]='',_0x40d9d5[_0x558fc2(0x28e)]=![],_0x5290d0=!![]);!_0x40d9d5['hasOwnProperty']('whitelistEnabled')&&(_0x40d9d5[_0x558fc2(0x218)]=![],_0x40d9d5['whitelist']=[],_0x40d9d5[_0x558fc2(0x1b7)]=![],_0x5290d0=!![]);if(!_0x40d9d5[_0x558fc2(0x27a)]('telegramEnabled')){if(_0x40d9d5[_0x558fc2(0x176)])_0x40d9d5['telegramEnabled']=!![];else _0x40d9d5[_0x558fc2(0x1a8)]=![];_0x5290d0=!![];}if(_0x5290d0)storeSettings(_0x40d9d5);}function storeConfiguration(_0x16cdc7){const _0x5b093a=_0x4a80de;dbConfig[_0x5b093a(0x21a)]('bots')[_0x5b093a(0x270)]()[_0x5b093a(0x19e)](),dbConfig[_0x5b093a(0x21a)](_0x5b093a(0x1b2))['push'](..._0x16cdc7)[_0x5b093a(0x19e)](),config=_0x16cdc7;}function resetPassword(){const _0x2aa6dd=_0x4a80de;tgBot&&settings['telegramChatId']&&(tgBot[_0x2aa6dd(0x266)](_0x2aa6dd(0x24d)),tgBot[_0x2aa6dd(0x2a0)](settings['telegramChatId'],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x2aa6dd(0x1e1),'reply_markup':{'inline_keyboard':[[{'text':_0x2aa6dd(0x19c),'callback_data':_0x2aa6dd(0x19c)},{'text':'no','callback_data':'no'}]]}})[_0x2aa6dd(0x2aa)](_0x383e0c=>{telegramError(_0x383e0c);}),tgBot['on'](_0x2aa6dd(0x24d),async _0x4f5b1b=>{const _0x518d62=_0x2aa6dd,_0x10afe7=_0x4f5b1b[_0x518d62(0x18e)],_0x473e7f=_0x4f5b1b['message'];tgBot[_0x518d62(0x285)](_0x4f5b1b['id'])[_0x518d62(0x19b)](async()=>{const _0x3b28c9=_0x518d62;if(_0x10afe7!='no'){const _0x1064fe=0xf,_0x1c6b0f=_0x3b28c9(0x1f1),_0x32a2e9=Array[_0x3b28c9(0x192)](crypto[_0x3b28c9(0x23b)](new Uint32Array(_0x1064fe)))[_0x3b28c9(0x183)](_0x4dad8d=>_0x1c6b0f[_0x4dad8d%_0x1c6b0f[_0x3b28c9(0x1a6)]])['join'](''),_0x19c4e6=bcrypt['hashSync'](_0x32a2e9,saltRounds);storeSettings({'bbPassword':_0x19c4e6}),await tgBot[_0x3b28c9(0x2a0)](_0x473e7f[_0x3b28c9(0x22e)]['id'],_0x3b28c9(0x2a9)+_0x32a2e9,{'parse_mode':_0x3b28c9(0x1e1)})['catch'](_0x267056=>{telegramError(_0x267056);});}else await tgBot[_0x3b28c9(0x2a0)](_0x473e7f['chat']['id'],_0x3b28c9(0x205))[_0x3b28c9(0x2aa)](_0x29f8f4=>{telegramError(_0x29f8f4);});}),tgBot[_0x518d62(0x266)]('callback_query');}));}function logging(_0x234a3f){const _0x5ce663=_0x4a80de;console[_0x5ce663(0x1ad)](getTimeStamp()+_0x5ce663(0x1d6)+_0x234a3f);if(tgBot&&settings[_0x5ce663(0x176)]&&settings['telegramEvents']!='orders')tgBot['sendMessage'](settings[_0x5ce663(0x176)],_0x5ce663(0x274)+_0x234a3f)[_0x5ce663(0x2aa)](_0x5748e5=>{telegramError(_0x5748e5);});}function getServerTime(){const _0x51792b=_0x4a80de,_0x30eda6=new Date();return _0x30eda6['getFullYear']()+'/'+(_0x30eda6[_0x51792b(0x27f)]()+0x1)[_0x51792b(0x2b3)]()[_0x51792b(0x1d2)](0x2,'0')+'/'+_0x30eda6[_0x51792b(0x22f)]()['toString']()[_0x51792b(0x1d2)](0x2,'0')+'\x20'+_0x30eda6[_0x51792b(0x236)]()[_0x51792b(0x2b3)]()[_0x51792b(0x1d2)](0x2,'0')+':'+_0x30eda6[_0x51792b(0x277)]()['toString']()['padStart'](0x2,'0')+':'+_0x30eda6['getSeconds']()['toString']()[_0x51792b(0x1d2)](0x2,'0');}function getTimeStamp(){const _0x395440=_0x4a80de,_0x50142d=shiftedTime();return _0x50142d[_0x395440(0x1fe)]()+'/'+(_0x50142d[_0x395440(0x27f)]()+0x1)[_0x395440(0x2b3)]()['padStart'](0x2,'0')+'/'+_0x50142d['getDate']()['toString']()[_0x395440(0x1d2)](0x2,'0')+'\x20'+_0x50142d[_0x395440(0x236)]()[_0x395440(0x2b3)]()[_0x395440(0x1d2)](0x2,'0')+':'+_0x50142d[_0x395440(0x277)]()[_0x395440(0x2b3)]()[_0x395440(0x1d2)](0x2,'0')+':'+_0x50142d['getSeconds']()[_0x395440(0x2b3)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x393625=_0x4a80de,_0x577eb0=new Date();let _0x2f4c2b=_0x577eb0;if(settings[_0x393625(0x278)]&&settings[_0x393625(0x278)]!==0x0)_0x2f4c2b=fns[_0x393625(0x23f)](_0x577eb0,{'hours':settings[_0x393625(0x278)]});return _0x2f4c2b;}function startScheduler(){const _0x26553a=_0x4a80de;let _0x19efa3=new Date()[_0x26553a(0x1bb)]();_0x19efa3==0x1&&backupConfigFiles();_0x19efa3==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x206986=_0x4a80de;fs[_0x206986(0x1f7)](configpath,{'withFileTypes':!![]})['forEach'](_0x5f4976=>{const _0x4c4e69=_0x206986;if(!_0x5f4976[_0x4c4e69(0x197)]())fs[_0x4c4e69(0x209)](configpath+_0x5f4976[_0x4c4e69(0x17e)],configbackuppath+_0x5f4976[_0x4c4e69(0x17e)]);});}function triggerAnalytics(){const _0x3e1c8c=_0x4a80de;analytics['page']({'title':_0x3e1c8c(0x279),'href':_0x3e1c8c(0x260),'path':'/v'+serverversion});}function validateCredentials(_0x4eaebe,_0x2249e6){const _0x1427cc=_0x4a80de;if(_0x4eaebe[_0x1427cc(0x1e7)]==settings[_0x1427cc(0x298)]&&bcrypt[_0x1427cc(0x1ba)](_0x4eaebe['password'],settings[_0x1427cc(0x195)])){if(settings[_0x1427cc(0x28e)])return{'allow':![],'reason':_0x1427cc(0x19d),'token':null};else{const _0x45a78c=generateLoginToken(_0x2249e6);return{'allow':!![],'reason':_0x1427cc(0x1b0),'token':_0x45a78c};}}else return{'allow':![],'reason':_0x1427cc(0x1e2),'token':null};}function refreshToken(_0x182f8e){const _0x2af68b=generateLoginToken(_0x182f8e);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x2af68b};}function validateAccess(_0x93791,_0x354f30){const _0x11efc9=_0x4a80de;let _0x5b7f64=devices[_0x354f30]['ip'],_0x29bdad;const _0x51206f=_0x1341ec=>{const _0x361d27=_0x2175;if(settings[_0x361d27(0x2b1)]){if(settings[_0x361d27(0x28e)]){if(telegram2FaApproved(_0x354f30)){const _0x253b0b=generateLoginToken(_0x354f30);return{'allow':!![],'reason':_0x361d27(0x18a),'token':_0x253b0b};}else return{'allow':![],'reason':_0x361d27(0x283),'token':null};}else return _0x29bdad=validToken(_0x1341ec,_0x354f30),_0x29bdad[_0x361d27(0x27a)](_0x361d27(0x299))?{'allow':!![],'reason':_0x361d27(0x175),'token':_0x1341ec}:{'allow':![],'reason':_0x361d27(0x283),'token':null};}else return{'allow':!![],'reason':_0x361d27(0x174),'token':null};};if(settings[_0x11efc9(0x218)]){let _0x3a7a64=[...settings['whitelist'],_0x11efc9(0x1ff),_0x11efc9(0x1c7),_0x11efc9(0x1f6)];if(_0x3a7a64[_0x11efc9(0x1d9)](_0x5b7f64))return _0x51206f(_0x93791);else{_0x29bdad=validToken(_0x93791,_0x354f30);if(_0x29bdad['hasOwnProperty'](_0x11efc9(0x299)))return _0x51206f(_0x93791);else{if(telegramIpApproved(_0x354f30)){const _0xccc468=generateToken(_0x354f30);return _0x29bdad=_0x51206f(_0x93791),_0x29bdad[_0x11efc9(0x199)]?{'allow':!![],'reason':_0x11efc9(0x29a),'token':_0xccc468}:_0x29bdad;}else return settings[_0x11efc9(0x1b7)]?{'allow':![],'reason':_0x11efc9(0x2a7),'token':null}:{'allow':![],'reason':_0x11efc9(0x18f),'token':null};}}}else return _0x51206f(_0x93791);}function timelyDecrypt(_0x1fea34,_0x3aa374=!![]){const _0x24888f=_0x4a80de;if(_0x1fea34)try{const _0x51aa2e=crypt['decrypt'](secure[_0x24888f(0x22b)],_0x1fea34)[_0x24888f(0x216)],_0x420a2f=_0x51aa2e[_0x24888f(0x1cd)]('@')[0x0],_0x29824a=_0x51aa2e[_0x24888f(0x1cd)]('@')[0x1],_0x5cb9d9=new Date()[_0x24888f(0x21d)]();if(_0x3aa374){if(_0x5cb9d9-_0x29824a<maxSecretAge*0x3e8)return _0x420a2f;else return![];}else return _0x420a2f;}catch(_0x3b71f9){return![];}else return![];}const validToken=(_0xa4a70b,_0x14c7ab)=>{const _0x3e39fb=_0x4a80de,_0xa01e7=devices[_0x14c7ab]['ip'];if(!_0xa4a70b)return{'error':_0x3e39fb(0x273)};for(let _0x323aca of blacklist){if(_0x323aca['token']==_0xa4a70b)return{'error':_0x3e39fb(0x248)};}let _0x39140d;try{_0x39140d=jwt[_0x3e39fb(0x22a)](_0xa4a70b,secure[_0x3e39fb(0x1e5)]+_0x14c7ab);}catch{return{'error':_0x3e39fb(0x228)};}if(!_0x39140d['hasOwnProperty'](_0x3e39fb(0x23d))&&!_0x39140d[_0x3e39fb(0x27a)]('username')||!_0x39140d[_0x3e39fb(0x27a)](_0x3e39fb(0x239)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x39140d[_0x3e39fb(0x27a)](_0x3e39fb(0x1e7))&&_0x39140d[_0x3e39fb(0x27a)](_0x3e39fb(0x23d))){const {clientip:_0x4de771}=_0x39140d;return _0xa01e7==_0x4de771?{'success':_0x3e39fb(0x1d3)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x39140d[_0x3e39fb(0x27a)](_0x3e39fb(0x1e7))&&_0x39140d['hasOwnProperty'](_0x3e39fb(0x23d))){const {username:_0x9ec19b,clientip:_0x3238ef}=_0x39140d;return settings[_0x3e39fb(0x298)]==_0x9ec19b&&_0xa01e7==_0x3238ef?{'success':_0x3e39fb(0x1d3)}:{'error':_0x3e39fb(0x27e)};}}},generateLoginToken=_0x2885ec=>{const _0x209b64=_0x4a80de;if(_0x2885ec){const _0x2653ab=devices[_0x2885ec]['ip'];return jwt['sign']({'username':settings['bbUsername'],'clientip':_0x2653ab},secure[_0x209b64(0x1e5)]+_0x2885ec,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x362c0d=>{const _0x5cd31b=_0x4a80de;if(_0x362c0d){const _0x2b6d73=devices[_0x362c0d]['ip'];return jwt[_0x5cd31b(0x222)]({'clientip':_0x2b6d73},secure[_0x5cd31b(0x1e5)]+_0x362c0d,{'expiresIn':devices[_0x362c0d][_0x5cd31b(0x1cb)][_0x5cd31b(0x170)]*0x3c});}else return![];},telegramIpApproved=_0x4ccc2a=>{const _0x324312=_0x4a80de;let _0xaaa428=![];return devices[_0x4ccc2a][_0x324312(0x1cb)]&&devices[_0x4ccc2a][_0x324312(0x1cb)][_0x324312(0x170)]!=_0x324312(0x19f)&&(_0xaaa428=devices[_0x4ccc2a][_0x324312(0x1cb)][_0x324312(0x23d)]==devices[_0x4ccc2a]['ip']&&new Date()[_0x324312(0x21d)]()-devices[_0x4ccc2a][_0x324312(0x1cb)][_0x324312(0x1b3)]<devices[_0x4ccc2a]['telegramIpApproval'][_0x324312(0x170)]*0x3c*0x3e8),_0xaaa428;},telegram2FaApproved=_0x14e5a8=>{const _0x21f510=_0x4a80de;let _0x52251e=![];return devices[_0x14e5a8]['telegram2FaApproval']&&devices[_0x14e5a8]['telegram2FaApproval'][_0x21f510(0x170)]!=_0x21f510(0x19f)&&(_0x52251e=devices[_0x14e5a8][_0x21f510(0x284)][_0x21f510(0x23d)]==devices[_0x14e5a8]['ip']&&new Date()[_0x21f510(0x21d)]()-devices[_0x14e5a8][_0x21f510(0x284)][_0x21f510(0x1b3)]<devices[_0x14e5a8][_0x21f510(0x284)]['expiry']*0x3c*0x3e8),_0x52251e;},normalizeIP=_0x5af811=>{const _0x400497=_0x4a80de;let _0x12f24b=null,_0x55ff5b=null;if(ipaddr[_0x400497(0x19a)](_0x5af811)){const _0x4b82d9=ipaddr[_0x400497(0x211)](_0x5af811);_0x4b82d9[_0x400497(0x290)]()===_0x400497(0x291)?(_0x4b82d9[_0x400497(0x1a5)]()&&(_0x12f24b=_0x4b82d9[_0x400497(0x1a1)]()[_0x400497(0x2b3)]()),_0x55ff5b=_0x4b82d9['toString']()):(_0x12f24b=_0x4b82d9[_0x400497(0x2b3)](),_0x55ff5b=_0x4b82d9[_0x400497(0x1e3)]()[_0x400497(0x2b3)]());}return{'show':_0x12f24b?_0x12f24b:_0x55ff5b,'store':_0x55ff5b};};