const _0xd24516=_0x460b;(function(_0x31b37a,_0xe7d4e8){const _0x2c2e78=_0x460b,_0x5a629e=_0x31b37a();while(!![]){try{const _0x57d181=-parseInt(_0x2c2e78(0xf6))/0x1+parseInt(_0x2c2e78(0x1bc))/0x2*(-parseInt(_0x2c2e78(0xea))/0x3)+-parseInt(_0x2c2e78(0x179))/0x4*(-parseInt(_0x2c2e78(0xf7))/0x5)+parseInt(_0x2c2e78(0xeb))/0x6*(-parseInt(_0x2c2e78(0x13c))/0x7)+parseInt(_0x2c2e78(0x164))/0x8*(-parseInt(_0x2c2e78(0x1ac))/0x9)+-parseInt(_0x2c2e78(0x143))/0xa+parseInt(_0x2c2e78(0xd0))/0xb*(parseInt(_0x2c2e78(0x82))/0xc);if(_0x57d181===_0xe7d4e8)break;else _0x5a629e['push'](_0x5a629e['shift']());}catch(_0x30fdff){_0x5a629e['push'](_0x5a629e['shift']());}}}(_0x211c,0x547fd));const _0x2ddab1=function(){let _0x985914=!![];return function(_0x130e70,_0x4f5270){const _0x190600=_0x985914?function(){const _0x1863ed=_0x460b;if(_0x4f5270){const _0x455bed=_0x4f5270[_0x1863ed(0x155)](_0x130e70,arguments);return _0x4f5270=null,_0x455bed;}}:function(){};return _0x985914=![],_0x190600;};}(),_0x542dfc=_0x2ddab1(this,function(){const _0x3edfa8=_0x460b;return _0x542dfc[_0x3edfa8(0x1cc)]()['search']('(((.+)+)+)+$')[_0x3edfa8(0x1cc)]()['constructor'](_0x542dfc)[_0x3edfa8(0xbf)](_0x3edfa8(0x1ba));});_0x542dfc();'use strict';process[_0xd24516(0xed)]['NTBA_FIX_319']=0x1;const childProcess=require(_0xd24516(0x16a)),FileSync=require(_0xd24516(0x1dc)),fs=require('fs'),fns=require(_0xd24516(0x14a)),low=require('lowdb'),path=require(_0xd24516(0x159)),crypto=require(_0xd24516(0x117)),Crypt=require('hybrid-crypto-js')[_0xd24516(0xf2)],RSA=require(_0xd24516(0x152))[_0xd24516(0xe1)],bcrypt=require(_0xd24516(0x1b3)),jwt=require(_0xd24516(0xd1)),{Analytics}=require(_0xd24516(0x132)),googleAnalyticsV3Plugin=require(_0xd24516(0x197))[_0xd24516(0x1ce)],ipaddr=require('ipaddr.js'),argv=require(_0xd24516(0x168))(process[_0xd24516(0xbc)]['slice'](0x2))[_0xd24516(0xbc)],PORT=argv['port']||'3000',pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0xd24516(0x110)](_0xd24516(0x1b9)+PORT+_0xd24516(0x19a)),process[_0xd24516(0xa7)](0x1));const HOST=argv[_0xd24516(0x12b)]||null,userID=argv[_0xd24516(0x115)]||'';let bbpath=_0xd24516(0x10e),bbpath2='';const botfile=_0xd24516(0x18f),configfile='bb-config.json',settingsfile=_0xd24516(0xa8),securefile=_0xd24516(0x186);let validInstallation=!![];!fs[_0xd24516(0xb0)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0xd24516(0x19e)),configpath=userID?bbpath+_0xd24516(0xb6)+userID+'/':bbpath+_0xd24516(0xb6),configbackuppath=configpath+'backup/';!fs[_0xd24516(0xb0)](configpath)&&fs[_0xd24516(0x181)](configpath);!fs[_0xd24516(0xb0)](configbackuppath)&&fs[_0xd24516(0x181)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0xd24516(0x16f)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);function _0x211c(){const _0x29c741=['All\x20bots','logged\x20out','getSeconds','Orders','telegramChatId','<b>Telegram\x20Bot\x20Status:</b>\x0a','compareSync','build','/help\x20-\x20show\x20available\x20commands\x0a','randomFillSync','timestamp','/on\x20-\x20start\x20bot(s)\x0a','disabled','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','store-configuration','remoteAddress','host','padStart','reason','Ok,\x20will\x20send\x20alert\x20notifications\x20only','randomBytes','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','/:bot/configuration','analytics','2FA\x20login\x20token\x20generated','includes','split','connection','secret','get','getTime','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','success','1274FyHDZH','allow','isIPv4MappedAddress','chat','-results.json','alerts','started','4829260OTIWTS','sendFile','/:bot/support','getHours','connected','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','kind','date-fns','telegrammsg','No\x20bots\x20running\x20right\x20now','-performance.json','then','handshake','2FA\x20login\x20rejected','showname','hybrid-crypto-js','2FA',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','apply','getMinutes','Unauthorized\x20attempt\x20to\x20update\x20bot','build2','path','stopPolling','404\x20Not\x20Found','settings','event','getFullYear','readdirSync','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','message','Ok,\x20will\x20send\x20order\x20notifications\x20only','auth','272npNqMI','find','match','delete-bot','yargs/yargs','callback_query','child_process','loginRequired','enabled','initclient','placeOrder','defaults','delete-alerts','starting\x20new\x20bot\x20|\x20Bot\x20','error','telegram','Notifications\x20enabled','Notifications\x20types:\x20','kill','toIPv4MappedAddress','Password\x20reset\x20rejected','340124qOIXcn','headless','store-settings','::ffff:127.0.0.1','assign','/restart\x20-\x20restart\x20bot(s)\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Temporary\x20access\x20rejected','mkdirSync','Invalid\x20username\x20or\x20IP\x20address','bot','exp','verify','bb-secure.json','/:bot/performance','copyFileSync','live','answerCallbackQuery','bot-','/:bot/history','set','************','bot.js','bbUsername','parse','store-headless','unlinkSync','all','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','removeListener','@analytics/google-analytics-v3','stringify','reset-password',',\x20must\x20be\x20a\x204\x20digit\x20number','page','/:bot','\x20only\x0a','clients','password','toggleBotMode','inherit','token','30\x20min','disconnect','storeConfiguration','restarting\x20Bot\x20','get-logs','whitelistEnabled','bbPassword','All\x20bots\x20running\x20right\x20now','cancelLoading','49041Tnghuz','/:bot/portfolio','node-telegram-bot-api','temporary\x20token\x20generated','\x20>\x20','telegramUsername','getMonth','bcryptjs','-----------------------------------------------------------------------------------','Invalid\x20authentication\x20token\x20(2)','function','HTML','createServer','Error:\x20Invalid\x20argument\x20','(((.+)+)+)+$','filter','158274KfQers','server','pidRefreshToken','starting\x20bot\x20|\x20Bot\x20',':\x20Bot\x20Mgr\x20>\x20','1000','bots','username','store','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','forEach','remove','pidExpireLogin','botmanager','f2aRequired','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','toString','length','default','SIGINT','apiKey','notification','http','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','You\x20can\x20use\x20the\x20following\x20commands:\x0a','invalid\x20credentials','deleted\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','telegramIpApproval','Unauthorized\x20attempt\x20to\x20delete\x20bot','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','join','lowdb/adapters/FileSync','ipc','Invalid\x20Telegram\x20token','listen','\x20mode','publicKey','stop','24795276bJwxxN','keys','reload','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','polling_error','data','clientip','yes','secure','new-disabled','\x20minutes','reject','Balance\x20Bot\x20Server','\x20to\x20','2FA\x20login\x20required','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','add-bot','access','add','Login\x20rejected','isValid','conn','deleteHistoryAlerts','All','temporary\x20access\x20rejected','get-portfolio','from','/disable\x20-\x20disable\x20notifications\x0a','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','stopped','readFileSync','whitelist','blacklist','getPortfolio','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','static','telegramToken','exit','bb-settings.json','telegramEvents','login\x20token\x20generated','manual','getStartingBalances','telegram2FaApproval','order','write','existsSync','botname','getDate','version.json','hex','sendMessage','config/','User\x20has\x20been\x20validated','isDirectory','Notifications\x20enabled\x0a','Token\x20blacklisted','accept','argv','orders','Invalid\x20authentication\x20token\x20(1)','search','storeHeadless','use','ipv6','uuid','once','botID','sendPortfolioTelegram','hasOwnProperty','sortBy','auto','running','show','telegramEnabled','send','Unauthorized\x20attempt\x20to\x20store\x20configuration','timeshift','11roRztD','jsonwebtoken','getUTCHours','/enable\x20-\x20enable\x20notifications\x0a','login\x20required','expiry','entries','temporary\x20access\x20not\x20allowed','toIPv4Address','updatebotmanager','cancel-loading','onText','15\x20min','status','-config.json','enabled\x20Bot\x20','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','RSA','Unauthorized\x20attempt\x20to\x20get\x20portfolio','emit','privateKey','decrypt','Unauthorized\x20login\x20attempt\x20(timeout)','toggle-bot-mode','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','encryptedUuid','9ioPyJq','21612TTyyDp','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','env','error\x20while\x20deleting\x20config\x20files:\x20','login','idling\x20bot\x20\x20\x20|\x20Bot\x20','login\x20token\x20valid','Crypt','Bot\x20','index.html','Access\x20enabled\x20for\x20','669183nQNXbI','30bpRnND','Unauthorized\x20attempt\x20to\x20log\x20out','value','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Unauthorized\x20attempt\x20to\x20get\x20logs','emitHistory','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','update-bot','5\x20min','mode','No\x20authentication\x20token','</b>\x20?','express','socket.io','login\x20not\x20required','name','new','map','sockets','push','type','2FA\x20required','writeFileSync','bb/','-events.json','log','Notifications\x20disabled','sign','Allow\x20login\x20from\x20IP\x20address\x20<b>','Unauthorized\x20attempt\x20to\x20update\x20settings','user','max','crypto','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','\x20|\x20','catch'];_0x211c=function(){return _0x29c741;};return _0x211c();}dbSettings[_0xd24516(0x16f)]({'settings':{'timeshift':0x0}})[_0xd24516(0xaf)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0xd24516(0x16f)]({'secure':{},'blacklist':[]})[_0xd24516(0xaf)]();let crypt=new Crypt({'md':'sha256','rsaStandard':'RSA-OAEP'});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0xd24516(0xb3))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];oneTimeMigration(),cleanBlacklist();const express=require(_0xd24516(0x103)),app=express(),http=require(_0xd24516(0x1d2))[_0xd24516(0x1b8)](app);app[_0xd24516(0xc1)](express[_0xd24516(0xa5)](path[_0xd24516(0x1db)](__dirname,bbpath2,_0xd24516(0x158)))),app['use'](express[_0xd24516(0xa5)](path['join'](__dirname,bbpath2,_0xd24516(0x122)))),app[_0xd24516(0x138)]('/',function(_0x36dbfc,_0x488681){const _0x3e9ad2=_0xd24516;_0x488681[_0x3e9ad2(0x144)](path[_0x3e9ad2(0x1db)](__dirname,bbpath2,_0x3e9ad2(0x158),_0x3e9ad2(0xf4)));}),app[_0xd24516(0x138)](_0xd24516(0x19c),function(_0x1193b9,_0x39663d){const _0x2b5a2b=_0xd24516;_0x39663d[_0x2b5a2b(0x144)](path[_0x2b5a2b(0x1db)](__dirname,bbpath2,_0x2b5a2b(0x122),'index.html'));}),app[_0xd24516(0x138)](_0xd24516(0x1ad),(_0x44117a,_0x18b7b6)=>{const _0x1596f2=_0xd24516;_0x18b7b6['sendFile'](path[_0x1596f2(0x1db)](__dirname,bbpath2,'build',_0x1596f2(0xf4)));}),app[_0xd24516(0x138)](_0xd24516(0x187),(_0x53a8ff,_0x3057d0)=>{const _0x278db4=_0xd24516;_0x3057d0[_0x278db4(0x144)](path['join'](__dirname,bbpath2,_0x278db4(0x122),_0x278db4(0xf4)));}),app[_0xd24516(0x138)]('/:bot/coins',(_0x48ea69,_0x47d59d)=>{const _0x306d09=_0xd24516;_0x47d59d[_0x306d09(0x144)](path['join'](__dirname,bbpath2,_0x306d09(0x122),_0x306d09(0xf4)));}),app[_0xd24516(0x138)](_0xd24516(0x18c),(_0x33d338,_0x5a3911)=>{const _0x1191c0=_0xd24516;_0x5a3911[_0x1191c0(0x144)](path['join'](__dirname,bbpath2,_0x1191c0(0x122),'index.html'));}),app[_0xd24516(0x138)](_0xd24516(0x131),(_0x3e7ff3,_0x4949d6)=>{const _0x569265=_0xd24516;_0x4949d6[_0x569265(0x144)](path[_0x569265(0x1db)](__dirname,bbpath2,_0x569265(0x122),'index.html'));}),app[_0xd24516(0x138)](_0xd24516(0x145),(_0x5eee2f,_0x6a3c14)=>{const _0x1337d8=_0xd24516;_0x6a3c14[_0x1337d8(0x144)](path[_0x1337d8(0x1db)](__dirname,bbpath2,_0x1337d8(0x122),'index.html'));});if(HOST)http[_0xd24516(0x1df)](PORT,HOST);else http[_0xd24516(0x1df)](PORT);const io=require(_0xd24516(0x104))(http,{}),analytics=Analytics({'app':'Balance\x20Bot','plugins':[googleAnalyticsV3Plugin({'trackingId':'UA-192771731-1'})]}),TelegramBot=require(_0xd24516(0x1ae));let tgBot;if(settings[_0xd24516(0xa6)]&&settings['telegramToken']!=''&&settings['telegramUsername']&&settings[_0xd24516(0x1b1)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x3d4432=_0xd24516;console[_0x3d4432(0x110)](''),console[_0x3d4432(0x110)](_0x3d4432(0x1b4)),logging(_0x3d4432(0x1cb)+PORT),console[_0x3d4432(0x110)]('-----------------------------------------------------------------------------------');if(config[_0x3d4432(0x1cd)]!=0x0)config['forEach'](_0x24d659=>{const _0x306af0=_0x3d4432;if(_0x24d659[_0x306af0(0xdd)]=='enabled'||_0x24d659[_0x306af0(0xdd)]==_0x306af0(0x107))logging(_0x306af0(0x1bf)+_0x24d659[_0x306af0(0xc5)]+'\x20|\x20'+_0x24d659[_0x306af0(0xb1)]),startBot([_0x24d659['botID'],userID],{'cwd':bbpath},function(_0x57a7a7){if(_0x57a7a7)logging(_0x57a7a7);});else(_0x24d659['status']==_0x306af0(0x127)||_0x24d659[_0x306af0(0xdd)]==_0x306af0(0x8b))&&logging(_0x306af0(0xf0)+_0x24d659['botID']+'\x20|\x20'+_0x24d659[_0x306af0(0xb1)]);});else!newBot&&console[_0x3d4432(0x110)](_0x3d4432(0x128));if(newBot)addBot();console['log'](_0x3d4432(0x1b4)),console[_0x3d4432(0x110)]('');}function startSocket(){const _0x274430=_0xd24516;io['on'](_0x274430(0x136),_0x265d21=>{const _0x492a3a=_0x274430;let _0x5e16cd,_0x50a1f2,_0x561e1c,_0x5bc4c3,_0xcc63bb;const _0x43c43c=_0x265d21[_0x492a3a(0x14f)]['headers']['referer'];_0x50a1f2=_0x43c43c[_0x492a3a(0x166)](/bot[0-9]{3}/);if(_0x50a1f2)_0x561e1c=_0x50a1f2[0x0][_0x492a3a(0x166)](/[0-9]{3}/);if(_0x561e1c)_0x5e16cd=_0x561e1c[0x0];else _0x5e16cd=_0x492a3a(0x1c9);const _0x2277f6=_0x265d21[_0x492a3a(0x14f)][_0x492a3a(0x163)][_0x492a3a(0xe9)];if(!_0x2277f6)_0x265d21['emit'](_0x492a3a(0xdd),{'publicKey':secure[_0x492a3a(0x1e1)]});else{_0x5bc4c3=timelyDecrypt(_0x2277f6,![]);if(!_0x5bc4c3)_0x265d21[_0x492a3a(0xe3)]('status',{'publicKey':secure[_0x492a3a(0x1e1)]});else{_0xcc63bb=normalizeIP(_0x265d21[_0x492a3a(0x97)][_0x492a3a(0x12a)])[_0x492a3a(0x1c4)];if(!devices[_0x5bc4c3])devices[_0x5bc4c3]={'uuid':_0x5bc4c3,'access':{'token':null}};devices[_0x5bc4c3]['ip']=_0xcc63bb;const _0x2703d1=addClient(_0x265d21['id'],_0x5bc4c3,_0x5e16cd);setAccess(_0x2703d1),_0x265d21['on'](_0x492a3a(0xef),_0x4c4ed9=>{const _0x40c448=_0x492a3a,_0x31b2b1=timelyDecrypt(_0x4c4ed9[_0x40c448(0x19f)]);if(_0x31b2b1){_0x4c4ed9={'username':_0x4c4ed9['username'],'password':_0x31b2b1},devices[_0x5bc4c3][_0x40c448(0x93)]=validateCredentials(_0x4c4ed9,_0x5bc4c3);if(devices[_0x5bc4c3][_0x40c448(0x93)][_0x40c448(0x13d)]==![]&&devices[_0x5bc4c3][_0x40c448(0x93)]['reason']==_0x40c448(0x90))_0x265d21[_0x40c448(0xe3)](_0x40c448(0xdd),{'access':devices[_0x5bc4c3][_0x40c448(0x93)]}),loginAccess2FA(_0x5bc4c3,_0xcc63bb);else{if(devices[_0x5bc4c3]['access'][_0x40c448(0x13d)]==![]&&devices[_0x5bc4c3][_0x40c448(0x93)][_0x40c448(0x12d)]==_0x40c448(0x1d5))_0x265d21['emit'](_0x40c448(0xdd),{'access':devices[_0x5bc4c3]['access']});else devices[_0x5bc4c3]['access'][_0x40c448(0x13d)]&&devices[_0x5bc4c3][_0x40c448(0x93)][_0x40c448(0x12d)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x5bc4c3)[_0x40c448(0x1c6)](_0x5879f9=>{setAccess(_0x5879f9);}),setTokenRefresh(_0x5bc4c3),setSessionTimeout(_0x40c448(0xef),_0x5bc4c3));}}else logging(_0x40c448(0xe6));}),_0x265d21['on'](_0x492a3a(0x199),()=>{resetPassword();}),_0x265d21['on']('disconnect',_0x148d80=>{removeClient(_0x265d21['id']);});}}});}function initClient(_0x9df2f){const _0x83de78=_0xd24516;if(_0x9df2f!=_0x83de78(0x1c9)&&config[_0x83de78(0x1d0)]!=''){if(pid[_0x9df2f])pid[_0x9df2f][_0x83de78(0xcd)]({'function':_0x83de78(0x16d),'args':null});}}function getSocket(_0x1a5a94){const _0x4646e7=_0xd24516;return io[_0x4646e7(0x109)][_0x4646e7(0x109)][_0x4646e7(0x138)](_0x1a5a94);}function setAccess(_0x36b871){const _0x159616=_0xd24516,_0x2bf203=getSocket(_0x36b871['id']),_0x148a69=_0x36b871['uuid'],_0x572b2f=_0x36b871[_0x159616(0x183)];devices[_0x148a69][_0x159616(0x93)]=validateAccess(devices[_0x148a69][_0x159616(0x93)]['token'],_0x148a69),_0x2bf203['join'](_0x148a69);if(devices[_0x148a69]['access'][_0x159616(0x13d)]){_0x2bf203[_0x159616(0x1db)](_0x572b2f);if(_0x572b2f=='botmanager')initializeSocketBotManager(_0x2bf203);else initializeSocketBot(_0x2bf203);initClient(_0x572b2f);}devices[_0x148a69][_0x159616(0x93)][_0x159616(0x1a2)]&&devices[_0x148a69][_0x159616(0x93)]['reason']=='temporary\x20token\x20generated'&&setSessionTimeout(_0x159616(0x153),_0x148a69),devices[_0x148a69][_0x159616(0x93)][_0x159616(0x1a2)]&&devices[_0x148a69][_0x159616(0x93)]['reason']==_0x159616(0x133)&&setSessionTimeout(_0x159616(0xef),_0x148a69),_0x2bf203[_0x159616(0xe3)](_0x159616(0xdd),{'status':_0x36b871[_0x159616(0x1bd)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x148a69][_0x159616(0x93)],'externalip':devices[_0x148a69]['ip'],'publicKey':secure[_0x159616(0x1e1)],'validInstallation':validInstallation}),devices[_0x148a69][_0x159616(0x93)]['allow']==![]&&devices[_0x148a69][_0x159616(0x93)][_0x159616(0x12d)]==_0x159616(0x10c)&&temporaryAccess2FA(_0x148a69,devices[_0x148a69]['ip']);}function setSessionTimeout(_0x19790f,_0x138a1d){const _0x123e4a=_0xd24516;let _0x35112a;if(_0x19790f=='login')_0x35112a=loginExpiry*0x3c*0x3e8;else _0x35112a=devices[_0x138a1d][_0x123e4a(0x1d8)][_0x123e4a(0xd5)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x138a1d][_0x123e4a(0x1d8)]['timestamp']);if(devices[_0x138a1d][_0x123e4a(0x1c8)])clearTimeout(devices[_0x138a1d]['pidExpireLogin']);devices[_0x138a1d][_0x123e4a(0x1c8)]=setTimeout(()=>{const _0x9080a9=_0x123e4a;if(devices[_0x138a1d][_0x9080a9(0x1be)])clearTimeout(devices[_0x138a1d][_0x9080a9(0x1be)]);removeSocketListeners(_0x138a1d),addBlacklist(_0x138a1d),devices[_0x138a1d][_0x9080a9(0x1d8)]=null,devices[_0x138a1d][_0x9080a9(0xad)]=null,devices[_0x138a1d]['access'][_0x9080a9(0x1a2)]=null,devices[_0x138a1d]['access']=validateAccess(devices[_0x138a1d][_0x9080a9(0x93)][_0x9080a9(0x1a2)],_0x138a1d),!(devices[_0x138a1d][_0x9080a9(0x93)][_0x9080a9(0x13d)]&&devices[_0x138a1d][_0x9080a9(0x93)][_0x9080a9(0x12d)]=='login\x20not\x20required')&&(_0x19790f==_0x9080a9(0xef)?io['to'](_0x138a1d)[_0x9080a9(0xe3)](_0x9080a9(0xdd),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x138a1d)['emit'](_0x9080a9(0xdd),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x138a1d]['access'][_0x9080a9(0x1a2)]=null;},_0x35112a);}function setTokenRefresh(_0x552c80){const _0x4bb006=_0xd24516;if(devices[_0x552c80][_0x4bb006(0x1be)])clearTimeout(devices[_0x552c80][_0x4bb006(0x1be)]);devices[_0x552c80][_0x4bb006(0x1be)]=setTimeout(()=>{const _0x6e71cc=_0x4bb006;getClientsWithUuid(_0x552c80)[_0x6e71cc(0x1cd)]!=0x0?(devices[_0x552c80][_0x6e71cc(0x93)]=refreshToken(_0x552c80),io['to'](_0x552c80)[_0x6e71cc(0xe3)](_0x6e71cc(0xdd),{'status':_0x6e71cc(0x147),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x552c80]['access'],'externalip':devices[_0x552c80]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x552c80)):clearTimeout(devices[_0x552c80][_0x6e71cc(0x1be)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3f7645){const _0x5902da=_0xd24516,_0x35045a=getClient(_0x3f7645['id'])[_0x5902da(0xc3)];_0x3f7645[_0x5902da(0xe3)](_0x5902da(0x1c2),config),_0x3f7645[_0x5902da(0xe3)](_0x5902da(0x15c),cleanSettings()),_0x3f7645['on'](_0x5902da(0x92),_0x448aff=>{const _0x83a459=_0x5902da;if(validateAccess(_0x448aff,_0x35045a)[_0x83a459(0x13d)])addBot();else logging('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x3f7645['on'](_0x5902da(0xfe),(_0x4723eb,_0x36bd26)=>{const _0x18edfd=_0x5902da;if(validateAccess(_0x36bd26,_0x35045a)['allow'])toggleBot(_0x4723eb[_0x18edfd(0xc5)],_0x4723eb[_0x18edfd(0xdd)],_0x4723eb[_0x18edfd(0x189)]);else logging('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x3f7645['on'](_0x5902da(0xe7),(_0x3f8435,_0x401d48)=>{const _0xd2bb00=_0x5902da;if(validateAccess(_0x401d48,_0x35045a)[_0xd2bb00(0x13d)])toggleBotMode(_0x3f8435);else logging(_0xd2bb00(0x157));}),_0x3f7645['on'](_0x5902da(0x167),(_0x25d6e3,_0x3f9e40)=>{const _0x9dd1e4=_0x5902da;if(validateAccess(_0x3f9e40,_0x35045a)[_0x9dd1e4(0x13d)])deleteBot(_0x25d6e3);else logging(_0x9dd1e4(0x1d9));}),_0x3f7645['on'](_0x5902da(0x17b),(_0x4852ab,_0x29274f)=>{const _0x3b33a9=_0x5902da;if(validateAccess(_0x29274f,_0x35045a)[_0x3b33a9(0x13d)])storeSettings(_0x4852ab,!![]);else logging(_0x3b33a9(0x114));}),_0x3f7645['on']('update-bb',_0xfa2905=>{const _0x51e425=_0x5902da;if(validateAccess(_0xfa2905,_0x35045a)[_0x51e425(0x13d)])updateBB();else logging(_0x51e425(0x195));}),_0x3f7645['on']('logout',_0xe46c2b=>{const _0x581962=_0x5902da;if(validateAccess(_0xe46c2b,_0x35045a)[_0x581962(0x13d)]){if(devices[_0x35045a][_0x581962(0x1be)])clearTimeout(devices[_0x35045a][_0x581962(0x1be)]);if(devices[_0x35045a][_0x581962(0x1c8)])clearTimeout(devices[_0x35045a]['pidExpireLogin']);removeSocketListeners(getClient(_0x3f7645['id'])[_0x581962(0xc3)]),addBlacklist(_0x35045a),devices[_0x35045a]['telegramIpApproval']=null,devices[_0x35045a][_0x581962(0xad)]=null,devices[_0x35045a]['access'][_0x581962(0x1a2)]=null,io['to'](getClient(_0x3f7645['id'])[_0x581962(0xc3)])['emit']('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0x581962(0xf8));});}function initializeSocketBot(_0x5782d7){const _0x427385=_0xd24516,_0x2d5b13=getClient(_0x5782d7['id'])['bot'],_0x87995f=getClient(_0x5782d7['id'])[_0x427385(0xc3)];_0x5782d7['on'](_0x427385(0x1a7),(_0x3a372f,_0x3665bc)=>{const _0x180e57=_0x427385;if(validateAccess(_0x3665bc,_0x87995f)[_0x180e57(0x13d)]){if(pid[_0x2d5b13])pid[_0x2d5b13][_0x180e57(0xcd)]({'function':_0x180e57(0xfc),'args':_0x3a372f});}else logging(_0x180e57(0xfb));}),_0x5782d7['on'](_0x427385(0x170),(_0x5abfe5,_0x251acd)=>{const _0x5b51bd=_0x427385;if(validateAccess(_0x251acd,_0x87995f)[_0x5b51bd(0x13d)]){if(pid[_0x2d5b13])pid[_0x2d5b13][_0x5b51bd(0xcd)]({'function':_0x5b51bd(0x98),'args':_0x5abfe5});}else logging('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x5782d7['on'](_0x427385(0x9b),(_0x1a5284,_0x191f94)=>{const _0x1b201=_0x427385;if(validateAccess(_0x191f94,_0x87995f)[_0x1b201(0x13d)]){if(pid[_0x2d5b13])pid[_0x2d5b13]['send']({'function':_0x1b201(0xa3),'args':_0x1a5284});}else logging(_0x1b201(0xe2));}),_0x5782d7['on'](_0x427385(0x129),(_0x47f702,_0x23eee7)=>{const _0xbfc335=_0x427385;if(validateAccess(_0x23eee7,_0x87995f)[_0xbfc335(0x13d)]){if(pid[_0x2d5b13])pid[_0x2d5b13][_0xbfc335(0xcd)]({'function':_0xbfc335(0x1a5),'args':_0x47f702});}else logging(_0xbfc335(0xce));}),_0x5782d7['on'](_0x427385(0x192),(_0x5f7a18,_0x7d8c92)=>{const _0x5b5ca6=_0x427385;if(validateAccess(_0x7d8c92,_0x87995f)[_0x5b5ca6(0x13d)]){if(pid[_0x2d5b13])pid[_0x2d5b13]['send']({'function':_0x5b5ca6(0xc0),'args':_0x5f7a18});}else logging(_0x5b5ca6(0x118));}),_0x5782d7['on']('get-starting-balances',_0x145cd1=>{const _0x41c1a4=_0x427385;if(validateAccess(_0x145cd1,_0x87995f)['allow']){if(pid[_0x2d5b13])pid[_0x2d5b13][_0x41c1a4(0xcd)]({'function':_0x41c1a4(0xac),'args':null});}else logging(_0x41c1a4(0x1d7));}),_0x5782d7['on']('place-order',(_0x3465c4,_0x510eb1)=>{const _0x3099c0=_0x427385;if(validateAccess(_0x510eb1,_0x87995f)[_0x3099c0(0x13d)]){if(pid[_0x2d5b13])pid[_0x2d5b13][_0x3099c0(0xcd)]({'function':_0x3099c0(0x16e),'args':_0x3465c4});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x5782d7['on'](_0x427385(0xda),_0x50c683=>{const _0x229a15=_0x427385;if(validateAccess(_0x50c683,_0x87995f)[_0x229a15(0x13d)]){if(pid[_0x2d5b13])pid[_0x2d5b13]['send']({'function':_0x229a15(0x1ab),'args':null});}else logging(_0x229a15(0x160));}),_0x5782d7['on']('logout',_0xe292a8=>{const _0x2852ae=_0x427385;if(validateAccess(_0xe292a8,_0x87995f)[_0x2852ae(0x13d)]){if(devices[_0x87995f]['pidRefreshToken'])clearTimeout(devices[_0x87995f][_0x2852ae(0x1be)]);if(devices[_0x87995f][_0x2852ae(0x1c8)])clearTimeout(devices[_0x87995f][_0x2852ae(0x1c8)]);removeSocketListeners(getClient(_0x5782d7['id'])[_0x2852ae(0xc3)]),addBlacklist(_0x87995f),devices[_0x87995f][_0x2852ae(0x1d8)]=null,devices[_0x87995f][_0x2852ae(0xad)]=null,devices[_0x87995f][_0x2852ae(0x93)][_0x2852ae(0x1a2)]=null,io['to'](getClient(_0x5782d7['id'])[_0x2852ae(0xc3)])[_0x2852ae(0xe3)](_0x2852ae(0xdd),{'access':{'allow':![],'reason':_0x2852ae(0x11c),'token':null}});}else logging(_0x2852ae(0xf8));});}function removeSocketListeners(_0x4a2107){getClientsWithUuid(_0x4a2107)['forEach'](_0x735aa4=>{getSocket(_0x735aa4['id'])['removeAllListeners']();});}function cleanSettings(){const _0x5f2aa8=_0xd24516;let _0x5478e3=settings;return settings[_0x5f2aa8(0xa6)]&&settings[_0x5f2aa8(0xa6)]!=''&&(_0x5478e3={..._0x5478e3,'telegramToken':'************'}),settings[_0x5f2aa8(0x1a9)]&&settings[_0x5f2aa8(0x1a9)]!=''&&(_0x5478e3={..._0x5478e3,'bbPassword':'************'}),_0x5478e3;}function updateBB(){const _0x52bc95=_0xd24516;installingUpdate=!![],config['forEach'](_0x44406b=>{const _0x55a63b=_0x460b;restartBot(_0x44406b[_0x55a63b(0xc5)]);}),process[_0x52bc95(0xcd)]({'update':!![]},_0x1b6ecc=>{});}function startBot(_0x1b9347,_0x8923e0,_0xe86759){const _0x4b295e=_0xd24516;let _0x475d65=![];const _0x4ab774=_0x1b9347[0x0];_0x8923e0={..._0x8923e0,'stdio':[_0x4b295e(0x1a1),_0x4b295e(0x1a1),_0x4b295e(0x1a1),_0x4b295e(0x1dd)]},pid[_0x4ab774]=childProcess['fork'](botfile,_0x1b9347,_0x8923e0),pid[_0x4ab774]['on'](_0x4b295e(0x161),_0x190d9d=>{const _0x2a46ac=_0x4b295e;switch(Object[_0x2a46ac(0x83)](_0x190d9d)[0x0]){case _0x2a46ac(0xb1):updateBotName(_0x4ab774,_0x190d9d[_0x2a46ac(0xb1)]);break;case _0x2a46ac(0xd9):updateBotManager();break;case _0x2a46ac(0xdd):updateStatus(_0x4ab774,_0x190d9d[_0x2a46ac(0xdd)]);break;case _0x2a46ac(0x189):updateLive(_0x4ab774,_0x190d9d['live']);break;case'started':updateLive(_0x4ab774,_0x190d9d[_0x2a46ac(0x142)]),io['to'](_0x4ab774)[_0x2a46ac(0xe3)](_0x2a46ac(0xdd),{'access':{'allow':![],'reason':_0x2a46ac(0x84),'token':null}});break;case _0x2a46ac(0x1e2):_0x190d9d[_0x2a46ac(0x1e2)]=='restart'&&restartBot(_0x4ab774);_0x190d9d['stop']==_0x2a46ac(0x176)&&toggleBot(_0x4ab774,_0x2a46ac(0x127),_0x2a46ac(0x9f));break;case _0x2a46ac(0x173):sendTelegram(_0x4ab774,_0x190d9d[_0x2a46ac(0x173)]);break;case _0x2a46ac(0x14b):sendTelegramMsg(_0x190d9d[_0x2a46ac(0x14b)]);break;case _0x2a46ac(0x1b6):io['to'](_0x4ab774)[_0x2a46ac(0xe3)](_0x190d9d[_0x2a46ac(0x1b6)],_0x190d9d['args']);break;}}),pid[_0x4ab774]['on'](_0x4b295e(0x172),function(_0x2482ac){if(_0x475d65)return;_0x475d65=!![],_0xe86759(_0x2482ac);}),pid[_0x4ab774]['on'](_0x4b295e(0xa7),function(_0x1189c1){const _0x618e5a=_0x4b295e;if(installingUpdate)return;if(_0x475d65)return;_0x475d65=!![],_0xe86759(null);const _0x23b443=dbConfig[_0x618e5a(0x138)]('bots')['find']({'botID':_0x4ab774})[_0x618e5a(0xf9)]();_0x23b443&&(_0x23b443[_0x618e5a(0xdd)]==_0x618e5a(0x16c)||_0x23b443[_0x618e5a(0xdd)]==_0x618e5a(0x107))&&(updateLive(_0x4ab774,_0x618e5a(0x9f)),logging(_0x618e5a(0x1a6)+_0x4ab774),startBot([_0x4ab774,userID],{'cwd':bbpath},function(_0xb632f5){if(_0xb632f5)logging(_0xb632f5);}));});}function stopBot(_0x480de9){const _0x1e42df=_0xd24516;getClientsWithBotID(_0x480de9)['forEach'](_0x3f471b=>{const _0x14f480=_0x460b;getSocket(_0x3f471b['id'])[_0x14f480(0x1a4)](!![]),removeClient(_0x3f471b['id']);}),pid[_0x480de9]&&(pid[_0x480de9][_0x1e42df(0x176)](),pid[_0x480de9]=null);}function restartBot(_0x575c60){if(pid[_0x575c60])pid[_0x575c60]['kill']();}function addBot(){const _0x321933=_0xd24516;let _0x497da0;for(let _0x1b97de=0x1;_0x1b97de<0x3e9;_0x1b97de++){_0x497da0=_0x1b97de[_0x321933(0x1cc)]()['padStart'](0x3,'0');let _0x546538=config[_0x321933(0x165)](_0x1a99e1=>_0x1a99e1['botID']==_0x497da0);if(!_0x546538)break;}if(_0x497da0===_0x321933(0x1c1)){logging('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logging(_0x321933(0x171)+_0x497da0),dbConfig['get']('bots')[_0x321933(0x10a)]({'botID':_0x497da0,'botname':_0x321933(0xf3)+_0x497da0,'status':_0x321933(0x107),'live':''})[_0x321933(0xaf)](),startBot([_0x497da0,userID],{'cwd':bbpath},function(_0x4a3dc4){if(_0x4a3dc4)logging(_0x4a3dc4);}),config=getConfiguration(),io['to']('botmanager')[_0x321933(0xe3)](_0x321933(0x1c2),config);}function deleteBot(_0x436e55){const _0x2410fb=_0xd24516;getClientsWithBotID(_0x436e55)[_0x2410fb(0x1c6)](_0x54d3ab=>{getSocket(_0x54d3ab['id'])['disconnect'](!![]),removeClient(_0x54d3ab['id']);}),dbConfig['get'](_0x2410fb(0x1c2))[_0x2410fb(0x1c7)]({'botID':_0x436e55})[_0x2410fb(0xaf)](),logging(_0x2410fb(0x1d6)+_0x436e55),stopBot(_0x436e55);try{fs['unlinkSync'](path[_0x2410fb(0x1db)](configpath,'bot-'+_0x436e55+'-config.json')),fs[_0x2410fb(0x193)](path['join'](configpath,_0x2410fb(0x18b)+_0x436e55+_0x2410fb(0x10f))),fs[_0x2410fb(0x193)](path[_0x2410fb(0x1db)](configpath,_0x2410fb(0x18b)+_0x436e55+_0x2410fb(0x14d))),fs[_0x2410fb(0x193)](path[_0x2410fb(0x1db)](configpath,_0x2410fb(0x18b)+_0x436e55+_0x2410fb(0x140)));}catch(_0x11fc65){if(_0x11fc65)logging(_0x2410fb(0xee),_0x11fc65);}config=getConfiguration(),io['to'](_0x2410fb(0x1c9))[_0x2410fb(0xe3)](_0x2410fb(0x1c2),config);}function toggleBot(_0x28c81c,_0x323073,_0x5b6feb){const _0x6cb32a=_0xd24516;dbConfig[_0x6cb32a(0x138)](_0x6cb32a(0x1c2))['find']({'botID':_0x28c81c})[_0x6cb32a(0x17d)]({'status':_0x323073})['assign']({'live':_0x5b6feb})[_0x6cb32a(0xaf)]();if(_0x323073==_0x6cb32a(0x16c)||_0x323073==_0x6cb32a(0x107))logging(_0x6cb32a(0xdf)+_0x28c81c),startBot([_0x28c81c,userID],{'cwd':bbpath},function(_0x54a03c){if(_0x54a03c)logging(_0x54a03c);});else(_0x323073=='disabled'||_0x323073==_0x6cb32a(0x8b))&&(logging('disabled\x20Bot\x20'+_0x28c81c),stopBot(_0x28c81c));config=getConfiguration(),io['to'](_0x6cb32a(0x1c9))[_0x6cb32a(0xe3)](_0x6cb32a(0x1c2),config);}function toggleStatus(_0x3872ca){const _0x3cc191=_0xd24516;let _0x1e5028=dbConfig[_0x3cc191(0x138)](_0x3cc191(0x1c2))[_0x3cc191(0x165)]({'botID':_0x3872ca})[_0x3cc191(0xf9)](),_0x5c4afa;if(_0x1e5028[_0x3cc191(0xdd)]===_0x3cc191(0x16c))_0x5c4afa=_0x3cc191(0x127);else{if(_0x1e5028[_0x3cc191(0xdd)]===_0x3cc191(0x107))_0x5c4afa='new-disabled';else{if(_0x1e5028['status']===_0x3cc191(0x8b))_0x5c4afa='new';else{if(_0x1e5028[_0x3cc191(0xdd)]==='disabled')_0x5c4afa=_0x3cc191(0x16c);}}}return _0x5c4afa;}function updateStatus(_0x11baee,_0x41d3b5){const _0x7edba=_0xd24516;dbConfig[_0x7edba(0x138)](_0x7edba(0x1c2))[_0x7edba(0x165)]({'botID':_0x11baee})[_0x7edba(0x17d)]({'status':_0x41d3b5})[_0x7edba(0xaf)](),config=getConfiguration(),io['to'](_0x7edba(0x1c9))[_0x7edba(0xe3)]('bots',config);}function updateLive(_0x1b58ee,_0x25daa1){const _0x8fff80=_0xd24516;dbConfig[_0x8fff80(0x138)](_0x8fff80(0x1c2))[_0x8fff80(0x165)]({'botID':_0x1b58ee})[_0x8fff80(0x17d)]({'live':_0x25daa1})[_0x8fff80(0xaf)](),config=getConfiguration(),io['to'](_0x8fff80(0x1c9))[_0x8fff80(0xe3)]('bots',config);}function updateBotName(_0x5ab23b,_0x214db6){const _0x14f7c6=_0xd24516;dbConfig[_0x14f7c6(0x138)]('bots')[_0x14f7c6(0x165)]({'botID':_0x5ab23b})[_0x14f7c6(0x17d)]({'botname':_0x214db6})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x14f7c6(0xe3)](_0x14f7c6(0x1c2),config);}function updateBotManager(){const _0x3613b3=_0xd24516;config=getConfiguration(),io['to'](_0x3613b3(0x1c9))['emit'](_0x3613b3(0x1c2),config);}function toggleBotMode(_0x3bfa2e){const _0x43592b=_0xd24516;if(pid[_0x3bfa2e])pid[_0x3bfa2e][_0x43592b(0xcd)]({'function':_0x43592b(0x1a0),'args':null});else{const _0xe5095d=configpath+_0x43592b(0x18b)+_0x3bfa2e+_0x43592b(0xde),_0xbd000a=fs[_0x43592b(0xa0)](_0xe5095d),_0x5b1350=JSON[_0x43592b(0x191)](_0xbd000a),_0x5d2e57=_0x5b1350[_0x43592b(0x183)][0x0][_0x43592b(0x17a)];_0x5b1350['bot'][0x0][_0x43592b(0x17a)]=!_0x5d2e57;const _0x62be2f=JSON[_0x43592b(0x198)](_0x5b1350,null,0x2);fs[_0x43592b(0x10d)](_0xe5095d,_0x62be2f),config=getConfiguration(),io['to'](_0x43592b(0x1c9))[_0x43592b(0xe3)](_0x43592b(0x1c2),config);}}function telegramError(_0x11fd59){const _0x50ece6=_0xd24516;console[_0x50ece6(0x110)](getTimeStamp()+_0x50ece6(0x154));}function validateTelegram(_0x4dded9){const _0x580aea=_0xd24516;if(_0x4dded9[_0x580aea(0x9c)][_0x580aea(0x1c3)]!=settings[_0x580aea(0x1b1)]&&'@'+_0x4dded9[_0x580aea(0x9c)][_0x580aea(0x1c3)]!=settings['telegramUsername'])return tgBot[_0x580aea(0xb5)](_0x4dded9['chat']['id'],_0x580aea(0x1d3),{'parse_mode':_0x580aea(0x1b7)})[_0x580aea(0x11a)](_0x8ccdfe=>{telegramError(_0x8ccdfe);}),![];return!![];}async function initTelegram(){const _0xc890ab=_0xd24516;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0xc890ab(0xa6)],{'polling':!![]});let _0xd885ff=_0xc890ab(0x1d4);_0xd885ff+='\x0a',_0xd885ff+=_0xc890ab(0xd3),_0xd885ff+=_0xc890ab(0x9d),_0xd885ff+=_0xc890ab(0x13a),_0xd885ff+=_0xc890ab(0x17e),_0xd885ff+=_0xc890ab(0x126),_0xd885ff+='/off\x20-\x20stop\x20bot(s)\x0a',_0xd885ff+=_0xc890ab(0xfd),_0xd885ff+='/names\x20-\x20show\x20bot\x20names\x0a',_0xd885ff+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0xd885ff+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0xd885ff+=_0xc890ab(0x123);let _0x502553='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x502553+='\x0a',_0x502553+=_0xd885ff,tgBot[_0xc890ab(0xdb)](/\/start/,_0x52cb9e=>{const _0x4128b0=_0xc890ab;if(!validateTelegram(_0x52cb9e))return;if(settings[_0x4128b0(0x11f)]!=_0x52cb9e['chat']['id'])updateSetting(_0x4128b0(0x11f),_0x52cb9e[_0x4128b0(0x13f)]['id']);updateSetting(_0x4128b0(0xcc),!![]),tgBot[_0x4128b0(0xb5)](_0x52cb9e['chat']['id'],_0x502553)['catch'](_0x5c4922=>{telegramError(_0x5c4922);});}),tgBot[_0xc890ab(0xdb)](/\/enable/,_0x414185=>{const _0x320c04=_0xc890ab;if(!validateTelegram(_0x414185))return;if(settings[_0x320c04(0x11f)]!=_0x414185[_0x320c04(0x13f)]['id'])updateSetting(_0x320c04(0x11f),_0x414185[_0x320c04(0x13f)]['id']);updateSetting(_0x320c04(0xcc),!![]),tgBot['sendMessage'](_0x414185[_0x320c04(0x13f)]['id'],_0x320c04(0x174))[_0x320c04(0x11a)](_0x44a64a=>{telegramError(_0x44a64a);});}),tgBot[_0xc890ab(0xdb)](/\/config/,async _0xaa20c0=>{const _0x35c440=_0xc890ab;if(!validateTelegram(_0xaa20c0))return;tgBot[_0x35c440(0x196)]('callback_query'),tgBot[_0x35c440(0xb5)](_0xaa20c0['chat']['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x35c440(0x11e),'callback_data':_0x35c440(0xbd)},{'text':'Alerts','callback_data':'alerts'},{'text':_0x35c440(0x99),'callback_data':_0x35c440(0x194)}]]}})[_0x35c440(0x11a)](_0x5d3638=>{telegramError(_0x5d3638);}),tgBot['on'](_0x35c440(0x169),async _0xc615a7=>{const _0x2682f0=_0x35c440,_0x528fdf=_0xc615a7[_0x2682f0(0x87)],_0x16636b=_0xc615a7[_0x2682f0(0x161)];tgBot[_0x2682f0(0x18a)](_0xc615a7['id'])['then'](async()=>{const _0x22f35d=_0x2682f0;_0x528fdf==_0x22f35d(0xbd)&&(updateSetting(_0x22f35d(0xa9),_0x22f35d(0xbd)),updateSetting(_0x22f35d(0xcc),!![]),await tgBot[_0x22f35d(0xb5)](_0x16636b['chat']['id'],_0x22f35d(0x162))[_0x22f35d(0x11a)](_0x341d7c=>{telegramError(_0x341d7c);}));_0x528fdf==_0x22f35d(0x141)&&(updateSetting(_0x22f35d(0xa9),_0x22f35d(0x141)),updateSetting('telegramEnabled',!![]),await tgBot[_0x22f35d(0xb5)](_0x16636b['chat']['id'],_0x22f35d(0x12e))[_0x22f35d(0x11a)](_0x3b3f37=>{telegramError(_0x3b3f37);}));_0x528fdf=='all'&&(updateSetting(_0x22f35d(0xa9),_0x22f35d(0x194)),updateSetting(_0x22f35d(0xcc),!![]),await tgBot[_0x22f35d(0xb5)](_0x16636b[_0x22f35d(0x13f)]['id'],_0x22f35d(0xfa))[_0x22f35d(0x11a)](_0x18d064=>{telegramError(_0x18d064);}));if(!settings[_0x22f35d(0x11f)])tgBot[_0x22f35d(0xb5)](_0x16636b[_0x22f35d(0x13f)]['id'],_0x22f35d(0x91))[_0x22f35d(0x11a)](_0xe67716=>{telegramError(_0xe67716);});}),tgBot[_0x2682f0(0x196)]('callback_query');});}),tgBot[_0xc890ab(0xdb)](/\/status/,_0x13bf44=>{const _0x516afd=_0xc890ab;if(!validateTelegram(_0x13bf44))return;const _0x384dfb=getBotsWithMode();let _0x3e7807='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x516afd(0x1c6)](_0x36111f=>{const _0x32efef=_0x516afd,_0x4ef51f=_0x384dfb[_0x32efef(0x165)](_0x46354d=>_0x46354d[_0x32efef(0xc5)]==_0x36111f[_0x32efef(0xc5)])[_0x32efef(0x100)];_0x3e7807+=_0x32efef(0xf3)+_0x36111f[_0x32efef(0xc5)]+':\x20'+_0x36111f['status']+_0x32efef(0x119)+_0x4ef51f+_0x32efef(0x119)+_0x36111f[_0x32efef(0x189)]+'\x0a';}),_0x3e7807+='\x0a',_0x3e7807+=_0x516afd(0x120),_0x3e7807+=!settings[_0x516afd(0xcc)]?'Notifications\x20disabled\x0a':_0x516afd(0xb9),_0x3e7807+=settings[_0x516afd(0xcc)]?settings[_0x516afd(0xa9)]==_0x516afd(0x194)?_0x516afd(0x85):_0x516afd(0x175)+settings[_0x516afd(0xa9)]+_0x516afd(0x19d):'',tgBot[_0x516afd(0xb5)](_0x13bf44[_0x516afd(0x13f)]['id'],_0x3e7807,{'parse_mode':'HTML'})[_0x516afd(0x11a)](_0x4eb65e=>{telegramError(_0x4eb65e);});}),tgBot[_0xc890ab(0xdb)](/\/restart/,_0x4dcfee=>{const _0x36315d=_0xc890ab;if(!validateTelegram(_0x4dcfee))return;tgBot[_0x36315d(0x196)](_0x36315d(0x169));const _0x58ef30=getEnabledBots();if(_0x58ef30['length']==0x0)tgBot[_0x36315d(0xb5)](_0x4dcfee[_0x36315d(0x13f)]['id'],_0x36315d(0x14c))[_0x36315d(0x11a)](_0x20ba83=>{telegramError(_0x20ba83);});else{if(_0x58ef30['length']>0x1)_0x58ef30['push']({'botID':_0x36315d(0x194)});let _0x174a98=[],_0xfd24b0=[];const _0x590b81=_0x58ef30[_0x36315d(0x1cd)]%0x4==0x0||_0x58ef30['length']%0x4==0x3||_0x58ef30[_0x36315d(0x1cd)]%0x3==0x1?0x4:0x3;let _0x1aedd0=0x0;_0x58ef30[_0x36315d(0x1c6)]((_0x2a51c9,_0x3b20c1)=>{const _0x5c4746=_0x36315d;if(_0x3b20c1%_0x590b81==0x0)_0xfd24b0=[];_0xfd24b0[_0x5c4746(0x10a)]({'text':_0x2a51c9[_0x5c4746(0xc5)]==_0x5c4746(0x194)?_0x5c4746(0x11b):_0x5c4746(0xf3)+_0x2a51c9['botID'],'callback_data':_0x2a51c9[_0x5c4746(0xc5)]}),_0x3b20c1%_0x590b81==0x0&&(_0x174a98[_0x1aedd0]=_0xfd24b0,_0x1aedd0++);}),tgBot[_0x36315d(0xb5)](_0x4dcfee[_0x36315d(0x13f)]['id'],_0x36315d(0x1da),{'reply_markup':{'inline_keyboard':_0x174a98}})[_0x36315d(0x11a)](_0x27f6d6=>{telegramError(_0x27f6d6);}),tgBot['on'](_0x36315d(0x169),async _0x13a6b6=>{const _0x2790a3=_0x36315d,_0x3f79f2=_0x13a6b6[_0x2790a3(0x87)],_0x5c3da2=_0x13a6b6['message'];tgBot[_0x2790a3(0x18a)](_0x13a6b6['id'])[_0x2790a3(0x14e)](async()=>{const _0x17c660=_0x2790a3;_0x3f79f2==_0x17c660(0x194)?(tgBot[_0x17c660(0xb5)](_0x5c3da2[_0x17c660(0x13f)]['id'],_0x17c660(0xa4))[_0x17c660(0x11a)](_0x5ee19f=>{telegramError(_0x5ee19f);}),config[_0x17c660(0x1c6)](_0x448bd9=>{const _0x218b88=_0x17c660;restartBot(_0x448bd9[_0x218b88(0xc5)]);})):(tgBot[_0x17c660(0xb5)](_0x5c3da2[_0x17c660(0x13f)]['id'],_0x17c660(0x9e)+_0x3f79f2)['catch'](_0x587f44=>{telegramError(_0x587f44);}),restartBot(_0x3f79f2));}),tgBot[_0x2790a3(0x196)]('callback_query');});}}),tgBot[_0xc890ab(0xdb)](/\/on/,_0x1f4f3a=>{const _0x3cfcca=_0xc890ab;if(!validateTelegram(_0x1f4f3a))return;tgBot[_0x3cfcca(0x196)](_0x3cfcca(0x169));const _0xddc3d1=getDisabledBots();if(_0xddc3d1['length']==0x0)tgBot[_0x3cfcca(0xb5)](_0x1f4f3a['chat']['id'],_0x3cfcca(0x1aa))['catch'](_0x48492a=>{telegramError(_0x48492a);});else{if(_0xddc3d1[_0x3cfcca(0x1cd)]>0x1)_0xddc3d1['push']({'botID':_0x3cfcca(0x194)});let _0x4df866=[],_0x3b4541=[];const _0x341c74=_0xddc3d1['length']%0x4==0x0||_0xddc3d1[_0x3cfcca(0x1cd)]%0x4==0x3||_0xddc3d1[_0x3cfcca(0x1cd)]%0x3==0x1?0x4:0x3;let _0x32f453=0x0;_0xddc3d1[_0x3cfcca(0x1c6)]((_0x1a262a,_0x2bb404)=>{const _0x4be61f=_0x3cfcca;if(_0x2bb404%_0x341c74==0x0)_0x3b4541=[];_0x3b4541['push']({'text':_0x1a262a[_0x4be61f(0xc5)]==_0x4be61f(0x194)?_0x4be61f(0x11b):'Bot\x20'+_0x1a262a[_0x4be61f(0xc5)],'callback_data':_0x1a262a[_0x4be61f(0xc5)]}),_0x2bb404%_0x341c74==0x0&&(_0x4df866[_0x32f453]=_0x3b4541,_0x32f453++);}),tgBot['sendMessage'](_0x1f4f3a[_0x3cfcca(0x13f)]['id'],_0x3cfcca(0xec),{'reply_markup':{'inline_keyboard':_0x4df866}})['catch'](_0x2f29b2=>{telegramError(_0x2f29b2);}),tgBot['on'](_0x3cfcca(0x169),async _0x467f31=>{const _0x455241=_0x3cfcca,_0x46e5a7=_0x467f31[_0x455241(0x87)],_0x148a10=_0x467f31[_0x455241(0x161)];tgBot['answerCallbackQuery'](_0x467f31['id'])[_0x455241(0x14e)](async()=>{const _0x1032b5=_0x455241;_0x46e5a7=='all'?(tgBot[_0x1032b5(0xb5)](_0x148a10['chat']['id'],_0x1032b5(0xe8))['catch'](_0xc10ffc=>{telegramError(_0xc10ffc);}),_0xddc3d1[_0x1032b5(0x1c6)](_0x4780a9=>{const _0xe7ef55=_0x1032b5;if(_0x4780a9[_0xe7ef55(0xc5)]!=_0xe7ef55(0x194))toggleBot(_0x4780a9['botID'],toggleStatus(_0x4780a9[_0xe7ef55(0xc5)]),_0xe7ef55(0x9f));})):(tgBot['sendMessage'](_0x148a10[_0x1032b5(0x13f)]['id'],_0x1032b5(0x1c5)+_0x46e5a7)['catch'](_0xc88806=>{telegramError(_0xc88806);}),toggleBot(_0x46e5a7,toggleStatus(_0x46e5a7),_0x1032b5(0x9f)));}),tgBot[_0x455241(0x196)]('callback_query');});}}),tgBot[_0xc890ab(0xdb)](/\/off/,_0x1fa77b=>{const _0x2eceaa=_0xc890ab;if(!validateTelegram(_0x1fa77b))return;tgBot['removeListener'](_0x2eceaa(0x169));const _0x168c3b=getEnabledBots();if(_0x168c3b[_0x2eceaa(0x1cd)]==0x0)tgBot['sendMessage'](_0x1fa77b[_0x2eceaa(0x13f)]['id'],_0x2eceaa(0x14c))[_0x2eceaa(0x11a)](_0x15ec40=>{telegramError(_0x15ec40);});else{if(_0x168c3b[_0x2eceaa(0x1cd)]>0x1)_0x168c3b['push']({'botID':_0x2eceaa(0x194)});let _0x152361=[],_0x49103c=[];const _0x22bc23=_0x168c3b['length']%0x4==0x0||_0x168c3b[_0x2eceaa(0x1cd)]%0x4==0x3||_0x168c3b[_0x2eceaa(0x1cd)]%0x3==0x1?0x4:0x3;let _0x8489d0=0x0;_0x168c3b[_0x2eceaa(0x1c6)]((_0x55518e,_0x5d669e)=>{const _0x446bda=_0x2eceaa;if(_0x5d669e%_0x22bc23==0x0)_0x49103c=[];_0x49103c[_0x446bda(0x10a)]({'text':_0x55518e[_0x446bda(0xc5)]=='all'?_0x446bda(0x11b):_0x446bda(0xf3)+_0x55518e['botID'],'callback_data':_0x55518e[_0x446bda(0xc5)]}),_0x5d669e%_0x22bc23==0x0&&(_0x152361[_0x8489d0]=_0x49103c,_0x8489d0++);}),tgBot[_0x2eceaa(0xb5)](_0x1fa77b['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x152361}})['catch'](_0x3429a1=>{telegramError(_0x3429a1);}),tgBot['on'](_0x2eceaa(0x169),async _0x2a7c60=>{const _0x2ae5bd=_0x2eceaa,_0x5d7153=_0x2a7c60[_0x2ae5bd(0x87)],_0x52b363=_0x2a7c60[_0x2ae5bd(0x161)];tgBot[_0x2ae5bd(0x18a)](_0x2a7c60['id'])[_0x2ae5bd(0x14e)](async()=>{const _0x22f8d2=_0x2ae5bd;_0x5d7153=='all'?(tgBot['sendMessage'](_0x52b363[_0x22f8d2(0x13f)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')['catch'](_0x4cce8d=>{telegramError(_0x4cce8d);}),_0x168c3b['forEach'](_0x1917ed=>{const _0xb8ffe=_0x22f8d2;if(_0x1917ed[_0xb8ffe(0xc5)]!=_0xb8ffe(0x194))toggleBot(_0x1917ed['botID'],toggleStatus(_0x1917ed[_0xb8ffe(0xc5)]),_0xb8ffe(0x9f));})):(tgBot[_0x22f8d2(0xb5)](_0x52b363[_0x22f8d2(0x13f)]['id'],_0x22f8d2(0xe0)+_0x5d7153)[_0x22f8d2(0x11a)](_0xffa173=>{telegramError(_0xffa173);}),toggleBot(_0x5d7153,toggleStatus(_0x5d7153),_0x22f8d2(0x9f)));}),tgBot[_0x2ae5bd(0x196)]('callback_query');});}}),tgBot[_0xc890ab(0xdb)](/\/portfolio/,_0x4df7b0=>{const _0x44d807=_0xc890ab;if(!validateTelegram(_0x4df7b0))return;tgBot[_0x44d807(0x196)](_0x44d807(0x169));const _0x3fa477=getEnabledBots();if(_0x3fa477[_0x44d807(0x1cd)]==0x0)tgBot[_0x44d807(0xb5)](_0x4df7b0['chat']['id'],_0x44d807(0x14c))[_0x44d807(0x11a)](_0x5c85f7=>{telegramError(_0x5c85f7);});else{if(_0x3fa477[_0x44d807(0x1cd)]>0x1){let _0x36f305=[],_0x16d704=[];const _0x485395=_0x3fa477[_0x44d807(0x1cd)]%0x4==0x0||_0x3fa477[_0x44d807(0x1cd)]%0x4==0x3||_0x3fa477['length']%0x3==0x1?0x4:0x3;let _0x444895=0x0;_0x3fa477[_0x44d807(0x1c6)]((_0x15a27a,_0x12683c)=>{const _0x570382=_0x44d807;if(_0x12683c%_0x485395==0x0)_0x16d704=[];_0x16d704['push']({'text':_0x570382(0xf3)+_0x15a27a['botID'],'callback_data':_0x15a27a[_0x570382(0xc5)]}),_0x12683c%_0x485395==0x0&&(_0x36f305[_0x444895]=_0x16d704,_0x444895++);}),tgBot[_0x44d807(0xb5)](_0x4df7b0[_0x44d807(0x13f)]['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x36f305}})[_0x44d807(0x11a)](_0x53c22f=>{telegramError(_0x53c22f);}),tgBot['on']('callback_query',async _0x39200c=>{const _0x59dad2=_0x44d807,_0x37ce77=_0x39200c[_0x59dad2(0x87)],_0x23460d=_0x39200c[_0x59dad2(0x161)];tgBot[_0x59dad2(0x18a)](_0x39200c['id'])[_0x59dad2(0x14e)](async()=>{const _0x2e2ddb=_0x59dad2;if(pid[_0x37ce77])pid[_0x37ce77]['send']({'function':_0x2e2ddb(0xc6),'args':null});}),tgBot[_0x59dad2(0x196)]('callback_query');});}else{const _0x580a00=_0x3fa477[0x0][_0x44d807(0xc5)];if(pid[_0x580a00])pid[_0x580a00]['send']({'function':_0x44d807(0xc6),'args':null});}}}),tgBot[_0xc890ab(0xdb)](/\/toggle/,_0x1ac961=>{const _0x1b4cbd=_0xc890ab;if(!validateTelegram(_0x1ac961))return;tgBot['removeListener'](_0x1b4cbd(0x169));const _0x1d6c6f=getBotsWithMode();if(_0x1d6c6f[_0x1b4cbd(0x1cd)]==0x0)tgBot[_0x1b4cbd(0xb5)](_0x1ac961[_0x1b4cbd(0x13f)]['id'],_0x1b4cbd(0x14c))[_0x1b4cbd(0x11a)](_0x5b3ee3=>{telegramError(_0x5b3ee3);});else{let _0x1b4534=[],_0x52f966=[];const _0x3e4651=0x2;let _0xbeb884=0x0;_0x1d6c6f[_0x1b4cbd(0x1c6)]((_0x34b3d8,_0x23f25c)=>{const _0x2757c2=_0x1b4cbd;if(_0x23f25c%_0x3e4651==0x0)_0x52f966=[];_0x52f966[_0x2757c2(0x10a)]({'text':_0x2757c2(0xf3)+_0x34b3d8[_0x2757c2(0xc5)]+'\x20('+_0x34b3d8[_0x2757c2(0x100)]+')','callback_data':_0x34b3d8[_0x2757c2(0xc5)]}),_0x23f25c%_0x3e4651==0x0&&(_0x1b4534[_0xbeb884]=_0x52f966,_0xbeb884++);}),tgBot[_0x1b4cbd(0xb5)](_0x1ac961[_0x1b4cbd(0x13f)]['id'],_0x1b4cbd(0x17f),{'reply_markup':{'inline_keyboard':_0x1b4534}})[_0x1b4cbd(0x11a)](_0x3d5246=>{telegramError(_0x3d5246);}),tgBot['on'](_0x1b4cbd(0x169),async _0x36812c=>{const _0x474a86=_0x1b4cbd,_0x3282d2=_0x36812c[_0x474a86(0x87)],_0x418ca4=_0x36812c[_0x474a86(0x161)];tgBot[_0x474a86(0x18a)](_0x36812c['id'])[_0x474a86(0x14e)](async()=>{const _0x2abd2c=_0x474a86,_0x45b316=_0x1d6c6f['find'](_0x5d4f43=>_0x5d4f43['botID']==_0x3282d2),_0x2e6e77=_0x45b316[_0x2abd2c(0x100)]==_0x2abd2c(0xc9)?_0x2abd2c(0xab):_0x2abd2c(0xc9);tgBot[_0x2abd2c(0xb5)](_0x418ca4[_0x2abd2c(0x13f)]['id'],_0x2abd2c(0x130)+_0x3282d2+_0x2abd2c(0x8f)+_0x2e6e77+_0x2abd2c(0x1e0))['catch'](_0x1400dd=>{telegramError(_0x1400dd);}),toggleBotMode(_0x3282d2);}),tgBot[_0x474a86(0x196)]('callback_query');});}}),tgBot[_0xc890ab(0xdb)](/\/names/,_0x323b64=>{const _0x4d34ca=_0xc890ab;if(!validateTelegram(_0x323b64))return;let _0xdefa9d='';config[_0x4d34ca(0x1c6)](_0x3e4927=>{const _0x113762=_0x4d34ca;_0xdefa9d+=_0x113762(0xf3)+_0x3e4927['botID']+':\x20'+_0x3e4927[_0x113762(0xb1)]+'\x0a';}),tgBot[_0x4d34ca(0xb5)](_0x323b64[_0x4d34ca(0x13f)]['id'],_0xdefa9d,{'parse_mode':'HTML'})[_0x4d34ca(0x11a)](_0x4d4fb5=>{telegramError(_0x4d4fb5);});}),tgBot[_0xc890ab(0xdb)](/\/disable/,_0x1fcc77=>{const _0x1a091b=_0xc890ab;if(!validateTelegram(_0x1fcc77))return;tgBot[_0x1a091b(0xb5)](_0x1fcc77['chat']['id'],_0x1a091b(0x111))[_0x1a091b(0x11a)](_0x3815cc=>{telegramError(_0x3815cc);}),updateSetting(_0x1a091b(0xcc),![]);}),tgBot['onText'](/\/help/,_0x54fd29=>{const _0x6ab59a=_0xc890ab;if(!validateTelegram(_0x54fd29))return;tgBot[_0x6ab59a(0xb5)](_0x54fd29[_0x6ab59a(0x13f)]['id'],_0xd885ff)[_0x6ab59a(0x11a)](_0xc131fe=>{telegramError(_0xc131fe);});}),tgBot['on'](_0xc890ab(0x86),_0x4caf11=>{const _0x3add8c=_0xc890ab;_0x4caf11['toString']()[_0x3add8c(0x134)](_0x3add8c(0x15b))&&(logging(_0x3add8c(0x1de)),tgBot[_0x3add8c(0x15a)](),tgBot=null,io['to']('botmanager')[_0x3add8c(0xe3)](_0x3add8c(0x1d1),_0x3add8c(0x1de)));}),process[_0xc890ab(0xc4)](_0xc890ab(0x1cf),()=>{const _0x4f5a6c=_0xc890ab;if(tgBot)tgBot['stopPolling']();process[_0x4f5a6c(0xa7)](0x1);}),process[_0xc890ab(0xc4)]('SIGTERM',()=>{const _0x3f95af=_0xc890ab;if(tgBot)tgBot[_0x3f95af(0x15a)]();process[_0x3f95af(0xa7)](0x1);});}}function disableTelegram(){const _0x4be390=_0xd24516;tgBot&&(tgBot[_0x4be390(0x15a)](),tgBot=null);}function sendTelegram(_0xda037,_0x5b2859){const _0x1b71da=_0xd24516;if(settings[_0x1b71da(0xcc)]){if(settings['telegramEvents']==_0x1b71da(0x194)||(_0x5b2859[_0x1b71da(0x10b)]==_0x1b71da(0x172)||_0x5b2859[_0x1b71da(0x10b)]==_0x1b71da(0x13b))&&settings['telegramEvents']==_0x1b71da(0x141)||_0x5b2859['type']==_0x1b71da(0xae)&&settings[_0x1b71da(0xa9)]==_0x1b71da(0xbd)){if(tgBot&&settings[_0x1b71da(0x11f)]){if(_0x5b2859[_0x1b71da(0x151)])tgBot[_0x1b71da(0xb5)](settings['telegramChatId'],_0x5b2859['botname']+_0x1b71da(0x1b0)+_0x5b2859[_0x1b71da(0x15d)])[_0x1b71da(0x11a)](_0x1f80d3=>{telegramError(_0x1f80d3);});else tgBot[_0x1b71da(0xb5)](settings['telegramChatId'],_0x1b71da(0xf3)+_0xda037+_0x1b71da(0x1b0)+_0x5b2859[_0x1b71da(0x15d)])[_0x1b71da(0x11a)](_0x73c9fa=>{telegramError(_0x73c9fa);});}}}}function sendTelegramMsg(_0x1d9f57){const _0x2ff133=_0xd24516;settings[_0x2ff133(0xcc)]&&(tgBot&&settings[_0x2ff133(0x11f)]&&tgBot[_0x2ff133(0xb5)](settings[_0x2ff133(0x11f)],_0x1d9f57,{'parse_mode':_0x2ff133(0x1b7)})['catch'](_0x54fdc4=>{telegramError(_0x54fdc4);}));}function getDeviceWithIp(_0x537d38){const _0x2a1764=_0xd24516;return devices[_0x2a1764(0x165)](_0x5332c5=>_0x5332c5['ip']===_0x537d38);}function temporaryAccess2FA(_0x2b83a3,_0x1e05ca){const _0x15bf22=_0xd24516;let _0x5963c6=new Date(),_0x4f0230=![];if(lastIpApproval){if(_0x5963c6-lastIpApproval<0x1388)_0x4f0230=!![];}lastIpApproval=new Date();if(_0x4f0230)return;tgBot&&settings['telegramChatId']&&(tgBot['removeListener']('callback_query'),tgBot[_0x15bf22(0xb5)](settings[_0x15bf22(0x11f)],_0x15bf22(0x148)+normalizeIP(_0x1e05ca)[_0x15bf22(0xcb)]+_0x15bf22(0x102),{'parse_mode':_0x15bf22(0x1b7),'reply_markup':{'inline_keyboard':[[{'text':_0x15bf22(0xff),'callback_data':'5'},{'text':_0x15bf22(0xdc),'callback_data':'15'},{'text':_0x15bf22(0x1a3),'callback_data':'30'},{'text':_0x15bf22(0x8d),'callback_data':_0x15bf22(0x8d)}]]}})[_0x15bf22(0x11a)](_0x59d839=>{telegramError(_0x59d839);}),tgBot['on'](_0x15bf22(0x169),async _0x4d784f=>{const _0x2fe126=_0x15bf22,_0x5e5314=_0x4d784f[_0x2fe126(0x87)],_0x3b9c78=_0x4d784f['message'];tgBot[_0x2fe126(0x18a)](_0x4d784f['id'])[_0x2fe126(0x14e)](async()=>{const _0x3661a2=_0x2fe126;devices[_0x2b83a3][_0x3661a2(0x1d8)]={'clientip':_0x1e05ca,'timestamp':new Date()[_0x3661a2(0x139)](),'expiry':_0x5e5314},_0x5e5314!='reject'?(await tgBot['sendMessage'](_0x3b9c78['chat']['id'],_0x3661a2(0xf5)+_0x5e5314+_0x3661a2(0x8c),{'parse_mode':_0x3661a2(0x1b7)})[_0x3661a2(0x11a)](_0x43c36f=>{telegramError(_0x43c36f);}),io['to'](_0x2b83a3)[_0x3661a2(0xe3)](_0x3661a2(0xdd),{'access':{'allow':![],'reason':_0x3661a2(0x84),'token':null}})):(await tgBot['sendMessage'](_0x3b9c78[_0x3661a2(0x13f)]['id'],_0x3661a2(0x180))[_0x3661a2(0x11a)](_0x116d7a=>{telegramError(_0x116d7a);}),io['to'](_0x2b83a3)['emit']('status',{'access':{'allow':![],'reason':_0x3661a2(0x9a),'token':null}}));}),tgBot[_0x2fe126(0x196)]('callback_query');}));}function loginAccess2FA(_0xc698ce,_0x53b42d){const _0x1cd066=_0xd24516;tgBot&&settings[_0x1cd066(0x11f)]&&(tgBot[_0x1cd066(0x196)](_0x1cd066(0x169)),tgBot[_0x1cd066(0xb5)](settings['telegramChatId'],_0x1cd066(0x113)+normalizeIP(_0x53b42d)[_0x1cd066(0xcb)]+_0x1cd066(0x102),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x1cd066(0xbb),'callback_data':loginExpiry},{'text':_0x1cd066(0x8d),'callback_data':'reject'}]]}})[_0x1cd066(0x11a)](_0xedcb81=>{telegramError(_0xedcb81);}),tgBot['on'](_0x1cd066(0x169),async _0x2e9b82=>{const _0xdb8e97=_0x1cd066,_0x568ef9=_0x2e9b82[_0xdb8e97(0x87)],_0x1f8f07=_0x2e9b82[_0xdb8e97(0x161)];tgBot[_0xdb8e97(0x18a)](_0x2e9b82['id'])['then'](async()=>{const _0x410d56=_0xdb8e97;devices[_0xc698ce][_0x410d56(0xad)]={'clientip':_0x53b42d,'timestamp':new Date()[_0x410d56(0x139)](),'expiry':_0x568ef9},_0x568ef9!=_0x410d56(0x8d)?(await tgBot[_0x410d56(0xb5)](_0x1f8f07[_0x410d56(0x13f)]['id'],'Login\x20accepted',{'parse_mode':_0x410d56(0x1b7)})[_0x410d56(0x11a)](_0x51ec16=>{telegramError(_0x51ec16);}),io['to'](_0xc698ce)['emit'](_0x410d56(0xdd),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x410d56(0xb5)](_0x1f8f07[_0x410d56(0x13f)]['id'],_0x410d56(0x95))['catch'](_0x25bf93=>{telegramError(_0x25bf93);}),io['to'](_0xc698ce)['emit'](_0x410d56(0xdd),{'access':{'allow':![],'reason':_0x410d56(0x150),'token':null}}));}),tgBot[_0xdb8e97(0x196)](_0xdb8e97(0x169));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x492a5e=_0xd24516;return dbConfig[_0x492a5e(0x138)](_0x492a5e(0x1c2))[_0x492a5e(0xc8)](_0x492a5e(0xc5))[_0x492a5e(0x1bb)]({'status':'enabled'})[_0x492a5e(0xf9)]()||[];}function getDisabledBots(){const _0xebba00=_0xd24516;return dbConfig[_0xebba00(0x138)]('bots')[_0xebba00(0xc8)](_0xebba00(0xc5))['filter']({'status':'disabled'})[_0xebba00(0xf9)]()||[];}function getBotsWithMode(){const _0x2db425=_0xd24516,_0x416f66=dbConfig[_0x2db425(0x138)](_0x2db425(0x1c2))[_0x2db425(0xc8)](_0x2db425(0xc5))[_0x2db425(0xf9)]()||[];return _0x416f66[_0x2db425(0x1c6)](_0x4cd893=>{const _0x5b028d=_0x2db425,_0x11ef08=configpath+_0x5b028d(0x18b)+_0x4cd893[_0x5b028d(0xc5)]+'-config.json',_0x2c8ead=fs[_0x5b028d(0xb0)](_0x11ef08);if(_0x2c8ead){const _0x173763=fs['readFileSync'](_0x11ef08);try{const _0x4298e1=JSON[_0x5b028d(0x191)](_0x173763),_0x44aa31=_0x4298e1?_0x4298e1[_0x5b028d(0x183)][0x0][_0x5b028d(0x17a)]:![];_0x4cd893[_0x5b028d(0x100)]=_0x44aa31?_0x5b028d(0xc9):_0x5b028d(0xab);}catch(_0xaf1b3f){_0x4cd893['mode']=_0x5b028d(0xab);}}else _0x4cd893[_0x5b028d(0x100)]=_0x5b028d(0xab);}),_0x416f66;}function _0x460b(_0x37e022,_0x1822ef){const _0x4cc818=_0x211c();return _0x460b=function(_0x542dfc,_0x2ddab1){_0x542dfc=_0x542dfc-0x82;let _0x211c5a=_0x4cc818[_0x542dfc];return _0x211c5a;},_0x460b(_0x37e022,_0x1822ef);}function getSettings(){const _0x583bb1=_0xd24516;return dbSettings[_0x583bb1(0x138)](_0x583bb1(0x15c))[_0x583bb1(0xf9)]()||{'timeshift':0x0};}function getSecure(){const _0x356640=_0xd24516;return dbSecure[_0x356640(0x138)](_0x356640(0x8a))[_0x356640(0xf9)]()||{};}function getBlacklist(){const _0x4c44a6=_0xd24516;return dbSecure['get']('blacklist')[_0x4c44a6(0xf9)]()||[];}function broadcastToBots(_0x529d49,_0x3cf9a3){const _0x6ccc57=_0xd24516;config[_0x6ccc57(0x1c6)](_0x569fcf=>{const _0x1d0d8e=_0x6ccc57;if(_0x569fcf['status']==_0x1d0d8e(0x16c)&&_0x569fcf['live']==_0x1d0d8e(0xca)){if(pid[_0x569fcf['botID']])pid[_0x569fcf[_0x1d0d8e(0xc5)]]['send']({[_0x529d49]:_0x3cf9a3});}});}function storeSettings(_0x3b20e9,_0xc7c7c=![]){const _0x32cc06=_0xd24516;_0x3b20e9={...settings,..._0x3b20e9};if(_0xc7c7c&&_0x3b20e9['bbPassword']!=_0x32cc06(0x18e)&&_0x3b20e9[_0x32cc06(0x1a9)]!=''){const _0x52afab=crypt[_0x32cc06(0xe5)](secure[_0x32cc06(0xe4)],_0x3b20e9[_0x32cc06(0x1a9)])[_0x32cc06(0x161)][_0x32cc06(0x135)]('@')[0x0],_0x157854=bcrypt['hashSync'](_0x52afab,saltRounds);_0x3b20e9={..._0x3b20e9,'bbPassword':_0x157854};}if(_0xc7c7c&&_0x3b20e9['telegramToken']!=_0x32cc06(0x18e)&&_0x3b20e9[_0x32cc06(0xa6)]!=''){const _0x1a48d9=crypt[_0x32cc06(0xe5)](secure[_0x32cc06(0xe4)],_0x3b20e9['telegramToken'])[_0x32cc06(0x161)][_0x32cc06(0x135)]('@')[0x0];_0x3b20e9={..._0x3b20e9,'telegramToken':_0x1a48d9};}const _0x6ba475=_0x3b20e9[_0x32cc06(0xa6)]!='************'&&_0x3b20e9['telegramToken']!=settings[_0x32cc06(0xa6)]||_0x3b20e9[_0x32cc06(0x1b1)]!=settings['telegramUsername'],_0x42c6f6=_0x3b20e9[_0x32cc06(0xa6)]==''||_0x3b20e9[_0x32cc06(0x1b1)]=='';if(_0x6ba475)_0x3b20e9[_0x32cc06(0xa9)]=_0x32cc06(0x194);for(const [_0x2d93de,_0x3d1cf7]of Object[_0x32cc06(0xd6)](_0x3b20e9)){if(_0x2d93de==_0x32cc06(0xa6)&&_0x3d1cf7=='************'){_0x3b20e9[_0x32cc06(0xa6)]=settings[_0x32cc06(0xa6)];continue;};if(_0x2d93de==_0x32cc06(0x1a9)&&_0x3d1cf7==_0x32cc06(0x18e)){_0x3b20e9[_0x32cc06(0x1a9)]=settings['bbPassword'];continue;};dbSettings[_0x32cc06(0x18d)]('settings.'+_0x2d93de,_0x3d1cf7)[_0x32cc06(0xaf)]();}settings=_0x3b20e9,io['to']('botmanager')[_0x32cc06(0xe3)]('settings',cleanSettings()),broadcastToBots('timeshift',settings[_0x32cc06(0xcf)]);if(_0x6ba475&&!_0x42c6f6)initTelegram();if(_0x6ba475&&_0x42c6f6)disableTelegram();getAllClients()[_0x32cc06(0x1c6)](_0x27b1e8=>{getSocket(_0x27b1e8['id'])['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x4fc5dc,_0x313891){const _0x40675d=_0xd24516;dbSettings[_0x40675d(0x18d)]('settings.'+_0x4fc5dc,_0x313891)['write'](),settings=getSettings(),io['to']('botmanager')[_0x40675d(0xe3)]('settings',cleanSettings());}function storeSecure(_0x346fd8){const _0x365477=_0xd24516;dbSecure[_0x365477(0x138)]('secure')[_0x365477(0x10a)](_0x346fd8)['write'](),secure=_0x346fd8;}function addBlacklist(_0xf2ac99){const _0x1f7b34=_0xd24516;cleanBlacklist();let _0x1b3e9c;devices[_0xf2ac99]['telegramIpApproval']?_0x1b3e9c=Math[_0x1f7b34(0x116)](devices[_0xf2ac99][_0x1f7b34(0x1d8)][_0x1f7b34(0xd5)],loginExpiry):_0x1b3e9c=loginExpiry,dbSecure[_0x1f7b34(0x138)](_0x1f7b34(0xa2))[_0x1f7b34(0x10a)]({'expiry':new Date()[_0x1f7b34(0x139)]()+_0x1b3e9c*0x3c*0x3e8,'token':devices[_0xf2ac99]['access'][_0x1f7b34(0x1a2)]})[_0x1f7b34(0xaf)](),blacklist=dbSecure[_0x1f7b34(0x138)](_0x1f7b34(0xa2))[_0x1f7b34(0xf9)]();}function cleanBlacklist(){const _0x52f9d9=_0xd24516;let _0x517d29=dbSecure[_0x52f9d9(0x138)](_0x52f9d9(0xa2))['cloneDeep']()[_0x52f9d9(0xf9)](),_0x150c1c=new Date()[_0x52f9d9(0x139)]();_0x517d29[_0x52f9d9(0x1c6)](_0x4923a0=>{const _0x40b7e6=_0x52f9d9;_0x4923a0['expiry']<_0x150c1c&&dbSecure[_0x40b7e6(0x138)](_0x40b7e6(0xa2))[_0x40b7e6(0x1c7)]({'expiry':_0x4923a0['expiry']})[_0x40b7e6(0xaf)]();});}function initStates(){let _0x162db0=getConfiguration();_0x162db0['forEach'](_0x2eec0c=>{const _0xa1c10b=_0x460b;_0x2eec0c[_0xa1c10b(0x189)]='stopped';}),storeConfiguration(_0x162db0);}function onKeys(){const _0x4b8a84=new RSA();return new Promise(_0x2db05d=>{const _0x4c38b9=_0x460b;_0x4b8a84['generateKeyPairAsync']()[_0x4c38b9(0x14e)](_0x5808ef=>{_0x2db05d(_0x5808ef);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x180c6f=_0xd24516;let _0x4d07c7=getConfiguration(),_0x1f9c84=![];_0x4d07c7[_0x180c6f(0x1c6)](_0x2b9c21=>{const _0x3527e6=_0x180c6f;if(_0x2b9c21[_0x3527e6(0xdd)]==_0x3527e6(0xca))_0x2b9c21[_0x3527e6(0xdd)]='enabled',_0x1f9c84=!![];else _0x2b9c21['status']==_0x3527e6(0x9f)&&(_0x2b9c21['status']='disabled',_0x1f9c84=!![]);});if(_0x1f9c84)storeConfiguration(_0x4d07c7);let _0x3183c5=getSecure();if(!_0x3183c5['hasOwnProperty'](_0x180c6f(0x137))){let _0x168b92=await generateKeys();_0x3183c5[_0x180c6f(0x1e1)]=_0x168b92[_0x180c6f(0x1e1)],_0x3183c5[_0x180c6f(0xe4)]=_0x168b92[_0x180c6f(0xe4)],_0x3183c5[_0x180c6f(0x137)]=crypto[_0x180c6f(0x12f)](0x20)[_0x180c6f(0x1cc)](_0x180c6f(0xb4)),storeSecure(_0x3183c5);}let _0x2dac27=getSettings();_0x1f9c84=![];!_0x2dac27[_0x180c6f(0xc7)](_0x180c6f(0x16b))&&(_0x2dac27['loginRequired']=![],_0x2dac27[_0x180c6f(0x190)]='',_0x2dac27[_0x180c6f(0x1a9)]='',_0x2dac27[_0x180c6f(0x1ca)]=![],_0x1f9c84=!![]);!_0x2dac27[_0x180c6f(0xc7)](_0x180c6f(0x1a8))&&(_0x2dac27['whitelistEnabled']=![],_0x2dac27[_0x180c6f(0xa1)]=[],_0x2dac27['temporaryAccessAllowed']=![],_0x1f9c84=!![]);if(!_0x2dac27['hasOwnProperty'](_0x180c6f(0xcc))){if(_0x2dac27[_0x180c6f(0x11f)])_0x2dac27[_0x180c6f(0xcc)]=!![];else _0x2dac27[_0x180c6f(0xcc)]=![];_0x1f9c84=!![];}if(_0x1f9c84)storeSettings(_0x2dac27);}function storeConfiguration(_0x1b7464){const _0x4cabbd=_0xd24516;dbConfig[_0x4cabbd(0x138)](_0x4cabbd(0x1c2))[_0x4cabbd(0x1c7)]()[_0x4cabbd(0xaf)](),_0x1b7464[_0x4cabbd(0x1c6)](_0x2576c9=>{const _0x364994=_0x4cabbd;delete _0x2576c9[_0x364994(0x100)];}),dbConfig[_0x4cabbd(0x138)](_0x4cabbd(0x1c2))[_0x4cabbd(0x10a)](..._0x1b7464)[_0x4cabbd(0xaf)](),config=_0x1b7464;}function resetPassword(){const _0x194811=_0xd24516;tgBot&&settings[_0x194811(0x11f)]&&(tgBot['removeListener'](_0x194811(0x169)),tgBot[_0x194811(0xb5)](settings[_0x194811(0x11f)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x194811(0x1b7),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x194811(0x89)},{'text':'no','callback_data':'no'}]]}})[_0x194811(0x11a)](_0x2f8f3f=>{telegramError(_0x2f8f3f);}),tgBot['on'](_0x194811(0x169),async _0x353273=>{const _0x1d4112=_0x194811,_0x58b044=_0x353273[_0x1d4112(0x87)],_0x4da659=_0x353273[_0x1d4112(0x161)];tgBot[_0x1d4112(0x18a)](_0x353273['id'])[_0x1d4112(0x14e)](async()=>{const _0x331227=_0x1d4112;if(_0x58b044!='no'){const _0x401443=0xf,_0x3c3633='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x20002b=Array['from'](crypto[_0x331227(0x124)](new Uint32Array(_0x401443)))[_0x331227(0x108)](_0x4eadbb=>_0x3c3633[_0x4eadbb%_0x3c3633['length']])[_0x331227(0x1db)](''),_0xb5d65d=bcrypt['hashSync'](_0x20002b,saltRounds);storeSettings({'bbPassword':_0xb5d65d}),await tgBot[_0x331227(0xb5)](_0x4da659[_0x331227(0x13f)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x20002b,{'parse_mode':_0x331227(0x1b7)})['catch'](_0x6a342d=>{telegramError(_0x6a342d);});}else await tgBot[_0x331227(0xb5)](_0x4da659[_0x331227(0x13f)]['id'],_0x331227(0x178))['catch'](_0x4a67a5=>{telegramError(_0x4a67a5);});}),tgBot[_0x1d4112(0x196)](_0x1d4112(0x169));}));}function logging(_0x14cc62){const _0x4bf597=_0xd24516;console['log'](getTimeStamp()+_0x4bf597(0x1c0)+_0x14cc62);if(tgBot&&settings[_0x4bf597(0x11f)]&&settings[_0x4bf597(0xa9)]!=_0x4bf597(0xbd))tgBot[_0x4bf597(0xb5)](settings[_0x4bf597(0x11f)],'Bot\x20Mgr\x20>\x20'+_0x14cc62)[_0x4bf597(0x11a)](_0x5423b9=>{telegramError(_0x5423b9);});}function getServerTime(){const _0x4d7d6b=_0xd24516,_0x169f90=new Date();return _0x169f90[_0x4d7d6b(0x15e)]()+'/'+(_0x169f90[_0x4d7d6b(0x1b2)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x169f90[_0x4d7d6b(0xb2)]()['toString']()[_0x4d7d6b(0x12c)](0x2,'0')+'\x20'+_0x169f90['getHours']()['toString']()['padStart'](0x2,'0')+':'+_0x169f90[_0x4d7d6b(0x156)]()[_0x4d7d6b(0x1cc)]()[_0x4d7d6b(0x12c)](0x2,'0')+':'+_0x169f90['getSeconds']()['toString']()[_0x4d7d6b(0x12c)](0x2,'0');}function getTimeStamp(){const _0x461186=_0xd24516,_0x308d8b=shiftedTime();return _0x308d8b[_0x461186(0x15e)]()+'/'+(_0x308d8b['getMonth']()+0x1)[_0x461186(0x1cc)]()[_0x461186(0x12c)](0x2,'0')+'/'+_0x308d8b[_0x461186(0xb2)]()[_0x461186(0x1cc)]()['padStart'](0x2,'0')+'\x20'+_0x308d8b[_0x461186(0x146)]()['toString']()[_0x461186(0x12c)](0x2,'0')+':'+_0x308d8b[_0x461186(0x156)]()[_0x461186(0x1cc)]()['padStart'](0x2,'0')+':'+_0x308d8b[_0x461186(0x11d)]()[_0x461186(0x1cc)]()[_0x461186(0x12c)](0x2,'0');}function shiftedTime(){const _0x7f4575=_0xd24516,_0x161aa1=new Date();let _0x2783ef=_0x161aa1;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x2783ef=fns[_0x7f4575(0x94)](_0x161aa1,{'hours':settings[_0x7f4575(0xcf)]});return _0x2783ef;}function startScheduler(){const _0x3fdf60=_0xd24516;let _0x20a425=new Date()[_0x3fdf60(0xd2)]();_0x20a425==0x1&&backupConfigFiles();_0x20a425==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0xdd84fe=_0xd24516;fs[_0xdd84fe(0x15f)](configpath,{'withFileTypes':!![]})[_0xdd84fe(0x1c6)](_0x571e35=>{const _0x1359b7=_0xdd84fe;if(!_0x571e35[_0x1359b7(0xb8)]())fs[_0x1359b7(0x188)](configpath+_0x571e35[_0x1359b7(0x106)],configbackuppath+_0x571e35[_0x1359b7(0x106)]);});}async function triggerAnalytics(){const _0x2f346d=_0xd24516;analytics[_0x2f346d(0x19b)]({'title':_0x2f346d(0x8e),'href':'https://hodlerhacks.com','path':'/v'+serverversion});}function validateCredentials(_0x8041ff,_0x4d40b1){const _0x3a3a33=_0xd24516;if(_0x8041ff[_0x3a3a33(0x1c3)]==settings[_0x3a3a33(0x190)]&&bcrypt[_0x3a3a33(0x121)](_0x8041ff[_0x3a3a33(0x19f)],settings[_0x3a3a33(0x1a9)])){if(settings[_0x3a3a33(0x1ca)])return{'allow':![],'reason':_0x3a3a33(0x90),'token':null};else{const _0x6f1e46=generateLoginToken(_0x4d40b1);return{'allow':!![],'reason':_0x3a3a33(0xaa),'token':_0x6f1e46};}}else return{'allow':![],'reason':_0x3a3a33(0x1d5),'token':null};}function refreshToken(_0xce9f69){const _0x594a97=_0xd24516,_0x3e4f1e=generateLoginToken(_0xce9f69);return{'allow':!![],'reason':_0x594a97(0xaa),'token':_0x3e4f1e};}function validateAccess(_0xad6d06,_0x59e343){const _0x41e6d1=_0xd24516;let _0x27cd5a=devices[_0x59e343]['ip'],_0x31bc9a;const _0x1f0147=_0x36f005=>{const _0x26e708=_0x460b;if(settings[_0x26e708(0x16b)]){if(settings[_0x26e708(0x1ca)]){if(telegram2FaApproved(_0x59e343)){const _0x22ac24=generateLoginToken(_0x59e343);return{'allow':!![],'reason':_0x26e708(0x133),'token':_0x22ac24};}else return{'allow':![],'reason':_0x26e708(0xd4),'token':null};}else return _0x31bc9a=validToken(_0x36f005,_0x59e343),_0x31bc9a['hasOwnProperty']('success')?{'allow':!![],'reason':_0x26e708(0xf1),'token':_0x36f005}:{'allow':![],'reason':_0x26e708(0xd4),'token':null};}else return{'allow':!![],'reason':_0x26e708(0x105),'token':null};};if(settings[_0x41e6d1(0x1a8)]){let _0xc0ca53=[...settings[_0x41e6d1(0xa1)],'::1',_0x41e6d1(0x17c),'127.0.0.1'];if(_0xc0ca53['includes'](_0x27cd5a))return _0x1f0147(_0xad6d06);else{_0x31bc9a=validToken(_0xad6d06,_0x59e343);if(_0x31bc9a[_0x41e6d1(0xc7)](_0x41e6d1(0x13b)))return _0x1f0147(_0xad6d06);else{if(telegramIpApproved(_0x59e343)){const _0x1abab4=generateToken(_0x59e343);return _0x31bc9a=_0x1f0147(_0xad6d06),_0x31bc9a['allow']?{'allow':!![],'reason':_0x41e6d1(0x1af),'token':_0x1abab4}:_0x31bc9a;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x41e6d1(0x10c),'token':null}:{'allow':![],'reason':_0x41e6d1(0xd7),'token':null};}}}else return _0x1f0147(_0xad6d06);}function timelyDecrypt(_0x58aea6,_0x193732=!![]){const _0x213ec1=_0xd24516;if(_0x58aea6)try{const _0x1534d4=crypt[_0x213ec1(0xe5)](secure['privateKey'],_0x58aea6)[_0x213ec1(0x161)],_0x15f131=_0x1534d4[_0x213ec1(0x135)]('@')[0x0],_0xb04b85=_0x1534d4[_0x213ec1(0x135)]('@')[0x1],_0x9e4a26=new Date()['getTime']();if(_0x193732){if(_0x9e4a26-_0xb04b85<maxSecretAge*0x3e8)return _0x15f131;else return![];}else return _0x15f131;}catch(_0x54052f){return![];}else return![];}const validToken=(_0xb1466f,_0x7bf595)=>{const _0x28bde0=_0xd24516,_0x217334=devices[_0x7bf595]['ip'];if(!_0xb1466f)return{'error':_0x28bde0(0x101)};for(let _0xc03d08 of blacklist){if(_0xc03d08['token']==_0xb1466f)return{'error':_0x28bde0(0xba)};}let _0x132bad;try{_0x132bad=jwt[_0x28bde0(0x185)](_0xb1466f,secure[_0x28bde0(0x137)]+_0x7bf595);}catch{return{'error':_0x28bde0(0xbe)};}if(!_0x132bad[_0x28bde0(0xc7)]('clientip')&&!_0x132bad[_0x28bde0(0xc7)](_0x28bde0(0x1c3))||!_0x132bad[_0x28bde0(0xc7)](_0x28bde0(0x184)))return{'error':_0x28bde0(0x1b5)};if(!_0x132bad[_0x28bde0(0xc7)]('username')&&_0x132bad[_0x28bde0(0xc7)]('clientip')){const {clientip:_0x35d270}=_0x132bad;return _0x217334==_0x35d270?{'success':_0x28bde0(0xb7)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x132bad[_0x28bde0(0xc7)](_0x28bde0(0x1c3))&&_0x132bad['hasOwnProperty'](_0x28bde0(0x88))){const {username:_0xc48e0e,clientip:_0x39aa7c}=_0x132bad;return settings['bbUsername']==_0xc48e0e&&_0x217334==_0x39aa7c?{'success':_0x28bde0(0xb7)}:{'error':_0x28bde0(0x182)};}}},generateLoginToken=_0x441343=>{const _0x2d6875=_0xd24516;if(_0x441343){const _0x191784=devices[_0x441343]['ip'];return jwt[_0x2d6875(0x112)]({'username':settings['bbUsername'],'clientip':_0x191784},secure['secret']+_0x441343,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x1961d8=>{const _0x1f0f91=_0xd24516;if(_0x1961d8){const _0x1cd0ca=devices[_0x1961d8]['ip'];return jwt[_0x1f0f91(0x112)]({'clientip':_0x1cd0ca},secure[_0x1f0f91(0x137)]+_0x1961d8,{'expiresIn':devices[_0x1961d8]['telegramIpApproval']['expiry']*0x3c});}else return![];},telegramIpApproved=_0x28491f=>{const _0x33d9e7=_0xd24516;let _0x76c1e5=![];return devices[_0x28491f][_0x33d9e7(0x1d8)]&&devices[_0x28491f][_0x33d9e7(0x1d8)]['expiry']!='reject'&&(_0x76c1e5=devices[_0x28491f][_0x33d9e7(0x1d8)][_0x33d9e7(0x88)]==devices[_0x28491f]['ip']&&new Date()[_0x33d9e7(0x139)]()-devices[_0x28491f][_0x33d9e7(0x1d8)]['timestamp']<devices[_0x28491f][_0x33d9e7(0x1d8)][_0x33d9e7(0xd5)]*0x3c*0x3e8),_0x76c1e5;},telegram2FaApproved=_0x2a0865=>{const _0x6113b5=_0xd24516;let _0x43e292=![];return devices[_0x2a0865]['telegram2FaApproval']&&devices[_0x2a0865][_0x6113b5(0xad)][_0x6113b5(0xd5)]!=_0x6113b5(0x8d)&&(_0x43e292=devices[_0x2a0865][_0x6113b5(0xad)][_0x6113b5(0x88)]==devices[_0x2a0865]['ip']&&new Date()[_0x6113b5(0x139)]()-devices[_0x2a0865][_0x6113b5(0xad)][_0x6113b5(0x125)]<devices[_0x2a0865][_0x6113b5(0xad)][_0x6113b5(0xd5)]*0x3c*0x3e8),_0x43e292;},normalizeIP=_0x1d9ec0=>{const _0x428a3e=_0xd24516;let _0x118772=null,_0x1c6bf1=null;if(ipaddr[_0x428a3e(0x96)](_0x1d9ec0)){const _0x569710=ipaddr['parse'](_0x1d9ec0);_0x569710[_0x428a3e(0x149)]()===_0x428a3e(0xc2)?(_0x569710[_0x428a3e(0x13e)]()&&(_0x118772=_0x569710[_0x428a3e(0xd8)]()['toString']()),_0x1c6bf1=_0x569710['toString']()):(_0x118772=_0x569710['toString'](),_0x1c6bf1=_0x569710[_0x428a3e(0x177)]()[_0x428a3e(0x1cc)]());}return{'show':_0x118772?_0x118772:_0x1c6bf1,'store':_0x1c6bf1};};