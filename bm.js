const _0x1e373c=_0x42c2;(function(_0x15daf7,_0x50e67b){const _0x48b3e4=_0x42c2,_0x32aeea=_0x15daf7();while(!![]){try{const _0x1ca650=-parseInt(_0x48b3e4(0x2cb))/0x1+-parseInt(_0x48b3e4(0x1e5))/0x2*(parseInt(_0x48b3e4(0x373))/0x3)+parseInt(_0x48b3e4(0x38c))/0x4+parseInt(_0x48b3e4(0x34e))/0x5*(-parseInt(_0x48b3e4(0x1f0))/0x6)+-parseInt(_0x48b3e4(0x2c2))/0x7+parseInt(_0x48b3e4(0x364))/0x8*(-parseInt(_0x48b3e4(0x257))/0x9)+parseInt(_0x48b3e4(0x2c5))/0xa;if(_0x1ca650===_0x50e67b)break;else _0x32aeea['push'](_0x32aeea['shift']());}catch(_0x32a17d){_0x32aeea['push'](_0x32aeea['shift']());}}}(_0x3b36,0xdf7ff));const _0x20243d=function(){let _0x4b6033=!![];return function(_0x885ba8,_0x5ce19c){const _0x3512bd=_0x4b6033?function(){if(_0x5ce19c){const _0x17706a=_0x5ce19c['apply'](_0x885ba8,arguments);return _0x5ce19c=null,_0x17706a;}}:function(){};return _0x4b6033=![],_0x3512bd;};}(),_0x5848e6=_0x20243d(this,function(){const _0x10d3f1=_0x42c2;return _0x5848e6[_0x10d3f1(0x1dd)]()[_0x10d3f1(0x398)](_0x10d3f1(0x35b))[_0x10d3f1(0x1dd)]()[_0x10d3f1(0x243)](_0x5848e6)['search'](_0x10d3f1(0x35b));});_0x5848e6();'use strict';process[_0x1e373c(0x203)][_0x1e373c(0x270)]=0x1;const childProcess=require(_0x1e373c(0x2d6)),fs=require('fs'),fns=require(_0x1e373c(0x334)),low=require(_0x1e373c(0x2d3)),FileSync=require(_0x1e373c(0x21c)),path=require(_0x1e373c(0x2ed)),crypto=require(_0x1e373c(0x265)),Crypt=require(_0x1e373c(0x253))['Crypt'],RSA=require(_0x1e373c(0x253))[_0x1e373c(0x23f)],bcrypt=require(_0x1e373c(0x2ca)),jwt=require(_0x1e373c(0x35e)),ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process[_0x1e373c(0x329)][_0x1e373c(0x205)](0x2))[_0x1e373c(0x329)],uuidRandom=require(_0x1e373c(0x27f)),TelegramBot=require(_0x1e373c(0x2f4)),Mixpanel=require(_0x1e373c(0x2a5)),axios=require(_0x1e373c(0x312)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x1e373c(0x321)),fileUpload=require(_0x1e373c(0x302)),{networkInterfaces}=require('os'),PORT=argv[_0x1e373c(0x244)]||_0x1e373c(0x1f7),pattern=/^[0-9]{2,4}$/;!pattern[_0x1e373c(0x396)](PORT)&&(console[_0x1e373c(0x275)](_0x1e373c(0x1fd)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x1e373c(0x27b)](0x1));const HOST=argv[_0x1e373c(0x325)]||null,userID=argv[_0x1e373c(0x371)]||'',debugging=argv['d']||![],nodeversion=process[_0x1e373c(0x204)][_0x1e373c(0x22c)];let bbpath=_0x1e373c(0x2b0),bbpath2='';const botfile=_0x1e373c(0x287),configfile=_0x1e373c(0x2ab),settingsfile='bb-settings.json',securefile=_0x1e373c(0x2e1),environment=require('./'+bbpath2+'version.json')[_0x1e373c(0x30f)]||_0x1e373c(0x38a),maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x1e373c(0x3aa)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x1e373c(0x2b8),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x1e373c(0x3a6),zippath=userID?bbpath+_0x1e373c(0x25c)+userID+'/':bbpath+'zip/',loggerfile=fs['createWriteStream'](logspath+_0x1e373c(0x3a9),{'flags':'a'}),temppath=userID?bbpath+_0x1e373c(0x2a4)+userID+'/':bbpath+_0x1e373c(0x2a4);!fs['existsSync'](configpath)&&fs['mkdirSync'](configpath);!fs[_0x1e373c(0x27e)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x1e373c(0x27e)](logspath)&&fs[_0x1e373c(0x1e7)](logspath);!fs['existsSync'](zippath)&&fs[_0x1e373c(0x1e7)](zippath);!fs[_0x1e373c(0x27e)](temppath)&&fs[_0x1e373c(0x1e7)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x1e373c(0x1eb)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x1e373c(0x1eb)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x1e373c(0x2a0),'onepagemode':![]}})[_0x1e373c(0x24c)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x1e373c(0x1eb)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x1e373c(0x23b),'rsaStandard':_0x1e373c(0x353)});const saltRounds=0xa,mixpanel=Mixpanel[_0x1e373c(0x1e1)](_0x1e373c(0x299),{'host':_0x1e373c(0x358)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x1e373c(0x226)]&&settings[_0x1e373c(0x226)]!=''&&settings[_0x1e373c(0x2d4)]&&settings[_0x1e373c(0x2d4)]!='')initTelegram();const parseColor=(_0x299fb7,_0x3d9608)=>{const _0x518f4d=_0x1e373c,_0x406e36=/#[A-Z]{3}#/g;if(typeof _0x299fb7=='string'){!_0x3d9608?_0x299fb7=_0x299fb7[_0x518f4d(0x23d)](_0x406e36,''):(_0x299fb7=_0x299fb7[_0x518f4d(0x23d)](/#BLU#/g,_0x518f4d(0x39e)),_0x299fb7=_0x299fb7[_0x518f4d(0x23d)](/#RED#/g,_0x518f4d(0x359)),_0x299fb7=_0x299fb7['replace'](/#YEL#/g,'\x1b[33m'),_0x299fb7=_0x299fb7[_0x518f4d(0x23d)](/#MAG#/g,'\x1b[35m'),_0x299fb7=_0x299fb7[_0x518f4d(0x23d)](/#CYA#/g,'\x1b[36m'),_0x299fb7=_0x299fb7['replace'](/#RES#/g,'\x1b[0m'));;}return _0x299fb7;},logger={'screen':_0x5e3f1a=>{const _0x3a5052=_0x1e373c;console[_0x3a5052(0x275)](parseColor(_0x5e3f1a,!![]));},'simple':_0x161f9a=>{const _0x474193=_0x1e373c;console[_0x474193(0x275)](parseColor(_0x161f9a,!![])),loggerfile[_0x474193(0x24c)](util[_0x474193(0x23c)](parseColor(_0x161f9a,![]))+'\x0a');},'full':async _0x1f3d03=>{const _0x2dffc7=_0x1e373c,_0x5f4a09=getTimeStamp()+_0x2dffc7(0x2b5)+_0x1f3d03;console['log'](parseColor(_0x5f4a09,!![])),loggerfile[_0x2dffc7(0x24c)](util['format'](parseColor(_0x5f4a09,![]))+'\x0a');if(tgBot&&settings[_0x2dffc7(0x331)]&&settings['telegramEvents']!=_0x2dffc7(0x1fe))await tgBot[_0x2dffc7(0x247)](settings[_0x2dffc7(0x331)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x1f3d03,![]))['catch'](_0x3e81f9=>{telegramError(_0x3e81f9);});},'debug':async(_0x43b1f2,_0x4b1f27='')=>{const _0x2ee577=_0x1e373c,_0x364aea=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x43b1f2;if(debugging)console['log'](parseColor(_0x364aea,!![]));loggerfile[_0x2ee577(0x24c)](util[_0x2ee577(0x23c)](parseColor(_0x364aea,![]))+'\x0a');if(_0x4b1f27){if(debugging)console['log'](_0x4b1f27);loggerfile[_0x2ee577(0x24c)](util['format'](_0x4b1f27)+'\x0a');}}};process['on'](_0x1e373c(0x33a),function(_0x456c6a){const _0x1b9ca1=_0x1e373c;logger[_0x1b9ca1(0x269)](_0x456c6a);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x1e373c(0x2d9)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x1e373c(0x23e))[_0x1e373c(0x308)](app);app['use'](fileUpload({'useTempFiles':!![]})),app['get'](_0x1e373c(0x375),async(_0x2b2d09,_0x35ee01)=>{const _0x28a9e8=_0x1e373c,_0x38e6ad=_0x2b2d09['params'][_0x28a9e8(0x351)],_0x1c048b=getClientsWithBotID(_0x28a9e8(0x3a2)),_0xb8e774=_0x2b2d09[_0x28a9e8(0x2b6)]['uuid'],_0x2c9f9c=timelyDecrypt(_0xb8e774,![]),_0x5b26bd=_0x1c048b[_0x28a9e8(0x20e)](_0x4776ce=>_0x4776ce['uuid']==_0x2c9f9c);if(_0x5b26bd){const _0x268c59=normalizeIP(_0x2b2d09[_0x28a9e8(0x20b)][_0x28a9e8(0x234)])['store'],_0x2c7852=_0x2b2d09['headers'][_0x28a9e8(0x268)];if(validateAccess(_0x2c7852,_0x2c9f9c,_0x268c59)[_0x28a9e8(0x245)])_0x38e6ad=='backup'&&await backupConfigFiles(),await zipFiles(_0x38e6ad),_0x35ee01[_0x28a9e8(0x230)](zippath+(_0x38e6ad+_0x28a9e8(0x34f)),_0x26a69b=>{const _0x38c346=_0x28a9e8;_0x26a69b&&(logger['full'](_0x38c346(0x223)+_0x38e6ad),logger[_0x38c346(0x269)](_0x26a69b));});else logger['full'](_0x28a9e8(0x337)+_0x38e6ad+_0x28a9e8(0x224));}else logger[_0x28a9e8(0x355)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x38e6ad+_0x28a9e8(0x264));}),app[_0x1e373c(0x309)](_0x1e373c(0x332),async(_0x3acfce,_0x72468a)=>{const _0x147723=_0x1e373c,_0x46fbdf=getClientsWithBotID(_0x147723(0x3a2)),_0x27414c=_0x3acfce[_0x147723(0x2b6)][_0x147723(0x381)],_0x39766d=timelyDecrypt(_0x27414c,![]),_0x46ce91=_0x46fbdf[_0x147723(0x20e)](_0x23ff69=>_0x23ff69['uuid']==_0x39766d);logger[_0x147723(0x2fb)](_0x147723(0x298));if(_0x46ce91){const _0x752b46=normalizeIP(_0x3acfce[_0x147723(0x20b)][_0x147723(0x234)])['store'],_0x968662=_0x3acfce['headers'][_0x147723(0x268)];if(validateAccess(_0x968662,_0x39766d,_0x752b46)[_0x147723(0x245)]){if(_0x3acfce['files']){const _0x554e6c=_0x3acfce[_0x147723(0x303)][_0x147723(0x336)];await _0x554e6c['mv'](temppath+_0x554e6c['name']),_0x72468a[_0x147723(0x384)]({'status':!![],'message':'File\x20uploaded'});const _0x1815d8=getBotsWithMode();_0x1815d8[_0x147723(0x278)]>0x0?confirmRestore(temppath,_0x554e6c[_0x147723(0x293)]):unzipFile(temppath,_0x554e6c['name']);}}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x147723(0x355)](_0x147723(0x382));}),app[_0x1e373c(0x390)](express['static'](path[_0x1e373c(0x218)](__dirname,bbpath2,_0x1e373c(0x36b)))),app[_0x1e373c(0x390)](express[_0x1e373c(0x1fa)](path[_0x1e373c(0x218)](__dirname,bbpath2,_0x1e373c(0x377)))),app['get']('/',function(_0x3a216b,_0x1c3abe){const _0x3f48ee=_0x1e373c;_0x1c3abe['sendFile'](path[_0x3f48ee(0x218)](__dirname,bbpath2,_0x3f48ee(0x36b),_0x3f48ee(0x2ff)));}),app['get'](_0x1e373c(0x25a),function(_0x373a31,_0x392cac){const _0x39ad57=_0x1e373c;_0x392cac[_0x39ad57(0x2bc)](path['join'](__dirname,bbpath2,_0x39ad57(0x377),'index.html'));}),app[_0x1e373c(0x361)](_0x1e373c(0x289),(_0x1fc34f,_0xf149eb)=>{const _0x1c449b=_0x1e373c;_0xf149eb[_0x1c449b(0x2bc)](path[_0x1c449b(0x218)](__dirname,bbpath2,'build',_0x1c449b(0x2ff)));}),app[_0x1e373c(0x361)]('/:bot/performance',(_0x5a89b0,_0x134dcb)=>{const _0x471722=_0x1e373c;_0x134dcb[_0x471722(0x2bc)](path[_0x471722(0x218)](__dirname,bbpath2,'build','index.html'));}),app[_0x1e373c(0x361)](_0x1e373c(0x365),(_0x229cdd,_0xaa76c5)=>{const _0x5e0d0c=_0x1e373c;_0xaa76c5[_0x5e0d0c(0x2bc)](path['join'](__dirname,bbpath2,'build',_0x5e0d0c(0x2ff)));}),app[_0x1e373c(0x361)](_0x1e373c(0x32d),(_0x4a392e,_0x1e66a7)=>{const _0x2ca1d=_0x1e373c;_0x1e66a7[_0x2ca1d(0x2bc)](path[_0x2ca1d(0x218)](__dirname,bbpath2,'build',_0x2ca1d(0x2ff)));}),app[_0x1e373c(0x361)](_0x1e373c(0x2e2),(_0x2a26ce,_0x3bbf81)=>{const _0x361696=_0x1e373c;_0x3bbf81['sendFile'](path[_0x361696(0x218)](__dirname,bbpath2,_0x361696(0x377),_0x361696(0x2ff)));}),app['get']('/:bot/support',(_0x20fce3,_0xca7aff)=>{const _0x33963f=_0x1e373c;_0xca7aff[_0x33963f(0x2bc)](path[_0x33963f(0x218)](__dirname,bbpath2,_0x33963f(0x377),_0x33963f(0x2ff)));});if(HOST)http[_0x1e373c(0x2d5)](PORT,HOST);else http[_0x1e373c(0x2d5)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0xf55097=_0x1e373c;let _0x4ba2ae='[ip-address]';const _0x33c5ee=networkInterfaces(),_0x56ae56={};for(const _0x40cdba of Object[_0xf55097(0x250)](_0x33c5ee)){for(const _0xa99399 of _0x33c5ee[_0x40cdba]){if((_0xa99399['family']==_0xf55097(0x32a)||_0xa99399[_0xf55097(0x1f2)]==0x4)&&!_0xa99399[_0xf55097(0x31b)]){const _0x5a5c6c=ipaddr[_0xf55097(0x1e4)](_0xa99399['address'])[_0xf55097(0x3b0)]();_0x5a5c6c!=_0xf55097(0x283)&&(!_0x56ae56[_0x40cdba]&&(_0x56ae56[_0x40cdba]=[]),_0x56ae56[_0x40cdba][_0xf55097(0x2aa)](_0xa99399[_0xf55097(0x345)]),_0x4ba2ae=_0xa99399[_0xf55097(0x345)]);}}}return{'serverip':_0x4ba2ae,'netinterfaces':_0x56ae56};}async function startServer(){const _0x20c791=_0x1e373c,{serverip:_0x50a6fe,netinterfaces:_0x48a433}=getServerIP();logger[_0x20c791(0x269)](''),logger['simple'](_0x20c791(0x22a)),await logger[_0x20c791(0x355)](_0x20c791(0x342)+serverversion+_0x20c791(0x368)+(environment=='staging'?'(staging)':'')+'\x0a'+(_0x20c791(0x301)+PORT+_0x20c791(0x2dc))+('=>\x20Go\x20to\x20#CYA#http://'+_0x50a6fe+':'+PORT+_0x20c791(0x227))),logger[_0x20c791(0x269)](_0x20c791(0x22a));if(config[_0x20c791(0x278)]!=0x0)for(const _0x144f8d of config){const _0x36c7a0=_0x144f8d[_0x20c791(0x28e)]==_0x20c791(0x1d2)?'a':'m';if(_0x144f8d[_0x20c791(0x1e6)]=='enabled'||_0x144f8d[_0x20c791(0x1e6)]=='new')await logger['full'](_0x20c791(0x317)+_0x36c7a0+_0x20c791(0x24b)+_0x144f8d['botID']+_0x20c791(0x388)+_0x144f8d[_0x20c791(0x370)]),startBot([_0x144f8d[_0x20c791(0x2d2)],userID],{'cwd':bbpath},function(_0x33692d){const _0x52c4c8=_0x20c791;if(_0x33692d)logger[_0x52c4c8(0x355)](_0x33692d);});else(_0x144f8d[_0x20c791(0x1e6)]==_0x20c791(0x2ac)||_0x144f8d[_0x20c791(0x1e6)]==_0x20c791(0x262))&&await logger[_0x20c791(0x355)](_0x20c791(0x21e)+_0x36c7a0+')\x20\x20\x20|\x20Bot\x20'+_0x144f8d[_0x20c791(0x2d2)]+_0x20c791(0x388)+_0x144f8d[_0x20c791(0x370)]);}else!newBot&&logger[_0x20c791(0x269)](_0x20c791(0x217));if(newBot)addBot();logger[_0x20c791(0x269)](_0x20c791(0x22a)),logger[_0x20c791(0x269)](''),await logger[_0x20c791(0x2fb)](_0x20c791(0x2bd)+nodeversion),await logger[_0x20c791(0x2fb)](_0x20c791(0x2b1),_0x48a433);}function startSocket(){io['on']('connection',_0x547bd2=>{const _0x553b7e=_0x42c2;let _0x50601a,_0x341581,_0x1b1894,_0x169bd0,_0xef5c6c;const _0x4f6654=_0x547bd2[_0x553b7e(0x29c)][_0x553b7e(0x2b6)][_0x553b7e(0x233)];_0x341581=_0x4f6654[_0x553b7e(0x35d)](/bot[0-9]{3}/);if(_0x341581)_0x1b1894=_0x341581[0x0]['match'](/[0-9]{3}/);if(_0x1b1894)_0x50601a=_0x1b1894[0x0];else _0x50601a='botmanager';const _0x381b55=_0x547bd2[_0x553b7e(0x29c)][_0x553b7e(0x284)]['encryptedUuid'];if(!_0x381b55)_0x547bd2[_0x553b7e(0x354)](_0x553b7e(0x1e6),{'publicKey':secure[_0x553b7e(0x297)]});else{_0x169bd0=timelyDecrypt(_0x381b55,![]);if(!_0x169bd0)_0x547bd2[_0x553b7e(0x354)]('status',{'publicKey':secure[_0x553b7e(0x297)]});else{_0xef5c6c=normalizeIP(_0x547bd2[_0x553b7e(0x31a)]['remoteAddress'])[_0x553b7e(0x26c)];if(!devices[_0x169bd0])devices[_0x169bd0]={'uuid':_0x169bd0,'access':{'token':null}};devices[_0x169bd0]['ip']=_0xef5c6c;const _0x1f1562=addClient(_0x547bd2['id'],_0x169bd0,_0x50601a);setAccess(_0x1f1562),emitMessages(),_0x547bd2['on'](_0x553b7e(0x311),_0x1ebb6b=>{const _0xb9b920=_0x553b7e,_0x486a63=timelyDecrypt(_0x1ebb6b[_0xb9b920(0x295)]);if(_0x486a63){_0x1ebb6b={'username':_0x1ebb6b[_0xb9b920(0x2e7)],'password':_0x486a63},devices[_0x169bd0]['access']=validateCredentials(_0x1ebb6b,_0x169bd0);if(devices[_0x169bd0][_0xb9b920(0x291)][_0xb9b920(0x245)]==![]&&devices[_0x169bd0][_0xb9b920(0x291)][_0xb9b920(0x2bb)]==_0xb9b920(0x202))_0x547bd2[_0xb9b920(0x354)](_0xb9b920(0x1e6),{'access':devices[_0x169bd0][_0xb9b920(0x291)]}),loginAccess2FA(_0x169bd0,_0xef5c6c);else{if(devices[_0x169bd0][_0xb9b920(0x291)][_0xb9b920(0x245)]==![]&&devices[_0x169bd0][_0xb9b920(0x291)][_0xb9b920(0x2bb)]==_0xb9b920(0x22f))_0x547bd2[_0xb9b920(0x354)](_0xb9b920(0x1e6),{'access':devices[_0x169bd0]['access']});else devices[_0x169bd0][_0xb9b920(0x291)][_0xb9b920(0x245)]&&devices[_0x169bd0][_0xb9b920(0x291)][_0xb9b920(0x2bb)]==_0xb9b920(0x2b3)&&(getClientsWithUuid(_0x169bd0)[_0xb9b920(0x306)](_0x18366d=>{setAccess(_0x18366d);}),logger[_0xb9b920(0x2fb)]('Logged\x20in\x20user\x20...'+_0x169bd0['slice'](-0x8)),setTokenRefresh(_0x169bd0),setSessionTimeout(_0xb9b920(0x311),_0x169bd0));}}else logger[_0xb9b920(0x355)](_0xb9b920(0x29e));}),_0x547bd2['on'](_0x553b7e(0x30a),()=>{resetPassword();}),_0x547bd2['on'](_0x553b7e(0x29f),_0x33162c=>{removeClient(_0x547bd2['id']);}),_0x50601a==_0x553b7e(0x3a2)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x12c346){const _0x255344=_0x1e373c;if(_0x12c346!=_0x255344(0x3a2)&&config['apiKey']!=''){if(pid[_0x12c346])pid[_0x12c346][_0x255344(0x384)]({'function':_0x255344(0x26a),'args':null});}_0x12c346!='botmanager'&&broadcastToBots(_0x255344(0x1f5),JSON['stringify'](config));}function reloadBotManager(){const _0x104755=_0x1e373c;getClientsWithBotID(_0x104755(0x3a2))[_0x104755(0x306)](_0x552293=>{const _0x75a9a=_0x104755;getSocket(_0x552293['id'])[_0x75a9a(0x354)](_0x75a9a(0x1e6),{'access':{'allow':![],'reason':_0x75a9a(0x1ef),'token':null}});});}function getSocket(_0x2c04f4){const _0x4ed9b8=_0x1e373c;return io[_0x4ed9b8(0x290)][_0x4ed9b8(0x290)][_0x4ed9b8(0x361)](_0x2c04f4);}function setAccess(_0x428840){const _0x4ebeff=_0x1e373c,_0x85a1a=getSocket(_0x428840['id']),_0x4203bd=_0x428840['uuid'],_0x591b40=_0x428840[_0x4ebeff(0x32c)];devices[_0x4203bd][_0x4ebeff(0x291)]=validateAccess(devices[_0x4203bd][_0x4ebeff(0x291)][_0x4ebeff(0x327)],_0x4203bd),logger[_0x4ebeff(0x2fb)]('Setting\x20access:\x20'+devices[_0x4203bd]['access'][_0x4ebeff(0x2bb)]+_0x4ebeff(0x350)+_0x428840['id']['slice'](-0x8)+_0x4ebeff(0x2a8)+_0x4203bd['slice'](-0x8)),_0x85a1a[_0x4ebeff(0x218)](_0x4203bd);if(devices[_0x4203bd]['access'][_0x4ebeff(0x245)]){_0x85a1a[_0x4ebeff(0x218)](_0x591b40);if(_0x591b40=='botmanager')initializeSocketBotManager(_0x85a1a);else initializeSocketBot(_0x85a1a);initClient(_0x591b40);}devices[_0x4203bd][_0x4ebeff(0x291)][_0x4ebeff(0x327)]&&devices[_0x4203bd][_0x4ebeff(0x291)][_0x4ebeff(0x2bb)]==_0x4ebeff(0x255)&&setSessionTimeout('2FA',_0x4203bd),devices[_0x4203bd][_0x4ebeff(0x291)][_0x4ebeff(0x327)]&&devices[_0x4203bd][_0x4ebeff(0x291)][_0x4ebeff(0x2bb)]==_0x4ebeff(0x33d)&&setSessionTimeout(_0x4ebeff(0x311),_0x4203bd),_0x85a1a['emit'](_0x4ebeff(0x1e6),{'status':_0x428840[_0x4ebeff(0x1e9)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4203bd][_0x4ebeff(0x291)],'externalip':devices[_0x4203bd]['ip'],'publicKey':secure[_0x4ebeff(0x297)],'userid':settings[_0x4ebeff(0x232)],'validInstallation':validInstallation}),devices[_0x4203bd][_0x4ebeff(0x291)][_0x4ebeff(0x245)]==![]&&devices[_0x4203bd][_0x4ebeff(0x291)]['reason']==_0x4ebeff(0x206)&&temporaryAccess2FA(_0x4203bd,devices[_0x4203bd]['ip']);}function setSessionTimeout(_0x1dd541,_0x13e844){const _0x4a7d96=_0x1e373c;let _0x627d4d;if(_0x1dd541==_0x4a7d96(0x311))_0x627d4d=loginExpiry*0x3c*0x3e8;else _0x627d4d=devices[_0x13e844]['telegramIpApproval'][_0x4a7d96(0x326)]*0x3c*0x3e8-(new Date()[_0x4a7d96(0x2e9)]()-devices[_0x13e844]['telegramIpApproval'][_0x4a7d96(0x307)]);if(devices[_0x13e844][_0x4a7d96(0x1f1)])clearTimeout(devices[_0x13e844][_0x4a7d96(0x1f1)]);devices[_0x13e844][_0x4a7d96(0x1f1)]=setTimeout(()=>{const _0x36790b=_0x4a7d96;if(devices[_0x13e844][_0x36790b(0x36f)])clearTimeout(devices[_0x13e844][_0x36790b(0x36f)]);removeSocketListeners(_0x13e844),addBlacklist(_0x13e844),devices[_0x13e844][_0x36790b(0x27d)]=null,devices[_0x13e844][_0x36790b(0x260)]=null,devices[_0x13e844][_0x36790b(0x291)][_0x36790b(0x327)]=null,logger[_0x36790b(0x2fb)]('Session\x20expired\x20for\x20user\x20...'+_0x13e844['slice'](-0x8)),devices[_0x13e844]['access']=validateAccess(devices[_0x13e844][_0x36790b(0x291)][_0x36790b(0x327)],_0x13e844),!(devices[_0x13e844]['access']['allow']&&devices[_0x13e844][_0x36790b(0x291)]['reason']==_0x36790b(0x324))&&(_0x1dd541==_0x36790b(0x311)?io['to'](_0x13e844)[_0x36790b(0x354)](_0x36790b(0x1e6),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x13e844)[_0x36790b(0x354)](_0x36790b(0x1e6),{'access':{'allow':![],'reason':_0x36790b(0x286),'token':null}})),devices[_0x13e844]['access']['token']=null;},_0x627d4d);}function setTokenRefresh(_0x21856d){const _0x3c4324=_0x1e373c;if(devices[_0x21856d][_0x3c4324(0x36f)])clearTimeout(devices[_0x21856d][_0x3c4324(0x36f)]);devices[_0x21856d][_0x3c4324(0x36f)]=setTimeout(()=>{const _0x368eca=_0x3c4324;getClientsWithUuid(_0x21856d)[_0x368eca(0x278)]!=0x0?(devices[_0x21856d][_0x368eca(0x291)]=refreshToken(_0x21856d),io['to'](_0x21856d)['emit'](_0x368eca(0x1e6),{'status':_0x368eca(0x3ab),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x21856d][_0x368eca(0x291)],'externalip':devices[_0x21856d]['ip'],'publicKey':secure[_0x368eca(0x297)],'validInstallation':validInstallation}),setTokenRefresh(_0x21856d)):clearTimeout(devices[_0x21856d][_0x368eca(0x36f)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x391541){const _0x4bd2b3=_0x1e373c,_0x38ce11=getClient(_0x391541['id'])['uuid'];_0x391541[_0x4bd2b3(0x354)](_0x4bd2b3(0x1f5),config),_0x391541[_0x4bd2b3(0x354)](_0x4bd2b3(0x24f),cleanSettings()),_0x391541['on'](_0x4bd2b3(0x31f),_0x90a2fc=>{const _0x2f09b9=_0x4bd2b3;if(validateAccess(_0x90a2fc,_0x38ce11)['allow'])addBot();else logger[_0x2f09b9(0x355)](_0x2f09b9(0x221));}),_0x391541['on'](_0x4bd2b3(0x1d5),(_0x4175a8,_0x24a957)=>{const _0x47c941=_0x4bd2b3;if(validateAccess(_0x24a957,_0x38ce11)[_0x47c941(0x245)])toggleBot(_0x4175a8[_0x47c941(0x2d2)],_0x4175a8['status'],_0x4175a8[_0x47c941(0x1da)]);else logger[_0x47c941(0x355)](_0x47c941(0x29d));}),_0x391541['on'](_0x4bd2b3(0x362),(_0x73d81e,_0x435e49)=>{const _0x247dc5=_0x4bd2b3;if(validateAccess(_0x435e49,_0x38ce11)[_0x247dc5(0x245)])toggleBotMode(_0x73d81e);else logger[_0x247dc5(0x355)](_0x247dc5(0x29d));}),_0x391541['on']('delete-bot',(_0x391511,_0x275f8d)=>{if(validateAccess(_0x275f8d,_0x38ce11)['allow'])deleteBot(_0x391511);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x391541['on'](_0x4bd2b3(0x379),(_0x27415e,_0x225c1f)=>{const _0x57a918=_0x4bd2b3;if(validateAccess(_0x225c1f,_0x38ce11)[_0x57a918(0x245)])storeSettings(_0x27415e,!![]);else logger[_0x57a918(0x355)](_0x57a918(0x347));}),_0x391541['on'](_0x4bd2b3(0x239),_0x47a524=>{const _0x17c4e5=_0x4bd2b3;if(validateAccess(_0x47a524,_0x38ce11)['allow'])updateBB('update');else logger[_0x17c4e5(0x355)](_0x17c4e5(0x26b));}),_0x391541['on'](_0x4bd2b3(0x33b),_0x3a442f=>{const _0x509e5d=_0x4bd2b3;if(validateAccess(_0x3a442f,_0x38ce11)[_0x509e5d(0x245)])updateBB(_0x509e5d(0x252));else logger[_0x509e5d(0x355)](_0x509e5d(0x2e3));}),_0x391541['on'](_0x4bd2b3(0x2b9),_0x165f5b=>{const _0x93f73b=_0x4bd2b3;if(validateAccess(_0x165f5b,_0x38ce11)[_0x93f73b(0x245)]){const _0x4a4195=getClient(_0x391541['id']);if(_0x4a4195)getBackupFiles(_0x4a4195[_0x93f73b(0x381)]);else logger[_0x93f73b(0x355)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger['full'](_0x93f73b(0x32e));}),_0x391541['on'](_0x4bd2b3(0x360),(_0x24f137,_0x146140)=>{const _0x3e99dd=_0x4bd2b3;if(validateAccess(_0x146140,_0x38ce11)[_0x3e99dd(0x245)])restoreBackupFile(_0x24f137);else logger[_0x3e99dd(0x355)](_0x3e99dd(0x1d7));}),_0x391541['on'](_0x4bd2b3(0x32f),_0x4c5d4b=>{const _0x116bb4=_0x4bd2b3;if(validateAccess(_0x4c5d4b,_0x38ce11)[_0x116bb4(0x245)])getMessages();else logger[_0x116bb4(0x355)](_0x116bb4(0x28c));}),_0x391541['on']('confirm-message',(_0xe75d32,_0x5e1f07)=>{const _0x43cbc9=_0x4bd2b3;if(validateAccess(_0x5e1f07,_0x38ce11)[_0x43cbc9(0x245)])confirmMessage(_0xe75d32);else logger['full'](_0x43cbc9(0x37e));}),_0x391541['on'](_0x4bd2b3(0x209),_0x4856ae=>{const _0x1fb2c7=_0x4bd2b3;if(validateAccess(_0x4856ae,_0x38ce11)[_0x1fb2c7(0x245)]){if(devices[_0x38ce11][_0x1fb2c7(0x36f)])clearTimeout(devices[_0x38ce11]['pidRefreshToken']);if(devices[_0x38ce11][_0x1fb2c7(0x1f1)])clearTimeout(devices[_0x38ce11][_0x1fb2c7(0x1f1)]);removeSocketListeners(getClient(_0x391541['id'])[_0x1fb2c7(0x381)]),addBlacklist(_0x38ce11),devices[_0x38ce11][_0x1fb2c7(0x27d)]=null,devices[_0x38ce11][_0x1fb2c7(0x260)]=null,devices[_0x38ce11][_0x1fb2c7(0x291)][_0x1fb2c7(0x327)]=null,logger[_0x1fb2c7(0x2fb)](_0x1fb2c7(0x20d)+_0x38ce11['slice'](-0x8)),io['to'](getClient(_0x391541['id'])[_0x1fb2c7(0x381)])[_0x1fb2c7(0x354)](_0x1fb2c7(0x1e6),{'access':{'allow':![],'reason':_0x1fb2c7(0x26f),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x4636b9){const _0x2c5aba=_0x1e373c,_0x1e2ba8=getClient(_0x4636b9['id'])[_0x2c5aba(0x32c)],_0xd16789=getClient(_0x4636b9['id'])[_0x2c5aba(0x381)];_0x4636b9['on'](_0x2c5aba(0x1f6),(_0x30c150,_0x427086)=>{const _0xe6a606=_0x2c5aba;if(validateAccess(_0x427086,_0xd16789)[_0xe6a606(0x245)]){if(pid[_0x1e2ba8])pid[_0x1e2ba8]['send']({'function':_0xe6a606(0x280),'args':_0x30c150});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x4636b9['on'](_0x2c5aba(0x37b),(_0x15aa29,_0x15cd5c)=>{const _0x2014db=_0x2c5aba;if(validateAccess(_0x15cd5c,_0xd16789)[_0x2014db(0x245)]){if(pid[_0x1e2ba8])pid[_0x1e2ba8][_0x2014db(0x384)]({'function':_0x2014db(0x2f0),'args':_0x15aa29});}else logger[_0x2014db(0x355)](_0x2014db(0x259));}),_0x4636b9['on']('get-portfolio',(_0x275a61,_0x1070b9)=>{const _0x1bab21=_0x2c5aba;if(validateAccess(_0x1070b9,_0xd16789)[_0x1bab21(0x245)]){if(pid[_0x1e2ba8])pid[_0x1e2ba8][_0x1bab21(0x384)]({'function':'getPortfolio','args':_0x275a61});}else logger[_0x1bab21(0x355)](_0x1bab21(0x2a3));}),_0x4636b9['on']('store-configuration',(_0xd56fd0,_0x40c37a)=>{const _0x8969e2=_0x2c5aba;if(validateAccess(_0x40c37a,_0xd16789)[_0x8969e2(0x245)]){if(pid[_0x1e2ba8])pid[_0x1e2ba8][_0x8969e2(0x384)]({'function':_0x8969e2(0x323),'args':_0xd56fd0});}else logger[_0x8969e2(0x355)](_0x8969e2(0x333));}),_0x4636b9['on']('store-headless',(_0xc34073,_0x3755a6)=>{const _0x20d1d5=_0x2c5aba;if(validateAccess(_0x3755a6,_0xd16789)[_0x20d1d5(0x245)]){if(pid[_0x1e2ba8])pid[_0x1e2ba8][_0x20d1d5(0x384)]({'function':'storeHeadless','args':_0xc34073});}else logger['full'](_0x20d1d5(0x20a));}),_0x4636b9['on'](_0x2c5aba(0x1ec),(_0x332108,_0xa3145a)=>{const _0x25f719=_0x2c5aba;if(validateAccess(_0xa3145a,_0xd16789)[_0x25f719(0x245)]){if(pid[_0x1e2ba8])pid[_0x1e2ba8][_0x25f719(0x384)]({'function':'storeFiat','args':_0x332108});}else logger[_0x25f719(0x355)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x4636b9['on'](_0x2c5aba(0x2cc),_0x40fa62=>{const _0x489dd3=_0x2c5aba;if(validateAccess(_0x40fa62,_0xd16789)[_0x489dd3(0x245)]){if(pid[_0x1e2ba8])pid[_0x1e2ba8]['send']({'function':_0x489dd3(0x1f4),'args':null});}else logger['full'](_0x489dd3(0x1ff));}),_0x4636b9['on'](_0x2c5aba(0x2ba),_0x544067=>{const _0x4ae302=_0x2c5aba;if(validateAccess(_0x544067,_0xd16789)[_0x4ae302(0x245)]){if(pid[_0x1e2ba8])pid[_0x1e2ba8][_0x4ae302(0x384)]({'function':_0x4ae302(0x385),'args':null});}else logger[_0x4ae302(0x355)](_0x4ae302(0x335));}),_0x4636b9['on'](_0x2c5aba(0x2c0),(_0x24fb67,_0x145c00)=>{const _0x122a9f=_0x2c5aba;if(validateAccess(_0x145c00,_0xd16789)[_0x122a9f(0x245)]){if(pid[_0x1e2ba8])pid[_0x1e2ba8][_0x122a9f(0x384)]({'function':_0x122a9f(0x216),'args':_0x24fb67});}else logger[_0x122a9f(0x355)](_0x122a9f(0x23a));}),_0x4636b9['on']('cancel-loading',_0x2b5564=>{const _0x1c3210=_0x2c5aba;if(validateAccess(_0x2b5564,_0xd16789)[_0x1c3210(0x245)]){if(pid[_0x1e2ba8])pid[_0x1e2ba8][_0x1c3210(0x384)]({'function':'cancelLoading','args':null});}else logger[_0x1c3210(0x355)](_0x1c3210(0x314));}),_0x4636b9['on']('show-config',_0x4a0ec3=>{const _0x52bcb3=_0x2c5aba;if(validateAccess(_0x4a0ec3,_0xd16789)[_0x52bcb3(0x245)]){if(pid[_0x1e2ba8])pid[_0x1e2ba8][_0x52bcb3(0x384)]({'function':'showConfig','args':null});}else logger[_0x52bcb3(0x355)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x4636b9['on'](_0x2c5aba(0x239),_0x45092e=>{const _0x584a63=_0x2c5aba;if(validateAccess(_0x45092e,_0xd16789)[_0x584a63(0x245)])updateBB('update');else logger[_0x584a63(0x355)](_0x584a63(0x26b));}),_0x4636b9['on'](_0x2c5aba(0x32f),_0x2ccd46=>{const _0x747cc2=_0x2c5aba;if(validateAccess(_0x2ccd46,_0xd16789)[_0x747cc2(0x245)])getMessages();else logger[_0x747cc2(0x355)](_0x747cc2(0x28c));}),_0x4636b9['on']('confirm-message',(_0x17a09a,_0x18f9b9)=>{const _0x4ba2f3=_0x2c5aba;if(validateAccess(_0x18f9b9,_0xd16789)[_0x4ba2f3(0x245)])confirmMessage(_0x17a09a);else logger['full'](_0x4ba2f3(0x37e));}),_0x4636b9['on']('logout',_0x52f4d5=>{const _0x2dd118=_0x2c5aba;if(validateAccess(_0x52f4d5,_0xd16789)[_0x2dd118(0x245)]){if(devices[_0xd16789][_0x2dd118(0x36f)])clearTimeout(devices[_0xd16789][_0x2dd118(0x36f)]);if(devices[_0xd16789][_0x2dd118(0x1f1)])clearTimeout(devices[_0xd16789][_0x2dd118(0x1f1)]);removeSocketListeners(getClient(_0x4636b9['id'])[_0x2dd118(0x381)]),addBlacklist(_0xd16789),devices[_0xd16789][_0x2dd118(0x27d)]=null,devices[_0xd16789]['telegram2FaApproval']=null,devices[_0xd16789][_0x2dd118(0x291)][_0x2dd118(0x327)]=null,logger[_0x2dd118(0x2fb)](_0x2dd118(0x20d)+_0xd16789[_0x2dd118(0x205)](-0x8)),io['to'](getClient(_0x4636b9['id'])[_0x2dd118(0x381)])[_0x2dd118(0x354)](_0x2dd118(0x1e6),{'access':{'allow':![],'reason':_0x2dd118(0x26f),'token':null}});}else logger[_0x2dd118(0x355)](_0x2dd118(0x22b));});}function removeSocketListeners(_0x213844){const _0xdf5094=_0x1e373c;getClientsWithUuid(_0x213844)[_0xdf5094(0x306)](_0x5c023b=>{getSocket(_0x5c023b['id'])['removeAllListeners']();});}function cleanSettings(){const _0x36f6e5=_0x1e373c;let _0x1d9267=settings;return settings[_0x36f6e5(0x226)]&&settings[_0x36f6e5(0x226)]!=''&&(_0x1d9267={..._0x1d9267,'telegramToken':_0x36f6e5(0x34b)}),settings[_0x36f6e5(0x213)]&&settings[_0x36f6e5(0x213)]!=''&&(_0x1d9267={..._0x1d9267,'bbPassword':_0x36f6e5(0x34b)}),(settings[_0x36f6e5(0x213)]&&settings['bbPassword']==_0x36f6e5(0x313)||settings[_0x36f6e5(0x226)]&&settings['telegramToken']==_0x36f6e5(0x313))&&(_0x1d9267={..._0x1d9267,'restored':{'password':settings[_0x36f6e5(0x213)]=='***','telegram':settings[_0x36f6e5(0x226)]=='***'}}),_0x1d9267;}async function updateBB(_0x433485){const _0x8e3922=_0x1e373c;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x53719a=>{const _0x5e4059=_0x42c2;restartBot(_0x53719a[_0x5e4059(0x2d2)]);});if(_0x433485==_0x8e3922(0x395))process[_0x8e3922(0x384)]({'update':!![],'environment':environment},_0x1ed2a7=>{});else _0x433485==_0x8e3922(0x252)&&process['send']({'reinstall':!![],'environment':environment},_0x38384b=>{});}function startBot(_0x1aab96,_0x8f7128,_0x659a40){const _0x3ca8ff=_0x1e373c;if(debugging)_0x1aab96[_0x3ca8ff(0x2aa)]('-d');let _0x45d87b=![];const _0x9c5e62=_0x1aab96[0x0];_0x8f7128={..._0x8f7128,'stdio':[_0x3ca8ff(0x36e),_0x3ca8ff(0x36e),'inherit',_0x3ca8ff(0x352)]},pid[_0x9c5e62]=childProcess[_0x3ca8ff(0x2ad)](botfile,_0x1aab96,_0x8f7128),pid[_0x9c5e62]['on'](_0x3ca8ff(0x21a),_0x4bed55=>{const _0x3cbe4b=_0x3ca8ff;switch(Object['keys'](_0x4bed55)[0x0]){case _0x3cbe4b(0x370):updateBotName(_0x9c5e62,_0x4bed55['botname']);break;case _0x3cbe4b(0x392):updateBotManager();break;case'status':updateStatus(_0x9c5e62,_0x4bed55[_0x3cbe4b(0x1e6)]);break;case _0x3cbe4b(0x1da):updateLive(_0x9c5e62,_0x4bed55[_0x3cbe4b(0x1da)]);break;case _0x3cbe4b(0x2c3):updateLive(_0x9c5e62,_0x4bed55[_0x3cbe4b(0x2c3)]),io['to'](_0x9c5e62)[_0x3cbe4b(0x354)](_0x3cbe4b(0x1e6),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x3cbe4b(0x2de):_0x4bed55[_0x3cbe4b(0x2de)]==_0x3cbe4b(0x1d6)&&restartBot(_0x9c5e62);_0x4bed55[_0x3cbe4b(0x2de)]=='kill'&&toggleBot(_0x9c5e62,'disabled',_0x3cbe4b(0x2c6));break;case _0x3cbe4b(0x20c):sendTelegram(_0x9c5e62,_0x4bed55['telegram']);break;case _0x3cbe4b(0x282):sendTelegramMsg(_0x4bed55[_0x3cbe4b(0x282)]);break;case _0x3cbe4b(0x31c):io['to'](_0x9c5e62)['emit'](_0x4bed55[_0x3cbe4b(0x31c)],_0x4bed55['args']);break;}}),pid[_0x9c5e62]['on'](_0x3ca8ff(0x1db),function(_0x45686c){if(_0x45d87b)return;_0x45d87b=!![],_0x659a40(_0x45686c);}),pid[_0x9c5e62]['on']('exit',async function(_0x5a748a){const _0x2d6912=_0x3ca8ff;if(installingUpdate)return;if(_0x45d87b)return;_0x45d87b=!![],_0x659a40(null);const _0x19aac4=dbConfig[_0x2d6912(0x361)]('bots')[_0x2d6912(0x20e)]({'botID':_0x9c5e62})[_0x2d6912(0x210)]();_0x19aac4&&(_0x19aac4[_0x2d6912(0x1e6)]==_0x2d6912(0x34a)||_0x19aac4[_0x2d6912(0x1e6)]=='new')&&(await sleep(0x3e8),updateLive(_0x9c5e62,'stopped'),logger[_0x2d6912(0x355)]('Restarting\x20Bot\x20'+_0x9c5e62),startBot([_0x9c5e62,userID],{'cwd':bbpath},function(_0x542aa1){if(_0x542aa1)logger['full'](_0x542aa1);}));});}function stopBot(_0x32529b){const _0x3a7592=_0x1e373c;getClientsWithBotID(_0x32529b)[_0x3a7592(0x306)](_0x5c8930=>{getSocket(_0x5c8930['id'])['disconnect'](!![]),removeClient(_0x5c8930['id']);}),pid[_0x32529b]&&(pid[_0x32529b][_0x3a7592(0x1df)](),pid[_0x32529b]=null);}function restartBot(_0x54211e){const _0x49dbd3=_0x1e373c;if(pid[_0x54211e])pid[_0x54211e][_0x49dbd3(0x1df)]();}function addBot(){const _0x569977=_0x1e373c;let _0x42071d;for(let _0x325e16=0x1;_0x325e16<0x3e9;_0x325e16++){_0x42071d=_0x325e16[_0x569977(0x1dd)]()[_0x569977(0x378)](0x3,'0');let _0x24b64a=config[_0x569977(0x20e)](_0x231252=>_0x231252[_0x569977(0x2d2)]==_0x42071d);if(!_0x24b64a)break;}if(_0x42071d===_0x569977(0x1f3)){logger[_0x569977(0x355)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x569977(0x355)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x42071d),dbConfig[_0x569977(0x361)](_0x569977(0x1f5))['push']({'botID':_0x42071d,'botname':_0x569977(0x28a)+_0x42071d,'status':_0x569977(0x272),'live':''})[_0x569977(0x24c)](),startBot([_0x42071d,userID],{'cwd':bbpath},function(_0x43c978){const _0x1270c8=_0x569977;if(_0x43c978)logger[_0x1270c8(0x355)](_0x43c978);}),config=getConfiguration(),io['to'](_0x569977(0x3a2))['emit'](_0x569977(0x1f5),config),broadcastToBots(_0x569977(0x1f5),JSON[_0x569977(0x1de)](config));}function deleteBot(_0x327a0b){const _0xb3ba82=_0x1e373c;getClientsWithBotID(_0x327a0b)['forEach'](_0x27a97b=>{const _0x3b5033=_0x42c2;getSocket(_0x27a97b['id'])[_0x3b5033(0x29f)](!![]),removeClient(_0x27a97b['id']);}),dbConfig[_0xb3ba82(0x361)](_0xb3ba82(0x1f5))[_0xb3ba82(0x32b)]({'botID':_0x327a0b})[_0xb3ba82(0x24c)](),logger[_0xb3ba82(0x355)](_0xb3ba82(0x256)+_0x327a0b),stopBot(_0x327a0b);try{if(fs[_0xb3ba82(0x27e)](path[_0xb3ba82(0x218)](configpath,_0xb3ba82(0x236)+_0x327a0b+_0xb3ba82(0x1e8))))fs[_0xb3ba82(0x294)](path['join'](configpath,_0xb3ba82(0x236)+_0x327a0b+'-config.json'));if(fs['existsSync'](path[_0xb3ba82(0x218)](configpath,'bot-'+_0x327a0b+_0xb3ba82(0x38f))))fs['unlinkSync'](path['join'](configpath,_0xb3ba82(0x236)+_0x327a0b+'-events.json'));if(fs[_0xb3ba82(0x27e)](path[_0xb3ba82(0x218)](configpath,'bot-'+_0x327a0b+_0xb3ba82(0x24a))))fs[_0xb3ba82(0x294)](path[_0xb3ba82(0x218)](configpath,_0xb3ba82(0x236)+_0x327a0b+_0xb3ba82(0x24a)));if(fs[_0xb3ba82(0x27e)](path[_0xb3ba82(0x218)](configpath,_0xb3ba82(0x236)+_0x327a0b+_0xb3ba82(0x376))))fs['unlinkSync'](path[_0xb3ba82(0x218)](configpath,'bot-'+_0x327a0b+_0xb3ba82(0x376)));}catch(_0x146b8f){if(_0x146b8f)logger['full'](_0xb3ba82(0x367),_0x146b8f);}config=getConfiguration(),io['to']('botmanager')['emit'](_0xb3ba82(0x1f5),config),broadcastToBots(_0xb3ba82(0x1f5),JSON['stringify'](config));}function toggleBot(_0x295593,_0x438d48,_0x17d494){const _0x3c2685=_0x1e373c;dbConfig[_0x3c2685(0x361)]('bots')['find']({'botID':_0x295593})['assign']({'status':_0x438d48})[_0x3c2685(0x279)]({'live':_0x17d494})[_0x3c2685(0x24c)]();if(_0x438d48==_0x3c2685(0x34a)||_0x438d48==_0x3c2685(0x272))logger[_0x3c2685(0x355)](_0x3c2685(0x2a1)+_0x295593),startBot([_0x295593,userID],{'cwd':bbpath},function(_0x58e96d){const _0x3eee01=_0x3c2685;if(_0x58e96d)logger[_0x3eee01(0x355)](_0x58e96d);});else(_0x438d48==_0x3c2685(0x2ac)||_0x438d48==_0x3c2685(0x262))&&(logger[_0x3c2685(0x355)](_0x3c2685(0x222)+_0x295593),stopBot(_0x295593));config=getConfiguration(),io['to'](_0x3c2685(0x3a2))[_0x3c2685(0x354)]('bots',config),broadcastToBots('bots',JSON[_0x3c2685(0x1de)](config));}function toggleStatus(_0x2e1899){const _0x18be3a=_0x1e373c;let _0x36de55=dbConfig[_0x18be3a(0x361)](_0x18be3a(0x1f5))['find']({'botID':_0x2e1899})[_0x18be3a(0x210)](),_0xe50516;if(_0x36de55[_0x18be3a(0x1e6)]===_0x18be3a(0x34a))_0xe50516=_0x18be3a(0x2ac);else{if(_0x36de55[_0x18be3a(0x1e6)]===_0x18be3a(0x272))_0xe50516=_0x18be3a(0x262);else{if(_0x36de55[_0x18be3a(0x1e6)]===_0x18be3a(0x262))_0xe50516='new';else{if(_0x36de55[_0x18be3a(0x1e6)]==='disabled')_0xe50516=_0x18be3a(0x34a);}}}return _0xe50516;}function updateStatus(_0x197461,_0x1b1463){const _0x31d398=_0x1e373c;dbConfig['get'](_0x31d398(0x1f5))[_0x31d398(0x20e)]({'botID':_0x197461})[_0x31d398(0x279)]({'status':_0x1b1463})[_0x31d398(0x24c)](),config=getConfiguration(),io['to'](_0x31d398(0x3a2))[_0x31d398(0x354)](_0x31d398(0x1f5),config),broadcastToBots(_0x31d398(0x1f5),JSON[_0x31d398(0x1de)](config));}function updateLive(_0x223ce2,_0x40f431){const _0x5a35e2=_0x1e373c;dbConfig[_0x5a35e2(0x361)](_0x5a35e2(0x1f5))['find']({'botID':_0x223ce2})[_0x5a35e2(0x279)]({'live':_0x40f431})[_0x5a35e2(0x24c)](),config=getConfiguration(),io['to'](_0x5a35e2(0x3a2))[_0x5a35e2(0x354)]('bots',config),broadcastToBots(_0x5a35e2(0x1f5),JSON[_0x5a35e2(0x1de)](config));}function updateBotName(_0x4b5793,_0x1247d9){const _0x1c5a67=_0x1e373c;dbConfig[_0x1c5a67(0x361)]('bots')[_0x1c5a67(0x20e)]({'botID':_0x4b5793})[_0x1c5a67(0x279)]({'botname':_0x1247d9})[_0x1c5a67(0x24c)](),config=getConfiguration(),io['to'](_0x1c5a67(0x3a2))[_0x1c5a67(0x354)]('bots',config),broadcastToBots(_0x1c5a67(0x1f5),JSON[_0x1c5a67(0x1de)](config));}function updateBotManager(){const _0x11a6e3=_0x1e373c;config=getConfiguration(),io['to']('botmanager')[_0x11a6e3(0x354)](_0x11a6e3(0x1f5),config),broadcastToBots('bots',JSON[_0x11a6e3(0x1de)](config));}function toggleBotMode(_0x59be53){const _0x1d3ea1=_0x1e373c;if(pid[_0x59be53])pid[_0x59be53]['send']({'function':_0x1d3ea1(0x237),'args':null});else{const _0x34ab55=configpath+_0x1d3ea1(0x236)+_0x59be53+_0x1d3ea1(0x1e8),_0x5256f0=fs[_0x1d3ea1(0x3a3)](_0x34ab55),_0x13f1ec=JSON['parse'](_0x5256f0),_0x43c0d7=_0x13f1ec[_0x1d3ea1(0x32c)][0x0][_0x1d3ea1(0x254)];_0x13f1ec['bot'][0x0][_0x1d3ea1(0x254)]=!_0x43c0d7;const _0x1f4648=JSON['stringify'](_0x13f1ec,null,0x2);fs['writeFileSync'](_0x34ab55,_0x1f4648),config=getConfiguration(),io['to']('botmanager')[_0x1d3ea1(0x354)]('bots',config),broadcastToBots(_0x1d3ea1(0x1f5),JSON[_0x1d3ea1(0x1de)](config));}}function telegramError(_0x451e77){const _0x5cd1fb=_0x1e373c;logger[_0x5cd1fb(0x269)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x2000e9){const _0x56d8d3=_0x1e373c;if(_0x2000e9[_0x56d8d3(0x26e)][_0x56d8d3(0x2e7)]!=settings[_0x56d8d3(0x2d4)]&&'@'+_0x2000e9[_0x56d8d3(0x26e)][_0x56d8d3(0x2e7)]!=settings[_0x56d8d3(0x2d4)])return tgBot[_0x56d8d3(0x247)](_0x2000e9[_0x56d8d3(0x25d)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x56d8d3(0x3ac)})[_0x56d8d3(0x1e2)](_0x42ab0d=>{telegramError(_0x42ab0d);}),![];return!![];}async function initTelegram(){const _0x17502c=_0x1e373c;if(tgBot)tgBot[_0x17502c(0x274)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x17502c(0x226)],{'polling':!![]});let _0x31702b=_0x17502c(0x3af);_0x31702b+='\x0a',_0x31702b+=_0x17502c(0x30d),_0x31702b+=_0x17502c(0x207),_0x31702b+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x31702b+=_0x17502c(0x38e),_0x31702b+='/on\x20-\x20start\x20bot(s)\x0a',_0x31702b+=_0x17502c(0x344),_0x31702b+=_0x17502c(0x383),_0x31702b+=_0x17502c(0x3b2),_0x31702b+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x31702b+=_0x17502c(0x3a4),_0x31702b+=_0x17502c(0x2ce),_0x31702b+=_0x17502c(0x31d),_0x31702b+=_0x17502c(0x3a1),_0x31702b+=_0x17502c(0x35a);let _0x3733de=_0x17502c(0x3a0);_0x3733de+='\x0a',_0x3733de+=_0x31702b,tgBot[_0x17502c(0x3a7)](/\/start/,_0x9787f1=>{const _0x93f294=_0x17502c;if(!validateTelegram(_0x9787f1))return;if(settings[_0x93f294(0x331)]!=_0x9787f1['chat']['id'])updateSetting(_0x93f294(0x331),_0x9787f1['chat']['id']);updateSetting(_0x93f294(0x35f),!![]),tgBot['sendMessage'](_0x9787f1[_0x93f294(0x25d)]['id'],_0x3733de)[_0x93f294(0x1e2)](_0xd20847=>{telegramError(_0xd20847);});}),tgBot[_0x17502c(0x3a7)](/\/enable/,_0xd74c0d=>{const _0x555be9=_0x17502c;if(!validateTelegram(_0xd74c0d))return;if(settings[_0x555be9(0x331)]!=_0xd74c0d[_0x555be9(0x25d)]['id'])updateSetting(_0x555be9(0x331),_0xd74c0d[_0x555be9(0x25d)]['id']);updateSetting(_0x555be9(0x35f),!![]),tgBot['sendMessage'](_0xd74c0d[_0x555be9(0x25d)]['id'],'Notifications\x20enabled')[_0x555be9(0x1e2)](_0x1f6a7b=>{telegramError(_0x1f6a7b);});}),tgBot[_0x17502c(0x3a7)](/\/config/,async _0x54bb74=>{const _0x2e4110=_0x17502c;if(!validateTelegram(_0x54bb74))return;tgBot[_0x2e4110(0x273)]('callback_query'),tgBot[_0x2e4110(0x247)](_0x54bb74['chat']['id'],_0x2e4110(0x38d),{'reply_markup':{'inline_keyboard':[[{'text':_0x2e4110(0x200),'callback_data':'orders'},{'text':_0x2e4110(0x310),'callback_data':'alerts'},{'text':_0x2e4110(0x394),'callback_data':_0x2e4110(0x2d1)}]]}})['catch'](_0x4ba977=>{telegramError(_0x4ba977);}),tgBot['on']('callback_query',async _0x472be7=>{const _0x24d200=_0x2e4110,_0x533140=_0x472be7['data'],_0x488e25=_0x472be7[_0x24d200(0x21a)];tgBot['answerCallbackQuery'](_0x472be7['id'])['then'](async()=>{const _0x236b68=_0x24d200;_0x533140==_0x236b68(0x1fe)&&(updateSetting('telegramEvents',_0x236b68(0x1fe)),updateSetting(_0x236b68(0x35f),!![]),await tgBot[_0x236b68(0x247)](_0x488e25[_0x236b68(0x25d)]['id'],_0x236b68(0x305))['catch'](_0x6026d=>{telegramError(_0x6026d);}));_0x533140==_0x236b68(0x2ec)&&(updateSetting(_0x236b68(0x22d),_0x236b68(0x2ec)),updateSetting(_0x236b68(0x35f),!![]),await tgBot[_0x236b68(0x247)](_0x488e25[_0x236b68(0x25d)]['id'],_0x236b68(0x2df))['catch'](_0x2d2754=>{telegramError(_0x2d2754);}));_0x533140=='all'&&(updateSetting('telegramEvents',_0x236b68(0x2d1)),updateSetting(_0x236b68(0x35f),!![]),await tgBot[_0x236b68(0x247)](_0x488e25[_0x236b68(0x25d)]['id'],_0x236b68(0x2a7))['catch'](_0xb40fd1=>{telegramError(_0xb40fd1);}));if(!settings['telegramChatId'])tgBot[_0x236b68(0x247)](_0x488e25[_0x236b68(0x25d)]['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x236b68(0x1e2)](_0x47ee58=>{telegramError(_0x47ee58);});}),tgBot[_0x24d200(0x273)](_0x24d200(0x263));});}),tgBot['onText'](/\/status/,_0x4b6d43=>{const _0x16f2fa=_0x17502c;if(!validateTelegram(_0x4b6d43))return;const _0x45bf4a=getBotsWithMode();let _0x2bc357=_0x16f2fa(0x2d0);config['forEach'](_0x297024=>{const _0x5662cb=_0x16f2fa,_0x4f9b32=_0x45bf4a[_0x5662cb(0x20e)](_0x34f63f=>_0x34f63f[_0x5662cb(0x2d2)]==_0x297024[_0x5662cb(0x2d2)])[_0x5662cb(0x28e)];_0x2bc357+=_0x5662cb(0x28a)+_0x297024[_0x5662cb(0x2d2)]+':\x20'+_0x297024[_0x5662cb(0x1e6)]+_0x5662cb(0x388)+_0x4f9b32+_0x5662cb(0x388)+_0x297024[_0x5662cb(0x1da)]+'\x0a';}),_0x2bc357+='\x0a',_0x2bc357+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x2bc357+=!settings[_0x16f2fa(0x35f)]?_0x16f2fa(0x374):_0x16f2fa(0x248),_0x2bc357+=settings[_0x16f2fa(0x35f)]?settings[_0x16f2fa(0x22d)]==_0x16f2fa(0x2d1)?_0x16f2fa(0x2eb):'Notifications\x20types:\x20'+settings[_0x16f2fa(0x22d)]+_0x16f2fa(0x2d7):'',tgBot[_0x16f2fa(0x247)](_0x4b6d43[_0x16f2fa(0x25d)]['id'],_0x2bc357,{'parse_mode':_0x16f2fa(0x3ac)})['catch'](_0x2f08e6=>{telegramError(_0x2f08e6);});}),tgBot[_0x17502c(0x3a7)](/\/restart/,_0x4755f1=>{const _0x4ef137=_0x17502c;if(!validateTelegram(_0x4755f1))return;tgBot[_0x4ef137(0x273)](_0x4ef137(0x263));const _0x1f67a0=getEnabledBots();if(_0x1f67a0['length']==0x0)tgBot[_0x4ef137(0x247)](_0x4755f1[_0x4ef137(0x25d)]['id'],_0x4ef137(0x2cd))['catch'](_0x4d4f42=>{telegramError(_0x4d4f42);});else{if(_0x1f67a0['length']>0x1)_0x1f67a0[_0x4ef137(0x2aa)]({'botID':_0x4ef137(0x2d1)});let _0x384fa8=[],_0x5c85be=[];const _0x3d4225=_0x1f67a0[_0x4ef137(0x278)]%0x4==0x0||_0x1f67a0[_0x4ef137(0x278)]%0x4==0x3||_0x1f67a0['length']%0x3==0x1?0x4:0x3;let _0x5cbce6=0x0;_0x1f67a0['forEach']((_0xa7f70b,_0x4aea1f)=>{const _0x846707=_0x4ef137;if(_0x4aea1f%_0x3d4225==0x0)_0x5c85be=[];_0x5c85be['push']({'text':_0xa7f70b[_0x846707(0x2d2)]==_0x846707(0x2d1)?_0x846707(0x31e):_0x846707(0x28a)+_0xa7f70b[_0x846707(0x2d2)],'callback_data':_0xa7f70b[_0x846707(0x2d2)]}),_0x4aea1f%_0x3d4225==0x0&&(_0x384fa8[_0x5cbce6]=_0x5c85be,_0x5cbce6++);}),tgBot[_0x4ef137(0x247)](_0x4755f1[_0x4ef137(0x25d)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x384fa8}})[_0x4ef137(0x1e2)](_0xf62877=>{telegramError(_0xf62877);}),tgBot['on'](_0x4ef137(0x263),async _0x44d350=>{const _0x4d0d02=_0x4ef137,_0x2b9fa2=_0x44d350[_0x4d0d02(0x318)],_0x40f574=_0x44d350[_0x4d0d02(0x21a)];tgBot[_0x4d0d02(0x3b1)](_0x44d350['id'])['then'](async()=>{const _0x591a32=_0x4d0d02;_0x2b9fa2==_0x591a32(0x2d1)?config[_0x591a32(0x306)](_0x2e517c=>{const _0x3a3888=_0x591a32;restartBot(_0x2e517c[_0x3a3888(0x2d2)]);}):restartBot(_0x2b9fa2);}),tgBot['removeListener'](_0x4d0d02(0x263));});}}),tgBot['onText'](/\/on/,_0x470b6b=>{const _0x4fd0c9=_0x17502c;if(!validateTelegram(_0x470b6b))return;tgBot['removeListener'](_0x4fd0c9(0x263));const _0x58d157=getDisabledBots();if(_0x58d157['length']==0x0)tgBot[_0x4fd0c9(0x247)](_0x470b6b[_0x4fd0c9(0x25d)]['id'],_0x4fd0c9(0x2ae))[_0x4fd0c9(0x1e2)](_0x16c4b3=>{telegramError(_0x16c4b3);});else{if(_0x58d157[_0x4fd0c9(0x278)]>0x1)_0x58d157['push']({'botID':_0x4fd0c9(0x2d1)});let _0xd096ed=[],_0x31ad47=[];const _0x408dc7=_0x58d157[_0x4fd0c9(0x278)]%0x4==0x0||_0x58d157['length']%0x4==0x3||_0x58d157['length']%0x3==0x1?0x4:0x3;let _0x57a6d8=0x0;_0x58d157[_0x4fd0c9(0x306)]((_0x233ecd,_0x1a5b8d)=>{const _0x40d219=_0x4fd0c9;if(_0x1a5b8d%_0x408dc7==0x0)_0x31ad47=[];_0x31ad47[_0x40d219(0x2aa)]({'text':_0x233ecd['botID']==_0x40d219(0x2d1)?'All\x20bots':_0x40d219(0x28a)+_0x233ecd[_0x40d219(0x2d2)],'callback_data':_0x233ecd['botID']}),_0x1a5b8d%_0x408dc7==0x0&&(_0xd096ed[_0x57a6d8]=_0x31ad47,_0x57a6d8++);}),tgBot['sendMessage'](_0x470b6b[_0x4fd0c9(0x25d)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0xd096ed}})['catch'](_0x7c5bbd=>{telegramError(_0x7c5bbd);}),tgBot['on'](_0x4fd0c9(0x263),async _0x5c9561=>{const _0x2e7ce5=_0x4fd0c9,_0x5bfa22=_0x5c9561['data'],_0x8ae282=_0x5c9561[_0x2e7ce5(0x21a)];tgBot[_0x2e7ce5(0x3b1)](_0x5c9561['id'])[_0x2e7ce5(0x219)](async()=>{const _0x10d83d=_0x2e7ce5;_0x5bfa22==_0x10d83d(0x2d1)?(tgBot[_0x10d83d(0x247)](_0x8ae282[_0x10d83d(0x25d)]['id'],_0x10d83d(0x348))[_0x10d83d(0x1e2)](_0x59f69f=>{telegramError(_0x59f69f);}),_0x58d157[_0x10d83d(0x306)](_0x47f539=>{const _0x8e92bd=_0x10d83d;if(_0x47f539[_0x8e92bd(0x2d2)]!=_0x8e92bd(0x2d1))toggleBot(_0x47f539['botID'],toggleStatus(_0x47f539[_0x8e92bd(0x2d2)]),'stopped');})):(tgBot[_0x10d83d(0x247)](_0x8ae282[_0x10d83d(0x25d)]['id'],_0x10d83d(0x34c)+_0x5bfa22)['catch'](_0x515158=>{telegramError(_0x515158);}),toggleBot(_0x5bfa22,toggleStatus(_0x5bfa22),_0x10d83d(0x2c6)));}),tgBot[_0x2e7ce5(0x273)](_0x2e7ce5(0x263));});}}),tgBot[_0x17502c(0x3a7)](/\/off/,_0x3885ef=>{const _0x4afa00=_0x17502c;if(!validateTelegram(_0x3885ef))return;tgBot[_0x4afa00(0x273)]('callback_query');const _0x3d3df3=getEnabledBots();if(_0x3d3df3['length']==0x0)tgBot[_0x4afa00(0x247)](_0x3885ef['chat']['id'],_0x4afa00(0x2cd))[_0x4afa00(0x1e2)](_0x14a8c6=>{telegramError(_0x14a8c6);});else{if(_0x3d3df3[_0x4afa00(0x278)]>0x1)_0x3d3df3[_0x4afa00(0x2aa)]({'botID':_0x4afa00(0x2d1)});let _0x6b0f06=[],_0x1d5ba5=[];const _0x69690b=_0x3d3df3[_0x4afa00(0x278)]%0x4==0x0||_0x3d3df3[_0x4afa00(0x278)]%0x4==0x3||_0x3d3df3[_0x4afa00(0x278)]%0x3==0x1?0x4:0x3;let _0x5acd72=0x0;_0x3d3df3[_0x4afa00(0x306)]((_0x1f1092,_0xa40a16)=>{const _0x1518e8=_0x4afa00;if(_0xa40a16%_0x69690b==0x0)_0x1d5ba5=[];_0x1d5ba5['push']({'text':_0x1f1092[_0x1518e8(0x2d2)]==_0x1518e8(0x2d1)?'All\x20bots':_0x1518e8(0x28a)+_0x1f1092[_0x1518e8(0x2d2)],'callback_data':_0x1f1092[_0x1518e8(0x2d2)]}),_0xa40a16%_0x69690b==0x0&&(_0x6b0f06[_0x5acd72]=_0x1d5ba5,_0x5acd72++);}),tgBot[_0x4afa00(0x247)](_0x3885ef[_0x4afa00(0x25d)]['id'],_0x4afa00(0x2c8),{'reply_markup':{'inline_keyboard':_0x6b0f06}})[_0x4afa00(0x1e2)](_0x5b5293=>{telegramError(_0x5b5293);}),tgBot['on'](_0x4afa00(0x263),async _0x5e6e38=>{const _0x51727a=_0x4afa00,_0x4cc9eb=_0x5e6e38['data'],_0x456034=_0x5e6e38[_0x51727a(0x21a)];tgBot[_0x51727a(0x3b1)](_0x5e6e38['id'])['then'](async()=>{const _0x163e18=_0x51727a;_0x4cc9eb=='all'?(tgBot['sendMessage'](_0x456034[_0x163e18(0x25d)]['id'],_0x163e18(0x225))[_0x163e18(0x1e2)](_0xcdc83=>{telegramError(_0xcdc83);}),_0x3d3df3['forEach'](_0x4da541=>{const _0x133e47=_0x163e18;if(_0x4da541[_0x133e47(0x2d2)]!='all')toggleBot(_0x4da541[_0x133e47(0x2d2)],toggleStatus(_0x4da541[_0x133e47(0x2d2)]),_0x133e47(0x2c6));})):(tgBot[_0x163e18(0x247)](_0x456034[_0x163e18(0x25d)]['id'],_0x163e18(0x2f8)+_0x4cc9eb)[_0x163e18(0x1e2)](_0x165d85=>{telegramError(_0x165d85);}),toggleBot(_0x4cc9eb,toggleStatus(_0x4cc9eb),_0x163e18(0x2c6)));}),tgBot[_0x51727a(0x273)](_0x51727a(0x263));});}}),tgBot[_0x17502c(0x3a7)](/\/metrics/,_0x4af557=>{const _0x44c7a1=_0x17502c;if(!validateTelegram(_0x4af557))return;tgBot[_0x44c7a1(0x273)](_0x44c7a1(0x263));const _0x2b1a9a=getEnabledBots();if(_0x2b1a9a[_0x44c7a1(0x278)]==0x0)tgBot[_0x44c7a1(0x247)](_0x4af557[_0x44c7a1(0x25d)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x44c7a1(0x1e2)](_0x3b1d2c=>{telegramError(_0x3b1d2c);});else{if(_0x2b1a9a['length']>0x1){let _0x2aa42f=[],_0x13140b=[];const _0x388967=_0x2b1a9a['length']%0x4==0x0||_0x2b1a9a[_0x44c7a1(0x278)]%0x4==0x3||_0x2b1a9a[_0x44c7a1(0x278)]%0x3==0x1?0x4:0x3;let _0x38c7d6=0x0;_0x2b1a9a[_0x44c7a1(0x306)]((_0x4cac39,_0x225adf)=>{const _0x4169dc=_0x44c7a1;if(_0x225adf%_0x388967==0x0)_0x13140b=[];_0x13140b[_0x4169dc(0x2aa)]({'text':_0x4169dc(0x28a)+_0x4cac39['botID'],'callback_data':_0x4cac39[_0x4169dc(0x2d2)]}),_0x225adf%_0x388967==0x0&&(_0x2aa42f[_0x38c7d6]=_0x13140b,_0x38c7d6++);}),tgBot[_0x44c7a1(0x247)](_0x4af557['chat']['id'],_0x44c7a1(0x37c),{'reply_markup':{'inline_keyboard':_0x2aa42f}})['catch'](_0x34552d=>{telegramError(_0x34552d);}),tgBot['on']('callback_query',async _0x5aebd2=>{const _0x35b16b=_0x44c7a1,_0x3e2137=_0x5aebd2[_0x35b16b(0x318)],_0x23e7d9=_0x5aebd2[_0x35b16b(0x21a)];tgBot['answerCallbackQuery'](_0x5aebd2['id'])['then'](async()=>{const _0x1c5441=_0x35b16b;if(pid[_0x3e2137])pid[_0x3e2137][_0x1c5441(0x384)]({'function':_0x1c5441(0x25b),'args':null});}),tgBot[_0x35b16b(0x273)](_0x35b16b(0x263));});}else{const _0x369b86=_0x2b1a9a[0x0][_0x44c7a1(0x2d2)];if(pid[_0x369b86])pid[_0x369b86][_0x44c7a1(0x384)]({'function':_0x44c7a1(0x25b),'args':null});}}}),tgBot[_0x17502c(0x3a7)](/\/portfolio/,_0x494373=>{const _0x385bfd=_0x17502c;if(!validateTelegram(_0x494373))return;tgBot[_0x385bfd(0x273)](_0x385bfd(0x263));const _0x5a5b9b=getEnabledBots();if(_0x5a5b9b[_0x385bfd(0x278)]==0x0)tgBot[_0x385bfd(0x247)](_0x494373[_0x385bfd(0x25d)]['id'],_0x385bfd(0x2cd))['catch'](_0x2c669f=>{telegramError(_0x2c669f);});else{if(_0x5a5b9b[_0x385bfd(0x278)]>0x1){let _0x16f957=[],_0x1c748d=[];const _0x18c972=_0x5a5b9b[_0x385bfd(0x278)]%0x4==0x0||_0x5a5b9b[_0x385bfd(0x278)]%0x4==0x3||_0x5a5b9b[_0x385bfd(0x278)]%0x3==0x1?0x4:0x3;let _0x4d739f=0x0;_0x5a5b9b[_0x385bfd(0x306)]((_0x3e2c8a,_0x5e3dd1)=>{const _0x480fcd=_0x385bfd;if(_0x5e3dd1%_0x18c972==0x0)_0x1c748d=[];_0x1c748d[_0x480fcd(0x2aa)]({'text':_0x480fcd(0x28a)+_0x3e2c8a[_0x480fcd(0x2d2)],'callback_data':_0x3e2c8a[_0x480fcd(0x2d2)]}),_0x5e3dd1%_0x18c972==0x0&&(_0x16f957[_0x4d739f]=_0x1c748d,_0x4d739f++);}),tgBot['sendMessage'](_0x494373[_0x385bfd(0x25d)]['id'],_0x385bfd(0x201),{'reply_markup':{'inline_keyboard':_0x16f957}})[_0x385bfd(0x1e2)](_0x3d355f=>{telegramError(_0x3d355f);}),tgBot['on'](_0x385bfd(0x263),async _0xf53c54=>{const _0x108e0b=_0x385bfd,_0x172391=_0xf53c54[_0x108e0b(0x318)],_0x3cd27f=_0xf53c54['message'];tgBot['answerCallbackQuery'](_0xf53c54['id'])[_0x108e0b(0x219)](async()=>{const _0x3336e6=_0x108e0b;if(pid[_0x172391])pid[_0x172391]['send']({'function':_0x3336e6(0x208),'args':null});}),tgBot[_0x108e0b(0x273)](_0x108e0b(0x263));});}else{const _0xe19316=_0x5a5b9b[0x0][_0x385bfd(0x2d2)];if(pid[_0xe19316])pid[_0xe19316]['send']({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x17502c(0x3a7)](/\/update/,async _0x51babb=>{const _0x2d66e8=_0x17502c;if(!validateTelegram(_0x51babb))return;tgBot[_0x2d66e8(0x273)]('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x2d66e8(0x247)](_0x51babb[_0x2d66e8(0x25d)]['id'],_0x2d66e8(0x1d4))[_0x2d66e8(0x1e2)](_0x36739c=>{telegramError(_0x36739c);});else!validInstallation?tgBot[_0x2d66e8(0x247)](_0x51babb[_0x2d66e8(0x25d)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0x2d66e8(0x1e2)](_0x2e05d3=>{telegramError(_0x2e05d3);}):(tgBot[_0x2d66e8(0x247)](_0x51babb[_0x2d66e8(0x25d)]['id'],_0x2d66e8(0x228),{'reply_markup':{'inline_keyboard':[[{'text':_0x2d66e8(0x22e),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})['catch'](_0x304062=>{telegramError(_0x304062);}),tgBot['on']('callback_query',async _0x3868a7=>{const _0xed9456=_0x2d66e8,_0x3afda2=_0x3868a7[_0xed9456(0x318)],_0x31327a=_0x3868a7[_0xed9456(0x21a)];tgBot['answerCallbackQuery'](_0x3868a7['id'])[_0xed9456(0x219)](async()=>{const _0x2893d5=_0xed9456;_0x3afda2=='yes'&&(await tgBot[_0x2893d5(0x247)](_0x31327a['chat']['id'],_0x2893d5(0x38b))['catch'](_0x454a45=>{telegramError(_0x454a45);}),updateBB(_0x2893d5(0x395))),_0x3afda2=='no'&&await tgBot[_0x2893d5(0x247)](_0x31327a[_0x2893d5(0x25d)]['id'],_0x2893d5(0x2ea))['catch'](_0x3eefcb=>{telegramError(_0x3eefcb);});}),tgBot[_0xed9456(0x273)]('callback_query');}));}),tgBot[_0x17502c(0x3a7)](/\/reinstall/,async _0x5f3dac=>{const _0x57dbdd=_0x17502c;if(!validateTelegram(_0x5f3dac))return;tgBot[_0x57dbdd(0x273)]('callback_query'),!validInstallation?tgBot[_0x57dbdd(0x247)](_0x5f3dac['chat']['id'],_0x57dbdd(0x366))[_0x57dbdd(0x1e2)](_0x12ce5b=>{telegramError(_0x12ce5b);}):(tgBot['sendMessage'](_0x5f3dac['chat']['id'],_0x57dbdd(0x238),{'reply_markup':{'inline_keyboard':[[{'text':_0x57dbdd(0x22e),'callback_data':_0x57dbdd(0x240)},{'text':'No','callback_data':'no'}]]}})[_0x57dbdd(0x1e2)](_0x1e3ce4=>{telegramError(_0x1e3ce4);}),tgBot['on'](_0x57dbdd(0x263),async _0x800a58=>{const _0x507904=_0x57dbdd,_0x365f9a=_0x800a58[_0x507904(0x318)],_0xed7429=_0x800a58['message'];tgBot['answerCallbackQuery'](_0x800a58['id'])['then'](async()=>{const _0x5f0196=_0x507904;_0x365f9a==_0x5f0196(0x240)&&(await tgBot['sendMessage'](_0xed7429[_0x5f0196(0x25d)]['id'],_0x5f0196(0x2f1))[_0x5f0196(0x1e2)](_0x53beb2=>{telegramError(_0x53beb2);}),updateBB(_0x5f0196(0x252))),_0x365f9a=='no'&&await tgBot[_0x5f0196(0x247)](_0xed7429[_0x5f0196(0x25d)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')[_0x5f0196(0x1e2)](_0x39377f=>{telegramError(_0x39377f);});}),tgBot['removeListener'](_0x507904(0x263));}));}),tgBot[_0x17502c(0x3a7)](/\/toggle/,_0x1d17e6=>{const _0x4b0383=_0x17502c;if(!validateTelegram(_0x1d17e6))return;tgBot[_0x4b0383(0x273)]('callback_query');const _0x33ce0e=getBotsWithMode();if(_0x33ce0e[_0x4b0383(0x278)]==0x0)tgBot[_0x4b0383(0x247)](_0x1d17e6[_0x4b0383(0x25d)]['id'],_0x4b0383(0x2cd))[_0x4b0383(0x1e2)](_0x45b7c4=>{telegramError(_0x45b7c4);});else{let _0x15d2ed=[],_0x2b05b8=[];const _0x19beeb=0x2;let _0x38faf6=0x0;_0x33ce0e[_0x4b0383(0x306)]((_0x272203,_0x61e735)=>{const _0x2898b9=_0x4b0383;if(_0x61e735%_0x19beeb==0x0)_0x2b05b8=[];_0x2b05b8[_0x2898b9(0x2aa)]({'text':'Bot\x20'+_0x272203[_0x2898b9(0x2d2)]+'\x20('+_0x272203[_0x2898b9(0x28e)]+')','callback_data':_0x272203[_0x2898b9(0x2d2)]}),_0x61e735%_0x19beeb==0x0&&(_0x15d2ed[_0x38faf6]=_0x2b05b8,_0x38faf6++);}),tgBot[_0x4b0383(0x247)](_0x1d17e6[_0x4b0383(0x25d)]['id'],_0x4b0383(0x2fa),{'reply_markup':{'inline_keyboard':_0x15d2ed}})[_0x4b0383(0x1e2)](_0x157b70=>{telegramError(_0x157b70);}),tgBot['on']('callback_query',async _0xf0c771=>{const _0x10dc69=_0x4b0383,_0x1eebc0=_0xf0c771['data'],_0x43134c=_0xf0c771['message'];tgBot['answerCallbackQuery'](_0xf0c771['id'])[_0x10dc69(0x219)](async()=>{const _0x15cbac=_0x10dc69,_0x43f54b=_0x33ce0e[_0x15cbac(0x20e)](_0x46f38c=>_0x46f38c['botID']==_0x1eebc0),_0x3ac1cf=_0x43f54b['mode']=='auto'?_0x15cbac(0x389):_0x15cbac(0x1d2);tgBot[_0x15cbac(0x247)](_0x43134c[_0x15cbac(0x25d)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x1eebc0+_0x15cbac(0x387)+_0x3ac1cf+_0x15cbac(0x2db))[_0x15cbac(0x1e2)](_0x50d92b=>{telegramError(_0x50d92b);}),toggleBotMode(_0x1eebc0);}),tgBot['removeListener'](_0x10dc69(0x263));});}}),tgBot[_0x17502c(0x3a7)](/\/names/,_0x24dd7e=>{const _0x5a0b60=_0x17502c;if(!validateTelegram(_0x24dd7e))return;let _0x55fb01='';config[_0x5a0b60(0x306)](_0x572c12=>{const _0x1181ae=_0x5a0b60;_0x55fb01+='Bot\x20'+_0x572c12[_0x1181ae(0x2d2)]+':\x20'+_0x572c12[_0x1181ae(0x370)]+'\x0a';}),tgBot[_0x5a0b60(0x247)](_0x24dd7e[_0x5a0b60(0x25d)]['id'],_0x55fb01,{'parse_mode':_0x5a0b60(0x3ac)})['catch'](_0x35c889=>{telegramError(_0x35c889);});}),tgBot[_0x17502c(0x3a7)](/\/disable/,_0x520a8e=>{const _0x6532fe=_0x17502c;if(!validateTelegram(_0x520a8e))return;tgBot[_0x6532fe(0x247)](_0x520a8e[_0x6532fe(0x25d)]['id'],_0x6532fe(0x2a6))[_0x6532fe(0x1e2)](_0x2e1d29=>{telegramError(_0x2e1d29);}),updateSetting('telegramEnabled',![]);}),tgBot['onText'](/\/help/,_0x2ac514=>{const _0x1e1b57=_0x17502c;if(!validateTelegram(_0x2ac514))return;tgBot[_0x1e1b57(0x247)](_0x2ac514['chat']['id'],_0x31702b)[_0x1e1b57(0x1e2)](_0x16eeca=>{telegramError(_0x16eeca);});}),tgBot['on']('polling_error',_0x587de4=>{const _0x15e5db=_0x17502c;_0x587de4['toString']()[_0x15e5db(0x1ea)](_0x15e5db(0x285))&&(logger[_0x15e5db(0x355)]('Invalid\x20Telegram\x20token'),tgBot[_0x15e5db(0x274)](),tgBot=null,io['to']('botmanager')[_0x15e5db(0x354)]('notification',_0x15e5db(0x25e)));}),process[_0x17502c(0x37d)](_0x17502c(0x24d),()=>{const _0x415b4f=_0x17502c;if(tgBot)tgBot[_0x415b4f(0x274)]();process[_0x415b4f(0x27b)](0x1);}),process['once'](_0x17502c(0x1e3),()=>{const _0x4cd4c4=_0x17502c;if(tgBot)tgBot[_0x4cd4c4(0x274)]();process[_0x4cd4c4(0x27b)](0x1);});}}function disableTelegram(){const _0x2afe9d=_0x1e373c;tgBot&&(tgBot[_0x2afe9d(0x274)](),tgBot=null);}function sendTelegram(_0x58072b,_0x140e0c){const _0x31bad2=_0x1e373c;if(settings['telegramEnabled']){if(settings[_0x31bad2(0x22d)]==_0x31bad2(0x2d1)||(_0x140e0c[_0x31bad2(0x351)]==_0x31bad2(0x1db)||_0x140e0c[_0x31bad2(0x351)]==_0x31bad2(0x266)||_0x140e0c[_0x31bad2(0x351)]==_0x31bad2(0x3b4))&&settings[_0x31bad2(0x22d)]=='alerts'||_0x140e0c[_0x31bad2(0x351)]==_0x31bad2(0x339)&&settings['telegramEvents']==_0x31bad2(0x1fe)){if(tgBot&&settings[_0x31bad2(0x331)]){if(_0x140e0c[_0x31bad2(0x341)])tgBot['sendMessage'](settings[_0x31bad2(0x331)],_0x140e0c['botname']+_0x31bad2(0x2f9)+_0x140e0c['event'])['catch'](_0x5add97=>{telegramError(_0x5add97);});else tgBot[_0x31bad2(0x247)](settings[_0x31bad2(0x331)],_0x31bad2(0x28a)+_0x58072b+_0x31bad2(0x2f9)+_0x140e0c[_0x31bad2(0x276)])[_0x31bad2(0x1e2)](_0x57bf9c=>{telegramError(_0x57bf9c);});}}}}async function sendTelegramMsg(_0x2006c8,_0x417f44=_0x1e373c(0x3ac)){const _0x28efff=_0x1e373c;return settings[_0x28efff(0x35f)]&&tgBot&&settings[_0x28efff(0x331)]?(await tgBot[_0x28efff(0x247)](settings['telegramChatId'],_0x2006c8,{'parse_mode':_0x417f44})[_0x28efff(0x1e2)](_0x11fded=>{telegramError(_0x11fded);}),!![]):![];}function getDeviceWithIp(_0x280c05){return devices['find'](_0x37a6b3=>_0x37a6b3['ip']===_0x280c05);}function temporaryAccess2FA(_0x4e8365,_0x57b090){const _0x2d4f1e=_0x1e373c;let _0x298e3b=new Date(),_0x4ad3d9=![];if(lastIpApproval){if(_0x298e3b-lastIpApproval<0x1388)_0x4ad3d9=!![];}lastIpApproval=new Date();if(_0x4ad3d9)return;tgBot&&settings[_0x2d4f1e(0x331)]&&(tgBot[_0x2d4f1e(0x273)](_0x2d4f1e(0x263)),tgBot[_0x2d4f1e(0x247)](settings[_0x2d4f1e(0x331)],_0x2d4f1e(0x267)+normalizeIP(_0x57b090)[_0x2d4f1e(0x322)]+_0x2d4f1e(0x2c9),{'parse_mode':_0x2d4f1e(0x3ac),'reply_markup':{'inline_keyboard':[[{'text':_0x2d4f1e(0x37f),'callback_data':'5'},{'text':_0x2d4f1e(0x2bf),'callback_data':'15'},{'text':_0x2d4f1e(0x25f),'callback_data':'30'},{'text':'reject','callback_data':_0x2d4f1e(0x2f5)}]]}})['catch'](_0x48d48c=>{telegramError(_0x48d48c);}),tgBot['on']('callback_query',async _0x282e31=>{const _0x1209c8=_0x2d4f1e,_0x19e4f3=_0x282e31['data'],_0x551b96=_0x282e31[_0x1209c8(0x21a)];tgBot['answerCallbackQuery'](_0x282e31['id'])[_0x1209c8(0x219)](async()=>{const _0x29b9cf=_0x1209c8;devices[_0x4e8365]['telegramIpApproval']={'clientip':_0x57b090,'timestamp':new Date()['getTime'](),'expiry':_0x19e4f3},_0x19e4f3!=_0x29b9cf(0x2f5)?(await tgBot[_0x29b9cf(0x247)](_0x551b96[_0x29b9cf(0x25d)]['id'],_0x29b9cf(0x1fc)+_0x19e4f3+'\x20minutes',{'parse_mode':'HTML'})[_0x29b9cf(0x1e2)](_0x20f851=>{telegramError(_0x20f851);}),io['to'](_0x4e8365)['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x29b9cf(0x247)](_0x551b96[_0x29b9cf(0x25d)]['id'],_0x29b9cf(0x315))['catch'](_0x5f5560=>{telegramError(_0x5f5560);}),io['to'](_0x4e8365)[_0x29b9cf(0x354)](_0x29b9cf(0x1e6),{'access':{'allow':![],'reason':_0x29b9cf(0x30c),'token':null}}));}),tgBot[_0x1209c8(0x273)](_0x1209c8(0x263));}));}function loginAccess2FA(_0x10f095,_0x5f3757){const _0x1f146b=_0x1e373c;tgBot&&settings[_0x1f146b(0x331)]&&(tgBot[_0x1f146b(0x273)](_0x1f146b(0x263)),tgBot[_0x1f146b(0x247)](settings[_0x1f146b(0x331)],_0x1f146b(0x36a)+normalizeIP(_0x5f3757)[_0x1f146b(0x322)]+'</b>\x20?',{'parse_mode':_0x1f146b(0x3ac),'reply_markup':{'inline_keyboard':[[{'text':_0x1f146b(0x28d),'callback_data':loginExpiry},{'text':_0x1f146b(0x2f5),'callback_data':'reject'}]]}})[_0x1f146b(0x1e2)](_0x4efd92=>{telegramError(_0x4efd92);}),tgBot['on']('callback_query',async _0x3fac9e=>{const _0x13fb5b=_0x1f146b,_0x329f44=_0x3fac9e[_0x13fb5b(0x318)],_0x1b7d78=_0x3fac9e[_0x13fb5b(0x21a)];tgBot[_0x13fb5b(0x3b1)](_0x3fac9e['id'])['then'](async()=>{const _0x5ca15c=_0x13fb5b;devices[_0x10f095][_0x5ca15c(0x260)]={'clientip':_0x5f3757,'timestamp':new Date()[_0x5ca15c(0x2e9)](),'expiry':_0x329f44},_0x329f44!=_0x5ca15c(0x2f5)?(await tgBot[_0x5ca15c(0x247)](_0x1b7d78['chat']['id'],_0x5ca15c(0x39b),{'parse_mode':'HTML'})[_0x5ca15c(0x1e2)](_0x1dbda3=>{telegramError(_0x1dbda3);}),io['to'](_0x10f095)[_0x5ca15c(0x354)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x5ca15c(0x247)](_0x1b7d78[_0x5ca15c(0x25d)]['id'],_0x5ca15c(0x288))['catch'](_0x403858=>{telegramError(_0x403858);}),io['to'](_0x10f095)[_0x5ca15c(0x354)]('status',{'access':{'allow':![],'reason':_0x5ca15c(0x346),'token':null}}));}),tgBot['removeListener'](_0x13fb5b(0x263));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4ef187=_0x1e373c;return dbConfig['get'](_0x4ef187(0x1f5))[_0x4ef187(0x1f8)](_0x4ef187(0x2d2))[_0x4ef187(0x242)]({'status':_0x4ef187(0x34a)})[_0x4ef187(0x210)]()||[];}function getDisabledBots(){const _0x2596df=_0x1e373c;return dbConfig['get'](_0x2596df(0x1f5))[_0x2596df(0x1f8)](_0x2596df(0x2d2))[_0x2596df(0x242)]({'status':_0x2596df(0x2ac)})[_0x2596df(0x210)]()||[];}function getBotAttributes(_0x5e688e){const _0x3ee63d=_0x1e373c;let _0x534e9b={};const _0x530313=configpath+'bot-'+_0x5e688e+'-config.json',_0x126096=fs[_0x3ee63d(0x27e)](_0x530313);if(_0x126096){const _0x194a18=fs[_0x3ee63d(0x3a3)](_0x530313);try{const _0x3fc4e6=JSON[_0x3ee63d(0x1e4)](_0x194a18),_0x4b53b6=_0x3fc4e6?_0x3fc4e6['bot'][0x0][_0x3ee63d(0x254)]:![];_0x534e9b[_0x3ee63d(0x28e)]=_0x4b53b6?_0x3ee63d(0x1d2):_0x3ee63d(0x389),_0x534e9b[_0x3ee63d(0x370)]=_0x3fc4e6?_0x3fc4e6[_0x3ee63d(0x32c)][0x0][_0x3ee63d(0x370)]:_0x3ee63d(0x28a)+_0x5e688e;}catch(_0x1df96a){_0x534e9b['mode']=_0x3ee63d(0x389),_0x534e9b[_0x3ee63d(0x370)]=_0x3ee63d(0x28a)+_0x5e688e;}}else _0x534e9b[_0x3ee63d(0x28e)]=_0x3ee63d(0x389),_0x534e9b[_0x3ee63d(0x370)]=_0x3ee63d(0x28a)+_0x5e688e;return _0x534e9b;}function getBotsWithMode(){const _0x31cdf2=_0x1e373c,_0x348bfe=dbConfig[_0x31cdf2(0x361)]('bots')[_0x31cdf2(0x1f8)](_0x31cdf2(0x2d2))[_0x31cdf2(0x210)]()||[];return _0x348bfe['forEach'](_0x220e5b=>{const _0x50f291=_0x31cdf2;let _0x137649=getBotAttributes(_0x220e5b[_0x50f291(0x2d2)]);_0x220e5b[_0x50f291(0x28e)]=_0x137649[_0x50f291(0x28e)];}),_0x348bfe;}function getBotExchanges(){const _0x445201=_0x1e373c;let _0x5c3224=[];const _0x55a636=dbConfig[_0x445201(0x361)](_0x445201(0x1f5))[_0x445201(0x1f8)](_0x445201(0x2d2))['value']()||[];_0x55a636[_0x445201(0x306)](_0x5267f5=>{const _0x5823e8=_0x445201;if(_0x5267f5['status']==_0x5823e8(0x34a)){const _0x33c836=configpath+_0x5823e8(0x236)+_0x5267f5['botID']+_0x5823e8(0x1e8),_0x53629e=fs[_0x5823e8(0x27e)](_0x33c836);let _0x483d14;if(_0x53629e){const _0x328ff4=fs[_0x5823e8(0x3a3)](_0x33c836);try{const _0x5a69af=JSON[_0x5823e8(0x1e4)](_0x328ff4);_0x483d14=_0x5a69af?_0x5a69af['bot'][0x0][_0x5823e8(0x3ae)]:null;}catch(_0x6797cc){}}if(_0x483d14)_0x5c3224[_0x5823e8(0x2aa)](_0x483d14);}});const _0x6354cc=[...new Set(_0x5c3224)][_0x445201(0x391)]();return _0x6354cc;}async function initUser(){const _0x3a5557=_0x1e373c;if(!settings[_0x3a5557(0x232)]){const _0x463935=uuidRandom();mixpanel[_0x3a5557(0x34d)](_0x463935),updateSetting(_0x3a5557(0x232),_0x463935);}}async function initSecure(){const _0x192d71=_0x1e373c;let _0x5dfed9=getSecure();if(!_0x5dfed9[_0x192d71(0x26d)](_0x192d71(0x319))){let _0x3586ee=await generateKeys();_0x5dfed9['publicKey']=_0x3586ee['publicKey'],_0x5dfed9[_0x192d71(0x33c)]=_0x3586ee[_0x192d71(0x33c)],_0x5dfed9[_0x192d71(0x319)]=crypto['randomBytes'](0x20)[_0x192d71(0x1dd)](_0x192d71(0x220));;storeSecure(_0x5dfed9);}}function getSettings(){const _0x39765f=_0x1e373c;return dbSettings[_0x39765f(0x361)](_0x39765f(0x24f))[_0x39765f(0x210)]()||{};}function getSecure(){const _0x93b6c9=_0x1e373c;return dbSecure['get'](_0x93b6c9(0x340))[_0x93b6c9(0x210)]()||{};}function getBlacklist(){const _0x321e24=_0x1e373c;return dbSecure['get']('blacklist')[_0x321e24(0x210)]()||[];}function broadcastToBots(_0x16157b,_0xc08155){config['forEach'](_0x5d1157=>{const _0xf11dcc=_0x42c2;if(_0x5d1157[_0xf11dcc(0x1e6)]=='enabled'&&_0x5d1157[_0xf11dcc(0x1da)]==_0xf11dcc(0x29b)||_0x5d1157['status']==_0xf11dcc(0x272)&&_0x5d1157['live']==_0xf11dcc(0x29b)){if(pid[_0x5d1157['botID']])pid[_0x5d1157[_0xf11dcc(0x2d2)]]['send']({[_0x16157b]:_0xc08155});}});}function storeSettings(_0x5decbc,_0x52b74d=![]){const _0x5aac46=_0x1e373c;_0x5decbc={...settings,..._0x5decbc};if(_0x52b74d&&_0x5decbc[_0x5aac46(0x213)]!=_0x5aac46(0x34b)&&_0x5decbc['bbPassword']!=_0x5aac46(0x313)&&_0x5decbc[_0x5aac46(0x213)]!=''){const _0x450863=crypt[_0x5aac46(0x292)](secure[_0x5aac46(0x33c)],_0x5decbc['bbPassword'])[_0x5aac46(0x21a)][_0x5aac46(0x1ee)]('@')[0x0],_0x204665=bcrypt['hashSync'](_0x450863,saltRounds);_0x5decbc={..._0x5decbc,'bbPassword':_0x204665};}if(_0x52b74d&&_0x5decbc[_0x5aac46(0x226)]!=_0x5aac46(0x34b)&&_0x5decbc[_0x5aac46(0x226)]!=_0x5aac46(0x313)&&_0x5decbc[_0x5aac46(0x226)]!=''){const _0x38b063=crypt['decrypt'](secure[_0x5aac46(0x33c)],_0x5decbc[_0x5aac46(0x226)])[_0x5aac46(0x21a)]['split']('@')[0x0];_0x5decbc={..._0x5decbc,'telegramToken':_0x38b063};}const _0x3be970=_0x5decbc['telegramToken']!=_0x5aac46(0x34b)&&_0x5decbc['telegramToken']!=settings['telegramToken']||_0x5decbc[_0x5aac46(0x2d4)]!=settings['telegramUsername'],_0x8bb980=_0x5decbc['telegramToken']==''||_0x5decbc[_0x5aac46(0x2d4)]=='';if(_0x3be970)_0x5decbc[_0x5aac46(0x22d)]='all';for(const [_0x5c85a4,_0x41e1b0]of Object['entries'](_0x5decbc)){if(_0x5c85a4=='telegramToken'&&_0x41e1b0=='************'){_0x5decbc['telegramToken']=settings[_0x5aac46(0x226)];continue;};if(_0x5c85a4=='bbPassword'&&_0x41e1b0==_0x5aac46(0x34b)){_0x5decbc[_0x5aac46(0x213)]=settings[_0x5aac46(0x213)];continue;};dbSettings[_0x5aac46(0x3a8)](_0x5aac46(0x27a)+_0x5c85a4,_0x41e1b0)[_0x5aac46(0x24c)]();}settings=_0x5decbc,io['to']('botmanager')[_0x5aac46(0x354)](_0x5aac46(0x24f),cleanSettings()),broadcastToBots(_0x5aac46(0x3a5),settings[_0x5aac46(0x3a5)]),broadcastToBots('onepagemode',settings[_0x5aac46(0x372)]);if(_0x3be970&&!_0x8bb980)initTelegram();if(_0x3be970&&_0x8bb980)disableTelegram();getAllClients()[_0x5aac46(0x306)](_0x5553f5=>{const _0x864eed=_0x5aac46;getSocket(_0x5553f5['id'])[_0x864eed(0x354)](_0x864eed(0x1e6),{'access':{'allow':![],'reason':_0x864eed(0x1ef),'token':null}});});}function updateSetting(_0x5b8a94,_0x1fdaae){const _0x217cdf=_0x1e373c;dbSettings['set']('settings.'+_0x5b8a94,_0x1fdaae)[_0x217cdf(0x24c)](),settings=getSettings(),io['to'](_0x217cdf(0x3a2))[_0x217cdf(0x354)](_0x217cdf(0x24f),cleanSettings());}function storeSecure(_0x23e935){const _0x4c252c=_0x1e373c;dbSecure[_0x4c252c(0x361)](_0x4c252c(0x340))['push'](_0x23e935)['write'](),secure=_0x23e935;}function addBlacklist(_0x76f212){const _0x26f09f=_0x1e373c;cleanBlacklist();let _0x43e612;devices[_0x76f212][_0x26f09f(0x27d)]?_0x43e612=Math[_0x26f09f(0x39c)](devices[_0x76f212]['telegramIpApproval'][_0x26f09f(0x326)],loginExpiry):_0x43e612=loginExpiry,dbSecure[_0x26f09f(0x361)](_0x26f09f(0x281))[_0x26f09f(0x2aa)]({'expiry':new Date()[_0x26f09f(0x2e9)]()+_0x43e612*0x3c*0x3e8,'token':devices[_0x76f212][_0x26f09f(0x291)]['token']})[_0x26f09f(0x24c)](),blacklist=dbSecure[_0x26f09f(0x361)]('blacklist')[_0x26f09f(0x210)]();}function cleanBlacklist(){const _0x37802a=_0x1e373c;let _0x38732a=dbSecure[_0x37802a(0x361)](_0x37802a(0x281))[_0x37802a(0x1d9)]()[_0x37802a(0x210)](),_0xf17a86=new Date()[_0x37802a(0x2e9)]();_0x38732a[_0x37802a(0x306)](_0x1f016c=>{const _0x208e2b=_0x37802a;_0x1f016c[_0x208e2b(0x326)]<_0xf17a86&&dbSecure[_0x208e2b(0x361)](_0x208e2b(0x281))[_0x208e2b(0x32b)]({'expiry':_0x1f016c[_0x208e2b(0x326)]})[_0x208e2b(0x24c)]();});}function initStates(){const _0x1a4c02=_0x1e373c;let _0x374288=getConfiguration();_0x374288[_0x1a4c02(0x306)](_0x5c165e=>{const _0x3ba371=_0x1a4c02;_0x5c165e[_0x3ba371(0x1da)]=_0x3ba371(0x2c6);}),storeConfiguration(_0x374288);}function onKeys(){const _0x2914d9=new RSA();return new Promise(_0x91090a=>{const _0x51755c=_0x42c2;_0x2914d9[_0x51755c(0x2fe)]()['then'](_0x34859a=>{_0x91090a(_0x34859a);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x4187ce=_0x1e373c;let _0x5b0866=getSettings(),_0x42d228=![];!_0x5b0866[_0x4187ce(0x26d)]('lastmsgtelegram')&&(_0x5b0866['lastmsgtelegram']=0x0,_0x42d228=!![]);!_0x5b0866[_0x4187ce(0x26d)]('lastmsgemitted')&&(_0x5b0866[_0x4187ce(0x328)]=0x0,_0x42d228=!![]);!_0x5b0866[_0x4187ce(0x26d)](_0x4187ce(0x39f))&&(_0x5b0866['latestversion']=_0x4187ce(0x2a0),_0x42d228=!![]);!_0x5b0866[_0x4187ce(0x26d)](_0x4187ce(0x372))&&(_0x5b0866['onepagemode']=![],_0x42d228=!![]);if(_0x42d228)storeSettings(_0x5b0866);try{fs[_0x4187ce(0x2da)](configbackuppath,{'withFileTypes':!![]})[_0x4187ce(0x306)](_0x3f296e=>{const _0x5ee032=_0x4187ce;if(!_0x3f296e[_0x5ee032(0x214)]()){if(!_0x3f296e[_0x5ee032(0x293)]['startsWith'](_0x5ee032(0x258)))fs[_0x5ee032(0x294)](configbackuppath+_0x3f296e['name']);}else fs[_0x5ee032(0x2fd)](configbackuppath+_0x3f296e[_0x5ee032(0x293)],{'recursive':!![]});});}catch(_0x4bef00){logger[_0x4187ce(0x2fb)](_0x4187ce(0x2b2),_0x4bef00);}}function storeConfiguration(_0x3e21b3){const _0x230692=_0x1e373c;dbConfig[_0x230692(0x361)]('bots')[_0x230692(0x32b)]()[_0x230692(0x24c)](),dbConfig[_0x230692(0x361)](_0x230692(0x1f5))['push'](..._0x3e21b3)[_0x230692(0x24c)](),config=_0x3e21b3;}function resetPassword(){const _0x3b2775=_0x1e373c;tgBot&&settings[_0x3b2775(0x331)]&&(tgBot[_0x3b2775(0x273)](_0x3b2775(0x263)),tgBot[_0x3b2775(0x247)](settings[_0x3b2775(0x331)],_0x3b2775(0x2f3),{'parse_mode':_0x3b2775(0x3ac),'reply_markup':{'inline_keyboard':[[{'text':_0x3b2775(0x240),'callback_data':_0x3b2775(0x240)},{'text':'no','callback_data':'no'}]]}})[_0x3b2775(0x1e2)](_0xa19605=>{telegramError(_0xa19605);}),tgBot['on']('callback_query',async _0x2a4434=>{const _0x1c8d9e=_0x3b2775,_0x2bfc9c=_0x2a4434[_0x1c8d9e(0x318)],_0x151751=_0x2a4434[_0x1c8d9e(0x21a)];tgBot[_0x1c8d9e(0x3b1)](_0x2a4434['id'])[_0x1c8d9e(0x219)](async()=>{const _0x3d06a6=_0x1c8d9e;if(_0x2bfc9c!='no'){const _0x2f5a7b=0xf,_0x1757f8=_0x3d06a6(0x3ad),_0x438e0e=Array[_0x3d06a6(0x26e)](crypto[_0x3d06a6(0x363)](new Uint32Array(_0x2f5a7b)))['map'](_0x27cf65=>_0x1757f8[_0x27cf65%_0x1757f8[_0x3d06a6(0x278)]])['join'](''),_0x3fbd05=bcrypt[_0x3d06a6(0x241)](_0x438e0e,saltRounds);storeSettings({'bbPassword':_0x3fbd05}),await tgBot[_0x3d06a6(0x247)](_0x151751[_0x3d06a6(0x25d)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x438e0e,{'parse_mode':'HTML'})[_0x3d06a6(0x1e2)](_0x4e1c8b=>{telegramError(_0x4e1c8b);});}else await tgBot[_0x3d06a6(0x247)](_0x151751[_0x3d06a6(0x25d)]['id'],_0x3d06a6(0x2ef))[_0x3d06a6(0x1e2)](_0x35c49a=>{telegramError(_0x35c49a);});}),tgBot[_0x1c8d9e(0x273)]('callback_query');}));}async function confirmRestore(_0x472b48,_0x32b116){const _0x2281f7=_0x1e373c;io['to'](_0x2281f7(0x3a2))[_0x2281f7(0x354)]('notification',_0x2281f7(0x320),'success'),tgBot&&settings[_0x2281f7(0x331)]&&(tgBot[_0x2281f7(0x273)](_0x2281f7(0x263)),await tgBot[_0x2281f7(0x247)](settings[_0x2281f7(0x331)],_0x2281f7(0x24e),{'parse_mode':_0x2281f7(0x3ac),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x2281f7(0x240)},{'text':'no','callback_data':'no'}]]}})[_0x2281f7(0x1e2)](_0x492393=>{telegramError(_0x492393);}),tgBot['on']('callback_query',async _0x40ac6a=>{const _0x3540f0=_0x2281f7,_0x20ddde=_0x40ac6a[_0x3540f0(0x318)],_0x4197a5=_0x40ac6a[_0x3540f0(0x21a)];tgBot[_0x3540f0(0x3b1)](_0x40ac6a['id'])[_0x3540f0(0x219)](async()=>{const _0x31705d=_0x3540f0;_0x20ddde=='yes'?(await tgBot[_0x31705d(0x247)](_0x4197a5[_0x31705d(0x25d)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':'HTML'})[_0x31705d(0x1e2)](_0x3a5d59=>{telegramError(_0x3a5d59);}),unzipFile(_0x472b48,_0x32b116)):(logger[_0x31705d(0x2fb)](_0x31705d(0x3b7)),await tgBot[_0x31705d(0x247)](_0x4197a5['chat']['id'],_0x31705d(0x3b7))[_0x31705d(0x1e2)](_0xc7fa01=>{telegramError(_0xc7fa01);}));}),tgBot[_0x3540f0(0x273)](_0x3540f0(0x263));}));}function getServerTime(){const _0x1fddfd=_0x1e373c,_0x2c7b34=new Date();return _0x2c7b34[_0x1fddfd(0x330)]()+'/'+(_0x2c7b34[_0x1fddfd(0x1dc)]()+0x1)['toString']()[_0x1fddfd(0x378)](0x2,'0')+'/'+_0x2c7b34[_0x1fddfd(0x28b)]()['toString']()[_0x1fddfd(0x378)](0x2,'0')+'\x20'+_0x2c7b34[_0x1fddfd(0x1e0)]()['toString']()[_0x1fddfd(0x378)](0x2,'0')+':'+_0x2c7b34[_0x1fddfd(0x261)]()[_0x1fddfd(0x1dd)]()[_0x1fddfd(0x378)](0x2,'0')+':'+_0x2c7b34[_0x1fddfd(0x2c4)]()[_0x1fddfd(0x1dd)]()[_0x1fddfd(0x378)](0x2,'0');}function getTimeStamp(){const _0x22e91e=_0x1e373c,_0x4b66ac=shiftedTime();return _0x4b66ac[_0x22e91e(0x330)]()+'/'+(_0x4b66ac[_0x22e91e(0x1dc)]()+0x1)[_0x22e91e(0x1dd)]()['padStart'](0x2,'0')+'/'+_0x4b66ac[_0x22e91e(0x28b)]()[_0x22e91e(0x1dd)]()[_0x22e91e(0x378)](0x2,'0')+'\x20'+_0x4b66ac[_0x22e91e(0x1e0)]()[_0x22e91e(0x1dd)]()[_0x22e91e(0x378)](0x2,'0')+':'+_0x4b66ac[_0x22e91e(0x261)]()[_0x22e91e(0x1dd)]()['padStart'](0x2,'0')+':'+_0x4b66ac[_0x22e91e(0x2c4)]()[_0x22e91e(0x1dd)]()[_0x22e91e(0x378)](0x2,'0');}function getCleanTimeStamp(){const _0x56392f=_0x1e373c,_0x157b3e=shiftedTime();return _0x157b3e[_0x56392f(0x330)]()+(_0x157b3e[_0x56392f(0x1dc)]()+0x1)[_0x56392f(0x1dd)]()[_0x56392f(0x378)](0x2,'0')+_0x157b3e[_0x56392f(0x28b)]()[_0x56392f(0x1dd)]()[_0x56392f(0x378)](0x2,'0')+'-'+_0x157b3e[_0x56392f(0x1e0)]()[_0x56392f(0x1dd)]()['padStart'](0x2,'0')+_0x157b3e[_0x56392f(0x261)]()[_0x56392f(0x1dd)]()[_0x56392f(0x378)](0x2,'0')+_0x157b3e[_0x56392f(0x2c4)]()[_0x56392f(0x1dd)]()[_0x56392f(0x378)](0x2,'0');}function _0x3b36(){const _0x33365b=['NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','<b>Balance\x20Bot\x20Status:</b>\x0a','all','botID','lowdb','telegramUsername','listen','child_process','\x20only\x0a','Markdown','version','readdirSync','\x20mode','#RES#\x20if\x20running\x20locally\x0a','Invalid\x20username\x20or\x20IP\x20address','stop','Ok,\x20will\x20send\x20alert\x20notifications\x20only','notification','bb-secure.json','/:bot/configuration','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','No\x20authentication\x20token','bb-settings.json','Bot\x20Mgr\x20>\x20','username','binary','getTime','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','alerts','path','ipv6','Password\x20reset\x20rejected','deleteHistoryAlerts','Starting\x20Balance\x20Bot\x20reinstallation','bbvReceive','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','node-telegram-bot-api','reject','Backup\x20file\x20unzipped\x20and\x20stored','min','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','\x20>\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','debug','127.0.0.1','rmSync','generateKeyPairAsync','index.html','login\x20token\x20valid','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','express-fileupload','files','DEFLATE','Ok,\x20will\x20send\x20order\x20notifications\x20only','forEach','timestamp','createServer','post','reset-password','isValid','temporary\x20access\x20rejected','/enable\x20-\x20enable\x20notifications\x0a','apiPassword','environment','Alerts','login','axios','***','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Temporary\x20access\x20rejected','Server','Starting\x20(','data','secret','conn','internal','function','/update\x20-\x20update\x20Balance\x20Bot\x0a','All\x20bots','add-bot','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','util','show','storeConfiguration','login\x20not\x20required','host','expiry','token','lastmsgemitted','argv','IPv4','remove','bot','/:bot/history','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','get-messages','getFullYear','telegramChatId','/upload-backup','Unauthorized\x20attempt\x20to\x20store\x20configuration','date-fns','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','backupfile','Unauthorized\x20attempt\x20to\x20download\x20','Invalid\x20authentication\x20token\x20(1)','order','uncaughtException','reinstall-bb','privateKey','2FA\x20login\x20token\x20generated','::1','temporaryAccessAllowed','secure','showname','Starting\x20#RED#Balance\x20Bot\x20v','whitelistEnabled','/off\x20-\x20stop\x20bot(s)\x0a','address','2FA\x20login\x20rejected','Unauthorized\x20attempt\x20to\x20update\x20settings','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','toIPv4Address','enabled','************','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','alias','448165JzwXkC','.zip','\x20|\x20client:\x20...','type','ipc','RSA-OAEP','emit','full','startsWith','title','api-eu.mixpanel.com','\x1b[31m','/help\x20-\x20show\x20available\x20commands\x0a','(((.+)+)+)+$','number','match','jsonwebtoken','telegramEnabled','restore-backup-file','get','toggle-bot-mode','randomFillSync','8cQFSKo','/:bot/coins','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Error\x20while\x20deleting\x20config\x20files:\x20','#RES#\x20','copyFileSync','Allow\x20login\x20from\x20IP\x20address\x20<b>','build2','Restore\x20backup\x20file\x20','https://api.ipify.org?format=json','inherit','pidRefreshToken','botname','user','onepagemode','75PhSMyL','Notifications\x20disabled\x0a','/download/:type','-results.json','build','padStart','store-settings','verify','delete-alerts','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','once','Unauthorized\x20attempt\x20to\x20confirm\x20message','5\x20min','add','uuid','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','send','getStartingBalances','Invalid\x20authentication\x20token\x20(2)','\x20to\x20','\x20|\x20','manual','production','Starting\x20Balance\x20Bot\x20update','3387228AxRxmm','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','/restart\x20-\x20restart\x20bot(s)\x0a','-events.json','use','sort','updatebotmanager','User\x20has\x20been\x20validated','All','update','test','compareSync','search','getUTCHours','output-002.log','Login\x20accepted','max','mtime','\x1b[34m','latestversion','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','botmanager','readFileSync','/metrics\x20-\x20show\x20bot\x20performance\x0a','timeshift','logs/','onText','set','/output-000.log','clients','connected','HTML','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','exchange','You\x20can\x20use\x20the\x20following\x20commands:\x0a','range','answerCallbackQuery','/names\x20-\x20show\x20bot\x20names\x0a','kind','success','any','track','Restore\x20process\x20aborted','auto','Token\x20blacklisted','Your\x20installation\x20is\x20already\x20up\x20to\x20date','update-bot','restart','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','size','cloneDeep','live','error','getMonth','toString','stringify','kill','getHours','init','catch','SIGTERM','parse','84536EPgyuC','status','mkdirSync','-config.json','server','includes','defaults','store-fiat','bbvNew','split','reload','12mvoboD','pidExpireLogin','family','1000','resetHistory','bots','get-logs','3000','sortBy','generate','static','request','Access\x20enabled\x20for\x20','Error:\x20Invalid\x20argument\x20','orders','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Orders','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','2FA\x20login\x20required','env','versions','slice','2FA\x20required','/disable\x20-\x20disable\x20notifications\x0a','sendPortfolioTelegram','logout','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','socket','telegram','Logged\x20out\x20user\x20...','find','whitelist','value','$1_$2_$3','output-001.log','bbPassword','isDirectory','loginRequired','placeOrder','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','join','then','message','*$1*','lowdb/adapters/FileSync','statSync','Idling\x20(','sign','hex','Unauthorized\x20attempt\x20to\x20add\x20bot','Disabled\x20Bot\x20','Failed\x20to\x20download\x20','\x20(1)','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','telegramToken','#RES#\x20if\x20running\x20on\x20server','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','exec','-----------------------------------------------------------------------------------','Unauthorized\x20attempt\x20to\x20log\x20out','node','telegramEvents','Yes','invalid\x20credentials','download','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','userid','referer','remoteAddress','backup-full','bot-','toggleBotMode','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','update-bb','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','sha256','format','replace','http','RSA','yes','hashSync','filter','constructor','port','allow','backup','sendMessage','Notifications\x20enabled\x0a','Invalid\x20IP\x20address','-performance.json',')\x20|\x20Bot\x20','write','SIGINT','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','settings','keys','endsWith','reinstall','hybrid-crypto-js','headless','temporary\x20token\x20generated','Deleted\x20Bot\x20','5524515msxZRK','backup-full@','Unauthorized\x20attempt\x20to\x20delete\x20alerts','/:bot','sendMetricsTelegram','zip/','chat','Invalid\x20Telegram\x20token','30\x20min','telegram2FaApproval','getMinutes','new-disabled','callback_query','\x20(2)','crypto','warning','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','tkn','simple','initclient','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','store','hasOwnProperty','from','logged\x20out','NTBA_FIX_319','file','new','removeListener','stopPolling','log','event','isIPv4MappedAddress','length','assign','settings.','exit','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','telegramIpApproval','existsSync','uuid-random','emitHistory','blacklist','telegrammsg','private','auth','404\x20Not\x20Found','temporary\x20access\x20timeout','bot.js','Login\x20rejected','/:bot/portfolio','Bot\x20','getDate','Unauthorized\x20attempt\x20to\x20get\x20messages','accept','mode','messages','sockets','access','decrypt','name','unlinkSync','password','clientip','publicKey','Backup\x20file\x20uploaded','6b67f3d61ee94b8f5c80b4affef4c4d9','toIPv4MappedAddress','running','handshake','Unauthorized\x20attempt\x20to\x20update\x20bot','Unauthorized\x20login\x20attempt\x20(timeout)','disconnect','0.0.0','Enabled\x20Bot\x20','f2aRequired','Unauthorized\x20attempt\x20to\x20get\x20portfolio','temp/','mixpanel','Notifications\x20disabled','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','\x20|\x20user:\x20...','backup-full.zip','push','bb-config.json','disabled','fork','All\x20bots\x20running\x20right\x20now','bbUsername','bb/','Network\x20Interfaces:','Error\x20removing\x20old\x20backup\x20files:','login\x20token\x20generated','lastmsgtelegram',':\x20Bot\x20Mgr\x20>\x20','headers','writeFileSync','backup/','get-backup-files','get-starting-balances','reason','sendFile','Node.js\x20v','node-zip','15\x20min','place-order','temporary\x20access\x20not\x20allowed','1064056ymuxzP','started','getSeconds','25149660ffhMGg','stopped','output-000.log','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','</b>\x20?','bcryptjs','444509KuoIVq','reset-history','No\x20bots\x20running\x20right\x20now','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a'];_0x3b36=function(){return _0x33365b;};return _0x3b36();}function shiftedTime(){const _0x51c9d5=_0x1e373c,_0x2dc559=new Date();let _0x33f011=_0x2dc559;if(settings['timeshift']&&settings[_0x51c9d5(0x3a5)]!==0x0)_0x33f011=fns[_0x51c9d5(0x380)](_0x2dc559,{'hours':settings['timeshift']});return _0x33f011;}function startScheduler(){const _0x59d7ee=_0x1e373c,_0x5dded1=new Date()[_0x59d7ee(0x399)](),_0x31ca51=shiftedTime()[_0x59d7ee(0x1e0)]();_0x31ca51==0x4&&backupConfigFiles();_0x31ca51==0x0&&rotateLogFiles();_0x5dded1%0x6==0x0&&triggerAnalytics();_0x5dded1%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x2a223b){const _0x169c2f=_0x1e373c;logger['debug'](_0x169c2f(0x36c)+_0x2a223b);const _0x14976b=getBotsWithMode();_0x14976b[_0x169c2f(0x278)]>0x0?confirmRestore(configbackuppath,_0x2a223b):unzipFile(configbackuppath,_0x2a223b);}async function getBackupFiles(_0x13edab=null){const _0x3f77dd=_0x1e373c;let _0x279ecc=[],_0x491511=fs[_0x3f77dd(0x2da)](configbackuppath,{'withFileTypes':!![]});_0x491511[_0x3f77dd(0x391)]((_0x364a05,_0x35f862)=>_0x364a05['name']<_0x35f862[_0x3f77dd(0x293)]?0x1:_0x35f862['name']<_0x364a05[_0x3f77dd(0x293)]?-0x1:0x0),_0x491511[_0x3f77dd(0x306)](_0x4cc380=>{const _0x40ea61=_0x3f77dd;if(!_0x4cc380['isDirectory']()&&_0x4cc380[_0x40ea61(0x293)][_0x40ea61(0x356)]('backup-full@')&&_0x4cc380['name'][_0x40ea61(0x251)](_0x40ea61(0x34f))){const _0x51e525=formatDate(fs[_0x40ea61(0x21d)](configbackuppath+_0x4cc380['name'])[_0x40ea61(0x39d)]);_0x279ecc['push']({'name':_0x4cc380['name'],'mtime':_0x51e525});}});if(_0x13edab)io['to'](_0x13edab)[_0x3f77dd(0x354)]('backup-files',_0x279ecc);else return _0x279ecc;}async function backupConfigFiles(){const _0x21df23=_0x1e373c;await zipFiles(_0x21df23(0x235));const _0x5c7eb9=getCleanTimeStamp();fs[_0x21df23(0x369)](zippath+_0x21df23(0x2a9),configbackuppath+('backup-full@'+_0x5c7eb9+_0x21df23(0x34f)));let _0x4163e8=fs[_0x21df23(0x2da)](configbackuppath,{'withFileTypes':!![]});_0x4163e8[_0x21df23(0x391)]((_0x236717,_0x575ce1)=>_0x236717[_0x21df23(0x293)]<_0x575ce1[_0x21df23(0x293)]?0x1:_0x575ce1[_0x21df23(0x293)]<_0x236717['name']?-0x1:0x0),_0x4163e8[_0x21df23(0x278)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x4163e8[_0x4163e8[_0x21df23(0x278)]-0x1][_0x21df23(0x293)]);}function rotateLogFiles(){const _0x414b2e=_0x1e373c,_0x1f1374=fs[_0x414b2e(0x21d)](logspath+_0x414b2e(0x2c7)),_0x5f0d2c=_0x1f1374[_0x414b2e(0x1d8)]/0x400;if(_0x5f0d2c>0x64){let _0x223619=fs[_0x414b2e(0x2da)](logspath,{'withFileTypes':!![]});_0x223619[_0x414b2e(0x391)]((_0x1f0886,_0x2634a9)=>_0x1f0886['name']<_0x2634a9['name']?0x1:_0x2634a9['name']<_0x1f0886[_0x414b2e(0x293)]?-0x1:0x0),_0x223619[_0x414b2e(0x306)](_0x4df5f0=>{const _0x3e4bde=_0x414b2e;if(_0x4df5f0[_0x3e4bde(0x293)]==_0x3e4bde(0x39a))fs['copyFileSync'](logspath+_0x4df5f0[_0x3e4bde(0x293)],logspath+'output-003.log');if(_0x4df5f0['name']==_0x3e4bde(0x212))fs[_0x3e4bde(0x369)](logspath+_0x4df5f0[_0x3e4bde(0x293)],logspath+'output-002.log');_0x4df5f0[_0x3e4bde(0x293)]==_0x3e4bde(0x2c7)&&(fs[_0x3e4bde(0x369)](logspath+_0x4df5f0[_0x3e4bde(0x293)],logspath+'output-001.log'),fs['writeFileSync'](logspath+_0x4df5f0['name'],''));});}}async function zipFiles(_0xb78357){const _0xbd3a8d=_0x1e373c;let _0x5dd0f2;if(_0xb78357=='logs')_0x5dd0f2=logspath;if(_0xb78357==_0xbd3a8d(0x246))_0x5dd0f2=configpath;if(_0xb78357=='backup-full')_0x5dd0f2=configpath;let _0x2e58f1=fs['readdirSync'](_0x5dd0f2,{'withFileTypes':!![]});const _0x314aa5=new require(_0xbd3a8d(0x2be))();_0x2e58f1['forEach'](_0x4310cf=>{const _0x180d86=_0xbd3a8d;if(!_0x4310cf[_0x180d86(0x214)]()){let _0x52e6e6=fs[_0x180d86(0x3a3)](_0x5dd0f2+_0x4310cf[_0x180d86(0x293)]);if(_0xb78357==_0x180d86(0x246)){const _0x408dfd=/^bot-[0-9]{3}-config.json$/,_0x5a4472=_0x408dfd[_0x180d86(0x396)](_0x4310cf[_0x180d86(0x293)]);if(_0x5a4472){const _0x2ef2c2=JSON[_0x180d86(0x1e4)](_0x52e6e6);if(_0x2ef2c2['bot'][0x0]){_0x2ef2c2[_0x180d86(0x32c)][0x0]['apiKey']=_0x180d86(0x313),_0x2ef2c2[_0x180d86(0x32c)][0x0]['apiSecret']=_0x180d86(0x313);if(_0x2ef2c2[_0x180d86(0x32c)][0x0][_0x180d86(0x30e)])_0x2ef2c2[_0x180d86(0x32c)][0x0]['apiPassword']=_0x180d86(0x313);}_0x52e6e6=JSON[_0x180d86(0x1de)](_0x2ef2c2,null,0x2);}if(_0x4310cf['name']==_0x180d86(0x2e5)){const _0x3358f3=JSON['parse'](_0x52e6e6);if(_0x3358f3[_0x180d86(0x24f)][_0x180d86(0x215)])_0x3358f3['settings'][_0x180d86(0x215)]=![];if(_0x3358f3['settings'][_0x180d86(0x213)])_0x3358f3[_0x180d86(0x24f)]['bbPassword']=_0x180d86(0x313);if(_0x3358f3[_0x180d86(0x24f)][_0x180d86(0x226)])_0x3358f3[_0x180d86(0x24f)][_0x180d86(0x226)]='***';if(_0x3358f3[_0x180d86(0x24f)]['telegramChatId'])_0x3358f3[_0x180d86(0x24f)][_0x180d86(0x331)]=null;_0x52e6e6=JSON[_0x180d86(0x1de)](_0x3358f3,null,0x2);}if(_0x4310cf[_0x180d86(0x293)]!=_0x180d86(0x2e1))_0x314aa5[_0x180d86(0x271)](_0x4310cf[_0x180d86(0x293)],_0x52e6e6);}else _0x314aa5[_0x180d86(0x271)](_0x4310cf[_0x180d86(0x293)],_0x52e6e6);}});const _0x39c231=_0x314aa5[_0xbd3a8d(0x1f9)]({'base64':![],'compression':_0xbd3a8d(0x304)});fs[_0xbd3a8d(0x2b7)](zippath+(_0xb78357+_0xbd3a8d(0x34f)),_0x39c231,_0xbd3a8d(0x2e8));}async function unzipFile(_0x2415d7,_0x1611c2){const _0xe0b488=_0x1e373c;fs[_0xe0b488(0x2da)](configpath,{'withFileTypes':!![]})[_0xe0b488(0x306)](_0xadd1e7=>{const _0x188bf7=_0xe0b488;if(!_0xadd1e7[_0x188bf7(0x214)]())fs[_0x188bf7(0x2fd)](configpath+_0xadd1e7[_0x188bf7(0x293)]);});const _0x3812a3=fs[_0xe0b488(0x3a3)](_0x2415d7+_0x1611c2,_0xe0b488(0x2e8)),_0x391798=new require(_0xe0b488(0x2be))(_0x3812a3,{'base64':![],'checkCRC32':!![]});Object[_0xe0b488(0x250)](_0x391798[_0xe0b488(0x303)])[_0xe0b488(0x306)](_0x5125f7=>{const _0x153433=_0xe0b488,_0x485fcf=_0x391798['files'][_0x5125f7];fs['writeFileSync'](configpath+_0x485fcf[_0x153433(0x293)],_0x485fcf['_data']);}),fs[_0xe0b488(0x2da)](temppath,{'withFileTypes':!![]})[_0xe0b488(0x306)](_0x3c14ae=>{const _0x398f62=_0xe0b488;if(!_0x3c14ae[_0x398f62(0x214)]())fs[_0x398f62(0x2fd)](temppath+_0x3c14ae[_0x398f62(0x293)]);}),logger[_0xe0b488(0x2fb)](_0xe0b488(0x2f6)),process[_0xe0b488(0x384)]({'restore':!![]},_0xb56d5b=>{});}async function getPublicIp(){const _0xa0fefb=_0x1e373c;try{const _0x4d825a=await axios['get'](_0xa0fefb(0x36d));publicip=_0x4d825a[_0xa0fefb(0x318)]['ip'];}catch(_0x45bf69){}}async function triggerAnalytics(){const _0x3d1135=_0x1e373c;if(!publicip)await getPublicIp();const _0x76f625=getBotsWithMode();let _0x360a77=0x0;_0x76f625[_0x3d1135(0x306)](_0x2fafd6=>{const _0x311f87=_0x3d1135;if(_0x2fafd6['status']===_0x311f87(0x34a))_0x360a77++;});const _0x10a413=getBotExchanges();mixpanel[_0x3d1135(0x3b6)](_0x3d1135(0x316),{'distinct_id':settings[_0x3d1135(0x232)],'ip':publicip,'version':serverversion,'numbots':_0x76f625[_0x3d1135(0x278)],'numbotsenabled':_0x360a77,'exchanges':_0x10a413,'environment':environment});}function _0x42c2(_0x33905b,_0x38a6ed){const _0xfb9a86=_0x3b36();return _0x42c2=function(_0x5848e6,_0x20243d){_0x5848e6=_0x5848e6-0x1d2;let _0x3b360e=_0xfb9a86[_0x5848e6];return _0x3b360e;},_0x42c2(_0x33905b,_0x38a6ed);}async function getMessages(){const _0x56530c=_0x1e373c,_0x5ef1fb=_0x56530c(0x231),_0x1cbf11=new GraphQLClient(_0x5ef1fb),_0x1a174c={'authorization':_0x56530c(0x27c)},_0x34ea90=serverversion[_0x56530c(0x1ee)]('.'),_0x4ef968=_0x34ea90[0x0]+'.'+_0x34ea90[0x1],_0x389f88=Math[_0x56530c(0x2f7)](settings[_0x56530c(0x2b4)],settings[_0x56530c(0x328)]),_0x7eb0e2={'last':parseInt(_0x389f88),'bbm':_0x4ef968},_0x2ae476=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x41654d;try{_0x41654d=await _0x1cbf11[_0x56530c(0x1fb)](_0x2ae476,_0x7eb0e2,_0x1a174c);}catch(_0x2e2879){}if(_0x41654d&&_0x41654d[_0x56530c(0x28f)]){let _0x4f555e=settings[_0x56530c(0x2b4)];newMessages=[];for(const _0x1f7470 of _0x41654d[_0x56530c(0x28f)]){newMessages[_0x56530c(0x2aa)](_0x1f7470);let _0x1526fa=![];_0x1f7470[_0x56530c(0x1ed)]&&(updateSetting(_0x56530c(0x39f),_0x1f7470['bbvNew']),_0x1526fa=isNewerVersion(serverversion,_0x1f7470['bbvNew'])||serverversion==_0x1f7470[_0x56530c(0x1ed)]);if(!_0x1526fa&&_0x1f7470[_0x56530c(0x35c)]>_0x4f555e){if(_0x1f7470[_0x56530c(0x2f2)]===_0x56530c(0x3b5)||serverversion[_0x56530c(0x356)](_0x1f7470[_0x56530c(0x2f2)])){let _0x58c534=''+_0x1f7470[_0x56530c(0x357)]+'\x0a\x0a'+_0x1f7470[_0x56530c(0x21a)];const _0x5e73da=await sendTelegramMsg(toTelegramMarkdown(_0x58c534),_0x56530c(0x2d8));if(_0x5e73da)_0x4f555e=_0x1f7470[_0x56530c(0x35c)];}}}updateAvailable=isNewerVersion(settings[_0x56530c(0x39f)],serverversion),updateSetting(_0x56530c(0x2b4),_0x4f555e),emitMessages();}}function emitMessages(){const _0x199a10=_0x1e373c,_0x2b10e9=settings['lastmsgemitted'];let _0x54bf69=[];newMessages[_0x199a10(0x306)](_0x1fcc3d=>{_0x1fcc3d['number']>_0x2b10e9&&_0x54bf69['push'](_0x1fcc3d);}),_0x54bf69[_0x199a10(0x278)]>0x0&&getAllClients()[_0x199a10(0x306)](_0x345862=>{const _0x3c8f61=_0x199a10;getSocket(_0x345862['id'])[_0x3c8f61(0x354)](_0x3c8f61(0x21a),_0x54bf69);});}function confirmMessage(_0x3e813a){const _0x13cff5=_0x1e373c;updateSetting(_0x13cff5(0x328),Number(_0x3e813a));}function isNewerVersion(_0x2cf967,_0x10c130){const _0x44c1a6=_0x1e373c,_0x2efbcb=_0x10c130[_0x44c1a6(0x1ee)]('.'),_0x2c0833=_0x2cf967[_0x44c1a6(0x1ee)]('.');for(var _0x5e434a=0x0;_0x5e434a<_0x2c0833['length'];_0x5e434a++){const _0x4a4e96=~~_0x2c0833[_0x5e434a],_0x4ecfe5=~~_0x2efbcb[_0x5e434a];if(_0x4a4e96>_0x4ecfe5)return!![];if(_0x4a4e96<_0x4ecfe5)return![];}return![];}function toTelegramMarkdown(_0x128c86){const _0x164463=_0x1e373c,_0x1f5851=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x32b1ad=/\*{2}(.+?)\*{2}/gim;return _0x128c86=_0x128c86['replace'](_0x1f5851,_0x164463(0x211))[_0x164463(0x23d)](_0x32b1ad,_0x164463(0x21b)),_0x128c86;}async function validateConfigFile(){const _0x44a465=_0x1e373c,_0x11becf=dbConfig[_0x44a465(0x361)]('bots')[_0x44a465(0x1f8)](_0x44a465(0x2d2))[_0x44a465(0x210)]()||[];if(_0x11becf[_0x44a465(0x278)]==0x0){let _0x12f8d3=0x0,_0x3606cc=[];const _0x523fdc=/^bot-([0-9]{3})-config.json$/,_0x20cace=fs[_0x44a465(0x2da)](configpath);_0x20cace[_0x44a465(0x306)](_0x3b998b=>{const _0x3ea2bd=_0x44a465,_0x3bf45b=_0x523fdc[_0x3ea2bd(0x229)](_0x3b998b);if(_0x3bf45b){const _0x356670=_0x3bf45b[0x1];let _0x6d4951=getBotAttributes(_0x356670);_0x3606cc['push']({'botID':_0x356670,'botname':_0x6d4951['botname'],'status':'disabled','live':'stopped'}),_0x12f8d3++;}}),_0x12f8d3!=0x0&&(dbConfig['get'](_0x44a465(0x1f5))['assign'](_0x3606cc)[_0x44a465(0x24c)](),config=_0x3606cc,restoredConfigFile=_0x12f8d3);}}async function restoreConfigNotify(_0x3135c7){const _0x4fa690=_0x1e373c;let _0x1f93a0;if(restoredConfigFile==0x1)_0x1f93a0=_0x4fa690(0x2cf);else _0x1f93a0='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x3135c7)io['to'](_0x4fa690(0x3a2))['emit'](_0x4fa690(0x2e0),_0x1f93a0);else{logger[_0x4fa690(0x269)](_0x4fa690(0x22a)),logger[_0x4fa690(0x269)](_0x1f93a0),logger['simple'](_0x4fa690(0x22a)),logger[_0x4fa690(0x269)]('');if(tgBot&&settings[_0x4fa690(0x331)]&&settings[_0x4fa690(0x22d)]!=_0x4fa690(0x1fe))tgBot[_0x4fa690(0x247)](settings[_0x4fa690(0x331)],_0x4fa690(0x2e6)+_0x1f93a0)[_0x4fa690(0x1e2)](_0x354ee3=>{telegramError(_0x354ee3);});}}function validateCredentials(_0x48e453,_0x34f0fb){const _0x45c691=_0x1e373c;if(_0x48e453['username']==settings['bbUsername']&&bcrypt[_0x45c691(0x397)](_0x48e453[_0x45c691(0x295)],settings[_0x45c691(0x213)])){if(settings[_0x45c691(0x2a2)])return{'allow':![],'reason':_0x45c691(0x202),'token':null};else{const _0x4d99e8=generateLoginToken(_0x34f0fb);return{'allow':!![],'reason':_0x45c691(0x2b3),'token':_0x4d99e8};}}else return{'allow':![],'reason':_0x45c691(0x22f),'token':null};}function refreshToken(_0x4afdaa){const _0x5ed65c=_0x1e373c,_0x4401f0=generateLoginToken(_0x4afdaa);return{'allow':!![],'reason':_0x5ed65c(0x2b3),'token':_0x4401f0};}function validateAccess(_0xc49e14,_0x479381,_0xde598f){const _0x368068=_0x1e373c,_0x4353ff=_0xde598f?_0xde598f:devices[_0x479381]['ip'];let _0x3e932e;const _0x39a8a7=_0x55a31e=>{const _0x3c2456=_0x42c2;if(settings[_0x3c2456(0x215)]){if(settings[_0x3c2456(0x2a2)]){if(telegram2FaApproved(_0x479381)){const _0x152f9d=generateLoginToken(_0x479381);return{'allow':!![],'reason':_0x3c2456(0x33d),'token':_0x152f9d};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x3e932e=validToken(_0x55a31e,_0x479381),_0x3e932e[_0x3c2456(0x26d)](_0x3c2456(0x3b4))?{'allow':!![],'reason':_0x3c2456(0x300),'token':_0x55a31e}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x368068(0x343)]){let _0x286271=[...settings[_0x368068(0x20f)],_0x368068(0x33e),'::ffff:127.0.0.1',_0x368068(0x2fc)];if(_0x286271[_0x368068(0x1ea)](_0x4353ff))return _0x39a8a7(_0xc49e14);else{_0x3e932e=validToken(_0xc49e14,_0x479381);if(_0x3e932e['hasOwnProperty'](_0x368068(0x3b4)))return _0x39a8a7(_0xc49e14);else{if(telegramIpApproved(_0x479381)){const _0x24493e=generateToken(_0x479381);return _0x3e932e=_0x39a8a7(_0xc49e14),_0x3e932e[_0x368068(0x245)]?{'allow':!![],'reason':_0x368068(0x255),'token':_0x24493e}:_0x3e932e;}else return settings[_0x368068(0x33f)]?{'allow':![],'reason':_0x368068(0x206),'token':null}:{'allow':![],'reason':_0x368068(0x2c1),'token':null};}}}else return _0x39a8a7(_0xc49e14);}function timelyDecrypt(_0x5f0a44,_0x327e3b=!![]){const _0x530a7b=_0x1e373c;if(_0x5f0a44)try{const _0x583e=crypt[_0x530a7b(0x292)](secure[_0x530a7b(0x33c)],_0x5f0a44)[_0x530a7b(0x21a)],_0xde868f=_0x583e['split']('@')[0x0],_0x3270f8=_0x583e[_0x530a7b(0x1ee)]('@')[0x1],_0x1f32cc=new Date()['getTime']();if(_0x327e3b){if(_0x1f32cc-_0x3270f8<maxSecretAge*0x3e8)return _0xde868f;else return![];}else return _0xde868f;}catch(_0x3d7cbb){return![];}else return![];}const validToken=(_0x4f091e,_0x4711e8)=>{const _0x56385d=_0x1e373c,_0x1352bd=devices[_0x4711e8]['ip'];if(!_0x4f091e)return{'error':_0x56385d(0x2e4)};for(let _0x8d7320 of blacklist){if(_0x8d7320[_0x56385d(0x327)]==_0x4f091e)return{'error':_0x56385d(0x1d3)};}let _0x5b492f;try{_0x5b492f=jwt[_0x56385d(0x37a)](_0x4f091e,secure[_0x56385d(0x319)]+_0x4711e8);}catch{return{'error':_0x56385d(0x338)};}if(!_0x5b492f[_0x56385d(0x26d)](_0x56385d(0x296))&&!_0x5b492f[_0x56385d(0x26d)](_0x56385d(0x2e7))||!_0x5b492f[_0x56385d(0x26d)]('exp'))return{'error':_0x56385d(0x386)};if(!_0x5b492f[_0x56385d(0x26d)](_0x56385d(0x2e7))&&_0x5b492f[_0x56385d(0x26d)](_0x56385d(0x296))){const {clientip:_0x1c7ac0}=_0x5b492f;return _0x1352bd==_0x1c7ac0?{'success':_0x56385d(0x393)}:{'error':_0x56385d(0x249)};}else{if(_0x5b492f[_0x56385d(0x26d)](_0x56385d(0x2e7))&&_0x5b492f[_0x56385d(0x26d)]('clientip')){const {username:_0x3911bf,clientip:_0xb9125}=_0x5b492f;return settings[_0x56385d(0x2af)]==_0x3911bf&&_0x1352bd==_0xb9125?{'success':_0x56385d(0x393)}:{'error':_0x56385d(0x2dd)};}}},generateLoginToken=_0x58b594=>{const _0x1af1e9=_0x1e373c;if(_0x58b594){const _0x448066=devices[_0x58b594]['ip'];return jwt['sign']({'username':settings[_0x1af1e9(0x2af)],'clientip':_0x448066},secure[_0x1af1e9(0x319)]+_0x58b594,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x2ce53b=>{const _0x23de36=_0x1e373c;if(_0x2ce53b){const _0x15326f=devices[_0x2ce53b]['ip'];return jwt[_0x23de36(0x21f)]({'clientip':_0x15326f},secure[_0x23de36(0x319)]+_0x2ce53b,{'expiresIn':devices[_0x2ce53b][_0x23de36(0x27d)][_0x23de36(0x326)]*0x3c});}else return![];},telegramIpApproved=_0x1716a7=>{const _0x579d0d=_0x1e373c;let _0x4b8f97=![];return devices[_0x1716a7][_0x579d0d(0x27d)]&&devices[_0x1716a7][_0x579d0d(0x27d)][_0x579d0d(0x326)]!='reject'&&(_0x4b8f97=devices[_0x1716a7][_0x579d0d(0x27d)][_0x579d0d(0x296)]==devices[_0x1716a7]['ip']&&new Date()[_0x579d0d(0x2e9)]()-devices[_0x1716a7][_0x579d0d(0x27d)][_0x579d0d(0x307)]<devices[_0x1716a7][_0x579d0d(0x27d)][_0x579d0d(0x326)]*0x3c*0x3e8),_0x4b8f97;},telegram2FaApproved=_0xa57787=>{const _0xe527c0=_0x1e373c;let _0x421056=![];return devices[_0xa57787][_0xe527c0(0x260)]&&devices[_0xa57787][_0xe527c0(0x260)][_0xe527c0(0x326)]!='reject'&&(_0x421056=devices[_0xa57787]['telegram2FaApproval']['clientip']==devices[_0xa57787]['ip']&&new Date()['getTime']()-devices[_0xa57787][_0xe527c0(0x260)]['timestamp']<devices[_0xa57787][_0xe527c0(0x260)][_0xe527c0(0x326)]*0x3c*0x3e8),_0x421056;},normalizeIP=_0x457b3c=>{const _0x35ac41=_0x1e373c;let _0x44c7fb=null,_0x1381ff=null;if(ipaddr[_0x35ac41(0x30b)](_0x457b3c)){const _0x5cd36a=ipaddr['parse'](_0x457b3c);_0x5cd36a[_0x35ac41(0x3b3)]()===_0x35ac41(0x2ee)?(_0x5cd36a[_0x35ac41(0x277)]()&&(_0x44c7fb=_0x5cd36a[_0x35ac41(0x349)]()[_0x35ac41(0x1dd)]()),_0x1381ff=_0x5cd36a['toString']()):(_0x44c7fb=_0x5cd36a['toString'](),_0x1381ff=_0x5cd36a[_0x35ac41(0x29a)]()['toString']());}return{'show':_0x44c7fb?_0x44c7fb:_0x1381ff,'store':_0x1381ff};};function formatDate(_0x1aa5ca){const _0x3a8f39=_0x1e373c;return _0x1aa5ca[_0x3a8f39(0x330)]()+'/'+(_0x1aa5ca[_0x3a8f39(0x1dc)]()+0x1)['toString']()[_0x3a8f39(0x378)](0x2,'0')+'/'+_0x1aa5ca[_0x3a8f39(0x28b)]()[_0x3a8f39(0x1dd)]()[_0x3a8f39(0x378)](0x2,'0')+'\x20'+_0x1aa5ca['getHours']()['toString']()['padStart'](0x2,'0')+':'+_0x1aa5ca[_0x3a8f39(0x261)]()[_0x3a8f39(0x1dd)]()['padStart'](0x2,'0')+':'+_0x1aa5ca[_0x3a8f39(0x2c4)]()[_0x3a8f39(0x1dd)]()[_0x3a8f39(0x378)](0x2,'0');}function sleep(_0x187711){return new Promise(_0x1fdaec=>setTimeout(_0x1fdaec,_0x187711));}