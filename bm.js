const _0x1a47b6=_0x65cb;(function(_0x4e604e,_0x209c76){const _0x4f280a=_0x65cb,_0x5463e1=_0x4e604e();while(!![]){try{const _0x346c12=-parseInt(_0x4f280a(0x164))/0x1*(-parseInt(_0x4f280a(0x13d))/0x2)+-parseInt(_0x4f280a(0x2b3))/0x3+parseInt(_0x4f280a(0x167))/0x4+-parseInt(_0x4f280a(0x228))/0x5+parseInt(_0x4f280a(0x1f2))/0x6*(parseInt(_0x4f280a(0x224))/0x7)+-parseInt(_0x4f280a(0x1a5))/0x8+-parseInt(_0x4f280a(0x29f))/0x9*(-parseInt(_0x4f280a(0x18f))/0xa);if(_0x346c12===_0x209c76)break;else _0x5463e1['push'](_0x5463e1['shift']());}catch(_0x4faf12){_0x5463e1['push'](_0x5463e1['shift']());}}}(_0x146b,0xe15f5));const _0xe3bcdc=function(){let _0x344287=!![];return function(_0x456e0c,_0xf99640){const _0x293c7e=_0x344287?function(){const _0x265fcb=_0x65cb;if(_0xf99640){const _0x19ac46=_0xf99640[_0x265fcb(0x16e)](_0x456e0c,arguments);return _0xf99640=null,_0x19ac46;}}:function(){};return _0x344287=![],_0x293c7e;};}(),_0x3ea52d=_0xe3bcdc(this,function(){const _0x1703b1=_0x65cb;return _0x3ea52d[_0x1703b1(0x18e)]()['search'](_0x1703b1(0x210))[_0x1703b1(0x18e)]()[_0x1703b1(0x218)](_0x3ea52d)['search'](_0x1703b1(0x210));});_0x3ea52d();'use strict';process[_0x1a47b6(0x255)][_0x1a47b6(0x2ab)]=0x1;const childProcess=require(_0x1a47b6(0x1ad)),fs=require('fs'),fns=require(_0x1a47b6(0x223)),low=require(_0x1a47b6(0x1c8)),FileSync=require(_0x1a47b6(0x144)),path=require(_0x1a47b6(0x272)),crypto=require(_0x1a47b6(0x1a1)),Crypt=require('hybrid-crypto-js')[_0x1a47b6(0x124)],RSA=require(_0x1a47b6(0x1c9))['RSA'],bcrypt=require(_0x1a47b6(0x288)),jwt=require(_0x1a47b6(0x2a9)),ipaddr=require(_0x1a47b6(0x200)),argv=require(_0x1a47b6(0x281))(process['argv'][_0x1a47b6(0x211)](0x2))[_0x1a47b6(0x201)],uuidRandom=require(_0x1a47b6(0x16b)),TelegramBot=require(_0x1a47b6(0x13c)),Mixpanel=require(_0x1a47b6(0x1b0)),axios=require(_0x1a47b6(0x1ef)),{GraphQLClient,gql}=require(_0x1a47b6(0x25b)),util=require(_0x1a47b6(0x186)),fileUpload=require(_0x1a47b6(0x17c)),PORT=argv[_0x1a47b6(0x131)]||_0x1a47b6(0x137),pattern=/^[0-9]{2,4}$/;!pattern[_0x1a47b6(0x29a)](PORT)&&(console[_0x1a47b6(0x1c7)]('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1));const HOST=argv['host']||null,userID=argv[_0x1a47b6(0x13f)]||'';let bbpath=_0x1a47b6(0x19f),bbpath2='';const botfile=_0x1a47b6(0x24d),configfile='bb-config.json',settingsfile=_0x1a47b6(0x27f),securefile=_0x1a47b6(0x2a7);let validInstallation=!![];!fs[_0x1a47b6(0x189)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x1a47b6(0x170),configbackuppath=configpath+_0x1a47b6(0x244),logspath=userID?bbpath+_0x1a47b6(0x23a)+userID+'/':bbpath+_0x1a47b6(0x23a),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x1a47b6(0x178),loggerfile=fs[_0x1a47b6(0x23c)](logspath+_0x1a47b6(0x296),{'flags':'a'}),temppath=userID?bbpath+_0x1a47b6(0x1d9)+userID+'/':bbpath+'temp/';!fs[_0x1a47b6(0x189)](configpath)&&fs[_0x1a47b6(0x2a0)](configpath);!fs[_0x1a47b6(0x189)](configbackuppath)&&fs[_0x1a47b6(0x2a0)](configbackuppath);!fs[_0x1a47b6(0x189)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x1a47b6(0x189)](zippath)&&fs[_0x1a47b6(0x2a0)](zippath);!fs['existsSync'](temppath)&&fs[_0x1a47b6(0x2a0)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x1a47b6(0x1ff)]({'bots':[]})[_0x1a47b6(0x158)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x1a47b6(0x18a)}})[_0x1a47b6(0x158)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x1a47b6(0x1ff)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x1a47b6(0x249),'rsaStandard':_0x1a47b6(0x1b3)});const saltRounds=0xa,mixpanel=Mixpanel['init']('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x1a47b6(0x122)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x1a47b6(0x2a1)]&&settings[_0x1a47b6(0x2a1)]!=''&&settings[_0x1a47b6(0x20a)]&&settings['telegramUsername']!='')initTelegram();const logger={'screen':_0x2619e5=>{const _0x5ea280=_0x1a47b6;console[_0x5ea280(0x1c7)](_0x2619e5);},'simple':_0x55eadc=>{const _0x5d15d3=_0x1a47b6;console[_0x5d15d3(0x1c7)](_0x55eadc),loggerfile[_0x5d15d3(0x158)](util[_0x5d15d3(0x1c0)](_0x55eadc)+'\x0a');},'full':async _0x51eed8=>{const _0x269083=_0x1a47b6,_0x2e23f1=getTimeStamp()+_0x269083(0x206)+_0x51eed8;console['log'](_0x2e23f1),loggerfile[_0x269083(0x158)](util['format'](_0x2e23f1)+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x269083(0x166)]!='orders')await tgBot[_0x269083(0x28e)](settings['telegramChatId'],_0x269083(0x202)+_0x51eed8)[_0x269083(0x14d)](_0x3841d2=>{telegramError(_0x3841d2);});}};process['on'](_0x1a47b6(0x209),function(_0x1f2692){const _0x286e7b=_0x1a47b6;logger[_0x286e7b(0x1e8)](_0x1f2692);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x1a47b6(0x219)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require('http')[_0x1a47b6(0x163)](app);app[_0x1a47b6(0x1f8)](fileUpload({'useTempFiles':!![]})),app['get'](_0x1a47b6(0x1fd),async(_0x61f78f,_0x3b5e41)=>{const _0x2931ba=_0x1a47b6,_0x4261a7=_0x61f78f[_0x2931ba(0x187)][_0x2931ba(0x212)],_0x8fc59a=getClientsWithBotID(_0x2931ba(0x2ac)),_0x22fa0a=_0x61f78f[_0x2931ba(0x120)][_0x2931ba(0x29b)],_0x29bd9e=timelyDecrypt(_0x22fa0a,![]),_0x2c4b9c=_0x8fc59a[_0x2931ba(0x264)](_0x5bbcd6=>_0x5bbcd6[_0x2931ba(0x29b)]==_0x29bd9e);if(_0x2c4b9c){const _0xb4643d=normalizeIP(_0x61f78f[_0x2931ba(0x133)][_0x2931ba(0x134)])[_0x2931ba(0x2a4)],_0x5bb2c4=_0x61f78f[_0x2931ba(0x120)][_0x2931ba(0x25d)];if(validateAccess(_0x5bb2c4,_0x29bd9e,_0xb4643d)[_0x2931ba(0x250)])await zipFiles(_0x4261a7),_0x3b5e41[_0x2931ba(0x15d)](zippath+(_0x4261a7+_0x2931ba(0x14c)),_0x1588b5=>{const _0x3ab3dd=_0x2931ba;_0x1588b5&&(logger[_0x3ab3dd(0x22e)](_0x3ab3dd(0x216)+_0x4261a7),logger['simple'](_0x1588b5));});else logger['full'](_0x2931ba(0x151)+_0x4261a7+_0x2931ba(0x12d));}else logger[_0x2931ba(0x22e)](_0x2931ba(0x151)+_0x4261a7+_0x2931ba(0x156));}),app['post'](_0x1a47b6(0x1ac),async(_0x56a437,_0x230690)=>{const _0x43a851=_0x1a47b6,_0x4f6b80=getClientsWithBotID('botmanager'),_0x54c15e=_0x56a437[_0x43a851(0x120)][_0x43a851(0x29b)],_0x34249f=timelyDecrypt(_0x54c15e,![]),_0x419f6b=_0x4f6b80[_0x43a851(0x264)](_0x3a29cf=>_0x3a29cf['uuid']==_0x34249f);if(_0x419f6b){const _0x26aa05=normalizeIP(_0x56a437[_0x43a851(0x133)][_0x43a851(0x134)])['store'],_0xf770d=_0x56a437['headers'][_0x43a851(0x25d)];if(validateAccess(_0xf770d,_0x34249f,_0x26aa05)[_0x43a851(0x250)]){if(_0x56a437[_0x43a851(0x15f)]){const _0x2e5bb4=_0x56a437[_0x43a851(0x15f)]['backupfile'];await _0x2e5bb4['mv'](temppath+_0x2e5bb4['name']),_0x230690['send']({'status':!![],'message':_0x43a851(0x16d)});const _0x5866cc=getBotsWithMode();_0x5866cc[_0x43a851(0x277)]>0x0?confirmRestore(temppath,_0x2e5bb4[_0x43a851(0x20d)]):unzipFile(temppath,_0x2e5bb4['name']);}}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x43a851(0x22e)](_0x43a851(0x181));}),app[_0x1a47b6(0x1f8)](express[_0x1a47b6(0x1c2)](path[_0x1a47b6(0x191)](__dirname,bbpath2,_0x1a47b6(0x1fa)))),app[_0x1a47b6(0x1f8)](express[_0x1a47b6(0x1c2)](path['join'](__dirname,bbpath2,_0x1a47b6(0x14f)))),app[_0x1a47b6(0x179)]('/',function(_0x2e1546,_0x37e61f){const _0x32c6cf=_0x1a47b6;_0x37e61f[_0x32c6cf(0x21a)](path[_0x32c6cf(0x191)](__dirname,bbpath2,_0x32c6cf(0x1fa),'index.html'));}),app['get'](_0x1a47b6(0x12f),function(_0x27f1a4,_0x446c2a){const _0x4cfecd=_0x1a47b6;_0x446c2a[_0x4cfecd(0x21a)](path['join'](__dirname,bbpath2,'build',_0x4cfecd(0x176)));}),app[_0x1a47b6(0x179)](_0x1a47b6(0x18b),(_0x1a732b,_0x5799d8)=>{const _0x2d148e=_0x1a47b6;_0x5799d8[_0x2d148e(0x21a)](path['join'](__dirname,bbpath2,'build','index.html'));}),app['get'](_0x1a47b6(0x1b6),(_0x3ee17a,_0xc07a3a)=>{const _0x18e0f0=_0x1a47b6;_0xc07a3a[_0x18e0f0(0x21a)](path[_0x18e0f0(0x191)](__dirname,bbpath2,_0x18e0f0(0x14f),_0x18e0f0(0x176)));}),app[_0x1a47b6(0x179)](_0x1a47b6(0x1d4),(_0x1ded63,_0x439b1d)=>{const _0x5df7e1=_0x1a47b6;_0x439b1d['sendFile'](path[_0x5df7e1(0x191)](__dirname,bbpath2,'build',_0x5df7e1(0x176)));}),app[_0x1a47b6(0x179)](_0x1a47b6(0x1dd),(_0x326c21,_0x3ea4da)=>{const _0x10fc2d=_0x1a47b6;_0x3ea4da[_0x10fc2d(0x21a)](path[_0x10fc2d(0x191)](__dirname,bbpath2,_0x10fc2d(0x14f),'index.html'));}),app['get']('/:bot/configuration',(_0x41f112,_0x4c6553)=>{const _0x21145f=_0x1a47b6;_0x4c6553[_0x21145f(0x21a)](path[_0x21145f(0x191)](__dirname,bbpath2,_0x21145f(0x14f),_0x21145f(0x176)));}),app[_0x1a47b6(0x179)](_0x1a47b6(0x2b9),(_0x377a74,_0x4d6165)=>{const _0x360d0d=_0x1a47b6;_0x4d6165[_0x360d0d(0x21a)](path[_0x360d0d(0x191)](__dirname,bbpath2,_0x360d0d(0x14f),_0x360d0d(0x176)));});if(HOST)http[_0x1a47b6(0x293)](PORT,HOST);else http[_0x1a47b6(0x293)](PORT);function _0x65cb(_0x40de19,_0x3b89d0){const _0x1e2ffa=_0x146b();return _0x65cb=function(_0x3ea52d,_0xe3bcdc){_0x3ea52d=_0x3ea52d-0x11d;let _0x146bc3=_0x1e2ffa[_0x3ea52d];return _0x146bc3;},_0x65cb(_0x40de19,_0x3b89d0);}const io=require(_0x1a47b6(0x1e1))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}async function startServer(){const _0x5dcd17=_0x1a47b6;logger['simple'](''),logger[_0x5dcd17(0x1e8)](_0x5dcd17(0x234)),await logger[_0x5dcd17(0x22e)](_0x5dcd17(0x23d)+PORT),logger[_0x5dcd17(0x1e8)]('-----------------------------------------------------------------------------------');if(config[_0x5dcd17(0x277)]!=0x0)for(const _0x3caafd of config){if(_0x3caafd[_0x5dcd17(0x20c)]==_0x5dcd17(0x15c)||_0x3caafd[_0x5dcd17(0x20c)]=='new')await logger[_0x5dcd17(0x22e)]('starting\x20bot\x20|\x20Bot\x20'+_0x3caafd[_0x5dcd17(0x208)]+_0x5dcd17(0x294)+_0x3caafd['botname']),startBot([_0x3caafd['botID'],userID],{'cwd':bbpath},function(_0x383bb5){const _0x11d563=_0x5dcd17;if(_0x383bb5)logger[_0x11d563(0x22e)](_0x383bb5);});else(_0x3caafd[_0x5dcd17(0x20c)]=='disabled'||_0x3caafd['status']==_0x5dcd17(0x274))&&await logger['full']('idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x3caafd[_0x5dcd17(0x208)]+_0x5dcd17(0x294)+_0x3caafd[_0x5dcd17(0x182)]);}else!newBot&&logger[_0x5dcd17(0x1e8)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x5dcd17(0x1e8)](_0x5dcd17(0x234)),logger[_0x5dcd17(0x1e8)]('');}function startSocket(){const _0x9d47a5=_0x1a47b6;io['on'](_0x9d47a5(0x150),_0x423baa=>{const _0x5c8284=_0x9d47a5;let _0x5570e4,_0x59d708,_0x2296c8,_0x310ebb,_0x251e9f;const _0x47f6c7=_0x423baa['handshake']['headers']['referer'];_0x59d708=_0x47f6c7[_0x5c8284(0x23f)](/bot[0-9]{3}/);if(_0x59d708)_0x2296c8=_0x59d708[0x0]['match'](/[0-9]{3}/);if(_0x2296c8)_0x5570e4=_0x2296c8[0x0];else _0x5570e4='botmanager';const _0x1b8284=_0x423baa[_0x5c8284(0x1c3)][_0x5c8284(0x2a6)][_0x5c8284(0x245)];if(!_0x1b8284)_0x423baa[_0x5c8284(0x290)](_0x5c8284(0x20c),{'publicKey':secure[_0x5c8284(0x238)]});else{_0x310ebb=timelyDecrypt(_0x1b8284,![]);if(!_0x310ebb)_0x423baa[_0x5c8284(0x290)]('status',{'publicKey':secure[_0x5c8284(0x238)]});else{_0x251e9f=normalizeIP(_0x423baa[_0x5c8284(0x2bd)]['remoteAddress'])[_0x5c8284(0x2a4)];if(!devices[_0x310ebb])devices[_0x310ebb]={'uuid':_0x310ebb,'access':{'token':null}};devices[_0x310ebb]['ip']=_0x251e9f;const _0xeb511=addClient(_0x423baa['id'],_0x310ebb,_0x5570e4);setAccess(_0xeb511),emitMessages(),_0x423baa['on']('login',_0x45a8ed=>{const _0x28114f=_0x5c8284,_0x2dfef1=timelyDecrypt(_0x45a8ed[_0x28114f(0x299)]);if(_0x2dfef1){_0x45a8ed={'username':_0x45a8ed['username'],'password':_0x2dfef1},devices[_0x310ebb][_0x28114f(0x1b2)]=validateCredentials(_0x45a8ed,_0x310ebb);if(devices[_0x310ebb]['access'][_0x28114f(0x250)]==![]&&devices[_0x310ebb][_0x28114f(0x1b2)][_0x28114f(0x253)]==_0x28114f(0x196))_0x423baa[_0x28114f(0x290)](_0x28114f(0x20c),{'access':devices[_0x310ebb][_0x28114f(0x1b2)]}),loginAccess2FA(_0x310ebb,_0x251e9f);else{if(devices[_0x310ebb]['access'][_0x28114f(0x250)]==![]&&devices[_0x310ebb]['access']['reason']==_0x28114f(0x1de))_0x423baa[_0x28114f(0x290)](_0x28114f(0x20c),{'access':devices[_0x310ebb][_0x28114f(0x1b2)]});else devices[_0x310ebb][_0x28114f(0x1b2)]['allow']&&devices[_0x310ebb][_0x28114f(0x1b2)]['reason']==_0x28114f(0x128)&&(getClientsWithUuid(_0x310ebb)[_0x28114f(0x27b)](_0x10e3c9=>{setAccess(_0x10e3c9);}),setTokenRefresh(_0x310ebb),setSessionTimeout(_0x28114f(0x169),_0x310ebb));}}else logger[_0x28114f(0x22e)](_0x28114f(0x1e5));}),_0x423baa['on']('reset-password',()=>{resetPassword();}),_0x423baa['on'](_0x5c8284(0x1b9),_0x4db65c=>{removeClient(_0x423baa['id']);}),_0x5570e4==_0x5c8284(0x2ac)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x23219a){const _0x2f1e1b=_0x1a47b6;if(_0x23219a!=_0x2f1e1b(0x2ac)&&config[_0x2f1e1b(0x21f)]!=''){if(pid[_0x23219a])pid[_0x23219a][_0x2f1e1b(0x24a)]({'function':_0x2f1e1b(0x1f7),'args':null});}}function reloadBotManager(){const _0xb78400=_0x1a47b6;getClientsWithBotID(_0xb78400(0x2ac))[_0xb78400(0x27b)](_0x41ed5c=>{const _0x267dd9=_0xb78400;getSocket(_0x41ed5c['id'])[_0x267dd9(0x290)](_0x267dd9(0x20c),{'access':{'allow':![],'reason':_0x267dd9(0x1ca),'token':null}});});}function getSocket(_0x258672){const _0x5a1613=_0x1a47b6;return io[_0x5a1613(0x22b)]['sockets'][_0x5a1613(0x179)](_0x258672);}function setAccess(_0x440e33){const _0x1e45ca=_0x1a47b6,_0x59e48e=getSocket(_0x440e33['id']),_0x14d019=_0x440e33['uuid'],_0x41c272=_0x440e33[_0x1e45ca(0x270)];devices[_0x14d019][_0x1e45ca(0x1b2)]=validateAccess(devices[_0x14d019][_0x1e45ca(0x1b2)][_0x1e45ca(0x261)],_0x14d019),_0x59e48e[_0x1e45ca(0x191)](_0x14d019);if(devices[_0x14d019][_0x1e45ca(0x1b2)][_0x1e45ca(0x250)]){_0x59e48e[_0x1e45ca(0x191)](_0x41c272);if(_0x41c272==_0x1e45ca(0x2ac))initializeSocketBotManager(_0x59e48e);else initializeSocketBot(_0x59e48e);initClient(_0x41c272);}devices[_0x14d019][_0x1e45ca(0x1b2)][_0x1e45ca(0x261)]&&devices[_0x14d019][_0x1e45ca(0x1b2)][_0x1e45ca(0x253)]==_0x1e45ca(0x14e)&&setSessionTimeout(_0x1e45ca(0x278),_0x14d019),devices[_0x14d019][_0x1e45ca(0x1b2)][_0x1e45ca(0x261)]&&devices[_0x14d019][_0x1e45ca(0x1b2)][_0x1e45ca(0x253)]==_0x1e45ca(0x1c6)&&setSessionTimeout('login',_0x14d019),_0x59e48e['emit'](_0x1e45ca(0x20c),{'status':_0x440e33['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x14d019][_0x1e45ca(0x1b2)],'externalip':devices[_0x14d019]['ip'],'publicKey':secure[_0x1e45ca(0x238)],'userid':settings[_0x1e45ca(0x1fb)],'validInstallation':validInstallation}),devices[_0x14d019][_0x1e45ca(0x1b2)][_0x1e45ca(0x250)]==![]&&devices[_0x14d019][_0x1e45ca(0x1b2)][_0x1e45ca(0x253)]==_0x1e45ca(0x160)&&temporaryAccess2FA(_0x14d019,devices[_0x14d019]['ip']);}function setSessionTimeout(_0xd023e1,_0x298101){const _0x5b057a=_0x1a47b6;let _0x2a1ab4;if(_0xd023e1==_0x5b057a(0x169))_0x2a1ab4=loginExpiry*0x3c*0x3e8;else _0x2a1ab4=devices[_0x298101][_0x5b057a(0x1a7)]['expiry']*0x3c*0x3e8-(new Date()[_0x5b057a(0x1ab)]()-devices[_0x298101][_0x5b057a(0x1a7)][_0x5b057a(0x129)]);if(devices[_0x298101][_0x5b057a(0x1e7)])clearTimeout(devices[_0x298101]['pidExpireLogin']);devices[_0x298101]['pidExpireLogin']=setTimeout(()=>{const _0x20057=_0x5b057a;if(devices[_0x298101][_0x20057(0x142)])clearTimeout(devices[_0x298101][_0x20057(0x142)]);removeSocketListeners(_0x298101),addBlacklist(_0x298101),devices[_0x298101][_0x20057(0x1a7)]=null,devices[_0x298101][_0x20057(0x23e)]=null,devices[_0x298101][_0x20057(0x1b2)][_0x20057(0x261)]=null,devices[_0x298101][_0x20057(0x1b2)]=validateAccess(devices[_0x298101][_0x20057(0x1b2)][_0x20057(0x261)],_0x298101),!(devices[_0x298101][_0x20057(0x1b2)][_0x20057(0x250)]&&devices[_0x298101][_0x20057(0x1b2)][_0x20057(0x253)]=='login\x20not\x20required')&&(_0xd023e1==_0x20057(0x169)?io['to'](_0x298101)['emit']('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x298101)[_0x20057(0x290)](_0x20057(0x20c),{'access':{'allow':![],'reason':_0x20057(0x2b0),'token':null}})),devices[_0x298101]['access'][_0x20057(0x261)]=null;},_0x2a1ab4);}function setTokenRefresh(_0x3061ae){const _0x15c055=_0x1a47b6;if(devices[_0x3061ae][_0x15c055(0x142)])clearTimeout(devices[_0x3061ae][_0x15c055(0x142)]);devices[_0x3061ae][_0x15c055(0x142)]=setTimeout(()=>{const _0x263979=_0x15c055;getClientsWithUuid(_0x3061ae)[_0x263979(0x277)]!=0x0?(devices[_0x3061ae][_0x263979(0x1b2)]=refreshToken(_0x3061ae),io['to'](_0x3061ae)[_0x263979(0x290)]('status',{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x3061ae][_0x263979(0x1b2)],'externalip':devices[_0x3061ae]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x3061ae)):clearTimeout(devices[_0x3061ae][_0x263979(0x142)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0xb56ab4){const _0x44c866=_0x1a47b6,_0x4bbe32=getClient(_0xb56ab4['id'])['uuid'];_0xb56ab4[_0x44c866(0x290)](_0x44c866(0x291),config),_0xb56ab4['emit'](_0x44c866(0x1d8),cleanSettings()),_0xb56ab4['on'](_0x44c866(0x149),_0x38b47e=>{const _0x317fdc=_0x44c866;if(validateAccess(_0x38b47e,_0x4bbe32)[_0x317fdc(0x250)])addBot();else logger[_0x317fdc(0x22e)](_0x317fdc(0x22a));}),_0xb56ab4['on']('update-bot',(_0x45a4e1,_0x2a6df8)=>{const _0x2ef002=_0x44c866;if(validateAccess(_0x2a6df8,_0x4bbe32)[_0x2ef002(0x250)])toggleBot(_0x45a4e1[_0x2ef002(0x208)],_0x45a4e1[_0x2ef002(0x20c)],_0x45a4e1['live']);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0xb56ab4['on'](_0x44c866(0x287),(_0x4627d2,_0x4e9810)=>{const _0xae2b24=_0x44c866;if(validateAccess(_0x4e9810,_0x4bbe32)[_0xae2b24(0x250)])toggleBotMode(_0x4627d2);else logger[_0xae2b24(0x22e)](_0xae2b24(0x2a8));}),_0xb56ab4['on'](_0x44c866(0x27c),(_0x599146,_0xa62c23)=>{const _0x55ef31=_0x44c866;if(validateAccess(_0xa62c23,_0x4bbe32)[_0x55ef31(0x250)])deleteBot(_0x599146);else logger['full'](_0x55ef31(0x285));}),_0xb56ab4['on'](_0x44c866(0x2aa),(_0x4c65e4,_0x44eaeb)=>{const _0x5f550f=_0x44c866;if(validateAccess(_0x44eaeb,_0x4bbe32)[_0x5f550f(0x250)])storeSettings(_0x4c65e4,!![]);else logger[_0x5f550f(0x22e)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0xb56ab4['on'](_0x44c866(0x1f1),_0x1e01c9=>{const _0x475997=_0x44c866;if(validateAccess(_0x1e01c9,_0x4bbe32)[_0x475997(0x250)])updateBB();else logger[_0x475997(0x22e)](_0x475997(0x1a9));}),_0xb56ab4['on'](_0x44c866(0x24f),_0x15e58d=>{const _0x158462=_0x44c866;if(validateAccess(_0x15e58d,_0x4bbe32)[_0x158462(0x250)])getMessages();else logger['full'](_0x158462(0x259));}),_0xb56ab4['on'](_0x44c866(0x25c),(_0x46ef5d,_0xaeae7)=>{const _0x2d9812=_0x44c866;if(validateAccess(_0xaeae7,_0x4bbe32)[_0x2d9812(0x250)])confirmMessage(_0x46ef5d);else logger[_0x2d9812(0x22e)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0xb56ab4['on']('logout',_0x192365=>{const _0x4b0275=_0x44c866;if(validateAccess(_0x192365,_0x4bbe32)[_0x4b0275(0x250)]){if(devices[_0x4bbe32]['pidRefreshToken'])clearTimeout(devices[_0x4bbe32]['pidRefreshToken']);if(devices[_0x4bbe32][_0x4b0275(0x1e7)])clearTimeout(devices[_0x4bbe32][_0x4b0275(0x1e7)]);removeSocketListeners(getClient(_0xb56ab4['id'])['uuid']),addBlacklist(_0x4bbe32),devices[_0x4bbe32][_0x4b0275(0x1a7)]=null,devices[_0x4bbe32][_0x4b0275(0x23e)]=null,devices[_0x4bbe32][_0x4b0275(0x1b2)]['token']=null,io['to'](getClient(_0xb56ab4['id'])['uuid'])[_0x4b0275(0x290)](_0x4b0275(0x20c),{'access':{'allow':![],'reason':_0x4b0275(0x1d3),'token':null}});}else logger['full'](_0x4b0275(0x172));});}function _0x146b(){const _0x1449f0=['2FA\x20required','startsWith','kill','createServer','1680191ScVNYe','onText','telegramEvents','767152YjHwxD','enabled\x20Bot\x20','login','warning','uuid-random','get-starting-balances','File\x20uploaded','apply','2FA\x20login\x20rejected','config/','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Unauthorized\x20attempt\x20to\x20log\x20out','stringify','deleteHistoryAlerts','isValid','index.html','output-000.log','zip/','get','$1_$2_$3','error\x20while\x20deleting\x20config\x20files:\x20','express-fileupload','place-order','/update\x20-\x20update\x20Balance\x20Bot\x0a','bbPassword','started','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','botname','toggleBotMode','secure','All\x20bots\x20running\x20right\x20now','util','params','::ffff:127.0.0.1','existsSync','0.0.0','/:bot/portfolio','show','Notifications\x20enabled\x0a','toString','410DAIwJC','Allow\x20login\x20from\x20IP\x20address\x20<b>','join','includes','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','parse','All','2FA\x20login\x20required','readFileSync','ipc','number','clientip','answerCallbackQuery','removeListener','yes','hex','bb/','from','crypto','exec','error','***','9302736ngIvsX','404\x20Not\x20Found','telegramIpApproval','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','manual','getTime','/upload-backup','child_process','placeOrder','stopPolling','mixpanel','Notifications\x20disabled\x0a','access','RSA-OAEP','Unauthorized\x20attempt\x20to\x20store\x20configuration','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','/:bot/performance','restarting\x20Bot\x20','Notifications\x20disabled','disconnect','SIGTERM','chat','alerts','timeshift','Invalid\x20authentication\x20token\x20(1)','generateKeyPairAsync','format','auto','static','handshake','rmSync','map','2FA\x20login\x20token\x20generated','log','lowdb','hybrid-crypto-js','reload','cloneDeep','Server','store-headless','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Notifications\x20enabled','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','latestversion','/enable\x20-\x20enable\x20notifications\x0a','logged\x20out','/:bot/coins','No\x20authentication\x20token','Token\x20blacklisted','Restore\x20process\x20aborted','settings','temp/','padStart','entries','telegramEnabled','/:bot/history','invalid\x20credentials','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','127.0.0.1','socket.io','bbvNew','disabled\x20Bot\x20','notification','Unauthorized\x20login\x20attempt\x20(timeout)','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','pidExpireLogin','simple','sortBy','temporaryAccessAllowed','secret','telegram','inherit','request','axios','cancelLoading','update-bb','462NeCSfa','lastmsgemitted','args','assign','_data','initclient','use','exp','build2','userid','decrypt','/download/:type','temporary\x20access\x20rejected','defaults','ipaddr.js','argv','Bot\x20Mgr\x20>\x20','sign','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','replace',':\x20Bot\x20Mgr\x20>\x20','blacklist','botID','uncaughtException','telegramUsername','Invalid\x20IP\x20address','status','name',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','copyFileSync','(((.+)+)+)+$','slice','type','logout','any','filter','Failed\x20to\x20download\x20','loginRequired','constructor','version','sendFile','getPortfolio','updatebotmanager','Markdown','sort','apiKey','alias','min','Login\x20rejected','date-fns','160027pmJSdl','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Access\x20enabled\x20for\x20','event','7324830tCzTko','getDate','Unauthorized\x20attempt\x20to\x20add\x20bot','sockets','storeHeadless','value','full','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','ipv6','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','/help\x20-\x20show\x20available\x20commands\x0a','-----------------------------------------------------------------------------------','isIPv4MappedAddress','polling_error','store-configuration','publicKey','User\x20has\x20been\x20validated','logs/','expiry','createWriteStream','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','telegram2FaApproval','match','set','bot-','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','\x20minutes','backup/','encryptedUuid','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','node-zip','sha256','send','keys','live','bot.js','Bot\x20','get-messages','allow','*$1*','file','reason','/disable\x20-\x20disable\x20notifications\x0a','env','mode','backup','getStartingBalances','Unauthorized\x20attempt\x20to\x20get\x20messages','readdirSync','graphql-request','confirm-message','tkn','\x20>\x20','reject','sendPortfolioTelegram','token','running','Password\x20has\x20been\x20reset\x20to:\x20','find','remove','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','success','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Temporary\x20access\x20rejected','lastmsgtelegram','fork','Orders','privateKey','You\x20can\x20use\x20the\x20following\x20commands:\x0a','deleted\x20Bot\x20','bot','https://api.ipify.org?format=json','path','getSeconds','new-disabled','once','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','length','2FA','Unauthorized\x20attempt\x20to\x20confirm\x20message','Ok,\x20will\x20send\x20alert\x20notifications\x20only','forEach','delete-bot','output-003.log','/off\x20-\x20stop\x20bot(s)\x0a','bb-settings.json','Starting\x20Balance\x20Bot\x20update','yargs/yargs','No\x20bots\x20running\x20right\x20now','<b>Balance\x20Bot\x20Status:</b>\x0a','push','Unauthorized\x20attempt\x20to\x20delete\x20bot','output-001.log','toggle-bot-mode','bcryptjs','f2aRequired','stop','showname','stopped','Login\x20accepted','sendMessage','</b>\x20?','emit','bots','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','listen','\x20|\x20','getHours','/output-000.log','unlinkSync','emitHistory','password','test','uuid','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','data','exit','369675xlCAxr','mkdirSync','telegramToken','<b>Telegram\x20Bot\x20Status:</b>\x0a','hashSync','store','username','auth','bb-secure.json','Unauthorized\x20attempt\x20to\x20update\x20bot','jsonwebtoken','store-settings','NTBA_FIX_319','botmanager','isDirectory','get-logs','HTML','temporary\x20access\x20timeout','Ok,\x20will\x20send\x20order\x20notifications\x20only','then','5296254TiYtts','toIPv4MappedAddress','show-config','function','logs','randomFillSync','/:bot/support','title','binary','All\x20bots','conn','order','randomBytes','size','callback_query','headless','writeFileSync','headers','\x20mode','api-eu.mixpanel.com','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Crypt','getMonth','toIPv4Address','settings.','login\x20token\x20generated','timestamp','split','-config.json','bbvReceive','\x20(1)','new','/:bot','all','port','message','socket','remoteAddress','Invalid\x20authentication\x20token\x20(2)','telegrammsg','3000','messages','whitelist','Yes','orders','node-telegram-bot-api','2SbXamj','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','user','************','output-002.log','pidRefreshToken','starting\x20new\x20bot\x20|\x20Bot\x20','lowdb/adapters/FileSync','bbUsername','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','getMinutes','verify','add-bot','getFullYear','showConfig','.zip','catch','temporary\x20token\x20generated','build','connection','Unauthorized\x20attempt\x20to\x20download\x20','hasOwnProperty','login\x20required','-performance.json','restart','\x20(2)','telegramChatId','write','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','disabled','Invalid\x20Telegram\x20token','enabled','download','compareSync','files'];_0x146b=function(){return _0x1449f0;};return _0x146b();}function initializeSocketBot(_0xb19ef8){const _0x5fa94b=_0x1a47b6,_0x142350=getClient(_0xb19ef8['id'])[_0x5fa94b(0x270)],_0x2158a4=getClient(_0xb19ef8['id'])[_0x5fa94b(0x29b)];_0xb19ef8['on'](_0x5fa94b(0x2ae),(_0x440dbe,_0x51991c)=>{const _0x544f7d=_0x5fa94b;if(validateAccess(_0x51991c,_0x2158a4)[_0x544f7d(0x250)]){if(pid[_0x142350])pid[_0x142350][_0x544f7d(0x24a)]({'function':_0x544f7d(0x298),'args':_0x440dbe});}else logger[_0x544f7d(0x22e)]('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0xb19ef8['on']('delete-alerts',(_0x161db0,_0x5089fc)=>{const _0xc4109f=_0x5fa94b;if(validateAccess(_0x5089fc,_0x2158a4)[_0xc4109f(0x250)]){if(pid[_0x142350])pid[_0x142350][_0xc4109f(0x24a)]({'function':_0xc4109f(0x174),'args':_0x161db0});}else logger[_0xc4109f(0x22e)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0xb19ef8['on']('get-portfolio',(_0x9123d1,_0x4ec21b)=>{const _0x260401=_0x5fa94b;if(validateAccess(_0x4ec21b,_0x2158a4)[_0x260401(0x250)]){if(pid[_0x142350])pid[_0x142350]['send']({'function':_0x260401(0x21b),'args':_0x9123d1});}else logger[_0x260401(0x22e)](_0x260401(0x171));}),_0xb19ef8['on'](_0x5fa94b(0x237),(_0x5bf97f,_0x49c19b)=>{const _0x25385a=_0x5fa94b;if(validateAccess(_0x49c19b,_0x2158a4)[_0x25385a(0x250)]){if(pid[_0x142350])pid[_0x142350][_0x25385a(0x24a)]({'function':'storeConfiguration','args':_0x5bf97f});}else logger['full'](_0x25385a(0x1b4));}),_0xb19ef8['on'](_0x5fa94b(0x1cd),(_0x26404d,_0x4ac460)=>{const _0x25d4ce=_0x5fa94b;if(validateAccess(_0x4ac460,_0x2158a4)['allow']){if(pid[_0x142350])pid[_0x142350][_0x25d4ce(0x24a)]({'function':_0x25d4ce(0x22c),'args':_0x26404d});}else logger[_0x25d4ce(0x22e)](_0x25d4ce(0x146));}),_0xb19ef8['on'](_0x5fa94b(0x16c),_0x2411e7=>{const _0xb99d8b=_0x5fa94b;if(validateAccess(_0x2411e7,_0x2158a4)['allow']){if(pid[_0x142350])pid[_0x142350]['send']({'function':_0xb99d8b(0x258),'args':null});}else logger[_0xb99d8b(0x22e)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0xb19ef8['on'](_0x5fa94b(0x17d),(_0x2a5a74,_0x2772ef)=>{const _0x3c97cb=_0x5fa94b;if(validateAccess(_0x2772ef,_0x2158a4)[_0x3c97cb(0x250)]){if(pid[_0x142350])pid[_0x142350][_0x3c97cb(0x24a)]({'function':_0x3c97cb(0x1ae),'args':_0x2a5a74});}else logger[_0x3c97cb(0x22e)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0xb19ef8['on']('cancel-loading',_0x104e5a=>{const _0x4e2916=_0x5fa94b;if(validateAccess(_0x104e5a,_0x2158a4)[_0x4e2916(0x250)]){if(pid[_0x142350])pid[_0x142350][_0x4e2916(0x24a)]({'function':_0x4e2916(0x1f0),'args':null});}else logger[_0x4e2916(0x22e)](_0x4e2916(0x242));}),_0xb19ef8['on'](_0x5fa94b(0x2b5),_0x205bab=>{const _0x19b360=_0x5fa94b;if(validateAccess(_0x205bab,_0x2158a4)['allow']){if(pid[_0x142350])pid[_0x142350][_0x19b360(0x24a)]({'function':_0x19b360(0x14b),'args':null});}else logger[_0x19b360(0x22e)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0xb19ef8['on'](_0x5fa94b(0x1f1),_0x26ad1a=>{const _0x147852=_0x5fa94b;if(validateAccess(_0x26ad1a,_0x2158a4)[_0x147852(0x250)])updateBB();else logger['full'](_0x147852(0x1a9));}),_0xb19ef8['on'](_0x5fa94b(0x24f),_0x2c322b=>{const _0x2165e6=_0x5fa94b;if(validateAccess(_0x2c322b,_0x2158a4)[_0x2165e6(0x250)])getMessages();else logger[_0x2165e6(0x22e)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0xb19ef8['on'](_0x5fa94b(0x25c),(_0x400413,_0x98e9f4)=>{const _0x3a6405=_0x5fa94b;if(validateAccess(_0x98e9f4,_0x2158a4)[_0x3a6405(0x250)])confirmMessage(_0x400413);else logger['full'](_0x3a6405(0x279));}),_0xb19ef8['on'](_0x5fa94b(0x213),_0x958037=>{const _0xafd3b4=_0x5fa94b;if(validateAccess(_0x958037,_0x2158a4)['allow']){if(devices[_0x2158a4][_0xafd3b4(0x142)])clearTimeout(devices[_0x2158a4]['pidRefreshToken']);if(devices[_0x2158a4]['pidExpireLogin'])clearTimeout(devices[_0x2158a4][_0xafd3b4(0x1e7)]);removeSocketListeners(getClient(_0xb19ef8['id'])[_0xafd3b4(0x29b)]),addBlacklist(_0x2158a4),devices[_0x2158a4][_0xafd3b4(0x1a7)]=null,devices[_0x2158a4][_0xafd3b4(0x23e)]=null,devices[_0x2158a4]['access'][_0xafd3b4(0x261)]=null,io['to'](getClient(_0xb19ef8['id'])[_0xafd3b4(0x29b)])['emit'](_0xafd3b4(0x20c),{'access':{'allow':![],'reason':_0xafd3b4(0x1d3),'token':null}});}else logger[_0xafd3b4(0x22e)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x5935d3){const _0x4f5d25=_0x1a47b6;getClientsWithUuid(_0x5935d3)[_0x4f5d25(0x27b)](_0x5030fc=>{getSocket(_0x5030fc['id'])['removeAllListeners']();});}function cleanSettings(){const _0x4c97b3=_0x1a47b6;let _0x352c01=settings;return settings[_0x4c97b3(0x2a1)]&&settings['telegramToken']!=''&&(_0x352c01={..._0x352c01,'telegramToken':_0x4c97b3(0x140)}),settings[_0x4c97b3(0x17f)]&&settings[_0x4c97b3(0x17f)]!=''&&(_0x352c01={..._0x352c01,'bbPassword':_0x4c97b3(0x140)}),(settings[_0x4c97b3(0x17f)]&&settings[_0x4c97b3(0x17f)]=='***'||settings[_0x4c97b3(0x2a1)]&&settings[_0x4c97b3(0x2a1)]==_0x4c97b3(0x1a4))&&(_0x352c01={..._0x352c01,'restored':{'password':settings[_0x4c97b3(0x17f)]==_0x4c97b3(0x1a4),'telegram':settings[_0x4c97b3(0x2a1)]==_0x4c97b3(0x1a4)}}),_0x352c01;}function updateBB(){const _0x53a395=_0x1a47b6;installingUpdate=!![],config['forEach'](_0x4a14f4=>{restartBot(_0x4a14f4['botID']);}),process[_0x53a395(0x24a)]({'update':!![]},_0x16b05e=>{});}function startBot(_0xc763ec,_0x5effea,_0x29af75){const _0x5ce588=_0x1a47b6;let _0x4ba4f3=![];const _0x3f4ad4=_0xc763ec[0x0];_0x5effea={..._0x5effea,'stdio':[_0x5ce588(0x1ed),_0x5ce588(0x1ed),'inherit',_0x5ce588(0x198)]},pid[_0x3f4ad4]=childProcess[_0x5ce588(0x26b)](botfile,_0xc763ec,_0x5effea),pid[_0x3f4ad4]['on'](_0x5ce588(0x132),_0xbdf9d=>{const _0xd9f29c=_0x5ce588;switch(Object[_0xd9f29c(0x24b)](_0xbdf9d)[0x0]){case _0xd9f29c(0x182):updateBotName(_0x3f4ad4,_0xbdf9d[_0xd9f29c(0x182)]);break;case _0xd9f29c(0x21c):updateBotManager();break;case _0xd9f29c(0x20c):updateStatus(_0x3f4ad4,_0xbdf9d[_0xd9f29c(0x20c)]);break;case _0xd9f29c(0x24c):updateLive(_0x3f4ad4,_0xbdf9d[_0xd9f29c(0x24c)]);break;case _0xd9f29c(0x180):updateLive(_0x3f4ad4,_0xbdf9d[_0xd9f29c(0x180)]),io['to'](_0x3f4ad4)[_0xd9f29c(0x290)]('status',{'access':{'allow':![],'reason':_0xd9f29c(0x1ca),'token':null}});break;case _0xd9f29c(0x28a):_0xbdf9d['stop']==_0xd9f29c(0x155)&&restartBot(_0x3f4ad4);_0xbdf9d[_0xd9f29c(0x28a)]==_0xd9f29c(0x162)&&toggleBot(_0x3f4ad4,'disabled',_0xd9f29c(0x28c));break;case _0xd9f29c(0x1ec):sendTelegram(_0x3f4ad4,_0xbdf9d[_0xd9f29c(0x1ec)]);break;case _0xd9f29c(0x136):sendTelegramMsg(_0xbdf9d[_0xd9f29c(0x136)]);break;case _0xd9f29c(0x2b6):io['to'](_0x3f4ad4)[_0xd9f29c(0x290)](_0xbdf9d[_0xd9f29c(0x2b6)],_0xbdf9d[_0xd9f29c(0x1f4)]);break;}}),pid[_0x3f4ad4]['on'](_0x5ce588(0x1a3),function(_0x585644){if(_0x4ba4f3)return;_0x4ba4f3=!![],_0x29af75(_0x585644);}),pid[_0x3f4ad4]['on'](_0x5ce588(0x29e),async function(_0x2722b9){const _0x2f10c9=_0x5ce588;if(installingUpdate)return;if(_0x4ba4f3)return;_0x4ba4f3=!![],_0x29af75(null);const _0xb28d5d=dbConfig[_0x2f10c9(0x179)](_0x2f10c9(0x291))['find']({'botID':_0x3f4ad4})['value']();_0xb28d5d&&(_0xb28d5d[_0x2f10c9(0x20c)]==_0x2f10c9(0x15c)||_0xb28d5d[_0x2f10c9(0x20c)]==_0x2f10c9(0x12e))&&(await sleep(0x3e8),updateLive(_0x3f4ad4,_0x2f10c9(0x28c)),logger['full'](_0x2f10c9(0x1b7)+_0x3f4ad4),startBot([_0x3f4ad4,userID],{'cwd':bbpath},function(_0x1b294f){const _0x5d8586=_0x2f10c9;if(_0x1b294f)logger[_0x5d8586(0x22e)](_0x1b294f);}));});}function stopBot(_0x2685bd){const _0x148bd4=_0x1a47b6;getClientsWithBotID(_0x2685bd)[_0x148bd4(0x27b)](_0x23514f=>{const _0x438c83=_0x148bd4;getSocket(_0x23514f['id'])[_0x438c83(0x1b9)](!![]),removeClient(_0x23514f['id']);}),pid[_0x2685bd]&&(pid[_0x2685bd][_0x148bd4(0x162)](),pid[_0x2685bd]=null);}function restartBot(_0x31ae3e){const _0x39d21a=_0x1a47b6;if(pid[_0x31ae3e])pid[_0x31ae3e][_0x39d21a(0x162)]();}function addBot(){const _0x1028b7=_0x1a47b6;let _0xc77acb;for(let _0x549b21=0x1;_0x549b21<0x3e9;_0x549b21++){_0xc77acb=_0x549b21[_0x1028b7(0x18e)]()[_0x1028b7(0x1da)](0x3,'0');let _0x5b5849=config[_0x1028b7(0x264)](_0x2fcbb7=>_0x2fcbb7[_0x1028b7(0x208)]==_0xc77acb);if(!_0x5b5849)break;}if(_0xc77acb==='1000'){logger[_0x1028b7(0x22e)](_0x1028b7(0x1d0));return;}logger['full'](_0x1028b7(0x143)+_0xc77acb),dbConfig[_0x1028b7(0x179)](_0x1028b7(0x291))[_0x1028b7(0x284)]({'botID':_0xc77acb,'botname':_0x1028b7(0x24e)+_0xc77acb,'status':_0x1028b7(0x12e),'live':''})[_0x1028b7(0x158)](),startBot([_0xc77acb,userID],{'cwd':bbpath},function(_0x23723e){const _0x4bb21a=_0x1028b7;if(_0x23723e)logger[_0x4bb21a(0x22e)](_0x23723e);}),config=getConfiguration(),io['to'](_0x1028b7(0x2ac))['emit'](_0x1028b7(0x291),config);}function deleteBot(_0x1e202e){const _0x144741=_0x1a47b6;getClientsWithBotID(_0x1e202e)['forEach'](_0x45fc54=>{getSocket(_0x45fc54['id'])['disconnect'](!![]),removeClient(_0x45fc54['id']);}),dbConfig[_0x144741(0x179)](_0x144741(0x291))['remove']({'botID':_0x1e202e})['write'](),logger[_0x144741(0x22e)](_0x144741(0x26f)+_0x1e202e),stopBot(_0x1e202e);try{fs[_0x144741(0x297)](path[_0x144741(0x191)](configpath,_0x144741(0x241)+_0x1e202e+_0x144741(0x12b))),fs[_0x144741(0x297)](path[_0x144741(0x191)](configpath,'bot-'+_0x1e202e+'-events.json')),fs[_0x144741(0x297)](path[_0x144741(0x191)](configpath,_0x144741(0x241)+_0x1e202e+_0x144741(0x154))),fs[_0x144741(0x297)](path[_0x144741(0x191)](configpath,_0x144741(0x241)+_0x1e202e+'-results.json'));}catch(_0x3393ab){if(_0x3393ab)logger[_0x144741(0x22e)](_0x144741(0x17b),_0x3393ab);}config=getConfiguration(),io['to'](_0x144741(0x2ac))[_0x144741(0x290)]('bots',config);}function toggleBot(_0x2c9d60,_0x2eadc7,_0x5db037){const _0x57bbe8=_0x1a47b6;dbConfig[_0x57bbe8(0x179)]('bots')[_0x57bbe8(0x264)]({'botID':_0x2c9d60})[_0x57bbe8(0x1f5)]({'status':_0x2eadc7})[_0x57bbe8(0x1f5)]({'live':_0x5db037})[_0x57bbe8(0x158)]();if(_0x2eadc7==_0x57bbe8(0x15c)||_0x2eadc7==_0x57bbe8(0x12e))logger['full'](_0x57bbe8(0x168)+_0x2c9d60),startBot([_0x2c9d60,userID],{'cwd':bbpath},function(_0x2981fd){if(_0x2981fd)logger['full'](_0x2981fd);});else(_0x2eadc7==_0x57bbe8(0x15a)||_0x2eadc7==_0x57bbe8(0x274))&&(logger[_0x57bbe8(0x22e)](_0x57bbe8(0x1e3)+_0x2c9d60),stopBot(_0x2c9d60));config=getConfiguration(),io['to'](_0x57bbe8(0x2ac))[_0x57bbe8(0x290)](_0x57bbe8(0x291),config);}function toggleStatus(_0x560336){const _0x27365d=_0x1a47b6;let _0x4a0e11=dbConfig[_0x27365d(0x179)](_0x27365d(0x291))[_0x27365d(0x264)]({'botID':_0x560336})[_0x27365d(0x22d)](),_0x318634;if(_0x4a0e11[_0x27365d(0x20c)]==='enabled')_0x318634='disabled';else{if(_0x4a0e11[_0x27365d(0x20c)]===_0x27365d(0x12e))_0x318634=_0x27365d(0x274);else{if(_0x4a0e11[_0x27365d(0x20c)]===_0x27365d(0x274))_0x318634=_0x27365d(0x12e);else{if(_0x4a0e11[_0x27365d(0x20c)]===_0x27365d(0x15a))_0x318634=_0x27365d(0x15c);}}}return _0x318634;}function updateStatus(_0x13c257,_0x42f334){const _0xb8c1d2=_0x1a47b6;dbConfig[_0xb8c1d2(0x179)](_0xb8c1d2(0x291))[_0xb8c1d2(0x264)]({'botID':_0x13c257})[_0xb8c1d2(0x1f5)]({'status':_0x42f334})['write'](),config=getConfiguration(),io['to']('botmanager')[_0xb8c1d2(0x290)](_0xb8c1d2(0x291),config);}function updateLive(_0xe97bc0,_0xd0da2c){const _0x1d3aac=_0x1a47b6;dbConfig[_0x1d3aac(0x179)]('bots')[_0x1d3aac(0x264)]({'botID':_0xe97bc0})[_0x1d3aac(0x1f5)]({'live':_0xd0da2c})[_0x1d3aac(0x158)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x1d3aac(0x291),config);}function updateBotName(_0x59d8a7,_0x2b07f8){const _0x263b3f=_0x1a47b6;dbConfig[_0x263b3f(0x179)](_0x263b3f(0x291))[_0x263b3f(0x264)]({'botID':_0x59d8a7})[_0x263b3f(0x1f5)]({'botname':_0x2b07f8})[_0x263b3f(0x158)](),config=getConfiguration(),io['to']('botmanager')[_0x263b3f(0x290)](_0x263b3f(0x291),config);}function updateBotManager(){const _0x10e2c7=_0x1a47b6;config=getConfiguration(),io['to'](_0x10e2c7(0x2ac))[_0x10e2c7(0x290)](_0x10e2c7(0x291),config);}function toggleBotMode(_0x294616){const _0x3222bf=_0x1a47b6;if(pid[_0x294616])pid[_0x294616][_0x3222bf(0x24a)]({'function':_0x3222bf(0x183),'args':null});else{const _0x68c3d7=configpath+_0x3222bf(0x241)+_0x294616+_0x3222bf(0x12b),_0x3b5ea0=fs[_0x3222bf(0x197)](_0x68c3d7),_0x30264f=JSON['parse'](_0x3b5ea0),_0x57612a=_0x30264f[_0x3222bf(0x270)][0x0]['headless'];_0x30264f[_0x3222bf(0x270)][0x0][_0x3222bf(0x11e)]=!_0x57612a;const _0x29e21c=JSON['stringify'](_0x30264f,null,0x2);fs[_0x3222bf(0x11f)](_0x68c3d7,_0x29e21c),config=getConfiguration(),io['to']('botmanager')[_0x3222bf(0x290)](_0x3222bf(0x291),config);}}function telegramError(_0x5b78ab){const _0x20b4f8=_0x1a47b6;logger[_0x20b4f8(0x1e8)](getTimeStamp()+_0x20b4f8(0x20e));}function validateTelegram(_0x4d07ed){const _0x11349f=_0x1a47b6;if(_0x4d07ed[_0x11349f(0x1a0)][_0x11349f(0x2a5)]!=settings[_0x11349f(0x20a)]&&'@'+_0x4d07ed[_0x11349f(0x1a0)][_0x11349f(0x2a5)]!=settings[_0x11349f(0x20a)])return tgBot[_0x11349f(0x28e)](_0x4d07ed[_0x11349f(0x1bb)]['id'],_0x11349f(0x1ce),{'parse_mode':'HTML'})['catch'](_0x5bb9ca=>{telegramError(_0x5bb9ca);}),![];return!![];}async function initTelegram(){const _0x3a17a2=_0x1a47b6;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x3a17a2(0x2a1)],{'polling':!![]});let _0x8f2daf=_0x3a17a2(0x26e);_0x8f2daf+='\x0a',_0x8f2daf+=_0x3a17a2(0x1d2),_0x8f2daf+=_0x3a17a2(0x254),_0x8f2daf+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x8f2daf+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x8f2daf+='/on\x20-\x20start\x20bot(s)\x0a',_0x8f2daf+=_0x3a17a2(0x27e),_0x8f2daf+=_0x3a17a2(0x268),_0x8f2daf+='/names\x20-\x20show\x20bot\x20names\x0a',_0x8f2daf+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x8f2daf+=_0x3a17a2(0x204),_0x8f2daf+=_0x3a17a2(0x17e),_0x8f2daf+=_0x3a17a2(0x233);let _0xa1a16c=_0x3a17a2(0x193);_0xa1a16c+='\x0a',_0xa1a16c+=_0x8f2daf,tgBot['onText'](/\/start/,_0x56314b=>{const _0x44e19b=_0x3a17a2;if(!validateTelegram(_0x56314b))return;if(settings['telegramChatId']!=_0x56314b['chat']['id'])updateSetting('telegramChatId',_0x56314b[_0x44e19b(0x1bb)]['id']);updateSetting('telegramEnabled',!![]),tgBot['sendMessage'](_0x56314b[_0x44e19b(0x1bb)]['id'],_0xa1a16c)[_0x44e19b(0x14d)](_0x799144=>{telegramError(_0x799144);});}),tgBot[_0x3a17a2(0x165)](/\/enable/,_0x5407c5=>{const _0x3bd7c4=_0x3a17a2;if(!validateTelegram(_0x5407c5))return;if(settings[_0x3bd7c4(0x157)]!=_0x5407c5[_0x3bd7c4(0x1bb)]['id'])updateSetting(_0x3bd7c4(0x157),_0x5407c5[_0x3bd7c4(0x1bb)]['id']);updateSetting(_0x3bd7c4(0x1dc),!![]),tgBot['sendMessage'](_0x5407c5['chat']['id'],_0x3bd7c4(0x1cf))[_0x3bd7c4(0x14d)](_0x3f0696=>{telegramError(_0x3f0696);});}),tgBot[_0x3a17a2(0x165)](/\/config/,async _0x683d4d=>{const _0x2c422a=_0x3a17a2;if(!validateTelegram(_0x683d4d))return;tgBot[_0x2c422a(0x19c)](_0x2c422a(0x11d)),tgBot[_0x2c422a(0x28e)](_0x683d4d['chat']['id'],_0x2c422a(0x29c),{'reply_markup':{'inline_keyboard':[[{'text':_0x2c422a(0x26c),'callback_data':_0x2c422a(0x13b)},{'text':'Alerts','callback_data':'alerts'},{'text':_0x2c422a(0x195),'callback_data':_0x2c422a(0x130)}]]}})[_0x2c422a(0x14d)](_0x3bde00=>{telegramError(_0x3bde00);}),tgBot['on'](_0x2c422a(0x11d),async _0x50cc2d=>{const _0x68fc6=_0x2c422a,_0x4152cd=_0x50cc2d[_0x68fc6(0x29d)],_0x272394=_0x50cc2d[_0x68fc6(0x132)];tgBot[_0x68fc6(0x19b)](_0x50cc2d['id'])[_0x68fc6(0x2b2)](async()=>{const _0xa3403d=_0x68fc6;_0x4152cd==_0xa3403d(0x13b)&&(updateSetting(_0xa3403d(0x166),_0xa3403d(0x13b)),updateSetting(_0xa3403d(0x1dc),!![]),await tgBot[_0xa3403d(0x28e)](_0x272394['chat']['id'],_0xa3403d(0x2b1))[_0xa3403d(0x14d)](_0x5dc87b=>{telegramError(_0x5dc87b);}));_0x4152cd==_0xa3403d(0x1bc)&&(updateSetting(_0xa3403d(0x166),_0xa3403d(0x1bc)),updateSetting(_0xa3403d(0x1dc),!![]),await tgBot[_0xa3403d(0x28e)](_0x272394[_0xa3403d(0x1bb)]['id'],_0xa3403d(0x27a))[_0xa3403d(0x14d)](_0x3a8866=>{telegramError(_0x3a8866);}));_0x4152cd==_0xa3403d(0x130)&&(updateSetting('telegramEvents','all'),updateSetting(_0xa3403d(0x1dc),!![]),await tgBot[_0xa3403d(0x28e)](_0x272394[_0xa3403d(0x1bb)]['id'],_0xa3403d(0x123))[_0xa3403d(0x14d)](_0x2432d9=>{telegramError(_0x2432d9);}));if(!settings[_0xa3403d(0x157)])tgBot['sendMessage'](_0x272394[_0xa3403d(0x1bb)]['id'],_0xa3403d(0x247))[_0xa3403d(0x14d)](_0x3c53f6=>{telegramError(_0x3c53f6);});}),tgBot['removeListener'](_0x68fc6(0x11d));});}),tgBot[_0x3a17a2(0x165)](/\/status/,_0x41d797=>{const _0x4233b8=_0x3a17a2;if(!validateTelegram(_0x41d797))return;const _0x1a9dc6=getBotsWithMode();let _0x76eae=_0x4233b8(0x283);config[_0x4233b8(0x27b)](_0x2a809c=>{const _0x1aad4e=_0x4233b8,_0x363a34=_0x1a9dc6[_0x1aad4e(0x264)](_0x2c97be=>_0x2c97be['botID']==_0x2a809c['botID'])['mode'];_0x76eae+=_0x1aad4e(0x24e)+_0x2a809c[_0x1aad4e(0x208)]+':\x20'+_0x2a809c['status']+_0x1aad4e(0x294)+_0x363a34+_0x1aad4e(0x294)+_0x2a809c[_0x1aad4e(0x24c)]+'\x0a';}),_0x76eae+='\x0a',_0x76eae+=_0x4233b8(0x2a2),_0x76eae+=!settings[_0x4233b8(0x1dc)]?_0x4233b8(0x1b1):_0x4233b8(0x18d),_0x76eae+=settings[_0x4233b8(0x1dc)]?settings[_0x4233b8(0x166)]==_0x4233b8(0x130)?_0x4233b8(0x232):'Notifications\x20types:\x20'+settings[_0x4233b8(0x166)]+'\x20only\x0a':'',tgBot[_0x4233b8(0x28e)](_0x41d797[_0x4233b8(0x1bb)]['id'],_0x76eae,{'parse_mode':'HTML'})[_0x4233b8(0x14d)](_0x13ac92=>{telegramError(_0x13ac92);});}),tgBot[_0x3a17a2(0x165)](/\/restart/,_0x519549=>{const _0x5d0959=_0x3a17a2;if(!validateTelegram(_0x519549))return;tgBot[_0x5d0959(0x19c)](_0x5d0959(0x11d));const _0x326491=getEnabledBots();if(_0x326491[_0x5d0959(0x277)]==0x0)tgBot[_0x5d0959(0x28e)](_0x519549[_0x5d0959(0x1bb)]['id'],_0x5d0959(0x282))[_0x5d0959(0x14d)](_0x2f0376=>{telegramError(_0x2f0376);});else{if(_0x326491['length']>0x1)_0x326491['push']({'botID':_0x5d0959(0x130)});let _0x1d528a=[],_0x371890=[];const _0x4450bb=_0x326491[_0x5d0959(0x277)]%0x4==0x0||_0x326491[_0x5d0959(0x277)]%0x4==0x3||_0x326491[_0x5d0959(0x277)]%0x3==0x1?0x4:0x3;let _0x58fa97=0x0;_0x326491[_0x5d0959(0x27b)]((_0x225d1a,_0x2f9b3c)=>{const _0x14551f=_0x5d0959;if(_0x2f9b3c%_0x4450bb==0x0)_0x371890=[];_0x371890[_0x14551f(0x284)]({'text':_0x225d1a['botID']==_0x14551f(0x130)?_0x14551f(0x2bc):'Bot\x20'+_0x225d1a[_0x14551f(0x208)],'callback_data':_0x225d1a[_0x14551f(0x208)]}),_0x2f9b3c%_0x4450bb==0x0&&(_0x1d528a[_0x58fa97]=_0x371890,_0x58fa97++);}),tgBot['sendMessage'](_0x519549['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x1d528a}})[_0x5d0959(0x14d)](_0x1377da=>{telegramError(_0x1377da);}),tgBot['on'](_0x5d0959(0x11d),async _0x440132=>{const _0xa9a183=_0x5d0959,_0x4d0a1b=_0x440132[_0xa9a183(0x29d)],_0x5b4351=_0x440132['message'];tgBot[_0xa9a183(0x19b)](_0x440132['id'])[_0xa9a183(0x2b2)](async()=>{const _0x5d3e82=_0xa9a183;_0x4d0a1b==_0x5d3e82(0x130)?config[_0x5d3e82(0x27b)](_0xd271d8=>{const _0x920eb0=_0x5d3e82;restartBot(_0xd271d8[_0x920eb0(0x208)]);}):restartBot(_0x4d0a1b);}),tgBot[_0xa9a183(0x19c)](_0xa9a183(0x11d));});}}),tgBot['onText'](/\/on/,_0x5afef2=>{const _0x223311=_0x3a17a2;if(!validateTelegram(_0x5afef2))return;tgBot[_0x223311(0x19c)](_0x223311(0x11d));const _0x15f397=getDisabledBots();if(_0x15f397[_0x223311(0x277)]==0x0)tgBot[_0x223311(0x28e)](_0x5afef2['chat']['id'],_0x223311(0x185))['catch'](_0x330ca7=>{telegramError(_0x330ca7);});else{if(_0x15f397[_0x223311(0x277)]>0x1)_0x15f397[_0x223311(0x284)]({'botID':_0x223311(0x130)});let _0x12af59=[],_0x4817ba=[];const _0x1b2725=_0x15f397[_0x223311(0x277)]%0x4==0x0||_0x15f397['length']%0x4==0x3||_0x15f397[_0x223311(0x277)]%0x3==0x1?0x4:0x3;let _0xa4e5ed=0x0;_0x15f397[_0x223311(0x27b)]((_0x2180e5,_0x3c0541)=>{const _0x13f444=_0x223311;if(_0x3c0541%_0x1b2725==0x0)_0x4817ba=[];_0x4817ba[_0x13f444(0x284)]({'text':_0x2180e5[_0x13f444(0x208)]=='all'?_0x13f444(0x2bc):_0x13f444(0x24e)+_0x2180e5['botID'],'callback_data':_0x2180e5['botID']}),_0x3c0541%_0x1b2725==0x0&&(_0x12af59[_0xa4e5ed]=_0x4817ba,_0xa4e5ed++);}),tgBot[_0x223311(0x28e)](_0x5afef2[_0x223311(0x1bb)]['id'],_0x223311(0x13e),{'reply_markup':{'inline_keyboard':_0x12af59}})[_0x223311(0x14d)](_0x1981ab=>{telegramError(_0x1981ab);}),tgBot['on']('callback_query',async _0x9830cd=>{const _0x1db795=_0x223311,_0x45d4a8=_0x9830cd[_0x1db795(0x29d)],_0x245c78=_0x9830cd[_0x1db795(0x132)];tgBot[_0x1db795(0x19b)](_0x9830cd['id'])['then'](async()=>{const _0x1410e1=_0x1db795;_0x45d4a8==_0x1410e1(0x130)?(tgBot[_0x1410e1(0x28e)](_0x245c78[_0x1410e1(0x1bb)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')['catch'](_0x213e3c=>{telegramError(_0x213e3c);}),_0x15f397[_0x1410e1(0x27b)](_0x6569eb=>{const _0xb028e5=_0x1410e1;if(_0x6569eb['botID']!=_0xb028e5(0x130))toggleBot(_0x6569eb[_0xb028e5(0x208)],toggleStatus(_0x6569eb[_0xb028e5(0x208)]),_0xb028e5(0x28c));})):(tgBot[_0x1410e1(0x28e)](_0x245c78[_0x1410e1(0x1bb)]['id'],_0x1410e1(0x276)+_0x45d4a8)[_0x1410e1(0x14d)](_0x3152d6=>{telegramError(_0x3152d6);}),toggleBot(_0x45d4a8,toggleStatus(_0x45d4a8),'stopped'));}),tgBot[_0x1db795(0x19c)](_0x1db795(0x11d));});}}),tgBot[_0x3a17a2(0x165)](/\/off/,_0x538e2e=>{const _0x3c6945=_0x3a17a2;if(!validateTelegram(_0x538e2e))return;tgBot[_0x3c6945(0x19c)](_0x3c6945(0x11d));const _0x31a8ac=getEnabledBots();if(_0x31a8ac[_0x3c6945(0x277)]==0x0)tgBot[_0x3c6945(0x28e)](_0x538e2e[_0x3c6945(0x1bb)]['id'],_0x3c6945(0x282))[_0x3c6945(0x14d)](_0x4a9461=>{telegramError(_0x4a9461);});else{if(_0x31a8ac[_0x3c6945(0x277)]>0x1)_0x31a8ac[_0x3c6945(0x284)]({'botID':_0x3c6945(0x130)});let _0x2c1be9=[],_0x54b4de=[];const _0x1042ea=_0x31a8ac['length']%0x4==0x0||_0x31a8ac[_0x3c6945(0x277)]%0x4==0x3||_0x31a8ac[_0x3c6945(0x277)]%0x3==0x1?0x4:0x3;let _0xdbe41a=0x0;_0x31a8ac[_0x3c6945(0x27b)]((_0x324ce3,_0x207e79)=>{const _0x34cb6f=_0x3c6945;if(_0x207e79%_0x1042ea==0x0)_0x54b4de=[];_0x54b4de['push']({'text':_0x324ce3[_0x34cb6f(0x208)]==_0x34cb6f(0x130)?_0x34cb6f(0x2bc):_0x34cb6f(0x24e)+_0x324ce3[_0x34cb6f(0x208)],'callback_data':_0x324ce3[_0x34cb6f(0x208)]}),_0x207e79%_0x1042ea==0x0&&(_0x2c1be9[_0xdbe41a]=_0x54b4de,_0xdbe41a++);}),tgBot['sendMessage'](_0x538e2e[_0x3c6945(0x1bb)]['id'],_0x3c6945(0x22f),{'reply_markup':{'inline_keyboard':_0x2c1be9}})['catch'](_0x466c40=>{telegramError(_0x466c40);}),tgBot['on'](_0x3c6945(0x11d),async _0x2e98d3=>{const _0x1b165e=_0x3c6945,_0x38f7c6=_0x2e98d3[_0x1b165e(0x29d)],_0x28ab75=_0x2e98d3[_0x1b165e(0x132)];tgBot['answerCallbackQuery'](_0x2e98d3['id'])[_0x1b165e(0x2b2)](async()=>{const _0x3393cc=_0x1b165e;_0x38f7c6==_0x3393cc(0x130)?(tgBot[_0x3393cc(0x28e)](_0x28ab75[_0x3393cc(0x1bb)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')['catch'](_0x367992=>{telegramError(_0x367992);}),_0x31a8ac[_0x3393cc(0x27b)](_0x376bee=>{const _0x3f325f=_0x3393cc;if(_0x376bee[_0x3f325f(0x208)]!=_0x3f325f(0x130))toggleBot(_0x376bee[_0x3f325f(0x208)],toggleStatus(_0x376bee[_0x3f325f(0x208)]),_0x3f325f(0x28c));})):(tgBot[_0x3393cc(0x28e)](_0x28ab75[_0x3393cc(0x1bb)]['id'],_0x3393cc(0x1e6)+_0x38f7c6)[_0x3393cc(0x14d)](_0x3b754=>{telegramError(_0x3b754);}),toggleBot(_0x38f7c6,toggleStatus(_0x38f7c6),'stopped'));}),tgBot[_0x1b165e(0x19c)]('callback_query');});}}),tgBot[_0x3a17a2(0x165)](/\/portfolio/,_0x2e0331=>{const _0x498a08=_0x3a17a2;if(!validateTelegram(_0x2e0331))return;tgBot[_0x498a08(0x19c)]('callback_query');const _0x4f4e8a=getEnabledBots();if(_0x4f4e8a[_0x498a08(0x277)]==0x0)tgBot[_0x498a08(0x28e)](_0x2e0331[_0x498a08(0x1bb)]['id'],_0x498a08(0x282))[_0x498a08(0x14d)](_0x5c4e92=>{telegramError(_0x5c4e92);});else{if(_0x4f4e8a[_0x498a08(0x277)]>0x1){let _0x59993d=[],_0x3f3c8c=[];const _0x4bbcd8=_0x4f4e8a[_0x498a08(0x277)]%0x4==0x0||_0x4f4e8a[_0x498a08(0x277)]%0x4==0x3||_0x4f4e8a[_0x498a08(0x277)]%0x3==0x1?0x4:0x3;let _0x2eed8c=0x0;_0x4f4e8a[_0x498a08(0x27b)]((_0x109867,_0x1be690)=>{const _0x1c1722=_0x498a08;if(_0x1be690%_0x4bbcd8==0x0)_0x3f3c8c=[];_0x3f3c8c[_0x1c1722(0x284)]({'text':_0x1c1722(0x24e)+_0x109867['botID'],'callback_data':_0x109867[_0x1c1722(0x208)]}),_0x1be690%_0x4bbcd8==0x0&&(_0x59993d[_0x2eed8c]=_0x3f3c8c,_0x2eed8c++);}),tgBot['sendMessage'](_0x2e0331[_0x498a08(0x1bb)]['id'],_0x498a08(0x230),{'reply_markup':{'inline_keyboard':_0x59993d}})[_0x498a08(0x14d)](_0x170598=>{telegramError(_0x170598);}),tgBot['on'](_0x498a08(0x11d),async _0x321c7e=>{const _0x39e13e=_0x498a08,_0x41885e=_0x321c7e[_0x39e13e(0x29d)],_0x25104b=_0x321c7e[_0x39e13e(0x132)];tgBot['answerCallbackQuery'](_0x321c7e['id'])[_0x39e13e(0x2b2)](async()=>{const _0x324e42=_0x39e13e;if(pid[_0x41885e])pid[_0x41885e]['send']({'function':_0x324e42(0x260),'args':null});}),tgBot['removeListener'](_0x39e13e(0x11d));});}else{const _0x466ad0=_0x4f4e8a[0x0][_0x498a08(0x208)];if(pid[_0x466ad0])pid[_0x466ad0][_0x498a08(0x24a)]({'function':_0x498a08(0x260),'args':null});}}}),tgBot[_0x3a17a2(0x165)](/\/update/,async _0x2144b9=>{const _0x53a6e7=_0x3a17a2;if(!validateTelegram(_0x2144b9))return;tgBot[_0x53a6e7(0x19c)](_0x53a6e7(0x11d)),await getMessages();if(!updateAvailable)tgBot[_0x53a6e7(0x28e)](_0x2144b9[_0x53a6e7(0x1bb)]['id'],_0x53a6e7(0x225))['catch'](_0x3f7cc3=>{telegramError(_0x3f7cc3);});else!validInstallation?tgBot[_0x53a6e7(0x28e)](_0x2144b9[_0x53a6e7(0x1bb)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0x53a6e7(0x14d)](_0x3b18be=>{telegramError(_0x3b18be);}):(tgBot[_0x53a6e7(0x28e)](_0x2144b9['chat']['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x53a6e7(0x13a),'callback_data':_0x53a6e7(0x19d)},{'text':'No','callback_data':'no'}]]}})[_0x53a6e7(0x14d)](_0x59f229=>{telegramError(_0x59f229);}),tgBot['on'](_0x53a6e7(0x11d),async _0x4c0ef1=>{const _0x192ce2=_0x53a6e7,_0x1cafd2=_0x4c0ef1['data'],_0x268a40=_0x4c0ef1[_0x192ce2(0x132)];tgBot[_0x192ce2(0x19b)](_0x4c0ef1['id'])[_0x192ce2(0x2b2)](async()=>{const _0x1b7161=_0x192ce2;_0x1cafd2==_0x1b7161(0x19d)&&(await tgBot['sendMessage'](_0x268a40[_0x1b7161(0x1bb)]['id'],_0x1b7161(0x280))['catch'](_0x393210=>{telegramError(_0x393210);}),updateBB());_0x1cafd2=='no'&&await tgBot[_0x1b7161(0x28e)](_0x268a40[_0x1b7161(0x1bb)]['id'],_0x1b7161(0x1df))['catch'](_0x1a93e3=>{telegramError(_0x1a93e3);});if(!settings[_0x1b7161(0x157)])tgBot[_0x1b7161(0x28e)](_0x268a40[_0x1b7161(0x1bb)]['id'],_0x1b7161(0x247))[_0x1b7161(0x14d)](_0x179a6d=>{telegramError(_0x179a6d);});}),tgBot[_0x192ce2(0x19c)](_0x192ce2(0x11d));}));}),tgBot[_0x3a17a2(0x165)](/\/toggle/,_0x14e146=>{const _0xd5ddea=_0x3a17a2;if(!validateTelegram(_0x14e146))return;tgBot[_0xd5ddea(0x19c)]('callback_query');const _0x225efe=getBotsWithMode();if(_0x225efe[_0xd5ddea(0x277)]==0x0)tgBot[_0xd5ddea(0x28e)](_0x14e146[_0xd5ddea(0x1bb)]['id'],_0xd5ddea(0x282))[_0xd5ddea(0x14d)](_0x4c6f9e=>{telegramError(_0x4c6f9e);});else{let _0x4c0d46=[],_0x522620=[];const _0x1dc1ea=0x2;let _0x40959b=0x0;_0x225efe[_0xd5ddea(0x27b)]((_0x73fb2a,_0x537444)=>{const _0x55731e=_0xd5ddea;if(_0x537444%_0x1dc1ea==0x0)_0x522620=[];_0x522620[_0x55731e(0x284)]({'text':'Bot\x20'+_0x73fb2a[_0x55731e(0x208)]+'\x20('+_0x73fb2a[_0x55731e(0x256)]+')','callback_data':_0x73fb2a[_0x55731e(0x208)]}),_0x537444%_0x1dc1ea==0x0&&(_0x4c0d46[_0x40959b]=_0x522620,_0x40959b++);}),tgBot[_0xd5ddea(0x28e)](_0x14e146[_0xd5ddea(0x1bb)]['id'],_0xd5ddea(0x246),{'reply_markup':{'inline_keyboard':_0x4c0d46}})[_0xd5ddea(0x14d)](_0x4e7dc2=>{telegramError(_0x4e7dc2);}),tgBot['on'](_0xd5ddea(0x11d),async _0x408eba=>{const _0x1866f7=_0xd5ddea,_0x1c6c9b=_0x408eba[_0x1866f7(0x29d)],_0x41be7a=_0x408eba[_0x1866f7(0x132)];tgBot[_0x1866f7(0x19b)](_0x408eba['id'])['then'](async()=>{const _0x4954fe=_0x1866f7,_0x267ce5=_0x225efe[_0x4954fe(0x264)](_0x2d0c15=>_0x2d0c15[_0x4954fe(0x208)]==_0x1c6c9b),_0x1e9d12=_0x267ce5['mode']==_0x4954fe(0x1c1)?'manual':_0x4954fe(0x1c1);tgBot[_0x4954fe(0x28e)](_0x41be7a['chat']['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x1c6c9b+'\x20to\x20'+_0x1e9d12+_0x4954fe(0x121))[_0x4954fe(0x14d)](_0x2089e4=>{telegramError(_0x2089e4);}),toggleBotMode(_0x1c6c9b);}),tgBot[_0x1866f7(0x19c)]('callback_query');});}}),tgBot[_0x3a17a2(0x165)](/\/names/,_0x19ec01=>{const _0x338995=_0x3a17a2;if(!validateTelegram(_0x19ec01))return;let _0x4a84aa='';config[_0x338995(0x27b)](_0x3c50af=>{const _0x4cb518=_0x338995;_0x4a84aa+=_0x4cb518(0x24e)+_0x3c50af[_0x4cb518(0x208)]+':\x20'+_0x3c50af[_0x4cb518(0x182)]+'\x0a';}),tgBot['sendMessage'](_0x19ec01[_0x338995(0x1bb)]['id'],_0x4a84aa,{'parse_mode':'HTML'})['catch'](_0x53e39e=>{telegramError(_0x53e39e);});}),tgBot[_0x3a17a2(0x165)](/\/disable/,_0x23269f=>{const _0x2b2211=_0x3a17a2;if(!validateTelegram(_0x23269f))return;tgBot[_0x2b2211(0x28e)](_0x23269f[_0x2b2211(0x1bb)]['id'],_0x2b2211(0x1b8))['catch'](_0x2d9ba7=>{telegramError(_0x2d9ba7);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x3a17a2(0x165)](/\/help/,_0x127f97=>{const _0xc81a63=_0x3a17a2;if(!validateTelegram(_0x127f97))return;tgBot['sendMessage'](_0x127f97['chat']['id'],_0x8f2daf)[_0xc81a63(0x14d)](_0x389a0a=>{telegramError(_0x389a0a);});}),tgBot['on'](_0x3a17a2(0x236),_0xe0ebc3=>{const _0x38ddd4=_0x3a17a2;_0xe0ebc3['toString']()['includes'](_0x38ddd4(0x1a6))&&(logger[_0x38ddd4(0x22e)](_0x38ddd4(0x15b)),tgBot[_0x38ddd4(0x1af)](),tgBot=null,io['to'](_0x38ddd4(0x2ac))['emit'](_0x38ddd4(0x1e4),_0x38ddd4(0x15b)));}),process[_0x3a17a2(0x275)]('SIGINT',()=>{const _0x23c222=_0x3a17a2;if(tgBot)tgBot[_0x23c222(0x1af)]();process[_0x23c222(0x29e)](0x1);}),process[_0x3a17a2(0x275)](_0x3a17a2(0x1ba),()=>{const _0x503221=_0x3a17a2;if(tgBot)tgBot['stopPolling']();process[_0x503221(0x29e)](0x1);});}}function disableTelegram(){const _0x3955c2=_0x1a47b6;tgBot&&(tgBot[_0x3955c2(0x1af)](),tgBot=null);}function sendTelegram(_0x519bda,_0x131118){const _0x52d540=_0x1a47b6;if(settings[_0x52d540(0x1dc)]){if(settings['telegramEvents']==_0x52d540(0x130)||(_0x131118[_0x52d540(0x212)]==_0x52d540(0x1a3)||_0x131118[_0x52d540(0x212)]==_0x52d540(0x16a)||_0x131118[_0x52d540(0x212)]=='success')&&settings['telegramEvents']=='alerts'||_0x131118['type']==_0x52d540(0x2be)&&settings[_0x52d540(0x166)]==_0x52d540(0x13b)){if(tgBot&&settings[_0x52d540(0x157)]){if(_0x131118[_0x52d540(0x28b)])tgBot[_0x52d540(0x28e)](settings['telegramChatId'],_0x131118['botname']+_0x52d540(0x25e)+_0x131118[_0x52d540(0x227)])[_0x52d540(0x14d)](_0x269de0=>{telegramError(_0x269de0);});else tgBot[_0x52d540(0x28e)](settings[_0x52d540(0x157)],_0x52d540(0x24e)+_0x519bda+'\x20>\x20'+_0x131118[_0x52d540(0x227)])[_0x52d540(0x14d)](_0x3f2822=>{telegramError(_0x3f2822);});}}}}async function sendTelegramMsg(_0x407984,_0x52b08d='HTML'){const _0x3e2adc=_0x1a47b6;return settings[_0x3e2adc(0x1dc)]&&tgBot&&settings['telegramChatId']?(await tgBot[_0x3e2adc(0x28e)](settings[_0x3e2adc(0x157)],_0x407984,{'parse_mode':_0x52b08d})[_0x3e2adc(0x14d)](_0x511d28=>{telegramError(_0x511d28);}),!![]):![];}function getDeviceWithIp(_0x4d4162){const _0x5c81cf=_0x1a47b6;return devices[_0x5c81cf(0x264)](_0x3ac018=>_0x3ac018['ip']===_0x4d4162);}function temporaryAccess2FA(_0x561ed6,_0x5b5a1b){const _0x199aab=_0x1a47b6;let _0x14d801=new Date(),_0x4991fa=![];if(lastIpApproval){if(_0x14d801-lastIpApproval<0x1388)_0x4991fa=!![];}lastIpApproval=new Date();if(_0x4991fa)return;tgBot&&settings[_0x199aab(0x157)]&&(tgBot[_0x199aab(0x19c)](_0x199aab(0x11d)),tgBot[_0x199aab(0x28e)](settings['telegramChatId'],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x5b5a1b)[_0x199aab(0x18c)]+_0x199aab(0x28f),{'parse_mode':_0x199aab(0x2af),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x199aab(0x25f),'callback_data':'reject'}]]}})['catch'](_0xda3288=>{telegramError(_0xda3288);}),tgBot['on'](_0x199aab(0x11d),async _0x3bb746=>{const _0x353a05=_0x199aab,_0x2364fc=_0x3bb746['data'],_0x11807a=_0x3bb746['message'];tgBot[_0x353a05(0x19b)](_0x3bb746['id'])[_0x353a05(0x2b2)](async()=>{const _0x1fe742=_0x353a05;devices[_0x561ed6][_0x1fe742(0x1a7)]={'clientip':_0x5b5a1b,'timestamp':new Date()['getTime'](),'expiry':_0x2364fc},_0x2364fc!='reject'?(await tgBot['sendMessage'](_0x11807a[_0x1fe742(0x1bb)]['id'],_0x1fe742(0x226)+_0x2364fc+_0x1fe742(0x243),{'parse_mode':_0x1fe742(0x2af)})['catch'](_0xa41d10=>{telegramError(_0xa41d10);}),io['to'](_0x561ed6)['emit'](_0x1fe742(0x20c),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x1fe742(0x28e)](_0x11807a[_0x1fe742(0x1bb)]['id'],_0x1fe742(0x269))[_0x1fe742(0x14d)](_0x1beea9=>{telegramError(_0x1beea9);}),io['to'](_0x561ed6)[_0x1fe742(0x290)]('status',{'access':{'allow':![],'reason':_0x1fe742(0x1fe),'token':null}}));}),tgBot[_0x353a05(0x19c)](_0x353a05(0x11d));}));}function loginAccess2FA(_0x17ba45,_0x24e086){const _0x510dbd=_0x1a47b6;tgBot&&settings[_0x510dbd(0x157)]&&(tgBot[_0x510dbd(0x19c)]('callback_query'),tgBot[_0x510dbd(0x28e)](settings['telegramChatId'],_0x510dbd(0x190)+normalizeIP(_0x24e086)[_0x510dbd(0x18c)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':'reject','callback_data':_0x510dbd(0x25f)}]]}})[_0x510dbd(0x14d)](_0x399436=>{telegramError(_0x399436);}),tgBot['on'](_0x510dbd(0x11d),async _0xde1a65=>{const _0x837e1a=_0x510dbd,_0x33b98a=_0xde1a65['data'],_0x52c25d=_0xde1a65[_0x837e1a(0x132)];tgBot[_0x837e1a(0x19b)](_0xde1a65['id'])[_0x837e1a(0x2b2)](async()=>{const _0x597ba1=_0x837e1a;devices[_0x17ba45][_0x597ba1(0x23e)]={'clientip':_0x24e086,'timestamp':new Date()[_0x597ba1(0x1ab)](),'expiry':_0x33b98a},_0x33b98a!=_0x597ba1(0x25f)?(await tgBot[_0x597ba1(0x28e)](_0x52c25d[_0x597ba1(0x1bb)]['id'],_0x597ba1(0x28d),{'parse_mode':_0x597ba1(0x2af)})['catch'](_0x3d2835=>{telegramError(_0x3d2835);}),io['to'](_0x17ba45)[_0x597ba1(0x290)](_0x597ba1(0x20c),{'access':{'allow':![],'reason':_0x597ba1(0x1ca),'token':null}})):(await tgBot[_0x597ba1(0x28e)](_0x52c25d[_0x597ba1(0x1bb)]['id'],_0x597ba1(0x222))[_0x597ba1(0x14d)](_0x48478e=>{telegramError(_0x48478e);}),io['to'](_0x17ba45)[_0x597ba1(0x290)](_0x597ba1(0x20c),{'access':{'allow':![],'reason':_0x597ba1(0x16f),'token':null}}));}),tgBot[_0x837e1a(0x19c)]('callback_query');}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4a3245=_0x1a47b6;return dbConfig['get'](_0x4a3245(0x291))[_0x4a3245(0x1e9)](_0x4a3245(0x208))[_0x4a3245(0x215)]({'status':_0x4a3245(0x15c)})[_0x4a3245(0x22d)]()||[];}function getDisabledBots(){const _0x5295c0=_0x1a47b6;return dbConfig['get'](_0x5295c0(0x291))[_0x5295c0(0x1e9)](_0x5295c0(0x208))[_0x5295c0(0x215)]({'status':_0x5295c0(0x15a)})['value']()||[];}function getBotAttributes(_0x23a736){const _0x7e460e=_0x1a47b6;let _0x5564e4={};const _0x1924e7=configpath+_0x7e460e(0x241)+_0x23a736+_0x7e460e(0x12b),_0x3755cc=fs[_0x7e460e(0x189)](_0x1924e7);if(_0x3755cc){const _0x5c7a5f=fs[_0x7e460e(0x197)](_0x1924e7);try{const _0x3ea4fb=JSON[_0x7e460e(0x194)](_0x5c7a5f),_0x555edd=_0x3ea4fb?_0x3ea4fb[_0x7e460e(0x270)][0x0][_0x7e460e(0x11e)]:![];_0x5564e4[_0x7e460e(0x256)]=_0x555edd?_0x7e460e(0x1c1):_0x7e460e(0x1aa),_0x5564e4[_0x7e460e(0x182)]=_0x3ea4fb?_0x3ea4fb[_0x7e460e(0x270)][0x0][_0x7e460e(0x182)]:'Bot\x20'+_0x23a736;}catch(_0x1633e8){_0x5564e4['mode']=_0x7e460e(0x1aa),_0x5564e4[_0x7e460e(0x182)]=_0x7e460e(0x24e)+_0x23a736;}}else _0x5564e4['mode']=_0x7e460e(0x1aa),_0x5564e4[_0x7e460e(0x182)]='Bot\x20'+_0x23a736;return _0x5564e4;}function getBotsWithMode(){const _0x30e566=_0x1a47b6,_0x18819b=dbConfig[_0x30e566(0x179)](_0x30e566(0x291))['sortBy']('botID')['value']()||[];return _0x18819b['forEach'](_0x3a3372=>{const _0x4e1ff6=_0x30e566;let _0x515b39=getBotAttributes(_0x3a3372[_0x4e1ff6(0x208)]);_0x3a3372[_0x4e1ff6(0x256)]=_0x515b39[_0x4e1ff6(0x256)];}),_0x18819b;}async function initUser(){const _0x5de3af=_0x1a47b6;if(!settings[_0x5de3af(0x1fb)]){const _0x53beb1=uuidRandom();mixpanel[_0x5de3af(0x220)](_0x53beb1),updateSetting(_0x5de3af(0x1fb),_0x53beb1);}}async function initSecure(){const _0x9b4016=_0x1a47b6;let _0x41fe65=getSecure();if(!_0x41fe65[_0x9b4016(0x152)]('secret')){let _0x213dc2=await generateKeys();_0x41fe65[_0x9b4016(0x238)]=_0x213dc2['publicKey'],_0x41fe65[_0x9b4016(0x26d)]=_0x213dc2[_0x9b4016(0x26d)],_0x41fe65[_0x9b4016(0x1eb)]=crypto[_0x9b4016(0x2bf)](0x20)['toString'](_0x9b4016(0x19e));;storeSecure(_0x41fe65);}}function getSettings(){const _0x63468=_0x1a47b6;return dbSettings[_0x63468(0x179)](_0x63468(0x1d8))[_0x63468(0x22d)]()||{};}function getSecure(){const _0x4abbd2=_0x1a47b6;return dbSecure[_0x4abbd2(0x179)](_0x4abbd2(0x184))['value']()||{};}function getBlacklist(){const _0x23a1fd=_0x1a47b6;return dbSecure['get']('blacklist')[_0x23a1fd(0x22d)]()||[];}function broadcastToBots(_0x53e17e,_0x42f849){config['forEach'](_0x3d2728=>{const _0x37ec49=_0x65cb;if(_0x3d2728[_0x37ec49(0x20c)]==_0x37ec49(0x15c)&&_0x3d2728[_0x37ec49(0x24c)]==_0x37ec49(0x262)){if(pid[_0x3d2728['botID']])pid[_0x3d2728[_0x37ec49(0x208)]][_0x37ec49(0x24a)]({[_0x53e17e]:_0x42f849});}});}function storeSettings(_0x1e15ae,_0x5bdb58=![]){const _0x4019e5=_0x1a47b6;_0x1e15ae={...settings,..._0x1e15ae};if(_0x5bdb58&&_0x1e15ae[_0x4019e5(0x17f)]!='************'&&_0x1e15ae['bbPassword']!=_0x4019e5(0x1a4)&&_0x1e15ae[_0x4019e5(0x17f)]!=''){const _0x58a40b=crypt[_0x4019e5(0x1fc)](secure[_0x4019e5(0x26d)],_0x1e15ae[_0x4019e5(0x17f)])[_0x4019e5(0x132)][_0x4019e5(0x12a)]('@')[0x0],_0xd79569=bcrypt[_0x4019e5(0x2a3)](_0x58a40b,saltRounds);_0x1e15ae={..._0x1e15ae,'bbPassword':_0xd79569};}if(_0x5bdb58&&_0x1e15ae[_0x4019e5(0x2a1)]!='************'&&_0x1e15ae[_0x4019e5(0x2a1)]!=_0x4019e5(0x1a4)&&_0x1e15ae[_0x4019e5(0x2a1)]!=''){const _0x547a74=crypt['decrypt'](secure['privateKey'],_0x1e15ae[_0x4019e5(0x2a1)])[_0x4019e5(0x132)]['split']('@')[0x0];_0x1e15ae={..._0x1e15ae,'telegramToken':_0x547a74};}const _0x4866c7=_0x1e15ae['telegramToken']!=_0x4019e5(0x140)&&_0x1e15ae[_0x4019e5(0x2a1)]!=settings[_0x4019e5(0x2a1)]||_0x1e15ae[_0x4019e5(0x20a)]!=settings[_0x4019e5(0x20a)],_0x2a425a=_0x1e15ae['telegramToken']==''||_0x1e15ae[_0x4019e5(0x20a)]=='';if(_0x4866c7)_0x1e15ae['telegramEvents']=_0x4019e5(0x130);for(const [_0x491fe4,_0x29d1c0]of Object[_0x4019e5(0x1db)](_0x1e15ae)){if(_0x491fe4==_0x4019e5(0x2a1)&&_0x29d1c0==_0x4019e5(0x140)){_0x1e15ae[_0x4019e5(0x2a1)]=settings[_0x4019e5(0x2a1)];continue;};if(_0x491fe4=='bbPassword'&&_0x29d1c0==_0x4019e5(0x140)){_0x1e15ae[_0x4019e5(0x17f)]=settings[_0x4019e5(0x17f)];continue;};dbSettings['set'](_0x4019e5(0x127)+_0x491fe4,_0x29d1c0)[_0x4019e5(0x158)]();}settings=_0x1e15ae,io['to'](_0x4019e5(0x2ac))[_0x4019e5(0x290)](_0x4019e5(0x1d8),cleanSettings()),broadcastToBots(_0x4019e5(0x1bd),settings[_0x4019e5(0x1bd)]);if(_0x4866c7&&!_0x2a425a)initTelegram();if(_0x4866c7&&_0x2a425a)disableTelegram();getAllClients()[_0x4019e5(0x27b)](_0x5052ef=>{const _0x1f81bd=_0x4019e5;getSocket(_0x5052ef['id'])[_0x1f81bd(0x290)](_0x1f81bd(0x20c),{'access':{'allow':![],'reason':_0x1f81bd(0x1ca),'token':null}});});}function updateSetting(_0x2bc552,_0x5770dc){const _0xa6d0d6=_0x1a47b6;dbSettings[_0xa6d0d6(0x240)]('settings.'+_0x2bc552,_0x5770dc)['write'](),settings=getSettings(),io['to'](_0xa6d0d6(0x2ac))[_0xa6d0d6(0x290)]('settings',cleanSettings());}function storeSecure(_0x1eaced){const _0x5b2da0=_0x1a47b6;dbSecure[_0x5b2da0(0x179)](_0x5b2da0(0x184))['push'](_0x1eaced)[_0x5b2da0(0x158)](),secure=_0x1eaced;}function addBlacklist(_0x41ee11){const _0x2acc6b=_0x1a47b6;cleanBlacklist();let _0x4b52e6;devices[_0x41ee11][_0x2acc6b(0x1a7)]?_0x4b52e6=Math['max'](devices[_0x41ee11][_0x2acc6b(0x1a7)]['expiry'],loginExpiry):_0x4b52e6=loginExpiry,dbSecure['get'](_0x2acc6b(0x207))[_0x2acc6b(0x284)]({'expiry':new Date()[_0x2acc6b(0x1ab)]()+_0x4b52e6*0x3c*0x3e8,'token':devices[_0x41ee11][_0x2acc6b(0x1b2)][_0x2acc6b(0x261)]})[_0x2acc6b(0x158)](),blacklist=dbSecure[_0x2acc6b(0x179)](_0x2acc6b(0x207))[_0x2acc6b(0x22d)]();}function cleanBlacklist(){const _0x5dfde2=_0x1a47b6;let _0x34b7e8=dbSecure['get'](_0x5dfde2(0x207))[_0x5dfde2(0x1cb)]()['value'](),_0x34eae4=new Date()[_0x5dfde2(0x1ab)]();_0x34b7e8[_0x5dfde2(0x27b)](_0x4be552=>{const _0x126188=_0x5dfde2;_0x4be552[_0x126188(0x23b)]<_0x34eae4&&dbSecure[_0x126188(0x179)](_0x126188(0x207))['remove']({'expiry':_0x4be552['expiry']})[_0x126188(0x158)]();});}function initStates(){let _0x550430=getConfiguration();_0x550430['forEach'](_0x5d7760=>{const _0x2f4879=_0x65cb;_0x5d7760[_0x2f4879(0x24c)]='stopped';}),storeConfiguration(_0x550430);}function onKeys(){const _0x1b181e=new RSA();return new Promise(_0x3b37c2=>{const _0x113b46=_0x65cb;_0x1b181e[_0x113b46(0x1bf)]()[_0x113b46(0x2b2)](_0x4fea5e=>{_0x3b37c2(_0x4fea5e);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2f0799=_0x1a47b6;let _0x354f64=getSettings(),_0x3d422b=![];!_0x354f64[_0x2f0799(0x152)](_0x2f0799(0x26a))&&(_0x354f64['lastmsgtelegram']=0x0,_0x3d422b=!![]);!_0x354f64[_0x2f0799(0x152)](_0x2f0799(0x1f3))&&(_0x354f64[_0x2f0799(0x1f3)]=0x0,_0x3d422b=!![]);!_0x354f64[_0x2f0799(0x152)](_0x2f0799(0x1d1))&&(_0x354f64[_0x2f0799(0x1d1)]=_0x2f0799(0x18a),_0x3d422b=!![]);if(_0x3d422b)storeSettings(_0x354f64);}function storeConfiguration(_0x24cc2a){const _0x39e380=_0x1a47b6;dbConfig[_0x39e380(0x179)](_0x39e380(0x291))[_0x39e380(0x265)]()[_0x39e380(0x158)](),_0x24cc2a[_0x39e380(0x27b)](_0x288604=>{const _0x4d3e29=_0x39e380;delete _0x288604[_0x4d3e29(0x256)];}),dbConfig['get'](_0x39e380(0x291))[_0x39e380(0x284)](..._0x24cc2a)[_0x39e380(0x158)](),config=_0x24cc2a;}function resetPassword(){const _0x2bc18d=_0x1a47b6;tgBot&&settings[_0x2bc18d(0x157)]&&(tgBot[_0x2bc18d(0x19c)](_0x2bc18d(0x11d)),tgBot[_0x2bc18d(0x28e)](settings[_0x2bc18d(0x157)],_0x2bc18d(0x292),{'parse_mode':_0x2bc18d(0x2af),'reply_markup':{'inline_keyboard':[[{'text':_0x2bc18d(0x19d),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x2bc18d(0x14d)](_0x1387fa=>{telegramError(_0x1387fa);}),tgBot['on']('callback_query',async _0x55637c=>{const _0xec5eef=_0x2bc18d,_0x3bda87=_0x55637c[_0xec5eef(0x29d)],_0x5a3acb=_0x55637c['message'];tgBot[_0xec5eef(0x19b)](_0x55637c['id'])[_0xec5eef(0x2b2)](async()=>{const _0x33030c=_0xec5eef;if(_0x3bda87!='no'){const _0x2331e2=0xf,_0x33fa58=_0x33030c(0x266),_0x46baf3=Array['from'](crypto[_0x33030c(0x2b8)](new Uint32Array(_0x2331e2)))[_0x33030c(0x1c5)](_0x1badc3=>_0x33fa58[_0x1badc3%_0x33fa58[_0x33030c(0x277)]])['join'](''),_0x38de95=bcrypt[_0x33030c(0x2a3)](_0x46baf3,saltRounds);storeSettings({'bbPassword':_0x38de95}),await tgBot[_0x33030c(0x28e)](_0x5a3acb[_0x33030c(0x1bb)]['id'],_0x33030c(0x263)+_0x46baf3,{'parse_mode':_0x33030c(0x2af)})[_0x33030c(0x14d)](_0x4ce79b=>{telegramError(_0x4ce79b);});}else await tgBot[_0x33030c(0x28e)](_0x5a3acb[_0x33030c(0x1bb)]['id'],'Password\x20reset\x20rejected')[_0x33030c(0x14d)](_0x2138d0=>{telegramError(_0x2138d0);});}),tgBot[_0xec5eef(0x19c)](_0xec5eef(0x11d));}));}async function confirmRestore(_0x23e50c,_0x1af39c){const _0x355c99=_0x1a47b6;tgBot&&settings[_0x355c99(0x157)]&&(tgBot[_0x355c99(0x19c)]('callback_query'),await tgBot[_0x355c99(0x28e)](settings['telegramChatId'],_0x355c99(0x1b5),{'parse_mode':_0x355c99(0x2af),'reply_markup':{'inline_keyboard':[[{'text':_0x355c99(0x19d),'callback_data':_0x355c99(0x19d)},{'text':'no','callback_data':'no'}]]}})[_0x355c99(0x14d)](_0x234253=>{telegramError(_0x234253);}),tgBot['on']('callback_query',async _0x255600=>{const _0x501b90=_0x355c99,_0xa96bce=_0x255600[_0x501b90(0x29d)],_0x51981e=_0x255600[_0x501b90(0x132)];tgBot[_0x501b90(0x19b)](_0x255600['id'])['then'](async()=>{const _0x1364cb=_0x501b90;_0xa96bce==_0x1364cb(0x19d)?(await tgBot[_0x1364cb(0x28e)](_0x51981e['chat']['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x1364cb(0x2af)})[_0x1364cb(0x14d)](_0x379979=>{telegramError(_0x379979);}),unzipFile(_0x23e50c,_0x1af39c)):await tgBot[_0x1364cb(0x28e)](_0x51981e[_0x1364cb(0x1bb)]['id'],_0x1364cb(0x1d7))[_0x1364cb(0x14d)](_0x95e599=>{telegramError(_0x95e599);});}),tgBot[_0x501b90(0x19c)](_0x501b90(0x11d));}));}function getServerTime(){const _0x4f389c=_0x1a47b6,_0x492204=new Date();return _0x492204[_0x4f389c(0x14a)]()+'/'+(_0x492204[_0x4f389c(0x125)]()+0x1)[_0x4f389c(0x18e)]()['padStart'](0x2,'0')+'/'+_0x492204[_0x4f389c(0x229)]()[_0x4f389c(0x18e)]()[_0x4f389c(0x1da)](0x2,'0')+'\x20'+_0x492204[_0x4f389c(0x295)]()[_0x4f389c(0x18e)]()['padStart'](0x2,'0')+':'+_0x492204['getMinutes']()[_0x4f389c(0x18e)]()[_0x4f389c(0x1da)](0x2,'0')+':'+_0x492204[_0x4f389c(0x273)]()[_0x4f389c(0x18e)]()[_0x4f389c(0x1da)](0x2,'0');}function getTimeStamp(){const _0x56d5aa=_0x1a47b6,_0xebae1f=shiftedTime();return _0xebae1f[_0x56d5aa(0x14a)]()+'/'+(_0xebae1f[_0x56d5aa(0x125)]()+0x1)['toString']()[_0x56d5aa(0x1da)](0x2,'0')+'/'+_0xebae1f[_0x56d5aa(0x229)]()['toString']()[_0x56d5aa(0x1da)](0x2,'0')+'\x20'+_0xebae1f[_0x56d5aa(0x295)]()[_0x56d5aa(0x18e)]()[_0x56d5aa(0x1da)](0x2,'0')+':'+_0xebae1f[_0x56d5aa(0x147)]()[_0x56d5aa(0x18e)]()['padStart'](0x2,'0')+':'+_0xebae1f[_0x56d5aa(0x273)]()[_0x56d5aa(0x18e)]()[_0x56d5aa(0x1da)](0x2,'0');}function shiftedTime(){const _0x86d2ca=_0x1a47b6,_0x30246a=new Date();let _0x221d24=_0x30246a;if(settings[_0x86d2ca(0x1bd)]&&settings[_0x86d2ca(0x1bd)]!==0x0)_0x221d24=fns['add'](_0x30246a,{'hours':settings[_0x86d2ca(0x1bd)]});return _0x221d24;}function startScheduler(){const _0x242428=_0x1a47b6,_0x2ddefb=new Date()['getUTCHours'](),_0x23bd02=shiftedTime()[_0x242428(0x295)]();_0x23bd02==0x4&&backupConfigFiles();_0x23bd02==0x0&&rotateLogFiles();_0x2ddefb%0x6==0x0&&triggerAnalytics();_0x2ddefb%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function backupConfigFiles(){const _0x3d0e41=_0x1a47b6;fs[_0x3d0e41(0x25a)](configpath,{'withFileTypes':!![]})['forEach'](_0x1eefc7=>{const _0x58ef26=_0x3d0e41;if(!_0x1eefc7[_0x58ef26(0x2ad)]())fs[_0x58ef26(0x20f)](configpath+_0x1eefc7[_0x58ef26(0x20d)],configbackuppath+_0x1eefc7[_0x58ef26(0x20d)]);});}function rotateLogFiles(){const _0x23b873=_0x1a47b6,_0x190cbe=fs['statSync'](logspath+_0x23b873(0x177)),_0x1e9664=_0x190cbe[_0x23b873(0x2c0)]/0x400;if(_0x1e9664>0x32){let _0x139fd7=fs[_0x23b873(0x25a)](logspath,{'withFileTypes':!![]});_0x139fd7[_0x23b873(0x21e)]((_0x28fde2,_0x3fe53c)=>_0x28fde2[_0x23b873(0x20d)]<_0x3fe53c[_0x23b873(0x20d)]?0x1:_0x3fe53c[_0x23b873(0x20d)]<_0x28fde2[_0x23b873(0x20d)]?-0x1:0x0),_0x139fd7[_0x23b873(0x27b)](_0x3b5942=>{const _0x155881=_0x23b873;if(_0x3b5942[_0x155881(0x20d)]==_0x155881(0x141))fs[_0x155881(0x20f)](logspath+_0x3b5942[_0x155881(0x20d)],logspath+_0x155881(0x27d));if(_0x3b5942[_0x155881(0x20d)]=='output-001.log')fs['copyFileSync'](logspath+_0x3b5942['name'],logspath+_0x155881(0x141));_0x3b5942[_0x155881(0x20d)]==_0x155881(0x177)&&(fs[_0x155881(0x20f)](logspath+_0x3b5942[_0x155881(0x20d)],logspath+_0x155881(0x286)),fs[_0x155881(0x11f)](logspath+_0x3b5942[_0x155881(0x20d)],''));});}}async function zipFiles(_0x206b3a){const _0x4b31d5=_0x1a47b6;let _0x2358eb;if(_0x206b3a==_0x4b31d5(0x2b7))_0x2358eb=logspath;if(_0x206b3a==_0x4b31d5(0x257))_0x2358eb=configpath;let _0x385cc6=fs['readdirSync'](_0x2358eb,{'withFileTypes':!![]});const _0x2f47a0=new require(_0x4b31d5(0x248))();_0x385cc6['forEach'](_0x1e8542=>{const _0x4827ea=_0x4b31d5;if(!_0x1e8542[_0x4827ea(0x2ad)]()){let _0x161aa5=fs[_0x4827ea(0x197)](_0x2358eb+_0x1e8542[_0x4827ea(0x20d)]);const _0x57cd29=/^bot-[0-9]{3}-config.json$/,_0x48fde7=_0x57cd29[_0x4827ea(0x29a)](_0x1e8542[_0x4827ea(0x20d)]);if(_0x48fde7){const _0x32fbc4=JSON[_0x4827ea(0x194)](_0x161aa5);_0x32fbc4['bot'][0x0][_0x4827ea(0x21f)]='***',_0x32fbc4['bot'][0x0]['apiSecret']=_0x4827ea(0x1a4),_0x161aa5=JSON[_0x4827ea(0x173)](_0x32fbc4,null,0x2);}if(_0x1e8542['name']==_0x4827ea(0x27f)){const _0xaf327=JSON['parse'](_0x161aa5);if(_0xaf327[_0x4827ea(0x1d8)]['loginRequired'])_0xaf327['settings'][_0x4827ea(0x217)]=![];if(_0xaf327['settings']['bbPassword'])_0xaf327[_0x4827ea(0x1d8)]['bbPassword']=_0x4827ea(0x1a4);if(_0xaf327['settings'][_0x4827ea(0x2a1)])_0xaf327[_0x4827ea(0x1d8)][_0x4827ea(0x2a1)]=_0x4827ea(0x1a4);if(_0xaf327[_0x4827ea(0x1d8)][_0x4827ea(0x157)])_0xaf327['settings'][_0x4827ea(0x157)]=null;_0x161aa5=JSON[_0x4827ea(0x173)](_0xaf327,null,0x2);}if(_0x1e8542[_0x4827ea(0x20d)]!=_0x4827ea(0x2a7))_0x2f47a0[_0x4827ea(0x252)](_0x1e8542[_0x4827ea(0x20d)],_0x161aa5);}});const _0x128f3b=_0x2f47a0['generate']({'base64':![],'compression':'DEFLATE'});fs['writeFileSync'](zippath+(_0x206b3a+_0x4b31d5(0x14c)),_0x128f3b,_0x4b31d5(0x2bb));}async function unzipFile(_0x4e4db2,_0x46374c){const _0x40dea8=_0x1a47b6;await backupConfigFiles(),fs[_0x40dea8(0x25a)](configpath,{'withFileTypes':!![]})[_0x40dea8(0x27b)](_0x95f940=>{const _0x11052e=_0x40dea8;if(!_0x95f940[_0x11052e(0x2ad)]())fs[_0x11052e(0x1c4)](configpath+_0x95f940[_0x11052e(0x20d)]);});const _0xe83618=fs[_0x40dea8(0x197)](_0x4e4db2+_0x46374c,'binary'),_0x4a94da=new require(_0x40dea8(0x248))(_0xe83618,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x4a94da[_0x40dea8(0x15f)])['forEach'](_0x5b642e=>{const _0x1c6b32=_0x40dea8,_0x16d997=_0x4a94da['files'][_0x5b642e];fs['writeFileSync'](configpath+_0x16d997[_0x1c6b32(0x20d)],_0x16d997[_0x1c6b32(0x1f6)]);}),fs[_0x40dea8(0x25a)](temppath,{'withFileTypes':!![]})[_0x40dea8(0x27b)](_0x12588f=>{const _0x23116e=_0x40dea8;if(!_0x12588f[_0x23116e(0x2ad)]())fs[_0x23116e(0x1c4)](temppath+_0x12588f[_0x23116e(0x20d)]);}),process['send']({'restore':!![]},_0x547d03=>{});}async function getPublicIp(){const _0x35e38e=_0x1a47b6;try{const _0x13c903=await axios[_0x35e38e(0x179)](_0x35e38e(0x271));publicip=_0x13c903[_0x35e38e(0x29d)]['ip'];}catch(_0x1a06fc){}}async function triggerAnalytics(){const _0x3256d9=_0x1a47b6;if(!publicip)await getPublicIp();const _0x5bf002=getBotsWithMode();let _0x5bf397=0x0;_0x5bf002[_0x3256d9(0x27b)](_0x35d3b1=>{const _0x2b8dd6=_0x3256d9;if(_0x35d3b1[_0x2b8dd6(0x20c)]==='enabled')_0x5bf397++;}),mixpanel['track'](_0x3256d9(0x1cc),{'distinct_id':settings[_0x3256d9(0x1fb)],'ip':publicip,'version':serverversion,'numbots':_0x5bf002['length'],'numbotsenabled':_0x5bf397});}async function getMessages(){const _0x13b786=_0x1a47b6,_0x3aeea0='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x4acff7=new GraphQLClient(_0x3aeea0),_0x255ea7={'authorization':_0x13b786(0x159)},_0x113aaa=serverversion[_0x13b786(0x12a)]('.'),_0xbfb5a0=_0x113aaa[0x0]+'.'+_0x113aaa[0x1],_0x566af2=Math[_0x13b786(0x221)](settings[_0x13b786(0x26a)],settings['lastmsgemitted']),_0x2eba8f={'last':parseInt(_0x566af2),'bbm':_0xbfb5a0},_0x45216c=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x162643;try{_0x162643=await _0x4acff7[_0x13b786(0x1ee)](_0x45216c,_0x2eba8f,_0x255ea7);}catch(_0x25c6bb){}if(_0x162643&&_0x162643['messages']){let _0x44eba4=settings['lastmsgtelegram'];newMessages=[];for(const _0x64b518 of _0x162643[_0x13b786(0x138)]){newMessages[_0x13b786(0x284)](_0x64b518);if(_0x64b518['bbvNew'])updateSetting(_0x13b786(0x1d1),_0x64b518['bbvNew']);let _0x2cfe45=_0x64b518[_0x13b786(0x1e2)]?serverversion>=_0x64b518[_0x13b786(0x1e2)]:![];if(!_0x2cfe45&&_0x64b518[_0x13b786(0x199)]>_0x44eba4){if(_0x64b518[_0x13b786(0x12c)]===_0x13b786(0x214)||serverversion[_0x13b786(0x161)](_0x64b518[_0x13b786(0x12c)])){let _0x139cb4=''+_0x64b518[_0x13b786(0x2ba)]+'\x0a\x0a'+_0x64b518['message'];const _0xfc0e8=await sendTelegramMsg(toTelegramMarkdown(_0x139cb4),_0x13b786(0x21d));if(_0xfc0e8)_0x44eba4=_0x64b518[_0x13b786(0x199)];}}}updateAvailable=isNewerVersion(settings[_0x13b786(0x1d1)],serverversion),updateSetting(_0x13b786(0x26a),_0x44eba4),emitMessages();}}function emitMessages(){const _0x205273=_0x1a47b6,_0x52ddbb=settings[_0x205273(0x1f3)];let _0x3e202f=[];newMessages[_0x205273(0x27b)](_0x1437aa=>{const _0x1e6f66=_0x205273;_0x1437aa[_0x1e6f66(0x199)]>_0x52ddbb&&_0x3e202f['push'](_0x1437aa);}),_0x3e202f[_0x205273(0x277)]>0x0&&getAllClients()[_0x205273(0x27b)](_0x3cc73d=>{const _0x1c0fc7=_0x205273;getSocket(_0x3cc73d['id'])[_0x1c0fc7(0x290)](_0x1c0fc7(0x132),_0x3e202f);});}function confirmMessage(_0x264421){const _0x5cd802=_0x1a47b6;updateSetting(_0x5cd802(0x1f3),Number(_0x264421));}function isNewerVersion(_0x52733b,_0x4129a9){const _0x3fbb07=_0x1a47b6,_0x25d9aa=_0x4129a9[_0x3fbb07(0x12a)]('.'),_0x220b69=_0x52733b[_0x3fbb07(0x12a)]('.');for(var _0x5b2693=0x0;_0x5b2693<_0x220b69['length'];_0x5b2693++){const _0x9f3904=~~_0x220b69[_0x5b2693],_0x2ea056=~~_0x25d9aa[_0x5b2693];if(_0x9f3904>_0x2ea056)return!![];if(_0x9f3904<_0x2ea056)return![];}return![];}function toTelegramMarkdown(_0x3ed43e){const _0x1b359a=_0x1a47b6,_0x33219a=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3ce301=/\*{2}(.+?)\*{2}/gim;return _0x3ed43e=_0x3ed43e[_0x1b359a(0x205)](_0x33219a,_0x1b359a(0x17a))[_0x1b359a(0x205)](_0x3ce301,_0x1b359a(0x251)),_0x3ed43e;}async function validateConfigFile(){const _0x2932d0=_0x1a47b6,_0x28c667=dbConfig[_0x2932d0(0x179)](_0x2932d0(0x291))['sortBy'](_0x2932d0(0x208))['value']()||[];if(_0x28c667[_0x2932d0(0x277)]==0x0){let _0x4f2d61=0x0,_0x42e90d=[];const _0xaf3326=/^bot-([0-9]{3})-config.json$/,_0x299fcd=fs[_0x2932d0(0x25a)](configpath);_0x299fcd[_0x2932d0(0x27b)](_0x309b0b=>{const _0x5298d1=_0x2932d0,_0x46e5f1=_0xaf3326[_0x5298d1(0x1a2)](_0x309b0b);if(_0x46e5f1){const _0x447de1=_0x46e5f1[0x1];let _0x5b126b=getBotAttributes(_0x447de1);_0x42e90d['push']({'botID':_0x447de1,'botname':_0x5b126b['botname'],'status':_0x5298d1(0x15a),'live':_0x5298d1(0x28c)}),_0x4f2d61++;}}),_0x4f2d61!=0x0&&(dbConfig['get'](_0x2932d0(0x291))['assign'](_0x42e90d)[_0x2932d0(0x158)](),config=_0x42e90d,restoredConfigFile=_0x4f2d61);}}async function restoreConfigNotify(_0x5d9fd0){const _0x22c153=_0x1a47b6;let _0x3e4efc;if(restoredConfigFile==0x1)_0x3e4efc=_0x22c153(0x1a8);else _0x3e4efc='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x5d9fd0)io['to'](_0x22c153(0x2ac))[_0x22c153(0x290)](_0x22c153(0x1e4),_0x3e4efc);else{logger[_0x22c153(0x1e8)](_0x22c153(0x234)),logger[_0x22c153(0x1e8)](_0x3e4efc),logger[_0x22c153(0x1e8)](_0x22c153(0x234)),logger[_0x22c153(0x1e8)]('');if(tgBot&&settings[_0x22c153(0x157)]&&settings[_0x22c153(0x166)]!=_0x22c153(0x13b))tgBot[_0x22c153(0x28e)](settings['telegramChatId'],_0x22c153(0x202)+_0x3e4efc)[_0x22c153(0x14d)](_0x5ce31e=>{telegramError(_0x5ce31e);});}}function validateCredentials(_0x58b5ee,_0x3b8a1b){const _0x5db3dd=_0x1a47b6;if(_0x58b5ee[_0x5db3dd(0x2a5)]==settings[_0x5db3dd(0x145)]&&bcrypt[_0x5db3dd(0x15e)](_0x58b5ee[_0x5db3dd(0x299)],settings[_0x5db3dd(0x17f)])){if(settings[_0x5db3dd(0x289)])return{'allow':![],'reason':_0x5db3dd(0x196),'token':null};else{const _0x33be11=generateLoginToken(_0x3b8a1b);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x33be11};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x401b8b){const _0x46596d=generateLoginToken(_0x401b8b);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x46596d};}function validateAccess(_0x13911b,_0x16d517,_0x324979){const _0x138048=_0x1a47b6,_0x321c54=_0x324979?_0x324979:devices[_0x16d517]['ip'];let _0x35b259;const _0x2e597b=_0x148e42=>{const _0xa38a70=_0x65cb;if(settings[_0xa38a70(0x217)]){if(settings[_0xa38a70(0x289)]){if(telegram2FaApproved(_0x16d517)){const _0xf9cd7=generateLoginToken(_0x16d517);return{'allow':!![],'reason':_0xa38a70(0x1c6),'token':_0xf9cd7};}else return{'allow':![],'reason':_0xa38a70(0x153),'token':null};}else return _0x35b259=validToken(_0x148e42,_0x16d517),_0x35b259[_0xa38a70(0x152)](_0xa38a70(0x267))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x148e42}:{'allow':![],'reason':_0xa38a70(0x153),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings['whitelistEnabled']){let _0x22dff0=[...settings[_0x138048(0x139)],'::1',_0x138048(0x188),_0x138048(0x1e0)];if(_0x22dff0[_0x138048(0x192)](_0x321c54))return _0x2e597b(_0x13911b);else{_0x35b259=validToken(_0x13911b,_0x16d517);if(_0x35b259[_0x138048(0x152)](_0x138048(0x267)))return _0x2e597b(_0x13911b);else{if(telegramIpApproved(_0x16d517)){const _0xbde218=generateToken(_0x16d517);return _0x35b259=_0x2e597b(_0x13911b),_0x35b259[_0x138048(0x250)]?{'allow':!![],'reason':_0x138048(0x14e),'token':_0xbde218}:_0x35b259;}else return settings[_0x138048(0x1ea)]?{'allow':![],'reason':_0x138048(0x160),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x2e597b(_0x13911b);}function timelyDecrypt(_0x2d98f7,_0x214130=!![]){const _0x227e3b=_0x1a47b6;if(_0x2d98f7)try{const _0x1fbdee=crypt[_0x227e3b(0x1fc)](secure['privateKey'],_0x2d98f7)[_0x227e3b(0x132)],_0x2a07ae=_0x1fbdee[_0x227e3b(0x12a)]('@')[0x0],_0x9dd4f3=_0x1fbdee[_0x227e3b(0x12a)]('@')[0x1],_0x3f9fd5=new Date()[_0x227e3b(0x1ab)]();if(_0x214130){if(_0x3f9fd5-_0x9dd4f3<maxSecretAge*0x3e8)return _0x2a07ae;else return![];}else return _0x2a07ae;}catch(_0x1b0786){return![];}else return![];}const validToken=(_0x48c017,_0xd1f506)=>{const _0x400c7e=_0x1a47b6,_0x29d1a8=devices[_0xd1f506]['ip'];if(!_0x48c017)return{'error':_0x400c7e(0x1d5)};for(let _0x5341f1 of blacklist){if(_0x5341f1['token']==_0x48c017)return{'error':_0x400c7e(0x1d6)};}let _0x437d82;try{_0x437d82=jwt[_0x400c7e(0x148)](_0x48c017,secure[_0x400c7e(0x1eb)]+_0xd1f506);}catch{return{'error':_0x400c7e(0x1be)};}if(!_0x437d82['hasOwnProperty'](_0x400c7e(0x19a))&&!_0x437d82[_0x400c7e(0x152)]('username')||!_0x437d82[_0x400c7e(0x152)](_0x400c7e(0x1f9)))return{'error':_0x400c7e(0x135)};if(!_0x437d82[_0x400c7e(0x152)](_0x400c7e(0x2a5))&&_0x437d82[_0x400c7e(0x152)](_0x400c7e(0x19a))){const {clientip:_0x3a535b}=_0x437d82;return _0x29d1a8==_0x3a535b?{'success':_0x400c7e(0x239)}:{'error':_0x400c7e(0x20b)};}else{if(_0x437d82[_0x400c7e(0x152)]('username')&&_0x437d82[_0x400c7e(0x152)]('clientip')){const {username:_0x550e43,clientip:_0x2ab9d7}=_0x437d82;return settings['bbUsername']==_0x550e43&&_0x29d1a8==_0x2ab9d7?{'success':_0x400c7e(0x239)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x134e19=>{const _0x32b011=_0x1a47b6;if(_0x134e19){const _0x3141fb=devices[_0x134e19]['ip'];return jwt[_0x32b011(0x203)]({'username':settings[_0x32b011(0x145)],'clientip':_0x3141fb},secure[_0x32b011(0x1eb)]+_0x134e19,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x5a2e9b=>{const _0x4666e5=_0x1a47b6;if(_0x5a2e9b){const _0x35fb8d=devices[_0x5a2e9b]['ip'];return jwt[_0x4666e5(0x203)]({'clientip':_0x35fb8d},secure[_0x4666e5(0x1eb)]+_0x5a2e9b,{'expiresIn':devices[_0x5a2e9b]['telegramIpApproval'][_0x4666e5(0x23b)]*0x3c});}else return![];},telegramIpApproved=_0x2f7845=>{const _0x3f10b9=_0x1a47b6;let _0x45cc4c=![];return devices[_0x2f7845][_0x3f10b9(0x1a7)]&&devices[_0x2f7845]['telegramIpApproval'][_0x3f10b9(0x23b)]!=_0x3f10b9(0x25f)&&(_0x45cc4c=devices[_0x2f7845]['telegramIpApproval'][_0x3f10b9(0x19a)]==devices[_0x2f7845]['ip']&&new Date()['getTime']()-devices[_0x2f7845][_0x3f10b9(0x1a7)]['timestamp']<devices[_0x2f7845][_0x3f10b9(0x1a7)]['expiry']*0x3c*0x3e8),_0x45cc4c;},telegram2FaApproved=_0x24b6d2=>{const _0x4c35c7=_0x1a47b6;let _0x2d61b8=![];return devices[_0x24b6d2][_0x4c35c7(0x23e)]&&devices[_0x24b6d2]['telegram2FaApproval'][_0x4c35c7(0x23b)]!='reject'&&(_0x2d61b8=devices[_0x24b6d2][_0x4c35c7(0x23e)][_0x4c35c7(0x19a)]==devices[_0x24b6d2]['ip']&&new Date()[_0x4c35c7(0x1ab)]()-devices[_0x24b6d2][_0x4c35c7(0x23e)][_0x4c35c7(0x129)]<devices[_0x24b6d2][_0x4c35c7(0x23e)]['expiry']*0x3c*0x3e8),_0x2d61b8;},normalizeIP=_0x5a9ae4=>{const _0x4d6cf2=_0x1a47b6;let _0x5efa8a=null,_0x18c078=null;if(ipaddr[_0x4d6cf2(0x175)](_0x5a9ae4)){const _0x264008=ipaddr['parse'](_0x5a9ae4);_0x264008['kind']()===_0x4d6cf2(0x231)?(_0x264008[_0x4d6cf2(0x235)]()&&(_0x5efa8a=_0x264008[_0x4d6cf2(0x126)]()[_0x4d6cf2(0x18e)]()),_0x18c078=_0x264008[_0x4d6cf2(0x18e)]()):(_0x5efa8a=_0x264008[_0x4d6cf2(0x18e)](),_0x18c078=_0x264008[_0x4d6cf2(0x2b4)]()['toString']());}return{'show':_0x5efa8a?_0x5efa8a:_0x18c078,'store':_0x18c078};};function sleep(_0x4b5b1d){return new Promise(_0x1ef6ce=>setTimeout(_0x1ef6ce,_0x4b5b1d));}