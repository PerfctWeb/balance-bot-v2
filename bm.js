const _0x59a09a=_0x4737;(function(_0x4f6198,_0xeb982e){const _0x61c1ba=_0x4737,_0x5e5842=_0x4f6198();while(!![]){try{const _0x5e06a3=-parseInt(_0x61c1ba(0x12b))/0x1+parseInt(_0x61c1ba(0x13a))/0x2*(parseInt(_0x61c1ba(0x1f6))/0x3)+parseInt(_0x61c1ba(0x199))/0x4*(parseInt(_0x61c1ba(0x19c))/0x5)+parseInt(_0x61c1ba(0x237))/0x6+parseInt(_0x61c1ba(0x1c9))/0x7*(parseInt(_0x61c1ba(0x202))/0x8)+-parseInt(_0x61c1ba(0x218))/0x9+-parseInt(_0x61c1ba(0x177))/0xa;if(_0x5e06a3===_0xeb982e)break;else _0x5e5842['push'](_0x5e5842['shift']());}catch(_0x4bee43){_0x5e5842['push'](_0x5e5842['shift']());}}}(_0x1355,0xd5acd));const _0x498dec=function(){let _0x50fed6=!![];return function(_0x2f5385,_0x1ca7ff){const _0x4286cc=_0x50fed6?function(){const _0x15e62c=_0x4737;if(_0x1ca7ff){const _0x3f2ecd=_0x1ca7ff[_0x15e62c(0x248)](_0x2f5385,arguments);return _0x1ca7ff=null,_0x3f2ecd;}}:function(){};return _0x50fed6=![],_0x4286cc;};}(),_0x1d4b8b=_0x498dec(this,function(){const _0x2daa2d=_0x4737;return _0x1d4b8b[_0x2daa2d(0x16c)]()['search'](_0x2daa2d(0xdf))[_0x2daa2d(0x16c)]()[_0x2daa2d(0x251)](_0x1d4b8b)[_0x2daa2d(0x129)]('(((.+)+)+)+$');});_0x1d4b8b();'use strict';process[_0x59a09a(0x145)][_0x59a09a(0xde)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x59a09a(0x1ed)),low=require('lowdb'),FileSync=require(_0x59a09a(0x264)),path=require(_0x59a09a(0x27a)),crypto=require(_0x59a09a(0x147)),Crypt=require('hybrid-crypto-js')[_0x59a09a(0x1f5)],RSA=require(_0x59a09a(0x153))[_0x59a09a(0xf6)],bcrypt=require(_0x59a09a(0x20a)),jwt=require(_0x59a09a(0x22f)),ipaddr=require('ipaddr.js'),argv=require(_0x59a09a(0x24d))(process[_0x59a09a(0x18c)][_0x59a09a(0x1d4)](0x2))[_0x59a09a(0x18c)],uuidRandom=require('uuid-random'),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require(_0x59a09a(0x162)),axios=require(_0x59a09a(0xee)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x59a09a(0x25b)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x59a09a(0xef)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console['log'](_0x59a09a(0x16b)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x59a09a(0x11e)](0x1));const HOST=argv[_0x59a09a(0x118)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x59a09a(0x280)][_0x59a09a(0xed)];let bbpath='bb/',bbpath2='';const botfile=_0x59a09a(0x19b),configfile=_0x59a09a(0x1b2),settingsfile=_0x59a09a(0xfe),securefile=_0x59a09a(0x187),environment=require('./'+bbpath2+'version.json')[_0x59a09a(0x1e7)]||'production',maxBackups=0xa;let validInstallation=!![];!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x59a09a(0xc6)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x59a09a(0x155),configbackuppath=configpath+_0x59a09a(0x15b),logspath=userID?bbpath+_0x59a09a(0x18b)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x59a09a(0x13e)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x59a09a(0x16a)](logspath+_0x59a09a(0x213),{'flags':'a'}),temppath=userID?bbpath+_0x59a09a(0x22b)+userID+'/':bbpath+_0x59a09a(0x22b);!fs['existsSync'](configpath)&&fs['mkdirSync'](configpath);!fs[_0x59a09a(0x136)](configbackuppath)&&fs[_0x59a09a(0xfa)](configbackuppath);!fs[_0x59a09a(0x136)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x59a09a(0x136)](zippath)&&fs[_0x59a09a(0xfa)](zippath);!fs['existsSync'](temppath)&&fs[_0x59a09a(0xfa)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x59a09a(0x140)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x59a09a(0x149)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x59a09a(0x1c4),'onepagemode':![]}})[_0x59a09a(0x140)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);function _0x1355(){const _0xed6755=['storeFiat','get-portfolio','Unauthorized\x20attempt\x20to\x20confirm\x20message','bb-settings.json','::1','alias','disabled','https://api.ipify.org?format=json','telegramChatId','headers','version','\x1b[34m','HTML','backupfile','handshake','inherit','Unauthorized\x20attempt\x20to\x20log\x20out','Logged\x20out\x20user\x20...','readdirSync','debug','output-000.log','stopPolling','rmSync','order','\x20|\x20client:\x20...','string','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','conn','then','host','secret','Notifications\x20disabled','match','getSeconds','restore-backup-file','exit',':\x20Bot\x20Mgr\x20>\x20','\x1b[31m','success','Unauthorized\x20attempt\x20to\x20update\x20settings','backup','name','blacklist','getHours','emit','privateKey','search','removeAllListeners','497759MvFOjW','latestversion','User\x20has\x20been\x20validated','getStartingBalances','tkn','live','/disable\x20-\x20disable\x20notifications\x0a','yes','mtime','join','Temporary\x20access\x20rejected','existsSync','whitelistEnabled','show','mode','2dQZynC','whitelist','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Ok,\x20will\x20send\x20alert\x20notifications\x20only','zip/','Password\x20reset\x20rejected','write','store-settings','kind','orders','/on\x20-\x20start\x20bot(s)\x0a','env','botID','crypto','Token\x20blacklisted','defaults','socket.io','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','login\x20not\x20required','-events.json','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','publicKey','Ok,\x20will\x20send\x20order\x20notifications\x20only','any','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','hybrid-crypto-js','error','config/','get','bbPassword','pidRefreshToken','answerCallbackQuery','connected','backup/','\x20>\x20','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','data','expiry','\x20(1)','cloneDeep','mixpanel','init','auth','#RES#\x20','messages','reload','type','onText','createWriteStream','Error:\x20Invalid\x20argument\x20','toString','settings','backup-files','event','\x1b[35m','static','test','family','once','\x20to\x20','sign','12084240rHvWvv','Your\x20installation\x20is\x20already\x20up\x20to\x20date','</b>\x20?','isValid','username','replace','placeOrder','15\x20min','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','uuid','bot','new','value','lastmsgemitted','getPortfolio','\x1b[33m','bb-secure.json','reinstall-bb','<b>Balance\x20Bot\x20Status:</b>\x0a','sendPortfolioTelegram','logs/','argv','output-003.log','store-headless','length','Notifications\x20enabled','getUTCHours','/download/:type','remove','use','access','2FA\x20login\x20rejected','sort','backup-full@','4DKaQgc','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','bot.js','255155DMGWNu','sendMetricsTelegram','reject','generateKeyPairAsync','map','build2','Node.js\x20v','\x20|\x20user:\x20...','backup-full.zip','store-fiat','botname','telegram','statSync','telegramEvents','reinstall','update','Error\x20removing\x20old\x20backup\x20files:','Starting\x20Balance\x20Bot\x20update','telegramToken','set','private','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','bb-config.json','push','2FA\x20login\x20required','pidExpireLogin','logs','access\x20timeout','/off\x20-\x20stop\x20bot(s)\x0a','send','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','temporary\x20token\x20generated','sockets','127.0.0.1','-results.json','::ffff:127.0.0.1','accept','temporaryAccessAllowed','-config.json','DEFLATE','0.0.0','startsWith','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','logout','socket','14eIUmJi','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','toIPv4Address','headless','password','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Deleted\x20Bot\x20',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','build','/:bot/performance','slice','filter','file','createServer','size','telegramIpApproval','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','fork','manual','reason','auto','toggleBotMode','split','#RES#\x20if\x20running\x20on\x20server','apiPassword','2FA','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','title','environment','started','Unauthorized\x20attempt\x20to\x20get\x20events','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Restoring\x20bot(s)\x20from\x20backup','assign','date-fns','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','polling_error','message','Invalid\x20authentication\x20token\x20(2)','getFullYear','No\x20bots\x20running\x20right\x20now','Starting\x20#RED#Balance\x20Bot\x20v','Crypt','4534617FmITro','onepagemode','token','All\x20bots\x20running\x20right\x20now','unlinkSync','All\x20bots','exec','params','disconnect','alerts','backup-full','internal','3935768tcjbpE','Session\x20expired\x20for\x20user\x20...','uncaughtException','lastmsgtelegram','resetHistory','endsWith','bot-','restart','bcryptjs','logged\x20out','Disabled\x20Bot\x20','\x20minutes',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','find','stringify','sendFile','ipc','/output-000.log','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','bots','allow','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','14428197slPuaJ','settings.','_data','isIPv4MappedAddress','files','bbvNew','2FA\x20login\x20token\x20generated','***','Bot\x20','timestamp','Unauthorized\x20attempt\x20to\x20update\x20bot','SIGINT','callback_query','http','Unauthorized\x20login\x20attempt\x20(timeout)','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','full','/status\x20-\x20show\x20bot(s)\x20status\x0a','404\x20Not\x20Found','temp/','login\x20token\x20generated','toIPv4MappedAddress','notification','jsonwebtoken','readFileSync','getTime','sendMessage','/:bot/coins','isDirectory','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','connection','9828102UcVGVi','apiKey','secure','Invalid\x20username\x20or\x20IP\x20address','\x1b[36m','store','randomBytes','30\x20min','************','stop','\x20|\x20','output-001.log','entries','You\x20can\x20use\x20the\x20following\x20commands:\x0a','storeHeadless','Starting\x20bot\x20|\x20Bot\x20','remoteAddress','apply','cancelLoading','range','listen','keys','yargs/yargs','delete-alerts','get-messages','login','constructor','Unauthorized\x20attempt\x20to\x20delete\x20bot','Unauthorized\x20attempt\x20to\x20add\x20bot','getMonth','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','telegramEnabled','reset-history','Unauthorized\x20attempt\x20to\x20download\x20','sortBy','Restore\x20process\x20aborted','util','address','hasOwnProperty','ipv6','catch','get-logs','Idling\x20bot\x20\x20\x20|\x20Bot\x20','toggle-bot-mode','Password\x20has\x20been\x20reset\x20to:\x20','lowdb/adapters/FileSync','function','update-bb','telegramUsername','botmanager','getMinutes','Unauthorized\x20attempt\x20to\x20get\x20messages','telegram2FaApproval','forEach','exp','Restarting\x20Bot\x20','Starting\x20new\x20bot\x20|\x20Bot\x20','login\x20required','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','decrypt','referer','includes','track','6b67f3d61ee94b8f5c80b4affef4c4d9','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','telegrammsg','path','updatebotmanager','format','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','add','timeshift','versions','kill','\x20(2)','-----------------------------------------------------------------------------------','Bot\x20Mgr\x20>\x20','request','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','stopped','Orders','\x20only\x0a','download','all','deleteHistoryAlerts','Login\x20rejected','.zip','Yes','/help\x20-\x20show\x20available\x20commands\x0a','1000','Invalid\x20Telegram\x20token','index.html','status','max','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','*$1*','2FA\x20required','writeFileSync','\x1b[0m','new-disabled','clients','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','store-configuration','/:bot/portfolio','staging','getDate','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Invalid\x20authentication\x20token\x20(1)','=>\x20Go\x20to\x20#CYA#http://','place-order','loginRequired','Markdown','hashSync','server','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','copyFileSync','invalid\x20credentials','SIGTERM','confirm-message','f2aRequired','parse','post','/restart\x20-\x20restart\x20bot(s)\x0a','removeListener','NTBA_FIX_319','(((.+)+)+)+$','simple','showConfig','verify','-performance.json','log','binary','userid','chat','5\x20min','show-config','output-002.log','number','from','node','axios','port','delete-bot','get-backup-files','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','padStart','clientip','RSA','All','enabled','node-zip','mkdirSync'];_0x1355=function(){return _0xed6755;};return _0x1355();}dbSecure[_0x59a09a(0x149)]({'secure':{},'blacklist':[]})[_0x59a09a(0x140)]();let crypt=new Crypt({'md':'sha256','rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x59a09a(0x163)](_0x59a09a(0x276),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x59a09a(0x1ae)]&&settings[_0x59a09a(0x1ae)]!=''&&settings[_0x59a09a(0x267)]&&settings[_0x59a09a(0x267)]!='')initTelegram();const parseColor=(_0x63b837,_0x1bc31f)=>{const _0x377edd=_0x59a09a,_0x3e2929=/#[A-Z]{3}#/g;if(typeof _0x63b837==_0x377edd(0x114)){!_0x1bc31f?_0x63b837=_0x63b837['replace'](_0x3e2929,''):(_0x63b837=_0x63b837[_0x377edd(0x17c)](/#BLU#/g,_0x377edd(0x106)),_0x63b837=_0x63b837[_0x377edd(0x17c)](/#RED#/g,_0x377edd(0x120)),_0x63b837=_0x63b837[_0x377edd(0x17c)](/#YEL#/g,_0x377edd(0x186)),_0x63b837=_0x63b837[_0x377edd(0x17c)](/#MAG#/g,_0x377edd(0x170)),_0x63b837=_0x63b837[_0x377edd(0x17c)](/#CYA#/g,_0x377edd(0x23b)),_0x63b837=_0x63b837[_0x377edd(0x17c)](/#RES#/g,_0x377edd(0xc4)));;}return _0x63b837;},logger={'screen':_0x6c6b8=>{const _0x7bf074=_0x59a09a;console[_0x7bf074(0xe4)](parseColor(_0x6c6b8,!![]));},'simple':_0x272928=>{const _0x5f0828=_0x59a09a;console[_0x5f0828(0xe4)](parseColor(_0x272928,!![])),loggerfile[_0x5f0828(0x140)](util['format'](parseColor(_0x272928,![]))+'\x0a');},'full':async _0x448f7f=>{const _0x288789=_0x59a09a,_0x5d881f=getTimeStamp()+_0x288789(0x11f)+_0x448f7f;console[_0x288789(0xe4)](parseColor(_0x5d881f,!![])),loggerfile[_0x288789(0x140)](util['format'](parseColor(_0x5d881f,![]))+'\x0a');if(tgBot&&settings[_0x288789(0x103)]&&settings['telegramEvents']!=_0x288789(0x143))await tgBot[_0x288789(0x232)](settings[_0x288789(0x103)],_0x288789(0x284)+parseColor(_0x448f7f,![]))[_0x288789(0x25f)](_0x94ce65=>{telegramError(_0x94ce65);});},'debug':async(_0x27596c,_0x9c56b1='')=>{const _0x336e5c=_0x59a09a,_0x5c5921=getTimeStamp()+_0x336e5c(0x20e)+_0x27596c;if(debugging)console[_0x336e5c(0xe4)](parseColor(_0x5c5921,!![]));loggerfile[_0x336e5c(0x140)](util['format'](parseColor(_0x5c5921,![]))+'\x0a');if(_0x9c56b1){if(debugging)console['log'](_0x9c56b1);loggerfile[_0x336e5c(0x140)](util[_0x336e5c(0x27c)](_0x9c56b1)+'\x0a');}}};process['on'](_0x59a09a(0x204),function(_0x113215){logger['simple'](_0x113215);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x59a09a(0x105)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x59a09a(0x225))[_0x59a09a(0x1d7)](app);app[_0x59a09a(0x194)](fileUpload({'useTempFiles':!![]})),app[_0x59a09a(0x156)](_0x59a09a(0x192),async(_0x4db0ae,_0xf59557)=>{const _0x4b30db=_0x59a09a,_0x29492a=_0x4db0ae[_0x4b30db(0x1fd)]['type'],_0x3ed66e=getClientsWithBotID(_0x4b30db(0x268)),_0x771c14=_0x4db0ae[_0x4b30db(0x104)][_0x4b30db(0x180)],_0x16d990=timelyDecrypt(_0x771c14,![]),_0xcfa4cb=_0x3ed66e[_0x4b30db(0x20f)](_0x5e474e=>_0x5e474e['uuid']==_0x16d990);if(_0xcfa4cb){const _0x5226bd=normalizeIP(_0x4db0ae[_0x4b30db(0x1c8)][_0x4b30db(0x247)])['store'],_0x516922=_0x4db0ae[_0x4b30db(0x104)][_0x4b30db(0x12f)];if(validateAccess(_0x516922,_0x16d990,_0x5226bd)[_0x4b30db(0x216)])_0x29492a==_0x4b30db(0x123)&&await backupConfigFiles(),await zipFiles(_0x29492a),_0xf59557[_0x4b30db(0x28a)](zippath+(_0x29492a+_0x4b30db(0xb8)),_0x34363b=>{const _0x5d8274=_0x4b30db;_0x34363b&&(logger[_0x5d8274(0x228)]('Failed\x20to\x20download\x20'+_0x29492a),logger[_0x5d8274(0xe0)](_0x34363b));});else logger['full'](_0x4b30db(0x258)+_0x29492a+_0x4b30db(0x160));}else logger[_0x4b30db(0x228)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x29492a+_0x4b30db(0x282));}),app[_0x59a09a(0xdb)]('/upload-backup',async(_0x4a6717,_0x2a7af0)=>{const _0x47f1b8=_0x59a09a,_0x563c44=getClientsWithBotID(_0x47f1b8(0x268)),_0x185153=_0x4a6717[_0x47f1b8(0x104)][_0x47f1b8(0x180)],_0x3e9ad3=timelyDecrypt(_0x185153,![]),_0x10d1aa=_0x563c44[_0x47f1b8(0x20f)](_0x50a154=>_0x50a154[_0x47f1b8(0x180)]==_0x3e9ad3);logger[_0x47f1b8(0x10e)]('Backup\x20file\x20uploaded');if(_0x10d1aa){const _0x3fe88b=normalizeIP(_0x4a6717[_0x47f1b8(0x1c8)][_0x47f1b8(0x247)])[_0x47f1b8(0x23c)],_0x464b31=_0x4a6717[_0x47f1b8(0x104)][_0x47f1b8(0x12f)];if(validateAccess(_0x464b31,_0x3e9ad3,_0x3fe88b)['allow']){if(_0x4a6717[_0x47f1b8(0x21c)]){const _0x35aa08=_0x4a6717['files'][_0x47f1b8(0x108)];await _0x35aa08['mv'](temppath+_0x35aa08[_0x47f1b8(0x124)]),_0x2a7af0[_0x47f1b8(0x1b9)]({'status':!![],'message':'File\x20uploaded'});const _0x4be527=getBotsWithMode();_0x4be527['length']>0x0?confirmRestore(temppath,_0x35aa08[_0x47f1b8(0x124)]):unzipFile(temppath,_0x35aa08['name']);}}else logger[_0x47f1b8(0x228)](_0x47f1b8(0x1c6));}else logger[_0x47f1b8(0x228)](_0x47f1b8(0x19a));}),app['use'](express[_0x59a09a(0x171)](path[_0x59a09a(0x134)](__dirname,bbpath2,_0x59a09a(0x1a1)))),app[_0x59a09a(0x194)](express[_0x59a09a(0x171)](path[_0x59a09a(0x134)](__dirname,bbpath2,_0x59a09a(0x1d2)))),app['get']('/',function(_0x375e79,_0x8d847c){const _0x57d827=_0x59a09a;_0x8d847c[_0x57d827(0x211)](path[_0x57d827(0x134)](__dirname,bbpath2,'build2',_0x57d827(0xbd)));}),app[_0x59a09a(0x156)]('/:bot',function(_0x2a8100,_0x3b5ae9){const _0x2e0094=_0x59a09a;_0x3b5ae9[_0x2e0094(0x211)](path[_0x2e0094(0x134)](__dirname,bbpath2,_0x2e0094(0x1d2),_0x2e0094(0xbd)));}),app['get'](_0x59a09a(0xc9),(_0x455dc4,_0x3230f0)=>{const _0x2a431f=_0x59a09a;_0x3230f0['sendFile'](path[_0x2a431f(0x134)](__dirname,bbpath2,_0x2a431f(0x1d2),_0x2a431f(0xbd)));}),app[_0x59a09a(0x156)](_0x59a09a(0x1d3),(_0x4c1111,_0x7ff805)=>{const _0x323a49=_0x59a09a;_0x7ff805[_0x323a49(0x211)](path[_0x323a49(0x134)](__dirname,bbpath2,'build',_0x323a49(0xbd)));}),app[_0x59a09a(0x156)](_0x59a09a(0x233),(_0x4bf509,_0x3f2657)=>{const _0x2fb354=_0x59a09a;_0x3f2657[_0x2fb354(0x211)](path[_0x2fb354(0x134)](__dirname,bbpath2,'build',_0x2fb354(0xbd)));}),app[_0x59a09a(0x156)]('/:bot/history',(_0x590b2c,_0x30b1d8)=>{const _0x5a34c3=_0x59a09a;_0x30b1d8[_0x5a34c3(0x211)](path[_0x5a34c3(0x134)](__dirname,bbpath2,_0x5a34c3(0x1d2),_0x5a34c3(0xbd)));}),app['get']('/:bot/configuration',(_0xca844c,_0x25c4f4)=>{const _0xf64bfd=_0x59a09a;_0x25c4f4[_0xf64bfd(0x211)](path['join'](__dirname,bbpath2,_0xf64bfd(0x1d2),'index.html'));}),app['get']('/:bot/support',(_0x44e8bb,_0x13d222)=>{const _0x11f70b=_0x59a09a;_0x13d222[_0x11f70b(0x211)](path[_0x11f70b(0x134)](__dirname,bbpath2,'build',_0x11f70b(0xbd)));});if(HOST)http[_0x59a09a(0x24b)](PORT,HOST);else http[_0x59a09a(0x24b)](PORT);const io=require(_0x59a09a(0x14a))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x125e4a=_0x59a09a;let _0xa94557='[ip-address]';const _0xc704dc=networkInterfaces(),_0x1b59e7={};for(const _0x523127 of Object[_0x125e4a(0x24c)](_0xc704dc)){for(const _0x449d68 of _0xc704dc[_0x523127]){if((_0x449d68[_0x125e4a(0x173)]=='IPv4'||_0x449d68[_0x125e4a(0x173)]==0x4)&&!_0x449d68[_0x125e4a(0x201)]){const _0x47f00b=ipaddr[_0x125e4a(0xda)](_0x449d68[_0x125e4a(0x25c)])[_0x125e4a(0x24a)]();_0x47f00b!=_0x125e4a(0x1b0)&&(!_0x1b59e7[_0x523127]&&(_0x1b59e7[_0x523127]=[]),_0x1b59e7[_0x523127]['push'](_0x449d68[_0x125e4a(0x25c)]),_0xa94557=_0x449d68[_0x125e4a(0x25c)]);}}}return{'serverip':_0xa94557,'netinterfaces':_0x1b59e7};}async function startServer(){const _0x5b856a=_0x59a09a,{serverip:_0x57445f,netinterfaces:_0x5e409a}=getServerIP();logger[_0x5b856a(0xe0)](''),logger[_0x5b856a(0xe0)]('-----------------------------------------------------------------------------------'),await logger[_0x5b856a(0x228)](_0x5b856a(0x1f4)+serverversion+_0x5b856a(0x165)+(environment==_0x5b856a(0xca)?'(staging)':'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x5b856a(0xce)+_0x57445f+':'+PORT+_0x5b856a(0x1e1))),logger['simple']('-----------------------------------------------------------------------------------');if(config[_0x5b856a(0x18f)]!=0x0)for(const _0x2df8f5 of config){if(_0x2df8f5[_0x5b856a(0xbe)]==_0x5b856a(0xf8)||_0x2df8f5[_0x5b856a(0xbe)]==_0x5b856a(0x182))await logger[_0x5b856a(0x228)](_0x5b856a(0x246)+_0x2df8f5['botID']+_0x5b856a(0x241)+_0x2df8f5['botname']),startBot([_0x2df8f5[_0x5b856a(0x146)],userID],{'cwd':bbpath},function(_0x4ac7fc){const _0x3ccd34=_0x5b856a;if(_0x4ac7fc)logger[_0x3ccd34(0x228)](_0x4ac7fc);});else(_0x2df8f5[_0x5b856a(0xbe)]==_0x5b856a(0x101)||_0x2df8f5[_0x5b856a(0xbe)]=='new-disabled')&&await logger[_0x5b856a(0x228)](_0x5b856a(0x261)+_0x2df8f5[_0x5b856a(0x146)]+'\x20|\x20'+_0x2df8f5['botname']);}else!newBot&&logger['simple']('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x5b856a(0xe0)]('-----------------------------------------------------------------------------------'),logger[_0x5b856a(0xe0)](''),await logger[_0x5b856a(0x10e)](_0x5b856a(0x1a2)+nodeversion),await logger[_0x5b856a(0x10e)]('Network\x20Interfaces:',_0x5e409a);}function startSocket(){const _0x51a429=_0x59a09a;io['on'](_0x51a429(0x236),_0x538068=>{const _0x442d69=_0x51a429;let _0x921b85,_0x426040,_0x4ab1f6,_0x5cf4a9,_0x1fc082;const _0x3328f6=_0x538068[_0x442d69(0x109)][_0x442d69(0x104)][_0x442d69(0x273)];_0x426040=_0x3328f6[_0x442d69(0x11b)](/bot[0-9]{3}/);if(_0x426040)_0x4ab1f6=_0x426040[0x0]['match'](/[0-9]{3}/);if(_0x4ab1f6)_0x921b85=_0x4ab1f6[0x0];else _0x921b85=_0x442d69(0x268);const _0x56b27d=_0x538068[_0x442d69(0x109)][_0x442d69(0x164)]['encryptedUuid'];if(!_0x56b27d)_0x538068[_0x442d69(0x127)](_0x442d69(0xbe),{'publicKey':secure['publicKey']});else{_0x5cf4a9=timelyDecrypt(_0x56b27d,![]);if(!_0x5cf4a9)_0x538068['emit']('status',{'publicKey':secure['publicKey']});else{_0x1fc082=normalizeIP(_0x538068[_0x442d69(0x116)][_0x442d69(0x247)])['store'];if(!devices[_0x5cf4a9])devices[_0x5cf4a9]={'uuid':_0x5cf4a9,'access':{'token':null}};devices[_0x5cf4a9]['ip']=_0x1fc082;const _0x5211c1=addClient(_0x538068['id'],_0x5cf4a9,_0x921b85);setAccess(_0x5211c1),emitMessages(),_0x538068['on'](_0x442d69(0x250),_0x1b98a0=>{const _0x3cc01e=_0x442d69,_0x53cd61=timelyDecrypt(_0x1b98a0[_0x3cc01e(0x1cd)]);if(_0x53cd61){_0x1b98a0={'username':_0x1b98a0['username'],'password':_0x53cd61},devices[_0x5cf4a9][_0x3cc01e(0x195)]=validateCredentials(_0x1b98a0,_0x5cf4a9);if(devices[_0x5cf4a9][_0x3cc01e(0x195)][_0x3cc01e(0x216)]==![]&&devices[_0x5cf4a9][_0x3cc01e(0x195)]['reason']==_0x3cc01e(0x1b4))_0x538068[_0x3cc01e(0x127)](_0x3cc01e(0xbe),{'access':devices[_0x5cf4a9][_0x3cc01e(0x195)]}),loginAccess2FA(_0x5cf4a9,_0x1fc082);else{if(devices[_0x5cf4a9][_0x3cc01e(0x195)][_0x3cc01e(0x216)]==![]&&devices[_0x5cf4a9][_0x3cc01e(0x195)]['reason']==_0x3cc01e(0xd6))_0x538068[_0x3cc01e(0x127)](_0x3cc01e(0xbe),{'access':devices[_0x5cf4a9]['access']});else devices[_0x5cf4a9][_0x3cc01e(0x195)][_0x3cc01e(0x216)]&&devices[_0x5cf4a9][_0x3cc01e(0x195)][_0x3cc01e(0x1dd)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x5cf4a9)[_0x3cc01e(0x26c)](_0x589ddf=>{setAccess(_0x589ddf);}),logger['debug']('Logged\x20in\x20user\x20...'+_0x5cf4a9[_0x3cc01e(0x1d4)](-0x8)),setTokenRefresh(_0x5cf4a9),setSessionTimeout(_0x3cc01e(0x250),_0x5cf4a9));}}else logger['full'](_0x3cc01e(0x226));}),_0x538068['on']('reset-password',()=>{resetPassword();}),_0x538068['on'](_0x442d69(0x1fe),_0xa094a3=>{removeClient(_0x538068['id']);}),_0x921b85=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x3af392){const _0x375e95=_0x59a09a;if(_0x3af392!=_0x375e95(0x268)&&config[_0x375e95(0x238)]!=''){if(pid[_0x3af392])pid[_0x3af392][_0x375e95(0x1b9)]({'function':'initclient','args':null});}_0x3af392!=_0x375e95(0x268)&&broadcastToBots(_0x375e95(0x215),JSON[_0x375e95(0x210)](config));}function reloadBotManager(){const _0x332b0f=_0x59a09a;getClientsWithBotID(_0x332b0f(0x268))[_0x332b0f(0x26c)](_0x56f33b=>{const _0x28e1eb=_0x332b0f;getSocket(_0x56f33b['id'])[_0x28e1eb(0x127)]('status',{'access':{'allow':![],'reason':_0x28e1eb(0x167),'token':null}});});}function getSocket(_0x1596d9){const _0x34dfd7=_0x59a09a;return io['sockets'][_0x34dfd7(0x1bc)]['get'](_0x1596d9);}function setAccess(_0x2e76f1){const _0x5e7733=_0x59a09a,_0x272220=getSocket(_0x2e76f1['id']),_0x5f45db=_0x2e76f1[_0x5e7733(0x180)],_0x52b594=_0x2e76f1[_0x5e7733(0x181)];devices[_0x5f45db][_0x5e7733(0x195)]=validateAccess(devices[_0x5f45db][_0x5e7733(0x195)]['token'],_0x5f45db),logger[_0x5e7733(0x10e)]('Setting\x20access:\x20'+devices[_0x5f45db][_0x5e7733(0x195)]['reason']+_0x5e7733(0x113)+_0x2e76f1['id'][_0x5e7733(0x1d4)](-0x8)+_0x5e7733(0x1a3)+_0x5f45db['slice'](-0x8)),_0x272220['join'](_0x5f45db);if(devices[_0x5f45db][_0x5e7733(0x195)]['allow']){_0x272220[_0x5e7733(0x134)](_0x52b594);if(_0x52b594==_0x5e7733(0x268))initializeSocketBotManager(_0x272220);else initializeSocketBot(_0x272220);initClient(_0x52b594);}devices[_0x5f45db][_0x5e7733(0x195)][_0x5e7733(0x1f8)]&&devices[_0x5f45db][_0x5e7733(0x195)]['reason']==_0x5e7733(0x1bb)&&setSessionTimeout(_0x5e7733(0x1e3),_0x5f45db),devices[_0x5f45db][_0x5e7733(0x195)]['token']&&devices[_0x5f45db][_0x5e7733(0x195)][_0x5e7733(0x1dd)]==_0x5e7733(0x21e)&&setSessionTimeout('login',_0x5f45db),_0x272220['emit'](_0x5e7733(0xbe),{'status':_0x2e76f1[_0x5e7733(0xd3)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5f45db]['access'],'externalip':devices[_0x5f45db]['ip'],'publicKey':secure[_0x5e7733(0x14f)],'userid':settings[_0x5e7733(0xe6)],'validInstallation':validInstallation}),devices[_0x5f45db][_0x5e7733(0x195)][_0x5e7733(0x216)]==![]&&devices[_0x5f45db][_0x5e7733(0x195)][_0x5e7733(0x1dd)]==_0x5e7733(0xc2)&&temporaryAccess2FA(_0x5f45db,devices[_0x5f45db]['ip']);}function setSessionTimeout(_0x1e9ad1,_0x3b1db5){const _0x17d2da=_0x59a09a;let _0x43b02e;if(_0x1e9ad1==_0x17d2da(0x250))_0x43b02e=loginExpiry*0x3c*0x3e8;else _0x43b02e=devices[_0x3b1db5][_0x17d2da(0x1d9)]['expiry']*0x3c*0x3e8-(new Date()[_0x17d2da(0x231)]()-devices[_0x3b1db5]['telegramIpApproval'][_0x17d2da(0x221)]);if(devices[_0x3b1db5][_0x17d2da(0x1b5)])clearTimeout(devices[_0x3b1db5][_0x17d2da(0x1b5)]);devices[_0x3b1db5]['pidExpireLogin']=setTimeout(()=>{const _0x47c848=_0x17d2da;if(devices[_0x3b1db5][_0x47c848(0x158)])clearTimeout(devices[_0x3b1db5][_0x47c848(0x158)]);removeSocketListeners(_0x3b1db5),addBlacklist(_0x3b1db5),devices[_0x3b1db5][_0x47c848(0x1d9)]=null,devices[_0x3b1db5][_0x47c848(0x26b)]=null,devices[_0x3b1db5][_0x47c848(0x195)][_0x47c848(0x1f8)]=null,logger[_0x47c848(0x10e)](_0x47c848(0x203)+_0x3b1db5[_0x47c848(0x1d4)](-0x8)),devices[_0x3b1db5]['access']=validateAccess(devices[_0x3b1db5][_0x47c848(0x195)][_0x47c848(0x1f8)],_0x3b1db5),!(devices[_0x3b1db5][_0x47c848(0x195)][_0x47c848(0x216)]&&devices[_0x3b1db5][_0x47c848(0x195)]['reason']==_0x47c848(0x14c))&&(_0x1e9ad1==_0x47c848(0x250)?io['to'](_0x3b1db5)[_0x47c848(0x127)](_0x47c848(0xbe),{'access':{'allow':![],'reason':_0x47c848(0x1b7),'token':null}}):io['to'](_0x3b1db5)['emit'](_0x47c848(0xbe),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x3b1db5][_0x47c848(0x195)][_0x47c848(0x1f8)]=null;},_0x43b02e);}function setTokenRefresh(_0x4aab78){const _0x127868=_0x59a09a;if(devices[_0x4aab78][_0x127868(0x158)])clearTimeout(devices[_0x4aab78][_0x127868(0x158)]);devices[_0x4aab78][_0x127868(0x158)]=setTimeout(()=>{const _0x1162fc=_0x127868;getClientsWithUuid(_0x4aab78)[_0x1162fc(0x18f)]!=0x0?(devices[_0x4aab78][_0x1162fc(0x195)]=refreshToken(_0x4aab78),io['to'](_0x4aab78)[_0x1162fc(0x127)](_0x1162fc(0xbe),{'status':_0x1162fc(0x15a),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4aab78][_0x1162fc(0x195)],'externalip':devices[_0x4aab78]['ip'],'publicKey':secure[_0x1162fc(0x14f)],'validInstallation':validInstallation}),setTokenRefresh(_0x4aab78)):clearTimeout(devices[_0x4aab78][_0x1162fc(0x158)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4328bf){const _0x1f371b=_0x59a09a,_0x2e9bad=getClient(_0x4328bf['id'])[_0x1f371b(0x180)];_0x4328bf['emit'](_0x1f371b(0x215),config),_0x4328bf[_0x1f371b(0x127)](_0x1f371b(0x16d),cleanSettings()),_0x4328bf['on']('add-bot',_0x3c2794=>{const _0xc660b6=_0x1f371b;if(validateAccess(_0x3c2794,_0x2e9bad)['allow'])addBot();else logger[_0xc660b6(0x228)](_0xc660b6(0x253));}),_0x4328bf['on']('update-bot',(_0x5655b4,_0x27df4a)=>{const _0x1836f4=_0x1f371b;if(validateAccess(_0x27df4a,_0x2e9bad)[_0x1836f4(0x216)])toggleBot(_0x5655b4[_0x1836f4(0x146)],_0x5655b4['status'],_0x5655b4[_0x1836f4(0x130)]);else logger[_0x1836f4(0x228)](_0x1836f4(0x222));}),_0x4328bf['on'](_0x1f371b(0x262),(_0x27e223,_0xc4d496)=>{const _0x1a42e8=_0x1f371b;if(validateAccess(_0xc4d496,_0x2e9bad)[_0x1a42e8(0x216)])toggleBotMode(_0x27e223);else logger['full'](_0x1a42e8(0x222));}),_0x4328bf['on'](_0x1f371b(0xf0),(_0x5ebd91,_0x201436)=>{const _0xa6e2c7=_0x1f371b;if(validateAccess(_0x201436,_0x2e9bad)[_0xa6e2c7(0x216)])deleteBot(_0x5ebd91);else logger['full'](_0xa6e2c7(0x252));}),_0x4328bf['on'](_0x1f371b(0x141),(_0x1bf27b,_0x25ab56)=>{const _0x1269b2=_0x1f371b;if(validateAccess(_0x25ab56,_0x2e9bad)[_0x1269b2(0x216)])storeSettings(_0x1bf27b,!![]);else logger['full'](_0x1269b2(0x122));}),_0x4328bf['on'](_0x1f371b(0x266),_0x302206=>{const _0xa2a1df=_0x1f371b;if(validateAccess(_0x302206,_0x2e9bad)[_0xa2a1df(0x216)])updateBB(_0xa2a1df(0x1ab));else logger[_0xa2a1df(0x228)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x4328bf['on'](_0x1f371b(0x188),_0x2764a6=>{const _0x4e8d79=_0x1f371b;if(validateAccess(_0x2764a6,_0x2e9bad)[_0x4e8d79(0x216)])updateBB(_0x4e8d79(0x1aa));else logger[_0x4e8d79(0x228)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x4328bf['on'](_0x1f371b(0xf1),_0x339169=>{const _0x57a355=_0x1f371b;if(validateAccess(_0x339169,_0x2e9bad)[_0x57a355(0x216)]){const _0x3aeaab=getClient(_0x4328bf['id']);if(_0x3aeaab)getBackupFiles(_0x3aeaab['uuid']);else logger[_0x57a355(0x228)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger['full'](_0x57a355(0xc7));}),_0x4328bf['on'](_0x1f371b(0x11d),(_0x1d74b5,_0x433522)=>{const _0x420951=_0x1f371b;if(validateAccess(_0x433522,_0x2e9bad)['allow'])restoreBackupFile(_0x1d74b5);else logger[_0x420951(0x228)](_0x420951(0x1ea));}),_0x4328bf['on'](_0x1f371b(0x24f),_0x20a0f9=>{const _0x30f29e=_0x1f371b;if(validateAccess(_0x20a0f9,_0x2e9bad)['allow'])getMessages();else logger[_0x30f29e(0x228)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x4328bf['on']('confirm-message',(_0x512999,_0x4a1b43)=>{const _0x4d5407=_0x1f371b;if(validateAccess(_0x4a1b43,_0x2e9bad)[_0x4d5407(0x216)])confirmMessage(_0x512999);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x4328bf['on'](_0x1f371b(0x1c7),_0x585fcc=>{const _0x5af59d=_0x1f371b;if(validateAccess(_0x585fcc,_0x2e9bad)[_0x5af59d(0x216)]){if(devices[_0x2e9bad]['pidRefreshToken'])clearTimeout(devices[_0x2e9bad][_0x5af59d(0x158)]);if(devices[_0x2e9bad]['pidExpireLogin'])clearTimeout(devices[_0x2e9bad][_0x5af59d(0x1b5)]);removeSocketListeners(getClient(_0x4328bf['id'])[_0x5af59d(0x180)]),addBlacklist(_0x2e9bad),devices[_0x2e9bad][_0x5af59d(0x1d9)]=null,devices[_0x2e9bad]['telegram2FaApproval']=null,devices[_0x2e9bad][_0x5af59d(0x195)][_0x5af59d(0x1f8)]=null,logger[_0x5af59d(0x10e)](_0x5af59d(0x10c)+_0x2e9bad[_0x5af59d(0x1d4)](-0x8)),io['to'](getClient(_0x4328bf['id'])[_0x5af59d(0x180)])[_0x5af59d(0x127)](_0x5af59d(0xbe),{'access':{'allow':![],'reason':_0x5af59d(0x20b),'token':null}});}else logger[_0x5af59d(0x228)](_0x5af59d(0x10b));});}function initializeSocketBot(_0x5dd6fb){const _0x2d8ba9=_0x59a09a,_0x5d1827=getClient(_0x5dd6fb['id'])['bot'],_0x2c2b1a=getClient(_0x5dd6fb['id'])['uuid'];_0x5dd6fb['on'](_0x2d8ba9(0x260),(_0x3a5494,_0x2066ac)=>{const _0x339434=_0x2d8ba9;if(validateAccess(_0x2066ac,_0x2c2b1a)[_0x339434(0x216)]){if(pid[_0x5d1827])pid[_0x5d1827][_0x339434(0x1b9)]({'function':'emitHistory','args':_0x3a5494});}else logger[_0x339434(0x228)](_0x339434(0x1e9));}),_0x5dd6fb['on'](_0x2d8ba9(0x24e),(_0x480e02,_0x34620a)=>{const _0x1733ab=_0x2d8ba9;if(validateAccess(_0x34620a,_0x2c2b1a)[_0x1733ab(0x216)]){if(pid[_0x5d1827])pid[_0x5d1827][_0x1733ab(0x1b9)]({'function':_0x1733ab(0xb6),'args':_0x480e02});}else logger[_0x1733ab(0x228)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x5dd6fb['on'](_0x2d8ba9(0xfc),(_0xe7548,_0x43b8d0)=>{const _0x490c4e=_0x2d8ba9;if(validateAccess(_0x43b8d0,_0x2c2b1a)[_0x490c4e(0x216)]){if(pid[_0x5d1827])pid[_0x5d1827][_0x490c4e(0x1b9)]({'function':_0x490c4e(0x185),'args':_0xe7548});}else logger['full'](_0x490c4e(0xcc));}),_0x5dd6fb['on'](_0x2d8ba9(0xc8),(_0x1db86b,_0x5c220f)=>{const _0x47ef31=_0x2d8ba9;if(validateAccess(_0x5c220f,_0x2c2b1a)[_0x47ef31(0x216)]){if(pid[_0x5d1827])pid[_0x5d1827][_0x47ef31(0x1b9)]({'function':'storeConfiguration','args':_0x1db86b});}else logger[_0x47ef31(0x228)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x5dd6fb['on'](_0x2d8ba9(0x18e),(_0x2a555f,_0xbb405c)=>{const _0x490b08=_0x2d8ba9;if(validateAccess(_0xbb405c,_0x2c2b1a)['allow']){if(pid[_0x5d1827])pid[_0x5d1827][_0x490b08(0x1b9)]({'function':_0x490b08(0x245),'args':_0x2a555f});}else logger['full'](_0x490b08(0xc0));}),_0x5dd6fb['on'](_0x2d8ba9(0x1a5),(_0x389e04,_0x5209d6)=>{const _0x5c3414=_0x2d8ba9;if(validateAccess(_0x5209d6,_0x2c2b1a)[_0x5c3414(0x216)]){if(pid[_0x5d1827])pid[_0x5d1827]['send']({'function':_0x5c3414(0xfb),'args':_0x389e04});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x5dd6fb['on'](_0x2d8ba9(0x257),_0x153eef=>{const _0x39594c=_0x2d8ba9;if(validateAccess(_0x153eef,_0x2c2b1a)[_0x39594c(0x216)]){if(pid[_0x5d1827])pid[_0x5d1827][_0x39594c(0x1b9)]({'function':_0x39594c(0x206),'args':null});}else logger[_0x39594c(0x228)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x5dd6fb['on']('get-starting-balances',_0x2271ba=>{const _0x49d734=_0x2d8ba9;if(validateAccess(_0x2271ba,_0x2c2b1a)[_0x49d734(0x216)]){if(pid[_0x5d1827])pid[_0x5d1827]['send']({'function':_0x49d734(0x12e),'args':null});}else logger['full'](_0x49d734(0x1e5));}),_0x5dd6fb['on'](_0x2d8ba9(0xcf),(_0x252a9e,_0x49f7b3)=>{const _0x23fd5c=_0x2d8ba9;if(validateAccess(_0x49f7b3,_0x2c2b1a)[_0x23fd5c(0x216)]){if(pid[_0x5d1827])pid[_0x5d1827][_0x23fd5c(0x1b9)]({'function':_0x23fd5c(0x17d),'args':_0x252a9e});}else logger[_0x23fd5c(0x228)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x5dd6fb['on']('cancel-loading',_0x5e1198=>{const _0x10419e=_0x2d8ba9;if(validateAccess(_0x5e1198,_0x2c2b1a)[_0x10419e(0x216)]){if(pid[_0x5d1827])pid[_0x5d1827][_0x10419e(0x1b9)]({'function':_0x10419e(0x249),'args':null});}else logger[_0x10419e(0x228)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x5dd6fb['on'](_0x2d8ba9(0xe9),_0x4be2ce=>{const _0x575401=_0x2d8ba9;if(validateAccess(_0x4be2ce,_0x2c2b1a)[_0x575401(0x216)]){if(pid[_0x5d1827])pid[_0x5d1827][_0x575401(0x1b9)]({'function':_0x575401(0xe1),'args':null});}else logger[_0x575401(0x228)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x5dd6fb['on'](_0x2d8ba9(0x266),_0x11e214=>{const _0xba09eb=_0x2d8ba9;if(validateAccess(_0x11e214,_0x2c2b1a)[_0xba09eb(0x216)])updateBB(_0xba09eb(0x1ab));else logger[_0xba09eb(0x228)](_0xba09eb(0x235));}),_0x5dd6fb['on'](_0x2d8ba9(0x24f),_0x45d611=>{const _0x4e0334=_0x2d8ba9;if(validateAccess(_0x45d611,_0x2c2b1a)[_0x4e0334(0x216)])getMessages();else logger[_0x4e0334(0x228)](_0x4e0334(0x26a));}),_0x5dd6fb['on'](_0x2d8ba9(0xd8),(_0x25bafe,_0x4dab6a)=>{const _0xe63e77=_0x2d8ba9;if(validateAccess(_0x4dab6a,_0x2c2b1a)[_0xe63e77(0x216)])confirmMessage(_0x25bafe);else logger[_0xe63e77(0x228)](_0xe63e77(0xfd));}),_0x5dd6fb['on'](_0x2d8ba9(0x1c7),_0x515a2c=>{const _0x40a1e0=_0x2d8ba9;if(validateAccess(_0x515a2c,_0x2c2b1a)['allow']){if(devices[_0x2c2b1a][_0x40a1e0(0x158)])clearTimeout(devices[_0x2c2b1a][_0x40a1e0(0x158)]);if(devices[_0x2c2b1a][_0x40a1e0(0x1b5)])clearTimeout(devices[_0x2c2b1a]['pidExpireLogin']);removeSocketListeners(getClient(_0x5dd6fb['id'])[_0x40a1e0(0x180)]),addBlacklist(_0x2c2b1a),devices[_0x2c2b1a][_0x40a1e0(0x1d9)]=null,devices[_0x2c2b1a]['telegram2FaApproval']=null,devices[_0x2c2b1a][_0x40a1e0(0x195)]['token']=null,logger[_0x40a1e0(0x10e)](_0x40a1e0(0x10c)+_0x2c2b1a[_0x40a1e0(0x1d4)](-0x8)),io['to'](getClient(_0x5dd6fb['id'])['uuid'])['emit'](_0x40a1e0(0xbe),{'access':{'allow':![],'reason':_0x40a1e0(0x20b),'token':null}});}else logger['full'](_0x40a1e0(0x10b));});}function removeSocketListeners(_0x1caa46){const _0xa879bf=_0x59a09a;getClientsWithUuid(_0x1caa46)[_0xa879bf(0x26c)](_0x15dacd=>{const _0x26c009=_0xa879bf;getSocket(_0x15dacd['id'])[_0x26c009(0x12a)]();});}function cleanSettings(){const _0x5556e4=_0x59a09a;let _0x423786=settings;return settings[_0x5556e4(0x1ae)]&&settings['telegramToken']!=''&&(_0x423786={..._0x423786,'telegramToken':_0x5556e4(0x23f)}),settings[_0x5556e4(0x157)]&&settings[_0x5556e4(0x157)]!=''&&(_0x423786={..._0x423786,'bbPassword':'************'}),(settings[_0x5556e4(0x157)]&&settings[_0x5556e4(0x157)]==_0x5556e4(0x21f)||settings[_0x5556e4(0x1ae)]&&settings[_0x5556e4(0x1ae)]==_0x5556e4(0x21f))&&(_0x423786={..._0x423786,'restored':{'password':settings[_0x5556e4(0x157)]=='***','telegram':settings['telegramToken']==_0x5556e4(0x21f)}}),_0x423786;}async function updateBB(_0x4a5658){const _0x1eb409=_0x59a09a;await backupConfigFiles(),installingUpdate=!![],config[_0x1eb409(0x26c)](_0x482ebd=>{const _0x5a3538=_0x1eb409;restartBot(_0x482ebd[_0x5a3538(0x146)]);});if(_0x4a5658=='update')process['send']({'update':!![],'environment':environment},_0x200625=>{});else _0x4a5658=='reinstall'&&process['send']({'reinstall':!![],'environment':environment},_0x1455de=>{});}function startBot(_0x55ed38,_0x4eb7d6,_0x1fe5f1){const _0x3d1044=_0x59a09a;if(debugging)_0x55ed38[_0x3d1044(0x1b3)]('-d');let _0x501f6c=![];const _0x5e7e21=_0x55ed38[0x0];_0x4eb7d6={..._0x4eb7d6,'stdio':['inherit',_0x3d1044(0x10a),'inherit',_0x3d1044(0x212)]},pid[_0x5e7e21]=childProcess[_0x3d1044(0x1db)](botfile,_0x55ed38,_0x4eb7d6),pid[_0x5e7e21]['on'](_0x3d1044(0x1f0),_0x4e5882=>{const _0x47a69e=_0x3d1044;switch(Object[_0x47a69e(0x24c)](_0x4e5882)[0x0]){case _0x47a69e(0x1a6):updateBotName(_0x5e7e21,_0x4e5882['botname']);break;case _0x47a69e(0x27b):updateBotManager();break;case _0x47a69e(0xbe):updateStatus(_0x5e7e21,_0x4e5882[_0x47a69e(0xbe)]);break;case _0x47a69e(0x130):updateLive(_0x5e7e21,_0x4e5882['live']);break;case _0x47a69e(0x1e8):updateLive(_0x5e7e21,_0x4e5882[_0x47a69e(0x1e8)]),io['to'](_0x5e7e21)[_0x47a69e(0x127)](_0x47a69e(0xbe),{'access':{'allow':![],'reason':_0x47a69e(0x167),'token':null}});break;case _0x47a69e(0x240):_0x4e5882['stop']==_0x47a69e(0x209)&&restartBot(_0x5e7e21);_0x4e5882[_0x47a69e(0x240)]==_0x47a69e(0x281)&&toggleBot(_0x5e7e21,_0x47a69e(0x101),_0x47a69e(0x287));break;case _0x47a69e(0x1a7):sendTelegram(_0x5e7e21,_0x4e5882[_0x47a69e(0x1a7)]);break;case _0x47a69e(0x279):sendTelegramMsg(_0x4e5882[_0x47a69e(0x279)]);break;case _0x47a69e(0x265):io['to'](_0x5e7e21)[_0x47a69e(0x127)](_0x4e5882[_0x47a69e(0x265)],_0x4e5882['args']);break;}}),pid[_0x5e7e21]['on'](_0x3d1044(0x154),function(_0x1e6439){if(_0x501f6c)return;_0x501f6c=!![],_0x1fe5f1(_0x1e6439);}),pid[_0x5e7e21]['on'](_0x3d1044(0x11e),async function(_0x351a21){const _0x25f14c=_0x3d1044;if(installingUpdate)return;if(_0x501f6c)return;_0x501f6c=!![],_0x1fe5f1(null);const _0x23fda8=dbConfig[_0x25f14c(0x156)]('bots')[_0x25f14c(0x20f)]({'botID':_0x5e7e21})['value']();_0x23fda8&&(_0x23fda8['status']=='enabled'||_0x23fda8[_0x25f14c(0xbe)]=='new')&&(await sleep(0x3e8),updateLive(_0x5e7e21,_0x25f14c(0x287)),logger[_0x25f14c(0x228)](_0x25f14c(0x26e)+_0x5e7e21),startBot([_0x5e7e21,userID],{'cwd':bbpath},function(_0x2ce55c){const _0x1f0dad=_0x25f14c;if(_0x2ce55c)logger[_0x1f0dad(0x228)](_0x2ce55c);}));});}function stopBot(_0x4ce93e){const _0x204700=_0x59a09a;getClientsWithBotID(_0x4ce93e)[_0x204700(0x26c)](_0x257aa1=>{getSocket(_0x257aa1['id'])['disconnect'](!![]),removeClient(_0x257aa1['id']);}),pid[_0x4ce93e]&&(pid[_0x4ce93e][_0x204700(0x281)](),pid[_0x4ce93e]=null);}function restartBot(_0x29d2c6){const _0x526eed=_0x59a09a;if(pid[_0x29d2c6])pid[_0x29d2c6][_0x526eed(0x281)]();}function addBot(){const _0x49b651=_0x59a09a;let _0xc4ebf6;for(let _0x18a90d=0x1;_0x18a90d<0x3e9;_0x18a90d++){_0xc4ebf6=_0x18a90d[_0x49b651(0x16c)]()[_0x49b651(0xf4)](0x3,'0');let _0xae05bf=config[_0x49b651(0x20f)](_0x4dc694=>_0x4dc694[_0x49b651(0x146)]==_0xc4ebf6);if(!_0xae05bf)break;}if(_0xc4ebf6===_0x49b651(0xbb)){logger[_0x49b651(0x228)](_0x49b651(0x1b1));return;}logger[_0x49b651(0x228)](_0x49b651(0x26f)+_0xc4ebf6),dbConfig[_0x49b651(0x156)](_0x49b651(0x215))[_0x49b651(0x1b3)]({'botID':_0xc4ebf6,'botname':_0x49b651(0x220)+_0xc4ebf6,'status':_0x49b651(0x182),'live':''})[_0x49b651(0x140)](),startBot([_0xc4ebf6,userID],{'cwd':bbpath},function(_0x1a5f87){const _0x3da919=_0x49b651;if(_0x1a5f87)logger[_0x3da919(0x228)](_0x1a5f87);}),config=getConfiguration(),io['to']('botmanager')[_0x49b651(0x127)](_0x49b651(0x215),config),broadcastToBots(_0x49b651(0x215),JSON['stringify'](config));}function deleteBot(_0x5d6ad1){const _0x22d462=_0x59a09a;getClientsWithBotID(_0x5d6ad1)[_0x22d462(0x26c)](_0xc3efe7=>{const _0x2d1522=_0x22d462;getSocket(_0xc3efe7['id'])[_0x2d1522(0x1fe)](!![]),removeClient(_0xc3efe7['id']);}),dbConfig['get'](_0x22d462(0x215))[_0x22d462(0x193)]({'botID':_0x5d6ad1})[_0x22d462(0x140)](),logger['full'](_0x22d462(0x1cf)+_0x5d6ad1),stopBot(_0x5d6ad1);try{if(fs['existsSync'](path[_0x22d462(0x134)](configpath,_0x22d462(0x208)+_0x5d6ad1+_0x22d462(0x1c2))))fs[_0x22d462(0x1fa)](path[_0x22d462(0x134)](configpath,_0x22d462(0x208)+_0x5d6ad1+'-config.json'));if(fs[_0x22d462(0x136)](path[_0x22d462(0x134)](configpath,_0x22d462(0x208)+_0x5d6ad1+_0x22d462(0x14d))))fs[_0x22d462(0x1fa)](path[_0x22d462(0x134)](configpath,_0x22d462(0x208)+_0x5d6ad1+'-events.json'));if(fs[_0x22d462(0x136)](path[_0x22d462(0x134)](configpath,'bot-'+_0x5d6ad1+_0x22d462(0xe3))))fs[_0x22d462(0x1fa)](path[_0x22d462(0x134)](configpath,_0x22d462(0x208)+_0x5d6ad1+_0x22d462(0xe3)));if(fs[_0x22d462(0x136)](path[_0x22d462(0x134)](configpath,_0x22d462(0x208)+_0x5d6ad1+_0x22d462(0x1be))))fs['unlinkSync'](path[_0x22d462(0x134)](configpath,_0x22d462(0x208)+_0x5d6ad1+_0x22d462(0x1be)));}catch(_0x3f24d7){if(_0x3f24d7)logger['full']('Error\x20while\x20deleting\x20config\x20files:\x20',_0x3f24d7);}config=getConfiguration(),io['to'](_0x22d462(0x268))[_0x22d462(0x127)](_0x22d462(0x215),config),broadcastToBots(_0x22d462(0x215),JSON[_0x22d462(0x210)](config));}function toggleBot(_0x578bec,_0x252726,_0x21cbde){const _0x12135e=_0x59a09a;dbConfig[_0x12135e(0x156)](_0x12135e(0x215))[_0x12135e(0x20f)]({'botID':_0x578bec})[_0x12135e(0x1ec)]({'status':_0x252726})[_0x12135e(0x1ec)]({'live':_0x21cbde})[_0x12135e(0x140)]();if(_0x252726==_0x12135e(0xf8)||_0x252726==_0x12135e(0x182))logger[_0x12135e(0x228)]('Enabled\x20Bot\x20'+_0x578bec),startBot([_0x578bec,userID],{'cwd':bbpath},function(_0xe3fdc){const _0x2e49a5=_0x12135e;if(_0xe3fdc)logger[_0x2e49a5(0x228)](_0xe3fdc);});else(_0x252726==_0x12135e(0x101)||_0x252726=='new-disabled')&&(logger[_0x12135e(0x228)](_0x12135e(0x20c)+_0x578bec),stopBot(_0x578bec));config=getConfiguration(),io['to'](_0x12135e(0x268))['emit'](_0x12135e(0x215),config),broadcastToBots(_0x12135e(0x215),JSON[_0x12135e(0x210)](config));}function toggleStatus(_0x5d9cb5){const _0x529773=_0x59a09a;let _0x5a8b7e=dbConfig[_0x529773(0x156)]('bots')[_0x529773(0x20f)]({'botID':_0x5d9cb5})[_0x529773(0x183)](),_0xe256b6;if(_0x5a8b7e[_0x529773(0xbe)]===_0x529773(0xf8))_0xe256b6=_0x529773(0x101);else{if(_0x5a8b7e[_0x529773(0xbe)]==='new')_0xe256b6=_0x529773(0xc5);else{if(_0x5a8b7e[_0x529773(0xbe)]===_0x529773(0xc5))_0xe256b6=_0x529773(0x182);else{if(_0x5a8b7e['status']===_0x529773(0x101))_0xe256b6='enabled';}}}return _0xe256b6;}function updateStatus(_0x29e535,_0x12883f){const _0x5b7f15=_0x59a09a;dbConfig[_0x5b7f15(0x156)](_0x5b7f15(0x215))[_0x5b7f15(0x20f)]({'botID':_0x29e535})[_0x5b7f15(0x1ec)]({'status':_0x12883f})[_0x5b7f15(0x140)](),config=getConfiguration(),io['to']('botmanager')[_0x5b7f15(0x127)](_0x5b7f15(0x215),config),broadcastToBots(_0x5b7f15(0x215),JSON[_0x5b7f15(0x210)](config));}function updateLive(_0x264bf3,_0xa0f475){const _0x15753e=_0x59a09a;dbConfig[_0x15753e(0x156)](_0x15753e(0x215))[_0x15753e(0x20f)]({'botID':_0x264bf3})[_0x15753e(0x1ec)]({'live':_0xa0f475})['write'](),config=getConfiguration(),io['to'](_0x15753e(0x268))[_0x15753e(0x127)](_0x15753e(0x215),config),broadcastToBots(_0x15753e(0x215),JSON[_0x15753e(0x210)](config));}function updateBotName(_0x4d8dd9,_0x49ffea){const _0x5e8583=_0x59a09a;dbConfig[_0x5e8583(0x156)](_0x5e8583(0x215))[_0x5e8583(0x20f)]({'botID':_0x4d8dd9})[_0x5e8583(0x1ec)]({'botname':_0x49ffea})[_0x5e8583(0x140)](),config=getConfiguration(),io['to']('botmanager')[_0x5e8583(0x127)](_0x5e8583(0x215),config),broadcastToBots(_0x5e8583(0x215),JSON[_0x5e8583(0x210)](config));}function updateBotManager(){const _0x40afae=_0x59a09a;config=getConfiguration(),io['to'](_0x40afae(0x268))[_0x40afae(0x127)]('bots',config),broadcastToBots(_0x40afae(0x215),JSON[_0x40afae(0x210)](config));}function toggleBotMode(_0x5dce88){const _0x3f57f9=_0x59a09a;if(pid[_0x5dce88])pid[_0x5dce88]['send']({'function':_0x3f57f9(0x1df),'args':null});else{const _0x22c527=configpath+_0x3f57f9(0x208)+_0x5dce88+_0x3f57f9(0x1c2),_0x51df13=fs[_0x3f57f9(0x230)](_0x22c527),_0x574df8=JSON[_0x3f57f9(0xda)](_0x51df13),_0xe6aad7=_0x574df8[_0x3f57f9(0x181)][0x0][_0x3f57f9(0x1cc)];_0x574df8['bot'][0x0][_0x3f57f9(0x1cc)]=!_0xe6aad7;const _0x2ec4b8=JSON[_0x3f57f9(0x210)](_0x574df8,null,0x2);fs[_0x3f57f9(0xc3)](_0x22c527,_0x2ec4b8),config=getConfiguration(),io['to'](_0x3f57f9(0x268))[_0x3f57f9(0x127)](_0x3f57f9(0x215),config),broadcastToBots(_0x3f57f9(0x215),JSON[_0x3f57f9(0x210)](config));}}function telegramError(_0x14f929){const _0x1bd4a6=_0x59a09a;logger[_0x1bd4a6(0xe0)](getTimeStamp()+_0x1bd4a6(0x1d0));}function validateTelegram(_0x1abcc2){const _0x5e9937=_0x59a09a;if(_0x1abcc2[_0x5e9937(0xec)]['username']!=settings[_0x5e9937(0x267)]&&'@'+_0x1abcc2[_0x5e9937(0xec)]['username']!=settings[_0x5e9937(0x267)])return tgBot[_0x5e9937(0x232)](_0x1abcc2[_0x5e9937(0xe7)]['id'],_0x5e9937(0x27d),{'parse_mode':_0x5e9937(0x107)})['catch'](_0x2f3038=>{telegramError(_0x2f3038);}),![];return!![];}async function initTelegram(){const _0x20cf69=_0x59a09a;if(tgBot)tgBot[_0x20cf69(0x110)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x313b97=_0x20cf69(0x244);_0x313b97+='\x0a',_0x313b97+='/enable\x20-\x20enable\x20notifications\x0a',_0x313b97+=_0x20cf69(0x131),_0x313b97+=_0x20cf69(0x255),_0x313b97+=_0x20cf69(0xdc),_0x313b97+=_0x20cf69(0x144),_0x313b97+=_0x20cf69(0x1b8),_0x313b97+=_0x20cf69(0x1e4),_0x313b97+='/names\x20-\x20show\x20bot\x20names\x0a',_0x313b97+=_0x20cf69(0x229),_0x313b97+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x313b97+=_0x20cf69(0xd4),_0x313b97+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x313b97+=_0x20cf69(0x1ba),_0x313b97+=_0x20cf69(0xba);let _0x5a8ad6=_0x20cf69(0x278);_0x5a8ad6+='\x0a',_0x5a8ad6+=_0x313b97,tgBot[_0x20cf69(0x169)](/\/start/,_0x38f47d=>{const _0x6ed14a=_0x20cf69;if(!validateTelegram(_0x38f47d))return;if(settings['telegramChatId']!=_0x38f47d['chat']['id'])updateSetting('telegramChatId',_0x38f47d[_0x6ed14a(0xe7)]['id']);updateSetting('telegramEnabled',!![]),tgBot['sendMessage'](_0x38f47d[_0x6ed14a(0xe7)]['id'],_0x5a8ad6)[_0x6ed14a(0x25f)](_0x2fd502=>{telegramError(_0x2fd502);});}),tgBot['onText'](/\/enable/,_0x11263c=>{const _0x3955b7=_0x20cf69;if(!validateTelegram(_0x11263c))return;if(settings['telegramChatId']!=_0x11263c[_0x3955b7(0xe7)]['id'])updateSetting('telegramChatId',_0x11263c[_0x3955b7(0xe7)]['id']);updateSetting(_0x3955b7(0x256),!![]),tgBot['sendMessage'](_0x11263c[_0x3955b7(0xe7)]['id'],_0x3955b7(0x190))[_0x3955b7(0x25f)](_0x3eca3c=>{telegramError(_0x3eca3c);});}),tgBot[_0x20cf69(0x169)](/\/config/,async _0x3e9fdb=>{const _0x6194f4=_0x20cf69;if(!validateTelegram(_0x3e9fdb))return;tgBot[_0x6194f4(0xdd)](_0x6194f4(0x224)),tgBot[_0x6194f4(0x232)](_0x3e9fdb[_0x6194f4(0xe7)]['id'],_0x6194f4(0x15d),{'reply_markup':{'inline_keyboard':[[{'text':_0x6194f4(0x288),'callback_data':'orders'},{'text':'Alerts','callback_data':'alerts'},{'text':_0x6194f4(0xf7),'callback_data':'all'}]]}})[_0x6194f4(0x25f)](_0x2de2df=>{telegramError(_0x2de2df);}),tgBot['on'](_0x6194f4(0x224),async _0x4603b2=>{const _0x274e5e=_0x6194f4,_0x579260=_0x4603b2[_0x274e5e(0x15e)],_0x3b3054=_0x4603b2[_0x274e5e(0x1f0)];tgBot[_0x274e5e(0x159)](_0x4603b2['id'])['then'](async()=>{const _0x2f5ddf=_0x274e5e;_0x579260==_0x2f5ddf(0x143)&&(updateSetting(_0x2f5ddf(0x1a9),'orders'),updateSetting(_0x2f5ddf(0x256),!![]),await tgBot['sendMessage'](_0x3b3054[_0x2f5ddf(0xe7)]['id'],_0x2f5ddf(0x150))['catch'](_0x180654=>{telegramError(_0x180654);}));_0x579260==_0x2f5ddf(0x1ff)&&(updateSetting(_0x2f5ddf(0x1a9),_0x2f5ddf(0x1ff)),updateSetting(_0x2f5ddf(0x256),!![]),await tgBot[_0x2f5ddf(0x232)](_0x3b3054[_0x2f5ddf(0xe7)]['id'],_0x2f5ddf(0x13d))[_0x2f5ddf(0x25f)](_0x3814b1=>{telegramError(_0x3814b1);}));_0x579260=='all'&&(updateSetting(_0x2f5ddf(0x1a9),_0x2f5ddf(0x28b)),updateSetting(_0x2f5ddf(0x256),!![]),await tgBot[_0x2f5ddf(0x232)](_0x3b3054['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications')['catch'](_0x460be4=>{telegramError(_0x460be4);}));if(!settings[_0x2f5ddf(0x103)])tgBot[_0x2f5ddf(0x232)](_0x3b3054[_0x2f5ddf(0xe7)]['id'],_0x2f5ddf(0x214))[_0x2f5ddf(0x25f)](_0x1411b0=>{telegramError(_0x1411b0);});}),tgBot[_0x274e5e(0xdd)](_0x274e5e(0x224));});}),tgBot[_0x20cf69(0x169)](/\/status/,_0x32276a=>{const _0x4dfc1c=_0x20cf69;if(!validateTelegram(_0x32276a))return;const _0x13398c=getBotsWithMode();let _0x401a0b=_0x4dfc1c(0x189);config[_0x4dfc1c(0x26c)](_0x3b4ad2=>{const _0x4ffc6b=_0x4dfc1c,_0x10c085=_0x13398c[_0x4ffc6b(0x20f)](_0x51ffb0=>_0x51ffb0[_0x4ffc6b(0x146)]==_0x3b4ad2[_0x4ffc6b(0x146)])[_0x4ffc6b(0x139)];_0x401a0b+=_0x4ffc6b(0x220)+_0x3b4ad2[_0x4ffc6b(0x146)]+':\x20'+_0x3b4ad2[_0x4ffc6b(0xbe)]+'\x20|\x20'+_0x10c085+'\x20|\x20'+_0x3b4ad2['live']+'\x0a';}),_0x401a0b+='\x0a',_0x401a0b+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x401a0b+=!settings[_0x4dfc1c(0x256)]?'Notifications\x20disabled\x0a':'Notifications\x20enabled\x0a',_0x401a0b+=settings[_0x4dfc1c(0x256)]?settings[_0x4dfc1c(0x1a9)]==_0x4dfc1c(0x28b)?_0x4dfc1c(0x14e):'Notifications\x20types:\x20'+settings[_0x4dfc1c(0x1a9)]+_0x4dfc1c(0x289):'',tgBot[_0x4dfc1c(0x232)](_0x32276a['chat']['id'],_0x401a0b,{'parse_mode':_0x4dfc1c(0x107)})[_0x4dfc1c(0x25f)](_0x4cd7a2=>{telegramError(_0x4cd7a2);});}),tgBot[_0x20cf69(0x169)](/\/restart/,_0x2fb8db=>{const _0x1fa0c4=_0x20cf69;if(!validateTelegram(_0x2fb8db))return;tgBot[_0x1fa0c4(0xdd)](_0x1fa0c4(0x224));const _0x59d121=getEnabledBots();if(_0x59d121[_0x1fa0c4(0x18f)]==0x0)tgBot[_0x1fa0c4(0x232)](_0x2fb8db[_0x1fa0c4(0xe7)]['id'],_0x1fa0c4(0x1f3))[_0x1fa0c4(0x25f)](_0x5e0876=>{telegramError(_0x5e0876);});else{if(_0x59d121[_0x1fa0c4(0x18f)]>0x1)_0x59d121[_0x1fa0c4(0x1b3)]({'botID':_0x1fa0c4(0x28b)});let _0x49e19b=[],_0x36ed8e=[];const _0xe5c64a=_0x59d121[_0x1fa0c4(0x18f)]%0x4==0x0||_0x59d121['length']%0x4==0x3||_0x59d121[_0x1fa0c4(0x18f)]%0x3==0x1?0x4:0x3;let _0x59e6aa=0x0;_0x59d121[_0x1fa0c4(0x26c)]((_0x1ccecd,_0x39f433)=>{const _0x3b8e3a=_0x1fa0c4;if(_0x39f433%_0xe5c64a==0x0)_0x36ed8e=[];_0x36ed8e[_0x3b8e3a(0x1b3)]({'text':_0x1ccecd[_0x3b8e3a(0x146)]==_0x3b8e3a(0x28b)?_0x3b8e3a(0x1fb):_0x3b8e3a(0x220)+_0x1ccecd[_0x3b8e3a(0x146)],'callback_data':_0x1ccecd[_0x3b8e3a(0x146)]}),_0x39f433%_0xe5c64a==0x0&&(_0x49e19b[_0x59e6aa]=_0x36ed8e,_0x59e6aa++);}),tgBot[_0x1fa0c4(0x232)](_0x2fb8db[_0x1fa0c4(0xe7)]['id'],_0x1fa0c4(0x115),{'reply_markup':{'inline_keyboard':_0x49e19b}})['catch'](_0x135020=>{telegramError(_0x135020);}),tgBot['on']('callback_query',async _0x2812f7=>{const _0x5809a7=_0x1fa0c4,_0x3ee9ee=_0x2812f7[_0x5809a7(0x15e)],_0x357e67=_0x2812f7[_0x5809a7(0x1f0)];tgBot[_0x5809a7(0x159)](_0x2812f7['id'])[_0x5809a7(0x117)](async()=>{const _0x49a3f7=_0x5809a7;_0x3ee9ee=='all'?config[_0x49a3f7(0x26c)](_0x397b5d=>{const _0x56125d=_0x49a3f7;restartBot(_0x397b5d[_0x56125d(0x146)]);}):restartBot(_0x3ee9ee);}),tgBot[_0x5809a7(0xdd)](_0x5809a7(0x224));});}}),tgBot['onText'](/\/on/,_0x196bb6=>{const _0x440108=_0x20cf69;if(!validateTelegram(_0x196bb6))return;tgBot[_0x440108(0xdd)](_0x440108(0x224));const _0x7ff49=getDisabledBots();if(_0x7ff49[_0x440108(0x18f)]==0x0)tgBot['sendMessage'](_0x196bb6[_0x440108(0xe7)]['id'],_0x440108(0x1f9))['catch'](_0x20e07e=>{telegramError(_0x20e07e);});else{if(_0x7ff49[_0x440108(0x18f)]>0x1)_0x7ff49[_0x440108(0x1b3)]({'botID':'all'});let _0x3302f5=[],_0x367ad0=[];const _0xfe3ca=_0x7ff49[_0x440108(0x18f)]%0x4==0x0||_0x7ff49['length']%0x4==0x3||_0x7ff49['length']%0x3==0x1?0x4:0x3;let _0x12c39f=0x0;_0x7ff49[_0x440108(0x26c)]((_0x3680fe,_0xf9ee0f)=>{const _0x45fcf7=_0x440108;if(_0xf9ee0f%_0xfe3ca==0x0)_0x367ad0=[];_0x367ad0[_0x45fcf7(0x1b3)]({'text':_0x3680fe['botID']==_0x45fcf7(0x28b)?'All\x20bots':_0x45fcf7(0x220)+_0x3680fe['botID'],'callback_data':_0x3680fe[_0x45fcf7(0x146)]}),_0xf9ee0f%_0xfe3ca==0x0&&(_0x3302f5[_0x12c39f]=_0x367ad0,_0x12c39f++);}),tgBot[_0x440108(0x232)](_0x196bb6[_0x440108(0xe7)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x3302f5}})[_0x440108(0x25f)](_0x2f9aa2=>{telegramError(_0x2f9aa2);}),tgBot['on'](_0x440108(0x224),async _0x1cb72b=>{const _0x365fc6=_0x440108,_0x4ada5b=_0x1cb72b[_0x365fc6(0x15e)],_0x4ef63c=_0x1cb72b[_0x365fc6(0x1f0)];tgBot[_0x365fc6(0x159)](_0x1cb72b['id'])[_0x365fc6(0x117)](async()=>{const _0x183681=_0x365fc6;_0x4ada5b==_0x183681(0x28b)?(tgBot['sendMessage'](_0x4ef63c['chat']['id'],_0x183681(0x1da))[_0x183681(0x25f)](_0x4b0c8f=>{telegramError(_0x4b0c8f);}),_0x7ff49[_0x183681(0x26c)](_0x74b52d=>{const _0xb239e9=_0x183681;if(_0x74b52d[_0xb239e9(0x146)]!=_0xb239e9(0x28b))toggleBot(_0x74b52d[_0xb239e9(0x146)],toggleStatus(_0x74b52d['botID']),_0xb239e9(0x287));})):(tgBot[_0x183681(0x232)](_0x4ef63c[_0x183681(0xe7)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x4ada5b)[_0x183681(0x25f)](_0x5309c4=>{telegramError(_0x5309c4);}),toggleBot(_0x4ada5b,toggleStatus(_0x4ada5b),_0x183681(0x287)));}),tgBot['removeListener'](_0x365fc6(0x224));});}}),tgBot[_0x20cf69(0x169)](/\/off/,_0x3dea24=>{const _0x309b9f=_0x20cf69;if(!validateTelegram(_0x3dea24))return;tgBot[_0x309b9f(0xdd)](_0x309b9f(0x224));const _0x50c046=getEnabledBots();if(_0x50c046['length']==0x0)tgBot[_0x309b9f(0x232)](_0x3dea24[_0x309b9f(0xe7)]['id'],_0x309b9f(0x1f3))[_0x309b9f(0x25f)](_0x1387f6=>{telegramError(_0x1387f6);});else{if(_0x50c046[_0x309b9f(0x18f)]>0x1)_0x50c046[_0x309b9f(0x1b3)]({'botID':'all'});let _0x1199d1=[],_0x393bdd=[];const _0x1fe810=_0x50c046[_0x309b9f(0x18f)]%0x4==0x0||_0x50c046[_0x309b9f(0x18f)]%0x4==0x3||_0x50c046[_0x309b9f(0x18f)]%0x3==0x1?0x4:0x3;let _0x198556=0x0;_0x50c046['forEach']((_0x5162f2,_0x3cc5e7)=>{const _0x32a822=_0x309b9f;if(_0x3cc5e7%_0x1fe810==0x0)_0x393bdd=[];_0x393bdd['push']({'text':_0x5162f2['botID']==_0x32a822(0x28b)?_0x32a822(0x1fb):_0x32a822(0x220)+_0x5162f2[_0x32a822(0x146)],'callback_data':_0x5162f2['botID']}),_0x3cc5e7%_0x1fe810==0x0&&(_0x1199d1[_0x198556]=_0x393bdd,_0x198556++);}),tgBot[_0x309b9f(0x232)](_0x3dea24[_0x309b9f(0xe7)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x1199d1}})['catch'](_0x4d6f1e=>{telegramError(_0x4d6f1e);}),tgBot['on'](_0x309b9f(0x224),async _0x5ebfb5=>{const _0x46e8d0=_0x309b9f,_0x36bf08=_0x5ebfb5[_0x46e8d0(0x15e)],_0x53ea1e=_0x5ebfb5[_0x46e8d0(0x1f0)];tgBot['answerCallbackQuery'](_0x5ebfb5['id'])['then'](async()=>{const _0x552f9c=_0x46e8d0;_0x36bf08=='all'?(tgBot[_0x552f9c(0x232)](_0x53ea1e[_0x552f9c(0xe7)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x552f9c(0x25f)](_0x4168b7=>{telegramError(_0x4168b7);}),_0x50c046[_0x552f9c(0x26c)](_0x5a3fad=>{const _0x43df28=_0x552f9c;if(_0x5a3fad[_0x43df28(0x146)]!=_0x43df28(0x28b))toggleBot(_0x5a3fad['botID'],toggleStatus(_0x5a3fad[_0x43df28(0x146)]),_0x43df28(0x287));})):(tgBot[_0x552f9c(0x232)](_0x53ea1e[_0x552f9c(0xe7)]['id'],_0x552f9c(0xf2)+_0x36bf08)['catch'](_0x4b8645=>{telegramError(_0x4b8645);}),toggleBot(_0x36bf08,toggleStatus(_0x36bf08),'stopped'));}),tgBot['removeListener'](_0x46e8d0(0x224));});}}),tgBot[_0x20cf69(0x169)](/\/metrics/,_0x1a1e9e=>{const _0x4717fd=_0x20cf69;if(!validateTelegram(_0x1a1e9e))return;tgBot[_0x4717fd(0xdd)](_0x4717fd(0x224));const _0x239ffe=getEnabledBots();if(_0x239ffe[_0x4717fd(0x18f)]==0x0)tgBot[_0x4717fd(0x232)](_0x1a1e9e[_0x4717fd(0xe7)]['id'],_0x4717fd(0x1f3))[_0x4717fd(0x25f)](_0x2fadec=>{telegramError(_0x2fadec);});else{if(_0x239ffe[_0x4717fd(0x18f)]>0x1){let _0x4bd428=[],_0x41078b=[];const _0x12cf40=_0x239ffe[_0x4717fd(0x18f)]%0x4==0x0||_0x239ffe['length']%0x4==0x3||_0x239ffe['length']%0x3==0x1?0x4:0x3;let _0x9c03e=0x0;_0x239ffe[_0x4717fd(0x26c)]((_0x2b2564,_0x4b8f66)=>{const _0x133bca=_0x4717fd;if(_0x4b8f66%_0x12cf40==0x0)_0x41078b=[];_0x41078b[_0x133bca(0x1b3)]({'text':'Bot\x20'+_0x2b2564[_0x133bca(0x146)],'callback_data':_0x2b2564[_0x133bca(0x146)]}),_0x4b8f66%_0x12cf40==0x0&&(_0x4bd428[_0x9c03e]=_0x41078b,_0x9c03e++);}),tgBot[_0x4717fd(0x232)](_0x1a1e9e['chat']['id'],_0x4717fd(0x1ee),{'reply_markup':{'inline_keyboard':_0x4bd428}})[_0x4717fd(0x25f)](_0x9dad0d=>{telegramError(_0x9dad0d);}),tgBot['on'](_0x4717fd(0x224),async _0x2e2892=>{const _0x13ea26=_0x4717fd,_0x289eac=_0x2e2892[_0x13ea26(0x15e)],_0x6ac643=_0x2e2892[_0x13ea26(0x1f0)];tgBot[_0x13ea26(0x159)](_0x2e2892['id'])[_0x13ea26(0x117)](async()=>{const _0x15a3db=_0x13ea26;if(pid[_0x289eac])pid[_0x289eac][_0x15a3db(0x1b9)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x13ea26(0xdd)](_0x13ea26(0x224));});}else{const _0x195a9a=_0x239ffe[0x0]['botID'];if(pid[_0x195a9a])pid[_0x195a9a][_0x4717fd(0x1b9)]({'function':_0x4717fd(0x19d),'args':null});}}}),tgBot[_0x20cf69(0x169)](/\/portfolio/,_0x4fca2c=>{const _0x276e02=_0x20cf69;if(!validateTelegram(_0x4fca2c))return;tgBot[_0x276e02(0xdd)](_0x276e02(0x224));const _0x59d597=getEnabledBots();if(_0x59d597[_0x276e02(0x18f)]==0x0)tgBot[_0x276e02(0x232)](_0x4fca2c['chat']['id'],_0x276e02(0x1f3))['catch'](_0x2c8002=>{telegramError(_0x2c8002);});else{if(_0x59d597['length']>0x1){let _0x3e5599=[],_0x979231=[];const _0x5cfd6e=_0x59d597['length']%0x4==0x0||_0x59d597['length']%0x4==0x3||_0x59d597[_0x276e02(0x18f)]%0x3==0x1?0x4:0x3;let _0x4c7d0a=0x0;_0x59d597[_0x276e02(0x26c)]((_0x48efce,_0x4157af)=>{const _0x4837b3=_0x276e02;if(_0x4157af%_0x5cfd6e==0x0)_0x979231=[];_0x979231[_0x4837b3(0x1b3)]({'text':_0x4837b3(0x220)+_0x48efce['botID'],'callback_data':_0x48efce[_0x4837b3(0x146)]}),_0x4157af%_0x5cfd6e==0x0&&(_0x3e5599[_0x4c7d0a]=_0x979231,_0x4c7d0a++);}),tgBot['sendMessage'](_0x4fca2c['chat']['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',{'reply_markup':{'inline_keyboard':_0x3e5599}})[_0x276e02(0x25f)](_0x59f5fd=>{telegramError(_0x59f5fd);}),tgBot['on'](_0x276e02(0x224),async _0xdb8a13=>{const _0x2b48bd=_0x276e02,_0x8f6396=_0xdb8a13[_0x2b48bd(0x15e)],_0x3f84ea=_0xdb8a13[_0x2b48bd(0x1f0)];tgBot['answerCallbackQuery'](_0xdb8a13['id'])[_0x2b48bd(0x117)](async()=>{if(pid[_0x8f6396])pid[_0x8f6396]['send']({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x2b48bd(0xdd)]('callback_query');});}else{const _0x498906=_0x59d597[0x0][_0x276e02(0x146)];if(pid[_0x498906])pid[_0x498906][_0x276e02(0x1b9)]({'function':_0x276e02(0x18a),'args':null});}}}),tgBot[_0x20cf69(0x169)](/\/update/,async _0x3d9f8b=>{const _0x3f2df8=_0x20cf69;if(!validateTelegram(_0x3d9f8b))return;tgBot[_0x3f2df8(0xdd)](_0x3f2df8(0x224)),await getMessages();if(!updateAvailable)tgBot[_0x3f2df8(0x232)](_0x3d9f8b['chat']['id'],_0x3f2df8(0x178))[_0x3f2df8(0x25f)](_0x99b5f3=>{telegramError(_0x99b5f3);});else!validInstallation?tgBot[_0x3f2df8(0x232)](_0x3d9f8b[_0x3f2df8(0xe7)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update')[_0x3f2df8(0x25f)](_0xeb93d8=>{telegramError(_0xeb93d8);}):(tgBot[_0x3f2df8(0x232)](_0x3d9f8b['chat']['id'],_0x3f2df8(0x152),{'reply_markup':{'inline_keyboard':[[{'text':_0x3f2df8(0xb9),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x3f2df8(0x25f)](_0x3a39ac=>{telegramError(_0x3a39ac);}),tgBot['on'](_0x3f2df8(0x224),async _0xb0826b=>{const _0x49a7eb=_0x3f2df8,_0x6443d0=_0xb0826b['data'],_0xafa074=_0xb0826b[_0x49a7eb(0x1f0)];tgBot[_0x49a7eb(0x159)](_0xb0826b['id'])[_0x49a7eb(0x117)](async()=>{const _0x5a30be=_0x49a7eb;_0x6443d0==_0x5a30be(0x132)&&(await tgBot[_0x5a30be(0x232)](_0xafa074[_0x5a30be(0xe7)]['id'],_0x5a30be(0x1ad))[_0x5a30be(0x25f)](_0x39720a=>{telegramError(_0x39720a);}),updateBB(_0x5a30be(0x1ab))),_0x6443d0=='no'&&await tgBot[_0x5a30be(0x232)](_0xafa074[_0x5a30be(0xe7)]['id'],_0x5a30be(0x14b))[_0x5a30be(0x25f)](_0x1842c6=>{telegramError(_0x1842c6);});}),tgBot[_0x49a7eb(0xdd)]('callback_query');}));}),tgBot[_0x20cf69(0x169)](/\/reinstall/,async _0x38300d=>{const _0x32d9cb=_0x20cf69;if(!validateTelegram(_0x38300d))return;tgBot[_0x32d9cb(0xdd)](_0x32d9cb(0x224)),!validInstallation?tgBot[_0x32d9cb(0x232)](_0x38300d[_0x32d9cb(0xe7)]['id'],_0x32d9cb(0x17f))[_0x32d9cb(0x25f)](_0x123a37=>{telegramError(_0x123a37);}):(tgBot['sendMessage'](_0x38300d['chat']['id'],_0x32d9cb(0x13c),{'reply_markup':{'inline_keyboard':[[{'text':_0x32d9cb(0xb9),'callback_data':_0x32d9cb(0x132)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x5cc88f=>{telegramError(_0x5cc88f);}),tgBot['on']('callback_query',async _0x2dad0c=>{const _0x23c046=_0x32d9cb,_0x4a1ae2=_0x2dad0c['data'],_0x37b2ca=_0x2dad0c['message'];tgBot[_0x23c046(0x159)](_0x2dad0c['id'])[_0x23c046(0x117)](async()=>{const _0x1729a6=_0x23c046;_0x4a1ae2==_0x1729a6(0x132)&&(await tgBot[_0x1729a6(0x232)](_0x37b2ca['chat']['id'],'Starting\x20Balance\x20Bot\x20reinstallation')['catch'](_0x5cc1de=>{telegramError(_0x5cc1de);}),updateBB('reinstall')),_0x4a1ae2=='no'&&await tgBot['sendMessage'](_0x37b2ca[_0x1729a6(0xe7)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled')[_0x1729a6(0x25f)](_0x5d649f=>{telegramError(_0x5d649f);});}),tgBot[_0x23c046(0xdd)](_0x23c046(0x224));}));}),tgBot[_0x20cf69(0x169)](/\/toggle/,_0x5002d9=>{const _0x479fb1=_0x20cf69;if(!validateTelegram(_0x5002d9))return;tgBot[_0x479fb1(0xdd)](_0x479fb1(0x224));const _0x1c4008=getBotsWithMode();if(_0x1c4008['length']==0x0)tgBot['sendMessage'](_0x5002d9[_0x479fb1(0xe7)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x4c43f9=>{telegramError(_0x4c43f9);});else{let _0xac22a2=[],_0x4a9a3d=[];const _0x4fbdc3=0x2;let _0xe8e08b=0x0;_0x1c4008[_0x479fb1(0x26c)]((_0x580b3a,_0x5304ab)=>{const _0x45edf8=_0x479fb1;if(_0x5304ab%_0x4fbdc3==0x0)_0x4a9a3d=[];_0x4a9a3d[_0x45edf8(0x1b3)]({'text':'Bot\x20'+_0x580b3a[_0x45edf8(0x146)]+'\x20('+_0x580b3a[_0x45edf8(0x139)]+')','callback_data':_0x580b3a[_0x45edf8(0x146)]}),_0x5304ab%_0x4fbdc3==0x0&&(_0xac22a2[_0xe8e08b]=_0x4a9a3d,_0xe8e08b++);}),tgBot['sendMessage'](_0x5002d9['chat']['id'],_0x479fb1(0x227),{'reply_markup':{'inline_keyboard':_0xac22a2}})[_0x479fb1(0x25f)](_0x122b30=>{telegramError(_0x122b30);}),tgBot['on'](_0x479fb1(0x224),async _0x1e31ea=>{const _0x4083ed=_0x479fb1,_0x4d6197=_0x1e31ea[_0x4083ed(0x15e)],_0x11ca4a=_0x1e31ea[_0x4083ed(0x1f0)];tgBot[_0x4083ed(0x159)](_0x1e31ea['id'])['then'](async()=>{const _0xaafdc7=_0x4083ed,_0x1825d1=_0x1c4008[_0xaafdc7(0x20f)](_0x2554b7=>_0x2554b7['botID']==_0x4d6197),_0x67696=_0x1825d1[_0xaafdc7(0x139)]==_0xaafdc7(0x1de)?_0xaafdc7(0x1dc):'auto';tgBot['sendMessage'](_0x11ca4a[_0xaafdc7(0xe7)]['id'],_0xaafdc7(0x286)+_0x4d6197+_0xaafdc7(0x175)+_0x67696+'\x20mode')[_0xaafdc7(0x25f)](_0xab435a=>{telegramError(_0xab435a);}),toggleBotMode(_0x4d6197);}),tgBot[_0x4083ed(0xdd)](_0x4083ed(0x224));});}}),tgBot[_0x20cf69(0x169)](/\/names/,_0x680e9=>{const _0x101722=_0x20cf69;if(!validateTelegram(_0x680e9))return;let _0x48e066='';config[_0x101722(0x26c)](_0x546764=>{const _0x340f29=_0x101722;_0x48e066+='Bot\x20'+_0x546764['botID']+':\x20'+_0x546764[_0x340f29(0x1a6)]+'\x0a';}),tgBot[_0x101722(0x232)](_0x680e9['chat']['id'],_0x48e066,{'parse_mode':_0x101722(0x107)})[_0x101722(0x25f)](_0x116dfc=>{telegramError(_0x116dfc);});}),tgBot[_0x20cf69(0x169)](/\/disable/,_0x34e3e5=>{const _0x3e2cbb=_0x20cf69;if(!validateTelegram(_0x34e3e5))return;tgBot['sendMessage'](_0x34e3e5[_0x3e2cbb(0xe7)]['id'],_0x3e2cbb(0x11a))[_0x3e2cbb(0x25f)](_0x41124e=>{telegramError(_0x41124e);}),updateSetting(_0x3e2cbb(0x256),![]);}),tgBot[_0x20cf69(0x169)](/\/help/,_0x21f152=>{const _0x16c0a7=_0x20cf69;if(!validateTelegram(_0x21f152))return;tgBot[_0x16c0a7(0x232)](_0x21f152[_0x16c0a7(0xe7)]['id'],_0x313b97)[_0x16c0a7(0x25f)](_0x4d94c8=>{telegramError(_0x4d94c8);});}),tgBot['on'](_0x20cf69(0x1ef),_0x2d065d=>{const _0x553a1d=_0x20cf69;_0x2d065d['toString']()[_0x553a1d(0x274)](_0x553a1d(0x22a))&&(logger['full'](_0x553a1d(0xbc)),tgBot[_0x553a1d(0x110)](),tgBot=null,io['to'](_0x553a1d(0x268))[_0x553a1d(0x127)]('notification',_0x553a1d(0xbc)));}),process['once'](_0x20cf69(0x223),()=>{const _0xad475=_0x20cf69;if(tgBot)tgBot[_0xad475(0x110)]();process[_0xad475(0x11e)](0x1);}),process[_0x20cf69(0x174)](_0x20cf69(0xd7),()=>{const _0x8a3677=_0x20cf69;if(tgBot)tgBot['stopPolling']();process[_0x8a3677(0x11e)](0x1);});}}function disableTelegram(){const _0x21e916=_0x59a09a;tgBot&&(tgBot[_0x21e916(0x110)](),tgBot=null);}function sendTelegram(_0x3a917c,_0x136939){const _0x34122d=_0x59a09a;if(settings[_0x34122d(0x256)]){if(settings['telegramEvents']==_0x34122d(0x28b)||(_0x136939[_0x34122d(0x168)]=='error'||_0x136939['type']=='warning'||_0x136939[_0x34122d(0x168)]==_0x34122d(0x121))&&settings[_0x34122d(0x1a9)]==_0x34122d(0x1ff)||_0x136939['type']==_0x34122d(0x112)&&settings[_0x34122d(0x1a9)]==_0x34122d(0x143)){if(tgBot&&settings[_0x34122d(0x103)]){if(_0x136939['showname'])tgBot['sendMessage'](settings[_0x34122d(0x103)],_0x136939[_0x34122d(0x1a6)]+_0x34122d(0x15c)+_0x136939[_0x34122d(0x16f)])[_0x34122d(0x25f)](_0x459f3f=>{telegramError(_0x459f3f);});else tgBot[_0x34122d(0x232)](settings[_0x34122d(0x103)],'Bot\x20'+_0x3a917c+_0x34122d(0x15c)+_0x136939[_0x34122d(0x16f)])['catch'](_0x14b1a1=>{telegramError(_0x14b1a1);});}}}}async function sendTelegramMsg(_0x31cf05,_0xe85a04=_0x59a09a(0x107)){const _0x19cff6=_0x59a09a;return settings[_0x19cff6(0x256)]&&tgBot&&settings[_0x19cff6(0x103)]?(await tgBot[_0x19cff6(0x232)](settings[_0x19cff6(0x103)],_0x31cf05,{'parse_mode':_0xe85a04})[_0x19cff6(0x25f)](_0x386449=>{telegramError(_0x386449);}),!![]):![];}function getDeviceWithIp(_0x52d180){const _0x576509=_0x59a09a;return devices[_0x576509(0x20f)](_0x3e93cd=>_0x3e93cd['ip']===_0x52d180);}function temporaryAccess2FA(_0x1e0f4b,_0x426f09){const _0x51ba96=_0x59a09a;let _0x34cbde=new Date(),_0x29fced=![];if(lastIpApproval){if(_0x34cbde-lastIpApproval<0x1388)_0x29fced=!![];}lastIpApproval=new Date();if(_0x29fced)return;tgBot&&settings['telegramChatId']&&(tgBot['removeListener'](_0x51ba96(0x224)),tgBot[_0x51ba96(0x232)](settings['telegramChatId'],_0x51ba96(0x1ca)+normalizeIP(_0x426f09)['show']+_0x51ba96(0x179),{'parse_mode':_0x51ba96(0x107),'reply_markup':{'inline_keyboard':[[{'text':_0x51ba96(0xe8),'callback_data':'5'},{'text':_0x51ba96(0x17e),'callback_data':'15'},{'text':_0x51ba96(0x23e),'callback_data':'30'},{'text':_0x51ba96(0x19e),'callback_data':_0x51ba96(0x19e)}]]}})[_0x51ba96(0x25f)](_0xa61919=>{telegramError(_0xa61919);}),tgBot['on']('callback_query',async _0x4f8682=>{const _0x4f8849=_0x51ba96,_0x523054=_0x4f8682[_0x4f8849(0x15e)],_0x5082a5=_0x4f8682[_0x4f8849(0x1f0)];tgBot[_0x4f8849(0x159)](_0x4f8682['id'])[_0x4f8849(0x117)](async()=>{const _0x5f5f4=_0x4f8849;devices[_0x1e0f4b][_0x5f5f4(0x1d9)]={'clientip':_0x426f09,'timestamp':new Date()[_0x5f5f4(0x231)](),'expiry':_0x523054},_0x523054!=_0x5f5f4(0x19e)?(await tgBot['sendMessage'](_0x5082a5['chat']['id'],'Access\x20enabled\x20for\x20'+_0x523054+_0x5f5f4(0x20d),{'parse_mode':'HTML'})[_0x5f5f4(0x25f)](_0x5ae07c=>{telegramError(_0x5ae07c);}),io['to'](_0x1e0f4b)[_0x5f5f4(0x127)]('status',{'access':{'allow':![],'reason':_0x5f5f4(0x167),'token':null}})):(await tgBot['sendMessage'](_0x5082a5[_0x5f5f4(0xe7)]['id'],_0x5f5f4(0x135))[_0x5f5f4(0x25f)](_0x3c4768=>{telegramError(_0x3c4768);}),io['to'](_0x1e0f4b)['emit'](_0x5f5f4(0xbe),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x4f8849(0xdd)](_0x4f8849(0x224));}));}function loginAccess2FA(_0xf85566,_0x9eb9a){const _0x470552=_0x59a09a;tgBot&&settings[_0x470552(0x103)]&&(tgBot['removeListener'](_0x470552(0x224)),tgBot[_0x470552(0x232)](settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x9eb9a)[_0x470552(0x138)]+'</b>\x20?',{'parse_mode':_0x470552(0x107),'reply_markup':{'inline_keyboard':[[{'text':_0x470552(0x1c0),'callback_data':loginExpiry},{'text':_0x470552(0x19e),'callback_data':_0x470552(0x19e)}]]}})[_0x470552(0x25f)](_0x4bcaaf=>{telegramError(_0x4bcaaf);}),tgBot['on'](_0x470552(0x224),async _0x33720d=>{const _0xb865fa=_0x470552,_0x252b30=_0x33720d[_0xb865fa(0x15e)],_0x15f167=_0x33720d[_0xb865fa(0x1f0)];tgBot[_0xb865fa(0x159)](_0x33720d['id'])['then'](async()=>{const _0x4c599c=_0xb865fa;devices[_0xf85566][_0x4c599c(0x26b)]={'clientip':_0x9eb9a,'timestamp':new Date()[_0x4c599c(0x231)](),'expiry':_0x252b30},_0x252b30!='reject'?(await tgBot[_0x4c599c(0x232)](_0x15f167[_0x4c599c(0xe7)]['id'],'Login\x20accepted',{'parse_mode':_0x4c599c(0x107)})[_0x4c599c(0x25f)](_0x498ca9=>{telegramError(_0x498ca9);}),io['to'](_0xf85566)[_0x4c599c(0x127)](_0x4c599c(0xbe),{'access':{'allow':![],'reason':_0x4c599c(0x167),'token':null}})):(await tgBot[_0x4c599c(0x232)](_0x15f167[_0x4c599c(0xe7)]['id'],_0x4c599c(0xb7))[_0x4c599c(0x25f)](_0x382c7f=>{telegramError(_0x382c7f);}),io['to'](_0xf85566)[_0x4c599c(0x127)](_0x4c599c(0xbe),{'access':{'allow':![],'reason':_0x4c599c(0x196),'token':null}}));}),tgBot[_0xb865fa(0xdd)](_0xb865fa(0x224));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0xd0fc02=_0x59a09a;return dbConfig[_0xd0fc02(0x156)](_0xd0fc02(0x215))['sortBy'](_0xd0fc02(0x146))['filter']({'status':_0xd0fc02(0xf8)})[_0xd0fc02(0x183)]()||[];}function getDisabledBots(){const _0x2652a0=_0x59a09a;return dbConfig[_0x2652a0(0x156)](_0x2652a0(0x215))['sortBy'](_0x2652a0(0x146))[_0x2652a0(0x1d5)]({'status':'disabled'})[_0x2652a0(0x183)]()||[];}function getBotAttributes(_0x37f368){const _0x352cd9=_0x59a09a;let _0x570577={};const _0x3d50c0=configpath+_0x352cd9(0x208)+_0x37f368+_0x352cd9(0x1c2),_0x29b1b7=fs[_0x352cd9(0x136)](_0x3d50c0);if(_0x29b1b7){const _0x445d0d=fs['readFileSync'](_0x3d50c0);try{const _0x2b182b=JSON[_0x352cd9(0xda)](_0x445d0d),_0x1d264e=_0x2b182b?_0x2b182b[_0x352cd9(0x181)][0x0][_0x352cd9(0x1cc)]:![];_0x570577[_0x352cd9(0x139)]=_0x1d264e?_0x352cd9(0x1de):_0x352cd9(0x1dc),_0x570577['botname']=_0x2b182b?_0x2b182b[_0x352cd9(0x181)][0x0]['botname']:'Bot\x20'+_0x37f368;}catch(_0x14ce23){_0x570577[_0x352cd9(0x139)]='manual',_0x570577['botname']=_0x352cd9(0x220)+_0x37f368;}}else _0x570577[_0x352cd9(0x139)]='manual',_0x570577[_0x352cd9(0x1a6)]='Bot\x20'+_0x37f368;return _0x570577;}function getBotsWithMode(){const _0x4b004b=_0x59a09a,_0x3e19a2=dbConfig[_0x4b004b(0x156)](_0x4b004b(0x215))['sortBy']('botID')['value']()||[];return _0x3e19a2['forEach'](_0x29d662=>{const _0x38bf75=_0x4b004b;let _0x5b17cb=getBotAttributes(_0x29d662[_0x38bf75(0x146)]);_0x29d662[_0x38bf75(0x139)]=_0x5b17cb[_0x38bf75(0x139)];}),_0x3e19a2;}function getBotExchanges(){const _0xe2d351=_0x59a09a;let _0x3820ba=[];const _0x438bb4=dbConfig[_0xe2d351(0x156)](_0xe2d351(0x215))[_0xe2d351(0x259)](_0xe2d351(0x146))[_0xe2d351(0x183)]()||[];_0x438bb4['forEach'](_0x2b41ad=>{const _0x14dfe9=_0xe2d351;if(_0x2b41ad[_0x14dfe9(0xbe)]==_0x14dfe9(0xf8)){const _0x115c39=configpath+'bot-'+_0x2b41ad['botID']+_0x14dfe9(0x1c2),_0x2a203f=fs[_0x14dfe9(0x136)](_0x115c39);let _0x3f633f;if(_0x2a203f){const _0x3aedf4=fs[_0x14dfe9(0x230)](_0x115c39);try{const _0x18d1b9=JSON['parse'](_0x3aedf4);_0x3f633f=_0x18d1b9?_0x18d1b9[_0x14dfe9(0x181)][0x0]['exchange']:null;}catch(_0x464458){}}if(_0x3f633f)_0x3820ba[_0x14dfe9(0x1b3)](_0x3f633f);}});const _0x5318d0=[...new Set(_0x3820ba)][_0xe2d351(0x197)]();return _0x5318d0;}async function initUser(){const _0x121dec=_0x59a09a;if(!settings[_0x121dec(0xe6)]){const _0x3fd564=uuidRandom();mixpanel[_0x121dec(0x100)](_0x3fd564),updateSetting('userid',_0x3fd564);}}async function initSecure(){const _0x444ca0=_0x59a09a;let _0x5337d7=getSecure();if(!_0x5337d7[_0x444ca0(0x25d)](_0x444ca0(0x119))){let _0xbdc92e=await generateKeys();_0x5337d7['publicKey']=_0xbdc92e[_0x444ca0(0x14f)],_0x5337d7['privateKey']=_0xbdc92e[_0x444ca0(0x128)],_0x5337d7[_0x444ca0(0x119)]=crypto[_0x444ca0(0x23d)](0x20)[_0x444ca0(0x16c)]('hex');;storeSecure(_0x5337d7);}}function getSettings(){const _0x15d5b7=_0x59a09a;return dbSettings[_0x15d5b7(0x156)](_0x15d5b7(0x16d))['value']()||{};}function getSecure(){const _0x1ed03f=_0x59a09a;return dbSecure[_0x1ed03f(0x156)]('secure')[_0x1ed03f(0x183)]()||{};}function getBlacklist(){const _0x48c1bf=_0x59a09a;return dbSecure[_0x48c1bf(0x156)](_0x48c1bf(0x125))[_0x48c1bf(0x183)]()||[];}function broadcastToBots(_0x1f4bd9,_0x2751ce){const _0x425af5=_0x59a09a;config[_0x425af5(0x26c)](_0x3ac382=>{const _0x317fe8=_0x425af5;if(_0x3ac382[_0x317fe8(0xbe)]==_0x317fe8(0xf8)&&_0x3ac382[_0x317fe8(0x130)]=='running'||_0x3ac382[_0x317fe8(0xbe)]=='new'&&_0x3ac382[_0x317fe8(0x130)]=='running'){if(pid[_0x3ac382[_0x317fe8(0x146)]])pid[_0x3ac382[_0x317fe8(0x146)]][_0x317fe8(0x1b9)]({[_0x1f4bd9]:_0x2751ce});}});}function storeSettings(_0x344c8a,_0x5631e6=![]){const _0x245062=_0x59a09a;_0x344c8a={...settings,..._0x344c8a};if(_0x5631e6&&_0x344c8a['bbPassword']!=_0x245062(0x23f)&&_0x344c8a['bbPassword']!=_0x245062(0x21f)&&_0x344c8a['bbPassword']!=''){const _0x5cb6c9=crypt['decrypt'](secure[_0x245062(0x128)],_0x344c8a[_0x245062(0x157)])['message']['split']('@')[0x0],_0xf6dff5=bcrypt[_0x245062(0xd2)](_0x5cb6c9,saltRounds);_0x344c8a={..._0x344c8a,'bbPassword':_0xf6dff5};}if(_0x5631e6&&_0x344c8a[_0x245062(0x1ae)]!=_0x245062(0x23f)&&_0x344c8a[_0x245062(0x1ae)]!='***'&&_0x344c8a['telegramToken']!=''){const _0x5ed444=crypt[_0x245062(0x272)](secure[_0x245062(0x128)],_0x344c8a[_0x245062(0x1ae)])['message']['split']('@')[0x0];_0x344c8a={..._0x344c8a,'telegramToken':_0x5ed444};}const _0x109093=_0x344c8a[_0x245062(0x1ae)]!=_0x245062(0x23f)&&_0x344c8a[_0x245062(0x1ae)]!=settings['telegramToken']||_0x344c8a[_0x245062(0x267)]!=settings[_0x245062(0x267)],_0x57f106=_0x344c8a['telegramToken']==''||_0x344c8a['telegramUsername']=='';if(_0x109093)_0x344c8a[_0x245062(0x1a9)]=_0x245062(0x28b);for(const [_0x203ccf,_0xffc90e]of Object[_0x245062(0x243)](_0x344c8a)){if(_0x203ccf==_0x245062(0x1ae)&&_0xffc90e==_0x245062(0x23f)){_0x344c8a[_0x245062(0x1ae)]=settings[_0x245062(0x1ae)];continue;};if(_0x203ccf==_0x245062(0x157)&&_0xffc90e==_0x245062(0x23f)){_0x344c8a[_0x245062(0x157)]=settings[_0x245062(0x157)];continue;};dbSettings[_0x245062(0x1af)]('settings.'+_0x203ccf,_0xffc90e)[_0x245062(0x140)]();}settings=_0x344c8a,io['to'](_0x245062(0x268))[_0x245062(0x127)](_0x245062(0x16d),cleanSettings()),broadcastToBots('timeshift',settings[_0x245062(0x27f)]),broadcastToBots(_0x245062(0x1f7),settings['onepagemode']);if(_0x109093&&!_0x57f106)initTelegram();if(_0x109093&&_0x57f106)disableTelegram();getAllClients()[_0x245062(0x26c)](_0x40867a=>{const _0x5ccdc0=_0x245062;getSocket(_0x40867a['id'])['emit'](_0x5ccdc0(0xbe),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x4d91e6,_0x295bde){const _0x390aa1=_0x59a09a;dbSettings[_0x390aa1(0x1af)](_0x390aa1(0x219)+_0x4d91e6,_0x295bde)[_0x390aa1(0x140)](),settings=getSettings(),io['to'](_0x390aa1(0x268))['emit']('settings',cleanSettings());}function storeSecure(_0x3d677c){const _0x3c8d4b=_0x59a09a;dbSecure[_0x3c8d4b(0x156)](_0x3c8d4b(0x239))[_0x3c8d4b(0x1b3)](_0x3d677c)[_0x3c8d4b(0x140)](),secure=_0x3d677c;}function addBlacklist(_0x1a11a7){const _0x42f638=_0x59a09a;cleanBlacklist();let _0x2377d7;devices[_0x1a11a7]['telegramIpApproval']?_0x2377d7=Math[_0x42f638(0xbf)](devices[_0x1a11a7][_0x42f638(0x1d9)][_0x42f638(0x15f)],loginExpiry):_0x2377d7=loginExpiry,dbSecure[_0x42f638(0x156)]('blacklist')[_0x42f638(0x1b3)]({'expiry':new Date()['getTime']()+_0x2377d7*0x3c*0x3e8,'token':devices[_0x1a11a7][_0x42f638(0x195)][_0x42f638(0x1f8)]})['write'](),blacklist=dbSecure[_0x42f638(0x156)]('blacklist')[_0x42f638(0x183)]();}function cleanBlacklist(){const _0x2ccd45=_0x59a09a;let _0x1c4b72=dbSecure[_0x2ccd45(0x156)](_0x2ccd45(0x125))[_0x2ccd45(0x161)]()[_0x2ccd45(0x183)](),_0x54e6f4=new Date()['getTime']();_0x1c4b72[_0x2ccd45(0x26c)](_0x361884=>{const _0x5e51a3=_0x2ccd45;_0x361884[_0x5e51a3(0x15f)]<_0x54e6f4&&dbSecure[_0x5e51a3(0x156)](_0x5e51a3(0x125))[_0x5e51a3(0x193)]({'expiry':_0x361884[_0x5e51a3(0x15f)]})[_0x5e51a3(0x140)]();});}function initStates(){let _0x54bfd6=getConfiguration();_0x54bfd6['forEach'](_0x50f85b=>{const _0xde8085=_0x4737;_0x50f85b[_0xde8085(0x130)]=_0xde8085(0x287);}),storeConfiguration(_0x54bfd6);}function onKeys(){const _0x3c6731=new RSA();return new Promise(_0x49026=>{const _0x421fbd=_0x4737;_0x3c6731[_0x421fbd(0x19f)]()[_0x421fbd(0x117)](_0x28fc59=>{_0x49026(_0x28fc59);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x59fe67=_0x59a09a;let _0x5b0458=getSettings(),_0x486a27=![];!_0x5b0458[_0x59fe67(0x25d)](_0x59fe67(0x205))&&(_0x5b0458[_0x59fe67(0x205)]=0x0,_0x486a27=!![]);!_0x5b0458[_0x59fe67(0x25d)](_0x59fe67(0x184))&&(_0x5b0458[_0x59fe67(0x184)]=0x0,_0x486a27=!![]);!_0x5b0458['hasOwnProperty'](_0x59fe67(0x12c))&&(_0x5b0458['latestversion']=_0x59fe67(0x1c4),_0x486a27=!![]);!_0x5b0458[_0x59fe67(0x25d)](_0x59fe67(0x1f7))&&(_0x5b0458[_0x59fe67(0x1f7)]=![],_0x486a27=!![]);if(_0x486a27)storeSettings(_0x5b0458);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x2ce051=>{const _0x140674=_0x59fe67;if(!_0x2ce051[_0x140674(0x234)]()){if(!_0x2ce051[_0x140674(0x124)][_0x140674(0x1c5)](_0x140674(0x198)))fs[_0x140674(0x1fa)](configbackuppath+_0x2ce051[_0x140674(0x124)]);}else fs[_0x140674(0x111)](configbackuppath+_0x2ce051[_0x140674(0x124)],{'recursive':!![]});});}catch(_0x1a8ccd){logger[_0x59fe67(0x10e)](_0x59fe67(0x1ac),_0x1a8ccd);}}function storeConfiguration(_0x3cb2cd){const _0x4e1aef=_0x59a09a;dbConfig[_0x4e1aef(0x156)]('bots')['remove']()['write'](),_0x3cb2cd['forEach'](_0x25c531=>{const _0x3e556d=_0x4e1aef;delete _0x25c531[_0x3e556d(0x139)];}),dbConfig[_0x4e1aef(0x156)](_0x4e1aef(0x215))['push'](..._0x3cb2cd)[_0x4e1aef(0x140)](),config=_0x3cb2cd;}function resetPassword(){const _0x5940ba=_0x59a09a;tgBot&&settings['telegramChatId']&&(tgBot[_0x5940ba(0xdd)](_0x5940ba(0x224)),tgBot[_0x5940ba(0x232)](settings['telegramChatId'],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x5940ba(0x107),'reply_markup':{'inline_keyboard':[[{'text':_0x5940ba(0x132),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x5940ba(0x25f)](_0x46fdc6=>{telegramError(_0x46fdc6);}),tgBot['on'](_0x5940ba(0x224),async _0x23deba=>{const _0x3d871b=_0x5940ba,_0x37eee2=_0x23deba[_0x3d871b(0x15e)],_0x19de46=_0x23deba[_0x3d871b(0x1f0)];tgBot[_0x3d871b(0x159)](_0x23deba['id'])[_0x3d871b(0x117)](async()=>{const _0x429f0f=_0x3d871b;if(_0x37eee2!='no'){const _0x46ddc7=0xf,_0x1057d7=_0x429f0f(0x1d1),_0x2bb489=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x46ddc7)))[_0x429f0f(0x1a0)](_0x3d1936=>_0x1057d7[_0x3d1936%_0x1057d7['length']])['join'](''),_0x4c4d48=bcrypt[_0x429f0f(0xd2)](_0x2bb489,saltRounds);storeSettings({'bbPassword':_0x4c4d48}),await tgBot['sendMessage'](_0x19de46[_0x429f0f(0xe7)]['id'],_0x429f0f(0x263)+_0x2bb489,{'parse_mode':_0x429f0f(0x107)})[_0x429f0f(0x25f)](_0x4e21f5=>{telegramError(_0x4e21f5);});}else await tgBot[_0x429f0f(0x232)](_0x19de46['chat']['id'],_0x429f0f(0x13f))['catch'](_0x3d737d=>{telegramError(_0x3d737d);});}),tgBot[_0x3d871b(0xdd)](_0x3d871b(0x224));}));}async function confirmRestore(_0x3148e5,_0x540456){const _0x2a9737=_0x59a09a;io['to'](_0x2a9737(0x268))[_0x2a9737(0x127)](_0x2a9737(0x22e),_0x2a9737(0x277),_0x2a9737(0x121)),tgBot&&settings[_0x2a9737(0x103)]&&(tgBot[_0x2a9737(0xdd)](_0x2a9737(0x224)),await tgBot[_0x2a9737(0x232)](settings[_0x2a9737(0x103)],_0x2a9737(0x1ce),{'parse_mode':_0x2a9737(0x107),'reply_markup':{'inline_keyboard':[[{'text':_0x2a9737(0x132),'callback_data':_0x2a9737(0x132)},{'text':'no','callback_data':'no'}]]}})[_0x2a9737(0x25f)](_0x3f0697=>{telegramError(_0x3f0697);}),tgBot['on'](_0x2a9737(0x224),async _0x4345aa=>{const _0x3a4b47=_0x2a9737,_0x39a12d=_0x4345aa[_0x3a4b47(0x15e)],_0x1a0722=_0x4345aa[_0x3a4b47(0x1f0)];tgBot['answerCallbackQuery'](_0x4345aa['id'])[_0x3a4b47(0x117)](async()=>{const _0x2da32c=_0x3a4b47;_0x39a12d=='yes'?(await tgBot['sendMessage'](_0x1a0722[_0x2da32c(0xe7)]['id'],_0x2da32c(0x1eb),{'parse_mode':'HTML'})[_0x2da32c(0x25f)](_0xa535df=>{telegramError(_0xa535df);}),unzipFile(_0x3148e5,_0x540456)):(logger[_0x2da32c(0x10e)](_0x2da32c(0x25a)),await tgBot['sendMessage'](_0x1a0722[_0x2da32c(0xe7)]['id'],_0x2da32c(0x25a))[_0x2da32c(0x25f)](_0xdd8cbc=>{telegramError(_0xdd8cbc);}));}),tgBot[_0x3a4b47(0xdd)](_0x3a4b47(0x224));}));}function getServerTime(){const _0x4eae31=_0x59a09a,_0x1f3383=new Date();return _0x1f3383[_0x4eae31(0x1f2)]()+'/'+(_0x1f3383[_0x4eae31(0x254)]()+0x1)[_0x4eae31(0x16c)]()[_0x4eae31(0xf4)](0x2,'0')+'/'+_0x1f3383['getDate']()[_0x4eae31(0x16c)]()[_0x4eae31(0xf4)](0x2,'0')+'\x20'+_0x1f3383['getHours']()['toString']()[_0x4eae31(0xf4)](0x2,'0')+':'+_0x1f3383[_0x4eae31(0x269)]()['toString']()['padStart'](0x2,'0')+':'+_0x1f3383['getSeconds']()[_0x4eae31(0x16c)]()[_0x4eae31(0xf4)](0x2,'0');}function getTimeStamp(){const _0x245c57=_0x59a09a,_0x3d1536=shiftedTime();return _0x3d1536[_0x245c57(0x1f2)]()+'/'+(_0x3d1536[_0x245c57(0x254)]()+0x1)[_0x245c57(0x16c)]()[_0x245c57(0xf4)](0x2,'0')+'/'+_0x3d1536[_0x245c57(0xcb)]()[_0x245c57(0x16c)]()['padStart'](0x2,'0')+'\x20'+_0x3d1536[_0x245c57(0x126)]()[_0x245c57(0x16c)]()[_0x245c57(0xf4)](0x2,'0')+':'+_0x3d1536[_0x245c57(0x269)]()[_0x245c57(0x16c)]()['padStart'](0x2,'0')+':'+_0x3d1536['getSeconds']()[_0x245c57(0x16c)]()[_0x245c57(0xf4)](0x2,'0');}function getCleanTimeStamp(){const _0x6dbaf8=_0x59a09a,_0x4ec941=shiftedTime();return _0x4ec941[_0x6dbaf8(0x1f2)]()+(_0x4ec941[_0x6dbaf8(0x254)]()+0x1)[_0x6dbaf8(0x16c)]()[_0x6dbaf8(0xf4)](0x2,'0')+_0x4ec941[_0x6dbaf8(0xcb)]()[_0x6dbaf8(0x16c)]()[_0x6dbaf8(0xf4)](0x2,'0')+'-'+_0x4ec941[_0x6dbaf8(0x126)]()[_0x6dbaf8(0x16c)]()[_0x6dbaf8(0xf4)](0x2,'0')+_0x4ec941[_0x6dbaf8(0x269)]()[_0x6dbaf8(0x16c)]()['padStart'](0x2,'0')+_0x4ec941[_0x6dbaf8(0x11c)]()[_0x6dbaf8(0x16c)]()[_0x6dbaf8(0xf4)](0x2,'0');}function shiftedTime(){const _0x5cb38a=_0x59a09a,_0x27bbed=new Date();let _0x4f5507=_0x27bbed;if(settings[_0x5cb38a(0x27f)]&&settings[_0x5cb38a(0x27f)]!==0x0)_0x4f5507=fns[_0x5cb38a(0x27e)](_0x27bbed,{'hours':settings['timeshift']});return _0x4f5507;}function startScheduler(){const _0x4d259b=_0x59a09a,_0x1d7945=new Date()[_0x4d259b(0x191)](),_0x4662c8=shiftedTime()[_0x4d259b(0x126)]();_0x4662c8==0x4&&backupConfigFiles();_0x4662c8==0x0&&rotateLogFiles();_0x1d7945%0x6==0x0&&triggerAnalytics();_0x1d7945%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x68c2a5){const _0x5f6e97=_0x59a09a;logger[_0x5f6e97(0x10e)]('Restore\x20backup\x20file\x20'+_0x68c2a5);const _0x50b330=getBotsWithMode();_0x50b330[_0x5f6e97(0x18f)]>0x0?confirmRestore(configbackuppath,_0x68c2a5):unzipFile(configbackuppath,_0x68c2a5);}async function getBackupFiles(_0x4aebbe=null){const _0x2e5c6e=_0x59a09a;let _0x56afbb=[],_0x87a5d1=fs[_0x2e5c6e(0x10d)](configbackuppath,{'withFileTypes':!![]});_0x87a5d1[_0x2e5c6e(0x197)]((_0x4bddce,_0x210591)=>_0x4bddce[_0x2e5c6e(0x124)]<_0x210591[_0x2e5c6e(0x124)]?0x1:_0x210591[_0x2e5c6e(0x124)]<_0x4bddce['name']?-0x1:0x0),_0x87a5d1[_0x2e5c6e(0x26c)](_0x16f276=>{const _0x4331c3=_0x2e5c6e;if(!_0x16f276['isDirectory']()&&_0x16f276[_0x4331c3(0x124)]['startsWith']('backup-full@')&&_0x16f276[_0x4331c3(0x124)][_0x4331c3(0x207)](_0x4331c3(0xb8))){const _0x32090b=formatDate(fs[_0x4331c3(0x1a8)](configbackuppath+_0x16f276['name'])[_0x4331c3(0x133)]);_0x56afbb['push']({'name':_0x16f276[_0x4331c3(0x124)],'mtime':_0x32090b});}});if(_0x4aebbe)io['to'](_0x4aebbe)[_0x2e5c6e(0x127)](_0x2e5c6e(0x16e),_0x56afbb);else return _0x56afbb;}async function backupConfigFiles(){const _0xcee125=_0x59a09a;await zipFiles(_0xcee125(0x200));const _0x49ac9f=getCleanTimeStamp();fs[_0xcee125(0xd5)](zippath+_0xcee125(0x1a4),configbackuppath+(_0xcee125(0x198)+_0x49ac9f+'.zip'));let _0x1d2d2f=fs[_0xcee125(0x10d)](configbackuppath,{'withFileTypes':!![]});_0x1d2d2f[_0xcee125(0x197)]((_0x3e5c69,_0x1a6264)=>_0x3e5c69[_0xcee125(0x124)]<_0x1a6264['name']?0x1:_0x1a6264[_0xcee125(0x124)]<_0x3e5c69[_0xcee125(0x124)]?-0x1:0x0),_0x1d2d2f[_0xcee125(0x18f)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x1d2d2f[_0x1d2d2f['length']-0x1]['name']);}function rotateLogFiles(){const _0xb4c8c0=_0x59a09a,_0x324133=fs['statSync'](logspath+_0xb4c8c0(0x10f)),_0x1dcb78=_0x324133[_0xb4c8c0(0x1d8)]/0x400;if(_0x1dcb78>0x64){let _0x111b8e=fs[_0xb4c8c0(0x10d)](logspath,{'withFileTypes':!![]});_0x111b8e[_0xb4c8c0(0x197)]((_0xcac1f0,_0x36f043)=>_0xcac1f0[_0xb4c8c0(0x124)]<_0x36f043[_0xb4c8c0(0x124)]?0x1:_0x36f043[_0xb4c8c0(0x124)]<_0xcac1f0['name']?-0x1:0x0),_0x111b8e[_0xb4c8c0(0x26c)](_0x27fa4a=>{const _0x1808d=_0xb4c8c0;if(_0x27fa4a[_0x1808d(0x124)]==_0x1808d(0xea))fs[_0x1808d(0xd5)](logspath+_0x27fa4a[_0x1808d(0x124)],logspath+_0x1808d(0x18d));if(_0x27fa4a['name']==_0x1808d(0x242))fs['copyFileSync'](logspath+_0x27fa4a['name'],logspath+_0x1808d(0xea));_0x27fa4a[_0x1808d(0x124)]==_0x1808d(0x10f)&&(fs['copyFileSync'](logspath+_0x27fa4a[_0x1808d(0x124)],logspath+_0x1808d(0x242)),fs[_0x1808d(0xc3)](logspath+_0x27fa4a['name'],''));});}}async function zipFiles(_0x20df3c){const _0x49dfdc=_0x59a09a;let _0x210fb6;if(_0x20df3c==_0x49dfdc(0x1b6))_0x210fb6=logspath;if(_0x20df3c==_0x49dfdc(0x123))_0x210fb6=configpath;if(_0x20df3c==_0x49dfdc(0x200))_0x210fb6=configpath;let _0x5db70e=fs[_0x49dfdc(0x10d)](_0x210fb6,{'withFileTypes':!![]});const _0x137ae6=new require('node-zip')();_0x5db70e[_0x49dfdc(0x26c)](_0x5769de=>{const _0xaeaa1d=_0x49dfdc;if(!_0x5769de[_0xaeaa1d(0x234)]()){let _0x10d6b2=fs[_0xaeaa1d(0x230)](_0x210fb6+_0x5769de['name']);if(_0x20df3c=='backup'){const _0x584ae4=/^bot-[0-9]{3}-config.json$/,_0x3a06d6=_0x584ae4[_0xaeaa1d(0x172)](_0x5769de['name']);if(_0x3a06d6){const _0xc85512=JSON[_0xaeaa1d(0xda)](_0x10d6b2);if(_0xc85512[_0xaeaa1d(0x181)][0x0]){_0xc85512[_0xaeaa1d(0x181)][0x0][_0xaeaa1d(0x238)]=_0xaeaa1d(0x21f),_0xc85512[_0xaeaa1d(0x181)][0x0]['apiSecret']=_0xaeaa1d(0x21f);if(_0xc85512[_0xaeaa1d(0x181)][0x0][_0xaeaa1d(0x1e2)])_0xc85512[_0xaeaa1d(0x181)][0x0]['apiPassword']=_0xaeaa1d(0x21f);}_0x10d6b2=JSON['stringify'](_0xc85512,null,0x2);}if(_0x5769de[_0xaeaa1d(0x124)]==_0xaeaa1d(0xfe)){const _0x9680fe=JSON[_0xaeaa1d(0xda)](_0x10d6b2);if(_0x9680fe[_0xaeaa1d(0x16d)][_0xaeaa1d(0xd0)])_0x9680fe[_0xaeaa1d(0x16d)][_0xaeaa1d(0xd0)]=![];if(_0x9680fe[_0xaeaa1d(0x16d)][_0xaeaa1d(0x157)])_0x9680fe[_0xaeaa1d(0x16d)][_0xaeaa1d(0x157)]=_0xaeaa1d(0x21f);if(_0x9680fe['settings'][_0xaeaa1d(0x1ae)])_0x9680fe['settings'][_0xaeaa1d(0x1ae)]='***';if(_0x9680fe['settings'][_0xaeaa1d(0x103)])_0x9680fe[_0xaeaa1d(0x16d)][_0xaeaa1d(0x103)]=null;_0x10d6b2=JSON[_0xaeaa1d(0x210)](_0x9680fe,null,0x2);}if(_0x5769de[_0xaeaa1d(0x124)]!=_0xaeaa1d(0x187))_0x137ae6[_0xaeaa1d(0x1d6)](_0x5769de[_0xaeaa1d(0x124)],_0x10d6b2);}else _0x137ae6['file'](_0x5769de[_0xaeaa1d(0x124)],_0x10d6b2);}});const _0x4d86b4=_0x137ae6['generate']({'base64':![],'compression':_0x49dfdc(0x1c3)});fs[_0x49dfdc(0xc3)](zippath+(_0x20df3c+'.zip'),_0x4d86b4,_0x49dfdc(0xe5));}async function unzipFile(_0x208a04,_0x57b870){const _0x25b69a=_0x59a09a;fs[_0x25b69a(0x10d)](configpath,{'withFileTypes':!![]})['forEach'](_0x4c2779=>{const _0x39fba8=_0x25b69a;if(!_0x4c2779['isDirectory']())fs[_0x39fba8(0x111)](configpath+_0x4c2779[_0x39fba8(0x124)]);});const _0x4fce77=fs[_0x25b69a(0x230)](_0x208a04+_0x57b870,_0x25b69a(0xe5)),_0x1c4bbc=new require(_0x25b69a(0xf9))(_0x4fce77,{'base64':![],'checkCRC32':!![]});Object[_0x25b69a(0x24c)](_0x1c4bbc[_0x25b69a(0x21c)])[_0x25b69a(0x26c)](_0x3e2148=>{const _0x562f30=_0x25b69a,_0x1625d2=_0x1c4bbc[_0x562f30(0x21c)][_0x3e2148];fs[_0x562f30(0xc3)](configpath+_0x1625d2['name'],_0x1625d2[_0x562f30(0x21a)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})['forEach'](_0x5d18da=>{const _0x297752=_0x25b69a;if(!_0x5d18da[_0x297752(0x234)]())fs['rmSync'](temppath+_0x5d18da[_0x297752(0x124)]);}),logger[_0x25b69a(0x10e)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x25b69a(0x1b9)]({'restore':!![]},_0x38a1ec=>{});}async function getPublicIp(){const _0x2e9bf3=_0x59a09a;try{const _0x8efe5a=await axios[_0x2e9bf3(0x156)](_0x2e9bf3(0x102));publicip=_0x8efe5a[_0x2e9bf3(0x15e)]['ip'];}catch(_0x4e44f5){}}async function triggerAnalytics(){const _0x1f57c6=_0x59a09a;if(!publicip)await getPublicIp();const _0x135168=getBotsWithMode();let _0x3e353b=0x0;_0x135168[_0x1f57c6(0x26c)](_0x3c1b4a=>{const _0x513372=_0x1f57c6;if(_0x3c1b4a[_0x513372(0xbe)]===_0x513372(0xf8))_0x3e353b++;});const _0x51b796=getBotExchanges();mixpanel[_0x1f57c6(0x275)]('Server',{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x135168[_0x1f57c6(0x18f)],'numbotsenabled':_0x3e353b,'exchanges':_0x51b796,'environment':environment});}async function getMessages(){const _0x5bff4e=_0x59a09a,_0x2a68a7=_0x5bff4e(0x217),_0x91be62=new GraphQLClient(_0x2a68a7),_0x8820f1={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x50a9e3=serverversion['split']('.'),_0x4aee1a=_0x50a9e3[0x0]+'.'+_0x50a9e3[0x1],_0x471cfd=Math['min'](settings[_0x5bff4e(0x205)],settings[_0x5bff4e(0x184)]),_0x5173f2={'last':parseInt(_0x471cfd),'bbm':_0x4aee1a},_0x473a1e=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x5efcef;try{_0x5efcef=await _0x91be62[_0x5bff4e(0x285)](_0x473a1e,_0x5173f2,_0x8820f1);}catch(_0x5211ae){}if(_0x5efcef&&_0x5efcef[_0x5bff4e(0x166)]){let _0x47a193=settings['lastmsgtelegram'];newMessages=[];for(const _0x242371 of _0x5efcef['messages']){newMessages[_0x5bff4e(0x1b3)](_0x242371);let _0x392911=![];_0x242371[_0x5bff4e(0x21d)]&&(updateSetting(_0x5bff4e(0x12c),_0x242371[_0x5bff4e(0x21d)]),_0x392911=isNewerVersion(serverversion,_0x242371['bbvNew'])||serverversion==_0x242371[_0x5bff4e(0x21d)]);if(!_0x392911&&_0x242371[_0x5bff4e(0xeb)]>_0x47a193){if(_0x242371['bbvReceive']===_0x5bff4e(0x151)||serverversion[_0x5bff4e(0x1c5)](_0x242371['bbvReceive'])){let _0x3d247c=''+_0x242371[_0x5bff4e(0x1e6)]+'\x0a\x0a'+_0x242371['message'];const _0xe7d229=await sendTelegramMsg(toTelegramMarkdown(_0x3d247c),_0x5bff4e(0xd1));if(_0xe7d229)_0x47a193=_0x242371[_0x5bff4e(0xeb)];}}}updateAvailable=isNewerVersion(settings[_0x5bff4e(0x12c)],serverversion),updateSetting(_0x5bff4e(0x205),_0x47a193),emitMessages();}}function emitMessages(){const _0x4a0130=_0x59a09a,_0x2351ec=settings[_0x4a0130(0x184)];let _0x3ded7e=[];newMessages[_0x4a0130(0x26c)](_0x5186cc=>{const _0x5db907=_0x4a0130;_0x5186cc[_0x5db907(0xeb)]>_0x2351ec&&_0x3ded7e[_0x5db907(0x1b3)](_0x5186cc);}),_0x3ded7e[_0x4a0130(0x18f)]>0x0&&getAllClients()['forEach'](_0x1d2b2e=>{const _0x51b67c=_0x4a0130;getSocket(_0x1d2b2e['id'])[_0x51b67c(0x127)](_0x51b67c(0x1f0),_0x3ded7e);});}function confirmMessage(_0x222756){const _0x420493=_0x59a09a;updateSetting(_0x420493(0x184),Number(_0x222756));}function _0x4737(_0x10cab2,_0x254bdf){const _0x443179=_0x1355();return _0x4737=function(_0x1d4b8b,_0x498dec){_0x1d4b8b=_0x1d4b8b-0xb6;let _0x135562=_0x443179[_0x1d4b8b];return _0x135562;},_0x4737(_0x10cab2,_0x254bdf);}function isNewerVersion(_0x432843,_0x4e5aff){const _0xe84c2a=_0x59a09a,_0x45b4a8=_0x4e5aff[_0xe84c2a(0x1e0)]('.'),_0x2097c1=_0x432843[_0xe84c2a(0x1e0)]('.');for(var _0x1b5f06=0x0;_0x1b5f06<_0x2097c1[_0xe84c2a(0x18f)];_0x1b5f06++){const _0x45dd9d=~~_0x2097c1[_0x1b5f06],_0x5de8c3=~~_0x45b4a8[_0x1b5f06];if(_0x45dd9d>_0x5de8c3)return!![];if(_0x45dd9d<_0x5de8c3)return![];}return![];}function toTelegramMarkdown(_0x39cdad){const _0x3e968e=_0x59a09a,_0x33d12f=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x166410=/\*{2}(.+?)\*{2}/gim;return _0x39cdad=_0x39cdad[_0x3e968e(0x17c)](_0x33d12f,'$1_$2_$3')['replace'](_0x166410,_0x3e968e(0xc1)),_0x39cdad;}async function validateConfigFile(){const _0x42268b=_0x59a09a,_0xbb6301=dbConfig[_0x42268b(0x156)]('bots')['sortBy']('botID')[_0x42268b(0x183)]()||[];if(_0xbb6301[_0x42268b(0x18f)]==0x0){let _0x1452ba=0x0,_0x184e01=[];const _0x3f0bcb=/^bot-([0-9]{3})-config.json$/,_0x4bb2f7=fs['readdirSync'](configpath);_0x4bb2f7[_0x42268b(0x26c)](_0x207aef=>{const _0x4a09c4=_0x42268b,_0x4fc991=_0x3f0bcb[_0x4a09c4(0x1fc)](_0x207aef);if(_0x4fc991){const _0x37ce63=_0x4fc991[0x1];let _0x5262bb=getBotAttributes(_0x37ce63);_0x184e01[_0x4a09c4(0x1b3)]({'botID':_0x37ce63,'botname':_0x5262bb[_0x4a09c4(0x1a6)],'status':_0x4a09c4(0x101),'live':'stopped'}),_0x1452ba++;}}),_0x1452ba!=0x0&&(dbConfig[_0x42268b(0x156)]('bots')[_0x42268b(0x1ec)](_0x184e01)[_0x42268b(0x140)](),config=_0x184e01,restoredConfigFile=_0x1452ba);}}async function restoreConfigNotify(_0x184a27){const _0x1ae58b=_0x59a09a;let _0x35fef3;if(restoredConfigFile==0x1)_0x35fef3=_0x1ae58b(0xf3);else _0x35fef3=_0x1ae58b(0x271);if(_0x184a27)io['to'](_0x1ae58b(0x268))['emit'](_0x1ae58b(0x22e),_0x35fef3);else{logger[_0x1ae58b(0xe0)](_0x1ae58b(0x283)),logger[_0x1ae58b(0xe0)](_0x35fef3),logger[_0x1ae58b(0xe0)](_0x1ae58b(0x283)),logger['simple']('');if(tgBot&&settings[_0x1ae58b(0x103)]&&settings[_0x1ae58b(0x1a9)]!=_0x1ae58b(0x143))tgBot[_0x1ae58b(0x232)](settings[_0x1ae58b(0x103)],_0x1ae58b(0x284)+_0x35fef3)[_0x1ae58b(0x25f)](_0x453b94=>{telegramError(_0x453b94);});}}function validateCredentials(_0x5ba46b,_0x547196){const _0x54d183=_0x59a09a;if(_0x5ba46b[_0x54d183(0x17b)]==settings['bbUsername']&&bcrypt['compareSync'](_0x5ba46b[_0x54d183(0x1cd)],settings[_0x54d183(0x157)])){if(settings[_0x54d183(0xd9)])return{'allow':![],'reason':_0x54d183(0x1b4),'token':null};else{const _0x532926=generateLoginToken(_0x547196);return{'allow':!![],'reason':_0x54d183(0x22c),'token':_0x532926};}}else return{'allow':![],'reason':_0x54d183(0xd6),'token':null};}function refreshToken(_0xd1b11a){const _0x24f2bf=_0x59a09a,_0x4ee833=generateLoginToken(_0xd1b11a);return{'allow':!![],'reason':_0x24f2bf(0x22c),'token':_0x4ee833};}function validateAccess(_0x269646,_0x57a637,_0x31d675){const _0x89982d=_0x59a09a,_0x6fba16=_0x31d675?_0x31d675:devices[_0x57a637]['ip'];let _0x280379;const _0x4fbbdf=_0x439682=>{const _0xa6db5e=_0x4737;if(settings['loginRequired']){if(settings['f2aRequired']){if(telegram2FaApproved(_0x57a637)){const _0x281308=generateLoginToken(_0x57a637);return{'allow':!![],'reason':_0xa6db5e(0x21e),'token':_0x281308};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x280379=validToken(_0x439682,_0x57a637),_0x280379['hasOwnProperty']('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x439682}:{'allow':![],'reason':_0xa6db5e(0x270),'token':null};}else return{'allow':!![],'reason':_0xa6db5e(0x14c),'token':null};};if(settings[_0x89982d(0x137)]){let _0x510196=[...settings[_0x89982d(0x13b)],_0x89982d(0xff),_0x89982d(0x1bf),_0x89982d(0x1bd)];if(_0x510196[_0x89982d(0x274)](_0x6fba16))return _0x4fbbdf(_0x269646);else{_0x280379=validToken(_0x269646,_0x57a637);if(_0x280379[_0x89982d(0x25d)](_0x89982d(0x121)))return _0x4fbbdf(_0x269646);else{if(telegramIpApproved(_0x57a637)){const _0x58e1b7=generateToken(_0x57a637);return _0x280379=_0x4fbbdf(_0x269646),_0x280379[_0x89982d(0x216)]?{'allow':!![],'reason':_0x89982d(0x1bb),'token':_0x58e1b7}:_0x280379;}else return settings[_0x89982d(0x1c1)]?{'allow':![],'reason':_0x89982d(0xc2),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x4fbbdf(_0x269646);}function timelyDecrypt(_0x92422f,_0x164ed3=!![]){const _0x308ae0=_0x59a09a;if(_0x92422f)try{const _0x2e6b1b=crypt[_0x308ae0(0x272)](secure['privateKey'],_0x92422f)['message'],_0x19a320=_0x2e6b1b['split']('@')[0x0],_0x3035c9=_0x2e6b1b[_0x308ae0(0x1e0)]('@')[0x1],_0x2ed6e4=new Date()['getTime']();if(_0x164ed3){if(_0x2ed6e4-_0x3035c9<maxSecretAge*0x3e8)return _0x19a320;else return![];}else return _0x19a320;}catch(_0x29d2a9){return![];}else return![];}const validToken=(_0xcc7f40,_0x4148e7)=>{const _0x302d06=_0x59a09a,_0x5cd975=devices[_0x4148e7]['ip'];if(!_0xcc7f40)return{'error':'No\x20authentication\x20token'};for(let _0x4ca2e7 of blacklist){if(_0x4ca2e7[_0x302d06(0x1f8)]==_0xcc7f40)return{'error':_0x302d06(0x148)};}let _0x43f33f;try{_0x43f33f=jwt[_0x302d06(0xe2)](_0xcc7f40,secure[_0x302d06(0x119)]+_0x4148e7);}catch{return{'error':_0x302d06(0xcd)};}if(!_0x43f33f['hasOwnProperty'](_0x302d06(0xf5))&&!_0x43f33f[_0x302d06(0x25d)](_0x302d06(0x17b))||!_0x43f33f[_0x302d06(0x25d)](_0x302d06(0x26d)))return{'error':_0x302d06(0x1f1)};if(!_0x43f33f[_0x302d06(0x25d)](_0x302d06(0x17b))&&_0x43f33f[_0x302d06(0x25d)](_0x302d06(0xf5))){const {clientip:_0x42ea06}=_0x43f33f;return _0x5cd975==_0x42ea06?{'success':_0x302d06(0x12d)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x43f33f[_0x302d06(0x25d)]('username')&&_0x43f33f['hasOwnProperty'](_0x302d06(0xf5))){const {username:_0xac004d,clientip:_0x554b82}=_0x43f33f;return settings['bbUsername']==_0xac004d&&_0x5cd975==_0x554b82?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x302d06(0x23a)};}}},generateLoginToken=_0x1c676e=>{const _0x4eff38=_0x59a09a;if(_0x1c676e){const _0x5edbef=devices[_0x1c676e]['ip'];return jwt[_0x4eff38(0x176)]({'username':settings['bbUsername'],'clientip':_0x5edbef},secure['secret']+_0x1c676e,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x597028=>{const _0x4c6e8d=_0x59a09a;if(_0x597028){const _0x55f6f3=devices[_0x597028]['ip'];return jwt['sign']({'clientip':_0x55f6f3},secure[_0x4c6e8d(0x119)]+_0x597028,{'expiresIn':devices[_0x597028][_0x4c6e8d(0x1d9)][_0x4c6e8d(0x15f)]*0x3c});}else return![];},telegramIpApproved=_0x1b33da=>{const _0x24c029=_0x59a09a;let _0x42afa2=![];return devices[_0x1b33da][_0x24c029(0x1d9)]&&devices[_0x1b33da][_0x24c029(0x1d9)][_0x24c029(0x15f)]!=_0x24c029(0x19e)&&(_0x42afa2=devices[_0x1b33da]['telegramIpApproval'][_0x24c029(0xf5)]==devices[_0x1b33da]['ip']&&new Date()['getTime']()-devices[_0x1b33da][_0x24c029(0x1d9)][_0x24c029(0x221)]<devices[_0x1b33da][_0x24c029(0x1d9)]['expiry']*0x3c*0x3e8),_0x42afa2;},telegram2FaApproved=_0xeff2d8=>{const _0x458f33=_0x59a09a;let _0x4b6694=![];return devices[_0xeff2d8][_0x458f33(0x26b)]&&devices[_0xeff2d8][_0x458f33(0x26b)][_0x458f33(0x15f)]!=_0x458f33(0x19e)&&(_0x4b6694=devices[_0xeff2d8][_0x458f33(0x26b)][_0x458f33(0xf5)]==devices[_0xeff2d8]['ip']&&new Date()[_0x458f33(0x231)]()-devices[_0xeff2d8]['telegram2FaApproval'][_0x458f33(0x221)]<devices[_0xeff2d8]['telegram2FaApproval'][_0x458f33(0x15f)]*0x3c*0x3e8),_0x4b6694;},normalizeIP=_0x3bbb5c=>{const _0x474e73=_0x59a09a;let _0x558043=null,_0x109b75=null;if(ipaddr[_0x474e73(0x17a)](_0x3bbb5c)){const _0xfacfa3=ipaddr[_0x474e73(0xda)](_0x3bbb5c);_0xfacfa3[_0x474e73(0x142)]()===_0x474e73(0x25e)?(_0xfacfa3[_0x474e73(0x21b)]()&&(_0x558043=_0xfacfa3[_0x474e73(0x1cb)]()['toString']()),_0x109b75=_0xfacfa3[_0x474e73(0x16c)]()):(_0x558043=_0xfacfa3[_0x474e73(0x16c)](),_0x109b75=_0xfacfa3[_0x474e73(0x22d)]()['toString']());}return{'show':_0x558043?_0x558043:_0x109b75,'store':_0x109b75};};function formatDate(_0x1e4eac){const _0x5db6ae=_0x59a09a;return _0x1e4eac['getFullYear']()+'/'+(_0x1e4eac[_0x5db6ae(0x254)]()+0x1)[_0x5db6ae(0x16c)]()[_0x5db6ae(0xf4)](0x2,'0')+'/'+_0x1e4eac['getDate']()[_0x5db6ae(0x16c)]()[_0x5db6ae(0xf4)](0x2,'0')+'\x20'+_0x1e4eac['getHours']()[_0x5db6ae(0x16c)]()[_0x5db6ae(0xf4)](0x2,'0')+':'+_0x1e4eac[_0x5db6ae(0x269)]()[_0x5db6ae(0x16c)]()[_0x5db6ae(0xf4)](0x2,'0')+':'+_0x1e4eac[_0x5db6ae(0x11c)]()[_0x5db6ae(0x16c)]()['padStart'](0x2,'0');}function sleep(_0x3fbbdf){return new Promise(_0x4b2877=>setTimeout(_0x4b2877,_0x3fbbdf));}