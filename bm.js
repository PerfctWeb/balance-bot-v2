const _0x43bc0b=_0x2e49;(function(_0x3d545b,_0x2343b9){const _0xca3434=_0x2e49,_0x2df741=_0x3d545b();while(!![]){try{const _0x14a74a=parseInt(_0xca3434(0x156))/0x1+parseInt(_0xca3434(0x111))/0x2+-parseInt(_0xca3434(0x18f))/0x3*(parseInt(_0xca3434(0x282))/0x4)+-parseInt(_0xca3434(0x162))/0x5+parseInt(_0xca3434(0x1dc))/0x6+parseInt(_0xca3434(0xec))/0x7*(-parseInt(_0xca3434(0x132))/0x8)+parseInt(_0xca3434(0x185))/0x9;if(_0x14a74a===_0x2343b9)break;else _0x2df741['push'](_0x2df741['shift']());}catch(_0x3036e9){_0x2df741['push'](_0x2df741['shift']());}}}(_0x5d54,0x65d6a));const _0x4506df=function(){let _0x42dbde=!![];return function(_0x12ca8e,_0x282e9d){const _0x248309=_0x42dbde?function(){const _0x4d1f8f=_0x2e49;if(_0x282e9d){const _0x4116cd=_0x282e9d[_0x4d1f8f(0x280)](_0x12ca8e,arguments);return _0x282e9d=null,_0x4116cd;}}:function(){};return _0x42dbde=![],_0x248309;};}(),_0x76fc96=_0x4506df(this,function(){const _0x5a459b=_0x2e49;return _0x76fc96[_0x5a459b(0x22b)]()[_0x5a459b(0x204)](_0x5a459b(0x1ba))[_0x5a459b(0x22b)]()['constructor'](_0x76fc96)['search'](_0x5a459b(0x1ba));});_0x76fc96();'use strict';function _0x5d54(){const _0x42bb25=[':\x20Bot\x20Mgr\x20>\x20','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','bots','SIGTERM','https://api.ipify.org?format=json','index.html','\x1b[33m','stop','apiPassword','toIPv4MappedAddress','getHours','getDate','mixpanel','sockets','length','padStart','Invalid\x20IP\x20address','restore-backup-file','telegramChatId',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','exit','keys','format','exec','status','express-fileupload','string','catch','chat','835478uxFPQx','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','uuid','headers','headless','Deleted\x20Bot\x20','\x20|\x20client:\x20...','backup-files','stopPolling','max','show','token','remove','mkdirSync','connected',',\x20must\x20be\x20a\x204\x20digit\x20number','request','add','Login\x20rejected','Unauthorized\x20attempt\x20to\x20update\x20settings','copyFileSync','verify','get-portfolio','/help\x20-\x20show\x20available\x20commands\x0a','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','bcryptjs','debug','SIGINT','settings.','bot-','\x20(2)','botmanager','Bot\x20Mgr\x20>\x20','8HIJPNq','remoteAddress','telegramEvents','temporary\x20access\x20rejected','filter','callback_query','pidExpireLogin','Unauthorized\x20login\x20attempt\x20(timeout)','/:bot/coins','node-zip','createServer','listen','reload','message','backupfile','Unauthorized\x20attempt\x20to\x20delete\x20alerts','includes','sort','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Starting\x20Balance\x20Bot\x20update','address','/disable\x20-\x20disable\x20notifications\x0a','show-config','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Restarting\x20Bot\x20','rmSync','socket','toggleBotMode','pidRefreshToken','invalid\x20credentials','All\x20bots','backup-full','Starting\x20Balance\x20Bot\x20','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','login\x20token\x20generated','output-001.log','647878axSbuV','Unauthorized\x20attempt\x20to\x20download\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','graphql-request','::ffff:127.0.0.1','DEFLATE','timestamp','************','Markdown','telegram','expiry','\x1b[36m','2234210evTkhK','find','number','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','zip/','static','user','output-000.log','startsWith','ipaddr.js','resetHistory','No\x20bots\x20running\x20right\x20now','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','download','store-fiat','hybrid-crypto-js','disabled','Unauthorized\x20attempt\x20to\x20confirm\x20message','bbUsername','-results.json','args','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','lastmsgtelegram','express','Password\x20reset\x20rejected','#RES#\x20if\x20running\x20locally\x0a','HTML','telegramIpApproval','Backup\x20file\x20unzipped\x20and\x20stored','botID','get','versions','uuid-random','started','backup','2818278GKyopd','Notifications\x20disabled\x0a','404\x20Not\x20Found','new','Crypt','=>\x20Go\x20to\x20#CYA#http://','then','backup-full.zip','logs','split','3AejcaM','config/','emitHistory','bot.js','hasOwnProperty','name','/:bot/support','updatebotmanager','bb-config.json','botname','referer','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','build','.zip','enabled','Allow\x20login\x20from\x20IP\x20address\x20<b>','username','version.json','Notifications\x20enabled','output-002.log','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','value','generate','Session\x20expired\x20for\x20user\x20...','Server','Error\x20while\x20deleting\x20config\x20files:\x20','\x1b[35m','files','yargs/yargs','login','clients','emit','generateKeyPairAsync','User\x20has\x20been\x20validated','sendMessage','backup-full@','sign','reinstall-bb','log','Network\x20Interfaces:','bb/','showname','internal','(((.+)+)+)+$','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','socket.io','RSA','\x20|\x20','Yes','readFileSync','\x20mode','\x1b[34m','sendMetricsTelegram','reason','title','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','private','from','track','orders','store-configuration','handshake','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','mtime','stopped','readdirSync','statSync','get-starting-balances','file','disconnect','toIPv4Address','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','existsSync','warning','-performance.json','slice','server','1693428hYUvfY','all','getTime','timeshift','publicKey','use','assign','new-disabled','test','#RES#\x0a','storeConfiguration','endsWith','messages','sortBy','inherit','store','Starting\x20bot\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','6b67f3d61ee94b8f5c80b4affef4c4d9','ipv6','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','/upload-backup','Bot\x20','auth','***','/restart\x20-\x20restart\x20bot(s)\x0a','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','hashSync','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','blacklist','api-eu.mixpanel.com','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','::1','Logged\x20out\x20user\x20...','127.0.0.1','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','-----------------------------------------------------------------------------------','login\x20token\x20valid','cancelLoading','Unauthorized\x20attempt\x20to\x20get\x20portfolio','search','Unauthorized\x20attempt\x20to\x20delete\x20bot','Notifications\x20enabled\x0a','family','removeAllListeners','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','error','map','replace','1000','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','bb-secure.json','getSeconds','Unauthorized\x20attempt\x20to\x20update\x20bot','/:bot/configuration','isDirectory','kill','Starting\x20Balance\x20Bot\x20reinstallation','Enabled\x20Bot\x20','Idling\x20bot\x20\x20\x20|\x20Bot\x20','temporary\x20access\x20timeout','Unauthorized\x20attempt\x20to\x20add\x20bot','<b>Telegram\x20Bot\x20Status:</b>\x0a','randomFillSync','removeListener','join','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','child_process','ipc','range','\x20minutes','confirm-message','bb-settings.json','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','\x20only\x0a','push','order','onepagemode','loginRequired','toString','</b>\x20?','Ok,\x20will\x20send\x20order\x20notifications\x20only','Unauthorized\x20attempt\x20to\x20get\x20messages','-config.json','fork','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','binary','/download/:type',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','entries','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','running','temporary\x20token\x20generated','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','apiKey','Notifications\x20types:\x20','<b>Balance\x20Bot\x20Status:</b>\x0a','#RES#\x20if\x20running\x20on\x20server','node','Temporary\x20access\x20rejected','kind','decrypt','bbvNew','storeFiat','post','get-logs','logout','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','\x20>\x20','forEach','get-backup-files','/names\x20-\x20show\x20bot\x20names\x0a','Restore\x20process\x20aborted','Invalid\x20authentication\x20token\x20(1)','full','Node.js\x20v','reset-history','delete-alerts','add-bot','sendFile','/:bot/history','lastmsgemitted','temporary\x20access\x20not\x20allowed','alias','access\x20timeout','send','logs/','settings','unlinkSync','temp/','2FA','password','stringify','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','/metrics\x20-\x20show\x20bot\x20performance\x0a','simple','You\x20can\x20use\x20the\x20following\x20commands:\x0a','reset-password','reject','polling_error','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','RSA-OAEP','Unauthorized\x20attempt\x20to\x20get\x20events','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Alerts','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','type','whitelist','tkn','f2aRequired','Your\x20installation\x20is\x20already\x20up\x20to\x20date','data','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','defaults','auto','showConfig','bbPassword','exp','telegram2FaApproval','function','[ip-address]','Invalid\x20username\x20or\x20IP\x20address','Error\x20removing\x20old\x20backup\x20files:','Logged\x20in\x20user\x20...','apply','uncaughtException','2934604IXaDpp','\x20to\x20','storeHeadless','Error:\x20Invalid\x20argument\x20','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','live','Invalid\x20Telegram\x20token','/enable\x20-\x20enable\x20notifications\x0a','Unauthorized\x20attempt\x20to\x20log\x20out','Ok,\x20will\x20send\x20alert\x20notifications\x20only','write','delete-bot','logged\x20out','\x1b[0m','secret','set','allow','-events.json','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','exchange','yes','event','Token\x20blacklisted','2FA\x20login\x20token\x20generated','accept','bbvReceive','latestversion','cancel-loading','jsonwebtoken','userid','Failed\x20to\x20download\x20','store-settings','Unauthorized\x20attempt\x20to\x20show\x20configuration','answerCallbackQuery','axios','sendPortfolioTelegram','clientip','build2','Setting\x20access:\x20','getFullYear','login\x20required','http','conn','store-headless','telegrammsg','Orders','reinstall','telegramEnabled','5\x20min','0.0.0','bot','createWriteStream','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','parse','writeFileSync','manual','Login\x20accepted','\x20(1)','getMinutes','_data','All\x20bots\x20running\x20right\x20now','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','/:bot/portfolio','mode','success','update-bb','alerts','telegramToken','/:bot/performance','$1_$2_$3','telegramUsername','/off\x20-\x20stop\x20bot(s)\x0a','getMonth','initclient','notification','update','privateKey','match','Password\x20has\x20been\x20reset\x20to:\x20','Restore\x20backup\x20file\x20','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Disabled\x20Bot\x20','\x20|\x20user:\x20...','access','getUTCHours','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','onText','path','hex','443618CRmeCW','IPv4','/output-000.log','secure','whitelistEnabled','argv'];_0x5d54=function(){return _0x42bb25;};return _0x5d54();}process['env']['NTBA_FIX_319']=0x1;const childProcess=require(_0x43bc0b(0x21f)),fs=require('fs'),fns=require('date-fns'),low=require('lowdb'),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x43bc0b(0xea)),crypto=require('crypto'),Crypt=require(_0x43bc0b(0x171))[_0x43bc0b(0x189)],RSA=require(_0x43bc0b(0x171))[_0x43bc0b(0x1bd)],bcrypt=require(_0x43bc0b(0x12a)),jwt=require(_0x43bc0b(0xaf)),ipaddr=require(_0x43bc0b(0x16b)),argv=require(_0x43bc0b(0x1ab))(process[_0x43bc0b(0xf1)][_0x43bc0b(0x1da)](0x2))[_0x43bc0b(0xf1)],uuidRandom=require(_0x43bc0b(0x182)),TelegramBot=require('node-telegram-bot-api'),Mixpanel=require(_0x43bc0b(0xfe)),axios=require(_0x43bc0b(0xb5)),{GraphQLClient,gql}=require(_0x43bc0b(0x159)),util=require('util'),fileUpload=require(_0x43bc0b(0x10d)),{networkInterfaces}=require('os'),PORT=argv['port']||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x43bc0b(0x1e4)](PORT)&&(console[_0x43bc0b(0x1b5)](_0x43bc0b(0x285)+PORT+_0x43bc0b(0x120)),process['exit'](0x1));const HOST=argv['host']||null,userID=argv[_0x43bc0b(0x168)]||'',debugging=argv['d']||![],nodeversion=process[_0x43bc0b(0x181)][_0x43bc0b(0x23e)];let bbpath=_0x43bc0b(0x1b7),bbpath2='';const botfile=_0x43bc0b(0x192),configfile=_0x43bc0b(0x197),settingsfile=_0x43bc0b(0x224),securefile=_0x43bc0b(0x20f),maxBackups=0xa;let validInstallation=!![];!fs[_0x43bc0b(0x1d7)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x43bc0b(0x1ad)),configpath=userID?bbpath+_0x43bc0b(0x190)+userID+'/':bbpath+_0x43bc0b(0x190),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x43bc0b(0x25a)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x43bc0b(0x166),loggerfile=fs[_0x43bc0b(0xc6)](logspath+_0x43bc0b(0xee),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x43bc0b(0x25d);!fs[_0x43bc0b(0x1d7)](configpath)&&fs[_0x43bc0b(0x11e)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x43bc0b(0x11e)](configbackuppath);!fs[_0x43bc0b(0x1d7)](logspath)&&fs[_0x43bc0b(0x11e)](logspath);!fs[_0x43bc0b(0x1d7)](zippath)&&fs[_0x43bc0b(0x11e)](zippath);!fs[_0x43bc0b(0x1d7)](temppath)&&fs[_0x43bc0b(0x11e)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x43bc0b(0x275)]({'bots':[]})[_0x43bc0b(0x28c)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x43bc0b(0xc4),'onepagemode':![]}})[_0x43bc0b(0x28c)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x43bc0b(0x275)]({'secure':{},'blacklist':[]})[_0x43bc0b(0x28c)]();function _0x2e49(_0x4a9d61,_0x3b25b0){const _0x36d45d=_0x5d54();return _0x2e49=function(_0x76fc96,_0x4506df){_0x76fc96=_0x76fc96-0xab;let _0x5d543c=_0x36d45d[_0x76fc96];return _0x5d543c;},_0x2e49(_0x4a9d61,_0x3b25b0);}let crypt=new Crypt({'md':'sha256','rsaStandard':_0x43bc0b(0x269)});const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x43bc0b(0x1ee),{'host':_0x43bc0b(0x1fa)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x43bc0b(0xd6)]&&settings[_0x43bc0b(0xd6)]!=''&&settings[_0x43bc0b(0xd9)]&&settings[_0x43bc0b(0xd9)]!='')initTelegram();const parseColor=(_0x4ca8d5,_0xbe25c6)=>{const _0x31b404=_0x43bc0b,_0x2e1712=/#[A-Z]{3}#/g;if(typeof _0x4ca8d5==_0x31b404(0x10e)){!_0xbe25c6?_0x4ca8d5=_0x4ca8d5[_0x31b404(0x20c)](_0x2e1712,''):(_0x4ca8d5=_0x4ca8d5[_0x31b404(0x20c)](/#BLU#/g,_0x31b404(0x1c2)),_0x4ca8d5=_0x4ca8d5[_0x31b404(0x20c)](/#RED#/g,'\x1b[31m'),_0x4ca8d5=_0x4ca8d5['replace'](/#YEL#/g,_0x31b404(0xf8)),_0x4ca8d5=_0x4ca8d5[_0x31b404(0x20c)](/#MAG#/g,_0x31b404(0x1a9)),_0x4ca8d5=_0x4ca8d5[_0x31b404(0x20c)](/#CYA#/g,_0x31b404(0x161)),_0x4ca8d5=_0x4ca8d5['replace'](/#RES#/g,_0x31b404(0x28f)));;}return _0x4ca8d5;},logger={'screen':_0x23da66=>{const _0x306462=_0x43bc0b;console[_0x306462(0x1b5)](parseColor(_0x23da66,!![]));},'simple':_0x2acda7=>{const _0x1a44f2=_0x43bc0b;console[_0x1a44f2(0x1b5)](parseColor(_0x2acda7,!![])),loggerfile['write'](util['format'](parseColor(_0x2acda7,![]))+'\x0a');},'full':async _0x1df620=>{const _0xbcdd49=_0x43bc0b,_0x13f60f=getTimeStamp()+_0xbcdd49(0xf2)+_0x1df620;console[_0xbcdd49(0x1b5)](parseColor(_0x13f60f,!![])),loggerfile[_0xbcdd49(0x28c)](util[_0xbcdd49(0x10a)](parseColor(_0x13f60f,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0xbcdd49(0x134)]!=_0xbcdd49(0x1ca))await tgBot[_0xbcdd49(0x1b1)](settings[_0xbcdd49(0x104)],_0xbcdd49(0x131)+parseColor(_0x1df620,![]))['catch'](_0x2d6f02=>{telegramError(_0x2d6f02);});},'debug':async(_0x3f4f7c,_0x106c7d='')=>{const _0x5c7615=_0x43bc0b,_0x5f321f=getTimeStamp()+_0x5c7615(0x234)+_0x3f4f7c;if(debugging)console[_0x5c7615(0x1b5)](parseColor(_0x5f321f,!![]));loggerfile[_0x5c7615(0x28c)](util['format'](parseColor(_0x5f321f,![]))+'\x0a');if(_0x106c7d){if(debugging)console[_0x5c7615(0x1b5)](_0x106c7d);loggerfile[_0x5c7615(0x28c)](util[_0x5c7615(0x10a)](_0x106c7d)+'\x0a');}}};process['on'](_0x43bc0b(0x281),function(_0x15619e){logger['simple'](_0x15619e);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x43bc0b(0x1a0))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x43bc0b(0x179)),app=express(),http=require(_0x43bc0b(0xbc))[_0x43bc0b(0x13c)](app);app[_0x43bc0b(0x1e1)](fileUpload({'useTempFiles':!![]})),app[_0x43bc0b(0x180)](_0x43bc0b(0x233),async(_0x3c503b,_0x46bbb1)=>{const _0x5c2a8d=_0x43bc0b,_0x5ccd92=_0x3c503b['params'][_0x5c2a8d(0x26e)],_0xecbe2e=getClientsWithBotID(_0x5c2a8d(0x130)),_0x3d924c=_0x3c503b[_0x5c2a8d(0x114)][_0x5c2a8d(0x113)],_0x57b36a=timelyDecrypt(_0x3d924c,![]),_0x257a84=_0xecbe2e[_0x5c2a8d(0x163)](_0x58a965=>_0x58a965[_0x5c2a8d(0x113)]==_0x57b36a);if(_0x257a84){const _0x88e8af=normalizeIP(_0x3c503b[_0x5c2a8d(0x14c)][_0x5c2a8d(0x133)])[_0x5c2a8d(0x1eb)],_0x474eeb=_0x3c503b[_0x5c2a8d(0x114)]['tkn'];if(validateAccess(_0x474eeb,_0x57b36a,_0x88e8af)[_0x5c2a8d(0x292)])_0x5ccd92=='backup'&&await backupConfigFiles(),await zipFiles(_0x5ccd92),_0x46bbb1[_0x5c2a8d(0x16f)](zippath+(_0x5ccd92+_0x5c2a8d(0x19c)),_0x36f7a0=>{const _0x21894c=_0x5c2a8d;_0x36f7a0&&(logger[_0x21894c(0x24e)](_0x21894c(0xb1)+_0x5ccd92),logger['simple'](_0x36f7a0));});else logger[_0x5c2a8d(0x24e)](_0x5c2a8d(0x157)+_0x5ccd92+_0x5c2a8d(0xcc));}else logger[_0x5c2a8d(0x24e)](_0x5c2a8d(0x157)+_0x5ccd92+_0x5c2a8d(0x12f));}),app[_0x43bc0b(0x244)](_0x43bc0b(0x1f1),async(_0x390957,_0xa4e408)=>{const _0x22cc37=_0x43bc0b,_0x3d65a3=getClientsWithBotID(_0x22cc37(0x130)),_0x42c74d=_0x390957[_0x22cc37(0x114)][_0x22cc37(0x113)],_0x47025a=timelyDecrypt(_0x42c74d,![]),_0x159c58=_0x3d65a3[_0x22cc37(0x163)](_0x41cd14=>_0x41cd14[_0x22cc37(0x113)]==_0x47025a);logger[_0x22cc37(0x12b)]('Backup\x20file\x20uploaded');if(_0x159c58){const _0x52ca83=normalizeIP(_0x390957[_0x22cc37(0x14c)][_0x22cc37(0x133)])[_0x22cc37(0x1eb)],_0x5c3a69=_0x390957[_0x22cc37(0x114)][_0x22cc37(0x270)];if(validateAccess(_0x5c3a69,_0x47025a,_0x52ca83)[_0x22cc37(0x292)]){if(_0x390957['files']){const _0x3441d4=_0x390957[_0x22cc37(0x1aa)][_0x22cc37(0x140)];await _0x3441d4['mv'](temppath+_0x3441d4[_0x22cc37(0x194)]),_0xa4e408[_0x22cc37(0x259)]({'status':!![],'message':'File\x20uploaded'});const _0x1ac08d=getBotsWithMode();_0x1ac08d['length']>0x0?confirmRestore(temppath,_0x3441d4[_0x22cc37(0x194)]):unzipFile(temppath,_0x3441d4['name']);}}else logger['full'](_0x22cc37(0x106));}else logger['full'](_0x22cc37(0x1ed));}),app[_0x43bc0b(0x1e1)](express['static'](path[_0x43bc0b(0x21d)](__dirname,bbpath2,_0x43bc0b(0xb8)))),app[_0x43bc0b(0x1e1)](express[_0x43bc0b(0x167)](path[_0x43bc0b(0x21d)](__dirname,bbpath2,_0x43bc0b(0x19b)))),app['get']('/',function(_0x33dfd7,_0x196bf8){const _0xe61305=_0x43bc0b;_0x196bf8[_0xe61305(0x253)](path[_0xe61305(0x21d)](__dirname,bbpath2,_0xe61305(0xb8),_0xe61305(0xf7)));}),app[_0x43bc0b(0x180)]('/:bot',function(_0x22017b,_0x171b3c){const _0x36342d=_0x43bc0b;_0x171b3c['sendFile'](path[_0x36342d(0x21d)](__dirname,bbpath2,_0x36342d(0x19b),_0x36342d(0xf7)));}),app['get'](_0x43bc0b(0xd1),(_0x2dbc0a,_0x31aad4)=>{_0x31aad4['sendFile'](path['join'](__dirname,bbpath2,'build','index.html'));}),app['get'](_0x43bc0b(0xd7),(_0x4ae78e,_0xc6cf60)=>{const _0x5cb989=_0x43bc0b;_0xc6cf60['sendFile'](path[_0x5cb989(0x21d)](__dirname,bbpath2,_0x5cb989(0x19b),'index.html'));}),app[_0x43bc0b(0x180)](_0x43bc0b(0x13a),(_0x31bde0,_0x50493a)=>{const _0x4ce73c=_0x43bc0b;_0x50493a['sendFile'](path[_0x4ce73c(0x21d)](__dirname,bbpath2,_0x4ce73c(0x19b),'index.html'));}),app[_0x43bc0b(0x180)](_0x43bc0b(0x254),(_0x270203,_0x56d0c1)=>{const _0x322b7f=_0x43bc0b;_0x56d0c1[_0x322b7f(0x253)](path['join'](__dirname,bbpath2,_0x322b7f(0x19b),_0x322b7f(0xf7)));}),app[_0x43bc0b(0x180)](_0x43bc0b(0x212),(_0x134299,_0x30dee1)=>{const _0x20536e=_0x43bc0b;_0x30dee1['sendFile'](path[_0x20536e(0x21d)](__dirname,bbpath2,_0x20536e(0x19b),_0x20536e(0xf7)));}),app[_0x43bc0b(0x180)](_0x43bc0b(0x195),(_0x39d268,_0x44f291)=>{const _0x703904=_0x43bc0b;_0x44f291[_0x703904(0x253)](path['join'](__dirname,bbpath2,'build',_0x703904(0xf7)));});if(HOST)http[_0x43bc0b(0x13d)](PORT,HOST);else http[_0x43bc0b(0x13d)](PORT);const io=require(_0x43bc0b(0x1bc))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x2a35bd=_0x43bc0b;let _0x3fca96=_0x2a35bd(0x27c);const _0x50efea=networkInterfaces(),_0x4b8d18={};for(const _0x39c303 of Object[_0x2a35bd(0x109)](_0x50efea)){for(const _0xd1e0c5 of _0x50efea[_0x39c303]){if((_0xd1e0c5['family']==_0x2a35bd(0xed)||_0xd1e0c5[_0x2a35bd(0x207)]==0x4)&&!_0xd1e0c5[_0x2a35bd(0x1b9)]){const _0x411db0=ipaddr['parse'](_0xd1e0c5[_0x2a35bd(0x146)])[_0x2a35bd(0x221)]();_0x411db0!=_0x2a35bd(0x1c7)&&(!_0x4b8d18[_0x39c303]&&(_0x4b8d18[_0x39c303]=[]),_0x4b8d18[_0x39c303]['push'](_0xd1e0c5[_0x2a35bd(0x146)]),_0x3fca96=_0xd1e0c5[_0x2a35bd(0x146)]);}}}return{'serverip':_0x3fca96,'netinterfaces':_0x4b8d18};}async function startServer(){const _0x37e4b7=_0x43bc0b,{serverip:_0x4c5baf,netinterfaces:_0x2af4ea}=getServerIP();logger[_0x37e4b7(0x263)](''),logger[_0x37e4b7(0x263)](_0x37e4b7(0x200)),await logger[_0x37e4b7(0x24e)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x37e4b7(0x1e5)+(_0x37e4b7(0x294)+PORT+_0x37e4b7(0x17b))+(_0x37e4b7(0x18a)+_0x4c5baf+':'+PORT+_0x37e4b7(0x23d))),logger[_0x37e4b7(0x263)](_0x37e4b7(0x200));if(config[_0x37e4b7(0x100)]!=0x0)for(const _0x54472d of config){if(_0x54472d[_0x37e4b7(0x10c)]=='enabled'||_0x54472d[_0x37e4b7(0x10c)]==_0x37e4b7(0x188))await logger[_0x37e4b7(0x24e)](_0x37e4b7(0x1ec)+_0x54472d[_0x37e4b7(0x17f)]+_0x37e4b7(0x1be)+_0x54472d[_0x37e4b7(0x198)]),startBot([_0x54472d[_0x37e4b7(0x17f)],userID],{'cwd':bbpath},function(_0x50b41b){if(_0x50b41b)logger['full'](_0x50b41b);});else(_0x54472d['status']=='disabled'||_0x54472d[_0x37e4b7(0x10c)]=='new-disabled')&&await logger[_0x37e4b7(0x24e)](_0x37e4b7(0x217)+_0x54472d['botID']+_0x37e4b7(0x1be)+_0x54472d[_0x37e4b7(0x198)]);}else!newBot&&logger['simple'](_0x37e4b7(0x1c6));if(newBot)addBot();logger[_0x37e4b7(0x263)](_0x37e4b7(0x200)),logger[_0x37e4b7(0x263)](''),await logger[_0x37e4b7(0x12b)](_0x37e4b7(0x24f)+nodeversion),await logger[_0x37e4b7(0x12b)](_0x37e4b7(0x1b6),_0x2af4ea);}function startSocket(){io['on']('connection',_0xf6b1e8=>{const _0x37534c=_0x2e49;let _0x44b398,_0x348ace,_0x45110f,_0x40bc73,_0x499755;const _0x2264b0=_0xf6b1e8['handshake'][_0x37534c(0x114)][_0x37534c(0x199)];_0x348ace=_0x2264b0[_0x37534c(0xe0)](/bot[0-9]{3}/);if(_0x348ace)_0x45110f=_0x348ace[0x0][_0x37534c(0xe0)](/[0-9]{3}/);if(_0x45110f)_0x44b398=_0x45110f[0x0];else _0x44b398=_0x37534c(0x130);const _0x264194=_0xf6b1e8[_0x37534c(0x1cc)][_0x37534c(0x1f3)]['encryptedUuid'];if(!_0x264194)_0xf6b1e8[_0x37534c(0x1ae)](_0x37534c(0x10c),{'publicKey':secure[_0x37534c(0x1e0)]});else{_0x40bc73=timelyDecrypt(_0x264194,![]);if(!_0x40bc73)_0xf6b1e8[_0x37534c(0x1ae)]('status',{'publicKey':secure[_0x37534c(0x1e0)]});else{_0x499755=normalizeIP(_0xf6b1e8[_0x37534c(0xbd)][_0x37534c(0x133)])[_0x37534c(0x1eb)];if(!devices[_0x40bc73])devices[_0x40bc73]={'uuid':_0x40bc73,'access':{'token':null}};devices[_0x40bc73]['ip']=_0x499755;const _0x33c9cb=addClient(_0xf6b1e8['id'],_0x40bc73,_0x44b398);setAccess(_0x33c9cb),emitMessages(),_0xf6b1e8['on'](_0x37534c(0x1ac),_0x3cba95=>{const _0x3cc4f8=_0x37534c,_0x5da47b=timelyDecrypt(_0x3cba95[_0x3cc4f8(0x25f)]);if(_0x5da47b){_0x3cba95={'username':_0x3cba95[_0x3cc4f8(0x19f)],'password':_0x5da47b},devices[_0x40bc73]['access']=validateCredentials(_0x3cba95,_0x40bc73);if(devices[_0x40bc73][_0x3cc4f8(0xe6)]['allow']==![]&&devices[_0x40bc73][_0x3cc4f8(0xe6)][_0x3cc4f8(0x1c4)]=='2FA\x20login\x20required')_0xf6b1e8[_0x3cc4f8(0x1ae)](_0x3cc4f8(0x10c),{'access':devices[_0x40bc73][_0x3cc4f8(0xe6)]}),loginAccess2FA(_0x40bc73,_0x499755);else{if(devices[_0x40bc73][_0x3cc4f8(0xe6)][_0x3cc4f8(0x292)]==![]&&devices[_0x40bc73][_0x3cc4f8(0xe6)]['reason']==_0x3cc4f8(0x14f))_0xf6b1e8[_0x3cc4f8(0x1ae)](_0x3cc4f8(0x10c),{'access':devices[_0x40bc73][_0x3cc4f8(0xe6)]});else devices[_0x40bc73][_0x3cc4f8(0xe6)][_0x3cc4f8(0x292)]&&devices[_0x40bc73][_0x3cc4f8(0xe6)][_0x3cc4f8(0x1c4)]==_0x3cc4f8(0x154)&&(getClientsWithUuid(_0x40bc73)[_0x3cc4f8(0x249)](_0x3c05d8=>{setAccess(_0x3c05d8);}),logger[_0x3cc4f8(0x12b)](_0x3cc4f8(0x27f)+_0x40bc73[_0x3cc4f8(0x1da)](-0x8)),setTokenRefresh(_0x40bc73),setSessionTimeout('login',_0x40bc73));}}else logger[_0x3cc4f8(0x24e)](_0x3cc4f8(0x139));}),_0xf6b1e8['on'](_0x37534c(0x265),()=>{resetPassword();}),_0xf6b1e8['on'](_0x37534c(0x1d4),_0x5ef761=>{removeClient(_0xf6b1e8['id']);}),_0x44b398==_0x37534c(0x130)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x21a301){const _0x3410e7=_0x43bc0b;if(_0x21a301!=_0x3410e7(0x130)&&config[_0x3410e7(0x23a)]!=''){if(pid[_0x21a301])pid[_0x21a301][_0x3410e7(0x259)]({'function':_0x3410e7(0xdc),'args':null});}_0x21a301!=_0x3410e7(0x130)&&broadcastToBots(_0x3410e7(0xf4),JSON[_0x3410e7(0x260)](config));}function reloadBotManager(){const _0x391bdb=_0x43bc0b;getClientsWithBotID('botmanager')[_0x391bdb(0x249)](_0x22af08=>{const _0x496bee=_0x391bdb;getSocket(_0x22af08['id'])['emit'](_0x496bee(0x10c),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x222cb2){const _0x336ae0=_0x43bc0b;return io[_0x336ae0(0xff)][_0x336ae0(0xff)]['get'](_0x222cb2);}function setAccess(_0xae4273){const _0x3965d8=_0x43bc0b,_0x24459d=getSocket(_0xae4273['id']),_0xde84c1=_0xae4273[_0x3965d8(0x113)],_0x16f65b=_0xae4273[_0x3965d8(0xc5)];devices[_0xde84c1][_0x3965d8(0xe6)]=validateAccess(devices[_0xde84c1]['access'][_0x3965d8(0x11c)],_0xde84c1),logger[_0x3965d8(0x12b)](_0x3965d8(0xb9)+devices[_0xde84c1][_0x3965d8(0xe6)][_0x3965d8(0x1c4)]+_0x3965d8(0x117)+_0xae4273['id'][_0x3965d8(0x1da)](-0x8)+_0x3965d8(0xe5)+_0xde84c1['slice'](-0x8)),_0x24459d['join'](_0xde84c1);if(devices[_0xde84c1][_0x3965d8(0xe6)][_0x3965d8(0x292)]){_0x24459d[_0x3965d8(0x21d)](_0x16f65b);if(_0x16f65b==_0x3965d8(0x130))initializeSocketBotManager(_0x24459d);else initializeSocketBot(_0x24459d);initClient(_0x16f65b);}devices[_0xde84c1][_0x3965d8(0xe6)]['token']&&devices[_0xde84c1][_0x3965d8(0xe6)]['reason']=='temporary\x20token\x20generated'&&setSessionTimeout(_0x3965d8(0x25e),_0xde84c1),devices[_0xde84c1][_0x3965d8(0xe6)][_0x3965d8(0x11c)]&&devices[_0xde84c1][_0x3965d8(0xe6)][_0x3965d8(0x1c4)]==_0x3965d8(0x299)&&setSessionTimeout(_0x3965d8(0x1ac),_0xde84c1),_0x24459d['emit']('status',{'status':_0xae4273[_0x3965d8(0x1db)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0xde84c1][_0x3965d8(0xe6)],'externalip':devices[_0xde84c1]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x3965d8(0xb0)],'validInstallation':validInstallation}),devices[_0xde84c1]['access'][_0x3965d8(0x292)]==![]&&devices[_0xde84c1]['access'][_0x3965d8(0x1c4)]=='2FA\x20required'&&temporaryAccess2FA(_0xde84c1,devices[_0xde84c1]['ip']);}function setSessionTimeout(_0x5f2497,_0x568424){const _0x18a218=_0x43bc0b;let _0x3bd647;if(_0x5f2497==_0x18a218(0x1ac))_0x3bd647=loginExpiry*0x3c*0x3e8;else _0x3bd647=devices[_0x568424][_0x18a218(0x17d)][_0x18a218(0x160)]*0x3c*0x3e8-(new Date()[_0x18a218(0x1de)]()-devices[_0x568424]['telegramIpApproval'][_0x18a218(0x15c)]);if(devices[_0x568424][_0x18a218(0x138)])clearTimeout(devices[_0x568424][_0x18a218(0x138)]);devices[_0x568424][_0x18a218(0x138)]=setTimeout(()=>{const _0x4b84ed=_0x18a218;if(devices[_0x568424][_0x4b84ed(0x14e)])clearTimeout(devices[_0x568424][_0x4b84ed(0x14e)]);removeSocketListeners(_0x568424),addBlacklist(_0x568424),devices[_0x568424][_0x4b84ed(0x17d)]=null,devices[_0x568424][_0x4b84ed(0x27a)]=null,devices[_0x568424][_0x4b84ed(0xe6)][_0x4b84ed(0x11c)]=null,logger[_0x4b84ed(0x12b)](_0x4b84ed(0x1a6)+_0x568424[_0x4b84ed(0x1da)](-0x8)),devices[_0x568424][_0x4b84ed(0xe6)]=validateAccess(devices[_0x568424]['access'][_0x4b84ed(0x11c)],_0x568424),!(devices[_0x568424][_0x4b84ed(0xe6)][_0x4b84ed(0x292)]&&devices[_0x568424][_0x4b84ed(0xe6)][_0x4b84ed(0x1c4)]=='login\x20not\x20required')&&(_0x5f2497==_0x4b84ed(0x1ac)?io['to'](_0x568424)['emit'](_0x4b84ed(0x10c),{'access':{'allow':![],'reason':_0x4b84ed(0x258),'token':null}}):io['to'](_0x568424)['emit'](_0x4b84ed(0x10c),{'access':{'allow':![],'reason':_0x4b84ed(0x218),'token':null}})),devices[_0x568424][_0x4b84ed(0xe6)][_0x4b84ed(0x11c)]=null;},_0x3bd647);}function setTokenRefresh(_0x5765af){const _0x4b6c3f=_0x43bc0b;if(devices[_0x5765af][_0x4b6c3f(0x14e)])clearTimeout(devices[_0x5765af][_0x4b6c3f(0x14e)]);devices[_0x5765af][_0x4b6c3f(0x14e)]=setTimeout(()=>{const _0x1bddf4=_0x4b6c3f;getClientsWithUuid(_0x5765af)[_0x1bddf4(0x100)]!=0x0?(devices[_0x5765af][_0x1bddf4(0xe6)]=refreshToken(_0x5765af),io['to'](_0x5765af)[_0x1bddf4(0x1ae)](_0x1bddf4(0x10c),{'status':_0x1bddf4(0x11f),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x5765af][_0x1bddf4(0xe6)],'externalip':devices[_0x5765af]['ip'],'publicKey':secure[_0x1bddf4(0x1e0)],'validInstallation':validInstallation}),setTokenRefresh(_0x5765af)):clearTimeout(devices[_0x5765af][_0x1bddf4(0x14e)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x127bed){const _0x532e9a=_0x43bc0b,_0x5c1103=getClient(_0x127bed['id'])['uuid'];_0x127bed['emit']('bots',config),_0x127bed[_0x532e9a(0x1ae)](_0x532e9a(0x25b),cleanSettings()),_0x127bed['on'](_0x532e9a(0x252),_0x2c3b5a=>{const _0x22936e=_0x532e9a;if(validateAccess(_0x2c3b5a,_0x5c1103)[_0x22936e(0x292)])addBot();else logger['full'](_0x22936e(0x219));}),_0x127bed['on']('update-bot',(_0x1dc1c3,_0x240431)=>{const _0x45adce=_0x532e9a;if(validateAccess(_0x240431,_0x5c1103)[_0x45adce(0x292)])toggleBot(_0x1dc1c3['botID'],_0x1dc1c3['status'],_0x1dc1c3[_0x45adce(0x287)]);else logger['full'](_0x45adce(0x211));}),_0x127bed['on']('toggle-bot-mode',(_0x3bbd42,_0x14801c)=>{const _0x1bf3f3=_0x532e9a;if(validateAccess(_0x14801c,_0x5c1103)[_0x1bf3f3(0x292)])toggleBotMode(_0x3bbd42);else logger[_0x1bf3f3(0x24e)](_0x1bf3f3(0x211));}),_0x127bed['on'](_0x532e9a(0x28d),(_0x21cdda,_0x44dfcf)=>{const _0x436986=_0x532e9a;if(validateAccess(_0x44dfcf,_0x5c1103)[_0x436986(0x292)])deleteBot(_0x21cdda);else logger[_0x436986(0x24e)](_0x436986(0x205));}),_0x127bed['on'](_0x532e9a(0xb2),(_0x691a75,_0x24a7c9)=>{const _0x5e6162=_0x532e9a;if(validateAccess(_0x24a7c9,_0x5c1103)[_0x5e6162(0x292)])storeSettings(_0x691a75,!![]);else logger[_0x5e6162(0x24e)](_0x5e6162(0x124));}),_0x127bed['on'](_0x532e9a(0xd4),_0x209253=>{const _0x459146=_0x532e9a;if(validateAccess(_0x209253,_0x5c1103)[_0x459146(0x292)])updateBB(_0x459146(0xde));else logger['full'](_0x459146(0x149));}),_0x127bed['on'](_0x532e9a(0x1b4),_0x44c3c9=>{const _0x34db8c=_0x532e9a;if(validateAccess(_0x44c3c9,_0x5c1103)[_0x34db8c(0x292)])updateBB(_0x34db8c(0xc1));else logger[_0x34db8c(0x24e)](_0x34db8c(0xc7));}),_0x127bed['on'](_0x532e9a(0x24a),_0x343829=>{const _0x58e771=_0x532e9a;if(validateAccess(_0x343829,_0x5c1103)[_0x58e771(0x292)]){const _0x4f3172=getClient(_0x127bed['id']);if(_0x4f3172)getBackupFiles(_0x4f3172['uuid']);else logger[_0x58e771(0x24e)](_0x58e771(0x1d6));}else logger[_0x58e771(0x24e)](_0x58e771(0x1f0));}),_0x127bed['on'](_0x532e9a(0x103),(_0x57d480,_0x53f0a6)=>{const _0xfff0dc=_0x532e9a;if(validateAccess(_0x53f0a6,_0x5c1103)[_0xfff0dc(0x292)])restoreBackupFile(_0x57d480);else logger['full'](_0xfff0dc(0x261));}),_0x127bed['on']('get-messages',_0x3b1f7c=>{const _0x5a6ae7=_0x532e9a;if(validateAccess(_0x3b1f7c,_0x5c1103)[_0x5a6ae7(0x292)])getMessages();else logger[_0x5a6ae7(0x24e)](_0x5a6ae7(0x22e));}),_0x127bed['on'](_0x532e9a(0x223),(_0x2d9bc5,_0x35e66b)=>{const _0x1ada42=_0x532e9a;if(validateAccess(_0x35e66b,_0x5c1103)[_0x1ada42(0x292)])confirmMessage(_0x2d9bc5);else logger[_0x1ada42(0x24e)](_0x1ada42(0x173));}),_0x127bed['on'](_0x532e9a(0x246),_0x1a3571=>{const _0x22b968=_0x532e9a;if(validateAccess(_0x1a3571,_0x5c1103)[_0x22b968(0x292)]){if(devices[_0x5c1103]['pidRefreshToken'])clearTimeout(devices[_0x5c1103][_0x22b968(0x14e)]);if(devices[_0x5c1103][_0x22b968(0x138)])clearTimeout(devices[_0x5c1103][_0x22b968(0x138)]);removeSocketListeners(getClient(_0x127bed['id'])['uuid']),addBlacklist(_0x5c1103),devices[_0x5c1103][_0x22b968(0x17d)]=null,devices[_0x5c1103][_0x22b968(0x27a)]=null,devices[_0x5c1103][_0x22b968(0xe6)][_0x22b968(0x11c)]=null,logger[_0x22b968(0x12b)](_0x22b968(0x1fd)+_0x5c1103[_0x22b968(0x1da)](-0x8)),io['to'](getClient(_0x127bed['id'])[_0x22b968(0x113)])['emit'](_0x22b968(0x10c),{'access':{'allow':![],'reason':_0x22b968(0x28e),'token':null}});}else logger['full'](_0x22b968(0x28a));});}function initializeSocketBot(_0x1544dc){const _0x39191f=_0x43bc0b,_0x39e819=getClient(_0x1544dc['id'])[_0x39191f(0xc5)],_0x299644=getClient(_0x1544dc['id'])['uuid'];_0x1544dc['on'](_0x39191f(0x245),(_0x358b9b,_0x2b903b)=>{const _0x17bc68=_0x39191f;if(validateAccess(_0x2b903b,_0x299644)[_0x17bc68(0x292)]){if(pid[_0x39e819])pid[_0x39e819]['send']({'function':_0x17bc68(0x191),'args':_0x358b9b});}else logger['full'](_0x17bc68(0x26a));}),_0x1544dc['on'](_0x39191f(0x251),(_0x2e0033,_0x315d60)=>{const _0x45f341=_0x39191f;if(validateAccess(_0x315d60,_0x299644)[_0x45f341(0x292)]){if(pid[_0x39e819])pid[_0x39e819]['send']({'function':'deleteHistoryAlerts','args':_0x2e0033});}else logger[_0x45f341(0x24e)](_0x45f341(0x141));}),_0x1544dc['on'](_0x39191f(0x127),(_0x260f8a,_0x45f83d)=>{const _0x5ae6cd=_0x39191f;if(validateAccess(_0x45f83d,_0x299644)['allow']){if(pid[_0x39e819])pid[_0x39e819][_0x5ae6cd(0x259)]({'function':'getPortfolio','args':_0x260f8a});}else logger[_0x5ae6cd(0x24e)](_0x5ae6cd(0x203));}),_0x1544dc['on'](_0x39191f(0x1cb),(_0x581e48,_0x7d5341)=>{const _0x4e2ac5=_0x39191f;if(validateAccess(_0x7d5341,_0x299644)[_0x4e2ac5(0x292)]){if(pid[_0x39e819])pid[_0x39e819][_0x4e2ac5(0x259)]({'function':_0x4e2ac5(0x1e6),'args':_0x581e48});}else logger[_0x4e2ac5(0x24e)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x1544dc['on'](_0x39191f(0xbe),(_0x7ee8ae,_0x1790a6)=>{const _0x34ff52=_0x39191f;if(validateAccess(_0x1790a6,_0x299644)[_0x34ff52(0x292)]){if(pid[_0x39e819])pid[_0x39e819][_0x34ff52(0x259)]({'function':_0x34ff52(0x284),'args':_0x7ee8ae});}else logger[_0x34ff52(0x24e)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x1544dc['on'](_0x39191f(0x170),(_0x46f552,_0x3be738)=>{const _0x1095b7=_0x39191f;if(validateAccess(_0x3be738,_0x299644)[_0x1095b7(0x292)]){if(pid[_0x39e819])pid[_0x39e819][_0x1095b7(0x259)]({'function':_0x1095b7(0x243),'args':_0x46f552});}else logger[_0x1095b7(0x24e)](_0x1095b7(0xd0));}),_0x1544dc['on'](_0x39191f(0x250),_0x304218=>{const _0x21c8e1=_0x39191f;if(validateAccess(_0x304218,_0x299644)[_0x21c8e1(0x292)]){if(pid[_0x39e819])pid[_0x39e819][_0x21c8e1(0x259)]({'function':_0x21c8e1(0x16c),'args':null});}else logger['full'](_0x21c8e1(0x239));}),_0x1544dc['on'](_0x39191f(0x1d2),_0x367fe8=>{const _0x4af9df=_0x39191f;if(validateAccess(_0x367fe8,_0x299644)[_0x4af9df(0x292)]){if(pid[_0x39e819])pid[_0x39e819][_0x4af9df(0x259)]({'function':'getStartingBalances','args':null});}else logger[_0x4af9df(0x24e)](_0x4af9df(0x16e));}),_0x1544dc['on']('place-order',(_0x66f1f8,_0x1c4ff8)=>{const _0x1501c=_0x39191f;if(validateAccess(_0x1c4ff8,_0x299644)[_0x1501c(0x292)]){if(pid[_0x39e819])pid[_0x39e819]['send']({'function':'placeOrder','args':_0x66f1f8});}else logger[_0x1501c(0x24e)](_0x1501c(0x112));}),_0x1544dc['on'](_0x39191f(0xae),_0x875828=>{const _0x23e16c=_0x39191f;if(validateAccess(_0x875828,_0x299644)[_0x23e16c(0x292)]){if(pid[_0x39e819])pid[_0x39e819][_0x23e16c(0x259)]({'function':_0x23e16c(0x202),'args':null});}else logger['full'](_0x23e16c(0x268));}),_0x1544dc['on'](_0x39191f(0x148),_0x3628f7=>{const _0x1a2b3f=_0x39191f;if(validateAccess(_0x3628f7,_0x299644)[_0x1a2b3f(0x292)]){if(pid[_0x39e819])pid[_0x39e819][_0x1a2b3f(0x259)]({'function':_0x1a2b3f(0x277),'args':null});}else logger[_0x1a2b3f(0x24e)](_0x1a2b3f(0xb3));}),_0x1544dc['on']('update-bb',_0x1abb9d=>{const _0xe49729=_0x39191f;if(validateAccess(_0x1abb9d,_0x299644)[_0xe49729(0x292)])updateBB(_0xe49729(0xde));else logger['full'](_0xe49729(0x149));}),_0x1544dc['on']('get-messages',_0x5de692=>{const _0x2149d1=_0x39191f;if(validateAccess(_0x5de692,_0x299644)[_0x2149d1(0x292)])getMessages();else logger[_0x2149d1(0x24e)](_0x2149d1(0x22e));}),_0x1544dc['on'](_0x39191f(0x223),(_0x5dba81,_0x112850)=>{const _0x15ce86=_0x39191f;if(validateAccess(_0x112850,_0x299644)['allow'])confirmMessage(_0x5dba81);else logger['full'](_0x15ce86(0x173));}),_0x1544dc['on']('logout',_0x613d7=>{const _0x4ae6b9=_0x39191f;if(validateAccess(_0x613d7,_0x299644)[_0x4ae6b9(0x292)]){if(devices[_0x299644][_0x4ae6b9(0x14e)])clearTimeout(devices[_0x299644][_0x4ae6b9(0x14e)]);if(devices[_0x299644][_0x4ae6b9(0x138)])clearTimeout(devices[_0x299644][_0x4ae6b9(0x138)]);removeSocketListeners(getClient(_0x1544dc['id'])['uuid']),addBlacklist(_0x299644),devices[_0x299644][_0x4ae6b9(0x17d)]=null,devices[_0x299644][_0x4ae6b9(0x27a)]=null,devices[_0x299644][_0x4ae6b9(0xe6)][_0x4ae6b9(0x11c)]=null,logger[_0x4ae6b9(0x12b)](_0x4ae6b9(0x1fd)+_0x299644[_0x4ae6b9(0x1da)](-0x8)),io['to'](getClient(_0x1544dc['id'])[_0x4ae6b9(0x113)])[_0x4ae6b9(0x1ae)](_0x4ae6b9(0x10c),{'access':{'allow':![],'reason':_0x4ae6b9(0x28e),'token':null}});}else logger[_0x4ae6b9(0x24e)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x101bb6){const _0x3057d6=_0x43bc0b;getClientsWithUuid(_0x101bb6)[_0x3057d6(0x249)](_0x49c0f4=>{const _0x1f490f=_0x3057d6;getSocket(_0x49c0f4['id'])[_0x1f490f(0x208)]();});}function cleanSettings(){const _0x34816b=_0x43bc0b;let _0x348759=settings;return settings[_0x34816b(0xd6)]&&settings[_0x34816b(0xd6)]!=''&&(_0x348759={..._0x348759,'telegramToken':_0x34816b(0x15d)}),settings[_0x34816b(0x278)]&&settings[_0x34816b(0x278)]!=''&&(_0x348759={..._0x348759,'bbPassword':_0x34816b(0x15d)}),(settings[_0x34816b(0x278)]&&settings[_0x34816b(0x278)]==_0x34816b(0x1f4)||settings[_0x34816b(0xd6)]&&settings['telegramToken']==_0x34816b(0x1f4))&&(_0x348759={..._0x348759,'restored':{'password':settings[_0x34816b(0x278)]==_0x34816b(0x1f4),'telegram':settings[_0x34816b(0xd6)]==_0x34816b(0x1f4)}}),_0x348759;}async function updateBB(_0xbdbd44){const _0x42c62d=_0x43bc0b;await backupConfigFiles(),installingUpdate=!![],config[_0x42c62d(0x249)](_0x2ad115=>{const _0x364abc=_0x42c62d;restartBot(_0x2ad115[_0x364abc(0x17f)]);}),logger['debug'](_0x42c62d(0x152)+_0xbdbd44);if(_0xbdbd44==_0x42c62d(0xde))process[_0x42c62d(0x259)]({'update':!![]},_0x1e7a30=>{});else _0xbdbd44==_0x42c62d(0xc1)&&process[_0x42c62d(0x259)]({'reinstall':!![]},_0x5dc95a=>{});}function startBot(_0x380478,_0x4606fd,_0x289e9d){const _0x6cee26=_0x43bc0b;if(debugging)_0x380478[_0x6cee26(0x227)]('-d');let _0x3ab36d=![];const _0x12f052=_0x380478[0x0];_0x4606fd={..._0x4606fd,'stdio':[_0x6cee26(0x1ea),'inherit',_0x6cee26(0x1ea),_0x6cee26(0x220)]},pid[_0x12f052]=childProcess[_0x6cee26(0x230)](botfile,_0x380478,_0x4606fd),pid[_0x12f052]['on'](_0x6cee26(0x13f),_0x2f9037=>{const _0x1faad6=_0x6cee26;switch(Object[_0x1faad6(0x109)](_0x2f9037)[0x0]){case _0x1faad6(0x198):updateBotName(_0x12f052,_0x2f9037[_0x1faad6(0x198)]);break;case _0x1faad6(0x196):updateBotManager();break;case _0x1faad6(0x10c):updateStatus(_0x12f052,_0x2f9037[_0x1faad6(0x10c)]);break;case _0x1faad6(0x287):updateLive(_0x12f052,_0x2f9037['live']);break;case _0x1faad6(0x183):updateLive(_0x12f052,_0x2f9037[_0x1faad6(0x183)]),io['to'](_0x12f052)[_0x1faad6(0x1ae)](_0x1faad6(0x10c),{'access':{'allow':![],'reason':_0x1faad6(0x13e),'token':null}});break;case _0x1faad6(0xf9):_0x2f9037[_0x1faad6(0xf9)]=='restart'&&restartBot(_0x12f052);_0x2f9037[_0x1faad6(0xf9)]==_0x1faad6(0x214)&&toggleBot(_0x12f052,_0x1faad6(0x172),_0x1faad6(0x1cf));break;case _0x1faad6(0x15f):sendTelegram(_0x12f052,_0x2f9037['telegram']);break;case _0x1faad6(0xbf):sendTelegramMsg(_0x2f9037[_0x1faad6(0xbf)]);break;case _0x1faad6(0x27b):io['to'](_0x12f052)[_0x1faad6(0x1ae)](_0x2f9037[_0x1faad6(0x27b)],_0x2f9037[_0x1faad6(0x176)]);break;}}),pid[_0x12f052]['on'](_0x6cee26(0x20a),function(_0x266f7e){if(_0x3ab36d)return;_0x3ab36d=!![],_0x289e9d(_0x266f7e);}),pid[_0x12f052]['on']('exit',async function(_0xb0a1af){const _0x5c8d77=_0x6cee26;if(installingUpdate)return;if(_0x3ab36d)return;_0x3ab36d=!![],_0x289e9d(null);const _0x322e23=dbConfig['get']('bots')[_0x5c8d77(0x163)]({'botID':_0x12f052})[_0x5c8d77(0x1a4)]();_0x322e23&&(_0x322e23[_0x5c8d77(0x10c)]==_0x5c8d77(0x19d)||_0x322e23[_0x5c8d77(0x10c)]==_0x5c8d77(0x188))&&(await sleep(0x3e8),updateLive(_0x12f052,_0x5c8d77(0x1cf)),logger[_0x5c8d77(0x24e)](_0x5c8d77(0x14a)+_0x12f052),startBot([_0x12f052,userID],{'cwd':bbpath},function(_0xbb77f1){if(_0xbb77f1)logger['full'](_0xbb77f1);}));});}function stopBot(_0x42f0bc){const _0x4bfd55=_0x43bc0b;getClientsWithBotID(_0x42f0bc)[_0x4bfd55(0x249)](_0x322191=>{const _0x12eff5=_0x4bfd55;getSocket(_0x322191['id'])[_0x12eff5(0x1d4)](!![]),removeClient(_0x322191['id']);}),pid[_0x42f0bc]&&(pid[_0x42f0bc]['kill'](),pid[_0x42f0bc]=null);}function restartBot(_0x3c92ae){const _0x568857=_0x43bc0b;if(pid[_0x3c92ae])pid[_0x3c92ae][_0x568857(0x214)]();}function addBot(){const _0x336155=_0x43bc0b;let _0x4f34f7;for(let _0x4708ed=0x1;_0x4708ed<0x3e9;_0x4708ed++){_0x4f34f7=_0x4708ed[_0x336155(0x22b)]()[_0x336155(0x101)](0x3,'0');let _0x5782c3=config[_0x336155(0x163)](_0xeb4be0=>_0xeb4be0[_0x336155(0x17f)]==_0x4f34f7);if(!_0x5782c3)break;}if(_0x4f34f7===_0x336155(0x20d)){logger[_0x336155(0x24e)](_0x336155(0x236));return;}logger[_0x336155(0x24e)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x4f34f7),dbConfig['get'](_0x336155(0xf4))[_0x336155(0x227)]({'botID':_0x4f34f7,'botname':_0x336155(0x1f2)+_0x4f34f7,'status':_0x336155(0x188),'live':''})[_0x336155(0x28c)](),startBot([_0x4f34f7,userID],{'cwd':bbpath},function(_0x4ed568){const _0x1562af=_0x336155;if(_0x4ed568)logger[_0x1562af(0x24e)](_0x4ed568);}),config=getConfiguration(),io['to']('botmanager')[_0x336155(0x1ae)]('bots',config),broadcastToBots(_0x336155(0xf4),JSON[_0x336155(0x260)](config));}function deleteBot(_0x4afd1a){const _0x4bba50=_0x43bc0b;getClientsWithBotID(_0x4afd1a)['forEach'](_0x31777c=>{getSocket(_0x31777c['id'])['disconnect'](!![]),removeClient(_0x31777c['id']);}),dbConfig['get'](_0x4bba50(0xf4))[_0x4bba50(0x11d)]({'botID':_0x4afd1a})[_0x4bba50(0x28c)](),logger['full'](_0x4bba50(0x116)+_0x4afd1a),stopBot(_0x4afd1a);try{if(fs[_0x4bba50(0x1d7)](path[_0x4bba50(0x21d)](configpath,'bot-'+_0x4afd1a+_0x4bba50(0x22f))))fs[_0x4bba50(0x25c)](path[_0x4bba50(0x21d)](configpath,_0x4bba50(0x12e)+_0x4afd1a+_0x4bba50(0x22f)));if(fs[_0x4bba50(0x1d7)](path[_0x4bba50(0x21d)](configpath,_0x4bba50(0x12e)+_0x4afd1a+_0x4bba50(0x293))))fs[_0x4bba50(0x25c)](path[_0x4bba50(0x21d)](configpath,'bot-'+_0x4afd1a+_0x4bba50(0x293)));if(fs[_0x4bba50(0x1d7)](path['join'](configpath,_0x4bba50(0x12e)+_0x4afd1a+_0x4bba50(0x1d9))))fs[_0x4bba50(0x25c)](path[_0x4bba50(0x21d)](configpath,_0x4bba50(0x12e)+_0x4afd1a+_0x4bba50(0x1d9)));if(fs[_0x4bba50(0x1d7)](path['join'](configpath,'bot-'+_0x4afd1a+_0x4bba50(0x175))))fs[_0x4bba50(0x25c)](path['join'](configpath,_0x4bba50(0x12e)+_0x4afd1a+'-results.json'));}catch(_0x11c4f2){if(_0x11c4f2)logger[_0x4bba50(0x24e)](_0x4bba50(0x1a8),_0x11c4f2);}config=getConfiguration(),io['to'](_0x4bba50(0x130))[_0x4bba50(0x1ae)]('bots',config),broadcastToBots(_0x4bba50(0xf4),JSON['stringify'](config));}function toggleBot(_0x5410ee,_0x551d2d,_0x24d987){const _0x82e7b=_0x43bc0b;dbConfig[_0x82e7b(0x180)](_0x82e7b(0xf4))['find']({'botID':_0x5410ee})[_0x82e7b(0x1e2)]({'status':_0x551d2d})['assign']({'live':_0x24d987})[_0x82e7b(0x28c)]();if(_0x551d2d==_0x82e7b(0x19d)||_0x551d2d==_0x82e7b(0x188))logger[_0x82e7b(0x24e)](_0x82e7b(0x216)+_0x5410ee),startBot([_0x5410ee,userID],{'cwd':bbpath},function(_0x31b373){const _0x4598c2=_0x82e7b;if(_0x31b373)logger[_0x4598c2(0x24e)](_0x31b373);});else(_0x551d2d==_0x82e7b(0x172)||_0x551d2d==_0x82e7b(0x1e3))&&(logger[_0x82e7b(0x24e)](_0x82e7b(0xe4)+_0x5410ee),stopBot(_0x5410ee));config=getConfiguration(),io['to'](_0x82e7b(0x130))[_0x82e7b(0x1ae)](_0x82e7b(0xf4),config),broadcastToBots(_0x82e7b(0xf4),JSON['stringify'](config));}function toggleStatus(_0xc49aa0){const _0x4ff3fc=_0x43bc0b;let _0xb13317=dbConfig[_0x4ff3fc(0x180)](_0x4ff3fc(0xf4))[_0x4ff3fc(0x163)]({'botID':_0xc49aa0})[_0x4ff3fc(0x1a4)](),_0x401000;if(_0xb13317[_0x4ff3fc(0x10c)]==='enabled')_0x401000=_0x4ff3fc(0x172);else{if(_0xb13317[_0x4ff3fc(0x10c)]===_0x4ff3fc(0x188))_0x401000='new-disabled';else{if(_0xb13317[_0x4ff3fc(0x10c)]===_0x4ff3fc(0x1e3))_0x401000=_0x4ff3fc(0x188);else{if(_0xb13317['status']===_0x4ff3fc(0x172))_0x401000=_0x4ff3fc(0x19d);}}}return _0x401000;}function updateStatus(_0x2d299f,_0x392ec5){const _0x31c48c=_0x43bc0b;dbConfig[_0x31c48c(0x180)]('bots')[_0x31c48c(0x163)]({'botID':_0x2d299f})['assign']({'status':_0x392ec5})[_0x31c48c(0x28c)](),config=getConfiguration(),io['to'](_0x31c48c(0x130))['emit']('bots',config),broadcastToBots(_0x31c48c(0xf4),JSON[_0x31c48c(0x260)](config));}function updateLive(_0x10e3d4,_0x38aa1d){const _0x126576=_0x43bc0b;dbConfig[_0x126576(0x180)](_0x126576(0xf4))[_0x126576(0x163)]({'botID':_0x10e3d4})[_0x126576(0x1e2)]({'live':_0x38aa1d})[_0x126576(0x28c)](),config=getConfiguration(),io['to'](_0x126576(0x130))[_0x126576(0x1ae)](_0x126576(0xf4),config),broadcastToBots('bots',JSON[_0x126576(0x260)](config));}function updateBotName(_0x5b3c2e,_0x45301b){const _0x3fa802=_0x43bc0b;dbConfig[_0x3fa802(0x180)](_0x3fa802(0xf4))[_0x3fa802(0x163)]({'botID':_0x5b3c2e})[_0x3fa802(0x1e2)]({'botname':_0x45301b})[_0x3fa802(0x28c)](),config=getConfiguration(),io['to'](_0x3fa802(0x130))[_0x3fa802(0x1ae)](_0x3fa802(0xf4),config),broadcastToBots('bots',JSON[_0x3fa802(0x260)](config));}function updateBotManager(){const _0x219730=_0x43bc0b;config=getConfiguration(),io['to']('botmanager')[_0x219730(0x1ae)]('bots',config),broadcastToBots(_0x219730(0xf4),JSON[_0x219730(0x260)](config));}function toggleBotMode(_0x1655a7){const _0x538b2f=_0x43bc0b;if(pid[_0x1655a7])pid[_0x1655a7]['send']({'function':_0x538b2f(0x14d),'args':null});else{const _0x121a02=configpath+_0x538b2f(0x12e)+_0x1655a7+'-config.json',_0x28b350=fs[_0x538b2f(0x1c0)](_0x121a02),_0x185040=JSON[_0x538b2f(0xc8)](_0x28b350),_0x5aefd0=_0x185040[_0x538b2f(0xc5)][0x0][_0x538b2f(0x115)];_0x185040[_0x538b2f(0xc5)][0x0]['headless']=!_0x5aefd0;const _0x2d3020=JSON['stringify'](_0x185040,null,0x2);fs[_0x538b2f(0xc9)](_0x121a02,_0x2d3020),config=getConfiguration(),io['to'](_0x538b2f(0x130))['emit'](_0x538b2f(0xf4),config),broadcastToBots('bots',JSON[_0x538b2f(0x260)](config));}}function telegramError(_0x515376){const _0x5ad0a5=_0x43bc0b;logger[_0x5ad0a5(0x263)](getTimeStamp()+_0x5ad0a5(0x105));}function validateTelegram(_0x448aac){const _0x223fbe=_0x43bc0b;if(_0x448aac[_0x223fbe(0x1c8)][_0x223fbe(0x19f)]!=settings[_0x223fbe(0xd9)]&&'@'+_0x448aac[_0x223fbe(0x1c8)][_0x223fbe(0x19f)]!=settings[_0x223fbe(0xd9)])return tgBot[_0x223fbe(0x1b1)](_0x448aac[_0x223fbe(0x110)]['id'],_0x223fbe(0x1a3),{'parse_mode':_0x223fbe(0x17c)})['catch'](_0x1bfa4f=>{telegramError(_0x1bfa4f);}),![];return!![];}async function initTelegram(){const _0x3ce337=_0x43bc0b;if(tgBot)tgBot[_0x3ce337(0x119)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x4df395=_0x3ce337(0x264);_0x4df395+='\x0a',_0x4df395+=_0x3ce337(0x289),_0x4df395+=_0x3ce337(0x147),_0x4df395+=_0x3ce337(0x225),_0x4df395+=_0x3ce337(0x1f5),_0x4df395+='/on\x20-\x20start\x20bot(s)\x0a',_0x4df395+=_0x3ce337(0xda),_0x4df395+=_0x3ce337(0x1ff),_0x4df395+=_0x3ce337(0x24b),_0x4df395+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x4df395+=_0x3ce337(0x262),_0x4df395+=_0x3ce337(0xf3),_0x4df395+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x4df395+=_0x3ce337(0x1fb),_0x4df395+=_0x3ce337(0x128);let _0x279c8f='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x279c8f+='\x0a',_0x279c8f+=_0x4df395,tgBot[_0x3ce337(0xe9)](/\/start/,_0x3a711a=>{const _0x2b87fd=_0x3ce337;if(!validateTelegram(_0x3a711a))return;if(settings[_0x2b87fd(0x104)]!=_0x3a711a[_0x2b87fd(0x110)]['id'])updateSetting('telegramChatId',_0x3a711a[_0x2b87fd(0x110)]['id']);updateSetting(_0x2b87fd(0xc2),!![]),tgBot['sendMessage'](_0x3a711a[_0x2b87fd(0x110)]['id'],_0x279c8f)['catch'](_0x107d21=>{telegramError(_0x107d21);});}),tgBot['onText'](/\/enable/,_0x6b21d4=>{const _0x104d80=_0x3ce337;if(!validateTelegram(_0x6b21d4))return;if(settings[_0x104d80(0x104)]!=_0x6b21d4[_0x104d80(0x110)]['id'])updateSetting(_0x104d80(0x104),_0x6b21d4[_0x104d80(0x110)]['id']);updateSetting(_0x104d80(0xc2),!![]),tgBot[_0x104d80(0x1b1)](_0x6b21d4[_0x104d80(0x110)]['id'],_0x104d80(0x1a1))[_0x104d80(0x10f)](_0xcbf35c=>{telegramError(_0xcbf35c);});}),tgBot[_0x3ce337(0xe9)](/\/config/,async _0x5d3faa=>{const _0x5dc4dc=_0x3ce337;if(!validateTelegram(_0x5d3faa))return;tgBot['removeListener'](_0x5dc4dc(0x137)),tgBot['sendMessage'](_0x5d3faa[_0x5dc4dc(0x110)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x5dc4dc(0xc0),'callback_data':_0x5dc4dc(0x1ca)},{'text':_0x5dc4dc(0x26c),'callback_data':_0x5dc4dc(0xd5)},{'text':'All','callback_data':'all'}]]}})[_0x5dc4dc(0x10f)](_0x5afec9=>{telegramError(_0x5afec9);}),tgBot['on']('callback_query',async _0x5c9d30=>{const _0x5b5e6b=_0x5dc4dc,_0x15b55a=_0x5c9d30[_0x5b5e6b(0x273)],_0x39c5e7=_0x5c9d30[_0x5b5e6b(0x13f)];tgBot['answerCallbackQuery'](_0x5c9d30['id'])[_0x5b5e6b(0x18b)](async()=>{const _0x1f21e6=_0x5b5e6b;_0x15b55a=='orders'&&(updateSetting(_0x1f21e6(0x134),_0x1f21e6(0x1ca)),updateSetting('telegramEnabled',!![]),await tgBot[_0x1f21e6(0x1b1)](_0x39c5e7[_0x1f21e6(0x110)]['id'],_0x1f21e6(0x22d))[_0x1f21e6(0x10f)](_0x3014c3=>{telegramError(_0x3014c3);}));_0x15b55a=='alerts'&&(updateSetting(_0x1f21e6(0x134),_0x1f21e6(0xd5)),updateSetting(_0x1f21e6(0xc2),!![]),await tgBot[_0x1f21e6(0x1b1)](_0x39c5e7[_0x1f21e6(0x110)]['id'],_0x1f21e6(0x28b))[_0x1f21e6(0x10f)](_0x358a7c=>{telegramError(_0x358a7c);}));_0x15b55a=='all'&&(updateSetting(_0x1f21e6(0x134),_0x1f21e6(0x1dd)),updateSetting(_0x1f21e6(0xc2),!![]),await tgBot[_0x1f21e6(0x1b1)](_0x39c5e7[_0x1f21e6(0x110)]['id'],_0x1f21e6(0x144))['catch'](_0x4e9b8b=>{telegramError(_0x4e9b8b);}));if(!settings['telegramChatId'])tgBot[_0x1f21e6(0x1b1)](_0x39c5e7[_0x1f21e6(0x110)]['id'],_0x1f21e6(0x247))[_0x1f21e6(0x10f)](_0x418cc1=>{telegramError(_0x418cc1);});}),tgBot['removeListener'](_0x5b5e6b(0x137));});}),tgBot[_0x3ce337(0xe9)](/\/status/,_0xb3291d=>{const _0x318599=_0x3ce337;if(!validateTelegram(_0xb3291d))return;const _0x5321f0=getBotsWithMode();let _0x3cfd3e=_0x318599(0x23c);config[_0x318599(0x249)](_0x20ecc=>{const _0x26855c=_0x318599,_0x22f414=_0x5321f0[_0x26855c(0x163)](_0x38687b=>_0x38687b[_0x26855c(0x17f)]==_0x20ecc['botID'])[_0x26855c(0xd2)];_0x3cfd3e+='Bot\x20'+_0x20ecc[_0x26855c(0x17f)]+':\x20'+_0x20ecc['status']+_0x26855c(0x1be)+_0x22f414+'\x20|\x20'+_0x20ecc['live']+'\x0a';}),_0x3cfd3e+='\x0a',_0x3cfd3e+=_0x318599(0x21a),_0x3cfd3e+=!settings[_0x318599(0xc2)]?_0x318599(0x186):_0x318599(0x206),_0x3cfd3e+=settings['telegramEnabled']?settings[_0x318599(0x134)]==_0x318599(0x1dd)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x318599(0x23b)+settings[_0x318599(0x134)]+_0x318599(0x226):'',tgBot[_0x318599(0x1b1)](_0xb3291d['chat']['id'],_0x3cfd3e,{'parse_mode':'HTML'})[_0x318599(0x10f)](_0x5afbde=>{telegramError(_0x5afbde);});}),tgBot[_0x3ce337(0xe9)](/\/restart/,_0x540b2e=>{const _0x18285b=_0x3ce337;if(!validateTelegram(_0x540b2e))return;tgBot[_0x18285b(0x21c)](_0x18285b(0x137));const _0x113ed1=getEnabledBots();if(_0x113ed1[_0x18285b(0x100)]==0x0)tgBot[_0x18285b(0x1b1)](_0x540b2e[_0x18285b(0x110)]['id'],_0x18285b(0x16d))[_0x18285b(0x10f)](_0x4e738c=>{telegramError(_0x4e738c);});else{if(_0x113ed1[_0x18285b(0x100)]>0x1)_0x113ed1[_0x18285b(0x227)]({'botID':'all'});let _0x140fee=[],_0x103047=[];const _0x380cfe=_0x113ed1[_0x18285b(0x100)]%0x4==0x0||_0x113ed1['length']%0x4==0x3||_0x113ed1[_0x18285b(0x100)]%0x3==0x1?0x4:0x3;let _0x319c79=0x0;_0x113ed1[_0x18285b(0x249)]((_0x345241,_0x5e7ee3)=>{const _0x1f9447=_0x18285b;if(_0x5e7ee3%_0x380cfe==0x0)_0x103047=[];_0x103047[_0x1f9447(0x227)]({'text':_0x345241[_0x1f9447(0x17f)]==_0x1f9447(0x1dd)?_0x1f9447(0x150):'Bot\x20'+_0x345241[_0x1f9447(0x17f)],'callback_data':_0x345241[_0x1f9447(0x17f)]}),_0x5e7ee3%_0x380cfe==0x0&&(_0x140fee[_0x319c79]=_0x103047,_0x319c79++);}),tgBot[_0x18285b(0x1b1)](_0x540b2e[_0x18285b(0x110)]['id'],_0x18285b(0x177),{'reply_markup':{'inline_keyboard':_0x140fee}})['catch'](_0x4d37db=>{telegramError(_0x4d37db);}),tgBot['on'](_0x18285b(0x137),async _0x417674=>{const _0x438308=_0x18285b,_0x5f12d5=_0x417674[_0x438308(0x273)],_0x4eb71f=_0x417674[_0x438308(0x13f)];tgBot[_0x438308(0xb4)](_0x417674['id'])[_0x438308(0x18b)](async()=>{const _0x285f32=_0x438308;_0x5f12d5=='all'?config[_0x285f32(0x249)](_0x46588e=>{const _0x52abfb=_0x285f32;restartBot(_0x46588e[_0x52abfb(0x17f)]);}):restartBot(_0x5f12d5);}),tgBot[_0x438308(0x21c)](_0x438308(0x137));});}}),tgBot[_0x3ce337(0xe9)](/\/on/,_0x42de21=>{const _0x378834=_0x3ce337;if(!validateTelegram(_0x42de21))return;tgBot['removeListener'](_0x378834(0x137));const _0x2fd695=getDisabledBots();if(_0x2fd695[_0x378834(0x100)]==0x0)tgBot[_0x378834(0x1b1)](_0x42de21[_0x378834(0x110)]['id'],_0x378834(0xcf))[_0x378834(0x10f)](_0x37ae83=>{telegramError(_0x37ae83);});else{if(_0x2fd695[_0x378834(0x100)]>0x1)_0x2fd695[_0x378834(0x227)]({'botID':'all'});let _0x3fb534=[],_0x240238=[];const _0xd0742b=_0x2fd695['length']%0x4==0x0||_0x2fd695['length']%0x4==0x3||_0x2fd695[_0x378834(0x100)]%0x3==0x1?0x4:0x3;let _0x43ef19=0x0;_0x2fd695[_0x378834(0x249)]((_0x41cc40,_0x30eb8b)=>{const _0x5e7d01=_0x378834;if(_0x30eb8b%_0xd0742b==0x0)_0x240238=[];_0x240238[_0x5e7d01(0x227)]({'text':_0x41cc40[_0x5e7d01(0x17f)]==_0x5e7d01(0x1dd)?_0x5e7d01(0x150):'Bot\x20'+_0x41cc40[_0x5e7d01(0x17f)],'callback_data':_0x41cc40[_0x5e7d01(0x17f)]}),_0x30eb8b%_0xd0742b==0x0&&(_0x3fb534[_0x43ef19]=_0x240238,_0x43ef19++);}),tgBot[_0x378834(0x1b1)](_0x42de21[_0x378834(0x110)]['id'],_0x378834(0x158),{'reply_markup':{'inline_keyboard':_0x3fb534}})['catch'](_0x4f1491=>{telegramError(_0x4f1491);}),tgBot['on'](_0x378834(0x137),async _0x5bbc41=>{const _0x59d4ae=_0x378834,_0x578c6d=_0x5bbc41[_0x59d4ae(0x273)],_0x17bf5c=_0x5bbc41['message'];tgBot[_0x59d4ae(0xb4)](_0x5bbc41['id'])['then'](async()=>{const _0x53b346=_0x59d4ae;_0x578c6d==_0x53b346(0x1dd)?(tgBot[_0x53b346(0x1b1)](_0x17bf5c[_0x53b346(0x110)]['id'],_0x53b346(0xe3))['catch'](_0x13e769=>{telegramError(_0x13e769);}),_0x2fd695[_0x53b346(0x249)](_0x48e158=>{const _0x943ef4=_0x53b346;if(_0x48e158[_0x943ef4(0x17f)]!=_0x943ef4(0x1dd))toggleBot(_0x48e158['botID'],toggleStatus(_0x48e158['botID']),_0x943ef4(0x1cf));})):(tgBot[_0x53b346(0x1b1)](_0x17bf5c['chat']['id'],_0x53b346(0x274)+_0x578c6d)[_0x53b346(0x10f)](_0x4b132a=>{telegramError(_0x4b132a);}),toggleBot(_0x578c6d,toggleStatus(_0x578c6d),_0x53b346(0x1cf)));}),tgBot[_0x59d4ae(0x21c)](_0x59d4ae(0x137));});}}),tgBot['onText'](/\/off/,_0x57eaa1=>{const _0x2b8a0a=_0x3ce337;if(!validateTelegram(_0x57eaa1))return;tgBot[_0x2b8a0a(0x21c)](_0x2b8a0a(0x137));const _0x4566e0=getEnabledBots();if(_0x4566e0[_0x2b8a0a(0x100)]==0x0)tgBot[_0x2b8a0a(0x1b1)](_0x57eaa1[_0x2b8a0a(0x110)]['id'],_0x2b8a0a(0x16d))[_0x2b8a0a(0x10f)](_0x2031bb=>{telegramError(_0x2031bb);});else{if(_0x4566e0[_0x2b8a0a(0x100)]>0x1)_0x4566e0[_0x2b8a0a(0x227)]({'botID':_0x2b8a0a(0x1dd)});let _0x5adc81=[],_0x226150=[];const _0x42355a=_0x4566e0[_0x2b8a0a(0x100)]%0x4==0x0||_0x4566e0[_0x2b8a0a(0x100)]%0x4==0x3||_0x4566e0['length']%0x3==0x1?0x4:0x3;let _0x1a81dd=0x0;_0x4566e0[_0x2b8a0a(0x249)]((_0x55afdc,_0x38fa4b)=>{const _0x56e8ab=_0x2b8a0a;if(_0x38fa4b%_0x42355a==0x0)_0x226150=[];_0x226150[_0x56e8ab(0x227)]({'text':_0x55afdc[_0x56e8ab(0x17f)]==_0x56e8ab(0x1dd)?_0x56e8ab(0x150):_0x56e8ab(0x1f2)+_0x55afdc['botID'],'callback_data':_0x55afdc[_0x56e8ab(0x17f)]}),_0x38fa4b%_0x42355a==0x0&&(_0x5adc81[_0x1a81dd]=_0x226150,_0x1a81dd++);}),tgBot[_0x2b8a0a(0x1b1)](_0x57eaa1[_0x2b8a0a(0x110)]['id'],_0x2b8a0a(0x19a),{'reply_markup':{'inline_keyboard':_0x5adc81}})[_0x2b8a0a(0x10f)](_0x569076=>{telegramError(_0x569076);}),tgBot['on'](_0x2b8a0a(0x137),async _0xf9fd2a=>{const _0x4e360d=_0x2b8a0a,_0x16c9f6=_0xf9fd2a[_0x4e360d(0x273)],_0x3de6c8=_0xf9fd2a[_0x4e360d(0x13f)];tgBot[_0x4e360d(0xb4)](_0xf9fd2a['id'])['then'](async()=>{const _0x6e9366=_0x4e360d;_0x16c9f6==_0x6e9366(0x1dd)?(tgBot[_0x6e9366(0x1b1)](_0x3de6c8[_0x6e9366(0x110)]['id'],_0x6e9366(0xe8))[_0x6e9366(0x10f)](_0x226fc8=>{telegramError(_0x226fc8);}),_0x4566e0[_0x6e9366(0x249)](_0x52947e=>{const _0x244fac=_0x6e9366;if(_0x52947e['botID']!=_0x244fac(0x1dd))toggleBot(_0x52947e[_0x244fac(0x17f)],toggleStatus(_0x52947e['botID']),'stopped');})):(tgBot[_0x6e9366(0x1b1)](_0x3de6c8[_0x6e9366(0x110)]['id'],_0x6e9366(0x286)+_0x16c9f6)[_0x6e9366(0x10f)](_0x4cf6c2=>{telegramError(_0x4cf6c2);}),toggleBot(_0x16c9f6,toggleStatus(_0x16c9f6),_0x6e9366(0x1cf)));}),tgBot[_0x4e360d(0x21c)]('callback_query');});}}),tgBot[_0x3ce337(0xe9)](/\/metrics/,_0x16f608=>{const _0x33ccbf=_0x3ce337;if(!validateTelegram(_0x16f608))return;tgBot[_0x33ccbf(0x21c)](_0x33ccbf(0x137));const _0x30e825=getEnabledBots();if(_0x30e825[_0x33ccbf(0x100)]==0x0)tgBot[_0x33ccbf(0x1b1)](_0x16f608[_0x33ccbf(0x110)]['id'],_0x33ccbf(0x16d))[_0x33ccbf(0x10f)](_0xedec7f=>{telegramError(_0xedec7f);});else{if(_0x30e825['length']>0x1){let _0xc2ff19=[],_0x35a229=[];const _0x3801d9=_0x30e825[_0x33ccbf(0x100)]%0x4==0x0||_0x30e825[_0x33ccbf(0x100)]%0x4==0x3||_0x30e825['length']%0x3==0x1?0x4:0x3;let _0x581635=0x0;_0x30e825[_0x33ccbf(0x249)]((_0x2cec08,_0x10f0a2)=>{const _0x256561=_0x33ccbf;if(_0x10f0a2%_0x3801d9==0x0)_0x35a229=[];_0x35a229['push']({'text':_0x256561(0x1f2)+_0x2cec08[_0x256561(0x17f)],'callback_data':_0x2cec08[_0x256561(0x17f)]}),_0x10f0a2%_0x3801d9==0x0&&(_0xc2ff19[_0x581635]=_0x35a229,_0x581635++);}),tgBot[_0x33ccbf(0x1b1)](_0x16f608['chat']['id'],_0x33ccbf(0x165),{'reply_markup':{'inline_keyboard':_0xc2ff19}})['catch'](_0x13c497=>{telegramError(_0x13c497);}),tgBot['on'](_0x33ccbf(0x137),async _0x12c2e7=>{const _0x1fbc91=_0x33ccbf,_0x2dc1ba=_0x12c2e7[_0x1fbc91(0x273)],_0x2e89fa=_0x12c2e7[_0x1fbc91(0x13f)];tgBot[_0x1fbc91(0xb4)](_0x12c2e7['id'])[_0x1fbc91(0x18b)](async()=>{const _0x3192ac=_0x1fbc91;if(pid[_0x2dc1ba])pid[_0x2dc1ba][_0x3192ac(0x259)]({'function':_0x3192ac(0x1c3),'args':null});}),tgBot['removeListener']('callback_query');});}else{const _0x3e5873=_0x30e825[0x0]['botID'];if(pid[_0x3e5873])pid[_0x3e5873]['send']({'function':_0x33ccbf(0x1c3),'args':null});}}}),tgBot[_0x3ce337(0xe9)](/\/portfolio/,_0x4debdb=>{const _0x298770=_0x3ce337;if(!validateTelegram(_0x4debdb))return;tgBot['removeListener'](_0x298770(0x137));const _0x1cd5f4=getEnabledBots();if(_0x1cd5f4[_0x298770(0x100)]==0x0)tgBot[_0x298770(0x1b1)](_0x4debdb[_0x298770(0x110)]['id'],_0x298770(0x16d))[_0x298770(0x10f)](_0x4c4968=>{telegramError(_0x4c4968);});else{if(_0x1cd5f4[_0x298770(0x100)]>0x1){let _0x125159=[],_0x416d1a=[];const _0x2aabff=_0x1cd5f4[_0x298770(0x100)]%0x4==0x0||_0x1cd5f4[_0x298770(0x100)]%0x4==0x3||_0x1cd5f4[_0x298770(0x100)]%0x3==0x1?0x4:0x3;let _0x2e8e36=0x0;_0x1cd5f4[_0x298770(0x249)]((_0x5f461d,_0x45ea99)=>{const _0x55445b=_0x298770;if(_0x45ea99%_0x2aabff==0x0)_0x416d1a=[];_0x416d1a[_0x55445b(0x227)]({'text':_0x55445b(0x1f2)+_0x5f461d['botID'],'callback_data':_0x5f461d['botID']}),_0x45ea99%_0x2aabff==0x0&&(_0x125159[_0x2e8e36]=_0x416d1a,_0x2e8e36++);}),tgBot[_0x298770(0x1b1)](_0x4debdb[_0x298770(0x110)]['id'],_0x298770(0x1f6),{'reply_markup':{'inline_keyboard':_0x125159}})[_0x298770(0x10f)](_0x1483b7=>{telegramError(_0x1483b7);}),tgBot['on'](_0x298770(0x137),async _0x54b2e1=>{const _0x413477=_0x298770,_0xd206aa=_0x54b2e1['data'],_0x5338ea=_0x54b2e1['message'];tgBot[_0x413477(0xb4)](_0x54b2e1['id'])['then'](async()=>{const _0x200c7c=_0x413477;if(pid[_0xd206aa])pid[_0xd206aa]['send']({'function':_0x200c7c(0xb6),'args':null});}),tgBot[_0x413477(0x21c)]('callback_query');});}else{const _0x7c51f5=_0x1cd5f4[0x0]['botID'];if(pid[_0x7c51f5])pid[_0x7c51f5][_0x298770(0x259)]({'function':_0x298770(0xb6),'args':null});}}}),tgBot[_0x3ce337(0xe9)](/\/update/,async _0x462723=>{const _0x25d6ab=_0x3ce337;if(!validateTelegram(_0x462723))return;tgBot[_0x25d6ab(0x21c)]('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x25d6ab(0x1b1)](_0x462723[_0x25d6ab(0x110)]['id'],_0x25d6ab(0x272))['catch'](_0x25f81c=>{telegramError(_0x25f81c);});else!validInstallation?tgBot[_0x25d6ab(0x1b1)](_0x462723[_0x25d6ab(0x110)]['id'],_0x25d6ab(0x26d))[_0x25d6ab(0x10f)](_0x365b54=>{telegramError(_0x365b54);}):(tgBot['sendMessage'](_0x462723[_0x25d6ab(0x110)]['id'],_0x25d6ab(0x1f8),{'reply_markup':{'inline_keyboard':[[{'text':'Yes','callback_data':_0x25d6ab(0x296)},{'text':'No','callback_data':'no'}]]}})[_0x25d6ab(0x10f)](_0xb2a6bd=>{telegramError(_0xb2a6bd);}),tgBot['on']('callback_query',async _0x334dce=>{const _0x2302ce=_0x25d6ab,_0x3bf60e=_0x334dce[_0x2302ce(0x273)],_0x1f70c9=_0x334dce[_0x2302ce(0x13f)];tgBot[_0x2302ce(0xb4)](_0x334dce['id'])[_0x2302ce(0x18b)](async()=>{const _0x2bd249=_0x2302ce;_0x3bf60e==_0x2bd249(0x296)&&(await tgBot[_0x2bd249(0x1b1)](_0x1f70c9['chat']['id'],_0x2bd249(0x145))['catch'](_0x15336e=>{telegramError(_0x15336e);}),updateBB(_0x2bd249(0xde))),_0x3bf60e=='no'&&await tgBot['sendMessage'](_0x1f70c9[_0x2bd249(0x110)]['id'],_0x2bd249(0x107))[_0x2bd249(0x10f)](_0x3c32fe=>{telegramError(_0x3c32fe);});}),tgBot['removeListener'](_0x2302ce(0x137));}));}),tgBot[_0x3ce337(0xe9)](/\/reinstall/,async _0x1eeedd=>{const _0x2f984b=_0x3ce337;if(!validateTelegram(_0x1eeedd))return;tgBot[_0x2f984b(0x21c)](_0x2f984b(0x137)),!validInstallation?tgBot['sendMessage'](_0x1eeedd[_0x2f984b(0x110)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation')[_0x2f984b(0x10f)](_0x895d6b=>{telegramError(_0x895d6b);}):(tgBot[_0x2f984b(0x1b1)](_0x1eeedd['chat']['id'],'Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',{'reply_markup':{'inline_keyboard':[[{'text':_0x2f984b(0x1bf),'callback_data':_0x2f984b(0x296)},{'text':'No','callback_data':'no'}]]}})[_0x2f984b(0x10f)](_0x1a1135=>{telegramError(_0x1a1135);}),tgBot['on'](_0x2f984b(0x137),async _0x30555a=>{const _0x5c3d9e=_0x2f984b,_0x4a4157=_0x30555a['data'],_0x59da4d=_0x30555a[_0x5c3d9e(0x13f)];tgBot[_0x5c3d9e(0xb4)](_0x30555a['id'])[_0x5c3d9e(0x18b)](async()=>{const _0x30bb3a=_0x5c3d9e;_0x4a4157=='yes'&&(await tgBot['sendMessage'](_0x59da4d[_0x30bb3a(0x110)]['id'],_0x30bb3a(0x215))[_0x30bb3a(0x10f)](_0xf0057f=>{telegramError(_0xf0057f);}),updateBB('reinstall')),_0x4a4157=='no'&&await tgBot[_0x30bb3a(0x1b1)](_0x59da4d[_0x30bb3a(0x110)]['id'],_0x30bb3a(0x231))['catch'](_0x560828=>{telegramError(_0x560828);});}),tgBot[_0x5c3d9e(0x21c)](_0x5c3d9e(0x137));}));}),tgBot[_0x3ce337(0xe9)](/\/toggle/,_0xc5cf6b=>{const _0x4ac528=_0x3ce337;if(!validateTelegram(_0xc5cf6b))return;tgBot[_0x4ac528(0x21c)]('callback_query');const _0x5745fb=getBotsWithMode();if(_0x5745fb[_0x4ac528(0x100)]==0x0)tgBot[_0x4ac528(0x1b1)](_0xc5cf6b[_0x4ac528(0x110)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x4ac528(0x10f)](_0x15053a=>{telegramError(_0x15053a);});else{let _0x5eceb6=[],_0x196467=[];const _0x392cb5=0x2;let _0x3f8f59=0x0;_0x5745fb[_0x4ac528(0x249)]((_0x14c60f,_0x5d5ec0)=>{const _0x36a2fe=_0x4ac528;if(_0x5d5ec0%_0x392cb5==0x0)_0x196467=[];_0x196467['push']({'text':_0x36a2fe(0x1f2)+_0x14c60f[_0x36a2fe(0x17f)]+'\x20('+_0x14c60f[_0x36a2fe(0xd2)]+')','callback_data':_0x14c60f[_0x36a2fe(0x17f)]}),_0x5d5ec0%_0x392cb5==0x0&&(_0x5eceb6[_0x3f8f59]=_0x196467,_0x3f8f59++);}),tgBot[_0x4ac528(0x1b1)](_0xc5cf6b[_0x4ac528(0x110)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',{'reply_markup':{'inline_keyboard':_0x5eceb6}})['catch'](_0x4c426b=>{telegramError(_0x4c426b);}),tgBot['on'](_0x4ac528(0x137),async _0x259ee6=>{const _0xb5ba9f=_0x4ac528,_0x1b7dd3=_0x259ee6[_0xb5ba9f(0x273)],_0x5e4a79=_0x259ee6['message'];tgBot['answerCallbackQuery'](_0x259ee6['id'])['then'](async()=>{const _0x30f933=_0xb5ba9f,_0xd5e026=_0x5745fb[_0x30f933(0x163)](_0x27097a=>_0x27097a[_0x30f933(0x17f)]==_0x1b7dd3),_0x6f5546=_0xd5e026[_0x30f933(0xd2)]=='auto'?_0x30f933(0xca):_0x30f933(0x276);tgBot['sendMessage'](_0x5e4a79[_0x30f933(0x110)]['id'],_0x30f933(0x21e)+_0x1b7dd3+_0x30f933(0x283)+_0x6f5546+_0x30f933(0x1c1))[_0x30f933(0x10f)](_0x535b1a=>{telegramError(_0x535b1a);}),toggleBotMode(_0x1b7dd3);}),tgBot[_0xb5ba9f(0x21c)](_0xb5ba9f(0x137));});}}),tgBot[_0x3ce337(0xe9)](/\/names/,_0xb98dc4=>{const _0x176ee0=_0x3ce337;if(!validateTelegram(_0xb98dc4))return;let _0x1f23e4='';config[_0x176ee0(0x249)](_0x194ca9=>{const _0x17187b=_0x176ee0;_0x1f23e4+='Bot\x20'+_0x194ca9[_0x17187b(0x17f)]+':\x20'+_0x194ca9[_0x17187b(0x198)]+'\x0a';}),tgBot[_0x176ee0(0x1b1)](_0xb98dc4[_0x176ee0(0x110)]['id'],_0x1f23e4,{'parse_mode':_0x176ee0(0x17c)})['catch'](_0x570f28=>{telegramError(_0x570f28);});}),tgBot['onText'](/\/disable/,_0x3ead21=>{const _0x4e6a7a=_0x3ce337;if(!validateTelegram(_0x3ead21))return;tgBot[_0x4e6a7a(0x1b1)](_0x3ead21[_0x4e6a7a(0x110)]['id'],'Notifications\x20disabled')[_0x4e6a7a(0x10f)](_0x5b1cdd=>{telegramError(_0x5b1cdd);}),updateSetting(_0x4e6a7a(0xc2),![]);}),tgBot[_0x3ce337(0xe9)](/\/help/,_0x3db160=>{const _0x346c04=_0x3ce337;if(!validateTelegram(_0x3db160))return;tgBot['sendMessage'](_0x3db160[_0x346c04(0x110)]['id'],_0x4df395)[_0x346c04(0x10f)](_0x4415b6=>{telegramError(_0x4415b6);});}),tgBot['on'](_0x3ce337(0x267),_0x51b6d9=>{const _0x1a203b=_0x3ce337;_0x51b6d9[_0x1a203b(0x22b)]()[_0x1a203b(0x142)](_0x1a203b(0x187))&&(logger[_0x1a203b(0x24e)](_0x1a203b(0x288)),tgBot[_0x1a203b(0x119)](),tgBot=null,io['to'](_0x1a203b(0x130))[_0x1a203b(0x1ae)](_0x1a203b(0xdd),'Invalid\x20Telegram\x20token'));}),process['once'](_0x3ce337(0x12c),()=>{const _0x31af24=_0x3ce337;if(tgBot)tgBot[_0x31af24(0x119)]();process[_0x31af24(0x108)](0x1);}),process['once'](_0x3ce337(0xf5),()=>{const _0x3e43db=_0x3ce337;if(tgBot)tgBot[_0x3e43db(0x119)]();process['exit'](0x1);});}}function disableTelegram(){const _0x36f6c3=_0x43bc0b;tgBot&&(tgBot[_0x36f6c3(0x119)](),tgBot=null);}function sendTelegram(_0xc38fa7,_0x93536e){const _0x66cab2=_0x43bc0b;if(settings[_0x66cab2(0xc2)]){if(settings[_0x66cab2(0x134)]==_0x66cab2(0x1dd)||(_0x93536e[_0x66cab2(0x26e)]=='error'||_0x93536e[_0x66cab2(0x26e)]==_0x66cab2(0x1d8)||_0x93536e[_0x66cab2(0x26e)]==_0x66cab2(0xd3))&&settings[_0x66cab2(0x134)]==_0x66cab2(0xd5)||_0x93536e[_0x66cab2(0x26e)]==_0x66cab2(0x228)&&settings[_0x66cab2(0x134)]=='orders'){if(tgBot&&settings['telegramChatId']){if(_0x93536e[_0x66cab2(0x1b8)])tgBot[_0x66cab2(0x1b1)](settings[_0x66cab2(0x104)],_0x93536e[_0x66cab2(0x198)]+'\x20>\x20'+_0x93536e[_0x66cab2(0x297)])[_0x66cab2(0x10f)](_0x2f2190=>{telegramError(_0x2f2190);});else tgBot[_0x66cab2(0x1b1)](settings[_0x66cab2(0x104)],'Bot\x20'+_0xc38fa7+_0x66cab2(0x248)+_0x93536e[_0x66cab2(0x297)])[_0x66cab2(0x10f)](_0x7bdaa4=>{telegramError(_0x7bdaa4);});}}}}async function sendTelegramMsg(_0x592507,_0x4268be=_0x43bc0b(0x17c)){const _0x5710fc=_0x43bc0b;return settings[_0x5710fc(0xc2)]&&tgBot&&settings[_0x5710fc(0x104)]?(await tgBot[_0x5710fc(0x1b1)](settings[_0x5710fc(0x104)],_0x592507,{'parse_mode':_0x4268be})[_0x5710fc(0x10f)](_0xbf4d29=>{telegramError(_0xbf4d29);}),!![]):![];}function getDeviceWithIp(_0x45de0d){return devices['find'](_0x243e5e=>_0x243e5e['ip']===_0x45de0d);}function temporaryAccess2FA(_0x5040d7,_0x1e96d4){const _0x218f5c=_0x43bc0b;let _0x349e4a=new Date(),_0x51d4ec=![];if(lastIpApproval){if(_0x349e4a-lastIpApproval<0x1388)_0x51d4ec=!![];}lastIpApproval=new Date();if(_0x51d4ec)return;tgBot&&settings[_0x218f5c(0x104)]&&(tgBot[_0x218f5c(0x21c)](_0x218f5c(0x137)),tgBot[_0x218f5c(0x1b1)](settings[_0x218f5c(0x104)],_0x218f5c(0x1bb)+normalizeIP(_0x1e96d4)[_0x218f5c(0x11b)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x218f5c(0xc3),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x218f5c(0x266),'callback_data':'reject'}]]}})['catch'](_0x265551=>{telegramError(_0x265551);}),tgBot['on'](_0x218f5c(0x137),async _0x413844=>{const _0x121fb9=_0x218f5c,_0x2ee057=_0x413844['data'],_0x32d390=_0x413844['message'];tgBot['answerCallbackQuery'](_0x413844['id'])[_0x121fb9(0x18b)](async()=>{const _0x23a1d4=_0x121fb9;devices[_0x5040d7][_0x23a1d4(0x17d)]={'clientip':_0x1e96d4,'timestamp':new Date()[_0x23a1d4(0x1de)](),'expiry':_0x2ee057},_0x2ee057!=_0x23a1d4(0x266)?(await tgBot[_0x23a1d4(0x1b1)](_0x32d390['chat']['id'],'Access\x20enabled\x20for\x20'+_0x2ee057+_0x23a1d4(0x222),{'parse_mode':_0x23a1d4(0x17c)})['catch'](_0x45c220=>{telegramError(_0x45c220);}),io['to'](_0x5040d7)[_0x23a1d4(0x1ae)](_0x23a1d4(0x10c),{'access':{'allow':![],'reason':_0x23a1d4(0x13e),'token':null}})):(await tgBot['sendMessage'](_0x32d390[_0x23a1d4(0x110)]['id'],_0x23a1d4(0x23f))[_0x23a1d4(0x10f)](_0x3169a4=>{telegramError(_0x3169a4);}),io['to'](_0x5040d7)[_0x23a1d4(0x1ae)](_0x23a1d4(0x10c),{'access':{'allow':![],'reason':_0x23a1d4(0x135),'token':null}}));}),tgBot[_0x121fb9(0x21c)](_0x121fb9(0x137));}));}function loginAccess2FA(_0x1e71c9,_0x4428fe){const _0x52e935=_0x43bc0b;tgBot&&settings[_0x52e935(0x104)]&&(tgBot[_0x52e935(0x21c)](_0x52e935(0x137)),tgBot[_0x52e935(0x1b1)](settings[_0x52e935(0x104)],_0x52e935(0x19e)+normalizeIP(_0x4428fe)[_0x52e935(0x11b)]+_0x52e935(0x22c),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x52e935(0xab),'callback_data':loginExpiry},{'text':_0x52e935(0x266),'callback_data':_0x52e935(0x266)}]]}})[_0x52e935(0x10f)](_0x3f5fc1=>{telegramError(_0x3f5fc1);}),tgBot['on'](_0x52e935(0x137),async _0x105389=>{const _0x3ed00b=_0x52e935,_0x470a98=_0x105389['data'],_0x2b1c5e=_0x105389['message'];tgBot[_0x3ed00b(0xb4)](_0x105389['id'])[_0x3ed00b(0x18b)](async()=>{const _0x148a40=_0x3ed00b;devices[_0x1e71c9][_0x148a40(0x27a)]={'clientip':_0x4428fe,'timestamp':new Date()['getTime'](),'expiry':_0x470a98},_0x470a98!='reject'?(await tgBot[_0x148a40(0x1b1)](_0x2b1c5e[_0x148a40(0x110)]['id'],_0x148a40(0xcb),{'parse_mode':_0x148a40(0x17c)})[_0x148a40(0x10f)](_0x269ace=>{telegramError(_0x269ace);}),io['to'](_0x1e71c9)['emit'](_0x148a40(0x10c),{'access':{'allow':![],'reason':_0x148a40(0x13e),'token':null}})):(await tgBot[_0x148a40(0x1b1)](_0x2b1c5e[_0x148a40(0x110)]['id'],_0x148a40(0x123))[_0x148a40(0x10f)](_0x3104ce=>{telegramError(_0x3104ce);}),io['to'](_0x1e71c9)[_0x148a40(0x1ae)](_0x148a40(0x10c),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x3ed00b(0x21c)](_0x3ed00b(0x137));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x5b6862=_0x43bc0b;return dbConfig[_0x5b6862(0x180)](_0x5b6862(0xf4))[_0x5b6862(0x1e9)](_0x5b6862(0x17f))['filter']({'status':_0x5b6862(0x19d)})[_0x5b6862(0x1a4)]()||[];}function getDisabledBots(){const _0x2e0590=_0x43bc0b;return dbConfig['get'](_0x2e0590(0xf4))[_0x2e0590(0x1e9)](_0x2e0590(0x17f))[_0x2e0590(0x136)]({'status':'disabled'})[_0x2e0590(0x1a4)]()||[];}function getBotAttributes(_0x3c9a91){const _0x4e4be6=_0x43bc0b;let _0x1f17c4={};const _0x24888b=configpath+_0x4e4be6(0x12e)+_0x3c9a91+_0x4e4be6(0x22f),_0xc6a69e=fs['existsSync'](_0x24888b);if(_0xc6a69e){const _0x22acb8=fs[_0x4e4be6(0x1c0)](_0x24888b);try{const _0x4d670a=JSON[_0x4e4be6(0xc8)](_0x22acb8),_0x4ad6bc=_0x4d670a?_0x4d670a[_0x4e4be6(0xc5)][0x0][_0x4e4be6(0x115)]:![];_0x1f17c4[_0x4e4be6(0xd2)]=_0x4ad6bc?_0x4e4be6(0x276):_0x4e4be6(0xca),_0x1f17c4[_0x4e4be6(0x198)]=_0x4d670a?_0x4d670a[_0x4e4be6(0xc5)][0x0]['botname']:_0x4e4be6(0x1f2)+_0x3c9a91;}catch(_0x38b88c){_0x1f17c4[_0x4e4be6(0xd2)]=_0x4e4be6(0xca),_0x1f17c4[_0x4e4be6(0x198)]=_0x4e4be6(0x1f2)+_0x3c9a91;}}else _0x1f17c4[_0x4e4be6(0xd2)]=_0x4e4be6(0xca),_0x1f17c4[_0x4e4be6(0x198)]=_0x4e4be6(0x1f2)+_0x3c9a91;return _0x1f17c4;}function getBotsWithMode(){const _0x11d86c=_0x43bc0b,_0x5b38ec=dbConfig[_0x11d86c(0x180)](_0x11d86c(0xf4))['sortBy'](_0x11d86c(0x17f))[_0x11d86c(0x1a4)]()||[];return _0x5b38ec['forEach'](_0x44682e=>{const _0x14fdf9=_0x11d86c;let _0x25e273=getBotAttributes(_0x44682e['botID']);_0x44682e[_0x14fdf9(0xd2)]=_0x25e273['mode'];}),_0x5b38ec;}function getBotExchanges(){const _0x4a0128=_0x43bc0b;let _0x1207f6=[];const _0x4eda64=dbConfig['get'](_0x4a0128(0xf4))[_0x4a0128(0x1e9)]('botID')[_0x4a0128(0x1a4)]()||[];_0x4eda64[_0x4a0128(0x249)](_0x3a82ad=>{const _0xc78871=_0x4a0128;if(_0x3a82ad[_0xc78871(0x10c)]==_0xc78871(0x19d)){const _0x131d67=configpath+_0xc78871(0x12e)+_0x3a82ad['botID']+'-config.json',_0x311de3=fs[_0xc78871(0x1d7)](_0x131d67);let _0x3fb1e1;if(_0x311de3){const _0x515063=fs[_0xc78871(0x1c0)](_0x131d67);try{const _0x30deca=JSON[_0xc78871(0xc8)](_0x515063);_0x3fb1e1=_0x30deca?_0x30deca['bot'][0x0][_0xc78871(0x295)]:null;}catch(_0x1e2d42){}}if(_0x3fb1e1)_0x1207f6[_0xc78871(0x227)](_0x3fb1e1);}});const _0x1a7b68=[...new Set(_0x1207f6)]['sort']();return _0x1a7b68;}async function initUser(){const _0x48be32=_0x43bc0b;if(!settings[_0x48be32(0xb0)]){const _0x3aa59a=uuidRandom();mixpanel[_0x48be32(0x257)](_0x3aa59a),updateSetting(_0x48be32(0xb0),_0x3aa59a);}}async function initSecure(){const _0x2c4892=_0x43bc0b;let _0x3ac7fd=getSecure();if(!_0x3ac7fd['hasOwnProperty'](_0x2c4892(0x290))){let _0x26c701=await generateKeys();_0x3ac7fd['publicKey']=_0x26c701[_0x2c4892(0x1e0)],_0x3ac7fd[_0x2c4892(0xdf)]=_0x26c701[_0x2c4892(0xdf)],_0x3ac7fd[_0x2c4892(0x290)]=crypto['randomBytes'](0x20)[_0x2c4892(0x22b)](_0x2c4892(0xeb));;storeSecure(_0x3ac7fd);}}function getSettings(){const _0x51c68f=_0x43bc0b;return dbSettings[_0x51c68f(0x180)](_0x51c68f(0x25b))[_0x51c68f(0x1a4)]()||{};}function getSecure(){const _0x31cd03=_0x43bc0b;return dbSecure[_0x31cd03(0x180)]('secure')[_0x31cd03(0x1a4)]()||{};}function getBlacklist(){const _0x37f009=_0x43bc0b;return dbSecure['get'](_0x37f009(0x1f9))[_0x37f009(0x1a4)]()||[];}function broadcastToBots(_0x1666c8,_0x23ec9a){const _0x27c98f=_0x43bc0b;config[_0x27c98f(0x249)](_0x21d90a=>{const _0x5895ab=_0x27c98f;if(_0x21d90a[_0x5895ab(0x10c)]==_0x5895ab(0x19d)&&_0x21d90a[_0x5895ab(0x287)]==_0x5895ab(0x237)||_0x21d90a[_0x5895ab(0x10c)]==_0x5895ab(0x188)&&_0x21d90a['live']=='running'){if(pid[_0x21d90a['botID']])pid[_0x21d90a[_0x5895ab(0x17f)]][_0x5895ab(0x259)]({[_0x1666c8]:_0x23ec9a});}});}function storeSettings(_0xdcf134,_0x2fdb61=![]){const _0x5d69d8=_0x43bc0b;_0xdcf134={...settings,..._0xdcf134};if(_0x2fdb61&&_0xdcf134['bbPassword']!=_0x5d69d8(0x15d)&&_0xdcf134[_0x5d69d8(0x278)]!=_0x5d69d8(0x1f4)&&_0xdcf134[_0x5d69d8(0x278)]!=''){const _0x4c3be8=crypt[_0x5d69d8(0x241)](secure[_0x5d69d8(0xdf)],_0xdcf134[_0x5d69d8(0x278)])[_0x5d69d8(0x13f)][_0x5d69d8(0x18e)]('@')[0x0],_0x3114d3=bcrypt['hashSync'](_0x4c3be8,saltRounds);_0xdcf134={..._0xdcf134,'bbPassword':_0x3114d3};}if(_0x2fdb61&&_0xdcf134[_0x5d69d8(0xd6)]!='************'&&_0xdcf134['telegramToken']!=_0x5d69d8(0x1f4)&&_0xdcf134[_0x5d69d8(0xd6)]!=''){const _0x9f233f=crypt[_0x5d69d8(0x241)](secure[_0x5d69d8(0xdf)],_0xdcf134['telegramToken'])[_0x5d69d8(0x13f)][_0x5d69d8(0x18e)]('@')[0x0];_0xdcf134={..._0xdcf134,'telegramToken':_0x9f233f};}const _0x372983=_0xdcf134[_0x5d69d8(0xd6)]!=_0x5d69d8(0x15d)&&_0xdcf134[_0x5d69d8(0xd6)]!=settings[_0x5d69d8(0xd6)]||_0xdcf134[_0x5d69d8(0xd9)]!=settings[_0x5d69d8(0xd9)],_0x521f0f=_0xdcf134['telegramToken']==''||_0xdcf134[_0x5d69d8(0xd9)]=='';if(_0x372983)_0xdcf134[_0x5d69d8(0x134)]='all';for(const [_0x1b950f,_0x121353]of Object[_0x5d69d8(0x235)](_0xdcf134)){if(_0x1b950f==_0x5d69d8(0xd6)&&_0x121353==_0x5d69d8(0x15d)){_0xdcf134[_0x5d69d8(0xd6)]=settings[_0x5d69d8(0xd6)];continue;};if(_0x1b950f==_0x5d69d8(0x278)&&_0x121353=='************'){_0xdcf134[_0x5d69d8(0x278)]=settings[_0x5d69d8(0x278)];continue;};dbSettings[_0x5d69d8(0x291)](_0x5d69d8(0x12d)+_0x1b950f,_0x121353)[_0x5d69d8(0x28c)]();}settings=_0xdcf134,io['to'](_0x5d69d8(0x130))[_0x5d69d8(0x1ae)](_0x5d69d8(0x25b),cleanSettings()),broadcastToBots(_0x5d69d8(0x1df),settings[_0x5d69d8(0x1df)]),broadcastToBots(_0x5d69d8(0x229),settings[_0x5d69d8(0x229)]);if(_0x372983&&!_0x521f0f)initTelegram();if(_0x372983&&_0x521f0f)disableTelegram();getAllClients()[_0x5d69d8(0x249)](_0x38d67=>{const _0x31bc3c=_0x5d69d8;getSocket(_0x38d67['id'])[_0x31bc3c(0x1ae)](_0x31bc3c(0x10c),{'access':{'allow':![],'reason':_0x31bc3c(0x13e),'token':null}});});}function updateSetting(_0x378ce8,_0x2e8148){const _0x3e9de6=_0x43bc0b;dbSettings[_0x3e9de6(0x291)](_0x3e9de6(0x12d)+_0x378ce8,_0x2e8148)[_0x3e9de6(0x28c)](),settings=getSettings(),io['to'](_0x3e9de6(0x130))[_0x3e9de6(0x1ae)](_0x3e9de6(0x25b),cleanSettings());}function storeSecure(_0x5e841c){const _0x59bf37=_0x43bc0b;dbSecure[_0x59bf37(0x180)](_0x59bf37(0xef))[_0x59bf37(0x227)](_0x5e841c)[_0x59bf37(0x28c)](),secure=_0x5e841c;}function addBlacklist(_0x3ccbd6){const _0x5e2491=_0x43bc0b;cleanBlacklist();let _0x4c0958;devices[_0x3ccbd6]['telegramIpApproval']?_0x4c0958=Math[_0x5e2491(0x11a)](devices[_0x3ccbd6][_0x5e2491(0x17d)]['expiry'],loginExpiry):_0x4c0958=loginExpiry,dbSecure['get'](_0x5e2491(0x1f9))[_0x5e2491(0x227)]({'expiry':new Date()['getTime']()+_0x4c0958*0x3c*0x3e8,'token':devices[_0x3ccbd6][_0x5e2491(0xe6)][_0x5e2491(0x11c)]})[_0x5e2491(0x28c)](),blacklist=dbSecure['get']('blacklist')[_0x5e2491(0x1a4)]();}function cleanBlacklist(){const _0x44dba2=_0x43bc0b;let _0x3733f2=dbSecure[_0x44dba2(0x180)](_0x44dba2(0x1f9))['cloneDeep']()[_0x44dba2(0x1a4)](),_0xf24cdf=new Date()[_0x44dba2(0x1de)]();_0x3733f2[_0x44dba2(0x249)](_0x4aa9a0=>{const _0x4265e3=_0x44dba2;_0x4aa9a0[_0x4265e3(0x160)]<_0xf24cdf&&dbSecure[_0x4265e3(0x180)](_0x4265e3(0x1f9))[_0x4265e3(0x11d)]({'expiry':_0x4aa9a0[_0x4265e3(0x160)]})[_0x4265e3(0x28c)]();});}function initStates(){const _0x1be91a=_0x43bc0b;let _0x28ef81=getConfiguration();_0x28ef81[_0x1be91a(0x249)](_0xd640f7=>{const _0x43fc23=_0x1be91a;_0xd640f7['live']=_0x43fc23(0x1cf);}),storeConfiguration(_0x28ef81);}function onKeys(){const _0x4adae1=new RSA();return new Promise(_0x56f63e=>{const _0x2255fe=_0x2e49;_0x4adae1[_0x2255fe(0x1af)]()['then'](_0x3316ab=>{_0x56f63e(_0x3316ab);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x39a8d5=_0x43bc0b;let _0x2bcce2=getSettings(),_0x2c0aa8=![];!_0x2bcce2[_0x39a8d5(0x193)](_0x39a8d5(0x178))&&(_0x2bcce2['lastmsgtelegram']=0x0,_0x2c0aa8=!![]);!_0x2bcce2[_0x39a8d5(0x193)](_0x39a8d5(0x255))&&(_0x2bcce2[_0x39a8d5(0x255)]=0x0,_0x2c0aa8=!![]);!_0x2bcce2['hasOwnProperty'](_0x39a8d5(0xad))&&(_0x2bcce2['latestversion']=_0x39a8d5(0xc4),_0x2c0aa8=!![]);!_0x2bcce2[_0x39a8d5(0x193)](_0x39a8d5(0x229))&&(_0x2bcce2[_0x39a8d5(0x229)]=![],_0x2c0aa8=!![]);if(_0x2c0aa8)storeSettings(_0x2bcce2);try{fs[_0x39a8d5(0x1d0)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x266ae6=>{const _0x5cba4a=_0x39a8d5;if(!_0x266ae6[_0x5cba4a(0x213)]()){if(!_0x266ae6[_0x5cba4a(0x194)][_0x5cba4a(0x16a)](_0x5cba4a(0x1b2)))fs[_0x5cba4a(0x25c)](configbackuppath+_0x266ae6[_0x5cba4a(0x194)]);}else fs[_0x5cba4a(0x14b)](configbackuppath+_0x266ae6['name'],{'recursive':!![]});});}catch(_0x3f5206){logger[_0x39a8d5(0x12b)](_0x39a8d5(0x27e),_0x3f5206);}}function storeConfiguration(_0x411a5e){const _0x15e879=_0x43bc0b;dbConfig[_0x15e879(0x180)]('bots')[_0x15e879(0x11d)]()[_0x15e879(0x28c)](),_0x411a5e[_0x15e879(0x249)](_0xd02201=>{const _0x212a87=_0x15e879;delete _0xd02201[_0x212a87(0xd2)];}),dbConfig[_0x15e879(0x180)](_0x15e879(0xf4))[_0x15e879(0x227)](..._0x411a5e)[_0x15e879(0x28c)](),config=_0x411a5e;}function resetPassword(){const _0x4157dd=_0x43bc0b;tgBot&&settings[_0x4157dd(0x104)]&&(tgBot[_0x4157dd(0x21c)]('callback_query'),tgBot[_0x4157dd(0x1b1)](settings[_0x4157dd(0x104)],_0x4157dd(0x209),{'parse_mode':_0x4157dd(0x17c),'reply_markup':{'inline_keyboard':[[{'text':_0x4157dd(0x296),'callback_data':_0x4157dd(0x296)},{'text':'no','callback_data':'no'}]]}})[_0x4157dd(0x10f)](_0x236fa3=>{telegramError(_0x236fa3);}),tgBot['on']('callback_query',async _0xa47de2=>{const _0x544702=_0x4157dd,_0x5222d5=_0xa47de2[_0x544702(0x273)],_0x19d9f1=_0xa47de2[_0x544702(0x13f)];tgBot[_0x544702(0xb4)](_0xa47de2['id'])[_0x544702(0x18b)](async()=>{const _0x2a3f2e=_0x544702;if(_0x5222d5!='no'){const _0x1bd0ff=0xf,_0x176bb8=_0x2a3f2e(0x26b),_0x223979=Array['from'](crypto[_0x2a3f2e(0x21b)](new Uint32Array(_0x1bd0ff)))[_0x2a3f2e(0x20b)](_0x9e3748=>_0x176bb8[_0x9e3748%_0x176bb8[_0x2a3f2e(0x100)]])[_0x2a3f2e(0x21d)](''),_0x88de14=bcrypt[_0x2a3f2e(0x1f7)](_0x223979,saltRounds);storeSettings({'bbPassword':_0x88de14}),await tgBot[_0x2a3f2e(0x1b1)](_0x19d9f1['chat']['id'],_0x2a3f2e(0xe1)+_0x223979,{'parse_mode':_0x2a3f2e(0x17c)})[_0x2a3f2e(0x10f)](_0x42a4d7=>{telegramError(_0x42a4d7);});}else await tgBot[_0x2a3f2e(0x1b1)](_0x19d9f1[_0x2a3f2e(0x110)]['id'],_0x2a3f2e(0x17a))[_0x2a3f2e(0x10f)](_0x5594a5=>{telegramError(_0x5594a5);});}),tgBot['removeListener'](_0x544702(0x137));}));}async function confirmRestore(_0x214c0b,_0x3b6b8d){const _0x48f900=_0x43bc0b;io['to'](_0x48f900(0x130))[_0x48f900(0x1ae)](_0x48f900(0xdd),_0x48f900(0x153),_0x48f900(0xd3)),tgBot&&settings[_0x48f900(0x104)]&&(tgBot[_0x48f900(0x21c)]('callback_query'),await tgBot[_0x48f900(0x1b1)](settings['telegramChatId'],_0x48f900(0x129),{'parse_mode':_0x48f900(0x17c),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x48f900(0x10f)](_0x12457f=>{telegramError(_0x12457f);}),tgBot['on'](_0x48f900(0x137),async _0x1a7508=>{const _0x6b31a1=_0x48f900,_0x1f2c6c=_0x1a7508[_0x6b31a1(0x273)],_0x470069=_0x1a7508['message'];tgBot[_0x6b31a1(0xb4)](_0x1a7508['id'])['then'](async()=>{const _0x394d1a=_0x6b31a1;_0x1f2c6c==_0x394d1a(0x296)?(await tgBot['sendMessage'](_0x470069['chat']['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x394d1a(0x17c)})[_0x394d1a(0x10f)](_0x53c648=>{telegramError(_0x53c648);}),unzipFile(_0x214c0b,_0x3b6b8d)):(logger[_0x394d1a(0x12b)](_0x394d1a(0x24c)),await tgBot[_0x394d1a(0x1b1)](_0x470069[_0x394d1a(0x110)]['id'],_0x394d1a(0x24c))['catch'](_0x1e4635=>{telegramError(_0x1e4635);}));}),tgBot[_0x6b31a1(0x21c)](_0x6b31a1(0x137));}));}function getServerTime(){const _0x865d26=_0x43bc0b,_0x50fbe8=new Date();return _0x50fbe8[_0x865d26(0xba)]()+'/'+(_0x50fbe8[_0x865d26(0xdb)]()+0x1)['toString']()[_0x865d26(0x101)](0x2,'0')+'/'+_0x50fbe8['getDate']()[_0x865d26(0x22b)]()[_0x865d26(0x101)](0x2,'0')+'\x20'+_0x50fbe8['getHours']()['toString']()[_0x865d26(0x101)](0x2,'0')+':'+_0x50fbe8[_0x865d26(0xcd)]()[_0x865d26(0x22b)]()[_0x865d26(0x101)](0x2,'0')+':'+_0x50fbe8[_0x865d26(0x210)]()[_0x865d26(0x22b)]()[_0x865d26(0x101)](0x2,'0');}function getTimeStamp(){const _0x5dc88d=_0x43bc0b,_0x712a7e=shiftedTime();return _0x712a7e['getFullYear']()+'/'+(_0x712a7e[_0x5dc88d(0xdb)]()+0x1)[_0x5dc88d(0x22b)]()['padStart'](0x2,'0')+'/'+_0x712a7e['getDate']()['toString']()[_0x5dc88d(0x101)](0x2,'0')+'\x20'+_0x712a7e[_0x5dc88d(0xfc)]()['toString']()['padStart'](0x2,'0')+':'+_0x712a7e[_0x5dc88d(0xcd)]()[_0x5dc88d(0x22b)]()['padStart'](0x2,'0')+':'+_0x712a7e['getSeconds']()['toString']()[_0x5dc88d(0x101)](0x2,'0');}function getCleanTimeStamp(){const _0x501ce8=_0x43bc0b,_0x4004f8=shiftedTime();return _0x4004f8[_0x501ce8(0xba)]()+(_0x4004f8['getMonth']()+0x1)[_0x501ce8(0x22b)]()['padStart'](0x2,'0')+_0x4004f8['getDate']()['toString']()['padStart'](0x2,'0')+'-'+_0x4004f8[_0x501ce8(0xfc)]()[_0x501ce8(0x22b)]()[_0x501ce8(0x101)](0x2,'0')+_0x4004f8['getMinutes']()['toString']()[_0x501ce8(0x101)](0x2,'0')+_0x4004f8[_0x501ce8(0x210)]()[_0x501ce8(0x22b)]()[_0x501ce8(0x101)](0x2,'0');}function shiftedTime(){const _0x381299=_0x43bc0b,_0x416901=new Date();let _0x351cf3=_0x416901;if(settings[_0x381299(0x1df)]&&settings['timeshift']!==0x0)_0x351cf3=fns[_0x381299(0x122)](_0x416901,{'hours':settings[_0x381299(0x1df)]});return _0x351cf3;}function startScheduler(){const _0x4a3982=_0x43bc0b,_0x3a6651=new Date()[_0x4a3982(0xe7)](),_0x439410=shiftedTime()[_0x4a3982(0xfc)]();_0x439410==0x4&&backupConfigFiles();_0x439410==0x0&&rotateLogFiles();_0x3a6651%0x6==0x0&&triggerAnalytics();_0x3a6651%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x2d3239){const _0x46b42c=_0x43bc0b;logger[_0x46b42c(0x12b)](_0x46b42c(0xe2)+_0x2d3239);const _0x2ef3bc=getBotsWithMode();_0x2ef3bc[_0x46b42c(0x100)]>0x0?confirmRestore(configbackuppath,_0x2d3239):unzipFile(configbackuppath,_0x2d3239);}async function getBackupFiles(_0x5f4f97=null){const _0x1d803c=_0x43bc0b;let _0x4b6b3f=[],_0x340cb3=fs[_0x1d803c(0x1d0)](configbackuppath,{'withFileTypes':!![]});_0x340cb3[_0x1d803c(0x143)]((_0x4df054,_0x93597e)=>_0x4df054['name']<_0x93597e['name']?0x1:_0x93597e[_0x1d803c(0x194)]<_0x4df054[_0x1d803c(0x194)]?-0x1:0x0),_0x340cb3[_0x1d803c(0x249)](_0x3779c9=>{const _0x4b4d57=_0x1d803c;if(!_0x3779c9[_0x4b4d57(0x213)]()&&_0x3779c9[_0x4b4d57(0x194)][_0x4b4d57(0x16a)]('backup-full@')&&_0x3779c9[_0x4b4d57(0x194)][_0x4b4d57(0x1e7)](_0x4b4d57(0x19c))){const _0x236aaa=formatDate(fs[_0x4b4d57(0x1d1)](configbackuppath+_0x3779c9[_0x4b4d57(0x194)])[_0x4b4d57(0x1ce)]);_0x4b6b3f[_0x4b4d57(0x227)]({'name':_0x3779c9['name'],'mtime':_0x236aaa});}});if(_0x5f4f97)io['to'](_0x5f4f97)['emit'](_0x1d803c(0x118),_0x4b6b3f);else return _0x4b6b3f;}async function backupConfigFiles(){const _0x2b5889=_0x43bc0b;await zipFiles(_0x2b5889(0x151));const _0x559dad=getCleanTimeStamp();fs[_0x2b5889(0x125)](zippath+_0x2b5889(0x18c),configbackuppath+('backup-full@'+_0x559dad+_0x2b5889(0x19c)));let _0xf2a4b0=fs[_0x2b5889(0x1d0)](configbackuppath,{'withFileTypes':!![]});_0xf2a4b0[_0x2b5889(0x143)]((_0x2f2768,_0x3beb86)=>_0x2f2768[_0x2b5889(0x194)]<_0x3beb86[_0x2b5889(0x194)]?0x1:_0x3beb86['name']<_0x2f2768[_0x2b5889(0x194)]?-0x1:0x0),_0xf2a4b0['length']>maxBackups&&fs[_0x2b5889(0x25c)](configbackuppath+_0xf2a4b0[_0xf2a4b0['length']-0x1][_0x2b5889(0x194)]);}function rotateLogFiles(){const _0x464bb9=_0x43bc0b,_0x318ff7=fs[_0x464bb9(0x1d1)](logspath+_0x464bb9(0x169)),_0x3160ce=_0x318ff7['size']/0x400;if(_0x3160ce>0x64){let _0x309ca0=fs[_0x464bb9(0x1d0)](logspath,{'withFileTypes':!![]});_0x309ca0['sort']((_0x16b21d,_0x3b132a)=>_0x16b21d[_0x464bb9(0x194)]<_0x3b132a['name']?0x1:_0x3b132a[_0x464bb9(0x194)]<_0x16b21d['name']?-0x1:0x0),_0x309ca0[_0x464bb9(0x249)](_0x4965e7=>{const _0x299605=_0x464bb9;if(_0x4965e7[_0x299605(0x194)]==_0x299605(0x1a2))fs['copyFileSync'](logspath+_0x4965e7['name'],logspath+'output-003.log');if(_0x4965e7['name']==_0x299605(0x155))fs['copyFileSync'](logspath+_0x4965e7[_0x299605(0x194)],logspath+_0x299605(0x1a2));_0x4965e7[_0x299605(0x194)]==_0x299605(0x169)&&(fs[_0x299605(0x125)](logspath+_0x4965e7[_0x299605(0x194)],logspath+'output-001.log'),fs['writeFileSync'](logspath+_0x4965e7[_0x299605(0x194)],''));});}}async function zipFiles(_0x2d7fd8){const _0x3df864=_0x43bc0b;let _0x21fa32;if(_0x2d7fd8==_0x3df864(0x18d))_0x21fa32=logspath;if(_0x2d7fd8==_0x3df864(0x184))_0x21fa32=configpath;if(_0x2d7fd8==_0x3df864(0x151))_0x21fa32=configpath;let _0x222afd=fs['readdirSync'](_0x21fa32,{'withFileTypes':!![]});const _0x7de6a7=new require(_0x3df864(0x13b))();_0x222afd['forEach'](_0x130ff3=>{const _0xb4fd5a=_0x3df864;if(!_0x130ff3[_0xb4fd5a(0x213)]()){let _0x4840e4=fs['readFileSync'](_0x21fa32+_0x130ff3[_0xb4fd5a(0x194)]);if(_0x2d7fd8==_0xb4fd5a(0x184)){const _0x407efc=/^bot-[0-9]{3}-config.json$/,_0x22102b=_0x407efc[_0xb4fd5a(0x1e4)](_0x130ff3['name']);if(_0x22102b){const _0x2748bc=JSON[_0xb4fd5a(0xc8)](_0x4840e4);if(_0x2748bc[_0xb4fd5a(0xc5)][0x0]){_0x2748bc[_0xb4fd5a(0xc5)][0x0][_0xb4fd5a(0x23a)]=_0xb4fd5a(0x1f4),_0x2748bc[_0xb4fd5a(0xc5)][0x0]['apiSecret']=_0xb4fd5a(0x1f4);if(_0x2748bc['bot'][0x0][_0xb4fd5a(0xfa)])_0x2748bc['bot'][0x0][_0xb4fd5a(0xfa)]='***';}_0x4840e4=JSON[_0xb4fd5a(0x260)](_0x2748bc,null,0x2);}if(_0x130ff3[_0xb4fd5a(0x194)]==_0xb4fd5a(0x224)){const _0x32f297=JSON[_0xb4fd5a(0xc8)](_0x4840e4);if(_0x32f297[_0xb4fd5a(0x25b)][_0xb4fd5a(0x22a)])_0x32f297[_0xb4fd5a(0x25b)][_0xb4fd5a(0x22a)]=![];if(_0x32f297['settings'][_0xb4fd5a(0x278)])_0x32f297[_0xb4fd5a(0x25b)][_0xb4fd5a(0x278)]=_0xb4fd5a(0x1f4);if(_0x32f297[_0xb4fd5a(0x25b)][_0xb4fd5a(0xd6)])_0x32f297[_0xb4fd5a(0x25b)][_0xb4fd5a(0xd6)]='***';if(_0x32f297[_0xb4fd5a(0x25b)][_0xb4fd5a(0x104)])_0x32f297[_0xb4fd5a(0x25b)][_0xb4fd5a(0x104)]=null;_0x4840e4=JSON[_0xb4fd5a(0x260)](_0x32f297,null,0x2);}if(_0x130ff3[_0xb4fd5a(0x194)]!=_0xb4fd5a(0x20f))_0x7de6a7[_0xb4fd5a(0x1d3)](_0x130ff3[_0xb4fd5a(0x194)],_0x4840e4);}else _0x7de6a7[_0xb4fd5a(0x1d3)](_0x130ff3[_0xb4fd5a(0x194)],_0x4840e4);}});const _0x2e5f1b=_0x7de6a7[_0x3df864(0x1a5)]({'base64':![],'compression':_0x3df864(0x15b)});fs['writeFileSync'](zippath+(_0x2d7fd8+'.zip'),_0x2e5f1b,_0x3df864(0x232));}async function unzipFile(_0x500199,_0x361310){const _0x3e4962=_0x43bc0b;fs[_0x3e4962(0x1d0)](configpath,{'withFileTypes':!![]})[_0x3e4962(0x249)](_0x5d6677=>{const _0x294cf1=_0x3e4962;if(!_0x5d6677[_0x294cf1(0x213)]())fs[_0x294cf1(0x14b)](configpath+_0x5d6677[_0x294cf1(0x194)]);});const _0x8b7718=fs[_0x3e4962(0x1c0)](_0x500199+_0x361310,_0x3e4962(0x232)),_0x45f96c=new require('node-zip')(_0x8b7718,{'base64':![],'checkCRC32':!![]});Object[_0x3e4962(0x109)](_0x45f96c[_0x3e4962(0x1aa)])[_0x3e4962(0x249)](_0x53fbc4=>{const _0x277f43=_0x3e4962,_0x534bab=_0x45f96c[_0x277f43(0x1aa)][_0x53fbc4];fs['writeFileSync'](configpath+_0x534bab[_0x277f43(0x194)],_0x534bab[_0x277f43(0xce)]);}),fs[_0x3e4962(0x1d0)](temppath,{'withFileTypes':!![]})[_0x3e4962(0x249)](_0x68504=>{const _0x47cd42=_0x3e4962;if(!_0x68504[_0x47cd42(0x213)]())fs['rmSync'](temppath+_0x68504[_0x47cd42(0x194)]);}),logger['debug'](_0x3e4962(0x17e)),process['send']({'restore':!![]},_0x334f7f=>{});}async function getPublicIp(){const _0x129af9=_0x43bc0b;try{const _0x1abcc5=await axios[_0x129af9(0x180)](_0x129af9(0xf6));publicip=_0x1abcc5[_0x129af9(0x273)]['ip'];}catch(_0x3eb69b){}}async function triggerAnalytics(){const _0x9dc3f8=_0x43bc0b;if(!publicip)await getPublicIp();const _0x2cca0d=getBotsWithMode();let _0x3279fb=0x0;_0x2cca0d[_0x9dc3f8(0x249)](_0xc1c5d=>{const _0x4cec75=_0x9dc3f8;if(_0xc1c5d[_0x4cec75(0x10c)]===_0x4cec75(0x19d))_0x3279fb++;});const _0x5dc654=getBotExchanges();mixpanel[_0x9dc3f8(0x1c9)](_0x9dc3f8(0x1a7),{'distinct_id':settings[_0x9dc3f8(0xb0)],'ip':publicip,'version':serverversion,'numbots':_0x2cca0d[_0x9dc3f8(0x100)],'numbotsenabled':_0x3279fb,'exchanges':_0x5dc654});}async function getMessages(){const _0x918a87=_0x43bc0b,_0x475ed4=_0x918a87(0x20e),_0x37cb3b=new GraphQLClient(_0x475ed4),_0x2bf633={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x2892b7=serverversion['split']('.'),_0x26371b=_0x2892b7[0x0]+'.'+_0x2892b7[0x1],_0x2ce8db=Math['min'](settings['lastmsgtelegram'],settings[_0x918a87(0x255)]),_0x21c335={'last':parseInt(_0x2ce8db),'bbm':_0x26371b},_0x1edeaa=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x2d704a;try{_0x2d704a=await _0x37cb3b[_0x918a87(0x121)](_0x1edeaa,_0x21c335,_0x2bf633);}catch(_0x50c004){}if(_0x2d704a&&_0x2d704a[_0x918a87(0x1e8)]){let _0x3c7ac0=settings[_0x918a87(0x178)];newMessages=[];for(const _0x230ae1 of _0x2d704a[_0x918a87(0x1e8)]){newMessages[_0x918a87(0x227)](_0x230ae1);if(_0x230ae1['bbvNew'])updateSetting(_0x918a87(0xad),_0x230ae1[_0x918a87(0x242)]);let _0x365f68=_0x230ae1[_0x918a87(0x242)]?serverversion>=_0x230ae1['bbvNew']:![];if(!_0x365f68&&_0x230ae1[_0x918a87(0x164)]>_0x3c7ac0){if(_0x230ae1['bbvReceive']==='any'||serverversion[_0x918a87(0x16a)](_0x230ae1[_0x918a87(0xac)])){let _0x2938b5=''+_0x230ae1[_0x918a87(0x1c5)]+'\x0a\x0a'+_0x230ae1['message'];const _0x182cc3=await sendTelegramMsg(toTelegramMarkdown(_0x2938b5),_0x918a87(0x15e));if(_0x182cc3)_0x3c7ac0=_0x230ae1[_0x918a87(0x164)];}}}updateAvailable=isNewerVersion(settings[_0x918a87(0xad)],serverversion),updateSetting('lastmsgtelegram',_0x3c7ac0),emitMessages();}}function emitMessages(){const _0x6c2072=_0x43bc0b,_0x293639=settings[_0x6c2072(0x255)];let _0x1d7626=[];newMessages[_0x6c2072(0x249)](_0x4aa3f1=>{const _0x30bd0d=_0x6c2072;_0x4aa3f1['number']>_0x293639&&_0x1d7626[_0x30bd0d(0x227)](_0x4aa3f1);}),_0x1d7626[_0x6c2072(0x100)]>0x0&&getAllClients()['forEach'](_0x114623=>{const _0x16fe74=_0x6c2072;getSocket(_0x114623['id'])[_0x16fe74(0x1ae)](_0x16fe74(0x13f),_0x1d7626);});}function confirmMessage(_0x15d4de){const _0x2369b8=_0x43bc0b;updateSetting(_0x2369b8(0x255),Number(_0x15d4de));}function isNewerVersion(_0x53296c,_0x26c9c9){const _0x20c423=_0x43bc0b,_0x5f2e1b=_0x26c9c9[_0x20c423(0x18e)]('.'),_0x2db47e=_0x53296c['split']('.');for(var _0x5327c2=0x0;_0x5327c2<_0x2db47e[_0x20c423(0x100)];_0x5327c2++){const _0x57f4c8=~~_0x2db47e[_0x5327c2],_0x324f56=~~_0x5f2e1b[_0x5327c2];if(_0x57f4c8>_0x324f56)return!![];if(_0x57f4c8<_0x324f56)return![];}return![];}function toTelegramMarkdown(_0xbfb12b){const _0x3fe415=_0x43bc0b,_0x57a509=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x1fe3b0=/\*{2}(.+?)\*{2}/gim;return _0xbfb12b=_0xbfb12b[_0x3fe415(0x20c)](_0x57a509,_0x3fe415(0xd8))[_0x3fe415(0x20c)](_0x1fe3b0,'*$1*'),_0xbfb12b;}async function validateConfigFile(){const _0x5b4d9c=_0x43bc0b,_0x1180ab=dbConfig[_0x5b4d9c(0x180)](_0x5b4d9c(0xf4))[_0x5b4d9c(0x1e9)](_0x5b4d9c(0x17f))['value']()||[];if(_0x1180ab[_0x5b4d9c(0x100)]==0x0){let _0x54be7b=0x0,_0x57655e=[];const _0xc18245=/^bot-([0-9]{3})-config.json$/,_0x1208c0=fs[_0x5b4d9c(0x1d0)](configpath);_0x1208c0[_0x5b4d9c(0x249)](_0x2d3a69=>{const _0x839718=_0x5b4d9c,_0x1c6d57=_0xc18245[_0x839718(0x10b)](_0x2d3a69);if(_0x1c6d57){const _0x362ab5=_0x1c6d57[0x1];let _0x64993b=getBotAttributes(_0x362ab5);_0x57655e[_0x839718(0x227)]({'botID':_0x362ab5,'botname':_0x64993b[_0x839718(0x198)],'status':_0x839718(0x172),'live':'stopped'}),_0x54be7b++;}}),_0x54be7b!=0x0&&(dbConfig['get']('bots')['assign'](_0x57655e)['write'](),config=_0x57655e,restoredConfigFile=_0x54be7b);}}async function restoreConfigNotify(_0x3be20d){const _0x4e5c3a=_0x43bc0b;let _0x19cffc;if(restoredConfigFile==0x1)_0x19cffc='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x19cffc=_0x4e5c3a(0x1cd);if(_0x3be20d)io['to'](_0x4e5c3a(0x130))[_0x4e5c3a(0x1ae)](_0x4e5c3a(0xdd),_0x19cffc);else{logger[_0x4e5c3a(0x263)](_0x4e5c3a(0x200)),logger[_0x4e5c3a(0x263)](_0x19cffc),logger[_0x4e5c3a(0x263)](_0x4e5c3a(0x200)),logger[_0x4e5c3a(0x263)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x4e5c3a(0x134)]!=_0x4e5c3a(0x1ca))tgBot[_0x4e5c3a(0x1b1)](settings[_0x4e5c3a(0x104)],'Bot\x20Mgr\x20>\x20'+_0x19cffc)[_0x4e5c3a(0x10f)](_0x35fafe=>{telegramError(_0x35fafe);});}}function validateCredentials(_0x4348dc,_0x24a089){const _0x3ff01f=_0x43bc0b;if(_0x4348dc[_0x3ff01f(0x19f)]==settings[_0x3ff01f(0x174)]&&bcrypt['compareSync'](_0x4348dc[_0x3ff01f(0x25f)],settings[_0x3ff01f(0x278)])){if(settings[_0x3ff01f(0x271)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x12b684=generateLoginToken(_0x24a089);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x12b684};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x52b79e){const _0x45cb70=_0x43bc0b,_0x129b3e=generateLoginToken(_0x52b79e);return{'allow':!![],'reason':_0x45cb70(0x154),'token':_0x129b3e};}function validateAccess(_0x428408,_0x5b4d86,_0x59aaa2){const _0x2b5138=_0x43bc0b,_0x29de35=_0x59aaa2?_0x59aaa2:devices[_0x5b4d86]['ip'];let _0x1cc9c2;const _0x41579c=_0x30c91b=>{const _0x379fa2=_0x2e49;if(settings[_0x379fa2(0x22a)]){if(settings[_0x379fa2(0x271)]){if(telegram2FaApproved(_0x5b4d86)){const _0x5b4326=generateLoginToken(_0x5b4d86);return{'allow':!![],'reason':_0x379fa2(0x299),'token':_0x5b4326};}else return{'allow':![],'reason':_0x379fa2(0xbb),'token':null};}else return _0x1cc9c2=validToken(_0x30c91b,_0x5b4d86),_0x1cc9c2['hasOwnProperty'](_0x379fa2(0xd3))?{'allow':!![],'reason':_0x379fa2(0x201),'token':_0x30c91b}:{'allow':![],'reason':_0x379fa2(0xbb),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x2b5138(0xf0)]){let _0x4f9822=[...settings[_0x2b5138(0x26f)],_0x2b5138(0x1fc),_0x2b5138(0x15a),_0x2b5138(0x1fe)];if(_0x4f9822[_0x2b5138(0x142)](_0x29de35))return _0x41579c(_0x428408);else{_0x1cc9c2=validToken(_0x428408,_0x5b4d86);if(_0x1cc9c2[_0x2b5138(0x193)](_0x2b5138(0xd3)))return _0x41579c(_0x428408);else{if(telegramIpApproved(_0x5b4d86)){const _0x3d8cb6=generateToken(_0x5b4d86);return _0x1cc9c2=_0x41579c(_0x428408),_0x1cc9c2[_0x2b5138(0x292)]?{'allow':!![],'reason':_0x2b5138(0x238),'token':_0x3d8cb6}:_0x1cc9c2;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x2b5138(0x256),'token':null};}}}else return _0x41579c(_0x428408);}function timelyDecrypt(_0x67b1ba,_0x141dad=!![]){const _0x33bdba=_0x43bc0b;if(_0x67b1ba)try{const _0x2dfcbf=crypt[_0x33bdba(0x241)](secure[_0x33bdba(0xdf)],_0x67b1ba)[_0x33bdba(0x13f)],_0x5c830d=_0x2dfcbf[_0x33bdba(0x18e)]('@')[0x0],_0x55388a=_0x2dfcbf['split']('@')[0x1],_0x1c9c2f=new Date()[_0x33bdba(0x1de)]();if(_0x141dad){if(_0x1c9c2f-_0x55388a<maxSecretAge*0x3e8)return _0x5c830d;else return![];}else return _0x5c830d;}catch(_0x3e8c0a){return![];}else return![];}const validToken=(_0x2813f8,_0x31b5a8)=>{const _0x3965f6=_0x43bc0b,_0x1ad828=devices[_0x31b5a8]['ip'];if(!_0x2813f8)return{'error':'No\x20authentication\x20token'};for(let _0x359311 of blacklist){if(_0x359311[_0x3965f6(0x11c)]==_0x2813f8)return{'error':_0x3965f6(0x298)};}let _0x89a824;try{_0x89a824=jwt[_0x3965f6(0x126)](_0x2813f8,secure[_0x3965f6(0x290)]+_0x31b5a8);}catch{return{'error':_0x3965f6(0x24d)};}if(!_0x89a824[_0x3965f6(0x193)](_0x3965f6(0xb7))&&!_0x89a824[_0x3965f6(0x193)]('username')||!_0x89a824[_0x3965f6(0x193)](_0x3965f6(0x279)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x89a824[_0x3965f6(0x193)]('username')&&_0x89a824[_0x3965f6(0x193)]('clientip')){const {clientip:_0x37337b}=_0x89a824;return _0x1ad828==_0x37337b?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x3965f6(0x102)};}else{if(_0x89a824[_0x3965f6(0x193)](_0x3965f6(0x19f))&&_0x89a824[_0x3965f6(0x193)](_0x3965f6(0xb7))){const {username:_0x2f4fc2,clientip:_0x48def1}=_0x89a824;return settings[_0x3965f6(0x174)]==_0x2f4fc2&&_0x1ad828==_0x48def1?{'success':_0x3965f6(0x1b0)}:{'error':_0x3965f6(0x27d)};}}},generateLoginToken=_0x36fa59=>{const _0x26e8ab=_0x43bc0b;if(_0x36fa59){const _0x2250ce=devices[_0x36fa59]['ip'];return jwt['sign']({'username':settings[_0x26e8ab(0x174)],'clientip':_0x2250ce},secure[_0x26e8ab(0x290)]+_0x36fa59,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x5da0b5=>{const _0x446108=_0x43bc0b;if(_0x5da0b5){const _0xa0ecc=devices[_0x5da0b5]['ip'];return jwt[_0x446108(0x1b3)]({'clientip':_0xa0ecc},secure['secret']+_0x5da0b5,{'expiresIn':devices[_0x5da0b5][_0x446108(0x17d)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x3eddab=>{const _0x14b790=_0x43bc0b;let _0x469b5e=![];return devices[_0x3eddab][_0x14b790(0x17d)]&&devices[_0x3eddab][_0x14b790(0x17d)]['expiry']!=_0x14b790(0x266)&&(_0x469b5e=devices[_0x3eddab][_0x14b790(0x17d)][_0x14b790(0xb7)]==devices[_0x3eddab]['ip']&&new Date()[_0x14b790(0x1de)]()-devices[_0x3eddab][_0x14b790(0x17d)]['timestamp']<devices[_0x3eddab][_0x14b790(0x17d)]['expiry']*0x3c*0x3e8),_0x469b5e;},telegram2FaApproved=_0x3c351c=>{const _0x90c3e3=_0x43bc0b;let _0x2696d0=![];return devices[_0x3c351c][_0x90c3e3(0x27a)]&&devices[_0x3c351c]['telegram2FaApproval'][_0x90c3e3(0x160)]!=_0x90c3e3(0x266)&&(_0x2696d0=devices[_0x3c351c][_0x90c3e3(0x27a)][_0x90c3e3(0xb7)]==devices[_0x3c351c]['ip']&&new Date()['getTime']()-devices[_0x3c351c]['telegram2FaApproval']['timestamp']<devices[_0x3c351c]['telegram2FaApproval'][_0x90c3e3(0x160)]*0x3c*0x3e8),_0x2696d0;},normalizeIP=_0x277145=>{const _0xa9a63b=_0x43bc0b;let _0xadd775=null,_0x150d55=null;if(ipaddr['isValid'](_0x277145)){const _0xf5e3c2=ipaddr[_0xa9a63b(0xc8)](_0x277145);_0xf5e3c2[_0xa9a63b(0x240)]()===_0xa9a63b(0x1ef)?(_0xf5e3c2['isIPv4MappedAddress']()&&(_0xadd775=_0xf5e3c2[_0xa9a63b(0x1d5)]()['toString']()),_0x150d55=_0xf5e3c2[_0xa9a63b(0x22b)]()):(_0xadd775=_0xf5e3c2[_0xa9a63b(0x22b)](),_0x150d55=_0xf5e3c2[_0xa9a63b(0xfb)]()['toString']());}return{'show':_0xadd775?_0xadd775:_0x150d55,'store':_0x150d55};};function formatDate(_0x2ec926){const _0x284ece=_0x43bc0b;return _0x2ec926[_0x284ece(0xba)]()+'/'+(_0x2ec926[_0x284ece(0xdb)]()+0x1)['toString']()[_0x284ece(0x101)](0x2,'0')+'/'+_0x2ec926[_0x284ece(0xfd)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x2ec926['getHours']()[_0x284ece(0x22b)]()[_0x284ece(0x101)](0x2,'0')+':'+_0x2ec926[_0x284ece(0xcd)]()[_0x284ece(0x22b)]()[_0x284ece(0x101)](0x2,'0')+':'+_0x2ec926[_0x284ece(0x210)]()[_0x284ece(0x22b)]()[_0x284ece(0x101)](0x2,'0');}function sleep(_0x11f842){return new Promise(_0x473fcf=>setTimeout(_0x473fcf,_0x11f842));}