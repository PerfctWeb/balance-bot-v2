const _0x84d66e=_0x297e;(function(_0x2dee8a,_0x42a70d){const _0x18ecf0=_0x297e,_0x3c08e7=_0x2dee8a();while(!![]){try{const _0x4eb90c=parseInt(_0x18ecf0(0x137))/0x1+parseInt(_0x18ecf0(0x10b))/0x2*(-parseInt(_0x18ecf0(0xb6))/0x3)+parseInt(_0x18ecf0(0xbe))/0x4*(-parseInt(_0x18ecf0(0xf6))/0x5)+-parseInt(_0x18ecf0(0x143))/0x6*(parseInt(_0x18ecf0(0x107))/0x7)+parseInt(_0x18ecf0(0x128))/0x8+-parseInt(_0x18ecf0(0x183))/0x9+parseInt(_0x18ecf0(0x13f))/0xa;if(_0x4eb90c===_0x42a70d)break;else _0x3c08e7['push'](_0x3c08e7['shift']());}catch(_0x4628f4){_0x3c08e7['push'](_0x3c08e7['shift']());}}}(_0x5af8,0xbe1a8));function _0x5af8(){const _0x162ad5=['socket.io','1041425NXWqLc','sockets','callback_query','5\x20min','432VFYIpn','Notifications\x20enabled\x0a','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','backup/','reload','login\x20token\x20generated','telegramEvents','test','getMonth','jsonwebtoken','bots','server','blacklist','initclient','add-bot','NTBA_FIX_319','bb-secure.json','slice','use','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','host','notification','order','UA-192771731-1','crypto','running','publicKey','orders','assign','1474264McHmFi','padStart','disabled','login\x20required','accept','remove','getTime','forEach','telegram','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','login\x20token\x20valid','polling_error','reason','HTML','version','623353SrhpGU',',\x20must\x20be\x20a\x204\x20digit\x20number','starting\x20new\x20bot\x20|\x20Bot\x20','remoteAddress','randomBytes','defaults','conn','bot-','43067630GUOnlF','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','inherit','bb/','36KwbadJ','sendFile','Unauthorized\x20attempt\x20to\x20store\x20configuration','send','Unauthorized\x20attempt\x20to\x20update\x20bot','Invalid\x20authentication\x20token\x20(2)','get','@analytics/google-analytics','Unauthorized\x20login\x20attempt\x20(timeout)','value','parse','deleteHistoryAlerts','static','stopPolling','write','f2aRequired','starting\x20bot\x20|\x20Bot\x20','logged\x20out','<b>Telegram\x20bot\x20status:</b>\x0a','deleted\x20Bot\x20','index.html','Bot\x20','bot','log','update-bb','decrypt','entries','place-order','bbUsername','find','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','bb-config.json','get-portfolio','version.json','once','bb-settings.json','length','No\x20bots\x20running\x20right\x20now','function','started','2FA','whitelist','temporaryAccessAllowed','/:bot/configuration','new-disabled','getUTCHours','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','hasOwnProperty','/:bot/support','live','pidExpireLogin','Invalid\x20username\x20or\x20IP\x20address','pidRefreshToken','node-telegram-bot-api','hybrid-crypto-js','match','existsSync','mkdirSync','Invalid\x20Telegram\x20token','SIGTERM','telegramChatId','temporary\x20token\x20generated','/on\x20-\x20start\x20bot(s)\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','7762941qtQXcW','copyFileSync','createServer','page','error','Balance\x20Bot','update-bot','reject','express','from','login','************','2FA\x20login\x20required','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','isIPv4MappedAddress','sortBy','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','ipc','secret','all','whitelistEnabled','Password\x20has\x20been\x20reset\x20to:\x20','telegramIpApproval','event','telegramEnabled','handshake','join','args','expiry','Token\x20blacklisted','All','unlinkSync','/:bot','emit','catch','Unauthorized\x20attempt\x20to\x20update\x20settings','max','Notifications\x20enabled','clients','placeOrder','getMinutes','/:bot/portfolio','readdirSync','port','invalid\x20credentials','RSA-OAEP','delete-alerts','status','telegram2FaApproval','timeshift','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','push','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','success','stop','store-settings','alerts','Alerts','/:bot/coins','2FA\x20required',':\x20Bot\x20Mgr\x20>\x20','RSA','Unauthorized\x20attempt\x20to\x20log\x20out','date-fns','sign','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','generateKeyPairAsync','split','includes','settings','3000','30\x20min','1000','ipv6','then','search','botID','password','data','uuid','::ffff:127.0.0.1','Invalid\x20authentication\x20token\x20(1)','enabled\x20Bot\x20','new','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','default','idling\x20bot\x20\x20\x20|\x20Bot\x20','\x20minutes','sha256','build','/restart\x20-\x20restart\x20bot(s)\x0a','token','connected','-----------------------------------------------------------------------------------','logout','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','add','Invalid\x20IP\x20address','-events.json','username','config/','temporary\x20access\x20not\x20allowed','-performance.json','chat','removeListener','Login\x20rejected','stopped','store-headless','Unauthorized\x20attempt\x20to\x20delete\x20bot','2FA\x20login\x20token\x20generated','temporary\x20access\x20rejected','timestamp','getFullYear','No\x20authentication\x20token','</b>\x20?','<b>Balance\x20Bot\x20status:</b>\x0a','loginRequired','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','referer','botname','constructor','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','exit','21117uDUIGi','sendMessage','set','bbPassword','env','https://hodlerhacks.com','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','\x20|\x20','64ricInp','headers','getHours','store','login\x20not\x20required','argv','map','/status\x20-\x20show\x20bot(s)\x20status\x0a','access\x20timeout','Unauthorized\x20attempt\x20to\x20get\x20portfolio','disabled\x20Bot\x20','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','isDirectory','access','compareSync','15\x20min','toString','user','settings.','botmanager','telegramUsername','store-configuration','/off\x20-\x20stop\x20bot(s)\x0a','connection','clientip','bcryptjs','showname','restart','allow','Crypt','type','apiKey','removeAllListeners','kill','/help\x20-\x20show\x20available\x20commands\x0a','getStartingBalances','child_process','message','\x20>\x20','build2','privateKey','enabled','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','Temporary\x20access\x20rejected','apply','-results.json','::1','Notifications\x20disabled','disconnect','yes','get-logs','lowdb/adapters/FileSync','randomFillSync','telegramToken','/:bot/history','All\x20bots','331285vXIuNk','temporary\x20access\x20timeout','(((.+)+)+)+$','Notifications\x20disabled\x0a','secure','You\x20can\x20use\x20the\x20following\x20commands:\x0a','answerCallbackQuery',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','error\x20while\x20deleting\x20config\x20files:\x20','kind','path','Password\x20reset\x20rejected','onText','\x20/\x20','http'];_0x5af8=function(){return _0x162ad5;};return _0x5af8();}const _0x4f4ba2=function(){let _0x341af4=!![];return function(_0x5afc28,_0x2f3533){const _0x95cfe0=_0x341af4?function(){const _0x4d0df2=_0x297e;if(_0x2f3533){const _0x20c39a=_0x2f3533[_0x4d0df2(0xea)](_0x5afc28,arguments);return _0x2f3533=null,_0x20c39a;}}:function(){};return _0x341af4=![],_0x95cfe0;};}(),_0x54cf6b=_0x4f4ba2(this,function(){const _0x143a57=_0x297e;return _0x54cf6b[_0x143a57(0xce)]()[_0x143a57(0x86)](_0x143a57(0xf8))[_0x143a57(0xce)]()[_0x143a57(0xb3)](_0x54cf6b)[_0x143a57(0x86)](_0x143a57(0xf8));});_0x54cf6b();'use strict';process[_0x84d66e(0xba)][_0x84d66e(0x11a)]=0x1;const childProcess=require(_0x84d66e(0xe2)),FileSync=require(_0x84d66e(0xf1)),fs=require('fs'),fns=require(_0x84d66e(0x7a)),low=require('lowdb'),path=require(_0x84d66e(0x101)),crypto=require(_0x84d66e(0x123)),Crypt=require(_0x84d66e(0x179))[_0x84d66e(0xdb)],RSA=require(_0x84d66e(0x179))[_0x84d66e(0x78)],bcrypt=require(_0x84d66e(0xd7)),jwt=require(_0x84d66e(0x114)),analyticsLib=require('analytics')[_0x84d66e(0x90)],googleAnalytics=require(_0x84d66e(0x14a))[_0x84d66e(0x90)],ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process[_0x84d66e(0xc3)][_0x84d66e(0x11c)](0x2))[_0x84d66e(0xc3)],PORT=argv[_0x84d66e(0x1ae)]||_0x84d66e(0x81),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x84d66e(0x112)](PORT))return console[_0x84d66e(0x15a)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x84d66e(0x138)),process[_0x84d66e(0xb5)](0x1);const HOST=argv[_0x84d66e(0x11f)]||null,userID=argv[_0x84d66e(0xcf)]||'';let bbpath=_0x84d66e(0x142),bbpath2='';const botfile='bot.js',configfile=_0x84d66e(0x162),settingsfile=_0x84d66e(0x166),securefile=_0x84d66e(0x11b);let validInstallation=!![];!fs[_0x84d66e(0x17b)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x84d66e(0x1a9)),configpath=userID?bbpath+_0x84d66e(0x9f)+userID+'/':bbpath+_0x84d66e(0x9f),configbackuppath=configpath+_0x84d66e(0x10e);!fs['existsSync'](configpath)&&fs[_0x84d66e(0x17c)](configpath);!fs[_0x84d66e(0x17b)](configbackuppath)&&fs[_0x84d66e(0x17c)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x84d66e(0x13c)]({'bots':[]})[_0x84d66e(0x151)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x84d66e(0x13c)]({'settings':{'timeshift':0x0}})[_0x84d66e(0x151)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x84d66e(0x13c)]({'secure':{},'blacklist':[]})[_0x84d66e(0x151)]();let crypt=new Crypt({'md':_0x84d66e(0x93),'rsaStandard':_0x84d66e(0x1b0)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x84d66e(0x164))[_0x84d66e(0x136)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![];oneTimeMigration(),cleanBlacklist();const express=require(_0x84d66e(0x18b)),app=express(),http=require(_0x84d66e(0x105))[_0x84d66e(0x185)](app);app[_0x84d66e(0x11d)](express['static'](path[_0x84d66e(0x19d)](__dirname,bbpath2,_0x84d66e(0xe5)))),app[_0x84d66e(0x11d)](express[_0x84d66e(0x14f)](path[_0x84d66e(0x19d)](__dirname,bbpath2,'build'))),app['get']('/',function(_0x19d37b,_0x29cb34){const _0x56dbf8=_0x84d66e;_0x29cb34[_0x56dbf8(0x144)](path[_0x56dbf8(0x19d)](__dirname,bbpath2,_0x56dbf8(0xe5),'index.html'));}),app[_0x84d66e(0x149)](_0x84d66e(0x1a3),function(_0x5b5ccc,_0xc5e29){const _0x423c23=_0x84d66e;_0xc5e29[_0x423c23(0x144)](path[_0x423c23(0x19d)](__dirname,bbpath2,'build','index.html'));}),app['get'](_0x84d66e(0x1ac),(_0x121af2,_0x8bd4fd)=>{const _0x4f18a5=_0x84d66e;_0x8bd4fd[_0x4f18a5(0x144)](path[_0x4f18a5(0x19d)](__dirname,bbpath2,_0x4f18a5(0x94),_0x4f18a5(0x157)));}),app['get']('/:bot/performance',(_0x166332,_0x2b318a)=>{const _0x509095=_0x84d66e;_0x2b318a[_0x509095(0x144)](path[_0x509095(0x19d)](__dirname,bbpath2,_0x509095(0x94),_0x509095(0x157)));}),app[_0x84d66e(0x149)](_0x84d66e(0x75),(_0xce50c6,_0x52f55d)=>{const _0x336679=_0x84d66e;_0x52f55d[_0x336679(0x144)](path[_0x336679(0x19d)](__dirname,bbpath2,_0x336679(0x94),_0x336679(0x157)));}),app[_0x84d66e(0x149)](_0x84d66e(0xf4),(_0x28148e,_0x6aff09)=>{const _0x2d0a4b=_0x84d66e;_0x6aff09[_0x2d0a4b(0x144)](path[_0x2d0a4b(0x19d)](__dirname,bbpath2,'build',_0x2d0a4b(0x157)));}),app[_0x84d66e(0x149)](_0x84d66e(0x16e),(_0x2b422d,_0x4fa8f1)=>{const _0x1f7400=_0x84d66e;_0x4fa8f1[_0x1f7400(0x144)](path['join'](__dirname,bbpath2,_0x1f7400(0x94),_0x1f7400(0x157)));}),app[_0x84d66e(0x149)](_0x84d66e(0x173),(_0xc8e4ae,_0x20e2c0)=>{const _0x5de8a0=_0x84d66e;_0x20e2c0['sendFile'](path[_0x5de8a0(0x19d)](__dirname,bbpath2,_0x5de8a0(0x94),_0x5de8a0(0x157)));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require(_0x84d66e(0x106))(http,{}),analytics=analyticsLib({'app':_0x84d66e(0x188),'plugins':[googleAnalytics({'trackingId':_0x84d66e(0x122)})]}),TelegramBot=require(_0x84d66e(0x178));let tgBot;if(settings['telegramToken']&&settings['telegramToken']!=''&&settings[_0x84d66e(0xd2)]&&settings[_0x84d66e(0xd2)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x5afa2c=_0x84d66e;console['log'](''),console[_0x5afa2c(0x15a)](_0x5afa2c(0x98)),logging(_0x5afa2c(0x8f)+PORT),console['log'](_0x5afa2c(0x98));if(config[_0x5afa2c(0x167)]!=0x0)config[_0x5afa2c(0x12f)](_0x3e7a1d=>{const _0x4e4a27=_0x5afa2c;if(_0x3e7a1d[_0x4e4a27(0x1b2)]==_0x4e4a27(0xe7)||_0x3e7a1d['status']=='new')logging(_0x4e4a27(0x153)+_0x3e7a1d[_0x4e4a27(0x87)]+'\x20|\x20'+_0x3e7a1d[_0x4e4a27(0xb2)]),startBot([_0x3e7a1d[_0x4e4a27(0x87)],userID],{'cwd':bbpath},function(_0x1ec21e){if(_0x1ec21e)logging(_0x1ec21e);});else(_0x3e7a1d['status']=='disabled'||_0x3e7a1d[_0x4e4a27(0x1b2)]=='new-disabled')&&logging(_0x4e4a27(0x91)+_0x3e7a1d[_0x4e4a27(0x87)]+'\x20|\x20'+_0x3e7a1d[_0x4e4a27(0xb2)]);});else!newBot&&console[_0x5afa2c(0x15a)](_0x5afa2c(0xb0));if(newBot)addBot();console['log']('-----------------------------------------------------------------------------------'),console[_0x5afa2c(0x15a)]('');}function startSocket(){const _0x2dd75e=_0x84d66e;io['on'](_0x2dd75e(0xd5),_0x2b6a68=>{const _0x5e1ced=_0x2dd75e;let _0x5ba84b,_0xee3c35,_0x1c6089,_0x9fe5aa,_0x204a21;const _0x4e00d7=_0x2b6a68[_0x5e1ced(0x19c)][_0x5e1ced(0xbf)][_0x5e1ced(0xb1)];_0xee3c35=_0x4e00d7['match'](/bot[0-9]{3}/);if(_0xee3c35)_0x1c6089=_0xee3c35[0x0][_0x5e1ced(0x17a)](/[0-9]{3}/);if(_0x1c6089)_0x5ba84b=_0x1c6089[0x0];else _0x5ba84b=_0x5e1ced(0xd1);const _0x58015d=_0x2b6a68[_0x5e1ced(0x19c)]['auth']['encryptedUuid'];if(!_0x58015d)_0x2b6a68[_0x5e1ced(0x1a4)]('status',{'publicKey':secure[_0x5e1ced(0x125)]});else{_0x9fe5aa=timelyDecrypt(_0x58015d,![]);if(!_0x9fe5aa)_0x2b6a68[_0x5e1ced(0x1a4)](_0x5e1ced(0x1b2),{'publicKey':secure[_0x5e1ced(0x125)]});else{_0x204a21=normalizeIP(_0x2b6a68[_0x5e1ced(0x13d)][_0x5e1ced(0x13a)])[_0x5e1ced(0xc1)];if(!devices[_0x9fe5aa])devices[_0x9fe5aa]={'uuid':_0x9fe5aa,'access':{'token':null}};devices[_0x9fe5aa]['ip']=_0x204a21;const _0x3a9b0a=addClient(_0x2b6a68['id'],_0x9fe5aa,_0x5ba84b);setAccess(_0x3a9b0a),_0x2b6a68['on']('login',_0xb1a00b=>{const _0x34c94f=_0x5e1ced,_0x3c346c=timelyDecrypt(_0xb1a00b[_0x34c94f(0x88)]);if(_0x3c346c){_0xb1a00b={'username':_0xb1a00b[_0x34c94f(0x9e)],'password':_0x3c346c},devices[_0x9fe5aa]['access']=validateCredentials(_0xb1a00b,_0x9fe5aa);if(devices[_0x9fe5aa][_0x34c94f(0xcb)][_0x34c94f(0xda)]==![]&&devices[_0x9fe5aa][_0x34c94f(0xcb)]['reason']=='2FA\x20login\x20required')_0x2b6a68[_0x34c94f(0x1a4)](_0x34c94f(0x1b2),{'access':devices[_0x9fe5aa][_0x34c94f(0xcb)]}),loginAccess2FA(_0x9fe5aa,_0x204a21);else{if(devices[_0x9fe5aa][_0x34c94f(0xcb)]['allow']==![]&&devices[_0x9fe5aa]['access'][_0x34c94f(0x134)]==_0x34c94f(0x1af))_0x2b6a68[_0x34c94f(0x1a4)](_0x34c94f(0x1b2),{'access':devices[_0x9fe5aa][_0x34c94f(0xcb)]});else devices[_0x9fe5aa][_0x34c94f(0xcb)][_0x34c94f(0xda)]&&devices[_0x9fe5aa][_0x34c94f(0xcb)][_0x34c94f(0x134)]==_0x34c94f(0x110)&&(getClientsWithUuid(_0x9fe5aa)[_0x34c94f(0x12f)](_0x4754e8=>{setAccess(_0x4754e8);}),setTokenRefresh(_0x9fe5aa),setSessionTimeout(_0x34c94f(0x18d),_0x9fe5aa));}}else logging(_0x34c94f(0x14b));}),_0x2b6a68['on']('reset-password',()=>{resetPassword();}),_0x2b6a68['on'](_0x5e1ced(0xee),_0x30f092=>{removeClient(_0x2b6a68['id']);});}}});}function initClient(_0x41eb6b){const _0x4a6d12=_0x84d66e;if(_0x41eb6b!=_0x4a6d12(0xd1)&&config[_0x4a6d12(0xdd)]!=''){if(pid[_0x41eb6b])pid[_0x41eb6b][_0x4a6d12(0x146)]({'function':_0x4a6d12(0x118),'args':null});}}function getSocket(_0xbe5554){const _0x5cd491=_0x84d66e;return io[_0x5cd491(0x108)]['sockets'][_0x5cd491(0x149)](_0xbe5554);}function setAccess(_0x47f791){const _0x2f2c16=_0x84d66e,_0x243f39=getSocket(_0x47f791['id']),_0x1d9104=_0x47f791['uuid'],_0x51830a=_0x47f791[_0x2f2c16(0x159)];devices[_0x1d9104][_0x2f2c16(0xcb)]=validateAccess(devices[_0x1d9104][_0x2f2c16(0xcb)]['token'],_0x1d9104),_0x243f39[_0x2f2c16(0x19d)](_0x1d9104);if(devices[_0x1d9104]['access'][_0x2f2c16(0xda)]){_0x243f39[_0x2f2c16(0x19d)](_0x51830a);if(_0x51830a==_0x2f2c16(0xd1))initializeSocketBotManager(_0x243f39);else initializeSocketBot(_0x243f39);initClient(_0x51830a);}devices[_0x1d9104][_0x2f2c16(0xcb)]['token']&&devices[_0x1d9104][_0x2f2c16(0xcb)]['reason']==_0x2f2c16(0x180)&&setSessionTimeout(_0x2f2c16(0x16b),_0x1d9104),devices[_0x1d9104][_0x2f2c16(0xcb)][_0x2f2c16(0x96)]&&devices[_0x1d9104]['access'][_0x2f2c16(0x134)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout('login',_0x1d9104),_0x243f39['emit'](_0x2f2c16(0x1b2),{'status':_0x47f791[_0x2f2c16(0x116)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x1d9104][_0x2f2c16(0xcb)],'externalip':devices[_0x1d9104]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),devices[_0x1d9104][_0x2f2c16(0xcb)][_0x2f2c16(0xda)]==![]&&devices[_0x1d9104]['access']['reason']==_0x2f2c16(0x76)&&temporaryAccess2FA(_0x1d9104,devices[_0x1d9104]['ip']);}function setSessionTimeout(_0x5572e9,_0x671c34){const _0xdcdf94=_0x84d66e;let _0x224e68;if(_0x5572e9=='login')_0x224e68=loginExpiry*0x3c*0x3e8;else _0x224e68=devices[_0x671c34]['telegramIpApproval'][_0xdcdf94(0x19f)]*0x3c*0x3e8-(new Date()[_0xdcdf94(0x12e)]()-devices[_0x671c34][_0xdcdf94(0x199)][_0xdcdf94(0xaa)]);if(devices[_0x671c34][_0xdcdf94(0x175)])clearTimeout(devices[_0x671c34][_0xdcdf94(0x175)]);devices[_0x671c34][_0xdcdf94(0x175)]=setTimeout(()=>{const _0x3c0224=_0xdcdf94;if(devices[_0x671c34][_0x3c0224(0x177)])clearTimeout(devices[_0x671c34]['pidRefreshToken']);removeSocketListeners(_0x671c34),addBlacklist(_0x671c34),devices[_0x671c34][_0x3c0224(0x199)]=null,devices[_0x671c34][_0x3c0224(0x1b3)]=null,devices[_0x671c34][_0x3c0224(0xcb)][_0x3c0224(0x96)]=null,devices[_0x671c34][_0x3c0224(0xcb)]=validateAccess(devices[_0x671c34][_0x3c0224(0xcb)]['token'],_0x671c34),!(devices[_0x671c34]['access']['allow']&&devices[_0x671c34]['access']['reason']==_0x3c0224(0xc2))&&(_0x5572e9=='login'?io['to'](_0x671c34)[_0x3c0224(0x1a4)]('status',{'access':{'allow':![],'reason':_0x3c0224(0xc6),'token':null}}):io['to'](_0x671c34)[_0x3c0224(0x1a4)](_0x3c0224(0x1b2),{'access':{'allow':![],'reason':_0x3c0224(0xf7),'token':null}})),devices[_0x671c34]['access']['token']=null;},_0x224e68);}function setTokenRefresh(_0x35b00c){const _0x52a215=_0x84d66e;if(devices[_0x35b00c][_0x52a215(0x177)])clearTimeout(devices[_0x35b00c][_0x52a215(0x177)]);devices[_0x35b00c][_0x52a215(0x177)]=setTimeout(()=>{const _0x21aa17=_0x52a215;getClientsWithUuid(_0x35b00c)['length']!=0x0?(devices[_0x35b00c]['access']=refreshToken(_0x35b00c),io['to'](_0x35b00c)[_0x21aa17(0x1a4)](_0x21aa17(0x1b2),{'status':_0x21aa17(0x97),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x35b00c][_0x21aa17(0xcb)],'externalip':devices[_0x35b00c]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x35b00c)):clearTimeout(devices[_0x35b00c]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4147ce){const _0x40da44=_0x84d66e,_0x2ee487=getClient(_0x4147ce['id'])[_0x40da44(0x8a)];_0x4147ce[_0x40da44(0x1a4)](_0x40da44(0x115),config),_0x4147ce[_0x40da44(0x1a4)](_0x40da44(0x80),cleanSettings()),_0x4147ce['on'](_0x40da44(0x119),_0x276d59=>{if(validateAccess(_0x276d59,_0x2ee487)['allow'])addBot();else logging('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x4147ce['on'](_0x40da44(0x189),(_0x181626,_0x3a63c7)=>{const _0x49f497=_0x40da44;if(validateAccess(_0x3a63c7,_0x2ee487)[_0x49f497(0xda)])toggleBot(_0x181626[_0x49f497(0x87)],_0x181626[_0x49f497(0x1b2)],_0x181626[_0x49f497(0x174)]);else logging(_0x49f497(0x147));}),_0x4147ce['on']('delete-bot',(_0x1a8780,_0x5eb90e)=>{const _0x5b176a=_0x40da44;if(validateAccess(_0x5eb90e,_0x2ee487)['allow'])deleteBot(_0x1a8780);else logging(_0x5b176a(0xa7));}),_0x4147ce['on'](_0x40da44(0x72),(_0x3fdb96,_0xe9b98b)=>{if(validateAccess(_0xe9b98b,_0x2ee487)['allow'])storeSettings(_0x3fdb96,!![]);else logging('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x4147ce['on'](_0x40da44(0x15b),(_0x505ba6,_0x48b276)=>{const _0x56d934=_0x40da44;if(validateAccess(_0x48b276,_0x2ee487)['allow'])updateBB();else logging(_0x56d934(0x1a6));}),_0x4147ce['on'](_0x40da44(0x99),_0x3a7993=>{const _0x4b0e11=_0x40da44;if(validateAccess(_0x3a7993,_0x2ee487)[_0x4b0e11(0xda)]){if(devices[_0x2ee487][_0x4b0e11(0x177)])clearTimeout(devices[_0x2ee487][_0x4b0e11(0x177)]);if(devices[_0x2ee487][_0x4b0e11(0x175)])clearTimeout(devices[_0x2ee487][_0x4b0e11(0x175)]);removeSocketListeners(getClient(_0x4147ce['id'])['uuid']),addBlacklist(_0x2ee487),devices[_0x2ee487]['telegramIpApproval']=null,devices[_0x2ee487][_0x4b0e11(0x1b3)]=null,devices[_0x2ee487]['access'][_0x4b0e11(0x96)]=null,io['to'](getClient(_0x4147ce['id'])[_0x4b0e11(0x8a)])[_0x4b0e11(0x1a4)](_0x4b0e11(0x1b2),{'access':{'allow':![],'reason':_0x4b0e11(0x154),'token':null}});}else logging(_0x4b0e11(0x79));});}function initializeSocketBot(_0x2efa8b){const _0x17c039=_0x84d66e,_0x5e853d=getClient(_0x2efa8b['id'])['bot'],_0x5c38fd=getClient(_0x2efa8b['id'])[_0x17c039(0x8a)];_0x2efa8b['on'](_0x17c039(0xf0),(_0x57acee,_0x4ca102)=>{const _0x4afd25=_0x17c039;if(validateAccess(_0x4ca102,_0x5c38fd)[_0x4afd25(0xda)]){if(pid[_0x5e853d])pid[_0x5e853d][_0x4afd25(0x146)]({'function':'emitHistory','args':_0x57acee});}else logging('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0x2efa8b['on'](_0x17c039(0x1b1),(_0x4a80e4,_0x32152f)=>{const _0x499094=_0x17c039;if(validateAccess(_0x32152f,_0x5c38fd)[_0x499094(0xda)]){if(pid[_0x5e853d])pid[_0x5e853d][_0x499094(0x146)]({'function':_0x499094(0x14e),'args':_0x4a80e4});}else logging('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x2efa8b['on'](_0x17c039(0x163),(_0x19dec4,_0xeb19b)=>{const _0x21ffef=_0x17c039;if(validateAccess(_0xeb19b,_0x5c38fd)[_0x21ffef(0xda)]){if(pid[_0x5e853d])pid[_0x5e853d][_0x21ffef(0x146)]({'function':'getPortfolio','args':_0x19dec4});}else logging(_0x21ffef(0xc7));}),_0x2efa8b['on'](_0x17c039(0xd3),(_0x271be0,_0x50ea51)=>{const _0x22e46e=_0x17c039;if(validateAccess(_0x50ea51,_0x5c38fd)[_0x22e46e(0xda)]){if(pid[_0x5e853d])pid[_0x5e853d][_0x22e46e(0x146)]({'function':'storeConfiguration','args':_0x271be0});}else logging(_0x22e46e(0x145));}),_0x2efa8b['on'](_0x17c039(0xa6),(_0xdca342,_0x413707)=>{const _0x31329c=_0x17c039;if(validateAccess(_0x413707,_0x5c38fd)[_0x31329c(0xda)]){if(pid[_0x5e853d])pid[_0x5e853d][_0x31329c(0x146)]({'function':'storeHeadless','args':_0xdca342});}else logging(_0x31329c(0x7c));}),_0x2efa8b['on']('get-starting-balances',_0x4b0153=>{const _0x5dbe6e=_0x17c039;if(validateAccess(_0x4b0153,_0x5c38fd)[_0x5dbe6e(0xda)]){if(pid[_0x5e853d])pid[_0x5e853d]['send']({'function':_0x5dbe6e(0xe1),'args':null});}else logging(_0x5dbe6e(0x190));}),_0x2efa8b['on'](_0x17c039(0x15e),(_0x2fcb3f,_0x1c54d9)=>{const _0xf5f37c=_0x17c039;if(validateAccess(_0x1c54d9,_0x5c38fd)[_0xf5f37c(0xda)]){if(pid[_0x5e853d])pid[_0x5e853d][_0xf5f37c(0x146)]({'function':_0xf5f37c(0x1aa),'args':_0x2fcb3f});}else logging(_0xf5f37c(0xb4));}),_0x2efa8b['on']('cancel-loading',_0x598362=>{const _0x409e26=_0x17c039;if(validateAccess(_0x598362,_0x5c38fd)['allow']){if(pid[_0x5e853d])pid[_0x5e853d]['send']({'function':'cancelLoading','args':null});}else logging(_0x409e26(0xc9));}),_0x2efa8b['on'](_0x17c039(0x99),_0x26b8e9=>{const _0x3a6b41=_0x17c039;if(validateAccess(_0x26b8e9,_0x5c38fd)[_0x3a6b41(0xda)]){if(devices[_0x5c38fd][_0x3a6b41(0x177)])clearTimeout(devices[_0x5c38fd][_0x3a6b41(0x177)]);if(devices[_0x5c38fd][_0x3a6b41(0x175)])clearTimeout(devices[_0x5c38fd][_0x3a6b41(0x175)]);removeSocketListeners(getClient(_0x2efa8b['id'])['uuid']),addBlacklist(_0x5c38fd),devices[_0x5c38fd]['telegramIpApproval']=null,devices[_0x5c38fd][_0x3a6b41(0x1b3)]=null,devices[_0x5c38fd][_0x3a6b41(0xcb)][_0x3a6b41(0x96)]=null,io['to'](getClient(_0x2efa8b['id'])[_0x3a6b41(0x8a)])[_0x3a6b41(0x1a4)](_0x3a6b41(0x1b2),{'access':{'allow':![],'reason':_0x3a6b41(0x154),'token':null}});}else logging(_0x3a6b41(0x79));});}function removeSocketListeners(_0x46440c){const _0x29bd3c=_0x84d66e;getClientsWithUuid(_0x46440c)[_0x29bd3c(0x12f)](_0x3cb445=>{const _0x3260e8=_0x29bd3c;getSocket(_0x3cb445['id'])[_0x3260e8(0xde)]();});}function cleanSettings(){const _0x328542=_0x84d66e;let _0x31af67=settings;return settings[_0x328542(0xf3)]&&settings[_0x328542(0xf3)]!=''&&(_0x31af67={..._0x31af67,'telegramToken':_0x328542(0x18e)}),settings['bbPassword']&&settings[_0x328542(0xb9)]!=''&&(_0x31af67={..._0x31af67,'bbPassword':_0x328542(0x18e)}),_0x31af67;}function updateBB(){const _0x275b7b=_0x84d66e;installingUpdate=!![],config[_0x275b7b(0x12f)](_0x2c11cf=>{restartBot(_0x2c11cf['botID']);}),process[_0x275b7b(0x146)]({'update':!![]},_0x431bcd=>{});}function startBot(_0x532647,_0x3dfb08,_0x353b0a){const _0x5af8fe=_0x84d66e;let _0x50ca83=![];const _0x1bcfe9=_0x532647[0x0];_0x3dfb08={..._0x3dfb08,'stdio':[_0x5af8fe(0x141),_0x5af8fe(0x141),_0x5af8fe(0x141),_0x5af8fe(0x194)]},pid[_0x1bcfe9]=childProcess['fork'](botfile,_0x532647,_0x3dfb08),pid[_0x1bcfe9]['on'](_0x5af8fe(0xe3),_0x6436f7=>{const _0x27613a=_0x5af8fe;switch(Object['keys'](_0x6436f7)[0x0]){case _0x27613a(0xb2):updateBotName(_0x1bcfe9,_0x6436f7['botname']);break;case'status':updateStatus(_0x1bcfe9,_0x6436f7[_0x27613a(0x1b2)]);break;case _0x27613a(0x174):updateLive(_0x1bcfe9,_0x6436f7[_0x27613a(0x174)]);break;case _0x27613a(0x16a):updateLive(_0x1bcfe9,_0x6436f7[_0x27613a(0x16a)]),io['to'](_0x1bcfe9)[_0x27613a(0x1a4)](_0x27613a(0x1b2),{'access':{'allow':![],'reason':_0x27613a(0x10f),'token':null}});break;case'stop':_0x6436f7[_0x27613a(0x71)]==_0x27613a(0xd9)&&restartBot(_0x1bcfe9);_0x6436f7[_0x27613a(0x71)]==_0x27613a(0xdf)&&toggleBot(_0x1bcfe9,_0x27613a(0x12a),_0x27613a(0xa5));break;case'telegram':sendTelegram(_0x1bcfe9,_0x6436f7[_0x27613a(0x130)]);break;case _0x27613a(0x169):io['to'](_0x1bcfe9)['emit'](_0x6436f7[_0x27613a(0x169)],_0x6436f7[_0x27613a(0x19e)]);break;}}),pid[_0x1bcfe9]['on'](_0x5af8fe(0x187),function(_0xd39918){if(_0x50ca83)return;_0x50ca83=!![],_0x353b0a(_0xd39918);}),pid[_0x1bcfe9]['on'](_0x5af8fe(0xb5),function(_0x3c4fa8){const _0x6c83cc=_0x5af8fe;if(installingUpdate)return;if(_0x50ca83)return;_0x50ca83=!![],_0x353b0a(null);const _0x39b133=dbConfig[_0x6c83cc(0x149)](_0x6c83cc(0x115))[_0x6c83cc(0x160)]({'botID':_0x1bcfe9})[_0x6c83cc(0x14c)]();_0x39b133&&(_0x39b133[_0x6c83cc(0x1b2)]==_0x6c83cc(0xe7)||_0x39b133['status']==_0x6c83cc(0x8e))&&(updateLive(_0x1bcfe9,_0x6c83cc(0xa5)),logging('restarting\x20Bot\x20'+_0x1bcfe9),startBot([_0x1bcfe9,userID],{'cwd':bbpath},function(_0x2eed14){if(_0x2eed14)logging(_0x2eed14);}));});}function stopBot(_0x5477e9){const _0x44947a=_0x84d66e;getClientsWithBotID(_0x5477e9)['forEach'](_0xe1b5c=>{const _0x6d662a=_0x297e;getSocket(_0xe1b5c['id'])[_0x6d662a(0xee)](!![]),removeClient(_0xe1b5c['id']);});if(pid[_0x5477e9])pid[_0x5477e9][_0x44947a(0xdf)]();}function restartBot(_0x1f5af7){const _0x5162e0=_0x84d66e;if(pid[_0x1f5af7])pid[_0x1f5af7][_0x5162e0(0xdf)]();}function addBot(){const _0x88547d=_0x84d66e;let _0x1f2cc8;for(let _0x57cdc5=0x1;_0x57cdc5<0x3e9;_0x57cdc5++){_0x1f2cc8=_0x57cdc5[_0x88547d(0xce)]()[_0x88547d(0x129)](0x3,'0');let _0x1bbdce=config['find'](_0x3a674f=>_0x3a674f[_0x88547d(0x87)]==_0x1f2cc8);if(!_0x1bbdce)break;}if(_0x1f2cc8===_0x88547d(0x83)){logging('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logging(_0x88547d(0x139)+_0x1f2cc8),dbConfig[_0x88547d(0x149)](_0x88547d(0x115))['push']({'botID':_0x1f2cc8,'botname':_0x88547d(0x158)+_0x1f2cc8,'status':_0x88547d(0x8e),'live':''})['write'](),startBot([_0x1f2cc8,userID],{'cwd':bbpath},function(_0xaec28c){if(_0xaec28c)logging(_0xaec28c);}),config=getConfiguration(),io['to']('botmanager')[_0x88547d(0x1a4)](_0x88547d(0x115),config);}function deleteBot(_0x563c34){const _0x36669e=_0x84d66e;getClientsWithBotID(_0x563c34)[_0x36669e(0x12f)](_0x174a15=>{const _0x5ab5f4=_0x36669e;getSocket(_0x174a15['id'])[_0x5ab5f4(0xee)](!![]),removeClient(_0x174a15['id']);}),dbConfig[_0x36669e(0x149)](_0x36669e(0x115))[_0x36669e(0x12d)]({'botID':_0x563c34})[_0x36669e(0x151)](),logging(_0x36669e(0x156)+_0x563c34),stopBot(_0x563c34);try{fs[_0x36669e(0x1a2)](path[_0x36669e(0x19d)](configpath,_0x36669e(0x13e)+_0x563c34+'-config.json')),fs[_0x36669e(0x1a2)](path[_0x36669e(0x19d)](configpath,'bot-'+_0x563c34+_0x36669e(0x9d))),fs['unlinkSync'](path[_0x36669e(0x19d)](configpath,_0x36669e(0x13e)+_0x563c34+_0x36669e(0xa1))),fs[_0x36669e(0x1a2)](path[_0x36669e(0x19d)](configpath,_0x36669e(0x13e)+_0x563c34+_0x36669e(0xeb)));}catch(_0x2baa99){if(_0x2baa99)logging(_0x36669e(0xff),_0x2baa99);}config=getConfiguration(),io['to'](_0x36669e(0xd1))['emit'](_0x36669e(0x115),config);}function toggleBot(_0x154144,_0x3d97d4,_0x2a40ad){const _0x3a1224=_0x84d66e;dbConfig['get']('bots')[_0x3a1224(0x160)]({'botID':_0x154144})[_0x3a1224(0x127)]({'status':_0x3d97d4})[_0x3a1224(0x127)]({'live':_0x2a40ad})[_0x3a1224(0x151)]();if(_0x3d97d4==_0x3a1224(0xe7)||_0x3d97d4=='new')logging(_0x3a1224(0x8d)+_0x154144),startBot([_0x154144,userID],{'cwd':bbpath},function(_0x389ce9){if(_0x389ce9)logging(_0x389ce9);});else(_0x3d97d4==_0x3a1224(0x12a)||_0x3d97d4==_0x3a1224(0x16f))&&(logging(_0x3a1224(0xc8)+_0x154144),stopBot(_0x154144));config=getConfiguration(),io['to'](_0x3a1224(0xd1))[_0x3a1224(0x1a4)](_0x3a1224(0x115),config);}function toggleStatus(_0x2b04b6){const _0x3ed50e=_0x84d66e;let _0x24a42b=dbConfig[_0x3ed50e(0x149)](_0x3ed50e(0x115))['find']({'botID':_0x2b04b6})[_0x3ed50e(0x14c)](),_0xaa34d5;if(_0x24a42b[_0x3ed50e(0x1b2)]==='enabled')_0xaa34d5=_0x3ed50e(0x12a);else{if(_0x24a42b['status']===_0x3ed50e(0x8e))_0xaa34d5=_0x3ed50e(0x16f);else{if(_0x24a42b[_0x3ed50e(0x1b2)]===_0x3ed50e(0x16f))_0xaa34d5=_0x3ed50e(0x8e);else{if(_0x24a42b[_0x3ed50e(0x1b2)]==='disabled')_0xaa34d5='enabled';}}}return _0xaa34d5;}function updateStatus(_0x1c85ca,_0x11e186){const _0xcdbe10=_0x84d66e;dbConfig[_0xcdbe10(0x149)]('bots')['find']({'botID':_0x1c85ca})['assign']({'status':_0x11e186})[_0xcdbe10(0x151)](),config=getConfiguration(),io['to'](_0xcdbe10(0xd1))['emit'](_0xcdbe10(0x115),config);}function updateLive(_0x3e30e7,_0x5f5b97){const _0x30a127=_0x84d66e;dbConfig[_0x30a127(0x149)](_0x30a127(0x115))[_0x30a127(0x160)]({'botID':_0x3e30e7})[_0x30a127(0x127)]({'live':_0x5f5b97})[_0x30a127(0x151)](),config=getConfiguration(),io['to'](_0x30a127(0xd1))[_0x30a127(0x1a4)](_0x30a127(0x115),config);}function updateBotName(_0x455e6b,_0x419c7f){const _0x478065=_0x84d66e;dbConfig[_0x478065(0x149)](_0x478065(0x115))[_0x478065(0x160)]({'botID':_0x455e6b})[_0x478065(0x127)]({'botname':_0x419c7f})[_0x478065(0x151)](),config=getConfiguration(),io['to'](_0x478065(0xd1))['emit']('bots',config);}function telegramError(_0x575738){const _0x3365b0=_0x84d66e;console[_0x3365b0(0x15a)](getTimeStamp()+_0x3365b0(0xfd));}function validateTelegram(_0x3d3b11){const _0x20547e=_0x84d66e;if(_0x3d3b11[_0x20547e(0x18c)][_0x20547e(0x9e)]!=settings[_0x20547e(0xd2)]&&'@'+_0x3d3b11[_0x20547e(0x18c)]['username']!=settings['telegramUsername'])return tgBot[_0x20547e(0xb7)](_0x3d3b11[_0x20547e(0xa2)]['id'],_0x20547e(0x1b5),{'parse_mode':_0x20547e(0x135)})['catch'](_0x1b84a1=>{telegramError(_0x1b84a1);}),![];return!![];}async function initTelegram(){const _0x53bbcc=_0x84d66e;if(tgBot)tgBot[_0x53bbcc(0x150)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x53bbcc(0xf3)],{'polling':!![]});let _0x2f63f8=_0x53bbcc(0xfb);_0x2f63f8+='\x0a',_0x2f63f8+='/enable\x20-\x20enable\x20notifications\x0a',_0x2f63f8+='/disable\x20-\x20disable\x20notifications\x0a',_0x2f63f8+=_0x53bbcc(0x1b7),_0x2f63f8+=_0x53bbcc(0x95),_0x2f63f8+=_0x53bbcc(0x181),_0x2f63f8+=_0x53bbcc(0xd4),_0x2f63f8+=_0x53bbcc(0xc5),_0x2f63f8+=_0x53bbcc(0xe0);let _0x56eb0e=_0x53bbcc(0x11e);_0x56eb0e+='\x0a',_0x56eb0e+=_0x2f63f8,tgBot[_0x53bbcc(0x103)](/\/start/,_0x1947c0=>{const _0x20a9b2=_0x53bbcc;if(!validateTelegram(_0x1947c0))return;if(settings[_0x20a9b2(0x17f)]!=_0x1947c0[_0x20a9b2(0xa2)]['id'])updateSetting(_0x20a9b2(0x17f),_0x1947c0[_0x20a9b2(0xa2)]['id']);updateSetting('telegramEnabled',!![]),tgBot['sendMessage'](_0x1947c0[_0x20a9b2(0xa2)]['id'],_0x56eb0e)[_0x20a9b2(0x1a5)](_0x13bb01=>{telegramError(_0x13bb01);});}),tgBot[_0x53bbcc(0x103)](/\/enable/,_0x3c837b=>{const _0x41dfc5=_0x53bbcc;if(!validateTelegram(_0x3c837b))return;if(settings[_0x41dfc5(0x17f)]!=_0x3c837b['chat']['id'])updateSetting(_0x41dfc5(0x17f),_0x3c837b['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x41dfc5(0xb7)](_0x3c837b[_0x41dfc5(0xa2)]['id'],_0x41dfc5(0x1a8))[_0x41dfc5(0x1a5)](_0x25edb8=>{telegramError(_0x25edb8);});}),tgBot[_0x53bbcc(0x103)](/\/config/,async _0x177b2c=>{const _0x8ad17f=_0x53bbcc;if(!validateTelegram(_0x177b2c))return;tgBot[_0x8ad17f(0xa3)](_0x8ad17f(0x109)),tgBot[_0x8ad17f(0xb7)](_0x177b2c['chat']['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x8ad17f(0x126)},{'text':_0x8ad17f(0x74),'callback_data':'alerts'},{'text':_0x8ad17f(0x1a1),'callback_data':_0x8ad17f(0x196)}]]}})['catch'](_0x3723bf=>{telegramError(_0x3723bf);}),tgBot['on'](_0x8ad17f(0x109),async _0x35b900=>{const _0x3bc63b=_0x8ad17f,_0x41f807=_0x35b900[_0x3bc63b(0x89)],_0x26e689=_0x35b900['message'];tgBot[_0x3bc63b(0xfc)](_0x35b900['id'])[_0x3bc63b(0x85)](async()=>{const _0x1e4601=_0x3bc63b;_0x41f807==_0x1e4601(0x126)&&(updateSetting(_0x1e4601(0x111),_0x1e4601(0x126)),updateSetting(_0x1e4601(0x19b),!![]),await tgBot['sendMessage'](_0x26e689[_0x1e4601(0xa2)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')['catch'](_0x5ffa5e=>{telegramError(_0x5ffa5e);}));_0x41f807==_0x1e4601(0x73)&&(updateSetting(_0x1e4601(0x111),_0x1e4601(0x73)),updateSetting('telegramEnabled',!![]),await tgBot[_0x1e4601(0xb7)](_0x26e689[_0x1e4601(0xa2)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x1e4601(0x1a5)](_0x177905=>{telegramError(_0x177905);}));_0x41f807==_0x1e4601(0x196)&&(updateSetting('telegramEvents',_0x1e4601(0x196)),updateSetting('telegramEnabled',!![]),await tgBot[_0x1e4601(0xb7)](_0x26e689[_0x1e4601(0xa2)]['id'],_0x1e4601(0x9a))[_0x1e4601(0x1a5)](_0x4d7e04=>{telegramError(_0x4d7e04);}));if(!settings[_0x1e4601(0x17f)])tgBot['sendMessage'](_0x26e689[_0x1e4601(0xa2)]['id'],_0x1e4601(0xe8))['catch'](_0xe8f9b6=>{telegramError(_0xe8f9b6);});}),tgBot[_0x3bc63b(0xa3)]('callback_query');});}),tgBot[_0x53bbcc(0x103)](/\/status/,_0x54fc0a=>{const _0x55e580=_0x53bbcc;if(!validateTelegram(_0x54fc0a))return;let _0x2cf5fd=_0x55e580(0xae);config[_0x55e580(0x12f)](_0x52c8e8=>{const _0x49cefb=_0x55e580;_0x2cf5fd+=_0x49cefb(0x158)+_0x52c8e8[_0x49cefb(0x87)]+_0x49cefb(0xbd)+_0x52c8e8['botname']+':\x20'+_0x52c8e8[_0x49cefb(0x1b2)]+_0x49cefb(0x104)+_0x52c8e8[_0x49cefb(0x174)]+'\x0a';}),_0x2cf5fd+='\x0a',_0x2cf5fd+=_0x55e580(0x155),_0x2cf5fd+=!settings[_0x55e580(0x19b)]?_0x55e580(0xf9):_0x55e580(0x10c),_0x2cf5fd+=settings[_0x55e580(0x19b)]?settings['telegramEvents']==_0x55e580(0x196)?_0x55e580(0x10d):'Notifications\x20types:\x20'+settings[_0x55e580(0x111)]+'\x20only\x0a':'',tgBot[_0x55e580(0xb7)](_0x54fc0a[_0x55e580(0xa2)]['id'],_0x2cf5fd,{'parse_mode':_0x55e580(0x135)})[_0x55e580(0x1a5)](_0x2a036e=>{telegramError(_0x2a036e);});}),tgBot['onText'](/\/restart/,_0x309385=>{const _0x592dd1=_0x53bbcc;if(!validateTelegram(_0x309385))return;tgBot[_0x592dd1(0xa3)](_0x592dd1(0x109));const _0x2fe9dd=getEnabledBots();if(_0x2fe9dd['length']==0x0)tgBot[_0x592dd1(0xb7)](_0x309385[_0x592dd1(0xa2)]['id'],_0x592dd1(0x168))[_0x592dd1(0x1a5)](_0x514a8a=>{telegramError(_0x514a8a);});else{if(_0x2fe9dd['length']>0x1)_0x2fe9dd['push']({'botID':_0x592dd1(0x196)});let _0x4a93e3=[],_0x1e3ab=[];const _0x58e4a3=_0x2fe9dd['length']%0x4==0x0||_0x2fe9dd[_0x592dd1(0x167)]%0x4==0x3||_0x2fe9dd[_0x592dd1(0x167)]%0x3==0x1?0x4:0x3;let _0x217e34=0x0;_0x2fe9dd['forEach']((_0xd2ae30,_0x474e06)=>{const _0x5215b3=_0x592dd1;if(_0x474e06%_0x58e4a3==0x0)_0x1e3ab=[];_0x1e3ab[_0x5215b3(0x1b6)]({'text':_0xd2ae30[_0x5215b3(0x87)]=='all'?_0x5215b3(0xf5):_0x5215b3(0x158)+_0xd2ae30['botID'],'callback_data':_0xd2ae30[_0x5215b3(0x87)]}),_0x474e06%_0x58e4a3==0x0&&(_0x4a93e3[_0x217e34]=_0x1e3ab,_0x217e34++);}),tgBot[_0x592dd1(0xb7)](_0x309385[_0x592dd1(0xa2)]['id'],_0x592dd1(0x182),{'reply_markup':{'inline_keyboard':_0x4a93e3}})[_0x592dd1(0x1a5)](_0x20b323=>{telegramError(_0x20b323);}),tgBot['on'](_0x592dd1(0x109),async _0x59514f=>{const _0x4b6560=_0x592dd1,_0x4646ed=_0x59514f[_0x4b6560(0x89)],_0x41e615=_0x59514f[_0x4b6560(0xe3)];tgBot[_0x4b6560(0xfc)](_0x59514f['id'])[_0x4b6560(0x85)](async()=>{const _0x3dea34=_0x4b6560;if(_0x4646ed=='all'){if(settings['telegramEvents']==_0x3dea34(0x126))tgBot[_0x3dea34(0xb7)](_0x41e615['chat']['id'],_0x3dea34(0xbc))['catch'](_0x46b0a4=>{telegramError(_0x46b0a4);});config['forEach'](_0x9ee2a0=>{restartBot(_0x9ee2a0['botID']);});}else{if(settings[_0x3dea34(0x111)]==_0x3dea34(0x126))tgBot[_0x3dea34(0xb7)](_0x41e615[_0x3dea34(0xa2)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20Bot\x20'+_0x4646ed)[_0x3dea34(0x1a5)](_0xdb05ff=>{telegramError(_0xdb05ff);});restartBot(_0x4646ed);}}),tgBot[_0x4b6560(0xa3)]('callback_query');});}}),tgBot[_0x53bbcc(0x103)](/\/on/,_0x2d907c=>{const _0x492a58=_0x53bbcc;if(!validateTelegram(_0x2d907c))return;tgBot['removeListener'](_0x492a58(0x109));const _0x32ea8c=getDisabledBots();if(_0x32ea8c['length']==0x0)tgBot[_0x492a58(0xb7)](_0x2d907c[_0x492a58(0xa2)]['id'],'All\x20bots\x20running\x20right\x20now')['catch'](_0x21d5ba=>{telegramError(_0x21d5ba);});else{if(_0x32ea8c[_0x492a58(0x167)]>0x1)_0x32ea8c[_0x492a58(0x1b6)]({'botID':_0x492a58(0x196)});let _0x449492=[],_0x48884a=[];const _0x3ad3bd=_0x32ea8c['length']%0x4==0x0||_0x32ea8c[_0x492a58(0x167)]%0x4==0x3||_0x32ea8c['length']%0x3==0x1?0x4:0x3;let _0x3a6238=0x0;_0x32ea8c[_0x492a58(0x12f)]((_0x36ddac,_0xad9130)=>{const _0x5bca1c=_0x492a58;if(_0xad9130%_0x3ad3bd==0x0)_0x48884a=[];_0x48884a['push']({'text':_0x36ddac['botID']==_0x5bca1c(0x196)?'All\x20bots':'Bot\x20'+_0x36ddac[_0x5bca1c(0x87)],'callback_data':_0x36ddac['botID']}),_0xad9130%_0x3ad3bd==0x0&&(_0x449492[_0x3a6238]=_0x48884a,_0x3a6238++);}),tgBot['sendMessage'](_0x2d907c['chat']['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20start?',{'reply_markup':{'inline_keyboard':_0x449492}})['catch'](_0x404547=>{telegramError(_0x404547);}),tgBot['on'](_0x492a58(0x109),async _0x47aeb5=>{const _0x2a7c9e=_0x492a58,_0x16f944=_0x47aeb5[_0x2a7c9e(0x89)],_0x58e242=_0x47aeb5['message'];tgBot[_0x2a7c9e(0xfc)](_0x47aeb5['id'])['then'](async()=>{const _0x384a38=_0x2a7c9e;if(_0x16f944=='all'){if(settings[_0x384a38(0x111)]=='orders')tgBot['sendMessage'](_0x58e242[_0x384a38(0xa2)]['id'],_0x384a38(0x171))[_0x384a38(0x1a5)](_0x5a8cdf=>{telegramError(_0x5a8cdf);});_0x32ea8c[_0x384a38(0x12f)](_0x4d67cf=>{const _0x37f848=_0x384a38;if(_0x4d67cf[_0x37f848(0x87)]!='all')toggleBot(_0x4d67cf[_0x37f848(0x87)],toggleStatus(_0x4d67cf[_0x37f848(0x87)]),'stopped');});}else{if(settings[_0x384a38(0x111)]==_0x384a38(0x126))tgBot[_0x384a38(0xb7)](_0x58e242[_0x384a38(0xa2)]['id'],_0x384a38(0x161)+_0x16f944)[_0x384a38(0x1a5)](_0x5427a8=>{telegramError(_0x5427a8);});toggleBot(_0x16f944,toggleStatus(_0x16f944),_0x384a38(0xa5));}}),tgBot[_0x2a7c9e(0xa3)](_0x2a7c9e(0x109));});}}),tgBot['onText'](/\/off/,_0x41e6c6=>{const _0x4ab3dd=_0x53bbcc;if(!validateTelegram(_0x41e6c6))return;tgBot[_0x4ab3dd(0xa3)](_0x4ab3dd(0x109));const _0xaec396=getEnabledBots();if(_0xaec396['length']==0x0)tgBot[_0x4ab3dd(0xb7)](_0x41e6c6[_0x4ab3dd(0xa2)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x4ab3dd(0x1a5)](_0xcae34f=>{telegramError(_0xcae34f);});else{if(_0xaec396[_0x4ab3dd(0x167)]>0x1)_0xaec396[_0x4ab3dd(0x1b6)]({'botID':_0x4ab3dd(0x196)});let _0xe2ad0a=[],_0x58cb69=[];const _0x51a7f2=_0xaec396[_0x4ab3dd(0x167)]%0x4==0x0||_0xaec396[_0x4ab3dd(0x167)]%0x4==0x3||_0xaec396[_0x4ab3dd(0x167)]%0x3==0x1?0x4:0x3;let _0x3a209b=0x0;_0xaec396[_0x4ab3dd(0x12f)]((_0x439559,_0x4b5731)=>{const _0x56b69f=_0x4ab3dd;if(_0x4b5731%_0x51a7f2==0x0)_0x58cb69=[];_0x58cb69[_0x56b69f(0x1b6)]({'text':_0x439559[_0x56b69f(0x87)]==_0x56b69f(0x196)?_0x56b69f(0xf5):_0x56b69f(0x158)+_0x439559[_0x56b69f(0x87)],'callback_data':_0x439559[_0x56b69f(0x87)]}),_0x4b5731%_0x51a7f2==0x0&&(_0xe2ad0a[_0x3a209b]=_0x58cb69,_0x3a209b++);}),tgBot[_0x4ab3dd(0xb7)](_0x41e6c6[_0x4ab3dd(0xa2)]['id'],_0x4ab3dd(0x193),{'reply_markup':{'inline_keyboard':_0xe2ad0a}})[_0x4ab3dd(0x1a5)](_0x5af654=>{telegramError(_0x5af654);}),tgBot['on'](_0x4ab3dd(0x109),async _0x4b1e2d=>{const _0x4d75d3=_0x4ab3dd,_0x13263f=_0x4b1e2d[_0x4d75d3(0x89)],_0x7f025e=_0x4b1e2d[_0x4d75d3(0xe3)];tgBot[_0x4d75d3(0xfc)](_0x4b1e2d['id'])[_0x4d75d3(0x85)](async()=>{const _0x1736f2=_0x4d75d3;if(_0x13263f==_0x1736f2(0x196)){if(settings[_0x1736f2(0x111)]=='orders')tgBot[_0x1736f2(0xb7)](_0x7f025e[_0x1736f2(0xa2)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x1736f2(0x1a5)](_0x4dd9a6=>{telegramError(_0x4dd9a6);});_0xaec396['forEach'](_0x3c617d=>{const _0x2caa89=_0x1736f2;if(_0x3c617d[_0x2caa89(0x87)]!=_0x2caa89(0x196))toggleBot(_0x3c617d[_0x2caa89(0x87)],toggleStatus(_0x3c617d[_0x2caa89(0x87)]),_0x2caa89(0xa5));});}else{if(settings['telegramEvents']==_0x1736f2(0x126))tgBot[_0x1736f2(0xb7)](_0x7f025e[_0x1736f2(0xa2)]['id'],_0x1736f2(0xfe)+_0x13263f)[_0x1736f2(0x1a5)](_0x2618ae=>{telegramError(_0x2618ae);});toggleBot(_0x13263f,toggleStatus(_0x13263f),'stopped');}}),tgBot[_0x4d75d3(0xa3)](_0x4d75d3(0x109));});}}),tgBot[_0x53bbcc(0x103)](/\/disable/,_0x227805=>{const _0x3ad3c8=_0x53bbcc;if(!validateTelegram(_0x227805))return;tgBot[_0x3ad3c8(0xb7)](_0x227805[_0x3ad3c8(0xa2)]['id'],_0x3ad3c8(0xed))['catch'](_0x29de38=>{telegramError(_0x29de38);}),updateSetting(_0x3ad3c8(0x19b),![]);}),tgBot[_0x53bbcc(0x103)](/\/help/,_0x40928c=>{const _0x57e868=_0x53bbcc;if(!validateTelegram(_0x40928c))return;tgBot['sendMessage'](_0x40928c[_0x57e868(0xa2)]['id'],_0x2f63f8)[_0x57e868(0x1a5)](_0x2fd34b=>{telegramError(_0x2fd34b);});}),tgBot['on'](_0x53bbcc(0x133),_0x1faf69=>{const _0x2987f3=_0x53bbcc;_0x1faf69['toString']()['includes']('404\x20Not\x20Found')&&(logging(_0x2987f3(0x17d)),tgBot[_0x2987f3(0x150)](),tgBot=null,io['to'](_0x2987f3(0xd1))[_0x2987f3(0x1a4)](_0x2987f3(0x120),_0x2987f3(0x17d)));}),process[_0x53bbcc(0x165)]('SIGINT',()=>{const _0x5e0d23=_0x53bbcc;if(tgBot)tgBot[_0x5e0d23(0x150)]();process['exit'](0x1);}),process['once'](_0x53bbcc(0x17e),()=>{const _0x44cee3=_0x53bbcc;if(tgBot)tgBot[_0x44cee3(0x150)]();process[_0x44cee3(0xb5)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x51d5dc,_0x14533e){const _0x3a424f=_0x84d66e;if(settings[_0x3a424f(0x19b)]){if(settings['telegramEvents']=='all'||(_0x14533e[_0x3a424f(0xdc)]==_0x3a424f(0x187)||_0x14533e[_0x3a424f(0xdc)]==_0x3a424f(0x1b8))&&settings['telegramEvents']==_0x3a424f(0x73)||_0x14533e['type']==_0x3a424f(0x121)&&settings[_0x3a424f(0x111)]==_0x3a424f(0x126)){if(tgBot&&settings[_0x3a424f(0x17f)]){if(_0x14533e[_0x3a424f(0xd8)])tgBot[_0x3a424f(0xb7)](settings[_0x3a424f(0x17f)],_0x14533e['botname']+_0x3a424f(0xe4)+_0x14533e[_0x3a424f(0x19a)])['catch'](_0x6d11e3=>{telegramError(_0x6d11e3);});else tgBot[_0x3a424f(0xb7)](settings[_0x3a424f(0x17f)],'Bot\x20'+_0x51d5dc+'\x20>\x20'+_0x14533e[_0x3a424f(0x19a)])[_0x3a424f(0x1a5)](_0x114967=>{telegramError(_0x114967);});}}}}function getDeviceWithIp(_0x44aa94){const _0x5ac53d=_0x84d66e;return devices[_0x5ac53d(0x160)](_0x459625=>_0x459625['ip']===_0x44aa94);}function temporaryAccess2FA(_0x3f4b80,_0x5e645f){const _0x2973c8=_0x84d66e;let _0x179cf0=new Date(),_0x3101b4=![];if(lastIpApproval){if(_0x179cf0-lastIpApproval<0x1388)_0x3101b4=!![];}lastIpApproval=new Date();if(_0x3101b4)return;tgBot&&settings[_0x2973c8(0x17f)]&&(tgBot[_0x2973c8(0xa3)](_0x2973c8(0x109)),tgBot['sendMessage'](settings['telegramChatId'],_0x2973c8(0x131)+normalizeIP(_0x5e645f)['show']+_0x2973c8(0xad),{'parse_mode':_0x2973c8(0x135),'reply_markup':{'inline_keyboard':[[{'text':_0x2973c8(0x10a),'callback_data':'5'},{'text':_0x2973c8(0xcd),'callback_data':'15'},{'text':_0x2973c8(0x82),'callback_data':'30'},{'text':_0x2973c8(0x18a),'callback_data':_0x2973c8(0x18a)}]]}})[_0x2973c8(0x1a5)](_0x69f888=>{telegramError(_0x69f888);}),tgBot['on']('callback_query',async _0x5d5906=>{const _0x3c9469=_0x2973c8,_0x425713=_0x5d5906[_0x3c9469(0x89)],_0x6aaa48=_0x5d5906[_0x3c9469(0xe3)];tgBot[_0x3c9469(0xfc)](_0x5d5906['id'])['then'](async()=>{const _0x26d7f1=_0x3c9469;devices[_0x3f4b80]['telegramIpApproval']={'clientip':_0x5e645f,'timestamp':new Date()[_0x26d7f1(0x12e)](),'expiry':_0x425713},_0x425713!=_0x26d7f1(0x18a)?(await tgBot[_0x26d7f1(0xb7)](_0x6aaa48[_0x26d7f1(0xa2)]['id'],'Access\x20enabled\x20for\x20'+_0x425713+_0x26d7f1(0x92),{'parse_mode':_0x26d7f1(0x135)})[_0x26d7f1(0x1a5)](_0x1b4db3=>{telegramError(_0x1b4db3);}),io['to'](_0x3f4b80)[_0x26d7f1(0x1a4)](_0x26d7f1(0x1b2),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x26d7f1(0xb7)](_0x6aaa48['chat']['id'],_0x26d7f1(0xe9))[_0x26d7f1(0x1a5)](_0x2abd18=>{telegramError(_0x2abd18);}),io['to'](_0x3f4b80)[_0x26d7f1(0x1a4)](_0x26d7f1(0x1b2),{'access':{'allow':![],'reason':_0x26d7f1(0xa9),'token':null}}));}),tgBot['removeListener'](_0x3c9469(0x109));}));}function loginAccess2FA(_0x38188a,_0x17a4dc){const _0x435f50=_0x84d66e;tgBot&&settings['telegramChatId']&&(tgBot[_0x435f50(0xa3)]('callback_query'),tgBot[_0x435f50(0xb7)](settings[_0x435f50(0x17f)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x17a4dc)['show']+_0x435f50(0xad),{'parse_mode':_0x435f50(0x135),'reply_markup':{'inline_keyboard':[[{'text':_0x435f50(0x12c),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x435f50(0x18a)}]]}})[_0x435f50(0x1a5)](_0x19b955=>{telegramError(_0x19b955);}),tgBot['on'](_0x435f50(0x109),async _0x522063=>{const _0x24a092=_0x435f50,_0x468e75=_0x522063[_0x24a092(0x89)],_0x5a1eea=_0x522063[_0x24a092(0xe3)];tgBot[_0x24a092(0xfc)](_0x522063['id'])['then'](async()=>{const _0x4ad44e=_0x24a092;devices[_0x38188a]['telegram2FaApproval']={'clientip':_0x17a4dc,'timestamp':new Date()['getTime'](),'expiry':_0x468e75},_0x468e75!=_0x4ad44e(0x18a)?(await tgBot[_0x4ad44e(0xb7)](_0x5a1eea[_0x4ad44e(0xa2)]['id'],'Login\x20accepted',{'parse_mode':_0x4ad44e(0x135)})[_0x4ad44e(0x1a5)](_0x2794c1=>{telegramError(_0x2794c1);}),io['to'](_0x38188a)[_0x4ad44e(0x1a4)]('status',{'access':{'allow':![],'reason':_0x4ad44e(0x10f),'token':null}})):(await tgBot[_0x4ad44e(0xb7)](_0x5a1eea[_0x4ad44e(0xa2)]['id'],_0x4ad44e(0xa4))[_0x4ad44e(0x1a5)](_0x45713a=>{telegramError(_0x45713a);}),io['to'](_0x38188a)['emit']('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x24a092(0xa3)](_0x24a092(0x109));}));}function getConfiguration(){const _0x113f55=_0x84d66e;return dbConfig['get']('bots')[_0x113f55(0x192)](_0x113f55(0x87))[_0x113f55(0x14c)]()||[];}function getEnabledBots(){const _0x4cb4ff=_0x84d66e;return dbConfig[_0x4cb4ff(0x149)](_0x4cb4ff(0x115))[_0x4cb4ff(0x192)](_0x4cb4ff(0x87))['filter']({'status':_0x4cb4ff(0xe7)})[_0x4cb4ff(0x14c)]()||[];}function getDisabledBots(){const _0x54f17c=_0x84d66e;return dbConfig[_0x54f17c(0x149)](_0x54f17c(0x115))[_0x54f17c(0x192)]('botID')['filter']({'status':_0x54f17c(0x12a)})[_0x54f17c(0x14c)]()||[];}function _0x297e(_0x1fca24,_0x14f4f6){const _0x1c87eb=_0x5af8();return _0x297e=function(_0x54cf6b,_0x4f4ba2){_0x54cf6b=_0x54cf6b-0x71;let _0x5af8f7=_0x1c87eb[_0x54cf6b];return _0x5af8f7;},_0x297e(_0x1fca24,_0x14f4f6);}function getSettings(){const _0x535a59=_0x84d66e;return dbSettings['get'](_0x535a59(0x80))[_0x535a59(0x14c)]()||{'timeshift':0x0};}function getSecure(){const _0x5c7f6a=_0x84d66e;return dbSecure['get'](_0x5c7f6a(0xfa))['value']()||{};}function getBlacklist(){const _0x2a1818=_0x84d66e;return dbSecure[_0x2a1818(0x149)](_0x2a1818(0x117))[_0x2a1818(0x14c)]()||[];}function broadcastToBots(_0x4d88b2,_0x2c1e75){const _0x292cbe=_0x84d66e;config[_0x292cbe(0x12f)](_0x26e942=>{const _0x6db6b8=_0x292cbe;if(_0x26e942[_0x6db6b8(0x1b2)]==_0x6db6b8(0xe7)&&_0x26e942['live']==_0x6db6b8(0x124)){if(pid[_0x26e942[_0x6db6b8(0x87)]])pid[_0x26e942[_0x6db6b8(0x87)]][_0x6db6b8(0x146)]({[_0x4d88b2]:_0x2c1e75});}});}function storeSettings(_0x3b3889,_0x32ff0e=![]){const _0x44384f=_0x84d66e;_0x3b3889={...settings,..._0x3b3889};if(_0x32ff0e&&_0x3b3889[_0x44384f(0xb9)]!=_0x44384f(0x18e)&&_0x3b3889['bbPassword']!=''){const _0x5c9c4d=crypt[_0x44384f(0x15c)](secure['privateKey'],_0x3b3889[_0x44384f(0xb9)])[_0x44384f(0xe3)][_0x44384f(0x7e)]('@')[0x0],_0x22b5e2=bcrypt['hashSync'](_0x5c9c4d,saltRounds);_0x3b3889={..._0x3b3889,'bbPassword':_0x22b5e2};}if(_0x32ff0e&&_0x3b3889[_0x44384f(0xf3)]!=_0x44384f(0x18e)&&_0x3b3889[_0x44384f(0xf3)]!=''){const _0x542d6d=crypt[_0x44384f(0x15c)](secure[_0x44384f(0xe6)],_0x3b3889[_0x44384f(0xf3)])['message'][_0x44384f(0x7e)]('@')[0x0];_0x3b3889={..._0x3b3889,'telegramToken':_0x542d6d};}const _0x46617d=_0x3b3889['telegramToken']!=_0x44384f(0x18e)&&_0x3b3889[_0x44384f(0xf3)]!=settings[_0x44384f(0xf3)]||_0x3b3889[_0x44384f(0xd2)]!=settings[_0x44384f(0xd2)],_0x15189b=_0x3b3889[_0x44384f(0xf3)]==''||_0x3b3889[_0x44384f(0xd2)]=='';if(_0x46617d)_0x3b3889['telegramEvents']=_0x44384f(0x196);for(const [_0x3097ba,_0x45c1fa]of Object[_0x44384f(0x15d)](_0x3b3889)){if(_0x3097ba=='telegramToken'&&_0x45c1fa=='************'){_0x3b3889[_0x44384f(0xf3)]=settings[_0x44384f(0xf3)];continue;};if(_0x3097ba==_0x44384f(0xb9)&&_0x45c1fa==_0x44384f(0x18e)){_0x3b3889[_0x44384f(0xb9)]=settings[_0x44384f(0xb9)];continue;};dbSettings[_0x44384f(0xb8)](_0x44384f(0xd0)+_0x3097ba,_0x45c1fa)[_0x44384f(0x151)]();}settings=_0x3b3889,io['to'](_0x44384f(0xd1))['emit'](_0x44384f(0x80),cleanSettings()),broadcastToBots(_0x44384f(0x1b4),settings[_0x44384f(0x1b4)]);if(_0x46617d&&!_0x15189b)initTelegram();if(_0x46617d&&_0x15189b)disableTelegram();getAllClients()[_0x44384f(0x12f)](_0x21305a=>{const _0x1814fa=_0x44384f;getSocket(_0x21305a['id'])[_0x1814fa(0x1a4)](_0x1814fa(0x1b2),{'access':{'allow':![],'reason':_0x1814fa(0x10f),'token':null}});});}function updateSetting(_0x648da7,_0x5e9fbd){const _0x4a6932=_0x84d66e;dbSettings[_0x4a6932(0xb8)](_0x4a6932(0xd0)+_0x648da7,_0x5e9fbd)['write'](),settings=getSettings(),io['to']('botmanager')[_0x4a6932(0x1a4)](_0x4a6932(0x80),cleanSettings());}function storeSecure(_0x53b516){const _0x424d50=_0x84d66e;dbSecure['get'](_0x424d50(0xfa))[_0x424d50(0x1b6)](_0x53b516)['write'](),secure=_0x53b516;}function addBlacklist(_0x3d7a4f){const _0x301079=_0x84d66e;cleanBlacklist();let _0x17dbae;devices[_0x3d7a4f][_0x301079(0x199)]?_0x17dbae=Math[_0x301079(0x1a7)](devices[_0x3d7a4f]['telegramIpApproval']['expiry'],loginExpiry):_0x17dbae=loginExpiry,dbSecure[_0x301079(0x149)]('blacklist')[_0x301079(0x1b6)]({'expiry':new Date()[_0x301079(0x12e)]()+_0x17dbae*0x3c*0x3e8,'token':devices[_0x3d7a4f][_0x301079(0xcb)][_0x301079(0x96)]})[_0x301079(0x151)](),blacklist=dbSecure[_0x301079(0x149)]('blacklist')[_0x301079(0x14c)]();}function cleanBlacklist(){const _0x3e6e77=_0x84d66e;let _0x2439ea=dbSecure['get'](_0x3e6e77(0x117))['cloneDeep']()[_0x3e6e77(0x14c)](),_0x16c130=new Date()[_0x3e6e77(0x12e)]();_0x2439ea[_0x3e6e77(0x12f)](_0xb1a5c=>{const _0x2003ae=_0x3e6e77;_0xb1a5c[_0x2003ae(0x19f)]<_0x16c130&&dbSecure[_0x2003ae(0x149)](_0x2003ae(0x117))[_0x2003ae(0x12d)]({'expiry':_0xb1a5c[_0x2003ae(0x19f)]})['write']();});}function initStates(){const _0x2e944b=_0x84d66e;let _0x58cb95=getConfiguration();_0x58cb95[_0x2e944b(0x12f)](_0x358af8=>{const _0x54d904=_0x2e944b;_0x358af8[_0x54d904(0x174)]=_0x54d904(0xa5);}),storeConfiguration(_0x58cb95);}function onKeys(){const _0x2c28ec=new RSA();return new Promise(_0x460fc0=>{const _0x3a97dd=_0x297e;_0x2c28ec[_0x3a97dd(0x7d)]()[_0x3a97dd(0x85)](_0x1bc47c=>{_0x460fc0(_0x1bc47c);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x8ecab1=_0x84d66e;let _0x790446=getConfiguration(),_0x431c21=![];_0x790446[_0x8ecab1(0x12f)](_0x42b851=>{const _0x28011a=_0x8ecab1;if(_0x42b851[_0x28011a(0x1b2)]==_0x28011a(0x124))_0x42b851[_0x28011a(0x1b2)]='enabled',_0x431c21=!![];else _0x42b851[_0x28011a(0x1b2)]==_0x28011a(0xa5)&&(_0x42b851[_0x28011a(0x1b2)]=_0x28011a(0x12a),_0x431c21=!![]);});if(_0x431c21)storeConfiguration(_0x790446);let _0x521154=getSecure();if(!_0x521154[_0x8ecab1(0x172)](_0x8ecab1(0x195))){let _0x1ccbe5=await generateKeys();_0x521154[_0x8ecab1(0x125)]=_0x1ccbe5[_0x8ecab1(0x125)],_0x521154[_0x8ecab1(0xe6)]=_0x1ccbe5[_0x8ecab1(0xe6)],_0x521154['secret']=crypto[_0x8ecab1(0x13b)](0x20)['toString']('hex');;storeSecure(_0x521154);}let _0xd7b251=getSettings();_0x431c21=![];!_0xd7b251[_0x8ecab1(0x172)](_0x8ecab1(0xaf))&&(_0xd7b251[_0x8ecab1(0xaf)]=![],_0xd7b251[_0x8ecab1(0x15f)]='',_0xd7b251[_0x8ecab1(0xb9)]='',_0xd7b251[_0x8ecab1(0x152)]=![],_0x431c21=!![]);!_0xd7b251[_0x8ecab1(0x172)]('whitelistEnabled')&&(_0xd7b251[_0x8ecab1(0x197)]=![],_0xd7b251[_0x8ecab1(0x16c)]=[],_0xd7b251[_0x8ecab1(0x16d)]=![],_0x431c21=!![]);if(!_0xd7b251['hasOwnProperty']('telegramEnabled')){if(_0xd7b251['telegramChatId'])_0xd7b251['telegramEnabled']=!![];else _0xd7b251['telegramEnabled']=![];_0x431c21=!![];}if(_0x431c21)storeSettings(_0xd7b251);}function storeConfiguration(_0x26e2da){const _0x1de51b=_0x84d66e;dbConfig['get'](_0x1de51b(0x115))['remove']()[_0x1de51b(0x151)](),dbConfig[_0x1de51b(0x149)]('bots')[_0x1de51b(0x1b6)](..._0x26e2da)['write'](),config=_0x26e2da;}function resetPassword(){const _0xae81ed=_0x84d66e;tgBot&&settings[_0xae81ed(0x17f)]&&(tgBot[_0xae81ed(0xa3)](_0xae81ed(0x109)),tgBot['sendMessage'](settings[_0xae81ed(0x17f)],_0xae81ed(0x140),{'parse_mode':_0xae81ed(0x135),'reply_markup':{'inline_keyboard':[[{'text':_0xae81ed(0xef),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0xae81ed(0x1a5)](_0x4fa7f8=>{telegramError(_0x4fa7f8);}),tgBot['on'](_0xae81ed(0x109),async _0x8fbaa2=>{const _0x18f519=_0xae81ed,_0x3307a4=_0x8fbaa2[_0x18f519(0x89)],_0xa60f9f=_0x8fbaa2['message'];tgBot['answerCallbackQuery'](_0x8fbaa2['id'])[_0x18f519(0x85)](async()=>{const _0x238866=_0x18f519;if(_0x3307a4!='no'){const _0x52895a=0xf,_0x2fa505='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x270c7c=Array['from'](crypto[_0x238866(0xf2)](new Uint32Array(_0x52895a)))[_0x238866(0xc4)](_0x2a22cc=>_0x2fa505[_0x2a22cc%_0x2fa505['length']])[_0x238866(0x19d)](''),_0x3cb2c6=bcrypt['hashSync'](_0x270c7c,saltRounds);storeSettings({'bbPassword':_0x3cb2c6}),await tgBot[_0x238866(0xb7)](_0xa60f9f['chat']['id'],_0x238866(0x198)+_0x270c7c,{'parse_mode':'HTML'})[_0x238866(0x1a5)](_0x3673fe=>{telegramError(_0x3673fe);});}else await tgBot[_0x238866(0xb7)](_0xa60f9f['chat']['id'],_0x238866(0x102))[_0x238866(0x1a5)](_0x5dd34c=>{telegramError(_0x5dd34c);});}),tgBot[_0x18f519(0xa3)](_0x18f519(0x109));}));}function logging(_0x50ccf8){const _0x454394=_0x84d66e;console[_0x454394(0x15a)](getTimeStamp()+_0x454394(0x77)+_0x50ccf8);if(tgBot&&settings[_0x454394(0x17f)]&&settings[_0x454394(0x111)]!=_0x454394(0x126))tgBot[_0x454394(0xb7)](settings[_0x454394(0x17f)],'Bot\x20Mgr\x20>\x20'+_0x50ccf8)[_0x454394(0x1a5)](_0x1861f5=>{telegramError(_0x1861f5);});}function getServerTime(){const _0x443317=_0x84d66e,_0x3535fc=new Date();return _0x3535fc[_0x443317(0xab)]()+'/'+(_0x3535fc[_0x443317(0x113)]()+0x1)[_0x443317(0xce)]()['padStart'](0x2,'0')+'/'+_0x3535fc['getDate']()[_0x443317(0xce)]()[_0x443317(0x129)](0x2,'0')+'\x20'+_0x3535fc[_0x443317(0xc0)]()[_0x443317(0xce)]()[_0x443317(0x129)](0x2,'0')+':'+_0x3535fc[_0x443317(0x1ab)]()[_0x443317(0xce)]()[_0x443317(0x129)](0x2,'0')+':'+_0x3535fc['getSeconds']()[_0x443317(0xce)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x5c63e4=_0x84d66e,_0x36ea12=shiftedTime();return _0x36ea12[_0x5c63e4(0xab)]()+'/'+(_0x36ea12[_0x5c63e4(0x113)]()+0x1)[_0x5c63e4(0xce)]()[_0x5c63e4(0x129)](0x2,'0')+'/'+_0x36ea12['getDate']()[_0x5c63e4(0xce)]()['padStart'](0x2,'0')+'\x20'+_0x36ea12[_0x5c63e4(0xc0)]()[_0x5c63e4(0xce)]()[_0x5c63e4(0x129)](0x2,'0')+':'+_0x36ea12[_0x5c63e4(0x1ab)]()[_0x5c63e4(0xce)]()[_0x5c63e4(0x129)](0x2,'0')+':'+_0x36ea12['getSeconds']()[_0x5c63e4(0xce)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x4383d7=_0x84d66e,_0x13f38e=new Date();let _0x160656=_0x13f38e;if(settings[_0x4383d7(0x1b4)]&&settings[_0x4383d7(0x1b4)]!==0x0)_0x160656=fns[_0x4383d7(0x9b)](_0x13f38e,{'hours':settings[_0x4383d7(0x1b4)]});return _0x160656;}function startScheduler(){const _0x351b1b=_0x84d66e;let _0x2c8023=new Date()[_0x351b1b(0x170)]();_0x2c8023==0x1&&backupConfigFiles();_0x2c8023==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x2637d0=_0x84d66e;fs[_0x2637d0(0x1ad)](configpath,{'withFileTypes':!![]})[_0x2637d0(0x12f)](_0x4db1a7=>{const _0xf58fe9=_0x2637d0;if(!_0x4db1a7[_0xf58fe9(0xca)]())fs[_0xf58fe9(0x184)](configpath+_0x4db1a7['name'],configbackuppath+_0x4db1a7['name']);});}function triggerAnalytics(){const _0x82a5d4=_0x84d66e;analytics[_0x82a5d4(0x186)]({'title':'Balance\x20Bot\x20Server','href':_0x82a5d4(0xbb),'path':'/v'+serverversion});}function validateCredentials(_0x495302,_0x28c16f){const _0x2cf403=_0x84d66e;if(_0x495302[_0x2cf403(0x9e)]==settings[_0x2cf403(0x15f)]&&bcrypt[_0x2cf403(0xcc)](_0x495302['password'],settings['bbPassword'])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x2cf403(0x18f),'token':null};else{const _0x306179=generateLoginToken(_0x28c16f);return{'allow':!![],'reason':_0x2cf403(0x110),'token':_0x306179};}}else return{'allow':![],'reason':_0x2cf403(0x1af),'token':null};}function refreshToken(_0x530db0){const _0x20af66=generateLoginToken(_0x530db0);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x20af66};}function validateAccess(_0x21ab3b,_0x1598a7){const _0x3ab865=_0x84d66e;let _0x141b1d=devices[_0x1598a7]['ip'],_0x2d7791;const _0x3b86fb=_0x229ea0=>{const _0x3ac4c4=_0x297e;if(settings['loginRequired']){if(settings['f2aRequired']){if(telegram2FaApproved(_0x1598a7)){const _0x339279=generateLoginToken(_0x1598a7);return{'allow':!![],'reason':_0x3ac4c4(0xa8),'token':_0x339279};}else return{'allow':![],'reason':_0x3ac4c4(0x12b),'token':null};}else return _0x2d7791=validToken(_0x229ea0,_0x1598a7),_0x2d7791[_0x3ac4c4(0x172)]('success')?{'allow':!![],'reason':_0x3ac4c4(0x132),'token':_0x229ea0}:{'allow':![],'reason':_0x3ac4c4(0x12b),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings['whitelistEnabled']){let _0x288e47=[...settings[_0x3ab865(0x16c)],_0x3ab865(0xec),_0x3ab865(0x8b),'127.0.0.1'];if(_0x288e47[_0x3ab865(0x7f)](_0x141b1d))return _0x3b86fb(_0x21ab3b);else{_0x2d7791=validToken(_0x21ab3b,_0x1598a7);if(_0x2d7791['hasOwnProperty'](_0x3ab865(0x1b8)))return _0x3b86fb(_0x21ab3b);else{if(telegramIpApproved(_0x1598a7)){const _0x53c7e0=generateToken(_0x1598a7);return _0x2d7791=_0x3b86fb(_0x21ab3b),_0x2d7791[_0x3ab865(0xda)]?{'allow':!![],'reason':_0x3ab865(0x180),'token':_0x53c7e0}:_0x2d7791;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x3ab865(0x76),'token':null}:{'allow':![],'reason':_0x3ab865(0xa0),'token':null};}}}else return _0x3b86fb(_0x21ab3b);}function timelyDecrypt(_0x257315,_0x3dda7b=!![]){const _0x1b120a=_0x84d66e;if(_0x257315)try{const _0x238e35=crypt[_0x1b120a(0x15c)](secure[_0x1b120a(0xe6)],_0x257315)[_0x1b120a(0xe3)],_0x1fe3c0=_0x238e35['split']('@')[0x0],_0x4f151c=_0x238e35[_0x1b120a(0x7e)]('@')[0x1],_0x1e4a6c=new Date()['getTime']();if(_0x3dda7b){if(_0x1e4a6c-_0x4f151c<maxSecretAge*0x3e8)return _0x1fe3c0;else return![];}else return _0x1fe3c0;}catch(_0x351fc6){return![];}else return![];}const validToken=(_0x2ecbea,_0x5e7bf3)=>{const _0x3c95db=_0x84d66e,_0x2103a7=devices[_0x5e7bf3]['ip'];if(!_0x2ecbea)return{'error':_0x3c95db(0xac)};for(let _0x4a1748 of blacklist){if(_0x4a1748[_0x3c95db(0x96)]==_0x2ecbea)return{'error':_0x3c95db(0x1a0)};}let _0x4bbf6c;try{_0x4bbf6c=jwt['verify'](_0x2ecbea,secure[_0x3c95db(0x195)]+_0x5e7bf3);}catch{return{'error':_0x3c95db(0x8c)};}if(!_0x4bbf6c[_0x3c95db(0x172)](_0x3c95db(0xd6))&&!_0x4bbf6c[_0x3c95db(0x172)]('username')||!_0x4bbf6c[_0x3c95db(0x172)]('exp'))return{'error':_0x3c95db(0x148)};if(!_0x4bbf6c[_0x3c95db(0x172)](_0x3c95db(0x9e))&&_0x4bbf6c[_0x3c95db(0x172)](_0x3c95db(0xd6))){const {clientip:_0x17d72c}=_0x4bbf6c;return _0x2103a7==_0x17d72c?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x3c95db(0x9c)};}else{if(_0x4bbf6c['hasOwnProperty']('username')&&_0x4bbf6c[_0x3c95db(0x172)](_0x3c95db(0xd6))){const {username:_0xaeb091,clientip:_0x32389b}=_0x4bbf6c;return settings['bbUsername']==_0xaeb091&&_0x2103a7==_0x32389b?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x3c95db(0x176)};}}},generateLoginToken=_0x3b07c0=>{const _0x4dc9bd=_0x84d66e;if(_0x3b07c0){const _0x2631e4=devices[_0x3b07c0]['ip'];return jwt[_0x4dc9bd(0x7b)]({'username':settings['bbUsername'],'clientip':_0x2631e4},secure['secret']+_0x3b07c0,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x199265=>{const _0x563964=_0x84d66e;if(_0x199265){const _0x2bc2b0=devices[_0x199265]['ip'];return jwt['sign']({'clientip':_0x2bc2b0},secure['secret']+_0x199265,{'expiresIn':devices[_0x199265][_0x563964(0x199)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x250131=>{const _0x20b3c6=_0x84d66e;let _0x470040=![];return devices[_0x250131][_0x20b3c6(0x199)]&&devices[_0x250131][_0x20b3c6(0x199)][_0x20b3c6(0x19f)]!=_0x20b3c6(0x18a)&&(_0x470040=devices[_0x250131][_0x20b3c6(0x199)][_0x20b3c6(0xd6)]==devices[_0x250131]['ip']&&new Date()[_0x20b3c6(0x12e)]()-devices[_0x250131][_0x20b3c6(0x199)][_0x20b3c6(0xaa)]<devices[_0x250131][_0x20b3c6(0x199)][_0x20b3c6(0x19f)]*0x3c*0x3e8),_0x470040;},telegram2FaApproved=_0x19595b=>{const _0x51b800=_0x84d66e;let _0x3f33ab=![];return devices[_0x19595b][_0x51b800(0x1b3)]&&devices[_0x19595b][_0x51b800(0x1b3)]['expiry']!=_0x51b800(0x18a)&&(_0x3f33ab=devices[_0x19595b][_0x51b800(0x1b3)]['clientip']==devices[_0x19595b]['ip']&&new Date()[_0x51b800(0x12e)]()-devices[_0x19595b][_0x51b800(0x1b3)][_0x51b800(0xaa)]<devices[_0x19595b]['telegram2FaApproval'][_0x51b800(0x19f)]*0x3c*0x3e8),_0x3f33ab;},normalizeIP=_0x5adc56=>{const _0x18c7fa=_0x84d66e;let _0x51c48a=null,_0x150531=null;if(ipaddr['isValid'](_0x5adc56)){const _0x5ab853=ipaddr[_0x18c7fa(0x14d)](_0x5adc56);_0x5ab853[_0x18c7fa(0x100)]()===_0x18c7fa(0x84)?(_0x5ab853[_0x18c7fa(0x191)]()&&(_0x51c48a=_0x5ab853['toIPv4Address']()[_0x18c7fa(0xce)]()),_0x150531=_0x5ab853[_0x18c7fa(0xce)]()):(_0x51c48a=_0x5ab853[_0x18c7fa(0xce)](),_0x150531=_0x5ab853['toIPv4MappedAddress']()[_0x18c7fa(0xce)]());}return{'show':_0x51c48a?_0x51c48a:_0x150531,'store':_0x150531};};