const _0x4ad479=_0xc8be;(function(_0x4a4add,_0xf3643b){const _0x2fe2eb=_0xc8be,_0x4f14cd=_0x4a4add();while(!![]){try{const _0x2f3625=parseInt(_0x2fe2eb(0x2f3))/0x1*(parseInt(_0x2fe2eb(0x20a))/0x2)+-parseInt(_0x2fe2eb(0x246))/0x3+-parseInt(_0x2fe2eb(0x2d6))/0x4+parseInt(_0x2fe2eb(0x300))/0x5*(parseInt(_0x2fe2eb(0x202))/0x6)+parseInt(_0x2fe2eb(0x1f7))/0x7+parseInt(_0x2fe2eb(0x215))/0x8*(parseInt(_0x2fe2eb(0x303))/0x9)+-parseInt(_0x2fe2eb(0x35e))/0xa;if(_0x2f3625===_0xf3643b)break;else _0x4f14cd['push'](_0x4f14cd['shift']());}catch(_0x37d2f9){_0x4f14cd['push'](_0x4f14cd['shift']());}}}(_0x7155,0x7ca8a));const _0x384b7b=function(){let _0xe691f0=!![];return function(_0x8abf3c,_0x4cbada){const _0x5a54e4=_0xe691f0?function(){const _0x5b225e=_0xc8be;if(_0x4cbada){const _0x246fc2=_0x4cbada[_0x5b225e(0x2f4)](_0x8abf3c,arguments);return _0x4cbada=null,_0x246fc2;}}:function(){};return _0xe691f0=![],_0x5a54e4;};}(),_0x3bea10=_0x384b7b(this,function(){const _0x5b68e9=_0xc8be;return _0x3bea10[_0x5b68e9(0x273)]()[_0x5b68e9(0x251)]('(((.+)+)+)+$')['toString']()[_0x5b68e9(0x352)](_0x3bea10)[_0x5b68e9(0x251)](_0x5b68e9(0x285));});_0x3bea10();'use strict';process[_0x4ad479(0x1f5)][_0x4ad479(0x252)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require('date-fns'),low=require(_0x4ad479(0x23b)),FileSync=require(_0x4ad479(0x216)),path=require(_0x4ad479(0x369)),crypto=require(_0x4ad479(0x21c)),Crypt=require(_0x4ad479(0x235))[_0x4ad479(0x2fe)],RSA=require(_0x4ad479(0x235))['RSA'],bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),ipaddr=require(_0x4ad479(0x245)),argv=require(_0x4ad479(0x21f))(process[_0x4ad479(0x287)][_0x4ad479(0x2ff)](0x2))[_0x4ad479(0x287)],uuidRandom=require(_0x4ad479(0x34f)),TelegramBot=require(_0x4ad479(0x265)),Mixpanel=require(_0x4ad479(0x2b4)),axios=require(_0x4ad479(0x318)),{GraphQLClient,gql}=require(_0x4ad479(0x307)),util=require(_0x4ad479(0x210)),fileUpload=require(_0x4ad479(0x1f1)),{networkInterfaces}=require('os'),PORT=argv[_0x4ad479(0x23c)]||_0x4ad479(0x1f9),pattern=/^[0-9]{2,4}$/;!pattern[_0x4ad479(0x310)](PORT)&&(console[_0x4ad479(0x295)](_0x4ad479(0x366)+PORT+_0x4ad479(0x25e)),process['exit'](0x1));const HOST=argv[_0x4ad479(0x272)]||null,userID=argv[_0x4ad479(0x2d2)]||'',debugging=argv['d']||![],nodeversion=process[_0x4ad479(0x35c)][_0x4ad479(0x284)];let bbpath=_0x4ad479(0x228),bbpath2='';const botfile=_0x4ad479(0x2c9),configfile=_0x4ad479(0x2af),settingsfile=_0x4ad479(0x3c2),securefile='bb-secure.json',maxBackups=0xa;let validInstallation=!![];!fs[_0x4ad479(0x323)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+'config/'+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x4ad479(0x33b),logspath=userID?bbpath+_0x4ad479(0x267)+userID+'/':bbpath+_0x4ad479(0x267),zippath=userID?bbpath+_0x4ad479(0x30e)+userID+'/':bbpath+_0x4ad479(0x30e),loggerfile=fs[_0x4ad479(0x24d)](logspath+_0x4ad479(0x35f),{'flags':'a'}),temppath=userID?bbpath+_0x4ad479(0x288)+userID+'/':bbpath+'temp/';!fs[_0x4ad479(0x323)](configpath)&&fs[_0x4ad479(0x2a4)](configpath);!fs[_0x4ad479(0x323)](configbackuppath)&&fs[_0x4ad479(0x2a4)](configbackuppath);!fs[_0x4ad479(0x323)](logspath)&&fs[_0x4ad479(0x2a4)](logspath);!fs['existsSync'](zippath)&&fs[_0x4ad479(0x2a4)](zippath);!fs[_0x4ad479(0x323)](temppath)&&fs[_0x4ad479(0x2a4)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x4ad479(0x292)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x4ad479(0x292)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4ad479(0x292)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x4ad479(0x25f),'rsaStandard':_0x4ad479(0x313)});const saltRounds=0xa,mixpanel=Mixpanel[_0x4ad479(0x2b0)](_0x4ad479(0x320),{'host':_0x4ad479(0x32c)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x4ad479(0x2e2)]&&settings[_0x4ad479(0x2e2)]!=''&&settings[_0x4ad479(0x2f0)]&&settings[_0x4ad479(0x2f0)]!='')initTelegram();const parseColor=(_0x59b72a,_0x177662)=>{const _0x72da51=_0x4ad479,_0x32ac32=/#[A-Z]{3}#/g;!_0x177662?_0x59b72a=_0x59b72a['replace'](_0x32ac32,''):(_0x59b72a=_0x59b72a[_0x72da51(0x278)](/#BLU#/g,_0x72da51(0x28d)),_0x59b72a=_0x59b72a[_0x72da51(0x278)](/#RED#/g,'\x1b[31m'),_0x59b72a=_0x59b72a['replace'](/#YEL#/g,_0x72da51(0x2bc)),_0x59b72a=_0x59b72a[_0x72da51(0x278)](/#RES#/g,'\x1b[0m'));;return _0x59b72a;},logger={'screen':_0x4065f8=>{const _0x4d6e0b=_0x4ad479;console[_0x4d6e0b(0x295)](parseColor(_0x4065f8,!![]));},'simple':_0xd35b99=>{const _0x5ab64c=_0x4ad479;console[_0x5ab64c(0x295)](parseColor(_0xd35b99,!![])),loggerfile[_0x5ab64c(0x35d)](util[_0x5ab64c(0x1f3)](parseColor(_0xd35b99,![]))+'\x0a');},'full':async _0x377fdc=>{const _0x4c655c=_0x4ad479,_0x448bfb=getTimeStamp()+_0x4c655c(0x372)+_0x377fdc;console[_0x4c655c(0x295)](parseColor(_0x448bfb,!![])),loggerfile[_0x4c655c(0x35d)](util['format'](parseColor(_0x448bfb,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x4c655c(0x347)]!=_0x4c655c(0x3ab))await tgBot[_0x4c655c(0x21e)](settings[_0x4c655c(0x268)],_0x4c655c(0x277)+parseColor(_0x377fdc,![]))[_0x4c655c(0x29d)](_0x59e70b=>{telegramError(_0x59e70b);});},'debug':async(_0x3d2e4c,_0x1db73c='')=>{const _0x246933=_0x4ad479,_0x17a485=getTimeStamp()+_0x246933(0x296)+_0x3d2e4c;if(debugging)console['log'](parseColor(_0x17a485,!![]));loggerfile[_0x246933(0x35d)](util[_0x246933(0x1f3)](parseColor(_0x17a485,![]))+'\x0a');if(_0x1db73c){if(debugging)console[_0x246933(0x295)](_0x1db73c);loggerfile['write'](util[_0x246933(0x1f3)](_0x1db73c)+'\x0a');}}};process['on']('uncaughtException',function(_0x20f53e){const _0x4e7048=_0x4ad479;logger[_0x4e7048(0x2e1)](_0x20f53e);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x4ad479(0x214))[_0x4ad479(0x2c5)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x4ad479(0x2fb)),app=express(),http=require(_0x4ad479(0x261))[_0x4ad479(0x36d)](app);app[_0x4ad479(0x2be)](fileUpload({'useTempFiles':!![]})),app[_0x4ad479(0x286)](_0x4ad479(0x211),async(_0x20839c,_0x14c644)=>{const _0x178445=_0x4ad479,_0x2b7f28=_0x20839c[_0x178445(0x2bd)][_0x178445(0x25a)],_0x4937a9=getClientsWithBotID('botmanager'),_0x3e1f08=_0x20839c['headers']['uuid'],_0x287e84=timelyDecrypt(_0x3e1f08,![]),_0x53bddc=_0x4937a9[_0x178445(0x2d8)](_0x5a4cd5=>_0x5a4cd5[_0x178445(0x3a4)]==_0x287e84);if(_0x53bddc){const _0x3f842b=normalizeIP(_0x20839c[_0x178445(0x2b1)]['remoteAddress'])[_0x178445(0x274)],_0x3f7dcd=_0x20839c[_0x178445(0x34d)][_0x178445(0x2bf)];if(validateAccess(_0x3f7dcd,_0x287e84,_0x3f842b)[_0x178445(0x321)])_0x2b7f28==_0x178445(0x371)&&await backupConfigFiles(),await zipFiles(_0x2b7f28),_0x14c644[_0x178445(0x223)](zippath+(_0x2b7f28+_0x178445(0x2db)),_0x25205f=>{const _0x5a307e=_0x178445;_0x25205f&&(logger[_0x5a307e(0x22d)](_0x5a307e(0x219)+_0x2b7f28),logger[_0x5a307e(0x2e1)](_0x25205f));});else logger[_0x178445(0x22d)](_0x178445(0x2e9)+_0x2b7f28+'\x20(1)');}else logger[_0x178445(0x22d)](_0x178445(0x2e9)+_0x2b7f28+_0x178445(0x357));}),app[_0x4ad479(0x306)]('/upload-backup',async(_0x3fecc4,_0x46fe32)=>{const _0xdedf8c=_0x4ad479,_0xd4839b=getClientsWithBotID(_0xdedf8c(0x269)),_0xc4d44=_0x3fecc4[_0xdedf8c(0x34d)][_0xdedf8c(0x3a4)],_0x2f7667=timelyDecrypt(_0xc4d44,![]),_0x25ab3a=_0xd4839b[_0xdedf8c(0x2d8)](_0x1e85c8=>_0x1e85c8[_0xdedf8c(0x3a4)]==_0x2f7667);logger['debug'](_0xdedf8c(0x225));if(_0x25ab3a){const _0x49f5e9=normalizeIP(_0x3fecc4[_0xdedf8c(0x2b1)][_0xdedf8c(0x335)])[_0xdedf8c(0x274)],_0x23052e=_0x3fecc4[_0xdedf8c(0x34d)][_0xdedf8c(0x2bf)];if(validateAccess(_0x23052e,_0x2f7667,_0x49f5e9)[_0xdedf8c(0x321)]){if(_0x3fecc4[_0xdedf8c(0x31c)]){const _0x2c4f15=_0x3fecc4[_0xdedf8c(0x31c)][_0xdedf8c(0x2b9)];await _0x2c4f15['mv'](temppath+_0x2c4f15[_0xdedf8c(0x388)]),_0x46fe32[_0xdedf8c(0x32b)]({'status':!![],'message':_0xdedf8c(0x23a)});const _0x11b4fb=getBotsWithMode();_0x11b4fb['length']>0x0?confirmRestore(temppath,_0x2c4f15[_0xdedf8c(0x388)]):unzipFile(temppath,_0x2c4f15[_0xdedf8c(0x388)]);}}else logger[_0xdedf8c(0x22d)](_0xdedf8c(0x299));}else logger[_0xdedf8c(0x22d)](_0xdedf8c(0x26e));}),app[_0x4ad479(0x2be)](express['static'](path['join'](__dirname,bbpath2,_0x4ad479(0x2fd)))),app[_0x4ad479(0x2be)](express[_0x4ad479(0x339)](path[_0x4ad479(0x3b7)](__dirname,bbpath2,_0x4ad479(0x208)))),app[_0x4ad479(0x286)]('/',function(_0x464dd4,_0x2cf33b){const _0x213a6c=_0x4ad479;_0x2cf33b[_0x213a6c(0x2c8)](path[_0x213a6c(0x3b7)](__dirname,bbpath2,_0x213a6c(0x2fd),'index.html'));}),app[_0x4ad479(0x286)]('/:bot',function(_0x4b1850,_0x20956e){const _0x1418bd=_0x4ad479;_0x20956e['sendFile'](path[_0x1418bd(0x3b7)](__dirname,bbpath2,_0x1418bd(0x208),_0x1418bd(0x2f8)));}),app['get'](_0x4ad479(0x240),(_0x2a3cf4,_0x2eb2fe)=>{const _0x175206=_0x4ad479;_0x2eb2fe[_0x175206(0x2c8)](path[_0x175206(0x3b7)](__dirname,bbpath2,_0x175206(0x208),_0x175206(0x2f8)));}),app[_0x4ad479(0x286)]('/:bot/performance',(_0x92f303,_0x2d955c)=>{const _0x2095c5=_0x4ad479;_0x2d955c[_0x2095c5(0x2c8)](path['join'](__dirname,bbpath2,'build',_0x2095c5(0x2f8)));}),app[_0x4ad479(0x286)](_0x4ad479(0x358),(_0x2607c8,_0x2b31e5)=>{const _0x35f9a9=_0x4ad479;_0x2b31e5[_0x35f9a9(0x2c8)](path[_0x35f9a9(0x3b7)](__dirname,bbpath2,_0x35f9a9(0x208),_0x35f9a9(0x2f8)));}),app[_0x4ad479(0x286)](_0x4ad479(0x255),(_0x3f8d6d,_0x2e5049)=>{const _0x2fcd5b=_0x4ad479;_0x2e5049[_0x2fcd5b(0x2c8)](path[_0x2fcd5b(0x3b7)](__dirname,bbpath2,'build',_0x2fcd5b(0x2f8)));}),app[_0x4ad479(0x286)](_0x4ad479(0x337),(_0x400072,_0x1eb5c2)=>{const _0x15fc31=_0x4ad479;_0x1eb5c2['sendFile'](path[_0x15fc31(0x3b7)](__dirname,bbpath2,_0x15fc31(0x208),_0x15fc31(0x2f8)));}),app[_0x4ad479(0x286)](_0x4ad479(0x29e),(_0x3beca8,_0x578472)=>{const _0x5ade27=_0x4ad479;_0x578472['sendFile'](path[_0x5ade27(0x3b7)](__dirname,bbpath2,_0x5ade27(0x208),'index.html'));});if(HOST)http[_0x4ad479(0x305)](PORT,HOST);else http[_0x4ad479(0x305)](PORT);const io=require(_0x4ad479(0x37c))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1d6e6d=_0x4ad479;let _0x2581b3=_0x1d6e6d(0x23e);const _0x586de7=networkInterfaces(),_0x50f374={};for(const _0x2219d1 of Object[_0x1d6e6d(0x25c)](_0x586de7)){for(const _0x21e639 of _0x586de7[_0x2219d1]){if((_0x21e639[_0x1d6e6d(0x36e)]=='IPv4'||_0x21e639[_0x1d6e6d(0x36e)]==0x4)&&!_0x21e639[_0x1d6e6d(0x27f)]){const _0x4e103a=ipaddr[_0x1d6e6d(0x26a)](_0x21e639[_0x1d6e6d(0x33d)])[_0x1d6e6d(0x38a)]();_0x4e103a!=_0x1d6e6d(0x2d3)&&(!_0x50f374[_0x2219d1]&&(_0x50f374[_0x2219d1]=[]),_0x50f374[_0x2219d1]['push'](_0x21e639['address']),_0x2581b3=_0x21e639[_0x1d6e6d(0x33d)]);}}}return logger['debug']('Network\x20Interfaces:',_0x50f374),_0x2581b3;}async function startServer(){const _0x5d8244=_0x4ad479;logger[_0x5d8244(0x2e1)](''),logger[_0x5d8244(0x2e1)](_0x5d8244(0x2a5)),await logger['full'](_0x5d8244(0x344)+serverversion+_0x5d8244(0x1e7)+('>\x20Open\x20Bot\x20Manager\x20at\x20#BLU#http://localhost:'+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x5d8244(0x217)+getServerIP()+':'+PORT+_0x5d8244(0x29c))),await logger[_0x5d8244(0x34c)](_0x5d8244(0x234)+nodeversion),logger[_0x5d8244(0x2e1)](_0x5d8244(0x2a5));if(config[_0x5d8244(0x3a3)]!=0x0)for(const _0x39a510 of config){if(_0x39a510[_0x5d8244(0x1ff)]=='enabled'||_0x39a510['status']==_0x5d8244(0x254))await logger['full'](_0x5d8244(0x379)+_0x39a510['botID']+_0x5d8244(0x35a)+_0x39a510['botname']),startBot([_0x39a510[_0x5d8244(0x2d0)],userID],{'cwd':bbpath},function(_0x521fe9){const _0x8b82cf=_0x5d8244;if(_0x521fe9)logger[_0x8b82cf(0x22d)](_0x521fe9);});else(_0x39a510[_0x5d8244(0x1ff)]==_0x5d8244(0x2c6)||_0x39a510['status']==_0x5d8244(0x396))&&await logger[_0x5d8244(0x22d)](_0x5d8244(0x2c0)+_0x39a510['botID']+_0x5d8244(0x35a)+_0x39a510[_0x5d8244(0x226)]);}else!newBot&&logger['simple'](_0x5d8244(0x33f));if(newBot)addBot();logger[_0x5d8244(0x2e1)]('-----------------------------------------------------------------------------------'),logger[_0x5d8244(0x2e1)]('');}function startSocket(){const _0x5e8fd6=_0x4ad479;io['on'](_0x5e8fd6(0x2ba),_0x425118=>{const _0xf12924=_0x5e8fd6;let _0x5986cd,_0x1091d4,_0x1512f0,_0x5ee431,_0x44aff8;const _0xe7fd2f=_0x425118[_0xf12924(0x36b)][_0xf12924(0x34d)][_0xf12924(0x29a)];_0x1091d4=_0xe7fd2f['match'](/bot[0-9]{3}/);if(_0x1091d4)_0x1512f0=_0x1091d4[0x0][_0xf12924(0x367)](/[0-9]{3}/);if(_0x1512f0)_0x5986cd=_0x1512f0[0x0];else _0x5986cd='botmanager';const _0x2b0023=_0x425118[_0xf12924(0x36b)][_0xf12924(0x2ae)][_0xf12924(0x341)];if(!_0x2b0023)_0x425118['emit']('status',{'publicKey':secure[_0xf12924(0x2ee)]});else{_0x5ee431=timelyDecrypt(_0x2b0023,![]);if(!_0x5ee431)_0x425118[_0xf12924(0x331)](_0xf12924(0x1ff),{'publicKey':secure[_0xf12924(0x2ee)]});else{_0x44aff8=normalizeIP(_0x425118['conn'][_0xf12924(0x335)])['store'];if(!devices[_0x5ee431])devices[_0x5ee431]={'uuid':_0x5ee431,'access':{'token':null}};devices[_0x5ee431]['ip']=_0x44aff8;const _0x122155=addClient(_0x425118['id'],_0x5ee431,_0x5986cd);setAccess(_0x122155),emitMessages(),_0x425118['on'](_0xf12924(0x39e),_0x2c5100=>{const _0x333593=_0xf12924,_0xbf9ee0=timelyDecrypt(_0x2c5100[_0x333593(0x259)]);if(_0xbf9ee0){_0x2c5100={'username':_0x2c5100['username'],'password':_0xbf9ee0},devices[_0x5ee431][_0x333593(0x380)]=validateCredentials(_0x2c5100,_0x5ee431);if(devices[_0x5ee431][_0x333593(0x380)][_0x333593(0x321)]==![]&&devices[_0x5ee431][_0x333593(0x380)][_0x333593(0x365)]==_0x333593(0x3bc))_0x425118[_0x333593(0x331)](_0x333593(0x1ff),{'access':devices[_0x5ee431]['access']}),loginAccess2FA(_0x5ee431,_0x44aff8);else{if(devices[_0x5ee431][_0x333593(0x380)][_0x333593(0x321)]==![]&&devices[_0x5ee431]['access'][_0x333593(0x365)]==_0x333593(0x3b5))_0x425118[_0x333593(0x331)](_0x333593(0x1ff),{'access':devices[_0x5ee431][_0x333593(0x380)]});else devices[_0x5ee431][_0x333593(0x380)][_0x333593(0x321)]&&devices[_0x5ee431][_0x333593(0x380)]['reason']==_0x333593(0x312)&&(getClientsWithUuid(_0x5ee431)['forEach'](_0x555f21=>{setAccess(_0x555f21);}),logger['debug'](_0x333593(0x26b)+_0x5ee431[_0x333593(0x2ff)](-0x8)),setTokenRefresh(_0x5ee431),setSessionTimeout(_0x333593(0x39e),_0x5ee431));}}else logger[_0x333593(0x22d)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x425118['on']('reset-password',()=>{resetPassword();}),_0x425118['on'](_0xf12924(0x364),_0x439229=>{removeClient(_0x425118['id']);}),_0x5986cd==_0xf12924(0x269)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x19c1ed){const _0x192e81=_0x4ad479;if(_0x19c1ed!=_0x192e81(0x269)&&config[_0x192e81(0x2ac)]!=''){if(pid[_0x19c1ed])pid[_0x19c1ed][_0x192e81(0x32b)]({'function':'initclient','args':null});}_0x19c1ed!=_0x192e81(0x269)&&broadcastToBots(_0x192e81(0x2d7),JSON[_0x192e81(0x280)](config));}function reloadBotManager(){const _0x4ac9fe=_0x4ad479;getClientsWithBotID(_0x4ac9fe(0x269))['forEach'](_0x3e4249=>{const _0x56ec28=_0x4ac9fe;getSocket(_0x3e4249['id'])['emit'](_0x56ec28(0x1ff),{'access':{'allow':![],'reason':_0x56ec28(0x309),'token':null}});});}function getSocket(_0x398eaa){const _0x14034f=_0x4ad479;return io[_0x14034f(0x360)]['sockets'][_0x14034f(0x286)](_0x398eaa);}function setAccess(_0x2b1b02){const _0x370ccd=_0x4ad479,_0x4a95b8=getSocket(_0x2b1b02['id']),_0x46ab20=_0x2b1b02[_0x370ccd(0x3a4)],_0x26d13d=_0x2b1b02[_0x370ccd(0x22e)];devices[_0x46ab20]['access']=validateAccess(devices[_0x46ab20][_0x370ccd(0x380)][_0x370ccd(0x271)],_0x46ab20),logger[_0x370ccd(0x34c)](_0x370ccd(0x2ca)+devices[_0x46ab20][_0x370ccd(0x380)][_0x370ccd(0x365)]+_0x370ccd(0x257)+_0x2b1b02['id'][_0x370ccd(0x2ff)](-0x8)+_0x370ccd(0x28e)+_0x46ab20[_0x370ccd(0x2ff)](-0x8)),_0x4a95b8[_0x370ccd(0x3b7)](_0x46ab20);if(devices[_0x46ab20]['access'][_0x370ccd(0x321)]){_0x4a95b8[_0x370ccd(0x3b7)](_0x26d13d);if(_0x26d13d=='botmanager')initializeSocketBotManager(_0x4a95b8);else initializeSocketBot(_0x4a95b8);initClient(_0x26d13d);}devices[_0x46ab20]['access'][_0x370ccd(0x271)]&&devices[_0x46ab20][_0x370ccd(0x380)][_0x370ccd(0x365)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x370ccd(0x322),_0x46ab20),devices[_0x46ab20][_0x370ccd(0x380)][_0x370ccd(0x271)]&&devices[_0x46ab20][_0x370ccd(0x380)][_0x370ccd(0x365)]==_0x370ccd(0x1fc)&&setSessionTimeout(_0x370ccd(0x39e),_0x46ab20),_0x4a95b8[_0x370ccd(0x331)](_0x370ccd(0x1ff),{'status':_0x2b1b02[_0x370ccd(0x301)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x46ab20][_0x370ccd(0x380)],'externalip':devices[_0x46ab20]['ip'],'publicKey':secure[_0x370ccd(0x2ee)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x46ab20][_0x370ccd(0x380)][_0x370ccd(0x321)]==![]&&devices[_0x46ab20]['access']['reason']==_0x370ccd(0x3a0)&&temporaryAccess2FA(_0x46ab20,devices[_0x46ab20]['ip']);}function setSessionTimeout(_0x56ec4a,_0x8291bb){const _0x329c63=_0x4ad479;let _0x275b65;if(_0x56ec4a==_0x329c63(0x39e))_0x275b65=loginExpiry*0x3c*0x3e8;else _0x275b65=devices[_0x8291bb][_0x329c63(0x230)][_0x329c63(0x2b8)]*0x3c*0x3e8-(new Date()[_0x329c63(0x361)]()-devices[_0x8291bb][_0x329c63(0x230)][_0x329c63(0x2eb)]);if(devices[_0x8291bb]['pidExpireLogin'])clearTimeout(devices[_0x8291bb][_0x329c63(0x26c)]);devices[_0x8291bb][_0x329c63(0x26c)]=setTimeout(()=>{const _0x4b04d8=_0x329c63;if(devices[_0x8291bb][_0x4b04d8(0x264)])clearTimeout(devices[_0x8291bb][_0x4b04d8(0x264)]);removeSocketListeners(_0x8291bb),addBlacklist(_0x8291bb),devices[_0x8291bb][_0x4b04d8(0x230)]=null,devices[_0x8291bb][_0x4b04d8(0x1f0)]=null,devices[_0x8291bb][_0x4b04d8(0x380)][_0x4b04d8(0x271)]=null,logger[_0x4b04d8(0x34c)](_0x4b04d8(0x2fa)+_0x8291bb[_0x4b04d8(0x2ff)](-0x8)),devices[_0x8291bb][_0x4b04d8(0x380)]=validateAccess(devices[_0x8291bb][_0x4b04d8(0x380)][_0x4b04d8(0x271)],_0x8291bb),!(devices[_0x8291bb][_0x4b04d8(0x380)]['allow']&&devices[_0x8291bb][_0x4b04d8(0x380)][_0x4b04d8(0x365)]==_0x4b04d8(0x38f))&&(_0x56ec4a==_0x4b04d8(0x39e)?io['to'](_0x8291bb)[_0x4b04d8(0x331)](_0x4b04d8(0x1ff),{'access':{'allow':![],'reason':_0x4b04d8(0x22b),'token':null}}):io['to'](_0x8291bb)[_0x4b04d8(0x331)](_0x4b04d8(0x1ff),{'access':{'allow':![],'reason':_0x4b04d8(0x2cd),'token':null}})),devices[_0x8291bb]['access'][_0x4b04d8(0x271)]=null;},_0x275b65);}function setTokenRefresh(_0x2c6bd7){const _0x5738a1=_0x4ad479;if(devices[_0x2c6bd7][_0x5738a1(0x264)])clearTimeout(devices[_0x2c6bd7][_0x5738a1(0x264)]);devices[_0x2c6bd7][_0x5738a1(0x264)]=setTimeout(()=>{const _0x214566=_0x5738a1;getClientsWithUuid(_0x2c6bd7)[_0x214566(0x3a3)]!=0x0?(devices[_0x2c6bd7][_0x214566(0x380)]=refreshToken(_0x2c6bd7),io['to'](_0x2c6bd7)[_0x214566(0x331)](_0x214566(0x1ff),{'status':_0x214566(0x2cc),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x2c6bd7][_0x214566(0x380)],'externalip':devices[_0x2c6bd7]['ip'],'publicKey':secure[_0x214566(0x2ee)],'validInstallation':validInstallation}),setTokenRefresh(_0x2c6bd7)):clearTimeout(devices[_0x2c6bd7][_0x214566(0x264)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x11e74e){const _0x277c96=_0x4ad479,_0x553e33=getClient(_0x11e74e['id'])[_0x277c96(0x3a4)];_0x11e74e[_0x277c96(0x331)](_0x277c96(0x2d7),config),_0x11e74e[_0x277c96(0x331)](_0x277c96(0x316),cleanSettings()),_0x11e74e['on'](_0x277c96(0x36f),_0x31a481=>{if(validateAccess(_0x31a481,_0x553e33)['allow'])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x11e74e['on'](_0x277c96(0x2b7),(_0x540228,_0x2ff445)=>{const _0x3ab70f=_0x277c96;if(validateAccess(_0x2ff445,_0x553e33)[_0x3ab70f(0x321)])toggleBot(_0x540228[_0x3ab70f(0x2d0)],_0x540228[_0x3ab70f(0x1ff)],_0x540228[_0x3ab70f(0x23d)]);else logger[_0x3ab70f(0x22d)](_0x3ab70f(0x2f2));}),_0x11e74e['on'](_0x277c96(0x3ad),(_0x5d90cb,_0x4e0b95)=>{const _0x2d6969=_0x277c96;if(validateAccess(_0x4e0b95,_0x553e33)[_0x2d6969(0x321)])toggleBotMode(_0x5d90cb);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x11e74e['on'](_0x277c96(0x2c4),(_0x4fc1ed,_0x198055)=>{const _0x35a6c4=_0x277c96;if(validateAccess(_0x198055,_0x553e33)['allow'])deleteBot(_0x4fc1ed);else logger[_0x35a6c4(0x22d)](_0x35a6c4(0x2fc));}),_0x11e74e['on']('store-settings',(_0x38e957,_0x285312)=>{const _0x121b9c=_0x277c96;if(validateAccess(_0x285312,_0x553e33)[_0x121b9c(0x321)])storeSettings(_0x38e957,!![]);else logger[_0x121b9c(0x22d)](_0x121b9c(0x241));}),_0x11e74e['on']('update-bb',_0x364676=>{const _0x78916a=_0x277c96;if(validateAccess(_0x364676,_0x553e33)['allow'])updateBB(_0x78916a(0x392));else logger[_0x78916a(0x22d)](_0x78916a(0x209));}),_0x11e74e['on'](_0x277c96(0x256),_0x2e73fb=>{const _0x389cab=_0x277c96;if(validateAccess(_0x2e73fb,_0x553e33)[_0x389cab(0x321)])updateBB(_0x389cab(0x232));else logger[_0x389cab(0x22d)](_0x389cab(0x389));}),_0x11e74e['on'](_0x277c96(0x37f),_0x4fc4d8=>{const _0x3e1c17=_0x277c96;if(validateAccess(_0x4fc4d8,_0x553e33)['allow']){const _0x435d12=getClient(_0x11e74e['id']);if(_0x435d12)getBackupFiles(_0x435d12[_0x3e1c17(0x3a4)]);else logger[_0x3e1c17(0x22d)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x3e1c17(0x22d)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x11e74e['on'](_0x277c96(0x1ec),(_0x26ddba,_0x137bb4)=>{const _0xcf954b=_0x277c96;if(validateAccess(_0x137bb4,_0x553e33)['allow'])restoreBackupFile(_0x26ddba);else logger[_0xcf954b(0x22d)](_0xcf954b(0x384));}),_0x11e74e['on'](_0x277c96(0x332),_0x3d31bc=>{const _0xccfeed=_0x277c96;if(validateAccess(_0x3d31bc,_0x553e33)[_0xccfeed(0x321)])getMessages();else logger[_0xccfeed(0x22d)](_0xccfeed(0x359));}),_0x11e74e['on'](_0x277c96(0x2a7),(_0x4a0f6d,_0x51f0aa)=>{const _0x236dfa=_0x277c96;if(validateAccess(_0x51f0aa,_0x553e33)[_0x236dfa(0x321)])confirmMessage(_0x4a0f6d);else logger[_0x236dfa(0x22d)](_0x236dfa(0x32e));}),_0x11e74e['on']('logout',_0x2b173b=>{const _0x4b33b4=_0x277c96;if(validateAccess(_0x2b173b,_0x553e33)[_0x4b33b4(0x321)]){if(devices[_0x553e33][_0x4b33b4(0x264)])clearTimeout(devices[_0x553e33][_0x4b33b4(0x264)]);if(devices[_0x553e33]['pidExpireLogin'])clearTimeout(devices[_0x553e33][_0x4b33b4(0x26c)]);removeSocketListeners(getClient(_0x11e74e['id'])[_0x4b33b4(0x3a4)]),addBlacklist(_0x553e33),devices[_0x553e33]['telegramIpApproval']=null,devices[_0x553e33]['telegram2FaApproval']=null,devices[_0x553e33][_0x4b33b4(0x380)]['token']=null,logger[_0x4b33b4(0x34c)]('Logged\x20out\x20user\x20...'+_0x553e33['slice'](-0x8)),io['to'](getClient(_0x11e74e['id'])[_0x4b33b4(0x3a4)])[_0x4b33b4(0x331)]('status',{'access':{'allow':![],'reason':_0x4b33b4(0x233),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x55eecd){const _0x38aa76=_0x4ad479,_0x1b29c7=getClient(_0x55eecd['id'])[_0x38aa76(0x22e)],_0x4bd155=getClient(_0x55eecd['id'])[_0x38aa76(0x3a4)];_0x55eecd['on'](_0x38aa76(0x34a),(_0x2d6887,_0x57b331)=>{const _0x54de32=_0x38aa76;if(validateAccess(_0x57b331,_0x4bd155)[_0x54de32(0x321)]){if(pid[_0x1b29c7])pid[_0x1b29c7]['send']({'function':_0x54de32(0x2ab),'args':_0x2d6887});}else logger[_0x54de32(0x22d)](_0x54de32(0x1e9));}),_0x55eecd['on'](_0x38aa76(0x24c),(_0x551986,_0x2693e7)=>{const _0x4d8c7f=_0x38aa76;if(validateAccess(_0x2693e7,_0x4bd155)['allow']){if(pid[_0x1b29c7])pid[_0x1b29c7][_0x4d8c7f(0x32b)]({'function':_0x4d8c7f(0x283),'args':_0x551986});}else logger[_0x4d8c7f(0x22d)](_0x4d8c7f(0x3a6));}),_0x55eecd['on'](_0x38aa76(0x2e8),(_0xfeefa5,_0x3a4587)=>{const _0xd340e9=_0x38aa76;if(validateAccess(_0x3a4587,_0x4bd155)[_0xd340e9(0x321)]){if(pid[_0x1b29c7])pid[_0x1b29c7][_0xd340e9(0x32b)]({'function':_0xd340e9(0x24f),'args':_0xfeefa5});}else logger[_0xd340e9(0x22d)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x55eecd['on'](_0x38aa76(0x23f),(_0xccdc5f,_0x4560bc)=>{const _0x129929=_0x38aa76;if(validateAccess(_0x4560bc,_0x4bd155)[_0x129929(0x321)]){if(pid[_0x1b29c7])pid[_0x1b29c7]['send']({'function':_0x129929(0x227),'args':_0xccdc5f});}else logger[_0x129929(0x22d)](_0x129929(0x356));}),_0x55eecd['on'](_0x38aa76(0x1f6),(_0x2e84e4,_0x2028a3)=>{const _0x5baf0a=_0x38aa76;if(validateAccess(_0x2028a3,_0x4bd155)[_0x5baf0a(0x321)]){if(pid[_0x1b29c7])pid[_0x1b29c7]['send']({'function':_0x5baf0a(0x207),'args':_0x2e84e4});}else logger[_0x5baf0a(0x22d)](_0x5baf0a(0x291));}),_0x55eecd['on']('store-fiat',(_0x236f63,_0x4a2b0b)=>{const _0x333149=_0x38aa76;if(validateAccess(_0x4a2b0b,_0x4bd155)[_0x333149(0x321)]){if(pid[_0x1b29c7])pid[_0x1b29c7][_0x333149(0x32b)]({'function':'storeFiat','args':_0x236f63});}else logger[_0x333149(0x22d)](_0x333149(0x3a1));}),_0x55eecd['on'](_0x38aa76(0x3c0),_0x352489=>{const _0x4bd079=_0x38aa76;if(validateAccess(_0x352489,_0x4bd155)[_0x4bd079(0x321)]){if(pid[_0x1b29c7])pid[_0x1b29c7]['send']({'function':'resetHistory','args':null});}else logger[_0x4bd079(0x22d)](_0x4bd079(0x2b6));}),_0x55eecd['on'](_0x38aa76(0x258),_0x3fa784=>{const _0x134021=_0x38aa76;if(validateAccess(_0x3fa784,_0x4bd155)[_0x134021(0x321)]){if(pid[_0x1b29c7])pid[_0x1b29c7][_0x134021(0x32b)]({'function':_0x134021(0x33e),'args':null});}else logger[_0x134021(0x22d)](_0x134021(0x375));}),_0x55eecd['on']('place-order',(_0x322827,_0x2e818e)=>{const _0x239952=_0x38aa76;if(validateAccess(_0x2e818e,_0x4bd155)[_0x239952(0x321)]){if(pid[_0x1b29c7])pid[_0x1b29c7][_0x239952(0x32b)]({'function':_0x239952(0x31a),'args':_0x322827});}else logger[_0x239952(0x22d)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x55eecd['on'](_0x38aa76(0x39d),_0x2a9e99=>{const _0x297a6f=_0x38aa76;if(validateAccess(_0x2a9e99,_0x4bd155)[_0x297a6f(0x321)]){if(pid[_0x1b29c7])pid[_0x1b29c7][_0x297a6f(0x32b)]({'function':_0x297a6f(0x1ef),'args':null});}else logger[_0x297a6f(0x22d)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x55eecd['on'](_0x38aa76(0x24a),_0xdcf231=>{const _0x1e6ef3=_0x38aa76;if(validateAccess(_0xdcf231,_0x4bd155)['allow']){if(pid[_0x1b29c7])pid[_0x1b29c7][_0x1e6ef3(0x32b)]({'function':_0x1e6ef3(0x2a1),'args':null});}else logger[_0x1e6ef3(0x22d)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x55eecd['on'](_0x38aa76(0x289),_0x5f1a2f=>{const _0x219257=_0x38aa76;if(validateAccess(_0x5f1a2f,_0x4bd155)[_0x219257(0x321)])updateBB('update');else logger[_0x219257(0x22d)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x55eecd['on'](_0x38aa76(0x332),_0x1e2636=>{const _0x152d9a=_0x38aa76;if(validateAccess(_0x1e2636,_0x4bd155)[_0x152d9a(0x321)])getMessages();else logger[_0x152d9a(0x22d)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x55eecd['on']('confirm-message',(_0xe77c,_0x71e7d4)=>{const _0x29d271=_0x38aa76;if(validateAccess(_0x71e7d4,_0x4bd155)[_0x29d271(0x321)])confirmMessage(_0xe77c);else logger['full'](_0x29d271(0x32e));}),_0x55eecd['on'](_0x38aa76(0x343),_0x3dc4b2=>{const _0x22b8cf=_0x38aa76;if(validateAccess(_0x3dc4b2,_0x4bd155)[_0x22b8cf(0x321)]){if(devices[_0x4bd155][_0x22b8cf(0x264)])clearTimeout(devices[_0x4bd155]['pidRefreshToken']);if(devices[_0x4bd155][_0x22b8cf(0x26c)])clearTimeout(devices[_0x4bd155]['pidExpireLogin']);removeSocketListeners(getClient(_0x55eecd['id'])[_0x22b8cf(0x3a4)]),addBlacklist(_0x4bd155),devices[_0x4bd155][_0x22b8cf(0x230)]=null,devices[_0x4bd155][_0x22b8cf(0x1f0)]=null,devices[_0x4bd155][_0x22b8cf(0x380)]['token']=null,logger[_0x22b8cf(0x34c)]('Logged\x20out\x20user\x20...'+_0x4bd155['slice'](-0x8)),io['to'](getClient(_0x55eecd['id'])['uuid'])[_0x22b8cf(0x331)]('status',{'access':{'allow':![],'reason':_0x22b8cf(0x233),'token':null}});}else logger[_0x22b8cf(0x22d)](_0x22b8cf(0x3b3));});}function removeSocketListeners(_0x47f30b){const _0x31dc73=_0x4ad479;getClientsWithUuid(_0x47f30b)[_0x31dc73(0x2ef)](_0x386570=>{const _0x2f260d=_0x31dc73;getSocket(_0x386570['id'])[_0x2f260d(0x368)]();});}function cleanSettings(){const _0x2a96c2=_0x4ad479;let _0x5a09d7=settings;return settings[_0x2a96c2(0x2e2)]&&settings['telegramToken']!=''&&(_0x5a09d7={..._0x5a09d7,'telegramToken':_0x2a96c2(0x32d)}),settings[_0x2a96c2(0x2da)]&&settings[_0x2a96c2(0x2da)]!=''&&(_0x5a09d7={..._0x5a09d7,'bbPassword':_0x2a96c2(0x32d)}),(settings['bbPassword']&&settings[_0x2a96c2(0x2da)]==_0x2a96c2(0x319)||settings[_0x2a96c2(0x2e2)]&&settings[_0x2a96c2(0x2e2)]==_0x2a96c2(0x319))&&(_0x5a09d7={..._0x5a09d7,'restored':{'password':settings[_0x2a96c2(0x2da)]==_0x2a96c2(0x319),'telegram':settings[_0x2a96c2(0x2e2)]=='***'}}),_0x5a09d7;}async function updateBB(_0x1ef2a3){const _0x14c5fa=_0x4ad479;await backupConfigFiles(),installingUpdate=!![],config[_0x14c5fa(0x2ef)](_0xb76dc2=>{const _0xa32dde=_0x14c5fa;restartBot(_0xb76dc2[_0xa32dde(0x2d0)]);}),logger[_0x14c5fa(0x34c)](_0x14c5fa(0x220)+_0x1ef2a3);if(_0x1ef2a3=='update')process['send']({'update':!![]},_0x3f9a66=>{});else _0x1ef2a3==_0x14c5fa(0x232)&&process[_0x14c5fa(0x32b)]({'reinstall':!![]},_0x4d578c=>{});}function startBot(_0x289163,_0x1754eb,_0x9ad2b2){const _0x267160=_0x4ad479;if(debugging)_0x289163[_0x267160(0x340)]('-d');let _0x5bddf4=![];const _0xdf6f7f=_0x289163[0x0];_0x1754eb={..._0x1754eb,'stdio':['inherit',_0x267160(0x2b3),_0x267160(0x2b3),_0x267160(0x249)]},pid[_0xdf6f7f]=childProcess[_0x267160(0x38e)](botfile,_0x289163,_0x1754eb),pid[_0xdf6f7f]['on'](_0x267160(0x205),_0x29f9af=>{const _0x27627b=_0x267160;switch(Object['keys'](_0x29f9af)[0x0]){case _0x27627b(0x226):updateBotName(_0xdf6f7f,_0x29f9af[_0x27627b(0x226)]);break;case _0x27627b(0x36a):updateBotManager();break;case _0x27627b(0x1ff):updateStatus(_0xdf6f7f,_0x29f9af[_0x27627b(0x1ff)]);break;case _0x27627b(0x23d):updateLive(_0xdf6f7f,_0x29f9af[_0x27627b(0x23d)]);break;case'started':updateLive(_0xdf6f7f,_0x29f9af[_0x27627b(0x2f7)]),io['to'](_0xdf6f7f)[_0x27627b(0x331)]('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x27627b(0x31e):_0x29f9af['stop']==_0x27627b(0x2c3)&&restartBot(_0xdf6f7f);_0x29f9af[_0x27627b(0x31e)]==_0x27627b(0x2e0)&&toggleBot(_0xdf6f7f,_0x27627b(0x2c6),'stopped');break;case'telegram':sendTelegram(_0xdf6f7f,_0x29f9af[_0x27627b(0x253)]);break;case _0x27627b(0x224):sendTelegramMsg(_0x29f9af[_0x27627b(0x224)]);break;case _0x27627b(0x32a):io['to'](_0xdf6f7f)['emit'](_0x29f9af['function'],_0x29f9af[_0x27627b(0x2d5)]);break;}}),pid[_0xdf6f7f]['on']('error',function(_0x54d94b){if(_0x5bddf4)return;_0x5bddf4=!![],_0x9ad2b2(_0x54d94b);}),pid[_0xdf6f7f]['on'](_0x267160(0x2f9),async function(_0x252237){const _0x16e76d=_0x267160;if(installingUpdate)return;if(_0x5bddf4)return;_0x5bddf4=!![],_0x9ad2b2(null);const _0x115a68=dbConfig[_0x16e76d(0x286)]('bots')[_0x16e76d(0x2d8)]({'botID':_0xdf6f7f})[_0x16e76d(0x20c)]();_0x115a68&&(_0x115a68[_0x16e76d(0x1ff)]==_0x16e76d(0x20b)||_0x115a68['status']==_0x16e76d(0x254))&&(await sleep(0x3e8),updateLive(_0xdf6f7f,_0x16e76d(0x39c)),logger[_0x16e76d(0x22d)](_0x16e76d(0x222)+_0xdf6f7f),startBot([_0xdf6f7f,userID],{'cwd':bbpath},function(_0x338f03){if(_0x338f03)logger['full'](_0x338f03);}));});}function stopBot(_0x143186){getClientsWithBotID(_0x143186)['forEach'](_0x3cfe7f=>{const _0x39852f=_0xc8be;getSocket(_0x3cfe7f['id'])[_0x39852f(0x364)](!![]),removeClient(_0x3cfe7f['id']);}),pid[_0x143186]&&(pid[_0x143186]['kill'](),pid[_0x143186]=null);}function _0xc8be(_0xefc073,_0x4073a1){const _0x37990b=_0x7155();return _0xc8be=function(_0x3bea10,_0x384b7b){_0x3bea10=_0x3bea10-0x1e6;let _0x715563=_0x37990b[_0x3bea10];return _0x715563;},_0xc8be(_0xefc073,_0x4073a1);}function restartBot(_0x1c02b0){const _0x27f95d=_0x4ad479;if(pid[_0x1c02b0])pid[_0x1c02b0][_0x27f95d(0x2e0)]();}function addBot(){const _0x2da9b0=_0x4ad479;let _0x5f4171;for(let _0x556bce=0x1;_0x556bce<0x3e9;_0x556bce++){_0x5f4171=_0x556bce[_0x2da9b0(0x273)]()[_0x2da9b0(0x304)](0x3,'0');let _0x24c4ff=config[_0x2da9b0(0x2d8)](_0x4a3e5f=>_0x4a3e5f[_0x2da9b0(0x2d0)]==_0x5f4171);if(!_0x24c4ff)break;}if(_0x5f4171===_0x2da9b0(0x279)){logger[_0x2da9b0(0x22d)](_0x2da9b0(0x302));return;}logger['full'](_0x2da9b0(0x363)+_0x5f4171),dbConfig[_0x2da9b0(0x286)](_0x2da9b0(0x2d7))[_0x2da9b0(0x340)]({'botID':_0x5f4171,'botname':_0x2da9b0(0x333)+_0x5f4171,'status':'new','live':''})[_0x2da9b0(0x35d)](),startBot([_0x5f4171,userID],{'cwd':bbpath},function(_0x34f59d){const _0x11731a=_0x2da9b0;if(_0x34f59d)logger[_0x11731a(0x22d)](_0x34f59d);}),config=getConfiguration(),io['to'](_0x2da9b0(0x269))[_0x2da9b0(0x331)](_0x2da9b0(0x2d7),config),broadcastToBots(_0x2da9b0(0x2d7),JSON['stringify'](config));}function deleteBot(_0x3521f6){const _0x3aa0dd=_0x4ad479;getClientsWithBotID(_0x3521f6)['forEach'](_0x57235d=>{const _0x119840=_0xc8be;getSocket(_0x57235d['id'])[_0x119840(0x364)](!![]),removeClient(_0x57235d['id']);}),dbConfig[_0x3aa0dd(0x286)](_0x3aa0dd(0x2d7))[_0x3aa0dd(0x3a2)]({'botID':_0x3521f6})[_0x3aa0dd(0x35d)](),logger[_0x3aa0dd(0x22d)](_0x3aa0dd(0x25b)+_0x3521f6),stopBot(_0x3521f6);try{if(fs[_0x3aa0dd(0x323)](path['join'](configpath,'bot-'+_0x3521f6+_0x3aa0dd(0x22f))))fs[_0x3aa0dd(0x3b0)](path[_0x3aa0dd(0x3b7)](configpath,_0x3aa0dd(0x1ee)+_0x3521f6+_0x3aa0dd(0x22f)));if(fs[_0x3aa0dd(0x323)](path[_0x3aa0dd(0x3b7)](configpath,_0x3aa0dd(0x1ee)+_0x3521f6+_0x3aa0dd(0x2a6))))fs[_0x3aa0dd(0x3b0)](path[_0x3aa0dd(0x3b7)](configpath,_0x3aa0dd(0x1ee)+_0x3521f6+_0x3aa0dd(0x2a6)));if(fs[_0x3aa0dd(0x323)](path[_0x3aa0dd(0x3b7)](configpath,'bot-'+_0x3521f6+_0x3aa0dd(0x326))))fs[_0x3aa0dd(0x3b0)](path['join'](configpath,'bot-'+_0x3521f6+_0x3aa0dd(0x326)));if(fs['existsSync'](path[_0x3aa0dd(0x3b7)](configpath,'bot-'+_0x3521f6+_0x3aa0dd(0x231))))fs[_0x3aa0dd(0x3b0)](path[_0x3aa0dd(0x3b7)](configpath,'bot-'+_0x3521f6+_0x3aa0dd(0x231)));}catch(_0x4cd34b){if(_0x4cd34b)logger[_0x3aa0dd(0x22d)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x4cd34b);}config=getConfiguration(),io['to'](_0x3aa0dd(0x269))[_0x3aa0dd(0x331)](_0x3aa0dd(0x2d7),config),broadcastToBots('bots',JSON[_0x3aa0dd(0x280)](config));}function toggleBot(_0x553cf5,_0x1d2859,_0x28edae){const _0x6f028b=_0x4ad479;dbConfig['get']('bots')[_0x6f028b(0x2d8)]({'botID':_0x553cf5})[_0x6f028b(0x334)]({'status':_0x1d2859})[_0x6f028b(0x334)]({'live':_0x28edae})[_0x6f028b(0x35d)]();if(_0x1d2859==_0x6f028b(0x20b)||_0x1d2859==_0x6f028b(0x254))logger[_0x6f028b(0x22d)](_0x6f028b(0x3aa)+_0x553cf5),startBot([_0x553cf5,userID],{'cwd':bbpath},function(_0x190130){const _0x20e010=_0x6f028b;if(_0x190130)logger[_0x20e010(0x22d)](_0x190130);});else(_0x1d2859==_0x6f028b(0x2c6)||_0x1d2859==_0x6f028b(0x396))&&(logger[_0x6f028b(0x22d)](_0x6f028b(0x34e)+_0x553cf5),stopBot(_0x553cf5));config=getConfiguration(),io['to'](_0x6f028b(0x269))[_0x6f028b(0x331)](_0x6f028b(0x2d7),config),broadcastToBots(_0x6f028b(0x2d7),JSON[_0x6f028b(0x280)](config));}function toggleStatus(_0x2e429d){const _0x4ba644=_0x4ad479;let _0x1963d6=dbConfig[_0x4ba644(0x286)]('bots')[_0x4ba644(0x2d8)]({'botID':_0x2e429d})[_0x4ba644(0x20c)](),_0x29cada;if(_0x1963d6['status']===_0x4ba644(0x20b))_0x29cada=_0x4ba644(0x2c6);else{if(_0x1963d6[_0x4ba644(0x1ff)]===_0x4ba644(0x254))_0x29cada='new-disabled';else{if(_0x1963d6[_0x4ba644(0x1ff)]===_0x4ba644(0x396))_0x29cada='new';else{if(_0x1963d6[_0x4ba644(0x1ff)]===_0x4ba644(0x2c6))_0x29cada='enabled';}}}return _0x29cada;}function updateStatus(_0x1362c8,_0x672191){const _0x41b941=_0x4ad479;dbConfig['get']('bots')['find']({'botID':_0x1362c8})['assign']({'status':_0x672191})[_0x41b941(0x35d)](),config=getConfiguration(),io['to'](_0x41b941(0x269))[_0x41b941(0x331)]('bots',config),broadcastToBots('bots',JSON[_0x41b941(0x280)](config));}function updateLive(_0x139d0d,_0x58fd6f){const _0x4859e0=_0x4ad479;dbConfig['get']('bots')['find']({'botID':_0x139d0d})[_0x4859e0(0x334)]({'live':_0x58fd6f})[_0x4859e0(0x35d)](),config=getConfiguration(),io['to'](_0x4859e0(0x269))[_0x4859e0(0x331)]('bots',config),broadcastToBots(_0x4859e0(0x2d7),JSON[_0x4859e0(0x280)](config));}function updateBotName(_0x208d82,_0x361784){const _0x4780f0=_0x4ad479;dbConfig['get'](_0x4780f0(0x2d7))['find']({'botID':_0x208d82})[_0x4780f0(0x334)]({'botname':_0x361784})[_0x4780f0(0x35d)](),config=getConfiguration(),io['to'](_0x4780f0(0x269))[_0x4780f0(0x331)](_0x4780f0(0x2d7),config),broadcastToBots(_0x4780f0(0x2d7),JSON[_0x4780f0(0x280)](config));}function updateBotManager(){const _0x4571c1=_0x4ad479;config=getConfiguration(),io['to']('botmanager')['emit'](_0x4571c1(0x2d7),config),broadcastToBots(_0x4571c1(0x2d7),JSON[_0x4571c1(0x280)](config));}function toggleBotMode(_0x598a86){const _0x52808a=_0x4ad479;if(pid[_0x598a86])pid[_0x598a86]['send']({'function':_0x52808a(0x2ea),'args':null});else{const _0x2c3f6b=configpath+_0x52808a(0x1ee)+_0x598a86+_0x52808a(0x22f),_0x485abe=fs[_0x52808a(0x28f)](_0x2c3f6b),_0x427ce1=JSON[_0x52808a(0x26a)](_0x485abe),_0x1ea309=_0x427ce1['bot'][0x0][_0x52808a(0x2b2)];_0x427ce1[_0x52808a(0x22e)][0x0][_0x52808a(0x2b2)]=!_0x1ea309;const _0x24bf02=JSON[_0x52808a(0x280)](_0x427ce1,null,0x2);fs[_0x52808a(0x2c1)](_0x2c3f6b,_0x24bf02),config=getConfiguration(),io['to'](_0x52808a(0x269))['emit'](_0x52808a(0x2d7),config),broadcastToBots(_0x52808a(0x2d7),JSON[_0x52808a(0x280)](config));}}function telegramError(_0x3552d1){logger['simple'](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x3a2d2d){const _0x3a1b70=_0x4ad479;if(_0x3a2d2d['from'][_0x3a1b70(0x1fe)]!=settings['telegramUsername']&&'@'+_0x3a2d2d['from'][_0x3a1b70(0x1fe)]!=settings[_0x3a1b70(0x2f0)])return tgBot[_0x3a1b70(0x21e)](_0x3a2d2d['chat']['id'],_0x3a1b70(0x30a),{'parse_mode':'HTML'})[_0x3a1b70(0x29d)](_0x42bfb3=>{telegramError(_0x42bfb3);}),![];return!![];}async function initTelegram(){const _0x3d93d7=_0x4ad479;if(tgBot)tgBot[_0x3d93d7(0x37d)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x3d93d7(0x2e2)],{'polling':!![]});let _0x50473c=_0x3d93d7(0x30d);_0x50473c+='\x0a',_0x50473c+=_0x3d93d7(0x34b),_0x50473c+='/disable\x20-\x20disable\x20notifications\x0a',_0x50473c+=_0x3d93d7(0x2a0),_0x50473c+=_0x3d93d7(0x2de),_0x50473c+=_0x3d93d7(0x1ed),_0x50473c+='/off\x20-\x20stop\x20bot(s)\x0a',_0x50473c+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x50473c+=_0x3d93d7(0x31f),_0x50473c+=_0x3d93d7(0x362),_0x50473c+=_0x3d93d7(0x238),_0x50473c+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x50473c+=_0x3d93d7(0x2a9),_0x50473c+=_0x3d93d7(0x2c2),_0x50473c+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x1431f5=_0x3d93d7(0x39f);_0x1431f5+='\x0a',_0x1431f5+=_0x50473c,tgBot[_0x3d93d7(0x2e4)](/\/start/,_0x2469fa=>{const _0x4891ec=_0x3d93d7;if(!validateTelegram(_0x2469fa))return;if(settings[_0x4891ec(0x268)]!=_0x2469fa[_0x4891ec(0x381)]['id'])updateSetting(_0x4891ec(0x268),_0x2469fa[_0x4891ec(0x381)]['id']);updateSetting(_0x4891ec(0x276),!![]),tgBot['sendMessage'](_0x2469fa[_0x4891ec(0x381)]['id'],_0x1431f5)[_0x4891ec(0x29d)](_0x50f0a8=>{telegramError(_0x50f0a8);});}),tgBot[_0x3d93d7(0x2e4)](/\/enable/,_0x79ce2f=>{const _0x3e9712=_0x3d93d7;if(!validateTelegram(_0x79ce2f))return;if(settings[_0x3e9712(0x268)]!=_0x79ce2f[_0x3e9712(0x381)]['id'])updateSetting(_0x3e9712(0x268),_0x79ce2f[_0x3e9712(0x381)]['id']);updateSetting(_0x3e9712(0x276),!![]),tgBot[_0x3e9712(0x21e)](_0x79ce2f[_0x3e9712(0x381)]['id'],_0x3e9712(0x28b))[_0x3e9712(0x29d)](_0x1b065b=>{telegramError(_0x1b065b);});}),tgBot[_0x3d93d7(0x2e4)](/\/config/,async _0x11065e=>{const _0x42e822=_0x3d93d7;if(!validateTelegram(_0x11065e))return;tgBot[_0x42e822(0x328)](_0x42e822(0x2e6)),tgBot[_0x42e822(0x21e)](_0x11065e[_0x42e822(0x381)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x42e822(0x247),'callback_data':_0x42e822(0x3ab)},{'text':'Alerts','callback_data':_0x42e822(0x206)},{'text':_0x42e822(0x2dd),'callback_data':_0x42e822(0x28c)}]]}})[_0x42e822(0x29d)](_0xc696ba=>{telegramError(_0xc696ba);}),tgBot['on'](_0x42e822(0x2e6),async _0x3cb19f=>{const _0x44fa02=_0x42e822,_0x3cf7bb=_0x3cb19f[_0x44fa02(0x324)],_0xfc045b=_0x3cb19f[_0x44fa02(0x205)];tgBot[_0x44fa02(0x2e5)](_0x3cb19f['id'])[_0x44fa02(0x26d)](async()=>{const _0x1b43fd=_0x44fa02;_0x3cf7bb=='orders'&&(updateSetting(_0x1b43fd(0x347),_0x1b43fd(0x3ab)),updateSetting('telegramEnabled',!![]),await tgBot[_0x1b43fd(0x21e)](_0xfc045b[_0x1b43fd(0x381)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')['catch'](_0x4d0de8=>{telegramError(_0x4d0de8);}));_0x3cf7bb==_0x1b43fd(0x206)&&(updateSetting(_0x1b43fd(0x347),_0x1b43fd(0x206)),updateSetting(_0x1b43fd(0x276),!![]),await tgBot[_0x1b43fd(0x21e)](_0xfc045b[_0x1b43fd(0x381)]['id'],_0x1b43fd(0x3bd))['catch'](_0x43bbbb=>{telegramError(_0x43bbbb);}));_0x3cf7bb==_0x1b43fd(0x28c)&&(updateSetting(_0x1b43fd(0x347),'all'),updateSetting(_0x1b43fd(0x276),!![]),await tgBot[_0x1b43fd(0x21e)](_0xfc045b['chat']['id'],_0x1b43fd(0x3be))['catch'](_0x4b6df8=>{telegramError(_0x4b6df8);}));if(!settings[_0x1b43fd(0x268)])tgBot[_0x1b43fd(0x21e)](_0xfc045b['chat']['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x1b43fd(0x29d)](_0x11f28e=>{telegramError(_0x11f28e);});}),tgBot[_0x44fa02(0x328)](_0x44fa02(0x2e6));});}),tgBot[_0x3d93d7(0x2e4)](/\/status/,_0xddb2d7=>{const _0x3ee0d3=_0x3d93d7;if(!validateTelegram(_0xddb2d7))return;const _0x4a51b=getBotsWithMode();let _0x64b09f=_0x3ee0d3(0x3c1);config[_0x3ee0d3(0x2ef)](_0xfac8af=>{const _0x561e87=_0x3ee0d3,_0x53df42=_0x4a51b[_0x561e87(0x2d8)](_0x52d2bd=>_0x52d2bd[_0x561e87(0x2d0)]==_0xfac8af['botID'])[_0x561e87(0x3b6)];_0x64b09f+=_0x561e87(0x333)+_0xfac8af['botID']+':\x20'+_0xfac8af[_0x561e87(0x1ff)]+_0x561e87(0x35a)+_0x53df42+_0x561e87(0x35a)+_0xfac8af[_0x561e87(0x23d)]+'\x0a';}),_0x64b09f+='\x0a',_0x64b09f+=_0x3ee0d3(0x21d),_0x64b09f+=!settings[_0x3ee0d3(0x276)]?_0x3ee0d3(0x1fa):_0x3ee0d3(0x27e),_0x64b09f+=settings[_0x3ee0d3(0x276)]?settings[_0x3ee0d3(0x347)]==_0x3ee0d3(0x28c)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x3ee0d3(0x229)+settings[_0x3ee0d3(0x347)]+_0x3ee0d3(0x270):'',tgBot[_0x3ee0d3(0x21e)](_0xddb2d7['chat']['id'],_0x64b09f,{'parse_mode':'HTML'})[_0x3ee0d3(0x29d)](_0x19afd8=>{telegramError(_0x19afd8);});}),tgBot[_0x3d93d7(0x2e4)](/\/restart/,_0x506682=>{const _0x4619b0=_0x3d93d7;if(!validateTelegram(_0x506682))return;tgBot['removeListener'](_0x4619b0(0x2e6));const _0x48a491=getEnabledBots();if(_0x48a491[_0x4619b0(0x3a3)]==0x0)tgBot[_0x4619b0(0x21e)](_0x506682[_0x4619b0(0x381)]['id'],_0x4619b0(0x1f8))[_0x4619b0(0x29d)](_0x4cdccc=>{telegramError(_0x4cdccc);});else{if(_0x48a491[_0x4619b0(0x3a3)]>0x1)_0x48a491[_0x4619b0(0x340)]({'botID':_0x4619b0(0x28c)});let _0x42e8a8=[],_0x7595b0=[];const _0x43821c=_0x48a491[_0x4619b0(0x3a3)]%0x4==0x0||_0x48a491['length']%0x4==0x3||_0x48a491[_0x4619b0(0x3a3)]%0x3==0x1?0x4:0x3;let _0x3260c0=0x0;_0x48a491[_0x4619b0(0x2ef)]((_0x5c9cc5,_0x252e69)=>{const _0x39cf77=_0x4619b0;if(_0x252e69%_0x43821c==0x0)_0x7595b0=[];_0x7595b0[_0x39cf77(0x340)]({'text':_0x5c9cc5[_0x39cf77(0x2d0)]==_0x39cf77(0x28c)?_0x39cf77(0x244):_0x39cf77(0x333)+_0x5c9cc5[_0x39cf77(0x2d0)],'callback_data':_0x5c9cc5['botID']}),_0x252e69%_0x43821c==0x0&&(_0x42e8a8[_0x3260c0]=_0x7595b0,_0x3260c0++);}),tgBot[_0x4619b0(0x21e)](_0x506682[_0x4619b0(0x381)]['id'],_0x4619b0(0x350),{'reply_markup':{'inline_keyboard':_0x42e8a8}})[_0x4619b0(0x29d)](_0x1da5a2=>{telegramError(_0x1da5a2);}),tgBot['on'](_0x4619b0(0x2e6),async _0x5346b=>{const _0x5f201e=_0x4619b0,_0x96961=_0x5346b[_0x5f201e(0x324)],_0x12747d=_0x5346b[_0x5f201e(0x205)];tgBot[_0x5f201e(0x2e5)](_0x5346b['id'])[_0x5f201e(0x26d)](async()=>{const _0x373325=_0x5f201e;_0x96961=='all'?config[_0x373325(0x2ef)](_0x3f3fd8=>{const _0x1adb67=_0x373325;restartBot(_0x3f3fd8[_0x1adb67(0x2d0)]);}):restartBot(_0x96961);}),tgBot[_0x5f201e(0x328)](_0x5f201e(0x2e6));});}}),tgBot[_0x3d93d7(0x2e4)](/\/on/,_0x520982=>{const _0x1f67e6=_0x3d93d7;if(!validateTelegram(_0x520982))return;tgBot['removeListener'](_0x1f67e6(0x2e6));const _0x41c16b=getDisabledBots();if(_0x41c16b[_0x1f67e6(0x3a3)]==0x0)tgBot['sendMessage'](_0x520982['chat']['id'],_0x1f67e6(0x2c7))[_0x1f67e6(0x29d)](_0x5e2d43=>{telegramError(_0x5e2d43);});else{if(_0x41c16b[_0x1f67e6(0x3a3)]>0x1)_0x41c16b[_0x1f67e6(0x340)]({'botID':_0x1f67e6(0x28c)});let _0x1a65b9=[],_0x4aa12f=[];const _0x423af2=_0x41c16b[_0x1f67e6(0x3a3)]%0x4==0x0||_0x41c16b['length']%0x4==0x3||_0x41c16b[_0x1f67e6(0x3a3)]%0x3==0x1?0x4:0x3;let _0x808fef=0x0;_0x41c16b['forEach']((_0x4558ee,_0x45376e)=>{const _0x36514a=_0x1f67e6;if(_0x45376e%_0x423af2==0x0)_0x4aa12f=[];_0x4aa12f['push']({'text':_0x4558ee[_0x36514a(0x2d0)]==_0x36514a(0x28c)?_0x36514a(0x244):_0x36514a(0x333)+_0x4558ee[_0x36514a(0x2d0)],'callback_data':_0x4558ee[_0x36514a(0x2d0)]}),_0x45376e%_0x423af2==0x0&&(_0x1a65b9[_0x808fef]=_0x4aa12f,_0x808fef++);}),tgBot[_0x1f67e6(0x21e)](_0x520982[_0x1f67e6(0x381)]['id'],_0x1f67e6(0x1f2),{'reply_markup':{'inline_keyboard':_0x1a65b9}})['catch'](_0x303d9c=>{telegramError(_0x303d9c);}),tgBot['on'](_0x1f67e6(0x2e6),async _0x16080d=>{const _0x4df414=_0x1f67e6,_0x4efd87=_0x16080d[_0x4df414(0x324)],_0x4b74d3=_0x16080d[_0x4df414(0x205)];tgBot[_0x4df414(0x2e5)](_0x16080d['id'])['then'](async()=>{const _0x41fb72=_0x4df414;_0x4efd87==_0x41fb72(0x28c)?(tgBot[_0x41fb72(0x21e)](_0x4b74d3[_0x41fb72(0x381)]['id'],_0x41fb72(0x39a))[_0x41fb72(0x29d)](_0x22499a=>{telegramError(_0x22499a);}),_0x41c16b[_0x41fb72(0x2ef)](_0x453226=>{const _0x2ce799=_0x41fb72;if(_0x453226['botID']!=_0x2ce799(0x28c))toggleBot(_0x453226[_0x2ce799(0x2d0)],toggleStatus(_0x453226['botID']),_0x2ce799(0x39c));})):(tgBot[_0x41fb72(0x21e)](_0x4b74d3[_0x41fb72(0x381)]['id'],_0x41fb72(0x2d1)+_0x4efd87)[_0x41fb72(0x29d)](_0x5d4832=>{telegramError(_0x5d4832);}),toggleBot(_0x4efd87,toggleStatus(_0x4efd87),_0x41fb72(0x39c)));}),tgBot[_0x4df414(0x328)](_0x4df414(0x2e6));});}}),tgBot['onText'](/\/off/,_0x1f584d=>{const _0x13df98=_0x3d93d7;if(!validateTelegram(_0x1f584d))return;tgBot[_0x13df98(0x328)](_0x13df98(0x2e6));const _0xad624=getEnabledBots();if(_0xad624[_0x13df98(0x3a3)]==0x0)tgBot['sendMessage'](_0x1f584d[_0x13df98(0x381)]['id'],_0x13df98(0x1f8))[_0x13df98(0x29d)](_0x459bd6=>{telegramError(_0x459bd6);});else{if(_0xad624['length']>0x1)_0xad624[_0x13df98(0x340)]({'botID':'all'});let _0x10d3df=[],_0x18a4b2=[];const _0x233b0f=_0xad624[_0x13df98(0x3a3)]%0x4==0x0||_0xad624['length']%0x4==0x3||_0xad624[_0x13df98(0x3a3)]%0x3==0x1?0x4:0x3;let _0x5d82e5=0x0;_0xad624[_0x13df98(0x2ef)]((_0x35d396,_0x7757fc)=>{const _0x588a18=_0x13df98;if(_0x7757fc%_0x233b0f==0x0)_0x18a4b2=[];_0x18a4b2[_0x588a18(0x340)]({'text':_0x35d396[_0x588a18(0x2d0)]==_0x588a18(0x28c)?'All\x20bots':_0x588a18(0x333)+_0x35d396[_0x588a18(0x2d0)],'callback_data':_0x35d396['botID']}),_0x7757fc%_0x233b0f==0x0&&(_0x10d3df[_0x5d82e5]=_0x18a4b2,_0x5d82e5++);}),tgBot[_0x13df98(0x21e)](_0x1f584d[_0x13df98(0x381)]['id'],_0x13df98(0x317),{'reply_markup':{'inline_keyboard':_0x10d3df}})['catch'](_0x5a064e=>{telegramError(_0x5a064e);}),tgBot['on'](_0x13df98(0x2e6),async _0x2dbd36=>{const _0x3a39fa=_0x13df98,_0x4690fd=_0x2dbd36[_0x3a39fa(0x324)],_0x239a31=_0x2dbd36[_0x3a39fa(0x205)];tgBot[_0x3a39fa(0x2e5)](_0x2dbd36['id'])[_0x3a39fa(0x26d)](async()=>{const _0x21cd93=_0x3a39fa;_0x4690fd=='all'?(tgBot['sendMessage'](_0x239a31[_0x21cd93(0x381)]['id'],_0x21cd93(0x27a))[_0x21cd93(0x29d)](_0x4e89f9=>{telegramError(_0x4e89f9);}),_0xad624[_0x21cd93(0x2ef)](_0x43cf3b=>{const _0x1ac41f=_0x21cd93;if(_0x43cf3b['botID']!=_0x1ac41f(0x28c))toggleBot(_0x43cf3b[_0x1ac41f(0x2d0)],toggleStatus(_0x43cf3b['botID']),_0x1ac41f(0x39c));})):(tgBot[_0x21cd93(0x21e)](_0x239a31[_0x21cd93(0x381)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x4690fd)[_0x21cd93(0x29d)](_0x3157af=>{telegramError(_0x3157af);}),toggleBot(_0x4690fd,toggleStatus(_0x4690fd),_0x21cd93(0x39c)));}),tgBot[_0x3a39fa(0x328)]('callback_query');});}}),tgBot[_0x3d93d7(0x2e4)](/\/metrics/,_0x403632=>{const _0x2c531a=_0x3d93d7;if(!validateTelegram(_0x403632))return;tgBot[_0x2c531a(0x328)](_0x2c531a(0x2e6));const _0x39dd90=getEnabledBots();if(_0x39dd90[_0x2c531a(0x3a3)]==0x0)tgBot[_0x2c531a(0x21e)](_0x403632['chat']['id'],_0x2c531a(0x1f8))['catch'](_0x210612=>{telegramError(_0x210612);});else{if(_0x39dd90['length']>0x1){let _0x3fc293=[],_0x3972e4=[];const _0x4d38ad=_0x39dd90[_0x2c531a(0x3a3)]%0x4==0x0||_0x39dd90[_0x2c531a(0x3a3)]%0x4==0x3||_0x39dd90[_0x2c531a(0x3a3)]%0x3==0x1?0x4:0x3;let _0x47fcb4=0x0;_0x39dd90['forEach']((_0x4debe9,_0xd61a5e)=>{const _0x4916af=_0x2c531a;if(_0xd61a5e%_0x4d38ad==0x0)_0x3972e4=[];_0x3972e4[_0x4916af(0x340)]({'text':'Bot\x20'+_0x4debe9[_0x4916af(0x2d0)],'callback_data':_0x4debe9[_0x4916af(0x2d0)]}),_0xd61a5e%_0x4d38ad==0x0&&(_0x3fc293[_0x47fcb4]=_0x3972e4,_0x47fcb4++);}),tgBot[_0x2c531a(0x21e)](_0x403632['chat']['id'],'For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',{'reply_markup':{'inline_keyboard':_0x3fc293}})[_0x2c531a(0x29d)](_0x2a8ceb=>{telegramError(_0x2a8ceb);}),tgBot['on'](_0x2c531a(0x2e6),async _0x26a771=>{const _0x475154=_0x2c531a,_0x11ce7c=_0x26a771['data'],_0x551aca=_0x26a771[_0x475154(0x205)];tgBot[_0x475154(0x2e5)](_0x26a771['id'])[_0x475154(0x26d)](async()=>{const _0x21ccae=_0x475154;if(pid[_0x11ce7c])pid[_0x11ce7c][_0x21ccae(0x32b)]({'function':_0x21ccae(0x345),'args':null});}),tgBot['removeListener'](_0x475154(0x2e6));});}else{const _0xa98a0a=_0x39dd90[0x0][_0x2c531a(0x2d0)];if(pid[_0xa98a0a])pid[_0xa98a0a][_0x2c531a(0x32b)]({'function':_0x2c531a(0x345),'args':null});}}}),tgBot[_0x3d93d7(0x2e4)](/\/portfolio/,_0x4343d8=>{const _0x339d91=_0x3d93d7;if(!validateTelegram(_0x4343d8))return;tgBot[_0x339d91(0x328)]('callback_query');const _0x50b9cd=getEnabledBots();if(_0x50b9cd[_0x339d91(0x3a3)]==0x0)tgBot[_0x339d91(0x21e)](_0x4343d8[_0x339d91(0x381)]['id'],_0x339d91(0x1f8))['catch'](_0x21bae0=>{telegramError(_0x21bae0);});else{if(_0x50b9cd[_0x339d91(0x3a3)]>0x1){let _0x43b4bc=[],_0x1338e9=[];const _0x59a391=_0x50b9cd[_0x339d91(0x3a3)]%0x4==0x0||_0x50b9cd['length']%0x4==0x3||_0x50b9cd[_0x339d91(0x3a3)]%0x3==0x1?0x4:0x3;let _0x12e621=0x0;_0x50b9cd[_0x339d91(0x2ef)]((_0x30d131,_0x5d8437)=>{const _0xb2d7db=_0x339d91;if(_0x5d8437%_0x59a391==0x0)_0x1338e9=[];_0x1338e9[_0xb2d7db(0x340)]({'text':_0xb2d7db(0x333)+_0x30d131[_0xb2d7db(0x2d0)],'callback_data':_0x30d131['botID']}),_0x5d8437%_0x59a391==0x0&&(_0x43b4bc[_0x12e621]=_0x1338e9,_0x12e621++);}),tgBot['sendMessage'](_0x4343d8[_0x339d91(0x381)]['id'],_0x339d91(0x338),{'reply_markup':{'inline_keyboard':_0x43b4bc}})[_0x339d91(0x29d)](_0x5ce7e9=>{telegramError(_0x5ce7e9);}),tgBot['on'](_0x339d91(0x2e6),async _0x273b33=>{const _0x44921b=_0x339d91,_0x53b296=_0x273b33[_0x44921b(0x324)],_0x343ad1=_0x273b33[_0x44921b(0x205)];tgBot[_0x44921b(0x2e5)](_0x273b33['id'])['then'](async()=>{const _0x5e1b2f=_0x44921b;if(pid[_0x53b296])pid[_0x53b296][_0x5e1b2f(0x32b)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x44921b(0x328)](_0x44921b(0x2e6));});}else{const _0x17f32f=_0x50b9cd[0x0][_0x339d91(0x2d0)];if(pid[_0x17f32f])pid[_0x17f32f][_0x339d91(0x32b)]({'function':_0x339d91(0x36c),'args':null});}}}),tgBot[_0x3d93d7(0x2e4)](/\/update/,async _0x249b2d=>{const _0x185959=_0x3d93d7;if(!validateTelegram(_0x249b2d))return;tgBot[_0x185959(0x328)]('callback_query'),await getMessages();if(!updateAvailable)tgBot[_0x185959(0x21e)](_0x249b2d[_0x185959(0x381)]['id'],_0x185959(0x311))[_0x185959(0x29d)](_0x296177=>{telegramError(_0x296177);});else!validInstallation?tgBot[_0x185959(0x21e)](_0x249b2d[_0x185959(0x381)]['id'],_0x185959(0x213))[_0x185959(0x29d)](_0x325a1b=>{telegramError(_0x325a1b);}):(tgBot[_0x185959(0x21e)](_0x249b2d[_0x185959(0x381)]['id'],_0x185959(0x397),{'reply_markup':{'inline_keyboard':[[{'text':_0x185959(0x2ed),'callback_data':_0x185959(0x330)},{'text':'No','callback_data':'no'}]]}})['catch'](_0x234aee=>{telegramError(_0x234aee);}),tgBot['on'](_0x185959(0x2e6),async _0x5011c7=>{const _0x4f0eac=_0x185959,_0xf83857=_0x5011c7['data'],_0x144871=_0x5011c7[_0x4f0eac(0x205)];tgBot['answerCallbackQuery'](_0x5011c7['id'])[_0x4f0eac(0x26d)](async()=>{const _0x3856cc=_0x4f0eac;_0xf83857=='yes'&&(await tgBot[_0x3856cc(0x21e)](_0x144871[_0x3856cc(0x381)]['id'],'Starting\x20Balance\x20Bot\x20update')[_0x3856cc(0x29d)](_0x2bd23d=>{telegramError(_0x2bd23d);}),updateBB(_0x3856cc(0x392))),_0xf83857=='no'&&await tgBot[_0x3856cc(0x21e)](_0x144871['chat']['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later')[_0x3856cc(0x29d)](_0x174895=>{telegramError(_0x174895);});}),tgBot['removeListener'](_0x4f0eac(0x2e6));}));}),tgBot['onText'](/\/reinstall/,async _0x5a69e9=>{const _0x361eff=_0x3d93d7;if(!validateTelegram(_0x5a69e9))return;tgBot[_0x361eff(0x328)]('callback_query'),!validInstallation?tgBot['sendMessage'](_0x5a69e9[_0x361eff(0x381)]['id'],_0x361eff(0x383))[_0x361eff(0x29d)](_0x35f7f3=>{telegramError(_0x35f7f3);}):(tgBot[_0x361eff(0x21e)](_0x5a69e9[_0x361eff(0x381)]['id'],_0x361eff(0x315),{'reply_markup':{'inline_keyboard':[[{'text':_0x361eff(0x2ed),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x361eff(0x29d)](_0x2a9bd5=>{telegramError(_0x2a9bd5);}),tgBot['on'](_0x361eff(0x2e6),async _0x1a6290=>{const _0xabf97e=_0x361eff,_0x54849b=_0x1a6290[_0xabf97e(0x324)],_0x12c14a=_0x1a6290['message'];tgBot['answerCallbackQuery'](_0x1a6290['id'])[_0xabf97e(0x26d)](async()=>{const _0x10663a=_0xabf97e;_0x54849b==_0x10663a(0x330)&&(await tgBot['sendMessage'](_0x12c14a['chat']['id'],_0x10663a(0x325))[_0x10663a(0x29d)](_0x4150b3=>{telegramError(_0x4150b3);}),updateBB(_0x10663a(0x232))),_0x54849b=='no'&&await tgBot[_0x10663a(0x21e)](_0x12c14a[_0x10663a(0x381)]['id'],_0x10663a(0x298))[_0x10663a(0x29d)](_0x3d0451=>{telegramError(_0x3d0451);});}),tgBot[_0xabf97e(0x328)](_0xabf97e(0x2e6));}));}),tgBot[_0x3d93d7(0x2e4)](/\/toggle/,_0x19f316=>{const _0x37b07e=_0x3d93d7;if(!validateTelegram(_0x19f316))return;tgBot[_0x37b07e(0x328)]('callback_query');const _0x696a50=getBotsWithMode();if(_0x696a50[_0x37b07e(0x3a3)]==0x0)tgBot['sendMessage'](_0x19f316[_0x37b07e(0x381)]['id'],_0x37b07e(0x1f8))[_0x37b07e(0x29d)](_0x3591ae=>{telegramError(_0x3591ae);});else{let _0xfd3d99=[],_0x1fc24f=[];const _0x568d97=0x2;let _0x2d9874=0x0;_0x696a50['forEach']((_0x226048,_0x563cf9)=>{const _0xd164a9=_0x37b07e;if(_0x563cf9%_0x568d97==0x0)_0x1fc24f=[];_0x1fc24f['push']({'text':_0xd164a9(0x333)+_0x226048['botID']+'\x20('+_0x226048['mode']+')','callback_data':_0x226048[_0xd164a9(0x2d0)]}),_0x563cf9%_0x568d97==0x0&&(_0xfd3d99[_0x2d9874]=_0x1fc24f,_0x2d9874++);}),tgBot[_0x37b07e(0x21e)](_0x19f316[_0x37b07e(0x381)]['id'],_0x37b07e(0x373),{'reply_markup':{'inline_keyboard':_0xfd3d99}})[_0x37b07e(0x29d)](_0x25182c=>{telegramError(_0x25182c);}),tgBot['on']('callback_query',async _0x55b36=>{const _0x4ccba5=_0x37b07e,_0x19e7ae=_0x55b36[_0x4ccba5(0x324)],_0x3397ee=_0x55b36[_0x4ccba5(0x205)];tgBot['answerCallbackQuery'](_0x55b36['id'])[_0x4ccba5(0x26d)](async()=>{const _0x1cb9af=_0x4ccba5,_0x404227=_0x696a50[_0x1cb9af(0x2d8)](_0x1ffce9=>_0x1ffce9['botID']==_0x19e7ae),_0xcc93d=_0x404227[_0x1cb9af(0x3b6)]==_0x1cb9af(0x2cf)?_0x1cb9af(0x26f):_0x1cb9af(0x2cf);tgBot[_0x1cb9af(0x21e)](_0x3397ee[_0x1cb9af(0x381)]['id'],_0x1cb9af(0x242)+_0x19e7ae+_0x1cb9af(0x25d)+_0xcc93d+_0x1cb9af(0x237))[_0x1cb9af(0x29d)](_0x1a4ff3=>{telegramError(_0x1a4ff3);}),toggleBotMode(_0x19e7ae);}),tgBot[_0x4ccba5(0x328)](_0x4ccba5(0x2e6));});}}),tgBot[_0x3d93d7(0x2e4)](/\/names/,_0x358f38=>{const _0x4b0c85=_0x3d93d7;if(!validateTelegram(_0x358f38))return;let _0x45516e='';config[_0x4b0c85(0x2ef)](_0x172827=>{const _0x49c445=_0x4b0c85;_0x45516e+=_0x49c445(0x333)+_0x172827[_0x49c445(0x2d0)]+':\x20'+_0x172827[_0x49c445(0x226)]+'\x0a';}),tgBot[_0x4b0c85(0x21e)](_0x358f38[_0x4b0c85(0x381)]['id'],_0x45516e,{'parse_mode':_0x4b0c85(0x395)})[_0x4b0c85(0x29d)](_0x53a9dd=>{telegramError(_0x53a9dd);});}),tgBot[_0x3d93d7(0x2e4)](/\/disable/,_0x480c37=>{const _0x4939f2=_0x3d93d7;if(!validateTelegram(_0x480c37))return;tgBot[_0x4939f2(0x21e)](_0x480c37['chat']['id'],_0x4939f2(0x281))[_0x4939f2(0x29d)](_0x291d59=>{telegramError(_0x291d59);}),updateSetting(_0x4939f2(0x276),![]);}),tgBot[_0x3d93d7(0x2e4)](/\/help/,_0x4a96e9=>{const _0x45b722=_0x3d93d7;if(!validateTelegram(_0x4a96e9))return;tgBot[_0x45b722(0x21e)](_0x4a96e9[_0x45b722(0x381)]['id'],_0x50473c)[_0x45b722(0x29d)](_0x23389c=>{telegramError(_0x23389c);});}),tgBot['on'](_0x3d93d7(0x2df),_0x5ae447=>{const _0x313dba=_0x3d93d7;_0x5ae447['toString']()[_0x313dba(0x387)](_0x313dba(0x3bb))&&(logger[_0x313dba(0x22d)](_0x313dba(0x30f)),tgBot[_0x313dba(0x37d)](),tgBot=null,io['to'](_0x313dba(0x269))[_0x313dba(0x331)]('notification',_0x313dba(0x30f)));}),process['once']('SIGINT',()=>{const _0x1fcc95=_0x3d93d7;if(tgBot)tgBot[_0x1fcc95(0x37d)]();process[_0x1fcc95(0x2f9)](0x1);}),process['once'](_0x3d93d7(0x2a2),()=>{const _0x24a844=_0x3d93d7;if(tgBot)tgBot['stopPolling']();process[_0x24a844(0x2f9)](0x1);});}}function disableTelegram(){const _0x1fded2=_0x4ad479;tgBot&&(tgBot[_0x1fded2(0x37d)](),tgBot=null);}function sendTelegram(_0x5be20f,_0x335786){const _0x62b846=_0x4ad479;if(settings[_0x62b846(0x276)]){if(settings[_0x62b846(0x347)]==_0x62b846(0x28c)||(_0x335786['type']==_0x62b846(0x37a)||_0x335786['type']==_0x62b846(0x29f)||_0x335786[_0x62b846(0x25a)]==_0x62b846(0x21b))&&settings[_0x62b846(0x347)]=='alerts'||_0x335786[_0x62b846(0x25a)]==_0x62b846(0x351)&&settings[_0x62b846(0x347)]==_0x62b846(0x3ab)){if(tgBot&&settings[_0x62b846(0x268)]){if(_0x335786['showname'])tgBot[_0x62b846(0x21e)](settings[_0x62b846(0x268)],_0x335786[_0x62b846(0x226)]+_0x62b846(0x329)+_0x335786['event'])[_0x62b846(0x29d)](_0x4cafff=>{telegramError(_0x4cafff);});else tgBot[_0x62b846(0x21e)](settings[_0x62b846(0x268)],'Bot\x20'+_0x5be20f+'\x20>\x20'+_0x335786['event'])[_0x62b846(0x29d)](_0x3122ff=>{telegramError(_0x3122ff);});}}}}async function sendTelegramMsg(_0x1cb18d,_0x24cea1='HTML'){const _0x4cdd9a=_0x4ad479;return settings['telegramEnabled']&&tgBot&&settings['telegramChatId']?(await tgBot[_0x4cdd9a(0x21e)](settings[_0x4cdd9a(0x268)],_0x1cb18d,{'parse_mode':_0x24cea1})['catch'](_0x18f150=>{telegramError(_0x18f150);}),!![]):![];}function getDeviceWithIp(_0xe8222b){const _0x466cc7=_0x4ad479;return devices[_0x466cc7(0x2d8)](_0x22d2ea=>_0x22d2ea['ip']===_0xe8222b);}function temporaryAccess2FA(_0x2bb1cd,_0x311294){const _0x3839a7=_0x4ad479;let _0x27ab9f=new Date(),_0x43f194=![];if(lastIpApproval){if(_0x27ab9f-lastIpApproval<0x1388)_0x43f194=!![];}lastIpApproval=new Date();if(_0x43f194)return;tgBot&&settings[_0x3839a7(0x268)]&&(tgBot['removeListener'](_0x3839a7(0x2e6)),tgBot[_0x3839a7(0x21e)](settings[_0x3839a7(0x268)],_0x3839a7(0x2b5)+normalizeIP(_0x311294)[_0x3839a7(0x3b4)]+_0x3839a7(0x1ea),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x3839a7(0x1f4),'callback_data':'5'},{'text':_0x3839a7(0x2cb),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x3839a7(0x374),'callback_data':_0x3839a7(0x374)}]]}})[_0x3839a7(0x29d)](_0x569aa5=>{telegramError(_0x569aa5);}),tgBot['on'](_0x3839a7(0x2e6),async _0x593aa4=>{const _0x4488bb=_0x3839a7,_0x5924d5=_0x593aa4[_0x4488bb(0x324)],_0xefedd7=_0x593aa4[_0x4488bb(0x205)];tgBot[_0x4488bb(0x2e5)](_0x593aa4['id'])[_0x4488bb(0x26d)](async()=>{const _0xb03386=_0x4488bb;devices[_0x2bb1cd]['telegramIpApproval']={'clientip':_0x311294,'timestamp':new Date()[_0xb03386(0x361)](),'expiry':_0x5924d5},_0x5924d5!=_0xb03386(0x374)?(await tgBot[_0xb03386(0x21e)](_0xefedd7['chat']['id'],'Access\x20enabled\x20for\x20'+_0x5924d5+_0xb03386(0x2dc),{'parse_mode':'HTML'})[_0xb03386(0x29d)](_0x154a0d=>{telegramError(_0x154a0d);}),io['to'](_0x2bb1cd)[_0xb03386(0x331)](_0xb03386(0x1ff),{'access':{'allow':![],'reason':_0xb03386(0x309),'token':null}})):(await tgBot['sendMessage'](_0xefedd7[_0xb03386(0x381)]['id'],'Temporary\x20access\x20rejected')[_0xb03386(0x29d)](_0x10823b=>{telegramError(_0x10823b);}),io['to'](_0x2bb1cd)[_0xb03386(0x331)](_0xb03386(0x1ff),{'access':{'allow':![],'reason':_0xb03386(0x243),'token':null}}));}),tgBot['removeListener']('callback_query');}));}function loginAccess2FA(_0x2e5e80,_0x3e82ed){const _0x549672=_0x4ad479;tgBot&&settings[_0x549672(0x268)]&&(tgBot[_0x549672(0x328)]('callback_query'),tgBot[_0x549672(0x21e)](settings[_0x549672(0x268)],_0x549672(0x2bb)+normalizeIP(_0x3e82ed)[_0x549672(0x3b4)]+'</b>\x20?',{'parse_mode':_0x549672(0x395),'reply_markup':{'inline_keyboard':[[{'text':_0x549672(0x29b),'callback_data':loginExpiry},{'text':_0x549672(0x374),'callback_data':'reject'}]]}})[_0x549672(0x29d)](_0x19cc5e=>{telegramError(_0x19cc5e);}),tgBot['on'](_0x549672(0x2e6),async _0x1864b9=>{const _0x3b2cb3=_0x549672,_0x4bed45=_0x1864b9[_0x3b2cb3(0x324)],_0x32fe70=_0x1864b9[_0x3b2cb3(0x205)];tgBot[_0x3b2cb3(0x2e5)](_0x1864b9['id'])[_0x3b2cb3(0x26d)](async()=>{const _0x265e91=_0x3b2cb3;devices[_0x2e5e80][_0x265e91(0x1f0)]={'clientip':_0x3e82ed,'timestamp':new Date()[_0x265e91(0x361)](),'expiry':_0x4bed45},_0x4bed45!=_0x265e91(0x374)?(await tgBot[_0x265e91(0x21e)](_0x32fe70[_0x265e91(0x381)]['id'],'Login\x20accepted',{'parse_mode':_0x265e91(0x395)})['catch'](_0x3ba37f=>{telegramError(_0x3ba37f);}),io['to'](_0x2e5e80)['emit'](_0x265e91(0x1ff),{'access':{'allow':![],'reason':_0x265e91(0x309),'token':null}})):(await tgBot[_0x265e91(0x21e)](_0x32fe70['chat']['id'],_0x265e91(0x20e))[_0x265e91(0x29d)](_0x183b73=>{telegramError(_0x183b73);}),io['to'](_0x2e5e80)[_0x265e91(0x331)](_0x265e91(0x1ff),{'access':{'allow':![],'reason':_0x265e91(0x2ec),'token':null}}));}),tgBot[_0x3b2cb3(0x328)](_0x3b2cb3(0x2e6));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x218cc3=_0x4ad479;return dbConfig[_0x218cc3(0x286)]('bots')[_0x218cc3(0x386)]('botID')[_0x218cc3(0x2ce)]({'status':_0x218cc3(0x20b)})[_0x218cc3(0x20c)]()||[];}function getDisabledBots(){const _0x3b4eed=_0x4ad479;return dbConfig[_0x3b4eed(0x286)]('bots')[_0x3b4eed(0x386)](_0x3b4eed(0x2d0))[_0x3b4eed(0x2ce)]({'status':_0x3b4eed(0x2c6)})[_0x3b4eed(0x20c)]()||[];}function getBotAttributes(_0x21e573){const _0xcdb04=_0x4ad479;let _0x453b49={};const _0x5bf88f=configpath+_0xcdb04(0x1ee)+_0x21e573+_0xcdb04(0x22f),_0x276431=fs[_0xcdb04(0x323)](_0x5bf88f);if(_0x276431){const _0x2cbfd7=fs['readFileSync'](_0x5bf88f);try{const _0x59f670=JSON[_0xcdb04(0x26a)](_0x2cbfd7),_0x2dd47b=_0x59f670?_0x59f670[_0xcdb04(0x22e)][0x0]['headless']:![];_0x453b49[_0xcdb04(0x3b6)]=_0x2dd47b?_0xcdb04(0x2cf):_0xcdb04(0x26f),_0x453b49[_0xcdb04(0x226)]=_0x59f670?_0x59f670[_0xcdb04(0x22e)][0x0][_0xcdb04(0x226)]:_0xcdb04(0x333)+_0x21e573;}catch(_0x65b0a7){_0x453b49[_0xcdb04(0x3b6)]=_0xcdb04(0x26f),_0x453b49[_0xcdb04(0x226)]=_0xcdb04(0x333)+_0x21e573;}}else _0x453b49[_0xcdb04(0x3b6)]=_0xcdb04(0x26f),_0x453b49[_0xcdb04(0x226)]=_0xcdb04(0x333)+_0x21e573;return _0x453b49;}function getBotsWithMode(){const _0x4e55c2=_0x4ad479,_0x714665=dbConfig[_0x4e55c2(0x286)](_0x4e55c2(0x2d7))[_0x4e55c2(0x386)](_0x4e55c2(0x2d0))['value']()||[];return _0x714665[_0x4e55c2(0x2ef)](_0x5ed924=>{const _0x2963e8=_0x4e55c2;let _0x13d2d6=getBotAttributes(_0x5ed924[_0x2963e8(0x2d0)]);_0x5ed924[_0x2963e8(0x3b6)]=_0x13d2d6[_0x2963e8(0x3b6)];}),_0x714665;}function getBotExchanges(){const _0x20c54f=_0x4ad479;let _0x13a8fd=[];const _0x51e4eb=dbConfig[_0x20c54f(0x286)](_0x20c54f(0x2d7))[_0x20c54f(0x386)](_0x20c54f(0x2d0))[_0x20c54f(0x20c)]()||[];_0x51e4eb[_0x20c54f(0x2ef)](_0x5c2ae9=>{const _0x437f08=_0x20c54f;if(_0x5c2ae9[_0x437f08(0x1ff)]==_0x437f08(0x20b)){const _0x182407=configpath+_0x437f08(0x1ee)+_0x5c2ae9[_0x437f08(0x2d0)]+'-config.json',_0x5855ff=fs[_0x437f08(0x323)](_0x182407);let _0x2d40f9;if(_0x5855ff){const _0x19f3d7=fs[_0x437f08(0x28f)](_0x182407);try{const _0x21392d=JSON['parse'](_0x19f3d7);_0x2d40f9=_0x21392d?_0x21392d[_0x437f08(0x22e)][0x0][_0x437f08(0x1e6)]:null;}catch(_0x4d254f){}}if(_0x2d40f9)_0x13a8fd['push'](_0x2d40f9);}});const _0x9f6a8d=[...new Set(_0x13a8fd)][_0x20c54f(0x27c)]();return _0x9f6a8d;}async function initUser(){const _0x42c964=_0x4ad479;if(!settings[_0x42c964(0x3af)]){const _0x19eb78=uuidRandom();mixpanel['alias'](_0x19eb78),updateSetting('userid',_0x19eb78);}}async function initSecure(){const _0x5aaca6=_0x4ad479;let _0x4bc63f=getSecure();if(!_0x4bc63f[_0x5aaca6(0x38c)](_0x5aaca6(0x37b))){let _0x49f8ae=await generateKeys();_0x4bc63f[_0x5aaca6(0x2ee)]=_0x49f8ae[_0x5aaca6(0x2ee)],_0x4bc63f[_0x5aaca6(0x2d4)]=_0x49f8ae['privateKey'],_0x4bc63f[_0x5aaca6(0x37b)]=crypto[_0x5aaca6(0x3b1)](0x20)[_0x5aaca6(0x273)](_0x5aaca6(0x2ad));;storeSecure(_0x4bc63f);}}function getSettings(){const _0x3713d7=_0x4ad479;return dbSettings[_0x3713d7(0x286)](_0x3713d7(0x316))[_0x3713d7(0x20c)]()||{};}function getSecure(){const _0x31ddcd=_0x4ad479;return dbSecure['get'](_0x31ddcd(0x260))[_0x31ddcd(0x20c)]()||{};}function getBlacklist(){const _0x47e893=_0x4ad479;return dbSecure[_0x47e893(0x286)]('blacklist')[_0x47e893(0x20c)]()||[];}function broadcastToBots(_0x318164,_0x45e938){config['forEach'](_0x262632=>{const _0x4b9add=_0xc8be;if(_0x262632[_0x4b9add(0x1ff)]=='enabled'&&_0x262632[_0x4b9add(0x23d)]==_0x4b9add(0x35b)||_0x262632['status']==_0x4b9add(0x254)&&_0x262632[_0x4b9add(0x23d)]==_0x4b9add(0x35b)){if(pid[_0x262632[_0x4b9add(0x2d0)]])pid[_0x262632[_0x4b9add(0x2d0)]][_0x4b9add(0x32b)]({[_0x318164]:_0x45e938});}});}function storeSettings(_0x5bc1c5,_0x2e46f8=![]){const _0x197e90=_0x4ad479;_0x5bc1c5={...settings,..._0x5bc1c5};if(_0x2e46f8&&_0x5bc1c5[_0x197e90(0x2da)]!=_0x197e90(0x32d)&&_0x5bc1c5[_0x197e90(0x2da)]!=_0x197e90(0x319)&&_0x5bc1c5[_0x197e90(0x2da)]!=''){const _0x3aa81b=crypt[_0x197e90(0x308)](secure[_0x197e90(0x2d4)],_0x5bc1c5[_0x197e90(0x2da)])[_0x197e90(0x205)][_0x197e90(0x201)]('@')[0x0],_0x19f842=bcrypt[_0x197e90(0x2f6)](_0x3aa81b,saltRounds);_0x5bc1c5={..._0x5bc1c5,'bbPassword':_0x19f842};}if(_0x2e46f8&&_0x5bc1c5[_0x197e90(0x2e2)]!=_0x197e90(0x32d)&&_0x5bc1c5[_0x197e90(0x2e2)]!='***'&&_0x5bc1c5['telegramToken']!=''){const _0x1c1276=crypt[_0x197e90(0x308)](secure['privateKey'],_0x5bc1c5[_0x197e90(0x2e2)])[_0x197e90(0x205)][_0x197e90(0x201)]('@')[0x0];_0x5bc1c5={..._0x5bc1c5,'telegramToken':_0x1c1276};}const _0xa7270d=_0x5bc1c5['telegramToken']!=_0x197e90(0x32d)&&_0x5bc1c5['telegramToken']!=settings[_0x197e90(0x2e2)]||_0x5bc1c5['telegramUsername']!=settings[_0x197e90(0x2f0)],_0x54e27b=_0x5bc1c5[_0x197e90(0x2e2)]==''||_0x5bc1c5[_0x197e90(0x2f0)]=='';if(_0xa7270d)_0x5bc1c5['telegramEvents']=_0x197e90(0x28c);for(const [_0x5dd7ca,_0x2a33c4]of Object[_0x197e90(0x346)](_0x5bc1c5)){if(_0x5dd7ca==_0x197e90(0x2e2)&&_0x2a33c4==_0x197e90(0x32d)){_0x5bc1c5[_0x197e90(0x2e2)]=settings['telegramToken'];continue;};if(_0x5dd7ca==_0x197e90(0x2da)&&_0x2a33c4=='************'){_0x5bc1c5[_0x197e90(0x2da)]=settings[_0x197e90(0x2da)];continue;};dbSettings[_0x197e90(0x297)](_0x197e90(0x390)+_0x5dd7ca,_0x2a33c4)['write']();}settings=_0x5bc1c5,io['to']('botmanager')[_0x197e90(0x331)](_0x197e90(0x316),cleanSettings()),broadcastToBots('timeshift',settings[_0x197e90(0x391)]),broadcastToBots(_0x197e90(0x20f),settings['onepagemode']);if(_0xa7270d&&!_0x54e27b)initTelegram();if(_0xa7270d&&_0x54e27b)disableTelegram();getAllClients()['forEach'](_0x473c30=>{const _0x4d4a2d=_0x197e90;getSocket(_0x473c30['id'])[_0x4d4a2d(0x331)](_0x4d4a2d(0x1ff),{'access':{'allow':![],'reason':_0x4d4a2d(0x309),'token':null}});});}function updateSetting(_0x32d2c7,_0x52965d){const _0x20b51c=_0x4ad479;dbSettings['set'](_0x20b51c(0x390)+_0x32d2c7,_0x52965d)[_0x20b51c(0x35d)](),settings=getSettings(),io['to'](_0x20b51c(0x269))[_0x20b51c(0x331)]('settings',cleanSettings());}function storeSecure(_0x3d196a){const _0x48df14=_0x4ad479;dbSecure[_0x48df14(0x286)](_0x48df14(0x260))[_0x48df14(0x340)](_0x3d196a)['write'](),secure=_0x3d196a;}function addBlacklist(_0x64cd10){const _0x3c5305=_0x4ad479;cleanBlacklist();let _0x26d094;devices[_0x64cd10][_0x3c5305(0x230)]?_0x26d094=Math[_0x3c5305(0x39b)](devices[_0x64cd10][_0x3c5305(0x230)][_0x3c5305(0x2b8)],loginExpiry):_0x26d094=loginExpiry,dbSecure[_0x3c5305(0x286)](_0x3c5305(0x266))[_0x3c5305(0x340)]({'expiry':new Date()[_0x3c5305(0x361)]()+_0x26d094*0x3c*0x3e8,'token':devices[_0x64cd10]['access'][_0x3c5305(0x271)]})[_0x3c5305(0x35d)](),blacklist=dbSecure[_0x3c5305(0x286)](_0x3c5305(0x266))[_0x3c5305(0x20c)]();}function cleanBlacklist(){const _0x3168cb=_0x4ad479;let _0x323567=dbSecure[_0x3168cb(0x286)](_0x3168cb(0x266))[_0x3168cb(0x393)]()['value'](),_0x508cf5=new Date()[_0x3168cb(0x361)]();_0x323567[_0x3168cb(0x2ef)](_0x1e0cb1=>{const _0x23eea4=_0x3168cb;_0x1e0cb1[_0x23eea4(0x2b8)]<_0x508cf5&&dbSecure[_0x23eea4(0x286)](_0x23eea4(0x266))[_0x23eea4(0x3a2)]({'expiry':_0x1e0cb1[_0x23eea4(0x2b8)]})[_0x23eea4(0x35d)]();});}function initStates(){let _0x345995=getConfiguration();_0x345995['forEach'](_0x348dbc=>{const _0x18f106=_0xc8be;_0x348dbc[_0x18f106(0x23d)]=_0x18f106(0x39c);}),storeConfiguration(_0x345995);}function onKeys(){const _0x55409f=new RSA();return new Promise(_0x571291=>{const _0x30408c=_0xc8be;_0x55409f['generateKeyPairAsync']()[_0x30408c(0x26d)](_0x249c68=>{_0x571291(_0x249c68);});});}function _0x7155(){const _0x42e6cf=['Restoring\x20bot(s)\x20from\x20backup','Restarting\x20Bot\x20','download','telegrammsg','Backup\x20file\x20uploaded','botname','storeConfiguration','bb/','Notifications\x20types:\x20','$1_$2_$3','access\x20timeout','notification','full','bot','-config.json','telegramIpApproval','-results.json','reinstall','logged\x20out','Node.js\x20v','hybrid-crypto-js','::ffff:127.0.0.1','\x20mode','/metrics\x20-\x20show\x20bot\x20performance\x0a','isDirectory','File\x20uploaded','lowdb','port','live','[ip-address]','store-configuration','/:bot/portfolio','Unauthorized\x20attempt\x20to\x20update\x20settings','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','temporary\x20access\x20rejected','All\x20bots','ipaddr.js','709647uJfpgp','Orders','statSync','ipc','show-config','lastmsgtelegram','delete-alerts','createWriteStream','getMonth','getPortfolio','whitelistEnabled','search','NTBA_FIX_319','telegram','new','/:bot/history','reinstall-bb','\x20|\x20client:\x20...','get-starting-balances','password','type','Deleted\x20Bot\x20','keys','\x20to\x20',',\x20must\x20be\x20a\x204\x20digit\x20number','sha256','secure','http','latestversion','User\x20has\x20been\x20validated','pidRefreshToken','node-telegram-bot-api','blacklist','logs/','telegramChatId','botmanager','parse','Logged\x20in\x20user\x20...','pidExpireLogin','then','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','manual','\x20only\x0a','token','host','toString','store','output-000.log','telegramEnabled','Bot\x20Mgr\x20>\x20','replace','1000','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','getUTCHours','sort','backup-full@','Notifications\x20enabled\x0a','internal','stringify','Notifications\x20disabled','add','deleteHistoryAlerts','node','(((.+)+)+)+$','get','argv','temp/','update-bb','DEFLATE','Notifications\x20enabled','all','\x1b[34m','\x20|\x20user:\x20...','readFileSync','from','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','defaults','apiSecret','lastmsgemitted','log',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','set','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','referer','accept','#RES#\x20if\x20running\x20on\x20server','catch','/:bot/support','warning','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','showConfig','SIGTERM','whitelist','mkdirSync','-----------------------------------------------------------------------------------','-events.json','confirm-message','*$1*','/update\x20-\x20update\x20Balance\x20Bot\x0a','::1','emitHistory','apiKey','hex','auth','bb-config.json','init','socket','headless','inherit','mixpanel','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','update-bot','expiry','backupfile','connection','Allow\x20login\x20from\x20IP\x20address\x20<b>','\x1b[33m','params','use','tkn','Idling\x20bot\x20\x20\x20|\x20Bot\x20','writeFileSync','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','restart','delete-bot','version','disabled','All\x20bots\x20running\x20right\x20now','sendFile','bot.js','Setting\x20access:\x20','15\x20min','connected','temporary\x20access\x20timeout','filter','auto','botID','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','user','private','privateKey','args','181316xYRVrk','bots','find','request','bbPassword','.zip','\x20minutes','All','/restart\x20-\x20restart\x20bot(s)\x0a','polling_error','kill','simple','telegramToken','getMinutes','onText','answerCallbackQuery','callback_query','getDate','get-portfolio','Unauthorized\x20attempt\x20to\x20download\x20','toggleBotMode','timestamp','2FA\x20login\x20rejected','Yes','publicKey','forEach','telegramUsername','file','Unauthorized\x20attempt\x20to\x20update\x20bot','2hcUMKu','apply','node-zip','hashSync','started','index.html','exit','Session\x20expired\x20for\x20user\x20...','express','Unauthorized\x20attempt\x20to\x20delete\x20bot','build2','Crypt','slice','31975fZPKnc','server','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','478098UpNQKQ','padStart','listen','post','graphql-request','decrypt','reload','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','loginRequired','getFullYear','You\x20can\x20use\x20the\x20following\x20commands:\x0a','zip/','Invalid\x20Telegram\x20token','test','Your\x20installation\x20is\x20already\x20up\x20to\x20date','login\x20token\x20generated','RSA-OAEP','Restore\x20backup\x20file\x20','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','settings','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','axios','***','placeOrder','Invalid\x20authentication\x20token\x20(1)','files','Password\x20has\x20been\x20reset\x20to:\x20','stop','/names\x20-\x20show\x20bot\x20names\x0a','6b67f3d61ee94b8f5c80b4affef4c4d9','allow','2FA','existsSync','data','Starting\x20Balance\x20Bot\x20reinstallation','-performance.json','generate','removeListener','\x20>\x20','function','send','api-eu.mixpanel.com','************','Unauthorized\x20attempt\x20to\x20confirm\x20message','Markdown','yes','emit','get-messages','Bot\x20','assign','remoteAddress','output-003.log','/:bot/configuration','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','static','temporary\x20token\x20generated','backup/','127.0.0.1','address','getStartingBalances','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','push','encryptedUuid','apiPassword','logout','Starting\x20#RED#Balance\x20Bot\x20v','sendMetricsTelegram','entries','telegramEvents','sign','rmSync','get-logs','/enable\x20-\x20enable\x20notifications\x0a','debug','headers','Disabled\x20Bot\x20','uuid-random','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','order','constructor','Invalid\x20IP\x20address','backup-files','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Unauthorized\x20attempt\x20to\x20store\x20configuration','\x20(2)','/:bot/coins','Unauthorized\x20attempt\x20to\x20get\x20messages','\x20|\x20','running','versions','write','9316770SrJecA','/output-000.log','sockets','getTime','/status\x20-\x20show\x20bot(s)\x20status\x0a','Starting\x20new\x20bot\x20|\x20Bot\x20','disconnect','reason','Error:\x20Invalid\x20argument\x20','match','removeAllListeners','path','updatebotmanager','handshake','sendPortfolioTelegram','createServer','family','add-bot','output-001.log','backup',':\x20Bot\x20Mgr\x20>\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','reject','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','getHours','Token\x20blacklisted','mtime','Starting\x20bot\x20|\x20Bot\x20','error','secret','socket.io','stopPolling','getSeconds','get-backup-files','access','chat','login\x20token\x20valid','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Restore\x20process\x20aborted','sortBy','includes','name','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','range','toIPv4MappedAddress','hasOwnProperty','bbvNew','fork','login\x20not\x20required','settings.','timeshift','update','cloneDeep','0.0.0','HTML','new-disabled','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Invalid\x20authentication\x20token\x20(2)','number','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','max','stopped','cancel-loading','login','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','2FA\x20required','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','remove','length','uuid','kind','Unauthorized\x20attempt\x20to\x20delete\x20alerts','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','temporaryAccessAllowed','f2aRequired','Enabled\x20Bot\x20','orders','bbUsername','toggle-bot-mode','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','userid','unlinkSync','randomBytes','backup-full.zip','Unauthorized\x20attempt\x20to\x20log\x20out','show','invalid\x20credentials','mode','join','copyFileSync','size','login\x20required','404\x20Not\x20Found','2FA\x20login\x20required','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','messages','reset-history','<b>Balance\x20Bot\x20Status:</b>\x0a','bb-settings.json','exchange','#RES#\x0a','startsWith','Unauthorized\x20attempt\x20to\x20get\x20events','</b>\x20?','https://api.ipify.org?format=json','restore-backup-file','/on\x20-\x20start\x20bot(s)\x0a','bot-','cancelLoading','telegram2FaApproval','express-fileupload','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','format','5\x20min','env','store-headless','1204056SLDTRj','No\x20bots\x20running\x20right\x20now','3000','Notifications\x20disabled\x0a','clientip','2FA\x20login\x20token\x20generated','Invalid\x20username\x20or\x20IP\x20address','username','status','randomFillSync','split','198XVsOSU','output-002.log','binary','message','alerts','storeHeadless','build','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','969260ctUezD','enabled','value','readdirSync','Login\x20rejected','onepagemode','util','/download/:type','Server','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','version.json','56KUONOZ','lowdb/adapters/FileSync','>\x20Open\x20Bot\x20Manager\x20at\x20#BLU#http://','any','Failed\x20to\x20download\x20','bb-secure.json','success','crypto','<b>Telegram\x20Bot\x20Status:</b>\x0a','sendMessage','yargs/yargs','Starting\x20Balance\x20Bot\x20'];_0x7155=function(){return _0x42e6cf;};return _0x7155();}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x3f35e0=_0x4ad479;let _0x5ef96f=getSettings(),_0x4136d5=![];!_0x5ef96f[_0x3f35e0(0x38c)](_0x3f35e0(0x24b))&&(_0x5ef96f[_0x3f35e0(0x24b)]=0x0,_0x4136d5=!![]);!_0x5ef96f[_0x3f35e0(0x38c)](_0x3f35e0(0x294))&&(_0x5ef96f[_0x3f35e0(0x294)]=0x0,_0x4136d5=!![]);!_0x5ef96f[_0x3f35e0(0x38c)](_0x3f35e0(0x262))&&(_0x5ef96f[_0x3f35e0(0x262)]=_0x3f35e0(0x394),_0x4136d5=!![]);!_0x5ef96f['hasOwnProperty']('onepagemode')&&(_0x5ef96f[_0x3f35e0(0x20f)]=![],_0x4136d5=!![]);if(_0x4136d5)storeSettings(_0x5ef96f);}function storeConfiguration(_0x19820c){const _0x582241=_0x4ad479;dbConfig[_0x582241(0x286)]('bots')['remove']()[_0x582241(0x35d)](),_0x19820c[_0x582241(0x2ef)](_0xd52508=>{delete _0xd52508['mode'];}),dbConfig[_0x582241(0x286)](_0x582241(0x2d7))[_0x582241(0x340)](..._0x19820c)[_0x582241(0x35d)](),config=_0x19820c;}function resetPassword(){const _0x54ed41=_0x4ad479;tgBot&&settings[_0x54ed41(0x268)]&&(tgBot[_0x54ed41(0x328)]('callback_query'),tgBot[_0x54ed41(0x21e)](settings[_0x54ed41(0x268)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x54ed41(0x330)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x2a79ef=>{telegramError(_0x2a79ef);}),tgBot['on'](_0x54ed41(0x2e6),async _0x4ab7f4=>{const _0x49adbf=_0x54ed41,_0x27fed9=_0x4ab7f4['data'],_0x13a268=_0x4ab7f4[_0x49adbf(0x205)];tgBot[_0x49adbf(0x2e5)](_0x4ab7f4['id'])[_0x49adbf(0x26d)](async()=>{const _0x7f4c45=_0x49adbf;if(_0x27fed9!='no'){const _0x15685b=0xf,_0x4e7010=_0x7f4c45(0x355),_0x29284a=Array[_0x7f4c45(0x290)](crypto[_0x7f4c45(0x200)](new Uint32Array(_0x15685b)))['map'](_0x3b8c77=>_0x4e7010[_0x3b8c77%_0x4e7010[_0x7f4c45(0x3a3)]])['join'](''),_0x4502e0=bcrypt[_0x7f4c45(0x2f6)](_0x29284a,saltRounds);storeSettings({'bbPassword':_0x4502e0}),await tgBot[_0x7f4c45(0x21e)](_0x13a268[_0x7f4c45(0x381)]['id'],_0x7f4c45(0x31d)+_0x29284a,{'parse_mode':'HTML'})[_0x7f4c45(0x29d)](_0x34949f=>{telegramError(_0x34949f);});}else await tgBot['sendMessage'](_0x13a268[_0x7f4c45(0x381)]['id'],'Password\x20reset\x20rejected')[_0x7f4c45(0x29d)](_0x179e22=>{telegramError(_0x179e22);});}),tgBot[_0x49adbf(0x328)](_0x49adbf(0x2e6));}));}async function confirmRestore(_0x2673fb,_0x5000cd){const _0x420760=_0x4ad479;io['to']('botmanager')[_0x420760(0x331)](_0x420760(0x22c),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x420760(0x21b)),tgBot&&settings[_0x420760(0x268)]&&(tgBot[_0x420760(0x328)](_0x420760(0x2e6)),await tgBot[_0x420760(0x21e)](settings[_0x420760(0x268)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x420760(0x330)},{'text':'no','callback_data':'no'}]]}})[_0x420760(0x29d)](_0x1c2410=>{telegramError(_0x1c2410);}),tgBot['on'](_0x420760(0x2e6),async _0x2efc6b=>{const _0x7bfa78=_0x420760,_0x792044=_0x2efc6b['data'],_0x25b0a=_0x2efc6b[_0x7bfa78(0x205)];tgBot[_0x7bfa78(0x2e5)](_0x2efc6b['id'])['then'](async()=>{const _0x534ba8=_0x7bfa78;_0x792044==_0x534ba8(0x330)?(await tgBot[_0x534ba8(0x21e)](_0x25b0a[_0x534ba8(0x381)]['id'],_0x534ba8(0x221),{'parse_mode':_0x534ba8(0x395)})[_0x534ba8(0x29d)](_0x4c56f8=>{telegramError(_0x4c56f8);}),unzipFile(_0x2673fb,_0x5000cd)):(logger['debug'](_0x534ba8(0x385)),await tgBot[_0x534ba8(0x21e)](_0x25b0a[_0x534ba8(0x381)]['id'],_0x534ba8(0x385))[_0x534ba8(0x29d)](_0x411d64=>{telegramError(_0x411d64);}));}),tgBot[_0x7bfa78(0x328)](_0x7bfa78(0x2e6));}));}function getServerTime(){const _0x1a7325=_0x4ad479,_0x3c46a2=new Date();return _0x3c46a2[_0x1a7325(0x30c)]()+'/'+(_0x3c46a2[_0x1a7325(0x24e)]()+0x1)[_0x1a7325(0x273)]()[_0x1a7325(0x304)](0x2,'0')+'/'+_0x3c46a2[_0x1a7325(0x2e7)]()[_0x1a7325(0x273)]()['padStart'](0x2,'0')+'\x20'+_0x3c46a2[_0x1a7325(0x376)]()[_0x1a7325(0x273)]()[_0x1a7325(0x304)](0x2,'0')+':'+_0x3c46a2[_0x1a7325(0x2e3)]()[_0x1a7325(0x273)]()[_0x1a7325(0x304)](0x2,'0')+':'+_0x3c46a2[_0x1a7325(0x37e)]()[_0x1a7325(0x273)]()[_0x1a7325(0x304)](0x2,'0');}function getTimeStamp(){const _0x3e129c=_0x4ad479,_0x19a040=shiftedTime();return _0x19a040[_0x3e129c(0x30c)]()+'/'+(_0x19a040[_0x3e129c(0x24e)]()+0x1)[_0x3e129c(0x273)]()[_0x3e129c(0x304)](0x2,'0')+'/'+_0x19a040[_0x3e129c(0x2e7)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x19a040[_0x3e129c(0x376)]()[_0x3e129c(0x273)]()['padStart'](0x2,'0')+':'+_0x19a040[_0x3e129c(0x2e3)]()[_0x3e129c(0x273)]()[_0x3e129c(0x304)](0x2,'0')+':'+_0x19a040[_0x3e129c(0x37e)]()[_0x3e129c(0x273)]()[_0x3e129c(0x304)](0x2,'0');}function getCleanTimeStamp(){const _0x1cb595=_0x4ad479,_0x63fe51=shiftedTime();return _0x63fe51[_0x1cb595(0x30c)]()+(_0x63fe51['getMonth']()+0x1)[_0x1cb595(0x273)]()[_0x1cb595(0x304)](0x2,'0')+_0x63fe51[_0x1cb595(0x2e7)]()[_0x1cb595(0x273)]()[_0x1cb595(0x304)](0x2,'0')+'-'+_0x63fe51[_0x1cb595(0x376)]()[_0x1cb595(0x273)]()[_0x1cb595(0x304)](0x2,'0')+_0x63fe51[_0x1cb595(0x2e3)]()[_0x1cb595(0x273)]()['padStart'](0x2,'0')+_0x63fe51[_0x1cb595(0x37e)]()['toString']()[_0x1cb595(0x304)](0x2,'0');}function shiftedTime(){const _0x48ddd3=_0x4ad479,_0x54f3c7=new Date();let _0x309f27=_0x54f3c7;if(settings['timeshift']&&settings[_0x48ddd3(0x391)]!==0x0)_0x309f27=fns[_0x48ddd3(0x282)](_0x54f3c7,{'hours':settings['timeshift']});return _0x309f27;}function startScheduler(){const _0xff93df=_0x4ad479,_0x2a414b=new Date()[_0xff93df(0x27b)](),_0xfbbc1c=shiftedTime()[_0xff93df(0x376)]();_0xfbbc1c==0x4&&backupConfigFiles();_0xfbbc1c==0x0&&rotateLogFiles();_0x2a414b%0x6==0x0&&triggerAnalytics();_0x2a414b%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x29236c){const _0x4605c7=_0x4ad479;logger[_0x4605c7(0x34c)](_0x4605c7(0x314)+_0x29236c);const _0x685708=getBotsWithMode();_0x685708['length']>0x0?confirmRestore(configbackuppath,_0x29236c):unzipFile(configbackuppath,_0x29236c);}async function getBackupFiles(_0x147091=null){const _0x67bde8=_0x4ad479;let _0xaa4331=[],_0x1ff7b7=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x1ff7b7[_0x67bde8(0x27c)]((_0x3c6e5f,_0x851fbc)=>_0x3c6e5f[_0x67bde8(0x388)]<_0x851fbc[_0x67bde8(0x388)]?0x1:_0x851fbc[_0x67bde8(0x388)]<_0x3c6e5f[_0x67bde8(0x388)]?-0x1:0x0),_0x1ff7b7['forEach'](_0x460698=>{const _0x480b31=_0x67bde8;if(!_0x460698[_0x480b31(0x239)]()&&_0x460698['name'][_0x480b31(0x1e8)](_0x480b31(0x27d))&&_0x460698[_0x480b31(0x388)]['endsWith'](_0x480b31(0x2db))){const _0x1d3cd4=formatDate(fs['statSync'](configbackuppath+_0x460698[_0x480b31(0x388)])[_0x480b31(0x378)]);_0xaa4331['push']({'name':_0x460698[_0x480b31(0x388)],'mtime':_0x1d3cd4});}});if(_0x147091)io['to'](_0x147091)[_0x67bde8(0x331)](_0x67bde8(0x354),_0xaa4331);else return _0xaa4331;}async function backupConfigFiles(){const _0x3d4277=_0x4ad479;await zipFiles('backup-full');const _0x2c629c=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x3d4277(0x3b2),configbackuppath+(_0x3d4277(0x27d)+_0x2c629c+'.zip'));let _0x1c40e9=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x1c40e9[_0x3d4277(0x27c)]((_0x33cf10,_0x28d7ee)=>_0x33cf10['name']<_0x28d7ee[_0x3d4277(0x388)]?0x1:_0x28d7ee[_0x3d4277(0x388)]<_0x33cf10['name']?-0x1:0x0),_0x1c40e9[_0x3d4277(0x3a3)]>maxBackups&&fs[_0x3d4277(0x3b0)](configbackuppath+_0x1c40e9[maxBackups][_0x3d4277(0x388)]);}function rotateLogFiles(){const _0x50edb9=_0x4ad479,_0x11c1c6=fs[_0x50edb9(0x248)](logspath+'output-000.log'),_0x145a83=_0x11c1c6[_0x50edb9(0x3b9)]/0x400;if(_0x145a83>0x64){let _0xb21a1d=fs[_0x50edb9(0x20d)](logspath,{'withFileTypes':!![]});_0xb21a1d[_0x50edb9(0x27c)]((_0x210197,_0x5329c0)=>_0x210197[_0x50edb9(0x388)]<_0x5329c0[_0x50edb9(0x388)]?0x1:_0x5329c0[_0x50edb9(0x388)]<_0x210197[_0x50edb9(0x388)]?-0x1:0x0),_0xb21a1d[_0x50edb9(0x2ef)](_0x4e99e4=>{const _0x7f9d24=_0x50edb9;if(_0x4e99e4[_0x7f9d24(0x388)]==_0x7f9d24(0x203))fs[_0x7f9d24(0x3b8)](logspath+_0x4e99e4['name'],logspath+_0x7f9d24(0x336));if(_0x4e99e4[_0x7f9d24(0x388)]=='output-001.log')fs[_0x7f9d24(0x3b8)](logspath+_0x4e99e4['name'],logspath+_0x7f9d24(0x203));_0x4e99e4['name']==_0x7f9d24(0x275)&&(fs[_0x7f9d24(0x3b8)](logspath+_0x4e99e4['name'],logspath+_0x7f9d24(0x370)),fs[_0x7f9d24(0x2c1)](logspath+_0x4e99e4['name'],''));});}}async function zipFiles(_0x50cb10){const _0x490558=_0x4ad479;let _0x3dee73;if(_0x50cb10=='logs')_0x3dee73=logspath;if(_0x50cb10==_0x490558(0x371))_0x3dee73=configpath;if(_0x50cb10=='backup-full')_0x3dee73=configpath;let _0x3c7a17=fs['readdirSync'](_0x3dee73,{'withFileTypes':!![]});const _0x5b48e9=new require('node-zip')();_0x3c7a17[_0x490558(0x2ef)](_0x1e805f=>{const _0x4c21fd=_0x490558;if(!_0x1e805f[_0x4c21fd(0x239)]()){let _0x575e19=fs[_0x4c21fd(0x28f)](_0x3dee73+_0x1e805f['name']);if(_0x50cb10=='backup'){const _0x1f6e38=/^bot-[0-9]{3}-config.json$/,_0x3ac771=_0x1f6e38[_0x4c21fd(0x310)](_0x1e805f[_0x4c21fd(0x388)]);if(_0x3ac771){const _0x11cba8=JSON['parse'](_0x575e19);if(_0x11cba8[_0x4c21fd(0x22e)][0x0]){_0x11cba8[_0x4c21fd(0x22e)][0x0][_0x4c21fd(0x2ac)]=_0x4c21fd(0x319),_0x11cba8[_0x4c21fd(0x22e)][0x0][_0x4c21fd(0x293)]=_0x4c21fd(0x319);if(_0x11cba8[_0x4c21fd(0x22e)][0x0][_0x4c21fd(0x342)])_0x11cba8['bot'][0x0][_0x4c21fd(0x342)]=_0x4c21fd(0x319);}_0x575e19=JSON['stringify'](_0x11cba8,null,0x2);}if(_0x1e805f[_0x4c21fd(0x388)]==_0x4c21fd(0x3c2)){const _0x9d3541=JSON[_0x4c21fd(0x26a)](_0x575e19);if(_0x9d3541['settings']['loginRequired'])_0x9d3541[_0x4c21fd(0x316)][_0x4c21fd(0x30b)]=![];if(_0x9d3541['settings'][_0x4c21fd(0x2da)])_0x9d3541[_0x4c21fd(0x316)][_0x4c21fd(0x2da)]=_0x4c21fd(0x319);if(_0x9d3541[_0x4c21fd(0x316)][_0x4c21fd(0x2e2)])_0x9d3541[_0x4c21fd(0x316)][_0x4c21fd(0x2e2)]=_0x4c21fd(0x319);if(_0x9d3541[_0x4c21fd(0x316)][_0x4c21fd(0x268)])_0x9d3541[_0x4c21fd(0x316)][_0x4c21fd(0x268)]=null;_0x575e19=JSON[_0x4c21fd(0x280)](_0x9d3541,null,0x2);}if(_0x1e805f[_0x4c21fd(0x388)]!=_0x4c21fd(0x21a))_0x5b48e9[_0x4c21fd(0x2f1)](_0x1e805f[_0x4c21fd(0x388)],_0x575e19);}else _0x5b48e9[_0x4c21fd(0x2f1)](_0x1e805f['name'],_0x575e19);}});const _0x3dd18a=_0x5b48e9[_0x490558(0x327)]({'base64':![],'compression':_0x490558(0x28a)});fs[_0x490558(0x2c1)](zippath+(_0x50cb10+_0x490558(0x2db)),_0x3dd18a,'binary');}async function unzipFile(_0x30b876,_0x41cdb9){const _0x24e210=_0x4ad479;fs[_0x24e210(0x20d)](configpath,{'withFileTypes':!![]})['forEach'](_0x51050e=>{const _0x113e1c=_0x24e210;if(!_0x51050e['isDirectory']())fs['rmSync'](configpath+_0x51050e[_0x113e1c(0x388)]);});const _0x24d54e=fs[_0x24e210(0x28f)](_0x30b876+_0x41cdb9,_0x24e210(0x204)),_0x5666fb=new require(_0x24e210(0x2f5))(_0x24d54e,{'base64':![],'checkCRC32':!![]});Object[_0x24e210(0x25c)](_0x5666fb['files'])['forEach'](_0x1e7b13=>{const _0x1ea973=_0x24e210,_0x519a5c=_0x5666fb['files'][_0x1e7b13];fs['writeFileSync'](configpath+_0x519a5c[_0x1ea973(0x388)],_0x519a5c['_data']);}),fs[_0x24e210(0x20d)](temppath,{'withFileTypes':!![]})[_0x24e210(0x2ef)](_0x42f7db=>{const _0x51d1fe=_0x24e210;if(!_0x42f7db['isDirectory']())fs[_0x51d1fe(0x349)](temppath+_0x42f7db[_0x51d1fe(0x388)]);}),logger['debug']('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x24e210(0x32b)]({'restore':!![]},_0x68a280=>{});}async function getPublicIp(){const _0x49a4dc=_0x4ad479;try{const _0x533955=await axios['get'](_0x49a4dc(0x1eb));publicip=_0x533955[_0x49a4dc(0x324)]['ip'];}catch(_0x1aa325){}}async function triggerAnalytics(){const _0x5050ab=_0x4ad479;if(!publicip)await getPublicIp();const _0x2a4c70=getBotsWithMode();let _0x2f7445=0x0;_0x2a4c70[_0x5050ab(0x2ef)](_0x458662=>{const _0x52c8ba=_0x5050ab;if(_0x458662[_0x52c8ba(0x1ff)]===_0x52c8ba(0x20b))_0x2f7445++;});const _0x20f202=getBotExchanges();mixpanel['track'](_0x5050ab(0x212),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x2a4c70[_0x5050ab(0x3a3)],'numbotsenabled':_0x2f7445,'exchanges':_0x20f202});}async function getMessages(){const _0x2c0ba8=_0x4ad479,_0x58b65d='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x2b6fdf=new GraphQLClient(_0x58b65d),_0x480696={'authorization':_0x2c0ba8(0x3ae)},_0x2c2016=serverversion['split']('.'),_0x362528=_0x2c2016[0x0]+'.'+_0x2c2016[0x1],_0x5d7b13=Math['min'](settings[_0x2c0ba8(0x24b)],settings[_0x2c0ba8(0x294)]),_0x25f1d9={'last':parseInt(_0x5d7b13),'bbm':_0x362528},_0x6d7177=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x3011c9;try{_0x3011c9=await _0x2b6fdf[_0x2c0ba8(0x2d9)](_0x6d7177,_0x25f1d9,_0x480696);}catch(_0x219446){}if(_0x3011c9&&_0x3011c9['messages']){let _0x12cde1=settings['lastmsgtelegram'];newMessages=[];for(const _0x30aa8b of _0x3011c9[_0x2c0ba8(0x3bf)]){newMessages[_0x2c0ba8(0x340)](_0x30aa8b);if(_0x30aa8b[_0x2c0ba8(0x38d)])updateSetting(_0x2c0ba8(0x262),_0x30aa8b[_0x2c0ba8(0x38d)]);let _0x13b54d=_0x30aa8b[_0x2c0ba8(0x38d)]?serverversion>=_0x30aa8b['bbvNew']:![];if(!_0x13b54d&&_0x30aa8b['number']>_0x12cde1){if(_0x30aa8b['bbvReceive']===_0x2c0ba8(0x218)||serverversion[_0x2c0ba8(0x1e8)](_0x30aa8b['bbvReceive'])){let _0x3c9505=''+_0x30aa8b['title']+'\x0a\x0a'+_0x30aa8b[_0x2c0ba8(0x205)];const _0x4f58ee=await sendTelegramMsg(toTelegramMarkdown(_0x3c9505),_0x2c0ba8(0x32f));if(_0x4f58ee)_0x12cde1=_0x30aa8b[_0x2c0ba8(0x399)];}}}updateAvailable=isNewerVersion(settings[_0x2c0ba8(0x262)],serverversion),updateSetting('lastmsgtelegram',_0x12cde1),emitMessages();}}function emitMessages(){const _0x5ba6a=_0x4ad479,_0x4d79cd=settings[_0x5ba6a(0x294)];let _0x21de8d=[];newMessages['forEach'](_0x342a0c=>{const _0x11e19e=_0x5ba6a;_0x342a0c[_0x11e19e(0x399)]>_0x4d79cd&&_0x21de8d[_0x11e19e(0x340)](_0x342a0c);}),_0x21de8d[_0x5ba6a(0x3a3)]>0x0&&getAllClients()[_0x5ba6a(0x2ef)](_0x156c5d=>{const _0x7372ed=_0x5ba6a;getSocket(_0x156c5d['id'])['emit'](_0x7372ed(0x205),_0x21de8d);});}function confirmMessage(_0x2f7ff3){const _0x499d39=_0x4ad479;updateSetting(_0x499d39(0x294),Number(_0x2f7ff3));}function isNewerVersion(_0x3526a0,_0x2bd55e){const _0x5ede86=_0x4ad479,_0x12b98c=_0x2bd55e[_0x5ede86(0x201)]('.'),_0xceff3d=_0x3526a0[_0x5ede86(0x201)]('.');for(var _0x3e4e18=0x0;_0x3e4e18<_0xceff3d[_0x5ede86(0x3a3)];_0x3e4e18++){const _0x5d442a=~~_0xceff3d[_0x3e4e18],_0x1216e9=~~_0x12b98c[_0x3e4e18];if(_0x5d442a>_0x1216e9)return!![];if(_0x5d442a<_0x1216e9)return![];}return![];}function toTelegramMarkdown(_0x30d7ea){const _0x5e831b=_0x4ad479,_0x5cc47e=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x52a12b=/\*{2}(.+?)\*{2}/gim;return _0x30d7ea=_0x30d7ea[_0x5e831b(0x278)](_0x5cc47e,_0x5e831b(0x22a))[_0x5e831b(0x278)](_0x52a12b,_0x5e831b(0x2a8)),_0x30d7ea;}async function validateConfigFile(){const _0x1c03e2=_0x4ad479,_0x521d39=dbConfig['get'](_0x1c03e2(0x2d7))[_0x1c03e2(0x386)]('botID')['value']()||[];if(_0x521d39['length']==0x0){let _0x19d72c=0x0,_0x188123=[];const _0x242389=/^bot-([0-9]{3})-config.json$/,_0x30a0e7=fs[_0x1c03e2(0x20d)](configpath);_0x30a0e7[_0x1c03e2(0x2ef)](_0x5c1e5b=>{const _0x5a5b43=_0x1c03e2,_0x50a2e4=_0x242389['exec'](_0x5c1e5b);if(_0x50a2e4){const _0x47cb69=_0x50a2e4[0x1];let _0x18545d=getBotAttributes(_0x47cb69);_0x188123[_0x5a5b43(0x340)]({'botID':_0x47cb69,'botname':_0x18545d[_0x5a5b43(0x226)],'status':'disabled','live':'stopped'}),_0x19d72c++;}}),_0x19d72c!=0x0&&(dbConfig[_0x1c03e2(0x286)](_0x1c03e2(0x2d7))['assign'](_0x188123)[_0x1c03e2(0x35d)](),config=_0x188123,restoredConfigFile=_0x19d72c);}}async function restoreConfigNotify(_0x3bc8a6){const _0x49d7d8=_0x4ad479;let _0x2470a5;if(restoredConfigFile==0x1)_0x2470a5=_0x49d7d8(0x3a7);else _0x2470a5='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x3bc8a6)io['to'](_0x49d7d8(0x269))[_0x49d7d8(0x331)]('notification',_0x2470a5);else{logger['simple'](_0x49d7d8(0x2a5)),logger[_0x49d7d8(0x2e1)](_0x2470a5),logger[_0x49d7d8(0x2e1)](_0x49d7d8(0x2a5)),logger[_0x49d7d8(0x2e1)]('');if(tgBot&&settings[_0x49d7d8(0x268)]&&settings[_0x49d7d8(0x347)]!=_0x49d7d8(0x3ab))tgBot[_0x49d7d8(0x21e)](settings['telegramChatId'],_0x49d7d8(0x277)+_0x2470a5)[_0x49d7d8(0x29d)](_0x2fd975=>{telegramError(_0x2fd975);});}}function validateCredentials(_0x67daf4,_0x409484){const _0x5aba6c=_0x4ad479;if(_0x67daf4[_0x5aba6c(0x1fe)]==settings[_0x5aba6c(0x3ac)]&&bcrypt['compareSync'](_0x67daf4[_0x5aba6c(0x259)],settings[_0x5aba6c(0x2da)])){if(settings[_0x5aba6c(0x3a9)])return{'allow':![],'reason':_0x5aba6c(0x3bc),'token':null};else{const _0x11efe3=generateLoginToken(_0x409484);return{'allow':!![],'reason':_0x5aba6c(0x312),'token':_0x11efe3};}}else return{'allow':![],'reason':_0x5aba6c(0x3b5),'token':null};}function refreshToken(_0x2557f9){const _0x32e88b=_0x4ad479,_0x44ff50=generateLoginToken(_0x2557f9);return{'allow':!![],'reason':_0x32e88b(0x312),'token':_0x44ff50};}function validateAccess(_0x3dbc26,_0x43e68c,_0x5edc2d){const _0x153f79=_0x4ad479,_0xaba552=_0x5edc2d?_0x5edc2d:devices[_0x43e68c]['ip'];let _0x1b5adc;const _0x4165ce=_0x1787aa=>{const _0x53edd9=_0xc8be;if(settings[_0x53edd9(0x30b)]){if(settings[_0x53edd9(0x3a9)]){if(telegram2FaApproved(_0x43e68c)){const _0x16f7e3=generateLoginToken(_0x43e68c);return{'allow':!![],'reason':_0x53edd9(0x1fc),'token':_0x16f7e3};}else return{'allow':![],'reason':_0x53edd9(0x3ba),'token':null};}else return _0x1b5adc=validToken(_0x1787aa,_0x43e68c),_0x1b5adc[_0x53edd9(0x38c)](_0x53edd9(0x21b))?{'allow':!![],'reason':_0x53edd9(0x382),'token':_0x1787aa}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x53edd9(0x38f),'token':null};};if(settings[_0x153f79(0x250)]){let _0x3e46ce=[...settings[_0x153f79(0x2a3)],_0x153f79(0x2aa),_0x153f79(0x236),_0x153f79(0x33c)];if(_0x3e46ce[_0x153f79(0x387)](_0xaba552))return _0x4165ce(_0x3dbc26);else{_0x1b5adc=validToken(_0x3dbc26,_0x43e68c);if(_0x1b5adc[_0x153f79(0x38c)]('success'))return _0x4165ce(_0x3dbc26);else{if(telegramIpApproved(_0x43e68c)){const _0x191a8e=generateToken(_0x43e68c);return _0x1b5adc=_0x4165ce(_0x3dbc26),_0x1b5adc[_0x153f79(0x321)]?{'allow':!![],'reason':_0x153f79(0x33a),'token':_0x191a8e}:_0x1b5adc;}else return settings[_0x153f79(0x3a8)]?{'allow':![],'reason':_0x153f79(0x3a0),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x4165ce(_0x3dbc26);}function timelyDecrypt(_0x4e479d,_0x480ee1=!![]){const _0xb36b34=_0x4ad479;if(_0x4e479d)try{const _0x308587=crypt[_0xb36b34(0x308)](secure['privateKey'],_0x4e479d)[_0xb36b34(0x205)],_0x44a92f=_0x308587[_0xb36b34(0x201)]('@')[0x0],_0x2aa85c=_0x308587[_0xb36b34(0x201)]('@')[0x1],_0x3c6117=new Date()[_0xb36b34(0x361)]();if(_0x480ee1){if(_0x3c6117-_0x2aa85c<maxSecretAge*0x3e8)return _0x44a92f;else return![];}else return _0x44a92f;}catch(_0x4b4384){return![];}else return![];}const validToken=(_0x764007,_0x499450)=>{const _0x245a00=_0x4ad479,_0x5a7d31=devices[_0x499450]['ip'];if(!_0x764007)return{'error':'No\x20authentication\x20token'};for(let _0x1eab67 of blacklist){if(_0x1eab67['token']==_0x764007)return{'error':_0x245a00(0x377)};}let _0x477682;try{_0x477682=jwt['verify'](_0x764007,secure[_0x245a00(0x37b)]+_0x499450);}catch{return{'error':_0x245a00(0x31b)};}if(!_0x477682['hasOwnProperty'](_0x245a00(0x1fb))&&!_0x477682[_0x245a00(0x38c)](_0x245a00(0x1fe))||!_0x477682[_0x245a00(0x38c)]('exp'))return{'error':_0x245a00(0x398)};if(!_0x477682[_0x245a00(0x38c)](_0x245a00(0x1fe))&&_0x477682[_0x245a00(0x38c)]('clientip')){const {clientip:_0xfc8b74}=_0x477682;return _0x5a7d31==_0xfc8b74?{'success':_0x245a00(0x263)}:{'error':_0x245a00(0x353)};}else{if(_0x477682['hasOwnProperty'](_0x245a00(0x1fe))&&_0x477682['hasOwnProperty'](_0x245a00(0x1fb))){const {username:_0x42aef2,clientip:_0x274e9a}=_0x477682;return settings[_0x245a00(0x3ac)]==_0x42aef2&&_0x5a7d31==_0x274e9a?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x245a00(0x1fd)};}}},generateLoginToken=_0x1c6fd6=>{const _0x297cad=_0x4ad479;if(_0x1c6fd6){const _0x5bb19f=devices[_0x1c6fd6]['ip'];return jwt['sign']({'username':settings[_0x297cad(0x3ac)],'clientip':_0x5bb19f},secure[_0x297cad(0x37b)]+_0x1c6fd6,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x16bb88=>{const _0x4c0a2a=_0x4ad479;if(_0x16bb88){const _0x5011b1=devices[_0x16bb88]['ip'];return jwt[_0x4c0a2a(0x348)]({'clientip':_0x5011b1},secure[_0x4c0a2a(0x37b)]+_0x16bb88,{'expiresIn':devices[_0x16bb88][_0x4c0a2a(0x230)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x5f00e7=>{const _0x43d0d4=_0x4ad479;let _0x1cacf8=![];return devices[_0x5f00e7]['telegramIpApproval']&&devices[_0x5f00e7][_0x43d0d4(0x230)]['expiry']!=_0x43d0d4(0x374)&&(_0x1cacf8=devices[_0x5f00e7][_0x43d0d4(0x230)][_0x43d0d4(0x1fb)]==devices[_0x5f00e7]['ip']&&new Date()['getTime']()-devices[_0x5f00e7][_0x43d0d4(0x230)][_0x43d0d4(0x2eb)]<devices[_0x5f00e7][_0x43d0d4(0x230)][_0x43d0d4(0x2b8)]*0x3c*0x3e8),_0x1cacf8;},telegram2FaApproved=_0x1f20ed=>{const _0x26c6e6=_0x4ad479;let _0x528658=![];return devices[_0x1f20ed][_0x26c6e6(0x1f0)]&&devices[_0x1f20ed][_0x26c6e6(0x1f0)][_0x26c6e6(0x2b8)]!=_0x26c6e6(0x374)&&(_0x528658=devices[_0x1f20ed][_0x26c6e6(0x1f0)]['clientip']==devices[_0x1f20ed]['ip']&&new Date()['getTime']()-devices[_0x1f20ed][_0x26c6e6(0x1f0)][_0x26c6e6(0x2eb)]<devices[_0x1f20ed]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x528658;},normalizeIP=_0x54c502=>{const _0x38db7b=_0x4ad479;let _0x874ea=null,_0x4c7f64=null;if(ipaddr['isValid'](_0x54c502)){const _0x33ef1a=ipaddr['parse'](_0x54c502);_0x33ef1a[_0x38db7b(0x3a5)]()==='ipv6'?(_0x33ef1a['isIPv4MappedAddress']()&&(_0x874ea=_0x33ef1a['toIPv4Address']()[_0x38db7b(0x273)]()),_0x4c7f64=_0x33ef1a[_0x38db7b(0x273)]()):(_0x874ea=_0x33ef1a[_0x38db7b(0x273)](),_0x4c7f64=_0x33ef1a[_0x38db7b(0x38b)]()[_0x38db7b(0x273)]());}return{'show':_0x874ea?_0x874ea:_0x4c7f64,'store':_0x4c7f64};};function formatDate(_0x273cab){const _0x391e21=_0x4ad479;return _0x273cab[_0x391e21(0x30c)]()+'/'+(_0x273cab['getMonth']()+0x1)[_0x391e21(0x273)]()[_0x391e21(0x304)](0x2,'0')+'/'+_0x273cab[_0x391e21(0x2e7)]()[_0x391e21(0x273)]()[_0x391e21(0x304)](0x2,'0')+'\x20'+_0x273cab['getHours']()[_0x391e21(0x273)]()[_0x391e21(0x304)](0x2,'0')+':'+_0x273cab['getMinutes']()[_0x391e21(0x273)]()[_0x391e21(0x304)](0x2,'0')+':'+_0x273cab[_0x391e21(0x37e)]()[_0x391e21(0x273)]()['padStart'](0x2,'0');}function sleep(_0x2630ff){return new Promise(_0x36418e=>setTimeout(_0x36418e,_0x2630ff));}