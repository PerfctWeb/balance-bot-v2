const _0xb627e7=_0x2bf3;(function(_0x3d2548,_0x4e3a8f){const _0x2db909=_0x2bf3,_0x3baa3a=_0x3d2548();while(!![]){try{const _0x3258e8=-parseInt(_0x2db909(0x14a))/0x1*(parseInt(_0x2db909(0xb1))/0x2)+parseInt(_0x2db909(0x1b1))/0x3+parseInt(_0x2db909(0xd6))/0x4*(-parseInt(_0x2db909(0x92))/0x5)+parseInt(_0x2db909(0x14b))/0x6+parseInt(_0x2db909(0xae))/0x7*(parseInt(_0x2db909(0x17e))/0x8)+-parseInt(_0x2db909(0xf8))/0x9*(-parseInt(_0x2db909(0xe3))/0xa)+-parseInt(_0x2db909(0x89))/0xb;if(_0x3258e8===_0x4e3a8f)break;else _0x3baa3a['push'](_0x3baa3a['shift']());}catch(_0x1ec874){_0x3baa3a['push'](_0x3baa3a['shift']());}}}(_0x3f9f,0x51523));const _0x57696c=function(){let _0x29fbd1=!![];return function(_0x235264,_0x479d8a){const _0x5dab06=_0x29fbd1?function(){const _0x1cd99b=_0x2bf3;if(_0x479d8a){const _0x3f59e8=_0x479d8a[_0x1cd99b(0xbb)](_0x235264,arguments);return _0x479d8a=null,_0x3f59e8;}}:function(){};return _0x29fbd1=![],_0x5dab06;};}(),_0x473175=_0x57696c(this,function(){const _0xa6c2c7=_0x2bf3;return _0x473175[_0xa6c2c7(0x116)]()[_0xa6c2c7(0x138)]('(((.+)+)+)+$')['toString']()['constructor'](_0x473175)[_0xa6c2c7(0x138)](_0xa6c2c7(0x189));});_0x473175();'use strict';process[_0xb627e7(0x108)][_0xb627e7(0xdf)]=0x1;const childProcess=require(_0xb627e7(0x177)),FileSync=require(_0xb627e7(0xd1)),fs=require('fs'),fns=require(_0xb627e7(0x14c)),low=require('lowdb'),path=require('path'),crypto=require(_0xb627e7(0x1a6)),Crypt=require(_0xb627e7(0x176))[_0xb627e7(0x178)],RSA=require(_0xb627e7(0x176))['RSA'],bcrypt=require(_0xb627e7(0x16d)),jwt=require(_0xb627e7(0x188)),analyticsLib=require(_0xb627e7(0x11e))[_0xb627e7(0x19c)],googleAnalytics=require(_0xb627e7(0x123))[_0xb627e7(0x19c)],ipaddr=require(_0xb627e7(0x103)),argv=require(_0xb627e7(0xb2))(process[_0xb627e7(0xa2)]['slice'](0x2))[_0xb627e7(0xa2)],PORT=argv[_0xb627e7(0x114)]||_0xb627e7(0x15b),pattern=/^[0-9]{2,4}$/;if(!pattern[_0xb627e7(0x18a)](PORT))return console[_0xb627e7(0x15a)](_0xb627e7(0xc9)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0xb627e7(0xaa)](0x1);const HOST=argv[_0xb627e7(0x1ae)]||null,userID=argv[_0xb627e7(0x1c7)]||'';let bbpath='';const botfile=_0xb627e7(0x10b),configfile=_0xb627e7(0x121),settingsfile='bb-settings.json',securefile=_0xb627e7(0x190),{addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath+_0xb627e7(0x1b6)),configpath=userID?bbpath+_0xb627e7(0x1c0)+userID+'/':bbpath+_0xb627e7(0x1c0),configbackuppath=configpath+_0xb627e7(0x124);!fs['existsSync'](configpath)&&fs['mkdirSync'](configpath);!fs[_0xb627e7(0x1c3)](configbackuppath)&&fs['mkdirSync'](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0xb627e7(0x134)]({'bots':[]})[_0xb627e7(0x16b)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0xb627e7(0x134)]({'settings':{'timeshift':0x0}})[_0xb627e7(0x16b)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0xb627e7(0x134)]({'secure':{},'blacklist':[]})[_0xb627e7(0x16b)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0xb627e7(0x186)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath+_0xb627e7(0x17c))[_0xb627e7(0x1dc)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require(_0xb627e7(0xe7)),app=express(),http=require('http')[_0xb627e7(0x8b)](app);app[_0xb627e7(0x1d3)](express[_0xb627e7(0x1bd)](path[_0xb627e7(0x129)](__dirname,bbpath,_0xb627e7(0x10c)))),app['use'](express[_0xb627e7(0x1bd)](path[_0xb627e7(0x129)](__dirname,bbpath,_0xb627e7(0x99)))),app[_0xb627e7(0x174)]('/',function(_0x142fbd,_0x4fc17c){const _0x294c40=_0xb627e7;_0x4fc17c[_0x294c40(0x1d5)](path[_0x294c40(0x129)](__dirname,bbpath,'build2',_0x294c40(0xf9)));}),app['get'](_0xb627e7(0x13e),function(_0x3d4fd3,_0x7f5637){const _0x1cb859=_0xb627e7;_0x7f5637[_0x1cb859(0x1d5)](path[_0x1cb859(0x129)](__dirname,bbpath,'build',_0x1cb859(0xf9)));}),app[_0xb627e7(0x174)]('/:bot/portfolio',(_0x287e35,_0x22cdde)=>{const _0x590731=_0xb627e7;_0x22cdde['sendFile'](path[_0x590731(0x129)](__dirname,bbpath,_0x590731(0x99),_0x590731(0xf9)));}),app[_0xb627e7(0x174)]('/:bot/performance',(_0x38165d,_0x2eea61)=>{const _0x332cb7=_0xb627e7;_0x2eea61[_0x332cb7(0x1d5)](path[_0x332cb7(0x129)](__dirname,bbpath,_0x332cb7(0x99),_0x332cb7(0xf9)));}),app[_0xb627e7(0x174)](_0xb627e7(0x1d1),(_0x30aa65,_0x1a7884)=>{const _0x19f48a=_0xb627e7;_0x1a7884['sendFile'](path[_0x19f48a(0x129)](__dirname,bbpath,_0x19f48a(0x99),'index.html'));}),app[_0xb627e7(0x174)](_0xb627e7(0x9c),(_0x19038b,_0x2695a8)=>{const _0x393831=_0xb627e7;_0x2695a8['sendFile'](path[_0x393831(0x129)](__dirname,bbpath,_0x393831(0x99),_0x393831(0xf9)));}),app[_0xb627e7(0x174)](_0xb627e7(0x18b),(_0x2eb915,_0x766208)=>{const _0x109755=_0xb627e7;_0x766208[_0x109755(0x1d5)](path['join'](__dirname,bbpath,_0x109755(0x99),'index.html'));}),app[_0xb627e7(0x174)](_0xb627e7(0x84),(_0x43615d,_0x506514)=>{const _0xe9b11f=_0xb627e7;_0x506514[_0xe9b11f(0x1d5)](path['join'](__dirname,bbpath,_0xe9b11f(0x99),_0xe9b11f(0xf9)));});if(HOST)http[_0xb627e7(0x127)](PORT,HOST);else http[_0xb627e7(0x127)](PORT);function _0x3f9f(){const _0x55f843=['place-order','enabled','cancelLoading','bots','NTBA_FIX_319','starting\x20bot\x20|\x20Bot\x20','isIPv4MappedAddress','function','10TGtalg','ipc','enabled\x20Bot\x20','<b>Telegram\x20bot\x20status:</b>\x0a','express','placeOrder','reject','::ffff:127.0.0.1','login','store-headless','User\x20has\x20been\x20validated',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','Balance\x20Bot\x20Server','args','status','telegramToken','stopped','sign','Unauthorized\x20attempt\x20to\x20log\x20out','sockets','headers','4295601ONUWjt','index.html','once','hasOwnProperty','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','sendMessage','add-bot','bot','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','disconnect','value','ipaddr.js','https://hodlerhacks.com','login\x20token\x20valid','30\x20min','toIPv4MappedAddress','env','socket.io','getMonth','bot.js','build2','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','toIPv4Address','/status\x20-\x20show\x20bot(s)\x20status\x0a','handshake','sortBy','bbUsername','success','port','secure','toString','get-logs','Unauthorized\x20login\x20attempt\x20(public\x20key)','getTime','new','initclient','catch','Invalid\x20Telegram\x20token','analytics','Unauthorized\x20attempt\x20to\x20update\x20settings','bbPassword','bb-config.json','accept','@analytics/google-analytics','backup/','connection','event','listen','length','join','Notifications\x20disabled\x0a','SIGINT','orders','Login\x20accepted','-----------------------------------------------------------------------------------','blacklist','temporary\x20token\x20generated','Unauthorized\x20login\x20attempt\x20(timeout)','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','\x20minutes','defaults','padStart','message','temporary\x20access\x20rejected','search','telegramUsername','-config.json','login\x20required','find','push','/:bot','f2aRequired','<b>Balance\x20Bot\x20status:</b>\x0a','5\x20min','-results.json','2FA','notification','idling\x20bot\x20\x20\x20|\x20Bot\x20','password','reason','pidExpireLogin','removeAllListeners','28810IgBhBJ','2434704dDPUxP','date-fns','emit','\x20>\x20','reload','Temporary\x20access\x20rejected','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Unauthorized\x20attempt\x20to\x20update\x20bot','publicKey','referer','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','restart','type','getPortfolio','All\x20bots\x20running\x20right\x20now','log','3000','/on\x20-\x20start\x20bot(s)\x0a','settings','Unauthorized\x20attempt\x20to\x20store\x20configuration','\x20only\x0a','all','isValid','HTML','login\x20not\x20required','filter','temporaryAccessAllowed','encryptedUuid','chat','generateKeyPairAsync','\x20/\x20','yes','write','forEach','bcryptjs','Token\x20blacklisted','cloneDeep','timestamp','apiKey','invalid\x20credentials','stopPolling','get','expiry','hybrid-crypto-js','child_process','Crypt','temporary\x20access\x20timeout','hex','Password\x20has\x20been\x20reset\x20to:\x20','version.json','No\x20authentication\x20token','19896MPCAUW','botname','Unauthorized\x20attempt\x20to\x20get\x20logs','kill','Bot\x20','telegram','Bot\x20Mgr\x20>\x20','removeListener','RSA-OAEP','Unauthorized\x20attempt\x20to\x20add\x20bot','jsonwebtoken','(((.+)+)+)+$','test','/:bot/configuration','::1','2FA\x20login\x20token\x20generated','compareSync','update-bot','bb-secure.json','settings.','-performance.json','randomBytes','access\x20timeout','127.0.0.1','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','new-disabled','2FA\x20login\x20rejected','bot-','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','getMinutes','default','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','All\x20bots','Balance\x20Bot','disabled','</b>\x20?','Access\x20enabled\x20for\x20','disabled\x20Bot\x20','send','telegramChatId','crypto','getSeconds','timeshift','/restart\x20-\x20restart\x20bot(s)\x0a','running','assign','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','emitHistory','host','server','max','1355526DKOzjh','Invalid\x20authentication\x20token\x20(2)','remove','parse','store-settings','clients','logged\x20out','includes','logout','update-bb','Alerts','2FA\x20required','static','getStartingBalances','-events.json','config/','then','Invalid\x20IP\x20address','existsSync','getFullYear','telegramIpApproval','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','user','isDirectory','error','UA-192771731-1','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','kind','get-starting-balances','Ok,\x20will\x20send\x20order\x20notifications\x20only','exp','answerCallbackQuery','/:bot/coins','************','use','starting\x20new\x20bot\x20|\x20Bot\x20','sendFile','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','storeConfiguration','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','pidRefreshToken','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','version','order','/:bot/support','ipv6','inherit','hashSync','live','7512736BmztPh','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','createServer','All','No\x20bots\x20running\x20right\x20now','secret','set','15\x20min','/enable\x20-\x20enable\x20notifications\x0a','50ZhFQdS','getDate','telegramEvents','telegram2FaApproval','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Allow\x20login\x20from\x20IP\x20address\x20<b>','remoteAddress','build','alerts','Ok,\x20will\x20send\x20alert\x20notifications\x20only','/:bot/history','\x20|\x20','allow',':\x20Bot\x20Mgr\x20>\x20','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','page','argv','login\x20token\x20generated','decrypt','2FA\x20login\x20required','randomFillSync','store','onText','temporary\x20access\x20not\x20allowed','exit','keys','Notifications\x20enabled\x0a','conn','42PoYyrJ','stop','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','12eLzEGo','yargs/yargs','whitelistEnabled','reset-password','Unauthorized\x20attempt\x20to\x20get\x20portfolio','split','access','started','data','privateKey','apply','error\x20while\x20deleting\x20config\x20files:\x20','loginRequired','botID','deleted\x20Bot\x20','match','unlinkSync','Invalid\x20authentication\x20token\x20(1)','callback_query','from','Notifications\x20types:\x20','username','/off\x20-\x20stop\x20bot(s)\x0a','Notifications\x20enabled','Error:\x20Invalid\x20argument\x20','token','404\x20Not\x20Found','clientip','show','botmanager','node-telegram-bot-api','entries','lowdb/adapters/FileSync','readdirSync','store-configuration','name','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','64364roGYJZ','getHours','uuid','whitelist','telegramEnabled'];_0x3f9f=function(){return _0x55f843;};return _0x3f9f();}const io=require(_0xb627e7(0x109))(http,{}),analytics=analyticsLib({'app':_0xb627e7(0x19f),'plugins':[googleAnalytics({'trackingId':_0xb627e7(0x1ca)})]}),TelegramBot=require(_0xb627e7(0xcf));let tgBot;if(settings['telegramToken']&&settings[_0xb627e7(0xf2)]!=''&&settings[_0xb627e7(0x139)]&&settings['telegramUsername']!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x27c614=_0xb627e7;console[_0x27c614(0x15a)](''),console[_0x27c614(0x15a)](_0x27c614(0x12e)),logging(_0x27c614(0x8a)+PORT),console[_0x27c614(0x15a)](_0x27c614(0x12e));if(config[_0x27c614(0x128)]!=0x0)config[_0x27c614(0x16c)](_0x33693c=>{const _0x29b152=_0x27c614;if(_0x33693c[_0x29b152(0xf1)]==_0x29b152(0xdc)||_0x33693c[_0x29b152(0xf1)]==_0x29b152(0x11a))logging(_0x29b152(0xe0)+_0x33693c[_0x29b152(0xbe)]+_0x29b152(0x9d)+_0x33693c[_0x29b152(0x17f)]),startBot([_0x33693c[_0x29b152(0xbe)],userID],{'cwd':bbpath},function(_0x23e4d4){if(_0x23e4d4)logging(_0x23e4d4);});else(_0x33693c[_0x29b152(0xf1)]==_0x29b152(0x1a0)||_0x33693c[_0x29b152(0xf1)]==_0x29b152(0x197))&&logging(_0x29b152(0x145)+_0x33693c[_0x29b152(0xbe)]+'\x20|\x20'+_0x33693c[_0x29b152(0x17f)]);});else!newBot&&console[_0x27c614(0x15a)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();console[_0x27c614(0x15a)](_0x27c614(0x12e)),console[_0x27c614(0x15a)]('');}function startSocket(){const _0x50584a=_0xb627e7;io['on'](_0x50584a(0x125),_0x50c49b=>{const _0x39290c=_0x50584a;let _0xf82376,_0x2b6e02,_0x13569b,_0x4266ce,_0x4ad948;const _0x4529b5=_0x50c49b['handshake'][_0x39290c(0xf7)][_0x39290c(0x154)];_0x2b6e02=_0x4529b5['match'](/bot[0-9]{3}/);if(_0x2b6e02)_0x13569b=_0x2b6e02[0x0][_0x39290c(0xc0)](/[0-9]{3}/);if(_0x13569b)_0xf82376=_0x13569b[0x0];else _0xf82376=_0x39290c(0xce);const _0xd31c42=_0x50c49b[_0x39290c(0x110)]['auth'][_0x39290c(0x166)];if(!_0xd31c42)_0x50c49b[_0x39290c(0x14d)](_0x39290c(0xf1),{'publicKey':secure[_0x39290c(0x153)]});else{_0x4266ce=timelyDecrypt(_0xd31c42,![]);if(!_0x4266ce)logging(_0x39290c(0x118));else{_0x4ad948=normalizeIP(_0x50c49b[_0x39290c(0xad)][_0x39290c(0x98)])[_0x39290c(0xa7)];if(!devices[_0x4266ce])devices[_0x4266ce]={'uuid':_0x4266ce,'access':{'token':null}};devices[_0x4266ce]['ip']=_0x4ad948;const _0x1650a4=addClient(_0x50c49b['id'],_0x4266ce,_0xf82376);setAccess(_0x1650a4),_0x50c49b['on']('login',_0x5b2eac=>{const _0x5d4b47=_0x39290c,_0x2b4820=timelyDecrypt(_0x5b2eac[_0x5d4b47(0x146)]);if(_0x2b4820){_0x5b2eac={'username':_0x5b2eac[_0x5d4b47(0xc6)],'password':_0x2b4820},devices[_0x4266ce]['access']=validateCredentials(_0x5b2eac,_0x4266ce);if(devices[_0x4266ce]['access'][_0x5d4b47(0x9e)]==![]&&devices[_0x4266ce][_0x5d4b47(0xb7)]['reason']==_0x5d4b47(0xa5))_0x50c49b[_0x5d4b47(0x14d)]('status',{'access':devices[_0x4266ce][_0x5d4b47(0xb7)]}),loginAccess2FA(_0x4266ce,_0x4ad948);else{if(devices[_0x4266ce]['access'][_0x5d4b47(0x9e)]==![]&&devices[_0x4266ce][_0x5d4b47(0xb7)][_0x5d4b47(0x147)]==_0x5d4b47(0x172))_0x50c49b[_0x5d4b47(0x14d)](_0x5d4b47(0xf1),{'access':devices[_0x4266ce]['access']});else devices[_0x4266ce][_0x5d4b47(0xb7)][_0x5d4b47(0x9e)]&&devices[_0x4266ce][_0x5d4b47(0xb7)][_0x5d4b47(0x147)]==_0x5d4b47(0xa3)&&(getClientsWithUuid(_0x4266ce)[_0x5d4b47(0x16c)](_0x1e778a=>{setAccess(_0x1e778a);}),setTokenRefresh(_0x4266ce),setSessionTimeout(_0x5d4b47(0xeb),_0x4266ce));}}else logging(_0x5d4b47(0x131));}),_0x50c49b['on'](_0x39290c(0xb4),()=>{resetPassword();}),_0x50c49b['on'](_0x39290c(0x101),_0x234229=>{removeClient(_0x50c49b['id']);});}}});}function initClient(_0x3b6389){const _0x9946d2=_0xb627e7;if(_0x3b6389!='botmanager'&&config[_0x9946d2(0x171)]!=''){if(pid[_0x3b6389])pid[_0x3b6389][_0x9946d2(0x1a4)]({'function':_0x9946d2(0x11b),'args':null});}}function getSocket(_0x34dd14){const _0x218151=_0xb627e7;return io[_0x218151(0xf6)][_0x218151(0xf6)][_0x218151(0x174)](_0x34dd14);}function setAccess(_0x5ea97d){const _0xc7e8cc=_0xb627e7,_0x4c5b63=getSocket(_0x5ea97d['id']),_0x5439f5=_0x5ea97d[_0xc7e8cc(0xd8)],_0x434fad=_0x5ea97d['bot'];devices[_0x5439f5]['access']=validateAccess(devices[_0x5439f5][_0xc7e8cc(0xb7)]['token'],_0x5439f5),_0x4c5b63[_0xc7e8cc(0x129)](_0x5439f5);if(devices[_0x5439f5][_0xc7e8cc(0xb7)]['allow']){_0x4c5b63[_0xc7e8cc(0x129)](_0x434fad);if(_0x434fad=='botmanager')initializeSocketBotManager(_0x4c5b63);else initializeSocketBot(_0x4c5b63);initClient(_0x434fad);}devices[_0x5439f5][_0xc7e8cc(0xb7)][_0xc7e8cc(0xca)]&&devices[_0x5439f5][_0xc7e8cc(0xb7)][_0xc7e8cc(0x147)]==_0xc7e8cc(0x130)&&setSessionTimeout(_0xc7e8cc(0x143),_0x5439f5),devices[_0x5439f5][_0xc7e8cc(0xb7)][_0xc7e8cc(0xca)]&&devices[_0x5439f5][_0xc7e8cc(0xb7)]['reason']=='2FA\x20login\x20token\x20generated'&&setSessionTimeout('login',_0x5439f5),_0x4c5b63['emit']('status',{'status':_0x5ea97d[_0xc7e8cc(0x1af)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x5439f5][_0xc7e8cc(0xb7)],'externalip':devices[_0x5439f5]['ip'],'publicKey':secure[_0xc7e8cc(0x153)]}),devices[_0x5439f5][_0xc7e8cc(0xb7)]['allow']==![]&&devices[_0x5439f5][_0xc7e8cc(0xb7)][_0xc7e8cc(0x147)]=='2FA\x20required'&&temporaryAccess2FA(_0x5439f5,devices[_0x5439f5]['ip']);}function setSessionTimeout(_0x5a66d0,_0x3735d2){const _0x49db5f=_0xb627e7;let _0x425c2a;if(_0x5a66d0==_0x49db5f(0xeb))_0x425c2a=loginExpiry*0x3c*0x3e8;else _0x425c2a=devices[_0x3735d2][_0x49db5f(0x1c5)][_0x49db5f(0x175)]*0x3c*0x3e8-(new Date()[_0x49db5f(0x119)]()-devices[_0x3735d2]['telegramIpApproval'][_0x49db5f(0x170)]);if(devices[_0x3735d2][_0x49db5f(0x148)])clearTimeout(devices[_0x3735d2][_0x49db5f(0x148)]);devices[_0x3735d2][_0x49db5f(0x148)]=setTimeout(()=>{const _0x379178=_0x49db5f;if(devices[_0x3735d2][_0x379178(0x1da)])clearTimeout(devices[_0x3735d2]['pidRefreshToken']);removeSocketListeners(_0x3735d2),addBlacklist(_0x3735d2),devices[_0x3735d2]['telegramIpApproval']=null,devices[_0x3735d2][_0x379178(0x95)]=null,devices[_0x3735d2]['access'][_0x379178(0xca)]=null,devices[_0x3735d2][_0x379178(0xb7)]=validateAccess(devices[_0x3735d2][_0x379178(0xb7)][_0x379178(0xca)],_0x3735d2),!(devices[_0x3735d2]['access'][_0x379178(0x9e)]&&devices[_0x3735d2][_0x379178(0xb7)]['reason']==_0x379178(0x163))&&(_0x5a66d0==_0x379178(0xeb)?io['to'](_0x3735d2)[_0x379178(0x14d)](_0x379178(0xf1),{'access':{'allow':![],'reason':_0x379178(0x194),'token':null}}):io['to'](_0x3735d2)[_0x379178(0x14d)](_0x379178(0xf1),{'access':{'allow':![],'reason':_0x379178(0x179),'token':null}})),devices[_0x3735d2]['access'][_0x379178(0xca)]=null;},_0x425c2a);}function setTokenRefresh(_0x171915){const _0x1ce161=_0xb627e7;if(devices[_0x171915][_0x1ce161(0x1da)])clearTimeout(devices[_0x171915][_0x1ce161(0x1da)]);devices[_0x171915][_0x1ce161(0x1da)]=setTimeout(()=>{const _0x2df585=_0x1ce161;getClientsWithUuid(_0x171915)[_0x2df585(0x128)]!=0x0?(devices[_0x171915]['access']=refreshToken(_0x171915),io['to'](_0x171915)[_0x2df585(0x14d)]('status',{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x171915]['access'],'externalip':devices[_0x171915]['ip'],'publicKey':secure[_0x2df585(0x153)]}),setTokenRefresh(_0x171915)):clearTimeout(devices[_0x171915][_0x2df585(0x1da)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2cfee1){const _0x23f7c0=_0xb627e7,_0x55c2ba=getClient(_0x2cfee1['id'])[_0x23f7c0(0xd8)];_0x2cfee1[_0x23f7c0(0x14d)](_0x23f7c0(0xde),config),_0x2cfee1[_0x23f7c0(0x14d)](_0x23f7c0(0x15d),cleanSettings()),_0x2cfee1['on'](_0x23f7c0(0xfe),_0x24aac2=>{const _0x3b63f6=_0x23f7c0;if(validateAccess(_0x24aac2,_0x55c2ba)['allow'])addBot();else logging(_0x3b63f6(0x187));}),_0x2cfee1['on'](_0x23f7c0(0x18f),(_0xdee56d,_0x4afd38)=>{const _0x1439ec=_0x23f7c0;if(validateAccess(_0x4afd38,_0x55c2ba)[_0x1439ec(0x9e)])toggleBot(_0xdee56d[_0x1439ec(0xbe)],_0xdee56d[_0x1439ec(0xf1)],_0xdee56d[_0x1439ec(0x88)]);else logging(_0x1439ec(0x152));}),_0x2cfee1['on']('delete-bot',(_0x5ce42a,_0x3992ab)=>{const _0x128716=_0x23f7c0;if(validateAccess(_0x3992ab,_0x55c2ba)[_0x128716(0x9e)])deleteBot(_0x5ce42a);else logging('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x2cfee1['on'](_0x23f7c0(0x1b5),(_0x4c4958,_0x4a01b3)=>{const _0x3cb6d2=_0x23f7c0;if(validateAccess(_0x4a01b3,_0x55c2ba)[_0x3cb6d2(0x9e)])storeSettings(_0x4c4958,!![]);else logging('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x2cfee1['on'](_0x23f7c0(0x1ba),(_0x1b3cff,_0x6246d5)=>{const _0x66b6cd=_0x23f7c0;if(validateAccess(_0x6246d5,_0x55c2ba)['allow'])updateBB();else logging(_0x66b6cd(0x11f));}),_0x2cfee1['on'](_0x23f7c0(0x1b9),_0x192bae=>{const _0x25710e=_0x23f7c0;if(validateAccess(_0x192bae,_0x55c2ba)[_0x25710e(0x9e)]){if(devices[_0x55c2ba][_0x25710e(0x1da)])clearTimeout(devices[_0x55c2ba][_0x25710e(0x1da)]);if(devices[_0x55c2ba][_0x25710e(0x148)])clearTimeout(devices[_0x55c2ba][_0x25710e(0x148)]);removeSocketListeners(getClient(_0x2cfee1['id'])['uuid']),addBlacklist(_0x55c2ba),devices[_0x55c2ba][_0x25710e(0x1c5)]=null,devices[_0x55c2ba]['telegram2FaApproval']=null,devices[_0x55c2ba]['access'][_0x25710e(0xca)]=null,io['to'](getClient(_0x2cfee1['id'])[_0x25710e(0xd8)])[_0x25710e(0x14d)](_0x25710e(0xf1),{'access':{'allow':![],'reason':_0x25710e(0x1b7),'token':null}});}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x3b36b6){const _0x32dc33=_0xb627e7,_0x533145=getClient(_0x3b36b6['id'])[_0x32dc33(0xff)],_0xcf62f9=getClient(_0x3b36b6['id'])[_0x32dc33(0xd8)];_0x3b36b6['on'](_0x32dc33(0x117),(_0x5df305,_0x38735e)=>{const _0x355b59=_0x32dc33;if(validateAccess(_0x38735e,_0xcf62f9)[_0x355b59(0x9e)]){if(pid[_0x533145])pid[_0x533145][_0x355b59(0x1a4)]({'function':_0x355b59(0x1ad),'args':_0x5df305});}else logging(_0x355b59(0x180));}),_0x3b36b6['on']('get-portfolio',(_0x3c4664,_0x22238c)=>{const _0x458d0d=_0x32dc33;if(validateAccess(_0x22238c,_0xcf62f9)['allow']){if(pid[_0x533145])pid[_0x533145]['send']({'function':_0x458d0d(0x158),'args':_0x3c4664});}else logging(_0x458d0d(0xb5));}),_0x3b36b6['on'](_0x32dc33(0xd3),(_0x1dcf73,_0x226974)=>{const _0x5eda22=_0x32dc33;if(validateAccess(_0x226974,_0xcf62f9)[_0x5eda22(0x9e)]){if(pid[_0x533145])pid[_0x533145][_0x5eda22(0x1a4)]({'function':_0x5eda22(0x1d7),'args':_0x1dcf73});}else logging(_0x5eda22(0x15e));}),_0x3b36b6['on'](_0x32dc33(0xec),(_0x14aa59,_0x39341c)=>{const _0x441d19=_0x32dc33;if(validateAccess(_0x39341c,_0xcf62f9)[_0x441d19(0x9e)]){if(pid[_0x533145])pid[_0x533145][_0x441d19(0x1a4)]({'function':'storeHeadless','args':_0x14aa59});}else logging(_0x441d19(0x96));}),_0x3b36b6['on'](_0x32dc33(0x1cd),_0x169683=>{const _0x14c693=_0x32dc33;if(validateAccess(_0x169683,_0xcf62f9)[_0x14c693(0x9e)]){if(pid[_0x533145])pid[_0x533145][_0x14c693(0x1a4)]({'function':_0x14c693(0x1be),'args':null});}else logging(_0x14c693(0xd5));}),_0x3b36b6['on'](_0x32dc33(0xdb),(_0x12b745,_0x2844c8)=>{const _0xe35f03=_0x32dc33;if(validateAccess(_0x2844c8,_0xcf62f9)['allow']){if(pid[_0x533145])pid[_0x533145][_0xe35f03(0x1a4)]({'function':_0xe35f03(0xe8),'args':_0x12b745});}else logging(_0xe35f03(0x10d));}),_0x3b36b6['on']('cancel-loading',_0x506f99=>{const _0x56b91f=_0x32dc33;if(validateAccess(_0x506f99,_0xcf62f9)[_0x56b91f(0x9e)]){if(pid[_0x533145])pid[_0x533145][_0x56b91f(0x1a4)]({'function':_0x56b91f(0xdd),'args':null});}else logging(_0x56b91f(0x1db));}),_0x3b36b6['on']('logout',_0x4f49ae=>{const _0xc39b39=_0x32dc33;if(validateAccess(_0x4f49ae,_0xcf62f9)[_0xc39b39(0x9e)]){if(devices[_0xcf62f9][_0xc39b39(0x1da)])clearTimeout(devices[_0xcf62f9][_0xc39b39(0x1da)]);if(devices[_0xcf62f9][_0xc39b39(0x148)])clearTimeout(devices[_0xcf62f9]['pidExpireLogin']);removeSocketListeners(getClient(_0x3b36b6['id'])[_0xc39b39(0xd8)]),addBlacklist(_0xcf62f9),devices[_0xcf62f9][_0xc39b39(0x1c5)]=null,devices[_0xcf62f9][_0xc39b39(0x95)]=null,devices[_0xcf62f9][_0xc39b39(0xb7)]['token']=null,io['to'](getClient(_0x3b36b6['id'])[_0xc39b39(0xd8)])[_0xc39b39(0x14d)](_0xc39b39(0xf1),{'access':{'allow':![],'reason':_0xc39b39(0x1b7),'token':null}});}else logging(_0xc39b39(0xf5));});}function removeSocketListeners(_0x1ac9c4){const _0x224bc3=_0xb627e7;getClientsWithUuid(_0x1ac9c4)[_0x224bc3(0x16c)](_0x1b6182=>{const _0x212ac5=_0x224bc3;getSocket(_0x1b6182['id'])[_0x212ac5(0x149)]();});}function cleanSettings(){const _0x3ecb97=_0xb627e7;let _0x4115b1=settings;return settings[_0x3ecb97(0xf2)]&&settings[_0x3ecb97(0xf2)]!=''&&(_0x4115b1={..._0x4115b1,'telegramToken':_0x3ecb97(0x1d2)}),settings[_0x3ecb97(0x120)]&&settings[_0x3ecb97(0x120)]!=''&&(_0x4115b1={..._0x4115b1,'bbPassword':_0x3ecb97(0x1d2)}),_0x4115b1;}function updateBB(){const _0x306c93=_0xb627e7;process[_0x306c93(0x1a4)]({'update':!![]});}function startBot(_0x310cfb,_0x54bf27,_0x26f27a){const _0x1a47b8=_0xb627e7;let _0x3a1654=![];const _0x199f27=_0x310cfb[0x0];_0x54bf27={..._0x54bf27,'stdio':[_0x1a47b8(0x86),_0x1a47b8(0x86),_0x1a47b8(0x86),_0x1a47b8(0xe4)]},pid[_0x199f27]=childProcess['fork'](botfile,_0x310cfb,_0x54bf27),pid[_0x199f27]['on'](_0x1a47b8(0x136),_0x364455=>{const _0x21d2a3=_0x1a47b8;switch(Object[_0x21d2a3(0xab)](_0x364455)[0x0]){case'botname':updateBotName(_0x199f27,_0x364455[_0x21d2a3(0x17f)]);break;case _0x21d2a3(0xf1):updateStatus(_0x199f27,_0x364455[_0x21d2a3(0xf1)]);break;case _0x21d2a3(0x88):updateLive(_0x199f27,_0x364455['live']);break;case _0x21d2a3(0xb8):updateLive(_0x199f27,_0x364455[_0x21d2a3(0xb8)]),io['to'](_0x199f27)['emit']('status',{'access':{'allow':![],'reason':_0x21d2a3(0x14f),'token':null}});break;case _0x21d2a3(0xaf):_0x364455[_0x21d2a3(0xaf)]==_0x21d2a3(0x156)&&stopBot(_0x199f27);_0x364455[_0x21d2a3(0xaf)]==_0x21d2a3(0x181)&&toggleBot(_0x199f27,'disabled',_0x21d2a3(0xf3));break;case _0x21d2a3(0x183):sendTelegram(_0x199f27,_0x364455[_0x21d2a3(0x183)]);break;case _0x21d2a3(0xe2):io['to'](_0x199f27)[_0x21d2a3(0x14d)](_0x364455['function'],_0x364455[_0x21d2a3(0xf0)]);break;}}),pid[_0x199f27]['on'](_0x1a47b8(0x1c9),function(_0x5e19af){if(_0x3a1654)return;_0x3a1654=!![],_0x26f27a(_0x5e19af);}),pid[_0x199f27]['on'](_0x1a47b8(0xaa),function(_0x557089){const _0x3b7c6b=_0x1a47b8;if(_0x3a1654)return;_0x3a1654=!![],_0x26f27a(null);const _0x3a5b48=dbConfig[_0x3b7c6b(0x174)](_0x3b7c6b(0xde))[_0x3b7c6b(0x13c)]({'botID':_0x199f27})['value']();_0x3a5b48&&(_0x3a5b48['status']==_0x3b7c6b(0xdc)||_0x3a5b48[_0x3b7c6b(0xf1)]=='new')&&(updateLive(_0x199f27,_0x3b7c6b(0xf3)),logging('restarting\x20Bot\x20'+_0x199f27),startBot([_0x199f27,userID],{'cwd':bbpath},function(_0x1199e1){if(_0x1199e1)logging(_0x1199e1);}));});}function stopBot(_0x324c4f){const _0xcd7e68=_0xb627e7;getClientsWithBotID(_0x324c4f)[_0xcd7e68(0x16c)](_0x2dc46e=>{const _0x11b126=_0xcd7e68;getSocket(_0x2dc46e['id'])[_0x11b126(0x101)](!![]),removeClient(_0x2dc46e['id']);});if(pid[_0x324c4f])pid[_0x324c4f][_0xcd7e68(0x181)]();}function addBot(){const _0x441322=_0xb627e7;let _0x20e82c;for(let _0x11f2d9=0x1;_0x11f2d9<0x3e9;_0x11f2d9++){_0x20e82c=_0x11f2d9['toString']()[_0x441322(0x135)](0x3,'0');let _0x5a9872=config['find'](_0x1002bc=>_0x1002bc[_0x441322(0xbe)]==_0x20e82c);if(!_0x5a9872)break;}if(_0x20e82c==='1000'){logging(_0x441322(0xb0));return;}logging(_0x441322(0x1d4)+_0x20e82c),dbConfig[_0x441322(0x174)](_0x441322(0xde))[_0x441322(0x13d)]({'botID':_0x20e82c,'botname':_0x441322(0x182)+_0x20e82c,'status':'new','live':''})[_0x441322(0x16b)](),startBot([_0x20e82c,userID],{'cwd':bbpath},function(_0x5c1efa){if(_0x5c1efa)logging(_0x5c1efa);}),config=getConfiguration(),io['to']('botmanager')[_0x441322(0x14d)]('bots',config);}function deleteBot(_0x384c2b){const _0x87552d=_0xb627e7;getClientsWithBotID(_0x384c2b)['forEach'](_0x215b21=>{const _0x27f4c4=_0x2bf3;getSocket(_0x215b21['id'])[_0x27f4c4(0x101)](!![]),removeClient(_0x215b21['id']);}),dbConfig[_0x87552d(0x174)]('bots')['remove']({'botID':_0x384c2b})[_0x87552d(0x16b)](),logging(_0x87552d(0xbf)+_0x384c2b),stopBot(_0x384c2b);try{fs[_0x87552d(0xc1)](path['join'](configpath,_0x87552d(0x199)+_0x384c2b+_0x87552d(0x13a))),fs['unlinkSync'](path[_0x87552d(0x129)](configpath,_0x87552d(0x199)+_0x384c2b+_0x87552d(0x1bf))),fs[_0x87552d(0xc1)](path[_0x87552d(0x129)](configpath,_0x87552d(0x199)+_0x384c2b+_0x87552d(0x192))),fs[_0x87552d(0xc1)](path['join'](configpath,_0x87552d(0x199)+_0x384c2b+_0x87552d(0x142)));}catch(_0x49baad){if(_0x49baad)logging(_0x87552d(0xbc),_0x49baad);}config=getConfiguration(),io['to'](_0x87552d(0xce))['emit'](_0x87552d(0xde),config);}function toggleBot(_0x1af868,_0x3641b7,_0x4a2729){const _0x2d1658=_0xb627e7;dbConfig[_0x2d1658(0x174)](_0x2d1658(0xde))['find']({'botID':_0x1af868})[_0x2d1658(0x1ab)]({'status':_0x3641b7})['assign']({'live':_0x4a2729})[_0x2d1658(0x16b)]();if(_0x3641b7==_0x2d1658(0xdc)||_0x3641b7==_0x2d1658(0x11a))logging(_0x2d1658(0xe5)+_0x1af868),startBot([_0x1af868,userID],{'cwd':bbpath},function(_0x21624e){if(_0x21624e)logging(_0x21624e);});else(_0x3641b7==_0x2d1658(0x1a0)||_0x3641b7==_0x2d1658(0x197))&&(logging(_0x2d1658(0x1a3)+_0x1af868),stopBot(_0x1af868));config=getConfiguration(),io['to'](_0x2d1658(0xce))[_0x2d1658(0x14d)](_0x2d1658(0xde),config);}function toggleStatus(_0x53ea7e){const _0x542ff5=_0xb627e7;let _0xd0525=dbConfig[_0x542ff5(0x174)](_0x542ff5(0xde))[_0x542ff5(0x13c)]({'botID':_0x53ea7e})[_0x542ff5(0x102)](),_0x2f6c79;if(_0xd0525[_0x542ff5(0xf1)]===_0x542ff5(0xdc))_0x2f6c79=_0x542ff5(0x1a0);else{if(_0xd0525[_0x542ff5(0xf1)]==='new')_0x2f6c79=_0x542ff5(0x197);else{if(_0xd0525[_0x542ff5(0xf1)]==='new-disabled')_0x2f6c79=_0x542ff5(0x11a);else{if(_0xd0525[_0x542ff5(0xf1)]===_0x542ff5(0x1a0))_0x2f6c79=_0x542ff5(0xdc);}}}return _0x2f6c79;}function updateStatus(_0xa9c881,_0x38c1a4){const _0x544e9a=_0xb627e7;dbConfig[_0x544e9a(0x174)]('bots')[_0x544e9a(0x13c)]({'botID':_0xa9c881})[_0x544e9a(0x1ab)]({'status':_0x38c1a4})[_0x544e9a(0x16b)](),config=getConfiguration(),io['to'](_0x544e9a(0xce))['emit'](_0x544e9a(0xde),config);}function updateLive(_0x54505b,_0x27c0db){const _0x82539=_0xb627e7;dbConfig[_0x82539(0x174)](_0x82539(0xde))['find']({'botID':_0x54505b})[_0x82539(0x1ab)]({'live':_0x27c0db})[_0x82539(0x16b)](),config=getConfiguration(),io['to']('botmanager')[_0x82539(0x14d)](_0x82539(0xde),config);}function updateBotName(_0x38cdc3,_0x329288){const _0xf8e519=_0xb627e7;dbConfig[_0xf8e519(0x174)](_0xf8e519(0xde))[_0xf8e519(0x13c)]({'botID':_0x38cdc3})['assign']({'botname':_0x329288})[_0xf8e519(0x16b)](),config=getConfiguration(),io['to'](_0xf8e519(0xce))['emit'](_0xf8e519(0xde),config);}function telegramError(_0x25e920){const _0x568c26=_0xb627e7;console['log'](getTimeStamp()+_0x568c26(0xee));}function validateTelegram(_0x1568a9){const _0x172204=_0xb627e7;if(_0x1568a9[_0x172204(0xc4)][_0x172204(0xc6)]!=settings[_0x172204(0x139)]&&'@'+_0x1568a9[_0x172204(0xc4)]['username']!=settings[_0x172204(0x139)])return tgBot[_0x172204(0xfd)](_0x1568a9[_0x172204(0x167)]['id'],_0x172204(0x19d),{'parse_mode':_0x172204(0x162)})[_0x172204(0x11c)](_0x52a143=>{telegramError(_0x52a143);}),![];return!![];}async function initTelegram(){const _0x166213=_0xb627e7;if(tgBot)tgBot[_0x166213(0x173)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x5b2f01='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x5b2f01+='\x0a',_0x5b2f01+=_0x166213(0x91),_0x5b2f01+='/disable\x20-\x20disable\x20notifications\x0a',_0x5b2f01+=_0x166213(0xfc),_0x5b2f01+=_0x166213(0x1a9),_0x5b2f01+=_0x166213(0x15c),_0x5b2f01+=_0x166213(0xc7),_0x5b2f01+=_0x166213(0x10f),_0x5b2f01+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x14d6e8=_0x166213(0x1ac);_0x14d6e8+='\x0a',_0x14d6e8+=_0x5b2f01,tgBot[_0x166213(0xa8)](/\/start/,_0x5dd6f4=>{const _0x2c7f61=_0x166213;if(!validateTelegram(_0x5dd6f4))return;if(settings['telegramChatId']!=_0x5dd6f4[_0x2c7f61(0x167)]['id'])updateSetting(_0x2c7f61(0x1a5),_0x5dd6f4[_0x2c7f61(0x167)]['id']);updateSetting(_0x2c7f61(0xda),!![]),tgBot[_0x2c7f61(0xfd)](_0x5dd6f4[_0x2c7f61(0x167)]['id'],_0x14d6e8)['catch'](_0x3dccd3=>{telegramError(_0x3dccd3);});}),tgBot[_0x166213(0xa8)](/\/enable/,_0x43eeb1=>{const _0x4c3083=_0x166213;if(!validateTelegram(_0x43eeb1))return;if(settings[_0x4c3083(0x1a5)]!=_0x43eeb1['chat']['id'])updateSetting(_0x4c3083(0x1a5),_0x43eeb1[_0x4c3083(0x167)]['id']);updateSetting(_0x4c3083(0xda),!![]),tgBot[_0x4c3083(0xfd)](_0x43eeb1[_0x4c3083(0x167)]['id'],_0x4c3083(0xc8))[_0x4c3083(0x11c)](_0x14f762=>{telegramError(_0x14f762);});}),tgBot['onText'](/\/config/,async _0x56f29a=>{const _0x1b2619=_0x166213;if(!validateTelegram(_0x56f29a))return;tgBot['removeListener']('callback_query'),tgBot['sendMessage'](_0x56f29a[_0x1b2619(0x167)]['id'],_0x1b2619(0x151),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':'orders'},{'text':_0x1b2619(0x1bb),'callback_data':_0x1b2619(0x9a)},{'text':_0x1b2619(0x8c),'callback_data':_0x1b2619(0x160)}]]}})[_0x1b2619(0x11c)](_0x49d20c=>{telegramError(_0x49d20c);}),tgBot['on']('callback_query',async _0x5d58c3=>{const _0x56b8c5=_0x1b2619,_0x1dd1c9=_0x5d58c3[_0x56b8c5(0xb9)],_0x3ca368=_0x5d58c3[_0x56b8c5(0x136)];tgBot['answerCallbackQuery'](_0x5d58c3['id'])['then'](async()=>{const _0x268bd2=_0x56b8c5;_0x1dd1c9=='orders'&&(updateSetting(_0x268bd2(0x94),_0x268bd2(0x12c)),updateSetting(_0x268bd2(0xda),!![]),await tgBot['sendMessage'](_0x3ca368['chat']['id'],_0x268bd2(0x1ce))[_0x268bd2(0x11c)](_0x47e090=>{telegramError(_0x47e090);}));_0x1dd1c9==_0x268bd2(0x9a)&&(updateSetting(_0x268bd2(0x94),'alerts'),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x3ca368[_0x268bd2(0x167)]['id'],_0x268bd2(0x9b))[_0x268bd2(0x11c)](_0x412b46=>{telegramError(_0x412b46);}));_0x1dd1c9==_0x268bd2(0x160)&&(updateSetting('telegramEvents','all'),updateSetting(_0x268bd2(0xda),!![]),await tgBot['sendMessage'](_0x3ca368[_0x268bd2(0x167)]['id'],_0x268bd2(0x19a))[_0x268bd2(0x11c)](_0x4427a2=>{telegramError(_0x4427a2);}));if(!settings['telegramChatId'])tgBot[_0x268bd2(0xfd)](_0x3ca368[_0x268bd2(0x167)]['id'],_0x268bd2(0x155))[_0x268bd2(0x11c)](_0x4619a1=>{telegramError(_0x4619a1);});}),tgBot['removeListener'](_0x56b8c5(0xc3));});}),tgBot[_0x166213(0xa8)](/\/status/,_0x1cc34a=>{const _0x38cd18=_0x166213;if(!validateTelegram(_0x1cc34a))return;let _0x580fa7=_0x38cd18(0x140);config[_0x38cd18(0x16c)](_0x1f86b6=>{const _0x492c62=_0x38cd18;_0x580fa7+=_0x492c62(0x182)+_0x1f86b6['botID']+_0x492c62(0x9d)+_0x1f86b6[_0x492c62(0x17f)]+':\x20'+_0x1f86b6[_0x492c62(0xf1)]+_0x492c62(0x169)+_0x1f86b6[_0x492c62(0x88)]+'\x0a';}),_0x580fa7+='\x0a',_0x580fa7+=_0x38cd18(0xe6),_0x580fa7+=!settings[_0x38cd18(0xda)]?_0x38cd18(0x12a):_0x38cd18(0xac),_0x580fa7+=settings[_0x38cd18(0xda)]?settings['telegramEvents']==_0x38cd18(0x160)?_0x38cd18(0x100):_0x38cd18(0xc5)+settings[_0x38cd18(0x94)]+_0x38cd18(0x15f):'',tgBot[_0x38cd18(0xfd)](_0x1cc34a[_0x38cd18(0x167)]['id'],_0x580fa7,{'parse_mode':'HTML'})['catch'](_0x3fc161=>{telegramError(_0x3fc161);});}),tgBot[_0x166213(0xa8)](/\/restart/,_0x20d18e=>{const _0x4b1721=_0x166213;if(!validateTelegram(_0x20d18e))return;tgBot[_0x4b1721(0x185)](_0x4b1721(0xc3));const _0x4c1fc0=getEnabledBots();if(_0x4c1fc0['length']==0x0)tgBot[_0x4b1721(0xfd)](_0x20d18e['chat']['id'],_0x4b1721(0x8d))['catch'](_0x187d0c=>{telegramError(_0x187d0c);});else{if(_0x4c1fc0[_0x4b1721(0x128)]>0x1)_0x4c1fc0[_0x4b1721(0x13d)]({'botID':'all'});let _0x591fc3=[],_0x15ecfb=[];const _0x3a99fb=_0x4c1fc0[_0x4b1721(0x128)]%0x4==0x0||_0x4c1fc0[_0x4b1721(0x128)]%0x4==0x3||_0x4c1fc0[_0x4b1721(0x128)]%0x3==0x1?0x4:0x3;let _0x192bee=0x0;_0x4c1fc0[_0x4b1721(0x16c)]((_0x4172a,_0x1d9edc)=>{const _0x1932f4=_0x4b1721;if(_0x1d9edc%_0x3a99fb==0x0)_0x15ecfb=[];_0x15ecfb[_0x1932f4(0x13d)]({'text':_0x4172a[_0x1932f4(0xbe)]==_0x1932f4(0x160)?_0x1932f4(0x19e):_0x1932f4(0x182)+_0x4172a[_0x1932f4(0xbe)],'callback_data':_0x4172a['botID']}),_0x1d9edc%_0x3a99fb==0x0&&(_0x591fc3[_0x192bee]=_0x15ecfb,_0x192bee++);}),tgBot[_0x4b1721(0xfd)](_0x20d18e[_0x4b1721(0x167)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x591fc3}})[_0x4b1721(0x11c)](_0x134ce6=>{telegramError(_0x134ce6);}),tgBot['on']('callback_query',async _0x39c3f2=>{const _0x46f3b3=_0x4b1721,_0x402dbf=_0x39c3f2[_0x46f3b3(0xb9)],_0x599018=_0x39c3f2[_0x46f3b3(0x136)];tgBot[_0x46f3b3(0x1d0)](_0x39c3f2['id'])['then'](async()=>{const _0x25d714=_0x46f3b3;if(_0x402dbf=='all'){if(settings[_0x25d714(0x94)]==_0x25d714(0x12c))tgBot[_0x25d714(0xfd)](_0x599018[_0x25d714(0x167)]['id'],_0x25d714(0x1d6))['catch'](_0x5d6508=>{telegramError(_0x5d6508);});config['forEach'](_0x2b49bd=>{const _0x58f341=_0x25d714;stopBot(_0x2b49bd[_0x58f341(0xbe)]);});}else{if(settings[_0x25d714(0x94)]==_0x25d714(0x12c))tgBot[_0x25d714(0xfd)](_0x599018['chat']['id'],'Bot\x20Mgr\x20>\x20restarting\x20Bot\x20'+_0x402dbf)[_0x25d714(0x11c)](_0x325374=>{telegramError(_0x325374);});stopBot(_0x402dbf);}}),tgBot['removeListener'](_0x46f3b3(0xc3));});}}),tgBot['onText'](/\/on/,_0x57745e=>{const _0x1d23d5=_0x166213;if(!validateTelegram(_0x57745e))return;tgBot[_0x1d23d5(0x185)](_0x1d23d5(0xc3));const _0x1490fd=getDisabledBots();if(_0x1490fd[_0x1d23d5(0x128)]==0x0)tgBot['sendMessage'](_0x57745e[_0x1d23d5(0x167)]['id'],_0x1d23d5(0x159))[_0x1d23d5(0x11c)](_0x55c692=>{telegramError(_0x55c692);});else{if(_0x1490fd['length']>0x1)_0x1490fd[_0x1d23d5(0x13d)]({'botID':_0x1d23d5(0x160)});let _0xe7007c=[],_0x3cb743=[];const _0x23d228=_0x1490fd[_0x1d23d5(0x128)]%0x4==0x0||_0x1490fd['length']%0x4==0x3||_0x1490fd[_0x1d23d5(0x128)]%0x3==0x1?0x4:0x3;let _0x2bed2d=0x0;_0x1490fd[_0x1d23d5(0x16c)]((_0x1d175a,_0x374edc)=>{const _0x530d28=_0x1d23d5;if(_0x374edc%_0x23d228==0x0)_0x3cb743=[];_0x3cb743[_0x530d28(0x13d)]({'text':_0x1d175a['botID']==_0x530d28(0x160)?'All\x20bots':'Bot\x20'+_0x1d175a['botID'],'callback_data':_0x1d175a[_0x530d28(0xbe)]}),_0x374edc%_0x23d228==0x0&&(_0xe7007c[_0x2bed2d]=_0x3cb743,_0x2bed2d++);}),tgBot[_0x1d23d5(0xfd)](_0x57745e['chat']['id'],_0x1d23d5(0x1d9),{'reply_markup':{'inline_keyboard':_0xe7007c}})['catch'](_0x5da826=>{telegramError(_0x5da826);}),tgBot['on'](_0x1d23d5(0xc3),async _0x5f4ac8=>{const _0x4c70d5=_0x1d23d5,_0x26a8ff=_0x5f4ac8[_0x4c70d5(0xb9)],_0x885e8a=_0x5f4ac8[_0x4c70d5(0x136)];tgBot[_0x4c70d5(0x1d0)](_0x5f4ac8['id'])[_0x4c70d5(0x1c1)](async()=>{const _0xbefee6=_0x4c70d5;if(_0x26a8ff=='all'){if(settings['telegramEvents']==_0xbefee6(0x12c))tgBot[_0xbefee6(0xfd)](_0x885e8a[_0xbefee6(0x167)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0xbefee6(0x11c)](_0x47c0d9=>{telegramError(_0x47c0d9);});_0x1490fd[_0xbefee6(0x16c)](_0x8dc24c=>{const _0x42fa06=_0xbefee6;if(_0x8dc24c[_0x42fa06(0xbe)]!=_0x42fa06(0x160))toggleBot(_0x8dc24c[_0x42fa06(0xbe)],toggleStatus(_0x8dc24c[_0x42fa06(0xbe)]),_0x42fa06(0xf3));});}else{if(settings[_0xbefee6(0x94)]=='orders')tgBot[_0xbefee6(0xfd)](_0x885e8a[_0xbefee6(0x167)]['id'],_0xbefee6(0x132)+_0x26a8ff)[_0xbefee6(0x11c)](_0x3c6f41=>{telegramError(_0x3c6f41);});toggleBot(_0x26a8ff,toggleStatus(_0x26a8ff),_0xbefee6(0xf3));}}),tgBot[_0x4c70d5(0x185)](_0x4c70d5(0xc3));});}}),tgBot['onText'](/\/off/,_0x3d7410=>{const _0x23bd23=_0x166213;if(!validateTelegram(_0x3d7410))return;tgBot['removeListener'](_0x23bd23(0xc3));const _0x418b21=getEnabledBots();if(_0x418b21[_0x23bd23(0x128)]==0x0)tgBot[_0x23bd23(0xfd)](_0x3d7410[_0x23bd23(0x167)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x23bd23(0x11c)](_0x51c1fb=>{telegramError(_0x51c1fb);});else{if(_0x418b21['length']>0x1)_0x418b21[_0x23bd23(0x13d)]({'botID':_0x23bd23(0x160)});let _0x2a9e12=[],_0x2dc07a=[];const _0x17ddff=_0x418b21[_0x23bd23(0x128)]%0x4==0x0||_0x418b21['length']%0x4==0x3||_0x418b21[_0x23bd23(0x128)]%0x3==0x1?0x4:0x3;let _0x871360=0x0;_0x418b21['forEach']((_0x565e8c,_0x40e876)=>{const _0x29e776=_0x23bd23;if(_0x40e876%_0x17ddff==0x0)_0x2dc07a=[];_0x2dc07a[_0x29e776(0x13d)]({'text':_0x565e8c['botID']==_0x29e776(0x160)?_0x29e776(0x19e):_0x29e776(0x182)+_0x565e8c[_0x29e776(0xbe)],'callback_data':_0x565e8c[_0x29e776(0xbe)]}),_0x40e876%_0x17ddff==0x0&&(_0x2a9e12[_0x871360]=_0x2dc07a,_0x871360++);}),tgBot[_0x23bd23(0xfd)](_0x3d7410[_0x23bd23(0x167)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x2a9e12}})[_0x23bd23(0x11c)](_0x5cd059=>{telegramError(_0x5cd059);}),tgBot['on'](_0x23bd23(0xc3),async _0x258912=>{const _0x359462=_0x23bd23,_0x496fe7=_0x258912[_0x359462(0xb9)],_0x44c021=_0x258912[_0x359462(0x136)];tgBot[_0x359462(0x1d0)](_0x258912['id'])[_0x359462(0x1c1)](async()=>{const _0x545b37=_0x359462;if(_0x496fe7==_0x545b37(0x160)){if(settings[_0x545b37(0x94)]=='orders')tgBot['sendMessage'](_0x44c021[_0x545b37(0x167)]['id'],_0x545b37(0x196))[_0x545b37(0x11c)](_0x592021=>{telegramError(_0x592021);});_0x418b21['forEach'](_0x45bf85=>{const _0x5ac5ef=_0x545b37;if(_0x45bf85[_0x5ac5ef(0xbe)]!=_0x5ac5ef(0x160))toggleBot(_0x45bf85[_0x5ac5ef(0xbe)],toggleStatus(_0x45bf85['botID']),_0x5ac5ef(0xf3));});}else{if(settings[_0x545b37(0x94)]==_0x545b37(0x12c))tgBot[_0x545b37(0xfd)](_0x44c021[_0x545b37(0x167)]['id'],_0x545b37(0xa0)+_0x496fe7)[_0x545b37(0x11c)](_0x13e54c=>{telegramError(_0x13e54c);});toggleBot(_0x496fe7,toggleStatus(_0x496fe7),'stopped');}}),tgBot[_0x359462(0x185)](_0x359462(0xc3));});}}),tgBot[_0x166213(0xa8)](/\/disable/,_0x1f2efb=>{const _0x342f63=_0x166213;if(!validateTelegram(_0x1f2efb))return;tgBot['sendMessage'](_0x1f2efb[_0x342f63(0x167)]['id'],'Notifications\x20disabled')['catch'](_0x2fdce5=>{telegramError(_0x2fdce5);}),updateSetting(_0x342f63(0xda),![]);}),tgBot[_0x166213(0xa8)](/\/help/,_0x335276=>{const _0x2b3652=_0x166213;if(!validateTelegram(_0x335276))return;tgBot[_0x2b3652(0xfd)](_0x335276['chat']['id'],_0x5b2f01)[_0x2b3652(0x11c)](_0x5d030b=>{telegramError(_0x5d030b);});}),tgBot['on']('polling_error',_0x588923=>{const _0x735970=_0x166213;_0x588923[_0x735970(0x116)]()['includes'](_0x735970(0xcb))&&(logging('Invalid\x20Telegram\x20token'),tgBot[_0x735970(0x173)](),tgBot=null,io['to'](_0x735970(0xce))[_0x735970(0x14d)](_0x735970(0x144),_0x735970(0x11d)));}),process[_0x166213(0xfa)](_0x166213(0x12b),()=>{const _0x426397=_0x166213;if(tgBot)tgBot[_0x426397(0x173)]();process[_0x426397(0xaa)](0x1);}),process[_0x166213(0xfa)]('SIGTERM',()=>{const _0x2ba051=_0x166213;if(tgBot)tgBot['stopPolling']();process[_0x2ba051(0xaa)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x1b15c,_0x1f1bef){const _0x284ca5=_0xb627e7;if(settings[_0x284ca5(0xda)]){if(settings[_0x284ca5(0x94)]==_0x284ca5(0x160)||(_0x1f1bef[_0x284ca5(0x157)]==_0x284ca5(0x1c9)||_0x1f1bef['type']==_0x284ca5(0x113))&&settings[_0x284ca5(0x94)]=='alerts'||_0x1f1bef[_0x284ca5(0x157)]==_0x284ca5(0x1dd)&&settings[_0x284ca5(0x94)]==_0x284ca5(0x12c)){if(tgBot&&settings[_0x284ca5(0x1a5)]){if(_0x1f1bef['showname'])tgBot['sendMessage'](settings['telegramChatId'],_0x1f1bef[_0x284ca5(0x17f)]+_0x284ca5(0x14e)+_0x1f1bef[_0x284ca5(0x126)])[_0x284ca5(0x11c)](_0xc49d01=>{telegramError(_0xc49d01);});else tgBot[_0x284ca5(0xfd)](settings['telegramChatId'],_0x284ca5(0x182)+_0x1b15c+_0x284ca5(0x14e)+_0x1f1bef[_0x284ca5(0x126)])[_0x284ca5(0x11c)](_0xb2c636=>{telegramError(_0xb2c636);});}}}}function getDeviceWithIp(_0x4ee969){return devices['find'](_0x118b94=>_0x118b94['ip']===_0x4ee969);}function temporaryAccess2FA(_0xef31de,_0x5eb047){const _0x1548d9=_0xb627e7;let _0x3134ca=new Date(),_0x50c99f=![];if(lastIpApproval){if(_0x3134ca-lastIpApproval<0x1388)_0x50c99f=!![];}lastIpApproval=new Date();if(_0x50c99f)return;tgBot&&settings[_0x1548d9(0x1a5)]&&(tgBot['removeListener'](_0x1548d9(0xc3)),tgBot[_0x1548d9(0xfd)](settings[_0x1548d9(0x1a5)],_0x1548d9(0x1d8)+normalizeIP(_0x5eb047)['show']+_0x1548d9(0x1a1),{'parse_mode':_0x1548d9(0x162),'reply_markup':{'inline_keyboard':[[{'text':_0x1548d9(0x141),'callback_data':'5'},{'text':_0x1548d9(0x90),'callback_data':'15'},{'text':_0x1548d9(0x106),'callback_data':'30'},{'text':'reject','callback_data':_0x1548d9(0xe9)}]]}})[_0x1548d9(0x11c)](_0x271be2=>{telegramError(_0x271be2);}),tgBot['on'](_0x1548d9(0xc3),async _0x438983=>{const _0x350e35=_0x1548d9,_0x50f7c6=_0x438983[_0x350e35(0xb9)],_0x2fad55=_0x438983[_0x350e35(0x136)];tgBot[_0x350e35(0x1d0)](_0x438983['id'])[_0x350e35(0x1c1)](async()=>{const _0x391da7=_0x350e35;devices[_0xef31de][_0x391da7(0x1c5)]={'clientip':_0x5eb047,'timestamp':new Date()[_0x391da7(0x119)](),'expiry':_0x50f7c6},_0x50f7c6!=_0x391da7(0xe9)?(await tgBot[_0x391da7(0xfd)](_0x2fad55['chat']['id'],_0x391da7(0x1a2)+_0x50f7c6+_0x391da7(0x133),{'parse_mode':_0x391da7(0x162)})[_0x391da7(0x11c)](_0xd7db8=>{telegramError(_0xd7db8);}),io['to'](_0xef31de)[_0x391da7(0x14d)]('status',{'access':{'allow':![],'reason':_0x391da7(0x14f),'token':null}})):(await tgBot[_0x391da7(0xfd)](_0x2fad55[_0x391da7(0x167)]['id'],_0x391da7(0x150))[_0x391da7(0x11c)](_0x51c8b5=>{telegramError(_0x51c8b5);}),io['to'](_0xef31de)[_0x391da7(0x14d)]('status',{'access':{'allow':![],'reason':_0x391da7(0x137),'token':null}}));}),tgBot[_0x350e35(0x185)](_0x350e35(0xc3));}));}function loginAccess2FA(_0x315142,_0x5dbdca){const _0x54a5b8=_0xb627e7;tgBot&&settings[_0x54a5b8(0x1a5)]&&(tgBot[_0x54a5b8(0x185)]('callback_query'),tgBot[_0x54a5b8(0xfd)](settings[_0x54a5b8(0x1a5)],_0x54a5b8(0x97)+normalizeIP(_0x5dbdca)[_0x54a5b8(0xcd)]+_0x54a5b8(0x1a1),{'parse_mode':_0x54a5b8(0x162),'reply_markup':{'inline_keyboard':[[{'text':_0x54a5b8(0x122),'callback_data':loginExpiry},{'text':_0x54a5b8(0xe9),'callback_data':_0x54a5b8(0xe9)}]]}})[_0x54a5b8(0x11c)](_0x3df88b=>{telegramError(_0x3df88b);}),tgBot['on']('callback_query',async _0x51cd3d=>{const _0x2bc931=_0x54a5b8,_0x5abb0a=_0x51cd3d['data'],_0x234a1b=_0x51cd3d[_0x2bc931(0x136)];tgBot[_0x2bc931(0x1d0)](_0x51cd3d['id'])[_0x2bc931(0x1c1)](async()=>{const _0x184495=_0x2bc931;devices[_0x315142][_0x184495(0x95)]={'clientip':_0x5dbdca,'timestamp':new Date()['getTime'](),'expiry':_0x5abb0a},_0x5abb0a!=_0x184495(0xe9)?(await tgBot['sendMessage'](_0x234a1b['chat']['id'],_0x184495(0x12d),{'parse_mode':_0x184495(0x162)})[_0x184495(0x11c)](_0x5efb01=>{telegramError(_0x5efb01);}),io['to'](_0x315142)[_0x184495(0x14d)](_0x184495(0xf1),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x184495(0xfd)](_0x234a1b['chat']['id'],'Login\x20rejected')['catch'](_0xce5b48=>{telegramError(_0xce5b48);}),io['to'](_0x315142)[_0x184495(0x14d)](_0x184495(0xf1),{'access':{'allow':![],'reason':_0x184495(0x198),'token':null}}));}),tgBot[_0x2bc931(0x185)](_0x2bc931(0xc3));}));}function getConfiguration(){const _0x35d8e2=_0xb627e7;return dbConfig['get'](_0x35d8e2(0xde))[_0x35d8e2(0x111)](_0x35d8e2(0xbe))[_0x35d8e2(0x102)]()||[];}function getEnabledBots(){const _0x2567e6=_0xb627e7;return dbConfig[_0x2567e6(0x174)]('bots')[_0x2567e6(0x111)](_0x2567e6(0xbe))[_0x2567e6(0x164)]({'status':_0x2567e6(0xdc)})['value']()||[];}function getDisabledBots(){const _0x2fadf1=_0xb627e7;return dbConfig[_0x2fadf1(0x174)](_0x2fadf1(0xde))[_0x2fadf1(0x111)](_0x2fadf1(0xbe))[_0x2fadf1(0x164)]({'status':'disabled'})['value']()||[];}function getSettings(){const _0x5cf65c=_0xb627e7;return dbSettings[_0x5cf65c(0x174)](_0x5cf65c(0x15d))[_0x5cf65c(0x102)]()||{'timeshift':0x0};}function getSecure(){const _0x22976f=_0xb627e7;return dbSecure[_0x22976f(0x174)](_0x22976f(0x115))['value']()||{};}function getBlacklist(){const _0x4dad53=_0xb627e7;return dbSecure[_0x4dad53(0x174)](_0x4dad53(0x12f))['value']()||[];}function broadcastToBots(_0x4b1f64,_0x405fb7){config['forEach'](_0x575e7d=>{const _0x41860d=_0x2bf3;if(_0x575e7d[_0x41860d(0xf1)]==_0x41860d(0xdc)&&_0x575e7d[_0x41860d(0x88)]==_0x41860d(0x1aa)){if(pid[_0x575e7d[_0x41860d(0xbe)]])pid[_0x575e7d['botID']][_0x41860d(0x1a4)]({[_0x4b1f64]:_0x405fb7});}});}function storeSettings(_0x18f801,_0x5e2357=![]){const _0x2f4be3=_0xb627e7;_0x18f801={...settings,..._0x18f801};if(_0x5e2357&&_0x18f801[_0x2f4be3(0x120)]!='************'&&_0x18f801[_0x2f4be3(0x120)]!=''){const _0xdec84e=crypt[_0x2f4be3(0xa4)](secure['privateKey'],_0x18f801[_0x2f4be3(0x120)])[_0x2f4be3(0x136)][_0x2f4be3(0xb6)]('@')[0x0],_0x2e12fd=bcrypt[_0x2f4be3(0x87)](_0xdec84e,saltRounds);_0x18f801={..._0x18f801,'bbPassword':_0x2e12fd};}if(_0x5e2357&&_0x18f801[_0x2f4be3(0xf2)]!='************'&&_0x18f801['telegramToken']!=''){const _0x47cb98=crypt[_0x2f4be3(0xa4)](secure['privateKey'],_0x18f801['telegramToken'])[_0x2f4be3(0x136)][_0x2f4be3(0xb6)]('@')[0x0];_0x18f801={..._0x18f801,'telegramToken':_0x47cb98};}const _0x51035d=_0x18f801['telegramToken']!='************'&&_0x18f801[_0x2f4be3(0xf2)]!=settings[_0x2f4be3(0xf2)]||_0x18f801['telegramUsername']!=settings[_0x2f4be3(0x139)],_0x240881=_0x18f801[_0x2f4be3(0xf2)]==''||_0x18f801[_0x2f4be3(0x139)]=='';if(_0x51035d)_0x18f801[_0x2f4be3(0x94)]=_0x2f4be3(0x160);for(const [_0x20a4c8,_0x3734a1]of Object[_0x2f4be3(0xd0)](_0x18f801)){if(_0x20a4c8==_0x2f4be3(0xf2)&&_0x3734a1==_0x2f4be3(0x1d2)){_0x18f801[_0x2f4be3(0xf2)]=settings[_0x2f4be3(0xf2)];continue;};if(_0x20a4c8==_0x2f4be3(0x120)&&_0x3734a1==_0x2f4be3(0x1d2)){_0x18f801[_0x2f4be3(0x120)]=settings[_0x2f4be3(0x120)];continue;};dbSettings[_0x2f4be3(0x8f)]('settings.'+_0x20a4c8,_0x3734a1)[_0x2f4be3(0x16b)]();}settings=_0x18f801,io['to'](_0x2f4be3(0xce))['emit'](_0x2f4be3(0x15d),cleanSettings()),broadcastToBots('timeshift',settings[_0x2f4be3(0x1a8)]);if(_0x51035d&&!_0x240881)initTelegram();if(_0x51035d&&_0x240881)disableTelegram();getAllClients()[_0x2f4be3(0x16c)](_0x360031=>{const _0x2054f1=_0x2f4be3;getSocket(_0x360031['id'])[_0x2054f1(0x14d)](_0x2054f1(0xf1),{'access':{'allow':![],'reason':_0x2054f1(0x14f),'token':null}});});}function updateSetting(_0x1f68d9,_0x3fbf73){const _0xed580d=_0xb627e7;dbSettings['set'](_0xed580d(0x191)+_0x1f68d9,_0x3fbf73)[_0xed580d(0x16b)](),settings=getSettings(),io['to']('botmanager')[_0xed580d(0x14d)](_0xed580d(0x15d),cleanSettings());}function storeSecure(_0x3e0e5c){const _0x4c5fe3=_0xb627e7;dbSecure[_0x4c5fe3(0x174)]('secure')['push'](_0x3e0e5c)[_0x4c5fe3(0x16b)](),secure=_0x3e0e5c;}function addBlacklist(_0x56cbdd){const _0x594476=_0xb627e7;cleanBlacklist();let _0x13f2bd;devices[_0x56cbdd]['telegramIpApproval']?_0x13f2bd=Math[_0x594476(0x1b0)](devices[_0x56cbdd]['telegramIpApproval'][_0x594476(0x175)],loginExpiry):_0x13f2bd=loginExpiry,dbSecure[_0x594476(0x174)](_0x594476(0x12f))['push']({'expiry':new Date()[_0x594476(0x119)]()+_0x13f2bd*0x3c*0x3e8,'token':devices[_0x56cbdd][_0x594476(0xb7)][_0x594476(0xca)]})[_0x594476(0x16b)](),blacklist=dbSecure[_0x594476(0x174)](_0x594476(0x12f))[_0x594476(0x102)]();}function cleanBlacklist(){const _0x44a383=_0xb627e7;let _0x3e429c=dbSecure[_0x44a383(0x174)](_0x44a383(0x12f))[_0x44a383(0x16f)]()[_0x44a383(0x102)](),_0x5c1543=new Date()[_0x44a383(0x119)]();_0x3e429c[_0x44a383(0x16c)](_0x1202c6=>{const _0x1bff35=_0x44a383;_0x1202c6[_0x1bff35(0x175)]<_0x5c1543&&dbSecure[_0x1bff35(0x174)]('blacklist')[_0x1bff35(0x1b3)]({'expiry':_0x1202c6[_0x1bff35(0x175)]})[_0x1bff35(0x16b)]();});}function initStates(){const _0x196420=_0xb627e7;let _0x150ad3=getConfiguration();_0x150ad3[_0x196420(0x16c)](_0x5b3f82=>{const _0x1a7cf3=_0x196420;_0x5b3f82[_0x1a7cf3(0x88)]=_0x1a7cf3(0xf3);}),storeConfiguration(_0x150ad3);}function onKeys(){const _0x2eb0e3=new RSA();return new Promise(_0x1f455c=>{const _0x50a365=_0x2bf3;_0x2eb0e3[_0x50a365(0x168)]()[_0x50a365(0x1c1)](_0x42a572=>{_0x1f455c(_0x42a572);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x58dae1=_0xb627e7;let _0xf2f6b7=getConfiguration(),_0x707073=![];_0xf2f6b7[_0x58dae1(0x16c)](_0x2ccbd5=>{const _0x598893=_0x58dae1;if(_0x2ccbd5[_0x598893(0xf1)]==_0x598893(0x1aa))_0x2ccbd5['status']=_0x598893(0xdc),_0x707073=!![];else _0x2ccbd5[_0x598893(0xf1)]=='stopped'&&(_0x2ccbd5[_0x598893(0xf1)]=_0x598893(0x1a0),_0x707073=!![]);});if(_0x707073)storeConfiguration(_0xf2f6b7);let _0x470cc0=getSecure();if(!_0x470cc0[_0x58dae1(0xfb)]('secret')){let _0xa85a36=await generateKeys();_0x470cc0[_0x58dae1(0x153)]=_0xa85a36[_0x58dae1(0x153)],_0x470cc0[_0x58dae1(0xba)]=_0xa85a36[_0x58dae1(0xba)],_0x470cc0['secret']=crypto[_0x58dae1(0x193)](0x20)['toString'](_0x58dae1(0x17a));;storeSecure(_0x470cc0);}let _0x451cf3=getSettings();_0x707073=![];!_0x451cf3[_0x58dae1(0xfb)](_0x58dae1(0xbd))&&(_0x451cf3[_0x58dae1(0xbd)]=![],_0x451cf3[_0x58dae1(0x112)]='',_0x451cf3[_0x58dae1(0x120)]='',_0x451cf3[_0x58dae1(0x13f)]=![],_0x707073=!![]);!_0x451cf3['hasOwnProperty'](_0x58dae1(0xb3))&&(_0x451cf3[_0x58dae1(0xb3)]=![],_0x451cf3[_0x58dae1(0xd9)]=[],_0x451cf3['temporaryAccessAllowed']=![],_0x707073=!![]);if(!_0x451cf3['hasOwnProperty'](_0x58dae1(0xda))){if(_0x451cf3['telegramChatId'])_0x451cf3[_0x58dae1(0xda)]=!![];else _0x451cf3[_0x58dae1(0xda)]=![];_0x707073=!![];}if(_0x707073)storeSettings(_0x451cf3);}function storeConfiguration(_0x2cbd71){const _0x37865b=_0xb627e7;dbConfig['get'](_0x37865b(0xde))['remove']()[_0x37865b(0x16b)](),dbConfig[_0x37865b(0x174)](_0x37865b(0xde))[_0x37865b(0x13d)](..._0x2cbd71)['write'](),config=_0x2cbd71;}function resetPassword(){const _0x3ec28e=_0xb627e7;tgBot&&settings[_0x3ec28e(0x1a5)]&&(tgBot[_0x3ec28e(0x185)](_0x3ec28e(0xc3)),tgBot['sendMessage'](settings[_0x3ec28e(0x1a5)],_0x3ec28e(0x1cb),{'parse_mode':_0x3ec28e(0x162),'reply_markup':{'inline_keyboard':[[{'text':_0x3ec28e(0x16a),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x3ec28e(0x11c)](_0x4774d8=>{telegramError(_0x4774d8);}),tgBot['on']('callback_query',async _0x3ff65a=>{const _0x126a67=_0x3ec28e,_0x1311bb=_0x3ff65a[_0x126a67(0xb9)],_0x124dc3=_0x3ff65a[_0x126a67(0x136)];tgBot['answerCallbackQuery'](_0x3ff65a['id'])[_0x126a67(0x1c1)](async()=>{const _0x50b03e=_0x126a67;if(_0x1311bb!='no'){const _0xcecfe2=0xf,_0x8eaa4d=_0x50b03e(0x1c6),_0x5e388c=Array[_0x50b03e(0xc4)](crypto[_0x50b03e(0xa6)](new Uint32Array(_0xcecfe2)))['map'](_0x3eedbf=>_0x8eaa4d[_0x3eedbf%_0x8eaa4d['length']])[_0x50b03e(0x129)](''),_0x1f9aee=bcrypt[_0x50b03e(0x87)](_0x5e388c,saltRounds);storeSettings({'bbPassword':_0x1f9aee}),await tgBot[_0x50b03e(0xfd)](_0x124dc3[_0x50b03e(0x167)]['id'],_0x50b03e(0x17b)+_0x5e388c,{'parse_mode':'HTML'})[_0x50b03e(0x11c)](_0x13c20c=>{telegramError(_0x13c20c);});}else await tgBot[_0x50b03e(0xfd)](_0x124dc3['chat']['id'],'Password\x20reset\x20rejected')[_0x50b03e(0x11c)](_0x22e63a=>{telegramError(_0x22e63a);});}),tgBot['removeListener'](_0x126a67(0xc3));}));}function logging(_0x41c104){const _0x10b2b8=_0xb627e7;console[_0x10b2b8(0x15a)](getTimeStamp()+_0x10b2b8(0x9f)+_0x41c104);if(tgBot&&settings[_0x10b2b8(0x1a5)]&&settings[_0x10b2b8(0x94)]!=_0x10b2b8(0x12c))tgBot[_0x10b2b8(0xfd)](settings[_0x10b2b8(0x1a5)],_0x10b2b8(0x184)+_0x41c104)['catch'](_0x37b1ab=>{telegramError(_0x37b1ab);});}function getServerTime(){const _0x108afd=_0xb627e7,_0x91d19d=new Date();return _0x91d19d[_0x108afd(0x1c4)]()+'/'+(_0x91d19d[_0x108afd(0x10a)]()+0x1)[_0x108afd(0x116)]()['padStart'](0x2,'0')+'/'+_0x91d19d[_0x108afd(0x93)]()[_0x108afd(0x116)]()[_0x108afd(0x135)](0x2,'0')+'\x20'+_0x91d19d[_0x108afd(0xd7)]()['toString']()['padStart'](0x2,'0')+':'+_0x91d19d[_0x108afd(0x19b)]()['toString']()[_0x108afd(0x135)](0x2,'0')+':'+_0x91d19d['getSeconds']()[_0x108afd(0x116)]()[_0x108afd(0x135)](0x2,'0');}function getTimeStamp(){const _0x2023a4=_0xb627e7,_0x2767e0=shiftedTime();return _0x2767e0['getFullYear']()+'/'+(_0x2767e0[_0x2023a4(0x10a)]()+0x1)[_0x2023a4(0x116)]()['padStart'](0x2,'0')+'/'+_0x2767e0['getDate']()[_0x2023a4(0x116)]()['padStart'](0x2,'0')+'\x20'+_0x2767e0[_0x2023a4(0xd7)]()[_0x2023a4(0x116)]()[_0x2023a4(0x135)](0x2,'0')+':'+_0x2767e0[_0x2023a4(0x19b)]()[_0x2023a4(0x116)]()[_0x2023a4(0x135)](0x2,'0')+':'+_0x2767e0[_0x2023a4(0x1a7)]()[_0x2023a4(0x116)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x3c0514=_0xb627e7,_0x69f596=new Date();let _0x5133c5=_0x69f596;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x5133c5=fns['add'](_0x69f596,{'hours':settings[_0x3c0514(0x1a8)]});return _0x5133c5;}function startScheduler(){let _0x3b28d1=new Date()['getUTCHours']();_0x3b28d1==0x1&&backupConfigFiles();_0x3b28d1==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0xa1d931=_0xb627e7;fs[_0xa1d931(0xd2)](configpath,{'withFileTypes':!![]})[_0xa1d931(0x16c)](_0x1ae69b=>{const _0x3272c7=_0xa1d931;if(!_0x1ae69b[_0x3272c7(0x1c8)]())fs['copyFileSync'](configpath+_0x1ae69b[_0x3272c7(0xd4)],configbackuppath+_0x1ae69b[_0x3272c7(0xd4)]);});}function triggerAnalytics(){const _0x153c78=_0xb627e7;analytics[_0x153c78(0xa1)]({'title':_0x153c78(0xef),'href':_0x153c78(0x104),'path':'/v'+serverversion});}function _0x2bf3(_0x1167e4,_0x48f41c){const _0xd67aa4=_0x3f9f();return _0x2bf3=function(_0x473175,_0x57696c){_0x473175=_0x473175-0x84;let _0x3f9f6c=_0xd67aa4[_0x473175];return _0x3f9f6c;},_0x2bf3(_0x1167e4,_0x48f41c);}function validateCredentials(_0x4368b1,_0x99d447){const _0x17f01b=_0xb627e7;if(_0x4368b1['username']==settings[_0x17f01b(0x112)]&&bcrypt[_0x17f01b(0x18e)](_0x4368b1[_0x17f01b(0x146)],settings[_0x17f01b(0x120)])){if(settings['f2aRequired'])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x5d946c=generateLoginToken(_0x99d447);return{'allow':!![],'reason':_0x17f01b(0xa3),'token':_0x5d946c};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x1b9643){const _0xcca7cf=_0xb627e7,_0x77f59f=generateLoginToken(_0x1b9643);return{'allow':!![],'reason':_0xcca7cf(0xa3),'token':_0x77f59f};}function validateAccess(_0x55b37a,_0x437279){const _0x3d880d=_0xb627e7;let _0x26b0b0=devices[_0x437279]['ip'],_0x11f4f2;const _0xb69969=_0x328b23=>{const _0x3bada4=_0x2bf3;if(settings[_0x3bada4(0xbd)]){if(settings[_0x3bada4(0x13f)]){if(telegram2FaApproved(_0x437279)){const _0xd4c5a1=generateLoginToken(_0x437279);return{'allow':!![],'reason':_0x3bada4(0x18d),'token':_0xd4c5a1};}else return{'allow':![],'reason':_0x3bada4(0x13b),'token':null};}else return _0x11f4f2=validToken(_0x328b23,_0x437279),_0x11f4f2['hasOwnProperty'](_0x3bada4(0x113))?{'allow':!![],'reason':_0x3bada4(0x105),'token':_0x328b23}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x3bada4(0x163),'token':null};};if(settings[_0x3d880d(0xb3)]){let _0x5cd14d=[...settings[_0x3d880d(0xd9)],_0x3d880d(0x18c),_0x3d880d(0xea),_0x3d880d(0x195)];if(_0x5cd14d[_0x3d880d(0x1b8)](_0x26b0b0))return _0xb69969(_0x55b37a);else{_0x11f4f2=validToken(_0x55b37a,_0x437279);if(_0x11f4f2['hasOwnProperty'](_0x3d880d(0x113)))return _0xb69969(_0x55b37a);else{if(telegramIpApproved(_0x437279)){const _0x50e58a=generateToken(_0x437279);return _0x11f4f2=_0xb69969(_0x55b37a),_0x11f4f2[_0x3d880d(0x9e)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x50e58a}:_0x11f4f2;}else return settings[_0x3d880d(0x165)]?{'allow':![],'reason':_0x3d880d(0x1bc),'token':null}:{'allow':![],'reason':_0x3d880d(0xa9),'token':null};}}}else return _0xb69969(_0x55b37a);}function timelyDecrypt(_0xf7e8a9,_0x58bdc0=!![]){const _0x353596=_0xb627e7;if(_0xf7e8a9)try{const _0x54148c=crypt[_0x353596(0xa4)](secure[_0x353596(0xba)],_0xf7e8a9)[_0x353596(0x136)],_0x33c911=_0x54148c[_0x353596(0xb6)]('@')[0x0],_0x3251e6=_0x54148c[_0x353596(0xb6)]('@')[0x1],_0x545300=new Date()[_0x353596(0x119)]();if(_0x58bdc0){if(_0x545300-_0x3251e6<maxSecretAge*0x3e8)return _0x33c911;else return![];}else return _0x33c911;}catch(_0x4c0550){return![];}else return![];}const validToken=(_0x11704e,_0x11316a)=>{const _0x2ace44=_0xb627e7,_0x3e2042=devices[_0x11316a]['ip'];if(!_0x11704e)return{'error':_0x2ace44(0x17d)};for(let _0x1b9cc4 of blacklist){if(_0x1b9cc4[_0x2ace44(0xca)]==_0x11704e)return{'error':_0x2ace44(0x16e)};}let _0x4e7e38;try{_0x4e7e38=jwt['verify'](_0x11704e,secure[_0x2ace44(0x8e)]+_0x11316a);}catch{return{'error':_0x2ace44(0xc2)};}if(!_0x4e7e38['hasOwnProperty']('clientip')&&!_0x4e7e38[_0x2ace44(0xfb)]('username')||!_0x4e7e38['hasOwnProperty'](_0x2ace44(0x1cf)))return{'error':_0x2ace44(0x1b2)};if(!_0x4e7e38[_0x2ace44(0xfb)](_0x2ace44(0xc6))&&_0x4e7e38[_0x2ace44(0xfb)](_0x2ace44(0xcc))){const {clientip:_0x188c84}=_0x4e7e38;return _0x3e2042==_0x188c84?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x2ace44(0x1c2)};}else{if(_0x4e7e38[_0x2ace44(0xfb)](_0x2ace44(0xc6))&&_0x4e7e38[_0x2ace44(0xfb)](_0x2ace44(0xcc))){const {username:_0x5d875b,clientip:_0x467d39}=_0x4e7e38;return settings[_0x2ace44(0x112)]==_0x5d875b&&_0x3e2042==_0x467d39?{'success':_0x2ace44(0xed)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x18cdc8=>{const _0x5c47af=_0xb627e7;if(_0x18cdc8){const _0x556f73=devices[_0x18cdc8]['ip'];return jwt[_0x5c47af(0xf4)]({'username':settings[_0x5c47af(0x112)],'clientip':_0x556f73},secure[_0x5c47af(0x8e)]+_0x18cdc8,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x42f97f=>{const _0x1cca2a=_0xb627e7;if(_0x42f97f){const _0x5a43b0=devices[_0x42f97f]['ip'];return jwt['sign']({'clientip':_0x5a43b0},secure[_0x1cca2a(0x8e)]+_0x42f97f,{'expiresIn':devices[_0x42f97f]['telegramIpApproval'][_0x1cca2a(0x175)]*0x3c});}else return![];},telegramIpApproved=_0x21119c=>{const _0x115071=_0xb627e7;let _0x1f5c2b=![];return devices[_0x21119c]['telegramIpApproval']&&devices[_0x21119c][_0x115071(0x1c5)][_0x115071(0x175)]!=_0x115071(0xe9)&&(_0x1f5c2b=devices[_0x21119c][_0x115071(0x1c5)][_0x115071(0xcc)]==devices[_0x21119c]['ip']&&new Date()[_0x115071(0x119)]()-devices[_0x21119c][_0x115071(0x1c5)]['timestamp']<devices[_0x21119c][_0x115071(0x1c5)][_0x115071(0x175)]*0x3c*0x3e8),_0x1f5c2b;},telegram2FaApproved=_0x511311=>{const _0x16a204=_0xb627e7;let _0x8a6302=![];return devices[_0x511311][_0x16a204(0x95)]&&devices[_0x511311][_0x16a204(0x95)]['expiry']!='reject'&&(_0x8a6302=devices[_0x511311][_0x16a204(0x95)]['clientip']==devices[_0x511311]['ip']&&new Date()[_0x16a204(0x119)]()-devices[_0x511311][_0x16a204(0x95)]['timestamp']<devices[_0x511311][_0x16a204(0x95)][_0x16a204(0x175)]*0x3c*0x3e8),_0x8a6302;},normalizeIP=_0x42ac77=>{const _0x27d2c6=_0xb627e7;let _0x30b884=null,_0x538df4=null;if(ipaddr[_0x27d2c6(0x161)](_0x42ac77)){const _0x5ae49c=ipaddr[_0x27d2c6(0x1b4)](_0x42ac77);_0x5ae49c[_0x27d2c6(0x1cc)]()===_0x27d2c6(0x85)?(_0x5ae49c[_0x27d2c6(0xe1)]()&&(_0x30b884=_0x5ae49c[_0x27d2c6(0x10e)]()[_0x27d2c6(0x116)]()),_0x538df4=_0x5ae49c[_0x27d2c6(0x116)]()):(_0x30b884=_0x5ae49c[_0x27d2c6(0x116)](),_0x538df4=_0x5ae49c[_0x27d2c6(0x107)]()[_0x27d2c6(0x116)]());}return{'show':_0x30b884?_0x30b884:_0x538df4,'store':_0x538df4};};