const _0x385116=_0x24f4;(function(_0x53dbcf,_0x288b85){const _0x2bcb8a=_0x24f4,_0x1840d7=_0x53dbcf();while(!![]){try{const _0x3be993=parseInt(_0x2bcb8a(0x302))/0x1*(-parseInt(_0x2bcb8a(0x353))/0x2)+parseInt(_0x2bcb8a(0x2e7))/0x3+-parseInt(_0x2bcb8a(0x35b))/0x4+parseInt(_0x2bcb8a(0x2ac))/0x5+-parseInt(_0x2bcb8a(0x24b))/0x6*(parseInt(_0x2bcb8a(0x2ec))/0x7)+parseInt(_0x2bcb8a(0x215))/0x8*(parseInt(_0x2bcb8a(0x2a5))/0x9)+parseInt(_0x2bcb8a(0x321))/0xa*(parseInt(_0x2bcb8a(0x23e))/0xb);if(_0x3be993===_0x288b85)break;else _0x1840d7['push'](_0x1840d7['shift']());}catch(_0x11534c){_0x1840d7['push'](_0x1840d7['shift']());}}}(_0x4748,0x38424));const _0x3da4d0=function(){let _0x91ffaf=!![];return function(_0x33fdad,_0x352d82){const _0x264082=_0x91ffaf?function(){const _0x5358b7=_0x24f4;if(_0x352d82){const _0x51f047=_0x352d82[_0x5358b7(0x2fb)](_0x33fdad,arguments);return _0x352d82=null,_0x51f047;}}:function(){};return _0x91ffaf=![],_0x264082;};}(),_0x16f938=_0x3da4d0(this,function(){const _0x4f1c62=_0x24f4;return _0x16f938[_0x4f1c62(0x30c)]()['search']('(((.+)+)+)+$')[_0x4f1c62(0x30c)]()[_0x4f1c62(0x31e)](_0x16f938)[_0x4f1c62(0x39d)]('(((.+)+)+)+$');});_0x16f938();'use strict';process[_0x385116(0x20e)][_0x385116(0x2fa)]=0x1;function _0x4748(){const _0x3cfe41=['\x1b[34m','allow','alias','range','hashSync','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','success','orders','Your\x20installation\x20is\x20already\x20up\x20to\x20date','<b>Balance\x20Bot\x20Status:</b>\x0a','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','#RES#\x20if\x20running\x20locally\x0a','password','get-portfolio','sort','DEFLATE','No\x20bots\x20running\x20right\x20now','get','bot-','isDirectory','bot','-results.json','size','access\x20timeout','::1','api-eu.mixpanel.com','Network\x20Interfaces:','tkn','invalid\x20credentials','request','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Unauthorized\x20login\x20attempt\x20(timeout)','bb-settings.json','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','from','use','settings','Error\x20while\x20deleting\x20config\x20files:\x20','writeFileSync','node-zip','event','copyFileSync','express-fileupload','botmanager','hybrid-crypto-js','/metrics\x20-\x20show\x20bot\x20performance\x0a','HTML','logs/','backupfile','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Deleted\x20Bot\x20','resetHistory','Starting\x20Balance\x20Bot\x20','Unauthorized\x20attempt\x20to\x20add\x20bot','add-bot','callback_query','onText','</b>\x20?','-events.json','mtime','http','login','download','removeListener','post','replace','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','live','Starting\x20Balance\x20Bot\x20update','-config.json','<b>Telegram\x20Bot\x20Status:</b>\x0a','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','180cIqvxc','bb/','warning','Markdown','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','emitHistory','join','569195yNQcEc','backup-files','Unauthorized\x20attempt\x20to\x20log\x20out','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','login\x20not\x20required','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','/:bot/configuration','Notifications\x20disabled','sortBy','headers','version.json','forEach','update-bot','getTime','2FA\x20login\x20token\x20generated','You\x20can\x20use\x20the\x20following\x20commands:\x0a','1000','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','private','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','backup-full.zip','restart','static','max','readdirSync','/upload-backup','accept','toggle-bot-mode','versions','username','Unauthorized\x20attempt\x20to\x20update\x20settings','\x20|\x20client:\x20...','push','Disabled\x20Bot\x20','telegramEnabled','2FA\x20required','Setting\x20access:\x20','5\x20min','generate','status','telegramChatId','Error:\x20Invalid\x20argument\x20','listen','Idling\x20bot\x20\x20\x20|\x20Bot\x20','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','send','output-000.log','pidRefreshToken','delete-bot','emit','full','Unauthorized\x20attempt\x20to\x20get\x20messages','privateKey','stringify','Notifications\x20enabled','defaults','bcryptjs',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','245151IcSofP','verify','latestversion','cancel-loading','-----------------------------------------------------------------------------------','881587lGbgXu','catch','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','127.0.0.1','Yes','file','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','SIGTERM','settings.','map','getDate','min','lastmsgemitted','bbvNew','NTBA_FIX_319','apply','readFileSync','Unauthorized\x20attempt\x20to\x20delete\x20bot','simple','store-settings','format','All\x20bots\x20running\x20right\x20now','746HQhzsl','bbUsername','log','\x20only\x0a','::ffff:127.0.0.1','sign','name','Starting\x20Balance\x20Bot\x20reinstallation','2FA\x20login\x20required','bots','toString','logs','conn','bbPassword','messages','sendMessage','loginRequired','initclient','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','hasOwnProperty','slice','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','updatebotmanager','notification','debug','User\x20has\x20been\x20validated','express','Backup\x20file\x20unzipped\x20and\x20stored','constructor','-performance.json','new','3431300OLVxbt','parse','telegram','/off\x20-\x20stop\x20bot(s)\x0a','sha256','manual','Password\x20has\x20been\x20reset\x20to:\x20','apiSecret','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','handshake','publicKey','/names\x20-\x20show\x20bot\x20names\x0a','port','storeConfiguration','reject','alerts','telegrammsg','getUTCHours','login\x20required','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','************','Logged\x20in\x20user\x20...','host','Unauthorized\x20attempt\x20to\x20get\x20portfolio','getStartingBalances','Alerts','reinstall','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','started','backup-full@','restore-backup-file','config/','set','message','assign','get-backup-files','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','bb-secure.json','apiKey','internal','build','index.html','delete-alerts','onepagemode','yes','build2','bb-config.json','store-fiat','logged\x20out','files','1048XRuhCF','exit','graphql-request','RSA','entries','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','botname','218580YugaFg','telegramEvents','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','getHours','reset-history','disabled','createWriteStream','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','init','Restore\x20process\x20aborted','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','binary','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','store-configuration','#RES#\x20if\x20running\x20on\x20server','yargs/yargs','update','\x1b[31m','randomBytes','Bot\x20','Password\x20reset\x20rejected','whitelistEnabled','clientip','Unauthorized\x20attempt\x20to\x20download\x20','/update\x20-\x20update\x20Balance\x20Bot\x0a','=>\x20Go\x20to\x20#BLU#http://','Notifications\x20types:\x20','SIGINT','timestamp','test','isIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20get\x20events','Invalid\x20IP\x20address','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','startsWith','inherit','Starting\x20#RED#Balance\x20Bot\x20v','/download/:type','confirm-message','sendFile','Unauthorized\x20attempt\x20to\x20confirm\x20message','Unauthorized\x20attempt\x20to\x20update\x20bot','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','socket','\x20(1)','write','Notifications\x20enabled\x0a','pidExpireLogin','answerCallbackQuery','[ip-address]','argv','0.0.0','store','All\x20bots','jsonwebtoken','\x1b[0m','Invalid\x20authentication\x20token\x20(2)','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','temporary\x20token\x20generated','Invalid\x20username\x20or\x20IP\x20address','f2aRequired','get-messages','randomFillSync','place-order','Node.js\x20v','secret','search','\x20|\x20','telegramIpApproval','then','telegram2FaApproval','connected','blacklist','rmSync','filter','apiPassword','***','stopPolling','Restoring\x20bot(s)\x20from\x20backup','getFullYear','address','cancelLoading','length','/:bot','connection','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','output-001.log','token','30\x20min','storeHeadless','telegramUsername','unlinkSync','2FA','$1_$2_$3','ipaddr.js','kind','Token\x20blacklisted','statSync','kill','order','user','3000','chat','isValid','Login\x20accepted','uncaughtException','/:bot/performance','toIPv4MappedAddress','sendMetricsTelegram','existsSync','find','backup','temp/','secure','Starting\x20new\x20bot\x20|\x20Bot\x20','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','decrypt','cloneDeep','backup/','No\x20authentication\x20token','mode','split','ipv6','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Login\x20rejected','All','socket.io','*$1*','sendPortfolioTelegram','disconnect','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Enabled\x20Bot\x20','getSeconds','date-fns','showConfig','logout','remoteAddress','Ok,\x20will\x20send\x20alert\x20notifications\x20only','https://api.ipify.org?format=json','env','family','access','function','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','referer','running','105296OymGOG','\x1b[33m','args','data','output-002.log','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','fork','value','reload','node','type','exchange','/:bot/coins','clients','getMonth','Starting\x20bot\x20|\x20Bot\x20','sockets','reason','login\x20token\x20generated','bot.js','getMinutes','enabled','Logged\x20out\x20user\x20...','keys','uuid','Invalid\x20Telegram\x20token','new-disabled','/:bot/support','path','mkdirSync','timeshift','all','title','IPv4','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','headless','6b67f3d61ee94b8f5c80b4affef4c4d9','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','bbvReceive','add','stopped','11PBGvGg','\x20|\x20user:\x20...','\x20>\x20','Orders','show','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','userid','number','404\x20Not\x20Found','telegramToken','expiry','\x20mode','output-003.log','6EmIKgZ','/help\x20-\x20show\x20available\x20commands\x0a','lastmsgtelegram','stop','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','Access\x20enabled\x20for\x20','botID','includes','remove','once','version','crypto','\x20(2)','backup-full','node-telegram-bot-api','.zip','padStart','zip/'];_0x4748=function(){return _0x3cfe41;};return _0x4748();}const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x385116(0x208)),low=require('lowdb'),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x385116(0x231)),crypto=require(_0x385116(0x256)),Crypt=require(_0x385116(0x289))['Crypt'],RSA=require(_0x385116(0x289))[_0x385116(0x356)],bcrypt=require(_0x385116(0x2e5)),jwt=require(_0x385116(0x391)),ipaddr=require(_0x385116(0x3b9)),argv=require(_0x385116(0x36a))(process[_0x385116(0x38d)][_0x385116(0x316)](0x2))[_0x385116(0x38d)],uuidRandom=require('uuid-random'),TelegramBot=require(_0x385116(0x259)),Mixpanel=require('mixpanel'),axios=require('axios'),{GraphQLClient,gql}=require(_0x385116(0x355)),util=require('util'),fileUpload=require(_0x385116(0x287)),{networkInterfaces}=require('os'),PORT=argv[_0x385116(0x32d)]||_0x385116(0x3c0),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x385116(0x304)](_0x385116(0x2d6)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x385116(0x354)](0x1));const HOST=argv[_0x385116(0x337)]||null,userID=argv[_0x385116(0x3bf)]||'',debugging=argv['d']||![],nodeversion=process[_0x385116(0x2c9)][_0x385116(0x21e)];let bbpath=_0x385116(0x2a6),bbpath2='';const botfile=_0x385116(0x228),configfile=_0x385116(0x34f),settingsfile=_0x385116(0x27d),securefile=_0x385116(0x346),maxBackups=0xa;let validInstallation=!![];!fs[_0x385116(0x1f0)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x385116(0x222)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x385116(0x340),configbackuppath=configpath+_0x385116(0x1f9),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x385116(0x28c),zippath=userID?bbpath+_0x385116(0x25c)+userID+'/':bbpath+_0x385116(0x25c),loggerfile=fs[_0x385116(0x361)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x385116(0x1f3);!fs[_0x385116(0x1f0)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x385116(0x1f0)](configbackuppath)&&fs[_0x385116(0x232)](configbackuppath);!fs[_0x385116(0x1f0)](logspath)&&fs[_0x385116(0x232)](logspath);!fs[_0x385116(0x1f0)](zippath)&&fs[_0x385116(0x232)](zippath);!fs[_0x385116(0x1f0)](temppath)&&fs[_0x385116(0x232)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x385116(0x2e4)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x385116(0x2e4)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x385116(0x38e),'onepagemode':![]}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x385116(0x2e4)]({'secure':{},'blacklist':[]})[_0x385116(0x388)]();let crypt=new Crypt({'md':_0x385116(0x325),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x385116(0x363)](_0x385116(0x239),{'host':_0x385116(0x276)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x385116(0x247)]&&settings[_0x385116(0x247)]!=''&&settings['telegramUsername']&&settings[_0x385116(0x3b5)]!='')initTelegram();const parseColor=(_0x3bb2ae,_0x5cdb7c)=>{const _0x40067a=_0x385116,_0xaa5459=/#[A-Z]{3}#/g;!_0x5cdb7c?_0x3bb2ae=_0x3bb2ae[_0x40067a(0x29e)](_0xaa5459,''):(_0x3bb2ae=_0x3bb2ae[_0x40067a(0x29e)](/#BLU#/g,_0x40067a(0x25d)),_0x3bb2ae=_0x3bb2ae[_0x40067a(0x29e)](/#RED#/g,_0x40067a(0x36c)),_0x3bb2ae=_0x3bb2ae[_0x40067a(0x29e)](/#YEL#/g,_0x40067a(0x216)),_0x3bb2ae=_0x3bb2ae[_0x40067a(0x29e)](/#RES#/g,_0x40067a(0x392)));;return _0x3bb2ae;},logger={'screen':_0x2dab24=>{const _0x365cb2=_0x385116;console[_0x365cb2(0x304)](parseColor(_0x2dab24,!![]));},'simple':_0x4006d6=>{const _0x259ebd=_0x385116;console[_0x259ebd(0x304)](parseColor(_0x4006d6,!![])),loggerfile[_0x259ebd(0x388)](util[_0x259ebd(0x300)](parseColor(_0x4006d6,![]))+'\x0a');},'full':async _0x5ef2ba=>{const _0x59826d=_0x385116,_0x2356d9=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x5ef2ba;console[_0x59826d(0x304)](parseColor(_0x2356d9,!![])),loggerfile['write'](util['format'](parseColor(_0x2356d9,![]))+'\x0a');if(tgBot&&settings[_0x59826d(0x2d5)]&&settings['telegramEvents']!=_0x59826d(0x264))await tgBot[_0x59826d(0x311)](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+parseColor(_0x5ef2ba,![]))[_0x59826d(0x2ed)](_0x3d28d3=>{telegramError(_0x3d28d3);});},'debug':async(_0x1b26c5,_0x4868a7='')=>{const _0x3ea0d4=_0x385116,_0x266685=getTimeStamp()+_0x3ea0d4(0x359)+_0x1b26c5;if(debugging)console[_0x3ea0d4(0x304)](parseColor(_0x266685,!![]));loggerfile['write'](util[_0x3ea0d4(0x300)](parseColor(_0x266685,![]))+'\x0a');if(_0x4868a7){if(debugging)console[_0x3ea0d4(0x304)](_0x4868a7);loggerfile[_0x3ea0d4(0x388)](util['format'](_0x4868a7)+'\x0a');}}};process['on'](_0x385116(0x1ec),function(_0x29ba2d){logger['simple'](_0x29ba2d);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x385116(0x2b7))[_0x385116(0x255)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x385116(0x31c)),app=express(),http=require(_0x385116(0x299))['createServer'](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x385116(0x26e)](_0x385116(0x380),async(_0x46de7e,_0x321116)=>{const _0x9f8fb2=_0x385116,_0x46009d=_0x46de7e['params'][_0x9f8fb2(0x21f)],_0x146513=getClientsWithBotID('botmanager'),_0x2f9aee=_0x46de7e[_0x9f8fb2(0x2b6)][_0x9f8fb2(0x22d)],_0x4bd26a=timelyDecrypt(_0x2f9aee,![]),_0x4e32f4=_0x146513[_0x9f8fb2(0x1f1)](_0x2b83ab=>_0x2b83ab[_0x9f8fb2(0x22d)]==_0x4bd26a);if(_0x4e32f4){const _0x4664b2=normalizeIP(_0x46de7e[_0x9f8fb2(0x386)][_0x9f8fb2(0x20b)])[_0x9f8fb2(0x38f)],_0x2189f3=_0x46de7e[_0x9f8fb2(0x2b6)][_0x9f8fb2(0x278)];if(validateAccess(_0x2189f3,_0x4bd26a,_0x4664b2)['allow'])_0x46009d=='backup'&&await backupConfigFiles(),await zipFiles(_0x46009d),_0x321116[_0x9f8fb2(0x29b)](zippath+(_0x46009d+_0x9f8fb2(0x25a)),_0xfffc0c=>{_0xfffc0c&&(logger['full']('Failed\x20to\x20download\x20'+_0x46009d),logger['simple'](_0xfffc0c));});else logger[_0x9f8fb2(0x2df)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x46009d+_0x9f8fb2(0x387));}else logger[_0x9f8fb2(0x2df)](_0x9f8fb2(0x372)+_0x46009d+_0x9f8fb2(0x257));}),app[_0x385116(0x29d)](_0x385116(0x2c6),async(_0x340425,_0xd83573)=>{const _0x39055c=_0x385116,_0x2ca3e8=getClientsWithBotID(_0x39055c(0x288)),_0x4cd3d0=_0x340425[_0x39055c(0x2b6)]['uuid'],_0x5d0e98=timelyDecrypt(_0x4cd3d0,![]),_0x1abae7=_0x2ca3e8[_0x39055c(0x1f1)](_0x59325f=>_0x59325f[_0x39055c(0x22d)]==_0x5d0e98);logger[_0x39055c(0x31a)]('Backup\x20file\x20uploaded');if(_0x1abae7){const _0x4d5313=normalizeIP(_0x340425['socket'][_0x39055c(0x20b)])[_0x39055c(0x38f)],_0x4ee1b2=_0x340425[_0x39055c(0x2b6)][_0x39055c(0x278)];if(validateAccess(_0x4ee1b2,_0x5d0e98,_0x4d5313)[_0x39055c(0x25e)]){if(_0x340425[_0x39055c(0x352)]){const _0x19f07c=_0x340425[_0x39055c(0x352)][_0x39055c(0x28d)];await _0x19f07c['mv'](temppath+_0x19f07c[_0x39055c(0x308)]),_0xd83573[_0x39055c(0x2da)]({'status':!![],'message':'File\x20uploaded'});const _0x300c95=getBotsWithMode();_0x300c95[_0x39055c(0x3ad)]>0x0?confirmRestore(temppath,_0x19f07c[_0x39055c(0x308)]):unzipFile(temppath,_0x19f07c[_0x39055c(0x308)]);}}else logger[_0x39055c(0x2df)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x39055c(0x2df)](_0x39055c(0x267));}),app[_0x385116(0x280)](express[_0x385116(0x2c3)](path[_0x385116(0x2ab)](__dirname,bbpath2,_0x385116(0x34e)))),app[_0x385116(0x280)](express[_0x385116(0x2c3)](path[_0x385116(0x2ab)](__dirname,bbpath2,_0x385116(0x349)))),app[_0x385116(0x26e)]('/',function(_0x40495f,_0x52aea6){const _0x3abab7=_0x385116;_0x52aea6['sendFile'](path['join'](__dirname,bbpath2,_0x3abab7(0x34e),_0x3abab7(0x34a)));}),app[_0x385116(0x26e)](_0x385116(0x3ae),function(_0x24baa1,_0x147cdd){const _0x1f70dc=_0x385116;_0x147cdd[_0x1f70dc(0x382)](path[_0x1f70dc(0x2ab)](__dirname,bbpath2,_0x1f70dc(0x349),_0x1f70dc(0x34a)));}),app[_0x385116(0x26e)]('/:bot/portfolio',(_0x2c6c43,_0x18d780)=>{const _0x5184e9=_0x385116;_0x18d780['sendFile'](path[_0x5184e9(0x2ab)](__dirname,bbpath2,_0x5184e9(0x349),_0x5184e9(0x34a)));}),app['get'](_0x385116(0x1ed),(_0xf6c7fd,_0x3fbd7f)=>{const _0x3b94d6=_0x385116;_0x3fbd7f['sendFile'](path[_0x3b94d6(0x2ab)](__dirname,bbpath2,'build',_0x3b94d6(0x34a)));}),app[_0x385116(0x26e)](_0x385116(0x221),(_0x2e2c4e,_0x3865)=>{const _0x423d34=_0x385116;_0x3865['sendFile'](path[_0x423d34(0x2ab)](__dirname,bbpath2,_0x423d34(0x349),_0x423d34(0x34a)));}),app[_0x385116(0x26e)]('/:bot/history',(_0x4115a9,_0x1a6462)=>{const _0x15912d=_0x385116;_0x1a6462[_0x15912d(0x382)](path[_0x15912d(0x2ab)](__dirname,bbpath2,_0x15912d(0x349),_0x15912d(0x34a)));}),app[_0x385116(0x26e)](_0x385116(0x2b3),(_0x4c7d95,_0x2edad9)=>{const _0x2cb02b=_0x385116;_0x2edad9[_0x2cb02b(0x382)](path[_0x2cb02b(0x2ab)](__dirname,bbpath2,_0x2cb02b(0x349),_0x2cb02b(0x34a)));}),app[_0x385116(0x26e)](_0x385116(0x230),(_0x1f922a,_0x19e12a)=>{const _0x42a546=_0x385116;_0x19e12a[_0x42a546(0x382)](path[_0x42a546(0x2ab)](__dirname,bbpath2,'build','index.html'));});if(HOST)http[_0x385116(0x2d7)](PORT,HOST);else http['listen'](PORT);const io=require(_0x385116(0x201))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x871612=_0x385116;let _0x20af90=_0x871612(0x38c);const _0x2e0ddc=networkInterfaces(),_0x22027f={};for(const _0x5e49b5 of Object[_0x871612(0x22c)](_0x2e0ddc)){for(const _0x388b63 of _0x2e0ddc[_0x5e49b5]){if((_0x388b63[_0x871612(0x20f)]==_0x871612(0x236)||_0x388b63[_0x871612(0x20f)]==0x4)&&!_0x388b63[_0x871612(0x348)]){const _0x48b545=ipaddr['parse'](_0x388b63[_0x871612(0x3ab)])[_0x871612(0x260)]();_0x48b545!=_0x871612(0x2bf)&&(!_0x22027f[_0x5e49b5]&&(_0x22027f[_0x5e49b5]=[]),_0x22027f[_0x5e49b5][_0x871612(0x2cd)](_0x388b63[_0x871612(0x3ab)]),_0x20af90=_0x388b63[_0x871612(0x3ab)]);}}}return{'serverip':_0x20af90,'netinterfaces':_0x22027f};}async function startServer(){const _0x5b56b1=_0x385116,{serverip:_0x346db5,netinterfaces:_0x24dc29}=getServerIP();logger[_0x5b56b1(0x2fe)](''),logger[_0x5b56b1(0x2fe)](_0x5b56b1(0x2eb)),await logger[_0x5b56b1(0x2df)](_0x5b56b1(0x37f)+serverversion+'#RES#\x0a'+('=>\x20Go\x20to\x20#BLU#http://127.0.0.1:'+PORT+_0x5b56b1(0x268))+(_0x5b56b1(0x374)+_0x346db5+':'+PORT+_0x5b56b1(0x369))),logger[_0x5b56b1(0x2fe)](_0x5b56b1(0x2eb));if(config[_0x5b56b1(0x3ad)]!=0x0)for(const _0x244c58 of config){if(_0x244c58[_0x5b56b1(0x2d4)]=='enabled'||_0x244c58['status']=='new')await logger[_0x5b56b1(0x2df)](_0x5b56b1(0x224)+_0x244c58['botID']+'\x20|\x20'+_0x244c58[_0x5b56b1(0x35a)]),startBot([_0x244c58[_0x5b56b1(0x251)],userID],{'cwd':bbpath},function(_0x423ca6){const _0x312f93=_0x5b56b1;if(_0x423ca6)logger[_0x312f93(0x2df)](_0x423ca6);});else(_0x244c58[_0x5b56b1(0x2d4)]==_0x5b56b1(0x360)||_0x244c58[_0x5b56b1(0x2d4)]==_0x5b56b1(0x22f))&&await logger[_0x5b56b1(0x2df)](_0x5b56b1(0x2d8)+_0x244c58[_0x5b56b1(0x251)]+_0x5b56b1(0x39e)+_0x244c58[_0x5b56b1(0x35a)]);}else!newBot&&logger[_0x5b56b1(0x2fe)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x5b56b1(0x2fe)](_0x5b56b1(0x2eb)),logger['simple'](''),await logger[_0x5b56b1(0x31a)](_0x5b56b1(0x39b)+nodeversion),await logger['debug'](_0x5b56b1(0x277),_0x24dc29);}function startSocket(){const _0x3b5635=_0x385116;io['on'](_0x3b5635(0x3af),_0x1606cb=>{const _0x302c65=_0x3b5635;let _0x20d369,_0x2216ec,_0x1f305b,_0x55a2f5,_0x546a20;const _0x2f8d8a=_0x1606cb[_0x302c65(0x32a)]['headers'][_0x302c65(0x213)];_0x2216ec=_0x2f8d8a['match'](/bot[0-9]{3}/);if(_0x2216ec)_0x1f305b=_0x2216ec[0x0]['match'](/[0-9]{3}/);if(_0x1f305b)_0x20d369=_0x1f305b[0x0];else _0x20d369=_0x302c65(0x288);const _0x3b3285=_0x1606cb[_0x302c65(0x32a)]['auth']['encryptedUuid'];if(!_0x3b3285)_0x1606cb[_0x302c65(0x2de)]('status',{'publicKey':secure[_0x302c65(0x32b)]});else{_0x55a2f5=timelyDecrypt(_0x3b3285,![]);if(!_0x55a2f5)_0x1606cb['emit'](_0x302c65(0x2d4),{'publicKey':secure[_0x302c65(0x32b)]});else{_0x546a20=normalizeIP(_0x1606cb[_0x302c65(0x30e)][_0x302c65(0x20b)])['store'];if(!devices[_0x55a2f5])devices[_0x55a2f5]={'uuid':_0x55a2f5,'access':{'token':null}};devices[_0x55a2f5]['ip']=_0x546a20;const _0x3843cf=addClient(_0x1606cb['id'],_0x55a2f5,_0x20d369);setAccess(_0x3843cf),emitMessages(),_0x1606cb['on'](_0x302c65(0x29a),_0x40b88f=>{const _0x3533a6=_0x302c65,_0x515212=timelyDecrypt(_0x40b88f[_0x3533a6(0x269)]);if(_0x515212){_0x40b88f={'username':_0x40b88f['username'],'password':_0x515212},devices[_0x55a2f5][_0x3533a6(0x210)]=validateCredentials(_0x40b88f,_0x55a2f5);if(devices[_0x55a2f5]['access'][_0x3533a6(0x25e)]==![]&&devices[_0x55a2f5]['access']['reason']==_0x3533a6(0x30a))_0x1606cb['emit']('status',{'access':devices[_0x55a2f5][_0x3533a6(0x210)]}),loginAccess2FA(_0x55a2f5,_0x546a20);else{if(devices[_0x55a2f5][_0x3533a6(0x210)][_0x3533a6(0x25e)]==![]&&devices[_0x55a2f5][_0x3533a6(0x210)]['reason']==_0x3533a6(0x279))_0x1606cb[_0x3533a6(0x2de)](_0x3533a6(0x2d4),{'access':devices[_0x55a2f5][_0x3533a6(0x210)]});else devices[_0x55a2f5]['access']['allow']&&devices[_0x55a2f5][_0x3533a6(0x210)][_0x3533a6(0x226)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x55a2f5)['forEach'](_0x4eee89=>{setAccess(_0x4eee89);}),logger[_0x3533a6(0x31a)](_0x3533a6(0x336)+_0x55a2f5[_0x3533a6(0x316)](-0x8)),setTokenRefresh(_0x55a2f5),setSessionTimeout(_0x3533a6(0x29a),_0x55a2f5));}}else logger['full'](_0x3533a6(0x27c));}),_0x1606cb['on']('reset-password',()=>{resetPassword();}),_0x1606cb['on']('disconnect',_0x3c633e=>{removeClient(_0x1606cb['id']);}),_0x20d369=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x40420){const _0x107024=_0x385116;if(_0x40420!='botmanager'&&config[_0x107024(0x347)]!=''){if(pid[_0x40420])pid[_0x40420][_0x107024(0x2da)]({'function':_0x107024(0x313),'args':null});}_0x40420!='botmanager'&&broadcastToBots('bots',JSON['stringify'](config));}function reloadBotManager(){const _0x4a299b=_0x385116;getClientsWithBotID(_0x4a299b(0x288))[_0x4a299b(0x2b8)](_0x576172=>{const _0x5ae0cd=_0x4a299b;getSocket(_0x576172['id'])[_0x5ae0cd(0x2de)](_0x5ae0cd(0x2d4),{'access':{'allow':![],'reason':_0x5ae0cd(0x21d),'token':null}});});}function getSocket(_0x29b073){const _0x34b475=_0x385116;return io[_0x34b475(0x225)][_0x34b475(0x225)]['get'](_0x29b073);}function setAccess(_0x4709cb){const _0x5b528d=_0x385116,_0x42c813=getSocket(_0x4709cb['id']),_0x235064=_0x4709cb[_0x5b528d(0x22d)],_0x49de39=_0x4709cb[_0x5b528d(0x271)];devices[_0x235064][_0x5b528d(0x210)]=validateAccess(devices[_0x235064][_0x5b528d(0x210)][_0x5b528d(0x3b2)],_0x235064),logger[_0x5b528d(0x31a)](_0x5b528d(0x2d1)+devices[_0x235064][_0x5b528d(0x210)][_0x5b528d(0x226)]+_0x5b528d(0x2cc)+_0x4709cb['id'][_0x5b528d(0x316)](-0x8)+_0x5b528d(0x23f)+_0x235064[_0x5b528d(0x316)](-0x8)),_0x42c813[_0x5b528d(0x2ab)](_0x235064);if(devices[_0x235064][_0x5b528d(0x210)][_0x5b528d(0x25e)]){_0x42c813[_0x5b528d(0x2ab)](_0x49de39);if(_0x49de39==_0x5b528d(0x288))initializeSocketBotManager(_0x42c813);else initializeSocketBot(_0x42c813);initClient(_0x49de39);}devices[_0x235064][_0x5b528d(0x210)][_0x5b528d(0x3b2)]&&devices[_0x235064][_0x5b528d(0x210)]['reason']==_0x5b528d(0x395)&&setSessionTimeout(_0x5b528d(0x3b7),_0x235064),devices[_0x235064]['access']['token']&&devices[_0x235064][_0x5b528d(0x210)][_0x5b528d(0x226)]==_0x5b528d(0x2bb)&&setSessionTimeout('login',_0x235064),_0x42c813[_0x5b528d(0x2de)](_0x5b528d(0x2d4),{'status':_0x4709cb['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x235064]['access'],'externalip':devices[_0x235064]['ip'],'publicKey':secure[_0x5b528d(0x32b)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x235064]['access'][_0x5b528d(0x25e)]==![]&&devices[_0x235064][_0x5b528d(0x210)][_0x5b528d(0x226)]==_0x5b528d(0x2d0)&&temporaryAccess2FA(_0x235064,devices[_0x235064]['ip']);}function setSessionTimeout(_0x58c609,_0x389ade){const _0x5762bf=_0x385116;let _0x15b246;if(_0x58c609==_0x5762bf(0x29a))_0x15b246=loginExpiry*0x3c*0x3e8;else _0x15b246=devices[_0x389ade][_0x5762bf(0x39f)][_0x5762bf(0x248)]*0x3c*0x3e8-(new Date()[_0x5762bf(0x2ba)]()-devices[_0x389ade]['telegramIpApproval'][_0x5762bf(0x377)]);if(devices[_0x389ade][_0x5762bf(0x38a)])clearTimeout(devices[_0x389ade][_0x5762bf(0x38a)]);devices[_0x389ade][_0x5762bf(0x38a)]=setTimeout(()=>{const _0x34aef6=_0x5762bf;if(devices[_0x389ade][_0x34aef6(0x2dc)])clearTimeout(devices[_0x389ade][_0x34aef6(0x2dc)]);removeSocketListeners(_0x389ade),addBlacklist(_0x389ade),devices[_0x389ade][_0x34aef6(0x39f)]=null,devices[_0x389ade][_0x34aef6(0x3a1)]=null,devices[_0x389ade][_0x34aef6(0x210)]['token']=null,logger[_0x34aef6(0x31a)]('Session\x20expired\x20for\x20user\x20...'+_0x389ade['slice'](-0x8)),devices[_0x389ade][_0x34aef6(0x210)]=validateAccess(devices[_0x389ade]['access'][_0x34aef6(0x3b2)],_0x389ade),!(devices[_0x389ade][_0x34aef6(0x210)]['allow']&&devices[_0x389ade][_0x34aef6(0x210)][_0x34aef6(0x226)]==_0x34aef6(0x2b0))&&(_0x58c609==_0x34aef6(0x29a)?io['to'](_0x389ade)[_0x34aef6(0x2de)](_0x34aef6(0x2d4),{'access':{'allow':![],'reason':_0x34aef6(0x274),'token':null}}):io['to'](_0x389ade)['emit'](_0x34aef6(0x2d4),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x389ade][_0x34aef6(0x210)]['token']=null;},_0x15b246);}function setTokenRefresh(_0x5b2072){const _0x187ebe=_0x385116;if(devices[_0x5b2072][_0x187ebe(0x2dc)])clearTimeout(devices[_0x5b2072][_0x187ebe(0x2dc)]);devices[_0x5b2072][_0x187ebe(0x2dc)]=setTimeout(()=>{const _0x276d9a=_0x187ebe;getClientsWithUuid(_0x5b2072)[_0x276d9a(0x3ad)]!=0x0?(devices[_0x5b2072]['access']=refreshToken(_0x5b2072),io['to'](_0x5b2072)[_0x276d9a(0x2de)](_0x276d9a(0x2d4),{'status':_0x276d9a(0x3a2),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x5b2072][_0x276d9a(0x210)],'externalip':devices[_0x5b2072]['ip'],'publicKey':secure[_0x276d9a(0x32b)],'validInstallation':validInstallation}),setTokenRefresh(_0x5b2072)):clearTimeout(devices[_0x5b2072][_0x276d9a(0x2dc)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x587724){const _0x9df1a4=_0x385116,_0x5bbd92=getClient(_0x587724['id'])[_0x9df1a4(0x22d)];_0x587724[_0x9df1a4(0x2de)](_0x9df1a4(0x30b),config),_0x587724['emit'](_0x9df1a4(0x281),cleanSettings()),_0x587724['on'](_0x9df1a4(0x293),_0x668abc=>{const _0x379fbf=_0x9df1a4;if(validateAccess(_0x668abc,_0x5bbd92)[_0x379fbf(0x25e)])addBot();else logger[_0x379fbf(0x2df)](_0x379fbf(0x292));}),_0x587724['on'](_0x9df1a4(0x2b9),(_0x4a556a,_0x9a0693)=>{const _0x56ed7d=_0x9df1a4;if(validateAccess(_0x9a0693,_0x5bbd92)['allow'])toggleBot(_0x4a556a[_0x56ed7d(0x251)],_0x4a556a['status'],_0x4a556a[_0x56ed7d(0x2a0)]);else logger[_0x56ed7d(0x2df)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x587724['on'](_0x9df1a4(0x2c8),(_0x5a284e,_0x96eb13)=>{const _0x1739eb=_0x9df1a4;if(validateAccess(_0x96eb13,_0x5bbd92)[_0x1739eb(0x25e)])toggleBotMode(_0x5a284e);else logger['full'](_0x1739eb(0x384));}),_0x587724['on'](_0x9df1a4(0x2dd),(_0x28c9e9,_0x4aaebf)=>{const _0x328e6b=_0x9df1a4;if(validateAccess(_0x4aaebf,_0x5bbd92)[_0x328e6b(0x25e)])deleteBot(_0x28c9e9);else logger['full'](_0x328e6b(0x2fd));}),_0x587724['on'](_0x9df1a4(0x2ff),(_0x152810,_0x236c20)=>{const _0x4c3c61=_0x9df1a4;if(validateAccess(_0x236c20,_0x5bbd92)[_0x4c3c61(0x25e)])storeSettings(_0x152810,!![]);else logger['full'](_0x4c3c61(0x2cb));}),_0x587724['on']('update-bb',_0x2006b5=>{const _0x3ff146=_0x9df1a4;if(validateAccess(_0x2006b5,_0x5bbd92)[_0x3ff146(0x25e)])updateBB('update');else logger[_0x3ff146(0x2df)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x587724['on']('reinstall-bb',_0x7d4e6b=>{const _0x500774=_0x9df1a4;if(validateAccess(_0x7d4e6b,_0x5bbd92)['allow'])updateBB(_0x500774(0x33b));else logger['full'](_0x500774(0x334));}),_0x587724['on'](_0x9df1a4(0x344),_0x5085bb=>{const _0x1531e0=_0x9df1a4;if(validateAccess(_0x5085bb,_0x5bbd92)['allow']){const _0x290854=getClient(_0x587724['id']);if(_0x290854)getBackupFiles(_0x290854[_0x1531e0(0x22d)]);else logger[_0x1531e0(0x2df)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x1531e0(0x2df)](_0x1531e0(0x317));}),_0x587724['on'](_0x9df1a4(0x33f),(_0x459964,_0x37ab25)=>{const _0x273919=_0x9df1a4;if(validateAccess(_0x37ab25,_0x5bbd92)[_0x273919(0x25e)])restoreBackupFile(_0x459964);else logger['full']('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x587724['on'](_0x9df1a4(0x398),_0x1b9e11=>{const _0x495e2b=_0x9df1a4;if(validateAccess(_0x1b9e11,_0x5bbd92)[_0x495e2b(0x25e)])getMessages();else logger[_0x495e2b(0x2df)](_0x495e2b(0x2e0));}),_0x587724['on'](_0x9df1a4(0x381),(_0x262d8e,_0x913204)=>{const _0x4ce1c4=_0x9df1a4;if(validateAccess(_0x913204,_0x5bbd92)[_0x4ce1c4(0x25e)])confirmMessage(_0x262d8e);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x587724['on'](_0x9df1a4(0x20a),_0x5c286b=>{const _0x540f3b=_0x9df1a4;if(validateAccess(_0x5c286b,_0x5bbd92)[_0x540f3b(0x25e)]){if(devices[_0x5bbd92][_0x540f3b(0x2dc)])clearTimeout(devices[_0x5bbd92][_0x540f3b(0x2dc)]);if(devices[_0x5bbd92]['pidExpireLogin'])clearTimeout(devices[_0x5bbd92][_0x540f3b(0x38a)]);removeSocketListeners(getClient(_0x587724['id'])[_0x540f3b(0x22d)]),addBlacklist(_0x5bbd92),devices[_0x5bbd92][_0x540f3b(0x39f)]=null,devices[_0x5bbd92]['telegram2FaApproval']=null,devices[_0x5bbd92][_0x540f3b(0x210)][_0x540f3b(0x3b2)]=null,logger[_0x540f3b(0x31a)](_0x540f3b(0x22b)+_0x5bbd92['slice'](-0x8)),io['to'](getClient(_0x587724['id'])['uuid'])['emit']('status',{'access':{'allow':![],'reason':_0x540f3b(0x351),'token':null}});}else logger[_0x540f3b(0x2df)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x22f273){const _0x33235b=_0x385116,_0x3acff7=getClient(_0x22f273['id'])[_0x33235b(0x271)],_0x9fa44a=getClient(_0x22f273['id'])['uuid'];_0x22f273['on']('get-logs',(_0x284111,_0x5e5978)=>{const _0xab2cf6=_0x33235b;if(validateAccess(_0x5e5978,_0x9fa44a)['allow']){if(pid[_0x3acff7])pid[_0x3acff7][_0xab2cf6(0x2da)]({'function':_0xab2cf6(0x2aa),'args':_0x284111});}else logger[_0xab2cf6(0x2df)](_0xab2cf6(0x37a));}),_0x22f273['on'](_0x33235b(0x34b),(_0x54e0b6,_0x545394)=>{const _0x1f6082=_0x33235b;if(validateAccess(_0x545394,_0x9fa44a)[_0x1f6082(0x25e)]){if(pid[_0x3acff7])pid[_0x3acff7]['send']({'function':'deleteHistoryAlerts','args':_0x54e0b6});}else logger[_0x1f6082(0x2df)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x22f273['on'](_0x33235b(0x26a),(_0x397bbe,_0x4bc322)=>{const _0x5ec72a=_0x33235b;if(validateAccess(_0x4bc322,_0x9fa44a)['allow']){if(pid[_0x3acff7])pid[_0x3acff7]['send']({'function':'getPortfolio','args':_0x397bbe});}else logger[_0x5ec72a(0x2df)](_0x5ec72a(0x338));}),_0x22f273['on'](_0x33235b(0x368),(_0x4d15ea,_0x4548de)=>{const _0x56abcf=_0x33235b;if(validateAccess(_0x4548de,_0x9fa44a)[_0x56abcf(0x25e)]){if(pid[_0x3acff7])pid[_0x3acff7][_0x56abcf(0x2da)]({'function':_0x56abcf(0x32e),'args':_0x4d15ea});}else logger[_0x56abcf(0x2df)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x22f273['on']('store-headless',(_0x372a6e,_0x630253)=>{const _0x7aca05=_0x33235b;if(validateAccess(_0x630253,_0x9fa44a)[_0x7aca05(0x25e)]){if(pid[_0x3acff7])pid[_0x3acff7][_0x7aca05(0x2da)]({'function':_0x7aca05(0x3b4),'args':_0x372a6e});}else logger[_0x7aca05(0x2df)](_0x7aca05(0x33c));}),_0x22f273['on'](_0x33235b(0x350),(_0x1d6ad7,_0x3800b8)=>{const _0x1c2fac=_0x33235b;if(validateAccess(_0x3800b8,_0x9fa44a)['allow']){if(pid[_0x3acff7])pid[_0x3acff7]['send']({'function':'storeFiat','args':_0x1d6ad7});}else logger[_0x1c2fac(0x2df)](_0x1c2fac(0x23a));}),_0x22f273['on'](_0x33235b(0x35f),_0x268d4c=>{const _0x414ca2=_0x33235b;if(validateAccess(_0x268d4c,_0x9fa44a)[_0x414ca2(0x25e)]){if(pid[_0x3acff7])pid[_0x3acff7][_0x414ca2(0x2da)]({'function':_0x414ca2(0x290),'args':null});}else logger[_0x414ca2(0x2df)](_0x414ca2(0x2f2));}),_0x22f273['on']('get-starting-balances',_0x4079af=>{const _0x3ed534=_0x33235b;if(validateAccess(_0x4079af,_0x9fa44a)['allow']){if(pid[_0x3acff7])pid[_0x3acff7][_0x3ed534(0x2da)]({'function':_0x3ed534(0x339),'args':null});}else logger[_0x3ed534(0x2df)](_0x3ed534(0x1fe));}),_0x22f273['on'](_0x33235b(0x39a),(_0x16d7bb,_0x1574e8)=>{const _0x96da3e=_0x33235b;if(validateAccess(_0x1574e8,_0x9fa44a)[_0x96da3e(0x25e)]){if(pid[_0x3acff7])pid[_0x3acff7]['send']({'function':'placeOrder','args':_0x16d7bb});}else logger[_0x96da3e(0x2df)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x22f273['on'](_0x33235b(0x2ea),_0x3cf43c=>{const _0x114bef=_0x33235b;if(validateAccess(_0x3cf43c,_0x9fa44a)['allow']){if(pid[_0x3acff7])pid[_0x3acff7][_0x114bef(0x2da)]({'function':_0x114bef(0x3ac),'args':null});}else logger[_0x114bef(0x2df)](_0x114bef(0x37c));}),_0x22f273['on']('show-config',_0xec9dff=>{const _0x4733ea=_0x33235b;if(validateAccess(_0xec9dff,_0x9fa44a)[_0x4733ea(0x25e)]){if(pid[_0x3acff7])pid[_0x3acff7][_0x4733ea(0x2da)]({'function':_0x4733ea(0x209),'args':null});}else logger[_0x4733ea(0x2df)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x22f273['on']('update-bb',_0x20739e=>{const _0x34ee6c=_0x33235b;if(validateAccess(_0x20739e,_0x9fa44a)[_0x34ee6c(0x25e)])updateBB(_0x34ee6c(0x36b));else logger[_0x34ee6c(0x2df)](_0x34ee6c(0x394));}),_0x22f273['on']('get-messages',_0x3d3b78=>{const _0x546b2c=_0x33235b;if(validateAccess(_0x3d3b78,_0x9fa44a)['allow'])getMessages();else logger['full'](_0x546b2c(0x2e0));}),_0x22f273['on'](_0x33235b(0x381),(_0x319727,_0x2e7b4b)=>{const _0x31ac71=_0x33235b;if(validateAccess(_0x2e7b4b,_0x9fa44a)[_0x31ac71(0x25e)])confirmMessage(_0x319727);else logger[_0x31ac71(0x2df)](_0x31ac71(0x383));}),_0x22f273['on']('logout',_0x5c80f7=>{const _0x3f9a43=_0x33235b;if(validateAccess(_0x5c80f7,_0x9fa44a)[_0x3f9a43(0x25e)]){if(devices[_0x9fa44a][_0x3f9a43(0x2dc)])clearTimeout(devices[_0x9fa44a][_0x3f9a43(0x2dc)]);if(devices[_0x9fa44a][_0x3f9a43(0x38a)])clearTimeout(devices[_0x9fa44a][_0x3f9a43(0x38a)]);removeSocketListeners(getClient(_0x22f273['id'])['uuid']),addBlacklist(_0x9fa44a),devices[_0x9fa44a]['telegramIpApproval']=null,devices[_0x9fa44a]['telegram2FaApproval']=null,devices[_0x9fa44a][_0x3f9a43(0x210)][_0x3f9a43(0x3b2)]=null,logger['debug'](_0x3f9a43(0x22b)+_0x9fa44a['slice'](-0x8)),io['to'](getClient(_0x22f273['id'])[_0x3f9a43(0x22d)])['emit'](_0x3f9a43(0x2d4),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x3f9a43(0x2df)](_0x3f9a43(0x2ae));});}function removeSocketListeners(_0x2f66a6){const _0x282691=_0x385116;getClientsWithUuid(_0x2f66a6)[_0x282691(0x2b8)](_0x239317=>{getSocket(_0x239317['id'])['removeAllListeners']();});}function cleanSettings(){const _0x14f6bb=_0x385116;let _0x229b37=settings;return settings[_0x14f6bb(0x247)]&&settings['telegramToken']!=''&&(_0x229b37={..._0x229b37,'telegramToken':_0x14f6bb(0x335)}),settings['bbPassword']&&settings['bbPassword']!=''&&(_0x229b37={..._0x229b37,'bbPassword':_0x14f6bb(0x335)}),(settings[_0x14f6bb(0x30f)]&&settings[_0x14f6bb(0x30f)]=='***'||settings[_0x14f6bb(0x247)]&&settings['telegramToken']==_0x14f6bb(0x3a7))&&(_0x229b37={..._0x229b37,'restored':{'password':settings[_0x14f6bb(0x30f)]==_0x14f6bb(0x3a7),'telegram':settings[_0x14f6bb(0x247)]==_0x14f6bb(0x3a7)}}),_0x229b37;}async function updateBB(_0x502bca){const _0x414dde=_0x385116;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x82fc9a=>{const _0x470d80=_0x24f4;restartBot(_0x82fc9a[_0x470d80(0x251)]);}),logger[_0x414dde(0x31a)](_0x414dde(0x291)+_0x502bca);if(_0x502bca==_0x414dde(0x36b))process[_0x414dde(0x2da)]({'update':!![]},_0x4144ef=>{});else _0x502bca==_0x414dde(0x33b)&&process[_0x414dde(0x2da)]({'reinstall':!![]},_0x557e9d=>{});}function startBot(_0x38e29b,_0x4ffa03,_0x169f68){const _0x4a2a09=_0x385116;if(debugging)_0x38e29b[_0x4a2a09(0x2cd)]('-d');let _0x5901d4=![];const _0x2696a9=_0x38e29b[0x0];_0x4ffa03={..._0x4ffa03,'stdio':[_0x4a2a09(0x37e),_0x4a2a09(0x37e),_0x4a2a09(0x37e),'ipc']},pid[_0x2696a9]=childProcess[_0x4a2a09(0x21b)](botfile,_0x38e29b,_0x4ffa03),pid[_0x2696a9]['on'](_0x4a2a09(0x342),_0x1e59c5=>{const _0x4e53b7=_0x4a2a09;switch(Object[_0x4e53b7(0x22c)](_0x1e59c5)[0x0]){case'botname':updateBotName(_0x2696a9,_0x1e59c5[_0x4e53b7(0x35a)]);break;case _0x4e53b7(0x318):updateBotManager();break;case _0x4e53b7(0x2d4):updateStatus(_0x2696a9,_0x1e59c5[_0x4e53b7(0x2d4)]);break;case _0x4e53b7(0x2a0):updateLive(_0x2696a9,_0x1e59c5['live']);break;case _0x4e53b7(0x33d):updateLive(_0x2696a9,_0x1e59c5[_0x4e53b7(0x33d)]),io['to'](_0x2696a9)[_0x4e53b7(0x2de)](_0x4e53b7(0x2d4),{'access':{'allow':![],'reason':_0x4e53b7(0x21d),'token':null}});break;case _0x4e53b7(0x24e):_0x1e59c5[_0x4e53b7(0x24e)]==_0x4e53b7(0x2c2)&&restartBot(_0x2696a9);_0x1e59c5['stop']==_0x4e53b7(0x3bd)&&toggleBot(_0x2696a9,_0x4e53b7(0x360),'stopped');break;case _0x4e53b7(0x323):sendTelegram(_0x2696a9,_0x1e59c5[_0x4e53b7(0x323)]);break;case _0x4e53b7(0x331):sendTelegramMsg(_0x1e59c5[_0x4e53b7(0x331)]);break;case _0x4e53b7(0x211):io['to'](_0x2696a9)['emit'](_0x1e59c5[_0x4e53b7(0x211)],_0x1e59c5[_0x4e53b7(0x217)]);break;}}),pid[_0x2696a9]['on']('error',function(_0x5291d5){if(_0x5901d4)return;_0x5901d4=!![],_0x169f68(_0x5291d5);}),pid[_0x2696a9]['on']('exit',async function(_0x3c4b74){const _0x3d1304=_0x4a2a09;if(installingUpdate)return;if(_0x5901d4)return;_0x5901d4=!![],_0x169f68(null);const _0x45774f=dbConfig[_0x3d1304(0x26e)](_0x3d1304(0x30b))[_0x3d1304(0x1f1)]({'botID':_0x2696a9})['value']();_0x45774f&&(_0x45774f['status']=='enabled'||_0x45774f[_0x3d1304(0x2d4)]==_0x3d1304(0x320))&&(await sleep(0x3e8),updateLive(_0x2696a9,_0x3d1304(0x23d)),logger[_0x3d1304(0x2df)]('Restarting\x20Bot\x20'+_0x2696a9),startBot([_0x2696a9,userID],{'cwd':bbpath},function(_0x3b6c87){const _0x1c2f1c=_0x3d1304;if(_0x3b6c87)logger[_0x1c2f1c(0x2df)](_0x3b6c87);}));});}function stopBot(_0x32f7e4){const _0x1473e2=_0x385116;getClientsWithBotID(_0x32f7e4)[_0x1473e2(0x2b8)](_0x49e665=>{const _0x17158c=_0x1473e2;getSocket(_0x49e665['id'])[_0x17158c(0x204)](!![]),removeClient(_0x49e665['id']);}),pid[_0x32f7e4]&&(pid[_0x32f7e4]['kill'](),pid[_0x32f7e4]=null);}function restartBot(_0x3bf3ae){const _0x5ca9fc=_0x385116;if(pid[_0x3bf3ae])pid[_0x3bf3ae][_0x5ca9fc(0x3bd)]();}function addBot(){const _0x4f3208=_0x385116;let _0x59feb2;for(let _0x103a06=0x1;_0x103a06<0x3e9;_0x103a06++){_0x59feb2=_0x103a06[_0x4f3208(0x30c)]()[_0x4f3208(0x25b)](0x3,'0');let _0xbc73a8=config[_0x4f3208(0x1f1)](_0x50984a=>_0x50984a[_0x4f3208(0x251)]==_0x59feb2);if(!_0xbc73a8)break;}if(_0x59feb2===_0x4f3208(0x2bd)){logger[_0x4f3208(0x2df)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x4f3208(0x2df)](_0x4f3208(0x1f5)+_0x59feb2),dbConfig[_0x4f3208(0x26e)]('bots')[_0x4f3208(0x2cd)]({'botID':_0x59feb2,'botname':_0x4f3208(0x36e)+_0x59feb2,'status':'new','live':''})[_0x4f3208(0x388)](),startBot([_0x59feb2,userID],{'cwd':bbpath},function(_0x3c377f){const _0x58d8fb=_0x4f3208;if(_0x3c377f)logger[_0x58d8fb(0x2df)](_0x3c377f);}),config=getConfiguration(),io['to'](_0x4f3208(0x288))[_0x4f3208(0x2de)](_0x4f3208(0x30b),config),broadcastToBots('bots',JSON[_0x4f3208(0x2e2)](config));}function deleteBot(_0x2d64d1){const _0x1a2f69=_0x385116;getClientsWithBotID(_0x2d64d1)[_0x1a2f69(0x2b8)](_0x315e27=>{const _0x9698af=_0x1a2f69;getSocket(_0x315e27['id'])[_0x9698af(0x204)](!![]),removeClient(_0x315e27['id']);}),dbConfig[_0x1a2f69(0x26e)]('bots')[_0x1a2f69(0x253)]({'botID':_0x2d64d1})['write'](),logger[_0x1a2f69(0x2df)](_0x1a2f69(0x28f)+_0x2d64d1),stopBot(_0x2d64d1);try{if(fs[_0x1a2f69(0x1f0)](path[_0x1a2f69(0x2ab)](configpath,_0x1a2f69(0x26f)+_0x2d64d1+'-config.json')))fs[_0x1a2f69(0x3b6)](path[_0x1a2f69(0x2ab)](configpath,_0x1a2f69(0x26f)+_0x2d64d1+_0x1a2f69(0x2a2)));if(fs['existsSync'](path[_0x1a2f69(0x2ab)](configpath,_0x1a2f69(0x26f)+_0x2d64d1+_0x1a2f69(0x297))))fs[_0x1a2f69(0x3b6)](path['join'](configpath,_0x1a2f69(0x26f)+_0x2d64d1+'-events.json'));if(fs[_0x1a2f69(0x1f0)](path[_0x1a2f69(0x2ab)](configpath,_0x1a2f69(0x26f)+_0x2d64d1+_0x1a2f69(0x31f))))fs[_0x1a2f69(0x3b6)](path[_0x1a2f69(0x2ab)](configpath,_0x1a2f69(0x26f)+_0x2d64d1+_0x1a2f69(0x31f)));if(fs[_0x1a2f69(0x1f0)](path[_0x1a2f69(0x2ab)](configpath,'bot-'+_0x2d64d1+'-results.json')))fs[_0x1a2f69(0x3b6)](path['join'](configpath,'bot-'+_0x2d64d1+_0x1a2f69(0x272)));}catch(_0x447ade){if(_0x447ade)logger[_0x1a2f69(0x2df)](_0x1a2f69(0x282),_0x447ade);}config=getConfiguration(),io['to'](_0x1a2f69(0x288))['emit'](_0x1a2f69(0x30b),config),broadcastToBots(_0x1a2f69(0x30b),JSON['stringify'](config));}function toggleBot(_0xd398a1,_0xe3f3e3,_0x44e197){const _0x2943e5=_0x385116;dbConfig[_0x2943e5(0x26e)]('bots')[_0x2943e5(0x1f1)]({'botID':_0xd398a1})[_0x2943e5(0x343)]({'status':_0xe3f3e3})['assign']({'live':_0x44e197})['write']();if(_0xe3f3e3==_0x2943e5(0x22a)||_0xe3f3e3==_0x2943e5(0x320))logger[_0x2943e5(0x2df)](_0x2943e5(0x206)+_0xd398a1),startBot([_0xd398a1,userID],{'cwd':bbpath},function(_0x148a88){const _0x34b591=_0x2943e5;if(_0x148a88)logger[_0x34b591(0x2df)](_0x148a88);});else(_0xe3f3e3=='disabled'||_0xe3f3e3==_0x2943e5(0x22f))&&(logger[_0x2943e5(0x2df)](_0x2943e5(0x2ce)+_0xd398a1),stopBot(_0xd398a1));config=getConfiguration(),io['to'](_0x2943e5(0x288))['emit'](_0x2943e5(0x30b),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleStatus(_0xf11126){const _0x5e5dee=_0x385116;let _0x31e107=dbConfig[_0x5e5dee(0x26e)]('bots')[_0x5e5dee(0x1f1)]({'botID':_0xf11126})[_0x5e5dee(0x21c)](),_0x197d34;if(_0x31e107[_0x5e5dee(0x2d4)]===_0x5e5dee(0x22a))_0x197d34=_0x5e5dee(0x360);else{if(_0x31e107[_0x5e5dee(0x2d4)]===_0x5e5dee(0x320))_0x197d34='new-disabled';else{if(_0x31e107[_0x5e5dee(0x2d4)]===_0x5e5dee(0x22f))_0x197d34='new';else{if(_0x31e107[_0x5e5dee(0x2d4)]===_0x5e5dee(0x360))_0x197d34=_0x5e5dee(0x22a);}}}return _0x197d34;}function updateStatus(_0x321c47,_0x1bb68d){const _0x31ca2f=_0x385116;dbConfig[_0x31ca2f(0x26e)](_0x31ca2f(0x30b))[_0x31ca2f(0x1f1)]({'botID':_0x321c47})[_0x31ca2f(0x343)]({'status':_0x1bb68d})[_0x31ca2f(0x388)](),config=getConfiguration(),io['to'](_0x31ca2f(0x288))[_0x31ca2f(0x2de)](_0x31ca2f(0x30b),config),broadcastToBots(_0x31ca2f(0x30b),JSON['stringify'](config));}function updateLive(_0x148fe5,_0x38ea38){const _0x27aa0c=_0x385116;dbConfig[_0x27aa0c(0x26e)](_0x27aa0c(0x30b))['find']({'botID':_0x148fe5})[_0x27aa0c(0x343)]({'live':_0x38ea38})[_0x27aa0c(0x388)](),config=getConfiguration(),io['to'](_0x27aa0c(0x288))[_0x27aa0c(0x2de)]('bots',config),broadcastToBots(_0x27aa0c(0x30b),JSON[_0x27aa0c(0x2e2)](config));}function updateBotName(_0x306e69,_0x2401d0){const _0x1818e0=_0x385116;dbConfig[_0x1818e0(0x26e)]('bots')[_0x1818e0(0x1f1)]({'botID':_0x306e69})[_0x1818e0(0x343)]({'botname':_0x2401d0})[_0x1818e0(0x388)](),config=getConfiguration(),io['to'](_0x1818e0(0x288))[_0x1818e0(0x2de)](_0x1818e0(0x30b),config),broadcastToBots('bots',JSON[_0x1818e0(0x2e2)](config));}function updateBotManager(){const _0x5ae7d7=_0x385116;config=getConfiguration(),io['to']('botmanager')[_0x5ae7d7(0x2de)](_0x5ae7d7(0x30b),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBotMode(_0x1617ab){const _0x258951=_0x385116;if(pid[_0x1617ab])pid[_0x1617ab][_0x258951(0x2da)]({'function':'toggleBotMode','args':null});else{const _0x159212=configpath+'bot-'+_0x1617ab+_0x258951(0x2a2),_0x1182ed=fs['readFileSync'](_0x159212),_0x3df4f8=JSON[_0x258951(0x322)](_0x1182ed),_0x23477c=_0x3df4f8['bot'][0x0][_0x258951(0x238)];_0x3df4f8['bot'][0x0][_0x258951(0x238)]=!_0x23477c;const _0x4ff6b5=JSON['stringify'](_0x3df4f8,null,0x2);fs['writeFileSync'](_0x159212,_0x4ff6b5),config=getConfiguration(),io['to'](_0x258951(0x288))['emit']('bots',config),broadcastToBots(_0x258951(0x30b),JSON[_0x258951(0x2e2)](config));}}function telegramError(_0x4c30d6){const _0x50b8db=_0x385116;logger[_0x50b8db(0x2fe)](getTimeStamp()+_0x50b8db(0x2e6));}function validateTelegram(_0x2e910d){const _0x4665c0=_0x385116;if(_0x2e910d[_0x4665c0(0x27f)][_0x4665c0(0x2ca)]!=settings[_0x4665c0(0x3b5)]&&'@'+_0x2e910d[_0x4665c0(0x27f)][_0x4665c0(0x2ca)]!=settings[_0x4665c0(0x3b5)])return tgBot[_0x4665c0(0x311)](_0x2e910d[_0x4665c0(0x3c1)]['id'],_0x4665c0(0x365),{'parse_mode':_0x4665c0(0x28b)})[_0x4665c0(0x2ed)](_0x299673=>{telegramError(_0x299673);}),![];return!![];}async function initTelegram(){const _0x562281=_0x385116;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x2eec22=_0x562281(0x2bc);_0x2eec22+='\x0a',_0x2eec22+='/enable\x20-\x20enable\x20notifications\x0a',_0x2eec22+='/disable\x20-\x20disable\x20notifications\x0a',_0x2eec22+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x2eec22+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x2eec22+='/on\x20-\x20start\x20bot(s)\x0a',_0x2eec22+=_0x562281(0x324),_0x2eec22+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x2eec22+=_0x562281(0x32c),_0x2eec22+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x2eec22+=_0x562281(0x28a),_0x2eec22+=_0x562281(0x3b0),_0x2eec22+=_0x562281(0x373),_0x2eec22+=_0x562281(0x329),_0x2eec22+=_0x562281(0x24c);let _0x8f9ce=_0x562281(0x2a4);_0x8f9ce+='\x0a',_0x8f9ce+=_0x2eec22,tgBot['onText'](/\/start/,_0x465a3d=>{const _0x4effa2=_0x562281;if(!validateTelegram(_0x465a3d))return;if(settings[_0x4effa2(0x2d5)]!=_0x465a3d[_0x4effa2(0x3c1)]['id'])updateSetting(_0x4effa2(0x2d5),_0x465a3d[_0x4effa2(0x3c1)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x4effa2(0x311)](_0x465a3d[_0x4effa2(0x3c1)]['id'],_0x8f9ce)['catch'](_0x8e2b11=>{telegramError(_0x8e2b11);});}),tgBot[_0x562281(0x295)](/\/enable/,_0x5328fa=>{const _0x57fa64=_0x562281;if(!validateTelegram(_0x5328fa))return;if(settings[_0x57fa64(0x2d5)]!=_0x5328fa[_0x57fa64(0x3c1)]['id'])updateSetting(_0x57fa64(0x2d5),_0x5328fa[_0x57fa64(0x3c1)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x57fa64(0x311)](_0x5328fa[_0x57fa64(0x3c1)]['id'],_0x57fa64(0x2e3))[_0x57fa64(0x2ed)](_0x225193=>{telegramError(_0x225193);});}),tgBot['onText'](/\/config/,async _0x59bdf5=>{const _0x2e27ec=_0x562281;if(!validateTelegram(_0x59bdf5))return;tgBot['removeListener']('callback_query'),tgBot[_0x2e27ec(0x311)](_0x59bdf5[_0x2e27ec(0x3c1)]['id'],_0x2e27ec(0x28e),{'reply_markup':{'inline_keyboard':[[{'text':_0x2e27ec(0x241),'callback_data':_0x2e27ec(0x264)},{'text':_0x2e27ec(0x33a),'callback_data':'alerts'},{'text':_0x2e27ec(0x200),'callback_data':_0x2e27ec(0x234)}]]}})[_0x2e27ec(0x2ed)](_0x1b79aa=>{telegramError(_0x1b79aa);}),tgBot['on'](_0x2e27ec(0x294),async _0x1ce376=>{const _0x397b7c=_0x2e27ec,_0x3adcdf=_0x1ce376[_0x397b7c(0x218)],_0x4d9b8e=_0x1ce376[_0x397b7c(0x342)];tgBot[_0x397b7c(0x38b)](_0x1ce376['id'])[_0x397b7c(0x3a0)](async()=>{const _0x3b3fbe=_0x397b7c;_0x3adcdf=='orders'&&(updateSetting(_0x3b3fbe(0x35c),_0x3b3fbe(0x264)),updateSetting(_0x3b3fbe(0x2cf),!![]),await tgBot[_0x3b3fbe(0x311)](_0x4d9b8e[_0x3b3fbe(0x3c1)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')['catch'](_0x54a0a9=>{telegramError(_0x54a0a9);}));_0x3adcdf==_0x3b3fbe(0x330)&&(updateSetting(_0x3b3fbe(0x35c),_0x3b3fbe(0x330)),updateSetting(_0x3b3fbe(0x2cf),!![]),await tgBot[_0x3b3fbe(0x311)](_0x4d9b8e[_0x3b3fbe(0x3c1)]['id'],_0x3b3fbe(0x20c))[_0x3b3fbe(0x2ed)](_0x806b9b=>{telegramError(_0x806b9b);}));_0x3adcdf==_0x3b3fbe(0x234)&&(updateSetting(_0x3b3fbe(0x35c),_0x3b3fbe(0x234)),updateSetting(_0x3b3fbe(0x2cf),!![]),await tgBot[_0x3b3fbe(0x311)](_0x4d9b8e[_0x3b3fbe(0x3c1)]['id'],_0x3b3fbe(0x29f))[_0x3b3fbe(0x2ed)](_0x53c229=>{telegramError(_0x53c229);}));if(!settings[_0x3b3fbe(0x2d5)])tgBot[_0x3b3fbe(0x311)](_0x4d9b8e[_0x3b3fbe(0x3c1)]['id'],_0x3b3fbe(0x243))['catch'](_0x54529d=>{telegramError(_0x54529d);});}),tgBot[_0x397b7c(0x29c)](_0x397b7c(0x294));});}),tgBot[_0x562281(0x295)](/\/status/,_0x245aca=>{const _0x472ba4=_0x562281;if(!validateTelegram(_0x245aca))return;const _0x1ca994=getBotsWithMode();let _0x4768d2=_0x472ba4(0x266);config[_0x472ba4(0x2b8)](_0x292ae2=>{const _0x304a7b=_0x472ba4,_0x2c1f67=_0x1ca994[_0x304a7b(0x1f1)](_0x3d2e84=>_0x3d2e84[_0x304a7b(0x251)]==_0x292ae2[_0x304a7b(0x251)])[_0x304a7b(0x1fb)];_0x4768d2+=_0x304a7b(0x36e)+_0x292ae2[_0x304a7b(0x251)]+':\x20'+_0x292ae2[_0x304a7b(0x2d4)]+_0x304a7b(0x39e)+_0x2c1f67+_0x304a7b(0x39e)+_0x292ae2[_0x304a7b(0x2a0)]+'\x0a';}),_0x4768d2+='\x0a',_0x4768d2+=_0x472ba4(0x2a3),_0x4768d2+=!settings[_0x472ba4(0x2cf)]?'Notifications\x20disabled\x0a':_0x472ba4(0x389),_0x4768d2+=settings['telegramEnabled']?settings[_0x472ba4(0x35c)]==_0x472ba4(0x234)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x472ba4(0x375)+settings[_0x472ba4(0x35c)]+_0x472ba4(0x305):'',tgBot[_0x472ba4(0x311)](_0x245aca[_0x472ba4(0x3c1)]['id'],_0x4768d2,{'parse_mode':_0x472ba4(0x28b)})[_0x472ba4(0x2ed)](_0x2f18dc=>{telegramError(_0x2f18dc);});}),tgBot[_0x562281(0x295)](/\/restart/,_0x52712c=>{const _0x331440=_0x562281;if(!validateTelegram(_0x52712c))return;tgBot[_0x331440(0x29c)](_0x331440(0x294));const _0x21040b=getEnabledBots();if(_0x21040b[_0x331440(0x3ad)]==0x0)tgBot[_0x331440(0x311)](_0x52712c[_0x331440(0x3c1)]['id'],_0x331440(0x26d))['catch'](_0x59d7d6=>{telegramError(_0x59d7d6);});else{if(_0x21040b['length']>0x1)_0x21040b[_0x331440(0x2cd)]({'botID':_0x331440(0x234)});let _0x3e793d=[],_0x35693a=[];const _0x1b1182=_0x21040b['length']%0x4==0x0||_0x21040b[_0x331440(0x3ad)]%0x4==0x3||_0x21040b[_0x331440(0x3ad)]%0x3==0x1?0x4:0x3;let _0x458231=0x0;_0x21040b[_0x331440(0x2b8)]((_0x23ea12,_0x21b864)=>{const _0x483b2a=_0x331440;if(_0x21b864%_0x1b1182==0x0)_0x35693a=[];_0x35693a['push']({'text':_0x23ea12[_0x483b2a(0x251)]==_0x483b2a(0x234)?_0x483b2a(0x390):'Bot\x20'+_0x23ea12['botID'],'callback_data':_0x23ea12[_0x483b2a(0x251)]}),_0x21b864%_0x1b1182==0x0&&(_0x3e793d[_0x458231]=_0x35693a,_0x458231++);}),tgBot[_0x331440(0x311)](_0x52712c[_0x331440(0x3c1)]['id'],_0x331440(0x21a),{'reply_markup':{'inline_keyboard':_0x3e793d}})['catch'](_0x34344c=>{telegramError(_0x34344c);}),tgBot['on'](_0x331440(0x294),async _0x20d302=>{const _0x2c6450=_0x331440,_0x7c244d=_0x20d302[_0x2c6450(0x218)],_0x4368b4=_0x20d302[_0x2c6450(0x342)];tgBot[_0x2c6450(0x38b)](_0x20d302['id'])[_0x2c6450(0x3a0)](async()=>{const _0x42e2a3=_0x2c6450;_0x7c244d=='all'?config[_0x42e2a3(0x2b8)](_0x5634a7=>{restartBot(_0x5634a7['botID']);}):restartBot(_0x7c244d);}),tgBot[_0x2c6450(0x29c)](_0x2c6450(0x294));});}}),tgBot[_0x562281(0x295)](/\/on/,_0xb3eb8a=>{const _0x1589e5=_0x562281;if(!validateTelegram(_0xb3eb8a))return;tgBot[_0x1589e5(0x29c)](_0x1589e5(0x294));const _0x31cb72=getDisabledBots();if(_0x31cb72[_0x1589e5(0x3ad)]==0x0)tgBot[_0x1589e5(0x311)](_0xb3eb8a[_0x1589e5(0x3c1)]['id'],_0x1589e5(0x301))['catch'](_0x5a424e=>{telegramError(_0x5a424e);});else{if(_0x31cb72[_0x1589e5(0x3ad)]>0x1)_0x31cb72[_0x1589e5(0x2cd)]({'botID':_0x1589e5(0x234)});let _0x517c9a=[],_0x30f064=[];const _0x485990=_0x31cb72[_0x1589e5(0x3ad)]%0x4==0x0||_0x31cb72[_0x1589e5(0x3ad)]%0x4==0x3||_0x31cb72[_0x1589e5(0x3ad)]%0x3==0x1?0x4:0x3;let _0x43ba0e=0x0;_0x31cb72[_0x1589e5(0x2b8)]((_0x1fac52,_0x20a93e)=>{const _0x46607c=_0x1589e5;if(_0x20a93e%_0x485990==0x0)_0x30f064=[];_0x30f064[_0x46607c(0x2cd)]({'text':_0x1fac52['botID']=='all'?'All\x20bots':_0x46607c(0x36e)+_0x1fac52[_0x46607c(0x251)],'callback_data':_0x1fac52[_0x46607c(0x251)]}),_0x20a93e%_0x485990==0x0&&(_0x517c9a[_0x43ba0e]=_0x30f064,_0x43ba0e++);}),tgBot[_0x1589e5(0x311)](_0xb3eb8a[_0x1589e5(0x3c1)]['id'],_0x1589e5(0x367),{'reply_markup':{'inline_keyboard':_0x517c9a}})[_0x1589e5(0x2ed)](_0xbfe684=>{telegramError(_0xbfe684);}),tgBot['on'](_0x1589e5(0x294),async _0x299da4=>{const _0x4d3de3=_0x1589e5,_0x2e2f5a=_0x299da4[_0x4d3de3(0x218)],_0x34b234=_0x299da4['message'];tgBot['answerCallbackQuery'](_0x299da4['id'])[_0x4d3de3(0x3a0)](async()=>{const _0x1d2d2d=_0x4d3de3;_0x2e2f5a==_0x1d2d2d(0x234)?(tgBot[_0x1d2d2d(0x311)](_0x34b234[_0x1d2d2d(0x3c1)]['id'],_0x1d2d2d(0x2d9))[_0x1d2d2d(0x2ed)](_0x4b8326=>{telegramError(_0x4b8326);}),_0x31cb72['forEach'](_0x2e8672=>{const _0x59cac8=_0x1d2d2d;if(_0x2e8672['botID']!=_0x59cac8(0x234))toggleBot(_0x2e8672['botID'],toggleStatus(_0x2e8672[_0x59cac8(0x251)]),_0x59cac8(0x23d));})):(tgBot[_0x1d2d2d(0x311)](_0x34b234[_0x1d2d2d(0x3c1)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x2e2f5a)['catch'](_0x162386=>{telegramError(_0x162386);}),toggleBot(_0x2e2f5a,toggleStatus(_0x2e2f5a),_0x1d2d2d(0x23d)));}),tgBot['removeListener'](_0x4d3de3(0x294));});}}),tgBot['onText'](/\/off/,_0xdc4ee7=>{const _0x33cade=_0x562281;if(!validateTelegram(_0xdc4ee7))return;tgBot[_0x33cade(0x29c)](_0x33cade(0x294));const _0x5c5d2c=getEnabledBots();if(_0x5c5d2c[_0x33cade(0x3ad)]==0x0)tgBot['sendMessage'](_0xdc4ee7[_0x33cade(0x3c1)]['id'],_0x33cade(0x26d))[_0x33cade(0x2ed)](_0x491f72=>{telegramError(_0x491f72);});else{if(_0x5c5d2c[_0x33cade(0x3ad)]>0x1)_0x5c5d2c[_0x33cade(0x2cd)]({'botID':_0x33cade(0x234)});let _0x5ab3b0=[],_0x41f185=[];const _0x1803c6=_0x5c5d2c['length']%0x4==0x0||_0x5c5d2c[_0x33cade(0x3ad)]%0x4==0x3||_0x5c5d2c[_0x33cade(0x3ad)]%0x3==0x1?0x4:0x3;let _0x2bbeda=0x0;_0x5c5d2c[_0x33cade(0x2b8)]((_0x24ce67,_0x2f625f)=>{const _0x4ed874=_0x33cade;if(_0x2f625f%_0x1803c6==0x0)_0x41f185=[];_0x41f185[_0x4ed874(0x2cd)]({'text':_0x24ce67[_0x4ed874(0x251)]==_0x4ed874(0x234)?'All\x20bots':'Bot\x20'+_0x24ce67[_0x4ed874(0x251)],'callback_data':_0x24ce67[_0x4ed874(0x251)]}),_0x2f625f%_0x1803c6==0x0&&(_0x5ab3b0[_0x2bbeda]=_0x41f185,_0x2bbeda++);}),tgBot[_0x33cade(0x311)](_0xdc4ee7[_0x33cade(0x3c1)]['id'],_0x33cade(0x2af),{'reply_markup':{'inline_keyboard':_0x5ab3b0}})[_0x33cade(0x2ed)](_0xe67a68=>{telegramError(_0xe67a68);}),tgBot['on'](_0x33cade(0x294),async _0x4c16c0=>{const _0x34cfaa=_0x33cade,_0x5257ef=_0x4c16c0['data'],_0x30153f=_0x4c16c0['message'];tgBot[_0x34cfaa(0x38b)](_0x4c16c0['id'])[_0x34cfaa(0x3a0)](async()=>{const _0x21d6d7=_0x34cfaa;_0x5257ef==_0x21d6d7(0x234)?(tgBot['sendMessage'](_0x30153f[_0x21d6d7(0x3c1)]['id'],_0x21d6d7(0x2be))[_0x21d6d7(0x2ed)](_0x2ffcc0=>{telegramError(_0x2ffcc0);}),_0x5c5d2c[_0x21d6d7(0x2b8)](_0xaaa0a0=>{const _0x1dfe5e=_0x21d6d7;if(_0xaaa0a0[_0x1dfe5e(0x251)]!=_0x1dfe5e(0x234))toggleBot(_0xaaa0a0[_0x1dfe5e(0x251)],toggleStatus(_0xaaa0a0[_0x1dfe5e(0x251)]),'stopped');})):(tgBot['sendMessage'](_0x30153f[_0x21d6d7(0x3c1)]['id'],_0x21d6d7(0x358)+_0x5257ef)['catch'](_0xc1eb43=>{telegramError(_0xc1eb43);}),toggleBot(_0x5257ef,toggleStatus(_0x5257ef),'stopped'));}),tgBot[_0x34cfaa(0x29c)](_0x34cfaa(0x294));});}}),tgBot['onText'](/\/metrics/,_0x55b590=>{const _0x14ec0b=_0x562281;if(!validateTelegram(_0x55b590))return;tgBot[_0x14ec0b(0x29c)]('callback_query');const _0x44f94c=getEnabledBots();if(_0x44f94c[_0x14ec0b(0x3ad)]==0x0)tgBot['sendMessage'](_0x55b590[_0x14ec0b(0x3c1)]['id'],_0x14ec0b(0x26d))[_0x14ec0b(0x2ed)](_0x212e5e=>{telegramError(_0x212e5e);});else{if(_0x44f94c['length']>0x1){let _0x2a9fed=[],_0x48b94a=[];const _0x37051b=_0x44f94c[_0x14ec0b(0x3ad)]%0x4==0x0||_0x44f94c[_0x14ec0b(0x3ad)]%0x4==0x3||_0x44f94c['length']%0x3==0x1?0x4:0x3;let _0x1bbfb6=0x0;_0x44f94c[_0x14ec0b(0x2b8)]((_0x58ded7,_0x271624)=>{const _0x592b56=_0x14ec0b;if(_0x271624%_0x37051b==0x0)_0x48b94a=[];_0x48b94a[_0x592b56(0x2cd)]({'text':_0x592b56(0x36e)+_0x58ded7[_0x592b56(0x251)],'callback_data':_0x58ded7[_0x592b56(0x251)]}),_0x271624%_0x37051b==0x0&&(_0x2a9fed[_0x1bbfb6]=_0x48b94a,_0x1bbfb6++);}),tgBot[_0x14ec0b(0x311)](_0x55b590['chat']['id'],_0x14ec0b(0x2b2),{'reply_markup':{'inline_keyboard':_0x2a9fed}})[_0x14ec0b(0x2ed)](_0x488aea=>{telegramError(_0x488aea);}),tgBot['on'](_0x14ec0b(0x294),async _0x31e100=>{const _0x4901e2=_0x14ec0b,_0x29f73c=_0x31e100[_0x4901e2(0x218)],_0x499a60=_0x31e100[_0x4901e2(0x342)];tgBot[_0x4901e2(0x38b)](_0x31e100['id'])[_0x4901e2(0x3a0)](async()=>{const _0x1b0a2e=_0x4901e2;if(pid[_0x29f73c])pid[_0x29f73c]['send']({'function':_0x1b0a2e(0x1ef),'args':null});}),tgBot['removeListener'](_0x4901e2(0x294));});}else{const _0x241fdf=_0x44f94c[0x0][_0x14ec0b(0x251)];if(pid[_0x241fdf])pid[_0x241fdf][_0x14ec0b(0x2da)]({'function':_0x14ec0b(0x1ef),'args':null});}}}),tgBot[_0x562281(0x295)](/\/portfolio/,_0xf69dd9=>{const _0x14646f=_0x562281;if(!validateTelegram(_0xf69dd9))return;tgBot[_0x14646f(0x29c)](_0x14646f(0x294));const _0x422fb3=getEnabledBots();if(_0x422fb3['length']==0x0)tgBot[_0x14646f(0x311)](_0xf69dd9['chat']['id'],_0x14646f(0x26d))[_0x14646f(0x2ed)](_0x875f3d=>{telegramError(_0x875f3d);});else{if(_0x422fb3['length']>0x1){let _0x218861=[],_0x2b575b=[];const _0x32b41e=_0x422fb3[_0x14646f(0x3ad)]%0x4==0x0||_0x422fb3['length']%0x4==0x3||_0x422fb3[_0x14646f(0x3ad)]%0x3==0x1?0x4:0x3;let _0x3b6921=0x0;_0x422fb3['forEach']((_0x4d599f,_0x27ccf0)=>{const _0x16ce2d=_0x14646f;if(_0x27ccf0%_0x32b41e==0x0)_0x2b575b=[];_0x2b575b['push']({'text':_0x16ce2d(0x36e)+_0x4d599f['botID'],'callback_data':_0x4d599f[_0x16ce2d(0x251)]}),_0x27ccf0%_0x32b41e==0x0&&(_0x218861[_0x3b6921]=_0x2b575b,_0x3b6921++);}),tgBot['sendMessage'](_0xf69dd9['chat']['id'],_0x14646f(0x237),{'reply_markup':{'inline_keyboard':_0x218861}})[_0x14646f(0x2ed)](_0x1e6f00=>{telegramError(_0x1e6f00);}),tgBot['on'](_0x14646f(0x294),async _0x5efe09=>{const _0x13e65f=_0x14646f,_0x3553b5=_0x5efe09['data'],_0x253c4e=_0x5efe09[_0x13e65f(0x342)];tgBot[_0x13e65f(0x38b)](_0x5efe09['id'])[_0x13e65f(0x3a0)](async()=>{const _0x248f1a=_0x13e65f;if(pid[_0x3553b5])pid[_0x3553b5]['send']({'function':_0x248f1a(0x203),'args':null});}),tgBot['removeListener'](_0x13e65f(0x294));});}else{const _0x53f9b4=_0x422fb3[0x0][_0x14646f(0x251)];if(pid[_0x53f9b4])pid[_0x53f9b4][_0x14646f(0x2da)]({'function':_0x14646f(0x203),'args':null});}}}),tgBot[_0x562281(0x295)](/\/update/,async _0x351bef=>{const _0x5c0d4f=_0x562281;if(!validateTelegram(_0x351bef))return;tgBot[_0x5c0d4f(0x29c)](_0x5c0d4f(0x294)),await getMessages();if(!updateAvailable)tgBot[_0x5c0d4f(0x311)](_0x351bef[_0x5c0d4f(0x3c1)]['id'],_0x5c0d4f(0x265))[_0x5c0d4f(0x2ed)](_0x474d43=>{telegramError(_0x474d43);});else!validInstallation?tgBot['sendMessage'](_0x351bef[_0x5c0d4f(0x3c1)]['id'],_0x5c0d4f(0x2a9))[_0x5c0d4f(0x2ed)](_0x34b6b4=>{telegramError(_0x34b6b4);}):(tgBot[_0x5c0d4f(0x311)](_0x351bef[_0x5c0d4f(0x3c1)]['id'],_0x5c0d4f(0x262),{'reply_markup':{'inline_keyboard':[[{'text':_0x5c0d4f(0x2f0),'callback_data':_0x5c0d4f(0x34d)},{'text':'No','callback_data':'no'}]]}})[_0x5c0d4f(0x2ed)](_0x265955=>{telegramError(_0x265955);}),tgBot['on']('callback_query',async _0x1edb89=>{const _0x210fed=_0x5c0d4f,_0xc49446=_0x1edb89[_0x210fed(0x218)],_0x2f5a43=_0x1edb89['message'];tgBot[_0x210fed(0x38b)](_0x1edb89['id'])[_0x210fed(0x3a0)](async()=>{const _0x227e18=_0x210fed;_0xc49446==_0x227e18(0x34d)&&(await tgBot[_0x227e18(0x311)](_0x2f5a43[_0x227e18(0x3c1)]['id'],_0x227e18(0x2a1))[_0x227e18(0x2ed)](_0x5298c1=>{telegramError(_0x5298c1);}),updateBB(_0x227e18(0x36b))),_0xc49446=='no'&&await tgBot[_0x227e18(0x311)](_0x2f5a43[_0x227e18(0x3c1)]['id'],_0x227e18(0x27b))[_0x227e18(0x2ed)](_0x4170eb=>{telegramError(_0x4170eb);});}),tgBot[_0x210fed(0x29c)](_0x210fed(0x294));}));}),tgBot['onText'](/\/reinstall/,async _0x4e51ad=>{const _0x1a7cf0=_0x562281;if(!validateTelegram(_0x4e51ad))return;tgBot[_0x1a7cf0(0x29c)]('callback_query'),!validInstallation?tgBot[_0x1a7cf0(0x311)](_0x4e51ad['chat']['id'],_0x1a7cf0(0x2ee))['catch'](_0xc48a79=>{telegramError(_0xc48a79);}):(tgBot[_0x1a7cf0(0x311)](_0x4e51ad[_0x1a7cf0(0x3c1)]['id'],_0x1a7cf0(0x27e),{'reply_markup':{'inline_keyboard':[[{'text':_0x1a7cf0(0x2f0),'callback_data':'yes'},{'text':'No','callback_data':'no'}]]}})[_0x1a7cf0(0x2ed)](_0x4ecd5f=>{telegramError(_0x4ecd5f);}),tgBot['on']('callback_query',async _0x58bb1f=>{const _0x3abd69=_0x1a7cf0,_0x9864ae=_0x58bb1f[_0x3abd69(0x218)],_0x2261b8=_0x58bb1f['message'];tgBot[_0x3abd69(0x38b)](_0x58bb1f['id'])['then'](async()=>{const _0x27f6b6=_0x3abd69;_0x9864ae=='yes'&&(await tgBot[_0x27f6b6(0x311)](_0x2261b8[_0x27f6b6(0x3c1)]['id'],_0x27f6b6(0x309))[_0x27f6b6(0x2ed)](_0x5262ff=>{telegramError(_0x5262ff);}),updateBB(_0x27f6b6(0x33b))),_0x9864ae=='no'&&await tgBot[_0x27f6b6(0x311)](_0x2261b8[_0x27f6b6(0x3c1)]['id'],_0x27f6b6(0x205))['catch'](_0x3e4997=>{telegramError(_0x3e4997);});}),tgBot['removeListener'](_0x3abd69(0x294));}));}),tgBot[_0x562281(0x295)](/\/toggle/,_0x2afb6a=>{const _0x4aa5c8=_0x562281;if(!validateTelegram(_0x2afb6a))return;tgBot[_0x4aa5c8(0x29c)]('callback_query');const _0x3ef909=getBotsWithMode();if(_0x3ef909[_0x4aa5c8(0x3ad)]==0x0)tgBot[_0x4aa5c8(0x311)](_0x2afb6a[_0x4aa5c8(0x3c1)]['id'],_0x4aa5c8(0x26d))['catch'](_0x2a887e=>{telegramError(_0x2a887e);});else{let _0x4d0915=[],_0x55acf2=[];const _0x5a2924=0x2;let _0x375152=0x0;_0x3ef909['forEach']((_0x50cc66,_0x5d0853)=>{const _0x46c82a=_0x4aa5c8;if(_0x5d0853%_0x5a2924==0x0)_0x55acf2=[];_0x55acf2['push']({'text':_0x46c82a(0x36e)+_0x50cc66[_0x46c82a(0x251)]+'\x20('+_0x50cc66[_0x46c82a(0x1fb)]+')','callback_data':_0x50cc66[_0x46c82a(0x251)]}),_0x5d0853%_0x5a2924==0x0&&(_0x4d0915[_0x375152]=_0x55acf2,_0x375152++);}),tgBot[_0x4aa5c8(0x311)](_0x2afb6a['chat']['id'],_0x4aa5c8(0x314),{'reply_markup':{'inline_keyboard':_0x4d0915}})[_0x4aa5c8(0x2ed)](_0x30a881=>{telegramError(_0x30a881);}),tgBot['on'](_0x4aa5c8(0x294),async _0x5d0fb2=>{const _0x52ec0a=_0x4aa5c8,_0x1b948d=_0x5d0fb2['data'],_0x366be9=_0x5d0fb2[_0x52ec0a(0x342)];tgBot[_0x52ec0a(0x38b)](_0x5d0fb2['id'])[_0x52ec0a(0x3a0)](async()=>{const _0xf5b095=_0x52ec0a,_0xa9486d=_0x3ef909['find'](_0x3d9b2c=>_0x3d9b2c['botID']==_0x1b948d),_0x12ef3b=_0xa9486d[_0xf5b095(0x1fb)]=='auto'?_0xf5b095(0x326):'auto';tgBot[_0xf5b095(0x311)](_0x366be9[_0xf5b095(0x3c1)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x1b948d+'\x20to\x20'+_0x12ef3b+_0xf5b095(0x249))[_0xf5b095(0x2ed)](_0x2d8795=>{telegramError(_0x2d8795);}),toggleBotMode(_0x1b948d);}),tgBot[_0x52ec0a(0x29c)]('callback_query');});}}),tgBot[_0x562281(0x295)](/\/names/,_0x2041f9=>{const _0x1aab03=_0x562281;if(!validateTelegram(_0x2041f9))return;let _0x3e88b9='';config[_0x1aab03(0x2b8)](_0x3ebc10=>{const _0x188b03=_0x1aab03;_0x3e88b9+=_0x188b03(0x36e)+_0x3ebc10[_0x188b03(0x251)]+':\x20'+_0x3ebc10['botname']+'\x0a';}),tgBot[_0x1aab03(0x311)](_0x2041f9['chat']['id'],_0x3e88b9,{'parse_mode':'HTML'})[_0x1aab03(0x2ed)](_0x19d429=>{telegramError(_0x19d429);});}),tgBot[_0x562281(0x295)](/\/disable/,_0x186241=>{const _0x20847a=_0x562281;if(!validateTelegram(_0x186241))return;tgBot['sendMessage'](_0x186241[_0x20847a(0x3c1)]['id'],_0x20847a(0x2b4))[_0x20847a(0x2ed)](_0x47d236=>{telegramError(_0x47d236);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x562281(0x295)](/\/help/,_0x42c5a3=>{const _0xe751fc=_0x562281;if(!validateTelegram(_0x42c5a3))return;tgBot[_0xe751fc(0x311)](_0x42c5a3['chat']['id'],_0x2eec22)[_0xe751fc(0x2ed)](_0x3b2cd1=>{telegramError(_0x3b2cd1);});}),tgBot['on']('polling_error',_0x1f9542=>{const _0x1010a3=_0x562281;_0x1f9542[_0x1010a3(0x30c)]()[_0x1010a3(0x252)](_0x1010a3(0x246))&&(logger[_0x1010a3(0x2df)](_0x1010a3(0x22e)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x1010a3(0x288))[_0x1010a3(0x2de)]('notification',_0x1010a3(0x22e)));}),process[_0x562281(0x254)](_0x562281(0x376),()=>{const _0x191a65=_0x562281;if(tgBot)tgBot[_0x191a65(0x3a8)]();process['exit'](0x1);}),process['once'](_0x562281(0x2f3),()=>{const _0x497577=_0x562281;if(tgBot)tgBot['stopPolling']();process[_0x497577(0x354)](0x1);});}}function disableTelegram(){const _0x3164a4=_0x385116;tgBot&&(tgBot[_0x3164a4(0x3a8)](),tgBot=null);}function sendTelegram(_0x58a604,_0x20597a){const _0x17bb8d=_0x385116;if(settings[_0x17bb8d(0x2cf)]){if(settings[_0x17bb8d(0x35c)]==_0x17bb8d(0x234)||(_0x20597a['type']=='error'||_0x20597a[_0x17bb8d(0x21f)]==_0x17bb8d(0x2a7)||_0x20597a[_0x17bb8d(0x21f)]=='success')&&settings['telegramEvents']==_0x17bb8d(0x330)||_0x20597a[_0x17bb8d(0x21f)]==_0x17bb8d(0x3be)&&settings[_0x17bb8d(0x35c)]==_0x17bb8d(0x264)){if(tgBot&&settings[_0x17bb8d(0x2d5)]){if(_0x20597a['showname'])tgBot[_0x17bb8d(0x311)](settings[_0x17bb8d(0x2d5)],_0x20597a[_0x17bb8d(0x35a)]+'\x20>\x20'+_0x20597a[_0x17bb8d(0x285)])['catch'](_0x48a179=>{telegramError(_0x48a179);});else tgBot[_0x17bb8d(0x311)](settings['telegramChatId'],_0x17bb8d(0x36e)+_0x58a604+_0x17bb8d(0x240)+_0x20597a['event'])['catch'](_0x734b6a=>{telegramError(_0x734b6a);});}}}}async function sendTelegramMsg(_0x163b32,_0x15f714=_0x385116(0x28b)){const _0x176e3b=_0x385116;return settings[_0x176e3b(0x2cf)]&&tgBot&&settings[_0x176e3b(0x2d5)]?(await tgBot[_0x176e3b(0x311)](settings['telegramChatId'],_0x163b32,{'parse_mode':_0x15f714})['catch'](_0x5ae613=>{telegramError(_0x5ae613);}),!![]):![];}function getDeviceWithIp(_0x4c98ed){return devices['find'](_0x4a48a9=>_0x4a48a9['ip']===_0x4c98ed);}function temporaryAccess2FA(_0x183e25,_0x240837){const _0xde0f41=_0x385116;let _0x411543=new Date(),_0x4a3012=![];if(lastIpApproval){if(_0x411543-lastIpApproval<0x1388)_0x4a3012=!![];}lastIpApproval=new Date();if(_0x4a3012)return;tgBot&&settings[_0xde0f41(0x2d5)]&&(tgBot[_0xde0f41(0x29c)](_0xde0f41(0x294)),tgBot['sendMessage'](settings['telegramChatId'],_0xde0f41(0x24f)+normalizeIP(_0x240837)[_0xde0f41(0x242)]+_0xde0f41(0x296),{'parse_mode':_0xde0f41(0x28b),'reply_markup':{'inline_keyboard':[[{'text':_0xde0f41(0x2d2),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0xde0f41(0x3b3),'callback_data':'30'},{'text':_0xde0f41(0x32f),'callback_data':'reject'}]]}})[_0xde0f41(0x2ed)](_0x37b4fa=>{telegramError(_0x37b4fa);}),tgBot['on'](_0xde0f41(0x294),async _0x12fddc=>{const _0x5dc32c=_0xde0f41,_0x4095d7=_0x12fddc[_0x5dc32c(0x218)],_0x2123a3=_0x12fddc['message'];tgBot['answerCallbackQuery'](_0x12fddc['id'])[_0x5dc32c(0x3a0)](async()=>{const _0x1c0566=_0x5dc32c;devices[_0x183e25][_0x1c0566(0x39f)]={'clientip':_0x240837,'timestamp':new Date()[_0x1c0566(0x2ba)](),'expiry':_0x4095d7},_0x4095d7!='reject'?(await tgBot[_0x1c0566(0x311)](_0x2123a3['chat']['id'],_0x1c0566(0x250)+_0x4095d7+'\x20minutes',{'parse_mode':_0x1c0566(0x28b)})[_0x1c0566(0x2ed)](_0x4ad236=>{telegramError(_0x4ad236);}),io['to'](_0x183e25)[_0x1c0566(0x2de)](_0x1c0566(0x2d4),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot['sendMessage'](_0x2123a3[_0x1c0566(0x3c1)]['id'],'Temporary\x20access\x20rejected')['catch'](_0x5a3eca=>{telegramError(_0x5a3eca);}),io['to'](_0x183e25)[_0x1c0566(0x2de)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x5dc32c(0x29c)]('callback_query');}));}function loginAccess2FA(_0x48f8d0,_0x338905){const _0x5ed525=_0x385116;tgBot&&settings['telegramChatId']&&(tgBot[_0x5ed525(0x29c)](_0x5ed525(0x294)),tgBot[_0x5ed525(0x311)](settings[_0x5ed525(0x2d5)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x338905)[_0x5ed525(0x242)]+_0x5ed525(0x296),{'parse_mode':_0x5ed525(0x28b),'reply_markup':{'inline_keyboard':[[{'text':_0x5ed525(0x2c7),'callback_data':loginExpiry},{'text':'reject','callback_data':'reject'}]]}})[_0x5ed525(0x2ed)](_0xbc62e1=>{telegramError(_0xbc62e1);}),tgBot['on']('callback_query',async _0x414ace=>{const _0x1a2e19=_0x5ed525,_0x4092a4=_0x414ace[_0x1a2e19(0x218)],_0x466b44=_0x414ace[_0x1a2e19(0x342)];tgBot[_0x1a2e19(0x38b)](_0x414ace['id'])[_0x1a2e19(0x3a0)](async()=>{const _0x4ab1bf=_0x1a2e19;devices[_0x48f8d0][_0x4ab1bf(0x3a1)]={'clientip':_0x338905,'timestamp':new Date()[_0x4ab1bf(0x2ba)](),'expiry':_0x4092a4},_0x4092a4!=_0x4ab1bf(0x32f)?(await tgBot[_0x4ab1bf(0x311)](_0x466b44[_0x4ab1bf(0x3c1)]['id'],_0x4ab1bf(0x3c3),{'parse_mode':'HTML'})[_0x4ab1bf(0x2ed)](_0x5c4926=>{telegramError(_0x5c4926);}),io['to'](_0x48f8d0)[_0x4ab1bf(0x2de)](_0x4ab1bf(0x2d4),{'access':{'allow':![],'reason':_0x4ab1bf(0x21d),'token':null}})):(await tgBot['sendMessage'](_0x466b44['chat']['id'],_0x4ab1bf(0x1ff))['catch'](_0x4449fe=>{telegramError(_0x4449fe);}),io['to'](_0x48f8d0)['emit']('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot['removeListener'](_0x1a2e19(0x294));}));}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1e266f=_0x385116;return dbConfig[_0x1e266f(0x26e)](_0x1e266f(0x30b))[_0x1e266f(0x2b5)](_0x1e266f(0x251))[_0x1e266f(0x3a5)]({'status':'enabled'})[_0x1e266f(0x21c)]()||[];}function getDisabledBots(){const _0x116fb8=_0x385116;return dbConfig[_0x116fb8(0x26e)]('bots')[_0x116fb8(0x2b5)]('botID')['filter']({'status':_0x116fb8(0x360)})['value']()||[];}function getBotAttributes(_0x47bc22){const _0xf80fe2=_0x385116;let _0x4176d4={};const _0xa93e30=configpath+'bot-'+_0x47bc22+_0xf80fe2(0x2a2),_0x83920c=fs[_0xf80fe2(0x1f0)](_0xa93e30);if(_0x83920c){const _0x488d5d=fs[_0xf80fe2(0x2fc)](_0xa93e30);try{const _0x22b6bb=JSON[_0xf80fe2(0x322)](_0x488d5d),_0x647ce1=_0x22b6bb?_0x22b6bb[_0xf80fe2(0x271)][0x0][_0xf80fe2(0x238)]:![];_0x4176d4[_0xf80fe2(0x1fb)]=_0x647ce1?'auto':_0xf80fe2(0x326),_0x4176d4[_0xf80fe2(0x35a)]=_0x22b6bb?_0x22b6bb[_0xf80fe2(0x271)][0x0][_0xf80fe2(0x35a)]:'Bot\x20'+_0x47bc22;}catch(_0x3bd177){_0x4176d4[_0xf80fe2(0x1fb)]='manual',_0x4176d4[_0xf80fe2(0x35a)]=_0xf80fe2(0x36e)+_0x47bc22;}}else _0x4176d4[_0xf80fe2(0x1fb)]='manual',_0x4176d4['botname']=_0xf80fe2(0x36e)+_0x47bc22;return _0x4176d4;}function getBotsWithMode(){const _0x5b26de=_0x385116,_0x3c8365=dbConfig[_0x5b26de(0x26e)](_0x5b26de(0x30b))[_0x5b26de(0x2b5)]('botID')['value']()||[];return _0x3c8365[_0x5b26de(0x2b8)](_0x4df930=>{const _0x294d82=_0x5b26de;let _0x22dbae=getBotAttributes(_0x4df930[_0x294d82(0x251)]);_0x4df930['mode']=_0x22dbae[_0x294d82(0x1fb)];}),_0x3c8365;}function getBotExchanges(){const _0x4f5352=_0x385116;let _0xeb41bf=[];const _0x2f7d23=dbConfig['get'](_0x4f5352(0x30b))[_0x4f5352(0x2b5)](_0x4f5352(0x251))[_0x4f5352(0x21c)]()||[];_0x2f7d23[_0x4f5352(0x2b8)](_0x2981c7=>{const _0x51fd1b=_0x4f5352;if(_0x2981c7['status']==_0x51fd1b(0x22a)){const _0x4a651b=configpath+'bot-'+_0x2981c7[_0x51fd1b(0x251)]+'-config.json',_0x3b85d4=fs[_0x51fd1b(0x1f0)](_0x4a651b);let _0x2cd8d3;if(_0x3b85d4){const _0x3253b1=fs[_0x51fd1b(0x2fc)](_0x4a651b);try{const _0x21f5ed=JSON['parse'](_0x3253b1);_0x2cd8d3=_0x21f5ed?_0x21f5ed[_0x51fd1b(0x271)][0x0][_0x51fd1b(0x220)]:null;}catch(_0x273f51){}}if(_0x2cd8d3)_0xeb41bf[_0x51fd1b(0x2cd)](_0x2cd8d3);}});const _0x584891=[...new Set(_0xeb41bf)]['sort']();return _0x584891;}async function initUser(){const _0x14872f=_0x385116;if(!settings[_0x14872f(0x244)]){const _0x782103=uuidRandom();mixpanel[_0x14872f(0x25f)](_0x782103),updateSetting('userid',_0x782103);}}async function initSecure(){const _0x16439=_0x385116;let _0x459c57=getSecure();if(!_0x459c57[_0x16439(0x315)]('secret')){let _0x52ec09=await generateKeys();_0x459c57[_0x16439(0x32b)]=_0x52ec09[_0x16439(0x32b)],_0x459c57[_0x16439(0x2e1)]=_0x52ec09['privateKey'],_0x459c57[_0x16439(0x39c)]=crypto[_0x16439(0x36d)](0x20)[_0x16439(0x30c)]('hex');;storeSecure(_0x459c57);}}function getSettings(){const _0x2f644e=_0x385116;return dbSettings[_0x2f644e(0x26e)](_0x2f644e(0x281))[_0x2f644e(0x21c)]()||{};}function getSecure(){const _0x22c5ed=_0x385116;return dbSecure[_0x22c5ed(0x26e)](_0x22c5ed(0x1f4))[_0x22c5ed(0x21c)]()||{};}function getBlacklist(){const _0x450acd=_0x385116;return dbSecure['get'](_0x450acd(0x3a3))[_0x450acd(0x21c)]()||[];}function broadcastToBots(_0x1bc69e,_0x1b6fe8){config['forEach'](_0x1d4583=>{const _0x1ab55a=_0x24f4;if(_0x1d4583[_0x1ab55a(0x2d4)]==_0x1ab55a(0x22a)&&_0x1d4583[_0x1ab55a(0x2a0)]==_0x1ab55a(0x214)||_0x1d4583[_0x1ab55a(0x2d4)]==_0x1ab55a(0x320)&&_0x1d4583[_0x1ab55a(0x2a0)]==_0x1ab55a(0x214)){if(pid[_0x1d4583[_0x1ab55a(0x251)]])pid[_0x1d4583[_0x1ab55a(0x251)]]['send']({[_0x1bc69e]:_0x1b6fe8});}});}function storeSettings(_0x78283d,_0x3585ac=![]){const _0x444472=_0x385116;_0x78283d={...settings,..._0x78283d};if(_0x3585ac&&_0x78283d[_0x444472(0x30f)]!='************'&&_0x78283d['bbPassword']!=_0x444472(0x3a7)&&_0x78283d[_0x444472(0x30f)]!=''){const _0x2866c0=crypt[_0x444472(0x1f7)](secure[_0x444472(0x2e1)],_0x78283d[_0x444472(0x30f)])['message']['split']('@')[0x0],_0x3f8c62=bcrypt['hashSync'](_0x2866c0,saltRounds);_0x78283d={..._0x78283d,'bbPassword':_0x3f8c62};}if(_0x3585ac&&_0x78283d[_0x444472(0x247)]!=_0x444472(0x335)&&_0x78283d['telegramToken']!=_0x444472(0x3a7)&&_0x78283d[_0x444472(0x247)]!=''){const _0x2248a5=crypt['decrypt'](secure[_0x444472(0x2e1)],_0x78283d['telegramToken'])[_0x444472(0x342)][_0x444472(0x1fc)]('@')[0x0];_0x78283d={..._0x78283d,'telegramToken':_0x2248a5};}const _0x3ba935=_0x78283d[_0x444472(0x247)]!='************'&&_0x78283d['telegramToken']!=settings['telegramToken']||_0x78283d[_0x444472(0x3b5)]!=settings[_0x444472(0x3b5)],_0x49cc68=_0x78283d[_0x444472(0x247)]==''||_0x78283d[_0x444472(0x3b5)]=='';if(_0x3ba935)_0x78283d[_0x444472(0x35c)]=_0x444472(0x234);for(const [_0x3890c3,_0x43c190]of Object[_0x444472(0x357)](_0x78283d)){if(_0x3890c3==_0x444472(0x247)&&_0x43c190==_0x444472(0x335)){_0x78283d[_0x444472(0x247)]=settings[_0x444472(0x247)];continue;};if(_0x3890c3==_0x444472(0x30f)&&_0x43c190==_0x444472(0x335)){_0x78283d[_0x444472(0x30f)]=settings['bbPassword'];continue;};dbSettings[_0x444472(0x341)](_0x444472(0x2f4)+_0x3890c3,_0x43c190)['write']();}settings=_0x78283d,io['to']('botmanager')['emit'](_0x444472(0x281),cleanSettings()),broadcastToBots(_0x444472(0x233),settings[_0x444472(0x233)]),broadcastToBots(_0x444472(0x34c),settings['onepagemode']);if(_0x3ba935&&!_0x49cc68)initTelegram();if(_0x3ba935&&_0x49cc68)disableTelegram();getAllClients()[_0x444472(0x2b8)](_0x5a1416=>{const _0x513841=_0x444472;getSocket(_0x5a1416['id'])[_0x513841(0x2de)](_0x513841(0x2d4),{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x21bff2,_0x227f07){const _0x4e6801=_0x385116;dbSettings[_0x4e6801(0x341)](_0x4e6801(0x2f4)+_0x21bff2,_0x227f07)[_0x4e6801(0x388)](),settings=getSettings(),io['to'](_0x4e6801(0x288))[_0x4e6801(0x2de)](_0x4e6801(0x281),cleanSettings());}function storeSecure(_0x5e2471){const _0x47abad=_0x385116;dbSecure[_0x47abad(0x26e)](_0x47abad(0x1f4))[_0x47abad(0x2cd)](_0x5e2471)[_0x47abad(0x388)](),secure=_0x5e2471;}function addBlacklist(_0x4c74d3){const _0x344b0b=_0x385116;cleanBlacklist();let _0x127b08;devices[_0x4c74d3][_0x344b0b(0x39f)]?_0x127b08=Math[_0x344b0b(0x2c4)](devices[_0x4c74d3][_0x344b0b(0x39f)][_0x344b0b(0x248)],loginExpiry):_0x127b08=loginExpiry,dbSecure[_0x344b0b(0x26e)](_0x344b0b(0x3a3))[_0x344b0b(0x2cd)]({'expiry':new Date()[_0x344b0b(0x2ba)]()+_0x127b08*0x3c*0x3e8,'token':devices[_0x4c74d3][_0x344b0b(0x210)][_0x344b0b(0x3b2)]})['write'](),blacklist=dbSecure['get']('blacklist')[_0x344b0b(0x21c)]();}function cleanBlacklist(){const _0x50f7a1=_0x385116;let _0x17a4c9=dbSecure['get'](_0x50f7a1(0x3a3))[_0x50f7a1(0x1f8)]()['value'](),_0x5af7f7=new Date()[_0x50f7a1(0x2ba)]();_0x17a4c9['forEach'](_0x1356ff=>{const _0x4092cd=_0x50f7a1;_0x1356ff[_0x4092cd(0x248)]<_0x5af7f7&&dbSecure[_0x4092cd(0x26e)](_0x4092cd(0x3a3))[_0x4092cd(0x253)]({'expiry':_0x1356ff['expiry']})[_0x4092cd(0x388)]();});}function initStates(){const _0x21ffce=_0x385116;let _0x16a40d=getConfiguration();_0x16a40d[_0x21ffce(0x2b8)](_0x13f17d=>{const _0x3c5351=_0x21ffce;_0x13f17d[_0x3c5351(0x2a0)]=_0x3c5351(0x23d);}),storeConfiguration(_0x16a40d);}function onKeys(){const _0x17317a=new RSA();return new Promise(_0x31d9b4=>{_0x17317a['generateKeyPairAsync']()['then'](_0x105130=>{_0x31d9b4(_0x105130);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0xb23c7d=_0x385116;let _0x32875a=getSettings(),_0x5b8f15=![];!_0x32875a[_0xb23c7d(0x315)]('lastmsgtelegram')&&(_0x32875a[_0xb23c7d(0x24d)]=0x0,_0x5b8f15=!![]);!_0x32875a[_0xb23c7d(0x315)](_0xb23c7d(0x2f8))&&(_0x32875a[_0xb23c7d(0x2f8)]=0x0,_0x5b8f15=!![]);!_0x32875a[_0xb23c7d(0x315)]('latestversion')&&(_0x32875a[_0xb23c7d(0x2e9)]=_0xb23c7d(0x38e),_0x5b8f15=!![]);!_0x32875a[_0xb23c7d(0x315)](_0xb23c7d(0x34c))&&(_0x32875a[_0xb23c7d(0x34c)]=![],_0x5b8f15=!![]);if(_0x5b8f15)storeSettings(_0x32875a);}function storeConfiguration(_0x29eada){const _0x473b3d=_0x385116;dbConfig[_0x473b3d(0x26e)](_0x473b3d(0x30b))[_0x473b3d(0x253)]()[_0x473b3d(0x388)](),_0x29eada[_0x473b3d(0x2b8)](_0x5aafe9=>{delete _0x5aafe9['mode'];}),dbConfig[_0x473b3d(0x26e)](_0x473b3d(0x30b))[_0x473b3d(0x2cd)](..._0x29eada)[_0x473b3d(0x388)](),config=_0x29eada;}function resetPassword(){const _0x4baf27=_0x385116;tgBot&&settings['telegramChatId']&&(tgBot[_0x4baf27(0x29c)](_0x4baf27(0x294)),tgBot[_0x4baf27(0x311)](settings[_0x4baf27(0x2d5)],_0x4baf27(0x2c0),{'parse_mode':_0x4baf27(0x28b),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x4baf27(0x2ed)](_0x702ac4=>{telegramError(_0x702ac4);}),tgBot['on'](_0x4baf27(0x294),async _0xaab3fc=>{const _0x2496a5=_0x4baf27,_0x5efff0=_0xaab3fc[_0x2496a5(0x218)],_0x4f296a=_0xaab3fc['message'];tgBot[_0x2496a5(0x38b)](_0xaab3fc['id'])[_0x2496a5(0x3a0)](async()=>{const _0xc297e7=_0x2496a5;if(_0x5efff0!='no'){const _0x473ac3=0xf,_0x2f52ae=_0xc297e7(0x2b1),_0x2d7257=Array[_0xc297e7(0x27f)](crypto[_0xc297e7(0x399)](new Uint32Array(_0x473ac3)))[_0xc297e7(0x2f5)](_0x601acb=>_0x2f52ae[_0x601acb%_0x2f52ae[_0xc297e7(0x3ad)]])[_0xc297e7(0x2ab)](''),_0x5c7ece=bcrypt[_0xc297e7(0x261)](_0x2d7257,saltRounds);storeSettings({'bbPassword':_0x5c7ece}),await tgBot[_0xc297e7(0x311)](_0x4f296a['chat']['id'],_0xc297e7(0x327)+_0x2d7257,{'parse_mode':_0xc297e7(0x28b)})['catch'](_0x207647=>{telegramError(_0x207647);});}else await tgBot['sendMessage'](_0x4f296a['chat']['id'],_0xc297e7(0x36f))[_0xc297e7(0x2ed)](_0x3d1e4d=>{telegramError(_0x3d1e4d);});}),tgBot[_0x2496a5(0x29c)](_0x2496a5(0x294));}));}async function confirmRestore(_0x1b41a9,_0x30b014){const _0x46e443=_0x385116;io['to']('botmanager')[_0x46e443(0x2de)]('notification',_0x46e443(0x362),_0x46e443(0x263)),tgBot&&settings['telegramChatId']&&(tgBot[_0x46e443(0x29c)](_0x46e443(0x294)),await tgBot[_0x46e443(0x311)](settings[_0x46e443(0x2d5)],_0x46e443(0x345),{'parse_mode':_0x46e443(0x28b),'reply_markup':{'inline_keyboard':[[{'text':_0x46e443(0x34d),'callback_data':'yes'},{'text':'no','callback_data':'no'}]]}})[_0x46e443(0x2ed)](_0x480294=>{telegramError(_0x480294);}),tgBot['on'](_0x46e443(0x294),async _0x1e159c=>{const _0x467899=_0x46e443,_0x5bff5c=_0x1e159c['data'],_0x43b251=_0x1e159c[_0x467899(0x342)];tgBot[_0x467899(0x38b)](_0x1e159c['id'])['then'](async()=>{const _0x20a825=_0x467899;_0x5bff5c=='yes'?(await tgBot['sendMessage'](_0x43b251[_0x20a825(0x3c1)]['id'],_0x20a825(0x3a9),{'parse_mode':'HTML'})[_0x20a825(0x2ed)](_0x5f179f=>{telegramError(_0x5f179f);}),unzipFile(_0x1b41a9,_0x30b014)):(logger[_0x20a825(0x31a)](_0x20a825(0x364)),await tgBot[_0x20a825(0x311)](_0x43b251[_0x20a825(0x3c1)]['id'],_0x20a825(0x364))[_0x20a825(0x2ed)](_0x468eeb=>{telegramError(_0x468eeb);}));}),tgBot[_0x467899(0x29c)](_0x467899(0x294));}));}function getServerTime(){const _0xe9274a=_0x385116,_0x19e49d=new Date();return _0x19e49d[_0xe9274a(0x3aa)]()+'/'+(_0x19e49d[_0xe9274a(0x223)]()+0x1)[_0xe9274a(0x30c)]()['padStart'](0x2,'0')+'/'+_0x19e49d[_0xe9274a(0x2f6)]()[_0xe9274a(0x30c)]()[_0xe9274a(0x25b)](0x2,'0')+'\x20'+_0x19e49d['getHours']()[_0xe9274a(0x30c)]()[_0xe9274a(0x25b)](0x2,'0')+':'+_0x19e49d[_0xe9274a(0x229)]()[_0xe9274a(0x30c)]()['padStart'](0x2,'0')+':'+_0x19e49d['getSeconds']()['toString']()[_0xe9274a(0x25b)](0x2,'0');}function getTimeStamp(){const _0x3b10c8=_0x385116,_0x1a4370=shiftedTime();return _0x1a4370['getFullYear']()+'/'+(_0x1a4370[_0x3b10c8(0x223)]()+0x1)[_0x3b10c8(0x30c)]()[_0x3b10c8(0x25b)](0x2,'0')+'/'+_0x1a4370['getDate']()[_0x3b10c8(0x30c)]()[_0x3b10c8(0x25b)](0x2,'0')+'\x20'+_0x1a4370[_0x3b10c8(0x35e)]()[_0x3b10c8(0x30c)]()[_0x3b10c8(0x25b)](0x2,'0')+':'+_0x1a4370[_0x3b10c8(0x229)]()[_0x3b10c8(0x30c)]()[_0x3b10c8(0x25b)](0x2,'0')+':'+_0x1a4370[_0x3b10c8(0x207)]()[_0x3b10c8(0x30c)]()[_0x3b10c8(0x25b)](0x2,'0');}function getCleanTimeStamp(){const _0xd648ee=_0x385116,_0x12c1cc=shiftedTime();return _0x12c1cc[_0xd648ee(0x3aa)]()+(_0x12c1cc['getMonth']()+0x1)[_0xd648ee(0x30c)]()[_0xd648ee(0x25b)](0x2,'0')+_0x12c1cc['getDate']()[_0xd648ee(0x30c)]()[_0xd648ee(0x25b)](0x2,'0')+'-'+_0x12c1cc[_0xd648ee(0x35e)]()[_0xd648ee(0x30c)]()[_0xd648ee(0x25b)](0x2,'0')+_0x12c1cc[_0xd648ee(0x229)]()[_0xd648ee(0x30c)]()['padStart'](0x2,'0')+_0x12c1cc['getSeconds']()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0x48b638=_0x385116,_0xd75c91=new Date();let _0x65b444=_0xd75c91;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x65b444=fns[_0x48b638(0x23c)](_0xd75c91,{'hours':settings[_0x48b638(0x233)]});return _0x65b444;}function startScheduler(){const _0x1c90d6=_0x385116,_0x205aa2=new Date()[_0x1c90d6(0x332)](),_0x47bcde=shiftedTime()['getHours']();_0x47bcde==0x4&&backupConfigFiles();_0x47bcde==0x0&&rotateLogFiles();_0x205aa2%0x6==0x0&&triggerAnalytics();_0x205aa2%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x131a0f){const _0x1c28de=_0x385116;logger['debug']('Restore\x20backup\x20file\x20'+_0x131a0f);const _0x34831e=getBotsWithMode();_0x34831e[_0x1c28de(0x3ad)]>0x0?confirmRestore(configbackuppath,_0x131a0f):unzipFile(configbackuppath,_0x131a0f);}async function getBackupFiles(_0x364d05=null){const _0x5731a0=_0x385116;let _0x16cb4c=[],_0xa0f6e4=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0xa0f6e4[_0x5731a0(0x26b)]((_0x3efd85,_0x401c42)=>_0x3efd85[_0x5731a0(0x308)]<_0x401c42[_0x5731a0(0x308)]?0x1:_0x401c42[_0x5731a0(0x308)]<_0x3efd85[_0x5731a0(0x308)]?-0x1:0x0),_0xa0f6e4[_0x5731a0(0x2b8)](_0x3d327f=>{const _0x59ae24=_0x5731a0;if(!_0x3d327f[_0x59ae24(0x270)]()&&_0x3d327f[_0x59ae24(0x308)][_0x59ae24(0x37d)](_0x59ae24(0x33e))&&_0x3d327f[_0x59ae24(0x308)]['endsWith'](_0x59ae24(0x25a))){const _0x5546a8=formatDate(fs[_0x59ae24(0x3bc)](configbackuppath+_0x3d327f[_0x59ae24(0x308)])[_0x59ae24(0x298)]);_0x16cb4c[_0x59ae24(0x2cd)]({'name':_0x3d327f[_0x59ae24(0x308)],'mtime':_0x5546a8});}});if(_0x364d05)io['to'](_0x364d05)[_0x5731a0(0x2de)](_0x5731a0(0x2ad),_0x16cb4c);else return _0x16cb4c;}function _0x24f4(_0x430cdc,_0x3061e9){const _0x3d2687=_0x4748();return _0x24f4=function(_0x16f938,_0x3da4d0){_0x16f938=_0x16f938-0x1ec;let _0x474814=_0x3d2687[_0x16f938];return _0x474814;},_0x24f4(_0x430cdc,_0x3061e9);}async function backupConfigFiles(){const _0x5d965e=_0x385116;await zipFiles(_0x5d965e(0x258));const _0x54c8d0=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x5d965e(0x2c1),configbackuppath+(_0x5d965e(0x33e)+_0x54c8d0+_0x5d965e(0x25a)));let _0x63994e=fs[_0x5d965e(0x2c5)](configbackuppath,{'withFileTypes':!![]});_0x63994e['sort']((_0x51e1cb,_0x50f640)=>_0x51e1cb[_0x5d965e(0x308)]<_0x50f640[_0x5d965e(0x308)]?0x1:_0x50f640[_0x5d965e(0x308)]<_0x51e1cb[_0x5d965e(0x308)]?-0x1:0x0),_0x63994e[_0x5d965e(0x3ad)]>maxBackups&&fs[_0x5d965e(0x3b6)](configbackuppath+_0x63994e[maxBackups]['name']);}function rotateLogFiles(){const _0x30f1c3=_0x385116,_0x6cabac=fs['statSync'](logspath+_0x30f1c3(0x2db)),_0x236b7a=_0x6cabac[_0x30f1c3(0x273)]/0x400;if(_0x236b7a>0x64){let _0x41662f=fs[_0x30f1c3(0x2c5)](logspath,{'withFileTypes':!![]});_0x41662f[_0x30f1c3(0x26b)]((_0x37def8,_0x1dc808)=>_0x37def8[_0x30f1c3(0x308)]<_0x1dc808['name']?0x1:_0x1dc808[_0x30f1c3(0x308)]<_0x37def8[_0x30f1c3(0x308)]?-0x1:0x0),_0x41662f[_0x30f1c3(0x2b8)](_0x334643=>{const _0x584f04=_0x30f1c3;if(_0x334643['name']==_0x584f04(0x219))fs[_0x584f04(0x286)](logspath+_0x334643[_0x584f04(0x308)],logspath+_0x584f04(0x24a));if(_0x334643[_0x584f04(0x308)]=='output-001.log')fs[_0x584f04(0x286)](logspath+_0x334643[_0x584f04(0x308)],logspath+_0x584f04(0x219));_0x334643[_0x584f04(0x308)]==_0x584f04(0x2db)&&(fs[_0x584f04(0x286)](logspath+_0x334643['name'],logspath+_0x584f04(0x3b1)),fs[_0x584f04(0x283)](logspath+_0x334643[_0x584f04(0x308)],''));});}}async function zipFiles(_0x341517){const _0x298cb7=_0x385116;let _0x27cafa;if(_0x341517==_0x298cb7(0x30d))_0x27cafa=logspath;if(_0x341517==_0x298cb7(0x1f2))_0x27cafa=configpath;if(_0x341517==_0x298cb7(0x258))_0x27cafa=configpath;let _0x4cf1bb=fs[_0x298cb7(0x2c5)](_0x27cafa,{'withFileTypes':!![]});const _0x30c79b=new require(_0x298cb7(0x284))();_0x4cf1bb['forEach'](_0x10fc5a=>{const _0x1fc5cd=_0x298cb7;if(!_0x10fc5a[_0x1fc5cd(0x270)]()){let _0x2d96e8=fs[_0x1fc5cd(0x2fc)](_0x27cafa+_0x10fc5a[_0x1fc5cd(0x308)]);if(_0x341517==_0x1fc5cd(0x1f2)){const _0x1d1c16=/^bot-[0-9]{3}-config.json$/,_0x3da2a1=_0x1d1c16[_0x1fc5cd(0x378)](_0x10fc5a[_0x1fc5cd(0x308)]);if(_0x3da2a1){const _0x1bdffa=JSON[_0x1fc5cd(0x322)](_0x2d96e8);if(_0x1bdffa[_0x1fc5cd(0x271)][0x0]){_0x1bdffa['bot'][0x0][_0x1fc5cd(0x347)]=_0x1fc5cd(0x3a7),_0x1bdffa[_0x1fc5cd(0x271)][0x0][_0x1fc5cd(0x328)]=_0x1fc5cd(0x3a7);if(_0x1bdffa[_0x1fc5cd(0x271)][0x0][_0x1fc5cd(0x3a6)])_0x1bdffa['bot'][0x0]['apiPassword']=_0x1fc5cd(0x3a7);}_0x2d96e8=JSON[_0x1fc5cd(0x2e2)](_0x1bdffa,null,0x2);}if(_0x10fc5a[_0x1fc5cd(0x308)]=='bb-settings.json'){const _0x2a2537=JSON[_0x1fc5cd(0x322)](_0x2d96e8);if(_0x2a2537[_0x1fc5cd(0x281)][_0x1fc5cd(0x312)])_0x2a2537[_0x1fc5cd(0x281)]['loginRequired']=![];if(_0x2a2537['settings'][_0x1fc5cd(0x30f)])_0x2a2537[_0x1fc5cd(0x281)][_0x1fc5cd(0x30f)]=_0x1fc5cd(0x3a7);if(_0x2a2537[_0x1fc5cd(0x281)]['telegramToken'])_0x2a2537['settings'][_0x1fc5cd(0x247)]=_0x1fc5cd(0x3a7);if(_0x2a2537['settings'][_0x1fc5cd(0x2d5)])_0x2a2537[_0x1fc5cd(0x281)]['telegramChatId']=null;_0x2d96e8=JSON[_0x1fc5cd(0x2e2)](_0x2a2537,null,0x2);}if(_0x10fc5a[_0x1fc5cd(0x308)]!='bb-secure.json')_0x30c79b[_0x1fc5cd(0x2f1)](_0x10fc5a[_0x1fc5cd(0x308)],_0x2d96e8);}else _0x30c79b['file'](_0x10fc5a['name'],_0x2d96e8);}});const _0x20d61a=_0x30c79b[_0x298cb7(0x2d3)]({'base64':![],'compression':_0x298cb7(0x26c)});fs[_0x298cb7(0x283)](zippath+(_0x341517+'.zip'),_0x20d61a,_0x298cb7(0x366));}async function unzipFile(_0x4744ef,_0x1e33cc){const _0x36c3b5=_0x385116;fs[_0x36c3b5(0x2c5)](configpath,{'withFileTypes':!![]})[_0x36c3b5(0x2b8)](_0x37a24f=>{const _0x5ab8a1=_0x36c3b5;if(!_0x37a24f[_0x5ab8a1(0x270)]())fs[_0x5ab8a1(0x3a4)](configpath+_0x37a24f['name']);});const _0x3d59bf=fs[_0x36c3b5(0x2fc)](_0x4744ef+_0x1e33cc,_0x36c3b5(0x366)),_0x3e379b=new require(_0x36c3b5(0x284))(_0x3d59bf,{'base64':![],'checkCRC32':!![]});Object[_0x36c3b5(0x22c)](_0x3e379b[_0x36c3b5(0x352)])[_0x36c3b5(0x2b8)](_0x4c4be7=>{const _0x4be5ee=_0x36c3b5,_0x36c285=_0x3e379b[_0x4be5ee(0x352)][_0x4c4be7];fs[_0x4be5ee(0x283)](configpath+_0x36c285[_0x4be5ee(0x308)],_0x36c285['_data']);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x36c3b5(0x2b8)](_0x5e1a67=>{const _0x13e051=_0x36c3b5;if(!_0x5e1a67['isDirectory']())fs['rmSync'](temppath+_0x5e1a67[_0x13e051(0x308)]);}),logger[_0x36c3b5(0x31a)](_0x36c3b5(0x31d)),process[_0x36c3b5(0x2da)]({'restore':!![]},_0xf4e7f6=>{});}async function getPublicIp(){const _0x100322=_0x385116;try{const _0x4d4726=await axios['get'](_0x100322(0x20d));publicip=_0x4d4726['data']['ip'];}catch(_0x2e6d7c){}}async function triggerAnalytics(){const _0x56291f=_0x385116;if(!publicip)await getPublicIp();const _0x16024e=getBotsWithMode();let _0x5c04e0=0x0;_0x16024e[_0x56291f(0x2b8)](_0x5b6fa4=>{const _0x33c66c=_0x56291f;if(_0x5b6fa4[_0x33c66c(0x2d4)]===_0x33c66c(0x22a))_0x5c04e0++;});const _0x915f1d=getBotExchanges();mixpanel['track']('Server',{'distinct_id':settings[_0x56291f(0x244)],'ip':publicip,'version':serverversion,'numbots':_0x16024e['length'],'numbotsenabled':_0x5c04e0,'exchanges':_0x915f1d});}async function getMessages(){const _0x574035=_0x385116,_0x44ddb0=_0x574035(0x35d),_0x5a224e=new GraphQLClient(_0x44ddb0),_0x1915b9={'authorization':_0x574035(0x212)},_0x55e6a9=serverversion[_0x574035(0x1fc)]('.'),_0x4eff2d=_0x55e6a9[0x0]+'.'+_0x55e6a9[0x1],_0x37a2a5=Math[_0x574035(0x2f7)](settings[_0x574035(0x24d)],settings['lastmsgemitted']),_0x265e6e={'last':parseInt(_0x37a2a5),'bbm':_0x4eff2d},_0x1e64be=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1dbe0e;try{_0x1dbe0e=await _0x5a224e[_0x574035(0x27a)](_0x1e64be,_0x265e6e,_0x1915b9);}catch(_0x436ee7){}if(_0x1dbe0e&&_0x1dbe0e[_0x574035(0x310)]){let _0x5d9f33=settings[_0x574035(0x24d)];newMessages=[];for(const _0x34f434 of _0x1dbe0e[_0x574035(0x310)]){newMessages[_0x574035(0x2cd)](_0x34f434);if(_0x34f434[_0x574035(0x2f9)])updateSetting('latestversion',_0x34f434[_0x574035(0x2f9)]);let _0x3304ed=_0x34f434[_0x574035(0x2f9)]?serverversion>=_0x34f434[_0x574035(0x2f9)]:![];if(!_0x3304ed&&_0x34f434[_0x574035(0x245)]>_0x5d9f33){if(_0x34f434[_0x574035(0x23b)]==='any'||serverversion[_0x574035(0x37d)](_0x34f434[_0x574035(0x23b)])){let _0x221362=''+_0x34f434[_0x574035(0x235)]+'\x0a\x0a'+_0x34f434[_0x574035(0x342)];const _0x2d4bd6=await sendTelegramMsg(toTelegramMarkdown(_0x221362),_0x574035(0x2a8));if(_0x2d4bd6)_0x5d9f33=_0x34f434['number'];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x574035(0x24d),_0x5d9f33),emitMessages();}}function emitMessages(){const _0x77d68a=_0x385116,_0x53d702=settings['lastmsgemitted'];let _0x3a99d5=[];newMessages[_0x77d68a(0x2b8)](_0x4303e0=>{const _0x1cfd44=_0x77d68a;_0x4303e0[_0x1cfd44(0x245)]>_0x53d702&&_0x3a99d5[_0x1cfd44(0x2cd)](_0x4303e0);}),_0x3a99d5[_0x77d68a(0x3ad)]>0x0&&getAllClients()[_0x77d68a(0x2b8)](_0x1e4e80=>{getSocket(_0x1e4e80['id'])['emit']('message',_0x3a99d5);});}function confirmMessage(_0x4f0eb6){const _0x2e49b0=_0x385116;updateSetting(_0x2e49b0(0x2f8),Number(_0x4f0eb6));}function isNewerVersion(_0x2e717f,_0xf8f836){const _0x19ffb2=_0x385116,_0x3ac715=_0xf8f836[_0x19ffb2(0x1fc)]('.'),_0x46cfc9=_0x2e717f[_0x19ffb2(0x1fc)]('.');for(var _0xa2cac6=0x0;_0xa2cac6<_0x46cfc9[_0x19ffb2(0x3ad)];_0xa2cac6++){const _0x287775=~~_0x46cfc9[_0xa2cac6],_0x4578d2=~~_0x3ac715[_0xa2cac6];if(_0x287775>_0x4578d2)return!![];if(_0x287775<_0x4578d2)return![];}return![];}function toTelegramMarkdown(_0x1a62b9){const _0x1a0b64=_0x385116,_0x47a201=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3ecebe=/\*{2}(.+?)\*{2}/gim;return _0x1a62b9=_0x1a62b9[_0x1a0b64(0x29e)](_0x47a201,_0x1a0b64(0x3b8))['replace'](_0x3ecebe,_0x1a0b64(0x202)),_0x1a62b9;}async function validateConfigFile(){const _0x264a69=_0x385116,_0x4413d8=dbConfig[_0x264a69(0x26e)](_0x264a69(0x30b))['sortBy'](_0x264a69(0x251))[_0x264a69(0x21c)]()||[];if(_0x4413d8[_0x264a69(0x3ad)]==0x0){let _0x4dd142=0x0,_0x4e2ee7=[];const _0x5964c1=/^bot-([0-9]{3})-config.json$/,_0x371deb=fs[_0x264a69(0x2c5)](configpath);_0x371deb[_0x264a69(0x2b8)](_0x3460d7=>{const _0x1c5fbd=_0x264a69,_0x312c13=_0x5964c1['exec'](_0x3460d7);if(_0x312c13){const _0xb89380=_0x312c13[0x1];let _0x41c901=getBotAttributes(_0xb89380);_0x4e2ee7[_0x1c5fbd(0x2cd)]({'botID':_0xb89380,'botname':_0x41c901['botname'],'status':_0x1c5fbd(0x360),'live':_0x1c5fbd(0x23d)}),_0x4dd142++;}}),_0x4dd142!=0x0&&(dbConfig['get'](_0x264a69(0x30b))[_0x264a69(0x343)](_0x4e2ee7)[_0x264a69(0x388)](),config=_0x4e2ee7,restoredConfigFile=_0x4dd142);}}async function restoreConfigNotify(_0x5a5465){const _0xa78153=_0x385116;let _0x97e72e;if(restoredConfigFile==0x1)_0x97e72e=_0xa78153(0x1f6);else _0x97e72e=_0xa78153(0x385);if(_0x5a5465)io['to'](_0xa78153(0x288))[_0xa78153(0x2de)](_0xa78153(0x319),_0x97e72e);else{logger['simple']('-----------------------------------------------------------------------------------'),logger[_0xa78153(0x2fe)](_0x97e72e),logger[_0xa78153(0x2fe)]('-----------------------------------------------------------------------------------'),logger[_0xa78153(0x2fe)]('');if(tgBot&&settings[_0xa78153(0x2d5)]&&settings[_0xa78153(0x35c)]!='orders')tgBot[_0xa78153(0x311)](settings[_0xa78153(0x2d5)],'Bot\x20Mgr\x20>\x20'+_0x97e72e)[_0xa78153(0x2ed)](_0x36cc8f=>{telegramError(_0x36cc8f);});}}function validateCredentials(_0xf8324e,_0x100097){const _0x13e814=_0x385116;if(_0xf8324e[_0x13e814(0x2ca)]==settings[_0x13e814(0x303)]&&bcrypt['compareSync'](_0xf8324e[_0x13e814(0x269)],settings[_0x13e814(0x30f)])){if(settings[_0x13e814(0x397)])return{'allow':![],'reason':_0x13e814(0x30a),'token':null};else{const _0x4ed7e6=generateLoginToken(_0x100097);return{'allow':!![],'reason':_0x13e814(0x227),'token':_0x4ed7e6};}}else return{'allow':![],'reason':_0x13e814(0x279),'token':null};}function refreshToken(_0x127f0f){const _0x12f9a3=generateLoginToken(_0x127f0f);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x12f9a3};}function validateAccess(_0x1ba8bb,_0x1429c0,_0x4059e6){const _0x49a0e5=_0x385116,_0x1068b2=_0x4059e6?_0x4059e6:devices[_0x1429c0]['ip'];let _0x8d35a;const _0x354bbc=_0x27d542=>{const _0x1f1339=_0x24f4;if(settings[_0x1f1339(0x312)]){if(settings[_0x1f1339(0x397)]){if(telegram2FaApproved(_0x1429c0)){const _0x3fb1f1=generateLoginToken(_0x1429c0);return{'allow':!![],'reason':_0x1f1339(0x2bb),'token':_0x3fb1f1};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x8d35a=validToken(_0x27d542,_0x1429c0),_0x8d35a[_0x1f1339(0x315)](_0x1f1339(0x263))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x27d542}:{'allow':![],'reason':_0x1f1339(0x333),'token':null};}else return{'allow':!![],'reason':_0x1f1339(0x2b0),'token':null};};if(settings[_0x49a0e5(0x370)]){let _0xb7d610=[...settings['whitelist'],_0x49a0e5(0x275),_0x49a0e5(0x306),_0x49a0e5(0x2ef)];if(_0xb7d610[_0x49a0e5(0x252)](_0x1068b2))return _0x354bbc(_0x1ba8bb);else{_0x8d35a=validToken(_0x1ba8bb,_0x1429c0);if(_0x8d35a[_0x49a0e5(0x315)](_0x49a0e5(0x263)))return _0x354bbc(_0x1ba8bb);else{if(telegramIpApproved(_0x1429c0)){const _0x43f4ed=generateToken(_0x1429c0);return _0x8d35a=_0x354bbc(_0x1ba8bb),_0x8d35a[_0x49a0e5(0x25e)]?{'allow':!![],'reason':_0x49a0e5(0x395),'token':_0x43f4ed}:_0x8d35a;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x49a0e5(0x2d0),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x354bbc(_0x1ba8bb);}function timelyDecrypt(_0x1dd237,_0x370449=!![]){const _0x4be771=_0x385116;if(_0x1dd237)try{const _0x573336=crypt[_0x4be771(0x1f7)](secure[_0x4be771(0x2e1)],_0x1dd237)['message'],_0x54911b=_0x573336[_0x4be771(0x1fc)]('@')[0x0],_0x58362a=_0x573336[_0x4be771(0x1fc)]('@')[0x1],_0x2d016d=new Date()[_0x4be771(0x2ba)]();if(_0x370449){if(_0x2d016d-_0x58362a<maxSecretAge*0x3e8)return _0x54911b;else return![];}else return _0x54911b;}catch(_0x372afb){return![];}else return![];}const validToken=(_0x334f4f,_0x4d85de)=>{const _0x50e573=_0x385116,_0x2028b5=devices[_0x4d85de]['ip'];if(!_0x334f4f)return{'error':_0x50e573(0x1fa)};for(let _0x3f78cf of blacklist){if(_0x3f78cf[_0x50e573(0x3b2)]==_0x334f4f)return{'error':_0x50e573(0x3bb)};}let _0x4d6a1c;try{_0x4d6a1c=jwt[_0x50e573(0x2e8)](_0x334f4f,secure[_0x50e573(0x39c)]+_0x4d85de);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x4d6a1c[_0x50e573(0x315)]('clientip')&&!_0x4d6a1c[_0x50e573(0x315)]('username')||!_0x4d6a1c['hasOwnProperty']('exp'))return{'error':_0x50e573(0x393)};if(!_0x4d6a1c[_0x50e573(0x315)](_0x50e573(0x2ca))&&_0x4d6a1c[_0x50e573(0x315)](_0x50e573(0x371))){const {clientip:_0x23671a}=_0x4d6a1c;return _0x2028b5==_0x23671a?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x50e573(0x37b)};}else{if(_0x4d6a1c[_0x50e573(0x315)](_0x50e573(0x2ca))&&_0x4d6a1c['hasOwnProperty'](_0x50e573(0x371))){const {username:_0x1d7762,clientip:_0x37aee6}=_0x4d6a1c;return settings[_0x50e573(0x303)]==_0x1d7762&&_0x2028b5==_0x37aee6?{'success':_0x50e573(0x31b)}:{'error':_0x50e573(0x396)};}}},generateLoginToken=_0x16618b=>{const _0x181fe9=_0x385116;if(_0x16618b){const _0x4e5af0=devices[_0x16618b]['ip'];return jwt[_0x181fe9(0x307)]({'username':settings[_0x181fe9(0x303)],'clientip':_0x4e5af0},secure['secret']+_0x16618b,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x4f05e0=>{const _0x49deab=_0x385116;if(_0x4f05e0){const _0xcf5db=devices[_0x4f05e0]['ip'];return jwt[_0x49deab(0x307)]({'clientip':_0xcf5db},secure[_0x49deab(0x39c)]+_0x4f05e0,{'expiresIn':devices[_0x4f05e0][_0x49deab(0x39f)][_0x49deab(0x248)]*0x3c});}else return![];},telegramIpApproved=_0x3f8cb6=>{const _0x116220=_0x385116;let _0x347a17=![];return devices[_0x3f8cb6][_0x116220(0x39f)]&&devices[_0x3f8cb6]['telegramIpApproval']['expiry']!=_0x116220(0x32f)&&(_0x347a17=devices[_0x3f8cb6][_0x116220(0x39f)]['clientip']==devices[_0x3f8cb6]['ip']&&new Date()[_0x116220(0x2ba)]()-devices[_0x3f8cb6]['telegramIpApproval'][_0x116220(0x377)]<devices[_0x3f8cb6]['telegramIpApproval'][_0x116220(0x248)]*0x3c*0x3e8),_0x347a17;},telegram2FaApproved=_0x4944da=>{const _0x33190e=_0x385116;let _0x56b762=![];return devices[_0x4944da][_0x33190e(0x3a1)]&&devices[_0x4944da][_0x33190e(0x3a1)][_0x33190e(0x248)]!=_0x33190e(0x32f)&&(_0x56b762=devices[_0x4944da]['telegram2FaApproval']['clientip']==devices[_0x4944da]['ip']&&new Date()[_0x33190e(0x2ba)]()-devices[_0x4944da][_0x33190e(0x3a1)][_0x33190e(0x377)]<devices[_0x4944da][_0x33190e(0x3a1)]['expiry']*0x3c*0x3e8),_0x56b762;},normalizeIP=_0x26c02f=>{const _0x4d05af=_0x385116;let _0x3ab7e3=null,_0x20eb57=null;if(ipaddr[_0x4d05af(0x3c2)](_0x26c02f)){const _0x2a9326=ipaddr[_0x4d05af(0x322)](_0x26c02f);_0x2a9326[_0x4d05af(0x3ba)]()===_0x4d05af(0x1fd)?(_0x2a9326[_0x4d05af(0x379)]()&&(_0x3ab7e3=_0x2a9326['toIPv4Address']()['toString']()),_0x20eb57=_0x2a9326[_0x4d05af(0x30c)]()):(_0x3ab7e3=_0x2a9326[_0x4d05af(0x30c)](),_0x20eb57=_0x2a9326[_0x4d05af(0x1ee)]()[_0x4d05af(0x30c)]());}return{'show':_0x3ab7e3?_0x3ab7e3:_0x20eb57,'store':_0x20eb57};};function formatDate(_0x5a67fb){const _0x34a51e=_0x385116;return _0x5a67fb[_0x34a51e(0x3aa)]()+'/'+(_0x5a67fb[_0x34a51e(0x223)]()+0x1)[_0x34a51e(0x30c)]()[_0x34a51e(0x25b)](0x2,'0')+'/'+_0x5a67fb[_0x34a51e(0x2f6)]()[_0x34a51e(0x30c)]()['padStart'](0x2,'0')+'\x20'+_0x5a67fb[_0x34a51e(0x35e)]()[_0x34a51e(0x30c)]()[_0x34a51e(0x25b)](0x2,'0')+':'+_0x5a67fb[_0x34a51e(0x229)]()[_0x34a51e(0x30c)]()[_0x34a51e(0x25b)](0x2,'0')+':'+_0x5a67fb['getSeconds']()[_0x34a51e(0x30c)]()[_0x34a51e(0x25b)](0x2,'0');}function sleep(_0x1ebcc0){return new Promise(_0xaa11fe=>setTimeout(_0xaa11fe,_0x1ebcc0));}