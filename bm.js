const _0x381e5c=_0x40f3;(function(_0x31abbc,_0x4ec851){const _0x308c09=_0x40f3,_0x51b2f9=_0x31abbc();while(!![]){try{const _0x5622fc=-parseInt(_0x308c09(0x1e8))/0x1+-parseInt(_0x308c09(0x157))/0x2+parseInt(_0x308c09(0x268))/0x3+parseInt(_0x308c09(0x208))/0x4*(-parseInt(_0x308c09(0x299))/0x5)+parseInt(_0x308c09(0x16c))/0x6*(parseInt(_0x308c09(0x2cb))/0x7)+parseInt(_0x308c09(0x1c9))/0x8*(parseInt(_0x308c09(0x2f3))/0x9)+parseInt(_0x308c09(0x1fb))/0xa*(-parseInt(_0x308c09(0x255))/0xb);if(_0x5622fc===_0x4ec851)break;else _0x51b2f9['push'](_0x51b2f9['shift']());}catch(_0x3a5f25){_0x51b2f9['push'](_0x51b2f9['shift']());}}}(_0x528e,0x3f3c6));function _0x40f3(_0x1383b4,_0x22b642){const _0x530cbe=_0x528e();return _0x40f3=function(_0x159811,_0x1118d3){_0x159811=_0x159811-0x113;let _0x528e6c=_0x530cbe[_0x159811];return _0x528e6c;},_0x40f3(_0x1383b4,_0x22b642);}const _0x1118d3=function(){let _0x58360a=!![];return function(_0x199a04,_0x167373){const _0x1eb8cf=_0x58360a?function(){const _0x2e1d6a=_0x40f3;if(_0x167373){const _0x27b2e1=_0x167373[_0x2e1d6a(0x2dc)](_0x199a04,arguments);return _0x167373=null,_0x27b2e1;}}:function(){};return _0x58360a=![],_0x1eb8cf;};}(),_0x159811=_0x1118d3(this,function(){const _0x8d54ef=_0x40f3;return _0x159811[_0x8d54ef(0x2b2)]()[_0x8d54ef(0x2d6)](_0x8d54ef(0x20b))['toString']()[_0x8d54ef(0x15d)](_0x159811)[_0x8d54ef(0x2d6)]('(((.+)+)+)+$');});_0x159811();'use strict';process[_0x381e5c(0x1aa)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x381e5c(0x305)),fs=require('fs'),fns=require(_0x381e5c(0x1b3)),low=require('lowdb'),FileSync=require(_0x381e5c(0x22a)),path=require(_0x381e5c(0x2c8)),crypto=require(_0x381e5c(0x17c)),Crypt=require(_0x381e5c(0x2e9))[_0x381e5c(0x1c8)],RSA=require(_0x381e5c(0x2e9))[_0x381e5c(0x2c9)],bcrypt=require('bcryptjs'),jwt=require(_0x381e5c(0x113)),ipaddr=require(_0x381e5c(0x227)),argv=require(_0x381e5c(0x1ed))(process['argv'][_0x381e5c(0x169)](0x2))['argv'],uuidRandom=require(_0x381e5c(0x230)),{Telegraf,Markup}=require(_0x381e5c(0x27a)),Mixpanel=require('mixpanel'),axios=require('axios'),{GraphQLClient,gql}=require(_0x381e5c(0x2bb)),util=require(_0x381e5c(0x2b1)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),PORT=argv[_0x381e5c(0x273)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x381e5c(0x2f4)](PORT)&&(console[_0x381e5c(0x280)](_0x381e5c(0x1b0)+PORT+_0x381e5c(0x124)),process['exit'](0x1));const HOST=argv[_0x381e5c(0x1b2)]||null,userID=argv[_0x381e5c(0x2cd)]||'',debugging=argv['d']||![],nodeversion=process[_0x381e5c(0x1bf)][_0x381e5c(0x172)];let bbpath=_0x381e5c(0x2ac),bbpath2='';const botfile=_0x381e5c(0x21e),configfile=_0x381e5c(0x20d),settingsfile=_0x381e5c(0x196),securefile=_0x381e5c(0x2aa),environment=require('./'+bbpath2+_0x381e5c(0x22b))['environment']||_0x381e5c(0x156),maxBackups=0xa;let validInstallation=!![];!fs[_0x381e5c(0x131)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x381e5c(0x1b4)),configpath=userID?bbpath+_0x381e5c(0x171)+userID+'/':bbpath+_0x381e5c(0x171),configbackuppath=configpath+_0x381e5c(0x2c6),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x381e5c(0x20e),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x381e5c(0x178),loggerfile=fs['createWriteStream'](logspath+_0x381e5c(0x251),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x381e5c(0x133);!fs[_0x381e5c(0x131)](configpath)&&fs[_0x381e5c(0x190)](configpath);!fs[_0x381e5c(0x131)](configbackuppath)&&fs[_0x381e5c(0x190)](configbackuppath);!fs[_0x381e5c(0x131)](logspath)&&fs[_0x381e5c(0x190)](logspath);!fs['existsSync'](zippath)&&fs[_0x381e5c(0x190)](zippath);!fs['existsSync'](temppath)&&fs[_0x381e5c(0x190)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x381e5c(0x25d)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x381e5c(0x262),'onepagemode':![]}})[_0x381e5c(0x25d)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x381e5c(0x2d8)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x381e5c(0x2c3),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa,mixpanel=Mixpanel[_0x381e5c(0x2d7)](_0x381e5c(0x2ed),{'host':_0x381e5c(0x218)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x381e5c(0x284)]&&(settings[_0x381e5c(0x284)]!=''&&settings['telegramToken']!=_0x381e5c(0x223))&&settings[_0x381e5c(0x1ea)]&&settings[_0x381e5c(0x1ea)]!='')initTelegram();const parseColor=(_0x3bf253,_0x40c4cc)=>{const _0x545975=_0x381e5c,_0x2ee0c9=/#[A-Z]{3}#/g;if(typeof _0x3bf253==_0x545975(0x2ec)){!_0x40c4cc?_0x3bf253=_0x3bf253['replace'](_0x2ee0c9,''):(_0x3bf253=_0x3bf253[_0x545975(0x219)](/#BLU#/g,'\x1b[34m'),_0x3bf253=_0x3bf253[_0x545975(0x219)](/#RED#/g,_0x545975(0x232)),_0x3bf253=_0x3bf253['replace'](/#YEL#/g,'\x1b[33m'),_0x3bf253=_0x3bf253[_0x545975(0x219)](/#MAG#/g,_0x545975(0x2d3)),_0x3bf253=_0x3bf253['replace'](/#CYA#/g,'\x1b[36m'),_0x3bf253=_0x3bf253[_0x545975(0x219)](/#RES#/g,_0x545975(0x24a)));;}return _0x3bf253;},logger={'screen':_0x2f7e30=>{const _0x242b73=_0x381e5c;console[_0x242b73(0x280)](parseColor(_0x2f7e30,!![]));},'simple':_0x4a4ec4=>{const _0x243629=_0x381e5c;console['log'](parseColor(_0x4a4ec4,!![])),loggerfile[_0x243629(0x25d)](util['format'](parseColor(_0x4a4ec4,![]))+'\x0a');},'full':async _0x513317=>{const _0x169d32=_0x381e5c,_0x165752=getTimeStamp()+_0x169d32(0x2bd)+_0x513317;console[_0x169d32(0x280)](parseColor(_0x165752,!![])),loggerfile[_0x169d32(0x25d)](util['format'](parseColor(_0x165752,![]))+'\x0a');if(tgBot&&settings[_0x169d32(0x168)]&&settings[_0x169d32(0x13c)]!=_0x169d32(0x17a))await sendTelegram(settings['telegramChatId'],_0x169d32(0x2ba)+parseColor(_0x513317,![]));},'debug':async(_0x5297d9,_0x1f9abb='')=>{const _0xa4e769=_0x381e5c,_0x14a843=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x5297d9;if(debugging)console[_0xa4e769(0x280)](parseColor(_0x14a843,!![]));loggerfile['write'](util['format'](parseColor(_0x14a843,![]))+'\x0a');if(_0x1f9abb){if(debugging)console[_0xa4e769(0x280)](_0x1f9abb);loggerfile[_0xa4e769(0x25d)](util[_0xa4e769(0x1d5)](_0x1f9abb)+'\x0a');}}};let terminating=![];process['on'](_0x381e5c(0x2f2),function(_0x115442){const _0x5099db=_0x381e5c;logger[_0x5099db(0x221)](_0x115442);}),process['on'](_0x381e5c(0x25b),()=>{const _0x52482a=_0x381e5c;stopAllBots(),process[_0x52482a(0x25b)](0x0);}),process['on'](_0x381e5c(0x1d0),()=>{stopAllBots(),process['exit'](0x0);}),process['on']('SIGINT',()=>{const _0x32bfd5=_0x381e5c;stopAllBots(),process[_0x32bfd5(0x25b)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x381e5c(0x22b))[_0x381e5c(0x277)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x381e5c(0x2b9))[_0x381e5c(0x1a6)](app);app[_0x381e5c(0x2e3)](fileUpload({'useTempFiles':!![]})),app['get'](_0x381e5c(0x1c0),async(_0x42ce9e,_0x53601e)=>{const _0x14bd8e=_0x381e5c,_0x367184=_0x42ce9e[_0x14bd8e(0x2ea)][_0x14bd8e(0x139)],_0x51c8fc=getClientsWithBotID(_0x14bd8e(0x2f7)),_0x8bf44a=_0x42ce9e[_0x14bd8e(0x1a8)]['uuid'],_0x1ec0cd=timelyDecrypt(_0x8bf44a,![]),_0x37b091=_0x51c8fc[_0x14bd8e(0x225)](_0x3b5405=>_0x3b5405[_0x14bd8e(0x260)]==_0x1ec0cd);if(_0x37b091){const _0x30f06b=normalizeIP(_0x42ce9e['socket'][_0x14bd8e(0x150)])[_0x14bd8e(0x296)],_0x126f08=_0x42ce9e[_0x14bd8e(0x1a8)][_0x14bd8e(0x136)];if(validateAccess(_0x126f08,_0x1ec0cd,_0x30f06b)[_0x14bd8e(0x28b)])_0x367184==_0x14bd8e(0x165)&&await backupConfigFiles(),await zipFiles(_0x367184),_0x53601e[_0x14bd8e(0x25f)](zippath+(_0x367184+_0x14bd8e(0x19c)),_0x2ec0bd=>{const _0x537b8a=_0x14bd8e;_0x2ec0bd&&(logger[_0x537b8a(0x1fd)]('Failed\x20to\x20download\x20'+_0x367184),logger[_0x537b8a(0x221)](_0x2ec0bd));});else logger['full'](_0x14bd8e(0x149)+_0x367184+_0x14bd8e(0x297));}else logger[_0x14bd8e(0x1fd)](_0x14bd8e(0x149)+_0x367184+_0x14bd8e(0x271));}),app[_0x381e5c(0x2e0)]('/upload-backup',async(_0x202c17,_0x39a61a)=>{const _0x8b4922=_0x381e5c,_0x513ac8=getClientsWithBotID(_0x8b4922(0x2f7)),_0x177527=_0x202c17['headers'][_0x8b4922(0x260)],_0x187031=timelyDecrypt(_0x177527,![]),_0x3d5696=_0x513ac8[_0x8b4922(0x225)](_0x38c3e1=>_0x38c3e1['uuid']==_0x187031);logger[_0x8b4922(0x14e)](_0x8b4922(0x30b));if(_0x3d5696){const _0x1879f9=normalizeIP(_0x202c17[_0x8b4922(0x192)][_0x8b4922(0x150)])[_0x8b4922(0x296)],_0x428fe1=_0x202c17[_0x8b4922(0x1a8)]['tkn'];if(validateAccess(_0x428fe1,_0x187031,_0x1879f9)[_0x8b4922(0x28b)]){if(_0x202c17[_0x8b4922(0x19f)]){const _0x26e222=_0x202c17[_0x8b4922(0x19f)][_0x8b4922(0x1e5)];await _0x26e222['mv'](temppath+_0x26e222['name']),_0x39a61a[_0x8b4922(0x21c)]({'status':!![],'message':'File\x20uploaded'});const _0x205cb5=getBotsWithMode();_0x205cb5[_0x8b4922(0x193)]>0x0?confirmRestore(temppath,_0x26e222['name']):unzipFile(temppath,_0x26e222['name']);}}else logger[_0x8b4922(0x1fd)](_0x8b4922(0x1f1));}else logger[_0x8b4922(0x1fd)](_0x8b4922(0x1f9));}),app[_0x381e5c(0x2e3)](express['static'](path[_0x381e5c(0x11e)](__dirname,bbpath2,'build2'))),app[_0x381e5c(0x2e3)](express['static'](path[_0x381e5c(0x11e)](__dirname,bbpath2,_0x381e5c(0x2a5)))),app['get']('/',function(_0x2b2838,_0x314254){const _0x38d676=_0x381e5c;_0x314254[_0x38d676(0x2e1)](path['join'](__dirname,bbpath2,_0x38d676(0x2a7),'index.html'));}),app[_0x381e5c(0x1a7)](_0x381e5c(0x179),function(_0x4166f6,_0x337d6b){const _0x1dd102=_0x381e5c;_0x337d6b[_0x1dd102(0x2e1)](path['join'](__dirname,bbpath2,_0x1dd102(0x2a5),'index.html'));}),app[_0x381e5c(0x1a7)]('/:bot/portfolio',(_0x35ee38,_0x3061a5)=>{const _0x333a02=_0x381e5c;_0x3061a5['sendFile'](path[_0x333a02(0x11e)](__dirname,bbpath2,_0x333a02(0x2a5),'index.html'));}),app['get'](_0x381e5c(0x239),(_0x168b3a,_0x443648)=>{const _0x5e7683=_0x381e5c;_0x443648[_0x5e7683(0x2e1)](path[_0x5e7683(0x11e)](__dirname,bbpath2,_0x5e7683(0x2a5),'index.html'));}),app[_0x381e5c(0x1a7)](_0x381e5c(0x28d),(_0x205fcf,_0x3fffb9)=>{const _0x4d6616=_0x381e5c;_0x3fffb9['sendFile'](path[_0x4d6616(0x11e)](__dirname,bbpath2,_0x4d6616(0x2a5),'index.html'));}),app[_0x381e5c(0x1a7)](_0x381e5c(0x200),(_0x310c53,_0x38551d)=>{const _0x302ba1=_0x381e5c;_0x38551d['sendFile'](path[_0x302ba1(0x11e)](__dirname,bbpath2,_0x302ba1(0x2a5),_0x302ba1(0x1dd)));}),app[_0x381e5c(0x1a7)](_0x381e5c(0x2fa),(_0x4454cc,_0x3593f1)=>{const _0x1e3f0e=_0x381e5c;_0x3593f1['sendFile'](path[_0x1e3f0e(0x11e)](__dirname,bbpath2,_0x1e3f0e(0x2a5),_0x1e3f0e(0x1dd)));}),app[_0x381e5c(0x1a7)](_0x381e5c(0x290),(_0x234771,_0x48b2ed)=>{const _0x1dc492=_0x381e5c;_0x48b2ed[_0x1dc492(0x2e1)](path[_0x1dc492(0x11e)](__dirname,bbpath2,_0x1dc492(0x2a5),'index.html'));});if(HOST)http[_0x381e5c(0x15e)](PORT,HOST);else http[_0x381e5c(0x15e)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x5195f5=_0x381e5c;let _0x2b2528=_0x5195f5(0x1f3);const _0x512ac9=networkInterfaces(),_0x5eb303={};for(const _0x4ca62e of Object[_0x5195f5(0x16e)](_0x512ac9)){for(const _0x48ef5b of _0x512ac9[_0x4ca62e]){if((_0x48ef5b['family']==_0x5195f5(0x26b)||_0x48ef5b[_0x5195f5(0x29e)]==0x4)&&!_0x48ef5b[_0x5195f5(0x166)]){const _0x4ce4bd=ipaddr['parse'](_0x48ef5b[_0x5195f5(0x2a3)])[_0x5195f5(0x292)]();_0x4ce4bd!=_0x5195f5(0x302)&&(!_0x5eb303[_0x4ca62e]&&(_0x5eb303[_0x4ca62e]=[]),_0x5eb303[_0x4ca62e][_0x5195f5(0x26e)](_0x48ef5b[_0x5195f5(0x2a3)]),_0x2b2528=_0x48ef5b[_0x5195f5(0x2a3)]);}}}return{'serverip':_0x2b2528,'netinterfaces':_0x5eb303};}async function startServer(){const _0x3f4d74=_0x381e5c,{serverip:_0x465ea3,netinterfaces:_0x23c735}=getServerIP();logger[_0x3f4d74(0x221)](''),logger['simple'](_0x3f4d74(0x24e)),await logger['full'](_0x3f4d74(0x2fe)+serverversion+'#RES#\x20'+(environment=='staging'?'(staging)':'')+'\x0a'+(_0x3f4d74(0x154)+PORT+_0x3f4d74(0x267))+('=>\x20Go\x20to\x20#CYA#http://'+_0x465ea3+':'+PORT+_0x3f4d74(0x170))),logger[_0x3f4d74(0x221)](_0x3f4d74(0x24e));if(config[_0x3f4d74(0x193)]!=0x0)for(const _0x17777a of config){const _0x25946d=_0x17777a['mode']=='auto'?'a':'m';if(_0x17777a[_0x3f4d74(0x175)]=='enabled'||_0x17777a[_0x3f4d74(0x175)]==_0x3f4d74(0x1d4))await logger[_0x3f4d74(0x1fd)](_0x3f4d74(0x259)+_0x25946d+_0x3f4d74(0x1ee)+_0x17777a[_0x3f4d74(0x13a)]+_0x3f4d74(0x213)+_0x17777a[_0x3f4d74(0x1b9)]),startBot([_0x17777a[_0x3f4d74(0x13a)],userID],{'cwd':bbpath},function(_0x5107ca){const _0x4953c9=_0x3f4d74;if(_0x5107ca)logger[_0x4953c9(0x1fd)](_0x5107ca);});else(_0x17777a['status']==_0x3f4d74(0x1f4)||_0x17777a[_0x3f4d74(0x175)]==_0x3f4d74(0x228))&&await logger[_0x3f4d74(0x1fd)]('Idling\x20('+_0x25946d+')\x20\x20\x20|\x20Bot\x20'+_0x17777a[_0x3f4d74(0x13a)]+_0x3f4d74(0x213)+_0x17777a[_0x3f4d74(0x1b9)]);}else!newBot&&logger[_0x3f4d74(0x221)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x3f4d74(0x221)](_0x3f4d74(0x24e)),logger[_0x3f4d74(0x221)](''),await logger[_0x3f4d74(0x14e)](_0x3f4d74(0x120)+nodeversion),await logger[_0x3f4d74(0x14e)](_0x3f4d74(0x19a),_0x23c735);}function startSocket(){io['on']('connection',_0x3c0457=>{const _0x407fde=_0x40f3;let _0x1f750f,_0x2340ce,_0x1c9b3b,_0x99de07,_0x19d2c1;const _0xb1ae5e=_0x3c0457['handshake']['headers']['referer'];_0x2340ce=_0xb1ae5e[_0x407fde(0x304)](/bot[0-9]{3}/);if(_0x2340ce)_0x1c9b3b=_0x2340ce[0x0][_0x407fde(0x304)](/[0-9]{3}/);if(_0x1c9b3b)_0x1f750f=_0x1c9b3b[0x0];else _0x1f750f=_0x407fde(0x2f7);const _0x24c412=_0x3c0457['handshake']['auth'][_0x407fde(0x152)];if(!_0x24c412)_0x3c0457[_0x407fde(0x29d)]('status',{'publicKey':secure[_0x407fde(0x141)]});else{_0x99de07=timelyDecrypt(_0x24c412,![]);if(!_0x99de07)_0x3c0457[_0x407fde(0x29d)](_0x407fde(0x175),{'publicKey':secure['publicKey']});else{_0x19d2c1=normalizeIP(_0x3c0457[_0x407fde(0x256)][_0x407fde(0x150)])[_0x407fde(0x296)];if(!devices[_0x99de07])devices[_0x99de07]={'uuid':_0x99de07,'access':{'token':null}};devices[_0x99de07]['ip']=_0x19d2c1;const _0x160083=addClient(_0x3c0457['id'],_0x99de07,_0x1f750f);setAccess(_0x160083),emitMessages(),_0x3c0457['on'](_0x407fde(0x2b0),_0x54885a=>{const _0x4f6d5e=_0x407fde,_0x14e489=timelyDecrypt(_0x54885a['password']);if(_0x14e489){_0x54885a={'username':_0x54885a[_0x4f6d5e(0x1de)],'password':_0x14e489},devices[_0x99de07]['access']=validateCredentials(_0x54885a,_0x99de07);if(devices[_0x99de07][_0x4f6d5e(0x2ef)][_0x4f6d5e(0x28b)]==![]&&devices[_0x99de07]['access']['reason']==_0x4f6d5e(0x203))_0x3c0457[_0x4f6d5e(0x29d)](_0x4f6d5e(0x175),{'access':devices[_0x99de07][_0x4f6d5e(0x2ef)]}),loginAccess2FA(_0x99de07,_0x19d2c1);else{if(devices[_0x99de07][_0x4f6d5e(0x2ef)][_0x4f6d5e(0x28b)]==![]&&devices[_0x99de07][_0x4f6d5e(0x2ef)][_0x4f6d5e(0x1bc)]=='invalid\x20credentials')_0x3c0457[_0x4f6d5e(0x29d)](_0x4f6d5e(0x175),{'access':devices[_0x99de07]['access']});else devices[_0x99de07][_0x4f6d5e(0x2ef)][_0x4f6d5e(0x28b)]&&devices[_0x99de07][_0x4f6d5e(0x2ef)][_0x4f6d5e(0x1bc)]==_0x4f6d5e(0x2f9)&&(getClientsWithUuid(_0x99de07)[_0x4f6d5e(0x132)](_0x38cb63=>{setAccess(_0x38cb63);}),logger[_0x4f6d5e(0x14e)](_0x4f6d5e(0x12e)+_0x99de07['slice'](-0x8)),setTokenRefresh(_0x99de07),setSessionTimeout(_0x4f6d5e(0x2b0),_0x99de07));}}else logger[_0x4f6d5e(0x1fd)](_0x4f6d5e(0x283));}),_0x3c0457['on'](_0x407fde(0x1d8),()=>{resetPassword();}),_0x3c0457['on'](_0x407fde(0x1b5),_0x10554c=>{removeClient(_0x3c0457['id']);}),_0x1f750f==_0x407fde(0x2f7)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5d4b4f){const _0x4b374b=_0x381e5c;if(_0x5d4b4f!=_0x4b374b(0x2f7)&&config[_0x4b374b(0x309)]!=''){if(pid[_0x5d4b4f])pid[_0x5d4b4f][_0x4b374b(0x21c)]({'function':_0x4b374b(0x20c),'args':null});}_0x5d4b4f!=_0x4b374b(0x2f7)&&broadcastToBots(_0x4b374b(0x1dc),JSON[_0x4b374b(0x207)](config));}function reloadBotManager(){const _0x2fad5f=_0x381e5c;getClientsWithBotID(_0x2fad5f(0x2f7))['forEach'](_0x4225dd=>{const _0x6be629=_0x2fad5f;getSocket(_0x4225dd['id'])['emit'](_0x6be629(0x175),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x323495){const _0x31cb21=_0x381e5c;return io[_0x31cb21(0x137)][_0x31cb21(0x137)][_0x31cb21(0x1a7)](_0x323495);}function setAccess(_0xb47f77){const _0x18bd3c=_0x381e5c,_0x4e182e=getSocket(_0xb47f77['id']),_0xf11402=_0xb47f77[_0x18bd3c(0x260)],_0x5ec167=_0xb47f77[_0x18bd3c(0x12d)];devices[_0xf11402]['access']=validateAccess(devices[_0xf11402][_0x18bd3c(0x2ef)][_0x18bd3c(0x1a3)],_0xf11402),logger[_0x18bd3c(0x14e)](_0x18bd3c(0x30d)+devices[_0xf11402][_0x18bd3c(0x2ef)]['reason']+_0x18bd3c(0x29c)+_0xb47f77['id'][_0x18bd3c(0x169)](-0x8)+'\x20|\x20user:\x20...'+_0xf11402['slice'](-0x8)),_0x4e182e[_0x18bd3c(0x11e)](_0xf11402);if(devices[_0xf11402][_0x18bd3c(0x2ef)][_0x18bd3c(0x28b)]){_0x4e182e[_0x18bd3c(0x11e)](_0x5ec167);if(_0x5ec167==_0x18bd3c(0x2f7))initializeSocketBotManager(_0x4e182e);else initializeSocketBot(_0x4e182e);initClient(_0x5ec167);}devices[_0xf11402][_0x18bd3c(0x2ef)]['token']&&devices[_0xf11402][_0x18bd3c(0x2ef)][_0x18bd3c(0x1bc)]==_0x18bd3c(0x1a9)&&setSessionTimeout('2FA',_0xf11402),devices[_0xf11402]['access']['token']&&devices[_0xf11402][_0x18bd3c(0x2ef)][_0x18bd3c(0x1bc)]==_0x18bd3c(0x1f2)&&setSessionTimeout(_0x18bd3c(0x2b0),_0xf11402),_0x4e182e['emit'](_0x18bd3c(0x175),{'status':_0xb47f77['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xf11402][_0x18bd3c(0x2ef)],'externalip':devices[_0xf11402]['ip'],'publicKey':secure[_0x18bd3c(0x141)],'userid':settings[_0x18bd3c(0x254)],'validInstallation':validInstallation}),devices[_0xf11402]['access'][_0x18bd3c(0x28b)]==![]&&devices[_0xf11402][_0x18bd3c(0x2ef)]['reason']==_0x18bd3c(0x23b)&&temporaryAccess2FA(_0xf11402,devices[_0xf11402]['ip']);}function setSessionTimeout(_0x4898e8,_0xa5dd8c){const _0x1da788=_0x381e5c;let _0x47c433;if(_0x4898e8==_0x1da788(0x2b0))_0x47c433=loginExpiry*0x3c*0x3e8;else _0x47c433=devices[_0xa5dd8c]['telegramIpApproval']['expiry']*0x3c*0x3e8-(new Date()[_0x1da788(0x240)]()-devices[_0xa5dd8c][_0x1da788(0x295)][_0x1da788(0x153)]);if(devices[_0xa5dd8c][_0x1da788(0x16d)])clearTimeout(devices[_0xa5dd8c]['pidExpireLogin']);devices[_0xa5dd8c][_0x1da788(0x16d)]=setTimeout(()=>{const _0x4d502d=_0x1da788;if(devices[_0xa5dd8c][_0x4d502d(0x125)])clearTimeout(devices[_0xa5dd8c][_0x4d502d(0x125)]);removeSocketListeners(_0xa5dd8c),addBlacklist(_0xa5dd8c),devices[_0xa5dd8c][_0x4d502d(0x295)]=null,devices[_0xa5dd8c][_0x4d502d(0x22f)]=null,devices[_0xa5dd8c]['access'][_0x4d502d(0x1a3)]=null,logger[_0x4d502d(0x14e)]('Session\x20expired\x20for\x20user\x20...'+_0xa5dd8c[_0x4d502d(0x169)](-0x8)),devices[_0xa5dd8c][_0x4d502d(0x2ef)]=validateAccess(devices[_0xa5dd8c][_0x4d502d(0x2ef)][_0x4d502d(0x1a3)],_0xa5dd8c),!(devices[_0xa5dd8c]['access'][_0x4d502d(0x28b)]&&devices[_0xa5dd8c][_0x4d502d(0x2ef)][_0x4d502d(0x1bc)]==_0x4d502d(0x1ba))&&(_0x4898e8=='login'?io['to'](_0xa5dd8c)[_0x4d502d(0x29d)](_0x4d502d(0x175),{'access':{'allow':![],'reason':_0x4d502d(0x233),'token':null}}):io['to'](_0xa5dd8c)[_0x4d502d(0x29d)](_0x4d502d(0x175),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0xa5dd8c][_0x4d502d(0x2ef)][_0x4d502d(0x1a3)]=null;},_0x47c433);}function setTokenRefresh(_0x11a9fd){const _0x419d14=_0x381e5c;if(devices[_0x11a9fd][_0x419d14(0x125)])clearTimeout(devices[_0x11a9fd]['pidRefreshToken']);devices[_0x11a9fd][_0x419d14(0x125)]=setTimeout(()=>{const _0x35fb2a=_0x419d14;getClientsWithUuid(_0x11a9fd)[_0x35fb2a(0x193)]!=0x0?(devices[_0x11a9fd]['access']=refreshToken(_0x11a9fd),io['to'](_0x11a9fd)['emit'](_0x35fb2a(0x175),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x11a9fd][_0x35fb2a(0x2ef)],'externalip':devices[_0x11a9fd]['ip'],'publicKey':secure[_0x35fb2a(0x141)],'validInstallation':validInstallation}),setTokenRefresh(_0x11a9fd)):clearTimeout(devices[_0x11a9fd][_0x35fb2a(0x125)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x9788fd){const _0x2d2947=_0x381e5c,_0x8b4324=getClient(_0x9788fd['id'])[_0x2d2947(0x260)];_0x9788fd[_0x2d2947(0x29d)](_0x2d2947(0x1dc),config),_0x9788fd[_0x2d2947(0x29d)](_0x2d2947(0x224),cleanSettings()),_0x9788fd['on'](_0x2d2947(0x215),_0x43412a=>{const _0x42f2cc=_0x2d2947;if(validateAccess(_0x43412a,_0x8b4324)[_0x42f2cc(0x28b)])addBot();else logger[_0x42f2cc(0x1fd)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x9788fd['on'](_0x2d2947(0x2a1),(_0x339efa,_0x1a039c)=>{const _0x1f9167=_0x2d2947;if(validateAccess(_0x1a039c,_0x8b4324)['allow'])toggleBot(_0x339efa['botID'],_0x339efa[_0x1f9167(0x175)],_0x339efa['live']);else logger[_0x1f9167(0x1fd)](_0x1f9167(0x130));}),_0x9788fd['on'](_0x2d2947(0x15f),(_0xb61209,_0x1c6331)=>{const _0x1b8030=_0x2d2947;if(validateAccess(_0x1c6331,_0x8b4324)[_0x1b8030(0x28b)])toggleBotMode(_0xb61209);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x9788fd['on'](_0x2d2947(0x23a),(_0x5e3ace,_0x33eaef)=>{const _0x231b31=_0x2d2947;if(validateAccess(_0x33eaef,_0x8b4324)['allow'])deleteBot(_0x5e3ace);else logger[_0x231b31(0x1fd)](_0x231b31(0x2c7));}),_0x9788fd['on'](_0x2d2947(0x14a),(_0x247e34,_0x1f45f5)=>{const _0x418078=_0x2d2947;if(validateAccess(_0x1f45f5,_0x8b4324)[_0x418078(0x28b)])storeSettings(_0x247e34,!![]);else logger[_0x418078(0x1fd)](_0x418078(0x164));}),_0x9788fd['on'](_0x2d2947(0x2fd),_0x5c6373=>{const _0x2a07ac=_0x2d2947;if(validateAccess(_0x5c6373,_0x8b4324)[_0x2a07ac(0x28b)])updateBB('update');else logger[_0x2a07ac(0x1fd)](_0x2a07ac(0x26c));}),_0x9788fd['on'](_0x2d2947(0x2ab),_0x55657a=>{const _0x1c34e6=_0x2d2947;if(validateAccess(_0x55657a,_0x8b4324)[_0x1c34e6(0x28b)])updateBB('reinstall');else logger[_0x1c34e6(0x1fd)](_0x1c34e6(0x17b));}),_0x9788fd['on'](_0x2d2947(0x216),_0x4c0274=>{const _0x39e2ed=_0x2d2947;if(validateAccess(_0x4c0274,_0x8b4324)[_0x39e2ed(0x28b)]){const _0x156b58=getClient(_0x9788fd['id']);if(_0x156b58)getBackupFiles(_0x156b58[_0x39e2ed(0x260)]);else logger[_0x39e2ed(0x1fd)](_0x39e2ed(0x14b));}else logger[_0x39e2ed(0x1fd)](_0x39e2ed(0x238));}),_0x9788fd['on'](_0x2d2947(0x27b),(_0x2835d1,_0x239c79)=>{const _0x43f79c=_0x2d2947;if(validateAccess(_0x239c79,_0x8b4324)[_0x43f79c(0x28b)])restoreBackupFile(_0x2835d1);else logger[_0x43f79c(0x1fd)](_0x43f79c(0x261));}),_0x9788fd['on']('get-messages',_0x1d91bc=>{const _0x595948=_0x2d2947;if(validateAccess(_0x1d91bc,_0x8b4324)[_0x595948(0x28b)])getMessages();else logger['full'](_0x595948(0x2cc));}),_0x9788fd['on'](_0x2d2947(0x2a8),(_0x566f4c,_0x19d273)=>{const _0x44c31a=_0x2d2947;if(validateAccess(_0x19d273,_0x8b4324)[_0x44c31a(0x28b)])confirmMessage(_0x566f4c);else logger[_0x44c31a(0x1fd)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x9788fd['on'](_0x2d2947(0x158),_0x3369fd=>{const _0x547927=_0x2d2947;if(validateAccess(_0x3369fd,_0x8b4324)[_0x547927(0x28b)]){if(devices[_0x8b4324][_0x547927(0x125)])clearTimeout(devices[_0x8b4324][_0x547927(0x125)]);if(devices[_0x8b4324][_0x547927(0x16d)])clearTimeout(devices[_0x8b4324][_0x547927(0x16d)]);removeSocketListeners(getClient(_0x9788fd['id'])[_0x547927(0x260)]),addBlacklist(_0x8b4324),devices[_0x8b4324][_0x547927(0x295)]=null,devices[_0x8b4324][_0x547927(0x22f)]=null,devices[_0x8b4324][_0x547927(0x2ef)][_0x547927(0x1a3)]=null,logger[_0x547927(0x14e)]('Logged\x20out\x20user\x20...'+_0x8b4324[_0x547927(0x169)](-0x8)),io['to'](getClient(_0x9788fd['id'])[_0x547927(0x260)])[_0x547927(0x29d)](_0x547927(0x175),{'access':{'allow':![],'reason':_0x547927(0x2e8),'token':null}});}else logger[_0x547927(0x1fd)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x28e1a9){const _0x1f14a8=_0x381e5c,_0x354788=getClient(_0x28e1a9['id'])[_0x1f14a8(0x12d)],_0x37aa38=getClient(_0x28e1a9['id'])['uuid'];_0x28e1a9['on'](_0x1f14a8(0x148),(_0x297d55,_0x3c8584)=>{const _0x3c8ecd=_0x1f14a8;if(validateAccess(_0x3c8584,_0x37aa38)[_0x3c8ecd(0x28b)]){if(pid[_0x354788])pid[_0x354788][_0x3c8ecd(0x21c)]({'function':_0x3c8ecd(0x242),'args':_0x297d55});}else logger[_0x3c8ecd(0x1fd)](_0x3c8ecd(0x257));}),_0x28e1a9['on'](_0x1f14a8(0x231),(_0x1352a5,_0x15d67a)=>{const _0x1ce80b=_0x1f14a8;if(validateAccess(_0x15d67a,_0x37aa38)[_0x1ce80b(0x28b)]){if(pid[_0x354788])pid[_0x354788]['send']({'function':_0x1ce80b(0x1b7),'args':_0x1352a5});}else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x28e1a9['on']('get-portfolio',(_0x161fba,_0x1d9c52)=>{const _0x49cb7b=_0x1f14a8;if(validateAccess(_0x1d9c52,_0x37aa38)[_0x49cb7b(0x28b)]){if(pid[_0x354788])pid[_0x354788][_0x49cb7b(0x21c)]({'function':_0x49cb7b(0x2a9),'args':_0x161fba});}else logger[_0x49cb7b(0x1fd)](_0x49cb7b(0x187));}),_0x28e1a9['on'](_0x1f14a8(0x27f),(_0x4c1eca,_0x3888e6)=>{const _0x28417a=_0x1f14a8;if(validateAccess(_0x3888e6,_0x37aa38)['allow']){if(pid[_0x354788])pid[_0x354788]['send']({'function':_0x28417a(0x30e),'args':_0x4c1eca});}else logger[_0x28417a(0x1fd)](_0x28417a(0x248));}),_0x28e1a9['on'](_0x1f14a8(0x28f),(_0x434958,_0x2af2cb)=>{const _0x4ee541=_0x1f14a8;if(validateAccess(_0x2af2cb,_0x37aa38)[_0x4ee541(0x28b)]){if(pid[_0x354788])pid[_0x354788][_0x4ee541(0x21c)]({'function':'storeHeadless','args':_0x434958});}else logger[_0x4ee541(0x1fd)](_0x4ee541(0x19d));}),_0x28e1a9['on']('store-fiat',(_0x48e68d,_0x1a0be6)=>{const _0x4dd3f1=_0x1f14a8;if(validateAccess(_0x1a0be6,_0x37aa38)['allow']){if(pid[_0x354788])pid[_0x354788][_0x4dd3f1(0x21c)]({'function':'storeFiat','args':_0x48e68d});}else logger[_0x4dd3f1(0x1fd)](_0x4dd3f1(0x2a0));}),_0x28e1a9['on'](_0x1f14a8(0x181),_0x1f7977=>{const _0x3b29f2=_0x1f14a8;if(validateAccess(_0x1f7977,_0x37aa38)[_0x3b29f2(0x28b)]){if(pid[_0x354788])pid[_0x354788]['send']({'function':_0x3b29f2(0x199),'args':null});}else logger['full'](_0x3b29f2(0x1db));}),_0x28e1a9['on'](_0x1f14a8(0x12f),_0x3fc103=>{const _0x28bc63=_0x1f14a8;if(validateAccess(_0x3fc103,_0x37aa38)['allow']){if(pid[_0x354788])pid[_0x354788][_0x28bc63(0x21c)]({'function':_0x28bc63(0x274),'args':null});}else logger[_0x28bc63(0x1fd)](_0x28bc63(0x281));}),_0x28e1a9['on'](_0x1f14a8(0x19b),(_0x5ad929,_0x37a325)=>{const _0x4b5a6c=_0x1f14a8;if(validateAccess(_0x37a325,_0x37aa38)[_0x4b5a6c(0x28b)]){if(pid[_0x354788])pid[_0x354788][_0x4b5a6c(0x21c)]({'function':_0x4b5a6c(0x1cc),'args':_0x5ad929});}else logger['full'](_0x4b5a6c(0x1a0));}),_0x28e1a9['on']('cancel-loading',_0x219ce6=>{const _0x5519b1=_0x1f14a8;if(validateAccess(_0x219ce6,_0x37aa38)['allow']){if(pid[_0x354788])pid[_0x354788][_0x5519b1(0x21c)]({'function':'cancelLoading','args':null});}else logger[_0x5519b1(0x1fd)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x28e1a9['on'](_0x1f14a8(0x27c),_0xe35347=>{const _0x2c931a=_0x1f14a8;if(validateAccess(_0xe35347,_0x37aa38)[_0x2c931a(0x28b)]){if(pid[_0x354788])pid[_0x354788][_0x2c931a(0x21c)]({'function':_0x2c931a(0x1f0),'args':null});}else logger['full'](_0x2c931a(0x1e4));}),_0x28e1a9['on']('update-bb',_0x992f26=>{const _0x5df738=_0x1f14a8;if(validateAccess(_0x992f26,_0x37aa38)['allow'])updateBB(_0x5df738(0x16b));else logger[_0x5df738(0x1fd)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x28e1a9['on']('get-messages',_0x3d3245=>{const _0x35314b=_0x1f14a8;if(validateAccess(_0x3d3245,_0x37aa38)[_0x35314b(0x28b)])getMessages();else logger[_0x35314b(0x1fd)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x28e1a9['on']('confirm-message',(_0x19b5a0,_0x2cfe8b)=>{const _0x37c96f=_0x1f14a8;if(validateAccess(_0x2cfe8b,_0x37aa38)[_0x37c96f(0x28b)])confirmMessage(_0x19b5a0);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x28e1a9['on'](_0x1f14a8(0x158),_0x3bbff7=>{const _0x40eca0=_0x1f14a8;if(validateAccess(_0x3bbff7,_0x37aa38)[_0x40eca0(0x28b)]){if(devices[_0x37aa38]['pidRefreshToken'])clearTimeout(devices[_0x37aa38][_0x40eca0(0x125)]);if(devices[_0x37aa38][_0x40eca0(0x16d)])clearTimeout(devices[_0x37aa38][_0x40eca0(0x16d)]);removeSocketListeners(getClient(_0x28e1a9['id'])[_0x40eca0(0x260)]),addBlacklist(_0x37aa38),devices[_0x37aa38][_0x40eca0(0x295)]=null,devices[_0x37aa38][_0x40eca0(0x22f)]=null,devices[_0x37aa38][_0x40eca0(0x2ef)]['token']=null,logger['debug'](_0x40eca0(0x2b6)+_0x37aa38[_0x40eca0(0x169)](-0x8)),io['to'](getClient(_0x28e1a9['id'])[_0x40eca0(0x260)])[_0x40eca0(0x29d)](_0x40eca0(0x175),{'access':{'allow':![],'reason':_0x40eca0(0x2e8),'token':null}});}else logger[_0x40eca0(0x1fd)](_0x40eca0(0x2d5));});}function removeSocketListeners(_0xd2a1a1){getClientsWithUuid(_0xd2a1a1)['forEach'](_0x555058=>{const _0x5ba05f=_0x40f3;getSocket(_0x555058['id'])[_0x5ba05f(0x23c)]();});}function cleanSettings(){const _0x817fc8=_0x381e5c;let _0x372f98=settings;return settings['telegramToken']&&settings[_0x817fc8(0x284)]!=''&&(_0x372f98={..._0x372f98,'telegramToken':'************'}),settings[_0x817fc8(0x2eb)]&&settings[_0x817fc8(0x2eb)]!=''&&(_0x372f98={..._0x372f98,'bbPassword':'************'}),(settings[_0x817fc8(0x2eb)]&&settings[_0x817fc8(0x2eb)]=='***'||settings['telegramToken']&&settings[_0x817fc8(0x284)]=='***')&&(_0x372f98={..._0x372f98,'restored':{'password':settings[_0x817fc8(0x2eb)]=='***','telegram':settings[_0x817fc8(0x284)]=='***'}}),_0x372f98;}async function updateBB(_0x42fcae){const _0x58dcaf=_0x381e5c;await backupConfigFiles(),installingUpdate=!![],config[_0x58dcaf(0x132)](_0x20f2c0=>{const _0x70e030=_0x58dcaf;restartBot(_0x20f2c0[_0x70e030(0x13a)]);});if(_0x42fcae=='update')process['send']({'update':!![],'environment':environment},_0x2fab0a=>{});else _0x42fcae==_0x58dcaf(0x275)&&process[_0x58dcaf(0x21c)]({'reinstall':!![],'environment':environment},_0x533f85=>{});}function startBot(_0xcc3894,_0x15d916,_0x5b24eb){const _0x11f467=_0x381e5c;if(debugging)_0xcc3894[_0x11f467(0x26e)]('-d');let _0x572e02=![];const _0x5e567=_0xcc3894[0x0];_0x15d916={..._0x15d916,'stdio':[_0x11f467(0x1e6),'inherit',_0x11f467(0x1e6),_0x11f467(0x2fb)]},pid[_0x5e567]=childProcess[_0x11f467(0x1f6)](botfile,_0xcc3894,_0x15d916),pid[_0x5e567]['on'](_0x11f467(0x264),_0x230d09=>{const _0x18c9fb=_0x11f467;switch(Object[_0x18c9fb(0x16e)](_0x230d09)[0x0]){case'botname':updateBotName(_0x5e567,_0x230d09[_0x18c9fb(0x1b9)]);break;case _0x18c9fb(0x1b6):updateBotManager();break;case _0x18c9fb(0x175):updateStatus(_0x5e567,_0x230d09[_0x18c9fb(0x175)]);break;case'live':updateLive(_0x5e567,_0x230d09[_0x18c9fb(0x1da)]);break;case _0x18c9fb(0x276):updateLive(_0x5e567,_0x230d09['started']),io['to'](_0x5e567)[_0x18c9fb(0x29d)](_0x18c9fb(0x175),{'access':{'allow':![],'reason':_0x18c9fb(0x2ad),'token':null}});break;case'stop':_0x230d09[_0x18c9fb(0x23d)]==_0x18c9fb(0x1f7)&&restartBot(_0x5e567);_0x230d09['stop']==_0x18c9fb(0x23e)&&toggleBot(_0x5e567,'disabled',_0x18c9fb(0x194));break;case'telegram':sendTelegramBot(_0x5e567,_0x230d09[_0x18c9fb(0x176)]);break;case _0x18c9fb(0x11d):sendTelegramMsg(_0x230d09[_0x18c9fb(0x11d)]);break;case _0x18c9fb(0x2af):io['to'](_0x5e567)[_0x18c9fb(0x29d)](_0x230d09[_0x18c9fb(0x2af)],_0x230d09[_0x18c9fb(0x22d)]);break;}}),pid[_0x5e567]['on'](_0x11f467(0x220),function(_0xa36a42){if(_0x572e02)return;_0x572e02=!![],_0x5b24eb(_0xa36a42);}),pid[_0x5e567]['on'](_0x11f467(0x25b),async function(_0x218dd9){const _0x6c45c4=_0x11f467;if(terminating)return;if(installingUpdate){logger['debug']('Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process'),io[_0x6c45c4(0x122)]();return;}if(_0x572e02)return;_0x572e02=!![],_0x5b24eb(null);const _0x35006=dbConfig[_0x6c45c4(0x1a7)](_0x6c45c4(0x1dc))[_0x6c45c4(0x225)]({'botID':_0x5e567})[_0x6c45c4(0x18a)]();_0x35006&&(_0x35006[_0x6c45c4(0x175)]==_0x6c45c4(0x2d4)||_0x35006[_0x6c45c4(0x175)]==_0x6c45c4(0x1d4))&&(await sleep(0x3e8),updateLive(_0x5e567,'stopped'),logger[_0x6c45c4(0x1fd)](_0x6c45c4(0x119)+_0x5e567),startBot([_0x5e567,userID],{'cwd':bbpath},function(_0x1f0d02){const _0x75e92e=_0x6c45c4;if(_0x1f0d02)logger[_0x75e92e(0x1fd)](_0x1f0d02);}));});}function stopBot(_0x363d99){const _0x31539b=_0x381e5c;getClientsWithBotID(_0x363d99)[_0x31539b(0x132)](_0x58d4cf=>{const _0x44881b=_0x31539b;getSocket(_0x58d4cf['id'])[_0x44881b(0x1b5)](!![]),removeClient(_0x58d4cf['id']);}),pid[_0x363d99]&&(pid[_0x363d99]['kill'](),pid[_0x363d99]=null);}function stopAllBots(){const _0x244a1f=_0x381e5c;terminating=!![];const _0x329852=getEnabledBots();_0x329852[_0x244a1f(0x132)](_0x30ee02=>{const _0x41a77e=_0x244a1f;stopBot(_0x30ee02[_0x41a77e(0x13a)]);});}function restartBot(_0x443d01){const _0x386b19=_0x381e5c;if(pid[_0x443d01])pid[_0x443d01][_0x386b19(0x23e)]();}function addBot(){const _0x185cc6=_0x381e5c;let _0x36a19c;for(let _0x21d744=0x1;_0x21d744<0x3e9;_0x21d744++){_0x36a19c=_0x21d744[_0x185cc6(0x2b2)]()['padStart'](0x3,'0');let _0x731d1f=config[_0x185cc6(0x225)](_0x232a31=>_0x232a31[_0x185cc6(0x13a)]==_0x36a19c);if(!_0x731d1f)break;}if(_0x36a19c===_0x185cc6(0x167)){logger['full']('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x185cc6(0x1fd)](_0x185cc6(0x279)+_0x36a19c),dbConfig['get'](_0x185cc6(0x1dc))['push']({'botID':_0x36a19c,'botname':_0x185cc6(0x2c1)+_0x36a19c,'status':_0x185cc6(0x1d4),'live':''})[_0x185cc6(0x25d)](),startBot([_0x36a19c,userID],{'cwd':bbpath},function(_0x12a87b){const _0x1a04ff=_0x185cc6;if(_0x12a87b)logger[_0x1a04ff(0x1fd)](_0x12a87b);}),config=getConfiguration(),io['to']('botmanager')['emit'](_0x185cc6(0x1dc),config),broadcastToBots('bots',JSON[_0x185cc6(0x207)](config));}function deleteBot(_0x34d086){const _0x40c6f2=_0x381e5c;getClientsWithBotID(_0x34d086)[_0x40c6f2(0x132)](_0x48e5a8=>{const _0x3ce1ae=_0x40c6f2;getSocket(_0x48e5a8['id'])[_0x3ce1ae(0x1b5)](!![]),removeClient(_0x48e5a8['id']);}),dbConfig[_0x40c6f2(0x1a7)]('bots')[_0x40c6f2(0x2a6)]({'botID':_0x34d086})[_0x40c6f2(0x25d)](),logger['full'](_0x40c6f2(0x2f1)+_0x34d086),stopBot(_0x34d086);try{if(fs[_0x40c6f2(0x131)](path[_0x40c6f2(0x11e)](configpath,_0x40c6f2(0x217)+_0x34d086+'-config.json')))fs['unlinkSync'](path[_0x40c6f2(0x11e)](configpath,_0x40c6f2(0x217)+_0x34d086+_0x40c6f2(0x212)));if(fs[_0x40c6f2(0x131)](path[_0x40c6f2(0x11e)](configpath,_0x40c6f2(0x217)+_0x34d086+_0x40c6f2(0x142))))fs[_0x40c6f2(0x12c)](path['join'](configpath,'bot-'+_0x34d086+_0x40c6f2(0x142)));if(fs[_0x40c6f2(0x131)](path[_0x40c6f2(0x11e)](configpath,'bot-'+_0x34d086+'-performance.json')))fs['unlinkSync'](path[_0x40c6f2(0x11e)](configpath,'bot-'+_0x34d086+_0x40c6f2(0x307)));if(fs['existsSync'](path['join'](configpath,_0x40c6f2(0x217)+_0x34d086+'-results.json')))fs[_0x40c6f2(0x12c)](path[_0x40c6f2(0x11e)](configpath,'bot-'+_0x34d086+_0x40c6f2(0x129)));}catch(_0x4ae4d3){if(_0x4ae4d3)logger[_0x40c6f2(0x1fd)](_0x40c6f2(0x173),_0x4ae4d3);}config=getConfiguration(),io['to'](_0x40c6f2(0x2f7))[_0x40c6f2(0x29d)](_0x40c6f2(0x1dc),config),broadcastToBots('bots',JSON[_0x40c6f2(0x207)](config));}function toggleBot(_0x1257f4,_0xc79dd9,_0xe1c01e){const _0x1057f3=_0x381e5c;dbConfig[_0x1057f3(0x1a7)](_0x1057f3(0x1dc))['find']({'botID':_0x1257f4})[_0x1057f3(0x123)]({'status':_0xc79dd9})[_0x1057f3(0x123)]({'live':_0xe1c01e})[_0x1057f3(0x25d)]();if(_0xc79dd9==_0x1057f3(0x2d4)||_0xc79dd9=='new')logger[_0x1057f3(0x1fd)](_0x1057f3(0x1ab)+_0x1257f4),startBot([_0x1257f4,userID],{'cwd':bbpath},function(_0x3d041){const _0x44ac3b=_0x1057f3;if(_0x3d041)logger[_0x44ac3b(0x1fd)](_0x3d041);});else(_0xc79dd9==_0x1057f3(0x1f4)||_0xc79dd9==_0x1057f3(0x228))&&(logger[_0x1057f3(0x1fd)]('Disabled\x20Bot\x20'+_0x1257f4),stopBot(_0x1257f4));config=getConfiguration(),io['to'](_0x1057f3(0x2f7))[_0x1057f3(0x29d)](_0x1057f3(0x1dc),config),broadcastToBots('bots',JSON[_0x1057f3(0x207)](config));}function toggleStatus(_0x16dfef){const _0x935223=_0x381e5c;let _0x5437a6=dbConfig[_0x935223(0x1a7)](_0x935223(0x1dc))[_0x935223(0x225)]({'botID':_0x16dfef})['value'](),_0x3181f7;if(_0x5437a6[_0x935223(0x175)]===_0x935223(0x2d4))_0x3181f7=_0x935223(0x1f4);else{if(_0x5437a6[_0x935223(0x175)]===_0x935223(0x1d4))_0x3181f7='new-disabled';else{if(_0x5437a6[_0x935223(0x175)]===_0x935223(0x228))_0x3181f7=_0x935223(0x1d4);else{if(_0x5437a6['status']===_0x935223(0x1f4))_0x3181f7=_0x935223(0x2d4);}}}return _0x3181f7;}function updateStatus(_0x1d2819,_0x4f984e){const _0x1c2f02=_0x381e5c;dbConfig[_0x1c2f02(0x1a7)](_0x1c2f02(0x1dc))[_0x1c2f02(0x225)]({'botID':_0x1d2819})[_0x1c2f02(0x123)]({'status':_0x4f984e})[_0x1c2f02(0x25d)](),config=getConfiguration(),io['to'](_0x1c2f02(0x2f7))['emit'](_0x1c2f02(0x1dc),config),broadcastToBots('bots',JSON[_0x1c2f02(0x207)](config));}function updateLive(_0x418c09,_0x3c49d2){const _0x2ea533=_0x381e5c;dbConfig['get'](_0x2ea533(0x1dc))['find']({'botID':_0x418c09})['assign']({'live':_0x3c49d2})[_0x2ea533(0x25d)](),config=getConfiguration(),io['to'](_0x2ea533(0x2f7))['emit'](_0x2ea533(0x1dc),config),broadcastToBots(_0x2ea533(0x1dc),JSON[_0x2ea533(0x207)](config));}function updateBotName(_0x11d781,_0x26e31f){const _0x5b3bfd=_0x381e5c;dbConfig[_0x5b3bfd(0x1a7)](_0x5b3bfd(0x1dc))[_0x5b3bfd(0x225)]({'botID':_0x11d781})['assign']({'botname':_0x26e31f})[_0x5b3bfd(0x25d)](),config=getConfiguration(),io['to'](_0x5b3bfd(0x2f7))[_0x5b3bfd(0x29d)]('bots',config),broadcastToBots(_0x5b3bfd(0x1dc),JSON['stringify'](config));}function updateBotManager(){const _0x5597bf=_0x381e5c;config=getConfiguration(),io['to'](_0x5597bf(0x2f7))[_0x5597bf(0x29d)](_0x5597bf(0x1dc),config),broadcastToBots(_0x5597bf(0x1dc),JSON[_0x5597bf(0x207)](config));}function toggleBotMode(_0x57b079){const _0x328744=_0x381e5c;if(pid[_0x57b079])pid[_0x57b079]['send']({'function':_0x328744(0x282),'args':null});else{const _0x39883f=configpath+_0x328744(0x217)+_0x57b079+_0x328744(0x212),_0x115502=fs[_0x328744(0x2e7)](_0x39883f),_0x5be0ca=JSON[_0x328744(0x1ca)](_0x115502),_0x367ec2=_0x5be0ca[_0x328744(0x12d)][0x0]['headless'];_0x5be0ca['bot'][0x0][_0x328744(0x121)]=!_0x367ec2;const _0xfde2b7=JSON[_0x328744(0x207)](_0x5be0ca,null,0x2);fs[_0x328744(0x1b8)](_0x39883f,_0xfde2b7),config=getConfiguration(),io['to'](_0x328744(0x2f7))[_0x328744(0x29d)](_0x328744(0x1dc),config),broadcastToBots(_0x328744(0x1dc),JSON[_0x328744(0x207)](config));}}function validateTelegram(_0x1d0b4e){const _0x29e99b=_0x381e5c;if(_0x1d0b4e[_0x29e99b(0x1af)]['username']!=settings[_0x29e99b(0x1ea)]&&'@'+_0x1d0b4e[_0x29e99b(0x1af)][_0x29e99b(0x1de)]!=settings['telegramUsername']||_0x1d0b4e['chat']['id']!=settings[_0x29e99b(0x168)])return sendTelegram(_0x1d0b4e['chat']['id'],_0x29e99b(0x12b),{'parse_mode':_0x29e99b(0x2a2)}),![];return!![];}async function initTelegram(){const _0x2f90d3=_0x381e5c;if(tgBot)tgBot[_0x2f90d3(0x23d)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings[_0x2f90d3(0x284)]);let _0x20d8c6='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x20d8c6+='\x0a',_0x20d8c6+=_0x2f90d3(0x1fa),_0x20d8c6+=_0x2f90d3(0x1c2),_0x20d8c6+=_0x2f90d3(0x12a),_0x20d8c6+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x20d8c6+=_0x2f90d3(0x20f),_0x20d8c6+=_0x2f90d3(0x2db),_0x20d8c6+=_0x2f90d3(0x1fe),_0x20d8c6+=_0x2f90d3(0x182),_0x20d8c6+=_0x2f90d3(0x28a),_0x20d8c6+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x20d8c6+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x20d8c6+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x20d8c6+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x20d8c6+=_0x2f90d3(0x144);let _0x405681=_0x2f90d3(0x159);_0x405681+='\x0a',_0x405681+=_0x20d8c6,tgBot[_0x2f90d3(0x1a4)]((_0x3fe64e,_0x23ad41)=>{const _0x3235ab=_0x2f90d3;logger[_0x3235ab(0x221)](getTimeStamp()+_0x3235ab(0x1ec)),logger[_0x3235ab(0x14e)](_0x3235ab(0x13f),_0x3fe64e);}),tgBot['use'](async(_0x2be5e8,_0x3288cd)=>{const _0x71fb71=_0x2f90d3;if(!(!settings[_0x71fb71(0x168)]&&_0x2be5e8['update'][_0x71fb71(0x264)][_0x71fb71(0x1ac)]==_0x71fb71(0x294))){if(!validateTelegram(_0x2be5e8))return;}_0x3288cd();}),tgBot['command'](_0x2f90d3(0x197),async _0x2afe90=>{const _0x32ddb2=_0x2f90d3;if(!settings[_0x32ddb2(0x168)])updateSetting(_0x32ddb2(0x168),_0x2afe90['chat']['id']);updateSetting(_0x32ddb2(0x308),!![]);if(!validateTelegram(_0x2afe90))return;await sendTelegram(_0x2afe90[_0x32ddb2(0x1f8)]['id'],_0x405681);}),tgBot['command'](_0x2f90d3(0x11a),async _0x1993f8=>{const _0x56456e=_0x2f90d3;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x1993f8[_0x56456e(0x1f8)]['id'],'Notifications\x20enabled');}),tgBot[_0x2f90d3(0x15c)]('disable',async _0x315b21=>{const _0x21349b=_0x2f90d3;await sendTelegram(_0x315b21[_0x21349b(0x1f8)]['id'],_0x21349b(0x2f5)),updateSetting('telegramEnabled',![]);}),tgBot[_0x2f90d3(0x15c)](_0x2f90d3(0x1bb),async _0x13d32e=>{const _0x8b3a72=_0x2f90d3,_0x2cc173=Markup[_0x8b3a72(0x128)]([Markup['button'][_0x8b3a72(0x2b7)](_0x8b3a72(0x114),_0x8b3a72(0x28c)),Markup[_0x8b3a72(0x229)]['callback']('Alerts',_0x8b3a72(0x236)),Markup[_0x8b3a72(0x229)]['callback']('All',_0x8b3a72(0x2ca))]);_0x13d32e[_0x8b3a72(0x1c4)](_0x8b3a72(0x1e7),_0x2cc173);}),tgBot['action'](_0x2f90d3(0x28c),async _0x54fd8d=>{const _0x9f78ef=_0x2f90d3;_0x54fd8d[_0x9f78ef(0x27d)](),updateSetting(_0x9f78ef(0x13c),'orders'),updateSetting(_0x9f78ef(0x308),!![]),await sendTelegram(_0x54fd8d[_0x9f78ef(0x1f8)]['id'],_0x9f78ef(0x2c0));}),tgBot[_0x2f90d3(0x145)]('config_alerts',async _0x7a5f08=>{const _0x47ef72=_0x2f90d3;_0x7a5f08[_0x47ef72(0x27d)](),updateSetting(_0x47ef72(0x13c),'alerts'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x7a5f08[_0x47ef72(0x1f8)]['id'],_0x47ef72(0x18b));}),tgBot[_0x2f90d3(0x145)](_0x2f90d3(0x2ca),async _0xf77ff0=>{const _0x1d87d0=_0x2f90d3;_0xf77ff0[_0x1d87d0(0x27d)](),updateSetting(_0x1d87d0(0x13c),_0x1d87d0(0x1cb)),updateSetting(_0x1d87d0(0x308),!![]),await sendTelegram(_0xf77ff0[_0x1d87d0(0x1f8)]['id'],_0x1d87d0(0x2bf));}),tgBot['command'](_0x2f90d3(0x175),async _0xfb94ba=>{const _0x945b20=_0x2f90d3,_0x4c9bac=getBotsWithMode();let _0x3d35cb=_0x945b20(0x266);config[_0x945b20(0x132)](_0x28b298=>{const _0x2c74d7=_0x945b20,_0x220694=_0x4c9bac[_0x2c74d7(0x225)](_0x2b40b0=>_0x2b40b0[_0x2c74d7(0x13a)]==_0x28b298['botID'])[_0x2c74d7(0x24c)];_0x3d35cb+='Bot\x20'+_0x28b298['botID']+':\x20'+_0x28b298['status']+_0x2c74d7(0x213)+_0x220694+_0x2c74d7(0x213)+_0x28b298[_0x2c74d7(0x1da)]+'\x0a';}),_0x3d35cb+='\x0a',_0x3d35cb+=_0x945b20(0x115),_0x3d35cb+=!settings[_0x945b20(0x308)]?_0x945b20(0x16a):'Notifications\x20enabled\x0a',_0x3d35cb+=settings['telegramEnabled']?settings['telegramEvents']==_0x945b20(0x1cb)?_0x945b20(0x2b4):_0x945b20(0x252)+settings[_0x945b20(0x13c)]+_0x945b20(0x286):'',await sendTelegram(_0xfb94ba[_0x945b20(0x1f8)]['id'],_0x3d35cb,{'parse_mode':_0x945b20(0x2a2)});}),tgBot[_0x2f90d3(0x15c)](_0x2f90d3(0x1f7),async _0x169973=>{const _0x485fca=_0x2f90d3,_0xf23057=getEnabledBots();if(_0xf23057['length']==0x0)await sendTelegram(_0x169973[_0x485fca(0x1f8)]['id'],_0x485fca(0x18d));else{if(_0xf23057[_0x485fca(0x193)]>0x1)_0xf23057['push']({'botID':_0x485fca(0x1cb)});let _0x15855b=[],_0x433c9a=[];const _0x132e7d=_0xf23057['length']%0x4==0x0||_0xf23057[_0x485fca(0x193)]%0x4==0x3||_0xf23057['length']%0x3==0x1?0x4:0x3;let _0xd6fcb8=0x0;_0xf23057[_0x485fca(0x132)]((_0x3b262c,_0x4165bb)=>{const _0x107161=_0x485fca;if(_0x4165bb%_0x132e7d==0x0)_0x433c9a=[];_0x433c9a['push'](Markup[_0x107161(0x229)][_0x107161(0x2b7)](_0x3b262c[_0x107161(0x13a)]==_0x107161(0x1cb)?'All\x20bots':_0x107161(0x2c1)+_0x3b262c[_0x107161(0x13a)],_0x107161(0x1a5)+_0x3b262c[_0x107161(0x13a)])),_0x4165bb%_0x132e7d==0x0&&(_0x15855b[_0xd6fcb8]=_0x433c9a,_0xd6fcb8++);});const _0x33292e=Markup[_0x485fca(0x128)](_0x15855b);_0x169973[_0x485fca(0x1c4)](_0x485fca(0x306),_0x33292e);}}),tgBot[_0x2f90d3(0x145)](/restart_(.+)/,async _0x106138=>{const _0x2d08d0=_0x2f90d3,_0x3be1d8=_0x106138[_0x2d08d0(0x304)][0x1];_0x106138[_0x2d08d0(0x27d)](),_0x3be1d8==_0x2d08d0(0x1cb)?config[_0x2d08d0(0x132)](_0x345a1b=>{const _0x393ea2=_0x2d08d0;restartBot(_0x345a1b[_0x393ea2(0x13a)]);}):restartBot(_0x3be1d8);}),tgBot[_0x2f90d3(0x15c)]('on',async _0x591709=>{const _0x4c4064=_0x2f90d3,_0x41b0ef=getDisabledBots();if(_0x41b0ef[_0x4c4064(0x193)]==0x0)await sendTelegram(_0x591709[_0x4c4064(0x1f8)]['id'],_0x4c4064(0x2b5));else{if(_0x41b0ef[_0x4c4064(0x193)]>0x1)_0x41b0ef[_0x4c4064(0x26e)]({'botID':_0x4c4064(0x1cb)});let _0x45e10b=[],_0x2013e2=[];const _0x42fb3e=_0x41b0ef[_0x4c4064(0x193)]%0x4==0x0||_0x41b0ef[_0x4c4064(0x193)]%0x4==0x3||_0x41b0ef[_0x4c4064(0x193)]%0x3==0x1?0x4:0x3;let _0x1b2fcb=0x0;_0x41b0ef[_0x4c4064(0x132)]((_0x2a578d,_0x6d9746)=>{const _0x11d3f1=_0x4c4064;if(_0x6d9746%_0x42fb3e==0x0)_0x2013e2=[];_0x2013e2[_0x11d3f1(0x26e)](Markup[_0x11d3f1(0x229)][_0x11d3f1(0x2b7)](_0x2a578d[_0x11d3f1(0x13a)]==_0x11d3f1(0x1cb)?_0x11d3f1(0x183):'Bot\x20'+_0x2a578d[_0x11d3f1(0x13a)],_0x11d3f1(0x234)+_0x2a578d[_0x11d3f1(0x13a)])),_0x6d9746%_0x42fb3e==0x0&&(_0x45e10b[_0x1b2fcb]=_0x2013e2,_0x1b2fcb++);});const _0x2809fc=Markup[_0x4c4064(0x128)](_0x45e10b);_0x591709['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x2809fc);}}),tgBot[_0x2f90d3(0x145)](/on_(.+)/,async _0x597984=>{const _0x5d66c2=_0x2f90d3,_0x4dc5b5=_0x597984[_0x5d66c2(0x304)][0x1];_0x597984[_0x5d66c2(0x27d)]();if(_0x4dc5b5=='all'){const _0x57c781=getDisabledBots();await sendTelegram(_0x597984[_0x5d66c2(0x1f8)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x57c781[_0x5d66c2(0x132)](_0x4966f4=>{const _0x514983=_0x5d66c2;if(_0x4966f4[_0x514983(0x13a)]!='all')toggleBot(_0x4966f4[_0x514983(0x13a)],toggleStatus(_0x4966f4[_0x514983(0x13a)]),_0x514983(0x194));});}else await sendTelegram(_0x597984[_0x5d66c2(0x1f8)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x4dc5b5),toggleBot(_0x4dc5b5,toggleStatus(_0x4dc5b5),_0x5d66c2(0x194));}),tgBot[_0x2f90d3(0x15c)](_0x2f90d3(0x24d),async _0x48e601=>{const _0x28640c=_0x2f90d3,_0x5932d7=getEnabledBots();if(_0x5932d7[_0x28640c(0x193)]==0x0)await sendTelegram(_0x48e601[_0x28640c(0x1f8)]['id'],_0x28640c(0x18d));else{if(_0x5932d7[_0x28640c(0x193)]>0x1)_0x5932d7[_0x28640c(0x26e)]({'botID':_0x28640c(0x1cb)});let _0x23de9c=[],_0x1055fc=[];const _0x283f52=_0x5932d7[_0x28640c(0x193)]%0x4==0x0||_0x5932d7[_0x28640c(0x193)]%0x4==0x3||_0x5932d7['length']%0x3==0x1?0x4:0x3;let _0x344b10=0x0;_0x5932d7[_0x28640c(0x132)]((_0x4cddc7,_0x168614)=>{const _0x285e60=_0x28640c;if(_0x168614%_0x283f52==0x0)_0x1055fc=[];_0x1055fc[_0x285e60(0x26e)](Markup[_0x285e60(0x229)][_0x285e60(0x2b7)](_0x4cddc7[_0x285e60(0x13a)]==_0x285e60(0x1cb)?_0x285e60(0x183):_0x285e60(0x2c1)+_0x4cddc7['botID'],_0x285e60(0x177)+_0x4cddc7[_0x285e60(0x13a)])),_0x168614%_0x283f52==0x0&&(_0x23de9c[_0x344b10]=_0x1055fc,_0x344b10++);});const _0x3781af=Markup[_0x28640c(0x128)](_0x23de9c);_0x48e601[_0x28640c(0x1c4)](_0x28640c(0x201),_0x3781af);}}),tgBot[_0x2f90d3(0x145)](/off_(.+)/,async _0x3d9b82=>{const _0x4b7750=_0x2f90d3,_0x225dfb=_0x3d9b82[_0x4b7750(0x304)][0x1];_0x3d9b82['editMessageReplyMarkup']();if(_0x225dfb==_0x4b7750(0x1cb)){const _0x545527=getEnabledBots();await sendTelegram(_0x3d9b82[_0x4b7750(0x1f8)]['id'],_0x4b7750(0x1a1)),_0x545527[_0x4b7750(0x132)](_0x22428e=>{const _0x38544a=_0x4b7750;if(_0x22428e[_0x38544a(0x13a)]!=_0x38544a(0x1cb))toggleBot(_0x22428e['botID'],toggleStatus(_0x22428e[_0x38544a(0x13a)]),_0x38544a(0x194));});}else await sendTelegram(_0x3d9b82[_0x4b7750(0x1f8)]['id'],_0x4b7750(0x19e)+_0x225dfb),toggleBot(_0x225dfb,toggleStatus(_0x225dfb),'stopped');}),tgBot['command'](_0x2f90d3(0x2b8),async _0x20a4d9=>{const _0x27c338=_0x2f90d3,_0x448ce6=getEnabledBots();if(_0x448ce6[_0x27c338(0x193)]==0x0)await sendTelegram(_0x20a4d9[_0x27c338(0x1f8)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x448ce6[_0x27c338(0x193)]>0x1){let _0x436090=[],_0x33af7c=[];const _0x199036=_0x448ce6[_0x27c338(0x193)]%0x4==0x0||_0x448ce6['length']%0x4==0x3||_0x448ce6[_0x27c338(0x193)]%0x3==0x1?0x4:0x3;let _0x2995df=0x0;_0x448ce6[_0x27c338(0x132)]((_0x3acaf6,_0xa2ace6)=>{const _0x410942=_0x27c338;if(_0xa2ace6%_0x199036==0x0)_0x33af7c=[];_0x33af7c[_0x410942(0x26e)](Markup[_0x410942(0x229)][_0x410942(0x2b7)](_0x410942(0x2c1)+_0x3acaf6['botID'],'metrics_'+_0x3acaf6[_0x410942(0x13a)])),_0xa2ace6%_0x199036==0x0&&(_0x436090[_0x2995df]=_0x33af7c,_0x2995df++);});const _0xa9f561=Markup[_0x27c338(0x128)](_0x436090);_0x20a4d9[_0x27c338(0x1c4)](_0x27c338(0x237),_0xa9f561);}else{const _0x2370bb=_0x448ce6[0x0]['botID'];if(pid[_0x2370bb])pid[_0x2370bb][_0x27c338(0x21c)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x2f90d3(0x145)](/metrics_(.+)/,async _0xe91c72=>{const _0x25b7b2=_0x2f90d3,_0x51e220=_0xe91c72[_0x25b7b2(0x304)][0x1];_0xe91c72[_0x25b7b2(0x27d)]();if(pid[_0x51e220])pid[_0x51e220][_0x25b7b2(0x21c)]({'function':_0x25b7b2(0x29f),'args':null});}),tgBot[_0x2f90d3(0x15c)](_0x2f90d3(0x21d),async _0x4d1b7e=>{const _0xf4d9dc=_0x2f90d3,_0x831fa2=getEnabledBots();if(_0x831fa2[_0xf4d9dc(0x193)]==0x0)await sendTelegram(_0x4d1b7e['chat']['id'],_0xf4d9dc(0x18d));else{if(_0x831fa2[_0xf4d9dc(0x193)]>0x1){let _0x21aefd=[],_0x4fe3ac=[];const _0x1ad84c=_0x831fa2['length']%0x4==0x0||_0x831fa2[_0xf4d9dc(0x193)]%0x4==0x3||_0x831fa2[_0xf4d9dc(0x193)]%0x3==0x1?0x4:0x3;let _0x5a6acf=0x0;_0x831fa2['forEach']((_0x4a4731,_0x5dc3b8)=>{const _0x559974=_0xf4d9dc;if(_0x5dc3b8%_0x1ad84c==0x0)_0x4fe3ac=[];_0x4fe3ac[_0x559974(0x26e)](Markup['button'][_0x559974(0x2b7)]('Bot\x20'+_0x4a4731[_0x559974(0x13a)],_0x559974(0x285)+_0x4a4731[_0x559974(0x13a)])),_0x5dc3b8%_0x1ad84c==0x0&&(_0x21aefd[_0x5a6acf]=_0x4fe3ac,_0x5a6acf++);});const _0x479d09=Markup[_0xf4d9dc(0x128)](_0x21aefd);_0x4d1b7e[_0xf4d9dc(0x1c4)](_0xf4d9dc(0x13d),_0x479d09);}else{const _0x2873c4=_0x831fa2[0x0][_0xf4d9dc(0x13a)];if(pid[_0x2873c4])pid[_0x2873c4]['send']({'function':_0xf4d9dc(0x25c),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x380504=>{const _0x2a32e7=_0x2f90d3,_0x2629d7=_0x380504[_0x2a32e7(0x304)][0x1];_0x380504[_0x2a32e7(0x27d)]();if(pid[_0x2629d7])pid[_0x2629d7][_0x2a32e7(0x21c)]({'function':_0x2a32e7(0x25c),'args':null});}),tgBot[_0x2f90d3(0x15c)](_0x2f90d3(0x16b),async _0x42bcec=>{const _0x2db2de=_0x2f90d3;await getMessages();if(!updateAvailable)await sendTelegram(_0x42bcec['chat']['id'],_0x2db2de(0x243));else{if(!validInstallation)await sendTelegram(_0x42bcec[_0x2db2de(0x1f8)]['id'],_0x2db2de(0x2d0));else{const _0x33889f=Markup[_0x2db2de(0x128)]([Markup['button']['callback'](_0x2db2de(0x300),_0x2db2de(0x293)),Markup[_0x2db2de(0x229)][_0x2db2de(0x2b7)]('No',_0x2db2de(0x26d))]);_0x42bcec['reply']('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x33889f);}}}),tgBot['action'](/update_(.+)/,async _0x16609a=>{const _0x57392a=_0x2f90d3,_0x47b36=_0x16609a[_0x57392a(0x304)][0x1];_0x16609a['editMessageReplyMarkup'](),_0x47b36==_0x57392a(0x2f0)&&(await sendTelegram(_0x16609a[_0x57392a(0x1f8)]['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB(_0x57392a(0x16b))),_0x47b36=='no'&&await sendTelegram(_0x16609a[_0x57392a(0x1f8)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot[_0x2f90d3(0x15c)]('reinstall',async _0x3f21ca=>{const _0x3c49bc=_0x2f90d3;if(!validInstallation)await sendTelegram(_0x3f21ca[_0x3c49bc(0x1f8)]['id'],_0x3c49bc(0x278));else{const _0x2fc8f3=Markup[_0x3c49bc(0x128)]([Markup['button'][_0x3c49bc(0x2b7)]('Yes',_0x3c49bc(0x30f)),Markup[_0x3c49bc(0x229)][_0x3c49bc(0x2b7)]('No',_0x3c49bc(0x204))]);_0x3f21ca[_0x3c49bc(0x1c4)](_0x3c49bc(0x11b),_0x2fc8f3);}}),tgBot[_0x2f90d3(0x145)](/reinstall_(.+)/,async _0x58c13a=>{const _0x4979bf=_0x2f90d3,_0x9a6d24=_0x58c13a[_0x4979bf(0x304)][0x1];_0x58c13a[_0x4979bf(0x27d)](),_0x9a6d24=='yes'&&(await sendTelegram(_0x58c13a[_0x4979bf(0x1f8)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x4979bf(0x275))),_0x9a6d24=='no'&&await sendTelegram(_0x58c13a['chat']['id'],_0x4979bf(0x161));}),tgBot[_0x2f90d3(0x15c)]('toggle',async _0x2d0eab=>{const _0x356de8=_0x2f90d3,_0x20ddd0=getBotsWithMode();if(_0x20ddd0[_0x356de8(0x193)]==0x0)await sendTelegram(_0x2d0eab['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x3bc8e4=[],_0x3c0577=[];const _0x1766fe=0x2;let _0x14513c=0x0;_0x20ddd0[_0x356de8(0x132)]((_0x468c96,_0x14462f)=>{const _0x719f40=_0x356de8;if(_0x14462f%_0x1766fe==0x0)_0x3c0577=[];_0x3c0577[_0x719f40(0x26e)](Markup[_0x719f40(0x229)]['callback']('Bot\x20'+_0x468c96[_0x719f40(0x13a)]+'\x20('+_0x468c96[_0x719f40(0x24c)]+')',_0x719f40(0x291)+_0x468c96[_0x719f40(0x13a)])),_0x14462f%_0x1766fe==0x0&&(_0x3bc8e4[_0x14513c]=_0x3c0577,_0x14513c++);});const _0x6a1c92=Markup[_0x356de8(0x128)](_0x3bc8e4);_0x2d0eab[_0x356de8(0x1c4)](_0x356de8(0x245),_0x6a1c92);}}),tgBot['action'](/toggle_(.+)/,async _0x3a6418=>{const _0x5980b3=_0x2f90d3,_0x50f07f=_0x3a6418[_0x5980b3(0x304)][0x1];_0x3a6418['editMessageReplyMarkup']();const _0x14f72c=getBotsWithMode(),_0x29d9ab=_0x14f72c[_0x5980b3(0x225)](_0x2c63cb=>_0x2c63cb[_0x5980b3(0x13a)]==_0x50f07f),_0x142e59=_0x29d9ab[_0x5980b3(0x24c)]==_0x5980b3(0x174)?_0x5980b3(0x253):'auto';await sendTelegram(_0x3a6418['chat']['id'],_0x5980b3(0x138)+_0x50f07f+_0x5980b3(0x205)+_0x142e59+'\x20mode'),toggleBotMode(_0x50f07f);}),tgBot[_0x2f90d3(0x15c)](_0x2f90d3(0x270),async _0x38df9f=>{const _0x330fce=_0x2f90d3;let _0x3c78e7='';config['forEach'](_0x1786d2=>{const _0x523ad2=_0x40f3;_0x3c78e7+=_0x523ad2(0x2c1)+_0x1786d2['botID']+':\x20'+_0x1786d2['botname']+'\x0a';}),await sendTelegram(_0x38df9f[_0x330fce(0x1f8)]['id'],_0x3c78e7,{'parse_mode':_0x330fce(0x2a2)});}),tgBot['command'](_0x2f90d3(0x15b),async _0x1d1930=>{const _0x3dae03=_0x2f90d3;await sendTelegram(_0x1d1930[_0x3dae03(0x1f8)]['id'],_0x20d8c6);}),process['once']('SIGINT',()=>tgBot['stop'](_0x2f90d3(0x2ae))),process[_0x2f90d3(0x162)]('SIGTERM',()=>tgBot[_0x2f90d3(0x23d)](_0x2f90d3(0x1d0))),tgBot[_0x2f90d3(0x155)]();}}function disableTelegram(){const _0x25f640=_0x381e5c;tgBot&&tgBot[_0x25f640(0x23d)]();}async function sendTelegram(_0xd637f,_0x39383a,_0x2025da){const _0x56bf58=_0x381e5c;try{await tgBot['telegram'][_0x56bf58(0x1ce)](_0xd637f,_0x39383a,_0x2025da);}catch(_0x80d768){console[_0x56bf58(0x280)](_0x56bf58(0x1c7),_0x80d768);}}async function sendTelegramBot(_0x25008f,_0x15722e){const _0x177a46=_0x381e5c;if(settings['telegramEnabled']){if(settings[_0x177a46(0x13c)]=='all'||(_0x15722e['type']==_0x177a46(0x220)||_0x15722e[_0x177a46(0x139)]==_0x177a46(0x1cf)||_0x15722e['type']=='success')&&settings['telegramEvents']==_0x177a46(0x1d6)||_0x15722e[_0x177a46(0x139)]==_0x177a46(0x265)&&settings[_0x177a46(0x13c)]==_0x177a46(0x17a)){if(tgBot&&settings['telegramChatId']){if(_0x15722e[_0x177a46(0x2c5)])await sendTelegram(settings['telegramChatId'],_0x15722e[_0x177a46(0x1b9)]+_0x177a46(0x1ae)+_0x15722e[_0x177a46(0x1e9)]);else await sendTelegram(settings['telegramChatId'],_0x177a46(0x2c1)+_0x25008f+_0x177a46(0x1ae)+_0x15722e[_0x177a46(0x1e9)]);}}}}async function sendTelegramMsg(_0x18bb6b,_0x20f1b3=_0x381e5c(0x2a2)){const _0x1ed7a4=_0x381e5c;return settings[_0x1ed7a4(0x308)]&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x1ed7a4(0x168)],_0x18bb6b,{'parse_mode':_0x20f1b3}),!![]):![];}function getDeviceWithIp(_0x5b3b38){const _0x5ab91d=_0x381e5c;return devices[_0x5ab91d(0x225)](_0x35ebfd=>_0x35ebfd['ip']===_0x5b3b38);}async function temporaryAccess2FA(_0x593200,_0x4803e9){const _0x163b6f=_0x381e5c;let _0x51e481=new Date(),_0x276620=![];if(lastIpApproval){if(_0x51e481-lastIpApproval<0x1388)_0x276620=!![];}lastIpApproval=new Date();if(_0x276620)return;if(tgBot&&settings[_0x163b6f(0x168)]){const _0x6ea91=uuidRandom();tmpStorage[_0x6ea91]={'uuid':_0x593200,'externalip':_0x4803e9};const _0x3ce23e=Markup[_0x163b6f(0x128)]([Markup[_0x163b6f(0x229)]['callback']('5\x20min',_0x163b6f(0x127)+_0x6ea91),Markup['button']['callback'](_0x163b6f(0x17d),_0x163b6f(0x2c2)+_0x6ea91),Markup[_0x163b6f(0x229)][_0x163b6f(0x2b7)](_0x163b6f(0x2f8),'tempaccess_30_'+_0x6ea91),Markup['button'][_0x163b6f(0x2b7)](_0x163b6f(0x117),_0x163b6f(0x26a)+_0x6ea91)]);await sendTelegram(settings[_0x163b6f(0x168)],_0x163b6f(0x22e)+normalizeIP(_0x4803e9)[_0x163b6f(0x25e)]+'\x20?',_0x3ce23e),tgBot[_0x163b6f(0x145)](/tempaccess_(.+)_(.+)/,async _0x4cddea=>{const _0x32bc11=_0x163b6f,_0x1e306d=_0x4cddea['match'][0x1],_0x279a62=_0x4cddea[_0x32bc11(0x304)][0x2],{uuid:_0x3215d5,externalip:_0x4b4263}=tmpStorage[_0x279a62];delete tmpStorage[_0x279a62],_0x4cddea[_0x32bc11(0x27d)](),devices[_0x3215d5]['telegramIpApproval']={'clientip':_0x4b4263,'timestamp':new Date()[_0x32bc11(0x240)](),'expiry':_0x1e306d},_0x1e306d!=_0x32bc11(0x117)?(await sendTelegram(_0x4cddea[_0x32bc11(0x1f8)]['id'],_0x32bc11(0x226)+_0x1e306d+'\x20minutes',{'parse_mode':'HTML'}),io['to'](_0x3215d5)[_0x32bc11(0x29d)]('status',{'access':{'allow':![],'reason':_0x32bc11(0x2ad),'token':null}})):(await sendTelegram(_0x4cddea[_0x32bc11(0x1f8)]['id'],_0x32bc11(0x21f)),io['to'](_0x3215d5)[_0x32bc11(0x29d)](_0x32bc11(0x175),{'access':{'allow':![],'reason':_0x32bc11(0x189),'token':null}}));});}}async function loginAccess2FA(_0x67384e,_0x362fcd){const _0x1423a6=_0x381e5c;if(tgBot&&settings[_0x1423a6(0x168)]){const _0x1664fd=uuidRandom();tmpStorage[_0x1664fd]={'uuid':_0x67384e,'externalip':_0x362fcd};const _0x499116=Markup['inlineKeyboard']([Markup[_0x1423a6(0x229)][_0x1423a6(0x2b7)](_0x1423a6(0x2f6),'login2fa_'+loginExpiry+'_'+_0x1664fd),Markup['button']['callback'](_0x1423a6(0x117),_0x1423a6(0x2e5)+_0x1664fd)]);await sendTelegram(settings[_0x1423a6(0x168)],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x362fcd)['show']+'\x20?',_0x499116),tgBot[_0x1423a6(0x145)](/login2fa_(.+)_(.+)/,async _0x2b7b58=>{const _0x21c960=_0x1423a6,_0x379bc5=_0x2b7b58[_0x21c960(0x304)][0x1],_0x459d03=_0x2b7b58['match'][0x2],{uuid:_0x5ca99d,externalip:_0x4bbce4}=tmpStorage[_0x459d03];delete tmpStorage[_0x459d03],_0x2b7b58[_0x21c960(0x27d)](),devices[_0x5ca99d][_0x21c960(0x22f)]={'clientip':_0x4bbce4,'timestamp':new Date()[_0x21c960(0x240)](),'expiry':_0x379bc5},_0x379bc5!=_0x21c960(0x117)?(await sendTelegram(_0x2b7b58[_0x21c960(0x1f8)]['id'],_0x21c960(0x263),{'parse_mode':'HTML'}),io['to'](_0x5ca99d)[_0x21c960(0x29d)](_0x21c960(0x175),{'access':{'allow':![],'reason':_0x21c960(0x2ad),'token':null}})):(await sendTelegram(_0x2b7b58['chat']['id'],_0x21c960(0x1ad)),io['to'](_0x5ca99d)[_0x21c960(0x29d)]('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0xbc317c=_0x381e5c;return dbConfig[_0xbc317c(0x1a7)](_0xbc317c(0x1dc))[_0xbc317c(0x269)](_0xbc317c(0x13a))[_0xbc317c(0x198)]({'status':_0xbc317c(0x2d4)})['value']()||[];}function getDisabledBots(){const _0x3765fc=_0x381e5c;return dbConfig['get'](_0x3765fc(0x1dc))[_0x3765fc(0x269)](_0x3765fc(0x13a))[_0x3765fc(0x198)]({'status':'disabled'})[_0x3765fc(0x18a)]()||[];}function getBotAttributes(_0x1d8d20){const _0x12903d=_0x381e5c;let _0x554e24={};const _0x209927=configpath+_0x12903d(0x217)+_0x1d8d20+_0x12903d(0x212),_0x39eb2d=fs['existsSync'](_0x209927);if(_0x39eb2d){const _0x10f5e8=fs['readFileSync'](_0x209927);try{const _0x59beef=JSON[_0x12903d(0x1ca)](_0x10f5e8),_0x438884=_0x59beef?_0x59beef[_0x12903d(0x12d)][0x0]['headless']:![];_0x554e24[_0x12903d(0x24c)]=_0x438884?'auto':'manual',_0x554e24[_0x12903d(0x1b9)]=_0x59beef?_0x59beef[_0x12903d(0x12d)][0x0][_0x12903d(0x1b9)]:_0x12903d(0x2c1)+_0x1d8d20;}catch(_0x24de1c){_0x554e24[_0x12903d(0x24c)]=_0x12903d(0x253),_0x554e24[_0x12903d(0x1b9)]='Bot\x20'+_0x1d8d20;}}else _0x554e24[_0x12903d(0x24c)]='manual',_0x554e24[_0x12903d(0x1b9)]=_0x12903d(0x2c1)+_0x1d8d20;return _0x554e24;}function getBotsWithMode(){const _0x2a1e67=_0x381e5c,_0x3ceb01=dbConfig[_0x2a1e67(0x1a7)](_0x2a1e67(0x1dc))[_0x2a1e67(0x269)]('botID')['value']()||[];return _0x3ceb01[_0x2a1e67(0x132)](_0x441ed3=>{const _0x30a35b=_0x2a1e67;let _0x4c05fa=getBotAttributes(_0x441ed3[_0x30a35b(0x13a)]);_0x441ed3[_0x30a35b(0x24c)]=_0x4c05fa['mode'];}),_0x3ceb01;}function getBotExchanges(){const _0x2d8b7b=_0x381e5c;let _0x4f8534=[];const _0x14044d=dbConfig['get'](_0x2d8b7b(0x1dc))[_0x2d8b7b(0x269)]('botID')[_0x2d8b7b(0x18a)]()||[];_0x14044d[_0x2d8b7b(0x132)](_0x30d692=>{const _0x4de229=_0x2d8b7b;if(_0x30d692[_0x4de229(0x175)]==_0x4de229(0x2d4)){const _0x86978d=configpath+_0x4de229(0x217)+_0x30d692[_0x4de229(0x13a)]+_0x4de229(0x212),_0x3753a9=fs[_0x4de229(0x131)](_0x86978d);let _0x3ca9da;if(_0x3753a9){const _0x2e38f0=fs['readFileSync'](_0x86978d);try{const _0x3d5347=JSON[_0x4de229(0x1ca)](_0x2e38f0);_0x3ca9da=_0x3d5347?_0x3d5347['bot'][0x0][_0x4de229(0x1c3)]:null;}catch(_0x45fa6f){}}if(_0x3ca9da)_0x4f8534[_0x4de229(0x26e)](_0x3ca9da);}});const _0x3d725e=[...new Set(_0x4f8534)]['sort']();return _0x3d725e;}async function initUser(){const _0x22bcf7=_0x381e5c;if(!settings['userid']){const _0x559756=uuidRandom();mixpanel['alias'](_0x559756),updateSetting(_0x22bcf7(0x254),_0x559756);}}async function initSecure(){const _0x4adb92=_0x381e5c;let _0x1491c5=getSecure();if(!_0x1491c5['hasOwnProperty'](_0x4adb92(0x1e1))){let _0xb8540f=await generateKeys();_0x1491c5[_0x4adb92(0x141)]=_0xb8540f[_0x4adb92(0x141)],_0x1491c5[_0x4adb92(0x1c5)]=_0xb8540f[_0x4adb92(0x1c5)],_0x1491c5[_0x4adb92(0x1e1)]=crypto[_0x4adb92(0x23f)](0x20)[_0x4adb92(0x2b2)](_0x4adb92(0x147));;storeSecure(_0x1491c5);}}function getSettings(){const _0x50af6a=_0x381e5c;return dbSettings[_0x50af6a(0x1a7)](_0x50af6a(0x224))[_0x50af6a(0x18a)]()||{};}function getSecure(){const _0x3113b2=_0x381e5c;return dbSecure[_0x3113b2(0x1a7)](_0x3113b2(0x17f))[_0x3113b2(0x18a)]()||{};}function getBlacklist(){const _0x1dfc1b=_0x381e5c;return dbSecure[_0x1dfc1b(0x1a7)](_0x1dfc1b(0x140))[_0x1dfc1b(0x18a)]()||[];}function broadcastToBots(_0x255e98,_0x7dcf28){const _0x262a1d=_0x381e5c;config[_0x262a1d(0x132)](_0x2307e7=>{const _0x58a7a2=_0x262a1d;if(_0x2307e7[_0x58a7a2(0x175)]=='enabled'&&_0x2307e7[_0x58a7a2(0x1da)]==_0x58a7a2(0x2e4)||_0x2307e7[_0x58a7a2(0x175)]=='new'&&_0x2307e7[_0x58a7a2(0x1da)]=='running'){if(pid[_0x2307e7['botID']])pid[_0x2307e7['botID']][_0x58a7a2(0x21c)]({[_0x255e98]:_0x7dcf28});}});}function storeSettings(_0x1641bf,_0x4a53ee=![]){const _0x2199c3=_0x381e5c;_0x1641bf={...settings,..._0x1641bf};if(_0x4a53ee&&_0x1641bf[_0x2199c3(0x2eb)]!=_0x2199c3(0x2cf)&&_0x1641bf['bbPassword']!=_0x2199c3(0x223)&&_0x1641bf[_0x2199c3(0x2eb)]!=''){const _0x1b8bc7=crypt[_0x2199c3(0x244)](secure[_0x2199c3(0x1c5)],_0x1641bf['bbPassword'])['message'][_0x2199c3(0x1cd)]('@')[0x0],_0x1159a5=bcrypt['hashSync'](_0x1b8bc7,saltRounds);_0x1641bf={..._0x1641bf,'bbPassword':_0x1159a5};}if(_0x4a53ee&&_0x1641bf['telegramToken']!=_0x2199c3(0x2cf)&&_0x1641bf[_0x2199c3(0x284)]!=_0x2199c3(0x223)&&_0x1641bf['telegramToken']!=''){const _0xa8466f=crypt[_0x2199c3(0x244)](secure['privateKey'],_0x1641bf[_0x2199c3(0x284)])['message'][_0x2199c3(0x1cd)]('@')[0x0];_0x1641bf={..._0x1641bf,'telegramToken':_0xa8466f};}const _0xb692da=_0x1641bf[_0x2199c3(0x284)]!='************'&&_0x1641bf[_0x2199c3(0x284)]!=settings['telegramToken']||_0x1641bf[_0x2199c3(0x1ea)]!=settings[_0x2199c3(0x1ea)],_0x2a8518=_0x1641bf[_0x2199c3(0x284)]==''||_0x1641bf[_0x2199c3(0x1ea)]=='';_0xb692da&&(_0x1641bf['telegramChatId']=null,_0x1641bf[_0x2199c3(0x13c)]=_0x2199c3(0x1cb));for(const [_0x53d0aa,_0x36fedc]of Object[_0x2199c3(0x2e2)](_0x1641bf)){if(_0x53d0aa==_0x2199c3(0x284)&&_0x36fedc==_0x2199c3(0x2cf)){_0x1641bf[_0x2199c3(0x284)]=settings[_0x2199c3(0x284)];continue;};if(_0x53d0aa==_0x2199c3(0x2eb)&&_0x36fedc==_0x2199c3(0x2cf)){_0x1641bf[_0x2199c3(0x2eb)]=settings[_0x2199c3(0x2eb)];continue;};dbSettings[_0x2199c3(0x2d1)](_0x2199c3(0x13b)+_0x53d0aa,_0x36fedc)[_0x2199c3(0x25d)]();}settings=_0x1641bf,io['to'](_0x2199c3(0x2f7))[_0x2199c3(0x29d)](_0x2199c3(0x224),cleanSettings()),broadcastToBots(_0x2199c3(0x29a),settings['timeshift']),broadcastToBots(_0x2199c3(0x2df),settings[_0x2199c3(0x2df)]);if(_0xb692da&&!_0x2a8518)initTelegram();if(_0xb692da&&_0x2a8518)disableTelegram();getAllClients()[_0x2199c3(0x132)](_0x244b33=>{const _0x4bdafb=_0x2199c3;getSocket(_0x244b33['id'])[_0x4bdafb(0x29d)](_0x4bdafb(0x175),{'access':{'allow':![],'reason':_0x4bdafb(0x2ad),'token':null}});});}function updateSetting(_0x3d3ea3,_0x1ed6d6){const _0x1b230=_0x381e5c;dbSettings['set']('settings.'+_0x3d3ea3,_0x1ed6d6)['write'](),settings=getSettings(),io['to'](_0x1b230(0x2f7))['emit']('settings',cleanSettings());}function storeSecure(_0xef7457){const _0x4f3ce0=_0x381e5c;dbSecure[_0x4f3ce0(0x1a7)](_0x4f3ce0(0x17f))['push'](_0xef7457)[_0x4f3ce0(0x25d)](),secure=_0xef7457;}function addBlacklist(_0xb57a66){const _0x112044=_0x381e5c;cleanBlacklist();let _0x26d768;devices[_0xb57a66][_0x112044(0x295)]?_0x26d768=Math[_0x112044(0x2ee)](devices[_0xb57a66][_0x112044(0x295)][_0x112044(0x2fc)],loginExpiry):_0x26d768=loginExpiry,dbSecure[_0x112044(0x1a7)](_0x112044(0x140))[_0x112044(0x26e)]({'expiry':new Date()['getTime']()+_0x26d768*0x3c*0x3e8,'token':devices[_0xb57a66]['access'][_0x112044(0x1a3)]})[_0x112044(0x25d)](),blacklist=dbSecure[_0x112044(0x1a7)](_0x112044(0x140))['value']();}function cleanBlacklist(){const _0x40790d=_0x381e5c;let _0xdd2359=dbSecure[_0x40790d(0x1a7)](_0x40790d(0x140))['cloneDeep']()[_0x40790d(0x18a)](),_0x2b6644=new Date()['getTime']();_0xdd2359[_0x40790d(0x132)](_0x26d929=>{const _0x3af0f1=_0x40790d;_0x26d929[_0x3af0f1(0x2fc)]<_0x2b6644&&dbSecure[_0x3af0f1(0x1a7)](_0x3af0f1(0x140))[_0x3af0f1(0x2a6)]({'expiry':_0x26d929['expiry']})['write']();});}function initStates(){const _0x169d16=_0x381e5c;let _0xfdbf20=getConfiguration();_0xfdbf20[_0x169d16(0x132)](_0x425cce=>{const _0x45cbf5=_0x169d16;_0x425cce[_0x45cbf5(0x1da)]=_0x45cbf5(0x194);}),storeConfiguration(_0xfdbf20);}function onKeys(){const _0x299ada=new RSA();return new Promise(_0x4feb23=>{const _0x188876=_0x40f3;_0x299ada[_0x188876(0x21a)]()['then'](_0x472528=>{_0x4feb23(_0x472528);});});}async function generateKeys(){return await onKeys();}function _0x528e(){const _0x100ed6=['Backup\x20file\x20unzipped\x20and\x20stored','temporary\x20access\x20rejected','value','Ok,\x20will\x20send\x20alert\x20notifications\x20only','number','No\x20bots\x20running\x20right\x20now','exp','bbvNew','mkdirSync','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','socket','length','stopped','apiSecret','bb-settings.json','start','filter','resetHistory','Network\x20Interfaces:','place-order','.zip','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','files','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','loginRequired','token','catch','restart_','createServer','get','headers','temporary\x20token\x20generated','env','Enabled\x20Bot\x20','text','Login\x20rejected','\x20>\x20','from','Error:\x20Invalid\x20argument\x20','name','host','date-fns','clients','disconnect','updatebotmanager','deleteHistoryAlerts','writeFileSync','botname','login\x20not\x20required','config','reason','startsWith','track','versions','/download/:type','No\x20authentication\x20token','/disable\x20-\x20disable\x20notifications\x0a','exchange','reply','privateKey','endsWith','Telegram\x20error:','Crypt','328biIKhk','parse','all','placeOrder','split','sendMessage','warning','SIGTERM','User\x20has\x20been\x20validated','latestversion','getDate','new','format','alerts','Server','reset-password','output-001.log','live','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','bots','index.html','username','node-zip','password','secret','min','bbvReceive','Unauthorized\x20attempt\x20to\x20show\x20configuration','backupfile','inherit','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','425224jWXXhE','event','telegramUsername','readdirSync',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','yargs/yargs',')\x20|\x20Bot\x20','Restore\x20backup\x20file\x20','showConfig','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','2FA\x20login\x20token\x20generated','[ip-address]','disabled','padStart','fork','restart','chat','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','/enable\x20-\x20enable\x20notifications\x0a','30Nwhmmw','ipv6','full','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Markdown','/:bot/history','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','getMonth','2FA\x20login\x20required','reinstall_no','\x20to\x20','exec','stringify','57968yAIRwA','logs','lastmsgemitted','(((.+)+)+)+$','initclient','bb-config.json','logs/','/on\x20-\x20start\x20bot(s)\x0a','sort','generate','-config.json','\x20|\x20','temporaryAccessAllowed','add-bot','get-backup-files','bot-','api-eu.mixpanel.com','replace','generateKeyPairAsync','*$1*','send','portfolio','bot.js','Temporary\x20access\x20rejected','error','simple','whitelist','***','settings','find','Access\x20enabled\x20for\x20','ipaddr.js','new-disabled','button','lowdb/adapters/FileSync','version.json','backup-files','args','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','telegram2FaApproval','uuid-random','delete-alerts','\x1b[31m','access\x20timeout','on_','clientip','config_alerts','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','/:bot/performance','delete-bot','2FA\x20required','removeAllListeners','stop','kill','randomBytes','getTime','Invalid\x20authentication\x20token\x20(2)','emitHistory','Your\x20installation\x20is\x20already\x20up\x20to\x20date','decrypt','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','add','Unauthorized\x20attempt\x20to\x20store\x20configuration','includes','\x1b[0m','any','mode','off','-----------------------------------------------------------------------------------','::ffff:127.0.0.1','getMinutes','/output-000.log','Notifications\x20types:\x20','manual','userid','538505MhilrW','conn','Unauthorized\x20attempt\x20to\x20get\x20events','output-000.log','Starting\x20(','binary','exit','sendPortfolioTelegram','write','show','download','uuid','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','0.0.0','Login\x20accepted','message','order','<b>Balance\x20Bot\x20Status:</b>\x0a','#RES#\x20if\x20running\x20locally\x0a','1380834aTNqpV','sortBy','tempaccess_reject_','IPv4','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','update_no','push','getHours','names','\x20(2)','Password\x20reset\x20rejected','port','getStartingBalances','reinstall','started','version','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Starting\x20new\x20bot\x20|\x20Bot\x20','telegraf','restore-backup-file','show-config','editMessageReplyMarkup','success','store-configuration','log','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','toggleBotMode','Unauthorized\x20login\x20attempt\x20(timeout)','telegramToken','portfolio_','\x20only\x0a','apiPassword','Restore\x20process\x20aborted','_data','/status\x20-\x20show\x20bot(s)\x20status\x0a','allow','config_orders','/:bot/coins','f2aRequired','store-headless','/:bot/support','toggle_','range','update_yes','/start','telegramIpApproval','store','\x20(1)','statSync','5oIcwKP','timeshift','Invalid\x20IP\x20address','\x20|\x20client:\x20...','emit','family','sendMetricsTelegram','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','update-bot','HTML','address','getUTCHours','build','remove','build2','confirm-message','getPortfolio','bb-secure.json','reinstall-bb','bb/','reload','SIGINT','function','login','util','toString','randomFillSync','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','All\x20bots\x20running\x20right\x20now','Logged\x20out\x20user\x20...','callback','metrics','http','Bot\x20Mgr\x20>\x20','graphql-request','Invalid\x20username\x20or\x20IP\x20address',':\x20Bot\x20Mgr\x20>\x20','toIPv4Address','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Ok,\x20will\x20send\x20order\x20notifications\x20only','Bot\x20','tempaccess_15_','sha256','bbUsername','showname','backup/','Unauthorized\x20attempt\x20to\x20delete\x20bot','path','RSA','config_all','186872gYUNTD','Unauthorized\x20attempt\x20to\x20get\x20messages','user','Restore\x20process\x20confirmed','************','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','set','map','\x1b[35m','enabled','Unauthorized\x20attempt\x20to\x20log\x20out','search','init','defaults','output-002.log','size','/off\x20-\x20stop\x20bot(s)\x0a','apply','isIPv4MappedAddress','login\x20token\x20valid','onepagemode','post','sendFile','entries','use','running','login2fa_reject_','compareSync','readFileSync','logged\x20out','hybrid-crypto-js','params','bbPassword','string','6b67f3d61ee94b8f5c80b4affef4c4d9','max','access','yes','Deleted\x20Bot\x20','uncaughtException','39510kKLWzG','test','Notifications\x20disabled','accept','botmanager','30\x20min','login\x20token\x20generated','/:bot/configuration','ipc','expiry','update-bb','Starting\x20#RED#Balance\x20Bot\x20v','restore_yes_','Yes','resetpw_yes','private','backup-full@','match','child_process','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','-performance.json','telegramEnabled','apiKey','notification','Backup\x20file\x20uploaded','restore_no_','Setting\x20access:\x20','storeConfiguration','reinstall_yes','Restoring\x20bot(s)\x20from\x20backup','jsonwebtoken','Orders','<b>Telegram\x20Bot\x20Status:</b>\x0a','temporary\x20access\x20not\x20allowed','reject','mtime','Restarting\x20Bot\x20','enable','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','messages','telegrammsg','join','backup-full.zip','Node.js\x20v','headless','close','assign',',\x20must\x20be\x20a\x204\x20digit\x20number','pidRefreshToken','file','tempaccess_5_','inlineKeyboard','-results.json','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','unlinkSync','bot','Logged\x20in\x20user\x20...','get-starting-balances','Unauthorized\x20attempt\x20to\x20update\x20bot','existsSync','forEach','temp/','getFullYear','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','tkn','sockets','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','type','botID','settings.','telegramEvents','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','lastmsgtelegram','Telegraf\x20error:','blacklist','publicKey','-events.json','https://api.ipify.org?format=json','/help\x20-\x20show\x20available\x20commands\x0a','action','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','hex','get-logs','Unauthorized\x20attempt\x20to\x20download\x20','store-settings','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','verify','rmSync','debug','Token\x20blacklisted','remoteAddress','getSeconds','encryptedUuid','timestamp','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','launch','production','390226HOGLSP','logout','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','sign','help','command','constructor','listen','toggle-bot-mode','Error\x20removing\x20old\x20backup\x20files:','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','once','hasOwnProperty','Unauthorized\x20attempt\x20to\x20update\x20settings','backup','internal','1000','telegramChatId','slice','Notifications\x20disabled\x0a','update','90dxHwGo','pidExpireLogin','keys','backup-full','#RES#\x20if\x20running\x20on\x20server','config/','node','Error\x20while\x20deleting\x20config\x20files:\x20','auto','status','telegram','off_','zip/','/:bot','orders','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','crypto','15\x20min','isValid','secure','isDirectory','reset-history','/names\x20-\x20show\x20bot\x20names\x0a','All\x20bots','copyFileSync','output-003.log','login\x20required','Unauthorized\x20attempt\x20to\x20get\x20portfolio'];_0x528e=function(){return _0x100ed6;};return _0x528e();}async function oneTimeMigration(){const _0xf213fb=_0x381e5c;let _0xf1d090=getSettings(),_0x580b0d=![];!_0xf1d090[_0xf213fb(0x163)]('lastmsgtelegram')&&(_0xf1d090[_0xf213fb(0x13e)]=0x0,_0x580b0d=!![]);!_0xf1d090[_0xf213fb(0x163)](_0xf213fb(0x20a))&&(_0xf1d090['lastmsgemitted']=0x0,_0x580b0d=!![]);!_0xf1d090[_0xf213fb(0x163)](_0xf213fb(0x1d2))&&(_0xf1d090[_0xf213fb(0x1d2)]=_0xf213fb(0x262),_0x580b0d=!![]);!_0xf1d090[_0xf213fb(0x163)](_0xf213fb(0x2df))&&(_0xf1d090[_0xf213fb(0x2df)]=![],_0x580b0d=!![]);if(_0x580b0d)storeSettings(_0xf1d090);try{fs[_0xf213fb(0x1eb)](configbackuppath,{'withFileTypes':!![]})[_0xf213fb(0x132)](_0x58fd8f=>{const _0x1c8d6a=_0xf213fb;if(!_0x58fd8f[_0x1c8d6a(0x180)]()){if(!_0x58fd8f[_0x1c8d6a(0x1b1)][_0x1c8d6a(0x1bd)](_0x1c8d6a(0x303)))fs[_0x1c8d6a(0x12c)](configbackuppath+_0x58fd8f[_0x1c8d6a(0x1b1)]);}else fs[_0x1c8d6a(0x14d)](configbackuppath+_0x58fd8f[_0x1c8d6a(0x1b1)],{'recursive':!![]});});}catch(_0x25c2bc){logger[_0xf213fb(0x14e)](_0xf213fb(0x160),_0x25c2bc);}}function storeConfiguration(_0x25ba89){const _0x2a8d30=_0x381e5c;dbConfig['get'](_0x2a8d30(0x1dc))[_0x2a8d30(0x2a6)]()[_0x2a8d30(0x25d)](),dbConfig['get']('bots')[_0x2a8d30(0x26e)](..._0x25ba89)[_0x2a8d30(0x25d)](),config=_0x25ba89;}async function resetPassword(){const _0x2dcb5f=_0x381e5c;if(tgBot&&settings[_0x2dcb5f(0x168)]){const _0x39ca5d=Markup[_0x2dcb5f(0x128)]([Markup[_0x2dcb5f(0x229)]['callback'](_0x2dcb5f(0x2f0),_0x2dcb5f(0x301)),Markup[_0x2dcb5f(0x229)][_0x2dcb5f(0x2b7)]('no','resetpw_no')]);await sendTelegram(settings[_0x2dcb5f(0x168)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x39ca5d),tgBot[_0x2dcb5f(0x145)](/resetpw_(.+)/,async _0x110e26=>{const _0x14f17e=_0x2dcb5f,_0x1b551a=_0x110e26['match'][0x1];_0x110e26[_0x14f17e(0x27d)]();if(_0x1b551a!='no'){const _0x2cb251=0xf,_0x247031=_0x14f17e(0x191),_0x5abd2b=Array[_0x14f17e(0x1af)](crypto[_0x14f17e(0x2b3)](new Uint32Array(_0x2cb251)))[_0x14f17e(0x2d2)](_0xae2f27=>_0x247031[_0xae2f27%_0x247031[_0x14f17e(0x193)]])['join'](''),_0x414d6f=bcrypt['hashSync'](_0x5abd2b,saltRounds);storeSettings({'bbPassword':_0x414d6f}),await sendTelegram(_0x110e26[_0x14f17e(0x1f8)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x5abd2b,{'parse_mode':'HTML'});}else await sendTelegram(_0x110e26[_0x14f17e(0x1f8)]['id'],_0x14f17e(0x272));});}}async function confirmRestore(_0x3f55a6,_0x4f1ed4){const _0x1bca47=_0x381e5c;io['to'](_0x1bca47(0x2f7))[_0x1bca47(0x29d)]('notification',_0x1bca47(0x246),_0x1bca47(0x27e));if(tgBot&&settings[_0x1bca47(0x168)]){const _0x5634b=uuidRandom();tmpStorage[_0x5634b]={'path':_0x3f55a6,'filename':_0x4f1ed4};const _0x53aeb0=Markup['inlineKeyboard']([Markup['button'][_0x1bca47(0x2b7)]('yes',_0x1bca47(0x2ff)+_0x5634b),Markup[_0x1bca47(0x229)]['callback']('no',_0x1bca47(0x30c)+_0x5634b)]);await sendTelegram(settings[_0x1bca47(0x168)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x53aeb0),tgBot[_0x1bca47(0x145)](/restore_(.+)_(.+)/,async _0x520807=>{const _0x4e6542=_0x1bca47,_0x9e96ae=_0x520807[_0x4e6542(0x304)][0x1],_0x526924=_0x520807[_0x4e6542(0x304)][0x2],{path:_0x3f45c2,filename:_0x3b3d79}=tmpStorage[_0x526924];delete tmpStorage[_0x526924],_0x520807[_0x4e6542(0x27d)](),_0x9e96ae==_0x4e6542(0x2f0)?(logger[_0x4e6542(0x14e)](_0x4e6542(0x2ce)),await sendTelegram(_0x520807[_0x4e6542(0x1f8)]['id'],_0x4e6542(0x310),{'parse_mode':_0x4e6542(0x2a2)}),unzipFile(_0x3f45c2,_0x3b3d79)):(logger['debug'](_0x4e6542(0x288)),await sendTelegram(_0x520807['chat']['id'],_0x4e6542(0x288)));});}}function getServerTime(){const _0x442260=_0x381e5c,_0x18fe1a=new Date();return _0x18fe1a[_0x442260(0x134)]()+'/'+(_0x18fe1a[_0x442260(0x202)]()+0x1)[_0x442260(0x2b2)]()['padStart'](0x2,'0')+'/'+_0x18fe1a['getDate']()['toString']()[_0x442260(0x1f5)](0x2,'0')+'\x20'+_0x18fe1a[_0x442260(0x26f)]()[_0x442260(0x2b2)]()[_0x442260(0x1f5)](0x2,'0')+':'+_0x18fe1a[_0x442260(0x250)]()[_0x442260(0x2b2)]()[_0x442260(0x1f5)](0x2,'0')+':'+_0x18fe1a['getSeconds']()['toString']()[_0x442260(0x1f5)](0x2,'0');}function getTimeStamp(){const _0x54c04f=_0x381e5c,_0x13bd9b=shiftedTime();return _0x13bd9b[_0x54c04f(0x134)]()+'/'+(_0x13bd9b[_0x54c04f(0x202)]()+0x1)[_0x54c04f(0x2b2)]()['padStart'](0x2,'0')+'/'+_0x13bd9b['getDate']()[_0x54c04f(0x2b2)]()['padStart'](0x2,'0')+'\x20'+_0x13bd9b[_0x54c04f(0x26f)]()[_0x54c04f(0x2b2)]()['padStart'](0x2,'0')+':'+_0x13bd9b[_0x54c04f(0x250)]()[_0x54c04f(0x2b2)]()[_0x54c04f(0x1f5)](0x2,'0')+':'+_0x13bd9b['getSeconds']()['toString']()[_0x54c04f(0x1f5)](0x2,'0');}function getCleanTimeStamp(){const _0x19df2a=_0x381e5c,_0x32715=shiftedTime();return _0x32715[_0x19df2a(0x134)]()+(_0x32715[_0x19df2a(0x202)]()+0x1)[_0x19df2a(0x2b2)]()[_0x19df2a(0x1f5)](0x2,'0')+_0x32715[_0x19df2a(0x1d3)]()[_0x19df2a(0x2b2)]()['padStart'](0x2,'0')+'-'+_0x32715['getHours']()[_0x19df2a(0x2b2)]()[_0x19df2a(0x1f5)](0x2,'0')+_0x32715['getMinutes']()[_0x19df2a(0x2b2)]()['padStart'](0x2,'0')+_0x32715['getSeconds']()[_0x19df2a(0x2b2)]()[_0x19df2a(0x1f5)](0x2,'0');}function shiftedTime(){const _0x160727=_0x381e5c,_0x3c8c06=new Date();let _0x41606d=_0x3c8c06;if(settings[_0x160727(0x29a)]&&settings[_0x160727(0x29a)]!==0x0)_0x41606d=fns[_0x160727(0x247)](_0x3c8c06,{'hours':settings['timeshift']});return _0x41606d;}function startScheduler(){const _0xa027f3=_0x381e5c,_0x3f998b=new Date()[_0xa027f3(0x2a4)](),_0x2cfd03=shiftedTime()[_0xa027f3(0x26f)]();_0x2cfd03==0x4&&backupConfigFiles();_0x2cfd03==0x0&&rotateLogFiles();_0x3f998b%0x6==0x0&&triggerAnalytics();_0x3f998b%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x448caa){const _0x3afe4f=_0x381e5c;logger[_0x3afe4f(0x14e)](_0x3afe4f(0x1ef)+_0x448caa);const _0x356727=getBotsWithMode();_0x356727[_0x3afe4f(0x193)]>0x0?confirmRestore(configbackuppath,_0x448caa):unzipFile(configbackuppath,_0x448caa);}async function getBackupFiles(_0x2e546b=null){const _0xfdbbed=_0x381e5c;let _0x49906c=[],_0x549469=fs[_0xfdbbed(0x1eb)](configbackuppath,{'withFileTypes':!![]});_0x549469[_0xfdbbed(0x210)]((_0x5c84f5,_0x4cfecc)=>_0x5c84f5[_0xfdbbed(0x1b1)]<_0x4cfecc[_0xfdbbed(0x1b1)]?0x1:_0x4cfecc[_0xfdbbed(0x1b1)]<_0x5c84f5[_0xfdbbed(0x1b1)]?-0x1:0x0),_0x549469[_0xfdbbed(0x132)](_0x26cb29=>{const _0x16b6bc=_0xfdbbed;if(!_0x26cb29['isDirectory']()&&_0x26cb29['name'][_0x16b6bc(0x1bd)](_0x16b6bc(0x303))&&_0x26cb29['name'][_0x16b6bc(0x1c6)](_0x16b6bc(0x19c))){const _0x4d7f07=formatDate(fs[_0x16b6bc(0x298)](configbackuppath+_0x26cb29[_0x16b6bc(0x1b1)])[_0x16b6bc(0x118)]);_0x49906c[_0x16b6bc(0x26e)]({'name':_0x26cb29[_0x16b6bc(0x1b1)],'mtime':_0x4d7f07});}});if(_0x2e546b)io['to'](_0x2e546b)[_0xfdbbed(0x29d)](_0xfdbbed(0x22c),_0x49906c);else return _0x49906c;}async function backupConfigFiles(){const _0x185994=_0x381e5c;await zipFiles(_0x185994(0x16f));const _0x1c7a5=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x185994(0x11f),configbackuppath+('backup-full@'+_0x1c7a5+_0x185994(0x19c)));let _0x486a9a=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x486a9a[_0x185994(0x210)]((_0xe43760,_0xf50699)=>_0xe43760[_0x185994(0x1b1)]<_0xf50699[_0x185994(0x1b1)]?0x1:_0xf50699['name']<_0xe43760['name']?-0x1:0x0),_0x486a9a['length']>maxBackups&&fs[_0x185994(0x12c)](configbackuppath+_0x486a9a[_0x486a9a[_0x185994(0x193)]-0x1][_0x185994(0x1b1)]);}function rotateLogFiles(){const _0x50c092=_0x381e5c,_0x21a936=fs[_0x50c092(0x298)](logspath+_0x50c092(0x258)),_0x4f2a63=_0x21a936[_0x50c092(0x2da)]/0x400;if(_0x4f2a63>0x64){let _0x5bbc99=fs[_0x50c092(0x1eb)](logspath,{'withFileTypes':!![]});_0x5bbc99[_0x50c092(0x210)]((_0x301db6,_0x1cc7ec)=>_0x301db6[_0x50c092(0x1b1)]<_0x1cc7ec[_0x50c092(0x1b1)]?0x1:_0x1cc7ec[_0x50c092(0x1b1)]<_0x301db6[_0x50c092(0x1b1)]?-0x1:0x0),_0x5bbc99[_0x50c092(0x132)](_0x3f415b=>{const _0xdf800a=_0x50c092;if(_0x3f415b[_0xdf800a(0x1b1)]==_0xdf800a(0x2d9))fs[_0xdf800a(0x184)](logspath+_0x3f415b[_0xdf800a(0x1b1)],logspath+_0xdf800a(0x185));if(_0x3f415b[_0xdf800a(0x1b1)]==_0xdf800a(0x1d9))fs[_0xdf800a(0x184)](logspath+_0x3f415b[_0xdf800a(0x1b1)],logspath+_0xdf800a(0x2d9));_0x3f415b[_0xdf800a(0x1b1)]==_0xdf800a(0x258)&&(fs[_0xdf800a(0x184)](logspath+_0x3f415b[_0xdf800a(0x1b1)],logspath+_0xdf800a(0x1d9)),fs[_0xdf800a(0x1b8)](logspath+_0x3f415b['name'],''));});}}async function zipFiles(_0x17af16){const _0x520537=_0x381e5c;let _0x2f5b65;if(_0x17af16==_0x520537(0x209))_0x2f5b65=logspath;if(_0x17af16==_0x520537(0x165))_0x2f5b65=configpath;if(_0x17af16==_0x520537(0x16f))_0x2f5b65=configpath;let _0x13fc37=fs[_0x520537(0x1eb)](_0x2f5b65,{'withFileTypes':!![]});const _0x264136=new require(_0x520537(0x1df))();_0x13fc37['forEach'](_0x4226e3=>{const _0x45f2ee=_0x520537;if(!_0x4226e3[_0x45f2ee(0x180)]()){let _0x501daa=fs[_0x45f2ee(0x2e7)](_0x2f5b65+_0x4226e3[_0x45f2ee(0x1b1)]);if(_0x17af16==_0x45f2ee(0x165)){const _0x4acacf=/^bot-[0-9]{3}-config.json$/,_0x2cbd84=_0x4acacf['test'](_0x4226e3[_0x45f2ee(0x1b1)]);if(_0x2cbd84){const _0x57521b=JSON[_0x45f2ee(0x1ca)](_0x501daa);if(_0x57521b[_0x45f2ee(0x12d)][0x0]){_0x57521b[_0x45f2ee(0x12d)][0x0][_0x45f2ee(0x309)]=_0x45f2ee(0x223),_0x57521b[_0x45f2ee(0x12d)][0x0][_0x45f2ee(0x195)]='***';if(_0x57521b[_0x45f2ee(0x12d)][0x0]['apiPassword'])_0x57521b[_0x45f2ee(0x12d)][0x0][_0x45f2ee(0x287)]=_0x45f2ee(0x223);}_0x501daa=JSON[_0x45f2ee(0x207)](_0x57521b,null,0x2);}if(_0x4226e3['name']=='bb-settings.json'){const _0x99183e=JSON[_0x45f2ee(0x1ca)](_0x501daa);if(_0x99183e[_0x45f2ee(0x224)][_0x45f2ee(0x1a2)])_0x99183e[_0x45f2ee(0x224)][_0x45f2ee(0x1a2)]=![];if(_0x99183e[_0x45f2ee(0x224)]['bbPassword'])_0x99183e[_0x45f2ee(0x224)][_0x45f2ee(0x2eb)]=_0x45f2ee(0x223);if(_0x99183e[_0x45f2ee(0x224)][_0x45f2ee(0x284)])_0x99183e[_0x45f2ee(0x224)][_0x45f2ee(0x284)]=_0x45f2ee(0x223);if(_0x99183e[_0x45f2ee(0x224)][_0x45f2ee(0x168)])_0x99183e[_0x45f2ee(0x224)][_0x45f2ee(0x168)]=null;_0x501daa=JSON['stringify'](_0x99183e,null,0x2);}if(_0x4226e3[_0x45f2ee(0x1b1)]!=_0x45f2ee(0x2aa))_0x264136[_0x45f2ee(0x126)](_0x4226e3['name'],_0x501daa);}else _0x264136[_0x45f2ee(0x126)](_0x4226e3[_0x45f2ee(0x1b1)],_0x501daa);}});const _0x10a538=_0x264136[_0x520537(0x211)]({'base64':![],'compression':'DEFLATE'});fs[_0x520537(0x1b8)](zippath+(_0x17af16+_0x520537(0x19c)),_0x10a538,_0x520537(0x25a));}async function unzipFile(_0x4e5e20,_0x41f3d2){const _0x3fab5c=_0x381e5c;fs[_0x3fab5c(0x1eb)](configpath,{'withFileTypes':!![]})['forEach'](_0x3077c8=>{const _0x22285d=_0x3fab5c;if(!_0x3077c8[_0x22285d(0x180)]())fs[_0x22285d(0x14d)](configpath+_0x3077c8[_0x22285d(0x1b1)]);});const _0x5728f1=fs[_0x3fab5c(0x2e7)](_0x4e5e20+_0x41f3d2,_0x3fab5c(0x25a)),_0x34e267=new require(_0x3fab5c(0x1df))(_0x5728f1,{'base64':![],'checkCRC32':!![]});Object['keys'](_0x34e267['files'])[_0x3fab5c(0x132)](_0xa3260e=>{const _0x2a7834=_0x3fab5c,_0x138d86=_0x34e267[_0x2a7834(0x19f)][_0xa3260e];fs[_0x2a7834(0x1b8)](configpath+_0x138d86['name'],_0x138d86[_0x2a7834(0x289)]);}),fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x3fab5c(0x132)](_0x321e00=>{const _0x7e8e06=_0x3fab5c;if(!_0x321e00[_0x7e8e06(0x180)]())fs[_0x7e8e06(0x14d)](temppath+_0x321e00[_0x7e8e06(0x1b1)]);}),logger[_0x3fab5c(0x14e)](_0x3fab5c(0x188)),process['send']({'restore':!![]},_0x1fab4f=>{});}async function getPublicIp(){const _0x4aabac=_0x381e5c;try{const _0x1c43a4=await axios['get'](_0x4aabac(0x143));publicip=_0x1c43a4['data']['ip'];}catch(_0x1a64d7){}}async function triggerAnalytics(){const _0x47844e=_0x381e5c;if(!publicip)await getPublicIp();const _0x2fda27=getBotsWithMode();let _0x17b8f5=0x0;_0x2fda27[_0x47844e(0x132)](_0x4646bb=>{const _0x479f90=_0x47844e;if(_0x4646bb[_0x479f90(0x175)]===_0x479f90(0x2d4))_0x17b8f5++;});const _0x958611=getBotExchanges();mixpanel[_0x47844e(0x1be)](_0x47844e(0x1d7),{'distinct_id':settings[_0x47844e(0x254)],'ip':publicip,'version':serverversion,'numbots':_0x2fda27[_0x47844e(0x193)],'numbotsenabled':_0x17b8f5,'exchanges':_0x958611,'environment':environment});}async function getMessages(){const _0x115c79=_0x381e5c,_0x137af2='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x2bd291=new GraphQLClient(_0x137af2),_0x31b6de={'authorization':_0x115c79(0x135)},_0x24f8ce=serverversion['split']('.'),_0x574658=_0x24f8ce[0x0]+'.'+_0x24f8ce[0x1],_0x111b7a=Math[_0x115c79(0x1e2)](settings['lastmsgtelegram'],settings[_0x115c79(0x20a)]),_0x3a0b7c={'last':parseInt(_0x111b7a),'bbm':_0x574658},_0xe3546=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x21f966;try{_0x21f966=await _0x2bd291['request'](_0xe3546,_0x3a0b7c,_0x31b6de);}catch(_0x43297d){}if(_0x21f966&&_0x21f966[_0x115c79(0x11c)]){let _0x5c3245=settings[_0x115c79(0x13e)];newMessages=[];for(const _0x2c318c of _0x21f966[_0x115c79(0x11c)]){newMessages[_0x115c79(0x26e)](_0x2c318c);let _0x4e6ef7=![];_0x2c318c[_0x115c79(0x18f)]&&(updateSetting('latestversion',_0x2c318c['bbvNew']),_0x4e6ef7=isNewerVersion(serverversion,_0x2c318c[_0x115c79(0x18f)])||serverversion==_0x2c318c[_0x115c79(0x18f)]);if(!_0x4e6ef7&&_0x2c318c[_0x115c79(0x18c)]>_0x5c3245){if(_0x2c318c[_0x115c79(0x1e3)]===_0x115c79(0x24b)||serverversion[_0x115c79(0x1bd)](_0x2c318c[_0x115c79(0x1e3)])){let _0x56df5a=''+_0x2c318c['title']+'\x0a\x0a'+_0x2c318c[_0x115c79(0x264)];const _0x27dcc8=await sendTelegramMsg(toTelegramMarkdown(_0x56df5a),_0x115c79(0x1ff));if(_0x27dcc8)_0x5c3245=_0x2c318c[_0x115c79(0x18c)];}}}updateAvailable=isNewerVersion(settings[_0x115c79(0x1d2)],serverversion),updateSetting(_0x115c79(0x13e),_0x5c3245),emitMessages();}}function emitMessages(){const _0x31bcb6=_0x381e5c,_0x5de54c=settings[_0x31bcb6(0x20a)];let _0x46fbae=[];newMessages[_0x31bcb6(0x132)](_0x9a8106=>{const _0x536d55=_0x31bcb6;_0x9a8106[_0x536d55(0x18c)]>_0x5de54c&&_0x46fbae[_0x536d55(0x26e)](_0x9a8106);}),_0x46fbae[_0x31bcb6(0x193)]>0x0&&getAllClients()['forEach'](_0x1728f2=>{getSocket(_0x1728f2['id'])['emit']('message',_0x46fbae);});}function confirmMessage(_0x4f3df9){const _0x2900c4=_0x381e5c;updateSetting(_0x2900c4(0x20a),Number(_0x4f3df9));}function isNewerVersion(_0x34e87f,_0x1615b2){const _0x4c8e3e=_0x381e5c,_0x581688=_0x1615b2[_0x4c8e3e(0x1cd)]('.'),_0x2fbf96=_0x34e87f['split']('.');for(var _0x4f653f=0x0;_0x4f653f<_0x2fbf96[_0x4c8e3e(0x193)];_0x4f653f++){const _0x1f8b2e=~~_0x2fbf96[_0x4f653f],_0x5db1d1=~~_0x581688[_0x4f653f];if(_0x1f8b2e>_0x5db1d1)return!![];if(_0x1f8b2e<_0x5db1d1)return![];}return![];}function toTelegramMarkdown(_0x3bc690){const _0x15e552=_0x381e5c,_0x19424f=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4ed306=/\*{2}(.+?)\*{2}/gim;return _0x3bc690=_0x3bc690[_0x15e552(0x219)](_0x19424f,'$1_$2_$3')[_0x15e552(0x219)](_0x4ed306,_0x15e552(0x21b)),_0x3bc690;}async function validateConfigFile(){const _0x1162d5=_0x381e5c,_0x340520=dbConfig[_0x1162d5(0x1a7)](_0x1162d5(0x1dc))['sortBy'](_0x1162d5(0x13a))[_0x1162d5(0x18a)]()||[];if(_0x340520['length']==0x0){let _0x4151fb=0x0,_0x354251=[];const _0x190eff=/^bot-([0-9]{3})-config.json$/,_0x558d9b=fs[_0x1162d5(0x1eb)](configpath);_0x558d9b[_0x1162d5(0x132)](_0x2139aa=>{const _0x321945=_0x1162d5,_0x4b8982=_0x190eff[_0x321945(0x206)](_0x2139aa);if(_0x4b8982){const _0xf51a81=_0x4b8982[0x1];let _0xd48573=getBotAttributes(_0xf51a81);_0x354251[_0x321945(0x26e)]({'botID':_0xf51a81,'botname':_0xd48573[_0x321945(0x1b9)],'status':_0x321945(0x1f4),'live':_0x321945(0x194)}),_0x4151fb++;}}),_0x4151fb!=0x0&&(dbConfig['get'](_0x1162d5(0x1dc))[_0x1162d5(0x123)](_0x354251)[_0x1162d5(0x25d)](),config=_0x354251,restoredConfigFile=_0x4151fb);}}async function restoreConfigNotify(_0xb884bf){const _0x4e8b71=_0x381e5c;let _0x2d9bf1;if(restoredConfigFile==0x1)_0x2d9bf1='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x2d9bf1=_0x4e8b71(0x146);if(_0xb884bf)io['to'](_0x4e8b71(0x2f7))['emit'](_0x4e8b71(0x30a),_0x2d9bf1);else{logger[_0x4e8b71(0x221)]('-----------------------------------------------------------------------------------'),logger[_0x4e8b71(0x221)](_0x2d9bf1),logger[_0x4e8b71(0x221)]('-----------------------------------------------------------------------------------'),logger['simple']('');if(tgBot&&settings[_0x4e8b71(0x168)]&&settings[_0x4e8b71(0x13c)]!='orders')await sendTelegram(settings[_0x4e8b71(0x168)],_0x4e8b71(0x2ba)+_0x2d9bf1);}}function validateCredentials(_0x1a75f6,_0x451ca4){const _0x12e589=_0x381e5c;if(_0x1a75f6['username']==settings['bbUsername']&&bcrypt[_0x12e589(0x2e6)](_0x1a75f6[_0x12e589(0x1e0)],settings[_0x12e589(0x2eb)])){if(settings[_0x12e589(0x28e)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x51ace1=generateLoginToken(_0x451ca4);return{'allow':!![],'reason':_0x12e589(0x2f9),'token':_0x51ace1};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x554a2e){const _0x211730=_0x381e5c,_0x3d1a29=generateLoginToken(_0x554a2e);return{'allow':!![],'reason':_0x211730(0x2f9),'token':_0x3d1a29};}function validateAccess(_0x743b4f,_0x45dc3d,_0x11af14){const _0x549bca=_0x381e5c,_0x4adf96=_0x11af14?_0x11af14:devices[_0x45dc3d]['ip'];let _0x571a0c;const _0x484173=_0x32643d=>{const _0x37e7c2=_0x40f3;if(settings[_0x37e7c2(0x1a2)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x45dc3d)){const _0x41de60=generateLoginToken(_0x45dc3d);return{'allow':!![],'reason':_0x37e7c2(0x1f2),'token':_0x41de60};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x571a0c=validToken(_0x32643d,_0x45dc3d),_0x571a0c[_0x37e7c2(0x163)](_0x37e7c2(0x27e))?{'allow':!![],'reason':_0x37e7c2(0x2de),'token':_0x32643d}:{'allow':![],'reason':_0x37e7c2(0x186),'token':null};}else return{'allow':!![],'reason':_0x37e7c2(0x1ba),'token':null};};if(settings['whitelistEnabled']){let _0x502e7f=[...settings[_0x549bca(0x222)],'::1',_0x549bca(0x24f),'127.0.0.1'];if(_0x502e7f[_0x549bca(0x249)](_0x4adf96))return _0x484173(_0x743b4f);else{_0x571a0c=validToken(_0x743b4f,_0x45dc3d);if(_0x571a0c[_0x549bca(0x163)]('success'))return _0x484173(_0x743b4f);else{if(telegramIpApproved(_0x45dc3d)){const _0x5cbe2b=generateToken(_0x45dc3d);return _0x571a0c=_0x484173(_0x743b4f),_0x571a0c[_0x549bca(0x28b)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x5cbe2b}:_0x571a0c;}else return settings[_0x549bca(0x214)]?{'allow':![],'reason':_0x549bca(0x23b),'token':null}:{'allow':![],'reason':_0x549bca(0x116),'token':null};}}}else return _0x484173(_0x743b4f);}function timelyDecrypt(_0x42359d,_0x554e85=!![]){const _0x58b8a0=_0x381e5c;if(_0x42359d)try{const _0x2c39f5=crypt['decrypt'](secure['privateKey'],_0x42359d)[_0x58b8a0(0x264)],_0x427fb4=_0x2c39f5[_0x58b8a0(0x1cd)]('@')[0x0],_0x20fdf3=_0x2c39f5[_0x58b8a0(0x1cd)]('@')[0x1],_0x1e0c9c=new Date()['getTime']();if(_0x554e85){if(_0x1e0c9c-_0x20fdf3<maxSecretAge*0x3e8)return _0x427fb4;else return![];}else return _0x427fb4;}catch(_0x4cf317){return![];}else return![];}const validToken=(_0x2fea4b,_0x48bc8f)=>{const _0x28e02e=_0x381e5c,_0x25f9b9=devices[_0x48bc8f]['ip'];if(!_0x2fea4b)return{'error':_0x28e02e(0x1c1)};for(let _0x7a17ce of blacklist){if(_0x7a17ce[_0x28e02e(0x1a3)]==_0x2fea4b)return{'error':_0x28e02e(0x14f)};}let _0x332c23;try{_0x332c23=jwt[_0x28e02e(0x14c)](_0x2fea4b,secure['secret']+_0x48bc8f);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x332c23[_0x28e02e(0x163)](_0x28e02e(0x235))&&!_0x332c23[_0x28e02e(0x163)]('username')||!_0x332c23[_0x28e02e(0x163)](_0x28e02e(0x18e)))return{'error':_0x28e02e(0x241)};if(!_0x332c23[_0x28e02e(0x163)](_0x28e02e(0x1de))&&_0x332c23['hasOwnProperty'](_0x28e02e(0x235))){const {clientip:_0x2482d6}=_0x332c23;return _0x25f9b9==_0x2482d6?{'success':_0x28e02e(0x1d1)}:{'error':_0x28e02e(0x29b)};}else{if(_0x332c23[_0x28e02e(0x163)]('username')&&_0x332c23[_0x28e02e(0x163)]('clientip')){const {username:_0x49a957,clientip:_0x1390db}=_0x332c23;return settings[_0x28e02e(0x2c4)]==_0x49a957&&_0x25f9b9==_0x1390db?{'success':_0x28e02e(0x1d1)}:{'error':_0x28e02e(0x2bc)};}}},generateLoginToken=_0x279719=>{const _0x5ed5ca=_0x381e5c;if(_0x279719){const _0xcd6ad7=devices[_0x279719]['ip'];return jwt['sign']({'username':settings['bbUsername'],'clientip':_0xcd6ad7},secure[_0x5ed5ca(0x1e1)]+_0x279719,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x26adc2=>{const _0x4ae8bf=_0x381e5c;if(_0x26adc2){const _0x5968ad=devices[_0x26adc2]['ip'];return jwt[_0x4ae8bf(0x15a)]({'clientip':_0x5968ad},secure[_0x4ae8bf(0x1e1)]+_0x26adc2,{'expiresIn':devices[_0x26adc2][_0x4ae8bf(0x295)][_0x4ae8bf(0x2fc)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x5a9f84=>{const _0x43e555=_0x381e5c;let _0x93b06c=![];return devices[_0x5a9f84][_0x43e555(0x295)]&&devices[_0x5a9f84]['telegramIpApproval'][_0x43e555(0x2fc)]!=_0x43e555(0x117)&&(_0x93b06c=devices[_0x5a9f84][_0x43e555(0x295)][_0x43e555(0x235)]==devices[_0x5a9f84]['ip']&&new Date()['getTime']()-devices[_0x5a9f84]['telegramIpApproval'][_0x43e555(0x153)]<devices[_0x5a9f84][_0x43e555(0x295)][_0x43e555(0x2fc)]*0x3c*0x3e8),_0x93b06c;},telegram2FaApproved=_0x8d809d=>{const _0x1fdfb8=_0x381e5c;let _0x221350=![];return devices[_0x8d809d][_0x1fdfb8(0x22f)]&&devices[_0x8d809d][_0x1fdfb8(0x22f)][_0x1fdfb8(0x2fc)]!=_0x1fdfb8(0x117)&&(_0x221350=devices[_0x8d809d][_0x1fdfb8(0x22f)][_0x1fdfb8(0x235)]==devices[_0x8d809d]['ip']&&new Date()[_0x1fdfb8(0x240)]()-devices[_0x8d809d][_0x1fdfb8(0x22f)][_0x1fdfb8(0x153)]<devices[_0x8d809d][_0x1fdfb8(0x22f)][_0x1fdfb8(0x2fc)]*0x3c*0x3e8),_0x221350;},normalizeIP=_0x36bded=>{const _0x193f62=_0x381e5c;let _0x243d3a=null,_0x27c4cf=null;if(ipaddr[_0x193f62(0x17e)](_0x36bded)){const _0x1b0b82=ipaddr[_0x193f62(0x1ca)](_0x36bded);_0x1b0b82['kind']()===_0x193f62(0x1fc)?(_0x1b0b82[_0x193f62(0x2dd)]()&&(_0x243d3a=_0x1b0b82[_0x193f62(0x2be)]()['toString']()),_0x27c4cf=_0x1b0b82[_0x193f62(0x2b2)]()):(_0x243d3a=_0x1b0b82[_0x193f62(0x2b2)](),_0x27c4cf=_0x1b0b82['toIPv4MappedAddress']()['toString']());}return{'show':_0x243d3a?_0x243d3a:_0x27c4cf,'store':_0x27c4cf};};function formatDate(_0x8f22ae){const _0x2ac267=_0x381e5c;return _0x8f22ae[_0x2ac267(0x134)]()+'/'+(_0x8f22ae[_0x2ac267(0x202)]()+0x1)[_0x2ac267(0x2b2)]()[_0x2ac267(0x1f5)](0x2,'0')+'/'+_0x8f22ae[_0x2ac267(0x1d3)]()['toString']()[_0x2ac267(0x1f5)](0x2,'0')+'\x20'+_0x8f22ae[_0x2ac267(0x26f)]()[_0x2ac267(0x2b2)]()[_0x2ac267(0x1f5)](0x2,'0')+':'+_0x8f22ae[_0x2ac267(0x250)]()[_0x2ac267(0x2b2)]()['padStart'](0x2,'0')+':'+_0x8f22ae[_0x2ac267(0x151)]()[_0x2ac267(0x2b2)]()[_0x2ac267(0x1f5)](0x2,'0');}function sleep(_0x5c9bc5){return new Promise(_0x3ec803=>setTimeout(_0x3ec803,_0x5c9bc5));}