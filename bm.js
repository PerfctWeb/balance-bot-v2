const _0x1cc599=_0x5c94;(function(_0x1497a3,_0x23f91b){const _0x5bfe30=_0x5c94,_0x35b8b6=_0x1497a3();while(!![]){try{const _0x263197=-parseInt(_0x5bfe30(0x25c))/0x1*(-parseInt(_0x5bfe30(0x207))/0x2)+-parseInt(_0x5bfe30(0x3b9))/0x3*(parseInt(_0x5bfe30(0x2e4))/0x4)+parseInt(_0x5bfe30(0x220))/0x5*(parseInt(_0x5bfe30(0x2a2))/0x6)+-parseInt(_0x5bfe30(0x2c5))/0x7*(parseInt(_0x5bfe30(0x20a))/0x8)+parseInt(_0x5bfe30(0x2b8))/0x9+-parseInt(_0x5bfe30(0x30f))/0xa+-parseInt(_0x5bfe30(0x2ba))/0xb*(parseInt(_0x5bfe30(0x38f))/0xc);if(_0x263197===_0x23f91b)break;else _0x35b8b6['push'](_0x35b8b6['shift']());}catch(_0x3e7117){_0x35b8b6['push'](_0x35b8b6['shift']());}}}(_0xca26,0x6915b));const _0x13e1f7=function(){let _0x2b2d0d=!![];return function(_0x41fe18,_0x3cabe3){const _0x1e8206=_0x2b2d0d?function(){if(_0x3cabe3){const _0xd0846d=_0x3cabe3['apply'](_0x41fe18,arguments);return _0x3cabe3=null,_0xd0846d;}}:function(){};return _0x2b2d0d=![],_0x1e8206;};}(),_0xa34010=_0x13e1f7(this,function(){const _0x13b42d=_0x5c94;return _0xa34010[_0x13b42d(0x3a4)]()[_0x13b42d(0x263)]('(((.+)+)+)+$')[_0x13b42d(0x3a4)]()['constructor'](_0xa34010)['search'](_0x13b42d(0x342));});_0xa34010();'use strict';process[_0x1cc599(0x22e)][_0x1cc599(0x256)]=0x1;const childProcess=require(_0x1cc599(0x216)),fs=require('fs'),fns=require(_0x1cc599(0x2a6)),low=require(_0x1cc599(0x381)),FileSync=require(_0x1cc599(0x208)),path=require(_0x1cc599(0x1d8)),crypto=require(_0x1cc599(0x30e)),Crypt=require('hybrid-crypto-js')[_0x1cc599(0x2b3)],RSA=require('hybrid-crypto-js')['RSA'],bcrypt=require(_0x1cc599(0x341)),jwt=require(_0x1cc599(0x212)),ipaddr=require(_0x1cc599(0x228)),argv=require('yargs/yargs')(process['argv'][_0x1cc599(0x319)](0x2))[_0x1cc599(0x1dd)],uuidRandom=require(_0x1cc599(0x388)),{Telegraf,Markup}=require(_0x1cc599(0x2a1)),Mixpanel=require(_0x1cc599(0x31f)),axios=require(_0x1cc599(0x395)),{GraphQLClient,gql}=require(_0x1cc599(0x3b1)),util=require('util'),fileUpload=require(_0x1cc599(0x2bc)),{networkInterfaces}=require('os'),PORT=argv[_0x1cc599(0x3cd)]||_0x1cc599(0x22c),pattern=/^[0-9]{2,4}$/;!pattern[_0x1cc599(0x322)](PORT)&&(console[_0x1cc599(0x2b2)](_0x1cc599(0x38d)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x1cc599(0x36e)](0x1));const HOST=argv[_0x1cc599(0x26d)]||null,userID=argv[_0x1cc599(0x35b)]||'',debugging=argv['d']||![],nodeversion=process[_0x1cc599(0x245)][_0x1cc599(0x327)];let bbpath=_0x1cc599(0x3d9),bbpath2='';const botfile=_0x1cc599(0x2f8),configfile=_0x1cc599(0x2a9),settingsfile=_0x1cc599(0x2d5),securefile=_0x1cc599(0x340),environment=require('./'+bbpath2+_0x1cc599(0x3da))[_0x1cc599(0x380)]||_0x1cc599(0x369),maxBackups=0xa;let validInstallation=!![];!fs[_0x1cc599(0x36b)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x1cc599(0x328)),configpath=userID?bbpath+_0x1cc599(0x2cb)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x1cc599(0x1f3),logspath=userID?bbpath+_0x1cc599(0x2a3)+userID+'/':bbpath+_0x1cc599(0x2a3),zippath=userID?bbpath+_0x1cc599(0x386)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x1cc599(0x270)](logspath+_0x1cc599(0x36d),{'flags':'a'}),temppath=userID?bbpath+_0x1cc599(0x2f1)+userID+'/':bbpath+_0x1cc599(0x2f1);!fs[_0x1cc599(0x36b)](configpath)&&fs['mkdirSync'](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x1cc599(0x2d3)](configbackuppath);!fs[_0x1cc599(0x36b)](logspath)&&fs[_0x1cc599(0x2d3)](logspath);!fs['existsSync'](zippath)&&fs[_0x1cc599(0x2d3)](zippath);!fs[_0x1cc599(0x36b)](temppath)&&fs[_0x1cc599(0x2d3)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x1cc599(0x365)]({'bots':[]})[_0x1cc599(0x3d8)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x1cc599(0x365)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x1cc599(0x1da),'onepagemode':![]}})[_0x1cc599(0x3d8)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x1cc599(0x3d8)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x1cc599(0x217)});const saltRounds=0xa,mixpanel=Mixpanel[_0x1cc599(0x2f7)](_0x1cc599(0x392),{'host':_0x1cc599(0x226)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings[_0x1cc599(0x2a0)]!=''&&settings[_0x1cc599(0x2a0)]!='***')&&settings[_0x1cc599(0x288)]&&settings[_0x1cc599(0x288)]!='')initTelegram();const parseColor=(_0x468cc0,_0x6d65f0)=>{const _0x4a9eb8=_0x1cc599,_0x37f9c0=/#[A-Z]{3}#/g;if(typeof _0x468cc0==_0x4a9eb8(0x36f)){!_0x6d65f0?_0x468cc0=_0x468cc0[_0x4a9eb8(0x3a0)](_0x37f9c0,''):(_0x468cc0=_0x468cc0[_0x4a9eb8(0x3a0)](/#BLU#/g,_0x4a9eb8(0x35c)),_0x468cc0=_0x468cc0[_0x4a9eb8(0x3a0)](/#RED#/g,_0x4a9eb8(0x387)),_0x468cc0=_0x468cc0[_0x4a9eb8(0x3a0)](/#YEL#/g,_0x4a9eb8(0x2d8)),_0x468cc0=_0x468cc0[_0x4a9eb8(0x3a0)](/#MAG#/g,_0x4a9eb8(0x1f8)),_0x468cc0=_0x468cc0[_0x4a9eb8(0x3a0)](/#CYA#/g,_0x4a9eb8(0x21c)),_0x468cc0=_0x468cc0[_0x4a9eb8(0x3a0)](/#RES#/g,_0x4a9eb8(0x379)));;}return _0x468cc0;},logger={'screen':_0x333faa=>{const _0x50d046=_0x1cc599;console[_0x50d046(0x2b2)](parseColor(_0x333faa,!![]));},'simple':_0x177766=>{const _0xb914fb=_0x1cc599;console[_0xb914fb(0x2b2)](parseColor(_0x177766,!![])),loggerfile[_0xb914fb(0x3d8)](util['format'](parseColor(_0x177766,![]))+'\x0a');},'full':async _0x46bcd5=>{const _0x347fd9=_0x1cc599,_0x307b76=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x46bcd5;console[_0x347fd9(0x2b2)](parseColor(_0x307b76,!![])),loggerfile[_0x347fd9(0x3d8)](util[_0x347fd9(0x291)](parseColor(_0x307b76,![]))+'\x0a');if(tgBot&&settings[_0x347fd9(0x250)]&&settings[_0x347fd9(0x1e5)]!=_0x347fd9(0x2d6))await sendTelegram(settings[_0x347fd9(0x250)],_0x347fd9(0x308)+parseColor(_0x46bcd5,![]));},'debug':async(_0x4b7a0a,_0x13c73a='')=>{const _0x2e234f=_0x1cc599,_0x5c63bd=getTimeStamp()+_0x2e234f(0x1e3)+_0x4b7a0a;if(debugging)console[_0x2e234f(0x2b2)](parseColor(_0x5c63bd,!![]));loggerfile[_0x2e234f(0x3d8)](util[_0x2e234f(0x291)](parseColor(_0x5c63bd,![]))+'\x0a');if(_0x13c73a){if(debugging)console[_0x2e234f(0x2b2)](_0x13c73a);loggerfile['write'](util[_0x2e234f(0x291)](_0x13c73a)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x2e32a1){const _0x4ea0e5=_0x1cc599;logger[_0x4ea0e5(0x33c)](_0x2e32a1);}),process['on'](_0x1cc599(0x36e),()=>{stopAllBots();}),process['on'](_0x1cc599(0x21b),()=>{stopAllBots();});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x1cc599(0x3da))[_0x1cc599(0x266)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,pidScheduler,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x1cc599(0x2e1))[_0x1cc599(0x361)](app);app[_0x1cc599(0x367)](fileUpload({'useTempFiles':!![]})),app[_0x1cc599(0x2a8)](_0x1cc599(0x304),async(_0x25bfc6,_0x30ebca)=>{const _0xc8dc32=_0x1cc599,_0x96c925=_0x25bfc6[_0xc8dc32(0x28a)]['type'],_0x2b4b22=getClientsWithBotID(_0xc8dc32(0x3c8)),_0x3b4ee6=_0x25bfc6['headers'][_0xc8dc32(0x3a3)],_0x300acb=timelyDecrypt(_0x3b4ee6,![]),_0x487888=_0x2b4b22[_0xc8dc32(0x302)](_0x48da01=>_0x48da01['uuid']==_0x300acb);if(_0x487888){const _0x1a7ef=normalizeIP(_0x25bfc6[_0xc8dc32(0x3d2)][_0xc8dc32(0x323)])[_0xc8dc32(0x26f)],_0x1196ff=_0x25bfc6[_0xc8dc32(0x2b4)][_0xc8dc32(0x22f)];if(validateAccess(_0x1196ff,_0x300acb,_0x1a7ef)[_0xc8dc32(0x3bf)])_0x96c925==_0xc8dc32(0x287)&&await backupConfigFiles(),await zipFiles(_0x96c925),_0x30ebca[_0xc8dc32(0x29a)](zippath+(_0x96c925+'.zip'),_0xd2f3d7=>{const _0x2fb738=_0xc8dc32;_0xd2f3d7&&(logger['full']('Failed\x20to\x20download\x20'+_0x96c925),logger[_0x2fb738(0x33c)](_0xd2f3d7));});else logger['full'](_0xc8dc32(0x3d0)+_0x96c925+_0xc8dc32(0x338));}else logger[_0xc8dc32(0x348)](_0xc8dc32(0x3d0)+_0x96c925+'\x20(2)');}),app[_0x1cc599(0x1ee)]('/upload-backup',async(_0x25da01,_0x22f417)=>{const _0x4af580=_0x1cc599,_0x5a784c=getClientsWithBotID(_0x4af580(0x3c8)),_0x321e41=_0x25da01[_0x4af580(0x2b4)][_0x4af580(0x3a3)],_0x111251=timelyDecrypt(_0x321e41,![]),_0x4202b5=_0x5a784c[_0x4af580(0x302)](_0x5d94bc=>_0x5d94bc[_0x4af580(0x3a3)]==_0x111251);logger[_0x4af580(0x276)](_0x4af580(0x295));if(_0x4202b5){const _0x3b6c40=normalizeIP(_0x25da01[_0x4af580(0x3d2)]['remoteAddress'])['store'],_0x53e5cf=_0x25da01[_0x4af580(0x2b4)][_0x4af580(0x22f)];if(validateAccess(_0x53e5cf,_0x111251,_0x3b6c40)[_0x4af580(0x3bf)]){if(_0x25da01[_0x4af580(0x3be)]){const _0x37c465=_0x25da01[_0x4af580(0x3be)][_0x4af580(0x2ff)];await _0x37c465['mv'](temppath+_0x37c465[_0x4af580(0x1e4)]),_0x22f417['send']({'status':!![],'message':_0x4af580(0x298)});const _0x27d735=getBotsWithMode();_0x27d735[_0x4af580(0x39c)]>0x0?confirmRestore(temppath,_0x37c465[_0x4af580(0x1e4)]):unzipFile(temppath,_0x37c465[_0x4af580(0x1e4)]);}}else logger[_0x4af580(0x348)](_0x4af580(0x3d4));}else logger[_0x4af580(0x348)](_0x4af580(0x330));}),app[_0x1cc599(0x367)](express[_0x1cc599(0x383)](path[_0x1cc599(0x300)](__dirname,bbpath2,_0x1cc599(0x24b)))),app[_0x1cc599(0x367)](express[_0x1cc599(0x383)](path['join'](__dirname,bbpath2,_0x1cc599(0x30b)))),app[_0x1cc599(0x2a8)]('/',function(_0x84c738,_0x5f2aee){const _0x1a4587=_0x1cc599;_0x5f2aee[_0x1a4587(0x374)](path[_0x1a4587(0x300)](__dirname,bbpath2,_0x1a4587(0x24b),_0x1a4587(0x2bd)));}),app[_0x1cc599(0x2a8)](_0x1cc599(0x243),function(_0x795e7e,_0x2cc82a){const _0x1191f9=_0x1cc599;_0x2cc82a['sendFile'](path[_0x1191f9(0x300)](__dirname,bbpath2,_0x1191f9(0x30b),_0x1191f9(0x2bd)));}),app[_0x1cc599(0x2a8)](_0x1cc599(0x34f),(_0x1583f5,_0x310a13)=>{const _0x50da2d=_0x1cc599;_0x310a13[_0x50da2d(0x374)](path[_0x50da2d(0x300)](__dirname,bbpath2,_0x50da2d(0x30b),_0x50da2d(0x2bd)));}),app[_0x1cc599(0x2a8)](_0x1cc599(0x3a9),(_0x24c3fb,_0x370cdf)=>{const _0x2c2d9b=_0x1cc599;_0x370cdf[_0x2c2d9b(0x374)](path[_0x2c2d9b(0x300)](__dirname,bbpath2,_0x2c2d9b(0x30b),'index.html'));}),app[_0x1cc599(0x2a8)](_0x1cc599(0x345),(_0xa80ef5,_0x98d6d8)=>{const _0x113bc6=_0x1cc599;_0x98d6d8[_0x113bc6(0x374)](path[_0x113bc6(0x300)](__dirname,bbpath2,'build','index.html'));}),app[_0x1cc599(0x2a8)]('/:bot/history',(_0x557462,_0x131ced)=>{const _0x263e53=_0x1cc599;_0x131ced[_0x263e53(0x374)](path[_0x263e53(0x300)](__dirname,bbpath2,_0x263e53(0x30b),_0x263e53(0x2bd)));}),app[_0x1cc599(0x2a8)](_0x1cc599(0x329),(_0x40206e,_0x274105)=>{const _0x5eb43e=_0x1cc599;_0x274105[_0x5eb43e(0x374)](path[_0x5eb43e(0x300)](__dirname,bbpath2,'build',_0x5eb43e(0x2bd)));}),app[_0x1cc599(0x2a8)](_0x1cc599(0x396),(_0x2963cb,_0x1c2cbd)=>{const _0x2fd896=_0x1cc599;_0x1c2cbd[_0x2fd896(0x374)](path['join'](__dirname,bbpath2,_0x2fd896(0x30b),_0x2fd896(0x2bd)));});if(HOST)http[_0x1cc599(0x28e)](PORT,HOST);else http[_0x1cc599(0x28e)](PORT);const io=require(_0x1cc599(0x3c6))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x3d6c24=_0x1cc599;let _0x523abd=_0x3d6c24(0x27e);const _0x3e7026=networkInterfaces(),_0x324a4d={};for(const _0x338a44 of Object[_0x3d6c24(0x398)](_0x3e7026)){for(const _0x191035 of _0x3e7026[_0x338a44]){if((_0x191035[_0x3d6c24(0x201)]=='IPv4'||_0x191035[_0x3d6c24(0x201)]==0x4)&&!_0x191035[_0x3d6c24(0x2e8)]){const _0x9a67b1=ipaddr['parse'](_0x191035[_0x3d6c24(0x1fa)])[_0x3d6c24(0x3b7)]();_0x9a67b1!=_0x3d6c24(0x334)&&(!_0x324a4d[_0x338a44]&&(_0x324a4d[_0x338a44]=[]),_0x324a4d[_0x338a44]['push'](_0x191035[_0x3d6c24(0x1fa)]),_0x523abd=_0x191035[_0x3d6c24(0x1fa)]);}}}return{'serverip':_0x523abd,'netinterfaces':_0x324a4d};}async function startServer(){const _0x5d450c=_0x1cc599,{serverip:_0x2ec8e,netinterfaces:_0x297f99}=getServerIP();logger[_0x5d450c(0x33c)](''),logger[_0x5d450c(0x33c)](_0x5d450c(0x231)),await logger[_0x5d450c(0x348)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x5d450c(0x20d)+(environment==_0x5d450c(0x2df)?_0x5d450c(0x32a):'')+'\x0a'+(_0x5d450c(0x281)+PORT+_0x5d450c(0x2d4))+(_0x5d450c(0x258)+_0x2ec8e+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x5d450c(0x33c)](_0x5d450c(0x231));if(config[_0x5d450c(0x39c)]!=0x0)for(const _0x566c96 of config){const _0x3689b5=_0x566c96['mode']==_0x5d450c(0x2c2)?'a':'m';if(_0x566c96[_0x5d450c(0x3ce)]==_0x5d450c(0x27b)||_0x566c96[_0x5d450c(0x3ce)]==_0x5d450c(0x3ca))await logger[_0x5d450c(0x348)](_0x5d450c(0x2c1)+_0x3689b5+_0x5d450c(0x1fc)+_0x566c96['botID']+_0x5d450c(0x326)+_0x566c96['botname']),startBot([_0x566c96[_0x5d450c(0x22a)],userID],{'cwd':bbpath},function(_0x398464){const _0x5c8d79=_0x5d450c;if(_0x398464)logger[_0x5c8d79(0x348)](_0x398464);});else(_0x566c96[_0x5d450c(0x3ce)]==_0x5d450c(0x25b)||_0x566c96[_0x5d450c(0x3ce)]=='new-disabled')&&await logger[_0x5d450c(0x348)]('Idling\x20('+_0x3689b5+_0x5d450c(0x23e)+_0x566c96[_0x5d450c(0x22a)]+_0x5d450c(0x326)+_0x566c96['botname']);}else!newBot&&logger[_0x5d450c(0x33c)](_0x5d450c(0x23f));if(newBot)addBot();logger['simple'](_0x5d450c(0x231)),logger['simple'](''),await logger[_0x5d450c(0x276)]('Node.js\x20v'+nodeversion),await logger[_0x5d450c(0x276)](_0x5d450c(0x296),_0x297f99);}function startSocket(){const _0x25b298=_0x1cc599;io['on'](_0x25b298(0x25d),_0x1235dc=>{const _0x2d5696=_0x25b298;let _0x1f6f60,_0x49820c,_0x5e80b9,_0x3ba8a3,_0x4ad1fe;const _0x1b334c=_0x1235dc[_0x2d5696(0x2f0)][_0x2d5696(0x2b4)][_0x2d5696(0x282)];_0x49820c=_0x1b334c['match'](/bot[0-9]{3}/);if(_0x49820c)_0x5e80b9=_0x49820c[0x0][_0x2d5696(0x2af)](/[0-9]{3}/);if(_0x5e80b9)_0x1f6f60=_0x5e80b9[0x0];else _0x1f6f60=_0x2d5696(0x3c8);const _0x38fb89=_0x1235dc[_0x2d5696(0x2f0)][_0x2d5696(0x3bb)][_0x2d5696(0x37a)];if(!_0x38fb89)_0x1235dc[_0x2d5696(0x218)](_0x2d5696(0x3ce),{'publicKey':secure[_0x2d5696(0x233)]});else{_0x3ba8a3=timelyDecrypt(_0x38fb89,![]);if(!_0x3ba8a3)_0x1235dc[_0x2d5696(0x218)](_0x2d5696(0x3ce),{'publicKey':secure['publicKey']});else{_0x4ad1fe=normalizeIP(_0x1235dc['conn'][_0x2d5696(0x323)])[_0x2d5696(0x26f)];if(!devices[_0x3ba8a3])devices[_0x3ba8a3]={'uuid':_0x3ba8a3,'access':{'token':null}};devices[_0x3ba8a3]['ip']=_0x4ad1fe;const _0x3cd95=addClient(_0x1235dc['id'],_0x3ba8a3,_0x1f6f60);setAccess(_0x3cd95),emitMessages(),_0x1235dc['on'](_0x2d5696(0x362),_0x406426=>{const _0x178857=_0x2d5696,_0xffc5ea=timelyDecrypt(_0x406426[_0x178857(0x34c)]);if(_0xffc5ea){_0x406426={'username':_0x406426[_0x178857(0x1f2)],'password':_0xffc5ea},devices[_0x3ba8a3][_0x178857(0x370)]=validateCredentials(_0x406426,_0x3ba8a3);if(devices[_0x3ba8a3][_0x178857(0x370)]['allow']==![]&&devices[_0x3ba8a3][_0x178857(0x370)]['reason']=='2FA\x20login\x20required')_0x1235dc[_0x178857(0x218)](_0x178857(0x3ce),{'access':devices[_0x3ba8a3][_0x178857(0x370)]}),loginAccess2FA(_0x3ba8a3,_0x4ad1fe);else{if(devices[_0x3ba8a3][_0x178857(0x370)][_0x178857(0x3bf)]==![]&&devices[_0x3ba8a3][_0x178857(0x370)][_0x178857(0x247)]==_0x178857(0x38e))_0x1235dc['emit']('status',{'access':devices[_0x3ba8a3][_0x178857(0x370)]});else devices[_0x3ba8a3][_0x178857(0x370)][_0x178857(0x3bf)]&&devices[_0x3ba8a3]['access'][_0x178857(0x247)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x3ba8a3)[_0x178857(0x2db)](_0x3c83e4=>{setAccess(_0x3c83e4);}),logger['debug'](_0x178857(0x26e)+_0x3ba8a3[_0x178857(0x319)](-0x8)),setTokenRefresh(_0x3ba8a3),setSessionTimeout(_0x178857(0x362),_0x3ba8a3));}}else logger['full']('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x1235dc['on'](_0x2d5696(0x1f7),()=>{resetPassword();}),_0x1235dc['on'](_0x2d5696(0x311),_0x861558=>{removeClient(_0x1235dc['id']);}),_0x1f6f60==_0x2d5696(0x3c8)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x49c9e3){const _0x16d91d=_0x1cc599;if(_0x49c9e3!=_0x16d91d(0x3c8)&&config[_0x16d91d(0x3ad)]!=''){if(pid[_0x49c9e3])pid[_0x49c9e3][_0x16d91d(0x315)]({'function':_0x16d91d(0x2c8),'args':null});}_0x49c9e3!=_0x16d91d(0x3c8)&&broadcastToBots(_0x16d91d(0x261),JSON[_0x16d91d(0x2e5)](config));}function reloadBotManager(){getClientsWithBotID('botmanager')['forEach'](_0x3a09d0=>{const _0x2d14bc=_0x5c94;getSocket(_0x3a09d0['id'])[_0x2d14bc(0x218)]('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x40a4cc){const _0x5620ea=_0x1cc599;return io[_0x5620ea(0x3b3)]['sockets']['get'](_0x40a4cc);}function setAccess(_0x1bc738){const _0x4396be=_0x1cc599,_0x19d161=getSocket(_0x1bc738['id']),_0x397bb6=_0x1bc738[_0x4396be(0x3a3)],_0x45850d=_0x1bc738['bot'];devices[_0x397bb6][_0x4396be(0x370)]=validateAccess(devices[_0x397bb6][_0x4396be(0x370)][_0x4396be(0x2ad)],_0x397bb6),logger[_0x4396be(0x276)]('Setting\x20access:\x20'+devices[_0x397bb6][_0x4396be(0x370)][_0x4396be(0x247)]+'\x20|\x20client:\x20...'+_0x1bc738['id'][_0x4396be(0x319)](-0x8)+_0x4396be(0x364)+_0x397bb6[_0x4396be(0x319)](-0x8)),_0x19d161[_0x4396be(0x300)](_0x397bb6);if(devices[_0x397bb6][_0x4396be(0x370)][_0x4396be(0x3bf)]){_0x19d161[_0x4396be(0x300)](_0x45850d);if(_0x45850d==_0x4396be(0x3c8))initializeSocketBotManager(_0x19d161);else initializeSocketBot(_0x19d161);initClient(_0x45850d);}devices[_0x397bb6][_0x4396be(0x370)][_0x4396be(0x2ad)]&&devices[_0x397bb6][_0x4396be(0x370)]['reason']==_0x4396be(0x2cc)&&setSessionTimeout('2FA',_0x397bb6),devices[_0x397bb6]['access'][_0x4396be(0x2ad)]&&devices[_0x397bb6][_0x4396be(0x370)][_0x4396be(0x247)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x4396be(0x362),_0x397bb6),_0x19d161[_0x4396be(0x218)]('status',{'status':_0x1bc738[_0x4396be(0x363)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x397bb6][_0x4396be(0x370)],'externalip':devices[_0x397bb6]['ip'],'publicKey':secure[_0x4396be(0x233)],'userid':settings[_0x4396be(0x24e)],'validInstallation':validInstallation}),devices[_0x397bb6][_0x4396be(0x370)][_0x4396be(0x3bf)]==![]&&devices[_0x397bb6][_0x4396be(0x370)][_0x4396be(0x247)]=='2FA\x20required'&&temporaryAccess2FA(_0x397bb6,devices[_0x397bb6]['ip']);}function setSessionTimeout(_0x50b558,_0x3b39c6){const _0x4198b1=_0x1cc599;let _0x695b69;if(_0x50b558==_0x4198b1(0x362))_0x695b69=loginExpiry*0x3c*0x3e8;else _0x695b69=devices[_0x3b39c6][_0x4198b1(0x2e0)][_0x4198b1(0x249)]*0x3c*0x3e8-(new Date()[_0x4198b1(0x390)]()-devices[_0x3b39c6][_0x4198b1(0x2e0)][_0x4198b1(0x37c)]);if(devices[_0x3b39c6][_0x4198b1(0x1f9)])clearTimeout(devices[_0x3b39c6][_0x4198b1(0x1f9)]);devices[_0x3b39c6][_0x4198b1(0x1f9)]=setTimeout(()=>{const _0x161d72=_0x4198b1;if(devices[_0x3b39c6]['pidRefreshToken'])clearTimeout(devices[_0x3b39c6][_0x161d72(0x2f3)]);removeSocketListeners(_0x3b39c6),addBlacklist(_0x3b39c6),devices[_0x3b39c6][_0x161d72(0x2e0)]=null,devices[_0x3b39c6][_0x161d72(0x35d)]=null,devices[_0x3b39c6][_0x161d72(0x370)][_0x161d72(0x2ad)]=null,logger['debug'](_0x161d72(0x1ea)+_0x3b39c6[_0x161d72(0x319)](-0x8)),devices[_0x3b39c6][_0x161d72(0x370)]=validateAccess(devices[_0x3b39c6][_0x161d72(0x370)][_0x161d72(0x2ad)],_0x3b39c6),!(devices[_0x3b39c6][_0x161d72(0x370)][_0x161d72(0x3bf)]&&devices[_0x3b39c6]['access']['reason']==_0x161d72(0x33f))&&(_0x50b558==_0x161d72(0x362)?io['to'](_0x3b39c6)['emit']('status',{'access':{'allow':![],'reason':_0x161d72(0x235),'token':null}}):io['to'](_0x3b39c6)[_0x161d72(0x218)](_0x161d72(0x3ce),{'access':{'allow':![],'reason':_0x161d72(0x333),'token':null}})),devices[_0x3b39c6][_0x161d72(0x370)][_0x161d72(0x2ad)]=null;},_0x695b69);}function setTokenRefresh(_0x25d340){const _0x11cba7=_0x1cc599;if(devices[_0x25d340][_0x11cba7(0x2f3)])clearTimeout(devices[_0x25d340]['pidRefreshToken']);devices[_0x25d340]['pidRefreshToken']=setTimeout(()=>{const _0x5c7e8a=_0x11cba7;getClientsWithUuid(_0x25d340)['length']!=0x0?(devices[_0x25d340]['access']=refreshToken(_0x25d340),io['to'](_0x25d340)[_0x5c7e8a(0x218)]('status',{'status':_0x5c7e8a(0x1ec),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x25d340]['access'],'externalip':devices[_0x25d340]['ip'],'publicKey':secure[_0x5c7e8a(0x233)],'validInstallation':validInstallation}),setTokenRefresh(_0x25d340)):clearTimeout(devices[_0x25d340][_0x5c7e8a(0x2f3)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x61f539){const _0x433825=_0x1cc599,_0x11a5b1=getClient(_0x61f539['id'])[_0x433825(0x3a3)];_0x61f539['emit'](_0x433825(0x261),config),_0x61f539[_0x433825(0x218)](_0x433825(0x3bd),cleanSettings()),_0x61f539['on'](_0x433825(0x393),_0x58a40b=>{const _0x4c884f=_0x433825;if(validateAccess(_0x58a40b,_0x11a5b1)[_0x4c884f(0x3bf)])addBot();else logger[_0x4c884f(0x348)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x61f539['on']('update-bot',(_0x442dee,_0x5e7ec4)=>{const _0xf7fc10=_0x433825;if(validateAccess(_0x5e7ec4,_0x11a5b1)[_0xf7fc10(0x3bf)])toggleBot(_0x442dee['botID'],_0x442dee[_0xf7fc10(0x3ce)],_0x442dee[_0xf7fc10(0x2be)]);else logger[_0xf7fc10(0x348)](_0xf7fc10(0x1ff));}),_0x61f539['on'](_0x433825(0x375),(_0x5059cc,_0xe07b79)=>{const _0x265195=_0x433825;if(validateAccess(_0xe07b79,_0x11a5b1)['allow'])toggleBotMode(_0x5059cc);else logger[_0x265195(0x348)](_0x265195(0x1ff));}),_0x61f539['on'](_0x433825(0x3ac),(_0x7a86e6,_0x17c9b5)=>{const _0x1c24e8=_0x433825;if(validateAccess(_0x17c9b5,_0x11a5b1)[_0x1c24e8(0x3bf)])deleteBot(_0x7a86e6);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x61f539['on'](_0x433825(0x351),(_0x20a9c8,_0x54b670)=>{const _0x56e237=_0x433825;if(validateAccess(_0x54b670,_0x11a5b1)['allow'])storeSettings(_0x20a9c8,!![]);else logger[_0x56e237(0x348)](_0x56e237(0x3b2));}),_0x61f539['on'](_0x433825(0x30c),_0x445e37=>{const _0x40879c=_0x433825;if(validateAccess(_0x445e37,_0x11a5b1)[_0x40879c(0x3bf)])updateBB(_0x40879c(0x3d5));else logger[_0x40879c(0x348)](_0x40879c(0x2d9));}),_0x61f539['on'](_0x433825(0x283),_0x3c0683=>{const _0x492f14=_0x433825;if(validateAccess(_0x3c0683,_0x11a5b1)['allow'])updateBB(_0x492f14(0x382));else logger[_0x492f14(0x348)](_0x492f14(0x253));}),_0x61f539['on'](_0x433825(0x284),_0x527593=>{const _0x52b70b=_0x433825;if(validateAccess(_0x527593,_0x11a5b1)['allow']){const _0x570f31=getClient(_0x61f539['id']);if(_0x570f31)getBackupFiles(_0x570f31[_0x52b70b(0x3a3)]);else logger['full'](_0x52b70b(0x2dd));}else logger[_0x52b70b(0x348)](_0x52b70b(0x234));}),_0x61f539['on']('restore-backup-file',(_0x34f9dc,_0x5ee5b4)=>{const _0x2693c7=_0x433825;if(validateAccess(_0x5ee5b4,_0x11a5b1)[_0x2693c7(0x3bf)])restoreBackupFile(_0x34f9dc);else logger['full'](_0x2693c7(0x241));}),_0x61f539['on'](_0x433825(0x297),_0x4c3c12=>{const _0x2d4125=_0x433825;if(validateAccess(_0x4c3c12,_0x11a5b1)[_0x2d4125(0x3bf)])getMessages();else logger[_0x2d4125(0x348)](_0x2d4125(0x346));}),_0x61f539['on']('confirm-message',(_0x3f56c7,_0x4271a9)=>{const _0x34f45a=_0x433825;if(validateAccess(_0x4271a9,_0x11a5b1)['allow'])confirmMessage(_0x3f56c7);else logger[_0x34f45a(0x348)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x61f539['on'](_0x433825(0x3a2),_0x13bf23=>{const _0x494813=_0x433825;if(validateAccess(_0x13bf23,_0x11a5b1)[_0x494813(0x3bf)]){if(devices[_0x11a5b1]['pidRefreshToken'])clearTimeout(devices[_0x11a5b1][_0x494813(0x2f3)]);if(devices[_0x11a5b1]['pidExpireLogin'])clearTimeout(devices[_0x11a5b1][_0x494813(0x1f9)]);removeSocketListeners(getClient(_0x61f539['id'])[_0x494813(0x3a3)]),addBlacklist(_0x11a5b1),devices[_0x11a5b1][_0x494813(0x2e0)]=null,devices[_0x11a5b1][_0x494813(0x35d)]=null,devices[_0x11a5b1][_0x494813(0x370)][_0x494813(0x2ad)]=null,logger[_0x494813(0x276)](_0x494813(0x309)+_0x11a5b1[_0x494813(0x319)](-0x8)),io['to'](getClient(_0x61f539['id'])['uuid'])[_0x494813(0x218)](_0x494813(0x3ce),{'access':{'allow':![],'reason':_0x494813(0x344),'token':null}});}else logger[_0x494813(0x348)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x4b6b7a){const _0x33b86b=_0x1cc599,_0x35db47=getClient(_0x4b6b7a['id'])[_0x33b86b(0x3a1)],_0x47e82b=getClient(_0x4b6b7a['id'])[_0x33b86b(0x3a3)];_0x4b6b7a['on'](_0x33b86b(0x227),(_0x2faf32,_0xf54033)=>{const _0x7709bd=_0x33b86b;if(validateAccess(_0xf54033,_0x47e82b)['allow']){if(pid[_0x35db47])pid[_0x35db47]['send']({'function':_0x7709bd(0x39e),'args':_0x2faf32});}else logger[_0x7709bd(0x348)](_0x7709bd(0x2fa));}),_0x4b6b7a['on'](_0x33b86b(0x271),(_0x457284,_0xa48da7)=>{const _0x5bf891=_0x33b86b;if(validateAccess(_0xa48da7,_0x47e82b)[_0x5bf891(0x3bf)]){if(pid[_0x35db47])pid[_0x35db47][_0x5bf891(0x315)]({'function':'deleteHistoryAlerts','args':_0x457284});}else logger[_0x5bf891(0x348)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x4b6b7a['on']('get-portfolio',(_0x5355a7,_0x467092)=>{const _0x513517=_0x33b86b;if(validateAccess(_0x467092,_0x47e82b)[_0x513517(0x3bf)]){if(pid[_0x35db47])pid[_0x35db47]['send']({'function':_0x513517(0x230),'args':_0x5355a7});}else logger[_0x513517(0x348)](_0x513517(0x206));}),_0x4b6b7a['on'](_0x33b86b(0x1db),(_0x3a1568,_0xaff361)=>{const _0x4e1884=_0x33b86b;if(validateAccess(_0xaff361,_0x47e82b)[_0x4e1884(0x3bf)]){if(pid[_0x35db47])pid[_0x35db47][_0x4e1884(0x315)]({'function':_0x4e1884(0x332),'args':_0x3a1568});}else logger[_0x4e1884(0x348)](_0x4e1884(0x320));}),_0x4b6b7a['on'](_0x33b86b(0x202),(_0x68af48,_0x51b3c0)=>{const _0x28078e=_0x33b86b;if(validateAccess(_0x51b3c0,_0x47e82b)['allow']){if(pid[_0x35db47])pid[_0x35db47]['send']({'function':_0x28078e(0x31d),'args':_0x68af48});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x4b6b7a['on'](_0x33b86b(0x286),(_0x3fe8ac,_0x399742)=>{const _0x12502c=_0x33b86b;if(validateAccess(_0x399742,_0x47e82b)[_0x12502c(0x3bf)]){if(pid[_0x35db47])pid[_0x35db47]['send']({'function':'storeFiat','args':_0x3fe8ac});}else logger['full'](_0x12502c(0x267));}),_0x4b6b7a['on'](_0x33b86b(0x200),_0x250416=>{const _0x144c83=_0x33b86b;if(validateAccess(_0x250416,_0x47e82b)[_0x144c83(0x3bf)]){if(pid[_0x35db47])pid[_0x35db47][_0x144c83(0x315)]({'function':_0x144c83(0x3dc),'args':null});}else logger[_0x144c83(0x348)](_0x144c83(0x377));}),_0x4b6b7a['on'](_0x33b86b(0x1e7),_0x19e86d=>{const _0x234db5=_0x33b86b;if(validateAccess(_0x19e86d,_0x47e82b)[_0x234db5(0x3bf)]){if(pid[_0x35db47])pid[_0x35db47][_0x234db5(0x315)]({'function':'getStartingBalances','args':null});}else logger[_0x234db5(0x348)](_0x234db5(0x221));}),_0x4b6b7a['on']('place-order',(_0x3b4ee9,_0x19f77d)=>{const _0x3f602e=_0x33b86b;if(validateAccess(_0x19f77d,_0x47e82b)[_0x3f602e(0x3bf)]){if(pid[_0x35db47])pid[_0x35db47]['send']({'function':'placeOrder','args':_0x3b4ee9});}else logger[_0x3f602e(0x348)](_0x3f602e(0x3c7));}),_0x4b6b7a['on']('cancel-loading',_0xefb89d=>{const _0x57b57c=_0x33b86b;if(validateAccess(_0xefb89d,_0x47e82b)[_0x57b57c(0x3bf)]){if(pid[_0x35db47])pid[_0x35db47][_0x57b57c(0x315)]({'function':_0x57b57c(0x2a5),'args':null});}else logger[_0x57b57c(0x348)](_0x57b57c(0x360));}),_0x4b6b7a['on'](_0x33b86b(0x3b4),_0x278fdb=>{const _0x261da3=_0x33b86b;if(validateAccess(_0x278fdb,_0x47e82b)[_0x261da3(0x3bf)]){if(pid[_0x35db47])pid[_0x35db47][_0x261da3(0x315)]({'function':_0x261da3(0x264),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x4b6b7a['on'](_0x33b86b(0x30c),_0x17b31d=>{const _0x390313=_0x33b86b;if(validateAccess(_0x17b31d,_0x47e82b)['allow'])updateBB(_0x390313(0x3d5));else logger[_0x390313(0x348)](_0x390313(0x2d9));}),_0x4b6b7a['on'](_0x33b86b(0x297),_0x2a2054=>{const _0x3ffea0=_0x33b86b;if(validateAccess(_0x2a2054,_0x47e82b)[_0x3ffea0(0x3bf)])getMessages();else logger[_0x3ffea0(0x348)](_0x3ffea0(0x346));}),_0x4b6b7a['on'](_0x33b86b(0x1f0),(_0x1d2dfb,_0x419027)=>{const _0x5d9086=_0x33b86b;if(validateAccess(_0x419027,_0x47e82b)['allow'])confirmMessage(_0x1d2dfb);else logger[_0x5d9086(0x348)](_0x5d9086(0x239));}),_0x4b6b7a['on']('logout',_0x5306ea=>{const _0x5d027e=_0x33b86b;if(validateAccess(_0x5306ea,_0x47e82b)[_0x5d027e(0x3bf)]){if(devices[_0x47e82b][_0x5d027e(0x2f3)])clearTimeout(devices[_0x47e82b][_0x5d027e(0x2f3)]);if(devices[_0x47e82b][_0x5d027e(0x1f9)])clearTimeout(devices[_0x47e82b][_0x5d027e(0x1f9)]);removeSocketListeners(getClient(_0x4b6b7a['id'])['uuid']),addBlacklist(_0x47e82b),devices[_0x47e82b][_0x5d027e(0x2e0)]=null,devices[_0x47e82b][_0x5d027e(0x35d)]=null,devices[_0x47e82b][_0x5d027e(0x370)]['token']=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x47e82b[_0x5d027e(0x319)](-0x8)),io['to'](getClient(_0x4b6b7a['id'])[_0x5d027e(0x3a3)])[_0x5d027e(0x218)]('status',{'access':{'allow':![],'reason':_0x5d027e(0x344),'token':null}});}else logger[_0x5d027e(0x348)](_0x5d027e(0x21f));});}function removeSocketListeners(_0x4382c6){const _0x5cf9ce=_0x1cc599;getClientsWithUuid(_0x4382c6)[_0x5cf9ce(0x2db)](_0x1f9349=>{const _0x197f4b=_0x5cf9ce;getSocket(_0x1f9349['id'])[_0x197f4b(0x1fb)]();});}function cleanSettings(){const _0x46bd0c=_0x1cc599;let _0x327831=settings;return settings[_0x46bd0c(0x2a0)]&&settings[_0x46bd0c(0x2a0)]!=''&&(_0x327831={..._0x327831,'telegramToken':'************'}),settings[_0x46bd0c(0x236)]&&settings[_0x46bd0c(0x236)]!=''&&(_0x327831={..._0x327831,'bbPassword':_0x46bd0c(0x26c)}),(settings[_0x46bd0c(0x236)]&&settings[_0x46bd0c(0x236)]==_0x46bd0c(0x259)||settings[_0x46bd0c(0x2a0)]&&settings[_0x46bd0c(0x2a0)]==_0x46bd0c(0x259))&&(_0x327831={..._0x327831,'restored':{'password':settings[_0x46bd0c(0x236)]==_0x46bd0c(0x259),'telegram':settings[_0x46bd0c(0x2a0)]==_0x46bd0c(0x259)}}),_0x327831;}async function updateBB(_0x13c742){const _0x1ab200=_0x1cc599;await backupConfigFiles(),installingUpdate=!![],config[_0x1ab200(0x2db)](_0x2d465b=>{const _0x5c066e=_0x1ab200;restartBot(_0x2d465b[_0x5c066e(0x22a)]);});if(_0x13c742==_0x1ab200(0x3d5))process[_0x1ab200(0x315)]({'update':!![],'environment':environment},_0x4c0237=>{});else _0x13c742=='reinstall'&&process['send']({'reinstall':!![],'environment':environment},_0x1906b5=>{});}function startBot(_0xa15fb9,_0x39d6e6,_0x16a480){const _0x4e9580=_0x1cc599;if(debugging)_0xa15fb9[_0x4e9580(0x24d)]('-d');let _0x38dc8e=![];const _0x17ef4c=_0xa15fb9[0x0];_0x39d6e6={..._0x39d6e6,'stdio':[_0x4e9580(0x29d),'inherit',_0x4e9580(0x29d),_0x4e9580(0x28d)]},pid[_0x17ef4c]=childProcess['fork'](botfile,_0xa15fb9,_0x39d6e6),pid[_0x17ef4c]['on'](_0x4e9580(0x27d),_0x222241=>{const _0x224653=_0x4e9580;switch(Object[_0x224653(0x398)](_0x222241)[0x0]){case _0x224653(0x277):updateBotName(_0x17ef4c,_0x222241[_0x224653(0x277)]);break;case _0x224653(0x313):updateBotManager();break;case _0x224653(0x3ce):updateStatus(_0x17ef4c,_0x222241[_0x224653(0x3ce)]);break;case'live':updateLive(_0x17ef4c,_0x222241[_0x224653(0x2be)]);break;case _0x224653(0x331):updateLive(_0x17ef4c,_0x222241[_0x224653(0x331)]),io['to'](_0x17ef4c)[_0x224653(0x218)](_0x224653(0x3ce),{'access':{'allow':![],'reason':_0x224653(0x215),'token':null}});break;case _0x224653(0x21d):_0x222241[_0x224653(0x21d)]==_0x224653(0x1e8)&&restartBot(_0x17ef4c);_0x222241[_0x224653(0x21d)]==_0x224653(0x269)&&toggleBot(_0x17ef4c,_0x224653(0x25b),_0x224653(0x1ef));break;case'telegram':sendTelegramBot(_0x17ef4c,_0x222241[_0x224653(0x2eb)]);break;case _0x224653(0x378):sendTelegramMsg(_0x222241[_0x224653(0x378)]);break;case _0x224653(0x2f2):io['to'](_0x17ef4c)[_0x224653(0x218)](_0x222241[_0x224653(0x2f2)],_0x222241['args']);break;}}),pid[_0x17ef4c]['on'](_0x4e9580(0x1e9),function(_0x13eb89){if(_0x38dc8e)return;_0x38dc8e=!![],_0x16a480(_0x13eb89);}),pid[_0x17ef4c]['on'](_0x4e9580(0x36e),async function(_0x200b52){const _0xb2e03e=_0x4e9580;if(terminating)return;if(installingUpdate){logger['debug'](_0xb2e03e(0x321)),io[_0xb2e03e(0x399)]();return;}if(_0x38dc8e)return;_0x38dc8e=!![],_0x16a480(null);const _0x404de5=dbConfig['get'](_0xb2e03e(0x261))['find']({'botID':_0x17ef4c})['value']();_0x404de5&&(_0x404de5['status']==_0xb2e03e(0x27b)||_0x404de5[_0xb2e03e(0x3ce)]==_0xb2e03e(0x3ca))&&(await sleep(0x3e8),updateLive(_0x17ef4c,_0xb2e03e(0x1ef)),logger['full'](_0xb2e03e(0x203)+_0x17ef4c),startBot([_0x17ef4c,userID],{'cwd':bbpath},function(_0x1b212f){const _0x111720=_0xb2e03e;if(_0x1b212f)logger[_0x111720(0x348)](_0x1b212f);}));});}function stopBot(_0x3ce382){const _0x59fd2c=_0x1cc599;getClientsWithBotID(_0x3ce382)[_0x59fd2c(0x2db)](_0x505e17=>{const _0x5cb9e4=_0x59fd2c;getSocket(_0x505e17['id'])[_0x5cb9e4(0x311)](!![]),removeClient(_0x505e17['id']);}),pid[_0x3ce382]&&(pid[_0x3ce382]['kill'](),pid[_0x3ce382]=null);}function stopAllBots(){const _0x4704d3=_0x1cc599;terminating=!![];const _0x4bf00c=getEnabledBots();_0x4bf00c[_0x4704d3(0x2db)](_0x86efe=>{const _0x444b54=_0x4704d3;stopBot(_0x86efe[_0x444b54(0x22a)]);});}function restartBot(_0x38f638){if(pid[_0x38f638])pid[_0x38f638]['kill']();}function addBot(){const _0x5b7095=_0x1cc599;let _0x299f12;for(let _0x5959e4=0x1;_0x5959e4<0x3e9;_0x5959e4++){_0x299f12=_0x5959e4['toString']()['padStart'](0x3,'0');let _0x589448=config[_0x5b7095(0x302)](_0x2b7215=>_0x2b7215[_0x5b7095(0x22a)]==_0x299f12);if(!_0x589448)break;}if(_0x299f12==='1000'){logger['full'](_0x5b7095(0x339));return;}logger[_0x5b7095(0x348)](_0x5b7095(0x368)+_0x299f12),dbConfig['get'](_0x5b7095(0x261))[_0x5b7095(0x24d)]({'botID':_0x299f12,'botname':_0x5b7095(0x31e)+_0x299f12,'status':_0x5b7095(0x3ca),'live':''})['write'](),startBot([_0x299f12,userID],{'cwd':bbpath},function(_0x2544fa){const _0x52b1c7=_0x5b7095;if(_0x2544fa)logger[_0x52b1c7(0x348)](_0x2544fa);}),config=getConfiguration(),io['to']('botmanager')[_0x5b7095(0x218)]('bots',config),broadcastToBots(_0x5b7095(0x261),JSON[_0x5b7095(0x2e5)](config));}function deleteBot(_0x2b0baa){const _0x342f18=_0x1cc599;getClientsWithBotID(_0x2b0baa)['forEach'](_0x8c7b2c=>{const _0x41d7a6=_0x5c94;getSocket(_0x8c7b2c['id'])[_0x41d7a6(0x311)](!![]),removeClient(_0x8c7b2c['id']);}),dbConfig[_0x342f18(0x2a8)](_0x342f18(0x261))['remove']({'botID':_0x2b0baa})[_0x342f18(0x3d8)](),logger[_0x342f18(0x348)](_0x342f18(0x3a8)+_0x2b0baa),stopBot(_0x2b0baa);try{if(fs[_0x342f18(0x36b)](path[_0x342f18(0x300)](configpath,_0x342f18(0x1f6)+_0x2b0baa+_0x342f18(0x26b))))fs[_0x342f18(0x38c)](path[_0x342f18(0x300)](configpath,_0x342f18(0x1f6)+_0x2b0baa+'-config.json'));if(fs['existsSync'](path[_0x342f18(0x300)](configpath,_0x342f18(0x1f6)+_0x2b0baa+_0x342f18(0x29e))))fs[_0x342f18(0x38c)](path[_0x342f18(0x300)](configpath,_0x342f18(0x1f6)+_0x2b0baa+'-events.json'));if(fs[_0x342f18(0x36b)](path[_0x342f18(0x300)](configpath,_0x342f18(0x1f6)+_0x2b0baa+_0x342f18(0x34a))))fs[_0x342f18(0x38c)](path[_0x342f18(0x300)](configpath,_0x342f18(0x1f6)+_0x2b0baa+_0x342f18(0x34a)));if(fs[_0x342f18(0x36b)](path['join'](configpath,'bot-'+_0x2b0baa+_0x342f18(0x24c))))fs[_0x342f18(0x38c)](path[_0x342f18(0x300)](configpath,_0x342f18(0x1f6)+_0x2b0baa+_0x342f18(0x24c)));}catch(_0x25d343){if(_0x25d343)logger['full'](_0x342f18(0x204),_0x25d343);}config=getConfiguration(),io['to'](_0x342f18(0x3c8))[_0x342f18(0x218)]('bots',config),broadcastToBots(_0x342f18(0x261),JSON['stringify'](config));}function toggleBot(_0x874e2d,_0x5426a2,_0x4cdb82){const _0x4e75d9=_0x1cc599;dbConfig[_0x4e75d9(0x2a8)](_0x4e75d9(0x261))[_0x4e75d9(0x302)]({'botID':_0x874e2d})[_0x4e75d9(0x20f)]({'status':_0x5426a2})[_0x4e75d9(0x20f)]({'live':_0x4cdb82})[_0x4e75d9(0x3d8)]();if(_0x5426a2=='enabled'||_0x5426a2==_0x4e75d9(0x3ca))logger['full'](_0x4e75d9(0x2e6)+_0x874e2d),startBot([_0x874e2d,userID],{'cwd':bbpath},function(_0x1873cb){const _0xaf9aa1=_0x4e75d9;if(_0x1873cb)logger[_0xaf9aa1(0x348)](_0x1873cb);});else(_0x5426a2==_0x4e75d9(0x25b)||_0x5426a2==_0x4e75d9(0x2aa))&&(logger[_0x4e75d9(0x348)]('Disabled\x20Bot\x20'+_0x874e2d),stopBot(_0x874e2d));config=getConfiguration(),io['to'](_0x4e75d9(0x3c8))[_0x4e75d9(0x218)](_0x4e75d9(0x261),config),broadcastToBots(_0x4e75d9(0x261),JSON[_0x4e75d9(0x2e5)](config));}function toggleStatus(_0x2666b3){const _0x29156a=_0x1cc599;let _0x439bc9=dbConfig[_0x29156a(0x2a8)]('bots')['find']({'botID':_0x2666b3})[_0x29156a(0x35e)](),_0x53f0b3;if(_0x439bc9[_0x29156a(0x3ce)]===_0x29156a(0x27b))_0x53f0b3=_0x29156a(0x25b);else{if(_0x439bc9[_0x29156a(0x3ce)]===_0x29156a(0x3ca))_0x53f0b3=_0x29156a(0x2aa);else{if(_0x439bc9[_0x29156a(0x3ce)]===_0x29156a(0x2aa))_0x53f0b3=_0x29156a(0x3ca);else{if(_0x439bc9[_0x29156a(0x3ce)]===_0x29156a(0x25b))_0x53f0b3=_0x29156a(0x27b);}}}return _0x53f0b3;}function updateStatus(_0x622a88,_0x9187e6){const _0x39d8e6=_0x1cc599;dbConfig[_0x39d8e6(0x2a8)](_0x39d8e6(0x261))[_0x39d8e6(0x302)]({'botID':_0x622a88})['assign']({'status':_0x9187e6})[_0x39d8e6(0x3d8)](),config=getConfiguration(),io['to']('botmanager')[_0x39d8e6(0x218)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function updateLive(_0x342cf2,_0x256890){const _0x11955e=_0x1cc599;dbConfig[_0x11955e(0x2a8)](_0x11955e(0x261))[_0x11955e(0x302)]({'botID':_0x342cf2})[_0x11955e(0x20f)]({'live':_0x256890})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x11955e(0x218)](_0x11955e(0x261),config),broadcastToBots(_0x11955e(0x261),JSON[_0x11955e(0x2e5)](config));}function updateBotName(_0x1122ef,_0x3df3fa){const _0x55f5cd=_0x1cc599;dbConfig[_0x55f5cd(0x2a8)](_0x55f5cd(0x261))['find']({'botID':_0x1122ef})[_0x55f5cd(0x20f)]({'botname':_0x3df3fa})['write'](),config=getConfiguration(),io['to'](_0x55f5cd(0x3c8))[_0x55f5cd(0x218)](_0x55f5cd(0x261),config),broadcastToBots(_0x55f5cd(0x261),JSON[_0x55f5cd(0x2e5)](config));}function updateBotManager(){const _0x2fdbd4=_0x1cc599;config=getConfiguration(),io['to'](_0x2fdbd4(0x3c8))[_0x2fdbd4(0x218)](_0x2fdbd4(0x261),config),broadcastToBots('bots',JSON[_0x2fdbd4(0x2e5)](config));}function toggleBotMode(_0x4b54a2){const _0x27024d=_0x1cc599;if(pid[_0x4b54a2])pid[_0x4b54a2][_0x27024d(0x315)]({'function':_0x27024d(0x2b1),'args':null});else{const _0x4a00b9=configpath+_0x27024d(0x1f6)+_0x4b54a2+'-config.json',_0x51a86b=fs[_0x27024d(0x292)](_0x4a00b9),_0x1842b9=JSON[_0x27024d(0x391)](_0x51a86b),_0x572615=_0x1842b9[_0x27024d(0x3a1)][0x0][_0x27024d(0x3c0)];_0x1842b9['bot'][0x0][_0x27024d(0x3c0)]=!_0x572615;const _0x1dd9d3=JSON[_0x27024d(0x2e5)](_0x1842b9,null,0x2);fs[_0x27024d(0x214)](_0x4a00b9,_0x1dd9d3),config=getConfiguration(),io['to']('botmanager')[_0x27024d(0x218)](_0x27024d(0x261),config),broadcastToBots('bots',JSON[_0x27024d(0x2e5)](config));}}function validateTelegram(_0x257c8b){const _0x537e47=_0x1cc599;if(_0x257c8b[_0x537e47(0x3db)][_0x537e47(0x1f2)]!=settings[_0x537e47(0x288)]&&'@'+_0x257c8b['from'][_0x537e47(0x1f2)]!=settings[_0x537e47(0x288)]||_0x257c8b['chat']['id']!=settings['telegramChatId'])return sendTelegram(_0x257c8b['chat']['id'],_0x537e47(0x225),{'parse_mode':_0x537e47(0x20b)}),![];return!![];}async function initTelegram(){const _0xefc2a3=_0x1cc599;if(tgBot)tgBot[_0xefc2a3(0x21d)](),tgBot=null,initTelegram();else{tgBot=new Telegraf(settings['telegramToken']);let _0x332ef1=_0xefc2a3(0x28c);_0x332ef1+='\x0a',_0x332ef1+='/enable\x20-\x20enable\x20notifications\x0a',_0x332ef1+=_0xefc2a3(0x29b),_0x332ef1+=_0xefc2a3(0x366),_0x332ef1+=_0xefc2a3(0x224),_0x332ef1+='/on\x20-\x20start\x20bot(s)\x0a',_0x332ef1+=_0xefc2a3(0x23a),_0x332ef1+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x332ef1+=_0xefc2a3(0x373),_0x332ef1+=_0xefc2a3(0x255),_0x332ef1+=_0xefc2a3(0x210),_0x332ef1+=_0xefc2a3(0x21a),_0x332ef1+=_0xefc2a3(0x39d),_0x332ef1+=_0xefc2a3(0x2fc),_0x332ef1+=_0xefc2a3(0x23b);let _0x147b7c=_0xefc2a3(0x353);_0x147b7c+='\x0a',_0x147b7c+=_0x332ef1,tgBot[_0xefc2a3(0x3b0)]((_0x513bd5,_0x1365ab)=>{const _0x2f73db=_0xefc2a3;logger[_0x2f73db(0x33c)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger[_0x2f73db(0x276)](_0x2f73db(0x337),_0x513bd5);}),tgBot['use'](async(_0x1c7a02,_0x4fb90f)=>{const _0x20ddfd=_0xefc2a3;if(!(!settings[_0x20ddfd(0x250)]&&_0x1c7a02[_0x20ddfd(0x3d5)][_0x20ddfd(0x27d)][_0x20ddfd(0x3c3)]=='/start')){if(!validateTelegram(_0x1c7a02))return;}_0x4fb90f();}),tgBot['command'](_0xefc2a3(0x3ae),async _0x135666=>{const _0x3dde65=_0xefc2a3;if(!settings[_0x3dde65(0x250)])updateSetting(_0x3dde65(0x250),_0x135666['chat']['id']);updateSetting('telegramEnabled',!![]);if(!validateTelegram(_0x135666))return;await sendTelegram(_0x135666[_0x3dde65(0x2b7)]['id'],_0x147b7c);}),tgBot[_0xefc2a3(0x37b)](_0xefc2a3(0x25e),async _0x5f5360=>{const _0x290645=_0xefc2a3;updateSetting(_0x290645(0x2bf),!![]),await sendTelegram(_0x5f5360[_0x290645(0x2b7)]['id'],_0x290645(0x299));}),tgBot[_0xefc2a3(0x37b)](_0xefc2a3(0x20e),async _0xe38e9=>{const _0x4f550d=_0xefc2a3;await sendTelegram(_0xe38e9[_0x4f550d(0x2b7)]['id'],_0x4f550d(0x33d)),updateSetting(_0x4f550d(0x2bf),![]);}),tgBot[_0xefc2a3(0x37b)](_0xefc2a3(0x1fe),async _0x1dcf8d=>{const _0x1bcbe5=_0xefc2a3,_0xa7f1f4=Markup[_0x1bcbe5(0x29c)]([Markup[_0x1bcbe5(0x306)][_0x1bcbe5(0x1dc)](_0x1bcbe5(0x3bc),'config_orders'),Markup['button'][_0x1bcbe5(0x1dc)]('Alerts','config_alerts'),Markup[_0x1bcbe5(0x306)][_0x1bcbe5(0x1dc)](_0x1bcbe5(0x36c),'config_all')]);_0x1dcf8d[_0x1bcbe5(0x32b)](_0x1bcbe5(0x2ee),_0xa7f1f4);}),tgBot[_0xefc2a3(0x325)](_0xefc2a3(0x349),async _0x2a72ff=>{const _0x145cda=_0xefc2a3;_0x2a72ff[_0x145cda(0x2d2)](),updateSetting(_0x145cda(0x1e5),_0x145cda(0x2d6)),updateSetting(_0x145cda(0x2bf),!![]),await sendTelegram(_0x2a72ff[_0x145cda(0x2b7)]['id'],_0x145cda(0x354));}),tgBot[_0xefc2a3(0x325)](_0xefc2a3(0x39a),async _0x11bb01=>{const _0x54236e=_0xefc2a3;_0x11bb01[_0x54236e(0x2d2)](),updateSetting(_0x54236e(0x1e5),_0x54236e(0x240)),updateSetting(_0x54236e(0x2bf),!![]),await sendTelegram(_0x11bb01[_0x54236e(0x2b7)]['id'],_0x54236e(0x23d));}),tgBot[_0xefc2a3(0x325)](_0xefc2a3(0x335),async _0x230dba=>{const _0x3a2e4d=_0xefc2a3;_0x230dba[_0x3a2e4d(0x2d2)](),updateSetting(_0x3a2e4d(0x1e5),_0x3a2e4d(0x32e)),updateSetting(_0x3a2e4d(0x2bf),!![]),await sendTelegram(_0x230dba[_0x3a2e4d(0x2b7)]['id'],_0x3a2e4d(0x211));}),tgBot['command'](_0xefc2a3(0x3ce),async _0x29d274=>{const _0x12a3b2=_0xefc2a3,_0x210c40=getBotsWithMode();let _0x4b0352=_0x12a3b2(0x32c);config[_0x12a3b2(0x2db)](_0x374e62=>{const _0x44e16c=_0x12a3b2,_0x143b36=_0x210c40[_0x44e16c(0x302)](_0x29fae2=>_0x29fae2[_0x44e16c(0x22a)]==_0x374e62[_0x44e16c(0x22a)])['mode'];_0x4b0352+=_0x44e16c(0x31e)+_0x374e62[_0x44e16c(0x22a)]+':\x20'+_0x374e62[_0x44e16c(0x3ce)]+_0x44e16c(0x326)+_0x143b36+_0x44e16c(0x326)+_0x374e62['live']+'\x0a';}),_0x4b0352+='\x0a',_0x4b0352+=_0x12a3b2(0x273),_0x4b0352+=!settings['telegramEnabled']?_0x12a3b2(0x371):_0x12a3b2(0x1e1),_0x4b0352+=settings[_0x12a3b2(0x2bf)]?settings['telegramEvents']==_0x12a3b2(0x32e)?_0x12a3b2(0x1de):_0x12a3b2(0x1f1)+settings[_0x12a3b2(0x1e5)]+_0x12a3b2(0x275):'',await sendTelegram(_0x29d274[_0x12a3b2(0x2b7)]['id'],_0x4b0352,{'parse_mode':_0x12a3b2(0x20b)});}),tgBot[_0xefc2a3(0x37b)](_0xefc2a3(0x1e8),async _0x52e641=>{const _0x2bd19d=_0xefc2a3,_0x50022f=getEnabledBots();if(_0x50022f['length']==0x0)await sendTelegram(_0x52e641['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x50022f['length']>0x1)_0x50022f[_0x2bd19d(0x24d)]({'botID':_0x2bd19d(0x32e)});let _0x2eceea=[],_0x4f4a2f=[];const _0x5c214d=_0x50022f[_0x2bd19d(0x39c)]%0x4==0x0||_0x50022f[_0x2bd19d(0x39c)]%0x4==0x3||_0x50022f[_0x2bd19d(0x39c)]%0x3==0x1?0x4:0x3;let _0x362895=0x0;_0x50022f[_0x2bd19d(0x2db)]((_0x5bea0f,_0x5a5d23)=>{const _0x53bd12=_0x2bd19d;if(_0x5a5d23%_0x5c214d==0x0)_0x4f4a2f=[];_0x4f4a2f[_0x53bd12(0x24d)](Markup[_0x53bd12(0x306)]['callback'](_0x5bea0f['botID']==_0x53bd12(0x32e)?'All\x20bots':'Bot\x20'+_0x5bea0f[_0x53bd12(0x22a)],'restart_'+_0x5bea0f['botID'])),_0x5a5d23%_0x5c214d==0x0&&(_0x2eceea[_0x362895]=_0x4f4a2f,_0x362895++);});const _0x15ef96=Markup[_0x2bd19d(0x29c)](_0x2eceea);_0x52e641[_0x2bd19d(0x32b)](_0x2bd19d(0x3cc),_0x15ef96);}}),tgBot['action'](/restart_(.+)/,async _0x3cd346=>{const _0x4c7a6b=_0xefc2a3,_0x673196=_0x3cd346['match'][0x1];_0x3cd346[_0x4c7a6b(0x2d2)](),_0x673196==_0x4c7a6b(0x32e)?config[_0x4c7a6b(0x2db)](_0x43adc2=>{const _0x5a11e8=_0x4c7a6b;restartBot(_0x43adc2[_0x5a11e8(0x22a)]);}):restartBot(_0x673196);}),tgBot[_0xefc2a3(0x37b)]('on',async _0x373801=>{const _0x55aa02=_0xefc2a3,_0x21da3c=getDisabledBots();if(_0x21da3c[_0x55aa02(0x39c)]==0x0)await sendTelegram(_0x373801[_0x55aa02(0x2b7)]['id'],_0x55aa02(0x28f));else{if(_0x21da3c['length']>0x1)_0x21da3c[_0x55aa02(0x24d)]({'botID':_0x55aa02(0x32e)});let _0x56a8da=[],_0x347078=[];const _0x493ceb=_0x21da3c['length']%0x4==0x0||_0x21da3c[_0x55aa02(0x39c)]%0x4==0x3||_0x21da3c[_0x55aa02(0x39c)]%0x3==0x1?0x4:0x3;let _0x4850af=0x0;_0x21da3c['forEach']((_0x373f95,_0x1b38b9)=>{const _0x52c7a4=_0x55aa02;if(_0x1b38b9%_0x493ceb==0x0)_0x347078=[];_0x347078[_0x52c7a4(0x24d)](Markup[_0x52c7a4(0x306)][_0x52c7a4(0x1dc)](_0x373f95[_0x52c7a4(0x22a)]=='all'?'All\x20bots':_0x52c7a4(0x31e)+_0x373f95['botID'],_0x52c7a4(0x3b8)+_0x373f95[_0x52c7a4(0x22a)])),_0x1b38b9%_0x493ceb==0x0&&(_0x56a8da[_0x4850af]=_0x347078,_0x4850af++);});const _0x1109cb=Markup[_0x55aa02(0x29c)](_0x56a8da);_0x373801[_0x55aa02(0x32b)](_0x55aa02(0x3b6),_0x1109cb);}}),tgBot[_0xefc2a3(0x325)](/on_(.+)/,async _0x591294=>{const _0x2fcbde=_0xefc2a3,_0x124969=_0x591294['match'][0x1];_0x591294[_0x2fcbde(0x2d2)]();if(_0x124969==_0x2fcbde(0x32e)){const _0x22e352=getDisabledBots();await sendTelegram(_0x591294[_0x2fcbde(0x2b7)]['id'],_0x2fcbde(0x246)),_0x22e352['forEach'](_0x243299=>{const _0x3dc18c=_0x2fcbde;if(_0x243299[_0x3dc18c(0x22a)]!=_0x3dc18c(0x32e))toggleBot(_0x243299['botID'],toggleStatus(_0x243299[_0x3dc18c(0x22a)]),_0x3dc18c(0x1ef));});}else await sendTelegram(_0x591294[_0x2fcbde(0x2b7)]['id'],_0x2fcbde(0x385)+_0x124969),toggleBot(_0x124969,toggleStatus(_0x124969),_0x2fcbde(0x1ef));}),tgBot[_0xefc2a3(0x37b)]('off',async _0x318faf=>{const _0x282c65=_0xefc2a3,_0x13d3eb=getEnabledBots();if(_0x13d3eb[_0x282c65(0x39c)]==0x0)await sendTelegram(_0x318faf[_0x282c65(0x2b7)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x13d3eb[_0x282c65(0x39c)]>0x1)_0x13d3eb[_0x282c65(0x24d)]({'botID':_0x282c65(0x32e)});let _0x335b0c=[],_0x378208=[];const _0x5f131f=_0x13d3eb['length']%0x4==0x0||_0x13d3eb[_0x282c65(0x39c)]%0x4==0x3||_0x13d3eb[_0x282c65(0x39c)]%0x3==0x1?0x4:0x3;let _0x1f4b90=0x0;_0x13d3eb['forEach']((_0x26d56c,_0x944428)=>{const _0x1852bb=_0x282c65;if(_0x944428%_0x5f131f==0x0)_0x378208=[];_0x378208[_0x1852bb(0x24d)](Markup[_0x1852bb(0x306)]['callback'](_0x26d56c['botID']==_0x1852bb(0x32e)?'All\x20bots':_0x1852bb(0x31e)+_0x26d56c[_0x1852bb(0x22a)],_0x1852bb(0x244)+_0x26d56c[_0x1852bb(0x22a)])),_0x944428%_0x5f131f==0x0&&(_0x335b0c[_0x1f4b90]=_0x378208,_0x1f4b90++);});const _0x1c97c4=Markup[_0x282c65(0x29c)](_0x335b0c);_0x318faf[_0x282c65(0x32b)](_0x282c65(0x2e7),_0x1c97c4);}}),tgBot[_0xefc2a3(0x325)](/off_(.+)/,async _0x5483d8=>{const _0xb92943=_0xefc2a3,_0xe7b2d4=_0x5483d8[_0xb92943(0x2af)][0x1];_0x5483d8[_0xb92943(0x2d2)]();if(_0xe7b2d4==_0xb92943(0x32e)){const _0x41133f=getEnabledBots();await sendTelegram(_0x5483d8[_0xb92943(0x2b7)]['id'],_0xb92943(0x3d6)),_0x41133f[_0xb92943(0x2db)](_0x488e7a=>{const _0x1d3068=_0xb92943;if(_0x488e7a['botID']!=_0x1d3068(0x32e))toggleBot(_0x488e7a[_0x1d3068(0x22a)],toggleStatus(_0x488e7a[_0x1d3068(0x22a)]),'stopped');});}else await sendTelegram(_0x5483d8[_0xb92943(0x2b7)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0xe7b2d4),toggleBot(_0xe7b2d4,toggleStatus(_0xe7b2d4),_0xb92943(0x1ef));}),tgBot[_0xefc2a3(0x37b)]('metrics',async _0xaf3a2=>{const _0x55e22a=_0xefc2a3,_0x26fd92=getEnabledBots();if(_0x26fd92[_0x55e22a(0x39c)]==0x0)await sendTelegram(_0xaf3a2[_0x55e22a(0x2b7)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x26fd92[_0x55e22a(0x39c)]>0x1){let _0xa80172=[],_0x4ce0af=[];const _0x102a87=_0x26fd92[_0x55e22a(0x39c)]%0x4==0x0||_0x26fd92[_0x55e22a(0x39c)]%0x4==0x3||_0x26fd92[_0x55e22a(0x39c)]%0x3==0x1?0x4:0x3;let _0x1533da=0x0;_0x26fd92['forEach']((_0xb20e6a,_0x22a607)=>{const _0x4a8ac8=_0x55e22a;if(_0x22a607%_0x102a87==0x0)_0x4ce0af=[];_0x4ce0af['push'](Markup['button'][_0x4a8ac8(0x1dc)]('Bot\x20'+_0xb20e6a[_0x4a8ac8(0x22a)],'metrics_'+_0xb20e6a[_0x4a8ac8(0x22a)])),_0x22a607%_0x102a87==0x0&&(_0xa80172[_0x1533da]=_0x4ce0af,_0x1533da++);});const _0xf6f8e9=Markup[_0x55e22a(0x29c)](_0xa80172);_0xaf3a2[_0x55e22a(0x32b)](_0x55e22a(0x3c9),_0xf6f8e9);}else{const _0x20557e=_0x26fd92[0x0]['botID'];if(pid[_0x20557e])pid[_0x20557e][_0x55e22a(0x315)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0xefc2a3(0x325)](/metrics_(.+)/,async _0x4e1b5b=>{const _0x511a4c=_0xefc2a3,_0x2762c8=_0x4e1b5b[_0x511a4c(0x2af)][0x1];_0x4e1b5b[_0x511a4c(0x2d2)]();if(pid[_0x2762c8])pid[_0x2762c8]['send']({'function':_0x511a4c(0x3af),'args':null});}),tgBot[_0xefc2a3(0x37b)](_0xefc2a3(0x318),async _0x47ef57=>{const _0x898431=_0xefc2a3,_0x2e7452=getEnabledBots();if(_0x2e7452['length']==0x0)await sendTelegram(_0x47ef57[_0x898431(0x2b7)]['id'],_0x898431(0x3c4));else{if(_0x2e7452[_0x898431(0x39c)]>0x1){let _0x586ff4=[],_0x4e9ec5=[];const _0x2b6c17=_0x2e7452[_0x898431(0x39c)]%0x4==0x0||_0x2e7452[_0x898431(0x39c)]%0x4==0x3||_0x2e7452[_0x898431(0x39c)]%0x3==0x1?0x4:0x3;let _0x356e47=0x0;_0x2e7452['forEach']((_0x34ff97,_0x34e54b)=>{const _0x53568e=_0x898431;if(_0x34e54b%_0x2b6c17==0x0)_0x4e9ec5=[];_0x4e9ec5[_0x53568e(0x24d)](Markup[_0x53568e(0x306)]['callback'](_0x53568e(0x31e)+_0x34ff97[_0x53568e(0x22a)],_0x53568e(0x33b)+_0x34ff97[_0x53568e(0x22a)])),_0x34e54b%_0x2b6c17==0x0&&(_0x586ff4[_0x356e47]=_0x4e9ec5,_0x356e47++);});const _0x4ad1a2=Markup[_0x898431(0x29c)](_0x586ff4);_0x47ef57[_0x898431(0x32b)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x4ad1a2);}else{const _0x28b81f=_0x2e7452[0x0][_0x898431(0x22a)];if(pid[_0x28b81f])pid[_0x28b81f][_0x898431(0x315)]({'function':_0x898431(0x2f4),'args':null});}}}),tgBot[_0xefc2a3(0x325)](/portfolio_(.+)/,async _0x1a2e69=>{const _0x391db3=_0xefc2a3,_0x594a15=_0x1a2e69[_0x391db3(0x2af)][0x1];_0x1a2e69['editMessageReplyMarkup']();if(pid[_0x594a15])pid[_0x594a15]['send']({'function':_0x391db3(0x2f4),'args':null});}),tgBot[_0xefc2a3(0x37b)]('update',async _0x44d56c=>{const _0x3ef3f2=_0xefc2a3;await getMessages();if(!updateAvailable)await sendTelegram(_0x44d56c['chat']['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x44d56c[_0x3ef3f2(0x2b7)]['id'],_0x3ef3f2(0x274));else{const _0x440ed8=Markup[_0x3ef3f2(0x29c)]([Markup['button'][_0x3ef3f2(0x1dc)](_0x3ef3f2(0x289),_0x3ef3f2(0x20c)),Markup[_0x3ef3f2(0x306)][_0x3ef3f2(0x1dc)]('No',_0x3ef3f2(0x358))]);_0x44d56c[_0x3ef3f2(0x32b)](_0x3ef3f2(0x359),_0x440ed8);}}}),tgBot[_0xefc2a3(0x325)](/update_(.+)/,async _0x39f371=>{const _0x100e69=_0xefc2a3,_0xa8ab4e=_0x39f371[_0x100e69(0x2af)][0x1];_0x39f371[_0x100e69(0x2d2)](),_0xa8ab4e==_0x100e69(0x394)&&(await sendTelegram(_0x39f371[_0x100e69(0x2b7)]['id'],_0x100e69(0x2ac)),updateBB('update')),_0xa8ab4e=='no'&&await sendTelegram(_0x39f371['chat']['id'],_0x100e69(0x2b6));}),tgBot['command'](_0xefc2a3(0x382),async _0x596364=>{const _0x1c3873=_0xefc2a3;if(!validInstallation)await sendTelegram(_0x596364[_0x1c3873(0x2b7)]['id'],_0x1c3873(0x3aa));else{const _0xafe0f0=Markup['inlineKeyboard']([Markup[_0x1c3873(0x306)][_0x1c3873(0x1dc)]('Yes',_0x1c3873(0x37d)),Markup['button'][_0x1c3873(0x1dc)]('No',_0x1c3873(0x3cb))]);_0x596364['reply'](_0x1c3873(0x1e0),_0xafe0f0);}}),tgBot[_0xefc2a3(0x325)](/reinstall_(.+)/,async _0xdb7843=>{const _0xcffbff=_0xefc2a3,_0x202b63=_0xdb7843[_0xcffbff(0x2af)][0x1];_0xdb7843[_0xcffbff(0x2d2)](),_0x202b63==_0xcffbff(0x394)&&(await sendTelegram(_0xdb7843['chat']['id'],_0xcffbff(0x22d)),updateBB('reinstall')),_0x202b63=='no'&&await sendTelegram(_0xdb7843['chat']['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0xefc2a3(0x37b)]('toggle',async _0x32acdd=>{const _0x39b0e0=_0xefc2a3,_0x320d99=getBotsWithMode();if(_0x320d99[_0x39b0e0(0x39c)]==0x0)await sendTelegram(_0x32acdd[_0x39b0e0(0x2b7)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x5dda81=[],_0x250237=[];const _0x488045=0x2;let _0xe0b64f=0x0;_0x320d99['forEach']((_0x5829b8,_0xd7d328)=>{const _0x5670a6=_0x39b0e0;if(_0xd7d328%_0x488045==0x0)_0x250237=[];_0x250237[_0x5670a6(0x24d)](Markup['button'][_0x5670a6(0x1dc)](_0x5670a6(0x31e)+_0x5829b8[_0x5670a6(0x22a)]+'\x20('+_0x5829b8[_0x5670a6(0x24a)]+')',_0x5670a6(0x2de)+_0x5829b8[_0x5670a6(0x22a)])),_0xd7d328%_0x488045==0x0&&(_0x5dda81[_0xe0b64f]=_0x250237,_0xe0b64f++);});const _0x363c93=Markup['inlineKeyboard'](_0x5dda81);_0x32acdd[_0x39b0e0(0x32b)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x363c93);}}),tgBot[_0xefc2a3(0x325)](/toggle_(.+)/,async _0x19c36c=>{const _0x2da347=_0xefc2a3,_0x3d427c=_0x19c36c['match'][0x1];_0x19c36c[_0x2da347(0x2d2)]();const _0x336afe=getBotsWithMode(),_0x386d48=_0x336afe[_0x2da347(0x302)](_0x43e3bc=>_0x43e3bc[_0x2da347(0x22a)]==_0x3d427c),_0x1e0b88=_0x386d48[_0x2da347(0x24a)]==_0x2da347(0x2c2)?_0x2da347(0x35a):_0x2da347(0x2c2);await sendTelegram(_0x19c36c[_0x2da347(0x2b7)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x3d427c+_0x2da347(0x209)+_0x1e0b88+'\x20mode'),toggleBotMode(_0x3d427c);}),tgBot[_0xefc2a3(0x37b)](_0xefc2a3(0x26a),async _0x2971e3=>{const _0x319218=_0xefc2a3;let _0x309202='';config['forEach'](_0x1b7800=>{const _0x453f09=_0x5c94;_0x309202+=_0x453f09(0x31e)+_0x1b7800[_0x453f09(0x22a)]+':\x20'+_0x1b7800['botname']+'\x0a';}),await sendTelegram(_0x2971e3[_0x319218(0x2b7)]['id'],_0x309202,{'parse_mode':_0x319218(0x20b)});}),tgBot[_0xefc2a3(0x37b)](_0xefc2a3(0x2ab),async _0x40741b=>{const _0x3aaa7f=_0xefc2a3;await sendTelegram(_0x40741b[_0x3aaa7f(0x2b7)]['id'],_0x332ef1);}),process[_0xefc2a3(0x294)](_0xefc2a3(0x21b),()=>tgBot[_0xefc2a3(0x21d)](_0xefc2a3(0x21b))),process[_0xefc2a3(0x294)](_0xefc2a3(0x2a4),()=>tgBot['stop'](_0xefc2a3(0x2a4))),tgBot['launch']();}}function disableTelegram(){const _0x55c3b5=_0x1cc599;tgBot&&tgBot[_0x55c3b5(0x21d)]();}async function sendTelegram(_0x208ba0,_0x478f07,_0x320465){const _0x4c7fa0=_0x1cc599;try{await tgBot['telegram']['sendMessage'](_0x208ba0,_0x478f07,_0x320465);}catch(_0x367224){console[_0x4c7fa0(0x2b2)](_0x4c7fa0(0x2fd),_0x367224);}}async function sendTelegramBot(_0x5cfe00,_0x37e461){const _0x13f3f1=_0x1cc599;if(settings['telegramEnabled']){if(settings[_0x13f3f1(0x1e5)]==_0x13f3f1(0x32e)||(_0x37e461[_0x13f3f1(0x242)]==_0x13f3f1(0x1e9)||_0x37e461[_0x13f3f1(0x242)]==_0x13f3f1(0x25a)||_0x37e461[_0x13f3f1(0x242)]==_0x13f3f1(0x3d1))&&settings[_0x13f3f1(0x1e5)]==_0x13f3f1(0x240)||_0x37e461['type']==_0x13f3f1(0x356)&&settings['telegramEvents']==_0x13f3f1(0x2d6)){if(tgBot&&settings[_0x13f3f1(0x250)]){if(_0x37e461[_0x13f3f1(0x21e)])await sendTelegram(settings[_0x13f3f1(0x250)],_0x37e461[_0x13f3f1(0x277)]+_0x13f3f1(0x1e2)+_0x37e461['event']);else await sendTelegram(settings[_0x13f3f1(0x250)],_0x13f3f1(0x31e)+_0x5cfe00+_0x13f3f1(0x1e2)+_0x37e461[_0x13f3f1(0x31a)]);}}}}async function sendTelegramMsg(_0x571ca4,_0x3993a5=_0x1cc599(0x20b)){const _0x4f6f17=_0x1cc599;return settings[_0x4f6f17(0x2bf)]&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x4f6f17(0x250)],_0x571ca4,{'parse_mode':_0x3993a5}),!![]):![];}function getDeviceWithIp(_0x34312b){const _0x3e06b1=_0x1cc599;return devices[_0x3e06b1(0x302)](_0x5f0144=>_0x5f0144['ip']===_0x34312b);}async function temporaryAccess2FA(_0xf80aef,_0x1083f5){const _0x683177=_0x1cc599;let _0x55b4d7=new Date(),_0x2dd13d=![];if(lastIpApproval){if(_0x55b4d7-lastIpApproval<0x1388)_0x2dd13d=!![];}lastIpApproval=new Date();if(_0x2dd13d)return;if(tgBot&&settings[_0x683177(0x250)]){const _0x217e2a=uuidRandom();tmpStorage[_0x217e2a]={'uuid':_0xf80aef,'externalip':_0x1083f5};const _0x55dc20=Markup[_0x683177(0x29c)]([Markup[_0x683177(0x306)][_0x683177(0x1dc)]('5\x20min',_0x683177(0x2b0)+_0x217e2a),Markup['button'][_0x683177(0x1dc)](_0x683177(0x324),'tempaccess_15_'+_0x217e2a),Markup[_0x683177(0x306)]['callback'](_0x683177(0x3ba),_0x683177(0x1e6)+_0x217e2a),Markup['button'][_0x683177(0x1dc)](_0x683177(0x28b),_0x683177(0x355)+_0x217e2a)]);await sendTelegram(settings['telegramChatId'],_0x683177(0x39b)+normalizeIP(_0x1083f5)[_0x683177(0x352)]+'\x20?',_0x55dc20),tgBot[_0x683177(0x325)](/tempaccess_(.+)_(.+)/,async _0x490307=>{const _0x50fec4=_0x683177,_0x3ca6ff=_0x490307['match'][0x1],_0x521120=_0x490307['match'][0x2],{uuid:_0x18534c,externalip:_0x2574ab}=tmpStorage[_0x521120];delete tmpStorage[_0x521120],_0x490307[_0x50fec4(0x2d2)](),devices[_0x18534c]['telegramIpApproval']={'clientip':_0x2574ab,'timestamp':new Date()[_0x50fec4(0x390)](),'expiry':_0x3ca6ff},_0x3ca6ff!=_0x50fec4(0x28b)?(await sendTelegram(_0x490307[_0x50fec4(0x2b7)]['id'],_0x50fec4(0x3b5)+_0x3ca6ff+_0x50fec4(0x384),{'parse_mode':_0x50fec4(0x20b)}),io['to'](_0x18534c)[_0x50fec4(0x218)](_0x50fec4(0x3ce),{'access':{'allow':![],'reason':_0x50fec4(0x215),'token':null}})):(await sendTelegram(_0x490307[_0x50fec4(0x2b7)]['id'],_0x50fec4(0x316)),io['to'](_0x18534c)[_0x50fec4(0x218)]('status',{'access':{'allow':![],'reason':_0x50fec4(0x219),'token':null}}));});}}async function loginAccess2FA(_0x4e7536,_0x3481b9){const _0x14c0e8=_0x1cc599;if(tgBot&&settings[_0x14c0e8(0x250)]){const _0x47680d=uuidRandom();tmpStorage[_0x47680d]={'uuid':_0x4e7536,'externalip':_0x3481b9};const _0x5d4adf=Markup['inlineKeyboard']([Markup[_0x14c0e8(0x306)][_0x14c0e8(0x1dc)](_0x14c0e8(0x31b),_0x14c0e8(0x38a)+loginExpiry+'_'+_0x47680d),Markup['button'][_0x14c0e8(0x1dc)](_0x14c0e8(0x28b),'login2fa_reject_'+_0x47680d)]);await sendTelegram(settings['telegramChatId'],_0x14c0e8(0x3c1)+normalizeIP(_0x3481b9)[_0x14c0e8(0x352)]+'\x20?',_0x5d4adf),tgBot[_0x14c0e8(0x325)](/login2fa_(.+)_(.+)/,async _0x52711e=>{const _0x1bfb24=_0x14c0e8,_0xbae01c=_0x52711e['match'][0x1],_0x3b0156=_0x52711e['match'][0x2],{uuid:_0x272165,externalip:_0x31f0b7}=tmpStorage[_0x3b0156];delete tmpStorage[_0x3b0156],_0x52711e['editMessageReplyMarkup'](),devices[_0x272165][_0x1bfb24(0x35d)]={'clientip':_0x31f0b7,'timestamp':new Date()[_0x1bfb24(0x390)](),'expiry':_0xbae01c},_0xbae01c!='reject'?(await sendTelegram(_0x52711e[_0x1bfb24(0x2b7)]['id'],_0x1bfb24(0x2cf),{'parse_mode':_0x1bfb24(0x20b)}),io['to'](_0x272165)[_0x1bfb24(0x218)](_0x1bfb24(0x3ce),{'access':{'allow':![],'reason':_0x1bfb24(0x215),'token':null}})):(await sendTelegram(_0x52711e[_0x1bfb24(0x2b7)]['id'],'Login\x20rejected'),io['to'](_0x272165)[_0x1bfb24(0x218)](_0x1bfb24(0x3ce),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x2f96c6=_0x1cc599;return dbConfig[_0x2f96c6(0x2a8)](_0x2f96c6(0x261))['sortBy'](_0x2f96c6(0x22a))[_0x2f96c6(0x34b)]({'status':'enabled'})[_0x2f96c6(0x35e)]()||[];}function getDisabledBots(){const _0x5ea9ac=_0x1cc599;return dbConfig[_0x5ea9ac(0x2a8)](_0x5ea9ac(0x261))[_0x5ea9ac(0x2ec)](_0x5ea9ac(0x22a))[_0x5ea9ac(0x34b)]({'status':_0x5ea9ac(0x25b)})[_0x5ea9ac(0x35e)]()||[];}function getBotAttributes(_0x315edc){const _0x4acdce=_0x1cc599;let _0x5cbb75={};const _0x227407=configpath+_0x4acdce(0x1f6)+_0x315edc+_0x4acdce(0x26b),_0x419675=fs[_0x4acdce(0x36b)](_0x227407);if(_0x419675){const _0x1ba278=fs[_0x4acdce(0x292)](_0x227407);try{const _0xc73b1e=JSON[_0x4acdce(0x391)](_0x1ba278),_0x598600=_0xc73b1e?_0xc73b1e[_0x4acdce(0x3a1)][0x0][_0x4acdce(0x3c0)]:![];_0x5cbb75[_0x4acdce(0x24a)]=_0x598600?'auto':_0x4acdce(0x35a),_0x5cbb75['botname']=_0xc73b1e?_0xc73b1e[_0x4acdce(0x3a1)][0x0][_0x4acdce(0x277)]:'Bot\x20'+_0x315edc;}catch(_0x59a1ba){_0x5cbb75[_0x4acdce(0x24a)]=_0x4acdce(0x35a),_0x5cbb75[_0x4acdce(0x277)]=_0x4acdce(0x31e)+_0x315edc;}}else _0x5cbb75[_0x4acdce(0x24a)]=_0x4acdce(0x35a),_0x5cbb75[_0x4acdce(0x277)]=_0x4acdce(0x31e)+_0x315edc;return _0x5cbb75;}function getBotsWithMode(){const _0xfc744a=_0x1cc599,_0x5e224f=dbConfig[_0xfc744a(0x2a8)]('bots')['sortBy'](_0xfc744a(0x22a))['value']()||[];return _0x5e224f[_0xfc744a(0x2db)](_0x1fc79d=>{const _0x34c6bd=_0xfc744a;let _0x48fe6=getBotAttributes(_0x1fc79d[_0x34c6bd(0x22a)]);_0x1fc79d[_0x34c6bd(0x24a)]=_0x48fe6[_0x34c6bd(0x24a)];}),_0x5e224f;}function getBotExchanges(){const _0x43b6cb=_0x1cc599;let _0x50adc6=[];const _0xd7ff28=dbConfig[_0x43b6cb(0x2a8)]('bots')[_0x43b6cb(0x2ec)](_0x43b6cb(0x22a))[_0x43b6cb(0x35e)]()||[];_0xd7ff28[_0x43b6cb(0x2db)](_0x520023=>{const _0xdb3700=_0x43b6cb;if(_0x520023[_0xdb3700(0x3ce)]==_0xdb3700(0x27b)){const _0x32142f=configpath+_0xdb3700(0x1f6)+_0x520023['botID']+_0xdb3700(0x26b),_0x535bd=fs['existsSync'](_0x32142f);let _0x95edb6;if(_0x535bd){const _0x206e60=fs[_0xdb3700(0x292)](_0x32142f);try{const _0x459d82=JSON[_0xdb3700(0x391)](_0x206e60);_0x95edb6=_0x459d82?_0x459d82[_0xdb3700(0x3a1)][0x0]['exchange']:null;}catch(_0x7cc099){}}if(_0x95edb6)_0x50adc6['push'](_0x95edb6);}});const _0x2c42fa=[...new Set(_0x50adc6)][_0x43b6cb(0x3a7)]();return _0x2c42fa;}async function initUser(){const _0xfa8739=_0x1cc599;if(!settings[_0xfa8739(0x24e)]){const _0x221998=uuidRandom();mixpanel['alias'](_0x221998),updateSetting('userid',_0x221998);}}async function initSecure(){const _0x2d42fe=_0x1cc599;let _0x484e7f=getSecure();if(!_0x484e7f['hasOwnProperty'](_0x2d42fe(0x1d9))){let _0x3c55a5=await generateKeys();_0x484e7f[_0x2d42fe(0x233)]=_0x3c55a5[_0x2d42fe(0x233)],_0x484e7f[_0x2d42fe(0x2ea)]=_0x3c55a5['privateKey'],_0x484e7f[_0x2d42fe(0x1d9)]=crypto[_0x2d42fe(0x27c)](0x20)['toString']('hex');;storeSecure(_0x484e7f);}}function getSettings(){const _0x41a5eb=_0x1cc599;return dbSettings[_0x41a5eb(0x2a8)]('settings')[_0x41a5eb(0x35e)]()||{};}function getSecure(){const _0x3db4a4=_0x1cc599;return dbSecure[_0x3db4a4(0x2a8)](_0x3db4a4(0x278))['value']()||{};}function getBlacklist(){const _0x273974=_0x1cc599;return dbSecure[_0x273974(0x2a8)](_0x273974(0x252))[_0x273974(0x35e)]()||[];}function broadcastToBots(_0x9736b0,_0x39866c){config['forEach'](_0x677587=>{const _0x24f1cc=_0x5c94;if(_0x677587[_0x24f1cc(0x3ce)]==_0x24f1cc(0x27b)&&_0x677587[_0x24f1cc(0x2be)]=='running'||_0x677587[_0x24f1cc(0x3ce)]==_0x24f1cc(0x3ca)&&_0x677587['live']==_0x24f1cc(0x31c)){if(pid[_0x677587[_0x24f1cc(0x22a)]])pid[_0x677587[_0x24f1cc(0x22a)]][_0x24f1cc(0x315)]({[_0x9736b0]:_0x39866c});}});}function storeSettings(_0x24c39c,_0xfc8dd9=![]){const _0x446866=_0x1cc599;_0x24c39c={...settings,..._0x24c39c};if(_0xfc8dd9&&_0x24c39c[_0x446866(0x236)]!=_0x446866(0x26c)&&_0x24c39c[_0x446866(0x236)]!=_0x446866(0x259)&&_0x24c39c[_0x446866(0x236)]!=''){const _0x2878c9=crypt[_0x446866(0x24f)](secure['privateKey'],_0x24c39c[_0x446866(0x236)])[_0x446866(0x27d)][_0x446866(0x232)]('@')[0x0],_0x1447ec=bcrypt[_0x446866(0x2e9)](_0x2878c9,saltRounds);_0x24c39c={..._0x24c39c,'bbPassword':_0x1447ec};}if(_0xfc8dd9&&_0x24c39c[_0x446866(0x2a0)]!=_0x446866(0x26c)&&_0x24c39c[_0x446866(0x2a0)]!=_0x446866(0x259)&&_0x24c39c['telegramToken']!=''){const _0x440baa=crypt['decrypt'](secure['privateKey'],_0x24c39c['telegramToken'])[_0x446866(0x27d)][_0x446866(0x232)]('@')[0x0];_0x24c39c={..._0x24c39c,'telegramToken':_0x440baa};}const _0x31d7bf=_0x24c39c['telegramToken']!=_0x446866(0x26c)&&_0x24c39c['telegramToken']!=settings[_0x446866(0x2a0)]||_0x24c39c['telegramUsername']!=settings[_0x446866(0x288)],_0x5f0e50=_0x24c39c['telegramToken']==''||_0x24c39c['telegramUsername']=='';_0x31d7bf&&(_0x24c39c[_0x446866(0x250)]=null,_0x24c39c[_0x446866(0x1e5)]=_0x446866(0x32e));for(const [_0x4ee21c,_0x8c25d]of Object[_0x446866(0x279)](_0x24c39c)){if(_0x4ee21c=='telegramToken'&&_0x8c25d==_0x446866(0x26c)){_0x24c39c['telegramToken']=settings[_0x446866(0x2a0)];continue;};if(_0x4ee21c==_0x446866(0x236)&&_0x8c25d==_0x446866(0x26c)){_0x24c39c[_0x446866(0x236)]=settings[_0x446866(0x236)];continue;};dbSettings['set'](_0x446866(0x223)+_0x4ee21c,_0x8c25d)['write']();}settings=_0x24c39c,io['to'](_0x446866(0x3c8))[_0x446866(0x218)](_0x446866(0x3bd),cleanSettings()),broadcastToBots('timeshift',settings[_0x446866(0x33a)]),broadcastToBots(_0x446866(0x3d7),settings['onepagemode']);if(_0x31d7bf&&!_0x5f0e50)initTelegram();if(_0x31d7bf&&_0x5f0e50)disableTelegram();getAllClients()[_0x446866(0x2db)](_0x11bcf8=>{const _0x27fcad=_0x446866;getSocket(_0x11bcf8['id'])[_0x27fcad(0x218)](_0x27fcad(0x3ce),{'access':{'allow':![],'reason':_0x27fcad(0x215),'token':null}});});}function updateSetting(_0x3f44a0,_0x767bbb){const _0x1269b5=_0x1cc599;dbSettings[_0x1269b5(0x3cf)]('settings.'+_0x3f44a0,_0x767bbb)['write'](),settings=getSettings(),io['to']('botmanager')[_0x1269b5(0x218)]('settings',cleanSettings());}function storeSecure(_0x47fcf1){const _0x3fea05=_0x1cc599;dbSecure[_0x3fea05(0x2a8)](_0x3fea05(0x278))[_0x3fea05(0x24d)](_0x47fcf1)['write'](),secure=_0x47fcf1;}function addBlacklist(_0x512d20){const _0x3cd35f=_0x1cc599;cleanBlacklist();let _0x5b15e3;devices[_0x512d20]['telegramIpApproval']?_0x5b15e3=Math['max'](devices[_0x512d20]['telegramIpApproval'][_0x3cd35f(0x249)],loginExpiry):_0x5b15e3=loginExpiry,dbSecure[_0x3cd35f(0x2a8)](_0x3cd35f(0x252))['push']({'expiry':new Date()['getTime']()+_0x5b15e3*0x3c*0x3e8,'token':devices[_0x512d20][_0x3cd35f(0x370)][_0x3cd35f(0x2ad)]})[_0x3cd35f(0x3d8)](),blacklist=dbSecure[_0x3cd35f(0x2a8)](_0x3cd35f(0x252))['value']();}function cleanBlacklist(){const _0x5133da=_0x1cc599;let _0x531f6d=dbSecure['get'](_0x5133da(0x252))['cloneDeep']()[_0x5133da(0x35e)](),_0x286fc0=new Date()['getTime']();_0x531f6d['forEach'](_0x32d1c0=>{const _0x4d7a9f=_0x5133da;_0x32d1c0['expiry']<_0x286fc0&&dbSecure[_0x4d7a9f(0x2a8)](_0x4d7a9f(0x252))['remove']({'expiry':_0x32d1c0[_0x4d7a9f(0x249)]})[_0x4d7a9f(0x3d8)]();});}function initStates(){const _0x5a2bc4=_0x1cc599;let _0x2a9d10=getConfiguration();_0x2a9d10[_0x5a2bc4(0x2db)](_0x1a3d34=>{const _0x2d206=_0x5a2bc4;_0x1a3d34[_0x2d206(0x2be)]=_0x2d206(0x1ef);}),storeConfiguration(_0x2a9d10);}function onKeys(){const _0x25b2eb=new RSA();return new Promise(_0x396bf6=>{const _0x3c5de9=_0x5c94;_0x25b2eb[_0x3c5de9(0x222)]()['then'](_0x2fd1d8=>{_0x396bf6(_0x2fd1d8);});});}async function generateKeys(){return await onKeys();}function _0xca26(){const _0x3ee444=['hasOwnProperty','Server','984PROyma','stringify','Enabled\x20Bot\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','internal','hashSync','privateKey','telegram','sortBy','*$1*','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','restore_yes_','handshake','temp/','function','pidRefreshToken','sendPortfolioTelegram','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','readdirSync','init','bot.js','isIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20get\x20events','getMinutes','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Telegram\x20error:','statSync','backupfile','join','apiPassword','find','bbvNew','/download/:type','Password\x20has\x20been\x20reset\x20to:\x20','button','output-003.log','Bot\x20Mgr\x20>\x20','Logged\x20out\x20user\x20...','login\x20token\x20valid','build','update-bb','min','crypto','4823460knLbaa','includes','disconnect','getUTCHours','updatebotmanager','remove','send','Temporary\x20access\x20rejected','copyFileSync','portfolio','slice','event','accept','running','storeHeadless','Bot\x20','mixpanel','Unauthorized\x20attempt\x20to\x20store\x20configuration','Stopping\x20Bot\x20Manager\x20and\x20starting\x20update\x20process','test','remoteAddress','15\x20min','action','\x20|\x20','node','clients','/:bot/configuration','(staging)','reply','<b>Balance\x20Bot\x20Status:</b>\x0a','Token\x20blacklisted','all','Invalid\x20authentication\x20token\x20(1)','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','started','storeConfiguration','temporary\x20access\x20timeout','private','config_all','output-001.log','Telegraf\x20error:','\x20(1)','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','timeshift','portfolio_','simple','Notifications\x20disabled','exp','login\x20not\x20required','bb-secure.json','bcryptjs','(((.+)+)+)+$','padStart','logged\x20out','/:bot/coins','Unauthorized\x20attempt\x20to\x20get\x20messages','https://api.ipify.org?format=json','full','config_orders','-performance.json','filter','password','Invalid\x20authentication\x20token\x20(2)','title','/:bot/portfolio','apiSecret','store-settings','show','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Ok,\x20will\x20send\x20order\x20notifications\x20only','tempaccess_reject_','order','Restore\x20backup\x20file\x20','update_no','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','manual','user','\x1b[34m','telegram2FaApproval','value','compareSync','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','createServer','login','server','\x20|\x20user:\x20...','defaults','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','use','Starting\x20new\x20bot\x20|\x20Bot\x20','production','output-002.log','existsSync','All','/output-000.log','exit','string','access','Notifications\x20disabled\x0a','Error\x20removing\x20old\x20backup\x20files:','/names\x20-\x20show\x20bot\x20names\x0a','sendFile','toggle-bot-mode','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','telegrammsg','\x1b[0m','encryptedUuid','command','timestamp','reinstall_yes','generate','randomFillSync','environment','lowdb','reinstall','static','\x20minutes','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','zip/','\x1b[31m','uuid-random','No\x20authentication\x20token','login2fa_','getFullYear','unlinkSync','Error:\x20Invalid\x20argument\x20','invalid\x20credentials','12AOcrrZ','getTime','parse','6b67f3d61ee94b8f5c80b4affef4c4d9','add-bot','yes','axios','/:bot/support','f2aRequired','keys','close','config_alerts','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','length','/update\x20-\x20update\x20Balance\x20Bot\x0a','emitHistory','clientip','replace','bot','logout','uuid','toString','2FA\x20required','verify','sort','Deleted\x20Bot\x20','/:bot/performance','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','backup-full','delete-bot','apiKey','start','sendMetricsTelegram','catch','graphql-request','Unauthorized\x20attempt\x20to\x20update\x20settings','sockets','show-config','Access\x20enabled\x20for\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','range','on_','6693ZCSiKT','30\x20min','auth','Orders','settings','files','allow','headless','Allow\x20login\x20from\x20IP\x20address\x20','number','text','No\x20bots\x20running\x20right\x20now','bbvReceive','socket.io','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','botmanager','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','new','reinstall_no','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','port','status','set','Unauthorized\x20attempt\x20to\x20download\x20','success','socket','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','update','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','onepagemode','write','bb/','version.json','from','resetHistory','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','size','path','secret','0.0.0','store-configuration','callback','argv','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','.zip','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Notifications\x20enabled\x0a','\x20>\x20',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','name','telegramEvents','tempaccess_30_','get-starting-balances','restart','error','Session\x20expired\x20for\x20user\x20...','Markdown','connected','restore_no_','post','stopped','confirm-message','Notifications\x20types:\x20','username','backup/','lastmsgtelegram','rmSync','bot-','reset-password','\x1b[35m','pidExpireLogin','address','removeAllListeners',')\x20|\x20Bot\x20','resetpw_yes','config','Unauthorized\x20attempt\x20to\x20update\x20bot','reset-history','family','store-headless','Restarting\x20Bot\x20','Error\x20while\x20deleting\x20config\x20files:\x20','latestversion','Unauthorized\x20attempt\x20to\x20get\x20portfolio','1547758YKjJcr','lowdb/adapters/FileSync','\x20to\x20','67296aYTFfM','HTML','update_yes','#RES#\x20','disable','assign','/metrics\x20-\x20show\x20bot\x20performance\x0a','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','jsonwebtoken','Restore\x20process\x20confirmed','writeFileSync','reload','child_process','RSA-OAEP','emit','temporary\x20access\x20rejected','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','SIGINT','\x1b[36m','stop','showname','Unauthorized\x20attempt\x20to\x20log\x20out','1100980sRjuVN','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','generateKeyPairAsync','settings.','/restart\x20-\x20restart\x20bot(s)\x0a','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','api-eu.mixpanel.com','get-logs','ipaddr.js','kind','botID','getMonth','3000','Starting\x20Balance\x20Bot\x20reinstallation','env','tkn','getPortfolio','-----------------------------------------------------------------------------------','split','publicKey','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','access\x20timeout','bbPassword','127.0.0.1','lastmsgemitted','Unauthorized\x20attempt\x20to\x20confirm\x20message','/off\x20-\x20stop\x20bot(s)\x0a','/help\x20-\x20show\x20available\x20commands\x0a','bbUsername','Ok,\x20will\x20send\x20alert\x20notifications\x20only',')\x20\x20\x20|\x20Bot\x20','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','alerts','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','type','/:bot','off_','versions','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','reason','Restore\x20process\x20aborted','expiry','mode','build2','-results.json','push','userid','decrypt','telegramChatId','output-000.log','blacklist','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','isDirectory','/status\x20-\x20show\x20bot(s)\x20status\x0a','NTBA_FIX_319','file','=>\x20Go\x20to\x20#CYA#http://','***','warning','disabled','1PiOPYC','connection','enable','messages','loginRequired','bots','::1','search','showConfig','endsWith','version','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','request','kill','names','-config.json','************','host','Logged\x20in\x20user\x20...','store','createWriteStream','delete-alerts','_data','<b>Telegram\x20Bot\x20Status:</b>\x0a','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','\x20only\x0a','debug','botname','secure','entries','Invalid\x20username\x20or\x20IP\x20address','enabled','randomBytes','message','[ip-address]','backup-full.zip','getHours','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','referer','reinstall-bb','get-backup-files','any','store-fiat','backup','telegramUsername','Yes','params','reject','You\x20can\x20use\x20the\x20following\x20commands:\x0a','ipc','listen','All\x20bots\x20running\x20right\x20now','getDate','format','readFileSync','whitelist','once','Backup\x20file\x20uploaded','Network\x20Interfaces:','get-messages','File\x20uploaded','Notifications\x20enabled','download','/disable\x20-\x20disable\x20notifications\x0a','inlineKeyboard','inherit','-events.json','binary','telegramToken','telegraf','18YjKYWM','logs/','SIGTERM','cancelLoading','date-fns','exec','get','bb-config.json','new-disabled','help','Starting\x20Balance\x20Bot\x20update','token','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','match','tempaccess_5_','toggleBotMode','log','Crypt','headers','getSeconds','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','chat','5715855NtYJjN','node-zip','3263909wkaccI','toIPv4MappedAddress','express-fileupload','index.html','live','telegramEnabled','backup-files','Starting\x20(','auto','whitelistEnabled','login\x20token\x20generated','259UfsNpi','startsWith','notification','initclient','Backup\x20file\x20unzipped\x20and\x20stored','temporaryAccessAllowed','config/','temporary\x20token\x20generated','sign','login\x20required','Login\x20accepted','2FA\x20login\x20required','Restoring\x20bot(s)\x20from\x20backup','editMessageReplyMarkup','mkdirSync','#RES#\x20if\x20running\x20locally\x0a','bb-settings.json','orders','$1_$2_$3','\x1b[33m','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','toIPv4Address','forEach','backup-full@','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','toggle_','staging','telegramIpApproval','http'];_0xca26=function(){return _0x3ee444;};return _0xca26();}async function oneTimeMigration(){const _0x5b30dc=_0x1cc599;let _0x129dd4=getSettings(),_0x57ed1e=![];!_0x129dd4[_0x5b30dc(0x2e2)]('lastmsgtelegram')&&(_0x129dd4['lastmsgtelegram']=0x0,_0x57ed1e=!![]);!_0x129dd4[_0x5b30dc(0x2e2)](_0x5b30dc(0x238))&&(_0x129dd4[_0x5b30dc(0x238)]=0x0,_0x57ed1e=!![]);!_0x129dd4[_0x5b30dc(0x2e2)]('latestversion')&&(_0x129dd4[_0x5b30dc(0x205)]=_0x5b30dc(0x1da),_0x57ed1e=!![]);!_0x129dd4['hasOwnProperty'](_0x5b30dc(0x3d7))&&(_0x129dd4[_0x5b30dc(0x3d7)]=![],_0x57ed1e=!![]);if(_0x57ed1e)storeSettings(_0x129dd4);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x7d7de6=>{const _0x5997a8=_0x5b30dc;if(!_0x7d7de6[_0x5997a8(0x254)]()){if(!_0x7d7de6[_0x5997a8(0x1e4)][_0x5997a8(0x2c6)]('backup-full@'))fs[_0x5997a8(0x38c)](configbackuppath+_0x7d7de6[_0x5997a8(0x1e4)]);}else fs[_0x5997a8(0x1f5)](configbackuppath+_0x7d7de6['name'],{'recursive':!![]});});}catch(_0x14759a){logger[_0x5b30dc(0x276)](_0x5b30dc(0x372),_0x14759a);}}function storeConfiguration(_0x4708c4){const _0x668666=_0x1cc599;dbConfig[_0x668666(0x2a8)]('bots')[_0x668666(0x314)]()['write'](),dbConfig[_0x668666(0x2a8)]('bots')[_0x668666(0x24d)](..._0x4708c4)[_0x668666(0x3d8)](),config=_0x4708c4;}function _0x5c94(_0x349a3b,_0x4a0ee3){const _0x552c24=_0xca26();return _0x5c94=function(_0xa34010,_0x13e1f7){_0xa34010=_0xa34010-0x1d8;let _0xca26c6=_0x552c24[_0xa34010];return _0xca26c6;},_0x5c94(_0x349a3b,_0x4a0ee3);}async function resetPassword(){const _0x1b5cfb=_0x1cc599;if(tgBot&&settings[_0x1b5cfb(0x250)]){const _0x21e83b=Markup[_0x1b5cfb(0x29c)]([Markup[_0x1b5cfb(0x306)][_0x1b5cfb(0x1dc)](_0x1b5cfb(0x394),_0x1b5cfb(0x1fd)),Markup['button'][_0x1b5cfb(0x1dc)]('no','resetpw_no')]);await sendTelegram(settings['telegramChatId'],_0x1b5cfb(0x376),_0x21e83b),tgBot[_0x1b5cfb(0x325)](/resetpw_(.+)/,async _0x15817b=>{const _0x59f85a=_0x1b5cfb,_0x2a1376=_0x15817b[_0x59f85a(0x2af)][0x1];_0x15817b['editMessageReplyMarkup']();if(_0x2a1376!='no'){const _0x41ce30=0xf,_0x26e0f4=_0x59f85a(0x3d3),_0x6169e1=Array[_0x59f85a(0x3db)](crypto[_0x59f85a(0x37f)](new Uint32Array(_0x41ce30)))['map'](_0x367b1c=>_0x26e0f4[_0x367b1c%_0x26e0f4[_0x59f85a(0x39c)]])[_0x59f85a(0x300)](''),_0x4e8c64=bcrypt[_0x59f85a(0x2e9)](_0x6169e1,saltRounds);storeSettings({'bbPassword':_0x4e8c64}),await sendTelegram(_0x15817b['chat']['id'],_0x59f85a(0x305)+_0x6169e1,{'parse_mode':'HTML'});}else await sendTelegram(_0x15817b[_0x59f85a(0x2b7)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x252136,_0x27442f){const _0x96260=_0x1cc599;io['to'](_0x96260(0x3c8))['emit'](_0x96260(0x2c7),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x96260(0x3d1));if(tgBot&&settings[_0x96260(0x250)]){const _0x4b94ce=uuidRandom();tmpStorage[_0x4b94ce]={'path':_0x252136,'filename':_0x27442f};const _0x4261c1=Markup[_0x96260(0x29c)]([Markup[_0x96260(0x306)][_0x96260(0x1dc)]('yes',_0x96260(0x2ef)+_0x4b94ce),Markup[_0x96260(0x306)][_0x96260(0x1dc)]('no',_0x96260(0x1ed)+_0x4b94ce)]);await sendTelegram(settings['telegramChatId'],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x4261c1),tgBot[_0x96260(0x325)](/restore_(.+)_(.+)/,async _0x1b03d4=>{const _0x1b275d=_0x96260,_0xa79f5b=_0x1b03d4[_0x1b275d(0x2af)][0x1],_0x2d143d=_0x1b03d4[_0x1b275d(0x2af)][0x2],{path:_0x2a4659,filename:_0x17f5b9}=tmpStorage[_0x2d143d];delete tmpStorage[_0x2d143d],_0x1b03d4[_0x1b275d(0x2d2)](),_0xa79f5b==_0x1b275d(0x394)?(logger[_0x1b275d(0x276)](_0x1b275d(0x213)),await sendTelegram(_0x1b03d4[_0x1b275d(0x2b7)]['id'],_0x1b275d(0x2d1),{'parse_mode':'HTML'}),unzipFile(_0x2a4659,_0x17f5b9)):(logger[_0x1b275d(0x276)](_0x1b275d(0x248)),await sendTelegram(_0x1b03d4[_0x1b275d(0x2b7)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x3c665e=_0x1cc599,_0x2ac3d5=new Date();return _0x2ac3d5[_0x3c665e(0x38b)]()+'/'+(_0x2ac3d5[_0x3c665e(0x22b)]()+0x1)[_0x3c665e(0x3a4)]()[_0x3c665e(0x343)](0x2,'0')+'/'+_0x2ac3d5['getDate']()['toString']()[_0x3c665e(0x343)](0x2,'0')+'\x20'+_0x2ac3d5[_0x3c665e(0x280)]()[_0x3c665e(0x3a4)]()[_0x3c665e(0x343)](0x2,'0')+':'+_0x2ac3d5[_0x3c665e(0x2fb)]()[_0x3c665e(0x3a4)]()[_0x3c665e(0x343)](0x2,'0')+':'+_0x2ac3d5[_0x3c665e(0x2b5)]()[_0x3c665e(0x3a4)]()[_0x3c665e(0x343)](0x2,'0');}function getTimeStamp(){const _0x42321b=_0x1cc599,_0x12441a=shiftedTime();return _0x12441a[_0x42321b(0x38b)]()+'/'+(_0x12441a[_0x42321b(0x22b)]()+0x1)['toString']()[_0x42321b(0x343)](0x2,'0')+'/'+_0x12441a[_0x42321b(0x290)]()[_0x42321b(0x3a4)]()['padStart'](0x2,'0')+'\x20'+_0x12441a[_0x42321b(0x280)]()[_0x42321b(0x3a4)]()[_0x42321b(0x343)](0x2,'0')+':'+_0x12441a[_0x42321b(0x2fb)]()[_0x42321b(0x3a4)]()[_0x42321b(0x343)](0x2,'0')+':'+_0x12441a[_0x42321b(0x2b5)]()[_0x42321b(0x3a4)]()[_0x42321b(0x343)](0x2,'0');}function getCleanTimeStamp(){const _0xfda9de=_0x1cc599,_0x4d2b7c=shiftedTime();return _0x4d2b7c[_0xfda9de(0x38b)]()+(_0x4d2b7c[_0xfda9de(0x22b)]()+0x1)[_0xfda9de(0x3a4)]()[_0xfda9de(0x343)](0x2,'0')+_0x4d2b7c['getDate']()[_0xfda9de(0x3a4)]()[_0xfda9de(0x343)](0x2,'0')+'-'+_0x4d2b7c[_0xfda9de(0x280)]()[_0xfda9de(0x3a4)]()[_0xfda9de(0x343)](0x2,'0')+_0x4d2b7c[_0xfda9de(0x2fb)]()[_0xfda9de(0x3a4)]()[_0xfda9de(0x343)](0x2,'0')+_0x4d2b7c['getSeconds']()[_0xfda9de(0x3a4)]()[_0xfda9de(0x343)](0x2,'0');}function shiftedTime(){const _0x4d1dcf=_0x1cc599,_0xb4d06d=new Date();let _0x3a2120=_0xb4d06d;if(settings[_0x4d1dcf(0x33a)]&&settings[_0x4d1dcf(0x33a)]!==0x0)_0x3a2120=fns['add'](_0xb4d06d,{'hours':settings['timeshift']});return _0x3a2120;}function startScheduler(){const _0x1e4e9e=_0x1cc599,_0x21af76=new Date()[_0x1e4e9e(0x312)](),_0x40805c=shiftedTime()[_0x1e4e9e(0x280)]();_0x40805c==0x4&&backupConfigFiles();_0x40805c==0x0&&rotateLogFiles();_0x21af76%0x6==0x0&&triggerAnalytics();_0x21af76%0x6==0x0&&getMessages();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}async function restoreBackupFile(_0x53a862){const _0x29a372=_0x1cc599;logger[_0x29a372(0x276)](_0x29a372(0x357)+_0x53a862);const _0x54b900=getBotsWithMode();_0x54b900[_0x29a372(0x39c)]>0x0?confirmRestore(configbackuppath,_0x53a862):unzipFile(configbackuppath,_0x53a862);}async function getBackupFiles(_0x9fde5c=null){const _0x29a72e=_0x1cc599;let _0x13f531=[],_0x408af4=fs[_0x29a72e(0x2f6)](configbackuppath,{'withFileTypes':!![]});_0x408af4[_0x29a72e(0x3a7)]((_0x5e40b5,_0x455c6e)=>_0x5e40b5['name']<_0x455c6e[_0x29a72e(0x1e4)]?0x1:_0x455c6e['name']<_0x5e40b5[_0x29a72e(0x1e4)]?-0x1:0x0),_0x408af4['forEach'](_0x492c95=>{const _0x4944fb=_0x29a72e;if(!_0x492c95['isDirectory']()&&_0x492c95[_0x4944fb(0x1e4)][_0x4944fb(0x2c6)](_0x4944fb(0x2dc))&&_0x492c95[_0x4944fb(0x1e4)][_0x4944fb(0x265)](_0x4944fb(0x1df))){const _0x1ffcdc=formatDate(fs[_0x4944fb(0x2fe)](configbackuppath+_0x492c95[_0x4944fb(0x1e4)])['mtime']);_0x13f531['push']({'name':_0x492c95[_0x4944fb(0x1e4)],'mtime':_0x1ffcdc});}});if(_0x9fde5c)io['to'](_0x9fde5c)[_0x29a72e(0x218)](_0x29a72e(0x2c0),_0x13f531);else return _0x13f531;}async function backupConfigFiles(){const _0x311b76=_0x1cc599;await zipFiles(_0x311b76(0x3ab));const _0x569620=getCleanTimeStamp();fs[_0x311b76(0x317)](zippath+_0x311b76(0x27f),configbackuppath+(_0x311b76(0x2dc)+_0x569620+_0x311b76(0x1df)));let _0x597c19=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x597c19[_0x311b76(0x3a7)]((_0x3d2151,_0x103e93)=>_0x3d2151['name']<_0x103e93[_0x311b76(0x1e4)]?0x1:_0x103e93[_0x311b76(0x1e4)]<_0x3d2151[_0x311b76(0x1e4)]?-0x1:0x0),_0x597c19[_0x311b76(0x39c)]>maxBackups&&fs[_0x311b76(0x38c)](configbackuppath+_0x597c19[_0x597c19[_0x311b76(0x39c)]-0x1][_0x311b76(0x1e4)]);}function rotateLogFiles(){const _0x166d2e=_0x1cc599,_0x15befd=fs[_0x166d2e(0x2fe)](logspath+_0x166d2e(0x251)),_0x50cb0e=_0x15befd[_0x166d2e(0x3de)]/0x400;if(_0x50cb0e>0x64){let _0x2376a8=fs[_0x166d2e(0x2f6)](logspath,{'withFileTypes':!![]});_0x2376a8[_0x166d2e(0x3a7)]((_0x1b1c83,_0x422a7f)=>_0x1b1c83['name']<_0x422a7f[_0x166d2e(0x1e4)]?0x1:_0x422a7f[_0x166d2e(0x1e4)]<_0x1b1c83[_0x166d2e(0x1e4)]?-0x1:0x0),_0x2376a8['forEach'](_0x23dfd6=>{const _0x1d2743=_0x166d2e;if(_0x23dfd6[_0x1d2743(0x1e4)]==_0x1d2743(0x36a))fs[_0x1d2743(0x317)](logspath+_0x23dfd6['name'],logspath+_0x1d2743(0x307));if(_0x23dfd6[_0x1d2743(0x1e4)]==_0x1d2743(0x336))fs[_0x1d2743(0x317)](logspath+_0x23dfd6[_0x1d2743(0x1e4)],logspath+_0x1d2743(0x36a));_0x23dfd6['name']=='output-000.log'&&(fs[_0x1d2743(0x317)](logspath+_0x23dfd6[_0x1d2743(0x1e4)],logspath+_0x1d2743(0x336)),fs[_0x1d2743(0x214)](logspath+_0x23dfd6[_0x1d2743(0x1e4)],''));});}}async function zipFiles(_0x1f0d18){const _0x98361d=_0x1cc599;let _0x39b6fa;if(_0x1f0d18=='logs')_0x39b6fa=logspath;if(_0x1f0d18==_0x98361d(0x287))_0x39b6fa=configpath;if(_0x1f0d18=='backup-full')_0x39b6fa=configpath;let _0x25dd38=fs['readdirSync'](_0x39b6fa,{'withFileTypes':!![]});const _0x27f945=new require(_0x98361d(0x2b9))();_0x25dd38[_0x98361d(0x2db)](_0x4d7260=>{const _0x484606=_0x98361d;if(!_0x4d7260[_0x484606(0x254)]()){let _0x4648ca=fs['readFileSync'](_0x39b6fa+_0x4d7260['name']);if(_0x1f0d18==_0x484606(0x287)){const _0x16795d=/^bot-[0-9]{3}-config.json$/,_0x28f3f6=_0x16795d[_0x484606(0x322)](_0x4d7260['name']);if(_0x28f3f6){const _0x447449=JSON[_0x484606(0x391)](_0x4648ca);if(_0x447449['bot'][0x0]){_0x447449[_0x484606(0x3a1)][0x0][_0x484606(0x3ad)]=_0x484606(0x259),_0x447449['bot'][0x0][_0x484606(0x350)]=_0x484606(0x259);if(_0x447449['bot'][0x0]['apiPassword'])_0x447449[_0x484606(0x3a1)][0x0][_0x484606(0x301)]=_0x484606(0x259);}_0x4648ca=JSON[_0x484606(0x2e5)](_0x447449,null,0x2);}if(_0x4d7260[_0x484606(0x1e4)]==_0x484606(0x2d5)){const _0x2e0ad1=JSON[_0x484606(0x391)](_0x4648ca);if(_0x2e0ad1[_0x484606(0x3bd)]['loginRequired'])_0x2e0ad1['settings'][_0x484606(0x260)]=![];if(_0x2e0ad1[_0x484606(0x3bd)][_0x484606(0x236)])_0x2e0ad1[_0x484606(0x3bd)][_0x484606(0x236)]=_0x484606(0x259);if(_0x2e0ad1[_0x484606(0x3bd)][_0x484606(0x2a0)])_0x2e0ad1['settings'][_0x484606(0x2a0)]='***';if(_0x2e0ad1['settings']['telegramChatId'])_0x2e0ad1[_0x484606(0x3bd)]['telegramChatId']=null;_0x4648ca=JSON[_0x484606(0x2e5)](_0x2e0ad1,null,0x2);}if(_0x4d7260[_0x484606(0x1e4)]!=_0x484606(0x340))_0x27f945[_0x484606(0x257)](_0x4d7260[_0x484606(0x1e4)],_0x4648ca);}else _0x27f945[_0x484606(0x257)](_0x4d7260[_0x484606(0x1e4)],_0x4648ca);}});const _0x3e67b4=_0x27f945[_0x98361d(0x37e)]({'base64':![],'compression':'DEFLATE'});fs['writeFileSync'](zippath+(_0x1f0d18+_0x98361d(0x1df)),_0x3e67b4,_0x98361d(0x29f));}async function unzipFile(_0x1d011c,_0x14501d){const _0x33123a=_0x1cc599;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x33123a(0x2db)](_0x4b0276=>{const _0x1612d4=_0x33123a;if(!_0x4b0276[_0x1612d4(0x254)]())fs[_0x1612d4(0x1f5)](configpath+_0x4b0276[_0x1612d4(0x1e4)]);});const _0x5d4511=fs['readFileSync'](_0x1d011c+_0x14501d,_0x33123a(0x29f)),_0x317a89=new require('node-zip')(_0x5d4511,{'base64':![],'checkCRC32':!![]});Object[_0x33123a(0x398)](_0x317a89[_0x33123a(0x3be)])['forEach'](_0x3fe5ec=>{const _0xbdee46=_0x33123a,_0x3ff0f1=_0x317a89[_0xbdee46(0x3be)][_0x3fe5ec];fs['writeFileSync'](configpath+_0x3ff0f1[_0xbdee46(0x1e4)],_0x3ff0f1[_0xbdee46(0x272)]);}),fs[_0x33123a(0x2f6)](temppath,{'withFileTypes':!![]})['forEach'](_0x58c022=>{const _0x289298=_0x33123a;if(!_0x58c022[_0x289298(0x254)]())fs[_0x289298(0x1f5)](temppath+_0x58c022['name']);}),logger[_0x33123a(0x276)](_0x33123a(0x2c9)),process[_0x33123a(0x315)]({'restore':!![]},_0x582ca8=>{});}async function getPublicIp(){const _0x3a3d25=_0x1cc599;try{const _0x313de0=await axios[_0x3a3d25(0x2a8)](_0x3a3d25(0x347));publicip=_0x313de0['data']['ip'];}catch(_0x17eaa8){}}async function triggerAnalytics(){const _0x26c3c3=_0x1cc599;if(!publicip)await getPublicIp();const _0x56a2a7=getBotsWithMode();let _0x1999cf=0x0;_0x56a2a7[_0x26c3c3(0x2db)](_0x333a8e=>{const _0x1d212b=_0x26c3c3;if(_0x333a8e[_0x1d212b(0x3ce)]===_0x1d212b(0x27b))_0x1999cf++;});const _0x142e99=getBotExchanges();mixpanel['track'](_0x26c3c3(0x2e3),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x56a2a7[_0x26c3c3(0x39c)],'numbotsenabled':_0x1999cf,'exchanges':_0x142e99,'environment':environment});}async function getMessages(){const _0x2dc593=_0x1cc599,_0x197c7b=_0x2dc593(0x3dd),_0x5c65d3=new GraphQLClient(_0x197c7b),_0x33e2dd={'authorization':_0x2dc593(0x2f5)},_0x370651=serverversion[_0x2dc593(0x232)]('.'),_0x286159=_0x370651[0x0]+'.'+_0x370651[0x1],_0x4ccec6=Math[_0x2dc593(0x30d)](settings[_0x2dc593(0x1f4)],settings['lastmsgemitted']),_0x58527b={'last':parseInt(_0x4ccec6),'bbm':_0x286159},_0x2af121=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0xb65ca1;try{_0xb65ca1=await _0x5c65d3[_0x2dc593(0x268)](_0x2af121,_0x58527b,_0x33e2dd);}catch(_0xc921f3){}if(_0xb65ca1&&_0xb65ca1[_0x2dc593(0x25f)]){let _0xe22ca4=settings[_0x2dc593(0x1f4)];newMessages=[];for(const _0x51d9bd of _0xb65ca1['messages']){newMessages[_0x2dc593(0x24d)](_0x51d9bd);let _0x1be56f=![];_0x51d9bd['bbvNew']&&(updateSetting('latestversion',_0x51d9bd['bbvNew']),_0x1be56f=isNewerVersion(serverversion,_0x51d9bd['bbvNew'])||serverversion==_0x51d9bd[_0x2dc593(0x303)]);if(!_0x1be56f&&_0x51d9bd[_0x2dc593(0x3c2)]>_0xe22ca4){if(_0x51d9bd['bbvReceive']===_0x2dc593(0x285)||serverversion[_0x2dc593(0x2c6)](_0x51d9bd[_0x2dc593(0x3c5)])){let _0x3a542f=''+_0x51d9bd[_0x2dc593(0x34e)]+'\x0a\x0a'+_0x51d9bd[_0x2dc593(0x27d)];const _0x295287=await sendTelegramMsg(toTelegramMarkdown(_0x3a542f),_0x2dc593(0x1eb));if(_0x295287)_0xe22ca4=_0x51d9bd['number'];}}}updateAvailable=isNewerVersion(settings[_0x2dc593(0x205)],serverversion),updateSetting(_0x2dc593(0x1f4),_0xe22ca4),emitMessages();}}function emitMessages(){const _0x5ccf67=_0x1cc599,_0x3f3437=settings[_0x5ccf67(0x238)];let _0x3330ba=[];newMessages[_0x5ccf67(0x2db)](_0x4e8d1=>{const _0x3678e6=_0x5ccf67;_0x4e8d1['number']>_0x3f3437&&_0x3330ba[_0x3678e6(0x24d)](_0x4e8d1);}),_0x3330ba[_0x5ccf67(0x39c)]>0x0&&getAllClients()[_0x5ccf67(0x2db)](_0x499065=>{const _0xf60e3c=_0x5ccf67;getSocket(_0x499065['id'])[_0xf60e3c(0x218)](_0xf60e3c(0x27d),_0x3330ba);});}function confirmMessage(_0x5397a1){const _0x185324=_0x1cc599;updateSetting(_0x185324(0x238),Number(_0x5397a1));}function isNewerVersion(_0x539713,_0x5c0483){const _0x1a9d1d=_0x1cc599,_0x2ab865=_0x5c0483[_0x1a9d1d(0x232)]('.'),_0x2ac97b=_0x539713[_0x1a9d1d(0x232)]('.');for(var _0x34202d=0x0;_0x34202d<_0x2ac97b[_0x1a9d1d(0x39c)];_0x34202d++){const _0x9fd3d3=~~_0x2ac97b[_0x34202d],_0x11f0d9=~~_0x2ab865[_0x34202d];if(_0x9fd3d3>_0x11f0d9)return!![];if(_0x9fd3d3<_0x11f0d9)return![];}return![];}function toTelegramMarkdown(_0x5f069e){const _0x2ee3d9=_0x1cc599,_0x3f4d24=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x311ba9=/\*{2}(.+?)\*{2}/gim;return _0x5f069e=_0x5f069e[_0x2ee3d9(0x3a0)](_0x3f4d24,_0x2ee3d9(0x2d7))[_0x2ee3d9(0x3a0)](_0x311ba9,_0x2ee3d9(0x2ed)),_0x5f069e;}async function validateConfigFile(){const _0x36e65f=_0x1cc599,_0xa64364=dbConfig[_0x36e65f(0x2a8)](_0x36e65f(0x261))['sortBy'](_0x36e65f(0x22a))[_0x36e65f(0x35e)]()||[];if(_0xa64364[_0x36e65f(0x39c)]==0x0){let _0x29959d=0x0,_0x5e4696=[];const _0x50cdb9=/^bot-([0-9]{3})-config.json$/,_0x39a22d=fs[_0x36e65f(0x2f6)](configpath);_0x39a22d[_0x36e65f(0x2db)](_0x11aedb=>{const _0x3f64b8=_0x36e65f,_0x3406cb=_0x50cdb9[_0x3f64b8(0x2a7)](_0x11aedb);if(_0x3406cb){const _0x2611ff=_0x3406cb[0x1];let _0x22cd56=getBotAttributes(_0x2611ff);_0x5e4696[_0x3f64b8(0x24d)]({'botID':_0x2611ff,'botname':_0x22cd56[_0x3f64b8(0x277)],'status':'disabled','live':_0x3f64b8(0x1ef)}),_0x29959d++;}}),_0x29959d!=0x0&&(dbConfig[_0x36e65f(0x2a8)]('bots')[_0x36e65f(0x20f)](_0x5e4696)[_0x36e65f(0x3d8)](),config=_0x5e4696,restoredConfigFile=_0x29959d);}}async function restoreConfigNotify(_0x428acd){const _0x259c2b=_0x1cc599;let _0x1f8a3c;if(restoredConfigFile==0x1)_0x1f8a3c='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x1f8a3c=_0x259c2b(0x2ae);if(_0x428acd)io['to'](_0x259c2b(0x3c8))['emit']('notification',_0x1f8a3c);else{logger[_0x259c2b(0x33c)](_0x259c2b(0x231)),logger['simple'](_0x1f8a3c),logger[_0x259c2b(0x33c)](_0x259c2b(0x231)),logger['simple']('');if(tgBot&&settings[_0x259c2b(0x250)]&&settings[_0x259c2b(0x1e5)]!='orders')await sendTelegram(settings[_0x259c2b(0x250)],_0x259c2b(0x308)+_0x1f8a3c);}}function validateCredentials(_0x221670,_0x33bac7){const _0x4c0b7c=_0x1cc599;if(_0x221670[_0x4c0b7c(0x1f2)]==settings['bbUsername']&&bcrypt[_0x4c0b7c(0x35f)](_0x221670['password'],settings[_0x4c0b7c(0x236)])){if(settings[_0x4c0b7c(0x397)])return{'allow':![],'reason':_0x4c0b7c(0x2d0),'token':null};else{const _0x3ac13b=generateLoginToken(_0x33bac7);return{'allow':!![],'reason':_0x4c0b7c(0x2c4),'token':_0x3ac13b};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x943d0e){const _0x29a5e3=generateLoginToken(_0x943d0e);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x29a5e3};}function validateAccess(_0x3c9e07,_0x180bf3,_0x4c8ab3){const _0x257dcb=_0x1cc599,_0x342e21=_0x4c8ab3?_0x4c8ab3:devices[_0x180bf3]['ip'];let _0x46e988;const _0x2bb58d=_0x5b77ae=>{const _0x113ee9=_0x5c94;if(settings[_0x113ee9(0x260)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x180bf3)){const _0x141b43=generateLoginToken(_0x180bf3);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x141b43};}else return{'allow':![],'reason':_0x113ee9(0x2ce),'token':null};}else return _0x46e988=validToken(_0x5b77ae,_0x180bf3),_0x46e988[_0x113ee9(0x2e2)](_0x113ee9(0x3d1))?{'allow':!![],'reason':_0x113ee9(0x30a),'token':_0x5b77ae}:{'allow':![],'reason':_0x113ee9(0x2ce),'token':null};}else return{'allow':!![],'reason':_0x113ee9(0x33f),'token':null};};if(settings[_0x257dcb(0x2c3)]){let _0x317e2f=[...settings[_0x257dcb(0x293)],_0x257dcb(0x262),'::ffff:127.0.0.1',_0x257dcb(0x237)];if(_0x317e2f[_0x257dcb(0x310)](_0x342e21))return _0x2bb58d(_0x3c9e07);else{_0x46e988=validToken(_0x3c9e07,_0x180bf3);if(_0x46e988['hasOwnProperty'](_0x257dcb(0x3d1)))return _0x2bb58d(_0x3c9e07);else{if(telegramIpApproved(_0x180bf3)){const _0x32e333=generateToken(_0x180bf3);return _0x46e988=_0x2bb58d(_0x3c9e07),_0x46e988[_0x257dcb(0x3bf)]?{'allow':!![],'reason':_0x257dcb(0x2cc),'token':_0x32e333}:_0x46e988;}else return settings[_0x257dcb(0x2ca)]?{'allow':![],'reason':_0x257dcb(0x3a5),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x2bb58d(_0x3c9e07);}function timelyDecrypt(_0x520b45,_0x525fb4=!![]){const _0x558502=_0x1cc599;if(_0x520b45)try{const _0x23fb03=crypt[_0x558502(0x24f)](secure['privateKey'],_0x520b45)['message'],_0x1c7889=_0x23fb03['split']('@')[0x0],_0x579e9a=_0x23fb03[_0x558502(0x232)]('@')[0x1],_0x29ad91=new Date()[_0x558502(0x390)]();if(_0x525fb4){if(_0x29ad91-_0x579e9a<maxSecretAge*0x3e8)return _0x1c7889;else return![];}else return _0x1c7889;}catch(_0x1c99e6){return![];}else return![];}const validToken=(_0x134c43,_0x387f45)=>{const _0x4dc1e1=_0x1cc599,_0x279ee6=devices[_0x387f45]['ip'];if(!_0x134c43)return{'error':_0x4dc1e1(0x389)};for(let _0x57cbb2 of blacklist){if(_0x57cbb2[_0x4dc1e1(0x2ad)]==_0x134c43)return{'error':_0x4dc1e1(0x32d)};}let _0x5e8e53;try{_0x5e8e53=jwt[_0x4dc1e1(0x3a6)](_0x134c43,secure[_0x4dc1e1(0x1d9)]+_0x387f45);}catch{return{'error':_0x4dc1e1(0x32f)};}if(!_0x5e8e53[_0x4dc1e1(0x2e2)]('clientip')&&!_0x5e8e53['hasOwnProperty'](_0x4dc1e1(0x1f2))||!_0x5e8e53[_0x4dc1e1(0x2e2)](_0x4dc1e1(0x33e)))return{'error':_0x4dc1e1(0x34d)};if(!_0x5e8e53['hasOwnProperty']('username')&&_0x5e8e53[_0x4dc1e1(0x2e2)](_0x4dc1e1(0x39f))){const {clientip:_0x112a06}=_0x5e8e53;return _0x279ee6==_0x112a06?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x5e8e53[_0x4dc1e1(0x2e2)]('username')&&_0x5e8e53[_0x4dc1e1(0x2e2)](_0x4dc1e1(0x39f))){const {username:_0x3b39a4,clientip:_0x3ba7b3}=_0x5e8e53;return settings[_0x4dc1e1(0x23c)]==_0x3b39a4&&_0x279ee6==_0x3ba7b3?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x4dc1e1(0x27a)};}}},generateLoginToken=_0x50666c=>{const _0x45ebeb=_0x1cc599;if(_0x50666c){const _0x359f60=devices[_0x50666c]['ip'];return jwt[_0x45ebeb(0x2cd)]({'username':settings[_0x45ebeb(0x23c)],'clientip':_0x359f60},secure[_0x45ebeb(0x1d9)]+_0x50666c,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x1e298b=>{const _0x43b870=_0x1cc599;if(_0x1e298b){const _0x356355=devices[_0x1e298b]['ip'];return jwt['sign']({'clientip':_0x356355},secure[_0x43b870(0x1d9)]+_0x1e298b,{'expiresIn':devices[_0x1e298b][_0x43b870(0x2e0)][_0x43b870(0x249)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x516df0=>{const _0x3870ae=_0x1cc599;let _0x1193b8=![];return devices[_0x516df0]['telegramIpApproval']&&devices[_0x516df0]['telegramIpApproval'][_0x3870ae(0x249)]!=_0x3870ae(0x28b)&&(_0x1193b8=devices[_0x516df0][_0x3870ae(0x2e0)][_0x3870ae(0x39f)]==devices[_0x516df0]['ip']&&new Date()['getTime']()-devices[_0x516df0]['telegramIpApproval'][_0x3870ae(0x37c)]<devices[_0x516df0][_0x3870ae(0x2e0)][_0x3870ae(0x249)]*0x3c*0x3e8),_0x1193b8;},telegram2FaApproved=_0x3d6f79=>{const _0x54a8e9=_0x1cc599;let _0xcc3f13=![];return devices[_0x3d6f79][_0x54a8e9(0x35d)]&&devices[_0x3d6f79][_0x54a8e9(0x35d)][_0x54a8e9(0x249)]!=_0x54a8e9(0x28b)&&(_0xcc3f13=devices[_0x3d6f79][_0x54a8e9(0x35d)][_0x54a8e9(0x39f)]==devices[_0x3d6f79]['ip']&&new Date()[_0x54a8e9(0x390)]()-devices[_0x3d6f79]['telegram2FaApproval']['timestamp']<devices[_0x3d6f79][_0x54a8e9(0x35d)][_0x54a8e9(0x249)]*0x3c*0x3e8),_0xcc3f13;},normalizeIP=_0x5c129b=>{const _0x2bd24f=_0x1cc599;let _0x439b6f=null,_0x4279a3=null;if(ipaddr['isValid'](_0x5c129b)){const _0x2d0f64=ipaddr[_0x2bd24f(0x391)](_0x5c129b);_0x2d0f64[_0x2bd24f(0x229)]()==='ipv6'?(_0x2d0f64[_0x2bd24f(0x2f9)]()&&(_0x439b6f=_0x2d0f64[_0x2bd24f(0x2da)]()[_0x2bd24f(0x3a4)]()),_0x4279a3=_0x2d0f64[_0x2bd24f(0x3a4)]()):(_0x439b6f=_0x2d0f64[_0x2bd24f(0x3a4)](),_0x4279a3=_0x2d0f64[_0x2bd24f(0x2bb)]()[_0x2bd24f(0x3a4)]());}return{'show':_0x439b6f?_0x439b6f:_0x4279a3,'store':_0x4279a3};};function formatDate(_0x1eb9c8){const _0x4729f7=_0x1cc599;return _0x1eb9c8[_0x4729f7(0x38b)]()+'/'+(_0x1eb9c8[_0x4729f7(0x22b)]()+0x1)[_0x4729f7(0x3a4)]()[_0x4729f7(0x343)](0x2,'0')+'/'+_0x1eb9c8['getDate']()[_0x4729f7(0x3a4)]()[_0x4729f7(0x343)](0x2,'0')+'\x20'+_0x1eb9c8[_0x4729f7(0x280)]()[_0x4729f7(0x3a4)]()['padStart'](0x2,'0')+':'+_0x1eb9c8[_0x4729f7(0x2fb)]()[_0x4729f7(0x3a4)]()[_0x4729f7(0x343)](0x2,'0')+':'+_0x1eb9c8['getSeconds']()[_0x4729f7(0x3a4)]()['padStart'](0x2,'0');}function sleep(_0x3ef743){return new Promise(_0x11cd82=>setTimeout(_0x11cd82,_0x3ef743));}