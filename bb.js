const _0x223efe=_0x4d0a;(function(_0x3e3505,_0x34e0cc){const _0x394c1c=_0x4d0a,_0x195dae=_0x3e3505();while(!![]){try{const _0x300769=parseInt(_0x394c1c(0x1ad))/0x1+-parseInt(_0x394c1c(0x1ec))/0x2+-parseInt(_0x394c1c(0x1b5))/0x3+parseInt(_0x394c1c(0x23d))/0x4*(-parseInt(_0x394c1c(0x26f))/0x5)+-parseInt(_0x394c1c(0x28c))/0x6*(parseInt(_0x394c1c(0x188))/0x7)+-parseInt(_0x394c1c(0x269))/0x8*(-parseInt(_0x394c1c(0x208))/0x9)+parseInt(_0x394c1c(0x245))/0xa;if(_0x300769===_0x34e0cc)break;else _0x195dae['push'](_0x195dae['shift']());}catch(_0x367aaf){_0x195dae['push'](_0x195dae['shift']());}}}(_0x4d07,0xe2ebd));const _0x53b130=function(){let _0x366dae=!![];return function(_0x40166e,_0x14fc9c){const _0xe2fa9a=_0x366dae?function(){const _0x8595e2=_0x4d0a;if(_0x14fc9c){const _0x38ec7d=_0x14fc9c[_0x8595e2(0x226)](_0x40166e,arguments);return _0x14fc9c=null,_0x38ec7d;}}:function(){};return _0x366dae=![],_0xe2fa9a;};}(),_0x435925=_0x53b130(this,function(){const _0x4c0113=_0x4d0a;return _0x435925[_0x4c0113(0x1b3)]()[_0x4c0113(0x215)]('(((.+)+)+)+$')[_0x4c0113(0x1b3)]()[_0x4c0113(0x1e9)](_0x435925)[_0x4c0113(0x215)](_0x4c0113(0x1a8));});_0x435925();'use strict';process[_0x223efe(0x16e)][_0x223efe(0x1c3)]=0x1;const childProcess=require(_0x223efe(0x202)),FileSync=require(_0x223efe(0x1e7)),fs=require('fs'),fns=require(_0x223efe(0x1f5)),low=require('lowdb'),path=require(_0x223efe(0x19d)),crypto=require(_0x223efe(0x1d3)),Crypt=require(_0x223efe(0x1d4))[_0x223efe(0x27b)],RSA=require(_0x223efe(0x1d4))[_0x223efe(0x1b0)],bcrypt=require(_0x223efe(0x197)),jwt=require(_0x223efe(0x1c6)),analyticsLib=require('analytics')['default'],googleAnalytics=require(_0x223efe(0x289))[_0x223efe(0x22d)],ipaddr=require(_0x223efe(0x26d));let bbpath=_0x223efe(0x297);const botfile=_0x223efe(0x173),configfile=_0x223efe(0x234),settingsfile=_0x223efe(0x21f),securefile='bb-secure.json';!fs[_0x223efe(0x1c5)](bbpath+botfile)&&(bbpath='');const configpath=bbpath+'config/';!fs[_0x223efe(0x1c5)](configpath)&&fs['mkdirSync'](configpath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x223efe(0x20c)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x223efe(0x20c)]({'settings':{'timeshift':0x0}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x223efe(0x20c)]({'secure':{},'blacklist':[]})[_0x223efe(0x1cd)]();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x223efe(0x261)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[],socket=[],serverStatus=[];const serverversion=require('./'+bbpath+_0x223efe(0x1a4))[_0x223efe(0x299)],maxSecretAge=0xa,loginExpiry=0x3c,tokenRefresh=0x5;function _0x4d07(){const _0xd845e9=['bbUsername','initclient','yes','::1','filter','search','Password\x20reset\x20rejected','toIPv4Address','removeListener','/enable\x20-\x20enable\x20notifications\x0a','connection','kind','entries','expiry','store-configuration','bb-settings.json','whitelistEnabled','-results.json','show','telegramToken','inherit','\x20>\x20','apply','getStartingBalances','blacklist','then','/:bot/portfolio','remoteAddress','-events.json','default','telegramEnabled','static','split','socket.io','placeOrder','login\x20not\x20required','bb-config.json','getHours','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','createServer','Invalid\x20authentication\x20token\x20(1)','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','secret','Unauthorized\x20attempt\x20to\x20update\x20bot','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','6942792rwJsPk','isValid','username','assign','answerCallbackQuery','SIGINT','No\x20bots\x20enabled\x20right\x20now','removeAllListeners','53677760rPZhrn','All','length','build','privateKey','SIGTERM','headers','running','************','unlinkSync','generateKeyPairAsync','/:bot/support','/help\x20-\x20show\x20avaiable\x20commands\x0a','Invalid\x20Telegram\x20token','logout','getMinutes','login','error\x20while\x20deleting\x20log\x20files:\x20','Login\x20rejected','includes','2FA\x20login\x20required','Orders','ipc','apiKey','storeConfiguration','auth','/:bot/performance','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','RSA-OAEP','-config.json','\x20|\x20','Notifications\x20enabled\x0a','getFullYear','join','find','disconnect','1768vAxtWV','send','Ok,\x20will\x20send\x20order\x20notifications\x20only','emit','ipaddr.js','getDate','5cXHujA','\x20minutes','all','chat','<b>Balance\x20Bot\x20status:</b>\x0a','connected','settings.','bot-','add-bot','telegramUsername','new-disabled',':\x20Bot\x20Mgr\x20>\x20','Crypt','token','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','No\x20authentication\x20token','value','</b>\x20?','push','stop','Invalid\x20authentication\x20token\x20(2)','404\x20Not\x20Found','Token\x20blacklisted','new','started','emitHistory','@analytics/google-analytics','f2aRequired','whitelist','821850WmTWNb','verify','Bot\x20Mgr\x20>\x20','hex','bbPassword','User\x20has\x20been\x20validated','publicKey','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','2FA','getTime','referer','bb/','Balance\x20Bot','version','env','enabled','Unauthorized\x20attempt\x20to\x20get\x20logs','storeHeadless','accept','bot.js','sendFile','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','store-headless','15\x20min','http','Unauthorized\x20attempt\x20to\x20log\x20out','stopped','reload','match','botname','clientip','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','data','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','alerts','-performance.json','success','allow','fork','UA-192771731-1','63JxnbXz','HTML','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','add','Unauthorized\x20attempt\x20to\x20get\x20portfolio','sendMessage','Access\x20enabled\x20for\x20','callback_query','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','kill','getSeconds','restart','Bot\x20','secure','2FA\x20login\x20token\x20generated','bcryptjs','Ok,\x20will\x20send\x20alert\x20notifications\x20only','2FA\x20required','status','index.html','Unauthorized\x20attempt\x20to\x20delete\x20bot','path','stopPolling','/status\x20-\x20show\x20the\x20status\x20of\x20your\x20bots\x0a','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','sortBy','timestamp','login\x20required','version.json','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','get-portfolio','settings','(((.+)+)+)+$','max','login\x20token\x20generated','use','deleted\x20Bot\x20','279313hTLHCp','5\x20min','disabled','RSA','reject','restarting\x20Bot\x20','toString','bots','5119695LZtuRN','127.0.0.1','telegram','store-settings','30\x20min','live','hasOwnProperty','handshake','keys','randomFillSync','loginRequired','telegramChatId','botmanager','message','NTBA_FIX_319','logged\x20out','existsSync','jsonwebtoken','function','enabled\x20Bot\x20','Password\x20has\x20been\x20reset\x20to:\x20','botID','store','forEach','write','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','/:bot/coins','from','reset-password','crypto','hybrid-crypto-js','error','/restart\x20-\x20restart\x20a\x20bot\x0a','build2','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','/:bot','exp','get-starting-balances','onText','Notifications\x20types:\x20','decrypt','place-order','login\x20token\x20valid','args','padStart','listen','get-logs','disabled\x20Bot\x20','get','lowdb/adapters/FileSync','temporaryAccessAllowed','constructor','Unauthorized\x20attempt\x20logging\x20in\x20(timeout)','orders','729600exWnbB','once','sign','getMonth','/:bot/history','1000','getUTCHours','isIPv4MappedAddress','hashSync','date-fns','polling_error','Alerts','exit','conn','delete-bot','starting\x20bot\x20|\x20Bot\x20','type','timeshift','idling\x20bot\x20\x20\x20|\x20Bot\x20','toIPv4MappedAddress','catch','reason','child_process','\x20only\x0a','-----------------------------------------------------------------------------------','Allow\x20login\x20from\x20IP\x20address\x20<b>','telegramEvents','https://hodlerhacks.com','13122StpQOy','encryptedUuid','\x20/\x20','Notifications\x20disabled\x0a','defaults','log','invalid\x20credentials','page'];_0x4d07=function(){return _0xd845e9;};return _0x4d07();}let lastIpApproval,telegramIpApproval,telegram2FaApproval,accessControl,token,uuid,externalip,pidExpireLogin,pidRefreshToken,pidAnalytics;oneTimeMigration(),cleanBlacklist();const PORT=0xbb8,express=require('express'),app=express(),http=require(_0x223efe(0x178))[_0x223efe(0x237)](app);app[_0x223efe(0x1ab)](express['static'](path[_0x223efe(0x266)](__dirname,bbpath,_0x223efe(0x1d7)))),app['use'](express[_0x223efe(0x22f)](path[_0x223efe(0x266)](__dirname,bbpath,'build'))),app[_0x223efe(0x1e6)]('/',function(_0x2aa4dd,_0x19f570){const _0x2473ff=_0x223efe;_0x19f570[_0x2473ff(0x174)](path[_0x2473ff(0x266)](__dirname,bbpath,_0x2473ff(0x1d7),_0x2473ff(0x19b)));}),app['get'](_0x223efe(0x1d9),function(_0x461d54,_0x2aa43d){const _0x406029=_0x223efe;_0x2aa43d[_0x406029(0x174)](path[_0x406029(0x266)](__dirname,bbpath,_0x406029(0x248),_0x406029(0x19b)));}),app[_0x223efe(0x1e6)](_0x223efe(0x22a),(_0x356a1a,_0x1c0411)=>{const _0x25a270=_0x223efe;_0x1c0411['sendFile'](path[_0x25a270(0x266)](__dirname,bbpath,'build',_0x25a270(0x19b)));}),app['get'](_0x223efe(0x25f),(_0x1ba158,_0x26d51b)=>{const _0x32d740=_0x223efe;_0x26d51b[_0x32d740(0x174)](path[_0x32d740(0x266)](__dirname,bbpath,_0x32d740(0x248),'index.html'));}),app[_0x223efe(0x1e6)](_0x223efe(0x1d0),(_0x48db3e,_0x19108c)=>{const _0x418e56=_0x223efe;_0x19108c[_0x418e56(0x174)](path[_0x418e56(0x266)](__dirname,bbpath,_0x418e56(0x248),_0x418e56(0x19b)));}),app['get'](_0x223efe(0x1f0),(_0x14363e,_0x38b06b)=>{const _0x16f0d4=_0x223efe;_0x38b06b[_0x16f0d4(0x174)](path[_0x16f0d4(0x266)](__dirname,bbpath,'build','index.html'));}),app['get']('/:bot/configuration',(_0x47d22e,_0x108a41)=>{const _0x3103e3=_0x223efe;_0x108a41[_0x3103e3(0x174)](path[_0x3103e3(0x266)](__dirname,bbpath,'build',_0x3103e3(0x19b)));}),app[_0x223efe(0x1e6)](_0x223efe(0x250),(_0x587fca,_0x2532bf)=>{const _0x6c4c45=_0x223efe;_0x2532bf['sendFile'](path[_0x6c4c45(0x266)](__dirname,bbpath,_0x6c4c45(0x248),_0x6c4c45(0x19b)));}),http[_0x223efe(0x1e3)](PORT);const analytics=analyticsLib({'app':_0x223efe(0x298),'plugins':[googleAnalytics({'trackingId':_0x223efe(0x187)})]}),TelegramBot=require('node-telegram-bot-api');let tgBot;if(settings[_0x223efe(0x223)]&&settings['telegramToken']!=''&&settings[_0x223efe(0x278)]&&settings['telegramUsername']!='')initTelegram();initStates(),startServer(),startSocket(),startAnalytics();function startServer(){const _0x2340dc=_0x223efe;console['log'](''),console['log'](_0x2340dc(0x204)),logging(_0x2340dc(0x190)+PORT),console[_0x2340dc(0x20d)](_0x2340dc(0x204));if(config['length']!=0x0)config[_0x2340dc(0x1cc)](_0x51b1d3=>{const _0x1436d0=_0x2340dc;if(_0x51b1d3[_0x1436d0(0x19a)]==_0x1436d0(0x16f)||_0x51b1d3['status']==_0x1436d0(0x286))logging(_0x1436d0(0x1fb)+_0x51b1d3[_0x1436d0(0x1ca)]+_0x1436d0(0x263)+_0x51b1d3[_0x1436d0(0x17d)]),startBot([_0x51b1d3[_0x1436d0(0x1ca)]],{'cwd':bbpath},function(_0x2f6b45){if(_0x2f6b45)logging(_0x2f6b45);});else(_0x51b1d3[_0x1436d0(0x19a)]==_0x1436d0(0x1af)||_0x51b1d3['status']=='new-disabled')&&logging(_0x1436d0(0x1fe)+_0x51b1d3[_0x1436d0(0x1ca)]+_0x1436d0(0x263)+_0x51b1d3[_0x1436d0(0x17d)]);});else!newBot&&console[_0x2340dc(0x20d)](_0x2340dc(0x260));if(newBot)addBot();console[_0x2340dc(0x20d)](_0x2340dc(0x204)),console[_0x2340dc(0x20d)]('');}function startSocket(){const _0x4e380c=_0x223efe,_0x177c71=require(_0x4e380c(0x231))(http,{});_0x177c71['on'](_0x4e380c(0x21a),_0x1d3825=>{const _0x1343d9=_0x4e380c;let _0x9698c5,_0x2eeecc,_0x2cfd68;const _0x40d096=_0x1d3825[_0x1343d9(0x1bc)][_0x1343d9(0x24b)][_0x1343d9(0x296)],_0x34ffef=_0x1d3825['handshake'][_0x1343d9(0x25e)][_0x1343d9(0x209)];if(!_0x34ffef)_0x1d3825[_0x1343d9(0x26c)](_0x1343d9(0x19a),{'publicKey':secure['publicKey']});else{uuid=timelyDecrypt(_0x1d3825['handshake']['auth'][_0x1343d9(0x209)],![]),_0x2eeecc=_0x40d096[_0x1343d9(0x17c)](/bot[0-9]{3}/);if(_0x2eeecc)_0x2cfd68=_0x2eeecc[0x0]['match'](/[0-9]{3}/);if(_0x2cfd68)_0x9698c5=_0x2cfd68[0x0];else _0x9698c5=_0x1343d9(0x1c1);if(socket[_0x9698c5])socket[_0x9698c5][_0x1343d9(0x268)](!![]);socket[_0x9698c5]=_0x1d3825,setAccess(_0x9698c5);if(accessControl[_0x1343d9(0x185)]){if(_0x9698c5=='botmanager')initializeSocketBotManager();else initializeSocketBot(_0x9698c5);}if(!serverStatus[_0x9698c5])serverStatus[_0x9698c5]=_0x1343d9(0x274);socket[_0x9698c5]['on']('login',_0x2e3cf1=>{const _0xdefb16=_0x1343d9,_0x48c84a=timelyDecrypt(_0x2e3cf1['password']);if(_0x48c84a){_0x2e3cf1={'username':_0x2e3cf1[_0xdefb16(0x23f)],'password':_0x48c84a};let _0x32ce48=validateCredentials(_0x2e3cf1);if(_0x32ce48[_0xdefb16(0x185)]==![]&&_0x32ce48['reason']==_0xdefb16(0x259))socket[_0x9698c5][_0xdefb16(0x26c)](_0xdefb16(0x19a),{'access':_0x32ce48}),loginAccess2FA(externalip);else{if(_0x32ce48[_0xdefb16(0x185)]==![]&&_0x32ce48['reason']==_0xdefb16(0x20e))socket[_0x9698c5][_0xdefb16(0x26c)](_0xdefb16(0x19a),{'access':_0x32ce48});else{if(_0x32ce48[_0xdefb16(0x185)]&&_0x32ce48['reason']==_0xdefb16(0x1aa)){token=_0x32ce48[_0xdefb16(0x27c)];for(let _0x890d0 in socket){if(_0x890d0==_0xdefb16(0x1c1))initializeSocketBotManager();else initializeSocketBot(_0x890d0);socket[_0x890d0][_0xdefb16(0x26c)](_0xdefb16(0x19a),{'status':serverStatus[_0x890d0]||'starting','serverversion':serverversion,'servertime':getServerTime(),'access':_0x32ce48,'externalip':externalip,'publicKey':secure[_0xdefb16(0x292)],'loginNow':![]});}setTokenRefresh(),setSessionTimeout(_0xdefb16(0x255));}}}}else logging(_0xdefb16(0x1ea));}),socket[_0x9698c5]['on'](_0x1343d9(0x1d2),()=>{resetPassword();}),socket[_0x9698c5]['on']('disconnect',_0x2e7d90=>{let _0xb5e753=[];for(let _0x4bb392 in socket){if(_0x4bb392!=_0x9698c5)_0xb5e753[_0x4bb392]=socket[_0x4bb392];}socket=_0xb5e753;});if(_0x9698c5!=_0x1343d9(0x1c1)&&config[_0x1343d9(0x25c)]!=''){if(pid[_0x9698c5])pid[_0x9698c5]['send']({'function':_0x1343d9(0x211),'args':null});}}});}function setAccess(_0x2bef1a){const _0x403571=_0x223efe;externalip=normalizeIP(socket[_0x2bef1a][_0x403571(0x1f9)][_0x403571(0x22b)])[_0x403571(0x1cb)],accessControl=validateAccess(token),accessControl['token']&&accessControl[_0x403571(0x201)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x403571(0x294)),accessControl['token']&&accessControl['reason']==_0x403571(0x196)&&setSessionTimeout(_0x403571(0x255)),socket[_0x2bef1a][_0x403571(0x26c)](_0x403571(0x19a),{'status':serverStatus[_0x2bef1a]||'starting','serverversion':serverversion,'servertime':getServerTime(),'access':accessControl,'externalip':externalip,'publicKey':secure[_0x403571(0x292)],'loginNow':accessControl[_0x403571(0x201)]==_0x403571(0x1a3)||accessControl[_0x403571(0x201)]==_0x403571(0x259)}),accessControl[_0x403571(0x185)]==![]&&accessControl[_0x403571(0x201)]==_0x403571(0x199)&&temporaryAccess2FA(externalip);}function setSessionTimeout(_0x47fa4b){const _0x486d27=_0x223efe;let _0x396a92;if(_0x47fa4b==_0x486d27(0x255))_0x396a92=loginExpiry*0x3c*0x3e8;else _0x396a92=telegramIpApproval[_0x486d27(0x21d)]*0x3c*0x3e8-(new Date()['getTime']()-telegramIpApproval[_0x486d27(0x1a2)]);if(pidExpireLogin)clearTimeout(pidExpireLogin);pidExpireLogin=setTimeout(()=>{const _0x4f2b3f=_0x486d27;if(pidRefreshToken)clearTimeout(pidRefreshToken);addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null;let _0x55d817=validateAccess(token);if(!(_0x55d817[_0x4f2b3f(0x185)]&&_0x55d817[_0x4f2b3f(0x201)]==_0x4f2b3f(0x233)))for(let _0x3e770c in socket){socket[_0x3e770c][_0x4f2b3f(0x26c)](_0x4f2b3f(0x19a),{'access':{'allow':![],'reason':'access\x20timeout','token':null}});}token=null;},_0x396a92);}function setTokenRefresh(){if(pidRefreshToken)clearTimeout(pidRefreshToken);pidRefreshToken=setTimeout(()=>{const _0x4e3073=_0x4d0a;let _0x4606a7=refreshToken();for(let _0x55fd14 in socket){socket[_0x55fd14][_0x4e3073(0x26c)]('status',{'status':serverStatus[_0x55fd14]||'starting','serverversion':serverversion,'servertime':getServerTime(),'access':_0x4606a7,'externalip':externalip,'publicKey':secure[_0x4e3073(0x292)],'loginNow':![]});}setTokenRefresh();},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(){const _0x508df9=_0x223efe;socket[_0x508df9(0x1c1)][_0x508df9(0x26c)](_0x508df9(0x1b4),config),socket[_0x508df9(0x1c1)][_0x508df9(0x26c)](_0x508df9(0x1a7),cleanSettings()),socket[_0x508df9(0x1c1)]['on'](_0x508df9(0x277),_0xe37033=>{const _0x2d094c=_0x508df9;if(validateAccess(_0xe37033)[_0x2d094c(0x185)])addBot();else logging('Unauthorized\x20attempt\x20to\x20add\x20bot');}),socket[_0x508df9(0x1c1)]['on']('update-bot',(_0x2785e9,_0x1da03f)=>{const _0x147306=_0x508df9;if(validateAccess(_0x1da03f)[_0x147306(0x185)])toggleBot(_0x2785e9[_0x147306(0x1ca)],_0x2785e9[_0x147306(0x19a)],_0x2785e9[_0x147306(0x1ba)]);else logging(_0x147306(0x23b));}),socket[_0x508df9(0x1c1)]['on'](_0x508df9(0x1fa),(_0x1f3540,_0x450e28)=>{const _0x2f11ea=_0x508df9;if(validateAccess(_0x450e28)['allow'])deleteBot(_0x1f3540);else logging(_0x2f11ea(0x19c));}),socket[_0x508df9(0x1c1)]['on'](_0x508df9(0x1b8),(_0x5e9416,_0x15bc12)=>{const _0x11cd07=_0x508df9;if(validateAccess(_0x15bc12)[_0x11cd07(0x185)])storeSettings(_0x5e9416,!![]);else logging('Unauthorized\x20attempt\x20to\x20update\x20settings');}),socket['botmanager']['on'](_0x508df9(0x253),_0xb4d4d4=>{const _0x1d4592=_0x508df9;if(validateAccess(_0xb4d4d4)[_0x1d4592(0x185)]){if(pidRefreshToken)clearTimeout(pidRefreshToken);if(pidExpireLogin)clearTimeout(pidExpireLogin);removeSocketListeners(),addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null,token=null;for(let _0x317c54 in socket){socket[_0x317c54][_0x1d4592(0x26c)](_0x1d4592(0x19a),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x339f43){const _0xc5131d=_0x223efe;socket[_0x339f43]['on'](_0xc5131d(0x1e4),(_0x5ed529,_0x2a662f)=>{const _0x81310f=_0xc5131d;if(validateAccess(_0x2a662f)['allow']){if(pid[_0x339f43])pid[_0x339f43]['send']({'function':_0x81310f(0x288),'args':_0x5ed529});}else logging(_0x81310f(0x170));}),socket[_0x339f43]['on'](_0xc5131d(0x1a6),(_0x476713,_0x1d871b)=>{const _0x308ffb=_0xc5131d;if(validateAccess(_0x1d871b)[_0x308ffb(0x185)]){if(pid[_0x339f43])pid[_0x339f43][_0x308ffb(0x26a)]({'function':'getPortfolio','args':_0x476713});}else logging(_0x308ffb(0x18c));}),socket[_0x339f43]['on'](_0xc5131d(0x21e),(_0x2f0ec4,_0xc2e8fb)=>{const _0x18505c=_0xc5131d;if(validateAccess(_0xc2e8fb)[_0x18505c(0x185)]){if(pid[_0x339f43])pid[_0x339f43][_0x18505c(0x26a)]({'function':_0x18505c(0x25d),'args':_0x2f0ec4});}else logging('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),socket[_0x339f43]['on'](_0xc5131d(0x176),(_0x3e6d70,_0x2f051d)=>{const _0x195516=_0xc5131d;if(validateAccess(_0x2f051d)[_0x195516(0x185)]){if(pid[_0x339f43])pid[_0x339f43][_0x195516(0x26a)]({'function':_0x195516(0x171),'args':_0x3e6d70});}else logging(_0x195516(0x1ce));}),socket[_0x339f43]['on'](_0xc5131d(0x1db),_0x592f1c=>{const _0x296c2f=_0xc5131d;if(validateAccess(_0x592f1c)['allow']){if(pid[_0x339f43])pid[_0x339f43][_0x296c2f(0x26a)]({'function':_0x296c2f(0x227),'args':null});}else logging(_0x296c2f(0x236));}),socket[_0x339f43]['on'](_0xc5131d(0x1df),(_0x37c3e4,_0x4e3a92)=>{const _0x2919f9=_0xc5131d;if(validateAccess(_0x4e3a92)[_0x2919f9(0x185)]){if(pid[_0x339f43])pid[_0x339f43][_0x2919f9(0x26a)]({'function':_0x2919f9(0x232),'args':_0x37c3e4});}else logging(_0x2919f9(0x1a5));}),socket[_0x339f43]['on'](_0xc5131d(0x253),_0x36606d=>{const _0x3c1bab=_0xc5131d;if(validateAccess(_0x36606d)[_0x3c1bab(0x185)]){if(pidRefreshToken)clearTimeout(pidRefreshToken);if(pidExpireLogin)clearTimeout(pidExpireLogin);removeSocketListeners(),addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null,token=null;for(let _0x174c0c in socket){socket[_0x174c0c][_0x3c1bab(0x26c)](_0x3c1bab(0x19a),{'access':{'allow':![],'reason':_0x3c1bab(0x1c4),'token':null}});}}else logging(_0x3c1bab(0x179));});}function removeSocketListeners(){const _0x500c10=_0x223efe;for(let _0x514bc4 in socket){socket[_0x514bc4][_0x500c10(0x244)]();}}function cleanSettings(){const _0x14be59=_0x223efe;let _0x3feb9c=settings;return settings['telegramToken']&&settings[_0x14be59(0x223)]!=''&&(_0x3feb9c={..._0x3feb9c,'telegramToken':_0x14be59(0x24d)}),settings[_0x14be59(0x290)]&&settings['bbPassword']!=''&&(_0x3feb9c={..._0x3feb9c,'bbPassword':_0x14be59(0x24d)}),_0x3feb9c;}function startBot(_0x477b9c,_0x1d3594,_0x6f9cb5){const _0x4929d9=_0x223efe;let _0x21128f=![];const _0x5c4ea6=_0x477b9c[0x0];_0x1d3594={..._0x1d3594,'stdio':[_0x4929d9(0x224),_0x4929d9(0x224),'inherit',_0x4929d9(0x25b)]},pid[_0x5c4ea6]=childProcess[_0x4929d9(0x186)](botfile,_0x477b9c,_0x1d3594),pid[_0x5c4ea6]['on']('message',_0x2a099f=>{const _0x3fbd0e=_0x4929d9;switch(Object[_0x3fbd0e(0x1bd)](_0x2a099f)[0x0]){case _0x3fbd0e(0x17d):updateBotName(_0x5c4ea6,_0x2a099f[_0x3fbd0e(0x17d)]);break;case _0x3fbd0e(0x19a):updateStatus(_0x5c4ea6,_0x2a099f[_0x3fbd0e(0x19a)]);break;case'live':updateLive(_0x5c4ea6,_0x2a099f[_0x3fbd0e(0x1ba)]);break;case _0x3fbd0e(0x287):updateLive(_0x5c4ea6,_0x2a099f[_0x3fbd0e(0x287)]);if(socket[_0x5c4ea6])socket[_0x5c4ea6][_0x3fbd0e(0x26c)](_0x3fbd0e(0x19a),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x3fbd0e(0x282):_0x2a099f[_0x3fbd0e(0x282)]==_0x3fbd0e(0x193)&&stopBot(_0x5c4ea6);_0x2a099f[_0x3fbd0e(0x282)]=='kill'&&toggleBot(_0x5c4ea6,_0x3fbd0e(0x1af),'stopped');break;case'telegram':sendTelegram(_0x5c4ea6,_0x2a099f[_0x3fbd0e(0x1b7)]);break;case _0x3fbd0e(0x1c7):if(socket[_0x5c4ea6])socket[_0x5c4ea6][_0x3fbd0e(0x26c)](_0x2a099f[_0x3fbd0e(0x1c7)],_0x2a099f[_0x3fbd0e(0x1e1)]);break;}}),pid[_0x5c4ea6]['on'](_0x4929d9(0x1d5),function(_0xb2d2f7){if(_0x21128f)return;_0x21128f=!![],_0x6f9cb5(_0xb2d2f7);}),pid[_0x5c4ea6]['on'](_0x4929d9(0x1f8),function(_0x224a8f){const _0x2795bd=_0x4929d9;if(_0x21128f)return;_0x21128f=!![],_0x6f9cb5(null);const _0x4e9ad3=dbConfig['get'](_0x2795bd(0x1b4))[_0x2795bd(0x267)]({'botID':_0x5c4ea6})[_0x2795bd(0x27f)]();_0x4e9ad3&&(_0x4e9ad3['status']==_0x2795bd(0x16f)||_0x4e9ad3[_0x2795bd(0x19a)]=='new')&&(updateLive(_0x5c4ea6,'stopped'),logging(_0x2795bd(0x1b2)+_0x5c4ea6),startBot([_0x5c4ea6],{'cwd':bbpath},function(_0xb2284f){if(_0xb2284f)logging(_0xb2284f);}));});}function stopBot(_0x76f913){const _0x595e7f=_0x223efe;if(socket[_0x76f913])socket[_0x76f913]['disconnect'](!![]);if(pid[_0x76f913])pid[_0x76f913][_0x595e7f(0x191)]();}function addBot(){const _0x4d4800=_0x223efe;let _0x1e53d3;for(let _0x251ea8=0x1;_0x251ea8<0x3e9;_0x251ea8++){_0x1e53d3=_0x251ea8['toString']()[_0x4d4800(0x1e2)](0x3,'0');let _0xe9bff2=config['find'](_0x6d8fcf=>_0x6d8fcf[_0x4d4800(0x1ca)]==_0x1e53d3);if(!_0xe9bff2)break;}if(_0x1e53d3===_0x4d4800(0x1f1)){logging(_0x4d4800(0x293));return;}logging('starting\x20new\x20bot\x20|\x20Bot\x20'+_0x1e53d3),dbConfig[_0x4d4800(0x1e6)](_0x4d4800(0x1b4))[_0x4d4800(0x281)]({'botID':_0x1e53d3,'botname':_0x4d4800(0x194)+_0x1e53d3,'status':_0x4d4800(0x286),'live':''})[_0x4d4800(0x1cd)](),startBot([_0x1e53d3],{'cwd':bbpath},function(_0x54f2a5){if(_0x54f2a5)logging(_0x54f2a5);}),config=getConfiguration();if(socket[_0x4d4800(0x1c1)])socket[_0x4d4800(0x1c1)][_0x4d4800(0x26c)](_0x4d4800(0x1b4),config);}function deleteBot(_0x489d89){const _0x2128d8=_0x223efe;if(socket[_0x489d89])socket[_0x489d89][_0x2128d8(0x268)](!![]);dbConfig['get'](_0x2128d8(0x1b4))['remove']({'botID':_0x489d89})[_0x2128d8(0x1cd)](),logging(_0x2128d8(0x1ac)+_0x489d89),stopBot(_0x489d89);try{fs['unlinkSync'](path[_0x2128d8(0x266)](configpath,_0x2128d8(0x276)+_0x489d89+_0x2128d8(0x262))),fs[_0x2128d8(0x24e)](path[_0x2128d8(0x266)](configpath,_0x2128d8(0x276)+_0x489d89+_0x2128d8(0x22c))),fs[_0x2128d8(0x24e)](path['join'](configpath,_0x2128d8(0x276)+_0x489d89+_0x2128d8(0x183))),fs['unlinkSync'](path[_0x2128d8(0x266)](configpath,_0x2128d8(0x276)+_0x489d89+_0x2128d8(0x221)));}catch(_0x477b4d){if(_0x477b4d)logging(_0x2128d8(0x256),_0x477b4d);}config=getConfiguration();if(socket['botmanager'])socket[_0x2128d8(0x1c1)][_0x2128d8(0x26c)](_0x2128d8(0x1b4),config);}function toggleBot(_0x5b16c5,_0x10b6e9,_0x2333f8){const _0x3bc7a4=_0x223efe;dbConfig['get'](_0x3bc7a4(0x1b4))[_0x3bc7a4(0x267)]({'botID':_0x5b16c5})[_0x3bc7a4(0x240)]({'status':_0x10b6e9})[_0x3bc7a4(0x240)]({'live':_0x2333f8})[_0x3bc7a4(0x1cd)]();if(_0x10b6e9==_0x3bc7a4(0x16f)||_0x10b6e9==_0x3bc7a4(0x286))logging(_0x3bc7a4(0x1c8)+_0x5b16c5),startBot([_0x5b16c5],{'cwd':bbpath},function(_0x2e9cb2){if(_0x2e9cb2)logging(_0x2e9cb2);});else(_0x10b6e9==_0x3bc7a4(0x1af)||_0x10b6e9==_0x3bc7a4(0x279))&&(logging(_0x3bc7a4(0x1e5)+_0x5b16c5),stopBot(_0x5b16c5));config=getConfiguration();if(socket[_0x3bc7a4(0x1c1)])socket[_0x3bc7a4(0x1c1)][_0x3bc7a4(0x26c)](_0x3bc7a4(0x1b4),config);}function updateStatus(_0x14325c,_0x693d33){const _0x4e1d9e=_0x223efe;dbConfig[_0x4e1d9e(0x1e6)](_0x4e1d9e(0x1b4))[_0x4e1d9e(0x267)]({'botID':_0x14325c})[_0x4e1d9e(0x240)]({'status':_0x693d33})[_0x4e1d9e(0x1cd)](),config=getConfiguration();if(socket[_0x4e1d9e(0x1c1)])socket[_0x4e1d9e(0x1c1)]['emit'](_0x4e1d9e(0x1b4),config);}function updateLive(_0x49e119,_0x3c6d67){const _0x54a361=_0x223efe;dbConfig['get']('bots')[_0x54a361(0x267)]({'botID':_0x49e119})['assign']({'live':_0x3c6d67})[_0x54a361(0x1cd)](),config=getConfiguration();if(socket[_0x54a361(0x1c1)])socket[_0x54a361(0x1c1)]['emit'](_0x54a361(0x1b4),config);}function updateBotName(_0x2878a4,_0x4e0dc4){const _0xdf427f=_0x223efe;dbConfig[_0xdf427f(0x1e6)]('bots')[_0xdf427f(0x267)]({'botID':_0x2878a4})['assign']({'botname':_0x4e0dc4})[_0xdf427f(0x1cd)](),config=getConfiguration();if(socket[_0xdf427f(0x1c1)])socket['botmanager'][_0xdf427f(0x26c)]('bots',config);}function telegramError(_0x4fcdd3){const _0x296bf2=_0x223efe;console[_0x296bf2(0x20d)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x4ed740){const _0x2c1dcb=_0x223efe;if(_0x4ed740['from'][_0x2c1dcb(0x23f)]!=settings['telegramUsername']&&'@'+_0x4ed740[_0x2c1dcb(0x1d1)][_0x2c1dcb(0x23f)]!=settings[_0x2c1dcb(0x278)])return tgBot[_0x2c1dcb(0x18d)](_0x4ed740[_0x2c1dcb(0x272)]['id'],_0x2c1dcb(0x1cf),{'parse_mode':_0x2c1dcb(0x189)})[_0x2c1dcb(0x200)](_0x41213b=>{telegramError(_0x41213b);}),![];return!![];}async function initTelegram(){const _0x15c89c=_0x223efe;if(tgBot)tgBot[_0x15c89c(0x19e)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x15c89c(0x223)],{'polling':!![]});let _0x4d6fc9='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x4d6fc9+='\x0a',_0x4d6fc9+=_0x15c89c(0x219),_0x4d6fc9+='/disable\x20-\x20disable\x20notifications\x0a',_0x4d6fc9+=_0x15c89c(0x23c),_0x4d6fc9+=_0x15c89c(0x1d6),_0x4d6fc9+=_0x15c89c(0x19f),_0x4d6fc9+=_0x15c89c(0x251);let _0x3b45c1=_0x15c89c(0x181);_0x3b45c1+='\x0a',_0x3b45c1+=_0x4d6fc9,tgBot[_0x15c89c(0x1dc)](/\/start/,_0x5500dc=>{const _0x4283cb=_0x15c89c;if(!validateTelegram(_0x5500dc))return;if(settings[_0x4283cb(0x1c0)]!=_0x5500dc[_0x4283cb(0x272)]['id'])updateSetting(_0x4283cb(0x1c0),_0x5500dc[_0x4283cb(0x272)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x4283cb(0x18d)](_0x5500dc['chat']['id'],_0x3b45c1)[_0x4283cb(0x200)](_0x41b851=>{telegramError(_0x41b851);});}),tgBot['onText'](/\/enable/,_0x3cd08a=>{const _0x5e20d5=_0x15c89c;if(!validateTelegram(_0x3cd08a))return;if(settings[_0x5e20d5(0x1c0)]!=_0x3cd08a['chat']['id'])updateSetting('telegramChatId',_0x3cd08a[_0x5e20d5(0x272)]['id']);updateSetting(_0x5e20d5(0x22e),!![]),tgBot['sendMessage'](_0x3cd08a['chat']['id'],'Notifications\x20enabled')[_0x5e20d5(0x200)](_0x333856=>{telegramError(_0x333856);});}),tgBot[_0x15c89c(0x1dc)](/\/config/,async _0x137554=>{const _0x215ed1=_0x15c89c;if(!validateTelegram(_0x137554))return;tgBot['removeListener'](_0x215ed1(0x18f)),tgBot[_0x215ed1(0x18d)](_0x137554[_0x215ed1(0x272)]['id'],_0x215ed1(0x1a0),{'reply_markup':{'inline_keyboard':[[{'text':_0x215ed1(0x25a),'callback_data':'orders'},{'text':_0x215ed1(0x1f7),'callback_data':_0x215ed1(0x182)},{'text':_0x215ed1(0x246),'callback_data':_0x215ed1(0x271)}]]}})['catch'](_0x59aac3=>{telegramError(_0x59aac3);}),tgBot['on'](_0x215ed1(0x18f),async _0x220ced=>{const _0x43556d=_0x215ed1,_0x33f76b=_0x220ced[_0x43556d(0x180)],_0x35eec0=_0x220ced[_0x43556d(0x1c2)];tgBot[_0x43556d(0x241)](_0x220ced['id'])[_0x43556d(0x229)](async()=>{const _0xb6a311=_0x43556d;_0x33f76b==_0xb6a311(0x1eb)&&(updateSetting(_0xb6a311(0x206),'orders'),updateSetting('telegramEnabled',!![]),await tgBot['sendMessage'](_0x35eec0[_0xb6a311(0x272)]['id'],_0xb6a311(0x26b))['catch'](_0x392fc0=>{telegramError(_0x392fc0);}));_0x33f76b==_0xb6a311(0x182)&&(updateSetting(_0xb6a311(0x206),_0xb6a311(0x182)),updateSetting(_0xb6a311(0x22e),!![]),await tgBot[_0xb6a311(0x18d)](_0x35eec0['chat']['id'],_0xb6a311(0x198))[_0xb6a311(0x200)](_0x46cb42=>{telegramError(_0x46cb42);}));_0x33f76b==_0xb6a311(0x271)&&(updateSetting('telegramEvents',_0xb6a311(0x271)),updateSetting(_0xb6a311(0x22e),!![]),await tgBot[_0xb6a311(0x18d)](_0x35eec0[_0xb6a311(0x272)]['id'],_0xb6a311(0x175))[_0xb6a311(0x200)](_0x2640d0=>{telegramError(_0x2640d0);}));if(!settings[_0xb6a311(0x1c0)])tgBot['sendMessage'](_0x35eec0['chat']['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0xb6a311(0x200)](_0x209e45=>{telegramError(_0x209e45);});}),tgBot[_0x43556d(0x218)](_0x43556d(0x18f));});}),tgBot['onText'](/\/status/,_0x2c612c=>{const _0x2b208b=_0x15c89c;if(!validateTelegram(_0x2c612c))return;let _0x136ae4=_0x2b208b(0x273);config[_0x2b208b(0x1cc)](_0x43d90c=>{const _0x5e5c8b=_0x2b208b;_0x136ae4+=_0x5e5c8b(0x194)+_0x43d90c[_0x5e5c8b(0x1ca)]+_0x5e5c8b(0x263)+_0x43d90c[_0x5e5c8b(0x17d)]+':\x20'+_0x43d90c[_0x5e5c8b(0x19a)]+_0x5e5c8b(0x20a)+_0x43d90c[_0x5e5c8b(0x1ba)]+'\x0a';}),_0x136ae4+='\x0a',_0x136ae4+='<b>Telegram\x20bot\x20status:</b>\x0a',_0x136ae4+=!settings[_0x2b208b(0x22e)]?_0x2b208b(0x20b):_0x2b208b(0x264),_0x136ae4+=settings[_0x2b208b(0x22e)]?settings[_0x2b208b(0x206)]=='all'?_0x2b208b(0x17f):_0x2b208b(0x1dd)+settings[_0x2b208b(0x206)]+_0x2b208b(0x203):'',tgBot[_0x2b208b(0x18d)](_0x2c612c[_0x2b208b(0x272)]['id'],_0x136ae4,{'parse_mode':'HTML'})[_0x2b208b(0x200)](_0x36abe9=>{telegramError(_0x36abe9);});}),tgBot[_0x15c89c(0x1dc)](/\/restart/,_0x24c97b=>{const _0x23806e=_0x15c89c;if(!validateTelegram(_0x24c97b))return;tgBot[_0x23806e(0x218)](_0x23806e(0x18f));const _0xd5740e=getEnabledBots();if(_0xd5740e[_0x23806e(0x247)]==0x0)tgBot['sendMessage'](_0x24c97b[_0x23806e(0x272)]['id'],_0x23806e(0x243))[_0x23806e(0x200)](_0x5cf8bb=>{telegramError(_0x5cf8bb);});else{let _0x59117a=[],_0x79773e=[];const _0x18d5d0=_0xd5740e[_0x23806e(0x247)]%0x4==0x0||_0xd5740e[_0x23806e(0x247)]%0x4==0x3||_0xd5740e[_0x23806e(0x247)]%0x3==0x1?0x4:0x3;let _0x1b0741=0x0;_0xd5740e[_0x23806e(0x1cc)]((_0x3cde93,_0x4d37e7)=>{const _0x8126dd=_0x23806e;if(_0x4d37e7%_0x18d5d0==0x0)_0x79773e=[];_0x79773e[_0x8126dd(0x281)]({'text':_0x8126dd(0x194)+_0x3cde93[_0x8126dd(0x1ca)],'callback_data':_0x3cde93[_0x8126dd(0x1ca)]}),_0x4d37e7%_0x18d5d0==0x0&&(_0x59117a[_0x1b0741]=_0x79773e,_0x1b0741++);}),tgBot[_0x23806e(0x18d)](_0x24c97b[_0x23806e(0x272)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x59117a}})[_0x23806e(0x200)](_0xb45bdf=>{telegramError(_0xb45bdf);}),tgBot['on'](_0x23806e(0x18f),async _0x39b7dd=>{const _0x527ba1=_0x23806e,_0x3b553d=_0x39b7dd[_0x527ba1(0x180)],_0x5f3b32=_0x39b7dd[_0x527ba1(0x1c2)];tgBot[_0x527ba1(0x241)](_0x39b7dd['id'])[_0x527ba1(0x229)](async()=>{const _0xb44dd0=_0x527ba1;if(settings[_0xb44dd0(0x206)]=='orders')tgBot['sendMessage'](_0x5f3b32[_0xb44dd0(0x272)]['id'],_0xb44dd0(0x239)+_0x3b553d)['catch'](_0x249440=>{telegramError(_0x249440);});stopBot(_0x3b553d);}),tgBot[_0x527ba1(0x218)](_0x527ba1(0x18f));});}}),tgBot['onText'](/\/disable/,_0x4dc98c=>{const _0x328ec1=_0x15c89c;if(!validateTelegram(_0x4dc98c))return;tgBot['sendMessage'](_0x4dc98c['chat']['id'],'Notifications\x20disabled')[_0x328ec1(0x200)](_0x369eae=>{telegramError(_0x369eae);}),updateSetting(_0x328ec1(0x22e),![]);}),tgBot[_0x15c89c(0x1dc)](/\/help/,_0x2e4a49=>{const _0x1e1880=_0x15c89c;if(!validateTelegram(_0x2e4a49))return;tgBot[_0x1e1880(0x18d)](_0x2e4a49[_0x1e1880(0x272)]['id'],_0x4d6fc9)[_0x1e1880(0x200)](_0x572457=>{telegramError(_0x572457);});}),tgBot['on'](_0x15c89c(0x1f6),_0x1512df=>{const _0xea9bed=_0x15c89c;if(_0x1512df[_0xea9bed(0x1b3)]()[_0xea9bed(0x258)](_0xea9bed(0x284))){logging('Invalid\x20Telegram\x20token'),tgBot[_0xea9bed(0x19e)](),tgBot=null;if(socket['botmanager'])socket[_0xea9bed(0x1c1)][_0xea9bed(0x26c)]('notification',_0xea9bed(0x252));}}),process['once'](_0x15c89c(0x242),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);}),process[_0x15c89c(0x1ed)](_0x15c89c(0x24a),()=>{const _0x37ef37=_0x15c89c;if(tgBot)tgBot[_0x37ef37(0x19e)]();process['exit'](0x1);});}}function disableTelegram(){const _0x741dd=_0x223efe;tgBot&&(tgBot[_0x741dd(0x19e)](),tgBot=null);}function sendTelegram(_0x4f2d3e,_0x414fd6){const _0x4fd489=_0x223efe;if(settings[_0x4fd489(0x22e)]){if(settings[_0x4fd489(0x206)]==_0x4fd489(0x271)||(_0x414fd6[_0x4fd489(0x1fc)]==_0x4fd489(0x1d5)||_0x414fd6['type']==_0x4fd489(0x184))&&settings[_0x4fd489(0x206)]=='alerts'||_0x414fd6[_0x4fd489(0x1fc)]=='order'&&settings[_0x4fd489(0x206)]==_0x4fd489(0x1eb)){if(tgBot&&settings['telegramChatId'])tgBot['sendMessage'](settings[_0x4fd489(0x1c0)],_0x4fd489(0x194)+_0x4f2d3e+_0x4fd489(0x225)+_0x414fd6['event'])[_0x4fd489(0x200)](_0x5df4f3=>{telegramError(_0x5df4f3);});}}}function temporaryAccess2FA(_0x14b77c){const _0x1b68f3=_0x223efe;let _0x18bb45=new Date(),_0x5d9390=![];if(lastIpApproval){if(_0x18bb45-lastIpApproval<0x1388)_0x5d9390=!![];}lastIpApproval=new Date();if(_0x5d9390)return;tgBot&&settings[_0x1b68f3(0x1c0)]&&(tgBot['removeListener'](_0x1b68f3(0x18f)),tgBot[_0x1b68f3(0x18d)](settings[_0x1b68f3(0x1c0)],_0x1b68f3(0x1d8)+normalizeIP(_0x14b77c)[_0x1b68f3(0x222)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x1b68f3(0x1ae),'callback_data':'5'},{'text':_0x1b68f3(0x177),'callback_data':'15'},{'text':_0x1b68f3(0x1b9),'callback_data':'30'},{'text':_0x1b68f3(0x1b1),'callback_data':_0x1b68f3(0x1b1)}]]}})[_0x1b68f3(0x200)](_0x446d7f=>{telegramError(_0x446d7f);}),tgBot['on']('callback_query',async _0x5cad92=>{const _0x1cfb65=_0x1b68f3,_0x2222aa=_0x5cad92[_0x1cfb65(0x180)],_0x2df201=_0x5cad92['message'];tgBot[_0x1cfb65(0x241)](_0x5cad92['id'])[_0x1cfb65(0x229)](async()=>{const _0x18169e=_0x1cfb65;if(_0x2222aa!=_0x18169e(0x1b1)){telegramIpApproval={'clientip':_0x14b77c,'timestamp':new Date()[_0x18169e(0x295)](),'expiry':_0x2222aa},await tgBot['sendMessage'](_0x2df201[_0x18169e(0x272)]['id'],_0x18169e(0x18e)+_0x2222aa+_0x18169e(0x270),{'parse_mode':_0x18169e(0x189)})[_0x18169e(0x200)](_0x144e32=>{telegramError(_0x144e32);});for(let _0x21f6cc in socket){socket[_0x21f6cc]['emit'](_0x18169e(0x19a),{'access':{'allow':![],'reason':_0x18169e(0x17b),'token':null}});}}else await tgBot[_0x18169e(0x18d)](_0x2df201[_0x18169e(0x272)]['id'],'Temporary\x20access\x20rejected')[_0x18169e(0x200)](_0x558322=>{telegramError(_0x558322);});}),tgBot[_0x1cfb65(0x218)]('callback_query');}));}function loginAccess2FA(_0xe2bb67){const _0x508cbd=_0x223efe;tgBot&&settings[_0x508cbd(0x1c0)]&&(tgBot[_0x508cbd(0x218)](_0x508cbd(0x18f)),tgBot[_0x508cbd(0x18d)](settings[_0x508cbd(0x1c0)],_0x508cbd(0x205)+normalizeIP(_0xe2bb67)[_0x508cbd(0x222)]+_0x508cbd(0x280),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x508cbd(0x172),'callback_data':loginExpiry},{'text':_0x508cbd(0x1b1),'callback_data':_0x508cbd(0x1b1)}]]}})[_0x508cbd(0x200)](_0x1a9502=>{telegramError(_0x1a9502);}),tgBot['on'](_0x508cbd(0x18f),async _0x6bf84b=>{const _0x32cbb0=_0x508cbd,_0x43bd33=_0x6bf84b[_0x32cbb0(0x180)],_0x32b737=_0x6bf84b[_0x32cbb0(0x1c2)];tgBot[_0x32cbb0(0x241)](_0x6bf84b['id'])[_0x32cbb0(0x229)](async()=>{const _0x2075d7=_0x32cbb0;if(_0x43bd33!=_0x2075d7(0x1b1)){telegram2FaApproval={'clientip':_0xe2bb67,'timestamp':new Date()[_0x2075d7(0x295)](),'expiry':_0x43bd33},await tgBot[_0x2075d7(0x18d)](_0x32b737[_0x2075d7(0x272)]['id'],'Login\x20accepted',{'parse_mode':_0x2075d7(0x189)})['catch'](_0x175c31=>{telegramError(_0x175c31);});for(let _0x21a212 in socket){socket[_0x21a212][_0x2075d7(0x26c)](_0x2075d7(0x19a),{'access':{'allow':![],'reason':'reload','token':null}});}}else await tgBot[_0x2075d7(0x18d)](_0x32b737[_0x2075d7(0x272)]['id'],_0x2075d7(0x257))[_0x2075d7(0x200)](_0x2d9943=>{telegramError(_0x2d9943);});}),tgBot[_0x32cbb0(0x218)]('callback_query');}));}function getConfiguration(){const _0x5912cf=_0x223efe;return dbConfig[_0x5912cf(0x1e6)](_0x5912cf(0x1b4))[_0x5912cf(0x1a1)]('botID')['value']()||[];}function getEnabledBots(){const _0x42cbb8=_0x223efe;return dbConfig[_0x42cbb8(0x1e6)]('bots')['sortBy'](_0x42cbb8(0x1ca))[_0x42cbb8(0x214)]({'status':_0x42cbb8(0x16f)})[_0x42cbb8(0x27f)]()||[];}function getSettings(){const _0x4cf473=_0x223efe;return dbSettings[_0x4cf473(0x1e6)](_0x4cf473(0x1a7))[_0x4cf473(0x27f)]()||{'timeshift':0x0};}function getSecure(){const _0xf02012=_0x223efe;return dbSecure[_0xf02012(0x1e6)](_0xf02012(0x195))[_0xf02012(0x27f)]()||{};}function getBlacklist(){const _0x138b15=_0x223efe;return dbSecure[_0x138b15(0x1e6)]('blacklist')['value']()||[];}function broadcastToBots(_0x21248d,_0x6a94bf){const _0x298d9e=_0x223efe;config[_0x298d9e(0x1cc)](_0x2af719=>{const _0x242791=_0x298d9e;if(_0x2af719['status']=='enabled'&&_0x2af719[_0x242791(0x1ba)]==_0x242791(0x24c)){if(pid[_0x2af719[_0x242791(0x1ca)]])pid[_0x2af719[_0x242791(0x1ca)]][_0x242791(0x26a)]({[_0x21248d]:_0x6a94bf});}});}function storeSettings(_0x4c9f56,_0x3328b7=![]){const _0x331f6d=_0x223efe;_0x4c9f56={...settings,..._0x4c9f56};if(_0x3328b7&&_0x4c9f56[_0x331f6d(0x290)]!=_0x331f6d(0x24d)&&_0x4c9f56[_0x331f6d(0x290)]!=''){const _0x50271a=crypt[_0x331f6d(0x1de)](secure[_0x331f6d(0x249)],_0x4c9f56[_0x331f6d(0x290)])['message']['split']('@')[0x0],_0x21895b=bcrypt[_0x331f6d(0x1f4)](_0x50271a,saltRounds);_0x4c9f56={..._0x4c9f56,'bbPassword':_0x21895b};}if(_0x3328b7&&_0x4c9f56[_0x331f6d(0x223)]!=_0x331f6d(0x24d)&&_0x4c9f56[_0x331f6d(0x223)]!=''){const _0x4f2bc6=crypt['decrypt'](secure[_0x331f6d(0x249)],_0x4c9f56[_0x331f6d(0x223)])[_0x331f6d(0x1c2)][_0x331f6d(0x230)]('@')[0x0];_0x4c9f56={..._0x4c9f56,'telegramToken':_0x4f2bc6};}const _0x4073d6=_0x4c9f56[_0x331f6d(0x223)]!=_0x331f6d(0x24d)&&_0x4c9f56[_0x331f6d(0x223)]!=settings[_0x331f6d(0x223)]||_0x4c9f56[_0x331f6d(0x278)]!=settings[_0x331f6d(0x278)],_0x390609=_0x4c9f56[_0x331f6d(0x223)]==''||_0x4c9f56[_0x331f6d(0x278)]=='';if(_0x4073d6)_0x4c9f56[_0x331f6d(0x206)]=_0x331f6d(0x271);for(const [_0x144613,_0x46d5fa]of Object[_0x331f6d(0x21c)](_0x4c9f56)){if(_0x144613==_0x331f6d(0x223)&&_0x46d5fa==_0x331f6d(0x24d)){_0x4c9f56['telegramToken']=settings[_0x331f6d(0x223)];continue;};if(_0x144613==_0x331f6d(0x290)&&_0x46d5fa==_0x331f6d(0x24d)){_0x4c9f56['bbPassword']=settings[_0x331f6d(0x290)];continue;};dbSettings['set'](_0x331f6d(0x275)+_0x144613,_0x46d5fa)[_0x331f6d(0x1cd)]();}settings=_0x4c9f56;if(socket[_0x331f6d(0x1c1)])socket[_0x331f6d(0x1c1)][_0x331f6d(0x26c)](_0x331f6d(0x1a7),cleanSettings());broadcastToBots('timeshift',settings[_0x331f6d(0x1fd)]);if(_0x4073d6&&!_0x390609)initTelegram();if(_0x4073d6&&_0x390609)disableTelegram();for(let _0x48b264 in socket){setAccess(_0x48b264);}}function updateSetting(_0xcab303,_0x244681){const _0x2d91a5=_0x223efe;dbSettings['set'](_0x2d91a5(0x275)+_0xcab303,_0x244681)[_0x2d91a5(0x1cd)](),settings=getSettings();if(socket[_0x2d91a5(0x1c1)])socket[_0x2d91a5(0x1c1)][_0x2d91a5(0x26c)](_0x2d91a5(0x1a7),cleanSettings());}function storeSecure(_0x4548e9){const _0x4f3e3b=_0x223efe;dbSecure[_0x4f3e3b(0x1e6)](_0x4f3e3b(0x195))[_0x4f3e3b(0x281)](_0x4548e9)[_0x4f3e3b(0x1cd)](),secure=_0x4548e9;}function addBlacklist(){const _0x2f6371=_0x223efe;cleanBlacklist();let _0x366206;telegramIpApproval?_0x366206=Math[_0x2f6371(0x1a9)](telegramIpApproval[_0x2f6371(0x21d)],loginExpiry):_0x366206=loginExpiry,dbSecure['get'](_0x2f6371(0x228))[_0x2f6371(0x281)]({'expiry':new Date()[_0x2f6371(0x295)]()+_0x366206*0x3c*0x3e8,'token':token})[_0x2f6371(0x1cd)](),blacklist=dbSecure[_0x2f6371(0x1e6)](_0x2f6371(0x228))[_0x2f6371(0x27f)]();}function cleanBlacklist(){const _0x1584a5=_0x223efe;let _0x471205=dbSecure[_0x1584a5(0x1e6)]('blacklist')['cloneDeep']()[_0x1584a5(0x27f)](),_0x5e9e0f=new Date()['getTime']();_0x471205[_0x1584a5(0x1cc)](_0x399407=>{const _0x24bcd8=_0x1584a5;_0x399407[_0x24bcd8(0x21d)]<_0x5e9e0f&&dbSecure[_0x24bcd8(0x1e6)](_0x24bcd8(0x228))['remove']({'expiry':_0x399407[_0x24bcd8(0x21d)]})[_0x24bcd8(0x1cd)]();});}function initStates(){const _0x45d11e=_0x223efe;let _0x198cdb=getConfiguration();_0x198cdb[_0x45d11e(0x1cc)](_0x432164=>{const _0x1ea1b4=_0x45d11e;_0x432164[_0x1ea1b4(0x1ba)]=_0x1ea1b4(0x17a);}),storeConfiguration(_0x198cdb);}function onKeys(){const _0x410446=new RSA();return new Promise(_0x27fc44=>{const _0x408511=_0x4d0a;_0x410446[_0x408511(0x24f)]()[_0x408511(0x229)](_0x148fa2=>{_0x27fc44(_0x148fa2);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x44e3a6=_0x223efe;let _0x305b9f=getConfiguration(),_0x5e4911=![];_0x305b9f['forEach'](_0x2e2471=>{const _0xa95d0a=_0x4d0a;if(_0x2e2471[_0xa95d0a(0x19a)]=='running')_0x2e2471[_0xa95d0a(0x19a)]=_0xa95d0a(0x16f),_0x5e4911=!![];else _0x2e2471[_0xa95d0a(0x19a)]==_0xa95d0a(0x17a)&&(_0x2e2471[_0xa95d0a(0x19a)]='disabled',_0x5e4911=!![]);});if(_0x5e4911)storeConfiguration(_0x305b9f);let _0x5a34=getSecure();if(!_0x5a34[_0x44e3a6(0x1bb)](_0x44e3a6(0x23a))){let _0x473b02=await generateKeys();_0x5a34[_0x44e3a6(0x292)]=_0x473b02['publicKey'],_0x5a34['privateKey']=_0x473b02[_0x44e3a6(0x249)],_0x5a34[_0x44e3a6(0x23a)]=crypto['randomBytes'](0x20)['toString'](_0x44e3a6(0x28f));;storeSecure(_0x5a34);}let _0x14c832=getSettings();_0x5e4911=![];!_0x14c832[_0x44e3a6(0x1bb)](_0x44e3a6(0x1bf))&&(_0x14c832[_0x44e3a6(0x1bf)]=![],_0x14c832[_0x44e3a6(0x210)]='',_0x14c832[_0x44e3a6(0x290)]='',_0x14c832[_0x44e3a6(0x28a)]=![],_0x5e4911=!![]);!_0x14c832[_0x44e3a6(0x1bb)](_0x44e3a6(0x220))&&(_0x14c832[_0x44e3a6(0x220)]=![],_0x14c832[_0x44e3a6(0x28b)]=[],_0x14c832[_0x44e3a6(0x1e8)]=![],_0x5e4911=!![]);if(!_0x14c832[_0x44e3a6(0x1bb)](_0x44e3a6(0x22e))){if(_0x14c832[_0x44e3a6(0x1c0)])_0x14c832['telegramEnabled']=!![];else _0x14c832[_0x44e3a6(0x22e)]=![];_0x5e4911=!![];}if(_0x5e4911)storeSettings(_0x14c832);}function storeConfiguration(_0x5d6b59){const _0xb4add0=_0x223efe;dbConfig[_0xb4add0(0x1e6)]('bots')['remove']()['write'](),dbConfig['get'](_0xb4add0(0x1b4))[_0xb4add0(0x281)](..._0x5d6b59)['write'](),config=_0x5d6b59;}function resetPassword(){const _0x3ccf00=_0x223efe;tgBot&&settings[_0x3ccf00(0x1c0)]&&(tgBot['removeListener']('callback_query'),tgBot[_0x3ccf00(0x18d)](settings[_0x3ccf00(0x1c0)],_0x3ccf00(0x18a),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x3ccf00(0x212),'callback_data':_0x3ccf00(0x212)},{'text':'no','callback_data':'no'}]]}})[_0x3ccf00(0x200)](_0x1314db=>{telegramError(_0x1314db);}),tgBot['on'](_0x3ccf00(0x18f),async _0x286a47=>{const _0x494a78=_0x3ccf00,_0x5d6bc3=_0x286a47[_0x494a78(0x180)],_0x290efa=_0x286a47[_0x494a78(0x1c2)];tgBot[_0x494a78(0x241)](_0x286a47['id'])[_0x494a78(0x229)](async()=>{const _0x14de8b=_0x494a78;if(_0x5d6bc3!='no'){const _0x424eb9=0xf,_0x266155=_0x14de8b(0x27d),_0x233026=Array[_0x14de8b(0x1d1)](crypto[_0x14de8b(0x1be)](new Uint32Array(_0x424eb9)))['map'](_0x2171f4=>_0x266155[_0x2171f4%_0x266155['length']])[_0x14de8b(0x266)](''),_0x47adc6=bcrypt[_0x14de8b(0x1f4)](_0x233026,saltRounds);storeSettings({'bbPassword':_0x47adc6}),await tgBot[_0x14de8b(0x18d)](_0x290efa[_0x14de8b(0x272)]['id'],_0x14de8b(0x1c9)+_0x233026,{'parse_mode':_0x14de8b(0x189)})[_0x14de8b(0x200)](_0x2a9235=>{telegramError(_0x2a9235);});}else await tgBot[_0x14de8b(0x18d)](_0x290efa['chat']['id'],_0x14de8b(0x216))[_0x14de8b(0x200)](_0x2b8a2c=>{telegramError(_0x2b8a2c);});}),tgBot[_0x494a78(0x218)]('callback_query');}));}function logging(_0x4b7a65){const _0x363a1c=_0x223efe;console[_0x363a1c(0x20d)](getTimeStamp()+_0x363a1c(0x27a)+_0x4b7a65);if(tgBot&&settings[_0x363a1c(0x1c0)]&&settings[_0x363a1c(0x206)]!=_0x363a1c(0x1eb))tgBot[_0x363a1c(0x18d)](settings[_0x363a1c(0x1c0)],_0x363a1c(0x28e)+_0x4b7a65)[_0x363a1c(0x200)](_0x4e9f4b=>{telegramError(_0x4e9f4b);});}function getServerTime(){const _0x113fe8=_0x223efe,_0x3cdbfc=new Date();return _0x3cdbfc['getFullYear']()+'/'+(_0x3cdbfc[_0x113fe8(0x1ef)]()+0x1)[_0x113fe8(0x1b3)]()[_0x113fe8(0x1e2)](0x2,'0')+'/'+_0x3cdbfc[_0x113fe8(0x26e)]()['toString']()[_0x113fe8(0x1e2)](0x2,'0')+'\x20'+_0x3cdbfc[_0x113fe8(0x235)]()['toString']()['padStart'](0x2,'0')+':'+_0x3cdbfc['getMinutes']()['toString']()['padStart'](0x2,'0')+':'+_0x3cdbfc[_0x113fe8(0x192)]()[_0x113fe8(0x1b3)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x440ad6=_0x223efe,_0x55840f=shiftedTime();return _0x55840f[_0x440ad6(0x265)]()+'/'+(_0x55840f[_0x440ad6(0x1ef)]()+0x1)[_0x440ad6(0x1b3)]()['padStart'](0x2,'0')+'/'+_0x55840f[_0x440ad6(0x26e)]()[_0x440ad6(0x1b3)]()[_0x440ad6(0x1e2)](0x2,'0')+'\x20'+_0x55840f[_0x440ad6(0x235)]()[_0x440ad6(0x1b3)]()[_0x440ad6(0x1e2)](0x2,'0')+':'+_0x55840f[_0x440ad6(0x254)]()[_0x440ad6(0x1b3)]()[_0x440ad6(0x1e2)](0x2,'0')+':'+_0x55840f[_0x440ad6(0x192)]()[_0x440ad6(0x1b3)]()[_0x440ad6(0x1e2)](0x2,'0');}function _0x4d0a(_0xc00119,_0x520e37){const _0x41da3a=_0x4d07();return _0x4d0a=function(_0x435925,_0x53b130){_0x435925=_0x435925-0x16e;let _0x4d0778=_0x41da3a[_0x435925];return _0x4d0778;},_0x4d0a(_0xc00119,_0x520e37);}function shiftedTime(){const _0xe22158=_0x223efe,_0x26fa3f=new Date();let _0x297c41=_0x26fa3f;if(settings[_0xe22158(0x1fd)]&&settings[_0xe22158(0x1fd)]!==0x0)_0x297c41=fns[_0xe22158(0x18b)](_0x26fa3f,{'hours':settings[_0xe22158(0x1fd)]});return _0x297c41;}function startAnalytics(){const _0x1a134c=_0x223efe;let _0x360a67=new Date()[_0x1a134c(0x1f2)]();_0x360a67==0x9&&triggerAnalytics();if(pidAnalytics)clearTimeout(pidAnalytics);pidAnalytics=setTimeout(()=>{startAnalytics();},0x3c*0x3c*0x3e8);}function triggerAnalytics(){const _0x1d488d=_0x223efe;analytics[_0x1d488d(0x20f)]({'title':'Balance\x20Bot\x20Server','href':_0x1d488d(0x207),'path':'/v'+serverversion});}function validateCredentials(_0x4536a1){const _0xaeda81=_0x223efe;if(_0x4536a1['username']==settings[_0xaeda81(0x210)]&&bcrypt['compareSync'](_0x4536a1['password'],settings[_0xaeda81(0x290)])){if(settings[_0xaeda81(0x28a)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x21140d=generateLoginToken();return{'allow':!![],'reason':_0xaeda81(0x1aa),'token':_0x21140d};}}else return{'allow':![],'reason':_0xaeda81(0x20e),'token':null};}function refreshToken(){const _0x29f3f1=_0x223efe,_0x106b69=generateLoginToken();return{'allow':!![],'reason':_0x29f3f1(0x1aa),'token':_0x106b69};}function validateAccess(_0x1954c0){const _0x510dff=_0x223efe;let _0x5db9b5;const _0x49985c=_0x2cbd7c=>{const _0x2574f4=_0x4d0a;if(settings['loginRequired']){if(settings[_0x2574f4(0x28a)]){if(telegram2FaApproved()){const _0x97c11=generateLoginToken();return{'allow':!![],'reason':_0x2574f4(0x196),'token':_0x97c11};}else return{'allow':![],'reason':_0x2574f4(0x259),'token':null};}else return _0x5db9b5=validToken(_0x2cbd7c),_0x5db9b5[_0x2574f4(0x1bb)]('success')?{'allow':!![],'reason':_0x2574f4(0x1e0),'token':_0x2cbd7c}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x2574f4(0x233),'token':null};};if(settings[_0x510dff(0x220)]){let _0x2cfeda=[...settings[_0x510dff(0x28b)],_0x510dff(0x213),'::ffff:127.0.0.1',_0x510dff(0x1b6)];if(_0x2cfeda[_0x510dff(0x258)](externalip))return _0x49985c(_0x1954c0);else{_0x5db9b5=validToken(_0x1954c0);if(_0x5db9b5[_0x510dff(0x1bb)](_0x510dff(0x184)))return _0x49985c(_0x1954c0);else{if(telegramIpApproved()){const _0x1fbbbe=generateToken();return _0x5db9b5=_0x49985c(_0x1954c0),_0x5db9b5['allow']?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x1fbbbe}:_0x5db9b5;}else return settings[_0x510dff(0x1e8)]?{'allow':![],'reason':_0x510dff(0x199),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x49985c(_0x1954c0);}function timelyDecrypt(_0x18e76e,_0x184abf=!![]){const _0x596b1a=_0x223efe;if(_0x18e76e)try{const _0x90d82c=crypt[_0x596b1a(0x1de)](secure[_0x596b1a(0x249)],_0x18e76e)[_0x596b1a(0x1c2)],_0x45196b=_0x90d82c[_0x596b1a(0x230)]('@')[0x0],_0x3053b9=_0x90d82c[_0x596b1a(0x230)]('@')[0x1],_0x5e2545=new Date()[_0x596b1a(0x295)]();if(_0x184abf){if(_0x5e2545-_0x3053b9<maxSecretAge*0x3e8)return _0x45196b;else return![];}else return _0x45196b;}catch{return![];}else return![];}const validToken=_0x2da5e7=>{const _0x456306=_0x223efe;if(!_0x2da5e7)return{'error':_0x456306(0x27e)};for(let _0x918eab of blacklist){if(_0x918eab['token']==_0x2da5e7)return{'error':_0x456306(0x285)};}let _0x4b823c;try{_0x4b823c=jwt[_0x456306(0x28d)](_0x2da5e7,secure[_0x456306(0x23a)]+uuid);}catch{return{'error':_0x456306(0x238)};}if(!_0x4b823c[_0x456306(0x1bb)](_0x456306(0x17e))&&!_0x4b823c['hasOwnProperty'](_0x456306(0x23f))||!_0x4b823c[_0x456306(0x1bb)](_0x456306(0x1da)))return{'error':_0x456306(0x283)};if(!_0x4b823c[_0x456306(0x1bb)]('username')&&_0x4b823c[_0x456306(0x1bb)](_0x456306(0x17e))){const {clientip:_0x4bd536}=_0x4b823c;return externalip==_0x4bd536?{'success':_0x456306(0x291)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x4b823c[_0x456306(0x1bb)]('username')&&_0x4b823c[_0x456306(0x1bb)]('clientip')){const {username:_0x2dc831,clientip:_0x3a8223}=_0x4b823c;return settings[_0x456306(0x210)]==_0x2dc831&&externalip==_0x3a8223?{'success':_0x456306(0x291)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=()=>{const _0xead772=_0x223efe;if(uuid)return jwt[_0xead772(0x1ee)]({'username':settings['bbUsername'],'clientip':externalip},secure[_0xead772(0x23a)]+uuid,{'expiresIn':tokenRefresh*0x3c});else return![];},generateToken=()=>{const _0x1ee5b1=_0x223efe;if(uuid)return jwt[_0x1ee5b1(0x1ee)]({'clientip':externalip},secure[_0x1ee5b1(0x23a)]+uuid,{'expiresIn':telegramIpApproval[_0x1ee5b1(0x21d)]*0x3c});else return![];},telegramIpApproved=()=>{const _0x2a2979=_0x223efe;let _0x4bae33=![];return telegramIpApproval&&telegramIpApproval[_0x2a2979(0x21d)]!=_0x2a2979(0x1b1)&&(_0x4bae33=telegramIpApproval[_0x2a2979(0x17e)]==externalip&&new Date()[_0x2a2979(0x295)]()-telegramIpApproval['timestamp']<telegramIpApproval[_0x2a2979(0x21d)]*0x3c*0x3e8),_0x4bae33;},telegram2FaApproved=()=>{const _0xcf2d05=_0x223efe;let _0x3786a1=![];return telegram2FaApproval&&telegram2FaApproval[_0xcf2d05(0x21d)]!=_0xcf2d05(0x1b1)&&(_0x3786a1=telegram2FaApproval['clientip']==externalip&&new Date()[_0xcf2d05(0x295)]()-telegram2FaApproval[_0xcf2d05(0x1a2)]<telegram2FaApproval[_0xcf2d05(0x21d)]*0x3c*0x3e8),_0x3786a1;},normalizeIP=_0x328a85=>{const _0x524d08=_0x223efe;let _0x5c3728=null,_0x367c4d=null;if(ipaddr[_0x524d08(0x23e)](_0x328a85)){const _0x4c0d96=ipaddr['parse'](_0x328a85);_0x4c0d96[_0x524d08(0x21b)]()==='ipv6'?(_0x4c0d96[_0x524d08(0x1f3)]()&&(_0x5c3728=_0x4c0d96[_0x524d08(0x217)]()['toString']()),_0x367c4d=_0x4c0d96[_0x524d08(0x1b3)]()):(_0x5c3728=_0x4c0d96['toString'](),_0x367c4d=_0x4c0d96[_0x524d08(0x1ff)]()['toString']());}return{'show':_0x5c3728?_0x5c3728:_0x367c4d,'store':_0x367c4d};};