const _0x51d6d2=_0x12b1;(function(_0xc1cc0b,_0x19f197){const _0x5ef75c=_0x12b1,_0x2efa0b=_0xc1cc0b();while(!![]){try{const _0x154ab3=parseInt(_0x5ef75c(0x223))/0x1*(parseInt(_0x5ef75c(0x269))/0x2)+parseInt(_0x5ef75c(0x212))/0x3+parseInt(_0x5ef75c(0x26d))/0x4*(-parseInt(_0x5ef75c(0x275))/0x5)+parseInt(_0x5ef75c(0x299))/0x6+parseInt(_0x5ef75c(0x181))/0x7*(-parseInt(_0x5ef75c(0x1a6))/0x8)+-parseInt(_0x5ef75c(0x23f))/0x9*(-parseInt(_0x5ef75c(0x1a7))/0xa)+parseInt(_0x5ef75c(0x196))/0xb*(-parseInt(_0x5ef75c(0x2a7))/0xc);if(_0x154ab3===_0x19f197)break;else _0x2efa0b['push'](_0x2efa0b['shift']());}catch(_0x113df9){_0x2efa0b['push'](_0x2efa0b['shift']());}}}(_0x2bbf,0x84ab1));const _0x55b97f=function(){let _0x2ada8e=!![];return function(_0x13bdb4,_0x4ded8b){const _0x151c99=_0x2ada8e?function(){const _0x4a5671=_0x12b1;if(_0x4ded8b){const _0x5ebb86=_0x4ded8b[_0x4a5671(0x222)](_0x13bdb4,arguments);return _0x4ded8b=null,_0x5ebb86;}}:function(){};return _0x2ada8e=![],_0x151c99;};}(),_0x2d417c=_0x55b97f(this,function(){const _0x2c5fb7=_0x12b1;return _0x2d417c['toString']()[_0x2c5fb7(0x2af)](_0x2c5fb7(0x1f8))[_0x2c5fb7(0x217)]()[_0x2c5fb7(0x1e0)](_0x2d417c)[_0x2c5fb7(0x2af)](_0x2c5fb7(0x1f8));});_0x2d417c();'use strict';process[_0x51d6d2(0x1e4)][_0x51d6d2(0x173)]=0x1;const childProcess=require(_0x51d6d2(0x1e8)),FileSync=require('lowdb/adapters/FileSync'),fs=require('fs'),fns=require(_0x51d6d2(0x1ff)),low=require(_0x51d6d2(0x1a9)),path=require(_0x51d6d2(0x1b0)),crypto=require(_0x51d6d2(0x186)),Crypt=require(_0x51d6d2(0x24f))['Crypt'],RSA=require(_0x51d6d2(0x24f))[_0x51d6d2(0x175)],bcrypt=require(_0x51d6d2(0x260)),jwt=require(_0x51d6d2(0x1d2)),analyticsLib=require('analytics')[_0x51d6d2(0x25c)],googleAnalytics=require(_0x51d6d2(0x2ae))[_0x51d6d2(0x25c)],ipaddr=require(_0x51d6d2(0x298)),argv=require(_0x51d6d2(0x195))(process[_0x51d6d2(0x1a3)][_0x51d6d2(0x19c)](0x2))[_0x51d6d2(0x1a3)],PORT=argv[_0x51d6d2(0x271)]||_0x51d6d2(0x1f6),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x51d6d2(0x28d)](PORT))return console[_0x51d6d2(0x2ad)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x51d6d2(0x20f)),process[_0x51d6d2(0x172)](0x1);const HOST=argv[_0x51d6d2(0x2a9)]||null,userID=argv[_0x51d6d2(0x2a4)]||'';let bbpath='bb/';const botfile=_0x51d6d2(0x265),configfile='bb-config.json',settingsfile=_0x51d6d2(0x1ea),securefile=_0x51d6d2(0x2b4);!fs[_0x51d6d2(0x1b8)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath+'clients'),configpath=userID?bbpath+'config/'+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x51d6d2(0x17b);!fs[_0x51d6d2(0x1b8)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x51d6d2(0x1b8)](configbackuppath)&&fs[_0x51d6d2(0x1e3)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x51d6d2(0x213)]({'bots':[]})[_0x51d6d2(0x187)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0}})[_0x51d6d2(0x187)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x51d6d2(0x213)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x51d6d2(0x199),'rsaStandard':_0x51d6d2(0x1df)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath+'version.json')[_0x51d6d2(0x2a1)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();function _0x2bbf(){const _0x388d19=['send','existsSync','get-starting-balances','initclient','push','settings.','Login\x20rejected','/:bot/configuration','handshake','Token\x20blacklisted','value','split','referer','stopped','https://hodlerhacks.com','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Password\x20reset\x20rejected','forEach','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Unauthorized\x20attempt\x20to\x20add\x20bot','conn','emit','reload','store','match','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','jsonwebtoken','access\x20timeout','hasOwnProperty','deleted\x20Bot\x20','No\x20authentication\x20token','/disable\x20-\x20disable\x20notifications\x0a','orders','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','secure','UA-192771731-1','botID','pidRefreshToken','live','RSA-OAEP','constructor','index.html','/:bot/coins','mkdirSync','env','</b>\x20?','bbUsername','sockets','child_process','sortBy','bb-settings.json','secret','login\x20token\x20valid','alerts','login\x20token\x20generated','Allow\x20login\x20from\x20IP\x20address\x20<b>','kill','starting\x20bot\x20|\x20Bot\x20','Unauthorized\x20login\x20attempt\x20(public\x20key)','apiKey','Login\x20accepted','toIPv4Address','3000','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','(((.+)+)+)+$','new-disabled','token','data','loginRequired','generateKeyPairAsync','event','date-fns','bots','verify','password','get-logs','accept','Invalid\x20authentication\x20token\x20(2)','type','join','padStart','node-telegram-bot-api',':\x20Bot\x20Mgr\x20>\x20','-config.json','Balance\x20Bot\x20Server','/off\x20-\x20stop\x20bot(s)\x0a','connection',',\x20must\x20be\x20a\x204\x20digit\x20number','entries','build2','2499825LNnDiD','defaults','temporary\x20access\x20rejected','connected','timeshift','toString','-events.json','::ffff:127.0.0.1','compareSync','encryptedUuid','-results.json','getPortfolio','telegramToken','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','reject','botmanager','apply','348333Gtxozv','telegramEnabled','telegramIpApproval','Bot\x20Mgr\x20>\x20','Unauthorized\x20attempt\x20to\x20delete\x20bot','1000','then','polling_error','new','Alerts',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','find','All','telegramChatId','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Unauthorized\x20attempt\x20to\x20update\x20bot','/:bot/history','decrypt','keys','toIPv4MappedAddress','Notifications\x20enabled\x0a','isIPv4MappedAddress','unlinkSync','from','removeAllListeners','access','notification','sign','9711DfJRjc','kind','order','includes','sendFile','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','uuid','privateKey','function','showname','HTML','/:bot/portfolio','Access\x20enabled\x20for\x20','login','Temporary\x20access\x20rejected','hybrid-crypto-js','started','\x20minutes','callback_query','************','hashSync','name','Balance\x20Bot','restart','createServer','Invalid\x20username\x20or\x20IP\x20address','blacklist','sendMessage','default','botname','bbPassword','inherit','bcryptjs','error\x20while\x20deleting\x20config\x20files:\x20','remoteAddress','<b>Balance\x20Bot\x20status:</b>\x0a','max','bot.js','Unauthorized\x20attempt\x20to\x20update\x20settings','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','/:bot/support','2qiYcRE','disabled','telegram2FaApproval','message','8liysnw','fork','once','You\x20can\x20use\x20the\x20following\x20commands:\x0a','port','isValid','Invalid\x20Telegram\x20token','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','2630235WgcGiO','/:bot/performance','yes','stopPolling','2FA\x20login\x20required','getMonth','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','length','removeListener','Unauthorized\x20attempt\x20to\x20get\x20portfolio','timestamp','static','-----------------------------------------------------------------------------------','server','cloneDeep','f2aRequired','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','build','2FA\x20login\x20rejected','update-bot','Bot\x20','delete-bot','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','settings','test','telegramEvents','No\x20bots\x20running\x20right\x20now','getSeconds','store-configuration','Orders','readdirSync','set','idling\x20bot\x20\x20\x20|\x20Bot\x20','bot','all','ipaddr.js','2996172BWDLZR','hex','add-bot','getMinutes','getHours','All\x20bots\x20running\x20right\x20now','success','storeHeadless','version','cancel-loading','/help\x20-\x20show\x20available\x20commands\x0a','user','answerCallbackQuery','clientip','40164KTKTHR','filter','host','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','use','whitelist','log','@analytics/google-analytics','search','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','parse','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','publicKey','bb-secure.json','\x20|\x20','onText','User\x20has\x20been\x20validated','chat','stop','/restart\x20-\x20restart\x20bot(s)\x0a','randomBytes','All\x20bots','exit','NTBA_FIX_319','getFullYear','RSA','getUTCHours','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','bot-','\x20/\x20','pidExpireLogin','backup/','cancelLoading','whitelistEnabled','\x20only\x0a','15\x20min','expiry','21TrwPyS','show','Invalid\x20IP\x20address','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','ipc','crypto','write','Password\x20has\x20been\x20reset\x20to:\x20','running','starting\x20new\x20bot\x20|\x20Bot\x20','status','express','disconnect','login\x20not\x20required','telegram','Ok,\x20will\x20send\x20alert\x20notifications\x20only','logout','username','2FA\x20required','listen','yargs/yargs','737PYnXcN','get','headers','sha256','enabled','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','slice','reason','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','catch','getTime','remove','30\x20min','argv','disabled\x20Bot\x20','getDate','2222392mGjuhj','9010zVSSSc','telegramUsername','lowdb','temporaryAccessAllowed','error','Unauthorized\x20attempt\x20to\x20store\x20configuration','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','\x20>\x20','assign','path','-performance.json','allow','2FA\x20login\x20token\x20generated','logged\x20out','invalid\x20credentials','login\x20required'];_0x2bbf=function(){return _0x388d19;};return _0x2bbf();}const express=require(_0x51d6d2(0x18c)),app=express(),http=require('http')[_0x51d6d2(0x258)](app);app[_0x51d6d2(0x2ab)](express[_0x51d6d2(0x280)](path['join'](__dirname,bbpath,_0x51d6d2(0x211)))),app['use'](express[_0x51d6d2(0x280)](path[_0x51d6d2(0x207)](__dirname,bbpath,_0x51d6d2(0x286)))),app['get']('/',function(_0x2648d7,_0x450c2c){const _0x2e14a3=_0x51d6d2;_0x450c2c[_0x2e14a3(0x243)](path[_0x2e14a3(0x207)](__dirname,bbpath,'build2',_0x2e14a3(0x1e1)));}),app['get']('/:bot',function(_0x2c8f9f,_0x321678){const _0x5d280c=_0x51d6d2;_0x321678[_0x5d280c(0x243)](path['join'](__dirname,bbpath,'build',_0x5d280c(0x1e1)));}),app[_0x51d6d2(0x197)](_0x51d6d2(0x24b),(_0x558e06,_0xdc36e5)=>{const _0x519364=_0x51d6d2;_0xdc36e5[_0x519364(0x243)](path[_0x519364(0x207)](__dirname,bbpath,_0x519364(0x286),_0x519364(0x1e1)));}),app[_0x51d6d2(0x197)](_0x51d6d2(0x276),(_0x1f7d54,_0x27ddab)=>{const _0xab12ca=_0x51d6d2;_0x27ddab[_0xab12ca(0x243)](path[_0xab12ca(0x207)](__dirname,bbpath,_0xab12ca(0x286),_0xab12ca(0x1e1)));}),app[_0x51d6d2(0x197)](_0x51d6d2(0x1e2),(_0x5708d8,_0xe28bdd)=>{const _0x2da3f6=_0x51d6d2;_0xe28bdd[_0x2da3f6(0x243)](path['join'](__dirname,bbpath,_0x2da3f6(0x286),_0x2da3f6(0x1e1)));}),app[_0x51d6d2(0x197)](_0x51d6d2(0x233),(_0xcc0824,_0x403559)=>{const _0x593e95=_0x51d6d2;_0x403559[_0x593e95(0x243)](path[_0x593e95(0x207)](__dirname,bbpath,_0x593e95(0x286),'index.html'));}),app[_0x51d6d2(0x197)](_0x51d6d2(0x1be),(_0x1be135,_0x1431e2)=>{const _0x29e866=_0x51d6d2;_0x1431e2[_0x29e866(0x243)](path[_0x29e866(0x207)](__dirname,bbpath,_0x29e866(0x286),_0x29e866(0x1e1)));}),app[_0x51d6d2(0x197)](_0x51d6d2(0x268),(_0x272075,_0x56486b)=>{const _0x5ac5a5=_0x51d6d2;_0x56486b[_0x5ac5a5(0x243)](path[_0x5ac5a5(0x207)](__dirname,bbpath,'build',_0x5ac5a5(0x1e1)));});if(HOST)http[_0x51d6d2(0x194)](PORT,HOST);else http[_0x51d6d2(0x194)](PORT);const io=require('socket.io')(http,{}),analytics=analyticsLib({'app':_0x51d6d2(0x256),'plugins':[googleAnalytics({'trackingId':_0x51d6d2(0x1db)})]}),TelegramBot=require(_0x51d6d2(0x209));let tgBot;if(settings['telegramToken']&&settings[_0x51d6d2(0x21e)]!=''&&settings[_0x51d6d2(0x1a8)]&&settings['telegramUsername']!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x5c7aff=_0x51d6d2;console[_0x5c7aff(0x2ad)](''),console[_0x5c7aff(0x2ad)](_0x5c7aff(0x281)),logging(_0x5c7aff(0x27b)+PORT),console[_0x5c7aff(0x2ad)]('-----------------------------------------------------------------------------------');if(config[_0x5c7aff(0x27c)]!=0x0)config[_0x5c7aff(0x1c8)](_0x3c4419=>{const _0x2bb4f3=_0x5c7aff;if(_0x3c4419['status']==_0x2bb4f3(0x19a)||_0x3c4419[_0x2bb4f3(0x18b)]==_0x2bb4f3(0x22b))logging(_0x2bb4f3(0x1f1)+_0x3c4419[_0x2bb4f3(0x1dc)]+_0x2bb4f3(0x2b5)+_0x3c4419[_0x2bb4f3(0x25d)]),startBot([_0x3c4419[_0x2bb4f3(0x1dc)],userID],{'cwd':bbpath},function(_0x28a317){if(_0x28a317)logging(_0x28a317);});else(_0x3c4419[_0x2bb4f3(0x18b)]==_0x2bb4f3(0x26a)||_0x3c4419[_0x2bb4f3(0x18b)]==_0x2bb4f3(0x1f9))&&logging(_0x2bb4f3(0x295)+_0x3c4419[_0x2bb4f3(0x1dc)]+_0x2bb4f3(0x2b5)+_0x3c4419['botname']);});else!newBot&&console[_0x5c7aff(0x2ad)](_0x5c7aff(0x274));if(newBot)addBot();console[_0x5c7aff(0x2ad)](_0x5c7aff(0x281)),console[_0x5c7aff(0x2ad)]('');}function startSocket(){const _0x19749d=_0x51d6d2;io['on'](_0x19749d(0x20e),_0x206884=>{const _0x321772=_0x19749d;let _0x28b126,_0x27acea,_0x32455b,_0x42d6dc,_0x562c14;const _0x102b7c=_0x206884[_0x321772(0x1bf)][_0x321772(0x198)][_0x321772(0x1c3)];_0x27acea=_0x102b7c[_0x321772(0x1d0)](/bot[0-9]{3}/);if(_0x27acea)_0x32455b=_0x27acea[0x0][_0x321772(0x1d0)](/[0-9]{3}/);if(_0x32455b)_0x28b126=_0x32455b[0x0];else _0x28b126=_0x321772(0x221);const _0x49e767=_0x206884['handshake']['auth'][_0x321772(0x21b)];if(!_0x49e767)_0x206884[_0x321772(0x1cd)](_0x321772(0x18b),{'publicKey':secure[_0x321772(0x2b3)]});else{_0x42d6dc=timelyDecrypt(_0x49e767,![]);if(!_0x42d6dc)logging(_0x321772(0x1f2));else{_0x562c14=normalizeIP(_0x206884[_0x321772(0x1cc)][_0x321772(0x262)])[_0x321772(0x1cf)];if(!devices[_0x42d6dc])devices[_0x42d6dc]={'uuid':_0x42d6dc,'access':{'token':null}};devices[_0x42d6dc]['ip']=_0x562c14;const _0x4634a9=addClient(_0x206884['id'],_0x42d6dc,_0x28b126);setAccess(_0x4634a9),_0x206884['on']('login',_0x5baaec=>{const _0x50d44a=_0x321772,_0x5dc465=timelyDecrypt(_0x5baaec[_0x50d44a(0x202)]);if(_0x5dc465){_0x5baaec={'username':_0x5baaec[_0x50d44a(0x192)],'password':_0x5dc465},devices[_0x42d6dc][_0x50d44a(0x23c)]=validateCredentials(_0x5baaec,_0x42d6dc);if(devices[_0x42d6dc][_0x50d44a(0x23c)][_0x50d44a(0x1b2)]==![]&&devices[_0x42d6dc][_0x50d44a(0x23c)][_0x50d44a(0x19d)]==_0x50d44a(0x279))_0x206884[_0x50d44a(0x1cd)]('status',{'access':devices[_0x42d6dc][_0x50d44a(0x23c)]}),loginAccess2FA(_0x42d6dc,_0x562c14);else{if(devices[_0x42d6dc][_0x50d44a(0x23c)][_0x50d44a(0x1b2)]==![]&&devices[_0x42d6dc][_0x50d44a(0x23c)][_0x50d44a(0x19d)]==_0x50d44a(0x1b5))_0x206884[_0x50d44a(0x1cd)](_0x50d44a(0x18b),{'access':devices[_0x42d6dc][_0x50d44a(0x23c)]});else devices[_0x42d6dc]['access'][_0x50d44a(0x1b2)]&&devices[_0x42d6dc]['access'][_0x50d44a(0x19d)]==_0x50d44a(0x1ee)&&(getClientsWithUuid(_0x42d6dc)[_0x50d44a(0x1c8)](_0xdce7b0=>{setAccess(_0xdce7b0);}),setTokenRefresh(_0x42d6dc),setSessionTimeout(_0x50d44a(0x24d),_0x42d6dc));}}else logging('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x206884['on']('reset-password',()=>{resetPassword();}),_0x206884['on'](_0x321772(0x18d),_0x5b32b3=>{removeClient(_0x206884['id']);});}}});}function initClient(_0x275bbd){const _0x4db128=_0x51d6d2;if(_0x275bbd!=_0x4db128(0x221)&&config[_0x4db128(0x1f3)]!=''){if(pid[_0x275bbd])pid[_0x275bbd]['send']({'function':_0x4db128(0x1ba),'args':null});}}function getSocket(_0x3f7158){const _0xc3492e=_0x51d6d2;return io[_0xc3492e(0x1e7)][_0xc3492e(0x1e7)][_0xc3492e(0x197)](_0x3f7158);}function setAccess(_0x1a432a){const _0xd60307=_0x51d6d2,_0x231f27=getSocket(_0x1a432a['id']),_0xc61b3c=_0x1a432a[_0xd60307(0x246)],_0x1e3138=_0x1a432a['bot'];devices[_0xc61b3c][_0xd60307(0x23c)]=validateAccess(devices[_0xc61b3c][_0xd60307(0x23c)][_0xd60307(0x1fa)],_0xc61b3c),_0x231f27[_0xd60307(0x207)](_0xc61b3c);if(devices[_0xc61b3c]['access'][_0xd60307(0x1b2)]){_0x231f27['join'](_0x1e3138);if(_0x1e3138==_0xd60307(0x221))initializeSocketBotManager(_0x231f27);else initializeSocketBot(_0x231f27);initClient(_0x1e3138);}devices[_0xc61b3c][_0xd60307(0x23c)][_0xd60307(0x1fa)]&&devices[_0xc61b3c]['access']['reason']=='temporary\x20token\x20generated'&&setSessionTimeout('2FA',_0xc61b3c),devices[_0xc61b3c][_0xd60307(0x23c)]['token']&&devices[_0xc61b3c][_0xd60307(0x23c)]['reason']==_0xd60307(0x1b3)&&setSessionTimeout(_0xd60307(0x24d),_0xc61b3c),_0x231f27['emit']('status',{'status':_0x1a432a[_0xd60307(0x282)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0xc61b3c]['access'],'externalip':devices[_0xc61b3c]['ip'],'publicKey':secure[_0xd60307(0x2b3)]}),devices[_0xc61b3c]['access'][_0xd60307(0x1b2)]==![]&&devices[_0xc61b3c][_0xd60307(0x23c)][_0xd60307(0x19d)]==_0xd60307(0x193)&&temporaryAccess2FA(_0xc61b3c,devices[_0xc61b3c]['ip']);}function setSessionTimeout(_0x48fa7a,_0x1e9155){const _0x78e627=_0x51d6d2;let _0x5e4912;if(_0x48fa7a==_0x78e627(0x24d))_0x5e4912=loginExpiry*0x3c*0x3e8;else _0x5e4912=devices[_0x1e9155][_0x78e627(0x225)][_0x78e627(0x180)]*0x3c*0x3e8-(new Date()[_0x78e627(0x1a0)]()-devices[_0x1e9155][_0x78e627(0x225)]['timestamp']);if(devices[_0x1e9155][_0x78e627(0x17a)])clearTimeout(devices[_0x1e9155][_0x78e627(0x17a)]);devices[_0x1e9155]['pidExpireLogin']=setTimeout(()=>{const _0x24c07b=_0x78e627;if(devices[_0x1e9155][_0x24c07b(0x1dd)])clearTimeout(devices[_0x1e9155][_0x24c07b(0x1dd)]);removeSocketListeners(_0x1e9155),addBlacklist(_0x1e9155),devices[_0x1e9155][_0x24c07b(0x225)]=null,devices[_0x1e9155][_0x24c07b(0x26b)]=null,devices[_0x1e9155][_0x24c07b(0x23c)][_0x24c07b(0x1fa)]=null,devices[_0x1e9155][_0x24c07b(0x23c)]=validateAccess(devices[_0x1e9155]['access'][_0x24c07b(0x1fa)],_0x1e9155),!(devices[_0x1e9155][_0x24c07b(0x23c)][_0x24c07b(0x1b2)]&&devices[_0x1e9155][_0x24c07b(0x23c)][_0x24c07b(0x19d)]=='login\x20not\x20required')&&(_0x48fa7a==_0x24c07b(0x24d)?io['to'](_0x1e9155)[_0x24c07b(0x1cd)](_0x24c07b(0x18b),{'access':{'allow':![],'reason':_0x24c07b(0x1d3),'token':null}}):io['to'](_0x1e9155)[_0x24c07b(0x1cd)](_0x24c07b(0x18b),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x1e9155]['access'][_0x24c07b(0x1fa)]=null;},_0x5e4912);}function setTokenRefresh(_0x3584fa){const _0xbb7632=_0x51d6d2;if(devices[_0x3584fa]['pidRefreshToken'])clearTimeout(devices[_0x3584fa][_0xbb7632(0x1dd)]);devices[_0x3584fa][_0xbb7632(0x1dd)]=setTimeout(()=>{const _0x4bc041=_0xbb7632;getClientsWithUuid(_0x3584fa)[_0x4bc041(0x27c)]!=0x0?(devices[_0x3584fa]['access']=refreshToken(_0x3584fa),io['to'](_0x3584fa)[_0x4bc041(0x1cd)]('status',{'status':_0x4bc041(0x215),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x3584fa][_0x4bc041(0x23c)],'externalip':devices[_0x3584fa]['ip'],'publicKey':secure[_0x4bc041(0x2b3)]}),setTokenRefresh(_0x3584fa)):clearTimeout(devices[_0x3584fa]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x235c36){const _0x27f0b1=_0x51d6d2,_0x487c27=getClient(_0x235c36['id'])[_0x27f0b1(0x246)];_0x235c36[_0x27f0b1(0x1cd)](_0x27f0b1(0x200),config),_0x235c36[_0x27f0b1(0x1cd)](_0x27f0b1(0x28c),cleanSettings()),_0x235c36['on'](_0x27f0b1(0x29b),_0x39714d=>{const _0xaf138f=_0x27f0b1;if(validateAccess(_0x39714d,_0x487c27)['allow'])addBot();else logging(_0xaf138f(0x1cb));}),_0x235c36['on'](_0x27f0b1(0x288),(_0x3832ba,_0x1f5530)=>{const _0x249d8d=_0x27f0b1;if(validateAccess(_0x1f5530,_0x487c27)[_0x249d8d(0x1b2)])toggleBot(_0x3832ba['botID'],_0x3832ba[_0x249d8d(0x18b)],_0x3832ba['live']);else logging(_0x249d8d(0x232));}),_0x235c36['on'](_0x27f0b1(0x28a),(_0x3502a6,_0x4bc202)=>{const _0x5c0ffe=_0x27f0b1;if(validateAccess(_0x4bc202,_0x487c27)['allow'])deleteBot(_0x3502a6);else logging(_0x5c0ffe(0x227));}),_0x235c36['on']('store-settings',(_0x26517a,_0x517821)=>{const _0x4d247c=_0x27f0b1;if(validateAccess(_0x517821,_0x487c27)[_0x4d247c(0x1b2)])storeSettings(_0x26517a,!![]);else logging(_0x4d247c(0x266));}),_0x235c36['on'](_0x27f0b1(0x191),_0x27ce62=>{const _0x496244=_0x27f0b1;if(validateAccess(_0x27ce62,_0x487c27)[_0x496244(0x1b2)]){if(devices[_0x487c27][_0x496244(0x1dd)])clearTimeout(devices[_0x487c27][_0x496244(0x1dd)]);if(devices[_0x487c27][_0x496244(0x17a)])clearTimeout(devices[_0x487c27][_0x496244(0x17a)]);removeSocketListeners(getClient(_0x235c36['id'])['uuid']),addBlacklist(_0x487c27),devices[_0x487c27][_0x496244(0x225)]=null,devices[_0x487c27][_0x496244(0x26b)]=null,devices[_0x487c27]['access'][_0x496244(0x1fa)]=null,io['to'](getClient(_0x235c36['id'])['uuid'])[_0x496244(0x1cd)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x41908b){const _0x21bd1d=_0x51d6d2,_0x2aa6cc=getClient(_0x41908b['id'])[_0x21bd1d(0x296)],_0x27a318=getClient(_0x41908b['id'])[_0x21bd1d(0x246)];_0x41908b['on'](_0x21bd1d(0x203),(_0xadb832,_0x39dd0c)=>{const _0x59b28d=_0x21bd1d;if(validateAccess(_0x39dd0c,_0x27a318)[_0x59b28d(0x1b2)]){if(pid[_0x2aa6cc])pid[_0x2aa6cc][_0x59b28d(0x1b7)]({'function':'emitHistory','args':_0xadb832});}else logging('Unauthorized\x20attempt\x20to\x20get\x20logs');}),_0x41908b['on']('get-portfolio',(_0x2f30e1,_0x40ba9d)=>{const _0x16012e=_0x21bd1d;if(validateAccess(_0x40ba9d,_0x27a318)[_0x16012e(0x1b2)]){if(pid[_0x2aa6cc])pid[_0x2aa6cc]['send']({'function':_0x16012e(0x21d),'args':_0x2f30e1});}else logging(_0x16012e(0x27e));}),_0x41908b['on'](_0x21bd1d(0x291),(_0x94e04a,_0x57cb50)=>{const _0x843d17=_0x21bd1d;if(validateAccess(_0x57cb50,_0x27a318)[_0x843d17(0x1b2)]){if(pid[_0x2aa6cc])pid[_0x2aa6cc]['send']({'function':'storeConfiguration','args':_0x94e04a});}else logging(_0x843d17(0x1ac));}),_0x41908b['on']('store-headless',(_0x144be7,_0x182180)=>{const _0x51c627=_0x21bd1d;if(validateAccess(_0x182180,_0x27a318)[_0x51c627(0x1b2)]){if(pid[_0x2aa6cc])pid[_0x2aa6cc]['send']({'function':_0x51c627(0x2a0),'args':_0x144be7});}else logging('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x41908b['on'](_0x21bd1d(0x1b9),_0x997aa=>{const _0x5255b5=_0x21bd1d;if(validateAccess(_0x997aa,_0x27a318)['allow']){if(pid[_0x2aa6cc])pid[_0x2aa6cc]['send']({'function':'getStartingBalances','args':null});}else logging(_0x5255b5(0x231));}),_0x41908b['on']('place-order',(_0x2eda4e,_0x296b7b)=>{const _0xad2a4d=_0x21bd1d;if(validateAccess(_0x296b7b,_0x27a318)['allow']){if(pid[_0x2aa6cc])pid[_0x2aa6cc][_0xad2a4d(0x1b7)]({'function':'placeOrder','args':_0x2eda4e});}else logging(_0xad2a4d(0x245));}),_0x41908b['on'](_0x21bd1d(0x2a2),_0x4d7397=>{const _0x5987aa=_0x21bd1d;if(validateAccess(_0x4d7397,_0x27a318)['allow']){if(pid[_0x2aa6cc])pid[_0x2aa6cc][_0x5987aa(0x1b7)]({'function':_0x5987aa(0x17c),'args':null});}else logging(_0x5987aa(0x1d1));}),_0x41908b['on'](_0x21bd1d(0x191),_0x532d0c=>{const _0x339c47=_0x21bd1d;if(validateAccess(_0x532d0c,_0x27a318)['allow']){if(devices[_0x27a318][_0x339c47(0x1dd)])clearTimeout(devices[_0x27a318][_0x339c47(0x1dd)]);if(devices[_0x27a318][_0x339c47(0x17a)])clearTimeout(devices[_0x27a318][_0x339c47(0x17a)]);removeSocketListeners(getClient(_0x41908b['id'])['uuid']),addBlacklist(_0x27a318),devices[_0x27a318]['telegramIpApproval']=null,devices[_0x27a318][_0x339c47(0x26b)]=null,devices[_0x27a318]['access']['token']=null,io['to'](getClient(_0x41908b['id'])[_0x339c47(0x246)])['emit']('status',{'access':{'allow':![],'reason':_0x339c47(0x1b4),'token':null}});}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x40c17c){const _0x2201b9=_0x51d6d2;getClientsWithUuid(_0x40c17c)[_0x2201b9(0x1c8)](_0x33aeb5=>{const _0x16c1d6=_0x2201b9;getSocket(_0x33aeb5['id'])[_0x16c1d6(0x23b)]();});}function cleanSettings(){const _0x3a211e=_0x51d6d2;let _0x5828f9=settings;return settings['telegramToken']&&settings[_0x3a211e(0x21e)]!=''&&(_0x5828f9={..._0x5828f9,'telegramToken':_0x3a211e(0x253)}),settings[_0x3a211e(0x25e)]&&settings[_0x3a211e(0x25e)]!=''&&(_0x5828f9={..._0x5828f9,'bbPassword':_0x3a211e(0x253)}),_0x5828f9;}function startBot(_0x51bc2d,_0x137098,_0x4fa78d){const _0x55e5ac=_0x51d6d2;let _0x266a7c=![];const _0x2a12e6=_0x51bc2d[0x0];_0x137098={..._0x137098,'stdio':[_0x55e5ac(0x25f),_0x55e5ac(0x25f),'inherit',_0x55e5ac(0x185)]},pid[_0x2a12e6]=childProcess[_0x55e5ac(0x26e)](botfile,_0x51bc2d,_0x137098),pid[_0x2a12e6]['on']('message',_0xda5245=>{const _0x57b3b9=_0x55e5ac;switch(Object[_0x57b3b9(0x235)](_0xda5245)[0x0]){case _0x57b3b9(0x25d):updateBotName(_0x2a12e6,_0xda5245[_0x57b3b9(0x25d)]);break;case _0x57b3b9(0x18b):updateStatus(_0x2a12e6,_0xda5245[_0x57b3b9(0x18b)]);break;case'live':updateLive(_0x2a12e6,_0xda5245[_0x57b3b9(0x1de)]);break;case'started':updateLive(_0x2a12e6,_0xda5245[_0x57b3b9(0x250)]),io['to'](_0x2a12e6)[_0x57b3b9(0x1cd)](_0x57b3b9(0x18b),{'access':{'allow':![],'reason':_0x57b3b9(0x1ce),'token':null}});break;case _0x57b3b9(0x2b9):_0xda5245[_0x57b3b9(0x2b9)]==_0x57b3b9(0x257)&&stopBot(_0x2a12e6);_0xda5245[_0x57b3b9(0x2b9)]=='kill'&&toggleBot(_0x2a12e6,'disabled',_0x57b3b9(0x1c4));break;case _0x57b3b9(0x18f):sendTelegram(_0x2a12e6,_0xda5245[_0x57b3b9(0x18f)]);break;case'function':io['to'](_0x2a12e6)[_0x57b3b9(0x1cd)](_0xda5245[_0x57b3b9(0x248)],_0xda5245['args']);break;}}),pid[_0x2a12e6]['on'](_0x55e5ac(0x1ab),function(_0x16f6cf){if(_0x266a7c)return;_0x266a7c=!![],_0x4fa78d(_0x16f6cf);}),pid[_0x2a12e6]['on'](_0x55e5ac(0x172),function(_0x5e6162){const _0x45da6a=_0x55e5ac;if(_0x266a7c)return;_0x266a7c=!![],_0x4fa78d(null);const _0x577298=dbConfig['get'](_0x45da6a(0x200))['find']({'botID':_0x2a12e6})[_0x45da6a(0x1c1)]();_0x577298&&(_0x577298[_0x45da6a(0x18b)]==_0x45da6a(0x19a)||_0x577298[_0x45da6a(0x18b)]=='new')&&(updateLive(_0x2a12e6,_0x45da6a(0x1c4)),logging('restarting\x20Bot\x20'+_0x2a12e6),startBot([_0x2a12e6,userID],{'cwd':bbpath},function(_0x378aed){if(_0x378aed)logging(_0x378aed);}));});}function stopBot(_0x53b59c){const _0x11ee68=_0x51d6d2;getClientsWithBotID(_0x53b59c)['forEach'](_0x7bd80a=>{const _0x4aabe9=_0x12b1;getSocket(_0x7bd80a['id'])[_0x4aabe9(0x18d)](!![]),removeClient(_0x7bd80a['id']);});if(pid[_0x53b59c])pid[_0x53b59c][_0x11ee68(0x1f0)]();}function addBot(){const _0x34d09b=_0x51d6d2;let _0x472091;for(let _0x39c01c=0x1;_0x39c01c<0x3e9;_0x39c01c++){_0x472091=_0x39c01c[_0x34d09b(0x217)]()[_0x34d09b(0x208)](0x3,'0');let _0x559f29=config[_0x34d09b(0x22e)](_0x284719=>_0x284719['botID']==_0x472091);if(!_0x559f29)break;}if(_0x472091===_0x34d09b(0x228)){logging(_0x34d09b(0x19e));return;}logging(_0x34d09b(0x18a)+_0x472091),dbConfig['get']('bots')[_0x34d09b(0x1bb)]({'botID':_0x472091,'botname':'Bot\x20'+_0x472091,'status':_0x34d09b(0x22b),'live':''})[_0x34d09b(0x187)](),startBot([_0x472091,userID],{'cwd':bbpath},function(_0xfa418f){if(_0xfa418f)logging(_0xfa418f);}),config=getConfiguration(),io['to'](_0x34d09b(0x221))['emit'](_0x34d09b(0x200),config);}function deleteBot(_0x31c91e){const _0x5d306c=_0x51d6d2;getClientsWithBotID(_0x31c91e)[_0x5d306c(0x1c8)](_0x1b4ff5=>{const _0x4d9e8f=_0x5d306c;getSocket(_0x1b4ff5['id'])[_0x4d9e8f(0x18d)](!![]),removeClient(_0x1b4ff5['id']);}),dbConfig[_0x5d306c(0x197)](_0x5d306c(0x200))[_0x5d306c(0x1a1)]({'botID':_0x31c91e})[_0x5d306c(0x187)](),logging(_0x5d306c(0x1d5)+_0x31c91e),stopBot(_0x31c91e);try{fs[_0x5d306c(0x239)](path[_0x5d306c(0x207)](configpath,_0x5d306c(0x178)+_0x31c91e+_0x5d306c(0x20b))),fs[_0x5d306c(0x239)](path[_0x5d306c(0x207)](configpath,_0x5d306c(0x178)+_0x31c91e+_0x5d306c(0x218))),fs[_0x5d306c(0x239)](path[_0x5d306c(0x207)](configpath,_0x5d306c(0x178)+_0x31c91e+_0x5d306c(0x1b1))),fs[_0x5d306c(0x239)](path['join'](configpath,'bot-'+_0x31c91e+_0x5d306c(0x21c)));}catch(_0x231ffe){if(_0x231ffe)logging(_0x5d306c(0x261),_0x231ffe);}config=getConfiguration(),io['to']('botmanager')[_0x5d306c(0x1cd)](_0x5d306c(0x200),config);}function toggleBot(_0xc8a761,_0x3a47fc,_0x3ab0b8){const _0xc97758=_0x51d6d2;dbConfig[_0xc97758(0x197)](_0xc97758(0x200))[_0xc97758(0x22e)]({'botID':_0xc8a761})[_0xc97758(0x1af)]({'status':_0x3a47fc})['assign']({'live':_0x3ab0b8})['write']();if(_0x3a47fc==_0xc97758(0x19a)||_0x3a47fc==_0xc97758(0x22b))logging('enabled\x20Bot\x20'+_0xc8a761),startBot([_0xc8a761,userID],{'cwd':bbpath},function(_0x3f7ec3){if(_0x3f7ec3)logging(_0x3f7ec3);});else(_0x3a47fc=='disabled'||_0x3a47fc=='new-disabled')&&(logging(_0xc97758(0x1a4)+_0xc8a761),stopBot(_0xc8a761));config=getConfiguration(),io['to'](_0xc97758(0x221))[_0xc97758(0x1cd)]('bots',config);}function toggleStatus(_0xb8d85c){const _0x8a4f78=_0x51d6d2;let _0x24a825=dbConfig[_0x8a4f78(0x197)](_0x8a4f78(0x200))[_0x8a4f78(0x22e)]({'botID':_0xb8d85c})[_0x8a4f78(0x1c1)](),_0x2626bc;if(_0x24a825[_0x8a4f78(0x18b)]==='enabled')_0x2626bc=_0x8a4f78(0x26a);else{if(_0x24a825[_0x8a4f78(0x18b)]==='new')_0x2626bc=_0x8a4f78(0x1f9);else{if(_0x24a825[_0x8a4f78(0x18b)]===_0x8a4f78(0x1f9))_0x2626bc=_0x8a4f78(0x22b);else{if(_0x24a825['status']==='disabled')_0x2626bc=_0x8a4f78(0x19a);}}}return _0x2626bc;}function updateStatus(_0xaba94,_0x16662a){const _0x2d9bcf=_0x51d6d2;dbConfig['get'](_0x2d9bcf(0x200))[_0x2d9bcf(0x22e)]({'botID':_0xaba94})['assign']({'status':_0x16662a})['write'](),config=getConfiguration(),io['to'](_0x2d9bcf(0x221))['emit'](_0x2d9bcf(0x200),config);}function updateLive(_0x4483f2,_0x2fcc04){const _0x3d6931=_0x51d6d2;dbConfig[_0x3d6931(0x197)](_0x3d6931(0x200))[_0x3d6931(0x22e)]({'botID':_0x4483f2})[_0x3d6931(0x1af)]({'live':_0x2fcc04})[_0x3d6931(0x187)](),config=getConfiguration(),io['to']('botmanager')[_0x3d6931(0x1cd)](_0x3d6931(0x200),config);}function updateBotName(_0x6c8849,_0x203417){const _0x2a3873=_0x51d6d2;dbConfig['get'](_0x2a3873(0x200))[_0x2a3873(0x22e)]({'botID':_0x6c8849})[_0x2a3873(0x1af)]({'botname':_0x203417})[_0x2a3873(0x187)](),config=getConfiguration(),io['to']('botmanager')[_0x2a3873(0x1cd)]('bots',config);}function telegramError(_0x2c35ea){const _0x5e77d0=_0x51d6d2;console[_0x5e77d0(0x2ad)](getTimeStamp()+_0x5e77d0(0x22d));}function validateTelegram(_0x4e70f3){const _0x4b2af5=_0x51d6d2;if(_0x4e70f3[_0x4b2af5(0x23a)][_0x4b2af5(0x192)]!=settings[_0x4b2af5(0x1a8)]&&'@'+_0x4e70f3[_0x4b2af5(0x23a)]['username']!=settings[_0x4b2af5(0x1a8)])return tgBot[_0x4b2af5(0x25b)](_0x4e70f3['chat']['id'],_0x4b2af5(0x184),{'parse_mode':_0x4b2af5(0x24a)})['catch'](_0xb2ffbc=>{telegramError(_0xb2ffbc);}),![];return!![];}async function initTelegram(){const _0x18e6cf=_0x51d6d2;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x86b5f=_0x18e6cf(0x270);_0x86b5f+='\x0a',_0x86b5f+='/enable\x20-\x20enable\x20notifications\x0a',_0x86b5f+=_0x18e6cf(0x1d7),_0x86b5f+=_0x18e6cf(0x2b0),_0x86b5f+=_0x18e6cf(0x16f),_0x86b5f+='/on\x20-\x20start\x20bot(s)\x0a',_0x86b5f+=_0x18e6cf(0x20d),_0x86b5f+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x86b5f+=_0x18e6cf(0x2a3);let _0xf05017=_0x18e6cf(0x177);_0xf05017+='\x0a',_0xf05017+=_0x86b5f,tgBot[_0x18e6cf(0x2b6)](/\/start/,_0x1b8eeb=>{const _0x38aa50=_0x18e6cf;if(!validateTelegram(_0x1b8eeb))return;if(settings[_0x38aa50(0x230)]!=_0x1b8eeb[_0x38aa50(0x2b8)]['id'])updateSetting('telegramChatId',_0x1b8eeb[_0x38aa50(0x2b8)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x38aa50(0x25b)](_0x1b8eeb[_0x38aa50(0x2b8)]['id'],_0xf05017)[_0x38aa50(0x19f)](_0x3fda46=>{telegramError(_0x3fda46);});}),tgBot[_0x18e6cf(0x2b6)](/\/enable/,_0x16d832=>{const _0x337840=_0x18e6cf;if(!validateTelegram(_0x16d832))return;if(settings[_0x337840(0x230)]!=_0x16d832[_0x337840(0x2b8)]['id'])updateSetting('telegramChatId',_0x16d832[_0x337840(0x2b8)]['id']);updateSetting(_0x337840(0x224),!![]),tgBot[_0x337840(0x25b)](_0x16d832['chat']['id'],'Notifications\x20enabled')[_0x337840(0x19f)](_0x3c510a=>{telegramError(_0x3c510a);});}),tgBot[_0x18e6cf(0x2b6)](/\/config/,async _0x1c8407=>{const _0x45918d=_0x18e6cf;if(!validateTelegram(_0x1c8407))return;tgBot[_0x45918d(0x27d)](_0x45918d(0x252)),tgBot['sendMessage'](_0x1c8407[_0x45918d(0x2b8)]['id'],_0x45918d(0x19b),{'reply_markup':{'inline_keyboard':[[{'text':_0x45918d(0x292),'callback_data':_0x45918d(0x1d8)},{'text':_0x45918d(0x22c),'callback_data':_0x45918d(0x1ed)},{'text':_0x45918d(0x22f),'callback_data':_0x45918d(0x297)}]]}})[_0x45918d(0x19f)](_0x5e4b71=>{telegramError(_0x5e4b71);}),tgBot['on'](_0x45918d(0x252),async _0x3a8b27=>{const _0x528426=_0x45918d,_0x2e39e7=_0x3a8b27[_0x528426(0x1fb)],_0x46f899=_0x3a8b27[_0x528426(0x26c)];tgBot[_0x528426(0x2a5)](_0x3a8b27['id'])['then'](async()=>{const _0x4f72d9=_0x528426;_0x2e39e7==_0x4f72d9(0x1d8)&&(updateSetting(_0x4f72d9(0x28e),'orders'),updateSetting(_0x4f72d9(0x224),!![]),await tgBot[_0x4f72d9(0x25b)](_0x46f899['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')['catch'](_0x426e6d=>{telegramError(_0x426e6d);}));_0x2e39e7=='alerts'&&(updateSetting(_0x4f72d9(0x28e),_0x4f72d9(0x1ed)),updateSetting(_0x4f72d9(0x224),!![]),await tgBot[_0x4f72d9(0x25b)](_0x46f899[_0x4f72d9(0x2b8)]['id'],_0x4f72d9(0x190))['catch'](_0xbd9984=>{telegramError(_0xbd9984);}));_0x2e39e7==_0x4f72d9(0x297)&&(updateSetting(_0x4f72d9(0x28e),_0x4f72d9(0x297)),updateSetting(_0x4f72d9(0x224),!![]),await tgBot['sendMessage'](_0x46f899['chat']['id'],_0x4f72d9(0x1c6))['catch'](_0x418f12=>{telegramError(_0x418f12);}));if(!settings['telegramChatId'])tgBot[_0x4f72d9(0x25b)](_0x46f899[_0x4f72d9(0x2b8)]['id'],_0x4f72d9(0x21f))[_0x4f72d9(0x19f)](_0x22b119=>{telegramError(_0x22b119);});}),tgBot['removeListener'](_0x528426(0x252));});}),tgBot[_0x18e6cf(0x2b6)](/\/status/,_0x209397=>{const _0x620372=_0x18e6cf;if(!validateTelegram(_0x209397))return;let _0x1752b5=_0x620372(0x263);config[_0x620372(0x1c8)](_0x1ff70e=>{const _0x55cecc=_0x620372;_0x1752b5+=_0x55cecc(0x289)+_0x1ff70e[_0x55cecc(0x1dc)]+'\x20|\x20'+_0x1ff70e['botname']+':\x20'+_0x1ff70e[_0x55cecc(0x18b)]+_0x55cecc(0x179)+_0x1ff70e[_0x55cecc(0x1de)]+'\x0a';}),_0x1752b5+='\x0a',_0x1752b5+='<b>Telegram\x20bot\x20status:</b>\x0a',_0x1752b5+=!settings[_0x620372(0x224)]?'Notifications\x20disabled\x0a':_0x620372(0x237),_0x1752b5+=settings['telegramEnabled']?settings['telegramEvents']=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings['telegramEvents']+_0x620372(0x17e):'',tgBot[_0x620372(0x25b)](_0x209397[_0x620372(0x2b8)]['id'],_0x1752b5,{'parse_mode':'HTML'})[_0x620372(0x19f)](_0x5816d1=>{telegramError(_0x5816d1);});}),tgBot[_0x18e6cf(0x2b6)](/\/restart/,_0x4ebbb6=>{const _0x3cb23a=_0x18e6cf;if(!validateTelegram(_0x4ebbb6))return;tgBot[_0x3cb23a(0x27d)](_0x3cb23a(0x252));const _0x15f0a8=getEnabledBots();if(_0x15f0a8[_0x3cb23a(0x27c)]==0x0)tgBot[_0x3cb23a(0x25b)](_0x4ebbb6[_0x3cb23a(0x2b8)]['id'],'No\x20bots\x20running\x20right\x20now')['catch'](_0x5f03c3=>{telegramError(_0x5f03c3);});else{if(_0x15f0a8[_0x3cb23a(0x27c)]>0x1)_0x15f0a8[_0x3cb23a(0x1bb)]({'botID':_0x3cb23a(0x297)});let _0x34ee15=[],_0x4b23cd=[];const _0x112ca0=_0x15f0a8[_0x3cb23a(0x27c)]%0x4==0x0||_0x15f0a8[_0x3cb23a(0x27c)]%0x4==0x3||_0x15f0a8[_0x3cb23a(0x27c)]%0x3==0x1?0x4:0x3;let _0x53dc3a=0x0;_0x15f0a8[_0x3cb23a(0x1c8)]((_0x516259,_0x34e284)=>{const _0x3d9ac2=_0x3cb23a;if(_0x34e284%_0x112ca0==0x0)_0x4b23cd=[];_0x4b23cd[_0x3d9ac2(0x1bb)]({'text':_0x516259[_0x3d9ac2(0x1dc)]==_0x3d9ac2(0x297)?_0x3d9ac2(0x171):_0x3d9ac2(0x289)+_0x516259['botID'],'callback_data':_0x516259[_0x3d9ac2(0x1dc)]}),_0x34e284%_0x112ca0==0x0&&(_0x34ee15[_0x53dc3a]=_0x4b23cd,_0x53dc3a++);}),tgBot[_0x3cb23a(0x25b)](_0x4ebbb6[_0x3cb23a(0x2b8)]['id'],_0x3cb23a(0x267),{'reply_markup':{'inline_keyboard':_0x34ee15}})[_0x3cb23a(0x19f)](_0x3a3b1a=>{telegramError(_0x3a3b1a);}),tgBot['on'](_0x3cb23a(0x252),async _0x5e2f3f=>{const _0x423d71=_0x3cb23a,_0x395a85=_0x5e2f3f[_0x423d71(0x1fb)],_0x1f4ead=_0x5e2f3f[_0x423d71(0x26c)];tgBot[_0x423d71(0x2a5)](_0x5e2f3f['id'])['then'](async()=>{const _0x370693=_0x423d71;if(_0x395a85==_0x370693(0x297)){if(settings[_0x370693(0x28e)]==_0x370693(0x1d8))tgBot['sendMessage'](_0x1f4ead[_0x370693(0x2b8)]['id'],_0x370693(0x2aa))[_0x370693(0x19f)](_0x76a231=>{telegramError(_0x76a231);});config['forEach'](_0x24c526=>{stopBot(_0x24c526['botID']);});}else{if(settings[_0x370693(0x28e)]==_0x370693(0x1d8))tgBot['sendMessage'](_0x1f4ead[_0x370693(0x2b8)]['id'],_0x370693(0x285)+_0x395a85)[_0x370693(0x19f)](_0x57db04=>{telegramError(_0x57db04);});stopBot(_0x395a85);}}),tgBot[_0x423d71(0x27d)](_0x423d71(0x252));});}}),tgBot['onText'](/\/on/,_0x149b95=>{const _0x2b5114=_0x18e6cf;if(!validateTelegram(_0x149b95))return;tgBot[_0x2b5114(0x27d)](_0x2b5114(0x252));const _0x34dd3d=getDisabledBots();if(_0x34dd3d['length']==0x0)tgBot['sendMessage'](_0x149b95['chat']['id'],_0x2b5114(0x29e))[_0x2b5114(0x19f)](_0x45604e=>{telegramError(_0x45604e);});else{if(_0x34dd3d['length']>0x1)_0x34dd3d[_0x2b5114(0x1bb)]({'botID':_0x2b5114(0x297)});let _0x4c07a4=[],_0x29349a=[];const _0x284e50=_0x34dd3d[_0x2b5114(0x27c)]%0x4==0x0||_0x34dd3d[_0x2b5114(0x27c)]%0x4==0x3||_0x34dd3d[_0x2b5114(0x27c)]%0x3==0x1?0x4:0x3;let _0x31a3d5=0x0;_0x34dd3d[_0x2b5114(0x1c8)]((_0x9c3d1b,_0x1ac380)=>{const _0x33577c=_0x2b5114;if(_0x1ac380%_0x284e50==0x0)_0x29349a=[];_0x29349a[_0x33577c(0x1bb)]({'text':_0x9c3d1b[_0x33577c(0x1dc)]==_0x33577c(0x297)?_0x33577c(0x171):_0x33577c(0x289)+_0x9c3d1b[_0x33577c(0x1dc)],'callback_data':_0x9c3d1b[_0x33577c(0x1dc)]}),_0x1ac380%_0x284e50==0x0&&(_0x4c07a4[_0x31a3d5]=_0x29349a,_0x31a3d5++);}),tgBot[_0x2b5114(0x25b)](_0x149b95['chat']['id'],_0x2b5114(0x1d9),{'reply_markup':{'inline_keyboard':_0x4c07a4}})[_0x2b5114(0x19f)](_0x41ea32=>{telegramError(_0x41ea32);}),tgBot['on'](_0x2b5114(0x252),async _0x5b0a40=>{const _0x48aca6=_0x2b5114,_0x3de4fa=_0x5b0a40['data'],_0x38c6d7=_0x5b0a40[_0x48aca6(0x26c)];tgBot[_0x48aca6(0x2a5)](_0x5b0a40['id'])[_0x48aca6(0x229)](async()=>{const _0x2aa3f7=_0x48aca6;if(_0x3de4fa==_0x2aa3f7(0x297)){if(settings[_0x2aa3f7(0x28e)]==_0x2aa3f7(0x1d8))tgBot[_0x2aa3f7(0x25b)](_0x38c6d7[_0x2aa3f7(0x2b8)]['id'],_0x2aa3f7(0x2b2))['catch'](_0x2417e9=>{telegramError(_0x2417e9);});_0x34dd3d['forEach'](_0xc01a45=>{const _0x145f18=_0x2aa3f7;if(_0xc01a45[_0x145f18(0x1dc)]!=_0x145f18(0x297))toggleBot(_0xc01a45['botID'],toggleStatus(_0xc01a45[_0x145f18(0x1dc)]),_0x145f18(0x1c4));});}else{if(settings[_0x2aa3f7(0x28e)]==_0x2aa3f7(0x1d8))tgBot[_0x2aa3f7(0x25b)](_0x38c6d7['chat']['id'],_0x2aa3f7(0x1c9)+_0x3de4fa)['catch'](_0x2798f4=>{telegramError(_0x2798f4);});toggleBot(_0x3de4fa,toggleStatus(_0x3de4fa),'stopped');}}),tgBot[_0x48aca6(0x27d)]('callback_query');});}}),tgBot[_0x18e6cf(0x2b6)](/\/off/,_0x41b96a=>{const _0x5ccbd7=_0x18e6cf;if(!validateTelegram(_0x41b96a))return;tgBot[_0x5ccbd7(0x27d)]('callback_query');const _0x4c6ce3=getEnabledBots();if(_0x4c6ce3[_0x5ccbd7(0x27c)]==0x0)tgBot[_0x5ccbd7(0x25b)](_0x41b96a[_0x5ccbd7(0x2b8)]['id'],_0x5ccbd7(0x28f))[_0x5ccbd7(0x19f)](_0x352869=>{telegramError(_0x352869);});else{if(_0x4c6ce3[_0x5ccbd7(0x27c)]>0x1)_0x4c6ce3[_0x5ccbd7(0x1bb)]({'botID':_0x5ccbd7(0x297)});let _0x4c7dae=[],_0x46f288=[];const _0x5e7e67=_0x4c6ce3[_0x5ccbd7(0x27c)]%0x4==0x0||_0x4c6ce3[_0x5ccbd7(0x27c)]%0x4==0x3||_0x4c6ce3[_0x5ccbd7(0x27c)]%0x3==0x1?0x4:0x3;let _0x33ffa9=0x0;_0x4c6ce3[_0x5ccbd7(0x1c8)]((_0x2ccbb1,_0x3b1cd6)=>{const _0x2707a2=_0x5ccbd7;if(_0x3b1cd6%_0x5e7e67==0x0)_0x46f288=[];_0x46f288['push']({'text':_0x2ccbb1[_0x2707a2(0x1dc)]==_0x2707a2(0x297)?_0x2707a2(0x171):_0x2707a2(0x289)+_0x2ccbb1['botID'],'callback_data':_0x2ccbb1[_0x2707a2(0x1dc)]}),_0x3b1cd6%_0x5e7e67==0x0&&(_0x4c7dae[_0x33ffa9]=_0x46f288,_0x33ffa9++);}),tgBot[_0x5ccbd7(0x25b)](_0x41b96a[_0x5ccbd7(0x2b8)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',{'reply_markup':{'inline_keyboard':_0x4c7dae}})[_0x5ccbd7(0x19f)](_0x4ebf1c=>{telegramError(_0x4ebf1c);}),tgBot['on'](_0x5ccbd7(0x252),async _0x2586a6=>{const _0x1f7f28=_0x5ccbd7,_0x475354=_0x2586a6[_0x1f7f28(0x1fb)],_0x326e7f=_0x2586a6['message'];tgBot[_0x1f7f28(0x2a5)](_0x2586a6['id'])[_0x1f7f28(0x229)](async()=>{const _0x27ac1d=_0x1f7f28;if(_0x475354==_0x27ac1d(0x297)){if(settings[_0x27ac1d(0x28e)]==_0x27ac1d(0x1d8))tgBot['sendMessage'](_0x326e7f[_0x27ac1d(0x2b8)]['id'],_0x27ac1d(0x244))[_0x27ac1d(0x19f)](_0x52ef87=>{telegramError(_0x52ef87);});_0x4c6ce3['forEach'](_0x31a1b8=>{const _0xecc2e9=_0x27ac1d;if(_0x31a1b8[_0xecc2e9(0x1dc)]!=_0xecc2e9(0x297))toggleBot(_0x31a1b8['botID'],toggleStatus(_0x31a1b8[_0xecc2e9(0x1dc)]),_0xecc2e9(0x1c4));});}else{if(settings['telegramEvents']==_0x27ac1d(0x1d8))tgBot['sendMessage'](_0x326e7f['chat']['id'],_0x27ac1d(0x1ca)+_0x475354)[_0x27ac1d(0x19f)](_0x51c4bd=>{telegramError(_0x51c4bd);});toggleBot(_0x475354,toggleStatus(_0x475354),_0x27ac1d(0x1c4));}}),tgBot['removeListener'](_0x1f7f28(0x252));});}}),tgBot['onText'](/\/disable/,_0x1232ae=>{const _0x378ee3=_0x18e6cf;if(!validateTelegram(_0x1232ae))return;tgBot[_0x378ee3(0x25b)](_0x1232ae[_0x378ee3(0x2b8)]['id'],'Notifications\x20disabled')[_0x378ee3(0x19f)](_0x2baab2=>{telegramError(_0x2baab2);}),updateSetting(_0x378ee3(0x224),![]);}),tgBot[_0x18e6cf(0x2b6)](/\/help/,_0xd7e04c=>{const _0x36a679=_0x18e6cf;if(!validateTelegram(_0xd7e04c))return;tgBot['sendMessage'](_0xd7e04c[_0x36a679(0x2b8)]['id'],_0x86b5f)[_0x36a679(0x19f)](_0x4f6eb4=>{telegramError(_0x4f6eb4);});}),tgBot['on'](_0x18e6cf(0x22a),_0x1cac70=>{const _0x19e21e=_0x18e6cf;_0x1cac70[_0x19e21e(0x217)]()[_0x19e21e(0x242)]('404\x20Not\x20Found')&&(logging(_0x19e21e(0x273)),tgBot[_0x19e21e(0x278)](),tgBot=null,io['to'](_0x19e21e(0x221))['emit'](_0x19e21e(0x23d),_0x19e21e(0x273)));}),process[_0x18e6cf(0x26f)]('SIGINT',()=>{const _0x10f718=_0x18e6cf;if(tgBot)tgBot[_0x10f718(0x278)]();process['exit'](0x1);}),process['once']('SIGTERM',()=>{const _0x9d7962=_0x18e6cf;if(tgBot)tgBot[_0x9d7962(0x278)]();process[_0x9d7962(0x172)](0x1);});}}function disableTelegram(){const _0x55ebf9=_0x51d6d2;tgBot&&(tgBot[_0x55ebf9(0x278)](),tgBot=null);}function sendTelegram(_0x250dbc,_0x38df5f){const _0xafca24=_0x51d6d2;if(settings[_0xafca24(0x224)]){if(settings[_0xafca24(0x28e)]=='all'||(_0x38df5f[_0xafca24(0x206)]=='error'||_0x38df5f[_0xafca24(0x206)]==_0xafca24(0x29f))&&settings[_0xafca24(0x28e)]==_0xafca24(0x1ed)||_0x38df5f[_0xafca24(0x206)]==_0xafca24(0x241)&&settings['telegramEvents']==_0xafca24(0x1d8)){if(tgBot&&settings[_0xafca24(0x230)]){if(_0x38df5f[_0xafca24(0x249)])tgBot[_0xafca24(0x25b)](settings[_0xafca24(0x230)],_0x38df5f[_0xafca24(0x25d)]+_0xafca24(0x1ae)+_0x38df5f['event'])[_0xafca24(0x19f)](_0x502dad=>{telegramError(_0x502dad);});else tgBot[_0xafca24(0x25b)](settings[_0xafca24(0x230)],_0xafca24(0x289)+_0x250dbc+_0xafca24(0x1ae)+_0x38df5f[_0xafca24(0x1fe)])['catch'](_0x561df5=>{telegramError(_0x561df5);});}}}}function getDeviceWithIp(_0x9c22dd){return devices['find'](_0x591308=>_0x591308['ip']===_0x9c22dd);}function temporaryAccess2FA(_0x394b72,_0x44cc6a){const _0x64327d=_0x51d6d2;let _0x519562=new Date(),_0x399df9=![];if(lastIpApproval){if(_0x519562-lastIpApproval<0x1388)_0x399df9=!![];}lastIpApproval=new Date();if(_0x399df9)return;tgBot&&settings[_0x64327d(0x230)]&&(tgBot[_0x64327d(0x27d)]('callback_query'),tgBot[_0x64327d(0x25b)](settings[_0x64327d(0x230)],_0x64327d(0x1ad)+normalizeIP(_0x44cc6a)[_0x64327d(0x182)]+'</b>\x20?',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x64327d(0x17f),'callback_data':'15'},{'text':_0x64327d(0x1a2),'callback_data':'30'},{'text':_0x64327d(0x220),'callback_data':_0x64327d(0x220)}]]}})[_0x64327d(0x19f)](_0x4d0af0=>{telegramError(_0x4d0af0);}),tgBot['on'](_0x64327d(0x252),async _0x126956=>{const _0x3634ee=_0x64327d,_0x40c8c6=_0x126956[_0x3634ee(0x1fb)],_0x5693b3=_0x126956[_0x3634ee(0x26c)];tgBot[_0x3634ee(0x2a5)](_0x126956['id'])[_0x3634ee(0x229)](async()=>{const _0x11b919=_0x3634ee;devices[_0x394b72][_0x11b919(0x225)]={'clientip':_0x44cc6a,'timestamp':new Date()[_0x11b919(0x1a0)](),'expiry':_0x40c8c6},_0x40c8c6!=_0x11b919(0x220)?(await tgBot[_0x11b919(0x25b)](_0x5693b3[_0x11b919(0x2b8)]['id'],_0x11b919(0x24c)+_0x40c8c6+_0x11b919(0x251),{'parse_mode':'HTML'})['catch'](_0x374a45=>{telegramError(_0x374a45);}),io['to'](_0x394b72)[_0x11b919(0x1cd)]('status',{'access':{'allow':![],'reason':_0x11b919(0x1ce),'token':null}})):(await tgBot[_0x11b919(0x25b)](_0x5693b3['chat']['id'],_0x11b919(0x24e))[_0x11b919(0x19f)](_0x39965d=>{telegramError(_0x39965d);}),io['to'](_0x394b72)[_0x11b919(0x1cd)](_0x11b919(0x18b),{'access':{'allow':![],'reason':_0x11b919(0x214),'token':null}}));}),tgBot[_0x3634ee(0x27d)](_0x3634ee(0x252));}));}function loginAccess2FA(_0xba093b,_0xc326e9){const _0x5b98c5=_0x51d6d2;tgBot&&settings[_0x5b98c5(0x230)]&&(tgBot[_0x5b98c5(0x27d)](_0x5b98c5(0x252)),tgBot[_0x5b98c5(0x25b)](settings[_0x5b98c5(0x230)],_0x5b98c5(0x1ef)+normalizeIP(_0xc326e9)[_0x5b98c5(0x182)]+_0x5b98c5(0x1e5),{'parse_mode':_0x5b98c5(0x24a),'reply_markup':{'inline_keyboard':[[{'text':_0x5b98c5(0x204),'callback_data':loginExpiry},{'text':'reject','callback_data':'reject'}]]}})['catch'](_0x3c79e0=>{telegramError(_0x3c79e0);}),tgBot['on'](_0x5b98c5(0x252),async _0xcbb719=>{const _0x10e108=_0x5b98c5,_0x23a736=_0xcbb719[_0x10e108(0x1fb)],_0x5e562c=_0xcbb719['message'];tgBot['answerCallbackQuery'](_0xcbb719['id'])['then'](async()=>{const _0x2599be=_0x10e108;devices[_0xba093b][_0x2599be(0x26b)]={'clientip':_0xc326e9,'timestamp':new Date()[_0x2599be(0x1a0)](),'expiry':_0x23a736},_0x23a736!=_0x2599be(0x220)?(await tgBot['sendMessage'](_0x5e562c[_0x2599be(0x2b8)]['id'],_0x2599be(0x1f4),{'parse_mode':'HTML'})[_0x2599be(0x19f)](_0x4527ec=>{telegramError(_0x4527ec);}),io['to'](_0xba093b)['emit'](_0x2599be(0x18b),{'access':{'allow':![],'reason':_0x2599be(0x1ce),'token':null}})):(await tgBot[_0x2599be(0x25b)](_0x5e562c[_0x2599be(0x2b8)]['id'],_0x2599be(0x1bd))[_0x2599be(0x19f)](_0x44a862=>{telegramError(_0x44a862);}),io['to'](_0xba093b)['emit'](_0x2599be(0x18b),{'access':{'allow':![],'reason':_0x2599be(0x287),'token':null}}));}),tgBot[_0x10e108(0x27d)]('callback_query');}));}function getConfiguration(){const _0x5c8653=_0x51d6d2;return dbConfig[_0x5c8653(0x197)](_0x5c8653(0x200))[_0x5c8653(0x1e9)](_0x5c8653(0x1dc))['value']()||[];}function getEnabledBots(){const _0x2b8aaf=_0x51d6d2;return dbConfig[_0x2b8aaf(0x197)](_0x2b8aaf(0x200))[_0x2b8aaf(0x1e9)]('botID')[_0x2b8aaf(0x2a8)]({'status':_0x2b8aaf(0x19a)})[_0x2b8aaf(0x1c1)]()||[];}function getDisabledBots(){const _0x49a331=_0x51d6d2;return dbConfig['get'](_0x49a331(0x200))['sortBy'](_0x49a331(0x1dc))['filter']({'status':'disabled'})[_0x49a331(0x1c1)]()||[];}function getSettings(){const _0x479156=_0x51d6d2;return dbSettings[_0x479156(0x197)](_0x479156(0x28c))[_0x479156(0x1c1)]()||{'timeshift':0x0};}function getSecure(){const _0x3d0750=_0x51d6d2;return dbSecure['get'](_0x3d0750(0x1da))['value']()||{};}function getBlacklist(){const _0x1234e7=_0x51d6d2;return dbSecure[_0x1234e7(0x197)]('blacklist')[_0x1234e7(0x1c1)]()||[];}function broadcastToBots(_0x21d048,_0x13ed02){const _0x4cbd68=_0x51d6d2;config[_0x4cbd68(0x1c8)](_0x5b3d0=>{const _0x31b808=_0x4cbd68;if(_0x5b3d0['status']==_0x31b808(0x19a)&&_0x5b3d0[_0x31b808(0x1de)]==_0x31b808(0x189)){if(pid[_0x5b3d0[_0x31b808(0x1dc)]])pid[_0x5b3d0[_0x31b808(0x1dc)]]['send']({[_0x21d048]:_0x13ed02});}});}function storeSettings(_0x2c5716,_0x34f936=![]){const _0x17b5e5=_0x51d6d2;_0x2c5716={...settings,..._0x2c5716};if(_0x34f936&&_0x2c5716[_0x17b5e5(0x25e)]!=_0x17b5e5(0x253)&&_0x2c5716[_0x17b5e5(0x25e)]!=''){const _0xb9de16=crypt['decrypt'](secure[_0x17b5e5(0x247)],_0x2c5716['bbPassword'])[_0x17b5e5(0x26c)][_0x17b5e5(0x1c2)]('@')[0x0],_0x3b6d7c=bcrypt[_0x17b5e5(0x254)](_0xb9de16,saltRounds);_0x2c5716={..._0x2c5716,'bbPassword':_0x3b6d7c};}if(_0x34f936&&_0x2c5716[_0x17b5e5(0x21e)]!=_0x17b5e5(0x253)&&_0x2c5716['telegramToken']!=''){const _0x3d44a8=crypt[_0x17b5e5(0x234)](secure['privateKey'],_0x2c5716[_0x17b5e5(0x21e)])[_0x17b5e5(0x26c)]['split']('@')[0x0];_0x2c5716={..._0x2c5716,'telegramToken':_0x3d44a8};}const _0x49aa25=_0x2c5716[_0x17b5e5(0x21e)]!=_0x17b5e5(0x253)&&_0x2c5716[_0x17b5e5(0x21e)]!=settings['telegramToken']||_0x2c5716[_0x17b5e5(0x1a8)]!=settings[_0x17b5e5(0x1a8)],_0x1d7b11=_0x2c5716[_0x17b5e5(0x21e)]==''||_0x2c5716[_0x17b5e5(0x1a8)]=='';if(_0x49aa25)_0x2c5716[_0x17b5e5(0x28e)]=_0x17b5e5(0x297);for(const [_0x44a5cb,_0xae808c]of Object[_0x17b5e5(0x210)](_0x2c5716)){if(_0x44a5cb==_0x17b5e5(0x21e)&&_0xae808c==_0x17b5e5(0x253)){_0x2c5716['telegramToken']=settings['telegramToken'];continue;};if(_0x44a5cb==_0x17b5e5(0x25e)&&_0xae808c==_0x17b5e5(0x253)){_0x2c5716[_0x17b5e5(0x25e)]=settings['bbPassword'];continue;};dbSettings[_0x17b5e5(0x294)](_0x17b5e5(0x1bc)+_0x44a5cb,_0xae808c)[_0x17b5e5(0x187)]();}settings=_0x2c5716,io['to'](_0x17b5e5(0x221))[_0x17b5e5(0x1cd)](_0x17b5e5(0x28c),cleanSettings()),broadcastToBots(_0x17b5e5(0x216),settings[_0x17b5e5(0x216)]);if(_0x49aa25&&!_0x1d7b11)initTelegram();if(_0x49aa25&&_0x1d7b11)disableTelegram();getAllClients()['forEach'](_0xf6f029=>{const _0x5a49be=_0x17b5e5;getSocket(_0xf6f029['id'])[_0x5a49be(0x1cd)](_0x5a49be(0x18b),{'access':{'allow':![],'reason':_0x5a49be(0x1ce),'token':null}});});}function updateSetting(_0x1ab506,_0x5df91f){const _0x3f263c=_0x51d6d2;dbSettings[_0x3f263c(0x294)](_0x3f263c(0x1bc)+_0x1ab506,_0x5df91f)['write'](),settings=getSettings(),io['to'](_0x3f263c(0x221))['emit']('settings',cleanSettings());}function storeSecure(_0x456ff3){const _0x263b58=_0x51d6d2;dbSecure[_0x263b58(0x197)]('secure')[_0x263b58(0x1bb)](_0x456ff3)[_0x263b58(0x187)](),secure=_0x456ff3;}function addBlacklist(_0x520c4e){const _0x1b5fe6=_0x51d6d2;cleanBlacklist();let _0x11b8ef;devices[_0x520c4e]['telegramIpApproval']?_0x11b8ef=Math[_0x1b5fe6(0x264)](devices[_0x520c4e][_0x1b5fe6(0x225)]['expiry'],loginExpiry):_0x11b8ef=loginExpiry,dbSecure[_0x1b5fe6(0x197)](_0x1b5fe6(0x25a))[_0x1b5fe6(0x1bb)]({'expiry':new Date()['getTime']()+_0x11b8ef*0x3c*0x3e8,'token':devices[_0x520c4e][_0x1b5fe6(0x23c)][_0x1b5fe6(0x1fa)]})[_0x1b5fe6(0x187)](),blacklist=dbSecure[_0x1b5fe6(0x197)]('blacklist')[_0x1b5fe6(0x1c1)]();}function cleanBlacklist(){const _0x26046d=_0x51d6d2;let _0x1a5f9b=dbSecure[_0x26046d(0x197)](_0x26046d(0x25a))[_0x26046d(0x283)]()['value'](),_0x2acae0=new Date()[_0x26046d(0x1a0)]();_0x1a5f9b['forEach'](_0x66bde2=>{const _0x24cf19=_0x26046d;_0x66bde2[_0x24cf19(0x180)]<_0x2acae0&&dbSecure[_0x24cf19(0x197)]('blacklist')[_0x24cf19(0x1a1)]({'expiry':_0x66bde2[_0x24cf19(0x180)]})[_0x24cf19(0x187)]();});}function initStates(){const _0x1f50f5=_0x51d6d2;let _0x272f7a=getConfiguration();_0x272f7a[_0x1f50f5(0x1c8)](_0x48c309=>{const _0x24b131=_0x1f50f5;_0x48c309[_0x24b131(0x1de)]='stopped';}),storeConfiguration(_0x272f7a);}function onKeys(){const _0x19a15c=new RSA();return new Promise(_0x29508f=>{const _0x443ca9=_0x12b1;_0x19a15c[_0x443ca9(0x1fd)]()[_0x443ca9(0x229)](_0x3dcc60=>{_0x29508f(_0x3dcc60);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5278f5=_0x51d6d2;let _0x2b8b41=getConfiguration(),_0x430843=![];_0x2b8b41['forEach'](_0x18a5e6=>{const _0x4d5efa=_0x12b1;if(_0x18a5e6[_0x4d5efa(0x18b)]==_0x4d5efa(0x189))_0x18a5e6[_0x4d5efa(0x18b)]=_0x4d5efa(0x19a),_0x430843=!![];else _0x18a5e6[_0x4d5efa(0x18b)]==_0x4d5efa(0x1c4)&&(_0x18a5e6[_0x4d5efa(0x18b)]=_0x4d5efa(0x26a),_0x430843=!![]);});if(_0x430843)storeConfiguration(_0x2b8b41);let _0x2f792b=getSecure();if(!_0x2f792b[_0x5278f5(0x1d4)](_0x5278f5(0x1eb))){let _0x3c620f=await generateKeys();_0x2f792b[_0x5278f5(0x2b3)]=_0x3c620f[_0x5278f5(0x2b3)],_0x2f792b['privateKey']=_0x3c620f[_0x5278f5(0x247)],_0x2f792b[_0x5278f5(0x1eb)]=crypto[_0x5278f5(0x170)](0x20)['toString'](_0x5278f5(0x29a));;storeSecure(_0x2f792b);}let _0x43040d=getSettings();_0x430843=![];!_0x43040d[_0x5278f5(0x1d4)](_0x5278f5(0x1fc))&&(_0x43040d[_0x5278f5(0x1fc)]=![],_0x43040d[_0x5278f5(0x1e6)]='',_0x43040d[_0x5278f5(0x25e)]='',_0x43040d[_0x5278f5(0x284)]=![],_0x430843=!![]);!_0x43040d['hasOwnProperty'](_0x5278f5(0x17d))&&(_0x43040d[_0x5278f5(0x17d)]=![],_0x43040d[_0x5278f5(0x2ac)]=[],_0x43040d[_0x5278f5(0x1aa)]=![],_0x430843=!![]);if(!_0x43040d[_0x5278f5(0x1d4)](_0x5278f5(0x224))){if(_0x43040d[_0x5278f5(0x230)])_0x43040d[_0x5278f5(0x224)]=!![];else _0x43040d['telegramEnabled']=![];_0x430843=!![];}if(_0x430843)storeSettings(_0x43040d);}function storeConfiguration(_0x4435d0){const _0x22c45b=_0x51d6d2;dbConfig[_0x22c45b(0x197)](_0x22c45b(0x200))[_0x22c45b(0x1a1)]()[_0x22c45b(0x187)](),dbConfig[_0x22c45b(0x197)](_0x22c45b(0x200))[_0x22c45b(0x1bb)](..._0x4435d0)['write'](),config=_0x4435d0;}function resetPassword(){const _0x1a6abb=_0x51d6d2;tgBot&&settings[_0x1a6abb(0x230)]&&(tgBot[_0x1a6abb(0x27d)](_0x1a6abb(0x252)),tgBot[_0x1a6abb(0x25b)](settings[_0x1a6abb(0x230)],_0x1a6abb(0x28b),{'parse_mode':_0x1a6abb(0x24a),'reply_markup':{'inline_keyboard':[[{'text':_0x1a6abb(0x277),'callback_data':_0x1a6abb(0x277)},{'text':'no','callback_data':'no'}]]}})[_0x1a6abb(0x19f)](_0x3e4d99=>{telegramError(_0x3e4d99);}),tgBot['on'](_0x1a6abb(0x252),async _0x2c81ac=>{const _0x4ed52f=_0x1a6abb,_0x3a3d3b=_0x2c81ac[_0x4ed52f(0x1fb)],_0x4d6bdb=_0x2c81ac[_0x4ed52f(0x26c)];tgBot[_0x4ed52f(0x2a5)](_0x2c81ac['id'])[_0x4ed52f(0x229)](async()=>{const _0x2d5147=_0x4ed52f;if(_0x3a3d3b!='no'){const _0x27a2e7=0xf,_0x116641=_0x2d5147(0x1f7),_0x46cb34=Array[_0x2d5147(0x23a)](crypto['randomFillSync'](new Uint32Array(_0x27a2e7)))['map'](_0x2a76fd=>_0x116641[_0x2a76fd%_0x116641['length']])['join'](''),_0x4a1fe9=bcrypt[_0x2d5147(0x254)](_0x46cb34,saltRounds);storeSettings({'bbPassword':_0x4a1fe9}),await tgBot[_0x2d5147(0x25b)](_0x4d6bdb[_0x2d5147(0x2b8)]['id'],_0x2d5147(0x188)+_0x46cb34,{'parse_mode':_0x2d5147(0x24a)})[_0x2d5147(0x19f)](_0x3b4969=>{telegramError(_0x3b4969);});}else await tgBot[_0x2d5147(0x25b)](_0x4d6bdb['chat']['id'],_0x2d5147(0x1c7))['catch'](_0x1cf58c=>{telegramError(_0x1cf58c);});}),tgBot[_0x4ed52f(0x27d)]('callback_query');}));}function logging(_0x3c6754){const _0x4af5a7=_0x51d6d2;console['log'](getTimeStamp()+_0x4af5a7(0x20a)+_0x3c6754);if(tgBot&&settings['telegramChatId']&&settings[_0x4af5a7(0x28e)]!=_0x4af5a7(0x1d8))tgBot[_0x4af5a7(0x25b)](settings[_0x4af5a7(0x230)],_0x4af5a7(0x226)+_0x3c6754)[_0x4af5a7(0x19f)](_0x46e4e8=>{telegramError(_0x46e4e8);});}function getServerTime(){const _0x45324b=_0x51d6d2,_0x5ce73c=new Date();return _0x5ce73c[_0x45324b(0x174)]()+'/'+(_0x5ce73c[_0x45324b(0x27a)]()+0x1)[_0x45324b(0x217)]()[_0x45324b(0x208)](0x2,'0')+'/'+_0x5ce73c[_0x45324b(0x1a5)]()[_0x45324b(0x217)]()[_0x45324b(0x208)](0x2,'0')+'\x20'+_0x5ce73c[_0x45324b(0x29d)]()[_0x45324b(0x217)]()['padStart'](0x2,'0')+':'+_0x5ce73c[_0x45324b(0x29c)]()['toString']()['padStart'](0x2,'0')+':'+_0x5ce73c[_0x45324b(0x290)]()[_0x45324b(0x217)]()[_0x45324b(0x208)](0x2,'0');}function getTimeStamp(){const _0x3075da=_0x51d6d2,_0x56111c=shiftedTime();return _0x56111c[_0x3075da(0x174)]()+'/'+(_0x56111c[_0x3075da(0x27a)]()+0x1)[_0x3075da(0x217)]()[_0x3075da(0x208)](0x2,'0')+'/'+_0x56111c['getDate']()['toString']()['padStart'](0x2,'0')+'\x20'+_0x56111c[_0x3075da(0x29d)]()[_0x3075da(0x217)]()[_0x3075da(0x208)](0x2,'0')+':'+_0x56111c['getMinutes']()['toString']()[_0x3075da(0x208)](0x2,'0')+':'+_0x56111c[_0x3075da(0x290)]()[_0x3075da(0x217)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x4a533e=_0x51d6d2,_0x1b46e3=new Date();let _0x3d7123=_0x1b46e3;if(settings[_0x4a533e(0x216)]&&settings['timeshift']!==0x0)_0x3d7123=fns['add'](_0x1b46e3,{'hours':settings[_0x4a533e(0x216)]});return _0x3d7123;}function startScheduler(){const _0x241a11=_0x51d6d2;let _0x169d82=new Date()[_0x241a11(0x176)]();_0x169d82==0x1&&backupConfigFiles();_0x169d82==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x508a43=_0x51d6d2;fs[_0x508a43(0x293)](configpath,{'withFileTypes':!![]})[_0x508a43(0x1c8)](_0x2d9262=>{const _0x5e5777=_0x508a43;if(!_0x2d9262['isDirectory']())fs['copyFileSync'](configpath+_0x2d9262[_0x5e5777(0x255)],configbackuppath+_0x2d9262[_0x5e5777(0x255)]);});}function triggerAnalytics(){const _0x31613c=_0x51d6d2;analytics['page']({'title':_0x31613c(0x20c),'href':_0x31613c(0x1c5),'path':'/v'+serverversion});}function validateCredentials(_0x21ec32,_0x12d95d){const _0x41787f=_0x51d6d2;if(_0x21ec32[_0x41787f(0x192)]==settings['bbUsername']&&bcrypt[_0x41787f(0x21a)](_0x21ec32[_0x41787f(0x202)],settings[_0x41787f(0x25e)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x41787f(0x279),'token':null};else{const _0x2b9083=generateLoginToken(_0x12d95d);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x2b9083};}}else return{'allow':![],'reason':_0x41787f(0x1b5),'token':null};}function refreshToken(_0x2e032e){const _0x5de9b5=_0x51d6d2,_0x294cab=generateLoginToken(_0x2e032e);return{'allow':!![],'reason':_0x5de9b5(0x1ee),'token':_0x294cab};}function validateAccess(_0x25cf95,_0x22d335){const _0x43f706=_0x51d6d2;let _0x2ef3ae=devices[_0x22d335]['ip'],_0x1edc18;const _0x3fb459=_0x8528b3=>{const _0x5e3d9f=_0x12b1;if(settings['loginRequired']){if(settings['f2aRequired']){if(telegram2FaApproved(_0x22d335)){const _0x503689=generateLoginToken(_0x22d335);return{'allow':!![],'reason':_0x5e3d9f(0x1b3),'token':_0x503689};}else return{'allow':![],'reason':_0x5e3d9f(0x1b6),'token':null};}else return _0x1edc18=validToken(_0x8528b3,_0x22d335),_0x1edc18[_0x5e3d9f(0x1d4)]('success')?{'allow':!![],'reason':_0x5e3d9f(0x1ec),'token':_0x8528b3}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x5e3d9f(0x18e),'token':null};};if(settings[_0x43f706(0x17d)]){let _0x1a3d04=[...settings[_0x43f706(0x2ac)],'::1',_0x43f706(0x219),'127.0.0.1'];if(_0x1a3d04[_0x43f706(0x242)](_0x2ef3ae))return _0x3fb459(_0x25cf95);else{_0x1edc18=validToken(_0x25cf95,_0x22d335);if(_0x1edc18['hasOwnProperty'](_0x43f706(0x29f)))return _0x3fb459(_0x25cf95);else{if(telegramIpApproved(_0x22d335)){const _0x281f30=generateToken(_0x22d335);return _0x1edc18=_0x3fb459(_0x25cf95),_0x1edc18[_0x43f706(0x1b2)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x281f30}:_0x1edc18;}else return settings[_0x43f706(0x1aa)]?{'allow':![],'reason':_0x43f706(0x193),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x3fb459(_0x25cf95);}function timelyDecrypt(_0x10d0d4,_0x24ec06=!![]){const _0x5b51e9=_0x51d6d2;if(_0x10d0d4)try{const _0x5289ff=crypt[_0x5b51e9(0x234)](secure['privateKey'],_0x10d0d4)[_0x5b51e9(0x26c)],_0x1fb389=_0x5289ff[_0x5b51e9(0x1c2)]('@')[0x0],_0x6cb6d1=_0x5289ff[_0x5b51e9(0x1c2)]('@')[0x1],_0x11ea9f=new Date()['getTime']();if(_0x24ec06){if(_0x11ea9f-_0x6cb6d1<maxSecretAge*0x3e8)return _0x1fb389;else return![];}else return _0x1fb389;}catch(_0x5bcb43){return![];}else return![];}function _0x12b1(_0x510999,_0x57efdf){const _0x123484=_0x2bbf();return _0x12b1=function(_0x2d417c,_0x55b97f){_0x2d417c=_0x2d417c-0x16f;let _0x2bbf7b=_0x123484[_0x2d417c];return _0x2bbf7b;},_0x12b1(_0x510999,_0x57efdf);}const validToken=(_0x4ed2a9,_0x210734)=>{const _0x1b9f92=_0x51d6d2,_0x2832aa=devices[_0x210734]['ip'];if(!_0x4ed2a9)return{'error':_0x1b9f92(0x1d6)};for(let _0x3f0b52 of blacklist){if(_0x3f0b52[_0x1b9f92(0x1fa)]==_0x4ed2a9)return{'error':_0x1b9f92(0x1c0)};}let _0x4d4ace;try{_0x4d4ace=jwt[_0x1b9f92(0x201)](_0x4ed2a9,secure['secret']+_0x210734);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x4d4ace[_0x1b9f92(0x1d4)](_0x1b9f92(0x2a6))&&!_0x4d4ace[_0x1b9f92(0x1d4)](_0x1b9f92(0x192))||!_0x4d4ace[_0x1b9f92(0x1d4)]('exp'))return{'error':_0x1b9f92(0x205)};if(!_0x4d4ace[_0x1b9f92(0x1d4)](_0x1b9f92(0x192))&&_0x4d4ace[_0x1b9f92(0x1d4)](_0x1b9f92(0x2a6))){const {clientip:_0x12640c}=_0x4d4ace;return _0x2832aa==_0x12640c?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x1b9f92(0x183)};}else{if(_0x4d4ace[_0x1b9f92(0x1d4)]('username')&&_0x4d4ace[_0x1b9f92(0x1d4)](_0x1b9f92(0x2a6))){const {username:_0x183caa,clientip:_0x18d3e8}=_0x4d4ace;return settings[_0x1b9f92(0x1e6)]==_0x183caa&&_0x2832aa==_0x18d3e8?{'success':_0x1b9f92(0x2b7)}:{'error':_0x1b9f92(0x259)};}}},generateLoginToken=_0x5582cf=>{const _0x1aaf18=_0x51d6d2;if(_0x5582cf){const _0x3c4762=devices[_0x5582cf]['ip'];return jwt[_0x1aaf18(0x23e)]({'username':settings[_0x1aaf18(0x1e6)],'clientip':_0x3c4762},secure['secret']+_0x5582cf,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x4cc115=>{const _0x21282c=_0x51d6d2;if(_0x4cc115){const _0x118f87=devices[_0x4cc115]['ip'];return jwt[_0x21282c(0x23e)]({'clientip':_0x118f87},secure[_0x21282c(0x1eb)]+_0x4cc115,{'expiresIn':devices[_0x4cc115][_0x21282c(0x225)][_0x21282c(0x180)]*0x3c});}else return![];},telegramIpApproved=_0x5a091d=>{const _0x392f85=_0x51d6d2;let _0x15b0fb=![];return devices[_0x5a091d][_0x392f85(0x225)]&&devices[_0x5a091d][_0x392f85(0x225)]['expiry']!=_0x392f85(0x220)&&(_0x15b0fb=devices[_0x5a091d][_0x392f85(0x225)]['clientip']==devices[_0x5a091d]['ip']&&new Date()[_0x392f85(0x1a0)]()-devices[_0x5a091d]['telegramIpApproval']['timestamp']<devices[_0x5a091d][_0x392f85(0x225)]['expiry']*0x3c*0x3e8),_0x15b0fb;},telegram2FaApproved=_0x45caf1=>{const _0x72645=_0x51d6d2;let _0x331bef=![];return devices[_0x45caf1]['telegram2FaApproval']&&devices[_0x45caf1][_0x72645(0x26b)][_0x72645(0x180)]!=_0x72645(0x220)&&(_0x331bef=devices[_0x45caf1]['telegram2FaApproval']['clientip']==devices[_0x45caf1]['ip']&&new Date()['getTime']()-devices[_0x45caf1][_0x72645(0x26b)][_0x72645(0x27f)]<devices[_0x45caf1][_0x72645(0x26b)][_0x72645(0x180)]*0x3c*0x3e8),_0x331bef;},normalizeIP=_0x5aa3f4=>{const _0x376a23=_0x51d6d2;let _0x5d46e5=null,_0x504263=null;if(ipaddr[_0x376a23(0x272)](_0x5aa3f4)){const _0x30262c=ipaddr[_0x376a23(0x2b1)](_0x5aa3f4);_0x30262c[_0x376a23(0x240)]()==='ipv6'?(_0x30262c[_0x376a23(0x238)]()&&(_0x5d46e5=_0x30262c[_0x376a23(0x1f5)]()[_0x376a23(0x217)]()),_0x504263=_0x30262c[_0x376a23(0x217)]()):(_0x5d46e5=_0x30262c[_0x376a23(0x217)](),_0x504263=_0x30262c[_0x376a23(0x236)]()[_0x376a23(0x217)]());}return{'show':_0x5d46e5?_0x5d46e5:_0x504263,'store':_0x504263};};