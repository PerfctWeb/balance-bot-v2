const _0x458476=_0x22ea;(function(_0x5709f2,_0x3af218){const _0x27d67e=_0x22ea,_0x5675a5=_0x5709f2();while(!![]){try{const _0x399158=-parseInt(_0x27d67e(0x159))/0x1+-parseInt(_0x27d67e(0x1f6))/0x2*(parseInt(_0x27d67e(0x1e9))/0x3)+parseInt(_0x27d67e(0x18a))/0x4*(parseInt(_0x27d67e(0x1dd))/0x5)+-parseInt(_0x27d67e(0x19d))/0x6*(-parseInt(_0x27d67e(0x1db))/0x7)+parseInt(_0x27d67e(0x17d))/0x8*(parseInt(_0x27d67e(0x15e))/0x9)+-parseInt(_0x27d67e(0x24d))/0xa+-parseInt(_0x27d67e(0x20b))/0xb*(-parseInt(_0x27d67e(0x18b))/0xc);if(_0x399158===_0x3af218)break;else _0x5675a5['push'](_0x5675a5['shift']());}catch(_0x5a2986){_0x5675a5['push'](_0x5675a5['shift']());}}}(_0x56d8,0x8ef32));const _0x3807f3=function(){let _0x4bd921=!![];return function(_0x9309c2,_0x27a40d){const _0x4d1c9b=_0x4bd921?function(){const _0x41b16d=_0x22ea;if(_0x27a40d){const _0x1873ca=_0x27a40d[_0x41b16d(0x244)](_0x9309c2,arguments);return _0x27a40d=null,_0x1873ca;}}:function(){};return _0x4bd921=![],_0x4d1c9b;};}(),_0xd6891e=_0x3807f3(this,function(){const _0x1ba5c0=_0x22ea;return _0xd6891e[_0x1ba5c0(0x132)]()[_0x1ba5c0(0x1a1)](_0x1ba5c0(0x1fb))[_0x1ba5c0(0x132)]()[_0x1ba5c0(0x223)](_0xd6891e)[_0x1ba5c0(0x1a1)]('(((.+)+)+)+$');});_0xd6891e();'use strict';process[_0x458476(0x1b9)][_0x458476(0x123)]=0x1;const childProcess=require('child_process'),FileSync=require(_0x458476(0x1b0)),fs=require('fs'),fns=require('date-fns'),low=require(_0x458476(0x203)),path=require('path'),crypto=require('crypto'),Crypt=require(_0x458476(0x1f4))['Crypt'],RSA=require(_0x458476(0x1f4))[_0x458476(0x19f)],bcrypt=require(_0x458476(0x12c)),jwt=require(_0x458476(0x16b)),analyticsLib=require(_0x458476(0x1df))[_0x458476(0x1ef)],googleAnalytics=require(_0x458476(0x146))[_0x458476(0x1ef)],ipaddr=require(_0x458476(0x255));let bbpath=_0x458476(0x186);const botfile=_0x458476(0x21a),configfile=_0x458476(0x249),settingsfile='bb-settings.json',securefile=_0x458476(0x218);function _0x56d8(){const _0x215d36=['storeHeadless','All\x20bots','version','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','write','telegram','botmanager','store-settings','connected','@analytics/google-analytics','order','User\x20has\x20been\x20validated','cloneDeep','get','emit','ipv6','-results.json','secret','Notifications\x20disabled\x0a','get-starting-balances','2FA\x20login\x20required','access\x20timeout','filter','-config.json','sortBy','\x20minutes','timestamp','</b>\x20?','482059pyQDTD','UA-192771731-1','All\x20bots\x20running\x20right\x20now','answerCallbackQuery','kind','81Eteump','index.html','args','loginRequired','/disable\x20-\x20disable\x20notifications\x0a','::1','Bot\x20','conn','bot-','logout','1000','Ok,\x20will\x20send\x20order\x20notifications\x20only','Invalid\x20IP\x20address','jsonwebtoken','secure','127.0.0.1','once','new-disabled','value','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','disabled','-events.json','http','storeConfiguration','getUTCHours','map','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','404\x20Not\x20Found','/:bot/support','getMinutes','allow','529432NqaGEq','restart','token','hasOwnProperty','Unauthorized\x20attempt\x20to\x20store\x20configuration','onText','listen','get-logs','log','bb/','parse','HTML','forEach','81784rDNSxl','13883736IGCtkQ','length','remoteAddress','Unauthorized\x20attempt\x20to\x20log\x20out','add','reject','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','/:bot/coins','sendFile','/:bot/performance','unlinkSync','emitHistory','mkdirSync','generateKeyPairAsync','/:bot/configuration','All','privateKey','use','100356sfURJq','Bot\x20Mgr\x20>\x20','RSA','removeAllListeners','search','static','chat','stopped','encryptedUuid','add-bot','orders','telegramChatId','2FA\x20login\x20token\x20generated','Unauthorized\x20attempt\x20to\x20update\x20bot','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','callback_query','username','randomBytes','logged\x20out','lowdb/adapters/FileSync','telegramToken','kill','event','/restart\x20-\x20restart\x20bot(s)\x0a','No\x20bots\x20running\x20right\x20now','starting','f2aRequired','login\x20not\x20required','env','alerts','whitelistEnabled','SIGINT','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Invalid\x20username\x20or\x20IP\x20address','enabled\x20Bot\x20','push','publicKey','split','SIGTERM','fork','from','error','deleted\x20Bot\x20','\x20|\x20','status','catch','Unauthorized\x20attempt\x20logging\x20in\x20(timeout)','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','data','-----------------------------------------------------------------------------------','starting\x20bot\x20|\x20Bot\x20','includes','page','padStart','new','show','Notifications\x20disabled','bbUsername','message','assign','getTime','function','7rUjxvp','telegramEnabled','55kvzRSU','clientip','analytics','placeOrder','stop','exit','store','temporary\x20token\x20generated','************',':\x20Bot\x20Mgr\x20>\x20','isValid','all','3JaudtZ','sign',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','accept','notification','login\x20token\x20generated','default','sha256','send','existsSync','botID','hybrid-crypto-js','remove','1785250lCVcRX','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','ipc','polling_error','express','(((.+)+)+)+$','enabled','keys','find','Password\x20reset\x20rejected','\x20>\x20','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','restarting\x20Bot\x20','lowdb','max','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','place-order','bots','live','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Temporary\x20access\x20rejected','11OUTVTH','Unauthorized\x20attempt\x20to\x20update\x20settings','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','getFullYear','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Unauthorized\x20attempt\x20to\x20delete\x20bot','entries','sendMessage','success','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','bbPassword','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','2FA\x20required','bb-secure.json','Alerts','bot.js','idling\x20bot\x20\x20\x20|\x20Bot\x20','Notifications\x20enabled','expiry','Allow\x20login\x20from\x20IP\x20address\x20<b>','botname','started','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','blacklist','constructor','settings.','/status\x20-\x20show\x20bot(s)\x20status\x0a','getSeconds','match','Password\x20has\x20been\x20reset\x20to:\x20','running','stopPolling','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','temporaryAccessAllowed','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','telegramEvents','type','Unauthorized\x20attempt\x20to\x20get\x20logs','RSA-OAEP','login','apiKey','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','hex','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','telegramUsername','Login\x20accepted','config/','whitelist','getMonth','password','disconnect','version.json','join','settings','reset-password','Invalid\x20authentication\x20token\x20(2)','apply','invalid\x20credentials','connection','get-portfolio','auth','bb-config.json','login\x20required','update-bot','-performance.json','340150AOzQLt','15\x20min','then','reason','\x20/\x20','handshake','decrypt','/on\x20-\x20start\x20bot(s)\x0a','ipaddr.js','https://hodlerhacks.com','No\x20authentication\x20token','::ffff:127.0.0.1','getHours','NTBA_FIX_319','reload','build','/:bot/portfolio','removeListener','toIPv4MappedAddress','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','hashSync','exp','bcryptjs','createServer','defaults','yes','delete-bot','getStartingBalances','toString','/:bot','\x20only\x0a','timeshift','<b>Balance\x20Bot\x20status:</b>\x0a','getPortfolio','30\x20min','Invalid\x20Telegram\x20token','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','Notifications\x20types:\x20','verify'];_0x56d8=function(){return _0x215d36;};return _0x56d8();}!fs[_0x458476(0x1f2)](bbpath+botfile)&&(bbpath='');const configpath=bbpath+_0x458476(0x23a);!fs[_0x458476(0x1f2)](configpath)&&fs[_0x458476(0x197)](configpath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x458476(0x12e)]({'bots':[]})[_0x458476(0x141)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x458476(0x12e)]({'settings':{'timeshift':0x0}})[_0x458476(0x141)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x458476(0x12e)]({'secure':{},'blacklist':[]})[_0x458476(0x141)]();let crypt=new Crypt({'md':_0x458476(0x1f0),'rsaStandard':_0x458476(0x231)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[],socket=[],serverStatus=[];const serverversion=require('./'+bbpath+_0x458476(0x23f))[_0x458476(0x13f)],maxSecretAge=0xa,loginExpiry=0x3c,tokenRefresh=0x5;let lastIpApproval,telegramIpApproval,telegram2FaApproval,accessControl,token,uuid,externalip,pidExpireLogin,pidRefreshToken,pidAnalytics;oneTimeMigration(),cleanBlacklist();const PORT=0xbb8,express=require(_0x458476(0x1fa)),app=express(),http=require(_0x458476(0x174))[_0x458476(0x12d)](app);app['use'](express[_0x458476(0x1a2)](path['join'](__dirname,bbpath,'build2'))),app[_0x458476(0x19c)](express[_0x458476(0x1a2)](path[_0x458476(0x240)](__dirname,bbpath,'build'))),app[_0x458476(0x14a)]('/',function(_0x56d7f6,_0x562a4b){const _0x24f9e3=_0x458476;_0x562a4b[_0x24f9e3(0x193)](path[_0x24f9e3(0x240)](__dirname,bbpath,'build2',_0x24f9e3(0x15f)));}),app[_0x458476(0x14a)](_0x458476(0x133),function(_0xfbc3cd,_0x58d0d2){const _0x87c898=_0x458476;_0x58d0d2[_0x87c898(0x193)](path['join'](__dirname,bbpath,_0x87c898(0x125),_0x87c898(0x15f)));}),app[_0x458476(0x14a)](_0x458476(0x126),(_0x26ce6d,_0x15d30d)=>{const _0x3c22c2=_0x458476;_0x15d30d[_0x3c22c2(0x193)](path[_0x3c22c2(0x240)](__dirname,bbpath,_0x3c22c2(0x125),'index.html'));}),app[_0x458476(0x14a)](_0x458476(0x194),(_0xb7a72,_0x5a9798)=>{const _0x511b38=_0x458476;_0x5a9798[_0x511b38(0x193)](path[_0x511b38(0x240)](__dirname,bbpath,_0x511b38(0x125),'index.html'));}),app['get'](_0x458476(0x192),(_0x837e4b,_0x240d4c)=>{const _0x51b831=_0x458476;_0x240d4c[_0x51b831(0x193)](path[_0x51b831(0x240)](__dirname,bbpath,_0x51b831(0x125),_0x51b831(0x15f)));}),app['get']('/:bot/history',(_0x21e6ee,_0x7179b2)=>{const _0x47f3fc=_0x458476;_0x7179b2[_0x47f3fc(0x193)](path['join'](__dirname,bbpath,_0x47f3fc(0x125),_0x47f3fc(0x15f)));}),app[_0x458476(0x14a)](_0x458476(0x199),(_0x390ff6,_0x35dc3c)=>{const _0x200edc=_0x458476;_0x35dc3c['sendFile'](path[_0x200edc(0x240)](__dirname,bbpath,_0x200edc(0x125),'index.html'));}),app[_0x458476(0x14a)](_0x458476(0x17a),(_0x29ee69,_0x180a87)=>{const _0x46012f=_0x458476;_0x180a87[_0x46012f(0x193)](path[_0x46012f(0x240)](__dirname,bbpath,'build',_0x46012f(0x15f)));}),http[_0x458476(0x183)](PORT);const analytics=analyticsLib({'app':'Balance\x20Bot','plugins':[googleAnalytics({'trackingId':_0x458476(0x15a)})]}),TelegramBot=require('node-telegram-bot-api');let tgBot;if(settings[_0x458476(0x1b1)]&&settings[_0x458476(0x1b1)]!=''&&settings[_0x458476(0x238)]&&settings[_0x458476(0x238)]!='')initTelegram();initStates(),startServer(),startSocket(),startAnalytics();function _0x22ea(_0xf4ba31,_0x462d9a){const _0x5a5dfe=_0x56d8();return _0x22ea=function(_0xd6891e,_0x3807f3){_0xd6891e=_0xd6891e-0x123;let _0x56d83e=_0x5a5dfe[_0xd6891e];return _0x56d83e;},_0x22ea(_0xf4ba31,_0x462d9a);}function startServer(){const _0xf1281b=_0x458476;console[_0xf1281b(0x185)](''),console[_0xf1281b(0x185)]('-----------------------------------------------------------------------------------'),logging(_0xf1281b(0x1cc)+PORT),console[_0xf1281b(0x185)](_0xf1281b(0x1ce));if(config[_0xf1281b(0x18c)]!=0x0)config[_0xf1281b(0x189)](_0x164e78=>{const _0x683d9=_0xf1281b;if(_0x164e78[_0x683d9(0x1c9)]==_0x683d9(0x1fc)||_0x164e78[_0x683d9(0x1c9)]==_0x683d9(0x1d3))logging(_0x683d9(0x1cf)+_0x164e78['botID']+_0x683d9(0x1c8)+_0x164e78[_0x683d9(0x21f)]),startBot([_0x164e78['botID']],{'cwd':bbpath},function(_0x416883){if(_0x416883)logging(_0x416883);});else(_0x164e78[_0x683d9(0x1c9)]==_0x683d9(0x172)||_0x164e78[_0x683d9(0x1c9)]=='new-disabled')&&logging(_0x683d9(0x21b)+_0x164e78[_0x683d9(0x1f3)]+_0x683d9(0x1c8)+_0x164e78[_0x683d9(0x21f)]);});else!newBot&&console['log'](_0xf1281b(0x129));if(newBot)addBot();console['log'](_0xf1281b(0x1ce)),console[_0xf1281b(0x185)]('');}function startSocket(){const _0x86f05b=_0x458476,_0x5396a=require('socket.io')(http,{});_0x5396a['on'](_0x86f05b(0x246),_0x1eff74=>{const _0x124464=_0x86f05b;let _0x52897c,_0x470410,_0x569453;const _0x524def=_0x1eff74[_0x124464(0x252)]['headers']['referer'],_0x323674=_0x1eff74['handshake'][_0x124464(0x248)][_0x124464(0x1a5)];if(!_0x323674)_0x1eff74[_0x124464(0x14b)]('status',{'publicKey':secure[_0x124464(0x1c1)]});else{uuid=timelyDecrypt(_0x1eff74[_0x124464(0x252)][_0x124464(0x248)][_0x124464(0x1a5)],![]),_0x470410=_0x524def[_0x124464(0x227)](/bot[0-9]{3}/);if(_0x470410)_0x569453=_0x470410[0x0][_0x124464(0x227)](/[0-9]{3}/);if(_0x569453)_0x52897c=_0x569453[0x0];else _0x52897c=_0x124464(0x143);if(socket[_0x52897c])socket[_0x52897c][_0x124464(0x23e)](!![]);socket[_0x52897c]=_0x1eff74,setAccess(_0x52897c);if(accessControl[_0x124464(0x17c)]){if(_0x52897c=='botmanager')initializeSocketBotManager();else initializeSocketBot(_0x52897c);}if(!serverStatus[_0x52897c])serverStatus[_0x52897c]=_0x124464(0x145);socket[_0x52897c]['on'](_0x124464(0x232),_0x5d3807=>{const _0x197a1b=_0x124464,_0x390255=timelyDecrypt(_0x5d3807[_0x197a1b(0x23d)]);if(_0x390255){_0x5d3807={'username':_0x5d3807[_0x197a1b(0x1ad)],'password':_0x390255};let _0x238de6=validateCredentials(_0x5d3807);if(_0x238de6['allow']==![]&&_0x238de6[_0x197a1b(0x250)]=='2FA\x20login\x20required')socket[_0x52897c][_0x197a1b(0x14b)](_0x197a1b(0x1c9),{'access':_0x238de6}),loginAccess2FA(externalip);else{if(_0x238de6[_0x197a1b(0x17c)]==![]&&_0x238de6[_0x197a1b(0x250)]==_0x197a1b(0x245))socket[_0x52897c][_0x197a1b(0x14b)](_0x197a1b(0x1c9),{'access':_0x238de6});else{if(_0x238de6[_0x197a1b(0x17c)]&&_0x238de6[_0x197a1b(0x250)]==_0x197a1b(0x1ee)){token=_0x238de6[_0x197a1b(0x17f)];for(let _0x25b7ec in socket){if(_0x25b7ec=='botmanager')initializeSocketBotManager();else initializeSocketBot(_0x25b7ec);socket[_0x25b7ec][_0x197a1b(0x14b)](_0x197a1b(0x1c9),{'status':serverStatus[_0x25b7ec]||_0x197a1b(0x1b6),'serverversion':serverversion,'servertime':getServerTime(),'access':_0x238de6,'externalip':externalip,'publicKey':secure[_0x197a1b(0x1c1)],'loginNow':![]});}setTokenRefresh(),setSessionTimeout('login');}}}}else logging(_0x197a1b(0x1cb));}),socket[_0x52897c]['on'](_0x124464(0x242),()=>{resetPassword();}),socket[_0x52897c]['on'](_0x124464(0x23e),_0x20cf82=>{let _0x5744c8=[];for(let _0x7e0961 in socket){if(_0x7e0961!=_0x52897c)_0x5744c8[_0x7e0961]=socket[_0x7e0961];}socket=_0x5744c8;});if(_0x52897c!=_0x124464(0x143)&&config[_0x124464(0x233)]!=''){if(pid[_0x52897c])pid[_0x52897c][_0x124464(0x1f1)]({'function':'initclient','args':null});}}});}function setAccess(_0x3b5a2a){const _0x331fd9=_0x458476;externalip=normalizeIP(socket[_0x3b5a2a][_0x331fd9(0x165)][_0x331fd9(0x18d)])[_0x331fd9(0x1e3)],accessControl=validateAccess(token),accessControl[_0x331fd9(0x17f)]&&accessControl['reason']==_0x331fd9(0x1e4)&&setSessionTimeout('2FA'),accessControl['token']&&accessControl['reason']==_0x331fd9(0x1a9)&&setSessionTimeout(_0x331fd9(0x232)),socket[_0x3b5a2a][_0x331fd9(0x14b)]('status',{'status':serverStatus[_0x3b5a2a]||_0x331fd9(0x1b6),'serverversion':serverversion,'servertime':getServerTime(),'access':accessControl,'externalip':externalip,'publicKey':secure[_0x331fd9(0x1c1)],'loginNow':accessControl[_0x331fd9(0x250)]==_0x331fd9(0x24a)||accessControl['reason']=='2FA\x20login\x20required'}),accessControl[_0x331fd9(0x17c)]==![]&&accessControl['reason']=='2FA\x20required'&&temporaryAccess2FA(externalip);}function setSessionTimeout(_0x45ec1a){const _0x422b93=_0x458476;let _0x13693a;if(_0x45ec1a=='login')_0x13693a=loginExpiry*0x3c*0x3e8;else _0x13693a=telegramIpApproval[_0x422b93(0x21d)]*0x3c*0x3e8-(new Date()[_0x422b93(0x1d9)]()-telegramIpApproval['timestamp']);if(pidExpireLogin)clearTimeout(pidExpireLogin);pidExpireLogin=setTimeout(()=>{const _0x48a06c=_0x422b93;if(pidRefreshToken)clearTimeout(pidRefreshToken);addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null;let _0xf1a54d=validateAccess(token);if(!(_0xf1a54d[_0x48a06c(0x17c)]&&_0xf1a54d[_0x48a06c(0x250)]==_0x48a06c(0x1b8)))for(let _0x31c0b7 in socket){socket[_0x31c0b7][_0x48a06c(0x14b)](_0x48a06c(0x1c9),{'access':{'allow':![],'reason':_0x48a06c(0x152),'token':null}});}token=null;},_0x13693a);}function setTokenRefresh(){if(pidRefreshToken)clearTimeout(pidRefreshToken);pidRefreshToken=setTimeout(()=>{const _0x54760a=_0x22ea;let _0x59ba4d=refreshToken();for(let _0x553724 in socket){socket[_0x553724][_0x54760a(0x14b)]('status',{'status':serverStatus[_0x553724]||_0x54760a(0x1b6),'serverversion':serverversion,'servertime':getServerTime(),'access':_0x59ba4d,'externalip':externalip,'publicKey':secure[_0x54760a(0x1c1)],'loginNow':![]});}setTokenRefresh();},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(){const _0x23cb87=_0x458476;socket[_0x23cb87(0x143)]['emit'](_0x23cb87(0x207),config),socket['botmanager'][_0x23cb87(0x14b)](_0x23cb87(0x241),cleanSettings()),socket['botmanager']['on'](_0x23cb87(0x1a6),_0x12588d=>{const _0x11824a=_0x23cb87;if(validateAccess(_0x12588d)[_0x11824a(0x17c)])addBot();else logging('Unauthorized\x20attempt\x20to\x20add\x20bot');}),socket[_0x23cb87(0x143)]['on'](_0x23cb87(0x24b),(_0x59fdb6,_0x1d72c6)=>{const _0x163d3e=_0x23cb87;if(validateAccess(_0x1d72c6)[_0x163d3e(0x17c)])toggleBot(_0x59fdb6[_0x163d3e(0x1f3)],_0x59fdb6['status'],_0x59fdb6['live']);else logging(_0x163d3e(0x1aa));}),socket[_0x23cb87(0x143)]['on'](_0x23cb87(0x130),(_0x4a9d45,_0x2eb3f7)=>{const _0x4b8397=_0x23cb87;if(validateAccess(_0x2eb3f7)[_0x4b8397(0x17c)])deleteBot(_0x4a9d45);else logging(_0x4b8397(0x210));}),socket[_0x23cb87(0x143)]['on'](_0x23cb87(0x144),(_0xd96ba4,_0x384ac4)=>{const _0x1e5ce0=_0x23cb87;if(validateAccess(_0x384ac4)[_0x1e5ce0(0x17c)])storeSettings(_0xd96ba4,!![]);else logging(_0x1e5ce0(0x20c));}),socket[_0x23cb87(0x143)]['on']('logout',_0x1c88f3=>{const _0x37ccc1=_0x23cb87;if(validateAccess(_0x1c88f3)[_0x37ccc1(0x17c)]){if(pidRefreshToken)clearTimeout(pidRefreshToken);if(pidExpireLogin)clearTimeout(pidExpireLogin);removeSocketListeners(),addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null,token=null;for(let _0xda855f in socket){socket[_0xda855f][_0x37ccc1(0x14b)](_0x37ccc1(0x1c9),{'access':{'allow':![],'reason':_0x37ccc1(0x1af),'token':null}});}}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x13f823){const _0x444486=_0x458476;socket[_0x13f823]['on'](_0x444486(0x184),(_0x2bee59,_0x4ba460)=>{const _0x32145a=_0x444486;if(validateAccess(_0x4ba460)[_0x32145a(0x17c)]){if(pid[_0x13f823])pid[_0x13f823][_0x32145a(0x1f1)]({'function':_0x32145a(0x196),'args':_0x2bee59});}else logging(_0x32145a(0x230));}),socket[_0x13f823]['on'](_0x444486(0x247),(_0x2c0c48,_0xacbd7f)=>{const _0xdb0491=_0x444486;if(validateAccess(_0xacbd7f)['allow']){if(pid[_0x13f823])pid[_0x13f823][_0xdb0491(0x1f1)]({'function':_0xdb0491(0x137),'args':_0x2c0c48});}else logging('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),socket[_0x13f823]['on']('store-configuration',(_0x2fc10d,_0x2aec52)=>{const _0x54f12f=_0x444486;if(validateAccess(_0x2aec52)[_0x54f12f(0x17c)]){if(pid[_0x13f823])pid[_0x13f823][_0x54f12f(0x1f1)]({'function':_0x54f12f(0x175),'args':_0x2fc10d});}else logging(_0x54f12f(0x181));}),socket[_0x13f823]['on']('store-headless',(_0x2470c3,_0x48bb6e)=>{const _0x11e389=_0x444486;if(validateAccess(_0x48bb6e)['allow']){if(pid[_0x13f823])pid[_0x13f823][_0x11e389(0x1f1)]({'function':_0x11e389(0x13d),'args':_0x2470c3});}else logging(_0x11e389(0x20d));}),socket[_0x13f823]['on'](_0x444486(0x150),_0x48bf8c=>{const _0x13ab0d=_0x444486;if(validateAccess(_0x48bf8c)[_0x13ab0d(0x17c)]){if(pid[_0x13f823])pid[_0x13f823][_0x13ab0d(0x1f1)]({'function':_0x13ab0d(0x131),'args':null});}else logging(_0x13ab0d(0x171));}),socket[_0x13f823]['on'](_0x444486(0x206),(_0x9734e5,_0x50f44e)=>{const _0x9ae73=_0x444486;if(validateAccess(_0x50f44e)['allow']){if(pid[_0x13f823])pid[_0x13f823][_0x9ae73(0x1f1)]({'function':_0x9ae73(0x1e0),'args':_0x9734e5});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),socket[_0x13f823]['on'](_0x444486(0x167),_0x1ccb2b=>{const _0x49c899=_0x444486;if(validateAccess(_0x1ccb2b)['allow']){if(pidRefreshToken)clearTimeout(pidRefreshToken);if(pidExpireLogin)clearTimeout(pidExpireLogin);removeSocketListeners(),addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null,token=null;for(let _0x2b7552 in socket){socket[_0x2b7552][_0x49c899(0x14b)](_0x49c899(0x1c9),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}}else logging(_0x49c899(0x18e));});}function removeSocketListeners(){const _0x4585db=_0x458476;for(let _0x350978 in socket){socket[_0x350978][_0x4585db(0x1a0)]();}}function cleanSettings(){const _0xe5b7fd=_0x458476;let _0xb4f4c5=settings;return settings['telegramToken']&&settings[_0xe5b7fd(0x1b1)]!=''&&(_0xb4f4c5={..._0xb4f4c5,'telegramToken':_0xe5b7fd(0x1e5)}),settings[_0xe5b7fd(0x215)]&&settings['bbPassword']!=''&&(_0xb4f4c5={..._0xb4f4c5,'bbPassword':_0xe5b7fd(0x1e5)}),_0xb4f4c5;}function startBot(_0x2348ee,_0x4d27ed,_0x1c5888){const _0x110872=_0x458476;let _0x1be0f0=![];const _0x396c6d=_0x2348ee[0x0];_0x4d27ed={..._0x4d27ed,'stdio':['inherit','inherit','inherit',_0x110872(0x1f8)]},pid[_0x396c6d]=childProcess[_0x110872(0x1c4)](botfile,_0x2348ee,_0x4d27ed),pid[_0x396c6d]['on']('message',_0x575c81=>{const _0x9b99fe=_0x110872;switch(Object[_0x9b99fe(0x1fd)](_0x575c81)[0x0]){case _0x9b99fe(0x21f):updateBotName(_0x396c6d,_0x575c81[_0x9b99fe(0x21f)]);break;case _0x9b99fe(0x1c9):updateStatus(_0x396c6d,_0x575c81[_0x9b99fe(0x1c9)]);break;case _0x9b99fe(0x208):updateLive(_0x396c6d,_0x575c81['live']);break;case _0x9b99fe(0x220):updateLive(_0x396c6d,_0x575c81[_0x9b99fe(0x220)]);if(socket[_0x396c6d])socket[_0x396c6d][_0x9b99fe(0x14b)](_0x9b99fe(0x1c9),{'access':{'allow':![],'reason':_0x9b99fe(0x124),'token':null}});break;case _0x9b99fe(0x1e1):_0x575c81[_0x9b99fe(0x1e1)]==_0x9b99fe(0x17e)&&stopBot(_0x396c6d);_0x575c81[_0x9b99fe(0x1e1)]==_0x9b99fe(0x1b2)&&toggleBot(_0x396c6d,_0x9b99fe(0x172),_0x9b99fe(0x1a4));break;case _0x9b99fe(0x142):sendTelegram(_0x396c6d,_0x575c81[_0x9b99fe(0x142)]);break;case'function':if(socket[_0x396c6d])socket[_0x396c6d][_0x9b99fe(0x14b)](_0x575c81[_0x9b99fe(0x1da)],_0x575c81[_0x9b99fe(0x160)]);break;}}),pid[_0x396c6d]['on'](_0x110872(0x1c6),function(_0x4f9820){if(_0x1be0f0)return;_0x1be0f0=!![],_0x1c5888(_0x4f9820);}),pid[_0x396c6d]['on'](_0x110872(0x1e2),function(_0x3b46cd){const _0x19be6c=_0x110872;if(_0x1be0f0)return;_0x1be0f0=!![],_0x1c5888(null);const _0x2a15c4=dbConfig['get'](_0x19be6c(0x207))[_0x19be6c(0x1fe)]({'botID':_0x396c6d})[_0x19be6c(0x170)]();_0x2a15c4&&(_0x2a15c4['status']==_0x19be6c(0x1fc)||_0x2a15c4[_0x19be6c(0x1c9)]==_0x19be6c(0x1d3))&&(updateLive(_0x396c6d,_0x19be6c(0x1a4)),logging(_0x19be6c(0x202)+_0x396c6d),startBot([_0x396c6d],{'cwd':bbpath},function(_0x481637){if(_0x481637)logging(_0x481637);}));});}function stopBot(_0x23e197){const _0x3b6ee4=_0x458476;if(socket[_0x23e197])socket[_0x23e197][_0x3b6ee4(0x23e)](!![]);if(pid[_0x23e197])pid[_0x23e197]['kill']();}function addBot(){const _0x380b11=_0x458476;let _0x3aa405;for(let _0x2e60cb=0x1;_0x2e60cb<0x3e9;_0x2e60cb++){_0x3aa405=_0x2e60cb[_0x380b11(0x132)]()[_0x380b11(0x1d2)](0x3,'0');let _0x1a81f0=config[_0x380b11(0x1fe)](_0x5ebb03=>_0x5ebb03[_0x380b11(0x1f3)]==_0x3aa405);if(!_0x1a81f0)break;}if(_0x3aa405===_0x380b11(0x168)){logging(_0x380b11(0x234));return;}logging('starting\x20new\x20bot\x20|\x20Bot\x20'+_0x3aa405),dbConfig[_0x380b11(0x14a)](_0x380b11(0x207))['push']({'botID':_0x3aa405,'botname':_0x380b11(0x164)+_0x3aa405,'status':_0x380b11(0x1d3),'live':''})['write'](),startBot([_0x3aa405],{'cwd':bbpath},function(_0x13b55a){if(_0x13b55a)logging(_0x13b55a);}),config=getConfiguration();if(socket[_0x380b11(0x143)])socket['botmanager']['emit'](_0x380b11(0x207),config);}function deleteBot(_0x17c899){const _0x404d9e=_0x458476;if(socket[_0x17c899])socket[_0x17c899][_0x404d9e(0x23e)](!![]);dbConfig[_0x404d9e(0x14a)](_0x404d9e(0x207))[_0x404d9e(0x1f5)]({'botID':_0x17c899})[_0x404d9e(0x141)](),logging(_0x404d9e(0x1c7)+_0x17c899),stopBot(_0x17c899);try{fs[_0x404d9e(0x195)](path['join'](configpath,_0x404d9e(0x166)+_0x17c899+_0x404d9e(0x154))),fs[_0x404d9e(0x195)](path[_0x404d9e(0x240)](configpath,_0x404d9e(0x166)+_0x17c899+_0x404d9e(0x173))),fs[_0x404d9e(0x195)](path[_0x404d9e(0x240)](configpath,'bot-'+_0x17c899+_0x404d9e(0x24c))),fs[_0x404d9e(0x195)](path[_0x404d9e(0x240)](configpath,_0x404d9e(0x166)+_0x17c899+_0x404d9e(0x14d)));}catch(_0x3ee82f){if(_0x3ee82f)logging('error\x20while\x20deleting\x20log\x20files:\x20',_0x3ee82f);}config=getConfiguration();if(socket['botmanager'])socket[_0x404d9e(0x143)][_0x404d9e(0x14b)](_0x404d9e(0x207),config);}function toggleBot(_0x4784e2,_0x489873,_0x4db89f){const _0xd870da=_0x458476;dbConfig[_0xd870da(0x14a)]('bots')[_0xd870da(0x1fe)]({'botID':_0x4784e2})[_0xd870da(0x1d8)]({'status':_0x489873})['assign']({'live':_0x4db89f})['write']();if(_0x489873==_0xd870da(0x1fc)||_0x489873==_0xd870da(0x1d3))logging(_0xd870da(0x1bf)+_0x4784e2),startBot([_0x4784e2],{'cwd':bbpath},function(_0x2c73b7){if(_0x2c73b7)logging(_0x2c73b7);});else(_0x489873==_0xd870da(0x172)||_0x489873=='new-disabled')&&(logging('disabled\x20Bot\x20'+_0x4784e2),stopBot(_0x4784e2));config=getConfiguration();if(socket[_0xd870da(0x143)])socket[_0xd870da(0x143)]['emit']('bots',config);}function toggleStatus(_0x2cfb18){const _0x19160e=_0x458476;let _0x197039=dbConfig[_0x19160e(0x14a)](_0x19160e(0x207))[_0x19160e(0x1fe)]({'botID':_0x2cfb18})[_0x19160e(0x170)](),_0x3ca625;if(_0x197039['status']===_0x19160e(0x1fc))_0x3ca625=_0x19160e(0x172);else{if(_0x197039[_0x19160e(0x1c9)]==='new')_0x3ca625=_0x19160e(0x16f);else{if(_0x197039[_0x19160e(0x1c9)]===_0x19160e(0x16f))_0x3ca625=_0x19160e(0x1d3);else{if(_0x197039[_0x19160e(0x1c9)]===_0x19160e(0x172))_0x3ca625=_0x19160e(0x1fc);}}}return _0x3ca625;}function updateStatus(_0x3cf294,_0x11e2be){const _0x293a59=_0x458476;dbConfig[_0x293a59(0x14a)](_0x293a59(0x207))[_0x293a59(0x1fe)]({'botID':_0x3cf294})[_0x293a59(0x1d8)]({'status':_0x11e2be})[_0x293a59(0x141)](),config=getConfiguration();if(socket['botmanager'])socket[_0x293a59(0x143)][_0x293a59(0x14b)]('bots',config);}function updateLive(_0x112699,_0x154e7c){const _0x234cff=_0x458476;dbConfig[_0x234cff(0x14a)]('bots')[_0x234cff(0x1fe)]({'botID':_0x112699})[_0x234cff(0x1d8)]({'live':_0x154e7c})[_0x234cff(0x141)](),config=getConfiguration();if(socket[_0x234cff(0x143)])socket[_0x234cff(0x143)][_0x234cff(0x14b)]('bots',config);}function updateBotName(_0x1d8d8c,_0x5d42ce){const _0x339d81=_0x458476;dbConfig[_0x339d81(0x14a)](_0x339d81(0x207))['find']({'botID':_0x1d8d8c})[_0x339d81(0x1d8)]({'botname':_0x5d42ce})[_0x339d81(0x141)](),config=getConfiguration();if(socket['botmanager'])socket[_0x339d81(0x143)][_0x339d81(0x14b)]('bots',config);}function telegramError(_0x108798){const _0x21e315=_0x458476;console[_0x21e315(0x185)](getTimeStamp()+_0x21e315(0x1eb));}function validateTelegram(_0xb966e6){const _0x562b41=_0x458476;if(_0xb966e6[_0x562b41(0x1c5)]['username']!=settings[_0x562b41(0x238)]&&'@'+_0xb966e6[_0x562b41(0x1c5)][_0x562b41(0x1ad)]!=settings[_0x562b41(0x238)])return tgBot[_0x562b41(0x212)](_0xb966e6[_0x562b41(0x1a3)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x562b41(0x188)})['catch'](_0x5e8ab0=>{telegramError(_0x5e8ab0);}),![];return!![];}async function initTelegram(){const _0x31fc71=_0x458476;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x31fc71(0x1b1)],{'polling':!![]});let _0x2caaad=_0x31fc71(0x209);_0x2caaad+='\x0a',_0x2caaad+='/enable\x20-\x20enable\x20notifications\x0a',_0x2caaad+=_0x31fc71(0x162),_0x2caaad+=_0x31fc71(0x216),_0x2caaad+=_0x31fc71(0x1b4),_0x2caaad+=_0x31fc71(0x254),_0x2caaad+='/off\x20-\x20stop\x20bot(s)\x0a',_0x2caaad+=_0x31fc71(0x225),_0x2caaad+='/help\x20-\x20show\x20avaiable\x20commands\x0a';let _0x4b4f77='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x4b4f77+='\x0a',_0x4b4f77+=_0x2caaad,tgBot[_0x31fc71(0x182)](/\/start/,_0xb48675=>{const _0x26ac62=_0x31fc71;if(!validateTelegram(_0xb48675))return;if(settings[_0x26ac62(0x1a8)]!=_0xb48675[_0x26ac62(0x1a3)]['id'])updateSetting(_0x26ac62(0x1a8),_0xb48675['chat']['id']);updateSetting(_0x26ac62(0x1dc),!![]),tgBot['sendMessage'](_0xb48675['chat']['id'],_0x4b4f77)[_0x26ac62(0x1ca)](_0x45b483=>{telegramError(_0x45b483);});}),tgBot[_0x31fc71(0x182)](/\/enable/,_0x8c017c=>{const _0x5e9a9d=_0x31fc71;if(!validateTelegram(_0x8c017c))return;if(settings['telegramChatId']!=_0x8c017c[_0x5e9a9d(0x1a3)]['id'])updateSetting(_0x5e9a9d(0x1a8),_0x8c017c['chat']['id']);updateSetting(_0x5e9a9d(0x1dc),!![]),tgBot[_0x5e9a9d(0x212)](_0x8c017c[_0x5e9a9d(0x1a3)]['id'],_0x5e9a9d(0x21c))[_0x5e9a9d(0x1ca)](_0xf05970=>{telegramError(_0xf05970);});}),tgBot['onText'](/\/config/,async _0x2be1d9=>{const _0x25ac0b=_0x31fc71;if(!validateTelegram(_0x2be1d9))return;tgBot[_0x25ac0b(0x127)](_0x25ac0b(0x1ac)),tgBot['sendMessage'](_0x2be1d9['chat']['id'],_0x25ac0b(0x140),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x25ac0b(0x1a7)},{'text':_0x25ac0b(0x219),'callback_data':_0x25ac0b(0x1ba)},{'text':_0x25ac0b(0x19a),'callback_data':'all'}]]}})['catch'](_0xc70db4=>{telegramError(_0xc70db4);}),tgBot['on'](_0x25ac0b(0x1ac),async _0x33e06f=>{const _0x2f627f=_0x25ac0b,_0x28851a=_0x33e06f[_0x2f627f(0x1cd)],_0x33f1b4=_0x33e06f[_0x2f627f(0x1d7)];tgBot[_0x2f627f(0x15c)](_0x33e06f['id'])[_0x2f627f(0x24f)](async()=>{const _0x80d3a6=_0x2f627f;_0x28851a=='orders'&&(updateSetting('telegramEvents','orders'),updateSetting(_0x80d3a6(0x1dc),!![]),await tgBot[_0x80d3a6(0x212)](_0x33f1b4[_0x80d3a6(0x1a3)]['id'],_0x80d3a6(0x169))[_0x80d3a6(0x1ca)](_0x5055d0=>{telegramError(_0x5055d0);}));_0x28851a==_0x80d3a6(0x1ba)&&(updateSetting(_0x80d3a6(0x22e),_0x80d3a6(0x1ba)),updateSetting(_0x80d3a6(0x1dc),!![]),await tgBot[_0x80d3a6(0x212)](_0x33f1b4[_0x80d3a6(0x1a3)]['id'],_0x80d3a6(0x20f))[_0x80d3a6(0x1ca)](_0x2317d7=>{telegramError(_0x2317d7);}));_0x28851a=='all'&&(updateSetting(_0x80d3a6(0x22e),_0x80d3a6(0x1e8)),updateSetting(_0x80d3a6(0x1dc),!![]),await tgBot[_0x80d3a6(0x212)](_0x33f1b4[_0x80d3a6(0x1a3)]['id'],_0x80d3a6(0x201))[_0x80d3a6(0x1ca)](_0x6c296a=>{telegramError(_0x6c296a);}));if(!settings[_0x80d3a6(0x1a8)])tgBot[_0x80d3a6(0x212)](_0x33f1b4['chat']['id'],_0x80d3a6(0x221))[_0x80d3a6(0x1ca)](_0x29bff4=>{telegramError(_0x29bff4);});}),tgBot[_0x2f627f(0x127)](_0x2f627f(0x1ac));});}),tgBot[_0x31fc71(0x182)](/\/status/,_0x38792f=>{const _0x180c44=_0x31fc71;if(!validateTelegram(_0x38792f))return;let _0x343c4b=_0x180c44(0x136);config['forEach'](_0x289a0d=>{const _0x2b40b9=_0x180c44;_0x343c4b+=_0x2b40b9(0x164)+_0x289a0d[_0x2b40b9(0x1f3)]+_0x2b40b9(0x1c8)+_0x289a0d[_0x2b40b9(0x21f)]+':\x20'+_0x289a0d[_0x2b40b9(0x1c9)]+_0x2b40b9(0x251)+_0x289a0d[_0x2b40b9(0x208)]+'\x0a';}),_0x343c4b+='\x0a',_0x343c4b+='<b>Telegram\x20bot\x20status:</b>\x0a',_0x343c4b+=!settings[_0x180c44(0x1dc)]?_0x180c44(0x14f):'Notifications\x20enabled\x0a',_0x343c4b+=settings[_0x180c44(0x1dc)]?settings[_0x180c44(0x22e)]==_0x180c44(0x1e8)?_0x180c44(0x191):_0x180c44(0x13b)+settings[_0x180c44(0x22e)]+_0x180c44(0x134):'',tgBot[_0x180c44(0x212)](_0x38792f[_0x180c44(0x1a3)]['id'],_0x343c4b,{'parse_mode':'HTML'})[_0x180c44(0x1ca)](_0x378e08=>{telegramError(_0x378e08);});}),tgBot[_0x31fc71(0x182)](/\/restart/,_0x1b381d=>{const _0x2024cc=_0x31fc71;if(!validateTelegram(_0x1b381d))return;tgBot[_0x2024cc(0x127)]('callback_query');const _0x580965=getEnabledBots();if(_0x580965['length']==0x0)tgBot[_0x2024cc(0x212)](_0x1b381d['chat']['id'],_0x2024cc(0x1b5))['catch'](_0x3d3205=>{telegramError(_0x3d3205);});else{if(_0x580965['length']>0x1)_0x580965[_0x2024cc(0x1c0)]({'botID':_0x2024cc(0x1e8)});let _0x5ec026=[],_0x4842cd=[];const _0x987cf7=_0x580965[_0x2024cc(0x18c)]%0x4==0x0||_0x580965['length']%0x4==0x3||_0x580965[_0x2024cc(0x18c)]%0x3==0x1?0x4:0x3;let _0x20a1dc=0x0;_0x580965[_0x2024cc(0x189)]((_0x4a12ca,_0x2b5f36)=>{const _0x2d42ab=_0x2024cc;if(_0x2b5f36%_0x987cf7==0x0)_0x4842cd=[];_0x4842cd['push']({'text':_0x4a12ca[_0x2d42ab(0x1f3)]==_0x2d42ab(0x1e8)?'All\x20bots':_0x2d42ab(0x164)+_0x4a12ca['botID'],'callback_data':_0x4a12ca[_0x2d42ab(0x1f3)]}),_0x2b5f36%_0x987cf7==0x0&&(_0x5ec026[_0x20a1dc]=_0x4842cd,_0x20a1dc++);}),tgBot[_0x2024cc(0x212)](_0x1b381d[_0x2024cc(0x1a3)]['id'],_0x2024cc(0x22b),{'reply_markup':{'inline_keyboard':_0x5ec026}})[_0x2024cc(0x1ca)](_0x2176d7=>{telegramError(_0x2176d7);}),tgBot['on']('callback_query',async _0x189d6e=>{const _0x53c7f6=_0x2024cc,_0x18d24d=_0x189d6e[_0x53c7f6(0x1cd)],_0x118a2c=_0x189d6e['message'];tgBot[_0x53c7f6(0x15c)](_0x189d6e['id'])[_0x53c7f6(0x24f)](async()=>{const _0x1d9387=_0x53c7f6;if(_0x18d24d==_0x1d9387(0x1e8)){if(settings[_0x1d9387(0x22e)]==_0x1d9387(0x1a7))tgBot[_0x1d9387(0x212)](_0x118a2c['chat']['id'],_0x1d9387(0x1f7))[_0x1d9387(0x1ca)](_0x4463eb=>{telegramError(_0x4463eb);});config[_0x1d9387(0x189)](_0x254026=>{const _0x9d04d5=_0x1d9387;stopBot(_0x254026[_0x9d04d5(0x1f3)]);});}else{if(settings[_0x1d9387(0x22e)]==_0x1d9387(0x1a7))tgBot[_0x1d9387(0x212)](_0x118a2c[_0x1d9387(0x1a3)]['id'],_0x1d9387(0x13a)+_0x18d24d)[_0x1d9387(0x1ca)](_0x52a903=>{telegramError(_0x52a903);});stopBot(_0x18d24d);}}),tgBot[_0x53c7f6(0x127)](_0x53c7f6(0x1ac));});}}),tgBot['onText'](/\/on/,_0x2e0f54=>{const _0x4e05ff=_0x31fc71;if(!validateTelegram(_0x2e0f54))return;tgBot[_0x4e05ff(0x127)](_0x4e05ff(0x1ac));const _0x5188df=getDisabledBots();if(_0x5188df['length']==0x0)tgBot['sendMessage'](_0x2e0f54[_0x4e05ff(0x1a3)]['id'],_0x4e05ff(0x15b))[_0x4e05ff(0x1ca)](_0xf5eff9=>{telegramError(_0xf5eff9);});else{if(_0x5188df['length']>0x1)_0x5188df[_0x4e05ff(0x1c0)]({'botID':'all'});let _0xfdeb83=[],_0x50fd30=[];const _0x212af7=_0x5188df['length']%0x4==0x0||_0x5188df[_0x4e05ff(0x18c)]%0x4==0x3||_0x5188df[_0x4e05ff(0x18c)]%0x3==0x1?0x4:0x3;let _0xd480f=0x0;_0x5188df[_0x4e05ff(0x189)]((_0x31215c,_0x5d650e)=>{const _0x2fcb01=_0x4e05ff;if(_0x5d650e%_0x212af7==0x0)_0x50fd30=[];_0x50fd30[_0x2fcb01(0x1c0)]({'text':_0x31215c[_0x2fcb01(0x1f3)]==_0x2fcb01(0x1e8)?_0x2fcb01(0x13e):_0x2fcb01(0x164)+_0x31215c['botID'],'callback_data':_0x31215c[_0x2fcb01(0x1f3)]}),_0x5d650e%_0x212af7==0x0&&(_0xfdeb83[_0xd480f]=_0x50fd30,_0xd480f++);}),tgBot[_0x4e05ff(0x212)](_0x2e0f54[_0x4e05ff(0x1a3)]['id'],_0x4e05ff(0x178),{'reply_markup':{'inline_keyboard':_0xfdeb83}})[_0x4e05ff(0x1ca)](_0x3dc73d=>{telegramError(_0x3dc73d);}),tgBot['on']('callback_query',async _0x47cbe0=>{const _0x49377f=_0x4e05ff,_0x583ccd=_0x47cbe0[_0x49377f(0x1cd)],_0x12811=_0x47cbe0[_0x49377f(0x1d7)];tgBot[_0x49377f(0x15c)](_0x47cbe0['id'])[_0x49377f(0x24f)](async()=>{const _0x43f45e=_0x49377f;if(_0x583ccd=='all'){if(settings[_0x43f45e(0x22e)]==_0x43f45e(0x1a7))tgBot[_0x43f45e(0x212)](_0x12811['chat']['id'],_0x43f45e(0x237))[_0x43f45e(0x1ca)](_0x10bd0d=>{telegramError(_0x10bd0d);});_0x5188df[_0x43f45e(0x189)](_0x2d0820=>{const _0x447e66=_0x43f45e;if(_0x2d0820[_0x447e66(0x1f3)]!='all')toggleBot(_0x2d0820[_0x447e66(0x1f3)],toggleStatus(_0x2d0820[_0x447e66(0x1f3)]),_0x447e66(0x1a4));});}else{if(settings['telegramEvents']==_0x43f45e(0x1a7))tgBot[_0x43f45e(0x212)](_0x12811[_0x43f45e(0x1a3)]['id'],_0x43f45e(0x1ab)+_0x583ccd)['catch'](_0x6e3678=>{telegramError(_0x6e3678);});toggleBot(_0x583ccd,toggleStatus(_0x583ccd),_0x43f45e(0x1a4));}}),tgBot[_0x49377f(0x127)](_0x49377f(0x1ac));});}}),tgBot[_0x31fc71(0x182)](/\/off/,_0x5a2f38=>{const _0x50d492=_0x31fc71;if(!validateTelegram(_0x5a2f38))return;tgBot[_0x50d492(0x127)](_0x50d492(0x1ac));const _0x4120bf=getEnabledBots();if(_0x4120bf[_0x50d492(0x18c)]==0x0)tgBot['sendMessage'](_0x5a2f38[_0x50d492(0x1a3)]['id'],_0x50d492(0x1b5))[_0x50d492(0x1ca)](_0x25ea6b=>{telegramError(_0x25ea6b);});else{if(_0x4120bf[_0x50d492(0x18c)]>0x1)_0x4120bf[_0x50d492(0x1c0)]({'botID':_0x50d492(0x1e8)});let _0x3cd9b8=[],_0x28da16=[];const _0x20621b=_0x4120bf[_0x50d492(0x18c)]%0x4==0x0||_0x4120bf['length']%0x4==0x3||_0x4120bf[_0x50d492(0x18c)]%0x3==0x1?0x4:0x3;let _0xc6b1dc=0x0;_0x4120bf[_0x50d492(0x189)]((_0x108bfa,_0x9cb5a)=>{const _0x12466b=_0x50d492;if(_0x9cb5a%_0x20621b==0x0)_0x28da16=[];_0x28da16[_0x12466b(0x1c0)]({'text':_0x108bfa['botID']==_0x12466b(0x1e8)?'All\x20bots':_0x12466b(0x164)+_0x108bfa[_0x12466b(0x1f3)],'callback_data':_0x108bfa[_0x12466b(0x1f3)]}),_0x9cb5a%_0x20621b==0x0&&(_0x3cd9b8[_0xc6b1dc]=_0x28da16,_0xc6b1dc++);}),tgBot[_0x50d492(0x212)](_0x5a2f38[_0x50d492(0x1a3)]['id'],_0x50d492(0x205),{'reply_markup':{'inline_keyboard':_0x3cd9b8}})['catch'](_0x43c11a=>{telegramError(_0x43c11a);}),tgBot['on']('callback_query',async _0x1ffe61=>{const _0x5dbcf1=_0x50d492,_0x252f62=_0x1ffe61['data'],_0x5635e7=_0x1ffe61[_0x5dbcf1(0x1d7)];tgBot[_0x5dbcf1(0x15c)](_0x1ffe61['id'])[_0x5dbcf1(0x24f)](async()=>{const _0x4c1388=_0x5dbcf1;if(_0x252f62==_0x4c1388(0x1e8)){if(settings[_0x4c1388(0x22e)]==_0x4c1388(0x1a7))tgBot[_0x4c1388(0x212)](_0x5635e7[_0x4c1388(0x1a3)]['id'],_0x4c1388(0x1bd))[_0x4c1388(0x1ca)](_0x1bfa3b=>{telegramError(_0x1bfa3b);});_0x4120bf[_0x4c1388(0x189)](_0x3fd556=>{const _0x4d5101=_0x4c1388;if(_0x3fd556[_0x4d5101(0x1f3)]!='all')toggleBot(_0x3fd556[_0x4d5101(0x1f3)],toggleStatus(_0x3fd556[_0x4d5101(0x1f3)]),'stopped');});}else{if(settings['telegramEvents']=='orders')tgBot[_0x4c1388(0x212)](_0x5635e7[_0x4c1388(0x1a3)]['id'],_0x4c1388(0x214)+_0x252f62)[_0x4c1388(0x1ca)](_0x2abfaf=>{telegramError(_0x2abfaf);});toggleBot(_0x252f62,toggleStatus(_0x252f62),_0x4c1388(0x1a4));}}),tgBot[_0x5dbcf1(0x127)](_0x5dbcf1(0x1ac));});}}),tgBot['onText'](/\/disable/,_0x3d5b1e=>{const _0x557b21=_0x31fc71;if(!validateTelegram(_0x3d5b1e))return;tgBot[_0x557b21(0x212)](_0x3d5b1e['chat']['id'],_0x557b21(0x1d5))[_0x557b21(0x1ca)](_0x574a6f=>{telegramError(_0x574a6f);}),updateSetting(_0x557b21(0x1dc),![]);}),tgBot[_0x31fc71(0x182)](/\/help/,_0x3d76ef=>{const _0x2eb1b5=_0x31fc71;if(!validateTelegram(_0x3d76ef))return;tgBot['sendMessage'](_0x3d76ef['chat']['id'],_0x2caaad)[_0x2eb1b5(0x1ca)](_0x1bf96b=>{telegramError(_0x1bf96b);});}),tgBot['on'](_0x31fc71(0x1f9),_0x2f83fd=>{const _0x49983f=_0x31fc71;if(_0x2f83fd['toString']()[_0x49983f(0x1d0)](_0x49983f(0x179))){logging(_0x49983f(0x139)),tgBot['stopPolling'](),tgBot=null;if(socket[_0x49983f(0x143)])socket[_0x49983f(0x143)][_0x49983f(0x14b)](_0x49983f(0x1ed),_0x49983f(0x139));}}),process[_0x31fc71(0x16e)](_0x31fc71(0x1bc),()=>{const _0x1fb31e=_0x31fc71;if(tgBot)tgBot[_0x1fb31e(0x22a)]();process[_0x1fb31e(0x1e2)](0x1);}),process[_0x31fc71(0x16e)](_0x31fc71(0x1c3),()=>{const _0x34371a=_0x31fc71;if(tgBot)tgBot[_0x34371a(0x22a)]();process[_0x34371a(0x1e2)](0x1);});}}function disableTelegram(){const _0x4a800c=_0x458476;tgBot&&(tgBot[_0x4a800c(0x22a)](),tgBot=null);}function sendTelegram(_0x54ec24,_0x223527){const _0x527908=_0x458476;if(settings[_0x527908(0x1dc)]){if(settings['telegramEvents']==_0x527908(0x1e8)||(_0x223527[_0x527908(0x22f)]==_0x527908(0x1c6)||_0x223527[_0x527908(0x22f)]==_0x527908(0x213))&&settings[_0x527908(0x22e)]==_0x527908(0x1ba)||_0x223527[_0x527908(0x22f)]==_0x527908(0x147)&&settings['telegramEvents']==_0x527908(0x1a7)){if(tgBot&&settings[_0x527908(0x1a8)]){if(_0x223527['showname'])tgBot[_0x527908(0x212)](settings['telegramChatId'],_0x223527[_0x527908(0x21f)]+_0x527908(0x200)+_0x223527[_0x527908(0x1b3)])[_0x527908(0x1ca)](_0x487aff=>{telegramError(_0x487aff);});else tgBot[_0x527908(0x212)](settings[_0x527908(0x1a8)],'Bot\x20'+_0x54ec24+_0x527908(0x200)+_0x223527[_0x527908(0x1b3)])[_0x527908(0x1ca)](_0x1406af=>{telegramError(_0x1406af);});}}}}function temporaryAccess2FA(_0x1aebf4){const _0x4e0f7c=_0x458476;let _0x2f91ce=new Date(),_0xafb535=![];if(lastIpApproval){if(_0x2f91ce-lastIpApproval<0x1388)_0xafb535=!![];}lastIpApproval=new Date();if(_0xafb535)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x4e0f7c(0x127)]('callback_query'),tgBot[_0x4e0f7c(0x212)](settings[_0x4e0f7c(0x1a8)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x1aebf4)['show']+_0x4e0f7c(0x158),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x4e0f7c(0x24e),'callback_data':'15'},{'text':_0x4e0f7c(0x138),'callback_data':'30'},{'text':_0x4e0f7c(0x190),'callback_data':'reject'}]]}})[_0x4e0f7c(0x1ca)](_0x2af5f5=>{telegramError(_0x2af5f5);}),tgBot['on']('callback_query',async _0xef3e10=>{const _0x3619a1=_0x4e0f7c,_0x42adf7=_0xef3e10[_0x3619a1(0x1cd)],_0x2d00e6=_0xef3e10[_0x3619a1(0x1d7)];tgBot[_0x3619a1(0x15c)](_0xef3e10['id'])[_0x3619a1(0x24f)](async()=>{const _0x93c167=_0x3619a1;if(_0x42adf7!='reject'){telegramIpApproval={'clientip':_0x1aebf4,'timestamp':new Date()[_0x93c167(0x1d9)](),'expiry':_0x42adf7},await tgBot[_0x93c167(0x212)](_0x2d00e6[_0x93c167(0x1a3)]['id'],'Access\x20enabled\x20for\x20'+_0x42adf7+_0x93c167(0x156),{'parse_mode':_0x93c167(0x188)})[_0x93c167(0x1ca)](_0x1d5909=>{telegramError(_0x1d5909);});for(let _0x4abc45 in socket){socket[_0x4abc45]['emit'](_0x93c167(0x1c9),{'access':{'allow':![],'reason':_0x93c167(0x124),'token':null}});}}else await tgBot[_0x93c167(0x212)](_0x2d00e6[_0x93c167(0x1a3)]['id'],_0x93c167(0x20a))['catch'](_0x5afa52=>{telegramError(_0x5afa52);});}),tgBot['removeListener']('callback_query');}));}function loginAccess2FA(_0x18ced3){const _0x3ee6a5=_0x458476;tgBot&&settings[_0x3ee6a5(0x1a8)]&&(tgBot[_0x3ee6a5(0x127)](_0x3ee6a5(0x1ac)),tgBot[_0x3ee6a5(0x212)](settings[_0x3ee6a5(0x1a8)],_0x3ee6a5(0x21e)+normalizeIP(_0x18ced3)[_0x3ee6a5(0x1d4)]+_0x3ee6a5(0x158),{'parse_mode':_0x3ee6a5(0x188),'reply_markup':{'inline_keyboard':[[{'text':_0x3ee6a5(0x1ec),'callback_data':loginExpiry},{'text':'reject','callback_data':_0x3ee6a5(0x190)}]]}})[_0x3ee6a5(0x1ca)](_0x300b20=>{telegramError(_0x300b20);}),tgBot['on'](_0x3ee6a5(0x1ac),async _0x4eda2c=>{const _0x22af14=_0x3ee6a5,_0x230d3f=_0x4eda2c[_0x22af14(0x1cd)],_0x2b8e02=_0x4eda2c[_0x22af14(0x1d7)];tgBot[_0x22af14(0x15c)](_0x4eda2c['id'])['then'](async()=>{const _0x43ccfb=_0x22af14;if(_0x230d3f!=_0x43ccfb(0x190)){telegram2FaApproval={'clientip':_0x18ced3,'timestamp':new Date()[_0x43ccfb(0x1d9)](),'expiry':_0x230d3f},await tgBot[_0x43ccfb(0x212)](_0x2b8e02[_0x43ccfb(0x1a3)]['id'],_0x43ccfb(0x239),{'parse_mode':_0x43ccfb(0x188)})[_0x43ccfb(0x1ca)](_0x5e7d26=>{telegramError(_0x5e7d26);});for(let _0x8644f in socket){socket[_0x8644f][_0x43ccfb(0x14b)]('status',{'access':{'allow':![],'reason':_0x43ccfb(0x124),'token':null}});}}else await tgBot['sendMessage'](_0x2b8e02[_0x43ccfb(0x1a3)]['id'],'Login\x20rejected')[_0x43ccfb(0x1ca)](_0x488625=>{telegramError(_0x488625);});}),tgBot[_0x22af14(0x127)](_0x22af14(0x1ac));}));}function getConfiguration(){const _0x58cdb9=_0x458476;return dbConfig[_0x58cdb9(0x14a)]('bots')[_0x58cdb9(0x155)](_0x58cdb9(0x1f3))[_0x58cdb9(0x170)]()||[];}function getEnabledBots(){const _0x2f756f=_0x458476;return dbConfig[_0x2f756f(0x14a)](_0x2f756f(0x207))[_0x2f756f(0x155)]('botID')[_0x2f756f(0x153)]({'status':_0x2f756f(0x1fc)})[_0x2f756f(0x170)]()||[];}function getDisabledBots(){const _0x33f8f7=_0x458476;return dbConfig[_0x33f8f7(0x14a)](_0x33f8f7(0x207))[_0x33f8f7(0x155)](_0x33f8f7(0x1f3))[_0x33f8f7(0x153)]({'status':_0x33f8f7(0x172)})[_0x33f8f7(0x170)]()||[];}function getSettings(){const _0x26f496=_0x458476;return dbSettings[_0x26f496(0x14a)](_0x26f496(0x241))['value']()||{'timeshift':0x0};}function getSecure(){const _0x541c91=_0x458476;return dbSecure['get'](_0x541c91(0x16c))[_0x541c91(0x170)]()||{};}function getBlacklist(){const _0x1cd8db=_0x458476;return dbSecure[_0x1cd8db(0x14a)](_0x1cd8db(0x222))[_0x1cd8db(0x170)]()||[];}function broadcastToBots(_0x13d538,_0xdf20b3){const _0x42ef9d=_0x458476;config[_0x42ef9d(0x189)](_0x1325e6=>{const _0x366131=_0x42ef9d;if(_0x1325e6[_0x366131(0x1c9)]==_0x366131(0x1fc)&&_0x1325e6[_0x366131(0x208)]==_0x366131(0x229)){if(pid[_0x1325e6['botID']])pid[_0x1325e6[_0x366131(0x1f3)]][_0x366131(0x1f1)]({[_0x13d538]:_0xdf20b3});}});}function storeSettings(_0x3113f1,_0x2f5ebb=![]){const _0x5bc062=_0x458476;_0x3113f1={...settings,..._0x3113f1};if(_0x2f5ebb&&_0x3113f1[_0x5bc062(0x215)]!='************'&&_0x3113f1[_0x5bc062(0x215)]!=''){const _0x1c2ada=crypt[_0x5bc062(0x253)](secure[_0x5bc062(0x19b)],_0x3113f1[_0x5bc062(0x215)])['message'][_0x5bc062(0x1c2)]('@')[0x0],_0x37fec8=bcrypt[_0x5bc062(0x12a)](_0x1c2ada,saltRounds);_0x3113f1={..._0x3113f1,'bbPassword':_0x37fec8};}if(_0x2f5ebb&&_0x3113f1['telegramToken']!=_0x5bc062(0x1e5)&&_0x3113f1[_0x5bc062(0x1b1)]!=''){const _0x4f0a13=crypt['decrypt'](secure[_0x5bc062(0x19b)],_0x3113f1[_0x5bc062(0x1b1)])[_0x5bc062(0x1d7)][_0x5bc062(0x1c2)]('@')[0x0];_0x3113f1={..._0x3113f1,'telegramToken':_0x4f0a13};}const _0x2a96b9=_0x3113f1[_0x5bc062(0x1b1)]!=_0x5bc062(0x1e5)&&_0x3113f1[_0x5bc062(0x1b1)]!=settings['telegramToken']||_0x3113f1[_0x5bc062(0x238)]!=settings[_0x5bc062(0x238)],_0x5524d3=_0x3113f1[_0x5bc062(0x1b1)]==''||_0x3113f1[_0x5bc062(0x238)]=='';if(_0x2a96b9)_0x3113f1['telegramEvents']=_0x5bc062(0x1e8);for(const [_0x4ef618,_0xada1a7]of Object[_0x5bc062(0x211)](_0x3113f1)){if(_0x4ef618==_0x5bc062(0x1b1)&&_0xada1a7==_0x5bc062(0x1e5)){_0x3113f1[_0x5bc062(0x1b1)]=settings[_0x5bc062(0x1b1)];continue;};if(_0x4ef618==_0x5bc062(0x215)&&_0xada1a7==_0x5bc062(0x1e5)){_0x3113f1[_0x5bc062(0x215)]=settings[_0x5bc062(0x215)];continue;};dbSettings['set']('settings.'+_0x4ef618,_0xada1a7)[_0x5bc062(0x141)]();}settings=_0x3113f1;if(socket[_0x5bc062(0x143)])socket['botmanager'][_0x5bc062(0x14b)]('settings',cleanSettings());broadcastToBots('timeshift',settings[_0x5bc062(0x135)]);if(_0x2a96b9&&!_0x5524d3)initTelegram();if(_0x2a96b9&&_0x5524d3)disableTelegram();for(let _0x26a0a9 in socket){setAccess(_0x26a0a9);}}function updateSetting(_0x3e5cc1,_0x3c2617){const _0x3b6a8e=_0x458476;dbSettings['set'](_0x3b6a8e(0x224)+_0x3e5cc1,_0x3c2617)['write'](),settings=getSettings();if(socket[_0x3b6a8e(0x143)])socket[_0x3b6a8e(0x143)]['emit']('settings',cleanSettings());}function storeSecure(_0x26db3f){const _0x28765c=_0x458476;dbSecure[_0x28765c(0x14a)]('secure')[_0x28765c(0x1c0)](_0x26db3f)['write'](),secure=_0x26db3f;}function addBlacklist(){const _0x41d93f=_0x458476;cleanBlacklist();let _0x2bc350;telegramIpApproval?_0x2bc350=Math[_0x41d93f(0x204)](telegramIpApproval[_0x41d93f(0x21d)],loginExpiry):_0x2bc350=loginExpiry,dbSecure[_0x41d93f(0x14a)]('blacklist')[_0x41d93f(0x1c0)]({'expiry':new Date()[_0x41d93f(0x1d9)]()+_0x2bc350*0x3c*0x3e8,'token':token})[_0x41d93f(0x141)](),blacklist=dbSecure[_0x41d93f(0x14a)]('blacklist')[_0x41d93f(0x170)]();}function cleanBlacklist(){const _0x140228=_0x458476;let _0x5158d9=dbSecure[_0x140228(0x14a)](_0x140228(0x222))[_0x140228(0x149)]()[_0x140228(0x170)](),_0x5b23a2=new Date()['getTime']();_0x5158d9[_0x140228(0x189)](_0xc6faba=>{const _0x47e051=_0x140228;_0xc6faba[_0x47e051(0x21d)]<_0x5b23a2&&dbSecure[_0x47e051(0x14a)](_0x47e051(0x222))[_0x47e051(0x1f5)]({'expiry':_0xc6faba['expiry']})[_0x47e051(0x141)]();});}function initStates(){const _0x1d7a9a=_0x458476;let _0x1ff8de=getConfiguration();_0x1ff8de[_0x1d7a9a(0x189)](_0x22297f=>{const _0x1174dc=_0x1d7a9a;_0x22297f['live']=_0x1174dc(0x1a4);}),storeConfiguration(_0x1ff8de);}function onKeys(){const _0x1cf9b1=new RSA();return new Promise(_0x39d80a=>{const _0x5278b0=_0x22ea;_0x1cf9b1[_0x5278b0(0x198)]()['then'](_0x4e2744=>{_0x39d80a(_0x4e2744);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x228688=_0x458476;let _0xb9e922=getConfiguration(),_0x37251c=![];_0xb9e922[_0x228688(0x189)](_0x1dd6ba=>{const _0x342d96=_0x228688;if(_0x1dd6ba[_0x342d96(0x1c9)]==_0x342d96(0x229))_0x1dd6ba['status']='enabled',_0x37251c=!![];else _0x1dd6ba['status']==_0x342d96(0x1a4)&&(_0x1dd6ba[_0x342d96(0x1c9)]=_0x342d96(0x172),_0x37251c=!![]);});if(_0x37251c)storeConfiguration(_0xb9e922);let _0x2ba540=getSecure();if(!_0x2ba540[_0x228688(0x180)](_0x228688(0x14e))){let _0x12453e=await generateKeys();_0x2ba540[_0x228688(0x1c1)]=_0x12453e['publicKey'],_0x2ba540['privateKey']=_0x12453e['privateKey'],_0x2ba540[_0x228688(0x14e)]=crypto[_0x228688(0x1ae)](0x20)[_0x228688(0x132)](_0x228688(0x235));;storeSecure(_0x2ba540);}let _0x53612d=getSettings();_0x37251c=![];!_0x53612d[_0x228688(0x180)](_0x228688(0x161))&&(_0x53612d[_0x228688(0x161)]=![],_0x53612d[_0x228688(0x1d6)]='',_0x53612d[_0x228688(0x215)]='',_0x53612d[_0x228688(0x1b7)]=![],_0x37251c=!![]);!_0x53612d['hasOwnProperty'](_0x228688(0x1bb))&&(_0x53612d['whitelistEnabled']=![],_0x53612d[_0x228688(0x23b)]=[],_0x53612d['temporaryAccessAllowed']=![],_0x37251c=!![]);if(!_0x53612d['hasOwnProperty'](_0x228688(0x1dc))){if(_0x53612d[_0x228688(0x1a8)])_0x53612d['telegramEnabled']=!![];else _0x53612d['telegramEnabled']=![];_0x37251c=!![];}if(_0x37251c)storeSettings(_0x53612d);}function storeConfiguration(_0x4165fe){const _0x13c19b=_0x458476;dbConfig[_0x13c19b(0x14a)](_0x13c19b(0x207))['remove']()[_0x13c19b(0x141)](),dbConfig[_0x13c19b(0x14a)](_0x13c19b(0x207))[_0x13c19b(0x1c0)](..._0x4165fe)['write'](),config=_0x4165fe;}function resetPassword(){const _0x12740d=_0x458476;tgBot&&settings[_0x12740d(0x1a8)]&&(tgBot[_0x12740d(0x127)]('callback_query'),tgBot['sendMessage'](settings[_0x12740d(0x1a8)],_0x12740d(0x22d),{'parse_mode':_0x12740d(0x188),'reply_markup':{'inline_keyboard':[[{'text':_0x12740d(0x12f),'callback_data':_0x12740d(0x12f)},{'text':'no','callback_data':'no'}]]}})[_0x12740d(0x1ca)](_0x1eb004=>{telegramError(_0x1eb004);}),tgBot['on'](_0x12740d(0x1ac),async _0x549c40=>{const _0x5e7608=_0x12740d,_0x2588af=_0x549c40[_0x5e7608(0x1cd)],_0x4d0023=_0x549c40['message'];tgBot['answerCallbackQuery'](_0x549c40['id'])['then'](async()=>{const _0xb9f866=_0x5e7608;if(_0x2588af!='no'){const _0x32ae26=0xf,_0x3b54cb=_0xb9f866(0x236),_0x56a210=Array[_0xb9f866(0x1c5)](crypto['randomFillSync'](new Uint32Array(_0x32ae26)))[_0xb9f866(0x177)](_0x29baee=>_0x3b54cb[_0x29baee%_0x3b54cb[_0xb9f866(0x18c)]])['join'](''),_0x4995ae=bcrypt['hashSync'](_0x56a210,saltRounds);storeSettings({'bbPassword':_0x4995ae}),await tgBot['sendMessage'](_0x4d0023['chat']['id'],_0xb9f866(0x228)+_0x56a210,{'parse_mode':_0xb9f866(0x188)})[_0xb9f866(0x1ca)](_0x2a9b58=>{telegramError(_0x2a9b58);});}else await tgBot[_0xb9f866(0x212)](_0x4d0023[_0xb9f866(0x1a3)]['id'],_0xb9f866(0x1ff))[_0xb9f866(0x1ca)](_0x3e8b48=>{telegramError(_0x3e8b48);});}),tgBot[_0x5e7608(0x127)]('callback_query');}));}function logging(_0x19f592){const _0x10f156=_0x458476;console[_0x10f156(0x185)](getTimeStamp()+_0x10f156(0x1e6)+_0x19f592);if(tgBot&&settings[_0x10f156(0x1a8)]&&settings[_0x10f156(0x22e)]!=_0x10f156(0x1a7))tgBot[_0x10f156(0x212)](settings[_0x10f156(0x1a8)],_0x10f156(0x19e)+_0x19f592)[_0x10f156(0x1ca)](_0x4b8cc9=>{telegramError(_0x4b8cc9);});}function getServerTime(){const _0x514cf6=_0x458476,_0x3f3c83=new Date();return _0x3f3c83[_0x514cf6(0x20e)]()+'/'+(_0x3f3c83[_0x514cf6(0x23c)]()+0x1)[_0x514cf6(0x132)]()[_0x514cf6(0x1d2)](0x2,'0')+'/'+_0x3f3c83['getDate']()[_0x514cf6(0x132)]()[_0x514cf6(0x1d2)](0x2,'0')+'\x20'+_0x3f3c83[_0x514cf6(0x259)]()[_0x514cf6(0x132)]()[_0x514cf6(0x1d2)](0x2,'0')+':'+_0x3f3c83[_0x514cf6(0x17b)]()[_0x514cf6(0x132)]()[_0x514cf6(0x1d2)](0x2,'0')+':'+_0x3f3c83[_0x514cf6(0x226)]()[_0x514cf6(0x132)]()[_0x514cf6(0x1d2)](0x2,'0');}function getTimeStamp(){const _0x4585ce=_0x458476,_0xfc9ee6=shiftedTime();return _0xfc9ee6[_0x4585ce(0x20e)]()+'/'+(_0xfc9ee6[_0x4585ce(0x23c)]()+0x1)[_0x4585ce(0x132)]()[_0x4585ce(0x1d2)](0x2,'0')+'/'+_0xfc9ee6['getDate']()[_0x4585ce(0x132)]()[_0x4585ce(0x1d2)](0x2,'0')+'\x20'+_0xfc9ee6[_0x4585ce(0x259)]()[_0x4585ce(0x132)]()[_0x4585ce(0x1d2)](0x2,'0')+':'+_0xfc9ee6[_0x4585ce(0x17b)]()[_0x4585ce(0x132)]()[_0x4585ce(0x1d2)](0x2,'0')+':'+_0xfc9ee6[_0x4585ce(0x226)]()[_0x4585ce(0x132)]()[_0x4585ce(0x1d2)](0x2,'0');}function shiftedTime(){const _0x1a0e44=_0x458476,_0x264573=new Date();let _0x40dffa=_0x264573;if(settings[_0x1a0e44(0x135)]&&settings['timeshift']!==0x0)_0x40dffa=fns[_0x1a0e44(0x18f)](_0x264573,{'hours':settings[_0x1a0e44(0x135)]});return _0x40dffa;}function startAnalytics(){const _0x8e3f44=_0x458476;let _0x44d6cd=new Date()[_0x8e3f44(0x176)]();_0x44d6cd==0x9&&triggerAnalytics();if(pidAnalytics)clearTimeout(pidAnalytics);pidAnalytics=setTimeout(()=>{startAnalytics();},0x3c*0x3c*0x3e8);}function triggerAnalytics(){const _0x2bb279=_0x458476;analytics[_0x2bb279(0x1d1)]({'title':'Balance\x20Bot\x20Server','href':_0x2bb279(0x256),'path':'/v'+serverversion});}function validateCredentials(_0x4d0cec){const _0x40df94=_0x458476;if(_0x4d0cec[_0x40df94(0x1ad)]==settings['bbUsername']&&bcrypt['compareSync'](_0x4d0cec[_0x40df94(0x23d)],settings[_0x40df94(0x215)])){if(settings[_0x40df94(0x1b7)])return{'allow':![],'reason':_0x40df94(0x151),'token':null};else{const _0x3bec94=generateLoginToken();return{'allow':!![],'reason':_0x40df94(0x1ee),'token':_0x3bec94};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(){const _0x4d9217=_0x458476,_0x31f3fc=generateLoginToken();return{'allow':!![],'reason':_0x4d9217(0x1ee),'token':_0x31f3fc};}function validateAccess(_0x82dfd8){const _0x1518fb=_0x458476;let _0x874e44;const _0xf720e2=_0x1f31f8=>{const _0x2d7877=_0x22ea;if(settings['loginRequired']){if(settings[_0x2d7877(0x1b7)]){if(telegram2FaApproved()){const _0x43ab40=generateLoginToken();return{'allow':!![],'reason':_0x2d7877(0x1a9),'token':_0x43ab40};}else return{'allow':![],'reason':_0x2d7877(0x151),'token':null};}else return _0x874e44=validToken(_0x1f31f8),_0x874e44[_0x2d7877(0x180)](_0x2d7877(0x213))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x1f31f8}:{'allow':![],'reason':_0x2d7877(0x24a),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x1518fb(0x1bb)]){let _0x13755c=[...settings[_0x1518fb(0x23b)],_0x1518fb(0x163),_0x1518fb(0x258),_0x1518fb(0x16d)];if(_0x13755c[_0x1518fb(0x1d0)](externalip))return _0xf720e2(_0x82dfd8);else{_0x874e44=validToken(_0x82dfd8);if(_0x874e44[_0x1518fb(0x180)](_0x1518fb(0x213)))return _0xf720e2(_0x82dfd8);else{if(telegramIpApproved()){const _0x162002=generateToken();return _0x874e44=_0xf720e2(_0x82dfd8),_0x874e44[_0x1518fb(0x17c)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x162002}:_0x874e44;}else return settings[_0x1518fb(0x22c)]?{'allow':![],'reason':_0x1518fb(0x217),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0xf720e2(_0x82dfd8);}function timelyDecrypt(_0x500ba1,_0x5066f8=!![]){const _0x46dcca=_0x458476;if(_0x500ba1)try{const _0x5a8eda=crypt[_0x46dcca(0x253)](secure[_0x46dcca(0x19b)],_0x500ba1)[_0x46dcca(0x1d7)],_0x458482=_0x5a8eda[_0x46dcca(0x1c2)]('@')[0x0],_0x2ff54d=_0x5a8eda['split']('@')[0x1],_0x5b297d=new Date()[_0x46dcca(0x1d9)]();if(_0x5066f8){if(_0x5b297d-_0x2ff54d<maxSecretAge*0x3e8)return _0x458482;else return![];}else return _0x458482;}catch{return![];}else return![];}const validToken=_0x2a17f2=>{const _0x4106a3=_0x458476;if(!_0x2a17f2)return{'error':_0x4106a3(0x257)};for(let _0x27485f of blacklist){if(_0x27485f[_0x4106a3(0x17f)]==_0x2a17f2)return{'error':'Token\x20blacklisted'};}let _0x537462;try{_0x537462=jwt[_0x4106a3(0x13c)](_0x2a17f2,secure['secret']+uuid);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x537462[_0x4106a3(0x180)]('clientip')&&!_0x537462['hasOwnProperty']('username')||!_0x537462['hasOwnProperty'](_0x4106a3(0x12b)))return{'error':_0x4106a3(0x243)};if(!_0x537462[_0x4106a3(0x180)](_0x4106a3(0x1ad))&&_0x537462[_0x4106a3(0x180)](_0x4106a3(0x1de))){const {clientip:_0x4d9d6c}=_0x537462;return externalip==_0x4d9d6c?{'success':_0x4106a3(0x148)}:{'error':_0x4106a3(0x16a)};}else{if(_0x537462[_0x4106a3(0x180)](_0x4106a3(0x1ad))&&_0x537462[_0x4106a3(0x180)](_0x4106a3(0x1de))){const {username:_0x58be8d,clientip:_0x40046d}=_0x537462;return settings[_0x4106a3(0x1d6)]==_0x58be8d&&externalip==_0x40046d?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x4106a3(0x1be)};}}},generateLoginToken=()=>{const _0x368f23=_0x458476;if(uuid)return jwt[_0x368f23(0x1ea)]({'username':settings[_0x368f23(0x1d6)],'clientip':externalip},secure['secret']+uuid,{'expiresIn':tokenRefresh*0x3c});else return![];},generateToken=()=>{const _0x2a58f5=_0x458476;if(uuid)return jwt[_0x2a58f5(0x1ea)]({'clientip':externalip},secure[_0x2a58f5(0x14e)]+uuid,{'expiresIn':telegramIpApproval[_0x2a58f5(0x21d)]*0x3c});else return![];},telegramIpApproved=()=>{const _0x2b684a=_0x458476;let _0x57e897=![];return telegramIpApproval&&telegramIpApproval[_0x2b684a(0x21d)]!='reject'&&(_0x57e897=telegramIpApproval[_0x2b684a(0x1de)]==externalip&&new Date()['getTime']()-telegramIpApproval[_0x2b684a(0x157)]<telegramIpApproval[_0x2b684a(0x21d)]*0x3c*0x3e8),_0x57e897;},telegram2FaApproved=()=>{const _0x433ac4=_0x458476;let _0x114256=![];return telegram2FaApproval&&telegram2FaApproval[_0x433ac4(0x21d)]!=_0x433ac4(0x190)&&(_0x114256=telegram2FaApproval[_0x433ac4(0x1de)]==externalip&&new Date()['getTime']()-telegram2FaApproval['timestamp']<telegram2FaApproval[_0x433ac4(0x21d)]*0x3c*0x3e8),_0x114256;},normalizeIP=_0x2581da=>{const _0x590b27=_0x458476;let _0x7cc887=null,_0x3030e2=null;if(ipaddr[_0x590b27(0x1e7)](_0x2581da)){const _0x5dac16=ipaddr[_0x590b27(0x187)](_0x2581da);_0x5dac16[_0x590b27(0x15d)]()===_0x590b27(0x14c)?(_0x5dac16['isIPv4MappedAddress']()&&(_0x7cc887=_0x5dac16['toIPv4Address']()['toString']()),_0x3030e2=_0x5dac16[_0x590b27(0x132)]()):(_0x7cc887=_0x5dac16[_0x590b27(0x132)](),_0x3030e2=_0x5dac16[_0x590b27(0x128)]()[_0x590b27(0x132)]());}return{'show':_0x7cc887?_0x7cc887:_0x3030e2,'store':_0x3030e2};};