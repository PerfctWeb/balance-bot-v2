const _0x1678c7=_0x3d3c;(function(_0x38932b,_0x33f74b){const _0x291448=_0x3d3c,_0xeb1a2a=_0x38932b();while(!![]){try{const _0x1b3d8d=-parseInt(_0x291448(0x28c))/0x1+-parseInt(_0x291448(0x1c3))/0x2*(parseInt(_0x291448(0x220))/0x3)+-parseInt(_0x291448(0x25c))/0x4+parseInt(_0x291448(0x246))/0x5+-parseInt(_0x291448(0x1c7))/0x6+parseInt(_0x291448(0x285))/0x7+-parseInt(_0x291448(0x1c5))/0x8*(-parseInt(_0x291448(0x269))/0x9);if(_0x1b3d8d===_0x33f74b)break;else _0xeb1a2a['push'](_0xeb1a2a['shift']());}catch(_0x2c34b6){_0xeb1a2a['push'](_0xeb1a2a['shift']());}}}(_0x13d2,0x6696f));const _0x2f991e=function(){let _0x515293=!![];return function(_0x178986,_0x222c43){const _0x4eea65=_0x515293?function(){const _0x403fdf=_0x3d3c;if(_0x222c43){const _0x4d82ed=_0x222c43[_0x403fdf(0x21c)](_0x178986,arguments);return _0x222c43=null,_0x4d82ed;}}:function(){};return _0x515293=![],_0x4eea65;};}(),_0x42665d=_0x2f991e(this,function(){const _0x532b55=_0x3d3c;return _0x42665d[_0x532b55(0x16f)]()[_0x532b55(0x1e6)]('(((.+)+)+)+$')[_0x532b55(0x16f)]()[_0x532b55(0x1c1)](_0x42665d)[_0x532b55(0x1e6)](_0x532b55(0x1ed));});_0x42665d();'use strict';process[_0x1678c7(0x1b3)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x1678c7(0x178)),FileSync=require(_0x1678c7(0x20b)),fs=require('fs'),fns=require(_0x1678c7(0x26d)),low=require(_0x1678c7(0x210)),path=require('path'),crypto=require('crypto'),Crypt=require(_0x1678c7(0x1b7))[_0x1678c7(0x187)],RSA=require(_0x1678c7(0x1b7))[_0x1678c7(0x258)],bcrypt=require(_0x1678c7(0x25b)),jwt=require(_0x1678c7(0x1a3)),analyticsLib=require(_0x1678c7(0x199))[_0x1678c7(0x20e)],googleAnalytics=require(_0x1678c7(0x26f))[_0x1678c7(0x20e)],ipaddr=require(_0x1678c7(0x16d));let bbpath='bb/';const botfile='bot.js',configfile=_0x1678c7(0x194),settingsfile=_0x1678c7(0x23f),securefile=_0x1678c7(0x25a);!fs[_0x1678c7(0x1ad)](bbpath+botfile)&&(bbpath='');function _0x13d2(){const _0x16b7c4=['forEach','getStartingBalances','args','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','orders','404\x20Not\x20Found','match','/:bot/coins','Invalid\x20authentication\x20token\x20(2)','Ok,\x20will\x20send\x20order\x20notifications\x20only','new-disabled','reject','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','exp','remove','No\x20authentication\x20token','lowdb/adapters/FileSync',':\x20Bot\x20Mgr\x20>\x20','Unauthorized\x20attempt\x20to\x20update\x20settings','default','Unauthorized\x20attempt\x20to\x20delete\x20bot','lowdb','map','\x20/\x20','isIPv4MappedAddress','sendFile','filter','\x20minutes','telegramEnabled','unlinkSync','event','http','loginRequired','apply','use','blacklist','Notifications\x20types:\x20','339EZRVJd','value','whitelistEnabled','secure','starting','privateKey','\x20|\x20','<b>Telegram\x20bot\x20status:</b>\x0a','accept','botmanager','::ffff:127.0.0.1','Alerts','connected','All','::1','5\x20min','getDate','expiry','store-configuration','encryptedUuid','f2aRequired','referer','Unauthorized\x20attempt\x20to\x20store\x20configuration','store-headless','callback_query','getFullYear','/:bot/history','timestamp','Login\x20accepted','chat','botname','bb-settings.json','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','build2','login','2FA\x20login\x20token\x20generated','</b>\x20?','placeOrder','1959435GSVahZ','exit','set','send','telegramUsername','index.html','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','-config.json','sortBy','bbPassword','status','version.json','conn','password','reload','login\x20token\x20valid','alerts','toIPv4MappedAddress','RSA','ipc','bb-secure.json','bcryptjs','2525816KPpJUJ','/help\x20-\x20show\x20avaiable\x20commands\x0a','-performance.json',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','catch','storeConfiguration','RSA-OAEP','version','function','store','Allow\x20login\x20from\x20IP\x20address\x20<b>','auth','express','315LPihiW','getUTCHours','add','inherit','date-fns','Unauthorized\x20attempt\x20to\x20update\x20bot','@analytics/google-analytics','length','disabled','mkdirSync','defaults','push','You\x20can\x20use\x20the\x20following\x20commands:\x0a','2FA\x20login\x20required','get','polling_error','Invalid\x20Telegram\x20token','decrypt','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','logged\x20out','entries','add-bot','Token\x20blacklisted','hasOwnProperty','live','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','-----------------------------------------------------------------------------------','node-telegram-bot-api','1067619XDVHIL','allow','login\x20required','Notifications\x20disabled\x0a','compareSync','generateKeyPairAsync','publicKey','341837ZIvnQS','assign','/:bot/configuration','Password\x20has\x20been\x20reset\x20to:\x20','getSeconds','/status\x20-\x20show\x20the\x20status\x20of\x20your\x20bots\x0a','settings','error','data','ipaddr.js','getPortfolio','toString','max','Notifications\x20enabled\x0a','Unauthorized\x20attempt\x20logging\x20in\x20(timeout)','Notifications\x20disabled','error\x20while\x20deleting\x20log\x20files:\x20','idling\x20bot\x20\x20\x20|\x20Bot\x20','telegram','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','child_process','whitelist','https://hodlerhacks.com','notification','starting\x20bot\x20|\x20Bot\x20','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','keys','bbUsername','login\x20not\x20required','Unauthorized\x20attempt\x20to\x20log\x20out','No\x20bots\x20enabled\x20right\x20now','Password\x20reset\x20rejected','new','delete-bot','find','Crypt','onText','restarting\x20Bot\x20','includes','disconnect','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','getTime','15\x20min','toIPv4Address','Unauthorized\x20attempt\x20to\x20add\x20bot','Notifications\x20enabled','build','sign','bb-config.json','apiKey','2FA\x20required','logout','/:bot/support','analytics','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','type','Temporary\x20access\x20rejected','stopPolling','reason','bot-','User\x20has\x20been\x20validated','padStart','temporary\x20token\x20generated','jsonwebtoken','running','createServer','verify','access\x20timeout','Ok,\x20will\x20send\x20alert\x20notifications\x20only','telegramToken','getHours','join','once','existsSync','storeHeadless','write','message','\x20only\x0a','then','env','token','show','disabled\x20Bot\x20','hybrid-crypto-js','sendMessage','connection','getMonth','emitHistory','botID','cloneDeep','-events.json','enabled\x20Bot\x20','temporaryAccessAllowed','constructor','1000','14410ndszWc','started','456680nrtOAQ','from','2008296gCeZJk','/:bot/performance','removeListener','invalid\x20credentials','HTML','Balance\x20Bot\x20Server','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','/enable\x20-\x20enable\x20notifications\x0a','hex','socket.io','Invalid\x20authentication\x20token\x20(1)','temporary\x20access\x20not\x20allowed','enabled','Bot\x20','stopped','removeAllListeners','listen','timeshift','reset-password','get-portfolio','telegramChatId','Unauthorized\x20attempt\x20to\x20get\x20portfolio','telegramEvents','log','Login\x20rejected','emit','clientip','handshake','getMinutes','************','search','SIGTERM','success','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','split','username','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','(((.+)+)+)+$','login\x20token\x20generated','all','place-order','fork','kill','answerCallbackQuery','secret','yes','bots','Balance\x20Bot','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','/restart\x20-\x20restart\x20a\x20bot\x0a'];_0x13d2=function(){return _0x16b7c4;};return _0x13d2();}function _0x3d3c(_0x34319a,_0x110c56){const _0x426eac=_0x13d2();return _0x3d3c=function(_0x42665d,_0x2f991e){_0x42665d=_0x42665d-0x16b;let _0x13d273=_0x426eac[_0x42665d];return _0x13d273;},_0x3d3c(_0x34319a,_0x110c56);}const configpath=bbpath+'config/';!fs[_0x1678c7(0x1ad)](configpath)&&fs[_0x1678c7(0x272)](configpath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x1678c7(0x273)]({'bots':[]})[_0x1678c7(0x1af)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x1678c7(0x273)]({'settings':{'timeshift':0x0}})[_0x1678c7(0x1af)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':'sha256','rsaStandard':_0x1678c7(0x262)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[],socket=[],serverStatus=[];const serverversion=require('./'+bbpath+_0x1678c7(0x251))[_0x1678c7(0x263)],maxSecretAge=0xa,loginExpiry=0x3c,tokenRefresh=0x5;let lastIpApproval,telegramIpApproval,telegram2FaApproval,accessControl,token,uuid,externalip,pidExpireLogin,pidRefreshToken,pidAnalytics;oneTimeMigration(),cleanBlacklist();const PORT=0xbb8,express=require(_0x1678c7(0x268)),app=express(),http=require(_0x1678c7(0x21a))[_0x1678c7(0x1a5)](app);app[_0x1678c7(0x21d)](express['static'](path[_0x1678c7(0x1ab)](__dirname,bbpath,_0x1678c7(0x241)))),app[_0x1678c7(0x21d)](express['static'](path[_0x1678c7(0x1ab)](__dirname,bbpath,_0x1678c7(0x192)))),app[_0x1678c7(0x277)]('/',function(_0x5c04b2,_0x25f5c0){const _0x58e2c0=_0x1678c7;_0x25f5c0[_0x58e2c0(0x214)](path['join'](__dirname,bbpath,_0x58e2c0(0x241),'index.html'));}),app[_0x1678c7(0x277)]('/:bot',function(_0x398684,_0x44c832){const _0x10be32=_0x1678c7;_0x44c832['sendFile'](path['join'](__dirname,bbpath,'build',_0x10be32(0x24b)));}),app[_0x1678c7(0x277)]('/:bot/portfolio',(_0x9eadc,_0xb8fa72)=>{const _0x13b5a8=_0x1678c7;_0xb8fa72[_0x13b5a8(0x214)](path[_0x13b5a8(0x1ab)](__dirname,bbpath,'build',_0x13b5a8(0x24b)));}),app['get'](_0x1678c7(0x1c8),(_0x327f8d,_0x58e2a8)=>{const _0x2eda5a=_0x1678c7;_0x58e2a8[_0x2eda5a(0x214)](path['join'](__dirname,bbpath,'build',_0x2eda5a(0x24b)));}),app[_0x1678c7(0x277)](_0x1678c7(0x202),(_0x5ba4b5,_0x5c50bc)=>{const _0x109e99=_0x1678c7;_0x5c50bc[_0x109e99(0x214)](path[_0x109e99(0x1ab)](__dirname,bbpath,'build',_0x109e99(0x24b)));}),app[_0x1678c7(0x277)](_0x1678c7(0x23a),(_0x3555fc,_0x2b7eaf)=>{const _0x192125=_0x1678c7;_0x2b7eaf[_0x192125(0x214)](path[_0x192125(0x1ab)](__dirname,bbpath,_0x192125(0x192),_0x192125(0x24b)));}),app['get'](_0x1678c7(0x28e),(_0x270ee4,_0x3bf5c3)=>{const _0x4160c4=_0x1678c7;_0x3bf5c3[_0x4160c4(0x214)](path['join'](__dirname,bbpath,_0x4160c4(0x192),_0x4160c4(0x24b)));}),app[_0x1678c7(0x277)](_0x1678c7(0x198),(_0x20dae3,_0x225334)=>{const _0x439bf7=_0x1678c7;_0x225334['sendFile'](path['join'](__dirname,bbpath,_0x439bf7(0x192),_0x439bf7(0x24b)));}),http[_0x1678c7(0x1d8)](PORT);const analytics=analyticsLib({'app':_0x1678c7(0x1f7),'plugins':[googleAnalytics({'trackingId':'UA-192771731-1'})]}),TelegramBot=require(_0x1678c7(0x284));let tgBot;if(settings[_0x1678c7(0x1a9)]&&settings[_0x1678c7(0x1a9)]!=''&&settings[_0x1678c7(0x24a)]&&settings[_0x1678c7(0x24a)]!='')initTelegram();initStates(),startServer(),startSocket(),startAnalytics();function startServer(){const _0x51ecb6=_0x1678c7;console[_0x51ecb6(0x1df)](''),console['log'](_0x51ecb6(0x283)),logging('Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:'+PORT),console['log'](_0x51ecb6(0x283));if(config[_0x51ecb6(0x270)]!=0x0)config['forEach'](_0x57695f=>{const _0x5c8caf=_0x51ecb6;if(_0x57695f['status']==_0x5c8caf(0x1d4)||_0x57695f[_0x5c8caf(0x250)]==_0x5c8caf(0x184))logging(_0x5c8caf(0x17c)+_0x57695f['botID']+_0x5c8caf(0x226)+_0x57695f[_0x5c8caf(0x23e)]),startBot([_0x57695f[_0x5c8caf(0x1bc)]],{'cwd':bbpath},function(_0x1b6829){if(_0x1b6829)logging(_0x1b6829);});else(_0x57695f[_0x5c8caf(0x250)]==_0x5c8caf(0x271)||_0x57695f['status']==_0x5c8caf(0x205))&&logging(_0x5c8caf(0x175)+_0x57695f['botID']+'\x20|\x20'+_0x57695f['botname']);});else!newBot&&console['log'](_0x51ecb6(0x17d));if(newBot)addBot();console[_0x51ecb6(0x1df)](_0x51ecb6(0x283)),console[_0x51ecb6(0x1df)]('');}function startSocket(){const _0x23571d=_0x1678c7,_0x3c4cc6=require(_0x23571d(0x1d1))(http,{});_0x3c4cc6['on'](_0x23571d(0x1b9),_0x4de3f8=>{const _0x432087=_0x23571d;let _0x504ec7,_0x3f835a,_0x333ce0;const _0x23b4af=_0x4de3f8[_0x432087(0x1e3)]['headers'][_0x432087(0x235)],_0x54c3d9=_0x4de3f8['handshake'][_0x432087(0x267)][_0x432087(0x233)];if(!_0x54c3d9)_0x4de3f8[_0x432087(0x1e1)](_0x432087(0x250),{'publicKey':secure[_0x432087(0x28b)]});else{uuid=timelyDecrypt(_0x4de3f8[_0x432087(0x1e3)][_0x432087(0x267)][_0x432087(0x233)],![]),_0x3f835a=_0x23b4af['match'](/bot[0-9]{3}/);if(_0x3f835a)_0x333ce0=_0x3f835a[0x0][_0x432087(0x201)](/[0-9]{3}/);if(_0x333ce0)_0x504ec7=_0x333ce0[0x0];else _0x504ec7=_0x432087(0x229);if(socket[_0x504ec7])socket[_0x504ec7][_0x432087(0x18b)](!![]);socket[_0x504ec7]=_0x4de3f8,setAccess(_0x504ec7);if(accessControl[_0x432087(0x286)]){if(_0x504ec7==_0x432087(0x229))initializeSocketBotManager();else initializeSocketBot(_0x504ec7);}if(!serverStatus[_0x504ec7])serverStatus[_0x504ec7]=_0x432087(0x22c);socket[_0x504ec7]['on'](_0x432087(0x242),_0x53b8b5=>{const _0x5d8a71=_0x432087,_0x1c561c=timelyDecrypt(_0x53b8b5['password']);if(_0x1c561c){_0x53b8b5={'username':_0x53b8b5[_0x5d8a71(0x1eb)],'password':_0x1c561c};let _0x1d9f2a=validateCredentials(_0x53b8b5);if(_0x1d9f2a[_0x5d8a71(0x286)]==![]&&_0x1d9f2a[_0x5d8a71(0x19e)]==_0x5d8a71(0x276))socket[_0x504ec7][_0x5d8a71(0x1e1)](_0x5d8a71(0x250),{'access':_0x1d9f2a}),loginAccess2FA(externalip);else{if(_0x1d9f2a[_0x5d8a71(0x286)]==![]&&_0x1d9f2a['reason']==_0x5d8a71(0x1ca))socket[_0x504ec7][_0x5d8a71(0x1e1)](_0x5d8a71(0x250),{'access':_0x1d9f2a});else{if(_0x1d9f2a['allow']&&_0x1d9f2a[_0x5d8a71(0x19e)]==_0x5d8a71(0x1ee)){token=_0x1d9f2a['token'];for(let _0x4257b6 in socket){if(_0x4257b6=='botmanager')initializeSocketBotManager();else initializeSocketBot(_0x4257b6);socket[_0x4257b6][_0x5d8a71(0x1e1)](_0x5d8a71(0x250),{'status':serverStatus[_0x4257b6]||_0x5d8a71(0x224),'serverversion':serverversion,'servertime':getServerTime(),'access':_0x1d9f2a,'externalip':externalip,'publicKey':secure[_0x5d8a71(0x28b)],'loginNow':![]});}setTokenRefresh(),setSessionTimeout('login');}}}}else logging(_0x5d8a71(0x172));}),socket[_0x504ec7]['on'](_0x432087(0x1da),()=>{resetPassword();}),socket[_0x504ec7]['on'](_0x432087(0x18b),_0xf744e0=>{let _0xe0c669=[];for(let _0x5cd44e in socket){if(_0x5cd44e!=_0x504ec7)_0xe0c669[_0x5cd44e]=socket[_0x5cd44e];}socket=_0xe0c669;});if(_0x504ec7!=_0x432087(0x229)&&config[_0x432087(0x195)]!=''){if(pid[_0x504ec7])pid[_0x504ec7][_0x432087(0x249)]({'function':'initclient','args':null});}}});}function setAccess(_0x1f5057){const _0x54fe77=_0x1678c7;externalip=normalizeIP(socket[_0x1f5057][_0x54fe77(0x252)]['remoteAddress'])[_0x54fe77(0x265)],accessControl=validateAccess(token),accessControl['token']&&accessControl['reason']==_0x54fe77(0x1a2)&&setSessionTimeout('2FA'),accessControl['token']&&accessControl[_0x54fe77(0x19e)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x54fe77(0x242)),socket[_0x1f5057][_0x54fe77(0x1e1)](_0x54fe77(0x250),{'status':serverStatus[_0x1f5057]||_0x54fe77(0x224),'serverversion':serverversion,'servertime':getServerTime(),'access':accessControl,'externalip':externalip,'publicKey':secure['publicKey'],'loginNow':accessControl[_0x54fe77(0x19e)]==_0x54fe77(0x287)||accessControl[_0x54fe77(0x19e)]==_0x54fe77(0x276)}),accessControl[_0x54fe77(0x286)]==![]&&accessControl[_0x54fe77(0x19e)]==_0x54fe77(0x196)&&temporaryAccess2FA(externalip);}function setSessionTimeout(_0x57c544){const _0x54f484=_0x1678c7;let _0x981514;if(_0x57c544==_0x54f484(0x242))_0x981514=loginExpiry*0x3c*0x3e8;else _0x981514=telegramIpApproval[_0x54f484(0x231)]*0x3c*0x3e8-(new Date()[_0x54f484(0x18d)]()-telegramIpApproval[_0x54f484(0x23b)]);if(pidExpireLogin)clearTimeout(pidExpireLogin);pidExpireLogin=setTimeout(()=>{const _0x687dd3=_0x54f484;if(pidRefreshToken)clearTimeout(pidRefreshToken);addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null;let _0x401ba2=validateAccess(token);if(!(_0x401ba2[_0x687dd3(0x286)]&&_0x401ba2[_0x687dd3(0x19e)]==_0x687dd3(0x180)))for(let _0x2aab9b in socket){socket[_0x2aab9b][_0x687dd3(0x1e1)](_0x687dd3(0x250),{'access':{'allow':![],'reason':_0x687dd3(0x1a7),'token':null}});}token=null;},_0x981514);}function setTokenRefresh(){if(pidRefreshToken)clearTimeout(pidRefreshToken);pidRefreshToken=setTimeout(()=>{const _0x554a9b=_0x3d3c;let _0xe1963d=refreshToken();for(let _0x2480e9 in socket){socket[_0x2480e9][_0x554a9b(0x1e1)](_0x554a9b(0x250),{'status':serverStatus[_0x2480e9]||_0x554a9b(0x224),'serverversion':serverversion,'servertime':getServerTime(),'access':_0xe1963d,'externalip':externalip,'publicKey':secure[_0x554a9b(0x28b)],'loginNow':![]});}setTokenRefresh();},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(){const _0x22e25c=_0x1678c7;socket[_0x22e25c(0x229)][_0x22e25c(0x1e1)]('bots',config),socket[_0x22e25c(0x229)][_0x22e25c(0x1e1)](_0x22e25c(0x292),cleanSettings()),socket['botmanager']['on'](_0x22e25c(0x27e),_0x513d55=>{const _0x5b9a4d=_0x22e25c;if(validateAccess(_0x513d55)[_0x5b9a4d(0x286)])addBot();else logging(_0x5b9a4d(0x190));}),socket[_0x22e25c(0x229)]['on']('update-bot',(_0x4c736b,_0x4212cc)=>{const _0x4fb62b=_0x22e25c;if(validateAccess(_0x4212cc)[_0x4fb62b(0x286)])toggleBot(_0x4c736b[_0x4fb62b(0x1bc)],_0x4c736b[_0x4fb62b(0x250)],_0x4c736b[_0x4fb62b(0x281)]);else logging(_0x4fb62b(0x26e));}),socket[_0x22e25c(0x229)]['on'](_0x22e25c(0x185),(_0x43dc1b,_0x561120)=>{const _0x47ffc1=_0x22e25c;if(validateAccess(_0x561120)[_0x47ffc1(0x286)])deleteBot(_0x43dc1b);else logging(_0x47ffc1(0x20f));}),socket[_0x22e25c(0x229)]['on']('store-settings',(_0x30b2d4,_0x3569d5)=>{const _0x1b8865=_0x22e25c;if(validateAccess(_0x3569d5)[_0x1b8865(0x286)])storeSettings(_0x30b2d4,!![]);else logging(_0x1b8865(0x20d));}),socket[_0x22e25c(0x229)]['on'](_0x22e25c(0x197),_0x503d11=>{const _0x1873ee=_0x22e25c;if(validateAccess(_0x503d11)['allow']){if(pidRefreshToken)clearTimeout(pidRefreshToken);if(pidExpireLogin)clearTimeout(pidExpireLogin);removeSocketListeners(),addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null,token=null;for(let _0x44a696 in socket){socket[_0x44a696]['emit'](_0x1873ee(0x250),{'access':{'allow':![],'reason':_0x1873ee(0x27c),'token':null}});}}else logging(_0x1873ee(0x181));});}function initializeSocketBot(_0x112bf0){const _0x4416e9=_0x1678c7;socket[_0x112bf0]['on']('get-logs',(_0x46bde2,_0x3a77a2)=>{const _0x55fea3=_0x3d3c;if(validateAccess(_0x3a77a2)['allow']){if(pid[_0x112bf0])pid[_0x112bf0][_0x55fea3(0x249)]({'function':_0x55fea3(0x1bb),'args':_0x46bde2});}else logging('Unauthorized\x20attempt\x20to\x20get\x20logs');}),socket[_0x112bf0]['on'](_0x4416e9(0x1db),(_0x26fda5,_0x2809a3)=>{const _0x12c2e7=_0x4416e9;if(validateAccess(_0x2809a3)[_0x12c2e7(0x286)]){if(pid[_0x112bf0])pid[_0x112bf0]['send']({'function':_0x12c2e7(0x16e),'args':_0x26fda5});}else logging(_0x12c2e7(0x1dd));}),socket[_0x112bf0]['on'](_0x4416e9(0x232),(_0x49ab2d,_0x305efc)=>{const _0x2cc6b4=_0x4416e9;if(validateAccess(_0x305efc)[_0x2cc6b4(0x286)]){if(pid[_0x112bf0])pid[_0x112bf0]['send']({'function':_0x2cc6b4(0x261),'args':_0x49ab2d});}else logging(_0x2cc6b4(0x236));}),socket[_0x112bf0]['on'](_0x4416e9(0x237),(_0x4fa690,_0x929948)=>{const _0x2cfd58=_0x4416e9;if(validateAccess(_0x929948)[_0x2cfd58(0x286)]){if(pid[_0x112bf0])pid[_0x112bf0][_0x2cfd58(0x249)]({'function':_0x2cfd58(0x1ae),'args':_0x4fa690});}else logging(_0x2cfd58(0x240));}),socket[_0x112bf0]['on']('get-starting-balances',_0x19f817=>{const _0x551d21=_0x4416e9;if(validateAccess(_0x19f817)['allow']){if(pid[_0x112bf0])pid[_0x112bf0]['send']({'function':_0x551d21(0x1fb),'args':null});}else logging(_0x551d21(0x19a));}),socket[_0x112bf0]['on'](_0x4416e9(0x1f0),(_0x23222f,_0x288574)=>{const _0x167ca5=_0x4416e9;if(validateAccess(_0x288574)[_0x167ca5(0x286)]){if(pid[_0x112bf0])pid[_0x112bf0]['send']({'function':_0x167ca5(0x245),'args':_0x23222f});}else logging(_0x167ca5(0x177));}),socket[_0x112bf0]['on'](_0x4416e9(0x197),_0x41fac9=>{const _0x22a8a2=_0x4416e9;if(validateAccess(_0x41fac9)[_0x22a8a2(0x286)]){if(pidRefreshToken)clearTimeout(pidRefreshToken);if(pidExpireLogin)clearTimeout(pidExpireLogin);removeSocketListeners(),addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null,token=null;for(let _0x3dab85 in socket){socket[_0x3dab85]['emit'](_0x22a8a2(0x250),{'access':{'allow':![],'reason':_0x22a8a2(0x27c),'token':null}});}}else logging(_0x22a8a2(0x181));});}function removeSocketListeners(){const _0x15def9=_0x1678c7;for(let _0x4369f3 in socket){socket[_0x4369f3][_0x15def9(0x1d7)]();}}function cleanSettings(){const _0xe75bea=_0x1678c7;let _0x4b4ba3=settings;return settings[_0xe75bea(0x1a9)]&&settings['telegramToken']!=''&&(_0x4b4ba3={..._0x4b4ba3,'telegramToken':_0xe75bea(0x1e5)}),settings[_0xe75bea(0x24f)]&&settings['bbPassword']!=''&&(_0x4b4ba3={..._0x4b4ba3,'bbPassword':_0xe75bea(0x1e5)}),_0x4b4ba3;}function startBot(_0x2f1f51,_0x249b45,_0x427884){const _0x50e579=_0x1678c7;let _0x400759=![];const _0x2cde9a=_0x2f1f51[0x0];_0x249b45={..._0x249b45,'stdio':[_0x50e579(0x26c),_0x50e579(0x26c),_0x50e579(0x26c),_0x50e579(0x259)]},pid[_0x2cde9a]=childProcess[_0x50e579(0x1f1)](botfile,_0x2f1f51,_0x249b45),pid[_0x2cde9a]['on'](_0x50e579(0x1b0),_0x30ef44=>{const _0x3e71d6=_0x50e579;switch(Object[_0x3e71d6(0x17e)](_0x30ef44)[0x0]){case _0x3e71d6(0x23e):updateBotName(_0x2cde9a,_0x30ef44[_0x3e71d6(0x23e)]);break;case _0x3e71d6(0x250):updateStatus(_0x2cde9a,_0x30ef44['status']);break;case _0x3e71d6(0x281):updateLive(_0x2cde9a,_0x30ef44['live']);break;case _0x3e71d6(0x1c4):updateLive(_0x2cde9a,_0x30ef44[_0x3e71d6(0x1c4)]);if(socket[_0x2cde9a])socket[_0x2cde9a][_0x3e71d6(0x1e1)](_0x3e71d6(0x250),{'access':{'allow':![],'reason':_0x3e71d6(0x254),'token':null}});break;case _0x3e71d6(0x176):sendTelegram(_0x2cde9a,_0x30ef44[_0x3e71d6(0x176)]);break;case _0x3e71d6(0x264):if(socket[_0x2cde9a])socket[_0x2cde9a][_0x3e71d6(0x1e1)](_0x30ef44[_0x3e71d6(0x264)],_0x30ef44[_0x3e71d6(0x1fc)]);break;}}),pid[_0x2cde9a]['on'](_0x50e579(0x16b),function(_0x254f47){if(_0x400759)return;_0x400759=!![],_0x427884(_0x254f47);}),pid[_0x2cde9a]['on']('exit',function(_0x4b8301){const _0x31239c=_0x50e579;if(_0x400759)return;_0x400759=!![],_0x427884(null);const _0x7dc138=dbConfig['get']('bots')['find']({'botID':_0x2cde9a})['value']();_0x7dc138&&(_0x7dc138[_0x31239c(0x250)]==_0x31239c(0x1d4)||_0x7dc138['status']==_0x31239c(0x184))&&(updateLive(_0x2cde9a,'stopped'),_0x4b8301!=0x4d&&(logging(_0x31239c(0x189)+_0x2cde9a),startBot([_0x2cde9a],{'cwd':bbpath},function(_0x31ad1e){if(_0x31ad1e)logging(_0x31ad1e);})));});}function stopBot(_0x57f291){const _0x38330c=_0x1678c7;if(socket[_0x57f291])socket[_0x57f291][_0x38330c(0x18b)](!![]);if(pid[_0x57f291])pid[_0x57f291][_0x38330c(0x1f2)]();}function addBot(){const _0x1926f8=_0x1678c7;let _0x1111c7;for(let _0x3e581c=0x1;_0x3e581c<0x3e9;_0x3e581c++){_0x1111c7=_0x3e581c['toString']()['padStart'](0x3,'0');let _0x50ef1e=config[_0x1926f8(0x186)](_0x815a45=>_0x815a45[_0x1926f8(0x1bc)]==_0x1111c7);if(!_0x50ef1e)break;}if(_0x1111c7===_0x1926f8(0x1c2)){logging(_0x1926f8(0x18c));return;}logging('starting\x20new\x20bot\x20|\x20Bot\x20'+_0x1111c7),dbConfig[_0x1926f8(0x277)](_0x1926f8(0x1f6))[_0x1926f8(0x274)]({'botID':_0x1111c7,'botname':_0x1926f8(0x1d5)+_0x1111c7,'status':'new','live':''})['write'](),startBot([_0x1111c7],{'cwd':bbpath},function(_0x1679d9){if(_0x1679d9)logging(_0x1679d9);}),config=getConfiguration();if(socket[_0x1926f8(0x229)])socket[_0x1926f8(0x229)]['emit'](_0x1926f8(0x1f6),config);}function deleteBot(_0x273a42){const _0xb0fe59=_0x1678c7;if(socket[_0x273a42])socket[_0x273a42][_0xb0fe59(0x18b)](!![]);dbConfig[_0xb0fe59(0x277)]('bots')[_0xb0fe59(0x209)]({'botID':_0x273a42})[_0xb0fe59(0x1af)](),logging('deleted\x20Bot\x20'+_0x273a42),stopBot(_0x273a42);try{fs['unlinkSync'](path[_0xb0fe59(0x1ab)](configpath,'bot-'+_0x273a42+_0xb0fe59(0x24d))),fs[_0xb0fe59(0x218)](path[_0xb0fe59(0x1ab)](configpath,_0xb0fe59(0x19f)+_0x273a42+_0xb0fe59(0x1be))),fs['unlinkSync'](path[_0xb0fe59(0x1ab)](configpath,'bot-'+_0x273a42+_0xb0fe59(0x25e))),fs[_0xb0fe59(0x218)](path[_0xb0fe59(0x1ab)](configpath,_0xb0fe59(0x19f)+_0x273a42+'-results.json'));}catch(_0x45373b){if(_0x45373b)logging(_0xb0fe59(0x174),_0x45373b);}config=getConfiguration();if(socket[_0xb0fe59(0x229)])socket[_0xb0fe59(0x229)][_0xb0fe59(0x1e1)]('bots',config);}function toggleBot(_0x2d3d8b,_0xd78b64,_0x215306){const _0x494c04=_0x1678c7;dbConfig[_0x494c04(0x277)](_0x494c04(0x1f6))[_0x494c04(0x186)]({'botID':_0x2d3d8b})[_0x494c04(0x28d)]({'status':_0xd78b64})[_0x494c04(0x28d)]({'live':_0x215306})[_0x494c04(0x1af)]();if(_0xd78b64==_0x494c04(0x1d4)||_0xd78b64==_0x494c04(0x184))logging(_0x494c04(0x1bf)+_0x2d3d8b),startBot([_0x2d3d8b],{'cwd':bbpath},function(_0x3e9ced){if(_0x3e9ced)logging(_0x3e9ced);});else(_0xd78b64==_0x494c04(0x271)||_0xd78b64=='new-disabled')&&(logging(_0x494c04(0x1b6)+_0x2d3d8b),stopBot(_0x2d3d8b));config=getConfiguration();if(socket[_0x494c04(0x229)])socket['botmanager'][_0x494c04(0x1e1)]('bots',config);}function updateStatus(_0x5a373a,_0x516278){const _0x2adb82=_0x1678c7;dbConfig[_0x2adb82(0x277)]('bots')[_0x2adb82(0x186)]({'botID':_0x5a373a})[_0x2adb82(0x28d)]({'status':_0x516278})[_0x2adb82(0x1af)](),config=getConfiguration();if(socket[_0x2adb82(0x229)])socket[_0x2adb82(0x229)]['emit'](_0x2adb82(0x1f6),config);}function updateLive(_0x281adb,_0x32c246){const _0x2ad9c7=_0x1678c7;dbConfig['get'](_0x2ad9c7(0x1f6))[_0x2ad9c7(0x186)]({'botID':_0x281adb})[_0x2ad9c7(0x28d)]({'live':_0x32c246})[_0x2ad9c7(0x1af)](),config=getConfiguration();if(socket[_0x2ad9c7(0x229)])socket[_0x2ad9c7(0x229)][_0x2ad9c7(0x1e1)](_0x2ad9c7(0x1f6),config);}function updateBotName(_0x3ecec8,_0x3e0de){const _0x530c32=_0x1678c7;dbConfig[_0x530c32(0x277)](_0x530c32(0x1f6))['find']({'botID':_0x3ecec8})[_0x530c32(0x28d)]({'botname':_0x3e0de})[_0x530c32(0x1af)](),config=getConfiguration();if(socket['botmanager'])socket[_0x530c32(0x229)][_0x530c32(0x1e1)](_0x530c32(0x1f6),config);}function telegramError(_0x31464a){const _0x17ffac=_0x1678c7;console['log'](getTimeStamp()+_0x17ffac(0x25f));}function validateTelegram(_0x2ff85e){const _0x2f2a3a=_0x1678c7;if(_0x2ff85e['from']['username']!=settings[_0x2f2a3a(0x24a)]&&'@'+_0x2ff85e[_0x2f2a3a(0x1c6)]['username']!=settings['telegramUsername'])return tgBot[_0x2f2a3a(0x1b8)](_0x2ff85e[_0x2f2a3a(0x23d)]['id'],_0x2f2a3a(0x282),{'parse_mode':_0x2f2a3a(0x1cb)})[_0x2f2a3a(0x260)](_0xeeca78=>{telegramError(_0xeeca78);}),![];return!![];}async function initTelegram(){const _0xa653d2=_0x1678c7;if(tgBot)tgBot[_0xa653d2(0x19d)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0xa653d2(0x1a9)],{'polling':!![]});let _0x3e2f79=_0xa653d2(0x275);_0x3e2f79+='\x0a',_0x3e2f79+=_0xa653d2(0x1cf),_0x3e2f79+='/disable\x20-\x20disable\x20notifications\x0a',_0x3e2f79+=_0xa653d2(0x1fd),_0x3e2f79+=_0xa653d2(0x1f9),_0x3e2f79+=_0xa653d2(0x291),_0x3e2f79+=_0xa653d2(0x25d);let _0x1252cd=_0xa653d2(0x1ec);_0x1252cd+='\x0a',_0x1252cd+=_0x3e2f79,tgBot[_0xa653d2(0x188)](/\/start/,_0x3ad298=>{const _0x2dc90c=_0xa653d2;if(!validateTelegram(_0x3ad298))return;if(settings[_0x2dc90c(0x1dc)]!=_0x3ad298['chat']['id'])updateSetting(_0x2dc90c(0x1dc),_0x3ad298['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x2dc90c(0x1b8)](_0x3ad298['chat']['id'],_0x1252cd)['catch'](_0x1e189d=>{telegramError(_0x1e189d);});}),tgBot[_0xa653d2(0x188)](/\/enable/,_0xd494ca=>{const _0x103ba1=_0xa653d2;if(!validateTelegram(_0xd494ca))return;if(settings[_0x103ba1(0x1dc)]!=_0xd494ca[_0x103ba1(0x23d)]['id'])updateSetting(_0x103ba1(0x1dc),_0xd494ca[_0x103ba1(0x23d)]['id']);updateSetting(_0x103ba1(0x217),!![]),tgBot[_0x103ba1(0x1b8)](_0xd494ca['chat']['id'],_0x103ba1(0x191))[_0x103ba1(0x260)](_0x43cd67=>{telegramError(_0x43cd67);});}),tgBot[_0xa653d2(0x188)](/\/config/,async _0xce4b9b=>{const _0x55fd7a=_0xa653d2;if(!validateTelegram(_0xce4b9b))return;tgBot[_0x55fd7a(0x1c9)](_0x55fd7a(0x238)),tgBot[_0x55fd7a(0x1b8)](_0xce4b9b[_0x55fd7a(0x23d)]['id'],_0x55fd7a(0x1ce),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':_0x55fd7a(0x1ff)},{'text':_0x55fd7a(0x22b),'callback_data':_0x55fd7a(0x256)},{'text':_0x55fd7a(0x22d),'callback_data':_0x55fd7a(0x1ef)}]]}})[_0x55fd7a(0x260)](_0x5a572f=>{telegramError(_0x5a572f);}),tgBot['on']('callback_query',async _0xafc3be=>{const _0x2c152e=_0x55fd7a,_0x536f61=_0xafc3be['data'],_0x403370=_0xafc3be['message'];tgBot['answerCallbackQuery'](_0xafc3be['id'])[_0x2c152e(0x1b2)](async()=>{const _0x59a36d=_0x2c152e;_0x536f61==_0x59a36d(0x1ff)&&(updateSetting('telegramEvents',_0x59a36d(0x1ff)),updateSetting(_0x59a36d(0x217),!![]),await tgBot['sendMessage'](_0x403370[_0x59a36d(0x23d)]['id'],_0x59a36d(0x204))[_0x59a36d(0x260)](_0x3190fe=>{telegramError(_0x3190fe);}));_0x536f61=='alerts'&&(updateSetting(_0x59a36d(0x1de),'alerts'),updateSetting(_0x59a36d(0x217),!![]),await tgBot['sendMessage'](_0x403370[_0x59a36d(0x23d)]['id'],_0x59a36d(0x1a8))['catch'](_0x987df6=>{telegramError(_0x987df6);}));_0x536f61==_0x59a36d(0x1ef)&&(updateSetting(_0x59a36d(0x1de),_0x59a36d(0x1ef)),updateSetting(_0x59a36d(0x217),!![]),await tgBot[_0x59a36d(0x1b8)](_0x403370[_0x59a36d(0x23d)]['id'],_0x59a36d(0x1f8))['catch'](_0x164438=>{telegramError(_0x164438);}));if(!settings[_0x59a36d(0x1dc)])tgBot[_0x59a36d(0x1b8)](_0x403370['chat']['id'],_0x59a36d(0x1e9))[_0x59a36d(0x260)](_0x1bdaa6=>{telegramError(_0x1bdaa6);});}),tgBot['removeListener']('callback_query');});}),tgBot['onText'](/\/status/,_0x3bfbf3=>{const _0x272e28=_0xa653d2;if(!validateTelegram(_0x3bfbf3))return;let _0x5317b9='<b>Balance\x20Bot\x20status:</b>\x0a';config[_0x272e28(0x1fa)](_0x176725=>{const _0x2df765=_0x272e28;_0x5317b9+=_0x2df765(0x1d5)+_0x176725[_0x2df765(0x1bc)]+_0x2df765(0x226)+_0x176725['botname']+':\x20'+_0x176725['status']+_0x2df765(0x212)+_0x176725[_0x2df765(0x281)]+'\x0a';}),_0x5317b9+='\x0a',_0x5317b9+=_0x272e28(0x227),_0x5317b9+=!settings[_0x272e28(0x217)]?_0x272e28(0x288):_0x272e28(0x171),_0x5317b9+=settings['telegramEnabled']?settings[_0x272e28(0x1de)]==_0x272e28(0x1ef)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x272e28(0x21f)+settings[_0x272e28(0x1de)]+_0x272e28(0x1b1):'',tgBot[_0x272e28(0x1b8)](_0x3bfbf3[_0x272e28(0x23d)]['id'],_0x5317b9,{'parse_mode':_0x272e28(0x1cb)})[_0x272e28(0x260)](_0x53d08e=>{telegramError(_0x53d08e);});}),tgBot['onText'](/\/restart/,_0x4eba28=>{const _0x18295e=_0xa653d2;if(!validateTelegram(_0x4eba28))return;tgBot[_0x18295e(0x1c9)](_0x18295e(0x238));const _0x47d196=getEnabledBots();if(_0x47d196[_0x18295e(0x270)]==0x0)tgBot[_0x18295e(0x1b8)](_0x4eba28[_0x18295e(0x23d)]['id'],_0x18295e(0x182))[_0x18295e(0x260)](_0x3b24c2=>{telegramError(_0x3b24c2);});else{let _0x47f448=[],_0xb7e086=[];const _0x3452c3=_0x47d196['length']%0x4==0x0||_0x47d196[_0x18295e(0x270)]%0x4==0x3||_0x47d196['length']%0x3==0x1?0x4:0x3;let _0xdd6a06=0x0;_0x47d196[_0x18295e(0x1fa)]((_0x261ff0,_0x2e0e22)=>{const _0x1afe17=_0x18295e;if(_0x2e0e22%_0x3452c3==0x0)_0xb7e086=[];_0xb7e086[_0x1afe17(0x274)]({'text':'Bot\x20'+_0x261ff0['botID'],'callback_data':_0x261ff0['botID']}),_0x2e0e22%_0x3452c3==0x0&&(_0x47f448[_0xdd6a06]=_0xb7e086,_0xdd6a06++);}),tgBot[_0x18295e(0x1b8)](_0x4eba28[_0x18295e(0x23d)]['id'],_0x18295e(0x27b),{'reply_markup':{'inline_keyboard':_0x47f448}})[_0x18295e(0x260)](_0x423681=>{telegramError(_0x423681);}),tgBot['on'](_0x18295e(0x238),async _0x4c8dab=>{const _0x489666=_0x18295e,_0x563fd2=_0x4c8dab[_0x489666(0x16c)],_0x3ce31a=_0x4c8dab[_0x489666(0x1b0)];tgBot['answerCallbackQuery'](_0x4c8dab['id'])[_0x489666(0x1b2)](async()=>{const _0x3d4e9b=_0x489666;if(settings[_0x3d4e9b(0x1de)]==_0x3d4e9b(0x1ff))tgBot[_0x3d4e9b(0x1b8)](_0x3ce31a[_0x3d4e9b(0x23d)]['id'],_0x3d4e9b(0x1cd)+_0x563fd2)[_0x3d4e9b(0x260)](_0x4fa1ed=>{telegramError(_0x4fa1ed);});stopBot(_0x563fd2);}),tgBot[_0x489666(0x1c9)](_0x489666(0x238));});}}),tgBot[_0xa653d2(0x188)](/\/disable/,_0x21bba4=>{const _0x1e60e6=_0xa653d2;if(!validateTelegram(_0x21bba4))return;tgBot['sendMessage'](_0x21bba4[_0x1e60e6(0x23d)]['id'],_0x1e60e6(0x173))['catch'](_0x46f18d=>{telegramError(_0x46f18d);}),updateSetting(_0x1e60e6(0x217),![]);}),tgBot['onText'](/\/help/,_0x1d3b33=>{const _0xb43cd2=_0xa653d2;if(!validateTelegram(_0x1d3b33))return;tgBot['sendMessage'](_0x1d3b33['chat']['id'],_0x3e2f79)[_0xb43cd2(0x260)](_0x5f0b2f=>{telegramError(_0x5f0b2f);});}),tgBot['on'](_0xa653d2(0x278),_0x118509=>{const _0x454243=_0xa653d2;if(_0x118509[_0x454243(0x16f)]()[_0x454243(0x18a)](_0x454243(0x200))){logging(_0x454243(0x279)),tgBot[_0x454243(0x19d)](),tgBot=null;if(socket[_0x454243(0x229)])socket[_0x454243(0x229)]['emit'](_0x454243(0x17b),_0x454243(0x279));}}),process['once']('SIGINT',()=>{const _0x54d4d8=_0xa653d2;if(tgBot)tgBot['stopPolling']();process[_0x54d4d8(0x247)](0x1);}),process[_0xa653d2(0x1ac)](_0xa653d2(0x1e7),()=>{const _0x4f26d5=_0xa653d2;if(tgBot)tgBot['stopPolling']();process[_0x4f26d5(0x247)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x4935ad,_0x1263af){const _0x82a854=_0x1678c7;if(settings['telegramEnabled']){if(settings['telegramEvents']==_0x82a854(0x1ef)||(_0x1263af['type']==_0x82a854(0x16b)||_0x1263af[_0x82a854(0x19b)]=='success')&&settings[_0x82a854(0x1de)]=='alerts'||_0x1263af['type']=='order'&&settings[_0x82a854(0x1de)]==_0x82a854(0x1ff)){if(tgBot&&settings['telegramChatId'])tgBot[_0x82a854(0x1b8)](settings[_0x82a854(0x1dc)],_0x82a854(0x1d5)+_0x4935ad+'\x20>\x20'+_0x1263af[_0x82a854(0x219)])[_0x82a854(0x260)](_0x2a278b=>{telegramError(_0x2a278b);});}}}function temporaryAccess2FA(_0x3c8c46){const _0x85a238=_0x1678c7;let _0x359db4=new Date(),_0x4bdb43=![];if(lastIpApproval){if(_0x359db4-lastIpApproval<0x1388)_0x4bdb43=!![];}lastIpApproval=new Date();if(_0x4bdb43)return;tgBot&&settings[_0x85a238(0x1dc)]&&(tgBot[_0x85a238(0x1c9)](_0x85a238(0x238)),tgBot['sendMessage'](settings[_0x85a238(0x1dc)],_0x85a238(0x24c)+normalizeIP(_0x3c8c46)['show']+_0x85a238(0x244),{'parse_mode':_0x85a238(0x1cb),'reply_markup':{'inline_keyboard':[[{'text':_0x85a238(0x22f),'callback_data':'5'},{'text':_0x85a238(0x18e),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x85a238(0x206),'callback_data':_0x85a238(0x206)}]]}})[_0x85a238(0x260)](_0x2b00a=>{telegramError(_0x2b00a);}),tgBot['on'](_0x85a238(0x238),async _0x229c0c=>{const _0x467f44=_0x85a238,_0x1aa88d=_0x229c0c[_0x467f44(0x16c)],_0x10eaa1=_0x229c0c[_0x467f44(0x1b0)];tgBot[_0x467f44(0x1f3)](_0x229c0c['id'])['then'](async()=>{const _0x4e2279=_0x467f44;if(_0x1aa88d!='reject'){telegramIpApproval={'clientip':_0x3c8c46,'timestamp':new Date()[_0x4e2279(0x18d)](),'expiry':_0x1aa88d},await tgBot[_0x4e2279(0x1b8)](_0x10eaa1[_0x4e2279(0x23d)]['id'],'Access\x20enabled\x20for\x20'+_0x1aa88d+_0x4e2279(0x216),{'parse_mode':_0x4e2279(0x1cb)})[_0x4e2279(0x260)](_0x30def5=>{telegramError(_0x30def5);});for(let _0x28f7ba in socket){socket[_0x28f7ba][_0x4e2279(0x1e1)](_0x4e2279(0x250),{'access':{'allow':![],'reason':'reload','token':null}});}}else await tgBot['sendMessage'](_0x10eaa1['chat']['id'],_0x4e2279(0x19c))['catch'](_0x3dbace=>{telegramError(_0x3dbace);});}),tgBot[_0x467f44(0x1c9)](_0x467f44(0x238));}));}function loginAccess2FA(_0x4edce8){const _0x1ae372=_0x1678c7;tgBot&&settings['telegramChatId']&&(tgBot['removeListener'](_0x1ae372(0x238)),tgBot[_0x1ae372(0x1b8)](settings['telegramChatId'],_0x1ae372(0x266)+normalizeIP(_0x4edce8)[_0x1ae372(0x1b5)]+_0x1ae372(0x244),{'parse_mode':_0x1ae372(0x1cb),'reply_markup':{'inline_keyboard':[[{'text':_0x1ae372(0x228),'callback_data':loginExpiry},{'text':_0x1ae372(0x206),'callback_data':_0x1ae372(0x206)}]]}})[_0x1ae372(0x260)](_0x2fe4c0=>{telegramError(_0x2fe4c0);}),tgBot['on']('callback_query',async _0x1223b6=>{const _0x53e131=_0x1ae372,_0x22dee6=_0x1223b6['data'],_0x302c33=_0x1223b6[_0x53e131(0x1b0)];tgBot[_0x53e131(0x1f3)](_0x1223b6['id'])['then'](async()=>{const _0x3b1eaf=_0x53e131;if(_0x22dee6!='reject'){telegram2FaApproval={'clientip':_0x4edce8,'timestamp':new Date()[_0x3b1eaf(0x18d)](),'expiry':_0x22dee6},await tgBot[_0x3b1eaf(0x1b8)](_0x302c33[_0x3b1eaf(0x23d)]['id'],_0x3b1eaf(0x23c),{'parse_mode':'HTML'})[_0x3b1eaf(0x260)](_0x382e1b=>{telegramError(_0x382e1b);});for(let _0x35c5d4 in socket){socket[_0x35c5d4][_0x3b1eaf(0x1e1)](_0x3b1eaf(0x250),{'access':{'allow':![],'reason':_0x3b1eaf(0x254),'token':null}});}}else await tgBot[_0x3b1eaf(0x1b8)](_0x302c33[_0x3b1eaf(0x23d)]['id'],_0x3b1eaf(0x1e0))['catch'](_0x35f532=>{telegramError(_0x35f532);});}),tgBot['removeListener']('callback_query');}));}function getConfiguration(){const _0x4fc775=_0x1678c7;return dbConfig[_0x4fc775(0x277)]('bots')[_0x4fc775(0x24e)]('botID')[_0x4fc775(0x221)]()||[];}function getEnabledBots(){const _0x5a13fd=_0x1678c7;return dbConfig['get']('bots')['sortBy'](_0x5a13fd(0x1bc))[_0x5a13fd(0x215)]({'status':_0x5a13fd(0x1d4)})[_0x5a13fd(0x221)]()||[];}function getSettings(){const _0x1c193a=_0x1678c7;return dbSettings['get'](_0x1c193a(0x292))[_0x1c193a(0x221)]()||{'timeshift':0x0};}function getSecure(){const _0x340b0a=_0x1678c7;return dbSecure[_0x340b0a(0x277)](_0x340b0a(0x223))['value']()||{};}function getBlacklist(){const _0x9a1b7a=_0x1678c7;return dbSecure[_0x9a1b7a(0x277)](_0x9a1b7a(0x21e))[_0x9a1b7a(0x221)]()||[];}function broadcastToBots(_0x4eed64,_0x54166f){const _0x84c1f4=_0x1678c7;config[_0x84c1f4(0x1fa)](_0x35d826=>{const _0x3780c8=_0x84c1f4;if(_0x35d826[_0x3780c8(0x250)]==_0x3780c8(0x1d4)&&_0x35d826[_0x3780c8(0x281)]==_0x3780c8(0x1a4)){if(pid[_0x35d826['botID']])pid[_0x35d826[_0x3780c8(0x1bc)]][_0x3780c8(0x249)]({[_0x4eed64]:_0x54166f});}});}function storeSettings(_0xd30b6d,_0x3036d5=![]){const _0x5063b3=_0x1678c7;_0xd30b6d={...settings,..._0xd30b6d};if(_0x3036d5&&_0xd30b6d[_0x5063b3(0x24f)]!=_0x5063b3(0x1e5)&&_0xd30b6d['bbPassword']!=''){const _0x11d6b4=crypt['decrypt'](secure['privateKey'],_0xd30b6d[_0x5063b3(0x24f)])[_0x5063b3(0x1b0)][_0x5063b3(0x1ea)]('@')[0x0],_0x22fe98=bcrypt['hashSync'](_0x11d6b4,saltRounds);_0xd30b6d={..._0xd30b6d,'bbPassword':_0x22fe98};}if(_0x3036d5&&_0xd30b6d[_0x5063b3(0x1a9)]!=_0x5063b3(0x1e5)&&_0xd30b6d[_0x5063b3(0x1a9)]!=''){const _0xfa98be=crypt['decrypt'](secure[_0x5063b3(0x225)],_0xd30b6d[_0x5063b3(0x1a9)])[_0x5063b3(0x1b0)][_0x5063b3(0x1ea)]('@')[0x0];_0xd30b6d={..._0xd30b6d,'telegramToken':_0xfa98be};}const _0x548da7=_0xd30b6d[_0x5063b3(0x1a9)]!=_0x5063b3(0x1e5)&&_0xd30b6d['telegramToken']!=settings[_0x5063b3(0x1a9)]||_0xd30b6d[_0x5063b3(0x24a)]!=settings['telegramUsername'],_0x465545=_0xd30b6d[_0x5063b3(0x1a9)]==''||_0xd30b6d['telegramUsername']=='';if(_0x548da7)_0xd30b6d[_0x5063b3(0x1de)]='all';for(const [_0x7cf598,_0x41dbc9]of Object[_0x5063b3(0x27d)](_0xd30b6d)){if(_0x7cf598==_0x5063b3(0x1a9)&&_0x41dbc9=='************'){_0xd30b6d['telegramToken']=settings[_0x5063b3(0x1a9)];continue;};if(_0x7cf598==_0x5063b3(0x24f)&&_0x41dbc9==_0x5063b3(0x1e5)){_0xd30b6d[_0x5063b3(0x24f)]=settings[_0x5063b3(0x24f)];continue;};dbSettings[_0x5063b3(0x248)]('settings.'+_0x7cf598,_0x41dbc9)[_0x5063b3(0x1af)]();}settings=_0xd30b6d;if(socket['botmanager'])socket[_0x5063b3(0x229)]['emit']('settings',cleanSettings());broadcastToBots('timeshift',settings[_0x5063b3(0x1d9)]);if(_0x548da7&&!_0x465545)initTelegram();if(_0x548da7&&_0x465545)disableTelegram();for(let _0x42979a in socket){setAccess(_0x42979a);}}function updateSetting(_0x5a0aac,_0x1b1b9c){const _0x5ee50c=_0x1678c7;dbSettings['set']('settings.'+_0x5a0aac,_0x1b1b9c)[_0x5ee50c(0x1af)](),settings=getSettings();if(socket[_0x5ee50c(0x229)])socket[_0x5ee50c(0x229)][_0x5ee50c(0x1e1)](_0x5ee50c(0x292),cleanSettings());}function storeSecure(_0x358ac3){const _0x409159=_0x1678c7;dbSecure[_0x409159(0x277)](_0x409159(0x223))[_0x409159(0x274)](_0x358ac3)[_0x409159(0x1af)](),secure=_0x358ac3;}function addBlacklist(){const _0x3ba819=_0x1678c7;cleanBlacklist();let _0x1af3f5;telegramIpApproval?_0x1af3f5=Math[_0x3ba819(0x170)](telegramIpApproval[_0x3ba819(0x231)],loginExpiry):_0x1af3f5=loginExpiry,dbSecure['get'](_0x3ba819(0x21e))[_0x3ba819(0x274)]({'expiry':new Date()[_0x3ba819(0x18d)]()+_0x1af3f5*0x3c*0x3e8,'token':token})[_0x3ba819(0x1af)](),blacklist=dbSecure[_0x3ba819(0x277)](_0x3ba819(0x21e))['value']();}function cleanBlacklist(){const _0xcab0f4=_0x1678c7;let _0x388c3a=dbSecure[_0xcab0f4(0x277)]('blacklist')[_0xcab0f4(0x1bd)]()[_0xcab0f4(0x221)](),_0x34c571=new Date()[_0xcab0f4(0x18d)]();_0x388c3a[_0xcab0f4(0x1fa)](_0x102ebd=>{const _0x5bf0fb=_0xcab0f4;_0x102ebd[_0x5bf0fb(0x231)]<_0x34c571&&dbSecure[_0x5bf0fb(0x277)]('blacklist')[_0x5bf0fb(0x209)]({'expiry':_0x102ebd[_0x5bf0fb(0x231)]})['write']();});}function initStates(){const _0x42339b=_0x1678c7;let _0x4aa312=getConfiguration();_0x4aa312[_0x42339b(0x1fa)](_0x7629de=>{const _0x30d159=_0x42339b;_0x7629de[_0x30d159(0x281)]=_0x30d159(0x1d6);}),storeConfiguration(_0x4aa312);}function onKeys(){const _0x555d81=new RSA();return new Promise(_0x55cf94=>{const _0x372a61=_0x3d3c;_0x555d81[_0x372a61(0x28a)]()[_0x372a61(0x1b2)](_0x58cd75=>{_0x55cf94(_0x58cd75);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x42d962=_0x1678c7;let _0x47627f=getConfiguration(),_0x5aa1e7=![];_0x47627f[_0x42d962(0x1fa)](_0x49c5d5=>{const _0x295c0e=_0x42d962;if(_0x49c5d5[_0x295c0e(0x250)]=='running')_0x49c5d5[_0x295c0e(0x250)]=_0x295c0e(0x1d4),_0x5aa1e7=!![];else _0x49c5d5[_0x295c0e(0x250)]=='stopped'&&(_0x49c5d5[_0x295c0e(0x250)]=_0x295c0e(0x271),_0x5aa1e7=!![]);});if(_0x5aa1e7)storeConfiguration(_0x47627f);let _0x101c63=getSecure();if(!_0x101c63[_0x42d962(0x280)](_0x42d962(0x1f4))){let _0x34af5a=await generateKeys();_0x101c63['publicKey']=_0x34af5a[_0x42d962(0x28b)],_0x101c63[_0x42d962(0x225)]=_0x34af5a[_0x42d962(0x225)],_0x101c63[_0x42d962(0x1f4)]=crypto['randomBytes'](0x20)['toString'](_0x42d962(0x1d0));;storeSecure(_0x101c63);}let _0x5d5a54=getSettings();_0x5aa1e7=![];!_0x5d5a54[_0x42d962(0x280)]('loginRequired')&&(_0x5d5a54[_0x42d962(0x21b)]=![],_0x5d5a54[_0x42d962(0x17f)]='',_0x5d5a54[_0x42d962(0x24f)]='',_0x5d5a54['f2aRequired']=![],_0x5aa1e7=!![]);!_0x5d5a54[_0x42d962(0x280)](_0x42d962(0x222))&&(_0x5d5a54[_0x42d962(0x222)]=![],_0x5d5a54[_0x42d962(0x179)]=[],_0x5d5a54[_0x42d962(0x1c0)]=![],_0x5aa1e7=!![]);if(!_0x5d5a54[_0x42d962(0x280)]('telegramEnabled')){if(_0x5d5a54[_0x42d962(0x1dc)])_0x5d5a54[_0x42d962(0x217)]=!![];else _0x5d5a54['telegramEnabled']=![];_0x5aa1e7=!![];}if(_0x5aa1e7)storeSettings(_0x5d5a54);}function storeConfiguration(_0x477854){const _0x4da2e5=_0x1678c7;dbConfig[_0x4da2e5(0x277)](_0x4da2e5(0x1f6))['remove']()[_0x4da2e5(0x1af)](),dbConfig['get'](_0x4da2e5(0x1f6))['push'](..._0x477854)['write'](),config=_0x477854;}function resetPassword(){const _0x526b72=_0x1678c7;tgBot&&settings[_0x526b72(0x1dc)]&&(tgBot[_0x526b72(0x1c9)](_0x526b72(0x238)),tgBot['sendMessage'](settings[_0x526b72(0x1dc)],_0x526b72(0x207),{'parse_mode':_0x526b72(0x1cb),'reply_markup':{'inline_keyboard':[[{'text':_0x526b72(0x1f5),'callback_data':_0x526b72(0x1f5)},{'text':'no','callback_data':'no'}]]}})[_0x526b72(0x260)](_0x4cb4d3=>{telegramError(_0x4cb4d3);}),tgBot['on'](_0x526b72(0x238),async _0x1fb82b=>{const _0x43fdfc=_0x526b72,_0xe7a1d3=_0x1fb82b[_0x43fdfc(0x16c)],_0x25731c=_0x1fb82b[_0x43fdfc(0x1b0)];tgBot[_0x43fdfc(0x1f3)](_0x1fb82b['id'])[_0x43fdfc(0x1b2)](async()=>{const _0x283b36=_0x43fdfc;if(_0xe7a1d3!='no'){const _0x497dd7=0xf,_0x3e8313=_0x283b36(0x1fe),_0x279bd0=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x497dd7)))[_0x283b36(0x211)](_0x1f9679=>_0x3e8313[_0x1f9679%_0x3e8313[_0x283b36(0x270)]])[_0x283b36(0x1ab)](''),_0x2fa03d=bcrypt['hashSync'](_0x279bd0,saltRounds);storeSettings({'bbPassword':_0x2fa03d}),await tgBot[_0x283b36(0x1b8)](_0x25731c[_0x283b36(0x23d)]['id'],_0x283b36(0x28f)+_0x279bd0,{'parse_mode':'HTML'})[_0x283b36(0x260)](_0x4438bf=>{telegramError(_0x4438bf);});}else await tgBot[_0x283b36(0x1b8)](_0x25731c[_0x283b36(0x23d)]['id'],_0x283b36(0x183))[_0x283b36(0x260)](_0x5b69b5=>{telegramError(_0x5b69b5);});}),tgBot[_0x43fdfc(0x1c9)]('callback_query');}));}function logging(_0x5124ba){const _0x2bfed7=_0x1678c7;console[_0x2bfed7(0x1df)](getTimeStamp()+_0x2bfed7(0x20c)+_0x5124ba);if(tgBot&&settings[_0x2bfed7(0x1dc)]&&settings[_0x2bfed7(0x1de)]!='orders')tgBot[_0x2bfed7(0x1b8)](settings[_0x2bfed7(0x1dc)],'Bot\x20Mgr\x20>\x20'+_0x5124ba)[_0x2bfed7(0x260)](_0x43b6c5=>{telegramError(_0x43b6c5);});}function getServerTime(){const _0x195fbb=_0x1678c7,_0x4e4a12=new Date();return _0x4e4a12[_0x195fbb(0x239)]()+'/'+(_0x4e4a12[_0x195fbb(0x1ba)]()+0x1)[_0x195fbb(0x16f)]()[_0x195fbb(0x1a1)](0x2,'0')+'/'+_0x4e4a12[_0x195fbb(0x230)]()[_0x195fbb(0x16f)]()[_0x195fbb(0x1a1)](0x2,'0')+'\x20'+_0x4e4a12[_0x195fbb(0x1aa)]()['toString']()[_0x195fbb(0x1a1)](0x2,'0')+':'+_0x4e4a12[_0x195fbb(0x1e4)]()[_0x195fbb(0x16f)]()['padStart'](0x2,'0')+':'+_0x4e4a12[_0x195fbb(0x290)]()[_0x195fbb(0x16f)]()[_0x195fbb(0x1a1)](0x2,'0');}function getTimeStamp(){const _0x5c3cdf=_0x1678c7,_0x59f82c=shiftedTime();return _0x59f82c['getFullYear']()+'/'+(_0x59f82c[_0x5c3cdf(0x1ba)]()+0x1)[_0x5c3cdf(0x16f)]()[_0x5c3cdf(0x1a1)](0x2,'0')+'/'+_0x59f82c['getDate']()[_0x5c3cdf(0x16f)]()['padStart'](0x2,'0')+'\x20'+_0x59f82c[_0x5c3cdf(0x1aa)]()['toString']()[_0x5c3cdf(0x1a1)](0x2,'0')+':'+_0x59f82c[_0x5c3cdf(0x1e4)]()[_0x5c3cdf(0x16f)]()[_0x5c3cdf(0x1a1)](0x2,'0')+':'+_0x59f82c['getSeconds']()[_0x5c3cdf(0x16f)]()[_0x5c3cdf(0x1a1)](0x2,'0');}function shiftedTime(){const _0x5977a2=_0x1678c7,_0x1804f7=new Date();let _0x3ca603=_0x1804f7;if(settings[_0x5977a2(0x1d9)]&&settings[_0x5977a2(0x1d9)]!==0x0)_0x3ca603=fns[_0x5977a2(0x26b)](_0x1804f7,{'hours':settings['timeshift']});return _0x3ca603;}function startAnalytics(){const _0x19794d=_0x1678c7;let _0x2ccda6=new Date()[_0x19794d(0x26a)]();_0x2ccda6==0x9&&triggerAnalytics();if(pidAnalytics)clearTimeout(pidAnalytics);pidAnalytics=setTimeout(()=>{startAnalytics();},0x3c*0x3c*0x3e8);}function triggerAnalytics(){const _0x5aebe0=_0x1678c7;analytics['page']({'title':_0x5aebe0(0x1cc),'href':_0x5aebe0(0x17a),'path':'/v'+serverversion});}function validateCredentials(_0x12707f){const _0x30de69=_0x1678c7;if(_0x12707f[_0x30de69(0x1eb)]==settings[_0x30de69(0x17f)]&&bcrypt[_0x30de69(0x289)](_0x12707f[_0x30de69(0x253)],settings[_0x30de69(0x24f)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x30de69(0x276),'token':null};else{const _0x4e0c4b=generateLoginToken();return{'allow':!![],'reason':_0x30de69(0x1ee),'token':_0x4e0c4b};}}else return{'allow':![],'reason':_0x30de69(0x1ca),'token':null};}function refreshToken(){const _0x367522=_0x1678c7,_0x5f36d7=generateLoginToken();return{'allow':!![],'reason':_0x367522(0x1ee),'token':_0x5f36d7};}function validateAccess(_0x2a7ad4){const _0x4f2564=_0x1678c7;let _0xb1c63d;const _0x332ce3=_0x28b52d=>{const _0x4ab0c5=_0x3d3c;if(settings[_0x4ab0c5(0x21b)]){if(settings[_0x4ab0c5(0x234)]){if(telegram2FaApproved()){const _0x182772=generateLoginToken();return{'allow':!![],'reason':_0x4ab0c5(0x243),'token':_0x182772};}else return{'allow':![],'reason':_0x4ab0c5(0x276),'token':null};}else return _0xb1c63d=validToken(_0x28b52d),_0xb1c63d[_0x4ab0c5(0x280)](_0x4ab0c5(0x1e8))?{'allow':!![],'reason':_0x4ab0c5(0x255),'token':_0x28b52d}:{'allow':![],'reason':_0x4ab0c5(0x287),'token':null};}else return{'allow':!![],'reason':_0x4ab0c5(0x180),'token':null};};if(settings[_0x4f2564(0x222)]){let _0x2f2cbc=[...settings[_0x4f2564(0x179)],_0x4f2564(0x22e),_0x4f2564(0x22a),'127.0.0.1'];if(_0x2f2cbc['includes'](externalip))return _0x332ce3(_0x2a7ad4);else{_0xb1c63d=validToken(_0x2a7ad4);if(_0xb1c63d[_0x4f2564(0x280)](_0x4f2564(0x1e8)))return _0x332ce3(_0x2a7ad4);else{if(telegramIpApproved()){const _0x503387=generateToken();return _0xb1c63d=_0x332ce3(_0x2a7ad4),_0xb1c63d[_0x4f2564(0x286)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x503387}:_0xb1c63d;}else return settings[_0x4f2564(0x1c0)]?{'allow':![],'reason':_0x4f2564(0x196),'token':null}:{'allow':![],'reason':_0x4f2564(0x1d3),'token':null};}}}else return _0x332ce3(_0x2a7ad4);}function timelyDecrypt(_0x4e284f,_0x554d13=!![]){const _0x71a71b=_0x1678c7;if(_0x4e284f)try{const _0x5783b8=crypt[_0x71a71b(0x27a)](secure[_0x71a71b(0x225)],_0x4e284f)[_0x71a71b(0x1b0)],_0x21d70b=_0x5783b8['split']('@')[0x0],_0x48fd9e=_0x5783b8[_0x71a71b(0x1ea)]('@')[0x1],_0x25a822=new Date()[_0x71a71b(0x18d)]();if(_0x554d13){if(_0x25a822-_0x48fd9e<maxSecretAge*0x3e8)return _0x21d70b;else return![];}else return _0x21d70b;}catch{return![];}else return![];}const validToken=_0x420b08=>{const _0x4b9e89=_0x1678c7;if(!_0x420b08)return{'error':_0x4b9e89(0x20a)};for(let _0x2c3b5e of blacklist){if(_0x2c3b5e[_0x4b9e89(0x1b4)]==_0x420b08)return{'error':_0x4b9e89(0x27f)};}let _0x5aed44;try{_0x5aed44=jwt[_0x4b9e89(0x1a6)](_0x420b08,secure[_0x4b9e89(0x1f4)]+uuid);}catch{return{'error':_0x4b9e89(0x1d2)};}if(!_0x5aed44[_0x4b9e89(0x280)](_0x4b9e89(0x1e2))&&!_0x5aed44['hasOwnProperty']('username')||!_0x5aed44[_0x4b9e89(0x280)](_0x4b9e89(0x208)))return{'error':_0x4b9e89(0x203)};if(!_0x5aed44[_0x4b9e89(0x280)](_0x4b9e89(0x1eb))&&_0x5aed44['hasOwnProperty'](_0x4b9e89(0x1e2))){const {clientip:_0x51a0}=_0x5aed44;return externalip==_0x51a0?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x5aed44[_0x4b9e89(0x280)]('username')&&_0x5aed44['hasOwnProperty'](_0x4b9e89(0x1e2))){const {username:_0x2d9deb,clientip:_0x2728a1}=_0x5aed44;return settings[_0x4b9e89(0x17f)]==_0x2d9deb&&externalip==_0x2728a1?{'success':_0x4b9e89(0x1a0)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=()=>{const _0x506116=_0x1678c7;if(uuid)return jwt[_0x506116(0x193)]({'username':settings[_0x506116(0x17f)],'clientip':externalip},secure[_0x506116(0x1f4)]+uuid,{'expiresIn':tokenRefresh*0x3c});else return![];},generateToken=()=>{const _0x19f543=_0x1678c7;if(uuid)return jwt[_0x19f543(0x193)]({'clientip':externalip},secure['secret']+uuid,{'expiresIn':telegramIpApproval[_0x19f543(0x231)]*0x3c});else return![];},telegramIpApproved=()=>{const _0x117166=_0x1678c7;let _0x3b405f=![];return telegramIpApproval&&telegramIpApproval[_0x117166(0x231)]!=_0x117166(0x206)&&(_0x3b405f=telegramIpApproval['clientip']==externalip&&new Date()[_0x117166(0x18d)]()-telegramIpApproval[_0x117166(0x23b)]<telegramIpApproval[_0x117166(0x231)]*0x3c*0x3e8),_0x3b405f;},telegram2FaApproved=()=>{const _0x3c7848=_0x1678c7;let _0x3d6a11=![];return telegram2FaApproval&&telegram2FaApproval[_0x3c7848(0x231)]!=_0x3c7848(0x206)&&(_0x3d6a11=telegram2FaApproval[_0x3c7848(0x1e2)]==externalip&&new Date()['getTime']()-telegram2FaApproval[_0x3c7848(0x23b)]<telegram2FaApproval[_0x3c7848(0x231)]*0x3c*0x3e8),_0x3d6a11;},normalizeIP=_0x9f55a1=>{const _0x259188=_0x1678c7;let _0xfad338=null,_0x28027e=null;if(ipaddr['isValid'](_0x9f55a1)){const _0x4a0abf=ipaddr['parse'](_0x9f55a1);_0x4a0abf['kind']()==='ipv6'?(_0x4a0abf[_0x259188(0x213)]()&&(_0xfad338=_0x4a0abf[_0x259188(0x18f)]()[_0x259188(0x16f)]()),_0x28027e=_0x4a0abf['toString']()):(_0xfad338=_0x4a0abf[_0x259188(0x16f)](),_0x28027e=_0x4a0abf[_0x259188(0x257)]()[_0x259188(0x16f)]());}return{'show':_0xfad338?_0xfad338:_0x28027e,'store':_0x28027e};};