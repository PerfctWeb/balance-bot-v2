const _0xde545d=_0x3666;(function(_0x15b957,_0x1c30c7){const _0x17bea8=_0x3666,_0x531a35=_0x15b957();while(!![]){try{const _0x5351ea=-parseInt(_0x17bea8(0x16e))/0x1*(parseInt(_0x17bea8(0x1c4))/0x2)+-parseInt(_0x17bea8(0x1af))/0x3+parseInt(_0x17bea8(0x114))/0x4*(-parseInt(_0x17bea8(0x1e2))/0x5)+-parseInt(_0x17bea8(0x21d))/0x6*(parseInt(_0x17bea8(0x1b5))/0x7)+parseInt(_0x17bea8(0xf7))/0x8*(parseInt(_0x17bea8(0x14d))/0x9)+-parseInt(_0x17bea8(0x212))/0xa*(-parseInt(_0x17bea8(0xe4))/0xb)+parseInt(_0x17bea8(0x122))/0xc;if(_0x5351ea===_0x1c30c7)break;else _0x531a35['push'](_0x531a35['shift']());}catch(_0x1c0ce7){_0x531a35['push'](_0x531a35['shift']());}}}(_0x1351,0x9fd1e));const _0x2351cb=function(){let _0x34375c=!![];return function(_0x3aec83,_0x1827e5){const _0x2a6a86=_0x34375c?function(){const _0x324a26=_0x3666;if(_0x1827e5){const _0x127d6d=_0x1827e5[_0x324a26(0x1f3)](_0x3aec83,arguments);return _0x1827e5=null,_0x127d6d;}}:function(){};return _0x34375c=![],_0x2a6a86;};}(),_0x2f02dc=_0x2351cb(this,function(){const _0x1f8ee3=_0x3666;return _0x2f02dc['toString']()[_0x1f8ee3(0x180)](_0x1f8ee3(0x117))[_0x1f8ee3(0x1dd)]()[_0x1f8ee3(0xf5)](_0x2f02dc)[_0x1f8ee3(0x180)](_0x1f8ee3(0x117));});_0x2f02dc();'use strict';process[_0xde545d(0x176)][_0xde545d(0x1a0)]=0x1;const childProcess=require(_0xde545d(0x1a2)),FileSync=require(_0xde545d(0x107)),fs=require('fs'),fns=require(_0xde545d(0xdf)),low=require(_0xde545d(0x130)),path=require('path'),crypto=require('crypto'),Crypt=require(_0xde545d(0x147))[_0xde545d(0x119)],RSA=require(_0xde545d(0x147))[_0xde545d(0x1bd)],bcrypt=require(_0xde545d(0x12e)),jwt=require('jsonwebtoken'),analyticsLib=require('analytics')['default'],googleAnalytics=require(_0xde545d(0x21b))[_0xde545d(0x186)],ipaddr=require(_0xde545d(0x20a)),argv=require('yargs/yargs')(process['argv'][_0xde545d(0x15d)](0x2))[_0xde545d(0x1d1)],PORT=argv[_0xde545d(0x163)]||_0xde545d(0xf4),pattern=/^[0-9]{2,4}$/;if(!pattern[_0xde545d(0x1b2)](PORT))return console[_0xde545d(0x17e)]('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0xde545d(0x10c)](0x1);const HOST=argv[_0xde545d(0x135)]||null,userID=argv[_0xde545d(0x15f)]||'';let bbpath=_0xde545d(0x1d6);const botfile=_0xde545d(0x1b8),configfile=_0xde545d(0x1a9),settingsfile=_0xde545d(0x133),securefile='bb-secure.json';!fs['existsSync'](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath+_0xde545d(0x1c6)),configpath=userID?bbpath+_0xde545d(0xdc)+userID+'/':bbpath+_0xde545d(0xdc),configbackuppath=configpath+'backup/';function _0x1351(){const _0x52b232=['/enable\x20-\x20enable\x20notifications\x0a','temporary\x20access\x20rejected','status','once','polling_error','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','defaults','slice','Balance\x20Bot\x20Server','user','Notifications\x20disabled','mkdirSync','login\x20required','port','/:bot/configuration','restart','message','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','reject','build2','/:bot','login','temporaryAccessAllowed','temporary\x20access\x20not\x20allowed','3QBJebQ','alerts','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','-events.json','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','<b>Telegram\x20bot\x20status:</b>\x0a','handshake','build','env','orders','connected','isIPv4MappedAddress','stopPolling','chat','Unauthorized\x20login\x20attempt\x20(public\x20key)','getPortfolio','log','getUTCHours','search','live','enabled','accept','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','kill','default','Invalid\x20Telegram\x20token','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','2FA\x20required','restarting\x20Bot\x20','Access\x20enabled\x20for\x20','sockets','temporary\x20token\x20generated','getDate','get-starting-balances','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','new','padStart','bbPassword','whitelist','2FA\x20login\x20rejected','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','then','settings.','removeListener','getStartingBalances','https://hodlerhacks.com','sendMessage','forEach','login\x20not\x20required','NTBA_FIX_319',':\x20Bot\x20Mgr\x20>\x20','child_process','onText','sortBy','/:bot/performance','storeHeadless','callback_query','disabled\x20Bot\x20','bb-config.json','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','password','type','set','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','3447672PTEXpX','entries','createServer','test','HTML','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','49vJSmYZ','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','encryptedUuid','bot.js','invalid\x20credentials','args','showname','toIPv4MappedAddress','RSA','Unauthorized\x20attempt\x20to\x20log\x20out','idling\x20bot\x20\x20\x20|\x20Bot\x20','telegram2FaApproval','data','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Bot\x20Mgr\x20>\x20','332922qkUQgk','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','clients','/off\x20-\x20stop\x20bot(s)\x0a','value','inherit','/:bot/portfolio','length','All\x20bots','whitelistEnabled','allow','express','/:bot/history','argv','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','blacklist','bbUsername','join','bb/','ipc','telegramToken','hex','new-disabled','decrypt','1000','toString','Login\x20rejected','/:bot/support',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','started','185fPubQh','reset-password','telegramChatId','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','/on\x20-\x20start\x20bot(s)\x0a','copyFileSync','404\x20Not\x20Found','getMonth','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Unauthorized\x20attempt\x20to\x20update\x20bot','botmanager','includes','************','bot-','reload','max','static','apply','15\x20min','publicKey','botname','notification','telegramEnabled','sendFile','index.html','-results.json','30\x20min','pidRefreshToken','Orders','Ok,\x20will\x20send\x20order\x20notifications\x20only','No\x20authentication\x20token','stop','isValid','starting\x20new\x20bot\x20|\x20Bot\x20','version.json','No\x20bots\x20running\x20right\x20now','bots','placeOrder','botID','5\x20min','ipaddr.js','login\x20token\x20valid','Unauthorized\x20attempt\x20to\x20store\x20configuration','\x20minutes','sha256','randomFillSync','catch','temporary\x20access\x20timeout','10fnWTyr','unlinkSync','Invalid\x20IP\x20address','Invalid\x20authentication\x20token\x20(1)','error','clientip','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','remove','hashSync','@analytics/google-analytics','answerCallbackQuery','704118qWeGtK','page','randomBytes','place-order','stopped','Unauthorized\x20attempt\x20to\x20delete\x20bot','getFullYear','bot','conn','timestamp','auth','config/','getSeconds','reason','date-fns','map','hasOwnProperty','privateKey','get-logs','12620619vDoUnK','<b>Balance\x20Bot\x20status:</b>\x0a','generateKeyPairAsync','isDirectory','cancelLoading','use','get','http','server','match','socket.io','pidExpireLogin','telegramIpApproval','disconnect','logout','Invalid\x20username\x20or\x20IP\x20address','3000','constructor','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','193896wfvqgI','-config.json','Ok,\x20will\x20send\x20alert\x20notifications\x20only','all','connection','listen','cloneDeep','2FA\x20login\x20required','name','write','split','uuid','filter','2FA\x20login\x20token\x20generated','telegram','yes','lowdb/adapters/FileSync','RSA-OAEP','User\x20has\x20been\x20validated','push','store-configuration','exit','event','storeConfiguration','update-bot','/status\x20-\x20show\x20bot(s)\x20status\x0a','success','secret','emit','36436cuIutZ','getHours','Unauthorized\x20attempt\x20to\x20get\x20portfolio','(((.+)+)+)+$','telegramUsername','Crypt','logged\x20out','/:bot/coins','-----------------------------------------------------------------------------------','/help\x20-\x20show\x20available\x20commands\x0a','show','\x20|\x20','running','node-telegram-bot-api','21374280ddnbDB','telegramEvents','/restart\x20-\x20restart\x20bot(s)\x0a','settings','remoteAddress','Unauthorized\x20attempt\x20to\x20update\x20settings','secure','starting\x20bot\x20|\x20Bot\x20','access','Notifications\x20enabled\x0a','version','/disable\x20-\x20disable\x20notifications\x0a','bcryptjs','You\x20can\x20use\x20the\x20following\x20commands:\x0a','lowdb','Temporary\x20access\x20rejected','2FA','bb-settings.json','expiry','host','Balance\x20Bot','find','f2aRequired','kind','enabled\x20Bot\x20','Alerts','compareSync','error\x20while\x20deleting\x20config\x20files:\x20','login\x20token\x20generated','exp','sign','from','loginRequired','username','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','disabled','function','hybrid-crypto-js','assign','Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20logs','deleted\x20Bot\x20','Invalid\x20authentication\x20token\x20(2)','198MYXJRI','token','referer','getTime','send','Unauthorized\x20attempt\x20to\x20add\x20bot','Login\x20accepted','</b>\x20?','timeshift'];_0x1351=function(){return _0x52b232;};return _0x1351();}!fs['existsSync'](configpath)&&fs[_0xde545d(0x161)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0xde545d(0x161)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0xde545d(0x15c)]({'bots':[]})[_0xde545d(0x100)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0xde545d(0x15c)]({'settings':{'timeshift':0x0}})[_0xde545d(0x100)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0xde545d(0x15c)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0xde545d(0x20e),'rsaStandard':_0xde545d(0x108)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath+_0xde545d(0x204))[_0xde545d(0x12c)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require(_0xde545d(0x1cf)),app=express(),http=require(_0xde545d(0xeb))[_0xde545d(0x1b1)](app);app[_0xde545d(0xe9)](express['static'](path[_0xde545d(0x1d5)](__dirname,bbpath,_0xde545d(0x169)))),app[_0xde545d(0xe9)](express[_0xde545d(0x1f2)](path['join'](__dirname,bbpath,_0xde545d(0x175)))),app['get']('/',function(_0x29941f,_0x3f0204){const _0x3d2e5e=_0xde545d;_0x3f0204[_0x3d2e5e(0x1f9)](path[_0x3d2e5e(0x1d5)](__dirname,bbpath,_0x3d2e5e(0x169),'index.html'));}),app[_0xde545d(0xea)](_0xde545d(0x16a),function(_0x415bcd,_0x1827eb){const _0x117f62=_0xde545d;_0x1827eb['sendFile'](path[_0x117f62(0x1d5)](__dirname,bbpath,_0x117f62(0x175),'index.html'));}),app[_0xde545d(0xea)](_0xde545d(0x1ca),(_0x2a8eec,_0x2527f7)=>{const _0x14c153=_0xde545d;_0x2527f7[_0x14c153(0x1f9)](path[_0x14c153(0x1d5)](__dirname,bbpath,_0x14c153(0x175),_0x14c153(0x1fa)));}),app['get'](_0xde545d(0x1a5),(_0x381bb9,_0x549839)=>{const _0x3e114c=_0xde545d;_0x549839[_0x3e114c(0x1f9)](path[_0x3e114c(0x1d5)](__dirname,bbpath,_0x3e114c(0x175),_0x3e114c(0x1fa)));}),app['get'](_0xde545d(0x11b),(_0x32eb4e,_0x1440fa)=>{const _0x22531e=_0xde545d;_0x1440fa['sendFile'](path[_0x22531e(0x1d5)](__dirname,bbpath,_0x22531e(0x175),_0x22531e(0x1fa)));}),app[_0xde545d(0xea)](_0xde545d(0x1d0),(_0x577159,_0x2700ce)=>{const _0x48408f=_0xde545d;_0x2700ce['sendFile'](path[_0x48408f(0x1d5)](__dirname,bbpath,_0x48408f(0x175),_0x48408f(0x1fa)));}),app[_0xde545d(0xea)](_0xde545d(0x164),(_0x427955,_0x545cf4)=>{const _0x5606e2=_0xde545d;_0x545cf4[_0x5606e2(0x1f9)](path['join'](__dirname,bbpath,'build',_0x5606e2(0x1fa)));}),app['get'](_0xde545d(0x1df),(_0xa663f1,_0x5ec4d9)=>{const _0x2ea0e7=_0xde545d;_0x5ec4d9[_0x2ea0e7(0x1f9)](path['join'](__dirname,bbpath,_0x2ea0e7(0x175),_0x2ea0e7(0x1fa)));});if(HOST)http[_0xde545d(0xfc)](PORT,HOST);else http[_0xde545d(0xfc)](PORT);const io=require(_0xde545d(0xee))(http,{}),analytics=analyticsLib({'app':_0xde545d(0x136),'plugins':[googleAnalytics({'trackingId':'UA-192771731-1'})]}),TelegramBot=require(_0xde545d(0x121));let tgBot;if(settings['telegramToken']&&settings['telegramToken']!=''&&settings['telegramUsername']&&settings['telegramUsername']!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x451524=_0xde545d;console[_0x451524(0x17e)](''),console['log']('-----------------------------------------------------------------------------------'),logging(_0x451524(0x1b4)+PORT),console['log']('-----------------------------------------------------------------------------------');if(config[_0x451524(0x1cb)]!=0x0)config[_0x451524(0x19e)](_0x57e68b=>{const _0x237900=_0x451524;if(_0x57e68b['status']==_0x237900(0x182)||_0x57e68b[_0x237900(0x158)]=='new')logging(_0x237900(0x129)+_0x57e68b['botID']+_0x237900(0x11f)+_0x57e68b[_0x237900(0x1f6)]),startBot([_0x57e68b[_0x237900(0x208)],userID],{'cwd':bbpath},function(_0x3c522c){if(_0x3c522c)logging(_0x3c522c);});else(_0x57e68b['status']==_0x237900(0x145)||_0x57e68b[_0x237900(0x158)]==_0x237900(0x1da))&&logging(_0x237900(0x1bf)+_0x57e68b['botID']+_0x237900(0x11f)+_0x57e68b[_0x237900(0x1f6)]);});else!newBot&&console[_0x451524(0x17e)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();console[_0x451524(0x17e)](_0x451524(0x11c)),console[_0x451524(0x17e)]('');}function startSocket(){const _0x5d459d=_0xde545d;io['on'](_0x5d459d(0xfb),_0x191257=>{const _0x288d1d=_0x5d459d;let _0x4177c7,_0x80e79c,_0x29d82f,_0x300051,_0x21eafb;const _0x4515ab=_0x191257[_0x288d1d(0x174)]['headers'][_0x288d1d(0x14f)];_0x80e79c=_0x4515ab[_0x288d1d(0xed)](/bot[0-9]{3}/);if(_0x80e79c)_0x29d82f=_0x80e79c[0x0][_0x288d1d(0xed)](/[0-9]{3}/);if(_0x29d82f)_0x4177c7=_0x29d82f[0x0];else _0x4177c7=_0x288d1d(0x1ec);const _0x5c827e=_0x191257[_0x288d1d(0x174)][_0x288d1d(0xdb)][_0x288d1d(0x1b7)];if(!_0x5c827e)_0x191257[_0x288d1d(0x113)]('status',{'publicKey':secure['publicKey']});else{_0x300051=timelyDecrypt(_0x5c827e,![]);if(!_0x300051)logging(_0x288d1d(0x17c));else{_0x21eafb=normalizeIP(_0x191257[_0x288d1d(0xd9)][_0x288d1d(0x126)])['store'];if(!devices[_0x300051])devices[_0x300051]={'uuid':_0x300051,'access':{'token':null}};devices[_0x300051]['ip']=_0x21eafb;const _0x5c1673=addClient(_0x191257['id'],_0x300051,_0x4177c7);setAccess(_0x5c1673),_0x191257['on'](_0x288d1d(0x16b),_0x56d488=>{const _0x8b79c7=_0x288d1d,_0x2396bc=timelyDecrypt(_0x56d488[_0x8b79c7(0x1ab)]);if(_0x2396bc){_0x56d488={'username':_0x56d488['username'],'password':_0x2396bc},devices[_0x300051][_0x8b79c7(0x12a)]=validateCredentials(_0x56d488,_0x300051);if(devices[_0x300051]['access'][_0x8b79c7(0x1ce)]==![]&&devices[_0x300051]['access']['reason']==_0x8b79c7(0xfe))_0x191257[_0x8b79c7(0x113)](_0x8b79c7(0x158),{'access':devices[_0x300051]['access']}),loginAccess2FA(_0x300051,_0x21eafb);else{if(devices[_0x300051]['access']['allow']==![]&&devices[_0x300051][_0x8b79c7(0x12a)][_0x8b79c7(0xde)]==_0x8b79c7(0x1b9))_0x191257['emit'](_0x8b79c7(0x158),{'access':devices[_0x300051]['access']});else devices[_0x300051][_0x8b79c7(0x12a)][_0x8b79c7(0x1ce)]&&devices[_0x300051][_0x8b79c7(0x12a)][_0x8b79c7(0xde)]==_0x8b79c7(0x13e)&&(getClientsWithUuid(_0x300051)[_0x8b79c7(0x19e)](_0x1c9bdc=>{setAccess(_0x1c9bdc);}),setTokenRefresh(_0x300051),setSessionTimeout(_0x8b79c7(0x16b),_0x300051));}}else logging('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x191257['on'](_0x288d1d(0x1e3),()=>{resetPassword();}),_0x191257['on'](_0x288d1d(0xf1),_0x243411=>{removeClient(_0x191257['id']);});}}});}function initClient(_0x25998b){const _0x5bf507=_0xde545d;if(_0x25998b!=_0x5bf507(0x1ec)&&config['apiKey']!=''){if(pid[_0x25998b])pid[_0x25998b][_0x5bf507(0x151)]({'function':'initclient','args':null});}}function getSocket(_0x5e8b4b){const _0x5cc38a=_0xde545d;return io[_0x5cc38a(0x18c)][_0x5cc38a(0x18c)][_0x5cc38a(0xea)](_0x5e8b4b);}function setAccess(_0x50e796){const _0x3cefbb=_0xde545d,_0x3d5386=getSocket(_0x50e796['id']),_0x263c54=_0x50e796[_0x3cefbb(0x102)],_0x55ec71=_0x50e796[_0x3cefbb(0xd8)];devices[_0x263c54]['access']=validateAccess(devices[_0x263c54]['access']['token'],_0x263c54),_0x3d5386[_0x3cefbb(0x1d5)](_0x263c54);if(devices[_0x263c54][_0x3cefbb(0x12a)][_0x3cefbb(0x1ce)]){_0x3d5386[_0x3cefbb(0x1d5)](_0x55ec71);if(_0x55ec71=='botmanager')initializeSocketBotManager(_0x3d5386);else initializeSocketBot(_0x3d5386);initClient(_0x55ec71);}devices[_0x263c54]['access']['token']&&devices[_0x263c54][_0x3cefbb(0x12a)]['reason']==_0x3cefbb(0x18d)&&setSessionTimeout(_0x3cefbb(0x132),_0x263c54),devices[_0x263c54]['access']['token']&&devices[_0x263c54][_0x3cefbb(0x12a)][_0x3cefbb(0xde)]==_0x3cefbb(0x104)&&setSessionTimeout(_0x3cefbb(0x16b),_0x263c54),_0x3d5386[_0x3cefbb(0x113)](_0x3cefbb(0x158),{'status':_0x50e796[_0x3cefbb(0xec)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x263c54][_0x3cefbb(0x12a)],'externalip':devices[_0x263c54]['ip'],'publicKey':secure[_0x3cefbb(0x1f5)]}),devices[_0x263c54][_0x3cefbb(0x12a)][_0x3cefbb(0x1ce)]==![]&&devices[_0x263c54][_0x3cefbb(0x12a)][_0x3cefbb(0xde)]=='2FA\x20required'&&temporaryAccess2FA(_0x263c54,devices[_0x263c54]['ip']);}function setSessionTimeout(_0x21632a,_0x1a5474){const _0x564a3e=_0xde545d;let _0x3ef352;if(_0x21632a==_0x564a3e(0x16b))_0x3ef352=loginExpiry*0x3c*0x3e8;else _0x3ef352=devices[_0x1a5474]['telegramIpApproval'][_0x564a3e(0x134)]*0x3c*0x3e8-(new Date()[_0x564a3e(0x150)]()-devices[_0x1a5474][_0x564a3e(0xf0)][_0x564a3e(0xda)]);if(devices[_0x1a5474]['pidExpireLogin'])clearTimeout(devices[_0x1a5474][_0x564a3e(0xef)]);devices[_0x1a5474]['pidExpireLogin']=setTimeout(()=>{const _0x40ec05=_0x564a3e;if(devices[_0x1a5474][_0x40ec05(0x1fd)])clearTimeout(devices[_0x1a5474][_0x40ec05(0x1fd)]);removeSocketListeners(_0x1a5474),addBlacklist(_0x1a5474),devices[_0x1a5474][_0x40ec05(0xf0)]=null,devices[_0x1a5474]['telegram2FaApproval']=null,devices[_0x1a5474]['access'][_0x40ec05(0x14e)]=null,devices[_0x1a5474][_0x40ec05(0x12a)]=validateAccess(devices[_0x1a5474]['access']['token'],_0x1a5474),!(devices[_0x1a5474]['access'][_0x40ec05(0x1ce)]&&devices[_0x1a5474]['access'][_0x40ec05(0xde)]==_0x40ec05(0x19f))&&(_0x21632a=='login'?io['to'](_0x1a5474)['emit'](_0x40ec05(0x158),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x1a5474)[_0x40ec05(0x113)](_0x40ec05(0x158),{'access':{'allow':![],'reason':_0x40ec05(0x211),'token':null}})),devices[_0x1a5474][_0x40ec05(0x12a)][_0x40ec05(0x14e)]=null;},_0x3ef352);}function setTokenRefresh(_0x21d8b5){const _0x30c98f=_0xde545d;if(devices[_0x21d8b5][_0x30c98f(0x1fd)])clearTimeout(devices[_0x21d8b5][_0x30c98f(0x1fd)]);devices[_0x21d8b5]['pidRefreshToken']=setTimeout(()=>{const _0x16cd69=_0x30c98f;getClientsWithUuid(_0x21d8b5)[_0x16cd69(0x1cb)]!=0x0?(devices[_0x21d8b5][_0x16cd69(0x12a)]=refreshToken(_0x21d8b5),io['to'](_0x21d8b5)[_0x16cd69(0x113)]('status',{'status':_0x16cd69(0x178),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x21d8b5][_0x16cd69(0x12a)],'externalip':devices[_0x21d8b5]['ip'],'publicKey':secure['publicKey']}),setTokenRefresh(_0x21d8b5)):clearTimeout(devices[_0x21d8b5]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x497439){const _0x2bcab7=_0xde545d,_0x5695bd=getClient(_0x497439['id'])[_0x2bcab7(0x102)];_0x497439[_0x2bcab7(0x113)](_0x2bcab7(0x206),config),_0x497439['emit'](_0x2bcab7(0x125),cleanSettings()),_0x497439['on']('add-bot',_0x1e3092=>{const _0x17ee27=_0x2bcab7;if(validateAccess(_0x1e3092,_0x5695bd)[_0x17ee27(0x1ce)])addBot();else logging(_0x17ee27(0x152));}),_0x497439['on'](_0x2bcab7(0x10f),(_0x240a5e,_0x4117ef)=>{const _0x179b37=_0x2bcab7;if(validateAccess(_0x4117ef,_0x5695bd)[_0x179b37(0x1ce)])toggleBot(_0x240a5e[_0x179b37(0x208)],_0x240a5e[_0x179b37(0x158)],_0x240a5e['live']);else logging(_0x179b37(0x1eb));}),_0x497439['on']('delete-bot',(_0x5bbb76,_0x3f272a)=>{const _0x49f481=_0x2bcab7;if(validateAccess(_0x3f272a,_0x5695bd)['allow'])deleteBot(_0x5bbb76);else logging(_0x49f481(0x222));}),_0x497439['on']('store-settings',(_0x3abced,_0x5a5c6b)=>{const _0x1cc0c9=_0x2bcab7;if(validateAccess(_0x5a5c6b,_0x5695bd)['allow'])storeSettings(_0x3abced,!![]);else logging(_0x1cc0c9(0x127));}),_0x497439['on']('logout',_0x414280=>{const _0x2cdbe5=_0x2bcab7;if(validateAccess(_0x414280,_0x5695bd)[_0x2cdbe5(0x1ce)]){if(devices[_0x5695bd][_0x2cdbe5(0x1fd)])clearTimeout(devices[_0x5695bd]['pidRefreshToken']);if(devices[_0x5695bd][_0x2cdbe5(0xef)])clearTimeout(devices[_0x5695bd]['pidExpireLogin']);removeSocketListeners(getClient(_0x497439['id'])[_0x2cdbe5(0x102)]),addBlacklist(_0x5695bd),devices[_0x5695bd][_0x2cdbe5(0xf0)]=null,devices[_0x5695bd][_0x2cdbe5(0x1c0)]=null,devices[_0x5695bd][_0x2cdbe5(0x12a)]['token']=null,io['to'](getClient(_0x497439['id'])[_0x2cdbe5(0x102)])[_0x2cdbe5(0x113)]('status',{'access':{'allow':![],'reason':_0x2cdbe5(0x11a),'token':null}});}else logging(_0x2cdbe5(0x1be));});}function initializeSocketBot(_0x1efeae){const _0x7ed87d=_0xde545d,_0x1d08af=getClient(_0x1efeae['id'])[_0x7ed87d(0xd8)],_0x5d573e=getClient(_0x1efeae['id'])[_0x7ed87d(0x102)];_0x1efeae['on'](_0x7ed87d(0xe3),(_0x228a85,_0x4a9b94)=>{const _0x5178ab=_0x7ed87d;if(validateAccess(_0x4a9b94,_0x5d573e)['allow']){if(pid[_0x1d08af])pid[_0x1d08af]['send']({'function':'emitHistory','args':_0x228a85});}else logging(_0x5178ab(0x14a));}),_0x1efeae['on']('get-portfolio',(_0xc5fd88,_0x5b198c)=>{const _0x194d25=_0x7ed87d;if(validateAccess(_0x5b198c,_0x5d573e)[_0x194d25(0x1ce)]){if(pid[_0x1d08af])pid[_0x1d08af][_0x194d25(0x151)]({'function':_0x194d25(0x17d),'args':_0xc5fd88});}else logging(_0x194d25(0x116));}),_0x1efeae['on'](_0x7ed87d(0x10b),(_0xfc4e82,_0x4b5e12)=>{const _0x304d28=_0x7ed87d;if(validateAccess(_0x4b5e12,_0x5d573e)[_0x304d28(0x1ce)]){if(pid[_0x1d08af])pid[_0x1d08af][_0x304d28(0x151)]({'function':_0x304d28(0x10e),'args':_0xfc4e82});}else logging(_0x304d28(0x20c));}),_0x1efeae['on']('store-headless',(_0x103efe,_0x3377d9)=>{const _0x21e21c=_0x7ed87d;if(validateAccess(_0x3377d9,_0x5d573e)[_0x21e21c(0x1ce)]){if(pid[_0x1d08af])pid[_0x1d08af][_0x21e21c(0x151)]({'function':_0x21e21c(0x1a6),'args':_0x103efe});}else logging(_0x21e21c(0x197));}),_0x1efeae['on'](_0x7ed87d(0x18f),_0x3a8771=>{const _0x1bb34f=_0x7ed87d;if(validateAccess(_0x3a8771,_0x5d573e)[_0x1bb34f(0x1ce)]){if(pid[_0x1d08af])pid[_0x1d08af][_0x1bb34f(0x151)]({'function':_0x1bb34f(0x19b),'args':null});}else logging(_0x1bb34f(0x1c5));}),_0x1efeae['on'](_0x7ed87d(0x220),(_0x51bafc,_0x24457b)=>{const _0x282659=_0x7ed87d;if(validateAccess(_0x24457b,_0x5d573e)[_0x282659(0x1ce)]){if(pid[_0x1d08af])pid[_0x1d08af][_0x282659(0x151)]({'function':_0x282659(0x207),'args':_0x51bafc});}else logging(_0x282659(0x184));}),_0x1efeae['on']('cancel-loading',_0x211708=>{const _0x203afe=_0x7ed87d;if(validateAccess(_0x211708,_0x5d573e)[_0x203afe(0x1ce)]){if(pid[_0x1d08af])pid[_0x1d08af][_0x203afe(0x151)]({'function':_0x203afe(0xe8),'args':null});}else logging(_0x203afe(0x1d2));}),_0x1efeae['on'](_0x7ed87d(0xf2),_0x38344b=>{const _0x354004=_0x7ed87d;if(validateAccess(_0x38344b,_0x5d573e)['allow']){if(devices[_0x5d573e][_0x354004(0x1fd)])clearTimeout(devices[_0x5d573e][_0x354004(0x1fd)]);if(devices[_0x5d573e][_0x354004(0xef)])clearTimeout(devices[_0x5d573e][_0x354004(0xef)]);removeSocketListeners(getClient(_0x1efeae['id'])['uuid']),addBlacklist(_0x5d573e),devices[_0x5d573e][_0x354004(0xf0)]=null,devices[_0x5d573e][_0x354004(0x1c0)]=null,devices[_0x5d573e][_0x354004(0x12a)][_0x354004(0x14e)]=null,io['to'](getClient(_0x1efeae['id'])['uuid'])['emit']('status',{'access':{'allow':![],'reason':_0x354004(0x11a),'token':null}});}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x412c23){getClientsWithUuid(_0x412c23)['forEach'](_0x1e654c=>{getSocket(_0x1e654c['id'])['removeAllListeners']();});}function cleanSettings(){const _0x23cd95=_0xde545d;let _0x40583f=settings;return settings[_0x23cd95(0x1d8)]&&settings[_0x23cd95(0x1d8)]!=''&&(_0x40583f={..._0x40583f,'telegramToken':_0x23cd95(0x1ee)}),settings[_0x23cd95(0x193)]&&settings[_0x23cd95(0x193)]!=''&&(_0x40583f={..._0x40583f,'bbPassword':'************'}),_0x40583f;}function startBot(_0x4c41e8,_0x3a9162,_0x26c001){const _0x555f9f=_0xde545d;let _0x5d6981=![];const _0x2c5dc6=_0x4c41e8[0x0];_0x3a9162={..._0x3a9162,'stdio':['inherit','inherit',_0x555f9f(0x1c9),_0x555f9f(0x1d7)]},pid[_0x2c5dc6]=childProcess['fork'](botfile,_0x4c41e8,_0x3a9162),pid[_0x2c5dc6]['on'](_0x555f9f(0x166),_0x5c9058=>{const _0x21d413=_0x555f9f;switch(Object['keys'](_0x5c9058)[0x0]){case _0x21d413(0x1f6):updateBotName(_0x2c5dc6,_0x5c9058['botname']);break;case _0x21d413(0x158):updateStatus(_0x2c5dc6,_0x5c9058[_0x21d413(0x158)]);break;case _0x21d413(0x181):updateLive(_0x2c5dc6,_0x5c9058[_0x21d413(0x181)]);break;case _0x21d413(0x1e1):updateLive(_0x2c5dc6,_0x5c9058[_0x21d413(0x1e1)]),io['to'](_0x2c5dc6)[_0x21d413(0x113)]('status',{'access':{'allow':![],'reason':_0x21d413(0x1f0),'token':null}});break;case _0x21d413(0x201):_0x5c9058[_0x21d413(0x201)]==_0x21d413(0x165)&&stopBot(_0x2c5dc6);_0x5c9058[_0x21d413(0x201)]==_0x21d413(0x185)&&toggleBot(_0x2c5dc6,'disabled','stopped');break;case _0x21d413(0x105):sendTelegram(_0x2c5dc6,_0x5c9058[_0x21d413(0x105)]);break;case'function':io['to'](_0x2c5dc6)[_0x21d413(0x113)](_0x5c9058[_0x21d413(0x146)],_0x5c9058[_0x21d413(0x1ba)]);break;}}),pid[_0x2c5dc6]['on'](_0x555f9f(0x216),function(_0xcd92aa){if(_0x5d6981)return;_0x5d6981=!![],_0x26c001(_0xcd92aa);}),pid[_0x2c5dc6]['on'](_0x555f9f(0x10c),function(_0x229cec){const _0xe70ae5=_0x555f9f;if(_0x5d6981)return;_0x5d6981=!![],_0x26c001(null);const _0x5030ef=dbConfig[_0xe70ae5(0xea)](_0xe70ae5(0x206))[_0xe70ae5(0x137)]({'botID':_0x2c5dc6})[_0xe70ae5(0x1c8)]();_0x5030ef&&(_0x5030ef[_0xe70ae5(0x158)]=='enabled'||_0x5030ef[_0xe70ae5(0x158)]==_0xe70ae5(0x191))&&(updateLive(_0x2c5dc6,_0xe70ae5(0x221)),logging(_0xe70ae5(0x18a)+_0x2c5dc6),startBot([_0x2c5dc6,userID],{'cwd':bbpath},function(_0x189cb4){if(_0x189cb4)logging(_0x189cb4);}));});}function stopBot(_0x17a9a9){const _0x4a91d1=_0xde545d;getClientsWithBotID(_0x17a9a9)[_0x4a91d1(0x19e)](_0x2e3ac7=>{const _0x76dc28=_0x4a91d1;getSocket(_0x2e3ac7['id'])[_0x76dc28(0xf1)](!![]),removeClient(_0x2e3ac7['id']);});if(pid[_0x17a9a9])pid[_0x17a9a9][_0x4a91d1(0x185)]();}function addBot(){const _0xe62b=_0xde545d;let _0x4aff33;for(let _0x4f650d=0x1;_0x4f650d<0x3e9;_0x4f650d++){_0x4aff33=_0x4f650d[_0xe62b(0x1dd)]()[_0xe62b(0x192)](0x3,'0');let _0xa8e739=config['find'](_0x57af57=>_0x57af57[_0xe62b(0x208)]==_0x4aff33);if(!_0xa8e739)break;}if(_0x4aff33===_0xe62b(0x1dc)){logging(_0xe62b(0x1c2));return;}logging(_0xe62b(0x203)+_0x4aff33),dbConfig[_0xe62b(0xea)](_0xe62b(0x206))[_0xe62b(0x10a)]({'botID':_0x4aff33,'botname':'Bot\x20'+_0x4aff33,'status':_0xe62b(0x191),'live':''})[_0xe62b(0x100)](),startBot([_0x4aff33,userID],{'cwd':bbpath},function(_0x2d5c19){if(_0x2d5c19)logging(_0x2d5c19);}),config=getConfiguration(),io['to']('botmanager')['emit'](_0xe62b(0x206),config);}function deleteBot(_0xb80af3){const _0xb74312=_0xde545d;getClientsWithBotID(_0xb80af3)[_0xb74312(0x19e)](_0x23f0a6=>{const _0x2e547b=_0xb74312;getSocket(_0x23f0a6['id'])[_0x2e547b(0xf1)](!![]),removeClient(_0x23f0a6['id']);}),dbConfig[_0xb74312(0xea)](_0xb74312(0x206))[_0xb74312(0x219)]({'botID':_0xb80af3})[_0xb74312(0x100)](),logging(_0xb74312(0x14b)+_0xb80af3),stopBot(_0xb80af3);try{fs[_0xb74312(0x213)](path[_0xb74312(0x1d5)](configpath,_0xb74312(0x1ef)+_0xb80af3+_0xb74312(0xf8))),fs[_0xb74312(0x213)](path['join'](configpath,_0xb74312(0x1ef)+_0xb80af3+_0xb74312(0x171))),fs[_0xb74312(0x213)](path[_0xb74312(0x1d5)](configpath,_0xb74312(0x1ef)+_0xb80af3+'-performance.json')),fs[_0xb74312(0x213)](path[_0xb74312(0x1d5)](configpath,_0xb74312(0x1ef)+_0xb80af3+_0xb74312(0x1fb)));}catch(_0x7b0732){if(_0x7b0732)logging(_0xb74312(0x13d),_0x7b0732);}config=getConfiguration(),io['to'](_0xb74312(0x1ec))[_0xb74312(0x113)](_0xb74312(0x206),config);}function toggleBot(_0x9bb8c8,_0x33e30c,_0x14b91f){const _0x13a76d=_0xde545d;dbConfig['get'](_0x13a76d(0x206))[_0x13a76d(0x137)]({'botID':_0x9bb8c8})['assign']({'status':_0x33e30c})[_0x13a76d(0x148)]({'live':_0x14b91f})[_0x13a76d(0x100)]();if(_0x33e30c==_0x13a76d(0x182)||_0x33e30c==_0x13a76d(0x191))logging(_0x13a76d(0x13a)+_0x9bb8c8),startBot([_0x9bb8c8,userID],{'cwd':bbpath},function(_0x159bcc){if(_0x159bcc)logging(_0x159bcc);});else(_0x33e30c==_0x13a76d(0x145)||_0x33e30c==_0x13a76d(0x1da))&&(logging(_0x13a76d(0x1a8)+_0x9bb8c8),stopBot(_0x9bb8c8));config=getConfiguration(),io['to'](_0x13a76d(0x1ec))['emit'](_0x13a76d(0x206),config);}function toggleStatus(_0x4a2339){const _0x2f5863=_0xde545d;let _0x2cda44=dbConfig[_0x2f5863(0xea)]('bots')[_0x2f5863(0x137)]({'botID':_0x4a2339})[_0x2f5863(0x1c8)](),_0x26c466;if(_0x2cda44[_0x2f5863(0x158)]===_0x2f5863(0x182))_0x26c466=_0x2f5863(0x145);else{if(_0x2cda44[_0x2f5863(0x158)]===_0x2f5863(0x191))_0x26c466=_0x2f5863(0x1da);else{if(_0x2cda44['status']==='new-disabled')_0x26c466=_0x2f5863(0x191);else{if(_0x2cda44['status']==='disabled')_0x26c466='enabled';}}}return _0x26c466;}function updateStatus(_0x3ebbd4,_0x312445){const _0x3b64a1=_0xde545d;dbConfig[_0x3b64a1(0xea)]('bots')[_0x3b64a1(0x137)]({'botID':_0x3ebbd4})[_0x3b64a1(0x148)]({'status':_0x312445})[_0x3b64a1(0x100)](),config=getConfiguration(),io['to']('botmanager')[_0x3b64a1(0x113)](_0x3b64a1(0x206),config);}function updateLive(_0x519558,_0x23758d){const _0x281dc5=_0xde545d;dbConfig['get'](_0x281dc5(0x206))[_0x281dc5(0x137)]({'botID':_0x519558})[_0x281dc5(0x148)]({'live':_0x23758d})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x281dc5(0x113)](_0x281dc5(0x206),config);}function updateBotName(_0x40c667,_0xfc4b36){const _0x37a4eb=_0xde545d;dbConfig['get'](_0x37a4eb(0x206))[_0x37a4eb(0x137)]({'botID':_0x40c667})[_0x37a4eb(0x148)]({'botname':_0xfc4b36})[_0x37a4eb(0x100)](),config=getConfiguration(),io['to'](_0x37a4eb(0x1ec))[_0x37a4eb(0x113)](_0x37a4eb(0x206),config);}function telegramError(_0x3a193a){const _0x52dcfd=_0xde545d;console['log'](getTimeStamp()+_0x52dcfd(0x1e0));}function validateTelegram(_0x9b0108){const _0x4066ce=_0xde545d;if(_0x9b0108[_0x4066ce(0x141)][_0x4066ce(0x143)]!=settings[_0x4066ce(0x118)]&&'@'+_0x9b0108['from'][_0x4066ce(0x143)]!=settings[_0x4066ce(0x118)])return tgBot[_0x4066ce(0x19d)](_0x9b0108[_0x4066ce(0x17b)]['id'],_0x4066ce(0x1aa),{'parse_mode':'HTML'})[_0x4066ce(0x210)](_0x4ee7bc=>{telegramError(_0x4ee7bc);}),![];return!![];}async function initTelegram(){const _0x2172ba=_0xde545d;if(tgBot)tgBot[_0x2172ba(0x17a)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x5a45d2=_0x2172ba(0x12f);_0x5a45d2+='\x0a',_0x5a45d2+=_0x2172ba(0x156),_0x5a45d2+=_0x2172ba(0x12d),_0x5a45d2+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x5a45d2+=_0x2172ba(0x124),_0x5a45d2+=_0x2172ba(0x1e6),_0x5a45d2+=_0x2172ba(0x1c7),_0x5a45d2+=_0x2172ba(0x110),_0x5a45d2+=_0x2172ba(0x11d);let _0x3ea08f=_0x2172ba(0x1e5);_0x3ea08f+='\x0a',_0x3ea08f+=_0x5a45d2,tgBot[_0x2172ba(0x1a3)](/\/start/,_0x508001=>{const _0x500ebc=_0x2172ba;if(!validateTelegram(_0x508001))return;if(settings[_0x500ebc(0x1e4)]!=_0x508001[_0x500ebc(0x17b)]['id'])updateSetting('telegramChatId',_0x508001[_0x500ebc(0x17b)]['id']);updateSetting(_0x500ebc(0x1f8),!![]),tgBot['sendMessage'](_0x508001[_0x500ebc(0x17b)]['id'],_0x3ea08f)['catch'](_0x2e8947=>{telegramError(_0x2e8947);});}),tgBot['onText'](/\/enable/,_0x2ab0e2=>{const _0x21c146=_0x2172ba;if(!validateTelegram(_0x2ab0e2))return;if(settings[_0x21c146(0x1e4)]!=_0x2ab0e2['chat']['id'])updateSetting('telegramChatId',_0x2ab0e2[_0x21c146(0x17b)]['id']);updateSetting(_0x21c146(0x1f8),!![]),tgBot[_0x21c146(0x19d)](_0x2ab0e2[_0x21c146(0x17b)]['id'],'Notifications\x20enabled')[_0x21c146(0x210)](_0x3edb6a=>{telegramError(_0x3edb6a);});}),tgBot['onText'](/\/config/,async _0x270264=>{const _0x27fe22=_0x2172ba;if(!validateTelegram(_0x270264))return;tgBot['removeListener'](_0x27fe22(0x1a7)),tgBot[_0x27fe22(0x19d)](_0x270264['chat']['id'],_0x27fe22(0x196),{'reply_markup':{'inline_keyboard':[[{'text':_0x27fe22(0x1fe),'callback_data':_0x27fe22(0x177)},{'text':_0x27fe22(0x13b),'callback_data':_0x27fe22(0x16f)},{'text':'All','callback_data':_0x27fe22(0xfa)}]]}})[_0x27fe22(0x210)](_0x3fa984=>{telegramError(_0x3fa984);}),tgBot['on']('callback_query',async _0x25451e=>{const _0x1ca534=_0x27fe22,_0x1b5f69=_0x25451e[_0x1ca534(0x1c1)],_0x1b5714=_0x25451e['message'];tgBot[_0x1ca534(0x21c)](_0x25451e['id'])['then'](async()=>{const _0x605d53=_0x1ca534;_0x1b5f69==_0x605d53(0x177)&&(updateSetting(_0x605d53(0x123),'orders'),updateSetting('telegramEnabled',!![]),await tgBot[_0x605d53(0x19d)](_0x1b5714['chat']['id'],_0x605d53(0x1ff))[_0x605d53(0x210)](_0x53b64f=>{telegramError(_0x53b64f);}));_0x1b5f69==_0x605d53(0x16f)&&(updateSetting(_0x605d53(0x123),_0x605d53(0x16f)),updateSetting(_0x605d53(0x1f8),!![]),await tgBot[_0x605d53(0x19d)](_0x1b5714['chat']['id'],_0x605d53(0xf9))['catch'](_0xa0f905=>{telegramError(_0xa0f905);}));_0x1b5f69==_0x605d53(0xfa)&&(updateSetting('telegramEvents','all'),updateSetting(_0x605d53(0x1f8),!![]),await tgBot[_0x605d53(0x19d)](_0x1b5714[_0x605d53(0x17b)]['id'],_0x605d53(0x1ea))['catch'](_0x37ca6c=>{telegramError(_0x37ca6c);}));if(!settings[_0x605d53(0x1e4)])tgBot[_0x605d53(0x19d)](_0x1b5714[_0x605d53(0x17b)]['id'],_0x605d53(0x218))[_0x605d53(0x210)](_0x546889=>{telegramError(_0x546889);});}),tgBot['removeListener'](_0x1ca534(0x1a7));});}),tgBot['onText'](/\/status/,_0x5e811f=>{const _0x190763=_0x2172ba;if(!validateTelegram(_0x5e811f))return;let _0x35b973=_0x190763(0xe5);config[_0x190763(0x19e)](_0x3b6421=>{const _0x40f3f9=_0x190763;_0x35b973+='Bot\x20'+_0x3b6421[_0x40f3f9(0x208)]+_0x40f3f9(0x11f)+_0x3b6421[_0x40f3f9(0x1f6)]+':\x20'+_0x3b6421[_0x40f3f9(0x158)]+'\x20/\x20'+_0x3b6421[_0x40f3f9(0x181)]+'\x0a';}),_0x35b973+='\x0a',_0x35b973+=_0x190763(0x173),_0x35b973+=!settings['telegramEnabled']?'Notifications\x20disabled\x0a':_0x190763(0x12b),_0x35b973+=settings['telegramEnabled']?settings[_0x190763(0x123)]==_0x190763(0xfa)?_0x190763(0x167):'Notifications\x20types:\x20'+settings[_0x190763(0x123)]+'\x20only\x0a':'',tgBot[_0x190763(0x19d)](_0x5e811f[_0x190763(0x17b)]['id'],_0x35b973,{'parse_mode':_0x190763(0x1b3)})['catch'](_0x389c87=>{telegramError(_0x389c87);});}),tgBot[_0x2172ba(0x1a3)](/\/restart/,_0x437a6a=>{const _0x47a3de=_0x2172ba;if(!validateTelegram(_0x437a6a))return;tgBot[_0x47a3de(0x19a)](_0x47a3de(0x1a7));const _0x55fc49=getEnabledBots();if(_0x55fc49[_0x47a3de(0x1cb)]==0x0)tgBot[_0x47a3de(0x19d)](_0x437a6a[_0x47a3de(0x17b)]['id'],_0x47a3de(0x205))[_0x47a3de(0x210)](_0x56c4cd=>{telegramError(_0x56c4cd);});else{if(_0x55fc49[_0x47a3de(0x1cb)]>0x1)_0x55fc49['push']({'botID':_0x47a3de(0xfa)});let _0x468653=[],_0x25765b=[];const _0x794e8f=_0x55fc49[_0x47a3de(0x1cb)]%0x4==0x0||_0x55fc49['length']%0x4==0x3||_0x55fc49[_0x47a3de(0x1cb)]%0x3==0x1?0x4:0x3;let _0x4ebc29=0x0;_0x55fc49[_0x47a3de(0x19e)]((_0x473dae,_0x5b32a8)=>{const _0x1b480a=_0x47a3de;if(_0x5b32a8%_0x794e8f==0x0)_0x25765b=[];_0x25765b['push']({'text':_0x473dae[_0x1b480a(0x208)]==_0x1b480a(0xfa)?_0x1b480a(0x1cc):_0x1b480a(0x149)+_0x473dae[_0x1b480a(0x208)],'callback_data':_0x473dae[_0x1b480a(0x208)]}),_0x5b32a8%_0x794e8f==0x0&&(_0x468653[_0x4ebc29]=_0x25765b,_0x4ebc29++);}),tgBot[_0x47a3de(0x19d)](_0x437a6a[_0x47a3de(0x17b)]['id'],_0x47a3de(0x190),{'reply_markup':{'inline_keyboard':_0x468653}})[_0x47a3de(0x210)](_0x47d2c3=>{telegramError(_0x47d2c3);}),tgBot['on'](_0x47a3de(0x1a7),async _0x165613=>{const _0x903c79=_0x47a3de,_0xdd1c53=_0x165613['data'],_0x49d029=_0x165613[_0x903c79(0x166)];tgBot[_0x903c79(0x21c)](_0x165613['id'])[_0x903c79(0x198)](async()=>{const _0x22c4c5=_0x903c79;if(_0xdd1c53==_0x22c4c5(0xfa)){if(settings[_0x22c4c5(0x123)]==_0x22c4c5(0x177))tgBot[_0x22c4c5(0x19d)](_0x49d029[_0x22c4c5(0x17b)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20all\x20bots')[_0x22c4c5(0x210)](_0x36deef=>{telegramError(_0x36deef);});config[_0x22c4c5(0x19e)](_0x4eb507=>{const _0x26dbc1=_0x22c4c5;stopBot(_0x4eb507[_0x26dbc1(0x208)]);});}else{if(settings[_0x22c4c5(0x123)]==_0x22c4c5(0x177))tgBot[_0x22c4c5(0x19d)](_0x49d029[_0x22c4c5(0x17b)]['id'],_0x22c4c5(0x15b)+_0xdd1c53)[_0x22c4c5(0x210)](_0x43a404=>{telegramError(_0x43a404);});stopBot(_0xdd1c53);}}),tgBot[_0x903c79(0x19a)]('callback_query');});}}),tgBot[_0x2172ba(0x1a3)](/\/on/,_0x4d4a52=>{const _0x1cf556=_0x2172ba;if(!validateTelegram(_0x4d4a52))return;tgBot[_0x1cf556(0x19a)]('callback_query');const _0x1c989f=getDisabledBots();if(_0x1c989f['length']==0x0)tgBot[_0x1cf556(0x19d)](_0x4d4a52[_0x1cf556(0x17b)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x1cf556(0x210)](_0x1c41a1=>{telegramError(_0x1c41a1);});else{if(_0x1c989f[_0x1cf556(0x1cb)]>0x1)_0x1c989f[_0x1cf556(0x10a)]({'botID':_0x1cf556(0xfa)});let _0x26ae26=[],_0x23cc47=[];const _0x3ae56e=_0x1c989f['length']%0x4==0x0||_0x1c989f[_0x1cf556(0x1cb)]%0x4==0x3||_0x1c989f['length']%0x3==0x1?0x4:0x3;let _0x544f02=0x0;_0x1c989f['forEach']((_0x5dc7e1,_0x50d9bc)=>{const _0x5e5f2b=_0x1cf556;if(_0x50d9bc%_0x3ae56e==0x0)_0x23cc47=[];_0x23cc47[_0x5e5f2b(0x10a)]({'text':_0x5dc7e1['botID']==_0x5e5f2b(0xfa)?_0x5e5f2b(0x1cc):_0x5e5f2b(0x149)+_0x5dc7e1[_0x5e5f2b(0x208)],'callback_data':_0x5dc7e1[_0x5e5f2b(0x208)]}),_0x50d9bc%_0x3ae56e==0x0&&(_0x26ae26[_0x544f02]=_0x23cc47,_0x544f02++);}),tgBot[_0x1cf556(0x19d)](_0x4d4a52['chat']['id'],_0x1cf556(0xf6),{'reply_markup':{'inline_keyboard':_0x26ae26}})[_0x1cf556(0x210)](_0x31214f=>{telegramError(_0x31214f);}),tgBot['on']('callback_query',async _0x1bc949=>{const _0x24ea1e=_0x1cf556,_0x563c8=_0x1bc949[_0x24ea1e(0x1c1)],_0x5b6734=_0x1bc949[_0x24ea1e(0x166)];tgBot[_0x24ea1e(0x21c)](_0x1bc949['id'])[_0x24ea1e(0x198)](async()=>{const _0x56778d=_0x24ea1e;if(_0x563c8=='all'){if(settings[_0x56778d(0x123)]=='orders')tgBot[_0x56778d(0x19d)](_0x5b6734[_0x56778d(0x17b)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')[_0x56778d(0x210)](_0x17909a=>{telegramError(_0x17909a);});_0x1c989f[_0x56778d(0x19e)](_0x59f8a7=>{const _0x496db7=_0x56778d;if(_0x59f8a7[_0x496db7(0x208)]!='all')toggleBot(_0x59f8a7['botID'],toggleStatus(_0x59f8a7[_0x496db7(0x208)]),_0x496db7(0x221));});}else{if(settings[_0x56778d(0x123)]==_0x56778d(0x177))tgBot[_0x56778d(0x19d)](_0x5b6734[_0x56778d(0x17b)]['id'],_0x56778d(0x1b6)+_0x563c8)['catch'](_0x123b7b=>{telegramError(_0x123b7b);});toggleBot(_0x563c8,toggleStatus(_0x563c8),'stopped');}}),tgBot[_0x24ea1e(0x19a)](_0x24ea1e(0x1a7));});}}),tgBot[_0x2172ba(0x1a3)](/\/off/,_0x2d4c87=>{const _0x4b123f=_0x2172ba;if(!validateTelegram(_0x2d4c87))return;tgBot[_0x4b123f(0x19a)]('callback_query');const _0x474c4d=getEnabledBots();if(_0x474c4d[_0x4b123f(0x1cb)]==0x0)tgBot['sendMessage'](_0x2d4c87[_0x4b123f(0x17b)]['id'],_0x4b123f(0x205))[_0x4b123f(0x210)](_0x3d61fc=>{telegramError(_0x3d61fc);});else{if(_0x474c4d[_0x4b123f(0x1cb)]>0x1)_0x474c4d[_0x4b123f(0x10a)]({'botID':_0x4b123f(0xfa)});let _0x4d0e3c=[],_0x1c8fd6=[];const _0x302573=_0x474c4d['length']%0x4==0x0||_0x474c4d[_0x4b123f(0x1cb)]%0x4==0x3||_0x474c4d[_0x4b123f(0x1cb)]%0x3==0x1?0x4:0x3;let _0x4221cc=0x0;_0x474c4d[_0x4b123f(0x19e)]((_0x539be0,_0x42dfb6)=>{const _0x15ee67=_0x4b123f;if(_0x42dfb6%_0x302573==0x0)_0x1c8fd6=[];_0x1c8fd6[_0x15ee67(0x10a)]({'text':_0x539be0[_0x15ee67(0x208)]==_0x15ee67(0xfa)?_0x15ee67(0x1cc):_0x15ee67(0x149)+_0x539be0[_0x15ee67(0x208)],'callback_data':_0x539be0[_0x15ee67(0x208)]}),_0x42dfb6%_0x302573==0x0&&(_0x4d0e3c[_0x4221cc]=_0x1c8fd6,_0x4221cc++);}),tgBot['sendMessage'](_0x2d4c87[_0x4b123f(0x17b)]['id'],_0x4b123f(0x144),{'reply_markup':{'inline_keyboard':_0x4d0e3c}})['catch'](_0x26c916=>{telegramError(_0x26c916);}),tgBot['on']('callback_query',async _0x347eff=>{const _0x14a6df=_0x4b123f,_0x5f1591=_0x347eff['data'],_0x128ca3=_0x347eff[_0x14a6df(0x166)];tgBot[_0x14a6df(0x21c)](_0x347eff['id'])[_0x14a6df(0x198)](async()=>{const _0x32f581=_0x14a6df;if(_0x5f1591==_0x32f581(0xfa)){if(settings[_0x32f581(0x123)]==_0x32f581(0x177))tgBot['sendMessage'](_0x128ca3[_0x32f581(0x17b)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x32f581(0x210)](_0x105eeb=>{telegramError(_0x105eeb);});_0x474c4d[_0x32f581(0x19e)](_0x4f02ed=>{const _0x48e38d=_0x32f581;if(_0x4f02ed[_0x48e38d(0x208)]!=_0x48e38d(0xfa))toggleBot(_0x4f02ed[_0x48e38d(0x208)],toggleStatus(_0x4f02ed[_0x48e38d(0x208)]),_0x48e38d(0x221));});}else{if(settings['telegramEvents']==_0x32f581(0x177))tgBot[_0x32f581(0x19d)](_0x128ca3[_0x32f581(0x17b)]['id'],_0x32f581(0x188)+_0x5f1591)[_0x32f581(0x210)](_0x281168=>{telegramError(_0x281168);});toggleBot(_0x5f1591,toggleStatus(_0x5f1591),_0x32f581(0x221));}}),tgBot[_0x14a6df(0x19a)](_0x14a6df(0x1a7));});}}),tgBot['onText'](/\/disable/,_0x29d790=>{const _0x566917=_0x2172ba;if(!validateTelegram(_0x29d790))return;tgBot[_0x566917(0x19d)](_0x29d790[_0x566917(0x17b)]['id'],_0x566917(0x160))[_0x566917(0x210)](_0x1d8cee=>{telegramError(_0x1d8cee);}),updateSetting('telegramEnabled',![]);}),tgBot[_0x2172ba(0x1a3)](/\/help/,_0x54e602=>{const _0x467ae2=_0x2172ba;if(!validateTelegram(_0x54e602))return;tgBot['sendMessage'](_0x54e602[_0x467ae2(0x17b)]['id'],_0x5a45d2)[_0x467ae2(0x210)](_0x57316b=>{telegramError(_0x57316b);});}),tgBot['on'](_0x2172ba(0x15a),_0x5bab95=>{const _0x228594=_0x2172ba;_0x5bab95[_0x228594(0x1dd)]()[_0x228594(0x1ed)](_0x228594(0x1e8))&&(logging(_0x228594(0x187)),tgBot[_0x228594(0x17a)](),tgBot=null,io['to'](_0x228594(0x1ec))[_0x228594(0x113)](_0x228594(0x1f7),_0x228594(0x187)));}),process[_0x2172ba(0x159)]('SIGINT',()=>{const _0x11daf7=_0x2172ba;if(tgBot)tgBot[_0x11daf7(0x17a)]();process[_0x11daf7(0x10c)](0x1);}),process[_0x2172ba(0x159)]('SIGTERM',()=>{const _0x38dd45=_0x2172ba;if(tgBot)tgBot[_0x38dd45(0x17a)]();process[_0x38dd45(0x10c)](0x1);});}}function disableTelegram(){const _0x657ce0=_0xde545d;tgBot&&(tgBot[_0x657ce0(0x17a)](),tgBot=null);}function sendTelegram(_0x5a14d4,_0x104efe){const _0xa3c4b7=_0xde545d;if(settings[_0xa3c4b7(0x1f8)]){if(settings['telegramEvents']==_0xa3c4b7(0xfa)||(_0x104efe['type']==_0xa3c4b7(0x216)||_0x104efe['type']=='success')&&settings[_0xa3c4b7(0x123)]==_0xa3c4b7(0x16f)||_0x104efe[_0xa3c4b7(0x1ac)]=='order'&&settings[_0xa3c4b7(0x123)]==_0xa3c4b7(0x177)){if(tgBot&&settings[_0xa3c4b7(0x1e4)]){if(_0x104efe[_0xa3c4b7(0x1bb)])tgBot[_0xa3c4b7(0x19d)](settings['telegramChatId'],_0x104efe[_0xa3c4b7(0x1f6)]+'\x20>\x20'+_0x104efe[_0xa3c4b7(0x10d)])[_0xa3c4b7(0x210)](_0x539b46=>{telegramError(_0x539b46);});else tgBot[_0xa3c4b7(0x19d)](settings[_0xa3c4b7(0x1e4)],_0xa3c4b7(0x149)+_0x5a14d4+'\x20>\x20'+_0x104efe[_0xa3c4b7(0x10d)])[_0xa3c4b7(0x210)](_0x2cd151=>{telegramError(_0x2cd151);});}}}}function getDeviceWithIp(_0x32b992){const _0x1b2f91=_0xde545d;return devices[_0x1b2f91(0x137)](_0x3a8cc1=>_0x3a8cc1['ip']===_0x32b992);}function temporaryAccess2FA(_0x1baa60,_0x54a19c){const _0x5e3f0e=_0xde545d;let _0x4c8c63=new Date(),_0x5a5a87=![];if(lastIpApproval){if(_0x4c8c63-lastIpApproval<0x1388)_0x5a5a87=!![];}lastIpApproval=new Date();if(_0x5a5a87)return;tgBot&&settings[_0x5e3f0e(0x1e4)]&&(tgBot[_0x5e3f0e(0x19a)]('callback_query'),tgBot[_0x5e3f0e(0x19d)](settings[_0x5e3f0e(0x1e4)],_0x5e3f0e(0x170)+normalizeIP(_0x54a19c)[_0x5e3f0e(0x11e)]+_0x5e3f0e(0x154),{'parse_mode':_0x5e3f0e(0x1b3),'reply_markup':{'inline_keyboard':[[{'text':_0x5e3f0e(0x209),'callback_data':'5'},{'text':_0x5e3f0e(0x1f4),'callback_data':'15'},{'text':_0x5e3f0e(0x1fc),'callback_data':'30'},{'text':_0x5e3f0e(0x168),'callback_data':_0x5e3f0e(0x168)}]]}})[_0x5e3f0e(0x210)](_0x180e99=>{telegramError(_0x180e99);}),tgBot['on'](_0x5e3f0e(0x1a7),async _0x32cc4b=>{const _0x5b56f9=_0x5e3f0e,_0x4a0202=_0x32cc4b[_0x5b56f9(0x1c1)],_0x352e21=_0x32cc4b['message'];tgBot[_0x5b56f9(0x21c)](_0x32cc4b['id'])[_0x5b56f9(0x198)](async()=>{const _0x51a4a7=_0x5b56f9;devices[_0x1baa60][_0x51a4a7(0xf0)]={'clientip':_0x54a19c,'timestamp':new Date()['getTime'](),'expiry':_0x4a0202},_0x4a0202!=_0x51a4a7(0x168)?(await tgBot[_0x51a4a7(0x19d)](_0x352e21['chat']['id'],_0x51a4a7(0x18b)+_0x4a0202+_0x51a4a7(0x20d),{'parse_mode':_0x51a4a7(0x1b3)})[_0x51a4a7(0x210)](_0x3805d0=>{telegramError(_0x3805d0);}),io['to'](_0x1baa60)[_0x51a4a7(0x113)](_0x51a4a7(0x158),{'access':{'allow':![],'reason':_0x51a4a7(0x1f0),'token':null}})):(await tgBot[_0x51a4a7(0x19d)](_0x352e21[_0x51a4a7(0x17b)]['id'],_0x51a4a7(0x131))[_0x51a4a7(0x210)](_0x44dfb3=>{telegramError(_0x44dfb3);}),io['to'](_0x1baa60)[_0x51a4a7(0x113)]('status',{'access':{'allow':![],'reason':_0x51a4a7(0x157),'token':null}}));}),tgBot[_0x5b56f9(0x19a)](_0x5b56f9(0x1a7));}));}function loginAccess2FA(_0x2fa091,_0x22da1b){const _0x4247c2=_0xde545d;tgBot&&settings['telegramChatId']&&(tgBot[_0x4247c2(0x19a)](_0x4247c2(0x1a7)),tgBot[_0x4247c2(0x19d)](settings[_0x4247c2(0x1e4)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x22da1b)[_0x4247c2(0x11e)]+_0x4247c2(0x154),{'parse_mode':_0x4247c2(0x1b3),'reply_markup':{'inline_keyboard':[[{'text':_0x4247c2(0x183),'callback_data':loginExpiry},{'text':_0x4247c2(0x168),'callback_data':_0x4247c2(0x168)}]]}})[_0x4247c2(0x210)](_0x11b690=>{telegramError(_0x11b690);}),tgBot['on']('callback_query',async _0x5a4355=>{const _0xd9e023=_0x4247c2,_0x4eeab5=_0x5a4355[_0xd9e023(0x1c1)],_0x4cd86f=_0x5a4355[_0xd9e023(0x166)];tgBot[_0xd9e023(0x21c)](_0x5a4355['id'])[_0xd9e023(0x198)](async()=>{const _0x156956=_0xd9e023;devices[_0x2fa091][_0x156956(0x1c0)]={'clientip':_0x22da1b,'timestamp':new Date()[_0x156956(0x150)](),'expiry':_0x4eeab5},_0x4eeab5!='reject'?(await tgBot[_0x156956(0x19d)](_0x4cd86f[_0x156956(0x17b)]['id'],_0x156956(0x153),{'parse_mode':_0x156956(0x1b3)})[_0x156956(0x210)](_0x72ee29=>{telegramError(_0x72ee29);}),io['to'](_0x2fa091)[_0x156956(0x113)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x156956(0x19d)](_0x4cd86f['chat']['id'],_0x156956(0x1de))[_0x156956(0x210)](_0x280269=>{telegramError(_0x280269);}),io['to'](_0x2fa091)[_0x156956(0x113)](_0x156956(0x158),{'access':{'allow':![],'reason':_0x156956(0x195),'token':null}}));}),tgBot[_0xd9e023(0x19a)](_0xd9e023(0x1a7));}));}function getConfiguration(){const _0x3144f8=_0xde545d;return dbConfig[_0x3144f8(0xea)](_0x3144f8(0x206))[_0x3144f8(0x1a4)]('botID')[_0x3144f8(0x1c8)]()||[];}function getEnabledBots(){const _0x3fd27b=_0xde545d;return dbConfig['get'](_0x3fd27b(0x206))['sortBy'](_0x3fd27b(0x208))['filter']({'status':'enabled'})[_0x3fd27b(0x1c8)]()||[];}function getDisabledBots(){const _0x35f88d=_0xde545d;return dbConfig[_0x35f88d(0xea)](_0x35f88d(0x206))[_0x35f88d(0x1a4)](_0x35f88d(0x208))[_0x35f88d(0x103)]({'status':'disabled'})[_0x35f88d(0x1c8)]()||[];}function getSettings(){const _0x1785ad=_0xde545d;return dbSettings['get'](_0x1785ad(0x125))[_0x1785ad(0x1c8)]()||{'timeshift':0x0};}function getSecure(){return dbSecure['get']('secure')['value']()||{};}function getBlacklist(){const _0x32b68a=_0xde545d;return dbSecure[_0x32b68a(0xea)]('blacklist')[_0x32b68a(0x1c8)]()||[];}function broadcastToBots(_0x25a63b,_0x1381d1){const _0x41e1ac=_0xde545d;config[_0x41e1ac(0x19e)](_0x36ac2d=>{const _0x18790a=_0x41e1ac;if(_0x36ac2d[_0x18790a(0x158)]==_0x18790a(0x182)&&_0x36ac2d[_0x18790a(0x181)]==_0x18790a(0x120)){if(pid[_0x36ac2d[_0x18790a(0x208)]])pid[_0x36ac2d[_0x18790a(0x208)]][_0x18790a(0x151)]({[_0x25a63b]:_0x1381d1});}});}function storeSettings(_0x280fc0,_0x2d7260=![]){const _0x467b32=_0xde545d;_0x280fc0={...settings,..._0x280fc0};if(_0x2d7260&&_0x280fc0['bbPassword']!=_0x467b32(0x1ee)&&_0x280fc0[_0x467b32(0x193)]!=''){const _0x492dd3=crypt[_0x467b32(0x1db)](secure['privateKey'],_0x280fc0[_0x467b32(0x193)])[_0x467b32(0x166)][_0x467b32(0x101)]('@')[0x0],_0xfdfc21=bcrypt['hashSync'](_0x492dd3,saltRounds);_0x280fc0={..._0x280fc0,'bbPassword':_0xfdfc21};}if(_0x2d7260&&_0x280fc0[_0x467b32(0x1d8)]!=_0x467b32(0x1ee)&&_0x280fc0['telegramToken']!=''){const _0x4efdff=crypt['decrypt'](secure[_0x467b32(0xe2)],_0x280fc0[_0x467b32(0x1d8)])['message'][_0x467b32(0x101)]('@')[0x0];_0x280fc0={..._0x280fc0,'telegramToken':_0x4efdff};}const _0x150857=_0x280fc0[_0x467b32(0x1d8)]!=_0x467b32(0x1ee)&&_0x280fc0[_0x467b32(0x1d8)]!=settings[_0x467b32(0x1d8)]||_0x280fc0[_0x467b32(0x118)]!=settings[_0x467b32(0x118)],_0x19f9c1=_0x280fc0[_0x467b32(0x1d8)]==''||_0x280fc0[_0x467b32(0x118)]=='';if(_0x150857)_0x280fc0[_0x467b32(0x123)]=_0x467b32(0xfa);for(const [_0x14fb2b,_0x219034]of Object[_0x467b32(0x1b0)](_0x280fc0)){if(_0x14fb2b=='telegramToken'&&_0x219034==_0x467b32(0x1ee)){_0x280fc0[_0x467b32(0x1d8)]=settings['telegramToken'];continue;};if(_0x14fb2b==_0x467b32(0x193)&&_0x219034==_0x467b32(0x1ee)){_0x280fc0[_0x467b32(0x193)]=settings[_0x467b32(0x193)];continue;};dbSettings[_0x467b32(0x1ad)](_0x467b32(0x199)+_0x14fb2b,_0x219034)['write']();}settings=_0x280fc0,io['to'](_0x467b32(0x1ec))['emit'](_0x467b32(0x125),cleanSettings()),broadcastToBots('timeshift',settings[_0x467b32(0x155)]);if(_0x150857&&!_0x19f9c1)initTelegram();if(_0x150857&&_0x19f9c1)disableTelegram();getAllClients()[_0x467b32(0x19e)](_0x56346d=>{const _0x2b42bd=_0x467b32;getSocket(_0x56346d['id'])[_0x2b42bd(0x113)]('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x3d6fa6,_0x2a58e8){const _0x3b2dfd=_0xde545d;dbSettings[_0x3b2dfd(0x1ad)]('settings.'+_0x3d6fa6,_0x2a58e8)[_0x3b2dfd(0x100)](),settings=getSettings(),io['to'](_0x3b2dfd(0x1ec))[_0x3b2dfd(0x113)](_0x3b2dfd(0x125),cleanSettings());}function storeSecure(_0x47f6a1){const _0x1c4e25=_0xde545d;dbSecure[_0x1c4e25(0xea)](_0x1c4e25(0x128))[_0x1c4e25(0x10a)](_0x47f6a1)[_0x1c4e25(0x100)](),secure=_0x47f6a1;}function addBlacklist(_0x467c37){const _0x2fc263=_0xde545d;cleanBlacklist();let _0x191ff9;devices[_0x467c37]['telegramIpApproval']?_0x191ff9=Math[_0x2fc263(0x1f1)](devices[_0x467c37][_0x2fc263(0xf0)]['expiry'],loginExpiry):_0x191ff9=loginExpiry,dbSecure[_0x2fc263(0xea)](_0x2fc263(0x1d3))[_0x2fc263(0x10a)]({'expiry':new Date()['getTime']()+_0x191ff9*0x3c*0x3e8,'token':devices[_0x467c37][_0x2fc263(0x12a)][_0x2fc263(0x14e)]})[_0x2fc263(0x100)](),blacklist=dbSecure[_0x2fc263(0xea)]('blacklist')['value']();}function cleanBlacklist(){const _0x26cf9a=_0xde545d;let _0x5165c0=dbSecure[_0x26cf9a(0xea)]('blacklist')[_0x26cf9a(0xfd)]()[_0x26cf9a(0x1c8)](),_0x3ed774=new Date()['getTime']();_0x5165c0['forEach'](_0x21df4c=>{const _0x2c56aa=_0x26cf9a;_0x21df4c['expiry']<_0x3ed774&&dbSecure[_0x2c56aa(0xea)](_0x2c56aa(0x1d3))['remove']({'expiry':_0x21df4c[_0x2c56aa(0x134)]})[_0x2c56aa(0x100)]();});}function initStates(){const _0x4b83d4=_0xde545d;let _0x51f5cf=getConfiguration();_0x51f5cf[_0x4b83d4(0x19e)](_0x58eb43=>{const _0x4bc888=_0x4b83d4;_0x58eb43[_0x4bc888(0x181)]=_0x4bc888(0x221);}),storeConfiguration(_0x51f5cf);}function _0x3666(_0x46c650,_0x2deb9d){const _0x5654d9=_0x1351();return _0x3666=function(_0x2f02dc,_0x2351cb){_0x2f02dc=_0x2f02dc-0xd8;let _0x135196=_0x5654d9[_0x2f02dc];return _0x135196;},_0x3666(_0x46c650,_0x2deb9d);}function onKeys(){const _0x155264=new RSA();return new Promise(_0x3857b2=>{const _0x4948fd=_0x3666;_0x155264[_0x4948fd(0xe6)]()[_0x4948fd(0x198)](_0x5457ce=>{_0x3857b2(_0x5457ce);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x2c43cc=_0xde545d;let _0x51a6cb=getConfiguration(),_0x3e36bc=![];_0x51a6cb[_0x2c43cc(0x19e)](_0x41bf12=>{const _0x3d89ff=_0x2c43cc;if(_0x41bf12[_0x3d89ff(0x158)]=='running')_0x41bf12[_0x3d89ff(0x158)]=_0x3d89ff(0x182),_0x3e36bc=!![];else _0x41bf12['status']=='stopped'&&(_0x41bf12[_0x3d89ff(0x158)]=_0x3d89ff(0x145),_0x3e36bc=!![]);});if(_0x3e36bc)storeConfiguration(_0x51a6cb);let _0x547661=getSecure();if(!_0x547661[_0x2c43cc(0xe1)]('secret')){let _0x11da5a=await generateKeys();_0x547661[_0x2c43cc(0x1f5)]=_0x11da5a[_0x2c43cc(0x1f5)],_0x547661[_0x2c43cc(0xe2)]=_0x11da5a[_0x2c43cc(0xe2)],_0x547661[_0x2c43cc(0x112)]=crypto[_0x2c43cc(0x21f)](0x20)[_0x2c43cc(0x1dd)](_0x2c43cc(0x1d9));;storeSecure(_0x547661);}let _0x49fb2b=getSettings();_0x3e36bc=![];!_0x49fb2b[_0x2c43cc(0xe1)]('loginRequired')&&(_0x49fb2b[_0x2c43cc(0x142)]=![],_0x49fb2b[_0x2c43cc(0x1d4)]='',_0x49fb2b[_0x2c43cc(0x193)]='',_0x49fb2b[_0x2c43cc(0x138)]=![],_0x3e36bc=!![]);!_0x49fb2b['hasOwnProperty'](_0x2c43cc(0x1cd))&&(_0x49fb2b[_0x2c43cc(0x1cd)]=![],_0x49fb2b['whitelist']=[],_0x49fb2b[_0x2c43cc(0x16c)]=![],_0x3e36bc=!![]);if(!_0x49fb2b[_0x2c43cc(0xe1)](_0x2c43cc(0x1f8))){if(_0x49fb2b['telegramChatId'])_0x49fb2b[_0x2c43cc(0x1f8)]=!![];else _0x49fb2b[_0x2c43cc(0x1f8)]=![];_0x3e36bc=!![];}if(_0x3e36bc)storeSettings(_0x49fb2b);}function storeConfiguration(_0x2cf43a){const _0xd3a305=_0xde545d;dbConfig[_0xd3a305(0xea)](_0xd3a305(0x206))[_0xd3a305(0x219)]()['write'](),dbConfig['get'](_0xd3a305(0x206))[_0xd3a305(0x10a)](..._0x2cf43a)[_0xd3a305(0x100)](),config=_0x2cf43a;}function resetPassword(){const _0x286be4=_0xde545d;tgBot&&settings[_0x286be4(0x1e4)]&&(tgBot['removeListener'](_0x286be4(0x1a7)),tgBot[_0x286be4(0x19d)](settings[_0x286be4(0x1e4)],_0x286be4(0x1ae),{'parse_mode':_0x286be4(0x1b3),'reply_markup':{'inline_keyboard':[[{'text':_0x286be4(0x106),'callback_data':_0x286be4(0x106)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x4382da=>{telegramError(_0x4382da);}),tgBot['on'](_0x286be4(0x1a7),async _0x476c6b=>{const _0x36e306=_0x286be4,_0x24c0d7=_0x476c6b[_0x36e306(0x1c1)],_0x3a63b3=_0x476c6b[_0x36e306(0x166)];tgBot['answerCallbackQuery'](_0x476c6b['id'])[_0x36e306(0x198)](async()=>{const _0x71cd28=_0x36e306;if(_0x24c0d7!='no'){const _0xb1af16=0xf,_0x1ecdc3=_0x71cd28(0x172),_0xba240a=Array[_0x71cd28(0x141)](crypto[_0x71cd28(0x20f)](new Uint32Array(_0xb1af16)))[_0x71cd28(0xe0)](_0x2a5b7b=>_0x1ecdc3[_0x2a5b7b%_0x1ecdc3['length']])[_0x71cd28(0x1d5)](''),_0x18fced=bcrypt[_0x71cd28(0x21a)](_0xba240a,saltRounds);storeSettings({'bbPassword':_0x18fced}),await tgBot[_0x71cd28(0x19d)](_0x3a63b3[_0x71cd28(0x17b)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0xba240a,{'parse_mode':'HTML'})[_0x71cd28(0x210)](_0x184fd0=>{telegramError(_0x184fd0);});}else await tgBot['sendMessage'](_0x3a63b3['chat']['id'],'Password\x20reset\x20rejected')[_0x71cd28(0x210)](_0x3e9459=>{telegramError(_0x3e9459);});}),tgBot[_0x36e306(0x19a)](_0x36e306(0x1a7));}));}function logging(_0x1b8d0a){const _0x259956=_0xde545d;console['log'](getTimeStamp()+_0x259956(0x1a1)+_0x1b8d0a);if(tgBot&&settings[_0x259956(0x1e4)]&&settings[_0x259956(0x123)]!=_0x259956(0x177))tgBot[_0x259956(0x19d)](settings['telegramChatId'],_0x259956(0x1c3)+_0x1b8d0a)[_0x259956(0x210)](_0x14b6fa=>{telegramError(_0x14b6fa);});}function getServerTime(){const _0x1a3bb4=_0xde545d,_0x5eacba=new Date();return _0x5eacba['getFullYear']()+'/'+(_0x5eacba[_0x1a3bb4(0x1e9)]()+0x1)[_0x1a3bb4(0x1dd)]()[_0x1a3bb4(0x192)](0x2,'0')+'/'+_0x5eacba[_0x1a3bb4(0x18e)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x5eacba[_0x1a3bb4(0x115)]()[_0x1a3bb4(0x1dd)]()[_0x1a3bb4(0x192)](0x2,'0')+':'+_0x5eacba['getMinutes']()['toString']()[_0x1a3bb4(0x192)](0x2,'0')+':'+_0x5eacba[_0x1a3bb4(0xdd)]()[_0x1a3bb4(0x1dd)]()[_0x1a3bb4(0x192)](0x2,'0');}function getTimeStamp(){const _0x1c2b8a=_0xde545d,_0xaaa1ec=shiftedTime();return _0xaaa1ec[_0x1c2b8a(0x223)]()+'/'+(_0xaaa1ec[_0x1c2b8a(0x1e9)]()+0x1)[_0x1c2b8a(0x1dd)]()[_0x1c2b8a(0x192)](0x2,'0')+'/'+_0xaaa1ec[_0x1c2b8a(0x18e)]()[_0x1c2b8a(0x1dd)]()[_0x1c2b8a(0x192)](0x2,'0')+'\x20'+_0xaaa1ec[_0x1c2b8a(0x115)]()[_0x1c2b8a(0x1dd)]()[_0x1c2b8a(0x192)](0x2,'0')+':'+_0xaaa1ec['getMinutes']()[_0x1c2b8a(0x1dd)]()[_0x1c2b8a(0x192)](0x2,'0')+':'+_0xaaa1ec[_0x1c2b8a(0xdd)]()[_0x1c2b8a(0x1dd)]()[_0x1c2b8a(0x192)](0x2,'0');}function shiftedTime(){const _0x35e40a=_0xde545d,_0x46954f=new Date();let _0x366f71=_0x46954f;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x366f71=fns['add'](_0x46954f,{'hours':settings[_0x35e40a(0x155)]});return _0x366f71;}function startScheduler(){const _0x38ce17=_0xde545d;let _0x27c392=new Date()[_0x38ce17(0x17f)]();_0x27c392==0x1&&backupConfigFiles();_0x27c392==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x4f95a3=_0xde545d;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x4f95a3(0x19e)](_0x307829=>{const _0x3c6920=_0x4f95a3;if(!_0x307829[_0x3c6920(0xe7)]())fs[_0x3c6920(0x1e7)](configpath+_0x307829[_0x3c6920(0xff)],configbackuppath+_0x307829[_0x3c6920(0xff)]);});}function triggerAnalytics(){const _0x575bb4=_0xde545d;analytics[_0x575bb4(0x21e)]({'title':_0x575bb4(0x15e),'href':_0x575bb4(0x19c),'path':'/v'+serverversion});}function validateCredentials(_0x286d40,_0xcce923){const _0x295919=_0xde545d;if(_0x286d40[_0x295919(0x143)]==settings['bbUsername']&&bcrypt[_0x295919(0x13c)](_0x286d40[_0x295919(0x1ab)],settings[_0x295919(0x193)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x295919(0xfe),'token':null};else{const _0x764f52=generateLoginToken(_0xcce923);return{'allow':!![],'reason':_0x295919(0x13e),'token':_0x764f52};}}else return{'allow':![],'reason':_0x295919(0x1b9),'token':null};}function refreshToken(_0x1ffad4){const _0x1ab941=_0xde545d,_0x1e8f99=generateLoginToken(_0x1ffad4);return{'allow':!![],'reason':_0x1ab941(0x13e),'token':_0x1e8f99};}function validateAccess(_0x4c4071,_0x157b9f){const _0x47849c=_0xde545d;let _0x22683c=devices[_0x157b9f]['ip'],_0x116a3f;const _0x5dc90a=_0x3eb01e=>{const _0x25be70=_0x3666;if(settings[_0x25be70(0x142)]){if(settings[_0x25be70(0x138)]){if(telegram2FaApproved(_0x157b9f)){const _0x4b4562=generateLoginToken(_0x157b9f);return{'allow':!![],'reason':_0x25be70(0x104),'token':_0x4b4562};}else return{'allow':![],'reason':_0x25be70(0x162),'token':null};}else return _0x116a3f=validToken(_0x3eb01e,_0x157b9f),_0x116a3f[_0x25be70(0xe1)](_0x25be70(0x111))?{'allow':!![],'reason':_0x25be70(0x20b),'token':_0x3eb01e}:{'allow':![],'reason':_0x25be70(0x162),'token':null};}else return{'allow':!![],'reason':_0x25be70(0x19f),'token':null};};if(settings['whitelistEnabled']){let _0x555610=[...settings[_0x47849c(0x194)],'::1','::ffff:127.0.0.1','127.0.0.1'];if(_0x555610[_0x47849c(0x1ed)](_0x22683c))return _0x5dc90a(_0x4c4071);else{_0x116a3f=validToken(_0x4c4071,_0x157b9f);if(_0x116a3f[_0x47849c(0xe1)](_0x47849c(0x111)))return _0x5dc90a(_0x4c4071);else{if(telegramIpApproved(_0x157b9f)){const _0x53b1d2=generateToken(_0x157b9f);return _0x116a3f=_0x5dc90a(_0x4c4071),_0x116a3f['allow']?{'allow':!![],'reason':_0x47849c(0x18d),'token':_0x53b1d2}:_0x116a3f;}else return settings[_0x47849c(0x16c)]?{'allow':![],'reason':_0x47849c(0x189),'token':null}:{'allow':![],'reason':_0x47849c(0x16d),'token':null};}}}else return _0x5dc90a(_0x4c4071);}function timelyDecrypt(_0x38fd2f,_0x28944d=!![]){const _0x293cbb=_0xde545d;if(_0x38fd2f)try{const _0x46fbe2=crypt[_0x293cbb(0x1db)](secure[_0x293cbb(0xe2)],_0x38fd2f)[_0x293cbb(0x166)],_0x308cb1=_0x46fbe2[_0x293cbb(0x101)]('@')[0x0],_0x1df63d=_0x46fbe2[_0x293cbb(0x101)]('@')[0x1],_0x57c3f2=new Date()[_0x293cbb(0x150)]();if(_0x28944d){if(_0x57c3f2-_0x1df63d<maxSecretAge*0x3e8)return _0x308cb1;else return![];}else return _0x308cb1;}catch(_0x1cac00){return![];}else return![];}const validToken=(_0x27295b,_0x2f3db1)=>{const _0x4ea1dc=_0xde545d,_0x3ca5ac=devices[_0x2f3db1]['ip'];if(!_0x27295b)return{'error':_0x4ea1dc(0x200)};for(let _0x3e4797 of blacklist){if(_0x3e4797[_0x4ea1dc(0x14e)]==_0x27295b)return{'error':'Token\x20blacklisted'};}let _0x2b004c;try{_0x2b004c=jwt['verify'](_0x27295b,secure[_0x4ea1dc(0x112)]+_0x2f3db1);}catch{return{'error':_0x4ea1dc(0x215)};}if(!_0x2b004c[_0x4ea1dc(0xe1)]('clientip')&&!_0x2b004c[_0x4ea1dc(0xe1)](_0x4ea1dc(0x143))||!_0x2b004c[_0x4ea1dc(0xe1)](_0x4ea1dc(0x13f)))return{'error':_0x4ea1dc(0x14c)};if(!_0x2b004c[_0x4ea1dc(0xe1)](_0x4ea1dc(0x143))&&_0x2b004c['hasOwnProperty']('clientip')){const {clientip:_0x5d190f}=_0x2b004c;return _0x3ca5ac==_0x5d190f?{'success':_0x4ea1dc(0x109)}:{'error':_0x4ea1dc(0x214)};}else{if(_0x2b004c[_0x4ea1dc(0xe1)](_0x4ea1dc(0x143))&&_0x2b004c['hasOwnProperty']('clientip')){const {username:_0x47b956,clientip:_0x21d72c}=_0x2b004c;return settings[_0x4ea1dc(0x1d4)]==_0x47b956&&_0x3ca5ac==_0x21d72c?{'success':_0x4ea1dc(0x109)}:{'error':_0x4ea1dc(0xf3)};}}},generateLoginToken=_0x162bbe=>{const _0x3e0753=_0xde545d;if(_0x162bbe){const _0x182a44=devices[_0x162bbe]['ip'];return jwt[_0x3e0753(0x140)]({'username':settings['bbUsername'],'clientip':_0x182a44},secure[_0x3e0753(0x112)]+_0x162bbe,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x242fc2=>{const _0x4c8348=_0xde545d;if(_0x242fc2){const _0x28f6b4=devices[_0x242fc2]['ip'];return jwt['sign']({'clientip':_0x28f6b4},secure[_0x4c8348(0x112)]+_0x242fc2,{'expiresIn':devices[_0x242fc2][_0x4c8348(0xf0)][_0x4c8348(0x134)]*0x3c});}else return![];},telegramIpApproved=_0x488b6c=>{const _0x4561f9=_0xde545d;let _0x1e8bfe=![];return devices[_0x488b6c][_0x4561f9(0xf0)]&&devices[_0x488b6c][_0x4561f9(0xf0)][_0x4561f9(0x134)]!=_0x4561f9(0x168)&&(_0x1e8bfe=devices[_0x488b6c][_0x4561f9(0xf0)]['clientip']==devices[_0x488b6c]['ip']&&new Date()[_0x4561f9(0x150)]()-devices[_0x488b6c][_0x4561f9(0xf0)][_0x4561f9(0xda)]<devices[_0x488b6c]['telegramIpApproval'][_0x4561f9(0x134)]*0x3c*0x3e8),_0x1e8bfe;},telegram2FaApproved=_0x3cd289=>{const _0x4303c3=_0xde545d;let _0x10cea9=![];return devices[_0x3cd289][_0x4303c3(0x1c0)]&&devices[_0x3cd289][_0x4303c3(0x1c0)]['expiry']!=_0x4303c3(0x168)&&(_0x10cea9=devices[_0x3cd289][_0x4303c3(0x1c0)][_0x4303c3(0x217)]==devices[_0x3cd289]['ip']&&new Date()[_0x4303c3(0x150)]()-devices[_0x3cd289][_0x4303c3(0x1c0)][_0x4303c3(0xda)]<devices[_0x3cd289][_0x4303c3(0x1c0)][_0x4303c3(0x134)]*0x3c*0x3e8),_0x10cea9;},normalizeIP=_0x47ba59=>{const _0x589362=_0xde545d;let _0x2daadb=null,_0xd01f82=null;if(ipaddr[_0x589362(0x202)](_0x47ba59)){const _0x4e0585=ipaddr['parse'](_0x47ba59);_0x4e0585[_0x589362(0x139)]()==='ipv6'?(_0x4e0585[_0x589362(0x179)]()&&(_0x2daadb=_0x4e0585['toIPv4Address']()[_0x589362(0x1dd)]()),_0xd01f82=_0x4e0585[_0x589362(0x1dd)]()):(_0x2daadb=_0x4e0585[_0x589362(0x1dd)](),_0xd01f82=_0x4e0585[_0x589362(0x1bc)]()[_0x589362(0x1dd)]());}return{'show':_0x2daadb?_0x2daadb:_0xd01f82,'store':_0xd01f82};};