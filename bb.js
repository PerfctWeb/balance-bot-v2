const _0x59a230=_0x46f6;(function(_0x3b6964,_0x197a88){const _0x4af1ad=_0x46f6,_0x5228f1=_0x3b6964();while(!![]){try{const _0x3904fc=parseInt(_0x4af1ad(0x226))/0x1*(-parseInt(_0x4af1ad(0x1eb))/0x2)+parseInt(_0x4af1ad(0x235))/0x3+-parseInt(_0x4af1ad(0x1e2))/0x4+-parseInt(_0x4af1ad(0x1aa))/0x5+-parseInt(_0x4af1ad(0x1b0))/0x6+-parseInt(_0x4af1ad(0x1d1))/0x7+parseInt(_0x4af1ad(0x238))/0x8;if(_0x3904fc===_0x197a88)break;else _0x5228f1['push'](_0x5228f1['shift']());}catch(_0x2d4ceb){_0x5228f1['push'](_0x5228f1['shift']());}}}(_0x4552,0x3c82e));const _0x2502e6=function(){let _0x49f6f4=!![];return function(_0x433356,_0x4f19dd){const _0x4097cd=_0x49f6f4?function(){const _0x4f8dd9=_0x46f6;if(_0x4f19dd){const _0x4027d0=_0x4f19dd[_0x4f8dd9(0x12c)](_0x433356,arguments);return _0x4f19dd=null,_0x4027d0;}}:function(){};return _0x49f6f4=![],_0x4097cd;};}(),_0x4dbb0a=_0x2502e6(this,function(){const _0x87b066=_0x46f6;return _0x4dbb0a[_0x87b066(0x229)]()['search']('(((.+)+)+)+$')[_0x87b066(0x229)]()['constructor'](_0x4dbb0a)[_0x87b066(0x130)](_0x87b066(0x20a));});_0x4dbb0a();'use strict';process[_0x59a230(0x202)]['NTBA_FIX_319']=0x1;const childProcess=require('child_process'),FileSync=require(_0x59a230(0x188)),fs=require('fs'),fns=require(_0x59a230(0x1a8)),low=require(_0x59a230(0x15a)),path=require(_0x59a230(0x158)),crypto=require(_0x59a230(0x237)),Crypt=require(_0x59a230(0x1ba))[_0x59a230(0x1ea)],RSA=require('hybrid-crypto-js')[_0x59a230(0x1df)],bcrypt=require(_0x59a230(0x225)),jwt=require(_0x59a230(0x206)),analyticsLib=require(_0x59a230(0x194))['default'],googleAnalytics=require(_0x59a230(0x19d))[_0x59a230(0x1d7)],ipaddr=require(_0x59a230(0x20d));let bbpath=_0x59a230(0x159);const botfile=_0x59a230(0x177),configfile=_0x59a230(0x227),settingsfile=_0x59a230(0x204),securefile='bb-secure.json';!fs[_0x59a230(0x178)](bbpath+botfile)&&(bbpath='');const configpath=bbpath+'config/';!fs[_0x59a230(0x178)](configpath)&&fs[_0x59a230(0x154)](configpath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x59a230(0x218)]({'bots':[]})[_0x59a230(0x1a9)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x59a230(0x218)]({'settings':{'timeshift':0x0}})[_0x59a230(0x1a9)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x59a230(0x1a9)]();let crypt=new Crypt({'md':_0x59a230(0x161),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[],socket=[],serverStatus=[];const serverversion=require('./'+bbpath+_0x59a230(0x1b6))['version'],maxSecretAge=0xa,loginExpiry=0x3c,tokenRefresh=0x5;let lastIpApproval,telegramIpApproval,telegram2FaApproval,accessControl,token,uuid,externalip,pidExpireLogin,pidRefreshToken,pidAnalytics;oneTimeMigration(),cleanBlacklist();const PORT=0xbb8,express=require(_0x59a230(0x1d0)),app=express(),http=require(_0x59a230(0x166))[_0x59a230(0x230)](app);app[_0x59a230(0x1a2)](express[_0x59a230(0x169)](path['join'](__dirname,bbpath,_0x59a230(0x243)))),app[_0x59a230(0x1a2)](express[_0x59a230(0x169)](path[_0x59a230(0x19b)](__dirname,bbpath,_0x59a230(0x1a4)))),app['get']('/',function(_0x285201,_0x2b5af2){const _0x19abf6=_0x59a230;_0x2b5af2[_0x19abf6(0x134)](path[_0x19abf6(0x19b)](__dirname,bbpath,_0x19abf6(0x243),_0x19abf6(0x1c0)));}),app[_0x59a230(0x1f1)](_0x59a230(0x1e0),function(_0x50f4a5,_0x4e7565){const _0x434b1e=_0x59a230;_0x4e7565[_0x434b1e(0x134)](path['join'](__dirname,bbpath,_0x434b1e(0x1a4),'index.html'));}),app[_0x59a230(0x1f1)]('/:bot/portfolio',(_0x264333,_0x7bcf57)=>{const _0x433438=_0x59a230;_0x7bcf57[_0x433438(0x134)](path['join'](__dirname,bbpath,_0x433438(0x1a4),_0x433438(0x1c0)));}),app[_0x59a230(0x1f1)](_0x59a230(0x14d),(_0x4a2757,_0x14664a)=>{const _0xc5493c=_0x59a230;_0x14664a[_0xc5493c(0x134)](path[_0xc5493c(0x19b)](__dirname,bbpath,_0xc5493c(0x1a4),'index.html'));}),app[_0x59a230(0x1f1)](_0x59a230(0x1a3),(_0x4fcdf4,_0x48b4e6)=>{const _0x40f78f=_0x59a230;_0x48b4e6['sendFile'](path[_0x40f78f(0x19b)](__dirname,bbpath,_0x40f78f(0x1a4),_0x40f78f(0x1c0)));}),app['get'](_0x59a230(0x1c6),(_0x4a2db4,_0x53e2dc)=>{const _0x1e7112=_0x59a230;_0x53e2dc[_0x1e7112(0x134)](path[_0x1e7112(0x19b)](__dirname,bbpath,'build',_0x1e7112(0x1c0)));}),app[_0x59a230(0x1f1)]('/:bot/configuration',(_0x140388,_0x468ca0)=>{const _0x210ae4=_0x59a230;_0x468ca0[_0x210ae4(0x134)](path[_0x210ae4(0x19b)](__dirname,bbpath,_0x210ae4(0x1a4),'index.html'));}),app[_0x59a230(0x1f1)](_0x59a230(0x1db),(_0x529722,_0x3af2b9)=>{const _0x2d1d6b=_0x59a230;_0x3af2b9[_0x2d1d6b(0x134)](path[_0x2d1d6b(0x19b)](__dirname,bbpath,_0x2d1d6b(0x1a4),_0x2d1d6b(0x1c0)));}),http['listen'](PORT);const analytics=analyticsLib({'app':_0x59a230(0x1fb),'plugins':[googleAnalytics({'trackingId':_0x59a230(0x201)})]}),TelegramBot=require('node-telegram-bot-api');let tgBot;if(settings[_0x59a230(0x1ec)]&&settings['telegramToken']!=''&&settings['telegramUsername']&&settings[_0x59a230(0x140)]!='')initTelegram();initStates(),startServer(),startSocket(),startAnalytics();function startServer(){const _0x9b201d=_0x59a230;console[_0x9b201d(0x1c4)](''),console[_0x9b201d(0x1c4)](_0x9b201d(0x223)),logging(_0x9b201d(0x150)+PORT),console[_0x9b201d(0x1c4)]('-----------------------------------------------------------------------------------');if(config[_0x9b201d(0x19a)]!=0x0)config[_0x9b201d(0x15c)](_0xfff938=>{const _0x247bfb=_0x9b201d;if(_0xfff938[_0x247bfb(0x1de)]==_0x247bfb(0x13f)||_0xfff938[_0x247bfb(0x1de)]==_0x247bfb(0x17d))logging(_0x247bfb(0x162)+_0xfff938['botID']+'\x20|\x20'+_0xfff938[_0x247bfb(0x1b1)]),startBot([_0xfff938[_0x247bfb(0x224)]],{'cwd':bbpath},function(_0x489307){if(_0x489307)logging(_0x489307);});else(_0xfff938[_0x247bfb(0x1de)]==_0x247bfb(0x12a)||_0xfff938['status']==_0x247bfb(0x1fa))&&logging('idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0xfff938[_0x247bfb(0x224)]+_0x247bfb(0x15d)+_0xfff938[_0x247bfb(0x1b1)]);});else!newBot&&console[_0x9b201d(0x1c4)](_0x9b201d(0x23d));if(newBot)addBot();console[_0x9b201d(0x1c4)](_0x9b201d(0x223)),console[_0x9b201d(0x1c4)]('');}function startSocket(){const _0x5e1dc7=_0x59a230,_0x345709=require(_0x5e1dc7(0x1c9))(http,{});_0x345709['on'](_0x5e1dc7(0x1e8),_0x71b233=>{const _0x1f4285=_0x5e1dc7;let _0x11d563,_0x30623f,_0x464c7e;const _0x4fbe1e=_0x71b233[_0x1f4285(0x16f)][_0x1f4285(0x1ac)][_0x1f4285(0x1c2)],_0x14207d=_0x71b233[_0x1f4285(0x16f)][_0x1f4285(0x17c)][_0x1f4285(0x16c)];if(!_0x14207d)_0x71b233[_0x1f4285(0x156)](_0x1f4285(0x1de),{'publicKey':secure['publicKey']});else{uuid=timelyDecrypt(_0x71b233[_0x1f4285(0x16f)][_0x1f4285(0x17c)][_0x1f4285(0x16c)],![]),_0x30623f=_0x4fbe1e['match'](/bot[0-9]{3}/);if(_0x30623f)_0x464c7e=_0x30623f[0x0]['match'](/[0-9]{3}/);if(_0x464c7e)_0x11d563=_0x464c7e[0x0];else _0x11d563=_0x1f4285(0x23e);if(socket[_0x11d563])socket[_0x11d563][_0x1f4285(0x20f)](!![]);socket[_0x11d563]=_0x71b233,setAccess(_0x11d563);if(accessControl[_0x1f4285(0x22e)]){if(_0x11d563==_0x1f4285(0x23e))initializeSocketBotManager();else initializeSocketBot(_0x11d563);}if(!serverStatus[_0x11d563])serverStatus[_0x11d563]=_0x1f4285(0x23b);socket[_0x11d563]['on']('login',_0x3f8e4a=>{const _0x2bcfab=_0x1f4285,_0x51733c=timelyDecrypt(_0x3f8e4a[_0x2bcfab(0x1cf)]);if(_0x51733c){_0x3f8e4a={'username':_0x3f8e4a['username'],'password':_0x51733c};let _0x2c0c19=validateCredentials(_0x3f8e4a);if(_0x2c0c19[_0x2bcfab(0x22e)]==![]&&_0x2c0c19[_0x2bcfab(0x174)]==_0x2bcfab(0x171))socket[_0x11d563]['emit'](_0x2bcfab(0x1de),{'access':_0x2c0c19}),loginAccess2FA(externalip);else{if(_0x2c0c19['allow']==![]&&_0x2c0c19[_0x2bcfab(0x174)]==_0x2bcfab(0x1c8))socket[_0x11d563][_0x2bcfab(0x156)](_0x2bcfab(0x1de),{'access':_0x2c0c19});else{if(_0x2c0c19[_0x2bcfab(0x22e)]&&_0x2c0c19[_0x2bcfab(0x174)]==_0x2bcfab(0x138)){token=_0x2c0c19[_0x2bcfab(0x15b)];for(let _0x1b0fd4 in socket){if(_0x1b0fd4==_0x2bcfab(0x23e))initializeSocketBotManager();else initializeSocketBot(_0x1b0fd4);socket[_0x1b0fd4][_0x2bcfab(0x156)]('status',{'status':serverStatus[_0x1b0fd4]||_0x2bcfab(0x20b),'serverversion':serverversion,'servertime':getServerTime(),'access':_0x2c0c19,'externalip':externalip,'publicKey':secure[_0x2bcfab(0x198)],'loginNow':![]});}setTokenRefresh(),setSessionTimeout('login');}}}}else logging(_0x2bcfab(0x211));}),socket[_0x11d563]['on'](_0x1f4285(0x1f6),()=>{resetPassword();}),socket[_0x11d563]['on'](_0x1f4285(0x20f),_0xfa9173=>{let _0x511413=[];for(let _0x5f071 in socket){if(_0x5f071!=_0x11d563)_0x511413[_0x5f071]=socket[_0x5f071];}socket=_0x511413;});if(_0x11d563!=_0x1f4285(0x23e)&&config[_0x1f4285(0x1b8)]!=''){if(pid[_0x11d563])pid[_0x11d563][_0x1f4285(0x1bf)]({'function':_0x1f4285(0x221),'args':null});}}});}function _0x4552(){const _0x173a9a=['Unauthorized\x20attempt\x20to\x20update\x20bot','/:bot/performance','inherit','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','expiry','stopped','update-bot','mkdirSync','No\x20bots\x20enabled\x20right\x20now','emit','getPortfolio','path','bb/','lowdb','token','forEach','\x20|\x20','bots','timeshift','filter','sha256','starting\x20bot\x20|\x20Bot\x20','running','success','secure','http','temporary\x20access\x20not\x20allowed','Temporary\x20access\x20rejected','static','onText','SIGINT','encryptedUuid','bbPassword','push','handshake','starting\x20new\x20bot\x20|\x20Bot\x20','2FA\x20login\x20required','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20*','settings.','reason','getTime','getHours','bot.js','existsSync','get-starting-balances','placeMarketOrder','Unauthorized\x20attempt\x20to\x20store\x20configuration','auth','new','Access\x20enabled\x20for\x20','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','order','keys','Invalid\x20authentication\x20token\x20(2)','exp','*\x20?','find','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','https://hodlerhacks.com','lowdb/adapters/FileSync','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Unauthorized\x20attempt\x20to\x20update\x20settings','login','sendMessage','orders','Markdown','removeAllListeners','temporary\x20token\x20generated','disabled\x20Bot\x20','conn','username','analytics','loginRequired','Bot\x20','Invalid\x20authentication\x20token\x20(1)','publicKey','randomBytes','length','join','You\x20can\x20use\x20the\x20following\x20commands:\x0a','@analytics/google-analytics','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20*personal*\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','stopPolling','login\x20not\x20required','timestamp','use','/:bot/coins','build','store-headless','type','storeConfiguration','date-fns','write','264115qOnSaT','data','headers','chat','Notifications\x20enabled','Orders','539430nmYsbt','botname','enabled\x20Bot\x20','alerts','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Ok,\x20will\x20send\x20order\x20notifications\x20only','version.json','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','apiKey','includes','hybrid-crypto-js','add','message','exit','then','send','index.html','storeHeadless','referer','store-configuration','log','5\x20min','/:bot/history','emitHistory','invalid\x20credentials','socket.io','Unauthorized\x20attempt\x20to\x20get\x20logs','blacklist','page','login\x20required','reload','password','express','2345924KhOLeY','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','************','2FA\x20required','value','error','default','answerCallbackQuery','ipc','kill','/:bot/support','1000','remove','status','RSA','/:bot','Notifications\x20types:\x20','1623536dtNCNg','cloneDeep','map','remoteAddress','::ffff:127.0.0.1','Balance\x20Bot\x20Server','connection','Unauthorized\x20attempt\x20to\x20add\x20bot','Crypt','86iHLWGH','telegramToken','SIGTERM','getStartingBalances','Invalid\x20IP\x20address','isIPv4MappedAddress','get','/status\x20-\x20show\x20the\x20status\x20of\x20your\x20bots\x0a','getSeconds','\x20minutes','generateKeyPairAsync','reset-password','bbUsername','add-bot','getMonth','new-disabled','Balance\x20Bot','No\x20authentication\x20token','\x20only\x0a','function','/enable\x20-\x20enable\x20notifications\x0a','randomFillSync','UA-192771731-1','env','2FA\x20login\x20token\x20generated','bb-settings.json','once','jsonwebtoken','Notifications\x20disabled','store','clientip','(((.+)+)+)+$','starting','assign','ipaddr.js','Unauthorized\x20attempt\x20to\x20delete\x20bot','disconnect','\x20>\x20','Unauthorized\x20attempt\x20logging\x20in\x20(timeout)','-results.json','parse','getDate','-events.json','sortBy','callback_query','defaults','unlinkSync','removeListener','f2aRequired','Allow\x20login\x20from\x20IP\x20address\x20*','Bot\x20Mgr\x20>\x20','temporaryAccessAllowed','Password\x20reset\x20rejected','decrypt','initclient','telegramChatId','-----------------------------------------------------------------------------------','botID','bcryptjs','2261fzjCQU','bb-config.json','telegram','toString','show','bot-','telegramEvents','verify','allow','hasOwnProperty','createServer','event','telegramEnabled','error\x20while\x20deleting\x20log\x20files:\x20','Unauthorized\x20attempt\x20to\x20get\x20portfolio','990792kQtdFZ','reject','crypto','7188456aEwFOI','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','settings','connected','Notifications\x20disabled\x0a','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','botmanager','privateKey','\x20/\x20','logged\x20out','Login\x20accepted','build2','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','entries','live','-performance.json','User\x20has\x20been\x20validated','disabled','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','apply','404\x20Not\x20Found','started','30\x20min','search','split','notification','sign','sendFile','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','catch','padStart','login\x20token\x20generated','logout','kind','max','yes','polling_error','secret','enabled','telegramUsername','set','whitelistEnabled','all','deleted\x20Bot\x20','getMinutes',':\x20Bot\x20Mgr\x20>\x20','Invalid\x20Telegram\x20token','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','/help\x20-\x20show\x20avaiable\x20commands\x0a','from','::1'];_0x4552=function(){return _0x173a9a;};return _0x4552();}function setAccess(_0x23ddd1){const _0x24a6a7=_0x59a230;externalip=normalizeIP(socket[_0x23ddd1][_0x24a6a7(0x192)][_0x24a6a7(0x1e5)])[_0x24a6a7(0x208)],accessControl=validateAccess(token),accessControl[_0x24a6a7(0x15b)]&&accessControl[_0x24a6a7(0x174)]==_0x24a6a7(0x190)&&setSessionTimeout('2FA'),accessControl[_0x24a6a7(0x15b)]&&accessControl['reason']==_0x24a6a7(0x203)&&setSessionTimeout(_0x24a6a7(0x18b)),socket[_0x23ddd1]['emit'](_0x24a6a7(0x1de),{'status':serverStatus[_0x23ddd1]||'starting','serverversion':serverversion,'servertime':getServerTime(),'access':accessControl,'externalip':externalip,'publicKey':secure[_0x24a6a7(0x198)],'loginNow':accessControl[_0x24a6a7(0x174)]==_0x24a6a7(0x1cd)||accessControl[_0x24a6a7(0x174)]==_0x24a6a7(0x171)}),accessControl[_0x24a6a7(0x22e)]==![]&&accessControl['reason']=='2FA\x20required'&&temporaryAccess2FA(externalip);}function setSessionTimeout(_0x23b17e){const _0xdddf2c=_0x59a230;let _0x18f882;if(_0x23b17e=='login')_0x18f882=loginExpiry*0x3c*0x3e8;else _0x18f882=telegramIpApproval[_0xdddf2c(0x151)]*0x3c*0x3e8-(new Date()['getTime']()-telegramIpApproval[_0xdddf2c(0x1a1)]);if(pidExpireLogin)clearTimeout(pidExpireLogin);pidExpireLogin=setTimeout(()=>{const _0x18317a=_0xdddf2c;if(pidRefreshToken)clearTimeout(pidRefreshToken);addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null;let _0x4d9cb8=validateAccess(token);if(!(_0x4d9cb8['allow']&&_0x4d9cb8[_0x18317a(0x174)]==_0x18317a(0x1a0)))for(let _0x6dd1c5 in socket){socket[_0x6dd1c5][_0x18317a(0x156)](_0x18317a(0x1de),{'access':{'allow':![],'reason':'access\x20timeout','token':null}});}token=null;},_0x18f882);}function setTokenRefresh(){if(pidRefreshToken)clearTimeout(pidRefreshToken);pidRefreshToken=setTimeout(()=>{const _0x283d5d=_0x46f6;let _0x1c38dd=refreshToken();for(let _0x1b9950 in socket){socket[_0x1b9950][_0x283d5d(0x156)]('status',{'status':serverStatus[_0x1b9950]||_0x283d5d(0x20b),'serverversion':serverversion,'servertime':getServerTime(),'access':_0x1c38dd,'externalip':externalip,'publicKey':secure['publicKey'],'loginNow':![]});}setTokenRefresh();},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(){const _0x205b7a=_0x59a230;socket[_0x205b7a(0x23e)][_0x205b7a(0x156)](_0x205b7a(0x15e),config),socket[_0x205b7a(0x23e)][_0x205b7a(0x156)](_0x205b7a(0x23a),cleanSettings()),socket['botmanager']['on'](_0x205b7a(0x1f8),_0x56a150=>{const _0x444334=_0x205b7a;if(validateAccess(_0x56a150)[_0x444334(0x22e)])addBot();else logging(_0x444334(0x1e9));}),socket[_0x205b7a(0x23e)]['on'](_0x205b7a(0x153),(_0x1793a7,_0x23ba95)=>{const _0x254aad=_0x205b7a;if(validateAccess(_0x23ba95)[_0x254aad(0x22e)])toggleBot(_0x1793a7[_0x254aad(0x224)],_0x1793a7[_0x254aad(0x1de)],_0x1793a7[_0x254aad(0x127)]);else logging(_0x254aad(0x14c));}),socket[_0x205b7a(0x23e)]['on']('delete-bot',(_0x2fc34a,_0x39ac9d)=>{const _0x6ff52e=_0x205b7a;if(validateAccess(_0x39ac9d)[_0x6ff52e(0x22e)])deleteBot(_0x2fc34a);else logging(_0x6ff52e(0x20e));}),socket[_0x205b7a(0x23e)]['on']('store-settings',(_0x2e29d1,_0x48141a)=>{const _0xf249fb=_0x205b7a;if(validateAccess(_0x48141a)[_0xf249fb(0x22e)])storeSettings(_0x2e29d1,!![]);else logging(_0xf249fb(0x18a));}),socket[_0x205b7a(0x23e)]['on'](_0x205b7a(0x139),_0x403540=>{const _0x5a2535=_0x205b7a;if(validateAccess(_0x403540)['allow']){if(pidRefreshToken)clearTimeout(pidRefreshToken);if(pidExpireLogin)clearTimeout(pidExpireLogin);removeSocketListeners(),addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null,token=null;for(let _0x4a5d79 in socket){socket[_0x4a5d79][_0x5a2535(0x156)](_0x5a2535(0x1de),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x8b6e38){const _0x3c92eb=_0x59a230;socket[_0x8b6e38]['on']('get-logs',(_0x42eade,_0x5cc2e5)=>{const _0x310251=_0x46f6;if(validateAccess(_0x5cc2e5)[_0x310251(0x22e)]){if(pid[_0x8b6e38])pid[_0x8b6e38][_0x310251(0x1bf)]({'function':_0x310251(0x1c7),'args':_0x42eade});}else logging(_0x310251(0x1ca));}),socket[_0x8b6e38]['on']('get-portfolio',(_0xbc6a39,_0x256038)=>{const _0x5d1951=_0x46f6;if(validateAccess(_0x256038)['allow']){if(pid[_0x8b6e38])pid[_0x8b6e38][_0x5d1951(0x1bf)]({'function':_0x5d1951(0x157),'args':_0xbc6a39});}else logging(_0x5d1951(0x234));}),socket[_0x8b6e38]['on'](_0x3c92eb(0x1c3),(_0x1cf801,_0x2d0a97)=>{const _0x18207c=_0x3c92eb;if(validateAccess(_0x2d0a97)[_0x18207c(0x22e)]){if(pid[_0x8b6e38])pid[_0x8b6e38]['send']({'function':_0x18207c(0x1a7),'args':_0x1cf801});}else logging(_0x18207c(0x17b));}),socket[_0x8b6e38]['on'](_0x3c92eb(0x1a5),(_0x46f46d,_0x1aaaae)=>{const _0x5be27a=_0x3c92eb;if(validateAccess(_0x1aaaae)[_0x5be27a(0x22e)]){if(pid[_0x8b6e38])pid[_0x8b6e38][_0x5be27a(0x1bf)]({'function':_0x5be27a(0x1c1),'args':_0x46f46d});}else logging(_0x5be27a(0x186));}),socket[_0x8b6e38]['on'](_0x3c92eb(0x179),_0x559c6f=>{const _0x205842=_0x3c92eb;if(validateAccess(_0x559c6f)[_0x205842(0x22e)]){if(pid[_0x8b6e38])pid[_0x8b6e38]['send']({'function':_0x205842(0x1ee),'args':null});}else logging(_0x205842(0x17f));}),socket[_0x8b6e38]['on']('market-order',(_0x5eca1e,_0x41e22d)=>{const _0xed4f37=_0x3c92eb;if(validateAccess(_0x41e22d)[_0xed4f37(0x22e)]){if(pid[_0x8b6e38])pid[_0x8b6e38][_0xed4f37(0x1bf)]({'function':_0xed4f37(0x17a),'args':_0x5eca1e});}else logging(_0xed4f37(0x1d2));}),socket[_0x8b6e38]['on']('logout',_0x45fe78=>{const _0x1fa1b6=_0x3c92eb;if(validateAccess(_0x45fe78)['allow']){if(pidRefreshToken)clearTimeout(pidRefreshToken);if(pidExpireLogin)clearTimeout(pidExpireLogin);removeSocketListeners(),addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null,token=null;for(let _0x575c59 in socket){socket[_0x575c59]['emit'](_0x1fa1b6(0x1de),{'access':{'allow':![],'reason':_0x1fa1b6(0x241),'token':null}});}}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(){const _0x587c0c=_0x59a230;for(let _0xe2a9b3 in socket){socket[_0xe2a9b3][_0x587c0c(0x18f)]();}}function cleanSettings(){const _0x34436c=_0x59a230;let _0x26ba40=settings;return settings['telegramToken']&&settings[_0x34436c(0x1ec)]!=''&&(_0x26ba40={..._0x26ba40,'telegramToken':_0x34436c(0x1d3)}),settings[_0x34436c(0x16d)]&&settings['bbPassword']!=''&&(_0x26ba40={..._0x26ba40,'bbPassword':'************'}),_0x26ba40;}function startBot(_0x1dfaa3,_0x2f5d84,_0x35e3a4){const _0x3173d5=_0x59a230;let _0x3a9c2a=![];const _0x5ee796=_0x1dfaa3[0x0];_0x2f5d84={..._0x2f5d84,'stdio':['inherit',_0x3173d5(0x14e),'inherit',_0x3173d5(0x1d9)]},pid[_0x5ee796]=childProcess['fork'](botfile,_0x1dfaa3,_0x2f5d84),pid[_0x5ee796]['on'](_0x3173d5(0x1bc),_0x355864=>{const _0x124abd=_0x3173d5;switch(Object[_0x124abd(0x181)](_0x355864)[0x0]){case _0x124abd(0x1b1):updateBotName(_0x5ee796,_0x355864[_0x124abd(0x1b1)]);break;case _0x124abd(0x1de):updateStatus(_0x5ee796,_0x355864[_0x124abd(0x1de)]);break;case _0x124abd(0x127):updateLive(_0x5ee796,_0x355864['live']);break;case _0x124abd(0x12e):updateLive(_0x5ee796,_0x355864['started']);if(socket[_0x5ee796])socket[_0x5ee796][_0x124abd(0x156)](_0x124abd(0x1de),{'access':{'allow':![],'reason':_0x124abd(0x1ce),'token':null}});break;case'telegram':sendTelegram(_0x5ee796,_0x355864[_0x124abd(0x228)]);break;case _0x124abd(0x1fe):if(socket[_0x5ee796])socket[_0x5ee796]['emit'](_0x355864[_0x124abd(0x1fe)],_0x355864['args']);break;}}),pid[_0x5ee796]['on'](_0x3173d5(0x1d6),function(_0x210016){if(_0x3a9c2a)return;_0x3a9c2a=!![],_0x35e3a4(_0x210016);}),pid[_0x5ee796]['on'](_0x3173d5(0x1bd),function(_0x27ea16){const _0x278bbd=_0x3173d5;if(_0x3a9c2a)return;_0x3a9c2a=!![],_0x35e3a4(null);const _0x2ff5ef=dbConfig[_0x278bbd(0x1f1)](_0x278bbd(0x15e))[_0x278bbd(0x185)]({'botID':_0x5ee796})[_0x278bbd(0x1d5)]();_0x2ff5ef&&(_0x2ff5ef[_0x278bbd(0x1de)]==_0x278bbd(0x13f)||_0x2ff5ef[_0x278bbd(0x1de)]==_0x278bbd(0x17d))&&(updateLive(_0x5ee796,'stopped'),_0x27ea16!=0x4d&&(logging('restarting\x20Bot\x20'+_0x5ee796),startBot([_0x5ee796],{'cwd':bbpath},function(_0x5673f8){if(_0x5673f8)logging(_0x5673f8);})));});}function stopBot(_0x1a59e4){const _0x3bc2f3=_0x59a230;if(socket[_0x1a59e4])socket[_0x1a59e4]['disconnect'](!![]);if(pid[_0x1a59e4])pid[_0x1a59e4][_0x3bc2f3(0x1da)]();}function addBot(){const _0x1ddac3=_0x59a230;let _0x5936f9;for(let _0x225b13=0x1;_0x225b13<0x3e9;_0x225b13++){_0x5936f9=_0x225b13[_0x1ddac3(0x229)]()[_0x1ddac3(0x137)](0x3,'0');let _0x1d669e=config[_0x1ddac3(0x185)](_0x5ca393=>_0x5ca393[_0x1ddac3(0x224)]==_0x5936f9);if(!_0x1d669e)break;}if(_0x5936f9===_0x1ddac3(0x1dc)){logging(_0x1ddac3(0x1b7));return;}logging(_0x1ddac3(0x170)+_0x5936f9),dbConfig['get']('bots')[_0x1ddac3(0x16e)]({'botID':_0x5936f9,'botname':_0x1ddac3(0x196)+_0x5936f9,'status':_0x1ddac3(0x17d),'live':''})['write'](),startBot([_0x5936f9],{'cwd':bbpath},function(_0x451dab){if(_0x451dab)logging(_0x451dab);}),config=getConfiguration();if(socket['botmanager'])socket[_0x1ddac3(0x23e)][_0x1ddac3(0x156)](_0x1ddac3(0x15e),config);}function deleteBot(_0x528506){const _0x345bfa=_0x59a230;if(socket[_0x528506])socket[_0x528506][_0x345bfa(0x20f)](!![]);dbConfig[_0x345bfa(0x1f1)]('bots')['remove']({'botID':_0x528506})[_0x345bfa(0x1a9)](),logging(_0x345bfa(0x144)+_0x528506),stopBot(_0x528506);try{fs[_0x345bfa(0x219)](path[_0x345bfa(0x19b)](configpath,_0x345bfa(0x22b)+_0x528506+'-config.json')),fs['unlinkSync'](path[_0x345bfa(0x19b)](configpath,_0x345bfa(0x22b)+_0x528506+_0x345bfa(0x215))),fs[_0x345bfa(0x219)](path['join'](configpath,_0x345bfa(0x22b)+_0x528506+_0x345bfa(0x128))),fs[_0x345bfa(0x219)](path[_0x345bfa(0x19b)](configpath,_0x345bfa(0x22b)+_0x528506+_0x345bfa(0x212)));}catch(_0x5e6f66){if(_0x5e6f66)logging(_0x345bfa(0x233),_0x5e6f66);}config=getConfiguration();if(socket[_0x345bfa(0x23e)])socket['botmanager'][_0x345bfa(0x156)]('bots',config);}function toggleBot(_0x31ee1d,_0x666702,_0x31479c){const _0x15c8a3=_0x59a230;dbConfig['get'](_0x15c8a3(0x15e))[_0x15c8a3(0x185)]({'botID':_0x31ee1d})[_0x15c8a3(0x20c)]({'status':_0x666702})['assign']({'live':_0x31479c})['write']();if(_0x666702==_0x15c8a3(0x13f)||_0x666702==_0x15c8a3(0x17d))logging(_0x15c8a3(0x1b2)+_0x31ee1d),startBot([_0x31ee1d],{'cwd':bbpath},function(_0x2cd56f){if(_0x2cd56f)logging(_0x2cd56f);});else(_0x666702==_0x15c8a3(0x12a)||_0x666702==_0x15c8a3(0x1fa))&&(logging(_0x15c8a3(0x191)+_0x31ee1d),stopBot(_0x31ee1d));config=getConfiguration();if(socket['botmanager'])socket[_0x15c8a3(0x23e)][_0x15c8a3(0x156)](_0x15c8a3(0x15e),config);}function updateStatus(_0x542019,_0x37d91f){const _0x51fba9=_0x59a230;dbConfig[_0x51fba9(0x1f1)](_0x51fba9(0x15e))[_0x51fba9(0x185)]({'botID':_0x542019})[_0x51fba9(0x20c)]({'status':_0x37d91f})[_0x51fba9(0x1a9)](),config=getConfiguration();if(socket[_0x51fba9(0x23e)])socket['botmanager'][_0x51fba9(0x156)](_0x51fba9(0x15e),config);}function updateLive(_0x55d188,_0x221e24){const _0x1d9c5f=_0x59a230;dbConfig[_0x1d9c5f(0x1f1)]('bots')[_0x1d9c5f(0x185)]({'botID':_0x55d188})['assign']({'live':_0x221e24})[_0x1d9c5f(0x1a9)](),config=getConfiguration();if(socket[_0x1d9c5f(0x23e)])socket[_0x1d9c5f(0x23e)]['emit'](_0x1d9c5f(0x15e),config);}function updateBotName(_0x3a8705,_0x3d16f1){const _0x3ada0b=_0x59a230;dbConfig['get'](_0x3ada0b(0x15e))[_0x3ada0b(0x185)]({'botID':_0x3a8705})[_0x3ada0b(0x20c)]({'botname':_0x3d16f1})[_0x3ada0b(0x1a9)](),config=getConfiguration();if(socket[_0x3ada0b(0x23e)])socket[_0x3ada0b(0x23e)]['emit']('bots',config);}function telegramError(_0x56b077){const _0x33e0f4=_0x59a230;console[_0x33e0f4(0x1c4)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x5eedad){const _0x23645d=_0x59a230;if(_0x5eedad[_0x23645d(0x14a)][_0x23645d(0x193)]!=settings[_0x23645d(0x140)]&&'@'+_0x5eedad[_0x23645d(0x14a)][_0x23645d(0x193)]!=settings[_0x23645d(0x140)])return tgBot['sendMessage'](_0x5eedad['chat']['id'],_0x23645d(0x19e),{'parse_mode':_0x23645d(0x18e)})['catch'](_0x459c4e=>{telegramError(_0x459c4e);}),![];return!![];}async function initTelegram(){const _0x3b6a66=_0x59a230;if(tgBot)tgBot[_0x3b6a66(0x19f)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x5750ad=_0x3b6a66(0x19c);_0x5750ad+='\x0a',_0x5750ad+=_0x3b6a66(0x1ff),_0x5750ad+='/disable\x20-\x20disable\x20notifications\x0a',_0x5750ad+=_0x3b6a66(0x12b),_0x5750ad+='/restart\x20-\x20restart\x20a\x20bot\x0a',_0x5750ad+=_0x3b6a66(0x1f2),_0x5750ad+=_0x3b6a66(0x149);let _0x2f5064=_0x3b6a66(0x14f);_0x2f5064+='\x0a',_0x2f5064+=_0x5750ad,tgBot[_0x3b6a66(0x16a)](/\/start/,_0x1a294c=>{const _0x375373=_0x3b6a66;if(!validateTelegram(_0x1a294c))return;if(settings[_0x375373(0x222)]!=_0x1a294c['chat']['id'])updateSetting(_0x375373(0x222),_0x1a294c[_0x375373(0x1ad)]['id']);updateSetting(_0x375373(0x232),!![]),tgBot[_0x375373(0x18c)](_0x1a294c[_0x375373(0x1ad)]['id'],_0x2f5064)[_0x375373(0x136)](_0x3b5433=>{telegramError(_0x3b5433);});}),tgBot[_0x3b6a66(0x16a)](/\/enable/,_0x1001ef=>{const _0x572772=_0x3b6a66;if(!validateTelegram(_0x1001ef))return;if(settings[_0x572772(0x222)]!=_0x1001ef[_0x572772(0x1ad)]['id'])updateSetting('telegramChatId',_0x1001ef[_0x572772(0x1ad)]['id']);updateSetting(_0x572772(0x232),!![]),tgBot[_0x572772(0x18c)](_0x1001ef[_0x572772(0x1ad)]['id'],_0x572772(0x1ae))['catch'](_0x29f03a=>{telegramError(_0x29f03a);});}),tgBot['onText'](/\/config/,async _0x274b06=>{const _0x2e98d8=_0x3b6a66;if(!validateTelegram(_0x274b06))return;tgBot[_0x2e98d8(0x21a)](_0x2e98d8(0x217)),tgBot['sendMessage'](_0x274b06[_0x2e98d8(0x1ad)]['id'],_0x2e98d8(0x148),{'reply_markup':{'inline_keyboard':[[{'text':_0x2e98d8(0x1af),'callback_data':_0x2e98d8(0x18d)},{'text':'Alerts','callback_data':_0x2e98d8(0x1b3)},{'text':'All','callback_data':_0x2e98d8(0x143)}]]}})[_0x2e98d8(0x136)](_0x2ced63=>{telegramError(_0x2ced63);}),tgBot['on'](_0x2e98d8(0x217),async _0x403f3c=>{const _0x367cde=_0x2e98d8,_0x2b5852=_0x403f3c[_0x367cde(0x1ab)],_0x472f07=_0x403f3c[_0x367cde(0x1bc)];tgBot[_0x367cde(0x1d8)](_0x403f3c['id'])[_0x367cde(0x1be)](async()=>{const _0x31526b=_0x367cde;_0x2b5852=='orders'&&(updateSetting('telegramEvents',_0x31526b(0x18d)),updateSetting(_0x31526b(0x232),!![]),await tgBot[_0x31526b(0x18c)](_0x472f07[_0x31526b(0x1ad)]['id'],_0x31526b(0x1b5))[_0x31526b(0x136)](_0x3bb35e=>{telegramError(_0x3bb35e);}));_0x2b5852==_0x31526b(0x1b3)&&(updateSetting(_0x31526b(0x22c),_0x31526b(0x1b3)),updateSetting(_0x31526b(0x232),!![]),await tgBot[_0x31526b(0x18c)](_0x472f07['chat']['id'],_0x31526b(0x1b4))['catch'](_0x483899=>{telegramError(_0x483899);}));_0x2b5852==_0x31526b(0x143)&&(updateSetting(_0x31526b(0x22c),_0x31526b(0x143)),updateSetting(_0x31526b(0x232),!![]),await tgBot['sendMessage'](_0x472f07[_0x31526b(0x1ad)]['id'],_0x31526b(0x189))[_0x31526b(0x136)](_0x4736e6=>{telegramError(_0x4736e6);}));if(!settings[_0x31526b(0x222)])tgBot['sendMessage'](_0x472f07[_0x31526b(0x1ad)]['id'],_0x31526b(0x135))[_0x31526b(0x136)](_0x2b0118=>{telegramError(_0x2b0118);});}),tgBot['removeListener'](_0x367cde(0x217));});}),tgBot[_0x3b6a66(0x16a)](/\/status/,_0x3fae70=>{const _0x52f609=_0x3b6a66;if(!validateTelegram(_0x3fae70))return;let _0xf6d90c='*Balance\x20Bot\x20status:*\x0a';config[_0x52f609(0x15c)](_0x4de0f2=>{const _0x19f475=_0x52f609;_0xf6d90c+=_0x19f475(0x196)+_0x4de0f2[_0x19f475(0x224)]+_0x19f475(0x15d)+_0x4de0f2[_0x19f475(0x1b1)]+':\x20'+_0x4de0f2['status']+_0x19f475(0x240)+_0x4de0f2[_0x19f475(0x127)]+'\x0a';}),_0xf6d90c+='\x0a',_0xf6d90c+='*Telegram\x20bot\x20status:\x0a*',_0xf6d90c+=!settings[_0x52f609(0x232)]?_0x52f609(0x23c):'Notifications\x20enabled\x0a',_0xf6d90c+=settings[_0x52f609(0x232)]?settings['telegramEvents']==_0x52f609(0x143)?_0x52f609(0x239):_0x52f609(0x1e1)+settings[_0x52f609(0x22c)]+_0x52f609(0x1fd):'',tgBot[_0x52f609(0x18c)](_0x3fae70[_0x52f609(0x1ad)]['id'],_0xf6d90c,{'parse_mode':'Markdown'})['catch'](_0x5c9746=>{telegramError(_0x5c9746);});}),tgBot[_0x3b6a66(0x16a)](/\/restart/,_0x47c21b=>{const _0x12c318=_0x3b6a66;if(!validateTelegram(_0x47c21b))return;tgBot['removeListener'](_0x12c318(0x217));const _0x431aa7=getEnabledBots();if(_0x431aa7['length']==0x0)tgBot[_0x12c318(0x18c)](_0x47c21b[_0x12c318(0x1ad)]['id'],_0x12c318(0x155))[_0x12c318(0x136)](_0x565d70=>{telegramError(_0x565d70);});else{let _0x922955=[],_0x41f471=[];const _0xf3accc=_0x431aa7[_0x12c318(0x19a)]%0x4==0x0||_0x431aa7['length']%0x4==0x3||_0x431aa7[_0x12c318(0x19a)]%0x3==0x1?0x4:0x3;let _0x4e27c7=0x0;_0x431aa7['forEach']((_0x3101f5,_0x18c089)=>{const _0x2db785=_0x12c318;if(_0x18c089%_0xf3accc==0x0)_0x41f471=[];_0x41f471['push']({'text':'Bot\x20'+_0x3101f5[_0x2db785(0x224)],'callback_data':_0x3101f5[_0x2db785(0x224)]}),_0x18c089%_0xf3accc==0x0&&(_0x922955[_0x4e27c7]=_0x41f471,_0x4e27c7++);}),tgBot[_0x12c318(0x18c)](_0x47c21b[_0x12c318(0x1ad)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x922955}})[_0x12c318(0x136)](_0x3d15fd=>{telegramError(_0x3d15fd);}),tgBot['on'](_0x12c318(0x217),async _0x2916fd=>{const _0x4e6da9=_0x12c318,_0x223e8d=_0x2916fd[_0x4e6da9(0x1ab)],_0x55b95d=_0x2916fd[_0x4e6da9(0x1bc)];tgBot[_0x4e6da9(0x1d8)](_0x2916fd['id'])[_0x4e6da9(0x1be)](async()=>{const _0x4d6259=_0x4e6da9;if(settings[_0x4d6259(0x22c)]==_0x4d6259(0x18d))tgBot[_0x4d6259(0x18c)](_0x55b95d[_0x4d6259(0x1ad)]['id'],_0x4d6259(0x125)+_0x223e8d)[_0x4d6259(0x136)](_0x55bb5d=>{telegramError(_0x55bb5d);});stopBot(_0x223e8d);}),tgBot['removeListener'](_0x4e6da9(0x217));});}}),tgBot[_0x3b6a66(0x16a)](/\/disable/,_0x21c6b5=>{const _0x47d4ca=_0x3b6a66;if(!validateTelegram(_0x21c6b5))return;tgBot[_0x47d4ca(0x18c)](_0x21c6b5['chat']['id'],_0x47d4ca(0x207))[_0x47d4ca(0x136)](_0x63caad=>{telegramError(_0x63caad);}),updateSetting(_0x47d4ca(0x232),![]);}),tgBot['onText'](/\/help/,_0x115e9b=>{const _0x5a7581=_0x3b6a66;if(!validateTelegram(_0x115e9b))return;tgBot[_0x5a7581(0x18c)](_0x115e9b[_0x5a7581(0x1ad)]['id'],_0x5750ad)['catch'](_0xf3c870=>{telegramError(_0xf3c870);});}),tgBot['on'](_0x3b6a66(0x13d),_0x709f89=>{const _0x4dde8b=_0x3b6a66;if(_0x709f89[_0x4dde8b(0x229)]()[_0x4dde8b(0x1b9)](_0x4dde8b(0x12d))){logging(_0x4dde8b(0x147)),tgBot[_0x4dde8b(0x19f)](),tgBot=null;if(socket[_0x4dde8b(0x23e)])socket[_0x4dde8b(0x23e)][_0x4dde8b(0x156)](_0x4dde8b(0x132),_0x4dde8b(0x147));}}),process[_0x3b6a66(0x205)](_0x3b6a66(0x16b),()=>{const _0xb00353=_0x3b6a66;if(tgBot)tgBot[_0xb00353(0x19f)]();process[_0xb00353(0x1bd)](0x1);}),process['once'](_0x3b6a66(0x1ed),()=>{const _0x4712b6=_0x3b6a66;if(tgBot)tgBot[_0x4712b6(0x19f)]();process['exit'](0x1);});}}function disableTelegram(){const _0x5c3416=_0x59a230;tgBot&&(tgBot[_0x5c3416(0x19f)](),tgBot=null);}function sendTelegram(_0x2dacce,_0x5d64fd){const _0x4dcdbf=_0x59a230;if(settings[_0x4dcdbf(0x232)]){if(settings[_0x4dcdbf(0x22c)]==_0x4dcdbf(0x143)||(_0x5d64fd[_0x4dcdbf(0x1a6)]==_0x4dcdbf(0x1d6)||_0x5d64fd['type']==_0x4dcdbf(0x164))&&settings['telegramEvents']==_0x4dcdbf(0x1b3)||_0x5d64fd[_0x4dcdbf(0x1a6)]==_0x4dcdbf(0x180)&&settings[_0x4dcdbf(0x22c)]==_0x4dcdbf(0x18d)){if(tgBot&&settings['telegramChatId'])tgBot[_0x4dcdbf(0x18c)](settings['telegramChatId'],_0x4dcdbf(0x196)+_0x2dacce+_0x4dcdbf(0x210)+_0x5d64fd[_0x4dcdbf(0x231)])['catch'](_0x8cff8b=>{telegramError(_0x8cff8b);});}}}function temporaryAccess2FA(_0x5b53e1){const _0x4ddac7=_0x59a230;let _0x48caaf=new Date(),_0xd006bb=![];if(lastIpApproval){if(_0x48caaf-lastIpApproval<0x1388)_0xd006bb=!![];}lastIpApproval=new Date();if(_0xd006bb)return;tgBot&&settings[_0x4ddac7(0x222)]&&(tgBot['removeListener']('callback_query'),tgBot[_0x4ddac7(0x18c)](settings[_0x4ddac7(0x222)],_0x4ddac7(0x172)+normalizeIP(_0x5b53e1)[_0x4ddac7(0x22a)]+_0x4ddac7(0x184),{'parse_mode':_0x4ddac7(0x18e),'reply_markup':{'inline_keyboard':[[{'text':_0x4ddac7(0x1c5),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x4ddac7(0x12f),'callback_data':'30'},{'text':_0x4ddac7(0x236),'callback_data':_0x4ddac7(0x236)}]]}})[_0x4ddac7(0x136)](_0xc9256e=>{telegramError(_0xc9256e);}),tgBot['on'](_0x4ddac7(0x217),async _0x4867d7=>{const _0x3724d4=_0x4ddac7,_0x3b3aad=_0x4867d7[_0x3724d4(0x1ab)],_0x1eabc7=_0x4867d7[_0x3724d4(0x1bc)];tgBot[_0x3724d4(0x1d8)](_0x4867d7['id'])[_0x3724d4(0x1be)](async()=>{const _0x2b3761=_0x3724d4;if(_0x3b3aad!='reject'){telegramIpApproval={'clientip':_0x5b53e1,'timestamp':new Date()['getTime'](),'expiry':_0x3b3aad},await tgBot[_0x2b3761(0x18c)](_0x1eabc7[_0x2b3761(0x1ad)]['id'],_0x2b3761(0x17e)+_0x3b3aad+_0x2b3761(0x1f4),{'parse_mode':_0x2b3761(0x18e)})[_0x2b3761(0x136)](_0x547a60=>{telegramError(_0x547a60);});for(let _0x519373 in socket){socket[_0x519373][_0x2b3761(0x156)](_0x2b3761(0x1de),{'access':{'allow':![],'reason':'reload','token':null}});}}else await tgBot['sendMessage'](_0x1eabc7[_0x2b3761(0x1ad)]['id'],_0x2b3761(0x168))[_0x2b3761(0x136)](_0x2d9dc8=>{telegramError(_0x2d9dc8);});}),tgBot[_0x3724d4(0x21a)](_0x3724d4(0x217));}));}function loginAccess2FA(_0xe85f3e){const _0x10858e=_0x59a230;tgBot&&settings['telegramChatId']&&(tgBot[_0x10858e(0x21a)](_0x10858e(0x217)),tgBot[_0x10858e(0x18c)](settings['telegramChatId'],_0x10858e(0x21c)+normalizeIP(_0xe85f3e)[_0x10858e(0x22a)]+_0x10858e(0x184),{'parse_mode':_0x10858e(0x18e),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x10858e(0x236),'callback_data':'reject'}]]}})['catch'](_0x1c45f8=>{telegramError(_0x1c45f8);}),tgBot['on'](_0x10858e(0x217),async _0x34abc5=>{const _0x2b27ee=_0x10858e,_0x1c58b1=_0x34abc5[_0x2b27ee(0x1ab)],_0x18cd6b=_0x34abc5['message'];tgBot['answerCallbackQuery'](_0x34abc5['id'])[_0x2b27ee(0x1be)](async()=>{const _0x3fab97=_0x2b27ee;if(_0x1c58b1!=_0x3fab97(0x236)){telegram2FaApproval={'clientip':_0xe85f3e,'timestamp':new Date()['getTime'](),'expiry':_0x1c58b1},await tgBot[_0x3fab97(0x18c)](_0x18cd6b[_0x3fab97(0x1ad)]['id'],_0x3fab97(0x242),{'parse_mode':_0x3fab97(0x18e)})[_0x3fab97(0x136)](_0x368ce9=>{telegramError(_0x368ce9);});for(let _0x71d57f in socket){socket[_0x71d57f][_0x3fab97(0x156)]('status',{'access':{'allow':![],'reason':_0x3fab97(0x1ce),'token':null}});}}else await tgBot[_0x3fab97(0x18c)](_0x18cd6b[_0x3fab97(0x1ad)]['id'],'Login\x20rejected')[_0x3fab97(0x136)](_0xf1d7f1=>{telegramError(_0xf1d7f1);});}),tgBot[_0x2b27ee(0x21a)]('callback_query');}));}function getConfiguration(){const _0x11fbe1=_0x59a230;return dbConfig[_0x11fbe1(0x1f1)](_0x11fbe1(0x15e))[_0x11fbe1(0x216)](_0x11fbe1(0x224))[_0x11fbe1(0x1d5)]()||[];}function getEnabledBots(){const _0x262c38=_0x59a230;return dbConfig[_0x262c38(0x1f1)](_0x262c38(0x15e))[_0x262c38(0x216)]('botID')[_0x262c38(0x160)]({'status':_0x262c38(0x13f)})[_0x262c38(0x1d5)]()||[];}function _0x46f6(_0x248ebf,_0x40309a){const _0x4dbc2c=_0x4552();return _0x46f6=function(_0x4dbb0a,_0x2502e6){_0x4dbb0a=_0x4dbb0a-0x125;let _0x455237=_0x4dbc2c[_0x4dbb0a];return _0x455237;},_0x46f6(_0x248ebf,_0x40309a);}function getSettings(){const _0x3c1242=_0x59a230;return dbSettings['get'](_0x3c1242(0x23a))[_0x3c1242(0x1d5)]()||{'timeshift':0x0};}function getSecure(){const _0x3c8d7f=_0x59a230;return dbSecure[_0x3c8d7f(0x1f1)](_0x3c8d7f(0x165))[_0x3c8d7f(0x1d5)]()||{};}function getBlacklist(){const _0x2d5302=_0x59a230;return dbSecure['get']('blacklist')[_0x2d5302(0x1d5)]()||[];}function broadcastToBots(_0x2db54c,_0x50262b){const _0x5eab1f=_0x59a230;config[_0x5eab1f(0x15c)](_0x5fe4f0=>{const _0x45c443=_0x5eab1f;if(_0x5fe4f0['status']==_0x45c443(0x13f)&&_0x5fe4f0[_0x45c443(0x127)]=='running'){if(pid[_0x5fe4f0[_0x45c443(0x224)]])pid[_0x5fe4f0[_0x45c443(0x224)]][_0x45c443(0x1bf)]({[_0x2db54c]:_0x50262b});}});}function storeSettings(_0x37ded6,_0x5b68cf=![]){const _0x175f3e=_0x59a230;_0x37ded6={...settings,..._0x37ded6};if(_0x5b68cf&&_0x37ded6[_0x175f3e(0x16d)]!=_0x175f3e(0x1d3)&&_0x37ded6[_0x175f3e(0x16d)]!=''){const _0x5b3192=crypt[_0x175f3e(0x220)](secure[_0x175f3e(0x23f)],_0x37ded6['bbPassword'])[_0x175f3e(0x1bc)][_0x175f3e(0x131)]('@')[0x0],_0x409d57=bcrypt['hashSync'](_0x5b3192,saltRounds);_0x37ded6={..._0x37ded6,'bbPassword':_0x409d57};}if(_0x5b68cf&&_0x37ded6['telegramToken']!='************'&&_0x37ded6[_0x175f3e(0x1ec)]!=''){const _0x5bfc47=crypt[_0x175f3e(0x220)](secure[_0x175f3e(0x23f)],_0x37ded6[_0x175f3e(0x1ec)])[_0x175f3e(0x1bc)][_0x175f3e(0x131)]('@')[0x0];_0x37ded6={..._0x37ded6,'telegramToken':_0x5bfc47};}const _0x41e06f=_0x37ded6['telegramToken']!=_0x175f3e(0x1d3)&&_0x37ded6['telegramToken']!=settings[_0x175f3e(0x1ec)]||_0x37ded6[_0x175f3e(0x140)]!=settings[_0x175f3e(0x140)],_0x19196a=_0x37ded6['telegramToken']==''||_0x37ded6[_0x175f3e(0x140)]=='';if(_0x41e06f)_0x37ded6[_0x175f3e(0x22c)]=_0x175f3e(0x143);for(const [_0x5837c2,_0x566192]of Object[_0x175f3e(0x126)](_0x37ded6)){if(_0x5837c2==_0x175f3e(0x1ec)&&_0x566192=='************'){_0x37ded6[_0x175f3e(0x1ec)]=settings['telegramToken'];continue;};if(_0x5837c2==_0x175f3e(0x16d)&&_0x566192=='************'){_0x37ded6[_0x175f3e(0x16d)]=settings[_0x175f3e(0x16d)];continue;};dbSettings[_0x175f3e(0x141)](_0x175f3e(0x173)+_0x5837c2,_0x566192)[_0x175f3e(0x1a9)]();}settings=_0x37ded6;if(socket[_0x175f3e(0x23e)])socket[_0x175f3e(0x23e)][_0x175f3e(0x156)](_0x175f3e(0x23a),cleanSettings());broadcastToBots('timeshift',settings[_0x175f3e(0x15f)]);if(_0x41e06f&&!_0x19196a)initTelegram();if(_0x41e06f&&_0x19196a)disableTelegram();for(let _0xfba214 in socket){setAccess(_0xfba214);}}function updateSetting(_0x3c3f9d,_0x228a72){const _0xf8dbd8=_0x59a230;dbSettings[_0xf8dbd8(0x141)]('settings.'+_0x3c3f9d,_0x228a72)[_0xf8dbd8(0x1a9)](),settings=getSettings();if(socket['botmanager'])socket['botmanager'][_0xf8dbd8(0x156)](_0xf8dbd8(0x23a),cleanSettings());}function storeSecure(_0x20b7d1){const _0x404e43=_0x59a230;dbSecure['get']('secure')[_0x404e43(0x16e)](_0x20b7d1)[_0x404e43(0x1a9)](),secure=_0x20b7d1;}function addBlacklist(){const _0x33948d=_0x59a230;cleanBlacklist();let _0x1a659;telegramIpApproval?_0x1a659=Math[_0x33948d(0x13b)](telegramIpApproval[_0x33948d(0x151)],loginExpiry):_0x1a659=loginExpiry,dbSecure[_0x33948d(0x1f1)]('blacklist')[_0x33948d(0x16e)]({'expiry':new Date()[_0x33948d(0x175)]()+_0x1a659*0x3c*0x3e8,'token':token})[_0x33948d(0x1a9)](),blacklist=dbSecure[_0x33948d(0x1f1)]('blacklist')[_0x33948d(0x1d5)]();}function cleanBlacklist(){const _0x51cb26=_0x59a230;let _0xed2013=dbSecure[_0x51cb26(0x1f1)](_0x51cb26(0x1cb))[_0x51cb26(0x1e3)]()[_0x51cb26(0x1d5)](),_0x38892f=new Date()['getTime']();_0xed2013['forEach'](_0x38e841=>{const _0x459443=_0x51cb26;_0x38e841[_0x459443(0x151)]<_0x38892f&&dbSecure['get'](_0x459443(0x1cb))[_0x459443(0x1dd)]({'expiry':_0x38e841[_0x459443(0x151)]})['write']();});}function initStates(){let _0x4db035=getConfiguration();_0x4db035['forEach'](_0x50bbaa=>{const _0x3d339d=_0x46f6;_0x50bbaa['live']=_0x3d339d(0x152);}),storeConfiguration(_0x4db035);}function onKeys(){const _0x5e5208=new RSA();return new Promise(_0x54084b=>{const _0xb1b2b1=_0x46f6;_0x5e5208[_0xb1b2b1(0x1f5)]()[_0xb1b2b1(0x1be)](_0x41e36e=>{_0x54084b(_0x41e36e);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x17be2b=_0x59a230;let _0x5e8396=getConfiguration(),_0x279ea2=![];_0x5e8396['forEach'](_0x5dafb5=>{const _0x4f4b77=_0x46f6;if(_0x5dafb5[_0x4f4b77(0x1de)]==_0x4f4b77(0x163))_0x5dafb5[_0x4f4b77(0x1de)]=_0x4f4b77(0x13f),_0x279ea2=!![];else _0x5dafb5[_0x4f4b77(0x1de)]==_0x4f4b77(0x152)&&(_0x5dafb5[_0x4f4b77(0x1de)]='disabled',_0x279ea2=!![]);});if(_0x279ea2)storeConfiguration(_0x5e8396);let _0xf5ac82=getSecure();if(!_0xf5ac82[_0x17be2b(0x22f)](_0x17be2b(0x13e))){let _0x17ebd7=await generateKeys();_0xf5ac82[_0x17be2b(0x198)]=_0x17ebd7[_0x17be2b(0x198)],_0xf5ac82[_0x17be2b(0x23f)]=_0x17ebd7[_0x17be2b(0x23f)],_0xf5ac82[_0x17be2b(0x13e)]=crypto[_0x17be2b(0x199)](0x20)[_0x17be2b(0x229)]('hex');;storeSecure(_0xf5ac82);}let _0x9ce2ac=getSettings();_0x279ea2=![];!_0x9ce2ac[_0x17be2b(0x22f)](_0x17be2b(0x195))&&(_0x9ce2ac[_0x17be2b(0x195)]=![],_0x9ce2ac['bbUsername']='',_0x9ce2ac[_0x17be2b(0x16d)]='',_0x9ce2ac[_0x17be2b(0x21b)]=![],_0x279ea2=!![]);!_0x9ce2ac['hasOwnProperty'](_0x17be2b(0x142))&&(_0x9ce2ac[_0x17be2b(0x142)]=![],_0x9ce2ac['whitelist']=[],_0x9ce2ac[_0x17be2b(0x21e)]=![],_0x279ea2=!![]);if(!_0x9ce2ac[_0x17be2b(0x22f)]('telegramEnabled')){if(_0x9ce2ac[_0x17be2b(0x222)])_0x9ce2ac[_0x17be2b(0x232)]=!![];else _0x9ce2ac[_0x17be2b(0x232)]=![];_0x279ea2=!![];}if(_0x279ea2)storeSettings(_0x9ce2ac);}function storeConfiguration(_0x2fe48f){const _0x5f04da=_0x59a230;dbConfig[_0x5f04da(0x1f1)](_0x5f04da(0x15e))['remove']()[_0x5f04da(0x1a9)](),dbConfig['get'](_0x5f04da(0x15e))[_0x5f04da(0x16e)](..._0x2fe48f)['write'](),config=_0x2fe48f;}function resetPassword(){const _0x3a6625=_0x59a230;tgBot&&settings[_0x3a6625(0x222)]&&(tgBot[_0x3a6625(0x21a)](_0x3a6625(0x217)),tgBot[_0x3a6625(0x18c)](settings['telegramChatId'],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',{'parse_mode':_0x3a6625(0x18e),'reply_markup':{'inline_keyboard':[[{'text':_0x3a6625(0x13c),'callback_data':_0x3a6625(0x13c)},{'text':'no','callback_data':'no'}]]}})[_0x3a6625(0x136)](_0x2d11d5=>{telegramError(_0x2d11d5);}),tgBot['on'](_0x3a6625(0x217),async _0x4df40c=>{const _0x278dcb=_0x3a6625,_0xcc6663=_0x4df40c[_0x278dcb(0x1ab)],_0x201a79=_0x4df40c[_0x278dcb(0x1bc)];tgBot['answerCallbackQuery'](_0x4df40c['id'])[_0x278dcb(0x1be)](async()=>{const _0x468681=_0x278dcb;if(_0xcc6663!='no'){const _0x277292=0xf,_0x44c12a='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x1bcfa5=Array[_0x468681(0x14a)](crypto[_0x468681(0x200)](new Uint32Array(_0x277292)))[_0x468681(0x1e4)](_0xbc9994=>_0x44c12a[_0xbc9994%_0x44c12a[_0x468681(0x19a)]])['join'](''),_0x2f8d54=bcrypt['hashSync'](_0x1bcfa5,saltRounds);storeSettings({'bbPassword':_0x2f8d54}),await tgBot['sendMessage'](_0x201a79[_0x468681(0x1ad)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x1bcfa5,{'parse_mode':_0x468681(0x18e)})[_0x468681(0x136)](_0x2ce054=>{telegramError(_0x2ce054);});}else await tgBot[_0x468681(0x18c)](_0x201a79[_0x468681(0x1ad)]['id'],_0x468681(0x21f))['catch'](_0x42bf28=>{telegramError(_0x42bf28);});}),tgBot[_0x278dcb(0x21a)](_0x278dcb(0x217));}));}function logging(_0x53bbe1){const _0x28aefb=_0x59a230;console[_0x28aefb(0x1c4)](getTimeStamp()+_0x28aefb(0x146)+_0x53bbe1);if(tgBot&&settings[_0x28aefb(0x222)]&&settings[_0x28aefb(0x22c)]!='orders')tgBot['sendMessage'](settings[_0x28aefb(0x222)],_0x28aefb(0x21d)+_0x53bbe1)[_0x28aefb(0x136)](_0x11ec15=>{telegramError(_0x11ec15);});}function getServerTime(){const _0x535e20=_0x59a230,_0x53a7cc=new Date();return _0x53a7cc['getFullYear']()+'/'+(_0x53a7cc[_0x535e20(0x1f9)]()+0x1)[_0x535e20(0x229)]()[_0x535e20(0x137)](0x2,'0')+'/'+_0x53a7cc[_0x535e20(0x214)]()[_0x535e20(0x229)]()[_0x535e20(0x137)](0x2,'0')+'\x20'+_0x53a7cc[_0x535e20(0x176)]()[_0x535e20(0x229)]()[_0x535e20(0x137)](0x2,'0')+':'+_0x53a7cc[_0x535e20(0x145)]()[_0x535e20(0x229)]()[_0x535e20(0x137)](0x2,'0')+':'+_0x53a7cc[_0x535e20(0x1f3)]()[_0x535e20(0x229)]()[_0x535e20(0x137)](0x2,'0');}function getTimeStamp(){const _0x3956dc=_0x59a230,_0x4a17cf=shiftedTime();return _0x4a17cf['getFullYear']()+'/'+(_0x4a17cf[_0x3956dc(0x1f9)]()+0x1)['toString']()[_0x3956dc(0x137)](0x2,'0')+'/'+_0x4a17cf[_0x3956dc(0x214)]()['toString']()[_0x3956dc(0x137)](0x2,'0')+'\x20'+_0x4a17cf[_0x3956dc(0x176)]()[_0x3956dc(0x229)]()[_0x3956dc(0x137)](0x2,'0')+':'+_0x4a17cf[_0x3956dc(0x145)]()[_0x3956dc(0x229)]()[_0x3956dc(0x137)](0x2,'0')+':'+_0x4a17cf[_0x3956dc(0x1f3)]()[_0x3956dc(0x229)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x5796b8=_0x59a230,_0x41a8ed=new Date();let _0x4c01d6=_0x41a8ed;if(settings[_0x5796b8(0x15f)]&&settings['timeshift']!==0x0)_0x4c01d6=fns[_0x5796b8(0x1bb)](_0x41a8ed,{'hours':settings['timeshift']});return _0x4c01d6;}function startAnalytics(){let _0x2fab4d=new Date()['getUTCHours']();_0x2fab4d==0x9&&triggerAnalytics();if(pidAnalytics)clearTimeout(pidAnalytics);pidAnalytics=setTimeout(()=>{startAnalytics();},0x3c*0x3c*0x3e8);}function triggerAnalytics(){const _0x297cf8=_0x59a230;analytics[_0x297cf8(0x1cc)]({'title':_0x297cf8(0x1e7),'href':_0x297cf8(0x187),'path':'/v'+serverversion});}function validateCredentials(_0x48b639){const _0x112afb=_0x59a230;if(_0x48b639[_0x112afb(0x193)]==settings[_0x112afb(0x1f7)]&&bcrypt['compareSync'](_0x48b639[_0x112afb(0x1cf)],settings[_0x112afb(0x16d)])){if(settings[_0x112afb(0x21b)])return{'allow':![],'reason':_0x112afb(0x171),'token':null};else{const _0x521dca=generateLoginToken();return{'allow':!![],'reason':_0x112afb(0x138),'token':_0x521dca};}}else return{'allow':![],'reason':_0x112afb(0x1c8),'token':null};}function refreshToken(){const _0x4d195e=_0x59a230,_0x28dcb2=generateLoginToken();return{'allow':!![],'reason':_0x4d195e(0x138),'token':_0x28dcb2};}function validateAccess(_0x4d7765){const _0x2bd093=_0x59a230;let _0xac9262;const _0x5a20ea=_0x3c79ed=>{const _0x10abb3=_0x46f6;if(settings[_0x10abb3(0x195)]){if(settings[_0x10abb3(0x21b)]){if(telegram2FaApproved()){const _0x26255a=generateLoginToken();return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x26255a};}else return{'allow':![],'reason':_0x10abb3(0x171),'token':null};}else return _0xac9262=validToken(_0x3c79ed),_0xac9262[_0x10abb3(0x22f)]('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x3c79ed}:{'allow':![],'reason':_0x10abb3(0x1cd),'token':null};}else return{'allow':!![],'reason':_0x10abb3(0x1a0),'token':null};};if(settings[_0x2bd093(0x142)]){let _0x4e340b=[...settings['whitelist'],_0x2bd093(0x14b),_0x2bd093(0x1e6),'127.0.0.1'];if(_0x4e340b[_0x2bd093(0x1b9)](externalip))return _0x5a20ea(_0x4d7765);else{_0xac9262=validToken(_0x4d7765);if(_0xac9262[_0x2bd093(0x22f)](_0x2bd093(0x164)))return _0x5a20ea(_0x4d7765);else{if(telegramIpApproved()){const _0x24bf87=generateToken();return _0xac9262=_0x5a20ea(_0x4d7765),_0xac9262[_0x2bd093(0x22e)]?{'allow':!![],'reason':_0x2bd093(0x190),'token':_0x24bf87}:_0xac9262;}else return settings[_0x2bd093(0x21e)]?{'allow':![],'reason':_0x2bd093(0x1d4),'token':null}:{'allow':![],'reason':_0x2bd093(0x167),'token':null};}}}else return _0x5a20ea(_0x4d7765);}function timelyDecrypt(_0x3eab71,_0x1d20f0=!![]){const _0x22fca8=_0x59a230;if(_0x3eab71)try{const _0x1680cf=crypt[_0x22fca8(0x220)](secure[_0x22fca8(0x23f)],_0x3eab71)[_0x22fca8(0x1bc)],_0x5defc0=_0x1680cf[_0x22fca8(0x131)]('@')[0x0],_0x44ba62=_0x1680cf['split']('@')[0x1],_0x580acf=new Date()[_0x22fca8(0x175)]();if(_0x1d20f0){if(_0x580acf-_0x44ba62<maxSecretAge*0x3e8)return _0x5defc0;else return![];}else return _0x5defc0;}catch{return![];}else return![];}const validToken=_0x193d1b=>{const _0x4904b1=_0x59a230;if(!_0x193d1b)return{'error':_0x4904b1(0x1fc)};for(let _0x3b93ca of blacklist){if(_0x3b93ca[_0x4904b1(0x15b)]==_0x193d1b)return{'error':'Token\x20blacklisted'};}let _0x969159;try{_0x969159=jwt[_0x4904b1(0x22d)](_0x193d1b,secure[_0x4904b1(0x13e)]+uuid);}catch{return{'error':_0x4904b1(0x197)};}if(!_0x969159[_0x4904b1(0x22f)]('clientip')&&!_0x969159[_0x4904b1(0x22f)](_0x4904b1(0x193))||!_0x969159[_0x4904b1(0x22f)](_0x4904b1(0x183)))return{'error':_0x4904b1(0x182)};if(!_0x969159[_0x4904b1(0x22f)](_0x4904b1(0x193))&&_0x969159[_0x4904b1(0x22f)](_0x4904b1(0x209))){const {clientip:_0x131844}=_0x969159;return externalip==_0x131844?{'success':_0x4904b1(0x129)}:{'error':_0x4904b1(0x1ef)};}else{if(_0x969159[_0x4904b1(0x22f)](_0x4904b1(0x193))&&_0x969159['hasOwnProperty'](_0x4904b1(0x209))){const {username:_0x2d8a55,clientip:_0x411372}=_0x969159;return settings[_0x4904b1(0x1f7)]==_0x2d8a55&&externalip==_0x411372?{'success':_0x4904b1(0x129)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=()=>{const _0x990224=_0x59a230;if(uuid)return jwt['sign']({'username':settings[_0x990224(0x1f7)],'clientip':externalip},secure[_0x990224(0x13e)]+uuid,{'expiresIn':tokenRefresh*0x3c});else return![];},generateToken=()=>{const _0x3dc567=_0x59a230;if(uuid)return jwt[_0x3dc567(0x133)]({'clientip':externalip},secure[_0x3dc567(0x13e)]+uuid,{'expiresIn':telegramIpApproval[_0x3dc567(0x151)]*0x3c});else return![];},telegramIpApproved=()=>{const _0x2cd06a=_0x59a230;let _0x5c2113=![];return telegramIpApproval&&telegramIpApproval['expiry']!=_0x2cd06a(0x236)&&(_0x5c2113=telegramIpApproval[_0x2cd06a(0x209)]==externalip&&new Date()[_0x2cd06a(0x175)]()-telegramIpApproval[_0x2cd06a(0x1a1)]<telegramIpApproval['expiry']*0x3c*0x3e8),_0x5c2113;},telegram2FaApproved=()=>{const _0x9d838f=_0x59a230;let _0x57e977=![];return telegram2FaApproval&&telegram2FaApproval['expiry']!='reject'&&(_0x57e977=telegram2FaApproval['clientip']==externalip&&new Date()[_0x9d838f(0x175)]()-telegram2FaApproval[_0x9d838f(0x1a1)]<telegram2FaApproval[_0x9d838f(0x151)]*0x3c*0x3e8),_0x57e977;},normalizeIP=_0x2612c7=>{const _0x209a2b=_0x59a230;let _0x2fbe7d=null,_0x478762=null;if(ipaddr['isValid'](_0x2612c7)){const _0x184001=ipaddr[_0x209a2b(0x213)](_0x2612c7);_0x184001[_0x209a2b(0x13a)]()==='ipv6'?(_0x184001[_0x209a2b(0x1f0)]()&&(_0x2fbe7d=_0x184001['toIPv4Address']()[_0x209a2b(0x229)]()),_0x478762=_0x184001[_0x209a2b(0x229)]()):(_0x2fbe7d=_0x184001[_0x209a2b(0x229)](),_0x478762=_0x184001['toIPv4MappedAddress']()[_0x209a2b(0x229)]());}return{'show':_0x2fbe7d?_0x2fbe7d:_0x478762,'store':_0x478762};};