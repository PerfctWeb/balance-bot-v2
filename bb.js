const _0xe6cde4=_0x5958;(function(_0x41d291,_0x52ee65){const _0x48f2d7=_0x5958,_0x126b6c=_0x41d291();while(!![]){try{const _0x26a323=-parseInt(_0x48f2d7(0x218))/0x1*(-parseInt(_0x48f2d7(0x27d))/0x2)+-parseInt(_0x48f2d7(0x196))/0x3*(parseInt(_0x48f2d7(0x1cd))/0x4)+parseInt(_0x48f2d7(0x1ac))/0x5*(parseInt(_0x48f2d7(0x2a4))/0x6)+-parseInt(_0x48f2d7(0x223))/0x7*(parseInt(_0x48f2d7(0x187))/0x8)+-parseInt(_0x48f2d7(0x213))/0x9+parseInt(_0x48f2d7(0x1e1))/0xa+parseInt(_0x48f2d7(0x202))/0xb*(-parseInt(_0x48f2d7(0x264))/0xc);if(_0x26a323===_0x52ee65)break;else _0x126b6c['push'](_0x126b6c['shift']());}catch(_0x5cc1b4){_0x126b6c['push'](_0x126b6c['shift']());}}}(_0x2a01,0xa27ff));const _0x229791=function(){let _0x3820ff=!![];return function(_0x5bdbde,_0x5d0dd5){const _0x1a1749=_0x3820ff?function(){const _0x52f83f=_0x5958;if(_0x5d0dd5){const _0x11705e=_0x5d0dd5[_0x52f83f(0x21c)](_0x5bdbde,arguments);return _0x5d0dd5=null,_0x11705e;}}:function(){};return _0x3820ff=![],_0x1a1749;};}(),_0x489be9=_0x229791(this,function(){const _0x234211=_0x5958;return _0x489be9[_0x234211(0x284)]()['search'](_0x234211(0x1b6))['toString']()[_0x234211(0x26e)](_0x489be9)[_0x234211(0x1d5)](_0x234211(0x1b6));});_0x489be9();'use strict';process[_0xe6cde4(0x274)][_0xe6cde4(0x1c9)]=0x1;const childProcess=require(_0xe6cde4(0x1cf)),FileSync=require('lowdb/adapters/FileSync'),fs=require('fs'),fns=require(_0xe6cde4(0x244)),low=require(_0xe6cde4(0x24d)),path=require(_0xe6cde4(0x1cc)),crypto=require(_0xe6cde4(0x1a9)),Crypt=require('hybrid-crypto-js')['Crypt'],RSA=require(_0xe6cde4(0x211))[_0xe6cde4(0x275)],bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),analyticsLib=require('analytics')[_0xe6cde4(0x257)],googleAnalytics=require(_0xe6cde4(0x285))[_0xe6cde4(0x257)],ipaddr=require(_0xe6cde4(0x197)),PORT=process[_0xe6cde4(0x1eb)][0x2]||_0xe6cde4(0x254),pattern=/^[0-9]{2,4}$/;if(!pattern[_0xe6cde4(0x239)](PORT))return console['log'](_0xe6cde4(0x262)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0xe6cde4(0x1c3)](0x1);const userID=process[_0xe6cde4(0x1eb)][0x3]||'';let bbpath='bb/';const botfile='bot.js',configfile=_0xe6cde4(0x2a0),settingsfile=_0xe6cde4(0x17d),securefile=_0xe6cde4(0x1c7);!fs[_0xe6cde4(0x243)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath+_0xe6cde4(0x1c2)),configpath=userID?bbpath+_0xe6cde4(0x29e)+userID+'/':bbpath+_0xe6cde4(0x29e),configbackuppath=configpath+'backup/';!fs[_0xe6cde4(0x243)](configpath)&&fs[_0xe6cde4(0x292)](configpath);!fs[_0xe6cde4(0x243)](configbackuppath)&&fs[_0xe6cde4(0x292)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0xe6cde4(0x261)]({'bots':[]})[_0xe6cde4(0x23a)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0xe6cde4(0x261)]({'settings':{'timeshift':0x0}})[_0xe6cde4(0x23a)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0xe6cde4(0x23a)]();let crypt=new Crypt({'md':_0xe6cde4(0x1db),'rsaStandard':'RSA-OAEP'});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath+'version.json')[_0xe6cde4(0x1bd)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require(_0xe6cde4(0x296)),app=express(),http=require(_0xe6cde4(0x248))['createServer'](app);app['use'](express[_0xe6cde4(0x232)](path[_0xe6cde4(0x1b1)](__dirname,bbpath,_0xe6cde4(0x177)))),app['use'](express['static'](path[_0xe6cde4(0x1b1)](__dirname,bbpath,'build'))),app['get']('/',function(_0x38b7a9,_0x107361){const _0x687716=_0xe6cde4;_0x107361[_0x687716(0x273)](path[_0x687716(0x1b1)](__dirname,bbpath,_0x687716(0x177),'index.html'));}),app[_0xe6cde4(0x2a6)](_0xe6cde4(0x22f),function(_0x3931ed,_0x163236){const _0x190f89=_0xe6cde4;_0x163236[_0x190f89(0x273)](path[_0x190f89(0x1b1)](__dirname,bbpath,_0x190f89(0x21e),_0x190f89(0x229)));}),app[_0xe6cde4(0x2a6)](_0xe6cde4(0x1f7),(_0x2ab68d,_0x800fa0)=>{const _0x1a981d=_0xe6cde4;_0x800fa0[_0x1a981d(0x273)](path[_0x1a981d(0x1b1)](__dirname,bbpath,'build',_0x1a981d(0x229)));}),app[_0xe6cde4(0x2a6)](_0xe6cde4(0x225),(_0x478848,_0x9bc50f)=>{const _0x21dc8a=_0xe6cde4;_0x9bc50f[_0x21dc8a(0x273)](path[_0x21dc8a(0x1b1)](__dirname,bbpath,_0x21dc8a(0x21e),_0x21dc8a(0x229)));}),app[_0xe6cde4(0x2a6)]('/:bot/coins',(_0x15b4fd,_0x53cccb)=>{const _0x3f2839=_0xe6cde4;_0x53cccb[_0x3f2839(0x273)](path[_0x3f2839(0x1b1)](__dirname,bbpath,_0x3f2839(0x21e),_0x3f2839(0x229)));}),app[_0xe6cde4(0x2a6)]('/:bot/history',(_0x5bf7ea,_0x52055b)=>{const _0x5dfbb4=_0xe6cde4;_0x52055b[_0x5dfbb4(0x273)](path[_0x5dfbb4(0x1b1)](__dirname,bbpath,_0x5dfbb4(0x21e),_0x5dfbb4(0x229)));}),app[_0xe6cde4(0x2a6)](_0xe6cde4(0x1a6),(_0x1a21f3,_0x5506bd)=>{const _0x26c2c6=_0xe6cde4;_0x5506bd[_0x26c2c6(0x273)](path[_0x26c2c6(0x1b1)](__dirname,bbpath,_0x26c2c6(0x21e),_0x26c2c6(0x229)));}),app[_0xe6cde4(0x2a6)](_0xe6cde4(0x1ee),(_0x5d3229,_0x48b371)=>{const _0x228dbc=_0xe6cde4;_0x48b371[_0x228dbc(0x273)](path[_0x228dbc(0x1b1)](__dirname,bbpath,_0x228dbc(0x21e),'index.html'));}),http['listen'](PORT);const io=require(_0xe6cde4(0x1f9))(http,{}),analytics=analyticsLib({'app':_0xe6cde4(0x2aa),'plugins':[googleAnalytics({'trackingId':_0xe6cde4(0x242)})]}),TelegramBot=require('node-telegram-bot-api');function _0x2a01(){const _0x24f343=['connected','getTime','disconnect','accept','telegramChatId','inherit','\x20|\x20','1994518SRXGZH','Invalid\x20IP\x20address','telegramToken','isDirectory','2FA\x20login\x20rejected','stopPolling','invalid\x20credentials','toString','@analytics/google-analytics','padStart','new','toIPv4Address','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','15\x20min','send','::1','SIGINT','temporary\x20token\x20generated','length','logout','User\x20has\x20been\x20validated','mkdirSync','verify','-events.json','handshake','express','getPortfolio','emit','2FA\x20login\x20required','disabled','function','Notifications\x20disabled','privateKey','config/','error','bb-config.json','orders','timestamp','2FA\x20required','750FkBbVO','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','get','loginRequired','botmanager','hashSync','Balance\x20Bot','bbUsername','uuid','sortBy','entries','filter','Invalid\x20username\x20or\x20IP\x20address','assign','includes','build2','telegramEnabled','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','/disable\x20-\x20disable\x20notifications\x0a','then','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','bb-settings.json','readdirSync','Unauthorized\x20attempt\x20to\x20update\x20settings','started','sendMessage','restarting\x20Bot\x20','alerts','::ffff:127.0.0.1','bot-','reset-password','286656PHajXl','referer','whitelist','Login\x20rejected','getSeconds','restart','publicKey','set','2FA','from','error\x20while\x20deleting\x20config\x20files:\x20','pidRefreshToken','temporaryAccessAllowed','get-logs','cloneDeep','1530231PiigvP','ipaddr.js','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','temporary\x20access\x20not\x20allowed','Unauthorized\x20attempt\x20to\x20log\x20out','all','login\x20not\x20required','success','removeListener','temporary\x20access\x20timeout','30\x20min','settings.','parse','login\x20token\x20generated','getUTCHours','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','/:bot/configuration','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','placeOrder','crypto','blacklist','stopped','9425dpjqRT','telegramEvents','once','server','reload','join','remove','starting\x20new\x20bot\x20|\x20Bot\x20','/on\x20-\x20start\x20bot(s)\x0a','No\x20bots\x20running\x20right\x20now','(((.+)+)+)+$','Temporary\x20access\x20rejected','reason','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','HTML','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Ok,\x20will\x20send\x20alert\x20notifications\x20only','version','-results.json','starting\x20bot\x20|\x20Bot\x20','telegramUsername','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','clients','exit','delete-bot','answerCallbackQuery','fork','bb-secure.json','value','NTBA_FIX_319','telegramIpApproval','\x20>\x20','path','4OdwaEY','enabled\x20Bot\x20','child_process','access','onText','decrypt','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','telegram','search','name','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Invalid\x20Telegram\x20token','Notifications\x20disabled\x0a','get-starting-balances','sha256','All','yes','chat','emitHistory','secret','9577190WZiGQZ','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','logged\x20out','place-order','max','Token\x20blacklisted','5\x20min','\x20only\x0a','Password\x20reset\x20rejected','f2aRequired','argv','Unauthorized\x20attempt\x20to\x20get\x20logs','Alerts','/:bot/support','callback_query','order','-performance.json','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','pidExpireLogin','randomBytes','allow','cancelLoading','/:bot/portfolio','get-portfolio','socket.io','clientip','find','botID','page','secure','All\x20bots','add',':\x20Bot\x20Mgr\x20>\x20','7699307VWOKJR','map','getMinutes','botname','token','Notifications\x20enabled\x0a','Unauthorized\x20attempt\x20to\x20get\x20portfolio','bots','ipv6','getHours','username','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','telegram2FaApproval','getDate','Bot\x20','hybrid-crypto-js','getStartingBalances','2189934qotDYi','getFullYear','enabled','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','update-bot','1rbrWqu','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','connection','compareSync','apply','initclient','build','getMonth','login','event','exp','14nzZZXX','login\x20token\x20valid','/:bot/performance','temporary\x20access\x20rejected','status','hasOwnProperty','index.html','/help\x20-\x20show\x20available\x20commands\x0a','https://hodlerhacks.com','127.0.0.1','password','whitelistEnabled','/:bot','2FA\x20login\x20token\x20generated','running','static','/off\x20-\x20stop\x20bot(s)\x0a','Orders','catch','type','<b>Balance\x20Bot\x20status:</b>\x0a','Ok,\x20will\x20send\x20order\x20notifications\x20only','test','write','removeAllListeners','show','push','SIGTERM','message','reject','live','UA-192771731-1','existsSync','date-fns','showname','settings','split','http','forEach','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','store-headless','sign','lowdb','-----------------------------------------------------------------------------------','sockets','You\x20can\x20use\x20the\x20following\x20commands:\x0a','keys','login\x20required','notification','3000','data','stop','default','/enable\x20-\x20enable\x20notifications\x0a','log','Unauthorized\x20login\x20attempt\x20(timeout)','randomFillSync','kill','</b>\x20?','Notifications\x20types:\x20','Balance\x20Bot\x20Server','Invalid\x20authentication\x20token\x20(2)','defaults','Error:\x20Invalid\x20argument\x20','match','12QtXMCJ','cancel-loading','unlinkSync','************','404\x20Not\x20Found','new-disabled','Unauthorized\x20attempt\x20to\x20delete\x20bot','kind','Unauthorized\x20attempt\x20to\x20add\x20bot','bot','constructor','Access\x20enabled\x20for\x20','timeshift','bbPassword','expiry','sendFile','env','RSA'];_0x2a01=function(){return _0x24f343;};return _0x2a01();}let tgBot;if(settings[_0xe6cde4(0x27f)]&&settings[_0xe6cde4(0x27f)]!=''&&settings[_0xe6cde4(0x1c0)]&&settings['telegramUsername']!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x596e33=_0xe6cde4;console['log'](''),console[_0x596e33(0x259)](_0x596e33(0x24e)),logging('Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:'+PORT),console[_0x596e33(0x259)](_0x596e33(0x24e));if(config[_0x596e33(0x28f)]!=0x0)config['forEach'](_0x107c0a=>{const _0x4217a6=_0x596e33;if(_0x107c0a[_0x4217a6(0x227)]==_0x4217a6(0x215)||_0x107c0a[_0x4217a6(0x227)]==_0x4217a6(0x287))logging(_0x4217a6(0x1bf)+_0x107c0a[_0x4217a6(0x1fc)]+_0x4217a6(0x27c)+_0x107c0a['botname']),startBot([_0x107c0a[_0x4217a6(0x1fc)],userID],{'cwd':bbpath},function(_0x39d424){if(_0x39d424)logging(_0x39d424);});else(_0x107c0a[_0x4217a6(0x227)]==_0x4217a6(0x29a)||_0x107c0a['status']==_0x4217a6(0x269))&&logging('idling\x20bot\x20\x20\x20|\x20Bot\x20'+_0x107c0a['botID']+_0x4217a6(0x27c)+_0x107c0a['botname']);});else!newBot&&console[_0x596e33(0x259)](_0x596e33(0x289));if(newBot)addBot();console['log'](_0x596e33(0x24e)),console['log']('');}function startSocket(){const _0x43f10e=_0xe6cde4;io['on'](_0x43f10e(0x21a),_0x145a8e=>{const _0x4d405b=_0x43f10e;let _0x59873b,_0x42ad1a,_0x89d5ec,_0x4d9d60,_0x8b20a2;const _0x18c838=_0x145a8e[_0x4d405b(0x295)]['headers'][_0x4d405b(0x188)];_0x42ad1a=_0x18c838[_0x4d405b(0x263)](/bot[0-9]{3}/);if(_0x42ad1a)_0x89d5ec=_0x42ad1a[0x0][_0x4d405b(0x263)](/[0-9]{3}/);if(_0x89d5ec)_0x59873b=_0x89d5ec[0x0];else _0x59873b=_0x4d405b(0x2a8);const _0x5bbde7=_0x145a8e[_0x4d405b(0x295)]['auth']['encryptedUuid'];if(!_0x5bbde7)_0x145a8e[_0x4d405b(0x298)](_0x4d405b(0x227),{'publicKey':secure[_0x4d405b(0x18d)]});else{_0x4d9d60=timelyDecrypt(_0x5bbde7,![]);if(!_0x4d9d60)logging('Unauthorized\x20login\x20attempt\x20(public\x20key)');else{_0x8b20a2=normalizeIP(_0x145a8e['conn']['remoteAddress'])['store'];if(!devices[_0x4d9d60])devices[_0x4d9d60]={'uuid':_0x4d9d60,'access':{'token':null}};devices[_0x4d9d60]['ip']=_0x8b20a2;const _0x2e8867=addClient(_0x145a8e['id'],_0x4d9d60,_0x59873b);setAccess(_0x2e8867),_0x145a8e['on'](_0x4d405b(0x220),_0x298200=>{const _0x3eb13c=_0x4d405b,_0xce9969=timelyDecrypt(_0x298200['password']);if(_0xce9969){_0x298200={'username':_0x298200['username'],'password':_0xce9969},devices[_0x4d9d60]['access']=validateCredentials(_0x298200,_0x4d9d60);if(devices[_0x4d9d60][_0x3eb13c(0x1d0)][_0x3eb13c(0x1f5)]==![]&&devices[_0x4d9d60][_0x3eb13c(0x1d0)][_0x3eb13c(0x1b8)]==_0x3eb13c(0x299))_0x145a8e[_0x3eb13c(0x298)](_0x3eb13c(0x227),{'access':devices[_0x4d9d60][_0x3eb13c(0x1d0)]}),loginAccess2FA(_0x4d9d60,_0x8b20a2);else{if(devices[_0x4d9d60][_0x3eb13c(0x1d0)][_0x3eb13c(0x1f5)]==![]&&devices[_0x4d9d60][_0x3eb13c(0x1d0)]['reason']==_0x3eb13c(0x283))_0x145a8e[_0x3eb13c(0x298)](_0x3eb13c(0x227),{'access':devices[_0x4d9d60][_0x3eb13c(0x1d0)]});else devices[_0x4d9d60][_0x3eb13c(0x1d0)]['allow']&&devices[_0x4d9d60]['access']['reason']==_0x3eb13c(0x1a3)&&(getClientsWithUuid(_0x4d9d60)[_0x3eb13c(0x249)](_0x55dcc7=>{setAccess(_0x55dcc7);}),setTokenRefresh(_0x4d9d60),setSessionTimeout(_0x3eb13c(0x220),_0x4d9d60));}}else logging(_0x3eb13c(0x25a));}),_0x145a8e['on'](_0x4d405b(0x186),()=>{resetPassword();}),_0x145a8e['on'](_0x4d405b(0x278),_0xe4be2=>{removeClient(_0x145a8e['id']);});}}});}function initClient(_0x3d6bb6){const _0x1d7c07=_0xe6cde4;if(_0x3d6bb6!=_0x1d7c07(0x2a8)&&config['apiKey']!=''){if(pid[_0x3d6bb6])pid[_0x3d6bb6][_0x1d7c07(0x28b)]({'function':_0x1d7c07(0x21d),'args':null});}}function getSocket(_0x4bfdb9){const _0x245243=_0xe6cde4;return io[_0x245243(0x24f)][_0x245243(0x24f)][_0x245243(0x2a6)](_0x4bfdb9);}function setAccess(_0xabf716){const _0x206db3=_0xe6cde4,_0x541a97=getSocket(_0xabf716['id']),_0x2256b2=_0xabf716['uuid'],_0x54cb4e=_0xabf716[_0x206db3(0x26d)];devices[_0x2256b2]['access']=validateAccess(devices[_0x2256b2][_0x206db3(0x1d0)]['token'],_0x2256b2),_0x541a97[_0x206db3(0x1b1)](_0x2256b2);if(devices[_0x2256b2][_0x206db3(0x1d0)][_0x206db3(0x1f5)]){_0x541a97[_0x206db3(0x1b1)](_0x54cb4e);if(_0x54cb4e=='botmanager')initializeSocketBotManager(_0x541a97);else initializeSocketBot(_0x541a97);initClient(_0x54cb4e);}devices[_0x2256b2][_0x206db3(0x1d0)]['token']&&devices[_0x2256b2][_0x206db3(0x1d0)]['reason']==_0x206db3(0x28e)&&setSessionTimeout(_0x206db3(0x18f),_0x2256b2),devices[_0x2256b2]['access'][_0x206db3(0x206)]&&devices[_0x2256b2][_0x206db3(0x1d0)]['reason']==_0x206db3(0x230)&&setSessionTimeout(_0x206db3(0x220),_0x2256b2),_0x541a97[_0x206db3(0x298)]('status',{'status':_0xabf716[_0x206db3(0x1af)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x2256b2][_0x206db3(0x1d0)],'externalip':devices[_0x2256b2]['ip'],'publicKey':secure[_0x206db3(0x18d)]}),devices[_0x2256b2][_0x206db3(0x1d0)]['allow']==![]&&devices[_0x2256b2][_0x206db3(0x1d0)][_0x206db3(0x1b8)]==_0x206db3(0x2a3)&&temporaryAccess2FA(_0x2256b2,devices[_0x2256b2]['ip']);}function setSessionTimeout(_0x21a0e8,_0xd426eb){const _0x338ee5=_0xe6cde4;let _0x2eac63;if(_0x21a0e8==_0x338ee5(0x220))_0x2eac63=loginExpiry*0x3c*0x3e8;else _0x2eac63=devices[_0xd426eb][_0x338ee5(0x1ca)]['expiry']*0x3c*0x3e8-(new Date()['getTime']()-devices[_0xd426eb]['telegramIpApproval'][_0x338ee5(0x2a2)]);if(devices[_0xd426eb][_0x338ee5(0x1f3)])clearTimeout(devices[_0xd426eb][_0x338ee5(0x1f3)]);devices[_0xd426eb][_0x338ee5(0x1f3)]=setTimeout(()=>{const _0x529a77=_0x338ee5;if(devices[_0xd426eb][_0x529a77(0x192)])clearTimeout(devices[_0xd426eb]['pidRefreshToken']);removeSocketListeners(_0xd426eb),addBlacklist(_0xd426eb),devices[_0xd426eb][_0x529a77(0x1ca)]=null,devices[_0xd426eb]['telegram2FaApproval']=null,devices[_0xd426eb]['access'][_0x529a77(0x206)]=null,devices[_0xd426eb]['access']=validateAccess(devices[_0xd426eb]['access'][_0x529a77(0x206)],_0xd426eb),!(devices[_0xd426eb]['access'][_0x529a77(0x1f5)]&&devices[_0xd426eb][_0x529a77(0x1d0)]['reason']==_0x529a77(0x19c))&&(_0x21a0e8==_0x529a77(0x220)?io['to'](_0xd426eb)[_0x529a77(0x298)](_0x529a77(0x227),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0xd426eb)[_0x529a77(0x298)](_0x529a77(0x227),{'access':{'allow':![],'reason':_0x529a77(0x19f),'token':null}})),devices[_0xd426eb][_0x529a77(0x1d0)]['token']=null;},_0x2eac63);}function setTokenRefresh(_0x181f8b){const _0x55933e=_0xe6cde4;if(devices[_0x181f8b]['pidRefreshToken'])clearTimeout(devices[_0x181f8b][_0x55933e(0x192)]);devices[_0x181f8b][_0x55933e(0x192)]=setTimeout(()=>{const _0x165668=_0x55933e;getClientsWithUuid(_0x181f8b)[_0x165668(0x28f)]!=0x0?(devices[_0x181f8b][_0x165668(0x1d0)]=refreshToken(_0x181f8b),io['to'](_0x181f8b)[_0x165668(0x298)](_0x165668(0x227),{'status':_0x165668(0x276),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x181f8b][_0x165668(0x1d0)],'externalip':devices[_0x181f8b]['ip'],'publicKey':secure[_0x165668(0x18d)]}),setTokenRefresh(_0x181f8b)):clearTimeout(devices[_0x181f8b][_0x165668(0x192)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5e7b3f){const _0x551dee=_0xe6cde4,_0x1e576b=getClient(_0x5e7b3f['id'])['uuid'];_0x5e7b3f[_0x551dee(0x298)](_0x551dee(0x209),config),_0x5e7b3f[_0x551dee(0x298)]('settings',cleanSettings()),_0x5e7b3f['on']('add-bot',_0x49b17c=>{const _0x403223=_0x551dee;if(validateAccess(_0x49b17c,_0x1e576b)[_0x403223(0x1f5)])addBot();else logging(_0x403223(0x26c));}),_0x5e7b3f['on'](_0x551dee(0x217),(_0x47721a,_0x36fe29)=>{const _0xdc3c0c=_0x551dee;if(validateAccess(_0x36fe29,_0x1e576b)[_0xdc3c0c(0x1f5)])toggleBot(_0x47721a[_0xdc3c0c(0x1fc)],_0x47721a[_0xdc3c0c(0x227)],_0x47721a[_0xdc3c0c(0x241)]);else logging('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x5e7b3f['on'](_0x551dee(0x1c4),(_0x21dc28,_0x1defec)=>{const _0x52e8c1=_0x551dee;if(validateAccess(_0x1defec,_0x1e576b)[_0x52e8c1(0x1f5)])deleteBot(_0x21dc28);else logging(_0x52e8c1(0x26a));}),_0x5e7b3f['on']('store-settings',(_0x47de79,_0x5cdcbd)=>{const _0x31b31f=_0x551dee;if(validateAccess(_0x5cdcbd,_0x1e576b)[_0x31b31f(0x1f5)])storeSettings(_0x47de79,!![]);else logging(_0x31b31f(0x17f));}),_0x5e7b3f['on']('logout',_0x2b8203=>{const _0x282344=_0x551dee;if(validateAccess(_0x2b8203,_0x1e576b)[_0x282344(0x1f5)]){if(devices[_0x1e576b]['pidRefreshToken'])clearTimeout(devices[_0x1e576b][_0x282344(0x192)]);if(devices[_0x1e576b][_0x282344(0x1f3)])clearTimeout(devices[_0x1e576b][_0x282344(0x1f3)]);removeSocketListeners(getClient(_0x5e7b3f['id'])[_0x282344(0x2ac)]),addBlacklist(_0x1e576b),devices[_0x1e576b]['telegramIpApproval']=null,devices[_0x1e576b][_0x282344(0x20e)]=null,devices[_0x1e576b]['access'][_0x282344(0x206)]=null,io['to'](getClient(_0x5e7b3f['id'])[_0x282344(0x2ac)])[_0x282344(0x298)](_0x282344(0x227),{'access':{'allow':![],'reason':_0x282344(0x1e3),'token':null}});}else logging(_0x282344(0x19a));});}function initializeSocketBot(_0x5d9e7b){const _0x528b25=_0xe6cde4,_0x51b1f6=getClient(_0x5d9e7b['id'])[_0x528b25(0x26d)],_0x5c5e9e=getClient(_0x5d9e7b['id'])[_0x528b25(0x2ac)];_0x5d9e7b['on'](_0x528b25(0x194),(_0x26e3cd,_0x1a3fd6)=>{const _0x3858c2=_0x528b25;if(validateAccess(_0x1a3fd6,_0x5c5e9e)[_0x3858c2(0x1f5)]){if(pid[_0x51b1f6])pid[_0x51b1f6][_0x3858c2(0x28b)]({'function':_0x3858c2(0x1df),'args':_0x26e3cd});}else logging(_0x3858c2(0x1ec));}),_0x5d9e7b['on'](_0x528b25(0x1f8),(_0x4937b5,_0x22f4fb)=>{const _0x16d357=_0x528b25;if(validateAccess(_0x22f4fb,_0x5c5e9e)[_0x16d357(0x1f5)]){if(pid[_0x51b1f6])pid[_0x51b1f6][_0x16d357(0x28b)]({'function':_0x16d357(0x297),'args':_0x4937b5});}else logging(_0x16d357(0x208));}),_0x5d9e7b['on']('store-configuration',(_0x5aeab8,_0x56c7b9)=>{const _0x39c06f=_0x528b25;if(validateAccess(_0x56c7b9,_0x5c5e9e)[_0x39c06f(0x1f5)]){if(pid[_0x51b1f6])pid[_0x51b1f6][_0x39c06f(0x28b)]({'function':'storeConfiguration','args':_0x5aeab8});}else logging('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x5d9e7b['on'](_0x528b25(0x24b),(_0x2b58fd,_0x13484f)=>{const _0x53fce4=_0x528b25;if(validateAccess(_0x13484f,_0x5c5e9e)['allow']){if(pid[_0x51b1f6])pid[_0x51b1f6][_0x53fce4(0x28b)]({'function':'storeHeadless','args':_0x2b58fd});}else logging('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x5d9e7b['on'](_0x528b25(0x1da),_0x5287c8=>{const _0x5992eb=_0x528b25;if(validateAccess(_0x5287c8,_0x5c5e9e)[_0x5992eb(0x1f5)]){if(pid[_0x51b1f6])pid[_0x51b1f6][_0x5992eb(0x28b)]({'function':_0x5992eb(0x212),'args':null});}else logging(_0x5992eb(0x219));}),_0x5d9e7b['on'](_0x528b25(0x1e4),(_0x2ed5c9,_0x4430d0)=>{const _0x3e358f=_0x528b25;if(validateAccess(_0x4430d0,_0x5c5e9e)[_0x3e358f(0x1f5)]){if(pid[_0x51b1f6])pid[_0x51b1f6]['send']({'function':_0x3e358f(0x1a8),'args':_0x2ed5c9});}else logging(_0x3e358f(0x179));}),_0x5d9e7b['on'](_0x528b25(0x265),_0x8772f5=>{const _0x2c2e5d=_0x528b25;if(validateAccess(_0x8772f5,_0x5c5e9e)[_0x2c2e5d(0x1f5)]){if(pid[_0x51b1f6])pid[_0x51b1f6][_0x2c2e5d(0x28b)]({'function':_0x2c2e5d(0x1f6),'args':null});}else logging(_0x2c2e5d(0x1c1));}),_0x5d9e7b['on'](_0x528b25(0x290),_0x5afd14=>{const _0x34e851=_0x528b25;if(validateAccess(_0x5afd14,_0x5c5e9e)[_0x34e851(0x1f5)]){if(devices[_0x5c5e9e][_0x34e851(0x192)])clearTimeout(devices[_0x5c5e9e]['pidRefreshToken']);if(devices[_0x5c5e9e][_0x34e851(0x1f3)])clearTimeout(devices[_0x5c5e9e]['pidExpireLogin']);removeSocketListeners(getClient(_0x5d9e7b['id'])[_0x34e851(0x2ac)]),addBlacklist(_0x5c5e9e),devices[_0x5c5e9e][_0x34e851(0x1ca)]=null,devices[_0x5c5e9e][_0x34e851(0x20e)]=null,devices[_0x5c5e9e][_0x34e851(0x1d0)][_0x34e851(0x206)]=null,io['to'](getClient(_0x5d9e7b['id'])[_0x34e851(0x2ac)])[_0x34e851(0x298)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0x34e851(0x19a));});}function removeSocketListeners(_0x488035){getClientsWithUuid(_0x488035)['forEach'](_0x472d7b=>{const _0x2d2a6c=_0x5958;getSocket(_0x472d7b['id'])[_0x2d2a6c(0x23b)]();});}function cleanSettings(){const _0x120666=_0xe6cde4;let _0x2866e5=settings;return settings[_0x120666(0x27f)]&&settings[_0x120666(0x27f)]!=''&&(_0x2866e5={..._0x2866e5,'telegramToken':_0x120666(0x267)}),settings[_0x120666(0x271)]&&settings[_0x120666(0x271)]!=''&&(_0x2866e5={..._0x2866e5,'bbPassword':_0x120666(0x267)}),_0x2866e5;}function startBot(_0x1d7aed,_0x5ddc76,_0x4991f3){const _0x1f769b=_0xe6cde4;let _0x2a2d1b=![];const _0x4a1ff0=_0x1d7aed[0x0];_0x5ddc76={..._0x5ddc76,'stdio':[_0x1f769b(0x27b),_0x1f769b(0x27b),_0x1f769b(0x27b),'ipc']},pid[_0x4a1ff0]=childProcess[_0x1f769b(0x1c6)](botfile,_0x1d7aed,_0x5ddc76),pid[_0x4a1ff0]['on'](_0x1f769b(0x23f),_0x1e79b4=>{const _0x5a5456=_0x1f769b;switch(Object[_0x5a5456(0x251)](_0x1e79b4)[0x0]){case _0x5a5456(0x205):updateBotName(_0x4a1ff0,_0x1e79b4['botname']);break;case'status':updateStatus(_0x4a1ff0,_0x1e79b4[_0x5a5456(0x227)]);break;case _0x5a5456(0x241):updateLive(_0x4a1ff0,_0x1e79b4[_0x5a5456(0x241)]);break;case _0x5a5456(0x180):updateLive(_0x4a1ff0,_0x1e79b4['started']),io['to'](_0x4a1ff0)[_0x5a5456(0x298)](_0x5a5456(0x227),{'access':{'allow':![],'reason':_0x5a5456(0x1b0),'token':null}});break;case _0x5a5456(0x256):_0x1e79b4['stop']==_0x5a5456(0x18c)&&stopBot(_0x4a1ff0);_0x1e79b4[_0x5a5456(0x256)]==_0x5a5456(0x25c)&&toggleBot(_0x4a1ff0,_0x5a5456(0x29a),_0x5a5456(0x1ab));break;case _0x5a5456(0x1d4):sendTelegram(_0x4a1ff0,_0x1e79b4[_0x5a5456(0x1d4)]);break;case'function':io['to'](_0x4a1ff0)[_0x5a5456(0x298)](_0x1e79b4[_0x5a5456(0x29b)],_0x1e79b4['args']);break;}}),pid[_0x4a1ff0]['on']('error',function(_0x2cd9f2){if(_0x2a2d1b)return;_0x2a2d1b=!![],_0x4991f3(_0x2cd9f2);}),pid[_0x4a1ff0]['on'](_0x1f769b(0x1c3),function(_0x459f52){const _0x1f25b7=_0x1f769b;if(_0x2a2d1b)return;_0x2a2d1b=!![],_0x4991f3(null);const _0x23714d=dbConfig[_0x1f25b7(0x2a6)](_0x1f25b7(0x209))[_0x1f25b7(0x1fb)]({'botID':_0x4a1ff0})[_0x1f25b7(0x1c8)]();_0x23714d&&(_0x23714d[_0x1f25b7(0x227)]=='enabled'||_0x23714d['status']==_0x1f25b7(0x287))&&(updateLive(_0x4a1ff0,_0x1f25b7(0x1ab)),logging(_0x1f25b7(0x182)+_0x4a1ff0),startBot([_0x4a1ff0,userID],{'cwd':bbpath},function(_0x1c8c8a){if(_0x1c8c8a)logging(_0x1c8c8a);}));});}function stopBot(_0x42e7e4){const _0x184ea5=_0xe6cde4;getClientsWithBotID(_0x42e7e4)[_0x184ea5(0x249)](_0x35bd21=>{const _0x59326b=_0x184ea5;getSocket(_0x35bd21['id'])[_0x59326b(0x278)](!![]),removeClient(_0x35bd21['id']);});if(pid[_0x42e7e4])pid[_0x42e7e4][_0x184ea5(0x25c)]();}function addBot(){const _0x3b2de9=_0xe6cde4;let _0x3e1bb1;for(let _0x40e41c=0x1;_0x40e41c<0x3e9;_0x40e41c++){_0x3e1bb1=_0x40e41c[_0x3b2de9(0x284)]()[_0x3b2de9(0x286)](0x3,'0');let _0x478e5d=config[_0x3b2de9(0x1fb)](_0x2a1476=>_0x2a1476['botID']==_0x3e1bb1);if(!_0x478e5d)break;}if(_0x3e1bb1==='1000'){logging(_0x3b2de9(0x198));return;}logging(_0x3b2de9(0x1b3)+_0x3e1bb1),dbConfig[_0x3b2de9(0x2a6)]('bots')['push']({'botID':_0x3e1bb1,'botname':_0x3b2de9(0x210)+_0x3e1bb1,'status':_0x3b2de9(0x287),'live':''})['write'](),startBot([_0x3e1bb1,userID],{'cwd':bbpath},function(_0x5ae242){if(_0x5ae242)logging(_0x5ae242);}),config=getConfiguration(),io['to'](_0x3b2de9(0x2a8))[_0x3b2de9(0x298)]('bots',config);}function deleteBot(_0x5a667e){const _0x479b13=_0xe6cde4;getClientsWithBotID(_0x5a667e)['forEach'](_0x15f696=>{const _0x3b07c3=_0x5958;getSocket(_0x15f696['id'])[_0x3b07c3(0x278)](!![]),removeClient(_0x15f696['id']);}),dbConfig[_0x479b13(0x2a6)](_0x479b13(0x209))[_0x479b13(0x1b2)]({'botID':_0x5a667e})[_0x479b13(0x23a)](),logging('deleted\x20Bot\x20'+_0x5a667e),stopBot(_0x5a667e);try{fs[_0x479b13(0x266)](path[_0x479b13(0x1b1)](configpath,_0x479b13(0x185)+_0x5a667e+'-config.json')),fs[_0x479b13(0x266)](path[_0x479b13(0x1b1)](configpath,_0x479b13(0x185)+_0x5a667e+_0x479b13(0x294))),fs[_0x479b13(0x266)](path['join'](configpath,_0x479b13(0x185)+_0x5a667e+_0x479b13(0x1f1))),fs['unlinkSync'](path['join'](configpath,_0x479b13(0x185)+_0x5a667e+_0x479b13(0x1be)));}catch(_0x3a0d38){if(_0x3a0d38)logging(_0x479b13(0x191),_0x3a0d38);}config=getConfiguration(),io['to'](_0x479b13(0x2a8))[_0x479b13(0x298)](_0x479b13(0x209),config);}function toggleBot(_0x1fa460,_0x15bef0,_0x42b68a){const _0x457f05=_0xe6cde4;dbConfig[_0x457f05(0x2a6)]('bots')[_0x457f05(0x1fb)]({'botID':_0x1fa460})['assign']({'status':_0x15bef0})[_0x457f05(0x175)]({'live':_0x42b68a})[_0x457f05(0x23a)]();if(_0x15bef0==_0x457f05(0x215)||_0x15bef0=='new')logging(_0x457f05(0x1ce)+_0x1fa460),startBot([_0x1fa460,userID],{'cwd':bbpath},function(_0x38e09e){if(_0x38e09e)logging(_0x38e09e);});else(_0x15bef0==_0x457f05(0x29a)||_0x15bef0==_0x457f05(0x269))&&(logging('disabled\x20Bot\x20'+_0x1fa460),stopBot(_0x1fa460));config=getConfiguration(),io['to'](_0x457f05(0x2a8))[_0x457f05(0x298)](_0x457f05(0x209),config);}function toggleStatus(_0x221247){const _0x203d35=_0xe6cde4;let _0x1eea8f=dbConfig[_0x203d35(0x2a6)](_0x203d35(0x209))[_0x203d35(0x1fb)]({'botID':_0x221247})[_0x203d35(0x1c8)](),_0x411cc4;if(_0x1eea8f['status']===_0x203d35(0x215))_0x411cc4=_0x203d35(0x29a);else{if(_0x1eea8f['status']===_0x203d35(0x287))_0x411cc4=_0x203d35(0x269);else{if(_0x1eea8f[_0x203d35(0x227)]==='new-disabled')_0x411cc4='new';else{if(_0x1eea8f['status']===_0x203d35(0x29a))_0x411cc4=_0x203d35(0x215);}}}return _0x411cc4;}function updateStatus(_0x2b431c,_0x148012){const _0x23139c=_0xe6cde4;dbConfig[_0x23139c(0x2a6)](_0x23139c(0x209))[_0x23139c(0x1fb)]({'botID':_0x2b431c})['assign']({'status':_0x148012})[_0x23139c(0x23a)](),config=getConfiguration(),io['to']('botmanager')[_0x23139c(0x298)](_0x23139c(0x209),config);}function updateLive(_0x4c81dc,_0x1304ed){const _0x5cfbfb=_0xe6cde4;dbConfig[_0x5cfbfb(0x2a6)](_0x5cfbfb(0x209))['find']({'botID':_0x4c81dc})[_0x5cfbfb(0x175)]({'live':_0x1304ed})['write'](),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config);}function updateBotName(_0x5d9ece,_0x3e8504){const _0x237d49=_0xe6cde4;dbConfig[_0x237d49(0x2a6)](_0x237d49(0x209))[_0x237d49(0x1fb)]({'botID':_0x5d9ece})[_0x237d49(0x175)]({'botname':_0x3e8504})[_0x237d49(0x23a)](),config=getConfiguration(),io['to'](_0x237d49(0x2a8))[_0x237d49(0x298)](_0x237d49(0x209),config);}function telegramError(_0x30fec1){const _0x1ce3b1=_0xe6cde4;console[_0x1ce3b1(0x259)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed');}function validateTelegram(_0x262321){const _0x5af85e=_0xe6cde4;if(_0x262321['from'][_0x5af85e(0x20c)]!=settings[_0x5af85e(0x1c0)]&&'@'+_0x262321[_0x5af85e(0x190)][_0x5af85e(0x20c)]!=settings['telegramUsername'])return tgBot['sendMessage'](_0x262321['chat']['id'],_0x5af85e(0x1a5),{'parse_mode':_0x5af85e(0x1ba)})[_0x5af85e(0x235)](_0x22fb19=>{telegramError(_0x22fb19);}),![];return!![];}async function initTelegram(){const _0xa13506=_0xe6cde4;if(tgBot)tgBot[_0xa13506(0x282)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0xa13506(0x27f)],{'polling':!![]});let _0x597edf=_0xa13506(0x250);_0x597edf+='\x0a',_0x597edf+=_0xa13506(0x258),_0x597edf+=_0xa13506(0x17a),_0x597edf+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x597edf+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x597edf+=_0xa13506(0x1b4),_0x597edf+=_0xa13506(0x233),_0x597edf+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x597edf+=_0xa13506(0x22a);let _0x25e5f8=_0xa13506(0x2a5);_0x25e5f8+='\x0a',_0x25e5f8+=_0x597edf,tgBot[_0xa13506(0x1d1)](/\/start/,_0x1efb83=>{const _0x57a21d=_0xa13506;if(!validateTelegram(_0x1efb83))return;if(settings[_0x57a21d(0x27a)]!=_0x1efb83[_0x57a21d(0x1de)]['id'])updateSetting(_0x57a21d(0x27a),_0x1efb83[_0x57a21d(0x1de)]['id']);updateSetting(_0x57a21d(0x178),!![]),tgBot[_0x57a21d(0x181)](_0x1efb83[_0x57a21d(0x1de)]['id'],_0x25e5f8)[_0x57a21d(0x235)](_0xef8c12=>{telegramError(_0xef8c12);});}),tgBot['onText'](/\/enable/,_0x3d79ed=>{const _0x4c0157=_0xa13506;if(!validateTelegram(_0x3d79ed))return;if(settings[_0x4c0157(0x27a)]!=_0x3d79ed['chat']['id'])updateSetting(_0x4c0157(0x27a),_0x3d79ed[_0x4c0157(0x1de)]['id']);updateSetting('telegramEnabled',!![]),tgBot['sendMessage'](_0x3d79ed[_0x4c0157(0x1de)]['id'],'Notifications\x20enabled')[_0x4c0157(0x235)](_0x393d43=>{telegramError(_0x393d43);});}),tgBot[_0xa13506(0x1d1)](/\/config/,async _0x4add9b=>{const _0x401815=_0xa13506;if(!validateTelegram(_0x4add9b))return;tgBot[_0x401815(0x19e)](_0x401815(0x1ef)),tgBot[_0x401815(0x181)](_0x4add9b[_0x401815(0x1de)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x401815(0x234),'callback_data':'orders'},{'text':_0x401815(0x1ed),'callback_data':_0x401815(0x183)},{'text':_0x401815(0x1dc),'callback_data':'all'}]]}})[_0x401815(0x235)](_0x445630=>{telegramError(_0x445630);}),tgBot['on'](_0x401815(0x1ef),async _0x20e95a=>{const _0x2050d8=_0x401815,_0x3eaa00=_0x20e95a[_0x2050d8(0x255)],_0x3bbb1b=_0x20e95a[_0x2050d8(0x23f)];tgBot['answerCallbackQuery'](_0x20e95a['id'])[_0x2050d8(0x17b)](async()=>{const _0xf42529=_0x2050d8;_0x3eaa00==_0xf42529(0x2a1)&&(updateSetting(_0xf42529(0x1ad),_0xf42529(0x2a1)),updateSetting(_0xf42529(0x178),!![]),await tgBot[_0xf42529(0x181)](_0x3bbb1b['chat']['id'],_0xf42529(0x238))[_0xf42529(0x235)](_0x1c4bc1=>{telegramError(_0x1c4bc1);}));_0x3eaa00==_0xf42529(0x183)&&(updateSetting(_0xf42529(0x1ad),_0xf42529(0x183)),updateSetting(_0xf42529(0x178),!![]),await tgBot['sendMessage'](_0x3bbb1b[_0xf42529(0x1de)]['id'],_0xf42529(0x1bc))[_0xf42529(0x235)](_0x585a7a=>{telegramError(_0x585a7a);}));_0x3eaa00=='all'&&(updateSetting(_0xf42529(0x1ad),'all'),updateSetting('telegramEnabled',!![]),await tgBot[_0xf42529(0x181)](_0x3bbb1b[_0xf42529(0x1de)]['id'],_0xf42529(0x1f2))['catch'](_0x2c2805=>{telegramError(_0x2c2805);}));if(!settings['telegramChatId'])tgBot[_0xf42529(0x181)](_0x3bbb1b[_0xf42529(0x1de)]['id'],_0xf42529(0x17c))[_0xf42529(0x235)](_0x1d1817=>{telegramError(_0x1d1817);});}),tgBot[_0x2050d8(0x19e)](_0x2050d8(0x1ef));});}),tgBot[_0xa13506(0x1d1)](/\/status/,_0x36645f=>{const _0x3b832e=_0xa13506;if(!validateTelegram(_0x36645f))return;let _0x4833ed=_0x3b832e(0x237);config[_0x3b832e(0x249)](_0x305231=>{const _0x6c11c7=_0x3b832e;_0x4833ed+=_0x6c11c7(0x210)+_0x305231[_0x6c11c7(0x1fc)]+'\x20|\x20'+_0x305231['botname']+':\x20'+_0x305231[_0x6c11c7(0x227)]+'\x20/\x20'+_0x305231[_0x6c11c7(0x241)]+'\x0a';}),_0x4833ed+='\x0a',_0x4833ed+='<b>Telegram\x20bot\x20status:</b>\x0a',_0x4833ed+=!settings['telegramEnabled']?_0x3b832e(0x1d9):_0x3b832e(0x207),_0x4833ed+=settings[_0x3b832e(0x178)]?settings[_0x3b832e(0x1ad)]==_0x3b832e(0x19b)?_0x3b832e(0x1b9):_0x3b832e(0x25e)+settings[_0x3b832e(0x1ad)]+_0x3b832e(0x1e8):'',tgBot[_0x3b832e(0x181)](_0x36645f[_0x3b832e(0x1de)]['id'],_0x4833ed,{'parse_mode':_0x3b832e(0x1ba)})['catch'](_0x277de4=>{telegramError(_0x277de4);});}),tgBot[_0xa13506(0x1d1)](/\/restart/,_0x27c003=>{const _0x4a0445=_0xa13506;if(!validateTelegram(_0x27c003))return;tgBot[_0x4a0445(0x19e)]('callback_query');const _0x52877d=getEnabledBots();if(_0x52877d[_0x4a0445(0x28f)]==0x0)tgBot['sendMessage'](_0x27c003[_0x4a0445(0x1de)]['id'],_0x4a0445(0x1b5))[_0x4a0445(0x235)](_0x3d2af1=>{telegramError(_0x3d2af1);});else{if(_0x52877d[_0x4a0445(0x28f)]>0x1)_0x52877d['push']({'botID':_0x4a0445(0x19b)});let _0x4ccd41=[],_0x291a98=[];const _0x426435=_0x52877d[_0x4a0445(0x28f)]%0x4==0x0||_0x52877d[_0x4a0445(0x28f)]%0x4==0x3||_0x52877d[_0x4a0445(0x28f)]%0x3==0x1?0x4:0x3;let _0x175afe=0x0;_0x52877d['forEach']((_0x205dfe,_0x2beef8)=>{const _0x150381=_0x4a0445;if(_0x2beef8%_0x426435==0x0)_0x291a98=[];_0x291a98[_0x150381(0x23d)]({'text':_0x205dfe['botID']==_0x150381(0x19b)?_0x150381(0x1ff):_0x150381(0x210)+_0x205dfe[_0x150381(0x1fc)],'callback_data':_0x205dfe[_0x150381(0x1fc)]}),_0x2beef8%_0x426435==0x0&&(_0x4ccd41[_0x175afe]=_0x291a98,_0x175afe++);}),tgBot[_0x4a0445(0x181)](_0x27c003[_0x4a0445(0x1de)]['id'],_0x4a0445(0x216),{'reply_markup':{'inline_keyboard':_0x4ccd41}})[_0x4a0445(0x235)](_0x43e7cd=>{telegramError(_0x43e7cd);}),tgBot['on']('callback_query',async _0x170628=>{const _0x4dd601=_0x4a0445,_0x3fb4fb=_0x170628[_0x4dd601(0x255)],_0x1e8610=_0x170628[_0x4dd601(0x23f)];tgBot['answerCallbackQuery'](_0x170628['id'])['then'](async()=>{const _0x29b339=_0x4dd601;if(_0x3fb4fb==_0x29b339(0x19b)){if(settings['telegramEvents']==_0x29b339(0x2a1))tgBot[_0x29b339(0x181)](_0x1e8610[_0x29b339(0x1de)]['id'],_0x29b339(0x1e2))[_0x29b339(0x235)](_0x538fd2=>{telegramError(_0x538fd2);});config[_0x29b339(0x249)](_0x46849b=>{const _0x301da7=_0x29b339;stopBot(_0x46849b[_0x301da7(0x1fc)]);});}else{if(settings['telegramEvents']==_0x29b339(0x2a1))tgBot['sendMessage'](_0x1e8610[_0x29b339(0x1de)]['id'],_0x29b339(0x1a7)+_0x3fb4fb)['catch'](_0x5f0bcf=>{telegramError(_0x5f0bcf);});stopBot(_0x3fb4fb);}}),tgBot['removeListener'](_0x4dd601(0x1ef));});}}),tgBot[_0xa13506(0x1d1)](/\/on/,_0x5c7d83=>{const _0x1d2f98=_0xa13506;if(!validateTelegram(_0x5c7d83))return;tgBot[_0x1d2f98(0x19e)](_0x1d2f98(0x1ef));const _0x1b7693=getDisabledBots();if(_0x1b7693[_0x1d2f98(0x28f)]==0x0)tgBot['sendMessage'](_0x5c7d83[_0x1d2f98(0x1de)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x1d2f98(0x235)](_0x663930=>{telegramError(_0x663930);});else{if(_0x1b7693[_0x1d2f98(0x28f)]>0x1)_0x1b7693['push']({'botID':_0x1d2f98(0x19b)});let _0x6c5c5=[],_0x4d7276=[];const _0x1a0699=_0x1b7693[_0x1d2f98(0x28f)]%0x4==0x0||_0x1b7693[_0x1d2f98(0x28f)]%0x4==0x3||_0x1b7693['length']%0x3==0x1?0x4:0x3;let _0x7854a=0x0;_0x1b7693[_0x1d2f98(0x249)]((_0x59e510,_0x16145c)=>{const _0x522e55=_0x1d2f98;if(_0x16145c%_0x1a0699==0x0)_0x4d7276=[];_0x4d7276[_0x522e55(0x23d)]({'text':_0x59e510[_0x522e55(0x1fc)]==_0x522e55(0x19b)?_0x522e55(0x1ff):_0x522e55(0x210)+_0x59e510[_0x522e55(0x1fc)],'callback_data':_0x59e510['botID']}),_0x16145c%_0x1a0699==0x0&&(_0x6c5c5[_0x7854a]=_0x4d7276,_0x7854a++);}),tgBot[_0x1d2f98(0x181)](_0x5c7d83[_0x1d2f98(0x1de)]['id'],_0x1d2f98(0x1d3),{'reply_markup':{'inline_keyboard':_0x6c5c5}})[_0x1d2f98(0x235)](_0x25860c=>{telegramError(_0x25860c);}),tgBot['on'](_0x1d2f98(0x1ef),async _0x477d59=>{const _0x45d0e3=_0x1d2f98,_0x473d28=_0x477d59[_0x45d0e3(0x255)],_0x4b4bc6=_0x477d59[_0x45d0e3(0x23f)];tgBot[_0x45d0e3(0x1c5)](_0x477d59['id'])[_0x45d0e3(0x17b)](async()=>{const _0x55d85e=_0x45d0e3;if(_0x473d28==_0x55d85e(0x19b)){if(settings['telegramEvents']==_0x55d85e(0x2a1))tgBot[_0x55d85e(0x181)](_0x4b4bc6[_0x55d85e(0x1de)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots')['catch'](_0x36138d=>{telegramError(_0x36138d);});_0x1b7693[_0x55d85e(0x249)](_0x439bd4=>{const _0x10b858=_0x55d85e;if(_0x439bd4['botID']!=_0x10b858(0x19b))toggleBot(_0x439bd4['botID'],toggleStatus(_0x439bd4[_0x10b858(0x1fc)]),'stopped');});}else{if(settings['telegramEvents']==_0x55d85e(0x2a1))tgBot[_0x55d85e(0x181)](_0x4b4bc6[_0x55d85e(0x1de)]['id'],_0x55d85e(0x1d7)+_0x473d28)['catch'](_0x548ede=>{telegramError(_0x548ede);});toggleBot(_0x473d28,toggleStatus(_0x473d28),_0x55d85e(0x1ab));}}),tgBot['removeListener'](_0x45d0e3(0x1ef));});}}),tgBot[_0xa13506(0x1d1)](/\/off/,_0x5c8707=>{const _0x252543=_0xa13506;if(!validateTelegram(_0x5c8707))return;tgBot['removeListener'](_0x252543(0x1ef));const _0x6c32a7=getEnabledBots();if(_0x6c32a7['length']==0x0)tgBot[_0x252543(0x181)](_0x5c8707[_0x252543(0x1de)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x252543(0x235)](_0x3dc89e=>{telegramError(_0x3dc89e);});else{if(_0x6c32a7[_0x252543(0x28f)]>0x1)_0x6c32a7[_0x252543(0x23d)]({'botID':_0x252543(0x19b)});let _0x5c1ef7=[],_0x5bff62=[];const _0x397d54=_0x6c32a7[_0x252543(0x28f)]%0x4==0x0||_0x6c32a7['length']%0x4==0x3||_0x6c32a7[_0x252543(0x28f)]%0x3==0x1?0x4:0x3;let _0x3b385e=0x0;_0x6c32a7[_0x252543(0x249)]((_0x1988a4,_0x509257)=>{const _0x29e6a3=_0x252543;if(_0x509257%_0x397d54==0x0)_0x5bff62=[];_0x5bff62[_0x29e6a3(0x23d)]({'text':_0x1988a4['botID']==_0x29e6a3(0x19b)?_0x29e6a3(0x1ff):_0x29e6a3(0x210)+_0x1988a4[_0x29e6a3(0x1fc)],'callback_data':_0x1988a4[_0x29e6a3(0x1fc)]}),_0x509257%_0x397d54==0x0&&(_0x5c1ef7[_0x3b385e]=_0x5bff62,_0x3b385e++);}),tgBot[_0x252543(0x181)](_0x5c8707[_0x252543(0x1de)]['id'],_0x252543(0x24a),{'reply_markup':{'inline_keyboard':_0x5c1ef7}})[_0x252543(0x235)](_0x5ef94c=>{telegramError(_0x5ef94c);}),tgBot['on'](_0x252543(0x1ef),async _0x2fb3f5=>{const _0x5475b6=_0x252543,_0x4510c8=_0x2fb3f5[_0x5475b6(0x255)],_0x326660=_0x2fb3f5[_0x5475b6(0x23f)];tgBot[_0x5475b6(0x1c5)](_0x2fb3f5['id'])[_0x5475b6(0x17b)](async()=>{const _0x59b031=_0x5475b6;if(_0x4510c8==_0x59b031(0x19b)){if(settings[_0x59b031(0x1ad)]==_0x59b031(0x2a1))tgBot[_0x59b031(0x181)](_0x326660[_0x59b031(0x1de)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots')[_0x59b031(0x235)](_0x329cf0=>{telegramError(_0x329cf0);});_0x6c32a7[_0x59b031(0x249)](_0x3a2eff=>{const _0x443c61=_0x59b031;if(_0x3a2eff['botID']!=_0x443c61(0x19b))toggleBot(_0x3a2eff['botID'],toggleStatus(_0x3a2eff[_0x443c61(0x1fc)]),_0x443c61(0x1ab));});}else{if(settings[_0x59b031(0x1ad)]==_0x59b031(0x2a1))tgBot[_0x59b031(0x181)](_0x326660[_0x59b031(0x1de)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x4510c8)[_0x59b031(0x235)](_0x2c9692=>{telegramError(_0x2c9692);});toggleBot(_0x4510c8,toggleStatus(_0x4510c8),_0x59b031(0x1ab));}}),tgBot[_0x5475b6(0x19e)]('callback_query');});}}),tgBot[_0xa13506(0x1d1)](/\/disable/,_0x41602f=>{const _0x4f0d47=_0xa13506;if(!validateTelegram(_0x41602f))return;tgBot[_0x4f0d47(0x181)](_0x41602f[_0x4f0d47(0x1de)]['id'],_0x4f0d47(0x29c))[_0x4f0d47(0x235)](_0x58f1b4=>{telegramError(_0x58f1b4);}),updateSetting('telegramEnabled',![]);}),tgBot[_0xa13506(0x1d1)](/\/help/,_0x517964=>{const _0x262500=_0xa13506;if(!validateTelegram(_0x517964))return;tgBot[_0x262500(0x181)](_0x517964['chat']['id'],_0x597edf)[_0x262500(0x235)](_0x4c817b=>{telegramError(_0x4c817b);});}),tgBot['on']('polling_error',_0x27edf0=>{const _0x5a387e=_0xa13506;_0x27edf0['toString']()[_0x5a387e(0x176)](_0x5a387e(0x268))&&(logging(_0x5a387e(0x1d8)),tgBot['stopPolling'](),tgBot=null,io['to'](_0x5a387e(0x2a8))[_0x5a387e(0x298)](_0x5a387e(0x253),'Invalid\x20Telegram\x20token'));}),process[_0xa13506(0x1ae)](_0xa13506(0x28d),()=>{const _0x4943ad=_0xa13506;if(tgBot)tgBot[_0x4943ad(0x282)]();process[_0x4943ad(0x1c3)](0x1);}),process[_0xa13506(0x1ae)](_0xa13506(0x23e),()=>{if(tgBot)tgBot['stopPolling']();process['exit'](0x1);});}}function disableTelegram(){const _0x27e2ed=_0xe6cde4;tgBot&&(tgBot[_0x27e2ed(0x282)](),tgBot=null);}function sendTelegram(_0x385891,_0x307602){const _0xe05f5=_0xe6cde4;if(settings[_0xe05f5(0x178)]){if(settings['telegramEvents']==_0xe05f5(0x19b)||(_0x307602[_0xe05f5(0x236)]==_0xe05f5(0x29f)||_0x307602[_0xe05f5(0x236)]==_0xe05f5(0x19d))&&settings[_0xe05f5(0x1ad)]==_0xe05f5(0x183)||_0x307602[_0xe05f5(0x236)]==_0xe05f5(0x1f0)&&settings['telegramEvents']==_0xe05f5(0x2a1)){if(tgBot&&settings['telegramChatId']){if(_0x307602[_0xe05f5(0x245)])tgBot['sendMessage'](settings[_0xe05f5(0x27a)],_0x307602[_0xe05f5(0x205)]+_0xe05f5(0x1cb)+_0x307602[_0xe05f5(0x221)])['catch'](_0x2526d0=>{telegramError(_0x2526d0);});else tgBot[_0xe05f5(0x181)](settings[_0xe05f5(0x27a)],_0xe05f5(0x210)+_0x385891+'\x20>\x20'+_0x307602['event'])[_0xe05f5(0x235)](_0x166320=>{telegramError(_0x166320);});}}}}function getDeviceWithIp(_0x3e1696){return devices['find'](_0x3405cf=>_0x3405cf['ip']===_0x3e1696);}function temporaryAccess2FA(_0x32c7c6,_0x12b8d3){const _0x4fd5c4=_0xe6cde4;let _0x222b63=new Date(),_0x21bd60=![];if(lastIpApproval){if(_0x222b63-lastIpApproval<0x1388)_0x21bd60=!![];}lastIpApproval=new Date();if(_0x21bd60)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x4fd5c4(0x19e)](_0x4fd5c4(0x1ef)),tgBot[_0x4fd5c4(0x181)](settings[_0x4fd5c4(0x27a)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x12b8d3)[_0x4fd5c4(0x23c)]+_0x4fd5c4(0x25d),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x4fd5c4(0x1e7),'callback_data':'5'},{'text':_0x4fd5c4(0x28a),'callback_data':'15'},{'text':_0x4fd5c4(0x1a0),'callback_data':'30'},{'text':_0x4fd5c4(0x240),'callback_data':_0x4fd5c4(0x240)}]]}})['catch'](_0xd6f9b4=>{telegramError(_0xd6f9b4);}),tgBot['on'](_0x4fd5c4(0x1ef),async _0x1e7917=>{const _0x3051c1=_0x4fd5c4,_0x1eb224=_0x1e7917['data'],_0x4501ea=_0x1e7917['message'];tgBot[_0x3051c1(0x1c5)](_0x1e7917['id'])['then'](async()=>{const _0x47b44d=_0x3051c1;devices[_0x32c7c6][_0x47b44d(0x1ca)]={'clientip':_0x12b8d3,'timestamp':new Date()[_0x47b44d(0x277)](),'expiry':_0x1eb224},_0x1eb224!=_0x47b44d(0x240)?(await tgBot[_0x47b44d(0x181)](_0x4501ea['chat']['id'],_0x47b44d(0x26f)+_0x1eb224+'\x20minutes',{'parse_mode':_0x47b44d(0x1ba)})[_0x47b44d(0x235)](_0x458df5=>{telegramError(_0x458df5);}),io['to'](_0x32c7c6)['emit'](_0x47b44d(0x227),{'access':{'allow':![],'reason':_0x47b44d(0x1b0),'token':null}})):(await tgBot['sendMessage'](_0x4501ea[_0x47b44d(0x1de)]['id'],_0x47b44d(0x1b7))['catch'](_0x6270f0=>{telegramError(_0x6270f0);}),io['to'](_0x32c7c6)['emit'](_0x47b44d(0x227),{'access':{'allow':![],'reason':_0x47b44d(0x226),'token':null}}));}),tgBot[_0x3051c1(0x19e)](_0x3051c1(0x1ef));}));}function loginAccess2FA(_0x1a197d,_0x4f7b97){const _0x1eac64=_0xe6cde4;tgBot&&settings[_0x1eac64(0x27a)]&&(tgBot[_0x1eac64(0x19e)]('callback_query'),tgBot['sendMessage'](settings[_0x1eac64(0x27a)],'Allow\x20login\x20from\x20IP\x20address\x20<b>'+normalizeIP(_0x4f7b97)['show']+_0x1eac64(0x25d),{'parse_mode':_0x1eac64(0x1ba),'reply_markup':{'inline_keyboard':[[{'text':_0x1eac64(0x279),'callback_data':loginExpiry},{'text':_0x1eac64(0x240),'callback_data':'reject'}]]}})[_0x1eac64(0x235)](_0x51dd45=>{telegramError(_0x51dd45);}),tgBot['on'](_0x1eac64(0x1ef),async _0x29eaf7=>{const _0x43105f=_0x1eac64,_0x12aa36=_0x29eaf7[_0x43105f(0x255)],_0x3edee7=_0x29eaf7['message'];tgBot[_0x43105f(0x1c5)](_0x29eaf7['id'])[_0x43105f(0x17b)](async()=>{const _0x1c2fbb=_0x43105f;devices[_0x1a197d][_0x1c2fbb(0x20e)]={'clientip':_0x4f7b97,'timestamp':new Date()['getTime'](),'expiry':_0x12aa36},_0x12aa36!='reject'?(await tgBot[_0x1c2fbb(0x181)](_0x3edee7[_0x1c2fbb(0x1de)]['id'],'Login\x20accepted',{'parse_mode':_0x1c2fbb(0x1ba)})['catch'](_0xc6c526=>{telegramError(_0xc6c526);}),io['to'](_0x1a197d)['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot['sendMessage'](_0x3edee7[_0x1c2fbb(0x1de)]['id'],_0x1c2fbb(0x18a))['catch'](_0x3a4ff7=>{telegramError(_0x3a4ff7);}),io['to'](_0x1a197d)[_0x1c2fbb(0x298)](_0x1c2fbb(0x227),{'access':{'allow':![],'reason':_0x1c2fbb(0x281),'token':null}}));}),tgBot[_0x43105f(0x19e)]('callback_query');}));}function getConfiguration(){const _0x357655=_0xe6cde4;return dbConfig[_0x357655(0x2a6)]('bots')['sortBy']('botID')[_0x357655(0x1c8)]()||[];}function getEnabledBots(){const _0x3dca02=_0xe6cde4;return dbConfig[_0x3dca02(0x2a6)](_0x3dca02(0x209))[_0x3dca02(0x2ad)](_0x3dca02(0x1fc))[_0x3dca02(0x173)]({'status':'enabled'})[_0x3dca02(0x1c8)]()||[];}function getDisabledBots(){const _0x1b0438=_0xe6cde4;return dbConfig[_0x1b0438(0x2a6)](_0x1b0438(0x209))[_0x1b0438(0x2ad)](_0x1b0438(0x1fc))['filter']({'status':_0x1b0438(0x29a)})[_0x1b0438(0x1c8)]()||[];}function getSettings(){const _0x24b758=_0xe6cde4;return dbSettings[_0x24b758(0x2a6)](_0x24b758(0x246))[_0x24b758(0x1c8)]()||{'timeshift':0x0};}function getSecure(){const _0x443a0f=_0xe6cde4;return dbSecure['get'](_0x443a0f(0x1fe))[_0x443a0f(0x1c8)]()||{};}function getBlacklist(){const _0x368242=_0xe6cde4;return dbSecure[_0x368242(0x2a6)](_0x368242(0x1aa))[_0x368242(0x1c8)]()||[];}function broadcastToBots(_0x4442ab,_0x1c320d){config['forEach'](_0x16d982=>{const _0x34be8c=_0x5958;if(_0x16d982[_0x34be8c(0x227)]=='enabled'&&_0x16d982[_0x34be8c(0x241)]==_0x34be8c(0x231)){if(pid[_0x16d982[_0x34be8c(0x1fc)]])pid[_0x16d982[_0x34be8c(0x1fc)]]['send']({[_0x4442ab]:_0x1c320d});}});}function storeSettings(_0x3dce0d,_0x165a33=![]){const _0x3d8270=_0xe6cde4;_0x3dce0d={...settings,..._0x3dce0d};if(_0x165a33&&_0x3dce0d[_0x3d8270(0x271)]!=_0x3d8270(0x267)&&_0x3dce0d['bbPassword']!=''){const _0x1592bb=crypt[_0x3d8270(0x1d2)](secure[_0x3d8270(0x29d)],_0x3dce0d['bbPassword'])['message'][_0x3d8270(0x247)]('@')[0x0],_0xba9eb5=bcrypt[_0x3d8270(0x2a9)](_0x1592bb,saltRounds);_0x3dce0d={..._0x3dce0d,'bbPassword':_0xba9eb5};}if(_0x165a33&&_0x3dce0d[_0x3d8270(0x27f)]!=_0x3d8270(0x267)&&_0x3dce0d[_0x3d8270(0x27f)]!=''){const _0x4494d6=crypt[_0x3d8270(0x1d2)](secure[_0x3d8270(0x29d)],_0x3dce0d[_0x3d8270(0x27f)])[_0x3d8270(0x23f)][_0x3d8270(0x247)]('@')[0x0];_0x3dce0d={..._0x3dce0d,'telegramToken':_0x4494d6};}const _0xd9cfe0=_0x3dce0d['telegramToken']!='************'&&_0x3dce0d[_0x3d8270(0x27f)]!=settings['telegramToken']||_0x3dce0d['telegramUsername']!=settings[_0x3d8270(0x1c0)],_0x5a242a=_0x3dce0d[_0x3d8270(0x27f)]==''||_0x3dce0d[_0x3d8270(0x1c0)]=='';if(_0xd9cfe0)_0x3dce0d[_0x3d8270(0x1ad)]=_0x3d8270(0x19b);for(const [_0x29843e,_0x5caec3]of Object[_0x3d8270(0x172)](_0x3dce0d)){if(_0x29843e=='telegramToken'&&_0x5caec3=='************'){_0x3dce0d[_0x3d8270(0x27f)]=settings[_0x3d8270(0x27f)];continue;};if(_0x29843e==_0x3d8270(0x271)&&_0x5caec3==_0x3d8270(0x267)){_0x3dce0d['bbPassword']=settings[_0x3d8270(0x271)];continue;};dbSettings['set'](_0x3d8270(0x1a1)+_0x29843e,_0x5caec3)[_0x3d8270(0x23a)]();}settings=_0x3dce0d,io['to'](_0x3d8270(0x2a8))[_0x3d8270(0x298)]('settings',cleanSettings()),broadcastToBots(_0x3d8270(0x270),settings[_0x3d8270(0x270)]);if(_0xd9cfe0&&!_0x5a242a)initTelegram();if(_0xd9cfe0&&_0x5a242a)disableTelegram();getAllClients()[_0x3d8270(0x249)](_0x2c0dc0=>{const _0x432a64=_0x3d8270;getSocket(_0x2c0dc0['id'])[_0x432a64(0x298)]('status',{'access':{'allow':![],'reason':_0x432a64(0x1b0),'token':null}});});}function updateSetting(_0x296f77,_0x654d2){const _0x3e8293=_0xe6cde4;dbSettings[_0x3e8293(0x18e)](_0x3e8293(0x1a1)+_0x296f77,_0x654d2)[_0x3e8293(0x23a)](),settings=getSettings(),io['to'](_0x3e8293(0x2a8))[_0x3e8293(0x298)](_0x3e8293(0x246),cleanSettings());}function storeSecure(_0xb15ea4){const _0x40254a=_0xe6cde4;dbSecure[_0x40254a(0x2a6)]('secure')[_0x40254a(0x23d)](_0xb15ea4)[_0x40254a(0x23a)](),secure=_0xb15ea4;}function addBlacklist(_0x52b1a0){const _0x5eb913=_0xe6cde4;cleanBlacklist();let _0x4b5df4;devices[_0x52b1a0]['telegramIpApproval']?_0x4b5df4=Math[_0x5eb913(0x1e5)](devices[_0x52b1a0]['telegramIpApproval'][_0x5eb913(0x272)],loginExpiry):_0x4b5df4=loginExpiry,dbSecure[_0x5eb913(0x2a6)](_0x5eb913(0x1aa))[_0x5eb913(0x23d)]({'expiry':new Date()[_0x5eb913(0x277)]()+_0x4b5df4*0x3c*0x3e8,'token':devices[_0x52b1a0][_0x5eb913(0x1d0)][_0x5eb913(0x206)]})['write'](),blacklist=dbSecure[_0x5eb913(0x2a6)](_0x5eb913(0x1aa))[_0x5eb913(0x1c8)]();}function cleanBlacklist(){const _0x47f45a=_0xe6cde4;let _0x17e0b4=dbSecure[_0x47f45a(0x2a6)]('blacklist')[_0x47f45a(0x195)]()[_0x47f45a(0x1c8)](),_0x1fef0e=new Date()[_0x47f45a(0x277)]();_0x17e0b4[_0x47f45a(0x249)](_0x3ca9a0=>{const _0x173977=_0x47f45a;_0x3ca9a0[_0x173977(0x272)]<_0x1fef0e&&dbSecure[_0x173977(0x2a6)]('blacklist')[_0x173977(0x1b2)]({'expiry':_0x3ca9a0['expiry']})[_0x173977(0x23a)]();});}function initStates(){const _0x49f0fb=_0xe6cde4;let _0x1aaf33=getConfiguration();_0x1aaf33[_0x49f0fb(0x249)](_0x3fc9ff=>{const _0x503289=_0x49f0fb;_0x3fc9ff[_0x503289(0x241)]='stopped';}),storeConfiguration(_0x1aaf33);}function onKeys(){const _0x48778a=new RSA();return new Promise(_0x246aa7=>{const _0x16d9d3=_0x5958;_0x48778a['generateKeyPairAsync']()[_0x16d9d3(0x17b)](_0x3e1505=>{_0x246aa7(_0x3e1505);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1cda42=_0xe6cde4;let _0x227c2a=getConfiguration(),_0x10750a=![];_0x227c2a['forEach'](_0xa9d7ee=>{const _0x130c3c=_0x5958;if(_0xa9d7ee[_0x130c3c(0x227)]==_0x130c3c(0x231))_0xa9d7ee[_0x130c3c(0x227)]=_0x130c3c(0x215),_0x10750a=!![];else _0xa9d7ee[_0x130c3c(0x227)]==_0x130c3c(0x1ab)&&(_0xa9d7ee[_0x130c3c(0x227)]=_0x130c3c(0x29a),_0x10750a=!![]);});if(_0x10750a)storeConfiguration(_0x227c2a);let _0xf31e54=getSecure();if(!_0xf31e54[_0x1cda42(0x228)](_0x1cda42(0x1e0))){let _0x586350=await generateKeys();_0xf31e54[_0x1cda42(0x18d)]=_0x586350[_0x1cda42(0x18d)],_0xf31e54[_0x1cda42(0x29d)]=_0x586350[_0x1cda42(0x29d)],_0xf31e54[_0x1cda42(0x1e0)]=crypto[_0x1cda42(0x1f4)](0x20)[_0x1cda42(0x284)]('hex');;storeSecure(_0xf31e54);}let _0x2f1acb=getSettings();_0x10750a=![];!_0x2f1acb[_0x1cda42(0x228)](_0x1cda42(0x2a7))&&(_0x2f1acb['loginRequired']=![],_0x2f1acb[_0x1cda42(0x2ab)]='',_0x2f1acb[_0x1cda42(0x271)]='',_0x2f1acb[_0x1cda42(0x1ea)]=![],_0x10750a=!![]);!_0x2f1acb[_0x1cda42(0x228)](_0x1cda42(0x22e))&&(_0x2f1acb[_0x1cda42(0x22e)]=![],_0x2f1acb['whitelist']=[],_0x2f1acb[_0x1cda42(0x193)]=![],_0x10750a=!![]);if(!_0x2f1acb[_0x1cda42(0x228)]('telegramEnabled')){if(_0x2f1acb['telegramChatId'])_0x2f1acb[_0x1cda42(0x178)]=!![];else _0x2f1acb[_0x1cda42(0x178)]=![];_0x10750a=!![];}if(_0x10750a)storeSettings(_0x2f1acb);}function storeConfiguration(_0x7874bc){const _0xca5136=_0xe6cde4;dbConfig[_0xca5136(0x2a6)](_0xca5136(0x209))['remove']()[_0xca5136(0x23a)](),dbConfig[_0xca5136(0x2a6)](_0xca5136(0x209))[_0xca5136(0x23d)](..._0x7874bc)[_0xca5136(0x23a)](),config=_0x7874bc;}function resetPassword(){const _0x22b991=_0xe6cde4;tgBot&&settings[_0x22b991(0x27a)]&&(tgBot['removeListener'](_0x22b991(0x1ef)),tgBot['sendMessage'](settings['telegramChatId'],_0x22b991(0x1bb),{'parse_mode':_0x22b991(0x1ba),'reply_markup':{'inline_keyboard':[[{'text':_0x22b991(0x1dd),'callback_data':_0x22b991(0x1dd)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x1cedaf=>{telegramError(_0x1cedaf);}),tgBot['on'](_0x22b991(0x1ef),async _0x4c00de=>{const _0x38162b=_0x22b991,_0x4ff0ee=_0x4c00de['data'],_0xed28e5=_0x4c00de[_0x38162b(0x23f)];tgBot['answerCallbackQuery'](_0x4c00de['id'])[_0x38162b(0x17b)](async()=>{const _0x518620=_0x38162b;if(_0x4ff0ee!='no'){const _0x3c1e33=0xf,_0x5f2f38=_0x518620(0x20d),_0x4dabff=Array[_0x518620(0x190)](crypto[_0x518620(0x25b)](new Uint32Array(_0x3c1e33)))[_0x518620(0x203)](_0x56d6fd=>_0x5f2f38[_0x56d6fd%_0x5f2f38[_0x518620(0x28f)]])[_0x518620(0x1b1)](''),_0x434da2=bcrypt[_0x518620(0x2a9)](_0x4dabff,saltRounds);storeSettings({'bbPassword':_0x434da2}),await tgBot['sendMessage'](_0xed28e5[_0x518620(0x1de)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x4dabff,{'parse_mode':_0x518620(0x1ba)})[_0x518620(0x235)](_0x15ea98=>{telegramError(_0x15ea98);});}else await tgBot['sendMessage'](_0xed28e5[_0x518620(0x1de)]['id'],_0x518620(0x1e9))[_0x518620(0x235)](_0x130ad9=>{telegramError(_0x130ad9);});}),tgBot['removeListener']('callback_query');}));}function logging(_0x47f18e){const _0x524dbf=_0xe6cde4;console[_0x524dbf(0x259)](getTimeStamp()+_0x524dbf(0x201)+_0x47f18e);if(tgBot&&settings['telegramChatId']&&settings[_0x524dbf(0x1ad)]!=_0x524dbf(0x2a1))tgBot[_0x524dbf(0x181)](settings[_0x524dbf(0x27a)],'Bot\x20Mgr\x20>\x20'+_0x47f18e)[_0x524dbf(0x235)](_0x1b2d3f=>{telegramError(_0x1b2d3f);});}function getServerTime(){const _0x1a6eb4=_0xe6cde4,_0x45fc9e=new Date();return _0x45fc9e[_0x1a6eb4(0x214)]()+'/'+(_0x45fc9e[_0x1a6eb4(0x21f)]()+0x1)[_0x1a6eb4(0x284)]()[_0x1a6eb4(0x286)](0x2,'0')+'/'+_0x45fc9e[_0x1a6eb4(0x20f)]()[_0x1a6eb4(0x284)]()[_0x1a6eb4(0x286)](0x2,'0')+'\x20'+_0x45fc9e[_0x1a6eb4(0x20b)]()['toString']()[_0x1a6eb4(0x286)](0x2,'0')+':'+_0x45fc9e[_0x1a6eb4(0x204)]()[_0x1a6eb4(0x284)]()[_0x1a6eb4(0x286)](0x2,'0')+':'+_0x45fc9e[_0x1a6eb4(0x18b)]()[_0x1a6eb4(0x284)]()[_0x1a6eb4(0x286)](0x2,'0');}function getTimeStamp(){const _0xf3c82b=_0xe6cde4,_0x48024a=shiftedTime();return _0x48024a[_0xf3c82b(0x214)]()+'/'+(_0x48024a[_0xf3c82b(0x21f)]()+0x1)['toString']()[_0xf3c82b(0x286)](0x2,'0')+'/'+_0x48024a[_0xf3c82b(0x20f)]()[_0xf3c82b(0x284)]()[_0xf3c82b(0x286)](0x2,'0')+'\x20'+_0x48024a[_0xf3c82b(0x20b)]()[_0xf3c82b(0x284)]()[_0xf3c82b(0x286)](0x2,'0')+':'+_0x48024a[_0xf3c82b(0x204)]()['toString']()[_0xf3c82b(0x286)](0x2,'0')+':'+_0x48024a['getSeconds']()[_0xf3c82b(0x284)]()[_0xf3c82b(0x286)](0x2,'0');}function shiftedTime(){const _0x447b13=_0xe6cde4,_0x36130b=new Date();let _0xd33676=_0x36130b;if(settings[_0x447b13(0x270)]&&settings[_0x447b13(0x270)]!==0x0)_0xd33676=fns[_0x447b13(0x200)](_0x36130b,{'hours':settings[_0x447b13(0x270)]});return _0xd33676;}function startScheduler(){const _0x918261=_0xe6cde4;let _0x52ad73=new Date()[_0x918261(0x1a4)]();_0x52ad73==0x1&&backupConfigFiles();_0x52ad73==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x3ebe7b=_0xe6cde4;fs[_0x3ebe7b(0x17e)](configpath,{'withFileTypes':!![]})[_0x3ebe7b(0x249)](_0x2bec8d=>{const _0x400619=_0x3ebe7b;if(!_0x2bec8d[_0x400619(0x280)]())fs['copyFileSync'](configpath+_0x2bec8d[_0x400619(0x1d6)],configbackuppath+_0x2bec8d[_0x400619(0x1d6)]);});}function triggerAnalytics(){const _0xa01bd6=_0xe6cde4;analytics[_0xa01bd6(0x1fd)]({'title':_0xa01bd6(0x25f),'href':_0xa01bd6(0x22b),'path':'/v'+serverversion});}function _0x5958(_0x3e99b0,_0x736673){const _0x3a092d=_0x2a01();return _0x5958=function(_0x489be9,_0x229791){_0x489be9=_0x489be9-0x172;let _0x2a018a=_0x3a092d[_0x489be9];return _0x2a018a;},_0x5958(_0x3e99b0,_0x736673);}function validateCredentials(_0x43518f,_0x3643ed){const _0x2762bb=_0xe6cde4;if(_0x43518f[_0x2762bb(0x20c)]==settings['bbUsername']&&bcrypt[_0x2762bb(0x21b)](_0x43518f[_0x2762bb(0x22d)],settings[_0x2762bb(0x271)])){if(settings[_0x2762bb(0x1ea)])return{'allow':![],'reason':_0x2762bb(0x299),'token':null};else{const _0xdc28ce=generateLoginToken(_0x3643ed);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0xdc28ce};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x2bc36b){const _0x564d9e=_0xe6cde4,_0x4aef3c=generateLoginToken(_0x2bc36b);return{'allow':!![],'reason':_0x564d9e(0x1a3),'token':_0x4aef3c};}function validateAccess(_0x52fd43,_0xe0eaa1){const _0xc22db6=_0xe6cde4;let _0x33a758=devices[_0xe0eaa1]['ip'],_0x2426e2;const _0xa3ae47=_0x4d3ac0=>{const _0x425b7d=_0x5958;if(settings[_0x425b7d(0x2a7)]){if(settings[_0x425b7d(0x1ea)]){if(telegram2FaApproved(_0xe0eaa1)){const _0xc21458=generateLoginToken(_0xe0eaa1);return{'allow':!![],'reason':_0x425b7d(0x230),'token':_0xc21458};}else return{'allow':![],'reason':_0x425b7d(0x252),'token':null};}else return _0x2426e2=validToken(_0x4d3ac0,_0xe0eaa1),_0x2426e2[_0x425b7d(0x228)](_0x425b7d(0x19d))?{'allow':!![],'reason':_0x425b7d(0x224),'token':_0x4d3ac0}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x425b7d(0x19c),'token':null};};if(settings[_0xc22db6(0x22e)]){let _0x168c63=[...settings[_0xc22db6(0x189)],_0xc22db6(0x28c),_0xc22db6(0x184),_0xc22db6(0x22c)];if(_0x168c63[_0xc22db6(0x176)](_0x33a758))return _0xa3ae47(_0x52fd43);else{_0x2426e2=validToken(_0x52fd43,_0xe0eaa1);if(_0x2426e2['hasOwnProperty'](_0xc22db6(0x19d)))return _0xa3ae47(_0x52fd43);else{if(telegramIpApproved(_0xe0eaa1)){const _0x587dea=generateToken(_0xe0eaa1);return _0x2426e2=_0xa3ae47(_0x52fd43),_0x2426e2[_0xc22db6(0x1f5)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x587dea}:_0x2426e2;}else return settings[_0xc22db6(0x193)]?{'allow':![],'reason':_0xc22db6(0x2a3),'token':null}:{'allow':![],'reason':_0xc22db6(0x199),'token':null};}}}else return _0xa3ae47(_0x52fd43);}function timelyDecrypt(_0x5ca370,_0x29b984=!![]){const _0x117306=_0xe6cde4;if(_0x5ca370)try{const _0x480a42=crypt[_0x117306(0x1d2)](secure['privateKey'],_0x5ca370)['message'],_0x31c106=_0x480a42[_0x117306(0x247)]('@')[0x0],_0x5e78ec=_0x480a42[_0x117306(0x247)]('@')[0x1],_0x381f9e=new Date()[_0x117306(0x277)]();if(_0x29b984){if(_0x381f9e-_0x5e78ec<maxSecretAge*0x3e8)return _0x31c106;else return![];}else return _0x31c106;}catch(_0x4304c2){return![];}else return![];}const validToken=(_0x16cbb9,_0x2d07d6)=>{const _0x3c54b9=_0xe6cde4,_0x524c43=devices[_0x2d07d6]['ip'];if(!_0x16cbb9)return{'error':'No\x20authentication\x20token'};for(let _0xc25baa of blacklist){if(_0xc25baa['token']==_0x16cbb9)return{'error':_0x3c54b9(0x1e6)};}let _0xadb400;try{_0xadb400=jwt[_0x3c54b9(0x293)](_0x16cbb9,secure[_0x3c54b9(0x1e0)]+_0x2d07d6);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0xadb400[_0x3c54b9(0x228)](_0x3c54b9(0x1fa))&&!_0xadb400[_0x3c54b9(0x228)]('username')||!_0xadb400[_0x3c54b9(0x228)](_0x3c54b9(0x222)))return{'error':_0x3c54b9(0x260)};if(!_0xadb400[_0x3c54b9(0x228)]('username')&&_0xadb400[_0x3c54b9(0x228)]('clientip')){const {clientip:_0x28825c}=_0xadb400;return _0x524c43==_0x28825c?{'success':_0x3c54b9(0x291)}:{'error':_0x3c54b9(0x27e)};}else{if(_0xadb400[_0x3c54b9(0x228)]('username')&&_0xadb400[_0x3c54b9(0x228)](_0x3c54b9(0x1fa))){const {username:_0x295a4a,clientip:_0xcfca0b}=_0xadb400;return settings[_0x3c54b9(0x2ab)]==_0x295a4a&&_0x524c43==_0xcfca0b?{'success':_0x3c54b9(0x291)}:{'error':_0x3c54b9(0x174)};}}},generateLoginToken=_0x239f20=>{const _0x4e5f6f=_0xe6cde4;if(_0x239f20){const _0x299105=devices[_0x239f20]['ip'];return jwt[_0x4e5f6f(0x24c)]({'username':settings[_0x4e5f6f(0x2ab)],'clientip':_0x299105},secure[_0x4e5f6f(0x1e0)]+_0x239f20,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x2b35de=>{const _0xb2500f=_0xe6cde4;if(_0x2b35de){const _0xb69c64=devices[_0x2b35de]['ip'];return jwt['sign']({'clientip':_0xb69c64},secure[_0xb2500f(0x1e0)]+_0x2b35de,{'expiresIn':devices[_0x2b35de][_0xb2500f(0x1ca)][_0xb2500f(0x272)]*0x3c});}else return![];},telegramIpApproved=_0x2febda=>{const _0x15c7a0=_0xe6cde4;let _0x4aed0c=![];return devices[_0x2febda][_0x15c7a0(0x1ca)]&&devices[_0x2febda][_0x15c7a0(0x1ca)][_0x15c7a0(0x272)]!=_0x15c7a0(0x240)&&(_0x4aed0c=devices[_0x2febda][_0x15c7a0(0x1ca)][_0x15c7a0(0x1fa)]==devices[_0x2febda]['ip']&&new Date()[_0x15c7a0(0x277)]()-devices[_0x2febda][_0x15c7a0(0x1ca)][_0x15c7a0(0x2a2)]<devices[_0x2febda]['telegramIpApproval']['expiry']*0x3c*0x3e8),_0x4aed0c;},telegram2FaApproved=_0x1aa603=>{const _0x58e776=_0xe6cde4;let _0x2517f6=![];return devices[_0x1aa603][_0x58e776(0x20e)]&&devices[_0x1aa603]['telegram2FaApproval'][_0x58e776(0x272)]!=_0x58e776(0x240)&&(_0x2517f6=devices[_0x1aa603][_0x58e776(0x20e)][_0x58e776(0x1fa)]==devices[_0x1aa603]['ip']&&new Date()[_0x58e776(0x277)]()-devices[_0x1aa603]['telegram2FaApproval']['timestamp']<devices[_0x1aa603]['telegram2FaApproval'][_0x58e776(0x272)]*0x3c*0x3e8),_0x2517f6;},normalizeIP=_0x5ec0bb=>{const _0x190043=_0xe6cde4;let _0x1477b5=null,_0x57af35=null;if(ipaddr['isValid'](_0x5ec0bb)){const _0x1c734c=ipaddr[_0x190043(0x1a2)](_0x5ec0bb);_0x1c734c[_0x190043(0x26b)]()===_0x190043(0x20a)?(_0x1c734c['isIPv4MappedAddress']()&&(_0x1477b5=_0x1c734c[_0x190043(0x288)]()[_0x190043(0x284)]()),_0x57af35=_0x1c734c[_0x190043(0x284)]()):(_0x1477b5=_0x1c734c[_0x190043(0x284)](),_0x57af35=_0x1c734c['toIPv4MappedAddress']()[_0x190043(0x284)]());}return{'show':_0x1477b5?_0x1477b5:_0x57af35,'store':_0x57af35};};