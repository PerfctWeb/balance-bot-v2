const _0x5d70db=_0x3dd0;(function(_0x7ff24f,_0x2c0b59){const _0xb05e2f=_0x3dd0,_0x588895=_0x7ff24f();while(!![]){try{const _0x1297c1=parseInt(_0xb05e2f(0x1d5))/0x1+-parseInt(_0xb05e2f(0x10f))/0x2*(parseInt(_0xb05e2f(0x1d0))/0x3)+parseInt(_0xb05e2f(0x16a))/0x4*(parseInt(_0xb05e2f(0x1b2))/0x5)+-parseInt(_0xb05e2f(0x163))/0x6+-parseInt(_0xb05e2f(0x1c6))/0x7*(-parseInt(_0xb05e2f(0x180))/0x8)+-parseInt(_0xb05e2f(0x121))/0x9*(parseInt(_0xb05e2f(0x1d3))/0xa)+parseInt(_0xb05e2f(0x192))/0xb;if(_0x1297c1===_0x2c0b59)break;else _0x588895['push'](_0x588895['shift']());}catch(_0xf13594){_0x588895['push'](_0x588895['shift']());}}}(_0x5a6d,0x3cf1a));const _0x5beda9=function(){let _0x5213c6=!![];return function(_0x206523,_0x1c3869){const _0x29394d=_0x5213c6?function(){const _0x3fb73d=_0x3dd0;if(_0x1c3869){const _0x106ee8=_0x1c3869[_0x3fb73d(0x19c)](_0x206523,arguments);return _0x1c3869=null,_0x106ee8;}}:function(){};return _0x5213c6=![],_0x29394d;};}(),_0x5983ab=_0x5beda9(this,function(){const _0xc2c707=_0x3dd0;return _0x5983ab['toString']()[_0xc2c707(0x158)](_0xc2c707(0x12b))[_0xc2c707(0x216)]()['constructor'](_0x5983ab)[_0xc2c707(0x158)](_0xc2c707(0x12b));});_0x5983ab();'use strict';process[_0x5d70db(0x21a)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x5d70db(0x212)),FileSync=require(_0x5d70db(0x1e5)),fs=require('fs'),fns=require(_0x5d70db(0x166)),low=require(_0x5d70db(0x13f)),path=require('path'),crypto=require(_0x5d70db(0x124)),Crypt=require(_0x5d70db(0x13c))[_0x5d70db(0x196)],RSA=require('hybrid-crypto-js')[_0x5d70db(0x21e)],bcrypt=require(_0x5d70db(0x1ec)),jwt=require(_0x5d70db(0x191)),analyticsLib=require(_0x5d70db(0x218))['default'],googleAnalytics=require(_0x5d70db(0x171))[_0x5d70db(0x16e)],ipaddr=require(_0x5d70db(0x149));let bbpath=_0x5d70db(0x1eb);const botfile=_0x5d70db(0x1c0),configfile='bb-config.json',settingsfile=_0x5d70db(0x1d9),securefile=_0x5d70db(0x217);!fs[_0x5d70db(0x117)](bbpath+botfile)&&(bbpath='');const configpath=bbpath+_0x5d70db(0x1b5);!fs[_0x5d70db(0x117)](configpath)&&fs[_0x5d70db(0x1ab)](configpath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x5d70db(0x215)]({'bots':[]})[_0x5d70db(0x17a)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0}})[_0x5d70db(0x17a)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x5d70db(0x215)]({'secure':{},'blacklist':[]})[_0x5d70db(0x17a)]();let crypt=new Crypt({'md':_0x5d70db(0x113),'rsaStandard':_0x5d70db(0x1c3)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[],socket=[],serverStatus=[];function _0x3dd0(_0x520171,_0x2b0e7b){const _0x2b9c8d=_0x5a6d();return _0x3dd0=function(_0x5983ab,_0x5beda9){_0x5983ab=_0x5983ab-0x10d;let _0x5a6d82=_0x2b9c8d[_0x5983ab];return _0x5a6d82;},_0x3dd0(_0x520171,_0x2b0e7b);}const serverversion=require('./'+bbpath+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x3c,tokenRefresh=0x5;let lastIpApproval,telegramIpApproval,telegram2FaApproval,accessControl,token,uuid,externalip,pidExpireLogin,pidRefreshToken,pidAnalytics;oneTimeMigration(),cleanBlacklist();const PORT=0xbb8,express=require(_0x5d70db(0x17e)),app=express(),http=require(_0x5d70db(0x1c2))[_0x5d70db(0x156)](app);app[_0x5d70db(0x175)](express['static'](path[_0x5d70db(0x177)](__dirname,bbpath,_0x5d70db(0x219)))),app[_0x5d70db(0x175)](express[_0x5d70db(0x1dd)](path['join'](__dirname,bbpath,_0x5d70db(0x143)))),app['get']('/',function(_0x312717,_0x5d16d5){const _0x3335e1=_0x5d70db;_0x5d16d5['sendFile'](path['join'](__dirname,bbpath,_0x3335e1(0x219),'index.html'));}),app[_0x5d70db(0x148)]('/:bot',function(_0x3c661b,_0xa15deb){const _0x522e92=_0x5d70db;_0xa15deb[_0x522e92(0x226)](path[_0x522e92(0x177)](__dirname,bbpath,_0x522e92(0x143),_0x522e92(0x11f)));}),app[_0x5d70db(0x148)]('/:bot/portfolio',(_0x8ee596,_0x2b944f)=>{const _0x1c8fe9=_0x5d70db;_0x2b944f[_0x1c8fe9(0x226)](path[_0x1c8fe9(0x177)](__dirname,bbpath,'build',_0x1c8fe9(0x11f)));}),app[_0x5d70db(0x148)](_0x5d70db(0x125),(_0x3b1eb8,_0x5c8b15)=>{const _0xcf7668=_0x5d70db;_0x5c8b15['sendFile'](path[_0xcf7668(0x177)](__dirname,bbpath,_0xcf7668(0x143),_0xcf7668(0x11f)));}),app[_0x5d70db(0x148)](_0x5d70db(0x1bd),(_0x3833e3,_0x3460be)=>{const _0x17fcfa=_0x5d70db;_0x3460be[_0x17fcfa(0x226)](path[_0x17fcfa(0x177)](__dirname,bbpath,_0x17fcfa(0x143),'index.html'));}),app['get'](_0x5d70db(0x20d),(_0x2d040f,_0x102719)=>{const _0x20798d=_0x5d70db;_0x102719[_0x20798d(0x226)](path[_0x20798d(0x177)](__dirname,bbpath,_0x20798d(0x143),'index.html'));}),app[_0x5d70db(0x148)](_0x5d70db(0x1f9),(_0x5ec500,_0x19a484)=>{const _0x138422=_0x5d70db;_0x19a484[_0x138422(0x226)](path['join'](__dirname,bbpath,'build',_0x138422(0x11f)));}),app[_0x5d70db(0x148)](_0x5d70db(0x139),(_0x418b29,_0x587edf)=>{const _0xf1beb7=_0x5d70db;_0x587edf['sendFile'](path['join'](__dirname,bbpath,_0xf1beb7(0x143),_0xf1beb7(0x11f)));}),http[_0x5d70db(0x1b6)](PORT);const analytics=analyticsLib({'app':_0x5d70db(0x22b),'plugins':[googleAnalytics({'trackingId':_0x5d70db(0x183)})]}),TelegramBot=require(_0x5d70db(0x1d6));let tgBot;if(settings[_0x5d70db(0x146)]&&settings[_0x5d70db(0x146)]!=''&&settings['telegramUsername']&&settings[_0x5d70db(0x1fa)]!='')initTelegram();initStates(),startServer(),startSocket(),startAnalytics();function startServer(){const _0x1d291b=_0x5d70db;console[_0x1d291b(0x1c4)](''),console[_0x1d291b(0x1c4)](_0x1d291b(0x11c)),logging(_0x1d291b(0x170)+PORT),console[_0x1d291b(0x1c4)]('-----------------------------------------------------------------------------------');if(config['length']!=0x0)config[_0x1d291b(0x1ce)](_0x43dbc1=>{const _0x3df02d=_0x1d291b;if(_0x43dbc1['status']=='enabled'||_0x43dbc1[_0x3df02d(0x1dc)]=='new')logging(_0x3df02d(0x1f7)+_0x43dbc1['botID']+_0x3df02d(0x19a)+_0x43dbc1['botname']),startBot([_0x43dbc1[_0x3df02d(0x224)]],{'cwd':bbpath},function(_0x49014b){if(_0x49014b)logging(_0x49014b);});else(_0x43dbc1[_0x3df02d(0x1dc)]==_0x3df02d(0x140)||_0x43dbc1['status']==_0x3df02d(0x223))&&logging(_0x3df02d(0x165)+_0x43dbc1[_0x3df02d(0x224)]+_0x3df02d(0x19a)+_0x43dbc1[_0x3df02d(0x19b)]);});else!newBot&&console[_0x1d291b(0x1c4)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();console[_0x1d291b(0x1c4)](_0x1d291b(0x11c)),console['log']('');}function startSocket(){const _0x304ef4=_0x5d70db,_0x367b8e=require('socket.io')(http,{});_0x367b8e['on'](_0x304ef4(0x207),_0x25b76d=>{const _0x1e45b3=_0x304ef4;let _0x3bb891,_0x4e81b5,_0x345ec5;const _0x559f69=_0x25b76d[_0x1e45b3(0x185)][_0x1e45b3(0x16b)][_0x1e45b3(0x1e4)],_0xb9dba4=_0x25b76d['handshake']['auth'][_0x1e45b3(0x162)];if(!_0xb9dba4)_0x25b76d['emit'](_0x1e45b3(0x1dc),{'publicKey':secure[_0x1e45b3(0x21d)]});else{uuid=timelyDecrypt(_0x25b76d[_0x1e45b3(0x185)]['auth'][_0x1e45b3(0x162)],![]),_0x4e81b5=_0x559f69[_0x1e45b3(0x1ca)](/bot[0-9]{3}/);if(_0x4e81b5)_0x345ec5=_0x4e81b5[0x0][_0x1e45b3(0x1ca)](/[0-9]{3}/);if(_0x345ec5)_0x3bb891=_0x345ec5[0x0];else _0x3bb891=_0x1e45b3(0x19d);if(socket[_0x3bb891])socket[_0x3bb891][_0x1e45b3(0x188)](!![]);socket[_0x3bb891]=_0x25b76d,setAccess(_0x3bb891);if(accessControl[_0x1e45b3(0x1a3)]){if(_0x3bb891==_0x1e45b3(0x19d))initializeSocketBotManager();else initializeSocketBot(_0x3bb891);}if(!serverStatus[_0x3bb891])serverStatus[_0x3bb891]=_0x1e45b3(0x169);socket[_0x3bb891]['on'](_0x1e45b3(0x20b),_0x26d6d6=>{const _0x32937f=_0x1e45b3,_0x4bb15e=timelyDecrypt(_0x26d6d6['password']);if(_0x4bb15e){_0x26d6d6={'username':_0x26d6d6['username'],'password':_0x4bb15e};let _0x103366=validateCredentials(_0x26d6d6);if(_0x103366[_0x32937f(0x1a3)]==![]&&_0x103366[_0x32937f(0x1c7)]==_0x32937f(0x15c))socket[_0x3bb891][_0x32937f(0x11b)](_0x32937f(0x1dc),{'access':_0x103366}),loginAccess2FA(externalip);else{if(_0x103366[_0x32937f(0x1a3)]==![]&&_0x103366[_0x32937f(0x1c7)]=='invalid\x20credentials')socket[_0x3bb891]['emit'](_0x32937f(0x1dc),{'access':_0x103366});else{if(_0x103366[_0x32937f(0x1a3)]&&_0x103366[_0x32937f(0x1c7)]==_0x32937f(0x1f2)){token=_0x103366[_0x32937f(0x147)];for(let _0x22054f in socket){if(_0x22054f==_0x32937f(0x19d))initializeSocketBotManager();else initializeSocketBot(_0x22054f);socket[_0x22054f][_0x32937f(0x11b)](_0x32937f(0x1dc),{'status':serverStatus[_0x22054f]||'starting','serverversion':serverversion,'servertime':getServerTime(),'access':_0x103366,'externalip':externalip,'publicKey':secure[_0x32937f(0x21d)],'loginNow':![]});}setTokenRefresh(),setSessionTimeout(_0x32937f(0x20b));}}}}else logging(_0x32937f(0x17f));}),socket[_0x3bb891]['on']('reset-password',()=>{resetPassword();}),socket[_0x3bb891]['on'](_0x1e45b3(0x188),_0xe0d5bc=>{let _0x571393=[];for(let _0x510b32 in socket){if(_0x510b32!=_0x3bb891)_0x571393[_0x510b32]=socket[_0x510b32];}socket=_0x571393;});if(_0x3bb891!=_0x1e45b3(0x19d)&&config[_0x1e45b3(0x16f)]!=''){if(pid[_0x3bb891])pid[_0x3bb891]['send']({'function':_0x1e45b3(0x18a),'args':null});}}});}function setAccess(_0x60bb94){const _0x4a618a=_0x5d70db;externalip=normalizeIP(socket[_0x60bb94][_0x4a618a(0x19f)][_0x4a618a(0x130)])[_0x4a618a(0x1da)],accessControl=validateAccess(token),accessControl['token']&&accessControl['reason']=='temporary\x20token\x20generated'&&setSessionTimeout('2FA'),accessControl[_0x4a618a(0x147)]&&accessControl[_0x4a618a(0x1c7)]==_0x4a618a(0x13a)&&setSessionTimeout(_0x4a618a(0x20b)),socket[_0x60bb94]['emit'](_0x4a618a(0x1dc),{'status':serverStatus[_0x60bb94]||_0x4a618a(0x10d),'serverversion':serverversion,'servertime':getServerTime(),'access':accessControl,'externalip':externalip,'publicKey':secure['publicKey'],'loginNow':accessControl[_0x4a618a(0x1c7)]==_0x4a618a(0x18c)||accessControl[_0x4a618a(0x1c7)]=='2FA\x20login\x20required'}),accessControl['allow']==![]&&accessControl[_0x4a618a(0x1c7)]==_0x4a618a(0x20c)&&temporaryAccess2FA(externalip);}function setSessionTimeout(_0x4b3fdd){const _0x7e3a35=_0x5d70db;let _0x1d2a83;if(_0x4b3fdd==_0x7e3a35(0x20b))_0x1d2a83=loginExpiry*0x3c*0x3e8;else _0x1d2a83=telegramIpApproval[_0x7e3a35(0x18d)]*0x3c*0x3e8-(new Date()[_0x7e3a35(0x150)]()-telegramIpApproval[_0x7e3a35(0x1d2)]);if(pidExpireLogin)clearTimeout(pidExpireLogin);pidExpireLogin=setTimeout(()=>{const _0x3af683=_0x7e3a35;if(pidRefreshToken)clearTimeout(pidRefreshToken);addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null;let _0x2a9bfd=validateAccess(token);if(!(_0x2a9bfd[_0x3af683(0x1a3)]&&_0x2a9bfd['reason']==_0x3af683(0x182)))for(let _0x50fb75 in socket){socket[_0x50fb75]['emit'](_0x3af683(0x1dc),{'access':{'allow':![],'reason':'access\x20timeout','token':null}});}token=null;},_0x1d2a83);}function setTokenRefresh(){if(pidRefreshToken)clearTimeout(pidRefreshToken);pidRefreshToken=setTimeout(()=>{const _0x269939=_0x3dd0;let _0x3fa0b7=refreshToken();for(let _0x3abd15 in socket){socket[_0x3abd15][_0x269939(0x11b)](_0x269939(0x1dc),{'status':serverStatus[_0x3abd15]||'starting','serverversion':serverversion,'servertime':getServerTime(),'access':_0x3fa0b7,'externalip':externalip,'publicKey':secure[_0x269939(0x21d)],'loginNow':![]});}setTokenRefresh();},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(){const _0x4cb76c=_0x5d70db;socket[_0x4cb76c(0x19d)][_0x4cb76c(0x11b)](_0x4cb76c(0x17d),config),socket[_0x4cb76c(0x19d)][_0x4cb76c(0x11b)](_0x4cb76c(0x1e9),cleanSettings()),socket[_0x4cb76c(0x19d)]['on'](_0x4cb76c(0x210),_0x130e61=>{const _0xf273cb=_0x4cb76c;if(validateAccess(_0x130e61)[_0xf273cb(0x1a3)])addBot();else logging('Unauthorized\x20attempt\x20to\x20add\x20bot');}),socket[_0x4cb76c(0x19d)]['on'](_0x4cb76c(0x15a),(_0x5b940f,_0x251039)=>{const _0x2b5970=_0x4cb76c;if(validateAccess(_0x251039)[_0x2b5970(0x1a3)])toggleBot(_0x5b940f['botID'],_0x5b940f[_0x2b5970(0x1dc)],_0x5b940f['live']);else logging(_0x2b5970(0x1fc));}),socket['botmanager']['on']('delete-bot',(_0x109cc7,_0x3ee75c)=>{const _0x4e243e=_0x4cb76c;if(validateAccess(_0x3ee75c)['allow'])deleteBot(_0x109cc7);else logging(_0x4e243e(0x1cf));}),socket[_0x4cb76c(0x19d)]['on'](_0x4cb76c(0x120),(_0x2723f4,_0x27395d)=>{if(validateAccess(_0x27395d)['allow'])storeSettings(_0x2723f4,!![]);else logging('Unauthorized\x20attempt\x20to\x20update\x20settings');}),socket['botmanager']['on'](_0x4cb76c(0x18e),_0x25b7c8=>{const _0x1430fb=_0x4cb76c;if(validateAccess(_0x25b7c8)[_0x1430fb(0x1a3)]){if(pidRefreshToken)clearTimeout(pidRefreshToken);if(pidExpireLogin)clearTimeout(pidExpireLogin);removeSocketListeners(),addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null,token=null;for(let _0x1c66a9 in socket){socket[_0x1c66a9][_0x1430fb(0x11b)](_0x1430fb(0x1dc),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}}else logging(_0x1430fb(0x14c));});}function initializeSocketBot(_0x2bff6c){const _0x42f919=_0x5d70db;socket[_0x2bff6c]['on'](_0x42f919(0x11d),(_0x4b3618,_0xdae54)=>{const _0x295b47=_0x42f919;if(validateAccess(_0xdae54)[_0x295b47(0x1a3)]){if(pid[_0x2bff6c])pid[_0x2bff6c][_0x295b47(0x1a2)]({'function':_0x295b47(0x220),'args':_0x4b3618});}else logging(_0x295b47(0x1c9));}),socket[_0x2bff6c]['on']('get-portfolio',(_0x48b916,_0x3e7306)=>{const _0x1a9008=_0x42f919;if(validateAccess(_0x3e7306)[_0x1a9008(0x1a3)]){if(pid[_0x2bff6c])pid[_0x2bff6c][_0x1a9008(0x1a2)]({'function':'getPortfolio','args':_0x48b916});}else logging('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),socket[_0x2bff6c]['on']('store-configuration',(_0x441bd6,_0x491d9d)=>{const _0x84e9be=_0x42f919;if(validateAccess(_0x491d9d)[_0x84e9be(0x1a3)]){if(pid[_0x2bff6c])pid[_0x2bff6c][_0x84e9be(0x1a2)]({'function':_0x84e9be(0x1e1),'args':_0x441bd6});}else logging(_0x84e9be(0x186));}),socket[_0x2bff6c]['on']('store-headless',(_0x2ae6a9,_0x4eeffb)=>{const _0x49ed04=_0x42f919;if(validateAccess(_0x4eeffb)[_0x49ed04(0x1a3)]){if(pid[_0x2bff6c])pid[_0x2bff6c][_0x49ed04(0x1a2)]({'function':_0x49ed04(0x22a),'args':_0x2ae6a9});}else logging(_0x49ed04(0x18b));}),socket[_0x2bff6c]['on'](_0x42f919(0x1a6),_0x3df53e=>{const _0x2c5f02=_0x42f919;if(validateAccess(_0x3df53e)['allow']){if(pid[_0x2bff6c])pid[_0x2bff6c][_0x2c5f02(0x1a2)]({'function':_0x2c5f02(0x197),'args':null});}else logging('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),socket[_0x2bff6c]['on'](_0x42f919(0x204),(_0x40faac,_0x55901f)=>{const _0x8490c3=_0x42f919;if(validateAccess(_0x55901f)[_0x8490c3(0x1a3)]){if(pid[_0x2bff6c])pid[_0x2bff6c]['send']({'function':_0x8490c3(0x13d),'args':_0x40faac});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),socket[_0x2bff6c]['on'](_0x42f919(0x18e),_0x1950f3=>{const _0x265c94=_0x42f919;if(validateAccess(_0x1950f3)['allow']){if(pidRefreshToken)clearTimeout(pidRefreshToken);if(pidExpireLogin)clearTimeout(pidExpireLogin);removeSocketListeners(),addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null,token=null;for(let _0x1f2ada in socket){socket[_0x1f2ada]['emit'](_0x265c94(0x1dc),{'access':{'allow':![],'reason':_0x265c94(0x161),'token':null}});}}else logging(_0x265c94(0x14c));});}function removeSocketListeners(){const _0x59bae7=_0x5d70db;for(let _0x5be66e in socket){socket[_0x5be66e][_0x59bae7(0x1b7)]();}}function cleanSettings(){const _0x4b51b4=_0x5d70db;let _0x2ae016=settings;return settings[_0x4b51b4(0x146)]&&settings[_0x4b51b4(0x146)]!=''&&(_0x2ae016={..._0x2ae016,'telegramToken':'************'}),settings[_0x4b51b4(0x114)]&&settings[_0x4b51b4(0x114)]!=''&&(_0x2ae016={..._0x2ae016,'bbPassword':_0x4b51b4(0x206)}),_0x2ae016;}function startBot(_0x50d23a,_0x4c996f,_0x16ce56){const _0x39fe39=_0x5d70db;let _0x1734e8=![];const _0x2a57fd=_0x50d23a[0x0];_0x4c996f={..._0x4c996f,'stdio':['inherit',_0x39fe39(0x20f),'inherit','ipc']},pid[_0x2a57fd]=childProcess[_0x39fe39(0x14d)](botfile,_0x50d23a,_0x4c996f),pid[_0x2a57fd]['on'](_0x39fe39(0x1af),_0x5ef582=>{const _0xdda4aa=_0x39fe39;switch(Object[_0xdda4aa(0x1bc)](_0x5ef582)[0x0]){case _0xdda4aa(0x19b):updateBotName(_0x2a57fd,_0x5ef582[_0xdda4aa(0x19b)]);break;case'status':updateStatus(_0x2a57fd,_0x5ef582[_0xdda4aa(0x1dc)]);break;case _0xdda4aa(0x200):updateLive(_0x2a57fd,_0x5ef582['live']);break;case'started':updateLive(_0x2a57fd,_0x5ef582[_0xdda4aa(0x1b8)]);if(socket[_0x2a57fd])socket[_0x2a57fd][_0xdda4aa(0x11b)](_0xdda4aa(0x1dc),{'access':{'allow':![],'reason':_0xdda4aa(0x209),'token':null}});break;case _0xdda4aa(0x228):sendTelegram(_0x2a57fd,_0x5ef582[_0xdda4aa(0x228)]);break;case _0xdda4aa(0x134):if(socket[_0x2a57fd])socket[_0x2a57fd][_0xdda4aa(0x11b)](_0x5ef582[_0xdda4aa(0x134)],_0x5ef582[_0xdda4aa(0x1cd)]);break;}}),pid[_0x2a57fd]['on'](_0x39fe39(0x115),function(_0x3c8f21){if(_0x1734e8)return;_0x1734e8=!![],_0x16ce56(_0x3c8f21);}),pid[_0x2a57fd]['on']('exit',function(_0x5ec25d){const _0x3ca529=_0x39fe39;if(_0x1734e8)return;_0x1734e8=!![],_0x16ce56(null);const _0x3c5bac=dbConfig[_0x3ca529(0x148)]('bots')['find']({'botID':_0x2a57fd})[_0x3ca529(0x155)]();_0x3c5bac&&(_0x3c5bac[_0x3ca529(0x1dc)]==_0x3ca529(0x126)||_0x3c5bac[_0x3ca529(0x1dc)]=='new')&&(updateLive(_0x2a57fd,_0x3ca529(0x1f3)),_0x5ec25d!=0x4d&&(logging('restarting\x20Bot\x20'+_0x2a57fd),startBot([_0x2a57fd],{'cwd':bbpath},function(_0x32910d){if(_0x32910d)logging(_0x32910d);})));});}function stopBot(_0x162a17){const _0xf893ed=_0x5d70db;if(socket[_0x162a17])socket[_0x162a17][_0xf893ed(0x188)](!![]);if(pid[_0x162a17])pid[_0x162a17][_0xf893ed(0x15d)]();}function addBot(){const _0x212be4=_0x5d70db;let _0x352eef;for(let _0x4bc940=0x1;_0x4bc940<0x3e9;_0x4bc940++){_0x352eef=_0x4bc940['toString']()[_0x212be4(0x201)](0x3,'0');let _0x3d6af2=config['find'](_0x31ef1f=>_0x31ef1f[_0x212be4(0x224)]==_0x352eef);if(!_0x3d6af2)break;}if(_0x352eef===_0x212be4(0x127)){logging(_0x212be4(0x193));return;}logging(_0x212be4(0x122)+_0x352eef),dbConfig[_0x212be4(0x148)](_0x212be4(0x17d))['push']({'botID':_0x352eef,'botname':'Bot\x20'+_0x352eef,'status':'new','live':''})[_0x212be4(0x17a)](),startBot([_0x352eef],{'cwd':bbpath},function(_0x2814a1){if(_0x2814a1)logging(_0x2814a1);}),config=getConfiguration();if(socket[_0x212be4(0x19d)])socket[_0x212be4(0x19d)]['emit'](_0x212be4(0x17d),config);}function deleteBot(_0x14ebe4){const _0x32a5ee=_0x5d70db;if(socket[_0x14ebe4])socket[_0x14ebe4]['disconnect'](!![]);dbConfig[_0x32a5ee(0x148)](_0x32a5ee(0x17d))[_0x32a5ee(0x20a)]({'botID':_0x14ebe4})[_0x32a5ee(0x17a)](),logging(_0x32a5ee(0x1f1)+_0x14ebe4),stopBot(_0x14ebe4);try{fs['unlinkSync'](path[_0x32a5ee(0x177)](configpath,_0x32a5ee(0x137)+_0x14ebe4+_0x32a5ee(0x1b1))),fs[_0x32a5ee(0x1d1)](path[_0x32a5ee(0x177)](configpath,_0x32a5ee(0x137)+_0x14ebe4+_0x32a5ee(0x14e))),fs[_0x32a5ee(0x1d1)](path[_0x32a5ee(0x177)](configpath,_0x32a5ee(0x137)+_0x14ebe4+'-performance.json')),fs[_0x32a5ee(0x1d1)](path[_0x32a5ee(0x177)](configpath,_0x32a5ee(0x137)+_0x14ebe4+'-results.json'));}catch(_0x3e72f9){if(_0x3e72f9)logging('error\x20while\x20deleting\x20log\x20files:\x20',_0x3e72f9);}config=getConfiguration();if(socket['botmanager'])socket[_0x32a5ee(0x19d)]['emit'](_0x32a5ee(0x17d),config);}function toggleBot(_0x3d8c91,_0xc9a563,_0x1e2ede){const _0x10a1ba=_0x5d70db;dbConfig[_0x10a1ba(0x148)]('bots')['find']({'botID':_0x3d8c91})[_0x10a1ba(0x164)]({'status':_0xc9a563})['assign']({'live':_0x1e2ede})['write']();if(_0xc9a563==_0x10a1ba(0x126)||_0xc9a563==_0x10a1ba(0x1bf))logging(_0x10a1ba(0x1a0)+_0x3d8c91),startBot([_0x3d8c91],{'cwd':bbpath},function(_0x2854d2){if(_0x2854d2)logging(_0x2854d2);});else(_0xc9a563==_0x10a1ba(0x140)||_0xc9a563==_0x10a1ba(0x223))&&(logging(_0x10a1ba(0x15e)+_0x3d8c91),stopBot(_0x3d8c91));config=getConfiguration();if(socket[_0x10a1ba(0x19d)])socket[_0x10a1ba(0x19d)]['emit'](_0x10a1ba(0x17d),config);}function updateStatus(_0xabdb72,_0x2bbf94){const _0x8684d4=_0x5d70db;dbConfig[_0x8684d4(0x148)](_0x8684d4(0x17d))[_0x8684d4(0x1ee)]({'botID':_0xabdb72})['assign']({'status':_0x2bbf94})['write'](),config=getConfiguration();if(socket[_0x8684d4(0x19d)])socket['botmanager'][_0x8684d4(0x11b)](_0x8684d4(0x17d),config);}function _0x5a6d(){const _0x29b06e=['16dMyaFN','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','/enable\x20-\x20enable\x20notifications\x0a','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','sha256','bbPassword','error','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','existsSync','sign','Notifications\x20enabled\x0a','reject','emit','-----------------------------------------------------------------------------------','get-logs','username','index.html','store-settings','234FcPrsN','starting\x20new\x20bot\x20|\x20Bot\x20','success','crypto','/:bot/performance','enabled','1000','hasOwnProperty','No\x20authentication\x20token','data','(((.+)+)+)+$','/disable\x20-\x20disable\x20notifications\x0a','temporary\x20token\x20generated','getDate','temporaryAccessAllowed','remoteAddress','settings.','randomFillSync','set','function','\x20>\x20','15\x20min','bot-','\x20/\x20','/:bot/support','2FA\x20login\x20token\x20generated','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','hybrid-crypto-js','placeOrder','isValid','lowdb','disabled','then','::1','build','SIGINT','split','telegramToken','token','get','ipaddr.js','\x20only\x0a','notification','Unauthorized\x20attempt\x20to\x20log\x20out','fork','-events.json','hashSync','getTime','add','exp','telegramEnabled','length','value','createServer','secret','search','sendMessage','update-bot','page','2FA\x20login\x20required','kill','disabled\x20Bot\x20','User\x20has\x20been\x20validated','running','logged\x20out','encryptedUuid','2428392pPXjMJ','assign','idling\x20bot\x20\x20\x20|\x20Bot\x20','date-fns','orders','ipv6','connected','16xyrQZQ','headers','Password\x20reset\x20rejected','clientip','default','apiKey','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','@analytics/google-analytics','Notifications\x20types:\x20','kind','whitelistEnabled','use','telegramChatId','join','Invalid\x20IP\x20address','type','write','callback_query','Allow\x20login\x20from\x20IP\x20address\x20<b>','bots','express','Unauthorized\x20attempt\x20logging\x20in\x20(timeout)','1952YajSjX','Notifications\x20disabled','login\x20not\x20required','UA-192771731-1','from','handshake','Unauthorized\x20attempt\x20to\x20store\x20configuration','toIPv4Address','disconnect','blacklist','initclient','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','login\x20required','expiry','logout','/help\x20-\x20show\x20avaiable\x20commands\x0a','stopPolling','jsonwebtoken','2415897CjmQMH','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Password\x20has\x20been\x20reset\x20to:\x20','loginRequired','Crypt','getStartingBalances','once','<b>Telegram\x20bot\x20status:</b>\x0a','\x20|\x20','botname','apply','botmanager','whitelist','conn','enabled\x20Bot\x20','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','send','allow','127.0.0.1','Temporary\x20access\x20rejected','get-starting-balances','getMonth','accept','Login\x20rejected','Login\x20accepted','mkdirSync','<b>Balance\x20Bot\x20status:</b>\x0a','filter','\x20minutes','message','telegramEvents','-config.json','367610nnvHcZ','exit','chat','config/','listen','removeAllListeners','started','Orders','getUTCHours',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','keys','/:bot/coins','bbUsername','new','bot.js','push','http','RSA-OAEP','log','isIPv4MappedAddress','9233lExTMJ','reason','getSeconds','Unauthorized\x20attempt\x20to\x20get\x20logs','match','entries','sortBy','args','forEach','Unauthorized\x20attempt\x20to\x20delete\x20bot','43854rxmPWB','unlinkSync','timestamp','191900kwLdyx','Bot\x20','434691ylSknA','node-telegram-bot-api','order','</b>\x20?','bb-settings.json','store','invalid\x20credentials','status','static','removeListener','secure','includes','storeConfiguration','privateKey','onText','referer','lowdb/adapters/FileSync','answerCallbackQuery','Invalid\x20username\x20or\x20IP\x20address','temporary\x20access\x20not\x20allowed','settings','show','bb/','bcryptjs','Invalid\x20Telegram\x20token','find','Access\x20enabled\x20for\x20','30\x20min','deleted\x20Bot\x20','login\x20token\x20generated','stopped','Token\x20blacklisted','cloneDeep','max','starting\x20bot\x20|\x20Bot\x20','All','/:bot/configuration','telegramUsername','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Unauthorized\x20attempt\x20to\x20update\x20bot','No\x20bots\x20enabled\x20right\x20now','Balance\x20Bot\x20Server','generateKeyPairAsync','live','padStart','decrypt','getMinutes','place-order','all','************','connection','getHours','reload','remove','login','2FA\x20required','/:bot/history','f2aRequired','inherit','add-bot','catch','child_process','getFullYear','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','defaults','toString','bb-secure.json','analytics','build2','env','yes','::ffff:127.0.0.1','publicKey','RSA','Notifications\x20disabled\x0a','emitHistory','HTML','alerts','new-disabled','botID','hex','sendFile','404\x20Not\x20Found','telegram','timeshift','storeHeadless','Balance\x20Bot','password','map','starting','Alerts'];_0x5a6d=function(){return _0x29b06e;};return _0x5a6d();}function updateLive(_0x5daa83,_0x2bae4a){const _0x4b6178=_0x5d70db;dbConfig['get'](_0x4b6178(0x17d))['find']({'botID':_0x5daa83})[_0x4b6178(0x164)]({'live':_0x2bae4a})[_0x4b6178(0x17a)](),config=getConfiguration();if(socket[_0x4b6178(0x19d)])socket[_0x4b6178(0x19d)][_0x4b6178(0x11b)]('bots',config);}function updateBotName(_0x2fe84e,_0x18a3df){const _0xebb132=_0x5d70db;dbConfig[_0xebb132(0x148)](_0xebb132(0x17d))['find']({'botID':_0x2fe84e})['assign']({'botname':_0x18a3df})['write'](),config=getConfiguration();if(socket['botmanager'])socket['botmanager'][_0xebb132(0x11b)](_0xebb132(0x17d),config);}function telegramError(_0xa9981c){const _0x35c104=_0x5d70db;console[_0x35c104(0x1c4)](getTimeStamp()+_0x35c104(0x1bb));}function validateTelegram(_0x1dd3cc){const _0x29d142=_0x5d70db;if(_0x1dd3cc[_0x29d142(0x184)]['username']!=settings[_0x29d142(0x1fa)]&&'@'+_0x1dd3cc[_0x29d142(0x184)][_0x29d142(0x11e)]!=settings[_0x29d142(0x1fa)])return tgBot[_0x29d142(0x159)](_0x1dd3cc[_0x29d142(0x1b4)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x29d142(0x221)})[_0x29d142(0x211)](_0x2d7344=>{telegramError(_0x2d7344);}),![];return!![];}async function initTelegram(){const _0x4e1d0c=_0x5d70db;if(tgBot)tgBot[_0x4e1d0c(0x190)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x3b96ee='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x3b96ee+='\x0a',_0x3b96ee+=_0x4e1d0c(0x111),_0x3b96ee+=_0x4e1d0c(0x12c),_0x3b96ee+=_0x4e1d0c(0x110),_0x3b96ee+='/restart\x20-\x20restart\x20a\x20bot\x0a',_0x3b96ee+='/status\x20-\x20show\x20the\x20status\x20of\x20your\x20bots\x0a',_0x3b96ee+=_0x4e1d0c(0x18f);let _0xfc0a8a='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0xfc0a8a+='\x0a',_0xfc0a8a+=_0x3b96ee,tgBot[_0x4e1d0c(0x1e3)](/\/start/,_0x332238=>{const _0x440194=_0x4e1d0c;if(!validateTelegram(_0x332238))return;if(settings['telegramChatId']!=_0x332238[_0x440194(0x1b4)]['id'])updateSetting(_0x440194(0x176),_0x332238['chat']['id']);updateSetting(_0x440194(0x153),!![]),tgBot[_0x440194(0x159)](_0x332238['chat']['id'],_0xfc0a8a)[_0x440194(0x211)](_0x24f1d6=>{telegramError(_0x24f1d6);});}),tgBot[_0x4e1d0c(0x1e3)](/\/enable/,_0x3f3a69=>{const _0x1000b0=_0x4e1d0c;if(!validateTelegram(_0x3f3a69))return;if(settings[_0x1000b0(0x176)]!=_0x3f3a69[_0x1000b0(0x1b4)]['id'])updateSetting(_0x1000b0(0x176),_0x3f3a69['chat']['id']);updateSetting('telegramEnabled',!![]),tgBot['sendMessage'](_0x3f3a69[_0x1000b0(0x1b4)]['id'],'Notifications\x20enabled')[_0x1000b0(0x211)](_0x17e16d=>{telegramError(_0x17e16d);});}),tgBot['onText'](/\/config/,async _0x39084f=>{const _0x39980c=_0x4e1d0c;if(!validateTelegram(_0x39084f))return;tgBot[_0x39980c(0x1de)](_0x39980c(0x17b)),tgBot[_0x39980c(0x159)](_0x39084f[_0x39980c(0x1b4)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x39980c(0x1b9),'callback_data':_0x39980c(0x167)},{'text':_0x39980c(0x10e),'callback_data':_0x39980c(0x222)},{'text':_0x39980c(0x1f8),'callback_data':'all'}]]}})['catch'](_0x1f84fd=>{telegramError(_0x1f84fd);}),tgBot['on'](_0x39980c(0x17b),async _0x58b166=>{const _0x18f5e9=_0x39980c,_0x2b95e6=_0x58b166[_0x18f5e9(0x12a)],_0x3cb0bf=_0x58b166['message'];tgBot[_0x18f5e9(0x1e6)](_0x58b166['id'])[_0x18f5e9(0x141)](async()=>{const _0x53d750=_0x18f5e9;_0x2b95e6==_0x53d750(0x167)&&(updateSetting(_0x53d750(0x1b0),_0x53d750(0x167)),updateSetting(_0x53d750(0x153),!![]),await tgBot[_0x53d750(0x159)](_0x3cb0bf[_0x53d750(0x1b4)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only')['catch'](_0x3c6330=>{telegramError(_0x3c6330);}));_0x2b95e6=='alerts'&&(updateSetting(_0x53d750(0x1b0),_0x53d750(0x222)),updateSetting(_0x53d750(0x153),!![]),await tgBot[_0x53d750(0x159)](_0x3cb0bf[_0x53d750(0x1b4)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x53d750(0x211)](_0x4cef5e=>{telegramError(_0x4cef5e);}));_0x2b95e6==_0x53d750(0x205)&&(updateSetting(_0x53d750(0x1b0),_0x53d750(0x205)),updateSetting('telegramEnabled',!![]),await tgBot[_0x53d750(0x159)](_0x3cb0bf['chat']['id'],_0x53d750(0x116))[_0x53d750(0x211)](_0x5f48c1=>{telegramError(_0x5f48c1);}));if(!settings[_0x53d750(0x176)])tgBot[_0x53d750(0x159)](_0x3cb0bf['chat']['id'],_0x53d750(0x112))[_0x53d750(0x211)](_0x3d7bf2=>{telegramError(_0x3d7bf2);});}),tgBot[_0x18f5e9(0x1de)](_0x18f5e9(0x17b));});}),tgBot[_0x4e1d0c(0x1e3)](/\/status/,_0x143472=>{const _0x5d4a30=_0x4e1d0c;if(!validateTelegram(_0x143472))return;let _0x58d6cf=_0x5d4a30(0x1ac);config['forEach'](_0x31e875=>{const _0x697611=_0x5d4a30;_0x58d6cf+='Bot\x20'+_0x31e875[_0x697611(0x224)]+_0x697611(0x19a)+_0x31e875['botname']+':\x20'+_0x31e875['status']+_0x697611(0x138)+_0x31e875[_0x697611(0x200)]+'\x0a';}),_0x58d6cf+='\x0a',_0x58d6cf+=_0x5d4a30(0x199),_0x58d6cf+=!settings[_0x5d4a30(0x153)]?_0x5d4a30(0x21f):_0x5d4a30(0x119),_0x58d6cf+=settings[_0x5d4a30(0x153)]?settings[_0x5d4a30(0x1b0)]==_0x5d4a30(0x205)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x5d4a30(0x172)+settings[_0x5d4a30(0x1b0)]+_0x5d4a30(0x14a):'',tgBot[_0x5d4a30(0x159)](_0x143472[_0x5d4a30(0x1b4)]['id'],_0x58d6cf,{'parse_mode':_0x5d4a30(0x221)})[_0x5d4a30(0x211)](_0x7a4961=>{telegramError(_0x7a4961);});}),tgBot[_0x4e1d0c(0x1e3)](/\/restart/,_0x4781fd=>{const _0x27399a=_0x4e1d0c;if(!validateTelegram(_0x4781fd))return;tgBot[_0x27399a(0x1de)](_0x27399a(0x17b));const _0x574b75=getEnabledBots();if(_0x574b75[_0x27399a(0x154)]==0x0)tgBot['sendMessage'](_0x4781fd[_0x27399a(0x1b4)]['id'],_0x27399a(0x1fd))[_0x27399a(0x211)](_0x3ef451=>{telegramError(_0x3ef451);});else{let _0x1e6dc6=[],_0x5987e5=[];const _0x32eacc=_0x574b75[_0x27399a(0x154)]%0x4==0x0||_0x574b75[_0x27399a(0x154)]%0x4==0x3||_0x574b75[_0x27399a(0x154)]%0x3==0x1?0x4:0x3;let _0x18be16=0x0;_0x574b75[_0x27399a(0x1ce)]((_0x3d2694,_0x3b40a8)=>{const _0xf8f5c=_0x27399a;if(_0x3b40a8%_0x32eacc==0x0)_0x5987e5=[];_0x5987e5[_0xf8f5c(0x1c1)]({'text':_0xf8f5c(0x1d4)+_0x3d2694[_0xf8f5c(0x224)],'callback_data':_0x3d2694[_0xf8f5c(0x224)]}),_0x3b40a8%_0x32eacc==0x0&&(_0x1e6dc6[_0x18be16]=_0x5987e5,_0x18be16++);}),tgBot[_0x27399a(0x159)](_0x4781fd[_0x27399a(0x1b4)]['id'],_0x27399a(0x13b),{'reply_markup':{'inline_keyboard':_0x1e6dc6}})[_0x27399a(0x211)](_0xbfd59d=>{telegramError(_0xbfd59d);}),tgBot['on']('callback_query',async _0x27ff53=>{const _0x458e2e=_0x27399a,_0x28abbe=_0x27ff53['data'],_0x4466c0=_0x27ff53['message'];tgBot[_0x458e2e(0x1e6)](_0x27ff53['id'])[_0x458e2e(0x141)](async()=>{const _0xb30344=_0x458e2e;if(settings[_0xb30344(0x1b0)]==_0xb30344(0x167))tgBot[_0xb30344(0x159)](_0x4466c0[_0xb30344(0x1b4)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20Bot\x20'+_0x28abbe)[_0xb30344(0x211)](_0x7b4858=>{telegramError(_0x7b4858);});stopBot(_0x28abbe);}),tgBot[_0x458e2e(0x1de)]('callback_query');});}}),tgBot[_0x4e1d0c(0x1e3)](/\/disable/,_0x2ac06e=>{const _0x2db36b=_0x4e1d0c;if(!validateTelegram(_0x2ac06e))return;tgBot[_0x2db36b(0x159)](_0x2ac06e['chat']['id'],_0x2db36b(0x181))[_0x2db36b(0x211)](_0x5cb3e2=>{telegramError(_0x5cb3e2);}),updateSetting('telegramEnabled',![]);}),tgBot['onText'](/\/help/,_0x3453c1=>{const _0x1e5b85=_0x4e1d0c;if(!validateTelegram(_0x3453c1))return;tgBot[_0x1e5b85(0x159)](_0x3453c1[_0x1e5b85(0x1b4)]['id'],_0x3b96ee)['catch'](_0x2969df=>{telegramError(_0x2969df);});}),tgBot['on']('polling_error',_0x375384=>{const _0x3e7a9c=_0x4e1d0c;if(_0x375384[_0x3e7a9c(0x216)]()['includes'](_0x3e7a9c(0x227))){logging('Invalid\x20Telegram\x20token'),tgBot['stopPolling'](),tgBot=null;if(socket[_0x3e7a9c(0x19d)])socket[_0x3e7a9c(0x19d)][_0x3e7a9c(0x11b)](_0x3e7a9c(0x14b),_0x3e7a9c(0x1ed));}}),process[_0x4e1d0c(0x198)](_0x4e1d0c(0x144),()=>{const _0x55d3bd=_0x4e1d0c;if(tgBot)tgBot[_0x55d3bd(0x190)]();process[_0x55d3bd(0x1b3)](0x1);}),process[_0x4e1d0c(0x198)]('SIGTERM',()=>{const _0x3853df=_0x4e1d0c;if(tgBot)tgBot[_0x3853df(0x190)]();process[_0x3853df(0x1b3)](0x1);});}}function disableTelegram(){const _0x185e01=_0x5d70db;tgBot&&(tgBot[_0x185e01(0x190)](),tgBot=null);}function sendTelegram(_0x5b90b2,_0x3648b2){const _0x4b69c8=_0x5d70db;if(settings['telegramEnabled']){if(settings[_0x4b69c8(0x1b0)]==_0x4b69c8(0x205)||(_0x3648b2['type']==_0x4b69c8(0x115)||_0x3648b2[_0x4b69c8(0x179)]=='success')&&settings['telegramEvents']==_0x4b69c8(0x222)||_0x3648b2['type']==_0x4b69c8(0x1d7)&&settings[_0x4b69c8(0x1b0)]=='orders'){if(tgBot&&settings[_0x4b69c8(0x176)])tgBot[_0x4b69c8(0x159)](settings['telegramChatId'],_0x4b69c8(0x1d4)+_0x5b90b2+_0x4b69c8(0x135)+_0x3648b2['event'])[_0x4b69c8(0x211)](_0x44e5e0=>{telegramError(_0x44e5e0);});}}}function temporaryAccess2FA(_0x84b7){const _0x1ce72d=_0x5d70db;let _0x1980bb=new Date(),_0x3db783=![];if(lastIpApproval){if(_0x1980bb-lastIpApproval<0x1388)_0x3db783=!![];}lastIpApproval=new Date();if(_0x3db783)return;tgBot&&settings['telegramChatId']&&(tgBot['removeListener']('callback_query'),tgBot[_0x1ce72d(0x159)](settings[_0x1ce72d(0x176)],_0x1ce72d(0x1a1)+normalizeIP(_0x84b7)['show']+_0x1ce72d(0x1d8),{'parse_mode':_0x1ce72d(0x221),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x1ce72d(0x136),'callback_data':'15'},{'text':_0x1ce72d(0x1f0),'callback_data':'30'},{'text':_0x1ce72d(0x11a),'callback_data':_0x1ce72d(0x11a)}]]}})[_0x1ce72d(0x211)](_0x42afde=>{telegramError(_0x42afde);}),tgBot['on']('callback_query',async _0x54a6de=>{const _0x480098=_0x1ce72d,_0x102a9d=_0x54a6de['data'],_0x5072e3=_0x54a6de[_0x480098(0x1af)];tgBot[_0x480098(0x1e6)](_0x54a6de['id'])[_0x480098(0x141)](async()=>{const _0x46cf1e=_0x480098;if(_0x102a9d!=_0x46cf1e(0x11a)){telegramIpApproval={'clientip':_0x84b7,'timestamp':new Date()['getTime'](),'expiry':_0x102a9d},await tgBot[_0x46cf1e(0x159)](_0x5072e3[_0x46cf1e(0x1b4)]['id'],_0x46cf1e(0x1ef)+_0x102a9d+_0x46cf1e(0x1ae),{'parse_mode':_0x46cf1e(0x221)})[_0x46cf1e(0x211)](_0x505154=>{telegramError(_0x505154);});for(let _0x1176cd in socket){socket[_0x1176cd][_0x46cf1e(0x11b)](_0x46cf1e(0x1dc),{'access':{'allow':![],'reason':_0x46cf1e(0x209),'token':null}});}}else await tgBot['sendMessage'](_0x5072e3[_0x46cf1e(0x1b4)]['id'],_0x46cf1e(0x1a5))[_0x46cf1e(0x211)](_0x1560b2=>{telegramError(_0x1560b2);});}),tgBot[_0x480098(0x1de)](_0x480098(0x17b));}));}function loginAccess2FA(_0x42b979){const _0x17444c=_0x5d70db;tgBot&&settings[_0x17444c(0x176)]&&(tgBot[_0x17444c(0x1de)](_0x17444c(0x17b)),tgBot[_0x17444c(0x159)](settings[_0x17444c(0x176)],_0x17444c(0x17c)+normalizeIP(_0x42b979)[_0x17444c(0x1ea)]+_0x17444c(0x1d8),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x17444c(0x1a8),'callback_data':loginExpiry},{'text':_0x17444c(0x11a),'callback_data':_0x17444c(0x11a)}]]}})[_0x17444c(0x211)](_0x371d14=>{telegramError(_0x371d14);}),tgBot['on'](_0x17444c(0x17b),async _0x3b58f1=>{const _0x3e38f3=_0x17444c,_0x2714ef=_0x3b58f1[_0x3e38f3(0x12a)],_0x1da0c2=_0x3b58f1[_0x3e38f3(0x1af)];tgBot[_0x3e38f3(0x1e6)](_0x3b58f1['id'])[_0x3e38f3(0x141)](async()=>{const _0x316c12=_0x3e38f3;if(_0x2714ef!=_0x316c12(0x11a)){telegram2FaApproval={'clientip':_0x42b979,'timestamp':new Date()[_0x316c12(0x150)](),'expiry':_0x2714ef},await tgBot[_0x316c12(0x159)](_0x1da0c2[_0x316c12(0x1b4)]['id'],_0x316c12(0x1aa),{'parse_mode':'HTML'})[_0x316c12(0x211)](_0x54bdca=>{telegramError(_0x54bdca);});for(let _0x3ffe1b in socket){socket[_0x3ffe1b][_0x316c12(0x11b)](_0x316c12(0x1dc),{'access':{'allow':![],'reason':_0x316c12(0x209),'token':null}});}}else await tgBot[_0x316c12(0x159)](_0x1da0c2[_0x316c12(0x1b4)]['id'],_0x316c12(0x1a9))[_0x316c12(0x211)](_0x554077=>{telegramError(_0x554077);});}),tgBot[_0x3e38f3(0x1de)](_0x3e38f3(0x17b));}));}function getConfiguration(){const _0x1a02e3=_0x5d70db;return dbConfig['get'](_0x1a02e3(0x17d))[_0x1a02e3(0x1cc)](_0x1a02e3(0x224))[_0x1a02e3(0x155)]()||[];}function getEnabledBots(){const _0x3c5a8f=_0x5d70db;return dbConfig[_0x3c5a8f(0x148)](_0x3c5a8f(0x17d))[_0x3c5a8f(0x1cc)](_0x3c5a8f(0x224))[_0x3c5a8f(0x1ad)]({'status':_0x3c5a8f(0x126)})[_0x3c5a8f(0x155)]()||[];}function getSettings(){const _0x335a31=_0x5d70db;return dbSettings[_0x335a31(0x148)](_0x335a31(0x1e9))[_0x335a31(0x155)]()||{'timeshift':0x0};}function getSecure(){const _0x5710b6=_0x5d70db;return dbSecure['get'](_0x5710b6(0x1df))[_0x5710b6(0x155)]()||{};}function getBlacklist(){const _0x5411d9=_0x5d70db;return dbSecure[_0x5411d9(0x148)](_0x5411d9(0x189))[_0x5411d9(0x155)]()||[];}function broadcastToBots(_0x4d8c1f,_0x3ca5e9){const _0x174070=_0x5d70db;config[_0x174070(0x1ce)](_0x564e2f=>{const _0x34075e=_0x174070;if(_0x564e2f[_0x34075e(0x1dc)]==_0x34075e(0x126)&&_0x564e2f[_0x34075e(0x200)]==_0x34075e(0x160)){if(pid[_0x564e2f['botID']])pid[_0x564e2f[_0x34075e(0x224)]][_0x34075e(0x1a2)]({[_0x4d8c1f]:_0x3ca5e9});}});}function storeSettings(_0x3101e2,_0x3fcce3=![]){const _0x5505fe=_0x5d70db;_0x3101e2={...settings,..._0x3101e2};if(_0x3fcce3&&_0x3101e2[_0x5505fe(0x114)]!='************'&&_0x3101e2['bbPassword']!=''){const _0x46667e=crypt[_0x5505fe(0x202)](secure[_0x5505fe(0x1e2)],_0x3101e2[_0x5505fe(0x114)])['message']['split']('@')[0x0],_0x45c454=bcrypt['hashSync'](_0x46667e,saltRounds);_0x3101e2={..._0x3101e2,'bbPassword':_0x45c454};}if(_0x3fcce3&&_0x3101e2['telegramToken']!=_0x5505fe(0x206)&&_0x3101e2[_0x5505fe(0x146)]!=''){const _0x35e728=crypt[_0x5505fe(0x202)](secure[_0x5505fe(0x1e2)],_0x3101e2[_0x5505fe(0x146)])['message'][_0x5505fe(0x145)]('@')[0x0];_0x3101e2={..._0x3101e2,'telegramToken':_0x35e728};}const _0x19ffe6=_0x3101e2[_0x5505fe(0x146)]!=_0x5505fe(0x206)&&_0x3101e2[_0x5505fe(0x146)]!=settings['telegramToken']||_0x3101e2['telegramUsername']!=settings['telegramUsername'],_0x41f1a0=_0x3101e2[_0x5505fe(0x146)]==''||_0x3101e2[_0x5505fe(0x1fa)]=='';if(_0x19ffe6)_0x3101e2[_0x5505fe(0x1b0)]=_0x5505fe(0x205);for(const [_0x4a982b,_0x9511d5]of Object[_0x5505fe(0x1cb)](_0x3101e2)){if(_0x4a982b==_0x5505fe(0x146)&&_0x9511d5==_0x5505fe(0x206)){_0x3101e2[_0x5505fe(0x146)]=settings[_0x5505fe(0x146)];continue;};if(_0x4a982b==_0x5505fe(0x114)&&_0x9511d5=='************'){_0x3101e2[_0x5505fe(0x114)]=settings['bbPassword'];continue;};dbSettings[_0x5505fe(0x133)](_0x5505fe(0x131)+_0x4a982b,_0x9511d5)[_0x5505fe(0x17a)]();}settings=_0x3101e2;if(socket[_0x5505fe(0x19d)])socket[_0x5505fe(0x19d)]['emit'](_0x5505fe(0x1e9),cleanSettings());broadcastToBots('timeshift',settings[_0x5505fe(0x229)]);if(_0x19ffe6&&!_0x41f1a0)initTelegram();if(_0x19ffe6&&_0x41f1a0)disableTelegram();for(let _0x560cf5 in socket){setAccess(_0x560cf5);}}function updateSetting(_0x371a97,_0x1cfe9d){const _0x4aa364=_0x5d70db;dbSettings['set'](_0x4aa364(0x131)+_0x371a97,_0x1cfe9d)['write'](),settings=getSettings();if(socket[_0x4aa364(0x19d)])socket[_0x4aa364(0x19d)][_0x4aa364(0x11b)](_0x4aa364(0x1e9),cleanSettings());}function storeSecure(_0xa31fad){const _0x57307b=_0x5d70db;dbSecure[_0x57307b(0x148)]('secure')[_0x57307b(0x1c1)](_0xa31fad)[_0x57307b(0x17a)](),secure=_0xa31fad;}function addBlacklist(){const _0x2d4bb2=_0x5d70db;cleanBlacklist();let _0x3dacd0;telegramIpApproval?_0x3dacd0=Math[_0x2d4bb2(0x1f6)](telegramIpApproval[_0x2d4bb2(0x18d)],loginExpiry):_0x3dacd0=loginExpiry,dbSecure[_0x2d4bb2(0x148)]('blacklist')[_0x2d4bb2(0x1c1)]({'expiry':new Date()['getTime']()+_0x3dacd0*0x3c*0x3e8,'token':token})['write'](),blacklist=dbSecure[_0x2d4bb2(0x148)](_0x2d4bb2(0x189))[_0x2d4bb2(0x155)]();}function cleanBlacklist(){const _0x2f61c0=_0x5d70db;let _0x4a056b=dbSecure['get'](_0x2f61c0(0x189))[_0x2f61c0(0x1f5)]()['value'](),_0x1e3b24=new Date()[_0x2f61c0(0x150)]();_0x4a056b['forEach'](_0x133731=>{const _0x161e6e=_0x2f61c0;_0x133731[_0x161e6e(0x18d)]<_0x1e3b24&&dbSecure[_0x161e6e(0x148)]('blacklist')[_0x161e6e(0x20a)]({'expiry':_0x133731['expiry']})[_0x161e6e(0x17a)]();});}function initStates(){const _0xe00147=_0x5d70db;let _0x1bbadb=getConfiguration();_0x1bbadb[_0xe00147(0x1ce)](_0xc5ddc2=>{const _0x5a8ee3=_0xe00147;_0xc5ddc2[_0x5a8ee3(0x200)]=_0x5a8ee3(0x1f3);}),storeConfiguration(_0x1bbadb);}function onKeys(){const _0x41f213=new RSA();return new Promise(_0x1cae19=>{const _0x3f8f78=_0x3dd0;_0x41f213[_0x3f8f78(0x1ff)]()[_0x3f8f78(0x141)](_0x2b5083=>{_0x1cae19(_0x2b5083);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x30651b=_0x5d70db;let _0x445079=getConfiguration(),_0x2bd8d6=![];_0x445079[_0x30651b(0x1ce)](_0x166ea0=>{const _0x424fcd=_0x30651b;if(_0x166ea0[_0x424fcd(0x1dc)]==_0x424fcd(0x160))_0x166ea0[_0x424fcd(0x1dc)]=_0x424fcd(0x126),_0x2bd8d6=!![];else _0x166ea0[_0x424fcd(0x1dc)]==_0x424fcd(0x1f3)&&(_0x166ea0[_0x424fcd(0x1dc)]=_0x424fcd(0x140),_0x2bd8d6=!![]);});if(_0x2bd8d6)storeConfiguration(_0x445079);let _0x3ee2f0=getSecure();if(!_0x3ee2f0[_0x30651b(0x128)](_0x30651b(0x157))){let _0x36211d=await generateKeys();_0x3ee2f0[_0x30651b(0x21d)]=_0x36211d['publicKey'],_0x3ee2f0[_0x30651b(0x1e2)]=_0x36211d[_0x30651b(0x1e2)],_0x3ee2f0[_0x30651b(0x157)]=crypto['randomBytes'](0x20)[_0x30651b(0x216)](_0x30651b(0x225));;storeSecure(_0x3ee2f0);}let _0x1bcf42=getSettings();_0x2bd8d6=![];!_0x1bcf42[_0x30651b(0x128)]('loginRequired')&&(_0x1bcf42[_0x30651b(0x195)]=![],_0x1bcf42[_0x30651b(0x1be)]='',_0x1bcf42['bbPassword']='',_0x1bcf42[_0x30651b(0x20e)]=![],_0x2bd8d6=!![]);!_0x1bcf42['hasOwnProperty'](_0x30651b(0x174))&&(_0x1bcf42[_0x30651b(0x174)]=![],_0x1bcf42[_0x30651b(0x19e)]=[],_0x1bcf42[_0x30651b(0x12f)]=![],_0x2bd8d6=!![]);if(!_0x1bcf42[_0x30651b(0x128)]('telegramEnabled')){if(_0x1bcf42[_0x30651b(0x176)])_0x1bcf42['telegramEnabled']=!![];else _0x1bcf42['telegramEnabled']=![];_0x2bd8d6=!![];}if(_0x2bd8d6)storeSettings(_0x1bcf42);}function storeConfiguration(_0x202a0f){const _0x4fa3b4=_0x5d70db;dbConfig[_0x4fa3b4(0x148)](_0x4fa3b4(0x17d))[_0x4fa3b4(0x20a)]()[_0x4fa3b4(0x17a)](),dbConfig['get']('bots')[_0x4fa3b4(0x1c1)](..._0x202a0f)[_0x4fa3b4(0x17a)](),config=_0x202a0f;}function resetPassword(){const _0x18b176=_0x5d70db;tgBot&&settings[_0x18b176(0x176)]&&(tgBot[_0x18b176(0x1de)]('callback_query'),tgBot[_0x18b176(0x159)](settings[_0x18b176(0x176)],_0x18b176(0x1fb),{'parse_mode':_0x18b176(0x221),'reply_markup':{'inline_keyboard':[[{'text':_0x18b176(0x21b),'callback_data':_0x18b176(0x21b)},{'text':'no','callback_data':'no'}]]}})[_0x18b176(0x211)](_0xf51086=>{telegramError(_0xf51086);}),tgBot['on'](_0x18b176(0x17b),async _0x2c47d0=>{const _0x46e90c=_0x18b176,_0x5abbe1=_0x2c47d0[_0x46e90c(0x12a)],_0x3d8ec3=_0x2c47d0[_0x46e90c(0x1af)];tgBot[_0x46e90c(0x1e6)](_0x2c47d0['id'])['then'](async()=>{const _0x3d2408=_0x46e90c;if(_0x5abbe1!='no'){const _0x55b48d=0xf,_0x29f924=_0x3d2408(0x214),_0xde9217=Array[_0x3d2408(0x184)](crypto[_0x3d2408(0x132)](new Uint32Array(_0x55b48d)))[_0x3d2408(0x22d)](_0x37afee=>_0x29f924[_0x37afee%_0x29f924[_0x3d2408(0x154)]])['join'](''),_0x7d8b01=bcrypt[_0x3d2408(0x14f)](_0xde9217,saltRounds);storeSettings({'bbPassword':_0x7d8b01}),await tgBot[_0x3d2408(0x159)](_0x3d8ec3[_0x3d2408(0x1b4)]['id'],_0x3d2408(0x194)+_0xde9217,{'parse_mode':_0x3d2408(0x221)})[_0x3d2408(0x211)](_0x1a35d1=>{telegramError(_0x1a35d1);});}else await tgBot[_0x3d2408(0x159)](_0x3d8ec3[_0x3d2408(0x1b4)]['id'],_0x3d2408(0x16c))[_0x3d2408(0x211)](_0xd17d20=>{telegramError(_0xd17d20);});}),tgBot[_0x46e90c(0x1de)](_0x46e90c(0x17b));}));}function logging(_0x1a4ed3){const _0x4e2de1=_0x5d70db;console[_0x4e2de1(0x1c4)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x1a4ed3);if(tgBot&&settings[_0x4e2de1(0x176)]&&settings[_0x4e2de1(0x1b0)]!=_0x4e2de1(0x167))tgBot['sendMessage'](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x1a4ed3)[_0x4e2de1(0x211)](_0x5c4d9a=>{telegramError(_0x5c4d9a);});}function getServerTime(){const _0x6ccd67=_0x5d70db,_0x42718d=new Date();return _0x42718d[_0x6ccd67(0x213)]()+'/'+(_0x42718d['getMonth']()+0x1)[_0x6ccd67(0x216)]()[_0x6ccd67(0x201)](0x2,'0')+'/'+_0x42718d[_0x6ccd67(0x12e)]()[_0x6ccd67(0x216)]()[_0x6ccd67(0x201)](0x2,'0')+'\x20'+_0x42718d['getHours']()[_0x6ccd67(0x216)]()[_0x6ccd67(0x201)](0x2,'0')+':'+_0x42718d[_0x6ccd67(0x203)]()['toString']()[_0x6ccd67(0x201)](0x2,'0')+':'+_0x42718d[_0x6ccd67(0x1c8)]()[_0x6ccd67(0x216)]()[_0x6ccd67(0x201)](0x2,'0');}function getTimeStamp(){const _0x23200c=_0x5d70db,_0x3775a4=shiftedTime();return _0x3775a4[_0x23200c(0x213)]()+'/'+(_0x3775a4[_0x23200c(0x1a7)]()+0x1)[_0x23200c(0x216)]()[_0x23200c(0x201)](0x2,'0')+'/'+_0x3775a4[_0x23200c(0x12e)]()['toString']()[_0x23200c(0x201)](0x2,'0')+'\x20'+_0x3775a4[_0x23200c(0x208)]()['toString']()['padStart'](0x2,'0')+':'+_0x3775a4['getMinutes']()['toString']()[_0x23200c(0x201)](0x2,'0')+':'+_0x3775a4[_0x23200c(0x1c8)]()[_0x23200c(0x216)]()[_0x23200c(0x201)](0x2,'0');}function shiftedTime(){const _0x5c7c22=_0x5d70db,_0x430a32=new Date();let _0xb06dff=_0x430a32;if(settings[_0x5c7c22(0x229)]&&settings[_0x5c7c22(0x229)]!==0x0)_0xb06dff=fns[_0x5c7c22(0x151)](_0x430a32,{'hours':settings[_0x5c7c22(0x229)]});return _0xb06dff;}function startAnalytics(){const _0x1c369a=_0x5d70db;let _0x29be85=new Date()[_0x1c369a(0x1ba)]();_0x29be85==0x9&&triggerAnalytics();if(pidAnalytics)clearTimeout(pidAnalytics);pidAnalytics=setTimeout(()=>{startAnalytics();},0x3c*0x3c*0x3e8);}function triggerAnalytics(){const _0x4eca18=_0x5d70db;analytics[_0x4eca18(0x15b)]({'title':_0x4eca18(0x1fe),'href':'https://hodlerhacks.com','path':'/v'+serverversion});}function validateCredentials(_0x3cb121){const _0x3bc2ba=_0x5d70db;if(_0x3cb121[_0x3bc2ba(0x11e)]==settings[_0x3bc2ba(0x1be)]&&bcrypt['compareSync'](_0x3cb121[_0x3bc2ba(0x22c)],settings['bbPassword'])){if(settings[_0x3bc2ba(0x20e)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x162ed7=generateLoginToken();return{'allow':!![],'reason':_0x3bc2ba(0x1f2),'token':_0x162ed7};}}else return{'allow':![],'reason':_0x3bc2ba(0x1db),'token':null};}function refreshToken(){const _0x5623fd=_0x5d70db,_0x5a667c=generateLoginToken();return{'allow':!![],'reason':_0x5623fd(0x1f2),'token':_0x5a667c};}function validateAccess(_0x679ec5){const _0x3e6a80=_0x5d70db;let _0x16662b;const _0x2c4f5e=_0x8839d1=>{const _0x1588b4=_0x3dd0;if(settings[_0x1588b4(0x195)]){if(settings[_0x1588b4(0x20e)]){if(telegram2FaApproved()){const _0x4203ab=generateLoginToken();return{'allow':!![],'reason':_0x1588b4(0x13a),'token':_0x4203ab};}else return{'allow':![],'reason':'2FA\x20login\x20required','token':null};}else return _0x16662b=validToken(_0x8839d1),_0x16662b[_0x1588b4(0x128)]('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x8839d1}:{'allow':![],'reason':_0x1588b4(0x18c),'token':null};}else return{'allow':!![],'reason':_0x1588b4(0x182),'token':null};};if(settings[_0x3e6a80(0x174)]){let _0x4e2a0c=[...settings[_0x3e6a80(0x19e)],_0x3e6a80(0x142),_0x3e6a80(0x21c),_0x3e6a80(0x1a4)];if(_0x4e2a0c[_0x3e6a80(0x1e0)](externalip))return _0x2c4f5e(_0x679ec5);else{_0x16662b=validToken(_0x679ec5);if(_0x16662b[_0x3e6a80(0x128)](_0x3e6a80(0x123)))return _0x2c4f5e(_0x679ec5);else{if(telegramIpApproved()){const _0x3100a9=generateToken();return _0x16662b=_0x2c4f5e(_0x679ec5),_0x16662b[_0x3e6a80(0x1a3)]?{'allow':!![],'reason':_0x3e6a80(0x12d),'token':_0x3100a9}:_0x16662b;}else return settings[_0x3e6a80(0x12f)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x3e6a80(0x1e8),'token':null};}}}else return _0x2c4f5e(_0x679ec5);}function timelyDecrypt(_0x1ec46a,_0x52207b=!![]){const _0x1ca41c=_0x5d70db;if(_0x1ec46a)try{const _0x348dc2=crypt[_0x1ca41c(0x202)](secure[_0x1ca41c(0x1e2)],_0x1ec46a)[_0x1ca41c(0x1af)],_0x57f9c5=_0x348dc2['split']('@')[0x0],_0x1825e9=_0x348dc2[_0x1ca41c(0x145)]('@')[0x1],_0x270df2=new Date()[_0x1ca41c(0x150)]();if(_0x52207b){if(_0x270df2-_0x1825e9<maxSecretAge*0x3e8)return _0x57f9c5;else return![];}else return _0x57f9c5;}catch{return![];}else return![];}const validToken=_0x2d26d7=>{const _0x3c0851=_0x5d70db;if(!_0x2d26d7)return{'error':_0x3c0851(0x129)};for(let _0x201607 of blacklist){if(_0x201607[_0x3c0851(0x147)]==_0x2d26d7)return{'error':_0x3c0851(0x1f4)};}let _0x3d861c;try{_0x3d861c=jwt['verify'](_0x2d26d7,secure[_0x3c0851(0x157)]+uuid);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x3d861c[_0x3c0851(0x128)](_0x3c0851(0x16d))&&!_0x3d861c[_0x3c0851(0x128)](_0x3c0851(0x11e))||!_0x3d861c[_0x3c0851(0x128)](_0x3c0851(0x152)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x3d861c[_0x3c0851(0x128)](_0x3c0851(0x11e))&&_0x3d861c[_0x3c0851(0x128)](_0x3c0851(0x16d))){const {clientip:_0x1bf8b2}=_0x3d861c;return externalip==_0x1bf8b2?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x3c0851(0x178)};}else{if(_0x3d861c[_0x3c0851(0x128)](_0x3c0851(0x11e))&&_0x3d861c[_0x3c0851(0x128)]('clientip')){const {username:_0x15920f,clientip:_0x84cfe3}=_0x3d861c;return settings[_0x3c0851(0x1be)]==_0x15920f&&externalip==_0x84cfe3?{'success':_0x3c0851(0x15f)}:{'error':_0x3c0851(0x1e7)};}}},generateLoginToken=()=>{const _0x300436=_0x5d70db;if(uuid)return jwt[_0x300436(0x118)]({'username':settings[_0x300436(0x1be)],'clientip':externalip},secure[_0x300436(0x157)]+uuid,{'expiresIn':tokenRefresh*0x3c});else return![];},generateToken=()=>{const _0x2d709b=_0x5d70db;if(uuid)return jwt[_0x2d709b(0x118)]({'clientip':externalip},secure['secret']+uuid,{'expiresIn':telegramIpApproval[_0x2d709b(0x18d)]*0x3c});else return![];},telegramIpApproved=()=>{const _0x259943=_0x5d70db;let _0x4d9741=![];return telegramIpApproval&&telegramIpApproval['expiry']!='reject'&&(_0x4d9741=telegramIpApproval[_0x259943(0x16d)]==externalip&&new Date()[_0x259943(0x150)]()-telegramIpApproval[_0x259943(0x1d2)]<telegramIpApproval[_0x259943(0x18d)]*0x3c*0x3e8),_0x4d9741;},telegram2FaApproved=()=>{const _0xc327cc=_0x5d70db;let _0x26f35e=![];return telegram2FaApproval&&telegram2FaApproval['expiry']!=_0xc327cc(0x11a)&&(_0x26f35e=telegram2FaApproval['clientip']==externalip&&new Date()[_0xc327cc(0x150)]()-telegram2FaApproval[_0xc327cc(0x1d2)]<telegram2FaApproval[_0xc327cc(0x18d)]*0x3c*0x3e8),_0x26f35e;},normalizeIP=_0x48937c=>{const _0x6eeda8=_0x5d70db;let _0x275593=null,_0x215677=null;if(ipaddr[_0x6eeda8(0x13e)](_0x48937c)){const _0x5786bc=ipaddr['parse'](_0x48937c);_0x5786bc[_0x6eeda8(0x173)]()===_0x6eeda8(0x168)?(_0x5786bc[_0x6eeda8(0x1c5)]()&&(_0x275593=_0x5786bc[_0x6eeda8(0x187)]()[_0x6eeda8(0x216)]()),_0x215677=_0x5786bc[_0x6eeda8(0x216)]()):(_0x275593=_0x5786bc['toString'](),_0x215677=_0x5786bc['toIPv4MappedAddress']()['toString']());}return{'show':_0x275593?_0x275593:_0x215677,'store':_0x215677};};