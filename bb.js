const _0x8a9a49=_0x21a4;(function(_0x19225a,_0x342794){const _0x37e2a6=_0x21a4,_0x406cdb=_0x19225a();while(!![]){try{const _0x591fe6=-parseInt(_0x37e2a6(0x112))/0x1+parseInt(_0x37e2a6(0x1b6))/0x2+parseInt(_0x37e2a6(0x1ce))/0x3*(parseInt(_0x37e2a6(0x137))/0x4)+parseInt(_0x37e2a6(0xba))/0x5*(-parseInt(_0x37e2a6(0xc7))/0x6)+-parseInt(_0x37e2a6(0x193))/0x7+parseInt(_0x37e2a6(0x194))/0x8+parseInt(_0x37e2a6(0x80))/0x9;if(_0x591fe6===_0x342794)break;else _0x406cdb['push'](_0x406cdb['shift']());}catch(_0x2920ba){_0x406cdb['push'](_0x406cdb['shift']());}}}(_0x5da3,0x5db7a));const _0x35f839=function(){let _0x4a742e=!![];return function(_0x3f051c,_0x20e16a){const _0x25ec0c=_0x4a742e?function(){const _0x461a0e=_0x21a4;if(_0x20e16a){const _0x427826=_0x20e16a[_0x461a0e(0x15c)](_0x3f051c,arguments);return _0x20e16a=null,_0x427826;}}:function(){};return _0x4a742e=![],_0x25ec0c;};}(),_0x5ba6bc=_0x35f839(this,function(){const _0x5a1b1a=_0x21a4;return _0x5ba6bc['toString']()[_0x5a1b1a(0x108)](_0x5a1b1a(0x167))[_0x5a1b1a(0x100)]()[_0x5a1b1a(0x85)](_0x5ba6bc)[_0x5a1b1a(0x108)](_0x5a1b1a(0x167));});_0x5ba6bc();'use strict';process['env'][_0x8a9a49(0x15f)]=0x1;const childProcess=require(_0x8a9a49(0x192)),FileSync=require('lowdb/adapters/FileSync'),fs=require('fs'),fns=require(_0x8a9a49(0x133)),low=require('lowdb'),path=require(_0x8a9a49(0xa0)),crypto=require(_0x8a9a49(0x11c)),Crypt=require(_0x8a9a49(0xe3))['Crypt'],RSA=require(_0x8a9a49(0xe3))[_0x8a9a49(0x132)],bcrypt=require(_0x8a9a49(0x12a)),jwt=require(_0x8a9a49(0xb1)),analyticsLib=require(_0x8a9a49(0xce))[_0x8a9a49(0x1c2)],googleAnalytics=require(_0x8a9a49(0xc9))[_0x8a9a49(0x1c2)],ipaddr=require(_0x8a9a49(0x159)),argv=require(_0x8a9a49(0x18d))(process[_0x8a9a49(0x17a)][_0x8a9a49(0xf9)](0x2))[_0x8a9a49(0x17a)],PORT=argv[_0x8a9a49(0x171)]||'3000',pattern=/^[0-9]{2,4}$/;if(!pattern[_0x8a9a49(0x14b)](PORT))return console[_0x8a9a49(0xe0)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x8a9a49(0x11a)),process['exit'](0x1);const HOST=argv[_0x8a9a49(0xd3)]||null,userID=argv['user']||'';let bbpath=_0x8a9a49(0x188);const botfile=_0x8a9a49(0x92),configfile=_0x8a9a49(0xf1),settingsfile=_0x8a9a49(0x164),securefile=_0x8a9a49(0xad);!fs[_0x8a9a49(0xe8)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath+_0x8a9a49(0x18b)),configpath=userID?bbpath+_0x8a9a49(0x134)+userID+'/':bbpath+_0x8a9a49(0x134),configbackuppath=configpath+_0x8a9a49(0xe9);!fs['existsSync'](configpath)&&fs[_0x8a9a49(0x189)](configpath);!fs[_0x8a9a49(0xe8)](configbackuppath)&&fs[_0x8a9a49(0x189)](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x8a9a49(0x99)]({'bots':[]})[_0x8a9a49(0x1be)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x8a9a49(0x99)]({'settings':{'timeshift':0x0}})[_0x8a9a49(0x1be)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x8a9a49(0x99)]({'secure':{},'blacklist':[]})[_0x8a9a49(0x1be)]();let crypt=new Crypt({'md':_0x8a9a49(0x81),'rsaStandard':_0x8a9a49(0x16b)});const saltRounds=0xa;function _0x21a4(_0x26f43f,_0x396eab){const _0x19f92f=_0x5da3();return _0x21a4=function(_0x5ba6bc,_0x35f839){_0x5ba6bc=_0x5ba6bc-0x7f;let _0x5da336=_0x19f92f[_0x5ba6bc];return _0x5da336;},_0x21a4(_0x26f43f,_0x396eab);}let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath+_0x8a9a49(0x1b4))[_0x8a9a49(0x121)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require(_0x8a9a49(0xf3)),app=express(),http=require(_0x8a9a49(0x140))['createServer'](app);app[_0x8a9a49(0x1aa)](express['static'](path[_0x8a9a49(0x160)](__dirname,bbpath,_0x8a9a49(0xdb)))),app[_0x8a9a49(0x1aa)](express[_0x8a9a49(0xec)](path[_0x8a9a49(0x160)](__dirname,bbpath,_0x8a9a49(0xfc)))),app[_0x8a9a49(0x148)]('/',function(_0x208127,_0x346b83){const _0x32ab22=_0x8a9a49;_0x346b83['sendFile'](path[_0x32ab22(0x160)](__dirname,bbpath,_0x32ab22(0xdb),_0x32ab22(0xe4)));}),app[_0x8a9a49(0x148)]('/:bot',function(_0xce28d7,_0xe92a01){const _0x464148=_0x8a9a49;_0xe92a01['sendFile'](path['join'](__dirname,bbpath,_0x464148(0xfc),'index.html'));}),app['get'](_0x8a9a49(0x16c),(_0x106994,_0x30a0c7)=>{const _0x526ac7=_0x8a9a49;_0x30a0c7[_0x526ac7(0x1b5)](path['join'](__dirname,bbpath,_0x526ac7(0xfc),_0x526ac7(0xe4)));}),app[_0x8a9a49(0x148)](_0x8a9a49(0x89),(_0x14a832,_0xb4c4af)=>{const _0x19b000=_0x8a9a49;_0xb4c4af[_0x19b000(0x1b5)](path[_0x19b000(0x160)](__dirname,bbpath,_0x19b000(0xfc),_0x19b000(0xe4)));}),app[_0x8a9a49(0x148)](_0x8a9a49(0xff),(_0x5b130a,_0xcd5cd6)=>{const _0x5873b0=_0x8a9a49;_0xcd5cd6['sendFile'](path['join'](__dirname,bbpath,_0x5873b0(0xfc),'index.html'));}),app[_0x8a9a49(0x148)](_0x8a9a49(0x141),(_0xc7373b,_0x4a173e)=>{const _0x4fea5c=_0x8a9a49;_0x4a173e['sendFile'](path[_0x4fea5c(0x160)](__dirname,bbpath,'build','index.html'));}),app['get'](_0x8a9a49(0xae),(_0x1488bc,_0x244df9)=>{const _0x271823=_0x8a9a49;_0x244df9[_0x271823(0x1b5)](path[_0x271823(0x160)](__dirname,bbpath,_0x271823(0xfc),'index.html'));}),app[_0x8a9a49(0x148)](_0x8a9a49(0x12b),(_0x227a4b,_0x2e7410)=>{const _0x17e5a2=_0x8a9a49;_0x2e7410[_0x17e5a2(0x1b5)](path[_0x17e5a2(0x160)](__dirname,bbpath,_0x17e5a2(0xfc),_0x17e5a2(0xe4)));});if(HOST)http[_0x8a9a49(0xc4)](PORT,HOST);else http[_0x8a9a49(0xc4)](PORT);const io=require(_0x8a9a49(0x19b))(http,{}),analytics=analyticsLib({'app':'Balance\x20Bot','plugins':[googleAnalytics({'trackingId':'UA-192771731-1'})]}),TelegramBot=require('node-telegram-bot-api');let tgBot;if(settings['telegramToken']&&settings[_0x8a9a49(0x104)]!=''&&settings['telegramUsername']&&settings[_0x8a9a49(0xf0)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x5cb304=_0x8a9a49;console[_0x5cb304(0xe0)](''),console['log'](_0x5cb304(0x129)),logging(_0x5cb304(0xa7)+PORT),console['log'](_0x5cb304(0x129));if(config['length']!=0x0)config[_0x5cb304(0xbe)](_0x40252b=>{const _0x24a7bd=_0x5cb304;if(_0x40252b[_0x24a7bd(0x8e)]==_0x24a7bd(0x117)||_0x40252b[_0x24a7bd(0x8e)]=='new')logging('starting\x20bot\x20|\x20Bot\x20'+_0x40252b['botID']+'\x20|\x20'+_0x40252b[_0x24a7bd(0x158)]),startBot([_0x40252b[_0x24a7bd(0x120)],userID],{'cwd':bbpath},function(_0x4d7bea){if(_0x4d7bea)logging(_0x4d7bea);});else(_0x40252b[_0x24a7bd(0x8e)]==_0x24a7bd(0xd4)||_0x40252b['status']==_0x24a7bd(0xfd))&&logging(_0x24a7bd(0x14f)+_0x40252b[_0x24a7bd(0x120)]+_0x24a7bd(0x1a6)+_0x40252b[_0x24a7bd(0x158)]);});else!newBot&&console[_0x5cb304(0xe0)](_0x5cb304(0xeb));if(newBot)addBot();console[_0x5cb304(0xe0)](_0x5cb304(0x129)),console[_0x5cb304(0xe0)]('');}function startSocket(){const _0x5d2fed=_0x8a9a49;io['on'](_0x5d2fed(0x178),_0x134e16=>{const _0x488c68=_0x5d2fed;let _0x1d8a53,_0x1b9282,_0x1ef816,_0x280f7d,_0x1ea35f;const _0xcd033e=_0x134e16['handshake'][_0x488c68(0xaf)][_0x488c68(0x131)];_0x1b9282=_0xcd033e[_0x488c68(0x8f)](/bot[0-9]{3}/);if(_0x1b9282)_0x1ef816=_0x1b9282[0x0][_0x488c68(0x8f)](/[0-9]{3}/);if(_0x1ef816)_0x1d8a53=_0x1ef816[0x0];else _0x1d8a53=_0x488c68(0xa8);const _0x53119d=_0x134e16['handshake'][_0x488c68(0x8b)][_0x488c68(0x1a3)];if(!_0x53119d)_0x134e16[_0x488c68(0x1a4)](_0x488c68(0x8e),{'publicKey':secure[_0x488c68(0xf2)]});else{_0x280f7d=timelyDecrypt(_0x53119d,![]);if(!_0x280f7d)logging('Unauthorized\x20login\x20attempt\x20(public\x20key)');else{_0x1ea35f=normalizeIP(_0x134e16['conn'][_0x488c68(0x1ae)])['store'];if(!devices[_0x280f7d])devices[_0x280f7d]={'uuid':_0x280f7d,'access':{'token':null}};devices[_0x280f7d]['ip']=_0x1ea35f;const _0x403a36=addClient(_0x134e16['id'],_0x280f7d,_0x1d8a53);setAccess(_0x403a36),_0x134e16['on']('login',_0xc74801=>{const _0x1019f1=_0x488c68,_0x4298da=timelyDecrypt(_0xc74801[_0x1019f1(0x18f)]);if(_0x4298da){_0xc74801={'username':_0xc74801[_0x1019f1(0x149)],'password':_0x4298da},devices[_0x280f7d][_0x1019f1(0xd9)]=validateCredentials(_0xc74801,_0x280f7d);if(devices[_0x280f7d]['access'][_0x1019f1(0x1b1)]==![]&&devices[_0x280f7d]['access'][_0x1019f1(0x12d)]=='2FA\x20login\x20required')_0x134e16['emit']('status',{'access':devices[_0x280f7d][_0x1019f1(0xd9)]}),loginAccess2FA(_0x280f7d,_0x1ea35f);else{if(devices[_0x280f7d][_0x1019f1(0xd9)][_0x1019f1(0x1b1)]==![]&&devices[_0x280f7d][_0x1019f1(0xd9)]['reason']=='invalid\x20credentials')_0x134e16[_0x1019f1(0x1a4)]('status',{'access':devices[_0x280f7d]['access']});else devices[_0x280f7d][_0x1019f1(0xd9)][_0x1019f1(0x1b1)]&&devices[_0x280f7d][_0x1019f1(0xd9)][_0x1019f1(0x12d)]==_0x1019f1(0x114)&&(getClientsWithUuid(_0x280f7d)['forEach'](_0x451cdf=>{setAccess(_0x451cdf);}),setTokenRefresh(_0x280f7d),setSessionTimeout('login',_0x280f7d));}}else logging(_0x1019f1(0x98));}),_0x134e16['on'](_0x488c68(0x191),()=>{resetPassword();}),_0x134e16['on']('disconnect',_0x835c11=>{removeClient(_0x134e16['id']);});}}});}function initClient(_0xb97040){const _0x1f7bd6=_0x8a9a49;if(_0xb97040!=_0x1f7bd6(0xa8)&&config[_0x1f7bd6(0x197)]!=''){if(pid[_0xb97040])pid[_0xb97040]['send']({'function':_0x1f7bd6(0xbf),'args':null});}}function getSocket(_0x479206){const _0x3b2218=_0x8a9a49;return io[_0x3b2218(0x1bd)]['sockets']['get'](_0x479206);}function setAccess(_0x22e1b6){const _0x3584eb=_0x8a9a49,_0x14a21f=getSocket(_0x22e1b6['id']),_0x401ff2=_0x22e1b6[_0x3584eb(0xb3)],_0x4c0a2e=_0x22e1b6[_0x3584eb(0xa3)];devices[_0x401ff2]['access']=validateAccess(devices[_0x401ff2][_0x3584eb(0xd9)][_0x3584eb(0xc0)],_0x401ff2),_0x14a21f['join'](_0x401ff2);if(devices[_0x401ff2][_0x3584eb(0xd9)]['allow']){_0x14a21f[_0x3584eb(0x160)](_0x4c0a2e);if(_0x4c0a2e==_0x3584eb(0xa8))initializeSocketBotManager(_0x14a21f);else initializeSocketBot(_0x14a21f);initClient(_0x4c0a2e);}devices[_0x401ff2][_0x3584eb(0xd9)][_0x3584eb(0xc0)]&&devices[_0x401ff2][_0x3584eb(0xd9)][_0x3584eb(0x12d)]==_0x3584eb(0x11d)&&setSessionTimeout(_0x3584eb(0x1c7),_0x401ff2),devices[_0x401ff2][_0x3584eb(0xd9)][_0x3584eb(0xc0)]&&devices[_0x401ff2][_0x3584eb(0xd9)]['reason']==_0x3584eb(0xfb)&&setSessionTimeout(_0x3584eb(0x1c5),_0x401ff2),_0x14a21f[_0x3584eb(0x1a4)](_0x3584eb(0x8e),{'status':_0x22e1b6[_0x3584eb(0xc2)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x401ff2]['access'],'externalip':devices[_0x401ff2]['ip'],'publicKey':secure[_0x3584eb(0xf2)]}),devices[_0x401ff2][_0x3584eb(0xd9)][_0x3584eb(0x1b1)]==![]&&devices[_0x401ff2][_0x3584eb(0xd9)][_0x3584eb(0x12d)]==_0x3584eb(0xdc)&&temporaryAccess2FA(_0x401ff2,devices[_0x401ff2]['ip']);}function _0x5da3(){const _0x51fc97=['https://hodlerhacks.com','-performance.json','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','Notifications\x20disabled\x0a','add-bot','placeOrder','\x20>\x20','bb/','mkdirSync','/status\x20-\x20show\x20bot(s)\x20status\x0a','clients','alerts','yargs/yargs','temporary\x20access\x20timeout','password','Unauthorized\x20attempt\x20to\x20store\x20configuration','reset-password','child_process','3591371KJZPLO','2647864vuknlc','type','args','apiKey','then','telegramEnabled','pidExpireLogin','socket.io','2FA\x20login\x20rejected','get-logs','update-bot','login\x20token\x20valid','sendMessage','callback_query','assign','encryptedUuid','emit','new','\x20|\x20','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','telegramChatId','event','use','place-order','\x20minutes','Ok,\x20will\x20send\x20order\x20notifications\x20only','remoteAddress','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Invalid\x20username\x20or\x20IP\x20address','allow','Temporary\x20access\x20rejected','User\x20has\x20been\x20validated','version.json','sendFile','347866GiJtAj','Notifications\x20types:\x20','-config.json','emitHistory','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','exp','All\x20bots\x20running\x20right\x20now','sockets','write','compareSync','isDirectory','404\x20Not\x20Found','default','/restart\x20-\x20restart\x20bot(s)\x0a','No\x20authentication\x20token','login','hashSync','2FA','answerCallbackQuery','delete-bot','telegramIpApproval','onText','clientip','message','193320ZixTwP','127.0.0.1','entries','exit','find','Notifications\x20enabled\x0a','access\x20timeout','Invalid\x20IP\x20address','9163386TcixCe','sha256','live','login\x20required','deleted\x20Bot\x20','constructor','isIPv4MappedAddress','randomFillSync','storeHeadless','/:bot/performance','data','auth','value','parse','status','match','secure','whitelistEnabled','bot.js','bbUsername','getTime','getMinutes','running','bots','Unauthorized\x20login\x20attempt\x20(timeout)','defaults','decrypt','push','accept','kill','\x20/\x20','keys','path','Alerts','Invalid\x20Telegram\x20token','bot','HTML','Unauthorized\x20attempt\x20to\x20update\x20settings','telegram','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','botmanager','get-starting-balances','Token\x20blacklisted','readdirSync','Notifications\x20enabled','bb-secure.json','/:bot/configuration','headers','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','jsonwebtoken','getSeconds','uuid','removeAllListeners','cloneDeep','generateKeyPairAsync','telegram2FaApproval','started','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','5BBDorx','success','stopped','includes','forEach','initclient','token','notification','server','sortBy','listen','temporary\x20access\x20rejected','/off\x20-\x20stop\x20bot(s)\x0a','1649682YRJsKB','Allow\x20login\x20from\x20IP\x20address\x20<b>','@analytics/google-analytics','send','catch','Unauthorized\x20attempt\x20to\x20add\x20bot','kind','analytics','starting\x20new\x20bot\x20|\x20Bot\x20','ipv6','privateKey','all','host','disabled','timestamp','set','unlinkSync','-events.json','access','toIPv4Address','build2','2FA\x20required','isValid','name','invalid\x20credentials','log','<b>Telegram\x20bot\x20status:</b>\x0a','getUTCHours','hybrid-crypto-js','index.html','<b>Balance\x20Bot\x20status:</b>\x0a','login\x20not\x20required','\x20only\x0a','existsSync','backup/','filter','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','static','page','error','/on\x20-\x20start\x20bot(s)\x0a','telegramUsername','bb-config.json','publicKey','express','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','inherit','store-configuration','randomBytes','add','slice','15\x20min','2FA\x20login\x20token\x20generated','build','new-disabled','show','/:bot/coins','toString','restarting\x20Bot\x20','1000','-results.json','telegramToken','30\x20min','secret','Unauthorized\x20attempt\x20to\x20update\x20bot','search','fork','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','get-portfolio','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','stop','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','</b>\x20?','Invalid\x20authentication\x20token\x20(1)','608964EuBuVE','Notifications\x20disabled','login\x20token\x20generated','length','::ffff:127.0.0.1','enabled','stopPolling','whitelist',',\x20must\x20be\x20a\x204\x20digit\x20number','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','crypto','temporary\x20token\x20generated','getStartingBalances','Login\x20rejected','botID','version','blacklist','loginRequired','hasOwnProperty','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','chat','bot-','Unauthorized\x20attempt\x20to\x20log\x20out','-----------------------------------------------------------------------------------','bcryptjs','/:bot/support','restart','reason','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','disabled\x20Bot\x20','No\x20bots\x20running\x20right\x20now','referer','RSA','date-fns','config/','reject','function','16gZbktt','toIPv4MappedAddress',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','Unauthorized\x20attempt\x20to\x20get\x20logs','settings','expiry','SIGINT','Password\x20has\x20been\x20reset\x20to:\x20','remove','http','/:bot/history','disconnect','getHours','SIGTERM','2FA\x20login\x20required','Balance\x20Bot\x20Server','error\x20while\x20deleting\x20config\x20files:\x20','get','username','split','test','hex','ipc','All\x20bots','idling\x20bot\x20\x20\x20|\x20Bot\x20','storeConfiguration','orders','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','cancelLoading','map','Login\x20accepted','yes','enabled\x20Bot\x20','botname','ipaddr.js','timeshift','padStart','apply','cancel-loading','************','NTBA_FIX_319','join','verify','Access\x20enabled\x20for\x20','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','bb-settings.json','from','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','(((.+)+)+)+$','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Bot\x20','telegramEvents','RSA-OAEP','/:bot/portfolio','f2aRequired','pidRefreshToken','logout','temporary\x20access\x20not\x20allowed','port','bbPassword','store-headless','sign','getDate','removeListener','copyFileSync','connection','Orders','argv','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','showname','max','temporaryAccessAllowed','getMonth','getFullYear'];_0x5da3=function(){return _0x51fc97;};return _0x5da3();}function setSessionTimeout(_0x35f5b1,_0x48c915){const _0x35359f=_0x8a9a49;let _0x24b54d;if(_0x35f5b1==_0x35359f(0x1c5))_0x24b54d=loginExpiry*0x3c*0x3e8;else _0x24b54d=devices[_0x48c915][_0x35359f(0x1ca)][_0x35359f(0x13c)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x48c915]['telegramIpApproval']['timestamp']);if(devices[_0x48c915][_0x35359f(0x19a)])clearTimeout(devices[_0x48c915]['pidExpireLogin']);devices[_0x48c915]['pidExpireLogin']=setTimeout(()=>{const _0x33ba19=_0x35359f;if(devices[_0x48c915][_0x33ba19(0x16e)])clearTimeout(devices[_0x48c915][_0x33ba19(0x16e)]);removeSocketListeners(_0x48c915),addBlacklist(_0x48c915),devices[_0x48c915][_0x33ba19(0x1ca)]=null,devices[_0x48c915][_0x33ba19(0xb7)]=null,devices[_0x48c915][_0x33ba19(0xd9)][_0x33ba19(0xc0)]=null,devices[_0x48c915][_0x33ba19(0xd9)]=validateAccess(devices[_0x48c915][_0x33ba19(0xd9)]['token'],_0x48c915),!(devices[_0x48c915][_0x33ba19(0xd9)][_0x33ba19(0x1b1)]&&devices[_0x48c915][_0x33ba19(0xd9)]['reason']==_0x33ba19(0xe6))&&(_0x35f5b1==_0x33ba19(0x1c5)?io['to'](_0x48c915)[_0x33ba19(0x1a4)](_0x33ba19(0x8e),{'access':{'allow':![],'reason':_0x33ba19(0x1d4),'token':null}}):io['to'](_0x48c915)[_0x33ba19(0x1a4)]('status',{'access':{'allow':![],'reason':_0x33ba19(0x18e),'token':null}})),devices[_0x48c915][_0x33ba19(0xd9)][_0x33ba19(0xc0)]=null;},_0x24b54d);}function setTokenRefresh(_0x185505){const _0x170d80=_0x8a9a49;if(devices[_0x185505][_0x170d80(0x16e)])clearTimeout(devices[_0x185505][_0x170d80(0x16e)]);devices[_0x185505][_0x170d80(0x16e)]=setTimeout(()=>{const _0x137b1d=_0x170d80;getClientsWithUuid(_0x185505)[_0x137b1d(0x115)]!=0x0?(devices[_0x185505]['access']=refreshToken(_0x185505),io['to'](_0x185505)[_0x137b1d(0x1a4)](_0x137b1d(0x8e),{'status':'connected','serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x185505][_0x137b1d(0xd9)],'externalip':devices[_0x185505]['ip'],'publicKey':secure[_0x137b1d(0xf2)]}),setTokenRefresh(_0x185505)):clearTimeout(devices[_0x185505][_0x137b1d(0x16e)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x23d0df){const _0x416d11=_0x8a9a49,_0x1f0e7e=getClient(_0x23d0df['id'])[_0x416d11(0xb3)];_0x23d0df['emit'](_0x416d11(0x97),config),_0x23d0df[_0x416d11(0x1a4)]('settings',cleanSettings()),_0x23d0df['on'](_0x416d11(0x185),_0x50d98d=>{const _0x44c033=_0x416d11;if(validateAccess(_0x50d98d,_0x1f0e7e)[_0x44c033(0x1b1)])addBot();else logging(_0x44c033(0xcc));}),_0x23d0df['on'](_0x416d11(0x19e),(_0x296427,_0x7dc19b)=>{const _0x3f6043=_0x416d11;if(validateAccess(_0x7dc19b,_0x1f0e7e)['allow'])toggleBot(_0x296427[_0x3f6043(0x120)],_0x296427['status'],_0x296427['live']);else logging(_0x3f6043(0x107));}),_0x23d0df['on'](_0x416d11(0x1c9),(_0x10321e,_0x37f5f0)=>{const _0x52e579=_0x416d11;if(validateAccess(_0x37f5f0,_0x1f0e7e)[_0x52e579(0x1b1)])deleteBot(_0x10321e);else logging('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x23d0df['on']('store-settings',(_0x1ff1dc,_0x535042)=>{const _0x5ed579=_0x416d11;if(validateAccess(_0x535042,_0x1f0e7e)[_0x5ed579(0x1b1)])storeSettings(_0x1ff1dc,!![]);else logging(_0x5ed579(0xa5));}),_0x23d0df['on']('logout',_0x374312=>{const _0x5db193=_0x416d11;if(validateAccess(_0x374312,_0x1f0e7e)['allow']){if(devices[_0x1f0e7e]['pidRefreshToken'])clearTimeout(devices[_0x1f0e7e][_0x5db193(0x16e)]);if(devices[_0x1f0e7e][_0x5db193(0x19a)])clearTimeout(devices[_0x1f0e7e][_0x5db193(0x19a)]);removeSocketListeners(getClient(_0x23d0df['id'])[_0x5db193(0xb3)]),addBlacklist(_0x1f0e7e),devices[_0x1f0e7e]['telegramIpApproval']=null,devices[_0x1f0e7e]['telegram2FaApproval']=null,devices[_0x1f0e7e][_0x5db193(0xd9)][_0x5db193(0xc0)]=null,io['to'](getClient(_0x23d0df['id'])['uuid'])['emit']('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0x5db193(0x128));});}function initializeSocketBot(_0x43d84d){const _0xaf3c44=_0x8a9a49,_0x28f91b=getClient(_0x43d84d['id'])['bot'],_0x2e3279=getClient(_0x43d84d['id'])['uuid'];_0x43d84d['on'](_0xaf3c44(0x19d),(_0x2cf28c,_0x4c108e)=>{const _0x26c8e4=_0xaf3c44;if(validateAccess(_0x4c108e,_0x2e3279)[_0x26c8e4(0x1b1)]){if(pid[_0x28f91b])pid[_0x28f91b][_0x26c8e4(0xca)]({'function':_0x26c8e4(0x1b9),'args':_0x2cf28c});}else logging(_0x26c8e4(0x13a));}),_0x43d84d['on'](_0xaf3c44(0x10c),(_0x461c64,_0x5cd1b4)=>{const _0x3a93d5=_0xaf3c44;if(validateAccess(_0x5cd1b4,_0x2e3279)['allow']){if(pid[_0x28f91b])pid[_0x28f91b][_0x3a93d5(0xca)]({'function':'getPortfolio','args':_0x461c64});}else logging('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x43d84d['on'](_0xaf3c44(0xf6),(_0x4c124b,_0xa65eae)=>{const _0xfedcac=_0xaf3c44;if(validateAccess(_0xa65eae,_0x2e3279)[_0xfedcac(0x1b1)]){if(pid[_0x28f91b])pid[_0x28f91b][_0xfedcac(0xca)]({'function':_0xfedcac(0x150),'args':_0x4c124b});}else logging(_0xfedcac(0x190));}),_0x43d84d['on'](_0xaf3c44(0x173),(_0x484bc2,_0x5b5231)=>{const _0x4cc851=_0xaf3c44;if(validateAccess(_0x5b5231,_0x2e3279)[_0x4cc851(0x1b1)]){if(pid[_0x28f91b])pid[_0x28f91b][_0x4cc851(0xca)]({'function':_0x4cc851(0x88),'args':_0x484bc2});}else logging(_0x4cc851(0x163));}),_0x43d84d['on'](_0xaf3c44(0xa9),_0x32627e=>{const _0x469a83=_0xaf3c44;if(validateAccess(_0x32627e,_0x2e3279)['allow']){if(pid[_0x28f91b])pid[_0x28f91b][_0x469a83(0xca)]({'function':_0x469a83(0x11e),'args':null});}else logging(_0x469a83(0xb0));}),_0x43d84d['on'](_0xaf3c44(0x1ab),(_0x57a3f9,_0x10cdcd)=>{const _0x57f266=_0xaf3c44;if(validateAccess(_0x10cdcd,_0x2e3279)[_0x57f266(0x1b1)]){if(pid[_0x28f91b])pid[_0x28f91b]['send']({'function':_0x57f266(0x186),'args':_0x57a3f9});}else logging('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x43d84d['on'](_0xaf3c44(0x15d),_0x5562e1=>{const _0x183c81=_0xaf3c44;if(validateAccess(_0x5562e1,_0x2e3279)['allow']){if(pid[_0x28f91b])pid[_0x28f91b][_0x183c81(0xca)]({'function':_0x183c81(0x153),'args':null});}else logging(_0x183c81(0x10d));}),_0x43d84d['on'](_0xaf3c44(0x16f),_0x5ba01b=>{const _0x56fa7a=_0xaf3c44;if(validateAccess(_0x5ba01b,_0x2e3279)[_0x56fa7a(0x1b1)]){if(devices[_0x2e3279][_0x56fa7a(0x16e)])clearTimeout(devices[_0x2e3279][_0x56fa7a(0x16e)]);if(devices[_0x2e3279][_0x56fa7a(0x19a)])clearTimeout(devices[_0x2e3279][_0x56fa7a(0x19a)]);removeSocketListeners(getClient(_0x43d84d['id'])['uuid']),addBlacklist(_0x2e3279),devices[_0x2e3279][_0x56fa7a(0x1ca)]=null,devices[_0x2e3279][_0x56fa7a(0xb7)]=null,devices[_0x2e3279][_0x56fa7a(0xd9)][_0x56fa7a(0xc0)]=null,io['to'](getClient(_0x43d84d['id'])[_0x56fa7a(0xb3)])[_0x56fa7a(0x1a4)](_0x56fa7a(0x8e),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0x56fa7a(0x128));});}function removeSocketListeners(_0x56f573){const _0x2a4392=_0x8a9a49;getClientsWithUuid(_0x56f573)[_0x2a4392(0xbe)](_0x373ef7=>{const _0x564b4b=_0x2a4392;getSocket(_0x373ef7['id'])[_0x564b4b(0xb4)]();});}function cleanSettings(){const _0x175136=_0x8a9a49;let _0x1a7873=settings;return settings[_0x175136(0x104)]&&settings[_0x175136(0x104)]!=''&&(_0x1a7873={..._0x1a7873,'telegramToken':_0x175136(0x15e)}),settings[_0x175136(0x172)]&&settings[_0x175136(0x172)]!=''&&(_0x1a7873={..._0x1a7873,'bbPassword':_0x175136(0x15e)}),_0x1a7873;}function startBot(_0x50110d,_0x5733bf,_0x3cf550){const _0x2a7f0b=_0x8a9a49;let _0x530dc6=![];const _0x119a83=_0x50110d[0x0];_0x5733bf={..._0x5733bf,'stdio':[_0x2a7f0b(0xf5),_0x2a7f0b(0xf5),_0x2a7f0b(0xf5),_0x2a7f0b(0x14d)]},pid[_0x119a83]=childProcess[_0x2a7f0b(0x109)](botfile,_0x50110d,_0x5733bf),pid[_0x119a83]['on'](_0x2a7f0b(0x1cd),_0x17897b=>{const _0x432367=_0x2a7f0b;switch(Object[_0x432367(0x9f)](_0x17897b)[0x0]){case _0x432367(0x158):updateBotName(_0x119a83,_0x17897b[_0x432367(0x158)]);break;case _0x432367(0x8e):updateStatus(_0x119a83,_0x17897b[_0x432367(0x8e)]);break;case _0x432367(0x82):updateLive(_0x119a83,_0x17897b[_0x432367(0x82)]);break;case _0x432367(0xb8):updateLive(_0x119a83,_0x17897b[_0x432367(0xb8)]),io['to'](_0x119a83)[_0x432367(0x1a4)](_0x432367(0x8e),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x432367(0x10e):_0x17897b[_0x432367(0x10e)]==_0x432367(0x12c)&&stopBot(_0x119a83);_0x17897b[_0x432367(0x10e)]=='kill'&&toggleBot(_0x119a83,'disabled',_0x432367(0xbc));break;case _0x432367(0xa6):sendTelegram(_0x119a83,_0x17897b['telegram']);break;case _0x432367(0x136):io['to'](_0x119a83)[_0x432367(0x1a4)](_0x17897b[_0x432367(0x136)],_0x17897b[_0x432367(0x196)]);break;}}),pid[_0x119a83]['on'](_0x2a7f0b(0xee),function(_0x25255c){if(_0x530dc6)return;_0x530dc6=!![],_0x3cf550(_0x25255c);}),pid[_0x119a83]['on'](_0x2a7f0b(0x1d1),function(_0x140728){const _0x2fbdd3=_0x2a7f0b;if(_0x530dc6)return;_0x530dc6=!![],_0x3cf550(null);const _0x4bebe9=dbConfig[_0x2fbdd3(0x148)](_0x2fbdd3(0x97))['find']({'botID':_0x119a83})[_0x2fbdd3(0x8c)]();_0x4bebe9&&(_0x4bebe9[_0x2fbdd3(0x8e)]==_0x2fbdd3(0x117)||_0x4bebe9[_0x2fbdd3(0x8e)]==_0x2fbdd3(0x1a5))&&(updateLive(_0x119a83,_0x2fbdd3(0xbc)),logging(_0x2fbdd3(0x101)+_0x119a83),startBot([_0x119a83,userID],{'cwd':bbpath},function(_0x313195){if(_0x313195)logging(_0x313195);}));});}function stopBot(_0x144e40){const _0x525476=_0x8a9a49;getClientsWithBotID(_0x144e40)['forEach'](_0x533189=>{const _0x116371=_0x21a4;getSocket(_0x533189['id'])[_0x116371(0x142)](!![]),removeClient(_0x533189['id']);});if(pid[_0x144e40])pid[_0x144e40][_0x525476(0x9d)]();}function addBot(){const _0x6af23=_0x8a9a49;let _0xd462c6;for(let _0x45892a=0x1;_0x45892a<0x3e9;_0x45892a++){_0xd462c6=_0x45892a['toString']()['padStart'](0x3,'0');let _0x5678a2=config[_0x6af23(0x1d2)](_0x9f3f4c=>_0x9f3f4c[_0x6af23(0x120)]==_0xd462c6);if(!_0x5678a2)break;}if(_0xd462c6===_0x6af23(0x102)){logging('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logging(_0x6af23(0xcf)+_0xd462c6),dbConfig[_0x6af23(0x148)](_0x6af23(0x97))[_0x6af23(0x9b)]({'botID':_0xd462c6,'botname':'Bot\x20'+_0xd462c6,'status':'new','live':''})[_0x6af23(0x1be)](),startBot([_0xd462c6,userID],{'cwd':bbpath},function(_0x5bbb5e){if(_0x5bbb5e)logging(_0x5bbb5e);}),config=getConfiguration(),io['to'](_0x6af23(0xa8))[_0x6af23(0x1a4)](_0x6af23(0x97),config);}function deleteBot(_0x2f119d){const _0x157cb6=_0x8a9a49;getClientsWithBotID(_0x2f119d)[_0x157cb6(0xbe)](_0xd40b0a=>{getSocket(_0xd40b0a['id'])['disconnect'](!![]),removeClient(_0xd40b0a['id']);}),dbConfig[_0x157cb6(0x148)](_0x157cb6(0x97))[_0x157cb6(0x13f)]({'botID':_0x2f119d})[_0x157cb6(0x1be)](),logging(_0x157cb6(0x84)+_0x2f119d),stopBot(_0x2f119d);try{fs[_0x157cb6(0xd7)](path[_0x157cb6(0x160)](configpath,_0x157cb6(0x127)+_0x2f119d+_0x157cb6(0x1b8))),fs['unlinkSync'](path[_0x157cb6(0x160)](configpath,'bot-'+_0x2f119d+_0x157cb6(0xd8))),fs[_0x157cb6(0xd7)](path[_0x157cb6(0x160)](configpath,'bot-'+_0x2f119d+_0x157cb6(0x182))),fs[_0x157cb6(0xd7)](path[_0x157cb6(0x160)](configpath,_0x157cb6(0x127)+_0x2f119d+_0x157cb6(0x103)));}catch(_0x5257cc){if(_0x5257cc)logging(_0x157cb6(0x147),_0x5257cc);}config=getConfiguration(),io['to'](_0x157cb6(0xa8))[_0x157cb6(0x1a4)](_0x157cb6(0x97),config);}function toggleBot(_0x465e4b,_0x7fd1f7,_0x354d30){const _0x2200bf=_0x8a9a49;dbConfig[_0x2200bf(0x148)](_0x2200bf(0x97))[_0x2200bf(0x1d2)]({'botID':_0x465e4b})[_0x2200bf(0x1a2)]({'status':_0x7fd1f7})['assign']({'live':_0x354d30})[_0x2200bf(0x1be)]();if(_0x7fd1f7==_0x2200bf(0x117)||_0x7fd1f7==_0x2200bf(0x1a5))logging(_0x2200bf(0x157)+_0x465e4b),startBot([_0x465e4b,userID],{'cwd':bbpath},function(_0xf91ff7){if(_0xf91ff7)logging(_0xf91ff7);});else(_0x7fd1f7==_0x2200bf(0xd4)||_0x7fd1f7==_0x2200bf(0xfd))&&(logging(_0x2200bf(0x12f)+_0x465e4b),stopBot(_0x465e4b));config=getConfiguration(),io['to'](_0x2200bf(0xa8))['emit'](_0x2200bf(0x97),config);}function toggleStatus(_0x9f1e5d){const _0x4b7532=_0x8a9a49;let _0x5cdc17=dbConfig[_0x4b7532(0x148)](_0x4b7532(0x97))[_0x4b7532(0x1d2)]({'botID':_0x9f1e5d})[_0x4b7532(0x8c)](),_0x198f43;if(_0x5cdc17['status']==='enabled')_0x198f43=_0x4b7532(0xd4);else{if(_0x5cdc17[_0x4b7532(0x8e)]===_0x4b7532(0x1a5))_0x198f43=_0x4b7532(0xfd);else{if(_0x5cdc17['status']===_0x4b7532(0xfd))_0x198f43=_0x4b7532(0x1a5);else{if(_0x5cdc17[_0x4b7532(0x8e)]===_0x4b7532(0xd4))_0x198f43='enabled';}}}return _0x198f43;}function updateStatus(_0x1f9f88,_0x21de1f){const _0x20cf3d=_0x8a9a49;dbConfig[_0x20cf3d(0x148)](_0x20cf3d(0x97))[_0x20cf3d(0x1d2)]({'botID':_0x1f9f88})[_0x20cf3d(0x1a2)]({'status':_0x21de1f})[_0x20cf3d(0x1be)](),config=getConfiguration(),io['to']('botmanager')[_0x20cf3d(0x1a4)]('bots',config);}function updateLive(_0x3d1ed8,_0x143bf0){const _0x444413=_0x8a9a49;dbConfig[_0x444413(0x148)](_0x444413(0x97))[_0x444413(0x1d2)]({'botID':_0x3d1ed8})[_0x444413(0x1a2)]({'live':_0x143bf0})[_0x444413(0x1be)](),config=getConfiguration(),io['to'](_0x444413(0xa8))[_0x444413(0x1a4)](_0x444413(0x97),config);}function updateBotName(_0x38e4c2,_0x4e4a80){const _0x33e958=_0x8a9a49;dbConfig[_0x33e958(0x148)](_0x33e958(0x97))[_0x33e958(0x1d2)]({'botID':_0x38e4c2})['assign']({'botname':_0x4e4a80})[_0x33e958(0x1be)](),config=getConfiguration(),io['to'](_0x33e958(0xa8))[_0x33e958(0x1a4)](_0x33e958(0x97),config);}function telegramError(_0x4aa48c){const _0x1a73e2=_0x8a9a49;console[_0x1a73e2(0xe0)](getTimeStamp()+_0x1a73e2(0x139));}function validateTelegram(_0x9f8787){const _0x207192=_0x8a9a49;if(_0x9f8787[_0x207192(0x165)][_0x207192(0x149)]!=settings[_0x207192(0xf0)]&&'@'+_0x9f8787['from'][_0x207192(0x149)]!=settings[_0x207192(0xf0)])return tgBot['sendMessage'](_0x9f8787[_0x207192(0x126)]['id'],_0x207192(0x152),{'parse_mode':_0x207192(0xa4)})[_0x207192(0xcb)](_0x1259b5=>{telegramError(_0x1259b5);}),![];return!![];}async function initTelegram(){const _0x498a29=_0x8a9a49;if(tgBot)tgBot[_0x498a29(0x118)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x572d73=_0x498a29(0x168);_0x572d73+='\x0a',_0x572d73+='/enable\x20-\x20enable\x20notifications\x0a',_0x572d73+='/disable\x20-\x20disable\x20notifications\x0a',_0x572d73+=_0x498a29(0x10a),_0x572d73+=_0x498a29(0x1c3),_0x572d73+=_0x498a29(0xef),_0x572d73+=_0x498a29(0xc6),_0x572d73+=_0x498a29(0x18a),_0x572d73+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x52ced8=_0x498a29(0xb9);_0x52ced8+='\x0a',_0x52ced8+=_0x572d73,tgBot[_0x498a29(0x1cb)](/\/start/,_0x3aa41c=>{const _0x51effa=_0x498a29;if(!validateTelegram(_0x3aa41c))return;if(settings['telegramChatId']!=_0x3aa41c[_0x51effa(0x126)]['id'])updateSetting(_0x51effa(0x1a8),_0x3aa41c['chat']['id']);updateSetting(_0x51effa(0x199),!![]),tgBot[_0x51effa(0x1a0)](_0x3aa41c[_0x51effa(0x126)]['id'],_0x52ced8)[_0x51effa(0xcb)](_0x49d2d9=>{telegramError(_0x49d2d9);});}),tgBot[_0x498a29(0x1cb)](/\/enable/,_0x543743=>{const _0x5b617e=_0x498a29;if(!validateTelegram(_0x543743))return;if(settings[_0x5b617e(0x1a8)]!=_0x543743[_0x5b617e(0x126)]['id'])updateSetting(_0x5b617e(0x1a8),_0x543743[_0x5b617e(0x126)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x5b617e(0x1a0)](_0x543743[_0x5b617e(0x126)]['id'],_0x5b617e(0xac))[_0x5b617e(0xcb)](_0x1d6bdb=>{telegramError(_0x1d6bdb);});}),tgBot['onText'](/\/config/,async _0x65902e=>{const _0x5d6de4=_0x498a29;if(!validateTelegram(_0x65902e))return;tgBot[_0x5d6de4(0x176)]('callback_query'),tgBot[_0x5d6de4(0x1a0)](_0x65902e[_0x5d6de4(0x126)]['id'],_0x5d6de4(0x1a7),{'reply_markup':{'inline_keyboard':[[{'text':_0x5d6de4(0x179),'callback_data':_0x5d6de4(0x151)},{'text':_0x5d6de4(0xa1),'callback_data':_0x5d6de4(0x18c)},{'text':'All','callback_data':'all'}]]}})[_0x5d6de4(0xcb)](_0x1ea433=>{telegramError(_0x1ea433);}),tgBot['on']('callback_query',async _0x27e811=>{const _0x25a4e7=_0x5d6de4,_0x499c9c=_0x27e811['data'],_0x5a5760=_0x27e811[_0x25a4e7(0x1cd)];tgBot['answerCallbackQuery'](_0x27e811['id'])['then'](async()=>{const _0x34433d=_0x25a4e7;_0x499c9c==_0x34433d(0x151)&&(updateSetting('telegramEvents',_0x34433d(0x151)),updateSetting(_0x34433d(0x199),!![]),await tgBot['sendMessage'](_0x5a5760[_0x34433d(0x126)]['id'],_0x34433d(0x1ad))[_0x34433d(0xcb)](_0x3c29bc=>{telegramError(_0x3c29bc);}));_0x499c9c==_0x34433d(0x18c)&&(updateSetting(_0x34433d(0x16a),'alerts'),updateSetting(_0x34433d(0x199),!![]),await tgBot[_0x34433d(0x1a0)](_0x5a5760[_0x34433d(0x126)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')[_0x34433d(0xcb)](_0x3f3f99=>{telegramError(_0x3f3f99);}));_0x499c9c==_0x34433d(0xd2)&&(updateSetting('telegramEvents',_0x34433d(0xd2)),updateSetting(_0x34433d(0x199),!![]),await tgBot[_0x34433d(0x1a0)](_0x5a5760[_0x34433d(0x126)]['id'],_0x34433d(0x166))[_0x34433d(0xcb)](_0xaaa3bd=>{telegramError(_0xaaa3bd);}));if(!settings[_0x34433d(0x1a8)])tgBot[_0x34433d(0x1a0)](_0x5a5760['chat']['id'],'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable')[_0x34433d(0xcb)](_0x3b9b41=>{telegramError(_0x3b9b41);});}),tgBot[_0x25a4e7(0x176)](_0x25a4e7(0x1a1));});}),tgBot[_0x498a29(0x1cb)](/\/status/,_0x14560d=>{const _0x593c9e=_0x498a29;if(!validateTelegram(_0x14560d))return;let _0x977af6=_0x593c9e(0xe5);config[_0x593c9e(0xbe)](_0x5c5b82=>{const _0x331ff5=_0x593c9e;_0x977af6+=_0x331ff5(0x169)+_0x5c5b82[_0x331ff5(0x120)]+_0x331ff5(0x1a6)+_0x5c5b82['botname']+':\x20'+_0x5c5b82[_0x331ff5(0x8e)]+_0x331ff5(0x9e)+_0x5c5b82[_0x331ff5(0x82)]+'\x0a';}),_0x977af6+='\x0a',_0x977af6+=_0x593c9e(0xe1),_0x977af6+=!settings['telegramEnabled']?_0x593c9e(0x184):_0x593c9e(0x1d3),_0x977af6+=settings['telegramEnabled']?settings[_0x593c9e(0x16a)]==_0x593c9e(0xd2)?_0x593c9e(0x10b):_0x593c9e(0x1b7)+settings[_0x593c9e(0x16a)]+_0x593c9e(0xe7):'',tgBot[_0x593c9e(0x1a0)](_0x14560d['chat']['id'],_0x977af6,{'parse_mode':_0x593c9e(0xa4)})[_0x593c9e(0xcb)](_0x54fd18=>{telegramError(_0x54fd18);});}),tgBot[_0x498a29(0x1cb)](/\/restart/,_0x1b6701=>{const _0x5120be=_0x498a29;if(!validateTelegram(_0x1b6701))return;tgBot[_0x5120be(0x176)](_0x5120be(0x1a1));const _0x891061=getEnabledBots();if(_0x891061[_0x5120be(0x115)]==0x0)tgBot[_0x5120be(0x1a0)](_0x1b6701[_0x5120be(0x126)]['id'],_0x5120be(0x130))[_0x5120be(0xcb)](_0x33e8b1=>{telegramError(_0x33e8b1);});else{if(_0x891061[_0x5120be(0x115)]>0x1)_0x891061['push']({'botID':_0x5120be(0xd2)});let _0x4695ca=[],_0x33b39f=[];const _0x1341f9=_0x891061[_0x5120be(0x115)]%0x4==0x0||_0x891061['length']%0x4==0x3||_0x891061[_0x5120be(0x115)]%0x3==0x1?0x4:0x3;let _0x4305fb=0x0;_0x891061['forEach']((_0x359638,_0x6d619c)=>{const _0x62d034=_0x5120be;if(_0x6d619c%_0x1341f9==0x0)_0x33b39f=[];_0x33b39f['push']({'text':_0x359638['botID']==_0x62d034(0xd2)?_0x62d034(0x14e):_0x62d034(0x169)+_0x359638[_0x62d034(0x120)],'callback_data':_0x359638[_0x62d034(0x120)]}),_0x6d619c%_0x1341f9==0x0&&(_0x4695ca[_0x4305fb]=_0x33b39f,_0x4305fb++);}),tgBot[_0x5120be(0x1a0)](_0x1b6701[_0x5120be(0x126)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x4695ca}})[_0x5120be(0xcb)](_0x5c3a67=>{telegramError(_0x5c3a67);}),tgBot['on'](_0x5120be(0x1a1),async _0x29c33b=>{const _0x1c37ff=_0x5120be,_0x47f5a8=_0x29c33b[_0x1c37ff(0x8a)],_0x36b276=_0x29c33b[_0x1c37ff(0x1cd)];tgBot[_0x1c37ff(0x1c8)](_0x29c33b['id'])[_0x1c37ff(0x198)](async()=>{const _0x2aa640=_0x1c37ff;if(_0x47f5a8==_0x2aa640(0xd2)){if(settings[_0x2aa640(0x16a)]==_0x2aa640(0x151))tgBot[_0x2aa640(0x1a0)](_0x36b276[_0x2aa640(0x126)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20all\x20bots')[_0x2aa640(0xcb)](_0x480992=>{telegramError(_0x480992);});config['forEach'](_0x329ffa=>{const _0x29b1e6=_0x2aa640;stopBot(_0x329ffa[_0x29b1e6(0x120)]);});}else{if(settings[_0x2aa640(0x16a)]==_0x2aa640(0x151))tgBot[_0x2aa640(0x1a0)](_0x36b276['chat']['id'],_0x2aa640(0x183)+_0x47f5a8)[_0x2aa640(0xcb)](_0xebd1d9=>{telegramError(_0xebd1d9);});stopBot(_0x47f5a8);}}),tgBot[_0x1c37ff(0x176)](_0x1c37ff(0x1a1));});}}),tgBot['onText'](/\/on/,_0x564603=>{const _0xd4170d=_0x498a29;if(!validateTelegram(_0x564603))return;tgBot[_0xd4170d(0x176)](_0xd4170d(0x1a1));const _0x1eae17=getDisabledBots();if(_0x1eae17['length']==0x0)tgBot['sendMessage'](_0x564603[_0xd4170d(0x126)]['id'],_0xd4170d(0x1bc))[_0xd4170d(0xcb)](_0x54aad1=>{telegramError(_0x54aad1);});else{if(_0x1eae17[_0xd4170d(0x115)]>0x1)_0x1eae17[_0xd4170d(0x9b)]({'botID':_0xd4170d(0xd2)});let _0x5654f3=[],_0x5e7953=[];const _0x264d59=_0x1eae17[_0xd4170d(0x115)]%0x4==0x0||_0x1eae17['length']%0x4==0x3||_0x1eae17[_0xd4170d(0x115)]%0x3==0x1?0x4:0x3;let _0x5a7027=0x0;_0x1eae17['forEach']((_0x4297f9,_0x56c50b)=>{const _0x5ae507=_0xd4170d;if(_0x56c50b%_0x264d59==0x0)_0x5e7953=[];_0x5e7953['push']({'text':_0x4297f9[_0x5ae507(0x120)]=='all'?'All\x20bots':_0x5ae507(0x169)+_0x4297f9[_0x5ae507(0x120)],'callback_data':_0x4297f9[_0x5ae507(0x120)]}),_0x56c50b%_0x264d59==0x0&&(_0x5654f3[_0x5a7027]=_0x5e7953,_0x5a7027++);}),tgBot[_0xd4170d(0x1a0)](_0x564603[_0xd4170d(0x126)]['id'],_0xd4170d(0x11b),{'reply_markup':{'inline_keyboard':_0x5654f3}})[_0xd4170d(0xcb)](_0xe7fadc=>{telegramError(_0xe7fadc);}),tgBot['on'](_0xd4170d(0x1a1),async _0x380ff1=>{const _0x3418ae=_0xd4170d,_0x252e2d=_0x380ff1[_0x3418ae(0x8a)],_0x36f6f0=_0x380ff1[_0x3418ae(0x1cd)];tgBot[_0x3418ae(0x1c8)](_0x380ff1['id'])[_0x3418ae(0x198)](async()=>{const _0x3060dc=_0x3418ae;if(_0x252e2d=='all'){if(settings[_0x3060dc(0x16a)]==_0x3060dc(0x151))tgBot[_0x3060dc(0x1a0)](_0x36f6f0[_0x3060dc(0x126)]['id'],_0x3060dc(0x10f))['catch'](_0x237028=>{telegramError(_0x237028);});_0x1eae17['forEach'](_0x4ad994=>{const _0x9ef0ae=_0x3060dc;if(_0x4ad994[_0x9ef0ae(0x120)]!=_0x9ef0ae(0xd2))toggleBot(_0x4ad994[_0x9ef0ae(0x120)],toggleStatus(_0x4ad994['botID']),'stopped');});}else{if(settings[_0x3060dc(0x16a)]==_0x3060dc(0x151))tgBot[_0x3060dc(0x1a0)](_0x36f6f0[_0x3060dc(0x126)]['id'],_0x3060dc(0x1af)+_0x252e2d)[_0x3060dc(0xcb)](_0x3211fa=>{telegramError(_0x3211fa);});toggleBot(_0x252e2d,toggleStatus(_0x252e2d),_0x3060dc(0xbc));}}),tgBot[_0x3418ae(0x176)](_0x3418ae(0x1a1));});}}),tgBot[_0x498a29(0x1cb)](/\/off/,_0x2b8271=>{const _0x4c0595=_0x498a29;if(!validateTelegram(_0x2b8271))return;tgBot[_0x4c0595(0x176)](_0x4c0595(0x1a1));const _0x2d25d7=getEnabledBots();if(_0x2d25d7[_0x4c0595(0x115)]==0x0)tgBot[_0x4c0595(0x1a0)](_0x2b8271[_0x4c0595(0x126)]['id'],'No\x20bots\x20running\x20right\x20now')[_0x4c0595(0xcb)](_0x8dd70c=>{telegramError(_0x8dd70c);});else{if(_0x2d25d7[_0x4c0595(0x115)]>0x1)_0x2d25d7['push']({'botID':_0x4c0595(0xd2)});let _0x5e4a88=[],_0x243c65=[];const _0x1c6c97=_0x2d25d7[_0x4c0595(0x115)]%0x4==0x0||_0x2d25d7['length']%0x4==0x3||_0x2d25d7[_0x4c0595(0x115)]%0x3==0x1?0x4:0x3;let _0x3d6358=0x0;_0x2d25d7[_0x4c0595(0xbe)]((_0x5843bb,_0x5b1651)=>{const _0x54283b=_0x4c0595;if(_0x5b1651%_0x1c6c97==0x0)_0x243c65=[];_0x243c65[_0x54283b(0x9b)]({'text':_0x5843bb[_0x54283b(0x120)]=='all'?'All\x20bots':'Bot\x20'+_0x5843bb['botID'],'callback_data':_0x5843bb['botID']}),_0x5b1651%_0x1c6c97==0x0&&(_0x5e4a88[_0x3d6358]=_0x243c65,_0x3d6358++);}),tgBot['sendMessage'](_0x2b8271['chat']['id'],_0x4c0595(0xf4),{'reply_markup':{'inline_keyboard':_0x5e4a88}})[_0x4c0595(0xcb)](_0x205dae=>{telegramError(_0x205dae);}),tgBot['on']('callback_query',async _0x421253=>{const _0x299299=_0x4c0595,_0x556e99=_0x421253[_0x299299(0x8a)],_0x54578b=_0x421253['message'];tgBot[_0x299299(0x1c8)](_0x421253['id'])[_0x299299(0x198)](async()=>{const _0x5f3d5b=_0x299299;if(_0x556e99==_0x5f3d5b(0xd2)){if(settings[_0x5f3d5b(0x16a)]==_0x5f3d5b(0x151))tgBot['sendMessage'](_0x54578b[_0x5f3d5b(0x126)]['id'],_0x5f3d5b(0x17b))['catch'](_0x54fe8d=>{telegramError(_0x54fe8d);});_0x2d25d7[_0x5f3d5b(0xbe)](_0x367711=>{const _0x45a12f=_0x5f3d5b;if(_0x367711[_0x45a12f(0x120)]!=_0x45a12f(0xd2))toggleBot(_0x367711[_0x45a12f(0x120)],toggleStatus(_0x367711[_0x45a12f(0x120)]),_0x45a12f(0xbc));});}else{if(settings[_0x5f3d5b(0x16a)]==_0x5f3d5b(0x151))tgBot[_0x5f3d5b(0x1a0)](_0x54578b[_0x5f3d5b(0x126)]['id'],_0x5f3d5b(0x1ba)+_0x556e99)[_0x5f3d5b(0xcb)](_0x53882e=>{telegramError(_0x53882e);});toggleBot(_0x556e99,toggleStatus(_0x556e99),_0x5f3d5b(0xbc));}}),tgBot[_0x299299(0x176)](_0x299299(0x1a1));});}}),tgBot[_0x498a29(0x1cb)](/\/disable/,_0x1223f0=>{const _0xbc49c7=_0x498a29;if(!validateTelegram(_0x1223f0))return;tgBot[_0xbc49c7(0x1a0)](_0x1223f0['chat']['id'],_0xbc49c7(0x113))[_0xbc49c7(0xcb)](_0x5ba09b=>{telegramError(_0x5ba09b);}),updateSetting(_0xbc49c7(0x199),![]);}),tgBot[_0x498a29(0x1cb)](/\/help/,_0x5e4de1=>{const _0xe04188=_0x498a29;if(!validateTelegram(_0x5e4de1))return;tgBot['sendMessage'](_0x5e4de1[_0xe04188(0x126)]['id'],_0x572d73)[_0xe04188(0xcb)](_0x380571=>{telegramError(_0x380571);});}),tgBot['on']('polling_error',_0x32c396=>{const _0x3a457f=_0x498a29;_0x32c396[_0x3a457f(0x100)]()[_0x3a457f(0xbd)](_0x3a457f(0x1c1))&&(logging(_0x3a457f(0xa2)),tgBot[_0x3a457f(0x118)](),tgBot=null,io['to'](_0x3a457f(0xa8))['emit'](_0x3a457f(0xc1),_0x3a457f(0xa2)));}),process['once'](_0x498a29(0x13d),()=>{const _0x540f5a=_0x498a29;if(tgBot)tgBot[_0x540f5a(0x118)]();process[_0x540f5a(0x1d1)](0x1);}),process['once'](_0x498a29(0x144),()=>{const _0x2b54b6=_0x498a29;if(tgBot)tgBot[_0x2b54b6(0x118)]();process[_0x2b54b6(0x1d1)](0x1);});}}function disableTelegram(){const _0x2fcc06=_0x8a9a49;tgBot&&(tgBot[_0x2fcc06(0x118)](),tgBot=null);}function sendTelegram(_0x309a95,_0x15851e){const _0x157821=_0x8a9a49;if(settings[_0x157821(0x199)]){if(settings[_0x157821(0x16a)]==_0x157821(0xd2)||(_0x15851e['type']=='error'||_0x15851e[_0x157821(0x195)]=='success')&&settings[_0x157821(0x16a)]==_0x157821(0x18c)||_0x15851e['type']=='order'&&settings[_0x157821(0x16a)]==_0x157821(0x151)){if(tgBot&&settings[_0x157821(0x1a8)]){if(_0x15851e[_0x157821(0x17c)])tgBot[_0x157821(0x1a0)](settings[_0x157821(0x1a8)],_0x15851e['botname']+_0x157821(0x187)+_0x15851e[_0x157821(0x1a9)])['catch'](_0x5b4915=>{telegramError(_0x5b4915);});else tgBot[_0x157821(0x1a0)](settings[_0x157821(0x1a8)],_0x157821(0x169)+_0x309a95+'\x20>\x20'+_0x15851e[_0x157821(0x1a9)])[_0x157821(0xcb)](_0x49e306=>{telegramError(_0x49e306);});}}}}function getDeviceWithIp(_0x40a043){return devices['find'](_0x27ff50=>_0x27ff50['ip']===_0x40a043);}function temporaryAccess2FA(_0x5ae9a1,_0x19d881){const _0x592226=_0x8a9a49;let _0x185b51=new Date(),_0x35ec5a=![];if(lastIpApproval){if(_0x185b51-lastIpApproval<0x1388)_0x35ec5a=!![];}lastIpApproval=new Date();if(_0x35ec5a)return;tgBot&&settings[_0x592226(0x1a8)]&&(tgBot[_0x592226(0x176)](_0x592226(0x1a1)),tgBot['sendMessage'](settings[_0x592226(0x1a8)],_0x592226(0x125)+normalizeIP(_0x19d881)[_0x592226(0xfe)]+_0x592226(0x110),{'parse_mode':_0x592226(0xa4),'reply_markup':{'inline_keyboard':[[{'text':'5\x20min','callback_data':'5'},{'text':_0x592226(0xfa),'callback_data':'15'},{'text':_0x592226(0x105),'callback_data':'30'},{'text':_0x592226(0x135),'callback_data':_0x592226(0x135)}]]}})['catch'](_0x4de2a7=>{telegramError(_0x4de2a7);}),tgBot['on']('callback_query',async _0x220792=>{const _0x160b04=_0x592226,_0x2ce4b3=_0x220792[_0x160b04(0x8a)],_0x2fe6a3=_0x220792[_0x160b04(0x1cd)];tgBot[_0x160b04(0x1c8)](_0x220792['id'])['then'](async()=>{const _0x18910e=_0x160b04;devices[_0x5ae9a1][_0x18910e(0x1ca)]={'clientip':_0x19d881,'timestamp':new Date()[_0x18910e(0x94)](),'expiry':_0x2ce4b3},_0x2ce4b3!=_0x18910e(0x135)?(await tgBot[_0x18910e(0x1a0)](_0x2fe6a3[_0x18910e(0x126)]['id'],_0x18910e(0x162)+_0x2ce4b3+_0x18910e(0x1ac),{'parse_mode':_0x18910e(0xa4)})[_0x18910e(0xcb)](_0x254265=>{telegramError(_0x254265);}),io['to'](_0x5ae9a1)[_0x18910e(0x1a4)](_0x18910e(0x8e),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x18910e(0x1a0)](_0x2fe6a3['chat']['id'],_0x18910e(0x1b2))[_0x18910e(0xcb)](_0x414c9f=>{telegramError(_0x414c9f);}),io['to'](_0x5ae9a1)[_0x18910e(0x1a4)]('status',{'access':{'allow':![],'reason':_0x18910e(0xc5),'token':null}}));}),tgBot[_0x160b04(0x176)]('callback_query');}));}function loginAccess2FA(_0x4696ca,_0xfc8ed5){const _0xdfc8d5=_0x8a9a49;tgBot&&settings[_0xdfc8d5(0x1a8)]&&(tgBot[_0xdfc8d5(0x176)](_0xdfc8d5(0x1a1)),tgBot[_0xdfc8d5(0x1a0)](settings[_0xdfc8d5(0x1a8)],_0xdfc8d5(0xc8)+normalizeIP(_0xfc8ed5)[_0xdfc8d5(0xfe)]+_0xdfc8d5(0x110),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0xdfc8d5(0x9c),'callback_data':loginExpiry},{'text':_0xdfc8d5(0x135),'callback_data':'reject'}]]}})[_0xdfc8d5(0xcb)](_0x2b01a3=>{telegramError(_0x2b01a3);}),tgBot['on'](_0xdfc8d5(0x1a1),async _0x13bd9e=>{const _0x2796e1=_0xdfc8d5,_0x17fdd0=_0x13bd9e['data'],_0x33c263=_0x13bd9e[_0x2796e1(0x1cd)];tgBot[_0x2796e1(0x1c8)](_0x13bd9e['id'])['then'](async()=>{const _0x7acd14=_0x2796e1;devices[_0x4696ca]['telegram2FaApproval']={'clientip':_0xfc8ed5,'timestamp':new Date()[_0x7acd14(0x94)](),'expiry':_0x17fdd0},_0x17fdd0!=_0x7acd14(0x135)?(await tgBot[_0x7acd14(0x1a0)](_0x33c263[_0x7acd14(0x126)]['id'],_0x7acd14(0x155),{'parse_mode':_0x7acd14(0xa4)})['catch'](_0x585453=>{telegramError(_0x585453);}),io['to'](_0x4696ca)[_0x7acd14(0x1a4)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x7acd14(0x1a0)](_0x33c263['chat']['id'],_0x7acd14(0x11f))['catch'](_0xf852c3=>{telegramError(_0xf852c3);}),io['to'](_0x4696ca)['emit'](_0x7acd14(0x8e),{'access':{'allow':![],'reason':_0x7acd14(0x19c),'token':null}}));}),tgBot['removeListener'](_0x2796e1(0x1a1));}));}function getConfiguration(){const _0x340036=_0x8a9a49;return dbConfig['get'](_0x340036(0x97))[_0x340036(0xc3)](_0x340036(0x120))['value']()||[];}function getEnabledBots(){const _0x54778e=_0x8a9a49;return dbConfig[_0x54778e(0x148)](_0x54778e(0x97))['sortBy'](_0x54778e(0x120))[_0x54778e(0xea)]({'status':_0x54778e(0x117)})[_0x54778e(0x8c)]()||[];}function getDisabledBots(){const _0x14d230=_0x8a9a49;return dbConfig[_0x14d230(0x148)](_0x14d230(0x97))[_0x14d230(0xc3)](_0x14d230(0x120))[_0x14d230(0xea)]({'status':_0x14d230(0xd4)})[_0x14d230(0x8c)]()||[];}function getSettings(){const _0x582a92=_0x8a9a49;return dbSettings[_0x582a92(0x148)](_0x582a92(0x13b))[_0x582a92(0x8c)]()||{'timeshift':0x0};}function getSecure(){const _0x3beff4=_0x8a9a49;return dbSecure['get'](_0x3beff4(0x90))[_0x3beff4(0x8c)]()||{};}function getBlacklist(){const _0x354b6f=_0x8a9a49;return dbSecure[_0x354b6f(0x148)]('blacklist')[_0x354b6f(0x8c)]()||[];}function broadcastToBots(_0x57e8f4,_0x102990){config['forEach'](_0x538259=>{const _0x5e03fc=_0x21a4;if(_0x538259[_0x5e03fc(0x8e)]==_0x5e03fc(0x117)&&_0x538259[_0x5e03fc(0x82)]==_0x5e03fc(0x96)){if(pid[_0x538259[_0x5e03fc(0x120)]])pid[_0x538259[_0x5e03fc(0x120)]][_0x5e03fc(0xca)]({[_0x57e8f4]:_0x102990});}});}function storeSettings(_0xdaa748,_0x43f07c=![]){const _0x27865f=_0x8a9a49;_0xdaa748={...settings,..._0xdaa748};if(_0x43f07c&&_0xdaa748[_0x27865f(0x172)]!='************'&&_0xdaa748['bbPassword']!=''){const _0x5e792a=crypt[_0x27865f(0x9a)](secure['privateKey'],_0xdaa748[_0x27865f(0x172)])[_0x27865f(0x1cd)][_0x27865f(0x14a)]('@')[0x0],_0xe86a45=bcrypt[_0x27865f(0x1c6)](_0x5e792a,saltRounds);_0xdaa748={..._0xdaa748,'bbPassword':_0xe86a45};}if(_0x43f07c&&_0xdaa748['telegramToken']!='************'&&_0xdaa748[_0x27865f(0x104)]!=''){const _0x178a29=crypt[_0x27865f(0x9a)](secure[_0x27865f(0xd1)],_0xdaa748[_0x27865f(0x104)])[_0x27865f(0x1cd)][_0x27865f(0x14a)]('@')[0x0];_0xdaa748={..._0xdaa748,'telegramToken':_0x178a29};}const _0x1a31d2=_0xdaa748['telegramToken']!=_0x27865f(0x15e)&&_0xdaa748[_0x27865f(0x104)]!=settings[_0x27865f(0x104)]||_0xdaa748[_0x27865f(0xf0)]!=settings[_0x27865f(0xf0)],_0x47b6b2=_0xdaa748[_0x27865f(0x104)]==''||_0xdaa748[_0x27865f(0xf0)]=='';if(_0x1a31d2)_0xdaa748[_0x27865f(0x16a)]=_0x27865f(0xd2);for(const [_0x28509d,_0x46f88e]of Object[_0x27865f(0x1d0)](_0xdaa748)){if(_0x28509d==_0x27865f(0x104)&&_0x46f88e==_0x27865f(0x15e)){_0xdaa748[_0x27865f(0x104)]=settings['telegramToken'];continue;};if(_0x28509d==_0x27865f(0x172)&&_0x46f88e==_0x27865f(0x15e)){_0xdaa748[_0x27865f(0x172)]=settings['bbPassword'];continue;};dbSettings[_0x27865f(0xd6)]('settings.'+_0x28509d,_0x46f88e)['write']();}settings=_0xdaa748,io['to']('botmanager')[_0x27865f(0x1a4)](_0x27865f(0x13b),cleanSettings()),broadcastToBots('timeshift',settings[_0x27865f(0x15a)]);if(_0x1a31d2&&!_0x47b6b2)initTelegram();if(_0x1a31d2&&_0x47b6b2)disableTelegram();getAllClients()['forEach'](_0x236250=>{const _0x5d67e6=_0x27865f;getSocket(_0x236250['id'])[_0x5d67e6(0x1a4)]('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function updateSetting(_0x1a34f3,_0x255732){const _0x55ee52=_0x8a9a49;dbSettings[_0x55ee52(0xd6)]('settings.'+_0x1a34f3,_0x255732)['write'](),settings=getSettings(),io['to'](_0x55ee52(0xa8))[_0x55ee52(0x1a4)]('settings',cleanSettings());}function storeSecure(_0x2e4344){const _0x4d396d=_0x8a9a49;dbSecure['get'](_0x4d396d(0x90))[_0x4d396d(0x9b)](_0x2e4344)[_0x4d396d(0x1be)](),secure=_0x2e4344;}function addBlacklist(_0x1fdc3f){const _0x51257e=_0x8a9a49;cleanBlacklist();let _0x528cf4;devices[_0x1fdc3f][_0x51257e(0x1ca)]?_0x528cf4=Math[_0x51257e(0x17d)](devices[_0x1fdc3f][_0x51257e(0x1ca)][_0x51257e(0x13c)],loginExpiry):_0x528cf4=loginExpiry,dbSecure[_0x51257e(0x148)](_0x51257e(0x122))[_0x51257e(0x9b)]({'expiry':new Date()[_0x51257e(0x94)]()+_0x528cf4*0x3c*0x3e8,'token':devices[_0x1fdc3f][_0x51257e(0xd9)][_0x51257e(0xc0)]})[_0x51257e(0x1be)](),blacklist=dbSecure[_0x51257e(0x148)](_0x51257e(0x122))[_0x51257e(0x8c)]();}function cleanBlacklist(){const _0x5770d4=_0x8a9a49;let _0x45a9d9=dbSecure[_0x5770d4(0x148)](_0x5770d4(0x122))[_0x5770d4(0xb5)]()['value'](),_0xfa7c20=new Date()['getTime']();_0x45a9d9['forEach'](_0x47dd51=>{const _0x432475=_0x5770d4;_0x47dd51[_0x432475(0x13c)]<_0xfa7c20&&dbSecure['get'](_0x432475(0x122))['remove']({'expiry':_0x47dd51[_0x432475(0x13c)]})[_0x432475(0x1be)]();});}function initStates(){const _0x3ba49=_0x8a9a49;let _0x4f3d9c=getConfiguration();_0x4f3d9c[_0x3ba49(0xbe)](_0x1b4696=>{const _0x348f69=_0x3ba49;_0x1b4696[_0x348f69(0x82)]='stopped';}),storeConfiguration(_0x4f3d9c);}function onKeys(){const _0x49a2d5=new RSA();return new Promise(_0xf93bce=>{const _0x4bd071=_0x21a4;_0x49a2d5[_0x4bd071(0xb6)]()[_0x4bd071(0x198)](_0x39bc87=>{_0xf93bce(_0x39bc87);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x5838ff=_0x8a9a49;let _0x5ba312=getConfiguration(),_0x385bed=![];_0x5ba312['forEach'](_0x2506f4=>{const _0x250332=_0x21a4;if(_0x2506f4[_0x250332(0x8e)]==_0x250332(0x96))_0x2506f4[_0x250332(0x8e)]=_0x250332(0x117),_0x385bed=!![];else _0x2506f4[_0x250332(0x8e)]==_0x250332(0xbc)&&(_0x2506f4[_0x250332(0x8e)]=_0x250332(0xd4),_0x385bed=!![]);});if(_0x385bed)storeConfiguration(_0x5ba312);let _0x41cedb=getSecure();if(!_0x41cedb[_0x5838ff(0x124)](_0x5838ff(0x106))){let _0x48d269=await generateKeys();_0x41cedb[_0x5838ff(0xf2)]=_0x48d269[_0x5838ff(0xf2)],_0x41cedb[_0x5838ff(0xd1)]=_0x48d269[_0x5838ff(0xd1)],_0x41cedb['secret']=crypto[_0x5838ff(0xf7)](0x20)[_0x5838ff(0x100)](_0x5838ff(0x14c));;storeSecure(_0x41cedb);}let _0xbab62e=getSettings();_0x385bed=![];!_0xbab62e['hasOwnProperty'](_0x5838ff(0x123))&&(_0xbab62e[_0x5838ff(0x123)]=![],_0xbab62e['bbUsername']='',_0xbab62e[_0x5838ff(0x172)]='',_0xbab62e[_0x5838ff(0x16d)]=![],_0x385bed=!![]);!_0xbab62e['hasOwnProperty'](_0x5838ff(0x91))&&(_0xbab62e[_0x5838ff(0x91)]=![],_0xbab62e[_0x5838ff(0x119)]=[],_0xbab62e[_0x5838ff(0x17e)]=![],_0x385bed=!![]);if(!_0xbab62e['hasOwnProperty']('telegramEnabled')){if(_0xbab62e['telegramChatId'])_0xbab62e[_0x5838ff(0x199)]=!![];else _0xbab62e[_0x5838ff(0x199)]=![];_0x385bed=!![];}if(_0x385bed)storeSettings(_0xbab62e);}function storeConfiguration(_0x1fe1a0){const _0x3cba39=_0x8a9a49;dbConfig[_0x3cba39(0x148)](_0x3cba39(0x97))[_0x3cba39(0x13f)]()[_0x3cba39(0x1be)](),dbConfig['get'](_0x3cba39(0x97))[_0x3cba39(0x9b)](..._0x1fe1a0)[_0x3cba39(0x1be)](),config=_0x1fe1a0;}function resetPassword(){const _0x212319=_0x8a9a49;tgBot&&settings[_0x212319(0x1a8)]&&(tgBot['removeListener'](_0x212319(0x1a1)),tgBot[_0x212319(0x1a0)](settings[_0x212319(0x1a8)],_0x212319(0x12e),{'parse_mode':_0x212319(0xa4),'reply_markup':{'inline_keyboard':[[{'text':_0x212319(0x156),'callback_data':_0x212319(0x156)},{'text':'no','callback_data':'no'}]]}})[_0x212319(0xcb)](_0x18e521=>{telegramError(_0x18e521);}),tgBot['on'](_0x212319(0x1a1),async _0x29ea15=>{const _0x29c9b8=_0x212319,_0x269c48=_0x29ea15[_0x29c9b8(0x8a)],_0xe869cf=_0x29ea15['message'];tgBot[_0x29c9b8(0x1c8)](_0x29ea15['id'])[_0x29c9b8(0x198)](async()=>{const _0x5d5011=_0x29c9b8;if(_0x269c48!='no'){const _0x277cff=0xf,_0x116bf8='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0xda209=Array['from'](crypto[_0x5d5011(0x87)](new Uint32Array(_0x277cff)))[_0x5d5011(0x154)](_0x5411b0=>_0x116bf8[_0x5411b0%_0x116bf8[_0x5d5011(0x115)]])[_0x5d5011(0x160)](''),_0x4d9a17=bcrypt[_0x5d5011(0x1c6)](_0xda209,saltRounds);storeSettings({'bbPassword':_0x4d9a17}),await tgBot[_0x5d5011(0x1a0)](_0xe869cf[_0x5d5011(0x126)]['id'],_0x5d5011(0x13e)+_0xda209,{'parse_mode':_0x5d5011(0xa4)})[_0x5d5011(0xcb)](_0x1587d1=>{telegramError(_0x1587d1);});}else await tgBot['sendMessage'](_0xe869cf[_0x5d5011(0x126)]['id'],'Password\x20reset\x20rejected')[_0x5d5011(0xcb)](_0x11f4d6=>{telegramError(_0x11f4d6);});}),tgBot[_0x29c9b8(0x176)](_0x29c9b8(0x1a1));}));}function logging(_0x4bd080){const _0x33657d=_0x8a9a49;console[_0x33657d(0xe0)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x4bd080);if(tgBot&&settings[_0x33657d(0x1a8)]&&settings['telegramEvents']!='orders')tgBot[_0x33657d(0x1a0)](settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x4bd080)['catch'](_0x18460e=>{telegramError(_0x18460e);});}function getServerTime(){const _0x45191a=_0x8a9a49,_0x14b6e9=new Date();return _0x14b6e9[_0x45191a(0x180)]()+'/'+(_0x14b6e9['getMonth']()+0x1)[_0x45191a(0x100)]()[_0x45191a(0x15b)](0x2,'0')+'/'+_0x14b6e9[_0x45191a(0x175)]()[_0x45191a(0x100)]()[_0x45191a(0x15b)](0x2,'0')+'\x20'+_0x14b6e9[_0x45191a(0x143)]()[_0x45191a(0x100)]()['padStart'](0x2,'0')+':'+_0x14b6e9[_0x45191a(0x95)]()[_0x45191a(0x100)]()[_0x45191a(0x15b)](0x2,'0')+':'+_0x14b6e9[_0x45191a(0xb2)]()[_0x45191a(0x100)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x223106=_0x8a9a49,_0x5e4d8c=shiftedTime();return _0x5e4d8c[_0x223106(0x180)]()+'/'+(_0x5e4d8c[_0x223106(0x17f)]()+0x1)[_0x223106(0x100)]()[_0x223106(0x15b)](0x2,'0')+'/'+_0x5e4d8c[_0x223106(0x175)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x5e4d8c[_0x223106(0x143)]()[_0x223106(0x100)]()[_0x223106(0x15b)](0x2,'0')+':'+_0x5e4d8c[_0x223106(0x95)]()['toString']()[_0x223106(0x15b)](0x2,'0')+':'+_0x5e4d8c[_0x223106(0xb2)]()[_0x223106(0x100)]()['padStart'](0x2,'0');}function shiftedTime(){const _0xa89612=_0x8a9a49,_0x405806=new Date();let _0x2d6928=_0x405806;if(settings[_0xa89612(0x15a)]&&settings[_0xa89612(0x15a)]!==0x0)_0x2d6928=fns[_0xa89612(0xf8)](_0x405806,{'hours':settings[_0xa89612(0x15a)]});return _0x2d6928;}function startScheduler(){const _0x40f609=_0x8a9a49;let _0x5d211d=new Date()[_0x40f609(0xe2)]();_0x5d211d==0x1&&backupConfigFiles();_0x5d211d==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x15fd34=_0x8a9a49;fs[_0x15fd34(0xab)](configpath,{'withFileTypes':!![]})['forEach'](_0x5b9484=>{const _0x2d03d9=_0x15fd34;if(!_0x5b9484[_0x2d03d9(0x1c0)]())fs[_0x2d03d9(0x177)](configpath+_0x5b9484['name'],configbackuppath+_0x5b9484[_0x2d03d9(0xde)]);});}function triggerAnalytics(){const _0xdb7310=_0x8a9a49;analytics[_0xdb7310(0xed)]({'title':_0xdb7310(0x146),'href':_0xdb7310(0x181),'path':'/v'+serverversion});}function validateCredentials(_0x1b8345,_0x491c8f){const _0x3fa813=_0x8a9a49;if(_0x1b8345[_0x3fa813(0x149)]==settings[_0x3fa813(0x93)]&&bcrypt[_0x3fa813(0x1bf)](_0x1b8345[_0x3fa813(0x18f)],settings[_0x3fa813(0x172)])){if(settings[_0x3fa813(0x16d)])return{'allow':![],'reason':_0x3fa813(0x145),'token':null};else{const _0x2755c1=generateLoginToken(_0x491c8f);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x2755c1};}}else return{'allow':![],'reason':_0x3fa813(0xdf),'token':null};}function refreshToken(_0x89b9e0){const _0x1efabb=_0x8a9a49,_0x269f55=generateLoginToken(_0x89b9e0);return{'allow':!![],'reason':_0x1efabb(0x114),'token':_0x269f55};}function validateAccess(_0x47cdcc,_0x4387cd){const _0x28a337=_0x8a9a49;let _0x4c6693=devices[_0x4387cd]['ip'],_0x50b7b1;const _0x5f0851=_0x1e1b24=>{const _0x2bd28d=_0x21a4;if(settings[_0x2bd28d(0x123)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x4387cd)){const _0x4746b2=generateLoginToken(_0x4387cd);return{'allow':!![],'reason':_0x2bd28d(0xfb),'token':_0x4746b2};}else return{'allow':![],'reason':_0x2bd28d(0x83),'token':null};}else return _0x50b7b1=validToken(_0x1e1b24,_0x4387cd),_0x50b7b1['hasOwnProperty'](_0x2bd28d(0xbb))?{'allow':!![],'reason':_0x2bd28d(0x19f),'token':_0x1e1b24}:{'allow':![],'reason':_0x2bd28d(0x83),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x28a337(0x91)]){let _0x4691d3=[...settings[_0x28a337(0x119)],'::1',_0x28a337(0x116),_0x28a337(0x1cf)];if(_0x4691d3[_0x28a337(0xbd)](_0x4c6693))return _0x5f0851(_0x47cdcc);else{_0x50b7b1=validToken(_0x47cdcc,_0x4387cd);if(_0x50b7b1[_0x28a337(0x124)]('success'))return _0x5f0851(_0x47cdcc);else{if(telegramIpApproved(_0x4387cd)){const _0xdac244=generateToken(_0x4387cd);return _0x50b7b1=_0x5f0851(_0x47cdcc),_0x50b7b1[_0x28a337(0x1b1)]?{'allow':!![],'reason':_0x28a337(0x11d),'token':_0xdac244}:_0x50b7b1;}else return settings[_0x28a337(0x17e)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x28a337(0x170),'token':null};}}}else return _0x5f0851(_0x47cdcc);}function timelyDecrypt(_0x351914,_0x2865db=!![]){const _0x21ee71=_0x8a9a49;if(_0x351914)try{const _0x473ca9=crypt[_0x21ee71(0x9a)](secure[_0x21ee71(0xd1)],_0x351914)[_0x21ee71(0x1cd)],_0x20092a=_0x473ca9[_0x21ee71(0x14a)]('@')[0x0],_0x2e4ced=_0x473ca9['split']('@')[0x1],_0x14625c=new Date()[_0x21ee71(0x94)]();if(_0x2865db){if(_0x14625c-_0x2e4ced<maxSecretAge*0x3e8)return _0x20092a;else return![];}else return _0x20092a;}catch(_0x519af4){return![];}else return![];}const validToken=(_0x23db60,_0xe6d870)=>{const _0x1dde4f=_0x8a9a49,_0x496d59=devices[_0xe6d870]['ip'];if(!_0x23db60)return{'error':_0x1dde4f(0x1c4)};for(let _0xa50cf9 of blacklist){if(_0xa50cf9[_0x1dde4f(0xc0)]==_0x23db60)return{'error':_0x1dde4f(0xaa)};}let _0x480c62;try{_0x480c62=jwt[_0x1dde4f(0x161)](_0x23db60,secure['secret']+_0xe6d870);}catch{return{'error':_0x1dde4f(0x111)};}if(!_0x480c62[_0x1dde4f(0x124)]('clientip')&&!_0x480c62[_0x1dde4f(0x124)](_0x1dde4f(0x149))||!_0x480c62['hasOwnProperty'](_0x1dde4f(0x1bb)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x480c62[_0x1dde4f(0x124)](_0x1dde4f(0x149))&&_0x480c62[_0x1dde4f(0x124)](_0x1dde4f(0x1cc))){const {clientip:_0x2f85ba}=_0x480c62;return _0x496d59==_0x2f85ba?{'success':_0x1dde4f(0x1b3)}:{'error':_0x1dde4f(0x7f)};}else{if(_0x480c62['hasOwnProperty'](_0x1dde4f(0x149))&&_0x480c62['hasOwnProperty'](_0x1dde4f(0x1cc))){const {username:_0x55b8db,clientip:_0x10851b}=_0x480c62;return settings['bbUsername']==_0x55b8db&&_0x496d59==_0x10851b?{'success':_0x1dde4f(0x1b3)}:{'error':_0x1dde4f(0x1b0)};}}},generateLoginToken=_0x27a27a=>{const _0x5e8744=_0x8a9a49;if(_0x27a27a){const _0x39147b=devices[_0x27a27a]['ip'];return jwt[_0x5e8744(0x174)]({'username':settings[_0x5e8744(0x93)],'clientip':_0x39147b},secure[_0x5e8744(0x106)]+_0x27a27a,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x1ce9cc=>{const _0x3d8123=_0x8a9a49;if(_0x1ce9cc){const _0x508de1=devices[_0x1ce9cc]['ip'];return jwt[_0x3d8123(0x174)]({'clientip':_0x508de1},secure['secret']+_0x1ce9cc,{'expiresIn':devices[_0x1ce9cc][_0x3d8123(0x1ca)][_0x3d8123(0x13c)]*0x3c});}else return![];},telegramIpApproved=_0x42790d=>{const _0x20f7bd=_0x8a9a49;let _0x398162=![];return devices[_0x42790d]['telegramIpApproval']&&devices[_0x42790d][_0x20f7bd(0x1ca)][_0x20f7bd(0x13c)]!=_0x20f7bd(0x135)&&(_0x398162=devices[_0x42790d]['telegramIpApproval'][_0x20f7bd(0x1cc)]==devices[_0x42790d]['ip']&&new Date()[_0x20f7bd(0x94)]()-devices[_0x42790d][_0x20f7bd(0x1ca)][_0x20f7bd(0xd5)]<devices[_0x42790d][_0x20f7bd(0x1ca)]['expiry']*0x3c*0x3e8),_0x398162;},telegram2FaApproved=_0x5ebaf8=>{const _0xf61428=_0x8a9a49;let _0x410341=![];return devices[_0x5ebaf8][_0xf61428(0xb7)]&&devices[_0x5ebaf8][_0xf61428(0xb7)][_0xf61428(0x13c)]!=_0xf61428(0x135)&&(_0x410341=devices[_0x5ebaf8]['telegram2FaApproval']['clientip']==devices[_0x5ebaf8]['ip']&&new Date()[_0xf61428(0x94)]()-devices[_0x5ebaf8][_0xf61428(0xb7)][_0xf61428(0xd5)]<devices[_0x5ebaf8][_0xf61428(0xb7)][_0xf61428(0x13c)]*0x3c*0x3e8),_0x410341;},normalizeIP=_0x2ebf6c=>{const _0x16e377=_0x8a9a49;let _0x3afe85=null,_0x311f7b=null;if(ipaddr[_0x16e377(0xdd)](_0x2ebf6c)){const _0x30b2fd=ipaddr[_0x16e377(0x8d)](_0x2ebf6c);_0x30b2fd[_0x16e377(0xcd)]()===_0x16e377(0xd0)?(_0x30b2fd[_0x16e377(0x86)]()&&(_0x3afe85=_0x30b2fd[_0x16e377(0xda)]()[_0x16e377(0x100)]()),_0x311f7b=_0x30b2fd[_0x16e377(0x100)]()):(_0x3afe85=_0x30b2fd['toString'](),_0x311f7b=_0x30b2fd[_0x16e377(0x138)]()[_0x16e377(0x100)]());}return{'show':_0x3afe85?_0x3afe85:_0x311f7b,'store':_0x311f7b};};