'use strict';
const _0x4fdc0e = _0x2ca6;
(function (_0x4acd22, _0x3c5ef3) {
    const _0x2fb9d7 = _0x2ca6, _0x326680 = _0x4acd22();
    while (!![]) {
        try {
            const _0x37a1dd = parseInt(_0x2fb9d7(0x2af)) / 0x1 * (parseInt(_0x2fb9d7(0x247)) / 0x2) + parseInt(_0x2fb9d7(0x271)) / 0x3 + -parseInt(_0x2fb9d7(0x215)) / 0x4 * (-parseInt(_0x2fb9d7(0x20b)) / 0x5) + parseInt(_0x2fb9d7(0x2c3)) / 0x6 + -parseInt(_0x2fb9d7(0x24e)) / 0x7 * (-parseInt(_0x2fb9d7(0x2b8)) / 0x8) + parseInt(_0x2fb9d7(0x272)) / 0x9 * (parseInt(_0x2fb9d7(0x269)) / 0xa) + -parseInt(_0x2fb9d7(0x2c5)) / 0xb;
            if (_0x37a1dd === _0x3c5ef3)
                break;
            else
                _0x326680['push'](_0x326680['shift']());
        } catch (_0x539c1c) {
            _0x326680['push'](_0x326680['shift']());
        }
    }
}(_0x4304, 0xe6d3a));
process[_0x4fdc0e(0x1d6)][_0x4fdc0e(0x29f)] = 0x1;
const childProcess = require(_0x4fdc0e(0x27f)), FileSync = require(_0x4fdc0e(0x1e0)), fs = require('fs'), fns = require(_0x4fdc0e(0x1ed)), low = require(_0x4fdc0e(0x2d6)), path = require(_0x4fdc0e(0x24c)), crypto = require(_0x4fdc0e(0x22e)), Crypt = require(_0x4fdc0e(0x1f1))[_0x4fdc0e(0x212)], RSA = require(_0x4fdc0e(0x1f1))[_0x4fdc0e(0x209)], bcrypt = require('bcryptjs'), jwt = require(_0x4fdc0e(0x21e)), analyticsLib = require(_0x4fdc0e(0x1c0))[_0x4fdc0e(0x1f0)], googleAnalytics = require(_0x4fdc0e(0x29a))[_0x4fdc0e(0x1f0)], ipaddr = require(_0x4fdc0e(0x228));
let bbpath = _0x4fdc0e(0x1c5);
const botfile = _0x4fdc0e(0x2cc), configfile = _0x4fdc0e(0x1dc), settingsfile = 'bb-settings.json', securefile = _0x4fdc0e(0x2a6);
!fs[_0x4fdc0e(0x259)](bbpath + botfile) && (bbpath = '');
const configpath = bbpath + _0x4fdc0e(0x289);
!fs[_0x4fdc0e(0x259)](configpath) && fs[_0x4fdc0e(0x229)](configpath);
const adapter = new FileSync(configpath + configfile), dbConfig = low(adapter);
function _0x4304() {
    const _0x24c92f = [
        'removeAllListeners',
        'path',
        'Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:',
        '3571925FVxGiu',
        'login\x20not\x20required',
        'get-starting-balances',
        'idling\x20bot\x20\x20\x20|\x20Bot\x20',
        'getDate',
        '/:bot/performance',
        'reject',
        'from',
        'build',
        'getFullYear',
        'build2',
        'existsSync',
        '30\x20min',
        '/:bot/coins',
        'yes',
        'node-telegram-bot-api',
        'Unauthorized\x20attempt\x20to\x20log\x20out',
        'exit',
        'temporaryAccessAllowed',
        'All',
        'decrypt',
        'error',
        'starting',
        'privateKey',
        'telegramToken',
        'botID',
        'allow',
        '10GnMBws',
        'remoteAddress',
        'forEach',
        'https://hodlerhacks.com',
        'event',
        'set',
        'index.html',
        'handshake',
        '1262544TJmdAS',
        '2785644vOoJVp',
        '\x20|\x20',
        'sendFile',
        'push',
        'store-configuration',
        'getStartingBalances',
        'verify',
        'sortBy',
        'sendMessage',
        'send',
        'toIPv4Address',
        'express',
        'Balance\x20Bot\x20Server',
        'child_process',
        'connection',
        'Unauthorized\x20attempt\x20to\x20store\x20configuration',
        'Notifications\x20disabled',
        'Notifications\x20types:\x20',
        'onText',
        'add-bot',
        'data',
        'HTML',
        'http',
        'config/',
        'User\x20has\x20been\x20validated',
        'initclient',
        'Invalid\x20Telegram\x20token',
        'Ok,\x20will\x20send\x20alert\x20notifications\x20only',
        'username',
        'timestamp',
        'log',
        'get-portfolio',
        'logout',
        'Bot\x20Mgr\x20>\x20',
        'show',
        'polling_error',
        'connected',
        'cloneDeep',
        'placeOrder',
        'Unauthorized\x20attempt\x20logging\x20in\x20(timeout)',
        '@analytics/google-analytics',
        'length',
        'Temporary\x20access\x20rejected',
        '\x20>\x20',
        'store',
        'NTBA_FIX_319',
        'ipc',
        'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>',
        'settings.',
        'SIGINT',
        'entries',
        'logged\x20out',
        'bb-secure.json',
        'use',
        'login',
        'args',
        'Password\x20has\x20been\x20reset\x20to:\x20',
        'page',
        'find',
        'createServer',
        'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications',
        '131WKTmXf',
        'store-headless',
        'success',
        'Invalid\x20username\x20or\x20IP\x20address',
        'listen',
        'referer',
        'socket.io',
        '>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!',
        'getUTCHours',
        '8EFWbtJ',
        'isValid',
        'started',
        '<b>Telegram\x20bot\x20status:</b>\x0a',
        'telegramUsername',
        'encryptedUuid',
        'login\x20required',
        'answerCallbackQuery',
        'getPortfolio',
        'emit',
        'secure',
        '5733378ULejwO',
        'getTime',
        '19070062OsAfpM',
        'Unauthorized\x20attempt\x20to\x20add\x20bot',
        'storeHeadless',
        'generateKeyPairAsync',
        'fork',
        'Balance\x20Bot',
        'padStart',
        'bot.js',
        'bbUsername',
        '-config.json',
        'running',
        'hasOwnProperty',
        'telegramEvents',
        'timeshift',
        '/status\x20-\x20show\x20the\x20status\x20of\x20your\x20bots\x0a',
        'Allow\x20login\x20from\x20IP\x20address\x20<b>',
        'match',
        'lowdb',
        'alerts',
        'delete-bot',
        'Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable',
        'expiry',
        'Notifications\x20enabled',
        'clientip',
        'map',
        '\x20minutes',
        'version',
        '404\x20Not\x20Found',
        'Invalid\x20authentication\x20token\x20(1)',
        'function',
        'whitelistEnabled',
        'starting\x20new\x20bot\x20|\x20Bot\x20',
        'auth',
        '2FA\x20required',
        'analytics',
        'Unauthorized\x20attempt\x20to\x20update\x20settings',
        'No\x20authentication\x20token',
        'catch',
        'removeListener',
        'bb/',
        'headers',
        'enabled',
        '/:bot/history',
        'Password\x20reset\x20rejected',
        'deleted\x20Bot\x20',
        '-performance.json',
        '/:bot',
        '/:bot/support',
        '2FA\x20login\x20token\x20generated',
        'telegramEnabled',
        'Unauthorized\x20attempt\x20to\x20get\x20logs',
        'invalid\x20credentials',
        'write',
        'temporary\x20access\x20not\x20allowed',
        'telegram',
        'getHours',
        'env',
        '/enable\x20-\x20enable\x20notifications\x0a',
        'bots',
        'botmanager',
        '-----------------------------------------------------------------------------------',
        'Unauthorized\x20attempt\x20to\x20update\x20bot',
        'bb-config.json',
        'error\x20while\x20deleting\x20log\x20files:\x20',
        'loginRequired',
        'disabled\x20Bot\x20',
        'lowdb/adapters/FileSync',
        '-events.json',
        'publicKey',
        'botname',
        'assign',
        'emitHistory',
        'toIPv4MappedAddress',
        'randomBytes',
        '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',
        'enabled\x20Bot\x20',
        'Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances',
        'Unauthorized\x20attempt\x20to\x20place\x20market\x20order',
        'orders',
        'date-fns',
        'new-disabled',
        '/config\x20-\x20notification\x20types\x20to\x20receive\x0a',
        'default',
        'hybrid-crypto-js',
        'max',
        'settings',
        'value',
        'getSeconds',
        'UA-192771731-1',
        'filter',
        'reset-password',
        '5\x20min',
        'get',
        '-results.json',
        'storeConfiguration',
        'unlinkSync',
        'hashSync',
        'split',
        'telegramChatId',
        'token',
        'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',
        'disconnect',
        'Invalid\x20authentication\x20token\x20(2)',
        'place-order',
        'defaults',
        'keys',
        'getMonth',
        'RSA',
        '127.0.0.1',
        '1329195tNCihM',
        'Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a',
        '<b>Balance\x20Bot\x20status:</b>\x0a',
        'secret',
        'Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration',
        'ipv6',
        'stopPolling',
        'Crypt',
        'once',
        'Ok,\x20will\x20send\x20order\x20notifications\x20only',
        '4STjzbf',
        'getMinutes',
        'randomFillSync',
        '2FA\x20login\x20required',
        'conn',
        'join',
        'live',
        'reload',
        'inherit',
        'jsonwebtoken',
        'remove',
        'chat',
        'disabled',
        'blacklist',
        '15\x20min',
        '/:bot/configuration',
        'bbPassword',
        'reason',
        'bot-',
        'ipaddr.js',
        'mkdirSync',
        'apiKey',
        'stopped',
        'callback_query',
        'Bot\x20',
        'crypto',
        'accept',
        'static',
        'compareSync',
        'then',
        '\x20only\x0a',
        'type',
        '\x20/\x20',
        'store-settings',
        'new',
        'all',
        '************',
        'whitelist',
        'status',
        'login\x20token\x20valid',
        'toString',
        'get-logs',
        'Notifications\x20disabled\x0a',
        'sign',
        'login\x20token\x20generated',
        ':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed',
        'Unauthorized\x20attempt\x20to\x20delete\x20bot',
        'f2aRequired',
        'Login\x20accepted',
        'order',
        '3314OQpgas',
        'password',
        'message',
        'includes'
    ];
    _0x4304 = function () {
        return _0x24c92f;
    };
    return _0x4304();
}
dbConfig[_0x4fdc0e(0x206)]({ 'bots': [] })[_0x4fdc0e(0x1d2)]();
const adapter2 = new FileSync(configpath + settingsfile), dbSettings = low(adapter2);
dbSettings['defaults']({ 'settings': { 'timeshift': 0x0 } })['write']();
const adapter3 = new FileSync(configpath + securefile), dbSecure = low(adapter3);
dbSecure[_0x4fdc0e(0x206)]({
    'secure': {},
    'blacklist': []
})['write']();
let crypt = new Crypt({
    'md': 'sha256',
    'rsaStandard': 'RSA-OAEP'
});
const saltRounds = 0xa;
let config = getConfiguration(), settings = getSettings(), secure = getSecure(), blacklist = getBlacklist(), newBot = ![], pid = [], socket = [], serverStatus = [];
const serverversion = require('./' + bbpath + 'version.json')[_0x4fdc0e(0x2df)], maxSecretAge = 0xa, loginExpiry = 0x3c, tokenRefresh = 0x5;
let lastIpApproval, telegramIpApproval, telegram2FaApproval, accessControl, token, uuid, externalip, pidExpireLogin, pidRefreshToken, pidAnalytics;
oneTimeMigration(), cleanBlacklist();
const PORT = 0xbb8, express = require(_0x4fdc0e(0x27d)), app = express(), http = require(_0x4fdc0e(0x288))[_0x4fdc0e(0x2ad)](app);
function _0x2ca6(_0x494617, _0x456edd) {
    const _0x4304f2 = _0x4304();
    return _0x2ca6 = function (_0x2ca6b1, _0x1da3d8) {
        _0x2ca6b1 = _0x2ca6b1 - 0x1bb;
        let _0x43139c = _0x4304f2[_0x2ca6b1];
        return _0x43139c;
    }, _0x2ca6(_0x494617, _0x456edd);
}
app[_0x4fdc0e(0x2a7)](express['static'](path[_0x4fdc0e(0x21a)](__dirname, bbpath, _0x4fdc0e(0x258)))), app[_0x4fdc0e(0x2a7)](express[_0x4fdc0e(0x230)](path[_0x4fdc0e(0x21a)](__dirname, bbpath, _0x4fdc0e(0x256)))), app['get']('/', function (_0x1b0a42, _0x2f21ab) {
    const _0x1c2ee8 = _0x4fdc0e;
    _0x2f21ab['sendFile'](path[_0x1c2ee8(0x21a)](__dirname, bbpath, 'build2', _0x1c2ee8(0x26f)));
}), app[_0x4fdc0e(0x1fa)](_0x4fdc0e(0x1cc), function (_0x16f1bd, _0x213225) {
    const _0x29c0c6 = _0x4fdc0e;
    _0x213225[_0x29c0c6(0x274)](path[_0x29c0c6(0x21a)](__dirname, bbpath, _0x29c0c6(0x256), _0x29c0c6(0x26f)));
}), app[_0x4fdc0e(0x1fa)]('/:bot/portfolio', (_0x13e8b9, _0x2edeba) => {
    const _0x40046e = _0x4fdc0e;
    _0x2edeba[_0x40046e(0x274)](path['join'](__dirname, bbpath, 'build', _0x40046e(0x26f)));
}), app[_0x4fdc0e(0x1fa)](_0x4fdc0e(0x253), (_0x328852, _0x2c8eab) => {
    const _0x500fa1 = _0x4fdc0e;
    _0x2c8eab['sendFile'](path[_0x500fa1(0x21a)](__dirname, bbpath, 'build', _0x500fa1(0x26f)));
}), app[_0x4fdc0e(0x1fa)](_0x4fdc0e(0x25b), (_0x17f376, _0x16d12c) => {
    const _0x5284f7 = _0x4fdc0e;
    _0x16d12c[_0x5284f7(0x274)](path['join'](__dirname, bbpath, 'build', _0x5284f7(0x26f)));
}), app[_0x4fdc0e(0x1fa)](_0x4fdc0e(0x1c8), (_0x5f905b, _0x22c6be) => {
    const _0x190fea = _0x4fdc0e;
    _0x22c6be[_0x190fea(0x274)](path['join'](__dirname, bbpath, 'build', _0x190fea(0x26f)));
}), app[_0x4fdc0e(0x1fa)](_0x4fdc0e(0x224), (_0x37a33c, _0x1499bf) => {
    const _0x3552d4 = _0x4fdc0e;
    _0x1499bf[_0x3552d4(0x274)](path[_0x3552d4(0x21a)](__dirname, bbpath, _0x3552d4(0x256), _0x3552d4(0x26f)));
}), app[_0x4fdc0e(0x1fa)](_0x4fdc0e(0x1cd), (_0x4a1bea, _0x392d12) => {
    const _0x5caa42 = _0x4fdc0e;
    _0x392d12[_0x5caa42(0x274)](path['join'](__dirname, bbpath, _0x5caa42(0x256), _0x5caa42(0x26f)));
}), http[_0x4fdc0e(0x2b3)](PORT);
const analytics = analyticsLib({
        'app': _0x4fdc0e(0x2ca),
        'plugins': [googleAnalytics({ 'trackingId': _0x4fdc0e(0x1f6) })]
    }), TelegramBot = require(_0x4fdc0e(0x25d));
let tgBot;
if (settings[_0x4fdc0e(0x266)] && settings[_0x4fdc0e(0x266)] != '' && settings[_0x4fdc0e(0x2bc)] && settings[_0x4fdc0e(0x2bc)] != '')
    initTelegram();
initStates(), startServer(), startSocket(), startAnalytics();
function startServer() {
    const _0x923934 = _0x4fdc0e;
    console[_0x923934(0x290)](''), console[_0x923934(0x290)](_0x923934(0x1da)), logging(_0x923934(0x24d) + PORT), console[_0x923934(0x290)](_0x923934(0x1da));
    if (config['length'] != 0x0)
        config['forEach'](_0x1de266 => {
            const _0x1ca8c2 = _0x923934;
            if (_0x1de266['status'] == 'enabled' || _0x1de266[_0x1ca8c2(0x23b)] == _0x1ca8c2(0x237))
                logging('starting\x20bot\x20|\x20Bot\x20' + _0x1de266[_0x1ca8c2(0x267)] + _0x1ca8c2(0x273) + _0x1de266['botname']), startBot([_0x1de266['botID']], { 'cwd': bbpath }, function (_0x4e37cd) {
                    if (_0x4e37cd)
                        logging(_0x4e37cd);
                });
            else
                (_0x1de266[_0x1ca8c2(0x23b)] == 'disabled' || _0x1de266[_0x1ca8c2(0x23b)] == _0x1ca8c2(0x1ee)) && logging(_0x1ca8c2(0x251) + _0x1de266[_0x1ca8c2(0x267)] + _0x1ca8c2(0x273) + _0x1de266[_0x1ca8c2(0x1e3)]);
        });
    else
        !newBot && console[_0x923934(0x290)](_0x923934(0x2b6));
    if (newBot)
        addBot();
    console[_0x923934(0x290)](_0x923934(0x1da)), console[_0x923934(0x290)]('');
}
function startSocket() {
    const _0x189096 = _0x4fdc0e, _0x37605a = require(_0x189096(0x2b5))(http, {});
    _0x37605a['on'](_0x189096(0x280), _0x5597fe => {
        const _0x462fcd = _0x189096;
        let _0x300743, _0x211184, _0x5cee7a;
        const _0x2dcb49 = _0x5597fe[_0x462fcd(0x270)][_0x462fcd(0x1c6)][_0x462fcd(0x2b4)], _0x507b49 = _0x5597fe['handshake'][_0x462fcd(0x1be)][_0x462fcd(0x2bd)];
        if (!_0x507b49)
            _0x5597fe['emit']('status', { 'publicKey': secure[_0x462fcd(0x1e2)] });
        else {
            uuid = timelyDecrypt(_0x5597fe['handshake'][_0x462fcd(0x1be)][_0x462fcd(0x2bd)], ![]), _0x211184 = _0x2dcb49[_0x462fcd(0x2d5)](/bot[0-9]{3}/);
            if (_0x211184)
                _0x5cee7a = _0x211184[0x0][_0x462fcd(0x2d5)](/[0-9]{3}/);
            if (_0x5cee7a)
                _0x300743 = _0x5cee7a[0x0];
            else
                _0x300743 = _0x462fcd(0x1d9);
            if (socket[_0x300743])
                socket[_0x300743][_0x462fcd(0x203)](!![]);
            socket[_0x300743] = _0x5597fe, setAccess(_0x300743);
            if (accessControl[_0x462fcd(0x268)]) {
                if (_0x300743 == _0x462fcd(0x1d9))
                    initializeSocketBotManager();
                else
                    initializeSocketBot(_0x300743);
            }
            if (!serverStatus[_0x300743])
                serverStatus[_0x300743] = _0x462fcd(0x296);
            socket[_0x300743]['on'](_0x462fcd(0x2a8), _0xa67aca => {
                const _0x6e55a9 = _0x462fcd, _0x16b949 = timelyDecrypt(_0xa67aca[_0x6e55a9(0x248)]);
                if (_0x16b949) {
                    _0xa67aca = {
                        'username': _0xa67aca[_0x6e55a9(0x28e)],
                        'password': _0x16b949
                    };
                    let _0x459f0c = validateCredentials(_0xa67aca);
                    if (_0x459f0c[_0x6e55a9(0x268)] == ![] && _0x459f0c[_0x6e55a9(0x226)] == _0x6e55a9(0x218))
                        socket[_0x300743]['emit']('status', { 'access': _0x459f0c }), loginAccess2FA(externalip);
                    else {
                        if (_0x459f0c[_0x6e55a9(0x268)] == ![] && _0x459f0c[_0x6e55a9(0x226)] == _0x6e55a9(0x1d1))
                            socket[_0x300743][_0x6e55a9(0x2c1)](_0x6e55a9(0x23b), { 'access': _0x459f0c });
                        else {
                            if (_0x459f0c[_0x6e55a9(0x268)] && _0x459f0c['reason'] == _0x6e55a9(0x241)) {
                                token = _0x459f0c[_0x6e55a9(0x201)];
                                for (let _0x23158e in socket) {
                                    if (_0x23158e == _0x6e55a9(0x1d9))
                                        initializeSocketBotManager();
                                    else
                                        initializeSocketBot(_0x23158e);
                                    socket[_0x23158e][_0x6e55a9(0x2c1)](_0x6e55a9(0x23b), {
                                        'status': serverStatus[_0x23158e] || 'starting',
                                        'serverversion': serverversion,
                                        'servertime': getServerTime(),
                                        'access': _0x459f0c,
                                        'externalip': externalip,
                                        'publicKey': secure[_0x6e55a9(0x1e2)],
                                        'loginNow': ![]
                                    });
                                }
                                setTokenRefresh(), setSessionTimeout('login');
                            }
                        }
                    }
                } else
                    logging(_0x6e55a9(0x299));
            }), socket[_0x300743]['on'](_0x462fcd(0x1f8), () => {
                resetPassword();
            }), socket[_0x300743]['on'](_0x462fcd(0x203), _0x594a43 => {
                let _0x539e63 = [];
                for (let _0x2cc4b3 in socket) {
                    if (_0x2cc4b3 != _0x300743)
                        _0x539e63[_0x2cc4b3] = socket[_0x2cc4b3];
                }
                socket = _0x539e63;
            });
            if (_0x300743 != _0x462fcd(0x1d9) && config[_0x462fcd(0x22a)] != '') {
                if (pid[_0x300743])
                    pid[_0x300743]['send']({
                        'function': _0x462fcd(0x28b),
                        'args': null
                    });
            }
        }
    });
}
function setAccess(_0x35932d) {
    const _0x4c57d1 = _0x4fdc0e;
    externalip = normalizeIP(socket[_0x35932d][_0x4c57d1(0x219)][_0x4c57d1(0x26a)])[_0x4c57d1(0x29e)], accessControl = validateAccess(token), accessControl[_0x4c57d1(0x201)] && accessControl['reason'] == 'temporary\x20token\x20generated' && setSessionTimeout('2FA'), accessControl[_0x4c57d1(0x201)] && accessControl[_0x4c57d1(0x226)] == _0x4c57d1(0x1ce) && setSessionTimeout(_0x4c57d1(0x2a8)), socket[_0x35932d][_0x4c57d1(0x2c1)](_0x4c57d1(0x23b), {
        'status': serverStatus[_0x35932d] || _0x4c57d1(0x264),
        'serverversion': serverversion,
        'servertime': getServerTime(),
        'access': accessControl,
        'externalip': externalip,
        'publicKey': secure[_0x4c57d1(0x1e2)],
        'loginNow': accessControl['reason'] == _0x4c57d1(0x2be) || accessControl[_0x4c57d1(0x226)] == _0x4c57d1(0x218)
    }), accessControl['allow'] == ![] && accessControl['reason'] == _0x4c57d1(0x1bf) && temporaryAccess2FA(externalip);
}
function setSessionTimeout(_0x1e7002) {
    const _0x250fe3 = _0x4fdc0e;
    let _0x333e88;
    if (_0x1e7002 == _0x250fe3(0x2a8))
        _0x333e88 = loginExpiry * 0x3c * 0x3e8;
    else
        _0x333e88 = telegramIpApproval[_0x250fe3(0x2da)] * 0x3c * 0x3e8 - (new Date()[_0x250fe3(0x2c4)]() - telegramIpApproval[_0x250fe3(0x28f)]);
    if (pidExpireLogin)
        clearTimeout(pidExpireLogin);
    pidExpireLogin = setTimeout(() => {
        const _0x3d0c2b = _0x250fe3;
        if (pidRefreshToken)
            clearTimeout(pidRefreshToken);
        addBlacklist(), telegramIpApproval = null, telegram2FaApproval = null;
        let _0x4cdd01 = validateAccess(token);
        if (!(_0x4cdd01['allow'] && _0x4cdd01[_0x3d0c2b(0x226)] == _0x3d0c2b(0x24f)))
            for (let _0x291c1b in socket) {
                socket[_0x291c1b][_0x3d0c2b(0x2c1)]('status', {
                    'access': {
                        'allow': ![],
                        'reason': 'access\x20timeout',
                        'token': null
                    }
                });
            }
        token = null;
    }, _0x333e88);
}
function setTokenRefresh() {
    if (pidRefreshToken)
        clearTimeout(pidRefreshToken);
    pidRefreshToken = setTimeout(() => {
        const _0x1f221b = _0x2ca6;
        let _0x49ced1 = refreshToken();
        for (let _0x3d05c9 in socket) {
            socket[_0x3d05c9]['emit'](_0x1f221b(0x23b), {
                'status': serverStatus[_0x3d05c9] || _0x1f221b(0x264),
                'serverversion': serverversion,
                'servertime': getServerTime(),
                'access': _0x49ced1,
                'externalip': externalip,
                'publicKey': secure[_0x1f221b(0x1e2)],
                'loginNow': ![]
            });
        }
        setTokenRefresh();
    }, (tokenRefresh - 0x1) * 0x3c * 0x3e8);
}
function initializeSocketBotManager() {
    const _0x121d3b = _0x4fdc0e;
    socket['botmanager'][_0x121d3b(0x2c1)](_0x121d3b(0x1d8), config), socket[_0x121d3b(0x1d9)][_0x121d3b(0x2c1)](_0x121d3b(0x1f3), cleanSettings()), socket[_0x121d3b(0x1d9)]['on'](_0x121d3b(0x285), _0x5e2f51 => {
        const _0x260c81 = _0x121d3b;
        if (validateAccess(_0x5e2f51)[_0x260c81(0x268)])
            addBot();
        else
            logging(_0x260c81(0x2c6));
    }), socket['botmanager']['on']('update-bot', (_0x42360a, _0x2b0675) => {
        const _0x59bb7e = _0x121d3b;
        if (validateAccess(_0x2b0675)[_0x59bb7e(0x268)])
            toggleBot(_0x42360a[_0x59bb7e(0x267)], _0x42360a[_0x59bb7e(0x23b)], _0x42360a[_0x59bb7e(0x21b)]);
        else
            logging(_0x59bb7e(0x1db));
    }), socket[_0x121d3b(0x1d9)]['on'](_0x121d3b(0x2d8), (_0x59e09, _0x2e098a) => {
        const _0x58d08a = _0x121d3b;
        if (validateAccess(_0x2e098a)[_0x58d08a(0x268)])
            deleteBot(_0x59e09);
        else
            logging(_0x58d08a(0x243));
    }), socket['botmanager']['on'](_0x121d3b(0x236), (_0xc5e66c, _0x57d92b) => {
        const _0xb1fe25 = _0x121d3b;
        if (validateAccess(_0x57d92b)[_0xb1fe25(0x268)])
            storeSettings(_0xc5e66c, !![]);
        else
            logging(_0xb1fe25(0x1c1));
    }), socket['botmanager']['on'](_0x121d3b(0x292), _0x154a70 => {
        const _0x262885 = _0x121d3b;
        if (validateAccess(_0x154a70)[_0x262885(0x268)]) {
            if (pidRefreshToken)
                clearTimeout(pidRefreshToken);
            if (pidExpireLogin)
                clearTimeout(pidExpireLogin);
            removeSocketListeners(), addBlacklist(), telegramIpApproval = null, telegram2FaApproval = null, token = null;
            for (let _0x768149 in socket) {
                socket[_0x768149][_0x262885(0x2c1)](_0x262885(0x23b), {
                    'access': {
                        'allow': ![],
                        'reason': _0x262885(0x2a5),
                        'token': null
                    }
                });
            }
        } else
            logging('Unauthorized\x20attempt\x20to\x20log\x20out');
    });
}
function initializeSocketBot(_0x30291f) {
    const _0x10dc2a = _0x4fdc0e;
    socket[_0x30291f]['on'](_0x10dc2a(0x23e), (_0x30ea04, _0x175bef) => {
        const _0x2b5f08 = _0x10dc2a;
        if (validateAccess(_0x175bef)['allow']) {
            if (pid[_0x30291f])
                pid[_0x30291f][_0x2b5f08(0x27b)]({
                    'function': _0x2b5f08(0x1e5),
                    'args': _0x30ea04
                });
        } else
            logging(_0x2b5f08(0x1d0));
    }), socket[_0x30291f]['on'](_0x10dc2a(0x291), (_0x2cc142, _0x579539) => {
        const _0x15e9c4 = _0x10dc2a;
        if (validateAccess(_0x579539)[_0x15e9c4(0x268)]) {
            if (pid[_0x30291f])
                pid[_0x30291f][_0x15e9c4(0x27b)]({
                    'function': _0x15e9c4(0x2c0),
                    'args': _0x2cc142
                });
        } else
            logging('Unauthorized\x20attempt\x20to\x20get\x20portfolio');
    }), socket[_0x30291f]['on'](_0x10dc2a(0x276), (_0x1df10d, _0x3e4d25) => {
        const _0x1a18e8 = _0x10dc2a;
        if (validateAccess(_0x3e4d25)[_0x1a18e8(0x268)]) {
            if (pid[_0x30291f])
                pid[_0x30291f]['send']({
                    'function': _0x1a18e8(0x1fc),
                    'args': _0x1df10d
                });
        } else
            logging(_0x1a18e8(0x281));
    }), socket[_0x30291f]['on'](_0x10dc2a(0x2b0), (_0x20c61e, _0x15e5de) => {
        const _0xe79714 = _0x10dc2a;
        if (validateAccess(_0x15e5de)['allow']) {
            if (pid[_0x30291f])
                pid[_0x30291f][_0xe79714(0x27b)]({
                    'function': _0xe79714(0x2c7),
                    'args': _0x20c61e
                });
        } else
            logging(_0xe79714(0x20f));
    }), socket[_0x30291f]['on'](_0x10dc2a(0x250), _0x3087ff => {
        const _0x12f74d = _0x10dc2a;
        if (validateAccess(_0x3087ff)[_0x12f74d(0x268)]) {
            if (pid[_0x30291f])
                pid[_0x30291f]['send']({
                    'function': _0x12f74d(0x277),
                    'args': null
                });
        } else
            logging(_0x12f74d(0x1ea));
    }), socket[_0x30291f]['on'](_0x10dc2a(0x205), (_0x57072c, _0x591ed6) => {
        const _0x55abb4 = _0x10dc2a;
        if (validateAccess(_0x591ed6)[_0x55abb4(0x268)]) {
            if (pid[_0x30291f])
                pid[_0x30291f]['send']({
                    'function': _0x55abb4(0x298),
                    'args': _0x57072c
                });
        } else
            logging(_0x55abb4(0x1eb));
    }), socket[_0x30291f]['on'](_0x10dc2a(0x292), _0x1abb48 => {
        const _0x3568a4 = _0x10dc2a;
        if (validateAccess(_0x1abb48)[_0x3568a4(0x268)]) {
            if (pidRefreshToken)
                clearTimeout(pidRefreshToken);
            if (pidExpireLogin)
                clearTimeout(pidExpireLogin);
            removeSocketListeners(), addBlacklist(), telegramIpApproval = null, telegram2FaApproval = null, token = null;
            for (let _0x3d538a in socket) {
                socket[_0x3d538a]['emit'](_0x3568a4(0x23b), {
                    'access': {
                        'allow': ![],
                        'reason': 'logged\x20out',
                        'token': null
                    }
                });
            }
        } else
            logging(_0x3568a4(0x25e));
    });
}
function removeSocketListeners() {
    const _0x5e7e3d = _0x4fdc0e;
    for (let _0x56e846 in socket) {
        socket[_0x56e846][_0x5e7e3d(0x24b)]();
    }
}
function cleanSettings() {
    const _0x19a8dd = _0x4fdc0e;
    let _0x54a2e9 = settings;
    return settings[_0x19a8dd(0x266)] && settings[_0x19a8dd(0x266)] != '' && (_0x54a2e9 = {
        ..._0x54a2e9,
        'telegramToken': _0x19a8dd(0x239)
    }), settings[_0x19a8dd(0x225)] && settings[_0x19a8dd(0x225)] != '' && (_0x54a2e9 = {
        ..._0x54a2e9,
        'bbPassword': '************'
    }), _0x54a2e9;
}
function startBot(_0x322bdb, _0x2cec30, _0x5c5b23) {
    const _0x41abb0 = _0x4fdc0e;
    let _0x4e26db = ![];
    const _0x33e4f8 = _0x322bdb[0x0];
    _0x2cec30 = {
        ..._0x2cec30,
        'stdio': [
            'inherit',
            _0x41abb0(0x21d),
            'inherit',
            _0x41abb0(0x2a0)
        ]
    }, pid[_0x33e4f8] = childProcess[_0x41abb0(0x2c9)](botfile, _0x322bdb, _0x2cec30), pid[_0x33e4f8]['on']('message', _0x3f320d => {
        const _0x3906e8 = _0x41abb0;
        switch (Object[_0x3906e8(0x207)](_0x3f320d)[0x0]) {
        case _0x3906e8(0x1e3):
            updateBotName(_0x33e4f8, _0x3f320d['botname']);
            break;
        case _0x3906e8(0x23b):
            updateStatus(_0x33e4f8, _0x3f320d[_0x3906e8(0x23b)]);
            break;
        case _0x3906e8(0x21b):
            updateLive(_0x33e4f8, _0x3f320d[_0x3906e8(0x21b)]);
            break;
        case _0x3906e8(0x2ba):
            updateLive(_0x33e4f8, _0x3f320d['started']);
            if (socket[_0x33e4f8])
                socket[_0x33e4f8][_0x3906e8(0x2c1)](_0x3906e8(0x23b), {
                    'access': {
                        'allow': ![],
                        'reason': _0x3906e8(0x21c),
                        'token': null
                    }
                });
            break;
        case _0x3906e8(0x1d4):
            sendTelegram(_0x33e4f8, _0x3f320d['telegram']);
            break;
        case _0x3906e8(0x1bb):
            if (socket[_0x33e4f8])
                socket[_0x33e4f8]['emit'](_0x3f320d['function'], _0x3f320d[_0x3906e8(0x2a9)]);
            break;
        }
    }), pid[_0x33e4f8]['on']('error', function (_0x29a41c) {
        if (_0x4e26db)
            return;
        _0x4e26db = !![], _0x5c5b23(_0x29a41c);
    }), pid[_0x33e4f8]['on'](_0x41abb0(0x25f), function (_0x11be4e) {
        const _0x27ab6f = _0x41abb0;
        if (_0x4e26db)
            return;
        _0x4e26db = !![], _0x5c5b23(null);
        const _0x16ba47 = dbConfig[_0x27ab6f(0x1fa)](_0x27ab6f(0x1d8))['find']({ 'botID': _0x33e4f8 })[_0x27ab6f(0x1f4)]();
        _0x16ba47 && (_0x16ba47[_0x27ab6f(0x23b)] == 'enabled' || _0x16ba47[_0x27ab6f(0x23b)] == _0x27ab6f(0x237)) && (updateLive(_0x33e4f8, _0x27ab6f(0x22b)), _0x11be4e != 0x4d && (logging('restarting\x20Bot\x20' + _0x33e4f8), startBot([_0x33e4f8], { 'cwd': bbpath }, function (_0x22b2a4) {
            if (_0x22b2a4)
                logging(_0x22b2a4);
        })));
    });
}
function stopBot(_0x5913f7) {
    const _0x308478 = _0x4fdc0e;
    if (socket[_0x5913f7])
        socket[_0x5913f7][_0x308478(0x203)](!![]);
    if (pid[_0x5913f7])
        pid[_0x5913f7]['kill']();
}
function addBot() {
    const _0x43e621 = _0x4fdc0e;
    let _0x1f89d8;
    for (let _0x49b68 = 0x1; _0x49b68 < 0x3e9; _0x49b68++) {
        _0x1f89d8 = _0x49b68[_0x43e621(0x23d)]()[_0x43e621(0x2cb)](0x3, '0');
        let _0xc83045 = config[_0x43e621(0x2ac)](_0xd54694 => _0xd54694[_0x43e621(0x267)] == _0x1f89d8);
        if (!_0xc83045)
            break;
    }
    if (_0x1f89d8 === '1000') {
        logging('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');
        return;
    }
    logging(_0x43e621(0x1bd) + _0x1f89d8), dbConfig['get'](_0x43e621(0x1d8))[_0x43e621(0x275)]({
        'botID': _0x1f89d8,
        'botname': _0x43e621(0x22d) + _0x1f89d8,
        'status': _0x43e621(0x237),
        'live': ''
    })['write'](), startBot([_0x1f89d8], { 'cwd': bbpath }, function (_0x254dde) {
        if (_0x254dde)
            logging(_0x254dde);
    }), config = getConfiguration();
    if (socket['botmanager'])
        socket[_0x43e621(0x1d9)][_0x43e621(0x2c1)](_0x43e621(0x1d8), config);
}
function deleteBot(_0x3f76a1) {
    const _0x372374 = _0x4fdc0e;
    if (socket[_0x3f76a1])
        socket[_0x3f76a1][_0x372374(0x203)](!![]);
    dbConfig['get'](_0x372374(0x1d8))[_0x372374(0x21f)]({ 'botID': _0x3f76a1 })['write'](), logging(_0x372374(0x1ca) + _0x3f76a1), stopBot(_0x3f76a1);
    try {
        fs[_0x372374(0x1fd)](path[_0x372374(0x21a)](configpath, _0x372374(0x227) + _0x3f76a1 + _0x372374(0x2ce))), fs[_0x372374(0x1fd)](path['join'](configpath, _0x372374(0x227) + _0x3f76a1 + _0x372374(0x1e1))), fs['unlinkSync'](path[_0x372374(0x21a)](configpath, _0x372374(0x227) + _0x3f76a1 + _0x372374(0x1cb))), fs[_0x372374(0x1fd)](path[_0x372374(0x21a)](configpath, _0x372374(0x227) + _0x3f76a1 + _0x372374(0x1fb)));
    } catch (_0x3e2d7d) {
        if (_0x3e2d7d)
            logging(_0x372374(0x1dd), _0x3e2d7d);
    }
    config = getConfiguration();
    if (socket['botmanager'])
        socket[_0x372374(0x1d9)][_0x372374(0x2c1)](_0x372374(0x1d8), config);
}
function toggleBot(_0x17149a, _0x3a7eed, _0x5af3cb) {
    const _0x4b5f39 = _0x4fdc0e;
    dbConfig[_0x4b5f39(0x1fa)]('bots')[_0x4b5f39(0x2ac)]({ 'botID': _0x17149a })[_0x4b5f39(0x1e4)]({ 'status': _0x3a7eed })[_0x4b5f39(0x1e4)]({ 'live': _0x5af3cb })[_0x4b5f39(0x1d2)]();
    if (_0x3a7eed == _0x4b5f39(0x1c7) || _0x3a7eed == _0x4b5f39(0x237))
        logging(_0x4b5f39(0x1e9) + _0x17149a), startBot([_0x17149a], { 'cwd': bbpath }, function (_0x2f326b) {
            if (_0x2f326b)
                logging(_0x2f326b);
        });
    else
        (_0x3a7eed == _0x4b5f39(0x221) || _0x3a7eed == _0x4b5f39(0x1ee)) && (logging(_0x4b5f39(0x1df) + _0x17149a), stopBot(_0x17149a));
    config = getConfiguration();
    if (socket['botmanager'])
        socket['botmanager']['emit']('bots', config);
}
function updateStatus(_0xf13e3, _0x5a634d) {
    const _0x1d18db = _0x4fdc0e;
    dbConfig['get'](_0x1d18db(0x1d8))['find']({ 'botID': _0xf13e3 })[_0x1d18db(0x1e4)]({ 'status': _0x5a634d })[_0x1d18db(0x1d2)](), config = getConfiguration();
    if (socket['botmanager'])
        socket[_0x1d18db(0x1d9)][_0x1d18db(0x2c1)](_0x1d18db(0x1d8), config);
}
function updateLive(_0x88ecb8, _0x4b037c) {
    const _0x294235 = _0x4fdc0e;
    dbConfig[_0x294235(0x1fa)](_0x294235(0x1d8))[_0x294235(0x2ac)]({ 'botID': _0x88ecb8 })[_0x294235(0x1e4)]({ 'live': _0x4b037c })[_0x294235(0x1d2)](), config = getConfiguration();
    if (socket[_0x294235(0x1d9)])
        socket[_0x294235(0x1d9)][_0x294235(0x2c1)](_0x294235(0x1d8), config);
}
function updateBotName(_0x3dcc01, _0x366efa) {
    const _0x33365f = _0x4fdc0e;
    dbConfig[_0x33365f(0x1fa)](_0x33365f(0x1d8))[_0x33365f(0x2ac)]({ 'botID': _0x3dcc01 })['assign']({ 'botname': _0x366efa })[_0x33365f(0x1d2)](), config = getConfiguration();
    if (socket[_0x33365f(0x1d9)])
        socket['botmanager'][_0x33365f(0x2c1)]('bots', config);
}
function telegramError(_0x3d1c2) {
    const _0x574e3b = _0x4fdc0e;
    console[_0x574e3b(0x290)](getTimeStamp() + _0x574e3b(0x242));
}
function validateTelegram(_0x540f92) {
    const _0x10c996 = _0x4fdc0e;
    if (_0x540f92[_0x10c996(0x255)][_0x10c996(0x28e)] != settings['telegramUsername'] && '@' + _0x540f92[_0x10c996(0x255)]['username'] != settings['telegramUsername'])
        return tgBot[_0x10c996(0x27a)](_0x540f92[_0x10c996(0x220)]['id'], 'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings', { 'parse_mode': _0x10c996(0x287) })['catch'](_0x309ec4 => {
            telegramError(_0x309ec4);
        }), ![];
    return !![];
}
async function initTelegram() {
    const _0x3aea26 = _0x4fdc0e;
    if (tgBot)
        tgBot[_0x3aea26(0x211)](), tgBot = null, initTelegram();
    else {
        tgBot = new TelegramBot(settings['telegramToken'], { 'polling': !![] });
        let _0x23c5ac = 'You\x20can\x20use\x20the\x20following\x20commands:\x0a';
        _0x23c5ac += '\x0a', _0x23c5ac += _0x3aea26(0x1d7), _0x23c5ac += '/disable\x20-\x20disable\x20notifications\x0a', _0x23c5ac += _0x3aea26(0x1ef), _0x23c5ac += '/restart\x20-\x20restart\x20a\x20bot\x0a', _0x23c5ac += _0x3aea26(0x2d3), _0x23c5ac += '/help\x20-\x20show\x20avaiable\x20commands\x0a';
        let _0x1a2176 = _0x3aea26(0x20c);
        _0x1a2176 += '\x0a', _0x1a2176 += _0x23c5ac, tgBot[_0x3aea26(0x284)](/\/start/, _0x3c3d62 => {
            const _0x196508 = _0x3aea26;
            if (!validateTelegram(_0x3c3d62))
                return;
            if (settings['telegramChatId'] != _0x3c3d62[_0x196508(0x220)]['id'])
                updateSetting('telegramChatId', _0x3c3d62[_0x196508(0x220)]['id']);
            updateSetting(_0x196508(0x1cf), !![]), tgBot[_0x196508(0x27a)](_0x3c3d62['chat']['id'], _0x1a2176)[_0x196508(0x1c3)](_0x6bd99b => {
                telegramError(_0x6bd99b);
            });
        }), tgBot[_0x3aea26(0x284)](/\/enable/, _0x498778 => {
            const _0x1c20c8 = _0x3aea26;
            if (!validateTelegram(_0x498778))
                return;
            if (settings[_0x1c20c8(0x200)] != _0x498778[_0x1c20c8(0x220)]['id'])
                updateSetting(_0x1c20c8(0x200), _0x498778['chat']['id']);
            updateSetting(_0x1c20c8(0x1cf), !![]), tgBot['sendMessage'](_0x498778[_0x1c20c8(0x220)]['id'], _0x1c20c8(0x2db))['catch'](_0x43c4a7 => {
                telegramError(_0x43c4a7);
            });
        }), tgBot[_0x3aea26(0x284)](/\/config/, async _0x5589c4 => {
            const _0x5f51c3 = _0x3aea26;
            if (!validateTelegram(_0x5589c4))
                return;
            tgBot[_0x5f51c3(0x1c4)](_0x5f51c3(0x22c)), tgBot[_0x5f51c3(0x27a)](_0x5589c4['chat']['id'], 'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?', {
                'reply_markup': {
                    'inline_keyboard': [[
                            {
                                'text': 'Orders',
                                'callback_data': _0x5f51c3(0x1ec)
                            },
                            {
                                'text': 'Alerts',
                                'callback_data': 'alerts'
                            },
                            {
                                'text': _0x5f51c3(0x261),
                                'callback_data': _0x5f51c3(0x238)
                            }
                        ]]
                }
            })['catch'](_0x73f9ce => {
                telegramError(_0x73f9ce);
            }), tgBot['on'](_0x5f51c3(0x22c), async _0x1b2c82 => {
                const _0x7b6b12 = _0x5f51c3, _0x4e9905 = _0x1b2c82[_0x7b6b12(0x286)], _0xd219f7 = _0x1b2c82['message'];
                tgBot[_0x7b6b12(0x2bf)](_0x1b2c82['id'])[_0x7b6b12(0x232)](async () => {
                    const _0x2923c6 = _0x7b6b12;
                    _0x4e9905 == 'orders' && (updateSetting(_0x2923c6(0x2d1), _0x2923c6(0x1ec)), updateSetting(_0x2923c6(0x1cf), !![]), await tgBot[_0x2923c6(0x27a)](_0xd219f7[_0x2923c6(0x220)]['id'], _0x2923c6(0x214))['catch'](_0x29b550 => {
                        telegramError(_0x29b550);
                    }));
                    _0x4e9905 == _0x2923c6(0x2d7) && (updateSetting(_0x2923c6(0x2d1), _0x2923c6(0x2d7)), updateSetting('telegramEnabled', !![]), await tgBot[_0x2923c6(0x27a)](_0xd219f7[_0x2923c6(0x220)]['id'], _0x2923c6(0x28d))['catch'](_0x44bbcb => {
                        telegramError(_0x44bbcb);
                    }));
                    _0x4e9905 == _0x2923c6(0x238) && (updateSetting('telegramEvents', 'all'), updateSetting(_0x2923c6(0x1cf), !![]), await tgBot[_0x2923c6(0x27a)](_0xd219f7[_0x2923c6(0x220)]['id'], _0x2923c6(0x2ae))[_0x2923c6(0x1c3)](_0x1b7904 => {
                        telegramError(_0x1b7904);
                    }));
                    if (!settings[_0x2923c6(0x200)])
                        tgBot['sendMessage'](_0xd219f7[_0x2923c6(0x220)]['id'], _0x2923c6(0x2d9))['catch'](_0x40c940 => {
                            telegramError(_0x40c940);
                        });
                }), tgBot[_0x7b6b12(0x1c4)](_0x7b6b12(0x22c));
            });
        }), tgBot[_0x3aea26(0x284)](/\/status/, _0x1353dd => {
            const _0xa2b3f5 = _0x3aea26;
            if (!validateTelegram(_0x1353dd))
                return;
            let _0x44c7e5 = _0xa2b3f5(0x20d);
            config[_0xa2b3f5(0x26b)](_0xcd549f => {
                const _0xcbeb59 = _0xa2b3f5;
                _0x44c7e5 += _0xcbeb59(0x22d) + _0xcd549f[_0xcbeb59(0x267)] + '\x20|\x20' + _0xcd549f[_0xcbeb59(0x1e3)] + ':\x20' + _0xcd549f[_0xcbeb59(0x23b)] + _0xcbeb59(0x235) + _0xcd549f[_0xcbeb59(0x21b)] + '\x0a';
            }), _0x44c7e5 += '\x0a', _0x44c7e5 += _0xa2b3f5(0x2bb), _0x44c7e5 += !settings[_0xa2b3f5(0x1cf)] ? _0xa2b3f5(0x23f) : 'Notifications\x20enabled\x0a', _0x44c7e5 += settings[_0xa2b3f5(0x1cf)] ? settings[_0xa2b3f5(0x2d1)] == _0xa2b3f5(0x238) ? 'Notifications\x20types:\x20orders\x20and\x20alerts\x0a' : _0xa2b3f5(0x283) + settings[_0xa2b3f5(0x2d1)] + _0xa2b3f5(0x233) : '', tgBot[_0xa2b3f5(0x27a)](_0x1353dd[_0xa2b3f5(0x220)]['id'], _0x44c7e5, { 'parse_mode': _0xa2b3f5(0x287) })[_0xa2b3f5(0x1c3)](_0x1db646 => {
                telegramError(_0x1db646);
            });
        }), tgBot[_0x3aea26(0x284)](/\/restart/, _0x1a3966 => {
            const _0x312e4c = _0x3aea26;
            if (!validateTelegram(_0x1a3966))
                return;
            tgBot[_0x312e4c(0x1c4)](_0x312e4c(0x22c));
            const _0x4c3a8e = getEnabledBots();
            if (_0x4c3a8e[_0x312e4c(0x29b)] == 0x0)
                tgBot[_0x312e4c(0x27a)](_0x1a3966[_0x312e4c(0x220)]['id'], 'No\x20bots\x20enabled\x20right\x20now')['catch'](_0x381462 => {
                    telegramError(_0x381462);
                });
            else {
                let _0x2fecb2 = [], _0x3352a6 = [];
                const _0x26212f = _0x4c3a8e[_0x312e4c(0x29b)] % 0x4 == 0x0 || _0x4c3a8e[_0x312e4c(0x29b)] % 0x4 == 0x3 || _0x4c3a8e[_0x312e4c(0x29b)] % 0x3 == 0x1 ? 0x4 : 0x3;
                let _0xd67340 = 0x0;
                _0x4c3a8e[_0x312e4c(0x26b)]((_0x56bae1, _0x4bfa0c) => {
                    const _0x16bf4a = _0x312e4c;
                    if (_0x4bfa0c % _0x26212f == 0x0)
                        _0x3352a6 = [];
                    _0x3352a6[_0x16bf4a(0x275)]({
                        'text': _0x16bf4a(0x22d) + _0x56bae1[_0x16bf4a(0x267)],
                        'callback_data': _0x56bae1[_0x16bf4a(0x267)]
                    }), _0x4bfa0c % _0x26212f == 0x0 && (_0x2fecb2[_0xd67340] = _0x3352a6, _0xd67340++);
                }), tgBot['sendMessage'](_0x1a3966[_0x312e4c(0x220)]['id'], _0x312e4c(0x202), { 'reply_markup': { 'inline_keyboard': _0x2fecb2 } })[_0x312e4c(0x1c3)](_0x13c6db => {
                    telegramError(_0x13c6db);
                }), tgBot['on']('callback_query', async _0x3af58f => {
                    const _0x2b05ae = _0x312e4c, _0x52f063 = _0x3af58f[_0x2b05ae(0x286)], _0x39f3d8 = _0x3af58f[_0x2b05ae(0x249)];
                    tgBot['answerCallbackQuery'](_0x3af58f['id'])[_0x2b05ae(0x232)](async () => {
                        const _0x40f8ae = _0x2b05ae;
                        if (settings['telegramEvents'] == _0x40f8ae(0x1ec))
                            tgBot[_0x40f8ae(0x27a)](_0x39f3d8['chat']['id'], 'Bot\x20Mgr\x20>\x20restarting\x20Bot\x20' + _0x52f063)[_0x40f8ae(0x1c3)](_0x1f284 => {
                                telegramError(_0x1f284);
                            });
                        stopBot(_0x52f063);
                    }), tgBot[_0x2b05ae(0x1c4)](_0x2b05ae(0x22c));
                });
            }
        }), tgBot[_0x3aea26(0x284)](/\/disable/, _0x39b74c => {
            const _0x24e48d = _0x3aea26;
            if (!validateTelegram(_0x39b74c))
                return;
            tgBot[_0x24e48d(0x27a)](_0x39b74c['chat']['id'], _0x24e48d(0x282))[_0x24e48d(0x1c3)](_0x2460eb => {
                telegramError(_0x2460eb);
            }), updateSetting(_0x24e48d(0x1cf), ![]);
        }), tgBot['onText'](/\/help/, _0xb3519e => {
            const _0x34730b = _0x3aea26;
            if (!validateTelegram(_0xb3519e))
                return;
            tgBot['sendMessage'](_0xb3519e[_0x34730b(0x220)]['id'], _0x23c5ac)[_0x34730b(0x1c3)](_0x87e30b => {
                telegramError(_0x87e30b);
            });
        }), tgBot['on'](_0x3aea26(0x295), _0x49614e => {
            const _0x91ebc0 = _0x3aea26;
            if (_0x49614e['toString']()[_0x91ebc0(0x24a)](_0x91ebc0(0x2e0))) {
                logging(_0x91ebc0(0x28c)), tgBot['stopPolling'](), tgBot = null;
                if (socket[_0x91ebc0(0x1d9)])
                    socket[_0x91ebc0(0x1d9)][_0x91ebc0(0x2c1)]('notification', _0x91ebc0(0x28c));
            }
        }), process['once'](_0x3aea26(0x2a3), () => {
            const _0x1ce533 = _0x3aea26;
            if (tgBot)
                tgBot[_0x1ce533(0x211)]();
            process['exit'](0x1);
        }), process[_0x3aea26(0x213)]('SIGTERM', () => {
            const _0x36758c = _0x3aea26;
            if (tgBot)
                tgBot[_0x36758c(0x211)]();
            process[_0x36758c(0x25f)](0x1);
        });
    }
}
function disableTelegram() {
    const _0x29e822 = _0x4fdc0e;
    tgBot && (tgBot[_0x29e822(0x211)](), tgBot = null);
}
function sendTelegram(_0x460050, _0x57d675) {
    const _0x1681ac = _0x4fdc0e;
    if (settings[_0x1681ac(0x1cf)]) {
        if (settings[_0x1681ac(0x2d1)] == 'all' || (_0x57d675[_0x1681ac(0x234)] == _0x1681ac(0x263) || _0x57d675['type'] == _0x1681ac(0x2b1)) && settings['telegramEvents'] == 'alerts' || _0x57d675[_0x1681ac(0x234)] == _0x1681ac(0x246) && settings[_0x1681ac(0x2d1)] == _0x1681ac(0x1ec)) {
            if (tgBot && settings['telegramChatId'])
                tgBot[_0x1681ac(0x27a)](settings[_0x1681ac(0x200)], _0x1681ac(0x22d) + _0x460050 + _0x1681ac(0x29d) + _0x57d675[_0x1681ac(0x26d)])[_0x1681ac(0x1c3)](_0x5c220d => {
                    telegramError(_0x5c220d);
                });
        }
    }
}
function temporaryAccess2FA(_0x5983a8) {
    const _0x1f67f0 = _0x4fdc0e;
    let _0x5837a7 = new Date(), _0x123178 = ![];
    if (lastIpApproval) {
        if (_0x5837a7 - lastIpApproval < 0x1388)
            _0x123178 = !![];
    }
    lastIpApproval = new Date();
    if (_0x123178)
        return;
    tgBot && settings[_0x1f67f0(0x200)] && (tgBot[_0x1f67f0(0x1c4)](_0x1f67f0(0x22c)), tgBot[_0x1f67f0(0x27a)](settings[_0x1f67f0(0x200)], _0x1f67f0(0x2a1) + normalizeIP(_0x5983a8)[_0x1f67f0(0x294)] + '</b>\x20?', {
        'parse_mode': _0x1f67f0(0x287),
        'reply_markup': {
            'inline_keyboard': [[
                    {
                        'text': _0x1f67f0(0x1f9),
                        'callback_data': '5'
                    },
                    {
                        'text': _0x1f67f0(0x223),
                        'callback_data': '15'
                    },
                    {
                        'text': _0x1f67f0(0x25a),
                        'callback_data': '30'
                    },
                    {
                        'text': 'reject',
                        'callback_data': _0x1f67f0(0x254)
                    }
                ]]
        }
    })['catch'](_0x430371 => {
        telegramError(_0x430371);
    }), tgBot['on'](_0x1f67f0(0x22c), async _0x296f71 => {
        const _0x5c1647 = _0x1f67f0, _0x40eb8c = _0x296f71[_0x5c1647(0x286)], _0x24f42c = _0x296f71[_0x5c1647(0x249)];
        tgBot['answerCallbackQuery'](_0x296f71['id'])['then'](async () => {
            const _0x261775 = _0x5c1647;
            if (_0x40eb8c != _0x261775(0x254)) {
                telegramIpApproval = {
                    'clientip': _0x5983a8,
                    'timestamp': new Date()[_0x261775(0x2c4)](),
                    'expiry': _0x40eb8c
                }, await tgBot[_0x261775(0x27a)](_0x24f42c['chat']['id'], 'Access\x20enabled\x20for\x20' + _0x40eb8c + _0x261775(0x2de), { 'parse_mode': _0x261775(0x287) })[_0x261775(0x1c3)](_0x54805b => {
                    telegramError(_0x54805b);
                });
                for (let _0x3cdbd0 in socket) {
                    socket[_0x3cdbd0][_0x261775(0x2c1)]('status', {
                        'access': {
                            'allow': ![],
                            'reason': 'reload',
                            'token': null
                        }
                    });
                }
            } else
                await tgBot[_0x261775(0x27a)](_0x24f42c[_0x261775(0x220)]['id'], _0x261775(0x29c))[_0x261775(0x1c3)](_0x23af54 => {
                    telegramError(_0x23af54);
                });
        }), tgBot[_0x5c1647(0x1c4)]('callback_query');
    }));
}
function loginAccess2FA(_0x1abb62) {
    const _0x430794 = _0x4fdc0e;
    tgBot && settings[_0x430794(0x200)] && (tgBot[_0x430794(0x1c4)](_0x430794(0x22c)), tgBot[_0x430794(0x27a)](settings[_0x430794(0x200)], _0x430794(0x2d4) + normalizeIP(_0x1abb62)[_0x430794(0x294)] + '</b>\x20?', {
        'parse_mode': _0x430794(0x287),
        'reply_markup': {
            'inline_keyboard': [[
                    {
                        'text': _0x430794(0x22f),
                        'callback_data': loginExpiry
                    },
                    {
                        'text': _0x430794(0x254),
                        'callback_data': _0x430794(0x254)
                    }
                ]]
        }
    })['catch'](_0xbacca0 => {
        telegramError(_0xbacca0);
    }), tgBot['on'](_0x430794(0x22c), async _0x676163 => {
        const _0x19f51a = _0x430794, _0x443d23 = _0x676163[_0x19f51a(0x286)], _0x5e9e93 = _0x676163[_0x19f51a(0x249)];
        tgBot[_0x19f51a(0x2bf)](_0x676163['id'])['then'](async () => {
            const _0x4270c7 = _0x19f51a;
            if (_0x443d23 != _0x4270c7(0x254)) {
                telegram2FaApproval = {
                    'clientip': _0x1abb62,
                    'timestamp': new Date()[_0x4270c7(0x2c4)](),
                    'expiry': _0x443d23
                }, await tgBot[_0x4270c7(0x27a)](_0x5e9e93['chat']['id'], _0x4270c7(0x245), { 'parse_mode': _0x4270c7(0x287) })['catch'](_0x5dd373 => {
                    telegramError(_0x5dd373);
                });
                for (let _0x4d4341 in socket) {
                    socket[_0x4d4341]['emit']('status', {
                        'access': {
                            'allow': ![],
                            'reason': 'reload',
                            'token': null
                        }
                    });
                }
            } else
                await tgBot[_0x4270c7(0x27a)](_0x5e9e93[_0x4270c7(0x220)]['id'], 'Login\x20rejected')['catch'](_0x1116b2 => {
                    telegramError(_0x1116b2);
                });
        }), tgBot[_0x19f51a(0x1c4)](_0x19f51a(0x22c));
    }));
}
function getConfiguration() {
    const _0x140c56 = _0x4fdc0e;
    return dbConfig[_0x140c56(0x1fa)]('bots')['sortBy'](_0x140c56(0x267))[_0x140c56(0x1f4)]() || [];
}
function getEnabledBots() {
    const _0x13a8eb = _0x4fdc0e;
    return dbConfig[_0x13a8eb(0x1fa)](_0x13a8eb(0x1d8))[_0x13a8eb(0x279)]('botID')[_0x13a8eb(0x1f7)]({ 'status': _0x13a8eb(0x1c7) })['value']() || [];
}
function getSettings() {
    const _0x2bf2d8 = _0x4fdc0e;
    return dbSettings[_0x2bf2d8(0x1fa)]('settings')['value']() || { 'timeshift': 0x0 };
}
function getSecure() {
    const _0x28e45d = _0x4fdc0e;
    return dbSecure[_0x28e45d(0x1fa)](_0x28e45d(0x2c2))['value']() || {};
}
function getBlacklist() {
    const _0x477847 = _0x4fdc0e;
    return dbSecure[_0x477847(0x1fa)]('blacklist')['value']() || [];
}
function broadcastToBots(_0x2e4cbb, _0x5e69a3) {
    const _0x2cceae = _0x4fdc0e;
    config[_0x2cceae(0x26b)](_0x420bd9 => {
        const _0x55463c = _0x2cceae;
        if (_0x420bd9[_0x55463c(0x23b)] == 'enabled' && _0x420bd9[_0x55463c(0x21b)] == _0x55463c(0x2cf)) {
            if (pid[_0x420bd9[_0x55463c(0x267)]])
                pid[_0x420bd9[_0x55463c(0x267)]][_0x55463c(0x27b)]({ [_0x2e4cbb]: _0x5e69a3 });
        }
    });
}
function storeSettings(_0x5510ad, _0x5e637d = ![]) {
    const _0x549544 = _0x4fdc0e;
    _0x5510ad = {
        ...settings,
        ..._0x5510ad
    };
    if (_0x5e637d && _0x5510ad[_0x549544(0x225)] != '************' && _0x5510ad[_0x549544(0x225)] != '') {
        const _0x546e61 = crypt[_0x549544(0x262)](secure['privateKey'], _0x5510ad['bbPassword'])[_0x549544(0x249)]['split']('@')[0x0], _0xe1050 = bcrypt[_0x549544(0x1fe)](_0x546e61, saltRounds);
        _0x5510ad = {
            ..._0x5510ad,
            'bbPassword': _0xe1050
        };
    }
    if (_0x5e637d && _0x5510ad[_0x549544(0x266)] != '************' && _0x5510ad[_0x549544(0x266)] != '') {
        const _0x3fd78e = crypt[_0x549544(0x262)](secure[_0x549544(0x265)], _0x5510ad[_0x549544(0x266)])[_0x549544(0x249)][_0x549544(0x1ff)]('@')[0x0];
        _0x5510ad = {
            ..._0x5510ad,
            'telegramToken': _0x3fd78e
        };
    }
    const _0x579ba1 = _0x5510ad[_0x549544(0x266)] != _0x549544(0x239) && _0x5510ad[_0x549544(0x266)] != settings['telegramToken'] || _0x5510ad[_0x549544(0x2bc)] != settings['telegramUsername'], _0x3faa42 = _0x5510ad[_0x549544(0x266)] == '' || _0x5510ad[_0x549544(0x2bc)] == '';
    if (_0x579ba1)
        _0x5510ad[_0x549544(0x2d1)] = 'all';
    for (const [_0x2db382, _0x578125] of Object[_0x549544(0x2a4)](_0x5510ad)) {
        if (_0x2db382 == _0x549544(0x266) && _0x578125 == _0x549544(0x239)) {
            _0x5510ad['telegramToken'] = settings[_0x549544(0x266)];
            continue;
        }
        ;
        if (_0x2db382 == _0x549544(0x225) && _0x578125 == '************') {
            _0x5510ad[_0x549544(0x225)] = settings[_0x549544(0x225)];
            continue;
        }
        ;
        dbSettings[_0x549544(0x26e)]('settings.' + _0x2db382, _0x578125)[_0x549544(0x1d2)]();
    }
    settings = _0x5510ad;
    if (socket[_0x549544(0x1d9)])
        socket[_0x549544(0x1d9)][_0x549544(0x2c1)](_0x549544(0x1f3), cleanSettings());
    broadcastToBots(_0x549544(0x2d2), settings['timeshift']);
    if (_0x579ba1 && !_0x3faa42)
        initTelegram();
    if (_0x579ba1 && _0x3faa42)
        disableTelegram();
    for (let _0x2b6fab in socket) {
        setAccess(_0x2b6fab);
    }
}
function updateSetting(_0xaab743, _0x3fc0c4) {
    const _0x4b5ca1 = _0x4fdc0e;
    dbSettings[_0x4b5ca1(0x26e)](_0x4b5ca1(0x2a2) + _0xaab743, _0x3fc0c4)[_0x4b5ca1(0x1d2)](), settings = getSettings();
    if (socket[_0x4b5ca1(0x1d9)])
        socket[_0x4b5ca1(0x1d9)]['emit']('settings', cleanSettings());
}
function storeSecure(_0x308c41) {
    const _0x24f06d = _0x4fdc0e;
    dbSecure[_0x24f06d(0x1fa)]('secure')['push'](_0x308c41)[_0x24f06d(0x1d2)](), secure = _0x308c41;
}
function addBlacklist() {
    const _0x8c69fb = _0x4fdc0e;
    cleanBlacklist();
    let _0x5358ba;
    telegramIpApproval ? _0x5358ba = Math[_0x8c69fb(0x1f2)](telegramIpApproval[_0x8c69fb(0x2da)], loginExpiry) : _0x5358ba = loginExpiry, dbSecure[_0x8c69fb(0x1fa)](_0x8c69fb(0x222))[_0x8c69fb(0x275)]({
        'expiry': new Date()[_0x8c69fb(0x2c4)]() + _0x5358ba * 0x3c * 0x3e8,
        'token': token
    })[_0x8c69fb(0x1d2)](), blacklist = dbSecure['get'](_0x8c69fb(0x222))['value']();
}
function cleanBlacklist() {
    const _0x4e9921 = _0x4fdc0e;
    let _0x8c6677 = dbSecure[_0x4e9921(0x1fa)](_0x4e9921(0x222))[_0x4e9921(0x297)]()[_0x4e9921(0x1f4)](), _0x3b3270 = new Date()[_0x4e9921(0x2c4)]();
    _0x8c6677[_0x4e9921(0x26b)](_0x76eead => {
        const _0x58c19f = _0x4e9921;
        _0x76eead[_0x58c19f(0x2da)] < _0x3b3270 && dbSecure[_0x58c19f(0x1fa)](_0x58c19f(0x222))[_0x58c19f(0x21f)]({ 'expiry': _0x76eead[_0x58c19f(0x2da)] })[_0x58c19f(0x1d2)]();
    });
}
function initStates() {
    let _0x167655 = getConfiguration();
    _0x167655['forEach'](_0x34aa2b => {
        const _0x98805f = _0x2ca6;
        _0x34aa2b[_0x98805f(0x21b)] = 'stopped';
    }), storeConfiguration(_0x167655);
}
function onKeys() {
    const _0x1d0767 = new RSA();
    return new Promise(_0x3b455c => {
        const _0x15ab36 = _0x2ca6;
        _0x1d0767[_0x15ab36(0x2c8)]()[_0x15ab36(0x232)](_0x2dffa2 => {
            _0x3b455c(_0x2dffa2);
        });
    });
}
async function generateKeys() {
    return await onKeys();
}
async function oneTimeMigration() {
    const _0x5b98f6 = _0x4fdc0e;
    let _0x571183 = getConfiguration(), _0x2bb0e4 = ![];
    _0x571183[_0x5b98f6(0x26b)](_0x4b34fa => {
        const _0x489ee7 = _0x5b98f6;
        if (_0x4b34fa[_0x489ee7(0x23b)] == _0x489ee7(0x2cf))
            _0x4b34fa[_0x489ee7(0x23b)] = _0x489ee7(0x1c7), _0x2bb0e4 = !![];
        else
            _0x4b34fa[_0x489ee7(0x23b)] == _0x489ee7(0x22b) && (_0x4b34fa[_0x489ee7(0x23b)] = _0x489ee7(0x221), _0x2bb0e4 = !![]);
    });
    if (_0x2bb0e4)
        storeConfiguration(_0x571183);
    let _0x5cf4aa = getSecure();
    if (!_0x5cf4aa['hasOwnProperty']('secret')) {
        let _0x511662 = await generateKeys();
        _0x5cf4aa[_0x5b98f6(0x1e2)] = _0x511662[_0x5b98f6(0x1e2)], _0x5cf4aa[_0x5b98f6(0x265)] = _0x511662[_0x5b98f6(0x265)], _0x5cf4aa[_0x5b98f6(0x20e)] = crypto[_0x5b98f6(0x1e7)](0x20)[_0x5b98f6(0x23d)]('hex');
        ;
        storeSecure(_0x5cf4aa);
    }
    let _0x3b67ca = getSettings();
    _0x2bb0e4 = ![];
    !_0x3b67ca[_0x5b98f6(0x2d0)]('loginRequired') && (_0x3b67ca[_0x5b98f6(0x1de)] = ![], _0x3b67ca[_0x5b98f6(0x2cd)] = '', _0x3b67ca[_0x5b98f6(0x225)] = '', _0x3b67ca[_0x5b98f6(0x244)] = ![], _0x2bb0e4 = !![]);
    !_0x3b67ca[_0x5b98f6(0x2d0)](_0x5b98f6(0x1bc)) && (_0x3b67ca[_0x5b98f6(0x1bc)] = ![], _0x3b67ca[_0x5b98f6(0x23a)] = [], _0x3b67ca[_0x5b98f6(0x260)] = ![], _0x2bb0e4 = !![]);
    if (!_0x3b67ca[_0x5b98f6(0x2d0)](_0x5b98f6(0x1cf))) {
        if (_0x3b67ca[_0x5b98f6(0x200)])
            _0x3b67ca['telegramEnabled'] = !![];
        else
            _0x3b67ca[_0x5b98f6(0x1cf)] = ![];
        _0x2bb0e4 = !![];
    }
    if (_0x2bb0e4)
        storeSettings(_0x3b67ca);
}
function storeConfiguration(_0x46657a) {
    const _0x3b293e = _0x4fdc0e;
    dbConfig[_0x3b293e(0x1fa)](_0x3b293e(0x1d8))[_0x3b293e(0x21f)]()[_0x3b293e(0x1d2)](), dbConfig[_0x3b293e(0x1fa)](_0x3b293e(0x1d8))[_0x3b293e(0x275)](..._0x46657a)[_0x3b293e(0x1d2)](), config = _0x46657a;
}
function resetPassword() {
    const _0x57499e = _0x4fdc0e;
    tgBot && settings['telegramChatId'] && (tgBot[_0x57499e(0x1c4)](_0x57499e(0x22c)), tgBot[_0x57499e(0x27a)](settings[_0x57499e(0x200)], 'Do\x20you\x20want\x20to\x20reset\x20your\x20password?', {
        'parse_mode': _0x57499e(0x287),
        'reply_markup': {
            'inline_keyboard': [[
                    {
                        'text': _0x57499e(0x25c),
                        'callback_data': 'yes'
                    },
                    {
                        'text': 'no',
                        'callback_data': 'no'
                    }
                ]]
        }
    })['catch'](_0x1f1593 => {
        telegramError(_0x1f1593);
    }), tgBot['on'](_0x57499e(0x22c), async _0x3f230b => {
        const _0x21b3b9 = _0x57499e, _0x138d6a = _0x3f230b['data'], _0x2d2274 = _0x3f230b[_0x21b3b9(0x249)];
        tgBot[_0x21b3b9(0x2bf)](_0x3f230b['id'])[_0x21b3b9(0x232)](async () => {
            const _0x20bb9a = _0x21b3b9;
            if (_0x138d6a != 'no') {
                const _0x2354b2 = 0xf, _0x37344a = _0x20bb9a(0x1e8), _0x749cdb = Array[_0x20bb9a(0x255)](crypto[_0x20bb9a(0x217)](new Uint32Array(_0x2354b2)))[_0x20bb9a(0x2dd)](_0x955060 => _0x37344a[_0x955060 % _0x37344a[_0x20bb9a(0x29b)]])[_0x20bb9a(0x21a)](''), _0x29c180 = bcrypt[_0x20bb9a(0x1fe)](_0x749cdb, saltRounds);
                storeSettings({ 'bbPassword': _0x29c180 }), await tgBot[_0x20bb9a(0x27a)](_0x2d2274[_0x20bb9a(0x220)]['id'], _0x20bb9a(0x2aa) + _0x749cdb, { 'parse_mode': _0x20bb9a(0x287) })['catch'](_0x5a2edb => {
                    telegramError(_0x5a2edb);
                });
            } else
                await tgBot[_0x20bb9a(0x27a)](_0x2d2274[_0x20bb9a(0x220)]['id'], _0x20bb9a(0x1c9))[_0x20bb9a(0x1c3)](_0x4ec1e4 => {
                    telegramError(_0x4ec1e4);
                });
        }), tgBot[_0x21b3b9(0x1c4)]('callback_query');
    }));
}
function logging(_0x5e5878) {
    const _0x612bba = _0x4fdc0e;
    console[_0x612bba(0x290)](getTimeStamp() + ':\x20Bot\x20Mgr\x20>\x20' + _0x5e5878);
    if (tgBot && settings[_0x612bba(0x200)] && settings[_0x612bba(0x2d1)] != _0x612bba(0x1ec))
        tgBot[_0x612bba(0x27a)](settings[_0x612bba(0x200)], _0x612bba(0x293) + _0x5e5878)[_0x612bba(0x1c3)](_0x326ae5 => {
            telegramError(_0x326ae5);
        });
}
function getServerTime() {
    const _0x13adfe = _0x4fdc0e, _0xfd890a = new Date();
    return _0xfd890a[_0x13adfe(0x257)]() + '/' + (_0xfd890a[_0x13adfe(0x208)]() + 0x1)[_0x13adfe(0x23d)]()['padStart'](0x2, '0') + '/' + _0xfd890a['getDate']()['toString']()['padStart'](0x2, '0') + '\x20' + _0xfd890a[_0x13adfe(0x1d5)]()[_0x13adfe(0x23d)]()['padStart'](0x2, '0') + ':' + _0xfd890a[_0x13adfe(0x216)]()[_0x13adfe(0x23d)]()[_0x13adfe(0x2cb)](0x2, '0') + ':' + _0xfd890a[_0x13adfe(0x1f5)]()[_0x13adfe(0x23d)]()[_0x13adfe(0x2cb)](0x2, '0');
}
function getTimeStamp() {
    const _0x1cae07 = _0x4fdc0e, _0x5421d4 = shiftedTime();
    return _0x5421d4[_0x1cae07(0x257)]() + '/' + (_0x5421d4[_0x1cae07(0x208)]() + 0x1)[_0x1cae07(0x23d)]()['padStart'](0x2, '0') + '/' + _0x5421d4[_0x1cae07(0x252)]()[_0x1cae07(0x23d)]()[_0x1cae07(0x2cb)](0x2, '0') + '\x20' + _0x5421d4[_0x1cae07(0x1d5)]()[_0x1cae07(0x23d)]()[_0x1cae07(0x2cb)](0x2, '0') + ':' + _0x5421d4[_0x1cae07(0x216)]()[_0x1cae07(0x23d)]()[_0x1cae07(0x2cb)](0x2, '0') + ':' + _0x5421d4['getSeconds']()['toString']()['padStart'](0x2, '0');
}
function shiftedTime() {
    const _0x14cc56 = _0x4fdc0e, _0x47129e = new Date();
    let _0x460751 = _0x47129e;
    if (settings[_0x14cc56(0x2d2)] && settings[_0x14cc56(0x2d2)] !== 0x0)
        _0x460751 = fns['add'](_0x47129e, { 'hours': settings[_0x14cc56(0x2d2)] });
    return _0x460751;
}
function startAnalytics() {
    const _0x4af2fb = _0x4fdc0e;
    let _0xce0a2c = new Date()[_0x4af2fb(0x2b7)]();
    _0xce0a2c == 0x9 && triggerAnalytics();
    if (pidAnalytics)
        clearTimeout(pidAnalytics);
    pidAnalytics = setTimeout(() => {
        startAnalytics();
    }, 0x3c * 0x3c * 0x3e8);
}
function triggerAnalytics() {
    const _0x556b35 = _0x4fdc0e;
    analytics[_0x556b35(0x2ab)]({
        'title': _0x556b35(0x27e),
        'href': _0x556b35(0x26c),
        'path': '/v' + serverversion
    });
}
function validateCredentials(_0x14f452) {
    const _0x6b6c61 = _0x4fdc0e;
    if (_0x14f452[_0x6b6c61(0x28e)] == settings[_0x6b6c61(0x2cd)] && bcrypt[_0x6b6c61(0x231)](_0x14f452[_0x6b6c61(0x248)], settings[_0x6b6c61(0x225)])) {
        if (settings[_0x6b6c61(0x244)])
            return {
                'allow': ![],
                'reason': _0x6b6c61(0x218),
                'token': null
            };
        else {
            const _0x55e485 = generateLoginToken();
            return {
                'allow': !![],
                'reason': _0x6b6c61(0x241),
                'token': _0x55e485
            };
        }
    } else
        return {
            'allow': ![],
            'reason': _0x6b6c61(0x1d1),
            'token': null
        };
}
function refreshToken() {
    const _0x14abae = _0x4fdc0e, _0x49b2e5 = generateLoginToken();
    return {
        'allow': !![],
        'reason': _0x14abae(0x241),
        'token': _0x49b2e5
    };
}
function validateAccess(_0x214768) {
    const _0x218bbf = _0x4fdc0e;
    let _0x18d300;
    const _0x3d47c7 = _0x4216c0 => {
        const _0x7ece8e = _0x2ca6;
        if (settings[_0x7ece8e(0x1de)]) {
            if (settings[_0x7ece8e(0x244)]) {
                if (telegram2FaApproved()) {
                    const _0xd80fc9 = generateLoginToken();
                    return {
                        'allow': !![],
                        'reason': _0x7ece8e(0x1ce),
                        'token': _0xd80fc9
                    };
                } else
                    return {
                        'allow': ![],
                        'reason': _0x7ece8e(0x218),
                        'token': null
                    };
            } else
                return _0x18d300 = validToken(_0x4216c0), _0x18d300[_0x7ece8e(0x2d0)](_0x7ece8e(0x2b1)) ? {
                    'allow': !![],
                    'reason': _0x7ece8e(0x23c),
                    'token': _0x4216c0
                } : {
                    'allow': ![],
                    'reason': _0x7ece8e(0x2be),
                    'token': null
                };
        } else
            return {
                'allow': !![],
                'reason': _0x7ece8e(0x24f),
                'token': null
            };
    };
    if (settings[_0x218bbf(0x1bc)]) {
        let _0x663c86 = [
            ...settings[_0x218bbf(0x23a)],
            '::1',
            '::ffff:127.0.0.1',
            _0x218bbf(0x20a)
        ];
        if (_0x663c86[_0x218bbf(0x24a)](externalip))
            return _0x3d47c7(_0x214768);
        else {
            _0x18d300 = validToken(_0x214768);
            if (_0x18d300[_0x218bbf(0x2d0)]('success'))
                return _0x3d47c7(_0x214768);
            else {
                if (telegramIpApproved()) {
                    const _0x1d8559 = generateToken();
                    return _0x18d300 = _0x3d47c7(_0x214768), _0x18d300['allow'] ? {
                        'allow': !![],
                        'reason': 'temporary\x20token\x20generated',
                        'token': _0x1d8559
                    } : _0x18d300;
                } else
                    return settings[_0x218bbf(0x260)] ? {
                        'allow': ![],
                        'reason': '2FA\x20required',
                        'token': null
                    } : {
                        'allow': ![],
                        'reason': _0x218bbf(0x1d3),
                        'token': null
                    };
            }
        }
    } else
        return _0x3d47c7(_0x214768);
}
function timelyDecrypt(_0x2393eb, _0x3260f6 = !![]) {
    const _0x32c467 = _0x4fdc0e;
    if (_0x2393eb)
        try {
            const _0x4fe41e = crypt[_0x32c467(0x262)](secure['privateKey'], _0x2393eb)[_0x32c467(0x249)], _0x2f545d = _0x4fe41e['split']('@')[0x0], _0xca64e7 = _0x4fe41e[_0x32c467(0x1ff)]('@')[0x1], _0x572a62 = new Date()[_0x32c467(0x2c4)]();
            if (_0x3260f6) {
                if (_0x572a62 - _0xca64e7 < maxSecretAge * 0x3e8)
                    return _0x2f545d;
                else
                    return ![];
            } else
                return _0x2f545d;
        } catch {
            return ![];
        }
    else
        return ![];
}
const validToken = _0x50e7d1 => {
        const _0x37ee94 = _0x4fdc0e;
        if (!_0x50e7d1)
            return { 'error': _0x37ee94(0x1c2) };
        for (let _0x29eaab of blacklist) {
            if (_0x29eaab['token'] == _0x50e7d1)
                return { 'error': 'Token\x20blacklisted' };
        }
        let _0x1d40a3;
        try {
            _0x1d40a3 = jwt[_0x37ee94(0x278)](_0x50e7d1, secure[_0x37ee94(0x20e)] + uuid);
        } catch {
            return { 'error': _0x37ee94(0x2e1) };
        }
        if (!_0x1d40a3[_0x37ee94(0x2d0)](_0x37ee94(0x2dc)) && !_0x1d40a3[_0x37ee94(0x2d0)](_0x37ee94(0x28e)) || !_0x1d40a3[_0x37ee94(0x2d0)]('exp'))
            return { 'error': _0x37ee94(0x204) };
        if (!_0x1d40a3[_0x37ee94(0x2d0)](_0x37ee94(0x28e)) && _0x1d40a3[_0x37ee94(0x2d0)]('clientip')) {
            const {clientip: _0x2668f0} = _0x1d40a3;
            return externalip == _0x2668f0 ? { 'success': _0x37ee94(0x28a) } : { 'error': 'Invalid\x20IP\x20address' };
        } else {
            if (_0x1d40a3['hasOwnProperty'](_0x37ee94(0x28e)) && _0x1d40a3[_0x37ee94(0x2d0)]('clientip')) {
                const {
                    username: _0x299d0a,
                    clientip: _0xad7d17
                } = _0x1d40a3;
                return settings[_0x37ee94(0x2cd)] == _0x299d0a && externalip == _0xad7d17 ? { 'success': _0x37ee94(0x28a) } : { 'error': _0x37ee94(0x2b2) };
            }
        }
    }, generateLoginToken = () => {
        const _0x3e7c1c = _0x4fdc0e;
        if (uuid)
            return jwt[_0x3e7c1c(0x240)]({
                'username': settings[_0x3e7c1c(0x2cd)],
                'clientip': externalip
            }, secure[_0x3e7c1c(0x20e)] + uuid, { 'expiresIn': tokenRefresh * 0x3c });
        else
            return ![];
    }, generateToken = () => {
        const _0x8b04b8 = _0x4fdc0e;
        if (uuid)
            return jwt[_0x8b04b8(0x240)]({ 'clientip': externalip }, secure['secret'] + uuid, { 'expiresIn': telegramIpApproval['expiry'] * 0x3c });
        else
            return ![];
    }, telegramIpApproved = () => {
        const _0x9aa37a = _0x4fdc0e;
        let _0x1c49e9 = ![];
        return telegramIpApproval && telegramIpApproval[_0x9aa37a(0x2da)] != _0x9aa37a(0x254) && (_0x1c49e9 = telegramIpApproval[_0x9aa37a(0x2dc)] == externalip && new Date()['getTime']() - telegramIpApproval[_0x9aa37a(0x28f)] < telegramIpApproval[_0x9aa37a(0x2da)] * 0x3c * 0x3e8), _0x1c49e9;
    }, telegram2FaApproved = () => {
        const _0x1df5c9 = _0x4fdc0e;
        let _0x2d087d = ![];
        return telegram2FaApproval && telegram2FaApproval[_0x1df5c9(0x2da)] != _0x1df5c9(0x254) && (_0x2d087d = telegram2FaApproval[_0x1df5c9(0x2dc)] == externalip && new Date()['getTime']() - telegram2FaApproval[_0x1df5c9(0x28f)] < telegram2FaApproval[_0x1df5c9(0x2da)] * 0x3c * 0x3e8), _0x2d087d;
    }, normalizeIP = _0x32d30b => {
        const _0x3b2d3d = _0x4fdc0e;
        let _0x31cad6 = null, _0x24edda = null;
        if (ipaddr[_0x3b2d3d(0x2b9)](_0x32d30b)) {
            const _0x59204d = ipaddr['parse'](_0x32d30b);
            _0x59204d['kind']() === _0x3b2d3d(0x210) ? (_0x59204d['isIPv4MappedAddress']() && (_0x31cad6 = _0x59204d[_0x3b2d3d(0x27c)]()[_0x3b2d3d(0x23d)]()), _0x24edda = _0x59204d[_0x3b2d3d(0x23d)]()) : (_0x31cad6 = _0x59204d['toString'](), _0x24edda = _0x59204d[_0x3b2d3d(0x1e6)]()['toString']());
        }
        return {
            'show': _0x31cad6 ? _0x31cad6 : _0x24edda,
            'store': _0x24edda
        };
    };