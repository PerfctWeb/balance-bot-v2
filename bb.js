const _0x3a7744=_0x2b40;(function(_0x23ac75,_0x2d76a1){const _0x29445d=_0x2b40,_0x43b7e7=_0x23ac75();while(!![]){try{const _0xec433e=-parseInt(_0x29445d(0x20e))/0x1+-parseInt(_0x29445d(0x227))/0x2*(-parseInt(_0x29445d(0x1f3))/0x3)+-parseInt(_0x29445d(0x1cd))/0x4+-parseInt(_0x29445d(0x243))/0x5+parseInt(_0x29445d(0x1c8))/0x6*(-parseInt(_0x29445d(0x29c))/0x7)+parseInt(_0x29445d(0x23a))/0x8+parseInt(_0x29445d(0x1ec))/0x9;if(_0xec433e===_0x2d76a1)break;else _0x43b7e7['push'](_0x43b7e7['shift']());}catch(_0x3f37fa){_0x43b7e7['push'](_0x43b7e7['shift']());}}}(_0x217b,0x95837));const _0x29c028=function(){let _0x4515f6=!![];return function(_0x361098,_0x4e8fb8){const _0x39d05e=_0x4515f6?function(){const _0x370f5d=_0x2b40;if(_0x4e8fb8){const _0x3e732a=_0x4e8fb8[_0x370f5d(0x2a9)](_0x361098,arguments);return _0x4e8fb8=null,_0x3e732a;}}:function(){};return _0x4515f6=![],_0x39d05e;};}(),_0x409370=_0x29c028(this,function(){const _0x289355=_0x2b40;return _0x409370[_0x289355(0x263)]()['search'](_0x289355(0x269))[_0x289355(0x263)]()[_0x289355(0x2c8)](_0x409370)[_0x289355(0x1db)](_0x289355(0x269));});_0x409370();'use strict';process[_0x3a7744(0x233)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x3a7744(0x24b)),FileSync=require(_0x3a7744(0x259)),fs=require('fs'),fns=require(_0x3a7744(0x216)),low=require(_0x3a7744(0x21d)),path=require(_0x3a7744(0x2b9)),crypto=require(_0x3a7744(0x285)),Crypt=require('hybrid-crypto-js')[_0x3a7744(0x1d3)],RSA=require('hybrid-crypto-js')[_0x3a7744(0x1e9)],bcrypt=require(_0x3a7744(0x280)),jwt=require(_0x3a7744(0x25d)),analyticsLib=require(_0x3a7744(0x205))[_0x3a7744(0x1fc)],googleAnalytics=require('@analytics/google-analytics')[_0x3a7744(0x1fc)],ipaddr=require('ipaddr.js');let bbpath=_0x3a7744(0x228);const botfile='bot.js',configfile='bb-config.json',settingsfile='bb-settings.json',securefile='bb-secure.json';!fs[_0x3a7744(0x2bd)](bbpath+botfile)&&(bbpath='');const configpath=bbpath+'config/';!fs['existsSync'](configpath)&&fs[_0x3a7744(0x2af)](configpath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x3a7744(0x224)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3a7744(0x28c)]({'settings':{'timeshift':0x0}})[_0x3a7744(0x224)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x3a7744(0x28c)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x3a7744(0x235),'rsaStandard':_0x3a7744(0x28e)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[],socket=[],serverStatus=[];const serverversion=require('./'+bbpath+'version.json')[_0x3a7744(0x2ce)],maxSecretAge=0xa,loginExpiry=0x3c,tokenRefresh=0x5;let lastIpApproval,telegramIpApproval,telegram2FaApproval,accessControl,token,uuid,externalip,pidExpireLogin,pidRefreshToken,pidAnalytics;oneTimeMigration(),cleanBlacklist();function _0x2b40(_0x57ebbb,_0x864fbd){const _0x2b9fba=_0x217b();return _0x2b40=function(_0x409370,_0x29c028){_0x409370=_0x409370-0x1c1;let _0x217b4d=_0x2b9fba[_0x409370];return _0x217b4d;},_0x2b40(_0x57ebbb,_0x864fbd);}const PORT=0xbb8,express=require('express'),app=express(),http=require('http')['createServer'](app);app['use'](express[_0x3a7744(0x255)](path['join'](__dirname,bbpath,_0x3a7744(0x1e5)))),app['use'](express['static'](path[_0x3a7744(0x27e)](__dirname,bbpath,_0x3a7744(0x266)))),app['get']('/',function(_0x575c4d,_0x48e6c1){const _0x3f05dd=_0x3a7744;_0x48e6c1['sendFile'](path[_0x3f05dd(0x27e)](__dirname,bbpath,_0x3f05dd(0x1e5),'index.html'));}),app['get']('/:bot',function(_0x1fb155,_0x272fa7){const _0x1a661c=_0x3a7744;_0x272fa7[_0x1a661c(0x2cf)](path[_0x1a661c(0x27e)](__dirname,bbpath,_0x1a661c(0x266),_0x1a661c(0x22e)));}),app[_0x3a7744(0x296)](_0x3a7744(0x1f4),(_0x542d80,_0x563ea8)=>{const _0x1afa03=_0x3a7744;_0x563ea8[_0x1afa03(0x2cf)](path[_0x1afa03(0x27e)](__dirname,bbpath,_0x1afa03(0x266),_0x1afa03(0x22e)));}),app[_0x3a7744(0x296)](_0x3a7744(0x28d),(_0x186f15,_0x2ba722)=>{const _0x411c1d=_0x3a7744;_0x2ba722['sendFile'](path[_0x411c1d(0x27e)](__dirname,bbpath,'build',_0x411c1d(0x22e)));}),app['get'](_0x3a7744(0x231),(_0x22dc0b,_0x41dbf7)=>{const _0x4f503b=_0x3a7744;_0x41dbf7['sendFile'](path[_0x4f503b(0x27e)](__dirname,bbpath,_0x4f503b(0x266),_0x4f503b(0x22e)));}),app[_0x3a7744(0x296)](_0x3a7744(0x299),(_0x5541d8,_0x1e456b)=>{const _0x2dfcdc=_0x3a7744;_0x1e456b[_0x2dfcdc(0x2cf)](path[_0x2dfcdc(0x27e)](__dirname,bbpath,_0x2dfcdc(0x266),'index.html'));}),app[_0x3a7744(0x296)](_0x3a7744(0x25e),(_0x5b8cec,_0x2903fe)=>{const _0xb04f93=_0x3a7744;_0x2903fe[_0xb04f93(0x2cf)](path[_0xb04f93(0x27e)](__dirname,bbpath,_0xb04f93(0x266),_0xb04f93(0x22e)));}),app[_0x3a7744(0x296)]('/:bot/support',(_0x26c9aa,_0x33f2be)=>{const _0x352701=_0x3a7744;_0x33f2be[_0x352701(0x2cf)](path['join'](__dirname,bbpath,'build',_0x352701(0x22e)));}),http['listen'](PORT);const analytics=analyticsLib({'app':'Balance\x20Bot','plugins':[googleAnalytics({'trackingId':_0x3a7744(0x1e6)})]}),TelegramBot=require(_0x3a7744(0x279));function _0x217b(){const _0x2b577a=['2FA\x20required','index.html','exit','temporary\x20token\x20generated','/:bot/coins','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','env','handshake','sha256','Allow\x20login\x20from\x20IP\x20address\x20<b>','expiry','timestamp','No\x20bots\x20enabled\x20right\x20now','7991144BOSkBx','temporaryAccessAllowed','storeHeadless','reason','login\x20required','whitelist','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','-results.json','event','4790485aLybMf','\x20minutes','telegram','whitelistEnabled','telegramUsername','show','find','1000','child_process','getMinutes','emitHistory','value','emit','Notifications\x20disabled','max','all','sign','exp','static','getDate','function','inherit','lowdb/adapters/FileSync','************','isIPv4MappedAddress','stopped','jsonwebtoken','/:bot/configuration','Invalid\x20username\x20or\x20IP\x20address','2FA\x20login\x20token\x20generated','unlinkSync','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','toString','/restart\x20-\x20restart\x20a\x20bot\x0a','</b>\x20?','build','secret','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','(((.+)+)+)+$','::ffff:127.0.0.1','kind','settings','Bot\x20','type','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','publicKey','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','remoteAddress','enabled\x20Bot\x20','\x20/\x20','/enable\x20-\x20enable\x20notifications\x0a','keys','deleted\x20Bot\x20','reject','node-telegram-bot-api','store-settings','hasOwnProperty','Unauthorized\x20attempt\x20to\x20get\x20logs','secure','join','getSeconds','bcryptjs','add-bot','User\x20has\x20been\x20validated','connected','connection','crypto','conn','match','botID','bbUsername','push','Login\x20accepted','defaults','/:bot/performance','RSA-OAEP','store-headless',':\x20Bot\x20Mgr\x20>\x20','encryptedUuid','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','getPortfolio','https://hodlerhacks.com','clientip','get','chat','filter','/:bot/history','page','Notifications\x20enabled','21pNEbCj','answerCallbackQuery','Access\x20enabled\x20for\x20','SIGINT','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','f2aRequired','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','started','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','telegramToken','Bot\x20Mgr\x20>\x20','All','apply','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','<b>Balance\x20Bot\x20status:</b>\x0a','update-bot','\x20>\x20','Alerts','mkdirSync','storeConfiguration','botmanager','entries','\x20|\x20','access\x20timeout','stop','getMonth','token','status','path','Notifications\x20types:\x20','initclient','decrypt','existsSync','removeAllListeners','You\x20can\x20use\x20the\x20following\x20commands:\x0a','onText','headers','auth','verify','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Notifications\x20disabled\x0a','hashSync','once','constructor','success','telegramChatId','getStartingBalances','login\x20not\x20required','new-disabled','version','sendFile','reload','randomFillSync','then','accept','127.0.0.1','SIGTERM','disabled','stopPolling','forEach','message','includes','bots','bbPassword','1332174EgzhVo','removeListener',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','5\x20min','from','370212eKEofZ','socket.io','Unauthorized\x20attempt\x20to\x20log\x20out','privateKey','starting\x20new\x20bot\x20|\x20Bot\x20','store','Crypt','new','data','Token\x20blacklisted','logged\x20out','getTime','error','Login\x20rejected','search','apiKey','restart','sendMessage','get-portfolio','callback_query','remove','timeshift','No\x20authentication\x20token','restarting\x20Bot\x20','build2','UA-192771731-1','telegramEnabled','disconnect','RSA','username','getHours','17599338WvBtMK','add','Unauthorized\x20attempt\x20logging\x20in\x20(timeout)','404\x20Not\x20Found','blacklist','cloneDeep','loginRequired','34743bjvafr','/:bot/portfolio','starting','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','login','length','login\x20token\x20generated','Ok,\x20will\x20send\x20order\x20notifications\x20only','live','default','Notifications\x20enabled\x0a','telegramEvents','password','2FA','place-order','2FA\x20login\x20required','invalid\x20credentials','starting\x20bot\x20|\x20Bot\x20','analytics','Invalid\x20Telegram\x20token','alerts','Temporary\x20access\x20rejected','ipv6','log','Invalid\x20authentication\x20token\x20(1)','HTML','toIPv4MappedAddress','880013yXjPSa','split','orders','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','bot-','set','send','error\x20while\x20deleting\x20log\x20files:\x20','date-fns','allow','/help\x20-\x20show\x20avaiable\x20commands\x0a','padStart','toIPv4Address','temporary\x20access\x20not\x20allowed','15\x20min','lowdb','catch','yes','enabled','botname','-----------------------------------------------------------------------------------','::1','write','idling\x20bot\x20\x20\x20|\x20Bot\x20','logout','44JIEoFP','bb/','assign','referer','Unauthorized\x20attempt\x20to\x20store\x20configuration','Invalid\x20authentication\x20token\x20(2)'];_0x217b=function(){return _0x2b577a;};return _0x217b();}let tgBot;if(settings[_0x3a7744(0x2a6)]&&settings['telegramToken']!=''&&settings[_0x3a7744(0x247)]&&settings[_0x3a7744(0x247)]!='')initTelegram();initStates(),startServer(),startSocket(),startAnalytics();function startServer(){const _0x40ca68=_0x3a7744;console[_0x40ca68(0x20a)](''),console[_0x40ca68(0x20a)](_0x40ca68(0x222)),logging(_0x40ca68(0x262)+PORT),console[_0x40ca68(0x20a)](_0x40ca68(0x222));if(config[_0x40ca68(0x1f8)]!=0x0)config[_0x40ca68(0x1c3)](_0x8fcd9e=>{const _0x40a37e=_0x40ca68;if(_0x8fcd9e[_0x40a37e(0x2b8)]==_0x40a37e(0x220)||_0x8fcd9e['status']=='new')logging(_0x40a37e(0x204)+_0x8fcd9e[_0x40a37e(0x288)]+_0x40a37e(0x2b3)+_0x8fcd9e['botname']),startBot([_0x8fcd9e[_0x40a37e(0x288)]],{'cwd':bbpath},function(_0x1d3103){if(_0x1d3103)logging(_0x1d3103);});else(_0x8fcd9e[_0x40a37e(0x2b8)]==_0x40a37e(0x1c1)||_0x8fcd9e[_0x40a37e(0x2b8)]==_0x40a37e(0x2cd))&&logging(_0x40a37e(0x225)+_0x8fcd9e[_0x40a37e(0x288)]+_0x40a37e(0x2b3)+_0x8fcd9e[_0x40a37e(0x221)]);});else!newBot&&console[_0x40ca68(0x20a)](_0x40ca68(0x2c4));if(newBot)addBot();console[_0x40ca68(0x20a)](_0x40ca68(0x222)),console[_0x40ca68(0x20a)]('');}function startSocket(){const _0x5d7f07=_0x3a7744,_0x3486e1=require(_0x5d7f07(0x1ce))(http,{});_0x3486e1['on'](_0x5d7f07(0x284),_0x904e3c=>{const _0x5d87b2=_0x5d7f07;let _0x433706,_0x3b12e2,_0x503f8b;const _0x1fbed9=_0x904e3c[_0x5d87b2(0x234)][_0x5d87b2(0x2c1)][_0x5d87b2(0x22a)],_0x267213=_0x904e3c[_0x5d87b2(0x234)]['auth'][_0x5d87b2(0x291)];if(!_0x267213)_0x904e3c[_0x5d87b2(0x24f)](_0x5d87b2(0x2b8),{'publicKey':secure[_0x5d87b2(0x270)]});else{uuid=timelyDecrypt(_0x904e3c[_0x5d87b2(0x234)][_0x5d87b2(0x2c2)][_0x5d87b2(0x291)],![]),_0x3b12e2=_0x1fbed9[_0x5d87b2(0x287)](/bot[0-9]{3}/);if(_0x3b12e2)_0x503f8b=_0x3b12e2[0x0][_0x5d87b2(0x287)](/[0-9]{3}/);if(_0x503f8b)_0x433706=_0x503f8b[0x0];else _0x433706=_0x5d87b2(0x2b1);if(socket[_0x433706])socket[_0x433706]['disconnect'](!![]);socket[_0x433706]=_0x904e3c,setAccess(_0x433706);if(accessControl[_0x5d87b2(0x217)]){if(_0x433706==_0x5d87b2(0x2b1))initializeSocketBotManager();else initializeSocketBot(_0x433706);}if(!serverStatus[_0x433706])serverStatus[_0x433706]=_0x5d87b2(0x283);socket[_0x433706]['on'](_0x5d87b2(0x1f7),_0x13af83=>{const _0xc6e17f=_0x5d87b2,_0x5bcf9e=timelyDecrypt(_0x13af83[_0xc6e17f(0x1ff)]);if(_0x5bcf9e){_0x13af83={'username':_0x13af83[_0xc6e17f(0x1ea)],'password':_0x5bcf9e};let _0x2a249f=validateCredentials(_0x13af83);if(_0x2a249f[_0xc6e17f(0x217)]==![]&&_0x2a249f[_0xc6e17f(0x23d)]=='2FA\x20login\x20required')socket[_0x433706][_0xc6e17f(0x24f)](_0xc6e17f(0x2b8),{'access':_0x2a249f}),loginAccess2FA(externalip);else{if(_0x2a249f['allow']==![]&&_0x2a249f['reason']==_0xc6e17f(0x203))socket[_0x433706][_0xc6e17f(0x24f)]('status',{'access':_0x2a249f});else{if(_0x2a249f['allow']&&_0x2a249f['reason']=='login\x20token\x20generated'){token=_0x2a249f[_0xc6e17f(0x2b7)];for(let _0x50f9b3 in socket){if(_0x50f9b3==_0xc6e17f(0x2b1))initializeSocketBotManager();else initializeSocketBot(_0x50f9b3);socket[_0x50f9b3][_0xc6e17f(0x24f)](_0xc6e17f(0x2b8),{'status':serverStatus[_0x50f9b3]||'starting','serverversion':serverversion,'servertime':getServerTime(),'access':_0x2a249f,'externalip':externalip,'publicKey':secure[_0xc6e17f(0x270)],'loginNow':![]});}setTokenRefresh(),setSessionTimeout(_0xc6e17f(0x1f7));}}}}else logging(_0xc6e17f(0x1ee));}),socket[_0x433706]['on']('reset-password',()=>{resetPassword();}),socket[_0x433706]['on'](_0x5d87b2(0x1e8),_0x395cc7=>{let _0x16b015=[];for(let _0x3c3d7f in socket){if(_0x3c3d7f!=_0x433706)_0x16b015[_0x3c3d7f]=socket[_0x3c3d7f];}socket=_0x16b015;});if(_0x433706!=_0x5d87b2(0x2b1)&&config[_0x5d87b2(0x1dc)]!=''){if(pid[_0x433706])pid[_0x433706][_0x5d87b2(0x214)]({'function':_0x5d87b2(0x2bb),'args':null});}}});}function setAccess(_0x3b5629){const _0x4f71c5=_0x3a7744;externalip=normalizeIP(socket[_0x3b5629][_0x4f71c5(0x286)][_0x4f71c5(0x272)])[_0x4f71c5(0x1d2)],accessControl=validateAccess(token),accessControl['token']&&accessControl[_0x4f71c5(0x23d)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x4f71c5(0x200)),accessControl['token']&&accessControl['reason']==_0x4f71c5(0x260)&&setSessionTimeout('login'),socket[_0x3b5629]['emit']('status',{'status':serverStatus[_0x3b5629]||_0x4f71c5(0x1f5),'serverversion':serverversion,'servertime':getServerTime(),'access':accessControl,'externalip':externalip,'publicKey':secure[_0x4f71c5(0x270)],'loginNow':accessControl[_0x4f71c5(0x23d)]==_0x4f71c5(0x23e)||accessControl['reason']=='2FA\x20login\x20required'}),accessControl['allow']==![]&&accessControl[_0x4f71c5(0x23d)]=='2FA\x20required'&&temporaryAccess2FA(externalip);}function setSessionTimeout(_0x262991){const _0x21698c=_0x3a7744;let _0x277a77;if(_0x262991=='login')_0x277a77=loginExpiry*0x3c*0x3e8;else _0x277a77=telegramIpApproval[_0x21698c(0x237)]*0x3c*0x3e8-(new Date()[_0x21698c(0x1d8)]()-telegramIpApproval[_0x21698c(0x238)]);if(pidExpireLogin)clearTimeout(pidExpireLogin);pidExpireLogin=setTimeout(()=>{const _0xc51c8d=_0x21698c;if(pidRefreshToken)clearTimeout(pidRefreshToken);addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null;let _0x4e4c51=validateAccess(token);if(!(_0x4e4c51[_0xc51c8d(0x217)]&&_0x4e4c51[_0xc51c8d(0x23d)]==_0xc51c8d(0x2cc)))for(let _0x1920c6 in socket){socket[_0x1920c6][_0xc51c8d(0x24f)](_0xc51c8d(0x2b8),{'access':{'allow':![],'reason':_0xc51c8d(0x2b4),'token':null}});}token=null;},_0x277a77);}function setTokenRefresh(){if(pidRefreshToken)clearTimeout(pidRefreshToken);pidRefreshToken=setTimeout(()=>{const _0x564ecf=_0x2b40;let _0x259075=refreshToken();for(let _0x5a3536 in socket){socket[_0x5a3536]['emit'](_0x564ecf(0x2b8),{'status':serverStatus[_0x5a3536]||_0x564ecf(0x1f5),'serverversion':serverversion,'servertime':getServerTime(),'access':_0x259075,'externalip':externalip,'publicKey':secure[_0x564ecf(0x270)],'loginNow':![]});}setTokenRefresh();},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(){const _0x4c6f30=_0x3a7744;socket[_0x4c6f30(0x2b1)][_0x4c6f30(0x24f)](_0x4c6f30(0x1c6),config),socket[_0x4c6f30(0x2b1)][_0x4c6f30(0x24f)](_0x4c6f30(0x26c),cleanSettings()),socket['botmanager']['on'](_0x4c6f30(0x281),_0x1d9271=>{if(validateAccess(_0x1d9271)['allow'])addBot();else logging('Unauthorized\x20attempt\x20to\x20add\x20bot');}),socket[_0x4c6f30(0x2b1)]['on'](_0x4c6f30(0x2ac),(_0x419650,_0x260bb5)=>{const _0x36b598=_0x4c6f30;if(validateAccess(_0x260bb5)[_0x36b598(0x217)])toggleBot(_0x419650[_0x36b598(0x288)],_0x419650[_0x36b598(0x2b8)],_0x419650[_0x36b598(0x1fb)]);else logging('Unauthorized\x20attempt\x20to\x20update\x20bot');}),socket[_0x4c6f30(0x2b1)]['on']('delete-bot',(_0x1bd0b2,_0x492c7a)=>{const _0x4567b1=_0x4c6f30;if(validateAccess(_0x492c7a)[_0x4567b1(0x217)])deleteBot(_0x1bd0b2);else logging('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),socket[_0x4c6f30(0x2b1)]['on'](_0x4c6f30(0x27a),(_0x170f40,_0x37e48d)=>{const _0x52b492=_0x4c6f30;if(validateAccess(_0x37e48d)[_0x52b492(0x217)])storeSettings(_0x170f40,!![]);else logging('Unauthorized\x20attempt\x20to\x20update\x20settings');}),socket[_0x4c6f30(0x2b1)]['on'](_0x4c6f30(0x226),_0xf14ea0=>{const _0x2952c0=_0x4c6f30;if(validateAccess(_0xf14ea0)[_0x2952c0(0x217)]){if(pidRefreshToken)clearTimeout(pidRefreshToken);if(pidExpireLogin)clearTimeout(pidExpireLogin);removeSocketListeners(),addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null,token=null;for(let _0x2a96e5 in socket){socket[_0x2a96e5][_0x2952c0(0x24f)](_0x2952c0(0x2b8),{'access':{'allow':![],'reason':_0x2952c0(0x1d7),'token':null}});}}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x1086a5){const _0x4fdd93=_0x3a7744;socket[_0x1086a5]['on']('get-logs',(_0x436049,_0x5a17c6)=>{const _0x4076d4=_0x2b40;if(validateAccess(_0x5a17c6)[_0x4076d4(0x217)]){if(pid[_0x1086a5])pid[_0x1086a5][_0x4076d4(0x214)]({'function':_0x4076d4(0x24d),'args':_0x436049});}else logging(_0x4076d4(0x27c));}),socket[_0x1086a5]['on'](_0x4fdd93(0x1df),(_0x197da5,_0x2a8549)=>{const _0x47c2d1=_0x4fdd93;if(validateAccess(_0x2a8549)[_0x47c2d1(0x217)]){if(pid[_0x1086a5])pid[_0x1086a5][_0x47c2d1(0x214)]({'function':_0x47c2d1(0x293),'args':_0x197da5});}else logging(_0x47c2d1(0x2a2));}),socket[_0x1086a5]['on']('store-configuration',(_0x272cc0,_0x54ce50)=>{const _0x21ad1d=_0x4fdd93;if(validateAccess(_0x54ce50)[_0x21ad1d(0x217)]){if(pid[_0x1086a5])pid[_0x1086a5][_0x21ad1d(0x214)]({'function':_0x21ad1d(0x2b0),'args':_0x272cc0});}else logging(_0x21ad1d(0x22b));}),socket[_0x1086a5]['on'](_0x4fdd93(0x28f),(_0x1b4ae4,_0x41c4da)=>{const _0x4e4114=_0x4fdd93;if(validateAccess(_0x41c4da)[_0x4e4114(0x217)]){if(pid[_0x1086a5])pid[_0x1086a5][_0x4e4114(0x214)]({'function':_0x4e4114(0x23c),'args':_0x1b4ae4});}else logging(_0x4e4114(0x268));}),socket[_0x1086a5]['on']('get-starting-balances',_0x1ca141=>{const _0x2155ae=_0x4fdd93;if(validateAccess(_0x1ca141)[_0x2155ae(0x217)]){if(pid[_0x1086a5])pid[_0x1086a5]['send']({'function':_0x2155ae(0x2cb),'args':null});}else logging(_0x2155ae(0x232));}),socket[_0x1086a5]['on'](_0x4fdd93(0x201),(_0x185e9d,_0xf4c1bd)=>{const _0x53ffed=_0x4fdd93;if(validateAccess(_0xf4c1bd)['allow']){if(pid[_0x1086a5])pid[_0x1086a5][_0x53ffed(0x214)]({'function':'placeOrder','args':_0x185e9d});}else logging(_0x53ffed(0x292));}),socket[_0x1086a5]['on'](_0x4fdd93(0x226),_0x4d14bd=>{const _0xa1e05=_0x4fdd93;if(validateAccess(_0x4d14bd)['allow']){if(pidRefreshToken)clearTimeout(pidRefreshToken);if(pidExpireLogin)clearTimeout(pidExpireLogin);removeSocketListeners(),addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null,token=null;for(let _0x5cdcfc in socket){socket[_0x5cdcfc]['emit'](_0xa1e05(0x2b8),{'access':{'allow':![],'reason':_0xa1e05(0x1d7),'token':null}});}}else logging(_0xa1e05(0x1cf));});}function removeSocketListeners(){const _0x5dd4c9=_0x3a7744;for(let _0x506486 in socket){socket[_0x506486][_0x5dd4c9(0x2be)]();}}function cleanSettings(){const _0x2da2b1=_0x3a7744;let _0x5d20ee=settings;return settings[_0x2da2b1(0x2a6)]&&settings[_0x2da2b1(0x2a6)]!=''&&(_0x5d20ee={..._0x5d20ee,'telegramToken':_0x2da2b1(0x25a)}),settings['bbPassword']&&settings[_0x2da2b1(0x1c7)]!=''&&(_0x5d20ee={..._0x5d20ee,'bbPassword':_0x2da2b1(0x25a)}),_0x5d20ee;}function startBot(_0x1df37d,_0x3ce1d4,_0x2d9a53){const _0x40e081=_0x3a7744;let _0x5e799b=![];const _0x51f13e=_0x1df37d[0x0];_0x3ce1d4={..._0x3ce1d4,'stdio':['inherit',_0x40e081(0x258),_0x40e081(0x258),'ipc']},pid[_0x51f13e]=childProcess['fork'](botfile,_0x1df37d,_0x3ce1d4),pid[_0x51f13e]['on'](_0x40e081(0x1c4),_0x137bf3=>{const _0x4baa7a=_0x40e081;switch(Object[_0x4baa7a(0x276)](_0x137bf3)[0x0]){case _0x4baa7a(0x221):updateBotName(_0x51f13e,_0x137bf3[_0x4baa7a(0x221)]);break;case _0x4baa7a(0x2b8):updateStatus(_0x51f13e,_0x137bf3[_0x4baa7a(0x2b8)]);break;case _0x4baa7a(0x1fb):updateLive(_0x51f13e,_0x137bf3[_0x4baa7a(0x1fb)]);break;case _0x4baa7a(0x2a4):updateLive(_0x51f13e,_0x137bf3[_0x4baa7a(0x2a4)]);if(socket[_0x51f13e])socket[_0x51f13e][_0x4baa7a(0x24f)](_0x4baa7a(0x2b8),{'access':{'allow':![],'reason':_0x4baa7a(0x2d0),'token':null}});break;case _0x4baa7a(0x2b5):_0x137bf3['stop']==_0x4baa7a(0x1dd)&&stopBot(_0x51f13e);_0x137bf3['stop']=='kill'&&toggleBot(_0x51f13e,_0x4baa7a(0x1c1),_0x4baa7a(0x25c));break;case _0x4baa7a(0x245):sendTelegram(_0x51f13e,_0x137bf3[_0x4baa7a(0x245)]);break;case _0x4baa7a(0x257):if(socket[_0x51f13e])socket[_0x51f13e]['emit'](_0x137bf3[_0x4baa7a(0x257)],_0x137bf3['args']);break;}}),pid[_0x51f13e]['on'](_0x40e081(0x1d9),function(_0x1b80dc){if(_0x5e799b)return;_0x5e799b=!![],_0x2d9a53(_0x1b80dc);}),pid[_0x51f13e]['on'](_0x40e081(0x22f),function(_0x59affd){const _0x4a79d7=_0x40e081;if(_0x5e799b)return;_0x5e799b=!![],_0x2d9a53(null);const _0x5cffbf=dbConfig['get'](_0x4a79d7(0x1c6))['find']({'botID':_0x51f13e})['value']();_0x5cffbf&&(_0x5cffbf[_0x4a79d7(0x2b8)]==_0x4a79d7(0x220)||_0x5cffbf[_0x4a79d7(0x2b8)]==_0x4a79d7(0x1d4))&&(updateLive(_0x51f13e,'stopped'),logging(_0x4a79d7(0x1e4)+_0x51f13e),startBot([_0x51f13e],{'cwd':bbpath},function(_0x336abe){if(_0x336abe)logging(_0x336abe);}));});}function stopBot(_0x51c628){if(socket[_0x51c628])socket[_0x51c628]['disconnect'](!![]);if(pid[_0x51c628])pid[_0x51c628]['kill']();}function addBot(){const _0x2a08cf=_0x3a7744;let _0x58625b;for(let _0x1bf2f5=0x1;_0x1bf2f5<0x3e9;_0x1bf2f5++){_0x58625b=_0x1bf2f5['toString']()['padStart'](0x3,'0');let _0x52a729=config['find'](_0x684ac3=>_0x684ac3[_0x2a08cf(0x288)]==_0x58625b);if(!_0x52a729)break;}if(_0x58625b===_0x2a08cf(0x24a)){logging(_0x2a08cf(0x211));return;}logging(_0x2a08cf(0x1d1)+_0x58625b),dbConfig[_0x2a08cf(0x296)](_0x2a08cf(0x1c6))['push']({'botID':_0x58625b,'botname':_0x2a08cf(0x26d)+_0x58625b,'status':_0x2a08cf(0x1d4),'live':''})['write'](),startBot([_0x58625b],{'cwd':bbpath},function(_0x403824){if(_0x403824)logging(_0x403824);}),config=getConfiguration();if(socket[_0x2a08cf(0x2b1)])socket[_0x2a08cf(0x2b1)]['emit']('bots',config);}function deleteBot(_0x7308da){const _0x58dec3=_0x3a7744;if(socket[_0x7308da])socket[_0x7308da][_0x58dec3(0x1e8)](!![]);dbConfig[_0x58dec3(0x296)](_0x58dec3(0x1c6))[_0x58dec3(0x1e1)]({'botID':_0x7308da})[_0x58dec3(0x224)](),logging(_0x58dec3(0x277)+_0x7308da),stopBot(_0x7308da);try{fs[_0x58dec3(0x261)](path[_0x58dec3(0x27e)](configpath,_0x58dec3(0x212)+_0x7308da+'-config.json')),fs[_0x58dec3(0x261)](path['join'](configpath,_0x58dec3(0x212)+_0x7308da+'-events.json')),fs[_0x58dec3(0x261)](path[_0x58dec3(0x27e)](configpath,_0x58dec3(0x212)+_0x7308da+'-performance.json')),fs[_0x58dec3(0x261)](path[_0x58dec3(0x27e)](configpath,_0x58dec3(0x212)+_0x7308da+_0x58dec3(0x241)));}catch(_0x5b8413){if(_0x5b8413)logging(_0x58dec3(0x215),_0x5b8413);}config=getConfiguration();if(socket[_0x58dec3(0x2b1)])socket[_0x58dec3(0x2b1)][_0x58dec3(0x24f)](_0x58dec3(0x1c6),config);}function toggleBot(_0x189abd,_0x5657df,_0x55ab31){const _0x3750f5=_0x3a7744;dbConfig[_0x3750f5(0x296)](_0x3750f5(0x1c6))[_0x3750f5(0x249)]({'botID':_0x189abd})['assign']({'status':_0x5657df})[_0x3750f5(0x229)]({'live':_0x55ab31})[_0x3750f5(0x224)]();if(_0x5657df==_0x3750f5(0x220)||_0x5657df==_0x3750f5(0x1d4))logging(_0x3750f5(0x273)+_0x189abd),startBot([_0x189abd],{'cwd':bbpath},function(_0x1df81c){if(_0x1df81c)logging(_0x1df81c);});else(_0x5657df==_0x3750f5(0x1c1)||_0x5657df=='new-disabled')&&(logging('disabled\x20Bot\x20'+_0x189abd),stopBot(_0x189abd));config=getConfiguration();if(socket[_0x3750f5(0x2b1)])socket[_0x3750f5(0x2b1)][_0x3750f5(0x24f)](_0x3750f5(0x1c6),config);}function updateStatus(_0x15c143,_0x131df9){const _0x34288f=_0x3a7744;dbConfig[_0x34288f(0x296)](_0x34288f(0x1c6))[_0x34288f(0x249)]({'botID':_0x15c143})[_0x34288f(0x229)]({'status':_0x131df9})[_0x34288f(0x224)](),config=getConfiguration();if(socket[_0x34288f(0x2b1)])socket['botmanager']['emit'](_0x34288f(0x1c6),config);}function updateLive(_0x33fe1a,_0x34bb41){const _0x3a2b85=_0x3a7744;dbConfig[_0x3a2b85(0x296)]('bots')['find']({'botID':_0x33fe1a})[_0x3a2b85(0x229)]({'live':_0x34bb41})[_0x3a2b85(0x224)](),config=getConfiguration();if(socket['botmanager'])socket['botmanager']['emit'](_0x3a2b85(0x1c6),config);}function updateBotName(_0x118c45,_0x5ec0a7){const _0x3e628c=_0x3a7744;dbConfig[_0x3e628c(0x296)]('bots')[_0x3e628c(0x249)]({'botID':_0x118c45})['assign']({'botname':_0x5ec0a7})[_0x3e628c(0x224)](),config=getConfiguration();if(socket[_0x3e628c(0x2b1)])socket[_0x3e628c(0x2b1)]['emit'](_0x3e628c(0x1c6),config);}function telegramError(_0x20e910){const _0x1ed72e=_0x3a7744;console[_0x1ed72e(0x20a)](getTimeStamp()+_0x1ed72e(0x1ca));}function validateTelegram(_0x3059ce){const _0x6e0a4c=_0x3a7744;if(_0x3059ce[_0x6e0a4c(0x1cc)][_0x6e0a4c(0x1ea)]!=settings['telegramUsername']&&'@'+_0x3059ce['from'][_0x6e0a4c(0x1ea)]!=settings[_0x6e0a4c(0x247)])return tgBot[_0x6e0a4c(0x1de)](_0x3059ce[_0x6e0a4c(0x297)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x6e0a4c(0x20c)})[_0x6e0a4c(0x21e)](_0x565692=>{telegramError(_0x565692);}),![];return!![];}async function initTelegram(){const _0x34ea74=_0x3a7744;if(tgBot)tgBot[_0x34ea74(0x1c2)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings['telegramToken'],{'polling':!![]});let _0x359588=_0x34ea74(0x2bf);_0x359588+='\x0a',_0x359588+=_0x34ea74(0x275),_0x359588+='/disable\x20-\x20disable\x20notifications\x0a',_0x359588+=_0x34ea74(0x240),_0x359588+=_0x34ea74(0x264),_0x359588+='/status\x20-\x20show\x20the\x20status\x20of\x20your\x20bots\x0a',_0x359588+=_0x34ea74(0x218);let _0x5db9c5=_0x34ea74(0x2a5);_0x5db9c5+='\x0a',_0x5db9c5+=_0x359588,tgBot[_0x34ea74(0x2c0)](/\/start/,_0x2f582a=>{const _0x4c1add=_0x34ea74;if(!validateTelegram(_0x2f582a))return;if(settings['telegramChatId']!=_0x2f582a[_0x4c1add(0x297)]['id'])updateSetting(_0x4c1add(0x2ca),_0x2f582a[_0x4c1add(0x297)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x4c1add(0x1de)](_0x2f582a[_0x4c1add(0x297)]['id'],_0x5db9c5)['catch'](_0x3a572c=>{telegramError(_0x3a572c);});}),tgBot[_0x34ea74(0x2c0)](/\/enable/,_0x498239=>{const _0x8fe71d=_0x34ea74;if(!validateTelegram(_0x498239))return;if(settings[_0x8fe71d(0x2ca)]!=_0x498239[_0x8fe71d(0x297)]['id'])updateSetting('telegramChatId',_0x498239[_0x8fe71d(0x297)]['id']);updateSetting('telegramEnabled',!![]),tgBot[_0x8fe71d(0x1de)](_0x498239['chat']['id'],_0x8fe71d(0x29b))[_0x8fe71d(0x21e)](_0x5d9ce3=>{telegramError(_0x5d9ce3);});}),tgBot[_0x34ea74(0x2c0)](/\/config/,async _0xfb5433=>{const _0x48189a=_0x34ea74;if(!validateTelegram(_0xfb5433))return;tgBot[_0x48189a(0x1c9)]('callback_query'),tgBot[_0x48189a(0x1de)](_0xfb5433[_0x48189a(0x297)]['id'],_0x48189a(0x2aa),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':'orders'},{'text':_0x48189a(0x2ae),'callback_data':_0x48189a(0x207)},{'text':_0x48189a(0x2a8),'callback_data':'all'}]]}})['catch'](_0x16cfca=>{telegramError(_0x16cfca);}),tgBot['on'](_0x48189a(0x1e0),async _0x11de09=>{const _0x3a557a=_0x48189a,_0x4c8f50=_0x11de09[_0x3a557a(0x1d5)],_0x1781c5=_0x11de09['message'];tgBot[_0x3a557a(0x29d)](_0x11de09['id'])[_0x3a557a(0x2d2)](async()=>{const _0x4b1ed9=_0x3a557a;_0x4c8f50=='orders'&&(updateSetting(_0x4b1ed9(0x1fe),_0x4b1ed9(0x210)),updateSetting(_0x4b1ed9(0x1e7),!![]),await tgBot['sendMessage'](_0x1781c5[_0x4b1ed9(0x297)]['id'],_0x4b1ed9(0x1fa))[_0x4b1ed9(0x21e)](_0x5660ea=>{telegramError(_0x5660ea);}));_0x4c8f50==_0x4b1ed9(0x207)&&(updateSetting(_0x4b1ed9(0x1fe),_0x4b1ed9(0x207)),updateSetting('telegramEnabled',!![]),await tgBot[_0x4b1ed9(0x1de)](_0x1781c5[_0x4b1ed9(0x297)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only')['catch'](_0x5ec151=>{telegramError(_0x5ec151);}));_0x4c8f50==_0x4b1ed9(0x252)&&(updateSetting('telegramEvents','all'),updateSetting(_0x4b1ed9(0x1e7),!![]),await tgBot[_0x4b1ed9(0x1de)](_0x1781c5[_0x4b1ed9(0x297)]['id'],_0x4b1ed9(0x2a3))['catch'](_0x283f87=>{telegramError(_0x283f87);}));if(!settings[_0x4b1ed9(0x2ca)])tgBot[_0x4b1ed9(0x1de)](_0x1781c5[_0x4b1ed9(0x297)]['id'],_0x4b1ed9(0x26f))['catch'](_0x5c81e1=>{telegramError(_0x5c81e1);});}),tgBot['removeListener'](_0x3a557a(0x1e0));});}),tgBot[_0x34ea74(0x2c0)](/\/status/,_0x100c80=>{const _0x216cfe=_0x34ea74;if(!validateTelegram(_0x100c80))return;let _0x138bcb=_0x216cfe(0x2ab);config[_0x216cfe(0x1c3)](_0x2ac724=>{const _0x336c60=_0x216cfe;_0x138bcb+='Bot\x20'+_0x2ac724[_0x336c60(0x288)]+'\x20|\x20'+_0x2ac724[_0x336c60(0x221)]+':\x20'+_0x2ac724[_0x336c60(0x2b8)]+_0x336c60(0x274)+_0x2ac724['live']+'\x0a';}),_0x138bcb+='\x0a',_0x138bcb+='<b>Telegram\x20bot\x20status:</b>\x0a',_0x138bcb+=!settings[_0x216cfe(0x1e7)]?_0x216cfe(0x2c5):_0x216cfe(0x1fd),_0x138bcb+=settings['telegramEnabled']?settings['telegramEvents']==_0x216cfe(0x252)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x216cfe(0x2ba)+settings[_0x216cfe(0x1fe)]+'\x20only\x0a':'',tgBot[_0x216cfe(0x1de)](_0x100c80[_0x216cfe(0x297)]['id'],_0x138bcb,{'parse_mode':'HTML'})[_0x216cfe(0x21e)](_0x5e1ac7=>{telegramError(_0x5e1ac7);});}),tgBot[_0x34ea74(0x2c0)](/\/restart/,_0x52efd3=>{const _0x5906f7=_0x34ea74;if(!validateTelegram(_0x52efd3))return;tgBot[_0x5906f7(0x1c9)](_0x5906f7(0x1e0));const _0x418a33=getEnabledBots();if(_0x418a33[_0x5906f7(0x1f8)]==0x0)tgBot[_0x5906f7(0x1de)](_0x52efd3[_0x5906f7(0x297)]['id'],_0x5906f7(0x239))[_0x5906f7(0x21e)](_0x1cf05e=>{telegramError(_0x1cf05e);});else{let _0x53895d=[],_0x18ca8c=[];const _0x5e1337=_0x418a33['length']%0x4==0x0||_0x418a33[_0x5906f7(0x1f8)]%0x4==0x3||_0x418a33[_0x5906f7(0x1f8)]%0x3==0x1?0x4:0x3;let _0x1f65f6=0x0;_0x418a33[_0x5906f7(0x1c3)]((_0x5c397c,_0x594142)=>{const _0x731dd1=_0x5906f7;if(_0x594142%_0x5e1337==0x0)_0x18ca8c=[];_0x18ca8c[_0x731dd1(0x28a)]({'text':_0x731dd1(0x26d)+_0x5c397c[_0x731dd1(0x288)],'callback_data':_0x5c397c[_0x731dd1(0x288)]}),_0x594142%_0x5e1337==0x0&&(_0x53895d[_0x1f65f6]=_0x18ca8c,_0x1f65f6++);}),tgBot[_0x5906f7(0x1de)](_0x52efd3[_0x5906f7(0x297)]['id'],'Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',{'reply_markup':{'inline_keyboard':_0x53895d}})['catch'](_0x18c857=>{telegramError(_0x18c857);}),tgBot['on'](_0x5906f7(0x1e0),async _0x2eece0=>{const _0x182a15=_0x5906f7,_0x43a3d9=_0x2eece0[_0x182a15(0x1d5)],_0x6ec693=_0x2eece0['message'];tgBot[_0x182a15(0x29d)](_0x2eece0['id'])[_0x182a15(0x2d2)](async()=>{const _0x5eda94=_0x182a15;if(settings[_0x5eda94(0x1fe)]==_0x5eda94(0x210))tgBot[_0x5eda94(0x1de)](_0x6ec693[_0x5eda94(0x297)]['id'],_0x5eda94(0x1f6)+_0x43a3d9)[_0x5eda94(0x21e)](_0x578cd4=>{telegramError(_0x578cd4);});stopBot(_0x43a3d9);}),tgBot['removeListener']('callback_query');});}}),tgBot[_0x34ea74(0x2c0)](/\/disable/,_0xb86c19=>{const _0xfc344d=_0x34ea74;if(!validateTelegram(_0xb86c19))return;tgBot[_0xfc344d(0x1de)](_0xb86c19['chat']['id'],_0xfc344d(0x250))[_0xfc344d(0x21e)](_0x5ba432=>{telegramError(_0x5ba432);}),updateSetting(_0xfc344d(0x1e7),![]);}),tgBot[_0x34ea74(0x2c0)](/\/help/,_0x15a401=>{const _0x4a64d1=_0x34ea74;if(!validateTelegram(_0x15a401))return;tgBot[_0x4a64d1(0x1de)](_0x15a401[_0x4a64d1(0x297)]['id'],_0x359588)['catch'](_0x44fd23=>{telegramError(_0x44fd23);});}),tgBot['on']('polling_error',_0x22984c=>{const _0x5af091=_0x34ea74;if(_0x22984c['toString']()['includes'](_0x5af091(0x1ef))){logging(_0x5af091(0x206)),tgBot[_0x5af091(0x1c2)](),tgBot=null;if(socket[_0x5af091(0x2b1)])socket['botmanager']['emit']('notification',_0x5af091(0x206));}}),process[_0x34ea74(0x2c7)](_0x34ea74(0x29f),()=>{const _0x4480c3=_0x34ea74;if(tgBot)tgBot[_0x4480c3(0x1c2)]();process[_0x4480c3(0x22f)](0x1);}),process[_0x34ea74(0x2c7)](_0x34ea74(0x2d5),()=>{const _0x4fe55c=_0x34ea74;if(tgBot)tgBot['stopPolling']();process[_0x4fe55c(0x22f)](0x1);});}}function disableTelegram(){const _0x5293e4=_0x3a7744;tgBot&&(tgBot[_0x5293e4(0x1c2)](),tgBot=null);}function sendTelegram(_0x1276f4,_0x757cb2){const _0x56625a=_0x3a7744;if(settings[_0x56625a(0x1e7)]){if(settings[_0x56625a(0x1fe)]==_0x56625a(0x252)||(_0x757cb2['type']==_0x56625a(0x1d9)||_0x757cb2[_0x56625a(0x26e)]==_0x56625a(0x2c9))&&settings['telegramEvents']==_0x56625a(0x207)||_0x757cb2[_0x56625a(0x26e)]=='order'&&settings[_0x56625a(0x1fe)]==_0x56625a(0x210)){if(tgBot&&settings[_0x56625a(0x2ca)]){if(_0x757cb2['showname'])tgBot[_0x56625a(0x1de)](settings[_0x56625a(0x2ca)],_0x757cb2[_0x56625a(0x221)]+_0x56625a(0x2ad)+_0x757cb2['event'])[_0x56625a(0x21e)](_0x395ba4=>{telegramError(_0x395ba4);});else tgBot[_0x56625a(0x1de)](settings[_0x56625a(0x2ca)],'Bot\x20'+_0x1276f4+_0x56625a(0x2ad)+_0x757cb2[_0x56625a(0x242)])['catch'](_0x4e8120=>{telegramError(_0x4e8120);});}}}}function temporaryAccess2FA(_0x3a917c){const _0x5ddafc=_0x3a7744;let _0x9eca86=new Date(),_0x3f082b=![];if(lastIpApproval){if(_0x9eca86-lastIpApproval<0x1388)_0x3f082b=!![];}lastIpApproval=new Date();if(_0x3f082b)return;tgBot&&settings[_0x5ddafc(0x2ca)]&&(tgBot[_0x5ddafc(0x1c9)](_0x5ddafc(0x1e0)),tgBot[_0x5ddafc(0x1de)](settings[_0x5ddafc(0x2ca)],_0x5ddafc(0x2a0)+normalizeIP(_0x3a917c)[_0x5ddafc(0x248)]+_0x5ddafc(0x265),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x5ddafc(0x1cb),'callback_data':'5'},{'text':_0x5ddafc(0x21c),'callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x5ddafc(0x278),'callback_data':'reject'}]]}})['catch'](_0x3c4513=>{telegramError(_0x3c4513);}),tgBot['on'](_0x5ddafc(0x1e0),async _0x2bde23=>{const _0x3aca5c=_0x5ddafc,_0x567ca9=_0x2bde23[_0x3aca5c(0x1d5)],_0x2e77ec=_0x2bde23[_0x3aca5c(0x1c4)];tgBot['answerCallbackQuery'](_0x2bde23['id'])['then'](async()=>{const _0x550967=_0x3aca5c;if(_0x567ca9!=_0x550967(0x278)){telegramIpApproval={'clientip':_0x3a917c,'timestamp':new Date()[_0x550967(0x1d8)](),'expiry':_0x567ca9},await tgBot[_0x550967(0x1de)](_0x2e77ec[_0x550967(0x297)]['id'],_0x550967(0x29e)+_0x567ca9+_0x550967(0x244),{'parse_mode':'HTML'})[_0x550967(0x21e)](_0x39e4e1=>{telegramError(_0x39e4e1);});for(let _0x2ed02f in socket){socket[_0x2ed02f][_0x550967(0x24f)](_0x550967(0x2b8),{'access':{'allow':![],'reason':_0x550967(0x2d0),'token':null}});}}else await tgBot[_0x550967(0x1de)](_0x2e77ec['chat']['id'],_0x550967(0x208))[_0x550967(0x21e)](_0x43719d=>{telegramError(_0x43719d);});}),tgBot[_0x3aca5c(0x1c9)]('callback_query');}));}function loginAccess2FA(_0x43a0d3){const _0x113955=_0x3a7744;tgBot&&settings[_0x113955(0x2ca)]&&(tgBot[_0x113955(0x1c9)](_0x113955(0x1e0)),tgBot[_0x113955(0x1de)](settings[_0x113955(0x2ca)],_0x113955(0x236)+normalizeIP(_0x43a0d3)['show']+_0x113955(0x265),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x113955(0x2d3),'callback_data':loginExpiry},{'text':_0x113955(0x278),'callback_data':_0x113955(0x278)}]]}})[_0x113955(0x21e)](_0x42fc98=>{telegramError(_0x42fc98);}),tgBot['on'](_0x113955(0x1e0),async _0x335c4e=>{const _0x5093e4=_0x113955,_0x464d7d=_0x335c4e[_0x5093e4(0x1d5)],_0x4e9d9a=_0x335c4e[_0x5093e4(0x1c4)];tgBot[_0x5093e4(0x29d)](_0x335c4e['id'])[_0x5093e4(0x2d2)](async()=>{const _0xcdfcd1=_0x5093e4;if(_0x464d7d!=_0xcdfcd1(0x278)){telegram2FaApproval={'clientip':_0x43a0d3,'timestamp':new Date()['getTime'](),'expiry':_0x464d7d},await tgBot[_0xcdfcd1(0x1de)](_0x4e9d9a[_0xcdfcd1(0x297)]['id'],_0xcdfcd1(0x28b),{'parse_mode':'HTML'})[_0xcdfcd1(0x21e)](_0x5b2167=>{telegramError(_0x5b2167);});for(let _0x11ccf7 in socket){socket[_0x11ccf7][_0xcdfcd1(0x24f)](_0xcdfcd1(0x2b8),{'access':{'allow':![],'reason':_0xcdfcd1(0x2d0),'token':null}});}}else await tgBot[_0xcdfcd1(0x1de)](_0x4e9d9a[_0xcdfcd1(0x297)]['id'],_0xcdfcd1(0x1da))[_0xcdfcd1(0x21e)](_0x5bd3f3=>{telegramError(_0x5bd3f3);});}),tgBot[_0x5093e4(0x1c9)](_0x5093e4(0x1e0));}));}function getConfiguration(){const _0xbebb75=_0x3a7744;return dbConfig[_0xbebb75(0x296)](_0xbebb75(0x1c6))['sortBy'](_0xbebb75(0x288))[_0xbebb75(0x24e)]()||[];}function getEnabledBots(){const _0x36abd6=_0x3a7744;return dbConfig['get'](_0x36abd6(0x1c6))['sortBy'](_0x36abd6(0x288))[_0x36abd6(0x298)]({'status':_0x36abd6(0x220)})[_0x36abd6(0x24e)]()||[];}function getSettings(){const _0x3fa5ff=_0x3a7744;return dbSettings[_0x3fa5ff(0x296)]('settings')[_0x3fa5ff(0x24e)]()||{'timeshift':0x0};}function getSecure(){const _0x3fe1fb=_0x3a7744;return dbSecure[_0x3fe1fb(0x296)]('secure')['value']()||{};}function getBlacklist(){const _0x55437b=_0x3a7744;return dbSecure[_0x55437b(0x296)](_0x55437b(0x1f0))['value']()||[];}function broadcastToBots(_0x324748,_0x4e6465){const _0x2921e5=_0x3a7744;config[_0x2921e5(0x1c3)](_0x4b7176=>{const _0x31a1eb=_0x2921e5;if(_0x4b7176['status']==_0x31a1eb(0x220)&&_0x4b7176[_0x31a1eb(0x1fb)]=='running'){if(pid[_0x4b7176[_0x31a1eb(0x288)]])pid[_0x4b7176['botID']][_0x31a1eb(0x214)]({[_0x324748]:_0x4e6465});}});}function storeSettings(_0x5974f9,_0x2e2010=![]){const _0x33c141=_0x3a7744;_0x5974f9={...settings,..._0x5974f9};if(_0x2e2010&&_0x5974f9['bbPassword']!='************'&&_0x5974f9[_0x33c141(0x1c7)]!=''){const _0x29360c=crypt[_0x33c141(0x2bc)](secure['privateKey'],_0x5974f9['bbPassword'])[_0x33c141(0x1c4)]['split']('@')[0x0],_0x3003a0=bcrypt[_0x33c141(0x2c6)](_0x29360c,saltRounds);_0x5974f9={..._0x5974f9,'bbPassword':_0x3003a0};}if(_0x2e2010&&_0x5974f9['telegramToken']!=_0x33c141(0x25a)&&_0x5974f9['telegramToken']!=''){const _0x267199=crypt[_0x33c141(0x2bc)](secure[_0x33c141(0x1d0)],_0x5974f9[_0x33c141(0x2a6)])[_0x33c141(0x1c4)][_0x33c141(0x20f)]('@')[0x0];_0x5974f9={..._0x5974f9,'telegramToken':_0x267199};}const _0x407586=_0x5974f9[_0x33c141(0x2a6)]!=_0x33c141(0x25a)&&_0x5974f9[_0x33c141(0x2a6)]!=settings[_0x33c141(0x2a6)]||_0x5974f9[_0x33c141(0x247)]!=settings['telegramUsername'],_0x3ad4e6=_0x5974f9[_0x33c141(0x2a6)]==''||_0x5974f9[_0x33c141(0x247)]=='';if(_0x407586)_0x5974f9[_0x33c141(0x1fe)]='all';for(const [_0x5d0ea9,_0x4886ec]of Object[_0x33c141(0x2b2)](_0x5974f9)){if(_0x5d0ea9==_0x33c141(0x2a6)&&_0x4886ec==_0x33c141(0x25a)){_0x5974f9['telegramToken']=settings[_0x33c141(0x2a6)];continue;};if(_0x5d0ea9==_0x33c141(0x1c7)&&_0x4886ec==_0x33c141(0x25a)){_0x5974f9[_0x33c141(0x1c7)]=settings[_0x33c141(0x1c7)];continue;};dbSettings[_0x33c141(0x213)]('settings.'+_0x5d0ea9,_0x4886ec)[_0x33c141(0x224)]();}settings=_0x5974f9;if(socket[_0x33c141(0x2b1)])socket[_0x33c141(0x2b1)][_0x33c141(0x24f)](_0x33c141(0x26c),cleanSettings());broadcastToBots(_0x33c141(0x1e2),settings[_0x33c141(0x1e2)]);if(_0x407586&&!_0x3ad4e6)initTelegram();if(_0x407586&&_0x3ad4e6)disableTelegram();for(let _0x4698b1 in socket){setAccess(_0x4698b1);}}function updateSetting(_0x29ba6a,_0x2d0479){const _0x32a0f7=_0x3a7744;dbSettings[_0x32a0f7(0x213)]('settings.'+_0x29ba6a,_0x2d0479)[_0x32a0f7(0x224)](),settings=getSettings();if(socket[_0x32a0f7(0x2b1)])socket['botmanager'][_0x32a0f7(0x24f)](_0x32a0f7(0x26c),cleanSettings());}function storeSecure(_0x460626){const _0x558e6d=_0x3a7744;dbSecure[_0x558e6d(0x296)](_0x558e6d(0x27d))['push'](_0x460626)[_0x558e6d(0x224)](),secure=_0x460626;}function addBlacklist(){const _0x51f0e1=_0x3a7744;cleanBlacklist();let _0x4fe0d7;telegramIpApproval?_0x4fe0d7=Math[_0x51f0e1(0x251)](telegramIpApproval[_0x51f0e1(0x237)],loginExpiry):_0x4fe0d7=loginExpiry,dbSecure['get']('blacklist')[_0x51f0e1(0x28a)]({'expiry':new Date()[_0x51f0e1(0x1d8)]()+_0x4fe0d7*0x3c*0x3e8,'token':token})[_0x51f0e1(0x224)](),blacklist=dbSecure[_0x51f0e1(0x296)](_0x51f0e1(0x1f0))['value']();}function cleanBlacklist(){const _0x1a6e08=_0x3a7744;let _0x5c6e9c=dbSecure[_0x1a6e08(0x296)](_0x1a6e08(0x1f0))[_0x1a6e08(0x1f1)]()[_0x1a6e08(0x24e)](),_0x458d39=new Date()['getTime']();_0x5c6e9c['forEach'](_0x1d5ca6=>{const _0x240316=_0x1a6e08;_0x1d5ca6[_0x240316(0x237)]<_0x458d39&&dbSecure[_0x240316(0x296)](_0x240316(0x1f0))[_0x240316(0x1e1)]({'expiry':_0x1d5ca6[_0x240316(0x237)]})[_0x240316(0x224)]();});}function initStates(){const _0x56744a=_0x3a7744;let _0x251a4b=getConfiguration();_0x251a4b[_0x56744a(0x1c3)](_0x405dde=>{const _0x46705e=_0x56744a;_0x405dde[_0x46705e(0x1fb)]=_0x46705e(0x25c);}),storeConfiguration(_0x251a4b);}function onKeys(){const _0x3c83f4=new RSA();return new Promise(_0x4f9852=>{_0x3c83f4['generateKeyPairAsync']()['then'](_0x56ae5f=>{_0x4f9852(_0x56ae5f);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x15251b=_0x3a7744;let _0x22b05b=getConfiguration(),_0x4369c1=![];_0x22b05b['forEach'](_0x2d5380=>{const _0x55a08b=_0x2b40;if(_0x2d5380[_0x55a08b(0x2b8)]=='running')_0x2d5380['status']=_0x55a08b(0x220),_0x4369c1=!![];else _0x2d5380[_0x55a08b(0x2b8)]==_0x55a08b(0x25c)&&(_0x2d5380[_0x55a08b(0x2b8)]=_0x55a08b(0x1c1),_0x4369c1=!![]);});if(_0x4369c1)storeConfiguration(_0x22b05b);let _0x37229e=getSecure();if(!_0x37229e[_0x15251b(0x27b)](_0x15251b(0x267))){let _0x50d6e1=await generateKeys();_0x37229e['publicKey']=_0x50d6e1['publicKey'],_0x37229e[_0x15251b(0x1d0)]=_0x50d6e1['privateKey'],_0x37229e[_0x15251b(0x267)]=crypto['randomBytes'](0x20)[_0x15251b(0x263)]('hex');;storeSecure(_0x37229e);}let _0x5675f2=getSettings();_0x4369c1=![];!_0x5675f2['hasOwnProperty'](_0x15251b(0x1f2))&&(_0x5675f2['loginRequired']=![],_0x5675f2[_0x15251b(0x289)]='',_0x5675f2[_0x15251b(0x1c7)]='',_0x5675f2[_0x15251b(0x2a1)]=![],_0x4369c1=!![]);!_0x5675f2[_0x15251b(0x27b)]('whitelistEnabled')&&(_0x5675f2[_0x15251b(0x246)]=![],_0x5675f2['whitelist']=[],_0x5675f2['temporaryAccessAllowed']=![],_0x4369c1=!![]);if(!_0x5675f2[_0x15251b(0x27b)](_0x15251b(0x1e7))){if(_0x5675f2[_0x15251b(0x2ca)])_0x5675f2['telegramEnabled']=!![];else _0x5675f2[_0x15251b(0x1e7)]=![];_0x4369c1=!![];}if(_0x4369c1)storeSettings(_0x5675f2);}function storeConfiguration(_0x1e6c8b){const _0x1d2bf3=_0x3a7744;dbConfig[_0x1d2bf3(0x296)](_0x1d2bf3(0x1c6))[_0x1d2bf3(0x1e1)]()[_0x1d2bf3(0x224)](),dbConfig[_0x1d2bf3(0x296)](_0x1d2bf3(0x1c6))['push'](..._0x1e6c8b)[_0x1d2bf3(0x224)](),config=_0x1e6c8b;}function resetPassword(){const _0x398a15=_0x3a7744;tgBot&&settings[_0x398a15(0x2ca)]&&(tgBot[_0x398a15(0x1c9)](_0x398a15(0x1e0)),tgBot[_0x398a15(0x1de)](settings[_0x398a15(0x2ca)],_0x398a15(0x271),{'parse_mode':_0x398a15(0x20c),'reply_markup':{'inline_keyboard':[[{'text':_0x398a15(0x21f),'callback_data':_0x398a15(0x21f)},{'text':'no','callback_data':'no'}]]}})['catch'](_0x502c10=>{telegramError(_0x502c10);}),tgBot['on'](_0x398a15(0x1e0),async _0x21db29=>{const _0x23d48e=_0x398a15,_0x474a5d=_0x21db29[_0x23d48e(0x1d5)],_0x19dfb9=_0x21db29['message'];tgBot[_0x23d48e(0x29d)](_0x21db29['id'])[_0x23d48e(0x2d2)](async()=>{const _0x50ef7f=_0x23d48e;if(_0x474a5d!='no'){const _0x1cfcd9=0xf,_0x56cdf2='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x3636d0=Array[_0x50ef7f(0x1cc)](crypto[_0x50ef7f(0x2d1)](new Uint32Array(_0x1cfcd9)))['map'](_0x220cb6=>_0x56cdf2[_0x220cb6%_0x56cdf2[_0x50ef7f(0x1f8)]])[_0x50ef7f(0x27e)](''),_0x1bdebf=bcrypt[_0x50ef7f(0x2c6)](_0x3636d0,saltRounds);storeSettings({'bbPassword':_0x1bdebf}),await tgBot[_0x50ef7f(0x1de)](_0x19dfb9['chat']['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x3636d0,{'parse_mode':'HTML'})[_0x50ef7f(0x21e)](_0x49756f=>{telegramError(_0x49756f);});}else await tgBot['sendMessage'](_0x19dfb9[_0x50ef7f(0x297)]['id'],'Password\x20reset\x20rejected')[_0x50ef7f(0x21e)](_0x3e696f=>{telegramError(_0x3e696f);});}),tgBot[_0x23d48e(0x1c9)](_0x23d48e(0x1e0));}));}function logging(_0x3dcc9e){const _0x3f13a0=_0x3a7744;console['log'](getTimeStamp()+_0x3f13a0(0x290)+_0x3dcc9e);if(tgBot&&settings[_0x3f13a0(0x2ca)]&&settings[_0x3f13a0(0x1fe)]!=_0x3f13a0(0x210))tgBot[_0x3f13a0(0x1de)](settings[_0x3f13a0(0x2ca)],_0x3f13a0(0x2a7)+_0x3dcc9e)['catch'](_0xb2e044=>{telegramError(_0xb2e044);});}function getServerTime(){const _0x2781dc=_0x3a7744,_0x284d42=new Date();return _0x284d42['getFullYear']()+'/'+(_0x284d42[_0x2781dc(0x2b6)]()+0x1)[_0x2781dc(0x263)]()['padStart'](0x2,'0')+'/'+_0x284d42[_0x2781dc(0x256)]()[_0x2781dc(0x263)]()[_0x2781dc(0x219)](0x2,'0')+'\x20'+_0x284d42[_0x2781dc(0x1eb)]()[_0x2781dc(0x263)]()[_0x2781dc(0x219)](0x2,'0')+':'+_0x284d42['getMinutes']()[_0x2781dc(0x263)]()[_0x2781dc(0x219)](0x2,'0')+':'+_0x284d42[_0x2781dc(0x27f)]()['toString']()['padStart'](0x2,'0');}function getTimeStamp(){const _0x3a5510=_0x3a7744,_0x3fe027=shiftedTime();return _0x3fe027['getFullYear']()+'/'+(_0x3fe027['getMonth']()+0x1)[_0x3a5510(0x263)]()[_0x3a5510(0x219)](0x2,'0')+'/'+_0x3fe027[_0x3a5510(0x256)]()[_0x3a5510(0x263)]()[_0x3a5510(0x219)](0x2,'0')+'\x20'+_0x3fe027[_0x3a5510(0x1eb)]()['toString']()[_0x3a5510(0x219)](0x2,'0')+':'+_0x3fe027[_0x3a5510(0x24c)]()[_0x3a5510(0x263)]()[_0x3a5510(0x219)](0x2,'0')+':'+_0x3fe027[_0x3a5510(0x27f)]()[_0x3a5510(0x263)]()[_0x3a5510(0x219)](0x2,'0');}function shiftedTime(){const _0x3acb48=_0x3a7744,_0x14beb0=new Date();let _0x5ecc22=_0x14beb0;if(settings[_0x3acb48(0x1e2)]&&settings[_0x3acb48(0x1e2)]!==0x0)_0x5ecc22=fns[_0x3acb48(0x1ed)](_0x14beb0,{'hours':settings['timeshift']});return _0x5ecc22;}function startAnalytics(){let _0x3e46d5=new Date()['getUTCHours']();_0x3e46d5==0x9&&triggerAnalytics();if(pidAnalytics)clearTimeout(pidAnalytics);pidAnalytics=setTimeout(()=>{startAnalytics();},0x3c*0x3c*0x3e8);}function triggerAnalytics(){const _0x32c412=_0x3a7744;analytics[_0x32c412(0x29a)]({'title':'Balance\x20Bot\x20Server','href':_0x32c412(0x294),'path':'/v'+serverversion});}function validateCredentials(_0x40a3ee){const _0x284649=_0x3a7744;if(_0x40a3ee['username']==settings[_0x284649(0x289)]&&bcrypt['compareSync'](_0x40a3ee[_0x284649(0x1ff)],settings['bbPassword'])){if(settings[_0x284649(0x2a1)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x475b82=generateLoginToken();return{'allow':!![],'reason':_0x284649(0x1f9),'token':_0x475b82};}}else return{'allow':![],'reason':_0x284649(0x203),'token':null};}function refreshToken(){const _0x8b5806=_0x3a7744,_0x195861=generateLoginToken();return{'allow':!![],'reason':_0x8b5806(0x1f9),'token':_0x195861};}function validateAccess(_0x307f4a){const _0x14bae0=_0x3a7744;let _0x1b59cd;const _0x194569=_0x185301=>{const _0x1295c3=_0x2b40;if(settings[_0x1295c3(0x1f2)]){if(settings[_0x1295c3(0x2a1)]){if(telegram2FaApproved()){const _0xc552c=generateLoginToken();return{'allow':!![],'reason':_0x1295c3(0x260),'token':_0xc552c};}else return{'allow':![],'reason':_0x1295c3(0x202),'token':null};}else return _0x1b59cd=validToken(_0x185301),_0x1b59cd[_0x1295c3(0x27b)](_0x1295c3(0x2c9))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x185301}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x1295c3(0x2cc),'token':null};};if(settings[_0x14bae0(0x246)]){let _0x1cdd10=[...settings[_0x14bae0(0x23f)],_0x14bae0(0x223),_0x14bae0(0x26a),_0x14bae0(0x2d4)];if(_0x1cdd10[_0x14bae0(0x1c5)](externalip))return _0x194569(_0x307f4a);else{_0x1b59cd=validToken(_0x307f4a);if(_0x1b59cd['hasOwnProperty'](_0x14bae0(0x2c9)))return _0x194569(_0x307f4a);else{if(telegramIpApproved()){const _0x156876=generateToken();return _0x1b59cd=_0x194569(_0x307f4a),_0x1b59cd[_0x14bae0(0x217)]?{'allow':!![],'reason':_0x14bae0(0x230),'token':_0x156876}:_0x1b59cd;}else return settings[_0x14bae0(0x23b)]?{'allow':![],'reason':_0x14bae0(0x22d),'token':null}:{'allow':![],'reason':_0x14bae0(0x21b),'token':null};}}}else return _0x194569(_0x307f4a);}function timelyDecrypt(_0x3d306e,_0x3f025f=!![]){const _0x442b11=_0x3a7744;if(_0x3d306e)try{const _0x8e00c1=crypt[_0x442b11(0x2bc)](secure['privateKey'],_0x3d306e)[_0x442b11(0x1c4)],_0x3aaf2e=_0x8e00c1[_0x442b11(0x20f)]('@')[0x0],_0x45887a=_0x8e00c1[_0x442b11(0x20f)]('@')[0x1],_0x124aa2=new Date()[_0x442b11(0x1d8)]();if(_0x3f025f){if(_0x124aa2-_0x45887a<maxSecretAge*0x3e8)return _0x3aaf2e;else return![];}else return _0x3aaf2e;}catch{return![];}else return![];}const validToken=_0x1a370f=>{const _0x4b8830=_0x3a7744;if(!_0x1a370f)return{'error':_0x4b8830(0x1e3)};for(let _0x5b024c of blacklist){if(_0x5b024c[_0x4b8830(0x2b7)]==_0x1a370f)return{'error':_0x4b8830(0x1d6)};}let _0x438242;try{_0x438242=jwt[_0x4b8830(0x2c3)](_0x1a370f,secure['secret']+uuid);}catch{return{'error':_0x4b8830(0x20b)};}if(!_0x438242[_0x4b8830(0x27b)](_0x4b8830(0x295))&&!_0x438242[_0x4b8830(0x27b)]('username')||!_0x438242[_0x4b8830(0x27b)](_0x4b8830(0x254)))return{'error':_0x4b8830(0x22c)};if(!_0x438242[_0x4b8830(0x27b)]('username')&&_0x438242[_0x4b8830(0x27b)](_0x4b8830(0x295))){const {clientip:_0x56563a}=_0x438242;return externalip==_0x56563a?{'success':_0x4b8830(0x282)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x438242[_0x4b8830(0x27b)](_0x4b8830(0x1ea))&&_0x438242[_0x4b8830(0x27b)](_0x4b8830(0x295))){const {username:_0x361438,clientip:_0x46a54c}=_0x438242;return settings[_0x4b8830(0x289)]==_0x361438&&externalip==_0x46a54c?{'success':_0x4b8830(0x282)}:{'error':_0x4b8830(0x25f)};}}},generateLoginToken=()=>{const _0x5321c8=_0x3a7744;if(uuid)return jwt[_0x5321c8(0x253)]({'username':settings[_0x5321c8(0x289)],'clientip':externalip},secure[_0x5321c8(0x267)]+uuid,{'expiresIn':tokenRefresh*0x3c});else return![];},generateToken=()=>{const _0x12af26=_0x3a7744;if(uuid)return jwt[_0x12af26(0x253)]({'clientip':externalip},secure[_0x12af26(0x267)]+uuid,{'expiresIn':telegramIpApproval[_0x12af26(0x237)]*0x3c});else return![];},telegramIpApproved=()=>{const _0x435305=_0x3a7744;let _0x2dcc22=![];return telegramIpApproval&&telegramIpApproval[_0x435305(0x237)]!=_0x435305(0x278)&&(_0x2dcc22=telegramIpApproval[_0x435305(0x295)]==externalip&&new Date()[_0x435305(0x1d8)]()-telegramIpApproval[_0x435305(0x238)]<telegramIpApproval[_0x435305(0x237)]*0x3c*0x3e8),_0x2dcc22;},telegram2FaApproved=()=>{const _0xaeb3c2=_0x3a7744;let _0x4ac227=![];return telegram2FaApproval&&telegram2FaApproval[_0xaeb3c2(0x237)]!=_0xaeb3c2(0x278)&&(_0x4ac227=telegram2FaApproval[_0xaeb3c2(0x295)]==externalip&&new Date()[_0xaeb3c2(0x1d8)]()-telegram2FaApproval[_0xaeb3c2(0x238)]<telegram2FaApproval['expiry']*0x3c*0x3e8),_0x4ac227;},normalizeIP=_0xe483fe=>{const _0x11d2cb=_0x3a7744;let _0x3cd8e9=null,_0x98632f=null;if(ipaddr['isValid'](_0xe483fe)){const _0x4060bd=ipaddr['parse'](_0xe483fe);_0x4060bd[_0x11d2cb(0x26b)]()===_0x11d2cb(0x209)?(_0x4060bd[_0x11d2cb(0x25b)]()&&(_0x3cd8e9=_0x4060bd[_0x11d2cb(0x21a)]()['toString']()),_0x98632f=_0x4060bd[_0x11d2cb(0x263)]()):(_0x3cd8e9=_0x4060bd[_0x11d2cb(0x263)](),_0x98632f=_0x4060bd[_0x11d2cb(0x20d)]()[_0x11d2cb(0x263)]());}return{'show':_0x3cd8e9?_0x3cd8e9:_0x98632f,'store':_0x98632f};};