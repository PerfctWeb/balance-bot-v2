const _0xd7bddd=_0x28e5;(function(_0x265334,_0xf3fe4){const _0x225e43=_0x28e5,_0x148c16=_0x265334();while(!![]){try{const _0x2b6d59=-parseInt(_0x225e43(0x223))/0x1+-parseInt(_0x225e43(0x292))/0x2+-parseInt(_0x225e43(0x2c1))/0x3+-parseInt(_0x225e43(0x2c4))/0x4*(parseInt(_0x225e43(0x29f))/0x5)+-parseInt(_0x225e43(0x215))/0x6+parseInt(_0x225e43(0x2d9))/0x7+-parseInt(_0x225e43(0x29a))/0x8*(-parseInt(_0x225e43(0x1d8))/0x9);if(_0x2b6d59===_0xf3fe4)break;else _0x148c16['push'](_0x148c16['shift']());}catch(_0x1b74df){_0x148c16['push'](_0x148c16['shift']());}}}(_0x4969,0x5c145));const _0x3f9600=function(){let _0x8e43d1=!![];return function(_0x52c615,_0xb5ef3f){const _0x3539b1=_0x8e43d1?function(){if(_0xb5ef3f){const _0x56e379=_0xb5ef3f['apply'](_0x52c615,arguments);return _0xb5ef3f=null,_0x56e379;}}:function(){};return _0x8e43d1=![],_0x3539b1;};}(),_0x53b995=_0x3f9600(this,function(){const _0x2c7575=_0x28e5;return _0x53b995['toString']()['search']('(((.+)+)+)+$')[_0x2c7575(0x258)]()[_0x2c7575(0x287)](_0x53b995)[_0x2c7575(0x1c0)](_0x2c7575(0x1e7));});_0x53b995();'use strict';process[_0xd7bddd(0x1e4)][_0xd7bddd(0x1e1)]=0x1;const childProcess=require(_0xd7bddd(0x240)),FileSync=require(_0xd7bddd(0x21e)),fs=require('fs'),fns=require(_0xd7bddd(0x23f)),low=require('lowdb'),path=require(_0xd7bddd(0x1f6)),crypto=require('crypto'),Crypt=require(_0xd7bddd(0x2c0))[_0xd7bddd(0x2ed)],RSA=require('hybrid-crypto-js')[_0xd7bddd(0x28e)],bcrypt=require('bcryptjs'),jwt=require(_0xd7bddd(0x284)),analyticsLib=require(_0xd7bddd(0x1d6))['default'],googleAnalytics=require(_0xd7bddd(0x246))[_0xd7bddd(0x2bc)],ipaddr=require(_0xd7bddd(0x233)),argv=require(_0xd7bddd(0x265))(process['argv']['slice'](0x2))['argv'],PORT=argv[_0xd7bddd(0x1db)]||_0xd7bddd(0x2c8),pattern=/^[0-9]{2,4}$/;if(!pattern[_0xd7bddd(0x2eb)](PORT))return console[_0xd7bddd(0x2b3)](_0xd7bddd(0x25f)+PORT+_0xd7bddd(0x2cf)),process[_0xd7bddd(0x22f)](0x1);const HOST=argv['host']||null,userID=argv[_0xd7bddd(0x2f2)]||'';let bbpath='bb/';const botfile=_0xd7bddd(0x295),configfile=_0xd7bddd(0x289),settingsfile=_0xd7bddd(0x22e),securefile='bb-secure.json';!fs[_0xd7bddd(0x20d)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath+_0xd7bddd(0x2e5)),configpath=userID?bbpath+_0xd7bddd(0x27f)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0xd7bddd(0x2cb);!fs[_0xd7bddd(0x20d)](configpath)&&fs[_0xd7bddd(0x2ab)](configpath);!fs[_0xd7bddd(0x20d)](configbackuppath)&&fs['mkdirSync'](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0xd7bddd(0x239)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0xd7bddd(0x26e)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':'sha256','rsaStandard':_0xd7bddd(0x226)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require('express'),app=express(),http=require(_0xd7bddd(0x1d4))[_0xd7bddd(0x1d0)](app);app[_0xd7bddd(0x264)](express[_0xd7bddd(0x1c9)](path[_0xd7bddd(0x2e7)](__dirname,bbpath,_0xd7bddd(0x2d5)))),app['use'](express[_0xd7bddd(0x1c9)](path[_0xd7bddd(0x2e7)](__dirname,bbpath,_0xd7bddd(0x28c)))),app[_0xd7bddd(0x250)]('/',function(_0x2fdf7e,_0x14c5b1){const _0x51f507=_0xd7bddd;_0x14c5b1[_0x51f507(0x21d)](path[_0x51f507(0x2e7)](__dirname,bbpath,_0x51f507(0x2d5),_0x51f507(0x1c8)));}),app[_0xd7bddd(0x250)](_0xd7bddd(0x205),function(_0x566eaf,_0x6e0106){const _0x4fcc3e=_0xd7bddd;_0x6e0106[_0x4fcc3e(0x21d)](path[_0x4fcc3e(0x2e7)](__dirname,bbpath,_0x4fcc3e(0x28c),_0x4fcc3e(0x1c8)));}),app[_0xd7bddd(0x250)](_0xd7bddd(0x2a6),(_0x3d8d84,_0x556d12)=>{const _0x31825e=_0xd7bddd;_0x556d12[_0x31825e(0x21d)](path[_0x31825e(0x2e7)](__dirname,bbpath,_0x31825e(0x28c),'index.html'));}),app['get'](_0xd7bddd(0x2dc),(_0x5c61e5,_0x560be5)=>{const _0x181027=_0xd7bddd;_0x560be5[_0x181027(0x21d)](path['join'](__dirname,bbpath,'build',_0x181027(0x1c8)));}),app['get'](_0xd7bddd(0x2d7),(_0x5253c8,_0x312204)=>{const _0x3b83cc=_0xd7bddd;_0x312204[_0x3b83cc(0x21d)](path[_0x3b83cc(0x2e7)](__dirname,bbpath,_0x3b83cc(0x28c),_0x3b83cc(0x1c8)));}),app[_0xd7bddd(0x250)](_0xd7bddd(0x2b5),(_0x5287ae,_0x2c7fee)=>{const _0x5f3e7c=_0xd7bddd;_0x2c7fee[_0x5f3e7c(0x21d)](path[_0x5f3e7c(0x2e7)](__dirname,bbpath,_0x5f3e7c(0x28c),'index.html'));}),app[_0xd7bddd(0x250)]('/:bot/configuration',(_0x3c9e1b,_0x74c7a0)=>{const _0x3b0453=_0xd7bddd;_0x74c7a0[_0x3b0453(0x21d)](path[_0x3b0453(0x2e7)](__dirname,bbpath,_0x3b0453(0x28c),'index.html'));}),app['get'](_0xd7bddd(0x276),(_0xa46954,_0x4275b7)=>{const _0x55cd52=_0xd7bddd;_0x4275b7['sendFile'](path[_0x55cd52(0x2e7)](__dirname,bbpath,'build',_0x55cd52(0x1c8)));});if(HOST)http[_0xd7bddd(0x2df)](PORT,HOST);else http[_0xd7bddd(0x2df)](PORT);const io=require(_0xd7bddd(0x20a))(http,{}),analytics=analyticsLib({'app':'Balance\x20Bot','plugins':[googleAnalytics({'trackingId':'UA-192771731-1'})]}),TelegramBot=require('node-telegram-bot-api');let tgBot;if(settings[_0xd7bddd(0x1c5)]&&settings['telegramToken']!=''&&settings[_0xd7bddd(0x1c1)]&&settings[_0xd7bddd(0x1c1)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x390d98=_0xd7bddd;console[_0x390d98(0x2b3)](''),console[_0x390d98(0x2b3)](_0x390d98(0x260)),logging('Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:'+PORT),console[_0x390d98(0x2b3)](_0x390d98(0x260));if(config['length']!=0x0)config[_0x390d98(0x1dd)](_0x5cf975=>{const _0x47f725=_0x390d98;if(_0x5cf975[_0x47f725(0x2a7)]==_0x47f725(0x2bb)||_0x5cf975[_0x47f725(0x2a7)]==_0x47f725(0x2e9))logging(_0x47f725(0x245)+_0x5cf975[_0x47f725(0x1df)]+_0x47f725(0x2db)+_0x5cf975[_0x47f725(0x298)]),startBot([_0x5cf975[_0x47f725(0x1df)],userID],{'cwd':bbpath},function(_0x54c15e){if(_0x54c15e)logging(_0x54c15e);});else(_0x5cf975[_0x47f725(0x2a7)]==_0x47f725(0x238)||_0x5cf975[_0x47f725(0x2a7)]==_0x47f725(0x1eb))&&logging(_0x47f725(0x251)+_0x5cf975['botID']+_0x47f725(0x2db)+_0x5cf975[_0x47f725(0x298)]);});else!newBot&&console['log']('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();console['log']('-----------------------------------------------------------------------------------'),console[_0x390d98(0x2b3)]('');}function startSocket(){const _0x1f9f0f=_0xd7bddd;io['on'](_0x1f9f0f(0x1ce),_0x384775=>{const _0x4accec=_0x1f9f0f;let _0x59df4d,_0x12c21d,_0x299d66,_0x1c3582,_0x5c2a43;const _0x5ab6f5=_0x384775['handshake'][_0x4accec(0x262)][_0x4accec(0x297)];_0x12c21d=_0x5ab6f5[_0x4accec(0x2fc)](/bot[0-9]{3}/);if(_0x12c21d)_0x299d66=_0x12c21d[0x0][_0x4accec(0x2fc)](/[0-9]{3}/);if(_0x299d66)_0x59df4d=_0x299d66[0x0];else _0x59df4d=_0x4accec(0x2f9);const _0x57dac0=_0x384775[_0x4accec(0x2a2)][_0x4accec(0x2d0)][_0x4accec(0x1f1)];if(!_0x57dac0)_0x384775[_0x4accec(0x200)](_0x4accec(0x2a7),{'publicKey':secure[_0x4accec(0x25d)]});else{_0x1c3582=timelyDecrypt(_0x57dac0,![]);if(!_0x1c3582)logging(_0x4accec(0x218));else{_0x5c2a43=normalizeIP(_0x384775['conn'][_0x4accec(0x26d)])[_0x4accec(0x2ef)];if(!devices[_0x1c3582])devices[_0x1c3582]={'uuid':_0x1c3582,'access':{'token':null}};devices[_0x1c3582]['ip']=_0x5c2a43;const _0x1b4b24=addClient(_0x384775['id'],_0x1c3582,_0x59df4d);setAccess(_0x1b4b24),_0x384775['on'](_0x4accec(0x2f7),_0x585b05=>{const _0x414fd6=_0x4accec,_0x11a776=timelyDecrypt(_0x585b05[_0x414fd6(0x299)]);if(_0x11a776){_0x585b05={'username':_0x585b05[_0x414fd6(0x24e)],'password':_0x11a776},devices[_0x1c3582]['access']=validateCredentials(_0x585b05,_0x1c3582);if(devices[_0x1c3582][_0x414fd6(0x247)][_0x414fd6(0x1cb)]==![]&&devices[_0x1c3582]['access'][_0x414fd6(0x259)]==_0x414fd6(0x231))_0x384775['emit'](_0x414fd6(0x2a7),{'access':devices[_0x1c3582][_0x414fd6(0x247)]}),loginAccess2FA(_0x1c3582,_0x5c2a43);else{if(devices[_0x1c3582][_0x414fd6(0x247)][_0x414fd6(0x1cb)]==![]&&devices[_0x1c3582]['access'][_0x414fd6(0x259)]=='invalid\x20credentials')_0x384775[_0x414fd6(0x200)](_0x414fd6(0x2a7),{'access':devices[_0x1c3582]['access']});else devices[_0x1c3582][_0x414fd6(0x247)][_0x414fd6(0x1cb)]&&devices[_0x1c3582]['access'][_0x414fd6(0x259)]==_0x414fd6(0x2ac)&&(getClientsWithUuid(_0x1c3582)[_0x414fd6(0x1dd)](_0x5a6608=>{setAccess(_0x5a6608);}),setTokenRefresh(_0x1c3582),setSessionTimeout(_0x414fd6(0x2f7),_0x1c3582));}}else logging(_0x414fd6(0x227));}),_0x384775['on']('reset-password',()=>{resetPassword();}),_0x384775['on'](_0x4accec(0x1cc),_0x23ab57=>{removeClient(_0x384775['id']);});}}});}function initClient(_0x232946){const _0x4ebd01=_0xd7bddd;if(_0x232946!=_0x4ebd01(0x2f9)&&config[_0x4ebd01(0x266)]!=''){if(pid[_0x232946])pid[_0x232946][_0x4ebd01(0x209)]({'function':_0x4ebd01(0x210),'args':null});}}function getSocket(_0x115eff){const _0x3e3527=_0xd7bddd;return io['sockets'][_0x3e3527(0x2c6)]['get'](_0x115eff);}function _0x4969(){const _0x436be4=['jsonwebtoken','f2aRequired','restarting\x20Bot\x20','constructor','getMinutes','bb-config.json','settings.','get-portfolio','build','telegram','RSA','compareSync','value','2FA\x20required','826804xljoKm','page','temporaryAccessAllowed','bot.js','restart','referer','botname','password','6424lHDeiU','Access\x20enabled\x20for\x20','removeListener','Orders','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','506865ffMyxg','Notifications\x20enabled','push','handshake','toIPv4Address','HTML','ipv6','/:bot/portfolio','status','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','token','getStartingBalances','mkdirSync','login\x20token\x20generated','alerts','Unauthorized\x20attempt\x20to\x20store\x20configuration','update-bot','catch','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','telegramIpApproval','log','Unauthorized\x20attempt\x20to\x20get\x20portfolio','/:bot/history','<b>Balance\x20Bot\x20status:</b>\x0a','getHours','uuid','verify','\x20only\x0a','enabled','default','expiry','getTime','length','hybrid-crypto-js','549702RSBOwZ','https://hodlerhacks.com','event','20ShITeT','telegramChatId','sockets','Ok,\x20will\x20send\x20alert\x20notifications\x20only','3000','404\x20Not\x20Found','type','backup/','Unauthorized\x20attempt\x20to\x20delete\x20bot','padStart','ipc',',\x20must\x20be\x20a\x204\x20digit\x20number','auth','Ok,\x20will\x20send\x20order\x20notifications\x20only','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','hex','Notifications\x20types:\x20','build2','bot','/:bot/coins','live','2169629HBsYom','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','\x20|\x20','/:bot/performance','::1','stopPolling','listen','unlinkSync','callback_query','Notifications\x20enabled\x0a','deleted\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20logs','clients','isIPv4MappedAddress','join','/status\x20-\x20show\x20bot(s)\x20status\x0a','new','timeshift','test','find','Crypt','temporary\x20access\x20not\x20allowed','store','Bot\x20Mgr\x20>\x20','bots','user','Login\x20accepted','data','clientip','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','login','hasOwnProperty','botmanager','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','stopped','match','show','search','telegramUsername','cancel-loading','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','includes','telegramToken','chat','Login\x20rejected','index.html','static','Invalid\x20authentication\x20token\x20(2)','allow','disconnect','1000','connection','store-settings','createServer','logout','sign','reload','http','No\x20bots\x20running\x20right\x20now','analytics','-config.json','27333JYqBNt','then','sortBy','port','args','forEach','bot-','botID','-events.json','NTBA_FIX_319','filter','getDate','env','error\x20while\x20deleting\x20config\x20files:\x20','all','(((.+)+)+)+$','User\x20has\x20been\x20validated','split','whitelist','new-disabled','server','entries','sendMessage','hashSync','loginRequired','encryptedUuid','keys','temporary\x20token\x20generated','Allow\x20login\x20from\x20IP\x20address\x20<b>','Bot\x20Mgr\x20>\x20restarting\x20all\x20bots','path','-performance.json','function','bbUsername','secret','message','cloneDeep','Password\x20has\x20been\x20reset\x20to:\x20','pidRefreshToken','error','emit','Bot\x20','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','SIGTERM','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','/:bot','running','place-order','started','send','socket.io','5\x20min','privateKey','existsSync','parse','store-configuration','initclient','toIPv4MappedAddress','set','/off\x20-\x20stop\x20bot(s)\x0a','telegramEvents','4235694zgVuVe','Token\x20blacklisted','showname','Unauthorized\x20login\x20attempt\x20(public\x20key)','login\x20token\x20valid','settings','placeOrder','inherit','sendFile','lowdb/adapters/FileSync','/help\x20-\x20show\x20available\x20commands\x0a','notification','</b>\x20?','onText','562051STsFQG','copyFileSync','randomFillSync','RSA-OAEP','Unauthorized\x20login\x20attempt\x20(timeout)','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','2FA\x20login\x20token\x20generated','delete-bot','-results.json','disabled\x20Bot\x20','enabled\x20Bot\x20','bb-settings.json','exit','Unauthorized\x20attempt\x20to\x20log\x20out','2FA\x20login\x20required','answerCallbackQuery','ipaddr.js','decrypt','/enable\x20-\x20enable\x20notifications\x0a','readdirSync','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','disabled','write','Alerts','assign','getPortfolio',':\x20Bot\x20Mgr\x20>\x20','from','date-fns','child_process','pidExpireLogin','Notifications\x20disabled\x0a','telegram2FaApproval','whitelistEnabled','starting\x20bot\x20|\x20Bot\x20','@analytics/google-analytics','access','Invalid\x20username\x20or\x20IP\x20address',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','All\x20bots','secure','isDirectory','username','order','get','idling\x20bot\x20\x20\x20|\x20Bot\x20','temporary\x20access\x20timeout','add','success','************','blacklist','login\x20required','toString','reason','SIGINT','stop','connected','publicKey','::ffff:127.0.0.1','Error:\x20Invalid\x20argument\x20','-----------------------------------------------------------------------------------','accept','headers','get-logs','use','yargs/yargs','apiKey','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','login\x20not\x20required','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','\x20/\x20','getSeconds','reject','remoteAddress','defaults','yes','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','once','telegramEnabled','127.0.0.1','exp','bbPassword','/:bot/support','Invalid\x20IP\x20address','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','remove','getMonth','orders','Unauthorized\x20attempt\x20to\x20update\x20settings','name','getFullYear','config/','timestamp','Invalid\x20authentication\x20token\x20(1)','kill','/on\x20-\x20start\x20bot(s)\x0a'];_0x4969=function(){return _0x436be4;};return _0x4969();}function setAccess(_0x5df106){const _0x22b2fc=_0xd7bddd,_0x509d38=getSocket(_0x5df106['id']),_0x2e6ae0=_0x5df106[_0x22b2fc(0x2b8)],_0x12659f=_0x5df106['bot'];devices[_0x2e6ae0][_0x22b2fc(0x247)]=validateAccess(devices[_0x2e6ae0]['access'][_0x22b2fc(0x2a9)],_0x2e6ae0),_0x509d38['join'](_0x2e6ae0);if(devices[_0x2e6ae0]['access'][_0x22b2fc(0x1cb)]){_0x509d38[_0x22b2fc(0x2e7)](_0x12659f);if(_0x12659f==_0x22b2fc(0x2f9))initializeSocketBotManager(_0x509d38);else initializeSocketBot(_0x509d38);initClient(_0x12659f);}devices[_0x2e6ae0][_0x22b2fc(0x247)]['token']&&devices[_0x2e6ae0][_0x22b2fc(0x247)][_0x22b2fc(0x259)]==_0x22b2fc(0x1f3)&&setSessionTimeout('2FA',_0x2e6ae0),devices[_0x2e6ae0][_0x22b2fc(0x247)][_0x22b2fc(0x2a9)]&&devices[_0x2e6ae0][_0x22b2fc(0x247)][_0x22b2fc(0x259)]==_0x22b2fc(0x229)&&setSessionTimeout(_0x22b2fc(0x2f7),_0x2e6ae0),_0x509d38[_0x22b2fc(0x200)]('status',{'status':_0x5df106[_0x22b2fc(0x1ec)],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x2e6ae0][_0x22b2fc(0x247)],'externalip':devices[_0x2e6ae0]['ip'],'publicKey':secure['publicKey']}),devices[_0x2e6ae0][_0x22b2fc(0x247)][_0x22b2fc(0x1cb)]==![]&&devices[_0x2e6ae0][_0x22b2fc(0x247)][_0x22b2fc(0x259)]==_0x22b2fc(0x291)&&temporaryAccess2FA(_0x2e6ae0,devices[_0x2e6ae0]['ip']);}function setSessionTimeout(_0x5c57d0,_0xe28170){const _0x5ac349=_0xd7bddd;let _0x2ea51a;if(_0x5c57d0==_0x5ac349(0x2f7))_0x2ea51a=loginExpiry*0x3c*0x3e8;else _0x2ea51a=devices[_0xe28170]['telegramIpApproval'][_0x5ac349(0x2bd)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0xe28170][_0x5ac349(0x2b2)][_0x5ac349(0x280)]);if(devices[_0xe28170][_0x5ac349(0x241)])clearTimeout(devices[_0xe28170][_0x5ac349(0x241)]);devices[_0xe28170][_0x5ac349(0x241)]=setTimeout(()=>{const _0x3383ec=_0x5ac349;if(devices[_0xe28170][_0x3383ec(0x1fe)])clearTimeout(devices[_0xe28170]['pidRefreshToken']);removeSocketListeners(_0xe28170),addBlacklist(_0xe28170),devices[_0xe28170]['telegramIpApproval']=null,devices[_0xe28170][_0x3383ec(0x243)]=null,devices[_0xe28170][_0x3383ec(0x247)][_0x3383ec(0x2a9)]=null,devices[_0xe28170][_0x3383ec(0x247)]=validateAccess(devices[_0xe28170]['access'][_0x3383ec(0x2a9)],_0xe28170),!(devices[_0xe28170][_0x3383ec(0x247)][_0x3383ec(0x1cb)]&&devices[_0xe28170][_0x3383ec(0x247)][_0x3383ec(0x259)]==_0x3383ec(0x268))&&(_0x5c57d0==_0x3383ec(0x2f7)?io['to'](_0xe28170)[_0x3383ec(0x200)](_0x3383ec(0x2a7),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0xe28170)[_0x3383ec(0x200)](_0x3383ec(0x2a7),{'access':{'allow':![],'reason':_0x3383ec(0x252),'token':null}})),devices[_0xe28170][_0x3383ec(0x247)]['token']=null;},_0x2ea51a);}function setTokenRefresh(_0x15d298){const _0xa9f7cb=_0xd7bddd;if(devices[_0x15d298]['pidRefreshToken'])clearTimeout(devices[_0x15d298]['pidRefreshToken']);devices[_0x15d298][_0xa9f7cb(0x1fe)]=setTimeout(()=>{const _0x13c01d=_0xa9f7cb;getClientsWithUuid(_0x15d298)[_0x13c01d(0x2bf)]!=0x0?(devices[_0x15d298][_0x13c01d(0x247)]=refreshToken(_0x15d298),io['to'](_0x15d298)[_0x13c01d(0x200)](_0x13c01d(0x2a7),{'status':_0x13c01d(0x25c),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x15d298]['access'],'externalip':devices[_0x15d298]['ip'],'publicKey':secure[_0x13c01d(0x25d)]}),setTokenRefresh(_0x15d298)):clearTimeout(devices[_0x15d298][_0x13c01d(0x1fe)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1df9a8){const _0xd4d12b=_0xd7bddd,_0x26f547=getClient(_0x1df9a8['id'])[_0xd4d12b(0x2b8)];_0x1df9a8['emit'](_0xd4d12b(0x2f1),config),_0x1df9a8[_0xd4d12b(0x200)](_0xd4d12b(0x21a),cleanSettings()),_0x1df9a8['on']('add-bot',_0x78b7e9=>{const _0x2647ea=_0xd4d12b;if(validateAccess(_0x78b7e9,_0x26f547)[_0x2647ea(0x1cb)])addBot();else logging('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x1df9a8['on'](_0xd4d12b(0x2af),(_0xa64765,_0x139dc2)=>{const _0x11e51f=_0xd4d12b;if(validateAccess(_0x139dc2,_0x26f547)['allow'])toggleBot(_0xa64765[_0x11e51f(0x1df)],_0xa64765[_0x11e51f(0x2a7)],_0xa64765[_0x11e51f(0x2d8)]);else logging('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x1df9a8['on'](_0xd4d12b(0x22a),(_0xfae319,_0x13dc6f)=>{const _0x47049b=_0xd4d12b;if(validateAccess(_0x13dc6f,_0x26f547)[_0x47049b(0x1cb)])deleteBot(_0xfae319);else logging(_0x47049b(0x2cc));}),_0x1df9a8['on'](_0xd4d12b(0x1cf),(_0x18fee,_0x3071d9)=>{const _0x14a12b=_0xd4d12b;if(validateAccess(_0x3071d9,_0x26f547)[_0x14a12b(0x1cb)])storeSettings(_0x18fee,!![]);else logging(_0x14a12b(0x27c));}),_0x1df9a8['on']('logout',_0x5a242c=>{const _0x3d45ad=_0xd4d12b;if(validateAccess(_0x5a242c,_0x26f547)[_0x3d45ad(0x1cb)]){if(devices[_0x26f547][_0x3d45ad(0x1fe)])clearTimeout(devices[_0x26f547]['pidRefreshToken']);if(devices[_0x26f547][_0x3d45ad(0x241)])clearTimeout(devices[_0x26f547][_0x3d45ad(0x241)]);removeSocketListeners(getClient(_0x1df9a8['id'])[_0x3d45ad(0x2b8)]),addBlacklist(_0x26f547),devices[_0x26f547][_0x3d45ad(0x2b2)]=null,devices[_0x26f547][_0x3d45ad(0x243)]=null,devices[_0x26f547][_0x3d45ad(0x247)][_0x3d45ad(0x2a9)]=null,io['to'](getClient(_0x1df9a8['id'])[_0x3d45ad(0x2b8)])[_0x3d45ad(0x200)](_0x3d45ad(0x2a7),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0x3d45ad(0x230));});}function initializeSocketBot(_0x5d0e75){const _0xc673b0=_0xd7bddd,_0x538532=getClient(_0x5d0e75['id'])[_0xc673b0(0x2d6)],_0x2ad624=getClient(_0x5d0e75['id'])[_0xc673b0(0x2b8)];_0x5d0e75['on'](_0xc673b0(0x263),(_0x2071eb,_0x1ac65f)=>{const _0x1d92d2=_0xc673b0;if(validateAccess(_0x1ac65f,_0x2ad624)[_0x1d92d2(0x1cb)]){if(pid[_0x538532])pid[_0x538532][_0x1d92d2(0x209)]({'function':'emitHistory','args':_0x2071eb});}else logging(_0x1d92d2(0x2e4));}),_0x5d0e75['on'](_0xc673b0(0x28b),(_0x28e269,_0x2736d8)=>{const _0x2a1621=_0xc673b0;if(validateAccess(_0x2736d8,_0x2ad624)[_0x2a1621(0x1cb)]){if(pid[_0x538532])pid[_0x538532]['send']({'function':_0x2a1621(0x23c),'args':_0x28e269});}else logging(_0x2a1621(0x2b4));}),_0x5d0e75['on'](_0xc673b0(0x20f),(_0x4f873d,_0x4d1d1d)=>{const _0x495d48=_0xc673b0;if(validateAccess(_0x4d1d1d,_0x2ad624)[_0x495d48(0x1cb)]){if(pid[_0x538532])pid[_0x538532][_0x495d48(0x209)]({'function':'storeConfiguration','args':_0x4f873d});}else logging(_0x495d48(0x2ae));}),_0x5d0e75['on']('store-headless',(_0x47f64a,_0x13d497)=>{const _0x1e9c63=_0xc673b0;if(validateAccess(_0x13d497,_0x2ad624)[_0x1e9c63(0x1cb)]){if(pid[_0x538532])pid[_0x538532][_0x1e9c63(0x209)]({'function':'storeHeadless','args':_0x47f64a});}else logging(_0x1e9c63(0x202));}),_0x5d0e75['on']('get-starting-balances',_0x3010b7=>{const _0xe720d3=_0xc673b0;if(validateAccess(_0x3010b7,_0x2ad624)[_0xe720d3(0x1cb)]){if(pid[_0x538532])pid[_0x538532][_0xe720d3(0x209)]({'function':_0xe720d3(0x2aa),'args':null});}else logging(_0xe720d3(0x2f6));}),_0x5d0e75['on'](_0xc673b0(0x207),(_0x557c2e,_0x1318bb)=>{const _0x337797=_0xc673b0;if(validateAccess(_0x1318bb,_0x2ad624)[_0x337797(0x1cb)]){if(pid[_0x538532])pid[_0x538532]['send']({'function':_0x337797(0x21b),'args':_0x557c2e});}else logging(_0x337797(0x269));}),_0x5d0e75['on'](_0xc673b0(0x1c2),_0x2e5c77=>{const _0x4ff4c8=_0xc673b0;if(validateAccess(_0x2e5c77,_0x2ad624)[_0x4ff4c8(0x1cb)]){if(pid[_0x538532])pid[_0x538532][_0x4ff4c8(0x209)]({'function':'cancelLoading','args':null});}else logging(_0x4ff4c8(0x267));}),_0x5d0e75['on'](_0xc673b0(0x1d1),_0x1c440=>{const _0x57152d=_0xc673b0;if(validateAccess(_0x1c440,_0x2ad624)[_0x57152d(0x1cb)]){if(devices[_0x2ad624]['pidRefreshToken'])clearTimeout(devices[_0x2ad624][_0x57152d(0x1fe)]);if(devices[_0x2ad624][_0x57152d(0x241)])clearTimeout(devices[_0x2ad624]['pidExpireLogin']);removeSocketListeners(getClient(_0x5d0e75['id'])[_0x57152d(0x2b8)]),addBlacklist(_0x2ad624),devices[_0x2ad624]['telegramIpApproval']=null,devices[_0x2ad624][_0x57152d(0x243)]=null,devices[_0x2ad624]['access'][_0x57152d(0x2a9)]=null,io['to'](getClient(_0x5d0e75['id'])[_0x57152d(0x2b8)])[_0x57152d(0x200)](_0x57152d(0x2a7),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logging(_0x57152d(0x230));});}function removeSocketListeners(_0x188448){const _0x767644=_0xd7bddd;getClientsWithUuid(_0x188448)[_0x767644(0x1dd)](_0x15ff16=>{getSocket(_0x15ff16['id'])['removeAllListeners']();});}function cleanSettings(){const _0x3288cb=_0xd7bddd;let _0x30c55d=settings;return settings[_0x3288cb(0x1c5)]&&settings['telegramToken']!=''&&(_0x30c55d={..._0x30c55d,'telegramToken':_0x3288cb(0x255)}),settings[_0x3288cb(0x275)]&&settings[_0x3288cb(0x275)]!=''&&(_0x30c55d={..._0x30c55d,'bbPassword':_0x3288cb(0x255)}),_0x30c55d;}function startBot(_0x1ab374,_0x7759ca,_0x11dd8d){const _0x6b437=_0xd7bddd;let _0x2e09e3=![];const _0xb313e=_0x1ab374[0x0];_0x7759ca={..._0x7759ca,'stdio':[_0x6b437(0x21c),'inherit','inherit',_0x6b437(0x2ce)]},pid[_0xb313e]=childProcess['fork'](botfile,_0x1ab374,_0x7759ca),pid[_0xb313e]['on'](_0x6b437(0x1fb),_0x19599a=>{const _0xb6dd60=_0x6b437;switch(Object[_0xb6dd60(0x1f2)](_0x19599a)[0x0]){case'botname':updateBotName(_0xb313e,_0x19599a['botname']);break;case _0xb6dd60(0x2a7):updateStatus(_0xb313e,_0x19599a[_0xb6dd60(0x2a7)]);break;case'live':updateLive(_0xb313e,_0x19599a['live']);break;case _0xb6dd60(0x208):updateLive(_0xb313e,_0x19599a[_0xb6dd60(0x208)]),io['to'](_0xb313e)[_0xb6dd60(0x200)](_0xb6dd60(0x2a7),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0xb6dd60(0x25b):_0x19599a[_0xb6dd60(0x25b)]==_0xb6dd60(0x296)&&stopBot(_0xb313e);_0x19599a[_0xb6dd60(0x25b)]==_0xb6dd60(0x282)&&toggleBot(_0xb313e,_0xb6dd60(0x238),_0xb6dd60(0x2fb));break;case _0xb6dd60(0x28d):sendTelegram(_0xb313e,_0x19599a['telegram']);break;case _0xb6dd60(0x1f8):io['to'](_0xb313e)['emit'](_0x19599a[_0xb6dd60(0x1f8)],_0x19599a[_0xb6dd60(0x1dc)]);break;}}),pid[_0xb313e]['on'](_0x6b437(0x1ff),function(_0x27fb80){if(_0x2e09e3)return;_0x2e09e3=!![],_0x11dd8d(_0x27fb80);}),pid[_0xb313e]['on']('exit',function(_0x43a6c5){const _0x39e579=_0x6b437;if(_0x2e09e3)return;_0x2e09e3=!![],_0x11dd8d(null);const _0x558d95=dbConfig[_0x39e579(0x250)]('bots')[_0x39e579(0x2ec)]({'botID':_0xb313e})[_0x39e579(0x290)]();_0x558d95&&(_0x558d95[_0x39e579(0x2a7)]==_0x39e579(0x2bb)||_0x558d95[_0x39e579(0x2a7)]==_0x39e579(0x2e9))&&(updateLive(_0xb313e,_0x39e579(0x2fb)),logging(_0x39e579(0x286)+_0xb313e),startBot([_0xb313e,userID],{'cwd':bbpath},function(_0x5e5f08){if(_0x5e5f08)logging(_0x5e5f08);}));});}function stopBot(_0x366f43){const _0x4ba0ac=_0xd7bddd;getClientsWithBotID(_0x366f43)[_0x4ba0ac(0x1dd)](_0x33d4cb=>{const _0x54ceff=_0x4ba0ac;getSocket(_0x33d4cb['id'])[_0x54ceff(0x1cc)](!![]),removeClient(_0x33d4cb['id']);});if(pid[_0x366f43])pid[_0x366f43][_0x4ba0ac(0x282)]();}function addBot(){const _0x283135=_0xd7bddd;let _0x19da6e;for(let _0x23c32e=0x1;_0x23c32e<0x3e9;_0x23c32e++){_0x19da6e=_0x23c32e[_0x283135(0x258)]()[_0x283135(0x2cd)](0x3,'0');let _0x48ddd1=config[_0x283135(0x2ec)](_0x3531ae=>_0x3531ae[_0x283135(0x1df)]==_0x19da6e);if(!_0x48ddd1)break;}if(_0x19da6e===_0x283135(0x1cd)){logging('the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logging('starting\x20new\x20bot\x20|\x20Bot\x20'+_0x19da6e),dbConfig[_0x283135(0x250)](_0x283135(0x2f1))['push']({'botID':_0x19da6e,'botname':_0x283135(0x201)+_0x19da6e,'status':_0x283135(0x2e9),'live':''})['write'](),startBot([_0x19da6e,userID],{'cwd':bbpath},function(_0x368bc2){if(_0x368bc2)logging(_0x368bc2);}),config=getConfiguration(),io['to']('botmanager')[_0x283135(0x200)](_0x283135(0x2f1),config);}function deleteBot(_0x48bcfe){const _0x19399c=_0xd7bddd;getClientsWithBotID(_0x48bcfe)['forEach'](_0x80a261=>{getSocket(_0x80a261['id'])['disconnect'](!![]),removeClient(_0x80a261['id']);}),dbConfig[_0x19399c(0x250)](_0x19399c(0x2f1))['remove']({'botID':_0x48bcfe})['write'](),logging(_0x19399c(0x2e3)+_0x48bcfe),stopBot(_0x48bcfe);try{fs['unlinkSync'](path[_0x19399c(0x2e7)](configpath,'bot-'+_0x48bcfe+_0x19399c(0x1d7))),fs[_0x19399c(0x2e0)](path[_0x19399c(0x2e7)](configpath,_0x19399c(0x1de)+_0x48bcfe+_0x19399c(0x1e0))),fs[_0x19399c(0x2e0)](path[_0x19399c(0x2e7)](configpath,_0x19399c(0x1de)+_0x48bcfe+_0x19399c(0x1f7))),fs[_0x19399c(0x2e0)](path[_0x19399c(0x2e7)](configpath,'bot-'+_0x48bcfe+_0x19399c(0x22b)));}catch(_0x1d5b30){if(_0x1d5b30)logging(_0x19399c(0x1e5),_0x1d5b30);}config=getConfiguration(),io['to'](_0x19399c(0x2f9))[_0x19399c(0x200)](_0x19399c(0x2f1),config);}function toggleBot(_0x2d926d,_0x4ef9b3,_0xa1c981){const _0x4f659b=_0xd7bddd;dbConfig[_0x4f659b(0x250)](_0x4f659b(0x2f1))[_0x4f659b(0x2ec)]({'botID':_0x2d926d})['assign']({'status':_0x4ef9b3})[_0x4f659b(0x23b)]({'live':_0xa1c981})[_0x4f659b(0x239)]();if(_0x4ef9b3=='enabled'||_0x4ef9b3==_0x4f659b(0x2e9))logging(_0x4f659b(0x22d)+_0x2d926d),startBot([_0x2d926d,userID],{'cwd':bbpath},function(_0x146be2){if(_0x146be2)logging(_0x146be2);});else(_0x4ef9b3=='disabled'||_0x4ef9b3==_0x4f659b(0x1eb))&&(logging(_0x4f659b(0x22c)+_0x2d926d),stopBot(_0x2d926d));config=getConfiguration(),io['to'](_0x4f659b(0x2f9))[_0x4f659b(0x200)]('bots',config);}function toggleStatus(_0x1fc682){const _0x21474f=_0xd7bddd;let _0x34483f=dbConfig[_0x21474f(0x250)](_0x21474f(0x2f1))['find']({'botID':_0x1fc682})[_0x21474f(0x290)](),_0x1ab353;if(_0x34483f[_0x21474f(0x2a7)]===_0x21474f(0x2bb))_0x1ab353=_0x21474f(0x238);else{if(_0x34483f['status']===_0x21474f(0x2e9))_0x1ab353='new-disabled';else{if(_0x34483f[_0x21474f(0x2a7)]===_0x21474f(0x1eb))_0x1ab353='new';else{if(_0x34483f[_0x21474f(0x2a7)]===_0x21474f(0x238))_0x1ab353=_0x21474f(0x2bb);}}}return _0x1ab353;}function updateStatus(_0x49b40f,_0x286a9e){const _0x2adf32=_0xd7bddd;dbConfig[_0x2adf32(0x250)]('bots')[_0x2adf32(0x2ec)]({'botID':_0x49b40f})['assign']({'status':_0x286a9e})[_0x2adf32(0x239)](),config=getConfiguration(),io['to'](_0x2adf32(0x2f9))['emit']('bots',config);}function updateLive(_0xe0d6b3,_0x3e9b1e){const _0x171292=_0xd7bddd;dbConfig['get'](_0x171292(0x2f1))['find']({'botID':_0xe0d6b3})[_0x171292(0x23b)]({'live':_0x3e9b1e})['write'](),config=getConfiguration(),io['to'](_0x171292(0x2f9))[_0x171292(0x200)]('bots',config);}function updateBotName(_0x32f5d2,_0x331d5b){const _0x1a50c1=_0xd7bddd;dbConfig[_0x1a50c1(0x250)](_0x1a50c1(0x2f1))[_0x1a50c1(0x2ec)]({'botID':_0x32f5d2})['assign']({'botname':_0x331d5b})[_0x1a50c1(0x239)](),config=getConfiguration(),io['to'](_0x1a50c1(0x2f9))['emit']('bots',config);}function telegramError(_0x34c159){const _0x2437e4=_0xd7bddd;console[_0x2437e4(0x2b3)](getTimeStamp()+_0x2437e4(0x249));}function validateTelegram(_0x51e3f9){const _0x538b9b=_0xd7bddd;if(_0x51e3f9[_0x538b9b(0x23e)][_0x538b9b(0x24e)]!=settings['telegramUsername']&&'@'+_0x51e3f9['from']['username']!=settings['telegramUsername'])return tgBot[_0x538b9b(0x1ee)](_0x51e3f9[_0x538b9b(0x1c6)]['id'],_0x538b9b(0x29e),{'parse_mode':_0x538b9b(0x2a4)})[_0x538b9b(0x2b0)](_0x4b9bef=>{telegramError(_0x4b9bef);}),![];return!![];}async function initTelegram(){const _0x3f68e2=_0xd7bddd;if(tgBot)tgBot[_0x3f68e2(0x2de)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x3f68e2(0x1c5)],{'polling':!![]});let _0x5ab614='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x5ab614+='\x0a',_0x5ab614+=_0x3f68e2(0x235),_0x5ab614+='/disable\x20-\x20disable\x20notifications\x0a',_0x5ab614+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x5ab614+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x5ab614+=_0x3f68e2(0x283),_0x5ab614+=_0x3f68e2(0x213),_0x5ab614+=_0x3f68e2(0x2e8),_0x5ab614+=_0x3f68e2(0x21f);let _0x26cbbc='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x26cbbc+='\x0a',_0x26cbbc+=_0x5ab614,tgBot[_0x3f68e2(0x222)](/\/start/,_0x5af333=>{const _0x5708b2=_0x3f68e2;if(!validateTelegram(_0x5af333))return;if(settings[_0x5708b2(0x2c5)]!=_0x5af333['chat']['id'])updateSetting(_0x5708b2(0x2c5),_0x5af333[_0x5708b2(0x1c6)]['id']);updateSetting(_0x5708b2(0x272),!![]),tgBot[_0x5708b2(0x1ee)](_0x5af333[_0x5708b2(0x1c6)]['id'],_0x26cbbc)[_0x5708b2(0x2b0)](_0x423457=>{telegramError(_0x423457);});}),tgBot[_0x3f68e2(0x222)](/\/enable/,_0x5bfd5f=>{const _0x557653=_0x3f68e2;if(!validateTelegram(_0x5bfd5f))return;if(settings[_0x557653(0x2c5)]!=_0x5bfd5f[_0x557653(0x1c6)]['id'])updateSetting('telegramChatId',_0x5bfd5f['chat']['id']);updateSetting(_0x557653(0x272),!![]),tgBot['sendMessage'](_0x5bfd5f['chat']['id'],_0x557653(0x2a0))[_0x557653(0x2b0)](_0x59eeda=>{telegramError(_0x59eeda);});}),tgBot[_0x3f68e2(0x222)](/\/config/,async _0xbccd42=>{const _0x4a9c84=_0x3f68e2;if(!validateTelegram(_0xbccd42))return;tgBot[_0x4a9c84(0x29c)](_0x4a9c84(0x2e1)),tgBot['sendMessage'](_0xbccd42[_0x4a9c84(0x1c6)]['id'],'Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',{'reply_markup':{'inline_keyboard':[[{'text':_0x4a9c84(0x29d),'callback_data':_0x4a9c84(0x27b)},{'text':_0x4a9c84(0x23a),'callback_data':_0x4a9c84(0x2ad)},{'text':'All','callback_data':_0x4a9c84(0x1e6)}]]}})[_0x4a9c84(0x2b0)](_0x3b96d3=>{telegramError(_0x3b96d3);}),tgBot['on']('callback_query',async _0x208f43=>{const _0xe2d4d6=_0x4a9c84,_0x533ed9=_0x208f43[_0xe2d4d6(0x2f4)],_0x54ba9a=_0x208f43[_0xe2d4d6(0x1fb)];tgBot[_0xe2d4d6(0x232)](_0x208f43['id'])[_0xe2d4d6(0x1d9)](async()=>{const _0x579c11=_0xe2d4d6;_0x533ed9==_0x579c11(0x27b)&&(updateSetting(_0x579c11(0x214),'orders'),updateSetting(_0x579c11(0x272),!![]),await tgBot[_0x579c11(0x1ee)](_0x54ba9a[_0x579c11(0x1c6)]['id'],_0x579c11(0x2d1))[_0x579c11(0x2b0)](_0x567ed1=>{telegramError(_0x567ed1);}));_0x533ed9==_0x579c11(0x2ad)&&(updateSetting(_0x579c11(0x214),_0x579c11(0x2ad)),updateSetting(_0x579c11(0x272),!![]),await tgBot[_0x579c11(0x1ee)](_0x54ba9a[_0x579c11(0x1c6)]['id'],_0x579c11(0x2c7))['catch'](_0x222eaf=>{telegramError(_0x222eaf);}));_0x533ed9=='all'&&(updateSetting(_0x579c11(0x214),_0x579c11(0x1e6)),updateSetting(_0x579c11(0x272),!![]),await tgBot[_0x579c11(0x1ee)](_0x54ba9a[_0x579c11(0x1c6)]['id'],_0x579c11(0x237))[_0x579c11(0x2b0)](_0x2904a2=>{telegramError(_0x2904a2);}));if(!settings[_0x579c11(0x2c5)])tgBot['sendMessage'](_0x54ba9a[_0x579c11(0x1c6)]['id'],_0x579c11(0x1c3))[_0x579c11(0x2b0)](_0x45f5cb=>{telegramError(_0x45f5cb);});}),tgBot['removeListener']('callback_query');});}),tgBot[_0x3f68e2(0x222)](/\/status/,_0x1bf57d=>{const _0x45b549=_0x3f68e2;if(!validateTelegram(_0x1bf57d))return;let _0x4e4410=_0x45b549(0x2b6);config[_0x45b549(0x1dd)](_0xd11921=>{const _0x386363=_0x45b549;_0x4e4410+=_0x386363(0x201)+_0xd11921[_0x386363(0x1df)]+_0x386363(0x2db)+_0xd11921['botname']+':\x20'+_0xd11921[_0x386363(0x2a7)]+_0x386363(0x26a)+_0xd11921['live']+'\x0a';}),_0x4e4410+='\x0a',_0x4e4410+='<b>Telegram\x20bot\x20status:</b>\x0a',_0x4e4410+=!settings[_0x45b549(0x272)]?_0x45b549(0x242):_0x45b549(0x2e2),_0x4e4410+=settings[_0x45b549(0x272)]?settings[_0x45b549(0x214)]==_0x45b549(0x1e6)?_0x45b549(0x204):_0x45b549(0x2d4)+settings[_0x45b549(0x214)]+_0x45b549(0x2ba):'',tgBot['sendMessage'](_0x1bf57d[_0x45b549(0x1c6)]['id'],_0x4e4410,{'parse_mode':_0x45b549(0x2a4)})[_0x45b549(0x2b0)](_0x5d8cc8=>{telegramError(_0x5d8cc8);});}),tgBot[_0x3f68e2(0x222)](/\/restart/,_0x199724=>{const _0x414f96=_0x3f68e2;if(!validateTelegram(_0x199724))return;tgBot[_0x414f96(0x29c)](_0x414f96(0x2e1));const _0x50b792=getEnabledBots();if(_0x50b792['length']==0x0)tgBot['sendMessage'](_0x199724['chat']['id'],_0x414f96(0x1d5))['catch'](_0x575168=>{telegramError(_0x575168);});else{if(_0x50b792[_0x414f96(0x2bf)]>0x1)_0x50b792[_0x414f96(0x2a1)]({'botID':_0x414f96(0x1e6)});let _0x1a54c1=[],_0x30fb67=[];const _0x58f839=_0x50b792[_0x414f96(0x2bf)]%0x4==0x0||_0x50b792[_0x414f96(0x2bf)]%0x4==0x3||_0x50b792['length']%0x3==0x1?0x4:0x3;let _0x1a638d=0x0;_0x50b792['forEach']((_0x2cbae7,_0x31b8ed)=>{const _0x23d08e=_0x414f96;if(_0x31b8ed%_0x58f839==0x0)_0x30fb67=[];_0x30fb67[_0x23d08e(0x2a1)]({'text':_0x2cbae7['botID']=='all'?_0x23d08e(0x24b):_0x23d08e(0x201)+_0x2cbae7[_0x23d08e(0x1df)],'callback_data':_0x2cbae7[_0x23d08e(0x1df)]}),_0x31b8ed%_0x58f839==0x0&&(_0x1a54c1[_0x1a638d]=_0x30fb67,_0x1a638d++);}),tgBot[_0x414f96(0x1ee)](_0x199724[_0x414f96(0x1c6)]['id'],_0x414f96(0x2a8),{'reply_markup':{'inline_keyboard':_0x1a54c1}})[_0x414f96(0x2b0)](_0x35d14a=>{telegramError(_0x35d14a);}),tgBot['on'](_0x414f96(0x2e1),async _0x318372=>{const _0x31ded3=_0x414f96,_0x236e82=_0x318372[_0x31ded3(0x2f4)],_0x219c1e=_0x318372['message'];tgBot['answerCallbackQuery'](_0x318372['id'])[_0x31ded3(0x1d9)](async()=>{const _0x58a947=_0x31ded3;if(_0x236e82==_0x58a947(0x1e6)){if(settings[_0x58a947(0x214)]=='orders')tgBot['sendMessage'](_0x219c1e[_0x58a947(0x1c6)]['id'],_0x58a947(0x1f5))['catch'](_0x460316=>{telegramError(_0x460316);});config[_0x58a947(0x1dd)](_0x4ffd14=>{const _0xda219=_0x58a947;stopBot(_0x4ffd14[_0xda219(0x1df)]);});}else{if(settings[_0x58a947(0x214)]==_0x58a947(0x27b))tgBot['sendMessage'](_0x219c1e['chat']['id'],_0x58a947(0x228)+_0x236e82)[_0x58a947(0x2b0)](_0x138625=>{telegramError(_0x138625);});stopBot(_0x236e82);}}),tgBot[_0x31ded3(0x29c)](_0x31ded3(0x2e1));});}}),tgBot[_0x3f68e2(0x222)](/\/on/,_0x396731=>{const _0x3c0428=_0x3f68e2;if(!validateTelegram(_0x396731))return;tgBot[_0x3c0428(0x29c)]('callback_query');const _0x36a1aa=getDisabledBots();if(_0x36a1aa[_0x3c0428(0x2bf)]==0x0)tgBot[_0x3c0428(0x1ee)](_0x396731[_0x3c0428(0x1c6)]['id'],'All\x20bots\x20running\x20right\x20now')[_0x3c0428(0x2b0)](_0x23478c=>{telegramError(_0x23478c);});else{if(_0x36a1aa[_0x3c0428(0x2bf)]>0x1)_0x36a1aa[_0x3c0428(0x2a1)]({'botID':_0x3c0428(0x1e6)});let _0x47e728=[],_0x1382fe=[];const _0x73291c=_0x36a1aa[_0x3c0428(0x2bf)]%0x4==0x0||_0x36a1aa[_0x3c0428(0x2bf)]%0x4==0x3||_0x36a1aa[_0x3c0428(0x2bf)]%0x3==0x1?0x4:0x3;let _0x3fc3d1=0x0;_0x36a1aa[_0x3c0428(0x1dd)]((_0xec17e7,_0x5f2584)=>{const _0x5e8084=_0x3c0428;if(_0x5f2584%_0x73291c==0x0)_0x1382fe=[];_0x1382fe[_0x5e8084(0x2a1)]({'text':_0xec17e7[_0x5e8084(0x1df)]==_0x5e8084(0x1e6)?_0x5e8084(0x24b):_0x5e8084(0x201)+_0xec17e7[_0x5e8084(0x1df)],'callback_data':_0xec17e7[_0x5e8084(0x1df)]}),_0x5f2584%_0x73291c==0x0&&(_0x47e728[_0x3fc3d1]=_0x1382fe,_0x3fc3d1++);}),tgBot['sendMessage'](_0x396731[_0x3c0428(0x1c6)]['id'],_0x3c0428(0x278),{'reply_markup':{'inline_keyboard':_0x47e728}})[_0x3c0428(0x2b0)](_0x4bc6a4=>{telegramError(_0x4bc6a4);}),tgBot['on']('callback_query',async _0x396d64=>{const _0x552041=_0x3c0428,_0x540493=_0x396d64[_0x552041(0x2f4)],_0x3e5a65=_0x396d64[_0x552041(0x1fb)];tgBot[_0x552041(0x232)](_0x396d64['id'])['then'](async()=>{const _0x17ca6e=_0x552041;if(_0x540493=='all'){if(settings[_0x17ca6e(0x214)]==_0x17ca6e(0x27b))tgBot[_0x17ca6e(0x1ee)](_0x3e5a65['chat']['id'],_0x17ca6e(0x2b1))[_0x17ca6e(0x2b0)](_0x5f1de8=>{telegramError(_0x5f1de8);});_0x36a1aa['forEach'](_0xbef2db=>{const _0x350dde=_0x17ca6e;if(_0xbef2db[_0x350dde(0x1df)]!=_0x350dde(0x1e6))toggleBot(_0xbef2db[_0x350dde(0x1df)],toggleStatus(_0xbef2db[_0x350dde(0x1df)]),_0x350dde(0x2fb));});}else{if(settings[_0x17ca6e(0x214)]==_0x17ca6e(0x27b))tgBot['sendMessage'](_0x3e5a65[_0x17ca6e(0x1c6)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x540493)[_0x17ca6e(0x2b0)](_0x531208=>{telegramError(_0x531208);});toggleBot(_0x540493,toggleStatus(_0x540493),_0x17ca6e(0x2fb));}}),tgBot[_0x552041(0x29c)](_0x552041(0x2e1));});}}),tgBot[_0x3f68e2(0x222)](/\/off/,_0x2ceb1b=>{const _0x114457=_0x3f68e2;if(!validateTelegram(_0x2ceb1b))return;tgBot[_0x114457(0x29c)](_0x114457(0x2e1));const _0x505845=getEnabledBots();if(_0x505845[_0x114457(0x2bf)]==0x0)tgBot['sendMessage'](_0x2ceb1b[_0x114457(0x1c6)]['id'],_0x114457(0x1d5))[_0x114457(0x2b0)](_0x5bbba6=>{telegramError(_0x5bbba6);});else{if(_0x505845['length']>0x1)_0x505845[_0x114457(0x2a1)]({'botID':_0x114457(0x1e6)});let _0x97f940=[],_0x513333=[];const _0x2bca28=_0x505845[_0x114457(0x2bf)]%0x4==0x0||_0x505845[_0x114457(0x2bf)]%0x4==0x3||_0x505845['length']%0x3==0x1?0x4:0x3;let _0x382882=0x0;_0x505845['forEach']((_0x5e59fe,_0x48f385)=>{const _0x2e9a6e=_0x114457;if(_0x48f385%_0x2bca28==0x0)_0x513333=[];_0x513333[_0x2e9a6e(0x2a1)]({'text':_0x5e59fe['botID']==_0x2e9a6e(0x1e6)?_0x2e9a6e(0x24b):_0x2e9a6e(0x201)+_0x5e59fe[_0x2e9a6e(0x1df)],'callback_data':_0x5e59fe[_0x2e9a6e(0x1df)]}),_0x48f385%_0x2bca28==0x0&&(_0x97f940[_0x382882]=_0x513333,_0x382882++);}),tgBot['sendMessage'](_0x2ceb1b[_0x114457(0x1c6)]['id'],_0x114457(0x2fa),{'reply_markup':{'inline_keyboard':_0x97f940}})[_0x114457(0x2b0)](_0x3f4f0e=>{telegramError(_0x3f4f0e);}),tgBot['on'](_0x114457(0x2e1),async _0x1752e3=>{const _0x53016c=_0x114457,_0x2a1477=_0x1752e3[_0x53016c(0x2f4)],_0x23db69=_0x1752e3[_0x53016c(0x1fb)];tgBot[_0x53016c(0x232)](_0x1752e3['id'])[_0x53016c(0x1d9)](async()=>{const _0x1e66f9=_0x53016c;if(_0x2a1477=='all'){if(settings['telegramEvents']==_0x1e66f9(0x27b))tgBot['sendMessage'](_0x23db69[_0x1e66f9(0x1c6)]['id'],_0x1e66f9(0x24a))['catch'](_0x4c90cb=>{telegramError(_0x4c90cb);});_0x505845[_0x1e66f9(0x1dd)](_0x4fce9f=>{const _0x3aa2b4=_0x1e66f9;if(_0x4fce9f[_0x3aa2b4(0x1df)]!='all')toggleBot(_0x4fce9f[_0x3aa2b4(0x1df)],toggleStatus(_0x4fce9f[_0x3aa2b4(0x1df)]),_0x3aa2b4(0x2fb));});}else{if(settings['telegramEvents']==_0x1e66f9(0x27b))tgBot[_0x1e66f9(0x1ee)](_0x23db69[_0x1e66f9(0x1c6)]['id'],_0x1e66f9(0x2da)+_0x2a1477)[_0x1e66f9(0x2b0)](_0x2e155d=>{telegramError(_0x2e155d);});toggleBot(_0x2a1477,toggleStatus(_0x2a1477),_0x1e66f9(0x2fb));}}),tgBot['removeListener'](_0x53016c(0x2e1));});}}),tgBot['onText'](/\/disable/,_0x56e5c6=>{const _0x525996=_0x3f68e2;if(!validateTelegram(_0x56e5c6))return;tgBot[_0x525996(0x1ee)](_0x56e5c6['chat']['id'],'Notifications\x20disabled')[_0x525996(0x2b0)](_0x541199=>{telegramError(_0x541199);}),updateSetting(_0x525996(0x272),![]);}),tgBot['onText'](/\/help/,_0x573bde=>{const _0x375b6a=_0x3f68e2;if(!validateTelegram(_0x573bde))return;tgBot[_0x375b6a(0x1ee)](_0x573bde[_0x375b6a(0x1c6)]['id'],_0x5ab614)[_0x375b6a(0x2b0)](_0x4afc20=>{telegramError(_0x4afc20);});}),tgBot['on']('polling_error',_0x557ba6=>{const _0x1cfc0b=_0x3f68e2;_0x557ba6['toString']()['includes'](_0x1cfc0b(0x2c9))&&(logging('Invalid\x20Telegram\x20token'),tgBot[_0x1cfc0b(0x2de)](),tgBot=null,io['to'](_0x1cfc0b(0x2f9))['emit'](_0x1cfc0b(0x220),'Invalid\x20Telegram\x20token'));}),process[_0x3f68e2(0x271)](_0x3f68e2(0x25a),()=>{const _0x479032=_0x3f68e2;if(tgBot)tgBot[_0x479032(0x2de)]();process[_0x479032(0x22f)](0x1);}),process[_0x3f68e2(0x271)](_0x3f68e2(0x203),()=>{const _0x3eac4e=_0x3f68e2;if(tgBot)tgBot[_0x3eac4e(0x2de)]();process[_0x3eac4e(0x22f)](0x1);});}}function disableTelegram(){const _0x5b4bb0=_0xd7bddd;tgBot&&(tgBot[_0x5b4bb0(0x2de)](),tgBot=null);}function sendTelegram(_0x271b2e,_0x74bbec){const _0x33440e=_0xd7bddd;if(settings[_0x33440e(0x272)]){if(settings['telegramEvents']=='all'||(_0x74bbec[_0x33440e(0x2ca)]==_0x33440e(0x1ff)||_0x74bbec['type']=='success')&&settings[_0x33440e(0x214)]==_0x33440e(0x2ad)||_0x74bbec[_0x33440e(0x2ca)]==_0x33440e(0x24f)&&settings['telegramEvents']==_0x33440e(0x27b)){if(tgBot&&settings[_0x33440e(0x2c5)]){if(_0x74bbec[_0x33440e(0x217)])tgBot[_0x33440e(0x1ee)](settings['telegramChatId'],_0x74bbec[_0x33440e(0x298)]+'\x20>\x20'+_0x74bbec['event'])[_0x33440e(0x2b0)](_0x5469bf=>{telegramError(_0x5469bf);});else tgBot[_0x33440e(0x1ee)](settings[_0x33440e(0x2c5)],'Bot\x20'+_0x271b2e+'\x20>\x20'+_0x74bbec[_0x33440e(0x2c3)])['catch'](_0x454268=>{telegramError(_0x454268);});}}}}function getDeviceWithIp(_0x2a15d1){return devices['find'](_0x9791b3=>_0x9791b3['ip']===_0x2a15d1);}function temporaryAccess2FA(_0x214cb7,_0x2830f4){const _0x44342c=_0xd7bddd;let _0x2796d6=new Date(),_0x29d648=![];if(lastIpApproval){if(_0x2796d6-lastIpApproval<0x1388)_0x29d648=!![];}lastIpApproval=new Date();if(_0x29d648)return;tgBot&&settings[_0x44342c(0x2c5)]&&(tgBot['removeListener']('callback_query'),tgBot['sendMessage'](settings['telegramChatId'],_0x44342c(0x270)+normalizeIP(_0x2830f4)[_0x44342c(0x2fd)]+_0x44342c(0x221),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x44342c(0x20b),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':'30\x20min','callback_data':'30'},{'text':_0x44342c(0x26c),'callback_data':_0x44342c(0x26c)}]]}})[_0x44342c(0x2b0)](_0x2ade12=>{telegramError(_0x2ade12);}),tgBot['on'](_0x44342c(0x2e1),async _0x2cb2bd=>{const _0xd515c0=_0x44342c,_0x279ac3=_0x2cb2bd[_0xd515c0(0x2f4)],_0x1df64c=_0x2cb2bd[_0xd515c0(0x1fb)];tgBot[_0xd515c0(0x232)](_0x2cb2bd['id'])[_0xd515c0(0x1d9)](async()=>{const _0x59e503=_0xd515c0;devices[_0x214cb7]['telegramIpApproval']={'clientip':_0x2830f4,'timestamp':new Date()[_0x59e503(0x2be)](),'expiry':_0x279ac3},_0x279ac3!=_0x59e503(0x26c)?(await tgBot['sendMessage'](_0x1df64c[_0x59e503(0x1c6)]['id'],_0x59e503(0x29b)+_0x279ac3+'\x20minutes',{'parse_mode':'HTML'})[_0x59e503(0x2b0)](_0x54e7a2=>{telegramError(_0x54e7a2);}),io['to'](_0x214cb7)[_0x59e503(0x200)](_0x59e503(0x2a7),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x59e503(0x1ee)](_0x1df64c['chat']['id'],'Temporary\x20access\x20rejected')[_0x59e503(0x2b0)](_0x5372be=>{telegramError(_0x5372be);}),io['to'](_0x214cb7)[_0x59e503(0x200)](_0x59e503(0x2a7),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0xd515c0(0x29c)](_0xd515c0(0x2e1));}));}function loginAccess2FA(_0x5766c8,_0xb69790){const _0x3e4053=_0xd7bddd;tgBot&&settings[_0x3e4053(0x2c5)]&&(tgBot[_0x3e4053(0x29c)](_0x3e4053(0x2e1)),tgBot['sendMessage'](settings[_0x3e4053(0x2c5)],_0x3e4053(0x1f4)+normalizeIP(_0xb69790)[_0x3e4053(0x2fd)]+_0x3e4053(0x221),{'parse_mode':_0x3e4053(0x2a4),'reply_markup':{'inline_keyboard':[[{'text':_0x3e4053(0x261),'callback_data':loginExpiry},{'text':_0x3e4053(0x26c),'callback_data':_0x3e4053(0x26c)}]]}})[_0x3e4053(0x2b0)](_0x1bf828=>{telegramError(_0x1bf828);}),tgBot['on'](_0x3e4053(0x2e1),async _0x55441f=>{const _0x58f2f6=_0x3e4053,_0x419308=_0x55441f[_0x58f2f6(0x2f4)],_0x996812=_0x55441f[_0x58f2f6(0x1fb)];tgBot['answerCallbackQuery'](_0x55441f['id'])[_0x58f2f6(0x1d9)](async()=>{const _0x4752ac=_0x58f2f6;devices[_0x5766c8][_0x4752ac(0x243)]={'clientip':_0xb69790,'timestamp':new Date()[_0x4752ac(0x2be)](),'expiry':_0x419308},_0x419308!=_0x4752ac(0x26c)?(await tgBot[_0x4752ac(0x1ee)](_0x996812[_0x4752ac(0x1c6)]['id'],_0x4752ac(0x2f3),{'parse_mode':_0x4752ac(0x2a4)})[_0x4752ac(0x2b0)](_0x21f26a=>{telegramError(_0x21f26a);}),io['to'](_0x5766c8)['emit'](_0x4752ac(0x2a7),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x4752ac(0x1ee)](_0x996812['chat']['id'],_0x4752ac(0x1c7))[_0x4752ac(0x2b0)](_0x162f07=>{telegramError(_0x162f07);}),io['to'](_0x5766c8)['emit'](_0x4752ac(0x2a7),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot['removeListener']('callback_query');}));}function getConfiguration(){const _0x11c965=_0xd7bddd;return dbConfig[_0x11c965(0x250)]('bots')['sortBy']('botID')[_0x11c965(0x290)]()||[];}function getEnabledBots(){const _0x19e3f0=_0xd7bddd;return dbConfig[_0x19e3f0(0x250)](_0x19e3f0(0x2f1))[_0x19e3f0(0x1da)](_0x19e3f0(0x1df))[_0x19e3f0(0x1e2)]({'status':_0x19e3f0(0x2bb)})['value']()||[];}function getDisabledBots(){const _0x41a676=_0xd7bddd;return dbConfig[_0x41a676(0x250)](_0x41a676(0x2f1))[_0x41a676(0x1da)](_0x41a676(0x1df))['filter']({'status':_0x41a676(0x238)})['value']()||[];}function getSettings(){const _0x202942=_0xd7bddd;return dbSettings[_0x202942(0x250)](_0x202942(0x21a))[_0x202942(0x290)]()||{'timeshift':0x0};}function getSecure(){const _0x907d31=_0xd7bddd;return dbSecure[_0x907d31(0x250)](_0x907d31(0x24c))[_0x907d31(0x290)]()||{};}function getBlacklist(){const _0x513bf6=_0xd7bddd;return dbSecure[_0x513bf6(0x250)](_0x513bf6(0x256))['value']()||[];}function broadcastToBots(_0x30a636,_0x58040e){const _0x1b3d9d=_0xd7bddd;config[_0x1b3d9d(0x1dd)](_0x235543=>{const _0x275ba4=_0x1b3d9d;if(_0x235543[_0x275ba4(0x2a7)]==_0x275ba4(0x2bb)&&_0x235543[_0x275ba4(0x2d8)]==_0x275ba4(0x206)){if(pid[_0x235543[_0x275ba4(0x1df)]])pid[_0x235543[_0x275ba4(0x1df)]][_0x275ba4(0x209)]({[_0x30a636]:_0x58040e});}});}function storeSettings(_0x9d3f92,_0x7ecd50=![]){const _0x584347=_0xd7bddd;_0x9d3f92={...settings,..._0x9d3f92};if(_0x7ecd50&&_0x9d3f92[_0x584347(0x275)]!=_0x584347(0x255)&&_0x9d3f92[_0x584347(0x275)]!=''){const _0x2e8d2f=crypt[_0x584347(0x234)](secure['privateKey'],_0x9d3f92[_0x584347(0x275)])[_0x584347(0x1fb)][_0x584347(0x1e9)]('@')[0x0],_0xcec030=bcrypt[_0x584347(0x1ef)](_0x2e8d2f,saltRounds);_0x9d3f92={..._0x9d3f92,'bbPassword':_0xcec030};}if(_0x7ecd50&&_0x9d3f92[_0x584347(0x1c5)]!='************'&&_0x9d3f92[_0x584347(0x1c5)]!=''){const _0x527381=crypt['decrypt'](secure['privateKey'],_0x9d3f92['telegramToken'])[_0x584347(0x1fb)][_0x584347(0x1e9)]('@')[0x0];_0x9d3f92={..._0x9d3f92,'telegramToken':_0x527381};}const _0x371540=_0x9d3f92['telegramToken']!=_0x584347(0x255)&&_0x9d3f92[_0x584347(0x1c5)]!=settings[_0x584347(0x1c5)]||_0x9d3f92[_0x584347(0x1c1)]!=settings['telegramUsername'],_0x2a2fd1=_0x9d3f92['telegramToken']==''||_0x9d3f92[_0x584347(0x1c1)]=='';if(_0x371540)_0x9d3f92['telegramEvents']=_0x584347(0x1e6);for(const [_0xc27042,_0x1bec28]of Object[_0x584347(0x1ed)](_0x9d3f92)){if(_0xc27042==_0x584347(0x1c5)&&_0x1bec28==_0x584347(0x255)){_0x9d3f92[_0x584347(0x1c5)]=settings[_0x584347(0x1c5)];continue;};if(_0xc27042=='bbPassword'&&_0x1bec28=='************'){_0x9d3f92[_0x584347(0x275)]=settings[_0x584347(0x275)];continue;};dbSettings[_0x584347(0x212)](_0x584347(0x28a)+_0xc27042,_0x1bec28)[_0x584347(0x239)]();}settings=_0x9d3f92,io['to'](_0x584347(0x2f9))['emit'](_0x584347(0x21a),cleanSettings()),broadcastToBots(_0x584347(0x2ea),settings[_0x584347(0x2ea)]);if(_0x371540&&!_0x2a2fd1)initTelegram();if(_0x371540&&_0x2a2fd1)disableTelegram();getAllClients()[_0x584347(0x1dd)](_0x2a1ac9=>{const _0x35d16e=_0x584347;getSocket(_0x2a1ac9['id'])[_0x35d16e(0x200)](_0x35d16e(0x2a7),{'access':{'allow':![],'reason':_0x35d16e(0x1d3),'token':null}});});}function updateSetting(_0x1e43f2,_0x217c32){const _0x187451=_0xd7bddd;dbSettings[_0x187451(0x212)](_0x187451(0x28a)+_0x1e43f2,_0x217c32)[_0x187451(0x239)](),settings=getSettings(),io['to'](_0x187451(0x2f9))[_0x187451(0x200)](_0x187451(0x21a),cleanSettings());}function storeSecure(_0x165e34){const _0x16cee9=_0xd7bddd;dbSecure['get'](_0x16cee9(0x24c))['push'](_0x165e34)[_0x16cee9(0x239)](),secure=_0x165e34;}function addBlacklist(_0x21e616){const _0x122c4e=_0xd7bddd;cleanBlacklist();let _0x43c609;devices[_0x21e616][_0x122c4e(0x2b2)]?_0x43c609=Math['max'](devices[_0x21e616][_0x122c4e(0x2b2)][_0x122c4e(0x2bd)],loginExpiry):_0x43c609=loginExpiry,dbSecure[_0x122c4e(0x250)]('blacklist')[_0x122c4e(0x2a1)]({'expiry':new Date()['getTime']()+_0x43c609*0x3c*0x3e8,'token':devices[_0x21e616][_0x122c4e(0x247)][_0x122c4e(0x2a9)]})[_0x122c4e(0x239)](),blacklist=dbSecure[_0x122c4e(0x250)]('blacklist')['value']();}function cleanBlacklist(){const _0x2298d0=_0xd7bddd;let _0xb1165a=dbSecure[_0x2298d0(0x250)](_0x2298d0(0x256))[_0x2298d0(0x1fc)]()[_0x2298d0(0x290)](),_0xe3a55=new Date()[_0x2298d0(0x2be)]();_0xb1165a[_0x2298d0(0x1dd)](_0xfca6b8=>{const _0x3f1cef=_0x2298d0;_0xfca6b8[_0x3f1cef(0x2bd)]<_0xe3a55&&dbSecure[_0x3f1cef(0x250)]('blacklist')['remove']({'expiry':_0xfca6b8[_0x3f1cef(0x2bd)]})['write']();});}function initStates(){let _0x354255=getConfiguration();_0x354255['forEach'](_0x6c468=>{const _0x5296bb=_0x28e5;_0x6c468['live']=_0x5296bb(0x2fb);}),storeConfiguration(_0x354255);}function onKeys(){const _0x300e74=new RSA();return new Promise(_0x48963f=>{const _0x40cf97=_0x28e5;_0x300e74['generateKeyPairAsync']()[_0x40cf97(0x1d9)](_0x5b6292=>{_0x48963f(_0x5b6292);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x147aab=_0xd7bddd;let _0x269387=getConfiguration(),_0x3d095d=![];_0x269387[_0x147aab(0x1dd)](_0x1db114=>{const _0x15ea4a=_0x147aab;if(_0x1db114[_0x15ea4a(0x2a7)]==_0x15ea4a(0x206))_0x1db114[_0x15ea4a(0x2a7)]='enabled',_0x3d095d=!![];else _0x1db114[_0x15ea4a(0x2a7)]==_0x15ea4a(0x2fb)&&(_0x1db114[_0x15ea4a(0x2a7)]=_0x15ea4a(0x238),_0x3d095d=!![]);});if(_0x3d095d)storeConfiguration(_0x269387);let _0x338064=getSecure();if(!_0x338064['hasOwnProperty'](_0x147aab(0x1fa))){let _0x30fd25=await generateKeys();_0x338064[_0x147aab(0x25d)]=_0x30fd25['publicKey'],_0x338064[_0x147aab(0x20c)]=_0x30fd25['privateKey'],_0x338064[_0x147aab(0x1fa)]=crypto['randomBytes'](0x20)['toString'](_0x147aab(0x2d3));;storeSecure(_0x338064);}let _0x3fa758=getSettings();_0x3d095d=![];!_0x3fa758['hasOwnProperty'](_0x147aab(0x1f0))&&(_0x3fa758[_0x147aab(0x1f0)]=![],_0x3fa758[_0x147aab(0x1f9)]='',_0x3fa758['bbPassword']='',_0x3fa758[_0x147aab(0x285)]=![],_0x3d095d=!![]);!_0x3fa758[_0x147aab(0x2f8)](_0x147aab(0x244))&&(_0x3fa758[_0x147aab(0x244)]=![],_0x3fa758[_0x147aab(0x1ea)]=[],_0x3fa758['temporaryAccessAllowed']=![],_0x3d095d=!![]);if(!_0x3fa758['hasOwnProperty'](_0x147aab(0x272))){if(_0x3fa758['telegramChatId'])_0x3fa758[_0x147aab(0x272)]=!![];else _0x3fa758[_0x147aab(0x272)]=![];_0x3d095d=!![];}if(_0x3d095d)storeSettings(_0x3fa758);}function storeConfiguration(_0x468842){const _0x842fe7=_0xd7bddd;dbConfig['get'](_0x842fe7(0x2f1))[_0x842fe7(0x279)]()[_0x842fe7(0x239)](),dbConfig[_0x842fe7(0x250)](_0x842fe7(0x2f1))['push'](..._0x468842)['write'](),config=_0x468842;}function resetPassword(){const _0x51e6eb=_0xd7bddd;tgBot&&settings[_0x51e6eb(0x2c5)]&&(tgBot[_0x51e6eb(0x29c)](_0x51e6eb(0x2e1)),tgBot[_0x51e6eb(0x1ee)](settings[_0x51e6eb(0x2c5)],_0x51e6eb(0x2d2),{'parse_mode':_0x51e6eb(0x2a4),'reply_markup':{'inline_keyboard':[[{'text':'yes','callback_data':_0x51e6eb(0x26f)},{'text':'no','callback_data':'no'}]]}})[_0x51e6eb(0x2b0)](_0x2ed789=>{telegramError(_0x2ed789);}),tgBot['on'](_0x51e6eb(0x2e1),async _0x18efd9=>{const _0x597bd7=_0x51e6eb,_0x4b2bc7=_0x18efd9['data'],_0x48a022=_0x18efd9['message'];tgBot[_0x597bd7(0x232)](_0x18efd9['id'])['then'](async()=>{const _0x483417=_0x597bd7;if(_0x4b2bc7!='no'){const _0x166ce3=0xf,_0x297d1c='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x34449f=Array[_0x483417(0x23e)](crypto[_0x483417(0x225)](new Uint32Array(_0x166ce3)))['map'](_0x31616c=>_0x297d1c[_0x31616c%_0x297d1c[_0x483417(0x2bf)]])[_0x483417(0x2e7)](''),_0x1ae3e8=bcrypt[_0x483417(0x1ef)](_0x34449f,saltRounds);storeSettings({'bbPassword':_0x1ae3e8}),await tgBot[_0x483417(0x1ee)](_0x48a022[_0x483417(0x1c6)]['id'],_0x483417(0x1fd)+_0x34449f,{'parse_mode':_0x483417(0x2a4)})[_0x483417(0x2b0)](_0x2728ed=>{telegramError(_0x2728ed);});}else await tgBot[_0x483417(0x1ee)](_0x48a022['chat']['id'],'Password\x20reset\x20rejected')['catch'](_0x3b28bb=>{telegramError(_0x3b28bb);});}),tgBot[_0x597bd7(0x29c)](_0x597bd7(0x2e1));}));}function logging(_0xe8a853){const _0x154292=_0xd7bddd;console[_0x154292(0x2b3)](getTimeStamp()+_0x154292(0x23d)+_0xe8a853);if(tgBot&&settings[_0x154292(0x2c5)]&&settings[_0x154292(0x214)]!=_0x154292(0x27b))tgBot[_0x154292(0x1ee)](settings[_0x154292(0x2c5)],_0x154292(0x2f0)+_0xe8a853)[_0x154292(0x2b0)](_0x609a67=>{telegramError(_0x609a67);});}function getServerTime(){const _0x22ed56=_0xd7bddd,_0x59173c=new Date();return _0x59173c[_0x22ed56(0x27e)]()+'/'+(_0x59173c[_0x22ed56(0x27a)]()+0x1)[_0x22ed56(0x258)]()[_0x22ed56(0x2cd)](0x2,'0')+'/'+_0x59173c[_0x22ed56(0x1e3)]()['toString']()[_0x22ed56(0x2cd)](0x2,'0')+'\x20'+_0x59173c[_0x22ed56(0x2b7)]()[_0x22ed56(0x258)]()[_0x22ed56(0x2cd)](0x2,'0')+':'+_0x59173c[_0x22ed56(0x288)]()[_0x22ed56(0x258)]()[_0x22ed56(0x2cd)](0x2,'0')+':'+_0x59173c[_0x22ed56(0x26b)]()['toString']()['padStart'](0x2,'0');}function getTimeStamp(){const _0x44715a=_0xd7bddd,_0x498c6a=shiftedTime();return _0x498c6a['getFullYear']()+'/'+(_0x498c6a[_0x44715a(0x27a)]()+0x1)['toString']()[_0x44715a(0x2cd)](0x2,'0')+'/'+_0x498c6a[_0x44715a(0x1e3)]()[_0x44715a(0x258)]()[_0x44715a(0x2cd)](0x2,'0')+'\x20'+_0x498c6a[_0x44715a(0x2b7)]()[_0x44715a(0x258)]()[_0x44715a(0x2cd)](0x2,'0')+':'+_0x498c6a[_0x44715a(0x288)]()[_0x44715a(0x258)]()[_0x44715a(0x2cd)](0x2,'0')+':'+_0x498c6a['getSeconds']()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0x17f47e=_0xd7bddd,_0xcde5b3=new Date();let _0x16f0a1=_0xcde5b3;if(settings[_0x17f47e(0x2ea)]&&settings[_0x17f47e(0x2ea)]!==0x0)_0x16f0a1=fns[_0x17f47e(0x253)](_0xcde5b3,{'hours':settings['timeshift']});return _0x16f0a1;}function startScheduler(){let _0x11455b=new Date()['getUTCHours']();_0x11455b==0x1&&backupConfigFiles();_0x11455b==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x4186de=_0xd7bddd;fs[_0x4186de(0x236)](configpath,{'withFileTypes':!![]})[_0x4186de(0x1dd)](_0x327624=>{const _0xf5c589=_0x4186de;if(!_0x327624[_0xf5c589(0x24d)]())fs[_0xf5c589(0x224)](configpath+_0x327624[_0xf5c589(0x27d)],configbackuppath+_0x327624['name']);});}function triggerAnalytics(){const _0x323e71=_0xd7bddd;analytics[_0x323e71(0x293)]({'title':'Balance\x20Bot\x20Server','href':_0x323e71(0x2c2),'path':'/v'+serverversion});}function validateCredentials(_0x591349,_0x4694da){const _0x29edfe=_0xd7bddd;if(_0x591349[_0x29edfe(0x24e)]==settings['bbUsername']&&bcrypt[_0x29edfe(0x28f)](_0x591349[_0x29edfe(0x299)],settings[_0x29edfe(0x275)])){if(settings[_0x29edfe(0x285)])return{'allow':![],'reason':_0x29edfe(0x231),'token':null};else{const _0x4672b7=generateLoginToken(_0x4694da);return{'allow':!![],'reason':_0x29edfe(0x2ac),'token':_0x4672b7};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function _0x28e5(_0x532058,_0x55058d){const _0x1e4986=_0x4969();return _0x28e5=function(_0x53b995,_0x3f9600){_0x53b995=_0x53b995-0x1c0;let _0x49696d=_0x1e4986[_0x53b995];return _0x49696d;},_0x28e5(_0x532058,_0x55058d);}function refreshToken(_0x5e1bb9){const _0x212fb8=_0xd7bddd,_0x33b79a=generateLoginToken(_0x5e1bb9);return{'allow':!![],'reason':_0x212fb8(0x2ac),'token':_0x33b79a};}function validateAccess(_0x2380b3,_0x574db0){const _0x182071=_0xd7bddd;let _0x442565=devices[_0x574db0]['ip'],_0x265d75;const _0x4d736a=_0x296db1=>{const _0x1b72f5=_0x28e5;if(settings[_0x1b72f5(0x1f0)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x574db0)){const _0x26674e=generateLoginToken(_0x574db0);return{'allow':!![],'reason':_0x1b72f5(0x229),'token':_0x26674e};}else return{'allow':![],'reason':_0x1b72f5(0x257),'token':null};}else return _0x265d75=validToken(_0x296db1,_0x574db0),_0x265d75[_0x1b72f5(0x2f8)](_0x1b72f5(0x254))?{'allow':!![],'reason':_0x1b72f5(0x219),'token':_0x296db1}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x1b72f5(0x268),'token':null};};if(settings['whitelistEnabled']){let _0x4aab91=[...settings[_0x182071(0x1ea)],_0x182071(0x2dd),_0x182071(0x25e),_0x182071(0x273)];if(_0x4aab91[_0x182071(0x1c4)](_0x442565))return _0x4d736a(_0x2380b3);else{_0x265d75=validToken(_0x2380b3,_0x574db0);if(_0x265d75[_0x182071(0x2f8)](_0x182071(0x254)))return _0x4d736a(_0x2380b3);else{if(telegramIpApproved(_0x574db0)){const _0x44d5bb=generateToken(_0x574db0);return _0x265d75=_0x4d736a(_0x2380b3),_0x265d75[_0x182071(0x1cb)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x44d5bb}:_0x265d75;}else return settings[_0x182071(0x294)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x182071(0x2ee),'token':null};}}}else return _0x4d736a(_0x2380b3);}function timelyDecrypt(_0xf99f2e,_0x453abe=!![]){const _0xc6491f=_0xd7bddd;if(_0xf99f2e)try{const _0x274942=crypt[_0xc6491f(0x234)](secure[_0xc6491f(0x20c)],_0xf99f2e)[_0xc6491f(0x1fb)],_0x559f55=_0x274942[_0xc6491f(0x1e9)]('@')[0x0],_0x1035bb=_0x274942[_0xc6491f(0x1e9)]('@')[0x1],_0x39da5a=new Date()[_0xc6491f(0x2be)]();if(_0x453abe){if(_0x39da5a-_0x1035bb<maxSecretAge*0x3e8)return _0x559f55;else return![];}else return _0x559f55;}catch(_0x625af8){return![];}else return![];}const validToken=(_0x4ceb67,_0x47064c)=>{const _0x2d2d17=_0xd7bddd,_0x3d2540=devices[_0x47064c]['ip'];if(!_0x4ceb67)return{'error':'No\x20authentication\x20token'};for(let _0x5c9cac of blacklist){if(_0x5c9cac[_0x2d2d17(0x2a9)]==_0x4ceb67)return{'error':_0x2d2d17(0x216)};}let _0x3f5a47;try{_0x3f5a47=jwt[_0x2d2d17(0x2b9)](_0x4ceb67,secure[_0x2d2d17(0x1fa)]+_0x47064c);}catch{return{'error':_0x2d2d17(0x281)};}if(!_0x3f5a47[_0x2d2d17(0x2f8)]('clientip')&&!_0x3f5a47[_0x2d2d17(0x2f8)]('username')||!_0x3f5a47['hasOwnProperty'](_0x2d2d17(0x274)))return{'error':_0x2d2d17(0x1ca)};if(!_0x3f5a47[_0x2d2d17(0x2f8)](_0x2d2d17(0x24e))&&_0x3f5a47[_0x2d2d17(0x2f8)](_0x2d2d17(0x2f5))){const {clientip:_0x180824}=_0x3f5a47;return _0x3d2540==_0x180824?{'success':_0x2d2d17(0x1e8)}:{'error':_0x2d2d17(0x277)};}else{if(_0x3f5a47['hasOwnProperty']('username')&&_0x3f5a47[_0x2d2d17(0x2f8)](_0x2d2d17(0x2f5))){const {username:_0x25fd60,clientip:_0x4509fa}=_0x3f5a47;return settings[_0x2d2d17(0x1f9)]==_0x25fd60&&_0x3d2540==_0x4509fa?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x2d2d17(0x248)};}}},generateLoginToken=_0x5c1689=>{const _0x14ee00=_0xd7bddd;if(_0x5c1689){const _0x9dcb8f=devices[_0x5c1689]['ip'];return jwt[_0x14ee00(0x1d2)]({'username':settings[_0x14ee00(0x1f9)],'clientip':_0x9dcb8f},secure[_0x14ee00(0x1fa)]+_0x5c1689,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x2d38cd=>{const _0x15a46f=_0xd7bddd;if(_0x2d38cd){const _0x392587=devices[_0x2d38cd]['ip'];return jwt['sign']({'clientip':_0x392587},secure[_0x15a46f(0x1fa)]+_0x2d38cd,{'expiresIn':devices[_0x2d38cd][_0x15a46f(0x2b2)]['expiry']*0x3c});}else return![];},telegramIpApproved=_0x380bdb=>{const _0x1d7e72=_0xd7bddd;let _0x35e161=![];return devices[_0x380bdb]['telegramIpApproval']&&devices[_0x380bdb][_0x1d7e72(0x2b2)][_0x1d7e72(0x2bd)]!=_0x1d7e72(0x26c)&&(_0x35e161=devices[_0x380bdb][_0x1d7e72(0x2b2)][_0x1d7e72(0x2f5)]==devices[_0x380bdb]['ip']&&new Date()[_0x1d7e72(0x2be)]()-devices[_0x380bdb][_0x1d7e72(0x2b2)][_0x1d7e72(0x280)]<devices[_0x380bdb][_0x1d7e72(0x2b2)][_0x1d7e72(0x2bd)]*0x3c*0x3e8),_0x35e161;},telegram2FaApproved=_0x320ce1=>{const _0x228fb9=_0xd7bddd;let _0x3a5f12=![];return devices[_0x320ce1][_0x228fb9(0x243)]&&devices[_0x320ce1][_0x228fb9(0x243)][_0x228fb9(0x2bd)]!='reject'&&(_0x3a5f12=devices[_0x320ce1]['telegram2FaApproval'][_0x228fb9(0x2f5)]==devices[_0x320ce1]['ip']&&new Date()[_0x228fb9(0x2be)]()-devices[_0x320ce1][_0x228fb9(0x243)]['timestamp']<devices[_0x320ce1][_0x228fb9(0x243)][_0x228fb9(0x2bd)]*0x3c*0x3e8),_0x3a5f12;},normalizeIP=_0x53c820=>{const _0x570d7d=_0xd7bddd;let _0x2a301a=null,_0x12407c=null;if(ipaddr['isValid'](_0x53c820)){const _0x45e149=ipaddr[_0x570d7d(0x20e)](_0x53c820);_0x45e149['kind']()===_0x570d7d(0x2a5)?(_0x45e149[_0x570d7d(0x2e6)]()&&(_0x2a301a=_0x45e149[_0x570d7d(0x2a3)]()[_0x570d7d(0x258)]()),_0x12407c=_0x45e149[_0x570d7d(0x258)]()):(_0x2a301a=_0x45e149[_0x570d7d(0x258)](),_0x12407c=_0x45e149[_0x570d7d(0x211)]()[_0x570d7d(0x258)]());}return{'show':_0x2a301a?_0x2a301a:_0x12407c,'store':_0x12407c};};