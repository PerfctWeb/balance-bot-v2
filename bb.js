const _0x4440f1=_0x213f;function _0x5a0f(){const _0x4f893d=['\x20minutes','bot.js','stopPolling','All','reason','bot','crypto','place-order','apiKey','botname','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','clientip','keys','Unauthorized\x20attempt\x20to\x20update\x20settings','5360277hnLIIi','telegramToken','function','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','isIPv4MappedAddress','config/','update-bot','encryptedUuid','telegramIpApproval','search','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','enabled','privateKey','allow','decrypt','Notifications\x20enabled','bot-','placeOrder',',\x20must\x20be\x20a\x204\x20digit\x20number','once','exp','bb-config.json','alerts','28XpfzQv','sendFile','catch','event','2FA','294nrmEXQ','************','telegramChatId','Orders','sha256','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','restart','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','sign','max','blacklist','getMonth','login\x20required','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','jsonwebtoken','-performance.json','ipaddr.js','split','mkdirSync','user','telegram2FaApproval','\x20/\x20','6112932pvVCbO','referer','password','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','-----------------------------------------------------------------------------------','telegramEnabled','status','readdirSync','temporary\x20access\x20timeout','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','getSeconds','static','hex','log','telegram','-events.json','reset-password','removeListener','telegramEvents','70628RJtmLy','Bot\x20Mgr\x20>\x20','Ok,\x20will\x20send\x20alert\x20notifications\x20only','get-portfolio','parse','yes','length','use','All\x20bots','2FA\x20required','then','storeHeadless','5\x20min','getHours','add-bot','delete-bot','index.html','78LheJUw','/:bot/performance','env','entries','from','Ok,\x20will\x20send\x20order\x20notifications\x20only','Invalid\x20username\x20or\x20IP\x20address','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','/:bot','remoteAddress','(((.+)+)+)+$','name','token','set','404\x20Not\x20Found','<b>Telegram\x20bot\x20status:</b>\x0a','backup/','\x20only\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','idling\x20bot\x20\x20\x20|\x20Bot\x20','exit','15\x20min','login','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','pidExpireLogin','/:bot/coins','/:bot/support','lowdb/adapters/FileSync','padStart','getStartingBalances','bb/','HTML','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','-results.json','reject','starting\x20new\x20bot\x20|\x20Bot\x20','cancelLoading','answerCallbackQuery','/:bot/portfolio','Temporary\x20access\x20rejected','settings.','Alerts','/status\x20-\x20show\x20bot(s)\x20status\x0a','@analytics/google-analytics','\x20|\x20','store-headless','bcryptjs','path',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','Unauthorized\x20login\x20attempt\x20(public\x20key)','bbPassword','send','temporaryAccessAllowed','Allow\x20login\x20from\x20IP\x20address\x20<b>','createServer','ipv6','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','host','started','express','https://hodlerhacks.com','Unauthorized\x20login\x20attempt\x20(timeout)','chat','getPortfolio','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','bbUsername','new','botmanager','lowdb','error','storeConfiguration','success','\x20>\x20','connected','Unauthorized\x20attempt\x20to\x20delete\x20bot','loginRequired','Unauthorized\x20attempt\x20to\x20get\x20logs','/off\x20-\x20stop\x20bot(s)\x0a','defaults','/help\x20-\x20show\x20available\x20commands\x0a','getUTCHours','store','slice','child_process','Invalid\x20authentication\x20token\x20(1)','getTime','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','SIGTERM','version','Notifications\x20disabled','test','Token\x20blacklisted','timeshift','new-disabled','Notifications\x20types:\x20','login\x20not\x20required','filter','Error:\x20Invalid\x20argument\x20','RSA-OAEP','settings','access\x20timeout','1000','uuid','secret','username','111DBccyp','Unauthorized\x20attempt\x20to\x20update\x20bot','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Crypt','includes','/:bot/configuration','socket.io','version.json','-config.json','copyFileSync','Invalid\x20Telegram\x20token','isValid','join','All\x20bots\x20running\x20right\x20now','whitelist','::ffff:127.0.0.1','initclient','::1','show','constructor','getMinutes','hybrid-crypto-js','sortBy','restarting\x20Bot\x20','build2','Unauthorized\x20attempt\x20to\x20log\x20out','logout','orders','yargs/yargs','Unauthorized\x20attempt\x20to\x20add\x20bot','91197dbDnzx','timestamp','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','publicKey','temporary\x20access\x20not\x20allowed','login\x20token\x20generated','push','secure','reload','value','Notifications\x20disabled\x0a','botID','callback_query','No\x20bots\x20running\x20right\x20now','Bot\x20','disabled','inherit','stopped','<b>Balance\x20Bot\x20status:</b>\x0a','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','forEach','write','ipc','handshake','/restart\x20-\x20restart\x20bot(s)\x0a','get-logs','sockets','kill','verify','300GCgklQ','find','emit','login\x20token\x20valid','generateKeyPairAsync','Notifications\x20enabled\x0a','build','/enable\x20-\x20enable\x20notifications\x0a','disconnect','disabled\x20Bot\x20','access','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','toString','unlinkSync','args','hashSync','11PuOcIg','Password\x20has\x20been\x20reset\x20to:\x20','data','69155lXPkDg','randomFillSync','match','getFullYear','stop','30\x20min','get','User\x20has\x20been\x20validated','</b>\x20?','whitelistEnabled','Access\x20enabled\x20for\x20','clients','onText','existsSync','invalid\x20credentials','You\x20can\x20use\x20the\x20following\x20commands:\x0a','temporary\x20token\x20generated','argv','1043000vZKRDx','showname','remove','sendMessage','bb-settings.json','page','bots','assign','fork','expiry','No\x20authentication\x20token','logged\x20out','3000','type','deleted\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20portfolio','/disable\x20-\x20disable\x20notifications\x0a','add','telegramUsername','pidRefreshToken','live','compareSync','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','auth','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','getDate','message','hasOwnProperty','f2aRequired','randomBytes',':\x20Bot\x20Mgr\x20>\x20','14713GQjqZy','all','2FA\x20login\x20required','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','http','default'];_0x5a0f=function(){return _0x4f893d;};return _0x5a0f();}(function(_0x11039f,_0x5672b1){const _0x38783c=_0x213f,_0x485cd6=_0x11039f();while(!![]){try{const _0x3be38a=parseInt(_0x38783c(0x2e0))/0x1*(parseInt(_0x38783c(0x1f7))/0x2)+parseInt(_0x38783c(0x261))/0x3*(-parseInt(_0x38783c(0x339))/0x4)+-parseInt(_0x38783c(0x2af))/0x5*(parseInt(_0x38783c(0x310))/0x6)+parseInt(_0x38783c(0x30b))/0x7*(parseInt(_0x38783c(0x2c1))/0x8)+-parseInt(_0x38783c(0x27f))/0x9*(parseInt(_0x38783c(0x29c))/0xa)+parseInt(_0x38783c(0x2ac))/0xb*(parseInt(_0x38783c(0x326))/0xc)+parseInt(_0x38783c(0x2f4))/0xd;if(_0x3be38a===_0x5672b1)break;else _0x485cd6['push'](_0x485cd6['shift']());}catch(_0x200760){_0x485cd6['push'](_0x485cd6['shift']());}}}(_0x5a0f,0x5d44d));const _0x32c684=function(){let _0x544202=!![];return function(_0x75a4e8,_0xdb5215){const _0x2585d5=_0x544202?function(){if(_0xdb5215){const _0xabb33d=_0xdb5215['apply'](_0x75a4e8,arguments);return _0xdb5215=null,_0xabb33d;}}:function(){};return _0x544202=![],_0x2585d5;};}(),_0x4651e6=_0x32c684(this,function(){const _0x5ede77=_0x213f;return _0x4651e6[_0x5ede77(0x2a8)]()[_0x5ede77(0x2fd)]('(((.+)+)+)+$')['toString']()[_0x5ede77(0x274)](_0x4651e6)['search'](_0x5ede77(0x201));});_0x4651e6();'use strict';process[_0x4440f1(0x1f9)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x4440f1(0x24b)),FileSync=require(_0x4440f1(0x212)),fs=require('fs'),fns=require('date-fns'),low=require(_0x4440f1(0x23c)),path=require(_0x4440f1(0x226)),crypto=require(_0x4440f1(0x2ec)),Crypt=require(_0x4440f1(0x276))[_0x4440f1(0x264)],RSA=require(_0x4440f1(0x276))['RSA'],bcrypt=require(_0x4440f1(0x225)),jwt=require(_0x4440f1(0x31e)),analyticsLib=require('analytics')['default'],googleAnalytics=require(_0x4440f1(0x222))[_0x4440f1(0x2e5)],ipaddr=require(_0x4440f1(0x320)),argv=require(_0x4440f1(0x27d))(process[_0x4440f1(0x2c0)][_0x4440f1(0x24a)](0x2))[_0x4440f1(0x2c0)],PORT=argv['port']||_0x4440f1(0x2cd),pattern=/^[0-9]{2,4}$/;if(!pattern[_0x4440f1(0x252)](PORT))return console[_0x4440f1(0x333)](_0x4440f1(0x259)+PORT+_0x4440f1(0x306)),process['exit'](0x1);const HOST=argv[_0x4440f1(0x231)]||null,userID=argv[_0x4440f1(0x323)]||'';let bbpath=_0x4440f1(0x215);const botfile=_0x4440f1(0x2e7),configfile=_0x4440f1(0x309),settingsfile=_0x4440f1(0x2c5),securefile='bb-secure.json';!fs[_0x4440f1(0x2bc)](bbpath+botfile)&&(bbpath='');const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath+_0x4440f1(0x2ba)),configpath=userID?bbpath+_0x4440f1(0x2f9)+userID+'/':bbpath+_0x4440f1(0x2f9),configbackuppath=configpath+_0x4440f1(0x207);!fs['existsSync'](configpath)&&fs[_0x4440f1(0x322)](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x4440f1(0x246)]({'settings':{'timeshift':0x0}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4440f1(0x246)]({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x4440f1(0x314),'rsaStandard':_0x4440f1(0x25a)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[];const serverversion=require('./'+bbpath+_0x4440f1(0x268))[_0x4440f1(0x250)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let devices=[],lastIpApproval,pidScheduler;oneTimeMigration(),cleanBlacklist();const express=require(_0x4440f1(0x233)),app=express(),http=require(_0x4440f1(0x2e4))[_0x4440f1(0x22d)](app);app[_0x4440f1(0x1ed)](express[_0x4440f1(0x331)](path['join'](__dirname,bbpath,_0x4440f1(0x279)))),app[_0x4440f1(0x1ed)](express[_0x4440f1(0x331)](path['join'](__dirname,bbpath,'build'))),app[_0x4440f1(0x2b5)]('/',function(_0x393049,_0x2f2e33){const _0x249c50=_0x4440f1;_0x2f2e33[_0x249c50(0x30c)](path[_0x249c50(0x26d)](__dirname,bbpath,_0x249c50(0x279),_0x249c50(0x1f6)));}),app[_0x4440f1(0x2b5)](_0x4440f1(0x1ff),function(_0x3086a8,_0xbad6e){const _0x2114da=_0x4440f1;_0xbad6e[_0x2114da(0x30c)](path['join'](__dirname,bbpath,'build',_0x2114da(0x1f6)));}),app[_0x4440f1(0x2b5)](_0x4440f1(0x21d),(_0x5dad78,_0x57fce4)=>{const _0x4a6ef0=_0x4440f1;_0x57fce4[_0x4a6ef0(0x30c)](path['join'](__dirname,bbpath,_0x4a6ef0(0x2a2),'index.html'));}),app[_0x4440f1(0x2b5)](_0x4440f1(0x1f8),(_0x3caaf0,_0x21d17f)=>{const _0x45f229=_0x4440f1;_0x21d17f[_0x45f229(0x30c)](path['join'](__dirname,bbpath,_0x45f229(0x2a2),_0x45f229(0x1f6)));}),app[_0x4440f1(0x2b5)](_0x4440f1(0x210),(_0x40ac52,_0x42412b)=>{const _0x52c892=_0x4440f1;_0x42412b[_0x52c892(0x30c)](path[_0x52c892(0x26d)](__dirname,bbpath,_0x52c892(0x2a2),_0x52c892(0x1f6)));}),app['get']('/:bot/history',(_0x1f817b,_0x4f1dac)=>{const _0x5a020b=_0x4440f1;_0x4f1dac[_0x5a020b(0x30c)](path[_0x5a020b(0x26d)](__dirname,bbpath,'build','index.html'));}),app[_0x4440f1(0x2b5)](_0x4440f1(0x266),(_0x1c4568,_0x1e2f96)=>{const _0x1dc37b=_0x4440f1;_0x1e2f96['sendFile'](path[_0x1dc37b(0x26d)](__dirname,bbpath,'build','index.html'));}),app[_0x4440f1(0x2b5)](_0x4440f1(0x211),(_0x3c8a94,_0x421fe4)=>{const _0x2f1202=_0x4440f1;_0x421fe4[_0x2f1202(0x30c)](path[_0x2f1202(0x26d)](__dirname,bbpath,_0x2f1202(0x2a2),_0x2f1202(0x1f6)));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require(_0x4440f1(0x267))(http,{}),analytics=analyticsLib({'app':'Balance\x20Bot','plugins':[googleAnalytics({'trackingId':'UA-192771731-1'})]}),TelegramBot=require('node-telegram-bot-api');let tgBot;if(settings[_0x4440f1(0x2f5)]&&settings[_0x4440f1(0x2f5)]!=''&&settings[_0x4440f1(0x2d3)]&&settings[_0x4440f1(0x2d3)]!='')initTelegram();initStates(),startServer(),startSocket(),startScheduler();function startServer(){const _0x38ab06=_0x4440f1;console[_0x38ab06(0x333)](''),console[_0x38ab06(0x333)](_0x38ab06(0x32a)),logging(_0x38ab06(0x317)+PORT),console[_0x38ab06(0x333)](_0x38ab06(0x32a));if(config[_0x38ab06(0x1ec)]!=0x0)config['forEach'](_0x46de06=>{const _0x15f91f=_0x38ab06;if(_0x46de06[_0x15f91f(0x32c)]==_0x15f91f(0x2ff)||_0x46de06[_0x15f91f(0x32c)]==_0x15f91f(0x23a))logging('starting\x20bot\x20|\x20Bot\x20'+_0x46de06['botID']+_0x15f91f(0x223)+_0x46de06[_0x15f91f(0x2ef)]),startBot([_0x46de06[_0x15f91f(0x28a)],userID],{'cwd':bbpath},function(_0x43e215){if(_0x43e215)logging(_0x43e215);});else(_0x46de06[_0x15f91f(0x32c)]=='disabled'||_0x46de06[_0x15f91f(0x32c)]=='new-disabled')&&logging(_0x15f91f(0x20a)+_0x46de06[_0x15f91f(0x28a)]+_0x15f91f(0x223)+_0x46de06[_0x15f91f(0x2ef)]);});else!newBot&&console[_0x38ab06(0x333)](_0x38ab06(0x2d7));if(newBot)addBot();console[_0x38ab06(0x333)](_0x38ab06(0x32a)),console['log']('');}function startSocket(){io['on']('connection',_0x43ec27=>{const _0x16f207=_0x213f;let _0x4c3dd8,_0x19075d,_0x5a0c26,_0x53c7a6,_0x1510ed;const _0x335b29=_0x43ec27[_0x16f207(0x296)]['headers'][_0x16f207(0x327)];_0x19075d=_0x335b29[_0x16f207(0x2b1)](/bot[0-9]{3}/);if(_0x19075d)_0x5a0c26=_0x19075d[0x0][_0x16f207(0x2b1)](/[0-9]{3}/);if(_0x5a0c26)_0x4c3dd8=_0x5a0c26[0x0];else _0x4c3dd8=_0x16f207(0x23b);const _0x36c1cd=_0x43ec27[_0x16f207(0x296)][_0x16f207(0x2d8)][_0x16f207(0x2fb)];if(!_0x36c1cd)_0x43ec27[_0x16f207(0x29e)]('status',{'publicKey':secure[_0x16f207(0x282)]});else{_0x53c7a6=timelyDecrypt(_0x36c1cd,![]);if(!_0x53c7a6)logging(_0x16f207(0x228));else{_0x1510ed=normalizeIP(_0x43ec27['conn'][_0x16f207(0x200)])[_0x16f207(0x249)];if(!devices[_0x53c7a6])devices[_0x53c7a6]={'uuid':_0x53c7a6,'access':{'token':null}};devices[_0x53c7a6]['ip']=_0x1510ed;const _0x42c199=addClient(_0x43ec27['id'],_0x53c7a6,_0x4c3dd8);setAccess(_0x42c199),_0x43ec27['on'](_0x16f207(0x20d),_0x2aecd3=>{const _0x4e13b2=_0x16f207,_0x53eba7=timelyDecrypt(_0x2aecd3[_0x4e13b2(0x328)]);if(_0x53eba7){_0x2aecd3={'username':_0x2aecd3[_0x4e13b2(0x260)],'password':_0x53eba7},devices[_0x53c7a6][_0x4e13b2(0x2a6)]=validateCredentials(_0x2aecd3,_0x53c7a6);if(devices[_0x53c7a6]['access']['allow']==![]&&devices[_0x53c7a6][_0x4e13b2(0x2a6)][_0x4e13b2(0x2ea)]==_0x4e13b2(0x2e2))_0x43ec27['emit'](_0x4e13b2(0x32c),{'access':devices[_0x53c7a6][_0x4e13b2(0x2a6)]}),loginAccess2FA(_0x53c7a6,_0x1510ed);else{if(devices[_0x53c7a6]['access'][_0x4e13b2(0x301)]==![]&&devices[_0x53c7a6][_0x4e13b2(0x2a6)]['reason']==_0x4e13b2(0x2bd))_0x43ec27[_0x4e13b2(0x29e)](_0x4e13b2(0x32c),{'access':devices[_0x53c7a6][_0x4e13b2(0x2a6)]});else devices[_0x53c7a6]['access'][_0x4e13b2(0x301)]&&devices[_0x53c7a6][_0x4e13b2(0x2a6)][_0x4e13b2(0x2ea)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x53c7a6)[_0x4e13b2(0x293)](_0x5e2ceb=>{setAccess(_0x5e2ceb);}),setTokenRefresh(_0x53c7a6),setSessionTimeout(_0x4e13b2(0x20d),_0x53c7a6));}}else logging(_0x4e13b2(0x235));}),_0x43ec27['on'](_0x16f207(0x336),()=>{resetPassword();}),_0x43ec27['on']('disconnect',_0x3f23f6=>{removeClient(_0x43ec27['id']);});}}});}function initClient(_0x5955e4){const _0x59e394=_0x4440f1;if(_0x5955e4!=_0x59e394(0x23b)&&config[_0x59e394(0x2ee)]!=''){if(pid[_0x5955e4])pid[_0x5955e4][_0x59e394(0x22a)]({'function':_0x59e394(0x271),'args':null});}}function getSocket(_0xc655fa){const _0x5e737d=_0x4440f1;return io['sockets'][_0x5e737d(0x299)][_0x5e737d(0x2b5)](_0xc655fa);}function setAccess(_0x58f10d){const _0x2ce1f1=_0x4440f1,_0x50497=getSocket(_0x58f10d['id']),_0x4ba2d4=_0x58f10d[_0x2ce1f1(0x25e)],_0x5b24dc=_0x58f10d[_0x2ce1f1(0x2eb)];devices[_0x4ba2d4][_0x2ce1f1(0x2a6)]=validateAccess(devices[_0x4ba2d4][_0x2ce1f1(0x2a6)]['token'],_0x4ba2d4),_0x50497[_0x2ce1f1(0x26d)](_0x4ba2d4);if(devices[_0x4ba2d4][_0x2ce1f1(0x2a6)][_0x2ce1f1(0x301)]){_0x50497[_0x2ce1f1(0x26d)](_0x5b24dc);if(_0x5b24dc==_0x2ce1f1(0x23b))initializeSocketBotManager(_0x50497);else initializeSocketBot(_0x50497);initClient(_0x5b24dc);}devices[_0x4ba2d4][_0x2ce1f1(0x2a6)]['token']&&devices[_0x4ba2d4]['access'][_0x2ce1f1(0x2ea)]==_0x2ce1f1(0x2bf)&&setSessionTimeout(_0x2ce1f1(0x30f),_0x4ba2d4),devices[_0x4ba2d4][_0x2ce1f1(0x2a6)]['token']&&devices[_0x4ba2d4][_0x2ce1f1(0x2a6)][_0x2ce1f1(0x2ea)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x2ce1f1(0x20d),_0x4ba2d4),_0x50497['emit'](_0x2ce1f1(0x32c),{'status':_0x58f10d['server'],'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x4ba2d4][_0x2ce1f1(0x2a6)],'externalip':devices[_0x4ba2d4]['ip'],'publicKey':secure[_0x2ce1f1(0x282)]}),devices[_0x4ba2d4][_0x2ce1f1(0x2a6)][_0x2ce1f1(0x301)]==![]&&devices[_0x4ba2d4]['access'][_0x2ce1f1(0x2ea)]==_0x2ce1f1(0x1ef)&&temporaryAccess2FA(_0x4ba2d4,devices[_0x4ba2d4]['ip']);}function setSessionTimeout(_0x1df84c,_0x43b1a7){const _0x55411e=_0x4440f1;let _0x39a378;if(_0x1df84c==_0x55411e(0x20d))_0x39a378=loginExpiry*0x3c*0x3e8;else _0x39a378=devices[_0x43b1a7][_0x55411e(0x2fc)][_0x55411e(0x2ca)]*0x3c*0x3e8-(new Date()[_0x55411e(0x24d)]()-devices[_0x43b1a7][_0x55411e(0x2fc)]['timestamp']);if(devices[_0x43b1a7]['pidExpireLogin'])clearTimeout(devices[_0x43b1a7][_0x55411e(0x20f)]);devices[_0x43b1a7][_0x55411e(0x20f)]=setTimeout(()=>{const _0x2b5020=_0x55411e;if(devices[_0x43b1a7][_0x2b5020(0x2d4)])clearTimeout(devices[_0x43b1a7][_0x2b5020(0x2d4)]);removeSocketListeners(_0x43b1a7),addBlacklist(_0x43b1a7),devices[_0x43b1a7][_0x2b5020(0x2fc)]=null,devices[_0x43b1a7][_0x2b5020(0x324)]=null,devices[_0x43b1a7][_0x2b5020(0x2a6)][_0x2b5020(0x203)]=null,devices[_0x43b1a7][_0x2b5020(0x2a6)]=validateAccess(devices[_0x43b1a7]['access'][_0x2b5020(0x203)],_0x43b1a7),!(devices[_0x43b1a7]['access'][_0x2b5020(0x301)]&&devices[_0x43b1a7][_0x2b5020(0x2a6)][_0x2b5020(0x2ea)]=='login\x20not\x20required')&&(_0x1df84c=='login'?io['to'](_0x43b1a7)['emit'](_0x2b5020(0x32c),{'access':{'allow':![],'reason':_0x2b5020(0x25c),'token':null}}):io['to'](_0x43b1a7)['emit'](_0x2b5020(0x32c),{'access':{'allow':![],'reason':_0x2b5020(0x32e),'token':null}})),devices[_0x43b1a7]['access']['token']=null;},_0x39a378);}function setTokenRefresh(_0x3bcc3){const _0x143f5f=_0x4440f1;if(devices[_0x3bcc3][_0x143f5f(0x2d4)])clearTimeout(devices[_0x3bcc3][_0x143f5f(0x2d4)]);devices[_0x3bcc3][_0x143f5f(0x2d4)]=setTimeout(()=>{const _0x5cd3a3=_0x143f5f;getClientsWithUuid(_0x3bcc3)[_0x5cd3a3(0x1ec)]!=0x0?(devices[_0x3bcc3][_0x5cd3a3(0x2a6)]=refreshToken(_0x3bcc3),io['to'](_0x3bcc3)[_0x5cd3a3(0x29e)](_0x5cd3a3(0x32c),{'status':_0x5cd3a3(0x241),'serverversion':serverversion,'servertime':getServerTime(),'access':devices[_0x3bcc3][_0x5cd3a3(0x2a6)],'externalip':devices[_0x3bcc3]['ip'],'publicKey':secure['publicKey']}),setTokenRefresh(_0x3bcc3)):clearTimeout(devices[_0x3bcc3][_0x5cd3a3(0x2d4)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x12bb49){const _0x40ca8d=_0x4440f1,_0x5180b4=getClient(_0x12bb49['id'])['uuid'];_0x12bb49[_0x40ca8d(0x29e)](_0x40ca8d(0x2c7),config),_0x12bb49[_0x40ca8d(0x29e)](_0x40ca8d(0x25b),cleanSettings()),_0x12bb49['on'](_0x40ca8d(0x1f4),_0x57753b=>{const _0x49978a=_0x40ca8d;if(validateAccess(_0x57753b,_0x5180b4)[_0x49978a(0x301)])addBot();else logging(_0x49978a(0x27e));}),_0x12bb49['on'](_0x40ca8d(0x2fa),(_0x558ddf,_0x49e01f)=>{const _0x113738=_0x40ca8d;if(validateAccess(_0x49e01f,_0x5180b4)['allow'])toggleBot(_0x558ddf[_0x113738(0x28a)],_0x558ddf[_0x113738(0x32c)],_0x558ddf['live']);else logging(_0x113738(0x262));}),_0x12bb49['on'](_0x40ca8d(0x1f5),(_0x2cae74,_0x2676a2)=>{const _0x2b4313=_0x40ca8d;if(validateAccess(_0x2676a2,_0x5180b4)[_0x2b4313(0x301)])deleteBot(_0x2cae74);else logging(_0x2b4313(0x242));}),_0x12bb49['on']('store-settings',(_0x276d19,_0x452f40)=>{const _0x39da79=_0x40ca8d;if(validateAccess(_0x452f40,_0x5180b4)[_0x39da79(0x301)])storeSettings(_0x276d19,!![]);else logging(_0x39da79(0x2f3));}),_0x12bb49['on']('logout',_0xcea4bf=>{const _0x3d148c=_0x40ca8d;if(validateAccess(_0xcea4bf,_0x5180b4)[_0x3d148c(0x301)]){if(devices[_0x5180b4][_0x3d148c(0x2d4)])clearTimeout(devices[_0x5180b4][_0x3d148c(0x2d4)]);if(devices[_0x5180b4][_0x3d148c(0x20f)])clearTimeout(devices[_0x5180b4][_0x3d148c(0x20f)]);removeSocketListeners(getClient(_0x12bb49['id'])[_0x3d148c(0x25e)]),addBlacklist(_0x5180b4),devices[_0x5180b4][_0x3d148c(0x2fc)]=null,devices[_0x5180b4][_0x3d148c(0x324)]=null,devices[_0x5180b4][_0x3d148c(0x2a6)][_0x3d148c(0x203)]=null,io['to'](getClient(_0x12bb49['id'])[_0x3d148c(0x25e)])[_0x3d148c(0x29e)]('status',{'access':{'allow':![],'reason':_0x3d148c(0x2cc),'token':null}});}else logging(_0x3d148c(0x27a));});}function initializeSocketBot(_0x594772){const _0x13399d=_0x4440f1,_0x1dff75=getClient(_0x594772['id'])[_0x13399d(0x2eb)],_0x43f9fb=getClient(_0x594772['id'])[_0x13399d(0x25e)];_0x594772['on'](_0x13399d(0x298),(_0x527384,_0x14464f)=>{const _0x14cc4d=_0x13399d;if(validateAccess(_0x14464f,_0x43f9fb)[_0x14cc4d(0x301)]){if(pid[_0x1dff75])pid[_0x1dff75][_0x14cc4d(0x22a)]({'function':'emitHistory','args':_0x527384});}else logging(_0x14cc4d(0x244));}),_0x594772['on'](_0x13399d(0x1e9),(_0x41cd28,_0x566ba6)=>{const _0x5e8182=_0x13399d;if(validateAccess(_0x566ba6,_0x43f9fb)[_0x5e8182(0x301)]){if(pid[_0x1dff75])pid[_0x1dff75]['send']({'function':_0x5e8182(0x237),'args':_0x41cd28});}else logging(_0x5e8182(0x2d0));}),_0x594772['on']('store-configuration',(_0x370238,_0x7597a6)=>{const _0x52cd0f=_0x13399d;if(validateAccess(_0x7597a6,_0x43f9fb)[_0x52cd0f(0x301)]){if(pid[_0x1dff75])pid[_0x1dff75][_0x52cd0f(0x22a)]({'function':_0x52cd0f(0x23e),'args':_0x370238});}else logging('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x594772['on'](_0x13399d(0x224),(_0x290cec,_0x2e3a13)=>{const _0x3021d6=_0x13399d;if(validateAccess(_0x2e3a13,_0x43f9fb)[_0x3021d6(0x301)]){if(pid[_0x1dff75])pid[_0x1dff75][_0x3021d6(0x22a)]({'function':_0x3021d6(0x1f1),'args':_0x290cec});}else logging(_0x3021d6(0x230));}),_0x594772['on']('get-starting-balances',_0x2bf858=>{const _0x4b731=_0x13399d;if(validateAccess(_0x2bf858,_0x43f9fb)[_0x4b731(0x301)]){if(pid[_0x1dff75])pid[_0x1dff75][_0x4b731(0x22a)]({'function':_0x4b731(0x214),'args':null});}else logging(_0x4b731(0x2fe));}),_0x594772['on'](_0x13399d(0x2ed),(_0x3f637e,_0x3dd9d2)=>{const _0x226782=_0x13399d;if(validateAccess(_0x3dd9d2,_0x43f9fb)[_0x226782(0x301)]){if(pid[_0x1dff75])pid[_0x1dff75][_0x226782(0x22a)]({'function':_0x226782(0x305),'args':_0x3f637e});}else logging(_0x226782(0x32f));}),_0x594772['on']('cancel-loading',_0x12d733=>{const _0x41963a=_0x13399d;if(validateAccess(_0x12d733,_0x43f9fb)['allow']){if(pid[_0x1dff75])pid[_0x1dff75]['send']({'function':_0x41963a(0x21b),'args':null});}else logging('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x594772['on'](_0x13399d(0x27b),_0x5e70e1=>{const _0x111ce4=_0x13399d;if(validateAccess(_0x5e70e1,_0x43f9fb)[_0x111ce4(0x301)]){if(devices[_0x43f9fb][_0x111ce4(0x2d4)])clearTimeout(devices[_0x43f9fb][_0x111ce4(0x2d4)]);if(devices[_0x43f9fb][_0x111ce4(0x20f)])clearTimeout(devices[_0x43f9fb][_0x111ce4(0x20f)]);removeSocketListeners(getClient(_0x594772['id'])['uuid']),addBlacklist(_0x43f9fb),devices[_0x43f9fb][_0x111ce4(0x2fc)]=null,devices[_0x43f9fb][_0x111ce4(0x324)]=null,devices[_0x43f9fb][_0x111ce4(0x2a6)][_0x111ce4(0x203)]=null,io['to'](getClient(_0x594772['id'])['uuid'])[_0x111ce4(0x29e)](_0x111ce4(0x32c),{'access':{'allow':![],'reason':_0x111ce4(0x2cc),'token':null}});}else logging(_0x111ce4(0x27a));});}function removeSocketListeners(_0x46a057){const _0x4b4fd1=_0x4440f1;getClientsWithUuid(_0x46a057)[_0x4b4fd1(0x293)](_0x194979=>{getSocket(_0x194979['id'])['removeAllListeners']();});}function cleanSettings(){const _0x456776=_0x4440f1;let _0x48029d=settings;return settings[_0x456776(0x2f5)]&&settings[_0x456776(0x2f5)]!=''&&(_0x48029d={..._0x48029d,'telegramToken':'************'}),settings[_0x456776(0x229)]&&settings['bbPassword']!=''&&(_0x48029d={..._0x48029d,'bbPassword':'************'}),_0x48029d;}function startBot(_0x219726,_0x56885f,_0x3d2d82){const _0x4f74f9=_0x4440f1;let _0x59eafa=![];const _0x4d1d5d=_0x219726[0x0];_0x56885f={..._0x56885f,'stdio':[_0x4f74f9(0x28f),_0x4f74f9(0x28f),_0x4f74f9(0x28f),_0x4f74f9(0x295)]},pid[_0x4d1d5d]=childProcess[_0x4f74f9(0x2c9)](botfile,_0x219726,_0x56885f),pid[_0x4d1d5d]['on'](_0x4f74f9(0x2db),_0x31e738=>{const _0x5738c3=_0x4f74f9;switch(Object[_0x5738c3(0x2f2)](_0x31e738)[0x0]){case'botname':updateBotName(_0x4d1d5d,_0x31e738[_0x5738c3(0x2ef)]);break;case _0x5738c3(0x32c):updateStatus(_0x4d1d5d,_0x31e738[_0x5738c3(0x32c)]);break;case _0x5738c3(0x2d5):updateLive(_0x4d1d5d,_0x31e738[_0x5738c3(0x2d5)]);break;case _0x5738c3(0x232):updateLive(_0x4d1d5d,_0x31e738[_0x5738c3(0x232)]),io['to'](_0x4d1d5d)[_0x5738c3(0x29e)](_0x5738c3(0x32c),{'access':{'allow':![],'reason':_0x5738c3(0x287),'token':null}});break;case _0x5738c3(0x2b3):_0x31e738[_0x5738c3(0x2b3)]==_0x5738c3(0x316)&&stopBot(_0x4d1d5d);_0x31e738['stop']==_0x5738c3(0x29a)&&toggleBot(_0x4d1d5d,_0x5738c3(0x28e),_0x5738c3(0x290));break;case _0x5738c3(0x334):sendTelegram(_0x4d1d5d,_0x31e738[_0x5738c3(0x334)]);break;case _0x5738c3(0x2f6):io['to'](_0x4d1d5d)[_0x5738c3(0x29e)](_0x31e738['function'],_0x31e738[_0x5738c3(0x2aa)]);break;}}),pid[_0x4d1d5d]['on'](_0x4f74f9(0x23d),function(_0x14bbec){if(_0x59eafa)return;_0x59eafa=!![],_0x3d2d82(_0x14bbec);}),pid[_0x4d1d5d]['on'](_0x4f74f9(0x20b),function(_0x23afdf){const _0x546663=_0x4f74f9;if(_0x59eafa)return;_0x59eafa=!![],_0x3d2d82(null);const _0x1a6c1a=dbConfig[_0x546663(0x2b5)](_0x546663(0x2c7))[_0x546663(0x29d)]({'botID':_0x4d1d5d})[_0x546663(0x288)]();_0x1a6c1a&&(_0x1a6c1a[_0x546663(0x32c)]==_0x546663(0x2ff)||_0x1a6c1a['status']=='new')&&(updateLive(_0x4d1d5d,_0x546663(0x290)),logging(_0x546663(0x278)+_0x4d1d5d),startBot([_0x4d1d5d,userID],{'cwd':bbpath},function(_0x32594d){if(_0x32594d)logging(_0x32594d);}));});}function stopBot(_0xed4b6c){const _0x1a267d=_0x4440f1;getClientsWithBotID(_0xed4b6c)[_0x1a267d(0x293)](_0x3bcb53=>{const _0x409070=_0x1a267d;getSocket(_0x3bcb53['id'])[_0x409070(0x2a4)](!![]),removeClient(_0x3bcb53['id']);});if(pid[_0xed4b6c])pid[_0xed4b6c][_0x1a267d(0x29a)]();}function addBot(){const _0x45d4dd=_0x4440f1;let _0x16bd06;for(let _0x1d5198=0x1;_0x1d5198<0x3e9;_0x1d5198++){_0x16bd06=_0x1d5198[_0x45d4dd(0x2a8)]()[_0x45d4dd(0x213)](0x3,'0');let _0x2e55c9=config[_0x45d4dd(0x29d)](_0x385f0c=>_0x385f0c[_0x45d4dd(0x28a)]==_0x16bd06);if(!_0x2e55c9)break;}if(_0x16bd06===_0x45d4dd(0x25d)){logging(_0x45d4dd(0x2a7));return;}logging(_0x45d4dd(0x21a)+_0x16bd06),dbConfig[_0x45d4dd(0x2b5)]('bots')[_0x45d4dd(0x285)]({'botID':_0x16bd06,'botname':_0x45d4dd(0x28d)+_0x16bd06,'status':'new','live':''})[_0x45d4dd(0x294)](),startBot([_0x16bd06,userID],{'cwd':bbpath},function(_0x13cd9a){if(_0x13cd9a)logging(_0x13cd9a);}),config=getConfiguration(),io['to'](_0x45d4dd(0x23b))[_0x45d4dd(0x29e)](_0x45d4dd(0x2c7),config);}function deleteBot(_0x52ec39){const _0x47098b=_0x4440f1;getClientsWithBotID(_0x52ec39)[_0x47098b(0x293)](_0x2d88ce=>{const _0x29fa35=_0x47098b;getSocket(_0x2d88ce['id'])[_0x29fa35(0x2a4)](!![]),removeClient(_0x2d88ce['id']);}),dbConfig[_0x47098b(0x2b5)](_0x47098b(0x2c7))[_0x47098b(0x2c3)]({'botID':_0x52ec39})['write'](),logging(_0x47098b(0x2cf)+_0x52ec39),stopBot(_0x52ec39);try{fs['unlinkSync'](path['join'](configpath,'bot-'+_0x52ec39+_0x47098b(0x269))),fs[_0x47098b(0x2a9)](path['join'](configpath,_0x47098b(0x304)+_0x52ec39+_0x47098b(0x335))),fs['unlinkSync'](path[_0x47098b(0x26d)](configpath,_0x47098b(0x304)+_0x52ec39+_0x47098b(0x31f))),fs['unlinkSync'](path[_0x47098b(0x26d)](configpath,_0x47098b(0x304)+_0x52ec39+_0x47098b(0x218)));}catch(_0x51f9af){if(_0x51f9af)logging('error\x20while\x20deleting\x20config\x20files:\x20',_0x51f9af);}config=getConfiguration(),io['to'](_0x47098b(0x23b))[_0x47098b(0x29e)](_0x47098b(0x2c7),config);}function toggleBot(_0x4a515c,_0x239b22,_0x5706a8){const _0x5caf7c=_0x4440f1;dbConfig[_0x5caf7c(0x2b5)]('bots')[_0x5caf7c(0x29d)]({'botID':_0x4a515c})[_0x5caf7c(0x2c8)]({'status':_0x239b22})[_0x5caf7c(0x2c8)]({'live':_0x5706a8})[_0x5caf7c(0x294)]();if(_0x239b22=='enabled'||_0x239b22==_0x5caf7c(0x23a))logging('enabled\x20Bot\x20'+_0x4a515c),startBot([_0x4a515c,userID],{'cwd':bbpath},function(_0x3ba5d5){if(_0x3ba5d5)logging(_0x3ba5d5);});else(_0x239b22==_0x5caf7c(0x28e)||_0x239b22=='new-disabled')&&(logging(_0x5caf7c(0x2a5)+_0x4a515c),stopBot(_0x4a515c));config=getConfiguration(),io['to'](_0x5caf7c(0x23b))[_0x5caf7c(0x29e)](_0x5caf7c(0x2c7),config);}function toggleStatus(_0x421997){const _0x3fe6ee=_0x4440f1;let _0x1fb17b=dbConfig['get']('bots')[_0x3fe6ee(0x29d)]({'botID':_0x421997})['value'](),_0x112aae;if(_0x1fb17b[_0x3fe6ee(0x32c)]===_0x3fe6ee(0x2ff))_0x112aae=_0x3fe6ee(0x28e);else{if(_0x1fb17b['status']==='new')_0x112aae='new-disabled';else{if(_0x1fb17b[_0x3fe6ee(0x32c)]===_0x3fe6ee(0x255))_0x112aae=_0x3fe6ee(0x23a);else{if(_0x1fb17b['status']==='disabled')_0x112aae=_0x3fe6ee(0x2ff);}}}return _0x112aae;}function updateStatus(_0x61c2aa,_0x6d6592){const _0x4aa88e=_0x4440f1;dbConfig[_0x4aa88e(0x2b5)]('bots')[_0x4aa88e(0x29d)]({'botID':_0x61c2aa})[_0x4aa88e(0x2c8)]({'status':_0x6d6592})['write'](),config=getConfiguration(),io['to'](_0x4aa88e(0x23b))[_0x4aa88e(0x29e)]('bots',config);}function updateLive(_0x534557,_0x14e4a8){const _0x49ec70=_0x4440f1;dbConfig[_0x49ec70(0x2b5)](_0x49ec70(0x2c7))[_0x49ec70(0x29d)]({'botID':_0x534557})[_0x49ec70(0x2c8)]({'live':_0x14e4a8})[_0x49ec70(0x294)](),config=getConfiguration(),io['to'](_0x49ec70(0x23b))[_0x49ec70(0x29e)](_0x49ec70(0x2c7),config);}function updateBotName(_0x208df0,_0xb61696){const _0x5bec12=_0x4440f1;dbConfig[_0x5bec12(0x2b5)](_0x5bec12(0x2c7))['find']({'botID':_0x208df0})['assign']({'botname':_0xb61696})[_0x5bec12(0x294)](),config=getConfiguration(),io['to'](_0x5bec12(0x23b))[_0x5bec12(0x29e)](_0x5bec12(0x2c7),config);}function telegramError(_0x207c0d){const _0x3148f9=_0x4440f1;console[_0x3148f9(0x333)](getTimeStamp()+_0x3148f9(0x227));}function _0x213f(_0x4aed99,_0x16352d){const _0xae0bfd=_0x5a0f();return _0x213f=function(_0x4651e6,_0x32c684){_0x4651e6=_0x4651e6-0x1e7;let _0x5a0f0b=_0xae0bfd[_0x4651e6];return _0x5a0f0b;},_0x213f(_0x4aed99,_0x16352d);}function validateTelegram(_0x511412){const _0x3cb4a4=_0x4440f1;if(_0x511412[_0x3cb4a4(0x1fb)][_0x3cb4a4(0x260)]!=settings['telegramUsername']&&'@'+_0x511412[_0x3cb4a4(0x1fb)][_0x3cb4a4(0x260)]!=settings[_0x3cb4a4(0x2d3)])return tgBot['sendMessage'](_0x511412[_0x3cb4a4(0x236)]['id'],_0x3cb4a4(0x238),{'parse_mode':_0x3cb4a4(0x216)})['catch'](_0x2086c6=>{telegramError(_0x2086c6);}),![];return!![];}async function initTelegram(){const _0x4e2d9f=_0x4440f1;if(tgBot)tgBot['stopPolling'](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x4e2d9f(0x2f5)],{'polling':!![]});let _0x37082d=_0x4e2d9f(0x2be);_0x37082d+='\x0a',_0x37082d+=_0x4e2d9f(0x2a3),_0x37082d+=_0x4e2d9f(0x2d1),_0x37082d+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x37082d+=_0x4e2d9f(0x297),_0x37082d+='/on\x20-\x20start\x20bot(s)\x0a',_0x37082d+=_0x4e2d9f(0x245),_0x37082d+=_0x4e2d9f(0x221),_0x37082d+=_0x4e2d9f(0x247);let _0x3298fd=_0x4e2d9f(0x217);_0x3298fd+='\x0a',_0x3298fd+=_0x37082d,tgBot['onText'](/\/start/,_0x4ba7a6=>{const _0x490dbe=_0x4e2d9f;if(!validateTelegram(_0x4ba7a6))return;if(settings[_0x490dbe(0x312)]!=_0x4ba7a6[_0x490dbe(0x236)]['id'])updateSetting(_0x490dbe(0x312),_0x4ba7a6['chat']['id']);updateSetting(_0x490dbe(0x32b),!![]),tgBot[_0x490dbe(0x2c4)](_0x4ba7a6[_0x490dbe(0x236)]['id'],_0x3298fd)[_0x490dbe(0x30d)](_0xe75dcd=>{telegramError(_0xe75dcd);});}),tgBot[_0x4e2d9f(0x2bb)](/\/enable/,_0x22988b=>{const _0xee0bc7=_0x4e2d9f;if(!validateTelegram(_0x22988b))return;if(settings['telegramChatId']!=_0x22988b[_0xee0bc7(0x236)]['id'])updateSetting(_0xee0bc7(0x312),_0x22988b[_0xee0bc7(0x236)]['id']);updateSetting(_0xee0bc7(0x32b),!![]),tgBot['sendMessage'](_0x22988b['chat']['id'],_0xee0bc7(0x303))['catch'](_0x5adf18=>{telegramError(_0x5adf18);});}),tgBot[_0x4e2d9f(0x2bb)](/\/config/,async _0xc84289=>{const _0x46dbe8=_0x4e2d9f;if(!validateTelegram(_0xc84289))return;tgBot[_0x46dbe8(0x337)]('callback_query'),tgBot['sendMessage'](_0xc84289[_0x46dbe8(0x236)]['id'],_0x46dbe8(0x292),{'reply_markup':{'inline_keyboard':[[{'text':_0x46dbe8(0x313),'callback_data':_0x46dbe8(0x27c)},{'text':_0x46dbe8(0x220),'callback_data':'alerts'},{'text':_0x46dbe8(0x2e9),'callback_data':_0x46dbe8(0x2e1)}]]}})[_0x46dbe8(0x30d)](_0x3eaa69=>{telegramError(_0x3eaa69);}),tgBot['on'](_0x46dbe8(0x28b),async _0x271db0=>{const _0x241392=_0x46dbe8,_0x19d3cd=_0x271db0[_0x241392(0x2ae)],_0x3c5cb9=_0x271db0[_0x241392(0x2db)];tgBot[_0x241392(0x21c)](_0x271db0['id'])['then'](async()=>{const _0x4d7f1b=_0x241392;_0x19d3cd==_0x4d7f1b(0x27c)&&(updateSetting(_0x4d7f1b(0x338),_0x4d7f1b(0x27c)),updateSetting(_0x4d7f1b(0x32b),!![]),await tgBot[_0x4d7f1b(0x2c4)](_0x3c5cb9[_0x4d7f1b(0x236)]['id'],_0x4d7f1b(0x1fc))[_0x4d7f1b(0x30d)](_0x435693=>{telegramError(_0x435693);}));_0x19d3cd==_0x4d7f1b(0x30a)&&(updateSetting('telegramEvents','alerts'),updateSetting(_0x4d7f1b(0x32b),!![]),await tgBot['sendMessage'](_0x3c5cb9[_0x4d7f1b(0x236)]['id'],_0x4d7f1b(0x1e8))[_0x4d7f1b(0x30d)](_0x4ddf4a=>{telegramError(_0x4ddf4a);}));_0x19d3cd==_0x4d7f1b(0x2e1)&&(updateSetting(_0x4d7f1b(0x338),_0x4d7f1b(0x2e1)),updateSetting('telegramEnabled',!![]),await tgBot[_0x4d7f1b(0x2c4)](_0x3c5cb9[_0x4d7f1b(0x236)]['id'],_0x4d7f1b(0x281))[_0x4d7f1b(0x30d)](_0x2bfb4c=>{telegramError(_0x2bfb4c);}));if(!settings[_0x4d7f1b(0x312)])tgBot[_0x4d7f1b(0x2c4)](_0x3c5cb9[_0x4d7f1b(0x236)]['id'],_0x4d7f1b(0x31d))['catch'](_0xba1e02=>{telegramError(_0xba1e02);});}),tgBot[_0x241392(0x337)]('callback_query');});}),tgBot[_0x4e2d9f(0x2bb)](/\/status/,_0x2302ae=>{const _0x54c8ee=_0x4e2d9f;if(!validateTelegram(_0x2302ae))return;let _0x598f1d=_0x54c8ee(0x291);config[_0x54c8ee(0x293)](_0x2ef394=>{const _0x14c8e1=_0x54c8ee;_0x598f1d+=_0x14c8e1(0x28d)+_0x2ef394[_0x14c8e1(0x28a)]+'\x20|\x20'+_0x2ef394[_0x14c8e1(0x2ef)]+':\x20'+_0x2ef394[_0x14c8e1(0x32c)]+_0x14c8e1(0x325)+_0x2ef394[_0x14c8e1(0x2d5)]+'\x0a';}),_0x598f1d+='\x0a',_0x598f1d+=_0x54c8ee(0x206),_0x598f1d+=!settings[_0x54c8ee(0x32b)]?_0x54c8ee(0x289):_0x54c8ee(0x2a1),_0x598f1d+=settings[_0x54c8ee(0x32b)]?settings[_0x54c8ee(0x338)]==_0x54c8ee(0x2e1)?_0x54c8ee(0x263):_0x54c8ee(0x256)+settings[_0x54c8ee(0x338)]+_0x54c8ee(0x208):'',tgBot['sendMessage'](_0x2302ae['chat']['id'],_0x598f1d,{'parse_mode':_0x54c8ee(0x216)})[_0x54c8ee(0x30d)](_0x38f9d6=>{telegramError(_0x38f9d6);});}),tgBot[_0x4e2d9f(0x2bb)](/\/restart/,_0x256c4a=>{const _0x12a3f2=_0x4e2d9f;if(!validateTelegram(_0x256c4a))return;tgBot[_0x12a3f2(0x337)](_0x12a3f2(0x28b));const _0x3628f4=getEnabledBots();if(_0x3628f4[_0x12a3f2(0x1ec)]==0x0)tgBot[_0x12a3f2(0x2c4)](_0x256c4a[_0x12a3f2(0x236)]['id'],_0x12a3f2(0x28c))[_0x12a3f2(0x30d)](_0x1a4dee=>{telegramError(_0x1a4dee);});else{if(_0x3628f4[_0x12a3f2(0x1ec)]>0x1)_0x3628f4[_0x12a3f2(0x285)]({'botID':_0x12a3f2(0x2e1)});let _0x33c7b8=[],_0x67a2d5=[];const _0xabaa76=_0x3628f4[_0x12a3f2(0x1ec)]%0x4==0x0||_0x3628f4[_0x12a3f2(0x1ec)]%0x4==0x3||_0x3628f4[_0x12a3f2(0x1ec)]%0x3==0x1?0x4:0x3;let _0x197128=0x0;_0x3628f4[_0x12a3f2(0x293)]((_0x5edab1,_0x5994f1)=>{const _0x172355=_0x12a3f2;if(_0x5994f1%_0xabaa76==0x0)_0x67a2d5=[];_0x67a2d5[_0x172355(0x285)]({'text':_0x5edab1['botID']==_0x172355(0x2e1)?_0x172355(0x1ee):'Bot\x20'+_0x5edab1[_0x172355(0x28a)],'callback_data':_0x5edab1[_0x172355(0x28a)]}),_0x5994f1%_0xabaa76==0x0&&(_0x33c7b8[_0x197128]=_0x67a2d5,_0x197128++);}),tgBot[_0x12a3f2(0x2c4)](_0x256c4a[_0x12a3f2(0x236)]['id'],_0x12a3f2(0x2d9),{'reply_markup':{'inline_keyboard':_0x33c7b8}})[_0x12a3f2(0x30d)](_0x9076ff=>{telegramError(_0x9076ff);}),tgBot['on']('callback_query',async _0x1e99af=>{const _0x4ae1b2=_0x12a3f2,_0x43809a=_0x1e99af[_0x4ae1b2(0x2ae)],_0x511c89=_0x1e99af[_0x4ae1b2(0x2db)];tgBot[_0x4ae1b2(0x21c)](_0x1e99af['id'])[_0x4ae1b2(0x1f0)](async()=>{const _0xda5fb0=_0x4ae1b2;if(_0x43809a=='all'){if(settings['telegramEvents']=='orders')tgBot[_0xda5fb0(0x2c4)](_0x511c89[_0xda5fb0(0x236)]['id'],'Bot\x20Mgr\x20>\x20restarting\x20all\x20bots')['catch'](_0x4615a3=>{telegramError(_0x4615a3);});config['forEach'](_0x1e6c41=>{const _0x997dad=_0xda5fb0;stopBot(_0x1e6c41[_0x997dad(0x28a)]);});}else{if(settings[_0xda5fb0(0x338)]==_0xda5fb0(0x27c))tgBot[_0xda5fb0(0x2c4)](_0x511c89[_0xda5fb0(0x236)]['id'],_0xda5fb0(0x315)+_0x43809a)[_0xda5fb0(0x30d)](_0x35ed39=>{telegramError(_0x35ed39);});stopBot(_0x43809a);}}),tgBot['removeListener'](_0x4ae1b2(0x28b));});}}),tgBot[_0x4e2d9f(0x2bb)](/\/on/,_0x535661=>{const _0x5d3a6a=_0x4e2d9f;if(!validateTelegram(_0x535661))return;tgBot['removeListener']('callback_query');const _0x5b576c=getDisabledBots();if(_0x5b576c[_0x5d3a6a(0x1ec)]==0x0)tgBot[_0x5d3a6a(0x2c4)](_0x535661['chat']['id'],_0x5d3a6a(0x26e))['catch'](_0x5439e4=>{telegramError(_0x5439e4);});else{if(_0x5b576c['length']>0x1)_0x5b576c[_0x5d3a6a(0x285)]({'botID':_0x5d3a6a(0x2e1)});let _0x509fb0=[],_0x564271=[];const _0x247d49=_0x5b576c[_0x5d3a6a(0x1ec)]%0x4==0x0||_0x5b576c[_0x5d3a6a(0x1ec)]%0x4==0x3||_0x5b576c[_0x5d3a6a(0x1ec)]%0x3==0x1?0x4:0x3;let _0x4c4f2b=0x0;_0x5b576c[_0x5d3a6a(0x293)]((_0x24ebe9,_0x4a7826)=>{const _0x25e90d=_0x5d3a6a;if(_0x4a7826%_0x247d49==0x0)_0x564271=[];_0x564271['push']({'text':_0x24ebe9[_0x25e90d(0x28a)]=='all'?_0x25e90d(0x1ee):_0x25e90d(0x28d)+_0x24ebe9['botID'],'callback_data':_0x24ebe9['botID']}),_0x4a7826%_0x247d49==0x0&&(_0x509fb0[_0x4c4f2b]=_0x564271,_0x4c4f2b++);}),tgBot['sendMessage'](_0x535661[_0x5d3a6a(0x236)]['id'],_0x5d3a6a(0x2f0),{'reply_markup':{'inline_keyboard':_0x509fb0}})[_0x5d3a6a(0x30d)](_0x560ec0=>{telegramError(_0x560ec0);}),tgBot['on'](_0x5d3a6a(0x28b),async _0x2f0a96=>{const _0x2b58b1=_0x5d3a6a,_0x3b2271=_0x2f0a96['data'],_0x229413=_0x2f0a96[_0x2b58b1(0x2db)];tgBot[_0x2b58b1(0x21c)](_0x2f0a96['id'])[_0x2b58b1(0x1f0)](async()=>{const _0x37efbf=_0x2b58b1;if(_0x3b2271==_0x37efbf(0x2e1)){if(settings[_0x37efbf(0x338)]==_0x37efbf(0x27c))tgBot[_0x37efbf(0x2c4)](_0x229413[_0x37efbf(0x236)]['id'],_0x37efbf(0x22f))[_0x37efbf(0x30d)](_0x8faf53=>{telegramError(_0x8faf53);});_0x5b576c['forEach'](_0x1acbda=>{const _0x16bc97=_0x37efbf;if(_0x1acbda[_0x16bc97(0x28a)]!=_0x16bc97(0x2e1))toggleBot(_0x1acbda['botID'],toggleStatus(_0x1acbda[_0x16bc97(0x28a)]),_0x16bc97(0x290));});}else{if(settings[_0x37efbf(0x338)]==_0x37efbf(0x27c))tgBot[_0x37efbf(0x2c4)](_0x229413[_0x37efbf(0x236)]['id'],_0x37efbf(0x329)+_0x3b2271)[_0x37efbf(0x30d)](_0x3571de=>{telegramError(_0x3571de);});toggleBot(_0x3b2271,toggleStatus(_0x3b2271),_0x37efbf(0x290));}}),tgBot[_0x2b58b1(0x337)]('callback_query');});}}),tgBot['onText'](/\/off/,_0x22955a=>{const _0x3bc155=_0x4e2d9f;if(!validateTelegram(_0x22955a))return;tgBot[_0x3bc155(0x337)](_0x3bc155(0x28b));const _0x5442cd=getEnabledBots();if(_0x5442cd[_0x3bc155(0x1ec)]==0x0)tgBot[_0x3bc155(0x2c4)](_0x22955a[_0x3bc155(0x236)]['id'],_0x3bc155(0x28c))[_0x3bc155(0x30d)](_0x504d8c=>{telegramError(_0x504d8c);});else{if(_0x5442cd[_0x3bc155(0x1ec)]>0x1)_0x5442cd['push']({'botID':_0x3bc155(0x2e1)});let _0x2a16cf=[],_0x3d4885=[];const _0x24976e=_0x5442cd[_0x3bc155(0x1ec)]%0x4==0x0||_0x5442cd[_0x3bc155(0x1ec)]%0x4==0x3||_0x5442cd[_0x3bc155(0x1ec)]%0x3==0x1?0x4:0x3;let _0x23e2d6=0x0;_0x5442cd[_0x3bc155(0x293)]((_0x71c97e,_0x3954ce)=>{const _0x4d1cd3=_0x3bc155;if(_0x3954ce%_0x24976e==0x0)_0x3d4885=[];_0x3d4885[_0x4d1cd3(0x285)]({'text':_0x71c97e['botID']=='all'?'All\x20bots':_0x4d1cd3(0x28d)+_0x71c97e[_0x4d1cd3(0x28a)],'callback_data':_0x71c97e[_0x4d1cd3(0x28a)]}),_0x3954ce%_0x24976e==0x0&&(_0x2a16cf[_0x23e2d6]=_0x3d4885,_0x23e2d6++);}),tgBot['sendMessage'](_0x22955a[_0x3bc155(0x236)]['id'],_0x3bc155(0x209),{'reply_markup':{'inline_keyboard':_0x2a16cf}})['catch'](_0x4fcbbe=>{telegramError(_0x4fcbbe);}),tgBot['on'](_0x3bc155(0x28b),async _0x3fb267=>{const _0x1c1e07=_0x3bc155,_0x3ec41b=_0x3fb267['data'],_0x101795=_0x3fb267['message'];tgBot[_0x1c1e07(0x21c)](_0x3fb267['id'])['then'](async()=>{const _0x9adcfa=_0x1c1e07;if(_0x3ec41b==_0x9adcfa(0x2e1)){if(settings[_0x9adcfa(0x338)]==_0x9adcfa(0x27c))tgBot[_0x9adcfa(0x2c4)](_0x101795[_0x9adcfa(0x236)]['id'],_0x9adcfa(0x1fe))[_0x9adcfa(0x30d)](_0x401c5e=>{telegramError(_0x401c5e);});_0x5442cd['forEach'](_0x1a998d=>{const _0x905591=_0x9adcfa;if(_0x1a998d[_0x905591(0x28a)]!=_0x905591(0x2e1))toggleBot(_0x1a998d[_0x905591(0x28a)],toggleStatus(_0x1a998d[_0x905591(0x28a)]),'stopped');});}else{if(settings[_0x9adcfa(0x338)]==_0x9adcfa(0x27c))tgBot[_0x9adcfa(0x2c4)](_0x101795['chat']['id'],_0x9adcfa(0x20e)+_0x3ec41b)[_0x9adcfa(0x30d)](_0xab0be7=>{telegramError(_0xab0be7);});toggleBot(_0x3ec41b,toggleStatus(_0x3ec41b),'stopped');}}),tgBot['removeListener']('callback_query');});}}),tgBot[_0x4e2d9f(0x2bb)](/\/disable/,_0x4f8422=>{const _0x1c62e2=_0x4e2d9f;if(!validateTelegram(_0x4f8422))return;tgBot[_0x1c62e2(0x2c4)](_0x4f8422[_0x1c62e2(0x236)]['id'],_0x1c62e2(0x251))[_0x1c62e2(0x30d)](_0x49ee07=>{telegramError(_0x49ee07);}),updateSetting(_0x1c62e2(0x32b),![]);}),tgBot[_0x4e2d9f(0x2bb)](/\/help/,_0x3ca099=>{const _0x166b62=_0x4e2d9f;if(!validateTelegram(_0x3ca099))return;tgBot['sendMessage'](_0x3ca099[_0x166b62(0x236)]['id'],_0x37082d)[_0x166b62(0x30d)](_0xe4cf76=>{telegramError(_0xe4cf76);});}),tgBot['on']('polling_error',_0x114da2=>{const _0x400797=_0x4e2d9f;_0x114da2[_0x400797(0x2a8)]()[_0x400797(0x265)](_0x400797(0x205))&&(logging(_0x400797(0x26b)),tgBot[_0x400797(0x2e8)](),tgBot=null,io['to']('botmanager')[_0x400797(0x29e)]('notification',_0x400797(0x26b)));}),process[_0x4e2d9f(0x307)]('SIGINT',()=>{const _0x16f55e=_0x4e2d9f;if(tgBot)tgBot[_0x16f55e(0x2e8)]();process[_0x16f55e(0x20b)](0x1);}),process[_0x4e2d9f(0x307)](_0x4e2d9f(0x24f),()=>{const _0x59fd6d=_0x4e2d9f;if(tgBot)tgBot['stopPolling']();process[_0x59fd6d(0x20b)](0x1);});}}function disableTelegram(){tgBot&&(tgBot['stopPolling'](),tgBot=null);}function sendTelegram(_0x385941,_0x413b67){const _0x172a02=_0x4440f1;if(settings[_0x172a02(0x32b)]){if(settings['telegramEvents']==_0x172a02(0x2e1)||(_0x413b67[_0x172a02(0x2ce)]==_0x172a02(0x23d)||_0x413b67[_0x172a02(0x2ce)]==_0x172a02(0x23f))&&settings[_0x172a02(0x338)]==_0x172a02(0x30a)||_0x413b67[_0x172a02(0x2ce)]=='order'&&settings[_0x172a02(0x338)]==_0x172a02(0x27c)){if(tgBot&&settings[_0x172a02(0x312)]){if(_0x413b67[_0x172a02(0x2c2)])tgBot[_0x172a02(0x2c4)](settings[_0x172a02(0x312)],_0x413b67[_0x172a02(0x2ef)]+_0x172a02(0x240)+_0x413b67[_0x172a02(0x30e)])['catch'](_0x3efbdb=>{telegramError(_0x3efbdb);});else tgBot[_0x172a02(0x2c4)](settings[_0x172a02(0x312)],_0x172a02(0x28d)+_0x385941+_0x172a02(0x240)+_0x413b67['event'])[_0x172a02(0x30d)](_0x5dbb4e=>{telegramError(_0x5dbb4e);});}}}}function getDeviceWithIp(_0x5597f0){return devices['find'](_0x416af3=>_0x416af3['ip']===_0x5597f0);}function temporaryAccess2FA(_0x465545,_0x4d6116){const _0x301c65=_0x4440f1;let _0x3b8198=new Date(),_0x2558d5=![];if(lastIpApproval){if(_0x3b8198-lastIpApproval<0x1388)_0x2558d5=!![];}lastIpApproval=new Date();if(_0x2558d5)return;tgBot&&settings[_0x301c65(0x312)]&&(tgBot[_0x301c65(0x337)](_0x301c65(0x28b)),tgBot[_0x301c65(0x2c4)](settings['telegramChatId'],_0x301c65(0x24e)+normalizeIP(_0x4d6116)[_0x301c65(0x273)]+_0x301c65(0x2b7),{'parse_mode':_0x301c65(0x216),'reply_markup':{'inline_keyboard':[[{'text':_0x301c65(0x1f2),'callback_data':'5'},{'text':_0x301c65(0x20c),'callback_data':'15'},{'text':_0x301c65(0x2b4),'callback_data':'30'},{'text':_0x301c65(0x219),'callback_data':_0x301c65(0x219)}]]}})[_0x301c65(0x30d)](_0x16cb5b=>{telegramError(_0x16cb5b);}),tgBot['on'](_0x301c65(0x28b),async _0x3e27aa=>{const _0x131b6f=_0x301c65,_0x278cf3=_0x3e27aa[_0x131b6f(0x2ae)],_0x6458a0=_0x3e27aa[_0x131b6f(0x2db)];tgBot['answerCallbackQuery'](_0x3e27aa['id'])[_0x131b6f(0x1f0)](async()=>{const _0xaa56af=_0x131b6f;devices[_0x465545][_0xaa56af(0x2fc)]={'clientip':_0x4d6116,'timestamp':new Date()[_0xaa56af(0x24d)](),'expiry':_0x278cf3},_0x278cf3!=_0xaa56af(0x219)?(await tgBot['sendMessage'](_0x6458a0[_0xaa56af(0x236)]['id'],_0xaa56af(0x2b9)+_0x278cf3+_0xaa56af(0x2e6),{'parse_mode':_0xaa56af(0x216)})[_0xaa56af(0x30d)](_0x3e8896=>{telegramError(_0x3e8896);}),io['to'](_0x465545)[_0xaa56af(0x29e)](_0xaa56af(0x32c),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0xaa56af(0x2c4)](_0x6458a0['chat']['id'],_0xaa56af(0x21e))[_0xaa56af(0x30d)](_0x1d2efe=>{telegramError(_0x1d2efe);}),io['to'](_0x465545)[_0xaa56af(0x29e)](_0xaa56af(0x32c),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));}),tgBot[_0x131b6f(0x337)](_0x131b6f(0x28b));}));}function loginAccess2FA(_0x1df62c,_0x16da01){const _0x4fecbf=_0x4440f1;tgBot&&settings['telegramChatId']&&(tgBot[_0x4fecbf(0x337)](_0x4fecbf(0x28b)),tgBot[_0x4fecbf(0x2c4)](settings[_0x4fecbf(0x312)],_0x4fecbf(0x22c)+normalizeIP(_0x16da01)[_0x4fecbf(0x273)]+_0x4fecbf(0x2b7),{'parse_mode':_0x4fecbf(0x216),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x4fecbf(0x219),'callback_data':_0x4fecbf(0x219)}]]}})['catch'](_0x1824b8=>{telegramError(_0x1824b8);}),tgBot['on'](_0x4fecbf(0x28b),async _0x7e7239=>{const _0x5c9feb=_0x4fecbf,_0x2e8a17=_0x7e7239['data'],_0x58ddb0=_0x7e7239[_0x5c9feb(0x2db)];tgBot[_0x5c9feb(0x21c)](_0x7e7239['id'])[_0x5c9feb(0x1f0)](async()=>{const _0x59b347=_0x5c9feb;devices[_0x1df62c][_0x59b347(0x324)]={'clientip':_0x16da01,'timestamp':new Date()['getTime'](),'expiry':_0x2e8a17},_0x2e8a17!=_0x59b347(0x219)?(await tgBot[_0x59b347(0x2c4)](_0x58ddb0[_0x59b347(0x236)]['id'],'Login\x20accepted',{'parse_mode':_0x59b347(0x216)})[_0x59b347(0x30d)](_0x35ceb4=>{telegramError(_0x35ceb4);}),io['to'](_0x1df62c)[_0x59b347(0x29e)](_0x59b347(0x32c),{'access':{'allow':![],'reason':'reload','token':null}})):(await tgBot[_0x59b347(0x2c4)](_0x58ddb0[_0x59b347(0x236)]['id'],'Login\x20rejected')[_0x59b347(0x30d)](_0x3bed08=>{telegramError(_0x3bed08);}),io['to'](_0x1df62c)[_0x59b347(0x29e)](_0x59b347(0x32c),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));}),tgBot[_0x5c9feb(0x337)]('callback_query');}));}function getConfiguration(){const _0xd9147a=_0x4440f1;return dbConfig[_0xd9147a(0x2b5)]('bots')['sortBy'](_0xd9147a(0x28a))[_0xd9147a(0x288)]()||[];}function getEnabledBots(){const _0x48551c=_0x4440f1;return dbConfig[_0x48551c(0x2b5)](_0x48551c(0x2c7))[_0x48551c(0x277)]('botID')[_0x48551c(0x258)]({'status':_0x48551c(0x2ff)})[_0x48551c(0x288)]()||[];}function getDisabledBots(){const _0x3bdc33=_0x4440f1;return dbConfig['get'](_0x3bdc33(0x2c7))[_0x3bdc33(0x277)](_0x3bdc33(0x28a))[_0x3bdc33(0x258)]({'status':_0x3bdc33(0x28e)})[_0x3bdc33(0x288)]()||[];}function getSettings(){const _0x403a23=_0x4440f1;return dbSettings[_0x403a23(0x2b5)](_0x403a23(0x25b))[_0x403a23(0x288)]()||{'timeshift':0x0};}function getSecure(){const _0x238b72=_0x4440f1;return dbSecure[_0x238b72(0x2b5)](_0x238b72(0x286))[_0x238b72(0x288)]()||{};}function getBlacklist(){const _0x1e173a=_0x4440f1;return dbSecure[_0x1e173a(0x2b5)](_0x1e173a(0x31a))['value']()||[];}function broadcastToBots(_0xa00fb0,_0x13f329){const _0x41e629=_0x4440f1;config[_0x41e629(0x293)](_0xc830b=>{const _0x24f1f2=_0x41e629;if(_0xc830b[_0x24f1f2(0x32c)]==_0x24f1f2(0x2ff)&&_0xc830b[_0x24f1f2(0x2d5)]=='running'){if(pid[_0xc830b['botID']])pid[_0xc830b[_0x24f1f2(0x28a)]][_0x24f1f2(0x22a)]({[_0xa00fb0]:_0x13f329});}});}function storeSettings(_0x15337d,_0x41cb23=![]){const _0x3a4eef=_0x4440f1;_0x15337d={...settings,..._0x15337d};if(_0x41cb23&&_0x15337d[_0x3a4eef(0x229)]!=_0x3a4eef(0x311)&&_0x15337d['bbPassword']!=''){const _0x384707=crypt[_0x3a4eef(0x302)](secure[_0x3a4eef(0x300)],_0x15337d['bbPassword'])[_0x3a4eef(0x2db)][_0x3a4eef(0x321)]('@')[0x0],_0x1b5052=bcrypt['hashSync'](_0x384707,saltRounds);_0x15337d={..._0x15337d,'bbPassword':_0x1b5052};}if(_0x41cb23&&_0x15337d[_0x3a4eef(0x2f5)]!=_0x3a4eef(0x311)&&_0x15337d['telegramToken']!=''){const _0x456771=crypt[_0x3a4eef(0x302)](secure[_0x3a4eef(0x300)],_0x15337d['telegramToken'])[_0x3a4eef(0x2db)][_0x3a4eef(0x321)]('@')[0x0];_0x15337d={..._0x15337d,'telegramToken':_0x456771};}const _0x11c492=_0x15337d['telegramToken']!=_0x3a4eef(0x311)&&_0x15337d[_0x3a4eef(0x2f5)]!=settings[_0x3a4eef(0x2f5)]||_0x15337d[_0x3a4eef(0x2d3)]!=settings['telegramUsername'],_0x1566c3=_0x15337d[_0x3a4eef(0x2f5)]==''||_0x15337d[_0x3a4eef(0x2d3)]=='';if(_0x11c492)_0x15337d[_0x3a4eef(0x338)]=_0x3a4eef(0x2e1);for(const [_0x2148db,_0x307907]of Object[_0x3a4eef(0x1fa)](_0x15337d)){if(_0x2148db==_0x3a4eef(0x2f5)&&_0x307907=='************'){_0x15337d[_0x3a4eef(0x2f5)]=settings[_0x3a4eef(0x2f5)];continue;};if(_0x2148db==_0x3a4eef(0x229)&&_0x307907==_0x3a4eef(0x311)){_0x15337d[_0x3a4eef(0x229)]=settings[_0x3a4eef(0x229)];continue;};dbSettings[_0x3a4eef(0x204)](_0x3a4eef(0x21f)+_0x2148db,_0x307907)[_0x3a4eef(0x294)]();}settings=_0x15337d,io['to'](_0x3a4eef(0x23b))['emit'](_0x3a4eef(0x25b),cleanSettings()),broadcastToBots('timeshift',settings[_0x3a4eef(0x254)]);if(_0x11c492&&!_0x1566c3)initTelegram();if(_0x11c492&&_0x1566c3)disableTelegram();getAllClients()[_0x3a4eef(0x293)](_0x50ce5c=>{const _0x58c55c=_0x3a4eef;getSocket(_0x50ce5c['id'])[_0x58c55c(0x29e)](_0x58c55c(0x32c),{'access':{'allow':![],'reason':_0x58c55c(0x287),'token':null}});});}function updateSetting(_0x231948,_0x1f8bb3){const _0x434ae7=_0x4440f1;dbSettings[_0x434ae7(0x204)]('settings.'+_0x231948,_0x1f8bb3)[_0x434ae7(0x294)](),settings=getSettings(),io['to'](_0x434ae7(0x23b))[_0x434ae7(0x29e)](_0x434ae7(0x25b),cleanSettings());}function storeSecure(_0x495b72){const _0x4856af=_0x4440f1;dbSecure[_0x4856af(0x2b5)](_0x4856af(0x286))[_0x4856af(0x285)](_0x495b72)[_0x4856af(0x294)](),secure=_0x495b72;}function addBlacklist(_0x51bb03){const _0xcb41a=_0x4440f1;cleanBlacklist();let _0x286e2a;devices[_0x51bb03][_0xcb41a(0x2fc)]?_0x286e2a=Math[_0xcb41a(0x319)](devices[_0x51bb03][_0xcb41a(0x2fc)]['expiry'],loginExpiry):_0x286e2a=loginExpiry,dbSecure[_0xcb41a(0x2b5)]('blacklist')[_0xcb41a(0x285)]({'expiry':new Date()[_0xcb41a(0x24d)]()+_0x286e2a*0x3c*0x3e8,'token':devices[_0x51bb03][_0xcb41a(0x2a6)][_0xcb41a(0x203)]})[_0xcb41a(0x294)](),blacklist=dbSecure[_0xcb41a(0x2b5)]('blacklist')[_0xcb41a(0x288)]();}function cleanBlacklist(){const _0x101ce1=_0x4440f1;let _0x5aa037=dbSecure[_0x101ce1(0x2b5)](_0x101ce1(0x31a))['cloneDeep']()[_0x101ce1(0x288)](),_0x1513af=new Date()['getTime']();_0x5aa037['forEach'](_0x1ded1b=>{const _0x5e199d=_0x101ce1;_0x1ded1b['expiry']<_0x1513af&&dbSecure[_0x5e199d(0x2b5)](_0x5e199d(0x31a))['remove']({'expiry':_0x1ded1b['expiry']})['write']();});}function initStates(){const _0x21a45e=_0x4440f1;let _0x3bdae1=getConfiguration();_0x3bdae1[_0x21a45e(0x293)](_0x53d2bd=>{const _0x2c3575=_0x21a45e;_0x53d2bd[_0x2c3575(0x2d5)]=_0x2c3575(0x290);}),storeConfiguration(_0x3bdae1);}function onKeys(){const _0x4a5217=new RSA();return new Promise(_0x266e49=>{const _0x580acd=_0x213f;_0x4a5217[_0x580acd(0x2a0)]()['then'](_0x5df494=>{_0x266e49(_0x5df494);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x496d8d=_0x4440f1;let _0x45bb9b=getConfiguration(),_0x210d6e=![];_0x45bb9b[_0x496d8d(0x293)](_0x447c3d=>{const _0x1eb008=_0x496d8d;if(_0x447c3d[_0x1eb008(0x32c)]=='running')_0x447c3d[_0x1eb008(0x32c)]=_0x1eb008(0x2ff),_0x210d6e=!![];else _0x447c3d[_0x1eb008(0x32c)]==_0x1eb008(0x290)&&(_0x447c3d[_0x1eb008(0x32c)]=_0x1eb008(0x28e),_0x210d6e=!![]);});if(_0x210d6e)storeConfiguration(_0x45bb9b);let _0x3aba3e=getSecure();if(!_0x3aba3e[_0x496d8d(0x2dc)](_0x496d8d(0x25f))){let _0x2bb7b8=await generateKeys();_0x3aba3e['publicKey']=_0x2bb7b8['publicKey'],_0x3aba3e[_0x496d8d(0x300)]=_0x2bb7b8['privateKey'],_0x3aba3e['secret']=crypto[_0x496d8d(0x2de)](0x20)[_0x496d8d(0x2a8)](_0x496d8d(0x332));;storeSecure(_0x3aba3e);}let _0x514f45=getSettings();_0x210d6e=![];!_0x514f45[_0x496d8d(0x2dc)](_0x496d8d(0x243))&&(_0x514f45[_0x496d8d(0x243)]=![],_0x514f45['bbUsername']='',_0x514f45[_0x496d8d(0x229)]='',_0x514f45[_0x496d8d(0x2dd)]=![],_0x210d6e=!![]);!_0x514f45['hasOwnProperty'](_0x496d8d(0x2b8))&&(_0x514f45[_0x496d8d(0x2b8)]=![],_0x514f45[_0x496d8d(0x26f)]=[],_0x514f45[_0x496d8d(0x22b)]=![],_0x210d6e=!![]);if(!_0x514f45['hasOwnProperty'](_0x496d8d(0x32b))){if(_0x514f45[_0x496d8d(0x312)])_0x514f45[_0x496d8d(0x32b)]=!![];else _0x514f45[_0x496d8d(0x32b)]=![];_0x210d6e=!![];}if(_0x210d6e)storeSettings(_0x514f45);}function storeConfiguration(_0x178e84){const _0x29d143=_0x4440f1;dbConfig[_0x29d143(0x2b5)](_0x29d143(0x2c7))[_0x29d143(0x2c3)]()[_0x29d143(0x294)](),dbConfig['get'](_0x29d143(0x2c7))[_0x29d143(0x285)](..._0x178e84)[_0x29d143(0x294)](),config=_0x178e84;}function resetPassword(){const _0x1a656e=_0x4440f1;tgBot&&settings['telegramChatId']&&(tgBot[_0x1a656e(0x337)]('callback_query'),tgBot[_0x1a656e(0x2c4)](settings[_0x1a656e(0x312)],_0x1a656e(0x2f7),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x1a656e(0x1eb),'callback_data':_0x1a656e(0x1eb)},{'text':'no','callback_data':'no'}]]}})[_0x1a656e(0x30d)](_0x1e0746=>{telegramError(_0x1e0746);}),tgBot['on']('callback_query',async _0x245a08=>{const _0x35a58c=_0x1a656e,_0x3f6341=_0x245a08['data'],_0x5e0d6d=_0x245a08['message'];tgBot[_0x35a58c(0x21c)](_0x245a08['id'])[_0x35a58c(0x1f0)](async()=>{const _0x390778=_0x35a58c;if(_0x3f6341!='no'){const _0x373da0=0xf,_0x285c77=_0x390778(0x2e3),_0xc79f64=Array[_0x390778(0x1fb)](crypto[_0x390778(0x2b0)](new Uint32Array(_0x373da0)))['map'](_0xd4aac7=>_0x285c77[_0xd4aac7%_0x285c77[_0x390778(0x1ec)]])[_0x390778(0x26d)](''),_0x47961a=bcrypt[_0x390778(0x2ab)](_0xc79f64,saltRounds);storeSettings({'bbPassword':_0x47961a}),await tgBot[_0x390778(0x2c4)](_0x5e0d6d[_0x390778(0x236)]['id'],_0x390778(0x2ad)+_0xc79f64,{'parse_mode':_0x390778(0x216)})[_0x390778(0x30d)](_0x4c6ceb=>{telegramError(_0x4c6ceb);});}else await tgBot['sendMessage'](_0x5e0d6d[_0x390778(0x236)]['id'],'Password\x20reset\x20rejected')[_0x390778(0x30d)](_0x14dd57=>{telegramError(_0x14dd57);});}),tgBot[_0x35a58c(0x337)](_0x35a58c(0x28b));}));}function logging(_0x5a6a3c){const _0x552e96=_0x4440f1;console[_0x552e96(0x333)](getTimeStamp()+_0x552e96(0x2df)+_0x5a6a3c);if(tgBot&&settings[_0x552e96(0x312)]&&settings['telegramEvents']!=_0x552e96(0x27c))tgBot[_0x552e96(0x2c4)](settings['telegramChatId'],_0x552e96(0x1e7)+_0x5a6a3c)['catch'](_0x2d2c35=>{telegramError(_0x2d2c35);});}function getServerTime(){const _0x4761a1=_0x4440f1,_0x571412=new Date();return _0x571412['getFullYear']()+'/'+(_0x571412[_0x4761a1(0x31b)]()+0x1)[_0x4761a1(0x2a8)]()[_0x4761a1(0x213)](0x2,'0')+'/'+_0x571412[_0x4761a1(0x2da)]()['toString']()[_0x4761a1(0x213)](0x2,'0')+'\x20'+_0x571412[_0x4761a1(0x1f3)]()[_0x4761a1(0x2a8)]()[_0x4761a1(0x213)](0x2,'0')+':'+_0x571412[_0x4761a1(0x275)]()[_0x4761a1(0x2a8)]()[_0x4761a1(0x213)](0x2,'0')+':'+_0x571412[_0x4761a1(0x330)]()[_0x4761a1(0x2a8)]()[_0x4761a1(0x213)](0x2,'0');}function getTimeStamp(){const _0x336418=_0x4440f1,_0x3fa47f=shiftedTime();return _0x3fa47f[_0x336418(0x2b2)]()+'/'+(_0x3fa47f[_0x336418(0x31b)]()+0x1)[_0x336418(0x2a8)]()[_0x336418(0x213)](0x2,'0')+'/'+_0x3fa47f['getDate']()['toString']()['padStart'](0x2,'0')+'\x20'+_0x3fa47f['getHours']()[_0x336418(0x2a8)]()[_0x336418(0x213)](0x2,'0')+':'+_0x3fa47f[_0x336418(0x275)]()[_0x336418(0x2a8)]()[_0x336418(0x213)](0x2,'0')+':'+_0x3fa47f[_0x336418(0x330)]()[_0x336418(0x2a8)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x118ceb=_0x4440f1,_0x737f86=new Date();let _0x363fe4=_0x737f86;if(settings[_0x118ceb(0x254)]&&settings['timeshift']!==0x0)_0x363fe4=fns[_0x118ceb(0x2d2)](_0x737f86,{'hours':settings['timeshift']});return _0x363fe4;}function startScheduler(){const _0x375022=_0x4440f1;let _0x4557c5=new Date()[_0x375022(0x248)]();_0x4557c5==0x1&&backupConfigFiles();_0x4557c5==0x9&&triggerAnalytics();if(pidScheduler)clearTimeout(pidScheduler);pidScheduler=setTimeout(()=>{startScheduler();},0x3c*0x3c*0x3e8);}function backupConfigFiles(){const _0x44b96b=_0x4440f1;fs[_0x44b96b(0x32d)](configpath,{'withFileTypes':!![]})['forEach'](_0xa73be1=>{const _0xb79bbd=_0x44b96b;if(!_0xa73be1['isDirectory']())fs[_0xb79bbd(0x26a)](configpath+_0xa73be1[_0xb79bbd(0x202)],configbackuppath+_0xa73be1[_0xb79bbd(0x202)]);});}function triggerAnalytics(){const _0x3bdca3=_0x4440f1;analytics[_0x3bdca3(0x2c6)]({'title':'Balance\x20Bot\x20Server','href':_0x3bdca3(0x234),'path':'/v'+serverversion});}function validateCredentials(_0x76e766,_0x99cd42){const _0x4747d4=_0x4440f1;if(_0x76e766[_0x4747d4(0x260)]==settings['bbUsername']&&bcrypt[_0x4747d4(0x2d6)](_0x76e766['password'],settings[_0x4747d4(0x229)])){if(settings[_0x4747d4(0x2dd)])return{'allow':![],'reason':_0x4747d4(0x2e2),'token':null};else{const _0x20946c=generateLoginToken(_0x99cd42);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x20946c};}}else return{'allow':![],'reason':_0x4747d4(0x2bd),'token':null};}function refreshToken(_0x38a38a){const _0x27fcce=_0x4440f1,_0x3aff9a=generateLoginToken(_0x38a38a);return{'allow':!![],'reason':_0x27fcce(0x284),'token':_0x3aff9a};}function validateAccess(_0x14af3c,_0x34822e){const _0x2a8872=_0x4440f1;let _0x52b2d8=devices[_0x34822e]['ip'],_0x468a8b;const _0x2b9356=_0xc54e59=>{const _0x4a88d2=_0x213f;if(settings[_0x4a88d2(0x243)]){if(settings[_0x4a88d2(0x2dd)]){if(telegram2FaApproved(_0x34822e)){const _0x50a3fb=generateLoginToken(_0x34822e);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x50a3fb};}else return{'allow':![],'reason':_0x4a88d2(0x31c),'token':null};}else return _0x468a8b=validToken(_0xc54e59,_0x34822e),_0x468a8b[_0x4a88d2(0x2dc)](_0x4a88d2(0x23f))?{'allow':!![],'reason':_0x4a88d2(0x29f),'token':_0xc54e59}:{'allow':![],'reason':_0x4a88d2(0x31c),'token':null};}else return{'allow':!![],'reason':_0x4a88d2(0x257),'token':null};};if(settings[_0x2a8872(0x2b8)]){let _0x9bdaac=[...settings[_0x2a8872(0x26f)],_0x2a8872(0x272),_0x2a8872(0x270),'127.0.0.1'];if(_0x9bdaac[_0x2a8872(0x265)](_0x52b2d8))return _0x2b9356(_0x14af3c);else{_0x468a8b=validToken(_0x14af3c,_0x34822e);if(_0x468a8b[_0x2a8872(0x2dc)](_0x2a8872(0x23f)))return _0x2b9356(_0x14af3c);else{if(telegramIpApproved(_0x34822e)){const _0x4ced1c=generateToken(_0x34822e);return _0x468a8b=_0x2b9356(_0x14af3c),_0x468a8b[_0x2a8872(0x301)]?{'allow':!![],'reason':_0x2a8872(0x2bf),'token':_0x4ced1c}:_0x468a8b;}else return settings[_0x2a8872(0x22b)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x2a8872(0x283),'token':null};}}}else return _0x2b9356(_0x14af3c);}function timelyDecrypt(_0x3ba85e,_0x3a02d2=!![]){const _0x19b669=_0x4440f1;if(_0x3ba85e)try{const _0x479951=crypt[_0x19b669(0x302)](secure[_0x19b669(0x300)],_0x3ba85e)[_0x19b669(0x2db)],_0x5ed94e=_0x479951['split']('@')[0x0],_0x241981=_0x479951['split']('@')[0x1],_0x534757=new Date()[_0x19b669(0x24d)]();if(_0x3a02d2){if(_0x534757-_0x241981<maxSecretAge*0x3e8)return _0x5ed94e;else return![];}else return _0x5ed94e;}catch(_0x33f23e){return![];}else return![];}const validToken=(_0x4f0181,_0x3bc407)=>{const _0x37aaa7=_0x4440f1,_0x46ae5c=devices[_0x3bc407]['ip'];if(!_0x4f0181)return{'error':_0x37aaa7(0x2cb)};for(let _0x9394ca of blacklist){if(_0x9394ca['token']==_0x4f0181)return{'error':_0x37aaa7(0x253)};}let _0x323b25;try{_0x323b25=jwt[_0x37aaa7(0x29b)](_0x4f0181,secure[_0x37aaa7(0x25f)]+_0x3bc407);}catch{return{'error':_0x37aaa7(0x24c)};}if(!_0x323b25[_0x37aaa7(0x2dc)]('clientip')&&!_0x323b25['hasOwnProperty']('username')||!_0x323b25[_0x37aaa7(0x2dc)](_0x37aaa7(0x308)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x323b25['hasOwnProperty']('username')&&_0x323b25[_0x37aaa7(0x2dc)](_0x37aaa7(0x2f1))){const {clientip:_0x156eff}=_0x323b25;return _0x46ae5c==_0x156eff?{'success':_0x37aaa7(0x2b6)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x323b25[_0x37aaa7(0x2dc)](_0x37aaa7(0x260))&&_0x323b25[_0x37aaa7(0x2dc)]('clientip')){const {username:_0x449c32,clientip:_0x7cdb7a}=_0x323b25;return settings[_0x37aaa7(0x239)]==_0x449c32&&_0x46ae5c==_0x7cdb7a?{'success':_0x37aaa7(0x2b6)}:{'error':_0x37aaa7(0x1fd)};}}},generateLoginToken=_0x1f2f85=>{const _0x10d5f3=_0x4440f1;if(_0x1f2f85){const _0x505081=devices[_0x1f2f85]['ip'];return jwt['sign']({'username':settings[_0x10d5f3(0x239)],'clientip':_0x505081},secure[_0x10d5f3(0x25f)]+_0x1f2f85,{'expiresIn':tokenRefresh*0x3c});}else return![];},generateToken=_0x44bf75=>{const _0x439d6f=_0x4440f1;if(_0x44bf75){const _0x1e75a2=devices[_0x44bf75]['ip'];return jwt[_0x439d6f(0x318)]({'clientip':_0x1e75a2},secure[_0x439d6f(0x25f)]+_0x44bf75,{'expiresIn':devices[_0x44bf75][_0x439d6f(0x2fc)][_0x439d6f(0x2ca)]*0x3c});}else return![];},telegramIpApproved=_0x16b0ad=>{const _0x5c5b7d=_0x4440f1;let _0x3353a9=![];return devices[_0x16b0ad][_0x5c5b7d(0x2fc)]&&devices[_0x16b0ad]['telegramIpApproval']['expiry']!='reject'&&(_0x3353a9=devices[_0x16b0ad][_0x5c5b7d(0x2fc)]['clientip']==devices[_0x16b0ad]['ip']&&new Date()[_0x5c5b7d(0x24d)]()-devices[_0x16b0ad]['telegramIpApproval']['timestamp']<devices[_0x16b0ad][_0x5c5b7d(0x2fc)]['expiry']*0x3c*0x3e8),_0x3353a9;},telegram2FaApproved=_0x5163fe=>{const _0x495543=_0x4440f1;let _0x5e2f1f=![];return devices[_0x5163fe]['telegram2FaApproval']&&devices[_0x5163fe]['telegram2FaApproval'][_0x495543(0x2ca)]!=_0x495543(0x219)&&(_0x5e2f1f=devices[_0x5163fe][_0x495543(0x324)][_0x495543(0x2f1)]==devices[_0x5163fe]['ip']&&new Date()['getTime']()-devices[_0x5163fe][_0x495543(0x324)][_0x495543(0x280)]<devices[_0x5163fe][_0x495543(0x324)][_0x495543(0x2ca)]*0x3c*0x3e8),_0x5e2f1f;},normalizeIP=_0x44b7d5=>{const _0x3dad27=_0x4440f1;let _0x1f5293=null,_0x362cbd=null;if(ipaddr[_0x3dad27(0x26c)](_0x44b7d5)){const _0x6d637e=ipaddr[_0x3dad27(0x1ea)](_0x44b7d5);_0x6d637e['kind']()===_0x3dad27(0x22e)?(_0x6d637e[_0x3dad27(0x2f8)]()&&(_0x1f5293=_0x6d637e['toIPv4Address']()[_0x3dad27(0x2a8)]()),_0x362cbd=_0x6d637e[_0x3dad27(0x2a8)]()):(_0x1f5293=_0x6d637e['toString'](),_0x362cbd=_0x6d637e['toIPv4MappedAddress']()[_0x3dad27(0x2a8)]());}return{'show':_0x1f5293?_0x1f5293:_0x362cbd,'store':_0x362cbd};};