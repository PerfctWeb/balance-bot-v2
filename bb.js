const _0x2d10df=_0xd07d;(function(_0x562650,_0x27f989){const _0x17eb23=_0xd07d,_0x540e58=_0x562650();while(!![]){try{const _0x5ee455=-parseInt(_0x17eb23(0x1f3))/0x1*(parseInt(_0x17eb23(0x19c))/0x2)+-parseInt(_0x17eb23(0x239))/0x3+-parseInt(_0x17eb23(0x20d))/0x4*(parseInt(_0x17eb23(0x227))/0x5)+-parseInt(_0x17eb23(0x1fb))/0x6+parseInt(_0x17eb23(0x240))/0x7*(-parseInt(_0x17eb23(0x25a))/0x8)+parseInt(_0x17eb23(0x14d))/0x9+-parseInt(_0x17eb23(0x1d3))/0xa*(-parseInt(_0x17eb23(0x200))/0xb);if(_0x5ee455===_0x27f989)break;else _0x540e58['push'](_0x540e58['shift']());}catch(_0x1cd212){_0x540e58['push'](_0x540e58['shift']());}}}(_0x2eaa,0x68caf));const _0x52ee77=function(){let _0x26ec38=!![];return function(_0x1445b5,_0x4bbd34){const _0xc2480d=_0x26ec38?function(){const _0xee71f1=_0xd07d;if(_0x4bbd34){const _0x536234=_0x4bbd34[_0xee71f1(0x159)](_0x1445b5,arguments);return _0x4bbd34=null,_0x536234;}}:function(){};return _0x26ec38=![],_0xc2480d;};}(),_0x4140a2=_0x52ee77(this,function(){const _0x528740=_0xd07d;return _0x4140a2[_0x528740(0x22b)]()[_0x528740(0x1af)](_0x528740(0x182))[_0x528740(0x22b)]()[_0x528740(0x186)](_0x4140a2)[_0x528740(0x1af)](_0x528740(0x182));});_0x4140a2();'use strict';process[_0x2d10df(0x1d0)][_0x2d10df(0x24d)]=0x1;const childProcess=require(_0x2d10df(0x16c)),FileSync=require(_0x2d10df(0x225)),fs=require('fs'),fns=require(_0x2d10df(0x143)),low=require(_0x2d10df(0x1d1)),path=require(_0x2d10df(0x153)),crypto=require(_0x2d10df(0x1e7)),Crypt=require(_0x2d10df(0x1a5))[_0x2d10df(0x1e9)],RSA=require('hybrid-crypto-js')[_0x2d10df(0x16d)],bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),analyticsLib=require(_0x2d10df(0x17e))[_0x2d10df(0x1cf)],googleAnalytics=require(_0x2d10df(0x191))[_0x2d10df(0x1cf)],ipaddr=require(_0x2d10df(0x1ad));let bbpath=_0x2d10df(0x219);const botfile=_0x2d10df(0x170),configfile=_0x2d10df(0x165),settingsfile=_0x2d10df(0x1c2),securefile=_0x2d10df(0x14e);!fs[_0x2d10df(0x1f6)](bbpath+botfile)&&(bbpath='');const configpath=bbpath+_0x2d10df(0x242);!fs[_0x2d10df(0x1f6)](configpath)&&fs[_0x2d10df(0x1a9)](configpath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2d10df(0x23b)]({'bots':[]})[_0x2d10df(0x1c7)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x2d10df(0x23b)]({'settings':{'timeshift':0x0}})[_0x2d10df(0x1c7)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();let crypt=new Crypt({'md':_0x2d10df(0x1e8),'rsaStandard':_0x2d10df(0x259)});const saltRounds=0xa;let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),newBot=![],pid=[],socket=[],serverStatus=[];const serverversion=require('./'+bbpath+_0x2d10df(0x168))[_0x2d10df(0x1cc)],maxSecretAge=0xa,loginExpiry=0x3c,tokenRefresh=0x5;let lastIpApproval,telegramIpApproval,telegram2FaApproval,accessControl,token,uuid,externalip,pidExpireLogin,pidRefreshToken,pidAnalytics;oneTimeMigration(),cleanBlacklist();const PORT=0xbb8,express=require(_0x2d10df(0x164)),app=express(),http=require(_0x2d10df(0x223))[_0x2d10df(0x139)](app);app[_0x2d10df(0x171)](express['static'](path['join'](__dirname,bbpath,'build2'))),app['use'](express['static'](path[_0x2d10df(0x1b4)](__dirname,bbpath,_0x2d10df(0x1be)))),app['get']('/',function(_0x434f74,_0x3652f9){const _0x861080=_0x2d10df;_0x3652f9[_0x861080(0x21c)](path[_0x861080(0x1b4)](__dirname,bbpath,'build2',_0x861080(0x19a)));}),app[_0x2d10df(0x1db)](_0x2d10df(0x255),function(_0x73b590,_0x22862c){const _0x25f647=_0x2d10df;_0x22862c['sendFile'](path[_0x25f647(0x1b4)](__dirname,bbpath,'build',_0x25f647(0x19a)));}),app[_0x2d10df(0x1db)]('/:bot/portfolio',(_0x1cb4c5,_0x4a9c19)=>{const _0x454118=_0x2d10df;_0x4a9c19['sendFile'](path['join'](__dirname,bbpath,_0x454118(0x1be),_0x454118(0x19a)));}),app['get']('/:bot/performance',(_0x2a38a7,_0x3ad531)=>{const _0x5cd68b=_0x2d10df;_0x3ad531[_0x5cd68b(0x21c)](path[_0x5cd68b(0x1b4)](__dirname,bbpath,_0x5cd68b(0x1be),_0x5cd68b(0x19a)));}),app[_0x2d10df(0x1db)]('/:bot/coins',(_0x12bde3,_0x1cbba6)=>{const _0x120b4a=_0x2d10df;_0x1cbba6[_0x120b4a(0x21c)](path[_0x120b4a(0x1b4)](__dirname,bbpath,'build',_0x120b4a(0x19a)));}),app[_0x2d10df(0x1db)]('/:bot/history',(_0x10407b,_0x31f263)=>{const _0x496482=_0x2d10df;_0x31f263[_0x496482(0x21c)](path[_0x496482(0x1b4)](__dirname,bbpath,_0x496482(0x1be),_0x496482(0x19a)));}),app['get'](_0x2d10df(0x19b),(_0xd77581,_0x1e29c3)=>{const _0x1af2df=_0x2d10df;_0x1e29c3[_0x1af2df(0x21c)](path[_0x1af2df(0x1b4)](__dirname,bbpath,_0x1af2df(0x1be),_0x1af2df(0x19a)));}),app[_0x2d10df(0x1db)](_0x2d10df(0x1c4),(_0x4f92ee,_0x43cf44)=>{const _0x39e5ca=_0x2d10df;_0x43cf44['sendFile'](path[_0x39e5ca(0x1b4)](__dirname,bbpath,_0x39e5ca(0x1be),_0x39e5ca(0x19a)));}),http[_0x2d10df(0x1c8)](PORT);const analytics=analyticsLib({'app':_0x2d10df(0x241),'plugins':[googleAnalytics({'trackingId':'UA-192771731-1'})]}),TelegramBot=require(_0x2d10df(0x24a));let tgBot;if(settings[_0x2d10df(0x197)]&&settings[_0x2d10df(0x197)]!=''&&settings[_0x2d10df(0x18f)]&&settings[_0x2d10df(0x18f)]!='')initTelegram();initStates(),startServer(),startSocket(),startAnalytics();function startServer(){const _0x31ad31=_0x2d10df;console[_0x31ad31(0x180)](''),console['log']('-----------------------------------------------------------------------------------'),logging(_0x31ad31(0x183)+PORT),console[_0x31ad31(0x180)](_0x31ad31(0x1da));if(config[_0x31ad31(0x218)]!=0x0)config[_0x31ad31(0x25b)](_0x1caba3=>{const _0x1a38da=_0x31ad31;if(_0x1caba3[_0x1a38da(0x1e6)]==_0x1a38da(0x25d)||_0x1caba3[_0x1a38da(0x1e6)]==_0x1a38da(0x1ab))logging(_0x1a38da(0x22c)+_0x1caba3[_0x1a38da(0x21b)]+_0x1a38da(0x20c)+_0x1caba3[_0x1a38da(0x195)]),startBot([_0x1caba3[_0x1a38da(0x21b)]],{'cwd':bbpath},function(_0x3f94a9){if(_0x3f94a9)logging(_0x3f94a9);});else(_0x1caba3[_0x1a38da(0x1e6)]==_0x1a38da(0x179)||_0x1caba3[_0x1a38da(0x1e6)]=='new-disabled')&&logging(_0x1a38da(0x147)+_0x1caba3[_0x1a38da(0x21b)]+_0x1a38da(0x20c)+_0x1caba3[_0x1a38da(0x195)]);});else!newBot&&console[_0x31ad31(0x180)](_0x31ad31(0x13e));if(newBot)addBot();console['log']('-----------------------------------------------------------------------------------'),console[_0x31ad31(0x180)]('');}function startSocket(){const _0x4f2a4c=_0x2d10df,_0x30fd73=require(_0x4f2a4c(0x1b0))(http,{});_0x30fd73['on']('connection',_0x333fd0=>{const _0x54416e=_0x4f2a4c;let _0x159b4e,_0x391ea4,_0x218a60;const _0x4665a0=_0x333fd0[_0x54416e(0x146)][_0x54416e(0x1d2)][_0x54416e(0x230)],_0x52df2e=_0x333fd0[_0x54416e(0x146)][_0x54416e(0x1dc)][_0x54416e(0x251)];if(!_0x52df2e)_0x333fd0[_0x54416e(0x25e)]('status',{'publicKey':secure[_0x54416e(0x1a4)]});else{uuid=timelyDecrypt(_0x333fd0['handshake'][_0x54416e(0x1dc)]['encryptedUuid'],![]),_0x391ea4=_0x4665a0['match'](/bot[0-9]{3}/);if(_0x391ea4)_0x218a60=_0x391ea4[0x0][_0x54416e(0x23c)](/[0-9]{3}/);if(_0x218a60)_0x159b4e=_0x218a60[0x0];else _0x159b4e=_0x54416e(0x245);if(socket[_0x159b4e])socket[_0x159b4e][_0x54416e(0x24c)](!![]);socket[_0x159b4e]=_0x333fd0,setAccess(_0x159b4e);if(accessControl[_0x54416e(0x1e4)]){if(_0x159b4e=='botmanager')initializeSocketBotManager();else initializeSocketBot(_0x159b4e);}if(!serverStatus[_0x159b4e])serverStatus[_0x159b4e]=_0x54416e(0x15e);socket[_0x159b4e]['on']('login',_0x8600a2=>{const _0x13a82b=_0x54416e,_0x5e1143=timelyDecrypt(_0x8600a2[_0x13a82b(0x1eb)]);if(_0x5e1143){_0x8600a2={'username':_0x8600a2[_0x13a82b(0x1b5)],'password':_0x5e1143};let _0x332f3b=validateCredentials(_0x8600a2);if(_0x332f3b[_0x13a82b(0x1e4)]==![]&&_0x332f3b['reason']==_0x13a82b(0x19f))socket[_0x159b4e]['emit'](_0x13a82b(0x1e6),{'access':_0x332f3b}),loginAccess2FA(externalip);else{if(_0x332f3b['allow']==![]&&_0x332f3b[_0x13a82b(0x1a0)]==_0x13a82b(0x1c0))socket[_0x159b4e]['emit'](_0x13a82b(0x1e6),{'access':_0x332f3b});else{if(_0x332f3b[_0x13a82b(0x1e4)]&&_0x332f3b[_0x13a82b(0x1a0)]==_0x13a82b(0x13a)){token=_0x332f3b['token'];for(let _0x2f663f in socket){if(_0x2f663f==_0x13a82b(0x245))initializeSocketBotManager();else initializeSocketBot(_0x2f663f);socket[_0x2f663f][_0x13a82b(0x25e)](_0x13a82b(0x1e6),{'status':serverStatus[_0x2f663f]||'starting','serverversion':serverversion,'servertime':getServerTime(),'access':_0x332f3b,'externalip':externalip,'publicKey':secure[_0x13a82b(0x1a4)],'loginNow':![]});}setTokenRefresh(),setSessionTimeout('login');}}}}else logging(_0x13a82b(0x142));}),socket[_0x159b4e]['on'](_0x54416e(0x166),()=>{resetPassword();}),socket[_0x159b4e]['on'](_0x54416e(0x24c),_0x42f583=>{let _0x307a99=[];for(let _0x4f9bc2 in socket){if(_0x4f9bc2!=_0x159b4e)_0x307a99[_0x4f9bc2]=socket[_0x4f9bc2];}socket=_0x307a99;});if(_0x159b4e!='botmanager'&&config['apiKey']!=''){if(pid[_0x159b4e])pid[_0x159b4e]['send']({'function':_0x54416e(0x14b),'args':null});}}});}function setAccess(_0x1c600b){const _0x3dd419=_0x2d10df;externalip=normalizeIP(socket[_0x1c600b][_0x3dd419(0x232)][_0x3dd419(0x15d)])[_0x3dd419(0x192)],accessControl=validateAccess(token),accessControl['token']&&accessControl['reason']=='temporary\x20token\x20generated'&&setSessionTimeout(_0x3dd419(0x189)),accessControl['token']&&accessControl[_0x3dd419(0x1a0)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x3dd419(0x1f7)),socket[_0x1c600b][_0x3dd419(0x25e)](_0x3dd419(0x1e6),{'status':serverStatus[_0x1c600b]||_0x3dd419(0x176),'serverversion':serverversion,'servertime':getServerTime(),'access':accessControl,'externalip':externalip,'publicKey':secure['publicKey'],'loginNow':accessControl['reason']==_0x3dd419(0x1df)||accessControl['reason']==_0x3dd419(0x19f)}),accessControl[_0x3dd419(0x1e4)]==![]&&accessControl[_0x3dd419(0x1a0)]==_0x3dd419(0x19e)&&temporaryAccess2FA(externalip);}function _0x2eaa(){const _0x1a7828=['callback_query','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','all','onText','update-bot','build','randomFillSync','invalid\x20credentials','reload','bb-settings.json','Login\x20accepted','/:bot/support','place-order','5\x20min','write','listen','catch','<b>Telegram\x20bot\x20status:</b>\x0a','error\x20while\x20deleting\x20log\x20files:\x20','version','timeshift','data','default','env','lowdb','headers','10jtgWRc','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Unauthorized\x20attempt\x20to\x20update\x20bot','\x20>\x20','args','30\x20min','SIGTERM','-----------------------------------------------------------------------------------','get','auth','includes','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','login\x20required','stopPolling','settings','split','/restart\x20-\x20restart\x20a\x20bot\x0a','allow','type','status','crypto','sha256','Crypt','toIPv4Address','password','new-disabled','-config.json','telegram','running','token','removeListener','Invalid\x20authentication\x20token\x20(1)','15majSFq','bbPassword','blacklist','existsSync','login','login\x20not\x20required','the\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','started','3873750eVFkyF','max',':\x20Bot\x20Mgr\x20>\x20','Allow\x20login\x20from\x20IP\x20address\x20<b>','bbUsername','26625731AOEBmp','removeAllListeners','keys','add-bot','assign','Notifications\x20enabled\x0a','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','sortBy','get-starting-balances','hasOwnProperty','Ok,\x20will\x20send\x20alert\x20notifications\x20only','getHours','\x20|\x20','1450108PMzase','Password\x20reset\x20rejected','get-logs','Balance\x20Bot\x20Server','exit','login\x20token\x20valid','2FA\x20login\x20token\x20generated','bot-','SIGINT','getMonth','deleted\x20Bot\x20','length','bb/','from','botID','sendFile','order','-results.json','padStart','temporaryAccessAllowed','timestamp','No\x20bots\x20enabled\x20right\x20now','http','1000','lowdb/adapters/FileSync','alerts','10gsXGpy','success','Bot\x20','clientip','toString','starting\x20bot\x20|\x20Bot\x20','ipc','page','getMinutes','referer','compareSync','conn','logged\x20out','filter','message','::ffff:127.0.0.1','Temporary\x20access\x20rejected','::1','1606032uzGiyj','polling_error','defaults','match','telegramEnabled','Unauthorized\x20attempt\x20to\x20get\x20portfolio','\x20only\x0a','14rUVUPc','Balance\x20Bot','config/','User\x20has\x20been\x20validated','hashSync','botmanager','getTime','notification','unlinkSync','orders','node-telegram-bot-api','inherit','disconnect','NTBA_FIX_319','https://hodlerhacks.com','telegramChatId','temporary\x20access\x20not\x20allowed','encryptedUuid','entries','<b>Balance\x20Bot\x20status:</b>\x0a','f2aRequired','/:bot','Invalid\x20authentication\x20token\x20(2)','/status\x20-\x20show\x20the\x20status\x20of\x20your\x20bots\x0a','sendMessage','RSA-OAEP','372752YQcZRj','forEach','getDate','enabled','emit','set','error','Alerts','isIPv4MappedAddress','createServer','login\x20token\x20generated','getStartingBalances','show','expiry','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','************','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','isValid','Unauthorized\x20attempt\x20logging\x20in\x20(timeout)','date-fns','store-headless','127.0.0.1','handshake','idling\x20bot\x20\x20\x20|\x20Bot\x20','store-configuration','sign','HTML','initclient','verify','647604Mmjamy','bb-secure.json','whitelist','starting\x20new\x20bot\x20|\x20Bot\x20','Bot\x20Mgr\x20>\x20','push','path','value','kind','Token\x20blacklisted','getSeconds','live','apply','bots','storeHeadless','Login\x20rejected','remoteAddress','connected','find','Ok,\x20will\x20send\x20order\x20notifications\x20only','secret','whitelistEnabled','yes','express','bb-config.json','reset-password','Unauthorized\x20attempt\x20to\x20log\x20out','version.json','Password\x20has\x20been\x20reset\x20to:\x20','Notifications\x20types:\x20','Notifications\x20disabled\x0a','child_process','RSA','Unauthorized\x20attempt\x20to\x20update\x20settings','toIPv4MappedAddress','bot.js','use','No\x20authentication\x20token','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20<b>','Bot\x20Mgr\x20>\x20restarting\x20Bot\x20','enabled\x20Bot\x20','starting','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','disabled','fork','-events.json',':\x20Bot\x20Mgr\x20>\x20Sending\x20Telegram\x20message\x20failed','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','analytics','secure','log','Invalid\x20Telegram\x20token','(((.+)+)+)+$','Bot\x20Manager\x20started\x20|\x20open:\x20http://[ip-address]:','decrypt','reject','constructor','answerCallbackQuery','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','2FA','Unauthorized\x20attempt\x20to\x20add\x20bot','telegramEvents','settings.','Unauthorized\x20attempt\x20to\x20store\x20configuration','add','telegramUsername','placeOrder','@analytics/google-analytics','store','cloneDeep','map','botname','store-settings','telegramToken','function','Note:\x20notifications\x20are\x20currently\x20disabled\x20-\x20to\x20enable\x20notifications,\x20type\x20/enable','index.html','/:bot/configuration','8538jAiSSG','stopped','2FA\x20required','2FA\x20login\x20required','reason','-performance.json','privateKey','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','publicKey','hybrid-crypto-js','loginRequired','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','remove','mkdirSync','getFullYear','new','kill','ipaddr.js','then','search','socket.io','chat','get-portfolio','disabled\x20Bot\x20','join','username','Invalid\x20username\x20or\x20IP\x20address','send','Unauthorized\x20attempt\x20to\x20delete\x20bot'];_0x2eaa=function(){return _0x1a7828;};return _0x2eaa();}function setSessionTimeout(_0x50ae36){const _0x56d2b4=_0x2d10df;let _0x85324b;if(_0x50ae36==_0x56d2b4(0x1f7))_0x85324b=loginExpiry*0x3c*0x3e8;else _0x85324b=telegramIpApproval[_0x56d2b4(0x13d)]*0x3c*0x3e8-(new Date()[_0x56d2b4(0x246)]()-telegramIpApproval[_0x56d2b4(0x221)]);if(pidExpireLogin)clearTimeout(pidExpireLogin);pidExpireLogin=setTimeout(()=>{const _0x44919f=_0x56d2b4;if(pidRefreshToken)clearTimeout(pidRefreshToken);addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null;let _0x37c78b=validateAccess(token);if(!(_0x37c78b['allow']&&_0x37c78b['reason']==_0x44919f(0x1f8)))for(let _0x1115f5 in socket){socket[_0x1115f5][_0x44919f(0x25e)]('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}});}token=null;},_0x85324b);}function setTokenRefresh(){if(pidRefreshToken)clearTimeout(pidRefreshToken);pidRefreshToken=setTimeout(()=>{const _0x26cd6b=_0xd07d;let _0x3ec4ab=refreshToken();for(let _0x1e399e in socket){socket[_0x1e399e][_0x26cd6b(0x25e)](_0x26cd6b(0x1e6),{'status':serverStatus[_0x1e399e]||_0x26cd6b(0x176),'serverversion':serverversion,'servertime':getServerTime(),'access':_0x3ec4ab,'externalip':externalip,'publicKey':secure[_0x26cd6b(0x1a4)],'loginNow':![]});}setTokenRefresh();},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(){const _0x5c394b=_0x2d10df;socket[_0x5c394b(0x245)][_0x5c394b(0x25e)](_0x5c394b(0x15a),config),socket[_0x5c394b(0x245)][_0x5c394b(0x25e)](_0x5c394b(0x1e1),cleanSettings()),socket[_0x5c394b(0x245)]['on'](_0x5c394b(0x203),_0x47ec7d=>{const _0x573f5a=_0x5c394b;if(validateAccess(_0x47ec7d)[_0x573f5a(0x1e4)])addBot();else logging(_0x573f5a(0x18a));}),socket['botmanager']['on'](_0x5c394b(0x1bd),(_0x1a36ac,_0x50eaec)=>{const _0x173fc3=_0x5c394b;if(validateAccess(_0x50eaec)[_0x173fc3(0x1e4)])toggleBot(_0x1a36ac['botID'],_0x1a36ac[_0x173fc3(0x1e6)],_0x1a36ac[_0x173fc3(0x158)]);else logging(_0x173fc3(0x1d5));}),socket[_0x5c394b(0x245)]['on']('delete-bot',(_0x1c5569,_0x2ce62f)=>{const _0x490806=_0x5c394b;if(validateAccess(_0x2ce62f)[_0x490806(0x1e4)])deleteBot(_0x1c5569);else logging(_0x490806(0x1b8));}),socket[_0x5c394b(0x245)]['on'](_0x5c394b(0x196),(_0xf15025,_0xe636d4)=>{const _0x339f99=_0x5c394b;if(validateAccess(_0xe636d4)[_0x339f99(0x1e4)])storeSettings(_0xf15025,!![]);else logging(_0x339f99(0x16e));}),socket[_0x5c394b(0x245)]['on']('logout',_0xdc5c8a=>{const _0x4c03b4=_0x5c394b;if(validateAccess(_0xdc5c8a)[_0x4c03b4(0x1e4)]){if(pidRefreshToken)clearTimeout(pidRefreshToken);if(pidExpireLogin)clearTimeout(pidExpireLogin);removeSocketListeners(),addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null,token=null;for(let _0x2c6559 in socket){socket[_0x2c6559][_0x4c03b4(0x25e)](_0x4c03b4(0x1e6),{'access':{'allow':![],'reason':_0x4c03b4(0x233),'token':null}});}}else logging('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x49c5a3){const _0x2f4ca6=_0x2d10df;socket[_0x49c5a3]['on'](_0x2f4ca6(0x20f),(_0x1f6625,_0xb9d45a)=>{const _0x28307c=_0x2f4ca6;if(validateAccess(_0xb9d45a)[_0x28307c(0x1e4)]){if(pid[_0x49c5a3])pid[_0x49c5a3]['send']({'function':'emitHistory','args':_0x1f6625});}else logging('Unauthorized\x20attempt\x20to\x20get\x20logs');}),socket[_0x49c5a3]['on'](_0x2f4ca6(0x1b2),(_0x325ca1,_0x258128)=>{const _0x2d1eff=_0x2f4ca6;if(validateAccess(_0x258128)[_0x2d1eff(0x1e4)]){if(pid[_0x49c5a3])pid[_0x49c5a3]['send']({'function':'getPortfolio','args':_0x325ca1});}else logging(_0x2d1eff(0x23e));}),socket[_0x49c5a3]['on'](_0x2f4ca6(0x148),(_0x468714,_0xe25bb4)=>{const _0x325d1c=_0x2f4ca6;if(validateAccess(_0xe25bb4)[_0x325d1c(0x1e4)]){if(pid[_0x49c5a3])pid[_0x49c5a3][_0x325d1c(0x1b7)]({'function':'storeConfiguration','args':_0x468714});}else logging(_0x325d1c(0x18d));}),socket[_0x49c5a3]['on'](_0x2f4ca6(0x144),(_0x33c06d,_0x67b225)=>{const _0x350949=_0x2f4ca6;if(validateAccess(_0x67b225)[_0x350949(0x1e4)]){if(pid[_0x49c5a3])pid[_0x49c5a3][_0x350949(0x1b7)]({'function':_0x350949(0x15b),'args':_0x33c06d});}else logging('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),socket[_0x49c5a3]['on'](_0x2f4ca6(0x208),_0xb7cc65=>{const _0x3a341a=_0x2f4ca6;if(validateAccess(_0xb7cc65)[_0x3a341a(0x1e4)]){if(pid[_0x49c5a3])pid[_0x49c5a3][_0x3a341a(0x1b7)]({'function':_0x3a341a(0x13b),'args':null});}else logging(_0x3a341a(0x1d4));}),socket[_0x49c5a3]['on'](_0x2f4ca6(0x1c5),(_0x41cfb4,_0x1f9fb1)=>{const _0x1653a2=_0x2f4ca6;if(validateAccess(_0x1f9fb1)[_0x1653a2(0x1e4)]){if(pid[_0x49c5a3])pid[_0x49c5a3][_0x1653a2(0x1b7)]({'function':_0x1653a2(0x190),'args':_0x41cfb4});}else logging(_0x1653a2(0x1a3));}),socket[_0x49c5a3]['on']('logout',_0xa73eaa=>{const _0x156476=_0x2f4ca6;if(validateAccess(_0xa73eaa)['allow']){if(pidRefreshToken)clearTimeout(pidRefreshToken);if(pidExpireLogin)clearTimeout(pidExpireLogin);removeSocketListeners(),addBlacklist(),telegramIpApproval=null,telegram2FaApproval=null,token=null;for(let _0x9fa6f1 in socket){socket[_0x9fa6f1][_0x156476(0x25e)](_0x156476(0x1e6),{'access':{'allow':![],'reason':_0x156476(0x233),'token':null}});}}else logging(_0x156476(0x167));});}function removeSocketListeners(){const _0x1a0223=_0x2d10df;for(let _0x16a5ce in socket){socket[_0x16a5ce][_0x1a0223(0x201)]();}}function cleanSettings(){const _0x351bd4=_0x2d10df;let _0x4c87c7=settings;return settings['telegramToken']&&settings['telegramToken']!=''&&(_0x4c87c7={..._0x4c87c7,'telegramToken':'************'}),settings[_0x351bd4(0x1f4)]&&settings[_0x351bd4(0x1f4)]!=''&&(_0x4c87c7={..._0x4c87c7,'bbPassword':'************'}),_0x4c87c7;}function startBot(_0x3641b3,_0x25ee3c,_0x48518e){const _0x1ef7ef=_0x2d10df;let _0x17afbf=![];const _0x1381e4=_0x3641b3[0x0];_0x25ee3c={..._0x25ee3c,'stdio':[_0x1ef7ef(0x24b),_0x1ef7ef(0x24b),_0x1ef7ef(0x24b),_0x1ef7ef(0x22d)]},pid[_0x1381e4]=childProcess[_0x1ef7ef(0x17a)](botfile,_0x3641b3,_0x25ee3c),pid[_0x1381e4]['on'](_0x1ef7ef(0x235),_0x47ad8f=>{const _0x3e6605=_0x1ef7ef;switch(Object[_0x3e6605(0x202)](_0x47ad8f)[0x0]){case _0x3e6605(0x195):updateBotName(_0x1381e4,_0x47ad8f['botname']);break;case _0x3e6605(0x1e6):updateStatus(_0x1381e4,_0x47ad8f['status']);break;case _0x3e6605(0x158):updateLive(_0x1381e4,_0x47ad8f[_0x3e6605(0x158)]);break;case _0x3e6605(0x1fa):updateLive(_0x1381e4,_0x47ad8f[_0x3e6605(0x1fa)]);if(socket[_0x1381e4])socket[_0x1381e4]['emit'](_0x3e6605(0x1e6),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x3e6605(0x1ee):sendTelegram(_0x1381e4,_0x47ad8f[_0x3e6605(0x1ee)]);break;case _0x3e6605(0x198):if(socket[_0x1381e4])socket[_0x1381e4]['emit'](_0x47ad8f['function'],_0x47ad8f[_0x3e6605(0x1d7)]);break;}}),pid[_0x1381e4]['on'](_0x1ef7ef(0x260),function(_0x4c8d8a){if(_0x17afbf)return;_0x17afbf=!![],_0x48518e(_0x4c8d8a);}),pid[_0x1381e4]['on']('exit',function(_0x567957){const _0x1a5cb4=_0x1ef7ef;if(_0x17afbf)return;_0x17afbf=!![],_0x48518e(null);const _0xc6cf3=dbConfig[_0x1a5cb4(0x1db)](_0x1a5cb4(0x15a))[_0x1a5cb4(0x15f)]({'botID':_0x1381e4})[_0x1a5cb4(0x154)]();_0xc6cf3&&(_0xc6cf3[_0x1a5cb4(0x1e6)]==_0x1a5cb4(0x25d)||_0xc6cf3[_0x1a5cb4(0x1e6)]=='new')&&(updateLive(_0x1381e4,'stopped'),_0x567957!=0x4d&&(logging('restarting\x20Bot\x20'+_0x1381e4),startBot([_0x1381e4],{'cwd':bbpath},function(_0x44dbeb){if(_0x44dbeb)logging(_0x44dbeb);})));});}function stopBot(_0x1194d8){const _0x3ecd06=_0x2d10df;if(socket[_0x1194d8])socket[_0x1194d8]['disconnect'](!![]);if(pid[_0x1194d8])pid[_0x1194d8][_0x3ecd06(0x1ac)]();}function addBot(){const _0x1be2eb=_0x2d10df;let _0x432f00;for(let _0x5283fc=0x1;_0x5283fc<0x3e9;_0x5283fc++){_0x432f00=_0x5283fc[_0x1be2eb(0x22b)]()[_0x1be2eb(0x21f)](0x3,'0');let _0xd1f319=config[_0x1be2eb(0x15f)](_0x2087f0=>_0x2087f0['botID']==_0x432f00);if(!_0xd1f319)break;}if(_0x432f00===_0x1be2eb(0x224)){logging(_0x1be2eb(0x1f9));return;}logging(_0x1be2eb(0x150)+_0x432f00),dbConfig['get']('bots')[_0x1be2eb(0x152)]({'botID':_0x432f00,'botname':_0x1be2eb(0x229)+_0x432f00,'status':_0x1be2eb(0x1ab),'live':''})['write'](),startBot([_0x432f00],{'cwd':bbpath},function(_0x407633){if(_0x407633)logging(_0x407633);}),config=getConfiguration();if(socket[_0x1be2eb(0x245)])socket[_0x1be2eb(0x245)][_0x1be2eb(0x25e)](_0x1be2eb(0x15a),config);}function deleteBot(_0x2e0419){const _0x59365a=_0x2d10df;if(socket[_0x2e0419])socket[_0x2e0419][_0x59365a(0x24c)](!![]);dbConfig['get'](_0x59365a(0x15a))[_0x59365a(0x1a8)]({'botID':_0x2e0419})[_0x59365a(0x1c7)](),logging(_0x59365a(0x217)+_0x2e0419),stopBot(_0x2e0419);try{fs[_0x59365a(0x248)](path[_0x59365a(0x1b4)](configpath,_0x59365a(0x214)+_0x2e0419+_0x59365a(0x1ed))),fs[_0x59365a(0x248)](path[_0x59365a(0x1b4)](configpath,_0x59365a(0x214)+_0x2e0419+_0x59365a(0x17b))),fs[_0x59365a(0x248)](path['join'](configpath,_0x59365a(0x214)+_0x2e0419+_0x59365a(0x1a1))),fs[_0x59365a(0x248)](path[_0x59365a(0x1b4)](configpath,'bot-'+_0x2e0419+_0x59365a(0x21e)));}catch(_0x9e33b5){if(_0x9e33b5)logging(_0x59365a(0x1cb),_0x9e33b5);}config=getConfiguration();if(socket['botmanager'])socket[_0x59365a(0x245)]['emit']('bots',config);}function toggleBot(_0x195b77,_0x21dc62,_0x415723){const _0x32d763=_0x2d10df;dbConfig['get'](_0x32d763(0x15a))[_0x32d763(0x15f)]({'botID':_0x195b77})[_0x32d763(0x204)]({'status':_0x21dc62})[_0x32d763(0x204)]({'live':_0x415723})[_0x32d763(0x1c7)]();if(_0x21dc62==_0x32d763(0x25d)||_0x21dc62==_0x32d763(0x1ab))logging(_0x32d763(0x175)+_0x195b77),startBot([_0x195b77],{'cwd':bbpath},function(_0xb2349){if(_0xb2349)logging(_0xb2349);});else(_0x21dc62==_0x32d763(0x179)||_0x21dc62==_0x32d763(0x1ec))&&(logging(_0x32d763(0x1b3)+_0x195b77),stopBot(_0x195b77));config=getConfiguration();if(socket['botmanager'])socket[_0x32d763(0x245)]['emit'](_0x32d763(0x15a),config);}function updateStatus(_0x4dabf9,_0x4d2ba2){const _0x3c7268=_0x2d10df;dbConfig['get'](_0x3c7268(0x15a))['find']({'botID':_0x4dabf9})['assign']({'status':_0x4d2ba2})[_0x3c7268(0x1c7)](),config=getConfiguration();if(socket[_0x3c7268(0x245)])socket[_0x3c7268(0x245)][_0x3c7268(0x25e)]('bots',config);}function updateLive(_0x538073,_0xb588a5){const _0x3dfedc=_0x2d10df;dbConfig[_0x3dfedc(0x1db)]('bots')[_0x3dfedc(0x15f)]({'botID':_0x538073})[_0x3dfedc(0x204)]({'live':_0xb588a5})[_0x3dfedc(0x1c7)](),config=getConfiguration();if(socket[_0x3dfedc(0x245)])socket['botmanager'][_0x3dfedc(0x25e)](_0x3dfedc(0x15a),config);}function updateBotName(_0xc79adf,_0x4ea81e){const _0x1fc548=_0x2d10df;dbConfig['get'](_0x1fc548(0x15a))[_0x1fc548(0x15f)]({'botID':_0xc79adf})[_0x1fc548(0x204)]({'botname':_0x4ea81e})[_0x1fc548(0x1c7)](),config=getConfiguration();if(socket[_0x1fc548(0x245)])socket[_0x1fc548(0x245)][_0x1fc548(0x25e)](_0x1fc548(0x15a),config);}function telegramError(_0x251570){const _0x143ce0=_0x2d10df;console[_0x143ce0(0x180)](getTimeStamp()+_0x143ce0(0x17c));}function validateTelegram(_0xad5d01){const _0x522e18=_0x2d10df;if(_0xad5d01[_0x522e18(0x21a)][_0x522e18(0x1b5)]!=settings[_0x522e18(0x18f)]&&'@'+_0xad5d01[_0x522e18(0x21a)][_0x522e18(0x1b5)]!=settings[_0x522e18(0x18f)])return tgBot[_0x522e18(0x258)](_0xad5d01[_0x522e18(0x1b1)]['id'],_0x522e18(0x1de),{'parse_mode':_0x522e18(0x14a)})[_0x522e18(0x1c9)](_0x75a9ed=>{telegramError(_0x75a9ed);}),![];return!![];}async function initTelegram(){const _0x12c62c=_0x2d10df;if(tgBot)tgBot[_0x12c62c(0x1e0)](),tgBot=null,initTelegram();else{tgBot=new TelegramBot(settings[_0x12c62c(0x197)],{'polling':!![]});let _0x59b1ad=_0x12c62c(0x177);_0x59b1ad+='\x0a',_0x59b1ad+='/enable\x20-\x20enable\x20notifications\x0a',_0x59b1ad+='/disable\x20-\x20disable\x20notifications\x0a',_0x59b1ad+=_0x12c62c(0x17d),_0x59b1ad+=_0x12c62c(0x1e3),_0x59b1ad+=_0x12c62c(0x257),_0x59b1ad+='/help\x20-\x20show\x20avaiable\x20commands\x0a';let _0x4f0cab='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x4f0cab+='\x0a',_0x4f0cab+=_0x59b1ad,tgBot[_0x12c62c(0x1bc)](/\/start/,_0x479234=>{const _0x3e383e=_0x12c62c;if(!validateTelegram(_0x479234))return;if(settings[_0x3e383e(0x24f)]!=_0x479234[_0x3e383e(0x1b1)]['id'])updateSetting('telegramChatId',_0x479234['chat']['id']);updateSetting(_0x3e383e(0x23d),!![]),tgBot[_0x3e383e(0x258)](_0x479234['chat']['id'],_0x4f0cab)[_0x3e383e(0x1c9)](_0x4214f3=>{telegramError(_0x4214f3);});}),tgBot[_0x12c62c(0x1bc)](/\/enable/,_0xcb331f=>{const _0x1835e9=_0x12c62c;if(!validateTelegram(_0xcb331f))return;if(settings[_0x1835e9(0x24f)]!=_0xcb331f[_0x1835e9(0x1b1)]['id'])updateSetting(_0x1835e9(0x24f),_0xcb331f[_0x1835e9(0x1b1)]['id']);updateSetting(_0x1835e9(0x23d),!![]),tgBot[_0x1835e9(0x258)](_0xcb331f[_0x1835e9(0x1b1)]['id'],'Notifications\x20enabled')[_0x1835e9(0x1c9)](_0x47919f=>{telegramError(_0x47919f);});}),tgBot[_0x12c62c(0x1bc)](/\/config/,async _0x4a3a98=>{const _0x25c73a=_0x12c62c;if(!validateTelegram(_0x4a3a98))return;tgBot[_0x25c73a(0x1f1)](_0x25c73a(0x1b9)),tgBot['sendMessage'](_0x4a3a98[_0x25c73a(0x1b1)]['id'],_0x25c73a(0x1a7),{'reply_markup':{'inline_keyboard':[[{'text':'Orders','callback_data':'orders'},{'text':_0x25c73a(0x137),'callback_data':_0x25c73a(0x226)},{'text':'All','callback_data':_0x25c73a(0x1bb)}]]}})[_0x25c73a(0x1c9)](_0x5b9b74=>{telegramError(_0x5b9b74);}),tgBot['on'](_0x25c73a(0x1b9),async _0x11d61b=>{const _0x5d4186=_0x25c73a,_0x498574=_0x11d61b['data'],_0x5a6aa3=_0x11d61b[_0x5d4186(0x235)];tgBot[_0x5d4186(0x187)](_0x11d61b['id'])[_0x5d4186(0x1ae)](async()=>{const _0x3b32ca=_0x5d4186;_0x498574==_0x3b32ca(0x249)&&(updateSetting(_0x3b32ca(0x18b),_0x3b32ca(0x249)),updateSetting(_0x3b32ca(0x23d),!![]),await tgBot[_0x3b32ca(0x258)](_0x5a6aa3[_0x3b32ca(0x1b1)]['id'],_0x3b32ca(0x160))[_0x3b32ca(0x1c9)](_0x27474d=>{telegramError(_0x27474d);}));_0x498574=='alerts'&&(updateSetting(_0x3b32ca(0x18b),_0x3b32ca(0x226)),updateSetting('telegramEnabled',!![]),await tgBot[_0x3b32ca(0x258)](_0x5a6aa3[_0x3b32ca(0x1b1)]['id'],_0x3b32ca(0x20a))['catch'](_0x3d3a67=>{telegramError(_0x3d3a67);}));_0x498574=='all'&&(updateSetting(_0x3b32ca(0x18b),_0x3b32ca(0x1bb)),updateSetting('telegramEnabled',!![]),await tgBot[_0x3b32ca(0x258)](_0x5a6aa3[_0x3b32ca(0x1b1)]['id'],_0x3b32ca(0x178))[_0x3b32ca(0x1c9)](_0x4dcb86=>{telegramError(_0x4dcb86);}));if(!settings[_0x3b32ca(0x24f)])tgBot[_0x3b32ca(0x258)](_0x5a6aa3[_0x3b32ca(0x1b1)]['id'],_0x3b32ca(0x199))[_0x3b32ca(0x1c9)](_0x4d2dca=>{telegramError(_0x4d2dca);});}),tgBot[_0x5d4186(0x1f1)](_0x5d4186(0x1b9));});}),tgBot[_0x12c62c(0x1bc)](/\/status/,_0x252683=>{const _0x5a6411=_0x12c62c;if(!validateTelegram(_0x252683))return;let _0x3119d4=_0x5a6411(0x253);config[_0x5a6411(0x25b)](_0x319db0=>{const _0x59e395=_0x5a6411;_0x3119d4+=_0x59e395(0x229)+_0x319db0[_0x59e395(0x21b)]+_0x59e395(0x20c)+_0x319db0['botname']+':\x20'+_0x319db0['status']+'\x20/\x20'+_0x319db0[_0x59e395(0x158)]+'\x0a';}),_0x3119d4+='\x0a',_0x3119d4+=_0x5a6411(0x1ca),_0x3119d4+=!settings[_0x5a6411(0x23d)]?_0x5a6411(0x16b):_0x5a6411(0x205),_0x3119d4+=settings[_0x5a6411(0x23d)]?settings['telegramEvents']=='all'?_0x5a6411(0x140):_0x5a6411(0x16a)+settings['telegramEvents']+_0x5a6411(0x23f):'',tgBot[_0x5a6411(0x258)](_0x252683[_0x5a6411(0x1b1)]['id'],_0x3119d4,{'parse_mode':_0x5a6411(0x14a)})[_0x5a6411(0x1c9)](_0x52ecfb=>{telegramError(_0x52ecfb);});}),tgBot[_0x12c62c(0x1bc)](/\/restart/,_0xcf539f=>{const _0x56fd72=_0x12c62c;if(!validateTelegram(_0xcf539f))return;tgBot['removeListener'](_0x56fd72(0x1b9));const _0x43d5d4=getEnabledBots();if(_0x43d5d4['length']==0x0)tgBot['sendMessage'](_0xcf539f['chat']['id'],_0x56fd72(0x222))['catch'](_0x11917d=>{telegramError(_0x11917d);});else{let _0x18d6ce=[],_0x4eef86=[];const _0x30bae8=_0x43d5d4[_0x56fd72(0x218)]%0x4==0x0||_0x43d5d4[_0x56fd72(0x218)]%0x4==0x3||_0x43d5d4[_0x56fd72(0x218)]%0x3==0x1?0x4:0x3;let _0x3fd530=0x0;_0x43d5d4['forEach']((_0x348a85,_0x2c9e9d)=>{const _0x9d8701=_0x56fd72;if(_0x2c9e9d%_0x30bae8==0x0)_0x4eef86=[];_0x4eef86[_0x9d8701(0x152)]({'text':'Bot\x20'+_0x348a85[_0x9d8701(0x21b)],'callback_data':_0x348a85[_0x9d8701(0x21b)]}),_0x2c9e9d%_0x30bae8==0x0&&(_0x18d6ce[_0x3fd530]=_0x4eef86,_0x3fd530++);}),tgBot[_0x56fd72(0x258)](_0xcf539f[_0x56fd72(0x1b1)]['id'],_0x56fd72(0x188),{'reply_markup':{'inline_keyboard':_0x18d6ce}})['catch'](_0xc3c4e0=>{telegramError(_0xc3c4e0);}),tgBot['on'](_0x56fd72(0x1b9),async _0x162f4f=>{const _0x31439a=_0x56fd72,_0x559d07=_0x162f4f[_0x31439a(0x1ce)],_0x53ab8e=_0x162f4f[_0x31439a(0x235)];tgBot['answerCallbackQuery'](_0x162f4f['id'])[_0x31439a(0x1ae)](async()=>{const _0x17903b=_0x31439a;if(settings['telegramEvents']==_0x17903b(0x249))tgBot['sendMessage'](_0x53ab8e[_0x17903b(0x1b1)]['id'],_0x17903b(0x174)+_0x559d07)[_0x17903b(0x1c9)](_0x5f4aa0=>{telegramError(_0x5f4aa0);});stopBot(_0x559d07);}),tgBot[_0x31439a(0x1f1)]('callback_query');});}}),tgBot[_0x12c62c(0x1bc)](/\/disable/,_0x37d9d4=>{const _0x2922ac=_0x12c62c;if(!validateTelegram(_0x37d9d4))return;tgBot['sendMessage'](_0x37d9d4[_0x2922ac(0x1b1)]['id'],'Notifications\x20disabled')[_0x2922ac(0x1c9)](_0x39854b=>{telegramError(_0x39854b);}),updateSetting(_0x2922ac(0x23d),![]);}),tgBot[_0x12c62c(0x1bc)](/\/help/,_0x4b3db7=>{const _0x4fa362=_0x12c62c;if(!validateTelegram(_0x4b3db7))return;tgBot[_0x4fa362(0x258)](_0x4b3db7[_0x4fa362(0x1b1)]['id'],_0x59b1ad)[_0x4fa362(0x1c9)](_0x2e95d4=>{telegramError(_0x2e95d4);});}),tgBot['on'](_0x12c62c(0x23a),_0x151ffb=>{const _0x2863f0=_0x12c62c;if(_0x151ffb['toString']()[_0x2863f0(0x1dd)]('404\x20Not\x20Found')){logging('Invalid\x20Telegram\x20token'),tgBot[_0x2863f0(0x1e0)](),tgBot=null;if(socket[_0x2863f0(0x245)])socket[_0x2863f0(0x245)][_0x2863f0(0x25e)](_0x2863f0(0x247),_0x2863f0(0x181));}}),process['once'](_0x12c62c(0x215),()=>{const _0x1a1f37=_0x12c62c;if(tgBot)tgBot[_0x1a1f37(0x1e0)]();process[_0x1a1f37(0x211)](0x1);}),process['once'](_0x12c62c(0x1d9),()=>{const _0x30dc97=_0x12c62c;if(tgBot)tgBot[_0x30dc97(0x1e0)]();process['exit'](0x1);});}}function disableTelegram(){const _0x5f3904=_0x2d10df;tgBot&&(tgBot[_0x5f3904(0x1e0)](),tgBot=null);}function sendTelegram(_0x4547fa,_0x16290b){const _0x514a63=_0x2d10df;if(settings[_0x514a63(0x23d)]){if(settings['telegramEvents']==_0x514a63(0x1bb)||(_0x16290b[_0x514a63(0x1e5)]==_0x514a63(0x260)||_0x16290b[_0x514a63(0x1e5)]==_0x514a63(0x228))&&settings['telegramEvents']==_0x514a63(0x226)||_0x16290b[_0x514a63(0x1e5)]==_0x514a63(0x21d)&&settings['telegramEvents']==_0x514a63(0x249)){if(tgBot&&settings['telegramChatId'])tgBot[_0x514a63(0x258)](settings[_0x514a63(0x24f)],'Bot\x20'+_0x4547fa+_0x514a63(0x1d6)+_0x16290b['event'])[_0x514a63(0x1c9)](_0xddaced=>{telegramError(_0xddaced);});}}}function temporaryAccess2FA(_0x901939){const _0x188ccc=_0x2d10df;let _0x121b17=new Date(),_0x55e880=![];if(lastIpApproval){if(_0x121b17-lastIpApproval<0x1388)_0x55e880=!![];}lastIpApproval=new Date();if(_0x55e880)return;tgBot&&settings['telegramChatId']&&(tgBot[_0x188ccc(0x1f1)](_0x188ccc(0x1b9)),tgBot[_0x188ccc(0x258)](settings[_0x188ccc(0x24f)],_0x188ccc(0x173)+normalizeIP(_0x901939)[_0x188ccc(0x13c)]+'</b>\x20?',{'parse_mode':_0x188ccc(0x14a),'reply_markup':{'inline_keyboard':[[{'text':_0x188ccc(0x1c6),'callback_data':'5'},{'text':'15\x20min','callback_data':'15'},{'text':_0x188ccc(0x1d8),'callback_data':'30'},{'text':_0x188ccc(0x185),'callback_data':_0x188ccc(0x185)}]]}})[_0x188ccc(0x1c9)](_0x1f8ac6=>{telegramError(_0x1f8ac6);}),tgBot['on'](_0x188ccc(0x1b9),async _0x33462e=>{const _0x3e4d2c=_0x188ccc,_0x2c295c=_0x33462e[_0x3e4d2c(0x1ce)],_0x52e1f8=_0x33462e[_0x3e4d2c(0x235)];tgBot[_0x3e4d2c(0x187)](_0x33462e['id'])[_0x3e4d2c(0x1ae)](async()=>{const _0x2cf7a9=_0x3e4d2c;if(_0x2c295c!=_0x2cf7a9(0x185)){telegramIpApproval={'clientip':_0x901939,'timestamp':new Date()['getTime'](),'expiry':_0x2c295c},await tgBot[_0x2cf7a9(0x258)](_0x52e1f8['chat']['id'],'Access\x20enabled\x20for\x20'+_0x2c295c+'\x20minutes',{'parse_mode':'HTML'})[_0x2cf7a9(0x1c9)](_0x5a58cd=>{telegramError(_0x5a58cd);});for(let _0x3b1a4b in socket){socket[_0x3b1a4b][_0x2cf7a9(0x25e)](_0x2cf7a9(0x1e6),{'access':{'allow':![],'reason':_0x2cf7a9(0x1c1),'token':null}});}}else await tgBot[_0x2cf7a9(0x258)](_0x52e1f8[_0x2cf7a9(0x1b1)]['id'],_0x2cf7a9(0x237))[_0x2cf7a9(0x1c9)](_0x5c2a48=>{telegramError(_0x5c2a48);});}),tgBot[_0x3e4d2c(0x1f1)](_0x3e4d2c(0x1b9));}));}function loginAccess2FA(_0x23bc4a){const _0x35fd4f=_0x2d10df;tgBot&&settings['telegramChatId']&&(tgBot['removeListener']('callback_query'),tgBot[_0x35fd4f(0x258)](settings[_0x35fd4f(0x24f)],_0x35fd4f(0x1fe)+normalizeIP(_0x23bc4a)[_0x35fd4f(0x13c)]+'</b>\x20?',{'parse_mode':_0x35fd4f(0x14a),'reply_markup':{'inline_keyboard':[[{'text':'accept','callback_data':loginExpiry},{'text':_0x35fd4f(0x185),'callback_data':_0x35fd4f(0x185)}]]}})['catch'](_0x47cccc=>{telegramError(_0x47cccc);}),tgBot['on'](_0x35fd4f(0x1b9),async _0x101644=>{const _0x257c63=_0x35fd4f,_0x24a8bb=_0x101644[_0x257c63(0x1ce)],_0x587880=_0x101644[_0x257c63(0x235)];tgBot[_0x257c63(0x187)](_0x101644['id'])[_0x257c63(0x1ae)](async()=>{const _0x2d02d5=_0x257c63;if(_0x24a8bb!='reject'){telegram2FaApproval={'clientip':_0x23bc4a,'timestamp':new Date()[_0x2d02d5(0x246)](),'expiry':_0x24a8bb},await tgBot[_0x2d02d5(0x258)](_0x587880[_0x2d02d5(0x1b1)]['id'],_0x2d02d5(0x1c3),{'parse_mode':_0x2d02d5(0x14a)})[_0x2d02d5(0x1c9)](_0x3573ee=>{telegramError(_0x3573ee);});for(let _0x8b9549 in socket){socket[_0x8b9549][_0x2d02d5(0x25e)](_0x2d02d5(0x1e6),{'access':{'allow':![],'reason':_0x2d02d5(0x1c1),'token':null}});}}else await tgBot['sendMessage'](_0x587880[_0x2d02d5(0x1b1)]['id'],_0x2d02d5(0x15c))[_0x2d02d5(0x1c9)](_0x56b2cf=>{telegramError(_0x56b2cf);});}),tgBot[_0x257c63(0x1f1)]('callback_query');}));}function _0xd07d(_0x57359c,_0x36121f){const _0x1d4fe2=_0x2eaa();return _0xd07d=function(_0x4140a2,_0x52ee77){_0x4140a2=_0x4140a2-0x137;let _0x2eaa15=_0x1d4fe2[_0x4140a2];return _0x2eaa15;},_0xd07d(_0x57359c,_0x36121f);}function getConfiguration(){const _0x28a916=_0x2d10df;return dbConfig[_0x28a916(0x1db)]('bots')[_0x28a916(0x207)](_0x28a916(0x21b))[_0x28a916(0x154)]()||[];}function getEnabledBots(){const _0x33a550=_0x2d10df;return dbConfig[_0x33a550(0x1db)](_0x33a550(0x15a))[_0x33a550(0x207)](_0x33a550(0x21b))[_0x33a550(0x234)]({'status':'enabled'})['value']()||[];}function getSettings(){const _0x423881=_0x2d10df;return dbSettings[_0x423881(0x1db)](_0x423881(0x1e1))['value']()||{'timeshift':0x0};}function getSecure(){const _0x4ced59=_0x2d10df;return dbSecure['get']('secure')[_0x4ced59(0x154)]()||{};}function getBlacklist(){const _0x176f4a=_0x2d10df;return dbSecure[_0x176f4a(0x1db)]('blacklist')[_0x176f4a(0x154)]()||[];}function broadcastToBots(_0x417137,_0x4b712b){const _0x5affc7=_0x2d10df;config[_0x5affc7(0x25b)](_0x16e422=>{const _0x4f9e8c=_0x5affc7;if(_0x16e422[_0x4f9e8c(0x1e6)]==_0x4f9e8c(0x25d)&&_0x16e422[_0x4f9e8c(0x158)]==_0x4f9e8c(0x1ef)){if(pid[_0x16e422[_0x4f9e8c(0x21b)]])pid[_0x16e422['botID']][_0x4f9e8c(0x1b7)]({[_0x417137]:_0x4b712b});}});}function storeSettings(_0x5d8871,_0x16f3de=![]){const _0x41a1ef=_0x2d10df;_0x5d8871={...settings,..._0x5d8871};if(_0x16f3de&&_0x5d8871['bbPassword']!=_0x41a1ef(0x13f)&&_0x5d8871['bbPassword']!=''){const _0x1a09c8=crypt[_0x41a1ef(0x184)](secure['privateKey'],_0x5d8871['bbPassword'])[_0x41a1ef(0x235)]['split']('@')[0x0],_0x1c9034=bcrypt[_0x41a1ef(0x244)](_0x1a09c8,saltRounds);_0x5d8871={..._0x5d8871,'bbPassword':_0x1c9034};}if(_0x16f3de&&_0x5d8871[_0x41a1ef(0x197)]!=_0x41a1ef(0x13f)&&_0x5d8871[_0x41a1ef(0x197)]!=''){const _0x24ecdc=crypt[_0x41a1ef(0x184)](secure['privateKey'],_0x5d8871['telegramToken'])[_0x41a1ef(0x235)]['split']('@')[0x0];_0x5d8871={..._0x5d8871,'telegramToken':_0x24ecdc};}const _0x2c153b=_0x5d8871[_0x41a1ef(0x197)]!=_0x41a1ef(0x13f)&&_0x5d8871['telegramToken']!=settings[_0x41a1ef(0x197)]||_0x5d8871['telegramUsername']!=settings[_0x41a1ef(0x18f)],_0xe9f48f=_0x5d8871[_0x41a1ef(0x197)]==''||_0x5d8871[_0x41a1ef(0x18f)]=='';if(_0x2c153b)_0x5d8871[_0x41a1ef(0x18b)]=_0x41a1ef(0x1bb);for(const [_0x5c96f2,_0x5f1ff5]of Object[_0x41a1ef(0x252)](_0x5d8871)){if(_0x5c96f2=='telegramToken'&&_0x5f1ff5=='************'){_0x5d8871[_0x41a1ef(0x197)]=settings[_0x41a1ef(0x197)];continue;};if(_0x5c96f2=='bbPassword'&&_0x5f1ff5==_0x41a1ef(0x13f)){_0x5d8871[_0x41a1ef(0x1f4)]=settings['bbPassword'];continue;};dbSettings['set'](_0x41a1ef(0x18c)+_0x5c96f2,_0x5f1ff5)[_0x41a1ef(0x1c7)]();}settings=_0x5d8871;if(socket[_0x41a1ef(0x245)])socket[_0x41a1ef(0x245)]['emit']('settings',cleanSettings());broadcastToBots(_0x41a1ef(0x1cd),settings[_0x41a1ef(0x1cd)]);if(_0x2c153b&&!_0xe9f48f)initTelegram();if(_0x2c153b&&_0xe9f48f)disableTelegram();for(let _0x3bbeb9 in socket){setAccess(_0x3bbeb9);}}function updateSetting(_0x2c299f,_0x3cee74){const _0x5d1c1c=_0x2d10df;dbSettings[_0x5d1c1c(0x25f)](_0x5d1c1c(0x18c)+_0x2c299f,_0x3cee74)[_0x5d1c1c(0x1c7)](),settings=getSettings();if(socket[_0x5d1c1c(0x245)])socket['botmanager'][_0x5d1c1c(0x25e)]('settings',cleanSettings());}function storeSecure(_0x295195){const _0x4d7c4b=_0x2d10df;dbSecure[_0x4d7c4b(0x1db)](_0x4d7c4b(0x17f))['push'](_0x295195)[_0x4d7c4b(0x1c7)](),secure=_0x295195;}function addBlacklist(){const _0xc773a4=_0x2d10df;cleanBlacklist();let _0x21bc07;telegramIpApproval?_0x21bc07=Math[_0xc773a4(0x1fc)](telegramIpApproval[_0xc773a4(0x13d)],loginExpiry):_0x21bc07=loginExpiry,dbSecure['get']('blacklist')[_0xc773a4(0x152)]({'expiry':new Date()[_0xc773a4(0x246)]()+_0x21bc07*0x3c*0x3e8,'token':token})[_0xc773a4(0x1c7)](),blacklist=dbSecure[_0xc773a4(0x1db)]('blacklist')[_0xc773a4(0x154)]();}function cleanBlacklist(){const _0x4a1583=_0x2d10df;let _0x5d3e54=dbSecure['get']('blacklist')[_0x4a1583(0x193)]()[_0x4a1583(0x154)](),_0x334351=new Date()[_0x4a1583(0x246)]();_0x5d3e54[_0x4a1583(0x25b)](_0x3ddf0f=>{const _0x751586=_0x4a1583;_0x3ddf0f[_0x751586(0x13d)]<_0x334351&&dbSecure[_0x751586(0x1db)](_0x751586(0x1f5))[_0x751586(0x1a8)]({'expiry':_0x3ddf0f[_0x751586(0x13d)]})[_0x751586(0x1c7)]();});}function initStates(){const _0xfb3261=_0x2d10df;let _0x15e49e=getConfiguration();_0x15e49e[_0xfb3261(0x25b)](_0x504919=>{const _0x1dac36=_0xfb3261;_0x504919[_0x1dac36(0x158)]=_0x1dac36(0x19d);}),storeConfiguration(_0x15e49e);}function onKeys(){const _0x8138fe=new RSA();return new Promise(_0x4e4d7b=>{_0x8138fe['generateKeyPairAsync']()['then'](_0x133795=>{_0x4e4d7b(_0x133795);});});}async function generateKeys(){return await onKeys();}async function oneTimeMigration(){const _0x1a42e4=_0x2d10df;let _0x45c2b9=getConfiguration(),_0x5de34a=![];_0x45c2b9[_0x1a42e4(0x25b)](_0x374a28=>{const _0x5a278c=_0x1a42e4;if(_0x374a28[_0x5a278c(0x1e6)]=='running')_0x374a28[_0x5a278c(0x1e6)]=_0x5a278c(0x25d),_0x5de34a=!![];else _0x374a28[_0x5a278c(0x1e6)]==_0x5a278c(0x19d)&&(_0x374a28['status']='disabled',_0x5de34a=!![]);});if(_0x5de34a)storeConfiguration(_0x45c2b9);let _0x86a885=getSecure();if(!_0x86a885[_0x1a42e4(0x209)](_0x1a42e4(0x161))){let _0x392072=await generateKeys();_0x86a885[_0x1a42e4(0x1a4)]=_0x392072['publicKey'],_0x86a885[_0x1a42e4(0x1a2)]=_0x392072[_0x1a42e4(0x1a2)],_0x86a885[_0x1a42e4(0x161)]=crypto['randomBytes'](0x20)['toString']('hex');;storeSecure(_0x86a885);}let _0x3942ac=getSettings();_0x5de34a=![];!_0x3942ac[_0x1a42e4(0x209)](_0x1a42e4(0x1a6))&&(_0x3942ac['loginRequired']=![],_0x3942ac[_0x1a42e4(0x1ff)]='',_0x3942ac['bbPassword']='',_0x3942ac[_0x1a42e4(0x254)]=![],_0x5de34a=!![]);!_0x3942ac[_0x1a42e4(0x209)](_0x1a42e4(0x162))&&(_0x3942ac['whitelistEnabled']=![],_0x3942ac[_0x1a42e4(0x14f)]=[],_0x3942ac['temporaryAccessAllowed']=![],_0x5de34a=!![]);if(!_0x3942ac[_0x1a42e4(0x209)](_0x1a42e4(0x23d))){if(_0x3942ac[_0x1a42e4(0x24f)])_0x3942ac[_0x1a42e4(0x23d)]=!![];else _0x3942ac[_0x1a42e4(0x23d)]=![];_0x5de34a=!![];}if(_0x5de34a)storeSettings(_0x3942ac);}function storeConfiguration(_0x2cd111){const _0x4a4a4d=_0x2d10df;dbConfig[_0x4a4a4d(0x1db)](_0x4a4a4d(0x15a))['remove']()['write'](),dbConfig['get'](_0x4a4a4d(0x15a))[_0x4a4a4d(0x152)](..._0x2cd111)[_0x4a4a4d(0x1c7)](),config=_0x2cd111;}function resetPassword(){const _0x18b5fd=_0x2d10df;tgBot&&settings[_0x18b5fd(0x24f)]&&(tgBot[_0x18b5fd(0x1f1)](_0x18b5fd(0x1b9)),tgBot['sendMessage'](settings[_0x18b5fd(0x24f)],_0x18b5fd(0x1ba),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':[[{'text':_0x18b5fd(0x163),'callback_data':_0x18b5fd(0x163)},{'text':'no','callback_data':'no'}]]}})[_0x18b5fd(0x1c9)](_0x2a7879=>{telegramError(_0x2a7879);}),tgBot['on'](_0x18b5fd(0x1b9),async _0x53373d=>{const _0x1f3676=_0x18b5fd,_0x50f4eb=_0x53373d[_0x1f3676(0x1ce)],_0x1bbc30=_0x53373d[_0x1f3676(0x235)];tgBot[_0x1f3676(0x187)](_0x53373d['id'])[_0x1f3676(0x1ae)](async()=>{const _0xca5301=_0x1f3676;if(_0x50f4eb!='no'){const _0x4c14f6=0xf,_0x10400e=_0xca5301(0x206),_0x15bad4=Array[_0xca5301(0x21a)](crypto[_0xca5301(0x1bf)](new Uint32Array(_0x4c14f6)))[_0xca5301(0x194)](_0x384249=>_0x10400e[_0x384249%_0x10400e[_0xca5301(0x218)]])[_0xca5301(0x1b4)](''),_0x49f659=bcrypt[_0xca5301(0x244)](_0x15bad4,saltRounds);storeSettings({'bbPassword':_0x49f659}),await tgBot[_0xca5301(0x258)](_0x1bbc30['chat']['id'],_0xca5301(0x169)+_0x15bad4,{'parse_mode':'HTML'})[_0xca5301(0x1c9)](_0x25e85d=>{telegramError(_0x25e85d);});}else await tgBot[_0xca5301(0x258)](_0x1bbc30[_0xca5301(0x1b1)]['id'],_0xca5301(0x20e))[_0xca5301(0x1c9)](_0x46b4a5=>{telegramError(_0x46b4a5);});}),tgBot[_0x1f3676(0x1f1)](_0x1f3676(0x1b9));}));}function logging(_0x82f8d7){const _0x4bfff8=_0x2d10df;console[_0x4bfff8(0x180)](getTimeStamp()+_0x4bfff8(0x1fd)+_0x82f8d7);if(tgBot&&settings[_0x4bfff8(0x24f)]&&settings['telegramEvents']!='orders')tgBot['sendMessage'](settings[_0x4bfff8(0x24f)],_0x4bfff8(0x151)+_0x82f8d7)[_0x4bfff8(0x1c9)](_0x4f25f1=>{telegramError(_0x4f25f1);});}function getServerTime(){const _0x56a0a9=_0x2d10df,_0x5980e9=new Date();return _0x5980e9[_0x56a0a9(0x1aa)]()+'/'+(_0x5980e9[_0x56a0a9(0x216)]()+0x1)['toString']()[_0x56a0a9(0x21f)](0x2,'0')+'/'+_0x5980e9[_0x56a0a9(0x25c)]()[_0x56a0a9(0x22b)]()[_0x56a0a9(0x21f)](0x2,'0')+'\x20'+_0x5980e9[_0x56a0a9(0x20b)]()[_0x56a0a9(0x22b)]()['padStart'](0x2,'0')+':'+_0x5980e9[_0x56a0a9(0x22f)]()[_0x56a0a9(0x22b)]()[_0x56a0a9(0x21f)](0x2,'0')+':'+_0x5980e9[_0x56a0a9(0x157)]()[_0x56a0a9(0x22b)]()[_0x56a0a9(0x21f)](0x2,'0');}function getTimeStamp(){const _0x24597a=_0x2d10df,_0x3a63d7=shiftedTime();return _0x3a63d7[_0x24597a(0x1aa)]()+'/'+(_0x3a63d7[_0x24597a(0x216)]()+0x1)[_0x24597a(0x22b)]()[_0x24597a(0x21f)](0x2,'0')+'/'+_0x3a63d7['getDate']()['toString']()[_0x24597a(0x21f)](0x2,'0')+'\x20'+_0x3a63d7['getHours']()[_0x24597a(0x22b)]()[_0x24597a(0x21f)](0x2,'0')+':'+_0x3a63d7[_0x24597a(0x22f)]()[_0x24597a(0x22b)]()['padStart'](0x2,'0')+':'+_0x3a63d7[_0x24597a(0x157)]()[_0x24597a(0x22b)]()[_0x24597a(0x21f)](0x2,'0');}function shiftedTime(){const _0x79b92a=_0x2d10df,_0x5110a8=new Date();let _0x4b03aa=_0x5110a8;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x4b03aa=fns[_0x79b92a(0x18e)](_0x5110a8,{'hours':settings['timeshift']});return _0x4b03aa;}function startAnalytics(){let _0x44bd2e=new Date()['getUTCHours']();_0x44bd2e==0x9&&triggerAnalytics();if(pidAnalytics)clearTimeout(pidAnalytics);pidAnalytics=setTimeout(()=>{startAnalytics();},0x3c*0x3c*0x3e8);}function triggerAnalytics(){const _0x3368d3=_0x2d10df;analytics[_0x3368d3(0x22e)]({'title':_0x3368d3(0x210),'href':_0x3368d3(0x24e),'path':'/v'+serverversion});}function validateCredentials(_0x50c85f){const _0xbb7e4d=_0x2d10df;if(_0x50c85f[_0xbb7e4d(0x1b5)]==settings['bbUsername']&&bcrypt[_0xbb7e4d(0x231)](_0x50c85f[_0xbb7e4d(0x1eb)],settings[_0xbb7e4d(0x1f4)])){if(settings[_0xbb7e4d(0x254)])return{'allow':![],'reason':_0xbb7e4d(0x19f),'token':null};else{const _0x2023fc=generateLoginToken();return{'allow':!![],'reason':_0xbb7e4d(0x13a),'token':_0x2023fc};}}else return{'allow':![],'reason':_0xbb7e4d(0x1c0),'token':null};}function refreshToken(){const _0x42054e=_0x2d10df,_0xf5001a=generateLoginToken();return{'allow':!![],'reason':_0x42054e(0x13a),'token':_0xf5001a};}function validateAccess(_0x2ec12a){const _0x26b77e=_0x2d10df;let _0x412dbe;const _0x3c5efd=_0x9d4300=>{const _0x29a5c6=_0xd07d;if(settings['loginRequired']){if(settings[_0x29a5c6(0x254)]){if(telegram2FaApproved()){const _0x67aa48=generateLoginToken();return{'allow':!![],'reason':_0x29a5c6(0x213),'token':_0x67aa48};}else return{'allow':![],'reason':_0x29a5c6(0x19f),'token':null};}else return _0x412dbe=validToken(_0x9d4300),_0x412dbe['hasOwnProperty'](_0x29a5c6(0x228))?{'allow':!![],'reason':_0x29a5c6(0x212),'token':_0x9d4300}:{'allow':![],'reason':_0x29a5c6(0x1df),'token':null};}else return{'allow':!![],'reason':_0x29a5c6(0x1f8),'token':null};};if(settings[_0x26b77e(0x162)]){let _0x45407c=[...settings[_0x26b77e(0x14f)],_0x26b77e(0x238),_0x26b77e(0x236),_0x26b77e(0x145)];if(_0x45407c[_0x26b77e(0x1dd)](externalip))return _0x3c5efd(_0x2ec12a);else{_0x412dbe=validToken(_0x2ec12a);if(_0x412dbe['hasOwnProperty'](_0x26b77e(0x228)))return _0x3c5efd(_0x2ec12a);else{if(telegramIpApproved()){const _0x2241b9=generateToken();return _0x412dbe=_0x3c5efd(_0x2ec12a),_0x412dbe[_0x26b77e(0x1e4)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x2241b9}:_0x412dbe;}else return settings[_0x26b77e(0x220)]?{'allow':![],'reason':_0x26b77e(0x19e),'token':null}:{'allow':![],'reason':_0x26b77e(0x250),'token':null};}}}else return _0x3c5efd(_0x2ec12a);}function timelyDecrypt(_0x482094,_0x4c6b63=!![]){const _0x17813d=_0x2d10df;if(_0x482094)try{const _0x27799a=crypt[_0x17813d(0x184)](secure[_0x17813d(0x1a2)],_0x482094)[_0x17813d(0x235)],_0x36e5a5=_0x27799a[_0x17813d(0x1e2)]('@')[0x0],_0x3e1677=_0x27799a[_0x17813d(0x1e2)]('@')[0x1],_0x3cc0b9=new Date()['getTime']();if(_0x4c6b63){if(_0x3cc0b9-_0x3e1677<maxSecretAge*0x3e8)return _0x36e5a5;else return![];}else return _0x36e5a5;}catch{return![];}else return![];}const validToken=_0x3c5da4=>{const _0x5ebd00=_0x2d10df;if(!_0x3c5da4)return{'error':_0x5ebd00(0x172)};for(let _0x717ca4 of blacklist){if(_0x717ca4[_0x5ebd00(0x1f0)]==_0x3c5da4)return{'error':_0x5ebd00(0x156)};}let _0xc6de34;try{_0xc6de34=jwt[_0x5ebd00(0x14c)](_0x3c5da4,secure['secret']+uuid);}catch{return{'error':_0x5ebd00(0x1f2)};}if(!_0xc6de34[_0x5ebd00(0x209)](_0x5ebd00(0x22a))&&!_0xc6de34[_0x5ebd00(0x209)](_0x5ebd00(0x1b5))||!_0xc6de34[_0x5ebd00(0x209)]('exp'))return{'error':_0x5ebd00(0x256)};if(!_0xc6de34['hasOwnProperty']('username')&&_0xc6de34['hasOwnProperty'](_0x5ebd00(0x22a))){const {clientip:_0x2cd475}=_0xc6de34;return externalip==_0x2cd475?{'success':_0x5ebd00(0x243)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0xc6de34[_0x5ebd00(0x209)](_0x5ebd00(0x1b5))&&_0xc6de34[_0x5ebd00(0x209)](_0x5ebd00(0x22a))){const {username:_0x251bd1,clientip:_0x3032bd}=_0xc6de34;return settings[_0x5ebd00(0x1ff)]==_0x251bd1&&externalip==_0x3032bd?{'success':_0x5ebd00(0x243)}:{'error':_0x5ebd00(0x1b6)};}}},generateLoginToken=()=>{const _0x27c9a0=_0x2d10df;if(uuid)return jwt[_0x27c9a0(0x149)]({'username':settings[_0x27c9a0(0x1ff)],'clientip':externalip},secure[_0x27c9a0(0x161)]+uuid,{'expiresIn':tokenRefresh*0x3c});else return![];},generateToken=()=>{const _0x366fb2=_0x2d10df;if(uuid)return jwt['sign']({'clientip':externalip},secure['secret']+uuid,{'expiresIn':telegramIpApproval[_0x366fb2(0x13d)]*0x3c});else return![];},telegramIpApproved=()=>{const _0x3d4a47=_0x2d10df;let _0x213271=![];return telegramIpApproval&&telegramIpApproval[_0x3d4a47(0x13d)]!=_0x3d4a47(0x185)&&(_0x213271=telegramIpApproval[_0x3d4a47(0x22a)]==externalip&&new Date()['getTime']()-telegramIpApproval[_0x3d4a47(0x221)]<telegramIpApproval[_0x3d4a47(0x13d)]*0x3c*0x3e8),_0x213271;},telegram2FaApproved=()=>{const _0x1d22ca=_0x2d10df;let _0x5bb951=![];return telegram2FaApproval&&telegram2FaApproval[_0x1d22ca(0x13d)]!='reject'&&(_0x5bb951=telegram2FaApproval[_0x1d22ca(0x22a)]==externalip&&new Date()[_0x1d22ca(0x246)]()-telegram2FaApproval['timestamp']<telegram2FaApproval[_0x1d22ca(0x13d)]*0x3c*0x3e8),_0x5bb951;},normalizeIP=_0x379559=>{const _0x497f06=_0x2d10df;let _0x473324=null,_0x43b90d=null;if(ipaddr[_0x497f06(0x141)](_0x379559)){const _0x38c521=ipaddr['parse'](_0x379559);_0x38c521[_0x497f06(0x155)]()==='ipv6'?(_0x38c521[_0x497f06(0x138)]()&&(_0x473324=_0x38c521[_0x497f06(0x1ea)]()[_0x497f06(0x22b)]()),_0x43b90d=_0x38c521['toString']()):(_0x473324=_0x38c521[_0x497f06(0x22b)](),_0x43b90d=_0x38c521[_0x497f06(0x16f)]()[_0x497f06(0x22b)]());}return{'show':_0x473324?_0x473324:_0x43b90d,'store':_0x43b90d};};